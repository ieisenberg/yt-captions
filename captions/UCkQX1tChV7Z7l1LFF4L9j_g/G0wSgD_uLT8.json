[
  {
    "text": "foreign [Music]",
    "start": "1380",
    "end": "17039"
  },
  {
    "text": "in this session we'll talk about 24 7 State replication so a little bit about me my name is Todd",
    "start": "17039",
    "end": "24119"
  },
  {
    "text": "Montgomery I've been working around Network protocols since the 90s this is why I",
    "start": "24119",
    "end": "29400"
  },
  {
    "text": "had this great beard so my background is in network protocols",
    "start": "29400",
    "end": "35520"
  },
  {
    "text": "and especially as Network protocols and networking and Communications apply to trading systems in the financial world",
    "start": "35520",
    "end": "42800"
  },
  {
    "text": "but I've worked on lots of different types of systems I spent some time working with systems at Nasa early on in",
    "start": "42800",
    "end": "49500"
  },
  {
    "text": "my career which was very formative and I have also worked on gaming and a lot of",
    "start": "49500",
    "end": "55379"
  },
  {
    "text": "other types of systems so in this I'll try to distill some of the things that I've noticed or especially over the last few few years",
    "start": "55379",
    "end": "62660"
  },
  {
    "text": "with systems that are in the trading space around 24 7 operation so what's so",
    "start": "62660",
    "end": "69240"
  },
  {
    "text": "hard about 24 7 if you've probably are doing something in retail or you're",
    "start": "69240",
    "end": "74400"
  },
  {
    "text": "doing something which is consumers facing you probably are wondering why we're even talking about something like",
    "start": "74400",
    "end": "79979"
  },
  {
    "text": "20 in all my systems operate 24 7. and the answer to that is a mini do uh but",
    "start": "79979",
    "end": "86460"
  },
  {
    "text": "they're not the same uh Financial systems almost all all in trading do not",
    "start": "86460",
    "end": "91680"
  },
  {
    "text": "operate 24 7. they have periods where they operate and then periods where they",
    "start": "91680",
    "end": "97079"
  },
  {
    "text": "they do not um so the answer is there's nothing hard about it except when the slas are very",
    "start": "97079",
    "end": "105000"
  },
  {
    "text": "tight uh the slas need to be met contractually uh that is",
    "start": "105000",
    "end": "110759"
  },
  {
    "text": "um the fines that can be leveraged on an exchange for example can be extremely",
    "start": "110759",
    "end": "116159"
  },
  {
    "text": "penalizing if they are unavailable during trading hours so it's not simply that it's okay to you",
    "start": "116159",
    "end": "124020"
  },
  {
    "text": "know take 10 seconds for example 10 seconds is an eternity for most algorithmic Trading",
    "start": "124020",
    "end": "129959"
  },
  {
    "text": "and components need to be upgraded often uh upgrading components should not feel",
    "start": "129959",
    "end": "135000"
  },
  {
    "text": "like it is a chore it should be something that should be done often it should be something that should be done continuously it does not stop",
    "start": "135000",
    "end": "142020"
  },
  {
    "text": "so this is hard for a system that has to operate in a way that it is always",
    "start": "142020",
    "end": "147900"
  },
  {
    "text": "available it's always providing itself slas even when it's being updated and",
    "start": "147900",
    "end": "153599"
  },
  {
    "text": "transactions must be processed in real time almost all systems have that requirement if they're doing something",
    "start": "153599",
    "end": "159599"
  },
  {
    "text": "that involves uh business but it's not always the case when you are doing things that involve uh",
    "start": "159599",
    "end": "166620"
  },
  {
    "text": "consumers for example so these all do have some differences",
    "start": "166620",
    "end": "172920"
  },
  {
    "text": "and when we think about this we also have to think about Disaster Recovery in fact we'll talk a lot about Disaster",
    "start": "172920",
    "end": "178739"
  },
  {
    "text": "Recovery Disaster Recovery is very important for applications because of the cost of losing some transactions or",
    "start": "178739",
    "end": "186420"
  },
  {
    "text": "data or things like that this is not the same for all businesses so not all businesses are equal in this",
    "start": "186420",
    "end": "192239"
  },
  {
    "text": "regard we're going to actually use uh one term but I wanted to bring two in recovery time objective is one thing we",
    "start": "192239",
    "end": "199440"
  },
  {
    "text": "will look at and that kind of gives us an idea about how to return to operation",
    "start": "199440",
    "end": "204780"
  },
  {
    "text": "looks like recovery Point objective is also a term that is also used also with with this in terms of data protection",
    "start": "204780",
    "end": "211260"
  },
  {
    "text": "but we're not going to actually talk about you know recovery Point objective uh it's its own point that we could be",
    "start": "211260",
    "end": "217920"
  },
  {
    "text": "making about this so when we're really talking about 24 7 we're really talking about business continuity and business impact",
    "start": "217920",
    "end": "225239"
  },
  {
    "text": "um just being able to continue operation when bad things happen uh that we're not",
    "start": "225239",
    "end": "230700"
  },
  {
    "text": "playing for uh is a business differentiator and also in trading it can be something",
    "start": "230700",
    "end": "237239"
  },
  {
    "text": "that is table Stakes um an exchange has to have uh for example in the EU in the UK",
    "start": "237239",
    "end": "244019"
  },
  {
    "text": "systems that offer trading Services have to be available and have to have a",
    "start": "244019",
    "end": "249659"
  },
  {
    "text": "certain minimum capacity to operate in a disaster recovery case and be able to",
    "start": "249659",
    "end": "254760"
  },
  {
    "text": "put to resume operation and be able to demonstrate it those are not things that are easy to do",
    "start": "254760",
    "end": "261540"
  },
  {
    "text": "most of the time so hopefully you've thinking of it now that",
    "start": "261540",
    "end": "267780"
  },
  {
    "text": "maybe it's not always the case that this is easy maybe it's not always the case that uh it's it's something that uh is",
    "start": "267780",
    "end": "274320"
  },
  {
    "text": "just you know kind of oh we're already doing that sometimes because this can be difficult and we're going to break this",
    "start": "274320",
    "end": "279660"
  },
  {
    "text": "down into a couple different areas the first we're going to talk about is Fault tolerance because the fault tolerance model that is in use for an application",
    "start": "279660",
    "end": "285780"
  },
  {
    "text": "has a big determination in terms of how uh 24 7 is done",
    "start": "285780",
    "end": "291060"
  },
  {
    "text": "Disaster Recovery as well because that is also part of it how fast can you return to operation one year which when",
    "start": "291060",
    "end": "297360"
  },
  {
    "text": "you have to come and recover from a disaster also upgrades uh components also need to",
    "start": "297360",
    "end": "304680"
  },
  {
    "text": "be upgraded so you're operating in an environment where sometimes things are just not on the same version",
    "start": "304680",
    "end": "310440"
  },
  {
    "text": "and hopefully we'll have some takeaways from this so first fault tolerance",
    "start": "310440",
    "end": "316259"
  },
  {
    "text": "you know providing fault tolerance is not difficult there are lots of ways to do",
    "start": "316259",
    "end": "322139"
  },
  {
    "text": "it in fact you can have a piece of Hardware with a service running on it and a client and they're operating just",
    "start": "322139",
    "end": "328320"
  },
  {
    "text": "fine you restart the service when it goes down everything's happy right your",
    "start": "328320",
    "end": "333720"
  },
  {
    "text": "first step in making this a little bit more fall taller than just restarting is you may put it on the cloud",
    "start": "333720",
    "end": "338940"
  },
  {
    "text": "that's perfectly fine that allows you to provide you with some easier mechanisms of restarting services or be able to",
    "start": "338940",
    "end": "345780"
  },
  {
    "text": "migrate Services a little bit easier providing you some protection of data in the event of you know things not going",
    "start": "345780",
    "end": "352259"
  },
  {
    "text": "very well you could also duplicate it in Shard you could partition your data set so that",
    "start": "352259",
    "end": "358979"
  },
  {
    "text": "things are handled by specific servers this provides you with some forms of fault tolerance",
    "start": "358979",
    "end": "365520"
  },
  {
    "text": "um it does provide you with a little bit of things to have to think about for example now you start to have clients that can connect to all of them or one",
    "start": "365520",
    "end": "373020"
  },
  {
    "text": "of them or a route to them so you have to think about that and that's you know where we start to really see systems",
    "start": "373020",
    "end": "379440"
  },
  {
    "text": "that operate and in some cases just like this and there's nothing wrong with that in fact those are a lot of systems that",
    "start": "379440",
    "end": "385620"
  },
  {
    "text": "work very well in this regard when the problem domain fits into that this is a",
    "start": "385620",
    "end": "390960"
  },
  {
    "text": "perfectly fine model but it does have one potential problem that is kind of tough to deal with and",
    "start": "390960",
    "end": "398039"
  },
  {
    "text": "that is where all of the problems start to occur it's the state that is in these",
    "start": "398039",
    "end": "404520"
  },
  {
    "text": "services and so a lot of times what we do is Kick the Can down the road we use something else",
    "start": "404520",
    "end": "411300"
  },
  {
    "text": "to hold the state so a database or you know a cache or something else that is",
    "start": "411300",
    "end": "416759"
  },
  {
    "text": "pushed away but essentially it is still the same problem that state is really",
    "start": "416759",
    "end": "422819"
  },
  {
    "text": "what we need to be fault tolerant that is Fault tolerance of state that state",
    "start": "422819",
    "end": "429000"
  },
  {
    "text": "that we have needs to be tolerant to losing members Services machines",
    "start": "429000",
    "end": "434819"
  },
  {
    "text": "everything and so when you start looking at this there is a Continuum between",
    "start": "434819",
    "end": "440400"
  },
  {
    "text": "partitioning that state for scaling and replicating that state for fault",
    "start": "440400",
    "end": "446039"
  },
  {
    "text": "tolerant operation where it is replicated in several areas there's lots",
    "start": "446039",
    "end": "451800"
  },
  {
    "text": "of ways to address this and lots of systems do address this in different ways we're going to talk about one",
    "start": "451800",
    "end": "457139"
  },
  {
    "text": "specific one because it's a it is a Samantha that has become very popular within certain types of problems many of",
    "start": "457139",
    "end": "464699"
  },
  {
    "text": "the ones that I work with in trading and also out of trading that is the idea of having a model where is you have a",
    "start": "464699",
    "end": "471660"
  },
  {
    "text": "contiguous log of data or log events with the idea of a snapshot and replay",
    "start": "471660",
    "end": "477180"
  },
  {
    "text": "when you restart so in other words you have a continuous log of events you can periodically take snapshots you can then",
    "start": "477180",
    "end": "484560"
  },
  {
    "text": "start by rehydrating from the log the previous state or taking loading a snapshot and",
    "start": "484560",
    "end": "491340"
  },
  {
    "text": "then replaying as well let's take a look at this a little bit more detail shall we so let's say we have a sequence of",
    "start": "491340",
    "end": "496620"
  },
  {
    "text": "events this could be a long sequence of events uh it really doesn't matter but we do",
    "start": "496620",
    "end": "501720"
  },
  {
    "text": "have some state that our service kind of goes through from one event to the next so it's kind of compounding this state",
    "start": "501720",
    "end": "508740"
  },
  {
    "text": "right so there might be a particular point in this state where a lot of the previous state just kind of collapses",
    "start": "508740",
    "end": "514680"
  },
  {
    "text": "because it's no longer relevant think about if you're trying to sell a particular item and you sell out of it",
    "start": "514680",
    "end": "520919"
  },
  {
    "text": "well the current state once you've sold out of it you don't have any more to sell right so why keep it around",
    "start": "520919",
    "end": "527220"
  },
  {
    "text": "so that idea you know also applies to things like trading like in exchange you",
    "start": "527220",
    "end": "533040"
  },
  {
    "text": "sell a commodity you sell all that is available you don't have to keep track of what is currently available to sell",
    "start": "533040",
    "end": "539279"
  },
  {
    "text": "because there are no more sellers in the market all the buyers have bought up everything from the sellers and any",
    "start": "539279",
    "end": "545880"
  },
  {
    "text": "particular time so think of it as your active State your history is not part of that right it's the active state of what",
    "start": "545880",
    "end": "552540"
  },
  {
    "text": "is going on so at some point let's say after event four here you took a snapshot of that",
    "start": "552540",
    "end": "558360"
  },
  {
    "text": "state that's your active working set you take a snapshot of it now we're going to use the term snapshot at a checkpoint or",
    "start": "558360",
    "end": "564779"
  },
  {
    "text": "various things there's all kinds of different ways to think about this but the idea is that you roll up the current state into something which",
    "start": "564779",
    "end": "571560"
  },
  {
    "text": "can then be rehydrated so you would save that and in the events that happen after",
    "start": "571560",
    "end": "576660"
  },
  {
    "text": "that so the idea here is that you would have a contiguous log of events State that's associated with that as it moves",
    "start": "576660",
    "end": "583200"
  },
  {
    "text": "along and you can be able to equate the left and the right here with the idea of having a snapshot that",
    "start": "583200",
    "end": "590459"
  },
  {
    "text": "rolls all that previous activity up into the current active state",
    "start": "590459",
    "end": "596580"
  },
  {
    "text": "and so the left and the right here should have the same state at the at the end and they should have the same state",
    "start": "596580",
    "end": "603000"
  },
  {
    "text": "at each individual place in that log right so this allows us to build basically",
    "start": "603000",
    "end": "610920"
  },
  {
    "text": "clustered Services now we can have services that are doing the same thing from the",
    "start": "610920",
    "end": "617760"
  },
  {
    "text": "same log of events the same set of snapshots everything",
    "start": "617760",
    "end": "623459"
  },
  {
    "text": "the replicas this is called a replicator state machine these replicas basically allow",
    "start": "623459",
    "end": "630600"
  },
  {
    "text": "you know if you had the same event log if you had thus the same input ordering in other words one event comes out right",
    "start": "630600",
    "end": "637500"
  },
  {
    "text": "after another event and that's always the case if they don't just suddenly flip and you can keep those those logs",
    "start": "637500",
    "end": "643560"
  },
  {
    "text": "locally you now have a system which is can be deterministic everything allows that to happen now you",
    "start": "643560",
    "end": "650820"
  },
  {
    "text": "can have a system that is very deterministic you can play this forward you can restart it you should always",
    "start": "650820",
    "end": "657060"
  },
  {
    "text": "come back to the same state and that's an interesting thing right because that allows you to now have an idea that it",
    "start": "657060",
    "end": "664320"
  },
  {
    "text": "is deterministic the system will given the same set of input will always result in the same state",
    "start": "664320",
    "end": "671420"
  },
  {
    "text": "those checkpoints or those snapshots are really events in the log if you think about it they roll up the previous log",
    "start": "672779",
    "end": "678959"
  },
  {
    "text": "events in the idea that they just roll up the previous state some of that state just absolutely collapses because it's",
    "start": "678959",
    "end": "684899"
  },
  {
    "text": "no longer relevant but the active State can be you know sort of you know saved",
    "start": "684899",
    "end": "691640"
  },
  {
    "text": "loaded stored just like anything else because it is just a set of data right",
    "start": "691640",
    "end": "697800"
  },
  {
    "text": "and then each event is a piece of data as well now there are a couple different things here",
    "start": "697800",
    "end": "703680"
  },
  {
    "text": "what about consensus when do we process something if we've got these multiple ones running about these replicas when",
    "start": "703680",
    "end": "710940"
  },
  {
    "text": "is it safe to consume a log event well the idea is that log event then reaching",
    "start": "710940",
    "end": "717240"
  },
  {
    "text": "reaches some sort of consensus we actually have lots of different protocols but the best one to use for",
    "start": "717240",
    "end": "723720"
  },
  {
    "text": "this that we that I have seen in many others is is the idea of raft and raft is well known it's used in many systems",
    "start": "723720",
    "end": "731040"
  },
  {
    "text": "is implemented in many systems and the idea is that an event must be recorded and stable at a majority of replicas",
    "start": "731040",
    "end": "738540"
  },
  {
    "text": "before it's being consumed by any replica so what this gives us is the ability to basically have that durable",
    "start": "738540",
    "end": "746279"
  },
  {
    "text": "right it's durable it's in storage now if you lose let's say you have three",
    "start": "746279",
    "end": "752820"
  },
  {
    "text": "members that majority comes into play once it's on one that's not good enough",
    "start": "752820",
    "end": "757860"
  },
  {
    "text": "it's got to be a two once it reaches two then all you know then all then it can be processed so that's a very key thing",
    "start": "757860",
    "end": "764399"
  },
  {
    "text": "right so you can lose one member and continue on just fine because another member has it",
    "start": "764399",
    "end": "769740"
  },
  {
    "text": "and this works for five it works for all all the all the numbers number J clear majority of those numbers having that",
    "start": "769740",
    "end": "777500"
  },
  {
    "text": "breaches consensus so we're not going to go too much into that but the idea is you know using",
    "start": "777500",
    "end": "783660"
  },
  {
    "text": "consensus to help you with that so if you now have a system that uh you know is a set of nodes",
    "start": "783660",
    "end": "791639"
  },
  {
    "text": "cluster and they're replicas and they're all processing the same log now you have",
    "start": "791639",
    "end": "796800"
  },
  {
    "text": "the ability to lose a member and keep going or lose two members if you're running five",
    "start": "796800",
    "end": "802260"
  },
  {
    "text": "or if you're running seven lose three and just continue on as if nothing had",
    "start": "802260",
    "end": "807660"
  },
  {
    "text": "happened now there are some things in there to think about",
    "start": "807660",
    "end": "813899"
  },
  {
    "text": "and you know they all have an impact on what we're talking about which is 24 7. but I",
    "start": "813899",
    "end": "820560"
  },
  {
    "text": "want to talk about a couple specific ones the first thing is disaster recovery because this is very much",
    "start": "820560",
    "end": "826200"
  },
  {
    "text": "something that is uh is always on the mind of system Developers so Disaster Recovery we're not going to",
    "start": "826200",
    "end": "833820"
  },
  {
    "text": "talk about recovery Point objective RPO it's relevant but it's a little different and it is is not the main",
    "start": "833820",
    "end": "841079"
  },
  {
    "text": "thing we want to talk about what we really want to talk about here is RTA recovery time objective because it's very relevant when you're talking about",
    "start": "841079",
    "end": "848100"
  },
  {
    "text": "24 7 and you have tight slas so",
    "start": "848100",
    "end": "853320"
  },
  {
    "text": "where does your Disaster Recovery come into this picture we've got Services we've got you know archives we've got",
    "start": "853320",
    "end": "859260"
  },
  {
    "text": "multiple machines they're all doing the same thing you know so you know we're we're able to recover you know very",
    "start": "859260",
    "end": "865440"
  },
  {
    "text": "quickly when things had you know happen in fact we may not even notice you know just keep continue on",
    "start": "865440",
    "end": "871740"
  },
  {
    "text": "well if you think about this those machines have an archive those archives are then being used to store",
    "start": "871740",
    "end": "878220"
  },
  {
    "text": "snapshots uh they're the have the log and if you lazily disseminate those snapshots to Dr",
    "start": "878220",
    "end": "885660"
  },
  {
    "text": "and you stream when each individual message in a stream becomes uh reaches",
    "start": "885660",
    "end": "892440"
  },
  {
    "text": "consistent as you stream it to Dr now you have a way of actually recovering",
    "start": "892440",
    "end": "897480"
  },
  {
    "text": "right because now you've got that log and the snapshot and you can recover your state",
    "start": "897480",
    "end": "903600"
  },
  {
    "text": "this none of this should be new none of this everything a lot of things uh that systems we have work this way but I'm",
    "start": "903600",
    "end": "910920"
  },
  {
    "text": "trying to break it down so that we can actually see some of the Dynamics of playing what 24 7 really means in those cases so if we think about this that",
    "start": "910920",
    "end": "918660"
  },
  {
    "text": "dissemination of the snapshots and the and the the log and the log events helps",
    "start": "918660",
    "end": "924660"
  },
  {
    "text": "us to actually then understand what is actually the problem that we want to",
    "start": "924660",
    "end": "929699"
  },
  {
    "text": "solve to make it so that we could even in Disaster Recovery cases be able to meet our slas or at least get close to",
    "start": "929699",
    "end": "935519"
  },
  {
    "text": "meeting them kind of breaks down into two things one is the disaster recovery cold in other",
    "start": "935519",
    "end": "942959"
  },
  {
    "text": "words it's kind of just a backup and it's just on disk or is it warm is there some logic that's running there and so",
    "start": "942959",
    "end": "949920"
  },
  {
    "text": "let's take the first idea of it being cold so this means basically you have a cold replicated State machine for your",
    "start": "949920",
    "end": "955920"
  },
  {
    "text": "recovery in other words it's not running yet everything is just being saved you're just ready for backup",
    "start": "955920",
    "end": "962339"
  },
  {
    "text": "that means when you it becomes hot not warm but when it becomes hot because",
    "start": "962339",
    "end": "967980"
  },
  {
    "text": "it now it becomes active you have to first load the snapshot and then replay the log so",
    "start": "967980",
    "end": "976199"
  },
  {
    "text": "let's break that down this picture was what we saw before earlier right so the snapshot",
    "start": "976199",
    "end": "982440"
  },
  {
    "text": "you know uh take some time to load and then the replay of the log takes some",
    "start": "982440",
    "end": "987480"
  },
  {
    "text": "time and that thus we end up you know basically having uh you know a particular time that it takes us to",
    "start": "987480",
    "end": "993720"
  },
  {
    "text": "recover so if we break that down the time to load the snapshot and the time to replay the log and the time to recover they",
    "start": "993720",
    "end": "1001339"
  },
  {
    "text": "have an interesting association with one another the first thing is the title load of snapshot is usually small",
    "start": "1001339",
    "end": "1007399"
  },
  {
    "text": "because the snapshots are usually just uh you know a serialized version of current state they're not a history",
    "start": "1007399",
    "end": "1013940"
  },
  {
    "text": "uh in fact that's the worst thing you could do to put into them would be history what you really want is just the",
    "start": "1013940",
    "end": "1019519"
  },
  {
    "text": "active state that you need to maintain and the time to replay the log is going",
    "start": "1019519",
    "end": "1026000"
  },
  {
    "text": "to determine by probably the length of the log yes the length of the log is going to be the thing that has the the",
    "start": "1026000",
    "end": "1032839"
  },
  {
    "text": "biggest impact and how complex it is to actually process",
    "start": "1032839",
    "end": "1038240"
  },
  {
    "text": "the log so that can be large in fact if you have to have a log that",
    "start": "1038240",
    "end": "1046699"
  },
  {
    "text": "is say 24 hours old let's say you're snapshotting every 24 hours the worst case is going to be you have a 23 hour",
    "start": "1046699",
    "end": "1054440"
  },
  {
    "text": "and 59 minute and 59 second and 0.999999 second log that you have to",
    "start": "1054440",
    "end": "1062840"
  },
  {
    "text": "replay some systems that are doing millions of transactions a second it may have TR you",
    "start": "1062840",
    "end": "1069799"
  },
  {
    "text": "know trillions of uh events in their log but from the last snapshot",
    "start": "1069799",
    "end": "1075020"
  },
  {
    "text": "that can take a while to go through it's not so much loading that data from disk or loading it from some storage",
    "start": "1075020",
    "end": "1081380"
  },
  {
    "text": "It's usually the fact that the processing of that log can take a very",
    "start": "1081380",
    "end": "1087980"
  },
  {
    "text": "very long time so that is something that you have to always consider is what happens if it",
    "start": "1087980",
    "end": "1094940"
  },
  {
    "text": "takes a long time to process that log scene systems where the processing of a",
    "start": "1094940",
    "end": "1102440"
  },
  {
    "text": "log after that can take hours that's hours before that is ready for you know",
    "start": "1102440",
    "end": "1107960"
  },
  {
    "text": "from to go to from Disaster Recovery to become something that is done you know right now",
    "start": "1107960",
    "end": "1114020"
  },
  {
    "text": "so how do we ameliorate that how do we actually make it better so that you know",
    "start": "1114020",
    "end": "1119660"
  },
  {
    "text": "the the loading of a member going from cold to hot is faster well",
    "start": "1119660",
    "end": "1126740"
  },
  {
    "text": "reduce the size of the log that you have to replay how you do that snapshot more often so",
    "start": "1126740",
    "end": "1133340"
  },
  {
    "text": "instead of doing every 24 hours you do it every hour that means you have an hour's worth of log that you may be able",
    "start": "1133340",
    "end": "1139160"
  },
  {
    "text": "to run through in a few seconds or a minute or a couple minutes or you know 10 minutes that may be acceptable",
    "start": "1139160",
    "end": "1145400"
  },
  {
    "text": "if you need a snapshot more often you know that just means that you have a smaller log to a replay that's good",
    "start": "1145400",
    "end": "1151059"
  },
  {
    "text": "that's your main control in that case you don't have a lot more else that you can do",
    "start": "1151059",
    "end": "1156700"
  },
  {
    "text": "immediately but it does come at a cost taking a snapshot may not be something",
    "start": "1156700",
    "end": "1162320"
  },
  {
    "text": "you can do very quickly it may be something that takes a period of time to have that snapshot be actually done and",
    "start": "1162320",
    "end": "1169520"
  },
  {
    "text": "if uh in raft a snapshot is an optimization right you're taking it and",
    "start": "1169520",
    "end": "1176240"
  },
  {
    "text": "you're trying to make it uh so that it's an optimization you could always have just replay the log from scratch right",
    "start": "1176240",
    "end": "1182960"
  },
  {
    "text": "so the idea of that snapshot you may want to think about it as it might have",
    "start": "1182960",
    "end": "1188179"
  },
  {
    "text": "a disruptive influence on your machine on your machine on all the replicas in",
    "start": "1188179",
    "end": "1193340"
  },
  {
    "text": "fact the way that a lot of systems do this is a snapshot is an event in the log all the replicas take a snapshot at",
    "start": "1193340",
    "end": "1198440"
  },
  {
    "text": "the same time that simplifies some of the operation but it also introduces the",
    "start": "1198440",
    "end": "1204200"
  },
  {
    "text": "fact that when you take a snapshot it better be quick because it will disrupt things that are behind it they'll have to wait",
    "start": "1204200",
    "end": "1211340"
  },
  {
    "text": "so what happens if you were to use the idea of taking snapshots asynchronously",
    "start": "1211340",
    "end": "1216620"
  },
  {
    "text": "outside of the cluster and in disseminating them out of band back into the cluster well that could be a way to",
    "start": "1216620",
    "end": "1223760"
  },
  {
    "text": "minimize that impact right it doesn't really change the recovery of those but",
    "start": "1223760",
    "end": "1228799"
  },
  {
    "text": "it does make it so that well it should be a little bit less disruptive to take an actual snapshot",
    "start": "1228799",
    "end": "1236020"
  },
  {
    "text": "but let's think about also this in a different way what if we were to look at it from a warm standby perspective so",
    "start": "1236020",
    "end": "1242720"
  },
  {
    "text": "instead of it being cold and just thinking of it as a backup we think about it more like",
    "start": "1242720",
    "end": "1248059"
  },
  {
    "text": "um it's the service replica is running in Dr and it's ready it's hot you know",
    "start": "1248059",
    "end": "1255799"
  },
  {
    "text": "if it needs to be on the on just it just has to be told to go hot that is actually what another way to",
    "start": "1255799",
    "end": "1262880"
  },
  {
    "text": "handle this so instead of it having being cold and just being a backup you",
    "start": "1262880",
    "end": "1267980"
  },
  {
    "text": "could just be streaming those snapshots and that log and have a service replica",
    "start": "1267980",
    "end": "1273500"
  },
  {
    "text": "just taking and doing exactly what a normal service would do this is the power when it's deterministic right",
    "start": "1273500",
    "end": "1280100"
  },
  {
    "text": "because the service the same one it's running in the cluster could be running in your Dr and it's hot you know on the",
    "start": "1280100",
    "end": "1287720"
  },
  {
    "text": "at the drop of a dime it's sitting there just warm and you can light a fire under any time it does not need to be active",
    "start": "1287720",
    "end": "1295280"
  },
  {
    "text": "in the cluster it just has to be there getting the same log getting the same snapshots doing the same logic",
    "start": "1295280",
    "end": "1303400"
  },
  {
    "text": "that means that did recovering from a disaster can be just the matter of",
    "start": "1303400",
    "end": "1309559"
  },
  {
    "text": "making that go from warm to hot and that allows slas to be met",
    "start": "1309559",
    "end": "1317620"
  },
  {
    "text": "so that's kind of how you can you know think about potentially making you know",
    "start": "1318500",
    "end": "1323780"
  },
  {
    "text": "24 7 in a SLA demanding type of environment uh work really well within",
    "start": "1323780",
    "end": "1331700"
  },
  {
    "text": "um you know some systems that allow them to kind of use this kind of model",
    "start": "1331700",
    "end": "1336860"
  },
  {
    "text": "but that's only the beginning of a lot of different pieces the other pieces I",
    "start": "1336860",
    "end": "1342080"
  },
  {
    "text": "want to talk about that is normally a problem for a lot of systems is really more along continuous delivery",
    "start": "1342080",
    "end": "1349000"
  },
  {
    "text": "and 24 7 upgrades how to do upgrades within an atmosphere like this",
    "start": "1349000",
    "end": "1355580"
  },
  {
    "text": "so the first thing is there is no big bang forklift stop the world upgrade",
    "start": "1355580",
    "end": "1360679"
  },
  {
    "text": "because that is too much of a disruption to all slas blows them out of the water",
    "start": "1360679",
    "end": "1365840"
  },
  {
    "text": "you're never going to be able to do it so it's never going to be possible you know to go ahead and do that in in any",
    "start": "1365840",
    "end": "1373280"
  },
  {
    "text": "real system that needs to be 24 7 and has tight SLX so that's not something you can really",
    "start": "1373280",
    "end": "1380419"
  },
  {
    "text": "rely on when you start to think about that the implication of that is since you can't",
    "start": "1380419",
    "end": "1385880"
  },
  {
    "text": "upgrade everything at once you're going to have to live with the fact that you're going to have to upgrade things piecemeal so that means that components",
    "start": "1385880",
    "end": "1393320"
  },
  {
    "text": "will be on varying versions they're going to be on varying versions of an operating system they're going to be on varying versions of an OS they're going",
    "start": "1393320",
    "end": "1400580"
  },
  {
    "text": "to be on varying versions of software that's outside of your system your own system will be on varying versions",
    "start": "1400580",
    "end": "1407419"
  },
  {
    "text": "um it's just a fact so that kind of gets us down into actually an area that I come from which",
    "start": "1407419",
    "end": "1413659"
  },
  {
    "text": "is protocol design protocols have to work in you know ways that mean that",
    "start": "1413659",
    "end": "1419240"
  },
  {
    "text": "they can operate with very varying component versions of various pieces",
    "start": "1419240",
    "end": "1425059"
  },
  {
    "text": "they just have to so how do you make them you know work in those situations",
    "start": "1425059",
    "end": "1430780"
  },
  {
    "text": "so I'm going to take a lot of you know inspiration from protocol design here",
    "start": "1430780",
    "end": "1436039"
  },
  {
    "text": "and I sort of suggest you also take a look at this because in my experience this is the hardest part of making",
    "start": "1436039",
    "end": "1442220"
  },
  {
    "text": "something where you have the ability to upgrade things 24 7 at the drop of a hat good protocol design is a part of that",
    "start": "1442220",
    "end": "1449299"
  },
  {
    "text": "it's a very big part of that so the first thing is backwards compatibility table stinks you have to",
    "start": "1449299",
    "end": "1454880"
  },
  {
    "text": "be backwards compatible you have to make it so that old versions uh you know new versions won't necessarily break old",
    "start": "1454880",
    "end": "1462260"
  },
  {
    "text": "versions uh you have to figure out how to do that in the best way while moving things forward that's not always easy",
    "start": "1462260",
    "end": "1467720"
  },
  {
    "text": "but it gets a little bit easier when you start to think about how to do forward compatibility",
    "start": "1467720",
    "end": "1472880"
  },
  {
    "text": "what does that mean well it means that version everything your messages your events your data",
    "start": "1472880",
    "end": "1478880"
  },
  {
    "text": "everything should have a version it should have a version field uh whether it be a set of bits or whether it be a",
    "start": "1478880",
    "end": "1486140"
  },
  {
    "text": "string or something else there has to be a way to look at a piece of",
    "start": "1486140",
    "end": "1491360"
  },
  {
    "text": "data that's on a wire or a piece of data in a database or a piece of data that is in memory and be able to look at it and",
    "start": "1491360",
    "end": "1498080"
  },
  {
    "text": "go oh that's the version for that and not all versioning schemes are the",
    "start": "1498080",
    "end": "1504620"
  },
  {
    "text": "same they all have you know sort of breakdown in certain ways",
    "start": "1504620",
    "end": "1509720"
  },
  {
    "text": "I want to sort of suggest you take a look at something called semantic versioning so semantic versioning",
    "start": "1509720",
    "end": "1515360"
  },
  {
    "text": "there's actually a very nice web page that goes into the idea behind some anti-personing but what it does at its",
    "start": "1515360",
    "end": "1522200"
  },
  {
    "text": "heart is it gives you some definitions for a major minor and patch that are useful for a lot of systems so you don't",
    "start": "1522200",
    "end": "1529039"
  },
  {
    "text": "have to use this for messages you don't have to use this for data but I strongly suggest looking at it for that a lot of",
    "start": "1529039",
    "end": "1535400"
  },
  {
    "text": "times it's looked at for versions of you know whole packages things like that but think about it from the protocol perspective too the messages and data",
    "start": "1535400",
    "end": "1542419"
  },
  {
    "text": "and everything else so given a version number major.miner.patch increment the which",
    "start": "1542419",
    "end": "1551659"
  },
  {
    "text": "piece major version when you make incompatible API changes so version two is",
    "start": "1551659",
    "end": "1558980"
  },
  {
    "text": "incompatible with version one that's an interesting thing there the API right",
    "start": "1558980",
    "end": "1564919"
  },
  {
    "text": "minor version when you add functionality in a backwards compatible way so minor version can change as long as it is",
    "start": "1564919",
    "end": "1571880"
  },
  {
    "text": "backwards compatible and it's adding functionality not changing it but adding",
    "start": "1571880",
    "end": "1576980"
  },
  {
    "text": "functionality patch is when you actually make a backwards compatible bug fix that's the",
    "start": "1576980",
    "end": "1582380"
  },
  {
    "text": "big ticket items there's some details here that I suggest you look at and additional labels like pre-release",
    "start": "1582380",
    "end": "1588740"
  },
  {
    "text": "build metadata all those are extensions to that format but the heart of it is those particular types of things so now",
    "start": "1588740",
    "end": "1595700"
  },
  {
    "text": "we have a way to sort of think about what happens if we introduce an incompatibility boom",
    "start": "1595700",
    "end": "1600799"
  },
  {
    "text": "should be a major version change right minor if it's compatible but you've added some functionality and Patch if",
    "start": "1600799",
    "end": "1607460"
  },
  {
    "text": "you've just added them you know some fixes that's very interesting right so we have some semantics that you can kind",
    "start": "1607460",
    "end": "1613640"
  },
  {
    "text": "of hold your hat on so let's take a look at this example applied to sort of that log idea right",
    "start": "1613640",
    "end": "1620559"
  },
  {
    "text": "well if all of our events or messages are versioned we can see a sequence of",
    "start": "1620559",
    "end": "1627020"
  },
  {
    "text": "version changes 1.2 1.2 1.221",
    "start": "1627020",
    "end": "1633760"
  },
  {
    "text": "130130-215. whoa that was a big change right there right what happened to that you know what happens to that if an old",
    "start": "1634120",
    "end": "1641659"
  },
  {
    "text": "version of a service say for example sees that does it ignore it",
    "start": "1641659",
    "end": "1648080"
  },
  {
    "text": "does it try to struggle on does it kind of just let an exception happen if",
    "start": "1648080",
    "end": "1653480"
  },
  {
    "text": "that's okay does it terminate um what should it do",
    "start": "1653480",
    "end": "1658640"
  },
  {
    "text": "there's no hard and fast rule here your system probably has some impact for all",
    "start": "1658640",
    "end": "1664640"
  },
  {
    "text": "those actions there's going to be an impact in the case of replicated State machines",
    "start": "1664640",
    "end": "1670039"
  },
  {
    "text": "termination may be the best option because you might want to just terminate",
    "start": "1670039",
    "end": "1676640"
  },
  {
    "text": "and then continue on if you're upgrading like each individual member of a cluster",
    "start": "1676640",
    "end": "1682640"
  },
  {
    "text": "you probably want to upgrade one upgrade the second and upgrade the third front",
    "start": "1682640",
    "end": "1687860"
  },
  {
    "text": "three node cluster and then start using a new format after that after all those have been upgraded right but what",
    "start": "1687860",
    "end": "1695240"
  },
  {
    "text": "happens if you're doing that you forget to update one well just have it terminate that might be the",
    "start": "1695240",
    "end": "1701600"
  },
  {
    "text": "best thing in the world as opposed to corrupting States somewhere right so",
    "start": "1701600",
    "end": "1707140"
  },
  {
    "text": "that can be the catch if something doesn't happen and you know with large",
    "start": "1707140",
    "end": "1714440"
  },
  {
    "text": "Network systems what could possibly go wrong right",
    "start": "1714440",
    "end": "1719480"
  },
  {
    "text": "but there might be not only this we may need to have a little bit more information",
    "start": "1719480",
    "end": "1725900"
  },
  {
    "text": "here so for example let's think about what we were to do if",
    "start": "1725900",
    "end": "1732740"
  },
  {
    "text": "we were to add a couple more bits here let's borrow something from protocol design",
    "start": "1732740",
    "end": "1737840"
  },
  {
    "text": "PCP itself has a set of TCP options and some of them have been added over time they thought up front about how to",
    "start": "1737840",
    "end": "1744679"
  },
  {
    "text": "actually add them they have a bit and other protocols besides TCP do this but it's probably the best example at the",
    "start": "1744679",
    "end": "1752720"
  },
  {
    "text": "moment that comes to mind um it hasn't ignorbit so all the options",
    "start": "1752720",
    "end": "1758600"
  },
  {
    "text": "have what's called an ignorbit instead of it being version It's type so the type of option if it doesn't understand",
    "start": "1758600",
    "end": "1765440"
  },
  {
    "text": "the type and you receive a TCP message you look at the I bit that's can it be",
    "start": "1765440",
    "end": "1772640"
  },
  {
    "text": "ignored and if the eye bit is set then you can continue processing the rest of",
    "start": "1772640",
    "end": "1777799"
  },
  {
    "text": "the options and you just ignore that option but if it's set to zero you can't be",
    "start": "1777799",
    "end": "1783500"
  },
  {
    "text": "ignored and you have to actually drop the entire message the entire TCP frame",
    "start": "1783500",
    "end": "1788899"
  },
  {
    "text": "this is forward compatibility at its best in my mind you're actually thinking",
    "start": "1788899",
    "end": "1795020"
  },
  {
    "text": "I may come into an exam you know a situation where I have to throw away this whole message",
    "start": "1795020",
    "end": "1801559"
  },
  {
    "text": "or I can just ignore this particular piece of it that's thinking about things up front",
    "start": "1801559",
    "end": "1808279"
  },
  {
    "text": "and then you have that ability let's add the ability to terminate to that",
    "start": "1808279",
    "end": "1813500"
  },
  {
    "text": "so you have maybe a bit that says can it be ignored okay can it be ignored yeah this particular",
    "start": "1813500",
    "end": "1820100"
  },
  {
    "text": "piece whether it be a whole message or part of a message yeah it can be ignored but",
    "start": "1820100",
    "end": "1825740"
  },
  {
    "text": "you might have an additional piece in here that says should I terminate if I receive this and",
    "start": "1825740",
    "end": "1831919"
  },
  {
    "text": "I don't know what to do because the answer might be true so this is how you can kind of think",
    "start": "1831919",
    "end": "1839059"
  },
  {
    "text": "about it you don't have to think about everything up front but you can start to think about an additional way to have",
    "start": "1839059",
    "end": "1845120"
  },
  {
    "text": "some additional pieces of information that give you an idea of how to handle these situations",
    "start": "1845120",
    "end": "1851659"
  },
  {
    "text": "when you set them up beforehand you now have logic that can be exercised when it",
    "start": "1851659",
    "end": "1857539"
  },
  {
    "text": "needs to be exercised I'm not saying determination is the best thing I'm not saying to dropping the message is the right thing it may be the",
    "start": "1857539",
    "end": "1864380"
  },
  {
    "text": "best thing to just let an exception occur and just then have it logged and then just continue on",
    "start": "1864380",
    "end": "1870320"
  },
  {
    "text": "or it might be have that exception recorded logged and then have the the thing terminate you may have a set",
    "start": "1870320",
    "end": "1877880"
  },
  {
    "text": "this is what we do when the unexpected happens in our system I'm just saying you can give yourself a",
    "start": "1877880",
    "end": "1884120"
  },
  {
    "text": "little bit more freedom and a little bit more ability to handle the unexpected when you look at that",
    "start": "1884120",
    "end": "1890720"
  },
  {
    "text": "feature Flags so feature flags are an example of things you need to think",
    "start": "1890720",
    "end": "1896240"
  },
  {
    "text": "about for upgrades often feature Flags in a lot of",
    "start": "1896240",
    "end": "1902360"
  },
  {
    "text": "instances are tied to a version of a protocol and the hard thing there is you",
    "start": "1902360",
    "end": "1908840"
  },
  {
    "text": "have to have a new version to understand the new feature Flags that hurts that can be tough because it",
    "start": "1908840",
    "end": "1916580"
  },
  {
    "text": "ends up in a chicken and egg effect right we have to upgrade the protocols so that we have new feature Flags but we",
    "start": "1916580",
    "end": "1922100"
  },
  {
    "text": "can actually have the feature flag because we have to actually update the protocol right so there there's you know",
    "start": "1922100",
    "end": "1927440"
  },
  {
    "text": "there is a dependency there that you want but if you version them separately if you version the feature Flags",
    "start": "1927440",
    "end": "1933980"
  },
  {
    "text": "separately you actually get some interesting effects if you can be able to push out a new set of feature Flags",
    "start": "1933980",
    "end": "1940760"
  },
  {
    "text": "then push out a new version of a protocol that's actually pretty powerful now you have some ability to you know",
    "start": "1940760",
    "end": "1948140"
  },
  {
    "text": "not have to do the opposite right so I also think that feature Flags they",
    "start": "1948140",
    "end": "1956179"
  },
  {
    "text": "are not always a bit true or false they often have values they often have",
    "start": "1956179",
    "end": "1961640"
  },
  {
    "text": "meaning they also have other things with them so having them in a self-describing format is actually fairly useful",
    "start": "1961640",
    "end": "1969080"
  },
  {
    "text": "some of the things that you might think about from a self-describing format are things like you know is it a um is it",
    "start": "1969080",
    "end": "1975380"
  },
  {
    "text": "actually a uh going to be an integer is it unsigned",
    "start": "1975380",
    "end": "1981380"
  },
  {
    "text": "is it signed uh how big is the unit you know the integer how many bits is it in other words those are things that I",
    "start": "1981380",
    "end": "1986899"
  },
  {
    "text": "think about because I'm a protocol designer but if you start to think about this and step back for a moment and think about it from a usability",
    "start": "1986899",
    "end": "1993440"
  },
  {
    "text": "standpoint knowing that something is a integer versus something which is just a",
    "start": "1993440",
    "end": "1998899"
  },
  {
    "text": "string gives you some ability to even think about these things a little bit",
    "start": "1998899",
    "end": "2004120"
  },
  {
    "text": "more so when they're self-describing they do open up some doors",
    "start": "2004120",
    "end": "2009460"
  },
  {
    "text": "so I want you to think about that for a moment let's go back to that having a",
    "start": "2009460",
    "end": "2014919"
  },
  {
    "text": "set of messages and having them different versions the interesting thing about this is that log now has distinct",
    "start": "2014919",
    "end": "2020620"
  },
  {
    "text": "events a protocol change in it doesn't it that's interesting and that's really",
    "start": "2020620",
    "end": "2026740"
  },
  {
    "text": "kind of powerful to be able to look at and see the sequence of when when",
    "start": "2026740",
    "end": "2032980"
  },
  {
    "text": "in operation protocols changed through a system that's kind of neat I think that is",
    "start": "2032980",
    "end": "2039820"
  },
  {
    "text": "needed anyway what it comes down to with this with upgrades is thinking about things not as",
    "start": "2039820",
    "end": "2046240"
  },
  {
    "text": "being static and thinking about things is just a big upgrade you you can't you have to start thinking about these",
    "start": "2046240",
    "end": "2051460"
  },
  {
    "text": "things as your system it has varying versions of things going on not",
    "start": "2051460",
    "end": "2056919"
  },
  {
    "text": "everything's going to be on the same version you may try to minimize the time that they're on different versions but",
    "start": "2056919",
    "end": "2061960"
  },
  {
    "text": "you'll never get rid of it unless you can actually upgrade everything all at the same time",
    "start": "2061960",
    "end": "2067358"
  },
  {
    "text": "which is not going to work really for the for 24 7 types of upgrades right",
    "start": "2067359",
    "end": "2073419"
  },
  {
    "text": "so takeaways here look we we only had you know 35 minutes to talk here so there's not a",
    "start": "2073419",
    "end": "2079960"
  },
  {
    "text": "lot you know that we could have really gone into but I hope I've actually kind of given you some things to think about",
    "start": "2079960",
    "end": "2085658"
  },
  {
    "text": "and hopefully it's it's somewhat useful for you anyway",
    "start": "2085659",
    "end": "2091179"
  },
  {
    "text": "thank you",
    "start": "2091179",
    "end": "2093838"
  },
  {
    "text": "thank you Todd it's always great hearing from the distributed system whisper",
    "start": "2097180",
    "end": "2103200"
  },
  {
    "text": "favorite mini bio so whenever I um whenever I do a talk",
    "start": "2103380",
    "end": "2110200"
  },
  {
    "text": "it's particularly if I have to record it ahead of time there's always something that changes like right before it gets",
    "start": "2110200",
    "end": "2117099"
  },
  {
    "text": "uh displayed anything since you recorded this that you wish you had just a few more minutes to put in there or anything",
    "start": "2117099",
    "end": "2122920"
  },
  {
    "text": "different um yeah quite a bit um I I really did yeah I I really did",
    "start": "2122920",
    "end": "2132520"
  },
  {
    "text": "just hit on the biggest things that I've seen over the years um of and I've seen a lot of people uh",
    "start": "2132520",
    "end": "2140079"
  },
  {
    "text": "with a lot of systems try to kind of skip over some of the burgeoning things that I mentioned",
    "start": "2140079",
    "end": "2146859"
  },
  {
    "text": "um and I think one of the things that I've noticed uh repeatedly is there is",
    "start": "2146859",
    "end": "2152140"
  },
  {
    "text": "no shortcuts here you you actually have to sit down and think how does older",
    "start": "2152140",
    "end": "2158740"
  },
  {
    "text": "versions handle these things what can we do how can we minimize the disruption",
    "start": "2158740",
    "end": "2165160"
  },
  {
    "text": "um when doing you know upgrades so this goes well beyond just the 24 7 idea but",
    "start": "2165160",
    "end": "2170320"
  },
  {
    "text": "the idea of you know I I've noticed a lot of microservices architectures have",
    "start": "2170320",
    "end": "2176079"
  },
  {
    "text": "you know the typical thing of you put it in microservice architecture in place you had no versioning of your protocol",
    "start": "2176079",
    "end": "2182560"
  },
  {
    "text": "or data and then you've realized now we have to add it in because we're running",
    "start": "2182560",
    "end": "2188140"
  },
  {
    "text": "different versions all over the place that speak various things and we have to handle these things as a piecemeal and",
    "start": "2188140",
    "end": "2196060"
  },
  {
    "text": "so that I've seen a few times now of just",
    "start": "2196060",
    "end": "2201280"
  },
  {
    "text": "looking back on it going it's really hard to shoehorn that in later it's it's",
    "start": "2201280",
    "end": "2206440"
  },
  {
    "text": "really kind of hard to add versions later and I and uh some of the other",
    "start": "2206440",
    "end": "2212980"
  },
  {
    "text": "people that I work with are no exception to this we added a protocol that had no",
    "start": "2212980",
    "end": "2218800"
  },
  {
    "text": "versioning at the application layer uh to exactly the these types of systems",
    "start": "2218800",
    "end": "2224320"
  },
  {
    "text": "and we've had to go back and add it uh and we were very careful with it yeah",
    "start": "2224320",
    "end": "2229480"
  },
  {
    "text": "well it's a fine line right because you don't want to prematurely optimize something you need to get to product",
    "start": "2229480",
    "end": "2234820"
  },
  {
    "text": "Market fit so before you start adding any boilerplate any gold plating so it's you've got a you know it's kind of tough",
    "start": "2234820",
    "end": "2241300"
  },
  {
    "text": "sometimes to to make all the right calls so a talk like this really helps you think about some of these things",
    "start": "2241300",
    "end": "2248338"
  },
  {
    "text": "um that's that's that's been always my goal to just give some ideas of things to for people to to think about and",
    "start": "2248619",
    "end": "2254980"
  },
  {
    "text": "adopt what you like and if it doesn't matter to you then just forget about it honestly that's what I like about this",
    "start": "2254980",
    "end": "2260740"
  },
  {
    "text": "talk because there's a lot of things to think about um it's like almost a checklist these are some things to think about when you",
    "start": "2260740",
    "end": "2266859"
  },
  {
    "text": "want to run a high resilience system like this speaking of that when um you know we did",
    "start": "2266859",
    "end": "2272980"
  },
  {
    "text": "the panel on microservices in uh in San Francisco you were on it and uh one of",
    "start": "2272980",
    "end": "2278859"
  },
  {
    "text": "the things that uh we were talking about was slowness and you talked about like getting to what does it mean when",
    "start": "2278859",
    "end": "2286540"
  },
  {
    "text": "something is slow when someone tells you they need a high resilience system a 24",
    "start": "2286540",
    "end": "2292060"
  },
  {
    "text": "7 system how do you get to how do you have a conversation with them just like slowness to be able to say what do they",
    "start": "2292060",
    "end": "2299560"
  },
  {
    "text": "really need what how do you go about them well it um I always come at it from",
    "start": "2299560",
    "end": "2306400"
  },
  {
    "text": "business impact whether it be slow uh or in all the different qualities like is",
    "start": "2306400",
    "end": "2312700"
  },
  {
    "text": "it slow is it does it have what's the quality um you know uh what what is the business",
    "start": "2312700",
    "end": "2318280"
  },
  {
    "text": "impact of that and I would say fault tolerance is also part of that you know so there are systems where losing data",
    "start": "2318280",
    "end": "2326200"
  },
  {
    "text": "is okay um it can be figured out later without any business impact",
    "start": "2326200",
    "end": "2333160"
  },
  {
    "text": "um there are a lot of businesses like that uh but unfortunately I don't deal in any of them you know so the impact of",
    "start": "2333160",
    "end": "2340780"
  },
  {
    "text": "losing a million dollar trade that is much more than a million dollars uh you know that that uh you know two large",
    "start": "2340780",
    "end": "2347619"
  },
  {
    "text": "numbers of entities so a lot of times when you're thinking of uh whether it be",
    "start": "2347619",
    "end": "2352960"
  },
  {
    "text": "security quality performance and even you know fault",
    "start": "2352960",
    "end": "2358240"
  },
  {
    "text": "tolerance it comes down to what's the business impact and how much does it work um you know certain certain things just",
    "start": "2358240",
    "end": "2365200"
  },
  {
    "text": "you know the business impact is too big therefore you need to spend additional time and come up with the right thing",
    "start": "2365200",
    "end": "2371320"
  },
  {
    "text": "right so Sebastian asked a question around um blue green deployment a b testing and",
    "start": "2371320",
    "end": "2378099"
  },
  {
    "text": "24 7 kind of your thoughts on um on how do you deal with things like blueberry",
    "start": "2378099",
    "end": "2384160"
  },
  {
    "text": "employment and a b testing is it all really like the the trickiness around that state that you were talking about",
    "start": "2384160",
    "end": "2389980"
  },
  {
    "text": "with that log replication what how do you what are your thoughts",
    "start": "2389980",
    "end": "2395619"
  },
  {
    "text": "so it is something like a b testing is an interesting way of thinking uh is a",
    "start": "2395619",
    "end": "2401680"
  },
  {
    "text": "interesting mental exercise to think about with something like a cluster where it's replicated right so how do you do a b",
    "start": "2401680",
    "end": "2409780"
  },
  {
    "text": "testing um in that case you almost have to have two different systems right one that is",
    "start": "2409780",
    "end": "2415060"
  },
  {
    "text": "running one version and one that's running a separate version or they're running the same version but the feature",
    "start": "2415060",
    "end": "2420099"
  },
  {
    "text": "flags are different between the two um and then you're feeding that back in to you know to another system uh there's",
    "start": "2420099",
    "end": "2428200"
  },
  {
    "text": "only that real way to do that because any other way that you do it introduces uh a opportunity for Divergence of those",
    "start": "2428200",
    "end": "2437619"
  },
  {
    "text": "replicas which is hard to recognize once you because once you put any type of in",
    "start": "2437619",
    "end": "2442980"
  },
  {
    "text": "non-deterministic Behavior into a system and that you're relying on replication",
    "start": "2442980",
    "end": "2448420"
  },
  {
    "text": "um that non-determinism will replicate just as quickly as everything else um and so you do not want that",
    "start": "2448420",
    "end": "2456220"
  },
  {
    "text": "so you always have to think of it as two separate systems right two separate systems yet",
    "start": "2456220",
    "end": "2461859"
  },
  {
    "text": "um so there's a few things that you talked about in your talk deterministic durable consensus I want to dive in just",
    "start": "2461859",
    "end": "2468820"
  },
  {
    "text": "for specific on a few of these like deterministic deterministic system is something that given a set of inputs",
    "start": "2468820",
    "end": "2474760"
  },
  {
    "text": "gives you the same results dive a little bit more into that what what does that mean in practical sense for folks",
    "start": "2474760",
    "end": "2482880"
  },
  {
    "text": "so um you know deterministic systems mean that the same input gives you the same output for all the replicas right",
    "start": "2483040",
    "end": "2491079"
  },
  {
    "text": "um and what that really means is that the same input sequence can be thought",
    "start": "2491079",
    "end": "2497500"
  },
  {
    "text": "of as being um you know immutable right you don't go back and add or change it or anything",
    "start": "2497500",
    "end": "2504060"
  },
  {
    "text": "they always present the the same the same state uh for example",
    "start": "2504060",
    "end": "2510099"
  },
  {
    "text": "when you add non-determinism in a couple different things that you could do to add non-determinism you could have a",
    "start": "2510099",
    "end": "2517720"
  },
  {
    "text": "piece of Randomness that is using a different seed on each node that is non-deterministic right because they",
    "start": "2517720",
    "end": "2524440"
  },
  {
    "text": "would then diverge at some point uh that is important where they would have different state",
    "start": "2524440",
    "end": "2530320"
  },
  {
    "text": "um a couple other things that you might do that is a source of non-determinism",
    "start": "2530320",
    "end": "2535780"
  },
  {
    "text": "is data structures that don't iterate the same like you might go through and",
    "start": "2535780",
    "end": "2541720"
  },
  {
    "text": "iterate through something like let's say a map a hash map but it's different",
    "start": "2541720",
    "end": "2547300"
  },
  {
    "text": "iteration order at different replicas if your iteration order has some impact",
    "start": "2547300",
    "end": "2552579"
  },
  {
    "text": "into the state uh that you would come up with that is a source of non-determinism",
    "start": "2552579",
    "end": "2557980"
  },
  {
    "text": "right A lot of the things that we end up uh doing in you know in basically",
    "start": "2557980",
    "end": "2563980"
  },
  {
    "text": "business logic uh has a lot of non-deterministic aspects",
    "start": "2563980",
    "end": "2569320"
  },
  {
    "text": "to it that we don't realize the data structures some of the details about you know how different things",
    "start": "2569320",
    "end": "2575920"
  },
  {
    "text": "function we it's it's very interesting to see that some of the practices we've",
    "start": "2575920",
    "end": "2581800"
  },
  {
    "text": "developed over the years are are very non-deterministic here's another source of non-determinism",
    "start": "2581800",
    "end": "2587500"
  },
  {
    "text": "reading from files on disk that are different between different replicas",
    "start": "2587500",
    "end": "2592660"
  },
  {
    "text": "yeah that is another source of non-determinism so so but when you have a system that is deterministic you you",
    "start": "2592660",
    "end": "2600160"
  },
  {
    "text": "you do have something powerful so what are some ways to deal with that",
    "start": "2600160",
    "end": "2605680"
  },
  {
    "text": "like reading from files for example I mean are there some Frameworks out there some things they can like some some uh",
    "start": "2605680",
    "end": "2612040"
  },
  {
    "text": "projects out there that that may help us along some of these lines oh",
    "start": "2612040",
    "end": "2617880"
  },
  {
    "text": "well for for me I think about everything should come in through that log your",
    "start": "2617880",
    "end": "2623619"
  },
  {
    "text": "um you know uh the reason why you go to a file is usually to get some other piece of data",
    "start": "2623619",
    "end": "2629140"
  },
  {
    "text": "um and if you're going to go to that file to get it you should be going to the same place for all the different",
    "start": "2629140",
    "end": "2634300"
  },
  {
    "text": "replicas right so it should be a service it should be you're going and grabbing the same piece of data that serve that",
    "start": "2634300",
    "end": "2640839"
  },
  {
    "text": "service that you're going to should be uh deterministic as well uh and give you the same the the same result",
    "start": "2640839",
    "end": "2647800"
  },
  {
    "text": "um you know those those types of of things are important you know are you can't get around those",
    "start": "2647800",
    "end": "2654040"
  },
  {
    "text": "um but I'd like to actually most of the time when you go to a file you're looking for something very small you're not looking for a large piece of data",
    "start": "2654040",
    "end": "2660099"
  },
  {
    "text": "and I like having that come into the law because it's a fact in the log right it's a it's a command almost right and",
    "start": "2660099",
    "end": "2668140"
  },
  {
    "text": "in that case you can look at it instead of reading it from a file you get it pushed into the system externally and",
    "start": "2668140",
    "end": "2675520"
  },
  {
    "text": "usually that's also an indication that you need that piece of data at that particular point in the log which is",
    "start": "2675520",
    "end": "2681220"
  },
  {
    "text": "actually itself a very interesting way to think about how you would normally you know push things into it",
    "start": "2681220",
    "end": "2687700"
  },
  {
    "text": "um and really when you come to think about it that piece that comes into the",
    "start": "2687700",
    "end": "2692740"
  },
  {
    "text": "log is updating the state in some way it should really come in through the log right",
    "start": "2692740",
    "end": "2698800"
  },
  {
    "text": "so Turk has a question and it's about microservices and data ownership each",
    "start": "2698800",
    "end": "2704440"
  },
  {
    "text": "microservice owning their own their own data for example um what are your thoughts on maintaining",
    "start": "2704440",
    "end": "2710740"
  },
  {
    "text": "data integrity and cross-service transactions in kind of an microservice",
    "start": "2710740",
    "end": "2716200"
  },
  {
    "text": "architecture where things on their own data like this it again I'll come back to that log what are your general thoughts",
    "start": "2716200",
    "end": "2722800"
  },
  {
    "text": "I think it actually does come back to the log um and to give you kind of an idea of how you would think about two different",
    "start": "2722800",
    "end": "2729640"
  },
  {
    "text": "clustered services that are kind of depending on one another which is a very common pattern is if you",
    "start": "2729640",
    "end": "2736359"
  },
  {
    "text": "think that Azure processing data you're sending a message to another cluster you",
    "start": "2736359",
    "end": "2742119"
  },
  {
    "text": "know another set of services then it sees that as a message coming in",
    "start": "2742119",
    "end": "2748079"
  },
  {
    "text": "processes it sends a response back to another you know to another cluster or",
    "start": "2748079",
    "end": "2753520"
  },
  {
    "text": "the same one and places that in the log so if you think about it from everything coming into the log and everything going",
    "start": "2753520",
    "end": "2760960"
  },
  {
    "text": "back out to other to other services if you think about it that way things get a lot cleaner because if you look at look",
    "start": "2760960",
    "end": "2768040"
  },
  {
    "text": "at it from that first service you see the logic that spawned that request it went out to another cluster at some",
    "start": "2768040",
    "end": "2774640"
  },
  {
    "text": "point it comes back because it's the response comes back in the log when you think about everything coming into the",
    "start": "2774640",
    "end": "2780460"
  },
  {
    "text": "log that way it's a little bit easier to think about the sequence of events that went through right right it makes sense",
    "start": "2780460",
    "end": "2786700"
  },
  {
    "text": "but finding that non-determinism and that seems like that's going to be a challenge right",
    "start": "2786700",
    "end": "2792599"
  },
  {
    "text": "yes yes once you let it seep in it it's very hard then to make your system deterministically non-deterministic",
    "start": "2792599",
    "end": "2799599"
  },
  {
    "text": "right that makes sense totally so Tony's got a question too and his question is",
    "start": "2799599",
    "end": "2804760"
  },
  {
    "text": "around Legacy code um so he has lots of Legacy code and he's wondering kind of your thoughts on",
    "start": "2804760",
    "end": "2811720"
  },
  {
    "text": "how to introduce versioning or how to update the protocol well the Legacy code",
    "start": "2811720",
    "end": "2817060"
  },
  {
    "text": "has some intolerant protocols some some older protocols and he wants to update the protocol and he's curious if",
    "start": "2817060",
    "end": "2824800"
  },
  {
    "text": "um your thoughts on how to apply versioning to update this protocol like",
    "start": "2824800",
    "end": "2829900"
  },
  {
    "text": "what strategy might you use to update this and his he's asking here do you",
    "start": "2829900",
    "end": "2835060"
  },
  {
    "text": "think it would be a good idea to do a minor version update to add versioning to the protocol and then do a major version and update the protocol what are",
    "start": "2835060",
    "end": "2841300"
  },
  {
    "text": "your thoughts how do you as someone who designs protocols how would you go about recommending him uh address the solution",
    "start": "2841300",
    "end": "2849460"
  },
  {
    "text": "I would actually call it a major version change so I would I would say that previous for you know previous versions",
    "start": "2849460",
    "end": "2855819"
  },
  {
    "text": "don't will never understand the protocol right so uh that that version scheme or",
    "start": "2855819",
    "end": "2861579"
  },
  {
    "text": "anything else so at that point I would consider them you know to it to be a breaking change that",
    "start": "2861579",
    "end": "2867940"
  },
  {
    "text": "um you know so in the semantic versioning sense will be a major protocol change and the reason why I do",
    "start": "2867940",
    "end": "2873160"
  },
  {
    "text": "it is this it's better to take the pain at that point than to push it off you really",
    "start": "2873160",
    "end": "2878920"
  },
  {
    "text": "want to take that pain at that point of now we do versioning now going forward we have this scheme of how we do",
    "start": "2878920",
    "end": "2885579"
  },
  {
    "text": "versioning and how we can rely on things to do um because if you're thinking of it from",
    "start": "2885579",
    "end": "2891579"
  },
  {
    "text": "a like we upgrade everything all at once the best place to add your versioning is when you're going to do that if you",
    "start": "2891579",
    "end": "2897280"
  },
  {
    "text": "upgrade everything all at once so that now understands versioning now afterwards you can pick and choose",
    "start": "2897280",
    "end": "2902380"
  },
  {
    "text": "whether you need to do that totally makes sense going in yeah but going into it you do not want an older piece that",
    "start": "2902380",
    "end": "2909700"
  },
  {
    "text": "doesn't understand that version to or you know there even is versioning to try",
    "start": "2909700",
    "end": "2915400"
  },
  {
    "text": "to do anything else it's it's got to be a big change um uh you know I think you take that",
    "start": "2915400",
    "end": "2921160"
  },
  {
    "text": "pain up initially and then later on you can you get you reap the benefits of taking that pain",
    "start": "2921160",
    "end": "2926800"
  },
  {
    "text": "so we're at time Todd uh once again I always enjoy hearing your talks always come away with things that I need to be",
    "start": "2926800",
    "end": "2933579"
  },
  {
    "text": "thinking about or I'm like oh I've never even thought of it like that so I always enjoy that any final thoughts for the",
    "start": "2933579",
    "end": "2939400"
  },
  {
    "text": "group before we uh part ways no no I'm just a whole you know my my",
    "start": "2939400",
    "end": "2946839"
  },
  {
    "text": "pure uh idea here is just to give people thinking about things in a different way uh that stuff that I actually do talk",
    "start": "2946839",
    "end": "2954339"
  },
  {
    "text": "talk about a good bit and you know I just hope it was useful yeah absolutely",
    "start": "2954339",
    "end": "2959500"
  },
  {
    "text": "the snapshottings will replaying of the logs all those things definitely are things that I've seen in practice quite",
    "start": "2959500",
    "end": "2964660"
  },
  {
    "text": "a bit so thank you very much and uh we'll see you with the next talk thank you all right thanks everyone",
    "start": "2964660",
    "end": "2973020"
  },
  {
    "text": "[Music]",
    "start": "2975560",
    "end": "2981010"
  }
]