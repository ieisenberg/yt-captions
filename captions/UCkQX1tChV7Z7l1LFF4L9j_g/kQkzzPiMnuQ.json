[
  {
    "start": "0",
    "end": "87000"
  },
  {
    "text": "so a couple uh Logistics things right out of the bat first actually I haven't done this talk before so you can just assume I'm a total Noob and all mistakes",
    "start": "4480",
    "end": "11200"
  },
  {
    "text": "are because it's new um we've given parts of this um at um ozcon about a",
    "start": "11200",
    "end": "17560"
  },
  {
    "text": "year ago when we first released bless as an open source project um but what I'm back today to talk about is sort of what",
    "start": "17560",
    "end": "24320"
  },
  {
    "text": "it means to run bless and what have we learned about doing that over over the past year and um so the thing is to get",
    "start": "24320",
    "end": "30840"
  },
  {
    "text": "there I need to repeat a couple slides from last time around so that you guys actually know what bless is so we'll",
    "start": "30840",
    "end": "36040"
  },
  {
    "text": "we'll spend some time talking about that and then we'll get into the other stuff um a couple other interesting words of note as we get started I put stickers on",
    "start": "36040",
    "end": "42960"
  },
  {
    "text": "the tables because I love stickers so if you guys love stickers too feel free to grab one we got the Blessed logo and um",
    "start": "42960",
    "end": "50360"
  },
  {
    "text": "I also have a whole ton of other Netflix stickers so if anyone's into that uh come track me down I got chaos monkey",
    "start": "50360",
    "end": "55879"
  },
  {
    "text": "and other fun things so um let's see one other word of notes I know a lot of people sometimes like to take pictures",
    "start": "55879",
    "end": "61640"
  },
  {
    "text": "during the talk um totally fine if you want to do that but just as a FYI the slides are all available online they're",
    "start": "61640",
    "end": "68159"
  },
  {
    "text": "going to be on the cucon website and I also have them um off my personal web page on a on a speaker deck page um so",
    "start": "68159",
    "end": "73520"
  },
  {
    "text": "they're actually there right now um so if you're Savvy enough you can probably Google them and find them uh off of my personal page uh or you can go grab them",
    "start": "73520",
    "end": "80159"
  },
  {
    "text": "later so there's no need to take you know pictures when you can add the full res PDF later on all",
    "start": "80159",
    "end": "85920"
  },
  {
    "text": "right with that so imagine you walk into work one day and you find this on your",
    "start": "85920",
    "end": "91880"
  },
  {
    "start": "87000",
    "end": "142000"
  },
  {
    "text": "computer um this was the case with some people at Sony about two and a half years ago um when the big Sony hack",
    "start": "91880",
    "end": "99240"
  },
  {
    "text": "happened how many of you guys are familiar with the Sony hack yeah so I figure I probably don't need to go into",
    "start": "99240",
    "end": "104840"
  },
  {
    "text": "a ton of detail suffice to say um some adversaries got in and uh there's a lot",
    "start": "104840",
    "end": "111600"
  },
  {
    "text": "of stories online about um what people thought might happen or or kind of the the after effect and all the data they",
    "start": "111600",
    "end": "117880"
  },
  {
    "text": "got out but the assumption is that these adversaries were actually in their systems for quite some time because they",
    "start": "117880",
    "end": "123000"
  },
  {
    "text": "were able to pull out you know over 100 gigabytes of information and a lot of the stuff that you saw in the news was",
    "start": "123000",
    "end": "130479"
  },
  {
    "text": "um you know movies that got leaked um really sensitive internal corporate emails financial documents those kinds",
    "start": "130479",
    "end": "136519"
  },
  {
    "text": "of things because those are the kinds of things that you would expect to see on CNN however if you went over to Reddit",
    "start": "136519",
    "end": "144200"
  },
  {
    "start": "142000",
    "end": "218000"
  },
  {
    "text": "you would have seen a little more information about what got leaked um so the adversaries actually posted readme",
    "start": "144200",
    "end": "150400"
  },
  {
    "text": "files um that indicated here's all the information here's all the files that we leaked out and uh someone thought it",
    "start": "150400",
    "end": "157319"
  },
  {
    "text": "would be interesting to grep that for things that might indicate private keys and they found uh they found this on the",
    "start": "157319",
    "end": "164640"
  },
  {
    "text": "other side of the column just camera actually gets you all right I'm gonna be over here sorry",
    "start": "164640",
    "end": "171239"
  },
  {
    "text": "guys um so so lots of private keys and as you can see some of these appear to",
    "start": "171239",
    "end": "176640"
  },
  {
    "text": "be either SFTP or SSH Keys okay so um",
    "start": "176640",
    "end": "182080"
  },
  {
    "text": "why would an adversary go after your SSH Keys it's probably pretty obvious if you want to do movement inside your network",
    "start": "182080",
    "end": "189280"
  },
  {
    "text": "once you get in these are extremely valuable and it turns out that SSH keys don't get rotated particularly often um",
    "start": "189280",
    "end": "196440"
  },
  {
    "text": "a lot of people tend not to put a password protection on their private key and um in fact I did a little study a",
    "start": "196440",
    "end": "203200"
  },
  {
    "text": "while back and I found well over 50% do not put a password on their private key",
    "start": "203200",
    "end": "208400"
  },
  {
    "text": "um we'll just leave it at that and um and so they're very very useful",
    "start": "208400",
    "end": "214040"
  },
  {
    "text": "it's it's like having a password except usually it's to even juicier places in your kingdom and it's not just Sony",
    "start": "214040",
    "end": "220319"
  },
  {
    "start": "218000",
    "end": "302000"
  },
  {
    "text": "right uh there's a lot of other places where this has been going on um if I just kind of scroll through a few news",
    "start": "220319",
    "end": "226959"
  },
  {
    "text": "articles you'll see this was last fall a bunch of embedded devices had their SSH Keys leaked so that people could get",
    "start": "226959",
    "end": "233959"
  },
  {
    "text": "into them uh we had a company that makes pbxs um they didn't actually have a",
    "start": "233959",
    "end": "242360"
  },
  {
    "text": "source code problem per se but someone came in um to their corporate Network",
    "start": "242360",
    "end": "247959"
  },
  {
    "text": "and their customer support Personnel had a whole bunch of SSH keys and other ways to get into their customers locations to",
    "start": "247959",
    "end": "255000"
  },
  {
    "text": "do customer support and service and so um someone got into that Network got",
    "start": "255000",
    "end": "260919"
  },
  {
    "text": "that information and then of course all their customers were put in a vulnerable",
    "start": "260919",
    "end": "266240"
  },
  {
    "text": "situation um there was a um breach at Expedia and um while it's not clear",
    "start": "267639",
    "end": "274800"
  },
  {
    "text": "exactly if they used SSH keys to get around they certainly got some admin accounts and started walking around with",
    "start": "274800",
    "end": "279919"
  },
  {
    "text": "those and so discussions around some of the implications of that um a while back some folks got some SSH keys from",
    "start": "279919",
    "end": "286360"
  },
  {
    "text": "FreeBSD developers and wreck some havoc on their servers uh there was some stols",
    "start": "286360",
    "end": "291440"
  },
  {
    "text": "keys around Linux developers again recking some Havoc here's some malware that is uh specifically going after your",
    "start": "291440",
    "end": "297440"
  },
  {
    "text": "SSH Keys um this was from a couple years ago but malware today still does that so you know the point is there's a lot of",
    "start": "297440",
    "end": "305080"
  },
  {
    "start": "302000",
    "end": "395000"
  },
  {
    "text": "these things right and um and this is a very juicy Target this is something that attackers are going to go after as soon",
    "start": "305080",
    "end": "310400"
  },
  {
    "text": "as they get into your world and um and so this is actually from an RSA blog um",
    "start": "310400",
    "end": "316479"
  },
  {
    "text": "about how attackers operate and it's actually kind of nice that I can tee off of the keynote this morning because",
    "start": "316479",
    "end": "321520"
  },
  {
    "text": "there was some discussion around the threat that attackers provide it's interesting that RSA has this really",
    "start": "321520",
    "end": "327720"
  },
  {
    "text": "nice graphic for it because of course they themselves were the victim of such an attack so they're a really great",
    "start": "327720",
    "end": "332960"
  },
  {
    "text": "place to uh publish this they know exactly what it's all about um I found this was a nice overview so I I kind of",
    "start": "332960",
    "end": "339560"
  },
  {
    "text": "reproduced it here I mean basically you're going to go in with a fishing attack um which is kind of like what we heard about this morning set up some",
    "start": "339560",
    "end": "346240"
  },
  {
    "text": "sort of back door so you can get in the system that can be the webshell that they were talking about that can be um",
    "start": "346240",
    "end": "351280"
  },
  {
    "text": "any other sort of implant on your system to get in then you start to do this lateral movement that just means you're going to go from one system to another",
    "start": "351280",
    "end": "357440"
  },
  {
    "text": "to another to another until you find all the juice bits within the ecosystem sort of a discovery phase but how do you move",
    "start": "357440",
    "end": "363240"
  },
  {
    "text": "laterally well you get SSH Keys you get admin credentials you get other pieces that allow you to move between these",
    "start": "363240",
    "end": "368560"
  },
  {
    "text": "machines um from there you collect all of your data that you want to get out you do something to package it up maybe",
    "start": "368560",
    "end": "374960"
  },
  {
    "text": "you encrypt it maybe you compress it and then you find some way to get it out typically you're going to take it from",
    "start": "374960",
    "end": "380919"
  },
  {
    "text": "whatever the uh organization's network is that you're in and bring it out to some sort of other compromis machine maybe take it through a couple hops so",
    "start": "380919",
    "end": "387360"
  },
  {
    "text": "that it's harder to trace it back to you all right this is this is how it works and so those SSH Keys become a very",
    "start": "387360",
    "end": "394319"
  },
  {
    "text": "important step um so that's fine it seems obvious we all need to protect our",
    "start": "394319",
    "end": "399599"
  },
  {
    "start": "395000",
    "end": "453000"
  },
  {
    "text": "SSH Keys um we can all go home now right so everyone's good with that so what's really the problem here",
    "start": "399599",
    "end": "406120"
  },
  {
    "text": "um the problem here is that we we also need to use these SSH keys and so we need to sort of balance the uh the",
    "start": "406120",
    "end": "411479"
  },
  {
    "text": "usability around it and the fact that developers actually have a job that they need to do um with the fact that we have to protect these things so at uh Netflix",
    "start": "411479",
    "end": "418639"
  },
  {
    "text": "we use a tool called Spiner um for continuous deployment systems and here's",
    "start": "418639",
    "end": "424000"
  },
  {
    "text": "just an example each of these little rectangles represents an instance in the cloud and what I'm showing here is",
    "start": "424000",
    "end": "430759"
  },
  {
    "text": "you've got one rectangle that's red so when you have a scenario like that sometimes you want to SSH into that",
    "start": "430759",
    "end": "436319"
  },
  {
    "text": "system and figure out what's going on you know why is that system not healthy well um I'll have a demo later",
    "start": "436319",
    "end": "443000"
  },
  {
    "text": "that kind of walks you through exactly how we do this but bottom line is when you SSH from your laptop into that",
    "start": "443000",
    "end": "449000"
  },
  {
    "text": "instance you ideally should be authenticating to prove that you're someone that's allowed to do this um and",
    "start": "449000",
    "end": "454240"
  },
  {
    "start": "453000",
    "end": "497000"
  },
  {
    "text": "how should you do that uh maybe ldap would be interesting you can integrate that with um SSH do do any of you guys",
    "start": "454240",
    "end": "460639"
  },
  {
    "text": "do that couple of hands okay um I actually",
    "start": "460639",
    "end": "466199"
  },
  {
    "text": "was expecting to see more because that's I've heard a lot of people doing that in the past um we we tend to avoid it",
    "start": "466199",
    "end": "471520"
  },
  {
    "text": "personally the reason why we don't like it is because uh it adds another dependency and another failure point",
    "start": "471520",
    "end": "477440"
  },
  {
    "text": "right so uh if your Lup service goes down down then craziness ensues and by the way if you've ever managed an elap",
    "start": "477440",
    "end": "483560"
  },
  {
    "text": "service enough said um and if you're not the one that manages the elap Service uh go talk to your EP administrators and",
    "start": "483560",
    "end": "489800"
  },
  {
    "text": "ask them about a future world where they don't have to do that anymore and see them smile and all that stuff it's really great so yeah um okay so no ldap",
    "start": "489800",
    "end": "498599"
  },
  {
    "start": "497000",
    "end": "650000"
  },
  {
    "text": "so how do we actually do this well if you look at sort of common recommendations uh if you go to AWS and",
    "start": "498599",
    "end": "504639"
  },
  {
    "text": "say hey I need to do SSH how do you how do you suggest I do this they're going to show you something along these lines",
    "start": "504639",
    "end": "510400"
  },
  {
    "text": "um basically as you deploy your instances um you can just have them inject an SSH public key onto each",
    "start": "510400",
    "end": "516560"
  },
  {
    "text": "instance and then each of the operators can ssh in seems reasonable enough uh the challenge is if I do that then that",
    "start": "516560",
    "end": "522880"
  },
  {
    "text": "means that there's a private key that each of those developers has and they need to use that to get onto those",
    "start": "522880",
    "end": "528560"
  },
  {
    "text": "instances right um and so I can either have a different private key for every developer you add up how many developers",
    "start": "528560",
    "end": "534600"
  },
  {
    "text": "you have and realize okay that's probably not a good idea I could have the same private key for every developer and then you fire someone and that's not",
    "start": "534600",
    "end": "540000"
  },
  {
    "text": "a good idea and so so this actually doesn't scale very well this might work if you have one or two people but as you",
    "start": "540000",
    "end": "545839"
  },
  {
    "text": "get to more you pretty quickly say we need a layer of abstraction because that's how we solve all problems so we add a Bastion to the picture and then",
    "start": "545839",
    "end": "552440"
  },
  {
    "text": "the Bastion is a great place to put your private key you have the operators log into the Bastion they authenticate",
    "start": "552440",
    "end": "557880"
  },
  {
    "text": "through some other manage mechanism maybe in this case it could be elap but preferably like SSH Keys again or",
    "start": "557880",
    "end": "564560"
  },
  {
    "text": "something like that um it's kind of turtles all the way down but let's talk about what you do from the Bastion the instances right in that scenario um the",
    "start": "564560",
    "end": "571920"
  },
  {
    "text": "Bastion maybe is set up to be super secure so you put the private key on there and when people log into the",
    "start": "571920",
    "end": "577560"
  },
  {
    "text": "Bastion they can issue some command that will then get them from there to where they want to go um and assuming that the",
    "start": "577560",
    "end": "583680"
  },
  {
    "text": "Bastion is always perfectly secure and there's no such thing as local privilege elevation and that kind of stuff then we're good to go the problem here is",
    "start": "583680",
    "end": "591040"
  },
  {
    "text": "that at the end of the day that private key on the Bastion is really hard to protect and it is really hard to avoid",
    "start": "591040",
    "end": "597880"
  },
  {
    "text": "local privilege elevations and if that were ever compromised then",
    "start": "597880",
    "end": "603519"
  },
  {
    "text": "you're in a situation where you need to go touch every single one of those instances that you have deployed um to update them to a new key so that you can",
    "start": "603519",
    "end": "610519"
  },
  {
    "text": "then roll out new keys in the bastions and I don't know about everyone else's infrastructure but we've got on the",
    "start": "610519",
    "end": "615959"
  },
  {
    "text": "order of 100,000 plus instances in the cloud um even if I have an automated solution to do that the time window to",
    "start": "615959",
    "end": "622040"
  },
  {
    "text": "go through and just smash the whole system with a bunch of new keys is going to be longer than I would prefer to be",
    "start": "622040",
    "end": "627320"
  },
  {
    "text": "vulnerable right um and chances are some of those instances are the old crusty ones that might not have an SSH and I",
    "start": "627320",
    "end": "632920"
  },
  {
    "text": "can't get it or you know other issues and so that just becomes a Trail of Tears so we stepped back and we said",
    "start": "632920",
    "end": "638000"
  },
  {
    "text": "well how do we actually make this better right where do we go with this and um we",
    "start": "638000",
    "end": "643079"
  },
  {
    "text": "kind of pushed everything aside and said okay I need to figure out what properties I want out of the system and then I'm going to start building a",
    "start": "643079",
    "end": "648920"
  },
  {
    "text": "system to create those properties and when we looked at it first we're from Netflix so we get really cool graphics",
    "start": "648920",
    "end": "655360"
  },
  {
    "start": "650000",
    "end": "707000"
  },
  {
    "text": "um we said one of the things that we really want is single use SSH keys right",
    "start": "655360",
    "end": "661680"
  },
  {
    "text": "what if I had a very short time life on every key that I issued I used it once and then it wasn't valid anymore so if I",
    "start": "661680",
    "end": "668880"
  },
  {
    "text": "lost that private key uh the the scope of that um problem is very very reduced",
    "start": "668880",
    "end": "674560"
  },
  {
    "text": "compared if I lost the private key in the Bastion it's a very bad day all right well that would be great",
    "start": "674560",
    "end": "680680"
  },
  {
    "text": "um what if what if every time someone used that key it left really good Clues",
    "start": "680680",
    "end": "686200"
  },
  {
    "text": "behind right so excellent audit Trail nice logging and I always knew what was going on that'd be pretty nice I'm a",
    "start": "686200",
    "end": "692519"
  },
  {
    "text": "security guy I love lot of trails and finally what if it offered really really strong projections in general right I",
    "start": "692519",
    "end": "698639"
  },
  {
    "text": "what if I could protect this system um way more than I can protect the system they had today that would be great I",
    "start": "698639",
    "end": "703800"
  },
  {
    "text": "would feel as a security guy very comfortable if we could achieve all those things at once and so that's what we aimed to do",
    "start": "703800",
    "end": "710440"
  },
  {
    "start": "707000",
    "end": "880000"
  },
  {
    "text": "um and I'm going to talk about how we got there with this system called Bless but but first it's probably useful to step back and look at um SSH",
    "start": "710440",
    "end": "717440"
  },
  {
    "text": "authentication in general now I'm not going to give you a master class on protocol security here and this is",
    "start": "717440",
    "end": "723240"
  },
  {
    "text": "intentionally a little bit small I'm not expecting you to see each of the lines but the really interesting point here is",
    "start": "723240",
    "end": "729000"
  },
  {
    "text": "that this is basically what happens when you do a network connection between a client and a server and there's a public",
    "start": "729000",
    "end": "736320"
  },
  {
    "text": "key authentication happening with SSH right so you've done SSH key gen you've got your keys in place you set up the",
    "start": "736320",
    "end": "742000"
  },
  {
    "text": "connection and it sends a variety of uh information back and forth it establishes a key for your session and",
    "start": "742000",
    "end": "748160"
  },
  {
    "text": "then starting down here messages are now encrypted and we go down and we can see all those pieces come together now",
    "start": "748160",
    "end": "755360"
  },
  {
    "text": "there's another mode in SSH um is anyone familiar with SSH",
    "start": "755360",
    "end": "761240"
  },
  {
    "text": "certificates any hands just a couple okay so SSH certificates work a lot like the SSH",
    "start": "761240",
    "end": "768959"
  },
  {
    "text": "public key mechanism except now it's a certificate which means some Authority can sign it to indicate that it's valid",
    "start": "768959",
    "end": "776240"
  },
  {
    "text": "and just like you would think about certificates in the browser World um you can have your SSH service set up to",
    "start": "776240",
    "end": "783639"
  },
  {
    "text": "trust um a particular signing Authority and then any certificate from that Authority is allowed into your system so",
    "start": "783639",
    "end": "791480"
  },
  {
    "text": "this works out pretty well um turns out the protocol is pretty much exactly the same there's just a couple of small",
    "start": "791480",
    "end": "798800"
  },
  {
    "text": "differences and those differences are highlighted here and that is at the initial setup instead of doing that",
    "start": "798800",
    "end": "804160"
  },
  {
    "text": "public key we actually have to get away to create a certificate and we have to sign that certificate somehow",
    "start": "804160",
    "end": "809399"
  },
  {
    "text": "and on the uh server side we actually need to set up a uh a trust store like a certificate Authority file that says",
    "start": "809399",
    "end": "815279"
  },
  {
    "text": "here's the public key of the certificate we're going to trust this and we're going to move forward okay and then all",
    "start": "815279",
    "end": "821079"
  },
  {
    "text": "the way down at the um place where we actually validate that the session is good to go of course we're checking the",
    "start": "821079",
    "end": "826880"
  },
  {
    "text": "certificate against the certificate Authority instead of the traditional public key thing um and that's it",
    "start": "826880",
    "end": "832320"
  },
  {
    "text": "everything else is identical so this this is a pretty much battle tested setup it's not some sort of esoteric",
    "start": "832320",
    "end": "837920"
  },
  {
    "text": "thing right this is this is something we can trust but the really cool thing is that now we can take those",
    "start": "837920",
    "end": "845320"
  },
  {
    "text": "operations the signing operations on those SS certificates and move them to a third machine right we can have a",
    "start": "845320",
    "end": "852120"
  },
  {
    "text": "separate certificate Authority that it's sole job in life is to sign these certificates for clients to get into",
    "start": "852120",
    "end": "857759"
  },
  {
    "text": "servers and why I like that so much and I get so excited as a security guy is",
    "start": "857759",
    "end": "863160"
  },
  {
    "text": "now the private key that is the security of my entire ecosystem is often some",
    "start": "863160",
    "end": "868360"
  },
  {
    "text": "corn that has a single purpose in life right it's not on a Bastion where someone can get to it I can protect it and defend",
    "start": "868360",
    "end": "874480"
  },
  {
    "text": "against it quite a bit better um and so that uh starts to look really really nice and that is exactly what bless",
    "start": "874480",
    "end": "882240"
  },
  {
    "start": "880000",
    "end": "891000"
  },
  {
    "text": "provides for you so bless is one of these forced acronyms um stands for bastion's Lambda",
    "start": "882240",
    "end": "888040"
  },
  {
    "text": "ephemeral SSH service let's not worry about that let's just focus on the logo like I said we have stickers you",
    "start": "888040",
    "end": "894680"
  },
  {
    "text": "can come get them all right stickers look just like that and um what is this ephemeral piece um and what",
    "start": "894680",
    "end": "901360"
  },
  {
    "text": "is this Lambda piece well have anyone has anyone here used uh AWS Lambda good",
    "start": "901360",
    "end": "907000"
  },
  {
    "text": "lots of hands all right so um 8B Lambda is super cool because you don't have to worry about anything other than the",
    "start": "907000",
    "end": "913120"
  },
  {
    "text": "function that you write and you want to run right so you don't have to worry about the OS underneath or anything like this and it just runs this um you take a",
    "start": "913120",
    "end": "920160"
  },
  {
    "text": "small bit of code and drop it in and they'll run it for you um now the bless",
    "start": "920160",
    "end": "925920"
  },
  {
    "text": "world we basically use a Lambda as our certificate Authority uh and then you have a Bastion",
    "start": "925920",
    "end": "934040"
  },
  {
    "text": "that makes a call to that Lambda function saying here is um the public key I need you to sign it I need you to",
    "start": "934040",
    "end": "940440"
  },
  {
    "text": "turn this into a certificate and then it Returns the certificate back and then the Bastion can then go use that um and",
    "start": "940440",
    "end": "946759"
  },
  {
    "text": "that's that's super great now the problem is the lambdas they actually don't have any persistent storage uh and",
    "start": "946759",
    "end": "952959"
  },
  {
    "text": "so you need someplace to store that private key that you're using to sign everything and you know we're fortunate",
    "start": "952959",
    "end": "959519"
  },
  {
    "text": "enough that AWS also has this whole KMS service so you can store your keys in there and you get a pretty good amount",
    "start": "959519",
    "end": "965600"
  },
  {
    "text": "of security on them so all of a sudden I don't have to maintain this thing in any meaningful way uh and I can have a",
    "start": "965600",
    "end": "972880"
  },
  {
    "text": "pretty high confidence that the security of it is pretty good right uh so that's pretty fantastic and then I come full",
    "start": "972880",
    "end": "978639"
  },
  {
    "text": "circle and once I get that certificate back I can log into my instances with it so that's bless in a nutshell uh rest of",
    "start": "978639",
    "end": "985880"
  },
  {
    "text": "the talk we're going to get into a little more details about how this actually works um but first let's look at SSH",
    "start": "985880",
    "end": "991440"
  },
  {
    "start": "988000",
    "end": "1126000"
  },
  {
    "text": "certificates uh because I think it's it's super cool um you can do a lot of stuff with them this is an idea of what",
    "start": "991440",
    "end": "997639"
  },
  {
    "text": "an SSH certificate looks like you've got a whole bunch of information here um",
    "start": "997639",
    "end": "1002720"
  },
  {
    "text": "that you can use to scope where the certificate can be used um for example",
    "start": "1002720",
    "end": "1008440"
  },
  {
    "text": "right out of the gate you can decide if this is a certificate for a user or a host um you can control what information",
    "start": "1008440",
    "end": "1016360"
  },
  {
    "text": "gets logged when some someone logs into your service with this certificate and that's in this key ID field now this is",
    "start": "1016360",
    "end": "1023079"
  },
  {
    "text": "super cool because that means at the time that this that we're minting this certificate we can package up a whole",
    "start": "1023079",
    "end": "1028438"
  },
  {
    "text": "bunch of information like who's this user what Bastion are they coming from um what's the lifespan of this",
    "start": "1028439",
    "end": "1034640"
  },
  {
    "text": "certificate all sorts of interesting things that you might care to create an audit Trail for you can just bake right",
    "start": "1034640",
    "end": "1039959"
  },
  {
    "text": "into there and then it automatically gets logged for you um let's see we've got the ability",
    "start": "1039959",
    "end": "1045839"
  },
  {
    "text": "to set a uh time span that these are valid for right so if you're using it the way that we use it where you have a Bastion and",
    "start": "1045839",
    "end": "1052600"
  },
  {
    "text": "then you're going to turn right around and use the certificate to log into your instance you can make it good for about five minutes that should be plenty and",
    "start": "1052600",
    "end": "1059559"
  },
  {
    "text": "then uh and then you know that even if that was stolen it would only be useful in those five minutes but we can",
    "start": "1059559",
    "end": "1065919"
  },
  {
    "text": "actually do even better than that we can say that when you get on to the instance",
    "start": "1065919",
    "end": "1072200"
  },
  {
    "text": "um I'm going to define a principle and that principle basically defines what I'm allowed to do when I get onto that instance so think of this as mapping to",
    "start": "1072200",
    "end": "1080679"
  },
  {
    "text": "specific users or specific um operations on the instance that you're going into",
    "start": "1080679",
    "end": "1085760"
  },
  {
    "text": "and you can pretty arbitrarily do this so we'll get into some examples of that later so you can scope it down further",
    "start": "1085760",
    "end": "1091400"
  },
  {
    "text": "there I can also scope it down further by saying this certificate is only valid coming from a particular IP address",
    "start": "1091400",
    "end": "1098880"
  },
  {
    "text": "right so this will only work if you come from a Bastion well that's pretty cool so if someone steals it and takes it and tries",
    "start": "1098880",
    "end": "1105120"
  },
  {
    "text": "to use it from somewhere else it won't even work at all all right and finally you can set up all",
    "start": "1105120",
    "end": "1111799"
  },
  {
    "text": "the typical SSH fun uh that controls your session right so you can you can further scope it there in any way that",
    "start": "1111799",
    "end": "1118400"
  },
  {
    "text": "you see fit so this is pretty cool you can do a lot of fun stuff um you can scope these",
    "start": "1118400",
    "end": "1124720"
  },
  {
    "text": "things for a short period of time um let's talk a little bit about how we would use this um there's a couple ways",
    "start": "1124720",
    "end": "1131200"
  },
  {
    "start": "1126000",
    "end": "1324000"
  },
  {
    "text": "you can imagine setting this up uh a very straightforward way is to",
    "start": "1131200",
    "end": "1136320"
  },
  {
    "text": "say if my developer can can access a particular Bastion then I'm going to",
    "start": "1136320",
    "end": "1142039"
  },
  {
    "text": "allow them to access any system that sits behind that Bastion it's the",
    "start": "1142039",
    "end": "1147520"
  },
  {
    "text": "simplest possible authorization policy I Can Dream up um it's basically wide open",
    "start": "1147520",
    "end": "1153480"
  },
  {
    "text": "you might have different bastions for different segments within your world um but if you can get onto the Bastion then",
    "start": "1153480",
    "end": "1158799"
  },
  {
    "text": "you're good to go so in this case um bless doesn't actually have a whole lot to do in terms of deciding additional",
    "start": "1158799",
    "end": "1165679"
  },
  {
    "text": "authorization steps it's just going to say if you're on the Bastion I I'll go ahead and cut a sht for you but you might want something a",
    "start": "1165679",
    "end": "1172559"
  },
  {
    "text": "little finer grain and we sort of we this is kind of where we started and then we kind of realized over the time",
    "start": "1172559",
    "end": "1177919"
  },
  {
    "text": "period that it's useful to have a little more and so the next step could be something like this all right I'm on the",
    "start": "1177919",
    "end": "1183440"
  },
  {
    "text": "Bastion but maybe I'm only allowed to go to particular apps now I don't want to",
    "start": "1183440",
    "end": "1188559"
  },
  {
    "text": "have a big Central repository of every single permission for every developer and every app so what I can do is just",
    "start": "1188559",
    "end": "1194360"
  },
  {
    "text": "push this all the way out to the instances themselves and they can set a policy and and say you have to be in",
    "start": "1194360",
    "end": "1199600"
  },
  {
    "text": "this group or you have to be this user or something like that before you can get into my app um turns out to be very",
    "start": "1199600",
    "end": "1205159"
  },
  {
    "text": "useful construct and that way um the information that bless puts into the certificate can get used instance side",
    "start": "1205159",
    "end": "1211760"
  },
  {
    "text": "and that principle to Define who's actually allowed to come through now there are some slightly more",
    "start": "1211760",
    "end": "1219159"
  },
  {
    "text": "complicated apps out there so imagine uh a use case where you have a bunch of containers on a particular instance and",
    "start": "1219159",
    "end": "1225799"
  },
  {
    "text": "those containers have different Developers are allowed to get into each one right so we have a little bit of",
    "start": "1225799",
    "end": "1231000"
  },
  {
    "text": "user multiplexing going on here maybe I don't want to say anyone that has any",
    "start": "1231000",
    "end": "1236640"
  },
  {
    "text": "container on there can get onto that host maybe what I want to do is actually have further scoping and I want to say",
    "start": "1236640",
    "end": "1242679"
  },
  {
    "text": "well this user can get into some containers and this user can get into other containers and so you can actually start to do those sort of richer things",
    "start": "1242679",
    "end": "1249240"
  },
  {
    "text": "again using these principles and multiplexing on the host side all right so I talk about",
    "start": "1249240",
    "end": "1254679"
  },
  {
    "text": "principles a lot here's a um example of how we're doing doing it uh We've uh and",
    "start": "1254679",
    "end": "1260880"
  },
  {
    "text": "and I'll show this in operation later in a demo but basically um you can imagine putting something like your instance",
    "start": "1260880",
    "end": "1266760"
  },
  {
    "text": "user your AWS account your app name we tend to do like instance ID and a couple",
    "start": "1266760",
    "end": "1271840"
  },
  {
    "text": "other fields as well um to just scope this but it's an arbitrary string it can be pretty much whatever you want it to",
    "start": "1271840",
    "end": "1277880"
  },
  {
    "text": "be and once you have that then you just go into your sshd on the system that you want to log into and you can specify the",
    "start": "1277880",
    "end": "1286200"
  },
  {
    "text": "certificate Authority that you're going to trust so that's going to be like the bless certificate Authority and then you",
    "start": "1286200",
    "end": "1291679"
  },
  {
    "text": "also specify um the authorized principles and that principles is a file",
    "start": "1291679",
    "end": "1296799"
  },
  {
    "text": "notice the percent U there that's the user that you're going to map it to so",
    "start": "1296799",
    "end": "1301880"
  },
  {
    "text": "in this case um if I create a file like this and I call it bless demo that means there's a user on your Linux box called",
    "start": "1301880",
    "end": "1308159"
  },
  {
    "text": "bless demo and that user is accessible by people that satisfy the principal",
    "start": "1308159",
    "end": "1313880"
  },
  {
    "text": "line here so if your principal line says bless demo instances blah blah blah blah blah then you can get into the bless demo",
    "start": "1313880",
    "end": "1322480"
  },
  {
    "text": "user all right so let's talk about how we actually use this a bit in",
    "start": "1322880",
    "end": "1328600"
  },
  {
    "start": "1324000",
    "end": "1484000"
  },
  {
    "text": "operation um first of all this is the picture that I showed earlier um for those of you that have",
    "start": "1328600",
    "end": "1335159"
  },
  {
    "text": "actually built systems does this look about right or maybe a little bit simple to you who thinks it looks a little",
    "start": "1335159",
    "end": "1341919"
  },
  {
    "text": "simplistic no one thinks it looks simplistic all right you guys are giving me way too much credit this is what it actually looks like",
    "start": "1341919",
    "end": "1349960"
  },
  {
    "text": "um I had to of course abstract things out a little bit so let's walk through um the various flows here this is sort",
    "start": "1350000",
    "end": "1355880"
  },
  {
    "text": "of like the next layer down right so we've got a variety of things we've got",
    "start": "1355880",
    "end": "1361279"
  },
  {
    "text": "a user on the left here that can SSH into the Bastion and on the Bastion we sort of break it out into two different",
    "start": "1361279",
    "end": "1367600"
  },
  {
    "text": "setups so we've got uh the user space which is the tooling that a a user will",
    "start": "1367600",
    "end": "1373200"
  },
  {
    "text": "use um to access uh a kernel space demon",
    "start": "1373200",
    "end": "1379200"
  },
  {
    "text": "and this user space tool we call Pilgrim and the demon on the colonel side we call",
    "start": "1379200",
    "end": "1385159"
  },
  {
    "text": "Shaman I didn't name them for what it's worth um so basically what happens is",
    "start": "1385159",
    "end": "1390720"
  },
  {
    "text": "that uh Pilgrim will call to Shaman Shaman will call to bless and um and then bless will do the operation that we",
    "start": "1390720",
    "end": "1396720"
  },
  {
    "text": "talked about earlier so it calls KMS and uh gets your certificate signed and then",
    "start": "1396720",
    "end": "1401919"
  },
  {
    "text": "CER certificate comes back and you can log into your instances now what's super cool about all this as well is you see",
    "start": "1401919",
    "end": "1408159"
  },
  {
    "text": "there's all these things on the right side that show logging happening and so all that information can come back in",
    "start": "1408159",
    "end": "1415720"
  },
  {
    "text": "and you can start to do interesting analytics on your logs um for example one of the things that we like to do is",
    "start": "1415720",
    "end": "1423279"
  },
  {
    "text": "make sure that no one's using DSA Keys um DSA is considered sort of not a good",
    "start": "1423279",
    "end": "1428960"
  },
  {
    "text": "practice in uh SSH anymore everyone should be on RSA and so this allows us",
    "start": "1428960",
    "end": "1434200"
  },
  {
    "text": "um to take all this information all the SSH logs back analyze and say who's using DSA Keys um we can say who's",
    "start": "1434200",
    "end": "1440760"
  },
  {
    "text": "actually logging into my my service now I've got a strong authentication trail with the users um we can look for anomalies in those logins right so H",
    "start": "1440760",
    "end": "1448240"
  },
  {
    "text": "this user Joe they're always logging in over here and that's their cluster but then today they logged in over here and",
    "start": "1448240",
    "end": "1454279"
  },
  {
    "text": "that's different right and so maybe we don't need to stop them from going there",
    "start": "1454279",
    "end": "1459559"
  },
  {
    "text": "maybe they had a perfectly legitimate reason they were helping out a colleague or something like that um but it's",
    "start": "1459559",
    "end": "1464880"
  },
  {
    "text": "enough that we can send a notice to Joe and say hey uh Joe was that actually you or or not and then",
    "start": "1464880",
    "end": "1471919"
  },
  {
    "text": "they can just answer and we can move on with life but if that if they answer in the negative oh that actually wasn't me",
    "start": "1471919",
    "end": "1477080"
  },
  {
    "text": "I don't know where you got that well then we can figure out what happened there right we can look into it so there's all sorts of fun things you can",
    "start": "1477080",
    "end": "1484200"
  },
  {
    "start": "1484000",
    "end": "1543000"
  },
  {
    "text": "do all right so some of the other benefits that we see out of this um I",
    "start": "1484360",
    "end": "1489919"
  },
  {
    "text": "talked a little bit earlier about this idea of the challenges with everyone having their own personal keys to get",
    "start": "1489919",
    "end": "1495559"
  },
  {
    "text": "into the bastions one of the um issues there is that it's really hard to convince people",
    "start": "1495559",
    "end": "1501760"
  },
  {
    "text": "to update and rotate their keys right and so this is gets to be sort of the the human problem of something is",
    "start": "1501760",
    "end": "1507919"
  },
  {
    "text": "compromised and now I have to walk to a single person and say I need you to rotate your key um and it's hard to",
    "start": "1507919",
    "end": "1514760"
  },
  {
    "text": "generally protect them it's hard to convince people to use good passwords on all their private key files there just so many challenges around that that it'd",
    "start": "1514760",
    "end": "1520640"
  },
  {
    "text": "be nice to just push that aside and not even have that be a situation we also talked about the shared key challenges",
    "start": "1520640",
    "end": "1527399"
  },
  {
    "text": "um where it's hard to protect them on the Bastion um the other thing that's",
    "start": "1527399",
    "end": "1532919"
  },
  {
    "text": "actually really nice about this uh solution is the expiration um so all the the keys become very limited in scope",
    "start": "1532919",
    "end": "1540200"
  },
  {
    "text": "and so you don't have uh a lot of worries there um we also get some interesting benefits with key rotation",
    "start": "1540200",
    "end": "1546399"
  },
  {
    "start": "1543000",
    "end": "1589000"
  },
  {
    "text": "so typically when we deploy it we don't have just a single certificate Authority a single private key on the certificate",
    "start": "1546399",
    "end": "1552840"
  },
  {
    "text": "Authority side we'll have multiple certificate authorities and we bake all of those public Keys into to all of our",
    "start": "1552840",
    "end": "1558919"
  },
  {
    "text": "instances and one of those is offline at all times so it's n aafe tucked away on",
    "start": "1558919",
    "end": "1566360"
  },
  {
    "text": "like a USB key and no one touches it that is very much the in case of emergency go pull that out and you can",
    "start": "1566360",
    "end": "1573080"
  },
  {
    "text": "use it um because if something is compromised we can start deprecating the old one while we start mining with the new one for example um so it allows you",
    "start": "1573080",
    "end": "1580120"
  },
  {
    "text": "to do things like this that are actually really powerful um in ways that are transparent to the user",
    "start": "1580120",
    "end": "1586600"
  },
  {
    "text": "base we talked a little bit about the logging this is some example of the logs that",
    "start": "1586600",
    "end": "1592960"
  },
  {
    "start": "1589000",
    "end": "1614000"
  },
  {
    "text": "you're going to get out of the system when you use something like bless um but it's arbitrary it's whatever you put in that key ID field um so here we have an",
    "start": "1592960",
    "end": "1600039"
  },
  {
    "text": "example where we see the username we see the IP address that they're coming in from um we see the commands that they're",
    "start": "1600039",
    "end": "1605840"
  },
  {
    "text": "running um which SSH Keys they're using what the validity period is um all very",
    "start": "1605840",
    "end": "1611320"
  },
  {
    "text": "useful information for your for your audit trails and of course there's some availability wins you know I talked",
    "start": "1611320",
    "end": "1617200"
  },
  {
    "start": "1614000",
    "end": "1633000"
  },
  {
    "text": "earlier about are uh not liking ldap for this for this scenario and the reasons",
    "start": "1617200",
    "end": "1622640"
  },
  {
    "text": "why um and in general we also had this uh break glass mentality where we do",
    "start": "1622640",
    "end": "1628039"
  },
  {
    "text": "have that offline key where we can get access to the system if we need it all right so as with all of the",
    "start": "1628039",
    "end": "1635919"
  },
  {
    "start": "1633000",
    "end": "1717000"
  },
  {
    "text": "security talks today there's open source pieces here and um whenever I start to look at an open source projects uh I",
    "start": "1635919",
    "end": "1643200"
  },
  {
    "text": "tend to go to the projects page and I start to look at a couple things just to understand is this a healthy project is",
    "start": "1643200",
    "end": "1649120"
  },
  {
    "text": "this something that I'd actually want to use here's what I tend to look at so I thought I'd share it with you uh first",
    "start": "1649120",
    "end": "1655039"
  },
  {
    "text": "off um you know quite a few people have started so uh it's got a little bit of a",
    "start": "1655039",
    "end": "1660600"
  },
  {
    "text": "following there which is which is really great that suggests that maybe there's a good Community around it um then I look",
    "start": "1660600",
    "end": "1666799"
  },
  {
    "text": "at things like okay how many contributors are there are you actually doing like release management you know",
    "start": "1666799",
    "end": "1673399"
  },
  {
    "text": "what's your development practice looking like what's the license on it it's Apache license so it's pretty easy for people to consume um and then I start to",
    "start": "1673399",
    "end": "1681000"
  },
  {
    "text": "say well okay that's all fine D are they actually doing continuous integration do they have good test coverage is all this",
    "start": "1681000",
    "end": "1686320"
  },
  {
    "text": "available for me to see okay so that that looks good and then I say of course is there documentation and there is so great so",
    "start": "1686320",
    "end": "1693720"
  },
  {
    "text": "this is relatively easy for you all to pick up and use if you're interested um I certainly encourage you to check it out and uh we have uh people back on my",
    "start": "1693720",
    "end": "1702000"
  },
  {
    "text": "team that um support this regularly um since we use it in-house and the the version that we use in-house is the",
    "start": "1702000",
    "end": "1707880"
  },
  {
    "text": "version that you see in GitHub we don't have some sort of magical other version um and so we're right there with you um",
    "start": "1707880",
    "end": "1713799"
  },
  {
    "text": "answering questions and trying to make this thing better all right so let's talk about how",
    "start": "1713799",
    "end": "1719440"
  },
  {
    "start": "1717000",
    "end": "1823000"
  },
  {
    "text": "this works in demo mode um first of all I'm one of these people the demo guys just never look kindly on me and um and",
    "start": "1719440",
    "end": "1727240"
  },
  {
    "text": "I'm demoing something that is buried deep within the Netflix ecosystem which would mean I'd have to go across a network and a vpm and like so I decided",
    "start": "1727240",
    "end": "1734039"
  },
  {
    "text": "you know what this isn't going to be a good idea so I've got some videos for you to demonstrate how this works and that way hopefully things go but you you",
    "start": "1734039",
    "end": "1741080"
  },
  {
    "text": "know videos can fail too so we'll see how it goes um all right so back to our picture here this is the whole ecosystem",
    "start": "1741080",
    "end": "1748360"
  },
  {
    "text": "for the first demo I want to cover just a couple pieces so this is the user experience around it this is how a",
    "start": "1748360",
    "end": "1753880"
  },
  {
    "text": "developer experiences bless um going to their instances or as you'll see in a moment they basically don't have to",
    "start": "1753880",
    "end": "1759799"
  },
  {
    "text": "experience too much of it at all all right so we start oh this is going to be really",
    "start": "1759799",
    "end": "1766480"
  },
  {
    "text": "small all right we start with uh Spiner and we pull that up we go over to",
    "start": "1766480",
    "end": "1772960"
  },
  {
    "text": "one of the instances that we see there and we say ah I want to SSH into that instance so we click on it and then you",
    "start": "1772960",
    "end": "1779120"
  },
  {
    "text": "go on over on the right side and you can click to copy an SSH command drop that into your",
    "start": "1779120",
    "end": "1785320"
  },
  {
    "text": "terminal type in your private Key password this is going to be the password for your key to get onto the",
    "start": "1785320",
    "end": "1790440"
  },
  {
    "text": "Bastion itself or however you authenticate to the Bastion and boom you are on the instance so what just happened here we did one command and we",
    "start": "1790440",
    "end": "1797640"
  },
  {
    "text": "went from developer laptop through the Bastion onto the instance little bit of",
    "start": "1797640",
    "end": "1803159"
  },
  {
    "text": "uh command line magic but as you can see there basically all we're doing is we're saying that we're sshing and we're running a command on the Bastion to do",
    "start": "1803159",
    "end": "1809720"
  },
  {
    "text": "that next SSH step as well and that's what our oq SSH is that's a tool that will activate the Lambda keys and get",
    "start": "1809720",
    "end": "1816080"
  },
  {
    "text": "you going um so super easy for developers to get onto the instances it's always step one for",
    "start": "1816080",
    "end": "1822720"
  },
  {
    "text": "me all right so next let's look at how Bastion uses bless um so for this we're",
    "start": "1822720",
    "end": "1830480"
  },
  {
    "start": "1823000",
    "end": "2227000"
  },
  {
    "text": "going to look at um the pieces on the Bastion itself primarily and then how it",
    "start": "1830480",
    "end": "1835679"
  },
  {
    "text": "interfaces back with the Lambda function all",
    "start": "1835679",
    "end": "1842000"
  },
  {
    "text": "right so the left side of the screen is Pilgrim that's the user space on the Bastion the right side of the screen is",
    "start": "1842000",
    "end": "1850039"
  },
  {
    "text": "uh Shaman so that's going to be the demon on the Bastion and what we did is we spun up shaman on the right so that",
    "start": "1850039",
    "end": "1855960"
  },
  {
    "text": "we had the demon running and and now um we're going to issue a pilgrim command and we can provide a variety of things",
    "start": "1855960",
    "end": "1861880"
  },
  {
    "text": "here the the user uh role is going to be what goes into um that principle and then we can",
    "start": "1861880",
    "end": "1868200"
  },
  {
    "text": "provide things like the ASG the instance ID and other information about where we're trying to get to when we run that",
    "start": "1868200",
    "end": "1873960"
  },
  {
    "text": "it actually Returns the file location for the private key that it generated um",
    "start": "1873960",
    "end": "1880120"
  },
  {
    "text": "and inside there you're going to have your certificate and your private key and the information that you need to actually SSH into the system um the",
    "start": "1880120",
    "end": "1887240"
  },
  {
    "text": "certificate has all the kinds of information that we talked about before um so we're showing here various uh",
    "start": "1887240",
    "end": "1892639"
  },
  {
    "text": "request ID information um what the role is that you're coming in as and the validity dates all sorts of fun",
    "start": "1892639",
    "end": "1901200"
  },
  {
    "text": "stuff I know this is a little bit small um but if you go check out the slides online as well even though I don't have",
    "start": "1902320",
    "end": "1908679"
  },
  {
    "text": "the full videos in there I have the final version of each video slid so you can actually see the results of all the commands of that helpo for folks",
    "start": "1908679",
    "end": "1915440"
  },
  {
    "text": "later um so yeah so we've you've got the command that you want to run when you get on to the um to the instance",
    "start": "1915440",
    "end": "1923080"
  },
  {
    "text": "there you got the function that's being run so we've named our Lambda function bless and so we know that's what got",
    "start": "1923080",
    "end": "1929559"
  },
  {
    "text": "called to generate this you can imagine having multiple lambdas that you might call and you might want to log which one they hit there's our actual validity",
    "start": "1929559",
    "end": "1936960"
  },
  {
    "text": "period we put the validity period in the key ID just to log that information but the one that actually gets enforced is",
    "start": "1936960",
    "end": "1943200"
  },
  {
    "text": "the one in the valid field there we have a principle that will scope it as we just discussed before um with all sorts",
    "start": "1943200",
    "end": "1949000"
  },
  {
    "text": "of information including the instance ID and um and the account ID We Believe",
    "start": "1949000",
    "end": "1955360"
  },
  {
    "text": "instance IDs are unique within an account we're not confident that instance IDs are globally unique so we",
    "start": "1955360",
    "end": "1961360"
  },
  {
    "text": "included both of those fields to make sure that we had a unique identifier",
    "start": "1961360",
    "end": "1966240"
  },
  {
    "text": "there also if you go back and look on the other side um once Pilgrim runs Shaman will log information about what",
    "start": "1966480",
    "end": "1972880"
  },
  {
    "text": "it did so it's actually going to log um that fact the pilgrim ran who ran",
    "start": "1972880",
    "end": "1978639"
  },
  {
    "text": "it and it actually pulls information out about the user um on the system that ran",
    "start": "1978639",
    "end": "1983799"
  },
  {
    "text": "that command so it would have your username and it injects that in it pulls its Network IP address and it injects",
    "start": "1983799",
    "end": "1989399"
  },
  {
    "text": "that in as well and it puts all that information together and makes a request to the Lambda function in this case",
    "start": "1989399",
    "end": "1995240"
  },
  {
    "text": "we're actually logging the the request body so the whole Json payload is here too you could kind of choose what sort",
    "start": "1995240",
    "end": "2001320"
  },
  {
    "text": "of verocity you might want for your logging um it's the classic trade-off of having a great audit Trail versus using",
    "start": "2001320",
    "end": "2007039"
  },
  {
    "text": "up a lot of space um and maybe it depends on on how often people are sshing into your your systems as",
    "start": "2007039",
    "end": "2013399"
  },
  {
    "text": "well all right then we've got um how do we",
    "start": "2013399",
    "end": "2021440"
  },
  {
    "text": "actually set up this on the instant side okay so the Bastion set up we saw how it",
    "start": "2021440",
    "end": "2027000"
  },
  {
    "text": "gets used the instance setup is actually relatively straightforward we going to look at the instance itself and some of the log",
    "start": "2027000",
    "end": "2033840"
  },
  {
    "text": "pieces around that um now before I start this one um",
    "start": "2033840",
    "end": "2040919"
  },
  {
    "text": "the way that this demo is going to run is going to be a little it kind of is confusing at first I'm going to set it up for you we're actually sshing into",
    "start": "2040919",
    "end": "2049200"
  },
  {
    "text": "the system that we're on so what we're going to do is we're going to set up something that runs across Local Host this allowed us to basically set up",
    "start": "2049200",
    "end": "2055919"
  },
  {
    "text": "something on a um on a isolated system because I didn't want sorry guys but I didn't want to reveal all of our",
    "start": "2055919",
    "end": "2062040"
  },
  {
    "text": "internal instance IDs and all sorts of stuff as we as we log through so um that was a nice way to to handle that for you",
    "start": "2062040",
    "end": "2068960"
  },
  {
    "text": "so given that let's see if we can go there we go all right so what we've got",
    "start": "2068960",
    "end": "2074520"
  },
  {
    "text": "here is the SSH configuration um this is the the server side configuration at the",
    "start": "2074520",
    "end": "2079720"
  },
  {
    "text": "very bottom we're going to drop in an entry to say I'm going to trust this certificate Authority and here's my",
    "start": "2079720",
    "end": "2087280"
  },
  {
    "text": "principal's file just like I showed earlier with that percent U to specify",
    "start": "2087280",
    "end": "2092358"
  },
  {
    "text": "we're going to pass the user as the file name we save that out and then we go",
    "start": "2092359",
    "end": "2097880"
  },
  {
    "text": "actually create the files for those um certificate Authority Keys just drop in the key that we want",
    "start": "2097880",
    "end": "2104760"
  },
  {
    "text": "in there now typically this is where I said you might have multiple Casa that you trust at a given time just for",
    "start": "2104760",
    "end": "2110040"
  },
  {
    "text": "operational reasons then we're going to step into the principles",
    "start": "2110040",
    "end": "2117520"
  },
  {
    "text": "file notice again the username there so if someone comes in with the",
    "start": "2121160",
    "end": "2126920"
  },
  {
    "text": "principle that we're going to specify they would get the bless demo user on this particular",
    "start": "2126920",
    "end": "2133640"
  },
  {
    "text": "host and again we have the instance ID the account ID the ASG name all baked",
    "start": "2136880",
    "end": "2143800"
  },
  {
    "text": "into there all right now we just need to restart the SSH",
    "start": "2143800",
    "end": "2149839"
  },
  {
    "text": "demon and we should be good to go so at this",
    "start": "2150599",
    "end": "2155760"
  },
  {
    "text": "point we're going to start up um Shaman and we",
    "start": "2155800",
    "end": "2162319"
  },
  {
    "text": "have an SSH command now notice I'm passing to minus I which is saying this is the private key to use um a back",
    "start": "2162319",
    "end": "2168800"
  },
  {
    "text": "ticked command that calls Pilgrim so remember Pilgrim actually Returns the file name of the private key this is",
    "start": "2168800",
    "end": "2174280"
  },
  {
    "text": "where that becomes particularly handy so we just embed it in a single command and everything will happen transparently for",
    "start": "2174280",
    "end": "2180520"
  },
  {
    "text": "us um again to the bugrim command we can specify all these arguments about the role that we want to acquire and sure",
    "start": "2180520",
    "end": "2188160"
  },
  {
    "text": "enough when we run it bam it logged Us in as the bless demo user now what we",
    "start": "2188160",
    "end": "2193240"
  },
  {
    "text": "can see here as well is we can uh look at the log output um that you would get",
    "start": "2193240",
    "end": "2199520"
  },
  {
    "text": "on that SSH demon for that user who just logged in so let's take a quick look at",
    "start": "2199520",
    "end": "2205400"
  },
  {
    "text": "that here we go and we're going to see um a log line accepted public key for",
    "start": "2205400",
    "end": "2211240"
  },
  {
    "text": "bless demo from the IP address of the Bastion in this case it's Local Host and",
    "start": "2211240",
    "end": "2216920"
  },
  {
    "text": "it has all the information that we put in that KY ID field so you get really nice logging information",
    "start": "2216920",
    "end": "2223280"
  },
  {
    "text": "there all",
    "start": "2223280",
    "end": "2226480"
  },
  {
    "start": "2227000",
    "end": "2307000"
  },
  {
    "text": "right last thing I wanted to mention is that there's a lot of other people that are working in a similar space um as",
    "start": "2228680",
    "end": "2235599"
  },
  {
    "text": "we've worked on this project at some level they've come out of the woodwork and it's been really fascinating to see what other companies are doing um Lyft",
    "start": "2235599",
    "end": "2242280"
  },
  {
    "text": "actually is using Bless but they're using it in a slightly different way they wrote um what they call bless",
    "start": "2242280",
    "end": "2248720"
  },
  {
    "text": "client and it runs on developer laptops and they have separate tooling that allows a developer laptop to get AWS",
    "start": "2248720",
    "end": "2255599"
  },
  {
    "text": "keys and then bless client goes directly from their laptop to the Lambda function and does the kind of operations that I",
    "start": "2255599",
    "end": "2261520"
  },
  {
    "text": "showed you um straight off of their system so that's a pretty cool system um and they have um a blog post there that",
    "start": "2261520",
    "end": "2268079"
  },
  {
    "text": "talks all about their system and I believe they've open sourced blessed client as well and they work nicely together um Facebook and these URLs are",
    "start": "2268079",
    "end": "2275880"
  },
  {
    "text": "intentionally small I was thinking you might go grab the slides and look at them later if you're interested um",
    "start": "2275880",
    "end": "2281000"
  },
  {
    "text": "because it's a lot to copy right now uh Facebook uses the same idea with these um certificates and principles to scope",
    "start": "2281000",
    "end": "2287400"
  },
  {
    "text": "themselves um turns out to be extremely powerful when you're working at a large scale and uh Wikipedia actually takes a",
    "start": "2287400",
    "end": "2292880"
  },
  {
    "text": "slightly different approach um they have a special way to use SSH agents to better protect those private keys on the",
    "start": "2292880",
    "end": "2299760"
  },
  {
    "text": "bastions so that might be interested in looking at if you're not ready to go full in with the Lambda function and",
    "start": "2299760",
    "end": "2304800"
  },
  {
    "text": "bless and that kind of a thing and that's all that I have for today and I'm happy to take",
    "start": "2304800",
    "end": "2312190"
  },
  {
    "start": "2307000",
    "end": "2612000"
  },
  {
    "text": "[Applause]",
    "start": "2312190",
    "end": "2318760"
  },
  {
    "text": "questions did you uh any thoughts on actually protecting not just the the keys and such but what about the console",
    "start": "2320839",
    "end": "2327400"
  },
  {
    "text": "and access to the console was that something you guys thought about too or sorry which console the the AWS console",
    "start": "2327400",
    "end": "2332800"
  },
  {
    "text": "and accounts there oh okay yes yes yes so um I showed pictures of Spiner and",
    "start": "2332800",
    "end": "2339920"
  },
  {
    "text": "pretty much all of the engineers at Netflix there's actually a few in the room here maybe they can chime in and nod their heads um we don't really use",
    "start": "2339920",
    "end": "2345880"
  },
  {
    "text": "the AWS console so everyone goes through Spiner um and so we can limit the scope on this on who accesses the console",
    "start": "2345880",
    "end": "2351760"
  },
  {
    "text": "quite a bit Yeah other questions for",
    "start": "2351760",
    "end": "2356960"
  },
  {
    "text": "Brian one there's one back here where's the question I'm sorry I missed it there",
    "start": "2356960",
    "end": "2362800"
  },
  {
    "text": "we go go ahead",
    "start": "2362800",
    "end": "2368440"
  },
  {
    "text": "there seem to be a few other pieces of the ecosystem around bless um are those",
    "start": "2368800",
    "end": "2374599"
  },
  {
    "text": "going to be open sourced or yeah like Pilgrim and Shaman and stuff um so we've",
    "start": "2374599",
    "end": "2380280"
  },
  {
    "text": "been thinking about it the challenge is that those are like really really baked into our specific deployment and um and",
    "start": "2380280",
    "end": "2388680"
  },
  {
    "text": "they're relatively small so um so we're trying to figure out if we can find a good way to sort of abstract them out so",
    "start": "2388680",
    "end": "2394079"
  },
  {
    "text": "that they would be meaningful in a in a more General context then I'm not against open sourcing them it's just",
    "start": "2394079",
    "end": "2399520"
  },
  {
    "text": "that we we hadn't quite gotten around to that yet I think bless is the the interesting nugget um and it's actually",
    "start": "2399520",
    "end": "2405200"
  },
  {
    "text": "not huge uh it's it's python it's probably uh about a thousand lines of",
    "start": "2405200",
    "end": "2410480"
  },
  {
    "text": "code as the Lambda function so it's not it's not too big but it's it's kind of it's a nice piece and it's very reusable so that's that was a good one to open",
    "start": "2410480",
    "end": "2418599"
  },
  {
    "text": "source um my question is relative to the developer uh part of the presentation uh",
    "start": "2423760",
    "end": "2430920"
  },
  {
    "text": "it seems that uh the developer is able to access to the server right away but how can you",
    "start": "2430920",
    "end": "2439079"
  },
  {
    "text": "uh verify that for example I still have connection to that uh authentication to",
    "start": "2439079",
    "end": "2445680"
  },
  {
    "text": "that like let's say that the rotation happens and I'm not aware of it right so somehow I lost connection is there a way",
    "start": "2445680",
    "end": "2452680"
  },
  {
    "text": "to verify that and also um when they s keys are regenerated I also have uh",
    "start": "2452680",
    "end": "2459040"
  },
  {
    "text": "other SSH keys for other applications that I need to have connections with so how is that organized on my computer to",
    "start": "2459040",
    "end": "2466680"
  },
  {
    "text": "know like where where's the SSH key stored and things like that sure so I'll",
    "start": "2466680",
    "end": "2472480"
  },
  {
    "text": "try to hit the a couple questions here I'll try to hit them in turn and if I don't quite get it come up and grab me afterwards um but um in terms of how do",
    "start": "2472480",
    "end": "2481200"
  },
  {
    "text": "you handle connections as Keys change and get rotated um our assumption is that if connection is established um",
    "start": "2481200",
    "end": "2488680"
  },
  {
    "text": "that that connection would basically live on forever um so we don't we don't go through and kill out a whole bunch of",
    "start": "2488680",
    "end": "2495079"
  },
  {
    "text": "old connections um if that's if that sits around for a while then that's so",
    "start": "2495079",
    "end": "2500359"
  },
  {
    "text": "be it um but and then we would rotate the keys and that would be then a requirement that the next connection",
    "start": "2500359",
    "end": "2506400"
  },
  {
    "text": "that gets started is on the new key system right does that make sense and then um as far as the keys on the laptop",
    "start": "2506400",
    "end": "2513319"
  },
  {
    "text": "themselves um I didn't really get into it in the presentation here um but I kind of mentioned it was Turtles all the",
    "start": "2513319",
    "end": "2518800"
  },
  {
    "text": "way down right so I talked about how do you get from the Bastion to an instance um there's an interesting question of how do I get from my developer laptop to",
    "start": "2518800",
    "end": "2525839"
  },
  {
    "text": "the Bastion in a world where all the same problems are going to present themselves um and what we're looking at",
    "start": "2525839",
    "end": "2532000"
  },
  {
    "text": "doing there is we actually have a in-house system that can um basically",
    "start": "2532000",
    "end": "2537560"
  },
  {
    "text": "convert a single sign on authentication so like a like a Gmail kind of authentication um to a certificate that",
    "start": "2537560",
    "end": "2544880"
  },
  {
    "text": "sits on your laptop so SS certificate or it could actually be like a mutual TLS client side certificate um and so that",
    "start": "2544880",
    "end": "2552079"
  },
  {
    "text": "system would just populate your your computer with certificates after you've authenticated and those certificates would be good for say a day or a month",
    "start": "2552079",
    "end": "2559119"
  },
  {
    "text": "or something like that depending on your policy we have time for a couple more questions anybody",
    "start": "2559119",
    "end": "2565760"
  },
  {
    "text": "else oh there's one right here do you use certificate",
    "start": "2565760",
    "end": "2571240"
  },
  {
    "text": "revocation to have more granular control about the access time uh so no the the",
    "start": "2571240",
    "end": "2578680"
  },
  {
    "text": "idea with certificate revocation is typically associated with long live certificates um where you put it out",
    "start": "2578680",
    "end": "2584760"
  },
  {
    "text": "there and it's good for a year or two and then something goes wonky in that time period and you need to cut it off",
    "start": "2584760",
    "end": "2591680"
  },
  {
    "text": "um since we're issuing certificates that are good for like five minutes um the value of a revocation system goes down",
    "start": "2591680",
    "end": "2598319"
  },
  {
    "text": "and it turns out that I I feel it's basically just too much complexity to be worth it at this",
    "start": "2598319",
    "end": "2603920"
  },
  {
    "text": "point anyone else one more perfect that's Bri again thanks everyone",
    "start": "2604160",
    "end": "2609520"
  },
  {
    "text": "thank you",
    "start": "2609520",
    "end": "2614920"
  }
]