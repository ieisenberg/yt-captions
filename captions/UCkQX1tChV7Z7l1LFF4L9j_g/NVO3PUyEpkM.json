[
  {
    "start": "0",
    "end": "46000"
  },
  {
    "text": "[Music]",
    "start": "3320",
    "end": "14289"
  },
  {
    "text": "we're here today to talk about authorization at netflix scale my name is travis nelson i work as a",
    "start": "14960",
    "end": "21359"
  },
  {
    "text": "senior software engineer at netflix and i work for a team called aim which",
    "start": "21359",
    "end": "26640"
  },
  {
    "text": "deals with the identity authorization and authentication",
    "start": "26640",
    "end": "31679"
  },
  {
    "text": "of our users we do that for the website and for streaming applications",
    "start": "31679",
    "end": "37280"
  },
  {
    "text": "and also for mobile games but it's the consumer side of the house and not the",
    "start": "37280",
    "end": "43520"
  },
  {
    "text": "not the corporate identity side of the house so here's some questions for you to",
    "start": "43520",
    "end": "49360"
  },
  {
    "start": "46000",
    "end": "113000"
  },
  {
    "text": "think about while we're going through this presentation the first is how do you authenticate and",
    "start": "49360",
    "end": "55120"
  },
  {
    "text": "authorize 3 million requests per second it's a lot",
    "start": "55120",
    "end": "60160"
  },
  {
    "text": "so we have to deal with that all the time how do you bring design into evolution our system as many systems do kind of",
    "start": "60160",
    "end": "67920"
  },
  {
    "text": "evolve over time right and when you have things that evolve it can be hard to bring a a good design into it that",
    "start": "67920",
    "end": "74880"
  },
  {
    "text": "wasn't thought of from the beginning so our particular problem is how do we how do we bring in um kind of a more",
    "start": "74880",
    "end": "81200"
  },
  {
    "text": "centralized way of thinking about authorization into our evolved product",
    "start": "81200",
    "end": "87200"
  },
  {
    "text": "how do we bring in complex signals things like like fraud and device signals that might be potentially",
    "start": "87200",
    "end": "92640"
  },
  {
    "text": "ambiguous how do we think about that and finally how do we build flexibility the last thing we want to do is lock our",
    "start": "92640",
    "end": "99680"
  },
  {
    "text": "system down to the point where it's hard to make changes we actually want to make changes easier to implement",
    "start": "99680",
    "end": "105520"
  },
  {
    "text": "make the authorization system an enablement mechanism for product changes",
    "start": "105520",
    "end": "113320"
  },
  {
    "start": "113000",
    "end": "146000"
  },
  {
    "text": "so here's what we're going to talk about today um first of all where we were um kind of the state of our system",
    "start": "114159",
    "end": "120320"
  },
  {
    "text": "before we started this effort um what are our authorization needs in the consumer space right we had to think",
    "start": "120320",
    "end": "125600"
  },
  {
    "text": "about what are the requirements what do we actually need to do talk about centralizing authorization",
    "start": "125600",
    "end": "131440"
  },
  {
    "text": "what that means and kind of how to go about it at least how we went about it",
    "start": "131440",
    "end": "136640"
  },
  {
    "text": "then how we think about things like scaling and fault tolerance because we have such a large amount of traffic",
    "start": "136640",
    "end": "142239"
  },
  {
    "text": "coming in all the time so here's where we were circuit 2018 we",
    "start": "142239",
    "end": "149760"
  },
  {
    "start": "146000",
    "end": "212000"
  },
  {
    "text": "had this authorization kind of built in the system as the system evolved right so client would basically pass an access",
    "start": "149760",
    "end": "156720"
  },
  {
    "text": "token into our edge router um edge router would transform that into what we call a passport which is our",
    "start": "156720",
    "end": "163040"
  },
  {
    "text": "internal token agnostic identity would contain you know all the relevant",
    "start": "163040",
    "end": "168239"
  },
  {
    "text": "user and device information that would go to any number of microservices these",
    "start": "168239",
    "end": "174319"
  },
  {
    "text": "microservices each would potentially have their own authorization rules based on that identity",
    "start": "174319",
    "end": "179519"
  },
  {
    "text": "it might also call out to our identity provider to ask the current status of that of that user",
    "start": "179519",
    "end": "185360"
  },
  {
    "text": "and um that might mean that several different of the microservices are also calling into that same identity provider",
    "start": "185360",
    "end": "192239"
  },
  {
    "text": "um and the the trouble with this of course is that the authorization rules they might be different for microservice",
    "start": "192239",
    "end": "198560"
  },
  {
    "text": "or they might be the same might end up with several different microservices all having the same authorization rule",
    "start": "198560",
    "end": "204560"
  },
  {
    "text": "and that might be replicated potentially hundreds of times in a very large system so that's kind of where we were",
    "start": "204560",
    "end": "212480"
  },
  {
    "start": "212000",
    "end": "433000"
  },
  {
    "text": "there's some pros and cons of doing that um first of all the pros right um it's pretty scalable if you do that and you",
    "start": "212480",
    "end": "219120"
  },
  {
    "text": "put authorization rules in every one of your micro services and these micro services are all independently scalable um",
    "start": "219120",
    "end": "226560"
  },
  {
    "text": "you have a pretty easy way to scale your system you kind of just scale up all the all the",
    "start": "226560",
    "end": "231680"
  },
  {
    "text": "services at once and um you don't never really run into roadblocks with the authorization",
    "start": "231680",
    "end": "236959"
  },
  {
    "text": "being you know a limit to scaling you also have good failure domain isolation what i mean by that is",
    "start": "236959",
    "end": "243599"
  },
  {
    "text": "if somebody in one of those microservices messes up one of those authorization rules and then pushes",
    "start": "243599",
    "end": "249040"
  },
  {
    "text": "their service live it it only affects that particular service and if the other services around",
    "start": "249040",
    "end": "255680"
  },
  {
    "text": "that are resilient to that to that failure um it might not be noticed or it might be caused some kind of a small",
    "start": "255680",
    "end": "261519"
  },
  {
    "text": "partial outage somewhere but nothing nothing catastrophic so that's that's actually a good thing",
    "start": "261519",
    "end": "267600"
  },
  {
    "text": "we don't want to have you know catastrophic failures that that impact the entire system all at once",
    "start": "267600",
    "end": "273440"
  },
  {
    "text": "but there are some cons too right um one is that the policies can be really too simple um",
    "start": "273440",
    "end": "278960"
  },
  {
    "text": "one of the the most common policies that we found was that if your membership is current then you get the stuff",
    "start": "278960",
    "end": "284560"
  },
  {
    "text": "and we have that check kind of everywhere throughout the code um and that that's you know it's a good",
    "start": "284560",
    "end": "290400"
  },
  {
    "text": "thing often to check that but that's not really what the question that people are asking the question really should be",
    "start": "290400",
    "end": "295600"
  },
  {
    "text": "more like can i access this particular thing um is this particular feature on",
    "start": "295600",
    "end": "301199"
  },
  {
    "text": "the on the site or in the mobile app accessible by this this member this user",
    "start": "301199",
    "end": "306240"
  },
  {
    "text": "of this device right so the questions are far more nuanced than they're actually expressed",
    "start": "306240",
    "end": "311759"
  },
  {
    "text": "in the code um and then when you add the complexity the complexity gets distributed if you want to change something like that if",
    "start": "311759",
    "end": "317919"
  },
  {
    "text": "you want to say that well if they're if they're current and they're not in this country or if they're current and they're not on this device then that",
    "start": "317919",
    "end": "325280"
  },
  {
    "text": "ends up getting distributed among all those different services that also contain that rule",
    "start": "325280",
    "end": "330479"
  },
  {
    "text": "of course if it's distributed then it's also difficult to change so you might have to do",
    "start": "330479",
    "end": "336080"
  },
  {
    "text": "tens of services might need to do the same change instead of um instead of potentially",
    "start": "336080",
    "end": "342160"
  },
  {
    "text": "a single point of change so that means that you're going to do a lot more change you're going to involve a lot",
    "start": "342160",
    "end": "348000"
  },
  {
    "text": "more teams and your timeline is going to increase because of that and exceptional access in that scenario",
    "start": "348000",
    "end": "354960"
  },
  {
    "text": "is also quite difficult right because if you have some special piece of content or some special feature that",
    "start": "354960",
    "end": "361039"
  },
  {
    "text": "you're trying to enable just for a certain you know set of users that can be hard to do because if your",
    "start": "361039",
    "end": "368080"
  },
  {
    "text": "access controls are all all that simplistic then it's not being",
    "start": "368080",
    "end": "373840"
  },
  {
    "text": "replicated everywhere else if you if you have something that violates that constraint and you still want to give them a certain level of access then you",
    "start": "373840",
    "end": "381199"
  },
  {
    "text": "you can't do that and if you want to enable a certain privilege and do that privilege check at various points in the",
    "start": "381199",
    "end": "386639"
  },
  {
    "text": "system you also have to distribute it so it becomes kind of untenable at a certain point if you your rules become",
    "start": "386639",
    "end": "392800"
  },
  {
    "text": "more complex you can't really do that kind of thing anymore and also fraud awareness ends up being",
    "start": "392800",
    "end": "398639"
  },
  {
    "text": "localized in that kind of model because when you have complex fraud detection and",
    "start": "398639",
    "end": "404170"
  },
  {
    "text": "[Music] systems right you want to make sure that you can put them at the various points",
    "start": "404170",
    "end": "409759"
  },
  {
    "text": "where the the checks for fraud are useful right and if you only do that at certain points you can easily miss other",
    "start": "409759",
    "end": "416000"
  },
  {
    "text": "points and so um by putting that more in a central location and knowing when your fraud",
    "start": "416000",
    "end": "422880"
  },
  {
    "text": "checks are being being executed then then you can have a much clearer picture and have much better coverage of",
    "start": "422880",
    "end": "429840"
  },
  {
    "text": "that of that signal so we also had some specific uh netflix",
    "start": "429840",
    "end": "436479"
  },
  {
    "start": "433000",
    "end": "592000"
  },
  {
    "text": "autistic concerns as well um we wanted to you know kind of take a step back and look at what do we actually need",
    "start": "436479",
    "end": "442639"
  },
  {
    "text": "for our consumer presence consumer facing experience right one is we needed a way",
    "start": "442639",
    "end": "449120"
  },
  {
    "text": "to to model the things that a user can and can't do right maybe the user some users and on some devices can",
    "start": "449120",
    "end": "455680"
  },
  {
    "text": "access some functions like a linking function to your tv and others",
    "start": "455680",
    "end": "461520"
  },
  {
    "text": "cannot due to various reasons maybe their their device is insufficient maybe their plan is insufficient",
    "start": "461520",
    "end": "468160"
  },
  {
    "text": "there's all kinds of different reasons um we also wanted to be able to get the same answer everywhere we wanted all the",
    "start": "468160",
    "end": "473199"
  },
  {
    "text": "microservices to have kind of a common point of reference to be able to get that same answer right so if if they if",
    "start": "473199",
    "end": "479759"
  },
  {
    "text": "everyone's looking at the same feature they should be able to get the same answer for that we also wanted to look at how we think",
    "start": "479759",
    "end": "486080"
  },
  {
    "text": "about the corporate versus the consumer identity versus the partner identity there's",
    "start": "486080",
    "end": "491440"
  },
  {
    "text": "different places that they intersect and we needed to make sure that we accounted for that we also have things like api access",
    "start": "491440",
    "end": "498400"
  },
  {
    "text": "we have special access for special users where we give them say some amount of privileged access that normal users",
    "start": "498400",
    "end": "505199"
  },
  {
    "text": "don't and we also needed to accommodate things like um like device and presence and fraud signals right we",
    "start": "505199",
    "end": "512000"
  },
  {
    "text": "wanted to be able to basically have a way to write policies around all of this around the user their status their plan",
    "start": "512000",
    "end": "519599"
  },
  {
    "text": "their device their presence uh you know fraud signals all of it",
    "start": "519599",
    "end": "524640"
  },
  {
    "text": "um so what are we authorizing right so we're access we're authorizing things like the product features",
    "start": "524640",
    "end": "530080"
  },
  {
    "text": "um the the different things that you can do by the website or via a mobile app or a tv app",
    "start": "530080",
    "end": "537920"
  },
  {
    "text": "things like that profile gate whether you have access to mobile games or not um also we want to be able to authorize the",
    "start": "537920",
    "end": "544560"
  },
  {
    "text": "videos that you have access to playback for download so those are also part of the part of the equation",
    "start": "544560",
    "end": "550800"
  },
  {
    "text": "and if you're if you're authorizing that then it also becomes a discovery issue because we want to have policies around",
    "start": "550800",
    "end": "558080"
  },
  {
    "text": "discovery because the what the user can see in terms of what they're going to be able to",
    "start": "558080",
    "end": "563200"
  },
  {
    "text": "interact with on their ui is directly related to what they're authorized to use for example if you",
    "start": "563200",
    "end": "570080"
  },
  {
    "text": "have a title that you you have early access to that will appear in your low email your list",
    "start": "570080",
    "end": "576640"
  },
  {
    "text": "of movies whereas if you don't have access to it it won't appear and so that's the kind of thing that we need to",
    "start": "576640",
    "end": "582399"
  },
  {
    "text": "be able to express in these these policies we want to have you know discovery and the",
    "start": "582399",
    "end": "588000"
  },
  {
    "text": "playback rules to be coherent",
    "start": "588000",
    "end": "592160"
  },
  {
    "start": "592000",
    "end": "689000"
  },
  {
    "text": "so there's some different approaches to authorization that we looked at and um there's some obviously some pros and",
    "start": "594080",
    "end": "600560"
  },
  {
    "text": "cons to each and some applicability here and there the first one is role based access control this is where you assign each",
    "start": "600560",
    "end": "606880"
  },
  {
    "text": "user a role and you give the role permissions and then the client basically asks you know do i does this",
    "start": "606880",
    "end": "612720"
  },
  {
    "text": "user have this permission or not which is a fine model it's it actually is really nice and we look at this",
    "start": "612720",
    "end": "618880"
  },
  {
    "text": "extensively but we really realized that we wanted to be able to accommodate a much broader variety of signals and",
    "start": "618880",
    "end": "625200"
  },
  {
    "text": "create different policies that were based on many more things other than just the user and and some uh role",
    "start": "625200",
    "end": "632320"
  },
  {
    "text": "assignment so we ended up with uh you know something beyond that um",
    "start": "632320",
    "end": "637519"
  },
  {
    "text": "next one to talk about here is attribute or policy based access control and this is where you look at all the different attributes",
    "start": "637519",
    "end": "643040"
  },
  {
    "text": "um and then you assign permissions to the sets of attributes through policies that's that's pretty close to what we're doing um and we do have policies that",
    "start": "643040",
    "end": "650320"
  },
  {
    "text": "kind of look at all of those different signals um there's a there's another kind of of access control which is kind of based",
    "start": "650320",
    "end": "656800"
  },
  {
    "text": "on that which is called risk adaptive access control or radac which is kind of where we're getting",
    "start": "656800",
    "end": "662480"
  },
  {
    "text": "we're kind of moving in that direction we include the fraud and risk signals into that as well so",
    "start": "662480",
    "end": "668320"
  },
  {
    "text": "it's not only attribute based but it's also based on on risk scoring and um and that sort of",
    "start": "668320",
    "end": "675440"
  },
  {
    "text": "thing we want to be able to make sure that we are able to create different decisions based",
    "start": "675440",
    "end": "680560"
  },
  {
    "text": "on you know various kinds of attributes of the of the user including things like",
    "start": "680560",
    "end": "685920"
  },
  {
    "text": "risk signals so you know our back is simple and we",
    "start": "685920",
    "end": "692240"
  },
  {
    "start": "689000",
    "end": "786000"
  },
  {
    "text": "could have started with that but the complexity we realized was a little bit you know beyond that our our system looks a little bit more like this one we",
    "start": "692240",
    "end": "699040"
  },
  {
    "text": "have clients coming into our aussie provider and then we have you know different different identity",
    "start": "699040",
    "end": "704880"
  },
  {
    "text": "providers that we need to work with we have our customer identity provider sometimes those are linked to a",
    "start": "704880",
    "end": "711040"
  },
  {
    "text": "corporate identity or the the user might have additional uh features enabled um",
    "start": "711040",
    "end": "717040"
  },
  {
    "text": "so um and then the customer might also have billing attached so we need to sometimes look at to see if they're",
    "start": "717040",
    "end": "722639"
  },
  {
    "text": "they're current on their their billing or not so we have all these um you know different different uh",
    "start": "722639",
    "end": "729360"
  },
  {
    "text": "dimensions of the user that we need to think about in terms of just the user right we also have a fraud detection",
    "start": "729360",
    "end": "736079"
  },
  {
    "text": "system that we call into to determine if the user has engaged in",
    "start": "736079",
    "end": "741519"
  },
  {
    "text": "suspicious behavior before and that provides kind of a score we can write you know policies based on that",
    "start": "741519",
    "end": "746800"
  },
  {
    "text": "and we have also customer presence we have ways of knowing which country a user is in right",
    "start": "746800",
    "end": "752480"
  },
  {
    "text": "now whether they're on a vpn potentially or not we have all of that coming in there's also device identity signals we",
    "start": "752480",
    "end": "758639"
  },
  {
    "text": "have um many of our devices are are fully authenticated cryptographically some are not",
    "start": "758639",
    "end": "764240"
  },
  {
    "text": "um we have different trusts for each of them we know at least what what the devices is",
    "start": "764240",
    "end": "770000"
  },
  {
    "text": "purporting to be and whether it's it's proved to be that we can use that also in our in our policies",
    "start": "770000",
    "end": "775920"
  },
  {
    "text": "so that's kind of the the lay of the land we have a lot of different signals coming in and then the question is really kind of",
    "start": "775920",
    "end": "781839"
  },
  {
    "text": "how do you make that coherent how do you scale it",
    "start": "781839",
    "end": "787519"
  },
  {
    "start": "786000",
    "end": "910000"
  },
  {
    "text": "so what we did was we decided to create you know a central authorization service and called it pax our product access",
    "start": "787519",
    "end": "793760"
  },
  {
    "text": "service and we actually have several different types of clients for it we have in the",
    "start": "793760",
    "end": "799600"
  },
  {
    "text": "uis we have you know different kinds of offline online tasks that fall into it",
    "start": "799600",
    "end": "805279"
  },
  {
    "text": "they're actually asking different questions so the uis are asking things like what are the features that are enabled",
    "start": "805279",
    "end": "810639"
  },
  {
    "text": "for this for this user in terms of you know overall features can they do things like look at the profile gate",
    "start": "810639",
    "end": "816399"
  },
  {
    "text": "can they can they browse the logo mode can they um link their mobile and tv device that kind of thing um we",
    "start": "816399",
    "end": "824959"
  },
  {
    "text": "also have offline tasks one of those is something like building your lolimo offline so we have the ability to",
    "start": "824959",
    "end": "831839"
  },
  {
    "text": "classify our content in terms of groups and then the groups are basically entered into the",
    "start": "831839",
    "end": "837760"
  },
  {
    "text": "calculation and then that kind of gives you the kinds of content the user can see and that goes into the",
    "start": "837760",
    "end": "843920"
  },
  {
    "text": "calculation to build that messaging can also ask the questions can this user see this title or not and that",
    "start": "843920",
    "end": "851519"
  },
  {
    "text": "might tell them whether or not they should merge that particular title or potentially we also have some some",
    "start": "851519",
    "end": "858720"
  },
  {
    "text": "fraud type messages that could go through that path as well and then playback we're",
    "start": "858720",
    "end": "863920"
  },
  {
    "text": "asking question you know can this user play backward or download this particular title and so we have different kinds of of",
    "start": "863920",
    "end": "870720"
  },
  {
    "text": "apis that actually represent that but it doesn't really matter in the end it's different use cases and different things",
    "start": "870720",
    "end": "876000"
  },
  {
    "text": "that we're processing but we we do that through a coherent set of policies and the policies can be referenced between",
    "start": "876000",
    "end": "882160"
  },
  {
    "text": "each other inside of packs and then pax goes and can reach out to",
    "start": "882160",
    "end": "887440"
  },
  {
    "text": "um to to visit the user state from our identity provider you can also look at request attributes uh things like that",
    "start": "887440",
    "end": "894240"
  },
  {
    "text": "the passport and then we also as i mentioned before we look at various other systems like the um",
    "start": "894240",
    "end": "899920"
  },
  {
    "text": "you know kind of the presence signals and fraud signals as well to come up with our determination of",
    "start": "899920",
    "end": "906399"
  },
  {
    "text": "whether or not we allow that access",
    "start": "906399",
    "end": "909760"
  },
  {
    "start": "910000",
    "end": "936000"
  },
  {
    "text": "so how do we get back the failure dummy isolation i mentioned at the beginning of the presentation that having the",
    "start": "911680",
    "end": "917120"
  },
  {
    "text": "authorization rules and each service was kind of a good thing in some ways because then um you know if somebody",
    "start": "917120",
    "end": "924079"
  },
  {
    "text": "screws up one of the rules and pushes the code then it's not going to bring the whole system down so",
    "start": "924079",
    "end": "929839"
  },
  {
    "text": "how do we how do we achieve that same kind of thing with a centralized authorization service",
    "start": "929839",
    "end": "935920"
  },
  {
    "text": "[Music] so what we end up doing in netflix we have different regions where we deploy",
    "start": "935920",
    "end": "942320"
  },
  {
    "start": "936000",
    "end": "1011000"
  },
  {
    "text": "basically the full stack of all our services and um here they're listed as region a b",
    "start": "942320",
    "end": "948320"
  },
  {
    "text": "and c right and in each speech each region will have like i said the",
    "start": "948320",
    "end": "954320"
  },
  {
    "text": "full stack of services and we've done this kind of further within each region we've sharded the the",
    "start": "954320",
    "end": "960560"
  },
  {
    "text": "clusters by use case so we have one for online discovery in region a that would",
    "start": "960560",
    "end": "966720"
  },
  {
    "text": "be one cluster another one for playback and in region b um and we so on i don't know them all",
    "start": "966720",
    "end": "974240"
  },
  {
    "text": "here but there's a there's a number of them and that way if if one of them has an",
    "start": "974240",
    "end": "979759"
  },
  {
    "text": "issue because we push bad code or push to bad policy we tend to push them one at a time so",
    "start": "979759",
    "end": "985519"
  },
  {
    "text": "that we can get this kind of you know isolation effect if one of them goes bad for some reason",
    "start": "985519",
    "end": "991360"
  },
  {
    "text": "that's never happened by the way never will but if it did we could easily figure out what the",
    "start": "991360",
    "end": "997120"
  },
  {
    "text": "problem was and and roll back the process and you know get back to a clean slate so",
    "start": "997120",
    "end": "1003040"
  },
  {
    "text": "that and we can do that really without bringing the whole system down so that's kind of how we are able to isolate the failures",
    "start": "1003040",
    "end": "1011000"
  },
  {
    "start": "1011000",
    "end": "1252000"
  },
  {
    "text": "so next let's talk a little bit about scaling and cache consistency this is the kind of the first approach we did so",
    "start": "1013440",
    "end": "1019920"
  },
  {
    "text": "we actually have we don't want to have every client",
    "start": "1019920",
    "end": "1025199"
  },
  {
    "text": "call pax server for every request if we did that we would have very large",
    "start": "1025199",
    "end": "1030400"
  },
  {
    "text": "clusters and it would be really expensive to maintain and there would be a certain amount of latency that would",
    "start": "1030400",
    "end": "1035600"
  },
  {
    "text": "be undesirable so we have two different levels of caching that we implement one is the",
    "start": "1035600",
    "end": "1041600"
  },
  {
    "text": "request scope cache which is wherein if a client asks for the same result more than once for the same",
    "start": "1041600",
    "end": "1049200"
  },
  {
    "text": "within the scope of the same overall request then we just return the request back sorry the response back immediately",
    "start": "1049200",
    "end": "1056080"
  },
  {
    "text": "within that that particular um you know request so it's all contained locally within the client the second level of",
    "start": "1056080",
    "end": "1062880"
  },
  {
    "text": "caching is a distributed cache represented here as memcached what we do there is we go in and um if",
    "start": "1062880",
    "end": "1069840"
  },
  {
    "text": "the tax client whenever it gets a request we'll first reach out to numcash d and ask for that record if it doesn't",
    "start": "1069840",
    "end": "1075520"
  },
  {
    "text": "find it we'll go to pax to calculate it and if pax you know calculate something",
    "start": "1075520",
    "end": "1081120"
  },
  {
    "text": "then it will write it back to you to an uncached e we kind of do that to eliminate the pressure on the client",
    "start": "1081120",
    "end": "1086799"
  },
  {
    "text": "otherwise we could theoretically write the response from the client as well but we like to do it more from the server side",
    "start": "1086799",
    "end": "1094640"
  },
  {
    "text": "so that's all well and good and actually that works works pretty well and if you have a you know certain amount of",
    "start": "1094640",
    "end": "1100000"
  },
  {
    "text": "you know cached entries in your distributed cache then the odds of getting the server become lower and then",
    "start": "1100000",
    "end": "1105360"
  },
  {
    "text": "your latencies will improve which is which is all good the problem with that of course is this is a an authorization",
    "start": "1105360",
    "end": "1111840"
  },
  {
    "text": "service and it has lots of impacts and various you know pieces of the infrastructure so",
    "start": "1111840",
    "end": "1116960"
  },
  {
    "text": "if the underlying data changes to your decision then you need some way to to",
    "start": "1116960",
    "end": "1122799"
  },
  {
    "text": "evict that cash and so our first approach at eviction was um to do that asynchronously we",
    "start": "1122799",
    "end": "1128559"
  },
  {
    "text": "basically had our identity provider would send us a list of or not a list but a stream of of events right and we",
    "start": "1128559",
    "end": "1134559"
  },
  {
    "text": "would process those events and go and delete the entries in our cache and what we realized was that was not",
    "start": "1134559",
    "end": "1140559"
  },
  {
    "text": "going to going to work because the clients were asking for the same the answers again",
    "start": "1140559",
    "end": "1146880"
  },
  {
    "text": "too quickly right so you would have a quick page refresh on a change to a user",
    "start": "1146880",
    "end": "1151919"
  },
  {
    "text": "data and then we would need that to be reflected almost immediately so the latency was really too high with",
    "start": "1151919",
    "end": "1157840"
  },
  {
    "text": "this approach so we ended up not doing that and what we've arrived at is something a little bit different but",
    "start": "1157840",
    "end": "1163520"
  },
  {
    "text": "achieves the same results so instead of um instead of having the idp send events",
    "start": "1163520",
    "end": "1169520"
  },
  {
    "text": "due to changes for that we actually have the the idp produce a dirty record which is",
    "start": "1169520",
    "end": "1175200"
  },
  {
    "text": "basically the account id um and then basically it just has you know reference",
    "start": "1175200",
    "end": "1181280"
  },
  {
    "text": "to the fact that it's dirty inside of it and you put that into memcached directly from where the user data is stored",
    "start": "1181280",
    "end": "1188320"
  },
  {
    "text": "put that into the to the cache and then that way when the tax client is looking for records it always does a bulk read and",
    "start": "1188320",
    "end": "1194880"
  },
  {
    "text": "it always includes the key of the account for the dirty record um as part of the request and then we",
    "start": "1194880",
    "end": "1201679"
  },
  {
    "text": "know that if we get that dirty record back then we can't use the results of the cache we have to go back to the server",
    "start": "1201679",
    "end": "1207679"
  },
  {
    "text": "and in doing that we actually achieved the kind of um near synchronous approach that we were",
    "start": "1207679",
    "end": "1213360"
  },
  {
    "text": "looking for we also didn't need to couple the systems too much because all the idp really has to know is the fact",
    "start": "1213360",
    "end": "1218720"
  },
  {
    "text": "that it needs to write this dirty record it doesn't need to know anything about the internals of the caching structure that pax uses so it's",
    "start": "1218720",
    "end": "1225520"
  },
  {
    "text": "kind of you know two reasons for that one is we didn't want to you know put too much information into the",
    "start": "1225520",
    "end": "1231200"
  },
  {
    "text": "identity provider we also wanted to have this kind of near synchronous approach so doing that actually kind of achieved the",
    "start": "1231200",
    "end": "1237679"
  },
  {
    "text": "ends that we needed you can see some statistics here we had",
    "start": "1237679",
    "end": "1242880"
  },
  {
    "text": "you know about 4 million rps and the clients in about 400k rps on the server so we do get very high cash reads on",
    "start": "1242880",
    "end": "1250159"
  },
  {
    "text": "this so we also have something called dynamic",
    "start": "1250159",
    "end": "1256320"
  },
  {
    "start": "1252000",
    "end": "1309000"
  },
  {
    "text": "fallbacks which means that we can actually potentially produce a result directly from the client if they're called pax fails so",
    "start": "1256320",
    "end": "1264000"
  },
  {
    "text": "our passport which is our token agnostic identity that i mentioned earlier actually contains some fallback data",
    "start": "1264000",
    "end": "1270159"
  },
  {
    "text": "within it that we can actually use in some very simple rules that we keep in the client so for certain use cases",
    "start": "1270159",
    "end": "1276720"
  },
  {
    "text": "ones that are not highly sensitive you actually can authorize the use of a particular feature without",
    "start": "1276720",
    "end": "1283600"
  },
  {
    "text": "going directly to the server if the your server call were to fail so",
    "start": "1283600",
    "end": "1289440"
  },
  {
    "text": "um that's how we accomplish that it's very you know um like i said non non uh non-critical",
    "start": "1289440",
    "end": "1296480"
  },
  {
    "text": "things non-sensitive things but if if this if we were to get a certain percentage of failures on the pax server",
    "start": "1296480",
    "end": "1302799"
  },
  {
    "text": "we would still be able to move along this way so that's kind of how we handle the fallback",
    "start": "1302799",
    "end": "1309290"
  },
  {
    "start": "1309000",
    "end": "1369000"
  },
  {
    "text": "[Music] so in summary um in large-scale applications",
    "start": "1309290",
    "end": "1314320"
  },
  {
    "text": "a simplistic approach to authorization might not be good enough there's just not enough flexibility there you need to",
    "start": "1314320",
    "end": "1320880"
  },
  {
    "text": "have a way to introduce this complexity without putting the complexity everywhere so",
    "start": "1320880",
    "end": "1326559"
  },
  {
    "text": "want things to be you know more risk adaptive you want them to be more policy driven more easily changed",
    "start": "1326559",
    "end": "1334799"
  },
  {
    "text": "it's probably a good idea to start centralizing those things so how do you how do you handle it so",
    "start": "1334799",
    "end": "1340320"
  },
  {
    "text": "centralizing the policies around autism is a good idea but you still want to handle things like",
    "start": "1340320",
    "end": "1346240"
  },
  {
    "text": "the failure jumping in isolation you still want to create the right um the right surface area for for",
    "start": "1346240",
    "end": "1352880"
  },
  {
    "text": "failures and distributed caching is a good idea to help with performance but if you're",
    "start": "1352880",
    "end": "1358080"
  },
  {
    "text": "going to do that then you need to worry about cash consistency so that's what i have thank you very",
    "start": "1358080",
    "end": "1364159"
  },
  {
    "text": "much",
    "start": "1364159",
    "end": "1366400"
  },
  {
    "start": "1369000",
    "end": "1397000"
  },
  {
    "text": "thank you so much for that presentation it's fantastic i personally have some insights into pax and have been looking",
    "start": "1369679",
    "end": "1376240"
  },
  {
    "text": "forward to this for a while so thank you for sharing those insights i do think we have a couple of different",
    "start": "1376240",
    "end": "1382320"
  },
  {
    "text": "questions in chat already i saw that you already responded to some so let's dig into it",
    "start": "1382320",
    "end": "1388480"
  },
  {
    "text": "um firstly i think warren had a question about how do you services interact with pax is the client embedded into",
    "start": "1388480",
    "end": "1394000"
  },
  {
    "text": "applications or is it a standalone process yeah so we actually use a grpc type",
    "start": "1394000",
    "end": "1399919"
  },
  {
    "start": "1397000",
    "end": "1429000"
  },
  {
    "text": "model mostly so we have kind of a lightweight client that's generated from the proto definition and then the",
    "start": "1399919",
    "end": "1406240"
  },
  {
    "text": "lightweight client ends up getting embedded into those services um we actually ended up doing some custom",
    "start": "1406240",
    "end": "1413280"
  },
  {
    "text": "filters inside of the grpc client so it's not entirely generated we had to do that because we were doing that more",
    "start": "1413280",
    "end": "1419120"
  },
  {
    "text": "advanced caching but um it's still a pretty lightweight client so it really just you know um has that simple grpc",
    "start": "1419120",
    "end": "1426480"
  },
  {
    "text": "type interface awesome that's very clever",
    "start": "1426480",
    "end": "1431760"
  },
  {
    "start": "1429000",
    "end": "1470000"
  },
  {
    "text": "uh so for uh mike is asking for dynamic fallback um when the call fails open are",
    "start": "1431760",
    "end": "1437200"
  },
  {
    "text": "these rules encoded into the backslide yeah yeah so for the dynamic fallback we did have to also do some um",
    "start": "1437200",
    "end": "1444559"
  },
  {
    "text": "custom code inside of the the client but inside of those grpc filters right so um it's",
    "start": "1444559",
    "end": "1450640"
  },
  {
    "text": "it but the rules ended up being fairly simple right we just picked a few things that we knew that would be called very very commonly and things that we could",
    "start": "1450640",
    "end": "1457760"
  },
  {
    "text": "use a fail open kind model and so really those just kind of check the the fallback data inside of the input and",
    "start": "1457760",
    "end": "1464080"
  },
  {
    "text": "then um then run the rule if if if the grpc call fails",
    "start": "1464080",
    "end": "1470158"
  },
  {
    "start": "1470000",
    "end": "1529000"
  },
  {
    "text": "excellent um i think that's that's really interesting as well given you know the sort of",
    "start": "1470559",
    "end": "1476400"
  },
  {
    "text": "exposure of how you're dealing with with localized roles in the fallbacks so thank you",
    "start": "1476400",
    "end": "1481679"
  },
  {
    "text": "uh so does pax provide apis for uh other services or systems to validate cloud",
    "start": "1481679",
    "end": "1486960"
  },
  {
    "text": "client permissions yeah so so we have a number of different apis that we we provide in packs right",
    "start": "1486960",
    "end": "1494320"
  },
  {
    "text": "so we can allow um access to what we call features we can now allow access to",
    "start": "1494320",
    "end": "1499360"
  },
  {
    "text": "videos um we can um it's not really about asking if if something has a",
    "start": "1499360",
    "end": "1506960"
  },
  {
    "text": "a particular facet or something it's more about can i can i do this particular thing those are the kinds of questions that we like to",
    "start": "1506960",
    "end": "1512960"
  },
  {
    "text": "answer right so can i can i play back this video can i show this uh uh mdx type um",
    "start": "1512960",
    "end": "1519679"
  },
  {
    "text": "cast type button on the on the screen on my my ui um that's the kind of question that",
    "start": "1519679",
    "end": "1525120"
  },
  {
    "text": "we're generally handling um i think that answers the question i i i",
    "start": "1525120",
    "end": "1531039"
  },
  {
    "start": "1529000",
    "end": "1606000"
  },
  {
    "text": "would think so but i'm also a little bit curious actually if you're expanding that a little bit as we're thinking about things like trust for example for",
    "start": "1531039",
    "end": "1537679"
  },
  {
    "text": "today's track you know how much of these other segments that you're thinking about some device information versus",
    "start": "1537679",
    "end": "1543360"
  },
  {
    "text": "sort of fraud information is taken into consideration as you're showing these types different types of content",
    "start": "1543360",
    "end": "1550159"
  },
  {
    "text": "yeah yeah so so um we have you know different kinds of policies that apply in different",
    "start": "1550159",
    "end": "1555360"
  },
  {
    "text": "different cases often it's the you know the kind of the status of the user kind of whether they're paying or not plan i",
    "start": "1555360",
    "end": "1561360"
  },
  {
    "text": "think these things are kind of the the basic attributes and then also the the plan metadata that's associated with",
    "start": "1561360",
    "end": "1567440"
  },
  {
    "text": "that so we know kind of how many streams they're they're paying for that sort of thing and then on the device side we have you",
    "start": "1567440",
    "end": "1574320"
  },
  {
    "text": "know whether the device was fully authenticated or not or that this is a completely untrusted device",
    "start": "1574320",
    "end": "1579840"
  },
  {
    "text": "and then we know from that also what what kind of a device it is and what what that device should be doing so we",
    "start": "1579840",
    "end": "1585679"
  },
  {
    "text": "can kind of use that in our policies and then the fraud is kind of a layer on top of that where we can also say well",
    "start": "1585679",
    "end": "1591360"
  },
  {
    "text": "you know if you have all those other other attributes are correct and we think you don't have a high fraud score",
    "start": "1591360",
    "end": "1598320"
  },
  {
    "text": "then we're going to let you you know do this particular action so it's kind of a kind of a layering approach is kind of how i would think",
    "start": "1598320",
    "end": "1604159"
  },
  {
    "text": "about it um yeah i i really like that but it's also interesting given that it's not just in",
    "start": "1604159",
    "end": "1610480"
  },
  {
    "start": "1606000",
    "end": "1639000"
  },
  {
    "text": "terms of what the user should be like able to access in terms of permissions but also what are they able to access",
    "start": "1610480",
    "end": "1616000"
  },
  {
    "text": "and what what format are they able to access it so it's really it's really complex that way which is interesting",
    "start": "1616000",
    "end": "1622080"
  },
  {
    "text": "yeah yeah we we ended up doing that because we we realized that a pure permissions based approach just on the",
    "start": "1622080",
    "end": "1628159"
  },
  {
    "text": "user was just not not expressive enough what we were trying to do often these these device and other signals were",
    "start": "1628159",
    "end": "1633200"
  },
  {
    "text": "really kind of impacting the the user experience and what they should be able to do so we ended up with a with a more",
    "start": "1633200",
    "end": "1638799"
  },
  {
    "text": "complex model and um just last question on that as you're thinking about the sort of",
    "start": "1638799",
    "end": "1643840"
  },
  {
    "start": "1639000",
    "end": "1689000"
  },
  {
    "text": "fragments that make that identity is there a way in which you consider that whole for when you have certain amounts",
    "start": "1643840",
    "end": "1650000"
  },
  {
    "text": "of data are you able to sort of make those decisions when you might not have high trust or maybe not have parts of",
    "start": "1650000",
    "end": "1657200"
  },
  {
    "text": "those uh that data set does that make sense yeah i think i think that's that's true",
    "start": "1657200",
    "end": "1663600"
  },
  {
    "text": "yeah we don't always have a full picture of what's going on for example if a device was was unauthenticated then then",
    "start": "1663600",
    "end": "1670399"
  },
  {
    "text": "we know that it you know that we don't really know the device identity right and so in",
    "start": "1670399",
    "end": "1675919"
  },
  {
    "text": "those cases we kind of have to um you know account for that we have to know that well you know we know that we",
    "start": "1675919",
    "end": "1681360"
  },
  {
    "text": "don't really know what this device is but what are the things that that an unknown device can do and so it kind of",
    "start": "1681360",
    "end": "1686720"
  },
  {
    "text": "ends up being that that kind of a model makes sense thank you um and so",
    "start": "1686720",
    "end": "1692720"
  },
  {
    "start": "1689000",
    "end": "1777000"
  },
  {
    "text": "another question from chat how do you handle internalization uh if different countries or internationalization sorry",
    "start": "1692720",
    "end": "1698880"
  },
  {
    "text": "if different countries have different auth requirements do you handle it in a centralized form or do we take that into consideration yeah we do we we do have",
    "start": "1698880",
    "end": "1706640"
  },
  {
    "text": "rules sometimes that are based on on country it really kind of depends there's a lot of different systems that",
    "start": "1706640",
    "end": "1712399"
  },
  {
    "text": "that have dealt with with country in in netflix so um we kind of have to",
    "start": "1712399",
    "end": "1717679"
  },
  {
    "text": "work in the context of those other systems as well we have our um our catalog system which kind of assigns the",
    "start": "1717679",
    "end": "1724720"
  },
  {
    "text": "content windows to each title right and so we take advantage of that we actually look at",
    "start": "1724720",
    "end": "1729840"
  },
  {
    "text": "that we have our plan metadata which kind of allows users to sign up for particular",
    "start": "1729840",
    "end": "1736080"
  },
  {
    "text": "plans and those might be different per country and then we have the actual request that's coming in which is from a",
    "start": "1736080",
    "end": "1742880"
  },
  {
    "text": "particular country and it may or may not be on a vpn and so um so we kind of have to think about",
    "start": "1742880",
    "end": "1748559"
  },
  {
    "text": "country in a very nuanced way i guess what i'm saying it's kind of rare that we can say just in this country you can",
    "start": "1748559",
    "end": "1754399"
  },
  {
    "text": "only do this thing it's kind of like well all these other things have to be true as well right you know the user has to be available or that that video might",
    "start": "1754399",
    "end": "1760880"
  },
  {
    "text": "have to be available in that country this plan might have to be available and the user might have to be coming from that country at that point in time",
    "start": "1760880",
    "end": "1767679"
  },
  {
    "text": "um you know it's a it's a complex thing but we so so yeah i guess the short answer is",
    "start": "1767679",
    "end": "1773840"
  },
  {
    "text": "yes we do we do include country in those rules um and and expanding on that a little",
    "start": "1773840",
    "end": "1779600"
  },
  {
    "text": "bit is it so that the resource then sort of is defined to be available from a certain area or country are those rules",
    "start": "1779600",
    "end": "1785919"
  },
  {
    "text": "sort of localized to the resource or is that something that you maintain impacts",
    "start": "1785919",
    "end": "1791360"
  },
  {
    "text": "we kind of take a higher level approach in packs that we don't usually directly",
    "start": "1791360",
    "end": "1796799"
  },
  {
    "text": "um encode a particular resource i mean not not in terms of like like a video",
    "start": "1796799",
    "end": "1802799"
  },
  {
    "text": "the rule would be more like if if this video is supposed to be available in this country and the users coming from",
    "start": "1802799",
    "end": "1808320"
  },
  {
    "text": "this country then we're going to allow it that would be the kind of thing that we would you would express um but there might be you know certain",
    "start": "1808320",
    "end": "1815279"
  },
  {
    "text": "apis that we might only open up to certain countries it's quite possible we would do that and that might be encoded",
    "start": "1815279",
    "end": "1820720"
  },
  {
    "text": "in a packs policy that makes total sense thank you um another question from chat i didn't",
    "start": "1820720",
    "end": "1827039"
  },
  {
    "start": "1822000",
    "end": "1900000"
  },
  {
    "text": "quite understand why it's better for the idp to mark record so it's dirty rather than deleting the records could you elaborate on the differences a little",
    "start": "1827039",
    "end": "1833039"
  },
  {
    "text": "bit yeah so um what we were trying to do was not build in really tight coupling",
    "start": "1833039",
    "end": "1838640"
  },
  {
    "text": "between pacs and uh and idp we wanted to make sure that um the contract was very simple so that we",
    "start": "1838640",
    "end": "1844880"
  },
  {
    "text": "could you know expand in many different ways in the packs we actually have many different kinds of records that we deal",
    "start": "1844880",
    "end": "1850240"
  },
  {
    "text": "with as well right we have for every one of our different apis we actually have a different record type in in the um",
    "start": "1850240",
    "end": "1856799"
  },
  {
    "text": "in the cache right and that's because we need to basically you know encode the full response in the value and and if",
    "start": "1856799",
    "end": "1863600"
  },
  {
    "text": "the question is different then the value we we encode in the cache has to be different and so we didn't want to do is",
    "start": "1863600",
    "end": "1869519"
  },
  {
    "text": "build in you know say nine different record types into the idp and have them go delete it directly it was it was too",
    "start": "1869519",
    "end": "1876799"
  },
  {
    "text": "much so we figured if we just had one record that it wrote you know that would be a sufficient level of coupling and",
    "start": "1876799",
    "end": "1882799"
  },
  {
    "text": "not you know without you know being a brittle kind of system or if we added another one we'd have to go and update the idp again or maybe it would slow",
    "start": "1882799",
    "end": "1889440"
  },
  {
    "text": "down the idp to write you know delete that many records um so really it was just about coupling um",
    "start": "1889440",
    "end": "1895039"
  },
  {
    "text": "and i think we achieved a pretty good level of coupling with that that single dirty record",
    "start": "1895039",
    "end": "1900399"
  },
  {
    "start": "1900000",
    "end": "1944000"
  },
  {
    "text": "makes total sense um so another question from stephen um with uh the pax clients connecting",
    "start": "1900399",
    "end": "1906799"
  },
  {
    "text": "directly to memcached uh how do you connect magnum ksd from being overwhelmed in number of connections slash requests",
    "start": "1906799",
    "end": "1914320"
  },
  {
    "text": "yeah so we we just have very large cache d clusters um we just we understand what",
    "start": "1914320",
    "end": "1920000"
  },
  {
    "text": "our traffic patterns are and we we have um you know very very large uh clusters",
    "start": "1920000",
    "end": "1925039"
  },
  {
    "text": "that can handle that and then we have auto scaling um kind of built into that as well so",
    "start": "1925039",
    "end": "1930399"
  },
  {
    "text": "um it's not it's not really um than a problem so far so we just you",
    "start": "1930399",
    "end": "1935600"
  },
  {
    "text": "know kind of are used to operating that scale and there's there's other services at netflix that also use that same kind",
    "start": "1935600",
    "end": "1941440"
  },
  {
    "text": "of scale uh with with nuncashd so are you saying that maybe this isn't",
    "start": "1941440",
    "end": "1946720"
  },
  {
    "start": "1944000",
    "end": "1981000"
  },
  {
    "text": "for those who can't maintain really really large memcache deep clusters well it depends on on the level of scale",
    "start": "1946720",
    "end": "1953200"
  },
  {
    "text": "that you're dealing with i think right um you know if you are if you have that",
    "start": "1953200",
    "end": "1958320"
  },
  {
    "text": "kind of scale you probably have you know some distributed caching that can can also scale up to that level as",
    "start": "1958320",
    "end": "1963760"
  },
  {
    "text": "well um i guess you know the other way to think about it is we also have ways of failing",
    "start": "1963760",
    "end": "1969840"
  },
  {
    "text": "out of a region so if we really had stress in a particular region um the entire netflix service but would fail",
    "start": "1969840",
    "end": "1975840"
  },
  {
    "text": "over to another one that's also also a possibility",
    "start": "1975840",
    "end": "1981279"
  },
  {
    "start": "1981000",
    "end": "2054000"
  },
  {
    "text": "for sure um stephen also asked have you considered a jwt based access tokens so",
    "start": "1981279",
    "end": "1986640"
  },
  {
    "text": "clients don't even need to hit memcachedy yeah yeah so i mean we we originally",
    "start": "1986640",
    "end": "1992559"
  },
  {
    "text": "thought okay well what what if we just you know did all our authorization rules at the at the beginning right and then",
    "start": "1992559",
    "end": "2000000"
  },
  {
    "text": "passed down that information like say in our in our or say the jwt i think that",
    "start": "2000000",
    "end": "2005039"
  },
  {
    "text": "you're talking about is equivalent to our passport they're they're kind of very similar concepts um",
    "start": "2005039",
    "end": "2010480"
  },
  {
    "text": "and uh we ended up not doing that because um there was just a lot of information that we would need to encode inside of that",
    "start": "2010480",
    "end": "2017200"
  },
  {
    "text": "and we didn't really want to pass that around and then we we didn't want to also have too much knowledge about you",
    "start": "2017200",
    "end": "2022880"
  },
  {
    "text": "know what things would be downstream um all the way at the gateway so we kind",
    "start": "2022880",
    "end": "2027919"
  },
  {
    "text": "of settled on this approach where we would just put in you know fallback data as necessary for the you know really um",
    "start": "2027919",
    "end": "2034799"
  },
  {
    "text": "critical use cases and then pass that down and that that's that model has worked a",
    "start": "2034799",
    "end": "2039919"
  },
  {
    "text": "little better for us but you're right i mean it depends on what you're doing if you have a simpler model and a simpler",
    "start": "2039919",
    "end": "2045600"
  },
  {
    "text": "system and less things that you need to authorize then then yeah doing that right at the edge and then passing it",
    "start": "2045600",
    "end": "2051200"
  },
  {
    "text": "down is a perfectly valid model yeah very lengthy jwts can definitely",
    "start": "2051200",
    "end": "2057040"
  },
  {
    "start": "2054000",
    "end": "2127000"
  },
  {
    "text": "become a hassle yeah i know that for sure uh all right so do all server calls and",
    "start": "2057040",
    "end": "2064000"
  },
  {
    "text": "netflix include a password including offline tasks or schedule jobs yeah so",
    "start": "2064000",
    "end": "2069440"
  },
  {
    "text": "no no no the uh the passport is really about the access",
    "start": "2069440",
    "end": "2074720"
  },
  {
    "text": "tokens and it's our token agnostic identity that that comes through um so",
    "start": "2074720",
    "end": "2080398"
  },
  {
    "text": "yeah it's not necessarily true that every call will have a passport because we don't always have it for the offline",
    "start": "2080399",
    "end": "2086000"
  },
  {
    "text": "tasks we have ways of for those tasks to create them but often an offline task will be something that goes through",
    "start": "2086000",
    "end": "2092878"
  },
  {
    "text": "almost every user that we have and might want to do an operation on each of them and um having them you know call a",
    "start": "2092879",
    "end": "2099520"
  },
  {
    "text": "service to create a passport and then call packs is a bit too much overhead so we actually have different apis that",
    "start": "2099520",
    "end": "2105280"
  },
  {
    "text": "don't necessarily require a passport and those wouldn't have the same kinds of fallbacks either because it's just not",
    "start": "2105280",
    "end": "2112960"
  },
  {
    "text": "you know it's not a thing to have a fallback if you're just providing say a user id so um",
    "start": "2112960",
    "end": "2118480"
  },
  {
    "text": "it's a little bit of a different model but you know we can also support that with the the same policies",
    "start": "2118480",
    "end": "2123680"
  },
  {
    "text": "just the interface is a little bit different yeah makes sense um",
    "start": "2123680",
    "end": "2129440"
  },
  {
    "start": "2127000",
    "end": "2209000"
  },
  {
    "text": "other question from mike is how does pax works cross data center",
    "start": "2129440",
    "end": "2135040"
  },
  {
    "text": "uh yeah so the cross data center is um we actually have pacs involved in",
    "start": "2135280",
    "end": "2140720"
  },
  {
    "text": "it's deployed in each region we think about kind of think about things in regions right we have a few",
    "start": "2140720",
    "end": "2146240"
  },
  {
    "text": "major regions and we kind of make sure that everything is deployed in each of them um and then there's availability zones within the region but we don't",
    "start": "2146240",
    "end": "2152880"
  },
  {
    "text": "really worry about that too much um so yeah we have basically the equivalent",
    "start": "2152880",
    "end": "2158400"
  },
  {
    "text": "model in each region and each one can answer the questions exactly the same um",
    "start": "2158400",
    "end": "2164640"
  },
  {
    "text": "the the the thing that could be a little bit different with um when say a request gets gets moved from one region to",
    "start": "2164640",
    "end": "2170720"
  },
  {
    "text": "another is that there's a slight possibility of a race condition um and that's something that we just",
    "start": "2170720",
    "end": "2176400"
  },
  {
    "text": "kind of have to deal with i mean the the use case might be if you if you change the user's data in one region and then",
    "start": "2176400",
    "end": "2181839"
  },
  {
    "text": "immediately went to another region then it might be a slightly different thing that you'd see but it's not um",
    "start": "2181839",
    "end": "2187920"
  },
  {
    "text": "in our experience it's not the end of the world we don't really bounce between regions very often we tend to keep the user within a given region and it's only",
    "start": "2187920",
    "end": "2194960"
  },
  {
    "text": "if we have an e-back then we'll move them to another one and generally um you know chasing those",
    "start": "2194960",
    "end": "2200880"
  },
  {
    "text": "replication delays is just not a big issue it's it's pretty fast and it's not not a case where large numbers of users",
    "start": "2200880",
    "end": "2207440"
  },
  {
    "text": "are going to see problems and uh given that you mentioned that as",
    "start": "2207440",
    "end": "2212720"
  },
  {
    "start": "2209000",
    "end": "2265000"
  },
  {
    "text": "a as a sort of resolution to the the failure domain isolation uh when that occurs if we by mistake",
    "start": "2212720",
    "end": "2220720"
  },
  {
    "text": "uh i've released something that turns out to not be effective what does that look like for you know the users or for",
    "start": "2220720",
    "end": "2226560"
  },
  {
    "text": "the system yeah i mean if if we did have a um",
    "start": "2226560",
    "end": "2232400"
  },
  {
    "text": "a massive problem where we literally were safe denying everything",
    "start": "2232400",
    "end": "2237440"
  },
  {
    "text": "um then when we pushed to a given shard then then the clients would then start",
    "start": "2237440",
    "end": "2242480"
  },
  {
    "text": "seeing you know failure responses from that and then we would notice within",
    "start": "2242480",
    "end": "2248160"
  },
  {
    "text": "well probably about 20 seconds that that region was going bad and then core would start evacuating the",
    "start": "2248160",
    "end": "2254640"
  },
  {
    "text": "region if we didn't catch it before then if we cut it before then then we could roll it",
    "start": "2254640",
    "end": "2259760"
  },
  {
    "text": "back but that's that's kind of what would happen",
    "start": "2259760",
    "end": "2265280"
  },
  {
    "start": "2265000",
    "end": "2359000"
  },
  {
    "text": "thank you for sharing um we have about one more minute of q a and then we're gonna move into",
    "start": "2265280",
    "end": "2270400"
  },
  {
    "text": "a sort of ama hangout session for everybody so i think maybe one or two more questions",
    "start": "2270400",
    "end": "2276480"
  },
  {
    "text": "um this one i'm also very curious about which is you know how to change the rules embedded",
    "start": "2276480",
    "end": "2282560"
  },
  {
    "text": "into the pax client uh how do you deploy rule sets essentially do you need to redeploy every service or",
    "start": "2282560",
    "end": "2289599"
  },
  {
    "text": "any of these when you make changes to this rules essentially yeah so so we actually have a we have a",
    "start": "2289599",
    "end": "2294880"
  },
  {
    "text": "separate rule set uh repository that we use for our production rules and those",
    "start": "2294880",
    "end": "2300160"
  },
  {
    "text": "are what would end up getting deployed and we have a separate spinnaker pipeline that is capable of deploying",
    "start": "2300160",
    "end": "2305760"
  },
  {
    "text": "those so actually deploy the code and the rules entirely separately the real language that we use is um it's",
    "start": "2305760",
    "end": "2312560"
  },
  {
    "text": "actually an internal um rule language that we've developed in netflix for kind",
    "start": "2312560",
    "end": "2317760"
  },
  {
    "text": "of other purposes but we've adapted to use it in packs it's just called hendrix and it allows us to to express you know",
    "start": "2317760",
    "end": "2323920"
  },
  {
    "text": "very you know complex kind of trees of rules that we like um and then we basically can can um",
    "start": "2323920",
    "end": "2331359"
  },
  {
    "text": "have tests that that run against those rules as well both in kind of the high level is this is this rule valid",
    "start": "2331359",
    "end": "2337920"
  },
  {
    "text": "and then we have tests that run against uh with the with the pax codes we know that the test is also the rule is also",
    "start": "2337920",
    "end": "2343839"
  },
  {
    "text": "valid within in the tax code and then um you know our pipeline basically does you know ci on that and",
    "start": "2343839",
    "end": "2350960"
  },
  {
    "text": "then it publishes to um to the regions in a specific order so um that's kind of how we how we",
    "start": "2350960",
    "end": "2357440"
  },
  {
    "text": "achieve that perfect that's fantastic i think you want to expand on that a little in the ama um i know we're out of time so thank",
    "start": "2357440",
    "end": "2365200"
  },
  {
    "start": "2359000",
    "end": "2391000"
  },
  {
    "text": "you so much travis this was super interesting uh i have so many more things that i would love to expand on",
    "start": "2365200",
    "end": "2370800"
  },
  {
    "text": "and maybe if there are linkouts to other talks related to some of this i think that would be fantastic so thank you so",
    "start": "2370800",
    "end": "2377040"
  },
  {
    "text": "much for today sure thank you",
    "start": "2377040",
    "end": "2382119"
  },
  {
    "text": "[Music]",
    "start": "2383900",
    "end": "2389349"
  },
  {
    "text": "you",
    "start": "2391359",
    "end": "2393440"
  }
]