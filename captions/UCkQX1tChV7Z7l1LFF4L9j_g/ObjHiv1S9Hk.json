[
  {
    "text": "[Music]",
    "start": "3350",
    "end": "14249"
  },
  {
    "text": "hello and thank you for joining this talk today it's really great to be back at cuon again and thank you to everyone",
    "start": "15400",
    "end": "22039"
  },
  {
    "text": "at cuon for organizing a great conference and a great track it's an absolute privilege to be speaking to you",
    "start": "22039",
    "end": "28960"
  },
  {
    "text": "today I want to talk about some of the concrete things we've learned whilst building out our architecture here at",
    "start": "28960",
    "end": "34960"
  },
  {
    "text": "monzo things we've got them right and our Tales of wow when things have gone",
    "start": "34960",
    "end": "40680"
  },
  {
    "text": "wrong hi I'm sahal I'm one of the staff Engineers within the platform group at monzo I work on the underlying platform",
    "start": "40680",
    "end": "48199"
  },
  {
    "text": "powering the bank we think about all of the complexities of scaling our infrastructure and building the right",
    "start": "48199",
    "end": "54440"
  },
  {
    "text": "tools so engineers in other teams can focus on building all of the features that customers",
    "start": "54440",
    "end": "61920"
  },
  {
    "text": "desire at monzo our goal is to make money work for everyone we deal with the",
    "start": "62640",
    "end": "68920"
  },
  {
    "text": "complexity to make money management easy for everyone as I'm sure many will",
    "start": "68920",
    "end": "74200"
  },
  {
    "text": "attest banking is a really complex industry and we undertake the complexity",
    "start": "74200",
    "end": "79240"
  },
  {
    "text": "in our systems to give customers a better experience we have 7 million",
    "start": "79240",
    "end": "84960"
  },
  {
    "text": "customers relying on us for their core banking needs to lean into that complexity a",
    "start": "84960",
    "end": "91680"
  },
  {
    "text": "little on the slide is some of the many payment Integrations we we build for and",
    "start": "91680",
    "end": "97079"
  },
  {
    "text": "support some of these schemes are still based on moving FTP files around each of",
    "start": "97079",
    "end": "102600"
  },
  {
    "text": "them have different standards and rules and criteria which we're constantly iterating on to make sure that we can",
    "start": "102600",
    "end": "109240"
  },
  {
    "text": "launch new features for our customers without surfacing the internal complexities and limiting our product",
    "start": "109240",
    "end": "117000"
  },
  {
    "text": "offering in September 2022 we became direct participants of the backx scheme",
    "start": "118000",
    "end": "124200"
  },
  {
    "text": "for those unfamiliar backx Powers direct debits and direct credits here in the UK",
    "start": "124200",
    "end": "129360"
  },
  {
    "text": "it's how your salary gets paid or how your bills get automatically deducted from your bank account on a fortnightly",
    "start": "129360",
    "end": "135440"
  },
  {
    "text": "or monthly basis it was originally built around a 3-day processing cycle which",
    "start": "135440",
    "end": "141519"
  },
  {
    "text": "originally gave time for operators at Banks to walk magnetic tapes with payment instructions between Banks",
    "start": "141519",
    "end": "147800"
  },
  {
    "text": "almost like a sneak andet monzo has been integrated with the back scheme since",
    "start": "147800",
    "end": "153319"
  },
  {
    "text": "2017 but that was through a partner that handled all of the integration on our behalf we did a whole bunch of work in",
    "start": "153319",
    "end": "160560"
  },
  {
    "text": "2022 to build that integration directly ourselves over the Swift Network we",
    "start": "160560",
    "end": "166400"
  },
  {
    "text": "rolled it out to our customers and most crucially no one noticed the thing this is going to be a particular theme for",
    "start": "166400",
    "end": "172959"
  },
  {
    "text": "this talk now a key decision is to deploy all of the infrastructure and services on on",
    "start": "172959",
    "end": "179840"
  },
  {
    "text": "top of AWS it's almost a given now in the banking industry with uh fintech",
    "start": "179840",
    "end": "185080"
  },
  {
    "text": "coming along but at the time it was completely unheard of in financial services at this time the financial",
    "start": "185080",
    "end": "192040"
  },
  {
    "text": "conduct Authority which is the regulator for financial institutions here in the UK was still putting out initial",
    "start": "192040",
    "end": "197959"
  },
  {
    "text": "guidance on cloud computing and Outsourcing if you read some of the guidance it mentions things like",
    "start": "197959",
    "end": "203959"
  },
  {
    "text": "Regulators being able to visit data centers during audits I'm not sure whether that would fly with aw us if you",
    "start": "203959",
    "end": "210280"
  },
  {
    "text": "rock up to an availability Zone and ask them to go see the blinking lights for your instances monzo was one of the first",
    "start": "210280",
    "end": "217400"
  },
  {
    "text": "companies to embrace the cloud we do have a few data centers to integrate with some of the payment schemes I",
    "start": "217400",
    "end": "223159"
  },
  {
    "text": "mentioned previously but we run the absolute minimum compute possible to interface messages with our core",
    "start": "223159",
    "end": "229840"
  },
  {
    "text": "platform that does all of the decisioning on top of services that we build on top of",
    "start": "229840",
    "end": "236200"
  },
  {
    "text": "AWS so we've got all the infrastructure we need to run a bank thanks to things",
    "start": "236360",
    "end": "241840"
  },
  {
    "text": "like AWS and now we need the software now there's a bunch of vendors out there that will sell you pre-built Solutions",
    "start": "241840",
    "end": "248879"
  },
  {
    "text": "of banking ledgers and banking systems however most of these rely on processing",
    "start": "248879",
    "end": "254120"
  },
  {
    "text": "everything on premise in a date Center monza's goal was to be a modern bank so",
    "start": "254120",
    "end": "259759"
  },
  {
    "text": "the product wasn't burdened by Legacy technology this meant being built to run",
    "start": "259759",
    "end": "264840"
  },
  {
    "text": "in a cloud environment one of the big benefits of monzo is that we retain all of our slack post from the very",
    "start": "264840",
    "end": "271199"
  },
  {
    "text": "beginning and here's one of the first mentions of our Tech strategy you know when you're building something new you",
    "start": "271199",
    "end": "277600"
  },
  {
    "text": "really want to jump into the new hotness that Tom there if you aren't aware is Tom blumfield who was monzo's CEO until",
    "start": "277600",
    "end": "284840"
  },
  {
    "text": "2020 whilst this was probably intended to be an off-hand post Tom was actually much closer to reality than anyone",
    "start": "284840",
    "end": "292160"
  },
  {
    "text": "realized I was wondering why Banks often have downtime during time changes from Summer to wintertime and a lot of that",
    "start": "292160",
    "end": "299039"
  },
  {
    "text": "comes down to concern around really old systems seeing a clock hour repeat twice",
    "start": "299039",
    "end": "304639"
  },
  {
    "text": "we didn't want to be burdened with that kind of Technology one really early decision we",
    "start": "304639",
    "end": "311440"
  },
  {
    "text": "made at monzo is to adopt microservices the original Engineers had plenty of",
    "start": "311440",
    "end": "316720"
  },
  {
    "text": "experience working in Prior organizations where every change would be part of a massive bundle of software",
    "start": "316720",
    "end": "322840"
  },
  {
    "text": "that was released infrequently now there isn't a magic formula to kickstarting the technology",
    "start": "322840",
    "end": "328560"
  },
  {
    "text": "for a bank you need a reliable way to store money within your systems a few of",
    "start": "328560",
    "end": "333840"
  },
  {
    "text": "the first things that we built were services to handle our banking Ledger a service to handle signups a service to",
    "start": "333840",
    "end": "340759"
  },
  {
    "text": "handle accounts and a service to handle authentication and",
    "start": "340759",
    "end": "345800"
  },
  {
    "text": "authorization each of these services are context bound and crucially manage their own data we Define protuff interfaces",
    "start": "346000",
    "end": "354120"
  },
  {
    "text": "and statically generate code to Marshall data between services this means that",
    "start": "354120",
    "end": "359600"
  },
  {
    "text": "services are not doing database level joins between entities like accounts and transactions and ledgers this is super",
    "start": "359600",
    "end": "367160"
  },
  {
    "text": "important to establish a solid API and semantic contract between entities and",
    "start": "367160",
    "end": "372520"
  },
  {
    "text": "how they behave a side benefit for this is making it easier to separate entities",
    "start": "372520",
    "end": "378160"
  },
  {
    "text": "between different database instances as we've continued to scale which I'll talk about in a",
    "start": "378160",
    "end": "383960"
  },
  {
    "text": "bit for example the transaction model has a unique account entity flake ID",
    "start": "383960",
    "end": "389599"
  },
  {
    "text": "with the data it stores but all the other information lives within the account service to get full information",
    "start": "389599",
    "end": "396240"
  },
  {
    "text": "on the account we call the account service using an RPC which gives us the most up-to-date information on a",
    "start": "396240",
    "end": "402080"
  },
  {
    "text": "particular account in the early days monzo did RPC",
    "start": "402080",
    "end": "407560"
  },
  {
    "text": "over rabbit mq you can actually see remnants of it in our open-source RPC Library Typhon on GitHub a request would",
    "start": "407560",
    "end": "415840"
  },
  {
    "text": "be pushed onto a que using amqp and and then a reply would go into the reply",
    "start": "415840",
    "end": "421520"
  },
  {
    "text": "queue rabbit mq dealt with the load balancing and deliverability aspects of",
    "start": "421520",
    "end": "426800"
  },
  {
    "text": "these messages remember that this was in 2015 so the world of service meshes and",
    "start": "426800",
    "end": "432680"
  },
  {
    "text": "dynamic routing proxies was still in their infancy and this was way before grpc it was about the time that finagle",
    "start": "432680",
    "end": "440000"
  },
  {
    "text": "was getting adoption nowadays we just use play node",
    "start": "440000",
    "end": "445120"
  },
  {
    "text": "HTTP for our RPC framework take for example a custom using their card to pay",
    "start": "445120",
    "end": "451039"
  },
  {
    "text": "for something quite a few distinct Services get involved in real time",
    "start": "451039",
    "end": "456199"
  },
  {
    "text": "whenever you make a transaction to contribute to the decision on whether a payment should be accepted or",
    "start": "456199",
    "end": "462720"
  },
  {
    "text": "declined this decision- making isn't in isolation organizationally we need to",
    "start": "462720",
    "end": "468319"
  },
  {
    "text": "interact with Services built up by our payments teams that manage integration with MasterCard services within our",
    "start": "468319",
    "end": "474319"
  },
  {
    "text": "financial crime domain to assert whether the payment is legitimate services within our legit teams to record the",
    "start": "474319",
    "end": "480199"
  },
  {
    "text": "transaction in our books and much more this is just for one payment scheme",
    "start": "480199",
    "end": "486520"
  },
  {
    "text": "and we don't want to build separate account and Ledger and transaction abstractions for every scheme or make",
    "start": "486520",
    "end": "492479"
  },
  {
    "text": "decisions in isolation so many of these services and abstractions need to be agnostic and need to scale and grow",
    "start": "492479",
    "end": "500000"
  },
  {
    "text": "independently to handle all of the various payment Integrations an early decision we made",
    "start": "500000",
    "end": "507520"
  },
  {
    "text": "was also to use Cassandra as our core database for our services each service would operate under its own keyspace and",
    "start": "507520",
    "end": "515120"
  },
  {
    "text": "there was a strict isolation between keyspaces so a service could not read the data from another service directly",
    "start": "515120",
    "end": "522240"
  },
  {
    "text": "and we actually encoded this as a core security control so that Cross Key spaces reads were completely forbidden",
    "start": "522240",
    "end": "529360"
  },
  {
    "text": "for those that aren't familiar Cassandra is a open source no SQL database which",
    "start": "529360",
    "end": "535240"
  },
  {
    "text": "spreads data across multiple nodes based on partitioning and replication this means that you can grow and shrink",
    "start": "535240",
    "end": "541959"
  },
  {
    "text": "the cluster dynamically and add capacity this is a super powerful capability because I'm sure many of us",
    "start": "541959",
    "end": "548519"
  },
  {
    "text": "have stories of database infrastructures being massive projects and sometimes going wrong at the worst possible",
    "start": "548519",
    "end": "556480"
  },
  {
    "text": "time Cassandra is an eventually consistent system it uses timestamps and",
    "start": "557040",
    "end": "562640"
  },
  {
    "text": "Quorum based reads to provide stronger consistency guarantees and last right win",
    "start": "562640",
    "end": "568120"
  },
  {
    "text": "semantics in the example here the account keyspace specifies a replication factor of three",
    "start": "568120",
    "end": "575560"
  },
  {
    "text": "and we've defined in our query that we want local Quorum so it will reach out to the three nodes owning that piece of",
    "start": "575560",
    "end": "582000"
  },
  {
    "text": "data indicated in Orange and return When the majority which is two out of three here agree on what the data should",
    "start": "582000",
    "end": "590880"
  },
  {
    "text": "be as your data is partitioned over nodes it's very important to define a",
    "start": "590880",
    "end": "595959"
  },
  {
    "text": "partitioning key which will allow a good spread of data across the nodes to evenly distribute",
    "start": "595959",
    "end": "602320"
  },
  {
    "text": "the load across nodes and avoid hot partitions similarly to choosing a good hash algorithm choosing a partitioning",
    "start": "602320",
    "end": "609640"
  },
  {
    "text": "key is not always easy you may need to strike a balance between fast access and",
    "start": "609640",
    "end": "615200"
  },
  {
    "text": "duplication of data across different tables this is something that Cassandra excels at writing data is extremely",
    "start": "615200",
    "end": "622680"
  },
  {
    "text": "cheap often you have a data model that works well for a period of time you may",
    "start": "622680",
    "end": "628279"
  },
  {
    "text": "accumulate in enough under one partition which then requires changes to rehard it",
    "start": "628279",
    "end": "633399"
  },
  {
    "text": "this is not too dissimilar from tuning indexes in a relational store in the example above if a particular hotel has",
    "start": "633399",
    "end": "640760"
  },
  {
    "text": "millions of points of interest the last table may be a very expensive one to read for all of the points of interest",
    "start": "640760",
    "end": "647440"
  },
  {
    "text": "for that particular Hotel Additionally the partition nature",
    "start": "647440",
    "end": "653320"
  },
  {
    "text": "of Cassandra means that iterating over the entire data set is expensive many distinct machines need to be involved to",
    "start": "653320",
    "end": "660160"
  },
  {
    "text": "satisfy a select star and count queries and it's often advised to avoid such queries we completely forbid them there",
    "start": "660160",
    "end": "668399"
  },
  {
    "text": "are constraints that we've had to continuously train our Engineers for many Engineers come from an sqr past",
    "start": "668399",
    "end": "675959"
  },
  {
    "text": "with relational stores and often need a bit of time to adjust to modeling data in different",
    "start": "675959",
    "end": "682920"
  },
  {
    "text": "ways another big disadvantage is the lack of transactions a pattern we've",
    "start": "682920",
    "end": "688120"
  },
  {
    "text": "adopted quite bro brly is the concept around canonical and index tables and we",
    "start": "688120",
    "end": "693560"
  },
  {
    "text": "write data in reverse order first to the index tables and then lastly to the",
    "start": "693560",
    "end": "698880"
  },
  {
    "text": "canonical table this means if a row is present in the canonical table we can",
    "start": "698880",
    "end": "704160"
  },
  {
    "text": "guarantee that it's been written to all prior index tables too and thus the right is fully complete say we wanted to",
    "start": "704160",
    "end": "711440"
  },
  {
    "text": "add a point of interest to this scheme we've chosen the top table which is the hotel's table as our canonical table",
    "start": "711440",
    "end": "719079"
  },
  {
    "text": "first of all we'd write to the pois by Hotel table here then we'd write to the",
    "start": "719079",
    "end": "725320"
  },
  {
    "text": "hotels by POI table afterwards this means that our two index tables have the POI",
    "start": "725320",
    "end": "732720"
  },
  {
    "text": "inserted lastly we'd add the POI to the hotel's table set this means that the",
    "start": "732720",
    "end": "739000"
  },
  {
    "text": "hotel's table there is our canonical table now scalability is great but comes",
    "start": "739000",
    "end": "744800"
  },
  {
    "text": "with some amount of complexity and a learning curve like learning how to write data in a reliable fashion we",
    "start": "744800",
    "end": "751360"
  },
  {
    "text": "provide abstractions and autogenerated code around all of this so that Engineers are not dealing with this by",
    "start": "751360",
    "end": "757800"
  },
  {
    "text": "hand but it's important that we don't wave away distributed systems failures that do occur from time to",
    "start": "757800",
    "end": "765959"
  },
  {
    "text": "time so we have services and we have data storage and a way for services to",
    "start": "765959",
    "end": "772120"
  },
  {
    "text": "communicate with each other over RPC we need a way to run these services in a",
    "start": "772120",
    "end": "777399"
  },
  {
    "text": "highly available manner we moved to kubernetes in 2016 away from a previous maos and Marathon cluster",
    "start": "777399",
    "end": "784560"
  },
  {
    "text": "which we were running at the time kubernetes was still quite rough it was still the 1.0 days and you can sense",
    "start": "784560",
    "end": "791600"
  },
  {
    "text": "that the kubernetes project was going to be big and the alert of an open-source orchestrator for application development",
    "start": "791600",
    "end": "798199"
  },
  {
    "text": "and operations is really really tempting at the time there weren't all of these managed offerings and the",
    "start": "798199",
    "end": "805199"
  },
  {
    "text": "documentation and production hardness which we take for granted to day wasn't present this meant that we had to get",
    "start": "805199",
    "end": "812560"
  },
  {
    "text": "really really good at running kubernetes and understanding all of its different foibles but that knowledge has paid off",
    "start": "812560",
    "end": "818079"
  },
  {
    "text": "in abundance over the last couple years in mid 2016 is when we decided to",
    "start": "818079",
    "end": "824600"
  },
  {
    "text": "switch to http as part of our migration to kubernetes and use a HTTP service",
    "start": "824600",
    "end": "830040"
  },
  {
    "text": "proxy called link which was built on top of finagle for our service Discovery and routing it plugged in really nicely with",
    "start": "830040",
    "end": "837360"
  },
  {
    "text": "a kubernetes based service Discovery we gained much fancier load balancing and",
    "start": "837360",
    "end": "842560"
  },
  {
    "text": "resiliency properties especially in the case of a service instance being slow or",
    "start": "842560",
    "end": "848320"
  },
  {
    "text": "unreliable it wasn't without problem though there was a particular outage that we had in the early days where an",
    "start": "848320",
    "end": "854959"
  },
  {
    "text": "interaction between kubernetes and ETD meant that our service Discovery completely broke and we ended up with no",
    "start": "854959",
    "end": "861880"
  },
  {
    "text": "healthy end points for any of our services there's an excellent cubec con talk online if you want to go learn more",
    "start": "861880",
    "end": "867759"
  },
  {
    "text": "about that in the end though these are teething problems like with any technology bet that is still emerging",
    "start": "867759",
    "end": "874360"
  },
  {
    "text": "and maturing there's a fantastic website called",
    "start": "874360",
    "end": "880600"
  },
  {
    "text": "k.a which has stories from many other companies about some of the foot guns of running kubernetes and its Associated",
    "start": "880600",
    "end": "887600"
  },
  {
    "text": "Cloud native components you might read all of these and come to some conclusion that",
    "start": "887600",
    "end": "892759"
  },
  {
    "text": "kubernetes is really really complicated or should be avoided at all cost because all of the problems that that many",
    "start": "892759",
    "end": "899120"
  },
  {
    "text": "companies have surfaced but instead think of these as extremely valuable learnings and experiences from companies",
    "start": "899120",
    "end": "905680"
  },
  {
    "text": "and teams that are running these systems at scale these technological choices were",
    "start": "905680",
    "end": "912399"
  },
  {
    "text": "made when we had tens of Engineers and services but have allowed us to scale to over 300 engineers and 2,500",
    "start": "912399",
    "end": "920399"
  },
  {
    "text": "microservices and hundreds of deployments daily even on Fridays we have a completely different",
    "start": "920399",
    "end": "926639"
  },
  {
    "text": "organizational structure even compared to 2 years ago Services can be deployed",
    "start": "926639",
    "end": "932000"
  },
  {
    "text": "and scaled independently and more crucially there is a clear separation boundary for services and data which",
    "start": "932000",
    "end": "939800"
  },
  {
    "text": "allows us to change ownership of services from an organizational point of",
    "start": "939800",
    "end": "945279"
  },
  {
    "text": "view a key principle we've had is uniformity of how we build our services",
    "start": "945279",
    "end": "951839"
  },
  {
    "text": "for the vast majority of microservices that we build they follow the same template and use the same core abstra",
    "start": "951839",
    "end": "958800"
  },
  {
    "text": "actions our platform teams deal with the infrastructure but then also embed the",
    "start": "958800",
    "end": "964040"
  },
  {
    "text": "best practices directly into our library layers within a microservice itself",
    "start": "964040",
    "end": "970680"
  },
  {
    "text": "Engineers are focusing on filling in the business Logic for their services Engineers are not rewriting CH",
    "start": "970680",
    "end": "976959"
  },
  {
    "text": "abstractions like marshaling of data or HTTP servers or metrics for every new",
    "start": "976959",
    "end": "982800"
  },
  {
    "text": "service they add or Reinventing the will on how they write their data to Cassandra they can rely on a",
    "start": "982800",
    "end": "988880"
  },
  {
    "text": "well-defined and tested set of libraries and tooling and abstractions all of these shared core",
    "start": "988880",
    "end": "995240"
  },
  {
    "text": "layers provide batteries included metrics logging and tracing by default and everyone contributes to these core",
    "start": "995240",
    "end": "1004199"
  },
  {
    "text": "abstractions we use open source tools like Prometheus grafana Jager open",
    "start": "1004199",
    "end": "1009920"
  },
  {
    "text": "Telemetry and elastic search to run our observability stack we invest heavily in",
    "start": "1009920",
    "end": "1015399"
  },
  {
    "text": "scraping and collecting all of this Telemetry data from our services and infrastructure as of writing this talk",
    "start": "1015399",
    "end": "1022079"
  },
  {
    "text": "we're scraping over 25 million metric samples and hundreds of thousands of spans at any one point from our services",
    "start": "1022079",
    "end": "1030000"
  },
  {
    "text": "let me assure you this is not cheap but we are thankful each time we have an incident and can quickly identify",
    "start": "1030000",
    "end": "1036520"
  },
  {
    "text": "contributing factors using easily accessible",
    "start": "1036520",
    "end": "1041799"
  },
  {
    "text": "Telemetry for every new service that comes online we immediately get thousands of metrics which we can then",
    "start": "1042079",
    "end": "1048679"
  },
  {
    "text": "plot on templated ready too dashboards Engineers can go to a common fully",
    "start": "1048679",
    "end": "1054679"
  },
  {
    "text": "templated dashboard from the minute their new Services deployed and see information on how long requests are",
    "start": "1054679",
    "end": "1060760"
  },
  {
    "text": "taking how many database queries are being done and much more this also feeds",
    "start": "1060760",
    "end": "1066880"
  },
  {
    "text": "into generic alerts we have automated generic alerts for all of our services based on these common metrics so there's",
    "start": "1066880",
    "end": "1073919"
  },
  {
    "text": "no excuse for a service not being covered by an alert alert are",
    "start": "1073919",
    "end": "1079120"
  },
  {
    "text": "automatically rooted to the right team which owns that service and we Define service ownership within our service",
    "start": "1079120",
    "end": "1087360"
  },
  {
    "text": "catalog this Telemetry data has come full circle we have this customer feature called get paid early where you",
    "start": "1087360",
    "end": "1094480"
  },
  {
    "text": "can get your salary a day earlier than it is meant to be paid and this is a completely free feature that we provide",
    "start": "1094480",
    "end": "1100640"
  },
  {
    "text": "to our customers as you can imagine this feature is really popular because who",
    "start": "1100640",
    "end": "1105760"
  },
  {
    "text": "doesn't want their money as soon as possible now in the past we've had issues running this feature because it",
    "start": "1105760",
    "end": "1112039"
  },
  {
    "text": "causes a multitude spike in load as our customers come rushing in to get their money as we are constantly iterating on",
    "start": "1112039",
    "end": "1119720"
  },
  {
    "text": "our back end and our microservices new service dependencies would become part of the hot path and may not be",
    "start": "1119720",
    "end": "1126080"
  },
  {
    "text": "adequately provisioned to handle the spikes and load this is not something that we can statically incode because",
    "start": "1126080",
    "end": "1131919"
  },
  {
    "text": "this is continuously shifting especially when you have expected load needing to rely on",
    "start": "1131919",
    "end": "1137480"
  },
  {
    "text": "autoscaling can be problematic as there is a couple minutes of lag time for an autoscaler to kick in we could massively",
    "start": "1137480",
    "end": "1145080"
  },
  {
    "text": "over provision all of the services on our platform but that has large cost implications and it's compute that is",
    "start": "1145080",
    "end": "1151480"
  },
  {
    "text": "ultimately being wasted when it is underutilized what we did is we used our",
    "start": "1151480",
    "end": "1158039"
  },
  {
    "text": "Prometheus and tracing data to dynamically analyze what services are",
    "start": "1158039",
    "end": "1163440"
  },
  {
    "text": "involved in the hot Paths of this feature and then we scale them appropriately each time this feature is",
    "start": "1163440",
    "end": "1169840"
  },
  {
    "text": "provided this means we're not relying on a static list of services which often went stale this drastically reduced the",
    "start": "1169840",
    "end": "1177120"
  },
  {
    "text": "human error rate and has made this feature just another cool thing that runs itself on our platform without",
    "start": "1177120",
    "end": "1182960"
  },
  {
    "text": "human intervention and this is thanks to Telemetry data being used in Full",
    "start": "1182960",
    "end": "1189440"
  },
  {
    "text": "Circle one of our core goals is to abstract away platform infrastructure from Engineers this comes from two key",
    "start": "1189520",
    "end": "1197240"
  },
  {
    "text": "desires firstly Engineers shouldn't need a PhD in writing kubernetes yamamo to",
    "start": "1197240",
    "end": "1202960"
  },
  {
    "text": "interact with systems like kubernetes and secondly we want to provide an opinionated set of features",
    "start": "1202960",
    "end": "1209679"
  },
  {
    "text": "that we deeply understand and actively support kubernetes has an extremely wide surface area and there are multiple ways",
    "start": "1209679",
    "end": "1216880"
  },
  {
    "text": "of doing things our goal is to raise the level of abstraction to ease the burden on",
    "start": "1216880",
    "end": "1223960"
  },
  {
    "text": "application engineering teams that use our platform and to reduce our Personnel cost in operating the",
    "start": "1223960",
    "end": "1231320"
  },
  {
    "text": "platform for example when an engineer wants to deploy a change we provide tooling that runs through the full gamut",
    "start": "1231320",
    "end": "1238400"
  },
  {
    "text": "of validating their changes building all of the relevant Docker images in a clean environment generating all of the",
    "start": "1238400",
    "end": "1245039"
  },
  {
    "text": "kubernetes Manifest and getting all of this deployed our Engineers don't interact with kubernetes yaml unless",
    "start": "1245039",
    "end": "1251320"
  },
  {
    "text": "they are going off the well paved Road for their services we are currently doing a large project to move our",
    "start": "1251320",
    "end": "1257760"
  },
  {
    "text": "kubernetes infrastructure that we run ourselves onto eks and that transition has also been abstracted away by this",
    "start": "1257760",
    "end": "1264919"
  },
  {
    "text": "pipeline for many Engineers it's quite liberating to not have to worry about the underlying infrastructure they can",
    "start": "1264919",
    "end": "1272000"
  },
  {
    "text": "just write their software and it just runs on top of the platform a small plug but hopefully one",
    "start": "1272000",
    "end": "1278679"
  },
  {
    "text": "that is allowed if you want to learn a bit more about our approach to our deployments code generation and things",
    "start": "1278679",
    "end": "1284679"
  },
  {
    "text": "like our service catalog I have a talk from last year at qon London which is live on infoq where we go into more",
    "start": "1284679",
    "end": "1291480"
  },
  {
    "text": "details on the tours that we have built and use in our approach to our developer",
    "start": "1291480",
    "end": "1298480"
  },
  {
    "text": "experience as hard as we might try to minimize it you have to embrace the failure modes of distributed systems say",
    "start": "1298480",
    "end": "1305919"
  },
  {
    "text": "for example a right was happening from a service and that right experienced some turbulence so you didn't get a positive",
    "start": "1305919",
    "end": "1313080"
  },
  {
    "text": "indication whether that data had been written or the data couldn't be written at quar",
    "start": "1313080",
    "end": "1320039"
  },
  {
    "text": "when you go to read the data again at Quorum depending on which nodes you read the data from you may get two different",
    "start": "1320039",
    "end": "1326400"
  },
  {
    "text": "set of results this is a level of inconsistency which a service might not be able to",
    "start": "1326400",
    "end": "1333440"
  },
  {
    "text": "tolerate a pattern we've been using quite regularly is to have a separate coherence service that is responsible",
    "start": "1333440",
    "end": "1339960"
  },
  {
    "text": "for identifying and resolving when data may be in an inconsistent state it can",
    "start": "1339960",
    "end": "1345799"
  },
  {
    "text": "then choose to flag it for further inves ation or even Rectify known issues in an",
    "start": "1345799",
    "end": "1350840"
  },
  {
    "text": "automated fashion this pattern is super powerful",
    "start": "1350840",
    "end": "1356000"
  },
  {
    "text": "because it's continuously running in the background there's another option of running these coherence checks when",
    "start": "1356000",
    "end": "1362520"
  },
  {
    "text": "there is a user facing request but what we found is that this can cause delays in serving what might be a really",
    "start": "1362520",
    "end": "1368360"
  },
  {
    "text": "important RPC request especially if the correction is complex and even more so",
    "start": "1368360",
    "end": "1373799"
  },
  {
    "text": "when it requires human intervention the coherence pattern is",
    "start": "1373799",
    "end": "1379679"
  },
  {
    "text": "especially useful for the interaction between services and infrastructure for example we run some Kafka clusters and",
    "start": "1379679",
    "end": "1386840"
  },
  {
    "text": "provide libraries based on sarama which is a popular go library for interacting with Kafka to give us confidence in",
    "start": "1386840",
    "end": "1394400"
  },
  {
    "text": "changes to our libraries and the sarama library that we vendor in we can experiment with these coherent",
    "start": "1394400",
    "end": "1402240"
  },
  {
    "text": "Services we run these coherent services in both our staging and production environments continuous ly they use the",
    "start": "1402240",
    "end": "1409360"
  },
  {
    "text": "libraries just like any other microservice would at monzo and they are wired up to provide highquality signal",
    "start": "1409360",
    "end": "1416640"
  },
  {
    "text": "if things are looking ay we wire in assumptions that other teams may have made so that an accidental Library",
    "start": "1416640",
    "end": "1423559"
  },
  {
    "text": "change or a configuration change in Kafka itself can be identified before the impact spreads to more production",
    "start": "1423559",
    "end": "1432200"
  },
  {
    "text": "systems now a lot of this presentation has been about the technology and soft",
    "start": "1432679",
    "end": "1437840"
  },
  {
    "text": "soft ware and systems but a core part is the organizational aspect too you can",
    "start": "1437840",
    "end": "1443520"
  },
  {
    "text": "have the smartest Engineers but not be able to leverage them effectively because the engineers and managers are",
    "start": "1443520",
    "end": "1449600"
  },
  {
    "text": "not incentivized to push for investment in the upkeep of systems and",
    "start": "1449600",
    "end": "1454679"
  },
  {
    "text": "tolling when used correctly this investment can be a force multiplier in allowing Engineers to write systems",
    "start": "1454679",
    "end": "1461520"
  },
  {
    "text": "faster and to run them in a more reliable and efficient",
    "start": "1461520",
    "end": "1466799"
  },
  {
    "text": "manner earlier on I mentioned the concept of uniformity and the paved Road it's a",
    "start": "1466799",
    "end": "1473799"
  },
  {
    "text": "core reason why we haven't ended up with 2,500 a unmaintainable services that",
    "start": "1473799",
    "end": "1479720"
  },
  {
    "text": "look wildly different to each other an engineer needs to be able to jump into a",
    "start": "1479720",
    "end": "1485480"
  },
  {
    "text": "service and feel like they are familiar with the code structure and design patterns even if they are opening that",
    "start": "1485480",
    "end": "1491480"
  },
  {
    "text": "particular service for the first time this starts from day one for new",
    "start": "1491480",
    "end": "1497760"
  },
  {
    "text": "engineer am monzo we want to get them on the pave Road as soon as possible we",
    "start": "1497760",
    "end": "1503240"
  },
  {
    "text": "take Engineers through a series of documented steps on how we write and deploy code and provide a support",
    "start": "1503240",
    "end": "1509919"
  },
  {
    "text": "structure to ask all sorts of questions Engineers can rely on a wealth of shared",
    "start": "1509919",
    "end": "1516240"
  },
  {
    "text": "expertise there's also value in implicit documentation in all of the existing Services you can rely on numerous",
    "start": "1516240",
    "end": "1523840"
  },
  {
    "text": "examples of existing services that are running in production at scale which have demonstrated tried and tested",
    "start": "1523840",
    "end": "1530840"
  },
  {
    "text": "scale and design patterns in production we found on boarding to be",
    "start": "1530840",
    "end": "1536720"
  },
  {
    "text": "the perfect place to seed long-lasting behaviors ideas and Concepts it's much",
    "start": "1536720",
    "end": "1542200"
  },
  {
    "text": "harder to change bad behavior once someone has become used to it we spend a",
    "start": "1542200",
    "end": "1547720"
  },
  {
    "text": "lot of time curating our onboarding experience for engineers it's a continuous investment as tours and",
    "start": "1547720",
    "end": "1553919"
  },
  {
    "text": "processes change we even have a section called Legacy pattern p s highlighting patterns that may have been used in some",
    "start": "1553919",
    "end": "1560440"
  },
  {
    "text": "services but we avoid in newer Services whilst we try hard to use automated code",
    "start": "1560440",
    "end": "1566159"
  },
  {
    "text": "modification tools for smaller changes to bring all of our services up to scratch some larger changes may require",
    "start": "1566159",
    "end": "1572840"
  },
  {
    "text": "large human refactoring to conform to a new pattern and this takes time to",
    "start": "1572840",
    "end": "1579200"
  },
  {
    "text": "proliferate when we have a pattern of behavior that we want to completely disallow or there's a common Edge case",
    "start": "1580200",
    "end": "1586320"
  },
  {
    "text": "which has tripped up many engineers is we put it in a static analysis check this allows us to identify issues before",
    "start": "1586320",
    "end": "1593200"
  },
  {
    "text": "they get shipped before we make these checks mandatory and required we make sure to clean up the existing code base",
    "start": "1593200",
    "end": "1600279"
  },
  {
    "text": "so that Engineers are not tripped up by failing checks that may not be because of the code they explicitly modified",
    "start": "1600279",
    "end": "1607640"
  },
  {
    "text": "this means we get a high quality signal rather than Engineers just ignoring these checks the friction to bypass them",
    "start": "1607640",
    "end": "1615480"
  },
  {
    "text": "is very high intentionally to make make sure that the correct behavior is the path of least",
    "start": "1615480",
    "end": "1622519"
  },
  {
    "text": "resistance we have a channel called graph trending downwards where Engineers post optimizations they may have made an",
    "start": "1623039",
    "end": "1630760"
  },
  {
    "text": "example above is an optimization we found in our Kafka infrastructure we had a few thousand",
    "start": "1630760",
    "end": "1636720"
  },
  {
    "text": "metrics being scraped by the Kafka jmx Prometheus exporter this exporter is",
    "start": "1636720",
    "end": "1642679"
  },
  {
    "text": "embedded as a Java agent within the Kafka process and after a bit of profiling we found that it was taking a",
    "start": "1642679",
    "end": "1649080"
  },
  {
    "text": "ton of CPU time we made a few optimizations to the exporter and half",
    "start": "1649080",
    "end": "1654640"
  },
  {
    "text": "the amount of CPU that Kafka was using overall which massively improved our Kafka performance too we'll actually be",
    "start": "1654640",
    "end": "1661720"
  },
  {
    "text": "contributing this patch Upstream to the open source GMX exporter shortly so if you use the GMX exporter watch out for",
    "start": "1661720",
    "end": "1671000"
  },
  {
    "text": "that these post don't need to be systems related either and we also have graph",
    "start": "1671000",
    "end": "1676360"
  },
  {
    "text": "trending upwards it's a great place to highlight optimizations we may have made in reducing the number of human steps to",
    "start": "1676360",
    "end": "1683240"
  },
  {
    "text": "achieve something for example it's a great learning opportunity to explain how these optimizations were achieved",
    "start": "1683240",
    "end": "1691919"
  },
  {
    "text": "too in April 2018 TSB which is a High Street Bank here in the UK flipped the",
    "start": "1692039",
    "end": "1698519"
  },
  {
    "text": "lever on a migration project they'd been working on for three years to move customers to a completely new banking",
    "start": "1698519",
    "end": "1704760"
  },
  {
    "text": "platform the migration unfortunately did not not go smoothly and left a lot of customers without access to their money",
    "start": "1704760",
    "end": "1711080"
  },
  {
    "text": "for a long period of time TSB ended up with a 30 million fine",
    "start": "1711080",
    "end": "1716799"
  },
  {
    "text": "on top of the nearly 33 million compensation they had to pay to customers and the cost of reputational",
    "start": "1716799",
    "end": "1723159"
  },
  {
    "text": "damage too the report itself is a fascinating read and you can find it on fca.org",
    "start": "1723159",
    "end": "1730519"
  },
  {
    "text": "now the report talks about the technological aspects as you would see in any sort of postmortem but Focus",
    "start": "1730519",
    "end": "1737360"
  },
  {
    "text": "focuses heavily on the organizational aspects too for example overly ambitious",
    "start": "1737360",
    "end": "1742600"
  },
  {
    "text": "planning schedules compared to reality and things like testing and QA not",
    "start": "1742600",
    "end": "1747640"
  },
  {
    "text": "keeping up with the pace of development many of us here can probably attest to having some of these things in",
    "start": "1747640",
    "end": "1754640"
  },
  {
    "text": "our organizations it's easy for us to handwave and point blame on the",
    "start": "1754640",
    "end": "1760080"
  },
  {
    "text": "technological systems and software not meeting expectations or having bugs but much harder to reflect on the",
    "start": "1760080",
    "end": "1766480"
  },
  {
    "text": "organizational aspects that lead to these outcomes learning from incidents and",
    "start": "1766480",
    "end": "1772760"
  },
  {
    "text": "retrospecting on past projects is a force multiplier for example in July",
    "start": "1772760",
    "end": "1778720"
  },
  {
    "text": "2019 we had an incident where we misunderstood a configuration in Cassandra during a scaleup operation and",
    "start": "1778720",
    "end": "1786559"
  },
  {
    "text": "had to stop all rights and reach the cluster to remediator this was a dark day but set",
    "start": "1786559",
    "end": "1792640"
  },
  {
    "text": "of a chain reactions spanning multiple years to get operationally better at running running our database systems",
    "start": "1792640",
    "end": "1799440"
  },
  {
    "text": "we've made a ton of Investments since then on observability deepening our understanding of Cassandra itself and",
    "start": "1799440",
    "end": "1806240"
  },
  {
    "text": "become much more confident in all things operational through runbooks and practice in production and this isn't",
    "start": "1806240",
    "end": "1812960"
  },
  {
    "text": "just limited to Cassandra this is the same for all of our other production systems it went from a system that folks",
    "start": "1812960",
    "end": "1820080"
  },
  {
    "text": "poked from a distance to one that Engineers have become really confident with lots of Engineers internally REM",
    "start": "1820080",
    "end": "1827440"
  },
  {
    "text": "Mark about this incident even Engineers that have joined monzo recently not for the incident itself but the continuous",
    "start": "1827440",
    "end": "1833799"
  },
  {
    "text": "investment that we've put afterwards it isn't just a oneandone reactionary program of",
    "start": "1833799",
    "end": "1840960"
  },
  {
    "text": "work towards the beginning of the talk I talked about some of the Bold early",
    "start": "1840960",
    "end": "1846159"
  },
  {
    "text": "technological choices we made we knew we were early adopters and that things",
    "start": "1846159",
    "end": "1851559"
  },
  {
    "text": "wouldn't be magic and rainbows from day one we had to do a lot of experimenting",
    "start": "1851559",
    "end": "1857440"
  },
  {
    "text": "building and heads scratching over the past seven years and we continue to do so if your organization is not in a",
    "start": "1857440",
    "end": "1864840"
  },
  {
    "text": "position to give this level of investment and sympathy for complex systems that needs to factor into your",
    "start": "1864840",
    "end": "1871720"
  },
  {
    "text": "architectural and technological choices choosing microservices or kubernetes or",
    "start": "1871720",
    "end": "1877240"
  },
  {
    "text": "rust or wasm or whatever the hot new technology without the level of investment required to be an adopter",
    "start": "1877240",
    "end": "1884399"
  },
  {
    "text": "usually ends up in disaster in these cases it's better to choose simpler technology some may call",
    "start": "1884399",
    "end": "1891880"
  },
  {
    "text": "it boring but technology that is a known quantity to maximize your chance of",
    "start": "1891880",
    "end": "1898840"
  },
  {
    "text": "success in summary by standardizing on a small set of technological choices and",
    "start": "1899039",
    "end": "1904960"
  },
  {
    "text": "continuously improving these tools and abstractions we enable Engineers to focus on the business problem at hand",
    "start": "1904960",
    "end": "1911919"
  },
  {
    "text": "rather than the underlying infrastructure our teams are continuously improving our tools and",
    "start": "1911919",
    "end": "1917480"
  },
  {
    "text": "raising the level of abstraction which increases our leverage be very conscious",
    "start": "1917480",
    "end": "1923000"
  },
  {
    "text": "about when systems deviate from the paved Road it's fine if they do as long as it's intentional and for the right",
    "start": "1923000",
    "end": "1931240"
  },
  {
    "text": "reasons there's been a lot of discussion around the the role of platform teams",
    "start": "1931240",
    "end": "1936480"
  },
  {
    "text": "and their roles in organizations a lot of that focuses on infrastructure there's a ton of focus on things like",
    "start": "1936480",
    "end": "1943440"
  },
  {
    "text": "infrastructure as code and observability and automation and terraform and themes like that one",
    "start": "1943440",
    "end": "1950960"
  },
  {
    "text": "theme often not discussed is the bridge or interface between infrastructure and",
    "start": "1950960",
    "end": "1956039"
  },
  {
    "text": "the engineers building the software that runs on top Engineers shouldn't need to",
    "start": "1956039",
    "end": "1961480"
  },
  {
    "text": "be experts in everything that you provide you can abstract away core patterns behind a well-defined and",
    "start": "1961480",
    "end": "1968279"
  },
  {
    "text": "tested and documented and bespoke interface which will help save time and",
    "start": "1968279",
    "end": "1973399"
  },
  {
    "text": "help in the uniformity Mission and embrace best practices for your",
    "start": "1973399",
    "end": "1979320"
  },
  {
    "text": "organization this talk has contained quite a few examples of incidents we've had and others have experienced a key",
    "start": "1979799",
    "end": "1987720"
  },
  {
    "text": "theme is introspection incidents provide a unique chance to go out and find the",
    "start": "1987720",
    "end": "1993080"
  },
  {
    "text": "contributing factors many incidents have a technical underpinning like a bug being shipped to production or systems",
    "start": "1993080",
    "end": "2000320"
  },
  {
    "text": "running out of capacity but when you actually scratch the surface a little further see if there are organizational",
    "start": "2000320",
    "end": "2006320"
  },
  {
    "text": "Gremlins in this is often the best opportunity to surface team members feeling overwhelmed",
    "start": "2006320",
    "end": "2013159"
  },
  {
    "text": "or underinvestment in understanding and operating a critical system most",
    "start": "2013159",
    "end": "2018399"
  },
  {
    "text": "postmortem especially those that you read online are heavy on the technical details but don't really surface the",
    "start": "2018399",
    "end": "2025159"
  },
  {
    "text": "organizational component because it's hard to put that into context for Outsiders but internally it can provide",
    "start": "2025159",
    "end": "2031880"
  },
  {
    "text": "really valuable insight and lastly think about organ",
    "start": "2031880",
    "end": "2036919"
  },
  {
    "text": "organizational behaviors and incentives systems are not built and operated in a",
    "start": "2036919",
    "end": "2042480"
  },
  {
    "text": "vacuum do you monitor value and reward the operational stability speed security",
    "start": "2042480",
    "end": "2049638"
  },
  {
    "text": "and reliability of the software that you build and operate the behaviors you incentivize play a huge role in",
    "start": "2049639",
    "end": "2056280"
  },
  {
    "text": "determining the success or failure of your technical",
    "start": "2056280",
    "end": "2061319"
  },
  {
    "text": "architecture and with that thank you very much for listening and I hope you have a great day",
    "start": "2061760",
    "end": "2068878"
  },
  {
    "text": "[Music]",
    "start": "2071420",
    "end": "2076868"
  }
]