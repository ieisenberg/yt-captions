[
  {
    "start": "0",
    "end": "133000"
  },
  {
    "text": "so my talks give me a little less dense on the slides here we're gonna bring it down we're gonna she's gonna talk about",
    "start": "3930",
    "end": "9240"
  },
  {
    "text": "laundry all right everyone knows how to do laundry right we all know how it works right we get a big pile of clothes",
    "start": "9240",
    "end": "16260"
  },
  {
    "text": "are all over the place and you have to start folding them and you know you have different clothes right I got a family",
    "start": "16260",
    "end": "22109"
  },
  {
    "text": "of four so I have my my wife's clothes her pants I got kids socks all over the place you know and I",
    "start": "22109",
    "end": "31199"
  },
  {
    "text": "need a way of folding it and stuff so I have a certain way of folding it and then my spouse has a certain way of",
    "start": "31199",
    "end": "36990"
  },
  {
    "text": "folding it the way she goes about it is she folds which is great right you know everyone that's great that she's folding",
    "start": "36990",
    "end": "42930"
  },
  {
    "text": "laundry and I don't have to do it but what she's gonna do sorry is stack it",
    "start": "42930",
    "end": "49470"
  },
  {
    "text": "all up in a big pile right so every time you get a piece of laundry and you're folding it she just puts it into a pile",
    "start": "49470",
    "end": "55020"
  },
  {
    "text": "and then on goes the next one and you end up with a pile of you know some kid pants and some my shirt and to put it",
    "start": "55020",
    "end": "62520"
  },
  {
    "text": "all over the house you have to walk over the house no middlee I do appreciate the",
    "start": "62520",
    "end": "68160"
  },
  {
    "text": "exercise can't argue with that but you know parent we're busy we don't have time for that so I have a slightly",
    "start": "68160",
    "end": "73590"
  },
  {
    "text": "different way of doing it I take over the whole living room I'm talking the couch the coffee table the ottoman I",
    "start": "73590",
    "end": "81060"
  },
  {
    "text": "make separate piles for each kind of clothing right so kids pants kid number one pants kid number two pants something",
    "start": "81060",
    "end": "88080"
  },
  {
    "text": "like that I take over the whole living room then I can go around the house",
    "start": "88080",
    "end": "96290"
  },
  {
    "text": "putting my pants away my shirts away my kids pants away kids shirts away and it",
    "start": "96290",
    "end": "102120"
  },
  {
    "text": "goes really fast so what we're sort of doing here is making a space time compromise",
    "start": "102120",
    "end": "107280"
  },
  {
    "text": "it sounds like software but it's not it's t-shirts and pants and stuff like that right so I was able to use take the",
    "start": "107280",
    "end": "115049"
  },
  {
    "text": "same amount of time folding right it didn't take me like crazy long to fold the clothes I just put him I just took him more space and then I was able to",
    "start": "115049",
    "end": "121470"
  },
  {
    "text": "put them away I was able to save time so that's sort of this classic trade-off that we as architects have to sort of",
    "start": "121470",
    "end": "128580"
  },
  {
    "text": "think about right but what happens when you've 158 million",
    "start": "128580",
    "end": "135790"
  },
  {
    "start": "133000",
    "end": "203000"
  },
  {
    "text": "t-shirts that's last reported by Netflix we've 158 million memberships with the service",
    "start": "135790",
    "end": "143770"
  },
  {
    "text": "when I started eight years ago we had less than a million so this you can sort of get a sense of this growth and what",
    "start": "143770",
    "end": "149410"
  },
  {
    "text": "happens over time and how things aren't the same as they used to be it is not one monolith server we run in one little",
    "start": "149410",
    "end": "155650"
  },
  {
    "text": "data center it is the full-blown micro service architecture with tons of features with services calling services",
    "start": "155650",
    "end": "161830"
  },
  {
    "text": "calling services calling services I almost like to say at infant because it does feel like that sometimes that's a",
    "start": "161830",
    "end": "168730"
  },
  {
    "text": "lot more complex than a few servers there's a lot of servers and there's problems that come up when you have that",
    "start": "168730",
    "end": "175450"
  },
  {
    "text": "many servers and then a systems running altogether as you can imagine right",
    "start": "175450",
    "end": "181390"
  },
  {
    "text": "you might hear me say edge I mean hopefully you read the title the talk edges in there that means the edge of",
    "start": "181390",
    "end": "187990"
  },
  {
    "text": "this graph so for most people the far left here where it says edge I'm talking about sort of these four nodes over here",
    "start": "187990",
    "end": "193180"
  },
  {
    "text": "the edge when the data comes into the service there's a lot of other services going on here I'm just not generally talking about that I'm talking about",
    "start": "193180",
    "end": "199330"
  },
  {
    "text": "edge that's where I worked and where we saw the most scale when we talk about",
    "start": "199330",
    "end": "204910"
  },
  {
    "start": "203000",
    "end": "466000"
  },
  {
    "text": "that scale there's problems that's what I was alluding to and I also don't want to get to a little bit like debug",
    "start": "204910",
    "end": "210880"
  },
  {
    "text": "ability right so when you have a thousand servers you have a thousand logs that go through and there's no way",
    "start": "210880",
    "end": "216220"
  },
  {
    "text": "you're gonna go to every single machine and and look at the logs anymore that's just out that's not an option anymore",
    "start": "216220",
    "end": "221740"
  },
  {
    "text": "right debugging these problems becomes harder because a lot of problems can lurk in a thousand servers",
    "start": "221740",
    "end": "227250"
  },
  {
    "text": "infrastructure when you can keep some piece infrastructure in one box and",
    "start": "227250",
    "end": "232450"
  },
  {
    "text": "tracks everything that's great but as these number of servers is growing your deal with ten thousand since there's twenty thousand instances",
    "start": "232450",
    "end": "239670"
  },
  {
    "text": "it gets more difficult right things start to fall apart right and then the",
    "start": "239670",
    "end": "245170"
  },
  {
    "text": "third point there when the slides come back is managing until we subscribe to",
    "start": "245170",
    "end": "253540"
  },
  {
    "text": "DevOps I'm the developer I'm operating and I'm deploying it I now have to deploy a thousand instances now there's",
    "start": "253540",
    "end": "259000"
  },
  {
    "text": "automation around it but things just take longer now and I have to monitor more servers things just get harder",
    "start": "259000",
    "end": "265740"
  },
  {
    "text": "scale of one one projector also has problems apparently well see how this",
    "start": "266360",
    "end": "276150"
  },
  {
    "text": "goes this would be a very different talk",
    "start": "276150",
    "end": "280130"
  },
  {
    "text": "so on the topic scalability right so I sort of define it as not that is this",
    "start": "283050",
    "end": "291990"
  },
  {
    "text": "gonna take me a second it's sort of the ability to take more traffic than without noticeable degradation right",
    "start": "291990",
    "end": "299070"
  },
  {
    "text": "guys feel I should be able to take more traffic and not have the whole system sort of collapse",
    "start": "299070",
    "end": "305780"
  },
  {
    "text": "you know let's see how that goes it means I have problems that don't exist",
    "start": "308060",
    "end": "314070"
  },
  {
    "text": "on a smaller system but it also means that that I want to give myself some",
    "start": "314070",
    "end": "322680"
  },
  {
    "text": "Headroom right I don't need to design for 10x scale I just want to X I want to be able to failover to a region I want",
    "start": "322680",
    "end": "329010"
  },
  {
    "text": "some new feature to ship and not have the system sort of fall over that's all I'm talking about scalability and where",
    "start": "329010",
    "end": "334710"
  },
  {
    "text": "I'm coming to here I'm trying to give myself a little leeway here as I my system grows because you saw the system",
    "start": "334710",
    "end": "340890"
  },
  {
    "text": "is going to grow that's sort of a given now the way we do that are we make some",
    "start": "340890",
    "end": "346080"
  },
  {
    "text": "trade-offs right so we're architects here this is sort of what we do we look for a degree of freedom that we can move",
    "start": "346080",
    "end": "351300"
  },
  {
    "text": "around in to make this solution work without you know either costing lots of money or lots of servers or something",
    "start": "351300",
    "end": "357330"
  },
  {
    "text": "like that a classic trade-off here would be the cap theorem Netflix we have a service",
    "start": "357330",
    "end": "362670"
  },
  {
    "text": "discovery service called Eureka it's open source feel free to check it out it leans heavily on the a and the P",
    "start": "362670",
    "end": "369420"
  },
  {
    "text": "available and partition tolerant and the way it does that it takes all the instances is keeping track of and it",
    "start": "369420",
    "end": "375420"
  },
  {
    "text": "distributes it out over to all the other instances meaning if you get a partition it still knows about these instances in",
    "start": "375420",
    "end": "381840"
  },
  {
    "text": "general that's a trade-off right it also means that when you have 10,000 instances and you add one more you have",
    "start": "381840",
    "end": "388620"
  },
  {
    "text": "to go tell the other 10,000 about that one new one and that gets into the infrastructure side of things I'm going",
    "start": "388620",
    "end": "396330"
  },
  {
    "text": "to focus on sort of the architectural things that we can do as architects and not on the policy decisions if you have",
    "start": "396330",
    "end": "402720"
  },
  {
    "text": "a policy to keep data for six months and you turn it to three months that's less data that will cost you lost money go",
    "start": "402720",
    "end": "408420"
  },
  {
    "text": "for it save less money but that's not what I'm talking about that's not a that's a turning the dial kind of thing like just turning a dial down",
    "start": "408420",
    "end": "414280"
  },
  {
    "text": "super helpful now what I'm talking about I should say likewise if you run less",
    "start": "414280",
    "end": "421060"
  },
  {
    "text": "servers I say they'll be less problems don't run less servers just to run left servers don't run them hot we know that",
    "start": "421060",
    "end": "426370"
  },
  {
    "text": "we've learned that this is caused additional latency and that's not great either right I'm talking about being smart about this complexity as we",
    "start": "426370",
    "end": "433360"
  },
  {
    "text": "add it the things that I'm going to show I have some case stories I'm going to go",
    "start": "433360",
    "end": "439660"
  },
  {
    "text": "through each of them was implemented with one or two engineers over the course of a few weeks maybe a month ok",
    "start": "439660",
    "end": "445720"
  },
  {
    "text": "the number of person months here is pretty low I would say the total amount of work it's not a lot it's something I",
    "start": "445720",
    "end": "452080"
  },
  {
    "text": "think you guys could walk away with a little bit I would say that all the technology was used was generally off",
    "start": "452080",
    "end": "457810"
  },
  {
    "text": "the shelf this is not some academic paper you have to implement you should feel perfectly capable of implementing",
    "start": "457810",
    "end": "464230"
  },
  {
    "text": "the things that I'm gonna show here I'm going to go through five use cases today",
    "start": "464230",
    "end": "470080"
  },
  {
    "start": "466000",
    "end": "963000"
  },
  {
    "text": "okay I'm gonna focus a little more at the beginning and as I go on they're gonna get a little shorter and faster just so I can get through enough",
    "start": "470080",
    "end": "475810"
  },
  {
    "text": "material first one is how do you tell someone who is logged in how do you tell",
    "start": "475810",
    "end": "481750"
  },
  {
    "text": "if they're a member right that's pretty important where you're gonna show a very different website if someone is logged in or not or if their membership is is",
    "start": "481750",
    "end": "489430"
  },
  {
    "text": "active or not and you have to tell this on every request right this is a stateless system they're going to come",
    "start": "489430",
    "end": "494560"
  },
  {
    "text": "in through requests and other requests another quest you have to know if they're a member or not and you could say oh every question comes in a system",
    "start": "494560",
    "end": "501520"
  },
  {
    "text": "we just go to the database look it up no big deal it does become a big deal when",
    "start": "501520",
    "end": "506560"
  },
  {
    "text": "you're doing two million requests per second that is the scale that I'm talking about here there are databases",
    "start": "506560",
    "end": "511570"
  },
  {
    "text": "that scale like that I would like to avoid it that's my scalability message is that I want to give myself a lot more",
    "start": "511570",
    "end": "517089"
  },
  {
    "text": "leeway if I know how to put pressure on the database that's not so let's go back to what we have we have cookies that's",
    "start": "517089",
    "end": "523570"
  },
  {
    "text": "how most of our devices talk to Netflix the service that give us HTTP cookies these are long-lived cookies they sit on",
    "start": "523570",
    "end": "528970"
  },
  {
    "text": "your box for you know a year nine months but in there is a little expiration date",
    "start": "528970",
    "end": "534220"
  },
  {
    "text": "that we put in and this expiration date sir tells us how long we can trust the cookie right so if it comes into our",
    "start": "534220",
    "end": "539650"
  },
  {
    "text": "system and we crack it open and we look we can look this expiration that's the dot in the middle you see up here",
    "start": "539650",
    "end": "546149"
  },
  {
    "text": "if it has not expired we're just gonna trust it right this fits our business use case right and Netflix you know if",
    "start": "546149",
    "end": "552730"
  },
  {
    "text": "you're familiar with it you're gonna load it up and that maybe was the last time you used the service was last night so it's been eight hours",
    "start": "552730",
    "end": "559209"
  },
  {
    "text": "we're gonna need to go make sure you're still a member but after that we can give you a new cookie that's good for",
    "start": "559209",
    "end": "565149"
  },
  {
    "text": "eight hours for the rest of your TV watching binging for that night we can sort of trust that cookie and that fits",
    "start": "565149",
    "end": "571209"
  },
  {
    "text": "our use case if you remember at the beginning of the night you're probably a member at the end of the night works great let me just walk through how that",
    "start": "571209",
    "end": "579610"
  },
  {
    "text": "works because we're gonna turn up and not later what do you have here two layer seven proxy this would be sort of",
    "start": "579610",
    "end": "585850"
  },
  {
    "text": "equivalent to an alb nginx something like that in our case we're using Zuul it's another open-source project from",
    "start": "585850",
    "end": "591730"
  },
  {
    "text": "Netflix that you can use it lets us put custom logic in there so if you see me putting code in this box and you can't",
    "start": "591730",
    "end": "597699"
  },
  {
    "text": "or you have to write it in Lua or something that's what's going on here we're doing this in Zul cookies come in",
    "start": "597699",
    "end": "603399"
  },
  {
    "text": "crack it open and we see if it's expired it's not expired let it through if it is",
    "start": "603399",
    "end": "608529"
  },
  {
    "text": "expired we're gonna go to the server account service just you know look up hit the database see if they're still a",
    "start": "608529",
    "end": "613690"
  },
  {
    "text": "member sort of straightforward either way we're gonna send it down and once we have this refreshed answer if they",
    "start": "613690",
    "end": "618820"
  },
  {
    "text": "remember not we actually send out a new cookie that's good for eight hours and that buys us some time",
    "start": "618820",
    "end": "625140"
  },
  {
    "text": "the thing is that wasn't good enough all right so product management come back said no we want to log someone else",
    "start": "625140",
    "end": "630940"
  },
  {
    "text": "immediately right there's a lot of different use cases of this you might be on the phone as customer service saying",
    "start": "630940",
    "end": "636730"
  },
  {
    "text": "hey I see some weird activity I just want everyone logged out I don't want any activity on this maybe you've given",
    "start": "636730",
    "end": "642910"
  },
  {
    "text": "your account to your you know your college kid and they're watching some risque stuff and you just don't want to know about it's sign them out I don't",
    "start": "642910",
    "end": "649269"
  },
  {
    "text": "want to I want to go on right away so the business requirement now is we have to log them out instantaneously but we",
    "start": "649269",
    "end": "655449"
  },
  {
    "text": "don't want to hit the database that's what we're trying to save here so we came a system called melnitz and that",
    "start": "655449",
    "end": "660880"
  },
  {
    "text": "it's focused on that first eight hours so what I have to do now is identify who",
    "start": "660880",
    "end": "666130"
  },
  {
    "text": "has had activity on their account in that first eight hours and let the expiration thing take care of itself",
    "start": "666130",
    "end": "671800"
  },
  {
    "text": "right that's dumb we figured that out so let's focus on that first eight hours and you a set of customer IDs of who's",
    "start": "671800",
    "end": "677860"
  },
  {
    "text": "changed their account in the last day right 150 million members how many have really hit the sign out of all devices",
    "start": "677860",
    "end": "684260"
  },
  {
    "text": "button or call customer service it's a small number so here's our set thing is",
    "start": "684260",
    "end": "689330"
  },
  {
    "text": "it isn't that small and I have to get it out so there's two pieces to it so one I'm gonna get this set I'm gonna send it",
    "start": "689330",
    "end": "695060"
  },
  {
    "text": "out to my layer 7 proxies but let's talk with the size here all right this this goes a little bit to the scalability",
    "start": "695060",
    "end": "700910"
  },
  {
    "text": "thing if I just do this at a short cadence for requests per second that's",
    "start": "700910",
    "end": "706430"
  },
  {
    "text": "still a hundred and fifteen thousand entries I need to keep track of and it",
    "start": "706430",
    "end": "711710"
  },
  {
    "text": "may be more might be less depending on time of day stuff like that that's a lot of data to ship out to every single one",
    "start": "711710",
    "end": "716840"
  },
  {
    "text": "of our layer 7 proxies right there's thousands of them I don't want to ship that much data and I don't want to do it every minute which is what we're gonna",
    "start": "716840",
    "end": "722300"
  },
  {
    "text": "be doing so we introduced a bloom filter if you haven't heard of it",
    "start": "722300",
    "end": "728210"
  },
  {
    "text": "that's okay so let me talk about why it's okay first actually what it gives us is you can answer this question is",
    "start": "728210",
    "end": "733940"
  },
  {
    "text": "something possibly in a set the high degree of probability is it a bad",
    "start": "733940",
    "end": "740690"
  },
  {
    "text": "interview question what a bloom filter is yeah you shouldn't have to know about it would it does it feel like it's out of an academic paper yes yes it does",
    "start": "740690",
    "end": "747490"
  },
  {
    "text": "because it's sort of shown like this is it available in Wikipedia yes you can",
    "start": "747490",
    "end": "752900"
  },
  {
    "text": "read about it and that's where I want you to go for more detail so I'm not gonna get too much into it it's also sitting in a guava library so if your",
    "start": "752900",
    "end": "758720"
  },
  {
    "text": "Java developer it's sitting in guava and you can use it it's in ten different libraries and I promise you it's in your language of choice it's sort of easy to",
    "start": "758720",
    "end": "765560"
  },
  {
    "text": "use but what it's giving us is we could take this set of ID's XYZ and we splay it all over this sort of byte array and",
    "start": "765560",
    "end": "773410"
  },
  {
    "text": "this byte array is gonna take up a lot less space than those individual IDs now there's going to be some places where",
    "start": "773410",
    "end": "780560"
  },
  {
    "text": "they can flicked that's okay it's gonna happen to certain probability that we can tune and we turn it way down or way",
    "start": "780560",
    "end": "786950"
  },
  {
    "text": "up and whatever works so let's talk about how this sort of works in here same certainly run proxy same expired",
    "start": "786950",
    "end": "793760"
  },
  {
    "text": "logic but now if you're not expired we're gonna send you through this bloom filter and the way the bloom filter",
    "start": "793760",
    "end": "798830"
  },
  {
    "text": "works is you just it's a set you say is this thing in a set that's the only thing we're trying to answer it says yes",
    "start": "798830",
    "end": "804320"
  },
  {
    "text": "or maybe all right sorry no or maybe in the no case just flow it through and that is the 99.99% of all requests but",
    "start": "804320",
    "end": "811940"
  },
  {
    "text": "for that small 0.01 percent of the time we get a maybe answer we go to the account service we",
    "start": "811940",
    "end": "818060"
  },
  {
    "text": "look it up so this means we're actually hitting the database a little bit more but not much this is very reasonable",
    "start": "818060",
    "end": "824150"
  },
  {
    "text": "it means I'll get into why I'm gonna",
    "start": "824150",
    "end": "829940"
  },
  {
    "text": "talk about how I set it up I'm not gonna go as much detail in the other use cases but I think this is really relevant so much to show how accessible this is we",
    "start": "829940",
    "end": "837530"
  },
  {
    "text": "had an account service right that are existed can't this isn't work without an account service it was already sending events out over some sort of Kafka like",
    "start": "837530",
    "end": "844460"
  },
  {
    "text": "stream so this already existed for us who wrote a service that just listened to events and then saved in the database",
    "start": "844460",
    "end": "850040"
  },
  {
    "text": "it's like you know things go right this is like five lines of code this is pretty simple straightforward we then",
    "start": "850040",
    "end": "856160"
  },
  {
    "text": "read from this database every five every one minute say give me all the entries",
    "start": "856160",
    "end": "862400"
  },
  {
    "text": "for last eight hours we put that into the bloom filter and we ship it out we ship it out using a pub/sub system now",
    "start": "862400",
    "end": "868490"
  },
  {
    "text": "we have one internally it's not open sourced but there are other ones available right so Apache has one that",
    "start": "868490",
    "end": "874640"
  },
  {
    "text": "came out of Yahoo which is very similar the one that we have Redis has a pub/sub Google Offers one pub/sub is generally",
    "start": "874640",
    "end": "880220"
  },
  {
    "text": "available and we just sort of throw it out there here's the new list of all the",
    "start": "880220",
    "end": "885320"
  },
  {
    "text": "customer IDs in the last eight hours who might have changed their account and now it's on our layer seven proxy so we now",
    "start": "885320",
    "end": "892940"
  },
  {
    "text": "have this sort of near real-time data set we can look at to log people out",
    "start": "892940",
    "end": "898880"
  },
  {
    "text": "we haven't increased the amount of calls to the database so that was sort of one of our goals here we're pretty happy",
    "start": "898880",
    "end": "904670"
  },
  {
    "text": "with it but we did have to make some trade-offs all right so one there's now a probabilistic data structure in there",
    "start": "904670",
    "end": "910220"
  },
  {
    "text": "that I trust you every new employee that joins a team is gonna have to go to Wikipedia and read up on it it is a library you do get to call you should",
    "start": "910220",
    "end": "916490"
  },
  {
    "text": "understand what's going on so we've sir treated a little more code complexity to get this herd of neat space savings I'd",
    "start": "916490",
    "end": "924740"
  },
  {
    "text": "also say that off-the-shelf components right we could have sent those events from the auth service the one that's doing this account stuff straight to the",
    "start": "924740",
    "end": "931430"
  },
  {
    "text": "layer seven servers those proxies that would work that would be like",
    "start": "931430",
    "end": "936710"
  },
  {
    "text": "instantaneous right you get it but there's a lot of problems it could happen there and we could handcraft it but we can also just use off-the-shelf",
    "start": "936710",
    "end": "942680"
  },
  {
    "text": "components right I use off-the-shelf Kafka and sub and I wrote a service that's like",
    "start": "942680",
    "end": "947809"
  },
  {
    "text": "five lines of code or two services that's five lines of code that was worth it I was much more willing to have two",
    "start": "947809",
    "end": "953059"
  },
  {
    "text": "simple services than try and take my account service which is super important with my letters from proxy which is",
    "start": "953059",
    "end": "958249"
  },
  {
    "text": "super important and put a whole bunch of complicated code in there so that's the trade off I started made here okay so",
    "start": "958249",
    "end": "964249"
  },
  {
    "start": "963000",
    "end": "1226000"
  },
  {
    "text": "that was the first use case and you go through four more we're gonna talk about",
    "start": "964249",
    "end": "969550"
  },
  {
    "text": "the needle in the haystack kind of problem right I talked about how we have a thousand servers and you're trying to",
    "start": "969550",
    "end": "974809"
  },
  {
    "text": "find a login there how do you find it how do you find this problem and we need to solve this all the time right this is",
    "start": "974809",
    "end": "981860"
  },
  {
    "text": "just a classic debugging kind of thing you gotta find an error message now if I do this that that pre-stated two million",
    "start": "981860",
    "end": "987860"
  },
  {
    "text": "requests per second and let's just say every request with some metadata is about three kilobytes and I you know I",
    "start": "987860",
    "end": "994819"
  },
  {
    "text": "showed you that graph this gets they're gonna call other micro services we want to record all those you multiply that",
    "start": "994819",
    "end": "1000100"
  },
  {
    "text": "out that's 4.6 petabytes a day now you can do that you can put that in elasticsearch I trust you there's a log",
    "start": "1000100",
    "end": "1005949"
  },
  {
    "text": "company out there is willing to take your check and put that store all this I'd like to avoid that so let me just",
    "start": "1005949",
    "end": "1013480"
  },
  {
    "text": "start with the basic architecture the pictures you have a service it's publishing all these events all these",
    "start": "1013480",
    "end": "1019779"
  },
  {
    "text": "logs and let's say we put into a lastest search you can search for it for those who can't see in the back there's a thick red line between the service any",
    "start": "1019779",
    "end": "1026168"
  },
  {
    "text": "lasted search and a thin line to let's say kibana your UI over but you have to load all the stuff into elastic search",
    "start": "1026169",
    "end": "1031480"
  },
  {
    "text": "and I don't want to put that 4.6 petabytes in their incomes mantis",
    "start": "1031480",
    "end": "1038260"
  },
  {
    "text": "I recently open-source tool from Netflix that we've been using internally for a while and I absolutely love it and I think you will too afterwards it gives",
    "start": "1038260",
    "end": "1046329"
  },
  {
    "text": "us it is a vent stream processing it is not specific to logs it's there for events and it's going to give us two big",
    "start": "1046329",
    "end": "1054309"
  },
  {
    "text": "constructs it is going to put an agent in your service okay this is a local agent that you run that",
    "start": "1054309",
    "end": "1059740"
  },
  {
    "text": "you serve give it the event and it is responsible for getting that event out of your box so think of it as a for every request",
    "start": "1059740",
    "end": "1065409"
  },
  {
    "text": "that comes in we create an event that would be our equivalent of a log and it's guys send it to a man to source job",
    "start": "1065409",
    "end": "1071529"
  },
  {
    "text": "so it has a cluster that's dedicated to receiving these events and sending it on",
    "start": "1071529",
    "end": "1076990"
  },
  {
    "text": "to somewhere else know I've drawn it with really thick lines because I've been told you anything else about why this makes it special the thing that makes it serve",
    "start": "1076990",
    "end": "1083470"
  },
  {
    "text": "special is that mantis has a query language okay mql mantis query language pretty obvious so you can write this",
    "start": "1083470",
    "end": "1090520"
  },
  {
    "text": "query you can say show me all the people in Brazil watching episode 3 of stranger",
    "start": "1090520",
    "end": "1096940"
  },
  {
    "text": "things on an iPad right super specific that that's a select statement right there were some where clauses I will get loaded into the",
    "start": "1096940",
    "end": "1104590"
  },
  {
    "text": "source job and it's only gonna allow things that match that filter to go out",
    "start": "1104590",
    "end": "1109630"
  },
  {
    "text": "so now we're talking about what's going to last they search us a lot smaller so for the people in the back there's a",
    "start": "1109630",
    "end": "1114820"
  },
  {
    "text": "thin red line now going to elasticsearch there's a trickle of data only those people in Brazil on an iPad watching episode 3 Oh stranger things what gets a",
    "start": "1114820",
    "end": "1122110"
  },
  {
    "text": "little bit better of mantas is it takes at MQL and pumps it down to all the agents so you might have a thousand",
    "start": "1122110",
    "end": "1127660"
  },
  {
    "text": "service 10,000 rows five that query is gonna go down to the agent he's gonna run the pre-filter and only send off box",
    "start": "1127660",
    "end": "1134280"
  },
  {
    "text": "those messages and that is a trickle of events okay I can get extremely specific",
    "start": "1134280",
    "end": "1139720"
  },
  {
    "text": "tracking I can see these requests come in live they have sort of a browser sort of plugin where you can watch this",
    "start": "1139720",
    "end": "1145360"
  },
  {
    "text": "stream I'm getting it live no huge overhead I'm not storing tons of data here this is what sort of makes me I",
    "start": "1145360",
    "end": "1151690"
  },
  {
    "text": "just sort of a big win for us and the thing that it does is avoid work right",
    "start": "1151690",
    "end": "1157000"
  },
  {
    "text": "we're not shipping all this data off box right we had to sort of put an agent in our box but we've put a whole lot of",
    "start": "1157000",
    "end": "1164770"
  },
  {
    "text": "work a lot of network traffic going on here and I'd say those are the two pieces here I'll start with skilled",
    "start": "1164770",
    "end": "1170799"
  },
  {
    "text": "skills from zero sort of solution here I can have this thing on all night",
    "start": "1170799",
    "end": "1176350"
  },
  {
    "text": "it's only gonna match those iPads in Brazil that's awesome I could leave it on all month no big deal",
    "start": "1176350",
    "end": "1181990"
  },
  {
    "text": "I can go home at night i'ma turn everything off and there's no additional impact to the system so the trade-off",
    "start": "1181990",
    "end": "1187540"
  },
  {
    "text": "here is yeah I don't have long-term historical data here but I do get a really easy way of starting up a new",
    "start": "1187540",
    "end": "1192940"
  },
  {
    "text": "query I don't care about the cost because it's gonna be so optimally efficient to what I am looking for that's the trade off the other trade off",
    "start": "1192940",
    "end": "1200260"
  },
  {
    "text": "is this mantas query language right I had to put an agent in my box there's something in my runtime now they control",
    "start": "1200260",
    "end": "1206049"
  },
  {
    "text": "it if I want to get more complicated and it's not part of the query language I can't do it but this is something where",
    "start": "1206049",
    "end": "1211330"
  },
  {
    "text": "I'm willing to hand it off to them I try this team to put code in my box I trust this team to enhance this query language",
    "start": "1211330",
    "end": "1217790"
  },
  {
    "text": "over time I mean I couldn't put custom code in my box but I couldn't put that custom code in all the boxes and so I'm",
    "start": "1217790",
    "end": "1224570"
  },
  {
    "text": "willing to make the trade-off okay so that was two case stories let's talk about the third one this one is a little",
    "start": "1224570",
    "end": "1232040"
  },
  {
    "start": "1226000",
    "end": "1515000"
  },
  {
    "text": "specific to when you have extremely common data for your requests so let me",
    "start": "1232040",
    "end": "1237680"
  },
  {
    "text": "explain that a little bit membership that's a common one or user preference",
    "start": "1237680",
    "end": "1242870"
  },
  {
    "text": "so let's say they are a premium member and you will always give them a little bit more data on every request okay so",
    "start": "1242870",
    "end": "1249260"
  },
  {
    "text": "every quest comes in your box based on the membership maybe you do something different something for Netflix an equivalent might be",
    "start": "1249260",
    "end": "1255110"
  },
  {
    "text": "membership levels right there's a for stream enough to stream and a for stream knowing if it's a one stream or for",
    "start": "1255110",
    "end": "1260540"
  },
  {
    "text": "stream helps us change our behavior a little bit so this is important data for",
    "start": "1260540",
    "end": "1266120"
  },
  {
    "text": "us and but you might have more important data for a user preference or something like that so super common data you can",
    "start": "1266120",
    "end": "1272990"
  },
  {
    "text": "imagine how you load it right request comes to the system gets loaded into API he requests the service plan from the",
    "start": "1272990",
    "end": "1278600"
  },
  {
    "text": "database call goes to mid tier he requests call goes to metier P he requests it goes to me to Serie C she",
    "start": "1278600",
    "end": "1285830"
  },
  {
    "text": "requests that okay we got all a bunch of requests coming out of the database one request in four requests the database this is sort of that kind of scalability",
    "start": "1285830",
    "end": "1292550"
  },
  {
    "text": "thing I'm trying to avoid a little bit so let me layer in one thing we have this thing called passports now we",
    "start": "1292550",
    "end": "1298430"
  },
  {
    "text": "introduced this for identity it tells you who this calls made on behalf of and we do this right at this first layer",
    "start": "1298430",
    "end": "1304340"
  },
  {
    "text": "seven proxy we figure out who is this customer and and sort of what is their customer ID that kind of stuff and we",
    "start": "1304340",
    "end": "1311840"
  },
  {
    "text": "were passing it through our system we're gonna make a change here we're gonna actually take this very common data and",
    "start": "1311840",
    "end": "1318080"
  },
  {
    "text": "we're gonna load up right at the beginning we're gonna shove it into this passport and have it passed down so now",
    "start": "1318080",
    "end": "1324950"
  },
  {
    "text": "one request comes in and one request to the database so we've actually got a much more linear scaling so this is",
    "start": "1324950",
    "end": "1331250"
  },
  {
    "text": "important to us everybody along the way doesn't have to make a database request so now there's actually it's a little",
    "start": "1331250",
    "end": "1336470"
  },
  {
    "text": "bit faster he doesn't have to request it he's getting handed this this data structure now you should all be thinking",
    "start": "1336470",
    "end": "1344180"
  },
  {
    "text": "from the keynote hey but what if you write to it you some consistency here right this is the nonlinear eyes ability that he was",
    "start": "1344180",
    "end": "1350430"
  },
  {
    "text": "talking about if mid-tier be long the way changes the plan right you're the process of you change the plan and now",
    "start": "1350430",
    "end": "1356340"
  },
  {
    "text": "you want to render something for them you want to consistent experience across them and if mid-tier be here I've shown",
    "start": "1356340",
    "end": "1362370"
  },
  {
    "text": "in maroon on the right-hand side here is right into the database and then a request goes to the mid-tier see he's",
    "start": "1362370",
    "end": "1367680"
  },
  {
    "text": "still going to see the blue dots the blue membership that to be our inconsistent experience right if these",
    "start": "1367680",
    "end": "1372750"
  },
  {
    "text": "are eventual consistent databases and we want to do better right we don't want poram on this database we don't want to",
    "start": "1372750",
    "end": "1379080"
  },
  {
    "text": "go through all the troubles you saw in the keynote to try and give a consistent experience well it turns out the",
    "start": "1379080",
    "end": "1384630"
  },
  {
    "text": "password is this contract where if you are changing the passport you have to send it back up okay what that means is",
    "start": "1384630",
    "end": "1391050"
  },
  {
    "text": "when mid-tier B is making a change he's going to create a new passport with this new data send it back up to a a is now",
    "start": "1391050",
    "end": "1398610"
  },
  {
    "text": "responsible for using that data when it calls mid-tier see now i'm mid-tier c is",
    "start": "1398610",
    "end": "1404160"
  },
  {
    "text": "getting a consistent experience irrelevant of the state of the database you know he might get back to you next week it might be made out of pigeons who",
    "start": "1404160",
    "end": "1409740"
  },
  {
    "text": "knows it's going to come later what's not shown in the slide is that passport is actually passed up to api and up to",
    "start": "1409740",
    "end": "1416490"
  },
  {
    "text": "Elson proxy and he can do something right he could update your cookies with this new data or some aspect to this",
    "start": "1416490",
    "end": "1421740"
  },
  {
    "text": "data and it doesn't have to be the full data right we can make a reference to an",
    "start": "1421740",
    "end": "1427800"
  },
  {
    "text": "immutable data object right so we don't need the full object going around but the key is we're passing this data up",
    "start": "1427800",
    "end": "1433080"
  },
  {
    "text": "and down to this service stream so we",
    "start": "1433080",
    "end": "1438420"
  },
  {
    "text": "made like this small change where we're sort of passing around some more heavy data and we did have to put something in the layers of and proxy but now we get",
    "start": "1438420",
    "end": "1444990"
  },
  {
    "text": "this crate experience where we can get some consistent experience now this is near the land of caching I get that if",
    "start": "1444990",
    "end": "1451770"
  },
  {
    "text": "you need to cache things usually cache it this is only applicable if you're going to at the first entry point you'd",
    "start": "1451770",
    "end": "1457200"
  },
  {
    "text": "be willing to look it up so use caching if you need to this is a little bit of unique use case we've got it via two",
    "start": "1457200",
    "end": "1466410"
  },
  {
    "text": "trade-offs right so one is data passing we had to sort of move past I am isolated mid-tier micro service and",
    "start": "1466410",
    "end": "1474600"
  },
  {
    "text": "I will call this other micro service and we will not share any state well I'm saying let's make that that's",
    "start": "1474600",
    "end": "1479880"
  },
  {
    "text": "switch that up let's put a little extra data on the wire right yeah it's nice to keep your requests small but if I grow",
    "start": "1479880",
    "end": "1485460"
  },
  {
    "text": "my request size by one or two K it's not going to take down the network I always die haven't taken down the network yet",
    "start": "1485460",
    "end": "1491210"
  },
  {
    "text": "the other thing here's a heavier data structure right I'm not just passing along you know like a 64-bit int through",
    "start": "1491210",
    "end": "1498660"
  },
  {
    "text": "my system I have made a heavier data structure all the people in the system they'll have to understand this passport they need to know how to read it some of",
    "start": "1498660",
    "end": "1504930"
  },
  {
    "text": "them need to know how to change it that's a trade-off right now I need to coordinate a lot more teams but I'm",
    "start": "1504930",
    "end": "1510150"
  },
  {
    "text": "willing to make that trade-off to get this sort of consistent database request okay that's three let's go on to the",
    "start": "1510150",
    "end": "1519000"
  },
  {
    "start": "1515000",
    "end": "1802000"
  },
  {
    "text": "fourth one device types so Netflix you",
    "start": "1519000",
    "end": "1524040"
  },
  {
    "text": "can watch on many different types devices over 2000 different devices you can watch on we have learned that it is",
    "start": "1524040",
    "end": "1530370"
  },
  {
    "text": "useful to categorize these devices and not just individual devices right my app iPad versus your iPad but like all iPads",
    "start": "1530370",
    "end": "1537510"
  },
  {
    "text": "and all old iPads and new iPads we want to group these things together and it",
    "start": "1537510",
    "end": "1543330"
  },
  {
    "text": "sort of looks like this the numbers are important all you need to know there's some gobbledygook on the Left we have to convert it to some useful number on the",
    "start": "1543330",
    "end": "1550080"
  },
  {
    "text": "right that's what this service is doing for us and let me make it really clear why it's important to us this is an",
    "start": "1550080",
    "end": "1556440"
  },
  {
    "text": "error metric a real one taken from like yesterday something is going on I don't",
    "start": "1556440",
    "end": "1561570"
  },
  {
    "text": "know what device is doing it and to my point earlier when something goes bad it goes bad for all types of devices so if",
    "start": "1561570",
    "end": "1567270"
  },
  {
    "text": "it's for Android devices which it turned out to be Android you can see real",
    "start": "1567270",
    "end": "1573510"
  },
  {
    "text": "quickly a bulk of this is Android right because I grouped these things together okay this grouping is really important",
    "start": "1573510",
    "end": "1579270"
  },
  {
    "text": "for telemetry we need this to debug issues in production so this is we're gonna consider critical data we need to",
    "start": "1579270",
    "end": "1585480"
  },
  {
    "text": "have available to us it's also considered ridiculously cashable okay this doesn't change very much keep that",
    "start": "1585480",
    "end": "1593190"
  },
  {
    "text": "in mind when I joined the team every mid tier service would call this DTS service",
    "start": "1593190",
    "end": "1599430"
  },
  {
    "text": "and say do anything new do you think anything new yeah I think and what he'd reply he'd give you a hundred megabytes",
    "start": "1599430",
    "end": "1605100"
  },
  {
    "text": "of XML somewhere in there they felt like",
    "start": "1605100",
    "end": "1610590"
  },
  {
    "text": "let's put a backup system in case D just gets you know Falls / what you could do because everybody is asking for 100 megabytes of XML they put",
    "start": "1610590",
    "end": "1618630"
  },
  {
    "text": "in a pub sub system as a backup say hey if there's a change we'll just push it out over the pub sub system",
    "start": "1618630",
    "end": "1623850"
  },
  {
    "text": "well like it didn't take long to realise the backup was better than the real thing so we searched throughout the real thing use the backup and what it did is",
    "start": "1623850",
    "end": "1630840"
  },
  {
    "text": "let us take DTS out of the critical path right if DTS isn't around no big deal we have this pub subsystem that is managed",
    "start": "1630840",
    "end": "1637410"
  },
  {
    "text": "by another team it's rock-solid it is infrastructure from our point of view and it pushes out what was 100 megabytes",
    "start": "1637410",
    "end": "1644670"
  },
  {
    "text": "of XML we did better we moved the proto we compressed it I got better but the pub sub was the big thing but even there",
    "start": "1644670",
    "end": "1651690"
  },
  {
    "text": "we start to look a little bit deeper and realise well what is this data what's the real business requirement how fast do I really need to get these updates",
    "start": "1651690",
    "end": "1657900"
  },
  {
    "text": "out well it didn't take long you start asking them or like well when does new data flow in oh yeah it flows in all the",
    "start": "1657900",
    "end": "1663330"
  },
  {
    "text": "time and we should see results ok well what's this data well this data is someone in China wants to add create a",
    "start": "1663330",
    "end": "1672150"
  },
  {
    "text": "new TV they tell Netflix about it they want to go through it certification so in March they tell us about a new kind",
    "start": "1672150",
    "end": "1677220"
  },
  {
    "text": "of TV they start the certification process they eventually build the TVs they",
    "start": "1677220",
    "end": "1682530"
  },
  {
    "text": "certify the Netflix app on it it shows up at Best Buy and then you buy it ok that's like March to December that's",
    "start": "1682530",
    "end": "1690000"
  },
  {
    "text": "like nine month lag before we see this device in production this data could be nine months stale and no one's really",
    "start": "1690000",
    "end": "1696270"
  },
  {
    "text": "gonna know about it ok that took a little bit of five why's we like why do you need this data why do you need this",
    "start": "1696270",
    "end": "1701760"
  },
  {
    "text": "data well turns out they didn't need it for nine months so we start to actually embed it in the jar all right to beat a",
    "start": "1701760",
    "end": "1707520"
  },
  {
    "text": "client library we'd ship it out and we just put like old data whatever the data of the day",
    "start": "1707520",
    "end": "1713310"
  },
  {
    "text": "was in there and we've compressed it small enough at this point that it really wasn't a big overhead and so now actually the data lives in the jar and",
    "start": "1713310",
    "end": "1720150"
  },
  {
    "text": "you can still use pups of it you can pump out updates but if pub/sub goes down this highly critical data is",
    "start": "1720150",
    "end": "1725610"
  },
  {
    "text": "available to everybody it might be old might be nine months old but that's fine",
    "start": "1725610",
    "end": "1732020"
  },
  {
    "text": "along the way we try to whole bunch of other things like all will send incremental updates like we were getting really fancy but it was getting really",
    "start": "1732020",
    "end": "1737940"
  },
  {
    "text": "compacts I'd much rather simple over easy in this case so we just sort of ditched all",
    "start": "1737940",
    "end": "1743310"
  },
  {
    "text": "those plans and just just put in the jar you're done so the sort of two trade-offs we're",
    "start": "1743310",
    "end": "1748440"
  },
  {
    "text": "talking about here so when is business tuned fallbacks this is like really going back to the business and asking",
    "start": "1748440",
    "end": "1753930"
  },
  {
    "text": "exactly what do you need what do you need right if we're going to be architects and we're looking for that freedom of moving things around we",
    "start": "1753930",
    "end": "1759750"
  },
  {
    "text": "really do need to know what they're really asking for because if they ask for something real-time if you go back",
    "start": "1759750",
    "end": "1764880"
  },
  {
    "text": "to the log all the users out example earlier they were like real-time didn't take long to say real-time is like",
    "start": "1764880",
    "end": "1771780"
  },
  {
    "text": "within 10 minutes it's a very different definition of real-time likewise leverage existing",
    "start": "1771780",
    "end": "1777540"
  },
  {
    "text": "infrastructure right so one was the pub/sub piece which is still important you do like to get updates out if you",
    "start": "1777540",
    "end": "1782730"
  },
  {
    "text": "are testing internally or something like that but I'd much rather use that existing",
    "start": "1782730",
    "end": "1788370"
  },
  {
    "text": "infrastructure whenever possible that have my own service where I can tune it change it immediately I will use",
    "start": "1788370",
    "end": "1795090"
  },
  {
    "text": "existing infrastructure that is the trade-off we made and we're very happy with not having to get paged for a data",
    "start": "1795090",
    "end": "1800460"
  },
  {
    "text": "service so that is for use cases let's",
    "start": "1800460",
    "end": "1805650"
  },
  {
    "start": "1802000",
    "end": "1843000"
  },
  {
    "text": "talk a little bit about charting there's different definitions of this I'm gonna",
    "start": "1805650",
    "end": "1811170"
  },
  {
    "text": "give one out there and this is sort of runtime refactoring right if you can imagine refactoring your code you might",
    "start": "1811170",
    "end": "1819390"
  },
  {
    "text": "hopefully not change your tests all right you change your code test stay the same you've just moved things around",
    "start": "1819390",
    "end": "1825060"
  },
  {
    "text": "functionally it is the same thing I'm talking about this at a runtime level I'm going to take my runtime system and",
    "start": "1825060",
    "end": "1830520"
  },
  {
    "text": "I'm gonna sort of move things around but it still does the same functionality okay that's that's what I mean by sort",
    "start": "1830520",
    "end": "1836220"
  },
  {
    "text": "of charting it or taking chunks of code and moving around in this context I'm",
    "start": "1836220",
    "end": "1846510"
  },
  {
    "start": "1843000",
    "end": "2036000"
  },
  {
    "text": "gonna make reference to a message security layer that is literally the name you could find it on github it's",
    "start": "1846510",
    "end": "1852390"
  },
  {
    "text": "another open source project from Netflix it's shortened to MSL I will pronounce it as missile it is a secure messaging",
    "start": "1852390",
    "end": "1859230"
  },
  {
    "text": "framework right so it has encryption and authenticity and replay protection and stuff like that it's like TLS that's",
    "start": "1859230",
    "end": "1865770"
  },
  {
    "text": "probably the best equivalent I can give you in our case it has some additional business things that it gives us that we want from our business but think of it",
    "start": "1865770",
    "end": "1871860"
  },
  {
    "text": "like a TLS but unlike TLS you can't just go to Amazon and say give me a load balancer of those supports missile you",
    "start": "1871860",
    "end": "1879210"
  },
  {
    "text": "can't terminate at the load-balancing so we're gonna terminate at API right so same sort architecture right we're on the",
    "start": "1879210",
    "end": "1884970"
  },
  {
    "text": "edge we've got a layer seven proxy sending traffic to that the first level and this API service is doing a lot of",
    "start": "1884970",
    "end": "1891270"
  },
  {
    "text": "things so it's going to terminate the security layer just gonna run some groovy scripts because that's just how it works it's gonna have clients for",
    "start": "1891270",
    "end": "1898950"
  },
  {
    "text": "everything else in the system right you saw that diagram it's it spreads out really fast so this API service is going",
    "start": "1898950",
    "end": "1906419"
  },
  {
    "text": "to have client libraries for everybody out there it's a beast of a machine it's doing lots of things and one of the",
    "start": "1906419",
    "end": "1912030"
  },
  {
    "text": "things was missile and we had our code and we had to get it in here and we sort of wanted to get it out so that's what we're gonna do so we refactored it",
    "start": "1912030",
    "end": "1919250"
  },
  {
    "text": "charted it and took that logic out and put into its own service okay",
    "start": "1919250",
    "end": "1924360"
  },
  {
    "text": "now you can't entirely put it off to its own service in our case we have to put a small little piece in the l7 proxy right",
    "start": "1924360",
    "end": "1930630"
  },
  {
    "text": "it is a security layer but it's also an encryption we just need to decrypt it encrypted so we keep those simple",
    "start": "1930630",
    "end": "1935730"
  },
  {
    "text": "operations up at the lair seven proxy alright that of the functionality of missile we're talking about here",
    "start": "1935730",
    "end": "1941190"
  },
  {
    "text": "there's the encrypt decrypt we're gonna leave that at bail seven proxy and then the more complicated pieces already",
    "start": "1941190",
    "end": "1947610"
  },
  {
    "text": "forget do key exchange we have to authenticate devices that we're going to sort of move off to its own service right does all the same stuff we've just",
    "start": "1947610",
    "end": "1954450"
  },
  {
    "text": "moved things around we were doing this for our own operational benefits like we",
    "start": "1954450",
    "end": "1961710"
  },
  {
    "text": "didn't think much would change but then people like you must have messed up look what happened to our CPU went way down people must not be calling us well turns",
    "start": "1961710",
    "end": "1969270"
  },
  {
    "text": "out it just got cheaper to run API it took less CPU to run API and like we",
    "start": "1969270",
    "end": "1974460"
  },
  {
    "text": "sort of anticipated this but we did not expect a drop like 31% drop like whoa",
    "start": "1974460",
    "end": "1979799"
  },
  {
    "text": "we'll take it right these are free right right off the bat you guys that's stretch to be enough fine presentation",
    "start": "1979799",
    "end": "1985140"
  },
  {
    "text": "over you should refactor your code but then we saw it in latency oh that's interesting it's always better to get",
    "start": "1985140",
    "end": "1991260"
  },
  {
    "text": "better latency but there isn't huge overhead to him the encrypt decrypt or if it was he doesn't account for this much of a change right a 30% decrease in",
    "start": "1991260",
    "end": "1999000"
  },
  {
    "text": "average and 29% of p99 okay if you can get a p99 reduction that's awesome we were really",
    "start": "1999000",
    "end": "2005840"
  },
  {
    "text": "happy about that but when you look at Lee and see doesn't take long to start looking at garbage collection and that's",
    "start": "2005840",
    "end": "2011840"
  },
  {
    "text": "what we looked at and we found the drop okay the only reason you sort of see like a delay here is that we were",
    "start": "2011840",
    "end": "2017090"
  },
  {
    "text": "just doing like a slow rollout of the future the top I know there's no axes",
    "start": "2017090",
    "end": "2022190"
  },
  {
    "text": "here is a non-trivial number like hundreds of milliseconds if not seconds down to what we consider zero okay it",
    "start": "2022190",
    "end": "2029840"
  },
  {
    "text": "got a lot better the amount of time we spent in garbage collection which is what gave us the latency which gave us",
    "start": "2029840",
    "end": "2034970"
  },
  {
    "text": "the less cause what we couldn't see when missile and groovy scripts and all these",
    "start": "2034970",
    "end": "2041270"
  },
  {
    "start": "2036000",
    "end": "2094000"
  },
  {
    "text": "things were all in one API service was it had some really bad juicy characteristics and it was to the point",
    "start": "2041270",
    "end": "2047780"
  },
  {
    "text": "where the JVM couldn't really deal with all these things going on and when we separate it out the JVM could say oh",
    "start": "2047780",
    "end": "2054550"
  },
  {
    "text": "that's what you meant to do oh I can deal with that I could optimize around that and so we actually are now running",
    "start": "2054550",
    "end": "2060350"
  },
  {
    "text": "one missile service and like one API service where we were previously running three because the JVM in our case our VM",
    "start": "2060350",
    "end": "2068450"
  },
  {
    "text": "can be more efficient now it knows what your code is doing it can do analysis on it we can do analysis on it right so I",
    "start": "2068450",
    "end": "2074540"
  },
  {
    "text": "can go to this missile service profile it and see what it's doing when it was it over an API too much is going on I",
    "start": "2074540",
    "end": "2081710"
  },
  {
    "text": "couldn't look at a flame graph and reason about it by moving it out I can now get simpler sort of operations out of it and that's what sort of makes it a",
    "start": "2081710",
    "end": "2088460"
  },
  {
    "text": "big way and I would say is that you know can reason about the operations piece of this when you have this sort of monolith",
    "start": "2088460",
    "end": "2093590"
  },
  {
    "text": "than why you should do it so the big overhead the trade-off is I'm going to",
    "start": "2093590",
    "end": "2099260"
  },
  {
    "start": "2094000",
    "end": "2169000"
  },
  {
    "text": "take a lot more operational overhead I have to write a whole new service that is critical to running of Netflix but my",
    "start": "2099260",
    "end": "2105740"
  },
  {
    "text": "other critical service is now going to become more reliant and that's a pretty good trade-off right and we can also now",
    "start": "2105740",
    "end": "2112400"
  },
  {
    "text": "separate right the person running API doesn't have to be the team that runs missile so there that was worth the",
    "start": "2112400",
    "end": "2117500"
  },
  {
    "text": "trade-off in this case so we sir went",
    "start": "2117500",
    "end": "2122900"
  },
  {
    "text": "over five use cases that we saw that we did at Netflix and I get that our scale",
    "start": "2122900",
    "end": "2128600"
  },
  {
    "text": "isn't the biggest scale ever but it's also not trivial these aren't necessary problems that you will see all the time",
    "start": "2128600",
    "end": "2133700"
  },
  {
    "text": "won't affect everybody I get that I'm just hoping and give you some insight how we think about it right it goes back",
    "start": "2133700",
    "end": "2139220"
  },
  {
    "text": "to that scalability I want to make sure I give myself some leeway right if the idea is to just hit the database more in",
    "start": "2139220",
    "end": "2144800"
  },
  {
    "text": "a linear fashion I'm going to think twice about it and try and do something sublinear right",
    "start": "2144800",
    "end": "2150060"
  },
  {
    "text": "something that grows in a more reasonable rate so that as our customers keep coming in we get more memberships",
    "start": "2150060",
    "end": "2155670"
  },
  {
    "text": "we don't or keep we are connecting our entire system bonus trade-off do laundry",
    "start": "2155670",
    "end": "2162750"
  },
  {
    "text": "so the trade-off is you have to do laundry but the benefit here is your family loves you for it so definitely do",
    "start": "2162750",
    "end": "2168510"
  },
  {
    "text": "laundry you could reach me at this email or on Twitter if you'd get a t-shirt and",
    "start": "2168510",
    "end": "2175050"
  },
  {
    "text": "you know like the size come up to me afterwards I can exchange it for you and stuff like that but otherwise thank you",
    "start": "2175050",
    "end": "2180359"
  },
  {
    "text": "very much",
    "start": "2180359",
    "end": "2182690"
  },
  {
    "text": "so I know I did go fast over some of the stuff it is a lot the lesson here is there tools available for you there is a QA",
    "start": "2189040",
    "end": "2196100"
  },
  {
    "text": "now and people are gonna walk around with mic so I assume it's the generic throw your hand up mic comes over ask",
    "start": "2196100",
    "end": "2201950"
  },
  {
    "text": "your question and I'll try and answer it feel free to go deep on any of these points",
    "start": "2201950",
    "end": "2207910"
  },
  {
    "text": "you can ask it I can repeat it so the",
    "start": "2221170",
    "end": "2244369"
  },
  {
    "start": "2242000",
    "end": "2311000"
  },
  {
    "text": "general question is that we are filtering a lot of data which means we're throwing weight a lot of data how do we sort of do further analysis on",
    "start": "2244369",
    "end": "2250700"
  },
  {
    "text": "this useful data we still can right so I don't have to be the only one writing a",
    "start": "2250700",
    "end": "2256040"
  },
  {
    "text": "query anyone can write a query there are still systems that flow off that you get recorded but then you can change it",
    "start": "2256040",
    "end": "2263390"
  },
  {
    "text": "right so I mentioned that it's a query language it has a select statement and you can say select this field this field",
    "start": "2263390",
    "end": "2268609"
  },
  {
    "text": "this field and get very small bits of data and the team that's interested in the small bits of data can just do a",
    "start": "2268609",
    "end": "2273950"
  },
  {
    "text": "hundred percent of all the data well I could say select star on this small bit of data so we actually both can play on",
    "start": "2273950",
    "end": "2280400"
  },
  {
    "text": "the same box and run parallel requests and still get what we're looking for yes",
    "start": "2280400",
    "end": "2285950"
  },
  {
    "text": "if you truly have to offload the box maybe the agent in that diagram does still throw the data off box but it",
    "start": "2285950",
    "end": "2293030"
  },
  {
    "text": "still goes to this mantis I forget what the middle box was called that's that",
    "start": "2293030",
    "end": "2298790"
  },
  {
    "text": "can then filter it and send it to the right places so if you can't get the benefits at the first layer of the agent",
    "start": "2298790",
    "end": "2304280"
  },
  {
    "text": "you can get it at the second layer and that's fine",
    "start": "2304280",
    "end": "2308140"
  },
  {
    "text": "yeah so the question is about the eventually like what if I needed this data in the past that's the trade-off that we're making right so we have to",
    "start": "2311569",
    "end": "2318119"
  },
  {
    "text": "sort of say that said we've been doing analytics for a while we know the things that we do want usually I find is that",
    "start": "2318119",
    "end": "2323549"
  },
  {
    "text": "some new service some new feature I turned on and it's new stuff and that's we're focusing most of our time but",
    "start": "2323549",
    "end": "2330179"
  },
  {
    "text": "there is some older data historical data that's used for analytics for sure I think we're moving the question over to",
    "start": "2330179",
    "end": "2336299"
  },
  {
    "text": "our my life macro my questions the sherry impart you moved the codes you simply the code suit",
    "start": "2336299",
    "end": "2344880"
  },
  {
    "text": "to another service then improve the performance or in general it's like I don't understand how the performance is",
    "start": "2344880",
    "end": "2351839"
  },
  {
    "text": "improved hugely so same amount of work is happening so you would think this",
    "start": "2351839",
    "end": "2357329"
  },
  {
    "text": "would just be literally one plus one equals two but in our case we run in a virtual machine and our code gets",
    "start": "2357329",
    "end": "2363719"
  },
  {
    "text": "cheated over time and so one of the things that actually happened to us was that we had memory being allocated and",
    "start": "2363719",
    "end": "2370109"
  },
  {
    "text": "in the whole scope of a request the JVM couldn't tell if this data was heard of",
    "start": "2370109",
    "end": "2375150"
  },
  {
    "text": "in the Eden space and was new data or it was long-lived space because they're quite what was going on in the span of a",
    "start": "2375150",
    "end": "2381269"
  },
  {
    "text": "request was so much and when it was on two different machines running in a smaller request scope that JVM and the",
    "start": "2381269",
    "end": "2388019"
  },
  {
    "text": "ginning could get in the memory analysis could go in and say hey you actually don't use this memory very long I can",
    "start": "2388019",
    "end": "2394079"
  },
  {
    "text": "throw it out garbage collection it for free and this guy could do it too so both of them are making much smarter",
    "start": "2394079",
    "end": "2399089"
  },
  {
    "text": "garbage collection insights and that's where a lot of the performance came from there but it also opened up like a",
    "start": "2399089",
    "end": "2405299"
  },
  {
    "text": "Pandora's box like now that we had a dedicated service now we could start performance tuning it and getting the real kind of benefits of like taking",
    "start": "2405299",
    "end": "2411479"
  },
  {
    "text": "your code and getting really bad like hot loops and stuff like that so some stuff for free because of garbage",
    "start": "2411479",
    "end": "2417749"
  },
  {
    "text": "collection but also like a plethora of new ability to do performance tuning ok hi my",
    "start": "2417749",
    "end": "2426150"
  },
  {
    "start": "2424000",
    "end": "2508000"
  },
  {
    "text": "question is about your passport the payload did you is it something that you would put on the header or how did you",
    "start": "2426150",
    "end": "2433109"
  },
  {
    "text": "lose the mechanism behind how you would actually store that data so it would be transitive across requests and then",
    "start": "2433109",
    "end": "2440159"
  },
  {
    "text": "secondary follow-up is when the service needed to update the passport what was",
    "start": "2440159",
    "end": "2445589"
  },
  {
    "text": "the interface mechanism to get it back was it in the response or was it some",
    "start": "2445589",
    "end": "2450809"
  },
  {
    "text": "other way yeah the two very related questions how do we pass this passport through I'm at vast majority of requests",
    "start": "2450809",
    "end": "2458429"
  },
  {
    "text": "are hgp you can send headers so it is considered metadata as far as the request we tried to leave the request",
    "start": "2458429",
    "end": "2463969"
  },
  {
    "text": "untouched unscathed and it was sent as a cheapy headers in G RPC which we also",
    "start": "2463969",
    "end": "2469559"
  },
  {
    "text": "use there is metadata fields we can use but we also at some point said hey this is so useful let's just make it the",
    "start": "2469559",
    "end": "2474929"
  },
  {
    "text": "request right if your service wants a passport it wants to know who you're acting on behalf of take that as an",
    "start": "2474929",
    "end": "2481109"
  },
  {
    "text": "argument so as much as we did use it as a sideband channel we we move towards",
    "start": "2481109",
    "end": "2487529"
  },
  {
    "text": "let's just move it into the request if you could write if you're writing a new service we would ask you put it directly in the request because if you're going to try and reproduce that request it'd",
    "start": "2487529",
    "end": "2493979"
  },
  {
    "text": "be nice just say here's the payload here's the passport on the way up it is",
    "start": "2493979",
    "end": "2499079"
  },
  {
    "text": "HP headers on the way back also or put it into the request on the way back up",
    "start": "2499079",
    "end": "2505880"
  },
  {
    "text": "Randi running around alone I'm curious about your thoughts on performance of",
    "start": "2506419",
    "end": "2512339"
  },
  {
    "start": "2508000",
    "end": "2625000"
  },
  {
    "text": "serving recommendation engine based results specifically with two scenarios",
    "start": "2512339",
    "end": "2517589"
  },
  {
    "text": "one where they are sorted filtered and",
    "start": "2517589",
    "end": "2523549"
  },
  {
    "text": "largely around items whose state particularly around",
    "start": "2523549",
    "end": "2528569"
  },
  {
    "text": "availability changes very rapidly so in the scenario where an item is available",
    "start": "2528569",
    "end": "2534119"
  },
  {
    "text": "for maybe two minutes and now it goes away or it goes into a different state that means it needs to be way further",
    "start": "2534119",
    "end": "2541589"
  },
  {
    "text": "down because it's just a different class of thing and then it comes back you know a minute later I don't think I follow",
    "start": "2541589",
    "end": "2549659"
  },
  {
    "text": "the part about the recommendations and data changing versus become unavailable well so sorry specifically",
    "start": "2549659",
    "end": "2555539"
  },
  {
    "text": "recommendation around the fact that you know if you have all this stuff in elasticsearch",
    "start": "2555539",
    "end": "2561209"
  },
  {
    "text": "you could be updating it and you can do your search and that's really really easy but when it's a recommendation engine type of scenario the sort is",
    "start": "2561209",
    "end": "2568650"
  },
  {
    "text": "highly influenced by the user item relation ship and that you know sure so I'm not I",
    "start": "2568650",
    "end": "2578400"
  },
  {
    "text": "am a little bit familiar with the recommendation engine it is different it has different trade-offs for sure and it",
    "start": "2578400",
    "end": "2584279"
  },
  {
    "text": "is not very cashable right every customer has a difference right sort of set of recommendations that we want to",
    "start": "2584279",
    "end": "2590069"
  },
  {
    "text": "do and stuff in our case nothing I was showing is really customer specific in",
    "start": "2590069",
    "end": "2596279"
  },
  {
    "text": "that case they do lean a lot more towards memcache D like solutions pushing updates to memcache D I think",
    "start": "2596279",
    "end": "2603359"
  },
  {
    "text": "gets a little more into what the keynote was talking about and how if you want that different characteristic you would choose one of those systems okay yeah",
    "start": "2603359",
    "end": "2611880"
  },
  {
    "text": "thank you",
    "start": "2611880",
    "end": "2614298"
  },
  {
    "start": "2625000",
    "end": "2734000"
  },
  {
    "text": "hi for passport you mentioned that you implemented some sort of contract and I",
    "start": "2625349",
    "end": "2631079"
  },
  {
    "text": "can imagine that contract involves being able to deal with the same message twice that's actually a message replay because",
    "start": "2631079",
    "end": "2637170"
  },
  {
    "text": "you're basically like taking a request that you mutated and then shoving it back like through all the previous",
    "start": "2637170",
    "end": "2642720"
  },
  {
    "text": "stages it's not going through previous stages okay it's for subsequent requests",
    "start": "2642720",
    "end": "2647970"
  },
  {
    "text": "right so in the model in that picture the mid-tier a is gonna call B then C then D let's say and so something",
    "start": "2647970",
    "end": "2655109"
  },
  {
    "text": "happened in B then he called C they're not happening in parallel there's a serial sort of form right but the",
    "start": "2655109",
    "end": "2661609"
  },
  {
    "text": "preceding stages have to deal with the same request essentially happening multiple times so if there's any side",
    "start": "2661609",
    "end": "2666780"
  },
  {
    "text": "effects like how difficult was it to get people to buy into the contract",
    "start": "2666780",
    "end": "2672180"
  },
  {
    "text": "essentially like how much fallout was there from implementing this like new contractual thing that really obvious",
    "start": "2672180",
    "end": "2678660"
  },
  {
    "text": "there's two pieces there's a carrot in the stick I mean one official title cat herder happy but a big piece of it if",
    "start": "2678660",
    "end": "2686039"
  },
  {
    "text": "you were going to change data and you want other people to see it you have to do this contract right if you want to be a service changing the data and and it's",
    "start": "2686039",
    "end": "2692849"
  },
  {
    "text": "not being reflected in other places right it's not getting saved as that cookie if you're not getting it back up",
    "start": "2692849",
    "end": "2697859"
  },
  {
    "text": "to that layer seven proxy your data doesn't go out so does your service even",
    "start": "2697859",
    "end": "2703950"
  },
  {
    "text": "exists so they had a there is there is a reason why they'd want to participate for sure and very few services are",
    "start": "2703950",
    "end": "2709020"
  },
  {
    "text": "changing it and needing the changes reflected so we don't have to talk to very few teams on that front the the",
    "start": "2709020",
    "end": "2715289"
  },
  {
    "text": "other contract was just you receive a passport and then you send it back down this is sort of classic just tracing",
    "start": "2715289",
    "end": "2720329"
  },
  {
    "text": "right going through like that so that was her easy we already had tracing mechanisms that we could use and for the",
    "start": "2720329",
    "end": "2725520"
  },
  {
    "text": "flowing backup part of it it was a if you want your data to be updated you better send the password back up so it's",
    "start": "2725520",
    "end": "2731760"
  },
  {
    "text": "sort of melded really nicely for us hi my question is around the device type",
    "start": "2731760",
    "end": "2736829"
  },
  {
    "start": "2734000",
    "end": "2985000"
  },
  {
    "text": "you mentioned when you you have a subscription that being used after nine",
    "start": "2736829",
    "end": "2742619"
  },
  {
    "text": "months you create kind of pops of map pops of model and you create kind of jar or something you mentioned how do you",
    "start": "2742619",
    "end": "2750180"
  },
  {
    "text": "like restore that pops of model and communicate back when a device come",
    "start": "2750180",
    "end": "2755819"
  },
  {
    "text": "online on improv how do you the entire cycle the",
    "start": "2755819",
    "end": "2761580"
  },
  {
    "text": "performance or the management of getting into something in production from the",
    "start": "2761580",
    "end": "2767760"
  },
  {
    "text": "day noticeable how do you do that let me see if I get the question right just",
    "start": "2767760",
    "end": "2772980"
  },
  {
    "text": "sort of how do we sort of manage the getting that data pushed out to production alright so flows joy you need to store",
    "start": "2772980",
    "end": "2780030"
  },
  {
    "text": "somewhere and you do communicate back and we have like a source of truth you",
    "start": "2780030",
    "end": "2785190"
  },
  {
    "text": "know a database that can store the truth of it right there's 2,000 devices but that's truly that's not a big database",
    "start": "2785190",
    "end": "2790609"
  },
  {
    "text": "that is just a source of truth that we live that we look at and it's a matter",
    "start": "2790609",
    "end": "2795900"
  },
  {
    "text": "of the system makes it change the database also in house to push a change to us so we could push it out over the",
    "start": "2795900",
    "end": "2801060"
  },
  {
    "text": "pub/sub I mean that's that coordination wasn't too bad right that's sort of they",
    "start": "2801060",
    "end": "2806849"
  },
  {
    "text": "know they made a change so they made sure to tell us right it does give us this dual world where the source the truth is over here which is not",
    "start": "2806849",
    "end": "2813030"
  },
  {
    "text": "production data and we're pushing data out to production we really want to keep those two worlds different really the",
    "start": "2813030",
    "end": "2818400"
  },
  {
    "text": "team is optimized for making those source of true changes isn't the team that knows how to really run things in",
    "start": "2818400",
    "end": "2824609"
  },
  {
    "text": "production right or doesn't have that training or that experience I know they I'm answering a question per se though",
    "start": "2824609",
    "end": "2832970"
  },
  {
    "text": "you know what they they call us I don't call them so like when they make that change and they've made a change of the",
    "start": "2834080",
    "end": "2839820"
  },
  {
    "text": "UI they tell us that there's a change so it's actually so that was our decoupling where you want a nice clean decoupling",
    "start": "2839820",
    "end": "2845460"
  },
  {
    "text": "between the team that was not doing production changes to us which is a team that was doing production changes so they would just call our service and say",
    "start": "2845460",
    "end": "2851490"
  },
  {
    "text": "hey there's new data so we there wasn't a lot of coordination in that front any",
    "start": "2851490",
    "end": "2859800"
  },
  {
    "text": "more questions oh wait thanks for sticking around",
    "start": "2859800",
    "end": "2865609"
  },
  {
    "text": "hi my name is Phil I was really impressed by just scaling from one",
    "start": "2867260",
    "end": "2873060"
  },
  {
    "text": "minute 1 million to 150 million this is less about engineering more about ideation in terms of I'm sure at 1",
    "start": "2873060",
    "end": "2879990"
  },
  {
    "text": "million do you guys had kind of thoughts about how to architect this thing that you wouldn't have imagined doing it 158",
    "start": "2879990",
    "end": "2885600"
  },
  {
    "text": "million I'm curious from an ideation perspective like where did you draw over",
    "start": "2885600",
    "end": "2891090"
  },
  {
    "text": "the years like your team drew inspiration about practices that you would need to learn from because",
    "start": "2891090",
    "end": "2897450"
  },
  {
    "text": "obviously your team at 1 million kind of has a limited kind of knowledge of what the scale needs to be you know but and",
    "start": "2897450",
    "end": "2904380"
  },
  {
    "text": "then over the years you need to either internally be really creative or look outside for solutions like in terms of",
    "start": "2904380",
    "end": "2911100"
  },
  {
    "text": "the eight years what did you how did you guys get inspiration for practices in",
    "start": "2911100",
    "end": "2916619"
  },
  {
    "text": "ideation curious well I was I wasn't working on the product the whole time",
    "start": "2916619",
    "end": "2921770"
  },
  {
    "text": "but I can tell you that it comes from a few different veins one is a willingness to rewrite things right if I'm telling",
    "start": "2921770",
    "end": "2927270"
  },
  {
    "text": "you that scalability is giving yourself some wiggle room and you can grow to X what happens means that you have to be",
    "start": "2927270",
    "end": "2932910"
  },
  {
    "text": "willing to rewrite it when you get to 2 X and prepare for 4 X so there is a willingness to rewrite like I think when",
    "start": "2932910",
    "end": "2939000"
  },
  {
    "text": "people would propose people would propose hey we need to rewrite it",
    "start": "2939000",
    "end": "2944310"
  },
  {
    "text": "we were pretty open to the idea so there has to be a willingness to rewrite there's a value in that the other half",
    "start": "2944310",
    "end": "2949619"
  },
  {
    "text": "of it I would say is that teams would partition themselves and take ownership of it right so if my team is a small",
    "start": "2949619",
    "end": "2956790"
  },
  {
    "text": "team and we're seeing growing pains that's how we know that's time to reaaargh attack within our sort of smaller domain all right we don't have",
    "start": "2956790",
    "end": "2963210"
  },
  {
    "text": "an architect saying hey we think there's general really textured needed we did it in sort of a smaller scale and so that",
    "start": "2963210",
    "end": "2969600"
  },
  {
    "text": "really let teams really know when and how they should start thinking about the scale of the issue because there they",
    "start": "2969600",
    "end": "2975030"
  },
  {
    "text": "have their responsibility their service goes down that's on them so they knew that pain great so let's thank Justin",
    "start": "2975030",
    "end": "2981420"
  },
  {
    "text": "one more time please [Applause]",
    "start": "2981420",
    "end": "2986869"
  }
]