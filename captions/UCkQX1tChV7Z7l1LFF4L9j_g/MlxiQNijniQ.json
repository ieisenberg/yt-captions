[
  {
    "start": "0",
    "end": "20000"
  },
  {
    "text": "[Music]",
    "start": "7300",
    "end": "13719"
  },
  {
    "text": "we're going to talk a little bit about the internals um of of Android and um and before we do that I'm",
    "start": "13719",
    "end": "20960"
  },
  {
    "start": "20000",
    "end": "100000"
  },
  {
    "text": "just going to tell you a little bit about myself for those of you who um haven't met me before um so my",
    "start": "20960",
    "end": "27359"
  },
  {
    "text": "background is in Java so I'm not I don't have a strong C C++ uh background at least you know for the last 10 years um",
    "start": "27359",
    "end": "33840"
  },
  {
    "text": "so I've been doing Java before it was named Java so from the mid 990s uh and",
    "start": "33840",
    "end": "38879"
  },
  {
    "text": "the last couple of years I've been extensively working on Android and Android internals so I've been doing a lot of sort of poking around internals",
    "start": "38879",
    "end": "45960"
  },
  {
    "text": "of of the operating system building custom roms um Etc modifying the the",
    "start": "45960",
    "end": "51440"
  },
  {
    "text": "platform as well as developing the applications um I'm also the author of the upcoming uh learning Android book um",
    "start": "51440",
    "end": "58199"
  },
  {
    "text": "which should be coming out next there's a sample I believe uh available somewhere so you guys can take a look at",
    "start": "58199",
    "end": "64400"
  },
  {
    "text": "it but the book is also available in draft uh copy uh free of charge at at uh",
    "start": "64400",
    "end": "72119"
  },
  {
    "text": "learning android.com so you can uh you can uh get it from there um as again it's a draft",
    "start": "72119",
    "end": "80479"
  },
  {
    "text": "so it's not the complete um version it's not the final version um I",
    "start": "80479",
    "end": "86479"
  },
  {
    "text": "also frequently speak at conferences such as this one also spoke at oson a couple of times I E",
    "start": "86479",
    "end": "92600"
  },
  {
    "text": "ACN um and so on everyone got this so let me tell you",
    "start": "92600",
    "end": "100000"
  },
  {
    "start": "100000",
    "end": "134000"
  },
  {
    "text": "then a little bit about what we're going to do uh today so we're going to talk about uh what happens when the system boots up right so how does everything",
    "start": "100000",
    "end": "106840"
  },
  {
    "text": "get started what are what are the bits and pieces uh that that get started up we're going to talk a little bit about",
    "start": "106840",
    "end": "112799"
  },
  {
    "text": "the layer interaction uh which I I think is kind of important to understand uh for any anything that has to do with",
    "start": "112799",
    "end": "119880"
  },
  {
    "text": "internals you sort of have to understand how the different bits and pieces of the platform communicate um and in the",
    "start": "119880",
    "end": "125840"
  },
  {
    "text": "context of that we're going to talk about the ndk aidl and um and that's about it so that should be um that",
    "start": "125840",
    "end": "132400"
  },
  {
    "text": "should be what we can fit into an hour so in terms of the the the startup",
    "start": "132400",
    "end": "137840"
  },
  {
    "start": "134000",
    "end": "140000"
  },
  {
    "text": "of the system uh what basically what happens when you turn on the device is",
    "start": "137840",
    "end": "143640"
  },
  {
    "start": "140000",
    "end": "405000"
  },
  {
    "text": "roughly this so I'm going to kind of walk you through this a little bit step by step so essentially",
    "start": "143640",
    "end": "150519"
  },
  {
    "text": "um as you guys know Android is built on top of Linux so we start a whole bunch of Linux demons initially um and these",
    "start": "150519",
    "end": "157680"
  },
  {
    "text": "are the low-level things that have to do with power management memory uh memory",
    "start": "157680",
    "end": "162920"
  },
  {
    "text": "management you um Radio starts as part of the uh demons Etc so these are some",
    "start": "162920",
    "end": "168959"
  },
  {
    "text": "low-level Linux uh related things they're not necessarily um very much",
    "start": "168959",
    "end": "175599"
  },
  {
    "text": "related to Android in terms of things that are provided on top of the the Linux OS um so that that starts up",
    "start": "175599",
    "end": "183239"
  },
  {
    "text": "first secondly what we're doing is we're starting uh we're starting up the runtime and durun is basically a whole",
    "start": "183239",
    "end": "189239"
  },
  {
    "text": "bunch of uh system services that have uh we're going to talk about system Services here as well but um runtime is",
    "start": "189239",
    "end": "196920"
  },
  {
    "text": "basically their C counter part the native counterart right so these are the bit the bits and pieces that sit much",
    "start": "196920",
    "end": "203000"
  },
  {
    "text": "lower to the to the kernel than uh than these uh system Services here but they",
    "start": "203000",
    "end": "209360"
  },
  {
    "text": "sort of hand in hand they're basically registered with one another but before we can start the",
    "start": "209360",
    "end": "215519"
  },
  {
    "text": "system Services which um by the way the blue roughly cor correlates to Java so",
    "start": "215519",
    "end": "220799"
  },
  {
    "text": "things that that that is in Blue uh blue boxes um denote that it's a dvic or Java",
    "start": "220799",
    "end": "227360"
  },
  {
    "text": "base code essentially that's running U before we can start anything uh that has",
    "start": "227360",
    "end": "232519"
  },
  {
    "text": "to do with dvic or Java we need a zygote process zygote is basically a pre-warmed",
    "start": "232519",
    "end": "240519"
  },
  {
    "text": "up version of any future um any future application that is ever going to get",
    "start": "240519",
    "end": "245799"
  },
  {
    "text": "started so essentially um if you think about it when when a user clicks on a on a on an app clicks on a little button",
    "start": "245799",
    "end": "251760"
  },
  {
    "text": "wants to start up an application uh what's what what happens is we need to launch an entire new process right uh",
    "start": "251760",
    "end": "259280"
  },
  {
    "text": "one application essentially become runs in in a in a separate each applications in a separate Linux process Al together",
    "start": "259280",
    "end": "266479"
  },
  {
    "text": "so we got La launch that process on top of that we need to load the virtual machine right because we're going to",
    "start": "266479",
    "end": "271759"
  },
  {
    "text": "need a VM on on on which we're going to load up our application so all these things take a a long time to to execute",
    "start": "271759",
    "end": "279240"
  },
  {
    "text": "memory allocation um Etc that's usually expensive so to make things faster um",
    "start": "279240",
    "end": "286120"
  },
  {
    "text": "the Android team essentially came up with something called zygote and what that is is is all that pre-warmed up and",
    "start": "286120",
    "end": "292160"
  },
  {
    "text": "ready to go right so every future version of any application is going to have its roots in zygote right it's",
    "start": "292160",
    "end": "299440"
  },
  {
    "text": "going to it's going to be forked essentially uh from this process and zot gives us that pre-warmed up virtual",
    "start": "299440",
    "end": "306960"
  },
  {
    "text": "machine and the and the process and everything set up to to go so once we",
    "start": "306960",
    "end": "312360"
  },
  {
    "text": "get zygote going which includes the VM itself right uh once we have that going",
    "start": "312360",
    "end": "318600"
  },
  {
    "text": "uh we can launch system services and system services are essentially uh bits and pieces of the platform at this point",
    "start": "318600",
    "end": "325880"
  },
  {
    "text": "so this is the this is the Java code right or do code uh these are the bits and pieces of the platform that provide",
    "start": "325880",
    "end": "332680"
  },
  {
    "text": "that rich application framework environment for applications right so for example if you're writing an app and",
    "start": "332680",
    "end": "339960"
  },
  {
    "text": "you want to play a music or you want to find out your GPS location or you want to find out what Wi-Fi networks are",
    "start": "339960",
    "end": "346919"
  },
  {
    "text": "available Etc you need to tap into specific Services right so these are the services that are constantly always on",
    "start": "346919",
    "end": "353919"
  },
  {
    "text": "always is running on a platform system Services um so so that starts up next",
    "start": "353919",
    "end": "361319"
  },
  {
    "text": "we call them in Java we usually call them managers although they're backed by by a service right so uh at once this",
    "start": "361319",
    "end": "369319"
  },
  {
    "text": "starts up at that point we say the system has booted so this is sort of the the chronological line where we said",
    "start": "369319",
    "end": "376400"
  },
  {
    "text": "where we say the system is is completed the boot is completed and at this point we can start the actual",
    "start": "376400",
    "end": "383319"
  },
  {
    "text": "applications so basically like I have the line here so this is the the chronological order of things right",
    "start": "383319",
    "end": "390680"
  },
  {
    "text": "once we have all that done we can launch our applications so that's uh that's",
    "start": "390680",
    "end": "395880"
  },
  {
    "text": "that this is just you know any any usual application that we may have running so let me show you this in another way um",
    "start": "395880",
    "end": "402800"
  },
  {
    "text": "on a little closer to the actual device so I have an ulator running uh I just",
    "start": "402800",
    "end": "408039"
  },
  {
    "start": "405000",
    "end": "445000"
  },
  {
    "text": "booted it up nothing really special about it what I'm going to do is I'm going to do ADB shell to connect to the",
    "start": "408039",
    "end": "413400"
  },
  {
    "text": "actual uh device uh which in this case it's not finding so this happens every once in a while so you got to do ADB",
    "start": "413400",
    "end": "420280"
  },
  {
    "text": "kill server um and ADB start server hopefully",
    "start": "420280",
    "end": "425400"
  },
  {
    "text": "reboots that connection um this is where the tools are sometimes not perfect um so let me",
    "start": "425400",
    "end": "433400"
  },
  {
    "text": "see ad devices um and the emulator is back online connected to my laptop so",
    "start": "433400",
    "end": "439440"
  },
  {
    "text": "I'm going to do ADB shell now and we're in so at this point I'm I'm connected to",
    "start": "439440",
    "end": "444800"
  },
  {
    "text": "the actual shell of the device if I do a PS to just see uh what the processes",
    "start": "444800",
    "end": "450879"
  },
  {
    "start": "445000",
    "end": "635000"
  },
  {
    "text": "what processes we currently have running on the device um this is basically what",
    "start": "450879",
    "end": "455919"
  },
  {
    "text": "what we have here so in it process is just like on any Linux platform that starts everything right so that's that's",
    "start": "455919",
    "end": "462440"
  },
  {
    "text": "the beginning of Life on on the platform um next what we have and you",
    "start": "462440",
    "end": "468120"
  },
  {
    "text": "can sort of see the the process IDs everything so you know it's chronological based on the the the PS so",
    "start": "468120",
    "end": "475759"
  },
  {
    "text": "uh next what we have is a whole bunch of this uh Linux native demons that get",
    "start": "475759",
    "end": "481680"
  },
  {
    "text": "started and this is basically where we're starting our runtime processes um",
    "start": "481680",
    "end": "487199"
  },
  {
    "text": "here right so these are now the Android specific rtime processes so this is a",
    "start": "487199",
    "end": "492440"
  },
  {
    "text": "service manager the this is for example the radio demon uh radio interface layer",
    "start": "492440",
    "end": "498680"
  },
  {
    "text": "uh that's starting up here and at some point we start up zygote okay so that's",
    "start": "498680",
    "end": "504960"
  },
  {
    "text": "basically correlates to this point in time here so at this point we're starting",
    "start": "504960",
    "end": "510960"
  },
  {
    "text": "zygote um and the run time is already started up so once we once we have",
    "start": "510960",
    "end": "516680"
  },
  {
    "text": "zygote started uh so these are also parts of the runtime so this is also native code that starts up this is our",
    "start": "516680",
    "end": "522120"
  },
  {
    "text": "ADB demon so this is what's facilitating this connection back and forth between my laptop and the actual",
    "start": "522120",
    "end": "529200"
  },
  {
    "text": "device um it starts up here at at this point once the zygote is has been",
    "start": "529200",
    "end": "534399"
  },
  {
    "text": "started we can start anything that has to do with delic code right which also",
    "start": "534399",
    "end": "540160"
  },
  {
    "text": "includes our system server um and so this is the system server that's starting started up here you can",
    "start": "540160",
    "end": "546040"
  },
  {
    "text": "actually see that the process ID the parent process ID is ID 33 which correlates to the zyg process ID right",
    "start": "546040",
    "end": "553920"
  },
  {
    "text": "so basically that's where it it it comes from um let me show you that like this",
    "start": "553920",
    "end": "559680"
  },
  {
    "text": "so basically the systems this is forked over to this box to to create the uh the",
    "start": "559680",
    "end": "567519"
  },
  {
    "text": "system server uh proc inside of which all our services or",
    "start": "567519",
    "end": "573000"
  },
  {
    "text": "managers run right so this is where your location manager Wi-Fi manager connectivity manager Bluetooth manager",
    "start": "573000",
    "end": "578279"
  },
  {
    "text": "teleph manager you know all these managers basically they run inside of this box as as as a single",
    "start": "578279",
    "end": "585399"
  },
  {
    "text": "process um so that so that's that's that at this point we're we're done booing so",
    "start": "585399",
    "end": "591519"
  },
  {
    "text": "everything that follows after that is going to be the Android apps right so these are various Android applications",
    "start": "591519",
    "end": "597560"
  },
  {
    "text": "that we have uh started up so it's it's very very much chronological as well uh in terms of what happens um you know um",
    "start": "597560",
    "end": "605760"
  },
  {
    "text": "in terms of the the actual you know PS command seeing the processes um the",
    "start": "605760",
    "end": "611279"
  },
  {
    "text": "actual order of all this is in in in itrc file so so that's where it's specified um and U but like I said the",
    "start": "611279",
    "end": "619880"
  },
  {
    "text": "it's very much important that that zygote starts before any anything dalic related starts",
    "start": "619880",
    "end": "625959"
  },
  {
    "text": "up um so any questions well just the Buddha process so far",
    "start": "625959",
    "end": "631279"
  },
  {
    "text": "yeah RC yeah so if you look at so basically",
    "start": "631279",
    "end": "637320"
  },
  {
    "text": "there's a file um right here in it RC file and um and and that's um it's it's",
    "start": "637320",
    "end": "645040"
  },
  {
    "text": "it's somewh specific to Android um in a in a way that it's different",
    "start": "645040",
    "end": "650120"
  },
  {
    "text": "than typical Linux distributions uh there's a there's a it's it's very well explained in a in a text file in Source",
    "start": "650120",
    "end": "657279"
  },
  {
    "text": "um so I can actually um show you this file really briefly but what I'm going to do is I'm going to load up uh I'm",
    "start": "657279",
    "end": "663000"
  },
  {
    "text": "going to load it up from source as opposed to doing it from um um from so",
    "start": "663000",
    "end": "669079"
  },
  {
    "text": "let me just load up my image for the Android Source andc I'm going to do uh",
    "start": "669079",
    "end": "676120"
  },
  {
    "text": "volumes gingerbread I'm going to uh open it up uh",
    "start": "676120",
    "end": "683279"
  },
  {
    "text": "here so you can",
    "start": "684399",
    "end": "688800"
  },
  {
    "text": "just taking a little longer to start up uh because it's loading all the directories should actually let me do it",
    "start": "690360",
    "end": "697680"
  },
  {
    "text": "like this so in in Source it's in system uh folder um CD",
    "start": "697680",
    "end": "704839"
  },
  {
    "text": "core and that's where um um CD root",
    "start": "704839",
    "end": "711839"
  },
  {
    "text": "door and that's where our init RC is so let me see if I can um open it up like",
    "start": "711839",
    "end": "717320"
  },
  {
    "text": "this um to show you I guess it just my system is a little",
    "start": "717320",
    "end": "722519"
  },
  {
    "text": "running a little slow um it will eventually open up the file so this is the file that's Bas",
    "start": "722519",
    "end": "729839"
  },
  {
    "text": "basically specifying you know the order of the startup order of things so this is where we startup zot process um and",
    "start": "729839",
    "end": "737600"
  },
  {
    "text": "it's critical to everything else and you know it's you can also see that their dependencies that everything else is",
    "start": "737600",
    "end": "743199"
  },
  {
    "text": "dependent on zygote um so if zygote dies it's everything else needs to be reboot",
    "start": "743199",
    "end": "749519"
  },
  {
    "text": "it um and uh that may or may not work actually um if you kill like kill das9",
    "start": "749519",
    "end": "756000"
  },
  {
    "text": "for example zyo so it the system is going to reboot but usually doesn't come up doesn't come back up properly um all",
    "start": "756000",
    "end": "764240"
  },
  {
    "text": "the time so so that's a little bit about the the the startup uh process any any other questions on how things um how",
    "start": "764240",
    "end": "773440"
  },
  {
    "start": "765000",
    "end": "865000"
  },
  {
    "text": "this starts up when it's yeah",
    "start": "773440",
    "end": "778079"
  },
  {
    "text": "um how much does zygote save in ter in terms of the the the startup time I'm not sure exactly um how much it saves um",
    "start": "780480",
    "end": "789160"
  },
  {
    "text": "in ter yeah I'm not I'm not 100% sure um but you know the key is to to make the user experience as as good as possible",
    "start": "789160",
    "end": "796440"
  },
  {
    "text": "in terms of starting up the application so that's what we're start we're trying to to help out and the design of Android",
    "start": "796440",
    "end": "802040"
  },
  {
    "text": "is such that we have a very we have a Sandbox for each app right so each app is a totally different Linux process",
    "start": "802040",
    "end": "809839"
  },
  {
    "text": "um unlike for example uh you know Blackberry or some other systems where the uh the applications are are kind of",
    "start": "809839",
    "end": "816920"
  },
  {
    "text": "separated in a Java layer so here we're doing that separation in in the C layer so as such we actually need a copy of",
    "start": "816920",
    "end": "823199"
  },
  {
    "text": "the VM for every single uh every single instance every single app right",
    "start": "823199",
    "end": "829959"
  },
  {
    "text": "yeah yes so Z yeah it's a c exactly it's a c process but it it is going to load",
    "start": "832079",
    "end": "838759"
  },
  {
    "text": "up the the instance of the VM so that when you uh Fork it you basically have",
    "start": "838759",
    "end": "844440"
  },
  {
    "text": "the VM ready",
    "start": "844440",
    "end": "847160"
  },
  {
    "text": "yeah uh not many um I have I have my consumer phone um we can just kind of",
    "start": "850800",
    "end": "856880"
  },
  {
    "text": "you know that that is totally non-modified regular phone so I can we can compare the notes with that as well",
    "start": "856880",
    "end": "864399"
  },
  {
    "text": "um so so now if I connect my physical phone uh to this I'm going to do ADB DD",
    "start": "864399",
    "end": "872920"
  },
  {
    "start": "865000",
    "end": "950000"
  },
  {
    "text": "U shell to connect to the device shell right um and I can do a PS on this device and as you can see it's pretty",
    "start": "872920",
    "end": "879560"
  },
  {
    "text": "much uh pretty much very very much similar right so in it starts everything a bunch of demons startup they're",
    "start": "879560",
    "end": "886519"
  },
  {
    "text": "slightly different right so there are different U sets sets of demons and that has to do with things that are sometimes",
    "start": "886519",
    "end": "892680"
  },
  {
    "text": "proprietory to the device so there's going to be a lot of driver related stuff um you know it's the whole world",
    "start": "892680",
    "end": "897759"
  },
  {
    "text": "that that is I'm not that familiar with um but at some point we're basically starting up",
    "start": "897759",
    "end": "904000"
  },
  {
    "text": "our service manager which is the C Implement C part of the Android code",
    "start": "904000",
    "end": "909079"
  },
  {
    "text": "that backs the all the all the system Services um and we're starting a couple",
    "start": "909079",
    "end": "914240"
  },
  {
    "text": "other things but here again is zot uh starts up and after that we start",
    "start": "914240",
    "end": "920320"
  },
  {
    "text": "everything else so you can see that that PID is the parent of the system server",
    "start": "920320",
    "end": "926040"
  },
  {
    "text": "right and once the system server is done this is when we actually completed booing this is where we send a broadcast",
    "start": "926040",
    "end": "931519"
  },
  {
    "text": "message and say boot complete um or broadcast intent and um and that point",
    "start": "931519",
    "end": "937560"
  },
  {
    "text": "we're starting up everything that has to do with with Android so these are all the Android apps that's what that's what",
    "start": "937560",
    "end": "943480"
  },
  {
    "text": "I'm referring to so I have quite a few running in there so it's it's very much",
    "start": "943480",
    "end": "948639"
  },
  {
    "text": "comparable in terms of that um usually the init um init files are going to be",
    "start": "948639",
    "end": "954319"
  },
  {
    "start": "950000",
    "end": "1035000"
  },
  {
    "text": "quite different um not quite different but they're going to be different um but that's us usually done on the platform",
    "start": "954319",
    "end": "960800"
  },
  {
    "text": "in a in a way that uh let me show you um that's a good way to show you let me",
    "start": "960800",
    "end": "966000"
  },
  {
    "text": "show you on the actual sorry about that on the actual system so LS so in it in",
    "start": "966000",
    "end": "971680"
  },
  {
    "text": "this case I only have one init but on this on on the emul emulator we actually",
    "start": "971680",
    "end": "977120"
  },
  {
    "text": "have two inets right so this is basically the UL the init RC file that",
    "start": "977120",
    "end": "982600"
  },
  {
    "text": "is specific to to the emulator goldfish is a is a nickname for emulator for some",
    "start": "982600",
    "end": "987759"
  },
  {
    "text": "reason they always named after fish so there's trout and and so on but goldfish is refers to the emulator so this is the",
    "start": "987759",
    "end": "994199"
  },
  {
    "text": "emulator specific um in it u in it gold",
    "start": "994199",
    "end": "999880"
  },
  {
    "text": "let me cut it and you can see that this is where we're setting certain things that are emulator specific such as uh",
    "start": "999880",
    "end": "1005800"
  },
  {
    "text": "for example what to use for its internal IP address U you know that battery level",
    "start": "1005800",
    "end": "1010959"
  },
  {
    "text": "things that kind of like you know it always at 50% and so on and so on so this is all set in that specific Android",
    "start": "1010959",
    "end": "1017920"
  },
  {
    "text": "uh emulator specific RC file um so when it's",
    "start": "1017920",
    "end": "1025839"
  },
  {
    "text": "yeah so so okay the qu so the question so the",
    "start": "1032160",
    "end": "1038798"
  },
  {
    "start": "1035000",
    "end": "1125000"
  },
  {
    "text": "question is how come the emulator takes so long to to to start up so um what",
    "start": "1038799",
    "end": "1044959"
  },
  {
    "text": "what what we're speeding up so let's draw let me um let me hold on let me hi",
    "start": "1044959",
    "end": "1050360"
  },
  {
    "text": "this because it's not working very well so let me draw this line here right so this is where we say the system is",
    "start": "1050360",
    "end": "1055559"
  },
  {
    "text": "booing up right um you're you're saying that this part here is relatively slow",
    "start": "1055559",
    "end": "1062200"
  },
  {
    "text": "right and um but but that's not what we are trying to make faster that is not our goal our goal is to make startup of",
    "start": "1062200",
    "end": "1069520"
  },
  {
    "text": "this faster so that's why we have zygote we want to make this start fast it's not",
    "start": "1069520",
    "end": "1075720"
  },
  {
    "text": "it's not a big pain point for the user that the phone Bo boots up really slow",
    "start": "1075720",
    "end": "1080799"
  },
  {
    "text": "right because um you know you boot it up once a week or something right um but it",
    "start": "1080799",
    "end": "1087360"
  },
  {
    "text": "it would be a big pain point if starting an app takes a long time right so for example iPhone fakes startup uh by",
    "start": "1087360",
    "end": "1095200"
  },
  {
    "text": "putting up the the photo of the app the image of the app while it's actually cranking the background and and boing up",
    "start": "1095200",
    "end": "1101159"
  },
  {
    "text": "the the actual application so in Android we you know focused more on actually making things faster for real as opposed",
    "start": "1101159",
    "end": "1106679"
  },
  {
    "text": "to Faking It there was a question yeah I what I",
    "start": "1106679",
    "end": "1114480"
  },
  {
    "text": "thought the question was why is the emulator why does the emulator",
    "start": "1114480",
    "end": "1121039"
  },
  {
    "text": "takes so keep in so why is the emulator so this that's not so why does this part",
    "start": "1122320",
    "end": "1128600"
  },
  {
    "start": "1125000",
    "end": "1195000"
  },
  {
    "text": "here take a long time to start so keep in mind that uh the what we're using an emulator not a simulator so I keep",
    "start": "1128600",
    "end": "1134960"
  },
  {
    "text": "telling people you know they sound very similar but they're quite fundamentally different so this here is a virtual",
    "start": "1134960",
    "end": "1142640"
  },
  {
    "text": "machine right so we are running exactly the same codebase as we are running on on this right so it's it's Arm based",
    "start": "1142640",
    "end": "1150120"
  },
  {
    "text": "code and and and so forth so we're not simulating anything so the fact that I have a dual core you know8 gigs of RAM",
    "start": "1150120",
    "end": "1158080"
  },
  {
    "text": "um MacBook Pro it doesn't really matter I'm running the same code base um and U",
    "start": "1158080",
    "end": "1163799"
  },
  {
    "text": "as I'm running on the physical device now why it may be slightly slower than on phys physical phone is purely because",
    "start": "1163799",
    "end": "1171600"
  },
  {
    "text": "of the emulation so you know when you when you amul whenever you ulate things you're interpreting the the binary code",
    "start": "1171600",
    "end": "1178280"
  },
  {
    "text": "base so that runs a little slower um but we're going to do some compare we're going to do some testing on on on speed",
    "start": "1178280",
    "end": "1184520"
  },
  {
    "text": "later on with the with the ndk so we're going to see you know if we get some fundamental differences between physical",
    "start": "1184520",
    "end": "1190280"
  },
  {
    "text": "phone emulated phone and so on so um so when it's all said and done",
    "start": "1190280",
    "end": "1196000"
  },
  {
    "start": "1195000",
    "end": "1270000"
  },
  {
    "text": "here when we finish booing up we basic Bally have this right this is the stack many of you have seen this picture",
    "start": "1196000",
    "end": "1201880"
  },
  {
    "text": "before yeah so at the end of the day um everything is up and running looks like this so the bottom of it all we have",
    "start": "1201880",
    "end": "1208480"
  },
  {
    "text": "Linux right uh it's backing the native libraries which are basically cc++ code",
    "start": "1208480",
    "end": "1214520"
  },
  {
    "text": "uh that is there to back this part of the system right and at the end of the day you you know",
    "start": "1214520",
    "end": "1220320"
  },
  {
    "text": "application um you know developers write apps right so as an application developer you want to write an app",
    "start": "1220320",
    "end": "1226480"
  },
  {
    "text": "that's going to talk to something that's aail able to you in the application framework that's why Android is so",
    "start": "1226480",
    "end": "1232520"
  },
  {
    "text": "appealing right because you have this Rich framework you can just tap into it you can you know get things done quickly",
    "start": "1232520",
    "end": "1238000"
  },
  {
    "text": "like for example figure out your GPS location etc etc now for the framework",
    "start": "1238000",
    "end": "1243360"
  },
  {
    "text": "to be able to get a job done it needs to talk to the libraries right it needs some kind of backing from the Native",
    "start": "1243360",
    "end": "1249600"
  },
  {
    "text": "Native codebase um and and those libraries in turn then sometimes need to",
    "start": "1249600",
    "end": "1255720"
  },
  {
    "text": "talk to the actual Hardware by connecting to the to to to you know the drivers and things of that nature so",
    "start": "1255720",
    "end": "1262200"
  },
  {
    "text": "that's just how the stack what the stack looks like that's our standard sort of um Android stack now what I want to get",
    "start": "1262200",
    "end": "1268880"
  },
  {
    "text": "into is talking a little bit about the interaction uh between the various",
    "start": "1268880",
    "end": "1275000"
  },
  {
    "start": "1270000",
    "end": "1295000"
  },
  {
    "text": "layers of the stack um so what's interesting to us so you know this is not a conversation so",
    "start": "1275000",
    "end": "1281480"
  },
  {
    "text": "much about writing apps right that was the The Talk yesterday um but what's interesting to us is how the various",
    "start": "1281480",
    "end": "1288279"
  },
  {
    "text": "part parts of the system actually communicate um across these boundaries right across these various uh boxes and",
    "start": "1288279",
    "end": "1295799"
  },
  {
    "start": "1295000",
    "end": "1410000"
  },
  {
    "text": "and keep in mind while my stack looks really nice here right everything is",
    "start": "1295799",
    "end": "1301080"
  },
  {
    "text": "like ideal you know ideally sort of segregated and and comp put in",
    "start": "1301080",
    "end": "1306919"
  },
  {
    "text": "compartments and and such um on you know when you look at the actual source code it's not quite like that so things are",
    "start": "1306919",
    "end": "1313039"
  },
  {
    "text": "much more mixed together so um it's it you know the picture looks nice but it's",
    "start": "1313039",
    "end": "1318080"
  },
  {
    "text": "not like that on the on the code basee um so what happens is in terms of this",
    "start": "1318080",
    "end": "1325120"
  },
  {
    "text": "interaction between uh parts of the layer different parts of the of the stack is we essentially need to uh cross",
    "start": "1325120",
    "end": "1333000"
  },
  {
    "text": "couple of boundaries right so on one hand this part here of the stack is",
    "start": "1333000",
    "end": "1338400"
  },
  {
    "text": "mostly Java all right and this part of the stack here is mostly C code so one",
    "start": "1338400",
    "end": "1345159"
  },
  {
    "text": "one one boundary that we have to kind of bridge is is this one here",
    "start": "1345159",
    "end": "1351159"
  },
  {
    "text": "right the second the second issue that we have is when we want to have one",
    "start": "1351159",
    "end": "1356760"
  },
  {
    "text": "application talk to another application remember how we said in Android each app is sort of an island on its own right",
    "start": "1356760",
    "end": "1363200"
  },
  {
    "text": "it's a separate Linux process with it separate uid separate permissions everything separate right so if",
    "start": "1363200",
    "end": "1369919"
  },
  {
    "text": "basically if you want to if you want to have one part one application talk to another application we basically need to",
    "start": "1369919",
    "end": "1377440"
  },
  {
    "text": "be able to communicate from one process so I'll call it process one to another process I'll call it process two right",
    "start": "1377440",
    "end": "1384400"
  },
  {
    "text": "okay so those are sort of the two main U main boundaries that we kind of got to",
    "start": "1384400",
    "end": "1389520"
  },
  {
    "text": "understand how to how to bridge um because everything else is you know boils down to Java and C which",
    "start": "1389520",
    "end": "1396360"
  },
  {
    "text": "presumably you guys know so I'm not going to you know worry about that too much but uh what's interesting to us is",
    "start": "1396360",
    "end": "1402159"
  },
  {
    "text": "how to make this communication across the uh the world of java and the world of c and process one to process two",
    "start": "1402159",
    "end": "1409480"
  },
  {
    "text": "so that's where the the the layer interaction basically comes in and there are different ways to do that and uh",
    "start": "1409480",
    "end": "1415320"
  },
  {
    "start": "1410000",
    "end": "1510000"
  },
  {
    "text": "what I'm going to do is I'm going to just show you a couple of scenarios uh for a couple of different Frameworks that exist in the system right now so",
    "start": "1415320",
    "end": "1422080"
  },
  {
    "text": "this is courtesy of U you know source.android.com um and the actual what's in the boxes",
    "start": "1422080",
    "end": "1428640"
  },
  {
    "text": "doesn't really matter that much don't don't get stuck on details too much at this point but basically for example",
    "start": "1428640",
    "end": "1434320"
  },
  {
    "text": "this is the audio framework this is how you you you write an app you say I want to play a song right like I want to play",
    "start": "1434320",
    "end": "1440679"
  },
  {
    "text": "a you know music and uh what happens what happens next is your your code is",
    "start": "1440679",
    "end": "1449120"
  },
  {
    "text": "probably interacting with the media player which is what you would find in the application framework right that's",
    "start": "1449120",
    "end": "1455640"
  },
  {
    "text": "that's what you program against that's what you use now this is the world of java now to to cross over to the world",
    "start": "1455640",
    "end": "1462240"
  },
  {
    "text": "of C we use something called jni Java native interface right so that is",
    "start": "1462240",
    "end": "1467799"
  },
  {
    "text": "basically our bridge to the world of C code which is basically everything below",
    "start": "1467799",
    "end": "1473720"
  },
  {
    "text": "roughly this line um and so media player is communicating to a media player",
    "start": "1473720",
    "end": "1479840"
  },
  {
    "text": "counterpart in in C so this would be the the C implementation of um of of that",
    "start": "1479840",
    "end": "1485480"
  },
  {
    "text": "you know of of that code basically the native supporting the native uh methods in in the Java code that in turn May",
    "start": "1485480",
    "end": "1493399"
  },
  {
    "text": "load up some libraries the C libraries that in turn May then commun unate",
    "start": "1493399",
    "end": "1498720"
  },
  {
    "text": "eventually to some kind of um audio driver so so what we're using here is",
    "start": "1498720",
    "end": "1504880"
  },
  {
    "text": "basically we're using jni to cross from the world of java to the world of C okay um so this is just one scenario",
    "start": "1504880",
    "end": "1513399"
  },
  {
    "text": "right so another scenario is the camera um uh and video framework so it's a",
    "start": "1513399",
    "end": "1518799"
  },
  {
    "text": "little more involved uh but basically what I wanted to point out here is that um unlike just a media um media uh",
    "start": "1518799",
    "end": "1527000"
  },
  {
    "text": "playing music which is more or like less just a uh um a set of libraries when it comes to um for example camera we",
    "start": "1527000",
    "end": "1534200"
  },
  {
    "text": "actually have a camera service running so camera service is now example of that",
    "start": "1534200",
    "end": "1539279"
  },
  {
    "text": "something that is running in a totally different process right so we have a we have now the problem of bridging process",
    "start": "1539279",
    "end": "1546440"
  },
  {
    "text": "one to process two communication right and what we're doing in this case is we're using something called a binder",
    "start": "1546440",
    "end": "1552080"
  },
  {
    "text": "IPC mechanism binder interpress communication mechanism to to go from one process to another process okay so",
    "start": "1552080",
    "end": "1560919"
  },
  {
    "text": "that's um that's that's basically the Android specific way of doing that of course you can do you know you can just",
    "start": "1560919",
    "end": "1566880"
  },
  {
    "text": "open up a socket there are many different ways you can communicate between multiple processes but what",
    "start": "1566880",
    "end": "1572399"
  },
  {
    "text": "Android brings to the table that's sort of new is the um is the binder IPC",
    "start": "1572399",
    "end": "1577880"
  },
  {
    "text": "mechanism so what what what that looks like now basically let me show you a big",
    "start": "1577880",
    "end": "1583799"
  },
  {
    "start": "1580000",
    "end": "1620000"
  },
  {
    "text": "stack picture so basically what we have here is we're going to have the binder",
    "start": "1583799",
    "end": "1589240"
  },
  {
    "text": "to bridge this and we're going to have jni to bridge that right so that's",
    "start": "1589240",
    "end": "1594320"
  },
  {
    "text": "essentially what those are the two tools that we have at our disposal when it comes to working with the entire stack",
    "start": "1594320",
    "end": "1600760"
  },
  {
    "text": "with looking at all the bits and pieces of the stack does that so far makes",
    "start": "1600760",
    "end": "1605840"
  },
  {
    "text": "sense any questions on that",
    "start": "1605840",
    "end": "1610880"
  },
  {
    "text": "yeah U I believe it's in C Level as well yeah we're going to do an example with",
    "start": "1611799",
    "end": "1617279"
  },
  {
    "text": "the Java version version of it but uh the the B the binder is implemented in see yeah um so let me um so let's start",
    "start": "1617279",
    "end": "1626200"
  },
  {
    "start": "1620000",
    "end": "1765000"
  },
  {
    "text": "any other let's start then with the jni how many of you actually used jni before okay most of you all right so um great",
    "start": "1626200",
    "end": "1634080"
  },
  {
    "text": "so jni is basically a Java native interface is just a Java thing right it's it's a con uh it's nothing nothing",
    "start": "1634080",
    "end": "1640520"
  },
  {
    "text": "more than a convention on how we're going to name things in C so that Java",
    "start": "1640520",
    "end": "1645760"
  },
  {
    "text": "knows how to call it and how we're going to call from C back to Java so essentially it's it's just a naming",
    "start": "1645760",
    "end": "1651159"
  },
  {
    "text": "convention to to facilitate that um what's important to kind of understand is that jni code in other words your C",
    "start": "1651159",
    "end": "1658080"
  },
  {
    "text": "code uh native code still runs on top of the same Java virtual machine or the same VM that that your Java code runs on",
    "start": "1658080",
    "end": "1665559"
  },
  {
    "text": "top of as well so um this is what you would typically do when you're doing",
    "start": "1665559",
    "end": "1672159"
  },
  {
    "text": "something with some jni code U there's nothing really um Android specific in",
    "start": "1672159",
    "end": "1677559"
  },
  {
    "text": "here right so this is just a plain old Java so you write Java source code you compile it you get a class",
    "start": "1677559",
    "end": "1683960"
  },
  {
    "text": "file that class file goes on top of the virtual machine and that's where it gets interpreted if there's anything declared",
    "start": "1683960",
    "end": "1690360"
  },
  {
    "text": "native in that class file you compile it with Java AG uh- jni which is the tool",
    "start": "1690360",
    "end": "1695799"
  },
  {
    "text": "that comes with the jdk all right and that produces a header file this is your H file and then what you do is you",
    "start": "1695799",
    "end": "1702480"
  },
  {
    "text": "implement that header file in C you link everything you compile it you get your",
    "start": "1702480",
    "end": "1707640"
  },
  {
    "text": "Dynamics Library dooo file right and that Dynamic Library gets eventually",
    "start": "1707640",
    "end": "1713440"
  },
  {
    "text": "loaded by the V VM so essentially when Java wants to call C or C wants to call",
    "start": "1713440",
    "end": "1718720"
  },
  {
    "text": "Java it doesn't it doesn't work like this it actually works like this so the the Java code goes to the VM and the VM",
    "start": "1718720",
    "end": "1725399"
  },
  {
    "text": "loads the library and talks to it right so so that's sort of uh that's sort of how it happens in the world of",
    "start": "1725399",
    "end": "1732200"
  },
  {
    "text": "J and the same yes yes so for our purposes so for",
    "start": "1732200",
    "end": "1737799"
  },
  {
    "text": "our purposes so far everything is the same yeah you know in doic and in Java so I'm kind of using those terms",
    "start": "1737799",
    "end": "1743840"
  },
  {
    "text": "interchangeably um because there's nothing really too specific about it",
    "start": "1743840",
    "end": "1749679"
  },
  {
    "text": "so uh which tools oh Java so Java age is just a",
    "start": "1751799",
    "end": "1757360"
  },
  {
    "text": "standard Java tool there's really nothing uh so that as I said it ships with the jdk so you guys should have it",
    "start": "1757360",
    "end": "1763039"
  },
  {
    "text": "as part of jdk java development kit um yeah so so far this is just a play Old",
    "start": "1763039",
    "end": "1768559"
  },
  {
    "start": "1765000",
    "end": "1960000"
  },
  {
    "text": "Java um now the next topic is basically something called native development kit",
    "start": "1768559",
    "end": "1774600"
  },
  {
    "text": "anybody played played around with NK couple of you cool so um so ndk um NK",
    "start": "1774600",
    "end": "1781519"
  },
  {
    "text": "brings couple of um makes life simpler brings couple things to the table um so here some things that NK brings to the",
    "start": "1781519",
    "end": "1788640"
  },
  {
    "text": "table so for one it provides the entire tool chain uh to compile your code right",
    "start": "1788640",
    "end": "1794919"
  },
  {
    "text": "so when you're compiling your Nate your C code you are compiling it for the",
    "start": "1794919",
    "end": "1800120"
  },
  {
    "text": "platform that you're that you know the device platform so in other words arm most likely right or",
    "start": "1800120",
    "end": "1806519"
  },
  {
    "text": "x86 so finding those setting up those cross compilers can be very painful I",
    "start": "1806519",
    "end": "1812120"
  },
  {
    "text": "did some of this before andk got released and it's one of those things that takes you know a lot of time",
    "start": "1812120",
    "end": "1818200"
  },
  {
    "text": "unnecessarily so ndk solves that entire problem by providing the tool chain you know nicely",
    "start": "1818200",
    "end": "1825080"
  },
  {
    "text": "packaged secondly what ndk also provides is u a way to package uh the the",
    "start": "1825080",
    "end": "1832200"
  },
  {
    "text": "libraries with the w with the APK file itself so in other",
    "start": "1832200",
    "end": "1838519"
  },
  {
    "text": "words if um I don't know if you guys noticed but in the uh in the init C file",
    "start": "1838519",
    "end": "1845559"
  },
  {
    "text": "which um let me see why it's so slow okay in",
    "start": "1845559",
    "end": "1851760"
  },
  {
    "text": "the NC file we specify at the top uh the environment",
    "start": "1851760",
    "end": "1858159"
  },
  {
    "text": "and the only thing that we have in the environment as the in the LD Library path is the system lip folder oh there's",
    "start": "1858159",
    "end": "1864440"
  },
  {
    "text": "also the vendor lip but that's besides the point so system lab folder is the only place so in other words if you look",
    "start": "1864440",
    "end": "1869559"
  },
  {
    "text": "at the file system of the device which I'm just going to pop pull up here so if",
    "start": "1869559",
    "end": "1875200"
  },
  {
    "text": "I look at the device file system this is the only place where uh this is the",
    "start": "1875200",
    "end": "1880760"
  },
  {
    "text": "place where all the SOS go all the libraries now the problem with this place is that it's on a read only file",
    "start": "1880760",
    "end": "1886399"
  },
  {
    "text": "system right so it's not a problem if you're building a custom arm you can easily put stuff in here but if you want",
    "start": "1886399",
    "end": "1892360"
  },
  {
    "text": "to have a native code that ships with your um with your application uh this",
    "start": "1892360",
    "end": "1897639"
  },
  {
    "text": "this is not a place you can put it so that's the problem um the solution to that problem is to basically put the U",
    "start": "1897639",
    "end": "1904240"
  },
  {
    "text": "the library um your library alongside with your application so it basically",
    "start": "1904240",
    "end": "1909760"
  },
  {
    "text": "goes into the app specific sandbox file system directory right so each app as",
    "start": "1909760",
    "end": "1915760"
  },
  {
    "text": "you probably know puts has a SL SL data slit sandbox so for example I think it's",
    "start": "1915760",
    "end": "1922399"
  },
  {
    "text": "I think this is the one that I'm using right now so this is a Sandbox for this particular application and the the file",
    "start": "1922399",
    "end": "1929159"
  },
  {
    "text": "goes into this folder right so so that to me that's a big deal because it it solves the the distribution issue so now",
    "start": "1929159",
    "end": "1936240"
  },
  {
    "text": "you can put your native code in your app in your app and you can distribute your app through the market to you know",
    "start": "1936240",
    "end": "1942039"
  },
  {
    "text": "everyone as opposed to having to you know create a custom custom ROM uh",
    "start": "1942039",
    "end": "1947960"
  },
  {
    "text": "distributor code so so that's a big deal uh it also provides a set of um header",
    "start": "1947960",
    "end": "1954000"
  },
  {
    "text": "files that are standardized and it also provide samples and the documentation for that um so in terms of um the ndk um",
    "start": "1954000",
    "end": "1963559"
  },
  {
    "start": "1960000",
    "end": "2070000"
  },
  {
    "text": "why would you care about it why would you use it right we're we're still talking about the application development with native code so why why",
    "start": "1963559",
    "end": "1971080"
  },
  {
    "text": "even go into C uh real so one of the reason the main the main reason for that is performance really um and ndk is sort",
    "start": "1971080",
    "end": "1978440"
  },
  {
    "text": "of developed in my mind with the motivation for to support games right so that's why a lot of um a lot of sort of",
    "start": "1978440",
    "end": "1985080"
  },
  {
    "text": "standard headers have to do with for example math um Graphics that sort of",
    "start": "1985080",
    "end": "1991279"
  },
  {
    "text": "stuff right so it's really um for for things that are computationally",
    "start": "1991279",
    "end": "1996320"
  },
  {
    "text": "intensive uh people use it for uh for different purposes as well you may have Legacy code um some C libraries that you",
    "start": "1996320",
    "end": "2003559"
  },
  {
    "text": "want to include as part of your project and you just don't have time to convert or don't have interest in converting it to Java so in that case you can just",
    "start": "2003559",
    "end": "2010159"
  },
  {
    "text": "basically wrap it in in a with a jni interface um so those are some",
    "start": "2010159",
    "end": "2015639"
  },
  {
    "text": "motivations what uh keep in mind that your youro library is still going to be",
    "start": "2015639",
    "end": "2022320"
  },
  {
    "text": "sandboxed inside of the same process as uh the rest of your application so",
    "start": "2022320",
    "end": "2028240"
  },
  {
    "text": "having something in C C++ it doesn't mean that it's going to be able to accomplish uh from security standpoint",
    "start": "2028240",
    "end": "2034120"
  },
  {
    "text": "anything more than Java can do right yeah um so what about the flash plugin",
    "start": "2034120",
    "end": "2039799"
  },
  {
    "text": "I'm I'm not I I'm not sure um you could uh put your library on the SD card if",
    "start": "2039799",
    "end": "2045960"
  },
  {
    "text": "you want to manually manage uh where you you you put the library and then load it",
    "start": "2045960",
    "end": "2051960"
  },
  {
    "text": "from that place U so you could basically manually manage the the location of files and load them you know explicitly",
    "start": "2051960",
    "end": "2059480"
  },
  {
    "text": "but um what ndk does is sort of removes that responsibility you don't have to worry about it you just create a library",
    "start": "2059480",
    "end": "2066398"
  },
  {
    "text": "and you're done with it yeah um and uh so so that's basically uh",
    "start": "2066399",
    "end": "2074240"
  },
  {
    "start": "2070000",
    "end": "2210000"
  },
  {
    "text": "the motivation for ndk and why you would care about that so the uh the steps to",
    "start": "2074240",
    "end": "2081440"
  },
  {
    "text": "toate to using ndk as sort of I sort of outlin them here like this so basically what happens is you",
    "start": "2081440",
    "end": "2088679"
  },
  {
    "text": "write some kind of Library your Java library and you may leave certain methods declared native right meaning",
    "start": "2088679",
    "end": "2095560"
  },
  {
    "text": "you're not implementing them in Java you're just saying ink there shall be a method implemented somewhere natively um",
    "start": "2095560",
    "end": "2101760"
  },
  {
    "text": "you compile your Java you get your Java class file no big deal there um but then what you do is you recompile your class",
    "start": "2101760",
    "end": "2108839"
  },
  {
    "text": "file or you apply Java age um to your class file to get the header file so",
    "start": "2108839",
    "end": "2114760"
  },
  {
    "text": "this is again yourage file now what you do is you implement",
    "start": "2114760",
    "end": "2120000"
  },
  {
    "text": "that in C so you write C code to to implement the uh the actual uh header",
    "start": "2120000",
    "end": "2125280"
  },
  {
    "text": "file you create a make file um and and you compile everything into the doso",
    "start": "2125280",
    "end": "2130320"
  },
  {
    "text": "file so this is now um you know dynamically this is now linked um from",
    "start": "2130320",
    "end": "2135880"
  },
  {
    "text": "java to Theo right and then you write your application that actually uses that",
    "start": "2135880",
    "end": "2141560"
  },
  {
    "text": "so the application is no longer concerned with the fact that some parts of of that Library are actually",
    "start": "2141560",
    "end": "2147400"
  },
  {
    "text": "implemented in C yeah uh so about the sandboxing so this is the pro this would this would be the process right so in so",
    "start": "2147400",
    "end": "2154520"
  },
  {
    "text": "this is the an application process it got it's got its own like Library it's",
    "start": "2154520",
    "end": "2159680"
  },
  {
    "text": "got its own uh the doic virtual machine it loads what I call the building blocks or components so these are your services",
    "start": "2159680",
    "end": "2166560"
  },
  {
    "text": "activities providers receivers um so all that is part of a your application",
    "start": "2166560",
    "end": "2172880"
  },
  {
    "text": "context right your application",
    "start": "2172880",
    "end": "2176559"
  },
  {
    "text": "so well it's the dvic so dvic virtual machine loads up the library right just",
    "start": "2178200",
    "end": "2184359"
  },
  {
    "text": "like the Java virtual machine loads up the library so so that's it gets loaded by the VM so VM actually communicates to",
    "start": "2184359",
    "end": "2191119"
  },
  {
    "text": "the library so the VM is the one that resolves your calls to Native so when I",
    "start": "2191119",
    "end": "2197000"
  },
  {
    "text": "say when my Java code says I want to call native code the VM actually resolves that in to to the actual cc++",
    "start": "2197000",
    "end": "2204200"
  },
  {
    "text": "implementation of that yeah so we're going to see this in in code uh",
    "start": "2204200",
    "end": "2210359"
  },
  {
    "start": "2210000",
    "end": "2340000"
  },
  {
    "text": "shortly so so this is basically the steps you know sort of like in lines and",
    "start": "2210359",
    "end": "2216280"
  },
  {
    "text": "circles so here's what the I'm going to show you an example that I typically build and it's basically a uh I was",
    "start": "2216280",
    "end": "2222000"
  },
  {
    "text": "looking for an example that I can really quickly do very in both in C and Java",
    "start": "2222000",
    "end": "2227319"
  },
  {
    "text": "something that has a very simple algorithm um and something that kind of you know gets",
    "start": "2227319",
    "end": "2232760"
  },
  {
    "text": "slower really quickly gets really slow right so Fibonacci is perfect for that",
    "start": "2232760",
    "end": "2237800"
  },
  {
    "text": "um so Fibonacci again is just Fibonacci of zero is zero Fibonacci of one is one",
    "start": "2237800",
    "end": "2244000"
  },
  {
    "text": "and then it's a recursive formula so Fibonacci of n is Fibonacci van minus one plus Fibonacci van minus 2 right so",
    "start": "2244000",
    "end": "2250520"
  },
  {
    "text": "it gives you this this kind of sequence um so what I wanted to do is I wanted to build an application um and I wanted to",
    "start": "2250520",
    "end": "2257400"
  },
  {
    "text": "basically use both um both algorithms and see what the speed difference is and",
    "start": "2257400",
    "end": "2263079"
  },
  {
    "text": "these are roughly the steps uh but let me show you that in code instead so um",
    "start": "2263079",
    "end": "2269119"
  },
  {
    "text": "so you have this little uh hold on let me close let's start uh like this so I have this little application here um and",
    "start": "2269119",
    "end": "2276480"
  },
  {
    "text": "typically what I would start what is writing the Java Library so this is a just a plain old uh you know Java code",
    "start": "2276480",
    "end": "2284000"
  },
  {
    "text": "it's got nothing Android is in it right so I have a this is my simple",
    "start": "2284000",
    "end": "2290440"
  },
  {
    "text": "implementation of Fibonacci in Java right um",
    "start": "2290440",
    "end": "2296000"
  },
  {
    "text": "recursive I also uh included a one of the everything that can be done recursively can be done non- recursively",
    "start": "2296000",
    "end": "2303000"
  },
  {
    "text": "as well so this is one of the iterative implementations of the same algorithm",
    "start": "2303000",
    "end": "2308079"
  },
  {
    "text": "right um so now so that's basically my my Java code now for my native code what",
    "start": "2308079",
    "end": "2314440"
  },
  {
    "text": "I did is I simply said I declared it you know here and I said it's native so in",
    "start": "2314440",
    "end": "2319599"
  },
  {
    "text": "other words look for it elsewhere right so my native version of of uh the",
    "start": "2319599",
    "end": "2326319"
  },
  {
    "text": "Fibonacci is recursive is going to be is declared here and dative version is declared here I also need to make sure",
    "start": "2326319",
    "end": "2333400"
  },
  {
    "text": "that I load a library where this is actually going to be um located right so that's the first step",
    "start": "2333400",
    "end": "2341480"
  },
  {
    "start": "2340000",
    "end": "2576000"
  },
  {
    "text": "that's that's that roughly corresponds to to this here right so we wrote the",
    "start": "2341480",
    "end": "2346920"
  },
  {
    "text": "native Library um and stuff right so now what we need to do is we need to use Java h- jni now this is one of those",
    "start": "2346920",
    "end": "2354319"
  },
  {
    "text": "things that eclipse is not um automating these steps yet I know people are",
    "start": "2354319",
    "end": "2359800"
  },
  {
    "text": "working on that uh but so we kind of have to do a couple of steps manually but it's not too bad so what I'm going",
    "start": "2359800",
    "end": "2366920"
  },
  {
    "text": "to do is I'm going to uh go to my my uh my command",
    "start": "2366920",
    "end": "2373000"
  },
  {
    "text": "prompt um and I'm going to go to my uh my workspace uh Fibonacci I'm going to",
    "start": "2373000",
    "end": "2379200"
  },
  {
    "text": "go to the bin folder right because that's where my class files are so from here instead of changing the class path",
    "start": "2379200",
    "end": "2386040"
  },
  {
    "text": "so from here I can say Java h- jni and I can say I want to I want to apply it",
    "start": "2386040",
    "end": "2392280"
  },
  {
    "text": "against that class so com Maracana um and then Feb",
    "start": "2392280",
    "end": "2398480"
  },
  {
    "text": "right so what what this tool does is it basically analyzes the class and uh",
    "start": "2398480",
    "end": "2404800"
  },
  {
    "text": "anything that's declared native it takes that into account and creates a corresponding header file so what's what",
    "start": "2404800",
    "end": "2411079"
  },
  {
    "text": "we got here is is this file uh the header file right now this header file",
    "start": "2411079",
    "end": "2416920"
  },
  {
    "text": "doesn't really belong in the bin folder uh so one of the one of the ways",
    "start": "2416920",
    "end": "2422280"
  },
  {
    "text": "that you know I usually organize this and it seems like everyone else does as well is create create a jni folder that",
    "start": "2422280",
    "end": "2429280"
  },
  {
    "text": "hangs off of your project so this you know top level jni folder and and put all the all the C native related code in",
    "start": "2429280",
    "end": "2437839"
  },
  {
    "text": "in in this folder so I'm going to CD into that I'm going to actually move this file so comore 2 jni folder I'm",
    "start": "2437839",
    "end": "2447240"
  },
  {
    "text": "going to CD to to jni folder um and so that's that's where we",
    "start": "2447240",
    "end": "2453319"
  },
  {
    "text": "have that file now so that file looks like this so This is the standard jni",
    "start": "2453319",
    "end": "2459839"
  },
  {
    "text": "file um and Let me refresh it so this is that file that",
    "start": "2459839",
    "end": "2466560"
  },
  {
    "text": "got automatically generated um the only things that you really care about in",
    "start": "2466560",
    "end": "2471800"
  },
  {
    "text": "this file are this signatures right so these are the method signatures that correspond to things that were declared",
    "start": "2471800",
    "end": "2477839"
  },
  {
    "text": "native so in other words when we said here I want to have uh FIB n for FIB",
    "start": "2477839",
    "end": "2485079"
  },
  {
    "text": "native be declared uh declared native right so the jni notice that this method",
    "start": "2485079",
    "end": "2490960"
  },
  {
    "text": "is going to be declared native since this method is in a class called com. Marana fiib right and the method name is",
    "start": "2490960",
    "end": "2499640"
  },
  {
    "text": "fib n that's why we have such a long function name now so it's Java comar on",
    "start": "2499640",
    "end": "2505240"
  },
  {
    "text": "of fiip FIB right um and these are the standard exports this is the uh the return type",
    "start": "2505240",
    "end": "2512800"
  },
  {
    "text": "so Jong so basically J and I standardizes the on the types uh since C",
    "start": "2512800",
    "end": "2519319"
  },
  {
    "text": "doesn't really have a standard so uh just to align it with with a Java primitive type size um and so this is",
    "start": "2519319",
    "end": "2527560"
  },
  {
    "text": "our return type and this is our input uh the the end that we're inputting into the into the function now these two uh",
    "start": "2527560",
    "end": "2536119"
  },
  {
    "text": "uh variables are always going to be there um basically JN I andv refers to",
    "start": "2536119",
    "end": "2541480"
  },
  {
    "text": "the environment itself in other words the virtual machine in j class which could be J",
    "start": "2541480",
    "end": "2547440"
  },
  {
    "text": "object if I had it non declared static so the fact that I have it declared static gives us a reference back to a",
    "start": "2547440",
    "end": "2554599"
  },
  {
    "text": "class as opposed to the instance of a class in other words object so that so this second parameter is either going to",
    "start": "2554599",
    "end": "2560000"
  },
  {
    "text": "be a j class or a j object in this case a class uh that refers to the class that",
    "start": "2560000",
    "end": "2565079"
  },
  {
    "text": "that that called it in the first place right um so so that's basically the",
    "start": "2565079",
    "end": "2570400"
  },
  {
    "text": "signature of the that got generated by jni uh Java Java H uh",
    "start": "2570400",
    "end": "2575800"
  },
  {
    "text": "tool so at this point we have the header file right our so we didn't write it we",
    "start": "2575800",
    "end": "2581839"
  },
  {
    "text": "just got it autogenerated our next job is to basically Implement that that header file so we're",
    "start": "2581839",
    "end": "2588319"
  },
  {
    "text": "only writing these files right this is the only thing the only things that we're really implementing and also of",
    "start": "2588319",
    "end": "2593559"
  },
  {
    "text": "course something that's using it so the C code for this uh the C",
    "start": "2593559",
    "end": "2598720"
  },
  {
    "text": "implementation of this is fairly straightforward so what you do first is you make sure you include that header",
    "start": "2598720",
    "end": "2604960"
  },
  {
    "text": "file right um and then then you basically copy paste the head the the",
    "start": "2604960",
    "end": "2611160"
  },
  {
    "text": "signatures of your methods so there's my method one and Method Function One function to right and then you implement",
    "start": "2611160",
    "end": "2617880"
  },
  {
    "text": "so in this case I'm implementing by calling the local U functions which is basically the copy paste of the the same",
    "start": "2617880",
    "end": "2625520"
  },
  {
    "text": "algorithm as we have in Java right so this is our Fibonacci you know just Fibonacci recursive here and Fibonacci",
    "start": "2625520",
    "end": "2633119"
  },
  {
    "text": "non non- recursive here right so it's the same same code we're going to run the same algorithm both in natively and",
    "start": "2633119",
    "end": "2640960"
  },
  {
    "text": "in and in Java so at this point um at this point we have the same implementation of those things that were",
    "start": "2640960",
    "end": "2647119"
  },
  {
    "text": "declared native so the only thing that's missing is the make file the make file looks like this um I usually just copy",
    "start": "2647119",
    "end": "2654720"
  },
  {
    "text": "paste it from one of the samples um um that come with the ndk um so that's",
    "start": "2654720",
    "end": "2660240"
  },
  {
    "text": "that's simpler simplest way to to create your make file alternatively if you want to read about make files and so on um",
    "start": "2660240",
    "end": "2666400"
  },
  {
    "text": "I'm not sure if I'm online but um source. Android I'm not going to do that",
    "start": "2666400",
    "end": "2671559"
  },
  {
    "text": "right now uh source.android.com under poring there's the build system is explained and there's a link for uh",
    "start": "2671559",
    "end": "2678440"
  },
  {
    "text": "there's a cookbook uh that expl you know gives you common make files uh for you",
    "start": "2678440",
    "end": "2684119"
  },
  {
    "text": "know basic stuff um so that's another place to kind of uh look look at the how",
    "start": "2684119",
    "end": "2689160"
  },
  {
    "text": "to how to put it together so once once you have basically the header file the",
    "start": "2689160",
    "end": "2694240"
  },
  {
    "text": "its implementation and the make file um all you have to do is you have to build",
    "start": "2694240",
    "end": "2699280"
  },
  {
    "text": "it so you do that by simply doing ndk build and that's going to take the make",
    "start": "2699280",
    "end": "2706000"
  },
  {
    "text": "file read it compile everything and create the so file so this is the this is you know the the cross compiler and",
    "start": "2706000",
    "end": "2713280"
  },
  {
    "text": "everything happens in in here right so this is dramatically simpler than if you",
    "start": "2713280",
    "end": "2719559"
  },
  {
    "text": "were to set up your own tool chain and and worry about all the all the details of of combining all this so ndk build",
    "start": "2719559",
    "end": "2726720"
  },
  {
    "text": "just does a lot of good stuff behind the scenes yeah that's I just learned about",
    "start": "2726720",
    "end": "2733319"
  },
  {
    "text": "that so the motod dev Team U apparent apparently created the integration for",
    "start": "2733319",
    "end": "2739200"
  },
  {
    "text": "ndk into eclipse and right now it's available as part of a sequ project which is a separate download uh into",
    "start": "2739200",
    "end": "2745520"
  },
  {
    "text": "Eclipse so you guys can look it up so I haven't played with it but apparently it does uh it does a lot of this sort of",
    "start": "2745520",
    "end": "2751800"
  },
  {
    "text": "manual steps that I outlined here uh it's been on so at some point it's going to be control L to save it and",
    "start": "2751800",
    "end": "2757440"
  },
  {
    "text": "everything gets rebuilt um um as well just like Java does so yeah that's great",
    "start": "2757440",
    "end": "2763880"
  },
  {
    "text": "um so so at this point what happened is we",
    "start": "2763880",
    "end": "2769160"
  },
  {
    "start": "2765000",
    "end": "3066000"
  },
  {
    "text": "basically Got U the library um directory created here and so this is new so this",
    "start": "2769160",
    "end": "2775400"
  },
  {
    "text": "is the output of of and of ndk build U there's also the obj folder which is the",
    "start": "2775400",
    "end": "2782160"
  },
  {
    "text": "the intermediary files um but the final library is right here",
    "start": "2782160",
    "end": "2788079"
  },
  {
    "text": "right so when we when we push this application when we install it onto the device like as you as you saw it it ends",
    "start": "2788079",
    "end": "2795440"
  },
  {
    "text": "up in the SL dat dat your appls folder right so that's why it's going to be",
    "start": "2795440",
    "end": "2801359"
  },
  {
    "text": "located so what I'm going to do next is I'm going to run this uh this application I also have a uh you know",
    "start": "2801359",
    "end": "2807280"
  },
  {
    "text": "the activity that goes along with that um in other words something that uses um this code but I'm not going to discuss",
    "start": "2807280",
    "end": "2813920"
  },
  {
    "text": "that because it's not really a topic of this conversation it's how to write applications just a standard activity so",
    "start": "2813920",
    "end": "2820559"
  },
  {
    "text": "I'm going to run this I'm going to run it on the emulator first and um let me rotate it um so that",
    "start": "2820559",
    "end": "2828520"
  },
  {
    "text": "it fits better let's see if it's",
    "start": "2828520",
    "end": "2834760"
  },
  {
    "text": "going okay so it's coming up um so I have it um here so basically what I can",
    "start": "2839200",
    "end": "2845680"
  },
  {
    "text": "do is I can enter some kind Co some some number for my Fibonacci Sequence uh we can start with something small like 20",
    "start": "2845680",
    "end": "2852839"
  },
  {
    "text": "23 click on go and so these are the results that that I got so basically the",
    "start": "2852839",
    "end": "2859240"
  },
  {
    "text": "the doic recursive version took about um",
    "start": "2859240",
    "end": "2864599"
  },
  {
    "text": "sorry that this is the result which is should be equal right and it's not interesting to us too much but what what",
    "start": "2864599",
    "end": "2871240"
  },
  {
    "text": "what is interesting is the actual time so what we're comparing is the doic recursive to Native recursive",
    "start": "2871240",
    "end": "2878960"
  },
  {
    "text": "right yeah so so that's that's one interesting number and the second interesting number is uh the uh this",
    "start": "2878960",
    "end": "2885480"
  },
  {
    "text": "number here which is basically the the iterative version of dvic versus the native U um iterative version of of the",
    "start": "2885480",
    "end": "2893680"
  },
  {
    "text": "same algorithm right yes so I timed uh the iterative",
    "start": "2893680",
    "end": "2898760"
  },
  {
    "text": "algorithm is substantially faster so if you time it in milliseconds you're going to get like rounding errors it's going",
    "start": "2898760",
    "end": "2904440"
  },
  {
    "text": "to be like either zero or one um so I Chang it to nanc U first one micro or",
    "start": "2904440",
    "end": "2911000"
  },
  {
    "text": "the the the first one is micro so it takes takes a long time right so um now",
    "start": "2911000",
    "end": "2916640"
  },
  {
    "text": "what we're really looking for is the order of order of difference right so this is about you know these numbers are",
    "start": "2916640",
    "end": "2924359"
  },
  {
    "text": "fairly are the same order right 62,000 and uh actually they're not um they're",
    "start": "2924359",
    "end": "2932040"
  },
  {
    "text": "different um versus uh the",
    "start": "2932040",
    "end": "2937440"
  },
  {
    "text": "so so apparently it's slower to run it",
    "start": "2937440",
    "end": "2943480"
  },
  {
    "text": "yeah let's go with a number let's go with a larg number like 25 so this what we",
    "start": "2943480",
    "end": "2949240"
  },
  {
    "text": "get right um yeah so the numbers are I mean the Nano timer is not as precise",
    "start": "2949240",
    "end": "2954559"
  },
  {
    "text": "and it's we're going to get much more of a difference between these the the iterative versions but what's",
    "start": "2954559",
    "end": "2960559"
  },
  {
    "text": "interesting is for the recursive version we're consistently going to get about one or order of a magnitude difference",
    "start": "2960559",
    "end": "2966559"
  },
  {
    "text": "right it's going to be 10 20 times slower yeah so so doic is a registry based not",
    "start": "2966559",
    "end": "2973200"
  },
  {
    "text": "stack based so it actually doesn't work very well with stack based applications which recursion is so it's actually the",
    "start": "2973200",
    "end": "2979240"
  },
  {
    "text": "opposite so that my understanding is that um the if you have a code that that",
    "start": "2979240",
    "end": "2986040"
  },
  {
    "text": "uses a lot of recursion uh you're you're you're not you're not going to get a good performance from delic and it's",
    "start": "2986040",
    "end": "2992160"
  },
  {
    "text": "also not something that a just in time compiler can kick in and and optim and help out with right so that's my",
    "start": "2992160",
    "end": "2999079"
  },
  {
    "text": "understanding of it now when it comes to iterative uh thejus in time compiler can actually optimize your code and the the",
    "start": "2999079",
    "end": "3006000"
  },
  {
    "text": "performance is going to get about the same right very quickly uh but there's obviously a certain cost involved with",
    "start": "3006000",
    "end": "3013480"
  },
  {
    "text": "jni Bridge as well so that's why native version may actually appear to run",
    "start": "3013480",
    "end": "3019079"
  },
  {
    "text": "slower just because we're timing it from java we're timing the actual bridge over to Native and then the results back so",
    "start": "3019079",
    "end": "3025960"
  },
  {
    "text": "uh so those two are sort of you know the toss time spend native has to be worth",
    "start": "3025960",
    "end": "3031760"
  },
  {
    "text": "your exactly the time spend native has to be worth worth it while um",
    "start": "3031760",
    "end": "3038960"
  },
  {
    "text": "yeah uh so does the NK build put the uh does the NK build put the uh lib into",
    "start": "3038960",
    "end": "3047000"
  },
  {
    "text": "into the uh APK no it doesn't it simply puts it into the lips folder and",
    "start": "3047000",
    "end": "3053319"
  },
  {
    "text": "basically when you APK Builder uh is going to put it into the APK once I hit",
    "start": "3053319",
    "end": "3059160"
  },
  {
    "text": "run button right does no the APK Builder",
    "start": "3059160",
    "end": "3064359"
  },
  {
    "text": "doesn't so there's a that's basically a naming convention so this folder lives",
    "start": "3064359",
    "end": "3069680"
  },
  {
    "start": "3066000",
    "end": "3211000"
  },
  {
    "text": "is supposed to be the way it is so if this folder exists with this this naming convention the APK Builder is going to",
    "start": "3069680",
    "end": "3076079"
  },
  {
    "text": "look for this library and going to place it in the proper place uh um the that's",
    "start": "3076079",
    "end": "3081280"
  },
  {
    "text": "basically the the platform that we're so in this case we're building for arm um arm EA",
    "start": "3081280",
    "end": "3087640"
  },
  {
    "text": "exactly so what that's that's a good point so see for example when we install it so if I if I if I built for x86",
    "start": "3087640",
    "end": "3095400"
  },
  {
    "text": "presumably I would have a different subdirectory here as well so since since we're we have a native code we may have",
    "start": "3095400",
    "end": "3102319"
  },
  {
    "text": "multiple versions of the lib the Libo file right and then the proper version",
    "start": "3102319",
    "end": "3108000"
  },
  {
    "text": "is going to get installed is there a tool like Trace view to to for native code um uh not as part of Android so",
    "start": "3108000",
    "end": "3115720"
  },
  {
    "text": "Trace view is driven by dvic so so the information actually come comes from dvic it doesn't come from so we don't",
    "start": "3115720",
    "end": "3121440"
  },
  {
    "text": "you know the C code is a black box in that case uh so Trace view doesn't allow",
    "start": "3121440",
    "end": "3126839"
  },
  {
    "text": "us so it treats native code as blackbox um but um but I you know when I used to",
    "start": "3126839",
    "end": "3133319"
  },
  {
    "text": "do C programming many many many years ago I remember there are tools native to C that that would do that sort of stuff",
    "start": "3133319",
    "end": "3139839"
  },
  {
    "text": "profiling so but not that I know much about that um I so the question is uh",
    "start": "3139839",
    "end": "3145559"
  },
  {
    "text": "you have Theo you install the app but the the the the lip doesn't seem to be there install it",
    "start": "3145559",
    "end": "3152839"
  },
  {
    "text": "again I'm serious I just did that I was couple hours ago when I Was",
    "start": "3152839",
    "end": "3158079"
  },
  {
    "text": "preparing for this and I started from scratch and I was like wait what just happened why is it you know why is it",
    "start": "3158079",
    "end": "3163359"
  },
  {
    "text": "not there and exactly that thing happened and I just ran install again and second time around it worked uh",
    "start": "3163359",
    "end": "3170160"
  },
  {
    "text": "native code debugging uh GDB is there there's a you know ADB supports GDB",
    "start": "3170160",
    "end": "3175319"
  },
  {
    "text": "Bridge so you can you can you can you know use that so so so if",
    "start": "3175319",
    "end": "3180960"
  },
  {
    "text": "another application wants to use the same lab file you U and presumably that's not an application that is",
    "start": "3180960",
    "end": "3186480"
  },
  {
    "text": "written by you so you you can you can put it the same context in other words if if you have two applications that you",
    "start": "3186480",
    "end": "3192520"
  },
  {
    "text": "sign with the same um uh key and they live in the same package then they can",
    "start": "3192520",
    "end": "3197720"
  },
  {
    "text": "share the lib file uh but if they're totally separate applications then the lip files are off limits because the lip",
    "start": "3197720",
    "end": "3203880"
  },
  {
    "text": "files the libraries live in their sandbox parts of the file system so yeah they're off limits yeah so in terms of the ndk",
    "start": "3203880",
    "end": "3211799"
  },
  {
    "start": "3211000",
    "end": "3369000"
  },
  {
    "text": "compatibility um as long as you stick to the libraries that the to the headers that are guaranteed to be supported",
    "start": "3211799",
    "end": "3218559"
  },
  {
    "text": "you're fine right so that's part of the you know uh that's part of the what ndk",
    "start": "3218559",
    "end": "3223640"
  },
  {
    "text": "is it it basically says these SC files are going to be supported for a very long time right um you could be using",
    "start": "3223640",
    "end": "3229680"
  },
  {
    "text": "some other um some other libraries for example people used to go directly to Blue Z library before Bluetooth was",
    "start": "3229680",
    "end": "3236040"
  },
  {
    "text": "available as a Java API but that's not really guaranteed to be around for forever so um so",
    "start": "3236040",
    "end": "3244400"
  },
  {
    "text": "um what I wanted to do is um so so this is this is one part of the equation that",
    "start": "3244400",
    "end": "3250000"
  },
  {
    "text": "I wanted to cover with you guys U and that's that's basically building a by the way I'm running it for a Fibonacci",
    "start": "3250000",
    "end": "3256280"
  },
  {
    "text": "of 33 just to see what number we get um and that's the number so we I believe",
    "start": "3256280",
    "end": "3265000"
  },
  {
    "text": "oh right now so uh keep in mind that I'm running all this on the UI thread which is a big no no right in a big in a final",
    "start": "3266480",
    "end": "3273280"
  },
  {
    "text": "application um and we discussed this yesterday so they should be running in in async task it'd be a perfect",
    "start": "3273280",
    "end": "3280119"
  },
  {
    "text": "candidate for that um so that way you know we would have we could run for much larger numbers and we would not get the",
    "start": "3280119",
    "end": "3287200"
  },
  {
    "text": "anr right application not responding uh but that's that's a different uh that's",
    "start": "3287200",
    "end": "3292760"
  },
  {
    "text": "a different conversation that's we talked about that yesterday um so this is going to take some time to to process",
    "start": "3292760",
    "end": "3299000"
  },
  {
    "text": "33 is about the limit um that I can push this we without without the anr um",
    "start": "3299000",
    "end": "3307720"
  },
  {
    "text": "coming through so um is that a number yeah yeah so that's the number so",
    "start": "3307720",
    "end": "3315640"
  },
  {
    "text": "35 seconds versus one second right and uh what's interesting is when",
    "start": "3315640",
    "end": "3321400"
  },
  {
    "text": "you turn on Trace view on this and actually analyze the the execution you can see that there gazillion recursive",
    "start": "3321400",
    "end": "3327480"
  },
  {
    "text": "calls happening in Java and and that's basically what's taking like 99.8% of",
    "start": "3327480",
    "end": "3332920"
  },
  {
    "text": "time or something so so that's that's where that's where it's slow um the second piece of the equation so we",
    "start": "3332920",
    "end": "3339480"
  },
  {
    "text": "talked about right so what we what we're discussing here is how to bridge the you",
    "start": "3339480",
    "end": "3344520"
  },
  {
    "text": "know those two divides The Divide between Java and c and we saw that now I want to briefly talk about uh how to",
    "start": "3344520",
    "end": "3350480"
  },
  {
    "text": "bridge this divide which is basically process one to process two communication right so uh uh one of the tools that is",
    "start": "3350480",
    "end": "3357280"
  },
  {
    "text": "available to us is something called uh the and uh the binder IPC right and the",
    "start": "3357280",
    "end": "3363039"
  },
  {
    "text": "access to that is via the Android interface definition language or aidl so basically a binder is our uh our",
    "start": "3363039",
    "end": "3371880"
  },
  {
    "start": "3369000",
    "end": "3600000"
  },
  {
    "text": "our system um for doing the IPC calls right so um if if I have one application",
    "start": "3371880",
    "end": "3379079"
  },
  {
    "text": "say for example this is my uh uh my application that wants to know what its GPS location is so this application",
    "start": "3379079",
    "end": "3386520"
  },
  {
    "text": "would say hey I want to get the the system service for location so it gets the location service right reference to",
    "start": "3386520",
    "end": "3392720"
  },
  {
    "text": "it and then it would say location service uh what's the last known location for instance right so that call",
    "start": "3392720",
    "end": "3399520"
  },
  {
    "text": "goes through the binder driver and gets Marshall then to the appropriate service",
    "start": "3399520",
    "end": "3404640"
  },
  {
    "text": "right for the service to execute and then it goes back and uh this way back",
    "start": "3404640",
    "end": "3409760"
  },
  {
    "text": "to the application yeah now what's important uh with the the IPC this IPC",
    "start": "3409760",
    "end": "3415480"
  },
  {
    "text": "mechanism is that it's a blocking call right so it's a it's a synchronous call unlike intents which we discussed",
    "start": "3415480",
    "end": "3421760"
  },
  {
    "text": "yesterday in the workshop uh which are basically asynchronous right so they go and they get placed in the queue and",
    "start": "3421760",
    "end": "3428720"
  },
  {
    "text": "then the Looper picks them up and so on so it's a different different mechanism so this is a blocking uh blocking call",
    "start": "3428720",
    "end": "3435839"
  },
  {
    "text": "communication so what I have here is I just wanted to show you an example of of of how this application uh how to how to",
    "start": "3435839",
    "end": "3442920"
  },
  {
    "text": "do this so what we're going to do is we're going to create a service this um an application here which is going to be",
    "start": "3442920",
    "end": "3448839"
  },
  {
    "text": "a service and it's going to be a simple logger service so you're going to basically say hey log something for us a",
    "start": "3448839",
    "end": "3454880"
  },
  {
    "text": "remote logging service that's that's all it is right so we're going to have a simple client that is going to make that",
    "start": "3454880",
    "end": "3461559"
  },
  {
    "text": "remote call to the logging service to log something and uh you know and that's it come back uh once it's done with the",
    "start": "3461559",
    "end": "3468680"
  },
  {
    "text": "logging right so these are going to be two separate processes living in two separate um U VMS yeah uh what are the",
    "start": "3468680",
    "end": "3475319"
  },
  {
    "text": "limitations for the ER in terms of the moving the data across I'm not sure what the limit is um on that um but the the",
    "start": "3475319",
    "end": "3484319"
  },
  {
    "text": "you know if you're moving a lot of data Maybe the binder maybe the IPC is not the the right thing right because the",
    "start": "3484319",
    "end": "3490160"
  },
  {
    "text": "other tool that we have at our disposal is are the content providers and they are sort of designed specifically for",
    "start": "3490160",
    "end": "3496640"
  },
  {
    "text": "for you know dealing with data across the boundaries application",
    "start": "3496640",
    "end": "3502400"
  },
  {
    "text": "boundaries so let me let me show you this example um uh here so I'm G to close all this",
    "start": "3502400",
    "end": "3509559"
  },
  {
    "text": "um so first of all I'm just going to run it first to kind of show you what it is",
    "start": "3509559",
    "end": "3514760"
  },
  {
    "text": "um and so you can see it so this is a simple little uh app that is going to",
    "start": "3514760",
    "end": "3522079"
  },
  {
    "text": "log remotely so on one hand I have starting up on one hand I have the",
    "start": "3522079",
    "end": "3529559"
  },
  {
    "text": "client and it simply has a button right and as I click on the button this is going to make a remote service call to a",
    "start": "3529559",
    "end": "3536559"
  },
  {
    "text": "servers service now service we can't really see um so for that purpose I'm going to basically um run the ADB log",
    "start": "3536559",
    "end": "3544880"
  },
  {
    "text": "cat here and let me see I'm disconnect I'm",
    "start": "3544880",
    "end": "3550000"
  },
  {
    "text": "going to disconnect my physical device in this case so this is my loog at not much interesting stuff going on until we",
    "start": "3550000",
    "end": "3555760"
  },
  {
    "text": "press click right so click click click and that's basically logging that's something is that something is going on",
    "start": "3555760",
    "end": "3562160"
  },
  {
    "text": "right so we can see that uh that there's a message and we're going to look to this code how this works another",
    "start": "3562160",
    "end": "3568640"
  },
  {
    "text": "interesting thing that to to notice is that if I do U um if I do ADB uh Shell",
    "start": "3568640",
    "end": "3576160"
  },
  {
    "text": "PS you can see that we actually have two separate processes all together so there's they're totally nonrelated to",
    "start": "3576160",
    "end": "3583640"
  },
  {
    "text": "each other there's there're two separate applications from two separate people and two separate packages they happen to",
    "start": "3583640",
    "end": "3589079"
  },
  {
    "text": "be assigned with the same key but that's not very relevant um in every other respect they're they're separate apps",
    "start": "3589079",
    "end": "3595039"
  },
  {
    "text": "right so the client in the servers so typically what you start what you do is",
    "start": "3595039",
    "end": "3600720"
  },
  {
    "text": "you start by defining your interface for the remote something and so that is um",
    "start": "3600720",
    "end": "3608160"
  },
  {
    "text": "hold on it's trying to open it in textmate versus uh open it here so that interface looks like this",
    "start": "3608160",
    "end": "3615640"
  },
  {
    "text": "and it's basically this is basically the aidl code and aidl is essentially you",
    "start": "3615640",
    "end": "3621760"
  },
  {
    "text": "know inherited from IDL which is the cor interface definition language right so",
    "start": "3621760",
    "end": "3627280"
  },
  {
    "text": "in many ways it's very very similar but it's also very similar to a Java interface as you can see um so in this",
    "start": "3627280",
    "end": "3633799"
  },
  {
    "text": "case what we have is we're defining the package we're basically defining let there be an interface we call it diog",
    "start": "3633799",
    "end": "3640480"
  },
  {
    "text": "service um and it's got two methods uh log D and log the reason why I put two",
    "start": "3640480",
    "end": "3646039"
  },
  {
    "text": "methods is because um the this one is only using primitive data types which makes life very simple right so string",
    "start": "3646039",
    "end": "3653160"
  },
  {
    "text": "is sort of a primitive data type in this context um so it's it's fairly simple now this",
    "start": "3653160",
    "end": "3659680"
  },
  {
    "text": "is where things get a little more complex because I now have a proprietory um I have a a custom object",
    "start": "3659680",
    "end": "3667839"
  },
  {
    "text": "that I want to send across the process lines well if you have something like that you actually have to create this",
    "start": "3667839",
    "end": "3673760"
  },
  {
    "text": "object uh into as a parcel so it needs to be a parcel parcelable uh data type",
    "start": "3673760",
    "end": "3679359"
  },
  {
    "text": "that can actually be you know uh sent across the the wire from one process to the other so that's why I sort of um",
    "start": "3679359",
    "end": "3686599"
  },
  {
    "text": "have the second um example just to kind of demonstrate that and that's going to be in in this IDL file called a message",
    "start": "3686599",
    "end": "3693240"
  },
  {
    "text": "so let me briefly show you so defining the actual custom data type message is fairly",
    "start": "3693240",
    "end": "3700480"
  },
  {
    "text": "simple um it's fairly simple because you just basically say let it be parcelable",
    "start": "3700599",
    "end": "3707440"
  },
  {
    "text": "okay now the Java for it gets a little trickier but we're we're going to uh get to that later so what happens when you",
    "start": "3707440",
    "end": "3715160"
  },
  {
    "text": "add the IDL files um there's actually integration for this in Eclipse so eclipse is",
    "start": "3715160",
    "end": "3721599"
  },
  {
    "text": "automat automatically going to run aidl tool from the SDK and process this file",
    "start": "3721599",
    "end": "3728119"
  },
  {
    "text": "uh the the the interfaces and create the stub files so this autogenerated file",
    "start": "3728119",
    "end": "3734200"
  },
  {
    "text": "that's extremely ugly is um is an autogenerated code right from by by aidl",
    "start": "3734200",
    "end": "3741160"
  },
  {
    "text": "Tool so that's what that looks like and you don't really care too much about what's inside of it uh but basically",
    "start": "3741160",
    "end": "3746880"
  },
  {
    "text": "that that is the that's what's doing the marshalling and our marshalling of data back across uh to the binder um so you",
    "start": "3746880",
    "end": "3755079"
  },
  {
    "text": "don't typically look at this file too much because it gets Diz um",
    "start": "3755079",
    "end": "3760520"
  },
  {
    "text": "now what we need to do is we need to provide the implementation of a service yeah so we're not defining an interface",
    "start": "3760520",
    "end": "3767640"
  },
  {
    "text": "we're simply declaring a message as a parcel now the Java for it is going to be interesting we're going to get if you",
    "start": "3767640",
    "end": "3774359"
  },
  {
    "text": "use a class that's a custom class no you have to declare it parcelable and you need to then provide a implementation of",
    "start": "3774359",
    "end": "3781119"
  },
  {
    "text": "it I I'll get to that um next but I want to show you just the the the Ser how the",
    "start": "3781119",
    "end": "3786720"
  },
  {
    "text": "service works so to implement the to implement the remote Service uh so",
    "start": "3786720",
    "end": "3791920"
  },
  {
    "text": "remember um well um depend I'm not sure how you guys use services but in most",
    "start": "3791920",
    "end": "3797000"
  },
  {
    "text": "most people use Services as in Android as as a Unbound services so in other",
    "start": "3797000",
    "end": "3802799"
  },
  {
    "text": "words the the onbind method is usually something that we ignore we usually focus on on start command on Destroy",
    "start": "3802799",
    "end": "3810559"
  },
  {
    "text": "right so those are usually the methods that people Implement like for example in a music player application or something like that so that's a nonbound",
    "start": "3810559",
    "end": "3816799"
  },
  {
    "text": "service in this case we're implementing a bound service that's what the IDL basically provides so what that means is",
    "start": "3816799",
    "end": "3822720"
  },
  {
    "text": "we need to provide the implementation for onbind and we need to return a binder um",
    "start": "3822720",
    "end": "3829079"
  },
  {
    "text": "that implementation is really a pro is already Pro the the stop for that",
    "start": "3829079",
    "end": "3834240"
  },
  {
    "text": "implementation is provided by that autogenerated code right so you basically just say I want to return that",
    "start": "3834240",
    "end": "3840039"
  },
  {
    "text": "and that eclipse is actually going to fill in this for you U and give you all the methods that you need to provide so",
    "start": "3840039",
    "end": "3845680"
  },
  {
    "text": "you essentially just need to provide the meat of the actual function or method right so you need to say what happens",
    "start": "3845680",
    "end": "3851880"
  },
  {
    "text": "remotely right so at the end of the day you're just filling in this piece of code and that piece of",
    "start": "3851880",
    "end": "3858160"
  },
  {
    "text": "code right eclipse is going to create it you already have the stab autogenerated for you and eclipse is going to tell you",
    "start": "3858160",
    "end": "3863720"
  },
  {
    "text": "what you need to implement to to have have to implement all the unimplemented methods um so that's what the remote",
    "start": "3863720",
    "end": "3871200"
  },
  {
    "text": "service looks like um it's this part is fairly straightforward now this and and",
    "start": "3871200",
    "end": "3877160"
  },
  {
    "text": "you also need to of course declare it in the Manifest file to say Hey you know this is going to be uh this is going to",
    "start": "3877160",
    "end": "3882480"
  },
  {
    "text": "be a service and it's going to be available for other people to bind to it so that's what we're doing here we're",
    "start": "3882480",
    "end": "3888160"
  },
  {
    "text": "declaring it here and I'm basically picking creating some kind of action for which this service is going to listen",
    "start": "3888160",
    "end": "3895279"
  },
  {
    "text": "for so this is how clients are going to bind to that service and this could be any piece of text that you come up with",
    "start": "3895279",
    "end": "3901760"
  },
  {
    "text": "but this is uh pretty standard to to use the actual full-fledged name of the",
    "start": "3901760",
    "end": "3907279"
  },
  {
    "text": "interface um so once we have the U the service done the next part is to do the",
    "start": "3907279",
    "end": "3912960"
  },
  {
    "text": "client and for the client what we're doing is basically we're uh we're copy",
    "start": "3912960",
    "end": "3919119"
  },
  {
    "text": "pasting the same IDL um so these are my IDL files because the client needs to",
    "start": "3919119",
    "end": "3924319"
  },
  {
    "text": "know the same uh needs to know what the interface is to the service that that's why we need the IDL",
    "start": "3924319",
    "end": "3931599"
  },
  {
    "text": "um and and then what we're doing in the client is we need to connect to that",
    "start": "3931599",
    "end": "3936839"
  },
  {
    "text": "remote service so this is where things get a little interesting um so what I'm doing",
    "start": "3936839",
    "end": "3943839"
  },
  {
    "text": "here is I'm basically creating an intent that defines what we're are going to connect",
    "start": "3943839",
    "end": "3949839"
  },
  {
    "text": "to um and I'm saying bind to that service bind to that remote service",
    "start": "3949839",
    "end": "3955799"
  },
  {
    "text": "right but what's important here to know is that this happens asynchronously as",
    "start": "3955799",
    "end": "3961920"
  },
  {
    "text": "well so this this bind is going to finish really quickly but it doesn't",
    "start": "3961920",
    "end": "3967880"
  },
  {
    "text": "mean that we're going to be actually bound to the remote service at this point as matter of fact we're not going to be bound until the next iteration of",
    "start": "3967880",
    "end": "3975640"
  },
  {
    "text": "the Looper right because the Looper is actually going to just pick up the next job at the next uh once it's done with",
    "start": "3975640",
    "end": "3981359"
  },
  {
    "text": "this to actually do The Binding um the results of the binding are then um",
    "start": "3981359",
    "end": "3988559"
  },
  {
    "text": "communicated back to us via U this uh service connection Clause so that's what",
    "start": "3988559",
    "end": "3994000"
  },
  {
    "text": "this service connection class is so we you basically need to provide um a class",
    "start": "3994000",
    "end": "3999400"
  },
  {
    "text": "that implements this interface that simply says what happens when we got connected or when we got disconnected",
    "start": "3999400",
    "end": "4006599"
  },
  {
    "text": "okay because this is asynchronous so this is something that people usually sort of don't get because if I was",
    "start": "4006599",
    "end": "4011760"
  },
  {
    "text": "trying at this point to communicate directly log service log for instance",
    "start": "4011760",
    "end": "4017559"
  },
  {
    "text": "right this would fail uh because we do not have log service bound yet",
    "start": "4017559",
    "end": "4024240"
  },
  {
    "text": "okay I'm sorry no it will it's guaranteed to fail it's 100% it's going",
    "start": "4024240",
    "end": "4030520"
  },
  {
    "text": "to fail so that's because um keep in mind that every I was showing this picture yesterday keep in mind that um",
    "start": "4030520",
    "end": "4039599"
  },
  {
    "text": "what how things happen inside of the inside of the system so inside of a system we have something like this right",
    "start": "4039599",
    "end": "4045640"
  },
  {
    "text": "so this is our process and um so we have a single Looper on a single thread right",
    "start": "4045640",
    "end": "4051760"
  },
  {
    "text": "and this this guy is doing jobs serially one job at a time and it blocks so while",
    "start": "4051760",
    "end": "4057960"
  },
  {
    "text": "it's processing that method I think that was on create that I was in right was it",
    "start": "4057960",
    "end": "4063480"
  },
  {
    "text": "in on create right so while it's processing this job here it's not",
    "start": "4063480",
    "end": "4069960"
  },
  {
    "text": "processing any other job so the fact that this job says buying to a service",
    "start": "4069960",
    "end": "4075000"
  },
  {
    "text": "so we're inside of on create here inside of the Looper that says buying to a service but that's merely going to",
    "start": "4075000",
    "end": "4081480"
  },
  {
    "text": "generate a new message on top of the queue for the next time around to do",
    "start": "4081480",
    "end": "4086720"
  },
  {
    "text": "something so it needs to actually finish on create first be done with it go back",
    "start": "4086720",
    "end": "4092400"
  },
  {
    "text": "to the queue pick up the next job which says buying to a service ever mul so is",
    "start": "4092400",
    "end": "4098480"
  },
  {
    "text": "this uh ever multi thread you could have yeah you could have multiple threads right but uh uh but again we we have the",
    "start": "4098480",
    "end": "4106318"
  },
  {
    "text": "this is still going to be asynchronous and it's still going to be on somebody's que and there's still going to be a",
    "start": "4106319",
    "end": "4111520"
  },
  {
    "text": "Looper processing that Loopers SK right so you could have multiple threads but",
    "start": "4111520",
    "end": "4117159"
  },
  {
    "text": "that's not going to make this uh no you have a single thread you",
    "start": "4117159",
    "end": "4124040"
  },
  {
    "text": "have sing Single Looper per single thread so the is not ever",
    "start": "4124040",
    "end": "4129880"
  },
  {
    "text": "protected so these are basically one to one there's a one to one relationship between a Looper and a que right so they",
    "start": "4129880",
    "end": "4136199"
  },
  {
    "text": "and so yeah yeah so so that's basically so at that",
    "start": "4136199",
    "end": "4142359"
  },
  {
    "text": "some point we then bind and at that point log service is finally available this is the first time that that the log",
    "start": "4142359",
    "end": "4147960"
  },
  {
    "text": "service is available oh in the log service what happens when on a successful bind you're going to get back",
    "start": "4147960",
    "end": "4154000"
  },
  {
    "text": "an ey binder that's the binder that we are returning here as when we say return",
    "start": "4154000",
    "end": "4160600"
  },
  {
    "text": "uh the stub right right we're saying return new log service stub so that arrives here as an i binder which we now",
    "start": "4160600",
    "end": "4167920"
  },
  {
    "text": "need to cast to our particular service and for that again we use that stop that",
    "start": "4167920",
    "end": "4173440"
  },
  {
    "text": "auto generated code so it gets a little confusing on a client side just because",
    "start": "4173440",
    "end": "4178520"
  },
  {
    "text": "of this asynchronous nature of the actual binding process right um so you",
    "start": "4178520",
    "end": "4184199"
  },
  {
    "text": "know most of us as app developers we're used to using system services and you just say get system service and you get",
    "start": "4184199",
    "end": "4190400"
  },
  {
    "text": "the system service and exactly the same stuff is happening the difference is that the system service",
    "start": "4190400",
    "end": "4196239"
  },
  {
    "text": "are already bound to the context so you know you don't need to actually do the bind right that that that's that's what",
    "start": "4196239",
    "end": "4202679"
  },
  {
    "text": "the difference is I think there's a presentation tomorrow specifically on on system Services uh I think it's going to",
    "start": "4202679",
    "end": "4208280"
  },
  {
    "text": "be more on the lower level stuff yeah it looks to me like your implementation only you",
    "start": "4208280",
    "end": "4216719"
  },
  {
    "text": "one you didn't have to put I have on click here and I can log",
    "start": "4217920",
    "end": "4224239"
  },
  {
    "text": "as many times as I want",
    "start": "4224239",
    "end": "4227320"
  },
  {
    "text": "yeah um so yeah so log we can call log Service as many times as you want um one",
    "start": "4231040",
    "end": "4238760"
  },
  {
    "text": "thing that I didn't talk about um is the message so the actual message. Java as I",
    "start": "4238760",
    "end": "4244480"
  },
  {
    "text": "said needs to be a parable right to be able to be something that you can send across the wire and if I have a simple",
    "start": "4244480",
    "end": "4250920"
  },
  {
    "text": "message that contains a string and a text what that really means is you need to provide a way to read a parcel in",
    "start": "4250920",
    "end": "4258880"
  },
  {
    "text": "right and you need to provide a way to write a parcel out so basically it's kind of like a serializing in Java but",
    "start": "4258880",
    "end": "4265360"
  },
  {
    "text": "not really right so you're basically converting a live object into a stream",
    "start": "4265360",
    "end": "4270640"
  },
  {
    "text": "that can get also re create it on the other end so that and you also need to",
    "start": "4270640",
    "end": "4276159"
  },
  {
    "text": "provide this Creator as well but but you know in in an arell you need to read it",
    "start": "4276159",
    "end": "4281560"
  },
  {
    "text": "in and and and write it out to to be able to make a make it the parcel",
    "start": "4281560",
    "end": "4287840"
  },
  {
    "text": "yeah yes you still need to create an IDL file yes the",
    "start": "4291400",
    "end": "4297960"
  },
  {
    "text": "interface so yeah so the question is why did they ever why did they even need to Define uh Define this here as an action",
    "start": "4305520",
    "end": "4313120"
  },
  {
    "text": "why didn't I just say build an INT and spell out the name of the class I wanted to provide that clear separation that I",
    "start": "4313120",
    "end": "4319520"
  },
  {
    "text": "have no intricate knowledge of what the class is and so forth so that's why I",
    "start": "4319520",
    "end": "4324679"
  },
  {
    "text": "would not use explicit intent I'd rather use an action based implicit intent in",
    "start": "4324679",
    "end": "4330280"
  },
  {
    "text": "this case yeah yeah H is there a way to keep people from running running your",
    "start": "4330280",
    "end": "4335360"
  },
  {
    "text": "service yes you can you can add permissions right so you could request you can require the caller to to own a",
    "start": "4335360",
    "end": "4341840"
  },
  {
    "text": "permission to connect and so forth right yeah uh so can you dynamically choose the implementation of the interface um",
    "start": "4341840",
    "end": "4350080"
  },
  {
    "text": "uh yeah well you could but that you would have to write you would have to Pro you would have to create a factory",
    "start": "4350080",
    "end": "4356400"
  },
  {
    "text": "method I guess yourself right to provide that there's nothing Dynam automatic about that so binder is using shared",
    "start": "4356400",
    "end": "4363840"
  },
  {
    "text": "memory to make so that's why it's making things things supposed to be much faster than it was copying yeah how would I",
    "start": "4363840",
    "end": "4370040"
  },
  {
    "text": "then I know that there's um it's uh you know what so if if you guys go to rar",
    "start": "4370040",
    "end": "4375239"
  },
  {
    "text": "android.com this is basically chapter 14 and 15 um so it's um you know what I try",
    "start": "4375239",
    "end": "4380800"
  },
  {
    "text": "to boil down into so so that's outline there all the code is there um I'm going",
    "start": "4380800",
    "end": "4385920"
  },
  {
    "text": "to make the um these three applications also available for download here so on",
    "start": "4385920",
    "end": "4392280"
  },
  {
    "text": "this on this uh Forum po blog post so I'll I'll I'll I'll make the the the",
    "start": "4392280",
    "end": "4397639"
  },
  {
    "text": "code available yeah um um if any if you have any questions I'll be here but",
    "start": "4397639",
    "end": "4402719"
  },
  {
    "text": "otherwise thank you um and have a good l [Applause]",
    "start": "4402719",
    "end": "4409000"
  },
  {
    "text": "[Music]",
    "start": "4409000",
    "end": "4417020"
  }
]