[
  {
    "text": "[Music]",
    "start": "3360",
    "end": "9618"
  },
  {
    "text": "yeah so I'm uh going to be talking about what he said I'll be talking about uh I am a statistics engineer at EPO which is",
    "start": "10320",
    "end": "18720"
  },
  {
    "text": "basically half data scientist kind of half engineer uh so I'm implementing",
    "start": "18720",
    "end": "24640"
  },
  {
    "text": "statistical things frequently uh for our uh experimentation platform and so",
    "start": "24640",
    "end": "30080"
  },
  {
    "text": "you'll be hearing a bit about um our platform and what it does but that's uh",
    "start": "30080",
    "end": "35200"
  },
  {
    "text": "not really the focus here um this is the EML applications track so this is going to be about kind of half of the",
    "start": "35200",
    "end": "41320"
  },
  {
    "text": "application um of why we want to predict things in an experimentation context which is not might not be immediately",
    "start": "41320",
    "end": "47440"
  },
  {
    "text": "obvious and then kind of half uh engineering and really focusing on uh the algorithms and implementation so",
    "start": "47440",
    "end": "54359"
  },
  {
    "text": "that's that's what you can look forward to uh to kind of motivate this I'm going to talk about the number one one problem",
    "start": "54359",
    "end": "60600"
  },
  {
    "text": "in experimentation U but before I get to that I just want to step back a little bit and uh just really describe what an",
    "start": "60600",
    "end": "67640"
  },
  {
    "text": "experiment uh process looks like um at at a company uh or even in in the uh",
    "start": "67640",
    "end": "74600"
  },
  {
    "text": "academic or scientific world uh so the first thing that happens um when an experiment runs or at just at a very",
    "start": "74600",
    "end": "81360"
  },
  {
    "text": "high level is you'll have a lot of users and you want to randomize them into at least two groups typically you have a",
    "start": "81360",
    "end": "87880"
  },
  {
    "text": "treatment and a control h and this little diagram I've got users coming in with different IDs and then I need to",
    "start": "87880",
    "end": "94720"
  },
  {
    "text": "assign them randomly uh to one of two treatments in this case this might be like a marketing promotion I'll show",
    "start": "94720",
    "end": "102520"
  },
  {
    "text": "half of users save 75% and then I might show the other half uh like this yellow",
    "start": "102520",
    "end": "107560"
  },
  {
    "text": "sale button over there um but the the overall uh pattern",
    "start": "107560",
    "end": "114680"
  },
  {
    "text": "or the overall flow of an experiment looks something like this uh you start out with a planning phase",
    "start": "114680",
    "end": "120520"
  },
  {
    "text": "and this is U going to be one of the focuses of the talk today um but you need to determine the number of users",
    "start": "120520",
    "end": "127240"
  },
  {
    "text": "who will go into the experiment before you even start the experiment and this is something that's that's often overlooked and and can lead to some",
    "start": "127240",
    "end": "133840"
  },
  {
    "text": "trouble if you don't pay attention to it the second phase in experiment is the randomization sort of that black box",
    "start": "133840",
    "end": "140480"
  },
  {
    "text": "that I showed you in the last slide you need some algorithm to randomly assign",
    "start": "140480",
    "end": "145519"
  },
  {
    "text": "uh treatment control or or to multiple treatments and then you need a and collect data uh on on your users so",
    "start": "145519",
    "end": "154840"
  },
  {
    "text": "you're going to be measuring something you're going to need some some fixed time period uh over which to collect",
    "start": "154840",
    "end": "160599"
  },
  {
    "text": "data could be a revenue metric just could be any user level metric uh that's going to be of interest to the business",
    "start": "160599",
    "end": "166920"
  },
  {
    "text": "and then finally after you've waited after you've collected the number of samples that you determined during the",
    "start": "166920",
    "end": "172720"
  },
  {
    "text": "planning phase you'll analyze that data and so you'll compute metrics run statistics get some P values get some",
    "start": "172720",
    "end": "179959"
  },
  {
    "text": "confidence intervals and hopefully make some kind of business decision to decide whether or not your treatment is a uh is",
    "start": "179959",
    "end": "186200"
  },
  {
    "text": "a good idea for your business I want to talk a little bit",
    "start": "186200",
    "end": "192280"
  },
  {
    "text": "about statistical power and this is something that people who just who kind",
    "start": "192280",
    "end": "197480"
  },
  {
    "text": "of go through those four steps might NE not necessarily understand um I I guess",
    "start": "197480",
    "end": "202760"
  },
  {
    "text": "kind I just get a quick like show of hands of people who have heard of statistical",
    "start": "202760",
    "end": "208120"
  },
  {
    "text": "power maybe about half um so sometimes people have have a hard",
    "start": "208120",
    "end": "215239"
  },
  {
    "text": "time wrapping their minds around it even after taking a stat 101 class uh there basically two types of lifts that you",
    "start": "215239",
    "end": "223319"
  },
  {
    "text": "that we need to think about and so a lift here is just what's the percent increase in a metric of Interest we have",
    "start": "223319",
    "end": "229319"
  },
  {
    "text": "What's called the true lift which is if we were to gather an infinite amount of data observe an infinite number of users",
    "start": "229319",
    "end": "236840"
  },
  {
    "text": "what would the observed lift actually be it'd be you know could be 10.1 1248",
    "start": "236840",
    "end": "242239"
  },
  {
    "text": "9% um but we don't have an infinite amount of data we only have you know a",
    "start": "242239",
    "end": "247640"
  },
  {
    "text": "finite user population so instead all we have to work with is the observed lift",
    "start": "247640",
    "end": "252920"
  },
  {
    "text": "uh which is not going to be the same as the true one and so power deals with a relationship between that uh true lift",
    "start": "252920",
    "end": "260880"
  },
  {
    "text": "and The observed lift and so it's it's defined in relation to something called a minimum detectable effect uh the idea",
    "start": "260880",
    "end": "268560"
  },
  {
    "text": "is if if the true lift is equal to some number known as this minimum detectable",
    "start": "268560",
    "end": "273800"
  },
  {
    "text": "effect what percent of the time will an experiment give us a statistically significant result um and it's it's just",
    "start": "273800",
    "end": "281400"
  },
  {
    "text": "a concept you um I find myself repeating quite a bit uh in the experimentation",
    "start": "281400",
    "end": "287720"
  },
  {
    "text": "world because if you don't have enough power for your experiment uh your results will look something like this on",
    "start": "287720",
    "end": "292880"
  },
  {
    "text": "the right uh which is you have wide confidence intervals uh all your results",
    "start": "292880",
    "end": "298280"
  },
  {
    "text": "are statistically significant and you don't really understand why and the reason is you just didn't have enough",
    "start": "298280",
    "end": "303720"
  },
  {
    "text": "users enrolled in your experiment in order uh to have um yeah to to see",
    "start": "303720",
    "end": "310160"
  },
  {
    "text": "anything useful in the data uh so power is just a a recurring theme uh in the",
    "start": "310160",
    "end": "316400"
  },
  {
    "text": "world of experimentation and yeah it makes PM sad when they don't get stats IG",
    "start": "316400",
    "end": "323479"
  },
  {
    "text": "results how do you compute power um there are sample size calculators out",
    "start": "323479",
    "end": "329000"
  },
  {
    "text": "there this is one I just screenshotted from my website it's just a little JavaScript calculator um it has kind of",
    "start": "329000",
    "end": "336960"
  },
  {
    "text": "the Core Concepts here um so if you have some process uh with a conversion rate",
    "start": "336960",
    "end": "344080"
  },
  {
    "text": "that you kind of know in advance let's say a checkout rate of say 2% you would Define a minimum detectable effect in",
    "start": "344080",
    "end": "350319"
  },
  {
    "text": "relation to that so you say all right I want to be able to detect a change of at least uh a relative change of 10% some",
    "start": "350319",
    "end": "358000"
  },
  {
    "text": "percent of the time and that would be the that percent of the time is known as the power how many users would I need to",
    "start": "358000",
    "end": "363440"
  },
  {
    "text": "enroll in this experiment and so with those two numbers you want to be able to detect a a lift from 2% to 2.2% you need",
    "start": "363440",
    "end": "372639"
  },
  {
    "text": "about 78,000 users in each treatment uh of your experiment which might sound fine",
    "start": "372639",
    "end": "379479"
  },
  {
    "text": "and great uh 10% is a pretty large lift to be detecting for most like product",
    "start": "379479",
    "end": "385160"
  },
  {
    "text": "feature changes um and so you you start to really run into trouble when you dial that down and want to detect smaller and",
    "start": "385160",
    "end": "392000"
  },
  {
    "text": "smaller effects uh which you would want to do if you're just trying to test every single change that you like make",
    "start": "392000",
    "end": "398000"
  },
  {
    "text": "might make to your your website or your product uh so just to show you a different set of numbers and this is",
    "start": "398000",
    "end": "404599"
  },
  {
    "text": "where people's mind start exploding is if you want to detect a 1% change instead of a 10% change you need about 7",
    "start": "404599",
    "end": "411880"
  },
  {
    "text": "and a half million users enrolled in uh each branch of that experiment um and",
    "start": "411880",
    "end": "418560"
  },
  {
    "text": "and you know this is just going from that 2% number to like a 2.02% number um",
    "start": "418560",
    "end": "423879"
  },
  {
    "text": "and you know if you're Facebook or another very large company 7 million is",
    "start": "423879",
    "end": "428960"
  },
  {
    "text": "nothing to you uh you've got all the users that you need uh for very precise experiments if you're everybody else uh",
    "start": "428960",
    "end": "435879"
  },
  {
    "text": "that number can look pretty intimidating uh and so a a recurring theme in experimentation is knowing when not to",
    "start": "435879",
    "end": "441960"
  },
  {
    "text": "run an experiment because you just don't have the users uh for it so is there anything we can do to reduce this number",
    "start": "441960",
    "end": "448960"
  },
  {
    "text": "of us us that we need for a successful experiment and it turns out that there",
    "start": "448960",
    "end": "455199"
  },
  {
    "text": "is so I'm going to be talking to you uh about Cupid which is a paper from 2013",
    "start": "455199",
    "end": "462840"
  },
  {
    "text": "this was a method invented by some researchers at Microsoft some of these names might be familiar Alex D yazu",
    "start": "462840",
    "end": "469919"
  },
  {
    "text": "Ronnie kohab and Toby Walker and it essentially reduces the number of users",
    "start": "469919",
    "end": "475759"
  },
  {
    "text": "that you need in an experiment um I I say with magic it really it's just math",
    "start": "475759",
    "end": "481560"
  },
  {
    "text": "um and it's a technique called variance reduction and so I'm going to kind of walk through the mechanics of how Cupid works and then uh show how we",
    "start": "481560",
    "end": "488360"
  },
  {
    "text": "implemented it um at uh at EPO and the core idea here is we're going to be",
    "start": "488360",
    "end": "493440"
  },
  {
    "text": "looking at how the users Behavior compares to their predicted Behavior Uh and and kind of take the difference",
    "start": "493440",
    "end": "499199"
  },
  {
    "text": "between those two things in order to have a a more um or get a measurement",
    "start": "499199",
    "end": "505240"
  },
  {
    "text": "with less variance than before okay so how does it work this is the kind of the same illustration as",
    "start": "505240",
    "end": "512640"
  },
  {
    "text": "before but instead of just assigning each user to treatment or control we're going to attach some additional data at",
    "start": "512640",
    "end": "519320"
  },
  {
    "text": "that time of assignment so at the assignment time the user has not been affected At All by the experiment and so",
    "start": "519320",
    "end": "525680"
  },
  {
    "text": "we're kind of free to supplement um the that variant information with other",
    "start": "525680",
    "end": "530760"
  },
  {
    "text": "information that we have about the user and construct uh just like a data set with that so in this case I'm going to",
    "start": "530760",
    "end": "536880"
  },
  {
    "text": "attach uh previous Revenue figures from those those specific users so I might know that user ID 12 had $120 worth of",
    "start": "536880",
    "end": "545120"
  },
  {
    "text": "Revenue in the past month and 43 had $30 and 67 had you know",
    "start": "545120",
    "end": "550920"
  },
  {
    "text": "$328 and I'm going to use that information uh in order to to um run run",
    "start": "550920",
    "end": "556079"
  },
  {
    "text": "a more precise experiment I'm going to show you how that works so this is just a very simple uh",
    "start": "556079",
    "end": "563720"
  },
  {
    "text": "data table that we could we uh can construct with the user ID the variant",
    "start": "563720",
    "end": "570240"
  },
  {
    "text": "this predicted Revenue in this case I have the world's simplest predictive model which is that their last 30 days",
    "start": "570240",
    "end": "577320"
  },
  {
    "text": "is going to be equal to their next 30 days uh we're going to get into more advanced models but this is just for purposes of illustration and then",
    "start": "577320",
    "end": "584640"
  },
  {
    "text": "instead of analyzing uh the actual Revenue that we get from each user which is that fourth column we're going to be",
    "start": "584640",
    "end": "591079"
  },
  {
    "text": "analyzing the last column which is the difference between the actual observed revenue and the prediction and this is",
    "start": "591079",
    "end": "598880"
  },
  {
    "text": "all these are just madeup numbers um but the kind of the key Insight here is that",
    "start": "598880",
    "end": "605120"
  },
  {
    "text": "the variance in that last column is significantly lower than the variance in",
    "start": "605120",
    "end": "610560"
  },
  {
    "text": "the next to last column um and so this is this is just the the core idea behind",
    "start": "610560",
    "end": "616440"
  },
  {
    "text": "cupid is that we yeah we just have much tighter numbers U just looking at those",
    "start": "616440",
    "end": "622640"
  },
  {
    "text": "residuals um compared to prediction rather than the the just the observe values so in viewed another way um this",
    "start": "622640",
    "end": "631720"
  },
  {
    "text": "is just an illustration I put together for one of our blog posts about this but",
    "start": "631720",
    "end": "636800"
  },
  {
    "text": "without Cupid you might have two different estimates of a um some Metric",
    "start": "636800",
    "end": "642040"
  },
  {
    "text": "of interest uh this will be the ones on the left you might have a control and treatment where the uncertainty is",
    "start": "642040",
    "end": "647800"
  },
  {
    "text": "relatively wide for uh both of those numbers and then once you apply Cupid as",
    "start": "647800",
    "end": "653800"
  },
  {
    "text": "because you have less variance in your data you have much tighter estimates on what the mean is for each group and so",
    "start": "653800",
    "end": "660200"
  },
  {
    "text": "with that your P values are lower your confidence intervals are Tighter and everybody goes home",
    "start": "660200",
    "end": "667600"
  },
  {
    "text": "Happy okay so just another uh sort just sort of illustrative uh diagram here",
    "start": "667600",
    "end": "675200"
  },
  {
    "text": "with Cupid enabled this just means that whereas your sample size calculator may have told you you needed like 120,000",
    "start": "675200",
    "end": "681720"
  },
  {
    "text": "users before when you if you flip this on and you provide some of this pre-experiment data and reduce the",
    "start": "681720",
    "end": "687480"
  },
  {
    "text": "variance um kind of typical results here are you could get that down to like 50",
    "start": "687480",
    "end": "693200"
  },
  {
    "text": "or 80,000 users um sometimes it's more than that sometimes is less this is just kind of a rough ballpark of uh kind of",
    "start": "693200",
    "end": "700360"
  },
  {
    "text": "typical results uh that we've seen and that that that other organizations have reported so none of this is new this is",
    "start": "700360",
    "end": "706880"
  },
  {
    "text": "all stuff originating from that original Microsoft paper uh pretty pretty widely used in the",
    "start": "706880",
    "end": "713560"
  },
  {
    "text": "industry okay so how do we implement this um all all sounds great we get",
    "start": "713560",
    "end": "719320"
  },
  {
    "text": "experiments that require fuser users than they did uh fewer users than they did before uh let's let's go to work uh",
    "start": "719320",
    "end": "725760"
  },
  {
    "text": "so this was the the first version of our Cupid architecture you kind of read it from bottom to top here so uh in in our",
    "start": "725760",
    "end": "733560"
  },
  {
    "text": "system customers have all their data sitting in a data warehouse we have snowflake big query red shift and data",
    "start": "733560",
    "end": "739880"
  },
  {
    "text": "brakes represented and so the the customers will have just event level data there and we uh crunch a lot of",
    "start": "739880",
    "end": "747959"
  },
  {
    "text": "numbers compute subject level data out of that for each experiment and then",
    "start": "747959",
    "end": "754240"
  },
  {
    "text": "we're going to want to run some kind of computation on that subject level data so i' I've labeled these kind of Big",
    "start": "754240",
    "end": "759680"
  },
  {
    "text": "Data at the bottom which is just event level data medium data in the middle row just refers to subject level data and",
    "start": "759680",
    "end": "766880"
  },
  {
    "text": "then finally uh once this python process is done which is using these",
    "start": "766880",
    "end": "772160"
  },
  {
    "text": "Technologies scipi numpy and pandas uh we get we get tiny data which is just",
    "start": "772160",
    "end": "777360"
  },
  {
    "text": "the actual confidence intervals for the experiment results so that that will literally just be like five rows going",
    "start": "777360",
    "end": "783720"
  },
  {
    "text": "into our postgress table uh at the end so what's this middle row doing um it's",
    "start": "783720",
    "end": "789680"
  },
  {
    "text": "a pretty kind of standard data sciency architecture uh we got a python process",
    "start": "789680",
    "end": "795360"
  },
  {
    "text": "that runs it connects directly to snowflake it downloads a big table uh it",
    "start": "795360",
    "end": "801800"
  },
  {
    "text": "pivots uh in memory into in a way that pandas is going to be happy with that we can run um linear regressions",
    "start": "801800",
    "end": "809639"
  },
  {
    "text": "uh and then finally we we run those regressions using numpy so this is",
    "start": "809639",
    "end": "815560"
  },
  {
    "text": "nothing too special here um pretty easy for data scientists to write and get it stowed up and um go to",
    "start": "815560",
    "end": "823000"
  },
  {
    "text": "work so this is just a little bit of the this is an actual screenshot uh don't",
    "start": "823000",
    "end": "828399"
  },
  {
    "text": "tell my boss um but this is a a fairly um yeah you can just see kind of how",
    "start": "828399",
    "end": "833959"
  },
  {
    "text": "simple that fit and predict um method ends up being just using using python",
    "start": "833959",
    "end": "839560"
  },
  {
    "text": "using pandas uh it's all kind of at the bottom we get an estimator we fit it uh",
    "start": "839560",
    "end": "845360"
  },
  {
    "text": "we make some predictions using that estimator and we return those predictions and then do all the stats kind of on that array of predicted",
    "start": "845360",
    "end": "852240"
  },
  {
    "text": "values or the difference between the prediction the residual depending on kind of which exact version of cupid",
    "start": "852240",
    "end": "858240"
  },
  {
    "text": "that you're doing um but it's nice clean code and that's just all I kind of wanted to show you in the this",
    "start": "858240",
    "end": "864160"
  },
  {
    "text": "slide so yeah we rolled it out um it worked well so this is I just kind of",
    "start": "864160",
    "end": "870199"
  },
  {
    "text": "took this example at random uh we've got a little check box on each experiment result page you can turn Cupid on or off",
    "start": "870199",
    "end": "877800"
  },
  {
    "text": "um and we in this one more or less taken it random uh the confidence intervals",
    "start": "877800",
    "end": "883560"
  },
  {
    "text": "are just slightly smaller but sometimes that can kick a statistically insignificant result into a significant",
    "start": "883560",
    "end": "889759"
  },
  {
    "text": "one um and that makes people happy when they have uh those those tighter",
    "start": "889759",
    "end": "895199"
  },
  {
    "text": "confidence intervals um One Thing Worth noting here it's not really important",
    "start": "895199",
    "end": "901279"
  },
  {
    "text": "but the the point estimates from Cupid results are different from non- Cupid results and that just makes like makes",
    "start": "901279",
    "end": "909880"
  },
  {
    "text": "people's heads hurt sometimes so they're both consistent estimators of the same thing um the actual measured difference",
    "start": "909880",
    "end": "917279"
  },
  {
    "text": "that you see or like The observed lift is not the true lift in the first place and likewise with Cupid applied uh the",
    "start": "917279",
    "end": "925360"
  },
  {
    "text": "uh sort of predicted lift or the estimated lift is also not equal uh to the true lift but it's a consistent",
    "start": "925360",
    "end": "931319"
  },
  {
    "text": "estimator of that so uh just some little wrinkle that you might have to describe to uh to Cupid users okay so that was",
    "start": "931319",
    "end": "939040"
  },
  {
    "text": "all well and good uh people were happy big huray uh until the uh scary",
    "start": "939040",
    "end": "948319"
  },
  {
    "text": "ellipses start seeing things like this uh which uh most developers have seen at",
    "start": "948319",
    "end": "954040"
  },
  {
    "text": "some point in their life um in some way shape or form this this and in our case",
    "start": "954040",
    "end": "960040"
  },
  {
    "text": "it was the node was low on resource memory as some container was trying to use a ridiculous amount of memory which",
    "start": "960040",
    "end": "965880"
  },
  {
    "text": "exceeded the request size and so it's evicted and the processor kubernetes pot",
    "start": "965880",
    "end": "971959"
  },
  {
    "text": "is killed uh without ceremony so this is a uh this an actual slack message I got from one of my",
    "start": "971959",
    "end": "978240"
  },
  {
    "text": "co-workers one morning um after some of the a cupid process was running on one",
    "start": "978240",
    "end": "983279"
  },
  {
    "text": "of our larger customers uh he just said whoo pasted in this graphic of memory",
    "start": "983279",
    "end": "988720"
  },
  {
    "text": "consumption and what caused big spiky um",
    "start": "988720",
    "end": "994319"
  },
  {
    "text": "and this became a recurring pain point is uh is memory so in memory analytics",
    "start": "994319",
    "end": "1000720"
  },
  {
    "text": "is all sounds well and good but it there ends up being a lot of operational issues in terms of provisioning machines",
    "start": "1000720",
    "end": "1007440"
  },
  {
    "text": "with the amount of memory that you need knowing in advance how much memory you will need before you provision that",
    "start": "1007440",
    "end": "1012720"
  },
  {
    "text": "machine uh paying for it uh like keeping data in memory kind of the second point",
    "start": "1012720",
    "end": "1018160"
  },
  {
    "text": "is about 500 times more expensive than keeping it on disk and then finally getting data from your Warehouse in the",
    "start": "1018160",
    "end": "1025280"
  },
  {
    "text": "memory can take a long time so if you look at this graph this is actually just",
    "start": "1025280",
    "end": "1030520"
  },
  {
    "text": "our python process trying to download data from Snowflake for 3 hours and slowly growing its own memory usage and",
    "start": "1030520",
    "end": "1037839"
  },
  {
    "text": "then finally at the end of I guess three three and a half hours uh it has everything in memory and then tries to",
    "start": "1037839",
    "end": "1044480"
  },
  {
    "text": "Pivot it and that's where this big spiky comes in uh and kills the process so we",
    "start": "1044480",
    "end": "1050760"
  },
  {
    "text": "just started to hit some pain uh this is a we did an investigation into our uh",
    "start": "1050760",
    "end": "1056799"
  },
  {
    "text": "python process and our Cupid jobs it's just a screenshot from this internal investigation that we did um and about",
    "start": "1056799",
    "end": "1065080"
  },
  {
    "text": "half the jobs failed some would take 13 hours and succeed others would take three hours and run out of memory um and",
    "start": "1065080",
    "end": "1073240"
  },
  {
    "text": "a lot of this time kind of in the last column you see there was just from fetching and pivoting data just really",
    "start": "1073240",
    "end": "1078840"
  },
  {
    "text": "just downloading data from the warehouse and then trying to get it into a form that pandas could use um and so this",
    "start": "1078840",
    "end": "1086400"
  },
  {
    "text": "this is my life for a few weeks just trying to to debug these issues so may maybe it looks familiar uh to some of",
    "start": "1086400",
    "end": "1092440"
  },
  {
    "text": "you out there okay so how do how do we get",
    "start": "1092440",
    "end": "1097520"
  },
  {
    "text": "around this uh we kind of took the python process uh to the limit of of what we could uh do with that",
    "start": "1097520",
    "end": "1104159"
  },
  {
    "text": "architecture and then we started casting about just for some other ideas uh to get around the the memory issues in in",
    "start": "1104159",
    "end": "1111280"
  },
  {
    "text": "particular uh two options that we considered are described here the first is use a warehouse specific machine",
    "start": "1111280",
    "end": "1117720"
  },
  {
    "text": "learning solution um red shift has Sage maker big query has uh big query ml I'm",
    "start": "1117720",
    "end": "1124159"
  },
  {
    "text": "not sure if snowflake has anything yet um and then data bricks is uh hooked up",
    "start": "1124159",
    "end": "1129559"
  },
  {
    "text": "to spark um for our use case we needed to support all four warehouses like some",
    "start": "1129559",
    "end": "1136080"
  },
  {
    "text": "of our customers are on each Warehouse um so there would they would have been costs associated with using a kind of",
    "start": "1136080",
    "end": "1143840"
  },
  {
    "text": "developing against a specific Warehouse whereas the rest of our code base might have only one or 200 lines of Warehouse",
    "start": "1143840",
    "end": "1149919"
  },
  {
    "text": "specific code uh the advantage of this approach is that you don't have to move",
    "start": "1149919",
    "end": "1155840"
  },
  {
    "text": "the data out of the warehouse or at least from the customer's perspective it doesn't look like you're moving it out",
    "start": "1155840",
    "end": "1161400"
  },
  {
    "text": "there there's still kind of physical data movement happening from you know big queries uh table system to their ml",
    "start": "1161400",
    "end": "1169159"
  },
  {
    "text": "system uh which does have uh time and costs associated with it but from the customer perspective they just think",
    "start": "1169159",
    "end": "1175679"
  },
  {
    "text": "it's all sitting there um but the the drawback there are those extra costs",
    "start": "1175679",
    "end": "1181159"
  },
  {
    "text": "associated with moving that around and using kind of these fancy ml systems and",
    "start": "1181159",
    "end": "1186320"
  },
  {
    "text": "there also extra permissions required for some of this so it we got in kind of an awkward situation where trying to ask",
    "start": "1186320",
    "end": "1193280"
  },
  {
    "text": "customers to grant us more permissions on their warehouse account uh and trying to EXP explain why we needed it compared",
    "start": "1193280",
    "end": "1199559"
  },
  {
    "text": "to just the the read only big query account that we had uh so there there are some real real uh drawbacks uh to",
    "start": "1199559",
    "end": "1206880"
  },
  {
    "text": "that approach another option uh would have been using Apache spark or or data",
    "start": "1206880",
    "end": "1212000"
  },
  {
    "text": "bricks and just moving all that data out to a scalable system that knows how to",
    "start": "1212000",
    "end": "1217200"
  },
  {
    "text": "do linear regression and has kind of solved this problem of um yeah trying to trying to run regressions on large data",
    "start": "1217200",
    "end": "1224120"
  },
  {
    "text": "sets that would have been nice because it would work across warehouses uh the downside of course is that we have to",
    "start": "1224120",
    "end": "1230440"
  },
  {
    "text": "move data out um we do have a lot of customers who are in uh kind of",
    "start": "1230440",
    "end": "1237559"
  },
  {
    "text": "constrained regulatory environments or are sensitive about pii leaving their",
    "start": "1237559",
    "end": "1242640"
  },
  {
    "text": "systems um and so they weren't too keen on us downloading data either into a",
    "start": "1242640",
    "end": "1247679"
  },
  {
    "text": "python process or into a spark process so we considered those and then",
    "start": "1247679",
    "end": "1255559"
  },
  {
    "text": "we thought about uh what if there's another way here so this is a quote I",
    "start": "1255559",
    "end": "1261280"
  },
  {
    "text": "first came across this it's like in the essays of Francis Bacon I think it's kind of famous at this point there's a",
    "start": "1261280",
    "end": "1267480"
  },
  {
    "text": "story in I don't know if it's a apocryphal or in the Quran but um Muhammad is with a number of his",
    "start": "1267480",
    "end": "1275000"
  },
  {
    "text": "followers and at some point commands this mountain to uh to move to him and of course the mountain doesn't go",
    "start": "1275000",
    "end": "1281159"
  },
  {
    "text": "anywhere and so he kind of smiles and says well if the mountain won't come to Muhammad then Muhammad must go to the",
    "start": "1281159",
    "end": "1286840"
  },
  {
    "text": "mountain um and I like this because you know if if the uh if the data won't come",
    "start": "1286840",
    "end": "1292080"
  },
  {
    "text": "to you or to come to your computation maybe you should bring your computation uh to the data and so that will be the",
    "start": "1292080",
    "end": "1299799"
  },
  {
    "text": "uh the theme of the rest of this",
    "start": "1299799",
    "end": "1302919"
  },
  {
    "text": "talk all right so what are we actually trying to do um our specific predictive",
    "start": "1305600",
    "end": "1310799"
  },
  {
    "text": "model was just a linear regression it's wasn't the super simple one that I showed you um but essentially we are",
    "start": "1310799",
    "end": "1317480"
  },
  {
    "text": "trying to predict the value of each metric using all metrics for a specific",
    "start": "1317480",
    "end": "1323840"
  },
  {
    "text": "user uh so the the basic linear regression equation if you remember from you know a stat a stat class or",
    "start": "1323840",
    "end": "1330200"
  },
  {
    "text": "ecometrics class I'm trying to solve x beta equals y you're solving for beta uh",
    "start": "1330200",
    "end": "1336039"
  },
  {
    "text": "why are your covariates or your inputs uh these dependent variables so these would be uh previous values of metrics",
    "start": "1336039",
    "end": "1344200"
  },
  {
    "text": "uh so we'd have uh one row per user one column per metric value and then we want",
    "start": "1344200",
    "end": "1349720"
  },
  {
    "text": "to predict each user's uh value for a single metric and that's going to be our y column and then beta is just our uh",
    "start": "1349720",
    "end": "1358400"
  },
  {
    "text": "kind of best fit coefficient Vector so nothing nothing too crazy here that",
    "start": "1358400",
    "end": "1363720"
  },
  {
    "text": "we're doing um the solution to this equation is this very famous equation uh",
    "start": "1363720",
    "end": "1370640"
  },
  {
    "text": "the beta hat um or the estimated beta X Prim X inverse X Prime Y and so I really",
    "start": "1370640",
    "end": "1377360"
  },
  {
    "text": "want to just look at this equation and figure out if we really needed um python",
    "start": "1377360",
    "end": "1382760"
  },
  {
    "text": "or anything too fancy to compute this thing and so our our core Insight was",
    "start": "1382760",
    "end": "1388559"
  },
  {
    "text": "this that this x Prime X Matrix is a k byk m Matrix so if if K is the number of",
    "start": "1388559",
    "end": "1395240"
  },
  {
    "text": "columns or metrics then the the result of this product is not a gigantic M",
    "start": "1395240",
    "end": "1402360"
  },
  {
    "text": "Matrix with like you know a million rows or a million columns this this is a very small Matrix uh so if we have 10 metrics",
    "start": "1402360",
    "end": "1409919"
  },
  {
    "text": "that we're interested in the X Prime X Matrix will be a 10x10 Matrix and it",
    "start": "1409919",
    "end": "1417600"
  },
  {
    "text": "turns out each cell is very simple to compute in SQL um if we have a constant term then the top left term will just be",
    "start": "1417600",
    "end": "1424720"
  },
  {
    "text": "a count of the number of rows like we all know how to do that in SQL uh this",
    "start": "1424720",
    "end": "1429919"
  },
  {
    "text": "top row um and the First Column here again if there's a constant term it's",
    "start": "1429919",
    "end": "1435320"
  },
  {
    "text": "just going to be the sum of each column uh and then each one in the middle is a",
    "start": "1435320",
    "end": "1440360"
  },
  {
    "text": "sum of an x times another X and so this is very easily expressed um as a as a as",
    "start": "1440360",
    "end": "1449159"
  },
  {
    "text": "a select uh and turns out these warehouses are are highly optimized for",
    "start": "1449159",
    "end": "1454440"
  },
  {
    "text": "these kinds of problems of multip you know multiplication uh and",
    "start": "1454440",
    "end": "1459600"
  },
  {
    "text": "addition so similarly the other half of that equation x Prime y uh is also very",
    "start": "1459600",
    "end": "1466279"
  },
  {
    "text": "simple uh first term is just going to the sum of y's and then the other terms will be sums of various X's times",
    "start": "1466279",
    "end": "1474080"
  },
  {
    "text": "y's so what does that mean we can do uh if if we can compute those two terms uh",
    "start": "1474120",
    "end": "1479320"
  },
  {
    "text": "in SQL then we can solve the rest of the equation kind of in the control plane or at the application Level uh so this is",
    "start": "1479320",
    "end": "1486720"
  },
  {
    "text": "um yeah just a little screenshot from our new code base um but what this is",
    "start": "1486720",
    "end": "1492120"
  },
  {
    "text": "doing is after after we've computed the xpre X and X Prime y using SQL then and",
    "start": "1492120",
    "end": "1498440"
  },
  {
    "text": "we can just invert it which is the second line of code um multiply the X",
    "start": "1498440",
    "end": "1504039"
  },
  {
    "text": "Prim X inverse by X Prime Y which is the third line of code and then get a variance covariance Matrix out of the",
    "start": "1504039",
    "end": "1510799"
  },
  {
    "text": "end with a fourth line of code and you don't need python for this uh any",
    "start": "1510799",
    "end": "1516760"
  },
  {
    "text": "library or any language that has a a matrix Library um and a uh kind of a set",
    "start": "1516760",
    "end": "1522960"
  },
  {
    "text": "of of special functions if you want to get P values and things is is sufficient uh so we ended up being able to do this",
    "start": "1522960",
    "end": "1528840"
  },
  {
    "text": "using uh uh typescript for our control",
    "start": "1528840",
    "end": "1534360"
  },
  {
    "text": "plane so what's the new architecture look like um it's something like this uh",
    "start": "1534440",
    "end": "1539640"
  },
  {
    "text": "so we've got that big data still sitting in the warehouse um but now we just do a lot of extra compute in that warehouse",
    "start": "1539640",
    "end": "1546880"
  },
  {
    "text": "so we do all those sums of x times y's in the warehouse um and then only",
    "start": "1546880",
    "end": "1552080"
  },
  {
    "text": "instead of downloading the subject level data uh to our systems we just download",
    "start": "1552080",
    "end": "1557440"
  },
  {
    "text": "that X Prime X Matrix and the xpre Y Matrix to our system do the Matrix inversion the multiplication get the",
    "start": "1557440",
    "end": "1563880"
  },
  {
    "text": "variance coari Matrix and this is all I've labeled small data uh since it's just those K byk matrices and then get",
    "start": "1563880",
    "end": "1571799"
  },
  {
    "text": "the same kind of tiny data or results out the other end which is just the um",
    "start": "1571799",
    "end": "1577200"
  },
  {
    "text": "actual experiment results kind of being written to our production database how to work in practice uh we",
    "start": "1577200",
    "end": "1585799"
  },
  {
    "text": "saw some pretty big speedups so I just picked a couple of uh specific experiments that had uh been around kind",
    "start": "1585799",
    "end": "1592200"
  },
  {
    "text": "of before our architecture change and after we had one go from 9 hours down to I think 45 minutes another one go from",
    "start": "1592200",
    "end": "1599880"
  },
  {
    "text": "uh 9 minutes down to under a minute um this really just speaks to uh how long",
    "start": "1599880",
    "end": "1606120"
  },
  {
    "text": "just how long it takes to download data out of a warehouse um and also just how well these warehouses do with sums um",
    "start": "1606120",
    "end": "1614520"
  },
  {
    "text": "and multiplications we we have some fairly complex models I think the most",
    "start": "1614520",
    "end": "1619799"
  },
  {
    "text": "complicated is uh like a 300x300 matrix but these big query just tears through",
    "start": "1619799",
    "end": "1625960"
  },
  {
    "text": "them U it does all the parallelization both the column level and row level for us um it's just it's really good they're",
    "start": "1625960",
    "end": "1632559"
  },
  {
    "text": "really good at what they do and we're able to leverage that in our new",
    "start": "1632559",
    "end": "1637799"
  },
  {
    "text": "system so yeah so what are the benefits of this architecture uh it's this system",
    "start": "1637799",
    "end": "1643320"
  },
  {
    "text": "works across warehouses pretty well so works on all four warehouses as I uh said earlier our warehouse specific code",
    "start": "1643320",
    "end": "1650279"
  },
  {
    "text": "is just one or two hundred lines of code per Warehouse so if we want to add another one an engineer it could you",
    "start": "1650279",
    "end": "1655480"
  },
  {
    "text": "know do it in a few days uh we use existing application language and infrastructure and this has been a",
    "start": "1655480",
    "end": "1661360"
  },
  {
    "text": "really big gain for us U prior to this change we had sort of like a little python universe and a typescript",
    "start": "1661360",
    "end": "1668720"
  },
  {
    "text": "universe and it was it was just hard to move Engineers between those two code bases um we had all kinds of duplication",
    "start": "1668720",
    "end": "1675679"
  },
  {
    "text": "just trying to communicate our data model from the typescript land over into python land so it could just be just",
    "start": "1675679",
    "end": "1682600"
  },
  {
    "text": "simple things like describing what are the experiments where are the variants where do the treatments um how do we get",
    "start": "1682600",
    "end": "1688519"
  },
  {
    "text": "that over from our main application into this external system do we need a microservice around it all those",
    "start": "1688519",
    "end": "1694640"
  },
  {
    "text": "problems go away uh once we're kind of on a unified um unified language and",
    "start": "1694640",
    "end": "1699760"
  },
  {
    "text": "able just to reuse Frameworks uh both for statistical and regular application",
    "start": "1699760",
    "end": "1706440"
  },
  {
    "text": "code we don't move data uh out of the warehouse this is very good for uh",
    "start": "1706440",
    "end": "1711640"
  },
  {
    "text": "customers who value that privacy uh we can assure them that we never see user level data they're you know makes the",
    "start": "1711640",
    "end": "1718919"
  },
  {
    "text": "sock two people happy and everybody everybody a lot happier uh when we don't actually see see their users um and then",
    "start": "1718919",
    "end": "1727519"
  },
  {
    "text": "as you saw in the graphs uh you get much faster results out of this thing the architecture is a lot simpler uh we're",
    "start": "1727519",
    "end": "1732600"
  },
  {
    "text": "just able to rip out a lot of code uh which always always makes me happy uh and then finally we don't see a lot of",
    "start": "1732600",
    "end": "1739480"
  },
  {
    "text": "out of memory errors anymore previously we were we just kept doubling the amount of memory that we try to provision for",
    "start": "1739480",
    "end": "1744919"
  },
  {
    "text": "these python uh nodes starting from 20 Gigabytes 40 80 I think we topped out at",
    "start": "1744919",
    "end": "1750320"
  },
  {
    "text": "160 uh before we moved on to this architecture and as we were running the",
    "start": "1750320",
    "end": "1755960"
  },
  {
    "text": "math like we weren't making much money off of our contracts with the customers just because it was all going into these",
    "start": "1755960",
    "end": "1762200"
  },
  {
    "text": "high memory machines uh that are really not that cheap on these Cloud systems",
    "start": "1762200",
    "end": "1768120"
  },
  {
    "text": "and now I think the mod yeah the biggest node we have is 2 gigabytes but you know it's not all",
    "start": "1768120",
    "end": "1774679"
  },
  {
    "text": "sunshine and Roses uh just a few pitfalls that we ran into along the way um some of these queries do get very",
    "start": "1774679",
    "end": "1780760"
  },
  {
    "text": "large uh was actually able to hit the one megabyte uh like select query limit",
    "start": "1780760",
    "end": "1785919"
  },
  {
    "text": "in Snowflake just with the sheer number of sums that we were doing for some of these these large models and also found",
    "start": "1785919",
    "end": "1793519"
  },
  {
    "text": "up that red shift has a column limit of 1,600 in their their result sets uh so",
    "start": "1793519",
    "end": "1799399"
  },
  {
    "text": "you got to break up some of these queries into multiple queries it doesn't have a huge effect on throughput because",
    "start": "1799399",
    "end": "1805559"
  },
  {
    "text": "uh the second point is you can parallelize just by uh querying concurrently uh warehouses are very good",
    "start": "1805559",
    "end": "1813799"
  },
  {
    "text": "at um yeah just taking multiple concurrent queries and then doing their own parallelization within each query it",
    "start": "1813799",
    "end": "1820600"
  },
  {
    "text": "helps to have a language that lets you do uh concurrent querying like a promise.all uh which we use in our",
    "start": "1820600",
    "end": "1826600"
  },
  {
    "text": "node.js you can still hit o um I think we've hit a few just because in JavaScript it's",
    "start": "1826600",
    "end": "1834159"
  },
  {
    "text": "not like this super dense Matrix representation they're like box Primitives and arrays and things um not",
    "start": "1834159",
    "end": "1841399"
  },
  {
    "text": "a huge deal but just something to be aware of uh if it's if it's not like just this tight array or a tight Matrix",
    "start": "1841399",
    "end": "1847880"
  },
  {
    "text": "of floating Point numbers and then another little gotcha that I hit the second to last point is one point like",
    "start": "1847880",
    "end": "1855440"
  },
  {
    "text": "the literal 1.0 doesn't mean the same thing across warehouses like there's no such thing as standard SQL some",
    "start": "1855440",
    "end": "1861799"
  },
  {
    "text": "warehouses that's a floating Point number other warehouses that's a like fixed Precision decimal number if you're",
    "start": "1861799",
    "end": "1867799"
  },
  {
    "text": "not really paying attention to this stuff you'll just get these weird uh overflows um or errors where it's trying",
    "start": "1867799",
    "end": "1874960"
  },
  {
    "text": "to mix uh fix precision and floating Point uh Precision uh arithmetic so just",
    "start": "1874960",
    "end": "1880600"
  },
  {
    "text": "make sure everything's float and your life will be a lot easier and then the last little Gua this is sort of an",
    "start": "1880600",
    "end": "1886880"
  },
  {
    "text": "advanc Point uh but we tried implementing like heteros scades Dy robust standard errors and that got a",
    "start": "1886880",
    "end": "1894639"
  },
  {
    "text": "little bit trickier because we couldn't use the same trick of like reusing this x- Prime X Matrix um I don't really want",
    "start": "1894639",
    "end": "1900679"
  },
  {
    "text": "to get into it but um yeah it it would have ended up being a lot more computation uh than we signed up for but",
    "start": "1900679",
    "end": "1908080"
  },
  {
    "text": "the for for plain OS problems where you have the same um equation structure with",
    "start": "1908080",
    "end": "1914240"
  },
  {
    "text": "the same uh specification on the uh right hand side you can reuse that X Prime X which will will make everybody",
    "start": "1914240",
    "end": "1922960"
  },
  {
    "text": "happy all right future directions uh where where can we take this thing I",
    "start": "1922960",
    "end": "1928559"
  },
  {
    "text": "spent time over Christmas just trying to get quanta regression working on these warehouses it's a really neat paper from",
    "start": "1928559",
    "end": "1935440"
  },
  {
    "text": "Roger kinker about this what he calls the FR Newton method it happens the map really well to uh kind of just like the",
    "start": "1935440",
    "end": "1942360"
  },
  {
    "text": "warehouse architecture or sequel tables I had fun doing it it's an iterative method it seemed to work pretty well uh",
    "start": "1942360",
    "end": "1949320"
  },
  {
    "text": "we haven't done it in production or anything uh but it was it was a neat little proof of concept that you can do",
    "start": "1949320",
    "end": "1954679"
  },
  {
    "text": "other kind of nonlinear regressions uh if you'd like and so that the way that works instead of minimizing the square",
    "start": "1954679",
    "end": "1961039"
  },
  {
    "text": "of the errors it'll minimize like an absolute value of the error Ridge regression that's just another variant",
    "start": "1961039",
    "end": "1967880"
  },
  {
    "text": "of uh OS you just add like a k * I term across the matrices um pretty easy to",
    "start": "1967880",
    "end": "1975000"
  },
  {
    "text": "add um we that's what we do in our our production code so that works as well I",
    "start": "1975000",
    "end": "1981200"
  },
  {
    "text": "pretty sure a lot of different generalized linear models could work here um and kind of in my previous job I",
    "start": "1981200",
    "end": "1986840"
  },
  {
    "text": "implemented a lot of these by hand in a non-server context like probit logistic regression pan regression all all your",
    "start": "1986840",
    "end": "1995240"
  },
  {
    "text": "uh yeah favorite glm models and I'm fairly confident could be done but with",
    "start": "1995240",
    "end": "2000880"
  },
  {
    "text": "one caveat I'll point out on the next slide uh yeah or your algorithm here um",
    "start": "2000880",
    "end": "2008360"
  },
  {
    "text": "I I'm pretty excited just kind of that the results that we were able to get just going back to those core equations",
    "start": "2008360",
    "end": "2013720"
  },
  {
    "text": "and scratching our head a bit and seeing if we could Implement these uh in warehouses a lot of these algorithms are",
    "start": "2013720",
    "end": "2019480"
  },
  {
    "text": "really just dot products they are just sum of X X Y uh like like large language",
    "start": "2019480",
    "end": "2025679"
  },
  {
    "text": "models kind of fall in this category although I'm not going to tell anybody to do try to do that warehouses are just",
    "start": "2025679",
    "end": "2033600"
  },
  {
    "text": "hyper optimized for multiplying and adding um that's it's what they do well let let them do",
    "start": "2033600",
    "end": "2039799"
  },
  {
    "text": "what they're good at uh the one caveat here is for certain types of models you might want a uh a special function",
    "start": "2039799",
    "end": "2047360"
  },
  {
    "text": "that's going to operate at the at the row level like a log gamma function damma kind of all these uh special",
    "start": "2047360",
    "end": "2053440"
  },
  {
    "text": "functions you might see in a statistics textbook that might not be available natively in a SQL environment for those",
    "start": "2053440",
    "end": "2060158"
  },
  {
    "text": "things you might need to implement that as a UDF warehouses have all kinds of UDF Solutions either with python or Java",
    "start": "2060159",
    "end": "2067079"
  },
  {
    "text": "script or just kind of implementing a polinomial approximation yourself um so that might be necessary if you're going",
    "start": "2067079",
    "end": "2073158"
  },
  {
    "text": "to do something like a probate regression so kind of wrapping up why",
    "start": "2073159",
    "end": "2079520"
  },
  {
    "text": "would you consider this uh architecture of portability if if you have are just",
    "start": "2079520",
    "end": "2085638"
  },
  {
    "text": "trying to do ml across warehouses s there's nothing more portable than SQL",
    "start": "2085639",
    "end": "2090760"
  },
  {
    "text": "uh I I put worse is better in quotation marks here this is a reference to a famous essay about Unix arguing that",
    "start": "2090760",
    "end": "2097400"
  },
  {
    "text": "Unix became popular in the 70s because it it was worse than the uh Alternatives",
    "start": "2097400",
    "end": "2102680"
  },
  {
    "text": "um it was easier to implement because it had fewer features if you can do things in SQL you can kind of do them",
    "start": "2102680",
    "end": "2108960"
  },
  {
    "text": "anywhere uh if your Warehouse specific ml bills are getting out of control um",
    "start": "2108960",
    "end": "2114760"
  },
  {
    "text": "this would also be another reason to uh to consider this I I think there's just a lot of unnecessary overhead um with",
    "start": "2114760",
    "end": "2121280"
  },
  {
    "text": "those systems both moving the data over to them and the type of compute that's done uh on them",
    "start": "2121280",
    "end": "2127560"
  },
  {
    "text": "um data movement taking too long it's if it's being too annoying think about this",
    "start": "2127560",
    "end": "2133720"
  },
  {
    "text": "um if you're ml stack feels fragile if you're hitting all those om as frequently as we",
    "start": "2133720",
    "end": "2139520"
  },
  {
    "text": "were warehouses are very robust there are certain types of operations where that they're you start to hit their",
    "start": "2139520",
    "end": "2146079"
  },
  {
    "text": "limits if you're doing like trying to do 50 sub selects or do all these percentile calculations but for sums and",
    "start": "2146079",
    "end": "2153079"
  },
  {
    "text": "multiplications you're not going to break the warehouse um but you you might might break your uh your python process",
    "start": "2153079",
    "end": "2159359"
  },
  {
    "text": "and then finally of course uh you're just born want to try something new um be be happy to to tell you more so",
    "start": "2159359",
    "end": "2166680"
  },
  {
    "text": "that's all I have thanks for listening yeah this is a this is a very",
    "start": "2166680",
    "end": "2172599"
  },
  {
    "text": "interesting talk I am fascinated by the um continual use of SQL databases for",
    "start": "2172599",
    "end": "2178640"
  },
  {
    "text": "things that I didn't expect um my question for you is uh how many how many",
    "start": "2178640",
    "end": "2183720"
  },
  {
    "text": "co-variants because it seemed like um the it seems like the Crux of the solution",
    "start": "2183720",
    "end": "2189240"
  },
  {
    "text": "is that the number of covariants is not too large right um because the problem",
    "start": "2189240",
    "end": "2194560"
  },
  {
    "text": "it seemed like you were having was you had uh you R get too much data and um but if you think about things in terms",
    "start": "2194560",
    "end": "2200839"
  },
  {
    "text": "of covariant then uh it stays small um how long how long is that true for like",
    "start": "2200839",
    "end": "2206760"
  },
  {
    "text": "how many covariant do you have to add before this before you have to start thinking approach yeah that's a good question um",
    "start": "2206760",
    "end": "2214359"
  },
  {
    "text": "so I our architecture currently we deal with about I don't know kind of tens of",
    "start": "2214359",
    "end": "2222079"
  },
  {
    "text": "millions of subjects or or rows and up to maybe 300 covariants I think is our",
    "start": "2222079",
    "end": "2227880"
  },
  {
    "text": "largest model um if you saw the specific limitations there was the snowflake one",
    "start": "2227880",
    "end": "2234040"
  },
  {
    "text": "megabyte query limit kicks in we've we've hit that at the with those 300 uh",
    "start": "2234040",
    "end": "2239760"
  },
  {
    "text": "then there's the red shift 1600 column limit so if you think of a 300x300",
    "start": "2239760",
    "end": "2245040"
  },
  {
    "text": "matrix it's going to be whatever 90,000 uh entries in that Matrix um you're",
    "start": "2245040",
    "end": "2252599"
  },
  {
    "text": "going to have I I don't know what 70 um separate queries just to get red shift",
    "start": "2252599",
    "end": "2259040"
  },
  {
    "text": "to process through all of those um so I I think if you start going much beyond",
    "start": "2259040",
    "end": "2265280"
  },
  {
    "text": "that and um yeah you you just have to kind of break it up in into more and more queries I think yeah I it's an",
    "start": "2265280",
    "end": "2273079"
  },
  {
    "text": "engineering problem that that's those are uh sort of the constraints around that I'm not going to put a hard and fast rule but think of you get up to",
    "start": "2273079",
    "end": "2279839"
  },
  {
    "text": "like yeah if if your application environment does not have good dense",
    "start": "2279839",
    "end": "2286960"
  },
  {
    "text": "Matrix representation uh then you're also going to hit trouble if you have like you're like you know 10,000 by",
    "start": "2286960",
    "end": "2292359"
  },
  {
    "text": "10,000 or something and trying to represent you know 100 million objects like like box numbers uh you're you're",
    "start": "2292359",
    "end": "2299079"
  },
  {
    "text": "not going to be in in for a good time um so yeah I I'm I'm I'm sure people could",
    "start": "2299079",
    "end": "2306000"
  },
  {
    "text": "take it take it further than we have but um yeah that's that's the way that I would think about TR to scale system",
    "start": "2306000",
    "end": "2313440"
  },
  {
    "text": "up",
    "start": "2313480",
    "end": "2316480"
  },
  {
    "text": "than uh you mentioned you you did like some query partition you broke you",
    "start": "2323040",
    "end": "2329160"
  },
  {
    "text": "generated multiple queries able to tackle this problem yeah uh the speed up that you showed into the 9 and half",
    "start": "2329160",
    "end": "2335200"
  },
  {
    "text": "hours 45 minutes was paration on the quy side yeah yeah there's um yes a lot of",
    "start": "2335200",
    "end": "2341400"
  },
  {
    "text": "parallelization on the query side so so even though the time is shorter because like in these systems like Qui the query",
    "start": "2341400",
    "end": "2348760"
  },
  {
    "text": "time transl cost yeah for single queries and then pariz how's the cost side of",
    "start": "2348760",
    "end": "2354319"
  },
  {
    "text": "this yeah so I it it does move cost into the warehouse um what we've seen is it's",
    "start": "2354319",
    "end": "2363640"
  },
  {
    "text": "not really it's not the big cost center yet compared to um Computing on the like",
    "start": "2363640",
    "end": "2371200"
  },
  {
    "text": "summing over the number of events and facts and condensing that into subject level data um I'd say it's about kind of",
    "start": "2371200",
    "end": "2378480"
  },
  {
    "text": "5050 between the the cupid part of things and the everything else part of things um it also just it depends on the",
    "start": "2378480",
    "end": "2385400"
  },
  {
    "text": "kind of the warehouse billing model um so for a snowflake in particular um time",
    "start": "2385400",
    "end": "2391640"
  },
  {
    "text": "equals cost like it's they they bill you for the number of minutes that your snowflake cluster is running and so yeah",
    "start": "2391640",
    "end": "2397640"
  },
  {
    "text": "that's a nice one toone kind of cost model um but yeah so it's it's uh yeah",
    "start": "2397640",
    "end": "2403920"
  },
  {
    "text": "for especially since since the compute grows as like K squared as you add tons",
    "start": "2403920",
    "end": "2408960"
  },
  {
    "text": "of co-variants that's going to add a computation quadratically so yeah that's",
    "start": "2408960",
    "end": "2414560"
  },
  {
    "text": "something to be aware of and the subject you mentioned like hundreds of millions this is after plan Cupid to reduce the",
    "start": "2414560",
    "end": "2420400"
  },
  {
    "text": "number of subjects you would need to draw right so it it kind of depends on",
    "start": "2420400",
    "end": "2426119"
  },
  {
    "text": "whe the customer decides to you like use the variance reduction to reduce the",
    "start": "2426119",
    "end": "2432119"
  },
  {
    "text": "number of subjects in the in the experiment or just to get more precise estimates um using the same number so we",
    "start": "2432119",
    "end": "2439119"
  },
  {
    "text": "we you we can't tell them to to uh use fewer subjects yeah but it could take",
    "start": "2439119",
    "end": "2445319"
  },
  {
    "text": "yeah take that number down 50% or [Applause]",
    "start": "2445319",
    "end": "2450770"
  },
  {
    "text": "[Music] so",
    "start": "2451470",
    "end": "2458319"
  }
]