[
  {
    "start": "0",
    "end": "107000"
  },
  {
    "text": "[Music]",
    "start": "110",
    "end": "22480"
  },
  {
    "text": "how many people here build mobile apps or mobile websites yeah I hear this mobile thing",
    "start": "22480",
    "end": "28240"
  },
  {
    "text": "is kind of a big thing um so what I want to talk about today is building faster mobile websites and faster is kind of an",
    "start": "28240",
    "end": "35640"
  },
  {
    "text": "ambiguous term right we could share a lot of tips we could talk about a lot of techniques so what I thought uh we would",
    "start": "35640",
    "end": "40800"
  },
  {
    "text": "do here is actually take uh kind of put some constraints on the problem the",
    "start": "40800",
    "end": "45960"
  },
  {
    "text": "first constraint is maybe even as a thought experiment what would it take to build a mobile website to render in one",
    "start": "45960",
    "end": "51719"
  },
  {
    "text": "sec that renders in one second right that's first um and and second we want we want it to be actually visible within",
    "start": "51719",
    "end": "58680"
  },
  {
    "text": "one second so so by setting that constraint we can actually work backwards like in instead of just",
    "start": "58680",
    "end": "63840"
  },
  {
    "text": "enumerating all the techniques for how we can make our sites fast we can actually start looking from the ground up like what how long does a network",
    "start": "63840",
    "end": "70360"
  },
  {
    "text": "take how long does a browser take and what what does that uh give you and what kind of leway do you have so we're going",
    "start": "70360",
    "end": "76439"
  },
  {
    "text": "to look at uh Network performance we're going to look at how the browser renders the page and then we're going to try and piece it all back together",
    "start": "76439",
    "end": "83320"
  },
  {
    "text": "so let's get right in first of all uh",
    "start": "83320",
    "end": "88360"
  },
  {
    "text": "before we even get into the technical uh part of it part of this presentation I always like to talk about why we care",
    "start": "88360",
    "end": "94880"
  },
  {
    "text": "about this in the first place right like why do we want to make stuff fast U it certainly feels nice when something is",
    "start": "94880",
    "end": "100759"
  },
  {
    "text": "fast and when it's responsive but we actually have very good data to show that it also translates into revenue and",
    "start": "100759",
    "end": "106560"
  },
  {
    "text": "engagement with your applications and all the rest so I'll I'll share a couple of examples with you this is an experiment that we did at Google",
    "start": "106560",
    "end": "112960"
  },
  {
    "start": "107000",
    "end": "107000"
  },
  {
    "text": "actually a few years ago and uh the experiment was basically what happens if we actually make search",
    "start": "112960",
    "end": "118840"
  },
  {
    "text": "slower we intentionally made the search slower for for a group of users and we picked we put them into different",
    "start": "118840",
    "end": "124520"
  },
  {
    "text": "buckets we said well uh we're going to slow you down by 50 milliseconds this",
    "start": "124520",
    "end": "129720"
  },
  {
    "text": "group by 200 milliseconds and we're going to observe the changes in your behavior right and further we will also",
    "start": "129720",
    "end": "135680"
  },
  {
    "text": "delay it in kind of different ways for some users we will delay the rendering",
    "start": "135680",
    "end": "141239"
  },
  {
    "text": "of the search results for some of the users we will delay rendering of the header and basically just trying to figure out like how do how do users",
    "start": "141239",
    "end": "147080"
  },
  {
    "text": "change their behavior and what we found was that the impact on the daily searches actually went down the moment",
    "start": "147080",
    "end": "153440"
  },
  {
    "text": "we slowed down the pages so once we added 200 to 400 milliseconds which is",
    "start": "153440",
    "end": "158640"
  },
  {
    "text": "not a lot of time when you think about it the number of daily searches went down by anywhere from 0.5 to .3% now",
    "start": "158640",
    "end": "165159"
  },
  {
    "text": "that may not seem like such a big deal but trust me when you work at Google scale when your search uh volume goes",
    "start": "165159",
    "end": "171000"
  },
  {
    "text": "down by .3% there's a lot of alarm Bells going off in the building so but that's",
    "start": "171000",
    "end": "176640"
  },
  {
    "text": "not not only Google actually Bing did the same study uh in par and what they found was they actually were more",
    "start": "176640",
    "end": "181959"
  },
  {
    "start": "178000",
    "end": "178000"
  },
  {
    "text": "aggressive they actually delayed some of their Pages by 2 seconds and what they found was that when they did this the",
    "start": "181959",
    "end": "187200"
  },
  {
    "text": "revenue per user dropped by 4% 4.3% which is massive right if you think about it uh that's if nothing else uh",
    "start": "187200",
    "end": "196040"
  },
  {
    "text": "there's not many features they can add to your pages or to your applications that will increase your Revenue by 4.3%",
    "start": "196040",
    "end": "201080"
  },
  {
    "text": "so this is this is definitely significant and further this is not only for big sites this is not for Google",
    "start": "201080",
    "end": "206519"
  },
  {
    "start": "204000",
    "end": "204000"
  },
  {
    "text": "search and Bing and others this is true universally so um torbit a great uh",
    "start": "206519",
    "end": "212120"
  },
  {
    "text": "company that does ROM analytics real user measurement uh they collated this data across couple of billion data",
    "start": "212120",
    "end": "218120"
  },
  {
    "text": "points from their customers and what they were interested in was as the page low time increases how does the behavior",
    "start": "218120",
    "end": "224080"
  },
  {
    "text": "of the users change and you can see here that there's a pretty good correlation which is to say for every second that",
    "start": "224080",
    "end": "229920"
  },
  {
    "text": "the page takes longer there's an increase in the bounce rate of your visitors so basically we have hard proof",
    "start": "229920",
    "end": "235400"
  },
  {
    "text": "that shows that performance matters for the bottom line so it's not just a feel good thing right like I would I I love",
    "start": "235400",
    "end": "241599"
  },
  {
    "text": "optimizing things that's you know I wake up getting excited um about that but uh",
    "start": "241599",
    "end": "247239"
  },
  {
    "text": "there's also a very good business case for this sort of thing and actually uh let me just go back for one second I",
    "start": "247239",
    "end": "253079"
  },
  {
    "text": "I'll mention one more thing about Google uh what we discovered was we ran this experiment for I think three or four",
    "start": "253079",
    "end": "258880"
  },
  {
    "text": "weeks and then we turned it off right because we don't want to slow down your experience unnecessarily um and an",
    "start": "258880",
    "end": "265000"
  },
  {
    "text": "interesting thing happened people that were in these slower buckets didn't immediately",
    "start": "265000",
    "end": "270240"
  },
  {
    "text": "go back to their previous Behavior they basically learned the slow behavior of the site and it took them approximately",
    "start": "270240",
    "end": "276639"
  },
  {
    "text": "uh two or three months to go back to the old Behavior so to start searching more frequently or more often so we learn",
    "start": "276639",
    "end": "283120"
  },
  {
    "text": "these behaviors and we basically train our users to expect uh you know slow experiences so that in itself is an",
    "start": "283120",
    "end": "288680"
  },
  {
    "text": "interesting Insight so with that right I hopefully",
    "start": "288680",
    "end": "294039"
  },
  {
    "text": "that at least uh motivates the use case for performance how are we doing today",
    "start": "294039",
    "end": "300320"
  },
  {
    "text": "we ran some studies at Google um and I'll show you some numbers for the",
    "start": "300320",
    "end": "305919"
  },
  {
    "start": "301000",
    "end": "301000"
  },
  {
    "text": "specific kind of uh geographic regions and uh medians and means but first uh",
    "start": "305919",
    "end": "311360"
  },
  {
    "text": "there's some pretty good constants that are out there there's been a number of studies that have basically repeated um",
    "start": "311360",
    "end": "316919"
  },
  {
    "text": "the same results or got the same results I should say where regardless of what Medium you're talking about whether it's",
    "start": "316919",
    "end": "322639"
  },
  {
    "text": "a desktop app or a web app or something else uh anything that's below 100 milliseconds in terms of reaction time",
    "start": "322639",
    "end": "328199"
  },
  {
    "text": "like you click a button and you expect something to happen if it's within 100 milliseconds it feels instant right now",
    "start": "328199",
    "end": "333960"
  },
  {
    "text": "I I know that there's some like hardcore gamers in this crowd and you're like dude I can tell you the difference",
    "start": "333960",
    "end": "339800"
  },
  {
    "text": "between 35 milliseconds and 45 milliseconds all right um and that's true but for web browsing that's not",
    "start": "339800",
    "end": "346280"
  },
  {
    "text": "that's not really an issue below 100 milliseconds it feels instant uh somewhere between 100 to 300",
    "start": "346280",
    "end": "351560"
  },
  {
    "text": "milliseconds that's kind of like a sticky button it's it's not quite slow but it feels kind of weird like something just happened uh somewhere",
    "start": "351560",
    "end": "357560"
  },
  {
    "text": "between up to one second uh you're still engaged you're fully engaged in the task that you're doing uh but it feels",
    "start": "357560",
    "end": "364120"
  },
  {
    "text": "sluggish and after one second basically the user switches context it it's the difference between you click a button",
    "start": "364120",
    "end": "369639"
  },
  {
    "text": "and you get immediate feedback to you click a button and you're and you're waiting and then you're like oh yeah I got to send an email to Bob and I should",
    "start": "369639",
    "end": "375720"
  },
  {
    "text": "talk to uh Susie and what was I doing again um and and that's it",
    "start": "375720",
    "end": "381120"
  },
  {
    "text": "right so the one second barrier is a very important threshold uh you should",
    "start": "381120",
    "end": "387000"
  },
  {
    "text": "stay below that because that that at very least keeps the user focused on your application and and helping them",
    "start": "387000",
    "end": "392479"
  },
  {
    "text": "get the job done so that's why we picked one second specifically uh for this task",
    "start": "392479",
    "end": "398120"
  },
  {
    "text": "now here's some aggregate numbers uh we ran this study with Google analytics which is installed on a significant",
    "start": "398120",
    "end": "403639"
  },
  {
    "text": "fraction of the web and we collected performance data and uh this is data as of I think April of last year so maybe a",
    "start": "403639",
    "end": "411440"
  },
  {
    "text": "year old data and what we found was that first of all mobile not surprisingly is slower for a variety of reasons and",
    "start": "411440",
    "end": "417759"
  },
  {
    "text": "we'll talk about some of some of these second but notice that the median U time",
    "start": "417759",
    "end": "423520"
  },
  {
    "text": "on mobile is about 5 Seconds right so this is this is a far cry from the 1",
    "start": "423520",
    "end": "429280"
  },
  {
    "text": "second goal that that we want to have like 5 seconds is is a long time and you know the mean is even worse and you can",
    "start": "429280",
    "end": "435240"
  },
  {
    "text": "actually look at the distribution at the bottom and by the way I'll I'll share the slides later so I guys I encourage",
    "start": "435240",
    "end": "440280"
  },
  {
    "text": "you guys to follow the Links at the bottom of these slides I have a lot of references that you can uh go through later so it's not looking good uh to be",
    "start": "440280",
    "end": "448720"
  },
  {
    "text": "honest right 5 Seconds uh we are getting better though and I put the star here for mobile and I when talking about 4.8",
    "start": "448720",
    "end": "455639"
  },
  {
    "text": "seconds because this is actually optimistic and the reason I say this this is optimistic is because we gather",
    "start": "455639",
    "end": "460960"
  },
  {
    "text": "data using navigation timing which is a new w3c standard which means that it's only implemented in the latest browsers",
    "start": "460960",
    "end": "467360"
  },
  {
    "text": "and if you have the latest browser chances are you have the newest phone if you have the newest phone you're probably in the latest Network so basically there's a population bias",
    "start": "467360",
    "end": "473840"
  },
  {
    "text": "there right it's like it's this room because all of you guys have the the latest gadgets uh that's not true",
    "start": "473840",
    "end": "480520"
  },
  {
    "text": "universally in fact it's a lot slower so I would guess that if you double this number we probably wouldn't be too far",
    "start": "480520",
    "end": "488759"
  },
  {
    "text": "off so that's a state of Art and the next question is well why does it take 5",
    "start": "488759",
    "end": "493960"
  },
  {
    "text": "Seconds to load a median page like that's kind of crazy right so great another great project is HTP archive",
    "start": "493960",
    "end": "500360"
  },
  {
    "text": "htpr archive.org uh which crawls the web and or it crawls uh the most popular",
    "start": "500360",
    "end": "506039"
  },
  {
    "text": "destinations on the web I should say and instead of actually Gathering the content it looks at how are these Pages",
    "start": "506039",
    "end": "511280"
  },
  {
    "text": "constructed like how many CSS files do you have how many images what was the size of those images and it provides us",
    "start": "511280",
    "end": "516560"
  },
  {
    "text": "some historical data uh for measuring how the web is built so what we can see here is this is actually for mobile size",
    "start": "516560",
    "end": "522320"
  },
  {
    "text": "specifically an average page Mobile page today is approximately 700 kilobytes and",
    "start": "522320",
    "end": "527600"
  },
  {
    "text": "it consists of 60 requests so this is CSS files JavaScript Etc right and if you look at the actual makeup of the",
    "start": "527600",
    "end": "534120"
  },
  {
    "text": "page approximately 500 kiloby out of that 700 kiloby is in images so that",
    "start": "534120",
    "end": "539560"
  },
  {
    "text": "itself is a very uh important realization if you're not optimizing",
    "start": "539560",
    "end": "544640"
  },
  {
    "text": "your images today that is perhaps the number one thing that you can do uh if nothing else just go back home today and",
    "start": "544640",
    "end": "550760"
  },
  {
    "text": "check that you're optimizing images correctly uh whatever that means and uh I say whatever that means because you",
    "start": "550760",
    "end": "557360"
  },
  {
    "text": "know often times we optimize uh for example a PNG file and remove some metadata and we're like okay",
    "start": "557360",
    "end": "563320"
  },
  {
    "text": "we're done the problem was the problem though is that this file should have been saved as a JPEG file instead and 's",
    "start": "563320",
    "end": "569480"
  },
  {
    "text": "a difference of hundreds of kilobytes in there right so make sure you're picking the Right image format to begin with I",
    "start": "569480",
    "end": "575000"
  },
  {
    "text": "can't tell you the number of 3 megab PNG files I found on the web which you know when saved as a JPEG are like 250",
    "start": "575000",
    "end": "582640"
  },
  {
    "text": "kilobytes so um images are important and of course the second biggest one is Javascript and then only after that do",
    "start": "582640",
    "end": "589079"
  },
  {
    "text": "we have HTML and the funny thing is you know you look at this like an average page consist of six HTML Pages what um",
    "start": "589079",
    "end": "597839"
  },
  {
    "text": "if frames right so you're incl including content you're including ads you're including other things you're pulling in all the stuff so we're actually an",
    "start": "597839",
    "end": "604160"
  },
  {
    "text": "average page today is cons consists of 60 different resources which is very very big and another interest interesting",
    "start": "604160",
    "end": "611680"
  },
  {
    "text": "stat that kind of floored me the first time I read it uh was that for a lot of users mobile is actually the primary and",
    "start": "611680",
    "end": "618720"
  },
  {
    "text": "the only way to access the web in fact you know if you look at the bottom here for United States a quarter of mobile",
    "start": "618720",
    "end": "625839"
  },
  {
    "text": "users for a quarter of mobile users uh it is their only way to access the web",
    "start": "625839",
    "end": "631200"
  },
  {
    "text": "right so uh I say that floored me because I tend to think of the mobile phone as kind of like a secondary thing",
    "start": "631200",
    "end": "636320"
  },
  {
    "text": "right like I want to go I need to check something quickly but I can always go back to my laptop and do the the real",
    "start": "636320",
    "end": "641600"
  },
  {
    "text": "work if you will uh well that's that's not true for a significant fraction of users right and it makes you think in a",
    "start": "641600",
    "end": "648120"
  },
  {
    "text": "different way when you construct your mobile application as well like you shouldn't be hiding content with the assumption that somebody will go back to",
    "start": "648120",
    "end": "654200"
  },
  {
    "text": "a desktop computer and then have the full experience right you need to provide The Full Experience on mobile",
    "start": "654200",
    "end": "660320"
  },
  {
    "text": "so all of this is good and of course you know there's ads everywhere uh you can't",
    "start": "660320",
    "end": "667600"
  },
  {
    "text": "you can not see a billboard that says like 4G fastest thing ever uh it'll save",
    "start": "667600",
    "end": "672839"
  },
  {
    "text": "the world you should upgrade today um and this is really not a problem right like pages are getting bigger so what",
    "start": "672839",
    "end": "678480"
  },
  {
    "text": "I'll just upgrade to 4G everything's cool well not so fast so this is a",
    "start": "678480",
    "end": "684959"
  },
  {
    "text": "report uh that FCC has done for a couple of years and this is not for mobile it's just say this is specifically for United",
    "start": "684959",
    "end": "690800"
  },
  {
    "text": "States and what they wanted to measure was what is the latency of different connection types within the United",
    "start": "690800",
    "end": "697000"
  },
  {
    "text": "States so specifically uh they gathered the panel of people and they they gave you a device that you would deploy in",
    "start": "697000",
    "end": "703440"
  },
  {
    "text": "your home and they would deploy a device at the ISP so the intent was to measure kind of that last mile latency this is",
    "start": "703440",
    "end": "710000"
  },
  {
    "text": "not from your computer to the destination or some server this is just to your ISP and they wanted to measure",
    "start": "710000",
    "end": "715720"
  },
  {
    "text": "the latency so the the end results were basically if you have fiber today that's about 18 milliseconds if you have DSL",
    "start": "715720",
    "end": "722639"
  },
  {
    "text": "that's 43 milliseconds and cable somewhere in between now why why am I mentioning this well if you think about",
    "start": "722639",
    "end": "728560"
  },
  {
    "text": "it 43 milliseconds uh that's just between you your house and whoever's",
    "start": "728560",
    "end": "734440"
  },
  {
    "text": "your your ISP is right and then you have to go to the actual server and fetch all this content 43 milliseconds in terms of",
    "start": "734440",
    "end": "741320"
  },
  {
    "text": "like light uh light time is like going from San Francisco to New York right",
    "start": "741320",
    "end": "746680"
  },
  {
    "text": "except here you're probably going tens of miles so this latency is actually a real",
    "start": "746680",
    "end": "751760"
  },
  {
    "text": "bottleneck on the web today for web browsing but all of that kind of pales in comparison when you look at mobile",
    "start": "751760",
    "end": "758560"
  },
  {
    "text": "cuz you know the first time I saw the the numbers for for wi I was like wow",
    "start": "758560",
    "end": "763760"
  },
  {
    "text": "this is a lot a lot higher than I thought then I started digging through the mobile carrier technical FAQs and I",
    "start": "763760",
    "end": "770959"
  },
  {
    "text": "walked away in horror um basically what they're saying is and this is an exact snippet from uh one of the networks",
    "start": "770959",
    "end": "777560"
  },
  {
    "text": "right so for for Sprint for G uh you should expect 3 to 6 megabits of",
    "start": "777560",
    "end": "783040"
  },
  {
    "text": "download speed which is good that's you know that's great uh but the average latency is 150 milliseconds so that's",
    "start": "783040",
    "end": "789440"
  },
  {
    "text": "like going to from here to London and back right uh and that's just to your",
    "start": "789440",
    "end": "795279"
  },
  {
    "text": "mobile carrier and remember uh we want to render everything within 200 milliseconds right and this and what",
    "start": "795279",
    "end": "801959"
  },
  {
    "text": "we're saying here is like expect on average just to like send a packet 150 milliseconds just to the carrier so you",
    "start": "801959",
    "end": "808079"
  },
  {
    "text": "got 50 milliseconds left to render everything and you know do do all the rest not a good deal and that's on 4G on",
    "start": "808079",
    "end": "815279"
  },
  {
    "text": "3G uh you should expect uh three 400 milliseconds of latency so this is like",
    "start": "815279",
    "end": "821199"
  },
  {
    "text": "half a second just to send a packet out right so we have our one second budget",
    "start": "821199",
    "end": "826320"
  },
  {
    "text": "we can send the packet get it back and we're we're already half we spent already already spent half the budget so",
    "start": "826320",
    "end": "832920"
  },
  {
    "text": "you know here are some numbers comparing uh a couple of different carriers in the United States basically they're",
    "start": "832920",
    "end": "838199"
  },
  {
    "text": "identical right different carriers use slightly different uh goalposts just to",
    "start": "838199",
    "end": "843920"
  },
  {
    "text": "be safe but you can assume that on a 3G network you're going to be somewhere in the 250 millisecond range that's kind of",
    "start": "843920",
    "end": "850399"
  },
  {
    "text": "your packet time on 4G the numbers get better you know 100 milliseconds or less on some of the new networks but",
    "start": "850399",
    "end": "856000"
  },
  {
    "text": "nonetheless this this means that latency is a very big problem on on the mobile",
    "start": "856000",
    "end": "861839"
  },
  {
    "text": "web the other big problem that I don't think many people are aware of today um at least in the Web building the mobile",
    "start": "861839",
    "end": "869440"
  },
  {
    "start": "863000",
    "end": "863000"
  },
  {
    "text": "web uh apps space is battery life uh this is certainly a big uh big problem and something that a lot of people",
    "start": "869440",
    "end": "875440"
  },
  {
    "text": "optimize for when they're building native apps but on on a mobile web we don't tend to think about it the problem",
    "start": "875440",
    "end": "881120"
  },
  {
    "text": "with uh battery life on mobile is that your radio is the second most expensive",
    "start": "881120",
    "end": "886480"
  },
  {
    "text": "device or unit if you will on on the phone so the first is of course the",
    "start": "886480",
    "end": "892279"
  },
  {
    "text": "screen right but the screen is off most of the time like you're it's in your pocket the screen is off the radius",
    "start": "892279",
    "end": "899720"
  },
  {
    "text": "needs to give you this U premise of being always on right like",
    "start": "899720",
    "end": "907079"
  },
  {
    "text": "you always want to be reachable so we and but we can't do that we need to turn off the radio as aggressively as we can",
    "start": "907079",
    "end": "912440"
  },
  {
    "text": "but because it is very very expensive uh to keep it active so what this entails",
    "start": "912440",
    "end": "918320"
  },
  {
    "text": "is uh this kind of dichotomy of control and user plane latencies so this is",
    "start": "918320",
    "end": "923880"
  },
  {
    "text": "definitely getting into the weeds of how the mobile networks uh work if you're curious about this I have a very good",
    "start": "923880",
    "end": "929079"
  },
  {
    "text": "resource for you at the very end 60 pages of it but very quickly I'll I'll describe um what uh control and user PL",
    "start": "929079",
    "end": "938079"
  },
  {
    "text": "user plane latencies mean in a nutshell when you have your mobile phone if you want to send something you don't just",
    "start": "938079",
    "end": "945040"
  },
  {
    "text": "send it you say hey carrier I would like to send some data and the carrier",
    "start": "945040",
    "end": "950759"
  },
  {
    "text": "listens to that and says Okay um use this transmit power on this channel at this time and you have this amount of",
    "start": "950759",
    "end": "956880"
  },
  {
    "text": "time to send your data you negotiate this kind of back and forth a little bit um then you have your resource assignment and then you actually send",
    "start": "956880",
    "end": "963440"
  },
  {
    "text": "data right this is what's known as control play latency so you can't just wake up and say hey I got like a request",
    "start": "963440",
    "end": "969240"
  },
  {
    "text": "to send first you got to talk to the tower the tower needs to permit you to do that and this negotiation takes time",
    "start": "969240",
    "end": "975480"
  },
  {
    "text": "so that's what we mean by this by this control play latency then once you have the actual assignment you need to send",
    "start": "975480",
    "end": "981040"
  },
  {
    "text": "data to the tower itself and that also takes time and the reason I mentioned this is you know this is completely",
    "start": "981040",
    "end": "987160"
  },
  {
    "text": "transparent to us especially as web Developers we never get to interact at this level but it opposes some very",
    "start": "987160",
    "end": "992279"
  },
  {
    "text": "serious uh latencies and I'm guessing I'm guessing I'm kind of blocking these numbers here so in in 4G uh this first",
    "start": "992279",
    "end": "1001639"
  },
  {
    "start": "1000000",
    "end": "1000000"
  },
  {
    "text": "part right here can take up to 100 milliseconds so this is just from the moment that the user for example clicks",
    "start": "1001639",
    "end": "1008399"
  },
  {
    "text": "on a button or a link it may take 100 milliseconds just to negotiate that you want to send something then you actually",
    "start": "1008399",
    "end": "1013839"
  },
  {
    "text": "need to send the packet and then once you have this assignment it'll take uh approximately 50 milliseconds for each",
    "start": "1013839",
    "end": "1020199"
  },
  {
    "text": "new packet to go from from your device just to the radio tower then from the radio tower it needs to Traverse the",
    "start": "1020199",
    "end": "1026199"
  },
  {
    "text": "mobile carry Network which is that 200 milliseconds that they're that they're assigning to that number and then you",
    "start": "1026199",
    "end": "1032120"
  },
  {
    "text": "need to go to your server so you know this is pretty complicated and in 3GS uh",
    "start": "1032120",
    "end": "1037839"
  },
  {
    "text": "this gets actually even worse um this first step of negotiating a connection",
    "start": "1037839",
    "end": "1043079"
  },
  {
    "text": "can take up to 2 and a half seconds so this I the reason I put this",
    "start": "1043079",
    "end": "1050080"
  },
  {
    "text": "entire slide here is probably just because of this a lot of times I hear uh people saying or developers saying that",
    "start": "1050080",
    "end": "1057400"
  },
  {
    "text": "Mo designing for the mobile web is very hard uh the latencies are so variable I can't predict anything and it is true",
    "start": "1057400",
    "end": "1064000"
  },
  {
    "text": "that the the variability is very high but it's usually explained by this which is if your radio has been idle or it's",
    "start": "1064000",
    "end": "1071160"
  },
  {
    "text": "been off for a while the first time you need to send a packet of data there's this startup cost if you will that only",
    "start": "1071160",
    "end": "1076600"
  },
  {
    "text": "occurs when the connection needs to be established l so why why does this matter well it matters because when I",
    "start": "1076600",
    "end": "1082760"
  },
  {
    "text": "click on a button on my 3g connection right and I want to like navigate to something it'll take up to two and a",
    "start": "1082760",
    "end": "1088360"
  },
  {
    "text": "half seconds just to send the first packet and that is significant time if you think about it from like a ux point",
    "start": "1088360",
    "end": "1095159"
  },
  {
    "text": "of view right like two and a half seconds you should be taking that into account when when you're designing your",
    "start": "1095159",
    "end": "1100240"
  },
  {
    "text": "mobile application so the UI needs to",
    "start": "1100240",
    "end": "1105120"
  },
  {
    "text": "adjust and then after all of that uh the device is also has a very active power",
    "start": "1105600",
    "end": "1111000"
  },
  {
    "start": "1106000",
    "end": "1106000"
  },
  {
    "text": "management system which is actually managed by by the tower so for example uh this is the LTE this is the 4G case",
    "start": "1111000",
    "end": "1118280"
  },
  {
    "text": "in 4G and we already described the case of going from idle to active right so my phone is Idle I decided to send some",
    "start": "1118280",
    "end": "1124600"
  },
  {
    "text": "data I need to go to the active mode which will take 260 milliseconds then I",
    "start": "1124600",
    "end": "1130200"
  },
  {
    "text": "you know I send all of my requests um and then my phone is once again idling maybe I'm reading the page as I'm idling",
    "start": "1130200",
    "end": "1137720"
  },
  {
    "text": "after 100 milliseconds the Tower actually tells you hey you go into low power State uh because you need to",
    "start": "1137720",
    "end": "1143880"
  },
  {
    "text": "preserve power so you go into the state and uh let's say at this moment you",
    "start": "1143880",
    "end": "1149080"
  },
  {
    "text": "actually click on a different link you need to re kind of redo the negotiation and go back to active State the good",
    "start": "1149080",
    "end": "1155200"
  },
  {
    "text": "news is this may take a little bit less time so 50 milliseconds okay but let's say that you you're actually",
    "start": "1155200",
    "end": "1162200"
  },
  {
    "text": "idle right so you you wait 100 milliseconds you're idle you wait another 100 milliseconds you go into a",
    "start": "1162200",
    "end": "1167320"
  },
  {
    "text": "deeper sleep if you will where you you're only listening periodically and then after about 10 seconds you actually go back to idle mode so if you're",
    "start": "1167320",
    "end": "1175080"
  },
  {
    "text": "building a mobile uh website you you fetch a page or your user Vis visits",
    "start": "1175080",
    "end": "1180320"
  },
  {
    "text": "your page and they you fetch all the content they're reading the page they take more than 10 seconds the radio is already idle so you have to you'll have",
    "start": "1180320",
    "end": "1187520"
  },
  {
    "text": "to incur that upgrade cost again which may be uh 100 milliseconds to 2 and a",
    "start": "1187520",
    "end": "1193919"
  },
  {
    "text": "half seconds right this is something that you should keep in mind and once once you're aware of this you can actually design around it you can",
    "start": "1193919",
    "end": "1199640"
  },
  {
    "text": "actually structure your application in a way that you know that this is going to happen um very very similar thing in 3G",
    "start": "1199640",
    "end": "1207640"
  },
  {
    "text": "I'm not going to go through this in detail uh but basically they have you know a couple of different states and once again you know for those who are",
    "start": "1207640",
    "end": "1213840"
  },
  {
    "text": "curious about this I have a good resource for you I just wanted to show this here because uh this this first",
    "start": "1213840",
    "end": "1219840"
  },
  {
    "text": "upgrade takes up to two seconds yeah right so like where is this",
    "start": "1219840",
    "end": "1227720"
  },
  {
    "text": "guy going with all this this this is just this is weird um so having said",
    "start": "1227720",
    "end": "1234880"
  },
  {
    "text": "that right there's a couple of things that I want you to take away from everything we covered so far uh latency is highly variable on mobile networks uh",
    "start": "1234880",
    "end": "1241840"
  },
  {
    "text": "you can account for some of it 4G networks will definitely help but 4G networks are uh it'll take a while to",
    "start": "1241840",
    "end": "1249559"
  },
  {
    "text": "deploy them actually uh we all probably everybody in this room already is on a 4G connection the reality is um is that",
    "start": "1249559",
    "end": "1257520"
  },
  {
    "text": "4G or actually 3G will be with us for another decade at least another decade",
    "start": "1257520",
    "end": "1262679"
  },
  {
    "text": "when you talk to the carriers they will all tell you that the existing 3G networks will be here they'll be in supporting role and in fact you'll be",
    "start": "1262679",
    "end": "1269320"
  },
  {
    "text": "migrating from 4G to 3G all the time for the next decade uh it takes a lot of resources to deploy these new networks",
    "start": "1269320",
    "end": "1276200"
  },
  {
    "text": "carriers have already invested a lot of money uh into existing 3G networks so uh",
    "start": "1276200",
    "end": "1281279"
  },
  {
    "text": "you know this is 4G is not it won't solve all things and uh all of the usual",
    "start": "1281279",
    "end": "1288039"
  },
  {
    "text": "optimization that you apply on a desktop web things like reusing connections downloading resources and bulk I think",
    "start": "1288039",
    "end": "1293799"
  },
  {
    "text": "this is actually something that is underappreciated um mobile networks are optimized for bulk transfers not for",
    "start": "1293799",
    "end": "1300279"
  },
  {
    "text": "small transfers where you where you're very cautious and you say well let let me fetch this one thing and then",
    "start": "1300279",
    "end": "1305360"
  },
  {
    "text": "determine that if I should fetch another thing it's like no they want you to fetch as much as you can and then turn off the radio because they want to",
    "start": "1305360",
    "end": "1311919"
  },
  {
    "text": "preserve battery power and they're optimized for that so let's leave the kind of the",
    "start": "1311919",
    "end": "1318120"
  },
  {
    "text": "network back aside and actually look at the browser now um what does it take to render a page and I think a lot of the",
    "start": "1318120",
    "end": "1324320"
  },
  {
    "text": "stuff should be very familiar to you guys but I think it's still worth to review this we talked about the network",
    "start": "1324320",
    "end": "1330840"
  },
  {
    "start": "1328000",
    "end": "1328000"
  },
  {
    "text": "you know we fetch some bites uh the browser has this resource loader which basically says okay I need this HTML",
    "start": "1330840",
    "end": "1337159"
  },
  {
    "text": "page I need the CSS files and then it starts uh parsing the the HTML file",
    "start": "1337159",
    "end": "1342480"
  },
  {
    "text": "itself and roughly what happens here is you know we get some bites off the wire which are actually you know some some",
    "start": "1342480",
    "end": "1348760"
  },
  {
    "text": "set of characters we start converting these characters as soon as we get them so we don't wait to get the entire HTML",
    "start": "1348760",
    "end": "1354520"
  },
  {
    "text": "page if you send us the first five packets uh you know first 10 bytes of your HTML we will immediately start",
    "start": "1354520",
    "end": "1360880"
  },
  {
    "text": "parsing it and trying to figure out okay he's asking for a CSS file right here and here's an image tag so let's you",
    "start": "1360880",
    "end": "1366799"
  },
  {
    "text": "know start fetching that as quickly as we can so uh that's helpful because you know if depending on how your",
    "start": "1366799",
    "end": "1372840"
  },
  {
    "text": "application server is structured you should be flushing the important content all the time and a good example of this",
    "start": "1372840",
    "end": "1378120"
  },
  {
    "text": "uh that that I love to share is Google search so one trick that we do with Google search is uh you send us a search",
    "start": "1378120",
    "end": "1384720"
  },
  {
    "text": "query right let's let's say you have a blank page we send us a search query we get the first packet of that query we",
    "start": "1384720",
    "end": "1392200"
  },
  {
    "text": "don't even look at what the query is we're like great we got a query here's the header for the H for for the search",
    "start": "1392200",
    "end": "1398000"
  },
  {
    "text": "page right and then once you get the bytes for the header and the pages are ready being rendered in a browser and",
    "start": "1398000",
    "end": "1404000"
  },
  {
    "text": "then we start looking at your actual query like okay so you're asking about HTML 5 letters dispatch the queries and",
    "start": "1404000",
    "end": "1409120"
  },
  {
    "text": "kind of fill in the content uh as as it comes so that in itself actually speeds",
    "start": "1409120",
    "end": "1415320"
  },
  {
    "text": "up the loading experience in your browser but quite a bit so that's a technique that you can also leverage in your own application it require it",
    "start": "1415320",
    "end": "1421480"
  },
  {
    "text": "definitely requires some careful architecture of your application server but it can do wonders if you do it",
    "start": "1421480",
    "end": "1427279"
  },
  {
    "text": "well so in any case we we construct uh kind of the we start constructing the",
    "start": "1427279",
    "end": "1432799"
  },
  {
    "text": "Dom tree right something that we interact with all the time via JavaScript and all the rest",
    "start": "1432799",
    "end": "1439000"
  },
  {
    "text": "and uh one thing that's often forgotten is to get something visible on the screen you don't just need the Dom tree",
    "start": "1439000",
    "end": "1445480"
  },
  {
    "text": "or the HTML you also need the CSS and in fact those two are coupled we can't",
    "start": "1445480",
    "end": "1451080"
  },
  {
    "start": "1450000",
    "end": "1450000"
  },
  {
    "text": "paint something to the screen until we have all of the style information because otherwise if we were to paint it without the Styles you would get this",
    "start": "1451080",
    "end": "1457279"
  },
  {
    "text": "like ugly layout right and then we would you flash it with the updated layout uh",
    "start": "1457279",
    "end": "1463960"
  },
  {
    "text": "that's not a good experience so basically we're stuck like we need we need the HTML and we need the CSS and we need them as quickly as possible and in",
    "start": "1463960",
    "end": "1470760"
  },
  {
    "text": "theory these two things can be constructed in parallel right and then we get we get the render tree and we kind of print it to the screen or",
    "start": "1470760",
    "end": "1477159"
  },
  {
    "text": "painted to the screen I should say so far so good this is this is the great case uh the problem is we have this",
    "start": "1477159",
    "end": "1484799"
  },
  {
    "text": "thing called JavaScript it's nothing but pain so here's an example right I have a",
    "start": "1484799",
    "end": "1491440"
  },
  {
    "text": "very simple HTML 5 page uh it's a validation ml 5 page I should say as well which is I think is awesome um and",
    "start": "1491440",
    "end": "1498440"
  },
  {
    "text": "and approximately at the on the bottom here I have how the parser actually sees",
    "start": "1498440",
    "end": "1503679"
  },
  {
    "text": "it right so we see the HTML tag or actually we don't even see the HML tag but we kind of inject it in there we",
    "start": "1503679",
    "end": "1508960"
  },
  {
    "text": "don't see the head tag but the parser injects it in there this is all for the first time ever in HML 5 we've actually",
    "start": "1508960",
    "end": "1515440"
  },
  {
    "text": "like we have hard specification for how these bites should be interpreted into this tree which is great so we see this",
    "start": "1515440",
    "end": "1522120"
  },
  {
    "text": "text also HTML 5 page and then we get to the script tag and we're like wait a second uh we need to stop the world uh",
    "start": "1522120",
    "end": "1528840"
  },
  {
    "text": "we can't proceed we can't in fact look at this link tag here uh because the script tag could overwrite what comes",
    "start": "1528840",
    "end": "1535720"
  },
  {
    "text": "next right and what happens here is this when you have a script U one of the",
    "start": "1535720",
    "end": "1542760"
  },
  {
    "start": "1540000",
    "end": "1540000"
  },
  {
    "text": "great features or bugs depending on how you look at it in in our implementation of of of JavaScript and and the Dom is",
    "start": "1542760",
    "end": "1549120"
  },
  {
    "text": "that JavaScript can write directly into the into the HTML itself so you could do",
    "start": "1549120",
    "end": "1554159"
  },
  {
    "text": "something as crazy as like have a script that writes another script in line right and we don't know we have no idea what's",
    "start": "1554159",
    "end": "1559640"
  },
  {
    "text": "what's coming next so we say okay we have to stop the world fetch this JavaScript execute it do whatever it",
    "start": "1559640",
    "end": "1566600"
  },
  {
    "text": "tells us and then and only then can we proceed moving forward right and in the meantime you should be thinking wait so",
    "start": "1566600",
    "end": "1572520"
  },
  {
    "text": "to render something I need the CSS as well but the CSS is coming after this so guess what we're not painting anything",
    "start": "1572520",
    "end": "1578559"
  },
  {
    "text": "to the screen while you're waiting for this right so we just created this really nasty dependency chain which is",
    "start": "1578559",
    "end": "1584200"
  },
  {
    "text": "not good so one of the ways you work around this and I'm sure you guys have seen uh this pattern everywhere is",
    "start": "1584200",
    "end": "1589440"
  },
  {
    "start": "1586000",
    "end": "1586000"
  },
  {
    "text": "asynchronous scripts right no performance talk is complete without a",
    "start": "1589440",
    "end": "1594600"
  },
  {
    "text": "mention of use asynchronous script or use the synon scripts this is a pattern that's been popularized by Google",
    "start": "1594600",
    "end": "1600399"
  },
  {
    "text": "analytics it's available everywhere but basically if you have tags like this in your code go fix it right go use",
    "start": "1600399",
    "end": "1606600"
  },
  {
    "text": "something like this because this will actually block rendering U maybe this is not applicable for every single script",
    "start": "1606600",
    "end": "1612440"
  },
  {
    "text": "but it is certainly the pattern that you should be using wherever and whenever possible",
    "start": "1612440",
    "end": "1619240"
  },
  {
    "text": "so basically what it actually ends up looking like is you have the do Tre you have the style rules and you have",
    "start": "1619240",
    "end": "1624320"
  },
  {
    "start": "1620000",
    "end": "1620000"
  },
  {
    "text": "JavaScript in between and the nasty kind of relationship there is that JavaScript can modify the Dom but it can also query",
    "start": "1624320",
    "end": "1630120"
  },
  {
    "text": "the CSS right because from JavaScript you can say what by the way what is the style of this element right so there's",
    "start": "1630120",
    "end": "1636919"
  },
  {
    "text": "this dependency in there and what it means is uh rendering is blocked on CSS",
    "start": "1636919",
    "end": "1643039"
  },
  {
    "start": "1642000",
    "end": "1642000"
  },
  {
    "text": "we already said that uh but JavaScript can uh query uh CSS as well so we have",
    "start": "1643039",
    "end": "1650320"
  },
  {
    "text": "this dependency chain right so JavaScript can block the",
    "start": "1650320",
    "end": "1657840"
  },
  {
    "start": "1656000",
    "end": "1656000"
  },
  {
    "text": "do construction JavaScript can block on CSS rendering is blocked on CSS um therefore you know if you want to make",
    "start": "1657840",
    "end": "1664440"
  },
  {
    "text": "fast sites not just mobile sites any sites you need to get the CSS down to the client as quickly as possible it",
    "start": "1664440",
    "end": "1670960"
  },
  {
    "text": "means removing everything out of the path out of the rendering path and making sure that you get that CSS down",
    "start": "1670960",
    "end": "1676440"
  },
  {
    "text": "as as quickly as you can including inlining uh inlining CSS Styles right in the header of your of your page this is",
    "start": "1676440",
    "end": "1683519"
  },
  {
    "text": "something we use on Google Search and in many other products right U and I'm not saying that you should be inlining all",
    "start": "1683519",
    "end": "1688960"
  },
  {
    "text": "of your CSS uh there's an important distinction there uh you should be inlining the critical let's say above",
    "start": "1688960",
    "end": "1695200"
  },
  {
    "text": "the fold CSS such you can get something visible on the screen and then you can fill in the content later and we'll come",
    "start": "1695200",
    "end": "1700600"
  },
  {
    "text": "back to this in a second and you know scripts uh scripts cause a lot of problems in terms of",
    "start": "1700600",
    "end": "1706799"
  },
  {
    "text": "rendering all right so we talked about the browser we talked",
    "start": "1706799",
    "end": "1713200"
  },
  {
    "text": "about the network in gory details and let's try and actually uh pull it all",
    "start": "1713200",
    "end": "1718320"
  },
  {
    "text": "together so this scary Beast right here is comes from the w3c navigation timing",
    "start": "1718320",
    "end": "1724000"
  },
  {
    "start": "1719000",
    "end": "1719000"
  },
  {
    "text": "uh specification and if you guys are not familiar with it uh what this each one of these labels here is actually a timer",
    "start": "1724000",
    "end": "1731159"
  },
  {
    "text": "that is tracked by your browser that you can access whenever the page is has loaded and roughly speaking you know",
    "start": "1731159",
    "end": "1738120"
  },
  {
    "text": "there's a lot of tags in here or a lot of labels it captures three things user connectivity things like how long did",
    "start": "1738120",
    "end": "1743679"
  },
  {
    "text": "the TCP connection take how long did the DNS lookup take what was there server response time to uh browser execution",
    "start": "1743679",
    "end": "1750840"
  },
  {
    "text": "timestamps as well so you can say well how long did it take for me to execute uh all of my scripts in the onload",
    "start": "1750840",
    "end": "1756440"
  },
  {
    "text": "Handler you have all of this instrumentation uh in your browser today and the way you access it maybe a little",
    "start": "1756440",
    "end": "1762559"
  },
  {
    "text": "bit small if you if you just uh pop up your JavaScript console and you type in performance. timing it will give you a",
    "start": "1762559",
    "end": "1769519"
  },
  {
    "text": "JavaScript object back with all of these time stamps in uh microsc granularity",
    "start": "1769519",
    "end": "1775799"
  },
  {
    "text": "like you know we're serious about performance when we're measuring stuff in microseconds right so this is",
    "start": "1775799",
    "end": "1781519"
  },
  {
    "text": "available in all these browsers uh there's a lot of good analytics packages that will track this for you so if you",
    "start": "1781519",
    "end": "1786840"
  },
  {
    "text": "if you're not using uh real user measurements which is what this is all about right this is gathering data from",
    "start": "1786840",
    "end": "1792600"
  },
  {
    "text": "real browsers uh visiting your site uh which is very important there's a difference between synthetic testing and",
    "start": "1792600",
    "end": "1799559"
  },
  {
    "text": "real user measurement testing in synthetic testing you're saying look I I have let's say 10 servers around the",
    "start": "1799559",
    "end": "1805679"
  },
  {
    "text": "world one in Tokyo One in San Francisco one in New York and I'm going to get those servers to ping me and tell me",
    "start": "1805679",
    "end": "1811080"
  },
  {
    "text": "what my response time is which is useful that's that's a good Baseline but what you want to gather is Real Performance",
    "start": "1811080",
    "end": "1816279"
  },
  {
    "text": "data from your users for all you know a lot of your users are using really old 3G phones and that's good to know right",
    "start": "1816279",
    "end": "1821760"
  },
  {
    "text": "so you will capture that performance data and you can analyze it against your actual goals your benchmarks",
    "start": "1821760",
    "end": "1829559"
  },
  {
    "text": "so um that data will give you all of these timings of that I'm going to talk",
    "start": "1830320",
    "end": "1835679"
  },
  {
    "text": "about here but you know in short let's try and connect the pieces for one HTML",
    "start": "1835679",
    "end": "1841519"
  },
  {
    "text": "request right this is you typing in bloomberg.com you hit enter uh there's a bunch of things that need to happen uh",
    "start": "1841519",
    "end": "1848120"
  },
  {
    "text": "to fetch that page first we need to figure out what where does this bloomberg.com thing live we need to look",
    "start": "1848120",
    "end": "1853480"
  },
  {
    "text": "up the IP IP address right so that's going to take some time um then we need to do a TCP connection do the handshake",
    "start": "1853480",
    "end": "1860720"
  },
  {
    "text": "which is another round trip time um then we need to send the actual HP request and by the way by this point in time we",
    "start": "1860720",
    "end": "1866600"
  },
  {
    "text": "already you know could be 500 milliseconds have passed then we send HP request then you process your actual",
    "start": "1866600",
    "end": "1873519"
  },
  {
    "text": "page give us the HTML and then we deliver it to the client and the size of that page will determine how long you",
    "start": "1873519",
    "end": "1879440"
  },
  {
    "text": "know this bar is so some of these don't need to happen all the time of course right if you already know what the DNS",
    "start": "1879440",
    "end": "1885559"
  },
  {
    "text": "resolution is we don't need to do it if we can reuse use the same connection we will also reuse it the browser will do",
    "start": "1885559",
    "end": "1891080"
  },
  {
    "text": "all of this for you but on the first request chances are the user will have to go through each one of these steps so",
    "start": "1891080",
    "end": "1897360"
  },
  {
    "text": "let's do some math um in oh that's kind of hard to see so this line the control plane is what I",
    "start": "1897360",
    "end": "1904320"
  },
  {
    "text": "described earlier right your phone is idle and all of a sudden you're you're hitting enter to to load this page on",
    "start": "1904320",
    "end": "1910679"
  },
  {
    "text": "let's say on 3G uh this could take anywhere from 200 to 2 and a half seconds 200 milliseconds to 2 and a half",
    "start": "1910679",
    "end": "1916240"
  },
  {
    "text": "seconds I should say right next we need to perform the DNS lookup TCP connection time and the reason I'm saying it's it's",
    "start": "1916240",
    "end": "1922639"
  },
  {
    "text": "a minimum of 200 milliseconds because this is what the carriers are telling us this is how long it's going to take us within our own network to uh to render",
    "start": "1922639",
    "end": "1930440"
  },
  {
    "text": "this page so you kind of go through all of this uh and at the bottom you say okay so I started with a 1 second budget",
    "start": "1930440",
    "end": "1937639"
  },
  {
    "text": "right like we want to get a page visible on the screen within 1 second what does that leave us well in the worst case we",
    "start": "1937639",
    "end": "1943200"
  },
  {
    "text": "already burnt all of our budget because you know like this thing alone would have would have killed it but in the",
    "start": "1943200",
    "end": "1950000"
  },
  {
    "text": "better case you know maybe the phone has already been active we have about 400 milliseconds left uh to get something",
    "start": "1950000",
    "end": "1956600"
  },
  {
    "text": "visible on the screen with 4G things get a little bit more interesting uh and or much better I should say not just more",
    "start": "1956600",
    "end": "1962880"
  },
  {
    "text": "interesting because we can actually reliably more or less get a budget of",
    "start": "1962880",
    "end": "1967919"
  },
  {
    "text": "about 500 uh milliseconds right for for all all the other work and remember this",
    "start": "1967919",
    "end": "1973519"
  },
  {
    "text": "is for one HP request remember what we were saying at the beginning um an",
    "start": "1973519",
    "end": "1979039"
  },
  {
    "text": "average page is 60 requests so just repeat the 60 times right and you get to 5 Seconds um no uh our goal is to",
    "start": "1979039",
    "end": "1986919"
  },
  {
    "text": "actually get the page visible on the screen so what will it take right like",
    "start": "1986919",
    "end": "1992720"
  },
  {
    "text": "our pages are not single requests but maybe they should be or maybe there's an",
    "start": "1992720",
    "end": "1997799"
  },
  {
    "text": "in between right maybe there's certain things maybe there are certain techniques that we can use to inline the",
    "start": "1997799",
    "end": "2004720"
  },
  {
    "text": "correct stuff if you will and get the visible and then fill in the necessary content",
    "start": "2004720",
    "end": "2010760"
  },
  {
    "text": "afterwards so let's do some uh reverse math here let's say we have a 400 millisecond budget so I'm kind of",
    "start": "2010760",
    "end": "2016960"
  },
  {
    "text": "splitting the difference between 3G and 4G and I'm saying you know a lot of your users will be using both we won't be",
    "start": "2016960",
    "end": "2022679"
  },
  {
    "text": "switching to 4G overnight so 400 milliseconds right we still haven't talked about server response time so you",
    "start": "2022679",
    "end": "2029799"
  },
  {
    "text": "need to take that into account and I'm going to claim that this should be under 100 milliseconds if you really want to",
    "start": "2029799",
    "end": "2035440"
  },
  {
    "text": "uh meet this goal it should be under 100 milliseconds which is uh aggressive ad",
    "start": "2035440",
    "end": "2042919"
  },
  {
    "text": "admittedly next is we haven't actually accounted for the client rendering time like we've shipped all the bytes but the",
    "start": "2042919",
    "end": "2049720"
  },
  {
    "text": "browser still needs to do all the work to layout the page you know paint the pixels transfer them from GPU to your",
    "start": "2049720",
    "end": "2055079"
  },
  {
    "text": "screen all this work so Reserve about 100 milliseconds for that too right that's just kind of the cost of",
    "start": "2055079",
    "end": "2060280"
  },
  {
    "text": "rendering the page so really what we're left is about 200 milliseconds this is 200 milliseconds to perform all of the",
    "start": "2060280",
    "end": "2066118"
  },
  {
    "text": "JavaScript if you have any uh for that first page and maybe maybe if you're on",
    "start": "2066119",
    "end": "2071398"
  },
  {
    "text": "4G you can dispatch like a request uh in there right to fetch some additional contents to render the first page so not",
    "start": "2071399",
    "end": "2079358"
  },
  {
    "text": "much budget right basically we're saying one HTML request and then maybe one more",
    "start": "2079359",
    "end": "2084760"
  },
  {
    "text": "for for some other asset so this is just a quick summary",
    "start": "2084760",
    "end": "2089960"
  },
  {
    "text": "right the hard facts uh most of the most of our one-second budget is just Network",
    "start": "2089960",
    "end": "2095878"
  },
  {
    "text": "latency overhead so just take half of it off the table because that's that's what",
    "start": "2095879",
    "end": "2101400"
  },
  {
    "text": "it is uh you need to make your servers fast so 100 milliseconds or less you",
    "start": "2101400",
    "end": "2106640"
  },
  {
    "text": "need to allocate some time for the browser never forget this right um another uh good practice to have is to",
    "start": "2106640",
    "end": "2114200"
  },
  {
    "text": "always set a budget always set a performance budget whether that's a one second budget or if you're building for example you're trying to build smooth",
    "start": "2114200",
    "end": "2120359"
  },
  {
    "text": "animations in your application trying to deliver 60 frames per second right you do the math you say okay uh to do 60",
    "start": "2120359",
    "end": "2126440"
  },
  {
    "text": "frames per second I have 60 16 milliseconds to render each and every frame so as long as I fit all my work",
    "start": "2126440",
    "end": "2131680"
  },
  {
    "text": "within 16 milliseconds I'm good right not really because uh the browser also needs to do its work right you're not",
    "start": "2131680",
    "end": "2138079"
  },
  {
    "text": "the only one doing things in the browser so really you have at most 10 milliseconds if you want to meet that budget so never forget the overhead of",
    "start": "2138079",
    "end": "2145040"
  },
  {
    "text": "the browser itself and the implications of all of this is that really we can't afford to",
    "start": "2145040",
    "end": "2153079"
  },
  {
    "text": "make additional requests or not many requests we have to inl the most",
    "start": "2153079",
    "end": "2158560"
  },
  {
    "text": "important stuff if you will and that most important stuff is CSS for the reasons that I described earlier right",
    "start": "2158560",
    "end": "2164359"
  },
  {
    "text": "we need the CSS to paint something to the screen so you need to identify what is the critical CSS for this specific",
    "start": "2164359",
    "end": "2170359"
  },
  {
    "text": "page and the critical CSS is like the stuff that's above the fault it's the first thing that the user sees you can",
    "start": "2170359",
    "end": "2175560"
  },
  {
    "text": "fill in the rest later and to the extent possible eliminate and move JavaScript uh",
    "start": "2175560",
    "end": "2182280"
  },
  {
    "text": "Downstream right it is true that you know we're increasingly using JavaScript Frameworks to build the actual page",
    "start": "2182280",
    "end": "2189079"
  },
  {
    "text": "itself like it's the JavaScript that's laying out the divs and spans and all the rest um that's going to be hard to",
    "start": "2189079",
    "end": "2195119"
  },
  {
    "text": "achieve with something like this but a significant fraction the majority actually of the mobile web today is using JavaScript to enhance things",
    "start": "2195119",
    "end": "2202040"
  },
  {
    "text": "things like add on collect handlers and uh add social widgets and all this kind",
    "start": "2202040",
    "end": "2207280"
  },
  {
    "text": "of stuff all of which could be safely deferred until you uh until you paint something to the screen and then you do",
    "start": "2207280",
    "end": "2215520"
  },
  {
    "text": "that so you know a very simp simple in a toy example admittedly but",
    "start": "2215520",
    "end": "2220839"
  },
  {
    "text": "um just to illustrate the point right here's a very simple page we have our stylesheet at the top so first of all",
    "start": "2220839",
    "end": "2227560"
  },
  {
    "text": "the order is correct here right so in the previous example I showed you I had my script above the stylesheet which is",
    "start": "2227560",
    "end": "2233079"
  },
  {
    "text": "definitely not not what you want to do so we're fetching the CSS and we're fetching application.js so far so good",
    "start": "2233079",
    "end": "2239640"
  },
  {
    "text": "right this is pretty much as clean as it gets the implication of everything we've",
    "start": "2239640",
    "end": "2245319"
  },
  {
    "text": "talked about is that really if you want to render in under one second you need to inline the CSS you need to take that",
    "start": "2245319",
    "end": "2251280"
  },
  {
    "text": "file and you need to figure out what are the most important bits that's what we're doing at the top and then here uh",
    "start": "2251280",
    "end": "2257079"
  },
  {
    "text": "either eliminate this JavaScript or figure out how you can defer it and then at the bottom here you can see what I'm",
    "start": "2257079",
    "end": "2262520"
  },
  {
    "text": "doing is I'm saying after this onload happened after I've painted something then go out and fetch things go load",
    "start": "2262520",
    "end": "2269359"
  },
  {
    "text": "your analytics scripts go load your social widgets go load whatever you need y question um there's been",
    "start": "2269359",
    "end": "2276599"
  },
  {
    "text": "recommendations to put some of the stuff to grab it the first time and then put to local storage what is the time delay",
    "start": "2276599",
    "end": "2282760"
  },
  {
    "text": "to grab something from the mobile local storage you don't have all that in the",
    "start": "2282760",
    "end": "2288079"
  },
  {
    "text": "header um so the question is there's been some recommendations about using local storage so you can grab files you",
    "start": "2288079",
    "end": "2294400"
  },
  {
    "text": "know stick them into local storage and then what is the cost of doing that so the answer there is it actually varies",
    "start": "2294400",
    "end": "2299920"
  },
  {
    "text": "quite a bit by the browser and the platform so for example on on Windows uh",
    "start": "2299920",
    "end": "2305560"
  },
  {
    "text": "Windows has its own uh system level kind of prefetching",
    "start": "2305560",
    "end": "2310800"
  },
  {
    "text": "architecture which will prefetch uh necessary bites which makes access to local storage actually very fast uh",
    "start": "2310800",
    "end": "2318040"
  },
  {
    "text": "which is not true for example on Linux and OSX and different browsers use different uh prefetching techniques for",
    "start": "2318040",
    "end": "2323839"
  },
  {
    "text": "this thing so the short answer is the U the performance can actually vary quite a bit uh it can be up to 100",
    "start": "2323839",
    "end": "2330400"
  },
  {
    "text": "milliseconds just to open the local storage uh file but that that is certainly a technique that you could use",
    "start": "2330400",
    "end": "2336440"
  },
  {
    "text": "right uh the other thing I guess is I'm not saying that you shouldn't be using the browser cache here right what I'm",
    "start": "2336440",
    "end": "2342760"
  },
  {
    "text": "saying is you need to figure out what is a critical CSS and remember that uh you you may still have enough time to do",
    "start": "2342760",
    "end": "2348800"
  },
  {
    "text": "like one one uh request and I'm what I'm saying here is that request should",
    "start": "2348800",
    "end": "2354000"
  },
  {
    "text": "probably be the CSS and that should live in your cach and you probably shouldn't worry about putting in your local storage although that is certainly a",
    "start": "2354000",
    "end": "2360359"
  },
  {
    "text": "technique that you can explore um right okay so run you know",
    "start": "2360359",
    "end": "2366200"
  },
  {
    "text": "defer Styles sheet defer JavaScript defer all everything you can get something visible and then progressively",
    "start": "2366200",
    "end": "2371640"
  },
  {
    "text": "fill in this content and you know this is all good in theory how do you actually go about doing this and um",
    "start": "2371640",
    "end": "2377960"
  },
  {
    "text": "admittedly there's not a lot of great tools out there to help you U on with with this task but there are a few and I",
    "start": "2377960",
    "end": "2383359"
  },
  {
    "text": "think they're actually they go a long way so the first one and the one that I'm most familiar with is if you look in",
    "start": "2383359",
    "end": "2389720"
  },
  {
    "text": "your Chrome def tools if you go into the audits panel one of the audits is the",
    "start": "2389720",
    "end": "2395200"
  },
  {
    "text": "web page performance this is a very kind of little known tip if you run the",
    "start": "2395200",
    "end": "2402200"
  },
  {
    "text": "web performance uh test it'll actually tell you that hey on this specific page",
    "start": "2402200",
    "end": "2407599"
  },
  {
    "start": "2406000",
    "end": "2406000"
  },
  {
    "text": "here are all the CSS files that you've loaded but I looked at all the styles that you're using and 61% of those",
    "start": "2407599",
    "end": "2413599"
  },
  {
    "text": "styles are not being applied here right so you just kind of you put everything into your CSS and like it doesn't matter",
    "start": "2413599",
    "end": "2419560"
  },
  {
    "text": "right like it's all. CSS and this is in fact a good case uh I know that on my",
    "start": "2419560",
    "end": "2425640"
  },
  {
    "text": "own side for some pages it's 90% or 95% not being used because it's a very simple page but I've kind of put",
    "start": "2425640",
    "end": "2431200"
  },
  {
    "text": "everything into one thing so not only that but we can actually open up any one of these files and it'll tell you the",
    "start": "2431200",
    "end": "2436760"
  },
  {
    "text": "exact selectors that are not being used right so if if nothing else you can open this page kind of look at your landing",
    "start": "2436760",
    "end": "2442720"
  },
  {
    "text": "page on your homepage and figure out the specific chunks and just going of pull pull them out uh you can also do this",
    "start": "2442720",
    "end": "2448440"
  },
  {
    "text": "programmatically you can actually write a script that will walk the structure of your page query which styles are being",
    "start": "2448440",
    "end": "2453680"
  },
  {
    "text": "applied and then kind of extracted that way and uh one of the project that we have at Google called page speed we have",
    "start": "2453680",
    "end": "2460119"
  },
  {
    "text": "an open source implementation called mod page speed for Apache we're actually experimenting with this right now we're actually trying to build a filter uh",
    "start": "2460119",
    "end": "2467280"
  },
  {
    "text": "that will automatically if you will uh it'll load the page we will Traverse the",
    "start": "2467280",
    "end": "2473440"
  },
  {
    "text": "Dom we will figure out what are the critical assets or the critical CSS Styles we will Beacon that data back to",
    "start": "2473440",
    "end": "2478880"
  },
  {
    "text": "the server kind of accumulate this data for a little while and then start inlining the critical CSS you know this",
    "start": "2478880",
    "end": "2484319"
  },
  {
    "text": "this is kind of crazy crazy stuff uh but we have indications early indications",
    "start": "2484319",
    "end": "2489359"
  },
  {
    "text": "that this is actually going to work so hopefully we can automate a lot of the stuff but if not you know there's some",
    "start": "2489359",
    "end": "2494520"
  },
  {
    "text": "tools there uh the other uh cool little tool that I don't think many people are aware",
    "start": "2494520",
    "end": "2499720"
  },
  {
    "text": "of is uh we have this thing called the critical path Explorer and uh I'll show",
    "start": "2499720",
    "end": "2505280"
  },
  {
    "text": "you at the very end kind of a quick example of this but the difference here is you know don't don't worry about the",
    "start": "2505280",
    "end": "2511480"
  },
  {
    "text": "you reading the specific names of each and one of these assets basically I'm looking at guardian cuk and here's the",
    "start": "2511480",
    "end": "2516560"
  },
  {
    "text": "water full waterfall graph for that page right like tens and tens of resources",
    "start": "2516560",
    "end": "2521599"
  },
  {
    "text": "being fetched uh kind of see the step ladder and the idea behind critical path is okay great that's what it takes to",
    "start": "2521599",
    "end": "2528800"
  },
  {
    "text": "render the full page but what are the critical assets that we need to render something on the screen period right",
    "start": "2528800",
    "end": "2534560"
  },
  {
    "text": "some of the stuff that we load is not applied above the screen Etc and that's what this tool will extract you click a",
    "start": "2534560",
    "end": "2540160"
  },
  {
    "text": "button and it transforms that page or that view into this view right so you",
    "start": "2540160",
    "end": "2545359"
  },
  {
    "text": "very quickly can see okay uh I'm depending like here's my HML page which depends on this Javascript file and it",
    "start": "2545359",
    "end": "2551440"
  },
  {
    "text": "fetches the CSS so here's a quick example um hopefully you guys can see that so we",
    "start": "2551440",
    "end": "2558359"
  },
  {
    "text": "have we fetched the HTML and actually that purple bar there actually indicates that there's 300 millisecond red",
    "start": "2558359",
    "end": "2565640"
  },
  {
    "text": "redirect and um you know if you're trying to build a page that is rendering within 1 second",
    "start": "2565640",
    "end": "2574720"
  },
  {
    "text": "redirects are obviously an anti- pattern right so I'll just leave that out there um after that uh we can actually start",
    "start": "2574720",
    "end": "2582280"
  },
  {
    "text": "iterating and actually I'll point out another thing um I'll be frank and I'll say that this tool is still under active",
    "start": "2582280",
    "end": "2589520"
  },
  {
    "text": "development the actual UI for this I think is terrible uh but we'll make a better I promise what this little thing",
    "start": "2589520",
    "end": "2595480"
  },
  {
    "text": "tells you is this is where the Dom content loaded Dom content loaded uh event fires so what this tells you is",
    "start": "2595480",
    "end": "2602119"
  },
  {
    "text": "that we're not deferring or this page Guardian is not deferring any assets whatsoever right so it's going to take take way more than one",
    "start": "2602119",
    "end": "2608880"
  },
  {
    "text": "second but here's an example right you can actually hover all over all of these and it'll tell you that okay so we're",
    "start": "2608880",
    "end": "2614559"
  },
  {
    "text": "loading jQuery dommin um after that we have some uh show ads. JS which then",
    "start": "2614559",
    "end": "2622079"
  },
  {
    "text": "writes the Google ads script inside so kind of this nested do pattern uh this",
    "start": "2622079",
    "end": "2628160"
  },
  {
    "text": "is terrible for performance right because we're we're kind of we're nesting scripts inside other scripts uh",
    "start": "2628160",
    "end": "2633440"
  },
  {
    "text": "and then after all of that we have some long running JavaScript I I don't even know what is I didn't dig into it but it",
    "start": "2633440",
    "end": "2639480"
  },
  {
    "text": "takes on the order of 60 or 70 milliseconds so this view in itself uh",
    "start": "2639480",
    "end": "2644880"
  },
  {
    "text": "is very very powerful because it allows you to see like sure there's dozens and dozens of resources but what are the",
    "start": "2644880",
    "end": "2651280"
  },
  {
    "text": "critical ones on my page and your goal is to eliminate as many of those as you can or move them",
    "start": "2651280",
    "end": "2657400"
  },
  {
    "text": "out beyond that event of of the first paint",
    "start": "2657400",
    "end": "2662720"
  },
  {
    "text": "so you know I could have I guess started with the slide and we could have been done for 5 minutes",
    "start": "2662720",
    "end": "2668359"
  },
  {
    "text": "ago one request in line the critical Styles hopefully I've motivated uh why and and",
    "start": "2668359",
    "end": "2675680"
  },
  {
    "text": "why that's important and defer the rest right and this is this actually sounds the first time I've I've kind of went",
    "start": "2675680",
    "end": "2682160"
  },
  {
    "text": "through this exercise I I was very skeptical because it seems very hard to do in practice it turns out that Mo for",
    "start": "2682160",
    "end": "2687800"
  },
  {
    "text": "most Pages the kind of the critical path is not that complicated right you're",
    "start": "2687800",
    "end": "2692920"
  },
  {
    "text": "fetching dozens of resources but there's only so many files that are actually important and what you need need to do is figure out how to defer the rest and",
    "start": "2692920",
    "end": "2699359"
  },
  {
    "text": "kind of maybe Shuffle the structure of your page a little bit so it's not all that bad so with that I'll uh I'll take",
    "start": "2699359",
    "end": "2706880"
  },
  {
    "text": "some questions if we have time um I'll mention two things the slides should be there uh bitly mobile barrier and I am",
    "start": "2706880",
    "end": "2715000"
  },
  {
    "text": "currently working on this book with a riy called high performance browser networking so if you if you really want to dive into how the mobile radio works",
    "start": "2715000",
    "end": "2722920"
  },
  {
    "text": "and all the rest uh it's actually available online for free it's still an early development so you know there's typos and all the rest if anything I",
    "start": "2722920",
    "end": "2729599"
  },
  {
    "text": "would appreciate your feedback but it's online and it's free so check it out and I'd love your feedback on it all right",
    "start": "2729599",
    "end": "2735000"
  },
  {
    "text": "so with that big round of applause for thank you",
    "start": "2735000",
    "end": "2741000"
  },
  {
    "text": "[Music]",
    "start": "2741990",
    "end": "2750399"
  }
]