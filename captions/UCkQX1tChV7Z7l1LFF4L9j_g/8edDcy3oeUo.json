[
  {
    "start": "0",
    "end": "51000"
  },
  {
    "text": "good morning everybody thank you for joining our session here this is milking the most out of thousands of kubernetes",
    "start": "3970",
    "end": "10390"
  },
  {
    "text": "clusters with chick-fil-a and I know we've got a good competition next door with whiff talking about service meshes",
    "start": "10390",
    "end": "16900"
  },
  {
    "text": "free chicken sandwiches for all of you if you stay throughout the end I wish that was true we we didn't know how many",
    "start": "16900",
    "end": "22600"
  },
  {
    "text": "people to cook for so but we're super glad you're here and looking forward to sharing with you about what we're doing",
    "start": "22600",
    "end": "27730"
  },
  {
    "text": "at chick-fil-a so my name is Brian chambers and I'm responsible for our",
    "start": "27730",
    "end": "33130"
  },
  {
    "text": "Internet of Things capability at chick-fil-a as well as what we do around computing at the edge which is in our",
    "start": "33130",
    "end": "38170"
  },
  {
    "text": "restaurants super happy to also have Caleb herd with me as well and Caleb is an SRE that's focused on those two",
    "start": "38170",
    "end": "44649"
  },
  {
    "text": "platforms and who helps us operate those things effectively at scale so let's get",
    "start": "44649",
    "end": "51190"
  },
  {
    "start": "51000",
    "end": "51000"
  },
  {
    "text": "started with giving you a sense of what to expect from the session so first you want to make sure you understand really what do we do at chick-fil-a or what are",
    "start": "51190",
    "end": "58149"
  },
  {
    "text": "some of the challenges we have and why are we doing anything with significant technology why is chick-fil-a here at",
    "start": "58149",
    "end": "63850"
  },
  {
    "text": "this conference talking about kubernetes so explain kind of our problem space help you understand that a little bit better and then you know answer the",
    "start": "63850",
    "end": "70840"
  },
  {
    "text": "question about how we're actually using kubernetes at the edge in our restaurants I'm an architect by",
    "start": "70840",
    "end": "76600"
  },
  {
    "text": "background so I have to tell you about our architecture so we're gonna share about that and how that works then the majority of the time is really gonna be",
    "start": "76600",
    "end": "82780"
  },
  {
    "text": "talking about the fact that kubernetes is really awesome but there are certain things that are true for us at our kind",
    "start": "82780",
    "end": "89980"
  },
  {
    "text": "of scale that are probably true for you and the nature of the business that you work in where kubernetes is an awesome platform but you have to do some",
    "start": "89980",
    "end": "95920"
  },
  {
    "text": "engineering around it to actually be able to fully take advantage of it and so we're gonna share a couple areas where that was true for us and then the",
    "start": "95920",
    "end": "102370"
  },
  {
    "text": "solutions that we came up with and how we solved those problems and then our hope is to have some Q&A time",
    "start": "102370",
    "end": "107830"
  },
  {
    "text": "significant Q&A time so we'd love to answer your questions and then we'll of course hang out at the back at the end so the next session can come in but if",
    "start": "107830",
    "end": "114280"
  },
  {
    "text": "you want to find us in chat one-on-one we'd love to talk with you more so with",
    "start": "114280",
    "end": "120280"
  },
  {
    "text": "that said how many of you guys have been to and eaten at a chick-fil-a restaurant",
    "start": "120280",
    "end": "125290"
  },
  {
    "text": "before show of hands awesome I love it okay so if you haven't that triangle",
    "start": "125290",
    "end": "132550"
  },
  {
    "text": "kind of to the top right of the map here you are right in the middle of it right now sitting here in Times Square so there",
    "start": "132550",
    "end": "137790"
  },
  {
    "text": "are three chick-fil-a's within a couple minutes of you and if you want to get up right now and leave the session and go eat there no judgement at all go for it",
    "start": "137790",
    "end": "143819"
  },
  {
    "text": "you're good to go but if you have been to chick-fil-a you've probably seen something that looks a lot like this",
    "start": "143819",
    "end": "149549"
  },
  {
    "text": "this is a picture from one of the New York locations you've got people just you know packed in lines outside if",
    "start": "149549",
    "end": "156060"
  },
  {
    "text": "you're from a suburban area you may have been in a situation where you've sat in a drive-through line that's wrapped around the building maybe even twice and",
    "start": "156060",
    "end": "163260"
  },
  {
    "text": "our restaurants are super super super busy and that's a good problem but it creates some interesting challenges so",
    "start": "163260",
    "end": "168810"
  },
  {
    "text": "just to throw some stats out there to help you get a handle on this this is a",
    "start": "168810",
    "end": "173909"
  },
  {
    "text": "little dated but but pretty accurate for an average restaurant in terms of how much product is actually going across",
    "start": "173909",
    "end": "179639"
  },
  {
    "text": "the counter of our restaurants at any given time there's a lot of stuff happening and like I said this great",
    "start": "179639",
    "end": "186930"
  },
  {
    "text": "some capacity challenges so average chick-fil-a restaurant six days a week we're closed on Sunday does more volume",
    "start": "186930",
    "end": "193739"
  },
  {
    "text": "than any of our competitors do in that full seven days and we have a lot of restaurants that were built with a",
    "start": "193739",
    "end": "199379"
  },
  {
    "text": "certain sales volume in mind can't tell you the exact number but they're doing more than triple that amount so again",
    "start": "199379",
    "end": "205230"
  },
  {
    "text": "pressures on the ability to actually work in that restaurant to be able to make great experiences for our customers",
    "start": "205230",
    "end": "210470"
  },
  {
    "text": "what we want is for you to come through and get hot fresh food a great you know",
    "start": "210470",
    "end": "215790"
  },
  {
    "text": "connection with somebody personally if that's what you're looking for if you're racing through the drive-through because you're off we want it to be fast and convenient for you but all of this",
    "start": "215790",
    "end": "222840"
  },
  {
    "text": "volume has gotten to a point where it makes it very challenging to continually execute on that you know in the way that",
    "start": "222840",
    "end": "228479"
  },
  {
    "text": "we want to so we at chick-fil-a Caleb and myself included we believe that a",
    "start": "228479",
    "end": "233489"
  },
  {
    "text": "lot of the solutions to these capacity problems that we have and the the other challenges in our business are rooted",
    "start": "233489",
    "end": "238530"
  },
  {
    "text": "the solutions are rooted in technology and so where this lettuce is we started",
    "start": "238530",
    "end": "243540"
  },
  {
    "text": "down the road I shared about this at UConn last year about having an Internet of Things platform in our restaurant and",
    "start": "243540",
    "end": "250229"
  },
  {
    "text": "the thinking there is really this if you're able to take your kitchen equipment and make it smarter if you're",
    "start": "250229",
    "end": "256349"
  },
  {
    "text": "able to have screens that drive our food production you know and help people make",
    "start": "256349",
    "end": "261570"
  },
  {
    "text": "just the right amount of food at just the right time you know streamline excuse me extremely in that process that",
    "start": "261570",
    "end": "269070"
  },
  {
    "text": "can really help us you know those goals really fast great service great customer experience and as we",
    "start": "269070",
    "end": "274139"
  },
  {
    "text": "started to connect things in our restaurants and think about what that meant and we wanted to have the capability to actually run critical",
    "start": "274139",
    "end": "280530"
  },
  {
    "text": "business functions even automating you know product production somewhere down the line we realized that having a",
    "start": "280530",
    "end": "286530"
  },
  {
    "text": "dependency on a internet connection that could be a varying quality it could be really great or it could be really slow",
    "start": "286530",
    "end": "291900"
  },
  {
    "text": "and really terrible was gonna be a challenge and we knew that there were gonna be things that we were trying to react at the speed of customers coming",
    "start": "291900",
    "end": "298139"
  },
  {
    "text": "in and out of the restaurant and so wait and see really low latency is very important important to us as well so",
    "start": "298139",
    "end": "304860"
  },
  {
    "text": "that led us down the journey of establishing an edge computing footprint for our restaurants and what I really",
    "start": "304860",
    "end": "311340"
  },
  {
    "text": "mean by that is computing at the edge is just taking compute like you would have in the cloud but putting it close to the",
    "start": "311340",
    "end": "317009"
  },
  {
    "text": "action for us this is in the restaurant for you this could be at your different business sites anybody in retail probably has a similar paradigm but it's",
    "start": "317009",
    "end": "323430"
  },
  {
    "text": "pushing that close to where the actual action is taking place and then running a lot of the core business from there and then tipping back to things where",
    "start": "323430",
    "end": "329789"
  },
  {
    "text": "you can depend on the internet and the cloud as it makes sense so that's what we're doing I want to share what our",
    "start": "329789",
    "end": "335639"
  },
  {
    "text": "architecture looked like at this time last year so just to give you a real high level you'll see there's a kind of",
    "start": "335639",
    "end": "341610"
  },
  {
    "start": "336000",
    "end": "336000"
  },
  {
    "text": "a control plane in the cloud for us that runs in AWS we're running docker swarm at the edge last year and that's changed",
    "start": "341610",
    "end": "349139"
  },
  {
    "text": "we'll obviously talk about that a good bit today and we have a series of core services we really think of our edge computing platforms and restaurants it's",
    "start": "349139",
    "end": "355979"
  },
  {
    "text": "kind of like a tiny little micro private cloud environment we want developers who want to build things",
    "start": "355979",
    "end": "361110"
  },
  {
    "text": "to impact the restaurant to really have the same paradigm they have deploying something to AWS there's some helpful",
    "start": "361110",
    "end": "366839"
  },
  {
    "text": "core services there like authentication and authorization messaging etc and then",
    "start": "366839",
    "end": "372120"
  },
  {
    "text": "they have the ability to deploy containerized apps at the edge and then of course there's connectivity and things we're not gonna spend a lot of",
    "start": "372120",
    "end": "377849"
  },
  {
    "text": "time on this so here's how things have changed and kind of where we are today and so the the little dashes around the",
    "start": "377849",
    "end": "385800"
  },
  {
    "start": "380000",
    "end": "380000"
  },
  {
    "text": "things are the pieces that change from the last slide so the first thing you'll note and obviously you're smart group",
    "start": "385800",
    "end": "391379"
  },
  {
    "text": "but it was also in the title we've moved away from docker swarm and we're running kubernetes in our clusters at the edge instead and we're gonna tell you a",
    "start": "391379",
    "end": "397409"
  },
  {
    "text": "little bit about why we made that decision in just a moment that change we've introduced accordion s",
    "start": "397409",
    "end": "403940"
  },
  {
    "text": "at the edge so we actually run DNS for both our kubernetes cluster as well as for the rest of the net restaurant LAN",
    "start": "403940",
    "end": "410300"
  },
  {
    "text": "so anything that needs to discover services and look things up we provide that as a service in the restaurant",
    "start": "410300",
    "end": "415540"
  },
  {
    "text": "we've actually just started to use the ISTE Oh traffic ingress gateway I",
    "start": "415540",
    "end": "422660"
  },
  {
    "text": "believe gateways the new name and well it's still tagged in alpha we had some good conversations with people that gave",
    "start": "422660",
    "end": "428210"
  },
  {
    "text": "us a high degree of confidence that it was a good enough point that we could feel confident using that and we're really excited about this do we'll talk",
    "start": "428210",
    "end": "434870"
  },
  {
    "text": "a little bit more about that in a few minutes and then since we're in a kubernetes ecosystem we had the opportunity to use Prometheus from a",
    "start": "434870",
    "end": "441560"
  },
  {
    "text": "monitoring and metrics collection perspective and the way that we do this is just like it looks here Prometheus actually runs at the edge in",
    "start": "441560",
    "end": "448010"
  },
  {
    "text": "each of the restaurants and does local collection and then pushes things back up to the cloud so we can get consolidated views and you know check on",
    "start": "448010",
    "end": "455030"
  },
  {
    "text": "statuses of Canaria deployments and and all those kinds of things that you would do more at the above restaurant control plane level and then on the top right",
    "start": "455030",
    "end": "462889"
  },
  {
    "text": "you'll see fleet we're gonna wrap the talk up sharing what fleet is it's how we do restaurant deployments but I'm",
    "start": "462889",
    "end": "467930"
  },
  {
    "text": "gonna defer that one until a little bit later so why the switch from swarm to",
    "start": "467930",
    "end": "473240"
  },
  {
    "start": "471000",
    "end": "471000"
  },
  {
    "text": "Cooper Nettie's well the first thing I wanna answer is why run containers in a fast food restaurant in the first place",
    "start": "473240",
    "end": "479260"
  },
  {
    "text": "and really at the end of the day this comes down to a core thing that we believe which is what you see on this",
    "start": "479260",
    "end": "484760"
  },
  {
    "text": "slide we believe that an idea in and of itself doesn't really have any value and we actually believe even though we're",
    "start": "484760",
    "end": "491000"
  },
  {
    "text": "engineers we believe the same thing about code we believe that code itself doesn't really have any value the place",
    "start": "491000",
    "end": "496970"
  },
  {
    "text": "where we get value and where we get impact on our businesses is when we're able to take ideas turn them into code it and take code and get it into",
    "start": "496970",
    "end": "503000"
  },
  {
    "text": "production and that's where we begin to learn real things from real users get real feedback and actually be able to begin to build something they can impact",
    "start": "503000",
    "end": "509930"
  },
  {
    "text": "our business so at chick-fil-a we want to optimize for going through that process iteratively as quickly and",
    "start": "509930",
    "end": "516860"
  },
  {
    "text": "rapidly as possible and what we feel is that there's a lot of things if you",
    "start": "516860",
    "end": "522140"
  },
  {
    "text": "think about an application a lot of what actually you have to do with an application it's not building your core",
    "start": "522140",
    "end": "527630"
  },
  {
    "text": "logic it's all the little things around it it's all the security related things it's all the traceability the the",
    "start": "527630",
    "end": "533420"
  },
  {
    "text": "monitoring the the introspection those are the things that end up taking a lot of time sometimes writing services that do",
    "start": "533420",
    "end": "539389"
  },
  {
    "text": "things well simple micro-services is actually really really straightforward and easy and you spend all your time in the area around it we're excited because",
    "start": "539389",
    "end": "545509"
  },
  {
    "text": "we think the kubernetes ecosystem is one that is bringing a lot of tools to bear that are gonna make that process a lot easier for developers and what they're",
    "start": "545509",
    "end": "552920"
  },
  {
    "text": "talking about with service meshes next door what ISTE is bringing there's opportunities to offload a lot of that",
    "start": "552920",
    "end": "557959"
  },
  {
    "text": "heavy lifting into sidecars in pods in kubernetes and so we wanted to make a",
    "start": "557959",
    "end": "563120"
  },
  {
    "text": "switch into a place where we're gonna be able to take advantage of those developments in the industry swarm was cool we really feel like the",
    "start": "563120",
    "end": "571040"
  },
  {
    "text": "future is kubernetes and we wanted to be kind of on that train getting the the latest and greatest development that was",
    "start": "571040",
    "end": "576290"
  },
  {
    "text": "coming out there now we did not switch to kubernetes because it was the cool new thing so last slide I have here on",
    "start": "576290",
    "end": "583910"
  },
  {
    "text": "this topic book I'd recommend you check out but accelerate is a research-based approach to what makes engineering teams",
    "start": "583910",
    "end": "590300"
  },
  {
    "start": "584000",
    "end": "584000"
  },
  {
    "text": "successful getting some thumbs up out there awesome really great book using the greatest technology the newest stuff",
    "start": "590300",
    "end": "596449"
  },
  {
    "text": "has no correlation at all to the success of your project or your business if you can do what we're doing and what we",
    "start": "596449",
    "end": "602329"
  },
  {
    "text": "talked about today on VMware or on pure bare metal or on Windows boxes or",
    "start": "602329",
    "end": "607519"
  },
  {
    "text": "anything like that then you can totally do that and that's totally fine you could be equally successful as we are",
    "start": "607519",
    "end": "614360"
  },
  {
    "text": "using kubernetes but what does matter and what really does have an impact what will actually ultimately impact your",
    "start": "614360",
    "end": "620660"
  },
  {
    "text": "business is can you have short live feature branches that you can get into production really really rapidly one to",
    "start": "620660",
    "end": "626389"
  },
  {
    "text": "two days is what they say and accelerate and so as we think about that we really felt like for our team we get a small",
    "start": "626389",
    "end": "631490"
  },
  {
    "text": "team of about seven engineers that run this entire platform for these 2,000 restaurants and that includes sre for a",
    "start": "631490",
    "end": "637819"
  },
  {
    "text": "very small team we felt like the tooling in the kubernetes world it was going to be the key to our success and our ability to do that so that we could get",
    "start": "637819",
    "end": "643819"
  },
  {
    "text": "things into restaurants and make great experiences for you when you get a chick-fil-a so this one I'm gonna hand it off the",
    "start": "643819",
    "end": "649699"
  },
  {
    "text": "Caleb who's gonna take us on the next couple steps about some of the engineering problems that we've solved thanks Bryan how's everybody all right",
    "start": "649699",
    "end": "658089"
  },
  {
    "text": "so we're gonna talk about datacenters real quick and quick introductions so I'm an SRE site reliability engineer at",
    "start": "658089",
    "end": "664819"
  },
  {
    "text": "chick-fil-a we're gonna switch gears and talk about data centers real quick so who here in",
    "start": "664819",
    "end": "671350"
  },
  {
    "start": "668000",
    "end": "668000"
  },
  {
    "text": "this room show hands users AWS all right quite a few of you not surprised what",
    "start": "671350",
    "end": "678040"
  },
  {
    "text": "about a Google cloud any Google cloud users in production awesome and don't be",
    "start": "678040",
    "end": "684100"
  },
  {
    "text": "embarrassed do you also use in the south we call it a sure but I think it's as you were",
    "start": "684100",
    "end": "689470"
  },
  {
    "text": "awesome so a couple people in the room that had been forced to use anyway that was a joke and that was uh that fell",
    "start": "689470",
    "end": "698709"
  },
  {
    "text": "flat but anyways these are our inspirations so these are some of the data centers they have in the US all",
    "start": "698709",
    "end": "705339"
  },
  {
    "text": "three of these guys despite the as you're a joke are really good at what they do but that being said they just",
    "start": "705339",
    "end": "711399"
  },
  {
    "text": "didn't quite serve our needs so I'm extremely happy to announce and very excited to announce that today we're",
    "start": "711399",
    "end": "717910"
  },
  {
    "text": "gonna be launching cloud fillet where it is our pleasure to server you that was",
    "start": "717910",
    "end": "724899"
  },
  {
    "text": "also a lame joke apparently you guys are a tough crowd no so I say that in jest this is a map",
    "start": "724899",
    "end": "731230"
  },
  {
    "text": "of all of our restaurants that were that we're putting kubernetes clusters in and you know it is a joke slide but there's",
    "start": "731230",
    "end": "737709"
  },
  {
    "text": "a little bit of truth to it and that is that as much as we rely on these cloud providers the problem set that we had",
    "start": "737709",
    "end": "744069"
  },
  {
    "text": "especially as an SRE I'm very interested in this problem set is that we have intermittent connectivity so there's",
    "start": "744069",
    "end": "749529"
  },
  {
    "text": "certain a certain amount of work that had to happen at the compute level at",
    "start": "749529",
    "end": "755019"
  },
  {
    "text": "the restaurant so in order to do that reliably the question was how without",
    "start": "755019",
    "end": "760630"
  },
  {
    "text": "paying millions and millions of dollars are we gonna put miniature data centers in each restaurant that are self-healing",
    "start": "760630",
    "end": "766709"
  },
  {
    "text": "highly available and do it with seven people so it's not like we had this big massive budget this big massive team in",
    "start": "766709",
    "end": "773889"
  },
  {
    "text": "order to launch this so we ended up deciding to build our own kubernetes clusters on these little guys these are",
    "start": "773889",
    "end": "780939"
  },
  {
    "text": "called nuts next unit of compute eight gigs of ram cell state drive quad core",
    "start": "780939",
    "end": "787060"
  },
  {
    "text": "processor not a very impressive one but it gets the job done you can see it's tiny",
    "start": "787060",
    "end": "792339"
  },
  {
    "text": "we used a chick-fil-a sandwich for scale so if you haven't been to chick-fil-a",
    "start": "792339",
    "end": "797470"
  },
  {
    "text": "you should go buy a sandwich just so you can understand the scale of it what",
    "start": "797470",
    "end": "803089"
  },
  {
    "text": "these guys are running is a bare-metal version of kubernetes which I'm going to",
    "start": "803089",
    "end": "808490"
  },
  {
    "text": "I'm going to dive into the picture on the right is a nice picture of some of the reality of the situation's we're",
    "start": "808490",
    "end": "814459"
  },
  {
    "text": "dealing with so I mean you we don't have great temperature control they may or",
    "start": "814459",
    "end": "820100"
  },
  {
    "text": "may not be in a cabinet that could be sitting up near the ceiling somewhere this is a restaurant right so you're",
    "start": "820100",
    "end": "826610"
  },
  {
    "text": "dealing with grease and all the other things that come with that so not only did they need to be reliable and be able",
    "start": "826610",
    "end": "832519"
  },
  {
    "text": "to set themselves up but they also need to be able to survive and conditions like this so these things I'm gonna",
    "start": "832519",
    "end": "839959"
  },
  {
    "text": "cover we're gonna talk about how we chose to build and repair these clusters how we",
    "start": "839959",
    "end": "845870"
  },
  {
    "text": "do deployments I'm going to talk about some lessons that I've learned is it necessary specifically in dealing with this and then I'm gonna hand back over",
    "start": "845870",
    "end": "852170"
  },
  {
    "text": "to Brian and he's gonna talk about fleet which is another thing we are excited about that we've actually open sourced",
    "start": "852170",
    "end": "858589"
  },
  {
    "text": "we'll we'll open source in the near future and he'll that our deployment",
    "start": "858589",
    "end": "864680"
  },
  {
    "text": "process is very very interesting so I purposefully put the gold top code to",
    "start": "864680",
    "end": "870110"
  },
  {
    "start": "866000",
    "end": "866000"
  },
  {
    "text": "prod so again as an SRE and I really want to emphasize this to any engineers in the room it's so easy to see a",
    "start": "870110",
    "end": "878000"
  },
  {
    "text": "problem and fix it but at the end of the day if it's not helping me actually get code into production or helping another",
    "start": "878000",
    "end": "884420"
  },
  {
    "text": "team actually get code into production then it's really ultimately a waste of time it makes me feel good but it",
    "start": "884420",
    "end": "889759"
  },
  {
    "text": "doesn't actually help the business so I just want to emphasize every problem that we tackled we looked at it through",
    "start": "889759",
    "end": "895459"
  },
  {
    "text": "that filter another thing is it needed to be simple enough to be installed by a",
    "start": "895459",
    "end": "900559"
  },
  {
    "text": "non-technical installer so we have a technical team that goes out to each restaurant that will be doing this",
    "start": "900559",
    "end": "905899"
  },
  {
    "text": "install but these are not kubernetes engineers they don't know anything about nuts etc these are skilled technologists",
    "start": "905899",
    "end": "914389"
  },
  {
    "text": "but in different areas the other thing is is if if the device dies or cluster dies we need to be able to drop ship to",
    "start": "914389",
    "end": "921290"
  },
  {
    "text": "the restaurant and have an operator which is the on-site essentially owner of that restaurant be able to unbox it",
    "start": "921290",
    "end": "928759"
  },
  {
    "text": "read some instructions swap it out and all the magic hat unsupervised without our team having to",
    "start": "928759",
    "end": "934519"
  },
  {
    "text": "take that manpower on so it was provisioning and healing were definitely",
    "start": "934519",
    "end": "940339"
  },
  {
    "text": "some interesting challenges we had to solve managing it remotely so we're not actually allowed to SSH or VPN into the",
    "start": "940339",
    "end": "947990"
  },
  {
    "text": "restaurants themselves everything that we build has to pull out to us for security reasons friars and some other",
    "start": "947990",
    "end": "955670"
  },
  {
    "text": "sensitive information our sensitive devices are controlled by these and as you can imagine we don't want",
    "start": "955670",
    "end": "961519"
  },
  {
    "text": "restaurants going up in flames because we didn't take security seriously so that's another challenge I'm going to",
    "start": "961519",
    "end": "967129"
  },
  {
    "text": "talk through and a little bit more detail later they had to be able to automatically discover themselves so it",
    "start": "967129",
    "end": "972680"
  },
  {
    "text": "doesn't matter if it's one device or three devices or seven devices they need to be able to talk to each other cluster",
    "start": "972680",
    "end": "977689"
  },
  {
    "text": "up heal themselves if some of them drop out of the cluster and that brings me to",
    "start": "977689",
    "end": "982819"
  },
  {
    "text": "the last point which is self-healing and high availability so this graph shows",
    "start": "982819",
    "end": "988420"
  },
  {
    "text": "two experiences the first top is what an installer or an operator sees when they",
    "start": "988420",
    "end": "996110"
  },
  {
    "text": "install the device so I'm gonna walk through that and then the second row of boxes shows all the magic that's",
    "start": "996110",
    "end": "1002889"
  },
  {
    "text": "happening in these tiny little nook devices as as all that happens so the",
    "start": "1002889",
    "end": "1009699"
  },
  {
    "text": "Installer receives a device unboxes it plugs it in gives it power gives it",
    "start": "1009699",
    "end": "1014829"
  },
  {
    "text": "Ethernet and then he goes he or she goes to a portal called Sherlock something we",
    "start": "1014829",
    "end": "1021089"
  },
  {
    "text": "created internally for ourselves and logs in with their username password and",
    "start": "1021089",
    "end": "1026319"
  },
  {
    "text": "then the device has already started talking to Sherlock and they approve yes I really did install this device yes I",
    "start": "1026319",
    "end": "1033459"
  },
  {
    "text": "really do approve that this device should be at this restaurant so essentially it's our way of trusting",
    "start": "1033459",
    "end": "1039370"
  },
  {
    "text": "that device on our network the second thing that they see is it goes a new provisioning status so again they've",
    "start": "1039370",
    "end": "1045279"
  },
  {
    "text": "logged in they've hit yes so far they it goes into a provisioning status if",
    "start": "1045279",
    "end": "1050919"
  },
  {
    "text": "there's a bunch of magic I'll talk about it a moment and then it goes into clustering status and then it hits online and if they hit any issues on the",
    "start": "1050919",
    "end": "1058090"
  },
  {
    "text": "way they give us a call and we'll figure out what's going on remotely so all the magic that's happening underneath that",
    "start": "1058090",
    "end": "1064240"
  },
  {
    "text": "and the tools that we've used in order to accomplish it first is getting the actual golden image on the Knux and we",
    "start": "1064240",
    "end": "1072250"
  },
  {
    "text": "use an MVP model so don't judge us but we got the job done we use ansible to script out what all",
    "start": "1072250",
    "end": "1077830"
  },
  {
    "text": "should be on those knucks so anything the golden image is is built meticulously through infrastructure as",
    "start": "1077830",
    "end": "1084520"
  },
  {
    "text": "code so we know exactly what's on these devices we base it on Ubuntu 1804 1604",
    "start": "1084520",
    "end": "1090280"
  },
  {
    "text": "would have been an easier path for us but honestly upgrading the 1804 down the road probably would have been a harder",
    "start": "1090280",
    "end": "1096580"
  },
  {
    "text": "path and just using the latest version now definitely sidenote some interesting",
    "start": "1096580",
    "end": "1102580"
  },
  {
    "text": "networking challenges with 1804 I think they it's better than 1604 but it's",
    "start": "1102580",
    "end": "1109240"
  },
  {
    "text": "definitely challenging and then we use Clonezilla to essentially once we've got",
    "start": "1109240",
    "end": "1115150"
  },
  {
    "text": "we know okay this is what a nut should look like we pull that image off and we use Clonezilla to blast it out to the other nuts this is prior to shipment",
    "start": "1115150",
    "end": "1121950"
  },
  {
    "text": "then they get shipped out to the Installer installing boxes and everything I just described happens they power up register with Sherlock which is",
    "start": "1121950",
    "end": "1128740"
  },
  {
    "text": "the internal thing that we built the next thing they do is there's an internal project we use called Highlander there can be only one this is",
    "start": "1128740",
    "end": "1137560"
  },
  {
    "text": "the part of the talk where I pull sort out but they they took it at laguardia and they haven't given it back to me",
    "start": "1137560",
    "end": "1143850"
  },
  {
    "text": "anyways I'm gonna just not give any more Jesse's so anyways so Highlander",
    "start": "1143850",
    "end": "1149560"
  },
  {
    "text": "essentially they all talk to each other and they they elect a leader and that leader is the one that will then do the",
    "start": "1149560",
    "end": "1156310"
  },
  {
    "text": "clustering process get all the nodes together and make everything happen and if that leader dies Highlander will",
    "start": "1156310",
    "end": "1163270"
  },
  {
    "text": "reelect another leader and it'll continue until actually go it'll fight all the way down to one box if it has to",
    "start": "1163270",
    "end": "1169110"
  },
  {
    "text": "and then Lord of the Flies style once a leader emerges that leader will RK up",
    "start": "1169110",
    "end": "1174910"
  },
  {
    "text": "now this is ranchers engine that they use to create kubernetes clusters and I",
    "start": "1174910",
    "end": "1182290"
  },
  {
    "text": "think it's the next slide it's one of the the next upcoming slides I'll walk you through why we chose that and the",
    "start": "1182290",
    "end": "1188650"
  },
  {
    "text": "other solutions we looked at what we liked about and what we didn't like about them that whole process of",
    "start": "1188650",
    "end": "1194050"
  },
  {
    "text": "clustering kubernetes is like under three minutes with our okay it's pretty amazing a little",
    "start": "1194050",
    "end": "1199440"
  },
  {
    "text": "confession which it took me like two and a half weeks the first time I built my first kubernetes cluster from hand by",
    "start": "1199440",
    "end": "1206279"
  },
  {
    "text": "hand from scratch so three minutes or so is very appealing to me the next thing",
    "start": "1206279",
    "end": "1213659"
  },
  {
    "text": "it does is so at this point we have a kubernetes cluster doesn't have any services installed on it yet it works at",
    "start": "1213659",
    "end": "1220679"
  },
  {
    "text": "the restaurant but it I'm blind to it I can't see it I can't touch it I can't login to it I can't do anything to it so",
    "start": "1220679",
    "end": "1226740"
  },
  {
    "text": "the last thing it does is that it we use a something we open-source last night actually called hubs up it enrolls",
    "start": "1226740",
    "end": "1234389"
  },
  {
    "text": "itself into AWS SSM now SSM is a technology where you install local agent",
    "start": "1234389",
    "end": "1240269"
  },
  {
    "text": "it pulls AWS and it says hey do you have any commands I need to run locally on the box and so we can actually do fleet",
    "start": "1240269",
    "end": "1247320"
  },
  {
    "text": "management as if we're a cessation of those boxes without ever having to open a port or do anything like that",
    "start": "1247320",
    "end": "1253889"
  },
  {
    "text": "we can send a command out to thousands of devices and get responses back in under a minute it's pretty awesome and",
    "start": "1253889",
    "end": "1261149"
  },
  {
    "text": "then the last piece so now I've got a cluster it's working I can touch it",
    "start": "1261149",
    "end": "1266369"
  },
  {
    "text": "but doesn't have any of our actual services installed on it yet and fleet which Brian will touch on is our way of",
    "start": "1266369",
    "end": "1272970"
  },
  {
    "text": "rolling those services out Highlander so let me check my time sorry I don't want",
    "start": "1272970",
    "end": "1280320"
  },
  {
    "start": "1275000",
    "end": "1275000"
  },
  {
    "text": "to go over time here perfect so I already talked to this a little bit so",
    "start": "1280320",
    "end": "1287190"
  },
  {
    "text": "I'm going to kind of blow through this but we use UDP for the devices to find each other talk to each other an elected",
    "start": "1287190",
    "end": "1292799"
  },
  {
    "text": "leader this is actually running as a pod on kubernetes so it's a small little",
    "start": "1292799",
    "end": "1299190"
  },
  {
    "text": "micro service that we built once once they talk to each other and somebody",
    "start": "1299190",
    "end": "1304799"
  },
  {
    "text": "picks a leader that leader goes okay I see three devices or five devices or however on the network and it begins the",
    "start": "1304799",
    "end": "1310200"
  },
  {
    "text": "rke up process that actually closes the devices we also use OAuth in that",
    "start": "1310200",
    "end": "1315450"
  },
  {
    "text": "process so that we can access our custom doctor repository and some of our other custom components so it also has a auth",
    "start": "1315450",
    "end": "1322139"
  },
  {
    "text": "built into it and it'll install a few basic pods that we need such as sto for",
    "start": "1322139",
    "end": "1330029"
  },
  {
    "text": "ingress and the control plane itself one thing I",
    "start": "1330029",
    "end": "1335840"
  },
  {
    "text": "do want to say about sto so we originally were using nginx we ended up going with this deal for a variety of",
    "start": "1335840",
    "end": "1341000"
  },
  {
    "text": "reasons but one of the things that I really loved about it as an SRE is it gives me really fine grained control",
    "start": "1341000",
    "end": "1346300"
  },
  {
    "text": "over where I send and what percentage of traffic I send to what devices so in the",
    "start": "1346300",
    "end": "1352070"
  },
  {
    "text": "case of a canary deployment if I had nginx and I had three pods running on",
    "start": "1352070",
    "end": "1357350"
  },
  {
    "text": "three devices I would have to send 33% of my traffic to v2 of whatever we",
    "start": "1357350",
    "end": "1362780"
  },
  {
    "text": "deploy sto allows me to throttle that so I could send 1% of my traffic to a new",
    "start": "1362780",
    "end": "1368179"
  },
  {
    "text": "version check the logs and then proceed it's just it's just way more tunable in",
    "start": "1368179",
    "end": "1374809"
  },
  {
    "text": "that regard so initializing clusters so these are some solutions that we went",
    "start": "1374809",
    "end": "1380570"
  },
  {
    "start": "1376000",
    "end": "1376000"
  },
  {
    "text": "through and ultimately ended up abandoning before we settle it on rke so we really really really really love cops",
    "start": "1380570",
    "end": "1388280"
  },
  {
    "text": "we use it in AWS it's very easy it's very robust it's easy to interface with",
    "start": "1388280",
    "end": "1393980"
  },
  {
    "text": "and reason with however no bare metal",
    "start": "1393980",
    "end": "1398990"
  },
  {
    "text": "option and unfortunately we're doing six thousand bare metal devices so you know unfortunate that was out of the running",
    "start": "1398990",
    "end": "1405350"
  },
  {
    "text": "I think they've either just published or about to publish about a bare metal solutions we might revisit that",
    "start": "1405350",
    "end": "1410450"
  },
  {
    "text": "obviously I would assume that it's probably gonna need a little bit of work when it comes out at first cube spray over the last couple years has kind of",
    "start": "1410450",
    "end": "1416960"
  },
  {
    "text": "been the de-facto way of building kubernetes clusters and scale in them I almost want to use the",
    "start": "1416960",
    "end": "1424429"
  },
  {
    "text": "word reliable fashion unfortunately cube spray essentially is this really massive ansible repo that",
    "start": "1424429",
    "end": "1431420"
  },
  {
    "text": "does a whole bunch of stuff and it's very impressive and for the early solutions of kubernetes on bare metal",
    "start": "1431420",
    "end": "1437870"
  },
  {
    "text": "props to the team I really have nothing negative to say the problem that we had is it just was taking way too long",
    "start": "1437870",
    "end": "1443809"
  },
  {
    "text": "provisioned clusters so it could take 45 minutes for that to finish and then if",
    "start": "1443809",
    "end": "1448940"
  },
  {
    "text": "it died in the middle because a repo wasn't available or there was a connectivity problem it was extremely",
    "start": "1448940",
    "end": "1454340"
  },
  {
    "text": "hard to go find state again and restart especially the way that it was generating certificates etc so shout out",
    "start": "1454340",
    "end": "1460610"
  },
  {
    "text": "to keep spray it just didn't work for our use case cube admin again seven engineers 2,000 clusters",
    "start": "1460610",
    "end": "1469780"
  },
  {
    "text": "cube admins probably the proper way to do it we just didn't have time to roll our own kubernetes cluster in solution",
    "start": "1469840",
    "end": "1477140"
  },
  {
    "text": "but in the future we probably will take another look at cube admin it's a very",
    "start": "1477140",
    "end": "1482900"
  },
  {
    "text": "robust tool we ended up settling on rke primarily because of how fast it was and",
    "start": "1482900",
    "end": "1489350"
  },
  {
    "text": "also because of how easy it was so currently you set up a configuration",
    "start": "1489350",
    "end": "1494480"
  },
  {
    "text": "file you have the arc a repo locally you compile it you hit go and as long as it",
    "start": "1494480",
    "end": "1500150"
  },
  {
    "text": "has the correct locations of the other nodes a few minutes later you'll have a kubernetes cluster on bare metal the",
    "start": "1500150",
    "end": "1507559"
  },
  {
    "text": "biggest problem that we have with our key is that it's so good what it does we don't really understand what it does so",
    "start": "1507559",
    "end": "1514120"
  },
  {
    "text": "hopefully in the future either we can understand a little bit better or use a solution that we're a little bit more",
    "start": "1514120",
    "end": "1519830"
  },
  {
    "text": "comfortable with so we have magical clusters we don't really know how they work it also does make it easy to break",
    "start": "1519830",
    "end": "1526040"
  },
  {
    "text": "because it does so much magic under the hood if you go in and you start messing with a control plane afterwards",
    "start": "1526040",
    "end": "1533120"
  },
  {
    "text": "it can be it can I don't want use the word brittle it's just you just really have to know what you're doing",
    "start": "1533120",
    "end": "1538280"
  },
  {
    "text": "to not break it which I've never done I haven't hosed kubernetes clusters at all I've hosted plenty so anyways so",
    "start": "1538280",
    "end": "1546610"
  },
  {
    "start": "1546000",
    "end": "1546000"
  },
  {
    "text": "resetting cluster states so one one big concern we had was you know what if we push something out we don't you know",
    "start": "1546610",
    "end": "1554030"
  },
  {
    "text": "there isn't a hyper-v there's nothing that we have access to that if we really mess the stuff up you know we don't want",
    "start": "1554030",
    "end": "1561620"
  },
  {
    "text": "to hose millions of dollars with hardware and so we settled on something",
    "start": "1561620",
    "end": "1566920"
  },
  {
    "text": "that would allow us to reset cluster state using overlay FS I'm sure you're probably you guys are familiar overlay",
    "start": "1566920",
    "end": "1573170"
  },
  {
    "text": "FS but if you're not you essentially every change on the box within the on",
    "start": "1573170",
    "end": "1579260"
  },
  {
    "text": "the hard drive every change gets added as a file addition much like get kind of the concept with version control and if",
    "start": "1579260",
    "end": "1586130"
  },
  {
    "text": "something happens when the Box boots up the first thing it does is it reaches out to us and it says hey I'm online",
    "start": "1586130",
    "end": "1592270"
  },
  {
    "text": "should I wipe myself or should I proceed and our service will say nope you're",
    "start": "1592270",
    "end": "1598980"
  },
  {
    "text": "good proceed and it'll continue but if we have a problem if we royally messed",
    "start": "1598980",
    "end": "1604049"
  },
  {
    "text": "up a cluster or a particular box we can send it a reboot command and then we could tell it it needs to wipe itself",
    "start": "1604049",
    "end": "1610080"
  },
  {
    "text": "and it will actually reset itself to the original state that it arrived in any",
    "start": "1610080",
    "end": "1615299"
  },
  {
    "text": "given number of months ago so it's our way to safely insulate ourselves from",
    "start": "1615299",
    "end": "1621990"
  },
  {
    "text": "bricking you know 6000 devices that we don't have access to hooves up so this",
    "start": "1621990",
    "end": "1629130"
  },
  {
    "start": "1628000",
    "end": "1628000"
  },
  {
    "text": "is uh is what we open-source last night it's a dead simple script but it solves a big problem that we had and as I",
    "start": "1629130",
    "end": "1636419"
  },
  {
    "text": "described we need to be able to touch these devices we can't ss8 your tunnel to them so aww SSO Sims simple Systems",
    "start": "1636419",
    "end": "1644910"
  },
  {
    "text": "Manager is a agent that's installed on the Box poles AWS and waits for any",
    "start": "1644910",
    "end": "1651900"
  },
  {
    "text": "commands that we've fed AWS the problem is this is all unattended right so I'm",
    "start": "1651900",
    "end": "1658500"
  },
  {
    "text": "not on site making sure that these things are set up properly so we wrote",
    "start": "1658500",
    "end": "1664440"
  },
  {
    "text": "this little script this heads-up scripts it's a little ansible script you can point it at a bare-metal device it will",
    "start": "1664440",
    "end": "1669870"
  },
  {
    "text": "install SSM the only thing you have to really supply it as your own AWS credentials and in there we lay out what",
    "start": "1669870",
    "end": "1676350"
  },
  {
    "text": "credentials you need to supply it in order to be secure but also while the devices can enroll themselves and then",
    "start": "1676350",
    "end": "1681929"
  },
  {
    "text": "it also installs a cron job and the cron job will check the device and if it's",
    "start": "1681929",
    "end": "1686940"
  },
  {
    "text": "not currently enrolled and functional in your AWS account it will then use your",
    "start": "1686940",
    "end": "1693059"
  },
  {
    "text": "AWS credentials to enroll itself into that account and the nice thing about those credentials too is if somebody",
    "start": "1693059",
    "end": "1698100"
  },
  {
    "text": "swipes them all they can do is add more devices to your account which that's not",
    "start": "1698100",
    "end": "1703380"
  },
  {
    "text": "really damaging it also so anyways we open-source that check it out let's see",
    "start": "1703380",
    "end": "1713240"
  },
  {
    "text": "there we go so these are some lessons learned from an SRE I'm gonna jump down to the",
    "start": "1713870",
    "end": "1720330"
  },
  {
    "start": "1715000",
    "end": "1715000"
  },
  {
    "text": "picture because I love the picture always always always go with MVP so this",
    "start": "1720330",
    "end": "1727830"
  },
  {
    "text": "was a very a difficult very large-scale problem and there was a lot of different ways we",
    "start": "1727830",
    "end": "1733679"
  },
  {
    "text": "could have solved it but the emphasis instead was what is the absolute minimum",
    "start": "1733679",
    "end": "1740579"
  },
  {
    "text": "we can slap on a box and get into a restaurant to just get it done",
    "start": "1740579",
    "end": "1746009"
  },
  {
    "text": "so I just want to emphasize we probably could have dragged this project out for years and still not gotten anywhere and",
    "start": "1746009",
    "end": "1752519"
  },
  {
    "text": "the funny thing about dragging projects out is by the time you're done ready to deliver there's a better solution that's already been developed that you now want",
    "start": "1752519",
    "end": "1758729"
  },
  {
    "text": "to switch to not that that happened with dr. swarm at all but I just want to",
    "start": "1758729",
    "end": "1764399"
  },
  {
    "text": "emphasize as an SRE get into production make it MVP swallow you where you go you",
    "start": "1764399",
    "end": "1770159"
  },
  {
    "text": "know just get get the job done even if it's not pretty the other thing I want emphasizes really really use kubernetes",
    "start": "1770159",
    "end": "1777539"
  },
  {
    "text": "features the team has put a lot of thought and a lot of effort around the world really into the kubernetes proper",
    "start": "1777539",
    "end": "1784709"
  },
  {
    "text": "as well as the repository of all the different tools that they have and I'm",
    "start": "1784709",
    "end": "1790499"
  },
  {
    "text": "telling you again not that this has ever happened to me because it has but if you",
    "start": "1790499",
    "end": "1797069"
  },
  {
    "text": "don't pay attention on what kubernetes is offering you're gonna go solve a problem and then find out a week into",
    "start": "1797069",
    "end": "1802169"
  },
  {
    "text": "you know working on that problem that there's a repository that's already out there that's already solved that problem for you so so trust that the kubernetes",
    "start": "1802169",
    "end": "1810329"
  },
  {
    "text": "team has thought through a lot of deployment issues and roll back issues and it's just it's unbelievable the tool",
    "start": "1810329",
    "end": "1816149"
  },
  {
    "text": "is but it's also very complex and a lot of this information spread out and not well documented yet so you're gonna have",
    "start": "1816149",
    "end": "1821819"
  },
  {
    "text": "to put the work into going out and getting to know these features but please use them don't try to do",
    "start": "1821819",
    "end": "1828119"
  },
  {
    "text": "kubernetes at scale thousands of clusters if you don't have really good logging you are just setting landmines",
    "start": "1828119",
    "end": "1834989"
  },
  {
    "text": "threw yourself down the road because when everything blows up and it will hunting around amongst many many boxes",
    "start": "1834989",
    "end": "1840929"
  },
  {
    "text": "and control planes it's just a terrible idea I'm sure a lot of you guys are already",
    "start": "1840929",
    "end": "1846959"
  },
  {
    "text": "sold on unit testing that's just a de facto standard but I want to introduce health checking within kubernetes this",
    "start": "1846959",
    "end": "1854009"
  },
  {
    "text": "is as an SRE this is kind of the new form of unit testing in my opinion right",
    "start": "1854009",
    "end": "1859799"
  },
  {
    "text": "health checks that Nettie's relies on that are deep that",
    "start": "1859799",
    "end": "1865590"
  },
  {
    "text": "are generating real calls through your code that are reliable that are going to",
    "start": "1865590",
    "end": "1871110"
  },
  {
    "text": "catch as many things and your micro service application as high up the stack as you can because kubernetes magic is",
    "start": "1871110",
    "end": "1878000"
  },
  {
    "text": "really based on knowing the current state of your application and if you",
    "start": "1878000",
    "end": "1883770"
  },
  {
    "text": "don't write good health checks your app could be down and it's not telling kubernetes if it's down so really take",
    "start": "1883770",
    "end": "1890940"
  },
  {
    "text": "health checks seriously and kubernetes they call it health easy I just can't emphasize that enough",
    "start": "1890940",
    "end": "1896160"
  },
  {
    "text": "because when an outage occurs and it becomes lengthy 99% of the time it could",
    "start": "1896160",
    "end": "1903300"
  },
  {
    "text": "have been prevented with a better health check and also the way that kubernetes works give everything metrics so give",
    "start": "1903300",
    "end": "1911010"
  },
  {
    "text": "your apps metrics that again as an SRE I can pull your metrics now and I can do",
    "start": "1911010",
    "end": "1916380"
  },
  {
    "text": "things to help your applications stay online don't don't just blow by the",
    "start": "1916380",
    "end": "1922230"
  },
  {
    "text": "health checking of the metrics because it will make your life a lot easier you'll sleep more you will you will read",
    "start": "1922230",
    "end": "1928950"
  },
  {
    "text": "about the outage in the morning and how it healed itself more if you do these things and I think that's it all right",
    "start": "1928950",
    "end": "1937980"
  },
  {
    "start": "1935000",
    "end": "1935000"
  },
  {
    "text": "thanks Caleb thank you everybody so to re-emphasize what's really unique to us",
    "start": "1937980",
    "end": "1943560"
  },
  {
    "text": "I think is many people have kubernetes clusters but a lot of times they maybe have one or two and they're running you",
    "start": "1943560",
    "end": "1949890"
  },
  {
    "text": "know tens hundreds thousands hundreds of thousands of containers our scale is very unique and that we have lots and",
    "start": "1949890",
    "end": "1955470"
  },
  {
    "text": "lots of questions that have tens of containers that run on them so it creates an interesting challenge in the",
    "start": "1955470",
    "end": "1960960"
  },
  {
    "text": "area of thinking about how do you do deployments so let's say a little bit more about that obviously just told you",
    "start": "1960960",
    "end": "1967050"
  },
  {
    "text": "we have six thousand nodes two thousand cholesterol out of targets that comes",
    "start": "1967050",
    "end": "1973140"
  },
  {
    "text": "with its own challenges connectivity being up or down at any given time to those all kinds of things because of the",
    "start": "1973140",
    "end": "1978690"
  },
  {
    "text": "number that becomes a very interesting challenge to solve we also have what I would describe as complex success or",
    "start": "1978690",
    "end": "1985770"
  },
  {
    "text": "fail criteria so to explain what I mean by that if I have a deployment that I want to target a thousand clusters with",
    "start": "1985770",
    "end": "1991679"
  },
  {
    "text": "and 900 of them succeed one fail was that a success is that a fail",
    "start": "1991679",
    "end": "1998040"
  },
  {
    "text": "and everybody rolls back is that a manual one off find a solution for those hundred do they somehow automatically",
    "start": "1998040",
    "end": "2004160"
  },
  {
    "text": "sell field that somebody get involved it's not an easy problem space when you think about targeting that many different environments and having to be",
    "start": "2004160",
    "end": "2010160"
  },
  {
    "text": "able to to do that in the fashion we want where we want to continually deliver things to production to have an",
    "start": "2010160",
    "end": "2015260"
  },
  {
    "text": "impact as quick as possible and then to make it further even more complicated",
    "start": "2015260",
    "end": "2020300"
  },
  {
    "text": "we have an array of different types of applications so we have micro services that are rest oriented but we also have",
    "start": "2020300",
    "end": "2025970"
  },
  {
    "text": "things that use web sockets or MQTT which are persistent connections what",
    "start": "2025970",
    "end": "2031340"
  },
  {
    "text": "that means is it's not easy to just say bring up a new one sometimes you have think about connection draining and",
    "start": "2031340",
    "end": "2036380"
  },
  {
    "text": "managing different things like that they add some complexity so how do we think",
    "start": "2036380",
    "end": "2041810"
  },
  {
    "text": "about this problem we considered a couple things and we've said MVP a thousand times the simplest thing that",
    "start": "2041810",
    "end": "2048169"
  },
  {
    "text": "we thought about starting with was just saying we already have some messaging channels that we can use for restaurants sqs an AWS MQTT which we use extensively",
    "start": "2048169",
    "end": "2057310"
  },
  {
    "text": "we could just send a message down to the restaurant and have it apply it really simple report back some status that",
    "start": "2057310",
    "end": "2064129"
  },
  {
    "text": "would totally work my water sorry",
    "start": "2064130",
    "end": "2070389"
  },
  {
    "text": "so we could have done that we also thought using cube control you know kubernetes native great tool really",
    "start": "2073020",
    "end": "2080070"
  },
  {
    "text": "powerful constantly being you know iterated on does a lot of great stuff challenge with that is what we explained",
    "start": "2080070",
    "end": "2086010"
  },
  {
    "text": "before we didn't we don't want to have and we don't have a channel to go directly from our control plane into our",
    "start": "2086010",
    "end": "2091470"
  },
  {
    "text": "restaurants and naturally if you have a lot of cases where you're doing that you do have a point where if somebody compromises that one spot they may have",
    "start": "2091470",
    "end": "2098190"
  },
  {
    "text": "the ability to compromise your entire infrastructure fairly easily so there's just some risks around that that make",
    "start": "2098190",
    "end": "2103590"
  },
  {
    "text": "that challenging and then we actually went down the road a good bit with helm and we like him the templating feature",
    "start": "2103590",
    "end": "2109680"
  },
  {
    "text": "of home is pretty cool if you haven't used home before it's kind of a deployment and packaging manager and the",
    "start": "2109680",
    "end": "2114810"
  },
  {
    "text": "templating piece is basically a way to stub out for different environments what values you want to template in and you",
    "start": "2114810",
    "end": "2120480"
  },
  {
    "text": "give it some files say you know make make the kubernetes deployment file the deployment yeah mole the ingress camel",
    "start": "2120480",
    "end": "2126210"
  },
  {
    "text": "the service II and will make them look this way so we liked him but helm again requires direct access to the cluster",
    "start": "2126210",
    "end": "2132210"
  },
  {
    "text": "and also what we like the templating there's some things in there as well around the way it does deploys that make",
    "start": "2132210",
    "end": "2138810"
  },
  {
    "text": "some of the more sophisticated things like a canary deployment or a blue-green deployment pretty challenging so we",
    "start": "2138810",
    "end": "2145050"
  },
  {
    "text": "decided not to do any of these things and instead we run button we created",
    "start": "2145050",
    "end": "2150600"
  },
  {
    "start": "2149000",
    "end": "2149000"
  },
  {
    "text": "fleet so I want to tell you what the design goals were for fleet and what we did and I'm gonna do a quick walkthrough",
    "start": "2150600",
    "end": "2155700"
  },
  {
    "text": "just to explain how it works it's super simple but I think pretty cool also so we want something simple",
    "start": "2155700",
    "end": "2161100"
  },
  {
    "text": "and really easy for developers to use and we want to be able to do self-service on that as well for the",
    "start": "2161100",
    "end": "2166290"
  },
  {
    "text": "other teams that use our platform totally wanted to be declarative in approach so no imperative you know",
    "start": "2166290",
    "end": "2174030"
  },
  {
    "text": "making the the state of a cluster change on the fly we really wanted everything infrastructure as code effectively but",
    "start": "2174030",
    "end": "2180060"
  },
  {
    "text": "not just at the application level also really being able to go back and look at a given restaurant and be able to see",
    "start": "2180060",
    "end": "2186180"
  },
  {
    "text": "what should this restaurant actually look like right now what's the to be or the desired State compare that to what",
    "start": "2186180",
    "end": "2191670"
  },
  {
    "text": "the actual state is and be able to find differences where we've had drift or where something looked like it was successful and it wasn't and things like",
    "start": "2191670",
    "end": "2197790"
  },
  {
    "text": "that so we definitely want to be declarative in nature I mentioned different kinds of deployment models just a second ago we want to be able to",
    "start": "2197790",
    "end": "2204210"
  },
  {
    "text": "do that and give flexibility to our teams thank you guys I appreciate it we wanted",
    "start": "2204210",
    "end": "2210150"
  },
  {
    "text": "have the ability to roll out over a really flexible time period right so in a restaurant where certain functions are",
    "start": "2210150",
    "end": "2216270"
  },
  {
    "text": "business critical for us they might actually impact taking orders those changes may roll out with some teams to all restaurants over you know a day or a",
    "start": "2216270",
    "end": "2223410"
  },
  {
    "text": "week or a month or maybe multiple months and so we wanted to be able support that and not dictate how people actually",
    "start": "2223410",
    "end": "2228810"
  },
  {
    "text": "rolled out their apps and put that choice in the hands of the team we want to say standard kubernetes as much as",
    "start": "2228810",
    "end": "2233970"
  },
  {
    "text": "possible and then of course we wanted full visibility into this whole pipeline and everything that it did so we created",
    "start": "2233970",
    "end": "2240450"
  },
  {
    "start": "2239000",
    "end": "2239000"
  },
  {
    "text": "fleet fleet has these components this is pretty simple there's a client there can",
    "start": "2240450",
    "end": "2245490"
  },
  {
    "text": "be many clients there's a REST API and a CLI as well so you can you know get",
    "start": "2245490",
    "end": "2250620"
  },
  {
    "text": "webhook kit or whatever you want to interact with it from your own team's deployment you know and build process",
    "start": "2250620",
    "end": "2256910"
  },
  {
    "text": "there's of course an API and what we do there's basically code gin very much like what helm does with templating we",
    "start": "2256910",
    "end": "2262290"
  },
  {
    "text": "code Jen some stuff we put some unique chick-fil-a things into the containers and we build these files that you know",
    "start": "2262290",
    "end": "2269730"
  },
  {
    "text": "cube control uses to make deployments happen so the ingress that um will the service that you know when the",
    "start": "2269730",
    "end": "2274770"
  },
  {
    "text": "deployment diamo files fleet server also manages a git repository which we call",
    "start": "2274770",
    "end": "2280620"
  },
  {
    "text": "the Atlas we'll hit that in just a second and then it also is the place where API calls come back to track",
    "start": "2280620",
    "end": "2286050"
  },
  {
    "text": "status of deployments so Atlas is really a get instance with a repository for",
    "start": "2286050",
    "end": "2292350"
  },
  {
    "text": "every single one of our clusters and that's in any environment so we can at any given time looking at get C to be",
    "start": "2292350",
    "end": "2298200"
  },
  {
    "text": "state of every single cluster we have in all of our environments and essentially what you have inside of that is you have",
    "start": "2298200",
    "end": "2303930"
  },
  {
    "text": "a folder per application and you have these files that were generated inside of there and in some metadata that we",
    "start": "2303930",
    "end": "2309060"
  },
  {
    "text": "tagged on to make it easy to track them through their life cycle so how does this all actually get into a restaurant",
    "start": "2309060",
    "end": "2314880"
  },
  {
    "text": "this is all control plain side stuff we have a tool called vessel that we built and then we found that kubernetes",
    "start": "2314880",
    "end": "2320400"
  },
  {
    "text": "actually had solved this problem so we'll probably change to that later but for now we're using vessel and vessel is",
    "start": "2320400",
    "end": "2326130"
  },
  {
    "text": "a piece that actually lives in the restaurant kubernetes cluster the target and it basically does a get pull a cube",
    "start": "2326130",
    "end": "2332490"
  },
  {
    "text": "control apply check the status of the pod and see what happen and then report back super super simple but also very",
    "start": "2332490",
    "end": "2338760"
  },
  {
    "text": "effective and then of course there's dashboards on top of this so people can reason about what's going on so a quick walkthrough I",
    "start": "2338760",
    "end": "2345750"
  },
  {
    "start": "2345000",
    "end": "2345000"
  },
  {
    "text": "told you there's templates if you've seen helm you you probably think you're looking at helm this is really really",
    "start": "2345750",
    "end": "2351030"
  },
  {
    "text": "easy and this is a simple example where we basically can template out some different fields that a team wants to",
    "start": "2351030",
    "end": "2357570"
  },
  {
    "text": "take control of for their specific application you can't see ports on here I don't think but you can have one too many ports you can put in secrets and",
    "start": "2357570",
    "end": "2365100"
  },
  {
    "text": "things of that nature then we've got the Atlas it literally is this is just a",
    "start": "2365100",
    "end": "2370350"
  },
  {
    "text": "demo environment but we've literally got three clusters here and if we drilled into this we'd be able to see the state",
    "start": "2370350",
    "end": "2375600"
  },
  {
    "text": "of all of them see the applications in there and see those files I talked about and then what you would do in a simple",
    "start": "2375600",
    "end": "2381480"
  },
  {
    "start": "2379000",
    "end": "2379000"
  },
  {
    "text": "form is if you wanted to do a deployment for this app called auth server edge 3 and you wanted to make it have 4",
    "start": "2381480",
    "end": "2386520"
  },
  {
    "text": "replicas and it's gonna pull this docker image that isn't real so people don't watch this and then mess with our Ducker",
    "start": "2386520",
    "end": "2391860"
  },
  {
    "text": "registry it's gonna pull that image down and here we've targeted two clusters which are two of our labs in our request",
    "start": "2391860",
    "end": "2399270"
  },
  {
    "text": "so what that's going to do is template out some of the files I just put deployment in here so you can",
    "start": "2399270",
    "end": "2405330"
  },
  {
    "text": "see but actually ran through this example offline so we didn't have demo issues and you can see here it's auth",
    "start": "2405330",
    "end": "2410730"
  },
  {
    "text": "server you know edge it's got four replicas etc so we've kind of created coach end and",
    "start": "2410730",
    "end": "2416370"
  },
  {
    "text": "we of course of course have our you know generate generated by fleet yarr that's in there you got to have that so",
    "start": "2416370",
    "end": "2422270"
  },
  {
    "text": "definitely and then so what you get is I told you it manages the Atlas so inside",
    "start": "2422270",
    "end": "2428700"
  },
  {
    "text": "of the Atlas you would actually be able to go and see exactly what changed in this particular iteration of somebody",
    "start": "2428700",
    "end": "2434670"
  },
  {
    "text": "requesting a deploy so they sent that JSON object in we did some cogent we read it to the git repository for the",
    "start": "2434670",
    "end": "2440220"
  },
  {
    "text": "restaurant and we can actually go see the change from three replicas to four and we actually have this deployment hash that gets updated so you can see",
    "start": "2440220",
    "end": "2446610"
  },
  {
    "text": "exactly you know tracing back this was over 100 clusters what happened over that whole 100 cluster deployment this",
    "start": "2446610",
    "end": "2452370"
  },
  {
    "text": "is your unique identifier for that what happened in the actual restaurant the get hash at the head of the branch",
    "start": "2452370",
    "end": "2459060"
  },
  {
    "text": "that's actually our indicator for you know that iteration the actual at restaurant level deployment I'll show",
    "start": "2459060",
    "end": "2465240"
  },
  {
    "text": "you what that looks like here in this case we used dynamo will probably change this eventually but right now it works",
    "start": "2465240",
    "end": "2471120"
  },
  {
    "text": "for us and we just have a dynamo table where we keep records as you can see that deploy hash we generated the get hash from the",
    "start": "2471120",
    "end": "2477030"
  },
  {
    "text": "restaurant it targeted these two clusters and then the status of that one's pending another one had a status",
    "start": "2477030",
    "end": "2482940"
  },
  {
    "text": "of crash loot back off but a super easy way to capture some data and there's some more fields off to the right but capture data and metadata about",
    "start": "2482940",
    "end": "2488850"
  },
  {
    "text": "deployments and be able to have a real clear picture of what happened and again I think one of the most important things",
    "start": "2488850",
    "end": "2493980"
  },
  {
    "text": "here is that this is not a super sophisticated solution and it's almost like it almost feels weird in a sense",
    "start": "2493980",
    "end": "2500220"
  },
  {
    "text": "going to a conference and talking about hey we use git but I think that's really cool that we can take advantage of tools",
    "start": "2500220",
    "end": "2505650"
  },
  {
    "text": "that are already out there that are really powerful wrap some stuff around them that fits our use case and be able to deliver things that have an impact",
    "start": "2505650",
    "end": "2511590"
  },
  {
    "text": "really quickly so there's a lot of great advantages to this there's some you know definitely some downsides but we we",
    "start": "2511590",
    "end": "2517350"
  },
  {
    "text": "think this is a solution we're gonna stick with for quite a while and we're probably gonna drop it out as an open source thing just even though it's",
    "start": "2517350",
    "end": "2522570"
  },
  {
    "text": "simple just for people to look at and you know get their minds thinking about how deployments to lots of clusters ultimately work so with that I want to",
    "start": "2522570",
    "end": "2531150"
  },
  {
    "start": "2531000",
    "end": "2531000"
  },
  {
    "text": "mention where you can find us so Brian and Caleb we're on LinkedIn and Twitter we'd love for you to reach out to us and",
    "start": "2531150",
    "end": "2537690"
  },
  {
    "text": "connect if you want to chick-fil-a is also in medium and there's a blog post that we put up I think a day ago that",
    "start": "2537690",
    "end": "2543840"
  },
  {
    "text": "talks a lot more about what we do with bare-metal clustering so love for you to check that out and follow us if you like what you see and then we're also in",
    "start": "2543840",
    "end": "2549810"
  },
  {
    "text": "github at chick-fil-a chick-fil-a and I would love for you to check out the projects we have there and finally I",
    "start": "2549810",
    "end": "2555420"
  },
  {
    "text": "mentioned there's gopher logos everywhere because we're big go advocates when it comes to the applications we build so lots of Gophers",
    "start": "2555420",
    "end": "2561510"
  },
  {
    "text": "in our open source projects that'll be out there but like to have fun with those as we go so with that we really",
    "start": "2561510",
    "end": "2567030"
  },
  {
    "text": "appreciate you guys taking the time to come and listen to us and we'd love to answer some questions so Andrew I think",
    "start": "2567030",
    "end": "2573300"
  },
  {
    "text": "we're going to turn it over to you for that [Applause]",
    "start": "2573300",
    "end": "2580369"
  },
  {
    "text": "so there is a microphone come up here and ask questions we probably have about 10 more minutes since we started about 5",
    "start": "2580369",
    "end": "2586349"
  },
  {
    "text": "minutes late so yeah I was curious why you guys settled on the ark on the",
    "start": "2586349",
    "end": "2592680"
  },
  {
    "text": "architecture the way you described it for example another option that comes to mind is could you have your clusters in",
    "start": "2592680",
    "end": "2599310"
  },
  {
    "text": "the cloud and this and the stores would be talking those clusters when you could",
    "start": "2599310",
    "end": "2604410"
  },
  {
    "text": "have namespaces where you know for your restaurants why you didn't go with that",
    "start": "2604410",
    "end": "2611040"
  },
  {
    "text": "option okay yeah great question thank you so just reiterate question is basically why I actually put computing in the",
    "start": "2611040",
    "end": "2617220"
  },
  {
    "text": "restaurant at the edge why not do something with a crew Bernays cluster in the cloud where you separate things by namespace or something along those lines",
    "start": "2617220",
    "end": "2622890"
  },
  {
    "text": "so definitely if we could have done everything that we needed to do from a business perspective and just use the",
    "start": "2622890",
    "end": "2628140"
  },
  {
    "text": "cloud we totally would have done that because it would be way simpler there'd be way fewer problems to solve it really",
    "start": "2628140",
    "end": "2633420"
  },
  {
    "text": "comes back to that idea that we want to be able to build things on top of this platform at the edge that are critical",
    "start": "2633420",
    "end": "2638430"
  },
  {
    "text": "to running our business which could really mean you're driving food production and automating some of those",
    "start": "2638430",
    "end": "2643920"
  },
  {
    "text": "cooking processes and things like that and we have a lot of things where there's a lot of data moving around very rapidly and we don't feel like we have",
    "start": "2643920",
    "end": "2650160"
  },
  {
    "text": "the network connection quality in two thousand restaurants a lot of them are malls with you know a mall provided",
    "start": "2650160",
    "end": "2656520"
  },
  {
    "text": "internet connection and in a lot of them are can be rural areas where you're not gonna get fiber so we actually wanted to make sure that",
    "start": "2656520",
    "end": "2662730"
  },
  {
    "text": "we could run the business without depending on something outside of the restaurant so putting the cluster at the edge was the reason for doing that yeah",
    "start": "2662730",
    "end": "2671849"
  },
  {
    "text": "and it gets it gets it's a good question so question was just data actually get persisted there it does but it's always",
    "start": "2671849",
    "end": "2677940"
  },
  {
    "text": "it's it's really transient at the actual restaurant level and there's a continual address of that out to our cloud control",
    "start": "2677940",
    "end": "2685170"
  },
  {
    "text": "plane we have data Lake strategy and things like that so we take all the data that we collect and we send it over there but to his to your question on his",
    "start": "2685170",
    "end": "2691619"
  },
  {
    "text": "point some of these restaurants they have network bandwidth that are so",
    "start": "2691619",
    "end": "2697080"
  },
  {
    "text": "challenging we may actually need to persist it there for an entire day and wait and stream it up to denied yeah so",
    "start": "2697080",
    "end": "2702830"
  },
  {
    "text": "so yeah so I'm still trying to talk him into just put it all on the cloud and it",
    "start": "2702830",
    "end": "2708869"
  },
  {
    "text": "would make my life a lot easier but it just it's it's there's too many drawbacks at the end of the day Internet should be able",
    "start": "2708869",
    "end": "2716220"
  },
  {
    "text": "to go down and as a customer chick-fil-a you shouldn't even know yeah you know your credit card transactions are",
    "start": "2716220",
    "end": "2721470"
  },
  {
    "text": "getting queued up all the other magic that's happening with a point-of-sale system is all occurring the only thing",
    "start": "2721470",
    "end": "2727140"
  },
  {
    "text": "that we can't solve for right is mobile orders because that needs to come in through a connection but but yeah the",
    "start": "2727140",
    "end": "2733080"
  },
  {
    "text": "point is is that we we want zero downtime not zero as unnecessary as",
    "start": "2733080",
    "end": "2738480"
  },
  {
    "text": "little as possible right well thanks for the question great question so touching on something",
    "start": "2738480",
    "end": "2744690"
  },
  {
    "text": "you just mentioned answering his question is given your point-of-sale",
    "start": "2744690",
    "end": "2750270"
  },
  {
    "text": "infrastructure mm-hmm transaction processing etc how much of that runs directly through this and what um what",
    "start": "2750270",
    "end": "2757560"
  },
  {
    "text": "challenges did you face getting that handling PCI compliance handling",
    "start": "2757560",
    "end": "2762589"
  },
  {
    "text": "transactional infrastructure and actually touching the money on these on these edge systems it's a good question",
    "start": "2762589",
    "end": "2768540"
  },
  {
    "text": "so today we actually send all of the data from our point of sale from like a button press so somebody rings in a",
    "start": "2768540",
    "end": "2775080"
  },
  {
    "text": "chick-fil-a sandwich as soon as that button is pressed that generates a message that comes through this infrastructure we don't run any payment",
    "start": "2775080",
    "end": "2780240"
  },
  {
    "text": "through this we're actually not in PCI scope at all in our infrastructure and in this case and we do things like into an encryption",
    "start": "2780240",
    "end": "2787200"
  },
  {
    "text": "as well so encryption it swipe so the credit card number in a restaurant is never in the clear ever so we do some",
    "start": "2787200",
    "end": "2793740"
  },
  {
    "text": "things like that but we will over time really in a restaurant like chick-fil-a you have registers on the counter where",
    "start": "2793740",
    "end": "2799830"
  },
  {
    "text": "people are ringing in orders and then the traffic from that ultimately makes its way to screens where people are bagging your food and back in the back",
    "start": "2799830",
    "end": "2805589"
  },
  {
    "text": "where they're preparing things and that drives actual production so having outages on what to make actually is",
    "start": "2805589",
    "end": "2811109"
  },
  {
    "text": "really impactful you know just as much as you know internet down and so we can't process credit in real time that's",
    "start": "2811109",
    "end": "2816990"
  },
  {
    "text": "really the critical things we have is being able to ring in orders be able to take payment be able to produce the food without people having to yell back",
    "start": "2816990",
    "end": "2822869"
  },
  {
    "text": "everything that's going on so we do have that second workload that's in the process of moving onto this platform",
    "start": "2822869",
    "end": "2827940"
  },
  {
    "text": "where it's publishing out messages and that's actually driving the behavior of all the screens smarter screens basically for our team members to help",
    "start": "2827940",
    "end": "2835080"
  },
  {
    "text": "them know what to prepare over time we'll have to tackle some of those problems though so as you convert or as",
    "start": "2835080",
    "end": "2840270"
  },
  {
    "text": "you'd think about moving payment processing infrastructure to this over time there any challenges are interesting like we actually do so correcting on",
    "start": "2840270",
    "end": "2847450"
  },
  {
    "text": "there yeah credit actually will not go through here so we don't have to worry about that it actually goes straight out to the internet it's on a separate VLAN and",
    "start": "2847450",
    "end": "2854560"
  },
  {
    "text": "things of that nature so it's not a problem that fortunately it's not a problem we have to solve in the in anytime in the near future was there",
    "start": "2854560",
    "end": "2862780"
  },
  {
    "text": "consideration for how much or how little a store operator needs to know about this is it meant to be completely",
    "start": "2862780",
    "end": "2868120"
  },
  {
    "text": "hands-off for them and how do they interact with it when things go wrong yeah great question we may take it again",
    "start": "2868120",
    "end": "2873160"
  },
  {
    "text": "sure okay so we really put a lot of thought into making sure that",
    "start": "2873160",
    "end": "2878410"
  },
  {
    "text": "so again complexity in the restaurant right so taking something and giving somebody who's already super busy leading a team of a hundred people who",
    "start": "2878410",
    "end": "2884890"
  },
  {
    "text": "are trying to serve hundreds of thousands of customers in a month and saying hey here's another thing for you to know and that you need to know about",
    "start": "2884890",
    "end": "2890560"
  },
  {
    "text": "and you need to touch not good we didn't want to do that that adds more complexity it doesn't simplify so while",
    "start": "2890560",
    "end": "2896410"
  },
  {
    "text": "we do communicate the fact that these these boxes in the restaurant exist and they can physically see them the only",
    "start": "2896410",
    "end": "2901690"
  },
  {
    "text": "thing that we ever asked them to do the owner/operator to do is if they get a replacement for a failed device to open",
    "start": "2901690",
    "end": "2908560"
  },
  {
    "text": "it and unbox it follow the instructions which are swapping cables and it'll boot itself back up and return to service and",
    "start": "2908560",
    "end": "2914170"
  },
  {
    "text": "then if for some reason that doesn't happen and they leave it sitting there because they're busy our helpdesk will will initiate a ticket with our help",
    "start": "2914170",
    "end": "2919660"
  },
  {
    "text": "desk to have them call and walk the operator through it after about 48 hours so that we can make sure we have three nodes so we can keep running it's not",
    "start": "2919660",
    "end": "2926590"
  },
  {
    "text": "critical but it should another one fail or a switch fail that we're dependent on our network architecture is resilient as",
    "start": "2926590",
    "end": "2933160"
  },
  {
    "text": "well and so each node is on a different switch you know such that we don't have any single points of failure overall in",
    "start": "2933160",
    "end": "2938770"
  },
  {
    "text": "the architecture but if something else weird happens we could get to a point where we have one node left which can",
    "start": "2938770",
    "end": "2943930"
  },
  {
    "text": "create some weird split brain problems in the restaurant and also it could be not enough capacity to run the things we",
    "start": "2943930",
    "end": "2950050"
  },
  {
    "text": "need to run great question any others okay well Caleb and I will I",
    "start": "2950050",
    "end": "2958480"
  },
  {
    "text": "know there'll be another session coming we'll go hang it outside verse coming up and talking in the front in case anybody wants a chat and we'd be happy to talk",
    "start": "2958480",
    "end": "2964510"
  },
  {
    "text": "with you so thank you guys again appreciate your time [Applause]",
    "start": "2964510",
    "end": "2970060"
  }
]