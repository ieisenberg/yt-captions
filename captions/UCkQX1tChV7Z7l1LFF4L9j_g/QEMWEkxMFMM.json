[
  {
    "text": "[Music]",
    "start": "3360",
    "end": "6550"
  },
  {
    "text": "hello",
    "start": "9760",
    "end": "10559"
  },
  {
    "text": "i'm susie from netflix performance",
    "start": "10559",
    "end": "12559"
  },
  {
    "text": "engineering team",
    "start": "12559",
    "end": "14960"
  },
  {
    "text": "netflix is one of the biggest media",
    "start": "14960",
    "end": "17199"
  },
  {
    "text": "content provider",
    "start": "17199",
    "end": "18720"
  },
  {
    "text": "and i hope you have some favorite shows",
    "start": "18720",
    "end": "20720"
  },
  {
    "text": "from us",
    "start": "20720",
    "end": "22400"
  },
  {
    "text": "during the global pandemic where",
    "start": "22400",
    "end": "24480"
  },
  {
    "text": "everyone is staying at home",
    "start": "24480",
    "end": "26480"
  },
  {
    "text": "11 of global internet traffic is coming",
    "start": "26480",
    "end": "30000"
  },
  {
    "text": "from netflix every time when you hit",
    "start": "30000",
    "end": "33440"
  },
  {
    "text": "play button from netflix app",
    "start": "33440",
    "end": "35440"
  },
  {
    "text": "on your favorite show no matter is tiger",
    "start": "35440",
    "end": "37840"
  },
  {
    "text": "king stranger things",
    "start": "37840",
    "end": "39360"
  },
  {
    "text": "or black mirror you are contributing to",
    "start": "39360",
    "end": "42000"
  },
  {
    "text": "this",
    "start": "42000",
    "end": "43840"
  },
  {
    "text": "while enjoying a great variety of media",
    "start": "43840",
    "end": "46320"
  },
  {
    "text": "content from netflix",
    "start": "46320",
    "end": "47840"
  },
  {
    "text": "there is a hidden yet very important",
    "start": "47840",
    "end": "50559"
  },
  {
    "text": "system",
    "start": "50559",
    "end": "51199"
  },
  {
    "text": "running behind the scene to support a",
    "start": "51199",
    "end": "53280"
  },
  {
    "text": "pleasant streaming experience to you",
    "start": "53280",
    "end": "56320"
  },
  {
    "text": "this system is video encoding system",
    "start": "56320",
    "end": "60719"
  },
  {
    "text": "today that is what we're going to talk",
    "start": "60719",
    "end": "62879"
  },
  {
    "text": "about",
    "start": "62879",
    "end": "63840"
  },
  {
    "text": "and first i will give an overview of the",
    "start": "63840",
    "end": "66799"
  },
  {
    "text": "video encoding system",
    "start": "66799",
    "end": "69119"
  },
  {
    "text": "then i will share some of the technical",
    "start": "69119",
    "end": "71200"
  },
  {
    "text": "challenges we faced",
    "start": "71200",
    "end": "73200"
  },
  {
    "text": "most importantly i'm going to share",
    "start": "73200",
    "end": "75680"
  },
  {
    "text": "three techniques",
    "start": "75680",
    "end": "76799"
  },
  {
    "text": "that we applied to improve the system",
    "start": "76799",
    "end": "79040"
  },
  {
    "text": "efficiency",
    "start": "79040",
    "end": "80320"
  },
  {
    "text": "and hope that will be helpful for your",
    "start": "80320",
    "end": "82720"
  },
  {
    "text": "domain as well",
    "start": "82720",
    "end": "86320"
  },
  {
    "text": "first of all we need to understand that",
    "start": "86320",
    "end": "89280"
  },
  {
    "text": "video is big data",
    "start": "89280",
    "end": "91759"
  },
  {
    "text": "films are short in 4k or higher",
    "start": "91759",
    "end": "94880"
  },
  {
    "text": "for a full day of shot it will generate",
    "start": "94880",
    "end": "97439"
  },
  {
    "text": "2 to 8 terabytes of raw camera footage",
    "start": "97439",
    "end": "101280"
  },
  {
    "text": "imagine your favorite movie may be shot",
    "start": "101280",
    "end": "103759"
  },
  {
    "text": "in weeks",
    "start": "103759",
    "end": "104640"
  },
  {
    "text": "or months so this number could be even",
    "start": "104640",
    "end": "107439"
  },
  {
    "text": "higher",
    "start": "107439",
    "end": "109759"
  },
  {
    "text": "after editing when a film is ready",
    "start": "110079",
    "end": "113119"
  },
  {
    "text": "video source files are generated and",
    "start": "113119",
    "end": "115360"
  },
  {
    "text": "sent into netflix systems",
    "start": "115360",
    "end": "118079"
  },
  {
    "text": "normally video source files are big even",
    "start": "118079",
    "end": "121119"
  },
  {
    "text": "though not as big as the original",
    "start": "121119",
    "end": "123040"
  },
  {
    "text": "footage",
    "start": "123040",
    "end": "124320"
  },
  {
    "text": "for example for a one hour long episode",
    "start": "124320",
    "end": "127280"
  },
  {
    "text": "of crash landing on you",
    "start": "127280",
    "end": "129119"
  },
  {
    "text": "which is my favorite show during",
    "start": "129119",
    "end": "130720"
  },
  {
    "text": "pandemic the video source file",
    "start": "130720",
    "end": "133040"
  },
  {
    "text": "is almost 500 gigabytes it will take",
    "start": "133040",
    "end": "136720"
  },
  {
    "text": "over 10 hours for me to download",
    "start": "136720",
    "end": "139120"
  },
  {
    "text": "with my home wifi so",
    "start": "139120",
    "end": "142400"
  },
  {
    "text": "delivering several hundreds of gigabytes",
    "start": "142400",
    "end": "144720"
  },
  {
    "text": "of video to our customers",
    "start": "144720",
    "end": "146400"
  },
  {
    "text": "is not practical we need to condense the",
    "start": "146400",
    "end": "149680"
  },
  {
    "text": "content",
    "start": "149680",
    "end": "150400"
  },
  {
    "text": "so that our customers are streaming them",
    "start": "150400",
    "end": "152720"
  },
  {
    "text": "smoothly",
    "start": "152720",
    "end": "153599"
  },
  {
    "text": "under all sorts of conditions whether",
    "start": "153599",
    "end": "156959"
  },
  {
    "text": "they're watching",
    "start": "156959",
    "end": "158319"
  },
  {
    "text": "with a 4k hdr tv with the fastest",
    "start": "158319",
    "end": "161599"
  },
  {
    "text": "broadband or a mobile cell phone with",
    "start": "161599",
    "end": "164720"
  },
  {
    "text": "very choppy cellular network",
    "start": "164720",
    "end": "167680"
  },
  {
    "text": "this process of condensing video source",
    "start": "167680",
    "end": "170080"
  },
  {
    "text": "file is what we refer to as",
    "start": "170080",
    "end": "172720"
  },
  {
    "text": "video encoding video encoding is the",
    "start": "172720",
    "end": "176160"
  },
  {
    "text": "foundation",
    "start": "176160",
    "end": "176959"
  },
  {
    "text": "of a great streaming experience and",
    "start": "176959",
    "end": "179760"
  },
  {
    "text": "netflix",
    "start": "179760",
    "end": "180480"
  },
  {
    "text": "is committed to delivering the most",
    "start": "180480",
    "end": "182879"
  },
  {
    "text": "optimized picture quality",
    "start": "182879",
    "end": "184560"
  },
  {
    "text": "to all our customers on over a thousand",
    "start": "184560",
    "end": "187920"
  },
  {
    "text": "supported devices and video encoding",
    "start": "187920",
    "end": "191599"
  },
  {
    "text": "is one of the most important workloads",
    "start": "191599",
    "end": "194159"
  },
  {
    "text": "running at",
    "start": "194159",
    "end": "194959"
  },
  {
    "text": "netflix cloud infrastructure",
    "start": "194959",
    "end": "199599"
  },
  {
    "text": "let's zoom into what the video encoding",
    "start": "199599",
    "end": "202080"
  },
  {
    "text": "pipeline looks like",
    "start": "202080",
    "end": "203280"
  },
  {
    "text": "in a bit more details on the left hand",
    "start": "203280",
    "end": "206640"
  },
  {
    "text": "side we have a video source",
    "start": "206640",
    "end": "208560"
  },
  {
    "text": "again coming from a production studio",
    "start": "208560",
    "end": "211360"
  },
  {
    "text": "and",
    "start": "211360",
    "end": "211680"
  },
  {
    "text": "on the right hand side we have a 4k tv",
    "start": "211680",
    "end": "214879"
  },
  {
    "text": "on which we want to watch the show",
    "start": "214879",
    "end": "218560"
  },
  {
    "text": "when original content is first ingested",
    "start": "218560",
    "end": "221280"
  },
  {
    "text": "into our system",
    "start": "221280",
    "end": "222560"
  },
  {
    "text": "we run some quickly validations",
    "start": "222560",
    "end": "226159"
  },
  {
    "text": "and next the media content is broken up",
    "start": "226159",
    "end": "229360"
  },
  {
    "text": "into smaller chunks",
    "start": "229360",
    "end": "230799"
  },
  {
    "text": "each of the chunk is a portion of the",
    "start": "230799",
    "end": "232959"
  },
  {
    "text": "video usually about 30 seconds",
    "start": "232959",
    "end": "235680"
  },
  {
    "text": "to a couple of minutes in duration",
    "start": "235680",
    "end": "239040"
  },
  {
    "text": "now in a massively parallel way we",
    "start": "239040",
    "end": "242000"
  },
  {
    "text": "encode this video chunks independently",
    "start": "242000",
    "end": "244319"
  },
  {
    "text": "on our servers once",
    "start": "244319",
    "end": "247599"
  },
  {
    "text": "all the chunks finish the encoding",
    "start": "247599",
    "end": "249280"
  },
  {
    "text": "process they are reassembled to become a",
    "start": "249280",
    "end": "251840"
  },
  {
    "text": "single",
    "start": "251840",
    "end": "252560"
  },
  {
    "text": "encoded video asset this video file",
    "start": "252560",
    "end": "256079"
  },
  {
    "text": "is about 1000 times more smaller",
    "start": "256079",
    "end": "259359"
  },
  {
    "text": "compared to the original video source",
    "start": "259359",
    "end": "261199"
  },
  {
    "text": "file",
    "start": "261199",
    "end": "263120"
  },
  {
    "text": "then the drm protections will be added",
    "start": "263120",
    "end": "265520"
  },
  {
    "text": "to the video asset",
    "start": "265520",
    "end": "266800"
  },
  {
    "text": "and the package the stream is generated",
    "start": "266800",
    "end": "270800"
  },
  {
    "text": "the package the stream asset is",
    "start": "270800",
    "end": "272720"
  },
  {
    "text": "distributed to the cdns",
    "start": "272720",
    "end": "274960"
  },
  {
    "text": "around the world and is ready to be",
    "start": "274960",
    "end": "277600"
  },
  {
    "text": "streamed by customers",
    "start": "277600",
    "end": "280000"
  },
  {
    "text": "this simplified pipeline view shows what",
    "start": "280000",
    "end": "282639"
  },
  {
    "text": "it looks like",
    "start": "282639",
    "end": "283600"
  },
  {
    "text": "for one profile",
    "start": "283600",
    "end": "286560"
  },
  {
    "text": "in order to support thousands of",
    "start": "286880",
    "end": "289040"
  },
  {
    "text": "different devices",
    "start": "289040",
    "end": "290320"
  },
  {
    "text": "and provides optimized experience of",
    "start": "290320",
    "end": "292560"
  },
  {
    "text": "each of them",
    "start": "292560",
    "end": "293440"
  },
  {
    "text": "we need to run this process for",
    "start": "293440",
    "end": "295280"
  },
  {
    "text": "different video codecs",
    "start": "295280",
    "end": "296960"
  },
  {
    "text": "resolutions and bit rates so",
    "start": "296960",
    "end": "300400"
  },
  {
    "text": "in reality for a single title we do a",
    "start": "300400",
    "end": "303520"
  },
  {
    "text": "lot more work",
    "start": "303520",
    "end": "306319"
  },
  {
    "text": "in practice we have to do this for the",
    "start": "306560",
    "end": "308880"
  },
  {
    "text": "entire netflix",
    "start": "308880",
    "end": "310479"
  },
  {
    "text": "catalog which contains many many shows",
    "start": "310479",
    "end": "313919"
  },
  {
    "text": "and this becomes a massive parallel",
    "start": "313919",
    "end": "316160"
  },
  {
    "text": "computing problem",
    "start": "316160",
    "end": "317280"
  },
  {
    "text": "in the cloud which requires a lot of",
    "start": "317280",
    "end": "319759"
  },
  {
    "text": "capacity",
    "start": "319759",
    "end": "320639"
  },
  {
    "text": "with hundreds of thousands of cpus",
    "start": "320639",
    "end": "323199"
  },
  {
    "text": "running concurrently at peak",
    "start": "323199",
    "end": "326880"
  },
  {
    "text": "now that we know what the encoding",
    "start": "327039",
    "end": "328800"
  },
  {
    "text": "pipeline looks like",
    "start": "328800",
    "end": "330160"
  },
  {
    "text": "let's talk about some of the workload",
    "start": "330160",
    "end": "332080"
  },
  {
    "text": "characteristics",
    "start": "332080",
    "end": "334240"
  },
  {
    "text": "first their level work is bursty and",
    "start": "334240",
    "end": "336960"
  },
  {
    "text": "unpredictable",
    "start": "336960",
    "end": "338240"
  },
  {
    "text": "because the load is driven by our",
    "start": "338240",
    "end": "340080"
  },
  {
    "text": "partners or teams",
    "start": "340080",
    "end": "342160"
  },
  {
    "text": "for example we receive the entire season",
    "start": "342160",
    "end": "344800"
  },
  {
    "text": "of emily",
    "start": "344800",
    "end": "345520"
  },
  {
    "text": "in paris from the production studio and",
    "start": "345520",
    "end": "348160"
  },
  {
    "text": "we want to encode them",
    "start": "348160",
    "end": "349440"
  },
  {
    "text": "as quickly as possible as we mentioned",
    "start": "349440",
    "end": "352639"
  },
  {
    "text": "previously",
    "start": "352639",
    "end": "353520"
  },
  {
    "text": "most work can be decomposed into smaller",
    "start": "353520",
    "end": "355840"
  },
  {
    "text": "processing steps",
    "start": "355840",
    "end": "356960"
  },
  {
    "text": "that can be run in parallel the arrival",
    "start": "356960",
    "end": "360000"
  },
  {
    "text": "of",
    "start": "360000",
    "end": "360319"
  },
  {
    "text": "one 30 minutes episode can result in 250",
    "start": "360319",
    "end": "364240"
  },
  {
    "text": "000 work items third",
    "start": "364240",
    "end": "367919"
  },
  {
    "text": "media processing algorithms are cpu",
    "start": "367919",
    "end": "369919"
  },
  {
    "text": "intensive and can take hours or even",
    "start": "369919",
    "end": "372639"
  },
  {
    "text": "days",
    "start": "372639",
    "end": "373360"
  },
  {
    "text": "for just a small segment of video",
    "start": "373360",
    "end": "377199"
  },
  {
    "text": "and it also requires a lot of memory",
    "start": "377199",
    "end": "379360"
  },
  {
    "text": "disk on l",
    "start": "379360",
    "end": "381440"
  },
  {
    "text": "lastly every now and then we have to",
    "start": "381440",
    "end": "383919"
  },
  {
    "text": "generate encodes for",
    "start": "383919",
    "end": "385280"
  },
  {
    "text": "portion or sometimes even the entire",
    "start": "385280",
    "end": "387520"
  },
  {
    "text": "catalog",
    "start": "387520",
    "end": "388479"
  },
  {
    "text": "so that we can take advantage of the",
    "start": "388479",
    "end": "390479"
  },
  {
    "text": "latest codec",
    "start": "390479",
    "end": "391680"
  },
  {
    "text": "and optimizations and this process may",
    "start": "391680",
    "end": "394639"
  },
  {
    "text": "take",
    "start": "394639",
    "end": "395120"
  },
  {
    "text": "months to complete",
    "start": "395120",
    "end": "398479"
  },
  {
    "text": "so when we analyze a system like this",
    "start": "400560",
    "end": "403039"
  },
  {
    "text": "there were two dimensions that we need",
    "start": "403039",
    "end": "404639"
  },
  {
    "text": "to keep in mind",
    "start": "404639",
    "end": "405919"
  },
  {
    "text": "latency and thorough put for latency at",
    "start": "405919",
    "end": "409360"
  },
  {
    "text": "the highest level",
    "start": "409360",
    "end": "410479"
  },
  {
    "text": "is about how fast we can release a new",
    "start": "410479",
    "end": "412639"
  },
  {
    "text": "title",
    "start": "412639",
    "end": "413599"
  },
  {
    "text": "that doesn't just mean how fast a",
    "start": "413599",
    "end": "415520"
  },
  {
    "text": "customer can start watching the show",
    "start": "415520",
    "end": "417680"
  },
  {
    "text": "but also means internal teams can start",
    "start": "417680",
    "end": "420960"
  },
  {
    "text": "using the materials",
    "start": "420960",
    "end": "422319"
  },
  {
    "text": "for marketing purpose at the lower level",
    "start": "422319",
    "end": "426000"
  },
  {
    "text": "we want to measure how fast the work",
    "start": "426000",
    "end": "427919"
  },
  {
    "text": "atoms can be completed",
    "start": "427919",
    "end": "429360"
  },
  {
    "text": "individually for throughput",
    "start": "429360",
    "end": "433280"
  },
  {
    "text": "we ask ourselves how long it would take",
    "start": "433280",
    "end": "436000"
  },
  {
    "text": "to re-encode the entire catalog",
    "start": "436000",
    "end": "438400"
  },
  {
    "text": "and also how much work can be done in",
    "start": "438400",
    "end": "440720"
  },
  {
    "text": "parallel with a given set of resources",
    "start": "440720",
    "end": "445360"
  },
  {
    "text": "with this in mind let me share with you",
    "start": "446560",
    "end": "448880"
  },
  {
    "text": "the three techniques",
    "start": "448880",
    "end": "450080"
  },
  {
    "text": "that our teams and netflix have applied",
    "start": "450080",
    "end": "452720"
  },
  {
    "text": "to help improve the video encoding",
    "start": "452720",
    "end": "454400"
  },
  {
    "text": "system efficiency",
    "start": "454400",
    "end": "456400"
  },
  {
    "text": "we are going to talk about them in",
    "start": "456400",
    "end": "457919"
  },
  {
    "text": "details one by one",
    "start": "457919",
    "end": "460080"
  },
  {
    "text": "for quick preview these techniques are",
    "start": "460080",
    "end": "462400"
  },
  {
    "text": "about",
    "start": "462400",
    "end": "463199"
  },
  {
    "text": "using the right tools to inspect your",
    "start": "463199",
    "end": "465039"
  },
  {
    "text": "workload knowing what your hardware can",
    "start": "465039",
    "end": "467520"
  },
  {
    "text": "provide",
    "start": "467520",
    "end": "468240"
  },
  {
    "text": "and how to take full advantage of it and",
    "start": "468240",
    "end": "471280"
  },
  {
    "text": "finally figuring out a way to fit the",
    "start": "471280",
    "end": "474479"
  },
  {
    "text": "workload properly",
    "start": "474479",
    "end": "475680"
  },
  {
    "text": "in a distributed system",
    "start": "475680",
    "end": "479840"
  },
  {
    "text": "now let's start with the first technique",
    "start": "479840",
    "end": "482400"
  },
  {
    "text": "what i call",
    "start": "482400",
    "end": "483440"
  },
  {
    "text": "using high resolution tools the idea is",
    "start": "483440",
    "end": "486639"
  },
  {
    "text": "pretty simple",
    "start": "486639",
    "end": "488160"
  },
  {
    "text": "what you can optimize is limited to what",
    "start": "488160",
    "end": "491120"
  },
  {
    "text": "you can observe",
    "start": "491120",
    "end": "493840"
  },
  {
    "text": "a lot of you probably have seen",
    "start": "494479",
    "end": "495919"
  },
  {
    "text": "something like this a standard time",
    "start": "495919",
    "end": "497919"
  },
  {
    "text": "series diagram showing cpu utilization",
    "start": "497919",
    "end": "501120"
  },
  {
    "text": "the one i'm showing to you here is a",
    "start": "501120",
    "end": "503039"
  },
  {
    "text": "tool called atlas",
    "start": "503039",
    "end": "504800"
  },
  {
    "text": "that we use at netflix for analyzing",
    "start": "504800",
    "end": "507039"
  },
  {
    "text": "macro services",
    "start": "507039",
    "end": "508800"
  },
  {
    "text": "actilist gives us one minute average of",
    "start": "508800",
    "end": "511199"
  },
  {
    "text": "matrix",
    "start": "511199",
    "end": "511840"
  },
  {
    "text": "and works pretty well for what it is",
    "start": "511840",
    "end": "513839"
  },
  {
    "text": "meant for",
    "start": "513839",
    "end": "515200"
  },
  {
    "text": "in this chart we are showing the cpu",
    "start": "515200",
    "end": "517919"
  },
  {
    "text": "utilization",
    "start": "517919",
    "end": "518880"
  },
  {
    "text": "of a video encoding worker in a 3 hour",
    "start": "518880",
    "end": "522159"
  },
  {
    "text": "span",
    "start": "522159",
    "end": "523360"
  },
  {
    "text": "note that a worker fetches work atoms",
    "start": "523360",
    "end": "526080"
  },
  {
    "text": "from the queues",
    "start": "526080",
    "end": "527120"
  },
  {
    "text": "and process them sequentially as you see",
    "start": "527120",
    "end": "530800"
  },
  {
    "text": "the cpu utilization is quite specky",
    "start": "530800",
    "end": "533680"
  },
  {
    "text": "ranges from 40 percent to 100",
    "start": "533680",
    "end": "538480"
  },
  {
    "text": "let's take a look at the first 30",
    "start": "539120",
    "end": "540720"
  },
  {
    "text": "minutes during this time",
    "start": "540720",
    "end": "542640"
  },
  {
    "text": "the worker was working on 59 tasks",
    "start": "542640",
    "end": "546000"
  },
  {
    "text": "converting the content into h.264",
    "start": "546000",
    "end": "550000"
  },
  {
    "text": "in the next 30 minutes then it worked on",
    "start": "550000",
    "end": "552800"
  },
  {
    "text": "exactly one task",
    "start": "552800",
    "end": "555600"
  },
  {
    "text": "in a final an hour and a half there were",
    "start": "555600",
    "end": "558000"
  },
  {
    "text": "80 tasks",
    "start": "558000",
    "end": "559279"
  },
  {
    "text": "doing vp9 encoding so in a total of 3",
    "start": "559279",
    "end": "563279"
  },
  {
    "text": "hours there were 140 tasks being run",
    "start": "563279",
    "end": "566800"
  },
  {
    "text": "with quite a lot of them starting and",
    "start": "566800",
    "end": "568959"
  },
  {
    "text": "finishing within the same minute",
    "start": "568959",
    "end": "571600"
  },
  {
    "text": "recall that the chart is at one minute",
    "start": "571600",
    "end": "574080"
  },
  {
    "text": "interval",
    "start": "574080",
    "end": "575200"
  },
  {
    "text": "now we see that the view is too course",
    "start": "575200",
    "end": "577680"
  },
  {
    "text": "to tell us",
    "start": "577680",
    "end": "578480"
  },
  {
    "text": "exactly what is going on within a task",
    "start": "578480",
    "end": "581839"
  },
  {
    "text": "we want to dig further",
    "start": "581839",
    "end": "585040"
  },
  {
    "text": "to dig further let's use a tool that can",
    "start": "585040",
    "end": "587680"
  },
  {
    "text": "provide us more granularity",
    "start": "587680",
    "end": "590000"
  },
  {
    "text": "here we use vector an open source the",
    "start": "590000",
    "end": "592720"
  },
  {
    "text": "tool that provides",
    "start": "592720",
    "end": "593760"
  },
  {
    "text": "one second average of system matrix",
    "start": "593760",
    "end": "597200"
  },
  {
    "text": "using this tool you can clearly see that",
    "start": "597200",
    "end": "599760"
  },
  {
    "text": "within this",
    "start": "599760",
    "end": "600480"
  },
  {
    "text": "15 second task some drama is going on",
    "start": "600480",
    "end": "604320"
  },
  {
    "text": "cpu climbs up from zero to 50 percent",
    "start": "604320",
    "end": "607279"
  },
  {
    "text": "dropped to 10 percent",
    "start": "607279",
    "end": "608640"
  },
  {
    "text": "and then back up again to a hundred",
    "start": "608640",
    "end": "610800"
  },
  {
    "text": "percent",
    "start": "610800",
    "end": "611680"
  },
  {
    "text": "before dropping all the way down to zero",
    "start": "611680",
    "end": "615040"
  },
  {
    "text": "so we are very curious about what the",
    "start": "615040",
    "end": "617519"
  },
  {
    "text": "system is doing",
    "start": "617519",
    "end": "618880"
  },
  {
    "text": "during this time window",
    "start": "618880",
    "end": "622160"
  },
  {
    "text": "then we refer to flame scope which is a",
    "start": "622880",
    "end": "625680"
  },
  {
    "text": "performance visualization",
    "start": "625680",
    "end": "627200"
  },
  {
    "text": "analysis tool that allows us to zoom",
    "start": "627200",
    "end": "629920"
  },
  {
    "text": "into a fraction of cpu profile",
    "start": "629920",
    "end": "632240"
  },
  {
    "text": "so you can find out what is going on",
    "start": "632240",
    "end": "634640"
  },
  {
    "text": "within a second",
    "start": "634640",
    "end": "636800"
  },
  {
    "text": "in this visualization each cell has",
    "start": "636800",
    "end": "639440"
  },
  {
    "text": "color ranging",
    "start": "639440",
    "end": "640560"
  },
  {
    "text": "from white to pink to red so before",
    "start": "640560",
    "end": "643839"
  },
  {
    "text": "going into details of it",
    "start": "643839",
    "end": "646880"
  },
  {
    "text": "doesn't this look like something",
    "start": "646880",
    "end": "648320"
  },
  {
    "text": "delicious",
    "start": "648320",
    "end": "650959"
  },
  {
    "text": "using these two to analyze the tasks for",
    "start": "652160",
    "end": "654480"
  },
  {
    "text": "different codecs",
    "start": "654480",
    "end": "655760"
  },
  {
    "text": "we got different interesting stakes or",
    "start": "655760",
    "end": "658160"
  },
  {
    "text": "rather different charts",
    "start": "658160",
    "end": "661440"
  },
  {
    "text": "now let's take a look at one of them and",
    "start": "661440",
    "end": "663920"
  },
  {
    "text": "see how to interpret it",
    "start": "663920",
    "end": "666880"
  },
  {
    "text": "bottom to top each column is one second",
    "start": "666880",
    "end": "670320"
  },
  {
    "text": "and the second next second was painted",
    "start": "670320",
    "end": "673519"
  },
  {
    "text": "from bottom to top again",
    "start": "673519",
    "end": "675760"
  },
  {
    "text": "so it's time range in both axis",
    "start": "675760",
    "end": "678959"
  },
  {
    "text": "the color depth indicates how many cpus",
    "start": "678959",
    "end": "681360"
  },
  {
    "text": "were busy",
    "start": "681360",
    "end": "682079"
  },
  {
    "text": "for the time range there were 50 rows",
    "start": "682079",
    "end": "685360"
  },
  {
    "text": "the size of each cell or pixel is about",
    "start": "685360",
    "end": "688160"
  },
  {
    "text": "20 milliseconds",
    "start": "688160",
    "end": "689519"
  },
  {
    "text": "so we can now see the patterns within a",
    "start": "689519",
    "end": "691839"
  },
  {
    "text": "second",
    "start": "691839",
    "end": "693839"
  },
  {
    "text": "what's cooler is by clicking and",
    "start": "693839",
    "end": "696000"
  },
  {
    "text": "selecting",
    "start": "696000",
    "end": "696880"
  },
  {
    "text": "a set of pixels we can see the flame",
    "start": "696880",
    "end": "699440"
  },
  {
    "text": "graph",
    "start": "699440",
    "end": "700000"
  },
  {
    "text": "during the time frame",
    "start": "700000",
    "end": "703120"
  },
  {
    "text": "now back to the visualization for",
    "start": "703120",
    "end": "705040"
  },
  {
    "text": "different encoding tasks",
    "start": "705040",
    "end": "706880"
  },
  {
    "text": "we can see that none of them seem to",
    "start": "706880",
    "end": "709279"
  },
  {
    "text": "fully utilize the cpus",
    "start": "709279",
    "end": "711279"
  },
  {
    "text": "because if they were they would just be",
    "start": "711279",
    "end": "714000"
  },
  {
    "text": "all red",
    "start": "714000",
    "end": "715600"
  },
  {
    "text": "and we can also see that there are",
    "start": "715600",
    "end": "717519"
  },
  {
    "text": "different types of patterns",
    "start": "717519",
    "end": "719040"
  },
  {
    "text": "which indicates common performance",
    "start": "719040",
    "end": "720880"
  },
  {
    "text": "issues let's take a look at them",
    "start": "720880",
    "end": "723200"
  },
  {
    "text": "and see what we can do about them",
    "start": "723200",
    "end": "726800"
  },
  {
    "text": "number one out of cpu time as indicated",
    "start": "726800",
    "end": "730399"
  },
  {
    "text": "as the",
    "start": "730399",
    "end": "730959"
  },
  {
    "text": "white columns which means cpu",
    "start": "730959",
    "end": "734240"
  },
  {
    "text": "is doing nothing which usually indicates",
    "start": "734240",
    "end": "737120"
  },
  {
    "text": "opportunities",
    "start": "737120",
    "end": "738079"
  },
  {
    "text": "for more parallelization",
    "start": "738079",
    "end": "741519"
  },
  {
    "text": "we also have areas of light pink color",
    "start": "742079",
    "end": "744639"
  },
  {
    "text": "which indicates only one cpu was used",
    "start": "744639",
    "end": "748000"
  },
  {
    "text": "if we take h.264 as an example",
    "start": "748000",
    "end": "751040"
  },
  {
    "text": "the big pink area with some red dots for",
    "start": "751040",
    "end": "754320"
  },
  {
    "text": "perturbations which could be interrupts",
    "start": "754320",
    "end": "756480"
  },
  {
    "text": "or system tasks",
    "start": "756480",
    "end": "758079"
  },
  {
    "text": "so for this scenario a common",
    "start": "758079",
    "end": "760000"
  },
  {
    "text": "optimization strategy",
    "start": "760000",
    "end": "761680"
  },
  {
    "text": "is to see if you can remove resource",
    "start": "761680",
    "end": "763760"
  },
  {
    "text": "contention of these blocks",
    "start": "763760",
    "end": "767440"
  },
  {
    "text": "finally we have large red blocks which",
    "start": "767760",
    "end": "770720"
  },
  {
    "text": "is a good indicator",
    "start": "770720",
    "end": "772079"
  },
  {
    "text": "of the program taking full advantage of",
    "start": "772079",
    "end": "774399"
  },
  {
    "text": "cpus",
    "start": "774399",
    "end": "776160"
  },
  {
    "text": "but we can still try to optimize by",
    "start": "776160",
    "end": "778639"
  },
  {
    "text": "looking into",
    "start": "778639",
    "end": "779440"
  },
  {
    "text": "which functions are running and rewrite",
    "start": "779440",
    "end": "781760"
  },
  {
    "text": "them to make them run faster",
    "start": "781760",
    "end": "785120"
  },
  {
    "text": "to do that a tool that could be very",
    "start": "785120",
    "end": "787360"
  },
  {
    "text": "handy is flame graph",
    "start": "787360",
    "end": "789120"
  },
  {
    "text": "you can get to flame graph by clicking a",
    "start": "789120",
    "end": "791760"
  },
  {
    "text": "subset",
    "start": "791760",
    "end": "792320"
  },
  {
    "text": "of pixels in the previous heat maps",
    "start": "792320",
    "end": "795839"
  },
  {
    "text": "it is a tool for visualizing application",
    "start": "795839",
    "end": "798240"
  },
  {
    "text": "and kernel stacks",
    "start": "798240",
    "end": "799519"
  },
  {
    "text": "allowing the most frequent code path to",
    "start": "799519",
    "end": "801600"
  },
  {
    "text": "be identified quickly",
    "start": "801600",
    "end": "803200"
  },
  {
    "text": "and accurately so the wider a frame is",
    "start": "803200",
    "end": "807200"
  },
  {
    "text": "the more often it was presented in the",
    "start": "807200",
    "end": "810240"
  },
  {
    "text": "stacks the top edge usually shows what",
    "start": "810240",
    "end": "813120"
  },
  {
    "text": "is on cpu",
    "start": "813120",
    "end": "814240"
  },
  {
    "text": "and beneath is its ancestry so with this",
    "start": "814240",
    "end": "817600"
  },
  {
    "text": "you can easily identify some thing that",
    "start": "817600",
    "end": "820240"
  },
  {
    "text": "we can further optimize",
    "start": "820240",
    "end": "823519"
  },
  {
    "text": "using high resolution tools is like",
    "start": "823680",
    "end": "826079"
  },
  {
    "text": "looking at",
    "start": "826079",
    "end": "826800"
  },
  {
    "text": "the system through a magnifier it helps",
    "start": "826800",
    "end": "830160"
  },
  {
    "text": "us to find out all the suspects for",
    "start": "830160",
    "end": "832399"
  },
  {
    "text": "potential performance optimizations",
    "start": "832399",
    "end": "836160"
  },
  {
    "text": "we just talked about our first technique",
    "start": "836160",
    "end": "838240"
  },
  {
    "text": "of using high resolution tools",
    "start": "838240",
    "end": "840720"
  },
  {
    "text": "now let's talk about the second",
    "start": "840720",
    "end": "842399"
  },
  {
    "text": "technique which is",
    "start": "842399",
    "end": "844000"
  },
  {
    "text": "leveraging hardware feature to make",
    "start": "844000",
    "end": "846079"
  },
  {
    "text": "things run even faster",
    "start": "846079",
    "end": "848720"
  },
  {
    "text": "an analogy here is that even if you have",
    "start": "848720",
    "end": "851440"
  },
  {
    "text": "a supercar",
    "start": "851440",
    "end": "852560"
  },
  {
    "text": "if you don't drive it at full speed of",
    "start": "852560",
    "end": "854880"
  },
  {
    "text": "course in a safe risk track environment",
    "start": "854880",
    "end": "857920"
  },
  {
    "text": "you are not maximizing its full",
    "start": "857920",
    "end": "859839"
  },
  {
    "text": "potential",
    "start": "859839",
    "end": "862399"
  },
  {
    "text": "looking at the same encoding task as an",
    "start": "862959",
    "end": "865040"
  },
  {
    "text": "example",
    "start": "865040",
    "end": "866000"
  },
  {
    "text": "by starting this flame graph we know",
    "start": "866000",
    "end": "868320"
  },
  {
    "text": "that 33",
    "start": "868320",
    "end": "869920"
  },
  {
    "text": "of the total cpu time was spent on a",
    "start": "869920",
    "end": "872560"
  },
  {
    "text": "particular function",
    "start": "872560",
    "end": "873920"
  },
  {
    "text": "which is highlighted in purple color so",
    "start": "873920",
    "end": "876639"
  },
  {
    "text": "this is",
    "start": "876639",
    "end": "877199"
  },
  {
    "text": "from cockadoo which is encoder and",
    "start": "877199",
    "end": "879920"
  },
  {
    "text": "decoder library that we use for our j2k",
    "start": "879920",
    "end": "883920"
  },
  {
    "text": "now it is our focus area for",
    "start": "883920",
    "end": "885680"
  },
  {
    "text": "optimizations",
    "start": "885680",
    "end": "887519"
  },
  {
    "text": "once we dig into this code we find that",
    "start": "887519",
    "end": "890800"
  },
  {
    "text": "the majority of the encoding work",
    "start": "890800",
    "end": "892880"
  },
  {
    "text": "involves time and frequency domain",
    "start": "892880",
    "end": "894959"
  },
  {
    "text": "conversions",
    "start": "894959",
    "end": "896160"
  },
  {
    "text": "and other methods of handling",
    "start": "896160",
    "end": "897760"
  },
  {
    "text": "convolution",
    "start": "897760",
    "end": "899519"
  },
  {
    "text": "this type of matrix computation is",
    "start": "899519",
    "end": "901839"
  },
  {
    "text": "usually a good candidate of leveraging",
    "start": "901839",
    "end": "904160"
  },
  {
    "text": "special hardware",
    "start": "904160",
    "end": "905519"
  },
  {
    "text": "such as fpgas or gpus",
    "start": "905519",
    "end": "909199"
  },
  {
    "text": "however there were easier wins available",
    "start": "909199",
    "end": "912000"
  },
  {
    "text": "on most",
    "start": "912000",
    "end": "912560"
  },
  {
    "text": "x86 already for example",
    "start": "912560",
    "end": "915600"
  },
  {
    "text": "in our case we decided to leverage",
    "start": "915600",
    "end": "918000"
  },
  {
    "text": "vector instructions such as",
    "start": "918000",
    "end": "919600"
  },
  {
    "text": "avx2 sse which allow faster matrix map",
    "start": "919600",
    "end": "924480"
  },
  {
    "text": "by turning on the corresponding to the",
    "start": "924480",
    "end": "926639"
  },
  {
    "text": "functions",
    "start": "926639",
    "end": "927760"
  },
  {
    "text": "you might be able to speed up your",
    "start": "927760",
    "end": "929519"
  },
  {
    "text": "program significantly",
    "start": "929519",
    "end": "931120"
  },
  {
    "text": "depending on your workload",
    "start": "931120",
    "end": "934880"
  },
  {
    "text": "of course this is not an easy fit",
    "start": "935680",
    "end": "938720"
  },
  {
    "text": "you really need to know your hardware",
    "start": "938720",
    "end": "940560"
  },
  {
    "text": "and software well so you know what to",
    "start": "940560",
    "end": "942720"
  },
  {
    "text": "tune",
    "start": "942720",
    "end": "943920"
  },
  {
    "text": "there might be a special knob on",
    "start": "943920",
    "end": "945759"
  },
  {
    "text": "hardware that is waiting for you to",
    "start": "945759",
    "end": "947759"
  },
  {
    "text": "discover",
    "start": "947759",
    "end": "950319"
  },
  {
    "text": "the third and the final technique we",
    "start": "951440",
    "end": "953440"
  },
  {
    "text": "would like to share today",
    "start": "953440",
    "end": "955040"
  },
  {
    "text": "is about sizing the workload properly",
    "start": "955040",
    "end": "957519"
  },
  {
    "text": "for better utilizations",
    "start": "957519",
    "end": "959759"
  },
  {
    "text": "like playing tetris",
    "start": "959759",
    "end": "962959"
  },
  {
    "text": "here is an example of improving our av1",
    "start": "963680",
    "end": "966839"
  },
  {
    "text": "encode",
    "start": "966839",
    "end": "968079"
  },
  {
    "text": "so av1 is a new codec that reduces 15",
    "start": "968079",
    "end": "971600"
  },
  {
    "text": "of the bit rate but requires 1.5 times",
    "start": "971600",
    "end": "974560"
  },
  {
    "text": "more cpu time for encoding",
    "start": "974560",
    "end": "977440"
  },
  {
    "text": "let's say we have already applied the",
    "start": "977440",
    "end": "979600"
  },
  {
    "text": "previous two techniques",
    "start": "979600",
    "end": "981199"
  },
  {
    "text": "and you optimize the worker to its full",
    "start": "981199",
    "end": "983839"
  },
  {
    "text": "potential",
    "start": "983839",
    "end": "984720"
  },
  {
    "text": "and also taking full advantage of the",
    "start": "984720",
    "end": "986639"
  },
  {
    "text": "hardware features",
    "start": "986639",
    "end": "988639"
  },
  {
    "text": "but by monitoring the cpu utilization we",
    "start": "988639",
    "end": "991600"
  },
  {
    "text": "notice",
    "start": "991600",
    "end": "992079"
  },
  {
    "text": "it's running at 25",
    "start": "992079",
    "end": "995440"
  },
  {
    "text": "so we were thinking like how can we",
    "start": "995440",
    "end": "997920"
  },
  {
    "text": "improve the throughput",
    "start": "997920",
    "end": "999440"
  },
  {
    "text": "of the entire instance",
    "start": "999440",
    "end": "1002800"
  },
  {
    "text": "then what we do is to implement some",
    "start": "1002959",
    "end": "1005279"
  },
  {
    "text": "concurrent workers",
    "start": "1005279",
    "end": "1006720"
  },
  {
    "text": "that scaled based on the instance type",
    "start": "1006720",
    "end": "1009440"
  },
  {
    "text": "that we're running on",
    "start": "1009440",
    "end": "1011199"
  },
  {
    "text": "so eventually we achieve 100 cpu",
    "start": "1011199",
    "end": "1014240"
  },
  {
    "text": "and also double the single instance",
    "start": "1014240",
    "end": "1016240"
  },
  {
    "text": "throughput",
    "start": "1016240",
    "end": "1018800"
  },
  {
    "text": "and this makes us want to think maybe we",
    "start": "1019440",
    "end": "1022320"
  },
  {
    "text": "want to do this to all our different",
    "start": "1022320",
    "end": "1024319"
  },
  {
    "text": "incomes",
    "start": "1024319",
    "end": "1025438"
  },
  {
    "text": "we want to shape the type of encode work",
    "start": "1025439",
    "end": "1028000"
  },
  {
    "text": "atom",
    "start": "1028000",
    "end": "1028558"
  },
  {
    "text": "with a lot of parameters such as",
    "start": "1028559",
    "end": "1031438"
  },
  {
    "text": "resolution",
    "start": "1031439",
    "end": "1032558"
  },
  {
    "text": "codec number of frames and also resource",
    "start": "1032559",
    "end": "1035839"
  },
  {
    "text": "utilization such as",
    "start": "1035839",
    "end": "1037438"
  },
  {
    "text": "cpu memory disk network",
    "start": "1037439",
    "end": "1040558"
  },
  {
    "text": "and we also want to add the job duration",
    "start": "1040559",
    "end": "1045760"
  },
  {
    "text": "so what we did is we annotated the",
    "start": "1046079",
    "end": "1049280"
  },
  {
    "text": "encoding process",
    "start": "1049280",
    "end": "1050480"
  },
  {
    "text": "to know the resource consumption at",
    "start": "1050480",
    "end": "1052160"
  },
  {
    "text": "different application phases",
    "start": "1052160",
    "end": "1054480"
  },
  {
    "text": "here is an example of annotating cpu",
    "start": "1054480",
    "end": "1056880"
  },
  {
    "text": "utilization",
    "start": "1056880",
    "end": "1057840"
  },
  {
    "text": "of an encode task in fact we did this",
    "start": "1057840",
    "end": "1060880"
  },
  {
    "text": "for all other",
    "start": "1060880",
    "end": "1062480"
  },
  {
    "text": "system metrics to do this we basically",
    "start": "1062480",
    "end": "1066160"
  },
  {
    "text": "did instrumentation to our code we are",
    "start": "1066160",
    "end": "1069200"
  },
  {
    "text": "at different stages and",
    "start": "1069200",
    "end": "1070480"
  },
  {
    "text": "automatically emit messages with all the",
    "start": "1070480",
    "end": "1072960"
  },
  {
    "text": "attributes that we want",
    "start": "1072960",
    "end": "1075039"
  },
  {
    "text": "these attributes include phases duration",
    "start": "1075039",
    "end": "1078799"
  },
  {
    "text": "source encode width and height codecs",
    "start": "1078799",
    "end": "1082080"
  },
  {
    "text": "and number of frames we persist this",
    "start": "1082080",
    "end": "1085360"
  },
  {
    "text": "data to data warehouse",
    "start": "1085360",
    "end": "1087120"
  },
  {
    "text": "for further analysis and this turnout",
    "start": "1087120",
    "end": "1089360"
  },
  {
    "text": "help us better understand the jobs",
    "start": "1089360",
    "end": "1091360"
  },
  {
    "text": "running",
    "start": "1091360",
    "end": "1092559"
  },
  {
    "text": "ultimately we use this data as a",
    "start": "1092559",
    "end": "1095120"
  },
  {
    "text": "guidance",
    "start": "1095120",
    "end": "1095840"
  },
  {
    "text": "of implementing bin packing algorithms",
    "start": "1095840",
    "end": "1098480"
  },
  {
    "text": "for the workers",
    "start": "1098480",
    "end": "1101280"
  },
  {
    "text": "and that's the last technique we would",
    "start": "1102080",
    "end": "1103679"
  },
  {
    "text": "like to share as a recap",
    "start": "1103679",
    "end": "1106080"
  },
  {
    "text": "the three techniques are using high",
    "start": "1106080",
    "end": "1108400"
  },
  {
    "text": "resolution tools to know where",
    "start": "1108400",
    "end": "1110559"
  },
  {
    "text": "and how you should optimize don't be",
    "start": "1110559",
    "end": "1112880"
  },
  {
    "text": "afraid to go full speed on your hardware",
    "start": "1112880",
    "end": "1115840"
  },
  {
    "text": "and finally know that in today's cloud",
    "start": "1115840",
    "end": "1118480"
  },
  {
    "text": "computing world",
    "start": "1118480",
    "end": "1119760"
  },
  {
    "text": "you need to know how to fit workloads",
    "start": "1119760",
    "end": "1121520"
  },
  {
    "text": "together to maximize throughput",
    "start": "1121520",
    "end": "1124880"
  },
  {
    "text": "there are a lot of information that we",
    "start": "1124880",
    "end": "1126720"
  },
  {
    "text": "went through in this 20 minutes talk",
    "start": "1126720",
    "end": "1129120"
  },
  {
    "text": "i hope you find some of them useful and",
    "start": "1129120",
    "end": "1131760"
  },
  {
    "text": "maybe apply them to your domain",
    "start": "1131760",
    "end": "1136320"
  },
  {
    "text": "these are links to the open source tools",
    "start": "1136320",
    "end": "1138480"
  },
  {
    "text": "that i mentioned",
    "start": "1138480",
    "end": "1139440"
  },
  {
    "text": "for your reference thanks for joining me",
    "start": "1139440",
    "end": "1142799"
  },
  {
    "text": "today",
    "start": "1142799",
    "end": "1143360"
  },
  {
    "text": "and i look forward to your questions",
    "start": "1143360",
    "end": "1149760"
  }
]