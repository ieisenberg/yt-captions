[
  {
    "text": "So I've been watching back over some old Computerphile videos",
    "start": "0",
    "end": "1880"
  },
  {
    "text": "as we all do",
    "start": "2180",
    "end": "3260"
  },
  {
    "text": "and I was watching a video by Tom Rodden on cookies",
    "start": "3620",
    "end": "6899"
  },
  {
    "text": "Rodden: How then do you do the little shopping carts?",
    "start": "7180",
    "end": "10519"
  },
  {
    "text": "Pound: And he talks a lot about tracking cookies, which are a big deal, alright.",
    "start": "10660",
    "end": "14600"
  },
  {
    "text": "And just a side note, I would say everyone should install Ghostery",
    "start": "14600",
    "end": "16800"
  },
  {
    "text": "and stop people tracking their whereabouts and what they're up to",
    "start": "16800",
    "end": "19960"
  },
  {
    "text": "and what they're browsing online.",
    "start": "19960",
    "end": "21080"
  },
  {
    "text": "But I'm not talking about tracking cookies today – or persistent cookies – I'm talking about cookie stealing",
    "start": "21080",
    "end": "27279"
  },
  {
    "text": "which is the idea of if I can get ahold of your cookie from your browser, in some way,",
    "start": "27280",
    "end": "31720"
  },
  {
    "text": "I can then pretend to be you on that website.",
    "start": "31720",
    "end": "34579"
  },
  {
    "text": "Perhaps a bit of a recap on what it is that a cookie does",
    "start": "38040",
    "end": "40560"
  },
  {
    "text": "so that this puts it into context.",
    "start": "40560",
    "end": "42140"
  },
  {
    "text": "Now of course if you want to know a lot more about cookies, you go back and look at Tom's video.",
    "start": "42140",
    "end": "45380"
  },
  {
    "text": "HTTP and HTML are not persistent. I make a request to a website, it serves me HTML",
    "start": "45440",
    "end": "50719"
  },
  {
    "text": "– and maybe Javascript – and that's the end of the transaction, as far as it's concerned.",
    "start": "50720",
    "end": "54900"
  },
  {
    "text": "I make another request, it's a brand new transaction.",
    "start": "54900",
    "end": "57580"
  },
  {
    "text": "So there's no standard way in that mechanism of me persisting.",
    "start": "58080",
    "end": "63300"
  },
  {
    "text": "Interviewer: So when you say you make a request, that means, for example, you click on a link or something?",
    "start": "63300",
    "end": "67240"
  },
  {
    "text": "Pound: Yeah. So I go into Google and I type www.google.co.uk, or I click on a link",
    "start": "67240",
    "end": "71899"
  },
  {
    "text": "in a webpage that takes me to another website.",
    "start": "71980",
    "end": "75160"
  },
  {
    "text": "Or, indeed, my browser needs to request an image from a server",
    "start": "75160",
    "end": "78760"
  },
  {
    "text": "because I've clicked the plus icon on something and I'm trying to look at an image hi-res.",
    "start": "78760",
    "end": "82440"
  },
  {
    "text": "Interviewer: So even if you're on the same site, you click on different links on that same site it […]",
    "start": "82440",
    "end": "86720"
  },
  {
    "text": "Pound: It will start a new connection, or use the existing connection to send off another HTTP request",
    "start": "86720",
    "end": "90580"
  },
  {
    "text": "which is basically just a string that says \"I want this file, please send it back\"",
    "start": "90580",
    "end": "93900"
  },
  {
    "text": "and the server will hopefully send it back.",
    "start": "93900",
    "end": "96160"
  },
  {
    "text": "Because this isn't persistent, the obvious problem is  how do we do things like shopping baskets",
    "start": "96160",
    "end": "101020"
  },
  {
    "text": "and \"I'm on stage 5 of 6 stages\" in setting up my online banking or something",
    "start": "101020",
    "end": "105560"
  },
  {
    "text": "how do we remember what I've already typed in?",
    "start": "105560",
    "end": "107540"
  },
  {
    "text": "The way we do this is using cookies.",
    "start": "107540",
    "end": "109160"
  },
  {
    "text": "So, the first ever time I visit a website, it might send me back a cookie that's maybe a unique identifier to me.",
    "start": "109160",
    "end": "114620"
  },
  {
    "text": "So just let's say a string of numbers, alright?",
    "start": "114620",
    "end": "116700"
  },
  {
    "text": "And then I think, \"well, I'm going to go back to that website and register\"",
    "start": "116700",
    "end": "121079"
  },
  {
    "text": "so I type in my username that I want and I send off the username and the request for the next page.",
    "start": "121080",
    "end": "126260"
  },
  {
    "text": "And I also send back this unique string of numbers.",
    "start": "126260",
    "end": "129039"
  },
  {
    "text": "And the reason is because then the server can look in the database and go \"oh yeah, I remember him,",
    "start": "129040",
    "end": "133500"
  },
  {
    "text": "he was the one that was using this username, and I can now serve him this slightly different webpage",
    "start": "133500",
    "end": "137860"
  },
  {
    "text": "where the username is already typed in.\" or \"I have already remembered what's in his shopping basket\"",
    "start": "137860",
    "end": "141960"
  },
  {
    "text": "or something like this.",
    "start": "141960",
    "end": "143100"
  },
  {
    "text": "That's what a cookie is for. Now, of course now as Tom rightly points out, they're also used for tracking what you're up to online.",
    "start": "143200",
    "end": "150520"
  },
  {
    "text": "So banner ads and things will use tracking cookies to keep track of you between websites – which is kind of worrying.",
    "start": "150520",
    "end": "156360"
  },
  {
    "text": "But, again, not going to talk about that anymore than to draw people's attention to how scary it is.",
    "start": "156360",
    "end": "161020"
  },
  {
    "text": "The problem is that if I obtain a cookie off you, which is supposed to be secure,",
    "start": "161020",
    "end": "165300"
  },
  {
    "text": "then I can send that to, let's say, Amazon or to a shop and say \"I'm Sean please, you know, what's in his shopping basket\"",
    "start": "165800",
    "end": "173540"
  },
  {
    "text": "\"What's his address?\", \"What's his credit card details?\"",
    "start": "173540",
    "end": "176700"
  },
  {
    "text": "\"Can I change the address of this?\"",
    "start": "177400",
    "end": "179720"
  },
  {
    "text": "If I do that halfway through your transaction, when you've typed in your details,",
    "start": "179720",
    "end": "182860"
  },
  {
    "text": "I can just override and change the shipping address and get stuff sent to my house instead.",
    "start": "182860",
    "end": "186400"
  },
  {
    "text": "It's involved, but it could happen.",
    "start": "186660",
    "end": "189060"
  },
  {
    "text": "If i can get ahold of that cookie.",
    "start": "189060",
    "end": "191319"
  },
  {
    "text": "Now those cookies are stored by the browser, and they're on your computer",
    "start": "191320",
    "end": "195160"
  },
  {
    "text": "so that's quite difficult for me to do.",
    "start": "195160",
    "end": "196820"
  },
  {
    "text": "But cross-site scripting is a very easy way of doing it.",
    "start": "196820",
    "end": "200140"
  },
  {
    "text": "So that's what we're going to do today. We're gonna steal a cookie, and we're gonna do it using a cross-site scripting attack.",
    "start": "200140",
    "end": "205220"
  },
  {
    "text": "Now this ties back into a different video that Tom Scott did on cross-site scripting.",
    "start": "205220",
    "end": "209380"
  },
  {
    "text": "But what we're basically going to do is we're going to inject a script into a blog",
    "start": "209380",
    "end": "213640"
  },
  {
    "text": "– not a secure blog, I should say – and that is going to, when anyone else visits the site",
    "start": "213940",
    "end": "219840"
  },
  {
    "text": "obtain their session cookie and send it to me.",
    "start": "219840",
    "end": "222660"
  },
  {
    "text": "And that I could theoretically use to take over their session.",
    "start": "222660",
    "end": "226340"
  },
  {
    "text": "This is the world's best blog, of course. Alright, it looks good and it's got good content on it.",
    "start": "226340",
    "end": "231180"
  },
  {
    "text": "Here's a picture of a kitten and some kind of banner and that's pretty much it.",
    "start": "231180",
    "end": "235260"
  },
  {
    "text": "And some Lorem Ipsum. And then this blog has crucially got a comments feed at the bottom",
    "start": "235260",
    "end": "239640"
  },
  {
    "text": "So if we look at the comments: \"Many thanks, love the blog\" – That sort of stuff.",
    "start": "239640",
    "end": "242760"
  },
  {
    "text": "It's all very positive – well nearly – and the point is I can type extra comments in here.",
    "start": "242760",
    "end": "247420"
  },
  {
    "text": "So I can say: \"Thanks!\"  from Mike again. And I can post this in, and then when I scroll to the bottom",
    "start": "247420",
    "end": "253540"
  },
  {
    "text": "there it is. And the time that I did it on.",
    "start": "254000",
    "end": "256640"
  },
  {
    "text": "This is just the kind of time where a cross-site scripting attack is possible if you haven't coded your website properly.",
    "start": "256640",
    "end": "261400"
  },
  {
    "text": "ok so what I need to be doing when\nsomeone types some some text in here is",
    "start": "262850",
    "end": "267020"
  },
  {
    "text": "making sure that's what it is and isn't\nin fact valid HTML script my or",
    "start": "267020",
    "end": "271190"
  },
  {
    "text": "JavaScript because if it is then what\nhappens is this browser received it back",
    "start": "271190",
    "end": "274790"
  },
  {
    "text": "to the server and has no reason to think\nthat isn't just part of what the server",
    "start": "274790",
    "end": "278150"
  },
  {
    "text": "intended",
    "start": "278150",
    "end": "279080"
  },
  {
    "text": "I think because it's just a script tag\nlike any other the server will probably",
    "start": "279080",
    "end": "282530"
  },
  {
    "text": "be serving script tags anyway, right, for\ndoing other things and it just serves",
    "start": "282530",
    "end": "286460"
  },
  {
    "text": "another one that's fair enough i mean\nthey do that all the time so we run it",
    "start": "286460",
    "end": "290150"
  },
  {
    "text": "ok and then that's where is a problem so\nit's a responsibility of the server and",
    "start": "290150",
    "end": "294560"
  },
  {
    "text": "the person programming the server to\nmake sure that when I submit data it",
    "start": "294560",
    "end": "298490"
  },
  {
    "text": "doesn't",
    "start": "298490",
    "end": "299090"
  },
  {
    "text": "it isn't actual script, or things that\ncan run",
    "start": "299090",
    "end": "303080"
  },
  {
    "text": "ok so this is a very similar to an SQL\ninjection",
    "start": "303080",
    "end": "306198"
  },
  {
    "text": "except we're putting us we are injecting\nHTML instead of SQL ok",
    "start": "306199",
    "end": "311449"
  },
  {
    "text": "they're very similar kinds of attacks so\nlet's see if it works",
    "start": "311449",
    "end": "314960"
  },
  {
    "text": "the most obvious example be a really\nsimple one let's see if we can get a",
    "start": "314960",
    "end": "318138"
  },
  {
    "text": "pop-up to appear so I'm gonna opening\nclosing HTML tags and then we're going",
    "start": "318139",
    "end": "322340"
  },
  {
    "text": "to say alert \"XSS !\"",
    "start": "322340",
    "end": "325940"
  },
  {
    "text": "ok so theoretically what will happen is\nthis page will serve these comments to",
    "start": "325940",
    "end": "331130"
  },
  {
    "text": "me when I go to this website and they\nwill see this script and not think it's",
    "start": "331130",
    "end": "335540"
  },
  {
    "text": "a comment they will think it's part of\nthe actual webpage to be run and",
    "start": "335540",
    "end": "338120"
  },
  {
    "text": "executed and then off there we go...",
    "start": "338120",
    "end": "339949"
  },
  {
    "text": "so let's see if it works. I need to put\na name ok so i don't want to incriminate",
    "start": "339950",
    "end": "342740"
  },
  {
    "text": "myself so let's put in someone else so\nlike Sean",
    "start": "342740",
    "end": "345259"
  },
  {
    "text": "for example i could submit so I reload\nthis web page of someone else",
    "start": "345260",
    "end": "349070"
  },
  {
    "text": "I get a little pop-up that says\nlocalhost XSS ok so the service",
    "start": "349070",
    "end": "353060"
  },
  {
    "text": "telling me XSS! this is where you\nstop and then you go off and tell them",
    "start": "353060",
    "end": "356780"
  },
  {
    "text": "about it but you can go further than\nthis. To be absolutely clear, this is my own website",
    "start": "356780",
    "end": "360229"
  },
  {
    "text": "running on my laptop - it's not secure\non purpose and it doesn't matter if I",
    "start": "360229",
    "end": "364669"
  },
  {
    "text": "hack it because no one no harm is coming up this",
    "start": "364669",
    "end": "366889"
  },
  {
    "text": "ok I wouldn't ever do this on a public\nwebsite so i just loaded some files to",
    "start": "366889",
    "end": "370550"
  },
  {
    "text": "show you how the blog works behind the\nscenes so you get an idea of what's",
    "start": "370550",
    "end": "373430"
  },
  {
    "text": "going on",
    "start": "373430",
    "end": "373970"
  },
  {
    "text": "so this is PHP right so it's going to be\na mixture of PHP code and HTML",
    "start": "373970",
    "end": "378710"
  },
  {
    "text": "right, some which is a result of PHP some\nwhich is just put in",
    "start": "378710",
    "end": "382580"
  },
  {
    "text": "so here you can see that i called\nsomething called session start now what",
    "start": "382580",
    "end": "386180"
  },
  {
    "text": "session starts going to do is PHP is\ngoing to look to see if the cookie they",
    "start": "386180",
    "end": "389539"
  },
  {
    "text": "received is a valid session and if it is\nit's going to resume my session its going",
    "start": "389539",
    "end": "393260"
  },
  {
    "text": "to remember who i am and any parameters\nthat this website has set for me will be",
    "start": "393260",
    "end": "396979"
  },
  {
    "text": "remembered in the database if there is\nno cookie on file for me that means i'm",
    "start": "396979",
    "end": "401240"
  },
  {
    "text": "coming at it for the first time for my\nsession expired and it will make one and",
    "start": "401240",
    "end": "405530"
  },
  {
    "text": "send it back to me in the first response\nright now that all happens within this",
    "start": "405530",
    "end": "409820"
  },
  {
    "text": "session start thing and is not something i need\nto concern myself with as a developer",
    "start": "409820",
    "end": "412669"
  },
  {
    "text": "you can do it yourself",
    "start": "412669",
    "end": "414650"
  },
  {
    "text": "now I've got standard submit comments\nokay so I output the blog text and then",
    "start": "414650",
    "end": "418940"
  },
  {
    "text": "I check if someone clicks \"Submit comment\"\nbutton it will check the post values for",
    "start": "418940",
    "end": "424340"
  },
  {
    "text": "content and their name and then it will\nput them into a database now as a side",
    "start": "424340",
    "end": "429020"
  },
  {
    "text": "note I am actually escaping these\nmySQL strings",
    "start": "429020",
    "end": "431479"
  },
  {
    "text": "there we are so I'm not vulnerable here to a\nmySQL injection because of these bits",
    "start": "431480",
    "end": "436430"
  },
  {
    "text": "so that's good but I'm not vulnerable to\nSQL injection unfortunately I am vulnerable",
    "start": "436430",
    "end": "439880"
  },
  {
    "text": "to cross site scripting so I'm not doing\nany kind of cross-site scripting",
    "start": "439880",
    "end": "443960"
  },
  {
    "text": "detection here",
    "start": "443960",
    "end": "445009"
  },
  {
    "text": "okay I'm just gonna serve back whatever\nthe person typed in now as an attacker",
    "start": "445010",
    "end": "449300"
  },
  {
    "text": "what I've done is I've created another\nPHP file called submit cookie dot PHP",
    "start": "449300",
    "end": "452629"
  },
  {
    "text": "that is it just a file that takes as a\nparameter, a string of a cookie stores in a",
    "start": "452630",
    "end": "458480"
  },
  {
    "text": "database on these two lines here and\nthen serves him back in image",
    "start": "458480",
    "end": "462620"
  },
  {
    "text": "so what I'm going to do is I'm going to\nwrite a cross-site scripting attack which is",
    "start": "462620",
    "end": "465530"
  },
  {
    "text": "basically a comment on this blog that\ncauses their website or their client to",
    "start": "465530",
    "end": "470660"
  },
  {
    "text": "visit this submit cookie dot PHP and\ngive them the cookie",
    "start": "470660",
    "end": "474260"
  },
  {
    "text": "ok so because this is this is one\nquestion that I remember rising when we talked",
    "start": "474770",
    "end": "479030"
  },
  {
    "text": "about these sorts of things before is\nthe difference between client and server",
    "start": "479030",
    "end": "481790"
  },
  {
    "text": "side you know you're doing some code\nthat will cause the server to come and",
    "start": "481790",
    "end": "486470"
  },
  {
    "text": "find this code?",
    "start": "486470",
    "end": "487430"
  },
  {
    "text": "imagine that I've so imagine that there\nis no PHP in there is no script right",
    "start": "487430",
    "end": "491300"
  },
  {
    "text": "All there is is a website with some images on\nit",
    "start": "491300",
    "end": "493190"
  },
  {
    "text": "ok you're the server and I'm the client I\nsay can I get index.html?",
    "start": "493190",
    "end": "497840"
  },
  {
    "text": "you say yeah here it is",
    "start": "497840",
    "end": "499400"
  },
  {
    "text": "ok I read it and show on the screen and\nthen I realized that actually it's got",
    "start": "499400",
    "end": "502970"
  },
  {
    "text": "an image in it that has a source that's\nlike your-website / image1.jpg",
    "start": "502970",
    "end": "507800"
  },
  {
    "text": "right",
    "start": "507800",
    "end": "508460"
  },
  {
    "text": "so I say okay I need this too can i have\njpg this JPEG and you send it back so i",
    "start": "508460",
    "end": "513080"
  },
  {
    "text": "make multiple requests to you to get the\nvarious bits of content just like that",
    "start": "513080",
    "end": "516590"
  },
  {
    "text": "and just like with a banner ad",
    "start": "516590",
    "end": "517820"
  },
  {
    "text": "I might come to a bit in the HTML that tells me to go to some other website or",
    "start": "517820",
    "end": "521330"
  },
  {
    "text": "something else and then and there is no\nreason for me to think that is not a",
    "start": "521330",
    "end": "524570"
  },
  {
    "text": "reasonable request",
    "start": "524570",
    "end": "525710"
  },
  {
    "text": "maybe your images are stored on a\ndifferent server so i'm going to go",
    "start": "525710",
    "end": "529040"
  },
  {
    "text": "there",
    "start": "529040",
    "end": "529670"
  },
  {
    "text": "ok so i go i was an image and I need\nthat from over here so I go over there",
    "start": "529670",
    "end": "533180"
  },
  {
    "text": "and I get it right",
    "start": "533180",
    "end": "534410"
  },
  {
    "text": "the fact that it also bagged my cookie\nis just an unfortunate side effect but",
    "start": "534410",
    "end": "538339"
  },
  {
    "text": "it's not something that was necessary\nand it wasn't something was intended",
    "start": "538340",
    "end": "540650"
  },
  {
    "text": "when they developed the web but it's\nunfortunately what happens now",
    "start": "540650",
    "end": "543740"
  },
  {
    "text": "so that's what's going to happen ok\nmaybe right so I'm gonna start with",
    "start": "544910",
    "end": "549500"
  },
  {
    "text": "script so we already know this blog is\nvulnerable to cross-site scripting so",
    "start": "549500",
    "end": "552770"
  },
  {
    "text": "we don't need to worry specifically about it i don't\nhave to obfuscate it or do anything clever i'm",
    "start": "552770",
    "end": "556070"
  },
  {
    "text": "going to say document dot write",
    "start": "556070",
    "end": "558620"
  },
  {
    "text": "ok now that's just going to write\nnothing to the screen right so my",
    "start": "558620",
    "end": "560720"
  },
  {
    "text": "comment on my blog is just going to be",
    "start": "560720",
    "end": "563269"
  },
  {
    "text": "a script that does nothing okay that's\nnot very interesting so let's do",
    "start": "563270",
    "end": "566240"
  },
  {
    "text": "something a bit more interesting",
    "start": "566240",
    "end": "567260"
  },
  {
    "text": "our PHP file takes the cookie and gives an image back so let's just show it on the",
    "start": "567260",
    "end": "570350"
  },
  {
    "text": "screen right? So image tag in HTML IMG is\nthe image tag the source of that is",
    "start": "570350",
    "end": "575990"
  },
  {
    "text": "HTTP code on / localhost now this could\nobviously be a different website / submit",
    "start": "575990",
    "end": "582110"
  },
  {
    "text": "cookie dot PHP Question Mark - now this takes get\nrequests so I say submit a cookie . PHP",
    "start": "582110",
    "end": "589190"
  },
  {
    "text": "? and when I say cookie equals and then\nthat's what I'm gonna steal their cookie",
    "start": "589190",
    "end": "593600"
  },
  {
    "text": "and give it to myself",
    "start": "593600",
    "end": "594740"
  },
  {
    "text": "all right to do that all I do is I say\nplus document . cookie",
    "start": "594740",
    "end": "600520"
  },
  {
    "text": "- I escape this so",
    "start": "600520",
    "end": "601580"
  },
  {
    "text": "it passes nicely over HTML plus and then i'm\ngoing to close my image tag because",
    "start": "601610",
    "end": "605540"
  },
  {
    "text": "otherwise it's going to malformed HTML and it might execute properly and",
    "start": "605540",
    "end": "608839"
  },
  {
    "text": "then a single quote",
    "start": "608840",
    "end": "610100"
  },
  {
    "text": "ok so let's break down what this is\ndoing the script here is telling the",
    "start": "610100",
    "end": "613819"
  },
  {
    "text": "website that this is a script to be run and not a standard piece of HTML then the",
    "start": "613820",
    "end": "618560"
  },
  {
    "text": "document.right function is just a\npiece of JavaScript that says dump this",
    "start": "618560",
    "end": "621680"
  },
  {
    "text": "out as text",
    "start": "621680",
    "end": "623060"
  },
  {
    "text": "hey but it can also take parameters\nrather than just text yeah and it's",
    "start": "623060",
    "end": "627140"
  },
  {
    "text": "going to output some valid HTML which is\na link to an image but that image is not",
    "start": "627140",
    "end": "631160"
  },
  {
    "text": "held on the server held theoretically\nelsewhere",
    "start": "631160",
    "end": "633589"
  },
  {
    "text": "ok now the actual thing that is\nreturning an image is a PHP file not an",
    "start": "633590",
    "end": "639290"
  },
  {
    "text": "actual image",
    "start": "639290",
    "end": "640220"
  },
  {
    "text": "ok which also takes the parameter of the cookie which is a bit worrying",
    "start": "640220",
    "end": "643910"
  },
  {
    "text": "alright so when I first went to this\nblog i requested index dot PHP server",
    "start": "643910",
    "end": "648379"
  },
  {
    "text": "started executing this and called the\nsession start function right which went",
    "start": "648380",
    "end": "652550"
  },
  {
    "text": "oh he needs a session cookie and sent me\none",
    "start": "652550",
    "end": "654950"
  },
  {
    "text": "okay in the response so I've then bagged\nthat session cookie and put it in my",
    "start": "654950",
    "end": "657860"
  },
  {
    "text": "browser then when i visit that blog\nagain",
    "start": "657860",
    "end": "660470"
  },
  {
    "text": "I've returned that session cookie to the\nserver to say it's me again yeah",
    "start": "660470",
    "end": "663740"
  },
  {
    "text": "and so if i had if I had some some\npersistence on this blog like I was in the",
    "start": "663740",
    "end": "667250"
  },
  {
    "text": "middle of writing a document it was half\nwritten it would remember who I was now",
    "start": "667250",
    "end": "671630"
  },
  {
    "text": "so this cookie is stored by my browser\nand theoretically the attacker can't get to it",
    "start": "673010",
    "end": "676670"
  },
  {
    "text": "because on my browser and not theirs",
    "start": "676670",
    "end": "678350"
  },
  {
    "text": "alright so what you have to do is trick\nthe browser into sending it back so the order",
    "start": "678350",
    "end": "683240"
  },
  {
    "text": "that things happen are",
    "start": "683240",
    "end": "684920"
  },
  {
    "text": "I then send a index.php request to\nhis blog to look at it",
    "start": "684920",
    "end": "689600"
  },
  {
    "text": "ok it sends him back at a big website\nwith stuff on it including some comments",
    "start": "689600",
    "end": "694519"
  },
  {
    "text": "one of which has a script in it",
    "start": "694520",
    "end": "695720"
  },
  {
    "text": "it that says there's an image here you\nneed okay at this PHP file",
    "start": "695720",
    "end": "701060"
  },
  {
    "text": "ok so I go oh brilliant, and I get my\ndocument.cookie and I send it off to",
    "start": "701060",
    "end": "704449"
  },
  {
    "text": "that PHP file and I get back an image\nand I think nothing's gone wrong but",
    "start": "704449",
    "end": "708199"
  },
  {
    "text": "they've now got my cookie",
    "start": "708199",
    "end": "709220"
  },
  {
    "text": ">>But the cookie went off to the place\nwhere the image was supposedly? and of course this",
    "start": "709220",
    "end": "714050"
  },
  {
    "text": "will return an image but in some cases\nit would return nothing and there will",
    "start": "714050",
    "end": "716990"
  },
  {
    "text": "be no evidence that this happened at all, apart from if you actually looked at the",
    "start": "716990",
    "end": "719810"
  },
  {
    "text": "source code for the file which of course\nyou know someone's going to do but no",
    "start": "719810",
    "end": "723079"
  },
  {
    "text": "one no one normally is going to do so if\nthis got onto a forum or something",
    "start": "723079",
    "end": "726920"
  },
  {
    "text": "lots of people could look at this before\nthey realize what was going on now it's",
    "start": "727519",
    "end": "730639"
  },
  {
    "text": "not unusual for an image to be served by\nscript over by an actual hard link to an",
    "start": "730639",
    "end": "734180"
  },
  {
    "text": "image because for example >>might be an advert or? It might be an advert",
    "start": "734180",
    "end": "738438"
  },
  {
    "text": "dynamically created it could be\ndifferent it could be a resolution",
    "start": "738439",
    "end": "741110"
  },
  {
    "text": "specified in there or you know a good\nlots of different reasons why you do",
    "start": "741110",
    "end": "743720"
  },
  {
    "text": "that",
    "start": "743720",
    "end": "744050"
  },
  {
    "text": "ok so a lot of the time it's going to be\ndynamically generated in some way",
    "start": "744050",
    "end": "747649"
  },
  {
    "text": "so this is no different to that, except that this is also taking a parameter that it",
    "start": "747649",
    "end": "751579"
  },
  {
    "text": "shouldn't be taking ok but I've got no\ncontrol over that and the the browser",
    "start": "751579",
    "end": "756438"
  },
  {
    "text": "it's not that insecure it's just that\nhe's got no reason to doubt me",
    "start": "756439",
    "end": "759680"
  },
  {
    "text": "you know scripts using document dot\ncookies legitimately you know exist and",
    "start": "759680",
    "end": "765170"
  },
  {
    "text": "if you block them then websites start\nto fall down because they use cookies",
    "start": "765170",
    "end": "768470"
  },
  {
    "text": "for persistence",
    "start": "768470",
    "end": "769490"
  },
  {
    "text": "so it's a you know a real problem. Let's click Submit and see what happens",
    "start": "769490",
    "end": "772459"
  },
  {
    "text": ">>so what have you done there you've refreshed it? Yeah & it didn't work, cause I've done it wrong",
    "start": "772459",
    "end": "776089"
  },
  {
    "text": "You know what I didn't type in my name that's\nwhy it didn't work",
    "start": "776089",
    "end": "778399"
  },
  {
    "text": "so Mike right I'll take credit for this\none so we can submit that and then we run it",
    "start": "778399",
    "end": "783500"
  },
  {
    "text": "ok and we scroll down and we got a Cookie Monster picture so kindly submit cookie",
    "start": "783500",
    "end": "788029"
  },
  {
    "text": "dot PHP has taken my cookie and returned\nan image",
    "start": "788029",
    "end": "791779"
  },
  {
    "text": "ok now it's not unusual for people to\nhave images on comments or on forum",
    "start": "791779",
    "end": "796040"
  },
  {
    "text": "posts and things so people have seen\nthis image apart from the fact that it's the",
    "start": "796040",
    "end": "799250"
  },
  {
    "text": "cookie monster might not realize what\njust happened",
    "start": "799250",
    "end": "802730"
  },
  {
    "text": "ok it's completely silent it's happened\nbehind the scenes. All that's happened is they",
    "start": "802730",
    "end": "806750"
  },
  {
    "text": "just quickly whipped their cookie off to someone\nelse and returned an image",
    "start": "806750",
    "end": "809540"
  },
  {
    "text": "ok these kind of request for images happen\nall the time it's just this one's got a",
    "start": "809540",
    "end": "813378"
  },
  {
    "text": "cookie on it and that's bad news. As an attacker, this is my database and I select",
    "start": "813379",
    "end": "817370"
  },
  {
    "text": "* from evil which is the name of my\ntable that's registering the cookie",
    "start": "817370",
    "end": "822529"
  },
  {
    "text": "you can see what my session cookie now\nphpsessid",
    "start": "822529",
    "end": "825529"
  },
  {
    "text": "it's stuck in here so that's the session\ncookie for that session of PHP now in",
    "start": "826130",
    "end": "831290"
  },
  {
    "text": "this blog that doesn't have much effect\nright firstly because i already have",
    "start": "831290",
    "end": "834470"
  },
  {
    "text": "this cookie but mostly because there\nisn't anything on this blog that having a",
    "start": "834470",
    "end": "838129"
  },
  {
    "text": "cookie will help with right. It won't let\nyou get to my basket or get to my credit",
    "start": "838130",
    "end": "841640"
  },
  {
    "text": "card details or login",
    "start": "841640",
    "end": "842900"
  },
  {
    "text": "ok but if you did this on a website\nwhere there was shopping involved or",
    "start": "842900",
    "end": "848300"
  },
  {
    "text": "money involved or banking website and if\nnot properly coded it getting that",
    "start": "848300",
    "end": "852080"
  },
  {
    "text": "session cookie could trick the bank into\nthinking that you're resuming their session",
    "start": "852080",
    "end": "856220"
  },
  {
    "text": "you know they could get so much\ndistance into let's say a transaction",
    "start": "856220",
    "end": "859879"
  },
  {
    "text": "then you could steal their session go in\nand just change the bank account details",
    "start": "859880",
    "end": "863270"
  },
  {
    "text": "to yours right",
    "start": "863270",
    "end": "864800"
  },
  {
    "text": "the bank doesn't really have any idea of\nknowing that people's session cookies",
    "start": "864800",
    "end": "869360"
  },
  {
    "text": "are the only thing that really tie them\nto that that thing to that website",
    "start": "869360",
    "end": "875060"
  },
  {
    "text": "I mean you can do more and complicated\nthings like you can you can pin IPs",
    "start": "875060",
    "end": "879680"
  },
  {
    "text": "to session cookies for example right but\npeople's IPs change",
    "start": "879680",
    "end": "883250"
  },
  {
    "text": "ok they might move from one Wi-Fi area\nto another their IP changes do you",
    "start": "883250",
    "end": "887750"
  },
  {
    "text": "necessarily want them to have to re-authenticate",
    "start": "887750",
    "end": "890000"
  },
  {
    "text": "perhaps you do for security right but it\ndepends on the way website is developed",
    "start": "890000",
    "end": "893870"
  },
  {
    "text": "this is sort of a prime example of a\ntime of check to time of use issue",
    "start": "893870",
    "end": "897230"
  },
  {
    "text": "ok which is a security term which is\nbasically the idea of something changing",
    "start": "897230",
    "end": "902089"
  },
  {
    "text": "between when someone authenticates and\nwhen they do something and causing a",
    "start": "902090",
    "end": "904970"
  },
  {
    "text": "security problem so i type in the\nusername password on Amazon right then",
    "start": "904970",
    "end": "909410"
  },
  {
    "text": "ten minutes later I've wandered off\nsomeone else turns up and spends all my",
    "start": "909410",
    "end": "913490"
  },
  {
    "text": "money",
    "start": "913490",
    "end": "913820"
  },
  {
    "text": "shipping stuff to their address ok now\nthat would be a problem",
    "start": "913820",
    "end": "916820"
  },
  {
    "text": "so what Amazon does is, they force me to reauthenticate just before I actually",
    "start": "916820",
    "end": "920510"
  },
  {
    "text": "type in my details",
    "start": "920510",
    "end": "922010"
  },
  {
    "text": "ok right before you transact you can add loads of stuff to my basket",
    "start": "922010",
    "end": "925190"
  },
  {
    "text": "without having to authenticate myself",
    "start": "925190",
    "end": "928310"
  },
  {
    "text": "it's remember that from last time but as\nsoon as I actually have to do anything",
    "start": "928310",
    "end": "931400"
  },
  {
    "text": "proper like spending any money",
    "start": "931400",
    "end": "933890"
  },
  {
    "text": "it's going to ask me for my credentials\nagain same with online banking if i use",
    "start": "933890",
    "end": "937160"
  },
  {
    "text": "my bank if I log into my online banking\ni use some kind of chip & pin device to",
    "start": "937160",
    "end": "941660"
  },
  {
    "text": "authenticate myself that lets me the\nfirst time",
    "start": "941660",
    "end": "944540"
  },
  {
    "text": "it lets me see my bank balances if i\nwant to send any money its going to ask",
    "start": "944540",
    "end": "948079"
  },
  {
    "text": "me again because they can't risk me\nwandering off by mistake leaving that",
    "start": "948080",
    "end": "952760"
  },
  {
    "text": "browser open",
    "start": "952760",
    "end": "953710"
  },
  {
    "text": "or someone having stole my cookie",
    "start": "953710",
    "end": "956710"
  },
  {
    "text": "We keep carving away at this and what we'll end up with is something that looks nearly like a cube so",
    "start": "958060",
    "end": "962020"
  },
  {
    "text": "we probably may be a bit of extra there\nand a bit of extra there and there but",
    "start": "962020",
    "end": "965770"
  },
  {
    "text": "we'll get it we're getting there",
    "start": "965770",
    "end": "967270"
  },
  {
    "text": "ok now some objects obviously a more\namenable to this than others but the more",
    "start": "967270",
    "end": "970600"
  },
  {
    "text": "images we get the better it is",
    "start": "970600",
    "end": "971649"
  }
]