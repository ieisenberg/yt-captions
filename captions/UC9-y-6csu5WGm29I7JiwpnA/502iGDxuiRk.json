[
  {
    "text": "i wanted to talk about psychic",
    "start": "0",
    "end": "1439"
  },
  {
    "text": "signatures you know",
    "start": "1439",
    "end": "3199"
  },
  {
    "text": "signatures digital signatures that just",
    "start": "3199",
    "end": "4799"
  },
  {
    "text": "get you in any door right that's the",
    "start": "4799",
    "end": "6560"
  },
  {
    "text": "idea it's called psychopath it's out",
    "start": "6560",
    "end": "8480"
  },
  {
    "text": "it's after doctor who isn't it right so",
    "start": "8480",
    "end": "9840"
  },
  {
    "text": "it's been a while since i've watched",
    "start": "9840",
    "end": "10880"
  },
  {
    "text": "doctor who but the idea is that doctor",
    "start": "10880",
    "end": "13280"
  },
  {
    "text": "who keeps showing people this blank",
    "start": "13280",
    "end": "14880"
  },
  {
    "text": "piece of paper and it's psychic paper",
    "start": "14880",
    "end": "16640"
  },
  {
    "text": "which means that they see some",
    "start": "16640",
    "end": "17920"
  },
  {
    "text": "identification that means something to",
    "start": "17920",
    "end": "19439"
  },
  {
    "text": "them and that's the idea you provide a",
    "start": "19439",
    "end": "21600"
  },
  {
    "text": "signature",
    "start": "21600",
    "end": "22800"
  },
  {
    "text": "that is invalid but the java",
    "start": "22800",
    "end": "25599"
  },
  {
    "text": "implementation thinks it's valid and",
    "start": "25599",
    "end": "27199"
  },
  {
    "text": "lets it in right and that's a really",
    "start": "27199",
    "end": "28960"
  },
  {
    "text": "really big problem",
    "start": "28960",
    "end": "31840"
  },
  {
    "text": "a security researcher called neil madden",
    "start": "32960",
    "end": "35040"
  },
  {
    "text": "has",
    "start": "35040",
    "end": "36160"
  },
  {
    "text": "disclosed the vulnerability in some of",
    "start": "36160",
    "end": "37840"
  },
  {
    "text": "the implementations of java that is very",
    "start": "37840",
    "end": "40239"
  },
  {
    "text": "very serious",
    "start": "40239",
    "end": "41600"
  },
  {
    "text": "it basically allows you to approach a",
    "start": "41600",
    "end": "43680"
  },
  {
    "text": "website with a fake signature and be let",
    "start": "43680",
    "end": "45840"
  },
  {
    "text": "straight in right and you know these are",
    "start": "45840",
    "end": "48079"
  },
  {
    "text": "used for things like one-time",
    "start": "48079",
    "end": "49600"
  },
  {
    "text": "authentication mechanisms they're used",
    "start": "49600",
    "end": "51840"
  },
  {
    "text": "for um java web tokens lots of reasons",
    "start": "51840",
    "end": "55600"
  },
  {
    "text": "to be using this kind of technology",
    "start": "55600",
    "end": "56960"
  },
  {
    "text": "there's nothing wrong with it but if",
    "start": "56960",
    "end": "58320"
  },
  {
    "text": "it's not implemented correctly can cause",
    "start": "58320",
    "end": "60000"
  },
  {
    "text": "a real problem this was a bug introduced",
    "start": "60000",
    "end": "62079"
  },
  {
    "text": "in java 15 and has existed up to java 18",
    "start": "62079",
    "end": "65280"
  },
  {
    "text": "and it's now been patched right so if",
    "start": "65280",
    "end": "66880"
  },
  {
    "text": "you run any kind of java server you need",
    "start": "66880",
    "end": "69040"
  },
  {
    "text": "to be patching really really quite",
    "start": "69040",
    "end": "70799"
  },
  {
    "text": "quickly this is quite a serious serious",
    "start": "70799",
    "end": "72640"
  },
  {
    "text": "bug it was introduced when they ported",
    "start": "72640",
    "end": "74479"
  },
  {
    "text": "the code from c plus plus to java and",
    "start": "74479",
    "end": "76960"
  },
  {
    "text": "essentially did a slightly botched",
    "start": "76960",
    "end": "78799"
  },
  {
    "text": "implementation where they didn't perform",
    "start": "78799",
    "end": "80720"
  },
  {
    "text": "some of the necessary checks in the",
    "start": "80720",
    "end": "82560"
  },
  {
    "text": "elliptic curve digital signature",
    "start": "82560",
    "end": "84320"
  },
  {
    "text": "algorithm right that's the algorithm at",
    "start": "84320",
    "end": "86000"
  },
  {
    "text": "play here so it's the elliptic curve",
    "start": "86000",
    "end": "88640"
  },
  {
    "text": "digital signature algorithm now we've",
    "start": "88640",
    "end": "90799"
  },
  {
    "text": "done elliptic curves before very very",
    "start": "90799",
    "end": "92640"
  },
  {
    "text": "briefly just to remind everyone your",
    "start": "92640",
    "end": "94479"
  },
  {
    "text": "elliptic curve on a set of real numbers",
    "start": "94479",
    "end": "96240"
  },
  {
    "text": "would look something like this it looks",
    "start": "96240",
    "end": "97680"
  },
  {
    "text": "slightly different when you're modulo",
    "start": "97680",
    "end": "99439"
  },
  {
    "text": "some large prime and the idea is that",
    "start": "99439",
    "end": "101600"
  },
  {
    "text": "you can add points together on this",
    "start": "101600",
    "end": "103119"
  },
  {
    "text": "curve so you can take a point here let's",
    "start": "103119",
    "end": "104560"
  },
  {
    "text": "say g",
    "start": "104560",
    "end": "105600"
  },
  {
    "text": "and then you can add g to itself to",
    "start": "105600",
    "end": "107360"
  },
  {
    "text": "itself again to itself again and end up",
    "start": "107360",
    "end": "109119"
  },
  {
    "text": "somewhere over here with point a",
    "start": "109119",
    "end": "112000"
  },
  {
    "text": "times by g so that's g plus g plus g",
    "start": "112000",
    "end": "114000"
  },
  {
    "text": "plus g a times and the the interesting",
    "start": "114000",
    "end": "116880"
  },
  {
    "text": "thing about elliptic curve is when you",
    "start": "116880",
    "end": "118159"
  },
  {
    "text": "do this it's very difficult to say what",
    "start": "118159",
    "end": "120079"
  },
  {
    "text": "a was right if i say here's a g",
    "start": "120079",
    "end": "123119"
  },
  {
    "text": "here's g",
    "start": "123119",
    "end": "124240"
  },
  {
    "text": "what was a you don't know right and so a",
    "start": "124240",
    "end": "126640"
  },
  {
    "text": "can be my private key an elliptic curve",
    "start": "126640",
    "end": "128800"
  },
  {
    "text": "dsa is based around this idea right i",
    "start": "128800",
    "end": "131599"
  },
  {
    "text": "could give you a message and you could",
    "start": "131599",
    "end": "133360"
  },
  {
    "text": "use your private key to sign that",
    "start": "133360",
    "end": "135040"
  },
  {
    "text": "message and send me back a signature and",
    "start": "135040",
    "end": "137200"
  },
  {
    "text": "then i could look at the message i could",
    "start": "137200",
    "end": "138400"
  },
  {
    "text": "look at the signature and i could go yep",
    "start": "138400",
    "end": "140560"
  },
  {
    "text": "or no",
    "start": "140560",
    "end": "141440"
  },
  {
    "text": "that's the idea we'll look at elliptic",
    "start": "141440",
    "end": "143360"
  },
  {
    "text": "curve dsa sort of a little brief",
    "start": "143360",
    "end": "144800"
  },
  {
    "text": "overview right we're not going to prove",
    "start": "144800",
    "end": "146800"
  },
  {
    "text": "any mathematics here today um but",
    "start": "146800",
    "end": "150000"
  },
  {
    "text": "just so we can talk about what the",
    "start": "150000",
    "end": "151200"
  },
  {
    "text": "actual implementation",
    "start": "151200",
    "end": "152640"
  },
  {
    "text": "bag in java is and then we can talk",
    "start": "152640",
    "end": "154239"
  },
  {
    "text": "about how that actually manifests itself",
    "start": "154239",
    "end": "156319"
  },
  {
    "text": "if someone was actually attacking a",
    "start": "156319",
    "end": "157519"
  },
  {
    "text": "system we're going to use two people",
    "start": "157519",
    "end": "159360"
  },
  {
    "text": "having a conversation",
    "start": "159360",
    "end": "160879"
  },
  {
    "text": "cryptographically",
    "start": "160879",
    "end": "162319"
  },
  {
    "text": "got to be alice and bob right let's not",
    "start": "162319",
    "end": "164160"
  },
  {
    "text": "i'm not going to be that person to step",
    "start": "164160",
    "end": "165840"
  },
  {
    "text": "step outside the mold um right now bob",
    "start": "165840",
    "end": "168400"
  },
  {
    "text": "is the one that's going to be signing",
    "start": "168400",
    "end": "169519"
  },
  {
    "text": "something to alice so bob has previously",
    "start": "169519",
    "end": "171599"
  },
  {
    "text": "calculated a private and a public key",
    "start": "171599",
    "end": "173760"
  },
  {
    "text": "right so he calculates a private key b",
    "start": "173760",
    "end": "176560"
  },
  {
    "text": "which is a random integer right and he",
    "start": "176560",
    "end": "179120"
  },
  {
    "text": "also has a curve right the curve says he",
    "start": "179120",
    "end": "180959"
  },
  {
    "text": "has a curve let's call the curve c big c",
    "start": "180959",
    "end": "183519"
  },
  {
    "text": "and he has n which is his number of",
    "start": "183519",
    "end": "185040"
  },
  {
    "text": "points on a curve now different letters",
    "start": "185040",
    "end": "186959"
  },
  {
    "text": "will be used by different you know if",
    "start": "186959",
    "end": "188319"
  },
  {
    "text": "you've got a look on the wikipedia page",
    "start": "188319",
    "end": "189599"
  },
  {
    "text": "for this they'll use n but if you look",
    "start": "189599",
    "end": "192000"
  },
  {
    "text": "in textbooks they might use q it's not",
    "start": "192000",
    "end": "194400"
  },
  {
    "text": "we're just i'm going to try and be as",
    "start": "194400",
    "end": "195519"
  },
  {
    "text": "consistent as i can on this piece of",
    "start": "195519",
    "end": "197360"
  },
  {
    "text": "paper right so bob calculates an integer",
    "start": "197360",
    "end": "199840"
  },
  {
    "text": "private value b",
    "start": "199840",
    "end": "202080"
  },
  {
    "text": "and then he calculates a public key",
    "start": "202080",
    "end": "204400"
  },
  {
    "text": "which is the generator point",
    "start": "204400",
    "end": "206640"
  },
  {
    "text": "on this curve times by b so capital b",
    "start": "206640",
    "end": "210480"
  },
  {
    "text": "is b g right capital means on the curve",
    "start": "210480",
    "end": "213840"
  },
  {
    "text": "does it um yeah so this would be a this",
    "start": "213840",
    "end": "216000"
  },
  {
    "text": "would be a curve point yeah capitals on",
    "start": "216000",
    "end": "217680"
  },
  {
    "text": "the curve one of the reasons elliptic",
    "start": "217680",
    "end": "218799"
  },
  {
    "text": "curves get a little bit confusing is",
    "start": "218799",
    "end": "220480"
  },
  {
    "text": "because often your private keys and some",
    "start": "220480",
    "end": "222560"
  },
  {
    "text": "of your values are integers and some of",
    "start": "222560",
    "end": "225280"
  },
  {
    "text": "them are points on the curve so g here",
    "start": "225280",
    "end": "227360"
  },
  {
    "text": "is a point on the curve and this b",
    "start": "227360",
    "end": "229360"
  },
  {
    "text": "multiple of g is a point on the curve b",
    "start": "229360",
    "end": "232319"
  },
  {
    "text": "is obviously just an integer actually",
    "start": "232319",
    "end": "233760"
  },
  {
    "text": "this video is not really about dsa in",
    "start": "233760",
    "end": "235599"
  },
  {
    "text": "some sense so i you know we're not going",
    "start": "235599",
    "end": "237280"
  },
  {
    "text": "to go too much in detail about what",
    "start": "237280",
    "end": "238879"
  },
  {
    "text": "everything everything does exactly right",
    "start": "238879",
    "end": "240799"
  },
  {
    "text": "and i'm going to skip over some details",
    "start": "240799",
    "end": "242720"
  },
  {
    "text": "so now let's imagine that alice wants",
    "start": "242720",
    "end": "245360"
  },
  {
    "text": "bob to sign a message so maybe alice",
    "start": "245360",
    "end": "247120"
  },
  {
    "text": "sends bob a message",
    "start": "247120",
    "end": "249280"
  },
  {
    "text": "m right now this message you know could",
    "start": "249280",
    "end": "251280"
  },
  {
    "text": "be a challenge token it could be you",
    "start": "251280",
    "end": "253360"
  },
  {
    "text": "know some documents you need signing it",
    "start": "253360",
    "end": "255519"
  },
  {
    "text": "doesn't really matter for this example",
    "start": "255519",
    "end": "257359"
  },
  {
    "text": "what bob's going to do is now generate a",
    "start": "257359",
    "end": "259040"
  },
  {
    "text": "signature for this message he's going to",
    "start": "259040",
    "end": "260959"
  },
  {
    "text": "first calculate an intermediate value of",
    "start": "260959",
    "end": "264479"
  },
  {
    "text": "the message which is going to hash the",
    "start": "264479",
    "end": "265759"
  },
  {
    "text": "message right into a shortened form",
    "start": "265759",
    "end": "267759"
  },
  {
    "text": "that's z then he's going to choose a",
    "start": "267759",
    "end": "269759"
  },
  {
    "text": "random k",
    "start": "269759",
    "end": "271199"
  },
  {
    "text": "right and that random k is what we call",
    "start": "271199",
    "end": "273360"
  },
  {
    "text": "an ephemeral key we talked about this a",
    "start": "273360",
    "end": "275280"
  },
  {
    "text": "bit with diffie-hellman but k",
    "start": "275280",
    "end": "277759"
  },
  {
    "text": "essentially makes this signature",
    "start": "277759",
    "end": "279440"
  },
  {
    "text": "probabilistic it makes it different each",
    "start": "279440",
    "end": "281280"
  },
  {
    "text": "time bob calculates its signature it's",
    "start": "281280",
    "end": "283199"
  },
  {
    "text": "actually extremely important that k is",
    "start": "283199",
    "end": "285360"
  },
  {
    "text": "random each time and different each time",
    "start": "285360",
    "end": "287280"
  },
  {
    "text": "now this is where the math starts coming",
    "start": "287280",
    "end": "289120"
  },
  {
    "text": "in right we're going to calculate r",
    "start": "289120",
    "end": "291680"
  },
  {
    "text": "right this is the first half of our",
    "start": "291680",
    "end": "293199"
  },
  {
    "text": "signature r",
    "start": "293199",
    "end": "294800"
  },
  {
    "text": "is k times by the generator point so",
    "start": "294800",
    "end": "297840"
  },
  {
    "text": "that's a point on the curve and then",
    "start": "297840",
    "end": "299759"
  },
  {
    "text": "you're just going to take",
    "start": "299759",
    "end": "301840"
  },
  {
    "text": "the x",
    "start": "301840",
    "end": "303039"
  },
  {
    "text": "uh component now what i've done there is",
    "start": "303039",
    "end": "304560"
  },
  {
    "text": "i've mixed mathematical notation with",
    "start": "304560",
    "end": "306320"
  },
  {
    "text": "programming notation and i'm going to",
    "start": "306320",
    "end": "307759"
  },
  {
    "text": "say here no more about that that's",
    "start": "307759",
    "end": "309440"
  },
  {
    "text": "absolutely fine as far as i'm concerned",
    "start": "309440",
    "end": "310960"
  },
  {
    "text": "right and then you calculate the second",
    "start": "310960",
    "end": "312639"
  },
  {
    "text": "part of signature s",
    "start": "312639",
    "end": "314479"
  },
  {
    "text": "right which is k to the minus one so",
    "start": "314479",
    "end": "317280"
  },
  {
    "text": "then the multiplicative inverse of k",
    "start": "317280",
    "end": "319680"
  },
  {
    "text": "multiplied by z plus",
    "start": "319680",
    "end": "322479"
  },
  {
    "text": "r times b and for those who are not",
    "start": "322479",
    "end": "325120"
  },
  {
    "text": "mathematically minded the multiplicative",
    "start": "325120",
    "end": "328240"
  },
  {
    "text": "inverse is one over that is it well it's",
    "start": "328240",
    "end": "330320"
  },
  {
    "text": "so yeah yeah very good very good",
    "start": "330320",
    "end": "332080"
  },
  {
    "text": "question so in normal maths yes right if",
    "start": "332080",
    "end": "334479"
  },
  {
    "text": "you wanted to multiply the",
    "start": "334479",
    "end": "335840"
  },
  {
    "text": "multiplicative inverse of x is one over",
    "start": "335840",
    "end": "337680"
  },
  {
    "text": "x",
    "start": "337680",
    "end": "338560"
  },
  {
    "text": "when you're doing modulo n which is what",
    "start": "338560",
    "end": "340479"
  },
  {
    "text": "we're doing on this elliptic curve you",
    "start": "340479",
    "end": "342800"
  },
  {
    "text": "actually have to calculate the",
    "start": "342800",
    "end": "344080"
  },
  {
    "text": "multiplicative inverse it will just be",
    "start": "344080",
    "end": "345120"
  },
  {
    "text": "some other number between one and n",
    "start": "345120",
    "end": "347440"
  },
  {
    "text": "minus one and you could use the extended",
    "start": "347440",
    "end": "349199"
  },
  {
    "text": "euclidean album to do that you can use",
    "start": "349199",
    "end": "351120"
  },
  {
    "text": "uh fermat's theorem to do that um",
    "start": "351120",
    "end": "353600"
  },
  {
    "text": "there's a few ways of calculating this",
    "start": "353600",
    "end": "355520"
  },
  {
    "text": "but it's not immediately obvious what it",
    "start": "355520",
    "end": "356880"
  },
  {
    "text": "is right you can't just say oh it's this",
    "start": "356880",
    "end": "358639"
  },
  {
    "text": "you know you have to we have to",
    "start": "358639",
    "end": "359520"
  },
  {
    "text": "calculate it but we're not going to",
    "start": "359520",
    "end": "360960"
  },
  {
    "text": "worry about that too much bob will then",
    "start": "360960",
    "end": "362720"
  },
  {
    "text": "respond this is it he's finished right",
    "start": "362720",
    "end": "364560"
  },
  {
    "text": "bob will then respond with a met with",
    "start": "364560",
    "end": "366000"
  },
  {
    "text": "the message m yeah i mean maybe alice",
    "start": "366000",
    "end": "368000"
  },
  {
    "text": "already knows it doesn't he said it and",
    "start": "368000",
    "end": "369440"
  },
  {
    "text": "the signature",
    "start": "369440",
    "end": "370800"
  },
  {
    "text": "r",
    "start": "370800",
    "end": "372000"
  },
  {
    "text": "s and this is where alice now has to",
    "start": "372000",
    "end": "374400"
  },
  {
    "text": "verify this signature so we did a video",
    "start": "374400",
    "end": "376160"
  },
  {
    "text": "on digital signatures already but",
    "start": "376160",
    "end": "378560"
  },
  {
    "text": "in this case it's not too difficult for",
    "start": "378560",
    "end": "380720"
  },
  {
    "text": "alice to verify so first of all she",
    "start": "380720",
    "end": "382960"
  },
  {
    "text": "needs to check that r and s",
    "start": "382960",
    "end": "385280"
  },
  {
    "text": "are in the range",
    "start": "385280",
    "end": "387120"
  },
  {
    "text": "one to n minus one right so then she",
    "start": "387120",
    "end": "390240"
  },
  {
    "text": "needs to check that",
    "start": "390240",
    "end": "391600"
  },
  {
    "text": "r and s are both at least one and less",
    "start": "391600",
    "end": "393759"
  },
  {
    "text": "than or equal to n minus one",
    "start": "393759",
    "end": "395840"
  },
  {
    "text": "all right then she's going to calculate",
    "start": "395840",
    "end": "397440"
  },
  {
    "text": "the intermediate hash value of the",
    "start": "397440",
    "end": "399039"
  },
  {
    "text": "message again",
    "start": "399039",
    "end": "400400"
  },
  {
    "text": "all right",
    "start": "400400",
    "end": "401520"
  },
  {
    "text": "and then she's going to calculate a",
    "start": "401520",
    "end": "402960"
  },
  {
    "text": "couple of equations so the first one is",
    "start": "402960",
    "end": "404960"
  },
  {
    "text": "u1",
    "start": "404960",
    "end": "406240"
  },
  {
    "text": "is equal to z times by",
    "start": "406240",
    "end": "408639"
  },
  {
    "text": "s to the minus one",
    "start": "408639",
    "end": "410720"
  },
  {
    "text": "mod n right now it's not important",
    "start": "410720",
    "end": "412720"
  },
  {
    "text": "actually to understand this attack to",
    "start": "412720",
    "end": "414000"
  },
  {
    "text": "understand follow exactly what this math",
    "start": "414000",
    "end": "415520"
  },
  {
    "text": "is doing right because we're going to",
    "start": "415520",
    "end": "416479"
  },
  {
    "text": "talk about the problems that the java",
    "start": "416479",
    "end": "418639"
  },
  {
    "text": "implementation has u2 is equal to r",
    "start": "418639",
    "end": "422319"
  },
  {
    "text": "times s to the minus 1",
    "start": "422319",
    "end": "424400"
  },
  {
    "text": "mod n again right everything's mod n so",
    "start": "424400",
    "end": "427280"
  },
  {
    "text": "again we'd use the same algorithm we",
    "start": "427280",
    "end": "428720"
  },
  {
    "text": "used for k minus 1 on s minus 1 to get",
    "start": "428720",
    "end": "430800"
  },
  {
    "text": "the multiplicative inverse of s and then",
    "start": "430800",
    "end": "432560"
  },
  {
    "text": "this is the actual test alice needs to",
    "start": "432560",
    "end": "434800"
  },
  {
    "text": "check that r is equal to or congruent to",
    "start": "434800",
    "end": "438720"
  },
  {
    "text": "u1 times by the generator point g",
    "start": "438720",
    "end": "443120"
  },
  {
    "text": "plus u2",
    "start": "443120",
    "end": "445120"
  },
  {
    "text": "times by bob's public key capital b",
    "start": "445120",
    "end": "448880"
  },
  {
    "text": "and then just the x coordinate for those",
    "start": "448880",
    "end": "451599"
  },
  {
    "text": "of you thinking well how does that work",
    "start": "451599",
    "end": "453440"
  },
  {
    "text": "right",
    "start": "453440",
    "end": "454319"
  },
  {
    "text": "that involves the proof okay it's very",
    "start": "454319",
    "end": "456400"
  },
  {
    "text": "very clever but we won't write that out",
    "start": "456400",
    "end": "458560"
  },
  {
    "text": "because that's not really what this",
    "start": "458560",
    "end": "459520"
  },
  {
    "text": "video is about alice's process of",
    "start": "459520",
    "end": "461039"
  },
  {
    "text": "verifying the signature basically if she",
    "start": "461039",
    "end": "462960"
  },
  {
    "text": "takes m and the pair the signature pair",
    "start": "462960",
    "end": "465599"
  },
  {
    "text": "r and s and calculates this equation and",
    "start": "465599",
    "end": "468639"
  },
  {
    "text": "if the two sides match then this is",
    "start": "468639",
    "end": "470639"
  },
  {
    "text": "sorry this is mod n",
    "start": "470639",
    "end": "472400"
  },
  {
    "text": "and mods that thing where it's a bit",
    "start": "472400",
    "end": "474160"
  },
  {
    "text": "like a clock face yeah it's a clock face",
    "start": "474160",
    "end": "475759"
  },
  {
    "text": "so if you divide by n and you take the",
    "start": "475759",
    "end": "477440"
  },
  {
    "text": "remainder right so n mod n is back to",
    "start": "477440",
    "end": "480080"
  },
  {
    "text": "zero again right and n plus one mod n is",
    "start": "480080",
    "end": "483199"
  },
  {
    "text": "one you know um now",
    "start": "483199",
    "end": "486720"
  },
  {
    "text": "just just to not completely skip over",
    "start": "486720",
    "end": "488639"
  },
  {
    "text": "what ecdsa is doing here",
    "start": "488639",
    "end": "490960"
  },
  {
    "text": "how does alice know that bob signed this",
    "start": "490960",
    "end": "492639"
  },
  {
    "text": "message right well basically because the",
    "start": "492639",
    "end": "494720"
  },
  {
    "text": "fact that this works means that bob must",
    "start": "494720",
    "end": "496800"
  },
  {
    "text": "have been in control of the private key",
    "start": "496800",
    "end": "499280"
  },
  {
    "text": "b right because it was used as part of",
    "start": "499280",
    "end": "501280"
  },
  {
    "text": "this equation the other thing is that u1",
    "start": "501280",
    "end": "504639"
  },
  {
    "text": "and u2 include both parts of the",
    "start": "504639",
    "end": "506560"
  },
  {
    "text": "signature and the hash of the message so",
    "start": "506560",
    "end": "509039"
  },
  {
    "text": "it's also checking that the signature",
    "start": "509039",
    "end": "510560"
  },
  {
    "text": "matches the message which is very very",
    "start": "510560",
    "end": "512399"
  },
  {
    "text": "important so alice knows if this is true",
    "start": "512399",
    "end": "515440"
  },
  {
    "text": "if the left hand side equals the right",
    "start": "515440",
    "end": "517120"
  },
  {
    "text": "hand side alice knows that not only does",
    "start": "517120",
    "end": "520640"
  },
  {
    "text": "this signature match this message but",
    "start": "520640",
    "end": "521919"
  },
  {
    "text": "also it was bob that signed it right as",
    "start": "521919",
    "end": "523599"
  },
  {
    "text": "long as no one's stolen bob's private",
    "start": "523599",
    "end": "525040"
  },
  {
    "text": "key it's a different video for a",
    "start": "525040",
    "end": "526080"
  },
  {
    "text": "different time",
    "start": "526080",
    "end": "527360"
  },
  {
    "text": "all right now what's wrong with the java",
    "start": "527360",
    "end": "530080"
  },
  {
    "text": "implementation well one of the problems",
    "start": "530080",
    "end": "531920"
  },
  {
    "text": "with ecdsa that you have to be careful",
    "start": "531920",
    "end": "534240"
  },
  {
    "text": "if you're implementing it",
    "start": "534240",
    "end": "535680"
  },
  {
    "text": "is for example i mentioned you have to",
    "start": "535680",
    "end": "537600"
  },
  {
    "text": "choose a random k you can't choose a",
    "start": "537600",
    "end": "539120"
  },
  {
    "text": "cave that's been used before right so",
    "start": "539120",
    "end": "540880"
  },
  {
    "text": "actually",
    "start": "540880",
    "end": "542000"
  },
  {
    "text": "a truly random k could be a bit risky",
    "start": "542000",
    "end": "544000"
  },
  {
    "text": "because you might accidentally generate",
    "start": "544000",
    "end": "545200"
  },
  {
    "text": "the same one twice so sometimes they",
    "start": "545200",
    "end": "546959"
  },
  {
    "text": "have ways of deterministically",
    "start": "546959",
    "end": "548880"
  },
  {
    "text": "generating k such that you can be",
    "start": "548880",
    "end": "550640"
  },
  {
    "text": "absolutely sure you never repeat it",
    "start": "550640",
    "end": "552560"
  },
  {
    "text": "right",
    "start": "552560",
    "end": "553680"
  },
  {
    "text": "another big problem is if you don't do",
    "start": "553680",
    "end": "555440"
  },
  {
    "text": "this check in here i'm going to i'm",
    "start": "555440",
    "end": "556800"
  },
  {
    "text": "going to put this in red this is very",
    "start": "556800",
    "end": "558880"
  },
  {
    "text": "important right but you check this",
    "start": "558880",
    "end": "561440"
  },
  {
    "text": "if r and s are not in the range one to n",
    "start": "561440",
    "end": "564320"
  },
  {
    "text": "minus one you can't guarantee the",
    "start": "564320",
    "end": "565920"
  },
  {
    "text": "security of this scheme in this",
    "start": "565920",
    "end": "567440"
  },
  {
    "text": "particular attack",
    "start": "567440",
    "end": "569040"
  },
  {
    "text": "the issue is that java doesn't check but",
    "start": "569040",
    "end": "571440"
  },
  {
    "text": "rns are both not zero",
    "start": "571440",
    "end": "573680"
  },
  {
    "text": "right that's a real problem so let's",
    "start": "573680",
    "end": "575519"
  },
  {
    "text": "work through what would happen if r and",
    "start": "575519",
    "end": "576800"
  },
  {
    "text": "s was zero well the hash comes out",
    "start": "576800",
    "end": "579200"
  },
  {
    "text": "exactly the same z is the hash of m",
    "start": "579200",
    "end": "581519"
  },
  {
    "text": "right u1 is that hash multiplied by the",
    "start": "581519",
    "end": "584560"
  },
  {
    "text": "multiplicative inverse of s which is",
    "start": "584560",
    "end": "587040"
  },
  {
    "text": "zero multiplied versus zero now that",
    "start": "587040",
    "end": "590160"
  },
  {
    "text": "that mathematically doesn't actually",
    "start": "590160",
    "end": "591440"
  },
  {
    "text": "exist but",
    "start": "591440",
    "end": "593040"
  },
  {
    "text": "it does in this case because the java",
    "start": "593040",
    "end": "594320"
  },
  {
    "text": "implementation happens to just spit zero",
    "start": "594320",
    "end": "596000"
  },
  {
    "text": "back out at you right so",
    "start": "596000",
    "end": "598240"
  },
  {
    "text": "it is z times zero is zero right u2",
    "start": "598240",
    "end": "602160"
  },
  {
    "text": "is r which is zero times by s minus one",
    "start": "602160",
    "end": "605360"
  },
  {
    "text": "which is zero",
    "start": "605360",
    "end": "606640"
  },
  {
    "text": "is zero all right so we've got zero and",
    "start": "606640",
    "end": "608560"
  },
  {
    "text": "zero and zero times g plus zero times u",
    "start": "608560",
    "end": "612640"
  },
  {
    "text": "both of those are unfortunately the",
    "start": "612640",
    "end": "614160"
  },
  {
    "text": "point of infinity which is essentially",
    "start": "614160",
    "end": "615839"
  },
  {
    "text": "zero on this curve the x coordinate of",
    "start": "615839",
    "end": "617760"
  },
  {
    "text": "that is zero",
    "start": "617760",
    "end": "618880"
  },
  {
    "text": "it's zero equals zero question mark and",
    "start": "618880",
    "end": "622079"
  },
  {
    "text": "that's the test that alice will perform",
    "start": "622079",
    "end": "624320"
  },
  {
    "text": "to decide whether this signature is",
    "start": "624320",
    "end": "625680"
  },
  {
    "text": "valid and it is because zero does indeed",
    "start": "625680",
    "end": "628079"
  },
  {
    "text": "equal zero as far as i can see i can see",
    "start": "628079",
    "end": "630240"
  },
  {
    "text": "i haven't noticed anything wrong with",
    "start": "630240",
    "end": "631839"
  },
  {
    "text": "that um",
    "start": "631839",
    "end": "633920"
  },
  {
    "text": "so let's talk a bit about",
    "start": "633920",
    "end": "636240"
  },
  {
    "text": "you know let's let's move away from the",
    "start": "636240",
    "end": "637360"
  },
  {
    "text": "map and let's talk a little bit about",
    "start": "637360",
    "end": "638640"
  },
  {
    "text": "what practically this means right",
    "start": "638640",
    "end": "640959"
  },
  {
    "text": "essentially this is an implementation",
    "start": "640959",
    "end": "642480"
  },
  {
    "text": "bug this is very clearly defined in the",
    "start": "642480",
    "end": "644880"
  },
  {
    "text": "spec that you make this test you also",
    "start": "644880",
    "end": "647040"
  },
  {
    "text": "have to check that this is not the point",
    "start": "647040",
    "end": "648399"
  },
  {
    "text": "of infinity right there's two checks",
    "start": "648399",
    "end": "649839"
  },
  {
    "text": "that you have to make here and they have",
    "start": "649839",
    "end": "651360"
  },
  {
    "text": "not been made so as you say this is",
    "start": "651360",
    "end": "653279"
  },
  {
    "text": "implementation so that basically means",
    "start": "653279",
    "end": "655120"
  },
  {
    "text": "that the theory sounds but it's not",
    "start": "655120",
    "end": "657279"
  },
  {
    "text": "being put into practice right what's the",
    "start": "657279",
    "end": "659519"
  },
  {
    "text": "implication here what actually happens",
    "start": "659519",
    "end": "661680"
  },
  {
    "text": "in reality it's it's really serious",
    "start": "661680",
    "end": "663839"
  },
  {
    "text": "right this kind of technique is used all",
    "start": "663839",
    "end": "665360"
  },
  {
    "text": "over the place on the web but it's used",
    "start": "665360",
    "end": "667040"
  },
  {
    "text": "in a couple of core authentication",
    "start": "667040",
    "end": "668560"
  },
  {
    "text": "mechanisms which is where this is the",
    "start": "668560",
    "end": "669920"
  },
  {
    "text": "real problem like immediately right it's",
    "start": "669920",
    "end": "671760"
  },
  {
    "text": "a problem everywhere things like banks",
    "start": "671760",
    "end": "674000"
  },
  {
    "text": "well yeah it could be used by banks to",
    "start": "674000",
    "end": "675519"
  },
  {
    "text": "you know verify messages from other",
    "start": "675519",
    "end": "676720"
  },
  {
    "text": "banks for example you don't want a",
    "start": "676720",
    "end": "678240"
  },
  {
    "text": "situation where a bank can send a",
    "start": "678240",
    "end": "679760"
  },
  {
    "text": "transaction signed by xeros and it be",
    "start": "679760",
    "end": "682640"
  },
  {
    "text": "accepted and you know i mean maybe he's",
    "start": "682640",
    "end": "684800"
  },
  {
    "text": "an attacker i might quite like that",
    "start": "684800",
    "end": "686560"
  },
  {
    "text": "um but you know another example is one",
    "start": "686560",
    "end": "688800"
  },
  {
    "text": "of these you know one-time um password",
    "start": "688800",
    "end": "690880"
  },
  {
    "text": "or login two-factor authentication",
    "start": "690880",
    "end": "692640"
  },
  {
    "text": "devices so for example i have one um one",
    "start": "692640",
    "end": "694880"
  },
  {
    "text": "of these ubi keys like there are lots of",
    "start": "694880",
    "end": "696399"
  },
  {
    "text": "devices like this",
    "start": "696399",
    "end": "698000"
  },
  {
    "text": "and what they often will do is they will",
    "start": "698000",
    "end": "700480"
  },
  {
    "text": "respond to a challenge from the server",
    "start": "700480",
    "end": "703360"
  },
  {
    "text": "by signing something with the private",
    "start": "703360",
    "end": "705279"
  },
  {
    "text": "key using elliptic curve dsa so suppose",
    "start": "705279",
    "end": "707760"
  },
  {
    "text": "there's a server here",
    "start": "707760",
    "end": "709760"
  },
  {
    "text": "and here's me with my key",
    "start": "709760",
    "end": "712720"
  },
  {
    "text": "that's the world's worst key isn't it",
    "start": "712720",
    "end": "714160"
  },
  {
    "text": "and what happens is the server sends a",
    "start": "714160",
    "end": "716079"
  },
  {
    "text": "challenge",
    "start": "716079",
    "end": "717440"
  },
  {
    "text": "challenge",
    "start": "717440",
    "end": "718720"
  },
  {
    "text": "m",
    "start": "718720",
    "end": "719360"
  },
  {
    "text": "and i",
    "start": "719360",
    "end": "720480"
  },
  {
    "text": "sign that challenge using elliptic curve",
    "start": "720480",
    "end": "722480"
  },
  {
    "text": "dsa",
    "start": "722480",
    "end": "723600"
  },
  {
    "text": "and i send back m",
    "start": "723600",
    "end": "725839"
  },
  {
    "text": "and r s right now the server will verify",
    "start": "725839",
    "end": "729200"
  },
  {
    "text": "against my public key and that would",
    "start": "729200",
    "end": "730639"
  },
  {
    "text": "have been the first time i registered my",
    "start": "730639",
    "end": "732079"
  },
  {
    "text": "device so maybe at some point i logged",
    "start": "732079",
    "end": "734000"
  },
  {
    "text": "on to the system and said i'd like to",
    "start": "734000",
    "end": "735279"
  },
  {
    "text": "register one of these devices i plugged",
    "start": "735279",
    "end": "737120"
  },
  {
    "text": "it in and it went great your device is",
    "start": "737120",
    "end": "738800"
  },
  {
    "text": "registered you can now use it for",
    "start": "738800",
    "end": "740399"
  },
  {
    "text": "two-factor authentication what will then",
    "start": "740399",
    "end": "742560"
  },
  {
    "text": "happen is the server will verify this",
    "start": "742560",
    "end": "745519"
  },
  {
    "text": "signature against the challenge message",
    "start": "745519",
    "end": "748800"
  },
  {
    "text": "and check whether it's correct right now",
    "start": "748800",
    "end": "750720"
  },
  {
    "text": "the reason it has to send a challenge",
    "start": "750720",
    "end": "752079"
  },
  {
    "text": "message is because of course otherwise i",
    "start": "752079",
    "end": "754320"
  },
  {
    "text": "could just send this all the time right",
    "start": "754320",
    "end": "755920"
  },
  {
    "text": "if it always sent the same message like",
    "start": "755920",
    "end": "757920"
  },
  {
    "text": "sign the number five then everyone will",
    "start": "757920",
    "end": "760639"
  },
  {
    "text": "just get a copy of that valid signature",
    "start": "760639",
    "end": "762399"
  },
  {
    "text": "and just send it on and pretend to be me",
    "start": "762399",
    "end": "764000"
  },
  {
    "text": "so it has to be random each time but the",
    "start": "764000",
    "end": "766240"
  },
  {
    "text": "issue here is that an attacker can just",
    "start": "766240",
    "end": "767920"
  },
  {
    "text": "send m",
    "start": "767920",
    "end": "770079"
  },
  {
    "text": "zero zero right and if this server is",
    "start": "770079",
    "end": "772800"
  },
  {
    "text": "implemented in java versions 15 to 18 it",
    "start": "772800",
    "end": "776240"
  },
  {
    "text": "will go yep brilliant and let and let",
    "start": "776240",
    "end": "777920"
  },
  {
    "text": "you log in right so literally",
    "start": "777920",
    "end": "780000"
  },
  {
    "text": "you just take this and you just write",
    "start": "780000",
    "end": "781760"
  },
  {
    "text": "zero",
    "start": "781760",
    "end": "782800"
  },
  {
    "text": "zero and then you can just start waving",
    "start": "782800",
    "end": "785120"
  },
  {
    "text": "your way through different different",
    "start": "785120",
    "end": "787200"
  },
  {
    "text": "servers right and no no questions asked",
    "start": "787200",
    "end": "790079"
  },
  {
    "text": "so you know if you're running a java",
    "start": "790079",
    "end": "791760"
  },
  {
    "text": "server i can't stress enough that you",
    "start": "791760",
    "end": "793200"
  },
  {
    "text": "really need to be patching it",
    "start": "793200",
    "end": "795040"
  },
  {
    "text": "um before this video began but really",
    "start": "795040",
    "end": "797440"
  },
  {
    "text": "get on with it now",
    "start": "797440",
    "end": "798720"
  },
  {
    "text": "3g plus g",
    "start": "798720",
    "end": "800720"
  },
  {
    "text": "would be it goes along here like this",
    "start": "800720",
    "end": "803279"
  },
  {
    "text": "intersects the curve somewhere else",
    "start": "803279",
    "end": "804959"
  },
  {
    "text": "flips over and it's over here so this is",
    "start": "804959",
    "end": "806639"
  },
  {
    "text": "4g now we won't look at it anymore right",
    "start": "806639",
    "end": "809279"
  },
  {
    "text": "the actual formula for this is just",
    "start": "809279",
    "end": "810800"
  },
  {
    "text": "mathematics to do with line and when",
    "start": "810800",
    "end": "812800"
  },
  {
    "text": "that space what it's doing is it's",
    "start": "812800",
    "end": "814240"
  },
  {
    "text": "looking for extra areas where it can add",
    "start": "814240",
    "end": "816000"
  },
  {
    "text": "the nodes to build that graph up",
    "start": "816000",
    "end": "820639"
  }
]