[
  {
    "start": "0",
    "end": "47000"
  },
  {
    "text": "hello everyone I'm Connor Cahill I'm here from the DynamoDB team I'm a security engineer and we're gonna be",
    "start": "30",
    "end": "6839"
  },
  {
    "text": "talking about security so hopefully you'll stay awake hope you hopefully you're all had lunch already and you're",
    "start": "6839",
    "end": "12330"
  },
  {
    "text": "all relaxed and we can we can have some fun the topics I'm going to be talking about are protecting your data at rest",
    "start": "12330",
    "end": "19410"
  },
  {
    "text": "so how what you can do to make sure your data is protected how you can monitor access to your data and what features",
    "start": "19410",
    "end": "25320"
  },
  {
    "text": "you can use and I'll walk through an example of showing how you can alert yourself when certain actions are taking",
    "start": "25320",
    "end": "30720"
  },
  {
    "text": "place controlling access to data and talk about some of the fine-grained permissions controls that we have and",
    "start": "30720",
    "end": "36950"
  },
  {
    "text": "limiting access to your network while you're accessing DynamoDB and how you can use Virtual Private endpoints to",
    "start": "36950",
    "end": "43410"
  },
  {
    "text": "control access so let's look at protecting your data at rest or earlier this year we launched encryption at rest",
    "start": "43410",
    "end": "50070"
  },
  {
    "start": "47000",
    "end": "47000"
  },
  {
    "text": "with AWS as key management service KMS keys and that uses a AWS managed cmk",
    "start": "50070",
    "end": "57420"
  },
  {
    "text": "this is a cmk in your account that is reserved for use by DynamoDB that access",
    "start": "57420",
    "end": "65760"
  },
  {
    "text": "all access using that key is logged in Cloud trail the key comes with a default",
    "start": "65760",
    "end": "71640"
  },
  {
    "text": "iam permission policy on the key itself that you can't modify that it's locked",
    "start": "71640",
    "end": "76740"
  },
  {
    "text": "and it grants permission to all the users and roles within your account by default the access to that key can be",
    "start": "76740",
    "end": "86130"
  },
  {
    "text": "restricted not directly on the key itself but on the I M user policy and I'll walk through an example of how that",
    "start": "86130",
    "end": "91979"
  },
  {
    "text": "can take place and how you could actually block somebody from getting access to the key inadvertently and",
    "start": "91979",
    "end": "98280"
  },
  {
    "text": "another interesting note with this is global secondary indices and dynamodb streams are both protected by the same",
    "start": "98280",
    "end": "105509"
  },
  {
    "text": "encryption model that you have on the table so if you're using a cmk on the table to protect the table your your",
    "start": "105509",
    "end": "111000"
  },
  {
    "text": "GSIS and your streams are both protected and the streams is a new feature that we launched recently as well where streams",
    "start": "111000",
    "end": "117479"
  },
  {
    "text": "are also protected with the same encryption so enable encryption is",
    "start": "117479",
    "end": "122790"
  },
  {
    "start": "121000",
    "end": "121000"
  },
  {
    "text": "pretty simple model if you go to the DynamoDB console and the default settings you go and change the default",
    "start": "122790",
    "end": "129629"
  },
  {
    "text": "settings so that you can turn on the encryption by slips flipping one switch I'll show you how",
    "start": "129629",
    "end": "136320"
  },
  {
    "text": "you can do that with a command line but the result is you'll see that the encryption flag shows us enabled and if",
    "start": "136320",
    "end": "143640"
  },
  {
    "start": "138000",
    "end": "138000"
  },
  {
    "text": "you describe the table you'll see that it tells you that the encryption is enabled and what key is actually being",
    "start": "143640",
    "end": "149100"
  },
  {
    "text": "used to protect that table if you go and look in the kms console you can see that",
    "start": "149100",
    "end": "155370"
  },
  {
    "text": "there's a dynamo DB key and that's the key that the ADA bias managed cmk that's",
    "start": "155370",
    "end": "160650"
  },
  {
    "text": "in your account that we use for accessing and controlling access the one",
    "start": "160650",
    "end": "169380"
  },
  {
    "text": "of the things you can see if you go look at that key you can look at the grants that are on that key and see when you",
    "start": "169380",
    "end": "175500"
  },
  {
    "text": "add a new table to be encrypted with this key we will add a grant that grants dynamodb access so that we can do",
    "start": "175500",
    "end": "182130"
  },
  {
    "text": "backups and we can manage the table itself and so there's a Christian context that's points to what table is",
    "start": "182130",
    "end": "188490"
  },
  {
    "text": "actually encrypted for each key so if you encrypt ten cables you'll see ten different grants in there so that",
    "start": "188490",
    "end": "194340"
  },
  {
    "text": "DynamoDB can access the key when the key is used so when a user goes and accesses",
    "start": "194340",
    "end": "201810"
  },
  {
    "text": "a encrypted table that's protected by the key or when the user creates a new",
    "start": "201810",
    "end": "207209"
  },
  {
    "text": "table you'll see cloud shell logs and in the cloud tray log will identify who did the who took the action will identify",
    "start": "207209",
    "end": "214800"
  },
  {
    "text": "what key was used during that action so this would be your normal standard dynam of the database manage key for dynamodb",
    "start": "214800",
    "end": "221910"
  },
  {
    "text": "will indicate that it's coming from Dinamo's because the user doesn't access the key directly these Atos manage keys",
    "start": "221910",
    "end": "229200"
  },
  {
    "text": "are accessed only through dynamo and so for the for the dynamo key is only",
    "start": "229200",
    "end": "234270"
  },
  {
    "text": "access to dynamo and will tell you what table it was accessed on behalf so you",
    "start": "234270",
    "end": "239790"
  },
  {
    "text": "know who did it what table they did it on what key was used and that it came through dynamo DB",
    "start": "239790",
    "end": "246080"
  },
  {
    "text": "the there are some tricks some edge cases that you have to worry about here",
    "start": "246080",
    "end": "251520"
  },
  {
    "text": "and that one of them is with dynamodb permissions the user actually has to have permissions to at use this key they",
    "start": "251520",
    "end": "257820"
  },
  {
    "text": "do get that permission by default from the key itself so the key policy the KMS key policy grants permissions to access",
    "start": "257820",
    "end": "264060"
  },
  {
    "text": "but the it is possible for you to construct I am policy on a user or role that",
    "start": "264060",
    "end": "269460"
  },
  {
    "text": "denies access and so the we'll walk through an example here I have an",
    "start": "269460",
    "end": "275820"
  },
  {
    "text": "administrator very tightly controlled administrators generating a policy for Jane and on the Jane policy for Jane",
    "start": "275820",
    "end": "282600"
  },
  {
    "text": "they grant full access to DynamoDB so that Jane can manage any DynamoDB",
    "start": "282600",
    "end": "288000"
  },
  {
    "text": "table can call any DynamoDB API this is probably not the most ideal policy you would use on an account but this one",
    "start": "288000",
    "end": "295380"
  },
  {
    "text": "works first for Jane but the administrator wants to really lock things down so they put in a deny",
    "start": "295380",
    "end": "301740"
  },
  {
    "text": "that says nothing else is allowed except for DynamoDB because that's all they",
    "start": "301740",
    "end": "307110"
  },
  {
    "text": "intend for Jane to use and so this seems like it works like it would be a",
    "start": "307110",
    "end": "312120"
  },
  {
    "text": "reasonable policy but when Jane turns around and tries to create a normal table everything works peachy keen",
    "start": "312120",
    "end": "318390"
  },
  {
    "start": "314000",
    "end": "314000"
  },
  {
    "text": "because it that's all she has all the DynamoDB permissions everything works however when she turns around and tries",
    "start": "318390",
    "end": "324750"
  },
  {
    "text": "to create a table with encryption so she turns on she says the sssee",
    "start": "324750",
    "end": "330390"
  },
  {
    "text": "specification and enabled is true so she's turning on encryption she gets an",
    "start": "330390",
    "end": "335910"
  },
  {
    "text": "access denied error right because she needs to be able to access the key through DynamoDB and the policy she had",
    "start": "335910",
    "end": "342690"
  },
  {
    "text": "denied access similarly if she tries to access the table that's not encrypted everything",
    "start": "342690",
    "end": "348360"
  },
  {
    "start": "344000",
    "end": "344000"
  },
  {
    "text": "works peachy keen but if she tries to enable a key I'm sorry it tries to access the table that is encrypted",
    "start": "348360",
    "end": "354810"
  },
  {
    "text": "she'll get another access denied right no what happens here is when she's",
    "start": "354810",
    "end": "360090"
  },
  {
    "text": "trying to access the table DynamoDB has to go decrypt the data key so that she",
    "start": "360090",
    "end": "365190"
  },
  {
    "text": "can access the data and that decryption fails so she'll get an access denied so how you can fix this again this is",
    "start": "365190",
    "end": "372090"
  },
  {
    "text": "probably not the most this is not a tightly controlled you know regulated policy but you can in",
    "start": "372090",
    "end": "377910"
  },
  {
    "text": "the deny statement just say I'm not going to deny kms so this is not granting any new permissions this",
    "start": "377910",
    "end": "383490"
  },
  {
    "text": "doesn't give her permission to access kms but it does say I'm not going to block access to kms and because she has",
    "start": "383490",
    "end": "390750"
  },
  {
    "text": "by default access to the kms key that is used for the 80 best manage key she will",
    "start": "390750",
    "end": "397500"
  },
  {
    "text": "get access to this and her access will succeed so after this call she would she would not have any trouble",
    "start": "397500",
    "end": "402960"
  },
  {
    "start": "401000",
    "end": "401000"
  },
  {
    "text": "accessing that an encrypted table there is another edge case that you have to be",
    "start": "402960",
    "end": "408690"
  },
  {
    "text": "concerned about and that is to do with caching and connection pooling we don't",
    "start": "408690",
    "end": "413880"
  },
  {
    "text": "want to access kms every time you access the table if you if we did that you",
    "start": "413880",
    "end": "419819"
  },
  {
    "text": "would we would quickly overload a we'd add a lot of delay to your access",
    "start": "419819",
    "end": "424830"
  },
  {
    "text": "because a kms access adds additional latency and B it would generate a lot of",
    "start": "424830",
    "end": "430770"
  },
  {
    "text": "access logs for you and your in your in your account and so we pool connections essentially I'm sorry we cache kms",
    "start": "430770",
    "end": "440340"
  },
  {
    "text": "access and we do that essentially for every connection once every five minutes we check to make sure you still have",
    "start": "440340",
    "end": "446340"
  },
  {
    "text": "access so it's a standard cache that goes on when you have a new connection you'll have some bit of latency penalty",
    "start": "446340",
    "end": "453120"
  },
  {
    "text": "and you'll have a kms access as well as a cloud trail record for that kms access",
    "start": "453120",
    "end": "459289"
  },
  {
    "text": "this has caused problems in some cases where people weren't reusing connections",
    "start": "459289",
    "end": "465330"
  },
  {
    "text": "so if you reuse a connection from the client if you're running a service and you're repeatedly connecting to DynamoDB",
    "start": "465330",
    "end": "472889"
  },
  {
    "text": "and with a new connection the dynamodb latency is not too bad but when you start seeing all the cloud trail logs",
    "start": "472889",
    "end": "479370"
  },
  {
    "text": "and stuff it becomes very expensive one customer who had this problem with a nodejs implementation ran into by",
    "start": "479370",
    "end": "488699"
  },
  {
    "text": "because their application was not doing any connection pooling and they had on the order of a hundred separate services",
    "start": "488699",
    "end": "495419"
  },
  {
    "text": "service nodes that were contacting dinamo repeatedly on new connections they had a substantial latency impact",
    "start": "495419",
    "end": "502199"
  },
  {
    "text": "when they fixed that the latency went from about 20 milliseconds per call to 2",
    "start": "502199",
    "end": "507360"
  },
  {
    "text": "milliseconds per call the number of calls that actually went to kms went from about 200 600 calls per minute down",
    "start": "507360",
    "end": "515099"
  },
  {
    "text": "to about 3 per minute so it was a big savings for them and they were very happy the places where this comes in in",
    "start": "515099",
    "end": "521430"
  },
  {
    "text": "each each of the SDKs and each of the development languages have slightly different models around this Java's",
    "start": "521430",
    "end": "528420"
  },
  {
    "text": "built with connection pooling by default but it has a limit of about 50 connections so if you writing",
    "start": "528420",
    "end": "535080"
  },
  {
    "text": "application where you're running several hundred threads and you may and those threads may be accessing more than 50",
    "start": "535080",
    "end": "541470"
  },
  {
    "text": "simultaneously you want to increase this value similarly with the Python toolkit",
    "start": "541470",
    "end": "546870"
  },
  {
    "text": "there's a limit of about ten connection there's a built-in pool that have support surround ten connections and so",
    "start": "546870",
    "end": "553590"
  },
  {
    "text": "if you're going to run a Python service that's written in Python and you're going to have more than ten threads that",
    "start": "553590",
    "end": "559350"
  },
  {
    "text": "are going to be simultaneously access and I know buddy excuse me simultaneously accessing dynamodb you",
    "start": "559350",
    "end": "566190"
  },
  {
    "text": "want to increase this limit and nodejs is one that has no connections by",
    "start": "566190",
    "end": "571740"
  },
  {
    "text": "default so it has no connection pooling and so if you are going to do this you want to create an HTTP agent that",
    "start": "571740",
    "end": "577710"
  },
  {
    "text": "supports connection pooling and set the sockets say set the limit on the number",
    "start": "577710",
    "end": "582810"
  },
  {
    "text": "of sockets to what's appropriate it all depends on when you are depending on",
    "start": "582810",
    "end": "588570"
  },
  {
    "text": "what your application is doing if application typically takes a request access to dynam buddy and responds then",
    "start": "588570",
    "end": "594120"
  },
  {
    "text": "you want to have as many sockets as you have threads if your application is going to go do some work and only access",
    "start": "594120",
    "end": "599880"
  },
  {
    "text": "DynamoDB for a portion of that work then you'll need some ratio you may have half so you may have you know the number of",
    "start": "599880",
    "end": "608460"
  },
  {
    "text": "the number of connections in your connection pool be half of the number of threads we recently I think about a week",
    "start": "608460",
    "end": "617490"
  },
  {
    "start": "614000",
    "end": "614000"
  },
  {
    "text": "or two ago announced default encryption at rest with the fault encryption at rest all of your tables all of your",
    "start": "617490",
    "end": "625320"
  },
  {
    "text": "backups all of your streams all of your indices are all back encrypted they're encrypted with dynamodb or a debase",
    "start": "625320",
    "end": "633090"
  },
  {
    "text": "owned KMS keys so these are not KMS keys in your account so there's no cloud shell records in your account there's no",
    "start": "633090",
    "end": "638910"
  },
  {
    "text": "permissions needed to access these keys these are all in and all within and",
    "start": "638910",
    "end": "644010"
  },
  {
    "text": "managed by accounts within dynamodb they",
    "start": "644010",
    "end": "649800"
  },
  {
    "text": "we use the same encryption model so the general model for this is we use kms to encrypt the data key and the data key is",
    "start": "649800",
    "end": "656400"
  },
  {
    "text": "used to encrypt to the data within the tables the all existing tables that",
    "start": "656400",
    "end": "662550"
  },
  {
    "text": "existed across DynamoDB in for all customer data have been encrypted we've",
    "start": "662550",
    "end": "668520"
  },
  {
    "text": "been that over the past few months so right now if you have a dynamodb table whether you created it today or whether you",
    "start": "668520",
    "end": "674850"
  },
  {
    "text": "created it six months ago or whether you created a year ago that data is now encrypted your streams are now encrypted",
    "start": "674850",
    "end": "681179"
  },
  {
    "text": "your backups are encrypted so all of that data is currently encrypted and",
    "start": "681179",
    "end": "687779"
  },
  {
    "text": "there's no des no changes necessary you don't have to do anything to enable this or to turn it on it just works and just",
    "start": "687779",
    "end": "695089"
  },
  {
    "text": "you're just encrypted and there's no additional cost including no change in",
    "start": "695089",
    "end": "700169"
  },
  {
    "text": "latency we were able to achieve this maintaining the existing latency SLA and the availability SLA I'm not changing",
    "start": "700169",
    "end": "707549"
  },
  {
    "text": "any of our latency I we we are working with our external auditors to include",
    "start": "707549",
    "end": "715619"
  },
  {
    "text": "this in our external audit reports moving forth otherwise how do you know",
    "start": "715619",
    "end": "721199"
  },
  {
    "text": "that that stuff is really encrypted but that's what that's how we're getting that covered you might you know jumping",
    "start": "721199",
    "end": "728939"
  },
  {
    "text": "back to this a second that you you might have a question about whether what should I use cmk or should I use a",
    "start": "728939",
    "end": "736919"
  },
  {
    "text": "default encryption and it depends on what your mission is and what you're trying to achieve with encryption if",
    "start": "736919",
    "end": "742259"
  },
  {
    "text": "your primary goal for encryption is that I just have my data encrypted at rest then the default encryption at rest will",
    "start": "742259",
    "end": "748289"
  },
  {
    "text": "meet your needs if the thing is that you have to have a key for some other reason for a compliance reason or for some",
    "start": "748289",
    "end": "754709"
  },
  {
    "text": "internal security reason you have to have a key that's used within your own account and you have to have monitoring",
    "start": "754709",
    "end": "760379"
  },
  {
    "text": "on that key then you should use the cmk the net effect from the two are going to",
    "start": "760379",
    "end": "765479"
  },
  {
    "text": "be very there isn't a big difference in the net effect you you have the data it's all encrypted it's all encrypted",
    "start": "765479",
    "end": "771329"
  },
  {
    "text": "with the same technology and it's it's protected the same way so monitoring",
    "start": "771329",
    "end": "778049"
  },
  {
    "text": "access to your data we currently support cloud trail on with dynamodb on control",
    "start": "778049",
    "end": "784889"
  },
  {
    "text": "plane operations so when you create a table you or you modify table like updating the table those are all logged",
    "start": "784889",
    "end": "792569"
  },
  {
    "text": "in cloud trail they're all it's always enabled it all shows up in your primary cloud trail that's available you can go",
    "start": "792569",
    "end": "798089"
  },
  {
    "text": "look at it in the cloud trail console and see you know who was created a table and when they create table and all that fun stuff we don't",
    "start": "798089",
    "end": "804959"
  },
  {
    "text": "currently support cloud share logging in the data plane so you when someone does",
    "start": "804959",
    "end": "811469"
  },
  {
    "text": "a get item or a query that's not logged in cloud trail we do provide if you need",
    "start": "811469",
    "end": "817859"
  },
  {
    "text": "to monitor updates to your table you can use a dynamodb stream which gives you a",
    "start": "817859",
    "end": "824219"
  },
  {
    "text": "change log of all the changes made to the table and you can use that to maintain a log yourself if you do need",
    "start": "824219",
    "end": "830209"
  },
  {
    "text": "currently need logs to your table of accesses we suggest you do that at the application layer at the layer above",
    "start": "830209",
    "end": "836639"
  },
  {
    "text": "dynamodb the the things you can do with",
    "start": "836639",
    "end": "842069"
  },
  {
    "start": "841000",
    "end": "841000"
  },
  {
    "text": "the logs that we are doing so with the control plane operations is you can integrate that with cloud watch events",
    "start": "842069",
    "end": "847139"
  },
  {
    "text": "and you can set yourself up for near real-time tracking of events that occur",
    "start": "847139",
    "end": "852989"
  },
  {
    "text": "within your tables you can do some interesting use cases I have one that I'll show you where anytime someone",
    "start": "852989",
    "end": "859619"
  },
  {
    "text": "attempts to delete a table I can I it will send an email message to me to",
    "start": "859619",
    "end": "865229"
  },
  {
    "text": "say hey Connor someone's deleting this table or someone tried to delete this table and and let me know just as a",
    "start": "865229",
    "end": "871229"
  },
  {
    "text": "demonstration of it you can also do other things like if someone creates a table but they they did not turn on",
    "start": "871229",
    "end": "879809"
  },
  {
    "text": "auto-scaling that you can turn on auto-scaling automatically if that's your policy with",
    "start": "879809",
    "end": "885809"
  },
  {
    "text": "anything within your company so you can set up rules like that that behave on this and I'm gonna walk through creating",
    "start": "885809",
    "end": "892939"
  },
  {
    "text": "the notification setup and the I had this user Bob and I'm a security guy I'm",
    "start": "892939",
    "end": "900299"
  },
  {
    "start": "897000",
    "end": "897000"
  },
  {
    "text": "security guys I always talk about Bob and Alice almost all this so I did talk about Jane before just to have something",
    "start": "900299",
    "end": "905489"
  },
  {
    "text": "different but here's Bob Bob's a little troublesome Bob likes to go and delete things and test table and so here I've",
    "start": "905489",
    "end": "912929"
  },
  {
    "text": "got this he's gonna try to delete a table and I I put a date come in in there just so you can see how long this",
    "start": "912929",
    "end": "919169"
  },
  {
    "text": "can occur and this isn't the cloud watch events are near real-time they're not",
    "start": "919169",
    "end": "924239"
  },
  {
    "text": "real-time they're not guaranteed to be real-time but you'll see what happens in this case so the you know this was done",
    "start": "924239",
    "end": "930329"
  },
  {
    "text": "a couple of weeks ago on a Saturday and I got this error occurred that when Bob tried to do this deletion the",
    "start": "930329",
    "end": "936550"
  },
  {
    "text": "so hey you know you can't delete the table because you don't have permissions to delete the table and in my inbox",
    "start": "936550",
    "end": "941890"
  },
  {
    "text": "shortly thereafter came a notification that says hey Bob tried to delete a table and if you look at the timestamps",
    "start": "941890",
    "end": "948910"
  },
  {
    "text": "on the - there are only a few seconds apart so you can see it is near real time how do you set this up what do you",
    "start": "948910",
    "end": "959920"
  },
  {
    "text": "have to do to go set this up there's three steps one is you have to configure a cloud watch event to track the event",
    "start": "959920",
    "end": "965980"
  },
  {
    "text": "and to be notified to trigger a lambda function you have to build the lambda",
    "start": "965980",
    "end": "971230"
  },
  {
    "text": "function that will process the event and generate the message and you you build a",
    "start": "971230",
    "end": "976990"
  },
  {
    "text": "simple notification surface on SNS topic that will deliver the email to whoever",
    "start": "976990",
    "end": "982630"
  },
  {
    "text": "subscribe to this and so I'll walk through these steps and it's easier if you do it backwards and so I'll start",
    "start": "982630",
    "end": "988750"
  },
  {
    "text": "first by setting up the SNS topic and then I'll set up the lambda function and then I'll set up the cloud watch events",
    "start": "988750",
    "end": "994660"
  },
  {
    "text": "and so in setting up the topic you just create a top a topic for email delivery",
    "start": "994660",
    "end": "1000200"
  },
  {
    "text": "and you create an arn and you set the endpoint of where it's going to deliver",
    "start": "1000200",
    "end": "1005460"
  },
  {
    "text": "the email and this is my email address and so I go and set that up and notice",
    "start": "1005460",
    "end": "1010470"
  },
  {
    "text": "when you first set it up it's pending confirmation and so you have to go and go through the e-myth standard email",
    "start": "1010470",
    "end": "1016320"
  },
  {
    "text": "confirmation that says hey yes I want to subscribe to this to enable it and after you do that you now have a topic set up",
    "start": "1016320",
    "end": "1023070"
  },
  {
    "text": "I called it email delivery if I anybody publishes a message to that topic that",
    "start": "1023070",
    "end": "1028920"
  },
  {
    "text": "message is turned around and delivered to me an email very simple I use this for other cases like I have one set up I",
    "start": "1028920",
    "end": "1035459"
  },
  {
    "text": "have a similar kind of setup for delivering notifications when I am changes are made in my account so now I",
    "start": "1035459",
    "end": "1041910"
  },
  {
    "text": "have the SNS topic set up I turn around and I go to lambda and I want to",
    "start": "1041910",
    "end": "1047579"
  },
  {
    "text": "configure a new lambda function and I'm gonna author the lambda function from scratch I'm gonna start out with a new",
    "start": "1047580",
    "end": "1052590"
  },
  {
    "start": "1048000",
    "end": "1048000"
  },
  {
    "text": "lambda function I choose to use Python you you have a number of different",
    "start": "1052590",
    "end": "1058080"
  },
  {
    "text": "languages you can choose but I chose to build this with Python and I call this my dynamodb alerts function so it can",
    "start": "1058080",
    "end": "1064770"
  },
  {
    "text": "alert me to different functions I'm going to use this primarily for tracking deletes but you can do",
    "start": "1064770",
    "end": "1069900"
  },
  {
    "text": "for whichever one permission you do need you need a role for the lambda function",
    "start": "1069900",
    "end": "1075030"
  },
  {
    "text": "and I chat up the role and used a s out",
    "start": "1075030",
    "end": "1081570"
  },
  {
    "text": "of the box permission for SNS topic publishing so you can just select that from the list this will grant this",
    "start": "1081570",
    "end": "1087780"
  },
  {
    "text": "lambda function the ability to publish to any SNS topic in my account you might want to in in a real world go back in",
    "start": "1087780",
    "end": "1095070"
  },
  {
    "text": "and edit that policy and say only for the topic that is necessary in this case the email delivery topic but it's easier",
    "start": "1095070",
    "end": "1101730"
  },
  {
    "text": "to just generate it this way by default and before I go into the actual code I'm",
    "start": "1101730",
    "end": "1107520"
  },
  {
    "start": "1104000",
    "end": "1104000"
  },
  {
    "text": "going to show you a sample event this is what comes from cloud watch when they call your function it has a detail",
    "start": "1107520",
    "end": "1113700"
  },
  {
    "text": "section and within the detail section there's a section that has the request parameters so you can see what was",
    "start": "1113700",
    "end": "1119670"
  },
  {
    "text": "passed on the request and there's a section that has the response elements this is what was passed back to the",
    "start": "1119670",
    "end": "1124710"
  },
  {
    "text": "caller and so you have that information available to your functions so that you can see what was done in addition",
    "start": "1124710",
    "end": "1131700"
  },
  {
    "text": "there's information about who was called who made the call this is called by Bob",
    "start": "1131700",
    "end": "1137120"
  },
  {
    "text": "and the source came from DynamoDB and you know even the user agent not that it",
    "start": "1137120",
    "end": "1143040"
  },
  {
    "text": "matters in this case but you can see each of the different pieces of information that are available and so",
    "start": "1143040",
    "end": "1149040"
  },
  {
    "text": "we're going to walk through writing the function and now I'm now into writing",
    "start": "1149040",
    "end": "1156510"
  },
  {
    "text": "Python code some of the beginning of this is just boilerplate these are the different Python libraries I have to",
    "start": "1156510",
    "end": "1161640"
  },
  {
    "text": "include and and then I'm taking that detailed message that we just looked at that event and I'm taking it apart",
    "start": "1161640",
    "end": "1168900"
  },
  {
    "text": "pulling out the different sections the detail the action the identity of who invoked it I then build a message and I",
    "start": "1168900",
    "end": "1175950"
  },
  {
    "text": "look to see whether there's an error message element in there the error message typically means it failed if",
    "start": "1175950",
    "end": "1181620"
  },
  {
    "text": "that's not present it was a successful call and I generate a different email message structure depending on whether",
    "start": "1181620",
    "end": "1187590"
  },
  {
    "text": "it was a successful call or a failure and I I then add on to the requests the",
    "start": "1187590",
    "end": "1195929"
  },
  {
    "text": "list of all the other API information this is more for debugging so that I can debug the the call later I can I can see",
    "start": "1195929",
    "end": "1203040"
  },
  {
    "text": "all the infirm that was included and finally i generate the SNS message so this is where I call",
    "start": "1203040",
    "end": "1209730"
  },
  {
    "text": "SNS and publish to their topic this EEMA this message and SNS will turn around and deliver it so that's the lambda",
    "start": "1209730",
    "end": "1216240"
  },
  {
    "text": "function and finally I the last piece I need to put is the cloud watch events to link the two together in to do that I",
    "start": "1216240",
    "end": "1225350"
  },
  {
    "start": "1223000",
    "end": "1223000"
  },
  {
    "text": "start with the event source and I say this is coming from DynamoDB I want to",
    "start": "1225350",
    "end": "1230730"
  },
  {
    "text": "trick trigger on a cloud trail event so I'm going to trigger by an ABAP ice call",
    "start": "1230730",
    "end": "1237000"
  },
  {
    "text": "API called via cloud trail and I select one event the delete table this is for a",
    "start": "1237000",
    "end": "1242400"
  },
  {
    "text": "sample I'm only trying to track that one event and this generates a particular",
    "start": "1242400",
    "end": "1247950"
  },
  {
    "text": "structure for the cloud watch event rule that shows it's a cloud raw it's it's for cloud trail",
    "start": "1247950",
    "end": "1253590"
  },
  {
    "text": "it's from DynamoDB and it's for the delete AP the delete table API the event name I then set up a target to be the",
    "start": "1253590",
    "end": "1261480"
  },
  {
    "text": "lambda function this is the function we created in the prior step and that's a dynamodb alerts function and that's it",
    "start": "1261480",
    "end": "1269010"
  },
  {
    "start": "1268000",
    "end": "1268000"
  },
  {
    "text": "I'm done that's all I have to do and now when Jane goes in deletes her table I",
    "start": "1269010",
    "end": "1274620"
  },
  {
    "text": "get she gets a successful call and I'm",
    "start": "1274620",
    "end": "1280530"
  },
  {
    "text": "having trouble pressing the button I apologize and when she deletes the call I get an email notification again very",
    "start": "1280530",
    "end": "1286680"
  },
  {
    "text": "quickly that hate Jane deleted the table and so you can you know deleting a table",
    "start": "1286680",
    "end": "1292200"
  },
  {
    "text": "is probably a pretty important thing and you probably want to know when someone's trying to delete a table or when someone is deleting a table so that you can",
    "start": "1292200",
    "end": "1298470"
  },
  {
    "text": "react to it if it wasn't a table that should be deleted and so this is a way that you can trigger that event and and",
    "start": "1298470",
    "end": "1303510"
  },
  {
    "text": "and and know when it's when it's happening or when it's being attempted",
    "start": "1303510",
    "end": "1309260"
  },
  {
    "text": "controlling access to your table there",
    "start": "1309260",
    "end": "1314840"
  },
  {
    "text": "dynamodb provides two layers of control there's a basic authorization which is standard the action that you're taking",
    "start": "1314840",
    "end": "1323190"
  },
  {
    "text": "and the resource that you're taking it with so you know like describe table and the arn of the table that's being",
    "start": "1323190",
    "end": "1328440"
  },
  {
    "text": "accessed and then we support fine-grained access control fine-grained access channel gives you the ability to",
    "start": "1328440",
    "end": "1333870"
  },
  {
    "text": "limit access to portions of the table you can limit on the based on the",
    "start": "1333870",
    "end": "1340500"
  },
  {
    "text": "leading keys the leading key is essentially the key of the table that's being requested so if I'm doing get item",
    "start": "1340500",
    "end": "1346770"
  },
  {
    "text": "on item 101 101 is the leading key so this lets you control what rows are",
    "start": "1346770",
    "end": "1353340"
  },
  {
    "text": "allowed to be queried or allowed to be requested from the table or updated and in table the attributes are the columns",
    "start": "1353340",
    "end": "1360270"
  },
  {
    "text": "so this lets you control what columns so I can see what attributes I can control what attributes can be requested and/or",
    "start": "1360270",
    "end": "1366060"
  },
  {
    "text": "updated by the user the Select thought you control the Select parameter and a query your scheme requests return values",
    "start": "1366060",
    "end": "1372930"
  },
  {
    "text": "let you control what values are the when you make a request to dynamo you can ask",
    "start": "1372930",
    "end": "1378930"
  },
  {
    "text": "when your update item you can ask for the old values to be returned back the main purpose of this having this context",
    "start": "1378930",
    "end": "1385890"
  },
  {
    "text": "key is to allow you to have a model where you have write only access where I",
    "start": "1385890",
    "end": "1390960"
  },
  {
    "text": "can say someone's allowed to update the table but not see the other values or not see the old values and so they can I",
    "start": "1390960",
    "end": "1397560"
  },
  {
    "text": "can say they have update permissions but their return values or not they're not allowed to ask for any return values and",
    "start": "1397560",
    "end": "1404040"
  },
  {
    "text": "so that's that's its primary purpose and then you can also concern control whether they're allowed to look at how",
    "start": "1404040",
    "end": "1411510"
  },
  {
    "text": "much consume capacity is returned I'm not sure why that's there but it's that's it that is a control that you",
    "start": "1411510",
    "end": "1417900"
  },
  {
    "start": "1414000",
    "end": "1414000"
  },
  {
    "text": "have I don't have a good use case for that off the top of my head I apologize so for fine-grained access control we're",
    "start": "1417900",
    "end": "1423270"
  },
  {
    "text": "going to walk through a scenario I'm using the product catalog table the this",
    "start": "1423270",
    "end": "1429420"
  },
  {
    "text": "is a Stan one of the standard example tables that's available on the AWS documentation pages this has a partition",
    "start": "1429420",
    "end": "1437130"
  },
  {
    "text": "key with an that's the ID record there are a set of data in there for books",
    "start": "1437130",
    "end": "1442980"
  },
  {
    "text": "books have IDs that are in the 100's they start from I think there's like three or four books in there that 101",
    "start": "1442980",
    "end": "1449490"
  },
  {
    "text": "102 103 they have a series of attributes some that are pretty obvious for books like ISBN some of which are more generic",
    "start": "1449490",
    "end": "1456330"
  },
  {
    "text": "like title and then there's a set of bicycles in the in the data set bicycles",
    "start": "1456330",
    "end": "1462090"
  },
  {
    "text": "have IDs in the 200s and they have a different set of attributes so there some are in common like title but they",
    "start": "1462090",
    "end": "1467880"
  },
  {
    "text": "are they have a bicycle type and a brand and then I have two users Alice and Bob and Alice I'm gonna set her up so that",
    "start": "1467880",
    "end": "1474649"
  },
  {
    "text": "she can only work on books so she can access this table but she's only able to see or update books in the in the",
    "start": "1474649",
    "end": "1481849"
  },
  {
    "text": "database and Bob is gonna work on bicycles and he's only able to access or update books and bicycles I'm sorry and",
    "start": "1481849",
    "end": "1489679"
  },
  {
    "text": "they'll be limited to the attributes that are available for each item so Alice won't be able to add a book that",
    "start": "1489679",
    "end": "1496429"
  },
  {
    "text": "has a bicycle type and Bob won't be able to add a bicycle that has an ISBN so",
    "start": "1496429",
    "end": "1501709"
  },
  {
    "text": "there'll be restrictions like that and so let's look at Alice's permissions we start out with a basic some basic global",
    "start": "1501709",
    "end": "1508999"
  },
  {
    "text": "permissions like lists tables lists tables you can't restrict it it's it you either list all the tables or you can't list",
    "start": "1508999",
    "end": "1515479"
  },
  {
    "text": "any of the tables so it has resource star and so she has the permission to list tables then we have a set of",
    "start": "1515479",
    "end": "1524079"
  },
  {
    "text": "specific dynamodb api's for get item and put item and update item these are the",
    "start": "1524079",
    "end": "1529729"
  },
  {
    "text": "items she needs to do her job as for managing books and the resource is",
    "start": "1529729",
    "end": "1536359"
  },
  {
    "text": "limited to just the product catalog table so she's not able to access any other table with this permission she's",
    "start": "1536359",
    "end": "1543499"
  },
  {
    "text": "only able to access the product catalog table and so on to the conditions this",
    "start": "1543499",
    "end": "1550579"
  },
  {
    "start": "1548000",
    "end": "1548000"
  },
  {
    "text": "is where you in the condition sections of the policy this is where you start using the fine-grained access control",
    "start": "1550579",
    "end": "1555619"
  },
  {
    "text": "well start with a limit on the leading Keys and the way this is written it's",
    "start": "1555619",
    "end": "1562579"
  },
  {
    "text": "allows leading keys that are greater than or equal to 100 and less than 200",
    "start": "1562579",
    "end": "1568249"
  },
  {
    "text": "so I have two numeric comparisons one that starts with greater than or equal to numeric greater than or equal to and",
    "start": "1568249",
    "end": "1574869"
  },
  {
    "text": "one that is numeric less than and the reason why I use numeric the other option I could have done with this is",
    "start": "1574869",
    "end": "1580999"
  },
  {
    "text": "you say a string cop string like and said string like one star and the issue",
    "start": "1580999",
    "end": "1586429"
  },
  {
    "text": "with that if you were to use string like one star is that the if later I add",
    "start": "1586429",
    "end": "1592489"
  },
  {
    "text": "another product that's one thousand and 1,001 then string like one star would also grant permissions to that product",
    "start": "1592489",
    "end": "1599479"
  },
  {
    "text": "as well and this is B I'm trying to be very specific for IDs numerically 100 and 200 and so I wrote this value",
    "start": "1599479",
    "end": "1607100"
  },
  {
    "text": "the other thing you might notice is there's this for all values prefix on this leading keys is a multi-value",
    "start": "1607100",
    "end": "1614390"
  },
  {
    "text": "context key in a normal get item there's only going to be one value on there but if you do a batch operation when you do",
    "start": "1614390",
    "end": "1621140"
  },
  {
    "text": "five get items in a batch they'll all be listed in those same context keys so",
    "start": "1621140",
    "end": "1626810"
  },
  {
    "text": "it's a multi value so on a multi value context key you should always list for all values or for any values depending",
    "start": "1626810",
    "end": "1632810"
  },
  {
    "text": "on what you're trying to do in the case with leading keys I want to make sure that any key that she specifies it is in",
    "start": "1632810",
    "end": "1639680"
  },
  {
    "text": "within this range and so I use for all values the next is the attributes and",
    "start": "1639680",
    "end": "1645800"
  },
  {
    "text": "again with attributes I'm also using the for all values because when you request attributes from a table you're",
    "start": "1645800",
    "end": "1652130"
  },
  {
    "text": "requesting generally multiple attributes it's not just a single attribute and so that is a multivalued context key and",
    "start": "1652130",
    "end": "1658700"
  },
  {
    "text": "are you string like and I list and in this case I could have used string equals as well because I don't use any",
    "start": "1658700",
    "end": "1664130"
  },
  {
    "text": "glob patterns no stars and no wildcards in here and so but I give her access to",
    "start": "1664130",
    "end": "1669260"
  },
  {
    "text": "the idol the ID the title the ISBN the fields that we have allowed for books so",
    "start": "1669260",
    "end": "1675860"
  },
  {
    "text": "she's able to update these attributes if she tries to update a different attribute or tries to see a different",
    "start": "1675860",
    "end": "1682310"
  },
  {
    "text": "attribute her request will fail so Bob's permissions I'm only going to show you",
    "start": "1682310",
    "end": "1689210"
  },
  {
    "text": "the conditions section because the primary section was exactly the same they the he has get item put item on the",
    "start": "1689210",
    "end": "1696620"
  },
  {
    "text": "same table and he has the lists tables on any for all tables and so within his",
    "start": "1696620",
    "end": "1703880"
  },
  {
    "text": "section he has the IDs that go between 200 and 300 so greater than or equal to",
    "start": "1703880",
    "end": "1709490"
  },
  {
    "text": "200 and less than 300 and he has the",
    "start": "1709490",
    "end": "1714530"
  },
  {
    "text": "access to the attributes related to bicycles he doesn't have access to the attributes that are not related to",
    "start": "1714530",
    "end": "1719750"
  },
  {
    "text": "bicycles like the ISBN so looking at some examples here's a case where Alice",
    "start": "1719750",
    "end": "1725870"
  },
  {
    "text": "is trying to access a record with number 99 and they with the ID 99 and this",
    "start": "1725870",
    "end": "1732110"
  },
  {
    "text": "fails with an access denied now if you if I don't know if you're familiar with the product",
    "start": "1732110",
    "end": "1737510"
  },
  {
    "text": "catalogue table but the product catalog table doesn't have a record number 99 but she still gets an access denied and",
    "start": "1737510",
    "end": "1744320"
  },
  {
    "text": "the reason for that is the security reasons you don't she's not allowed to see whether there is a 99 or not because",
    "start": "1744320",
    "end": "1750740"
  },
  {
    "text": "she's not allowed to access 99 so she's always going to get an access denied whether or not the record actually exists if she tries to access record 101",
    "start": "1750740",
    "end": "1759800"
  },
  {
    "text": "everything works peachy keen she gets back her record because she's accessing the records she's allowed to access than",
    "start": "1759800",
    "end": "1766130"
  },
  {
    "text": "the type the field she's allowed to access if on the other hand she tries to access a field that is she's not allowed",
    "start": "1766130",
    "end": "1772760"
  },
  {
    "text": "to access such as the brand she gets an access denied on the brand because that's she's not allowed to request the",
    "start": "1772760",
    "end": "1779450"
  },
  {
    "text": "brand field she's only allowed to request the fields that are relative to books again it doesn't matter whether",
    "start": "1779450",
    "end": "1785090"
  },
  {
    "text": "there's actually a brand or not on the record it's she's asking for brand and she's not allowed to see brand now with",
    "start": "1785090",
    "end": "1792110"
  },
  {
    "text": "Bob making the request he's he's asking for $1.99 there isn't a $1.99 in and",
    "start": "1792110",
    "end": "1798020"
  },
  {
    "text": "it's outside of his range so he also gets an access denied but money makes a request for 201 the request is",
    "start": "1798020",
    "end": "1805160"
  },
  {
    "text": "successful and he's able to see the record so on to limiting access when",
    "start": "1805160",
    "end": "1812360"
  },
  {
    "text": "using Amazon DynamoDB network access and",
    "start": "1812360",
    "end": "1817870"
  },
  {
    "start": "1816000",
    "end": "1816000"
  },
  {
    "text": "the way you typically access if you're coming from a V PC and you're on an ec2",
    "start": "1817870",
    "end": "1823700"
  },
  {
    "text": "instance when you're going to access dynamodb what typically happens is you go out of AWS out into the internet and",
    "start": "1823700",
    "end": "1830240"
  },
  {
    "text": "come back in right so you're making a call that goes out to an Internet gateway and accesses DynamoDB and some",
    "start": "1830240",
    "end": "1836360"
  },
  {
    "text": "people don't like that they don't want to go out through the internet and they wanted to be able to access Dynamo",
    "start": "1836360",
    "end": "1841940"
  },
  {
    "text": "directly and so we have this new this model where with a V PC endpoint the",
    "start": "1841940",
    "end": "1849020"
  },
  {
    "start": "1846000",
    "end": "1846000"
  },
  {
    "text": "access goes directly from your V PC to Dynamo bypassing the internet and it",
    "start": "1849020",
    "end": "1855680"
  },
  {
    "text": "does not go out across the internet at all and in addition and so you can",
    "start": "1855680",
    "end": "1860960"
  },
  {
    "text": "actually have a B PC that has access to dynamo DB that has no internet access",
    "start": "1860960",
    "end": "1867980"
  },
  {
    "text": "you do not need internet access any anymore if all your trying to access from the V PC is",
    "start": "1867980",
    "end": "1873100"
  },
  {
    "text": "dynamodb in addition you get to write policies on this connection this VPC",
    "start": "1873100",
    "end": "1880759"
  },
  {
    "text": "endpoint that restrict who can use this connection and how they can use this connection and so I'll talk through",
    "start": "1880759",
    "end": "1885830"
  },
  {
    "text": "setting this up I'm setting up a B PC endpoint as well as how how you can",
    "start": "1885830",
    "end": "1892039"
  },
  {
    "text": "control the policies and some of the impacts that you have to be aware of when you're setting this up because when you set this up the connection path",
    "start": "1892039",
    "end": "1898850"
  },
  {
    "text": "changed and that can have a negative impact depending on how you construct constructed access to your database what",
    "start": "1898850",
    "end": "1905029"
  },
  {
    "text": "permissions you've given so set this up you go to your VP console and yes you",
    "start": "1905029",
    "end": "1910100"
  },
  {
    "text": "can do this in the CLI and and and other ways but I'm going to do it from the console you go to your the VPC console",
    "start": "1910100",
    "end": "1917240"
  },
  {
    "text": "and you select your endpoints and then on the endpoints you're gonna select",
    "start": "1917240",
    "end": "1922490"
  },
  {
    "text": "create endpoint and in this case I already have an endpoint for s3 but I'm going to be creating an endpoint for",
    "start": "1922490",
    "end": "1927499"
  },
  {
    "text": "DynamoDB and when I go in I get to select a a Tabas service and I say I",
    "start": "1927499",
    "end": "1934100"
  },
  {
    "text": "want to select dynamodb to create dynamo DB and you'll notice after that there's this warning that shows up on your",
    "start": "1934100",
    "end": "1940220"
  },
  {
    "start": "1937000",
    "end": "1937000"
  },
  {
    "text": "screen this is hey be aware that your source IP addresses are going to change because",
    "start": "1940220",
    "end": "1945980"
  },
  {
    "text": "you're no longer going to be accessing this by going out to the Internet where you have an a published external IP",
    "start": "1945980",
    "end": "1951679"
  },
  {
    "text": "address that's used to access the service you're now coming in through an internal access and this changes what IP",
    "start": "1951679",
    "end": "1958940"
  },
  {
    "text": "address your user looks like they're what I P address your user has when they come to access the service and if you",
    "start": "1958940",
    "end": "1965570"
  },
  {
    "text": "have policies that restrict based on IP address that can be that can break you",
    "start": "1965570",
    "end": "1971450"
  },
  {
    "text": "so an example is I have a policy for Bob and in this policy I've granted him",
    "start": "1971450",
    "end": "1977659"
  },
  {
    "start": "1973000",
    "end": "1973000"
  },
  {
    "text": "access to dynamodb star and again I'm gonna say you generally don't want to grant access dynamodb star it's not a",
    "start": "1977659",
    "end": "1983570"
  },
  {
    "text": "great policy but it's good for examples and in this case I'm gonna have a policy that grants access that anything in",
    "start": "1983570",
    "end": "1990049"
  },
  {
    "text": "dynamo as long as Bob is coming from the corporate IP address and this would be the public IP address of that ec2",
    "start": "1990049",
    "end": "1996350"
  },
  {
    "text": "instance that we were using that I was using as an example before and so his request will go will work fine as long",
    "start": "1996350",
    "end": "2003190"
  },
  {
    "text": "as he's coming from that IP address when he goes to make this access and he lists the table everything works peachy",
    "start": "2003190",
    "end": "2010090"
  },
  {
    "text": "keen but now if I turn on the V PC endpoint and then Bob goes to makes the",
    "start": "2010090",
    "end": "2015820"
  },
  {
    "text": "same exact request he gets an access denied and this access is denied because",
    "start": "2015820",
    "end": "2021370"
  },
  {
    "text": "he's no longer coming from that source IP address in fact the way it works when",
    "start": "2021370",
    "end": "2027850"
  },
  {
    "text": "you come in from a V PC endpoint we don't populate the source IP address in",
    "start": "2027850",
    "end": "2033429"
  },
  {
    "text": "the authorization context so the source IP is not available and the reason why",
    "start": "2033429",
    "end": "2038440"
  },
  {
    "text": "we don't even though he does have a source IP is coming from an internal IP address the reason why we don't populate",
    "start": "2038440",
    "end": "2044320"
  },
  {
    "text": "that is most AWS V pcs have the same IP",
    "start": "2044320",
    "end": "2049419"
  },
  {
    "text": "address range there'll be 10.0 that 0/8 many of them",
    "start": "2049419",
    "end": "2054820"
  },
  {
    "text": "and so everybody would have the same IP address and so you don't want to populate a data that's shared by many",
    "start": "2054820",
    "end": "2062138"
  },
  {
    "text": "customers and so we don't populate if you're coming into a V PC endpoint that you cannot have a condition that's based",
    "start": "2062139",
    "end": "2068648"
  },
  {
    "text": "on the source IP address but you can have conditions we populate other context keys one is the V PC endpoint",
    "start": "2068649",
    "end": "2075310"
  },
  {
    "text": "that you're coming in through and the second is the B PC that you're coming from so you have a source V PC and source V PC endpoint and so will to",
    "start": "2075310",
    "end": "2083950"
  },
  {
    "start": "2083000",
    "end": "2083000"
  },
  {
    "text": "update Bob's policy to allow this now this is a case where I want to allow Bob to still be able to come in from a",
    "start": "2083950",
    "end": "2089618"
  },
  {
    "text": "corporate IP address if he's coming in from from the office and so I set it up to be based to limit on the source IP if",
    "start": "2089619",
    "end": "2098109"
  },
  {
    "text": "it exists and so what if exists does it says this condition this restriction to",
    "start": "2098109",
    "end": "2104380"
  },
  {
    "text": "source IP only applies if the source IP condition key has been set it does not",
    "start": "2104380",
    "end": "2110619"
  },
  {
    "text": "apply it's ignored if the source IP is not set and similarly I add a condition string equals if exists to the source V",
    "start": "2110619",
    "end": "2118839"
  },
  {
    "text": "PC endpoint so I put in my V PC endpoint in here so Bob can access it if he's",
    "start": "2118839",
    "end": "2124540"
  },
  {
    "text": "coming in through the source V PC or if he's coming in through the source IP so",
    "start": "2124540",
    "end": "2129760"
  },
  {
    "text": "that's the effect of having the if exists on the two of them that can be either or either one will match and this",
    "start": "2129760",
    "end": "2135130"
  },
  {
    "text": "works because we do not set both of them simultaneously you will in your authorization context",
    "start": "2135130",
    "end": "2141650"
  },
  {
    "text": "you will not have both the source IP and a source VPC endpoint alternatively if I",
    "start": "2141650",
    "end": "2148010"
  },
  {
    "text": "said oh he's Bob is only going to access it from my ec2 instance and I only want",
    "start": "2148010",
    "end": "2153440"
  },
  {
    "text": "him to be able to access it when he's coming in then the source VPC and this will prevent Bob from the immune access",
    "start": "2153440",
    "end": "2158750"
  },
  {
    "text": "from his his system at home or his work laptop running inside your corporate",
    "start": "2158750",
    "end": "2164840"
  },
  {
    "text": "network he'd only be able to access the data from the V PC endpoint if he's connected through the V PC endpoint and",
    "start": "2164840",
    "end": "2170420"
  },
  {
    "text": "so you can write the policy so that it only allows it when you're coming into the V PC endpoint to restrict Bob so",
    "start": "2170420",
    "end": "2177080"
  },
  {
    "text": "this is something you have to be aware of if you're going to go turn on V PC endpoints if you have policies that",
    "start": "2177080",
    "end": "2182450"
  },
  {
    "text": "restrict based on IP address you want to fix that and address that before you turn it on because as soon as you turn",
    "start": "2182450",
    "end": "2189080"
  },
  {
    "text": "it on it will stop source IP restrictions so continuing my setup I",
    "start": "2189080",
    "end": "2198230"
  },
  {
    "text": "need to attach the V PC endpoint to uh V PC and and wrap table and now I have my",
    "start": "2198230",
    "end": "2205970"
  },
  {
    "text": "V PC endpoint setup there's another thing I can do which I mentioned before is I can set a V PC endpoint policy V PC",
    "start": "2205970",
    "end": "2213500"
  },
  {
    "text": "endpoints are a connection and they have a policy where you can control what goes",
    "start": "2213500",
    "end": "2218540"
  },
  {
    "text": "across the connection and this policy is a little different even though it'll use the term allow it's not it actually",
    "start": "2218540",
    "end": "2225230"
  },
  {
    "text": "doesn't grant any privileges in and of itself it's a limit policy it's the the",
    "start": "2225230",
    "end": "2230600"
  },
  {
    "text": "net effect is the permissions of the call are what the I am users permissions",
    "start": "2230600",
    "end": "2235640"
  },
  {
    "text": "had intersected with what the V PC endpoint policy has so you only have the",
    "start": "2235640",
    "end": "2240950"
  },
  {
    "text": "permissions that are the connection of the two together but if I put an allow in the limit policy it doesn't grant any",
    "start": "2240950",
    "end": "2246890"
  },
  {
    "text": "privileges by itself you can't just because I had that allow doesn't mean a user is going to be allowed to put",
    "start": "2246890",
    "end": "2252830"
  },
  {
    "text": "something in dynamodb but it does it does allow you to control that it lets you control what principles what actions",
    "start": "2252830",
    "end": "2259430"
  },
  {
    "text": "and conditions that they're able to make the call under and what resources they're able to access so this allows",
    "start": "2259430",
    "end": "2264830"
  },
  {
    "text": "you to do some things and I'll walk through a couple of examples here the default model when you said when you're",
    "start": "2264830",
    "end": "2271400"
  },
  {
    "text": "going to set this up it's full access this essentially is a power a V PCM public endpoint policy that says",
    "start": "2271400",
    "end": "2277400"
  },
  {
    "text": "allow star to access star its allow star and star so any user can use the V PC endpoint",
    "start": "2277400",
    "end": "2283279"
  },
  {
    "text": "policy to access any DynamoDB table coming through there that works well and",
    "start": "2283279",
    "end": "2288589"
  },
  {
    "text": "you have to be aware that if you have other dynamodb app other applications",
    "start": "2288589",
    "end": "2294739"
  },
  {
    "text": "using dynamodb that are running within your V PC that may be not be your they're not using your corporate",
    "start": "2294739",
    "end": "2300739"
  },
  {
    "text": "DynamoDB they're using their own DynamoDB as part of their application because it's a third party application",
    "start": "2300739",
    "end": "2305989"
  },
  {
    "text": "you have to make sure you don't break them by turning on the V PC endpoint so you may need this in some cases but",
    "start": "2305989",
    "end": "2312289"
  },
  {
    "start": "2312000",
    "end": "2312000"
  },
  {
    "text": "let's assume you're gonna write a V PC endpoint that says I only want my own tables to be accessed and in this case",
    "start": "2312289",
    "end": "2319460"
  },
  {
    "text": "I'm in account six seven six blah right and in that account I only want users to",
    "start": "2319460",
    "end": "2325430"
  },
  {
    "text": "be able to access tables from that account and so I put in a policy that says allow principal star so I don't",
    "start": "2325430",
    "end": "2331670"
  },
  {
    "text": "care who the principal is access to any DynamoDB API as long as the resource is",
    "start": "2331670",
    "end": "2338119"
  },
  {
    "text": "an arm that has a star in the region and I'll explain why that is in a second and",
    "start": "2338119",
    "end": "2344719"
  },
  {
    "text": "a star at the end so I don't care whether it's a table or an industry or a backup or a stream any DynamoDB resource",
    "start": "2344719",
    "end": "2351049"
  },
  {
    "text": "in that account is allowed to be accessed this prevents someone from accessing a dynamodb resource in another",
    "start": "2351049",
    "end": "2358309"
  },
  {
    "text": "account and why might you want to do that if you're concerned about data exfiltration right any AWS credentials",
    "start": "2358309",
    "end": "2366440"
  },
  {
    "text": "can work from any any ec2 instance and I'll walk to an example where I have a",
    "start": "2366440",
    "end": "2371779"
  },
  {
    "text": "foreign Alice is able to go and access DynamoDB from within from within it used",
    "start": "2371779",
    "end": "2377089"
  },
  {
    "text": "to do instance in my account the the one other part of this policy I have a second part where I have described",
    "start": "2377089",
    "end": "2383809"
  },
  {
    "text": "tables list table I'm sorry describe limits list tables and list backups and here those resources they don't have",
    "start": "2383809",
    "end": "2391009"
  },
  {
    "text": "resource level controls so you can't limit them you can't list you can't restrict list tables to a",
    "start": "2391009",
    "end": "2396410"
  },
  {
    "text": "particular table and so they you have to grant those resource star so I include",
    "start": "2396410",
    "end": "2401749"
  },
  {
    "text": "this table this this particular statement in there to allow those commands to work as well over the VP's",
    "start": "2401749",
    "end": "2406910"
  },
  {
    "text": "in plane and in reality it doesn't really matter if someone's able to list tables in another account as long as",
    "start": "2406910",
    "end": "2413030"
  },
  {
    "text": "they have permissions in that other account anyway I'm more worried about whether they can send data or pull data",
    "start": "2413030",
    "end": "2418250"
  },
  {
    "text": "in from another account and that's why I limit the the basic permissions and so I",
    "start": "2418250",
    "end": "2424430"
  },
  {
    "text": "did use any region here and you don't generally a VPC endpoint only exists within a single region and so I could if",
    "start": "2424430",
    "end": "2431809"
  },
  {
    "text": "this was in US East one I could have put us east one in here I've used star only because I expect that I want to use the",
    "start": "2431809",
    "end": "2438890"
  },
  {
    "text": "same VPC endpoint policy in multiple places and rather than having separate versions for every different region I",
    "start": "2438890",
    "end": "2444559"
  },
  {
    "text": "can just take this one VPC employee policy and stamp it out and set it up in each region and so it will work in any",
    "start": "2444559",
    "end": "2450470"
  },
  {
    "text": "region but this were to work just as well if I put us east one in there if this endpoint was in US east one and of",
    "start": "2450470",
    "end": "2458990"
  },
  {
    "text": "course any resource that I wanted to access and so here's an example I use",
    "start": "2458990",
    "end": "2466849"
  },
  {
    "text": "this call st st s called get caller identity it's kind of a useful call if you find credentials lying around you",
    "start": "2466849",
    "end": "2472490"
  },
  {
    "text": "want to know what account they're in i I do a lot of playing with that with AWS and so I have many different roles and",
    "start": "2472490",
    "end": "2479539"
  },
  {
    "text": "many different users and sometimes I forget which account they're in and so you can always take those credentials and say AWS STS get caller identity and",
    "start": "2479539",
    "end": "2486770"
  },
  {
    "text": "it will come back and tell you who that is what account they're in and what the idea is what role it is or or what user",
    "start": "2486770",
    "end": "2494029"
  },
  {
    "text": "it is if it's an IM user so here i have that on the ec2 instance this is i ran",
    "start": "2494029",
    "end": "2499190"
  },
  {
    "text": "this call an ec2 instance so it's using ec2 instance credentials and the instance is running inside the account",
    "start": "2499190",
    "end": "2504950"
  },
  {
    "text": "six seven six that's my account and then I have this foreigner called foreign",
    "start": "2504950",
    "end": "2511099"
  },
  {
    "text": "Alice and she's she has credentials on this platform and these credentials show",
    "start": "2511099",
    "end": "2516980"
  },
  {
    "text": "that she's in a different account so she's this is just an IM user who has user access key ID in a secret key and",
    "start": "2516980",
    "end": "2524859"
  },
  {
    "text": "they're in account five one two block right so different account altogether with that VPC endpoint policy i created",
    "start": "2524859",
    "end": "2532690"
  },
  {
    "text": "i'm sorry without that VPC endpoint policy if we ran with four analyses able",
    "start": "2532690",
    "end": "2538099"
  },
  {
    "text": "to list any table and she's also able to describe table or get item or put item",
    "start": "2538099",
    "end": "2543470"
  },
  {
    "text": "on tables in her account right she's not limited to just table - she's not limited and even though",
    "start": "2543470",
    "end": "2550790"
  },
  {
    "text": "she's running in my VPC in my account on my B ec2 instance she's able to access records in her own account if I then",
    "start": "2550790",
    "end": "2559010"
  },
  {
    "text": "turn around then set that endpoint policy I just specified which limits access to only my account when she tries",
    "start": "2559010",
    "end": "2565310"
  },
  {
    "text": "to make the same call she gets a failure in that she's only allowed to access",
    "start": "2565310",
    "end": "2570370"
  },
  {
    "text": "she's not allowed to access the table that because it's not in my account so",
    "start": "2570370",
    "end": "2576830"
  },
  {
    "text": "I'm blocking access to the table in some cases you might want to limit this to",
    "start": "2576830",
    "end": "2582620"
  },
  {
    "text": "tables within your own organization so you might instead of having just one account you want to limit to all the",
    "start": "2582620",
    "end": "2588040"
  },
  {
    "text": "access to any table within my organization and so you can use the context key that I am sets the principal",
    "start": "2588040",
    "end": "2595370"
  },
  {
    "text": "org ID context key and you can put in your VP C endpoint policy allow any principal that looks like it's very",
    "start": "2595370",
    "end": "2601880"
  },
  {
    "text": "broad it says I need any principle in any account and resources stars' or any resource whatsoever but the condition is",
    "start": "2601880",
    "end": "2609020"
  },
  {
    "text": "only when they're in my org right so the they use the principal has to be within",
    "start": "2609020",
    "end": "2615200"
  },
  {
    "text": "your own organization in order to for this to succeed and so that limits the access to just within your own",
    "start": "2615200",
    "end": "2622550"
  },
  {
    "text": "organization so it's another way you can use the B PC endpoint policy to be restricted but not necessarily as",
    "start": "2622550",
    "end": "2628190"
  },
  {
    "text": "restrictive to just the same account so",
    "start": "2628190",
    "end": "2636470"
  },
  {
    "text": "to look at some other stuff that you might want to look at the related to security although not directly but",
    "start": "2636470",
    "end": "2644660"
  },
  {
    "text": "continuous backup in point in time restore and this even though it's not exactly a security feature it's I think",
    "start": "2644660",
    "end": "2651380"
  },
  {
    "text": "it's pretty important from a security point of view because it's it's inexpensive it's easy to set up and",
    "start": "2651380",
    "end": "2656630"
  },
  {
    "text": "allows you to restore your data at any point in time including if someone accident so one deleted your table even",
    "start": "2656630",
    "end": "2662390"
  },
  {
    "text": "if someone deleted your account or suspended your account the table is still there and available for 35 days so",
    "start": "2662390",
    "end": "2667940"
  },
  {
    "text": "you had that data as a backup as a persistent backup that's maintained outside of the account as a way of",
    "start": "2667940",
    "end": "2673370"
  },
  {
    "text": "protecting the day the other thing you can look at is a do best config and monitoring there's some",
    "start": "2673370",
    "end": "2681230"
  },
  {
    "text": "config rules that you can use to monitor your account and make sure your tables are encrypted or make sure your auto",
    "start": "2681230",
    "end": "2686930"
  },
  {
    "text": "scaling is enabled on your tables on an automatic fashion so thank you for for",
    "start": "2686930",
    "end": "2694010"
  },
  {
    "text": "being here please make sure you fill out your [Applause]",
    "start": "2694010",
    "end": "2705619"
  }
]