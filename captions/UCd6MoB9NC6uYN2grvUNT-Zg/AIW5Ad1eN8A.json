[
  {
    "text": "well good morning thank you for coming to this session and thank you for joining us at reinvent so for those of",
    "start": "2090",
    "end": "9719"
  },
  {
    "text": "you who just saw Verner talk one of the things he said was that if you hug a",
    "start": "9719",
    "end": "14969"
  },
  {
    "text": "server the server is unlikely to hug you back in my experience as a network guy if you try to hug a router routers don't",
    "start": "14969",
    "end": "22380"
  },
  {
    "text": "hug you back either so this talk is going to actually share with you how",
    "start": "22380",
    "end": "28560"
  },
  {
    "text": "amazon virtual networks allow you to build a programmable network and do so",
    "start": "28560",
    "end": "35850"
  },
  {
    "text": "in a simple and robust way and allow you to control those networks and so I'd",
    "start": "35850",
    "end": "43950"
  },
  {
    "text": "like to first off see a quick show of hands how many of you have ever been asked this question why can't I connect",
    "start": "43950",
    "end": "49379"
  },
  {
    "text": "to the server probably most of you I hear it up pretty often so today what",
    "start": "49379",
    "end": "55050"
  },
  {
    "text": "we're going to do is actually look at a number of scenarios for four scenarios actually for how four different traffic",
    "start": "55050",
    "end": "62190"
  },
  {
    "text": "flows that occur within Amazon's virtual networks and 0 deep dive on how each of",
    "start": "62190",
    "end": "67920"
  },
  {
    "text": "those traffic flows works and and the steps involve the hops that are involved in those flows and so this is going to",
    "start": "67920",
    "end": "73950"
  },
  {
    "text": "be a pretty technical talk so bear with me as we go into the kind of the technical details of how this happens on",
    "start": "73950",
    "end": "79740"
  },
  {
    "text": "a hop by hop basis just to give you a brief background on myself i I've I'm",
    "start": "79740",
    "end": "85049"
  },
  {
    "text": "Kevin Millar I've worked with I've led a virtual private cloud engineering teams for about the last four years so the",
    "start": "85049",
    "end": "91409"
  },
  {
    "text": "first thing we're going to talk about the first scenario is instance to instance communication within a single",
    "start": "91409",
    "end": "96840"
  },
  {
    "text": "subnet so this would likely be for example if you have two devices in the same availability zone two instances",
    "start": "96840",
    "end": "103829"
  },
  {
    "text": "that is in the same availability zone talking back and forth and then we're going to take it up one level and talk",
    "start": "103829",
    "end": "109439"
  },
  {
    "text": "about instances that are crossing subnets so for example an instance that would be in one availability zone",
    "start": "109439",
    "end": "115200"
  },
  {
    "text": "talking to an instance in another availability zone because that would that would be between two subnets by",
    "start": "115200",
    "end": "120960"
  },
  {
    "text": "definition and then the third scenario we're going to look at is what happens when you go from an incidence out to the Internet and finally we'll talk about",
    "start": "120960",
    "end": "127829"
  },
  {
    "text": "what happens when you want an instance is communicating with",
    "start": "127829",
    "end": "132910"
  },
  {
    "text": "host your own data center or your your corporate network using our VPN or direct connect service alright so when I",
    "start": "132910",
    "end": "141450"
  },
  {
    "text": "the first thing that I like to do when I look at I hear about this question you know my I can't connect to the server is",
    "start": "141450",
    "end": "147790"
  },
  {
    "text": "I start by dre in many cases actually getting out a piece of paper and drawing out the the two machines that are the",
    "start": "147790",
    "end": "154690"
  },
  {
    "text": "two instances that are having difficulty communicating and then making sure that I'm identifying which is the direction",
    "start": "154690",
    "end": "161260"
  },
  {
    "text": "that we're actually seeing the communication difficulty and I like to actually even be very explicit in write",
    "start": "161260",
    "end": "167080"
  },
  {
    "text": "down what are the IP address is involved and what's the IP protocol that's involved and what are the source and",
    "start": "167080",
    "end": "172960"
  },
  {
    "text": "destination ports so we're very explicit about what the what problem we're trying to troubleshoot because in many cases",
    "start": "172960",
    "end": "179170"
  },
  {
    "text": "you it may seem that you're having a problem communicating from instance a to",
    "start": "179170",
    "end": "184180"
  },
  {
    "text": "instance be but in reality it actually may be the opposite path it may be that",
    "start": "184180",
    "end": "189190"
  },
  {
    "text": "the packets are getting to the instance be but they're not making the responses aren't coming back so it's important",
    "start": "189190",
    "end": "194500"
  },
  {
    "text": "that we we identify that up front and one of the first tools that i often use what i'm trying to answer that very",
    "start": "194500",
    "end": "200110"
  },
  {
    "text": "question is is just a simple TCP dump or you can use wireshark for example on windows as well and using these tools",
    "start": "200110",
    "end": "207400"
  },
  {
    "text": "here's an example where I just ran a TCP dump on an instance and saw the the",
    "start": "207400",
    "end": "213730"
  },
  {
    "text": "traffic that was flowing and then from that output you can extract as I've shown at the bottom with the colors you",
    "start": "213730",
    "end": "220420"
  },
  {
    "text": "can extract the the instances that are involved the IP addresses of the two instances as well as the source ports",
    "start": "220420",
    "end": "226450"
  },
  {
    "text": "and destination ports and of course in this version in this TCP dump output that's actually translating port 22 into",
    "start": "226450",
    "end": "233560"
  },
  {
    "text": "its more common name of ssh but there's a flag to TCP dump as well if you want to that turned off so again this is kind",
    "start": "233560",
    "end": "241030"
  },
  {
    "text": "of the first step to identify which path the problem is occurring and then we can",
    "start": "241030",
    "end": "247570"
  },
  {
    "text": "start really digging in so today you're going to see this this diagram a couple",
    "start": "247570",
    "end": "253450"
  },
  {
    "text": "times and this is just a kind of a sample network that I put together to try to illustrate some of these packet",
    "start": "253450",
    "end": "258820"
  },
  {
    "text": "flows that I've I'm going to be talking about through today and so you can see I had in this simple network i have three",
    "start": "258820",
    "end": "265090"
  },
  {
    "text": "subnets these could be some that's in the same availability zone or across availability",
    "start": "265090",
    "end": "270280"
  },
  {
    "text": "zones as you may know subnets a single subnet exists in a single availability",
    "start": "270280",
    "end": "276009"
  },
  {
    "text": "zone so you could think of this even as a well in this case subnet one in Summit",
    "start": "276009",
    "end": "282490"
  },
  {
    "text": "to hack would have to be in the same availability zone because instance be actually has two interfaces in those two",
    "start": "282490",
    "end": "287710"
  },
  {
    "text": "subnets but in this case I have the three subnets I have two instances that are connected into my subnet one another",
    "start": "287710",
    "end": "294280"
  },
  {
    "text": "single instance instance sees on my subnet three and then instance be uses takes advantage of our new feature one",
    "start": "294280",
    "end": "300819"
  },
  {
    "text": "of our newest features which is that it can have multiple elastic network interfaces and so in this case it has an",
    "start": "300819",
    "end": "306940"
  },
  {
    "text": "elastic network interface into both subnet one and two I'm sorry before I go",
    "start": "306940",
    "end": "312310"
  },
  {
    "text": "on I'll just uh so today right now I'm going to be talking again about communication from instance a to",
    "start": "312310",
    "end": "317500"
  },
  {
    "text": "instance be just on this subnet one so I'll just go straight over there instance eight instance be and so this",
    "start": "317500",
    "end": "325990"
  },
  {
    "text": "is a diagram of the hops that a packet is going to be processed through in",
    "start": "325990",
    "end": "332860"
  },
  {
    "text": "order to make its way from instance a over to instance be and what I'm going to do is actually just walk through each",
    "start": "332860",
    "end": "338560"
  },
  {
    "text": "of these hops and share how you can investigate and understand how to correctly configure each one each of",
    "start": "338560",
    "end": "345219"
  },
  {
    "text": "these steps and so the first step is the routing table on the local instance and this is a step that is sometimes",
    "start": "345219",
    "end": "351669"
  },
  {
    "text": "overlooked but the routing table on the instance does matter packets as they're",
    "start": "351669",
    "end": "358029"
  },
  {
    "text": "leaving instance a directed to instance be the routing table will will come into",
    "start": "358029",
    "end": "363789"
  },
  {
    "text": "play though the first step is for the kernel to check its routing table and identify what the destination the next",
    "start": "363789",
    "end": "370270"
  },
  {
    "text": "hop will be so as an example this is an example out for output from linux or",
    "start": "370270",
    "end": "376930"
  },
  {
    "text": "windows linux and windows that show you the routing table and in this case because i'm going between two instances",
    "start": "376930",
    "end": "384819"
  },
  {
    "text": "in the same subnet it's actually going to follow the the 10 / 24 route which",
    "start": "384819",
    "end": "390460"
  },
  {
    "text": "indicates to the kernel that this is a directly connected subnet and that's actually the indication to the kernel",
    "start": "390460",
    "end": "396460"
  },
  {
    "text": "that it needs to do the next step which talk about which is to do than an art resolution to find the mac address for",
    "start": "396460",
    "end": "402949"
  },
  {
    "text": "that for that other instance if it was crossing subnets it would actually have hit the default route in which case the",
    "start": "402949",
    "end": "409610"
  },
  {
    "text": "colonel would then forward that directly to its default gateway which would be the 1000 one so again this is the first",
    "start": "409610",
    "end": "416689"
  },
  {
    "text": "step as I as I mentioned the second step will then be a look up into the ARP table and the art table is very easy to",
    "start": "416689",
    "end": "424759"
  },
  {
    "text": "query about again both on linux and windows you can identify what the our",
    "start": "424759",
    "end": "430279"
  },
  {
    "text": "table currently shows what the colonel has and of course the Colonel's typically will resolve an IP address",
    "start": "430279",
    "end": "437389"
  },
  {
    "text": "into its MAC address and then cash that data for some period of time so you can inspect what the current cash is to see",
    "start": "437389",
    "end": "443839"
  },
  {
    "text": "that it's in fact resolved in this case as I'm showing it here that it's actually resolved the mac address for",
    "start": "443839",
    "end": "450139"
  },
  {
    "text": "that I flat IP address if you did not see it properly resolved and then that would be an indication either that that",
    "start": "450139",
    "end": "456769"
  },
  {
    "text": "instance isn't running or that instance may have may have failed for some reason and it's not able to respond so",
    "start": "456769",
    "end": "465080"
  },
  {
    "text": "following the art table the next step will be a it'll be processed through the outbound firewall most virtual machines",
    "start": "465080",
    "end": "473119"
  },
  {
    "text": "these days do have outbound firewalls although in some cases there they're not configured but it you know for",
    "start": "473119",
    "end": "480259"
  },
  {
    "text": "completeness it's it's important that you consider what the the firewall looks like and on Linux so it's actually you",
    "start": "480259",
    "end": "485689"
  },
  {
    "text": "know again very easy to inspect using command line tools you can inspect what the firewall currently shows and you can",
    "start": "485689",
    "end": "492889"
  },
  {
    "text": "also in this output here you can inspect how many packets and bites have hit each",
    "start": "492889",
    "end": "499610"
  },
  {
    "text": "one of your rules in your outbound firewall so this is a good way to kind of sanity check your if you're having a",
    "start": "499610",
    "end": "505879"
  },
  {
    "text": "problem when you're not a stunt you know you're having lost between instances you can inspect your firewall rules and make",
    "start": "505879",
    "end": "511369"
  },
  {
    "text": "sure that the the rules that you think are being hit are in fact the ones that are are being hit you can watch the",
    "start": "511369",
    "end": "516979"
  },
  {
    "text": "counters and make sure that that's you know the counters that you expect to be growing are in fact growing okay so",
    "start": "516979",
    "end": "525050"
  },
  {
    "text": "moving on then now we have at this point we've passed all of the kind of steps within the",
    "start": "525050",
    "end": "530880"
  },
  {
    "text": "and the packet is forwarded into the virtual private cloud into into the AWS",
    "start": "530880",
    "end": "536130"
  },
  {
    "text": "service and the first stop there is what we call the source desk check and this",
    "start": "536130",
    "end": "542310"
  },
  {
    "text": "is an important a check that's done it's actually a security mechanism that we have in our in our platform and what",
    "start": "542310",
    "end": "549030"
  },
  {
    "text": "this does is for packets that are coming into the network it will verify that the",
    "start": "549030",
    "end": "555270"
  },
  {
    "text": "source IP address of the packet is one of the IP addresses that that we know",
    "start": "555270",
    "end": "561450"
  },
  {
    "text": "belongs to that that instance and so this is one of the mechanisms we have which will prevent an instance from",
    "start": "561450",
    "end": "567870"
  },
  {
    "text": "spoofing its IP address coming into the network and this source desk check is",
    "start": "567870",
    "end": "573120"
  },
  {
    "text": "actually easy to identify easy to compare to check on the AWS management",
    "start": "573120",
    "end": "579210"
  },
  {
    "text": "console as I've as I've shown here and we actually we also actually provide a",
    "start": "579210",
    "end": "584310"
  },
  {
    "text": "way for you to turn off the source desk check if you have a use case that",
    "start": "584310",
    "end": "590520"
  },
  {
    "text": "requires it so for example if you're running an instance that's doing NAT or",
    "start": "590520",
    "end": "595560"
  },
  {
    "text": "VPN this would be something that you would need to disable to so that you could send packets out this interface",
    "start": "595560",
    "end": "602760"
  },
  {
    "text": "that have different source IPS from one of the IPS that's actually assigned to",
    "start": "602760",
    "end": "608820"
  },
  {
    "text": "that instance and so again you know showing here this is how you can actually just go through our management",
    "start": "608820",
    "end": "613860"
  },
  {
    "text": "console or use our command line tools are shown to turn that check off and",
    "start": "613860",
    "end": "619110"
  },
  {
    "text": "that can be done on an individual instance basis alright so then after we",
    "start": "619110",
    "end": "624480"
  },
  {
    "text": "pass the source test check the next check then is through our outbound security groups and again this is a",
    "start": "624480",
    "end": "629820"
  },
  {
    "text": "powerful feature of Amazon's virtual networks that allows you to specify",
    "start": "629820",
    "end": "635660"
  },
  {
    "text": "firewall rules that we enforce in the infrastructure on the instances that are",
    "start": "635660",
    "end": "641490"
  },
  {
    "text": "running and security groups have great capabilities in in that you can create",
    "start": "641490",
    "end": "647130"
  },
  {
    "text": "rules that refer to other members of the security group so rather than needing to",
    "start": "647130",
    "end": "652320"
  },
  {
    "text": "track individual IP addresses for all of your instances you can have them belong to a security group and then create",
    "start": "652320",
    "end": "658200"
  },
  {
    "text": "rules that refer to members of that security group so the the first",
    "start": "658200",
    "end": "663779"
  },
  {
    "text": "stop here will then be the security group outbound rules and this is something that if you've used ec2 for a",
    "start": "663779",
    "end": "669210"
  },
  {
    "text": "while you know that historically ec tube has not had the ability to have security",
    "start": "669210",
    "end": "676560"
  },
  {
    "text": "group rules on the outbound direction this is now a feature of Amazon virtual private cloud if you're running in bpc",
    "start": "676560",
    "end": "682650"
  },
  {
    "text": "you can create these outbound security group rules and so here's an example through again through our management",
    "start": "682650",
    "end": "688200"
  },
  {
    "text": "console where you can you can see what the rules are that have been configured for this particular security group and",
    "start": "688200",
    "end": "694550"
  },
  {
    "text": "this is as you can see this is a security group named management and so this would apply to any instances that",
    "start": "694550",
    "end": "701370"
  },
  {
    "text": "are that are launched into that management security group and you can actually change what groups the an",
    "start": "701370",
    "end": "707790"
  },
  {
    "text": "instance belongs to dynamically again using our management console even after the instance is running and on the",
    "start": "707790",
    "end": "714510"
  },
  {
    "text": "outbound direction the rules you can see on the right-hand side here the rules show the ports and the destination",
    "start": "714510",
    "end": "721130"
  },
  {
    "text": "ranges these would apply to the so here the the outbound security group will be",
    "start": "721130",
    "end": "726750"
  },
  {
    "text": "looking at your destination port will look at the packets destination port and the destination IP address and then it",
    "start": "726750",
    "end": "733800"
  },
  {
    "text": "will match it into the security group rules security rules are all allows there's no ability and security groups",
    "start": "733800",
    "end": "741390"
  },
  {
    "text": "to define denies and I'll actually have a slide later where I kind of compare and contrast where we can do some denies",
    "start": "741390",
    "end": "748410"
  },
  {
    "text": "if you're if you if you need that kind of capability ok so now the packet has",
    "start": "748410",
    "end": "754260"
  },
  {
    "text": "passed all of the outbound checks and the packet will then be forwarded through virtual private cloud in to",
    "start": "754260",
    "end": "761010"
  },
  {
    "text": "towards your other instance and as it's approaching that other instance before we before we deliver the packet out of",
    "start": "761010",
    "end": "767550"
  },
  {
    "text": "the network into your instance then we start to apply the kind of the inbound",
    "start": "767550",
    "end": "772680"
  },
  {
    "text": "rules and so the first one that we apply is an inbound security group check this is very similar to the outbound security",
    "start": "772680",
    "end": "779070"
  },
  {
    "text": "group rules the the only kind of difference is that the in this case on",
    "start": "779070",
    "end": "784200"
  },
  {
    "text": "the inbound side we're comparing the source IP address and the destination port and those are the two pieces of the",
    "start": "784200",
    "end": "792089"
  },
  {
    "text": "packet that are then compared to the secure your rules to determine if the traffic is allowed to pass okay again on the",
    "start": "792089",
    "end": "801450"
  },
  {
    "text": "inbound side then we have another source desk check in this case we are checking that the destination IP address matches",
    "start": "801450",
    "end": "808440"
  },
  {
    "text": "one of the IP address is configured on that interface so again on the outbound side we check for the source IP we make",
    "start": "808440",
    "end": "815820"
  },
  {
    "text": "sure the source IP matches on the inbound side we make sure the destination IP matches and so this is",
    "start": "815820",
    "end": "820980"
  },
  {
    "text": "you know again another check a security check that ensures that instances are only seeing the traffic that they that",
    "start": "820980",
    "end": "828330"
  },
  {
    "text": "is addressed to them okay and then",
    "start": "828330",
    "end": "833970"
  },
  {
    "text": "finally the packet will be then delivered up to your instance delivered through your virtual the virtual network",
    "start": "833970",
    "end": "840180"
  },
  {
    "text": "adapters into your instance and they'll go through the inbound firewall rules if you have any configured and you know",
    "start": "840180",
    "end": "847050"
  },
  {
    "text": "again using the same kind of tools that we used earlier you can we can just look to see what the what the rules are and",
    "start": "847050",
    "end": "853200"
  },
  {
    "text": "whether what how many packets are getting them how many bytes are being hit by them okay so we have now seen",
    "start": "853200",
    "end": "861870"
  },
  {
    "text": "kind of the the steps involved from getting a packet from instance aid over to instance be and it's important to",
    "start": "861870",
    "end": "868440"
  },
  {
    "text": "keep in mind that the you know so I've shown you the path from A to B but as I",
    "start": "868440",
    "end": "874950"
  },
  {
    "text": "mentioned up front if if the actual problem is with B to a then all of this",
    "start": "874950",
    "end": "880410"
  },
  {
    "text": "would just be flipped all these rules would just be applied in the reverse direction and so for any given flow to",
    "start": "880410",
    "end": "886800"
  },
  {
    "text": "be too forward really both directions need to be configured and working ok so",
    "start": "886800",
    "end": "894320"
  },
  {
    "text": "now I'm going to talk about a slightly more complicated scenario and what I'm",
    "start": "894320",
    "end": "901050"
  },
  {
    "text": "going to show and I'll so quickly jump back but I'm going to we're going to talk between instance be and instance",
    "start": "901050",
    "end": "906780"
  },
  {
    "text": "see and so as you can see instance be actually has two interfaces that the",
    "start": "906780",
    "end": "912450"
  },
  {
    "text": "traffic can come and go and then of course incidence see is kind of sitting on its own on the far side on subnet",
    "start": "912450",
    "end": "917820"
  },
  {
    "text": "three it's kind of lonely we'll get some packets to it here at a moment so an",
    "start": "917820",
    "end": "923339"
  },
  {
    "text": "instance be I'm showing an additional step that we kind of glossed over in the first",
    "start": "923339",
    "end": "928610"
  },
  {
    "text": "example and that's the IP routing policy database and this is uh this is actually a Linux feature and the IP routing",
    "start": "928610",
    "end": "937310"
  },
  {
    "text": "policy database is I'm going to show is actually pretty important because instance be has that has two IP",
    "start": "937310",
    "end": "942830"
  },
  {
    "text": "addresses and the all of this the the",
    "start": "942830",
    "end": "948020"
  },
  {
    "text": "security group rules and the other rules that apply to this traffic are going to be based on which interface the traffic",
    "start": "948020",
    "end": "954980"
  },
  {
    "text": "is actually sent out of instance be whether it's sent over its interface in",
    "start": "954980",
    "end": "960080"
  },
  {
    "text": "subnet one or the interface in subnet two and so as an example of the kind of",
    "start": "960080",
    "end": "965810"
  },
  {
    "text": "problem that can crop up when you have in instances with that have multiple interfaces this is an example where I",
    "start": "965810",
    "end": "973010"
  },
  {
    "text": "have an instance my instance be has its two interfaces that we've been talking about an instance there's another",
    "start": "973010",
    "end": "979490"
  },
  {
    "text": "instance in that in the 1001 network that's active it's trying to talk to instance be so if that instance connects",
    "start": "979490",
    "end": "986720"
  },
  {
    "text": "to the 1000 to 11 IP address on the",
    "start": "986720",
    "end": "991730"
  },
  {
    "text": "traffic will make it over to instance be but depending on what is configured in our main routing table that and likely",
    "start": "991730",
    "end": "999770"
  },
  {
    "text": "in a default configuration out of the box configuration the response back to",
    "start": "999770",
    "end": "1006640"
  },
  {
    "text": "that instance to the 1001 50 instance would be routed out the eath one interface and so what we would actually",
    "start": "1006640",
    "end": "1013360"
  },
  {
    "text": "see on the wire on the network is a packet that has the source IP that of",
    "start": "1013360",
    "end": "1019060"
  },
  {
    "text": "211 because that's what this other instance connected to and the destination would be the 1001 50 address",
    "start": "1019060",
    "end": "1025480"
  },
  {
    "text": "and if that is forwarded out eath one by default that's what that Peck traffic will be dropped because the source desk",
    "start": "1025480",
    "end": "1032020"
  },
  {
    "text": "checked will fail and it's likely that you may have security groups or other rules that are going to block that traffic as well and so this is where the",
    "start": "1032020",
    "end": "1038890"
  },
  {
    "text": "IP routing database I sweet I'm sorry the IP routing rules actually start to",
    "start": "1038890",
    "end": "1044439"
  },
  {
    "text": "matter a lot and I'm going to show you how that how that works so again you",
    "start": "1044440",
    "end": "1050170"
  },
  {
    "text": "know here's the configuration you can use some simple command line to identify the configuration we have our 80 and our",
    "start": "1050170",
    "end": "1056080"
  },
  {
    "text": "eighth one on the the two different networks and in a default out of box configuration will",
    "start": "1056080",
    "end": "1063220"
  },
  {
    "text": "have an IP or our main routing table will have a default route through one of them usually the ECR oh and then the the",
    "start": "1063220",
    "end": "1071220"
  },
  {
    "text": "routes to the subnet one and subnet two will be configured as local routes so if",
    "start": "1071220",
    "end": "1077020"
  },
  {
    "text": "when traffic is being sent back to the 1001 address it's going to it will it",
    "start": "1077020",
    "end": "1082090"
  },
  {
    "text": "will the routing table will do a longest prefix match and it will match this this third rule and then it'll be sent out",
    "start": "1082090",
    "end": "1088870"
  },
  {
    "text": "eighth one and at the bottom here I've shown just a kind of a simple way that you can actually test this even without",
    "start": "1088870",
    "end": "1096039"
  },
  {
    "text": "having something else connect in you can in this case you can kind of force SS age to try to use a different IP address",
    "start": "1096039",
    "end": "1103360"
  },
  {
    "text": "use one IP address to initiate the connection and in this case it's trying to initiate a connection using the",
    "start": "1103360",
    "end": "1109390"
  },
  {
    "text": "subnet one IP address to a something on subnet to and if we do a tcp down bullet",
    "start": "1109390",
    "end": "1115360"
  },
  {
    "text": "will see that it's it's sending it out the youth one interface and it's not getting a response so how do we fix this",
    "start": "1115360",
    "end": "1121659"
  },
  {
    "text": "well the IP rule database comes in really handy here because what you can configure is actually you can configure",
    "start": "1121659",
    "end": "1129010"
  },
  {
    "text": "secondary routing tables Linux has this support for multiple routing tables and",
    "start": "1129010",
    "end": "1134909"
  },
  {
    "text": "the way that so here's an example just of how you can configure it and what you do is you basically first off create an",
    "start": "1134909",
    "end": "1142240"
  },
  {
    "text": "alias for the routing table just so we can refer to it by a friendly name so in this case I'm referring to it as my",
    "start": "1142240",
    "end": "1147850"
  },
  {
    "text": "eighth one routing table each one RT and then I add a rule to the IP rule",
    "start": "1147850",
    "end": "1153220"
  },
  {
    "text": "database to say any traffic that is being sent with a source IP of 1001 99 I",
    "start": "1153220",
    "end": "1160600"
  },
  {
    "text": "want you to instead of using the main routing table to route that traffic I want you to route that using my eath one",
    "start": "1160600",
    "end": "1166240"
  },
  {
    "text": "routing table and you can then inspect that rule list and you can see the rule 32 765 is the one that I just added and",
    "start": "1166240",
    "end": "1174150"
  },
  {
    "text": "the normal rule and everyone who's running a Linux instance actually is running has this database today and so",
    "start": "1174150",
    "end": "1181659"
  },
  {
    "text": "your packets are actually going through this most cases you're going to be using this 32 766 rule which sends it to your",
    "start": "1181659",
    "end": "1188770"
  },
  {
    "text": "main routing table so once I've created my IP rule I can then create a I can then update the",
    "start": "1188770",
    "end": "1196130"
  },
  {
    "text": "routes or add the routes into my eath one routing table and all I really need to do is add a default route which says",
    "start": "1196130",
    "end": "1201140"
  },
  {
    "text": "send any traffic that that hits the f1 routing table I want you to send it via my youth one device and then the last",
    "start": "1201140",
    "end": "1209330"
  },
  {
    "text": "line here is basically to flush the the IP route cash which linux has this IP",
    "start": "1209330",
    "end": "1214700"
  },
  {
    "text": "route catch mechanism and this just just clears the cache so that it really for",
    "start": "1214700",
    "end": "1220460"
  },
  {
    "text": "any traffic it'll-it'll reevaluate and recreant restart its cache and so an",
    "start": "1220460",
    "end": "1227300"
  },
  {
    "text": "exercise one last thing I want to mention is that if you're running a linux using the amazon linux ami some of",
    "start": "1227300",
    "end": "1234740"
  },
  {
    "text": "the most recent amies we've actually gone ahead and added some capabilities some configuration in there to",
    "start": "1234740",
    "end": "1240290"
  },
  {
    "text": "automatically take care of this for you so this is something that if you're running you know a linux it's not amazon",
    "start": "1240290",
    "end": "1246920"
  },
  {
    "text": "linux you want to keep this in mind particularly when you have multiple multiple interfaces multiple Ian's eyes",
    "start": "1246920",
    "end": "1252640"
  },
  {
    "text": "but with amazon linux we we actually create something that's almost exactly",
    "start": "1252640",
    "end": "1257870"
  },
  {
    "text": "what i've shown here so so the first top for your packet is through the IP",
    "start": "1257870",
    "end": "1263690"
  },
  {
    "text": "routing policy database and once then you determine if you're using multiple",
    "start": "1263690",
    "end": "1270470"
  },
  {
    "text": "routing tables as i've just shown then it will i will then route that that",
    "start": "1270470",
    "end": "1276020"
  },
  {
    "text": "traffic according to the appropriate routing table and will then also apply the outbound firewall rules and all of",
    "start": "1276020",
    "end": "1282950"
  },
  {
    "text": "this is analogous to what we saw in the first example so i'm not going to recover it once the traffic has passed",
    "start": "1282950",
    "end": "1290930"
  },
  {
    "text": "the past the instance it'll be sent into the the virtual private cloud network on",
    "start": "1290930",
    "end": "1296210"
  },
  {
    "text": "one of those en eyes and then and of course that's really important because the security group rules and the source",
    "start": "1296210",
    "end": "1304370"
  },
  {
    "text": "desk check flag and the network ackles all of that matters all of that is kind of bound to the Eni and the the subnet",
    "start": "1304370",
    "end": "1311990"
  },
  {
    "text": "that that Eni is in so it's really important you know particularly when troubleshooting networking problems with",
    "start": "1311990",
    "end": "1317420"
  },
  {
    "text": "instances that have multiple UN eyes it's really important to make sure you understand which enter is being used since that will control",
    "start": "1317420",
    "end": "1324070"
  },
  {
    "text": "everything else so you know once we're into the VPC network we're going to use",
    "start": "1324070",
    "end": "1330580"
  },
  {
    "text": "the the source desk checked or the source desk check and the security group rules the that are applicable to that",
    "start": "1330580",
    "end": "1335980"
  },
  {
    "text": "eni are applied again this is just like we described earlier then we will so",
    "start": "1335980",
    "end": "1342340"
  },
  {
    "text": "this is net we now have the two kind of different steps here that apply when you're sending traffic between subnets",
    "start": "1342340",
    "end": "1349090"
  },
  {
    "text": "so in our first example again it was just all within the same subnet so the routing table and the network ackles",
    "start": "1349090",
    "end": "1354400"
  },
  {
    "text": "don't apply in that situation but now that we're going between subnets they do so virtual private cloud has the ability",
    "start": "1354400",
    "end": "1362170"
  },
  {
    "text": "to configure your router tables and you can actually configure different route tables on each subnet and so if you go",
    "start": "1362170",
    "end": "1369850"
  },
  {
    "text": "into our management console and you look at the subnet you pull up your subnet detail you can see the you know the",
    "start": "1369850",
    "end": "1376090"
  },
  {
    "text": "details for the subnet itself the IP range that subnet is in along with the VPC along with the availability zone but",
    "start": "1376090",
    "end": "1384550"
  },
  {
    "text": "as you can see here you can also see the routing table that's applied to it and the network akal that's applied and you",
    "start": "1384550",
    "end": "1390970"
  },
  {
    "text": "can change both the network akal in the routing table on a subnet anytime you want so this is a pretty powerful",
    "start": "1390970",
    "end": "1396400"
  },
  {
    "text": "feature to you know to build programming on so it's a programmable network you can configure this dynamically using our",
    "start": "1396400",
    "end": "1403420"
  },
  {
    "text": "AP is and our command line tools but in this case I see that the route table is",
    "start": "1403420",
    "end": "1408880"
  },
  {
    "text": "this rtb you can see the ID there and you can see that the routes that are configured in that so I in this case I",
    "start": "1408880",
    "end": "1415150"
  },
  {
    "text": "have a route to my v pc as a whole my v pc in this case is just 10 / 16 and so",
    "start": "1415150",
    "end": "1421870"
  },
  {
    "text": "there's a destination route to that as well as then a default route through to an IG w and an IG w is just an Internet",
    "start": "1421870",
    "end": "1429100"
  },
  {
    "text": "gateway so any traffic that doesn't go to another instance in my in this coming",
    "start": "1429100",
    "end": "1434830"
  },
  {
    "text": "out of this subnet will be routed to my ig w you can also look at the the",
    "start": "1434830",
    "end": "1440230"
  },
  {
    "text": "routing table directly there's a separate view in the management console where you can pull up the routing table",
    "start": "1440230",
    "end": "1445450"
  },
  {
    "text": "alone and that will show you if there's a few other flags you can see here and",
    "start": "1445450",
    "end": "1450700"
  },
  {
    "text": "most important i think is the status you can see both of these routes are are active and I'll",
    "start": "1450700",
    "end": "1455920"
  },
  {
    "text": "talk a little bit later about about that as well routing tables in VPC our longest prefix match just like routing",
    "start": "1455920",
    "end": "1463030"
  },
  {
    "text": "tables on an instance are so we you know when you when a packet is going outbound we from a subnet we look at all of the",
    "start": "1463030",
    "end": "1470680"
  },
  {
    "text": "rules in the routing table and we choose the one that has the most specific match to the destination IP address and and",
    "start": "1470680",
    "end": "1477610"
  },
  {
    "text": "then that is the that is the route that is used to forward the traffic all right",
    "start": "1477610",
    "end": "1485560"
  },
  {
    "text": "so after we pass through the routing table I'm sorry one last thing I wanted to mention about routing tables is that",
    "start": "1485560",
    "end": "1491820"
  },
  {
    "text": "you're not able to specify a route in the routing table that's more specific than the VPC as a whole so you can see",
    "start": "1491820",
    "end": "1499180"
  },
  {
    "text": "here that I have a route to 10 / 16 which is my VPC that's done automatically by the system when you create a routing table you're you're not",
    "start": "1499180",
    "end": "1506200"
  },
  {
    "text": "able to actually create something that's more specific but you can create routes for destinations that are other than",
    "start": "1506200",
    "end": "1512470"
  },
  {
    "text": "your VPC itself so we go through the routing table and we identify what the",
    "start": "1512470",
    "end": "1519520"
  },
  {
    "text": "next top is going to be and at that point then the packet is processed by our network ackles again network cackles",
    "start": "1519520",
    "end": "1525940"
  },
  {
    "text": "apply when traffic is going between subnets and so actually the the previous",
    "start": "1525940",
    "end": "1531850"
  },
  {
    "text": "slide showed the the subnet and you can see the network akal is actually visible on the subnet itself but we can we also",
    "start": "1531850",
    "end": "1538810"
  },
  {
    "text": "have a separate view where you can see the network akal just as on its own and so you can see each of the rules in the",
    "start": "1538810",
    "end": "1545920"
  },
  {
    "text": "in the network akal in the case of the outbound network ackles we will match on",
    "start": "1545920",
    "end": "1551260"
  },
  {
    "text": "the destination IP address and the destination port and then protocol and the overall protocol and so I wanted to",
    "start": "1551260",
    "end": "1558730"
  },
  {
    "text": "at this point kind of briefly compare and contrast security groups and network ackles just so that you can understand",
    "start": "1558730",
    "end": "1564280"
  },
  {
    "text": "what are the differences between them so you can see the differences and really the first three are identical they in",
    "start": "1564280",
    "end": "1570250"
  },
  {
    "text": "both cases you can filter them both inbound and outbound you can configure rules in both directions they're fully",
    "start": "1570250",
    "end": "1576100"
  },
  {
    "text": "manageable through all of our normal systems or tools and api's all of them",
    "start": "1576100",
    "end": "1581230"
  },
  {
    "text": "in this is you know for VPC specifically all of them can filter on TCP or UDP ports as well as any IP pro",
    "start": "1581230",
    "end": "1589030"
  },
  {
    "text": "call so you can create rules for example 2 to allow IPSec traffic you know which is an IP protocol 50 for example however",
    "start": "1589030",
    "end": "1597460"
  },
  {
    "text": "there are then differences security groups are stateful which means that when you have a rule that allows traffic",
    "start": "1597460",
    "end": "1604420"
  },
  {
    "text": "inbound we will automatically then create a essentially an ephemeral rule",
    "start": "1604420",
    "end": "1609850"
  },
  {
    "text": "that allows the outbound traffic that matches that flow so you you only have to allow the traffic in one direction to",
    "start": "1609850",
    "end": "1616480"
  },
  {
    "text": "get the flow going in both directions on the key on the other side network ackles are in fact stateless which which can be",
    "start": "1616480",
    "end": "1622900"
  },
  {
    "text": "you know a point of of proc can can cause problems when you configure the",
    "start": "1622900",
    "end": "1630100"
  },
  {
    "text": "inbound side for example but you don't configure return traffic because you would need to and we in fact the console",
    "start": "1630100",
    "end": "1636310"
  },
  {
    "text": "even prompts you for this if you if you fill out in more inbound tcp traffic and you put a restrictive Hackel in place",
    "start": "1636310",
    "end": "1642880"
  },
  {
    "text": "for outbound traffic you would need to allow it back to the normal ephemeral port range which is 1024 265 535 again",
    "start": "1642880",
    "end": "1652900"
  },
  {
    "text": "security groups apply to all traffic in and out of the instance in and out of every ni you can have security groups",
    "start": "1652900",
    "end": "1658870"
  },
  {
    "text": "and the traffic is filtered through the security group however network ackles only come into play when you're going between between subnets security groups",
    "start": "1658870",
    "end": "1667060"
  },
  {
    "text": "you can have multiple secure groups on every instance and again you can dynamically add or change the security groups that of instance or knee and I",
    "start": "1667060",
    "end": "1673270"
  },
  {
    "text": "belongs to but network ackles there's just one akal for the subnet so if you",
    "start": "1673270",
    "end": "1679060"
  },
  {
    "text": "want to change the rules you can change the rules any time you can also change the whole akal so you can create a new",
    "start": "1679060",
    "end": "1685870"
  },
  {
    "text": "akal that has all the rules you want and then do a switch and basically make that new akal the active one but you can only",
    "start": "1685870",
    "end": "1693460"
  },
  {
    "text": "have one akal its active on a subnet at any one time with network cackles I like",
    "start": "1693460",
    "end": "1700420"
  },
  {
    "text": "to think of network cackles as being similar to router ackles if you're familiar with configuring you know",
    "start": "1700420",
    "end": "1706330"
  },
  {
    "text": "routers in as much as you can interleave allow rules and denies so you could",
    "start": "1706330",
    "end": "1712180"
  },
  {
    "text": "create for example a couple very limited allows and then a blanket deny for a",
    "start": "1712180",
    "end": "1717640"
  },
  {
    "text": "whole you know I'm going to allow port 80 traffic from a couple hosts but then I'm going to deny port 80 traffic from any where else and then I'll continue",
    "start": "1717640",
    "end": "1723850"
  },
  {
    "text": "processing so you can interleave those allows and denies and finally because of",
    "start": "1723850",
    "end": "1728950"
  },
  {
    "text": "that interleaving and because well because of that interleaving and the fact that you can have these allows and",
    "start": "1728950",
    "end": "1734080"
  },
  {
    "text": "denies Network cackles are are ordered so as you saw as we see here the rule",
    "start": "1734080",
    "end": "1741010"
  },
  {
    "text": "number is the ordering you know so when you go to create your network ackles you're able to go in and say I want to",
    "start": "1741010",
    "end": "1746290"
  },
  {
    "text": "create a new rule number 201 and that'll be logically inserted there in a numeric",
    "start": "1746290",
    "end": "1752470"
  },
  {
    "text": "order okay so packets are processed through our outbound network cackled and",
    "start": "1752470",
    "end": "1758440"
  },
  {
    "text": "then they're routed at this point you know the route assuming the route well this all within the VPC so this traffic",
    "start": "1758440",
    "end": "1765100"
  },
  {
    "text": "would be then routed over to instance see and we're processed on the way back in we start processing through the the",
    "start": "1765100",
    "end": "1770410"
  },
  {
    "text": "network akal on the inbound side so on the inbound side the we compare the",
    "start": "1770410",
    "end": "1776470"
  },
  {
    "text": "source IP address and the destination port just like we do in security groups in terms of the the comparison of the",
    "start": "1776470",
    "end": "1783850"
  },
  {
    "text": "those idea the source IP and the destination port we do the same thing on the network cackles and those are",
    "start": "1783850",
    "end": "1789790"
  },
  {
    "text": "processed through the inbound Network aquil rules and then really the last",
    "start": "1789790",
    "end": "1795580"
  },
  {
    "text": "three steps are analogous to what we saw in the first example where we process them through the security group the",
    "start": "1795580",
    "end": "1802210"
  },
  {
    "text": "source desk check and then the amount firewall in the instance and that traffic is then delivered ultimately to the instance so now we've seen traffic",
    "start": "1802210",
    "end": "1808840"
  },
  {
    "text": "go both between two instances in one subnet and between instances in different subnets so now I'm going to",
    "start": "1808840",
    "end": "1815950"
  },
  {
    "text": "talk about the third case which is traffic from a VPC out to the internet",
    "start": "1815950",
    "end": "1821950"
  },
  {
    "text": "now using our internet gateway feature and so the first few steps that are the",
    "start": "1821950",
    "end": "1829480"
  },
  {
    "text": "first several steps actually in this example where I have instant see talking out to the Internet the first few steps",
    "start": "1829480",
    "end": "1835570"
  },
  {
    "text": "are pretty analogous to what we've seen are in previous examples really the first spot where there's a bit of a",
    "start": "1835570",
    "end": "1843430"
  },
  {
    "text": "difference is in the routing table and so you can see in this case that I've",
    "start": "1843430",
    "end": "1850330"
  },
  {
    "text": "got in my routing table I have a default route 0 / 0 route that points out to my",
    "start": "1850330",
    "end": "1856120"
  },
  {
    "text": "internet gateway that I've created and the status is active so this is important when you're routing traffic",
    "start": "1856120",
    "end": "1861220"
  },
  {
    "text": "out to the internet the the routing table that's applied to the subnet that",
    "start": "1861220",
    "end": "1866530"
  },
  {
    "text": "the instance belongs to needs to be needs to have a route out to the internet and you don't have to create a",
    "start": "1866530",
    "end": "1872590"
  },
  {
    "text": "default route you can create routes you could have a part of the create a",
    "start": "1872590",
    "end": "1878320"
  },
  {
    "text": "specific route for certain prefixes that you want to send out to the internet versus somewhere else or you can create",
    "start": "1878320",
    "end": "1884800"
  },
  {
    "text": "you know you can always create a default route as well okay and then the the next",
    "start": "1884800",
    "end": "1891670"
  },
  {
    "text": "stop will be really at this point the traffic is in its process through the network cackles and the security groups",
    "start": "1891670",
    "end": "1897940"
  },
  {
    "text": "and all of that just as it was before but the last stop here is is it is that",
    "start": "1897940",
    "end": "1903160"
  },
  {
    "text": "the traffic goes to the Internet gateway and at this point the traffic needs to be added into its public IP address and",
    "start": "1903160",
    "end": "1909430"
  },
  {
    "text": "so the only way this occurs is if you have configured and maps an elastic IP",
    "start": "1909430",
    "end": "1914770"
  },
  {
    "text": "address to that to that eni and that IP address that the private IP address sir",
    "start": "1914770",
    "end": "1920470"
  },
  {
    "text": "questioner oh yeah absolutely that's a",
    "start": "1920470",
    "end": "1931360"
  },
  {
    "text": "great question and that that's in perfect time thank you so when you create a VPC by default you will get a",
    "start": "1931360",
    "end": "1938710"
  },
  {
    "text": "default routing table and and I guess I",
    "start": "1938710",
    "end": "1943750"
  },
  {
    "text": "should say that using our a Tobias management console we have four different options when you when you go",
    "start": "1943750",
    "end": "1949150"
  },
  {
    "text": "to create a route table our sorry when you go to create a VPC you'll have four different scenarios everything from a",
    "start": "1949150",
    "end": "1955450"
  },
  {
    "text": "kind of a simple one subnet scenario yeah down to a more complex scenario",
    "start": "1955450",
    "end": "1961390"
  },
  {
    "text": "that involves both VPN connectivity as well as probably you know public and private connectivity and so the VPC out",
    "start": "1961390",
    "end": "1970390"
  },
  {
    "text": "of the box will have a default route table and then in some of those other scenarios will create you secondary",
    "start": "1970390",
    "end": "1976750"
  },
  {
    "text": "routing tables and if a subnet if you create a subnet and don't specify",
    "start": "1976750",
    "end": "1982270"
  },
  {
    "text": "otherwise it will be it will use the default route table so again whatever that the rule",
    "start": "1982270",
    "end": "1987940"
  },
  {
    "text": "are in that default route table that's what will be applied but you can always create new route tables and then you",
    "start": "1987940",
    "end": "1994600"
  },
  {
    "text": "would just have to apply them to the subnets that you want those route tables to be applicable to and so that's what",
    "start": "1994600",
    "end": "2000480"
  },
  {
    "text": "the wizard does is it will create you it creates multiple some of the more advanced scenarios create multiple",
    "start": "2000480",
    "end": "2006389"
  },
  {
    "text": "subnets and multiple route tables and they do the Association for you you know in advance so you're kind of ready to go",
    "start": "2006389",
    "end": "2012570"
  },
  {
    "text": "bootstraps you to begin deploying your application but you can always go in later and create new route tables and",
    "start": "2012570",
    "end": "2017970"
  },
  {
    "text": "then associate them into the subnet you can also then it's honest you can disassociate in which case would fall",
    "start": "2017970",
    "end": "2023639"
  },
  {
    "text": "back to using the default route table so I guess the message is every subnet has a round table that it will use but there",
    "start": "2023639",
    "end": "2029669"
  },
  {
    "text": "is one that's the default that if you don't specify otherwise that's what I use so as we're being processed than in",
    "start": "2029669",
    "end": "2037169"
  },
  {
    "text": "the Internet gateway you need to have an EIP that's associated with the the Eni",
    "start": "2037169",
    "end": "2042389"
  },
  {
    "text": "and the pin the private IP address and you can see here that you can using our management console you can see that I've",
    "start": "2042389",
    "end": "2048270"
  },
  {
    "text": "you can pull up in an en I and an elastic IP address and see that the two",
    "start": "2048270",
    "end": "2053579"
  },
  {
    "text": "have been associated together and if there's not an association then traffic",
    "start": "2053579",
    "end": "2058740"
  },
  {
    "text": "will just be dropped at this point alright so then in my third and our",
    "start": "2058740",
    "end": "2065908"
  },
  {
    "text": "sorry with my fourth scenario this is a situation where we have a VPC the same",
    "start": "2065909",
    "end": "2071490"
  },
  {
    "text": "VPC that I've been talking about on the far left and we have we can have one or more forms of external connectivity",
    "start": "2071490",
    "end": "2077878"
  },
  {
    "text": "private connectivity that is non internet that is back to our our home",
    "start": "2077879",
    "end": "2082950"
  },
  {
    "text": "office or our headquarters data center and we today we offer two ways of doing",
    "start": "2082950",
    "end": "2088169"
  },
  {
    "text": "that the first is our VPN connectivity and the VPN is just an ipsec VPN over",
    "start": "2088169",
    "end": "2093810"
  },
  {
    "text": "the internet and you can set this up on a variety of devices that that and then",
    "start": "2093810",
    "end": "2102359"
  },
  {
    "text": "using our management console you can obtain configuration guidance for for",
    "start": "2102359",
    "end": "2107910"
  },
  {
    "text": "many different flavors of device so if you have a VPN device that your premise today chances are you can get a you can",
    "start": "2107910",
    "end": "2114660"
  },
  {
    "text": "go to our management console and obtain the configuration guidance for that device to get it connected privately into virtual private cloud and",
    "start": "2114660",
    "end": "2122290"
  },
  {
    "text": "the difference between this and the internet connectivity is that there's there's no Nats that's that's performed",
    "start": "2122290",
    "end": "2130360"
  },
  {
    "text": "as the traffic is sent and received you know into and out of the VPC so if you",
    "start": "2130360",
    "end": "2135690"
  },
  {
    "text": "if your if your headquarters users private IP addresses like 192 168 and",
    "start": "2135690",
    "end": "2141220"
  },
  {
    "text": "you create a VPC using 10 10 dot slash 16 you can those those instances in your",
    "start": "2141220",
    "end": "2146290"
  },
  {
    "text": "v pc will be able to directly talk with the the host at your headquarters without any any nat or any any kind of",
    "start": "2146290",
    "end": "2154000"
  },
  {
    "text": "translation that's performed in the middle and so again you can do this with the VPN or you can do this with AWS",
    "start": "2154000",
    "end": "2160540"
  },
  {
    "text": "direct connect and so Direct Connect is a is a way to bring a circuit basically",
    "start": "2160540",
    "end": "2167080"
  },
  {
    "text": "not you know VPN is done over the Internet ipsec over the internet with direct connect you establish direct",
    "start": "2167080",
    "end": "2174480"
  },
  {
    "text": "circuits or fiber into the AWS network and from there then you can provision",
    "start": "2174480",
    "end": "2181290"
  },
  {
    "text": "individual connections into a virtual private cloud and so that provides you a real high capacity way to dinner connect",
    "start": "2181290",
    "end": "2188470"
  },
  {
    "text": "your existing data center and and virtual private cloud and all of this is done through what we call a VG W or a",
    "start": "2188470",
    "end": "2195340"
  },
  {
    "text": "virtual private gateway that's kind of that's the abstraction that we present in between the headquarter network and",
    "start": "2195340",
    "end": "2202150"
  },
  {
    "text": "the VPC and so you can actually configure both VPN connectivity and direct connect connectivity in a in a",
    "start": "2202150",
    "end": "2208630"
  },
  {
    "text": "single virtual private gateway and when you do so if you if you can provision",
    "start": "2208630",
    "end": "2213880"
  },
  {
    "text": "both well I'll talk about that mess in one moment I'll talk about what happens when you have both so the as we talked",
    "start": "2213880",
    "end": "2220990"
  },
  {
    "text": "about then let's let's say I have a host d sitting here on my far right and I would like to have my instance see talk",
    "start": "2220990",
    "end": "2227650"
  },
  {
    "text": "to my instant my host d so many of the the steps are analogous to what we saw",
    "start": "2227650",
    "end": "2233050"
  },
  {
    "text": "in the first few examples but the the kind of the first step where there's a",
    "start": "2233050",
    "end": "2238570"
  },
  {
    "text": "little bit of differences the routing table step and so we've seen routing tables several times here today but I",
    "start": "2238570",
    "end": "2244680"
  },
  {
    "text": "want to point out a couple things about rap tables as they pertain to v gws one",
    "start": "2244680",
    "end": "2250330"
  },
  {
    "text": "is that we just added a feature who called route propagation and this is a way to have any of the routes that we",
    "start": "2250330",
    "end": "2258060"
  },
  {
    "text": "see in the VG w that is via your VPN or your direct connect will automatically",
    "start": "2258060",
    "end": "2263610"
  },
  {
    "text": "then propagate them into your v pc which is which is really convenient for use cases where you have nick a mixture of",
    "start": "2263610",
    "end": "2270150"
  },
  {
    "text": "internet and private connectivity in this case for example i have a default route that points out to my internet",
    "start": "2270150",
    "end": "2275910"
  },
  {
    "text": "gateway but what I do in this routing table is create more specific routes that point back in my home network and",
    "start": "2275910",
    "end": "2281820"
  },
  {
    "text": "so for example if I add a third prefix like I have two here in the example but if I were to add a third prefix using",
    "start": "2281820",
    "end": "2289260"
  },
  {
    "text": "route propagation that would actually just automatically propagate into my VPC and so my instances would just start",
    "start": "2289260",
    "end": "2295500"
  },
  {
    "text": "using that that this the VPN or direct connect path to get to that new prefix",
    "start": "2295500",
    "end": "2301020"
  },
  {
    "text": "and so you can see that in this case that it says yes to propagated which",
    "start": "2301020",
    "end": "2306930"
  },
  {
    "text": "means that those routes came into this table by way of route propagation you can also set set these up statically if",
    "start": "2306930",
    "end": "2313230"
  },
  {
    "text": "you like but in this case any traffic then it comes out of this subnet or any",
    "start": "2313230",
    "end": "2318390"
  },
  {
    "text": "subnet that's associated with this routing table will be sent to the 192 168 up to those two those two ranges",
    "start": "2318390",
    "end": "2324270"
  },
  {
    "text": "will be sent over to the V GW and one other thing I wanted to mention at this point is that you can sometimes see in",
    "start": "2324270",
    "end": "2332130"
  },
  {
    "text": "your routing table a status of black hole the red the red dot and it's",
    "start": "2332130",
    "end": "2337650"
  },
  {
    "text": "important to understand the behavior of the routing table in this case which is a little bit different from some",
    "start": "2337650",
    "end": "2343890"
  },
  {
    "text": "traditional route table behaviors and in this case um the way that virtual",
    "start": "2343890",
    "end": "2349110"
  },
  {
    "text": "private cloud works with these routes is that we do longest prefix match on the",
    "start": "2349110",
    "end": "2354120"
  },
  {
    "text": "routing table and we then pick the route that is that is the longest match and if",
    "start": "2354120",
    "end": "2359190"
  },
  {
    "text": "the status is black hole then then that traffic is just discarded so black hole routes apply they they're not ignored as",
    "start": "2359190",
    "end": "2367110"
  },
  {
    "text": "you as some route table implementations do you ignore in valid or invalid routes",
    "start": "2367110",
    "end": "2374460"
  },
  {
    "text": "for example but but our implementation does treat those it's for security reasons we do treat those as valid",
    "start": "2374460",
    "end": "2380460"
  },
  {
    "text": "routes and we would discard traffic that's sent to those just quick question the back that's",
    "start": "2380460",
    "end": "2390930"
  },
  {
    "text": "right you read the question is when the tunnel comes up the routes are inserted and that's right so when you're if you're using a VPN or direct connect",
    "start": "2390930",
    "end": "2397500"
  },
  {
    "text": "connection using BGP as soon as you start advertising those routes to us than those routes are we've used route",
    "start": "2397500",
    "end": "2403800"
  },
  {
    "text": "propagation those routes will be propagated through and their status will become active okay so so after we've",
    "start": "2403800",
    "end": "2414060"
  },
  {
    "text": "passed the the routing table within the subnet then we are processed by the routing table in the VG w and this is",
    "start": "2414060",
    "end": "2421560"
  },
  {
    "text": "not something that you can directly inspect but one of the suggestions we have is that you can you can actually",
    "start": "2421560",
    "end": "2427680"
  },
  {
    "text": "create a routing table in your v pc and set up route propagation to that table",
    "start": "2427680",
    "end": "2432960"
  },
  {
    "text": "and you don't have to associate that route table with any subnet but that",
    "start": "2432960",
    "end": "2438150"
  },
  {
    "text": "route table will reflect all of the routes that we see in the VG w routing table so it's a kind of a simple way to",
    "start": "2438150",
    "end": "2444119"
  },
  {
    "text": "create a oops to create a view into the VG w routing table now the routing table",
    "start": "2444119",
    "end": "2451380"
  },
  {
    "text": "in the VG w includes all of the routes that we see from your VPNs and from your direct connect links and we have",
    "start": "2451380",
    "end": "2459660"
  },
  {
    "text": "policies on our side that will prefer direct connect paths over VPN paths if",
    "start": "2459660",
    "end": "2466830"
  },
  {
    "text": "if the direct connect path is available but you can use the two as as redundant backup mechanisms so for example if you",
    "start": "2466830",
    "end": "2473550"
  },
  {
    "text": "have a direct connect link you can also have a VPN link and if your direct connect link is unavailable the traffic",
    "start": "2473550",
    "end": "2479730"
  },
  {
    "text": "will be automatically routed rerouted over your over the VPN so traffic enters",
    "start": "2479730",
    "end": "2486450"
  },
  {
    "text": "the VG w routing table and this is an example you can actually inspect what",
    "start": "2486450",
    "end": "2492930"
  },
  {
    "text": "you're sending to us through bgp if you if you use a BGP based VPN you can we",
    "start": "2492930",
    "end": "2500880"
  },
  {
    "text": "have the URL the top actually shows has examples for a variety of different devices to inspect what BGP is currently",
    "start": "2500880",
    "end": "2509040"
  },
  {
    "text": "advertising to the VG w and then the routes that are being advertised to the",
    "start": "2509040",
    "end": "2514950"
  },
  {
    "text": "VG w will be used to route the traffic so this is a simple way to kind of inspect what's being done",
    "start": "2514950",
    "end": "2520579"
  },
  {
    "text": "in the network and if you have any if you have static VPNs we just launched",
    "start": "2520579",
    "end": "2525940"
  },
  {
    "text": "the static VPN feature which allows you to configure a VPN and just tell us what",
    "start": "2525940",
    "end": "2532099"
  },
  {
    "text": "static routes you want us to use in our V GW those routes will be used as long",
    "start": "2532099",
    "end": "2537470"
  },
  {
    "text": "as the VPN is up so if the VPN is down obviously there's there's no there's no path for us but if they're up we'll use",
    "start": "2537470",
    "end": "2543710"
  },
  {
    "text": "those routes alright and then following the V GW routing table that traffic is",
    "start": "2543710",
    "end": "2550880"
  },
  {
    "text": "delivered via the VPN or the direct connect link and of course one thing that we often see with customers is that",
    "start": "2550880",
    "end": "2556339"
  },
  {
    "text": "on the on the CDW on the customer VPN router there's often a firewall or",
    "start": "2556339",
    "end": "2563270"
  },
  {
    "text": "that's configured as well as a routing table a local routing table on the on that VPN device and sometimes that needs",
    "start": "2563270",
    "end": "2570349"
  },
  {
    "text": "to be updated we don't have specific guidance here because this is very much",
    "start": "2570349",
    "end": "2575810"
  },
  {
    "text": "dependent on the way you build your home network but it's you know it's important that as you configure all of your",
    "start": "2575810",
    "end": "2582369"
  },
  {
    "text": "infrastructure in the cloud which you can do through our management console and our api's you also configure the the",
    "start": "2582369",
    "end": "2588710"
  },
  {
    "text": "home infrastructure the headquarters based infrastructure to route that traffic to allow the traffic in and then",
    "start": "2588710",
    "end": "2594140"
  },
  {
    "text": "to route it to the rest of your internal network ok so really we've we've kind of",
    "start": "2594140",
    "end": "2600380"
  },
  {
    "text": "come to the conclusion of of this presentation we've talked about four different scenarios routing traffic kind",
    "start": "2600380",
    "end": "2607579"
  },
  {
    "text": "of within a subnet routing traffic between two subnets in virtual private cloud and then routing traffic to the",
    "start": "2607579",
    "end": "2614569"
  },
  {
    "text": "internet as well as routing through our VPN and direct connect connectivity so I",
    "start": "2614569",
    "end": "2619640"
  },
  {
    "text": "am wrapped up here but I will definitely take questions for the next few minutes and i'm also going to be in the booth",
    "start": "2619640",
    "end": "2626109"
  },
  {
    "text": "later today this afternoon if you have any questions we'd like to",
    "start": "2626109",
    "end": "2631930"
  }
]