[
  {
    "start": "0",
    "end": "46000"
  },
  {
    "text": "amazon detective makes it easy to",
    "start": "160",
    "end": "1920"
  },
  {
    "text": "analyze investigate and quickly identify",
    "start": "1920",
    "end": "4640"
  },
  {
    "text": "the root cause of potential security",
    "start": "4640",
    "end": "6399"
  },
  {
    "text": "issues or suspicious activities",
    "start": "6399",
    "end": "9760"
  },
  {
    "text": "this video shows the start of an",
    "start": "9760",
    "end": "11440"
  },
  {
    "text": "investigation flow for vpc flow data in",
    "start": "11440",
    "end": "13920"
  },
  {
    "text": "detective it mirrors the investigation",
    "start": "13920",
    "end": "16560"
  },
  {
    "text": "flow covered in the aws security blog",
    "start": "16560",
    "end": "18880"
  },
  {
    "text": "post investigate bpc flow with amazon",
    "start": "18880",
    "end": "21840"
  },
  {
    "text": "detective",
    "start": "21840",
    "end": "24480"
  },
  {
    "text": "the investigation starts with a finding",
    "start": "24880",
    "end": "26880"
  },
  {
    "text": "detected by amazon guard duty it",
    "start": "26880",
    "end": "29519"
  },
  {
    "text": "analyzes the vpc flow for the affected",
    "start": "29519",
    "end": "31920"
  },
  {
    "text": "ec2 instance",
    "start": "31920",
    "end": "33760"
  },
  {
    "text": "it uses that information to identify an",
    "start": "33760",
    "end": "36000"
  },
  {
    "text": "ip address of interest",
    "start": "36000",
    "end": "38320"
  },
  {
    "text": "the investigation then pivots to another",
    "start": "38320",
    "end": "40320"
  },
  {
    "text": "ec2 instance that the ip address is",
    "start": "40320",
    "end": "42399"
  },
  {
    "text": "connected to to view that instance's",
    "start": "42399",
    "end": "44800"
  },
  {
    "text": "flow data",
    "start": "44800",
    "end": "47280"
  },
  {
    "start": "46000",
    "end": "69000"
  },
  {
    "text": "vpc flow information captures the ip",
    "start": "47280",
    "end": "49760"
  },
  {
    "text": "address traffic going to and from ec2",
    "start": "49760",
    "end": "52559"
  },
  {
    "text": "instances in a virtual private cloud or",
    "start": "52559",
    "end": "55360"
  },
  {
    "text": "vpc",
    "start": "55360",
    "end": "56960"
  },
  {
    "text": "security analysts use this information",
    "start": "56960",
    "end": "58879"
  },
  {
    "text": "to determine the scope of security",
    "start": "58879",
    "end": "60559"
  },
  {
    "text": "issues",
    "start": "60559",
    "end": "61600"
  },
  {
    "text": "to validate the effectiveness of network",
    "start": "61600",
    "end": "63520"
  },
  {
    "text": "access rules to investigate issues and",
    "start": "63520",
    "end": "66400"
  },
  {
    "text": "to diagnose network behaviors",
    "start": "66400",
    "end": "69920"
  },
  {
    "start": "69000",
    "end": "356000"
  },
  {
    "text": "detective automatically collects bpc",
    "start": "69920",
    "end": "72320"
  },
  {
    "text": "flow information from your monitored",
    "start": "72320",
    "end": "74000"
  },
  {
    "text": "accounts including accounts that do not",
    "start": "74000",
    "end": "76320"
  },
  {
    "text": "have vpc flow logging enabled it",
    "start": "76320",
    "end": "78960"
  },
  {
    "text": "aggregates that information by ec2",
    "start": "78960",
    "end": "81200"
  },
  {
    "text": "instance and ip address and presents",
    "start": "81200",
    "end": "83680"
  },
  {
    "text": "visual summaries and analytics about",
    "start": "83680",
    "end": "85520"
  },
  {
    "text": "these network flows",
    "start": "85520",
    "end": "88000"
  },
  {
    "text": "you can use these summaries and",
    "start": "88000",
    "end": "89439"
  },
  {
    "text": "analytics to interactively examine the",
    "start": "89439",
    "end": "91439"
  },
  {
    "text": "vpc network flow details for your ec2",
    "start": "91439",
    "end": "94079"
  },
  {
    "text": "instances",
    "start": "94079",
    "end": "96000"
  },
  {
    "text": "detective stores the vpc flow data for",
    "start": "96000",
    "end": "98240"
  },
  {
    "text": "12 months to provide visibility into",
    "start": "98240",
    "end": "100640"
  },
  {
    "text": "historical activity",
    "start": "100640",
    "end": "103360"
  },
  {
    "text": "this investigation flow starts with a",
    "start": "103360",
    "end": "105200"
  },
  {
    "text": "finding detected by amazon guard duty a",
    "start": "105200",
    "end": "107759"
  },
  {
    "text": "threat detection service that monitors",
    "start": "107759",
    "end": "109520"
  },
  {
    "text": "for malicious activity and unauthorized",
    "start": "109520",
    "end": "111600"
  },
  {
    "text": "behavior",
    "start": "111600",
    "end": "112720"
  },
  {
    "text": "the type of finding that we will",
    "start": "112720",
    "end": "114079"
  },
  {
    "text": "investigate is unauthorized access ec2",
    "start": "114079",
    "end": "116880"
  },
  {
    "text": "tour client which can indicate",
    "start": "116880",
    "end": "118799"
  },
  {
    "text": "unauthorized access to your aws",
    "start": "118799",
    "end": "120880"
  },
  {
    "text": "resources",
    "start": "120880",
    "end": "122320"
  },
  {
    "text": "if you have both guard duty and",
    "start": "122320",
    "end": "123759"
  },
  {
    "text": "detective enabled for your account you",
    "start": "123759",
    "end": "125759"
  },
  {
    "text": "can pivot from the guard duty finding to",
    "start": "125759",
    "end": "127759"
  },
  {
    "text": "the detective console in order to start",
    "start": "127759",
    "end": "129759"
  },
  {
    "text": "an investigation",
    "start": "129759",
    "end": "131840"
  },
  {
    "text": "from the finding details choose",
    "start": "131840",
    "end": "133760"
  },
  {
    "text": "investigate with detective then choose",
    "start": "133760",
    "end": "136000"
  },
  {
    "text": "the finding",
    "start": "136000",
    "end": "138080"
  },
  {
    "text": "the detective console opens the finding",
    "start": "138080",
    "end": "140319"
  },
  {
    "text": "profile",
    "start": "140319",
    "end": "141360"
  },
  {
    "text": "the finding profile contains",
    "start": "141360",
    "end": "142800"
  },
  {
    "text": "visualizations to analyze the activity",
    "start": "142800",
    "end": "144959"
  },
  {
    "text": "associated with the affected resource",
    "start": "144959",
    "end": "147599"
  },
  {
    "text": "in this case the finding is associated",
    "start": "147599",
    "end": "149599"
  },
  {
    "text": "with an ec2 instance",
    "start": "149599",
    "end": "151599"
  },
  {
    "text": "the scope time controls the time period",
    "start": "151599",
    "end": "153519"
  },
  {
    "text": "used on the profile panels it is",
    "start": "153519",
    "end": "155599"
  },
  {
    "text": "currently set to the time period when",
    "start": "155599",
    "end": "157200"
  },
  {
    "text": "the finding was observed",
    "start": "157200",
    "end": "159200"
  },
  {
    "text": "to investigate this finding we want to",
    "start": "159200",
    "end": "161280"
  },
  {
    "text": "answer questions such as",
    "start": "161280",
    "end": "163200"
  },
  {
    "text": "what ipport or network service was in",
    "start": "163200",
    "end": "165200"
  },
  {
    "text": "use at that time were any large data",
    "start": "165200",
    "end": "167760"
  },
  {
    "text": "transfers involved was the traffic",
    "start": "167760",
    "end": "169840"
  },
  {
    "text": "allowed by my security groups",
    "start": "169840",
    "end": "172640"
  },
  {
    "text": "the finding profile includes a list of",
    "start": "172640",
    "end": "174480"
  },
  {
    "text": "findings associated with the ec2",
    "start": "174480",
    "end": "176400"
  },
  {
    "text": "instance",
    "start": "176400",
    "end": "177440"
  },
  {
    "text": "during the scope time the ec2 instance",
    "start": "177440",
    "end": "179760"
  },
  {
    "text": "was also involved in another finding",
    "start": "179760",
    "end": "181920"
  },
  {
    "text": "that indicates unusual behavior which",
    "start": "181920",
    "end": "184319"
  },
  {
    "text": "confirms the need to investigate",
    "start": "184319",
    "end": "186720"
  },
  {
    "text": "the overall vpc flow volume panel",
    "start": "186720",
    "end": "188879"
  },
  {
    "text": "provides a summary of the inbound and",
    "start": "188879",
    "end": "190800"
  },
  {
    "text": "outbound vpc flow traffic for the ec2",
    "start": "190800",
    "end": "193280"
  },
  {
    "text": "instance",
    "start": "193280",
    "end": "194720"
  },
  {
    "text": "we can see that there are a couple of",
    "start": "194720",
    "end": "196319"
  },
  {
    "text": "spikes in traffic for this ec2 instance",
    "start": "196319",
    "end": "200080"
  },
  {
    "text": "to dig deeper i want to see additional",
    "start": "200080",
    "end": "202080"
  },
  {
    "text": "details about the vpc flow activity",
    "start": "202080",
    "end": "204879"
  },
  {
    "text": "to start i'll display the details for",
    "start": "204879",
    "end": "207120"
  },
  {
    "text": "the entire scope time",
    "start": "207120",
    "end": "209440"
  },
  {
    "text": "the activity details show the inbound",
    "start": "209440",
    "end": "211760"
  },
  {
    "text": "and outbound volume for each combination",
    "start": "211760",
    "end": "214080"
  },
  {
    "text": "of ip address port",
    "start": "214080",
    "end": "216480"
  },
  {
    "text": "protocol direction and whether the",
    "start": "216480",
    "end": "219040"
  },
  {
    "text": "request was accepted or rejected",
    "start": "219040",
    "end": "221760"
  },
  {
    "text": "the annotations column marks activity",
    "start": "221760",
    "end": "223760"
  },
  {
    "text": "that was involved in the finding",
    "start": "223760",
    "end": "226480"
  },
  {
    "text": "to better focus the investigation i'll",
    "start": "226480",
    "end": "228400"
  },
  {
    "text": "select one of the time intervals that",
    "start": "228400",
    "end": "229840"
  },
  {
    "text": "has a spike in traffic",
    "start": "229840",
    "end": "233040"
  },
  {
    "text": "to see the traffic that contributed to",
    "start": "237280",
    "end": "239040"
  },
  {
    "text": "the spike i'll first sort by the inbound",
    "start": "239040",
    "end": "241599"
  },
  {
    "text": "traffic",
    "start": "241599",
    "end": "244000"
  },
  {
    "text": "the largest volumes are not associated",
    "start": "244000",
    "end": "245840"
  },
  {
    "text": "with the finding",
    "start": "245840",
    "end": "248640"
  },
  {
    "text": "next i'll sort by the outbound volume",
    "start": "250239",
    "end": "252799"
  },
  {
    "text": "again the largest volumes are not",
    "start": "252799",
    "end": "254879"
  },
  {
    "text": "associated with the finding",
    "start": "254879",
    "end": "256959"
  },
  {
    "text": "i could continue the investigation by",
    "start": "256959",
    "end": "258880"
  },
  {
    "text": "investigating only the ip addresses from",
    "start": "258880",
    "end": "261040"
  },
  {
    "text": "the finding",
    "start": "261040",
    "end": "262160"
  },
  {
    "text": "however because the spikes are so",
    "start": "262160",
    "end": "264000"
  },
  {
    "text": "obvious i will continue to investigate",
    "start": "264000",
    "end": "266000"
  },
  {
    "text": "them",
    "start": "266000",
    "end": "266800"
  },
  {
    "text": "the inbound spikes are in port 443 which",
    "start": "266800",
    "end": "269840"
  },
  {
    "text": "is typically an https port or a secure",
    "start": "269840",
    "end": "272560"
  },
  {
    "text": "web connection",
    "start": "272560",
    "end": "274080"
  },
  {
    "text": "the outbound spike is on port 22 which",
    "start": "274080",
    "end": "276880"
  },
  {
    "text": "is typically ssh but goes to an ip",
    "start": "276880",
    "end": "279520"
  },
  {
    "text": "address that seems to be internal based",
    "start": "279520",
    "end": "281360"
  },
  {
    "text": "on its address",
    "start": "281360",
    "end": "282479"
  },
  {
    "text": "which begins with 172.16",
    "start": "282479",
    "end": "286280"
  },
  {
    "text": "let's investigate the ip address",
    "start": "287040",
    "end": "288800"
  },
  {
    "text": "associated with the outbound spike on",
    "start": "288800",
    "end": "290720"
  },
  {
    "text": "port 22.",
    "start": "290720",
    "end": "292639"
  },
  {
    "text": "i choose the ip address which displays",
    "start": "292639",
    "end": "294880"
  },
  {
    "text": "the ip address profile",
    "start": "294880",
    "end": "297840"
  },
  {
    "text": "we see that this ip address was involved",
    "start": "297840",
    "end": "300000"
  },
  {
    "text": "in a brute force finding during the same",
    "start": "300000",
    "end": "302240"
  },
  {
    "text": "scope time as the finding that we were",
    "start": "302240",
    "end": "303919"
  },
  {
    "text": "investigating",
    "start": "303919",
    "end": "305280"
  },
  {
    "text": "this could be related to the spikes we",
    "start": "305280",
    "end": "306880"
  },
  {
    "text": "saw in port 22.",
    "start": "306880",
    "end": "310520"
  },
  {
    "text": "i see that this ip address was assigned",
    "start": "310639",
    "end": "312639"
  },
  {
    "text": "to an ec2 instance during the scope time",
    "start": "312639",
    "end": "315520"
  },
  {
    "text": "to display the profile for the ec2",
    "start": "315520",
    "end": "317520"
  },
  {
    "text": "instance i choose the instance",
    "start": "317520",
    "end": "319120"
  },
  {
    "text": "identifier",
    "start": "319120",
    "end": "321440"
  },
  {
    "text": "for the cc2 instance i want to see the",
    "start": "321440",
    "end": "323759"
  },
  {
    "text": "activity details",
    "start": "323759",
    "end": "325440"
  },
  {
    "text": "on the overall vpc flow volume profile",
    "start": "325440",
    "end": "328000"
  },
  {
    "text": "panel i'll display the activity details",
    "start": "328000",
    "end": "330479"
  },
  {
    "text": "for the current scope time",
    "start": "330479",
    "end": "333759"
  },
  {
    "text": "i'm specifically interested in the",
    "start": "334880",
    "end": "336560"
  },
  {
    "text": "inbound traffic on port 22 because",
    "start": "336560",
    "end": "339199"
  },
  {
    "text": "that's where we saw the spike in traffic",
    "start": "339199",
    "end": "341039"
  },
  {
    "text": "on the previous ec2 instance",
    "start": "341039",
    "end": "343360"
  },
  {
    "text": "i select the local port filter option",
    "start": "343360",
    "end": "345840"
  },
  {
    "text": "and set the filter value to 22.",
    "start": "345840",
    "end": "348720"
  },
  {
    "text": "the activity details show ip addresses",
    "start": "348720",
    "end": "350960"
  },
  {
    "text": "related to port 22",
    "start": "350960",
    "end": "352880"
  },
  {
    "text": "including addresses that received a high",
    "start": "352880",
    "end": "354639"
  },
  {
    "text": "volume of data",
    "start": "354639",
    "end": "356720"
  },
  {
    "start": "356000",
    "end": "374000"
  },
  {
    "text": "from here the next steps might be to",
    "start": "356720",
    "end": "358639"
  },
  {
    "text": "look at security groups and network",
    "start": "358639",
    "end": "360319"
  },
  {
    "text": "access control lists to determine why",
    "start": "360319",
    "end": "362720"
  },
  {
    "text": "port 22 is open to the internet and",
    "start": "362720",
    "end": "365120"
  },
  {
    "text": "sending such large volumes of traffic",
    "start": "365120",
    "end": "368000"
  },
  {
    "text": "you can also take other actions within",
    "start": "368000",
    "end": "369759"
  },
  {
    "text": "detective and additional forensic steps",
    "start": "369759",
    "end": "372400"
  },
  {
    "text": "we'll cover those in the next slides",
    "start": "372400",
    "end": "375039"
  },
  {
    "start": "374000",
    "end": "391000"
  },
  {
    "text": "to investigate vpc findings within",
    "start": "375039",
    "end": "377199"
  },
  {
    "text": "detective",
    "start": "377199",
    "end": "378560"
  },
  {
    "text": "you can analyze ports and utilization",
    "start": "378560",
    "end": "381360"
  },
  {
    "text": "correlate ec2 instances to tcp ip ports",
    "start": "381360",
    "end": "384560"
  },
  {
    "text": "and ip addresses",
    "start": "384560",
    "end": "386240"
  },
  {
    "text": "analyze traffic spikes and anomalies",
    "start": "386240",
    "end": "388720"
  },
  {
    "text": "discover traffic patterns and correlate",
    "start": "388720",
    "end": "390560"
  },
  {
    "text": "behaviors",
    "start": "390560",
    "end": "391840"
  },
  {
    "text": "you can also use detective to explore",
    "start": "391840",
    "end": "393840"
  },
  {
    "text": "ec2 instance behavior",
    "start": "393840",
    "end": "396400"
  },
  {
    "text": "you can conduct directional traffic",
    "start": "396400",
    "end": "398080"
  },
  {
    "text": "analysis",
    "start": "398080",
    "end": "399360"
  },
  {
    "text": "investigate large transfers to identify",
    "start": "399360",
    "end": "401600"
  },
  {
    "text": "possible data exfiltration",
    "start": "401600",
    "end": "403919"
  },
  {
    "text": "examine distinct ip address connections",
    "start": "403919",
    "end": "406080"
  },
  {
    "text": "based on protocol traffic volume and",
    "start": "406080",
    "end": "408400"
  },
  {
    "text": "traffic direction",
    "start": "408400",
    "end": "410160"
  },
  {
    "text": "gather data related to a spike in the",
    "start": "410160",
    "end": "411919"
  },
  {
    "text": "port count from ip addresses a spike in",
    "start": "411919",
    "end": "414800"
  },
  {
    "text": "a single ip address could indicate a",
    "start": "414800",
    "end": "416639"
  },
  {
    "text": "brute force attack a spike in multiple",
    "start": "416639",
    "end": "419199"
  },
  {
    "text": "ip addresses could indicate distributed",
    "start": "419199",
    "end": "421120"
  },
  {
    "text": "denial of service",
    "start": "421120",
    "end": "423120"
  },
  {
    "start": "422000",
    "end": "439000"
  },
  {
    "text": "you can enhance your detective",
    "start": "423120",
    "end": "424560"
  },
  {
    "text": "investigation with the following",
    "start": "424560",
    "end": "425919"
  },
  {
    "text": "forensic steps",
    "start": "425919",
    "end": "427680"
  },
  {
    "text": "you can snapshot ec2 volumes generate a",
    "start": "427680",
    "end": "430639"
  },
  {
    "text": "memory dump of an ec2 instance",
    "start": "430639",
    "end": "433039"
  },
  {
    "text": "isolate an ec2 instance",
    "start": "433039",
    "end": "435360"
  },
  {
    "text": "review your authentication strategy to",
    "start": "435360",
    "end": "437280"
  },
  {
    "text": "determine whether it is sufficient",
    "start": "437280",
    "end": "440080"
  },
  {
    "text": "detective stores and analyzes vpc flow",
    "start": "440080",
    "end": "442639"
  },
  {
    "text": "data so that you can focus on quickly",
    "start": "442639",
    "end": "444639"
  },
  {
    "text": "answering your investigative questions",
    "start": "444639",
    "end": "447280"
  },
  {
    "text": "this helps security and operations teams",
    "start": "447280",
    "end": "449520"
  },
  {
    "text": "to analyze ec2 traffic",
    "start": "449520",
    "end": "451840"
  },
  {
    "text": "validate security group permissions and",
    "start": "451840",
    "end": "454240"
  },
  {
    "text": "diagnose ec2 instance behavior",
    "start": "454240",
    "end": "457360"
  },
  {
    "text": "to learn more about detective and get",
    "start": "457360",
    "end": "459360"
  },
  {
    "text": "access to additional resources see the",
    "start": "459360",
    "end": "461759"
  },
  {
    "text": "detective product page at aws.amazon.com",
    "start": "461759",
    "end": "466199"
  },
  {
    "text": "detective",
    "start": "466240",
    "end": "469240"
  }
]