[
  {
    "text": "good morning and thanks for joining me today my name is Jeff we're I'm a senior",
    "start": "0",
    "end": "5730"
  },
  {
    "text": "manager on the identity team if you've ever visited our I M forums you've probably spoken with me",
    "start": "5730",
    "end": "10740"
  },
  {
    "text": "I'm known as Jeff W and I got to tell you this is the fifth time I've spoken",
    "start": "10740",
    "end": "16080"
  },
  {
    "text": "it reinvent the third time I've talked about policies and a little bit in awe",
    "start": "16080",
    "end": "22400"
  },
  {
    "text": "about the number of people who turned out and especially this room that they gave me uh all right guess it's popular",
    "start": "22400",
    "end": "32689"
  },
  {
    "text": "so before I get started let me just give you a warning some disclaimers that I kind of talked",
    "start": "32690",
    "end": "38700"
  },
  {
    "text": "about so if you didn't realize that the following 60 minutes are essentially me going to be going through JSON documents",
    "start": "38700",
    "end": "44520"
  },
  {
    "text": "okay if that doesn't excite you and there is no way I would rather spend an hour 11 a.m. on the 3rd on a Wednesday",
    "start": "44520",
    "end": "53010"
  },
  {
    "text": "but going through a bunch of policies but if that doesn't excite you it's not too late there's a lot of other great",
    "start": "53010",
    "end": "58800"
  },
  {
    "text": "sessions out there and you won't offend my you won't hurt my feelings and really I'm not kidding it's going to be 60",
    "start": "58800",
    "end": "65309"
  },
  {
    "text": "minutes of policies a full hour of squiggly brackets square brackets quotes",
    "start": "65309",
    "end": "73890"
  },
  {
    "text": "commas and you're still here so all",
    "start": "73890",
    "end": "79110"
  },
  {
    "text": "right let's start becoming Dinges so hopefully you're here because you want to learn more about securing your AWS",
    "start": "79110",
    "end": "86159"
  },
  {
    "text": "resources and specifically I hope that everybody walks out of here with a deeper understanding of I am permissions",
    "start": "86159",
    "end": "93030"
  },
  {
    "text": "something like 70% of you are first-time reinvent attendees so my presentation is",
    "start": "93030",
    "end": "99630"
  },
  {
    "text": "kind of going to be we're going to go from 0 to 60 really fast I'm going to go through some of the basics of policies",
    "start": "99630",
    "end": "106020"
  },
  {
    "text": "go through some of the intermediate concepts and then what I really want to",
    "start": "106020",
    "end": "111720"
  },
  {
    "text": "do is pass on some of the things that I've learned so in my nearly 5 years",
    "start": "111720",
    "end": "117360"
  },
  {
    "text": "at Amazon I try to carve out a little time each day each week to look at the",
    "start": "117360",
    "end": "122399"
  },
  {
    "text": "forums look at our customer support tickets and try to figure out where people are having trouble with policies",
    "start": "122399",
    "end": "128550"
  },
  {
    "text": "and then quite honestly I try to solve those same policies myself to see if I can do it the way the customer is trying",
    "start": "128550",
    "end": "134910"
  },
  {
    "text": "to do it or to help them because they haven't gotten there and over that time I've picked up a lot of tips and tricks and so I'm going to pass on some of the",
    "start": "134910",
    "end": "141690"
  },
  {
    "text": "debugging testing and other policy food that I've learned over those years now as I mentioned there's a session on",
    "start": "141690",
    "end": "148380"
  },
  {
    "text": "policies and I don't know why but every year they give this to me and I wonder who is going to come out and listen to",
    "start": "148380",
    "end": "155610"
  },
  {
    "text": "me talk about policies for 60 minutes so sort of my unwritten rule here is I'm going to try to keep you all awake and",
    "start": "155610",
    "end": "161400"
  },
  {
    "text": "the way that I'm going to do that is I'm going to try to show you cram as many demonstrations as possible into the next",
    "start": "161400",
    "end": "166739"
  },
  {
    "text": "60 minutes and because it's going to take me all the way to the hour I'm just going to ask that if you have questions",
    "start": "166739",
    "end": "172530"
  },
  {
    "text": "and you will have questions because you're going to see things that probably won't make sense the first time you see it but if you have questions I just ask",
    "start": "172530",
    "end": "179100"
  },
  {
    "text": "you to hold them to the end and then I'll hang out for as long as as they'll let me and and I'll be happy to answer",
    "start": "179100",
    "end": "184560"
  },
  {
    "text": "your questions so with that let's get into the first demonstration now this",
    "start": "184560",
    "end": "190440"
  },
  {
    "text": "was an actual customer asked us to do this they were having problem with a support ticket and it got all the way to",
    "start": "190440",
    "end": "197280"
  },
  {
    "text": "the engineering team and the engineers actually got stumped on this they couldn't figure out how to do it and it's a very simple concept right the",
    "start": "197280",
    "end": "203579"
  },
  {
    "text": "idea is that I want my users to boot up ec2 instances but to control costs I",
    "start": "203579",
    "end": "210000"
  },
  {
    "text": "only want them to be able to launch certain instance types and specifically back when this customer wanted to do it",
    "start": "210000",
    "end": "215130"
  },
  {
    "text": "they wanted to limit them to T 1 T 2 and M 3 instances so let's go through using",
    "start": "215130",
    "end": "222030"
  },
  {
    "text": "the tools and I'm going to show you how you create a managed policy and we're going to attempt to limit starting an",
    "start": "222030",
    "end": "227040"
  },
  {
    "text": "ec2 instance except for these three instance types and then we to attach that to a user and test it out and so",
    "start": "227040",
    "end": "234989"
  },
  {
    "text": "throughout my presentation I'm going to",
    "start": "234989",
    "end": "241109"
  },
  {
    "text": "assume two personas okay and I'm going to flip between Chrome where I'm the",
    "start": "241109",
    "end": "246810"
  },
  {
    "text": "administrator making changes to policies and I'm going to switch to firefox where",
    "start": "246810",
    "end": "252900"
  },
  {
    "text": "i'm bob bob is my user I'm going to abuse Bob I'm just going to be attaching policies to them and seeing what happens",
    "start": "252900",
    "end": "259700"
  },
  {
    "text": "so the administrator here I'm going to open up Bob and he currently has no",
    "start": "259700",
    "end": "265580"
  },
  {
    "text": "permissions so I'm going to go ahead and I'm going to add permission and I'm going to create a new policy and I am",
    "start": "265580",
    "end": "274610"
  },
  {
    "text": "going to use the policy generator and the first thing I want to do is I'm going to grant and allow policy and so",
    "start": "274610",
    "end": "282230"
  },
  {
    "text": "I'm going to choose Amazon ec2 I'm going to grant access to all actions on all",
    "start": "282230",
    "end": "289250"
  },
  {
    "text": "resources and I'm going to add that statement now the next thing I want to do is I'm going to deny and once again",
    "start": "289250",
    "end": "295310"
  },
  {
    "text": "it's going to be for ec2 and in this case I'm going to deny a specific action",
    "start": "295310",
    "end": "301490"
  },
  {
    "text": "and that action is the run instances action this is the one where if you go and launch an ec2 instance this is the",
    "start": "301490",
    "end": "309440"
  },
  {
    "text": "API that's being called in the background and once again I'm going to put this for all resources so nothing",
    "start": "309440",
    "end": "314750"
  },
  {
    "text": "complicated so far and I'm going to add a condition okay now logically I'm going to go in and going to say for that",
    "start": "314750",
    "end": "320270"
  },
  {
    "text": "condition I want string not like instance type t1 t2 m3 star I'm going to",
    "start": "320270",
    "end": "331850"
  },
  {
    "text": "add that condition I'm going to add that statement and click next I'll give this",
    "start": "331850",
    "end": "338750"
  },
  {
    "text": "a very creative name and then it",
    "start": "338750",
    "end": "344840"
  },
  {
    "text": "generates the JSON for me now I'm kind of anal retentive so there's a few",
    "start": "344840",
    "end": "350180"
  },
  {
    "text": "things that I always like to clean up for example if I have a list of single",
    "start": "350180",
    "end": "355370"
  },
  {
    "text": "items I don't need the square bracket so I'll get rid of some of those clean out",
    "start": "355370",
    "end": "361280"
  },
  {
    "text": "the SIDS because I don't need them",
    "start": "361280",
    "end": "364810"
  },
  {
    "text": "and then one of the things that you'll notice is the policy editor is a much more full-featured JSON editor it's",
    "start": "366950",
    "end": "373290"
  },
  {
    "text": "going to help you with the grammar and the policy syntax you can also choose to turn on and off some of the auto",
    "start": "373290",
    "end": "379890"
  },
  {
    "text": "formatting for it and so if I validate that it's going to tell me that somewhere in there I introduced in error",
    "start": "379890",
    "end": "386760"
  },
  {
    "text": "when I was cleaning it up so if I go to line nine it's expecting that I have a",
    "start": "386760",
    "end": "392220"
  },
  {
    "text": "comma instead of quotes and so if I put in the comma validate it again it's",
    "start": "392220",
    "end": "397950"
  },
  {
    "text": "going to tell me that my policy is valid and now it's a little bit easier to read so I've granted access to all you see to",
    "start": "397950",
    "end": "403080"
  },
  {
    "text": "actions and for this one action I'm denying access for T 1 T 2 and M 3 I'm",
    "start": "403080",
    "end": "409440"
  },
  {
    "text": "going to create that policy just a refresh it here and there's my policy",
    "start": "409440",
    "end": "421640"
  },
  {
    "text": "review ad permissions and so now this is the policy that is attached to Bob so",
    "start": "421640",
    "end": "429060"
  },
  {
    "text": "I'm switch over to Bob and just going to refresh here now I can go and let's test",
    "start": "429060",
    "end": "436320"
  },
  {
    "text": "the fail case first because I think that's interesting I don't want Bob to be able to launch instances over a size",
    "start": "436320",
    "end": "442350"
  },
  {
    "text": "so let's take something like an M for 16 XL I definitely don't want him to do",
    "start": "442350",
    "end": "447750"
  },
  {
    "text": "that review and launch now accept all the defaults I acknowledge Juan's",
    "start": "447750",
    "end": "453690"
  },
  {
    "text": "instance and voila fail so far so good Bob can't launch an instance that he",
    "start": "453690",
    "end": "459479"
  },
  {
    "text": "hasn't been granted to so I'm going to go back and I'm going to edit the instance type and now I'm going to",
    "start": "459479",
    "end": "465000"
  },
  {
    "text": "choose something in the free tiers the T to micro go go through the process again I'll accept a bunch of these things",
    "start": "465000",
    "end": "471800"
  },
  {
    "text": "acknowledged launch and I've also failed so I think we would all agree that",
    "start": "471800",
    "end": "480110"
  },
  {
    "text": "that's not very ninja-like okay it's not the desired result but and I show you",
    "start": "480110",
    "end": "486720"
  },
  {
    "text": "this not because I want to discourage you or that I'm just a mean person but I am really a mean person I wanted to show",
    "start": "486720",
    "end": "493530"
  },
  {
    "text": "you kind of what the first time customer experiences because everything did seem very logical I went through the tool",
    "start": "493530",
    "end": "499740"
  },
  {
    "text": "I chose all the options and I didn't get the desired result and I promised you by the end of this presentation I'm going",
    "start": "499740",
    "end": "505169"
  },
  {
    "text": "to show you a very simple policy that actually succeeds for that use case but in order to get there we have to kind of",
    "start": "505169",
    "end": "510930"
  },
  {
    "text": "start from the beginning so the first 10-15 minutes what I'm going to do is walk you through some of the basics of",
    "start": "510930",
    "end": "517370"
  },
  {
    "text": "the policy language and so the first thing you have to know is this is how we",
    "start": "517370",
    "end": "523169"
  },
  {
    "text": "authorize all of your requests to AWS and there's really two facets to it there's the part that as computer",
    "start": "523169",
    "end": "530040"
  },
  {
    "text": "scientists or developers is pretty easy that's the specification like JSON isn't that complicated understanding the",
    "start": "530040",
    "end": "536100"
  },
  {
    "text": "simple the syntax isn't that hard that's sort of the science the art is the",
    "start": "536100",
    "end": "542250"
  },
  {
    "text": "enforcement and that's really understanding how policies are evaluated how the serve different services",
    "start": "542250",
    "end": "547830"
  },
  {
    "text": "actually interpret those policies right so that's we're going to focus most of the presentation today so as we've seen",
    "start": "547830",
    "end": "556470"
  },
  {
    "text": "policies are nothing more than JSON formatted documents they contain statements those statements have a",
    "start": "556470",
    "end": "563130"
  },
  {
    "text": "principle or an actor and in actions or the set of ap is that you can access and",
    "start": "563130",
    "end": "568589"
  },
  {
    "text": "of course the resources that you want to access and all of the policies follow what I call kind of a park model the",
    "start": "568589",
    "end": "574170"
  },
  {
    "text": "principal action resource and condition and before beginning started into building some of these policies I kind",
    "start": "574170",
    "end": "579959"
  },
  {
    "text": "of want to walk you through and show you what each one of these look like so the first one is the principal the principal",
    "start": "579959",
    "end": "585660"
  },
  {
    "text": "is an entity it's the thing the person the user the group the role this is what",
    "start": "585660",
    "end": "590760"
  },
  {
    "text": "is allowed or denied access to a resource and the way that you indicate all of these principles are actually",
    "start": "590760",
    "end": "597390"
  },
  {
    "text": "anything inside of Amazon is through the Amazon resource name or what I'm just going to call Arne for the rest of this",
    "start": "597390",
    "end": "603000"
  },
  {
    "text": "presentation now when you use an anion policy you're usually attaching this to a user a group or a role and when you're",
    "start": "603000",
    "end": "610529"
  },
  {
    "text": "doing that the principal is implicit there's no reason to put it in the policy because if it's attached to a user you know that the user is the",
    "start": "610529",
    "end": "617220"
  },
  {
    "text": "principal but there are cases with resource based policies like a policy attached to an s3 bucket where you're",
    "start": "617220",
    "end": "623100"
  },
  {
    "text": "going to have to specify the principal and so this is what some of them might look like let's say that you have a",
    "start": "623100",
    "end": "628350"
  },
  {
    "text": "bunch of images or stuff that's in a bucket that you want to provide anonymous access to an information",
    "start": "628350",
    "end": "633450"
  },
  {
    "text": "website you might use the anonymous users which is just simply star dot star you might have to grant access to",
    "start": "633450",
    "end": "639450"
  },
  {
    "text": "another AWS account this is actually a use case I'll go through later in the presentation and there's two ways to do that you can",
    "start": "639450",
    "end": "644970"
  },
  {
    "text": "either put in the 12-digit account or you can put in the full route arm of",
    "start": "644970",
    "end": "650490"
  },
  {
    "text": "course you can use an IM user and that's what that looks like or if you're using something like Cognito you might be",
    "start": "650490",
    "end": "656100"
  },
  {
    "text": "using federated users users that are logging in from Amazon or Google or Facebook and then there's also the role",
    "start": "656100",
    "end": "662930"
  },
  {
    "text": "roles are used for Federation they're used to launch ec2 instances and then",
    "start": "662930",
    "end": "668160"
  },
  {
    "text": "speaking of ec2 when you launch an ec2 instance with a role and I hope you all are launching your instances with a role",
    "start": "668160",
    "end": "674850"
  },
  {
    "text": "you're actually delegating access to the ec2 service and there's a principle for each of the AWS services and that's what",
    "start": "674850",
    "end": "681420"
  },
  {
    "text": "the ec2 one looks like now if it's not obvious I'm using fake account numbers for all of my slides so if you're taking",
    "start": "681420",
    "end": "688560"
  },
  {
    "text": "photos and you really don't need to really take photos if you want I'll email you these slides if you want you",
    "start": "688560",
    "end": "695610"
  },
  {
    "text": "just need to replace these with your actual 12 digit account number now action is what you want to do right and",
    "start": "695610",
    "end": "702660"
  },
  {
    "text": "there are literally thousands of actions so this is where the documentation is going to become your best friend either",
    "start": "702660",
    "end": "709620"
  },
  {
    "text": "that or from the policy generator or the policy simulator you can get a list of all the actions or what are sometimes",
    "start": "709620",
    "end": "714870"
  },
  {
    "text": "I'll call API is because there's almost a one to one relationship between action and ap is now statements need to include",
    "start": "714870",
    "end": "721590"
  },
  {
    "text": "an action or a not action and so here I'm going to show you what some of those",
    "start": "721590",
    "end": "727110"
  },
  {
    "text": "actions look like and so here's three for ec2 I am and and s3 here's a couple",
    "start": "727110",
    "end": "734400"
  },
  {
    "text": "for sqs now most of the time when you're building policies it's actually probably going to be a list of API s and the way",
    "start": "734400",
    "end": "740670"
  },
  {
    "text": "that you show those in a policy is you encapsulate that list in square brackets and then you can also use wildcards so",
    "start": "740670",
    "end": "748500"
  },
  {
    "text": "down here you can use awhile an asterisk which is a multi character wildcard or you can use a question mark which is a",
    "start": "748500",
    "end": "754020"
  },
  {
    "text": "single character wildcard and so for the example down here where I have I am star access key star it's actually a",
    "start": "754020",
    "end": "759840"
  },
  {
    "text": "shorthand way of granting access to the create delete list and update API so you",
    "start": "759840",
    "end": "766230"
  },
  {
    "text": "wouldn't have to list them all out one of the things you'll learn as you're creating policies is there's a finite amount of space that you can use for a",
    "start": "766230",
    "end": "773070"
  },
  {
    "text": "policy for anybody who's hit that limit and this is a nice shortcut way to keep your policies nice and condensed now I",
    "start": "773070",
    "end": "780780"
  },
  {
    "text": "mentioned quickly that you have to have an action or a not action and I find that a lot of people are confused by",
    "start": "780780",
    "end": "788730"
  },
  {
    "text": "what I mean by not action or simply when you put a knot in front of it so let's",
    "start": "788730",
    "end": "793980"
  },
  {
    "text": "take a look at an example here and and what you have to remember about not action is it's allowing you to specify",
    "start": "793980",
    "end": "799710"
  },
  {
    "text": "an exception or an exclusion to a list of actions and this is also going to",
    "start": "799710",
    "end": "805260"
  },
  {
    "text": "help you to create you know what I think are smaller and easier to understand policies but let's look at an example",
    "start": "805260",
    "end": "810450"
  },
  {
    "text": "just so that you understand the difference so here I have a policy than am it's an allow policy and I have a not",
    "start": "810450",
    "end": "818340"
  },
  {
    "text": "action of I am star on all resources",
    "start": "818340",
    "end": "823430"
  },
  {
    "text": "alternatively I could create a similar policy where I grant all api's and then",
    "start": "823430",
    "end": "829530"
  },
  {
    "text": "I have a second statement where I deny I am star so question for the audience is",
    "start": "829530",
    "end": "835590"
  },
  {
    "text": "there a difference anyone think there's a difference besides one is longer than",
    "start": "835590",
    "end": "843150"
  },
  {
    "text": "the other yeah",
    "start": "843150",
    "end": "846110"
  },
  {
    "text": "this gentleman is correct so I'll just reiterate just speak kind of go over",
    "start": "852570",
    "end": "859600"
  },
  {
    "text": "where the difference is and he nailed it this one over here is not a deny it's an",
    "start": "859600",
    "end": "865029"
  },
  {
    "text": "exclusion so technically speaking if another policy is attached to this user or the user is erroneously added to an",
    "start": "865029",
    "end": "872110"
  },
  {
    "text": "administrative group they're going to get access to the IM api's however on this side you have an explicit deny an",
    "start": "872110",
    "end": "879240"
  },
  {
    "text": "explicit deny always Trump's and allow so even if somebody mistakenly puts this into an administrative group that would",
    "start": "879240",
    "end": "885730"
  },
  {
    "text": "grant access to I am this user would always be denied and so that's probably",
    "start": "885730",
    "end": "891130"
  },
  {
    "text": "the one of the common mistakes that people make is they think that when they're using a not action it's actually resulting in as a deny only if there's",
    "start": "891130",
    "end": "898270"
  },
  {
    "text": "not another policy attached would it act as a denying okay the resource is the",
    "start": "898270",
    "end": "903940"
  },
  {
    "text": "thing right the object are objects that you're trying to request and of course statements are going to have to have a",
    "start": "903940",
    "end": "909070"
  },
  {
    "text": "resource or a not resource and so here's a few examples of common resources for",
    "start": "909070",
    "end": "915010"
  },
  {
    "text": "an s3 bucket on sqs queue I like to show the dynamo ones because they're really long and so there's a couple of them and",
    "start": "915010",
    "end": "921310"
  },
  {
    "text": "then the ec2 one is one that we're going to use later on in the presentation where this actually grants access to",
    "start": "921310",
    "end": "927790"
  },
  {
    "text": "every ec2 instance in US East one right so that's our Virginia region the last",
    "start": "927790",
    "end": "934930"
  },
  {
    "text": "part of the park model is a condition and conditions can be a little bit tricky to understand if it's the first time you looked at them so I like to",
    "start": "934930",
    "end": "941500"
  },
  {
    "text": "show these with an example now policy can have multiple conditions and with a",
    "start": "941500",
    "end": "946990"
  },
  {
    "text": "condition you can have one or more keys so here I have the current time key and",
    "start": "946990",
    "end": "953890"
  },
  {
    "text": "I have the source IP key and then when you have a key you can have multiple variables our values so the way that",
    "start": "953890",
    "end": "961300"
  },
  {
    "text": "these are evaluated like between the different keys for current time current time and source IP those are treated as",
    "start": "961300",
    "end": "967720"
  },
  {
    "text": "a logical and and then as we evaluate the values for an individual key those",
    "start": "967720",
    "end": "973600"
  },
  {
    "text": "are treated as a logical or so the way that you end up interpreting this condition is if the time is after 11:00",
    "start": "973600",
    "end": "980650"
  },
  {
    "text": "a.m. Universal time code on November 30th 2016",
    "start": "980650",
    "end": "986320"
  },
  {
    "text": "and the time is before 3:00 p.m. 11:00 11:30 to 2016 and the request comes from",
    "start": "986320",
    "end": "992620"
  },
  {
    "text": "either of these two side or blocks then the statement that this condition is",
    "start": "992620",
    "end": "997720"
  },
  {
    "text": "attached to will evaluate to true and I know that's crystal clear and nobody has any about questions about so I'm going",
    "start": "997720",
    "end": "1003360"
  },
  {
    "text": "to move on I'll show you some other policies and I'll go I'll go through the conditions so I'll keep beating that in",
    "start": "1003360",
    "end": "1009630"
  },
  {
    "text": "until it makes a lot of sense so those are the basics so let's get into some of the more intermediary concepts so thus",
    "start": "1009630",
    "end": "1017310"
  },
  {
    "text": "far we've looked at literals and policies and there's a way to enter in variables into your policy that make",
    "start": "1017310",
    "end": "1022610"
  },
  {
    "text": "managing policies a lot easier one of the examples I'll typically go through is what if I wanted to create a home",
    "start": "1022610",
    "end": "1028470"
  },
  {
    "text": "directory in an s3 bucket where you know I have a path for each of my IM users if",
    "start": "1028470",
    "end": "1034798"
  },
  {
    "text": "you have a couple iam users it's not that hard to hard code a path you know for Bob Craig Sally Jeff whatever but",
    "start": "1034799",
    "end": "1041370"
  },
  {
    "text": "you have hundreds or thousands of users that can be a real pain and so one of the things you can do is any of those",
    "start": "1041370",
    "end": "1046620"
  },
  {
    "text": "keys that I just showed in a in a condition can be used as a variable and",
    "start": "1046620",
    "end": "1052260"
  },
  {
    "text": "so we looked at the source IP and the current time keys but there's also keys for user name user ID principle type if",
    "start": "1052260",
    "end": "1059130"
  },
  {
    "text": "you're using any type of Federation Federation you know via kognito or maybe you're using sam'l the security",
    "start": "1059130",
    "end": "1065790"
  },
  {
    "text": "assertion markup language there's a set of provider specific keys that you can use as variables in your policies and so",
    "start": "1065790",
    "end": "1072330"
  },
  {
    "text": "we'll show you a few examples of this and both these use cases here are demonstrations that I'll show in a",
    "start": "1072330",
    "end": "1078030"
  },
  {
    "text": "minute and so this is the anatomy of a policy with a variable the first thing I'm going to point out and I will pause",
    "start": "1078030",
    "end": "1084090"
  },
  {
    "text": "here is that the version is required if you don't put in this version we're",
    "start": "1084090",
    "end": "1090030"
  },
  {
    "text": "going to treat all of those variables as literal values and I can't tell you how many times I've made that mistake where",
    "start": "1090030",
    "end": "1096600"
  },
  {
    "text": "I left the version out I'm trying to test this and I've lost hours maybe days in my life because I left that simple",
    "start": "1096600",
    "end": "1102750"
  },
  {
    "text": "version out and so I'm going to beat that into everyone's brains because you",
    "start": "1102750",
    "end": "1107820"
  },
  {
    "text": "don't want to be like me you could use a variable as part of a condition you can",
    "start": "1107820",
    "end": "1113010"
  },
  {
    "text": "use a variable as part of a resource arm and you'll notice here all we do to create a variable is",
    "start": "1113010",
    "end": "1118490"
  },
  {
    "text": "make the key you encapsulate it in squiggly brackets and you put a dollar sign in front of it and so it can be",
    "start": "1118490",
    "end": "1124610"
  },
  {
    "text": "part of the in here you know I have a part of the the prefix in the condition I also have it as part of the resource",
    "start": "1124610",
    "end": "1130520"
  },
  {
    "text": "arm and what this policy does here is it grants user access to a home directory and s3 that can be accessed",
    "start": "1130520",
    "end": "1137260"
  },
  {
    "text": "programmatically and I say programmatically because you're going to need a set whole set of additional permissions if you want to be able to",
    "start": "1137260",
    "end": "1143360"
  },
  {
    "text": "use the s3 console so next thing I want to go through is policy enforcement this",
    "start": "1143360",
    "end": "1152360"
  },
  {
    "text": "is how we literally evaluate the policies when you make a request so when",
    "start": "1152360",
    "end": "1157730"
  },
  {
    "text": "you make a request against an AWS resource by default we assume that you're denied access and what we do is",
    "start": "1157730",
    "end": "1164450"
  },
  {
    "text": "we gather up all the policies that are associated with the user associated with the resource and the action that you're",
    "start": "1164450",
    "end": "1170630"
  },
  {
    "text": "trying to take and we go through and we evaluate all those policies now if anywhere in all of those policies is a",
    "start": "1170630",
    "end": "1178460"
  },
  {
    "text": "deny it doesn't matter if the rest of the policy is provided and allow we deny access to that request then we go",
    "start": "1178460",
    "end": "1185480"
  },
  {
    "text": "through and we look and say ok was there an allow there's no deny so let's look is there an allow yes there's an allow",
    "start": "1185480",
    "end": "1191179"
  },
  {
    "text": "so we'll go ahead and we'll grant you access to that resource if there's no denying if there's no allow kind of",
    "start": "1191179",
    "end": "1197960"
  },
  {
    "text": "start back at the beginning where we started and we deny you access to the resource so that's a pretty straightforward process okay so",
    "start": "1197960",
    "end": "1206179"
  },
  {
    "text": "hopefully that gives kind of the basics of what I am and policies are I want to",
    "start": "1206179",
    "end": "1212240"
  },
  {
    "text": "go ahead and start looking at some more examples and the first one that I want",
    "start": "1212240",
    "end": "1217309"
  },
  {
    "text": "to do is creating a home directory using s3 so the goal here is that I have a set",
    "start": "1217309",
    "end": "1224540"
  },
  {
    "text": "of IM users and I have a single bucket right and I want to share that bucket amongst those users but I want to have a",
    "start": "1224540",
    "end": "1231890"
  },
  {
    "text": "path a folder a prefix in in s3 terms that limits the access to my individual",
    "start": "1231890",
    "end": "1238070"
  },
  {
    "text": "users so specifically I'm going to go ahead and create a policy that uses policy variables and I'm going to enable",
    "start": "1238070",
    "end": "1244940"
  },
  {
    "text": "all my users to list buckets in the s3 console and I'm also going to limit those users to accessing only",
    "start": "1244940",
    "end": "1251460"
  },
  {
    "text": "cific folders within that bucket and so to do that I'm going to go back and the",
    "start": "1251460",
    "end": "1259559"
  },
  {
    "text": "first thing I want to do is remove these permissions from Bob and I want to just",
    "start": "1259559",
    "end": "1270870"
  },
  {
    "text": "show you currently bob has no access to the s3 console so he's currently getting",
    "start": "1270870",
    "end": "1275940"
  },
  {
    "text": "an access denied now if I go in here I'm going to add a user to a group so just like any of",
    "start": "1275940",
    "end": "1282450"
  },
  {
    "text": "those good cooking shows I got already think cooking in the kitchen for time and so I've created a group for the",
    "start": "1282450",
    "end": "1288120"
  },
  {
    "text": "reinvent s3 home folder I'm going to add him to that and what that does is it",
    "start": "1288120",
    "end": "1295080"
  },
  {
    "text": "gives him this lovely policy and I know you can't see it so I'm going to go",
    "start": "1295080",
    "end": "1300179"
  },
  {
    "text": "through this in PowerPoint PowerPoint presentation so don't worry about it if it's not clear but I'm just showing you that this is all real and now if I",
    "start": "1300179",
    "end": "1307770"
  },
  {
    "text": "switch back over is bob and i refresh",
    "start": "1307770",
    "end": "1311960"
  },
  {
    "text": "Firefox does its thing you're going to notice that Bob can see all the buckets",
    "start": "1315020",
    "end": "1321600"
  },
  {
    "text": "now I'll pause here for a minute because this is on purpose one of the things you have to understand about the tools is",
    "start": "1321600",
    "end": "1327450"
  },
  {
    "text": "they make some assumptions so when you go to the s3 console there's a set of api's that are called by default and if",
    "start": "1327450",
    "end": "1333240"
  },
  {
    "text": "you don't grant access to those api's you're just not going to get past step one and so one of the things that the users have to be able to do is see all",
    "start": "1333240",
    "end": "1340559"
  },
  {
    "text": "the buckets now he doesn't have access to them he's going to get access tonight no matter where he clicks on them but he",
    "start": "1340559",
    "end": "1347100"
  },
  {
    "text": "will be able to see them the only bucket that he can get into is the debt is the demo bucket of course he can't get into",
    "start": "1347100",
    "end": "1353250"
  },
  {
    "text": "the finance folder he can only get into the home folder and in here he can't",
    "start": "1353250",
    "end": "1358500"
  },
  {
    "text": "access other users folders he can't even access other users who have a similar",
    "start": "1358500",
    "end": "1364049"
  },
  {
    "text": "name the only thing he can do is go into his home folder for Bob where he keeps",
    "start": "1364049",
    "end": "1370380"
  },
  {
    "text": "images of my daughter so yeah moving on let's assume that",
    "start": "1370380",
    "end": "1380129"
  },
  {
    "text": "that's not some weird thing Bob's a family friend and he likes to keep images of my family in this folder so",
    "start": "1380129",
    "end": "1386009"
  },
  {
    "text": "how did I go about doing that let's take a look at the policy so as I mentioned",
    "start": "1386009",
    "end": "1391350"
  },
  {
    "text": "before the first thing you have to do is set the version because I'm going to use",
    "start": "1391350",
    "end": "1397830"
  },
  {
    "text": "variables in this policy and there's a set of api's as I mentioned that you need to access the console so",
    "start": "1397830",
    "end": "1404309"
  },
  {
    "text": "specifically you have to grant access to s3 list all my buckets in s3 get bucket location now if you don't want your",
    "start": "1404309",
    "end": "1411090"
  },
  {
    "text": "users to see all your buckets there's a lot of third-party tools out there but in this case you won't be using the s3",
    "start": "1411090",
    "end": "1416340"
  },
  {
    "text": "console so this is what you need to just view all those buckets and then specifically I want him to have access",
    "start": "1416340",
    "end": "1422940"
  },
  {
    "text": "to an individual bucket and to do that I grant access to the s3 list bucket API",
    "start": "1422940",
    "end": "1428450"
  },
  {
    "text": "for the yarn for my bucket and here I'm using a string equals that allows him to",
    "start": "1428450",
    "end": "1435029"
  },
  {
    "text": "see prefixes as long as they're null or their home and then the console uses a",
    "start": "1435029",
    "end": "1440879"
  },
  {
    "text": "default delimiter or forward slash so I put that in the policy as well now we want him to be able to see inside of",
    "start": "1440879",
    "end": "1447539"
  },
  {
    "text": "that bucket specifically within his home folder so once again I'm granting access to the same API this is list bucket ok",
    "start": "1447539",
    "end": "1455249"
  },
  {
    "text": "but I have to create a separate statement even though it's using the same resource because in this case I'm",
    "start": "1455249",
    "end": "1460259"
  },
  {
    "text": "using string like so the difference here is this is string equals and this one is string like and that's because I have a",
    "start": "1460259",
    "end": "1466529"
  },
  {
    "text": "variable which is going to be denied dynamically resolved at runtime and I'm using an asterisk because I don't know",
    "start": "1466529",
    "end": "1473190"
  },
  {
    "text": "what objects are going to be in there and so I can't use a string equals I have to use a string like now I have to",
    "start": "1473190",
    "end": "1478499"
  },
  {
    "text": "have one more statement because I need to be able to manipulate objects in that folder so when I clicked on that image",
    "start": "1478499",
    "end": "1484559"
  },
  {
    "text": "it was allowing me to do a get object now interestingly enough here when you use a list object the resource target",
    "start": "1484559",
    "end": "1491820"
  },
  {
    "text": "has to be the bucket and if you've ever programmed using s3 you know that when",
    "start": "1491820",
    "end": "1498149"
  },
  {
    "text": "you call something like get object or put object or delete object you're not using a target of a bucket you're",
    "start": "1498149",
    "end": "1504690"
  },
  {
    "text": "actually using the full path of the object and so here I have to grant access to the route of",
    "start": "1504690",
    "end": "1511290"
  },
  {
    "text": "the folder using a variable and potentially any subfolder so I didn't have any subfolders in my example here",
    "start": "1511290",
    "end": "1517800"
  },
  {
    "text": "but you can imagine Bob had built out a folder tree underneath and so this is the policy that you would need to do in",
    "start": "1517800",
    "end": "1523620"
  },
  {
    "text": "order to grant access to that folder so another common scenario that people talk to me about is they have these projects",
    "start": "1523620",
    "end": "1531360"
  },
  {
    "text": "and you know administrators we're busy people we don't have time to create creating users and setting permissions",
    "start": "1531360",
    "end": "1538260"
  },
  {
    "text": "all day right so you want to be able to delegate that authority to a project",
    "start": "1538260",
    "end": "1543480"
  },
  {
    "text": "owner but you don't want them to have full admin rights so this is something we call the limited i.m administrator we",
    "start": "1543480",
    "end": "1550050"
  },
  {
    "text": "actually have a security blog post now I'll send you there's links at the end of the presentation if you want to read more about this but the idea is that I",
    "start": "1550050",
    "end": "1556290"
  },
  {
    "text": "create an iamb administrator and they can use the IM console and they can manage users and they can create users",
    "start": "1556290",
    "end": "1562920"
  },
  {
    "text": "but they're only able to attach certain policies and so in this example here I'm",
    "start": "1562920",
    "end": "1568560"
  },
  {
    "text": "going to create a user that user is going to be Bob and Bob is going to have",
    "start": "1568560",
    "end": "1573690"
  },
  {
    "text": "the ability to create users but only attach this Amazon DynamoDB full access and the s3 bucket policy sorry the s3",
    "start": "1573690",
    "end": "1582900"
  },
  {
    "text": "policy that I had used on Bob and so I'll switch now and I'll go in and once",
    "start": "1582900",
    "end": "1590340"
  },
  {
    "text": "again I'll strip Bob of all of his rights I'm going to add them to another",
    "start": "1590340",
    "end": "1595980"
  },
  {
    "text": "group this time it will be the reinvent",
    "start": "1595980",
    "end": "1603330"
  },
  {
    "text": "limited I am admin group and one of the things I'm going to show you here is you",
    "start": "1603330",
    "end": "1609630"
  },
  {
    "text": "can have multiple policies attached to a group and so there's two policies that I have here one which is kind of a generic",
    "start": "1609630",
    "end": "1616110"
  },
  {
    "text": "policy that I created that gave access to a user to access the management console and sort of manage themselves so",
    "start": "1616110",
    "end": "1623100"
  },
  {
    "text": "maybe they want to go in and rotate their secrets or something so I'm leveraging that policy and then the other policy here is specifically what",
    "start": "1623100",
    "end": "1630930"
  },
  {
    "text": "limits the user so the user can go in and create a user they can attach policies but there are certain policies",
    "start": "1630930",
    "end": "1637230"
  },
  {
    "text": "in here that they only have access to and so now that I've added Bob to this group I can go over to Bob let's get out",
    "start": "1637230",
    "end": "1646230"
  },
  {
    "text": "of that go to I am you notice you'll get",
    "start": "1646230",
    "end": "1655170"
  },
  {
    "text": "some error messages because I haven't given him full rights to I am right but he can go into the users you can see a list of the users he can create a user",
    "start": "1655170",
    "end": "1663680"
  },
  {
    "text": "let's say let's create a user Craig and he can access the management console",
    "start": "1663680",
    "end": "1672080"
  },
  {
    "text": "let's give him a password I don't know",
    "start": "1672410",
    "end": "1678120"
  },
  {
    "text": "what I just typed so let me retype that it wasn't password and then click Next",
    "start": "1678120",
    "end": "1684930"
  },
  {
    "text": "and here I'm going to attach some permissions so reinvents what did I do",
    "start": "1684930",
    "end": "1692220"
  },
  {
    "text": "it was the s3 home folder I gave him access to and the other one was DynamoDB",
    "start": "1692220",
    "end": "1699590"
  },
  {
    "text": "dinah doe dynamo DB and I think it was",
    "start": "1699590",
    "end": "1706140"
  },
  {
    "text": "the full access one we'll find out if I did it right in a minute so click review create user and I have",
    "start": "1706140",
    "end": "1712680"
  },
  {
    "text": "in fact created a user Craig oops let me",
    "start": "1712680",
    "end": "1719370"
  },
  {
    "text": "go back here look at my users and one of the things I just want to point out is you know I can't go and elevate",
    "start": "1719370",
    "end": "1726360"
  },
  {
    "text": "privilege so if I try to go in and add permissions and I try to add you know",
    "start": "1726360",
    "end": "1731760"
  },
  {
    "text": "Craig to the admin group",
    "start": "1731760",
    "end": "1735050"
  },
  {
    "text": "so let's give them full admin access see",
    "start": "1742340",
    "end": "1748700"
  },
  {
    "text": "Bob's going to get an access denied so he can't elevate privilege he can only do work within the sandbox that I've done and so he's created Kraig now this",
    "start": "1748700",
    "end": "1755840"
  },
  {
    "text": "is where I'm going to have to actually log out so I'll sign out I'll sign sign",
    "start": "1755840",
    "end": "1764570"
  },
  {
    "text": "back in and this time I'll come in as Kraig fingers crossed that I got the",
    "start": "1764570",
    "end": "1773450"
  },
  {
    "text": "password right and Craig can do a few things so we gave him access to dynamo",
    "start": "1773450",
    "end": "1779660"
  },
  {
    "text": "we gave him access to s3 we didn't give",
    "start": "1779660",
    "end": "1784700"
  },
  {
    "text": "him access to ec2 so that might be interesting to look at so I'll go to dynamo because that loaded first and",
    "start": "1784700",
    "end": "1790960"
  },
  {
    "text": "I'll go to tables and in here I have game stores table and he can go in he",
    "start": "1790960",
    "end": "1797660"
  },
  {
    "text": "can look at all the items and there's users named Chuck Norris Bruce and Lee",
    "start": "1797660",
    "end": "1803110"
  },
  {
    "text": "these are my ninjas okay they're not really ninjas but the best I could come",
    "start": "1803110",
    "end": "1808160"
  },
  {
    "text": "up with so so he has full access there and then if I go to the ec2 console you",
    "start": "1808160",
    "end": "1813950"
  },
  {
    "text": "can see he's going to get a bunch of error messages because he doesn't have access to anything there but go to s3 he's going to have the same permissions",
    "start": "1813950",
    "end": "1820340"
  },
  {
    "text": "as Bob but just to kind of prove it if he goes into the demo folder goes into home he can't get into Bob's folder he",
    "start": "1820340",
    "end": "1827300"
  },
  {
    "text": "can only get into Craig's folder where there is literally nothing to see and",
    "start": "1827300",
    "end": "1833170"
  },
  {
    "text": "there is literally nothing to see so it just kind of proves that if you have",
    "start": "1833170",
    "end": "1838910"
  },
  {
    "text": "these project administrators you can go in and they can be fully in charge of managing those projects and you as the",
    "start": "1838910",
    "end": "1846050"
  },
  {
    "text": "system administrator don't have to get involved in that so let me log out again just set up our next demo bear with me",
    "start": "1846050",
    "end": "1859120"
  },
  {
    "text": "okay so how did I do that so as I mentioned I have two policies attached to the group the first one is just this",
    "start": "1869809",
    "end": "1875719"
  },
  {
    "text": "general policy that I give I kind of call it the self manage policy because it allows me to go in and look at all",
    "start": "1875719",
    "end": "1881960"
  },
  {
    "text": "the users and if I want my users to be able to go in and change their password",
    "start": "1881960",
    "end": "1887210"
  },
  {
    "text": "the action is get login profile why we",
    "start": "1887210",
    "end": "1892309"
  },
  {
    "text": "chose get login profile instead of set password I don't know but if you want to be able to set your password that's the",
    "start": "1892309",
    "end": "1898690"
  },
  {
    "text": "that's the API you're going to need you want to be able to list the groups for my user maybe I want to be able to list",
    "start": "1898690",
    "end": "1904429"
  },
  {
    "text": "the keys for myself and so this would allow you to self-manage now I'm kind of just taking advantage of that policy",
    "start": "1904429",
    "end": "1909859"
  },
  {
    "text": "because it also allows the user into the management console now I need to be able to create users and attach permissions",
    "start": "1909859",
    "end": "1916639"
  },
  {
    "text": "so once again I'm using I'm not using a variable on this one I don't know why I",
    "start": "1916639",
    "end": "1921919"
  },
  {
    "text": "put that well I put the version in there just because it's good hygiene but now here's the list of all the api's that",
    "start": "1921919",
    "end": "1928099"
  },
  {
    "text": "you would need in terms of creating a user creating a login profile being able to list their policies and and do",
    "start": "1928099",
    "end": "1935330"
  },
  {
    "text": "everything that I show and then here's the little piece of trickery kind of this is the the pro tip is if you want",
    "start": "1935330",
    "end": "1942830"
  },
  {
    "text": "to limit the user to attaching specific manage policies you're going to take advantage of the I am attached user",
    "start": "1942830",
    "end": "1948619"
  },
  {
    "text": "policy and the I am detach user policy and specifically here is where you put",
    "start": "1948619",
    "end": "1954320"
  },
  {
    "text": "in the arns because each of these policies now have an Amazon resource name for them you just list all the",
    "start": "1954320",
    "end": "1960889"
  },
  {
    "text": "policies that you want the user to be able to add or remove to the users and that's it that's how you create a",
    "start": "1960889",
    "end": "1965929"
  },
  {
    "text": "limited admin now lots of customers these days are using multiple AWS",
    "start": "1965929",
    "end": "1972529"
  },
  {
    "text": "accounts in fact is there anybody in here using more than one AWS account okay great all right so that you might",
    "start": "1972529",
    "end": "1979159"
  },
  {
    "text": "actually get value out of this policy then so when you have multiple accounts let's say you have a developer account",
    "start": "1979159",
    "end": "1985519"
  },
  {
    "text": "you have a production account one of the nice things that we introduced some time ago is that from the management console",
    "start": "1985519",
    "end": "1992239"
  },
  {
    "text": "you can take advantage of this thing called switch role right so you create an IM role and then you switch between",
    "start": "1992239",
    "end": "1998119"
  },
  {
    "text": "the two and by default when you create one of these roles",
    "start": "1998119",
    "end": "2003190"
  },
  {
    "text": "it has an access policy what can the role do and it has a trust policy who does it trust and by default when it",
    "start": "2003190",
    "end": "2009940"
  },
  {
    "text": "generates it it sets a trust at the root level so it trusts the entire account but you can modify that you can change",
    "start": "2009940",
    "end": "2016210"
  },
  {
    "text": "it and you can scope it down and in fact you can use I am users or you can use federated users and a lot of people",
    "start": "2016210",
    "end": "2022840"
  },
  {
    "text": "don't know how to specify a federated user because they've never seen the STS arns before and so I'm going to show you",
    "start": "2022840",
    "end": "2029830"
  },
  {
    "text": "this demonstration but because cross account access is typically a new concept for most people I'm going to use",
    "start": "2029830",
    "end": "2035530"
  },
  {
    "text": "a diagram so imagine I have a developer account and I have a developer and creatively his name is Bob and Bob wants",
    "start": "2035530",
    "end": "2044800"
  },
  {
    "text": "to access the production account in my production account I have a role creatively named my role and this role",
    "start": "2044800",
    "end": "2053320"
  },
  {
    "text": "grants some amount of permission so I didn't have room so I just said actions over here and that's the access policy",
    "start": "2053320",
    "end": "2060010"
  },
  {
    "text": "and then you have the trust policy this is who can assume the role and by",
    "start": "2060010",
    "end": "2066340"
  },
  {
    "text": "default it's going to give you something like this it's trusting everybody in this root account now it's not really",
    "start": "2066340",
    "end": "2073030"
  },
  {
    "text": "trusting everybody because inside of the developer account a principal needs to have been granted access to assume that",
    "start": "2073030",
    "end": "2079840"
  },
  {
    "text": "role so I have Bob and Bob has a policy that allows him to call assume role on",
    "start": "2079840",
    "end": "2085679"
  },
  {
    "text": "this role this is what you have to do to set up the switch console right so Bob logs in as Bob into the management",
    "start": "2085680",
    "end": "2094120"
  },
  {
    "text": "console and then he goes and he uses his feature called switch and when he does",
    "start": "2094120",
    "end": "2099430"
  },
  {
    "text": "that what happens behind the scenes is it assumes a role and then it logs them in as a federated user if you will and",
    "start": "2099430",
    "end": "2107830"
  },
  {
    "text": "his identity actually in the system changes at that point he looks like this so it's an STS Arn where it has the",
    "start": "2107830",
    "end": "2114790"
  },
  {
    "text": "assumed role my role and Bob and so if the policies were too small to see this",
    "start": "2114790",
    "end": "2120370"
  },
  {
    "text": "is what a trust policy looks like by default and you know granting access to of everybody in another account and it's",
    "start": "2120370",
    "end": "2128260"
  },
  {
    "text": "not so ninja-like but you can change that to an IM user right using the IM principle arm that we looked at or you",
    "start": "2128260",
    "end": "2135790"
  },
  {
    "text": "can change that to a temporary credential using STS and of course you can even mix and match so",
    "start": "2135790",
    "end": "2143440"
  },
  {
    "text": "let's go ahead and see what that looks like now I'm using ie because I need a",
    "start": "2143440",
    "end": "2149200"
  },
  {
    "text": "third browser and otherwise I wouldn't and here is my role and you can see here",
    "start": "2149200",
    "end": "2159460"
  },
  {
    "text": "is the AWS account here's the name of the role and what you do to add this as",
    "start": "2159460",
    "end": "2165400"
  },
  {
    "text": "you go to switch role and this is where you would add in the account the role",
    "start": "2165400",
    "end": "2171369"
  },
  {
    "text": "and the display name now of course I've already done this so if I go over here once again I'm just going to remove Bob",
    "start": "2171369",
    "end": "2178450"
  },
  {
    "text": "from this group and I'm going to add them to a group and it I'll use the",
    "start": "2178450",
    "end": "2186460"
  },
  {
    "text": "cross account access I used really good names now add permissions here and then once",
    "start": "2186460",
    "end": "2193720"
  },
  {
    "text": "again there's a single policy here and it's a very simple one it's the same one we saw on the slide that allows him to",
    "start": "2193720",
    "end": "2198760"
  },
  {
    "text": "assume that role now if I go over here in let's look at what don't I have",
    "start": "2198760",
    "end": "2204520"
  },
  {
    "text": "access to I don't think I have access to ec2 right now so if I go in here oh oh",
    "start": "2204520",
    "end": "2215230"
  },
  {
    "text": "wait I am the admin sorry if I go over here is Bob and I look again I'm going",
    "start": "2215230",
    "end": "2225460"
  },
  {
    "text": "to see a bunch of access denied but what I've done over here in the role sorry",
    "start": "2225460",
    "end": "2231339"
  },
  {
    "text": "I'm switching between browsers so now I'm in the the developer account or the production account and here's the role",
    "start": "2231339",
    "end": "2237520"
  },
  {
    "text": "and the permissions that I've granted is access to the read-only policies this",
    "start": "2237520",
    "end": "2243460"
  },
  {
    "text": "gives me access to every immutable API inside of a tub AWS and then I have the",
    "start": "2243460",
    "end": "2248890"
  },
  {
    "text": "trust policy and you can see down here I have I have the two trusted entities",
    "start": "2248890",
    "end": "2258430"
  },
  {
    "text": "down here right but the way you do is you edit this and it's just another",
    "start": "2258430",
    "end": "2263559"
  },
  {
    "text": "policy document and so I can go in here and I can add to the list of users that I want to actually delegate access to",
    "start": "2263559",
    "end": "2270360"
  },
  {
    "text": "account so I've already done this I've delegated it to Bob I've delegated to this federated user which you haven't",
    "start": "2270360",
    "end": "2276630"
  },
  {
    "text": "realized but in the admin account I've been logged in as a federated user the whole time and if I go in as Bob Bob has",
    "start": "2276630",
    "end": "2282780"
  },
  {
    "text": "no access to I am in this account but when I go and I switch so you just get",
    "start": "2282780",
    "end": "2287910"
  },
  {
    "text": "it from the drop-down here I'm now going to switch to that account you can see",
    "start": "2287910",
    "end": "2293340"
  },
  {
    "text": "and now I have read access so this is how I can switch back and forth I can go",
    "start": "2293340",
    "end": "2299640"
  },
  {
    "text": "back and of course just to prove it here I am the administrator and you can see I",
    "start": "2299640",
    "end": "2308970"
  },
  {
    "text": "have this weird-looking name up here because I've logged in as a federated user but I can also switch to that",
    "start": "2308970",
    "end": "2317010"
  },
  {
    "text": "account or actually have a lot less privileges because I only have read-only access here but that's how you switch",
    "start": "2317010",
    "end": "2323610"
  },
  {
    "text": "back and forth and that's how you lock it down to just specific users or specific federated users okay yet about",
    "start": "2323610",
    "end": "2333390"
  },
  {
    "text": "20 minutes left and this is my favorite topic because this is where everybody",
    "start": "2333390",
    "end": "2340050"
  },
  {
    "text": "struggles so let's talk about resource level permissions with ec2 so if you've",
    "start": "2340050",
    "end": "2347700"
  },
  {
    "text": "been with us for a while you probably remember the time when policies for easy - policies applied to all resources and",
    "start": "2347700",
    "end": "2355530"
  },
  {
    "text": "the good news is now for a set of actions and resources you can set",
    "start": "2355530",
    "end": "2361200"
  },
  {
    "text": "permissions per resource so the types of things you can do is you can limit a user from starting stopping or",
    "start": "2361200",
    "end": "2367460"
  },
  {
    "text": "terminating a particular instance or set of instances and so just to give you an idea of how this looked this is what",
    "start": "2367460",
    "end": "2374850"
  },
  {
    "text": "Paulo people created policies maybe about four years ago and yeah it's not",
    "start": "2374850",
    "end": "2380010"
  },
  {
    "text": "very ninja-like because this allows a user to terminate any instance in any region anywhere doesn't matter if they",
    "start": "2380010",
    "end": "2387720"
  },
  {
    "text": "have access this is what they would need if they need to terminate access and so we improved upon that this is using the",
    "start": "2387720",
    "end": "2394890"
  },
  {
    "text": "new longer instance IDs you probably got an email about that and",
    "start": "2394890",
    "end": "2400620"
  },
  {
    "text": "this here says you can terminate an instance but only if it's a specific instance now that's probably not",
    "start": "2400620",
    "end": "2406290"
  },
  {
    "text": "practical so you know maybe what you want to do is grant them access to terminate instances but maybe only in a",
    "start": "2406290",
    "end": "2412830"
  },
  {
    "text": "certain region so these are all the instances in u.s. East but probably even better is tagging those instances so I",
    "start": "2412830",
    "end": "2420030"
  },
  {
    "text": "could tag an instance as dev as production or tag it as a specific owner and now I can grant this policy to",
    "start": "2420030",
    "end": "2426240"
  },
  {
    "text": "somebody and it say well you could terminate an instance any instance in u.s. East one as long as it's tagged",
    "start": "2426240",
    "end": "2432660"
  },
  {
    "text": "with the developer tag and so this makes writing policies for ec2 a whole lot",
    "start": "2432660",
    "end": "2440010"
  },
  {
    "text": "more powerful now what supports ec2 resource level permissions ec2 has a lot",
    "start": "2440010",
    "end": "2446910"
  },
  {
    "text": "of AP is ec2 has a lot of resources and they don't fit on a slide so I'm giving",
    "start": "2446910",
    "end": "2452430"
  },
  {
    "text": "you an example of some of the resources and some of the actions that you can use",
    "start": "2452430",
    "end": "2457680"
  },
  {
    "text": "you cannot use all resources and you cannot use all actions and quite honestly this is where the documentation",
    "start": "2457680",
    "end": "2464940"
  },
  {
    "text": "becomes your friend I'm pretty good with policies but when I'm doing something",
    "start": "2464940",
    "end": "2470550"
  },
  {
    "text": "with ec2 I have two monitors one for the docs one for my policy editor and I literally have to go back and forth and I wish I",
    "start": "2470550",
    "end": "2477360"
  },
  {
    "text": "had a better answer for you but that's kind of the ninja way of doing it today and so let's take a look at creating a",
    "start": "2477360",
    "end": "2485300"
  },
  {
    "text": "policy using ec2 resource level permissions and so the first one I want",
    "start": "2485300",
    "end": "2490380"
  },
  {
    "text": "to show you is how I might limit a user from starting stopping or terminating in an instance unless the instance is owned",
    "start": "2490380",
    "end": "2496890"
  },
  {
    "text": "by that user and the way that I'm going to do that is I have a number of ec2",
    "start": "2496890",
    "end": "2502230"
  },
  {
    "text": "instances and they are they're all tagged with an owner tag and I have a policy that's going to grant a user",
    "start": "2502230",
    "end": "2507840"
  },
  {
    "text": "access to the ec2 console so they can go in and see it and I have a policy that's going to limit what they can do with",
    "start": "2507840",
    "end": "2513990"
  },
  {
    "text": "those instances based on the owner tag so I'll go back in is the admin and I'm",
    "start": "2513990",
    "end": "2522600"
  },
  {
    "text": "going to select Bob and once again I am going to remove him from this group and",
    "start": "2522600",
    "end": "2530000"
  },
  {
    "text": "I'm going to add them to another group and this one is going to be the reinvent",
    "start": "2530000",
    "end": "2538230"
  },
  {
    "text": "ec2 owner group and once again he's got",
    "start": "2538230",
    "end": "2543359"
  },
  {
    "text": "two sets of permissions here now this first one is the Amazon ec2 read-only",
    "start": "2543359",
    "end": "2548700"
  },
  {
    "text": "access and this is a managed policy that AWS provides so there's nothing you need to do to create this one you just attach",
    "start": "2548700",
    "end": "2555270"
  },
  {
    "text": "it and if ec2 adds another API it'll show up in this list and so this will",
    "start": "2555270",
    "end": "2561869"
  },
  {
    "text": "give him read access to the ec2 console and then here's my policy that limits",
    "start": "2561869",
    "end": "2568320"
  },
  {
    "text": "what he can do with the instances and it's not that complicated and like the other policies I'll show you in",
    "start": "2568320",
    "end": "2573990"
  },
  {
    "text": "PowerPoint so a human can read them and now if I go over here as Bob I'm going",
    "start": "2573990",
    "end": "2580260"
  },
  {
    "text": "to open up ec2 and we go to my running",
    "start": "2580260",
    "end": "2587010"
  },
  {
    "text": "instances and I only have two here and they're both stopped and one of the",
    "start": "2587010",
    "end": "2594060"
  },
  {
    "text": "things I'll show because I'm surprised how many people you know have haven't played with this but I have this owner column and the way that you you add this",
    "start": "2594060",
    "end": "2600330"
  },
  {
    "text": "is as you have tags you can show and hide that owner column so little tip",
    "start": "2600330",
    "end": "2607859"
  },
  {
    "text": "there and for Bob this one is tagged as owner Bob so he can go in here and he",
    "start": "2607859",
    "end": "2615090"
  },
  {
    "text": "can start that instance and a few moments that I'll actually be running",
    "start": "2615090",
    "end": "2620780"
  },
  {
    "text": "but this is an instance owned by me so I don't want it Bob mucking with my",
    "start": "2620780",
    "end": "2627000"
  },
  {
    "text": "instance so I don't want them to you know go in here and try to terminate it but he'll try to terminate it and he'll",
    "start": "2627000",
    "end": "2635220"
  },
  {
    "text": "get this lovely error message and I'll show you what this error message actually says because I can read it but",
    "start": "2635220",
    "end": "2640530"
  },
  {
    "text": "probably you know most of you don't know what that says right now so I'm going to cancel that and if this is running I can",
    "start": "2640530",
    "end": "2647910"
  },
  {
    "text": "actually show you how Bob can go in and you can even stop that instance as well",
    "start": "2647910",
    "end": "2653690"
  },
  {
    "text": "and this policy is pretty straightforward so let me walk you through it",
    "start": "2653690",
    "end": "2660240"
  },
  {
    "text": "there's two policies and as I mentioned the first one this is just the AWS",
    "start": "2660240",
    "end": "2665380"
  },
  {
    "text": "managed on ec2 read-only access these are all the api's you would need if you went",
    "start": "2665380",
    "end": "2671620"
  },
  {
    "text": "into the management console and you needed to view something so specifically all the ec2 all the alast ELB cloud",
    "start": "2671620",
    "end": "2679390"
  },
  {
    "text": "watch and auto scaling api's and so you have access to all the describe and all the lists if you didn't want them to see",
    "start": "2679390",
    "end": "2686530"
  },
  {
    "text": "something you could create your own policy and you could cut back but as a shortcut this is probably the easiest way to give access to the console now",
    "start": "2686530",
    "end": "2692820"
  },
  {
    "text": "more interestingly is the policy that locks down access to ec2 and so like the",
    "start": "2692820",
    "end": "2699370"
  },
  {
    "text": "other policies that use a variable you got to make sure that you put the version in there right and then I have",
    "start": "2699370",
    "end": "2704920"
  },
  {
    "text": "this condition remember that condition I had and I was trying to explain it so this is a pretty straightforward condition just doing",
    "start": "2704920",
    "end": "2710800"
  },
  {
    "text": "string equals and this is what you do if you have a tab so this is what it looks like when you put an owner tag and I'm",
    "start": "2710800",
    "end": "2717220"
  },
  {
    "text": "going to leverage variables here that resolve to Bob Jeff or whoever is a user in my account and as long as I have this",
    "start": "2717220",
    "end": "2726130"
  },
  {
    "text": "specific key and this value match in there the user is going to be caught be",
    "start": "2726130",
    "end": "2731410"
  },
  {
    "text": "able to call any four of these api's",
    "start": "2731410",
    "end": "2736230"
  },
  {
    "text": "okay so remember where we started right we wanted to limit a user from starting",
    "start": "2739410",
    "end": "2745900"
  },
  {
    "text": "an instance unless the instance was a t1 t2 or an m3 and I had an epic failure",
    "start": "2745900",
    "end": "2751540"
  },
  {
    "text": "let's go ahead and try to do that one again so same rules apply except this time I'm going to use a managed policy",
    "start": "2751540",
    "end": "2757330"
  },
  {
    "text": "that lit that actually limits starting ec2 instances to those specific instance types and I'm just going to simply",
    "start": "2757330",
    "end": "2763390"
  },
  {
    "text": "attach that policy to to Bob and go on and so let me switch back over here and",
    "start": "2763390",
    "end": "2770910"
  },
  {
    "text": "I'm going to remove them through the group one more time and this time I'm just going to add a policy and let's see",
    "start": "2770910",
    "end": "2780160"
  },
  {
    "text": "reinvent I have this verbose instance",
    "start": "2780160",
    "end": "2785350"
  },
  {
    "text": "type policy so I'm going to go ahead and attach that",
    "start": "2785350",
    "end": "2790830"
  },
  {
    "text": "and now bob has access so I'm going to go back here refresh and I want to",
    "start": "2793720",
    "end": "2800360"
  },
  {
    "text": "launch an instance so we'll test the failed case right because we want to make sure that we're limiting him so I'll just prove this this actually works",
    "start": "2800360",
    "end": "2808660"
  },
  {
    "text": "we'll go through and accept a bunch of the defaults yes and of course I get a",
    "start": "2809350",
    "end": "2816830"
  },
  {
    "text": "fail message so this is good what I'm going to do is I'm going to copy this into my clipboard because I want to show",
    "start": "2816830",
    "end": "2823100"
  },
  {
    "text": "you in a minute how you actually get something useful out of that but I'm going to go back did I actually copy it I don't know yeah",
    "start": "2823100",
    "end": "2830180"
  },
  {
    "text": "there we go I'm going to go back and this time I'm going to change it to the",
    "start": "2830180",
    "end": "2835880"
  },
  {
    "text": "t2 because that was the one that we wanted to allow right I'm going to review and launch yes next launch check",
    "start": "2835880",
    "end": "2845770"
  },
  {
    "text": "cross fingers and voila we're able to launch and just to prove",
    "start": "2845770",
    "end": "2853160"
  },
  {
    "text": "it you can see that it's actually starting up there and so that's how you",
    "start": "2853160",
    "end": "2858440"
  },
  {
    "text": "go about actually creating a policy that does it now what does that policy look like it's a little bit more complicated",
    "start": "2858440",
    "end": "2867430"
  },
  {
    "text": "and so that this in this one I use three statements and I'm going to walk through",
    "start": "2867430",
    "end": "2872990"
  },
  {
    "text": "them because these are a little bit more complicated than others that I've shown so here is something that includes all",
    "start": "2872990",
    "end": "2878570"
  },
  {
    "text": "services and actions that you want to exclude and so this is important I'm",
    "start": "2878570",
    "end": "2883600"
  },
  {
    "text": "giving you access to everything in AWS unless it's an IM API or ec2 instances",
    "start": "2883600",
    "end": "2890210"
  },
  {
    "text": "so this statement right here it says you can have s3 it says that you can have",
    "start": "2890210",
    "end": "2895550"
  },
  {
    "text": "Dino mode everything so if you want to lock it down you actually have to put a list of api's or services that you don't",
    "start": "2895550",
    "end": "2903620"
  },
  {
    "text": "want them to have access to now here's another interesting one this is using a not resource and so what I'm saying here",
    "start": "2903620",
    "end": "2910190"
  },
  {
    "text": "is you have access to the ec2 run instance for every resource unless it's actually an instance because when you",
    "start": "2910190",
    "end": "2916340"
  },
  {
    "text": "launch an instance you need a volume you need access to the key pair you need the security group and so this grants access",
    "start": "2916340",
    "end": "2922400"
  },
  {
    "text": "to everything that is not an instance and then this last piece here is where",
    "start": "2922400",
    "end": "2927650"
  },
  {
    "text": "we grant access to the run instance for the instances that are in u.s. East to",
    "start": "2927650",
    "end": "2933140"
  },
  {
    "text": "or EU West one as long as those instance types are T 1 T 2 and M 3 now it's kind",
    "start": "2933140",
    "end": "2940970"
  },
  {
    "text": "of complicated so I think we can you make it even easier and the way we do that is we take advantage of a very",
    "start": "2940970",
    "end": "2946700"
  },
  {
    "text": "little-known language a thing that we have in the in the policy language called if exists so the reason that that",
    "start": "2946700",
    "end": "2954500"
  },
  {
    "text": "first time I went through it failed is I was testing for a condition on a",
    "start": "2954500",
    "end": "2959619"
  },
  {
    "text": "resource where that key doesn't exist and if I test for a non-existent key we",
    "start": "2959619",
    "end": "2966859"
  },
  {
    "text": "actually evaluate that as an access denied so that's why that policy didn't pass the first time we went through but",
    "start": "2966859",
    "end": "2973940"
  },
  {
    "text": "you can depending if exists to any operator except for the null condition and so for example here I can turn the",
    "start": "2973940",
    "end": "2980089"
  },
  {
    "text": "string like if exists and what this allows you to do is essentially create policies that don't care if the key is",
    "start": "2980089",
    "end": "2986990"
  },
  {
    "text": "there we'll enforce the condition check if the key isn't there because it doesn't exist",
    "start": "2986990",
    "end": "2992180"
  },
  {
    "text": "we'll simply ignore it and so what we're able to do is to create a much tighter policy and so this one here grants",
    "start": "2992180",
    "end": "3000160"
  },
  {
    "text": "access to only ec2 api's it gives them access to all of them so I don't have to worry about excluding i.m or anything",
    "start": "3000160",
    "end": "3006910"
  },
  {
    "text": "else and then here I deny access to EC",
    "start": "3006910",
    "end": "3012040"
  },
  {
    "text": "to run instance for any instance in any region if the string not like if exists",
    "start": "3012040",
    "end": "3020740"
  },
  {
    "text": "an instance type of t1 t2 or t3 and I don't have to add in any permissions I",
    "start": "3020740",
    "end": "3027069"
  },
  {
    "text": "don't have to make anything any other changes and this is actually the policy that I gave to the customer to solve",
    "start": "3027069",
    "end": "3033700"
  },
  {
    "text": "their use case also you can see it's not possible it's really not possible to",
    "start": "3033700",
    "end": "3039310"
  },
  {
    "text": "create that unless you go through and you understand how all the services do it ok so that sounds great what if I get",
    "start": "3039310",
    "end": "3046480"
  },
  {
    "text": "stuck can you call me you can't call me you you could get on the forums though",
    "start": "3046480",
    "end": "3053770"
  },
  {
    "text": "you know I don't have a really good SLA on my response times to those so",
    "start": "3053770",
    "end": "3059430"
  },
  {
    "text": "let's look at some of the magic if you will of testing and debugging so the",
    "start": "3059430",
    "end": "3068220"
  },
  {
    "text": "first thing that first will we have and we've looked at this kind of extensively is the policy editor right and this is",
    "start": "3068220",
    "end": "3074130"
  },
  {
    "text": "going to give you basics JSON editing policy grammar errors right it's going",
    "start": "3074130",
    "end": "3080400"
  },
  {
    "text": "to fix some of the syntactical issues you may encounter now another tool that",
    "start": "3080400",
    "end": "3085500"
  },
  {
    "text": "we have is the policy simulator and just do the time I won't have a chance to",
    "start": "3085500",
    "end": "3090630"
  },
  {
    "text": "actually pull up the policy simulator and walk it through with you but you can think of the policy simulator is kind of",
    "start": "3090630",
    "end": "3095880"
  },
  {
    "text": "a sandbox where you can test your policies or you can offer it completely new policies and then you run them",
    "start": "3095880",
    "end": "3102450"
  },
  {
    "text": "through the simulator and it will tell you if you're actually granting or denying access now full disclaimer it's",
    "start": "3102450",
    "end": "3108750"
  },
  {
    "text": "not 100% perfect but it is a tool that you can use to kind of get part of the",
    "start": "3108750",
    "end": "3113760"
  },
  {
    "text": "way if you really want to test a policy at some point you're going to have to",
    "start": "3113760",
    "end": "3119910"
  },
  {
    "text": "put it in one of your AWS accounts and test it now ec2 has this authorization",
    "start": "3119910",
    "end": "3125400"
  },
  {
    "text": "message and it looks a little something like that and if you know how to you can",
    "start": "3125400",
    "end": "3132390"
  },
  {
    "text": "literally pull some gold out of that message specifically you can find out if",
    "start": "3132390",
    "end": "3139829"
  },
  {
    "text": "the action was denied because if it was an explicit deny or whether there was an",
    "start": "3139829",
    "end": "3145079"
  },
  {
    "text": "act the whether they were allowed right you can find the principal the action the resource the values that they were",
    "start": "3145079",
    "end": "3152010"
  },
  {
    "text": "trying to do and you need to use this little-known API called the decode",
    "start": "3152010",
    "end": "3159859"
  },
  {
    "text": "authorization message and so if you have access or you've been granted access to",
    "start": "3159859",
    "end": "3165210"
  },
  {
    "text": "call that you can go in and decode that message so let's take a look at how we",
    "start": "3165210",
    "end": "3171750"
  },
  {
    "text": "can decode that message and this is going to help us if you were building that policy and this is something that I",
    "start": "3171750",
    "end": "3177180"
  },
  {
    "text": "did as I was going through the building the policy I was decoding the message to figure out what I was doing wrong and so",
    "start": "3177180",
    "end": "3183089"
  },
  {
    "text": "what I'm gonna do is I've already tried to call an ec2 action and I've already captured that to the clip",
    "start": "3183089",
    "end": "3188940"
  },
  {
    "text": "words that I have it and then the only way to decode this is really using the",
    "start": "3188940",
    "end": "3195210"
  },
  {
    "text": "API or the CLI and just got about I don't know why it's got a bunch of like junk around it that you got to remove",
    "start": "3195210",
    "end": "3201630"
  },
  {
    "text": "and so I'll show you how I do that and so I have to do this from the CLI and I",
    "start": "3201630",
    "end": "3208770"
  },
  {
    "text": "created kind of a Windows batch file to do this so the first thing I'll do is I'll show you my ugly one and this is",
    "start": "3208770",
    "end": "3217440"
  },
  {
    "text": "just calling a wcl I have a profile for reinvent it's calling an STS API that's",
    "start": "3217440",
    "end": "3224280"
  },
  {
    "text": "decode authorization message and then you pass in the a coded message which I'll pass through the CLI and then I",
    "start": "3224280",
    "end": "3231869"
  },
  {
    "text": "pipe it out to a text file and then I launch it notepad so let me just show you what this one looks like now it",
    "start": "3231869",
    "end": "3244349"
  },
  {
    "text": "comes out something like this which isn't all that human readable and one of the things you need to know is you'll have to go and delete this and you'll",
    "start": "3244349",
    "end": "3251609"
  },
  {
    "text": "have to go in here and you'll have to delete this and then you'll see it puts a forward slash in front of all this so",
    "start": "3251609",
    "end": "3257790"
  },
  {
    "text": "I don't like having to do that so I've created a more advanced batch file that cleans it all up for me and now you get",
    "start": "3257790",
    "end": "3268980"
  },
  {
    "text": "something like this and I can take this which is better but still not all that",
    "start": "3268980",
    "end": "3274920"
  },
  {
    "text": "human readable and I can drop it into my favorite JSON tool and now I get",
    "start": "3274920",
    "end": "3281849"
  },
  {
    "text": "something that's human readable let me see if I can bump that up a little bit",
    "start": "3281849",
    "end": "3286980"
  },
  {
    "text": "and so here you could see that I wasn't allowed I wasn't explicitly denied but I was",
    "start": "3286980",
    "end": "3296099"
  },
  {
    "text": "still had some failures and if I go through I can see that it was Bob and I can see where he was trying to launch",
    "start": "3296099",
    "end": "3301980"
  },
  {
    "text": "the instance and I can scroll down and then eventually you know to get to the",
    "start": "3301980",
    "end": "3307619"
  },
  {
    "text": "punchline I see that there was a value of M 16 extra large which I knew he",
    "start": "3307619",
    "end": "3313589"
  },
  {
    "text": "shouldn't be able to do but this is where it ends up failing but unless you know how to decode that message you're",
    "start": "3313589",
    "end": "3319109"
  },
  {
    "text": "never going to able to define that information and so",
    "start": "3319109",
    "end": "3324190"
  },
  {
    "text": "with that I want to congratulate you you are all now certified policy ninjas",
    "start": "3324190",
    "end": "3331760"
  },
  {
    "text": "[Applause]",
    "start": "3331760",
    "end": "3339989"
  }
]