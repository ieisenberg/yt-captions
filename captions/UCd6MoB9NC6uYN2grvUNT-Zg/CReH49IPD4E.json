[
  {
    "text": "- Hi, I'm Rob, principal database engineer",
    "start": "1080",
    "end": "3300"
  },
  {
    "text": "for the Babelfish Project at AWS.",
    "start": "3300",
    "end": "6450"
  },
  {
    "text": "In a previous video,",
    "start": "6450",
    "end": "7799"
  },
  {
    "text": "we introduced the Babelfish Compass tool.",
    "start": "7800",
    "end": "10530"
  },
  {
    "text": "In this video, we will be\ntaking a deeper look at Compass,",
    "start": "10530",
    "end": "13860"
  },
  {
    "text": "especially at the more advanced options",
    "start": "13860",
    "end": "16020"
  },
  {
    "text": "for analysis and reporting.",
    "start": "16020",
    "end": "17703"
  },
  {
    "text": "Compass is a standalone\ntool to help determine",
    "start": "20700",
    "end": "23370"
  },
  {
    "text": "whether a SQL server-based application",
    "start": "23370",
    "end": "25620"
  },
  {
    "text": "can be migrated to Babelfish\ndor Aurora Postgres.",
    "start": "25620",
    "end": "28710"
  },
  {
    "text": "Compass performs a detailed analysis",
    "start": "28710",
    "end": "31050"
  },
  {
    "text": "of all SQL features in your application.",
    "start": "31050",
    "end": "33809"
  },
  {
    "text": "It reports all the features found",
    "start": "33810",
    "end": "35520"
  },
  {
    "text": "and classifies them as whether supported",
    "start": "35520",
    "end": "37830"
  },
  {
    "text": "by Babelfish or not.",
    "start": "37830",
    "end": "39600"
  },
  {
    "text": "Based on the Compass report,",
    "start": "39600",
    "end": "41129"
  },
  {
    "text": "you can determine whether a migration",
    "start": "41130",
    "end": "43020"
  },
  {
    "text": "to Babelfish may be feasible,",
    "start": "43020",
    "end": "44580"
  },
  {
    "text": "so running Compass should\nalways be the first step",
    "start": "44580",
    "end": "47430"
  },
  {
    "text": "when considering a migration to Babelfish.",
    "start": "47430",
    "end": "50490"
  },
  {
    "text": "You may want to check\nout the separate video",
    "start": "50490",
    "end": "52440"
  },
  {
    "text": "which is an introduction to Babelfish",
    "start": "52440",
    "end": "54210"
  },
  {
    "text": "and which shows you the basics.",
    "start": "54210",
    "end": "55773"
  },
  {
    "text": "Compass is published as\nopen source at GitHub.",
    "start": "57240",
    "end": "60270"
  },
  {
    "text": "The easiest way to get there",
    "start": "60270",
    "end": "61890"
  },
  {
    "text": "is to do a web search\nfor Babelfish compass.",
    "start": "61890",
    "end": "64979"
  },
  {
    "text": "From GitHub, you can always download",
    "start": "64980",
    "end": "67080"
  },
  {
    "text": "the latest executable version,",
    "start": "67080",
    "end": "68730"
  },
  {
    "text": "as well as the user guide.",
    "start": "68730",
    "end": "70113"
  },
  {
    "text": "Compass is a command-line tool,",
    "start": "71820",
    "end": "73890"
  },
  {
    "text": "so on Windows you have\nto open a command prompt",
    "start": "73890",
    "end": "76590"
  },
  {
    "text": "and run BabelfishCompass.bat\nfrom the command line.",
    "start": "76590",
    "end": "80670"
  },
  {
    "text": "You always have to specify\nthe name of the report first.",
    "start": "80670",
    "end": "83909"
  },
  {
    "text": "Here that is AnyCompany1.",
    "start": "83910",
    "end": "86370"
  },
  {
    "text": "In the simplest case,",
    "start": "86370",
    "end": "87360"
  },
  {
    "text": "you just specify a single\ninput file as shown here.",
    "start": "87360",
    "end": "90813"
  },
  {
    "text": "Compass creates a new directory",
    "start": "91860",
    "end": "93930"
  },
  {
    "text": "under Documents\\Babelfish\\Compass",
    "start": "93930",
    "end": "96210"
  },
  {
    "text": "where it stores the report.",
    "start": "96210",
    "end": "98070"
  },
  {
    "text": "When the report is ready,",
    "start": "98070",
    "end": "99300"
  },
  {
    "text": "it will be opened\nautomatically in your browser",
    "start": "99300",
    "end": "101700"
  },
  {
    "text": "as shown in the other video\nwith an introduction to Compass.",
    "start": "101700",
    "end": "105243"
  },
  {
    "text": "Compass also runs on Mac and on Linux,",
    "start": "106500",
    "end": "109080"
  },
  {
    "text": "so you have to open a new shell",
    "start": "109080",
    "end": "110850"
  },
  {
    "text": "and start BabelfishCompass.sh.",
    "start": "110850",
    "end": "113790"
  },
  {
    "text": "The command-line arguments\nand everything else",
    "start": "113790",
    "end": "116160"
  },
  {
    "text": "are pretty much the same as on Windows.",
    "start": "116160",
    "end": "118650"
  },
  {
    "text": "Note that on Linux,",
    "start": "118650",
    "end": "120180"
  },
  {
    "text": "the report does not automatically\nopened in your browser",
    "start": "120180",
    "end": "122940"
  },
  {
    "text": "so you have to open it manually.",
    "start": "122940",
    "end": "124683"
  },
  {
    "text": "Every report gets its own directory",
    "start": "126300",
    "end": "128127"
  },
  {
    "text": "and you see an example of two reports here",
    "start": "128127",
    "end": "130740"
  },
  {
    "text": "resulting from two earlier Compass runs.",
    "start": "130740",
    "end": "133593"
  },
  {
    "text": "When looking into a report directory,",
    "start": "134940",
    "end": "137070"
  },
  {
    "text": "the first thing we see is\nthe Compass report itself.",
    "start": "137070",
    "end": "139890"
  },
  {
    "text": "That's the .html file.",
    "start": "139890",
    "end": "141930"
  },
  {
    "text": "There is also a copy of the\nreport as a flat text file.",
    "start": "141930",
    "end": "145053"
  },
  {
    "text": "There is also the directory captured.",
    "start": "145920",
    "end": "148080"
  },
  {
    "text": "That directory contains\nthe analysis results",
    "start": "148080",
    "end": "150390"
  },
  {
    "text": "and that is what the Compass\nreport is generated from.",
    "start": "150390",
    "end": "153930"
  },
  {
    "text": "The imported directory contains\nthe original SQL input files",
    "start": "153930",
    "end": "158069"
  },
  {
    "text": "and that is the input to the analysis.",
    "start": "158070",
    "end": "160770"
  },
  {
    "text": "The log directory contains\nthe session log files,",
    "start": "160770",
    "end": "163860"
  },
  {
    "text": "basically what you saw on your screen",
    "start": "163860",
    "end": "165900"
  },
  {
    "text": "when you're in Compass.",
    "start": "165900",
    "end": "167400"
  },
  {
    "text": "Now please do not edit or\nremove or rename these files",
    "start": "167400",
    "end": "170790"
  },
  {
    "text": "because can do things like\ngenerate additional reports",
    "start": "170790",
    "end": "174150"
  },
  {
    "text": "or run more analysis,",
    "start": "174150",
    "end": "175439"
  },
  {
    "text": "but that expects these files to exist.",
    "start": "175440",
    "end": "177483"
  },
  {
    "text": "The name of the Compass report file",
    "start": "178800",
    "end": "180720"
  },
  {
    "text": "always starts with report.",
    "start": "180720",
    "end": "182490"
  },
  {
    "text": "That is followed by the\nreport name that you specified",
    "start": "182490",
    "end": "185280"
  },
  {
    "text": "as the first argument on\nthe Compass command line.",
    "start": "185280",
    "end": "188459"
  },
  {
    "text": "Then comes an indication\nof the Babelfish version",
    "start": "188460",
    "end": "191250"
  },
  {
    "text": "for which the analysis was performed.",
    "start": "191250",
    "end": "193380"
  },
  {
    "text": "Here that is version 2.2.0",
    "start": "193380",
    "end": "196200"
  },
  {
    "text": "and finally, there is the time\nwhen the report was created.",
    "start": "196200",
    "end": "199890"
  },
  {
    "text": "If you want, you can override this",
    "start": "199890",
    "end": "201750"
  },
  {
    "text": "and specify your own file\nname with a report file flag.",
    "start": "201750",
    "end": "205203"
  },
  {
    "text": "Once analysis is done,",
    "start": "206700",
    "end": "208290"
  },
  {
    "text": "you can generate additional reports.",
    "start": "208290",
    "end": "210510"
  },
  {
    "text": "A common reason is to\ngenerate a cross-reference",
    "start": "210510",
    "end": "213150"
  },
  {
    "text": "with links to the SQL code\nfor the reported items",
    "start": "213150",
    "end": "215819"
  },
  {
    "text": "so that you can see",
    "start": "215820",
    "end": "216660"
  },
  {
    "text": "precisely what the original\nsequel code looked like.",
    "start": "216660",
    "end": "220260"
  },
  {
    "text": "To generate a cross-reference,",
    "start": "220260",
    "end": "221760"
  },
  {
    "text": "first specify the report name",
    "start": "221760",
    "end": "223890"
  },
  {
    "text": "and then use the flag reportoption\nspace xref as shown here.",
    "start": "223890",
    "end": "228890"
  },
  {
    "text": "You don't specify an input file again",
    "start": "229080",
    "end": "231150"
  },
  {
    "text": "since the input has already been read",
    "start": "231150",
    "end": "232950"
  },
  {
    "text": "and the analysis has\nalready been performed.",
    "start": "232950",
    "end": "235800"
  },
  {
    "text": "In the report directory you\nnow see the original report",
    "start": "235800",
    "end": "238740"
  },
  {
    "text": "but also the cross-reference\nreport that was just generated.",
    "start": "238740",
    "end": "242580"
  },
  {
    "text": "Note that the cross-reference report",
    "start": "242580",
    "end": "244440"
  },
  {
    "text": "is much bigger than your original one",
    "start": "244440",
    "end": "246690"
  },
  {
    "text": "without the cross-reference",
    "start": "246690",
    "end": "247920"
  },
  {
    "text": "and indeed that is the reason\nwhy the cross-reference",
    "start": "247920",
    "end": "250380"
  },
  {
    "text": "is not generated by default",
    "start": "250380",
    "end": "252120"
  },
  {
    "text": "because such very large HTML files",
    "start": "252120",
    "end": "254400"
  },
  {
    "text": "may sometimes be slow\nto open in your browser.",
    "start": "254400",
    "end": "257103"
  },
  {
    "text": "If you generate a cross-reference,",
    "start": "258120",
    "end": "259859"
  },
  {
    "text": "in fact, you get two cross-references.",
    "start": "259860",
    "end": "262259"
  },
  {
    "text": "They contain the same information,",
    "start": "262260",
    "end": "263970"
  },
  {
    "text": "but they are organized differently.",
    "start": "263970",
    "end": "265920"
  },
  {
    "text": "The first one is ordered by SQL feature",
    "start": "265920",
    "end": "268350"
  },
  {
    "text": "and the second is ordered by SQL object.",
    "start": "268350",
    "end": "271023"
  },
  {
    "text": "Here's what it looks like.",
    "start": "272280",
    "end": "273780"
  },
  {
    "text": "In the first example,",
    "start": "273780",
    "end": "274800"
  },
  {
    "text": "you can see all the places and objects",
    "start": "274800",
    "end": "276509"
  },
  {
    "text": "where a particular feature occurs",
    "start": "276510",
    "end": "278040"
  },
  {
    "text": "as they are listed together.",
    "start": "278040",
    "end": "280020"
  },
  {
    "text": "In the second example\nwhich is grouped by object,",
    "start": "280020",
    "end": "282270"
  },
  {
    "text": "it's easy to see all issues",
    "start": "282270",
    "end": "284340"
  },
  {
    "text": "that apply to a particular object",
    "start": "284340",
    "end": "286380"
  },
  {
    "text": "as they are listed together as shown here.",
    "start": "286380",
    "end": "288480"
  },
  {
    "text": "You can also generate a more\ntargeted cross-reference.",
    "start": "290220",
    "end": "293400"
  },
  {
    "text": "For example, I can\ncreate a cross-reference",
    "start": "293400",
    "end": "295770"
  },
  {
    "text": "for one particular category only",
    "start": "295770",
    "end": "297449"
  },
  {
    "text": "like only the review performance items",
    "start": "297450",
    "end": "300600"
  },
  {
    "text": "or I can even generate a cross-reference",
    "start": "300600",
    "end": "302400"
  },
  {
    "text": "for all supported items.",
    "start": "302400",
    "end": "304500"
  },
  {
    "text": "Now if you do that,",
    "start": "304500",
    "end": "305520"
  },
  {
    "text": "keep in mind that your report",
    "start": "305520",
    "end": "307110"
  },
  {
    "text": "may get very, very large indeed.",
    "start": "307110",
    "end": "309362"
  },
  {
    "text": "As another use case,",
    "start": "310470",
    "end": "311670"
  },
  {
    "text": "let's say I am interested in the details",
    "start": "311670",
    "end": "313770"
  },
  {
    "text": "of all cases of a like operator.",
    "start": "313770",
    "end": "316530"
  },
  {
    "text": "With the option filter equals like,",
    "start": "316530",
    "end": "319020"
  },
  {
    "text": "the cross-references\ngenerated only for items",
    "start": "319020",
    "end": "321840"
  },
  {
    "text": "that contain the string like.",
    "start": "321840",
    "end": "324180"
  },
  {
    "text": "As you can see, various\noptions can be used together",
    "start": "324180",
    "end": "326940"
  },
  {
    "text": "in the report option flag,\nconcatenated by commas.",
    "start": "326940",
    "end": "330390"
  },
  {
    "text": "Just make sure you don't use any spaces",
    "start": "330390",
    "end": "332850"
  },
  {
    "text": "because that will probably\nlead to an error message.",
    "start": "332850",
    "end": "335450"
  },
  {
    "text": "By default, analysis is performed",
    "start": "336300",
    "end": "338520"
  },
  {
    "text": "for the most recent Babelfish release",
    "start": "338520",
    "end": "340889"
  },
  {
    "text": "that your version of Compass supports",
    "start": "340890",
    "end": "343470"
  },
  {
    "text": "and when you download Compass from GitHub,",
    "start": "343470",
    "end": "345480"
  },
  {
    "text": "it will always be updated",
    "start": "345480",
    "end": "347040"
  },
  {
    "text": "for the most recent Babelfish release.",
    "start": "347040",
    "end": "349650"
  },
  {
    "text": "Sometimes you may want to run an analysis",
    "start": "349650",
    "end": "351870"
  },
  {
    "text": "for an older Babelfish version.",
    "start": "351870",
    "end": "354360"
  },
  {
    "text": "I mentioned, for example, you\nhave migrated an application",
    "start": "354360",
    "end": "357449"
  },
  {
    "text": "to Babelfish some time ago.",
    "start": "357450",
    "end": "359520"
  },
  {
    "text": "That application is now running",
    "start": "359520",
    "end": "361110"
  },
  {
    "text": "just fine on a Babelfish instance",
    "start": "361110",
    "end": "363030"
  },
  {
    "text": "that is not the latest\nBabelfish released by now.",
    "start": "363030",
    "end": "366450"
  },
  {
    "text": "Now you want to migrate\nanother application",
    "start": "366450",
    "end": "368520"
  },
  {
    "text": "to that same Babelfish instance.",
    "start": "368520",
    "end": "370979"
  },
  {
    "text": "The question now is how compatible\nis that other application",
    "start": "370980",
    "end": "374640"
  },
  {
    "text": "with that older Babelfish\nversion that I am running?",
    "start": "374640",
    "end": "378210"
  },
  {
    "text": "With the babelfish-version flag,",
    "start": "378210",
    "end": "380460"
  },
  {
    "text": "you can specify an older\nversion of Babelfish",
    "start": "380460",
    "end": "382949"
  },
  {
    "text": "that the analysis should be for.",
    "start": "382950",
    "end": "384843"
  },
  {
    "text": "The file name of the\nreport will also indicate",
    "start": "386010",
    "end": "388530"
  },
  {
    "text": "the version that the\nanalysis was done for.",
    "start": "388530",
    "end": "390903"
  },
  {
    "text": "Okay, now consider this scenario.",
    "start": "393690",
    "end": "396150"
  },
  {
    "text": "You are interested in migrating\nan application to Babelfish,",
    "start": "396150",
    "end": "399120"
  },
  {
    "text": "so you get the latest version of Compass",
    "start": "399120",
    "end": "401160"
  },
  {
    "text": "and you run an analysis.",
    "start": "401160",
    "end": "402870"
  },
  {
    "text": "However the Compass report\nshows that your application",
    "start": "402870",
    "end": "405540"
  },
  {
    "text": "uses various SQL features",
    "start": "405540",
    "end": "407070"
  },
  {
    "text": "that Babelfish currently does not support.",
    "start": "407070",
    "end": "409740"
  },
  {
    "text": "Now you decide to wait until\na newer version of Babelfish",
    "start": "409740",
    "end": "413039"
  },
  {
    "text": "will have support footage\nfeatures that you need.",
    "start": "413040",
    "end": "415350"
  },
  {
    "text": "So after half a year or so,",
    "start": "415350",
    "end": "417360"
  },
  {
    "text": "you get yourself the\nlatest version of Compass",
    "start": "417360",
    "end": "419669"
  },
  {
    "text": "and you want to rerun the analysis",
    "start": "419670",
    "end": "421350"
  },
  {
    "text": "for what is then the most\nrecent Babelfish version.",
    "start": "421350",
    "end": "424293"
  },
  {
    "text": "With analyze, you only\nspecify the report name.",
    "start": "425280",
    "end": "428280"
  },
  {
    "text": "You don't specify any input files.",
    "start": "428280",
    "end": "430680"
  },
  {
    "text": "Compass will then rerun the analysis",
    "start": "430680",
    "end": "433050"
  },
  {
    "text": "for the latest version of\nBabelfish that it supports",
    "start": "433050",
    "end": "435780"
  },
  {
    "text": "on the original input files",
    "start": "435780",
    "end": "437610"
  },
  {
    "text": "of which it still keeps a copy\nin its imported directory.",
    "start": "437610",
    "end": "441449"
  },
  {
    "text": "Based on the Compass\nreport that this produces,",
    "start": "441450",
    "end": "444360"
  },
  {
    "text": "you can then determine whether\nthis is a better moment",
    "start": "444360",
    "end": "446969"
  },
  {
    "text": "to migrate your application to Babelfish.",
    "start": "446970",
    "end": "449223"
  },
  {
    "text": "Babelfish supports many T-SQL\nfeatures, but not everything.",
    "start": "451140",
    "end": "455190"
  },
  {
    "text": "Compass can help you migrate",
    "start": "455190",
    "end": "456870"
  },
  {
    "text": "some of those unsupported features",
    "start": "456870",
    "end": "458669"
  },
  {
    "text": "even though Babelfish itself\ndoes not support them.",
    "start": "458670",
    "end": "461700"
  },
  {
    "text": "This is done by Compass by\nrewriting unsupported features",
    "start": "461700",
    "end": "465420"
  },
  {
    "text": "with SQL code that Babelfish does support.",
    "start": "465420",
    "end": "468180"
  },
  {
    "text": "For this, you have to\nspecify the rewrite flag.",
    "start": "468180",
    "end": "471690"
  },
  {
    "text": "With rewrite for a selected\nnumber of T-SQL features,",
    "start": "471690",
    "end": "475140"
  },
  {
    "text": "Compass will modify the SQL input file",
    "start": "475140",
    "end": "477780"
  },
  {
    "text": "and create a new file with\nthose features rewritten.",
    "start": "477780",
    "end": "480750"
  },
  {
    "text": "Rewriting will only be done\nfor unsupported features.",
    "start": "480750",
    "end": "484110"
  },
  {
    "text": "Once Babelfish adds support,",
    "start": "484110",
    "end": "485879"
  },
  {
    "text": "Compass will no longer rewrite it.",
    "start": "485880",
    "end": "487863"
  },
  {
    "text": "Here are some examples of SQL features",
    "start": "488760",
    "end": "491130"
  },
  {
    "text": "that Compass may be\nable to rewrite for you.",
    "start": "491130",
    "end": "494040"
  },
  {
    "text": "For example, the merge statement",
    "start": "494040",
    "end": "495930"
  },
  {
    "text": "can be rewritten with a\nseries of inserts, updates,",
    "start": "495930",
    "end": "498750"
  },
  {
    "text": "and deletes that together\ngive the same result as merge.",
    "start": "498750",
    "end": "503100"
  },
  {
    "text": "Here you see some actual\nexamples of how Compass",
    "start": "503100",
    "end": "505770"
  },
  {
    "text": "may rewrite certain\nSQL constructs for you.",
    "start": "505770",
    "end": "508500"
  },
  {
    "text": "For example, waitfor delay\nis rewritten as a direct call",
    "start": "508500",
    "end": "512190"
  },
  {
    "text": "to the Postgres procedure, pg_sleep.",
    "start": "512190",
    "end": "514563"
  },
  {
    "text": "When Compass has rewritten a file,",
    "start": "515430",
    "end": "517529"
  },
  {
    "text": "you will see a directory rewritten show up",
    "start": "517530",
    "end": "520169"
  },
  {
    "text": "in the report directory.",
    "start": "520170",
    "end": "521550"
  },
  {
    "text": "Inside the directory is\nthe original SQL file",
    "start": "521550",
    "end": "524399"
  },
  {
    "text": "that has been rewritten,",
    "start": "524400",
    "end": "525450"
  },
  {
    "text": "but now it has rewritten in its name.",
    "start": "525450",
    "end": "528360"
  },
  {
    "text": "It is this file that you need to use",
    "start": "528360",
    "end": "530490"
  },
  {
    "text": "to recreate the DDL in Babelfish.",
    "start": "530490",
    "end": "533102"
  },
  {
    "text": "When you do not specify the rewrite flag,",
    "start": "534090",
    "end": "536580"
  },
  {
    "text": "there will be a section\nin table of contents",
    "start": "536580",
    "end": "538560"
  },
  {
    "text": "in the Compass report that says",
    "start": "538560",
    "end": "540270"
  },
  {
    "text": "Automatic SQL Rewrite Opportunities.",
    "start": "540270",
    "end": "542670"
  },
  {
    "text": "This section will list all\nthe unsupported features",
    "start": "542670",
    "end": "545279"
  },
  {
    "text": "that could have been rewritten",
    "start": "545280",
    "end": "546660"
  },
  {
    "text": "if you had specified the rewrite flag.",
    "start": "546660",
    "end": "549449"
  },
  {
    "text": "With the rewrite flag,",
    "start": "549450",
    "end": "550830"
  },
  {
    "text": "that section disappears\nand instead you get entries",
    "start": "550830",
    "end": "553590"
  },
  {
    "text": "for the rewritten features\nin the summary section,",
    "start": "553590",
    "end": "556200"
  },
  {
    "text": "as well as in the cross-reference section.",
    "start": "556200",
    "end": "558510"
  },
  {
    "text": "So it's a really good idea\nto use the rewrite flag",
    "start": "558510",
    "end": "561390"
  },
  {
    "text": "when there are any rewrite opportunities.",
    "start": "561390",
    "end": "563490"
  },
  {
    "text": "Just keep in mind",
    "start": "563490",
    "end": "564390"
  },
  {
    "text": "that when there are a\nlot of items to rewrite,",
    "start": "564390",
    "end": "566490"
  },
  {
    "text": "Compass may run slower.",
    "start": "566490",
    "end": "568173"
  },
  {
    "text": "Sometimes you just may want to\nthrow away an existing report",
    "start": "570360",
    "end": "573870"
  },
  {
    "text": "before creating it again.",
    "start": "573870",
    "end": "575580"
  },
  {
    "text": "The delete flag will first delete",
    "start": "575580",
    "end": "577380"
  },
  {
    "text": "the entire report directory",
    "start": "577380",
    "end": "579000"
  },
  {
    "text": "before regenerating the\nreport from scratch.",
    "start": "579000",
    "end": "581763"
  },
  {
    "text": "Lastly, as you would expect,",
    "start": "583500",
    "end": "585090"
  },
  {
    "text": "Compass has a help flag that prints out",
    "start": "585090",
    "end": "587130"
  },
  {
    "text": "the various options that can be used.",
    "start": "587130",
    "end": "589320"
  },
  {
    "text": "We have discussed some of\nthese options in this video,",
    "start": "589320",
    "end": "592200"
  },
  {
    "text": "so stay tuned for more videos",
    "start": "592200",
    "end": "594000"
  },
  {
    "text": "where we will discuss the other options.",
    "start": "594000",
    "end": "596310"
  },
  {
    "text": "For now, thank you for watching.",
    "start": "596310",
    "end": "598323"
  }
]