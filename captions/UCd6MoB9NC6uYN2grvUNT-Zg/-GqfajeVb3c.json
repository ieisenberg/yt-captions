[
  {
    "start": "0",
    "end": "15000"
  },
  {
    "text": "all right welcome to dev 333 using Amazon Cloud Watch for Amazon ECS",
    "start": "530",
    "end": "7109"
  },
  {
    "text": "resource monitoring at scale Brenda mcFarland I'm a platform cost engineer at mem Fox so first just gonna",
    "start": "7109",
    "end": "15330"
  },
  {
    "start": "15000",
    "end": "15000"
  },
  {
    "text": "start with the agenda for today giving you a brief introduction to Matt box in case you're not familiar with the",
    "start": "15330",
    "end": "21270"
  },
  {
    "text": "company and what we call platform costs engineering which is a term we we kind of just cooked up I think other people",
    "start": "21270",
    "end": "27539"
  },
  {
    "text": "do similar functions at their companies to though we'll talk through our move from ec2 to ECS it really informs how we",
    "start": "27539",
    "end": "35760"
  },
  {
    "text": "use dcs at Matt box and also why using cloud watch monitor is an interesting",
    "start": "35760",
    "end": "40980"
  },
  {
    "text": "problem for us and we'll talk about ECS and the shared resource problem the shared resource problem being we use",
    "start": "40980",
    "end": "47070"
  },
  {
    "text": "clusters to run multiple applications and multiple teams all in one cluster and how that affects our monitoring",
    "start": "47070",
    "end": "53850"
  },
  {
    "text": "space how we use cloud watch on ECS in general and how we build a solution with",
    "start": "53850",
    "end": "60030"
  },
  {
    "text": "cloud watch to to figure out the be shared resource problem the tasks",
    "start": "60030",
    "end": "65369"
  },
  {
    "text": "running on our cluster and breaking out the street discrete costs and we have",
    "start": "65369",
    "end": "70590"
  },
  {
    "text": "some some results and lessons learned along the way it didn't go perfect and then briefly talk about what's next at at Matt box so",
    "start": "70590",
    "end": "78810"
  },
  {
    "text": "Matt box we're a platform for developers who want to use location in their app so",
    "start": "78810",
    "end": "84360"
  },
  {
    "text": "whether you're you know a mobile developer or web developer if if you have any need for location we've got",
    "start": "84360",
    "end": "90630"
  },
  {
    "text": "api's for you we have SDKs and you can work with Matt box to put in navigation",
    "start": "90630",
    "end": "96060"
  },
  {
    "text": "or Maps or you know geolocation searches so the primary API is at Matt box would",
    "start": "96060",
    "end": "102210"
  },
  {
    "text": "be Maps that's when you think of you know tiles an example would be you know",
    "start": "102210",
    "end": "107220"
  },
  {
    "text": "something as simple as maybe your pizza business and you want to store locator and with Matt box maybe you're a pizza",
    "start": "107220",
    "end": "113130"
  },
  {
    "text": "business that only delivers by water you could take you know all the roads off your map just show water you can change the colors to match your color scheme",
    "start": "113130",
    "end": "119219"
  },
  {
    "text": "you can really do anything you want with our our base layer we open it up to customization by designers or developers",
    "start": "119219",
    "end": "124969"
  },
  {
    "text": "navigation getting from point A to point B which you know is a big deal these",
    "start": "124969",
    "end": "130200"
  },
  {
    "text": "days there's all sorts of ride-sharing is you know getting your deliveries and",
    "start": "130200",
    "end": "135680"
  },
  {
    "text": "search so geolocation if you have an address or you have latitude longitude and you maybe opposite we have an API",
    "start": "135680",
    "end": "143209"
  },
  {
    "text": "for that too some of our big customers The Weather Channel they use this for custom map styles they'll use in mobile",
    "start": "143209",
    "end": "151280"
  },
  {
    "text": "users in web and they'll display on top of it all sorts of styles but you know dopplers and we handle the traffic you",
    "start": "151280",
    "end": "158180"
  },
  {
    "text": "know if a hurricane's coming in and they went there one of our big ones for sure and tableau if you have custom data sets",
    "start": "158180",
    "end": "165470"
  },
  {
    "text": "in tableau and you can bring in your own map box license and do do things like 3d",
    "start": "165470",
    "end": "170630"
  },
  {
    "text": "you know 3d data visualizations if you have population density and you want",
    "start": "170630",
    "end": "175670"
  },
  {
    "text": "something really gripping beyond you know a spreadsheet you can you can use map map box so as we've grown this is",
    "start": "175670",
    "end": "184310"
  },
  {
    "text": "has enabled our other products so we're at the point where we now have live traffic we're in enough mobile apps that",
    "start": "184310",
    "end": "189350"
  },
  {
    "text": "are reporting back to lemon tree that we can tell you where traffic is bad where's good and you can't really do",
    "start": "189350",
    "end": "195800"
  },
  {
    "text": "routing these days without traffic so we also have a traffic API and and that",
    "start": "195800",
    "end": "201140"
  },
  {
    "text": "level of telemetry also keeps our map up-to-date so this is this is telemetry",
    "start": "201140",
    "end": "206570"
  },
  {
    "text": "traces around the Washington DC and if there's road closures or let's say maybe there's a road missing one know pretty",
    "start": "206570",
    "end": "212900"
  },
  {
    "text": "quickly it can be flagged by by having telemetry where we don't think there are roads are not having telemetry where we",
    "start": "212900",
    "end": "218660"
  },
  {
    "text": "usually have lots of it and map box has been on AWS since it started at this point we're at thousands",
    "start": "218660",
    "end": "226130"
  },
  {
    "text": "of customers we're in thousands of mobile applications we have hundreds of millions of daily active users and we",
    "start": "226130",
    "end": "231950"
  },
  {
    "text": "collect over three billion location probes a day 100 million miles of animos Fleming tree every day all this consumes",
    "start": "231950",
    "end": "239180"
  },
  {
    "text": "trillions of compute seconds on Amazon ECS every day and I tell you this not to sell you on map box",
    "start": "239180",
    "end": "244970"
  },
  {
    "text": "although matte box is great if you want to use location like go for it but there's more to set the stage that on ECS we're doing a lot we have you know",
    "start": "244970",
    "end": "252290"
  },
  {
    "text": "all these API is running at the same time we have processing clusters as well and we really lean on e cs4 for our",
    "start": "252290",
    "end": "258620"
  },
  {
    "text": "production workloads so what's platform cost engineering and matte box",
    "start": "258620",
    "end": "264199"
  },
  {
    "start": "264000",
    "end": "264000"
  },
  {
    "text": "platform cost engineering top roll is really cost monitoring and getting information out I think our AWS bill had",
    "start": "264199",
    "end": "271490"
  },
  {
    "text": "like 34 services last month and how much we use each one changes rapidly you know",
    "start": "271490",
    "end": "277190"
  },
  {
    "text": "each service will come out with new products and just keeping tabs and informing back to our stakeholders",
    "start": "277190",
    "end": "282740"
  },
  {
    "text": "what's happening in the u.s. bill and watching for maybe somebody you know turned up a stack for load testing",
    "start": "282740",
    "end": "288530"
  },
  {
    "text": "forgot to turn it back down we want to tell them right away platform cost engineering it's also on the on-call",
    "start": "288530",
    "end": "294110"
  },
  {
    "text": "rotation I think I'm on level 2 right now so hopefully nothing big happens but",
    "start": "294110",
    "end": "299450"
  },
  {
    "text": "where it's just like any other you know site reliability engineer and we found that when our servers are having trouble",
    "start": "299450",
    "end": "305450"
  },
  {
    "text": "if you're getting alarms that's often when you're also spending the most money so and it's it's the high human capital",
    "start": "305450",
    "end": "311720"
  },
  {
    "text": "cost as well if you're really on call you start to learn that tuning down a you know a cluster and then getting five",
    "start": "311720",
    "end": "317300"
  },
  {
    "text": "alarms every day is gonna cost you a lot in on the human side that you might not see if you're just looking at your bill",
    "start": "317300",
    "end": "322610"
  },
  {
    "text": "every week and consulting with stakeholders is important so it's a service team it's a support role like",
    "start": "322610",
    "end": "328940"
  },
  {
    "text": "matte box business is not is not cheap platform matte boxes business is providing like key location API so to",
    "start": "328940",
    "end": "336020"
  },
  {
    "text": "everyone and innovating and advancing is also part of it it's part of the whole platform team they spearheaded these yes",
    "start": "336020",
    "end": "342849"
  },
  {
    "text": "ECS migration and platform is about making sure that our our teams are",
    "start": "342849",
    "end": "348229"
  },
  {
    "text": "pushing the boundaries of how you're using cloud so the principles of cost engineering and forming empowering",
    "start": "348229",
    "end": "353539"
  },
  {
    "text": "stakeholders it's about our product teams it's about you know keeping finance and loop keeping leadership in the loop making sure everyone has the the data",
    "start": "353539",
    "end": "360560"
  },
  {
    "text": "they need to make decisions stewardship a resource usage so it's not just enough to monitor if you notice something is",
    "start": "360560",
    "end": "366500"
  },
  {
    "text": "going on you know going astray you need to take action let people know and don't just say well I know that that API is",
    "start": "366500",
    "end": "373760"
  },
  {
    "text": "running too hot but it's it's not my API like we're watching it and then the term",
    "start": "373760",
    "end": "380180"
  },
  {
    "text": "the x-axis is coming so that's what this complex graph is all about so scale at",
    "start": "380180",
    "end": "387889"
  },
  {
    "text": "map box whenever we're thinking about scale you can put it on these two axes so scale of growth would be along the x",
    "start": "387889",
    "end": "394909"
  },
  {
    "text": "here and scale of of our resource usage would be on the Y so a simple one would be how",
    "start": "394909",
    "end": "401090"
  },
  {
    "text": "many servers you have to serve a certain number of customers and you can go a couple different ways on this graph",
    "start": "401090",
    "end": "406340"
  },
  {
    "text": "maybe you need one server for every customer and you know that's that could",
    "start": "406340",
    "end": "411680"
  },
  {
    "text": "be okay for your business model we try to do two better than that we really try to avoid a situation where you end up",
    "start": "411680",
    "end": "417860"
  },
  {
    "text": "needing more resources as you get further along the scale graph because this will potentially kill your business",
    "start": "417860",
    "end": "423889"
  },
  {
    "start": "419000",
    "end": "419000"
  },
  {
    "text": "essentially so what we're really aiming for is scale where our we're below",
    "start": "423889",
    "end": "430280"
  },
  {
    "text": "linear and as we add you know if we double our customers we really don't want to double our servers we want to",
    "start": "430280",
    "end": "435590"
  },
  {
    "text": "have an infrastructure that responds well to that scale sometimes there's a little investment ahead of time you know",
    "start": "435590",
    "end": "441500"
  },
  {
    "text": "you'll incur cost before you see them back but in the long term if you know the growth is coming and we just assume",
    "start": "441500",
    "end": "447409"
  },
  {
    "text": "it is because if it doesn't come that's a whole another problem and it's not our problem so we're ready for growth at all times",
    "start": "447409",
    "end": "453409"
  },
  {
    "text": "and and we're looking to tap scale at that point so resources could be anything you know could be servers your",
    "start": "453409",
    "end": "459919"
  },
  {
    "text": "engineers your AWS cost how many alarms you're getting because I don't burn out your you know you can",
    "start": "459919",
    "end": "465259"
  },
  {
    "text": "only get so many alarms before you burn out your team and on the scale side you're gonna add customers you know request could double as you on board a",
    "start": "465259",
    "end": "471860"
  },
  {
    "text": "massive customer your product teams are gonna come out with new applications new api's and all that your resources you",
    "start": "471860",
    "end": "478639"
  },
  {
    "text": "want him to stay under linear so that was part of what ACS was about in that",
    "start": "478639",
    "end": "483740"
  },
  {
    "text": "box we were primarily on ec2 and auto scaling groups about a year ago we moved slowly to ecs for our production systems",
    "start": "483740",
    "end": "491259"
  },
  {
    "start": "491000",
    "end": "491000"
  },
  {
    "text": "so why do we move VCS these are some of the more obvious benefits I actually",
    "start": "491259",
    "end": "496550"
  },
  {
    "text": "franca at mat boxes giving a talk on Friday AB solely about ECS benefits that are maybe a little less obvious so you",
    "start": "496550",
    "end": "503060"
  },
  {
    "text": "should check it out if you're very interested in UCS but you get lower costs ideally you get better utilization",
    "start": "503060",
    "end": "509000"
  },
  {
    "text": "you know you can right size your containers easier than you can right size in ec2 it's on spot by default",
    "start": "509000",
    "end": "515000"
  },
  {
    "text": "across our company so our clusters are 100% spot unless there's you know a massive spot market problem we're",
    "start": "515000",
    "end": "521180"
  },
  {
    "text": "running on spot and if our production teams are running on our platform clusters they're on spot by default and",
    "start": "521180",
    "end": "526339"
  },
  {
    "text": "they're running at a low cost and centralized capacity so if you're running out of scaling",
    "start": "526339",
    "end": "531440"
  },
  {
    "text": "groups for every application your capacity starts getting very spread out and you're managing a lot of different",
    "start": "531440",
    "end": "536570"
  },
  {
    "text": "auto scaling groups and you're trying to figure out you know why why did instance towers go up twice as much this month well this happened in this auto scaling",
    "start": "536570",
    "end": "542690"
  },
  {
    "text": "group this happen in this auto scaling group and instead you can move into these clusters it's a little easier to keep tabs on overall what's what's",
    "start": "542690",
    "end": "549050"
  },
  {
    "text": "moving at your company efficient operations so you can separate some infrastructure from code your developers",
    "start": "549050",
    "end": "556070"
  },
  {
    "text": "are worried about you know writing with docker they're writing for containers they're not concerned that well if I'm",
    "start": "556070",
    "end": "561200"
  },
  {
    "text": "writing on on this c3 then I don't have disk initialization so my code needs to be concerned with the ec2 you really you",
    "start": "561200",
    "end": "567740"
  },
  {
    "text": "move that away and you can develop locally it creates uniform infrastructure across the company you",
    "start": "567740",
    "end": "573080"
  },
  {
    "text": "don't have to to develop in a different way on a different product team so teams can communicate a bit better in the code",
    "start": "573080",
    "end": "578360"
  },
  {
    "text": "people are more familiar security and credentialing you have a smaller base of",
    "start": "578360",
    "end": "583640"
  },
  {
    "text": "rolling out security updates so instead of a ton of auto scaling groups if you have a problem you can roll out your update to one cluster and you know",
    "start": "583640",
    "end": "589790"
  },
  {
    "text": "you've got everything and then just the local development environments you get out of using containers so mat box",
    "start": "589790",
    "end": "596510"
  },
  {
    "text": "before ecs our services were in these auto scaling groups you had you know the",
    "start": "596510",
    "end": "601580"
  },
  {
    "text": "map service he knew what instances matched with that our search service wasn't one and directions with another",
    "start": "601580",
    "end": "606740"
  },
  {
    "text": "is our like API examples and post ECS we have one production API cluster it's",
    "start": "606740",
    "end": "612890"
  },
  {
    "text": "it's run across multiple regions but a typical one but be more api's in this but they're all running across this this",
    "start": "612890",
    "end": "619550"
  },
  {
    "text": "mix of instance types the instance types are all spot and we we go for instance",
    "start": "619550",
    "end": "625790"
  },
  {
    "start": "622000",
    "end": "622000"
  },
  {
    "text": "diversity with our spot fleets primarily because we're stability is what we're interested in as opposed to buying just",
    "start": "625790",
    "end": "631850"
  },
  {
    "text": "the cheapest instance at that time so we really try to make sure we have a spread out variety of instances that helps us",
    "start": "631850",
    "end": "638900"
  },
  {
    "text": "if say you are losing a lot of one instance type and you can you know you can seamlessly move over to another",
    "start": "638900",
    "end": "644420"
  },
  {
    "text": "instance pool that really helps you on the stability side when you're using spot your options are you know to have",
    "start": "644420",
    "end": "650930"
  },
  {
    "text": "multiple be in multiple AZ's and multiple instance types so having both of those is key to having a lot of",
    "start": "650930",
    "end": "657380"
  },
  {
    "text": "instance pools to bid in and get stability and know that you're going to have astly you need you also get improved",
    "start": "657380",
    "end": "663650"
  },
  {
    "start": "662000",
    "end": "662000"
  },
  {
    "text": "instance packing so if if you're like Matt box at all you probably have some cpu heavy services and maybe some memory",
    "start": "663650",
    "end": "670190"
  },
  {
    "text": "heavy services and when you combine those on ACS you can get pretty radical savings a recent example for us was we",
    "start": "670190",
    "end": "676280"
  },
  {
    "text": "were on our own caching application and a lot of our api's are more CPU intensive and the caching application",
    "start": "676280",
    "end": "682520"
  },
  {
    "text": "just wants tons of memory so you know our cluster was a little more CPU bound we had a lot of leftover memory when we",
    "start": "682520",
    "end": "689480"
  },
  {
    "text": "migrated this caching service from and he seats you allowed a scaling group onto ECS it was basically the cost went",
    "start": "689480",
    "end": "695210"
  },
  {
    "text": "away I mean it's still consuming resources on ECS but that was memory that we weren't using well yet and when",
    "start": "695210",
    "end": "702500"
  },
  {
    "text": "you're combining CPU and memory you can see see really good utilization so",
    "start": "702500",
    "end": "707990"
  },
  {
    "text": "what's the shared resource problem with ECS like why why is this a problem why is there talk today about using cloud",
    "start": "707990",
    "end": "713300"
  },
  {
    "text": "watch to monitor UCS why can't you know just use the standard metrics so before ECS if you had a Maps instance in an",
    "start": "713300",
    "end": "720920"
  },
  {
    "start": "717000",
    "end": "717000"
  },
  {
    "text": "auto scaling group that was a Maps instance it booted up in this auto scaling group that got tagged API maps",
    "start": "720920",
    "end": "726860"
  },
  {
    "text": "and you could go and look at the bill at the end of the month and you'd be well these instances were all tagged API Maps",
    "start": "726860",
    "end": "732410"
  },
  {
    "text": "looks like Maps was 100 bucks this month and you could go tell the Maps team you could tell your investors you can",
    "start": "732410",
    "end": "737630"
  },
  {
    "text": "calculate margin it's pretty easy after you see us you have a cluster and these",
    "start": "737630",
    "end": "743480"
  },
  {
    "start": "740000",
    "end": "740000"
  },
  {
    "text": "instances are getting tagged to the cluster so the instances spin up and you'll tag them well this is this is our",
    "start": "743480",
    "end": "749300"
  },
  {
    "text": "API cluster instance and on that cluster you're running you're running Maps you're running directions running search",
    "start": "749300",
    "end": "754760"
  },
  {
    "text": "all at the same time you want to put in strict rules on how they're matching together you wanted to kind of organically find their home in this",
    "start": "754760",
    "end": "760760"
  },
  {
    "text": "cluster and anything could be happening on that instance in the same day that instance could run Maps all in the",
    "start": "760760",
    "end": "766640"
  },
  {
    "text": "morning then it could run Maps plus directions and then at night it's only running search and how do you know what the cost",
    "start": "766640",
    "end": "772160"
  },
  {
    "text": "of your applications are at that point so you know the Bill of your cluster because you know well we have these",
    "start": "772160",
    "end": "778010"
  },
  {
    "start": "775000",
    "end": "775000"
  },
  {
    "text": "cluster instances they're all tagged API cluster and we know there's a lot of",
    "start": "778010",
    "end": "783080"
  },
  {
    "text": "stuff running on the cluster but we're not really sure what's what's driving cost and this isn't even really a problem with the tagging I mean you",
    "start": "783080",
    "end": "790040"
  },
  {
    "text": "can't there's no tag you could apply to the to an instance it's getting spun up on this class that would would reflect that it's it",
    "start": "790040",
    "end": "797240"
  },
  {
    "text": "brand maps for 12 hours and then I ran directions for three and then I ran geocoding for seven like you need dynamic tags that sounds like a",
    "start": "797240",
    "end": "803420"
  },
  {
    "text": "disastrous idea so you're still missing part of the picture because tags are cluster-level",
    "start": "803420",
    "end": "809600"
  },
  {
    "text": "you got multiple teams in this cluster and you can't report back to the team so they don't know",
    "start": "809600",
    "end": "814640"
  },
  {
    "text": "hey I ship this change I'm really excited about it I think I've dropped our memory utilization like what are our costs look I'm like and you don't you",
    "start": "814640",
    "end": "822320"
  },
  {
    "text": "don't necessarily know unless unless you put in some extra work so we really needed service and task resource",
    "start": "822320",
    "end": "827630"
  },
  {
    "text": "consumption with an RTC s environment so ec s is great we still love VCS even",
    "start": "827630",
    "end": "832670"
  },
  {
    "text": "though we had this problem it's just a whole different monitoring space and it makes them previously basic questions a",
    "start": "832670",
    "end": "839750"
  },
  {
    "text": "little harder so basic question maybe finance comes to you and says hey how much was Maps this month we want to put",
    "start": "839750",
    "end": "845360"
  },
  {
    "text": "in the board report it's gonna you're gonna have to do some work to get to that answer so there were kind of two",
    "start": "845360",
    "end": "852650"
  },
  {
    "text": "ways you go at this point it's like one why don't you just create the same monitoring environment that you had",
    "start": "852650",
    "end": "857780"
  },
  {
    "text": "before and auto-scaling groups so just do one cluster for one service and one cluster for one team and that doesn't",
    "start": "857780",
    "end": "864650"
  },
  {
    "text": "sound like a great idea because you're gonna be adding tons of clusters you're losing a lot of the benefits of VCS it's",
    "start": "864650",
    "end": "869750"
  },
  {
    "text": "not it's not the the scaling you're looking for so instead you can build a",
    "start": "869750",
    "end": "875870"
  },
  {
    "text": "cloud watch system build a pipeline to track this resource consumption you only have to build a once it'll work for all",
    "start": "875870",
    "end": "881750"
  },
  {
    "text": "your clusters and your and you're not splitting everything up and you can really see the benefits of ecs this way",
    "start": "881750",
    "end": "888220"
  },
  {
    "text": "so easy S Plus cloud watch out of the box with with cloud watch you'll get get",
    "start": "888220",
    "end": "895460"
  },
  {
    "start": "892000",
    "end": "892000"
  },
  {
    "text": "a few ECS metrics which are really important at the cluster level you'll get your resource consumption you get",
    "start": "895460",
    "end": "900770"
  },
  {
    "text": "CPU utilization CPU reservation so reservation is what the tasks are saying they need utilization is reflecting what",
    "start": "900770",
    "end": "907400"
  },
  {
    "text": "the tasks are actually using if you're starting your your tasks with services if they're managed by services you also",
    "start": "907400",
    "end": "913490"
  },
  {
    "text": "get it at the service level and mat box we have sort of hybrid environment most of the api's are started by services a",
    "start": "913490",
    "end": "919790"
  },
  {
    "text": "lot of the data processing is more of like a NS qsq and they're being started by their own tasks API so you're not",
    "start": "919790",
    "end": "925820"
  },
  {
    "text": "going to have this man for them so we also put in a lot of custom metrics to help map box figure",
    "start": "925820",
    "end": "932029"
  },
  {
    "start": "930000",
    "end": "930000"
  },
  {
    "text": "out what's happening on ACS at the moment I think we're at 31 I put a star because people are always kind of",
    "start": "932029",
    "end": "937730"
  },
  {
    "text": "spinning up a new metric some examples of custom metrics we use ECS agent connected percent the ECS agent will",
    "start": "937730",
    "end": "945139"
  },
  {
    "text": "occasionally disconnect from from instances on your cluster this is okay at a small at a small level but if a lot",
    "start": "945139",
    "end": "952190"
  },
  {
    "text": "of of agents are disconnecting you're gonna want to want to know so that's that's an example of an alarm we set up",
    "start": "952190",
    "end": "957860"
  },
  {
    "text": "these custom metrics and we'll alarm on some of them failed task placements if people are asking for space on your cluster and they're not getting space",
    "start": "957860",
    "end": "964610"
  },
  {
    "text": "you're gonna want to know before your product teams and and have the cluster respond to it active instance count spot termination",
    "start": "964610",
    "end": "972230"
  },
  {
    "text": "those kind of things are very important for us as we're running on spot fleet we want to know what type instances are running we want to know how many and it",
    "start": "972230",
    "end": "978620"
  },
  {
    "text": "can sometimes diagnose like oh we have a spot outage that's why there was just blip and services and they were all just moving over to to a new instance pool so",
    "start": "978620",
    "end": "986329"
  },
  {
    "text": "that's a lot of metrics how do we like we have a lot of clusters still because",
    "start": "986329",
    "end": "991759"
  },
  {
    "text": "we're running in many regions like how do you keep track of all these metrics we use dashboards so AWS cloud formation",
    "start": "991759",
    "end": "999680"
  },
  {
    "start": "997000",
    "end": "997000"
  },
  {
    "text": "will let you set up a cloud watch dashboard for each cluster and it's it's",
    "start": "999680",
    "end": "1005110"
  },
  {
    "text": "really helpful it's been super helpful for me whatever I'm trying to diagnose anything that we did this because",
    "start": "1005110",
    "end": "1010480"
  },
  {
    "text": "whenever a cluster is spun up you get a default dashboard that spins up to based on the code we have in our cloud",
    "start": "1010480",
    "end": "1016300"
  },
  {
    "text": "formation templates so I put a little code snippet here the CF references you can also check out Matt box cloud friend",
    "start": "1016300",
    "end": "1022779"
  },
  {
    "text": "which is an open source module that makes writing cloud formation a little easier you can use it in JavaScript you",
    "start": "1022779",
    "end": "1028928"
  },
  {
    "text": "don't have to write massive JSON files so generally dashboard is going to be a",
    "start": "1028929",
    "end": "1035199"
  },
  {
    "start": "1035000",
    "end": "1035000"
  },
  {
    "text": "lot of widgets so this is an example of like the default metrics showing up on a",
    "start": "1035199",
    "end": "1040688"
  },
  {
    "text": "widget so CPU reservation memory reservation and a code snippet of the",
    "start": "1040689",
    "end": "1046329"
  },
  {
    "text": "actual widget that's the snippet that's resulting in that graph so on our dashboard we have this graph for every",
    "start": "1046329",
    "end": "1052090"
  },
  {
    "text": "cluster and you can navigate through the console look at all your clusters we also show a lot of the custom metrics",
    "start": "1052090",
    "end": "1057400"
  },
  {
    "text": "you know we have instance type there we have some scaling up and scaling down rolls so these dashboards are great and",
    "start": "1057400",
    "end": "1063730"
  },
  {
    "text": "they give us a great picture of what's happening on ACS but we're still not there to this this like Maps resource",
    "start": "1063730",
    "end": "1070480"
  },
  {
    "start": "1067000",
    "end": "1067000"
  },
  {
    "text": "consumption problem how much did maps cost some reasons why we're not there yet we have 10 plus",
    "start": "1070480",
    "end": "1075610"
  },
  {
    "text": "clusters we have 10 plus ba fleet mixes their different task profiles are running on all these clusters services",
    "start": "1075610",
    "end": "1081970"
  },
  {
    "text": "and run tasks so you got a lot of variables but we at this point we knew the data we needed to collect to to",
    "start": "1081970",
    "end": "1089110"
  },
  {
    "text": "figure this out so you want to know how long your tasks are running on the cluster if you know how long they're",
    "start": "1089110",
    "end": "1094990"
  },
  {
    "text": "running you get a duration at that point you also have a task reservation what they were asking for so that's the",
    "start": "1094990",
    "end": "1100929"
  },
  {
    "text": "resources and you can figure out the cost of your cluster you're still getting those instances tagged to the",
    "start": "1100929",
    "end": "1106210"
  },
  {
    "text": "cluster and you'll get your your bill whatever you're using if you're using a you know a cloud ability or a cloud checker or if you're looking at the cost",
    "start": "1106210",
    "end": "1112750"
  },
  {
    "text": "Explorer or DBR on your own either way you can pull out the tagged cluster cost so if you determine how long the task",
    "start": "1112750",
    "end": "1118419"
  },
  {
    "text": "grant how much memory CPU you can include disk that's that's like a whole nother conversation on how how you",
    "start": "1118419",
    "end": "1124360"
  },
  {
    "text": "should actually cost the task when there's you know disk CPU memory and network all on this cluster for this",
    "start": "1124360",
    "end": "1129820"
  },
  {
    "text": "talk we're just talking about memory and CPU anyway so if you have resources and duration and the cost of the cluster you",
    "start": "1129820",
    "end": "1136419"
  },
  {
    "text": "can get to that task sort of allocated percentage cost so the hardest part was",
    "start": "1136419",
    "end": "1142210"
  },
  {
    "text": "recording task duration and this is our first attempt at it we relied on cloud",
    "start": "1142210",
    "end": "1147669"
  },
  {
    "text": "watch event rules which is whenever a task is starting or stopping or having some state change you can write a cloud",
    "start": "1147669",
    "end": "1153760"
  },
  {
    "text": "watch event rule to record that so it's all kicked off by cloud watching that rules we sent them to Panisse is",
    "start": "1153760",
    "end": "1160269"
  },
  {
    "text": "firehose which will collect a bunch of them prevent your s3 from getting hammered by all these these tiny put",
    "start": "1160269",
    "end": "1165850"
  },
  {
    "text": "objects it goes to s3 we wrote a lambda after that to you know pick up this this",
    "start": "1165850",
    "end": "1171909"
  },
  {
    "text": "firehose object do some some ETL work on it drop it back on s3 and then use the",
    "start": "1171909",
    "end": "1177760"
  },
  {
    "text": "amazon athena to query off s3 if you set up a table definition it's sort of a quickest way to really get a database up",
    "start": "1177760",
    "end": "1186100"
  },
  {
    "text": "and running so this was our first attempt and we ran into some problems with it so our infrastructure",
    "start": "1186100",
    "end": "1192659"
  },
  {
    "start": "1190000",
    "end": "1190000"
  },
  {
    "text": "is running in I think seven ACS regions right now and Kinesis firehose is not",
    "start": "1192659",
    "end": "1197820"
  },
  {
    "text": "supported in every CS region so we have this situation where we wanted a firehose in every CS Region and we just",
    "start": "1197820",
    "end": "1203849"
  },
  {
    "text": "couldn't do it and then we also noticed the volume start and stop events when",
    "start": "1203849",
    "end": "1209070"
  },
  {
    "text": "you're running thousands of tasks particularly on processing you know you're invoking a lot of lambdas there",
    "start": "1209070",
    "end": "1214320"
  },
  {
    "text": "you got a lot of fire hoses started to worry about about the costs so take two",
    "start": "1214320",
    "end": "1219989"
  },
  {
    "text": "we build a sort of split off the task start and stop event the CloudWatch event rule and the lamda deployed them",
    "start": "1219989",
    "end": "1226799"
  },
  {
    "text": "to every ECS region even ones we're not running in yet just in case somebody spins up a cluster we don't know about",
    "start": "1226799",
    "end": "1232229"
  },
  {
    "text": "it we want to be recording already and connected them to a global fire hose so that fire hose is in u.s. East one it",
    "start": "1232229",
    "end": "1238919"
  },
  {
    "text": "takes events from around the world all our ACS regions and writes them to s3 because we had this lambda earlier on we",
    "start": "1238919",
    "end": "1246749"
  },
  {
    "text": "don't need to do any ETL work after it sends it to the firehose in a format that that is readable by if you know",
    "start": "1246749",
    "end": "1252960"
  },
  {
    "text": "once it gets written to s3 so we can see our start and stop events as they're happening with Athena so we had duration",
    "start": "1252960",
    "end": "1260820"
  },
  {
    "text": "we had to start and stop events at this point resources reserved is not too",
    "start": "1260820",
    "end": "1266220"
  },
  {
    "start": "1262000",
    "end": "1262000"
  },
  {
    "text": "complicated there's again you can set up a cloud watch event rule to record whenever a task definition is created",
    "start": "1266220",
    "end": "1271739"
  },
  {
    "text": "that task definition will have your CPU it'll have your memory if you have which",
    "start": "1271739",
    "end": "1278340"
  },
  {
    "text": "is what you need for for this this like an initial resource calculation you can't tag task definitions yet so we",
    "start": "1278340",
    "end": "1285599"
  },
  {
    "text": "just build a little module that we put in all our code when people are writing task definitions to to format their the",
    "start": "1285599",
    "end": "1290970"
  },
  {
    "text": "names for their services for them so we know our services are coming across right now named as you know service team",
    "start": "1290970",
    "end": "1297299"
  },
  {
    "text": "cost category and then a suffix if they they wanted to have additional information in their task definition so",
    "start": "1297299",
    "end": "1303989"
  },
  {
    "text": "that was our resource usage pipeline the cost pipeline we're just doing a simple when there's a bucket notification an",
    "start": "1303989",
    "end": "1309899"
  },
  {
    "text": "ACS task a bucket notification from when the bill drops on s3 an ACS task picks",
    "start": "1309899",
    "end": "1315179"
  },
  {
    "text": "it up partitions is out across s3 and then we can create on Athena pretty rapidly so we had we had duration we had",
    "start": "1315179",
    "end": "1321720"
  },
  {
    "text": "resources reserve then we had tasks at that point we can get to the task resource because we have the cost but at this",
    "start": "1321720",
    "end": "1328419"
  },
  {
    "start": "1327000",
    "end": "1327000"
  },
  {
    "text": "point kind of taken a pause because there's some limitations first off we realize like how much is this entire",
    "start": "1328419",
    "end": "1334570"
  },
  {
    "text": "pipeline about to cost us like how much are we spending just to figure out our spending and we had a lot of task volume",
    "start": "1334570",
    "end": "1342100"
  },
  {
    "text": "which was the big part of it and then we're using Athena it's a new service and there's some strategies you really",
    "start": "1342100",
    "end": "1347740"
  },
  {
    "text": "want to use on Athena to make sure you keep your costs down the social impacts of the information you're also getting",
    "start": "1347740",
    "end": "1353140"
  },
  {
    "text": "this this data out to teams maybe at a level they didn't even have the full of the auto scaling groups because you're excited about the information you're",
    "start": "1353140",
    "end": "1358450"
  },
  {
    "text": "gonna say hey like guess what that new like directions task just cost us five thousand dollars yesterday like getting",
    "start": "1358450",
    "end": "1364240"
  },
  {
    "text": "that information out you want to make sure that you're explaining why because you don't want to change the behavior of your engineering team without sort of",
    "start": "1364240",
    "end": "1370659"
  },
  {
    "text": "thinking about it like there's definitely a social aspect to this and then there's a extremely high cost if you send this information out and it",
    "start": "1370659",
    "end": "1376779"
  },
  {
    "text": "turns out it's wrong like you do not want faulty information this pipeline and there were a lot of moving pieces that we just showed so just starting",
    "start": "1376779",
    "end": "1383890"
  },
  {
    "text": "with the massive task volume one of our engineers actually Brian Clark they'll built this little tool to let you play",
    "start": "1383890",
    "end": "1391390"
  },
  {
    "text": "around with ECS of a cloud watch events sorry so with the the cloud watch events",
    "start": "1391390",
    "end": "1397539"
  },
  {
    "text": "you can set up in this case like a temporary rule over here and then start listening and you'll get a bunch of",
    "start": "1397539",
    "end": "1403830"
  },
  {
    "text": "accomplishments Jonah so this is really helpful you want to filter your ECS task",
    "start": "1403830",
    "end": "1408880"
  },
  {
    "text": "state changes you only want to get the ones like you don't want to record duplicates you only want to get start and stops and particularly we were",
    "start": "1408880",
    "end": "1416200"
  },
  {
    "text": "recording at one point ec2 events and if you record ec2 state change events",
    "start": "1416200",
    "end": "1422529"
  },
  {
    "text": "you'll also record every time a task like comes off and on the container as a part as opposed to just when it starts",
    "start": "1422529",
    "end": "1427539"
  },
  {
    "text": "and stops so there's some gotchas in the events and you just wanna make sure you're only recording what you need",
    "start": "1427539",
    "end": "1432700"
  },
  {
    "text": "especially if you have high task for you then there's the athena side so we set up this this sort of data warehouse on",
    "start": "1432700",
    "end": "1439240"
  },
  {
    "start": "1435000",
    "end": "1435000"
  },
  {
    "text": "s3 your first part is s3 costs which should be pretty low even with with",
    "start": "1439240",
    "end": "1445090"
  },
  {
    "text": "writing all this data our s3 costs are super minimal in this the Athena costs can be a bit more so Athena you are",
    "start": "1445090",
    "end": "1451690"
  },
  {
    "text": "charged on how much you query so I think it's five dollars a terabyte so the keys",
    "start": "1451690",
    "end": "1457230"
  },
  {
    "text": "around Athena you really want to partition your data that means spreading it out into multiple subdirectories we",
    "start": "1457230",
    "end": "1462900"
  },
  {
    "text": "we just did by date and time which works well in this recording system because everything is sort of based around",
    "start": "1462900",
    "end": "1468390"
  },
  {
    "text": "duration and time in the first place so you really know around what what time you're gonna want to be querying and",
    "start": "1468390",
    "end": "1473580"
  },
  {
    "text": "then compression make sure you're writing compressed files and there's sort of education on anyone who might be",
    "start": "1473580",
    "end": "1478770"
  },
  {
    "text": "querying this so we build a little slack pot when we first started spinning up Athena that if someone runs a",
    "start": "1478770",
    "end": "1485280"
  },
  {
    "text": "particularly large query it will tell everyone like hey a massive query just finished which is sometimes fine but it",
    "start": "1485280",
    "end": "1491429"
  },
  {
    "text": "also gets people realizing like hey pushing that button if you're querying our whole s3 bucket you could spend a lot of money really fast so you just",
    "start": "1491429",
    "end": "1498480"
  },
  {
    "text": "want to keep tabs on what's happening on Athena and then the social part of it so",
    "start": "1498480",
    "end": "1503820"
  },
  {
    "start": "1502000",
    "end": "1502000"
  },
  {
    "text": "you you wanna make sure you're empowering your teams and not punishing them when you're when you're spreading out data like this big numbers initially",
    "start": "1503820",
    "end": "1509580"
  },
  {
    "text": "can be scary you want your engineering team still trying to innovate you don't want them afraid of using resources you're trying to get them get them",
    "start": "1509580",
    "end": "1516570"
  },
  {
    "text": "active and so for us it's important to stress that the idea here is to create",
    "start": "1516570",
    "end": "1521610"
  },
  {
    "text": "like a healthy system of monitoring from your monitoring you want to learn from",
    "start": "1521610",
    "end": "1527309"
  },
  {
    "text": "it so you want to say oh I just found out that like Maps uses half our cluster like what does that tell me you also",
    "start": "1527309",
    "end": "1534059"
  },
  {
    "text": "want to say like I just noticed that maybe Direction spike last week you can go talk to directions about what changed",
    "start": "1534059",
    "end": "1540390"
  },
  {
    "text": "like maybe their new change they didn't realize was resource intensive it's also great where you can get a victory back",
    "start": "1540390",
    "end": "1546059"
  },
  {
    "text": "to team so if they've done something that they think will make their service scale better or run better if you report back yeah your request",
    "start": "1546059",
    "end": "1551460"
  },
  {
    "text": "went up you know double and your cost inin at all like great job so first part is monitoring learning from it and then",
    "start": "1551460",
    "end": "1558270"
  },
  {
    "text": "taking action and then going right back to monitoring it's just a cycle that essentially will never never stop around",
    "start": "1558270",
    "end": "1564330"
  },
  {
    "text": "the high cost of faulty information alarms are important you want to know if all of a sudden you're missing events",
    "start": "1564330",
    "end": "1569970"
  },
  {
    "text": "like if you're missing start and stop events you can have tasks that appear to be running forever because you missed",
    "start": "1569970",
    "end": "1575100"
  },
  {
    "text": "the stop events so different one alarms on there's also some some ETL queries that are you know running everything",
    "start": "1575100",
    "end": "1582179"
  },
  {
    "text": "that's actually matching these start and stop events for each task so you want to make sure that those run properly every day",
    "start": "1582179",
    "end": "1587950"
  },
  {
    "text": "and you want to know before maybe your costs your automated cost reporting that posts every week posts erroneous data",
    "start": "1587950",
    "end": "1594880"
  },
  {
    "text": "because it's missing a day so you want to get alarms if anything breaks here essentially they don't need to wake you",
    "start": "1594880",
    "end": "1600310"
  },
  {
    "text": "up but you'll probably wanna get an email or have it in a slack Channel and so you can be able to fix it before you",
    "start": "1600310",
    "end": "1605680"
  },
  {
    "text": "send anything out there might be it's faulty to stakeholders so that's just making sure you're regularly checking in because you're probably not gonna log in",
    "start": "1605680",
    "end": "1613510"
  },
  {
    "text": "and check to see how your like your data your start and stop event query ran like",
    "start": "1613510",
    "end": "1619930"
  },
  {
    "text": "each day you want to know that it failed without having to log in and check so results format box we got to to be the",
    "start": "1619930",
    "end": "1628210"
  },
  {
    "start": "1624000",
    "end": "1624000"
  },
  {
    "text": "costume container that we wanted we had task level detail within our clusters you can tell how much geocoding or how",
    "start": "1628210",
    "end": "1634900"
  },
  {
    "text": "much navigation or any or any one of the other services is using overall on the cluster and we you also get a queryable",
    "start": "1634900",
    "end": "1641410"
  },
  {
    "text": "start and stop event database out of this which which can end up being pretty useful for debugging and just various",
    "start": "1641410",
    "end": "1647200"
  },
  {
    "text": "things if you know an instance on your cluster had a lot of trouble and you want to know what was running on it then you can you know pull up a quick query",
    "start": "1647200",
    "end": "1653050"
  },
  {
    "text": "to see see what tasks were on it for that hour that minute or when it was having an issue and that might give you",
    "start": "1653050",
    "end": "1659140"
  },
  {
    "text": "a suspect list if you if you don't have anything to go on so around the costing containers how it works",
    "start": "1659140",
    "end": "1664570"
  },
  {
    "text": "you'll know like container why you have the start and stop event you have the duration it ran for 112 seconds on say",
    "start": "1664570",
    "end": "1670360"
  },
  {
    "text": "cluster Z container Y reserves a certain amount of CPU memory here we did 1024",
    "start": "1670360",
    "end": "1675870"
  },
  {
    "text": "you can assign a cost to to those resources so in this case I'm just",
    "start": "1675870",
    "end": "1681580"
  },
  {
    "text": "showing an only CPU example we actually combine CPU and memory when we're figuring out the cost of a task but",
    "start": "1681580",
    "end": "1688960"
  },
  {
    "text": "you'll know on on cluster Z let's say it had you know 10,000 CPU seconds over",
    "start": "1688960",
    "end": "1694360"
  },
  {
    "text": "today and the cluster cost you $1 you'll know how much that CPU seconds from there cost from there you can multiply",
    "start": "1694360",
    "end": "1699790"
  },
  {
    "text": "it by by that container reservation and you'll get a final cost for that container I'll say if you're a CPU",
    "start": "1699790",
    "end": "1705730"
  },
  {
    "text": "seconds cost that much that's that's a real problem they're usually like way into the scientific notation so you're",
    "start": "1705730",
    "end": "1711730"
  },
  {
    "text": "dealing with very small numbers but as you roll them up you start to really see the picture of your overall services so",
    "start": "1711730",
    "end": "1718570"
  },
  {
    "start": "1718000",
    "end": "1718000"
  },
  {
    "text": "how do we report these back cloud watch is another part of this so",
    "start": "1718570",
    "end": "1724499"
  },
  {
    "text": "we have a scheduled lamda that runs at the inter queries and we'll write sort of the higher-level cost numbers to",
    "start": "1724499",
    "end": "1729929"
  },
  {
    "text": "cloud watch so teams can see maybe they have an application dashboard where they're watching like maps utilization",
    "start": "1729929",
    "end": "1735299"
  },
  {
    "text": "and just services and their deployment in general you can you can throw the cost of maps right on that dashboard if",
    "start": "1735299",
    "end": "1741119"
  },
  {
    "text": "you want so that we have a picture here which is just the V overall teams over",
    "start": "1741119",
    "end": "1748769"
  },
  {
    "text": "over a couple days I always like when graphs go this way in cost be kind of looking for the opposite an example of",
    "start": "1748769",
    "end": "1755580"
  },
  {
    "text": "an API directions change so they push to change and a couple days later you see the cost has actually gone down we",
    "start": "1755580",
    "end": "1762269"
  },
  {
    "text": "quickly realized oh you don't want to log every every detail you're getting back from this pipeline in the cloud",
    "start": "1762269",
    "end": "1767369"
  },
  {
    "text": "watch because you'll be spending a lot on cloud watch at that point if you're if you're doing every tasks specific",
    "start": "1767369",
    "end": "1772950"
  },
  {
    "text": "cost a probably no one's gonna look at this information generally you don't really care what one task cost you care",
    "start": "1772950",
    "end": "1778979"
  },
  {
    "text": "let's say you know that you care what what the rolled up so every task that was was a Maps task you want that rolled",
    "start": "1778979",
    "end": "1784950"
  },
  {
    "text": "up so you want to know you want to write the rolled up amount you're not looking to write a single task amount there so",
    "start": "1784950",
    "end": "1790889"
  },
  {
    "text": "not not every detail is logged a cloud watch but it's all queryable with Athena so some of the other reports we use it",
    "start": "1790889",
    "end": "1798499"
  },
  {
    "start": "1796000",
    "end": "1796000"
  },
  {
    "text": "that aren't cloud Watchers shown here because we can roll up the cluster by task or by service or my team or about a",
    "start": "1798499",
    "end": "1806070"
  },
  {
    "text": "task a caste category there's there's a lot of different ways you can slice this so on processing production there's just",
    "start": "1806070",
    "end": "1813179"
  },
  {
    "text": "an example it's small to see but each of these colors is a team so you could say you can look at each cluster and say",
    "start": "1813179",
    "end": "1818609"
  },
  {
    "text": "this is what's driving what team is driving cost on on this particular cluster and let's say maybe it was that",
    "start": "1818609",
    "end": "1824039"
  },
  {
    "text": "a team that was driving it you can then pull out the services or tag to that data team and you know there's there's a",
    "start": "1824039",
    "end": "1830399"
  },
  {
    "text": "likely culprit here in this orange line if they're looking to know what is what has changed in their services so there's",
    "start": "1830399",
    "end": "1835769"
  },
  {
    "text": "a lot of different ways to slice these reports when you have by task by service by team and by cost category so some of",
    "start": "1835769",
    "end": "1844109"
  },
  {
    "start": "1843000",
    "end": "1843000"
  },
  {
    "text": "the immediate benefits for map box we could answer the how much did my application cost this month which made",
    "start": "1844109",
    "end": "1850259"
  },
  {
    "text": "our finance team very happy and also made our engineering teams because you really want to know what the bottom line impact of your work is it",
    "start": "1850259",
    "end": "1858210"
  },
  {
    "text": "also helped us answer some questions like why is the ec2 bill more expensive so instead of just saying well I know",
    "start": "1858210",
    "end": "1864299"
  },
  {
    "text": "this cluster cost more you can actually diagnose why that cluster cost more like what was using more capacity what needed",
    "start": "1864299",
    "end": "1871110"
  },
  {
    "text": "more CPU and memory and what changed from this month to last month other than those top level numbers we actually send",
    "start": "1871110",
    "end": "1877620"
  },
  {
    "text": "now usage bills out to our stakeholder teams on ECS so every week you know the",
    "start": "1877620",
    "end": "1882960"
  },
  {
    "text": "satellite team will get a list of the services how much CPU and memory they each used and then what that translates",
    "start": "1882960",
    "end": "1889140"
  },
  {
    "text": "to in cost which is helpful because you know we'll have cost fluctuations that are based on the spot market and there's",
    "start": "1889140",
    "end": "1895020"
  },
  {
    "text": "nothing a team can do about it and then there's also cost fluctuations that are based on resources so it's helpful to",
    "start": "1895020",
    "end": "1900360"
  },
  {
    "text": "expose both to teams so they know oh and you know I pushed the change that's that's using more CPU or oh the spot",
    "start": "1900360",
    "end": "1907710"
  },
  {
    "text": "market was bad I shouldn't really worry about this cost change yet but it's still helpful for them to know that you",
    "start": "1907710",
    "end": "1912900"
  },
  {
    "text": "know we're dealing with this variability and our clusters are still organized for",
    "start": "1912900",
    "end": "1918120"
  },
  {
    "text": "engineering so we still have an API cluster we still have a processing cluster we haven't had to make any moves",
    "start": "1918120",
    "end": "1923159"
  },
  {
    "text": "where we're putting maps solely on a Maps cluster so we can easily report back what maps is doing instead we can",
    "start": "1923159",
    "end": "1929700"
  },
  {
    "text": "run these things together we can run our caching service with them and we can reap the engineering benefits of VCs at",
    "start": "1929700",
    "end": "1935640"
  },
  {
    "text": "their fullest so we also found it put a focus on right sizing for our teams so",
    "start": "1935640",
    "end": "1940799"
  },
  {
    "start": "1937000",
    "end": "1937000"
  },
  {
    "text": "when you start getting charged on your task reservation you might take a second look at what you're reserving if you're",
    "start": "1940799",
    "end": "1947250"
  },
  {
    "text": "reserving more more memory than you need you can pretty quickly change your reservation a different cost will be",
    "start": "1947250",
    "end": "1954090"
  },
  {
    "text": "calculated for you and our cluster will run more efficiently because we don't have tasks over reserving unluckily we",
    "start": "1954090",
    "end": "1960690"
  },
  {
    "text": "haven't run into anyone just you know setting reservations way too low and breaking our cluster everyone at map box",
    "start": "1960690",
    "end": "1966270"
  },
  {
    "text": "is a is a positive player but we have built some tools that make it easy to",
    "start": "1966270",
    "end": "1971490"
  },
  {
    "text": "query utilization first the the reservation on ECS so we can compare this and inform teams that hey maybe",
    "start": "1971490",
    "end": "1978659"
  },
  {
    "text": "you're over reserved maybe you're under reserve but it put a little more focus back on right sizing of a task",
    "start": "1978659",
    "end": "1985659"
  },
  {
    "text": "some of the a little more unexpected was was the debugging benefits of this so uh Niecy s when tasks are looking to be",
    "start": "1985659",
    "end": "1994000"
  },
  {
    "text": "placed one of the one of the things can happen is a failed task placement and it's not always clear maybe your cluster",
    "start": "1994000",
    "end": "2000360"
  },
  {
    "text": "is only 60 percent reserved and you don't know why this task is failing to place we we were actually able to replay",
    "start": "2000360",
    "end": "2007470"
  },
  {
    "text": "start and stop events on a specific instance and if you know this instance is failing tasks why you know you're",
    "start": "2007470",
    "end": "2014190"
  },
  {
    "text": "looking back later you can say you can look and say well this instance was running these twelve tasks and then maybe four tasks tried to place and it",
    "start": "2014190",
    "end": "2021149"
  },
  {
    "text": "turns out that was more than could fit so it's helped us to to work with the the ECS task scheduler and sort of play",
    "start": "2021149",
    "end": "2029039"
  },
  {
    "text": "around with with the scale there and debugging instance events so separate",
    "start": "2029039",
    "end": "2034559"
  },
  {
    "text": "from the task placement you also could have a situation where maybe a task is really hammering one of the resources that isn't as well tracked about your",
    "start": "2034559",
    "end": "2040380"
  },
  {
    "text": "metrics so let's say disk utilization and we know that the disk utilization of",
    "start": "2040380",
    "end": "2046230"
  },
  {
    "text": "box is going up to a hundred percent and then all of a sudden it drops off when some tasks stopped it's really great to",
    "start": "2046230",
    "end": "2051720"
  },
  {
    "text": "be able to look back at those couple seconds and see what tasks stopped because that's that's a pretty quick",
    "start": "2051720",
    "end": "2057079"
  },
  {
    "text": "indication of potentially the task that is causing your disk utilization problem so we've done that a couple of times in",
    "start": "2057079",
    "end": "2062940"
  },
  {
    "text": "it and it's helped so what's next in matte box what we really want to do is",
    "start": "2062940",
    "end": "2068520"
  },
  {
    "text": "get more utilization data linked with the spelling data so I mentioned that we have some tooling around",
    "start": "2068520",
    "end": "2074398"
  },
  {
    "text": "ECS utilization on task reservations so if a task reserves two cores we'd love",
    "start": "2074399",
    "end": "2080099"
  },
  {
    "text": "to also show next to its cost report and what it's using say well by the way your task is reserving two cores and you're",
    "start": "2080099",
    "end": "2086310"
  },
  {
    "text": "usually using one and a half that's that's probably pretty good but maybe they're reserving ten cores and they're",
    "start": "2086310",
    "end": "2091618"
  },
  {
    "text": "usually using one it's not a super simple metric because you still want to have some some you know reporting around",
    "start": "2091619",
    "end": "2097950"
  },
  {
    "text": "the max maybe they're their task is spiking all the time it has a lower average but but getting utilization and",
    "start": "2097950",
    "end": "2103050"
  },
  {
    "text": "billing tightly linked ideally leads to better better utilization and better",
    "start": "2103050",
    "end": "2108210"
  },
  {
    "text": "efficiency on the cluster and we actually want to follow this model with a lot more of our large AWS products so",
    "start": "2108210",
    "end": "2114780"
  },
  {
    "text": "when we started on this initiative ECS was kind of lagging behind what we tell-tell our teams you know we can tell",
    "start": "2114780",
    "end": "2120520"
  },
  {
    "text": "them a lot more about what was happening on this three or lambda or you know some of the other AWS services that are big",
    "start": "2120520",
    "end": "2125950"
  },
  {
    "text": "for us and now acs is kind of you know it's at the top it's the one that teams are getting every weekend and seeing",
    "start": "2125950",
    "end": "2131650"
  },
  {
    "text": "what's happening so we want to add s3 to this we want to add lambda to this so we're rolling out more of this team",
    "start": "2131650",
    "end": "2137890"
  },
  {
    "text": "reporting across products and then we want to add some some more alarming and",
    "start": "2137890",
    "end": "2142990"
  },
  {
    "text": "monitoring so it kind of woke up us to the fact that we're still a little",
    "start": "2142990",
    "end": "2148780"
  },
  {
    "text": "manual on looking at at the bill every week and you know as I was going through",
    "start": "2148780",
    "end": "2154120"
  },
  {
    "text": "and sort of diagnosing oh this is happening on s3 or ECS caster here there were some patterns that emerge on how",
    "start": "2154120",
    "end": "2161020"
  },
  {
    "text": "you would dig into any AWS resource so if you know the resource went up any product let's say you know ACS went up",
    "start": "2161020",
    "end": "2167890"
  },
  {
    "text": "by double you could initially just start doing some queries slicing slicing that",
    "start": "2167890",
    "end": "2174040"
  },
  {
    "text": "product by let's say by the team or by the cluster tag and and just",
    "start": "2174040",
    "end": "2180100"
  },
  {
    "text": "automatically get a report back without having to do this this manual data sort",
    "start": "2180100",
    "end": "2185680"
  },
  {
    "text": "of digging so we're working on sort of a suite around that so as our bill goes up a lot I'm actually get sort of a ping",
    "start": "2185680",
    "end": "2192280"
  },
  {
    "text": "back that's like your bill is up five percent today it's up two percent in EECS on that it's like fifty percent of",
    "start": "2192280",
    "end": "2199810"
  },
  {
    "text": "that is on the API production cluster in southeast one and geo coder is running twice as much like you could automate",
    "start": "2199810",
    "end": "2205600"
  },
  {
    "text": "that if you build some queries with some logic behind them to pick out sort of the highest ifs and and they're",
    "start": "2205600",
    "end": "2211750"
  },
  {
    "text": "intelligently slicing your data just the last thing with all these products with",
    "start": "2211750",
    "end": "2216940"
  },
  {
    "text": "everything everything happening map box is is always growing so what's what's",
    "start": "2216940",
    "end": "2223240"
  },
  {
    "text": "next for map box we're looking for always looking for talented individuals I stole a snippet from our website here",
    "start": "2223240",
    "end": "2230170"
  },
  {
    "text": "but I really would emphasize that we're not always looking for the traditional background I started in finance",
    "start": "2230170",
    "end": "2235720"
  },
  {
    "text": "personally when I was in matte box and since then I've actually moved into this engineering role and we really look for",
    "start": "2235720",
    "end": "2242020"
  },
  {
    "text": "people who are passionate about interesting problems as opposed to potentially checking every box on on a",
    "start": "2242020",
    "end": "2247060"
  },
  {
    "text": "job application so so check out matte box jobs that's it for for my talk thanks thanks",
    "start": "2247060",
    "end": "2254150"
  },
  {
    "text": "everyone for coming this morning [Applause]",
    "start": "2254150",
    "end": "2258250"
  }
]