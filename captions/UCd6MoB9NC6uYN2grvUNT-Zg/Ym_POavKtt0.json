[
  {
    "text": "alright timer started it's officially time to get going so thanks for coming",
    "start": "500",
    "end": "5879"
  },
  {
    "text": "my name is Darren house I'm a Solutions Architect at AWS and I'm here to talk to you about centralized stock operations",
    "start": "5879",
    "end": "12240"
  },
  {
    "text": "on AWS this is something that you don't",
    "start": "12240",
    "end": "18119"
  },
  {
    "text": "often hear about how to do stock architectures in the cloud a lot of times it's the on-premise world you're",
    "start": "18119",
    "end": "23490"
  },
  {
    "text": "familiar with the on-premise stock environment and then maybe you'll lift and shift some stuff up into the cloud but what I want to talk to you about is",
    "start": "23490",
    "end": "30109"
  },
  {
    "text": "exploring a little bit about some of the power and the capabilities of what you can do in AWS as it relates to sock",
    "start": "30109",
    "end": "38000"
  },
  {
    "text": "technologies and functions and different roles and what the roles can do within AWS so before we dive into much so I",
    "start": "38000",
    "end": "48030"
  },
  {
    "text": "just want to make sure these two sessions here so the the bottom one aligning the NIST cybersecurity framework unfortunately that one",
    "start": "48030",
    "end": "54030"
  },
  {
    "text": "happened over here about two hours ago but if you can see the video I would highly recommend it because in my",
    "start": "54030",
    "end": "59190"
  },
  {
    "text": "opinion whenever you think about security you should always think about the cybersecurity framework it's a fantastic way to start thinking through",
    "start": "59190",
    "end": "66510"
  },
  {
    "text": "how you're going to do security and manage your risk in your environment the other one beating sophisticated",
    "start": "66510",
    "end": "71700"
  },
  {
    "text": "attackers by Tim Raines this is going to be a fantastic one it's tomorrow it's",
    "start": "71700",
    "end": "76860"
  },
  {
    "text": "focused on how you can use the concept of a kill chain or a cyber kill chain and your security strategy for",
    "start": "76860",
    "end": "83040"
  },
  {
    "text": "maintaining security and improving security in your environment and one of the reasons why I'm a big fan of this is",
    "start": "83040",
    "end": "89310"
  },
  {
    "text": "because part of this conversation here is gonna be focused on the mitre attack framework which is heavily dependent on",
    "start": "89310",
    "end": "94979"
  },
  {
    "text": "the concept of kill chain how many people here are familiar with that concept of kill chain so I can make sure",
    "start": "94979",
    "end": "101070"
  },
  {
    "text": "okay we've got a good awesome I like it ok so I highly recommend that's tomorrow",
    "start": "101070",
    "end": "108299"
  },
  {
    "text": "I think it's late afternoon or early afternoon but I recommend you go look at it so the main thing we're going to talk",
    "start": "108299",
    "end": "118619"
  },
  {
    "text": "about here is up on the top point this is the reason why we're here how we're going to use mitre attack and the",
    "start": "118619",
    "end": "125009"
  },
  {
    "text": "technics attack tactics and techniques from mitre attack to build out a capability using guard duty as the",
    "start": "125009",
    "end": "132540"
  },
  {
    "text": "driver of event and mapping guard duty finding types to the indicators of compromise that are",
    "start": "132540",
    "end": "139560"
  },
  {
    "text": "presented from mitre attack on their website that provides a whole bunch of",
    "start": "139560",
    "end": "144660"
  },
  {
    "text": "information about indicators of compromise how you can detect certain things all that stuff so that's really",
    "start": "144660",
    "end": "151500"
  },
  {
    "text": "the high level what we're gonna do and we're gonna I'm going to try and get through these slides as quickly as possible and then I'm gonna jump into a",
    "start": "151500",
    "end": "157650"
  },
  {
    "text": "demo and my goal is to be in the console as much as possible because I really want to show you what I think is an",
    "start": "157650",
    "end": "163830"
  },
  {
    "text": "amazing set of tools that you have your disposal that you might not be aware of",
    "start": "163830",
    "end": "169370"
  },
  {
    "text": "but in addition to that we're gonna baseline what sock is we're going to talk about how we can centralize data",
    "start": "169370",
    "end": "176040"
  },
  {
    "text": "and how we can visualize that central centralized data to detect incidents and to protect your environment and then",
    "start": "176040",
    "end": "182280"
  },
  {
    "text": "lastly we're going to talk about providing event-driven automation for responding to that primarily through the",
    "start": "182280",
    "end": "188450"
  },
  {
    "text": "mechanism I just identified using guard duty there's many different ways you can do it but guard duty seems to be a",
    "start": "188450",
    "end": "193769"
  },
  {
    "text": "perfect example of how you can start building out that approach to managing",
    "start": "193769",
    "end": "199910"
  },
  {
    "text": "security and managing risk in your environment through guard duty and mitre attack so we can't really talk about",
    "start": "199910",
    "end": "208099"
  },
  {
    "text": "soccer secured or anything like that unless you have an understanding of what AWS provides and so we're going to do a",
    "start": "208099",
    "end": "213870"
  },
  {
    "text": "quick mapping out of the different types of services and how they align to the NIST cybersecurity framework so when it",
    "start": "213870",
    "end": "220920"
  },
  {
    "text": "comes to identification we identify the primary services the AWS provides for",
    "start": "220920",
    "end": "225989"
  },
  {
    "text": "identifying what assets are out there and understanding what assets you have under risk that you need to manage and",
    "start": "225989",
    "end": "231209"
  },
  {
    "text": "figure out what those threats are is going to be Systems Manager and config so for us we're going to be using",
    "start": "231209",
    "end": "236910"
  },
  {
    "text": "Systems Manager quite a bit in the demo to get information about files that are stored on instances and fleet of",
    "start": "236910",
    "end": "243690"
  },
  {
    "text": "instances that might be indicators of compromised or directories it could be exfiltration directories we're also",
    "start": "243690",
    "end": "249209"
  },
  {
    "text": "going to be talking about registry hacks and could be done for running putting things in your registry and we can",
    "start": "249209",
    "end": "255150"
  },
  {
    "text": "search on those instances to look for some indicators of known registry hacks in your environment to get additional",
    "start": "255150",
    "end": "261450"
  },
  {
    "text": "information as you're trying to identify the risks in your environment what's going on so protect we have a whole bunch of",
    "start": "261450",
    "end": "268600"
  },
  {
    "text": "services and protect I'm not going to go through every single one of them but from firewalls to V pcs to do the",
    "start": "268600",
    "end": "274180"
  },
  {
    "text": "isolation there's a lot of capabilities abs provides and the protection realm for the cybersecurity framework for",
    "start": "274180",
    "end": "282250"
  },
  {
    "text": "detection there's a number of capabilities as well so we have guard duty we have may see we have inspector",
    "start": "282250",
    "end": "288639"
  },
  {
    "text": "and we have security hub which is up there which is still in preview it's supposed to go GA sometime soon but",
    "start": "288639",
    "end": "294520"
  },
  {
    "text": "that's going to be a centralized place for aggregating may see guard duty and",
    "start": "294520",
    "end": "300070"
  },
  {
    "text": "inspector data into one place so you have dashboards and visibility into what's happening in your environment and",
    "start": "300070",
    "end": "305410"
  },
  {
    "text": "so it's it's going to be a really cool tool for this demo guard duty is going to be the key thing for the event-driven",
    "start": "305410",
    "end": "311919"
  },
  {
    "text": "automation you have a finding type that gets causes an event to happen and then",
    "start": "311919",
    "end": "317740"
  },
  {
    "text": "the question of how do you do detection response and there's a mix of a life cycle here of how you investigate and",
    "start": "317740",
    "end": "324310"
  },
  {
    "text": "how can you automate the investigation to make things a little bit easier for you you know we all know that there's",
    "start": "324310",
    "end": "330460"
  },
  {
    "text": "issues with having enough skilled cyber professionals the work is out there",
    "start": "330460",
    "end": "335530"
  },
  {
    "text": "there's tons of work to be done there's just not a lot of people they're capable of getting that work done and it's a",
    "start": "335530",
    "end": "341169"
  },
  {
    "text": "known issue I think the latest numbers we have from the federal government was two hundred ninety nine thousand open recs something like that so it's a it's",
    "start": "341169",
    "end": "348820"
  },
  {
    "text": "a big deal so how we can automate the investigation and help the investigation",
    "start": "348820",
    "end": "354490"
  },
  {
    "text": "maybe to help reduce some of the false positives maybe help your tier windsock analysts really the burden for them so",
    "start": "354490",
    "end": "361210"
  },
  {
    "text": "stuff like that and then to recover from major incidents that kind of stuff so",
    "start": "361210",
    "end": "366660"
  },
  {
    "text": "AWS has a broad portfolio of these services that align to the cybersecurity framework that you can use in your",
    "start": "366660",
    "end": "372580"
  },
  {
    "text": "environments to help you so we've got",
    "start": "372580",
    "end": "377710"
  },
  {
    "text": "that let's start talking about what sock is okay so a security operations center there's essentially three functions that",
    "start": "377710",
    "end": "384370"
  },
  {
    "text": "are provided within a Security Operations Center this could be a high-level you could have you know hours",
    "start": "384370",
    "end": "389560"
  },
  {
    "text": "and hours conversation about this and I think I remember I think it was my tour that actually wrote a document a couple",
    "start": "389560",
    "end": "395200"
  },
  {
    "text": "of years ago about sock operations and is about 768 pages I think so there's definitely a lot of",
    "start": "395200",
    "end": "400580"
  },
  {
    "text": "information in terms of what sock is we're definitely not going to get into all those details but at the base level",
    "start": "400580",
    "end": "406480"
  },
  {
    "text": "there's monitoring you have to know what data you have in your environment and you have to know what sensors you're",
    "start": "406480",
    "end": "412910"
  },
  {
    "text": "using to pull data in and then what the perspective is of the sensors that you",
    "start": "412910",
    "end": "418670"
  },
  {
    "text": "have and one of the demos I'll show you a little bit more about what I mean by",
    "start": "418670",
    "end": "424370"
  },
  {
    "text": "what perspectives you have right because there's different perspectives you can have from similar data whether it's from a VPC flow log or from an instance log",
    "start": "424370",
    "end": "431840"
  },
  {
    "text": "like a event log from a window system if you could correlate that information in a single dashboard it can give you a",
    "start": "431840",
    "end": "438530"
  },
  {
    "text": "little bit more information if you could do that in an automated fashion that provides quite a bit of help there for",
    "start": "438530",
    "end": "443780"
  },
  {
    "text": "you so monitoring is one of the key functions within a sock and then the",
    "start": "443780",
    "end": "449900"
  },
  {
    "text": "next one is detection so you get data coming in but then you have to know okay",
    "start": "449900",
    "end": "456260"
  },
  {
    "text": "what is good behavior what is bad behavior how can I detect it what are the parameters that define good behavior",
    "start": "456260",
    "end": "462620"
  },
  {
    "text": "versus bad so that's the second key functionality of a sock and we're going",
    "start": "462620",
    "end": "468560"
  },
  {
    "text": "to be providing some capabilities here for that as well and then lastly the response so you get the data in you just",
    "start": "468560",
    "end": "475970"
  },
  {
    "text": "you define your parameters for what is good and what is bad but then you have to decide if you see bad behavior what",
    "start": "475970",
    "end": "481850"
  },
  {
    "text": "are you going to do about it oftentimes that's going to be a run book a playable kind of thing but there's a lot of different ways to go about your",
    "start": "481850",
    "end": "489590"
  },
  {
    "text": "response so these are the three key functions within the socket environment",
    "start": "489590",
    "end": "496220"
  },
  {
    "text": "now who does this so first we have the Tier one analyst right so this is the",
    "start": "496220",
    "end": "501380"
  },
  {
    "text": "person that's going to be looking at the monitoring looking at all the alerts coming in and trying to figure out",
    "start": "501380",
    "end": "507080"
  },
  {
    "text": "what's a false positive and what's a true positive all right so these are the people that oftentimes get super",
    "start": "507080",
    "end": "512630"
  },
  {
    "text": "overwhelmed because there are so many false positives out there and by the",
    "start": "512630",
    "end": "518090"
  },
  {
    "text": "people that raised their hands I'm not telling anything you don't know right so I'll just go on to the next one here so",
    "start": "518090",
    "end": "524150"
  },
  {
    "text": "the cheer to responder that's the next type so that the Tier two person is the one that will take the information from",
    "start": "524150",
    "end": "530240"
  },
  {
    "text": "the tier one and it is actually an incident if it is something that you need to investigate",
    "start": "530240",
    "end": "535420"
  },
  {
    "text": "then they can start doing the investigation and do some of the response for it depending on the severity depending on the level right",
    "start": "535420",
    "end": "541540"
  },
  {
    "text": "but then you might have a tier 3 responder who is deep technical expert a subject-matter expert somebody who can",
    "start": "541540",
    "end": "548440"
  },
  {
    "text": "do significantly more work than the tier 2 operator can do oftentimes these are",
    "start": "548440",
    "end": "554920"
  },
  {
    "text": "the ones that build tools for a team or they actually start threat hunting programs for a team and one thing I'm",
    "start": "554920",
    "end": "561670"
  },
  {
    "text": "going to talk to you about and show you is the the model that we have here for Sauk on AWS using the services that",
    "start": "561670",
    "end": "568720"
  },
  {
    "text": "we'll get to in a few moments it gives you a pathway to start thinking about",
    "start": "568720",
    "end": "574210"
  },
  {
    "text": "how you can do threat hunting because and I'm not going to say that this is going to get you threatening because that's a complex conversation and it",
    "start": "574210",
    "end": "580990"
  },
  {
    "text": "takes a lot of skill sets but it's a good idea to start thinking about how you can proactively look at threats and",
    "start": "580990",
    "end": "586390"
  },
  {
    "text": "automate the looking of threats and then making it so that your operations",
    "start": "586390",
    "end": "591460"
  },
  {
    "text": "becomes a little easier and hopefully through this conversation we'll be able to help tie all these pieces together",
    "start": "591460",
    "end": "596680"
  },
  {
    "text": "and show you how we can do that with cloud watch logs cloud watch log insights and then cloud watch dashboards",
    "start": "596680",
    "end": "603760"
  },
  {
    "text": "as the the means to do that so we've got",
    "start": "603760",
    "end": "609790"
  },
  {
    "text": "the Sauk out of the way now there's a different way to different ways to centralize your data to aggregate your",
    "start": "609790",
    "end": "615880"
  },
  {
    "text": "data and this right here is a representation of a solution that we have that we built for CDM all right",
    "start": "615880",
    "end": "623140"
  },
  {
    "text": "over the FISMA cio dashboard an agency level dashboard a way to aggregate data centralize that data and then provide it",
    "start": "623140",
    "end": "631240"
  },
  {
    "text": "in a quick site for for the dashboard so on the left hand side you have all your sensor information you can do it a multi",
    "start": "631240",
    "end": "638170"
  },
  {
    "text": "count multi region for a majority of these and if you look over here the bottom three lines are going to this s3",
    "start": "638170",
    "end": "645520"
  },
  {
    "text": "bucket and then you see the top two lines are going to a cloud watch scheduled eventually there's a reason for that the bottom three they are",
    "start": "645520",
    "end": "652780"
  },
  {
    "text": "configurable to be multi-account multi region all you have to do is make a couple configurations and then it's done",
    "start": "652780",
    "end": "659050"
  },
  {
    "text": "and the multi count multi-region capability is there for services like guard duty you have the ability to do",
    "start": "659050",
    "end": "665140"
  },
  {
    "text": "multi count but you can't do multi-region today out of the service itself and then",
    "start": "665140",
    "end": "670439"
  },
  {
    "text": "with inspector you can OD a single account single region so what we did with this architecture is",
    "start": "670439",
    "end": "676169"
  },
  {
    "text": "we used lambda to be able to query those services for the data that we needed for",
    "start": "676169",
    "end": "681239"
  },
  {
    "text": "the FISMA cio dashboard requirements and then aggregate them into that centralized s3 bucket normalized that",
    "start": "681239",
    "end": "687660"
  },
  {
    "text": "data and then create the what's called manifest files so that the quick site",
    "start": "687660",
    "end": "692910"
  },
  {
    "text": "service could ingest that data and then provide a visualization for a dashboard that meets the stadium and the FISMA see",
    "start": "692910",
    "end": "699389"
  },
  {
    "text": "our dashboard requirements so this is one model this is more of a historical",
    "start": "699389",
    "end": "704910"
  },
  {
    "text": "model right but there's also the real-time or near real-time model for dashboards and that's what we're going to get into with the demo as well right",
    "start": "704910",
    "end": "711720"
  },
  {
    "text": "but this is a working architecture that we have so and this is just to identify",
    "start": "711720",
    "end": "721040"
  },
  {
    "text": "it's important to understand the multi region multi-count capabilities within AWS and those capabilities are growing",
    "start": "721040",
    "end": "727709"
  },
  {
    "text": "it's a it's a trend within AWS - make our services more multi account multi-regional make them easier to",
    "start": "727709",
    "end": "733709"
  },
  {
    "text": "configure that way versus having to use lambda functions to aggregate data that kind of stuff but today this is how it",
    "start": "733709",
    "end": "740009"
  },
  {
    "text": "all looks there's a good majority of them that can do multi account the ones",
    "start": "740009",
    "end": "745379"
  },
  {
    "text": "that can't do multi region today for the most part you can use lambda functions or step functions integrated with lambda",
    "start": "745379",
    "end": "751619"
  },
  {
    "text": "functions to do that but in addition for the like the cloud watch cloud watch",
    "start": "751619",
    "end": "756629"
  },
  {
    "text": "logs to be able to do a multi region you can ingest those into Kinesis for",
    "start": "756629",
    "end": "761910"
  },
  {
    "text": "example you can take those from Kinesis and then you can put them into an s3 bucket a multi count multi region so there's multiple steps to go through but",
    "start": "761910",
    "end": "768779"
  },
  {
    "text": "you can get to that multi-count multi region today",
    "start": "768779",
    "end": "772669"
  },
  {
    "text": "okay now we're getting to the fun stuff so mitre attack so what is this",
    "start": "775050",
    "end": "782750"
  },
  {
    "text": "so mitre attack is a globally accessible",
    "start": "782750",
    "end": "787970"
  },
  {
    "text": "repository knowledge base of tactics techniques indicators of compromised",
    "start": "787970",
    "end": "795320"
  },
  {
    "text": "tools that attackers use to attack your environments all right so it's a it's a",
    "start": "796350",
    "end": "803070"
  },
  {
    "text": "very comprehensive environment and this right here shows a small subset of what",
    "start": "803070",
    "end": "808950"
  },
  {
    "text": "all of Myra TAC has right so it goes across from initial access and we're talking that goes to the kill chain",
    "start": "808950",
    "end": "814770"
  },
  {
    "text": "conversation right but it fills it fills a lot of voids that we we currently have",
    "start": "814770",
    "end": "820140"
  },
  {
    "text": "in security in terms of trying to understand how secure are we and what is the roadmap that we need to follow to",
    "start": "820140",
    "end": "826620"
  },
  {
    "text": "get more secure and give you a path to follow and so what we're going to talk about in this design and this",
    "start": "826620",
    "end": "833130"
  },
  {
    "text": "architecture is how to take that the data that's already there you're leveraging an asset that already exists",
    "start": "833130",
    "end": "838560"
  },
  {
    "text": "today and it's free to everybody how can you leverage this to make your environment more secure and do it in an",
    "start": "838560",
    "end": "844950"
  },
  {
    "text": "automated way so we're going to go",
    "start": "844950",
    "end": "852270"
  },
  {
    "text": "through two scenarios all right and we're going to run through run the architecture through these two scenarios so the first scenario is going to be apt",
    "start": "852270",
    "end": "858600"
  },
  {
    "text": "18 the second scenario is gonna be Leviathan so these are two thread actors that are known thread actors in the in",
    "start": "858600",
    "end": "864690"
  },
  {
    "text": "the world and they have they've had some attacks as late as 2018 so last year",
    "start": "864690",
    "end": "870660"
  },
  {
    "text": "there had been some some attacks that people attributed to them we can all",
    "start": "870660",
    "end": "875970"
  },
  {
    "text": "talk about attribution but the reason why I picked these two primarily is",
    "start": "875970",
    "end": "881520"
  },
  {
    "text": "because both of these focus on government so these guys are the ones",
    "start": "881520",
    "end": "887160"
  },
  {
    "text": "that are looking at your networks trying to get into your environments okay they",
    "start": "887160",
    "end": "892620"
  },
  {
    "text": "also follow some common patterns right so how do you do things one of the patterns is once you get a compromise",
    "start": "892620",
    "end": "899670"
  },
  {
    "text": "you have to persist your access so they do registry hacks and they put files in",
    "start": "899670",
    "end": "905790"
  },
  {
    "text": "place to try and maintain that persistence another thing they do is for staging an",
    "start": "905790",
    "end": "911100"
  },
  {
    "text": "exfiltration they'll use specific folders sometimes they change but there's some known patterns there for",
    "start": "911100",
    "end": "916310"
  },
  {
    "text": "aggregating all the data that they found before they exfiltrated out they also use a passive passing the hash as a way",
    "start": "916310",
    "end": "924360"
  },
  {
    "text": "to move between systems and compromised credentials and then lastly the PowerShell so PowerShell is a big thing",
    "start": "924360",
    "end": "931290"
  },
  {
    "text": "most admins use PowerShell on a regular basis in your environment so it the",
    "start": "931290",
    "end": "936390"
  },
  {
    "text": "attackers end up wanting to live off the land and they can use PowerShell to move around they can use PowerShell to download things like cobalt striker",
    "start": "936390",
    "end": "944100"
  },
  {
    "text": "like member cats for example and try and off you skate the ability for you to detect a lot of this stuff so the goal",
    "start": "944100",
    "end": "951810"
  },
  {
    "text": "here is to we're going to go through each one of these scenarios and we're gonna jump into a demo and show you kind",
    "start": "951810",
    "end": "958800"
  },
  {
    "text": "of how the system works and how we're thinking about doing sock in AWS today so let's start with apt 18 so the",
    "start": "958800",
    "end": "967320"
  },
  {
    "text": "indicators are compromised that we have from apt 18 according to mitre or the registry key the the run entry within",
    "start": "967320",
    "end": "973830"
  },
  {
    "text": "the registry keys and oftentimes they can use folders like hid manager or ask on track server those areas are some",
    "start": "973830",
    "end": "981570"
  },
  {
    "text": "known areas where apt 18 will end up creating these folders are using folders to store data before the exfiltrated so",
    "start": "981570",
    "end": "988860"
  },
  {
    "text": "they'll stage they'll use registries they also use a tool called ghost rat",
    "start": "988860",
    "end": "994320"
  },
  {
    "text": "remote access tool that can often be used for lateral movement between",
    "start": "994320",
    "end": "999810"
  },
  {
    "text": "systems and between hosts and that often ends up using like remote shell which is",
    "start": "999810",
    "end": "1005690"
  },
  {
    "text": "it'll be TCP port 514 or 513 in your environment usually it can be multiple",
    "start": "1005690",
    "end": "1011630"
  },
  {
    "text": "of different ports but those are common ones so we'll show you ways that you can look through those ports and look",
    "start": "1011630",
    "end": "1017330"
  },
  {
    "text": "through your environment in an automated fashion to identify what's going on in your environment and with that oh one",
    "start": "1017330",
    "end": "1027319"
  },
  {
    "text": "more part I got layout the whole architecture for you kind of important so I'm gonna lay out how how this is",
    "start": "1027320",
    "end": "1033350"
  },
  {
    "text": "gonna work and then we'll go into the demo and I'll show you it okay so the first thing we have a guard duty finding",
    "start": "1033350",
    "end": "1039079"
  },
  {
    "text": "so it's a guard duty finding behavior ec to network port usual what that means is guard duty it's",
    "start": "1039079",
    "end": "1046280"
  },
  {
    "text": "a baseline of normal behavior if they see something that had if guard duty see something that happens outside of that",
    "start": "1046280",
    "end": "1051530"
  },
  {
    "text": "normal profile behavior it will make an alert so guard duty will create this",
    "start": "1051530",
    "end": "1057230"
  },
  {
    "text": "alert they'll send that finding all your guard duty information goes into cloud watch",
    "start": "1057230",
    "end": "1062690"
  },
  {
    "text": "and you can create what's called a cloud watch event to capture all your guard duty information and then you can use",
    "start": "1062690",
    "end": "1069309"
  },
  {
    "text": "step functions or lambda function to parse out information from there so what",
    "start": "1069309",
    "end": "1075170"
  },
  {
    "text": "we're going to be parsing out for our demo right now is the network port unusual finding type because we know",
    "start": "1075170",
    "end": "1081380"
  },
  {
    "text": "that apt 18 some of the indicators are compromised would lead to this type of a finding so we've created a dynamo",
    "start": "1081380",
    "end": "1089270"
  },
  {
    "text": "database that has these findings but it also has information about certain",
    "start": "1089270",
    "end": "1095570"
  },
  {
    "text": "queries for different services that gather data that you can query to pull some of this information in it also will",
    "start": "1095570",
    "end": "1103630"
  },
  {
    "text": "actually I'll just move it along so we're gonna be querying cloud trail logs for example because one of the things if",
    "start": "1103630",
    "end": "1109730"
  },
  {
    "text": "you get a compromise on an instance one of the first things oftentimes an attack will do is it'll try and do a list",
    "start": "1109730",
    "end": "1115820"
  },
  {
    "text": "profiles or figure out what the instance profile has what permissions it has to see if they can get more if it can",
    "start": "1115820",
    "end": "1123290"
  },
  {
    "text": "create anything if it can or get more permissions so we're gonna do a cloud",
    "start": "1123290",
    "end": "1130160"
  },
  {
    "text": "trail query to look for any API calls from that instance with that instance role that's coming from that source to",
    "start": "1130160",
    "end": "1136730"
  },
  {
    "text": "see if is that an indicator is this a false positive or is a true positive we're also going to be looking at the",
    "start": "1136730",
    "end": "1142580"
  },
  {
    "text": "VPC flow logs looking for indicators of compromise for a remote access tool for ghoster at ports 514 port 513 we're also",
    "start": "1142580",
    "end": "1151610"
  },
  {
    "text": "going to be going into Systems Manager so a Systems Manager has a whole lot of",
    "start": "1151610",
    "end": "1157880"
  },
  {
    "text": "information that you can get about your ec2 instance in your environment so we're going to be querying systems",
    "start": "1157880",
    "end": "1162950"
  },
  {
    "text": "manager and for this we don't use cloud watch log insight queries we use lambda functions to pull out some pieces of",
    "start": "1162950",
    "end": "1168410"
  },
  {
    "text": "information based on these indicators we'll compromise that we know exists based on what might our attack has",
    "start": "1168410",
    "end": "1175470"
  },
  {
    "text": "five for us so for this we'll be looking at the registry keys and it'll be looking at the files and then after that",
    "start": "1175470",
    "end": "1183679"
  },
  {
    "text": "we're gonna end up doing a notification basically saying hey here we did a query",
    "start": "1183679",
    "end": "1189299"
  },
  {
    "text": "your dashboards ready and it's going to create a dynamic dashboard based on the results of the query that you had and",
    "start": "1189299",
    "end": "1195539"
  },
  {
    "text": "it's gonna populate that within cloud watch logs or within the cloud watch the dashboard environment okay so that's how",
    "start": "1195539",
    "end": "1203370"
  },
  {
    "text": "that looks and may the demo bit god be good with us because we're going in",
    "start": "1203370",
    "end": "1209809"
  },
  {
    "text": "alright so go into the demo awesome okay so let's start out with guard duty so",
    "start": "1209809",
    "end": "1217470"
  },
  {
    "text": "this is where it all starts if you notice right here it's the behavior net report unusual I'm just filtering on",
    "start": "1217470",
    "end": "1223890"
  },
  {
    "text": "that so you can see that that's what we're looking at here and this is an example so I want you to see an example",
    "start": "1223890",
    "end": "1228900"
  },
  {
    "text": "of what the findings look like and some information and there's some key pieces",
    "start": "1228900",
    "end": "1234000"
  },
  {
    "text": "here to it I'm going to scroll down so for example the instance profile this",
    "start": "1234000",
    "end": "1240000"
  },
  {
    "text": "information is in the guard duty findings so you can take that information you can pass it on to your query to look for stuff for the instance",
    "start": "1240000",
    "end": "1246630"
  },
  {
    "text": "to see if that instance is actually sending in from or trying to escalate privileges in your environment right so guard duty the finding type has",
    "start": "1246630",
    "end": "1253650"
  },
  {
    "text": "a lot of valuable information that you can pass into other systems or use to query other systems so we show the event",
    "start": "1253650",
    "end": "1263549"
  },
  {
    "text": "finding I'm not going to go to cloud watch events because it's a fairly simple process but I'm going to jump into the dashboard I'm I'm sorry the",
    "start": "1263549",
    "end": "1270330"
  },
  {
    "text": "Dynamo table so we have a dashboard that's set up I'm going to jump right",
    "start": "1270330",
    "end": "1276330"
  },
  {
    "text": "here and give you a couple of examples so this one right here actually let me go down to network report unusual so",
    "start": "1276330",
    "end": "1285000"
  },
  {
    "text": "we'll give you an example of the get instance profile so that's one of the calls that an adversary could use to try",
    "start": "1285000",
    "end": "1291750"
  },
  {
    "text": "and see what's going on and I know it's might be a little hard to see apologize for that but it's identifying the source",
    "start": "1291750",
    "end": "1297720"
  },
  {
    "text": "so the source is a cloud watch law group so and then the the cloud watch saw cops",
    "start": "1297720",
    "end": "1304280"
  },
  {
    "text": "cloud trail so it's searching the cloud trail logs that are being centralized aggregate it as you saw from the old",
    "start": "1304280",
    "end": "1310610"
  },
  {
    "text": "former diagram right that's grabbing all that information and this is the query",
    "start": "1310610",
    "end": "1316170"
  },
  {
    "text": "language that's being used to get the event name the event source the user identity AR n some other pieces of",
    "start": "1316170",
    "end": "1323760"
  },
  {
    "text": "information that we're just going to parse it's going to pull that information in and it's going to pass it",
    "start": "1323760",
    "end": "1328890"
  },
  {
    "text": "along to cloud watch dashboards and so for this demo we have net report unusual",
    "start": "1328890",
    "end": "1336900"
  },
  {
    "text": "we have one two three go strat instance info registry Keys V PC flow logs so",
    "start": "1336900",
    "end": "1342690"
  },
  {
    "text": "there's a number of different parts in the the table that are going to be used as we aggregate all this data and put it",
    "start": "1342690",
    "end": "1347910"
  },
  {
    "text": "into a dashboard for you so then we go it's a cloud watch so this",
    "start": "1347910",
    "end": "1353220"
  },
  {
    "text": "is cloud watch log insights and I'm going to show you this real quick because I think it's important for you",
    "start": "1353220",
    "end": "1358350"
  },
  {
    "text": "to understand that you can do all this manually and oftentimes people do things",
    "start": "1358350",
    "end": "1363930"
  },
  {
    "text": "manually you know when you're on premise it just becomes a little more difficult sometimes to automate so I'm gonna walk",
    "start": "1363930",
    "end": "1370020"
  },
  {
    "text": "through the process of doing some of this manually so you can see the data that comes back kind of understand that flow and then I'm going to show you how",
    "start": "1370020",
    "end": "1376590"
  },
  {
    "text": "much different it is when you automate it okay so this right here we're doing sock ops the query that we're doing it's",
    "start": "1376590",
    "end": "1384090"
  },
  {
    "text": "looking for protocol six TCP port 514 and right now we're looking at a day",
    "start": "1384090",
    "end": "1390720"
  },
  {
    "text": "that's what the one day but this you can change the times any time you want but",
    "start": "1390720",
    "end": "1396120"
  },
  {
    "text": "you run the query looking for any information and then one thing to note",
    "start": "1396120",
    "end": "1401310"
  },
  {
    "text": "right down here this part right here while you're doing the query it'll show",
    "start": "1401310",
    "end": "1407430"
  },
  {
    "text": "you how many records matched how much data and how many records that looked",
    "start": "1407430",
    "end": "1412680"
  },
  {
    "text": "through and I give you an indication of the performance and the time it took to go through all the data you have to get",
    "start": "1412680",
    "end": "1418560"
  },
  {
    "text": "the results for that query okay so it gives you some indications of the performance that's providing for you so",
    "start": "1418560",
    "end": "1424650"
  },
  {
    "text": "in this in last hour we've had one instance where there is port 514 there's",
    "start": "1424650",
    "end": "1432480"
  },
  {
    "text": "trying to get into environment now fortunately that was a reject so that's a good thing and the reason why was a",
    "start": "1432480",
    "end": "1438270"
  },
  {
    "text": "reject is because it was coming from a public IP space that was being blocked by a security group okay but what else can we look at so",
    "start": "1438270",
    "end": "1448690"
  },
  {
    "text": "there's I'm gonna copy this right over here because there's a different ways",
    "start": "1448690",
    "end": "1455000"
  },
  {
    "text": "that you can look at things also so let's take the same data and put it into",
    "start": "1455000",
    "end": "1463669"
  },
  {
    "text": "a format like this and then you can say hmm this might actually be even better",
    "start": "1463669",
    "end": "1469190"
  },
  {
    "text": "data to look at because the way the format is so it gives you it's more",
    "start": "1469190",
    "end": "1475130"
  },
  {
    "text": "aggregated it gives you source destination IP addresses and the bytes transferred it's a little more easy to",
    "start": "1475130",
    "end": "1481580"
  },
  {
    "text": "look at so you can say is there actually any data going through here is there some exfiltration data or anything like that what kind of traffic is there",
    "start": "1481580",
    "end": "1486980"
  },
  {
    "text": "there's not a lot it's 40 bytes so the other thing you can look at we're",
    "start": "1486980",
    "end": "1493070"
  },
  {
    "text": "talking about the cloud trail logs all right so we looked at those so this",
    "start": "1493070",
    "end": "1498950"
  },
  {
    "text": "right here is going to be the query that you can use in the cloud trail logs from cloud watch login sites to gather",
    "start": "1498950",
    "end": "1504140"
  },
  {
    "text": "information the event name list instance profiles that's the API call that's",
    "start": "1504140",
    "end": "1509179"
  },
  {
    "text": "being made from the instance you can get the that's coming from the I am and then",
    "start": "1509179",
    "end": "1514250"
  },
  {
    "text": "it's the the instance profile that's being used on the instance so you run",
    "start": "1514250",
    "end": "1519409"
  },
  {
    "text": "the query and this will end up identifying any instances there were",
    "start": "1519409",
    "end": "1524659"
  },
  {
    "text": "four so we have a couple of them here and again you can customize the date",
    "start": "1524659",
    "end": "1531409"
  },
  {
    "text": "range for relative so you can go from days to weeks and just right here in the",
    "start": "1531409",
    "end": "1537320"
  },
  {
    "text": "dashboard you can modify your query results right here and figure out is this something that's been going on for a while or is it just happening right",
    "start": "1537320",
    "end": "1543289"
  },
  {
    "text": "now all that good stuff now in addition",
    "start": "1543289",
    "end": "1548360"
  },
  {
    "text": "to that we have we'll do the system the security logs so pass the hash so pass",
    "start": "1548360",
    "end": "1555950"
  },
  {
    "text": "the hash is when you can get an ntlm hash of the password that somebody has and you can take that and pass that end",
    "start": "1555950",
    "end": "1561799"
  },
  {
    "text": "to get compromised other instances and move laterally between instances with a privilege escalation from the hash of",
    "start": "1561799",
    "end": "1568909"
  },
  {
    "text": "like the admin or something like that this is commonly used with mimic hats member cats is one of those tools that's",
    "start": "1568909",
    "end": "1574130"
  },
  {
    "text": "used often by the by the adversaries so what we know is",
    "start": "1574130",
    "end": "1579630"
  },
  {
    "text": "that there's common patterns from the event logs and these are from the windows security event logs but there's",
    "start": "1579630",
    "end": "1586260"
  },
  {
    "text": "common patterns in these event logs they can identify when passed the hash is happening right and so that's why we're",
    "start": "1586260",
    "end": "1592380"
  },
  {
    "text": "looking for this stuff so we're looking for certain event types the event type",
    "start": "1592380",
    "end": "1597990"
  },
  {
    "text": "of 46:24 with a logon type of nine and then the yeah so we run this query and",
    "start": "1597990",
    "end": "1610010"
  },
  {
    "text": "then you can see right here if you see if n idea of 26 or 46 24 with this logon",
    "start": "1610010",
    "end": "1617970"
  },
  {
    "text": "type and that logon process name that is conclusive evidence that that is a pass the hash happening in your environment",
    "start": "1617970",
    "end": "1624480"
  },
  {
    "text": "so you know right then and there you've detected bad behavior and you can send that to your tier 2 or your tier 2 tier",
    "start": "1624480",
    "end": "1631200"
  },
  {
    "text": "3 sock operator depending on what your processes are alright so like I saying you can do all this stuff manually it'll",
    "start": "1631200",
    "end": "1638700"
  },
  {
    "text": "take a while but you can do it in addition we have Systems Manager so we",
    "start": "1638700",
    "end": "1644610"
  },
  {
    "text": "looked at the logs we have VPC flow logs we have cloud trail logs we're looking at instance logs for for security events",
    "start": "1644610",
    "end": "1652980"
  },
  {
    "text": "we also have some system on logs we have some PowerShell logs we're going to be looking at so we're a grenade all this",
    "start": "1652980",
    "end": "1658230"
  },
  {
    "text": "log data we have some Linux instances so we're getting of our log messages we're getting the secure logs were getting",
    "start": "1658230",
    "end": "1663450"
  },
  {
    "text": "nginx logs so we're gathering all kinds of logs and you can search across these different log streams to look for",
    "start": "1663450",
    "end": "1669990"
  },
  {
    "text": "information the indicators of compromised now when it comes to Systems",
    "start": "1669990",
    "end": "1675210"
  },
  {
    "text": "Manager this is not going to be a query language this is going to be doing some API calls through lambda to gather",
    "start": "1675210",
    "end": "1681300"
  },
  {
    "text": "information about those services to see if there's indicators of compromised in that environment so what you'll see",
    "start": "1681300",
    "end": "1687540"
  },
  {
    "text": "right here is I'll point you here so this shows that I have 20 instances in my environment right now and I'll scroll",
    "start": "1687540",
    "end": "1694560"
  },
  {
    "text": "down just to show you the instances that I have there's a whole bunch of them here there's these guys there's a whole",
    "start": "1694560",
    "end": "1700200"
  },
  {
    "text": "nother page of them right over here and what the API call will essentially be",
    "start": "1700200",
    "end": "1705990"
  },
  {
    "text": "doing is what I'm going to do manually for you right now so say we're looking for a file so go to",
    "start": "1705990",
    "end": "1713340"
  },
  {
    "text": "file and the file name and we'll call equal and this one is going to be bad",
    "start": "1713340",
    "end": "1722190"
  },
  {
    "text": "guy DXE because bad guys always like to show themselves in plain sight",
    "start": "1722190",
    "end": "1727590"
  },
  {
    "text": "but if you're searching for a file what that did is it searched through all the twenty instances that were there it searched fruit through the data that it",
    "start": "1727590",
    "end": "1733650"
  },
  {
    "text": "was looking for to see is there an indicator that you know of that could show compromise on your instance and it",
    "start": "1733650",
    "end": "1739290"
  },
  {
    "text": "looks like there is we have one instance right here that they caught caught on that so we scroll down and we can get",
    "start": "1739290",
    "end": "1744870"
  },
  {
    "text": "the instance information we can go right to that instance and there you go so the",
    "start": "1744870",
    "end": "1750720"
  },
  {
    "text": "other things you can do is just to show you we're gonna go we're going for this apt eighteen think so track server so",
    "start": "1750720",
    "end": "1759240"
  },
  {
    "text": "let's copy this bad boy so now we're",
    "start": "1759240",
    "end": "1766050"
  },
  {
    "text": "gonna do file and we can do install directory let's say begin with and it",
    "start": "1766050",
    "end": "1774990"
  },
  {
    "text": "looks like there's two instances in our environment that have these indicators of compromised because these directories",
    "start": "1774990",
    "end": "1781740"
  },
  {
    "text": "are oftentimes used to exfiltrate data so again this is just searching across your environment you didn't have to you",
    "start": "1781740",
    "end": "1789120"
  },
  {
    "text": "don't have to manage any service to do this you didn't have to manage any large fleet or anything like that this is all stuff that comes out of the Systems",
    "start": "1789120",
    "end": "1795090"
  },
  {
    "text": "Manager service itself so these are some",
    "start": "1795090",
    "end": "1801169"
  },
  {
    "text": "let me do one more for you so we'll do registry or just a value name begin with",
    "start": "1801380",
    "end": "1808020"
  },
  {
    "text": "and I hope I get the name right because if not oh good I got right so this is",
    "start": "1808020",
    "end": "1813990"
  },
  {
    "text": "also can be an indicator of compromise having this in there as well so we'll go down here again and what you can do with",
    "start": "1813990",
    "end": "1820800"
  },
  {
    "text": "these you can click on this it'll bring you up to the inventory page for that instance you can look in the inventory",
    "start": "1820800",
    "end": "1827550"
  },
  {
    "text": "and then you can start looking through all the different pieces of data that Systems Manager has for this environment",
    "start": "1827550",
    "end": "1833760"
  },
  {
    "text": "and there's a lot of data right so we'll end up looking at the registry and then you can scroll down and and there you go",
    "start": "1833760",
    "end": "1839580"
  },
  {
    "text": "so you see your stuff right there so these are the things that it's",
    "start": "1839580",
    "end": "1845559"
  },
  {
    "text": "querying to get information and then the end result is it's going to be populated into a dashboard all right so right now",
    "start": "1845559",
    "end": "1852280"
  },
  {
    "text": "what we're looking at is the cloud watch dashboard environment itself and you can see that I have just a sock dashboard",
    "start": "1852280",
    "end": "1858070"
  },
  {
    "text": "just one single dashboard in there and yours can look however you want it to right now mine has a couple different",
    "start": "1858070",
    "end": "1864309"
  },
  {
    "text": "pieces in it it's going to look for denied access from cloud trail just to",
    "start": "1864309",
    "end": "1869620"
  },
  {
    "text": "keep information on that it's going to be looking for understanding which api's are calling how many ApS are calling",
    "start": "1869620",
    "end": "1875590"
  },
  {
    "text": "things in my environment different statistics for it the error codes all that kind of stuff right you can do a",
    "start": "1875590",
    "end": "1882520"
  },
  {
    "text": "lots of different types of dashboards based on the information that's important to you but I just want to show",
    "start": "1882520",
    "end": "1889059"
  },
  {
    "text": "there's just one dashboard right there so now what I'm going to do is we have a script that we wrote for demo purposes",
    "start": "1889059",
    "end": "1896530"
  },
  {
    "text": "to make it a little bit easier for you and yeah it's pretty much impossible to see I apologize for that but it's a JSON",
    "start": "1896530",
    "end": "1902830"
  },
  {
    "text": "phone all it's doing is it's going to send that guard duty finding that we talked about at the beginning and it's",
    "start": "1902830",
    "end": "1908290"
  },
  {
    "text": "going to send that finding type with the instance ID as part of that finding into the lambda function that's going to",
    "start": "1908290",
    "end": "1913809"
  },
  {
    "text": "query the Dynamo table it's going to find those five or six entries in the Dynamo table it's going to pull the car",
    "start": "1913809",
    "end": "1919870"
  },
  {
    "text": "watch log insight queries and query the cloud watch login sites it's also going to query a Systems Manager it's going to",
    "start": "1919870",
    "end": "1926140"
  },
  {
    "text": "pull all that information together into a single dashboard right before your very eyes so and we've got 200 SAS code",
    "start": "1926140",
    "end": "1937960"
  },
  {
    "text": "so that's good for me demo gods have been good so far and let me just refresh the page and now look we have a",
    "start": "1937960",
    "end": "1945370"
  },
  {
    "text": "dashboard right here so we click on that dashboard and you can adjust the",
    "start": "1945370",
    "end": "1951670"
  },
  {
    "text": "formatting how you like in the we do this in the Dynamo table right now but these are some things you can do and we",
    "start": "1951670",
    "end": "1957130"
  },
  {
    "text": "have mapped them to the The MITRE IDs so remote access @e 11 33 and 10:59 for",
    "start": "1957130",
    "end": "1963820"
  },
  {
    "text": "example a remote access for mitre so this is looking for flows now you see this is a three hour window right here",
    "start": "1963820",
    "end": "1969910"
  },
  {
    "text": "so that's why you might not show everything so it depends on the time frame that you",
    "start": "1969910",
    "end": "1975430"
  },
  {
    "text": "looking for but one of the great things is you can adjust this right so when you're looking through here you can see",
    "start": "1975430",
    "end": "1981130"
  },
  {
    "text": "that I don't have anything in here for that but I do have some indicators on my instances that make me wonder if",
    "start": "1981130",
    "end": "1986790"
  },
  {
    "text": "something's going on in addition it looks like I have some cloud trail entries where my instance is trying to",
    "start": "1986790",
    "end": "1994420"
  },
  {
    "text": "find out what data it has or what profile it has and trying to get an understanding of what permissions that",
    "start": "1994420",
    "end": "1999580"
  },
  {
    "text": "profile has so to me this is enough of an information to say we need to look a",
    "start": "1999580",
    "end": "2004920"
  },
  {
    "text": "little bit further into this and so you can pass this on here tier two sock operations you can look down here and",
    "start": "2004920",
    "end": "2010350"
  },
  {
    "text": "query or just look even more and luckily so for this they're trying to do list",
    "start": "2010350",
    "end": "2016710"
  },
  {
    "text": "profiles but we use lease privilege so luckily they got denied and they couldn't do that the other thing to know",
    "start": "2016710",
    "end": "2024330"
  },
  {
    "text": "is like I said you can change the time frames right here and then you will end up seeing a little bit different",
    "start": "2024330",
    "end": "2029460"
  },
  {
    "text": "information based on those time frames so now we're getting some 514 traffic",
    "start": "2029460",
    "end": "2034860"
  },
  {
    "text": "that we're seeing in there so this all aggregates the data together so you can look at it from a single place and then",
    "start": "2034860",
    "end": "2040170"
  },
  {
    "text": "when you're done with your figuring out whether or not it's a true positive or a false positive you just delete the",
    "start": "2040170",
    "end": "2045240"
  },
  {
    "text": "dashboard or you can keep it there that's up to you all right so that's one way you can do it the other thing to",
    "start": "2045240",
    "end": "2052080"
  },
  {
    "text": "note that I think is really cool and really powerful is this part right here",
    "start": "2052080",
    "end": "2058040"
  },
  {
    "text": "so the 1060 and the 1060 1083 these two",
    "start": "2058040",
    "end": "2063260"
  },
  {
    "text": "these are the stuff they query from Systems Manager but cloud watcher",
    "start": "2063260",
    "end": "2068399"
  },
  {
    "text": "dashboards has this capability of doing a text widget so these are text widgets",
    "start": "2068400",
    "end": "2073679"
  },
  {
    "text": "versus the log widgets of the other ones from from the BBC flow logs and all that the text widget has this capability of",
    "start": "2073680",
    "end": "2079620"
  },
  {
    "text": "doing a markdown language inside of that text widget so what that really means is that you can query anything in AWS and",
    "start": "2079620",
    "end": "2088460"
  },
  {
    "text": "then you can populate it on a dashboard all right so that's powerful any",
    "start": "2088460",
    "end": "2094080"
  },
  {
    "text": "services that you have if you want to query stuff to find indicators you can do it you could do it for your RDS",
    "start": "2094080",
    "end": "2100050"
  },
  {
    "text": "instances you can do it for your s3 buckets you can do it for your EMR clusters if you can query it which you",
    "start": "2100050",
    "end": "2105420"
  },
  {
    "text": "can everything in API you can pull that text put it the markdown language you have some options for formatting right there's",
    "start": "2105420",
    "end": "2111960"
  },
  {
    "text": "some table formatting and there's some bullets for formatting that kind of stuff but that becomes a very powerful",
    "start": "2111960",
    "end": "2117210"
  },
  {
    "text": "tool and you can also do things like have a click to search and this is going to take you to the systems manager so",
    "start": "2117210",
    "end": "2123150"
  },
  {
    "text": "you can start doing the search we did before to get some more information all right all right so now we're gonna put",
    "start": "2123150",
    "end": "2134640"
  },
  {
    "text": "back to the dashboard so we have two dashboards and I'll go back to the slides please awesome okay so the next",
    "start": "2134640",
    "end": "2147420"
  },
  {
    "text": "one the next one is gonna be the Leviathan there's gonna be some similar areas some differences they have some",
    "start": "2147420",
    "end": "2153060"
  },
  {
    "text": "common things about using folders but this one they also are known to use pasta hash they're known to use things",
    "start": "2153060",
    "end": "2159060"
  },
  {
    "text": "like mimic hats or a crow bolt strike for download tools for example they use",
    "start": "2159060",
    "end": "2165570"
  },
  {
    "text": "PowerShell extensively living off the land to try and obfuscate what they're doing I make it look like it's normal",
    "start": "2165570",
    "end": "2170730"
  },
  {
    "text": "admins that are doing things so these are the indicators of compromise that mitre provides for us and you know we",
    "start": "2170730",
    "end": "2177780"
  },
  {
    "text": "didn't have to do anything to get these mitre did all the work and they're continuing to evolve this work and grow this portfolio of knowledge for all of",
    "start": "2177780",
    "end": "2185400"
  },
  {
    "text": "us to be able to use to improve our security environment so this one again",
    "start": "2185400",
    "end": "2192240"
  },
  {
    "text": "the only difference really with this diagram is going to be two things first is going to be that it's just a",
    "start": "2192240",
    "end": "2198000"
  },
  {
    "text": "different finding type alright so you have the backdoor CNC activities so what that says is that guard duty identified",
    "start": "2198000",
    "end": "2204240"
  },
  {
    "text": "that the traffic do you have going through your environment is communicating with a known command and",
    "start": "2204240",
    "end": "2209460"
  },
  {
    "text": "control server so be aware right so it has threat intelligence capabilities we",
    "start": "2209460",
    "end": "2215610"
  },
  {
    "text": "get intelligence feeds we have whitelists and blacklists we understand the the good and bad IPS are out there so it's a known c2 IP and then it'll",
    "start": "2215610",
    "end": "2223560"
  },
  {
    "text": "give you a finding so this can also often be ending to Leviathan and many",
    "start": "2223560",
    "end": "2229710"
  },
  {
    "text": "many others actually so Leviathan is not the only one but you'll have the guard duty finding type that will go to the",
    "start": "2229710",
    "end": "2236610"
  },
  {
    "text": "cloud watch they will use the cloud watch event to send it to a step phone",
    "start": "2236610",
    "end": "2242310"
  },
  {
    "text": "which was lambda to query the dynamo table which will have I think there's",
    "start": "2242310",
    "end": "2247900"
  },
  {
    "text": "seven or eight of them so there's a few more on this use case versus the other one now the big difference with this one",
    "start": "2247900",
    "end": "2255010"
  },
  {
    "text": "is that it's also going to end up worrying the instances with cloud watch alright so up there we're going to query",
    "start": "2255010",
    "end": "2262450"
  },
  {
    "text": "the PowerShell security I'm sorry the PowerShell logs we're gonna quarry the Windows security logs and we're going to",
    "start": "2262450",
    "end": "2269440"
  },
  {
    "text": "query the system on logs to give you a little bit different perspective and you'll see in a moment when I talk about",
    "start": "2269440",
    "end": "2274570"
  },
  {
    "text": "perspective of what you can see from the VPC flow logs for a remote shell I'm",
    "start": "2274570",
    "end": "2279970"
  },
  {
    "text": "sorry not room yeah to get room at access versus what you see in system on and the ability to identify the",
    "start": "2279970",
    "end": "2286390"
  },
  {
    "text": "differences between the two gives you extra information and then we're going to query Systems Manager for the",
    "start": "2286390",
    "end": "2292810"
  },
  {
    "text": "indicators of the files and registry and then we're going to do the same stuff alright so back to the demo please",
    "start": "2292810",
    "end": "2302490"
  },
  {
    "text": "[Applause]",
    "start": "2313400",
    "end": "2323249"
  },
  {
    "text": "hmm got the demo",
    "start": "2326270",
    "end": "2329810"
  },
  {
    "text": "so I guess they're smart then everybody wants to go have beer now and I'm making you guys wait for an extra ten minutes so I apologize but I think this stuff is",
    "start": "2333230",
    "end": "2339410"
  },
  {
    "text": "cool I hope you do too all right so this one is the Leviathan one so it's just a script like I said that's gonna send the",
    "start": "2339410",
    "end": "2345109"
  },
  {
    "text": "guard duty finding information with a different guard duty finding type that's gonna get sent into the environment so",
    "start": "2345109",
    "end": "2354290"
  },
  {
    "text": "we got 200 again so today must be my lucky day so we're gonna refresh this and then",
    "start": "2354290",
    "end": "2362210"
  },
  {
    "text": "what you'll see is that there's a Leviathan dashboard now so we'll click on the Leviathan dashboard I'm going to",
    "start": "2362210",
    "end": "2368000"
  },
  {
    "text": "just move this up to a day just to make a little bit easier for us and I might",
    "start": "2368000",
    "end": "2374390"
  },
  {
    "text": "have to make it three days let's see so",
    "start": "2374390",
    "end": "2379820"
  },
  {
    "text": "here we have the same kind of information the instance info we have the debug information that there could",
    "start": "2379820",
    "end": "2385310"
  },
  {
    "text": "be suspicious folders in there with a link to go to the SSM environment to do further investigation so right now",
    "start": "2385310",
    "end": "2392630"
  },
  {
    "text": "there's not showing any remote access on five fourteen but what it is showing on",
    "start": "2392630",
    "end": "2398060"
  },
  {
    "text": "this one is sis Mon logs so you might not be seeing anything there but what you're seeing here is you're clearly",
    "start": "2398060",
    "end": "2404690"
  },
  {
    "text": "seeing an indication so PowerShell has the ability to do PowerShell remoting that means you can use PowerShell to",
    "start": "2404690",
    "end": "2409819"
  },
  {
    "text": "remote control or remote access other systems and then be able to get information be able to put information",
    "start": "2409819",
    "end": "2415520"
  },
  {
    "text": "be able to transfer files be able to run scripts all that stuff so what this is showing is 45985 is a PowerShell",
    "start": "2415520",
    "end": "2422450"
  },
  {
    "text": "remoting port so what you're seeing is that there's activity happening in your environment between two instances this",
    "start": "2422450",
    "end": "2428569"
  },
  {
    "text": "might be normal it might not be normal right so that depends on your policy is what you use you know in AWS we often",
    "start": "2428569",
    "end": "2435890"
  },
  {
    "text": "recommend that you shut down all that stuff and end up using a Systems Manager with our sessions manager so you can",
    "start": "2435890",
    "end": "2442490"
  },
  {
    "text": "shut down all the reports and if you see anything going on then you know that's a detection that that's working because it's not supposed to be happening anyhow",
    "start": "2442490",
    "end": "2448810"
  },
  {
    "text": "there's a lot of different ways to do it but just to show you that the other thing is so PowerShell logs so this is",
    "start": "2448810",
    "end": "2456079"
  },
  {
    "text": "cording the PowerShell logs and it's doing a search for everything in the PowerShell logs for anything that says mimic hats it could be cobalt it could be any other",
    "start": "2456079",
    "end": "2462859"
  },
  {
    "text": "indicator of compromise for attacker who is trying to use PowerShell to download some persistence or some",
    "start": "2462859",
    "end": "2472020"
  },
  {
    "text": "malware to continue on with their exploit right so they can use obfuscation as well so they can encode",
    "start": "2472020",
    "end": "2478530"
  },
  {
    "text": "it but this is a way to identify that and you can look into this and then in addition we have the credentials so the",
    "start": "2478530",
    "end": "2486330"
  },
  {
    "text": "pass the hash it shows that there's been a whole bunch of instances with pass a hash and we also have information about",
    "start": "2486330",
    "end": "2493790"
  },
  {
    "text": "getting this profiles all that stuff so the ec2 instance clearly has an issue and this definitely needs to be",
    "start": "2493790",
    "end": "2499440"
  },
  {
    "text": "remediated right so all this information is brought to you automatically just by",
    "start": "2499440",
    "end": "2506280"
  },
  {
    "text": "guard duty doing an event finding type and it's a new way for you to think about how you do security and the cloud",
    "start": "2506280",
    "end": "2511740"
  },
  {
    "text": "for your sock environment and having dashboards that are historical like we showed earlier or near real-time",
    "start": "2511740",
    "end": "2517500"
  },
  {
    "text": "dashboards that are dynamic based on what you're looking for based on the indicators and all the information they",
    "start": "2517500",
    "end": "2523170"
  },
  {
    "text": "have there and I think I have one or two more slides so can I go back to the slides and then we'll get you guys out",
    "start": "2523170",
    "end": "2529470"
  },
  {
    "text": "of here",
    "start": "2529470",
    "end": "2531650"
  },
  {
    "text": "all right yeah so yeah I was gonna go to",
    "start": "2539069",
    "end": "2545920"
  },
  {
    "text": "the reporting but we're just gonna get you out of here because yeah there we go how about that thank you very much I",
    "start": "2545920",
    "end": "2551890"
  },
  {
    "text": "appreciate your time go enjoy your se or your evening thank you [Applause]",
    "start": "2551890",
    "end": "2557889"
  }
]