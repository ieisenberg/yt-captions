[
  {
    "text": "[Music] hi I'm Slaton drainage I'm a senior Solutions Architect for",
    "start": "0",
    "end": "6299"
  },
  {
    "text": "Amazon Web Services and today I'm going to show you how to run sequel always on availability groups on top of Linux",
    "start": "6299",
    "end": "12540"
  },
  {
    "text": "clustering so let's get started so let's first talk about all the options for deploying sequel server on",
    "start": "12540",
    "end": "18930"
  },
  {
    "text": "AWS first managed service soft option by running Amazon RDS for sequel server",
    "start": "18930",
    "end": "25250"
  },
  {
    "text": "means that we take care of everything means that we take care of scaling high",
    "start": "25250",
    "end": "30420"
  },
  {
    "text": "availability database backups DBMS patching install and maintenance as well",
    "start": "30420",
    "end": "36390"
  },
  {
    "text": "as always patching and obviously everything hypervisor and below we do",
    "start": "36390",
    "end": "42750"
  },
  {
    "text": "also you know high level tuning tasks schema optimizations but it's really",
    "start": "42750",
    "end": "48960"
  },
  {
    "text": "ideal if you want to kind of don't have any in-house database expertise you don't have any DBAs they can do this for",
    "start": "48960",
    "end": "55649"
  },
  {
    "text": "you otherwise what's common as well is running single server on Amazon ec2 in",
    "start": "55649",
    "end": "61260"
  },
  {
    "text": "fact right now if you go and type in Google quick start first AWS QuickStart",
    "start": "61260",
    "end": "67530"
  },
  {
    "text": "specifically and first thing that you get or one of the first links will actually take you to a quick start page",
    "start": "67530",
    "end": "72840"
  },
  {
    "text": "and there you can find our sequel QuickStart which will actually deploy full-blown always on availability group",
    "start": "72840",
    "end": "79799"
  },
  {
    "text": "on Windows right and that means that you're going to be really responsible for scaling high availability database",
    "start": "79799",
    "end": "86580"
  },
  {
    "text": "backups DBMS patching install and maintenance and always patching having said that a lot of it actually can be",
    "start": "86580",
    "end": "93329"
  },
  {
    "text": "automated a lot of dispatching and administrator tasks can be automated by means of AWS system manager rest of the",
    "start": "93329",
    "end": "101220"
  },
  {
    "text": "things can be automated as well by means of you know hooking into events and",
    "start": "101220",
    "end": "106229"
  },
  {
    "text": "perhaps using lambda to execute certain tasks and you know automations and so on",
    "start": "106229",
    "end": "112140"
  },
  {
    "text": "if you went ahead and deployed sequel server ec2 on AWS through Quick Start",
    "start": "112140",
    "end": "118250"
  },
  {
    "text": "this is what you're gonna get you're gonna get effectively three node well",
    "start": "118250",
    "end": "123530"
  },
  {
    "text": "effectively it's a two node with the deployment of sequel server always on",
    "start": "123530",
    "end": "129840"
  },
  {
    "text": "availability group it Active Directory you have a choice of having actives are actually deployed as",
    "start": "129840",
    "end": "135690"
  },
  {
    "text": "the main controls on ec2 or using our once again managed service for Microsoft",
    "start": "135690",
    "end": "142560"
  },
  {
    "text": "Active Directory that's AWS directory services for managed Active Directory",
    "start": "142560",
    "end": "147960"
  },
  {
    "text": "this is a full-blown Active Directory you can use and so you can actually you",
    "start": "147960",
    "end": "153210"
  },
  {
    "text": "know at least have that bit managed and provided you know by us if you don't",
    "start": "153210",
    "end": "159480"
  },
  {
    "text": "have or the one don't want the overhead of managing Active Directory in AWS so",
    "start": "159480",
    "end": "166500"
  },
  {
    "text": "and then the third third node being the the file share node that kind of as well",
    "start": "166500",
    "end": "171630"
  },
  {
    "text": "as the witness that kind of does the failover specifically for always-on",
    "start": "171630",
    "end": "176870"
  },
  {
    "text": "synchronous mode right with auto failover this particular set up has also",
    "start": "176870",
    "end": "182520"
  },
  {
    "text": "been kind of a primary approach to us migrating workloads that use sequel",
    "start": "182520",
    "end": "190470"
  },
  {
    "text": "server specifically and those that are they do support always an availability groups so we would effectively extend",
    "start": "190470",
    "end": "198120"
  },
  {
    "text": "always-on availability group over to you know AWS from on-premise or between",
    "start": "198120",
    "end": "204870"
  },
  {
    "text": "regions and then we would have to also extend domain in you know put in another",
    "start": "204870",
    "end": "212910"
  },
  {
    "text": "domain controller and that will also mean that wsf C cluster Windows Server failover cluster would need to be",
    "start": "212910",
    "end": "219000"
  },
  {
    "text": "extended between on-premise n AWS or between two different regions for",
    "start": "219000",
    "end": "224940"
  },
  {
    "text": "example anything the results in larger latency purely by means of the fact that",
    "start": "224940",
    "end": "230630"
  },
  {
    "text": "you know it's it's just you know on that on their distance right on a different",
    "start": "230630",
    "end": "236580"
  },
  {
    "text": "continent to something like that or on a different in a different facility it could be a different cloud or anything like that",
    "start": "236580",
    "end": "241950"
  },
  {
    "text": "coming back to it this this however has not well it's been successful in a lot",
    "start": "241950",
    "end": "249360"
  },
  {
    "text": "of the cases but in some cases customers were kind of complaining that you know they had to extend their Active",
    "start": "249360",
    "end": "255390"
  },
  {
    "text": "Directory as well as the bsfc cluster and the whole thing so thanks to",
    "start": "255390",
    "end": "260519"
  },
  {
    "text": "Microsoft releasing as Server 2016 and 2017 we now have a",
    "start": "260520",
    "end": "268090"
  },
  {
    "text": "distributed availability groups which means that you can have two separate clusters that are running in two",
    "start": "268090",
    "end": "274300"
  },
  {
    "text": "separate environments and they can replicate for one to another and those can be a not separate domain in separate",
    "start": "274300",
    "end": "279639"
  },
  {
    "text": "environment in fact on a separate OS in the case of sequel 2017 you can still we still support to fail",
    "start": "279639",
    "end": "286000"
  },
  {
    "text": "all the cluster instances you're more than welcome to use those you know in back in the days this was a common",
    "start": "286000",
    "end": "291280"
  },
  {
    "text": "scenario I'd have you know with active active nodes active passive the problem",
    "start": "291280",
    "end": "296740"
  },
  {
    "text": "with failover clustering instances is that they only provide failover for Dan for the actual sequel notes not for the",
    "start": "296740",
    "end": "303250"
  },
  {
    "text": "data so should something happen to the data or it gets corrupted or you know it",
    "start": "303250",
    "end": "308590"
  },
  {
    "text": "gets lost you know that that was the problem so thankfully well in the past we would use something like log shipping",
    "start": "308590",
    "end": "315310"
  },
  {
    "text": "or different storage replicas solutions like Windows Server 2016 storage replicas or we have a lot of really",
    "start": "315310",
    "end": "322180"
  },
  {
    "text": "great partners in this area like science data keeper cluster Edition that provides both failover and data",
    "start": "322180",
    "end": "329830"
  },
  {
    "text": "replication for failover clustering instances so this is kind of a picture of how it all kind of comes together",
    "start": "329830",
    "end": "335979"
  },
  {
    "text": "I I mentioned you know options of you know either managed service for",
    "start": "335979",
    "end": "341700"
  },
  {
    "text": "always-on availability or rather you know for sequel server fully available",
    "start": "341700",
    "end": "347410"
  },
  {
    "text": "fully fully resilient in a with and fully managed rather also an option of",
    "start": "347410",
    "end": "353500"
  },
  {
    "text": "you know deploying Active Directory or using our managed active directory service and how that kind of works in",
    "start": "353500",
    "end": "360880"
  },
  {
    "text": "the context of the rest of the AWS services and takes advantage of in",
    "start": "360880",
    "end": "366340"
  },
  {
    "text": "applications that are using it can take advantage of things like external antenna load balancers application load",
    "start": "366340",
    "end": "371800"
  },
  {
    "text": "balancers web application firewalls cloud fronts",
    "start": "371800",
    "end": "376960"
  },
  {
    "text": "you know our CDN distributions dns auto scaling services and and various other",
    "start": "376960",
    "end": "384760"
  },
  {
    "text": "you know DevOps development and CDC our deployment services as well as you know config system manager and other",
    "start": "384760",
    "end": "391870"
  },
  {
    "text": "compliance services for you know encrypt and so on and so forth why do we choose",
    "start": "391870",
    "end": "399790"
  },
  {
    "text": "and why do we want to actually deploy this on Linux so I mentioned to you earlier that you know Microsoft has come",
    "start": "399790",
    "end": "406810"
  },
  {
    "text": "up with sequel server 2017 that's specific specific SKU of sequel",
    "start": "406810",
    "end": "415560"
  },
  {
    "text": "basically allowed sequel to be deployed on Linux great thing about sequel being",
    "start": "415560",
    "end": "420910"
  },
  {
    "text": "deployed on Linux is that you know you don't have to worry about the cost of running a Windows operating system it",
    "start": "420910",
    "end": "428290"
  },
  {
    "text": "also you know that would that meant actually significant savings it also",
    "start": "428290",
    "end": "433419"
  },
  {
    "text": "meant that you know for any customer that had in a significant investment in",
    "start": "433419",
    "end": "439450"
  },
  {
    "text": "open source could actually take advantage of that of their familiar environment but it also provides a",
    "start": "439450",
    "end": "446289"
  },
  {
    "text": "familiar environment for any existing Windows users on how they can use in a",
    "start": "446289",
    "end": "453940"
  },
  {
    "text": "sequel server pretty much the same way they've used it before just runs on a on a different operating system and in the",
    "start": "453940",
    "end": "460720"
  },
  {
    "text": "in a case of always an availability groups it runs on a different clustering technology so in this case specifically",
    "start": "460720",
    "end": "468940"
  },
  {
    "text": "it uses pacemaker and we're going to go through an example of Ubuntu running",
    "start": "468940",
    "end": "474610"
  },
  {
    "text": "secret server with pacemaker and then creating a pacemaker cluster as well as cleaning always on availability group",
    "start": "474610",
    "end": "481030"
  },
  {
    "text": "and then and in a example of how we can fail over from one to another and the",
    "start": "481030",
    "end": "486250"
  },
  {
    "text": "whole thing another exciting thing is because of the distributed always in availability groups we can actually have",
    "start": "486250",
    "end": "494500"
  },
  {
    "text": "different clusters of different kinds replicating to one another so we can have a or zone availability group that",
    "start": "494500",
    "end": "501430"
  },
  {
    "text": "runs on a wsf C cluster and that replicates to another cluster that uses",
    "start": "501430",
    "end": "508030"
  },
  {
    "text": "the runs on top of Linux and takes advantage of pacemaker clustering right",
    "start": "508030",
    "end": "514000"
  },
  {
    "text": "and then those two can replicate between another one another create you know making it basically compliant with",
    "start": "514000",
    "end": "522219"
  },
  {
    "text": "running in bird in a scenarios and environments between Windows and Linux and more",
    "start": "522219",
    "end": "529630"
  },
  {
    "text": "importantly you can you now have a third option as well of running sending a AG",
    "start": "529630",
    "end": "535840"
  },
  {
    "text": "cluster type to none that actually can replicate between one server to another",
    "start": "535840",
    "end": "542490"
  },
  {
    "text": "which actually means that the language can replicate Williams box Linux sequel",
    "start": "542490",
    "end": "548470"
  },
  {
    "text": "instance can app replicate to another little see the signal instance but so can Windows Server sequel instance",
    "start": "548470",
    "end": "554050"
  },
  {
    "text": "replicate to another link Linux instance or Windows instance itself without the need of the cluster being",
    "start": "554050",
    "end": "559990"
  },
  {
    "text": "configured so that's very exciting it gives us a lot of options makes a lot of",
    "start": "559990",
    "end": "565290"
  },
  {
    "text": "customers very happy and makes a lot of things easy especially when it comes to compliance in with various teams on our",
    "start": "565290",
    "end": "573550"
  },
  {
    "text": "customer side so we're gonna move on to the demo so here we are in a console",
    "start": "573550",
    "end": "579460"
  },
  {
    "text": "we're gonna go over to our ec2 console and we're gonna run some instances",
    "start": "579460",
    "end": "588610"
  },
  {
    "text": "specifically let's go ahead and launch the ready-mades amis a mais with actual",
    "start": "588610",
    "end": "597720"
  },
  {
    "text": "sequel service so if we actually go ahead and search it up here you will see",
    "start": "597720",
    "end": "605260"
  },
  {
    "text": "that we have one two server which equals service standard over here so we're gonna go select this guy over and then",
    "start": "605260",
    "end": "612190"
  },
  {
    "text": "we're gonna choose us an instance top that is commonly being used for sequel",
    "start": "612190",
    "end": "617710"
  },
  {
    "text": "service so we're going to go with memory optimized I guess are five extra large",
    "start": "617710",
    "end": "623800"
  },
  {
    "text": "is fine and then we're gonna go ahead and here it's gonna actually deploy",
    "start": "623800",
    "end": "629790"
  },
  {
    "text": "these the sequel server in default V PC of something I would suggest but you",
    "start": "629790",
    "end": "636970"
  },
  {
    "text": "know for demo purposes here we are and to make things faster we're gonna say deploy three instances because we're",
    "start": "636970",
    "end": "644020"
  },
  {
    "text": "going to create a three node cluster over here to achieve full quorum fully",
    "start": "644020",
    "end": "651250"
  },
  {
    "text": "synchronous cluster and then we're going to go over and we're gonna specify what what we want to use for storage and",
    "start": "651250",
    "end": "661200"
  },
  {
    "text": "I'm going to say 500 gigs just to be on the safe side and then we're gonna go",
    "start": "661200",
    "end": "666510"
  },
  {
    "text": "and add some tags specifically when I add a name tag so you can I can find it easily and I'm gonna call it sequel",
    "start": "666510",
    "end": "674780"
  },
  {
    "text": "Linux AG note 1 so I'll just call it a",
    "start": "674780",
    "end": "685320"
  },
  {
    "text": "note then we're gonna give it a name after so it's just going to do this in triplicate for me and here I can",
    "start": "685320",
    "end": "690930"
  },
  {
    "text": "actually specify Susi this is kind of smart enough over here to figure out that you know on a need Ms equal port",
    "start": "690930",
    "end": "697830"
  },
  {
    "text": "open I did create a security group prior to this there are several ports that need to be open so we're gonna go over",
    "start": "697830",
    "end": "705180"
  },
  {
    "text": "and we're gonna select this security group you don't see you I'll show you",
    "start": "705180",
    "end": "710360"
  },
  {
    "text": "exactly what I got here so as you can see in addition to a mass equal open I",
    "start": "710360",
    "end": "716160"
  },
  {
    "text": "got this UDP port TCP port yeah",
    "start": "716160",
    "end": "721500"
  },
  {
    "text": "fifty four or five 22 24 in additional vc to ssh 31 21 21 or 64 and 50 22 we're",
    "start": "721500",
    "end": "732900"
  },
  {
    "text": "gonna go on and review and launch this and once it's launching we need to select a key pair that we're going to be",
    "start": "732900",
    "end": "739230"
  },
  {
    "text": "using knowledge that this will this is",
    "start": "739230",
    "end": "746910"
  },
  {
    "text": "going to be used as an access to one instances and then we're going to take a look at our instances so now they are",
    "start": "746910",
    "end": "755690"
  },
  {
    "text": "being built now that we have these three sequel instances created now we're going",
    "start": "755690",
    "end": "763530"
  },
  {
    "text": "to go ahead and connect to its here it already created a connection string for",
    "start": "763530",
    "end": "768900"
  },
  {
    "text": "us we're going to go to here we go it's",
    "start": "768900",
    "end": "774780"
  },
  {
    "text": "already in and we're going to name rename these guys quickly so we can tell",
    "start": "774780",
    "end": "780840"
  },
  {
    "text": "them apart it's going to be one two and REE so right now the way I you know",
    "start": "780840",
    "end": "791670"
  },
  {
    "text": "deploy them on just deployed them very quickly you know they all deployed here in the same availability zone obviously",
    "start": "791670",
    "end": "797610"
  },
  {
    "text": "you will be deploying them in separate availability zones and we're gonna go quickly and and then the third and last",
    "start": "797610",
    "end": "805140"
  },
  {
    "text": "instance is be in a third tab so let's",
    "start": "805140",
    "end": "813330"
  },
  {
    "text": "select this guy go back to a bash and here we are so right now now we are in",
    "start": "813330",
    "end": "821160"
  },
  {
    "text": "three different instances over here logged in so first things first we don't",
    "start": "821160",
    "end": "826440"
  },
  {
    "text": "need to actually do this this is in case you do run a separate you know top of",
    "start": "826440",
    "end": "832160"
  },
  {
    "text": "open to instance that might be running the firewall then you would actually go",
    "start": "832160",
    "end": "838290"
  },
  {
    "text": "ahead and run these this these scripts",
    "start": "838290",
    "end": "843660"
  },
  {
    "text": "to actually open up these specific ports and these are the ports that are shows you earlier on that we have opened up in",
    "start": "843660",
    "end": "850950"
  },
  {
    "text": "our security group right once you're done opening up the ports you need to reload the firewall and then",
    "start": "850950",
    "end": "858930"
  },
  {
    "text": "it would be fine so we'll just we'll just set this thing up the firewall is not running at this point so that's fine",
    "start": "858930",
    "end": "866540"
  },
  {
    "text": "but you know just to show you how that actually runs over and then you can also",
    "start": "866540",
    "end": "872940"
  },
  {
    "text": "alternatively can disable the firewall yourself and it's quite easily you know you just go to the UFW disable and then",
    "start": "872940",
    "end": "881760"
  },
  {
    "text": "we re gonna run a sudo apt-get updates make sure that our instance is updated",
    "start": "881760",
    "end": "889410"
  },
  {
    "text": "now having said that you if you're using RM eyes they mostly up-to-date but me",
    "start": "889410",
    "end": "898020"
  },
  {
    "text": "nah we always run it just in case and then we going to go ahead and install",
    "start": "898020",
    "end": "903290"
  },
  {
    "text": "pacemaker we're gonna install pacemaker packages right that's gonna be our",
    "start": "903290",
    "end": "909270"
  },
  {
    "text": "clustering technology for our sequel so I'm gonna say yes",
    "start": "909270",
    "end": "915089"
  },
  {
    "text": "and we're gonna store pacemaker on all three notes now we're gonna go on this",
    "start": "915089",
    "end": "920100"
  },
  {
    "text": "one and then third and last one okay so",
    "start": "920100",
    "end": "931439"
  },
  {
    "text": "all this is going looks like it finished on the first one two more to go pretty",
    "start": "931439",
    "end": "936959"
  },
  {
    "text": "much done great stuff now we're gonna set a password for our default user and",
    "start": "936959",
    "end": "946309"
  },
  {
    "text": "on all three nodes specifically for pacemaker so this is a my test password",
    "start": "946309",
    "end": "960019"
  },
  {
    "text": "and you can make it over you see whatever you want what is successful all",
    "start": "960019",
    "end": "985920"
  },
  {
    "text": "of them this is very pretty quick now we need to actually enable and start our",
    "start": "985920",
    "end": "992129"
  },
  {
    "text": "pacemaker services so we're gonna casually run that once again on all of",
    "start": "992129",
    "end": "999209"
  },
  {
    "text": "the nodes and it looks like we were successful executing it and every single",
    "start": "999209",
    "end": "1005600"
  },
  {
    "text": "node not how quickly these things are happening right they are they are a lot of moving pieces that's true but they're",
    "start": "1005600",
    "end": "1013160"
  },
  {
    "text": "fairly quick as well and now the next thing is we going to create a cluster",
    "start": "1013160",
    "end": "1018230"
  },
  {
    "text": "bear in mind what I'm doing here in the scripts that I'm using I'm actually destroying any existing cluster so in",
    "start": "1018230",
    "end": "1024558"
  },
  {
    "text": "case you have created a cluster before this script is actually going to destroy the cluster in order to create a new new",
    "start": "1024559",
    "end": "1030709"
  },
  {
    "text": "one so here we are I don't have any there's a brand new instance as you saw",
    "start": "1030709",
    "end": "1036350"
  },
  {
    "text": "me create so I'm from our primary node now we can actually go first of all run",
    "start": "1036350",
    "end": "1042130"
  },
  {
    "text": "cluster authentication for pacemaker and in this case we actually need to look at",
    "start": "1042130",
    "end": "1048790"
  },
  {
    "text": "the instances we created so what we need to look at is our Public DNS in this case or DNS entries that we have",
    "start": "1048790",
    "end": "1055360"
  },
  {
    "text": "assigned to our nodes right so obviously doesn't even have to be public and we wouldn't want them to be but they happen",
    "start": "1055360",
    "end": "1061600"
  },
  {
    "text": "to be in this particular case so here we",
    "start": "1061600",
    "end": "1067150"
  },
  {
    "text": "are so this is this happens to be the",
    "start": "1067150",
    "end": "1084730"
  },
  {
    "text": "the password that I was using so just specify password and the cluster that",
    "start": "1084730",
    "end": "1089830"
  },
  {
    "text": "I've created and then I specify which which servers need to be part of the",
    "start": "1089830",
    "end": "1095080"
  },
  {
    "text": "cluster so we're gonna go ahead and select this and we can run this on a on",
    "start": "1095080",
    "end": "1100090"
  },
  {
    "text": "a primary cluster node which I'm gonna be the first one so they've been all",
    "start": "1100090",
    "end": "1108280"
  },
  {
    "text": "authorized which is great and to make things quicker we're gonna just pre",
    "start": "1108280",
    "end": "1114700"
  },
  {
    "text": "select these guys and we're gonna run a",
    "start": "1114700",
    "end": "1122970"
  },
  {
    "text": "setup for a cluster set up that we're",
    "start": "1122970",
    "end": "1128830"
  },
  {
    "text": "gonna name a g1 okay so here we are",
    "start": "1128830",
    "end": "1134310"
  },
  {
    "text": "you're gonna run our cluster setup again this can run on the primary node and",
    "start": "1134310",
    "end": "1141840"
  },
  {
    "text": "here we are for our next thing we're",
    "start": "1141840",
    "end": "1147040"
  },
  {
    "text": "going to say hey start a cluster on all",
    "start": "1147040",
    "end": "1152310"
  },
  {
    "text": "and and then enable it - and you can see",
    "start": "1152310",
    "end": "1161320"
  },
  {
    "text": "it enabled it for every single node which is exactly what we wanted so like I said you can actually run it true so",
    "start": "1161320",
    "end": "1169090"
  },
  {
    "text": "next thing we need to configure fencing so basically pacemaker cluster vendors",
    "start": "1169090",
    "end": "1174700"
  },
  {
    "text": "right they require stun if this is if you've worked with pacemaker before you would know you would probably have some",
    "start": "1174700",
    "end": "1181330"
  },
  {
    "text": "experience with it it needs to be enabled and fencing device need to be needs to be configured",
    "start": "1181330",
    "end": "1186970"
  },
  {
    "text": "to support to support it cluster setup so when the resource manager cannot",
    "start": "1186970",
    "end": "1192639"
  },
  {
    "text": "determine the state of a node or resource fencing is used to them bring the cluster to a known state again so",
    "start": "1192639",
    "end": "1200970"
  },
  {
    "text": "and it's mainly day to kind of prevent data corruption and other things so",
    "start": "1200970",
    "end": "1206350"
  },
  {
    "text": "we're gonna go ahead and run basically it because because I disabled for for",
    "start": "1206350",
    "end": "1213190"
  },
  {
    "text": "this test purposes stone if and and it",
    "start": "1213190",
    "end": "1218200"
  },
  {
    "text": "can just be run on the primary node normally in production you wouldn't disable it you would make sure that it's",
    "start": "1218200",
    "end": "1223570"
  },
  {
    "text": "enabled we can also set our property cluster recheck interval specifically",
    "start": "1223570",
    "end": "1229389"
  },
  {
    "text": "every two minutes once again that's in and that also you can set on your",
    "start": "1229389",
    "end": "1235090"
  },
  {
    "text": "primary mode and then if you if you",
    "start": "1235090",
    "end": "1241119"
  },
  {
    "text": "already have an availability group resource management pacemaker cluster you know all note that all distributions",
    "start": "1241119",
    "end": "1248919"
  },
  {
    "text": "that use the latest available pacemaker package introduce the behavior change",
    "start": "1248919",
    "end": "1254049"
  },
  {
    "text": "for the star failure is fates are cluster setting when it's set to false",
    "start": "1254049",
    "end": "1259570"
  },
  {
    "text": "so there are some gotchas to just make sure and you know set it to true and",
    "start": "1259570",
    "end": "1266919"
  },
  {
    "text": "update your existing AG resource property you know to like 60 second",
    "start": "1266919",
    "end": "1273940"
  },
  {
    "text": "timeouts fight failure timeouts to check",
    "start": "1273940",
    "end": "1278980"
  },
  {
    "text": "on that so those are some of the options that you can have we can actually go",
    "start": "1278980",
    "end": "1285039"
  },
  {
    "text": "ahead and and set that up so we're going to stop the serb the sequel server on",
    "start": "1285039",
    "end": "1290889"
  },
  {
    "text": "all three nodes first and then what",
    "start": "1290889",
    "end": "1297580"
  },
  {
    "text": "we're going to do is going going to set the SI password make sure",
    "start": "1297580",
    "end": "1304760"
  },
  {
    "text": "type this right okay so now we can",
    "start": "1304760",
    "end": "1314090"
  },
  {
    "text": "actually go ahead and start the server over here so literally just go ahead and",
    "start": "1314090",
    "end": "1322100"
  },
  {
    "text": "run it so while it's running we also",
    "start": "1322100",
    "end": "1331910"
  },
  {
    "text": "want to be able to actually use use our sequel tools so we want to we want to",
    "start": "1331910",
    "end": "1339470"
  },
  {
    "text": "run some of the some of the sequel statements as part of kind of creating",
    "start": "1339470",
    "end": "1346220"
  },
  {
    "text": "and setting up a password for pacemaker and how kind of pacemaker is going to",
    "start": "1346220",
    "end": "1352250"
  },
  {
    "text": "control what sequel does and later on also for creating the actual with no availability group and all things so in",
    "start": "1352250",
    "end": "1360350"
  },
  {
    "text": "order to do so we will there are a couple of steps around this and this is",
    "start": "1360350",
    "end": "1367760"
  },
  {
    "text": "also noted if you're running this is not necessarily going to change anything",
    "start": "1367760",
    "end": "1373910"
  },
  {
    "text": "but this is if you if you for example are running in a one two instance that does not have sequel installed on it you",
    "start": "1373910",
    "end": "1380870"
  },
  {
    "text": "can also go ahead and use that to",
    "start": "1380870",
    "end": "1386200"
  },
  {
    "text": "install sequel so this is a quick some quick commands to show you on how you",
    "start": "1386200",
    "end": "1392420"
  },
  {
    "text": "can effectively install and run so we're",
    "start": "1392420",
    "end": "1401420"
  },
  {
    "text": "going to quickly do the same over here for the other nodes [Music]",
    "start": "1401420",
    "end": "1417970"
  },
  {
    "text": "and then we're going to run suit update update and installation so the next",
    "start": "1417970",
    "end": "1432980"
  },
  {
    "text": "thing we're going to do once this is",
    "start": "1432980",
    "end": "1438290"
  },
  {
    "text": "over we need to install MS sequel server high availability so we're going to let",
    "start": "1438290",
    "end": "1449120"
  },
  {
    "text": "that work and then in order to like I said earlier to execute those sequel",
    "start": "1449120",
    "end": "1456260"
  },
  {
    "text": "commands we will need to install MS sequel tools as well as sequel CMD tool",
    "start": "1456260",
    "end": "1464990"
  },
  {
    "text": "are we going to be using so we're gonna first run these GP you get these UPG",
    "start": "1464990",
    "end": "1472400"
  },
  {
    "text": "keys and then we're gonna curl this",
    "start": "1472400",
    "end": "1479080"
  },
  {
    "text": "we're gonna register the microsoft ubuntu repository then we're gonna go",
    "start": "1479080",
    "end": "1486560"
  },
  {
    "text": "ahead and install the tools and then",
    "start": "1486560",
    "end": "1495560"
  },
  {
    "text": "we're gonna run an update just in case",
    "start": "1495560",
    "end": "1501080"
  },
  {
    "text": "so we're going to repeat all of this for the other nodes in case we want to run",
    "start": "1501080",
    "end": "1507860"
  },
  {
    "text": "thing run things from there to 3s accept",
    "start": "1507860",
    "end": "1518480"
  },
  {
    "text": "and the license terms yes we do and then",
    "start": "1518480",
    "end": "1524150"
  },
  {
    "text": "the last but not least register tree",
    "start": "1524150",
    "end": "1530690"
  },
  {
    "text": "over here and then run the same and then",
    "start": "1530690",
    "end": "1539030"
  },
  {
    "text": "over here what we didn't run this another update and I'm a sequel to tools",
    "start": "1539030",
    "end": "1547480"
  },
  {
    "text": "already installed already newest version we checked everything made sure now",
    "start": "1549100",
    "end": "1555860"
  },
  {
    "text": "we're gonna go ahead and from our primary node we're gonna select we're gonna connect to the local host this is",
    "start": "1555860",
    "end": "1565100"
  },
  {
    "text": "a common thing pay no heed it's just a",
    "start": "1565100",
    "end": "1570700"
  },
  {
    "text": "way I'm copying from it's copying the wrong inverted commas and here we are we",
    "start": "1570700",
    "end": "1578540"
  },
  {
    "text": "are in our sequel CMD tool in there we're going we're gonna go switch over",
    "start": "1578540",
    "end": "1584270"
  },
  {
    "text": "to master here we up and then we're",
    "start": "1584270",
    "end": "1592490"
  },
  {
    "text": "gonna create a login for pacemaker then",
    "start": "1592490",
    "end": "1598990"
  },
  {
    "text": "and off the server role to add it once",
    "start": "1598990",
    "end": "1607480"
  },
  {
    "text": "that is done we can actually exit so",
    "start": "1607480",
    "end": "1614420"
  },
  {
    "text": "we're gonna go ahead and create the credentials and have them saved both the",
    "start": "1614420",
    "end": "1619430"
  },
  {
    "text": "M which will be only readable by route [Music]",
    "start": "1619430",
    "end": "1630460"
  },
  {
    "text": "so then we're gonna go ahead and create",
    "start": "1630460",
    "end": "1636309"
  },
  {
    "text": "the AG resource availability group resource we already created it that's a",
    "start": "1636309",
    "end": "1647149"
  },
  {
    "text": "good error we got and then we need to set what virtual IP that is going to be",
    "start": "1647149",
    "end": "1654289"
  },
  {
    "text": "used so we need to make sure that this is an unused IP specifically so looking",
    "start": "1654289",
    "end": "1660440"
  },
  {
    "text": "at what IP is we have available I want to use a private IP I guess 120 is not",
    "start": "1660440",
    "end": "1668119"
  },
  {
    "text": "the used one so let's see here so make",
    "start": "1668119",
    "end": "1674119"
  },
  {
    "text": "sure when you do create a virtual IP there's the IP it is available and it's unused specifically then we can add",
    "start": "1674119",
    "end": "1683470"
  },
  {
    "text": "collocation constraints almost every decision in a pacemaker cluster like",
    "start": "1683470",
    "end": "1691789"
  },
  {
    "text": "choosing where research would run is done by comparing scores so scores are calculated per resource and the cluster",
    "start": "1691789",
    "end": "1698929"
  },
  {
    "text": "resource manager chooses the node with a highest score for a particular resource so if a node has a negative score for",
    "start": "1698929",
    "end": "1704720"
  },
  {
    "text": "resource the resource cannot run on that node use constraints to configure the",
    "start": "1704720",
    "end": "1710840"
  },
  {
    "text": "decision of the cluster constraints have a score so if constraint has a lower",
    "start": "1710840",
    "end": "1716480"
  },
  {
    "text": "score than the infinity it is only a recommendation so we're gonna go ahead",
    "start": "1716480",
    "end": "1722269"
  },
  {
    "text": "and set the collocation so to ensure that primary replicas and the virtual IP",
    "start": "1722269",
    "end": "1729139"
  },
  {
    "text": "reese's on the same house we're gonna define a collocation constraint",
    "start": "1729139",
    "end": "1734499"
  },
  {
    "text": "collocation constraint with a score infinity so here we are and then we can",
    "start": "1734499",
    "end": "1743389"
  },
  {
    "text": "also add a ordering constraint so the collocation constraint has an implicit",
    "start": "1743389",
    "end": "1748700"
  },
  {
    "text": "ordering constraint it moves the virtual IP recess before it moves the availability group resource so by",
    "start": "1748700",
    "end": "1753830"
  },
  {
    "text": "default the sequence of events is the user issues a PCEs resource move the virtual IP resource",
    "start": "1753830",
    "end": "1761000"
  },
  {
    "text": "stops the node 1 and then it starts the node 2 and then the primary node 1 gets",
    "start": "1761000",
    "end": "1766490"
  },
  {
    "text": "demoted and then no 2 gets promoted so we're now going to create an ordering",
    "start": "1766490",
    "end": "1773480"
  },
  {
    "text": "constraint specifically or for this",
    "start": "1773480",
    "end": "1779120"
  },
  {
    "text": "virtual IP and this has actually set up our cluster completely now we have a",
    "start": "1779120",
    "end": "1786740"
  },
  {
    "text": "fully working cluster that we can now manage and and obviously you know",
    "start": "1786740",
    "end": "1793190"
  },
  {
    "text": "there's there are constraints that we have set up on how this cluster is going to failover but that also doesn't stop",
    "start": "1793190",
    "end": "1800510"
  },
  {
    "text": "us from manually failing over so we can go ahead and let's say we want to",
    "start": "1800510",
    "end": "1806300"
  },
  {
    "text": "failover - no - we can then select that over here I want to replace and replace",
    "start": "1806300",
    "end": "1817550"
  },
  {
    "text": "the value for node 2 and then we're going to select it over here and run it",
    "start": "1817550",
    "end": "1823220"
  },
  {
    "text": "and this will actually go ahead and start switching the resource and",
    "start": "1823220",
    "end": "1828470"
  },
  {
    "text": "demoting the primary node to the secondary and promoting the second node",
    "start": "1828470",
    "end": "1833510"
  },
  {
    "text": "to the primary one and this will also instruct their always-on availability group to actually start switching over",
    "start": "1833510",
    "end": "1841010"
  },
  {
    "text": "and that's one of the things that I want to go back to my slide deck I don't want",
    "start": "1841010",
    "end": "1848450"
  },
  {
    "text": "to talk to you about what to do next you need to we need to first create a certificate that is going to be used and",
    "start": "1848450",
    "end": "1854720"
  },
  {
    "text": "then we need to create the certificate on secondary service as well there are",
    "start": "1854720",
    "end": "1860390"
  },
  {
    "text": "going to be used once the certificates are created then we need to create a",
    "start": "1860390",
    "end": "1866720"
  },
  {
    "text": "database mirroring endpoints on all replicas so these are going to be you",
    "start": "1866720",
    "end": "1872240"
  },
  {
    "text": "know basic endpoints on what pores are going to be listening to on each and",
    "start": "1872240",
    "end": "1878330"
  },
  {
    "text": "every replica within it and then once that is done once we have the listening points once we do have certificates in",
    "start": "1878330",
    "end": "1884510"
  },
  {
    "text": "place we can create an availability group and now we have a fully",
    "start": "1884510",
    "end": "1890080"
  },
  {
    "text": "availability group that actually synchronously replicates data between each node once that is done then we can",
    "start": "1890080",
    "end": "1898850"
  },
  {
    "text": "create a database and and then add it to",
    "start": "1898850",
    "end": "1904700"
  },
  {
    "text": "the availability group that we have the next step really would be just to check we're out run a select statement to",
    "start": "1904700",
    "end": "1910970"
  },
  {
    "text": "check if the the the actual database has",
    "start": "1910970",
    "end": "1916610"
  },
  {
    "text": "been replicated to other replicas and run it against it once that is done you",
    "start": "1916610",
    "end": "1921770"
  },
  {
    "text": "basically have a fully synchronous three node cluster that runs across full-blown",
    "start": "1921770",
    "end": "1929660"
  },
  {
    "text": "pacemaker cluster that we just configured and got it to work with with",
    "start": "1929660",
    "end": "1935930"
  },
  {
    "text": "sequel specifically which you can which will failover based on score and based",
    "start": "1935930",
    "end": "1941390"
  },
  {
    "text": "on constraints that we have defined as well as we will be able to manage it and manually failover if necessary for",
    "start": "1941390",
    "end": "1948530"
  },
  {
    "text": "whatever reason but now you should know how to run see queries on availability groups on Linux clusters try it for",
    "start": "1948530",
    "end": "1955040"
  },
  {
    "text": "yourself thank you for watching [Music]",
    "start": "1955040",
    "end": "1961190"
  }
]