[
  {
    "start": "0",
    "end": "42000"
  },
  {
    "text": "hi uh thank you for being here today uh last session so thank you very much for",
    "start": "4319",
    "end": "9679"
  },
  {
    "text": "sticking it out and making it to uh to the very end my name is andrew shea i",
    "start": "9679",
    "end": "16960"
  },
  {
    "text": "run the operations team at swagbug and today i'm going to talk about how we migrated our web serving and entire database",
    "start": "16960",
    "end": "24400"
  },
  {
    "text": "infrastructure into aws and what we learned in the process i'll be happy to take any questions",
    "start": "24400",
    "end": "30560"
  },
  {
    "text": "during the talk or or afterwards um we can make it a little informal since uh",
    "start": "30560",
    "end": "35680"
  },
  {
    "text": "since this is the very last talk here at re invent",
    "start": "35680",
    "end": "40399"
  },
  {
    "start": "42000",
    "end": "115000"
  },
  {
    "text": "so smug mug who are we um you've probably heard of us from uh some of the aws uh",
    "start": "42079",
    "end": "49360"
  },
  {
    "text": "uh earlier talks and like our keynote video things like that anyway we're a team of",
    "start": "49360",
    "end": "55280"
  },
  {
    "text": "over 100 superheroes as you see in this photo here who run a premium photo and video",
    "start": "55280",
    "end": "61520"
  },
  {
    "text": "sharing service uh for millions of our customers ranging anywhere from you know",
    "start": "61520",
    "end": "66720"
  },
  {
    "text": "amateur photographers hobbyists families and up to pro photographers who run",
    "start": "66720",
    "end": "72000"
  },
  {
    "text": "their businesses through us as a premium service rather than a free one",
    "start": "72000",
    "end": "77200"
  },
  {
    "text": "the main challenge we face is how to serve our customers very high needs for",
    "start": "77200",
    "end": "83280"
  },
  {
    "text": "serving photos very quickly we serve billions of photos and videos and we have to get them out as fast as possible",
    "start": "83280",
    "end": "89439"
  },
  {
    "text": "to provide them with the best possible experience so",
    "start": "89439",
    "end": "94880"
  },
  {
    "text": "you may have heard of us from the new smug bug which we released in july",
    "start": "94880",
    "end": "100640"
  },
  {
    "text": "and also we have a very popular camera app called camera awesome",
    "start": "100640",
    "end": "105920"
  },
  {
    "text": "which is uh out for ios and recently for android so that's us",
    "start": "105920",
    "end": "114280"
  },
  {
    "text": "in the early days of smog mug well we're a bootstrap company which means that all the money that the company earned went",
    "start": "114880",
    "end": "121280"
  },
  {
    "start": "115000",
    "end": "192000"
  },
  {
    "text": "back into it and uh that that's that kind of bootstrap growth leads to interesting problems",
    "start": "121280",
    "end": "127759"
  },
  {
    "text": "which i'll talk about part of this complexity is having multiple self-managed data center cages",
    "start": "127759",
    "end": "134800"
  },
  {
    "text": "so when you when you grow in that fashion you rent out a small data center cage and then you grow you might get a",
    "start": "134800",
    "end": "141120"
  },
  {
    "text": "different cage and you have all these things to manage the other part about bootstrap growth is",
    "start": "141120",
    "end": "147120"
  },
  {
    "text": "that you end up with lots of different server types and you know building over the years you you just obtain this as",
    "start": "147120",
    "end": "154160"
  },
  {
    "text": "time goes on you get better servers but you keep the old ones around and uh it becomes complicated",
    "start": "154160",
    "end": "160640"
  },
  {
    "text": "and finally since uh smog mug is a photo site uh there are a huge number of disks",
    "start": "160640",
    "end": "165680"
  },
  {
    "text": "there were a huge number of disks involved and those are just a growing growing and",
    "start": "165680",
    "end": "171200"
  },
  {
    "text": "growing and the worst part about all this uh is we have uh employees like uh strongbed",
    "start": "171200",
    "end": "178000"
  },
  {
    "text": "here uh spending valuable time you know just working in data center cages doing work like racking and",
    "start": "178000",
    "end": "184640"
  },
  {
    "text": "networking and that's not really uh what our business focus is",
    "start": "184640",
    "end": "190400"
  },
  {
    "text": "so data center fantasy is something i call what we see at conferences a lot of",
    "start": "191920",
    "end": "197360"
  },
  {
    "start": "192000",
    "end": "252000"
  },
  {
    "text": "times we see google facebook yahoo they show off these great custom data center",
    "start": "197360",
    "end": "202640"
  },
  {
    "text": "designs where everything's perfectly laid out all their cages look great",
    "start": "202640",
    "end": "208080"
  },
  {
    "text": "their cabling looks something like this so that's that's this great model i",
    "start": "208080",
    "end": "214239"
  },
  {
    "text": "really like it because i used to be a civil engineer so i'm really impressed by all their construction",
    "start": "214239",
    "end": "220239"
  },
  {
    "text": "and um so they do a great job so this is a uh this is actually a photo i took of a",
    "start": "220239",
    "end": "227280"
  },
  {
    "text": "cray supercomputer and these are actually cooling tubes of florin art um",
    "start": "227280",
    "end": "233439"
  },
  {
    "text": "some go goes in the hot side and comes out the coal side goes in the other way",
    "start": "233439",
    "end": "239439"
  },
  {
    "text": "but what if you're not big enough for for an entire data center what if you don't have all this great technology to build your own data center",
    "start": "239439",
    "end": "246000"
  },
  {
    "text": "well what you end up is you have data center reality",
    "start": "246000",
    "end": "251200"
  },
  {
    "text": "and this is what data center realities can look like this is an actual photo from one of our data",
    "start": "251200",
    "end": "258400"
  },
  {
    "start": "252000",
    "end": "397000"
  },
  {
    "text": "center cages growing a data center gradually like we",
    "start": "258400",
    "end": "263840"
  },
  {
    "text": "did it means you accumulate a mass of physical debt uh you like i said before you gain all",
    "start": "263840",
    "end": "270639"
  },
  {
    "text": "this hardware that you don't really want to take care of so a lot of times you know you leave old",
    "start": "270639",
    "end": "275680"
  },
  {
    "text": "hardware lying around and you have to work on a lot of obscure knowledge so as an example of this one day i spent",
    "start": "275680",
    "end": "283600"
  },
  {
    "text": "three hours just trying to figure out which java jvms i needed to run on a variety of",
    "start": "283600",
    "end": "289600"
  },
  {
    "text": "these sun light sound management consoles so things like that you know",
    "start": "289600",
    "end": "295759"
  },
  {
    "text": "figuring out port settings for accessing accessing the consoles it's not really a good use of my time it's not good use of",
    "start": "295759",
    "end": "302320"
  },
  {
    "text": "anyone else's time either there's a along with all this physical",
    "start": "302320",
    "end": "307360"
  },
  {
    "text": "work there's things like negotiating contracts organizing what you order troubleshooting them",
    "start": "307360",
    "end": "313039"
  },
  {
    "text": "procurement racking cabling formatting building and then when you're done with it you've got to retire and liquidate it",
    "start": "313039",
    "end": "319360"
  },
  {
    "text": "and make sure you close out all contracts so that's really not not our business our businesses and",
    "start": "319360",
    "end": "325840"
  },
  {
    "text": "data centers and there's experience of being on call um you know it basically having the data",
    "start": "325840",
    "end": "332720"
  },
  {
    "text": "center requires our ops employees to live right next to the data center or you know within a near within a",
    "start": "332720",
    "end": "338880"
  },
  {
    "text": "reasonable distance and that's not really ideal for a lot of our employees",
    "start": "338880",
    "end": "345759"
  },
  {
    "text": "one one particularly ugly scenario we ran into very early on",
    "start": "346720",
    "end": "353360"
  },
  {
    "text": "was that uh we got we got basically kicked out of a data center just because uh there was",
    "start": "353360",
    "end": "359360"
  },
  {
    "text": "this up and coming company begins with a y that uh",
    "start": "359360",
    "end": "364800"
  },
  {
    "text": "decided we need more power so the data center company told us you know we're cutting off your power in one week",
    "start": "364800",
    "end": "371759"
  },
  {
    "text": "so there you go and uh so the company ended up you know",
    "start": "371759",
    "end": "376880"
  },
  {
    "text": "taking some station wagons and carefully taking out discs and putting them in redundancy and carrying them to",
    "start": "376880",
    "end": "383520"
  },
  {
    "text": "new new cage so that's a data center reality it's not a",
    "start": "383520",
    "end": "388560"
  },
  {
    "text": "it's not pretty but it can make for nice photos",
    "start": "388560",
    "end": "394280"
  },
  {
    "text": "so smug bug really like we love aws we're a very early adopter of s3 we",
    "start": "396240",
    "end": "401600"
  },
  {
    "start": "397000",
    "end": "476000"
  },
  {
    "text": "started in 2006. we got a we got a cold call",
    "start": "401600",
    "end": "407039"
  },
  {
    "text": "from from somebody at amazon just asking our our ceo are you interested in this product and i",
    "start": "407039",
    "end": "413360"
  },
  {
    "text": "think he quoted some number and he's like no it's a little too high and they called back in a few hours and said",
    "start": "413360",
    "end": "419520"
  },
  {
    "text": "here's a lower number are you interested yeah that's great so um",
    "start": "419520",
    "end": "424560"
  },
  {
    "text": "you may have heard that story at last year's re invent but uh over the years we've moved we moved our rendering our",
    "start": "424560",
    "end": "430160"
  },
  {
    "text": "uploading archiving payments permissions email and a lot more into s3",
    "start": "430160",
    "end": "436479"
  },
  {
    "text": "into aws and of course all of our photos in s3",
    "start": "436479",
    "end": "441919"
  },
  {
    "text": "but what was really stopping us from moving the rest of the infrastructure was that there was no high ultra high",
    "start": "445520",
    "end": "450880"
  },
  {
    "text": "performance i o and uh that's a lot of what i'm going to discuss here is um",
    "start": "450880",
    "end": "456400"
  },
  {
    "text": "how we came about getting our performance up there and how we",
    "start": "456400",
    "end": "461759"
  },
  {
    "text": "moved all that all the rest of the systems into aws",
    "start": "461759",
    "end": "466879"
  },
  {
    "text": "so this photo is actually relevant here because we built a system called skynet",
    "start": "467039",
    "end": "472080"
  },
  {
    "text": "before there's auto scaling so a few uh a few simple geographic diagrams here we",
    "start": "472080",
    "end": "479520"
  },
  {
    "text": "had um in 2006 was the time we moved to s3 again so we had all of our all of our",
    "start": "479520",
    "end": "485840"
  },
  {
    "text": "web hosts there was no ec2 back then so all there was for uh aws was s3",
    "start": "485840",
    "end": "491759"
  },
  {
    "text": "and we stored our photos there eventually we trusted enough to store all the photos but everything else was",
    "start": "491759",
    "end": "497280"
  },
  {
    "text": "uh stuck in our silicon valley data centers and you know you saw the pictures of how",
    "start": "497280",
    "end": "502800"
  },
  {
    "text": "that turned out as of uh 2011",
    "start": "502800",
    "end": "508560"
  },
  {
    "text": "we moved all of our uh image serving and image processing into uh into aws into",
    "start": "508560",
    "end": "514320"
  },
  {
    "text": "ec2 and some other servers systems there and what was left in our silicon valley",
    "start": "514320",
    "end": "520880"
  },
  {
    "text": "data centers were our web serving and database which includes like load balancing and other assorted",
    "start": "520880",
    "end": "526880"
  },
  {
    "text": "infrastructure um and that's how we",
    "start": "526880",
    "end": "532560"
  },
  {
    "text": "that's that's what we're looking at here in terms of moving into moving 100 in",
    "start": "532560",
    "end": "539279"
  },
  {
    "text": "so there's a little transition state that we had uh which i'll talk about a little more in detail later which was uh",
    "start": "539279",
    "end": "546800"
  },
  {
    "text": "before before we had any kind of uh high performance i o we thought about you",
    "start": "546800",
    "end": "552000"
  },
  {
    "text": "know we do really want to move more into aws if we can get a data center up closer to",
    "start": "552000",
    "end": "558720"
  },
  {
    "text": "us east we can run a direct connect in and we can run just the hardware that we",
    "start": "558720",
    "end": "563839"
  },
  {
    "text": "can't get in ec2 out of our data center there so that was a good idea",
    "start": "563839",
    "end": "570240"
  },
  {
    "text": "managing hardware from 3000 miles away isn't all that great but it's doable",
    "start": "570240",
    "end": "575600"
  },
  {
    "text": "and again i'll talk a little more about that and today",
    "start": "575600",
    "end": "581839"
  },
  {
    "text": "what we have is nothing in our data center which is which has been a dream of ours for a",
    "start": "581839",
    "end": "586959"
  },
  {
    "start": "582000",
    "end": "670000"
  },
  {
    "text": "very long time and everything's in aws so how did we get there",
    "start": "586959",
    "end": "593760"
  },
  {
    "text": "that's what we're here to see so in our database uh hardware we've",
    "start": "594080",
    "end": "599120"
  },
  {
    "text": "always been on the cutting edge of of what um of ios",
    "start": "599120",
    "end": "604640"
  },
  {
    "text": "we started early on on running my our my sequel on uh spinning discs and raids it",
    "start": "604640",
    "end": "609920"
  },
  {
    "text": "was a pretty common configuration back in the early 2000s just maxing out maxing out your spindles",
    "start": "609920",
    "end": "616000"
  },
  {
    "text": "maxing out raid from about uh",
    "start": "616000",
    "end": "621160"
  },
  {
    "text": "2006 to 2010 we were running we bought these like sun",
    "start": "621160",
    "end": "627279"
  },
  {
    "text": "oracle sun and future oracle storage appliances which at the time",
    "start": "627279",
    "end": "633600"
  },
  {
    "text": "were like wow these are great they use ssds which at the time were ridiculously expensive but they used",
    "start": "633600",
    "end": "639440"
  },
  {
    "text": "ssds in a smart way along with disks for caching and you know those provided a pretty",
    "start": "639440",
    "end": "645519"
  },
  {
    "text": "good cutting edge performance for a few years but again over time they they lost to what we finally ended up",
    "start": "645519",
    "end": "652160"
  },
  {
    "text": "building which were raids full of 24 ssds and those were",
    "start": "652160",
    "end": "658880"
  },
  {
    "text": "those are very speedy and had some interesting characteristics which i'll go into",
    "start": "658880",
    "end": "664880"
  },
  {
    "text": "and finally for database io we ended up using high one for",
    "start": "664880",
    "end": "670320"
  },
  {
    "text": "extra-large instances we were we are very very happy with them and uh",
    "start": "670320",
    "end": "677120"
  },
  {
    "text": "the main reason we found them to be an improvement over um our custom built hardware well our",
    "start": "677120",
    "end": "684320"
  },
  {
    "text": "custom-built hardware was very obscure we didn't have any we didn't really have anyone to follow there aren't too many",
    "start": "684320",
    "end": "690480"
  },
  {
    "text": "people who develop this kind of hardware and run the kind of ssds we do so you know we have a very unique configuration",
    "start": "690480",
    "end": "697360"
  },
  {
    "text": "we custom build them and and that leads to some problems where you find little bugs or you have",
    "start": "697360",
    "end": "703839"
  },
  {
    "text": "difficulty upgrading something you want to upgrade because of like say a driver problem or something related and you",
    "start": "703839",
    "end": "709839"
  },
  {
    "text": "have there's a lot of obscure ssd and raid problems that you can deal with like you",
    "start": "709839",
    "end": "716480"
  },
  {
    "text": "know trim and things like that so they're very difficult to upgrade and",
    "start": "716480",
    "end": "722000"
  },
  {
    "text": "somewhat unreliable the worst issue we we encountered with them was one time",
    "start": "722000",
    "end": "729440"
  },
  {
    "text": "we discovered uh well this is a bug which i think was pretty well known but there are some",
    "start": "729440",
    "end": "734720"
  },
  {
    "text": "crucial and micron ssds that after a certain amount of uptime they'd simply stop working so",
    "start": "734720",
    "end": "741920"
  },
  {
    "text": "you know wow that doesn't really happen with a regular spinning disc and you don't",
    "start": "741920",
    "end": "747360"
  },
  {
    "text": "expect it luckily we knew about it in advance but uh you can imagine how catastrophic that would be on a raid",
    "start": "747360",
    "end": "752720"
  },
  {
    "text": "system if all of your disks fell out the exact same time uh overall",
    "start": "752720",
    "end": "758399"
  },
  {
    "text": "on the high one for extra-large we found that the database i o performance was uh",
    "start": "758399",
    "end": "764399"
  },
  {
    "text": "approximately comparable to our ssd raids built with eight ssds and a raid 10. so",
    "start": "764399",
    "end": "771440"
  },
  {
    "text": "very good um compared to the 24 disk uh it's generally um",
    "start": "771440",
    "end": "777279"
  },
  {
    "text": "generally faster in random writes and a little slower in random reads but this is great for our database needs",
    "start": "777279",
    "end": "784320"
  },
  {
    "text": "we didn't need like super cutting edge simply because ssds were so amazingly",
    "start": "784320",
    "end": "790480"
  },
  {
    "text": "fast at random i o and the best feature that i've seen on",
    "start": "790480",
    "end": "795680"
  },
  {
    "text": "the high one for extra large is that their failure rate is extremely low we we think of uh ec2 instances as things",
    "start": "795680",
    "end": "802880"
  },
  {
    "text": "that are disposable and they can go away at any time but so can regular hardware we kind of think",
    "start": "802880",
    "end": "809040"
  },
  {
    "text": "of it differently but with these you know we're getting less than three percent failure uh per year",
    "start": "809040",
    "end": "815519"
  },
  {
    "text": "that's um better than any uh any standard hardware that i know of so",
    "start": "815519",
    "end": "821040"
  },
  {
    "text": "they whatever architecture is behind that we don't know but it's a it's actually a very good design and",
    "start": "821040",
    "end": "828399"
  },
  {
    "text": "probably the most reliable instance that we deal with",
    "start": "828399",
    "end": "833600"
  },
  {
    "text": "the other big win we saw in in moving over was amazon vpc we could simply map",
    "start": "837920",
    "end": "843839"
  },
  {
    "text": "our entire internal and external network security that we used in data centers straight into aws so very easy",
    "start": "843839",
    "end": "852639"
  },
  {
    "start": "845000",
    "end": "987000"
  },
  {
    "text": "so now i'm going to talk about a zero downtime move what does a zero down time mean actually um what do other companies",
    "start": "854560",
    "end": "861040"
  },
  {
    "text": "do when they move their services around i have a couple examples here",
    "start": "861040",
    "end": "866800"
  },
  {
    "text": "so this is a this is a service i use uh pretty frequently um it's a like a rss news",
    "start": "866800",
    "end": "874320"
  },
  {
    "text": "reader kind of service and they recently had a big move so all they said was you know we're not",
    "start": "874320",
    "end": "880880"
  },
  {
    "text": "available um it turned out to be i think they predicted a 48-hour move and it ended up",
    "start": "880880",
    "end": "887440"
  },
  {
    "text": "taking three days so for three days all they could deliver was they could deliver a bath and some",
    "start": "887440",
    "end": "893360"
  },
  {
    "text": "random cat photos and that was uh that was their way of expressing downtime",
    "start": "893360",
    "end": "898720"
  },
  {
    "text": "so you know am i going to complain about that not really it's a free site and they can do what they want and i don't i",
    "start": "898720",
    "end": "904720"
  },
  {
    "text": "don't pay for it so you know maybe it's not very critical for them to be up all the time",
    "start": "904720",
    "end": "910399"
  },
  {
    "text": "so smugmug can't do the same we're we have paying customers we have families who depend on us to see like baby photos",
    "start": "910399",
    "end": "917440"
  },
  {
    "text": "and we have businesses that depend on us to serve their clients so that that just doesn't work for us",
    "start": "917440",
    "end": "926000"
  },
  {
    "text": "uh here's another example this is from a very popular uh mostly free photo",
    "start": "926000",
    "end": "931360"
  },
  {
    "text": "sharing site that's ad supported so they recently did a data center move um",
    "start": "931360",
    "end": "937279"
  },
  {
    "text": "and they originally planned like an eight hour downtime ended up being around nine nine hours so",
    "start": "937279",
    "end": "943600"
  },
  {
    "text": "you know pretty good but during this time they had none of their photos viewable or browsable so anyone who",
    "start": "943600",
    "end": "949120"
  },
  {
    "text": "embedded their photos so a common use of their site is you know you use them to store photos that you embed on your blog",
    "start": "949120",
    "end": "955279"
  },
  {
    "text": "or any other site so not only was their site down but all their photo serving was down which means that all of their",
    "start": "955279",
    "end": "961600"
  },
  {
    "text": "uh if you embed your photos from them they simply weren't available for eight hours",
    "start": "961600",
    "end": "967360"
  },
  {
    "text": "um we didn't want that either you know this like trying to make it fun by having some social networking",
    "start": "967360",
    "end": "974160"
  },
  {
    "text": "stuff around what you're doing during the downtime but you know we don't want that",
    "start": "974160",
    "end": "979440"
  },
  {
    "text": "it's paid service and we think our customers deserve better",
    "start": "979440",
    "end": "984639"
  },
  {
    "text": "so a zero downtime move how do you do zero time time well that's",
    "start": "986639",
    "end": "992639"
  },
  {
    "start": "987000",
    "end": "1042000"
  },
  {
    "text": "what i'm talking about here and uh some of the things that help a lot so aws wow we can uh we can duplicate our",
    "start": "992639",
    "end": "1000160"
  },
  {
    "text": "resources so that the previous two examples neither of those two were cloud hosted which means that if they wanted",
    "start": "1000160",
    "end": "1006880"
  },
  {
    "text": "to have duplicate hardware anywhere they would have to pay for it and go through all the trouble of you know buying it",
    "start": "1006880",
    "end": "1012399"
  },
  {
    "text": "liquidating it and doing whatever they need for setup and takedown that's a huge amount of overhead and uh being in",
    "start": "1012399",
    "end": "1019120"
  },
  {
    "text": "aws it means that you only pay for what you use and you can provision quickly take things down",
    "start": "1019120",
    "end": "1025038"
  },
  {
    "text": "quickly and the other big parts of the move are simply planning and testing you have to",
    "start": "1025039",
    "end": "1030640"
  },
  {
    "text": "do a lot of planning and testing once you've managed all the resources",
    "start": "1030640",
    "end": "1036000"
  },
  {
    "text": "that aws offers offers well you can do it",
    "start": "1036000",
    "end": "1041360"
  },
  {
    "start": "1042000",
    "end": "1069000"
  },
  {
    "text": "some of the major changes we did post move so we talked about moving uh from our",
    "start": "1042160",
    "end": "1047600"
  },
  {
    "text": "ssd hardware to high one four extra large and a big part of our change was also um replacing our hardware load",
    "start": "1047600",
    "end": "1054400"
  },
  {
    "text": "balancers some f5s that we called ferraris because that's about how much it cost and uh turning them into uh",
    "start": "1054400",
    "end": "1062240"
  },
  {
    "text": "elastic load balancer",
    "start": "1062240",
    "end": "1065960"
  },
  {
    "start": "1069000",
    "end": "1121000"
  },
  {
    "text": "and uh behind the elbs we used we have a layer of aj proxy and what",
    "start": "1070160",
    "end": "1075600"
  },
  {
    "text": "that does is it gives us fine-grained traffic control we can distribute traffic to different",
    "start": "1075600",
    "end": "1080720"
  },
  {
    "text": "clusters and really have the exact kind of uh",
    "start": "1080720",
    "end": "1085760"
  },
  {
    "text": "control over the web traffic that we want and the one change we had to put into",
    "start": "1085760",
    "end": "1090799"
  },
  {
    "text": "our aj proxy layer was being able to handle dynamic configuration of servers obviously we um",
    "start": "1090799",
    "end": "1097520"
  },
  {
    "text": "going from going from a static list of",
    "start": "1097520",
    "end": "1102559"
  },
  {
    "text": "servers behind our clusters to auto scaling one and finally uh we're making a transition",
    "start": "1102559",
    "end": "1109760"
  },
  {
    "text": "out of um a memcache product called membase and into elasticash which we later um ran into some problems with and",
    "start": "1109760",
    "end": "1117360"
  },
  {
    "text": "uh used ec2 memcache on ec2",
    "start": "1117360",
    "end": "1123240"
  },
  {
    "start": "1121000",
    "end": "1315000"
  },
  {
    "text": "some of the big requirements we had for moving so a read-only mode is is",
    "start": "1128080",
    "end": "1133360"
  },
  {
    "text": "is really critical because there will be some time when you want to test but you don't want to write anything to your databases you don't want any right",
    "start": "1133360",
    "end": "1139120"
  },
  {
    "text": "traffic going to your site in our case in our case browsing and being able to",
    "start": "1139120",
    "end": "1144799"
  },
  {
    "text": "view your photos is you know maybe 80 to 90 percent of the business so read-only site mode only takes down like new",
    "start": "1144799",
    "end": "1151760"
  },
  {
    "text": "uploads and some a little bit of you know like private uh photo traffic",
    "start": "1151760",
    "end": "1157440"
  },
  {
    "text": "so read only site mode is is really important if you want to be able to move and we can still consider that zero down",
    "start": "1157440",
    "end": "1163600"
  },
  {
    "text": "time because it's something you can plan and announce to your users in advance",
    "start": "1163600",
    "end": "1168799"
  },
  {
    "text": "traffic control allowed us to shadow all of our traffic into our into our aws test clusters so what that",
    "start": "1169440",
    "end": "1176720"
  },
  {
    "text": "means is we can pick some of our traffic um send it over and it has no impact on",
    "start": "1176720",
    "end": "1182160"
  },
  {
    "text": "our production load this lets you say if you want to test a certain amount of load if you want to",
    "start": "1182160",
    "end": "1187919"
  },
  {
    "text": "run what we did was run all the robots through there it lets you test your test your traffic",
    "start": "1187919",
    "end": "1194080"
  },
  {
    "text": "without any impact and have an actual real world traffic scenario and see how see how your new test clusters respond",
    "start": "1194080",
    "end": "1202320"
  },
  {
    "text": "finally cross-country mysql replication is is very key here since removing our",
    "start": "1202320",
    "end": "1208240"
  },
  {
    "text": "databases and the way you set this up is the same as any other replication",
    "start": "1208240",
    "end": "1213919"
  },
  {
    "text": "mysql replication is very simple it just it's just sending a file over uh the only thing you have to do there",
    "start": "1214400",
    "end": "1220159"
  },
  {
    "text": "is calculate how much how much traffic your relay logs generate and make sure",
    "start": "1220159",
    "end": "1225440"
  },
  {
    "text": "you have enough bandwidth to support however many uh databases you plan to replicate and there's some tricks in there but",
    "start": "1225440",
    "end": "1231919"
  },
  {
    "text": "it's relatively simple",
    "start": "1231919",
    "end": "1235840"
  },
  {
    "text": "so the way we started initially doing some testing is we'd take down",
    "start": "1241520",
    "end": "1246640"
  },
  {
    "text": "we take down we'd have some maintenance periods where we'd actually move our read-only traffic over",
    "start": "1246640",
    "end": "1252799"
  },
  {
    "text": "instead of so the shadow traffic provides some degree of control but some things we can only test by actually",
    "start": "1252799",
    "end": "1258159"
  },
  {
    "text": "sending live traffic over there and the reason we did it read only was because this uh",
    "start": "1258159",
    "end": "1264480"
  },
  {
    "text": "just being read only prevents us from having to do uh database switchovers which are a moderate hassle there so",
    "start": "1264480",
    "end": "1272159"
  },
  {
    "text": "doing these read-only tests we'd iterate on them we do them every week during our maintenance",
    "start": "1272159",
    "end": "1277440"
  },
  {
    "text": "maintenance periods and those are extremely helpful in getting out some of the bugs that we only that",
    "start": "1277440",
    "end": "1283520"
  },
  {
    "text": "we discovered only by running at scale um it's a",
    "start": "1283520",
    "end": "1291400"
  },
  {
    "text": "full scale read write testing is very difficult again um running",
    "start": "1295600",
    "end": "1301919"
  },
  {
    "text": "changing your read write into a new location and then changing it back requires a lot of database searching so we tried to avoid",
    "start": "1301919",
    "end": "1308480"
  },
  {
    "text": "that and only restricted read-write testing to actual test-only clusters",
    "start": "1308480",
    "end": "1314960"
  },
  {
    "start": "1315000",
    "end": "1388000"
  },
  {
    "text": "one thing we found out was that we're we're always aware of some aws limits you have to know",
    "start": "1315039",
    "end": "1321760"
  },
  {
    "text": "you probably know about some that are well documented but there's a lot that are kind of obscure um we know about",
    "start": "1321760",
    "end": "1326880"
  },
  {
    "text": "some like packet per second limits um we know like the api we always are hitting",
    "start": "1326880",
    "end": "1333200"
  },
  {
    "text": "limits there so you have to be aware that uh be aware of some of these limits and",
    "start": "1333200",
    "end": "1338400"
  },
  {
    "text": "uh for some of them you can actually talk to your account manager or support and get them increased especially if you're making a big change like this you",
    "start": "1338400",
    "end": "1345280"
  },
  {
    "text": "should talk to them in advance to make sure they have whatever capacity you plan on bringing up it's not really",
    "start": "1345280",
    "end": "1351679"
  },
  {
    "text": "something you want to wait for the last moment on",
    "start": "1351679",
    "end": "1355519"
  },
  {
    "text": "uh the other good source of finding the aws limits is trusted advisor which i think uh currently lists a good portion",
    "start": "1359520",
    "end": "1366720"
  },
  {
    "text": "of them but i don't believe that existed when we are doing this",
    "start": "1366720",
    "end": "1371760"
  },
  {
    "text": "having a rollback plan is critical of course this is a very risky change you're making a lot of changes at once and if",
    "start": "1371760",
    "end": "1377919"
  },
  {
    "text": "you have a rollback plan you can insulate against a lot of the problems if you have something catastrophic happen",
    "start": "1377919",
    "end": "1385600"
  },
  {
    "text": "so making the switch so our ceo called this the biggest and scariest engineering change we've made",
    "start": "1387679",
    "end": "1394080"
  },
  {
    "start": "1388000",
    "end": "1459000"
  },
  {
    "text": "in the company's history so wow but it's actually only a few steps even though it's",
    "start": "1394080",
    "end": "1400480"
  },
  {
    "text": "from internally we see it as very scary but it's only a few steps to do it",
    "start": "1400480",
    "end": "1405600"
  },
  {
    "text": "so the first step we we took was we went read only um i've talked about how going",
    "start": "1405600",
    "end": "1410880"
  },
  {
    "text": "going read only allows us to make changes uh a lot easier",
    "start": "1410880",
    "end": "1416400"
  },
  {
    "text": "prior to this we actually scaled up some of our clusters very large of course you want to scale up to larger",
    "start": "1416400",
    "end": "1422159"
  },
  {
    "text": "than you think they they'll be things like elbs you need to pre-warm",
    "start": "1422159",
    "end": "1427279"
  },
  {
    "text": "in our clusters we have to get to a size that we think will be enough to handle whatever production traffic we get",
    "start": "1427279",
    "end": "1433039"
  },
  {
    "text": "during our maintenance we used a tool called mha to reassign our mysql masters and all of their",
    "start": "1433039",
    "end": "1440320"
  },
  {
    "text": "replication clusters and that was about a 30-minute process and finally to to make the switch happen",
    "start": "1440320",
    "end": "1447919"
  },
  {
    "text": "we pointed our dns and our cdn providers over to the elbs",
    "start": "1447919",
    "end": "1454480"
  },
  {
    "text": "next step in switching a lot of testing so we're in read-only mode and we",
    "start": "1455760",
    "end": "1462000"
  },
  {
    "text": "just like the previous tests we send our qa on it they look at it find any bugs",
    "start": "1462000",
    "end": "1468480"
  },
  {
    "text": "and that's all good so i think in our case that was about 60 minutes of read only time and then we",
    "start": "1468480",
    "end": "1474799"
  },
  {
    "text": "went read write we checked all our databases go we went read write and saw what happened",
    "start": "1474799",
    "end": "1482000"
  },
  {
    "text": "so this is the really tricky part because you're testing something that you actually haven't tested in in the",
    "start": "1482000",
    "end": "1487440"
  },
  {
    "text": "real world we've tested it at small scale we know how it we know how it behaves in",
    "start": "1487440",
    "end": "1492720"
  },
  {
    "text": "the in our old data centers we don't know exactly how it pays in aws so luckily this is late at night",
    "start": "1492720",
    "end": "1499200"
  },
  {
    "text": "we discovered uh some bugs at this step and that's that's kind of inevitable because",
    "start": "1499200",
    "end": "1505279"
  },
  {
    "text": "these changes you can't really track any everything every single thing down in our case",
    "start": "1505279",
    "end": "1510559"
  },
  {
    "text": "what uh the bug you read into the major one was um",
    "start": "1510559",
    "end": "1515679"
  },
  {
    "text": "we had a provider which used uh which is whitelist that uh that allowed certain",
    "start": "1515679",
    "end": "1520960"
  },
  {
    "text": "ip addresses in and uh of course this is no not in our code at all it's in our",
    "start": "1520960",
    "end": "1526640"
  },
  {
    "text": "provider's code so we didn't catch that but it was easy we made a call they uh",
    "start": "1526640",
    "end": "1533520"
  },
  {
    "text": "late at night and woke them up and got them to uh whitelist our new new ip addresses",
    "start": "1533520",
    "end": "1539039"
  },
  {
    "text": "so bugs like that can come up but uh hopefully not catastrophic ones",
    "start": "1539039",
    "end": "1545200"
  },
  {
    "text": "so mha what's that so mha is a tool uh it's developed by an engineer at a",
    "start": "1547600",
    "end": "1554159"
  },
  {
    "start": "1548000",
    "end": "1663000"
  },
  {
    "text": "japanese company called dna and i think he's at facebook now i'm running my sequel there",
    "start": "1554159",
    "end": "1560640"
  },
  {
    "text": "anyway it's a it's a very high quality tool that is used to reassign masters",
    "start": "1560640",
    "end": "1566799"
  },
  {
    "text": "and all the replication clusters and the tricky part that it handles is it'll make sure all of your replicas are",
    "start": "1566799",
    "end": "1574400"
  },
  {
    "text": "in proper sync so this is perfect for us um",
    "start": "1574400",
    "end": "1579520"
  },
  {
    "text": "previously manual failover in in mysql it would take us about 15 to 30 minutes",
    "start": "1579520",
    "end": "1586159"
  },
  {
    "text": "if all went well and you know pretty much only two of us knew enough to do that so 15 15 to 30 minutes might",
    "start": "1586159",
    "end": "1593760"
  },
  {
    "text": "be acceptable in if you only have one or two clusters but in our case we are changing over more than 10 clusters so",
    "start": "1593760",
    "end": "1600960"
  },
  {
    "text": "being able to make this conversion to to that many clusters in 30 minutes was much better",
    "start": "1600960",
    "end": "1606799"
  },
  {
    "text": "than say taking six hours one problem with this kind of automation",
    "start": "1606799",
    "end": "1612960"
  },
  {
    "text": "is it's uh automation of a rare event uh that has that has really been a lot",
    "start": "1612960",
    "end": "1618640"
  },
  {
    "text": "of companies in the past so you have to be very careful if you're trying to automate rare events um when you're",
    "start": "1618640",
    "end": "1623679"
  },
  {
    "text": "automating frequent events you get them tested all the time but automating rare events like say a",
    "start": "1623679",
    "end": "1628799"
  },
  {
    "text": "database failure is very very dangerous and you have to be you have to be very confident in your tools there's been",
    "start": "1628799",
    "end": "1637039"
  },
  {
    "text": "there's been a large number of providers who've been bitten by this problem and it's a it's not good when you have some",
    "start": "1637039",
    "end": "1643440"
  },
  {
    "text": "kind of automation failure that you don't completely understand",
    "start": "1643440",
    "end": "1649039"
  },
  {
    "text": "so in our case it worked out fine um but you just have to do your research",
    "start": "1650240",
    "end": "1656399"
  },
  {
    "text": "carefully and use use human power where it counts",
    "start": "1656399",
    "end": "1662320"
  },
  {
    "start": "1663000",
    "end": "1760000"
  },
  {
    "text": "so what other problems did we run into well the week before we actually made the switch we had it planned",
    "start": "1663279",
    "end": "1670720"
  },
  {
    "text": "and we had two network links running across the country two different providers",
    "start": "1670720",
    "end": "1677440"
  },
  {
    "text": "they can fail so we actually have them both fail on the exact same day about two hours apart",
    "start": "1677440",
    "end": "1682559"
  },
  {
    "text": "one was a line card failure one was a you know one of the fiber lines got cut by a bulldozer so",
    "start": "1682559",
    "end": "1688640"
  },
  {
    "text": "even if you have redundancy your network links can fail in that case we we had to postpone our",
    "start": "1688640",
    "end": "1693919"
  },
  {
    "text": "uh our move because well we ran into a rare scenario but those happen",
    "start": "1693919",
    "end": "1700799"
  },
  {
    "text": "the last cache performance was another problem we ran into we had some difficulty trying to figure",
    "start": "1701360",
    "end": "1707120"
  },
  {
    "text": "out what exactly was going on there last cache is uh is mostly a black box",
    "start": "1707120",
    "end": "1712399"
  },
  {
    "text": "you know you get some cloud watch metrics uh eventually which we discovered the bug along with the help of",
    "start": "1712399",
    "end": "1718880"
  },
  {
    "text": "uh some of the lost cache engineers so it's very useful to get them involved they're very helpful and but this is",
    "start": "1718880",
    "end": "1725440"
  },
  {
    "text": "just an example of sometimes sometimes your change might might not work and you'll have to run your own",
    "start": "1725440",
    "end": "1731679"
  },
  {
    "text": "run your own in our cases memcache currently that's working out fine for us",
    "start": "1731679",
    "end": "1737600"
  },
  {
    "text": "but uh i just wanted to mention that the last to catch team is is working really well with us to improve improve the",
    "start": "1737600",
    "end": "1743679"
  },
  {
    "text": "quality of the product another tool we found very useful for",
    "start": "1743679",
    "end": "1748880"
  },
  {
    "text": "handling uh problems discovering performance problems on the fly was new relic so we would really recommend using",
    "start": "1748880",
    "end": "1756080"
  },
  {
    "text": "this or some other apm product",
    "start": "1756080",
    "end": "1759919"
  },
  {
    "start": "1760000",
    "end": "1955000"
  },
  {
    "text": "so what did our change look like in terms of performance so i have a couple graphs here and i'll explain them to you",
    "start": "1761919",
    "end": "1768720"
  },
  {
    "text": "the first one on top here so this is our average response time and uh",
    "start": "1768720",
    "end": "1774480"
  },
  {
    "text": "the day we made the change was uh 5 17 on this graph roughly around midnight",
    "start": "1774480",
    "end": "1780880"
  },
  {
    "text": "and you can see uh previous to that you know you get very very uh inconsistent",
    "start": "1780880",
    "end": "1786080"
  },
  {
    "text": "latency uh post change it's it's nearly smooth nearly smooth",
    "start": "1786080",
    "end": "1791120"
  },
  {
    "text": "around uh let's see so post move we are we're roughly around",
    "start": "1791120",
    "end": "1796960"
  },
  {
    "text": "100 milliseconds on average in latency previous to that we are more in the 200 millisecond range and we've actually",
    "start": "1796960",
    "end": "1802720"
  },
  {
    "text": "gotten that down to 50 milliseconds so in terms of uh web web performance 50",
    "start": "1802720",
    "end": "1807919"
  },
  {
    "text": "milliseconds that's great but what we're on the op side we're really impressed by",
    "start": "1807919",
    "end": "1813200"
  },
  {
    "text": "the consistency of the performance",
    "start": "1813200",
    "end": "1817120"
  },
  {
    "text": "the second graph here is a graph of our photo serving latency so this is something we previously had to",
    "start": "1818320",
    "end": "1824320"
  },
  {
    "text": "make we often had to make cross-country checks and one of the this is a really expected results because we got rid of",
    "start": "1824320",
    "end": "1831440"
  },
  {
    "text": "some of that cross-country traffic which adds about 70 milliseconds to your communication",
    "start": "1831440",
    "end": "1836559"
  },
  {
    "text": "so we see the photo serving latency going down basically to whatever s3 can",
    "start": "1836559",
    "end": "1841919"
  },
  {
    "text": "provide",
    "start": "1841919",
    "end": "1844320"
  },
  {
    "text": "and here are a couple as the person who runs our databases this is what i found most impressive was",
    "start": "1847120",
    "end": "1853200"
  },
  {
    "text": "a couple of our certain queries that we run previously were very poor performing and",
    "start": "1853200",
    "end": "1861120"
  },
  {
    "text": "as you can see in the first graph the blue line is the uh is the actual um response time",
    "start": "1861120",
    "end": "1868000"
  },
  {
    "text": "wow look at that that's like that's like 10 times better going from 20 milliseconds down to 2 milliseconds",
    "start": "1868000",
    "end": "1874399"
  },
  {
    "text": "and uh the second chart there",
    "start": "1874399",
    "end": "1879559"
  },
  {
    "text": "so so part of it was uh just an in increase in",
    "start": "1880320",
    "end": "1885919"
  },
  {
    "text": "um so we had there are a lot of little tricky things with our ssds that i didn't exactly know",
    "start": "1885919",
    "end": "1893760"
  },
  {
    "text": "the cause so it's a little fuzzy there for me um but",
    "start": "1893760",
    "end": "1899919"
  },
  {
    "text": "what i really was impressed by was just the consistency of the performance on",
    "start": "1899919",
    "end": "1905360"
  },
  {
    "text": "on the high one for extra-large this one was i just picked it out because it was the one that that really",
    "start": "1905360",
    "end": "1912559"
  },
  {
    "text": "showed what what you can get out of the high one four extra largest",
    "start": "1912559",
    "end": "1917840"
  },
  {
    "text": "and uh finally on the bottom here so this is a graph of our traffic from the google bot",
    "start": "1919200",
    "end": "1925200"
  },
  {
    "text": "and uh one of the maybe something you wouldn't expect is that googlebot really likes likes fast",
    "start": "1925200",
    "end": "1932320"
  },
  {
    "text": "sites so what we found is well we switched over our site got way faster",
    "start": "1932320",
    "end": "1937440"
  },
  {
    "text": "and then google sends us twice as much traffic which is really great because all of our customers like getting more",
    "start": "1937440",
    "end": "1943120"
  },
  {
    "text": "bot traffic you know their search rankings go up and they uh they really appreciate that their site gets crawled",
    "start": "1943120",
    "end": "1948320"
  },
  {
    "text": "more often",
    "start": "1948320",
    "end": "1950880"
  },
  {
    "text": "so back when we're in the data center our performance fluctuated during the day it's because we we couldn't over",
    "start": "1954880",
    "end": "1960960"
  },
  {
    "start": "1955000",
    "end": "2070000"
  },
  {
    "text": "provision for every day we always have large peaks especially early in the week so we'd have some",
    "start": "1960960",
    "end": "1966880"
  },
  {
    "text": "fluctuating performance we'd have great performance at night and somewhat slower performance during the day",
    "start": "1966880",
    "end": "1972960"
  },
  {
    "text": "with aws with scaling we had flat performance through the day as you saw on the previous charts",
    "start": "1972960",
    "end": "1979519"
  },
  {
    "text": "and uh that was just removing all these scalability limits that we had before so networking was a really key improvement",
    "start": "1979519",
    "end": "1986480"
  },
  {
    "text": "having all your instances distributed in an az so if you think about most people's network architecture you know",
    "start": "1986480",
    "end": "1992240"
  },
  {
    "text": "you have a very strict architecture in a data center everything goes through you know a rack switch and into a router",
    "start": "1992240",
    "end": "1999039"
  },
  {
    "text": "and that's a that's good in some ways you have good control over your latency",
    "start": "1999039",
    "end": "2004080"
  },
  {
    "text": "but uh what aws offers is you just get some random you get some random instance who knows what switch it's on",
    "start": "2004080",
    "end": "2010240"
  },
  {
    "text": "you don't really mind so you lose a little in latency but what where it really pays off is inconsistency",
    "start": "2010240",
    "end": "2016399"
  },
  {
    "text": "you never run out of bandwidth well you do but you don't run out of aggregate bandwidth",
    "start": "2016399",
    "end": "2022640"
  },
  {
    "text": "what we found actually in a in a recent test was we uh we are moving some data",
    "start": "2022640",
    "end": "2028240"
  },
  {
    "text": "across uh amazon's network exclusively and we we're doing 50 gigabytes a second across the country",
    "start": "2028240",
    "end": "2035120"
  },
  {
    "text": "wow you know how can you how can you do this on your own can you rent can you run a connection like that",
    "start": "2035120",
    "end": "2040799"
  },
  {
    "text": "not really so for moving large amounts of traffic for traffic like website aws is perfect",
    "start": "2040799",
    "end": "2047360"
  },
  {
    "text": "um there's a lot of there's a lot of talk about latency and consistency but we think the trade-off on throughput is",
    "start": "2047360",
    "end": "2054079"
  },
  {
    "text": "worth it and success here meant that we could go",
    "start": "2054079",
    "end": "2060000"
  },
  {
    "text": "out on uh let's see may 18th the next day and go watch star trek",
    "start": "2060000",
    "end": "2065440"
  },
  {
    "text": "and there it is that was success so what did we learn",
    "start": "2065440",
    "end": "2072079"
  },
  {
    "start": "2070000",
    "end": "2208000"
  },
  {
    "text": "i said that smug bug loved aws before and we love it even more now because we're 100 in that's zero data centers to",
    "start": "2072079",
    "end": "2079280"
  },
  {
    "text": "manage automating everything was a big key to our move uh previously we",
    "start": "2079280",
    "end": "2085200"
  },
  {
    "text": "you know we had our old systems which weren't completely managed and they're done through",
    "start": "2085200",
    "end": "2091440"
  },
  {
    "text": "bits of legacy automating them made it easy and was necessary if you wanted to do",
    "start": "2091440",
    "end": "2096800"
  },
  {
    "text": "proper scaling understanding some of the underlying details of aws",
    "start": "2096800",
    "end": "2103520"
  },
  {
    "text": "services is critical so under first of all understanding evs is",
    "start": "2103520",
    "end": "2109680"
  },
  {
    "text": "a is something that when you get started on ebs you look at it and sometimes you don't think about",
    "start": "2109680",
    "end": "2116320"
  },
  {
    "text": "what it actually is since it works so transparently you know you have a disk based on it but we like to think of it",
    "start": "2116320",
    "end": "2122000"
  },
  {
    "text": "as network-based storage we know the advantages and disadvantages of that if you compare it if you think of it like",
    "start": "2122000",
    "end": "2128320"
  },
  {
    "text": "as some storage appliance that that's sort of a good way to think about it",
    "start": "2128320",
    "end": "2133839"
  },
  {
    "text": "although we think it's way better than that um it still has the disadvantages of network storage you have network",
    "start": "2133839",
    "end": "2139520"
  },
  {
    "text": "problems and you're going to have some problems with network storage and historically we've had we've seen",
    "start": "2139520",
    "end": "2144560"
  },
  {
    "text": "that in uh in in action uh and so some other details that we",
    "start": "2144560",
    "end": "2150800"
  },
  {
    "text": "care about in particular are you know we have some service we don't know exactly what's behind it but we see what happens",
    "start": "2150800",
    "end": "2156560"
  },
  {
    "text": "when different services go down so we understand what actually depends on what so for example we know that uh",
    "start": "2156560",
    "end": "2164000"
  },
  {
    "text": "previously the elastic load balancers would always have trouble when ebs did and now they don't so",
    "start": "2164000",
    "end": "2170960"
  },
  {
    "text": "that's something uh that's something we really wanted out of aws that we requested",
    "start": "2170960",
    "end": "2178240"
  },
  {
    "text": "unpredictable ops schedule so your ops team probably has a lot on their plate they probably",
    "start": "2180880",
    "end": "2187280"
  },
  {
    "text": "have a very inconsistent workload you know you're either troubleshooting firefighting and how do you schedule",
    "start": "2187280",
    "end": "2193040"
  },
  {
    "text": "something for an ops team like that well you can you just have to make make room for the project and",
    "start": "2193040",
    "end": "2199359"
  },
  {
    "text": "accept a little bit of lateness and it works out",
    "start": "2199359",
    "end": "2205040"
  },
  {
    "text": "and the number one lesson i took out of this was what's our job well our job is really to make business",
    "start": "2207839",
    "end": "2214240"
  },
  {
    "start": "2208000",
    "end": "2237000"
  },
  {
    "text": "happen our job is the same as our developers our job is the same as operations it's the same as marketing it's the same as our ceo we make the",
    "start": "2214240",
    "end": "2220960"
  },
  {
    "text": "business happen so that that's really our goal it's the same goal as everyone else we our job isn't to run data centers",
    "start": "2220960",
    "end": "2228079"
  },
  {
    "text": "it's not going to run aws our goal is to make the business happen",
    "start": "2228079",
    "end": "2233280"
  },
  {
    "text": "so we made some more changes because well we could why not",
    "start": "2235520",
    "end": "2240640"
  },
  {
    "start": "2237000",
    "end": "2288000"
  },
  {
    "text": "well i can talk about some of the advantages and disadvantages we're moving our infrastructure so why",
    "start": "2240640",
    "end": "2246000"
  },
  {
    "text": "not rebuild it um sure previously we're running old versions of",
    "start": "2246000",
    "end": "2251680"
  },
  {
    "text": "linux and mysql so we upgraded all that installed some new monitoring tools um",
    "start": "2251680",
    "end": "2258559"
  },
  {
    "text": "we got rid of some of our nfs dependencies moving them to s3 and dynamo and uh some of our code pushes",
    "start": "2258640",
    "end": "2265839"
  },
  {
    "text": "previously were just pushed out on a nfs server not very well distributed and a single point of",
    "start": "2265839",
    "end": "2272240"
  },
  {
    "text": "failure although we switched it to using something that we completely rely on which is amazon s3 very high",
    "start": "2272240",
    "end": "2277920"
  },
  {
    "text": "availability and used an internal torrent to distribute our code",
    "start": "2277920",
    "end": "2284760"
  },
  {
    "text": "so one last thing i want to talk about here is we went multi a z well wow great what",
    "start": "2287359",
    "end": "2293839"
  },
  {
    "start": "2288000",
    "end": "2402000"
  },
  {
    "text": "does that mean so multiple az is much easier than going multi-data center because",
    "start": "2293839",
    "end": "2300560"
  },
  {
    "text": "going multi-data center you have to manage all these cages like i mentioned before three times as many contracts you",
    "start": "2300560",
    "end": "2306880"
  },
  {
    "text": "know on and on with the data center set up multi-az on the other hand it's really as simple as just making sure",
    "start": "2306880",
    "end": "2313200"
  },
  {
    "text": "your your aws resources are are in the right place so the way we have it set up is we have",
    "start": "2313200",
    "end": "2320560"
  },
  {
    "text": "our load balancers our elb is sending traffic to uh redundant aj proxy clusters for az",
    "start": "2320560",
    "end": "2328160"
  },
  {
    "text": "and then in ejz we have some a group of web web clusters and db",
    "start": "2328160",
    "end": "2333760"
  },
  {
    "text": "replicas in our aha proxy configurations we back",
    "start": "2333760",
    "end": "2338960"
  },
  {
    "text": "up we back up our cluster configurations with uh with cross ac so if we have some",
    "start": "2338960",
    "end": "2345280"
  },
  {
    "text": "one of our clusters go down in one az the aj proxy will direct traffic to",
    "start": "2345280",
    "end": "2351359"
  },
  {
    "text": "two machines and other azs and that traffic is actually uh pretty low priced",
    "start": "2351359",
    "end": "2356560"
  },
  {
    "text": "although i think it's a pretty high margin product but but it works great for us",
    "start": "2356560",
    "end": "2363040"
  },
  {
    "text": "and finally uh the biggest tip for going multi-az is so almost every infrastructure you end",
    "start": "2363040",
    "end": "2369520"
  },
  {
    "text": "up with single points of failure in our case we have for instance mysql running in a",
    "start": "2369520",
    "end": "2377440"
  },
  {
    "text": "regular master mode so that's a single point of failure and you probably have multiple of them",
    "start": "2377440",
    "end": "2382640"
  },
  {
    "text": "so keep them all in one az if you have a z failures uh if you have multiple",
    "start": "2382640",
    "end": "2388720"
  },
  {
    "text": "single points of failure and multiple ac's that exposes you to a lot more failure scenarios",
    "start": "2388720",
    "end": "2395720"
  },
  {
    "text": "so that's all i have today uh and thanks again to our ops team thanks to all of you for uh sticking around to",
    "start": "2400880",
    "end": "2406960"
  },
  {
    "start": "2402000",
    "end": "2436000"
  },
  {
    "text": "the to the bitter end here um again my name is andrew shea and you can contact me here",
    "start": "2406960",
    "end": "2412720"
  },
  {
    "text": "we have uh let's see oh i want to announce that we have some job openings at swagbug so if you're anyone's",
    "start": "2412720",
    "end": "2418720"
  },
  {
    "text": "interested in that talk to me afterwards and we have a discount if you if you're a photographer",
    "start": "2418720",
    "end": "2424480"
  },
  {
    "text": "and interested in having some photo hosting we have a discount code reinvent",
    "start": "2424480",
    "end": "2430079"
  },
  {
    "text": "if you sign up and again you can talk to me later",
    "start": "2430079",
    "end": "2435000"
  }
]