[
  {
    "start": "0",
    "end": "75000"
  },
  {
    "text": "thank you all for coming I really appreciate the turnouts um we're with Sony and we're going to talk about",
    "start": "719",
    "end": "6279"
  },
  {
    "text": "breaking the bandwidth barrier using soft State and E EOB properties um yes",
    "start": "6279",
    "end": "12840"
  },
  {
    "text": "that's that's what I want to hear EOB yes let's do it okay so first I want to show",
    "start": "12840",
    "end": "20160"
  },
  {
    "text": "this together and we'll lose control you know what I like and you know I want some",
    "start": "23080",
    "end": "28519"
  },
  {
    "text": "morea aha don't St St I can't enough I it it it",
    "start": "28519",
    "end": "37000"
  },
  {
    "text": "let's keep it [Music] going it it",
    "start": "37000",
    "end": "43239"
  },
  {
    "text": "[Music] [Applause] [Music]",
    "start": "45060",
    "end": "52140"
  },
  {
    "text": "[Applause] it I can't get enough I love it it it",
    "start": "52140",
    "end": "57559"
  },
  {
    "text": "let's keep it going on I can't get enough I love it it it don't stop don't",
    "start": "57559",
    "end": "63640"
  },
  {
    "text": "stop I can't get enough I it it [Applause] [Music]",
    "start": "63640",
    "end": "72360"
  },
  {
    "text": "it now starting at 299 that's right guys for the low price of $2.99 you can have",
    "start": "72360",
    "end": "79439"
  },
  {
    "start": "75000",
    "end": "128000"
  },
  {
    "text": "a PlayStation 4 all right so who's talking um so that's me I'm Alex I work",
    "start": "79439",
    "end": "86600"
  },
  {
    "text": "for son interactive entertainment and I'm Dustin as you can read on the slide",
    "start": "86600",
    "end": "91720"
  },
  {
    "text": "um so we're here to talk about a couple things uh the agenda here is basically first talk about uh PSN overall and what",
    "start": "91720",
    "end": "100320"
  },
  {
    "text": "kind of services uh that we work on and what uh offerings we we support uh we",
    "start": "100320",
    "end": "106360"
  },
  {
    "text": "want to talk about the classic uh stateless architecture that everyone's probably really familiar with and",
    "start": "106360",
    "end": "111960"
  },
  {
    "text": "probably doing at at their jobs we'll to talk about soft State what that is how is how it applies in in a complex system",
    "start": "111960",
    "end": "120799"
  },
  {
    "text": "and like I said how how we applied it into one of our major use cases um and how it really helped our",
    "start": "120799",
    "end": "127720"
  },
  {
    "text": "performance so more about PSN the PlayStation 4 has been really successful",
    "start": "127720",
    "end": "133520"
  },
  {
    "start": "128000",
    "end": "215000"
  },
  {
    "text": "it's been big and growing you can imagine that every PS4 sold is more calls to our services so we have to to",
    "start": "133520",
    "end": "139360"
  },
  {
    "text": "scale out accordingly to the growth so we have over 65 million uh monthly",
    "start": "139360",
    "end": "145360"
  },
  {
    "text": "active users we have hundreds of millions of users just on all different platforms other than PS4 we have more",
    "start": "145360",
    "end": "151760"
  },
  {
    "text": "than 47 million PS4s I think we actually sold even more over Black Friday um and",
    "start": "151760",
    "end": "158040"
  },
  {
    "text": "we have a lot of offerings so some of those offerings that we support or at least our team supports as well and some other teams is the PlayStation Network",
    "start": "158040",
    "end": "164760"
  },
  {
    "text": "everyone's uh somewhat familiar with and in there there's PlayStation store which is the console store the web store",
    "start": "164760",
    "end": "172680"
  },
  {
    "text": "Mobile store all these are powered by our services we have PlayStation video that's where we have streaming uh movie",
    "start": "172680",
    "end": "180159"
  },
  {
    "text": "TV shows um to to your console onto your uh laptop you have PlayStation view a",
    "start": "180159",
    "end": "186480"
  },
  {
    "text": "really cool service that is H really disrupting things it's streaming like live television um over over the web we",
    "start": "186480",
    "end": "195519"
  },
  {
    "text": "have plac music we have a partnership with Spotify uh we offer U game related",
    "start": "195519",
    "end": "201040"
  },
  {
    "text": "uh U playlist and all that so it's pretty cool and a really cool service PlayStation now it's uh really",
    "start": "201040",
    "end": "206440"
  },
  {
    "text": "Innovative uh streaming games to any um to your console to your television to",
    "start": "206440",
    "end": "213720"
  },
  {
    "text": "your laptop it's really awesome so a little bit more about our services we have our social uh presence and this is",
    "start": "213720",
    "end": "220519"
  },
  {
    "start": "215000",
    "end": "329000"
  },
  {
    "text": "one of the features we want to really focus on and this is a friend search and if you can imagine like the numbers I",
    "start": "220519",
    "end": "226080"
  },
  {
    "text": "mentioned about 65 million uh active users you can imagine what that social graph looks like and how this particular",
    "start": "226080",
    "end": "232879"
  },
  {
    "text": "feature kind of feeds into itself any friend you make makes the social graph more complex and we have to be able to",
    "start": "232879",
    "end": "238280"
  },
  {
    "text": "manage that complexity and we also have to manage the search in that we also have our hybrid of I guess Facebook and",
    "start": "238280",
    "end": "245480"
  },
  {
    "text": "Twitter we have our own social network which track your activities you we know uh we share uh when you play a game when",
    "start": "245480",
    "end": "252120"
  },
  {
    "text": "you make friends when you earn trophies um that's part of what we do and what we show uh we have this thing called",
    "start": "252120",
    "end": "258519"
  },
  {
    "text": "communities which is um guess user created forums so people who share",
    "start": "258519",
    "end": "263880"
  },
  {
    "text": "common interest in games and create their own communities and then just share in the gaming experience so",
    "start": "263880",
    "end": "269080"
  },
  {
    "text": "there's a lot of different offerings in the social realm that we provide and you can imagine at scale it does add quite a",
    "start": "269080",
    "end": "274639"
  },
  {
    "text": "bit of complexity in in video we stream uh similar to you know Amazon video we",
    "start": "274639",
    "end": "280960"
  },
  {
    "text": "stream uh movies TV shows to uh the the players uh console we also do things",
    "start": "280960",
    "end": "288160"
  },
  {
    "text": "like PSV like I mentioned uh which is really cool it it really competes with companies like Comcast at& vers and all",
    "start": "288160",
    "end": "294720"
  },
  {
    "text": "that stuff and it it it's really really really cool okay and in Commerce here's place in VR uh you know just just um be",
    "start": "294720",
    "end": "303400"
  },
  {
    "text": "able to buy games digitally um on different platforms it's it's really cool so but all of these Services",
    "start": "303400",
    "end": "309320"
  },
  {
    "text": "there's something really important that we have to talk about why about these Services is that they have to be fast uh",
    "start": "309320",
    "end": "314919"
  },
  {
    "text": "Gamers especially are expecting low latency any kind of latency in games they notice they would expect no less",
    "start": "314919",
    "end": "321840"
  },
  {
    "text": "from the rest of the platform so has to be fast no matter what so let's go a bit",
    "start": "321840",
    "end": "327520"
  },
  {
    "text": "a little bit more into the classic state list design it is the the go-to design",
    "start": "327520",
    "end": "332560"
  },
  {
    "start": "329000",
    "end": "396000"
  },
  {
    "text": "everyone does it you know stat list design is your application tier is basically you can tear it down has no",
    "start": "332560",
    "end": "338280"
  },
  {
    "text": "State a user can land on any box it doesn't matter and then your persistence is in your database so basically there's",
    "start": "338280",
    "end": "344479"
  },
  {
    "text": "a clear distinction between your application and your database so database holds State your application",
    "start": "344479",
    "end": "350680"
  },
  {
    "text": "tier holds no State at all and your Peri stess systems are I guess extremely rare",
    "start": "350680",
    "end": "356280"
  },
  {
    "text": "in some cases like a web calculator is a good example um there's always some concept a state and we'll we'll go a",
    "start": "356280",
    "end": "362080"
  },
  {
    "text": "little bit more about what that looks like in terms of search and you know honestly I think this um stateless practice is taken to a",
    "start": "362080",
    "end": "370560"
  },
  {
    "text": "far Extreme as a religion that um that no matter what what the use cases we'll",
    "start": "370560",
    "end": "376560"
  },
  {
    "text": "just do stat list and I think that as you go um to different um scale you will",
    "start": "376560",
    "end": "382759"
  },
  {
    "text": "need to have different architectural patterns to solve thosea use cases and I think following this pattern is useful",
    "start": "382759",
    "end": "388840"
  },
  {
    "text": "but there are times where you may want to kind of deviate a little bit or just kind of augment it a little bit so here",
    "start": "388840",
    "end": "395880"
  },
  {
    "text": "are the pros of the stateless design obviously it's easy to scale",
    "start": "395880",
    "end": "401800"
  },
  {
    "start": "396000",
    "end": "546000"
  },
  {
    "text": "horizontally if you have you know you're running out of uh resources on a particular box you can just add boxes",
    "start": "401800",
    "end": "408319"
  },
  {
    "text": "infinitely you end up with thousands of servers and you're able to serve the customer easy to program you don't have",
    "start": "408319",
    "end": "413759"
  },
  {
    "text": "to care about State you just you know throw the state back to the database that's all you need to do you just",
    "start": "413759",
    "end": "418919"
  },
  {
    "text": "that's how you code it works on multi-regional deployments you don't have to think about where your data is necessarily or where your",
    "start": "418919",
    "end": "424919"
  },
  {
    "text": "application lives it just has to know where the data is and then that's that's all you need to do and that's only true",
    "start": "424919",
    "end": "430520"
  },
  {
    "text": "if you're underlying Tech Works says your database needs to be wter Regional and it's a really good step to to",
    "start": "430520",
    "end": "436879"
  },
  {
    "text": "serverless architecture stateless you know with serverless it goes hand inand so some of the cons are you really",
    "start": "436879",
    "end": "443680"
  },
  {
    "text": "relying on somebody else's code to to manage your State uh you're relying on distributed databases like Andra or",
    "start": "443680",
    "end": "450639"
  },
  {
    "text": "couch base or something like that to be able to persist your user data and just",
    "start": "450639",
    "end": "456360"
  },
  {
    "text": "hope your application can scale with it and be able to to perform with it but",
    "start": "456360",
    "end": "461759"
  },
  {
    "text": "you know there are actually a lot of complex use cases where there's going to require a lot of network communications you can imagine as we're dealing with",
    "start": "461759",
    "end": "467919"
  },
  {
    "text": "large social graphs um there could be a lot of calls back and forth to the",
    "start": "467919",
    "end": "473759"
  },
  {
    "text": "database to other microservices and the network traffic is quite large and eventually what you run",
    "start": "473759",
    "end": "480000"
  },
  {
    "text": "into is that that actually becomes your new bottleneck no longer is it the amount of request that you can serve from each box now it's the amount of",
    "start": "480000",
    "end": "487159"
  },
  {
    "text": "throughput you can get out of your your your databases or your caches and then it becomes at a point even impractical",
    "start": "487159",
    "end": "493240"
  },
  {
    "text": "to do or very costly to do so and then if you think about all the boxes that you have they have different dimensions",
    "start": "493240",
    "end": "500319"
  },
  {
    "text": "they have CPU memory Network and disk and all these things and you're going to hit a bottleneck from one of them but",
    "start": "500319",
    "end": "506199"
  },
  {
    "text": "there's resources left on those instances that are not used use why not use them you're paying for it why not",
    "start": "506199",
    "end": "513080"
  },
  {
    "text": "take advantage of it when you can so you know a lot of systems look like this",
    "start": "513080",
    "end": "518240"
  },
  {
    "text": "right you have a client calling a micros service a micro service calls another micros service and it just you can't",
    "start": "518240",
    "end": "523640"
  },
  {
    "text": "track the call pattern and then magically you know something works in the back it's your state it's a back in",
    "start": "523640",
    "end": "529080"
  },
  {
    "text": "your database it's managing everything and all those calls through don't really know about the path it took to get there",
    "start": "529080",
    "end": "535800"
  },
  {
    "text": "and that path can be very long and that's the the hope that a LW Stat system is that okay well my data tier my",
    "start": "535800",
    "end": "542560"
  },
  {
    "text": "caching tier will be the one that will be managing everything so what are some",
    "start": "542560",
    "end": "548079"
  },
  {
    "start": "546000",
    "end": "652000"
  },
  {
    "text": "of the cool Alternatives uh to this so obviously there's Lambda architecture uh you probably hear about here in AWS the",
    "start": "548079",
    "end": "554440"
  },
  {
    "text": "the Lambda feature or we can just talk about soft State and what is soft State So Soft state is basically accepting the",
    "start": "554440",
    "end": "560920"
  },
  {
    "text": "fact that state exists and use it to your advantage okay so more about soft",
    "start": "560920",
    "end": "567040"
  },
  {
    "text": "state in computer science soft state is the state where it's you know you're a",
    "start": "567040",
    "end": "572600"
  },
  {
    "text": "state that's useful for efficiency but it's not Central you can recreate it or regenerate it if needed there's a",
    "start": "572600",
    "end": "578600"
  },
  {
    "text": "picture of my car here if you ever seen it it's really nice uh so a little bit more about this",
    "start": "578600",
    "end": "584600"
  },
  {
    "text": "this car is actually very appropriate for soft State um Alex yeah because it's a it's pretty interesting car it has an",
    "start": "584600",
    "end": "590120"
  },
  {
    "text": "electric engine inside but it's not there to save your money right it's not",
    "start": "590120",
    "end": "595920"
  },
  {
    "text": "going to do it I think it can make like 15 miles on its batteries it's there",
    "start": "595920",
    "end": "601600"
  },
  {
    "text": "just to make you drive faster accelerate faster right it it um it accumulates",
    "start": "601600",
    "end": "607040"
  },
  {
    "text": "energy when you break and then when you need a burst of speed right of acceleration it just uh",
    "start": "607040",
    "end": "614519"
  },
  {
    "text": "just gives it back to Electric engines and then I think comb the standard engine can do like 600 horsepowers",
    "start": "614519",
    "end": "621760"
  },
  {
    "text": "together with electric it goes up to like 7 800 horsepower so if you think about it it's very interesting it's kind",
    "start": "621760",
    "end": "627760"
  },
  {
    "text": "of similar application right you have something that is inside just to do to",
    "start": "627760",
    "end": "634200"
  },
  {
    "text": "to to to increase the speed literally increase the acceleration yeah so that's",
    "start": "634200",
    "end": "639279"
  },
  {
    "text": "that's essentially what we want to do why don't we make systems that are like this porch as opposed to the tri and",
    "start": "639279",
    "end": "645480"
  },
  {
    "text": "true um I don't know Honda Accord which I have as for real that's it's actually a good car but",
    "start": "645480",
    "end": "652600"
  },
  {
    "start": "652000",
    "end": "708000"
  },
  {
    "text": "okay um so some highlights um whoops okay you saw too much I revealed it all",
    "start": "652600",
    "end": "659639"
  },
  {
    "text": "okay so some of the Highlight is simple State that's kept in memory for performance like I said about the car",
    "start": "659639",
    "end": "665720"
  },
  {
    "text": "there's some something that's there that it's just there to make things perform better you don't have to have the car",
    "start": "665720",
    "end": "671720"
  },
  {
    "text": "still drives your system still works but it helps and especially in high",
    "start": "671720",
    "end": "676800"
  },
  {
    "text": "performance systems it's harder to program but you can save a lot of money and we're all smart we like to program",
    "start": "676800",
    "end": "682240"
  },
  {
    "text": "hard things and our bosses like to save money so it's a natural natural fit and some systems are not feasible without it",
    "start": "682240",
    "end": "688200"
  },
  {
    "text": "I think when we go into what our use case is it was very hard to do it in a stateless way so why bother these are",
    "start": "688200",
    "end": "696760"
  },
  {
    "text": "laty numbers everyone should know there's a link here I think a lot of people probably seen this link and basically what it reflects is the order",
    "start": "696760",
    "end": "702760"
  },
  {
    "text": "of magnitude difference between cach hits branch mispredict of a CPU and when you hit dis and all that you know",
    "start": "702760",
    "end": "708839"
  },
  {
    "text": "there's a lot of stuff so in English let's say an L1 cach reference on the CPU takes one second so that's as close",
    "start": "708839",
    "end": "715360"
  },
  {
    "text": "you know you get to the the processing then you have M Branch mispredict you know the CPU optimization if you",
    "start": "715360",
    "end": "720760"
  },
  {
    "text": "mispredict it's going to cost you an order of 3 seconds and as you keep on going further away from the processing",
    "start": "720760",
    "end": "728000"
  },
  {
    "text": "the the core it gets super slow and then you can imagine as you go further and",
    "start": "728000",
    "end": "733639"
  },
  {
    "text": "further to eventually even Network you're going from 1 second to three minutes so from your request you're",
    "start": "733639",
    "end": "739560"
  },
  {
    "text": "going such an AA magnitude further away from your high performing uh system and",
    "start": "739560",
    "end": "745680"
  },
  {
    "start": "745000",
    "end": "768000"
  },
  {
    "text": "it just keeps on getting worse if you think about it um as you're you know reading from memory if you're reading",
    "start": "745680",
    "end": "750880"
  },
  {
    "text": "from your dis if you're reading from anything outside in the same data center",
    "start": "750880",
    "end": "756120"
  },
  {
    "text": "when you hit the disc and if you just go even multi- region hitting other regions that's like four out seven years I mean",
    "start": "756120",
    "end": "761839"
  },
  {
    "text": "you just don't want to wait that long right yeah still waiting for halflife three okay",
    "start": "761839",
    "end": "768240"
  },
  {
    "start": "768000",
    "end": "797000"
  },
  {
    "text": "anyways okay so this very smart man what is Isaac Newton has said and I",
    "start": "768240",
    "end": "776440"
  },
  {
    "text": "and I quote him is even servess architecture is subject to the laws of physics so you can quote me quoting him",
    "start": "776440",
    "end": "783040"
  },
  {
    "text": "quoting somebody else on that so but you know there's still a server somewhere there's still something that is serving the end user there's something there so",
    "start": "783040",
    "end": "790079"
  },
  {
    "text": "server lless there's some server okay so a little bit more about the Friend Finder feature is uh Alex G talk about",
    "start": "790079",
    "end": "797720"
  },
  {
    "start": "797000",
    "end": "827000"
  },
  {
    "text": "it all right so now let's talk about how to apply all this Theory yeah people",
    "start": "797720",
    "end": "803519"
  },
  {
    "text": "usually say series are good but practice actually uh is much more important",
    "start": "803519",
    "end": "808760"
  },
  {
    "text": "because something that works on a paper doesn't work in real life so um friends",
    "start": "808760",
    "end": "813880"
  },
  {
    "text": "finder it's a feature that allows uh Playstation users to find other users on",
    "start": "813880",
    "end": "819279"
  },
  {
    "text": "a platform it's also a little bit more than that but like in a nutshell that is",
    "start": "819279",
    "end": "824920"
  },
  {
    "text": "it's very simple so let's look at our social graph right you know there like",
    "start": "824920",
    "end": "830480"
  },
  {
    "start": "827000",
    "end": "879000"
  },
  {
    "text": "big social graphs in the world Facebook is good example uh Twitter another good example and then there are others but",
    "start": "830480",
    "end": "837639"
  },
  {
    "text": "our is pretty big as well hundreds millions of users and it's growing actively so it's growing",
    "start": "837639",
    "end": "843839"
  },
  {
    "text": "actively because we keep adding new interesting features to help people to create new connections discover um new",
    "start": "843839",
    "end": "850480"
  },
  {
    "text": "players to play with and also we they're like reach networking features um the",
    "start": "850480",
    "end": "856800"
  },
  {
    "text": "graph itself um it's not just person to person per se we have PlayStation store",
    "start": "856800",
    "end": "863360"
  },
  {
    "text": "right so we know what people are buying we know what people are playing we know who people are playing with so the total",
    "start": "863360",
    "end": "870120"
  },
  {
    "text": "graph can be really really big in terms of number of connections between them and then those graphs are huge and they",
    "start": "870120",
    "end": "877839"
  },
  {
    "text": "they actually they growing fast as well and then at some point of time I think two to three years ago we didn't have",
    "start": "877839",
    "end": "884759"
  },
  {
    "start": "879000",
    "end": "1054000"
  },
  {
    "text": "search so users couldn't find each other on a platform the only way to create a",
    "start": "884759",
    "end": "890320"
  },
  {
    "text": "connection was to just literally type like online ID or sign on email ID in the field and you you had to know it",
    "start": "890320",
    "end": "897880"
  },
  {
    "text": "somehow and then and we we had this internal hacket on when one of the teams implemented very simple implementation",
    "start": "897880",
    "end": "904279"
  },
  {
    "text": "they they show it they shown it and said like look look how cool it is and",
    "start": "904279",
    "end": "909360"
  },
  {
    "text": "Leadership said yeah let's do it so we decided to do a new feature uh the idea",
    "start": "909360",
    "end": "915000"
  },
  {
    "text": "was users should be able to find each other on a platform like simple uh there was some interesting requirements",
    "start": "915000",
    "end": "921800"
  },
  {
    "text": "privacy settings right we should respect them if Dustin doesn't want to be searchable and for some reason he",
    "start": "921800",
    "end": "927959"
  },
  {
    "text": "doesn't yeah you yeah so you will not be able to find them but you will be able to find me if you just type my name uh",
    "start": "927959",
    "end": "935480"
  },
  {
    "text": "so also we want to be able to recommend new users to new like Friends new",
    "start": "935480",
    "end": "940680"
  },
  {
    "text": "connections uh LinkedIn does it Facebook does it like it's usually called you may know feature uh it's like hey like there",
    "start": "940680",
    "end": "947000"
  },
  {
    "text": "are people who look like you or you might know them or maybe your the way",
    "start": "947000",
    "end": "952319"
  },
  {
    "text": "you play similar maybe you want to create a connection right this feature and there's a another very interesting",
    "start": "952319",
    "end": "959560"
  },
  {
    "text": "one actually the way we wanted to display results of the search right it",
    "start": "959560",
    "end": "964680"
  },
  {
    "text": "should follow the following order direct friends first on the top friend of",
    "start": "964680",
    "end": "969759"
  },
  {
    "text": "friends on the bottom so now uh this one is interesting think about it let's say",
    "start": "969759",
    "end": "974880"
  },
  {
    "text": "I have 2,000 friends uh each of them right has another 2,000 friends so the",
    "start": "974880",
    "end": "981759"
  },
  {
    "text": "total number of possible search hits from is for million right one multiplied",
    "start": "981759",
    "end": "987600"
  },
  {
    "text": "by another uh um smaller websites they don't have even",
    "start": "987600",
    "end": "992839"
  },
  {
    "text": "four million number of web pages or documents and that can happen if you just go and type search right it's",
    "start": "992839",
    "end": "999319"
  },
  {
    "text": "possibility technically to end it up with a power user because a lot of power users as a friends and we had to somehow",
    "start": "999319",
    "end": "1006319"
  },
  {
    "text": "figure out how to do it and then everyone else on the bottom all right friends friends of friends everyone and",
    "start": "1006319",
    "end": "1014000"
  },
  {
    "text": "then of course right as Dustin said um B is love like to to make it fast and not",
    "start": "1014000",
    "end": "1021279"
  },
  {
    "text": "really expensive so the idea was to do it really really fast with really small team of really talented uh Engineers so",
    "start": "1021279",
    "end": "1029678"
  },
  {
    "text": "another another in other words that's our problem right there so let's say that's me on the left so they're are",
    "start": "1029679",
    "end": "1036400"
  },
  {
    "text": "direct friends of me and then uh my uh second second TI and then when I type",
    "start": "1036400",
    "end": "1042038"
  },
  {
    "text": "something I want to see the first um one of those sag boys first then like second",
    "start": "1042039",
    "end": "1047880"
  },
  {
    "text": "year and then every one else um how hard can it be right pretty easy problem to",
    "start": "1047880",
    "end": "1054039"
  },
  {
    "text": "solve uh so we've figured out so for everyone for a platform wide search we can use solar uh does do you guys know",
    "start": "1054039",
    "end": "1062120"
  },
  {
    "text": "what solar is yeah all right so for people who yeah solar for people who don't who don't so",
    "start": "1062120",
    "end": "1069480"
  },
  {
    "text": "solar it's open source search engine based on na open source Library called",
    "start": "1069480",
    "end": "1075039"
  },
  {
    "text": "Lucine a very very popular there's another one called elastic search we used the solar before so and then we",
    "start": "1075039",
    "end": "1082880"
  },
  {
    "text": "just decided to go with solar for the thing and then um naturally if we're going to use solar to index everyone",
    "start": "1082880",
    "end": "1090200"
  },
  {
    "text": "maybe we can use solar to index relations between users um and then if we index it somehow we can uh we can",
    "start": "1090200",
    "end": "1097960"
  },
  {
    "text": "solve bunch of use cases for example we can just sort by distance uh right if we",
    "start": "1097960",
    "end": "1103000"
  },
  {
    "text": "figure out how to index it uh then like let's say distance one means your direct",
    "start": "1103000",
    "end": "1108559"
  },
  {
    "text": "from friend distance two means friend a friend and so on uh we can also SAR by some other fields possibly right for",
    "start": "1108559",
    "end": "1115840"
  },
  {
    "text": "example if I played with someone often we can have some increment field somewhere maybe uh and then we can just",
    "start": "1115840",
    "end": "1122080"
  },
  {
    "text": "do another sort could be a really cool feature um and then you may know at the",
    "start": "1122080",
    "end": "1127240"
  },
  {
    "text": "end of the day is literally another search and that's actually correct search right I um one day one of the",
    "start": "1127240",
    "end": "1134720"
  },
  {
    "text": "social networks a very famous one suggested me uh in the in the list of",
    "start": "1134720",
    "end": "1139919"
  },
  {
    "text": "suggestions it was like same person twice um and then we didn't want to end up in the same situation right um and",
    "start": "1139919",
    "end": "1147080"
  },
  {
    "text": "then with with search it should be avoided because results will be filtered so there's a big butt um data data has",
    "start": "1147080",
    "end": "1157520"
  },
  {
    "text": "low and high cardinality properties some things are time stamps some things are",
    "start": "1157520",
    "end": "1162799"
  },
  {
    "text": "um maybe some types it's not really easy to actually index it properly it is",
    "start": "1162799",
    "end": "1168159"
  },
  {
    "text": "possible don't get me wrong it's just not easy another another thing the",
    "start": "1168159",
    "end": "1174000"
  },
  {
    "text": "question was how do we index relations between users at all do we put everything in so do we create a document",
    "start": "1174000",
    "end": "1181360"
  },
  {
    "text": "search document per user and then put IDs of all direct friends and friend the friends that's could be really big",
    "start": "1181360",
    "end": "1188320"
  },
  {
    "text": "document at the end and then last time I attended loen conference there was a question to one of the creators like",
    "start": "1188320",
    "end": "1195640"
  },
  {
    "text": "someone asked like what if what if we do a document with 10 million like fields and properties and then the answer was",
    "start": "1195640",
    "end": "1202360"
  },
  {
    "text": "like laugh um it's not really good idea and then so and it's actually not even",
    "start": "1202360",
    "end": "1208280"
  },
  {
    "text": "obvious how to how to do this indexing maybe we can index relations but then",
    "start": "1208280",
    "end": "1213360"
  },
  {
    "text": "what we're going to be doing it's actually it's a Joint inside uh this year solar I think I think it was this",
    "start": "1213360",
    "end": "1219760"
  },
  {
    "text": "year they announced graph traversal uh which is cool but it's not really fast",
    "start": "1219760",
    "end": "1226440"
  },
  {
    "text": "if you think about it they can Traverse I think uh almost like a million uh",
    "start": "1226440",
    "end": "1232200"
  },
  {
    "text": "documents per second to figure out connections and then um it it sounds",
    "start": "1232200",
    "end": "1237559"
  },
  {
    "text": "like a lot but if you have a huge graph it's you'll need a lot of machine and",
    "start": "1237559",
    "end": "1242600"
  },
  {
    "text": "then you'll need to figure out how to fit all the stuff and memory because it's perform when it's in memory so it is tricky not obvious how to do it and",
    "start": "1242600",
    "end": "1250200"
  },
  {
    "text": "also solar wasn't designed for such a to solve such a problem it was designed to index whole internet right DD go does it",
    "start": "1250200",
    "end": "1257559"
  },
  {
    "text": "I think they use solar um you can index your website they're just fine right they have solar has",
    "start": "1257559",
    "end": "1263679"
  },
  {
    "text": "concept of course we have multiple separate indices and then size and size index should be samean right number of",
    "start": "1263679",
    "end": "1271159"
  },
  {
    "text": "documents it can go to billions but after it hits some I mean uh some number",
    "start": "1271159",
    "end": "1277279"
  },
  {
    "text": "it's hard to reindex just just just really hard problem to solve um so we",
    "start": "1277279",
    "end": "1283679"
  },
  {
    "start": "1281000",
    "end": "1385000"
  },
  {
    "text": "ended up with some options um so one of the options and then you probably wondering like y solar rough database",
    "start": "1283679",
    "end": "1290720"
  },
  {
    "text": "there are so many nice ones neop one of them uh Titan Deb another one what else",
    "start": "1290720",
    "end": "1297440"
  },
  {
    "text": "is there orb right thank you Dustin teamwork um so there couple of",
    "start": "1297440",
    "end": "1305200"
  },
  {
    "text": "databases we looked at them and so the problem was some of them didn't scale",
    "start": "1305200",
    "end": "1310760"
  },
  {
    "text": "well in our circumstances some of them were hard to maintain some of them Master Slave Master Slave doesn't um",
    "start": "1310760",
    "end": "1319679"
  },
  {
    "text": "it kind of you know running Master Slave uh on a big scale feels dangerous right",
    "start": "1319679",
    "end": "1326159"
  },
  {
    "text": "um but it's still possible so we looked at them and we decided not to use them it's also it feels like it's a graph",
    "start": "1326159",
    "end": "1332960"
  },
  {
    "text": "problem but it is not for example there will be another talk tomorrow about going multi- regional and then we",
    "start": "1332960",
    "end": "1339200"
  },
  {
    "text": "actually use NE forj uh to do some interesting stuff uh and then we used NE",
    "start": "1339200",
    "end": "1346360"
  },
  {
    "text": "cor language uh to give us an idea how to get to multi Regional faster right it was a graph problem actually this one",
    "start": "1346360",
    "end": "1353039"
  },
  {
    "text": "not really graph problem it's a it's a search problem and then another another",
    "start": "1353039",
    "end": "1358600"
  },
  {
    "text": "natural idea okay we have those nosql databases and stateless pattern let's just you know dump everything in one big",
    "start": "1358600",
    "end": "1366159"
  },
  {
    "text": "no scale scalable black magic driven database and then see what",
    "start": "1366159",
    "end": "1371960"
  },
  {
    "text": "happens and then processing layer can be just a stateless thing that's sitting in",
    "start": "1371960",
    "end": "1377120"
  },
  {
    "text": "front of it getting request coring the database the big database just just",
    "start": "1377120",
    "end": "1382960"
  },
  {
    "text": "doing something and just returning back that was an idea so we came up with a schema so if you're wondering that's",
    "start": "1382960",
    "end": "1389400"
  },
  {
    "start": "1385000",
    "end": "1454000"
  },
  {
    "text": "Cassandra schema all right but can be just slightly modified and it could be",
    "start": "1389400",
    "end": "1394480"
  },
  {
    "text": "fit in like any noal database so the idea was we have account ID that's me",
    "start": "1394480",
    "end": "1400720"
  },
  {
    "text": "let's say then we have friend one friend two and then so on my friends and then they there's some Json that represent",
    "start": "1400720",
    "end": "1407440"
  },
  {
    "text": "friends say Dustin right here's his gamer name gamer zero try it how did you",
    "start": "1407440",
    "end": "1413320"
  },
  {
    "text": "get zero I don't know I got have no idea yeah okay um so yeah that's the schema",
    "start": "1413320",
    "end": "1419320"
  },
  {
    "text": "and then because we all know no SQL scales right linear scalability always",
    "start": "1419320",
    "end": "1425400"
  },
  {
    "text": "works uh we thought nice now it's going to work the only problem was how do we",
    "start": "1425400",
    "end": "1430640"
  },
  {
    "text": "do quaries no SQL database called No SQL for a reason right they don't support",
    "start": "1430640",
    "end": "1436799"
  },
  {
    "text": "SQL like queries and then even though Cassandra has a qu language called cql",
    "start": "1436799",
    "end": "1444559"
  },
  {
    "text": "and um couch base as well has quar language called nickel um it's not a",
    "start": "1444559",
    "end": "1450880"
  },
  {
    "text": "real quar language uh actually so we thought what does what does client want",
    "start": "1450880",
    "end": "1458320"
  },
  {
    "start": "1454000",
    "end": "1535000"
  },
  {
    "text": "client wants to be able to do search sort filter right pretty simple uh what",
    "start": "1458320",
    "end": "1463679"
  },
  {
    "text": "can we do so we can use some secondary indexes for example Cassandra has a",
    "start": "1463679",
    "end": "1469399"
  },
  {
    "text": "built-in support for it and they just uh recently improved it drastically because",
    "start": "1469399",
    "end": "1475480"
  },
  {
    "text": "previous version wasn't good enough um the one so we couldn't use it um couch",
    "start": "1475480",
    "end": "1481279"
  },
  {
    "text": "base also has something inside uh indexing as well but it's all uh all the",
    "start": "1481279",
    "end": "1487240"
  },
  {
    "text": "implementation they do very they try to mock uh the solar search pattern the",
    "start": "1487240",
    "end": "1492559"
  },
  {
    "text": "search across right the search across all the users for example search across all the rows so you can kind of do a SQL",
    "start": "1492559",
    "end": "1500440"
  },
  {
    "text": "query it's slightly slower but you can do it and that doesn't fit our use case honestly because we not searching across",
    "start": "1500440",
    "end": "1508120"
  },
  {
    "text": "we're searching inside so another option was let's just now fetch everything in",
    "start": "1508120",
    "end": "1513720"
  },
  {
    "text": "memory stateless hit the database say okay for me give me all my friends",
    "start": "1513720",
    "end": "1519360"
  },
  {
    "text": "friend of friends uh could be a lot then just fit it in one huge array of what",
    "start": "1519360",
    "end": "1525039"
  },
  {
    "text": "some smart data structure doert filter and then discard the state immediately return",
    "start": "1525039",
    "end": "1531120"
  },
  {
    "text": "back to user or there's another idea you know how developers constantly complaining",
    "start": "1531120",
    "end": "1537720"
  },
  {
    "text": "that they go to school they spend like four five maybe six years learning computer science all the school",
    "start": "1537720",
    "end": "1544559"
  },
  {
    "text": "algorithms and they get hired and they just to do some move buttons you know on the web page",
    "start": "1544559",
    "end": "1551279"
  },
  {
    "text": "aha all right I've been through it yes yeah pixel optimizations is not so we",
    "start": "1551279",
    "end": "1559000"
  },
  {
    "text": "thought okay maybe we can maybe we can apply computer science and then maybe we",
    "start": "1559000",
    "end": "1564840"
  },
  {
    "text": "can just index it right we have all this Json maybe we just index stuff for one",
    "start": "1564840",
    "end": "1569880"
  },
  {
    "text": "single user and writing an indexer sounds like a lot of fun you need to",
    "start": "1569880",
    "end": "1575640"
  },
  {
    "text": "like apply some computer science know some data structures there some Co optimizations you can do but",
    "start": "1575640",
    "end": "1582480"
  },
  {
    "text": "unfortunately for us and for the team right someone already had all the fun",
    "start": "1582480",
    "end": "1587679"
  },
  {
    "text": "and I someone created Lucin right so solar is powered by this Library open source pretty fast uh so some people on",
    "start": "1587679",
    "end": "1596279"
  },
  {
    "text": "internet even say they can Implement Twitter easily with Lucin in five hours",
    "start": "1596279",
    "end": "1601760"
  },
  {
    "text": "yeah maybe I I don't know um but it's open source it's a Java library and then",
    "start": "1601760",
    "end": "1608840"
  },
  {
    "text": "you can just plug it in and then index everything so solar literally is a",
    "start": "1608840",
    "end": "1614200"
  },
  {
    "text": "replication layer on top of it with some really cool plugins but the core is still losing they go together hand in",
    "start": "1614200",
    "end": "1620799"
  },
  {
    "text": "hand so we said okay let's let's do what we thought we can do let's take our",
    "start": "1620799",
    "end": "1626840"
  },
  {
    "text": "schema and then just plug in loosen right right in there so uh you you can",
    "start": "1626840",
    "end": "1632480"
  },
  {
    "text": "say I removed some stuff some I have this friend and then let's say there multiple friends in between there's this",
    "start": "1632480",
    "end": "1638039"
  },
  {
    "text": "loosen index and some version if you're wondering what's inside version just some metadata uh the reason is uh we",
    "start": "1638039",
    "end": "1644399"
  },
  {
    "text": "need to know uh what version of Lucine was used to create the index so we can read it right we also needed need to",
    "start": "1644399",
    "end": "1651320"
  },
  {
    "text": "know what Fields were indexed inside for example uh was it uh did we index last",
    "start": "1651320",
    "end": "1657200"
  },
  {
    "text": "name and first name and email or did we index anything else and then we also wanted to be able to move between",
    "start": "1657200",
    "end": "1663279"
  },
  {
    "text": "different schemas easily right so this whole thing went to the version so just some",
    "start": "1663279",
    "end": "1668640"
  },
  {
    "start": "1668000",
    "end": "1712000"
  },
  {
    "text": "metadata so now with this new update uh with this new idea we can search on anything inside the raw so technically",
    "start": "1668640",
    "end": "1675880"
  },
  {
    "text": "gives us a search capability right we have a personalized index for every single person and indices are also",
    "start": "1675880",
    "end": "1682880"
  },
  {
    "text": "pretty compact if you think about it they depends on number of fields depends",
    "start": "1682880",
    "end": "1688000"
  },
  {
    "text": "on the stuff you indexing could be 1 to 10% I think for documents it could be",
    "start": "1688000",
    "end": "1693240"
  },
  {
    "text": "20% not our case uh it's much smaller and then because it's small it's pretty",
    "start": "1693240",
    "end": "1699159"
  },
  {
    "text": "fast to put it from this database right this could be like maybe 1 kilobyte maybe 50 kiloby",
    "start": "1699159",
    "end": "1706440"
  },
  {
    "text": "100 kiloby it depends it's it's much smaller than actual data",
    "start": "1706440",
    "end": "1712480"
  },
  {
    "start": "1712000",
    "end": "1782000"
  },
  {
    "text": "set but we'll still need to pull all this data all the time from indexes from",
    "start": "1712480",
    "end": "1719039"
  },
  {
    "text": "from the database uh can't we do better um maybe we maybe maybe we don't need to",
    "start": "1719039",
    "end": "1724960"
  },
  {
    "text": "over optimize but there's another problem because we have an indexer somewhere right I didn't talk about",
    "start": "1724960",
    "end": "1731000"
  },
  {
    "text": "indexer I talked only about R pass uh we have an indexer somewhere it could be multiple indexers somewhere so if there",
    "start": "1731000",
    "end": "1738120"
  },
  {
    "text": "multiple indexers there could be race condition between them right you send one friend request to Dustin and another",
    "start": "1738120",
    "end": "1743840"
  },
  {
    "text": "friend request to to me we both accept it in a similar time if it's end up in a",
    "start": "1743840",
    "end": "1749679"
  },
  {
    "text": "different indexers you can end up with a actually messed up index uh it's so what",
    "start": "1749679",
    "end": "1755399"
  },
  {
    "text": "what can happen uh the first index will be with Dustin and everyone else second",
    "start": "1755399",
    "end": "1760640"
  },
  {
    "text": "index will be with me yeah you you might say there are ways to deal with this problem there's like optimistic looking",
    "start": "1760640",
    "end": "1767080"
  },
  {
    "text": "but then you you say a this very interesting word lock in which kind of hearten the distribute distributed",
    "start": "1767080",
    "end": "1774200"
  },
  {
    "text": "systems um but maybe we can do better like it's figured",
    "start": "1774200",
    "end": "1779360"
  },
  {
    "text": "out so what could we do uh we can do the so you might wonder why you like looking",
    "start": "1779360",
    "end": "1786240"
  },
  {
    "start": "1782000",
    "end": "1936000"
  },
  {
    "text": "at this uh orange fridge anyone know anyone anyone has idea why right so this",
    "start": "1786240",
    "end": "1793720"
  },
  {
    "text": "fridge so sometimes what happens a lot to me sometimes my wife asks me hey Alex what did you do today and like",
    "start": "1793720",
    "end": "1801440"
  },
  {
    "text": "I just put some cash in front of some other service and she what is cash and",
    "start": "1801440",
    "end": "1807640"
  },
  {
    "text": "now here's a problem she's pharmacist I cannot just explain it easy easily to her I have to come up with all these",
    "start": "1807640",
    "end": "1814880"
  },
  {
    "text": "weird explanations and then for cash problem I came up with a fridge explanation so the idea is if you want",
    "start": "1814880",
    "end": "1822000"
  },
  {
    "text": "to have a Fred deeg you know you don't go to Costco to get like two or three",
    "start": "1822000",
    "end": "1828480"
  },
  {
    "text": "like no one does it does anyone right good yes so so what you usually do you",
    "start": "1828480",
    "end": "1835840"
  },
  {
    "text": "go there uh you buy pack of a you put it in your fridge right and then it also",
    "start": "1835840",
    "end": "1841600"
  },
  {
    "text": "works like lru cache right if you keep the stuff for too long it gets spiled so",
    "start": "1841600",
    "end": "1847440"
  },
  {
    "text": "we just throw it away um and then also the Costco Safeway or any grocery store",
    "start": "1847440",
    "end": "1854279"
  },
  {
    "text": "right they have some it's not like Farm deliver stuff right into the store it",
    "start": "1854279",
    "end": "1859480"
  },
  {
    "text": "doesn't work that way right there are some uh aggregators somewhere some C distribution centers like multiple",
    "start": "1859480",
    "end": "1866360"
  },
  {
    "text": "layers of caching and then you have your personal cash right in your house uh so",
    "start": "1866360",
    "end": "1871399"
  },
  {
    "text": "applying this fridge right you want to keep the thing to your micros service right as close as possible you don't",
    "start": "1871399",
    "end": "1877480"
  },
  {
    "text": "want to go to neighbors fridge across the road it's not nice don't do",
    "start": "1877480",
    "end": "1883080"
  },
  {
    "text": "it so you want to do it and then in our word we can there's some multiple things",
    "start": "1883080",
    "end": "1889279"
  },
  {
    "text": "you can use you can use mkd redis on the Ws you can do elastic cash which is M MD",
    "start": "1889279",
    "end": "1895919"
  },
  {
    "text": "R you can have AOS Spike couch base like bunch of different Alternatives um and they more like a",
    "start": "1895919",
    "end": "1903480"
  },
  {
    "text": "Costco in this example actually because you still will pay Network penalty to",
    "start": "1903480",
    "end": "1909200"
  },
  {
    "text": "get to there and then you might say it's not as bad I think from a like earlier",
    "start": "1909200",
    "end": "1915000"
  },
  {
    "text": "slide we said that round trip and the same day dat Center takes couple days",
    "start": "1915000",
    "end": "1920120"
  },
  {
    "text": "anyone can wait couple days to get a fried egg right five days it's okay I R",
    "start": "1920120",
    "end": "1926080"
  },
  {
    "text": "human can survive like 40 days without food so if you just schedule it properly you'll be fine um but uh maybe maybe you",
    "start": "1926080",
    "end": "1934919"
  },
  {
    "text": "don't want to starve uh maybe you want to do something else so you just put this fridge right in your house in your",
    "start": "1934919",
    "end": "1940880"
  },
  {
    "start": "1936000",
    "end": "2128000"
  },
  {
    "text": "kitchen which means putting cash right inside in your micros service so no network",
    "start": "1940880",
    "end": "1946279"
  },
  {
    "text": "penalty and it means that request for this from the same user should go and",
    "start": "1946279",
    "end": "1951600"
  },
  {
    "text": "should end up and be processed on the same instance to save Network run trips and then it's not even about network",
    "start": "1951600",
    "end": "1958600"
  },
  {
    "text": "round trip right again from my earlier slide you need to go somewhere let's say you're hitting dat the database if we're",
    "start": "1958600",
    "end": "1965679"
  },
  {
    "text": "talking about Cassandra Cassandra doesn't uh have good caching mechanism so you're most probably going to hit dis",
    "start": "1965679",
    "end": "1972320"
  },
  {
    "text": "and let's say you're on spinning disc so now it's 1 month of we time uh nasty",
    "start": "1972320",
    "end": "1978480"
  },
  {
    "text": "uh if you put something in front of it like red or MD it makes stuff easier because you'll just need to go to memory",
    "start": "1978480",
    "end": "1985399"
  },
  {
    "text": "because it will not fit in your L1 cache uh so you'll still need to do some processing so way time is actually",
    "start": "1985399",
    "end": "1992240"
  },
  {
    "text": "increasing and then do you have time to wait maybe you do right maybe you don't",
    "start": "1992240",
    "end": "1998600"
  },
  {
    "text": "the catch is so if we do it we will need the state that we keep in memory we also want persistence for it because again",
    "start": "1998600",
    "end": "2005159"
  },
  {
    "text": "soft State used for optimization it's not me to be a source of truth it's not like I'm not talking about in memory",
    "start": "2005159",
    "end": "2011679"
  },
  {
    "text": "kind of database situation so every change for the state should be replicated somewhere um on this database",
    "start": "2011679",
    "end": "2020200"
  },
  {
    "text": "for example and then when you need to pull it in memory you just you just pull it from the database uh you need also to",
    "start": "2020200",
    "end": "2027159"
  },
  {
    "text": "uh be able to identify the state with some version number right which means so",
    "start": "2027159",
    "end": "2032600"
  },
  {
    "text": "to make sure you don't have like weird race condition situation when something changed it on the back for some reason",
    "start": "2032600",
    "end": "2039480"
  },
  {
    "text": "uh and then you just use an stale session from memory it could be very quick uh Network call to some cache",
    "start": "2039480",
    "end": "2047080"
  },
  {
    "text": "right which has this identifier and version in it and it doesn't have to be sequential you can do a synchronous",
    "start": "2047080",
    "end": "2054480"
  },
  {
    "text": "check what you can do and it's also really easy to implement and possible in our use case let's say search coms what",
    "start": "2054480",
    "end": "2061158"
  },
  {
    "text": "you can do you you just start doing Pro start processing search request in",
    "start": "2061159",
    "end": "2066240"
  },
  {
    "text": "parallel you just do as Quick Check of the version and then if you see that something changed you just cancel this",
    "start": "2066240",
    "end": "2072800"
  },
  {
    "text": "this thing and then do what has to be downloaded from the from the database for example do re indexing whatever you",
    "start": "2072800",
    "end": "2079320"
  },
  {
    "text": "need to do and continue uh possible to do it in multiple threads totally",
    "start": "2079320",
    "end": "2086000"
  },
  {
    "text": "doable and then again we'll just need to use this uh safety guard so the system",
    "start": "2086000",
    "end": "2092079"
  },
  {
    "text": "will look like this actually you have this database in our case it's Cassandra",
    "start": "2092079",
    "end": "2098359"
  },
  {
    "text": "and an application layer which has like cash of accounts Lucin and versions and",
    "start": "2098359",
    "end": "2104160"
  },
  {
    "text": "memory so we can compare it and you might wonder all right so if we do something like that right how does how",
    "start": "2104160",
    "end": "2111560"
  },
  {
    "text": "do we know when we when we do a call how do we know that we end up on the right server so servers will need to be able",
    "start": "2111560",
    "end": "2118880"
  },
  {
    "text": "somehow to Route users in between right there should be some aw awareness it's",
    "start": "2118880",
    "end": "2124320"
  },
  {
    "text": "like I don't have this user please go to another instance right something should be done so",
    "start": "2124320",
    "end": "2130920"
  },
  {
    "start": "2128000",
    "end": "2302000"
  },
  {
    "text": "routing how do we do it so there are a couple options I just listed some of",
    "start": "2130920",
    "end": "2136359"
  },
  {
    "text": "them first one is like big lookup table lookup table could be account ID for",
    "start": "2136359",
    "end": "2142240"
  },
  {
    "text": "example and some identifier server five possible uh there could be some kind of",
    "start": "2142240",
    "end": "2148960"
  },
  {
    "text": "gossiping algorithm databases use it a lot Cassandra couchbase good example uh the",
    "start": "2148960",
    "end": "2155480"
  },
  {
    "text": "idea is uh all the servers they are a aware of all other servers because you don't need a lot of memory to store this",
    "start": "2155480",
    "end": "2162000"
  },
  {
    "text": "information all the servers constantly exchange some gossiping information they",
    "start": "2162000",
    "end": "2167040"
  },
  {
    "text": "talking to each other and saying hey I just saw another server looks like the server is alive and then you can you can",
    "start": "2167040",
    "end": "2175000"
  },
  {
    "text": "uh servers can say and then this server holds all the accounts you don't need to actually the number of if you just keep",
    "start": "2175000",
    "end": "2181280"
  },
  {
    "text": "exchanging number of things that cashed it could can get huge so you don't need to do it you can do consistent Hasen",
    "start": "2181280",
    "end": "2188560"
  },
  {
    "text": "kind of the thing where you can say right uh this server has this subset of",
    "start": "2188560",
    "end": "2194280"
  },
  {
    "text": "accounts everyone knows how consistent hashen Works no yes okay the way it works uh",
    "start": "2194280",
    "end": "2202800"
  },
  {
    "text": "you you just normalize literally you just get your account ID let's say it's five you do CRC 32 for example on it and",
    "start": "2202800",
    "end": "2210960"
  },
  {
    "text": "then you go to integer it's very simple algorithm just don't try maybe it's not best it gives you some weird number",
    "start": "2210960",
    "end": "2217599"
  },
  {
    "text": "number at the end and then you do mod on number of servers it will it's very",
    "start": "2217599",
    "end": "2222680"
  },
  {
    "text": "simple algorithm for consistent hashing Cassandra uses mmur 3 uh it's us CRC",
    "start": "2222680",
    "end": "2228480"
  },
  {
    "text": "before doesn't really matter uh what it is Route and master and another concept",
    "start": "2228480",
    "end": "2234000"
  },
  {
    "text": "could be something somewhere that knows somehow magically where it throughoute it could be round trip to get this",
    "start": "2234000",
    "end": "2239920"
  },
  {
    "text": "information but still possible big question how to maintain this stuff right what if you need to",
    "start": "2239920",
    "end": "2245560"
  },
  {
    "text": "change capacity and you have stuff in memory or what if you need to redeploy uh if you use a memory state right your",
    "start": "2245560",
    "end": "2253079"
  },
  {
    "text": "database at the end can get a hit in this example uh what you can do again",
    "start": "2253079",
    "end": "2258440"
  },
  {
    "text": "multiple options for example you can use snapshotting right if you want to you can just dump some snapshot every hour",
    "start": "2258440",
    "end": "2265640"
  },
  {
    "text": "on dis put it on S3 and magically um just start it you can even go crazier",
    "start": "2265640",
    "end": "2271960"
  },
  {
    "text": "you can dump the snapshot put it on S3 spin up an instance use pcker to burn an Ami",
    "start": "2271960",
    "end": "2278160"
  },
  {
    "text": "and then and then use it if you need to scale up possible you can do it with Docker uh you can also stream the data",
    "start": "2278160",
    "end": "2285599"
  },
  {
    "text": "start new instance streams the data like one billion options actually you can do a shadow uh um we call it we do use it",
    "start": "2285599",
    "end": "2293680"
  },
  {
    "text": "for testing we call it Shadow testing when you spin up new server server and you like uh Shadow traffic to to warm it",
    "start": "2293680",
    "end": "2300839"
  },
  {
    "text": "up multiple things can can be done but we followed for this one we followed",
    "start": "2300839",
    "end": "2306480"
  },
  {
    "start": "2302000",
    "end": "2391000"
  },
  {
    "text": "keep it simple and then because we definitely we on Amazon so uh we used",
    "start": "2306480",
    "end": "2313240"
  },
  {
    "text": "uh we used the elb stick concept uh I don't know how many of you used it so",
    "start": "2313240",
    "end": "2319400"
  },
  {
    "text": "the idea of ALB sticking is um it uses cookies like random generated cookies",
    "start": "2319400",
    "end": "2325520"
  },
  {
    "text": "and then it was looks like it was created for websites actually for client",
    "start": "2325520",
    "end": "2330800"
  },
  {
    "text": "for browsers web browsers and then the way it works you send the request um elb",
    "start": "2330800",
    "end": "2336359"
  },
  {
    "text": "looks at it if special cookies present it routes it to a specific server if it doesn't then it routes it to a r random",
    "start": "2336359",
    "end": "2344000"
  },
  {
    "text": "server on the way back it remembers creat this cookie remembers some way inside the mapping uh gives it back to",
    "start": "2344000",
    "end": "2350280"
  },
  {
    "text": "the browser and expects browser to send it back uh we needed to do it on server s side um and then we had to emulate",
    "start": "2350280",
    "end": "2359680"
  },
  {
    "text": "similar similar Behavior so we just decided to store those cookies uh we're",
    "start": "2359680",
    "end": "2365480"
  },
  {
    "text": "just storing it in our cash uh some very simple mapping between account ID and",
    "start": "2365480",
    "end": "2371680"
  },
  {
    "text": "then the Ws Ticky cookie ID and then before the request comes through we just",
    "start": "2371680",
    "end": "2377160"
  },
  {
    "text": "pull it and then attach it to the request and then send it through the load balancer and then it's uh it's a",
    "start": "2377160",
    "end": "2383880"
  },
  {
    "text": "network round trip um as well yes uh but it's actually a fast one because cash is",
    "start": "2383880",
    "end": "2389480"
  },
  {
    "text": "actually really small data is really really small so the way it works right with boxes everyone loves boxes no one",
    "start": "2389480",
    "end": "2396240"
  },
  {
    "start": "2391000",
    "end": "2419000"
  },
  {
    "text": "loves coat anymore so there is a smart client calls uh our server we do a check",
    "start": "2396240",
    "end": "2402480"
  },
  {
    "text": "does does if user has a sticky we just attach it to the request routed through the load balancer if it doesn't then we",
    "start": "2402480",
    "end": "2409319"
  },
  {
    "text": "send request through the elb on the way back attach it uh and on the way back we",
    "start": "2409319",
    "end": "2414920"
  },
  {
    "text": "extract it from the response store it and return done so the whole system uh",
    "start": "2414920",
    "end": "2422400"
  },
  {
    "start": "2419000",
    "end": "2484000"
  },
  {
    "text": "looked like that by the way there's a social network box in a corner so there there will be another talk from our talk",
    "start": "2422400",
    "end": "2429280"
  },
  {
    "text": "team on uh on Thursday I believe the talk will be how they moved uh the piece",
    "start": "2429280",
    "end": "2435319"
  },
  {
    "text": "from MySQL to dynama will be pretty interesting recommend to attend all",
    "start": "2435319",
    "end": "2440680"
  },
  {
    "text": "right so we have the social network that can send notification that something changed someone friended someone for",
    "start": "2440680",
    "end": "2446960"
  },
  {
    "text": "example it goes to an indexer and indexer writes it to a solar Cloud uh so",
    "start": "2446960",
    "end": "2452200"
  },
  {
    "text": "this one just only for new users and privacy setting updates and then it's also does this indexing in the",
    "start": "2452200",
    "end": "2458720"
  },
  {
    "text": "background writes it to Cassandra and when we need to search we do split hit solar Cloud hit personalized search",
    "start": "2458720",
    "end": "2465680"
  },
  {
    "text": "microservice and actually um just the personalized search microservice uses",
    "start": "2465680",
    "end": "2471480"
  },
  {
    "text": "Cassandra uh for for yeah for stuff that is not in memory and lot balance a uh",
    "start": "2471480",
    "end": "2477760"
  },
  {
    "text": "sits right in front of it right that's a high level idea so how did it",
    "start": "2477760",
    "end": "2485680"
  },
  {
    "text": "do um solar was fine um we had like couple 100 million documents at it we",
    "start": "2485680",
    "end": "2492359"
  },
  {
    "text": "had own issues with it but it was like okay actually um some people might say",
    "start": "2492359",
    "end": "2498119"
  },
  {
    "text": "that it wasn't but like to me it was okay personalized part was not so fine",
    "start": "2498119",
    "end": "2504119"
  },
  {
    "text": "what was the problem um so the problem was with this idea each every single",
    "start": "2504119",
    "end": "2510599"
  },
  {
    "text": "change in Friendship required a lot of fre indexing just think about it let's say there's one person with huge graph",
    "start": "2510599",
    "end": "2516800"
  },
  {
    "text": "on one side another person with huge graph and then the horrible thing happens they just friend each other so",
    "start": "2516800",
    "end": "2524240"
  },
  {
    "text": "now we have all this multiple indices we need to touch an up an update and then",
    "start": "2524240",
    "end": "2530200"
  },
  {
    "text": "same goes when for privacy setting when I don't want to be searchable anymore now we need to tell every single index",
    "start": "2530200",
    "end": "2536800"
  },
  {
    "text": "uh that we store that we need to update it and you might wonder like is that a big problem um it was um we use",
    "start": "2536800",
    "end": "2544559"
  },
  {
    "text": "Cassandra Cassandra uses SS tables so the way s tables concept Works Cassandra",
    "start": "2544559",
    "end": "2551760"
  },
  {
    "text": "doesn't accept updates right every single change is a right is a addition",
    "start": "2551760",
    "end": "2556960"
  },
  {
    "text": "that goes at some point to dis so here's example let's say I just friended Dustin",
    "start": "2556960",
    "end": "2562839"
  },
  {
    "text": "uh my index got written to disk it sits there it's actually consumed space then later Dustin did something and then my",
    "start": "2562839",
    "end": "2570640"
  },
  {
    "text": "index got touched again new version will be written again it will end up in a different file on disk and so goes",
    "start": "2570640",
    "end": "2577800"
  },
  {
    "text": "at some point Cassandra does a thing called competion it goes through all those files it",
    "start": "2577800",
    "end": "2585160"
  },
  {
    "text": "removes duplicates um and then it generates new file at the end big one so",
    "start": "2585160",
    "end": "2590839"
  },
  {
    "text": "that's just it's like remove duplicates so would mean that storage is not uh",
    "start": "2590839",
    "end": "2596760"
  },
  {
    "text": "storage is not released right away right you it could be that you have a lot of stale data sitting just on disk and what",
    "start": "2596760",
    "end": "2605520"
  },
  {
    "text": "we saw was this this example storage like our data size was growing much much",
    "start": "2605520",
    "end": "2610800"
  },
  {
    "text": "faster than we thought right we started with couple servers in no time it grew",
    "start": "2610800",
    "end": "2616680"
  },
  {
    "text": "actually to like tens of servers and at some point uh our management said that",
    "start": "2616680",
    "end": "2623240"
  },
  {
    "text": "insane let's do something about it and when we thought about it our problem was",
    "start": "2623240",
    "end": "2628520"
  },
  {
    "text": "a rapid expansion does anyone know how some how some physicist call Rapid",
    "start": "2628520",
    "end": "2635680"
  },
  {
    "text": "expansions EXP explosions right so we had to just do",
    "start": "2635680",
    "end": "2641079"
  },
  {
    "start": "2640000",
    "end": "2657000"
  },
  {
    "text": "something about it and we decided to go back to the drawing board and think how we can make stuff better so what can we",
    "start": "2641079",
    "end": "2648800"
  },
  {
    "text": "do to avoid such rapid uh explosion of data so new Beast uh new Beast to",
    "start": "2648800",
    "end": "2657240"
  },
  {
    "text": "tame and we got this uh from we got this um uh Insight from running the system",
    "start": "2657240",
    "end": "2663839"
  },
  {
    "text": "it's mostly a search session it means that users don't search search frequently but when it's not a Google",
    "start": "2663839",
    "end": "2669640"
  },
  {
    "text": "right when you do it every single day and definitely not stack Overflow right",
    "start": "2669640",
    "end": "2675359"
  },
  {
    "text": "when yeah right um so it's more it's more when I need to find someone on the",
    "start": "2675359",
    "end": "2681920"
  },
  {
    "text": "platform you go inside it you find someone and you usually don't do it frequently but when you want to do it",
    "start": "2681920",
    "end": "2688280"
  },
  {
    "text": "you probably spend some time typing letters CU you type in letter by letter uh go through some uh names and then",
    "start": "2688280",
    "end": "2694800"
  },
  {
    "text": "that was a insight and we thought what if if we do something interesting what",
    "start": "2694800",
    "end": "2699920"
  },
  {
    "text": "if we use a formal indices right indices that we never store inside the database",
    "start": "2699920",
    "end": "2705800"
  },
  {
    "text": "just a memory index those indexes the indexes can live in memory just for the",
    "start": "2705800",
    "end": "2711880"
  },
  {
    "text": "duration of search session and after user is gone index can be safely discarded because users might get back",
    "start": "2711880",
    "end": "2718599"
  },
  {
    "text": "in a months in a year in five days who knows but probably not in the next 5 minutes or 25",
    "start": "2718599",
    "end": "2725200"
  },
  {
    "text": "seconds and Coden wise it could be exactly same code we just needed to like move it around from indexer to the",
    "start": "2725200",
    "end": "2731400"
  },
  {
    "text": "application uh then uh now we ended up with similar boxes but different lines",
    "start": "2731400",
    "end": "2738599"
  },
  {
    "start": "2733000",
    "end": "2772000"
  },
  {
    "text": "right again same Social Network update goes to indexer we just writes to solar",
    "start": "2738599",
    "end": "2744079"
  },
  {
    "text": "cloud and then on a r pass when we hit our search micros service we can get",
    "start": "2744079",
    "end": "2750160"
  },
  {
    "text": "those friends and Friends of Friends information do really fast indexing and return the response uh in this example",
    "start": "2750160",
    "end": "2757079"
  },
  {
    "text": "we also because we will going to be uh we cannot use version anymore there's no storage right Cassandra is gone in this",
    "start": "2757079",
    "end": "2763000"
  },
  {
    "text": "example we also need to know when some friendship information changes so we can avoid like having stale",
    "start": "2763000",
    "end": "2769680"
  },
  {
    "text": "indices and um you might wonder is it fixed yet right we kind of went even",
    "start": "2769680",
    "end": "2776400"
  },
  {
    "start": "2772000",
    "end": "2821000"
  },
  {
    "text": "further right we went from we removed storage so we don't have a problem with",
    "start": "2776400",
    "end": "2781720"
  },
  {
    "text": "storage growing really big and then uh taking over the world not really it's",
    "start": "2781720",
    "end": "2788319"
  },
  {
    "text": "not fixed yet um the problem is now because indexing in a r pass it should",
    "start": "2788319",
    "end": "2795160"
  },
  {
    "text": "be very very very fast when you type first letter you don't want to wait uh seconds until we do indexing and respond",
    "start": "2795160",
    "end": "2803400"
  },
  {
    "text": "so and what we noticed looking at our Telemetry that boxes were spending a lot",
    "start": "2803400",
    "end": "2809280"
  },
  {
    "text": "of time and pulling all this data right pulling it in memory pulling all those",
    "start": "2809280",
    "end": "2814400"
  },
  {
    "text": "btes and bits so we just talked about soft State can it be improved somehow it",
    "start": "2814400",
    "end": "2820839"
  },
  {
    "text": "definitely can uh we can do some simple math uh let's say we have couple of like",
    "start": "2820839",
    "end": "2826880"
  },
  {
    "start": "2821000",
    "end": "2860000"
  },
  {
    "text": "hundred million users hundreds of million users but number of active users is like much less and then let's say our",
    "start": "2826880",
    "end": "2833280"
  },
  {
    "text": "searchable metadata is just 200 bytes um how much memory will we need to cach all",
    "start": "2833280",
    "end": "2839400"
  },
  {
    "text": "the active users all the metad DAT about active users not much actually if we say",
    "start": "2839400",
    "end": "2845839"
  },
  {
    "text": "if we have 100 million users we want to cash multiply it by 200 bytes we're talking",
    "start": "2845839",
    "end": "2851800"
  },
  {
    "text": "about 18 gigabytes of RAM it's like not not much so",
    "start": "2851800",
    "end": "2859720"
  },
  {
    "text": "oops okay so uh we can organize everything in memory like this uh you",
    "start": "2859720",
    "end": "2869000"
  },
  {
    "start": "2860000",
    "end": "2944000"
  },
  {
    "text": "probably already figured out by looking the the slid that we use in Java um and",
    "start": "2869000",
    "end": "2874319"
  },
  {
    "text": "then you you also probably know that Java garbage collection can kill any good",
    "start": "2874319",
    "end": "2881559"
  },
  {
    "text": "idea yeah uh so we decided to go with um for caching with off hiip solution uh",
    "start": "2881599",
    "end": "2889079"
  },
  {
    "text": "for this one we used eh cache uh works pretty well so Java hip can be small",
    "start": "2889079",
    "end": "2894640"
  },
  {
    "text": "enough maybe 8 gigs maybe five gigs for for this one I think we run with 8 gigabytes uh then we allocate some",
    "start": "2894640",
    "end": "2901160"
  },
  {
    "text": "memory for off hiip and then we can split it into pieces uh one piece can be",
    "start": "2901160",
    "end": "2907559"
  },
  {
    "text": "information about accounts it can be let's say 20 GB we just calculate that we need just 18 gigs and another 20 gigs",
    "start": "2907559",
    "end": "2915559"
  },
  {
    "text": "can be allocated for Lucin indices also we have ssds today and then with",
    "start": "2915559",
    "end": "2921640"
  },
  {
    "text": "stateless design we usually don't use them why would you uh maybe to write logs but then you probably want to move",
    "start": "2921640",
    "end": "2928680"
  },
  {
    "text": "logs to your event and system fast enough so you I don't know you will not probably use all 100 GS of SSD space in",
    "start": "2928680",
    "end": "2935640"
  },
  {
    "text": "this example we can also utilize some ssds SSD space if if you need to spill over it still could be faster than going",
    "start": "2935640",
    "end": "2941760"
  },
  {
    "text": "over the network if you have to will it work uh let's look uh we have",
    "start": "2941760",
    "end": "2948520"
  },
  {
    "start": "2944000",
    "end": "3006000"
  },
  {
    "text": "this these days like we have 256 gab of RAM on our on arser x large and also has",
    "start": "2948520",
    "end": "2955480"
  },
  {
    "text": "a huge SSD disc it looks like from memory perspective we're good we have",
    "start": "2955480",
    "end": "2961079"
  },
  {
    "text": "these boxes today there's one Biffy some monster two terabytes of RAM uh I don't",
    "start": "2961079",
    "end": "2967559"
  },
  {
    "text": "know I think you can uh cash whole world in this box if if you get three of them",
    "start": "2967559",
    "end": "2974079"
  },
  {
    "text": "uh you like set so I think uh 10 years ago that was big data right two",
    "start": "2974079",
    "end": "2981200"
  },
  {
    "text": "terabytes of pro of memory now it's just there who knows what going to be tomorrow um 20 terab I don't know um",
    "start": "2981200",
    "end": "2989799"
  },
  {
    "text": "it's also growing really fast so it sounds it can work um um but Dustin will",
    "start": "2989799",
    "end": "2998559"
  },
  {
    "text": "actually answer this last question the answer is no guys sorry it doesn't work",
    "start": "2998559",
    "end": "3004480"
  },
  {
    "text": "we failed hard no it uh actually did work so just some stats everyone loves stats people like graphs so here's a",
    "start": "3004480",
    "end": "3011119"
  },
  {
    "start": "3006000",
    "end": "3039000"
  },
  {
    "text": "graph uh basically this is showing the amount of accounts cached so if you look on the right index we have uh like",
    "start": "3011119",
    "end": "3016960"
  },
  {
    "text": "around like 79 million accounts that are cached and then if you look at the green line that's our cash hit ratio and it's",
    "start": "3016960",
    "end": "3023040"
  },
  {
    "text": "in the you know 97% which is really good so we're really utilizing our off Heap cach very well",
    "start": "3023040",
    "end": "3030079"
  },
  {
    "text": "and if you look here it's pretty steady it's not growing it's pretty you know it's performing really really well with",
    "start": "3030079",
    "end": "3036160"
  },
  {
    "text": "caching all the accounts in PSN in terms of network this is the the",
    "start": "3036160",
    "end": "3041400"
  },
  {
    "start": "3039000",
    "end": "3084000"
  },
  {
    "text": "very valuable resource is that Network out is actually really reasonable it's very small you think about it's about a Meg per per minute not much and network",
    "start": "3041400",
    "end": "3050040"
  },
  {
    "text": "in same thing not a lot if you can imagine in a stateless design where we have to retrieve a lot of this user",
    "start": "3050040",
    "end": "3056000"
  },
  {
    "text": "information and indexes it's quite a bit and with this design we have very little",
    "start": "3056000",
    "end": "3061680"
  },
  {
    "text": "Network in and out if you look at the indexing stats the accounts index per second we have you know about",
    "start": "3061680",
    "end": "3068599"
  },
  {
    "text": "700k accounts um users index per second which is quite amazing how many accounts",
    "start": "3068599",
    "end": "3073960"
  },
  {
    "text": "are we doing per second and the cashit ratio there is you know about 50% not the greatest but still as opposed to",
    "start": "3073960",
    "end": "3081200"
  },
  {
    "text": "always hitting a database or anything like that it's actually quite good so just some learning just like",
    "start": "3081200",
    "end": "3087680"
  },
  {
    "start": "3084000",
    "end": "3131000"
  },
  {
    "text": "comparing our original stateless design with our soft State Design if you have",
    "start": "3087680",
    "end": "3092799"
  },
  {
    "text": "122 bytes per user 730,000 accounts per second with let's say 20 servers so we",
    "start": "3092799",
    "end": "3099040"
  },
  {
    "text": "only have 20 servers that are managing the entire search um with the 0.5 inex",
    "start": "3099040",
    "end": "3104079"
  },
  {
    "text": "uh cashit ratio we have stateless design we have about 59 half a gig per minute",
    "start": "3104079",
    "end": "3110160"
  },
  {
    "text": "versus 14 Megs per minute so it's a order of magnitude larger to do stateless in our case so when we were",
    "start": "3110160",
    "end": "3116240"
  },
  {
    "text": "hitting Network bondex you can imagine that the amount of servers you would need to accommodate um that Network",
    "start": "3116240",
    "end": "3122319"
  },
  {
    "text": "traffic could increase the amount of servers you would need so you can yeah you can go stateless but then you would have let's say a thousand servers and",
    "start": "3122319",
    "end": "3128920"
  },
  {
    "text": "our boss would really like that very much so some of the learnings that we have is that you can do wonders when",
    "start": "3128920",
    "end": "3135680"
  },
  {
    "start": "3131000",
    "end": "3181000"
  },
  {
    "text": "you're desperate you have a budget they say okay you have to design this really cool Rich search feature you have I",
    "start": "3135680",
    "end": "3142640"
  },
  {
    "text": "don't know 20 servers you have to be able to do it we don't want to spend so much much money on this this feature",
    "start": "3142640",
    "end": "3147960"
  },
  {
    "text": "because you all know that you know features always bring in all the money right so um so it's something that we we",
    "start": "3147960",
    "end": "3154960"
  },
  {
    "text": "really focused on and and and really found different ways to do it so status works but it can result in many servers",
    "start": "3154960",
    "end": "3161200"
  },
  {
    "text": "I think I've heard of systems that have thousands of servers it blows my mind that that even exist but if you do",
    "start": "3161200",
    "end": "3166839"
  },
  {
    "text": "things like soft State you can actually reduce the amount you need you actually utilize all the resources of your box",
    "start": "3166839",
    "end": "3172559"
  },
  {
    "text": "and you can't beat RAM does anybody have anything better than Ram I want to know so um it's it's quite good so that's",
    "start": "3172559",
    "end": "3180160"
  },
  {
    "text": "basically it uh you can find us here so if you looking for a job we do a lot of",
    "start": "3180160",
    "end": "3185640"
  },
  {
    "start": "3181000",
    "end": "3212000"
  },
  {
    "text": "cool stuff a lot of Hands-On you get to build systems you get to really not work",
    "start": "3185640",
    "end": "3190920"
  },
  {
    "text": "on the button that um Alex mentioned but you can actually work on cool systems and features and you can find us this",
    "start": "3190920",
    "end": "3196960"
  },
  {
    "text": "way don't try to find us through the Amazon App you guys know how it is so um",
    "start": "3196960",
    "end": "3202839"
  },
  {
    "text": "that's it so thank you very much for coming I appreciate uh your your your attendance and",
    "start": "3202839",
    "end": "3210880"
  }
]