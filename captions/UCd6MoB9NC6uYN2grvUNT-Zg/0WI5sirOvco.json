[
  {
    "text": "all right the doors are closed so i can go ahead and get started now first of all thank you for joining me",
    "start": "2720",
    "end": "8880"
  },
  {
    "text": "this afternoon if you are here i'm assuming that you know you want to learn more about",
    "start": "8880",
    "end": "14080"
  },
  {
    "text": "identity and access management or you want to fine-tune your policy creating skills or you're just a",
    "start": "14080",
    "end": "20000"
  },
  {
    "text": "die-hard fan of looking at json documents",
    "start": "20000",
    "end": "24800"
  },
  {
    "text": "thank you my name is jeff ware and for the next 44-ish minutes or so we're going to take",
    "start": "25039",
    "end": "31119"
  },
  {
    "text": "an in-depth look at the access control policy language now as a member of the im team i can think",
    "start": "31119",
    "end": "38320"
  },
  {
    "text": "of no better way to spend 45 minutes of my life but looking at json policies however you all might not",
    "start": "38320",
    "end": "46399"
  },
  {
    "text": "share my same enthusiasm so i want to give you fair warning i am going to go through look at a lot of policies explain to you why",
    "start": "46399",
    "end": "52719"
  },
  {
    "text": "they work why they don't work if you are visually impaired such as i am you might want to move",
    "start": "52719",
    "end": "58000"
  },
  {
    "text": "towards the front i do not bite but you've been warned so i just want to",
    "start": "58000",
    "end": "64239"
  },
  {
    "text": "go ahead and start off with some of the goals so really simple by the time we leave today",
    "start": "64239",
    "end": "69840"
  },
  {
    "text": "i hope we all feel like we have a more in-depth understanding of how to",
    "start": "69840",
    "end": "74880"
  },
  {
    "text": "secure the resources in your aws account and the way we're going to achieve that is by getting a deeper understanding of",
    "start": "74880",
    "end": "80799"
  },
  {
    "text": "the policy language i frequently participate in the im forum",
    "start": "80799",
    "end": "86000"
  },
  {
    "text": "and probably the most common question i see is hey i'm trying to accomplish",
    "start": "86000",
    "end": "91119"
  },
  {
    "text": "this i need a policy that does foo how do i get that to work and so through the course the next 40",
    "start": "91119",
    "end": "96799"
  },
  {
    "text": "minutes or so i'm going to share some of the tips and tricks that i've learned over the last couple years",
    "start": "96799",
    "end": "102079"
  },
  {
    "text": "and i may have mentioned this before but we're going to look at a lot of policies",
    "start": "102079",
    "end": "107280"
  },
  {
    "text": "probably not the most exciting topic that you'll sit through this week but i'm going to try to keep it lively",
    "start": "107280",
    "end": "112399"
  },
  {
    "text": "i've picked out some of the policies that i think people have struggled with the most and i'm going to do demonstrations of those",
    "start": "112399",
    "end": "117680"
  },
  {
    "text": "and normally i would ask you to ask me questions to keep me awake given the time frame we're not going to",
    "start": "117680",
    "end": "122960"
  },
  {
    "text": "be able to do that but i promise i'll stick around afterwards if you have a question write it down and and i'll try to address",
    "start": "122960",
    "end": "128399"
  },
  {
    "text": "those in in the hallway so i mentioned i was going to do some demos won't we just start off there",
    "start": "128399",
    "end": "134080"
  },
  {
    "text": "so let's imagine you're new to aws and i'm sure some of you are and you've heard about this cloud",
    "start": "134080",
    "end": "139760"
  },
  {
    "text": "storage thing and you want to take advantage of that to provide kind of a home directory",
    "start": "139760",
    "end": "145680"
  },
  {
    "text": "for your users so i want to have end users and i want to create a home directory for each of them",
    "start": "145680",
    "end": "151760"
  },
  {
    "text": "and i'm going to go ahead and create a user policy that limits access to a folder if you're using s3 terminology a prefix",
    "start": "151760",
    "end": "159120"
  },
  {
    "text": "within within a bucket so let's say i have a user and her name is sally maybe i have the bucket a home prefix",
    "start": "159120",
    "end": "165840"
  },
  {
    "text": "and then her folder and i want her to have access to all the resources in there so let me show you what this looks like",
    "start": "165840",
    "end": "171920"
  },
  {
    "text": "from the perspective of the administrator i'm going to flip between chrome and firefox because i'll be logged in as the admin and logged in as",
    "start": "171920",
    "end": "177680"
  },
  {
    "text": "the user so here if i look in s3",
    "start": "177680",
    "end": "182879"
  },
  {
    "text": "i have a set of buckets and in there i have a test bucket of course and i've created a folder structure so i",
    "start": "182879",
    "end": "189440"
  },
  {
    "text": "have home and i have sally and she has a total of one document in there",
    "start": "189440",
    "end": "194800"
  },
  {
    "text": "and so i want her to only be able to read and write to that folder how might i go about that",
    "start": "194800",
    "end": "200720"
  },
  {
    "text": "well if you're new you might do a little bit of searching you might read the documentation maybe",
    "start": "200720",
    "end": "206879"
  },
  {
    "text": "find your way over to the im console and you go in create a user like any",
    "start": "206879",
    "end": "213280"
  },
  {
    "text": "good cook i've already done that i have the user in there she's not a member of any groups she's",
    "start": "213280",
    "end": "218799"
  },
  {
    "text": "not a member of she doesn't have any policies attached to her so i'll go ahead and try to attach a user policy now if you've",
    "start": "218799",
    "end": "226480"
  },
  {
    "text": "ever used this before you're going to be familiar with our policy templates these are sort of blueprints that you",
    "start": "226480",
    "end": "232400"
  },
  {
    "text": "can use that getting started blueprints for a policy and there's two of them for amazon s3 so one of them",
    "start": "232400",
    "end": "238959"
  },
  {
    "text": "that provides full access so i don't want that don't want to give her complete access and",
    "start": "238959",
    "end": "244159"
  },
  {
    "text": "another one that provides read access so obviously this would be something i could look at but it's not necessarily going to achieve my scenario",
    "start": "244159",
    "end": "251280"
  },
  {
    "text": "luckily we have the policy generator so i'm going to go ahead and select that",
    "start": "251280",
    "end": "256639"
  },
  {
    "text": "and i'm going to create a policy that allows i'm going to search down here for amazon s3 there's a whole",
    "start": "256639",
    "end": "265040"
  },
  {
    "text": "lot of actions that i could choose from so for simplicity i'm just going to select all",
    "start": "265040",
    "end": "270800"
  },
  {
    "text": "and i've got to put in the amazon resource name what what is that so okay i remember",
    "start": "270800",
    "end": "277680"
  },
  {
    "text": "over here in the s3 console if i go to my bucket i look at the properties",
    "start": "277680",
    "end": "283360"
  },
  {
    "text": "like well there's the name of the bucket maybe that's it i'll go in drop it in let me try to add",
    "start": "283360",
    "end": "290639"
  },
  {
    "text": "it if you can't see it it says the resource field is not valid you must",
    "start": "290639",
    "end": "296240"
  },
  {
    "text": "you must enter a valid arn so i do a little bit more web searching maybe i read the documentation and i",
    "start": "296240",
    "end": "303199"
  },
  {
    "text": "realize that what you enter there is in fact an amazon resource name that looks more like this so i find",
    "start": "303199",
    "end": "309840"
  },
  {
    "text": "out the structure of that i copy it in and now i can start adding",
    "start": "309840",
    "end": "314880"
  },
  {
    "text": "conditions so remember i had a certain prefix that had to match a string like and there's a prefix",
    "start": "314880",
    "end": "323600"
  },
  {
    "text": "and it looks something like this",
    "start": "323600",
    "end": "327680"
  },
  {
    "text": "now i can go in and add that condition now allows me to add the statement",
    "start": "329919",
    "end": "337759"
  },
  {
    "text": "and it generates a policy so now i have something that allows all actions for this prefix",
    "start": "337759",
    "end": "346080"
  },
  {
    "text": "on this bucket so i'm good to go right it's going to work click apply i'm going to switch over to",
    "start": "346080",
    "end": "353759"
  },
  {
    "text": "sally so i'm now sally in my account i'm going to go to the s3 console",
    "start": "353759",
    "end": "360880"
  },
  {
    "text": "and i'm going to get you don't have permissions to use the amazon s3 console if you need assistance contact your system administrator i am in fact the",
    "start": "365360",
    "end": "372160"
  },
  {
    "text": "system administrator so where do i go from here",
    "start": "372160",
    "end": "377360"
  },
  {
    "text": "so i think for a lot of folks that's the first experience they get",
    "start": "377360",
    "end": "382720"
  },
  {
    "text": "when they're trying to use the access control policy language and i show you a fail condition only",
    "start": "382720",
    "end": "388080"
  },
  {
    "text": "because i want you to learn from a common mistake that a lot of people make and so what i endeavor to do through the",
    "start": "388080",
    "end": "394720"
  },
  {
    "text": "remaining uh part of this presentation is walk you through how you would create such a policy and how you avoid",
    "start": "394720",
    "end": "400160"
  },
  {
    "text": "those types of mistakes and it starts with the policy language so identity and access management does",
    "start": "400160",
    "end": "406080"
  },
  {
    "text": "two things we authenticate you right validate your identity and then we authorize you and provide you with",
    "start": "406080",
    "end": "412000"
  },
  {
    "text": "permissions and entitlements and the way to describe that is through our policy language there's two things we're going to cover",
    "start": "412000",
    "end": "418240"
  },
  {
    "text": "first one is going to be the specification we're going to spend a lot of time looking at how do you define a policy what are the parts of it the",
    "start": "418240",
    "end": "424319"
  },
  {
    "text": "sort of the semantics of it and then towards the end i'm going to go through how we do the evaluation and how the",
    "start": "424319",
    "end": "430800"
  },
  {
    "text": "enforcement works and it's it's it's the combination of the two and then quite honestly a lot of experience",
    "start": "430800",
    "end": "436400"
  },
  {
    "text": "it's going to help you write great policies so you probably already know this but",
    "start": "436400",
    "end": "443120"
  },
  {
    "text": "policies are more or less json documents and they all include a statement which",
    "start": "443120",
    "end": "448560"
  },
  {
    "text": "are a set of permissions now those permissions have actions or what a principle",
    "start": "448560",
    "end": "454560"
  },
  {
    "text": "a person or service can do and the resources that you need to access and i showed you a couple of templates",
    "start": "454560",
    "end": "461120"
  },
  {
    "text": "from the management console one of them was the read-only template and this is an example of the apis",
    "start": "461120",
    "end": "466720"
  },
  {
    "text": "or actions that you would grant if you wanted somebody to have read access to every bucket every object in your s3",
    "start": "466720",
    "end": "473360"
  },
  {
    "text": "account now let's break this down a little bit further every policy has something has certain",
    "start": "473360",
    "end": "480639"
  },
  {
    "text": "elements and i like to refer to these as the park model specifically the principal the action",
    "start": "480639",
    "end": "485919"
  },
  {
    "text": "the resource and the conditions there's also an effect that effect is either an allow or deny",
    "start": "485919",
    "end": "492879"
  },
  {
    "text": "but e-park doesn't really roll off the tongue so i'll say park and i'll say plus you can",
    "start": "492879",
    "end": "498400"
  },
  {
    "text": "allow or deny a user and these two examples on the side are just snippets that would show this is how i would allow a user",
    "start": "498400",
    "end": "504160"
  },
  {
    "text": "access to a bucket and the other one is how i would deny a user to delete a bucket",
    "start": "504160",
    "end": "510400"
  },
  {
    "text": "we're going to get into more detailed examples in a minute so i want to walk through each of these because the way that you define them is a little bit",
    "start": "510400",
    "end": "516719"
  },
  {
    "text": "different per service so the principle if not obvious is the entity that is going to be granted or denied access to",
    "start": "516719",
    "end": "523599"
  },
  {
    "text": "a resource and i'm going to up front talk about policies that would be attached to",
    "start": "523599",
    "end": "528959"
  },
  {
    "text": "say an i am user or an i am group there are also policies that can be attached to other objects",
    "start": "528959",
    "end": "535680"
  },
  {
    "text": "i will show those don't worry but if you are dealing with a resource-based policy maybe attached to a bucket or topic",
    "start": "535680",
    "end": "542640"
  },
  {
    "text": "you're going to have to have a principal element so a lot of people create websites and they need anonymous",
    "start": "542640",
    "end": "548800"
  },
  {
    "text": "access to certain resources and if you were going to grant anonymous access to a resource you would use the star.star principle",
    "start": "548800",
    "end": "555920"
  },
  {
    "text": "likewise you might have multiple accounts you might have business partners where you need to share resources across your account in that",
    "start": "555920",
    "end": "562160"
  },
  {
    "text": "case you might be using the root principle this can be specified two different ways either put in the 12 digit account",
    "start": "562160",
    "end": "568000"
  },
  {
    "text": "number or you can put in the full arn for the root account now hopefully a bunch of you attended our",
    "start": "568000",
    "end": "574880"
  },
  {
    "text": "aws security best practices session you're all creating im users and you're not using your root",
    "start": "574880",
    "end": "580000"
  },
  {
    "text": "account and so in that case the rn for a user is going to look more like this if you're using cognito or any of the",
    "start": "580000",
    "end": "586959"
  },
  {
    "text": "identity federation services that we provide you might see principles that coming from amazon facebook google or",
    "start": "586959",
    "end": "593120"
  },
  {
    "text": "others hopefully some of you attended our delegation and federation session",
    "start": "593120",
    "end": "598399"
  },
  {
    "text": "yesterday that shawn did in that case you're going to use lots of roles so the roll on is going to become",
    "start": "598399",
    "end": "603519"
  },
  {
    "text": "important when you're when you're defining principles and then there will be times where you need to grant access to services so there are service",
    "start": "603519",
    "end": "610880"
  },
  {
    "text": "principles for example if you're using roles and i hope you all are when you launch an ec2",
    "start": "610880",
    "end": "616160"
  },
  {
    "text": "instance you're actually delegating access to the ec2 principle and so that's what it would look like",
    "start": "616160",
    "end": "622320"
  },
  {
    "text": "oh and if it's not obvious i'm using fake account numbers here so if anyone were to go and copy and paste you'd want to replace",
    "start": "622320",
    "end": "628160"
  },
  {
    "text": "with your account number actions now actions describe the type of",
    "start": "628160",
    "end": "633279"
  },
  {
    "text": "access that should be allowed or denied now we have you you'll see a lot of examples with the action",
    "start": "633279",
    "end": "639120"
  },
  {
    "text": "there's also the negative the not action and i'll go in detail into what that is and so",
    "start": "639120",
    "end": "644959"
  },
  {
    "text": "these are almost sometimes i'll i'll call these apis because for the most part there's a one to one between",
    "start": "644959",
    "end": "650560"
  },
  {
    "text": "an action and an api but just to give you an example of some of them this is for the ec2 start instance this is if",
    "start": "650560",
    "end": "656880"
  },
  {
    "text": "you wanted to grant a user to be able to change a password get object we've looked at a couple times pause here",
    "start": "656880",
    "end": "663680"
  },
  {
    "text": "because actions don't need to be a single item you can specify an array of actions and",
    "start": "663680",
    "end": "669279"
  },
  {
    "text": "if you do you just group them in square brackets likewise we have wild cards so let's say",
    "start": "669279",
    "end": "675440"
  },
  {
    "text": "i wanted to grant my users the ability to create delete list or update their access keys",
    "start": "675440",
    "end": "681519"
  },
  {
    "text": "i could create an array with that entire set uh list but it might make my policy biggie",
    "start": "681519",
    "end": "687519"
  },
  {
    "text": "bit big and unwieldly so in that case you can go and you can use an asterisk which is a replacement for multiple characters",
    "start": "687519",
    "end": "694160"
  },
  {
    "text": "or you can use a question mark which would replace a single character",
    "start": "694160",
    "end": "699519"
  },
  {
    "text": "okay i want to go through not action because a lot of people get confused by what we mean by not action the easiest way i",
    "start": "700000",
    "end": "707600"
  },
  {
    "text": "can explain it is not action allows you to specify an exception to a list of accidents and the nice",
    "start": "707600",
    "end": "714480"
  },
  {
    "text": "thing about this is it can result in tighter easier to understand policies",
    "start": "714480",
    "end": "720079"
  },
  {
    "text": "so let's say that you wanted to allow everything but the im apis because you want to create a power user and that",
    "start": "720079",
    "end": "725519"
  },
  {
    "text": "power user shouldn't be able to have administrative access one of the things you could do is you could create a policy that says allow",
    "start": "725519",
    "end": "732480"
  },
  {
    "text": "not action i am star for resource star and this will give the user access to every api and every api",
    "start": "732480",
    "end": "740160"
  },
  {
    "text": "in the future that is not in the im namespace or alternatively you could grant access",
    "start": "740160",
    "end": "748240"
  },
  {
    "text": "to every api and explicitly deny the im actions",
    "start": "748240",
    "end": "755040"
  },
  {
    "text": "any experts in here know what the difference is",
    "start": "755200",
    "end": "759839"
  },
  {
    "text": "so the attempt is that you would get to the allow first and then not get never get to the deny",
    "start": "768480",
    "end": "774720"
  },
  {
    "text": "um it's not true what is actually the the thing that i'd point out here is",
    "start": "774720",
    "end": "780720"
  },
  {
    "text": "that a not action is not equivalent to a deny a lot of people mess that up",
    "start": "780720",
    "end": "786240"
  },
  {
    "text": "so if on the left hand side here if i were to add this user to a group that had access",
    "start": "786240",
    "end": "793040"
  },
  {
    "text": "to im maybe i did it accidentally because i was fat fingering something with the cli that user would in fact have access to",
    "start": "793040",
    "end": "799760"
  },
  {
    "text": "the im apis however a deny always trumps an allow",
    "start": "799760",
    "end": "806320"
  },
  {
    "text": "so even if you were to take this user and put them in a group that explicitly granted them access to im the",
    "start": "806320",
    "end": "812639"
  },
  {
    "text": "deny would trump that so on the right-hand side it's kind of like a safeguard you could never have it",
    "start": "812639",
    "end": "817920"
  },
  {
    "text": "now if you really want to get even more strict you could use a not action so i'm not granting you access to i am",
    "start": "817920",
    "end": "824480"
  },
  {
    "text": "and i'm also denying that you could ever have it so if you're really security conscious",
    "start": "824480",
    "end": "829680"
  },
  {
    "text": "that may be the policy that you want to use so resources are the objects that you",
    "start": "829680",
    "end": "836560"
  },
  {
    "text": "want your users to be able to request and just like action and not action there's a resource and there's a not",
    "start": "836560",
    "end": "842079"
  },
  {
    "text": "resource so we looked at a couple of these already and just want to show you some examples",
    "start": "842079",
    "end": "848240"
  },
  {
    "text": "is the s3 bucket we saw sqsq dynamo tables which are actually pretty",
    "start": "848240",
    "end": "854160"
  },
  {
    "text": "long arms and then last but not least is the ec2 one and this is going to be an important one for most of you because",
    "start": "854160",
    "end": "860480"
  },
  {
    "text": "knowing how to really lock down access to your ec2 instances is critical to the security posture for your account",
    "start": "860480",
    "end": "866800"
  },
  {
    "text": "i got a whole section on this presentation on on ec2 now thus far we've looked at a lot of",
    "start": "866800",
    "end": "872320"
  },
  {
    "text": "policies that live with a user a group or a role for certain",
    "start": "872320",
    "end": "877440"
  },
  {
    "text": "services you can also have policies live with the service so in the case of s3",
    "start": "877440",
    "end": "882639"
  },
  {
    "text": "sns and sqs you can have a bucket policy a topic policy or a queue policy",
    "start": "882639",
    "end": "888320"
  },
  {
    "text": "and this is going to come in handy when you want to do kind of the cross account so a couple things i'll point out here",
    "start": "888320",
    "end": "893920"
  },
  {
    "text": "first of all we talked about the principle when you create a user or group policy",
    "start": "893920",
    "end": "900079"
  },
  {
    "text": "hopefully it's obvious that you don't have to put a principle in there because we know it's for that intended audience",
    "start": "900079",
    "end": "905600"
  },
  {
    "text": "but if you were to put this policy in this as an xqsq policy we would need to know who you're",
    "start": "905600",
    "end": "910720"
  },
  {
    "text": "granting access to so in this case we have an account ones twos and threes that is able to",
    "start": "910720",
    "end": "916320"
  },
  {
    "text": "access a queue in account four five and six so that's a resource-based policy",
    "start": "916320",
    "end": "922800"
  },
  {
    "text": "the last part of the parcc model are conditions and conditions are optional they allow",
    "start": "922800",
    "end": "929600"
  },
  {
    "text": "you to add in additional criteria and that criteria must eventually evaluate to true",
    "start": "929600",
    "end": "935040"
  },
  {
    "text": "in order for the entire policy to evaluate to true now conditions have elements and can",
    "start": "935040",
    "end": "942000"
  },
  {
    "text": "contain multiple conditions so case here i have a key and that key must evaluate to this value",
    "start": "942000",
    "end": "948480"
  },
  {
    "text": "and i have key 2 which also must evaluate to another value now condition keys can also contain",
    "start": "948480",
    "end": "954639"
  },
  {
    "text": "multiple values likewise a single condition can include multiple values for a key",
    "start": "954639",
    "end": "960959"
  },
  {
    "text": "the condition is evaluated using a logical or",
    "start": "960959",
    "end": "965839"
  },
  {
    "text": "if you have multiple conditions or you have multiple keys within a single condition",
    "start": "966079",
    "end": "971199"
  },
  {
    "text": "then the conditions are evaluated using a logical and this be a little bit confusing i",
    "start": "971199",
    "end": "976480"
  },
  {
    "text": "actually think it's a little bit easier to look at if you look at a real example so let's say that i wanted to create a",
    "start": "976480",
    "end": "982720"
  },
  {
    "text": "policy that will evaluate to true if the time is after",
    "start": "982720",
    "end": "988000"
  },
  {
    "text": "noon today but before 3 pm today and it comes from either of these two",
    "start": "988000",
    "end": "994720"
  },
  {
    "text": "address ranges the address ranges would be a logical or and then the three other conditions",
    "start": "994720",
    "end": "1000720"
  },
  {
    "text": "would have to all be true in order for the policy to be true make sense hopefully",
    "start": "1000720",
    "end": "1008399"
  },
  {
    "text": "okay the last part of the specification are really policy variables policy variables are i would say",
    "start": "1008880",
    "end": "1014880"
  },
  {
    "text": "relatively new it's something that we introduced about 18 months ago or so and these are going",
    "start": "1014880",
    "end": "1020959"
  },
  {
    "text": "to really help you tighten up your policies now if you remember when i went through that fail scenario of trying to create the s3 home",
    "start": "1020959",
    "end": "1027360"
  },
  {
    "text": "directory i had to go in there and explicitly put in sally's name as part of the prefix",
    "start": "1027360",
    "end": "1032400"
  },
  {
    "text": "now you can imagine if i had hundreds or thousands of users it could be really annoying to have to go and explicitly put that in how about instead if i could",
    "start": "1032400",
    "end": "1039038"
  },
  {
    "text": "just replace that with a username variable and then i have a single group policy that i could manage it'd be a lot better",
    "start": "1039039",
    "end": "1045038"
  },
  {
    "text": "right it's exactly what you get with policy variables so there's a number of use cases these also simplify",
    "start": "1045039",
    "end": "1051120"
  },
  {
    "text": "we looked at the home folder one but other common scenarios are hey i've created im users and i want",
    "start": "1051120",
    "end": "1056559"
  },
  {
    "text": "them to be able to rotate their creds or i have certain im users and i want them to use virtual mfa and i don't have",
    "start": "1056559",
    "end": "1061919"
  },
  {
    "text": "access to their cell phone so i want them to be able to set up and deactivate mfa last but not least being able to use",
    "start": "1061919",
    "end": "1069360"
  },
  {
    "text": "tags as security attributes on ec2 instances variables are going to help you solve all of these problems now",
    "start": "1069360",
    "end": "1076080"
  },
  {
    "text": "variables are not something you define they're something that we provide to you so they're predefined and they are based",
    "start": "1076080",
    "end": "1081360"
  },
  {
    "text": "off of the existing keys so for example in the previous condition i showed a source ip and current time",
    "start": "1081360",
    "end": "1087520"
  },
  {
    "text": "they can also be principal specific keys such as the username or the user's unique id",
    "start": "1087520",
    "end": "1092880"
  },
  {
    "text": "if you're using some type of identity federation or using cognito you're going to have identity provider specific",
    "start": "1092880",
    "end": "1099120"
  },
  {
    "text": "keys such as facebook or amazon and if using enterprise federation with saml",
    "start": "1099120",
    "end": "1104240"
  },
  {
    "text": "you're going to have keys like the issuer or the audience so all these become tools that you can use inside of your",
    "start": "1104240",
    "end": "1109679"
  },
  {
    "text": "policies so this is what a policy looks like using variables and the",
    "start": "1109679",
    "end": "1115440"
  },
  {
    "text": "first thing i'm going to point out is the version it's like really important that you put the version in your policy",
    "start": "1115440",
    "end": "1121840"
  },
  {
    "text": "if you do not put the version in there it treats the variable as a literal and i cannot tell you how many times",
    "start": "1121840",
    "end": "1127360"
  },
  {
    "text": "i've seen people they forget to put the policy in there now if you're using the tools today tools actually put the version in there",
    "start": "1127360",
    "end": "1133760"
  },
  {
    "text": "for you but if you have a policy that you've been using for a couple of years i guarantee you doesn't have a version in there and if you try to go and replace it with",
    "start": "1133760",
    "end": "1140160"
  },
  {
    "text": "a variable it's not going to work then you're going to you're going to post to the forum you're going to scream at your computer you're going to do",
    "start": "1140160",
    "end": "1145200"
  },
  {
    "text": "whatever you do to vent and you're going to realize that you didn't have the version now you can use",
    "start": "1145200",
    "end": "1150240"
  },
  {
    "text": "variables and conditions so here's an example of the user id in the condition and you can also use it",
    "start": "1150240",
    "end": "1156559"
  },
  {
    "text": "as a variable in a resource iron so let's get back to that original",
    "start": "1156559",
    "end": "1162320"
  },
  {
    "text": "scenario of giving a user a home directory from the amazon console this is where experience comes into play",
    "start": "1162320",
    "end": "1169200"
  },
  {
    "text": "first thing i'll point out is we have the version the next thing is understanding what",
    "start": "1169200",
    "end": "1175039"
  },
  {
    "text": "apis the management console uses under the covers now the good news this is all documented and since you all read the",
    "start": "1175039",
    "end": "1181280"
  },
  {
    "text": "documentation you should know this correct so these are the things that you need to",
    "start": "1181280",
    "end": "1186720"
  },
  {
    "text": "to put in there which may not be really intuitive so when you get to the management console the first thing it does is it tries to get the bucket",
    "start": "1186720",
    "end": "1192160"
  },
  {
    "text": "location and it tries to get a list of all your buckets if you haven't granted that for all of your buckets the user is not",
    "start": "1192160",
    "end": "1198160"
  },
  {
    "text": "going to be able to see anything so that's really the reason why we got a access denied in the first example",
    "start": "1198160",
    "end": "1204080"
  },
  {
    "text": "that we looked at the second part of the policy here is for list bucket and list bucket",
    "start": "1204080",
    "end": "1209200"
  },
  {
    "text": "works on a resource of the bucket arm and what we want to be able to do is go",
    "start": "1209200",
    "end": "1215600"
  },
  {
    "text": "into the root of that bucket and look at anything that is in the root folder or anything in the phone",
    "start": "1215600",
    "end": "1221120"
  },
  {
    "text": "the home folder where there's a delimiter of a forward slash and this is using a string equals so",
    "start": "1221120",
    "end": "1226799"
  },
  {
    "text": "this will only evaluate to true if those are the paths now once you're",
    "start": "1226799",
    "end": "1231919"
  },
  {
    "text": "in the folder you need to be able to list all the objects so once again that's list bucket",
    "start": "1231919",
    "end": "1238240"
  },
  {
    "text": "on the bucket arn but in this case it's a string like because the various objects might follow",
    "start": "1238240",
    "end": "1244559"
  },
  {
    "text": "a pattern but they're not going to be explicit and so this is the home folder and i'm going to use a variable here instead of",
    "start": "1244559",
    "end": "1250320"
  },
  {
    "text": "using an explicit you know sally bob whatever you put and then an asterisk for everything",
    "start": "1250320",
    "end": "1255600"
  },
  {
    "text": "after and so this will allow them to see everything in their folder in any of the subfolders or sub objects",
    "start": "1255600",
    "end": "1261520"
  },
  {
    "text": "that they have last but not least we need to allow the user to be able to modify those",
    "start": "1261520",
    "end": "1267280"
  },
  {
    "text": "now this is where understanding how the s3 apis work come into play so for list bucket the resource has to",
    "start": "1267280",
    "end": "1274159"
  },
  {
    "text": "be the arm for most of the other s3 apis it's actually the full path including the bucket arm",
    "start": "1274159",
    "end": "1282240"
  },
  {
    "text": "and so here i'm allowing you to call any of the s3 apis as long as it's in the root of my",
    "start": "1282240",
    "end": "1288840"
  },
  {
    "text": "folder or anything in the subfolders",
    "start": "1288840",
    "end": "1294320"
  },
  {
    "text": "so let's get back to that original scenario so the goal is still sort of the same i want to create a single group",
    "start": "1294320",
    "end": "1299600"
  },
  {
    "text": "policy that limits access to a prefix in an amazon s3 bucket and this time i'm going to be using a user named bob and he's going to have a",
    "start": "1299600",
    "end": "1306799"
  },
  {
    "text": "path in that folder so i'm going to show you the the group policy that uses variables",
    "start": "1306799",
    "end": "1311919"
  },
  {
    "text": "we're going to enable the user to list the buckets in the amazon s3 console and i'm going to lock it down so that there's nothing else they can do inside",
    "start": "1311919",
    "end": "1318559"
  },
  {
    "text": "of my account so the first thing i need to do is actually log out as sally",
    "start": "1318559",
    "end": "1333120"
  },
  {
    "text": "sign back in his bob and if you guys haven't seen this before i'm logging in as an im user",
    "start": "1333120",
    "end": "1339039"
  },
  {
    "text": "because we all follow security best practices i'm using mfa",
    "start": "1339520",
    "end": "1347840"
  },
  {
    "text": "and now i'm going to log in and i'm going to go to the s3 console so unlike the experience for sally bob",
    "start": "1350000",
    "end": "1356480"
  },
  {
    "text": "is not going to get an access denied and just as the policy granted he can",
    "start": "1356480",
    "end": "1361919"
  },
  {
    "text": "see all of my buckets although he cannot log into any of them if he tries to go in he's just going to",
    "start": "1361919",
    "end": "1367280"
  },
  {
    "text": "get an axis denied so this is one of the the compromises you have to make they're going to be able to see all the buckets",
    "start": "1367280",
    "end": "1372320"
  },
  {
    "text": "they're not going to be able to touch them i can go into the test bucket that i granted him if i try to go into any",
    "start": "1372320",
    "end": "1378080"
  },
  {
    "text": "other folder he's going to get an access denied i can drill down into the home folder i can",
    "start": "1378080",
    "end": "1383600"
  },
  {
    "text": "drill down into my folder i can click on objects that are there",
    "start": "1383600",
    "end": "1390000"
  },
  {
    "text": "bob stores pictures of my daughter which is a little weird",
    "start": "1390000",
    "end": "1395039"
  },
  {
    "text": "good for bob so you can see that we were able to lock",
    "start": "1397440",
    "end": "1402799"
  },
  {
    "text": "down now what did i do in order to grant this to bob it's literally the policy that we looked at before but just to",
    "start": "1402799",
    "end": "1409360"
  },
  {
    "text": "prove to you that it's all live if i go in and i look at bob bob is a member of a bunch of groups that i've already set up",
    "start": "1409360",
    "end": "1416400"
  },
  {
    "text": "and so there's a reinvent s3 home folder and if i go and i look at the policy",
    "start": "1416400",
    "end": "1422960"
  },
  {
    "text": "i can boost that up a little bit sure enough it's the exact same policy we looked at",
    "start": "1423120",
    "end": "1428640"
  },
  {
    "text": "in the slides set of permissions the only real difference is you know i'm using the actual bucket",
    "start": "1428640",
    "end": "1434240"
  },
  {
    "text": "that i am using in production okay so that wasn't a fail that was",
    "start": "1434240",
    "end": "1440000"
  },
  {
    "text": "actually a success let's look at some of the other common scenarios that you want to do",
    "start": "1440000",
    "end": "1445279"
  },
  {
    "text": "so if you want your users to be able to manage and rotate their own credentials if you want them to be able to manage their own virtual mfa you're going to",
    "start": "1445279",
    "end": "1451520"
  },
  {
    "text": "have to grant the user access to the im console this can be a little bit intimidating because once you start granting im apis",
    "start": "1451520",
    "end": "1458240"
  },
  {
    "text": "you're like did i get it right did i just give this guy the ability to create users and and own the account so just like the s3",
    "start": "1458240",
    "end": "1465840"
  },
  {
    "text": "console you have to kind of be conscious of what the underlying apis are being called and so here's here's a two-part policy",
    "start": "1465840",
    "end": "1473200"
  },
  {
    "text": "the first part of the policy grants im list users and it does this for all",
    "start": "1473200",
    "end": "1478320"
  },
  {
    "text": "users and so just like in the s3 console where you could see all the buckets this is going to allow you to see all",
    "start": "1478320",
    "end": "1484240"
  },
  {
    "text": "the users now you're not really going to be able to see anything about those users other than their names what i'm going to",
    "start": "1484240",
    "end": "1491679"
  },
  {
    "text": "grant him in this case bob the ability to do is call i am get user get login profile which more or less",
    "start": "1491679",
    "end": "1498080"
  },
  {
    "text": "tells you if there's a username a password associated with it be able to list the groups and list the",
    "start": "1498080",
    "end": "1504559"
  },
  {
    "text": "access keys and i'm only going to do this if the user matches this variable and so this is a group policy for bob it'll be",
    "start": "1504559",
    "end": "1511279"
  },
  {
    "text": "bob for sally it'll be sally and so those are the only attributes they're going to be able to see",
    "start": "1511279",
    "end": "1516320"
  },
  {
    "text": "for that user so that'll get them into the management console but then how do i go about",
    "start": "1516320",
    "end": "1521600"
  },
  {
    "text": "allowing them to manage their own secrets per se so in here i have another policy and",
    "start": "1521600",
    "end": "1527120"
  },
  {
    "text": "this one grants them access to all of the access key apis create list delete",
    "start": "1527120",
    "end": "1532880"
  },
  {
    "text": "and also all the signing certificates if you're using those and once again i'm going to lock it down",
    "start": "1532880",
    "end": "1538400"
  },
  {
    "text": "so it matches only that user's id now last but not least",
    "start": "1538400",
    "end": "1543520"
  },
  {
    "text": "is virtual mfa and and i want to show you this one because you know you really should be using mfa for your accounts but for a system",
    "start": "1543520",
    "end": "1550159"
  },
  {
    "text": "administrator it can be difficult to get a hold of your users cell phone numbers to set",
    "start": "1550159",
    "end": "1555360"
  },
  {
    "text": "sorry their cell phones to set it up and so in this case you can enable your users to be able to",
    "start": "1555360",
    "end": "1561279"
  },
  {
    "text": "turn on mfa on their own so there's three parts of it the first part is to create a virtual",
    "start": "1561279",
    "end": "1567200"
  },
  {
    "text": "mfa device or delete it and for this one the rn is actually an mfa",
    "start": "1567200",
    "end": "1572799"
  },
  {
    "text": "these look similar so i'll try to point out the differences this is actually an mfa rn that matches the user's name now i",
    "start": "1572799",
    "end": "1578480"
  },
  {
    "text": "want to be able to allow the user to deactivate enable list or resync",
    "start": "1578480",
    "end": "1583520"
  },
  {
    "text": "r is a little bit different this is actually on the user's username arm and then last but not least is just a",
    "start": "1583520",
    "end": "1589760"
  },
  {
    "text": "little bit of way the console works in order for you to list the mfa device",
    "start": "1589760",
    "end": "1596240"
  },
  {
    "text": "even for yourself you have to be able to list all the devices in the account and so there's one action im list",
    "start": "1596240",
    "end": "1601840"
  },
  {
    "text": "virtual mfa devices and for that you have to be able to see all the mfa devices in the account so if we want to put this",
    "start": "1601840",
    "end": "1609520"
  },
  {
    "text": "all together and create a set of policies that allow users to self-manage their identities so two goals i want them to be well i",
    "start": "1609520",
    "end": "1617360"
  },
  {
    "text": "want to be able to log into the console i guess there's a third goal but i want them really to be able to manage their credentials and manage",
    "start": "1617360",
    "end": "1622400"
  },
  {
    "text": "their own virtual mfa i'm going to have three policies one that'll allow them get into the console",
    "start": "1622400",
    "end": "1627520"
  },
  {
    "text": "one allow them to rotate their credentials and one to allow them to manage virtual mfa so let me go",
    "start": "1627520",
    "end": "1634640"
  },
  {
    "text": "in here again and i'll switch over to bob and let me show you this this is what the im",
    "start": "1634640",
    "end": "1641279"
  },
  {
    "text": "console looks like as the system administrator so if i hit the dashboard i can see all the information",
    "start": "1641279",
    "end": "1647200"
  },
  {
    "text": "if i go into the groups i can see all the groups users roles one of the things i'll point out",
    "start": "1647200",
    "end": "1652799"
  },
  {
    "text": "in users here is there's a number of users they have passwords i can see when their password was last used i can see they",
    "start": "1652799",
    "end": "1658640"
  },
  {
    "text": "have access keys let's do a compare and contrast on what bob sees",
    "start": "1658640",
    "end": "1664320"
  },
  {
    "text": "so bob fires up the im console goes and he starts getting access denied",
    "start": "1664320",
    "end": "1669600"
  },
  {
    "text": "now this is good you want this because this is information he does not need to do his job",
    "start": "1669600",
    "end": "1675279"
  },
  {
    "text": "if he tries to look at the groups he tries to look at the roles he's going to keep getting access denied access tonight if i go to the users",
    "start": "1675279",
    "end": "1683200"
  },
  {
    "text": "just like being able to list all my buckets he's going to be able to list all the users but the difference is he can only see",
    "start": "1683200",
    "end": "1688799"
  },
  {
    "text": "details for himself so as far as bob's concerned no one's part of any groups no one has a password no one's ever used user",
    "start": "1688799",
    "end": "1695200"
  },
  {
    "text": "password no one has any access keys so there's a very limited amount of information that we're exposing to bob",
    "start": "1695200",
    "end": "1701600"
  },
  {
    "text": "now he can drill into his own account and he can see some information about",
    "start": "1701600",
    "end": "1707600"
  },
  {
    "text": "himself right some things and he's not allowed to look at the group policies because we don't want him inspecting it and",
    "start": "1707600",
    "end": "1714000"
  },
  {
    "text": "figuring out what permissions he's been granted but he can go in here and manage his own access keys so i can go in",
    "start": "1714000",
    "end": "1720799"
  },
  {
    "text": "i can create an access key right and now because all of you are",
    "start": "1720799",
    "end": "1727840"
  },
  {
    "text": "periodically rotating your access keys right that's best security practice yeah see there's",
    "start": "1727840",
    "end": "1733039"
  },
  {
    "text": "some nodding heads probably two or three of you who do this and so bob is going to go through and he",
    "start": "1733039",
    "end": "1740320"
  },
  {
    "text": "needs to rotate his keys he can create a second one then he can go in and he can deactivate",
    "start": "1740320",
    "end": "1747039"
  },
  {
    "text": "his key because he wants to test it make sure before he destroys that key that his application is still working",
    "start": "1747039",
    "end": "1754240"
  },
  {
    "text": "he's tested it he's like yep i don't need that key anymore i can go in and i can delete it of course he may determine he doesn't",
    "start": "1754240",
    "end": "1760080"
  },
  {
    "text": "need any keys at all and so he deletes those so this is how you can enable your users your developers to go in and do the",
    "start": "1760080",
    "end": "1766399"
  },
  {
    "text": "things on the by themselves and not have to do that as the the system",
    "start": "1766399",
    "end": "1771679"
  },
  {
    "text": "administrator now of course bob is using mfa and so he can go in there and he could keep keep his mfa he can go",
    "start": "1771679",
    "end": "1779279"
  },
  {
    "text": "in and resync it and enter in codes you can even go in there and deactivate it i hate showing that to you",
    "start": "1779279",
    "end": "1786000"
  },
  {
    "text": "but with the policy he has the ability to do that and so if i look at bob once again i've",
    "start": "1786000",
    "end": "1792559"
  },
  {
    "text": "switched over to the to the admin console just so you can see i'm there's three policy three groups he's a member of the",
    "start": "1792559",
    "end": "1798559"
  },
  {
    "text": "i am console policy the self-managed policy uh for secrets and then the self-managed policy for mfa",
    "start": "1798559",
    "end": "1805279"
  },
  {
    "text": "and just to prove that these are indeed the same policies that we looked at in the slides",
    "start": "1805279",
    "end": "1811840"
  },
  {
    "text": "i'll bump that up a little bit you can see no change it's it's literally if you want to use this the you get the slides",
    "start": "1811840",
    "end": "1818640"
  },
  {
    "text": "afterwards you want to use those permissions those those policies you can by the way it's all in the documentation now",
    "start": "1818640",
    "end": "1823840"
  },
  {
    "text": "i mean i make a joke about that but i know how many of us actually read it but these are all",
    "start": "1823840",
    "end": "1829520"
  },
  {
    "text": "available in in case you want to use them on your own",
    "start": "1829520",
    "end": "1836080"
  },
  {
    "text": "i want to get into an important topic and we got about 15 minutes left so that's about enough time to get into it and that's around ec2 resource level",
    "start": "1836080",
    "end": "1842799"
  },
  {
    "text": "permissions so if you've been with us for a while you probably knew that previously all the policies applied to",
    "start": "1842799",
    "end": "1848640"
  },
  {
    "text": "all amazon ec2 resources and about last summer or so we added the",
    "start": "1848640",
    "end": "1854240"
  },
  {
    "text": "ability for permissions to be set on a per resource so this is important because now you can go and say hey this",
    "start": "1854240",
    "end": "1860320"
  },
  {
    "text": "user you can only mess with instances hey in a certain region or you can only mess with this exact ec2",
    "start": "1860320",
    "end": "1867760"
  },
  {
    "text": "instance just to kind of show you what it was before if you need a developer who want to",
    "start": "1867760",
    "end": "1873760"
  },
  {
    "text": "grant them the ability to terminate instances you had to grant them the ability to terminate instances in your entire",
    "start": "1873760",
    "end": "1879919"
  },
  {
    "text": "account it's probably still some of you who are doing this so yes there is a better way",
    "start": "1879919",
    "end": "1887279"
  },
  {
    "text": "if you really wanted to you could go in and you could specify a resource that is down specific to",
    "start": "1887279",
    "end": "1892559"
  },
  {
    "text": "an actual instance id probably not always going to have those instance ids they're hard to remember",
    "start": "1892559",
    "end": "1898880"
  },
  {
    "text": "more commonly you might want to say hey you know what i'll let you mess around but only in this specific region you may be saying can we",
    "start": "1898880",
    "end": "1905760"
  },
  {
    "text": "do better of course tags come into play where now you can go in and you can use",
    "start": "1905760",
    "end": "1911279"
  },
  {
    "text": "tags not just as a way of filtering and and putting some metadata on it but you can also use it",
    "start": "1911279",
    "end": "1917039"
  },
  {
    "text": "as an attribute for enforcement and so in this case here i have a resource tag named department",
    "start": "1917039",
    "end": "1923519"
  },
  {
    "text": "and dev and so now if i applied this to our friend bob he would have the ability",
    "start": "1923519",
    "end": "1928799"
  },
  {
    "text": "to terminate instances as long as they were in u.s east and as long as there is a tag on it that",
    "start": "1928799",
    "end": "1935039"
  },
  {
    "text": "says a department of dev and i'll show you how i even get a little bit more specific in these types",
    "start": "1935039",
    "end": "1940080"
  },
  {
    "text": "of policies excuse me i'm sick so",
    "start": "1940080",
    "end": "1946399"
  },
  {
    "text": "afraid i'm gonna lose my voice so there's a number of resource types that are supported and then there are a",
    "start": "1946399",
    "end": "1951679"
  },
  {
    "text": "number of resource types that are not supported and this is where creating policies for ec2",
    "start": "1951679",
    "end": "1956960"
  },
  {
    "text": "is a little bit of science and it's a little bit of art so here are this here are the current resource types that are supported i",
    "start": "1956960",
    "end": "1963039"
  },
  {
    "text": "won't go through all of them once again they're in the documentation and then here is the subset of ec2",
    "start": "1963039",
    "end": "1968799"
  },
  {
    "text": "actions that support resource level permissions and this is the full list as of today unless they recently changed it without",
    "start": "1968799",
    "end": "1975760"
  },
  {
    "text": "me knowing so you have some of the common ones like i want to be able to prevent people from rebooting running",
    "start": "1975760",
    "end": "1981120"
  },
  {
    "text": "starting stopping or terminating instances and for those there's a set of",
    "start": "1981120",
    "end": "1986240"
  },
  {
    "text": "resources that we looked in the pre-previous slide that you can use with them and then there's some obvious ones that aren't on this list like describe",
    "start": "1986240",
    "end": "1993279"
  },
  {
    "text": "like all the describe and all the list apis so when you're using them you have to make sure that the resource is still",
    "start": "1993279",
    "end": "1999760"
  },
  {
    "text": "star so resource level permissions in ec2 is sort of a work in progress",
    "start": "1999760",
    "end": "2006240"
  },
  {
    "text": "now i mentioned this before you know you're probably using tags as a way to categorize your ec2 resources likewise you can use",
    "start": "2006240",
    "end": "2013440"
  },
  {
    "text": "them for enforcement so i have some convenience tags here around the name of it the stack that it is and then i have",
    "start": "2013440",
    "end": "2019200"
  },
  {
    "text": "added a tag as an owner an owner can be a really good tag in case you want to use that for saying hey",
    "start": "2019200",
    "end": "2024399"
  },
  {
    "text": "anyone can use this but unless you're the owner you can't terminate that instance and so tags are your friends in",
    "start": "2024399",
    "end": "2029760"
  },
  {
    "text": "accomplishing that so let's take a look at an ec2 resource level permissions",
    "start": "2029760",
    "end": "2036000"
  },
  {
    "text": "let's uh let's pretend you want to limit a user from starting stopping or terminating an instance unless he's",
    "start": "2036000",
    "end": "2042159"
  },
  {
    "text": "unless there's a tag on it that specifies he's the owner i'll show you how you can add a tag and",
    "start": "2042159",
    "end": "2047360"
  },
  {
    "text": "i'm going to look at a policy that grants a user access to the ec2 console so just like the previous two examples",
    "start": "2047360",
    "end": "2053599"
  },
  {
    "text": "you got to let them into the console some way and i'm going to use a policy variable to limit what that user can do",
    "start": "2053599",
    "end": "2059200"
  },
  {
    "text": "once they're in the console so once again in bob i'm going to switch",
    "start": "2059200",
    "end": "2065358"
  },
  {
    "text": "over to ec2 i don't currently have any running instances",
    "start": "2065359",
    "end": "2072560"
  },
  {
    "text": "but one of the things that you can see in here is i have an owner tag now you're surprised when people don't",
    "start": "2072560",
    "end": "2078398"
  },
  {
    "text": "know how to do this but you can go in and this is where",
    "start": "2078399",
    "end": "2084480"
  },
  {
    "text": "resolution failed me i can go in here and i can add a tag you know maybe it's my stack and maybe i want it",
    "start": "2085359",
    "end": "2092079"
  },
  {
    "text": "to be production or something like that and then within the ui here you can go and make a configuration",
    "start": "2092079",
    "end": "2098880"
  },
  {
    "text": "so you see the owner column now you see it now you don't now you see it that's how you turn that",
    "start": "2098880",
    "end": "2104079"
  },
  {
    "text": "on tags are nice because i can go in here and i can filter on it and so i can see",
    "start": "2104079",
    "end": "2109760"
  },
  {
    "text": "this is the only instance that bob has access to so if i want to i can start that",
    "start": "2109760",
    "end": "2114839"
  },
  {
    "text": "instance everything works great let me turn off the filter show you there are instances that are",
    "start": "2114839",
    "end": "2120960"
  },
  {
    "text": "also opened by owned by me so if i go in here try to start that",
    "start": "2120960",
    "end": "2126800"
  },
  {
    "text": "instance it's going to get a failure no matter how often you hit that it's going to be the same result",
    "start": "2126800",
    "end": "2134000"
  },
  {
    "text": "and so let me switch over to the to the admin view of this and once again here's here's bob these are the list of",
    "start": "2134000",
    "end": "2142240"
  },
  {
    "text": "groups he's a member of and the policies and so there's one policy and i'll show you this in a",
    "start": "2142240",
    "end": "2147359"
  },
  {
    "text": "slide because it's much easier to see that way that grants him access to the management console",
    "start": "2147359",
    "end": "2153280"
  },
  {
    "text": "and then i have a second policy maybe i stuck him no i'm sorry i stuck them all in here at one there's one policy here",
    "start": "2153280",
    "end": "2159520"
  },
  {
    "text": "that grants access to the management console and then the second part of the statement here is what",
    "start": "2159520",
    "end": "2165520"
  },
  {
    "text": "actually limits what he can do from within now i've been running this it's probably",
    "start": "2165520",
    "end": "2171599"
  },
  {
    "text": "at this point it's running oh wait i'm installed admin go in here and look okay that",
    "start": "2171599",
    "end": "2177119"
  },
  {
    "text": "instance is running so it's kind of just to complete the demo i can prove to you that he can even in fact stop",
    "start": "2177119",
    "end": "2185119"
  },
  {
    "text": "and i'm so confident in this policy i'll just show you that even over here if you were to go and try to terminate",
    "start": "2185119",
    "end": "2192000"
  },
  {
    "text": "it's going to get an access denied so",
    "start": "2192000",
    "end": "2201359"
  },
  {
    "text": "okay so locking down access to ec2 instances as i promised there's really multiple parts in here there's",
    "start": "2201359",
    "end": "2207760"
  },
  {
    "text": "how do i allow the user to see everything they need in the management console now",
    "start": "2207760",
    "end": "2213359"
  },
  {
    "text": "there's an ec2 readers template i believe and i think you can use that and that's more or less the top",
    "start": "2213359",
    "end": "2219440"
  },
  {
    "text": "so these are all just the describe or list there's no destructive actions per se and for these",
    "start": "2219440",
    "end": "2226240"
  },
  {
    "text": "they don't support resource level permissions so this was have to be a resource of star",
    "start": "2226240",
    "end": "2232480"
  },
  {
    "text": "and then down here these are the actions that you really want to lock down so reboot start stop terminate and i'm limiting him to",
    "start": "2232480",
    "end": "2239680"
  },
  {
    "text": "the u.s east region when there's a tag of owner that matches",
    "start": "2239680",
    "end": "2244960"
  },
  {
    "text": "his username and so this is a group policy that you could use for any user that you would want to lock down",
    "start": "2244960",
    "end": "2250079"
  },
  {
    "text": "access and it's just highlighting some of the various parts of that policy",
    "start": "2250079",
    "end": "2257838"
  },
  {
    "text": "okay ready for a quiz there are no prizes for right answers i",
    "start": "2258720",
    "end": "2264400"
  },
  {
    "text": "told you you couldn't ask me questions but i'm going to ask you questions so anyone know why this policy doesn't",
    "start": "2264400",
    "end": "2270880"
  },
  {
    "text": "work",
    "start": "2270880",
    "end": "2273119"
  },
  {
    "text": "yes that's correct so the answer is not all ec2 actions support resource",
    "start": "2279520",
    "end": "2285119"
  },
  {
    "text": "level permissions so when you in fact put in ec2 star we have to try and evaluate every action",
    "start": "2285119",
    "end": "2291119"
  },
  {
    "text": "and eventually we're going to get to one that doesn't support this resource iron and in that case it's",
    "start": "2291119",
    "end": "2296640"
  },
  {
    "text": "going to fail and when things fail we default to access denied",
    "start": "2296640",
    "end": "2302240"
  },
  {
    "text": "so the solution in this case is if you want to grant ec2 star the only way to put it in is a resource star",
    "start": "2302640",
    "end": "2308320"
  },
  {
    "text": "and i don't recommend creating that policy so what if you wanted to run terminate stop and start from the",
    "start": "2308320",
    "end": "2314560"
  },
  {
    "text": "management console and you know anyone know why this one won't work",
    "start": "2314560",
    "end": "2320240"
  },
  {
    "text": "sorry you need console access but i've given describe star",
    "start": "2320960",
    "end": "2327839"
  },
  {
    "text": "there you go describe star does not support resource level permissions so once again this is going to",
    "start": "2329599",
    "end": "2334960"
  },
  {
    "text": "fault and default to access denied because we can't interpret the policy",
    "start": "2334960",
    "end": "2340320"
  },
  {
    "text": "okay so i've taken all the described apis and i put it into a separate action where the resource",
    "start": "2340320",
    "end": "2346079"
  },
  {
    "text": "is star so is that going to work",
    "start": "2346079",
    "end": "2350720"
  },
  {
    "text": "sort of a trick question the answer is no but the reason might not be obvious if you want to run an instance launch an instance",
    "start": "2352320",
    "end": "2359280"
  },
  {
    "text": "you're going to need access to additional actions and resources such as access to instances key pairs security groups",
    "start": "2359280",
    "end": "2365839"
  },
  {
    "text": "volumes armies and so this would be the final policy that you would want in case you",
    "start": "2365839",
    "end": "2372000"
  },
  {
    "text": "wanted person to be able to describe certain things now they're not going to be able to list that if you want to go further you'd",
    "start": "2372000",
    "end": "2377040"
  },
  {
    "text": "have to also add list actions and everything to get into the management console now you can see why people have a difficult time trying to build up these",
    "start": "2377040",
    "end": "2383520"
  },
  {
    "text": "types of policies so i promised you i would go a little",
    "start": "2383520",
    "end": "2388880"
  },
  {
    "text": "bit through enforcement and this is important so that you understand how these policies then get",
    "start": "2388880",
    "end": "2395200"
  },
  {
    "text": "evaluated so policies remember can come from multiple places we look you know it can be on im entities like",
    "start": "2395200",
    "end": "2401599"
  },
  {
    "text": "users groups and roles they can also come from a resource so an s3 bucket an sqs queue",
    "start": "2401599",
    "end": "2408480"
  },
  {
    "text": "an sns topic one of the things i didn't cover today but if you were in the federation or delegation sessions",
    "start": "2408480",
    "end": "2414480"
  },
  {
    "text": "yesterday policies can also be passed in when you're creating requesting a session from sts and when",
    "start": "2414480",
    "end": "2421200"
  },
  {
    "text": "we get a policy we go through a well-defined evaluation logic so a request very",
    "start": "2421200",
    "end": "2426240"
  },
  {
    "text": "simple it can be allowed or it can be denied i mentioned this before but if there's a",
    "start": "2426240",
    "end": "2431680"
  },
  {
    "text": "deny in the policy it always trumps an allow if you're not allowed and there's no",
    "start": "2431680",
    "end": "2437440"
  },
  {
    "text": "deny well you're still denied because we deny by default it's just the way the system works",
    "start": "2437440",
    "end": "2443040"
  },
  {
    "text": "and then we're always evaluating all permissions so we're looking at if you have a user policy and you're a",
    "start": "2443040",
    "end": "2448720"
  },
  {
    "text": "member of a group and there's a bucket policy we take the union of all of them to figure out what your permissions are and so this is",
    "start": "2448720",
    "end": "2455760"
  },
  {
    "text": "what happens when we walk through it so by default you're making a request we assume it's going to be denied",
    "start": "2455760",
    "end": "2461119"
  },
  {
    "text": "we go and retrieve all the policy that are associated with the user in the resource and only the policies that match the",
    "start": "2461119",
    "end": "2466960"
  },
  {
    "text": "action and conditions are evaluated and so we look at that and we say is there an explicit deny so it doesn't",
    "start": "2466960",
    "end": "2472640"
  },
  {
    "text": "matter if the deny is at the bottom of the policy top of the policy we'll look through the whole thing if there's a deny",
    "start": "2472640",
    "end": "2479119"
  },
  {
    "text": "then you're denied if there's not a deny is there an allow if there's an allow very simple you've",
    "start": "2479119",
    "end": "2485200"
  },
  {
    "text": "been granted access to that resource if there's no deny and there's no allow you're still denied access you're back",
    "start": "2485200",
    "end": "2491520"
  },
  {
    "text": "to where you started makes sense everyone feel like they have a great understanding",
    "start": "2491520",
    "end": "2498240"
  },
  {
    "text": "good because now we got to my summary side so just a couple things that i want to reiterate before people take off",
    "start": "2498240",
    "end": "2504800"
  },
  {
    "text": "so as you probably already know im provides access to your account we took a look at the policy language",
    "start": "2504800",
    "end": "2509839"
  },
  {
    "text": "which is the way that we authorize that access when we go through the evaluation we look at all the applicable policies and",
    "start": "2509839",
    "end": "2515920"
  },
  {
    "text": "of course deny is always trump and allow and then you know if you're creating policies use policy variables they're",
    "start": "2515920",
    "end": "2522880"
  },
  {
    "text": "your friend they make things easier and when you use a policy what do you use a policy variable what do you do you",
    "start": "2522880",
    "end": "2529359"
  },
  {
    "text": "put the version number in there okay ec2 is a little bit tricky this is where the documentation is going to be",
    "start": "2529359",
    "end": "2535680"
  },
  {
    "text": "your friend speaking of documentation here's a couple of my favorite things to look at include",
    "start": "2535680",
    "end": "2540800"
  },
  {
    "text": "including the the doc that you would need to go to find out what actions support what resources for ec2",
    "start": "2540800",
    "end": "2547280"
  },
  {
    "text": "there's uh the aws security blog which i recommend if you're not already following there's a couple policies specific a",
    "start": "2547280",
    "end": "2553839"
  },
  {
    "text": "couple articles specifically on ec2 resource permissions such as demystifying ec2 resource level",
    "start": "2553839",
    "end": "2559680"
  },
  {
    "text": "permissions and another one that shows you how to grant access to the management console of course we",
    "start": "2559680",
    "end": "2565440"
  },
  {
    "text": "have our website and our forum if you have a question pretty good chance i might reply to it",
    "start": "2565440",
    "end": "2571839"
  },
  {
    "text": "and of course you can follow us on twitter now before all of you disappear",
    "start": "2571839",
    "end": "2577280"
  },
  {
    "text": "this is security session 303 i kindly ask you to go in and fill out the evaluations it helps me improve year",
    "start": "2577280",
    "end": "2584720"
  },
  {
    "text": "over year it helps us improve the conference and we really do take the feedback serious so with that thank you once",
    "start": "2584720",
    "end": "2590960"
  },
  {
    "text": "again for sticking around and hope you enjoy the rest of time",
    "start": "2590960",
    "end": "2599280"
  }
]