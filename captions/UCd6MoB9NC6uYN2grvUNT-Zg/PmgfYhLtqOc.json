[
  {
    "start": "0",
    "end": "120000"
  },
  {
    "text": "hey everyone my name is Ian ward and I'm going to talk today about how mapbox",
    "start": "0",
    "end": "6930"
  },
  {
    "text": "uses the ideas edge to deliver fast Maps for Mobile cars and web users around the",
    "start": "6930",
    "end": "12900"
  },
  {
    "text": "world so that's yeah a little bit about me first actually I work at matte box on the",
    "start": "12900",
    "end": "20310"
  },
  {
    "text": "engineering team actually the platform team and the security team and been there since mattebox started and before",
    "start": "20310",
    "end": "26779"
  },
  {
    "text": "matte box i worked at the company within which matte box was bootstrapped oh and",
    "start": "26779",
    "end": "32250"
  },
  {
    "text": "all i've been working in site reliability and security for the past 13 years or so",
    "start": "32250",
    "end": "38120"
  },
  {
    "text": "there are actually 15 I think you 15 people now from at box at reinvent and",
    "start": "38120",
    "end": "43770"
  },
  {
    "text": "we have a booth so I encourage you to come by the booth we love hearing about how other people are using it to us and",
    "start": "43770",
    "end": "49980"
  },
  {
    "text": "we like sharing as well so come on by we're excited to talk so a little bit about this talk that",
    "start": "49980",
    "end": "57600"
  },
  {
    "text": "title was really long what is the talk actually about so we use cloud for on route 53 and the",
    "start": "57600",
    "end": "65460"
  },
  {
    "text": "eight of us laugh quite a bit and the talk is really about not just like not",
    "start": "65460",
    "end": "70920"
  },
  {
    "text": "how we like configure every single detail about these services but more about how we think about their use how",
    "start": "70920",
    "end": "77759"
  },
  {
    "text": "we analyze and reanalyze how we're using them and in order to like move our",
    "start": "77759",
    "end": "83580"
  },
  {
    "text": "business forward and also do it in a way that's improving reliability and performance and just very",
    "start": "83580",
    "end": "90799"
  },
  {
    "text": "being efficient about cost so first I'll give some context about",
    "start": "90799",
    "end": "95820"
  },
  {
    "text": "what Matt box actually is because some of that is important about what I later",
    "start": "95820",
    "end": "101070"
  },
  {
    "text": "talked about and then I'll talk a bit about costs and performance and then configuration kind of briefly and then",
    "start": "101070",
    "end": "108030"
  },
  {
    "text": "operations but the operations section is going to touch on some of the things I touch on in the other two sections and",
    "start": "108030",
    "end": "113850"
  },
  {
    "text": "then at the end we'll talk about security and specifically the aid of aswath and how we're using it",
    "start": "113850",
    "end": "120380"
  },
  {
    "start": "120000",
    "end": "206000"
  },
  {
    "text": "so first of all what is matte box mapbox is a mapping platform for other",
    "start": "120380",
    "end": "126000"
  },
  {
    "text": "businesses as well as developers it allows you to we have basically building",
    "start": "126000",
    "end": "131819"
  },
  {
    "text": "blocks to let you build a local location based application or maybe you have an application you need like a location",
    "start": "131819",
    "end": "137819"
  },
  {
    "text": "components in it so we offer a lot of different API is to make that possible go through some examples here this is",
    "start": "137819",
    "end": "144490"
  },
  {
    "text": "for sport calm so there are a social networking site they've been around for a long time if you look at their site",
    "start": "144490",
    "end": "149940"
  },
  {
    "text": "it's you use it till I find a find a place to grab drink or a meal with",
    "start": "149940",
    "end": "156790"
  },
  {
    "text": "friends and you look at their site their site wouldn't really exist without a map it's a big component of it so these are",
    "start": "156790",
    "end": "161800"
  },
  {
    "text": "map tiles that you're looking at with points of interest on them and then",
    "start": "161800",
    "end": "166810"
  },
  {
    "text": "this is the weather channel's mobile app so the weather company where they're",
    "start": "166810",
    "end": "173320"
  },
  {
    "text": "mapping the atmosphere they use now boxes base map upon which to map the",
    "start": "173320",
    "end": "178390"
  },
  {
    "text": "atmosphere and and this is a square so if you make a payment with the square you can get the",
    "start": "178390",
    "end": "184390"
  },
  {
    "text": "receipt on your mobile phone and they have a map component in there and it's kind of like you can think of it maybe",
    "start": "184390",
    "end": "190360"
  },
  {
    "text": "one way to think of it as a security feature shows where you made that purchase and so they're over 5,000 different",
    "start": "190360",
    "end": "197380"
  },
  {
    "text": "platforms that are using matte box in different ways and they're all over the",
    "start": "197380",
    "end": "203350"
  },
  {
    "text": "world big companies and small companies so first it all starts with a design",
    "start": "203350",
    "end": "209140"
  },
  {
    "start": "206000",
    "end": "231000"
  },
  {
    "text": "design and data tools we have a flagship web application called matte box to do and this is at a box a calm / to you and",
    "start": "209140",
    "end": "216160"
  },
  {
    "text": "it lets you build a very custom looking map upload data and style that map",
    "start": "216160",
    "end": "221709"
  },
  {
    "text": "according to like what's actually in the data so you can make it look exactly the",
    "start": "221709",
    "end": "227380"
  },
  {
    "text": "way you want it to and how you need it to to match your application so we have",
    "start": "227380",
    "end": "232480"
  },
  {
    "start": "231000",
    "end": "349000"
  },
  {
    "text": "a bunch of AP is and SDKs that you can use to access those AP is so we have a",
    "start": "232480",
    "end": "237940"
  },
  {
    "text": "JavaScript a JavaScript SDK with a Python SDK mobile SDKs for Android and",
    "start": "237940",
    "end": "243459"
  },
  {
    "text": "iOS a few others so let's look at some API requests these are going to come up",
    "start": "243459",
    "end": "249100"
  },
  {
    "text": "later and this is a map tile so those tiles that you saw on the foursquare com",
    "start": "249100",
    "end": "254470"
  },
  {
    "text": "site and this is an example of one of those tiles this is zoom level 0 so you're looking at like a 256 pixel x 256",
    "start": "254470",
    "end": "262750"
  },
  {
    "text": "pixel image this is a raster image we also have better tiles which are tiles",
    "start": "262750",
    "end": "267820"
  },
  {
    "text": "that are rendered on the client side in this case the average size of a tie like this is",
    "start": "267820",
    "end": "273190"
  },
  {
    "text": "like 8 kilobytes to 25 kilobytes kind of varies depending on detail or what",
    "start": "273190",
    "end": "278620"
  },
  {
    "text": "features are actually in the tile and I'll bring up why that's important later so if you zoom in each time you zoom in",
    "start": "278620",
    "end": "286240"
  },
  {
    "text": "zoom level one tile turns into four tiles and this just keeps going so by the time you're at zoom level 17 you've",
    "start": "286240",
    "end": "292120"
  },
  {
    "text": "got 17 billion tiles now looking at another example API is",
    "start": "292120",
    "end": "297880"
  },
  {
    "text": "geocoding so this is where you put in like say you know I'm in Las Vegas it will turn back with a lot of large two",
    "start": "297880",
    "end": "304600"
  },
  {
    "text": "days of Las Vegas or you can do the reverse say you have a you're building a mobile app and you want to I know where",
    "start": "304600",
    "end": "311680"
  },
  {
    "text": "nobody actually are you can send the latitude and longitude to the API and it will return back where you actually are",
    "start": "311680",
    "end": "317520"
  },
  {
    "text": "the point of interest or the place name and here's another example oh and yeah",
    "start": "317520",
    "end": "323770"
  },
  {
    "text": "those requests or an average of three kilobytes on response and then directions this is turn-by-turn",
    "start": "323770",
    "end": "329680"
  },
  {
    "text": "directions so provide a starting point at any point and you get back turn-by-turn directions something that",
    "start": "329680",
    "end": "335530"
  },
  {
    "text": "we're really pushing on recently is matte box drive so this is the idea of not just providing those directions but",
    "start": "335530",
    "end": "341560"
  },
  {
    "text": "also feeding in real-time traffic information and influencing the the directions that you get back based on",
    "start": "341560",
    "end": "346960"
  },
  {
    "text": "things like real-time traffic so we have a lot of other AP ice as well",
    "start": "346960",
    "end": "352030"
  },
  {
    "start": "349000",
    "end": "379000"
  },
  {
    "text": "you can check them out on the on the site and yeah the ideas they just a tool",
    "start": "352030",
    "end": "357730"
  },
  {
    "text": "set to build location application that you need to build all these api is",
    "start": "357730",
    "end": "363130"
  },
  {
    "text": "something similar with all in this they have an access token that needs to be passed in in the party stream so this",
    "start": "363130",
    "end": "368770"
  },
  {
    "text": "access token is used for authentication making sure you're allowed to make that request and also things like rate",
    "start": "368770",
    "end": "374320"
  },
  {
    "text": "limiting so i'm going to bring up why this is important a bit later it's just a JSON web token and yeah so a little",
    "start": "374320",
    "end": "380980"
  },
  {
    "start": "379000",
    "end": "421000"
  },
  {
    "text": "bit about our traffic raba raba traffic its global our customers are all around the world their users were all around",
    "start": "380980",
    "end": "386290"
  },
  {
    "text": "the world so this is an idea like our mobile sdk",
    "start": "386290",
    "end": "391960"
  },
  {
    "text": "actually sends back anonymous probe information about traffic conditions",
    "start": "391960",
    "end": "398430"
  },
  {
    "text": "and so like this is just a couple of days of like probe information coming",
    "start": "398430",
    "end": "404820"
  },
  {
    "text": "back to our endpoints and for a couple days we have ninety eight ninety five percent Road coverage this is several",
    "start": "404820",
    "end": "410010"
  },
  {
    "text": "months ago so i think it's different now but this this is this is the type of coverage is basically showing where are",
    "start": "410010",
    "end": "415590"
  },
  {
    "text": "the users of our sdk are in the world and similar in a lot of other major cities so based on that where's our",
    "start": "415590",
    "end": "423420"
  },
  {
    "start": "421000",
    "end": "442000"
  },
  {
    "text": "infrastructure our infrastructure is global we're running in so the small dots here or cloud front and there are",
    "start": "423420",
    "end": "430590"
  },
  {
    "text": "few missing there they've added a bunch of regions actually recently and then the larger dots are where our origins",
    "start": "430590",
    "end": "436320"
  },
  {
    "text": "running we're running running in six to nine origins depending on the actual the API",
    "start": "436320",
    "end": "441890"
  },
  {
    "text": "and we have over 200 million monthly active users and we're doing billions of",
    "start": "441890",
    "end": "447240"
  },
  {
    "start": "442000",
    "end": "643000"
  },
  {
    "text": "requests a day so you know like the those tiles I showed you there's a lot of tiles that make up the world and so",
    "start": "447240",
    "end": "452730"
  },
  {
    "text": "you know you go to a site like foursquare com or another site that consists of a map on the on the web app",
    "start": "452730",
    "end": "459720"
  },
  {
    "text": "and it loads a lot of titles so we just end up doing a lot of requests so let's get into a little bit about cost and",
    "start": "459720",
    "end": "465780"
  },
  {
    "text": "performance how we think about that we started in u.s. East one when we first started just",
    "start": "465780",
    "end": "471630"
  },
  {
    "text": "in one region but something that we started with was cloud front right from the very beginning it was very easy to",
    "start": "471630",
    "end": "477240"
  },
  {
    "text": "turn on and there were immediate performance and cost benefits to doing that it's it's something that you can",
    "start": "477240",
    "end": "484140"
  },
  {
    "text": "definitely tune over time but we just started using it right away and here's a picture of what our origin",
    "start": "484140",
    "end": "490080"
  },
  {
    "text": "looks like so the requests come in for the clients and the hit route 23 so they hit like API matte box calm and from",
    "start": "490080",
    "end": "497940"
  },
  {
    "text": "there they'll be routed to the nearest cloud for an edge location and from",
    "start": "497940",
    "end": "502980"
  },
  {
    "text": "there they'll then go to we use route freeze latency based routing so they'll go to one of the nine regions based on",
    "start": "502980",
    "end": "509670"
  },
  {
    "text": "whatever is least latent from that location and then from there they'll hit",
    "start": "509670",
    "end": "514830"
  },
  {
    "text": "the actual region and there's an elastic load balancer and then they'll hit our application servers which were at NEC to",
    "start": "514830",
    "end": "521310"
  },
  {
    "text": "now we're using ecs service and tasks and those will make lookaside cash lookups we're running",
    "start": "521310",
    "end": "528690"
  },
  {
    "text": "right us on ec2 on the spot market and from there we also make database",
    "start": "528690",
    "end": "534360"
  },
  {
    "text": "request a dynamo DB and then to s3 we have a lot of our geographic like raw data stored in s3 and a lot of that data",
    "start": "534360",
    "end": "542400"
  },
  {
    "text": "actually comes from open street map so if you don't open street map org you can sign up anybody can create an account",
    "start": "542400",
    "end": "547830"
  },
  {
    "text": "there and edit data on this like global base map and we have",
    "start": "547830",
    "end": "552950"
  },
  {
    "text": "pipeline that we pull in these changes so let's look at a some of our headers",
    "start": "552950",
    "end": "558480"
  },
  {
    "text": "here some of our response headers you can see we have cast control headers we have a max age of 12 hours and an s max",
    "start": "558480",
    "end": "565770"
  },
  {
    "text": "age of seven days in this example request here for a satellite tile and",
    "start": "565770",
    "end": "571130"
  },
  {
    "text": "you can also see a couple other things you have an e-tag set and last modified header set so let's talk about that",
    "start": "571130",
    "end": "578670"
  },
  {
    "text": "cache control headers setting so why do we use both a max age and an s max age",
    "start": "578670",
    "end": "583830"
  },
  {
    "text": "well as I said like a lot of the data and the base map is coming from open street map so we have like",
    "start": "583830",
    "end": "589790"
  },
  {
    "text": "systems that try to detect things like validation errors or vandalism sometimes it's an open community someone can come",
    "start": "589790",
    "end": "596730"
  },
  {
    "text": "in and vandalize the map where maybe there's just an error that's made if that somehow sneaks in through our validation systems and gets onto the map",
    "start": "596730",
    "end": "604620"
  },
  {
    "text": "we don't want that object to sit in somebody's browser forever for a very long time right so we have a lower max",
    "start": "604620",
    "end": "610529"
  },
  {
    "text": "age and then the SMS age is actually what cloud front will use if you send if",
    "start": "610529",
    "end": "616290"
  },
  {
    "text": "you set both of these headers platform will honor the s-max age so it's the shared cache age and clever has an",
    "start": "616290",
    "end": "622529"
  },
  {
    "text": "invalidation API and we've had to use at API sometimes in the past and you know",
    "start": "622529",
    "end": "628050"
  },
  {
    "text": "even for clearing like millions of objects that are in the cache it's effective at doing that so that's why",
    "start": "628050",
    "end": "633420"
  },
  {
    "text": "we're able to set such a longer smax age and that leads to a much longer a much",
    "start": "633420",
    "end": "639270"
  },
  {
    "text": "better cache hit rate i'll talk about how we look at those cash it rates in a bit so let's just look an example here this",
    "start": "639270",
    "end": "646020"
  },
  {
    "start": "643000",
    "end": "737000"
  },
  {
    "text": "is an example of a 1 million requests say you have an average tile like an average child size of 8 kilobytes if you",
    "start": "646020",
    "end": "653940"
  },
  {
    "text": "run one ec to say you do these 1 million requests in 24 hours you run one ec2 and",
    "start": "653940",
    "end": "659279"
  },
  {
    "text": "m3 x-large if you got an email elb you have to run a maybe a database server we use DynamoDB but in this example i",
    "start": "659279",
    "end": "665780"
  },
  {
    "text": "simplified it so our dsq run for 24 hours it's an r3 and then you have to",
    "start": "665780",
    "end": "672410"
  },
  {
    "text": "like to also pay for the requests on the edge they go through the edge the data transfer all that to do 1 million",
    "start": "672410",
    "end": "678560"
  },
  {
    "text": "requests to seventeen dollars if you compare that to if you had a one hundred percent cash it rate it would be it",
    "start": "678560",
    "end": "684260"
  },
  {
    "text": "would be just three dollars so that's like that's an astonishing difference it's also very difficult to reach a",
    "start": "684260",
    "end": "692020"
  },
  {
    "text": "hundred percent cash it rate especially like with what we're doing with with",
    "start": "692020",
    "end": "697190"
  },
  {
    "text": "billions of tiles there's a long tail of content and CloudFront uses an lr you to",
    "start": "697190",
    "end": "702290"
  },
  {
    "text": "determine like what sits in the cash you know if even if you SAT like a 70s max age that object may not sit in there for",
    "start": "702290",
    "end": "709160"
  },
  {
    "text": "seven days if if nobody's requesting it so but but the closer you can get to",
    "start": "709160",
    "end": "714290"
  },
  {
    "text": "that you're closer you're getting to the savings at something like this rate so if you look back what our origin",
    "start": "714290",
    "end": "719840"
  },
  {
    "text": "actually looks like it's pretty expensive it's really expensive compared to a cloud front so this is why we pay",
    "start": "719840",
    "end": "725960"
  },
  {
    "text": "very close attention to our content and also to like how cache hit rates are",
    "start": "725960",
    "end": "731390"
  },
  {
    "text": "behaving and a look at a touch on a little bit more about how much in detail we look at that in a bit",
    "start": "731390",
    "end": "737980"
  },
  {
    "text": "so getting the cash caching headers right is also very important for",
    "start": "737980",
    "end": "744440"
  },
  {
    "text": "performance so if you look at like we've looked at the average time taken so",
    "start": "744440",
    "end": "750080"
  },
  {
    "text": "cloud front they provide access logs in one of the fields they have in those aegises all access logs is the time",
    "start": "750080",
    "end": "755960"
  },
  {
    "text": "taken number and seen like definitely single digit latency on cache hits on",
    "start": "755960",
    "end": "762680"
  },
  {
    "text": "many edges and maybe on average around 12 milliseconds looking at a small sample from a given day but if you can",
    "start": "762680",
    "end": "771290"
  },
  {
    "text": "bro that compare that to a cache miss like what that what that request has to",
    "start": "771290",
    "end": "776839"
  },
  {
    "text": "do if it has to go through to the origin there's latency from the edge to the origin and then there's latency in the",
    "start": "776839",
    "end": "782660"
  },
  {
    "text": "origin so we have like lots of caches with application caches we have caches like the look aside red is cash but it",
    "start": "782660",
    "end": "788930"
  },
  {
    "text": "has to go all the way through there you're looking at a much worse performance this is an example our API",
    "start": "788930",
    "end": "794480"
  },
  {
    "text": "so all a little bit different and how they perform but yeah the Miss is just I",
    "start": "794480",
    "end": "799579"
  },
  {
    "text": "mean they have this hit here is ninety-six percent faster venomous and this is an actual example",
    "start": "799579",
    "end": "805060"
  },
  {
    "start": "805000",
    "end": "922000"
  },
  {
    "text": "so another thing is conditional requests this is something that we didn't",
    "start": "805060",
    "end": "810199"
  },
  {
    "text": "definitely didn't start off with right away when he started mapbox and we started using cloud front and has set up",
    "start": "810199",
    "end": "816350"
  },
  {
    "text": "our origin but conditional requests are the idea that so somebody's got this object cashed in their browser and",
    "start": "816350",
    "end": "823300"
  },
  {
    "text": "the object is expired okay but the person goes maybe the next day and they're going to go look at the same",
    "start": "823300",
    "end": "828889"
  },
  {
    "text": "place in the map and they want to load that and the browser is going to make a request",
    "start": "828889",
    "end": "833990"
  },
  {
    "text": "to cloud front they're going to say hey I got this object it's expired but do you have the object and is what I have",
    "start": "833990",
    "end": "840589"
  },
  {
    "text": "like actually the latest copy and so that's a conditional get and",
    "start": "840589",
    "end": "846040"
  },
  {
    "text": "so if you think about like what happens there if if you have if you're set up to handle this properly by setting these",
    "start": "846040",
    "end": "852019"
  },
  {
    "text": "headers having like an e-tag or the last modified date on your on your content then cloud front can handle that",
    "start": "852019",
    "end": "858999"
  },
  {
    "text": "if you don't then you're going to have to serve a 200 so the thing is that if",
    "start": "858999",
    "end": "864559"
  },
  {
    "text": "you do a conditional get clever enroll and its successful problem will return not",
    "start": "864559",
    "end": "871100"
  },
  {
    "text": "the entire pile back the map tile or whatever it is they the content is it will just return the headers back and",
    "start": "871100",
    "end": "877309"
  },
  {
    "text": "say hey you're good keep what you have and show it in the browser and this is not just between not just between the",
    "start": "877309",
    "end": "884269"
  },
  {
    "text": "clients and cloud round but it's also between cloudfront and the origin and this is also actually where we saw the",
    "start": "884269",
    "end": "890870"
  },
  {
    "text": "most impact we made adjustments here but cloudfront can also have the object in its cache it could be expired but if you",
    "start": "890870",
    "end": "898550"
  },
  {
    "text": "have these headers set properly Cloud Print ending can go make a conditional get back to your origin and say the same",
    "start": "898550",
    "end": "904399"
  },
  {
    "text": "thing have the same conversation and it will your origin can send back just the response headers no data actually in the",
    "start": "904399",
    "end": "911720"
  },
  {
    "text": "body and there's a remarkable savings in terms of transfer costs and and maybe even commute compute costs depending on",
    "start": "911720",
    "end": "917870"
  },
  {
    "text": "how your your origin is set up maybe you don't have to do like all the full compute so what does it look like actually reran",
    "start": "917870",
    "end": "924980"
  },
  {
    "start": "922000",
    "end": "1004000"
  },
  {
    "text": "this number 45 minutes ago because it was kind of like didn't pass my blink test here it didn't look right but",
    "start": "924980",
    "end": "930589"
  },
  {
    "text": "looking at just 1 billion conditional guests if you do a billion conditional gets if you're just doing if you're",
    "start": "930589",
    "end": "936860"
  },
  {
    "text": "doing like all those and handling successfully as like not modifying the conditional get three or four responses",
    "start": "936860",
    "end": "943610"
  },
  {
    "text": "it's just fifty fifty four dollars in transfer costs using cloud funds market rate on their on their website the",
    "start": "943610",
    "end": "950089"
  },
  {
    "text": "pricing that they advertise but if you have to do all 200s you're looking at",
    "start": "950089",
    "end": "955339"
  },
  {
    "text": "two thousand one hundred and twenty-five dollars it's a huge difference so getting these set right is definitely",
    "start": "955339",
    "end": "963019"
  },
  {
    "text": "worthwhile as you start to do more traffic so some takeaways about this section are",
    "start": "963019",
    "end": "968869"
  },
  {
    "text": "yeah definitely like we use this the CDN from the start there were clear",
    "start": "968869",
    "end": "974179"
  },
  {
    "text": "advantages to doing that didn't have a lot of overhead to configure it but then like you know knowing your content",
    "start": "974179",
    "end": "980329"
  },
  {
    "text": "knowing what you need to work types of cache headers you can you can set based on what the risks are is important and",
    "start": "980329",
    "end": "988429"
  },
  {
    "text": "then tuning over time so you know that conditional get handling wasn't something I think that we did a hit",
    "start": "988429",
    "end": "994819"
  },
  {
    "text": "until a couple years after launching the API but once we hit it it was super important and definitely goes into how",
    "start": "994819",
    "end": "1001449"
  },
  {
    "text": "we price things for our service so a little bit about configuration now",
    "start": "1001449",
    "end": "1007740"
  },
  {
    "start": "1004000",
    "end": "1183000"
  },
  {
    "text": "we have now we started off with just one one or two behaviors we just had one API",
    "start": "1007740",
    "end": "1014170"
  },
  {
    "text": "we just did maps in the gang now we have a lot of different api's we have like about thirteen different origins so",
    "start": "1014170",
    "end": "1020799"
  },
  {
    "text": "we've got directions origin we've got a geocoding origin maps origin and so on and sometimes these are actually",
    "start": "1020799",
    "end": "1026140"
  },
  {
    "text": "different teams or like different teams Matt Matt box who managed those origins",
    "start": "1026140",
    "end": "1032350"
  },
  {
    "text": "and the thing is that these are so these are cloud front behaviors behavior and cloud",
    "start": "1032350",
    "end": "1038980"
  },
  {
    "text": "front is what is basically it's like the router it says okay if this request has / directions in it send it to the",
    "start": "1038980",
    "end": "1045159"
  },
  {
    "text": "directions origin so it's really important to get the order of the behaviors correct so if you have like a",
    "start": "1045159",
    "end": "1052120"
  },
  {
    "text": "less less specific match above a more",
    "start": "1052120",
    "end": "1057460"
  },
  {
    "text": "specific match traffic will never make it to that more specific match so it's super important that they're in the",
    "start": "1057460",
    "end": "1062500"
  },
  {
    "text": "correct order so how do you yeah one of the questions is like if you have a bunch of teams and how do you manage this router it together and then not",
    "start": "1062500",
    "end": "1069820"
  },
  {
    "text": "only that but they're also like as you add a behavior here there are a lot of different options it's you know quadrant",
    "start": "1069820",
    "end": "1075640"
  },
  {
    "text": "is pretty flexible gives you a lot to work with if you look at the last one there it's about whether or not to",
    "start": "1075640",
    "end": "1080860"
  },
  {
    "text": "forward the query string so if you remember I said all of our API requests require an access token and that access",
    "start": "1080860",
    "end": "1087250"
  },
  {
    "text": "token is actually in the query string so if somebody sets up a behavior and they don't set this you know check this box",
    "start": "1087250",
    "end": "1093490"
  },
  {
    "text": "or let flip select to use passing the org passing the query string back to the origin then they won't warp right so how",
    "start": "1093490",
    "end": "1102220"
  },
  {
    "text": "do you do this when the options matter and in the order the order matters well we were",
    "start": "1102220",
    "end": "1108570"
  },
  {
    "text": "does everybody use or has heard of her knows about cloud formation",
    "start": "1108570",
    "end": "1113820"
  },
  {
    "text": "so yeah cloud formation yeah it's pretty popular cloud formation just to quickly",
    "start": "1113820",
    "end": "1119320"
  },
  {
    "text": "summarize it it's a lets you like right json template and instead of like going and clicking through the console the web",
    "start": "1119320",
    "end": "1125410"
  },
  {
    "text": "console to create all of your resources in AWS you can define them all and json template just says okay you can define",
    "start": "1125410",
    "end": "1131500"
  },
  {
    "text": "like an almost killing group or some ec tubes or policies you can even define a",
    "start": "1131500",
    "end": "1137230"
  },
  {
    "text": "cloud front distribution so our club printers tribution is in a cloud formation template and what's what this",
    "start": "1137230",
    "end": "1143470"
  },
  {
    "text": "allows us to do is commit that configuration to a github repository and then we can use things like Travis or",
    "start": "1143470",
    "end": "1151720"
  },
  {
    "text": "triple see I some other integration testing so whenever somebody makes so say we great we're creating a",
    "start": "1151720",
    "end": "1158110"
  },
  {
    "text": "new API and somebody goes in and adds that configuration into the",
    "start": "1158110",
    "end": "1163270"
  },
  {
    "text": "CloudFormation template like the additional behavior into the cloud front configuration in that Club formation",
    "start": "1163270",
    "end": "1169780"
  },
  {
    "text": "template if they don't define to pass back the query string it will fail the",
    "start": "1169780",
    "end": "1175330"
  },
  {
    "text": "tests so this is a way to kind of like allow a bunch of teams to manage this",
    "start": "1175330",
    "end": "1181600"
  },
  {
    "text": "configuration together so yeah some takeaways about this or yeah CloudFront just has there's a lot",
    "start": "1181600",
    "end": "1188260"
  },
  {
    "start": "1183000",
    "end": "1208000"
  },
  {
    "text": "of options it's about I think finding ways to manage that complexity some some things are like",
    "start": "1188260",
    "end": "1194100"
  },
  {
    "text": "even though you can configure cache control headers in the actual be the behavior you can also set those on",
    "start": "1194100",
    "end": "1201399"
  },
  {
    "text": "your origin so that's one way another way is doing things like testing the actual distribution configuration by",
    "start": "1201399",
    "end": "1207370"
  },
  {
    "text": "using cloud formation so now let's get into operations a lot of what I just talked about is going to come out in",
    "start": "1207370",
    "end": "1212740"
  },
  {
    "start": "1208000",
    "end": "1303000"
  },
  {
    "text": "different ways in these next two sections so we're some of our orders origins are",
    "start": "1212740",
    "end": "1220120"
  },
  {
    "text": "nine regions nine different regions and the way we do this is we use Amazon rafti three lanes of based routing with",
    "start": "1220120",
    "end": "1227139"
  },
  {
    "text": "failover and so like I was saying we use cloud formation for pretty much everything and",
    "start": "1227139",
    "end": "1234059"
  },
  {
    "text": "so with a say like the G recorder or API or like the directions API each of these",
    "start": "1234059",
    "end": "1240580"
  },
  {
    "text": "api is each of these origins will have its own separate what we call a service stack so we define all the resources for",
    "start": "1240580",
    "end": "1246580"
  },
  {
    "text": "the geocode or stack in a CloudFormation template and that'll be like a maybe a",
    "start": "1246580",
    "end": "1253139"
  },
  {
    "text": "auto scaling group maybe some tasks a service for ecs all this is actually in",
    "start": "1253139",
    "end": "1259539"
  },
  {
    "text": "the formation template and we use some of cloud formations features that let you do deploys so like cycling instances",
    "start": "1259539",
    "end": "1267429"
  },
  {
    "text": "we use some of these features in cloud formation to basically do all of our deployment through the cloud formation",
    "start": "1267429",
    "end": "1273850"
  },
  {
    "text": "API and so with our DNS records we'll have like a you know this is the map",
    "start": "1273850",
    "end": "1279429"
  },
  {
    "text": "like example of the map stack so how big this map service stack but then we'll have a DNS stack which is like just the",
    "start": "1279429",
    "end": "1286059"
  },
  {
    "text": "dns entries and the route 53 health check definitions in a CloudFormation template",
    "start": "1286059",
    "end": "1293019"
  },
  {
    "text": "and we call that the DNS attack so these records look like they're all",
    "start": "1293019",
    "end": "1298840"
  },
  {
    "text": "identical and they just the only thing that's different about them in there is that the region that they're in and so",
    "start": "1298840",
    "end": "1304779"
  },
  {
    "start": "1303000",
    "end": "1408000"
  },
  {
    "text": "like what could go wrong right the reason why we're running in nine regions is not just for performance but it's also for reliability but like yeah just",
    "start": "1304779",
    "end": "1312250"
  },
  {
    "text": "because you're running a nine regions doesn't mean nothing's going to go wrong it means more stuff is going to go wrong because you have more you know more",
    "start": "1312250",
    "end": "1317440"
  },
  {
    "text": "surface area more stuff deployed and more probability that something will go wrong but it's definitely better than",
    "start": "1317440",
    "end": "1323710"
  },
  {
    "text": "something going wrong if you're just in one region so what kinds of things go wrong sometimes it's self conflicted",
    "start": "1323710",
    "end": "1328960"
  },
  {
    "text": "like bad deploy or maybe like your deployment codes somehow there's a bug",
    "start": "1328960",
    "end": "1334350"
  },
  {
    "text": "in it or something happens and you lose all the capacity in a region or maybe it's just that a region is having like a",
    "start": "1334350",
    "end": "1341399"
  },
  {
    "text": "intermittent internet network issues so say like there's actually issue",
    "start": "1341399",
    "end": "1346919"
  },
  {
    "text": "happening in you West one so in Ireland say there's",
    "start": "1346919",
    "end": "1351960"
  },
  {
    "text": "like an internet internet outage and what will happen in our situation here is like the the Maps API it will that",
    "start": "1351960",
    "end": "1359940"
  },
  {
    "text": "the property of your health checks they're checking to see like if this train matte box for example exists on each of the different endpoints in each",
    "start": "1359940",
    "end": "1367049"
  },
  {
    "text": "region and so maybe this packet loss is happening in Ireland causes it to failover so that the traffic fails",
    "start": "1367049",
    "end": "1374600"
  },
  {
    "text": "automatically and it goes to us east so to virginia right and then the packet",
    "start": "1374600",
    "end": "1381570"
  },
  {
    "text": "loss is such that it's like not so horrible and roughly three health trackers say oh it's looking like it's",
    "start": "1381570",
    "end": "1386669"
  },
  {
    "text": "healthy again so the traffic goes back but actually it's not healthy it's just like internet and packet loss so we have",
    "start": "1386669",
    "end": "1392489"
  },
  {
    "text": "like elevated errors error rates go up again and then it goes back and forth and back and forth until whatever the",
    "start": "1392489",
    "end": "1398730"
  },
  {
    "text": "problem is that gets fixed and these can last you know it doesn't happen if every month but it's happened and they can",
    "start": "1398730",
    "end": "1406080"
  },
  {
    "text": "happen in last four hours so yeah automatic failover is not always",
    "start": "1406080",
    "end": "1411659"
  },
  {
    "start": "1408000",
    "end": "1482000"
  },
  {
    "text": "such it doesn't only stick the landing the way we want it to so the other thing is",
    "start": "1411659",
    "end": "1418470"
  },
  {
    "text": "that manual failover is error prone so through the ways we've dealt with this before is that will you know one way is",
    "start": "1418470",
    "end": "1424559"
  },
  {
    "text": "to go into the console and manually delete the record for us one the DNS",
    "start": "1424559",
    "end": "1430049"
  },
  {
    "text": "record for the maps endpoint but like you know that's error-prone you could go in there and actually delete the wrong",
    "start": "1430049",
    "end": "1435960"
  },
  {
    "text": "region and you have two problems and then another thing is that we've tried we have a command-line tools that",
    "start": "1435960",
    "end": "1443580"
  },
  {
    "text": "we use to interact with the ADA by AP is and I'll get into that in a bit but we",
    "start": "1443580",
    "end": "1450809"
  },
  {
    "text": "had like a separate we have like basically 11 command line system that we use to",
    "start": "1450809",
    "end": "1456869"
  },
  {
    "text": "interact with cloud formation but we built something kind of like outside of this",
    "start": "1456869",
    "end": "1462540"
  },
  {
    "text": "and so everyone's familiar with this one tool but we have this like you know if you want to do manual failover through",
    "start": "1462540",
    "end": "1467880"
  },
  {
    "text": "this command line tool you can use this other tool and you know even though it had some tests with it in everything nobody was",
    "start": "1467880",
    "end": "1473430"
  },
  {
    "text": "comfortable with whenever it came to do the failover no one was really comfortable with okay this is actually going to work if I run this command in",
    "start": "1473430",
    "end": "1478830"
  },
  {
    "text": "the interface was kind of different so yeah how do you do automated manual",
    "start": "1478830",
    "end": "1485160"
  },
  {
    "start": "1482000",
    "end": "1603000"
  },
  {
    "text": "failover well well like I said we do a lot with cloud formation there's",
    "start": "1485160",
    "end": "1491520"
  },
  {
    "text": "this open source tool we have called CFN can fake it's in our github repository it's matte box get up comsys / matte box",
    "start": "1491520",
    "end": "1497700"
  },
  {
    "text": "/ see if I can fake and what this is it's a command line tool written in nodejs and it's essentially a wrapper",
    "start": "1497700",
    "end": "1505530"
  },
  {
    "text": "around the cloud formation api's so you can create update delete stacks all from",
    "start": "1505530",
    "end": "1511500"
  },
  {
    "text": "the command line install it with no jeaious and so to",
    "start": "1511500",
    "end": "1516750"
  },
  {
    "text": "like update the geocode or stack you would do see if in a fig update geocode production and this would like you know",
    "start": "1516750",
    "end": "1522780"
  },
  {
    "text": "update the actual geocode or ec tues auto scaling group whatever it is that's that's in that stack but then ok so what",
    "start": "1522780",
    "end": "1530550"
  },
  {
    "text": "out failover we're talking about failover we've actually as I said like we had",
    "start": "1530550",
    "end": "1535680"
  },
  {
    "text": "over over our DNS records also in a separate DNS stack which is just the",
    "start": "1535680",
    "end": "1540780"
  },
  {
    "text": "records and then he'll through the reactor 3 health checks so we can do now",
    "start": "1540780",
    "end": "1546120"
  },
  {
    "text": "is you can go and run CFN config update dash dash DNS on the geocode or stack",
    "start": "1546120",
    "end": "1551580"
  },
  {
    "text": "and it will take you through these prompts these prompts are actually based on the cloud formation parameters that",
    "start": "1551580",
    "end": "1557580"
  },
  {
    "text": "are in the template and you'll say ok should I route traffic to us East one yes you go through and so you get to EU",
    "start": "1557580",
    "end": "1563040"
  },
  {
    "text": "West one you say no it will update the cloud formation stack and by doing that",
    "start": "1563040",
    "end": "1568080"
  },
  {
    "text": "there's actually just a condition in this templin that says ok if somebody sets this to know tell the health",
    "start": "1568080",
    "end": "1574170"
  },
  {
    "text": "checker in that region to check for failed and failed doesn't exist we don't serve that on our end point so after a",
    "start": "1574170",
    "end": "1580740"
  },
  {
    "text": "minute and half route 53 will fail that but it's great because it's the same interface that anyone uses like everyone",
    "start": "1580740",
    "end": "1587400"
  },
  {
    "text": "uses this interface everyday to create testing stacks staging stacks and so",
    "start": "1587400",
    "end": "1593160"
  },
  {
    "text": "when you're like a high stress point we need to do a man you will fail over use the same interface and this worked just",
    "start": "1593160",
    "end": "1601840"
  },
  {
    "text": "it just feels natural yeah so the next question is did actually work did the failover work what",
    "start": "1601840",
    "end": "1609280"
  },
  {
    "text": "did it kick in and this is another thing we've done it's a tool it's just just",
    "start": "1609280",
    "end": "1614890"
  },
  {
    "text": "basically looking at the different places in the console that shows like okay is the what is the region like what",
    "start": "1614890",
    "end": "1623350"
  },
  {
    "text": "is the in what all regions is this stack configured to run and like in all those regions what is the current health of",
    "start": "1623350",
    "end": "1632440"
  },
  {
    "text": "those of those regions is it configured to be healthy is it like or is it configured to be failed over and then if",
    "start": "1632440",
    "end": "1638020"
  },
  {
    "text": "it is you can see it is configured to be failed over you can see if it's actually filled over yet so instead of you know",
    "start": "1638020",
    "end": "1644230"
  },
  {
    "text": "you basically when you're in this high stress moment I'm going to fail this region you don't want to leave like bouncing around to different",
    "start": "1644230",
    "end": "1650070"
  },
  {
    "text": "consoles and why not you want to just do it all on the command line well one on one spot right and this is how you can",
    "start": "1650070",
    "end": "1655930"
  },
  {
    "text": "do it so other ways to check status other things we do to look at our",
    "start": "1655930",
    "end": "1661570"
  },
  {
    "text": "traffic on a hourly or daily basis we take all of our CloudFront logs and we",
    "start": "1661570",
    "end": "1667750"
  },
  {
    "text": "put them in an Amazon rich if cluster so we have like billions of requests a day and so we have billions of logs this is",
    "start": "1667750",
    "end": "1674380"
  },
  {
    "text": "why we put them in red shift but you could if you have less or the same if you have the same I put them in red shift if you have less maybe you want to",
    "start": "1674380",
    "end": "1681160"
  },
  {
    "text": "put them in some other type of relational database but Amazon redshift is really convenient show you why so the",
    "start": "1681160",
    "end": "1687190"
  },
  {
    "text": "log files cloud front delivers those to s3 just as compressed log files and then",
    "start": "1687190",
    "end": "1695440"
  },
  {
    "text": "we have a lambda that's just running and whenever those files are delivered and whenever there's enough of them this",
    "start": "1695440",
    "end": "1701200"
  },
  {
    "text": "lambda builds a manifest file and all that is is a list of these files and the reason why we do that is because we have",
    "start": "1701200",
    "end": "1707650"
  },
  {
    "text": "this other ec2 that runs and waits for these manifest files to be redelivered on to s3 by the lambda and that you see",
    "start": "1707650",
    "end": "1714850"
  },
  {
    "text": "2 takes this manifest file and Amazon redshift it supports doing this this",
    "start": "1714850",
    "end": "1720580"
  },
  {
    "text": "copy command you can actually copy directly from files and s3 into redshift",
    "start": "1720580",
    "end": "1725700"
  },
  {
    "text": "there's some great blog posts on you learn about how to do this but yeah the the idea is that you do",
    "start": "1725700",
    "end": "1732110"
  },
  {
    "text": "this copy command and the all the log file contents will get copied into your",
    "start": "1732110",
    "end": "1737509"
  },
  {
    "text": "redshift cluster so once those logs are in there what do we do SQL I've been using it since i first",
    "start": "1737509",
    "end": "1743750"
  },
  {
    "start": "1738000",
    "end": "1799000"
  },
  {
    "text": "started programming it's super powerful I still love it today it's an old language it's an old yeah but it's great",
    "start": "1743750",
    "end": "1750169"
  },
  {
    "text": "so like you can look at the cloud front documentation see what all the fields are in the access logs but it's similar",
    "start": "1750169",
    "end": "1756139"
  },
  {
    "text": "to like any other web server there's some more additional things in other like the ex edge result type this is",
    "start": "1756139",
    "end": "1762350"
  },
  {
    "text": "actually was it a cache hit or a miss so we're looking here at okay was it a cache hit or miss what's are basically",
    "start": "1762350",
    "end": "1769220"
  },
  {
    "text": "looking at what's our cache hit rate I'm grouping by cash it right here so I can see the hits misses refresh hits four we",
    "start": "1769220",
    "end": "1777379"
  },
  {
    "text": "have this cloud front log staging table so we keep like 48 hours of logs in this",
    "start": "1777379",
    "end": "1782779"
  },
  {
    "text": "redshift cluster you can still worry that pretty quickly with with redshift but we also have this staging table",
    "start": "1782779",
    "end": "1788779"
  },
  {
    "text": "which is just one hour of logs it's the last hour of logs and so this is sick it's like it gives you a big enough",
    "start": "1788779",
    "end": "1794889"
  },
  {
    "text": "enough logs to do a quick sample and it's super fast queries so",
    "start": "1794889",
    "end": "1800080"
  },
  {
    "start": "1799000",
    "end": "1889000"
  },
  {
    "text": "other things we can do is like if you have the customer name if that's part of your URL or maybe it's the access token",
    "start": "1800080",
    "end": "1805519"
  },
  {
    "text": "you can do things like okay group all the traffic right now by customer sometimes we have like these big spikes",
    "start": "1805519",
    "end": "1811070"
  },
  {
    "text": "on the edge and maybe the spike is on the edge of like a increase in traffic but it doesn't make it to the origin and",
    "start": "1811070",
    "end": "1816980"
  },
  {
    "text": "if you don't have a way to like a look at what's going on you're just like you know I hope it's legitimate traffic i'm",
    "start": "1816980",
    "end": "1822110"
  },
  {
    "text": "not i'm not sure but so this is why it's a great to have this at our fingertips so like if you combine for example the",
    "start": "1822110",
    "end": "1829879"
  },
  {
    "text": "last thing I just showed you there the hit rate or like the actual like the edge status so the result type whatever",
    "start": "1829879",
    "end": "1837019"
  },
  {
    "text": "there's a hit or miss combine that with a customer you can start to look at okay is this customer your think about like",
    "start": "1837019",
    "end": "1842840"
  },
  {
    "text": "the cost of I talked about before you can start to think about okay is this customer costing us a lot of money",
    "start": "1842840",
    "end": "1848210"
  },
  {
    "text": "compared to other customers and you can start to make business decisions about maybe there's certain types of customers",
    "start": "1848210",
    "end": "1854899"
  },
  {
    "text": "and there they have certain type of traffic which is more costly to serve than other customers and you can start",
    "start": "1854899",
    "end": "1861710"
  },
  {
    "text": "to like the business team influence how they think about how they should be",
    "start": "1861710",
    "end": "1867220"
  },
  {
    "text": "selling the product maybe you know an auto traffic is the same not all customers are the same so you want to",
    "start": "1867220",
    "end": "1873130"
  },
  {
    "text": "like look at this and really look at it in detail understand before going out and getting to a negotiation like a of",
    "start": "1873130",
    "end": "1881080"
  },
  {
    "text": "some new traffic understanding like what that traffic actually actually is so this this let's let's this makes it",
    "start": "1881080",
    "end": "1888519"
  },
  {
    "text": "really possible to look at that other things are maybe we have like a incident maybe we lose in origin or maybe there's",
    "start": "1888519",
    "end": "1895000"
  },
  {
    "text": "like some people in part of Europe that are complaining about certain like elevated error rate so we could do this",
    "start": "1895000",
    "end": "1901299"
  },
  {
    "text": "we could look at okay let's look at a the status codes organized by edge location and let's just look at where",
    "start": "1901299",
    "end": "1908320"
  },
  {
    "text": "the status is like five something something so like all the 500s and we can see okay we we have this like",
    "start": "1908320",
    "end": "1913899"
  },
  {
    "text": "failover us one what was like the error rates and all the different edges for",
    "start": "1913899",
    "end": "1919600"
  },
  {
    "text": "example just to look at kind of like the blast radius of that of that problem and that can help us communicate on our",
    "start": "1919600",
    "end": "1925090"
  },
  {
    "text": "status page for example about yeah we we had this problem here or like these edges have this problem and this is what",
    "start": "1925090",
    "end": "1931389"
  },
  {
    "text": "the total error rate looked like in the different locations so yeah some some thoughts here about",
    "start": "1931389",
    "end": "1937779"
  },
  {
    "start": "1935000",
    "end": "1973000"
  },
  {
    "text": "this mmm the section is yeah tooling for your manual processes it makes a lot of",
    "start": "1937779",
    "end": "1943240"
  },
  {
    "text": "sense and just like instead of you know if we have like 13 different teams at my box instead of having like 13 different",
    "start": "1943240",
    "end": "1949899"
  },
  {
    "text": "command line interfaces to do similar the same thing putting all into one that you can manage together makes a lot of",
    "start": "1949899",
    "end": "1956320"
  },
  {
    "text": "sense and you can really get a better honed product that way and then just learning",
    "start": "1956320",
    "end": "1962740"
  },
  {
    "text": "from your logs there's a ton to learn from your logs whether it's for operational purposes well as for",
    "start": "1962740",
    "end": "1967899"
  },
  {
    "text": "business purposes there's a ton of interesting information in there that could help guide you and then so now",
    "start": "1967899",
    "end": "1976000"
  },
  {
    "start": "1973000",
    "end": "2022000"
  },
  {
    "text": "security now that we've talked about dogs here specifically with security I want to talk about scraping and eat us",
    "start": "1976000",
    "end": "1982679"
  },
  {
    "text": "so scraping if you think about like the world it's a very discreet thing it's a",
    "start": "1982679",
    "end": "1987990"
  },
  {
    "text": "as I said like zoom level 17 is 17 billion tiles and so we off see like maybe it's somebody",
    "start": "1987990",
    "end": "1996200"
  },
  {
    "text": "who's trying to start the next map box using our IP or maybe it's a customer somebody who should be a customer but",
    "start": "1996200",
    "end": "2001540"
  },
  {
    "text": "they're just trying to like steal steal the titles they write a scraper something that's going to go and like",
    "start": "2001540",
    "end": "2007300"
  },
  {
    "text": "serially copy try and download the entire world or a certain zoom level or something right and so that's a that's a",
    "start": "2007300",
    "end": "2014560"
  },
  {
    "text": "scraper and sometimes it looks like I d-dallas because sometimes it's done through data centers with hundreds of IP",
    "start": "2014560",
    "end": "2021100"
  },
  {
    "text": "addresses and what I was talking about their about we have our logs in redshift being able to",
    "start": "2021100",
    "end": "2028120"
  },
  {
    "start": "2022000",
    "end": "2042000"
  },
  {
    "text": "kind of like really see and look and understand your content it's important to be able to fingerprint what your what",
    "start": "2028120",
    "end": "2034720"
  },
  {
    "text": "bad traffic looks like so like need to know what your content like what normal traffic looks likes to know whether the",
    "start": "2034720",
    "end": "2040660"
  },
  {
    "text": "traffic might be bad so what can we look at these aren't all of our secrets but you know if you see a lot of traffic",
    "start": "2040660",
    "end": "2046990"
  },
  {
    "start": "2042000",
    "end": "2099000"
  },
  {
    "text": "coming soon from a single IP address that's a pretty good giveaway but then we have like enterprise customers that",
    "start": "2046990",
    "end": "2053260"
  },
  {
    "text": "we allow to proxy to us for examples how do we distinguish between that that",
    "start": "2053260",
    "end": "2058690"
  },
  {
    "text": "traffic and like a scraper there's other things yes was it like an unknown proxy",
    "start": "2058690",
    "end": "2065010"
  },
  {
    "text": "other things are like maybe all this traffic is coming from a single IP address and it's got like just one user",
    "start": "2065010",
    "end": "2071379"
  },
  {
    "text": "agent often like people don't go through the steps of making the user agent",
    "start": "2071380",
    "end": "2077649"
  },
  {
    "text": "something that changes so like the user agent will be from like Java or like lib",
    "start": "2077650",
    "end": "2083020"
  },
  {
    "text": "URL or Python and so you're like hmm that you know that that looks suspicious",
    "start": "2083020",
    "end": "2088270"
  },
  {
    "text": "and then other things like a regular content profile like as I as I said like",
    "start": "2088270",
    "end": "2093610"
  },
  {
    "text": "the average tile size for a map tile is like between eight and twenty five kilobytes but sometimes we we see people",
    "start": "2093610",
    "end": "2101560"
  },
  {
    "start": "2099000",
    "end": "2133000"
  },
  {
    "text": "doing like lots of requests for ocean tiles or lots of requests for land tiles",
    "start": "2101560",
    "end": "2107110"
  },
  {
    "text": "just blank tiles and these tiles these are like 100 bytes each so if we see for",
    "start": "2107110",
    "end": "2113950"
  },
  {
    "text": "example somebody doing a bunch of traffic from a single or like maybe just a few hundred IP addresses and like",
    "start": "2113950",
    "end": "2119770"
  },
  {
    "text": "their average content size is something like under under a kilobyte that's kind of that's",
    "start": "2119770",
    "end": "2126400"
  },
  {
    "text": "kind of weird looking so that helps us make decisions about whether that traffic is legitimate or",
    "start": "2126400",
    "end": "2132670"
  },
  {
    "text": "not so this is where the database wife comes",
    "start": "2132670",
    "end": "2137980"
  },
  {
    "start": "2133000",
    "end": "2196000"
  },
  {
    "text": "into play for us it's a web application firewall it's very flexible has a lot of options it looks like this in terms of",
    "start": "2137980",
    "end": "2144940"
  },
  {
    "text": "like where it fits in into your into your architecture you've got good users bad users just coming in from wherever",
    "start": "2144940",
    "end": "2150700"
  },
  {
    "text": "and the traffic goes through the laughs first and then from there it goes on to",
    "start": "2150700",
    "end": "2157030"
  },
  {
    "text": "cloud front and then on to your origins and the whole idea is to prevent any unwanted traffic from ever making it",
    "start": "2157030",
    "end": "2163660"
  },
  {
    "text": "back to cloud front even and back to your origin so",
    "start": "2163660",
    "end": "2169650"
  },
  {
    "text": "there's a lot of different ways you can block traffic in the wife you can do it by whether something matches in the",
    "start": "2169650",
    "end": "2176500"
  },
  {
    "text": "headers maybe you can look at the the user agent and be like yeah if the user agent is Python block that",
    "start": "2176500",
    "end": "2183119"
  },
  {
    "text": "but you have to question is kind of like how do you you might have customers that are allowed to proxy and allow to use",
    "start": "2183119",
    "end": "2189280"
  },
  {
    "text": "like scraping based on whatever deal you have with them so you kind of like you have to differentiate there",
    "start": "2189280",
    "end": "2195900"
  },
  {
    "text": "but then the the other question is like how do you update so how do you update",
    "start": "2195900",
    "end": "2200950"
  },
  {
    "start": "2196000",
    "end": "2236000"
  },
  {
    "text": "the web if you thought like I mean I thought like failing out of region was kind of a high-stress thing",
    "start": "2200950",
    "end": "2207869"
  },
  {
    "text": "tedious but then the way it's very flexible has a lot of options and you go",
    "start": "2207869",
    "end": "2213640"
  },
  {
    "text": "into the wife and you're like you know looking at all the different options in like trying to figure out okay I've got the scraper going and it's starting to",
    "start": "2213640",
    "end": "2220330"
  },
  {
    "text": "take down this region because the amount of traffic is doing or it's like costing us a lot of money or it's like you know scraping or",
    "start": "2220330",
    "end": "2227410"
  },
  {
    "text": "abusing somebody's website making a quick decision could end up blocking like all your traffic so how do",
    "start": "2227410",
    "end": "2234250"
  },
  {
    "text": "you manage this well same thing we put it in cloud formation or wife configuration is in a",
    "start": "2234250",
    "end": "2241390"
  },
  {
    "text": "CloudFormation template but like confirmation templates are kind of static right it's just like a JSON",
    "start": "2241390",
    "end": "2247510"
  },
  {
    "text": "template but say one of the most reliable ways we find we",
    "start": "2247510",
    "end": "2253359"
  },
  {
    "text": "found to block is by IP address because it's very difficult to spoof an IP address whereas you can easily spoof",
    "start": "2253359",
    "end": "2260200"
  },
  {
    "text": "things in the requests like the user agent and so on so",
    "start": "2260200",
    "end": "2265410"
  },
  {
    "text": "something I really love about let's see if in config is that it can actually not",
    "start": "2265410",
    "end": "2271270"
  },
  {
    "text": "just like take a confirmation template and upload it to the API but that CloudFormation template could be just",
    "start": "2271270",
    "end": "2277270"
  },
  {
    "text": "JSON or it could be JavaScript so if you look here this is a JavaScript",
    "start": "2277270",
    "end": "2283530"
  },
  {
    "start": "2280000",
    "end": "2347000"
  },
  {
    "text": "CloudFormation template and it's just including this IPS variable and it's",
    "start": "2283530",
    "end": "2291970"
  },
  {
    "text": "calling lib I pjs and what all that does is this is all in a in a github repo all",
    "start": "2291970",
    "end": "2298000"
  },
  {
    "text": "that does is it looks at a text file for like a list of IP addresses and based on what it finds in there it will",
    "start": "2298000",
    "end": "2304599"
  },
  {
    "text": "explode it later down on line 12 there you can see okay the IP set descriptor this is supposed to be a long list of IP",
    "start": "2304599",
    "end": "2311560"
  },
  {
    "text": "addresses or a short list whatever ip's you want to block right if you have to go in there an update this by hand on",
    "start": "2311560",
    "end": "2317890"
  },
  {
    "text": "the fly as you're trying to block this traffic it's going to it's not going to work so you just do CFN config update on",
    "start": "2317890",
    "end": "2326079"
  },
  {
    "text": "this wife template and it will look at this list of IP addresses in this text file which is all version controlled so",
    "start": "2326079",
    "end": "2331150"
  },
  {
    "text": "we can see what we were blocking what we're about to block when you run CFN update it's going to show you a diff of",
    "start": "2331150",
    "end": "2336220"
  },
  {
    "text": "what it's about to change in the cloud formation configuration",
    "start": "2336220",
    "end": "2341369"
  },
  {
    "text": "so it it manages all this complexity for you in builds this template on the fly",
    "start": "2341369",
    "end": "2347200"
  },
  {
    "start": "2347000",
    "end": "2440000"
  },
  {
    "text": "and we've seen this effective like the wife what's going to happen here actually is",
    "start": "2347200",
    "end": "2353140"
  },
  {
    "text": "the wife when you run CF in fig update it's going to upload it to cloud formation and cloud formation is going",
    "start": "2353140",
    "end": "2359800"
  },
  {
    "text": "to go on and reconfigure the laughs for you so you don't even nobody has to ever go into the wife console and do any",
    "start": "2359800",
    "end": "2366700"
  },
  {
    "text": "clicking or anything you can apply you're going to always block in a known expected way no matter who's doing",
    "start": "2366700",
    "end": "2374260"
  },
  {
    "text": "it on the team at what time of day under whatever circumstances it's going to be a similar workflow not not as",
    "start": "2374260",
    "end": "2380890"
  },
  {
    "text": "error-prone as an approach where you have to go into the console so yes even config it's written in nodejs but like",
    "start": "2380890",
    "end": "2388660"
  },
  {
    "text": "that pattern there it's it's something if you use Java if you use Python their other tools similar to this it's",
    "start": "2388660",
    "end": "2394690"
  },
  {
    "text": "the idea that you know just because CloudFormation template is has to be json doesn't mean you can't",
    "start": "2394690",
    "end": "2400830"
  },
  {
    "text": "write it on the fly with with something like JavaScript and you can even do things like you haven't done this a",
    "start": "2400830",
    "end": "2406510"
  },
  {
    "text": "couple of times I haven't always felt great when we had to do it but you can do like asynchronous calls too so maybe",
    "start": "2406510",
    "end": "2412120"
  },
  {
    "text": "you you build this CloudFormation template by maybe at the top there you have some like calls and you do like an",
    "start": "2412120",
    "end": "2418420"
  },
  {
    "text": "API called abs and you're like make an API call you get some resources and based on the response you get back then",
    "start": "2418420",
    "end": "2424600"
  },
  {
    "text": "based on that you build your cloud formation template you could even do that if it comes to it the more common",
    "start": "2424600",
    "end": "2430300"
  },
  {
    "text": "pattern we have is just writing it in JavaScript and doing things like looking up from other libraries that are static",
    "start": "2430300",
    "end": "2436150"
  },
  {
    "text": "if we built in building out the club members tenth of that template that way yeah so we found the laughs effective at",
    "start": "2436150",
    "end": "2443050"
  },
  {
    "start": "2440000",
    "end": "2460000"
  },
  {
    "text": "blocking attacks that are coming from single computers trying to download the whole world would take a really long",
    "start": "2443050",
    "end": "2448480"
  },
  {
    "text": "time also data centers hundreds of IP addresses coming from major major data",
    "start": "2448480",
    "end": "2453880"
  },
  {
    "text": "centers around the world the wife has been effective in blocking in all those situations",
    "start": "2453880",
    "end": "2460380"
  },
  {
    "start": "2460000",
    "end": "2523000"
  },
  {
    "text": "yeah so some some key points about this are just",
    "start": "2460380",
    "end": "2465630"
  },
  {
    "text": "having knowing your content being familiar with it to know what what is good and what is bad and then having",
    "start": "2465630",
    "end": "2472120"
  },
  {
    "text": "having your logs like the power in a in a place that",
    "start": "2472120",
    "end": "2477780"
  },
  {
    "text": "you can use for lots of different purposes whether it's on the business side whether it's for day-to-day operations trying to tune performance",
    "start": "2477780",
    "end": "2486850"
  },
  {
    "text": "and tune maybe the origin and how well it's caching getting your cache headers right all the way to security and laughs",
    "start": "2486850",
    "end": "2494350"
  },
  {
    "text": "having those logs in an accessible place we've been in the spot where these logs weren't accessible and",
    "start": "2494350",
    "end": "2500760"
  },
  {
    "text": "you kind of just are left sitting there with not many options but having them in",
    "start": "2500760",
    "end": "2506260"
  },
  {
    "text": "a place where you can query them on the fly is super super helpful and then just yeah just being specifically with the",
    "start": "2506260",
    "end": "2512110"
  },
  {
    "text": "wife just being familiar what your options are to block knowing what's going to be most reliable what you can and can't do and then building something",
    "start": "2512110",
    "end": "2519690"
  },
  {
    "text": "something around like automating being able to do that yeah so",
    "start": "2519690",
    "end": "2525509"
  },
  {
    "start": "2523000",
    "end": "2566000"
  },
  {
    "text": "just to conclude here that the talk you know it wasn't really about like how we configure every single thing about all",
    "start": "2525509",
    "end": "2530579"
  },
  {
    "text": "these edge services it's more about how we think about them how we use them on a day-to-day basis and how we distribute",
    "start": "2530579",
    "end": "2536159"
  },
  {
    "text": "that how to how to distribute that across the whole team in terms of like",
    "start": "2536159",
    "end": "2541229"
  },
  {
    "text": "making everyone own that and manage that themselves and how how you're using them and the the information you can get from",
    "start": "2541229",
    "end": "2548369"
  },
  {
    "text": "them can help to influence other teams you know not just a platform team for",
    "start": "2548369",
    "end": "2553979"
  },
  {
    "text": "example but the business team or the security team at your company so yeah",
    "start": "2553979",
    "end": "2560159"
  },
  {
    "text": "any if anyone has any questions I can take those those now",
    "start": "2560159",
    "end": "2566209"
  }
]