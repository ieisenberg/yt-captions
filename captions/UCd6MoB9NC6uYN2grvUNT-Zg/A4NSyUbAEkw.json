[
  {
    "start": "0",
    "end": "50000"
  },
  {
    "text": "oh good hi everybody welcome to our talk",
    "start": "0",
    "end": "7170"
  },
  {
    "text": "on code deploy my name is Andy Troutman I'm the software dev manager for deployment systems at Amazon so I own",
    "start": "7170",
    "end": "14759"
  },
  {
    "text": "two sets of services I own a division code deploy which is our public facing deployment system I also own all of our",
    "start": "14759",
    "end": "21869"
  },
  {
    "text": "services that we use internal to Amazon to do deployments to our arter infrastructure those systems are called",
    "start": "21869",
    "end": "28349"
  },
  {
    "text": "Apollo if you're interested in the differences in similarities between those two my talk at last year's",
    "start": "28349",
    "end": "34680"
  },
  {
    "text": "reinvent was all about comparing and contrasting are two different deployment services you can find it on YouTube with",
    "start": "34680",
    "end": "42120"
  },
  {
    "text": "me today is josh mcfarland josh is my senior engineer on the code deploy side he also plays a big role on our internal",
    "start": "42120",
    "end": "47489"
  },
  {
    "text": "deployment stuff as well before I get too deeply into this talk I wanted to",
    "start": "47489",
    "end": "53579"
  },
  {
    "start": "50000",
    "end": "200000"
  },
  {
    "text": "talk about a little piece of Amazon's culture that will be pertinent to this talk and that is our pet culture so some",
    "start": "53579",
    "end": "60270"
  },
  {
    "text": "of you may be aware at Amazon you can bring your pets to work specifically you can bring dogs to work some of the dogs in these slides are the ones that Josh",
    "start": "60270",
    "end": "66450"
  },
  {
    "text": "and I work with so these are deployment dogs one thing that you'll notice about all these dogs is that their various",
    "start": "66450",
    "end": "73080"
  },
  {
    "text": "degrees of well dressed some of them come to work naked some of them look like they're dressed for a Mardi Gras",
    "start": "73080",
    "end": "78299"
  },
  {
    "text": "parade one of them is wearing Seattle casual which is just any piece of flannel you can find and throw on we",
    "start": "78299",
    "end": "85590"
  },
  {
    "text": "really love working with our dogs and it got Josh and I thinking about a business opportunity for our dogs so it's a bit",
    "start": "85590",
    "end": "92040"
  },
  {
    "text": "with the heavy heart that I have to say that you know this is going to be our last talk about code deploy Josh and I",
    "start": "92040",
    "end": "97650"
  },
  {
    "text": "are gonna strike out we're gonna found our own company with the vision of taking your dogs from something like",
    "start": "97650",
    "end": "103049"
  },
  {
    "text": "this to something like this right I think you all see where I'm going with",
    "start": "103049",
    "end": "108600"
  },
  {
    "text": "this we're talking about custom bespoke suits for your pets so we put it we put",
    "start": "108600",
    "end": "114899"
  },
  {
    "text": "together a business plan we started to get the idea off the ground Josh started working on our custom fitting algorithms",
    "start": "114899",
    "end": "121530"
  },
  {
    "text": "for dogs I started to drum up support you know did the rounds of VC funding all that and we also chose to build our",
    "start": "121530",
    "end": "129509"
  },
  {
    "text": "application using code deploy so I'll focus this talk on how we went from you know humble",
    "start": "129509",
    "end": "135590"
  },
  {
    "text": "idea to to massively successful bespoke dog company why did we choose Co deploy",
    "start": "135590",
    "end": "143240"
  },
  {
    "text": "not just because Joshi and I have worked on it for many years and we have a lot of faith in it but some of the early design tenants that we put into the",
    "start": "143240",
    "end": "150470"
  },
  {
    "text": "service when we were originally building it really rang true for us as we kind of decided to strike out and start our own",
    "start": "150470",
    "end": "156620"
  },
  {
    "text": "business and and encounter all of the new discoveries of trying to get an idea off the ground first of all we built",
    "start": "156620",
    "end": "162500"
  },
  {
    "text": "code to play from the ground up to be a building block service by that we mean it should it should funk into an existing process easily developers today",
    "start": "162500",
    "end": "171590"
  },
  {
    "text": "have tons of tools at their disposal all developers are likely already using a set of tools and they run the spectrum",
    "start": "171590",
    "end": "177890"
  },
  {
    "text": "from loving them to absolutely hating them but most people would agree that they're not going to drop every single",
    "start": "177890",
    "end": "183080"
  },
  {
    "text": "tool they have in their tool belt to adopt a whole new set of tooling so we wanted to make sure that if four code",
    "start": "183080",
    "end": "189230"
  },
  {
    "text": "deployed we wanted to make sure that customers could pick up and use the service they could drop it into their existing process it wasn't intrusive it",
    "start": "189230",
    "end": "195920"
  },
  {
    "text": "felt natural and it felt like an extension of what you were already trying to do another big aspect of code",
    "start": "195920",
    "end": "201500"
  },
  {
    "start": "200000",
    "end": "310000"
  },
  {
    "text": "deploy that we liked is that we had an early tenant of it being available everywhere so as we take our dog suit",
    "start": "201500",
    "end": "207019"
  },
  {
    "text": "business global as we expand the Europe and Asia etc we know that the",
    "start": "207019",
    "end": "212030"
  },
  {
    "text": "infrastructure services that a Tobias offers are available all over the place we have many discreet regions that you",
    "start": "212030",
    "end": "218269"
  },
  {
    "text": "can operate your services in but our tooling has to follow that same principle right we don't want to adopt a",
    "start": "218269",
    "end": "223850"
  },
  {
    "text": "set of tooling in one region and have it not carry forward to the next and the next today code deploy is in five AWS",
    "start": "223850",
    "end": "230150"
  },
  {
    "text": "region's we're aggressively expanding it to get it to all AWS regions with the goal of it being everywhere that",
    "start": "230150",
    "end": "236329"
  },
  {
    "text": "customers are in addition to it being available in a lot of different AWS regions we also want it to be available",
    "start": "236329",
    "end": "242630"
  },
  {
    "text": "to do a lot of different things so for example you can use code deploy on Linux instances or Windows instances you could",
    "start": "242630",
    "end": "250609"
  },
  {
    "text": "deploy to ec2 you can also use code deploy to deploy on-premises so if",
    "start": "250609",
    "end": "256310"
  },
  {
    "text": "you're running your own data center as long as you can get our agent installed on a piece of computing capacity we can",
    "start": "256310",
    "end": "262580"
  },
  {
    "text": "deploy to it you can also deploy to your laptops or anything you really want so we really",
    "start": "262580",
    "end": "267800"
  },
  {
    "text": "love this we don't know where our bespoke dog suit business is gonna take us but we suspect it's gonna need to run",
    "start": "267800",
    "end": "272930"
  },
  {
    "text": "on a lot of different platforms you know mobile app is an obvious next step so we want to make sure that code deploy is",
    "start": "272930",
    "end": "278930"
  },
  {
    "text": "gonna be in all the places we need to go the final thing is scale so after years",
    "start": "278930",
    "end": "284090"
  },
  {
    "text": "of working on code deploy it was an early design tenant we need to make sure that code deploy was easy to get started",
    "start": "284090",
    "end": "289400"
  },
  {
    "text": "with when you're deploying to one instance but it would scale up to allow you to deploy to thousands of instances and and again you know a lot of the work",
    "start": "289400",
    "end": "296870"
  },
  {
    "text": "we put into it we're reasonably confident that code deploy is going to meet all of our needs in that regard so",
    "start": "296870",
    "end": "302150"
  },
  {
    "text": "that's where work those are some of the reasons why we decided to start this venture and use code deploy to automate the process of application deployments",
    "start": "302150",
    "end": "309850"
  },
  {
    "text": "let's go through like a really high-level overview of how code deploy works so in this example there's going",
    "start": "309850",
    "end": "317180"
  },
  {
    "text": "to be three players there's going to be Amazon s3 Amazon s3 and we're going to is where we're going to store the",
    "start": "317180",
    "end": "322490"
  },
  {
    "text": "version of our application to deploy code deploy which is the thing that's going to install or update our various",
    "start": "322490",
    "end": "328960"
  },
  {
    "text": "pieces of code and Amazon ec2 which is the infrastructure that we're going to deploy onto first thing we'll do is",
    "start": "328960",
    "end": "335330"
  },
  {
    "text": "we'll spin up some ec2 instances which are represented by these lovely orange blocks once we have the instances up",
    "start": "335330",
    "end": "341450"
  },
  {
    "text": "we'll install in each one of them a code deploy agent code two boys an agent-based system we basically run a",
    "start": "341450",
    "end": "346730"
  },
  {
    "text": "piece of software on your instance which constantly long poles they could deploy service looking for work to do so",
    "start": "346730",
    "end": "353750"
  },
  {
    "text": "essentially your instances are always connected waiting for you to initiate a deployment or request to make an update",
    "start": "353750",
    "end": "359680"
  },
  {
    "text": "when an update is issued the first thing code deploy is going to do is it's going to pick a an instance or a set of",
    "start": "359680",
    "end": "365150"
  },
  {
    "text": "instances to deploy to in this case let's just assume it's going to apply deploy to a single one so it's going to",
    "start": "365150",
    "end": "370730"
  },
  {
    "text": "send down a piece of configuration that we call an app spec file I'll talk in more detail about what an app spec is",
    "start": "370730",
    "end": "377180"
  },
  {
    "text": "but for now assume it's a piece of configuration that specifies how a deployment should happen on any",
    "start": "377180",
    "end": "382850"
  },
  {
    "text": "particular instance we're deploying to it's essentially a set of instructions for what should happen when an instance",
    "start": "382850",
    "end": "388190"
  },
  {
    "text": "is selected for deployment first thing that usually happens in an abstract file is that we're going to go download the",
    "start": "388190",
    "end": "394250"
  },
  {
    "text": "latest version of your application so in this case we're going to go pull your application from s three we could also pull your",
    "start": "394250",
    "end": "400590"
  },
  {
    "text": "application from github code deploy support to github as well as s3 today we're always looking for what the next",
    "start": "400590",
    "end": "406980"
  },
  {
    "text": "set of ro software repositories people want is and we're looking to kind of expand as we go so that you can kind of",
    "start": "406980",
    "end": "412950"
  },
  {
    "text": "host your content wherever you want and still use code deploy once the application is pulled down to the",
    "start": "412950",
    "end": "418110"
  },
  {
    "text": "instance and unpacked and verified that everything looks the same as it did when we were storing it in s3 we're then",
    "start": "418110",
    "end": "424830"
  },
  {
    "text": "going to run through a set of instructions that you as a developer or deployer specify this is again specified",
    "start": "424830",
    "end": "431280"
  },
  {
    "text": "in that app spec file essentially we're gonna run through a set of commands in the order you tell us to and in that way",
    "start": "431280",
    "end": "437370"
  },
  {
    "text": "perform a software deployment so the definition of how your software is actually deployed with code deploy is",
    "start": "437370",
    "end": "442470"
  },
  {
    "text": "really up to you as a as a deployer right again code deploy because we have",
    "start": "442470",
    "end": "447840"
  },
  {
    "text": "this tenant about being flexible and easy to integrate in your process we wanted to be very application agnostic we didn't want to make a deployment",
    "start": "447840",
    "end": "454350"
  },
  {
    "text": "system that was just really great at deploying Java code we wanted to be able to deploy any code you want we find that",
    "start": "454350",
    "end": "460410"
  },
  {
    "text": "it pairs really well with existing configuration management tools so if you're already configuring your",
    "start": "460410",
    "end": "465780"
  },
  {
    "text": "instances with something like puppet or chef you can use code deploy to just invoke those same scripts that you're already using and use us to perform the",
    "start": "465780",
    "end": "473610"
  },
  {
    "text": "rollout across the instances or you can write your own shell scripts really whatever you want assuming that we run",
    "start": "473610",
    "end": "480030"
  },
  {
    "text": "through all of these instructions that you give us and they all execute as expected we'll assume that the deployment is successful so we'll have a",
    "start": "480030",
    "end": "486240"
  },
  {
    "text": "new version of the application running on this instance code deploy is going to see that this is successful and it's",
    "start": "486240",
    "end": "491940"
  },
  {
    "text": "going to pick another one go through that whole lifecycle again download the code your application bundle to the",
    "start": "491940",
    "end": "497550"
  },
  {
    "text": "instance performing your install steps install the new application again again",
    "start": "497550",
    "end": "503060"
  },
  {
    "text": "again etc until we've deployed to all of the instances in the fleet",
    "start": "503060",
    "end": "508320"
  },
  {
    "text": "so at like a 10,000 foot view this is how could deploy works it's essentially listening for deployment requests from",
    "start": "508320",
    "end": "515520"
  },
  {
    "text": "you and then selecting instances to perform updates on let's talk about some",
    "start": "515520",
    "end": "521070"
  },
  {
    "start": "519000",
    "end": "623000"
  },
  {
    "text": "of the modeling concepts that you're going to encounter when you perform your first code deploy deployment so there's",
    "start": "521070",
    "end": "526290"
  },
  {
    "text": "four concepts that you're going to run into when you go to set up and use code deploy the highest level one is",
    "start": "526290",
    "end": "532170"
  },
  {
    "text": "an application an application is any collection of content that you want to deploy as a single unit it's a somewhat",
    "start": "532170",
    "end": "539250"
  },
  {
    "text": "abstract concept so I use Einstein's noted for his ability to deal with abstract concepts let's look at an",
    "start": "539250",
    "end": "545610"
  },
  {
    "text": "example to kind of motivate it so an application could be a web server so it could be Apache or nginx or any other",
    "start": "545610",
    "end": "552440"
  },
  {
    "text": "content serving platform you want it likewise an application could be a custom framework it could be a service",
    "start": "552440",
    "end": "558360"
  },
  {
    "text": "framework it could be a website framework it could be Ruby on Rails or Django whatever you wanted it to be both",
    "start": "558360",
    "end": "565230"
  },
  {
    "text": "of these can be separate applications you can model them completely independently you can still deploy them to the same capacity so if you want you",
    "start": "565230",
    "end": "571260"
  },
  {
    "text": "can deploy as many applications as you choose to the same set of ec2 instances a third example might be just some",
    "start": "571260",
    "end": "577769"
  },
  {
    "text": "business some content so this could be custom business logic for us it's our proprietary dog fit algorithms which are",
    "start": "577769",
    "end": "583589"
  },
  {
    "text": "very hush-hush anything you really wanted to be it could be JavaScript static assets whatever all of these",
    "start": "583589",
    "end": "590070"
  },
  {
    "text": "could be separate applications as I mentioned or we could bundle them all into a single application so again we",
    "start": "590070",
    "end": "595829"
  },
  {
    "text": "want to emphasize flexibility we know people take different approaches to the way they release software and code",
    "start": "595829",
    "end": "601079"
  },
  {
    "text": "deploy is not very committal about this so view if you're running a micro services architecture and you want lots",
    "start": "601079",
    "end": "606089"
  },
  {
    "text": "and lots of discrete components that you want to update independently you can model each of those as an application you can deploy them all to the same",
    "start": "606089",
    "end": "612149"
  },
  {
    "text": "target capacity or if you want everything as a single version bundle",
    "start": "612149",
    "end": "617399"
  },
  {
    "text": "that you can track more closely again code deploy isn't too concerned about how you want to organize this once we",
    "start": "617399",
    "end": "624899"
  },
  {
    "start": "623000",
    "end": "768000"
  },
  {
    "text": "have an application defined so that's the thing we want to deploy we need to define a deployment group which is where",
    "start": "624899",
    "end": "629940"
  },
  {
    "text": "we want to deploy it to the deployment group is a collection of instances you want to deploy to as a group this is a",
    "start": "629940",
    "end": "636149"
  },
  {
    "text": "relatively simple concept so I use Fineman who's good at explaining simple things the definition practically uses",
    "start": "636149",
    "end": "641640"
  },
  {
    "text": "the the name of the thing in it so let's look at what a deployment group is here",
    "start": "641640",
    "end": "647550"
  },
  {
    "text": "at the spoke dog suit central and at Amazon and probably in many of the places you develop in you'll commonly",
    "start": "647550",
    "end": "654540"
  },
  {
    "text": "see a three tier or three stack architecture this is a common development best practice have multiple",
    "start": "654540",
    "end": "659940"
  },
  {
    "text": "stacks that you're running the code through and for any piece of candidate change you're transitioning it through",
    "start": "659940",
    "end": "665370"
  },
  {
    "text": "those different sections so on the left-hand side here I have the DEF stack the developer stack",
    "start": "665370",
    "end": "670590"
  },
  {
    "text": "is typically the newest version of your code it's the one that's currently being developed it's in the greatest state of",
    "start": "670590",
    "end": "676140"
  },
  {
    "text": "flux it's the least stable if there is testing it's minimal you're usually writing testing along with the code this",
    "start": "676140",
    "end": "682620"
  },
  {
    "text": "is an opportunity for developers to experiment to figure out how the logic or the business logic should work etc",
    "start": "682620",
    "end": "687690"
  },
  {
    "text": "etc typically this is not exposed to customers this is really an internal facing stack once you've identified a",
    "start": "687690",
    "end": "695430"
  },
  {
    "text": "set of changes that look good so a candidate set of things that you would potentially want to expose to your",
    "start": "695430",
    "end": "701400"
  },
  {
    "text": "actual customers your end users the next step is usually a test stack so test stack is where you're gonna actually prove that the business logic or proof",
    "start": "701400",
    "end": "709140"
  },
  {
    "text": "out that the business logic that you've implemented works the way you want it to right so unit testing integration",
    "start": "709140",
    "end": "714480"
  },
  {
    "text": "testing you might do performance testing here as well to make sure that resource consumption is in line with your",
    "start": "714480",
    "end": "719670"
  },
  {
    "text": "expectation you basically are using your test stack to build confidence that when you expose this change to end-users see",
    "start": "719670",
    "end": "726060"
  },
  {
    "text": "your actual customers that it works the way you expected it to on the right hand side the furthest side over is",
    "start": "726060",
    "end": "731880"
  },
  {
    "text": "production production is the thing that your actual customers are using looking at and interacting with it's by",
    "start": "731880",
    "end": "738060"
  },
  {
    "text": "definition the oldest version of your code it's also in theory the most stable version of your code because you've had a lot of different stages that you've",
    "start": "738060",
    "end": "744630"
  },
  {
    "text": "tested it through at this point so these are each of these can be modeled as a deployment group you can deploy between",
    "start": "744630",
    "end": "750330"
  },
  {
    "text": "them in any way you choose again you can also have as many deployment groups as you like it's not just three if you want very long chains of stages that you want",
    "start": "750330",
    "end": "759030"
  },
  {
    "text": "to transition your code through again code deploy is very non-committal as many deployment groups as you'd like and",
    "start": "759030",
    "end": "764700"
  },
  {
    "text": "you can define the transitions between them so we have now an application that",
    "start": "764700",
    "end": "771330"
  },
  {
    "start": "768000",
    "end": "1039000"
  },
  {
    "text": "we want to deploy some capacity that we want to put it on let's return back to the app spec file that I mentioned",
    "start": "771330",
    "end": "776820"
  },
  {
    "text": "earlier so this app spec file is a piece of gamal it's just a piece of configuration that we recommend that you",
    "start": "776820",
    "end": "783210"
  },
  {
    "text": "just check in along with your application and it's used to define how the application is actually deployed there's two sections of the app spec",
    "start": "783210",
    "end": "790110"
  },
  {
    "text": "file which are interesting to talk about the first is the files section in the file section where some we're",
    "start": "790110",
    "end": "796080"
  },
  {
    "text": "essentially just having a map from that application repository so s3 or github on to the file system",
    "start": "796080",
    "end": "801930"
  },
  {
    "text": "right so in this example I'm copying a config file to the web apps config directory and I'm copying our services",
    "start": "801930",
    "end": "808740"
  },
  {
    "text": "folder to web apps dog suit you can again move move files anywhere on to the file system that you choose this is just",
    "start": "808740",
    "end": "816120"
  },
  {
    "text": "a simple set of copy commands essentially you can have as many or as few of them as you like once the file",
    "start": "816120",
    "end": "823350"
  },
  {
    "text": "section is complete there's the hooks the hooks are those set of instructions that actually define",
    "start": "823350",
    "end": "828450"
  },
  {
    "text": "how a deployment is executed or accomplished on your capacity we have a",
    "start": "828450",
    "end": "835020"
  },
  {
    "text": "bunch of logical groupings that we call lifecycle events I'll go through the lifecycle events really quickly just so you can get a flavor for how we sort of",
    "start": "835020",
    "end": "841800"
  },
  {
    "text": "intended people to use them the first event that happens is a start event that's just executed by the central",
    "start": "841800",
    "end": "846960"
  },
  {
    "text": "service and basically tells the instance hey get ready you're about to deploy then we kick it over to applications",
    "start": "846960",
    "end": "852450"
  },
  {
    "text": "stop applications stop is an opportunity to run any scripts that you would use to turn off the old version of your",
    "start": "852450",
    "end": "857790"
  },
  {
    "text": "application so let's assume that we're deploying our dog suit application from",
    "start": "857790",
    "end": "862860"
  },
  {
    "text": "version one to version two this would be an opportunity to turn off version 1 disable it get the instance ready to",
    "start": "862860",
    "end": "868650"
  },
  {
    "text": "receive a new version after the application stop events download bundle happens this is when we actually perform",
    "start": "868650",
    "end": "875850"
  },
  {
    "text": "that pool command so this is when we pull the new version of your application onto the instance we do checksumming to",
    "start": "875850",
    "end": "881610"
  },
  {
    "text": "make sure that it looks the same as it did when it was stored in s3 if everything looks good we move on to the",
    "start": "881610",
    "end": "887100"
  },
  {
    "text": "before install event before install is before we actually start copying files onto the file system in the places you",
    "start": "887100",
    "end": "893580"
  },
  {
    "text": "specified in that file section typically what we see people do in the before install event is they'll stash any logs",
    "start": "893580",
    "end": "900780"
  },
  {
    "text": "or any configuration or data that they had stored as part of their previous install that they want to keep right so",
    "start": "900780",
    "end": "907230"
  },
  {
    "text": "you can go grab up all of that content stash it somewhere before you overwrite it with a new you know set of copy",
    "start": "907230",
    "end": "912660"
  },
  {
    "text": "commands after before install comes installed this is when we execute the file section of your app spec this is",
    "start": "912660",
    "end": "918780"
  },
  {
    "text": "when we're going to move everything to the places you tell us to after your install comes after install we thought",
    "start": "918780",
    "end": "925080"
  },
  {
    "text": "long and hard about that one typically what we see people use after install for is if you've sent down secrets or",
    "start": "925080",
    "end": "930780"
  },
  {
    "text": "encrypted data as part of that application now's an opportunity to decrypt it and put it where it belongs before we start",
    "start": "930780",
    "end": "936820"
  },
  {
    "text": "up your new version of your application so this could be things like database connectivity strings passwords account",
    "start": "936820",
    "end": "943120"
  },
  {
    "text": "information whatever it is that's sensitive that you wouldn't want to store in your app bundle kind of decrypted after after install this",
    "start": "943120",
    "end": "951220"
  },
  {
    "text": "application start this is turning on the new version of the application so for us turning on dog suit 2.0 instead of 1.0",
    "start": "951220",
    "end": "957550"
  },
  {
    "text": "you'll notice here that there's an optional parameter which is a timeout you can specify timeouts for any of the",
    "start": "957550",
    "end": "962740"
  },
  {
    "text": "scripts that we run if the script exceeds its timeout value we essentially assume that that is a failure that's not",
    "start": "962740",
    "end": "968140"
  },
  {
    "text": "what you wanted to have happen we'll mark that script as a failure and subsequent we will mark the deployment to that instances of failure and then",
    "start": "968140",
    "end": "975250"
  },
  {
    "text": "the centralized service will make a decision right so if enough instances fail we'll stop the deployment I'll talk",
    "start": "975250",
    "end": "982030"
  },
  {
    "text": "about next how you can actually make it somewhat tolerant of a little bit of failure after application start so after",
    "start": "982030",
    "end": "988690"
  },
  {
    "text": "we start up the new version of the application there's one final hook that we expose which is validate service this",
    "start": "988690",
    "end": "993910"
  },
  {
    "text": "is an opportunity to include any kind of validation logic you want to verify that the deployment went as expected right so",
    "start": "993910",
    "end": "1000690"
  },
  {
    "text": "this could be something very simple like checking for a Pitts file it could be something more involved like calling out",
    "start": "1000690",
    "end": "1005850"
  },
  {
    "text": "to a centralized testing services and have it hammer the box and make sure that it's behaving as expected once we",
    "start": "1005850",
    "end": "1012420"
  },
  {
    "text": "run through all the steps all the lifecycle events and all your scripts if we assume that all of them execute as",
    "start": "1012420",
    "end": "1018540"
  },
  {
    "text": "expected the last thing is an end event that's essentially when we record that this instance deployed to successfully",
    "start": "1018540",
    "end": "1025620"
  },
  {
    "text": "and we send that back to the central service which will make a decision about what to do next either continue the deployment or if a",
    "start": "1025620",
    "end": "1031230"
  },
  {
    "text": "bunch of nodes have already failed stop the deployment and let a customer decide to roll back or roll forward with a new",
    "start": "1031230",
    "end": "1037319"
  },
  {
    "text": "version so you think so",
    "start": "1037320",
    "end": "1044779"
  },
  {
    "start": "1039000",
    "end": "1247000"
  },
  {
    "text": "so we have an application which we're going to deploy we've defined some instances that we're going to deploy to",
    "start": "1046510",
    "end": "1052840"
  },
  {
    "text": "we've created some configuration which says how to perform the deployment the last thing we want to specify his",
    "start": "1052840",
    "end": "1058940"
  },
  {
    "text": "deployment config deployment config is how aggressively we roll across your entire fleet of instances when you tell",
    "start": "1058940",
    "end": "1065210"
  },
  {
    "text": "us to deploy so you'll remember in that first example I showed you I was doing a an instance at a time so I was selecting",
    "start": "1065210",
    "end": "1072050"
  },
  {
    "text": "one instance updating it going to the next going to the next going to the next",
    "start": "1072050",
    "end": "1077260"
  },
  {
    "text": "this is the slowest form of a deployment it's also the most cautious form of the",
    "start": "1077260",
    "end": "1082850"
  },
  {
    "text": "deployment so basically if any instance along that chain fails will immediately stop the deployment and let you decide",
    "start": "1082850",
    "end": "1089360"
  },
  {
    "text": "what you want to have happen next for most customers if you're running a very large fleet this is probably not how you",
    "start": "1089360",
    "end": "1094880"
  },
  {
    "text": "want to deploy if you're deploying to hundreds or thousands of instances this would be a very slow way to deploy so",
    "start": "1094880",
    "end": "1101060"
  },
  {
    "text": "you'd really want to strap in and wait a long time it also means that the deployment is somewhat brittle from the perspective of a large instance",
    "start": "1101060",
    "end": "1107650"
  },
  {
    "text": "footprint many things can go wrong when a deployment is going out so you can",
    "start": "1107650",
    "end": "1112760"
  },
  {
    "text": "have network connectivity issues two instances you can have hardware failures you can have applications that are in a",
    "start": "1112760",
    "end": "1118820"
  },
  {
    "text": "bad state that makes the instance unresponsive you want to be somewhat tolerant to single node failures when",
    "start": "1118820",
    "end": "1124970"
  },
  {
    "text": "you're deploying to a very large fleet and so for that you probably want a different type of deployment config the",
    "start": "1124970",
    "end": "1130130"
  },
  {
    "text": "other two default can deploy what configs we offer is half at a time that's what it sounds like will deploy",
    "start": "1130130",
    "end": "1135350"
  },
  {
    "text": "to 50 percent of your instances if everything goes well with those will do the next 50 percent most people most",
    "start": "1135350",
    "end": "1141710"
  },
  {
    "text": "teams in production will run their application over provision so you'll run more instances than you actually need to",
    "start": "1141710",
    "end": "1147530"
  },
  {
    "text": "serve your traffic so that any events don't impact your customers right so if",
    "start": "1147530",
    "end": "1152930"
  },
  {
    "text": "you have a network partitioning event and instances are lost you still should have enough instances to be able to serve traffic if you make a bad software",
    "start": "1152930",
    "end": "1160040"
  },
  {
    "text": "change you should have extra instances if you just have a spike in request load like dog food will have when it launches",
    "start": "1160040",
    "end": "1166030"
  },
  {
    "text": "you know you want to be able to weather that storm we can take advantage of that over provisioning during a deployment and we can deploy to that extra capacity",
    "start": "1166030",
    "end": "1172900"
  },
  {
    "text": "as part of the change the default config that we offer is all at",
    "start": "1172900",
    "end": "1179980"
  },
  {
    "text": "once that's what it sounds like put on your cowboy hat go crazy deploy to all of your instances in parallel as quickly",
    "start": "1179980",
    "end": "1186580"
  },
  {
    "text": "as you possibly can we don't recommend this reproduction I asked Josh did not",
    "start": "1186580",
    "end": "1191620"
  },
  {
    "text": "use all at once we need to pull a stock suit app but where it is very valuable is in your Devon test X so in Devon",
    "start": "1191620",
    "end": "1197590"
  },
  {
    "text": "tests you usually are not exposing them to customers the consequence of failure and the stack is relatively low if I",
    "start": "1197590",
    "end": "1203530"
  },
  {
    "text": "pushed a bad change it's only slowing myself down or maybe the other devs on my team that I'm working on the value of",
    "start": "1203530",
    "end": "1209620"
  },
  {
    "text": "a fast deployment is probably greater than the mistake of deploying something broken right so you want to be able to",
    "start": "1209620",
    "end": "1216400"
  },
  {
    "text": "iterate quickly so push changes out as quickly as possible if none of these work for you you can always customize",
    "start": "1216400",
    "end": "1222460"
  },
  {
    "text": "your own deployment config you can specify a percent of healthy hosts that you have to have available or or a raw",
    "start": "1222460",
    "end": "1228550"
  },
  {
    "text": "number of hosts and in this example we're saying a minimum of healthy hosts of 75% so that means three-quarters of",
    "start": "1228550",
    "end": "1234910"
  },
  {
    "text": "my instances need to be available at all times to serve my customers so that means code employee can in theory take",
    "start": "1234910",
    "end": "1241450"
  },
  {
    "text": "out up to 25% or a quarter of your instances at any given time so those are",
    "start": "1241450",
    "end": "1247960"
  },
  {
    "text": "deployment configs you've now graduated code deploy bootcamp congratulations",
    "start": "1247960",
    "end": "1253060"
  },
  {
    "text": "that's about everything you need to know to be able to use the service let's return back to the matter at hand which",
    "start": "1253060",
    "end": "1259450"
  },
  {
    "text": "is custom fashion for dogs let's talk about development so josh has been",
    "start": "1259450",
    "end": "1266260"
  },
  {
    "text": "working on the fitting algorithms we have a candidate in place as you can see the fit isn't particularly good for this",
    "start": "1266260",
    "end": "1271810"
  },
  {
    "text": "dog but it's time to start setting up a dev stack in developments we're typically going to run a very small",
    "start": "1271810",
    "end": "1277570"
  },
  {
    "text": "footprint we might run it on a single instance we the the focus of using code",
    "start": "1277570",
    "end": "1285490"
  },
  {
    "text": "deploy in our development environment is that we can get it integrated quickly and it doesn't get in the way at this point we don't have our VC funding come",
    "start": "1285490",
    "end": "1292180"
  },
  {
    "text": "through just yet and so we're spending our own money we don't want Josh to waste you know a week",
    "start": "1292180",
    "end": "1297940"
  },
  {
    "text": "of time trying to get automated deployment setup if it doesn't if it isn't something we can kind of integrate quickly it's not going to be worth our",
    "start": "1297940",
    "end": "1304030"
  },
  {
    "start": "1304000",
    "end": "1403000"
  },
  {
    "text": "time so let's switch and take a look at what it took to integrate code deploy into our",
    "start": "1304030",
    "end": "1310000"
  },
  {
    "text": "our dog suit app so we're looking at github here this is the commit that we made to integrate code deploy into the",
    "start": "1310000",
    "end": "1316690"
  },
  {
    "text": "environment the first thing that you see here is that app spec file that I talked about earlier the app spec file is less",
    "start": "1316690",
    "end": "1325720"
  },
  {
    "text": "than 20 lines of code or they could weighs in at about 17 lines of code and this is that set of instructions that",
    "start": "1325720",
    "end": "1330850"
  },
  {
    "text": "says how to deploy in the file section we're moving a war file into place and",
    "start": "1330850",
    "end": "1337390"
  },
  {
    "text": "we're copying a piece of pork config to open up our development environment to",
    "start": "1337390",
    "end": "1343030"
  },
  {
    "text": "traffic so I should say that you know we developed this first version in Tomcat so as the technology we were used to is",
    "start": "1343030",
    "end": "1350290"
  },
  {
    "text": "easy to get up and running but we could have really used anything as far as code deploy was concerned the next section is",
    "start": "1350290",
    "end": "1356740"
  },
  {
    "text": "the hooks section the hooks section we just have three hooks three scripts that were executing an uninstall hook that",
    "start": "1356740",
    "end": "1364330"
  },
  {
    "text": "will turn off the old version of Apache I hope to install any dependencies we",
    "start": "1364330",
    "end": "1369910"
  },
  {
    "text": "may have introduced as part of this new version of the application and then a hook to start up the application if JA",
    "start": "1369910",
    "end": "1376360"
  },
  {
    "text": "Scrolls down you can see the other things we've committed in here are the actual scripts that we're going to execute as part of this change I'm not",
    "start": "1376360",
    "end": "1382630"
  },
  {
    "text": "going to go into all the details but they're essentially just shell scripts they're probably things that developers",
    "start": "1382630",
    "end": "1389230"
  },
  {
    "text": "going to write anyways because you're gonna get really tired of typing the same set of five or ten commands just turn off Apache and move some files and",
    "start": "1389230",
    "end": "1395800"
  },
  {
    "text": "start it back up so we're really just taking things that you that you probably already wrote and we're saying code",
    "start": "1395800",
    "end": "1401230"
  },
  {
    "text": "deploy call them in this order for be so that's what it looks like there let's we'll go over to Jenkins so we were",
    "start": "1401230",
    "end": "1407860"
  },
  {
    "start": "1403000",
    "end": "1518000"
  },
  {
    "text": "already using Jenkins as a continuous build server so we were all ready any time we checked in code it would want to make it get built we want to just extend",
    "start": "1407860",
    "end": "1414700"
  },
  {
    "text": "that we want to now just kick off the deployment after a Jenkins build successfully completes code deployment",
    "start": "1414700",
    "end": "1421750"
  },
  {
    "text": "this relatively easy they included a plug-in for us so if you're using",
    "start": "1421750",
    "end": "1427270"
  },
  {
    "text": "Jenkins and you want to integrate it with code deploy you can go to the public for positives repositories and",
    "start": "1427270",
    "end": "1433480"
  },
  {
    "text": "you should be able to hopefully get in",
    "start": "1433480",
    "end": "1440340"
  },
  {
    "text": "so once josh fixes his login this ship will show you Jenkins",
    "start": "1440850",
    "end": "1446658"
  },
  {
    "text": "sorry put that so this is looking at the plugin if you scroll down to the plugin",
    "start": "1456119",
    "end": "1462190"
  },
  {
    "text": "you should see the pertinent config that that matters to us it's essentially those same set of concepts that we",
    "start": "1462190",
    "end": "1467590"
  },
  {
    "text": "already talked about we need to tell the Jenkins plug-in the application name that we're deploying the deployment",
    "start": "1467590",
    "end": "1473739"
  },
  {
    "text": "group that we want to deploy to where we're storing the code in this case it's an s3 bucket and what region were",
    "start": "1473739",
    "end": "1479559"
  },
  {
    "text": "deploying from it's a relatively small amount of config once you've once we set it up we should",
    "start": "1479559",
    "end": "1485080"
  },
  {
    "text": "be able to kick off the build and hopefully see a deployment happen so we'll do so here we go",
    "start": "1485080",
    "end": "1496619"
  },
  {
    "text": "so once we schedule a build we can see it pop up here we can go look at the",
    "start": "1502250",
    "end": "1507330"
  },
  {
    "text": "console output if you wanted to you could sit in the Jenkins console and",
    "start": "1507330",
    "end": "1512870"
  },
  {
    "text": "watch watch the watch the build happen maybe there we go",
    "start": "1512870",
    "end": "1519090"
  },
  {
    "start": "1518000",
    "end": "1599000"
  },
  {
    "text": "so you could watch the build happen you could watch the Jenkins plug-in automatically upload it to s3 and kick off the deployment once we see a",
    "start": "1519090",
    "end": "1525690"
  },
  {
    "text": "deployment Sartain we're actually going to go to the code deploy console just so we can show you some more things there how it looks you can see we've got a new",
    "start": "1525690",
    "end": "1532650"
  },
  {
    "text": "build started if we click on that build it'll take us down to an instance view so calling out a few things that we",
    "start": "1532650",
    "end": "1540360"
  },
  {
    "text": "talked about earlier we're deploying our bespoke dog State application this is the dev deployment group we're deploying",
    "start": "1540360",
    "end": "1546780"
  },
  {
    "text": "to a single instance which you can see down there below and we're using one of those default deployment configs of all",
    "start": "1546780",
    "end": "1552840"
  },
  {
    "text": "at once this is this deployment finished pretty quickly let's click on view events so you can show you what that",
    "start": "1552840",
    "end": "1558540"
  },
  {
    "text": "looks like so you can continue to drill down you can start at a very high level look at the instances we're deploying to",
    "start": "1558540",
    "end": "1563820"
  },
  {
    "text": "we can go all the way down to the lifecycle events that we're running on each instance if we want to as you can",
    "start": "1563820",
    "end": "1569640"
  },
  {
    "text": "see here all of them succeeded you can see when we started that lifecycle event when it completed how long it took etc",
    "start": "1569640",
    "end": "1576020"
  },
  {
    "text": "so this deployment appears to have been successful we ran through all our events as we want it to let's go over to the",
    "start": "1576020",
    "end": "1582090"
  },
  {
    "text": "beta website and see if it's up and running so Joshua gives a quick refresh there we go so you know a moment to",
    "start": "1582090",
    "end": "1589710"
  },
  {
    "text": "pause and reflect on where you were when you first saw bespoke dog suit app you were here at reinvent so so now that we",
    "start": "1589710",
    "end": "1596010"
  },
  {
    "text": "have beta up and running let's talk about what happens next so we've as you can see we the fitting",
    "start": "1596010",
    "end": "1604230"
  },
  {
    "start": "1599000",
    "end": "1696000"
  },
  {
    "text": "algorithm starting to come into place there our dogs are not looking so disheveled we're talking now about",
    "start": "1604230",
    "end": "1610050"
  },
  {
    "text": "getting a candidate release out right so we want to set up a test stack what's going to be different about tests for us",
    "start": "1610050",
    "end": "1616430"
  },
  {
    "text": "first thing we're going to do is we're going to integrate with auto scaling so when I talked about deployment groups I",
    "start": "1616430",
    "end": "1621660"
  },
  {
    "text": "forgot to mention how you actually define one you can do it in one of two ways you can tag a bunch of instances",
    "start": "1621660",
    "end": "1627060"
  },
  {
    "text": "with a particular set of tags and then you tell code deploy deploy to the set of tags will deploy to those instances",
    "start": "1627060",
    "end": "1632520"
  },
  {
    "text": "you can also just give us an auto scaling group name and we'll treat as a deployment group if you use",
    "start": "1632520",
    "end": "1637590"
  },
  {
    "text": "auto-scaling you get a little bit of extra functionality which is nice anytime auto-scaling spins up a new",
    "start": "1637590",
    "end": "1642960"
  },
  {
    "text": "instance it won't put it into service until it's successfully received code deploy deployment right so in this way",
    "start": "1642960",
    "end": "1649200"
  },
  {
    "text": "you can guarantee that any new capacity before it goes into production and as exposed to your customers has a",
    "start": "1649200",
    "end": "1655799"
  },
  {
    "text": "successful deployment of the latest version of your code deployed to it we like this we like this for our test",
    "start": "1655799",
    "end": "1661710"
  },
  {
    "text": "environment mostly because it turns out that Josh occasionally sleeps and when josh is sleeping he's not coding and so",
    "start": "1661710",
    "end": "1668790"
  },
  {
    "text": "what we want to do is we want to turn off those test stacks when we're not using integrating code deploy and on",
    "start": "1668790",
    "end": "1674490"
  },
  {
    "text": "scaling makes this easy we just set our desired instances to zero it throws away the capacity josh can take a quick nap",
    "start": "1674490",
    "end": "1680190"
  },
  {
    "text": "when he comes back in in the morning we dial it back up and it automatically deploys the latest version of our code",
    "start": "1680190",
    "end": "1686070"
  },
  {
    "text": "and we're back up and running you know again the VC funding is not yet happened for dog suit app so we want to pinch",
    "start": "1686070",
    "end": "1693390"
  },
  {
    "text": "pennies where we can this was a great way to do that the other thing we're gonna introduce is request routing with",
    "start": "1693390",
    "end": "1699510"
  },
  {
    "start": "1696000",
    "end": "1768000"
  },
  {
    "text": "ELB because we don't want to expose customers to an instance when it's being deployed to will instead route traffic",
    "start": "1699510",
    "end": "1707220"
  },
  {
    "text": "away from that instance while it's being deployed to so in this example we have elastic load balancer on the left hand side and instance that we're gonna",
    "start": "1707220",
    "end": "1713429"
  },
  {
    "text": "update in the middle and code deploy on the right what we'll do is the first",
    "start": "1713429",
    "end": "1718590"
  },
  {
    "text": "thing we'll do in the deployment is we'll route traffic away from the instance so that customers aren't hitting in instances it's getting updated and will prefer perform the",
    "start": "1718590",
    "end": "1725730"
  },
  {
    "text": "software update and then will reintroduce traffic to that instance if",
    "start": "1725730",
    "end": "1731100"
  },
  {
    "text": "we had to do this ourselves we'd have to do a bunch of scripting to talk to the load balancer and listen for health checks and etc etc etc the code deployed",
    "start": "1731100",
    "end": "1738900"
  },
  {
    "text": "team made this easy on us they host a bunch of open source code and github so",
    "start": "1738900",
    "end": "1743940"
  },
  {
    "text": "if you go to a Tobias labs section of github and you search for code deploy you'll see a bunch of sample scripts I",
    "start": "1743940",
    "end": "1749100"
  },
  {
    "text": "believe our Jenkins plug-in source code is also hosted there one of them is a",
    "start": "1749100",
    "end": "1754169"
  },
  {
    "text": "load balancer example right so all we had to do to really get this to work was we went to a Tobias labs we copied the",
    "start": "1754169",
    "end": "1760679"
  },
  {
    "text": "load balancer bind and unbind scripts and we added them to our app spec so relatively simple to get this",
    "start": "1760679",
    "end": "1766679"
  },
  {
    "text": "functionality the other thing we're gonna introduce in gamla is some validation testing so",
    "start": "1766679",
    "end": "1771809"
  },
  {
    "start": "1768000",
    "end": "1781000"
  },
  {
    "text": "we're getting ready to release a piece of code to production we want to start adding some sanity checks to make sure",
    "start": "1771809",
    "end": "1777450"
  },
  {
    "text": "that what we're actually deploying works as expected so let's go back to github",
    "start": "1777450",
    "end": "1783179"
  },
  {
    "start": "1781000",
    "end": "1850000"
  },
  {
    "text": "and we'll take a look at those changes",
    "start": "1783179",
    "end": "1788330"
  },
  {
    "text": "so here again is a commit in github this is the commit that we made to enable",
    "start": "1788330",
    "end": "1793490"
  },
  {
    "text": "you'll be redirection as well as some sanity checks you'll see it's an extra",
    "start": "1793490",
    "end": "1798960"
  },
  {
    "text": "five lines of config in our app spec file I should also note this is a this is reason why we really encourage people to to revision control your app spec",
    "start": "1798960",
    "end": "1806129"
  },
  {
    "text": "along with your application it makes a nice history of how your deployment changes over time it finally is very",
    "start": "1806129",
    "end": "1811379"
  },
  {
    "text": "helpful in our own environments when a deployment fails we can pull the app spec and see if anything changed in it and really quickly we can tell if",
    "start": "1811379",
    "end": "1818399"
  },
  {
    "text": "something weird is happening so did we introduce a new script that's probably a good candidate for failure did we change the order in which we deploy etc etc did",
    "start": "1818399",
    "end": "1826409"
  },
  {
    "text": "we add new files so in this case we are adding two new load balancer scripts one",
    "start": "1826409",
    "end": "1832169"
  },
  {
    "text": "that runs before any event happens on the instance that unbinds it from the load balancer we perform the deployment",
    "start": "1832169",
    "end": "1838169"
  },
  {
    "text": "as usual then we have a load any open script which rebonds it at the end of validation we're also adding a sanity",
    "start": "1838169",
    "end": "1844830"
  },
  {
    "text": "check here a validation script to make sure that the application comes up and runs correctly so relatively small",
    "start": "1844830",
    "end": "1851730"
  },
  {
    "start": "1850000",
    "end": "2025000"
  },
  {
    "text": "amount of change to add this functionality let's go kick off a building Jenkins and see if it works",
    "start": "1851730",
    "end": "1860179"
  },
  {
    "text": "so you'll see a new build starts we'll go to the console",
    "start": "1861169",
    "end": "1867320"
  },
  {
    "text": "so once the diploma starts we should be able to go see it here and the coach deployed console hopefully there we go",
    "start": "1876470",
    "end": "1885220"
  },
  {
    "text": "so we can drill down take a look at the deployment we should see here you know",
    "start": "1885220",
    "end": "1891050"
  },
  {
    "text": "some some things have changed we now are deploying the three instances so in in our test environment we're having a",
    "start": "1891050",
    "end": "1896420"
  },
  {
    "text": "slightly larger footprint we're now deploying to an auto scaling group josh has created a custom deployment",
    "start": "1896420",
    "end": "1902390"
  },
  {
    "text": "config called all but one all but one is what it sounds like we're gonna deploy",
    "start": "1902390",
    "end": "1907430"
  },
  {
    "text": "to all of the instances except for one we'll always leave one available in case someone's trying to hit the website",
    "start": "1907430",
    "end": "1912980"
  },
  {
    "text": "while we're deploying so you can see we have three instances we're deploying to two of them in parallel relatively",
    "start": "1912980",
    "end": "1918920"
  },
  {
    "text": "straightforward so you saw we have an instance that failed which is an interesting event let's go to the events",
    "start": "1918920",
    "end": "1925610"
  },
  {
    "text": "view and see if we can figure out what actually happened here so again now we're looking back at that set of events",
    "start": "1925610",
    "end": "1931580"
  },
  {
    "text": "that happens on any instance you can see we ran through all of the events except for the validate service events so",
    "start": "1931580",
    "end": "1937480"
  },
  {
    "text": "something happened when we tried to verify that the application came up you notice we have a new link here which is",
    "start": "1937480",
    "end": "1942680"
  },
  {
    "text": "called view logs anytime we run a set of scripts as part of a deployment for a customer if those",
    "start": "1942680",
    "end": "1948860"
  },
  {
    "text": "scripts fail we'll grab the last two Kay of the log and we'll make it available in the code deploy console this is a",
    "start": "1948860",
    "end": "1955160"
  },
  {
    "text": "nice convenience method it really lowers the iteration time to debug and test things as you're rolling them out you",
    "start": "1955160",
    "end": "1961550"
  },
  {
    "text": "don't have to figure out how to pull your logs from your instances or go find them or to log into the instance and",
    "start": "1961550",
    "end": "1967010"
  },
  {
    "text": "figure out what's going on you'll get the last two K of output and in the console this one didn't actually produce",
    "start": "1967010",
    "end": "1972230"
  },
  {
    "text": "any log data but it did give us a message which tells us what happened it looks like it was looking for a script",
    "start": "1972230",
    "end": "1978020"
  },
  {
    "text": "to run our health check script and it couldn't find it so that's not what we",
    "start": "1978020",
    "end": "1983150"
  },
  {
    "text": "wanted to have happen let's go back to github and see if we can diagnose what actually went wrong so you'll see in the",
    "start": "1983150",
    "end": "1989630"
  },
  {
    "text": "abstract file we definitely reference that script so we're trying to invoke it code deploy knows that we want to run",
    "start": "1989630",
    "end": "1995300"
  },
  {
    "text": "this script but it also knows that it didn't find it when we tried to invoke it so it does the right thing of course",
    "start": "1995300",
    "end": "2001000"
  },
  {
    "text": "it says you know you told us to do this thing we couldn't something went wrong if we look at the files that we checked",
    "start": "2001000",
    "end": "2006880"
  },
  {
    "text": "in a quick quick look of them will reveal that we never checked in this validation",
    "start": "2006880",
    "end": "2012269"
  },
  {
    "text": "script so of course it would never ran we just hired an intern at dog suit central so I'm assuming that this was",
    "start": "2012269",
    "end": "2018840"
  },
  {
    "text": "the entrance problem and not Josh's the fix is relatively simple we just check in our validation script we should be",
    "start": "2018840",
    "end": "2026490"
  },
  {
    "start": "2025000",
    "end": "2173000"
  },
  {
    "text": "able to just commit that and then kick off a new build and hopefully this should remediate the problem so kick off",
    "start": "2026490",
    "end": "2034200"
  },
  {
    "text": "the building to make sure it does",
    "start": "2034200",
    "end": "2037100"
  },
  {
    "text": "got a new deployment let's go down and take a look at the instances excuse me",
    "start": "2052120",
    "end": "2060850"
  },
  {
    "text": "so new deployment started many of the things in this page is the same we're still deploying to the test deployment group three instances are being deployed",
    "start": "2060850",
    "end": "2067510"
  },
  {
    "text": "to we're still using the same deployment config one thing you'll notice is that",
    "start": "2067510",
    "end": "2072520"
  },
  {
    "text": "if you compared this deployment to the last deployment you'll note that we're deploying to the same two instances that failed in the last deployment that's not",
    "start": "2072520",
    "end": "2079179"
  },
  {
    "text": "by accident that's by intent one of the things code deployed does is it keeps track of the of the outcome of a",
    "start": "2079179",
    "end": "2084550"
  },
  {
    "text": "deployment on every instance it deploys two so it knows which instances fail the previous deployment and which succeeded",
    "start": "2084550",
    "end": "2090129"
  },
  {
    "text": "when we do subsequent deployments we'll always prioritize failed instances first this is so that we make sure that we as",
    "start": "2090130",
    "end": "2098140"
  },
  {
    "text": "much as possible honor those health constraints that you tell us about so if we were to pick a random set of instances and we picked the instance",
    "start": "2098140",
    "end": "2104770"
  },
  {
    "text": "that we didn't deploy to we would actually be taking out more capacity than we intended to you would have two broken instances and then we would be",
    "start": "2104770",
    "end": "2110380"
  },
  {
    "text": "deploying to the one instance that was still working that's not what we want and so code deploy will always pick the",
    "start": "2110380",
    "end": "2116020"
  },
  {
    "text": "broken instances deployed on them first and then go complete the deployment on the rest of the fleet so you can see",
    "start": "2116020",
    "end": "2122020"
  },
  {
    "text": "these two deployments succeeded one is in progress because we're using request routing we should in theory be able to go to the website and refresh it and",
    "start": "2122020",
    "end": "2128830"
  },
  {
    "text": "have everything work as expected so Josh should be able to give us a couple refreshes just to prove it's not all",
    "start": "2128830",
    "end": "2135490"
  },
  {
    "text": "fake okay so gamma website it seems to be up and running it's hitting instances that are available with the new code one",
    "start": "2135490",
    "end": "2142990"
  },
  {
    "text": "thing you'll notice here is we've added a nice little debug banner at the top so this tells us just some interesting information it tells us the application",
    "start": "2142990",
    "end": "2149170"
  },
  {
    "text": "that's being deployed it tells us which deployment group we're looking at so we're looking at the test deployment group and it includes some ELB health",
    "start": "2149170",
    "end": "2156610"
  },
  {
    "text": "state for the instances that are being deployed so as you can see from the low bouncers perspective all three instances",
    "start": "2156610",
    "end": "2162400"
  },
  {
    "text": "look to be okay and healthy if we pop back over to code deploy we should in theory see a successful deployment but",
    "start": "2162400",
    "end": "2168700"
  },
  {
    "text": "so all the instant succeeded you see the big green deployments exceeded check box let's go back and talk about what",
    "start": "2168700",
    "end": "2175300"
  },
  {
    "start": "2173000",
    "end": "2305000"
  },
  {
    "text": "happens next so production so we've been working hard on the fitting algorithms I",
    "start": "2175300",
    "end": "2181000"
  },
  {
    "text": "think you'll agree this dog is looking pretty sharp things are starting to fall into place you see funding is coming through the",
    "start": "2181000",
    "end": "2188140"
  },
  {
    "text": "buzz is happening the media blitz TechCrunch everything so it's time to launch this",
    "start": "2188140",
    "end": "2193990"
  },
  {
    "text": "thing right what's going to happen different about our deployment process and production from the last two stages",
    "start": "2193990",
    "end": "2199480"
  },
  {
    "text": "from beta and tests one thing is we're gonna have a larger fleet footprint so",
    "start": "2199480",
    "end": "2205180"
  },
  {
    "text": "we'll triple the size of our test fleet will deploy to nine instances for illustrative purposes I don't want us to",
    "start": "2205180",
    "end": "2211810"
  },
  {
    "text": "use the all at once deployment config that we were using a test that seems a little bit over enthusiastic",
    "start": "2211810",
    "end": "2218520"
  },
  {
    "text": "overconfident I also don't like the all but one again it seems like we're exposing our customers to a lot of risk",
    "start": "2218520",
    "end": "2225070"
  },
  {
    "text": "if we deploy to all the instances in parallel so we're going to write a new custom deployment config we'll do it a",
    "start": "2225070",
    "end": "2230500"
  },
  {
    "text": "third at a time so well over provision our fleet by 33% and we'll do",
    "start": "2230500",
    "end": "2235900"
  },
  {
    "text": "deployments and batches of a third so with nine instances we'll do the first three next three and then we'll finally",
    "start": "2235900",
    "end": "2241270"
  },
  {
    "text": "finish up in the last third so we'll we'll introduce that we're also going to take advantage of environment variables",
    "start": "2241270",
    "end": "2247750"
  },
  {
    "text": "which is something that code deploy makes available to all the scripts that you run so in that app spec file any of",
    "start": "2247750",
    "end": "2254800"
  },
  {
    "text": "the scripts that you invoke we automatically make available to them a collection of environment variables that you can use to to key off of and change",
    "start": "2254800",
    "end": "2261790"
  },
  {
    "text": "the behavior so we make available to you the deployment group that's being deployed the deployment ID that we're currently deploying the application name",
    "start": "2261790",
    "end": "2268980"
  },
  {
    "text": "etc etc so a collection of content that you can use to change the behavior for",
    "start": "2268980",
    "end": "2274359"
  },
  {
    "text": "us we're going to production we want to show the first hundred customers the sales banner right so first 100 dogs",
    "start": "2274359",
    "end": "2281380"
  },
  {
    "text": "through the door are going to get a custom fitting for free just kind of drum up business we also want to get rid",
    "start": "2281380",
    "end": "2286480"
  },
  {
    "text": "of that debug bar that Josh introduced and test it's great information for us but it's it doesn't really make any",
    "start": "2286480",
    "end": "2292480"
  },
  {
    "text": "sense to our customers so we'll make sure that any of that debug messaging is cleaned up when we go to production we can do that pretty easily by just",
    "start": "2292480",
    "end": "2298660"
  },
  {
    "text": "checking to see which deployment group we're deploying to if we see that it's the production deployment group you know we won't show that content so let's go",
    "start": "2298660",
    "end": "2306820"
  },
  {
    "start": "2305000",
    "end": "2453000"
  },
  {
    "text": "and kick off a deployment and see if it works again we'll go to Jenkins we'll",
    "start": "2306820",
    "end": "2313150"
  },
  {
    "text": "kick off a new build this time we're going to kick off a bill to the production fleet it's gonna be a little bit bigger",
    "start": "2313150",
    "end": "2319859"
  },
  {
    "text": "there we go so before we drill down to the instance view I'll have Josh expand this little bar next to the deployment",
    "start": "2333840",
    "end": "2341070"
  },
  {
    "text": "as your fleets get bigger and bigger the visualizations don't always scale right so if you're looking at 50 or a hundred",
    "start": "2341070",
    "end": "2347140"
  },
  {
    "text": "or a thousand instances looking at the instance state of every single instance is probably gonna be a bit of an",
    "start": "2347140",
    "end": "2352420"
  },
  {
    "text": "information overload it's probably not going to be as valuable to you so we introduced a couple different visualizations that we hope will scale",
    "start": "2352420",
    "end": "2358450"
  },
  {
    "text": "for the different size fleets that you'll use there's one we call a rainbow bar it's just a very simple visualization that shows you at a really",
    "start": "2358450",
    "end": "2365290"
  },
  {
    "text": "high level what's happening across the fleet so in this case you can see three instances are in progress and six are",
    "start": "2365290",
    "end": "2371290"
  },
  {
    "text": "pending since we set up a deployment config to do a third at a time that logically makes sense to us we can drill down for",
    "start": "2371290",
    "end": "2377950"
  },
  {
    "text": "this one since we're only deploying to nine instances the visualization holds up fairly well so again you can see some",
    "start": "2377950",
    "end": "2385630"
  },
  {
    "text": "information here the production deployment group we've created our own custom deployment convey called a third",
    "start": "2385630",
    "end": "2391690"
  },
  {
    "text": "at a time and you can see that it's deploying you can see a couple instances have succeeded and others are in",
    "start": "2391690",
    "end": "2398260"
  },
  {
    "text": "progress essentially you know as soon as an instance succeeds assuming we still",
    "start": "2398260",
    "end": "2403750"
  },
  {
    "text": "have capacity to deploy to we'll pick another instance and deploy to it so at any point in time we should see three",
    "start": "2403750",
    "end": "2409210"
  },
  {
    "text": "instances in progress and any number in succeeded depending on where we are in the deployment overall so I'm not gonna",
    "start": "2409210",
    "end": "2415869"
  },
  {
    "text": "sit here and make you guys watch this thing refresh and refresh because we're doing request routing we should be able",
    "start": "2415869",
    "end": "2421359"
  },
  {
    "text": "to go to broad and refresh it and hopefully we'll hit a new instance we did great that's good so we got our sales banner",
    "start": "2421359",
    "end": "2428920"
  },
  {
    "text": "up that's what we wanted to see we wanted to see you know sales banner up and the debug information gone seems to",
    "start": "2428920",
    "end": "2436359"
  },
  {
    "text": "have worked we're routing our customers to instances that are not being deployed to that's also what we want we go back let's see",
    "start": "2436359",
    "end": "2443650"
  },
  {
    "text": "if how the deployment is doing looks like on that last set of instances let's go look at the rainbow bar now just you",
    "start": "2443650",
    "end": "2449530"
  },
  {
    "text": "can see what it looks like in a different state so you can see now six",
    "start": "2449530",
    "end": "2454780"
  },
  {
    "start": "2453000",
    "end": "2690000"
  },
  {
    "text": "instances succeeded three in progress we can give it one more refresh and see if",
    "start": "2454780",
    "end": "2460060"
  },
  {
    "text": "we can get the green bars but I won't make us wait here forever noop",
    "start": "2460060",
    "end": "2465849"
  },
  {
    "text": "so still still three incident in progress we can come back to it and verify that it worked let's just",
    "start": "2465849",
    "end": "2474049"
  },
  {
    "text": "decompress real quick so hopefully you've seen how you can use code deploy in the various stages of your application development we started off",
    "start": "2474049",
    "end": "2480920"
  },
  {
    "text": "in tests we took an application bootstrapped it really quickly with code deploy it was relatively simple to do we",
    "start": "2480920",
    "end": "2488390"
  },
  {
    "text": "moved to tests we had a larger footprint we started introducing some validation then we went through production and we",
    "start": "2488390",
    "end": "2493700"
  },
  {
    "text": "made a larger fleet we took advantage of environment variables to change the behavior hopefully you're getting a",
    "start": "2493700",
    "end": "2499339"
  },
  {
    "text": "sense of how could deploy can kind of grow and change as your deployment needs change a couple things that we didn't",
    "start": "2499339",
    "end": "2506089"
  },
  {
    "text": "get to today just due to time constraints that we want to add to this application one is reactive deployment",
    "start": "2506089",
    "end": "2512809"
  },
  {
    "text": "so an Amazon and at our bespoke dog suit company we're real big believers in continuous deployment we want to be able",
    "start": "2512809",
    "end": "2519470"
  },
  {
    "text": "to check in code and just have it get to production without any engineers messing with it you can definitely set up code deploy so",
    "start": "2519470",
    "end": "2526039"
  },
  {
    "text": "that anytime code is checked in you can kick off with deployments we have a couple blog posts on this if you're using github you can use post commit",
    "start": "2526039",
    "end": "2532279"
  },
  {
    "text": "hooks to trigger deployments as soon as you commit new changes if you're using s3 you can take advantage of lambda so",
    "start": "2532279",
    "end": "2538700"
  },
  {
    "text": "anytime you upload something to an s3 buckets you can kick off a new deployment integrators third-party",
    "start": "2538700",
    "end": "2548269"
  },
  {
    "text": "integrators as I said we want code deploy to be something that slots into your existing development process relatively easy these are some of the",
    "start": "2548269",
    "end": "2554809"
  },
  {
    "text": "things that are some of the teams that we've worked with to integrate with code deploy I showed you github and I showed",
    "start": "2554809",
    "end": "2560599"
  },
  {
    "text": "you Jenkins but you know there's a ton more Atlassian bamboo circle CI chef code ship etc etc several of the of the",
    "start": "2560599",
    "end": "2568430"
  },
  {
    "text": "third-party teams are here at the talk when we do questions at the end they'll also be available if you want to ask",
    "start": "2568430",
    "end": "2573470"
  },
  {
    "text": "them questions about using code deploy with any of these products let's see",
    "start": "2573470",
    "end": "2578769"
  },
  {
    "text": "multiple platforms I didn't mention this a beginning but it bears repeating code deploy works on Windows it works on",
    "start": "2578769",
    "end": "2584269"
  },
  {
    "text": "Linux we have installers for RedHat Ubuntu Amazon Linux Windows Server if",
    "start": "2584269",
    "end": "2591650"
  },
  {
    "text": "you can get Ruby to zero to run on your computer it's relatively simple to get the agent bootstrap and running we also run in multiple",
    "start": "2591650",
    "end": "2598700"
  },
  {
    "text": "availability zones we also run on premises so you can use Co deploy to deploy to your own servers as well as to",
    "start": "2598700",
    "end": "2605210"
  },
  {
    "text": "ec2 some new cont some new functionality that was introduced just last week",
    "start": "2605210",
    "end": "2611180"
  },
  {
    "text": "confirmation did an updates and they included Co deploy in this for those not familiar CloudFormation is a",
    "start": "2611180",
    "end": "2616820"
  },
  {
    "text": "configuration driven tool for setting up in configuring infrastructure so with",
    "start": "2616820",
    "end": "2622160"
  },
  {
    "text": "these two I think they combine really well together so you can use cloud formation to provision your ec2",
    "start": "2622160",
    "end": "2627440"
  },
  {
    "text": "instances to configure them the way you want to configure your database and then you can use code deploy to perform the",
    "start": "2627440",
    "end": "2634340"
  },
  {
    "text": "application deployments on to that new infrastructure you can also use cloud formation to set up the code deploy infrastructure so you can automatically",
    "start": "2634340",
    "end": "2640760"
  },
  {
    "text": "create your applications and your deployment groups etc etc as part of a cloud formation stack creation this is",
    "start": "2640760",
    "end": "2648140"
  },
  {
    "text": "really great when we talk about expanding our business to different regions we can codify all of that in a",
    "start": "2648140",
    "end": "2653150"
  },
  {
    "text": "piece of configuration and cloud formations so that when we go to another region it should be relatively simple to just launch the stack and go this is",
    "start": "2653150",
    "end": "2659480"
  },
  {
    "text": "also great if you're setting up you know we're going to go through a round of hiring of course and so there'll be more developers if we have a cloud permission",
    "start": "2659480",
    "end": "2665960"
  },
  {
    "text": "template that they can use to set up a devstack sort of on demand that's a really great way to kind of save time and effort",
    "start": "2665960",
    "end": "2672070"
  },
  {
    "text": "thank you I think that's all the content I have today appreciate you all coming out it looks like we've got a little bit",
    "start": "2672070",
    "end": "2678080"
  },
  {
    "text": "of time left all I can do questions please remember to fill out evaluation forms if if you would tell us what you",
    "start": "2678080",
    "end": "2684830"
  },
  {
    "text": "liked or didn't like or what you want to see you next time thanks for coming out",
    "start": "2684830",
    "end": "2690460"
  }
]