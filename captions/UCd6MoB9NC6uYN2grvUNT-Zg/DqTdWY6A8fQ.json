[
  {
    "start": "0",
    "end": "137000"
  },
  {
    "text": "back I hope you're having a good time at the online conference today so my name",
    "start": "0",
    "end": "5879"
  },
  {
    "text": "is Randall hunt I'm a software engineer and developer evangelist here at Amazon Web Services and I've got some slides on",
    "start": "5879",
    "end": "12599"
  },
  {
    "text": "screen twitch is not typically the place where we show slides but I thought given",
    "start": "12599",
    "end": "18060"
  },
  {
    "text": "the nature of what we're trying to build it might make sense to go with a little bit of prepared work now the way that",
    "start": "18060",
    "end": "26699"
  },
  {
    "text": "this works is there are you know there's",
    "start": "26699",
    "end": "31830"
  },
  {
    "text": "chat so you can chat with me you can send things live from the chat here and",
    "start": "31830",
    "end": "39090"
  },
  {
    "text": "I will try to answer those questions so fire be 675 hello to you as well",
    "start": "39090",
    "end": "46739"
  },
  {
    "text": "and Alex tear plays says wet it's 1:00 a.m. it is a need 1:00 a.m. and this",
    "start": "46739",
    "end": "54090"
  },
  {
    "text": "session is going to be a lot of fun because it's 1:00 a.m. that said I think this conference this innovate conference",
    "start": "54090",
    "end": "60510"
  },
  {
    "text": "this online conference it's a free conference that everyone can attend it's going very well I hope you're all",
    "start": "60510",
    "end": "65880"
  },
  {
    "text": "enjoying it I hope you're checking out some of the sessions I hope you checked out dr. inaudible session and I think",
    "start": "65880",
    "end": "73020"
  },
  {
    "text": "with that we are ready to get started so this is me like I said I'm just a Technical Evangelist AWS I write a bunch",
    "start": "73020",
    "end": "79950"
  },
  {
    "text": "of demos and kind of fun stuff on top of AWS this is my real official badge photo",
    "start": "79950",
    "end": "85310"
  },
  {
    "text": "don't know exactly how that happened and almost everything we're going to be doing today is in Python if you want to",
    "start": "85310",
    "end": "92729"
  },
  {
    "text": "see some non Python code you've got to go find another streamer so this is what",
    "start": "92729",
    "end": "100890"
  },
  {
    "text": "we're building and if you were in the previous session you've probably already seen this so the way that this works is",
    "start": "100890",
    "end": "108079"
  },
  {
    "text": "you we build a Twitter bot that tries to identify where in the world a picture",
    "start": "108079",
    "end": "113640"
  },
  {
    "text": "was taken based solely on the pixels in the image so it's not using any of the",
    "start": "113640",
    "end": "118950"
  },
  {
    "text": "exif data which is what people typically use to populate an image with latitude",
    "start": "118950",
    "end": "124409"
  },
  {
    "text": "and longitude this is actually just taking the pixels that make up the image in determining where exactly they",
    "start": "124409",
    "end": "133280"
  },
  {
    "text": "correspond to in a graph and there's some kind of cool magic for how this happens so before we jump into the magic I'm",
    "start": "133410",
    "end": "140580"
  },
  {
    "start": "137000",
    "end": "227000"
  },
  {
    "text": "gonna cover the architecture now I want you to ignore the right half of the screen right now or maybe it's a left",
    "start": "140580",
    "end": "146160"
  },
  {
    "text": "half depending on how twitch is flipped things and I want you to focus instead on this half this serverless half so",
    "start": "146160",
    "end": "154590"
  },
  {
    "text": "what's happening is Twitter has an API and this is a web hooks API and the way that this works is we authenticate a URL",
    "start": "154590",
    "end": "162330"
  },
  {
    "text": "of our choice with Twitter and we say hey Twitter when an action happens we",
    "start": "162330",
    "end": "167820"
  },
  {
    "text": "want you to call out to that URL with a payload and we want you to invoke this",
    "start": "167820",
    "end": "173010"
  },
  {
    "text": "lambda function and ALAB the function is really just a very simple server list",
    "start": "173010",
    "end": "179760"
  },
  {
    "text": "function that contains some code in response to this incoming request and",
    "start": "179760",
    "end": "186660"
  },
  {
    "text": "there's some more things we can talk about with lambda now in the session earlier today we covered how to build",
    "start": "186660",
    "end": "193530"
  },
  {
    "text": "that serverless ID but we didn't quite finish it so my plan is to kind of come back to the service slide side of things",
    "start": "193530",
    "end": "201530"
  },
  {
    "text": "finish building all of that and then jump into the amazon sage maker side of",
    "start": "201530",
    "end": "206790"
  },
  {
    "text": "things the sage maker side of things is a machine learning service that we have at",
    "start": "206790",
    "end": "212130"
  },
  {
    "text": "AWS that kind of lets us build and host and train our own models and if you saw Julian Simone's talk from earlier today",
    "start": "212130",
    "end": "220830"
  },
  {
    "text": "you would have learned how to build and train your own model on Sage Maker now I'm going to be using the US West 2",
    "start": "220830",
    "end": "226380"
  },
  {
    "text": "region and I'm gonna hop over to some code now so if we go over here to the",
    "start": "226380",
    "end": "236010"
  },
  {
    "start": "227000",
    "end": "343000"
  },
  {
    "text": "lambda function this is what we built in the previous session now I'm gonna just briefly adjust the chroma on my on my",
    "start": "236010",
    "end": "248540"
  },
  {
    "text": "screen here just because it's weird to have my face kind of half half and half",
    "start": "248540",
    "end": "253920"
  },
  {
    "text": "out hopefully that's a little bit better and what I'm gonna do is go over this",
    "start": "253920",
    "end": "265020"
  },
  {
    "text": "code that we've already created so the way that Twitter works as I said before is you register a web hook so you",
    "start": "265020",
    "end": "272639"
  },
  {
    "text": "take using their API you take your secret key and your access token and all",
    "start": "272639",
    "end": "280830"
  },
  {
    "text": "this good stuff and you where is this you can grab those credentials from",
    "start": "280830",
    "end": "287460"
  },
  {
    "text": "secrets manager which is where we are storing them and then you sign the incoming request so if they're if",
    "start": "287460",
    "end": "294630"
  },
  {
    "text": "Twitter is making a get request to our web hook we sign that request and we return the signed token so that Twitter",
    "start": "294630",
    "end": "301800"
  },
  {
    "text": "can verify we are indeed the ones who are making this request and we are indeed hosting that endpoint now though",
    "start": "301800",
    "end": "312509"
  },
  {
    "text": "the way that this works and the kind of management section of this is in my",
    "start": "312509",
    "end": "319440"
  },
  {
    "text": "opinion a little bit more important and interesting then is the CRC and security",
    "start": "319440",
    "end": "326580"
  },
  {
    "text": "portion of this but security is important that I think it's worth covering exactly what's happening here",
    "start": "326580",
    "end": "332930"
  },
  {
    "text": "very very quickly so hopping into this",
    "start": "332930",
    "end": "338720"
  },
  {
    "text": "very briefly I'm just gonna go over what exactly we're doing essentially we're",
    "start": "338720",
    "end": "344220"
  },
  {
    "text": "creating an H Mac which is a type of signature based on the consumer secret",
    "start": "344220",
    "end": "350010"
  },
  {
    "text": "of our application which is something that Twitter will give us when we register our application and based on",
    "start": "350010",
    "end": "355139"
  },
  {
    "text": "the incoming CRC token that we get and then we're sha-256 encoding it and we",
    "start": "355139",
    "end": "362820"
  },
  {
    "text": "are basically creating a JSON string that contains response token and shot",
    "start": "362820",
    "end": "368220"
  },
  {
    "text": "256 now when it comes to verifying the incoming requests what we're doing is",
    "start": "368220",
    "end": "373560"
  },
  {
    "text": "we're collecting a CRC from the incoming event and this will be a limit of proxy",
    "start": "373560",
    "end": "379800"
  },
  {
    "text": "invocation and we're grabbing this X Twitter web hook signature header which",
    "start": "379800",
    "end": "385320"
  },
  {
    "text": "contains our CRC we're basically doing the same process here of grabbing the",
    "start": "385320",
    "end": "392820"
  },
  {
    "text": "CRC but in Reverse what we're doing is we're saying create this our own CRC",
    "start": "392820",
    "end": "400200"
  },
  {
    "text": "based on the body of the request and then take",
    "start": "400200",
    "end": "407129"
  },
  {
    "text": "out the CRC that was given to us from Twitter take out the first seven",
    "start": "407129",
    "end": "413309"
  },
  {
    "text": "characters those first seven characters they correspond to sha-256 equals and",
    "start": "413309",
    "end": "418430"
  },
  {
    "text": "then return whether or not the calculated CRC the one that we just",
    "start": "418430",
    "end": "425059"
  },
  {
    "text": "calculated this age digest and the CRC that we've decoded from this Web clip",
    "start": "425059",
    "end": "430379"
  },
  {
    "text": "header are the same and if they're not the same then that request is not really",
    "start": "430379",
    "end": "436770"
  },
  {
    "text": "from Twitter and we know that it's not really from Twitter so then we kind of get into what this lamda request is",
    "start": "436770",
    "end": "443969"
  },
  {
    "text": "supposed to do and if we look at this code you can see if the path is not webhook then we just want to return 404",
    "start": "443969",
    "end": "449599"
  },
  {
    "text": "if the event is HTTP method get' then we want to get the CRC and if the CRC isn't",
    "start": "449599",
    "end": "457620"
  },
  {
    "text": "there that means it's not a valid request but if it is there then we want to sign the CRC and return that now the",
    "start": "457620",
    "end": "464430"
  },
  {
    "text": "second part of what we have to do here is deal with the chance that the",
    "start": "464430",
    "end": "471479"
  },
  {
    "text": "incoming request from Twitter is not valid or that it's not really from Twitter somebody else is trying to",
    "start": "471479",
    "end": "477240"
  },
  {
    "text": "pretend to be Twitter this is really easy with this verify request method that we created so we just say it's not",
    "start": "477240",
    "end": "482339"
  },
  {
    "text": "verify request event context we want to you know maybe print unable to verify",
    "start": "482339",
    "end": "490769"
  },
  {
    "text": "the CRC and just for debugging purposes while we're getting started here and we",
    "start": "490769",
    "end": "496229"
  },
  {
    "text": "want to say status code 400 and body is",
    "start": "496229",
    "end": "504389"
  },
  {
    "text": "gonna be bad CRC now with that we don't",
    "start": "504389",
    "end": "513089"
  },
  {
    "text": "actually have to do much else we really",
    "start": "513089",
    "end": "518339"
  },
  {
    "text": "just have the meat of our function now because if the if all of this is working",
    "start": "518339",
    "end": "525860"
  },
  {
    "text": "if this request is valid then all of this stuff is just preamble so we could",
    "start": "525860",
    "end": "533670"
  },
  {
    "text": "even kind of Rapp a lot of this into its own method if we wanted which was you know is valid",
    "start": "533670",
    "end": "540170"
  },
  {
    "text": "request and we could return a payload",
    "start": "540170",
    "end": "549329"
  },
  {
    "text": "from this so we could say event context we could say all of this move all of",
    "start": "549329",
    "end": "558810"
  },
  {
    "text": "this into here and you guys can see",
    "start": "558810",
    "end": "564839"
  },
  {
    "text": "everything okay right do I need to make it any bigger or move it around on the screen at all let me know I have a big",
    "start": "564839",
    "end": "571649"
  },
  {
    "text": "microphone in the way of my screen here so I can only see a little left half of",
    "start": "571649",
    "end": "576870"
  },
  {
    "text": "it so what we want to do in this case is",
    "start": "576870",
    "end": "584310"
  },
  {
    "text": "we kind of want to return false and in",
    "start": "584310",
    "end": "589560"
  },
  {
    "text": "this payload so we want to return a tuple and then we want to return false",
    "start": "589560",
    "end": "599510"
  },
  {
    "text": "and false needs to be capitalized turn",
    "start": "599510",
    "end": "609600"
  },
  {
    "text": "that and then we can return true on this one since this is a valid request",
    "start": "609600",
    "end": "616939"
  },
  {
    "text": "actually we don't even need to do this we could just add some additional logic",
    "start": "619730",
    "end": "625800"
  },
  {
    "text": "and the main lambda function so let's do that instead",
    "start": "625800",
    "end": "632779"
  },
  {
    "text": "so we're gonna do it like this what we're gonna do is say if is valid",
    "start": "638510",
    "end": "653329"
  },
  {
    "text": "request or so we'll say a valid equals",
    "start": "653329",
    "end": "659389"
  },
  {
    "text": "is valid request event context if valid",
    "start": "659389",
    "end": "666370"
  },
  {
    "text": "status code else return we'll just",
    "start": "668110",
    "end": "676910"
  },
  {
    "text": "return an empty body so we'll just have one last little section over here or we",
    "start": "676910",
    "end": "682399"
  },
  {
    "text": "say status code is 200 and we're just",
    "start": "682399",
    "end": "688519"
  },
  {
    "text": "gonna say a response so status code is going to be 200 and body will be empty",
    "start": "688519",
    "end": "700480"
  },
  {
    "text": "so response for is valid request is going to become if valid status code",
    "start": "700480",
    "end": "707350"
  },
  {
    "text": "equals C is greater than or is greater",
    "start": "707350",
    "end": "715910"
  },
  {
    "text": "than or equal to 400 then we return the response else we can start doing some",
    "start": "715910",
    "end": "722779"
  },
  {
    "text": "work so that's basically saying if our status code is anything other than a ok",
    "start": "722779",
    "end": "729170"
  },
  {
    "start": "724000",
    "end": "756000"
  },
  {
    "text": "if it's not if it's 400 or above any kind of 400 then we just want to return this is valid request response so maybe",
    "start": "729170",
    "end": "738860"
  },
  {
    "text": "we should have rewritten this verify request context change valid to response",
    "start": "738860",
    "end": "744949"
  },
  {
    "text": "on line 51 yes good call good call nice nice catch gay paalam oh hey hi you",
    "start": "744949",
    "end": "752870"
  },
  {
    "text": "so there we go we have to Hamlet context",
    "start": "752870",
    "end": "759740"
  },
  {
    "start": "756000",
    "end": "880000"
  },
  {
    "text": "return response now now this is where I mean we can save this and we can test it",
    "start": "759740",
    "end": "764990"
  },
  {
    "text": "very quickly so we can hop back over to API gateway we can look at this method done proxy invocation here",
    "start": "764990",
    "end": "772399"
  },
  {
    "text": "and we can go and we can click test on this method and we'll just make a quick",
    "start": "772399",
    "end": "779059"
  },
  {
    "text": "get request test this and of course we got an internal server error and we have",
    "start": "779059",
    "end": "790730"
  },
  {
    "text": "an attribution error for get CRC token on line 51 response is valid request an",
    "start": "790730",
    "end": "797540"
  },
  {
    "text": "attendance in in line 31 so we didn't",
    "start": "797540",
    "end": "807259"
  },
  {
    "text": "respond correctly so line 31 should be",
    "start": "807259",
    "end": "814550"
  },
  {
    "text": "doing more so we should be returning C or C not provided or invalid that is not",
    "start": "814550",
    "end": "820879"
  },
  {
    "text": "what we are doing let me see what",
    "start": "820879",
    "end": "833240"
  },
  {
    "text": "exactly is happening here if it don't",
    "start": "833240",
    "end": "838759"
  },
  {
    "text": "get past slash webhook hmm we're",
    "start": "838759",
    "end": "849199"
  },
  {
    "text": "invoking this so I've got a big microphone in my way error message a nun",
    "start": "849199",
    "end": "856160"
  },
  {
    "text": "type object has no attribute get so the event that we're passing in has no",
    "start": "856160",
    "end": "865639"
  },
  {
    "text": "attribute yet so CR C equals event dot",
    "start": "865639",
    "end": "872209"
  },
  {
    "text": "get query string parameters not get CRC token yeah you know I think we've got",
    "start": "872209",
    "end": "882439"
  },
  {
    "start": "880000",
    "end": "1154000"
  },
  {
    "text": "this path wrong but I don't think that's what's causing it just because it is getting past that section so if we hop",
    "start": "882439",
    "end": "888649"
  },
  {
    "text": "over here and we look at this and we can go look at it in a little bit easier place we can hop over into monitoring",
    "start": "888649",
    "end": "894800"
  },
  {
    "text": "and we can say view the logs and cloud watch this will take just a moment to",
    "start": "894800",
    "end": "902449"
  },
  {
    "text": "load um open up the stream and it seems like",
    "start": "902449",
    "end": "913870"
  },
  {
    "text": "on line 31 none type object has no",
    "start": "913870",
    "end": "919389"
  },
  {
    "text": "attribute yet so our event is not being populated for some reason very confused",
    "start": "919389",
    "end": "933720"
  },
  {
    "text": "let's try a post really fast",
    "start": "933720",
    "end": "937949"
  },
  {
    "text": "I think we're gonna run into the same issue hmm it's very strange it's hot",
    "start": "941510",
    "end": "951950"
  },
  {
    "text": "back over into the code and let's just",
    "start": "951950",
    "end": "958340"
  },
  {
    "text": "step through it so when something like this goes wrong what I like to do is I just kind of go through the path that my",
    "start": "958340",
    "end": "963590"
  },
  {
    "text": "code is tracing so we're definitely",
    "start": "963590",
    "end": "969110"
  },
  {
    "text": "hitting this function so we know that we're getting there and so maybe I think",
    "start": "969110",
    "end": "982970"
  },
  {
    "text": "we just need to say item is going to be",
    "start": "982970",
    "end": "989660"
  },
  {
    "text": "an empty dictionary so then we say item or so it will say event equals to the event get query string parameters and",
    "start": "989660",
    "end": "999530"
  },
  {
    "text": "then we want to return an empty dictionary if that's not the case and then we want to say get this we're gonna",
    "start": "999530",
    "end": "1005140"
  },
  {
    "text": "say CRC equals and then we want to say get CRC token so we've done that now our",
    "start": "1005140",
    "end": "1017200"
  },
  {
    "text": "CRC should be none so if not CRC print",
    "start": "1017200",
    "end": "1022860"
  },
  {
    "text": "no CRC no CRC",
    "start": "1022860",
    "end": "1031790"
  },
  {
    "text": "so that is solid and we return to that",
    "start": "1031790",
    "end": "1039829"
  },
  {
    "text": "so we're definitely hitting that let me",
    "start": "1039830",
    "end": "1052230"
  },
  {
    "text": "just try something really fast if we change this to the return empty string does the same code work it does so let's",
    "start": "1052230",
    "end": "1060000"
  },
  {
    "text": "just change this to return empty string and see what happens we'll hop back over",
    "start": "1060000",
    "end": "1068010"
  },
  {
    "text": "into API gateway and we will say test this again I'm just trying to get this",
    "start": "1068010",
    "end": "1074790"
  },
  {
    "text": "to return a 400 essentially hmm rather",
    "start": "1074790",
    "end": "1085710"
  },
  {
    "text": "strange indeed I'm probably just doing",
    "start": "1085710",
    "end": "1095730"
  },
  {
    "text": "something foolish let's see we have none",
    "start": "1095730",
    "end": "1108480"
  },
  {
    "text": "type of object has no attributes get arrow type stack trace from line 51",
    "start": "1108480",
    "end": "1114230"
  },
  {
    "text": "responses valid request event context line 31 is valid request CR C equals",
    "start": "1114230",
    "end": "1120270"
  },
  {
    "text": "event get query string parameters so it's definitely invoking the right",
    "start": "1120270",
    "end": "1126780"
  },
  {
    "text": "version",
    "start": "1126780",
    "end": "1129380"
  },
  {
    "text": "what could be happening is query string parameters could be not empty",
    "start": "1136100",
    "end": "1143940"
  },
  {
    "text": "in which case when we call get CRC but",
    "start": "1143940",
    "end": "1150330"
  },
  {
    "text": "if it's not empty it would still be a dictionary in which case we would so",
    "start": "1150330",
    "end": "1155370"
  },
  {
    "text": "Gabe has the suggestion of splitting this into two different calls so we're going to do that query string is going",
    "start": "1155370",
    "end": "1161160"
  },
  {
    "text": "to be event get query string parameters",
    "start": "1161160",
    "end": "1168260"
  },
  {
    "text": "empty dictionary there and then CRC is going to be event get CRC token and it",
    "start": "1169250",
    "end": "1178890"
  },
  {
    "text": "will say print Clery string or a query",
    "start": "1178890",
    "end": "1194010"
  },
  {
    "text": "string it will do the same thing here will say CRC print the CRC query string",
    "start": "1194010",
    "end": "1223130"
  },
  {
    "text": "so let's test this again over on the API gateway side and of course we'll get the",
    "start": "1227500",
    "end": "1238130"
  },
  {
    "text": "same error and hopefully it'll at least be a different line so it's so it's that",
    "start": "1238130",
    "end": "1247070"
  },
  {
    "text": "the event is not being populated so now because it's line 32 this time so why is",
    "start": "1247070",
    "end": "1257809"
  },
  {
    "text": "the event not being populated no the pair programming is very much",
    "start": "1257809",
    "end": "1263240"
  },
  {
    "text": "appreciated thank you so let's hop over to line 32 query string parameters so I",
    "start": "1263240",
    "end": "1277789"
  },
  {
    "text": "think what we need to do really is this save this whole shindig and then hop",
    "start": "1277789",
    "end": "1289460"
  },
  {
    "text": "back over here check out these logs",
    "start": "1289460",
    "end": "1293620"
  },
  {
    "text": "definitely on query string yet so how is this returning a none type very very",
    "start": "1295029",
    "end": "1304340"
  },
  {
    "text": "confused wait is there a typo we're",
    "start": "1304340",
    "end": "1314419"
  },
  {
    "text": "definitely passing this in event context",
    "start": "1314419",
    "end": "1319510"
  },
  {
    "text": "wait is it is there really a typo somewhere okay so if you guys have ever",
    "start": "1319510",
    "end": "1328010"
  },
  {
    "text": "seen me livestream before I typically I go into these projects with very little preparation just because I think it",
    "start": "1328010",
    "end": "1334340"
  },
  {
    "text": "demonstrates a little bit better what the actual process of programming is",
    "start": "1334340",
    "end": "1339380"
  },
  {
    "text": "like because if you if you already have everything copy pasted and I do I felt this before so I know the general",
    "start": "1339380",
    "end": "1345470"
  },
  {
    "text": "structure and full of everything so but",
    "start": "1345470",
    "end": "1351649"
  },
  {
    "text": "even if it's set to none type it should still I mean that's a problem like",
    "start": "1351649",
    "end": "1357799"
  },
  {
    "text": "condition at that point so if query string is none then query string needs",
    "start": "1357799",
    "end": "1368600"
  },
  {
    "text": "to needs to be equal to empty dictionary",
    "start": "1368600",
    "end": "1378430"
  },
  {
    "text": "that's the only thing I can think of doing so we'll save this absurd",
    "start": "1378430",
    "end": "1384470"
  },
  {
    "text": "condition oh yeah so who was it that",
    "start": "1384470",
    "end": "1390980"
  },
  {
    "text": "suggested that chap who epi says maybe query string actually exists in a set to",
    "start": "1390980",
    "end": "1397040"
  },
  {
    "text": "none and that is of course exactly what it was so now that we've done this we can start making progress again good",
    "start": "1397040",
    "end": "1402860"
  },
  {
    "text": "call good call that will never actually happen in production because if there is",
    "start": "1402860",
    "end": "1409430"
  },
  {
    "text": "no query string on the request then the API gateway is not going to create that",
    "start": "1409430",
    "end": "1415900"
  },
  {
    "text": "method so that is a weird thing that I've never run into before I'm gonna",
    "start": "1415900",
    "end": "1422300"
  },
  {
    "text": "remove these print statements just because there's no reason to kind of populate our logs with them and welcome",
    "start": "1422300",
    "end": "1432500"
  },
  {
    "start": "1430000",
    "end": "1545000"
  },
  {
    "text": "hines thanks for joining so now we have the kind of meet of our current request",
    "start": "1432500",
    "end": "1439940"
  },
  {
    "text": "here so if their code is greater than 400 we're gonna return whatever bad response we got otherwise our response",
    "start": "1439940",
    "end": "1446780"
  },
  {
    "text": "is ready to be populated with some kind of you know whatever twitter is sending",
    "start": "1446780",
    "end": "1453560"
  },
  {
    "text": "us so let's go look and see what one of these payloads looks like and in these",
    "start": "1453560",
    "end": "1459260"
  },
  {
    "text": "are gonna be the account activity API data objects and we're primarily going to be interested in these tweet create",
    "start": "1459260",
    "end": "1464780"
  },
  {
    "text": "events so this is what a tweet create event looks like it's gonna be some JSON and it's gonna be for user ID tweet",
    "start": "1464780",
    "end": "1473120"
  },
  {
    "text": "creator and then a tweet object so what does a tweet object look like tweet object wonderful that is not at all",
    "start": "1473120",
    "end": "1481100"
  },
  {
    "text": "helpful thank you I shouldn't I should this is all in Python so I shouldn't be",
    "start": "1481100",
    "end": "1489100"
  },
  {
    "text": "I shouldn't be so hard on Twitter because they have actually made this much better than it",
    "start": "1490300",
    "end": "1496280"
  },
  {
    "text": "was originally but there's still a long way to go but I am thankful for the",
    "start": "1496280",
    "end": "1502070"
  },
  {
    "text": "people at Twitter who have made this you know previously there were no payload examples at all so you just kind of had",
    "start": "1502070",
    "end": "1508550"
  },
  {
    "text": "to guesstimate what exactly what's happening so you know a favorite event or a follow-up and any of these sorts of",
    "start": "1508550",
    "end": "1514310"
  },
  {
    "text": "things you just had to wait for one of those events to actually happen in production in order to figure out what",
    "start": "1514310",
    "end": "1519470"
  },
  {
    "text": "at all was going to happen and so she asked if we still need or fashi asks if we still need the empty",
    "start": "1519470",
    "end": "1530600"
  },
  {
    "text": "dictionary here in query string and we",
    "start": "1530600",
    "end": "1535670"
  },
  {
    "text": "don't really so we can get rid of that so or Dewey it's gonna return none I'm",
    "start": "1535670",
    "end": "1547870"
  },
  {
    "start": "1545000",
    "end": "1683000"
  },
  {
    "text": "yeah so we don't need that and Chavo Chung is asking if you want to learn how",
    "start": "1547870",
    "end": "1553220"
  },
  {
    "text": "to code can anybody give me advice I'd strongly suggest checking out code Academy if you're looking to learn some",
    "start": "1553220",
    "end": "1558560"
  },
  {
    "text": "JavaScript and then there tons of other really cool things to check out tons of",
    "start": "1558560",
    "end": "1563600"
  },
  {
    "text": "great resources online things like code combat and all that good stuff so we are",
    "start": "1563600",
    "end": "1568700"
  },
  {
    "text": "certain at this point that our requests are secure we have done everything we need to to make that happen and now we",
    "start": "1568700",
    "end": "1574310"
  },
  {
    "text": "want to and now we want to make sure that these tweak create events that are",
    "start": "1574310",
    "end": "1579320"
  },
  {
    "text": "coming and we can parse them so the easiest way to do this is gonna be to",
    "start": "1579320",
    "end": "1584780"
  },
  {
    "text": "say print our sorry I imported JSON already and portraits on yeah I've got",
    "start": "1584780",
    "end": "1591110"
  },
  {
    "text": "that the easiest way to do this is actually gonna be to say for event in",
    "start": "1591110",
    "end": "1597190"
  },
  {
    "text": "Twitter events get tweet create events",
    "start": "1597190",
    "end": "1604360"
  },
  {
    "text": "and then will return an empty array if nothing was there we just want to say I",
    "start": "1604360",
    "end": "1615610"
  },
  {
    "text": "guess she's I guess what we really want to do is we want to create this Twitter",
    "start": "1615610",
    "end": "1621320"
  },
  {
    "text": "events construct from the incoming data as will say JSON",
    "start": "1621320",
    "end": "1628140"
  },
  {
    "text": "loads event body and then we can do",
    "start": "1628140",
    "end": "1637080"
  },
  {
    "text": "whatever you want with each one of these events so I think for now we could just say you know print the event you know",
    "start": "1637080",
    "end": "1643860"
  },
  {
    "text": "log it out and then we can just return that response object from before we",
    "start": "1643860",
    "end": "1650070"
  },
  {
    "text": "don't really need to do anything and that's a good start and then we can go",
    "start": "1650070",
    "end": "1656130"
  },
  {
    "text": "and actually register this web hug so everything is up and running",
    "start": "1656130",
    "end": "1662700"
  },
  {
    "text": "this is deployed in two prod so if we go back to here we've created this little",
    "start": "1662700",
    "end": "1668390"
  },
  {
    "text": "API gateway and we've got it running and prod here and all we need to do is",
    "start": "1668390",
    "end": "1674790"
  },
  {
    "text": "basically just tell it to invoke this endpoint so I mean that's that's it",
    "start": "1674790",
    "end": "1685650"
  },
  {
    "start": "1683000",
    "end": "1775000"
  },
  {
    "text": "that's the entirety of how a web hook works in Twitter you know the if you",
    "start": "1685650",
    "end": "1691500"
  },
  {
    "text": "wanted to see exactly what the code is doing on the machine learning side we",
    "start": "1691500",
    "end": "1700530"
  },
  {
    "text": "can jump into that next but and some people are asking what exactly are",
    "start": "1700530",
    "end": "1705690"
  },
  {
    "text": "recoding here so I'm gonna go back very briefly to the architecture basically we have Twitter coming in and talking to if",
    "start": "1705690",
    "end": "1712980"
  },
  {
    "text": "you got a wave over web hook and booking lambda function that lambda function is going to read the incoming tweet and",
    "start": "1712980",
    "end": "1718050"
  },
  {
    "text": "respond to it and what this looks like at the core when we get to it what this",
    "start": "1718050",
    "end": "1724560"
  },
  {
    "text": "looks like oops sorry the wrong tab here what this looks like is my internet speeds up at",
    "start": "1724560",
    "end": "1734640"
  },
  {
    "text": "all",
    "start": "1734640",
    "end": "1736760"
  },
  {
    "text": "sorry I think my computers about to take off this look can hear the fans running so this is a picture I guess somebody is",
    "start": "1746720",
    "end": "1756840"
  },
  {
    "text": "taking of the Golden Gate Bridge and it's correctly predicting that it's in",
    "start": "1756840",
    "end": "1763740"
  },
  {
    "text": "San Francisco so that's the machine learning side of what we're building and I'm just going to show you now what that",
    "start": "1763740",
    "end": "1772140"
  },
  {
    "text": "machine learning side is about because rather than replacing the currently",
    "start": "1772140",
    "end": "1777299"
  },
  {
    "start": "1775000",
    "end": "2026000"
  },
  {
    "text": "working webhook of where ml I'm just going to show you the code that we use to make it work so what we do is we have",
    "start": "1777299",
    "end": "1786090"
  },
  {
    "text": "something called voto 3 and I'm not going to make this perfect I'm just gonna say normally your imports should",
    "start": "1786090",
    "end": "1792600"
  },
  {
    "text": "be at the top but I'm just gonna kind of show them down here so that they all fit on one screen so we're gonna say sage",
    "start": "1792600",
    "end": "1798690"
  },
  {
    "text": "maker equals photo 3 dot client sage maker and then we say we want to",
    "start": "1798690",
    "end": "1809659"
  },
  {
    "text": "basically invoke this this sage maker",
    "start": "1809659",
    "end": "1816090"
  },
  {
    "text": "endpoint so we're gonna say sage maker invoke endpoint and in this case it's",
    "start": "1816090",
    "end": "1821940"
  },
  {
    "text": "just going to be predict places and I",
    "start": "1821940",
    "end": "1827490"
  },
  {
    "text": "haven't showed you how to make this yet so don't worry if you haven't seen this",
    "start": "1827490",
    "end": "1832770"
  },
  {
    "text": "endpoint and then I guess I need to",
    "start": "1832770",
    "end": "1839940"
  },
  {
    "text": "actually pass in the keyword arguments here in point name equals predict places",
    "start": "1839940",
    "end": "1847049"
  },
  {
    "text": "and the body is going to be JSON and",
    "start": "1847049",
    "end": "1858630"
  },
  {
    "text": "we're gonna take that tweet event that we got and we're gonna encode it by",
    "start": "1858630",
    "end": "1865799"
  },
  {
    "text": "saying URL is going to be",
    "start": "1865799",
    "end": "1871100"
  },
  {
    "text": "against the media somewhere so I think what we need to do is we need to find a",
    "start": "1876480",
    "end": "1885539"
  },
  {
    "text": "we need to find the media of the request",
    "start": "1886260",
    "end": "1893100"
  },
  {
    "text": "so in order to get that we're gonna have",
    "start": "1893100",
    "end": "1899860"
  },
  {
    "text": "to look at the tweet object so what we",
    "start": "1899860",
    "end": "1904900"
  },
  {
    "text": "need is we need the JSON tweet object example so hopefully this will give us",
    "start": "1904900",
    "end": "1915880"
  },
  {
    "text": "some idea of what this looks like media it's gonna be one of the things that",
    "start": "1915880",
    "end": "1924640"
  },
  {
    "text": "were looking at so is it going to be an entities so it'll be in entities so I'm",
    "start": "1924640",
    "end": "1931600"
  },
  {
    "text": "going to move this to one side and then I'm gonna grab this off on the other side and it'll basically be we're gonna",
    "start": "1931600",
    "end": "1939160"
  },
  {
    "text": "pass in the URL of the of the media so",
    "start": "1939160",
    "end": "1945580"
  },
  {
    "text": "we're gonna say you know instead of this we can just see before tweet know it's",
    "start": "1945580",
    "end": "1951940"
  },
  {
    "text": "gonna be an event because it's not just going to be tweets so we're gonna say for event entities media and we're just",
    "start": "1951940",
    "end": "1963190"
  },
  {
    "text": "gonna hard code grab the first piece of media and we're gonna go URL but I think",
    "start": "1963190",
    "end": "1972130"
  },
  {
    "text": "that's what we're gonna go but we need to look and see what exactly media looks like so we need to see what a media",
    "start": "1972130",
    "end": "1979990"
  },
  {
    "text": "object was like media objects here we go",
    "start": "1979990",
    "end": "1989940"
  },
  {
    "text": "so it looks like there are a couple different kinds of URLs here if you see my head moving around a lot it's that",
    "start": "1990330",
    "end": "1996280"
  },
  {
    "text": "I've got a big microphone kind of in the way of my screen here so I'm having to kind of dodge around to see what exactly",
    "start": "1996280",
    "end": "2003270"
  },
  {
    "text": "is happening so maybe I want media URL",
    "start": "2003270",
    "end": "2008980"
  },
  {
    "text": "HPS that's probably what I want and I think with that we'll have the at least",
    "start": "2008980",
    "end": "2014769"
  },
  {
    "text": "the first part of what we want to pass in so we'll go back over here and we'll",
    "start": "2014769",
    "end": "2027909"
  },
  {
    "text": "say this is going to be the maximum",
    "start": "2027909",
    "end": "2036820"
  },
  {
    "text": "number of predictions that we want to generate and in this case I'm just gonna say three so at this point this is the",
    "start": "2036820",
    "end": "2045580"
  },
  {
    "text": "majority of what's happening and all of the magic is kind of happening in this siege maker invoke endpoint section so I",
    "start": "2045580",
    "end": "2051730"
  },
  {
    "text": "think that's the the end of what we really need to talk about on the surrealist side you know maybe we do",
    "start": "2051730",
    "end": "2058780"
  },
  {
    "text": "something else afterwards where we go Twitter API dot posts update and then we",
    "start": "2058780",
    "end": "2066158"
  },
  {
    "text": "you know build the stats you know we build the the content of the tweet that",
    "start": "2066159",
    "end": "2078819"
  },
  {
    "text": "we want to reply with but that's not too hard so I've done that in another repo",
    "start": "2078819",
    "end": "2085419"
  },
  {
    "text": "that everyone is welcome to check out now I'd like to jump over into the sage",
    "start": "2085419",
    "end": "2092349"
  },
  {
    "text": "maker side of things so I'm going to open amazon sage maker and i'm gonna",
    "start": "2092349",
    "end": "2098470"
  },
  {
    "text": "show you what one of these models looks like so this is a model and a model is",
    "start": "2098470",
    "end": "2106619"
  },
  {
    "text": "maybe not the best name for exactly what is happening here is the interval",
    "start": "2106619",
    "end": "2114730"
  },
  {
    "text": "endpoint bracket closed let me double",
    "start": "2114730",
    "end": "2120790"
  },
  {
    "text": "check that",
    "start": "2120790",
    "end": "2123030"
  },
  {
    "text": "well it's I'm not even doing that section anymore but it's fine I'll show you the real invocation later",
    "start": "2135290",
    "end": "2142950"
  },
  {
    "text": "if anybody's interested that invocation was more just kind of educational so",
    "start": "2142950",
    "end": "2150049"
  },
  {
    "start": "2150000",
    "end": "2243000"
  },
  {
    "text": "what is happening here is I've provided a docker container for my endpoint now",
    "start": "2150500",
    "end": "2159720"
  },
  {
    "text": "when I say I provided a docker container that is a flask application very very",
    "start": "2159720",
    "end": "2166440"
  },
  {
    "text": "simple that is just going through and loading a model that's been provided for me by by Sage maker so you can see what",
    "start": "2166440",
    "end": "2177960"
  },
  {
    "text": "this model is it's called location net",
    "start": "2177960",
    "end": "2181700"
  },
  {
    "text": "so here's a good example of it there's a",
    "start": "2183830",
    "end": "2191849"
  },
  {
    "text": "whole blog post about this and the",
    "start": "2191849",
    "end": "2198470"
  },
  {
    "text": "content of this is available right here",
    "start": "2198619",
    "end": "2205530"
  },
  {
    "text": "in location where is this model so this",
    "start": "2205530",
    "end": "2214589"
  },
  {
    "text": "is just I think it's like a 100 megabyte or 200 megabyte model it's really really",
    "start": "2214589",
    "end": "2220470"
  },
  {
    "text": "simple and I'm going to tell you a little bit more about it now so we're gonna hop over into the way that all of",
    "start": "2220470",
    "end": "2226830"
  },
  {
    "text": "this works and I'll try and cover some of that so I'm gonna skip a bunch of",
    "start": "2226830",
    "end": "2232560"
  },
  {
    "text": "slides skip some of the foundational",
    "start": "2232560",
    "end": "2238800"
  },
  {
    "text": "parts of the way these things work so but the problem that we're trying to",
    "start": "2238800",
    "end": "2245250"
  },
  {
    "start": "2243000",
    "end": "2464000"
  },
  {
    "text": "solve is identifying where in the world different images are not from the exif",
    "start": "2245250",
    "end": "2252270"
  },
  {
    "text": "data in them so we let's imagine a scenario where we don't have the exif data available to us but we still want",
    "start": "2252270",
    "end": "2258450"
  },
  {
    "text": "to get where something was taken so that's the frame of a problem that we've started now now we have the data collection part",
    "start": "2258450",
    "end": "2265190"
  },
  {
    "text": "we have something called the multimedia Commons data set which is a couple-hundred it's about 30 40 million",
    "start": "2265190",
    "end": "2272600"
  },
  {
    "text": "different geo tagged images now among those geo tagged images is the the",
    "start": "2272600",
    "end": "2283010"
  },
  {
    "text": "multimedia Commons data set actually contains 100 million images and a couple hundred thousand videos and it's just a",
    "start": "2283010",
    "end": "2291650"
  },
  {
    "text": "ton of multimedia that you can use in any kind of machine learning process and of those hundred million only about",
    "start": "2291650",
    "end": "2297500"
  },
  {
    "text": "thirty three million contained geotag information so we're extracting that",
    "start": "2297500",
    "end": "2302540"
  },
  {
    "text": "geotagged information from the mmm from",
    "start": "2302540",
    "end": "2308090"
  },
  {
    "text": "that entire set of images several hundred terabytes and collecting that",
    "start": "2308090",
    "end": "2315460"
  },
  {
    "text": "keeping that kind of separate we are but paired with the file name and all that good stuff we are kind of cleaning the",
    "start": "2315460",
    "end": "2322190"
  },
  {
    "text": "data we can do any sort of visualization we need that visualization that I'm talking about I'll show you as part of",
    "start": "2322190",
    "end": "2328250"
  },
  {
    "text": "the next step and it's it's really just helping you understand how your data is distributed and the reason you perform",
    "start": "2328250",
    "end": "2333740"
  },
  {
    "text": "that visualization step and you typically do this on a stage make your notebook consensus because it can be quite compute-intensive and the notebook",
    "start": "2333740",
    "end": "2340310"
  },
  {
    "text": "instance typically has more available compute power than what your laptop may",
    "start": "2340310",
    "end": "2346160"
  },
  {
    "text": "have or even more space and what your laptop may have the reason that you do",
    "start": "2346160",
    "end": "2351650"
  },
  {
    "text": "this visualization section is it helps reveal biases in your data it helps you reveal any kind of techniques you might",
    "start": "2351650",
    "end": "2358490"
  },
  {
    "text": "need to implement in order to change around what exactly is happening in the model so then you train the model and",
    "start": "2358490",
    "end": "2366110"
  },
  {
    "text": "the training section is pretty straightforward in a system like ResNet which is the type of model that we are",
    "start": "2366110",
    "end": "2372020"
  },
  {
    "text": "using here which is an image classification model so you're hearing the term ResNet when you think resident",
    "start": "2372020",
    "end": "2378710"
  },
  {
    "text": "just think this is an image classification model it's just a series of different layers that perform",
    "start": "2378710",
    "end": "2385040"
  },
  {
    "text": "different things on the incoming pixels of the image and try and tell me what I",
    "start": "2385040",
    "end": "2390110"
  },
  {
    "text": "should expect as output so we don't really have to worry about feature engineering this point but we do",
    "start": "2390110",
    "end": "2396290"
  },
  {
    "text": "need to worry about model training and parameter tuning and then model evaluation now CH Waker takes care of",
    "start": "2396290",
    "end": "2401690"
  },
  {
    "text": "pretty much all of these components but you do need to write code for the data visualization and for the the that's it",
    "start": "2401690",
    "end": "2411560"
  },
  {
    "text": "really those only real parts you have to write code for and for I guess the data preparation and cleaning now after that",
    "start": "2411560",
    "end": "2418820"
  },
  {
    "text": "you get into the point where you want to host and run that model for real-time",
    "start": "2418820",
    "end": "2425750"
  },
  {
    "text": "inferences for your customers or or for your internal projects now H maker makes",
    "start": "2425750",
    "end": "2430880"
  },
  {
    "text": "this quite easy because I can just say hey take the model that you just trained and create an HTTP enter base for me to",
    "start": "2430880",
    "end": "2437530"
  },
  {
    "text": "invoke this and I can actually have different kinds of things called model variants that I use to invoke mini",
    "start": "2437530",
    "end": "2445400"
  },
  {
    "text": "models simultaneously or to invoke one model sometimes and another model sometimes so 98% of my check that goes",
    "start": "2445400",
    "end": "2452450"
  },
  {
    "text": "to one model 10% goes to another model all that good stuff so this is based on",
    "start": "2452450",
    "end": "2458780"
  },
  {
    "text": "work sorry this is based on work by JM",
    "start": "2458780",
    "end": "2468320"
  },
  {
    "start": "2464000",
    "end": "2510000"
  },
  {
    "text": "Choi and others at the International Computer Science Institute in the",
    "start": "2468320",
    "end": "2473960"
  },
  {
    "text": "University of Berkeley and it we supported the development of this and I",
    "start": "2473960",
    "end": "2479420"
  },
  {
    "text": "think the the original invocation of this kind of hey we can identify where in the world this pictures were taken",
    "start": "2479420",
    "end": "2485570"
  },
  {
    "text": "was actually done by Weiland at all from Google in a paper called planet NOW planet the resulting model was like 20",
    "start": "2485570",
    "end": "2493670"
  },
  {
    "text": "gigs it was huge which means you needed a really beefy server to host it it's not something that you could have put in a",
    "start": "2493670",
    "end": "2498950"
  },
  {
    "text": "lambda function and it's not even something that you could have really hosted without having 20 gigs of RAM",
    "start": "2498950",
    "end": "2504220"
  },
  {
    "text": "because you needed fast access to that entire network in order to be able to successfully predict the output so what",
    "start": "2504220",
    "end": "2511820"
  },
  {
    "start": "2510000",
    "end": "2678000"
  },
  {
    "text": "location that did as opposed to using this dense neural network architecture is they just took a more common model",
    "start": "2511820",
    "end": "2518900"
  },
  {
    "text": "topology called ResNet and they took ResNet they took Apache MX net and they pushed those 33 point nine million geo",
    "start": "2518900",
    "end": "2526520"
  },
  {
    "text": "tag images through a p2 16x large which has a GPU on it and they trained for 12",
    "start": "2526520",
    "end": "2533300"
  },
  {
    "text": "epochs over nine days now they took out that last layer that classification",
    "start": "2533300",
    "end": "2539480"
  },
  {
    "text": "layer of ResNet and instead of classifying whether or not something was a a microphone or a computer or a glass",
    "start": "2539480",
    "end": "2547130"
  },
  {
    "text": "of water they said classify this as if it fits into one of these 15,000 cells so they",
    "start": "2547130",
    "end": "2553220"
  },
  {
    "text": "know from the training set where images should should lie with based on that",
    "start": "2553220",
    "end": "2558950"
  },
  {
    "text": "exif data bits coming in that's part of the training section so they took that",
    "start": "2558950",
    "end": "2564820"
  },
  {
    "text": "last layer and replaced it with a visualization that I'll show you shortly",
    "start": "2564820",
    "end": "2570700"
  },
  {
    "text": "now since this original release of the paper we've actually been able to do a",
    "start": "2570700",
    "end": "2576950"
  },
  {
    "text": "couple of things to improve the speed so the first part is calculating this this s2 spherical geometry subdivide is very",
    "start": "2576950",
    "end": "2585170"
  },
  {
    "text": "very compute-intensive if you think about it you have to basically run a series of indexing operations across 33",
    "start": "2585170",
    "end": "2592850"
  },
  {
    "text": "point nine million geographic coordinates so you need all those coordinates to be available in memory in",
    "start": "2592850",
    "end": "2600290"
  },
  {
    "text": "order to form that index so that takes a",
    "start": "2600290",
    "end": "2607670"
  },
  {
    "text": "little while to run and by paralyzing that process you can get a little bit of a speed boost so that was the first",
    "start": "2607670",
    "end": "2613520"
  },
  {
    "text": "thing that I kind of did to make this model a little bit easier to run in the",
    "start": "2613520",
    "end": "2618710"
  },
  {
    "text": "pre-processing step now the second step that we did to make it a little bit easier to run was to switch from a P to",
    "start": "2618710",
    "end": "2624620"
  },
  {
    "text": "16x large and from a single machine into multiple machines and onto a p3 16x",
    "start": "2624620",
    "end": "2631580"
  },
  {
    "text": "large now the p3 has a much more powerful GPU and is capable of basically",
    "start": "2631580",
    "end": "2637610"
  },
  {
    "text": "a teraflop plus of compute which is absurd it's a tremendous amount of power",
    "start": "2637610",
    "end": "2644090"
  },
  {
    "text": "and so you can take this nine days down to one day or less actually for training",
    "start": "2644090",
    "end": "2650330"
  },
  {
    "text": "and if you're doing hyper parameter optimization on top of that you can actually bring it down even further so",
    "start": "2650330",
    "end": "2657320"
  },
  {
    "text": "you can say I want you to X the entire solution space here from as",
    "start": "2657320",
    "end": "2663790"
  },
  {
    "text": "many different from as many different",
    "start": "2663790",
    "end": "2669030"
  },
  {
    "text": "spaces as possible and I want you to run multiple jobs simultaneously and then any job that isn't converging",
    "start": "2669030",
    "end": "2675070"
  },
  {
    "text": "immediately if our parameters are too far out of bounds I want you to kill it off so this is what the the topology of",
    "start": "2675070",
    "end": "2680680"
  },
  {
    "start": "2678000",
    "end": "2804000"
  },
  {
    "text": "that resonant architecture looks like I know this needs no explanation right so",
    "start": "2680680",
    "end": "2686170"
  },
  {
    "text": "if you're seeing this and you're worried you're like machine learning is too complicated if I had seen this the first",
    "start": "2686170",
    "end": "2691390"
  },
  {
    "text": "time I had started doing machine learning I would have freaked out but",
    "start": "2691390",
    "end": "2696550"
  },
  {
    "text": "all you need to think about when you hear ResNet is it's just a convolutional neural network architecture that has",
    "start": "2696550",
    "end": "2704260"
  },
  {
    "text": "cheat codes built into it so those cheat codes say if the signal on one",
    "start": "2704260",
    "end": "2710170"
  },
  {
    "text": "particular section of this image is strong enough I actually want to skip a bunch of layers and go down to the next",
    "start": "2710170",
    "end": "2715240"
  },
  {
    "text": "layer where that signal corresponds to and that's a good way of thinking about",
    "start": "2715240",
    "end": "2720340"
  },
  {
    "text": "resonant so this is that that classification layer now this is taken from the planet paper and if I can just",
    "start": "2720340",
    "end": "2726910"
  },
  {
    "text": "show you this what's happening is oops is we're finding the locations where we",
    "start": "2726910",
    "end": "2734080"
  },
  {
    "text": "have more pictures so keeping my mistake you said that came from Flickr so places that have fast internet and places that",
    "start": "2734080",
    "end": "2740140"
  },
  {
    "text": "have ready your access to digital cameras and the ability to upload are",
    "start": "2740140",
    "end": "2746590"
  },
  {
    "text": "gonna have way way more data than places that don't so we don't even need to have",
    "start": "2746590",
    "end": "2754650"
  },
  {
    "text": "cells in some parts of the earth I'm sorry to see that Greenland's not included Greenland's very beautiful well",
    "start": "2754650",
    "end": "2761680"
  },
  {
    "text": "I mean it's okay and Iceland you can see is only a few cells and then if you get",
    "start": "2761680",
    "end": "2767890"
  },
  {
    "text": "into the South Pacific here there's just really in the Antarctic there's really just very few places to put this data so",
    "start": "2767890",
    "end": "2776200"
  },
  {
    "text": "the way that this is built is it uses a concept called Hilbert curve and this is a piece of fractal geometry that allows",
    "start": "2776200",
    "end": "2782950"
  },
  {
    "text": "you to take a two dimensional space and translate it into a one dimensional",
    "start": "2782950",
    "end": "2788170"
  },
  {
    "text": "space while preserving locality and this is just not that important it's just a way to think about",
    "start": "2788170",
    "end": "2794020"
  },
  {
    "text": "okay wherever we are on this line we know that the two points are close together if they're numerically close together and it allows us to densely",
    "start": "2794020",
    "end": "2800560"
  },
  {
    "text": "packed all of these different multi scale cell regions so there are pros and",
    "start": "2800560",
    "end": "2806860"
  },
  {
    "start": "2804000",
    "end": "2858000"
  },
  {
    "text": "cons to this approach the cons is that the performance for common objects things like McDonald signs or 7-eleven",
    "start": "2806860",
    "end": "2813160"
  },
  {
    "text": "signs is kind of poor and it's quite inaccurate in places that",
    "start": "2813160",
    "end": "2819010"
  },
  {
    "text": "have only one giant partition it's much more accurate in places with more",
    "start": "2819010",
    "end": "2824290"
  },
  {
    "text": "partitions which should be obvious from the architecture that we've described but the pros are spectacular it's less",
    "start": "2824290",
    "end": "2830770"
  },
  {
    "text": "than 300 megabytes it's got excellent excellent performance for unique objects and landmarks and it's quite fast in",
    "start": "2830770",
    "end": "2837880"
  },
  {
    "text": "terms of inferences so even on a t2 large which is a fairly small instance we can infer what exactly is happening",
    "start": "2837880",
    "end": "2844900"
  },
  {
    "text": "quite quickly so let's skip over a bunch of stuff here hop back to the code I",
    "start": "2844900",
    "end": "2851320"
  },
  {
    "text": "don't think we're gonna need the slides again I'll make them available though",
    "start": "2851320",
    "end": "2856349"
  },
  {
    "text": "and I'm just gonna show you what this flask app looks like so I'm just gonna",
    "start": "2857460",
    "end": "2863470"
  },
  {
    "start": "2858000",
    "end": "3353000"
  },
  {
    "text": "call this app dot pi and I'm gonna say you know import flask will say from",
    "start": "2863470",
    "end": "2868990"
  },
  {
    "text": "flask and pour requests and I'm gonna need JSON apply to JSON Fi and then app",
    "start": "2868990",
    "end": "2878260"
  },
  {
    "text": "equals flask flask what did we say we",
    "start": "2878260",
    "end": "2883720"
  },
  {
    "text": "were going to call this does anybody remember from the last session what we",
    "start": "2883720",
    "end": "2890850"
  },
  {
    "text": "were going to call this was it like innovate bot and so alley syrup please",
    "start": "2890850",
    "end": "2901600"
  },
  {
    "text": "ask how that specific visualization was made that was made using matplotlib if I",
    "start": "2901600",
    "end": "2910570"
  },
  {
    "text": "remember correctly in fact I think was made using a framework that's built on top of that pot lid called bouquet or",
    "start": "2910570",
    "end": "2916050"
  },
  {
    "text": "bokeh so there are only three things that we need to do in order to make the",
    "start": "2916050",
    "end": "2923560"
  },
  {
    "text": "sage maker bring your own algorithm work so the way this works is we say a Prout / ping and this ping",
    "start": "2923560",
    "end": "2935430"
  },
  {
    "text": "needs to do a health check on how our app is performing so we're gonna say",
    "start": "2935430",
    "end": "2942390"
  },
  {
    "text": "that our health is always great so we're going to return an empty 200 okay which",
    "start": "2942390",
    "end": "2947580"
  },
  {
    "text": "is the best health check in the world obviously the app is just fine sir si and then we're going to create another",
    "start": "2947580",
    "end": "2953070"
  },
  {
    "text": "app another route which is going to be slash in vacations methods equals host",
    "start": "2953070",
    "end": "2960360"
  },
  {
    "text": "so this is going to take a post request and then we're going to say invoke it's",
    "start": "2960360",
    "end": "2966390"
  },
  {
    "text": "gonna be the name of this method and we're going to grab our data request get",
    "start": "2966390",
    "end": "2972660"
  },
  {
    "text": "JSON and then we're gonna say whether or not it's JSON we we want to make sure",
    "start": "2972660",
    "end": "2977790"
  },
  {
    "text": "that we get this data because sometimes you can submit to an endpoint but you don't actually set the content type",
    "start": "2977790",
    "end": "2983970"
  },
  {
    "text": "header so a the the way that flask works is when it's trying to figure out whether or not a request is JSON it",
    "start": "2983970",
    "end": "2990210"
  },
  {
    "text": "looks at the content type header and it's not application slash JSON it's not gonna work it's just going to give up",
    "start": "2990210",
    "end": "2996150"
  },
  {
    "text": "and throw an error but we want to force it to make sure that it's JSON or fail so then we're gonna say predict oh and",
    "start": "2996150",
    "end": "3003530"
  },
  {
    "text": "I'm going to need to show you how the prediction works but basically we're gonna call out to the model I'm going to",
    "start": "3003530",
    "end": "3009260"
  },
  {
    "text": "say download and predict and we're gonna",
    "start": "3009260",
    "end": "3015770"
  },
  {
    "text": "grab the URL and we're gonna say integer data get max predictions if it's in",
    "start": "3015770",
    "end": "3025310"
  },
  {
    "text": "there or just you know three as the default if it's not in there and then if",
    "start": "3025310",
    "end": "3031640"
  },
  {
    "text": "data get yeah this doesn't really matter actually we don't need to do this part we can just return return JSON if I",
    "start": "3031640",
    "end": "3040720"
  },
  {
    "text": "result yeah so and then we just say so",
    "start": "3040720",
    "end": "3047270"
  },
  {
    "text": "that we can test this locally we just say if name equals main then one two",
    "start": "3047270",
    "end": "3057560"
  },
  {
    "text": "three four app run host equals and we're going to say zero",
    "start": "3057560",
    "end": "3063720"
  },
  {
    "text": "zero two zero so I don't have to tell it to talk to localhost will leave debug as",
    "start": "3063720",
    "end": "3069750"
  },
  {
    "text": "true for now and yes and we'll say the port is going to be equal to 80 80",
    "start": "3069750",
    "end": "3076080"
  },
  {
    "text": "because that is what sage maker is expecting this app to run so that is let's look again about 18 lines of code",
    "start": "3076080",
    "end": "3084750"
  },
  {
    "text": "and that is how we run our so 19 lines",
    "start": "3084750",
    "end": "3090120"
  },
  {
    "text": "of code that is how we run our entire little production endpoint and all the",
    "start": "3090120",
    "end": "3096810"
  },
  {
    "text": "cloud watch stuff all the good things that come in we'll just be brought in",
    "start": "3096810",
    "end": "3102300"
  },
  {
    "text": "for us so the next thing that we need to",
    "start": "3102300",
    "end": "3107640"
  },
  {
    "text": "do is we need to talk about how we actually run the prediction so rather",
    "start": "3107640",
    "end": "3114420"
  },
  {
    "text": "than recreating all of this since we've already done it in a previous session I'm just gonna load that one in and walk",
    "start": "3114420",
    "end": "3121260"
  },
  {
    "text": "you through it given the time constraint that we have and so we're gonna import",
    "start": "3121260",
    "end": "3127800"
  },
  {
    "text": "in patchy MX net and then CH maker will auto populate for me the model path and",
    "start": "3127800",
    "end": "3133830"
  },
  {
    "text": "the model name but just in case I wanted to run this locally let me see that -",
    "start": "3133830",
    "end": "3140250"
  },
  {
    "text": "Bob yeah okay so I do have this locally",
    "start": "3140250",
    "end": "3146550"
  },
  {
    "text": "as well just in case I wanted to run this locally I've pre-populated those values so what",
    "start": "3146550",
    "end": "3154260"
  },
  {
    "text": "we do is we load the model which is really just the combination of model path loss model name you know a more",
    "start": "3154260",
    "end": "3161280"
  },
  {
    "text": "correct way of doing this would really be OS path join but we don't we don't",
    "start": "3161280",
    "end": "3167370"
  },
  {
    "text": "need to worry about that right now and we're gonna load the 12th epoch of that model and we're gonna bind that model to",
    "start": "3167370",
    "end": "3173400"
  },
  {
    "text": "the CPU and we are going to basically",
    "start": "3173400",
    "end": "3179790"
  },
  {
    "text": "create a description of the data layer which is really just 224 pixels by 200",
    "start": "3179790",
    "end": "3186600"
  },
  {
    "text": "24 pixels RGB so that's this is just a description of the shape of the input",
    "start": "3186600",
    "end": "3192240"
  },
  {
    "text": "data [Music] and then we're gonna say for training is",
    "start": "3192240",
    "end": "3198690"
  },
  {
    "text": "gonna be false and then we set the parameters that we also loaded from those JSON files now this mean RGB",
    "start": "3198690",
    "end": "3207390"
  },
  {
    "text": "section is we're talking about what we're doing here is we're meaning we're meaning the image we're kind of bringing",
    "start": "3207390",
    "end": "3213780"
  },
  {
    "text": "the color value down to something that is less extreme because when we have",
    "start": "3213780",
    "end": "3219210"
  },
  {
    "text": "these outliers in our data it means any any image that's like all yellow is gonna get forced into one cell most",
    "start": "3219210",
    "end": "3225360"
  },
  {
    "text": "likely or any image that's all black is going to get forced into one cell by",
    "start": "3225360",
    "end": "3231559"
  },
  {
    "text": "mellowing out the colors and making the variance between them smaller we actually get better results in the long",
    "start": "3232370",
    "end": "3238380"
  },
  {
    "text": "run now there are ways of course to get",
    "start": "3238380",
    "end": "3244920"
  },
  {
    "text": "around that but this is this is an example of something I would call feature engineering where you're meaning the image and it's really common in",
    "start": "3244920",
    "end": "3251700"
  },
  {
    "text": "image classification frameworks so let me create a batch which is named tuple",
    "start": "3251700",
    "end": "3258120"
  },
  {
    "text": "and we load in this grids dot text file that grids dot text file is this thing so where were we",
    "start": "3258120",
    "end": "3265190"
  },
  {
    "text": "this is the grids text files it's just telling you where the different cells are so we load in that grid text file we",
    "start": "3265190",
    "end": "3275190"
  },
  {
    "text": "download the image and then we pre process the image it looks like this is doing a lot of complicated stuff",
    "start": "3275190",
    "end": "3280830"
  },
  {
    "text": "all it's doing is cropping the image and then adding in the mean then we call mod",
    "start": "3280830",
    "end": "3288540"
  },
  {
    "text": "dot forward so a mod if you guys don't remember is this section right here this was the module that we've created so",
    "start": "3288540",
    "end": "3295680"
  },
  {
    "text": "we're calling mobbed-up forward that means forward propagate the 224 pixels by 224 pixels that I have in my batch I",
    "start": "3295680",
    "end": "3303030"
  },
  {
    "text": "want you to push it through the network and I want you to tell me what the result is now the result of a resident",
    "start": "3303030",
    "end": "3308490"
  },
  {
    "text": "model is going to be whatever the size of your classification layer is so that classification layer that ResNet 101",
    "start": "3308490",
    "end": "3315590"
  },
  {
    "text": "classification layer is going to be fifteen thousand five hundred twenty seven different answers so what we're",
    "start": "3315590",
    "end": "3322560"
  },
  {
    "text": "going to do is we're gonna tell numpy to sort those answers by the probability",
    "start": "3322560",
    "end": "3328560"
  },
  {
    "text": "and then we're just going to return the top however many items we wanted to",
    "start": "3328560",
    "end": "3334770"
  },
  {
    "text": "return and then we have a couple of different useful methods and I added",
    "start": "3334770",
    "end": "3340470"
  },
  {
    "text": "this in wrench method a while back just to see if there was anything we could do to emoji fi the data or something like",
    "start": "3340470",
    "end": "3346349"
  },
  {
    "text": "that but there's no reason to do that so let's try to run this if someone has a",
    "start": "3346349",
    "end": "3355349"
  },
  {
    "text": "suggestion for an image that we could pass into this like what's a location in the world that you are interested in",
    "start": "3355349",
    "end": "3361230"
  },
  {
    "text": "submitting a request for anything at all",
    "start": "3361230",
    "end": "3368869"
  },
  {
    "text": "while I'm waiting for people to answer I'm just gonna import CH maker really fast sorry I'm employed photo 3 sage",
    "start": "3379980",
    "end": "3391600"
  },
  {
    "text": "maker equals photo 3 client sage maker and I'm gonna say do region name equals",
    "start": "3391600",
    "end": "3398320"
  },
  {
    "text": "u.s. west - and the - ACH maker handbook",
    "start": "3398320",
    "end": "3403900"
  },
  {
    "text": "and point sage maker invoke come on huh",
    "start": "3403900",
    "end": "3420210"
  },
  {
    "text": "normally this will give me the right thing know what's going on here come on",
    "start": "3424060",
    "end": "3440830"
  },
  {
    "text": "what even I have no idea why that's not tab completing but not to worry we can",
    "start": "3442150",
    "end": "3448520"
  },
  {
    "text": "just do this manually that invoke end",
    "start": "3448520",
    "end": "3456260"
  },
  {
    "text": "point and we'll just say and point end",
    "start": "3456260",
    "end": "3467450"
  },
  {
    "text": "point name and I saw somebody say that use the Taj Mahal so we're going to do that and I only have two minutes left",
    "start": "3467450",
    "end": "3473660"
  },
  {
    "text": "I'm going to do this really really quickly endpoint name is going to be predict what is the name of this endpoint v2 and the body is going to be",
    "start": "3473660",
    "end": "3484360"
  },
  {
    "text": "JSON string URL of whatever we can find",
    "start": "3484360",
    "end": "3494630"
  },
  {
    "text": "so I'm in a Google the Taj Mahal and I'm gonna just grab yeah unfortunately we",
    "start": "3494630",
    "end": "3502010"
  },
  {
    "text": "cannot allow people to post links I'm sorry about that but thank you I'm gonna",
    "start": "3502010",
    "end": "3507110"
  },
  {
    "text": "look for some images of the Taj Mahal and I'm just gonna submit those really fast so take this image address I think",
    "start": "3507110",
    "end": "3523970"
  },
  {
    "text": "this is the image so I'm gonna take that image and I'm gonna post it and we'll",
    "start": "3523970",
    "end": "3535070"
  },
  {
    "text": "see if we get a result something is very wrong with this haha Colonel I forgot",
    "start": "3535070",
    "end": "3546609"
  },
  {
    "text": "has no attribute invoke endpoint oh you",
    "start": "3547530",
    "end": "3552640"
  },
  {
    "text": "know what it is I need to do a CH maker at runtime or I think it might be run",
    "start": "3552640",
    "end": "3558370"
  },
  {
    "text": "time dot C so that was our HU and then",
    "start": "3558370",
    "end": "3568030"
  },
  {
    "text": "this is the request that we got back so I'm actually just gonna say that the response is equal to the last result",
    "start": "3568030",
    "end": "3573700"
  },
  {
    "text": "that we got and then if we look at response sorry body dot read we got back",
    "start": "3573700",
    "end": "3586780"
  },
  {
    "text": "the following URLs so I won't be able to read that again so why don't I just do",
    "start": "3586780",
    "end": "3594809"
  },
  {
    "text": "body sorry that read and I know Gabe is ready and trying to go but I just want",
    "start": "3595590",
    "end": "3602200"
  },
  {
    "text": "to see if we actually managed to get this the response right here so I'm going to say JSON the load s and let's",
    "start": "3602200",
    "end": "3614650"
  },
  {
    "text": "just throw this on Google Maps really fast and see what happens",
    "start": "3614650",
    "end": "3620460"
  },
  {
    "text": "those are the two responses that we got",
    "start": "3620460",
    "end": "3626849"
  },
  {
    "text": "so that looks pretty darn close to the",
    "start": "3635180",
    "end": "3640800"
  },
  {
    "text": "Taj Mahal to me looks about right so you",
    "start": "3640800",
    "end": "3647400"
  },
  {
    "text": "can see we could even pass in and we could say you know we actually want more predictions there's another building",
    "start": "3647400",
    "end": "3653400"
  },
  {
    "text": "actually in Delhi that looks not dissimilar to the Taj Mahal I mean it's a totally different building but it",
    "start": "3653400",
    "end": "3659280"
  },
  {
    "text": "doesn't look too different and I wonder if we went to Mac's predictions if it",
    "start": "3659280",
    "end": "3664290"
  },
  {
    "text": "might give us a location near Delhi so if I go to like 450 predictions we can",
    "start": "3664290",
    "end": "3672210"
  },
  {
    "text": "see how many predictions we'll get here and I'm sure one of these will be off by a bit so this one might be Delhi the 77",
    "start": "3672210",
    "end": "3685830"
  },
  {
    "text": "instead of yes the red fort all right I",
    "start": "3685830",
    "end": "3691440"
  },
  {
    "text": "think the red Ford is in Jaipur if I I mean I don't remember it's been a long time since I've been back there but this",
    "start": "3691440",
    "end": "3704850"
  },
  {
    "text": "is the red fort no I don't think it is so you can see that there's a you know",
    "start": "3704850",
    "end": "3711150"
  },
  {
    "text": "it's not perfect it's deep-learning it does the best it tries what it can do but thank you for that suggestion for",
    "start": "3711150",
    "end": "3716720"
  },
  {
    "text": "the Taj Mahal I think that was a cool unique kind of landmark with that said",
    "start": "3716720",
    "end": "3722370"
  },
  {
    "text": "we are out of time for today but I promise all the resources that you just saw are available for you so you don't",
    "start": "3722370",
    "end": "3730290"
  },
  {
    "text": "have to worry I'll make all of this code available I'll share with everybody but",
    "start": "3730290",
    "end": "3736410"
  },
  {
    "text": "if you stay tuned on twitch I'm gonna I'm gonna go offline in just a second but if you stay tuned my colleague Gabe",
    "start": "3736410",
    "end": "3743520"
  },
  {
    "text": "is gonna be up next talking about app sync and a couple of other things so I hope you'll stay tuned and able beyond",
    "start": "3743520",
    "end": "3749370"
  },
  {
    "text": "and maybe two or three minutes thank you all for joining I am gonna go grab some sleep because it's a 11 p.m. here in Los",
    "start": "3749370",
    "end": "3756270"
  },
  {
    "text": "Angeles good night everybody",
    "start": "3756270",
    "end": "3759470"
  }
]