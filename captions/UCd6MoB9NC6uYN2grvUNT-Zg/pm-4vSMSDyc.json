[
  {
    "text": "all right welcome everybody to reinvent I hope you have had a great day I thank",
    "start": "0",
    "end": "6569"
  },
  {
    "text": "you for walking over from the Venetian I know some of you are excited because you got your steps in so that's great",
    "start": "6569",
    "end": "14660"
  },
  {
    "text": "thank you for being here I hope you're excited about the upcoming week and the sessions that we have and to connect",
    "start": "14880",
    "end": "20970"
  },
  {
    "text": "with others who are using AWS I know I'm excited to connect with you over the next week so if I had to guess I would",
    "start": "20970",
    "end": "30090"
  },
  {
    "text": "say that most of you in the audience have written an ion policy and",
    "start": "30090",
    "end": "35390"
  },
  {
    "text": "as you move more of your workloads to AWS you will have more policies more",
    "start": "35390",
    "end": "42210"
  },
  {
    "text": "policies attached to users and more policies to grant access to your applications and as you get more of them",
    "start": "42210",
    "end": "50160"
  },
  {
    "text": "they're going to be harder to manage so you probably ask yourself the",
    "start": "50160",
    "end": "56820"
  },
  {
    "text": "question well who can actually do this powerful action who can delete instances",
    "start": "56820",
    "end": "62579"
  },
  {
    "text": "who can open up buckets and you'll want to know that answer and maybe you have",
    "start": "62579",
    "end": "68610"
  },
  {
    "text": "an Alice and Bob in your organization that are very trusted individuals they",
    "start": "68610",
    "end": "75210"
  },
  {
    "text": "they check their command triple check it they know exactly what they're running they know exactly what they're doing",
    "start": "75210",
    "end": "82460"
  },
  {
    "text": "then you may have a Casey Casey can be a little careless maybe he logs on to you",
    "start": "82460",
    "end": "90720"
  },
  {
    "text": "know the AWS console after a night out on the town playing blackjack and who knows wells and you want to make sure",
    "start": "90720",
    "end": "97619"
  },
  {
    "text": "Casey can't do anything that's too powerful ideally you would want a list that looks",
    "start": "97619",
    "end": "103860"
  },
  {
    "text": "like this a list of all your users your roles and are they compliant based on",
    "start": "103860",
    "end": "110420"
  },
  {
    "text": "parameters and rules that you set up for your organization so",
    "start": "110420",
    "end": "115640"
  },
  {
    "text": "if I do my job correctly today in the next 60 minutes you will know when and",
    "start": "115640",
    "end": "123000"
  },
  {
    "text": "why to validate your policies what makes sense and this could be customized for",
    "start": "123000",
    "end": "128220"
  },
  {
    "text": "your organization you'll learn the tools of available for your policy validation",
    "start": "128220",
    "end": "135140"
  },
  {
    "text": "we'll go through three common scenarios these are three scenarios that I've",
    "start": "135140",
    "end": "140220"
  },
  {
    "text": "heard from customers however I know there are a bunch more so I want you to be thinking about what you would",
    "start": "140220",
    "end": "145860"
  },
  {
    "text": "validate what you would go and check that you want to make sure people don't have too much access or on the flip side",
    "start": "145860",
    "end": "152099"
  },
  {
    "text": "something has the right amount of access to AWS resources and of course you all",
    "start": "152099",
    "end": "157530"
  },
  {
    "text": "love demos so we'll get a little bit nerdy up in here and we'll look at some code and we'll look at some demos using",
    "start": "157530",
    "end": "163620"
  },
  {
    "text": "config lambda S&S alright first a quick policy review it's",
    "start": "163620",
    "end": "171780"
  },
  {
    "text": "gonna be quick I do assume that you know what a policy is and that you've kind of",
    "start": "171780",
    "end": "177690"
  },
  {
    "text": "played around with it if not um you can take these this theory back and kind of",
    "start": "177690",
    "end": "183239"
  },
  {
    "text": "triple check on it so what is a policy a policy grants",
    "start": "183239",
    "end": "189510"
  },
  {
    "text": "access to your what a user can do and what resources they can do what",
    "start": "189510",
    "end": "196049"
  },
  {
    "text": "resources they can do on them in your AWS account it's access control they are",
    "start": "196049",
    "end": "201299"
  },
  {
    "text": "JSON formatted documents when I first took on this role my mother thought I had a new best friend named Jason turns",
    "start": "201299",
    "end": "208500"
  },
  {
    "text": "out that was not the case but if you look at the policy on the right you will see that this is a single statement it's",
    "start": "208500",
    "end": "215519"
  },
  {
    "text": "a simple allow it's allowing the action of s3 get so maybe get object and then",
    "start": "215519",
    "end": "221130"
  },
  {
    "text": "list list all my buckets those actions are allowed on all buckets resources",
    "start": "221130",
    "end": "226410"
  },
  {
    "text": "star so that's what a fairly simple policy looks like I want to call your attention",
    "start": "226410",
    "end": "233790"
  },
  {
    "text": "to two types of policies first we have the identity based",
    "start": "233790",
    "end": "239549"
  },
  {
    "text": "policies these policies are attached to your users groups and roles in your AWS",
    "start": "239549",
    "end": "246959"
  },
  {
    "text": "account this determines what the users can do on the flip side we have resource based",
    "start": "246959",
    "end": "254519"
  },
  {
    "text": "policies they are attached to the resource themselves if you've used s3",
    "start": "254519",
    "end": "261239"
  },
  {
    "text": "you may be familiar with an s3 bucket policy these resource-based policies are",
    "start": "261239",
    "end": "267440"
  },
  {
    "text": "there for specific use cases for example you can use an s3 bucket policy put",
    "start": "267440",
    "end": "273860"
  },
  {
    "text": "principle a star and open that policy up to the world make it public I want you to keep in",
    "start": "273860",
    "end": "281000"
  },
  {
    "text": "mind these two different types of policies because as we go down our path of validation we're gonna have to bring",
    "start": "281000",
    "end": "286880"
  },
  {
    "text": "them both into play all right policy structure very quickly",
    "start": "286880",
    "end": "295570"
  },
  {
    "text": "principle this is the entity that you are allowing or denying access to",
    "start": "295570",
    "end": "301270"
  },
  {
    "text": "keep in mind the principle element of a policy is only required for",
    "start": "301270",
    "end": "306710"
  },
  {
    "text": "identity-based or for resource based policies for identity based policies the",
    "start": "306710",
    "end": "312080"
  },
  {
    "text": "policy is attached to the principle and therefore you don't need to specify in the policy goes along with the principle",
    "start": "312080",
    "end": "318979"
  },
  {
    "text": "as it makes calls in AWS next we have the action this is the",
    "start": "318979",
    "end": "325190"
  },
  {
    "text": "service and the action that you are granting access to so this could be I am",
    "start": "325190",
    "end": "330800"
  },
  {
    "text": "as the service put user policy put role policy",
    "start": "330800",
    "end": "335830"
  },
  {
    "text": "whatever it is there are a lot of actions in AWS I'm sure you're all very",
    "start": "335830",
    "end": "341000"
  },
  {
    "text": "familiar with a very long list next is the resource which object are",
    "start": "341000",
    "end": "347479"
  },
  {
    "text": "you actually performing the action on so if you're performing get object in s3",
    "start": "347479",
    "end": "354310"
  },
  {
    "text": "then maybe you're performing on a specific bucket if you're putting a roll policy maybe you're put putting that on",
    "start": "354310",
    "end": "361580"
  },
  {
    "text": "a specific role and finally if you choose you can add a",
    "start": "361580",
    "end": "368090"
  },
  {
    "text": "condition so there are several conditions that you can add across all of our services and based on the",
    "start": "368090",
    "end": "374630"
  },
  {
    "text": "permission you have you can have a different condition so for example you may want to add a dish '''l",
    "start": "374630",
    "end": "381440"
  },
  {
    "text": "authentication for certain powerful action in AWS this is mfa you can make",
    "start": "381440",
    "end": "388070"
  },
  {
    "text": "sure it's required my team and i like to joke about other conditions we would ideally like to add one that we came up",
    "start": "388070",
    "end": "395720"
  },
  {
    "text": "with not too long ago was be really nice if we could you know set a condition on",
    "start": "395720",
    "end": "401120"
  },
  {
    "text": "you can't do this if you're above a certain pay grade nobody wants their VP making changes in AWS and my developers",
    "start": "401120",
    "end": "409280"
  },
  {
    "text": "would probably say they probably don't want the PM making it as well",
    "start": "409280",
    "end": "414940"
  },
  {
    "text": "okay scenarios when should you validate these policies",
    "start": "416380",
    "end": "421660"
  },
  {
    "text": "so turns out that there are some powerful actions in AWS and as you move",
    "start": "421660",
    "end": "429380"
  },
  {
    "text": "your critical workloads to the clouds and you run your business applications in AWS these actions become more and",
    "start": "429380",
    "end": "437420"
  },
  {
    "text": "more powerful three examples that come to mind first I am put user policy put role policy put",
    "start": "437420",
    "end": "445520"
  },
  {
    "text": "group policy this allows individuals or anybody with this permission the ability",
    "start": "445520",
    "end": "450770"
  },
  {
    "text": "to change other permissions this can be very powerful this can open up access",
    "start": "450770",
    "end": "456640"
  },
  {
    "text": "this can deny access so maybe you have an application running and some access",
    "start": "456640",
    "end": "462740"
  },
  {
    "text": "gets revoked that application may fail next s3 put bucket policy a lot of",
    "start": "462740",
    "end": "470390"
  },
  {
    "text": "people give s3 star it includes this permission this permission allows individuals to put a bucket policy on a",
    "start": "470390",
    "end": "477920"
  },
  {
    "text": "specific bucket they could enter the principle of star and your your bucket",
    "start": "477920",
    "end": "484610"
  },
  {
    "text": "would then be open to the world it would be public now if you have I don't know",
    "start": "484610",
    "end": "490600"
  },
  {
    "text": "all your great ideas in an s3 bucket probably don't want that to happen if",
    "start": "490600",
    "end": "495770"
  },
  {
    "text": "you have maybe HR data with Social Security numbers and how much people",
    "start": "495770",
    "end": "501230"
  },
  {
    "text": "make you probably don't want that to be open to the world so we're gonna check and make sure who can do that",
    "start": "501230",
    "end": "508060"
  },
  {
    "text": "next is kms decrypt this allows any individual with this permission to",
    "start": "508060",
    "end": "513890"
  },
  {
    "text": "decrypt a ciphertext so you want to make sure that only certain applications or",
    "start": "513890",
    "end": "520010"
  },
  {
    "text": "users can do that so in addition to some powerful actions",
    "start": "520010",
    "end": "525040"
  },
  {
    "text": "there's also critical resources your critical resources which are in a tub us",
    "start": "525040",
    "end": "530420"
  },
  {
    "text": "so I already talked about s3 buckets they have sensitive information",
    "start": "530420",
    "end": "536529"
  },
  {
    "text": "you can also have ec2 instances that runs up at a critical business",
    "start": "536589",
    "end": "542740"
  },
  {
    "text": "application think about I don't know maybe you have a couple instances that run payroll and",
    "start": "542740",
    "end": "551660"
  },
  {
    "text": "KC logs on after a long night out on Vegas and while he accidentally deletes",
    "start": "551660",
    "end": "558950"
  },
  {
    "text": "those instances probably not good I don't know about you but I like getting paid so let's make sure those",
    "start": "558950",
    "end": "565250"
  },
  {
    "text": "applications are up and running and I'm sure you can think of many more and I",
    "start": "565250",
    "end": "571490"
  },
  {
    "text": "want you to be thinking about this because the framework we're going to go through today can be customized to meet",
    "start": "571490",
    "end": "576740"
  },
  {
    "text": "your needs for your organization's I was talking to some people out in the audience and a lot of them are DevOps",
    "start": "576740",
    "end": "582380"
  },
  {
    "text": "security which is great because this what we're gonna go through you can modify it to whatever you need",
    "start": "582380",
    "end": "589450"
  },
  {
    "text": "these are the three scenarios that we're going to talk through today but these are only three I'm sure there are plenty",
    "start": "589450",
    "end": "596029"
  },
  {
    "text": "more so once again come up with ideas that meet your needs first we will",
    "start": "596029",
    "end": "601730"
  },
  {
    "text": "validate who can call powerful actions the powerful actions I mentioned in the",
    "start": "601730",
    "end": "606950"
  },
  {
    "text": "slide before I am put role policy s3 put bucket policy then we'll talk about who's allowed to",
    "start": "606950",
    "end": "614750"
  },
  {
    "text": "access a critical resource we're going to use an s3 bucket as an example it could be any resource and",
    "start": "614750",
    "end": "621760"
  },
  {
    "text": "finally I hear a lot from customers we only want to be able we only want our",
    "start": "621760",
    "end": "627050"
  },
  {
    "text": "developers to launch instances in a certain region and so we'll talk about how to validate making sure that nobody",
    "start": "627050",
    "end": "634399"
  },
  {
    "text": "can launch instances in a restricted region okay so now we have our scenarios we",
    "start": "634399",
    "end": "642440"
  },
  {
    "text": "know why we need to validate I know all of you have a lot of policies that you need to manage and it takes time and",
    "start": "642440",
    "end": "648440"
  },
  {
    "text": "effort so how do you actually validate well one option is you could potentially",
    "start": "648440",
    "end": "657200"
  },
  {
    "text": "speaking go to the console click on every single user click on every single",
    "start": "657200",
    "end": "663949"
  },
  {
    "text": "policy read them and manually parse them I would then call you a superhuman and I",
    "start": "663949",
    "end": "671209"
  },
  {
    "text": "don't want you to do that as the product manager for I am I don't want you to do that that's too much work for you please",
    "start": "671209",
    "end": "677959"
  },
  {
    "text": "don't do that so second option also manual option you could go to the policy",
    "start": "677959",
    "end": "685339"
  },
  {
    "text": "simulator nice and easy you select Casey you select okay identity and access",
    "start": "685339",
    "end": "691369"
  },
  {
    "text": "management you select the actions put role policy you say can Casey do this",
    "start": "691369",
    "end": "697490"
  },
  {
    "text": "all right I'm gonna run the simulation and yes Casey's allowed to do that I",
    "start": "697490",
    "end": "702529"
  },
  {
    "text": "should probably go and fix that still a lot of clicks like I'm still",
    "start": "702529",
    "end": "709339"
  },
  {
    "text": "clicking it's way too many I don't want you to have to do that many clicks",
    "start": "709339",
    "end": "714819"
  },
  {
    "text": "okay well you're in luck to api's for you to use this will help",
    "start": "714819",
    "end": "723230"
  },
  {
    "text": "you validate your policies first API simulate principal policy",
    "start": "723230",
    "end": "729999"
  },
  {
    "text": "pass in a policy a principal we're gonna pass in Casey pass in some action names",
    "start": "729999",
    "end": "735980"
  },
  {
    "text": "some resources maybe some contacts around when this situation would happen and you'll get an answer is Casey",
    "start": "735980",
    "end": "743420"
  },
  {
    "text": "allowed or denied next simulate custom policy two ways",
    "start": "743420",
    "end": "749569"
  },
  {
    "text": "that you can use this API one is you can actually simulate a",
    "start": "749569",
    "end": "754939"
  },
  {
    "text": "managed policy so a single policy that can be attached to multiple entities you",
    "start": "754939",
    "end": "760279"
  },
  {
    "text": "can pass that policy in and determine does this policy grant access to a",
    "start": "760279",
    "end": "766299"
  },
  {
    "text": "action or to a specific resource you can also use this before you attach",
    "start": "766299",
    "end": "773480"
  },
  {
    "text": "a policy to a user and determine what is this policy going to do",
    "start": "773480",
    "end": "778959"
  },
  {
    "text": "we're going to use both both of these api's today all right let's let's look at the inputs",
    "start": "778959",
    "end": "787459"
  },
  {
    "text": "and outputs so simulate principal policy this is the main one we're going to use in our solution the inputs that I want",
    "start": "787459",
    "end": "794179"
  },
  {
    "text": "to call your attention to first policy source arm this is basically the arne of",
    "start": "794179",
    "end": "801680"
  },
  {
    "text": "casey the username group or role that you want to stimulate it will go and fetch all the policies attached to casey",
    "start": "801680",
    "end": "808490"
  },
  {
    "text": "and use those policies for simulation arne is amazon resource name if you're",
    "start": "808490",
    "end": "814250"
  },
  {
    "text": "not familiar but i assume you all have written policies that have included lots of arms so next is policy input list if",
    "start": "814250",
    "end": "822350"
  },
  {
    "text": "you want to test additional policies you can do that action names this would be our IM put role policy resource aren't",
    "start": "822350",
    "end": "830180"
  },
  {
    "text": "star by default but you could pass in a specific aren't can casey put a policy",
    "start": "830180",
    "end": "835250"
  },
  {
    "text": "on a specific role and then the next one i want to call your attention to is the",
    "start": "835250",
    "end": "840710"
  },
  {
    "text": "context entries so if you've provided a condition remember I talked about the MFA condition or maybe you want to put a",
    "start": "840710",
    "end": "847820"
  },
  {
    "text": "condition on a region well you need to provide that context to the simulation alright so you've got all your",
    "start": "847820",
    "end": "854360"
  },
  {
    "text": "information and you pass it in to simulate principal policy now you get an",
    "start": "854360",
    "end": "859910"
  },
  {
    "text": "output so you'll get a list one per action that you pass in yes you can pass",
    "start": "859910",
    "end": "865070"
  },
  {
    "text": "in multiple actions and you'll get an answer back for each one you get three",
    "start": "865070",
    "end": "870680"
  },
  {
    "text": "options first is allowed this means somewhere in your AWS account you have",
    "start": "870680",
    "end": "877610"
  },
  {
    "text": "attached an allow policy or written an allow policy that grants Casey access to",
    "start": "877610",
    "end": "884270"
  },
  {
    "text": "I am put role policy next explicit deny this means that",
    "start": "884270",
    "end": "891380"
  },
  {
    "text": "somewhere in your account you have written a deny policy that denies Casey",
    "start": "891380",
    "end": "897110"
  },
  {
    "text": "access to put role policy or whatever you want to look at and finally implicit deny I",
    "start": "897110",
    "end": "904940"
  },
  {
    "text": "don't know if you're all aware you probably are but I am denies by default",
    "start": "904940",
    "end": "910370"
  },
  {
    "text": "that means that if there is no allow policy a user group or role will not",
    "start": "910370",
    "end": "915680"
  },
  {
    "text": "have any permissions so if that's the case of what you're simulating you'll get an implicit deny",
    "start": "915680",
    "end": "921820"
  },
  {
    "text": "alright let's take a look at what this looks like we're going to run this command",
    "start": "921820",
    "end": "927550"
  },
  {
    "text": "we have our user aren't Casey and we have our action powerful action put user",
    "start": "927550",
    "end": "933589"
  },
  {
    "text": "policy so I'm just gonna show you what you get back from the hopefully you all can see",
    "start": "933589",
    "end": "940910"
  },
  {
    "text": "that it's tiny so we'll run this command here I have",
    "start": "940910",
    "end": "947960"
  },
  {
    "text": "the CLI set up as a user who's allowed to and you can actually see hopefully",
    "start": "947960",
    "end": "954170"
  },
  {
    "text": "it's tiny I know that patrol policy is allowed on all",
    "start": "954170",
    "end": "959779"
  },
  {
    "text": "objects and oddly enough you actually get the policy that's granting this",
    "start": "959779",
    "end": "964790"
  },
  {
    "text": "access so if I were to go to Casey's user page I would actually see that I am",
    "start": "964790",
    "end": "970700"
  },
  {
    "text": "full access is allowed all right don't worry I'm not going to make you run all the commands on the",
    "start": "970700",
    "end": "976790"
  },
  {
    "text": "command line we're gonna talk about automation in a second okay next there we go",
    "start": "976790",
    "end": "985300"
  },
  {
    "text": "so as you can see I blew it up a little bit here to make it bigger for you it's",
    "start": "985300",
    "end": "990650"
  },
  {
    "text": "allowed and as winnie-the-pooh would say Oh bother we don't want Casey to be able to do that so we're gonna go and have to",
    "start": "990650",
    "end": "998690"
  },
  {
    "text": "fix that Casey is my brother by the way I like to make fun of him whenever I can and I do apologize this anybody in the",
    "start": "998690",
    "end": "1005800"
  },
  {
    "text": "audience is named Casey it's not a personal attack I promise alright so next one I just want to call",
    "start": "1005800",
    "end": "1013360"
  },
  {
    "text": "it one difference for custom policy instead of passing in a source arm so",
    "start": "1013360",
    "end": "1018850"
  },
  {
    "text": "before we passed in Casey we're just gonna pass in the policy document itself remember my friend JSON or JSON whatever",
    "start": "1018850",
    "end": "1026520"
  },
  {
    "text": "that's what we're gonna pass in in this instance so we'll go through both of those scenarios",
    "start": "1026520",
    "end": "1033600"
  },
  {
    "text": "alright quick recap before we get into the fun stuff so we had a quick policy refresher",
    "start": "1034679",
    "end": "1042178"
  },
  {
    "text": "hopefully many of you kind of got the gist of what you needed to know we went through our scenarios so",
    "start": "1042179",
    "end": "1050410"
  },
  {
    "text": "remember our powerful actions critical resources and restricted regions and",
    "start": "1050410",
    "end": "1056970"
  },
  {
    "text": "then had our policy simulator api's so i hope your brain is spinning right now",
    "start": "1056970",
    "end": "1063900"
  },
  {
    "text": "like okay i know what i need to test and i know the tools to be able to do it but",
    "start": "1063900",
    "end": "1069240"
  },
  {
    "text": "the question you should be asking yourself is how do we automate",
    "start": "1069240",
    "end": "1075169"
  },
  {
    "text": "well luckily enough for you ada or how do you get this list but",
    "start": "1075169",
    "end": "1083580"
  },
  {
    "text": "luckily enough for you AWS has services for automation so we're gonna pull in three services to",
    "start": "1083580",
    "end": "1089760"
  },
  {
    "text": "help us out everybody's favorite AWS lamda give a shout out and",
    "start": "1089760",
    "end": "1096559"
  },
  {
    "text": "wow that's um loose and then we'll we'll actually use config to trigger our",
    "start": "1096559",
    "end": "1102900"
  },
  {
    "text": "lambda functions config config rules basically any time something has changed",
    "start": "1102900",
    "end": "1108570"
  },
  {
    "text": "it will trigger a lambda and then SNS will notify you so if you're you know",
    "start": "1108570",
    "end": "1114990"
  },
  {
    "text": "maybe later tonight at the blackjack table even though you can't use your phone at a blackjack table and you get a",
    "start": "1114990",
    "end": "1121169"
  },
  {
    "text": "notification that says KC went from compliant to non-compliant maybe you",
    "start": "1121169",
    "end": "1126210"
  },
  {
    "text": "should go and fix that okay so how do these two",
    "start": "1126210",
    "end": "1132230"
  },
  {
    "text": "solutions for validation first is periodic audit I have heard use cases",
    "start": "1132230",
    "end": "1137790"
  },
  {
    "text": "where people just want to check every 24 hours every six hours once a week make",
    "start": "1137790",
    "end": "1143790"
  },
  {
    "text": "sure all the permissions are where they're supposed to be so that's one option the option we're going to go through today is based off of a",
    "start": "1143790",
    "end": "1150840"
  },
  {
    "text": "configuration change so when a policy is attached when a policy is modified when",
    "start": "1150840",
    "end": "1156360"
  },
  {
    "text": "a user is added or deleted it will trigger the lambda function that does all of our magic simulation and",
    "start": "1156360",
    "end": "1162780"
  },
  {
    "text": "validation here's how everything's going to talk",
    "start": "1162780",
    "end": "1169830"
  },
  {
    "text": "together first we'll have AWS config wolf",
    "start": "1169830",
    "end": "1177320"
  },
  {
    "text": "these rules will trigger lambda when something changes",
    "start": "1177320",
    "end": "1182450"
  },
  {
    "text": "so config talks to lambda lambda will have all of our magic and don't you",
    "start": "1182450",
    "end": "1188040"
  },
  {
    "text": "worry I'm going to show you the code we're gonna dive deep into it lambda does the magic it determines if a",
    "start": "1188040",
    "end": "1195250"
  },
  {
    "text": "resource is compliant or not based on your specifications coolest part about",
    "start": "1195250",
    "end": "1200440"
  },
  {
    "text": "this is number one you don't need a server you can just use lambda you don't",
    "start": "1200440",
    "end": "1206080"
  },
  {
    "text": "have to launch an ec2 instance I know the word server list is very popular at this conference and so we're gonna go",
    "start": "1206080",
    "end": "1214270"
  },
  {
    "text": "serverless into you can customize it to be anything that you need for your organization",
    "start": "1214270",
    "end": "1222150"
  },
  {
    "text": "so AWS will talk back to lambda or lambda",
    "start": "1222150",
    "end": "1228390"
  },
  {
    "text": "will talk back to config and set that's where you'll get that beautiful chart that we had before and",
    "start": "1228390",
    "end": "1235090"
  },
  {
    "text": "then config will talk to S&S and that's where you'll get an email notification when you're out tonight having some fun",
    "start": "1235090",
    "end": "1242500"
  },
  {
    "text": "in Vegas all right we have three scenarios we are",
    "start": "1242500",
    "end": "1250420"
  },
  {
    "text": "going to use three config rules to support them we will have one config",
    "start": "1250420",
    "end": "1256390"
  },
  {
    "text": "rule for powerful actions we'll have one config rule for critical resources and we will have one config role for",
    "start": "1256390",
    "end": "1264910"
  },
  {
    "text": "restricted regions to Matt those config rules we will also have",
    "start": "1264910",
    "end": "1271200"
  },
  {
    "text": "three lambda functions so it's a one-to-one mapping so one lambda function that will go in",
    "start": "1271200",
    "end": "1278440"
  },
  {
    "text": "and simulate all your powerful actions another lambda function that will go in and simulate does this person or entity",
    "start": "1278440",
    "end": "1285520"
  },
  {
    "text": "have access to critical resources and another one that talks about restricted",
    "start": "1285520",
    "end": "1290830"
  },
  {
    "text": "regions and then finally we'll have one SNS topic",
    "start": "1290830",
    "end": "1297370"
  },
  {
    "text": "that people that you can subscribe to and get your email notification that",
    "start": "1297370",
    "end": "1302880"
  },
  {
    "text": "KC is non-compliant anymore this is what the SNS notification looks",
    "start": "1302880",
    "end": "1310120"
  },
  {
    "text": "like pops up in your inbox it says oh look KC is now non-compliant that's not",
    "start": "1310120",
    "end": "1317650"
  },
  {
    "text": "good he used to be compliant so probably something you want to react",
    "start": "1317650",
    "end": "1323200"
  },
  {
    "text": "to okay let's dive into our lambda function",
    "start": "1323200",
    "end": "1329679"
  },
  {
    "text": "who's written the lambda function in the audience oh that's more like you see is a lot of",
    "start": "1329679",
    "end": "1335350"
  },
  {
    "text": "hands it's a lot of fun I had a lot of fun anyway all right so",
    "start": "1335350",
    "end": "1341610"
  },
  {
    "text": "here are the core elements of the lambda function first are the inputs",
    "start": "1341610",
    "end": "1347309"
  },
  {
    "text": "you need your iron resource is it a user is it a group is it a role then you need",
    "start": "1347309",
    "end": "1353649"
  },
  {
    "text": "the related resources if it happens to be an AWS manage policy then you need to",
    "start": "1353649",
    "end": "1360850"
  },
  {
    "text": "go and get all the related resources that means everything that's attached to it the users the groups and roles that",
    "start": "1360850",
    "end": "1367390"
  },
  {
    "text": "are attached to that policy and finally remember those resource based policies that we're talking about if you're",
    "start": "1367390",
    "end": "1374049"
  },
  {
    "text": "simulating access to a resource that has a resource based policy you'll need to",
    "start": "1374049",
    "end": "1380200"
  },
  {
    "text": "input that into the simulation as well next we'll do our validation this is",
    "start": "1380200",
    "end": "1385779"
  },
  {
    "text": "where those two wonderful api's come into play and then finally you'll have your outputs so that would be your iron",
    "start": "1385779",
    "end": "1392770"
  },
  {
    "text": "resource and then next is it compliant or not so that's high level let's go one",
    "start": "1392770",
    "end": "1398799"
  },
  {
    "text": "more level down what does the evaluation logic look like you're probably thinking well don't you",
    "start": "1398799",
    "end": "1404740"
  },
  {
    "text": "just simulate that could be true well let's get sophisticated if it is a user",
    "start": "1404740",
    "end": "1411850"
  },
  {
    "text": "or role a simple principle you simulate the principle and return back to config",
    "start": "1411850",
    "end": "1417250"
  },
  {
    "text": "no big deal if it is a group you can simulate the principle to determine if",
    "start": "1417250",
    "end": "1423190"
  },
  {
    "text": "the group has permission to powerful actions however when you change",
    "start": "1423190",
    "end": "1428679"
  },
  {
    "text": "permissions on a group you probably also know that you change permissions to any",
    "start": "1428679",
    "end": "1434169"
  },
  {
    "text": "user in that group so we'll get the user for in that group and we'll go back and",
    "start": "1434169",
    "end": "1439510"
  },
  {
    "text": "re simulate that all right next level man is policy we can simulate the policy",
    "start": "1439510",
    "end": "1448090"
  },
  {
    "text": "to determine is the policy compliant or not itself and send the result",
    "start": "1448090",
    "end": "1454840"
  },
  {
    "text": "but for each attached entity you have to go in back and simulate so if that",
    "start": "1454840",
    "end": "1460370"
  },
  {
    "text": "policy gets modified you have to go that's attached to your group then you go and you check the group same thing",
    "start": "1460370",
    "end": "1467810"
  },
  {
    "text": "with user or role alright so this is where we get into the",
    "start": "1467810",
    "end": "1474500"
  },
  {
    "text": "code so I'm going to give you a little nerd alert if you don't want to look at code then maybe you want to hop on AWS",
    "start": "1474500",
    "end": "1482090"
  },
  {
    "text": "play around tweet about how much money you want in blackjack last night I want",
    "start": "1482090",
    "end": "1487130"
  },
  {
    "text": "I lost $100 I won the night before though so I'm like really close um but",
    "start": "1487130",
    "end": "1493070"
  },
  {
    "text": "yes we're going into code first lambda function will spend the",
    "start": "1493070",
    "end": "1498860"
  },
  {
    "text": "most time on this one and then we'll demo because everybody loves demos",
    "start": "1498860",
    "end": "1505330"
  },
  {
    "text": "okay here are the inputs now I wrote this in Python I wanted to write it in",
    "start": "1505330",
    "end": "1511700"
  },
  {
    "text": "Perl just to make my developers angry but that didn't happen",
    "start": "1511700",
    "end": "1516820"
  },
  {
    "text": "everyone's like groaning like old Perl okay so here are the inputs first you",
    "start": "1516820",
    "end": "1523640"
  },
  {
    "text": "need your powerful actions so we're gonna call output role policy and put",
    "start": "1523640",
    "end": "1528740"
  },
  {
    "text": "bucket policy this list can be as long as you need it to be so whatever you",
    "start": "1528740",
    "end": "1534500"
  },
  {
    "text": "want to simulate you go simulate that access and here's everything that we",
    "start": "1534500",
    "end": "1539570"
  },
  {
    "text": "need for simulation all of our our resource names are Arne's",
    "start": "1539570",
    "end": "1545870"
  },
  {
    "text": "everything this will help with logging as well as putting back the information to config",
    "start": "1545870",
    "end": "1552460"
  },
  {
    "text": "all right simulate that's where we call our",
    "start": "1552460",
    "end": "1558140"
  },
  {
    "text": "function simulate principle policy as you notice we're passing in the policy",
    "start": "1558140",
    "end": "1563360"
  },
  {
    "text": "source arm the action names which are powerful actions and then we're leaving",
    "start": "1563360",
    "end": "1568730"
  },
  {
    "text": "the resource name the resource as default of start",
    "start": "1568730",
    "end": "1574150"
  },
  {
    "text": "when you get back the list will go through each list and we'll evaluate if",
    "start": "1574150",
    "end": "1579470"
  },
  {
    "text": "any of those actions are allowed we're gonna set a flag and that flag",
    "start": "1579470",
    "end": "1586000"
  },
  {
    "text": "will tell config if the resource is compliant or not and that's how you get",
    "start": "1586000",
    "end": "1591610"
  },
  {
    "text": "that beautiful chart that config has next one remember when I talked about",
    "start": "1591610",
    "end": "1597580"
  },
  {
    "text": "simulate custom policy and you have to get the policy well here it is for a",
    "start": "1597580",
    "end": "1603280"
  },
  {
    "text": "Manas policies you will go and get the policy Arn then you'll get the default",
    "start": "1603280",
    "end": "1609160"
  },
  {
    "text": "version which version is being used by the entities that are attached to it and then you'll get the policy document",
    "start": "1609160",
    "end": "1616690"
  },
  {
    "text": "itself that is what we will pass in to simulate custom policy this will determine if the",
    "start": "1616690",
    "end": "1624550"
  },
  {
    "text": "policy is compliant or not if it grants access to powerful actions",
    "start": "1624550",
    "end": "1630510"
  },
  {
    "text": "there's the call right there we pass in a policy document our best friend JSON",
    "start": "1630510",
    "end": "1636930"
  },
  {
    "text": "okay same evaluation logic at the end",
    "start": "1636930",
    "end": "1641880"
  },
  {
    "text": "same thing okay this is cool I didn't know this until I started writing this",
    "start": "1642300",
    "end": "1647770"
  },
  {
    "text": "but with config you can actually put",
    "start": "1647770",
    "end": "1652860"
  },
  {
    "text": "evaluations for more than the entity that it's validating so config triggers",
    "start": "1652860",
    "end": "1658570"
  },
  {
    "text": "off of a change to an entity well it turns out you can do whatever you want lambda and go check anything and put",
    "start": "1658570",
    "end": "1665800"
  },
  {
    "text": "evaluations to anything so in our man is policy case you can check the manage",
    "start": "1665800",
    "end": "1671410"
  },
  {
    "text": "policy send the evaluation back to config go check the user go check the",
    "start": "1671410",
    "end": "1676870"
  },
  {
    "text": "role check the group that it's attached to and send it back to config that's how",
    "start": "1676870",
    "end": "1681940"
  },
  {
    "text": "you do it you call config put evaluations so that's how we wrap everything up",
    "start": "1681940",
    "end": "1688200"
  },
  {
    "text": "all right we're about ready to demo but before we do that we need one more thing",
    "start": "1688200",
    "end": "1693420"
  },
  {
    "text": "I'm giving you all a hot second to think about what that one thing is oh",
    "start": "1693420",
    "end": "1698760"
  },
  {
    "text": "we have three support functions really quickly get users for group",
    "start": "1698760",
    "end": "1704340"
  },
  {
    "text": "simulate group and evaluate compliance I'm going to show you evaluate compliance in the lambda function itself",
    "start": "1704340",
    "end": "1710350"
  },
  {
    "text": "this actually just did all the coordination of all those yellow boxes that I showed with a bunch of arrows",
    "start": "1710350",
    "end": "1716110"
  },
  {
    "text": "before okay I gave you a hot minute to figure out",
    "start": "1716110",
    "end": "1721260"
  },
  {
    "text": "what you need and yes you need a role lamda needs a role to run so what permissions are we going to give that",
    "start": "1721260",
    "end": "1727680"
  },
  {
    "text": "role first we're gonna give lamda the ability to talk to config put",
    "start": "1727680",
    "end": "1734280"
  },
  {
    "text": "evaluations get could get resource config history all that next we're gonna",
    "start": "1734280",
    "end": "1739410"
  },
  {
    "text": "give lamda the ability to get I am information these are all essentially",
    "start": "1739410",
    "end": "1745290"
  },
  {
    "text": "read api's so get policy get policy version and simulate you cannot modify",
    "start": "1745290",
    "end": "1751530"
  },
  {
    "text": "anything with these api's lamda rights to cloud watch logs which is very",
    "start": "1751530",
    "end": "1756960"
  },
  {
    "text": "convenient for your logging and debugging if you happen to have to do that and finally we'll do s3 get bucket",
    "start": "1756960",
    "end": "1763830"
  },
  {
    "text": "policy this will help in our second use case all right who's ready to demo oh",
    "start": "1763830",
    "end": "1771260"
  },
  {
    "text": "man I heard some whoo all right okay so first thing I have the is I'm",
    "start": "1771260",
    "end": "1781170"
  },
  {
    "text": "gonna create that policy so I'm at the IM console everybody loves creating policies it's their favorite thing to do",
    "start": "1781170",
    "end": "1787730"
  },
  {
    "text": "so I create a policy and since we have the JSON syntax I'm just going to create",
    "start": "1787730",
    "end": "1794280"
  },
  {
    "text": "my own policy I will go and get I have made this easy",
    "start": "1794280",
    "end": "1799790"
  },
  {
    "text": "so I don't have to typo in front of all y'all to do this add a nice little",
    "start": "1799790",
    "end": "1807650"
  },
  {
    "text": "description here grants lamda access and then we'll copy our policies syntax and",
    "start": "1807650",
    "end": "1815490"
  },
  {
    "text": "I'll press this validate button I was telling one of my co-workers that I was doing a Apollo talk on validating",
    "start": "1815490",
    "end": "1822060"
  },
  {
    "text": "policies like don't you just press that button like oh dear but it's fine I do",
    "start": "1822060",
    "end": "1828270"
  },
  {
    "text": "great work okay so then we'll create the policy and we have it in our lists now",
    "start": "1828270",
    "end": "1837530"
  },
  {
    "text": "down here next we have the policies so next we're going to do the roll",
    "start": "1837530",
    "end": "1843440"
  },
  {
    "text": "we need a lambda roll so we're going to create a roll let me go back to my cheat sheet here so",
    "start": "1843440",
    "end": "1850380"
  },
  {
    "text": "I don't have to if I'm going too fast somebody just yell so give it a nice little roll name here",
    "start": "1850380",
    "end": "1857640"
  },
  {
    "text": "lambda policy validate next we want to pick a lambda role remember we don't need an ec2 server",
    "start": "1857640",
    "end": "1864000"
  },
  {
    "text": "server list so pick lambda and look we have our policy here that we're",
    "start": "1864000",
    "end": "1870029"
  },
  {
    "text": "gonna add to it okay and now we create the role",
    "start": "1870029",
    "end": "1876980"
  },
  {
    "text": "now we have the permissions that we need on our list can also look at my other",
    "start": "1876980",
    "end": "1882059"
  },
  {
    "text": "roles in my account next up you can see on our slide we're",
    "start": "1882059",
    "end": "1887730"
  },
  {
    "text": "going to create the lambda function I want to go through the lambda function before I create it this is the entire",
    "start": "1887730",
    "end": "1895350"
  },
  {
    "text": "doc this will be available to you off of a public s3 bucket and we will also be",
    "start": "1895350",
    "end": "1904320"
  },
  {
    "text": "trying to get it to you in other ways either through documentation or blog post and and these slides will be",
    "start": "1904320",
    "end": "1910529"
  },
  {
    "text": "available next week so don't worry we will get the code to you and",
    "start": "1910529",
    "end": "1915710"
  },
  {
    "text": "this evaluate evaluate compliance function this is everything that all",
    "start": "1915710",
    "end": "1921809"
  },
  {
    "text": "those yellow boxes we're talking about so you can actually see and I don't know if you can because it is pretty small but if it's a user role we simulate if",
    "start": "1921809",
    "end": "1929429"
  },
  {
    "text": "it's a group we simulate that and then actually go get the users and then for the policy we go through all the other",
    "start": "1929429",
    "end": "1936779"
  },
  {
    "text": "functions I showed to you on the presentation so I'm just gonna skip over that okay let's create our lambda",
    "start": "1936779",
    "end": "1943020"
  },
  {
    "text": "function so we're here at lambda we're going to create a function",
    "start": "1943020",
    "end": "1949070"
  },
  {
    "text": "we're gonna start with a blank function because we have all the code I'm going to hook up config later so I'm actually",
    "start": "1949070",
    "end": "1956820"
  },
  {
    "text": "going to start from the config side to call the lambda function not hook it up from here so I'll just do next give it a",
    "start": "1956820",
    "end": "1964470"
  },
  {
    "text": "nice little name here powerful actions I highly encourage you",
    "start": "1964470",
    "end": "1971000"
  },
  {
    "text": "used to do environment management name everything appropriate it just makes everybody's life easier",
    "start": "1971000",
    "end": "1977809"
  },
  {
    "text": "alright haha we'll pick Python pearls not available I",
    "start": "1977809",
    "end": "1984210"
  },
  {
    "text": "hear y'all laughing I used to I used to do pearl back on my",
    "start": "1984210",
    "end": "1989650"
  },
  {
    "text": "day yeah okay so I pasted the code in here",
    "start": "1989650",
    "end": "1997560"
  },
  {
    "text": "148 lines and you can modify this code you can add",
    "start": "1997560",
    "end": "2004410"
  },
  {
    "text": "actions you can add additional validation whatever you want to do alright remember we created that role oh",
    "start": "2004410",
    "end": "2012150"
  },
  {
    "text": "look it's in our drop-down that's convenient and then I'm just gonna increase the timeout to 30 seconds that",
    "start": "2012150",
    "end": "2019230"
  },
  {
    "text": "was based on some testing that was done okay so now we have our lambda function",
    "start": "2019230",
    "end": "2026130"
  },
  {
    "text": "do a quick review and we'll create the function you cannot run this function",
    "start": "2026130",
    "end": "2032480"
  },
  {
    "text": "without config so next we go to config I want to walk through config settings",
    "start": "2032480",
    "end": "2038820"
  },
  {
    "text": "first so when you go to config and you have not turned it on it will walk through how to turn it on you can do",
    "start": "2038820",
    "end": "2045840"
  },
  {
    "text": "that now if you so choose but one thing to call out for this use case in",
    "start": "2045840",
    "end": "2051270"
  },
  {
    "text": "particular is that you need to include global resources it is this checkbox",
    "start": "2051270",
    "end": "2056460"
  },
  {
    "text": "right here please don't forget that checkbox and then there's an s3 bucket",
    "start": "2056460",
    "end": "2061500"
  },
  {
    "text": "and then I have an SNS topic and it helps me create a role so I have one",
    "start": "2061500",
    "end": "2067620"
  },
  {
    "text": "role okay so that's it set up then you can go to rules I already have three set up but",
    "start": "2067620",
    "end": "2074190"
  },
  {
    "text": "we're gonna add a new rule and we're gonna add a custom rule",
    "start": "2074190",
    "end": "2079490"
  },
  {
    "text": "people thought I was crazy when I did this but no custom rule alright give it",
    "start": "2079490",
    "end": "2085260"
  },
  {
    "text": "a name powerful actions policy validation will",
    "start": "2085260",
    "end": "2090960"
  },
  {
    "text": "give it a nice little description determines which users groups roles and policies grant access to powerful",
    "start": "2090960",
    "end": "2097710"
  },
  {
    "text": "actions where do you get the lambda function Arne well right here it's on",
    "start": "2097710",
    "end": "2104430"
  },
  {
    "text": "the upper right hand corner it's also just an arn value with the",
    "start": "2104430",
    "end": "2110580"
  },
  {
    "text": "name of your function afterwards if you keep that handy alright we're gonna do this based off of",
    "start": "2110580",
    "end": "2116569"
  },
  {
    "text": "a configuration change this is my favorite part you can type in IM and",
    "start": "2116569",
    "end": "2121849"
  },
  {
    "text": "then just hit enter for group enter for Policy enter for wool and enter for user",
    "start": "2121849",
    "end": "2127039"
  },
  {
    "text": "fairly convenient Thank You user experience okay and we'll save once we",
    "start": "2127039",
    "end": "2134029"
  },
  {
    "text": "hit save it will start evaluating the resources as it's evaluating you can also go and",
    "start": "2134029",
    "end": "2141950"
  },
  {
    "text": "look at cloud watch and it the lambda function will write to cloud watch and",
    "start": "2141950",
    "end": "2147049"
  },
  {
    "text": "as you can see here it started AWS lambda and you can see that it's",
    "start": "2147049",
    "end": "2152750"
  },
  {
    "text": "actually running so we'll kind of poke through some of our logs and see if we",
    "start": "2152750",
    "end": "2158089"
  },
  {
    "text": "can find one that there you go restricted action put s3",
    "start": "2158089",
    "end": "2165950"
  },
  {
    "text": "bucket policy was granted to administrator Alice Bob Jeff those all",
    "start": "2165950",
    "end": "2171230"
  },
  {
    "text": "makes sense it was a group and three users in that group and as you can see here this is the email",
    "start": "2171230",
    "end": "2179180"
  },
  {
    "text": "account that I have hooked up to my SNS I'm getting notifications left and right about what's happening and so you can",
    "start": "2179180",
    "end": "2186170"
  },
  {
    "text": "see the non-compliant resources there there we go",
    "start": "2186170",
    "end": "2194109"
  },
  {
    "text": "all right so if we go back to config we",
    "start": "2195510",
    "end": "2200590"
  },
  {
    "text": "can click on this and it will actually give us a list of resources that it's working through and",
    "start": "2200590",
    "end": "2208440"
  },
  {
    "text": "we can see that administrator group I can let you know that Alice and Bob",
    "start": "2208440",
    "end": "2214120"
  },
  {
    "text": "actually are in the administrator group so that makes sense they are all non-compliant and then you can scroll",
    "start": "2214120",
    "end": "2220390"
  },
  {
    "text": "down your lesson see other policies in the account roles application security",
    "start": "2220390",
    "end": "2225940"
  },
  {
    "text": "role is also compliance as well alright so that's our first use case I",
    "start": "2225940",
    "end": "2233410"
  },
  {
    "text": "do want to call out that KC is not compliant and maybe we should",
    "start": "2233410",
    "end": "2239830"
  },
  {
    "text": "do something about that so we will trigger a change so I'm gonna go to KC",
    "start": "2239830",
    "end": "2245680"
  },
  {
    "text": "and figure out why that's not the case so here's Casey and",
    "start": "2245680",
    "end": "2252690"
  },
  {
    "text": "oh look Casey has I am full at access this was the same thing that our command",
    "start": "2252690",
    "end": "2259000"
  },
  {
    "text": "line told us we didn't change it then so I am actually going to remove this",
    "start": "2259000",
    "end": "2264730"
  },
  {
    "text": "policy I'll detach it from Casey I do not want Casey to have I am access and",
    "start": "2264730",
    "end": "2273270"
  },
  {
    "text": "config will pick up that change we'll check back on it later and hopefully you'll have and he will be compliant all",
    "start": "2273600",
    "end": "2281230"
  },
  {
    "text": "right so that's one use case we got two more",
    "start": "2281230",
    "end": "2288600"
  },
  {
    "text": "they'll go quick all right validate critical resources",
    "start": "2288600",
    "end": "2295320"
  },
  {
    "text": "so this is where you have to specify a resource so we have actions s3 get",
    "start": "2295320",
    "end": "2303010"
  },
  {
    "text": "object can Casey get objects from this bucket and then a bucket aren't those are the",
    "start": "2303010",
    "end": "2310330"
  },
  {
    "text": "resources we have to pass into our simulation everything else remains the same",
    "start": "2310330",
    "end": "2316020"
  },
  {
    "text": "remember when I talk about those resource based policies those bucket policies that I'm sure all of you",
    "start": "2316020",
    "end": "2322120"
  },
  {
    "text": "security folks out there have had you track down some sort of bucket policy we're going to grab it and then we're",
    "start": "2322120",
    "end": "2328920"
  },
  {
    "text": "gonna put it into simulate principle policy bucket policy",
    "start": "2328920",
    "end": "2335030"
  },
  {
    "text": "if the if there is a bucket policy we'll simulate it with a bucket policy and",
    "start": "2335030",
    "end": "2340350"
  },
  {
    "text": "we're also going to scope it down to the type of user roles gets a little bit",
    "start": "2340350",
    "end": "2346050"
  },
  {
    "text": "complicated with bucket policies because you have to filter out the assumed role and",
    "start": "2346050",
    "end": "2351860"
  },
  {
    "text": "so if it has a bucket policy we'll add it if you see the resource policy in there and then second we will if it",
    "start": "2351860",
    "end": "2359790"
  },
  {
    "text": "doesn't have a bucket policy we'll just simulate it with the bucket arm all right everything else remains the same",
    "start": "2359790",
    "end": "2366480"
  },
  {
    "text": "same thing with simulate policy we're going to get the policy with manage",
    "start": "2366480",
    "end": "2372240"
  },
  {
    "text": "policy because you're only testing that entity you will not simulate you will",
    "start": "2372240",
    "end": "2378060"
  },
  {
    "text": "not pass in a bucket policy that doesn't make sense both of these manage policies are",
    "start": "2378060",
    "end": "2383430"
  },
  {
    "text": "attached to entities and resource policies are attached to resources you're just simulating that one policy",
    "start": "2383430",
    "end": "2389040"
  },
  {
    "text": "so we just pass in our bucket arm same thing we'll run the simulation I",
    "start": "2389040",
    "end": "2394230"
  },
  {
    "text": "added one new support function get bucket policy I'll show it to you in a second all right let's demo this time we",
    "start": "2394230",
    "end": "2403260"
  },
  {
    "text": "don't have to create the role so it'll be a little faster let's just walk through the critical",
    "start": "2403260",
    "end": "2410490"
  },
  {
    "text": "resources lambda function here it's the same thing everything's coordinating if",
    "start": "2410490",
    "end": "2417180"
  },
  {
    "text": "it's a user if it's a role if it's a group it's all the same coordination the",
    "start": "2417180",
    "end": "2422460"
  },
  {
    "text": "only difference we have is this bucket policy if you're simulating a resource",
    "start": "2422460",
    "end": "2428010"
  },
  {
    "text": "that doesn't have a resource based policy you can just wipe all this clean and not worry about it",
    "start": "2428010",
    "end": "2434750"
  },
  {
    "text": "maybe an ec2 instance for example and then just down here I'll show you sorry",
    "start": "2434750",
    "end": "2441240"
  },
  {
    "text": "for my crazy scrolling and Buck get bucket policy we create an s3 client and",
    "start": "2441240",
    "end": "2448200"
  },
  {
    "text": "we call get bucket policy fairly straightforward all right so we're you're going to go",
    "start": "2448200",
    "end": "2455100"
  },
  {
    "text": "create another lambda function you all know how to do this now",
    "start": "2455100",
    "end": "2460200"
  },
  {
    "text": "here we go you should walk me through it will create a blank function once again",
    "start": "2460200",
    "end": "2467420"
  },
  {
    "text": "hookup config later alright here is let's get our name",
    "start": "2467420",
    "end": "2474950"
  },
  {
    "text": "in our nice little description it's every good DevOps person loves",
    "start": "2475339",
    "end": "2481140"
  },
  {
    "text": "descriptions ok Python again it's alright actually learned blank Python ok",
    "start": "2481140",
    "end": "2489200"
  },
  {
    "text": "there we go we already walked through oh look we use",
    "start": "2489200",
    "end": "2495000"
  },
  {
    "text": "the same role you can have an individual one per each if you choose add that to",
    "start": "2495000",
    "end": "2500309"
  },
  {
    "text": "30 seconds and then hit next",
    "start": "2500309",
    "end": "2504740"
  },
  {
    "text": "validate some stuff and create the function okay what's next I",
    "start": "2506119",
    "end": "2513470"
  },
  {
    "text": "heard config y'all need to be louder it's Vegas umm",
    "start": "2513500",
    "end": "2519589"
  },
  {
    "text": "alright so we'll go into rules we're gonna go add a rule",
    "start": "2519589",
    "end": "2526280"
  },
  {
    "text": "custom rule we will put in our name again",
    "start": "2526280",
    "end": "2533660"
  },
  {
    "text": "critical resources policy validation we'll put in our description",
    "start": "2533660",
    "end": "2540740"
  },
  {
    "text": "lambda function we need the iron upper right hand corner don't forget it",
    "start": "2541520",
    "end": "2548088"
  },
  {
    "text": "there you go and we'll do config change again and I'm",
    "start": "2549380",
    "end": "2555119"
  },
  {
    "text": "gonna do all the IM resources if you only care about roles or users you don't have to do all of them I would recommend",
    "start": "2555119",
    "end": "2561869"
  },
  {
    "text": "that you do do policies and we'll click Save and it will begin evaluating",
    "start": "2561869",
    "end": "2569240"
  },
  {
    "text": "ok once again we can go look at cloud watch but you all know the drill and we'll also get it from there um so when",
    "start": "2569839",
    "end": "2579059"
  },
  {
    "text": "it goes and evaluates let's see if it has gone through Casey yet",
    "start": "2579059",
    "end": "2584599"
  },
  {
    "text": "its evaluating currently there we go",
    "start": "2584599",
    "end": "2590720"
  },
  {
    "text": "need some time obviously let's see if Casey changed yet",
    "start": "2592340",
    "end": "2600559"
  },
  {
    "text": "Casey is still non-compliant I'll have to keep looking at that one oh",
    "start": "2600950",
    "end": "2606890"
  },
  {
    "text": "right no look here we go",
    "start": "2606890",
    "end": "2611990"
  },
  {
    "text": "critical resources 10 non-compliant so I don't know if you noticed before",
    "start": "2611990",
    "end": "2619320"
  },
  {
    "text": "but when I looked at Casey I gave chase the s3 full access",
    "start": "2619320",
    "end": "2624380"
  },
  {
    "text": "well that's interesting because Casey is marked as compliant if you look in my",
    "start": "2624380",
    "end": "2630720"
  },
  {
    "text": "config I'm going a little rogue here let's go down to Casey oh",
    "start": "2630720",
    "end": "2636710"
  },
  {
    "text": "there's Casey Casey's compliant when we're looking at critical resources well",
    "start": "2638780",
    "end": "2644310"
  },
  {
    "text": "turns out there's a bucket policy that denies Casey access we really don't want",
    "start": "2644310",
    "end": "2651060"
  },
  {
    "text": "Casey getting in the HR bucket especially since Casey likes to go out in Vegas so that brought those two together those",
    "start": "2651060",
    "end": "2659220"
  },
  {
    "text": "two policies work together to control access to an ID to somebody and so",
    "start": "2659220",
    "end": "2665060"
  },
  {
    "text": "Casey's actually compliant because somebody very smart someone put a bucket policy on our HR bucket Casey cannot",
    "start": "2665060",
    "end": "2673440"
  },
  {
    "text": "find out my salary that's nice all right one more left",
    "start": "2673440",
    "end": "2681920"
  },
  {
    "text": "restricted regions so I am allowing developers to",
    "start": "2683990",
    "end": "2691220"
  },
  {
    "text": "launch instances in ec2 I'm restricting it to the west west coast",
    "start": "2691220",
    "end": "2698460"
  },
  {
    "text": "best coasts anybody yeah yeah oh yeah I see some hands I grew up on the East Coast but that's fine I love the west",
    "start": "2698460",
    "end": "2704880"
  },
  {
    "text": "coast all right so this is the policy that allows people to describe the instances and only launch instances on",
    "start": "2704880",
    "end": "2711480"
  },
  {
    "text": "in using us less one or us West - I also granted access to pass wall this is for",
    "start": "2711480",
    "end": "2719520"
  },
  {
    "text": "our mobile app and then finally to lift the roll that you can use when you're",
    "start": "2719520",
    "end": "2725400"
  },
  {
    "text": "walking through the console all right that's one thing let's look at the code",
    "start": "2725400",
    "end": "2730859"
  },
  {
    "text": "those Oh keep in mind context key and value context key is on the left the",
    "start": "2730859",
    "end": "2737249"
  },
  {
    "text": "value is on the right you need this information when you pass it in to the simulator here",
    "start": "2737249",
    "end": "2743960"
  },
  {
    "text": "we go action run instances context key name is ec2 region the values that we",
    "start": "2743960",
    "end": "2751979"
  },
  {
    "text": "are going to say we don't want people is the east coast I apologize anybody who's",
    "start": "2751979",
    "end": "2757229"
  },
  {
    "text": "from the East Coast love it great bagels but we don't want people launching instances there this list can be however",
    "start": "2757229",
    "end": "2764460"
  },
  {
    "text": "many that you want it to be",
    "start": "2764460",
    "end": "2767930"
  },
  {
    "text": "next all we have to do is for each context so we're actually going to simulate per context key value",
    "start": "2769549",
    "end": "2778460"
  },
  {
    "text": "and if any one are true then we will say that it's non-compliant so you can see",
    "start": "2778460",
    "end": "2785279"
  },
  {
    "text": "my four statement at the above this and then for each context key value will",
    "start": "2785279",
    "end": "2790319"
  },
  {
    "text": "create a context and pass it in to simulate principal policy everything else remains the same policy",
    "start": "2790319",
    "end": "2798210"
  },
  {
    "text": "is the same thing simulate principal policy make the context call simulate",
    "start": "2798210",
    "end": "2804059"
  },
  {
    "text": "custom policy and all the evaluation logic stays the same",
    "start": "2804059",
    "end": "2809640"
  },
  {
    "text": "oh got a demo first so one more",
    "start": "2809640",
    "end": "2816710"
  },
  {
    "text": "and then we'll go back and look at did Casey get updated all right we're gonna",
    "start": "2818150",
    "end": "2824400"
  },
  {
    "text": "create lambda function here we go last one",
    "start": "2824400",
    "end": "2830150"
  },
  {
    "text": "I'm not gonna go through this because the only thing that changed was the",
    "start": "2830150",
    "end": "2835229"
  },
  {
    "text": "context which we walk through in the slide everything else remains the same",
    "start": "2835229",
    "end": "2840739"
  },
  {
    "text": "just calling out if you have a condition your policy you have to pass in these contexts ok here we go we are going to",
    "start": "2841279",
    "end": "2850440"
  },
  {
    "text": "create a blank function next I'm going to go quicker because you seen this",
    "start": "2850440",
    "end": "2855860"
  },
  {
    "text": "twice here we go validation",
    "start": "2855860",
    "end": "2861070"
  },
  {
    "text": "[Music] nice little description Python will get this",
    "start": "2861070",
    "end": "2869320"
  },
  {
    "text": "doop-doop this one's I 159 lines so use our",
    "start": "2869320",
    "end": "2877670"
  },
  {
    "text": "existing role which we so gracefully granted permissions to and then we'll hit next",
    "start": "2877670",
    "end": "2885970"
  },
  {
    "text": "alright validate and create the function you all know what's up next we're going",
    "start": "2885970",
    "end": "2893540"
  },
  {
    "text": "to create a config rule to do",
    "start": "2893540",
    "end": "2898550"
  },
  {
    "text": "[Music] add a rule add a custom rule",
    "start": "2898550",
    "end": "2905619"
  },
  {
    "text": "give it a name here",
    "start": "2905770",
    "end": "2909850"
  },
  {
    "text": "there we go give a little cheat sheets getting",
    "start": "2911170",
    "end": "2916690"
  },
  {
    "text": "to the end here we go alright description are in value up right corner",
    "start": "2916690",
    "end": "2924820"
  },
  {
    "text": "you can also generate these if you're doing all this programmatically",
    "start": "2924820",
    "end": "2929950"
  },
  {
    "text": "we're gonna do it based off of a configuration change so it'll always be looking at our account I am group all",
    "start": "2929950",
    "end": "2935810"
  },
  {
    "text": "group policy role user and done",
    "start": "2935810",
    "end": "2941800"
  },
  {
    "text": "so it'll start evaluating as well once again we can go to cloud watch and",
    "start": "2941800",
    "end": "2947990"
  },
  {
    "text": "look at that I did want to see if I can show you all the bucket policy oops go",
    "start": "2947990",
    "end": "2953270"
  },
  {
    "text": "to logs here hmm this might be takeaway ah so you can",
    "start": "2953270",
    "end": "2961460"
  },
  {
    "text": "see on our last one with critical resources the bucket policy actually popped up because we went and got it and",
    "start": "2961460",
    "end": "2966980"
  },
  {
    "text": "it did go into the evaluation all right let's see if Casey's powerful",
    "start": "2966980",
    "end": "2974390"
  },
  {
    "text": "actions have changed oh he's still not compliant have to wait",
    "start": "2974390",
    "end": "2982220"
  },
  {
    "text": "for that you can actually reevaluate if you need to all right and we'll go through the rules",
    "start": "2982220",
    "end": "2991510"
  },
  {
    "text": "here ec2 policy validation and we'll see who's",
    "start": "2992020",
    "end": "2997910"
  },
  {
    "text": "there and who's compliant and who's not um kind of interesting to actually look at",
    "start": "2997910",
    "end": "3003640"
  },
  {
    "text": "a policy with this one see if it pops up here in a second there is a policy that",
    "start": "3003640",
    "end": "3010980"
  },
  {
    "text": "grants access the one I showed you ec2 run West it's compliant because it",
    "start": "3010980",
    "end": "3018430"
  },
  {
    "text": "didn't give it access to the east alright so we have everything running",
    "start": "3018430",
    "end": "3023820"
  },
  {
    "text": "you'll get notification if anything changes so let's do a little recap",
    "start": "3023820",
    "end": "3030990"
  },
  {
    "text": "so we checked multiple powerful actions we checked actions on a critical",
    "start": "3030990",
    "end": "3037180"
  },
  {
    "text": "resource so this could be a bucket this could be an instance it could be a glacier vault whatever you deem as",
    "start": "3037180",
    "end": "3042750"
  },
  {
    "text": "critical and then we checked actions with context keys so if you have",
    "start": "3042750",
    "end": "3048010"
  },
  {
    "text": "policies with conditions this is what you'll need to put into action what else is possible you probably all",
    "start": "3048010",
    "end": "3056320"
  },
  {
    "text": "are already thinking of ideas you're very smart so you could just change it not to be a configuration change but to",
    "start": "3056320",
    "end": "3062920"
  },
  {
    "text": "run every 24 hours you can invoke a reactive action if something is",
    "start": "3062920",
    "end": "3070210"
  },
  {
    "text": "non-compliant maybe you know that Casey doesn't want or need certain access slap",
    "start": "3070210",
    "end": "3076060"
  },
  {
    "text": "a deny policy on there when he goes non-compliant for some reason or delete",
    "start": "3076060",
    "end": "3081490"
  },
  {
    "text": "a user that you don't think needs to be there you can make any action the lambda function is yours to customize you can",
    "start": "3081490",
    "end": "3089320"
  },
  {
    "text": "include a whitelist of entities that you deem trusted so the Alice and Bob in",
    "start": "3089320",
    "end": "3095110"
  },
  {
    "text": "your application you can include them in that list maybe use a dynamo table to",
    "start": "3095110",
    "end": "3100120"
  },
  {
    "text": "read from it and finally you can parse your policies so if you want to make sure certain key is",
    "start": "3100120",
    "end": "3106390"
  },
  {
    "text": "included if you want to make sure certain bucket is included go ahead and parse the policies",
    "start": "3106390",
    "end": "3112920"
  },
  {
    "text": "I'll be at the security booth tomorrow come stop by share your ideas talk about",
    "start": "3112920",
    "end": "3119279"
  },
  {
    "text": "him I would love to hear them it's always interesting to see what customers come up with all right couple more",
    "start": "3119279",
    "end": "3125759"
  },
  {
    "text": "things before I let you go additional resources to things that help",
    "start": "3125759",
    "end": "3131489"
  },
  {
    "text": "that helped me in the config documentation when I was going through this the",
    "start": "3131489",
    "end": "3136549"
  },
  {
    "text": "supported resources the configuration items and relationships that config works off of very helpful and the",
    "start": "3136549",
    "end": "3143939"
  },
  {
    "text": "configuration item is all the inputs that config gives to lambda so if you need more information you can get it",
    "start": "3143939",
    "end": "3149699"
  },
  {
    "text": "from config you can also call the api's themselves and I know most of you run",
    "start": "3149699",
    "end": "3156299"
  },
  {
    "text": "more than one account so you probably want to know how to centrally manage your config roles I would definitely",
    "start": "3156299",
    "end": "3163679"
  },
  {
    "text": "take a look at this blog post it was written by one of my amazing co-workers and this will help you if you're talking",
    "start": "3163679",
    "end": "3169410"
  },
  {
    "text": "about multiple accounts because I know it's a very common use case you may want to get the code so I'm",
    "start": "3169410",
    "end": "3178109"
  },
  {
    "text": "going to leave this up here these slides will be available",
    "start": "3178109",
    "end": "3183140"
  },
  {
    "text": "yes please take a picture that's the best idea I'm like what are they gonna write them down on",
    "start": "3183140",
    "end": "3189559"
  },
  {
    "text": "these slides will be available next week they will be hyperlinks you'll be able to get them however if you want them now",
    "start": "3189559",
    "end": "3196079"
  },
  {
    "text": "maybe instead of going to play blackjack you've decided to go and write some lambda functions you can do that tonight",
    "start": "3196079",
    "end": "3202650"
  },
  {
    "text": "instead that would be fun",
    "start": "3202650",
    "end": "3206209"
  },
  {
    "text": "all right I'm like seeing like three more cameras go up",
    "start": "3209569",
    "end": "3215359"
  },
  {
    "text": "somebody can post it on Twitter all right and finally thank you thank you",
    "start": "3215359",
    "end": "3222329"
  },
  {
    "text": "for your time thank you for coming to reinvent thank you for using AWS I",
    "start": "3222329",
    "end": "3227429"
  },
  {
    "text": "really appreciate it all of us do and I hope you enjoy yourself this next week",
    "start": "3227429",
    "end": "3232819"
  },
  {
    "text": "one last thing please remember to complete your evaluations it's how we improve it's how we know what to share",
    "start": "3232819",
    "end": "3239910"
  },
  {
    "text": "with you what to talk to you about it's how we get better so please please please do your evaluations thank you",
    "start": "3239910",
    "end": "3247330"
  },
  {
    "text": "[Applause]",
    "start": "3247330",
    "end": "3253480"
  }
]