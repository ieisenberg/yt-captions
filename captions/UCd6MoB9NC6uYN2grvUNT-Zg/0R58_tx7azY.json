[
  {
    "text": "alright I'm excited to be here at reinvent by show of hands how many of",
    "start": "30",
    "end": "6330"
  },
  {
    "text": "you are Netflix members alright awesome so yes I know so how much time do you",
    "start": "6330",
    "end": "15719"
  },
  {
    "text": "think we have to hold your attention before you choose something to play on a",
    "start": "15719",
    "end": "20789"
  },
  {
    "text": "Netflix app it says the time it takes for you to sort of decide what you want to play while you're browsing through",
    "start": "20789",
    "end": "26250"
  },
  {
    "text": "our homepage any guesses 90 seconds to hours to seconds for hours",
    "start": "26250",
    "end": "35989"
  },
  {
    "text": "our data shows that the typical Netflix member has about a minute or so before",
    "start": "35989",
    "end": "42719"
  },
  {
    "text": "they decide whether they want to watch something or they go off the service and in that little time if we are not able",
    "start": "42719",
    "end": "51210"
  },
  {
    "text": "to present to you the most appealing most personalized content then they've",
    "start": "51210",
    "end": "56610"
  },
  {
    "text": "lost what we essentially call a moment of joy so this is a recent version of",
    "start": "56610",
    "end": "66270"
  },
  {
    "text": "our current homepage everything you see on this page is highly personalized",
    "start": "66270",
    "end": "72560"
  },
  {
    "text": "starting with the top image on the top that we call billboard stranger things fans anyone yes there's one who there",
    "start": "72560",
    "end": "80750"
  },
  {
    "text": "too the the relevancy ranking of all the content that we that we rank for you the",
    "start": "80750",
    "end": "88380"
  },
  {
    "text": "evidence that we present to tell you why we are ranking those rows the order in",
    "start": "88380",
    "end": "94920"
  },
  {
    "text": "which various rows present themselves for you and even the title imagery that",
    "start": "94920",
    "end": "101100"
  },
  {
    "text": "we show to represent a particular title every one of that those treatment is",
    "start": "101100",
    "end": "106890"
  },
  {
    "text": "essentially personalized for each member profile and all of these treatments are",
    "start": "106890",
    "end": "112680"
  },
  {
    "text": "running on top of a machine learned algorithm our goal in the",
    "start": "112680",
    "end": "117899"
  },
  {
    "text": "recommendations and ever at Netflix is to really help you discover awesome content that you can maximize your joy",
    "start": "117899",
    "end": "125369"
  },
  {
    "text": "of it and be satisfied with the Netflix service ok so my name is vessel CDP and",
    "start": "125369",
    "end": "131970"
  },
  {
    "text": "along with my colleagues David Shepherd and you sipar today we'll be talking about how we're helping build a system for",
    "start": "131970",
    "end": "138690"
  },
  {
    "text": "orchestrating machine learned by clients for Netflix recommendations just a couple of points floristic s-- there's",
    "start": "138690",
    "end": "145500"
  },
  {
    "text": "there's a mic down there so we'll take questions at the end you can line up once once the talks are done I'll be",
    "start": "145500",
    "end": "152040"
  },
  {
    "text": "happy to chat about them also at 1:00 p.m. we'll be at the Netflix booth at",
    "start": "152040",
    "end": "159450"
  },
  {
    "text": "booth 136 on the expo floor so feel free to drop by if you have more questions or if you just want to learn about what we",
    "start": "159450",
    "end": "166230"
  },
  {
    "text": "do outside of this particular talk so let me set up a little bit of an agenda",
    "start": "166230",
    "end": "171450"
  },
  {
    "text": "for how we're going to be presenting this session today so forth the initial part I will set up a",
    "start": "171450",
    "end": "176880"
  },
  {
    "text": "recommendation context for you so this will tell you what do I mean by recommender system really basic stuff",
    "start": "176880",
    "end": "182430"
  },
  {
    "text": "you probably know about it but just to get a good primer on that then we'll go into providing overview of Masson which",
    "start": "182430",
    "end": "189630"
  },
  {
    "text": "is the solution that we've essentially built in-house for for solving some of these challenges I'll talk a little bit",
    "start": "189630",
    "end": "196590"
  },
  {
    "text": "about some examples of ML training pipelines and how Mason is helping them and then we'll move into sort of our",
    "start": "196590",
    "end": "203570"
  },
  {
    "text": "second phase of the talk where Davis and Eugene will share our experiences and",
    "start": "203570",
    "end": "209610"
  },
  {
    "text": "our learnings while building Mason and our hope is that some of these things would be useful developer tips for you",
    "start": "209610",
    "end": "216420"
  },
  {
    "text": "guys to take to your own projects all right the quality of any machine",
    "start": "216420",
    "end": "224280"
  },
  {
    "text": "learning system is really dependent upon how good and how rich data set you can",
    "start": "224280",
    "end": "230220"
  },
  {
    "text": "provide it we're fortunate enough that we own the stack end-to-end and so we have very good rich streaming data set",
    "start": "230220",
    "end": "238650"
  },
  {
    "text": "coming from all the user interactions that you guys are having so plays and impressions and user activities like",
    "start": "238650",
    "end": "244440"
  },
  {
    "text": "things that you're adding to your my list or things that you are exploring details about all of that is is sort of",
    "start": "244440",
    "end": "251850"
  },
  {
    "text": "the starting point off of the recommendation systems now we feed that",
    "start": "251850",
    "end": "256950"
  },
  {
    "text": "into a training pipeline and I will delve a little bit deeper into that in a later part of the talk and once the",
    "start": "256950",
    "end": "263850"
  },
  {
    "text": "training pipeline has generated years of models we use those models to",
    "start": "263850",
    "end": "269070"
  },
  {
    "text": "essentially create recommendations for each profile and we use a variety of",
    "start": "269070",
    "end": "274800"
  },
  {
    "text": "different models depending upon the use case now once we have this set up this",
    "start": "274800",
    "end": "280520"
  },
  {
    "text": "needs to be able to serve at the scale of Netflix which means we have more than",
    "start": "280520",
    "end": "286229"
  },
  {
    "text": "you know 108 million users out there and we really want to make sure that we have",
    "start": "286229",
    "end": "291630"
  },
  {
    "text": "you have a seamless experience when you when you go to the website and when you hit play so we have built a fairly",
    "start": "291630",
    "end": "298199"
  },
  {
    "text": "advanced infrastructure on doing a bunch of this work that can be offloaded and",
    "start": "298199",
    "end": "303630"
  },
  {
    "text": "we batch computed into a pre compute system and then we store the results into online caches and those caches are",
    "start": "303630",
    "end": "310889"
  },
  {
    "text": "essentially serving and building up that homepage now as you would probably imagine not everything can be pre",
    "start": "310889",
    "end": "316830"
  },
  {
    "text": "computed there's temporally sensitive context like the trending now ro and others that do need to be live computed",
    "start": "316830",
    "end": "324030"
  },
  {
    "text": "but this is sort of a general fallback option for all other cases we're not",
    "start": "324030",
    "end": "330630"
  },
  {
    "text": "quite done yet this is sort of one way of feeding one particular treatment that",
    "start": "330630",
    "end": "337440"
  },
  {
    "text": "I talked about but everything that we do at Netflix broadly speaking but even within our recommendation context we're",
    "start": "337440",
    "end": "344729"
  },
  {
    "text": "constantly experimenting with I like to say that there is no such thing as the Netflix product or the Netflix app there",
    "start": "344729",
    "end": "350789"
  },
  {
    "text": "really is a an amalgamation of various user experiences that come together and",
    "start": "350789",
    "end": "357330"
  },
  {
    "text": "because of the personalization that together essentially builds the experience that you see and so what we",
    "start": "357330",
    "end": "363479"
  },
  {
    "text": "have to do we have to build various different training pipelines and various different models and run through various",
    "start": "363479",
    "end": "369750"
  },
  {
    "text": "AV testing set ups and so each of the Netflix members are allocated in two",
    "start": "369750",
    "end": "376169"
  },
  {
    "text": "different a B tests and we're constantly evaluating every new feature every new",
    "start": "376169",
    "end": "381509"
  },
  {
    "text": "algorithm that we're loading out to make sure that it stuff doesn't hurt the",
    "start": "381509",
    "end": "387030"
  },
  {
    "text": "usability and the value that you get out of the service while at the same time improving key performance metrics and so",
    "start": "387030",
    "end": "393360"
  },
  {
    "text": "this really is the context in which our world works and so the rest of the talk",
    "start": "393360",
    "end": "399330"
  },
  {
    "text": "is essentially going to be focusing on the trading pipelines okay",
    "start": "399330",
    "end": "405260"
  },
  {
    "text": "so here's sort of a high level conceptual view of what happens in your traditional training pipeline we start",
    "start": "405260",
    "end": "413280"
  },
  {
    "text": "out as I mentioned earlier with preparing data so you essentially take a",
    "start": "413280",
    "end": "418620"
  },
  {
    "text": "lot of signals that you have and you stare off' i them appropriately so you",
    "start": "418620",
    "end": "423780"
  },
  {
    "text": "want to make sure that you're not underrepresented one particular group or clusters and then you generate various",
    "start": "423780",
    "end": "431400"
  },
  {
    "text": "features and features really are sort of a mathematical representation of how you are taking in various useful input",
    "start": "431400",
    "end": "440310"
  },
  {
    "text": "signals and creating an abstract concept",
    "start": "440310",
    "end": "445470"
  },
  {
    "text": "that can then be used to train and learn you when the model is learning and one",
    "start": "445470",
    "end": "450840"
  },
  {
    "text": "of the important things here to note is that the feature encoders that we write here in an offline training concept",
    "start": "450840",
    "end": "456020"
  },
  {
    "text": "essentially has to be the same code that we use in an online scoring context and",
    "start": "456020",
    "end": "461790"
  },
  {
    "text": "this is the reason for this is the data quality is super paramount we some of these models are super sensitive to",
    "start": "461790",
    "end": "469080"
  },
  {
    "text": "movements of these metrics and we want to make sure that on unintended consequences in slight changes in data",
    "start": "469080",
    "end": "475560"
  },
  {
    "text": "quality don't negatively impact and help us make wrong decisions or cause us to",
    "start": "475560",
    "end": "480990"
  },
  {
    "text": "make wrong decisions so then we go into the model training we use a lot of proprietary algorithms we also use open",
    "start": "480990",
    "end": "487440"
  },
  {
    "text": "source frameworks like spark in tensor flow and once the training is done we compute various metrics we run through",
    "start": "487440",
    "end": "495090"
  },
  {
    "text": "the validation sets alert wherever we need to and then we go through this hyper parameter optimization and",
    "start": "495090",
    "end": "501060"
  },
  {
    "text": "selection phase we are basically trying to make sure that were properly regularized we will make sure that we",
    "start": "501060",
    "end": "507330"
  },
  {
    "text": "were not doing something that is is hurting anyone",
    "start": "507330",
    "end": "513090"
  },
  {
    "text": "secondary or primary metrics significantly and ultimately once we have a highly tuned model that model",
    "start": "513090",
    "end": "519690"
  },
  {
    "text": "gets published and is sent over to us essentially a scoring layer and that's where we do the pre compute or like",
    "start": "519690",
    "end": "525840"
  },
  {
    "text": "compute as I talked about earlier okay there are several challenges with these",
    "start": "525840",
    "end": "532600"
  },
  {
    "text": "pipelines one of the things that a system that is trying to solve this",
    "start": "532600",
    "end": "537940"
  },
  {
    "text": "problem needs to do well is to be aware of the inherent heterogeneity of the problem every other day you hear about",
    "start": "537940",
    "end": "545470"
  },
  {
    "text": "the next new great ml to get out there or sort of a new data platform out there",
    "start": "545470",
    "end": "552640"
  },
  {
    "text": "and you will need to be able to put all of these things together and you can't have a one-size-fits-all model for",
    "start": "552640",
    "end": "559630"
  },
  {
    "text": "failure handling you want to make sure that the users of your platform essentially are finding it easy in one",
    "start": "559630",
    "end": "566500"
  },
  {
    "text": "place to find all the logs for for ease of debugging for instance data",
    "start": "566500",
    "end": "572080"
  },
  {
    "text": "provenance data lineage are super important for reproducibility so a",
    "start": "572080",
    "end": "577839"
  },
  {
    "text": "problem happened once or a weekend but when your your data scientist actually",
    "start": "577839",
    "end": "583480"
  },
  {
    "text": "comes on Monday they want to be able to reproduce that and they want to be able to track back how and why that happened",
    "start": "583480",
    "end": "590040"
  },
  {
    "text": "and in a growing increasingly multi-tenant environment you want to",
    "start": "590040",
    "end": "595420"
  },
  {
    "text": "make sure that you're doing an efficient resource optimization utilization",
    "start": "595420",
    "end": "600700"
  },
  {
    "text": "otherwise you'll end up for you know stealing from Peter and for Paul and so you really don't want to make sure that",
    "start": "600700",
    "end": "606339"
  },
  {
    "text": "you're over optimizing on any any one part of the system and a system that",
    "start": "606339",
    "end": "612250"
  },
  {
    "text": "needs to input a lot of data sources needs to handle external data trigger as well so for instance the system should",
    "start": "612250",
    "end": "619720"
  },
  {
    "text": "be resilient to out of order data or delayed data and so to address some of",
    "start": "619720",
    "end": "628089"
  },
  {
    "text": "these challenges about two-and-a-half years ago we were dealing with many of these and we essentially built mace on",
    "start": "628089",
    "end": "634690"
  },
  {
    "text": "and while my son was introduced in the context of the recommendation systems",
    "start": "634690",
    "end": "640270"
  },
  {
    "text": "it's a fairly generic and extensible workflow engine it can operate at sort",
    "start": "640270",
    "end": "647950"
  },
  {
    "text": "of the core vertical orchestration layer where it's just managing tasks and stages but one of the unique things",
    "start": "647950",
    "end": "653860"
  },
  {
    "text": "about meson is that it can also be closely met with the execution layer so",
    "start": "653860",
    "end": "660520"
  },
  {
    "text": "for instance we can attach it to an apache Miso's cluster and your spark apps in each of your stages",
    "start": "660520",
    "end": "666910"
  },
  {
    "text": "or steps in a workflow could be an independent spark job we also support running various Dockers at scale we",
    "start": "666910",
    "end": "674200"
  },
  {
    "text": "integrate with the Netflix talker internal management system it's called Titus and it allows us sort of the",
    "start": "674200",
    "end": "681339"
  },
  {
    "text": "freedom to explore things that may not work well in Sparks data paradigm we've",
    "start": "681339",
    "end": "689410"
  },
  {
    "text": "had from the get-go we've had a good support for Scala and so our primary",
    "start": "689410",
    "end": "694540"
  },
  {
    "text": "mode of integration and interaction that mace on when you're defining a workflow goes through a Scala DSL but as a",
    "start": "694540",
    "end": "701980"
  },
  {
    "text": "testament to Mason's extensibility we have recently introduced a Python DSL also as the adoption of mace on is",
    "start": "701980",
    "end": "708910"
  },
  {
    "text": "growing within Netflix there are a bunch of other features here I'm not going to go into the detail I'll call out just a",
    "start": "708910",
    "end": "715029"
  },
  {
    "text": "couple here one is and and it'll highlight how my son what's rough",
    "start": "715029",
    "end": "720570"
  },
  {
    "text": "differentiate itself one of them is support for loops so typically your",
    "start": "720570",
    "end": "725649"
  },
  {
    "text": "workflow managers would support a directed acyclic graph but in the context where we were operating we found",
    "start": "725649",
    "end": "732070"
  },
  {
    "text": "users where it would be handy to be able to sort of loop in a subset of your graph while a certain value for",
    "start": "732070",
    "end": "739540"
  },
  {
    "text": "parameter hasn't reached a threshold and once it reaches the threshold you can get out of that loop and so maysun",
    "start": "739540",
    "end": "744910"
  },
  {
    "text": "natively supports that the other thing that stands out is we support ml",
    "start": "744910",
    "end": "751240"
  },
  {
    "text": "expressions which allows our users to be much more expressive in the way they can",
    "start": "751240",
    "end": "758020"
  },
  {
    "text": "parameterize their graphs okay some",
    "start": "758020",
    "end": "763150"
  },
  {
    "text": "stats on Maison we've been using it for a couple of years in production we have",
    "start": "763150",
    "end": "770310"
  },
  {
    "text": "you know more than 10 different independent deployments within various",
    "start": "770310",
    "end": "775860"
  },
  {
    "text": "various teams that are using Maison we sort of run a couple of big manage clusters or our team supports but",
    "start": "775860",
    "end": "782290"
  },
  {
    "text": "there's also self deployed clusters that you know 2% or 3% teams are just",
    "start": "782290",
    "end": "787930"
  },
  {
    "text": "managing on their own for all the production jobs and a B test ml",
    "start": "787930",
    "end": "793270"
  },
  {
    "text": "pipelines are referred to there's more than thousand of them running on a daily basis for retraining those models our largest spark missiles",
    "start": "793270",
    "end": "800109"
  },
  {
    "text": "compute pool has over 2,000 ec2 instances and we run several tens of",
    "start": "800109",
    "end": "805179"
  },
  {
    "text": "thousands of dailystep runs so I'll talk a little bit about what some of these terms mean the web interface is shown",
    "start": "805179",
    "end": "813009"
  },
  {
    "text": "here essentially you can see a list of various workflows and some history of",
    "start": "813009",
    "end": "818619"
  },
  {
    "text": "success and then it's fairly rich when you click on the various icons but if you look at the graph at the bottom this",
    "start": "818619",
    "end": "826329"
  },
  {
    "text": "is an example of sort of the graph view of one particular workflow each of those",
    "start": "826329",
    "end": "832029"
  },
  {
    "text": "boxes that appear here are essentially a step so Maison is this concept of a step",
    "start": "832029",
    "end": "837759"
  },
  {
    "text": "and a workflow a workflow comprises of several different steps the color coding",
    "start": "837759",
    "end": "842980"
  },
  {
    "text": "gives you a sense of what step has successfully completed so green means if",
    "start": "842980",
    "end": "848350"
  },
  {
    "text": "completed bloom into either you're waiting for it and red and others have self explanatory reasons so you'll see",
    "start": "848350",
    "end": "856419"
  },
  {
    "text": "some more examples of these kind of these graphs as I talk through the",
    "start": "856419",
    "end": "861819"
  },
  {
    "text": "various ml pipelines in the recommendation context okay so let's",
    "start": "861819",
    "end": "867639"
  },
  {
    "text": "start with an anatomy of an ml pipeline so this is an example this this is an",
    "start": "867639",
    "end": "873549"
  },
  {
    "text": "example of a page construction model I started out the presentation showing you the home page and this particular",
    "start": "873549",
    "end": "880889"
  },
  {
    "text": "example is an a/b test that we're trying to run to figure out a more efficient way of of showing content within the",
    "start": "880889",
    "end": "888100"
  },
  {
    "text": "whole page so a couple of things that I want to highlight here are this is an",
    "start": "888100",
    "end": "895509"
  },
  {
    "text": "example of one of those steps which is executing an ml expression and so let's",
    "start": "895509",
    "end": "901239"
  },
  {
    "text": "say you wanna you want to process your data for a feed that was generated 14 days ago and you could literally just",
    "start": "901239",
    "end": "908619"
  },
  {
    "text": "write you know take a particular date and then you put in a simple ml",
    "start": "908619",
    "end": "913809"
  },
  {
    "text": "expression and then that gets executed when you push that code over to Maison",
    "start": "913809",
    "end": "919079"
  },
  {
    "text": "the other point that is highlighted here is about how Maison puts together heterogeneous systems so the first step",
    "start": "919079",
    "end": "925659"
  },
  {
    "text": "there in the middle is doing some data preparation and that's a spark job but once you're done",
    "start": "925659",
    "end": "932050"
  },
  {
    "text": "with the data preparation the training step is essentially using tensorflow and running in a darker and so you're",
    "start": "932050",
    "end": "938110"
  },
  {
    "text": "trying to put them together and stuff you can seamlessly bind them and then right after that once the training is",
    "start": "938110",
    "end": "944380"
  },
  {
    "text": "done and you're trying to compute the metrics for the various a/b test cells you're back into spark and so",
    "start": "944380",
    "end": "949500"
  },
  {
    "text": "essentially we allow the user to use the right tool for the job and we don't want to shoehorn our customers which are data",
    "start": "949500",
    "end": "957100"
  },
  {
    "text": "scientists and researchers do have to stick to one particular technology",
    "start": "957100",
    "end": "963210"
  },
  {
    "text": "another example here is the boxart personalization pipeline boxart refers",
    "start": "963810",
    "end": "969070"
  },
  {
    "text": "to the title imagery which as I said is personalized and this shows you",
    "start": "969070",
    "end": "974890"
  },
  {
    "text": "essentially its Maps very nicely to the earlier sort of stages of a pipeline for",
    "start": "974890",
    "end": "981940"
  },
  {
    "text": "training that I talked about so you do your data preparation your feature engineering and your training multiple",
    "start": "981940",
    "end": "987070"
  },
  {
    "text": "models eventually you're trying to make your scoring decisions and your metric",
    "start": "987070",
    "end": "992140"
  },
  {
    "text": "distributions and then eventually publish another example here is a video",
    "start": "992140",
    "end": "1000810"
  },
  {
    "text": "ranking pipeline it's a fairly straightforward example but the thing that I want to highlight is the way",
    "start": "1000810",
    "end": "1007110"
  },
  {
    "text": "Maison allows you to construct your code even though this is a is a nice graph",
    "start": "1007110",
    "end": "1013350"
  },
  {
    "text": "and you can actually go and compose these boxes and connect these through edges but the most popular usage for",
    "start": "1013350",
    "end": "1021720"
  },
  {
    "text": "defining workflows is through DSL and in this particular case the team that manages the video rancors they've",
    "start": "1021720",
    "end": "1028740"
  },
  {
    "text": "essentially built out a base DSL class and so the production pipeline is running and it's all checked in in your",
    "start": "1028740",
    "end": "1035400"
  },
  {
    "text": "code managed through your SCM system and anytime you need to run a new a/b test all you're doing is you're extending the",
    "start": "1035400",
    "end": "1042270"
  },
  {
    "text": "base class and so and that's it's sitting right there you can compare them",
    "start": "1042270",
    "end": "1047280"
  },
  {
    "text": "and a lot of times before we have this nice integration with the DSL people",
    "start": "1047280",
    "end": "1052320"
  },
  {
    "text": "used to complain about we're not sure which specific code is running in which a be test and this is sort of helping",
    "start": "1052320",
    "end": "1059160"
  },
  {
    "text": "with that problem this is another ranking pipeline the",
    "start": "1059160",
    "end": "1066510"
  },
  {
    "text": "example here is showing a common pattern the scatter gathered pattern which is",
    "start": "1066510",
    "end": "1072030"
  },
  {
    "text": "useful for data parallel training so data parallel means that instead of trying to send all your data to one",
    "start": "1072030",
    "end": "1078540"
  },
  {
    "text": "particular trainer you're essentially taking chunks of data and sending those chunks of data to different instances of",
    "start": "1078540",
    "end": "1083970"
  },
  {
    "text": "the same model and then you're training it on that and putting them together and so Maison enables that using this rough",
    "start": "1083970",
    "end": "1090780"
  },
  {
    "text": "scatter and gatherer continue watching",
    "start": "1090780",
    "end": "1096000"
  },
  {
    "text": "pipeline most of you are probably familiar with the continuum watching row it's one of our most commonly used rows",
    "start": "1096000",
    "end": "1102830"
  },
  {
    "text": "because a lot of you hopefully are binge Watchers you just go there and you click continue watching what you're watching and that pipeline is also personalized",
    "start": "1102830",
    "end": "1110550"
  },
  {
    "text": "so there are several things you have to figure out what is the order in which we would present those styles for you and",
    "start": "1110550",
    "end": "1116400"
  },
  {
    "text": "when do if you think the title is essentially done watching are you at the",
    "start": "1116400",
    "end": "1121500"
  },
  {
    "text": "credits are you at the last season last episode or are you in the middle but the",
    "start": "1121500",
    "end": "1127410"
  },
  {
    "text": "reason why I showed this pipeline here is to give you an example of how maysun helps with deploying sort of deploying a",
    "start": "1127410",
    "end": "1137040"
  },
  {
    "text": "migration strategy when your pipeline is in production so the top part is an new",
    "start": "1137040",
    "end": "1145650"
  },
  {
    "text": "way of sort of solving the continued watching training challenge but instead of having",
    "start": "1145650",
    "end": "1152430"
  },
  {
    "text": "to have two separate pipelines we were essentially able to merge that into one",
    "start": "1152430",
    "end": "1158580"
  },
  {
    "text": "single pipeline and reuse all the steps in the front part of that workflow so",
    "start": "1158580",
    "end": "1163770"
  },
  {
    "text": "that we don't have to unnecessarily recompute the data and the features that are going to be same and so this is an",
    "start": "1163770",
    "end": "1168930"
  },
  {
    "text": "example of how you can put them together and one more pipeline here as an example",
    "start": "1168930",
    "end": "1174810"
  },
  {
    "text": "this is a member value modeling pipeline so we're trying to predict when it's the lifetime value of a Netflix member it's",
    "start": "1174810",
    "end": "1181230"
  },
  {
    "text": "a very straightforward pipeline but the key part that I highlight here is that little box that little circles which has",
    "start": "1181230",
    "end": "1188400"
  },
  {
    "text": "35 on it that is a UI way of essentially showing the Mason for each",
    "start": "1188400",
    "end": "1195870"
  },
  {
    "text": "feature and so what forage does it essentially execute the same step over",
    "start": "1195870",
    "end": "1200880"
  },
  {
    "text": "and over again with different values of a parameter and in this particular case were literally running $35 in parallel",
    "start": "1200880",
    "end": "1206520"
  },
  {
    "text": "with different values of this of a particular parameter and once we we figure out the parameters that we were",
    "start": "1206520",
    "end": "1212730"
  },
  {
    "text": "that were interested in we essentially put them together and do downstream ETL so this sort of gives you some sense of",
    "start": "1212730",
    "end": "1219750"
  },
  {
    "text": "how Maison is used what Maison is for and at this point we're going to move",
    "start": "1219750",
    "end": "1225630"
  },
  {
    "text": "over to the next section of our talk where Davis is going to talk about some",
    "start": "1225630",
    "end": "1231300"
  },
  {
    "text": "of the lessons learned as we build miss on the system you know festal it's sort",
    "start": "1231300",
    "end": "1245550"
  },
  {
    "text": "of alluded to some of the challenges we wanted to solve and I kind of want to sort of drill down on those a little bit so first lesson data is at the core of",
    "start": "1245550",
    "end": "1254820"
  },
  {
    "text": "every job now this may be small and incidental right may be reading from an external service or as simple as pulling",
    "start": "1254820",
    "end": "1260940"
  },
  {
    "text": "it data from a command line but most of this data is substantial and serves as sort of the interface if you will with",
    "start": "1260940",
    "end": "1268050"
  },
  {
    "text": "these steps with each other right and sort of dictates why it is they need to sort of run one after the other and so in an orchestration system",
    "start": "1268050",
    "end": "1275220"
  },
  {
    "text": "we need to have a structured way to describe the relationships between these",
    "start": "1275220",
    "end": "1280230"
  },
  {
    "text": "jobs or steps and the data on which they operate and we do this through a mechanism what we call sort of data",
    "start": "1280230",
    "end": "1286410"
  },
  {
    "text": "artifacts and this enables us to describe the relationships for sort of",
    "start": "1286410",
    "end": "1291960"
  },
  {
    "text": "two key use cases so cross workflow dependencies you know sort of the edges of these these flows are going to",
    "start": "1291960",
    "end": "1298200"
  },
  {
    "text": "produce data that may be consumed elsewhere and also to synchronize on the availability of data and if you don't",
    "start": "1298200",
    "end": "1304559"
  },
  {
    "text": "have this sort of structured mechanism for describing these relationships you're left with you know either",
    "start": "1304559",
    "end": "1309720"
  },
  {
    "text": "brittles job-based dependencies which can often grow stale as the system evolves or hidden dependencies in the",
    "start": "1309720",
    "end": "1315929"
  },
  {
    "text": "forms of like you know delayed timers and clocks to sort of synchronize and when data's available so you need to",
    "start": "1315929",
    "end": "1321090"
  },
  {
    "text": "have a structured way to describe this sort of data relationship and and this",
    "start": "1321090",
    "end": "1326640"
  },
  {
    "text": "is a sort of an example of the usage in the DSL we can sort of describe you know the input for the step meaning like don't",
    "start": "1326640",
    "end": "1333490"
  },
  {
    "text": "actually kick off the relevant work until this data is actually available in the system and when it's complete you",
    "start": "1333490",
    "end": "1338860"
  },
  {
    "text": "can sort of announce that this output data set is available for any other steps that may be interested in it",
    "start": "1338860",
    "end": "1345900"
  },
  {
    "text": "immutability particularly versioned immutability provide sanity and we do",
    "start": "1347590",
    "end": "1353650"
  },
  {
    "text": "this by treating the sort of the workflow definition as a sort of persistent data structure meaning so any",
    "start": "1353650",
    "end": "1360640"
  },
  {
    "text": "execution has a durable reference to the definition when it actually ran and this",
    "start": "1360640",
    "end": "1366460"
  },
  {
    "text": "enables a couple things because you have this durable reference you know multiple people can collaborate on a workflow",
    "start": "1366460",
    "end": "1371860"
  },
  {
    "text": "without necessarily stepping on each other's toes you know they can get you know results and not be impacted by a",
    "start": "1371860",
    "end": "1377380"
  },
  {
    "text": "colleague making a change upstream and then by maintaining this history of all",
    "start": "1377380",
    "end": "1383290"
  },
  {
    "text": "of sort of the versions of work that have run we can ensure that if something goes wrong we can roll back to a good",
    "start": "1383290",
    "end": "1388300"
  },
  {
    "text": "version you know very truly trivially and then finally by maintaining this sort of consistent relationship between",
    "start": "1388300",
    "end": "1394540"
  },
  {
    "text": "each execution and the version that sort of spawned it we have we maintain reproducibility right we can go back in",
    "start": "1394540",
    "end": "1400720"
  },
  {
    "text": "time and understand exactly the sort of scenario that led to print prints you know a particularly aberrant behavior",
    "start": "1400720",
    "end": "1406840"
  },
  {
    "text": "that wanted diagnose one abstraction",
    "start": "1406840",
    "end": "1415090"
  },
  {
    "text": "does not fit all more specifically one high level abstraction does not fit all in the orchestration space there's a lot of",
    "start": "1415090",
    "end": "1421810"
  },
  {
    "text": "orchestration tools out there and you know they all sort of make sort of various assumptions about sort of the",
    "start": "1421810",
    "end": "1428080"
  },
  {
    "text": "domain in which they want to tackle but they all seem to have you know a similar core concept it's a sort of evidence by",
    "start": "1428080",
    "end": "1434830"
  },
  {
    "text": "the many names that they use right Maison we call it a workflow other tools we call it a process flow or a pipeline or a dag or a data flow or an up flow or",
    "start": "1434830",
    "end": "1441940"
  },
  {
    "text": "a down flow but at the end of the day this is just a computation graph and in",
    "start": "1441940",
    "end": "1448270"
  },
  {
    "text": "the process of designing and building Maison we were often tempted to try to specialize you know to a particularly",
    "start": "1448270",
    "end": "1455530"
  },
  {
    "text": "use case to make it a little bit more usable for a given set of users and inevitably this would weaken maisons",
    "start": "1455530",
    "end": "1461950"
  },
  {
    "text": "ability to address some other use case that we knew we wanted to address so we're left in a",
    "start": "1461950",
    "end": "1467380"
  },
  {
    "text": "situation now where we have this you know you know execution graph this very flexible system but it's fairly opaque",
    "start": "1467380",
    "end": "1472659"
  },
  {
    "text": "how do we bridge that gap now to our users so they actually you know have a usable system that they can sort of",
    "start": "1472659",
    "end": "1477820"
  },
  {
    "text": "adapt and apply to their particular problem space so and way we do this is",
    "start": "1477820",
    "end": "1490450"
  },
  {
    "text": "Maison essentially provides workflows as a service so you have this this abstract",
    "start": "1490450",
    "end": "1496210"
  },
  {
    "text": "sort of you know ability to describe a workflow essentially as a JSON payload describing all the steps their",
    "start": "1496210",
    "end": "1502270"
  },
  {
    "text": "relationships with each other the data that is consumed and produced locations",
    "start": "1502270",
    "end": "1507730"
  },
  {
    "text": "of artifacts that are necessary and this enables essentially any language or framework to produce these workflow",
    "start": "1507730",
    "end": "1513280"
  },
  {
    "text": "descriptions and so what we're able to do and is sort of vessel it alluded to",
    "start": "1513280",
    "end": "1518590"
  },
  {
    "text": "various teams can essentially tailor and specialize their interface to the orchestration system in a way that they",
    "start": "1518590",
    "end": "1525490"
  },
  {
    "text": "can sort of leverage and get sort of productivity gains and using a more succinct compact sort of domain-specific",
    "start": "1525490",
    "end": "1530980"
  },
  {
    "text": "language that sort of translates to the common sort of JSON description of these",
    "start": "1530980",
    "end": "1536409"
  },
  {
    "text": "workflows and so we're able to get the flexibility to be able to tailor the",
    "start": "1536409",
    "end": "1541750"
  },
  {
    "text": "system to all these domains while retaining the core infrastructure and power of a single orchestration system",
    "start": "1541750",
    "end": "1547299"
  },
  {
    "text": "and we've seen DSL specifically for doing a/b test orchestration and ml orchestration and now we're seeing a DSL",
    "start": "1547299",
    "end": "1554860"
  },
  {
    "text": "specifically tailored for describing ETL pipelines built on top of the new Python DSL notebook automation and we're still",
    "start": "1554860",
    "end": "1561580"
  },
  {
    "text": "seeing sort of more use cases brought on in this similar pattern difficulty so",
    "start": "1561580",
    "end": "1573460"
  },
  {
    "text": "the batteries are falling out that's not going to be good okay",
    "start": "1573460",
    "end": "1578750"
  },
  {
    "text": "just hold it in pray all right I don't about you but at least in my time at",
    "start": "1578750",
    "end": "1585140"
  },
  {
    "text": "reinvent I am certainly overwhelmed by the amount of new technology that's coming out so you know it's not just",
    "start": "1585140",
    "end": "1591350"
  },
  {
    "text": "that systems are heterogeneous they're heterogeneous and constantly changing right there's always new hotness right",
    "start": "1591350",
    "end": "1596690"
  },
  {
    "text": "that we want to be able to use and leverage and so we need to build the system in a way that we can extend and",
    "start": "1596690",
    "end": "1602360"
  },
  {
    "text": "adapt and leverage these new tools but the problem of orchestration is not going away right you need to be able to",
    "start": "1602360",
    "end": "1608180"
  },
  {
    "text": "sort of stitch these together to create cohesive solutions to these sorts of problems so we need to make sure that",
    "start": "1608180",
    "end": "1614510"
  },
  {
    "text": "the cities this orchestration system provides lasting value in the face of all this new technology and when we",
    "start": "1614510",
    "end": "1621170"
  },
  {
    "text": "first built Maison you know we had invested very heavily in spark spark is used throughout the recommendation space and throughout Netflix and if you know",
    "start": "1621170",
    "end": "1628220"
  },
  {
    "text": "that was you know very useful right we had to sort of present it if it didn't work with sort of the core technology we were using sort of a non-starter but we",
    "start": "1628220",
    "end": "1635060"
  },
  {
    "text": "know the technologies still moving and we wanted to build it in such a way that enabled our users to extend the system",
    "start": "1635060",
    "end": "1640700"
  },
  {
    "text": "to the new technology as well right we didn't want to be left with the the burden of trying to constantly extend the system and adapt for new tools and",
    "start": "1640700",
    "end": "1647000"
  },
  {
    "text": "new technologies and so we can extend it in sort of two ways we have sort of the custom step",
    "start": "1647000",
    "end": "1653300"
  },
  {
    "text": "interface which is the means by which Maison we can teach Maison to talk to new platforms new core services so if",
    "start": "1653300",
    "end": "1660020"
  },
  {
    "text": "this is you know talking to amazed OHS cluster or spawning a job out on a new external service you know festival",
    "start": "1660020",
    "end": "1667400"
  },
  {
    "text": "talked about you know Titus internally or to spawn up you know spin up an EMR job or something along those lines and",
    "start": "1667400",
    "end": "1673000"
  },
  {
    "text": "then the DSL itself enables you to reap ramit rise those existing mechanisms to",
    "start": "1673000",
    "end": "1679940"
  },
  {
    "text": "describe something like tensor flow on a container right we Mazin already knows how to launch a container so it's merely",
    "start": "1679940",
    "end": "1685700"
  },
  {
    "text": "a matter of Reaper amat rising that particular step with the appropriate parameters in order to describe now a",
    "start": "1685700",
    "end": "1691010"
  },
  {
    "text": "tensor flow step so it's it's one thing to to sort of be able to now exercise",
    "start": "1691010",
    "end": "1696530"
  },
  {
    "text": "these systems but it's equally important to be able to feedback sort of structured distilled relevant debug",
    "start": "1696530",
    "end": "1702110"
  },
  {
    "text": "information from these systems as well right we want to ensure that you know as the new technology comes out we can maintain a native feel for that",
    "start": "1702110",
    "end": "1708590"
  },
  {
    "text": "integration and that's motivated by the fact that things break and when they do these systems are complex so we need to ensure that as",
    "start": "1708590",
    "end": "1715800"
  },
  {
    "text": "much relevant debug information is sort of at hand when things are going south and so we have a mechanism by which",
    "start": "1715800",
    "end": "1722240"
  },
  {
    "text": "these steps can feedback small snippets of structured information what we call artifacts and we can surface things like",
    "start": "1722240",
    "end": "1729420"
  },
  {
    "text": "you know the command line string that was utilized timeline information about the evolution in that step you know links to relevant pages such as",
    "start": "1729420",
    "end": "1736200"
  },
  {
    "text": "you know the UI for your spark job or a history server or a link to that EMR cluster that was spun up and you know",
    "start": "1736200",
    "end": "1743310"
  },
  {
    "text": "having this this information at hand has really enabled us to sort of keep up and maintain that sort of native level of integration with all these new",
    "start": "1743310",
    "end": "1748770"
  },
  {
    "text": "technologies and then for the custom step interface we also wanted to make sure that it wasn't a burden to to sort",
    "start": "1748770",
    "end": "1755400"
  },
  {
    "text": "of continually extend this and so there's sort of two core primitives with any sort of orchestration system right",
    "start": "1755400",
    "end": "1761310"
  },
  {
    "text": "in our case we have a mazes cluster we wanted to have a baked in compute layer for convenience for our users so you know we can fork a command or we",
    "start": "1761310",
    "end": "1768840"
  },
  {
    "text": "can call out to some service in the world to sort of spawn a job elsewhere and all of our sort of custom stuff",
    "start": "1768840",
    "end": "1774240"
  },
  {
    "text": "integrations extend from these two core primitives and that particular approach has enabled us to you know extend and",
    "start": "1774240",
    "end": "1780840"
  },
  {
    "text": "teach Maison about these new platforms fairly trivially and with that I'm gonna",
    "start": "1780840",
    "end": "1786480"
  },
  {
    "text": "hand off to my colleague Eugene it's going to talk about so the lessons we learned and actually building the scheduler itself well all right pinch",
    "start": "1786480",
    "end": "1798960"
  },
  {
    "text": "that keep the bad reason so let's dive",
    "start": "1798960",
    "end": "1806640"
  },
  {
    "text": "deeper a bit inside miss on and see what machine is made of well at the core of",
    "start": "1806640",
    "end": "1812370"
  },
  {
    "text": "Mezen is internal written in scala and the core of melon we had this REST API which is a offer often something that is",
    "start": "1812370",
    "end": "1819390"
  },
  {
    "text": "underestimated but actually arrests API enables your system to be used by any",
    "start": "1819390",
    "end": "1824550"
  },
  {
    "text": "kind of other systems it's a point of integration that did serve us very well",
    "start": "1824550",
    "end": "1829860"
  },
  {
    "text": "for example the fact that you can programmatically create a workflow enable our users to dynamically from",
    "start": "1829860",
    "end": "1837300"
  },
  {
    "text": "like a running web application generate workflows and then trigger them and on",
    "start": "1837300",
    "end": "1842790"
  },
  {
    "text": "top of this REST API we did also build our reach why we don't you large yes",
    "start": "1842790",
    "end": "1848539"
  },
  {
    "text": "this UI is mostly used for monitoring purpose but we also provide the ability",
    "start": "1848539",
    "end": "1853609"
  },
  {
    "text": "to modify and create workflows also we think doing this through our UI is not",
    "start": "1853609",
    "end": "1858829"
  },
  {
    "text": "really well it's not very good for production for producing we think it's better to define your work with your",
    "start": "1858829",
    "end": "1865070"
  },
  {
    "text": "code and make them part of your project and your source control however for",
    "start": "1865070",
    "end": "1873139"
  },
  {
    "text": "people to try out and to play it's important it's important because it will if I'm new I come and I want to try",
    "start": "1873139",
    "end": "1880099"
  },
  {
    "text": "measure on well provide the first thing I will do I will just try to go to the UI and play with it and as a persistence",
    "start": "1880099",
    "end": "1886909"
  },
  {
    "text": "layer we currently use Amazon Aurora it hasn't been always the case and we will talk about this a bit later on and",
    "start": "1886909",
    "end": "1895009"
  },
  {
    "text": "in the database which currently store the metadata about the different workflows the their definition",
    "start": "1895009",
    "end": "1901690"
  },
  {
    "text": "information about the past executions the data artifacts that have been announced in the system and basically",
    "start": "1901690",
    "end": "1909019"
  },
  {
    "text": "many different things and this persistence layer can is being accessed",
    "start": "1909019",
    "end": "1914059"
  },
  {
    "text": "only by our core mission instance which is a an important aspect because that",
    "start": "1914059",
    "end": "1920119"
  },
  {
    "text": "enables us to control how people interact with our database and we want people to interact with the database",
    "start": "1920119",
    "end": "1925729"
  },
  {
    "text": "through our REST API and it enables us also to switch for example if for some",
    "start": "1925729",
    "end": "1932329"
  },
  {
    "text": "reason we wanted to replace it well we could it will be much simpler but we",
    "start": "1932329",
    "end": "1937609"
  },
  {
    "text": "don't want it and at the core of Mazzone we have our orchestration layer which is",
    "start": "1937609",
    "end": "1943789"
  },
  {
    "text": "basically the system that manages all the logic on how you will transition",
    "start": "1943789",
    "end": "1949309"
  },
  {
    "text": "from one step to another one what to do in case of failure how to trigger a work phone what to do when a piece of data is",
    "start": "1949309",
    "end": "1956299"
  },
  {
    "text": "an out find what are the matching workflows that wait for this data to come in the system so this is the single",
    "start": "1956299",
    "end": "1962629"
  },
  {
    "text": "component that manages all this logic and this logic is not distributed in any way which simplifies a lot managing this",
    "start": "1962629",
    "end": "1970429"
  },
  {
    "text": "this complexity and we paralyze work inside meson internally yeah characters",
    "start": "1970429",
    "end": "1978180"
  },
  {
    "text": "we don't use actors to run the actual jobs it's really just for internal usage and recently we also added hive apt",
    "start": "1978180",
    "end": "1987390"
  },
  {
    "text": "support in mess on the a zookeeper so basically we'll have always one leader",
    "start": "1987390",
    "end": "1992640"
  },
  {
    "text": "instance of Mason I represent by this large box here and a few standby",
    "start": "1992640",
    "end": "1998580"
  },
  {
    "text": "instances and the idea zookeeper will fail over to one of the other instances so let's take a closer look to see how",
    "start": "1998580",
    "end": "2006620"
  },
  {
    "text": "we actually run the work in the system especially how do we run work in a distributed way which would enable us",
    "start": "2006620",
    "end": "2013250"
  },
  {
    "text": "basically to scale easily by just adding more instances in order to run more work for that process we rely on measures",
    "start": "2013250",
    "end": "2019790"
  },
  {
    "text": "which is our execution layer and core scheduling part of Mazon is implemented",
    "start": "2019790",
    "end": "2026390"
  },
  {
    "text": "as a message framework which enables us to receive basically resource offers from mezzos we're resourced offer is a",
    "start": "2026390",
    "end": "2034370"
  },
  {
    "text": "structure basically describing how much free cpu how much free round do you have on a given and misses agent and lesson",
    "start": "2034370",
    "end": "2041630"
  },
  {
    "text": "we take those resource offers and match them against tasks that need to be run those tasks are basically the different",
    "start": "2041630",
    "end": "2047960"
  },
  {
    "text": "steps that the Davis FSA were referring to before and the step is defined also",
    "start": "2047960",
    "end": "2052970"
  },
  {
    "text": "by a given set of resources that it needs to run the matching part we do it",
    "start": "2052970",
    "end": "2058340"
  },
  {
    "text": "actually using penso which is a Netflix open source library that is designed to",
    "start": "2058340",
    "end": "2063350"
  },
  {
    "text": "help you to help mrs. framework and implementers to do the scheduling part",
    "start": "2063350",
    "end": "2069770"
  },
  {
    "text": "so this is really the the piece that will help you basically to optimize and to decide how to match those resources",
    "start": "2069770",
    "end": "2076790"
  },
  {
    "text": "with the tasks that you want to run I'm invited to check it out it makes this part of the work much simpler and it's",
    "start": "2076790",
    "end": "2083389"
  },
  {
    "text": "pretty pretty nice it supports different kind of plugins and it's pretty extensive so once we have this match we",
    "start": "2083390",
    "end": "2090408"
  },
  {
    "text": "will ask measures to run the test to run the task measures we start Mazin",
    "start": "2090409",
    "end": "2096320"
  },
  {
    "text": "executor which is basically a custom code a custom Mason code that implements",
    "start": "2096320",
    "end": "2102140"
  },
  {
    "text": "the measures executor API which enables us to interact with actually our",
    "start": "2102140",
    "end": "2109530"
  },
  {
    "text": "scheduler so this Mazzone executor will basically run the different steps and",
    "start": "2109530",
    "end": "2115080"
  },
  {
    "text": "through the custom step abstraction that Davis was referring to before we will know how to run this we'll know how to",
    "start": "2115080",
    "end": "2121500"
  },
  {
    "text": "start a docker container in the Netflix cloud which is titus or how to run a",
    "start": "2121500",
    "end": "2127290"
  },
  {
    "text": "local SPARC job that will reuse the same computer resources as Amazon which will",
    "start": "2127290",
    "end": "2133650"
  },
  {
    "text": "be basically the local measures cluster this Mazzone executor will also know how",
    "start": "2133650",
    "end": "2140490"
  },
  {
    "text": "to extract information about it like debugging information about the running job through this custom step this",
    "start": "2140490",
    "end": "2147510"
  },
  {
    "text": "debugging information could be for example where can I find the logs what's the configuration that is being",
    "start": "2147510",
    "end": "2154290"
  },
  {
    "text": "used maybe a link to the SPARC drive or UI so measure on the Mazon executor",
    "start": "2154290",
    "end": "2161160"
  },
  {
    "text": "would then expose this information back to the Mazon scheduler that way we can surface it in our user interface and",
    "start": "2161160",
    "end": "2169500"
  },
  {
    "text": "this communication is being done actually through the missus status updates API which is an API that",
    "start": "2169500",
    "end": "2175290"
  },
  {
    "text": "provides can be seen as a messaging layer somewhere that provides use from",
    "start": "2175290",
    "end": "2180330"
  },
  {
    "text": "delivery guarantees this enabled us in the early stage of Amazon where we",
    "start": "2180330",
    "end": "2185460"
  },
  {
    "text": "didn't have high availability support to to decouple the mizzen executor from the",
    "start": "2185460",
    "end": "2190560"
  },
  {
    "text": "Mazon scheduler imagine a scenario where you are deploying a new version of your scheduler you don't want to kill all",
    "start": "2190560",
    "end": "2195990"
  },
  {
    "text": "your jobs that would be dramatic so you want your job to continue to be running it same for your major executors and by",
    "start": "2195990",
    "end": "2203310"
  },
  {
    "text": "using the steps that this API this is this enables us to do this because basically the the messages will be",
    "start": "2203310",
    "end": "2210270"
  },
  {
    "text": "maintained by a mezzos master until the the framework we'll be able to uh knowledge at them so for example in the",
    "start": "2210270",
    "end": "2217380"
  },
  {
    "text": "case where would apply a new version of Mason once the new version is up with toward reconciliation with the measures",
    "start": "2217380",
    "end": "2224130"
  },
  {
    "text": "and we'll process we receive again the different status updates that we will process and then continue all this did",
    "start": "2224130",
    "end": "2231180"
  },
  {
    "text": "serve us well so far using measures because we provide out of the box a complete liar for our users which makes it much nicer",
    "start": "2231180",
    "end": "2238740"
  },
  {
    "text": "for them to to adapt to adopt basically Amazon because they don't have to provide a",
    "start": "2238740",
    "end": "2244590"
  },
  {
    "text": "separate cluster to run their work actually so before I was referring to",
    "start": "2244590",
    "end": "2250800"
  },
  {
    "text": "Amazon Aurora and that it wasn't always the case that we're using Amazon Aurora so let's well let's see this story",
    "start": "2250800",
    "end": "2259700"
  },
  {
    "text": "initially we're using Cassandra theorem so Cassandra is widely used internally",
    "start": "2259700",
    "end": "2265830"
  },
  {
    "text": "at Netflix and there is a dedicated team and telling the customer clusters they",
    "start": "2265830",
    "end": "2271770"
  },
  {
    "text": "optimize the those clusters and will relieve us from any operational work and",
    "start": "2271770",
    "end": "2277890"
  },
  {
    "text": "they provide some nice drink our initial use of Cassandra was pretty straightforward it was basically a point",
    "start": "2277890",
    "end": "2283710"
  },
  {
    "text": "queries get a workflow by ad modify something right back so it was very simple and for that purpose it were",
    "start": "2283710",
    "end": "2289650"
  },
  {
    "text": "pretty nicely and all the values were stored as part of bytes basically in the",
    "start": "2289650",
    "end": "2294900"
  },
  {
    "text": "database and when we started having like the first times where we want to query the data on some attributes that were",
    "start": "2294900",
    "end": "2302070"
  },
  {
    "text": "part of the protolith message we start creating some custom secondary indexes which are different from the customer",
    "start": "2302070",
    "end": "2308520"
  },
  {
    "text": "actually secondary indexes those are not the same ones so there was just some homemade indexes however our needs",
    "start": "2308520",
    "end": "2317040"
  },
  {
    "text": "started growing and we want to implement some new features that would have benefited a lot from a relational",
    "start": "2317040",
    "end": "2323400"
  },
  {
    "text": "database actually and we're ending up finding ourselves where we we want it to",
    "start": "2323400",
    "end": "2328740"
  },
  {
    "text": "do something but at that point it would require and reshaping entirely our",
    "start": "2328740",
    "end": "2335040"
  },
  {
    "text": "database we want to do aggregations we want to have more flexibly in our queries joins and maintaining those",
    "start": "2335040",
    "end": "2341820"
  },
  {
    "text": "indexes and maintaining that logic on the application side was also too complex we didn't want to do this the",
    "start": "2341820",
    "end": "2348150"
  },
  {
    "text": "other issue was that it was hard to introspect what was in the database as",
    "start": "2348150",
    "end": "2353790"
  },
  {
    "text": "we were storing it as a plane bite and we're so often we needed to use some",
    "start": "2353790",
    "end": "2360210"
  },
  {
    "text": "application code to Disorderlies those in order to to see what's actually stored in the database all the all those",
    "start": "2360210",
    "end": "2368430"
  },
  {
    "text": "things combined with the fact that actually the data set size that we deal with here isn't that big it",
    "start": "2368430",
    "end": "2374490"
  },
  {
    "text": "would fit very well on a single instance we're thinking well maybe it's time to just bite the bullet and migrate over to",
    "start": "2374490",
    "end": "2380220"
  },
  {
    "text": "our rational database so that was a pretty big migration because it was",
    "start": "2380220",
    "end": "2385890"
  },
  {
    "text": "after one year and a half of existence of Mazzone so you can imagine that we had like already a lots of data many",
    "start": "2385890",
    "end": "2391950"
  },
  {
    "text": "different teams using it many different measures on cluster running so that wasn't trivial so that's one we started",
    "start": "2391950",
    "end": "2399930"
  },
  {
    "text": "looking into Amazon RDS mostly because we wanted a service that would provide",
    "start": "2399930",
    "end": "2405210"
  },
  {
    "text": "us at the same convenience as what we had without our Cassandra cluster so RDS",
    "start": "2405210",
    "end": "2413540"
  },
  {
    "text": "for those who are unfamiliar with it is basically Amazon's offering of a Russian database in the cloud and comes out of",
    "start": "2413540",
    "end": "2420210"
  },
  {
    "text": "the box with a lot of tooling that we you will want to have when you are running a production in a database in",
    "start": "2420210",
    "end": "2426720"
  },
  {
    "text": "production at scale and it supports multiple different database engines like",
    "start": "2426720",
    "end": "2434310"
  },
  {
    "text": "the most common ones like or act on my sequel or post-grad and Amazon Aurora which is the actual database",
    "start": "2434310",
    "end": "2440250"
  },
  {
    "text": "implementation that we use Amazon Aurora well outside of being highly performant",
    "start": "2440250",
    "end": "2446550"
  },
  {
    "text": "it's also entirely compatible with Mexico so locally for development for example use my secret but actually in",
    "start": "2446550",
    "end": "2451590"
  },
  {
    "text": "production we have an Aurora cluster and another nice thing is we work and serve",
    "start": "2451590",
    "end": "2458850"
  },
  {
    "text": "actually a high number of concurrent requests and that's something that was",
    "start": "2458850",
    "end": "2464580"
  },
  {
    "text": "important for us because we have many different deployments of nezam that we don't really control and the number of",
    "start": "2464580",
    "end": "2472740"
  },
  {
    "text": "actual concurrent requests could increase and usually when you interact with a database you have a connection",
    "start": "2472740",
    "end": "2478500"
  },
  {
    "text": "pool that for which you control the size and you can tune based on that but in this case we didn't have that",
    "start": "2478500",
    "end": "2484619"
  },
  {
    "text": "granularity of control and we're in a multi-tenant environment so this was a nice feature to have so let's take a",
    "start": "2484619",
    "end": "2493170"
  },
  {
    "text": "look at our current setup so trying to have once in the RDS cluster per region",
    "start": "2493170",
    "end": "2499369"
  },
  {
    "text": "and this or this cluster is basically made of a writer instance that takes all",
    "start": "2499369",
    "end": "2504450"
  },
  {
    "text": "the writes I read correctly and we have a one or really replicas inside the same region but in different available to",
    "start": "2504450",
    "end": "2511680"
  },
  {
    "text": "zones and in case of failover so in case of the main writer failing",
    "start": "2511680",
    "end": "2517680"
  },
  {
    "text": "we've fell over to one the reader replicas we don't share any data between regions for the measure on for the rest",
    "start": "2517680",
    "end": "2525390"
  },
  {
    "text": "of techniques of course but not for a formation and so each Mason deployment",
    "start": "2525390",
    "end": "2531030"
  },
  {
    "text": "that is in a different region is completely isolated and as I was saying before we have many deployments of",
    "start": "2531030",
    "end": "2536310"
  },
  {
    "text": "measure on some apart of large shared clusters that are being used by many teams in production and those cultures",
    "start": "2536310",
    "end": "2543090"
  },
  {
    "text": "are well maintained and the others actually just other clusters that a team did start up for experimentation purpose",
    "start": "2543090",
    "end": "2549330"
  },
  {
    "text": "or just an individual did start it up to play around and this cluster comes actually the measure said it's a missus",
    "start": "2549330",
    "end": "2557640"
  },
  {
    "text": "cluster coming with Mason in it and you can for each of those deployments we",
    "start": "2557640",
    "end": "2563040"
  },
  {
    "text": "actually have one logical database in this artist cluster so basically the largest cluster is split and inside we",
    "start": "2563040",
    "end": "2570210"
  },
  {
    "text": "have basically one database per measure up and those database are being created",
    "start": "2570210",
    "end": "2578580"
  },
  {
    "text": "basically because we don't again we don't really have control on when someone will start a new cluster with",
    "start": "2578580",
    "end": "2584250"
  },
  {
    "text": "measure so and the other thing to note is the fact that we have many concurrent",
    "start": "2584250",
    "end": "2590910"
  },
  {
    "text": "versions of messin means that they all can run different versions we have no control over the version that would run",
    "start": "2590910",
    "end": "2597060"
  },
  {
    "text": "so we need a way to be able to migrate easily from any version to the next one",
    "start": "2597060",
    "end": "2603060"
  },
  {
    "text": "and for that we we had any support automatic database migrations that we",
    "start": "2603060",
    "end": "2608340"
  },
  {
    "text": "currently do it be a Flyway which is an open source library and we defined our",
    "start": "2608340",
    "end": "2613710"
  },
  {
    "text": "schema migration through sequel scripts and data migrations which are the tricky",
    "start": "2613710",
    "end": "2618870"
  },
  {
    "text": "part scalar code and those migrations are being applied at startup when a new",
    "start": "2618870",
    "end": "2624330"
  },
  {
    "text": "instance is being deployed or when a cluster is upgraded one tricky part that",
    "start": "2624330",
    "end": "2630800"
  },
  {
    "text": "in in the scenario where we will do a red-black deployment so during a red-black deployment basically we want",
    "start": "2630800",
    "end": "2637230"
  },
  {
    "text": "to release the new version but we don't want to shut down the entire bring it back up we want first so start",
    "start": "2637230",
    "end": "2643920"
  },
  {
    "text": "deploying the new version but during the bootstrap of the new version the old one is still running and the old one is the",
    "start": "2643920",
    "end": "2650010"
  },
  {
    "text": "active is the active leader for this cluster and the trick part you don't want basically to start applying your",
    "start": "2650010",
    "end": "2656640"
  },
  {
    "text": "migrations while the other one is the activity because otherwise you would break all your production workflows so",
    "start": "2656640",
    "end": "2662160"
  },
  {
    "text": "for this purpose we were integrating also with the leadership election of zookeeper in zookeeper in order to apply",
    "start": "2662160",
    "end": "2669270"
  },
  {
    "text": "the changes only once we become the new leader and then continue to proceed one",
    "start": "2669270",
    "end": "2675390"
  },
  {
    "text": "thing to keep in mind also with those automatic migrations is that that it's not very easy actually to rollback you",
    "start": "2675390",
    "end": "2683099"
  },
  {
    "text": "could roll back up to some extent depending on what type of failure you have but realistically I",
    "start": "2683099",
    "end": "2688910"
  },
  {
    "text": "there are many scenarios where it won't be possible so our solution to that problem it's best to have a testing",
    "start": "2688910",
    "end": "2695579"
  },
  {
    "text": "cluster that always runs the measure and would automatically deploy every version",
    "start": "2695579",
    "end": "2700800"
  },
  {
    "text": "of nizam and that way we can experience actually the different migration issues beforehand so what did we learn from",
    "start": "2700800",
    "end": "2709400"
  },
  {
    "text": "migrating basically from Cassandra - from a key value store to version",
    "start": "2709400",
    "end": "2715079"
  },
  {
    "text": "database well first of all and hopefully we were able to get more flexibility and",
    "start": "2715079",
    "end": "2720810"
  },
  {
    "text": "while querying the database and interacting with it this led us to",
    "start": "2720810",
    "end": "2725880"
  },
  {
    "text": "implement some new features that otherwise would have been freaking and it wasn't without very more operational",
    "start": "2725880",
    "end": "2732210"
  },
  {
    "text": "work on our side which was great also but we learnt also that this the",
    "start": "2732210",
    "end": "2739079"
  },
  {
    "text": "database based cool inference strongly the way you design your software even if you try to provide layers of an",
    "start": "2739079",
    "end": "2745260"
  },
  {
    "text": "abstraction in between inevitably it will leak in some way and that might",
    "start": "2745260",
    "end": "2751470"
  },
  {
    "text": "make it harder when you migrate to actually leverage the the features of",
    "start": "2751470",
    "end": "2756660"
  },
  {
    "text": "the new database so in our case like for the new new features that we're building on top of our days it was easy because",
    "start": "2756660",
    "end": "2763140"
  },
  {
    "text": "it was the new fresh code but for the core part the core logic to migrate it",
    "start": "2763140",
    "end": "2768329"
  },
  {
    "text": "it required actually even more like deep changes in the way we",
    "start": "2768329",
    "end": "2774060"
  },
  {
    "text": "we structure everything so this is something to keep in mind and you probably should be very careful when you",
    "start": "2774060",
    "end": "2780960"
  },
  {
    "text": "pick your database initially so you don't have to do this kind of migration another thing we found that now our",
    "start": "2780960",
    "end": "2787440"
  },
  {
    "text": "interactions with the database pretty rich so we write a lot of code doing",
    "start": "2787440",
    "end": "2792450"
  },
  {
    "text": "fancy stuff with it but it becomes harder to maintain because there starts",
    "start": "2792450",
    "end": "2798210"
  },
  {
    "text": "getting a lot of code that is sometimes a bit boilerplate so we are thinking maybe to use an over em that might",
    "start": "2798210",
    "end": "2804150"
  },
  {
    "text": "simplify our life here the and the last point here is about the lazy migrations",
    "start": "2804150",
    "end": "2809780"
  },
  {
    "text": "lazy migrations are great but it's tricky so if you don't need them don't",
    "start": "2809780",
    "end": "2816060"
  },
  {
    "text": "do them but sometimes you have no choice and one thing to keep in mind when you",
    "start": "2816060",
    "end": "2821340"
  },
  {
    "text": "do this is that you need to maintain old code because you want to be able to migrate from any version to the next one",
    "start": "2821340",
    "end": "2827520"
  },
  {
    "text": "so this means you want to maintain your sequel scripts but when you have data migrations that's very likely to happen",
    "start": "2827520",
    "end": "2833940"
  },
  {
    "text": "and when it is written in like scala Java or Python whatever language you use so in the same language as the rest of",
    "start": "2833940",
    "end": "2841170"
  },
  {
    "text": "your code you will need to maintain that and sometimes this migration logic is tied to some business logic that you are",
    "start": "2841170",
    "end": "2847890"
  },
  {
    "text": "very likely to change in the future and so it's very easy to break actually past migrations so I would suggest you to",
    "start": "2847890",
    "end": "2854820"
  },
  {
    "text": "write a lot of tests for this part so now let's get a bit less technical and",
    "start": "2854820",
    "end": "2860900"
  },
  {
    "text": "yeah another thing that we actually learned also it might seem a bit trivial",
    "start": "2860900",
    "end": "2866720"
  },
  {
    "text": "knowing the user knowing who uses your software how he is using it it's actually something very important it's",
    "start": "2866720",
    "end": "2873570"
  },
  {
    "text": "important to be obsessed with your users and talk to them in order to discover how they use your software and sometimes",
    "start": "2873570",
    "end": "2880380"
  },
  {
    "text": "it can be tricky because you might expect that the user will come to you and tell you hey I don't like this this",
    "start": "2880380",
    "end": "2885420"
  },
  {
    "text": "is not working oh I would imagine that it would be nice to have this feature but it's not always the case sometimes people will accept",
    "start": "2885420",
    "end": "2892320"
  },
  {
    "text": "some inefficiency and some manual work so it's up to you so to sit with them",
    "start": "2892320",
    "end": "2897480"
  },
  {
    "text": "and see how they use your software and from there on try to to see how how you",
    "start": "2897480",
    "end": "2902940"
  },
  {
    "text": "as an engineer you could automate all that process and make their life easier so now let's look how we actually learned",
    "start": "2902940",
    "end": "2909910"
  },
  {
    "text": "this so through the time when trying to work on different features in messin we're trying to improve the skylight DSL",
    "start": "2909910",
    "end": "2916240"
  },
  {
    "text": "to make it much more expressive we're reaching the UI doing fascinating things",
    "start": "2916240",
    "end": "2922630"
  },
  {
    "text": "and we're trying to add advanced features that we thought would be very useful but during all the time action",
    "start": "2922630",
    "end": "2929349"
  },
  {
    "text": "our users had other problems the main problem being the way how you go from local code local workflow",
    "start": "2929349",
    "end": "2936069"
  },
  {
    "text": "definition and local like your spark job or docker container or how you go to production from local to production and",
    "start": "2936069",
    "end": "2943540"
  },
  {
    "text": "this in its simplified here but this implies a lot of things actually how do you do this most for example most open",
    "start": "2943540",
    "end": "2950319"
  },
  {
    "text": "source or were focused search engines leave it up to you to provide the runtime environment it's up to you",
    "start": "2950319",
    "end": "2957130"
  },
  {
    "text": "basically to ship your binaries containing your job code to production so those were promised our users were",
    "start": "2957130",
    "end": "2964030"
  },
  {
    "text": "facing how to deploy the workflow definition to Amazon class or how to make sure the binaries like their jar",
    "start": "2964030",
    "end": "2970329"
  },
  {
    "text": "for example would be present in the Maysles cluster at runtime and we discovered this based by talking with",
    "start": "2970329",
    "end": "2976809"
  },
  {
    "text": "them a lot and trying to understand how they were using our software and not trying to start to expect from them to",
    "start": "2976809",
    "end": "2982480"
  },
  {
    "text": "tell us oh I don't like this I don't like that and our current solution is a",
    "start": "2982480",
    "end": "2987549"
  },
  {
    "text": "solution very focused on our main user base which is on a base that is coding",
    "start": "2987549",
    "end": "2993730"
  },
  {
    "text": "most on the JVM so for them and they use graders at their build system so on this",
    "start": "2993730",
    "end": "2999880"
  },
  {
    "text": "guys will provide a great plugin that will best integrate whether their project and will package everything and",
    "start": "2999880",
    "end": "3005040"
  },
  {
    "text": "deployed the workflow and make sure the banners are available on time automating",
    "start": "3005040",
    "end": "3011849"
  },
  {
    "text": "this part enabled us actually to have a hook also in the in the deployment process so we",
    "start": "3011849",
    "end": "3019680"
  },
  {
    "text": "can actually automatically reach the workflow for the user with some metadata we for example add also information",
    "start": "3019680",
    "end": "3025740"
  },
  {
    "text": "about from what branch does this code calm was the repository that it comes",
    "start": "3025740",
    "end": "3031349"
  },
  {
    "text": "from what they get commit ash and other things so that has been very helpful and",
    "start": "3031349",
    "end": "3037049"
  },
  {
    "text": "it also and automating this process enabled us so tomato also the worst or religious so",
    "start": "3037049",
    "end": "3043469"
  },
  {
    "text": "now every work for deployment to production I mean a release of a workflow is automatic and goes through",
    "start": "3043469",
    "end": "3050249"
  },
  {
    "text": "Jenkins basically when a pull request is being merged a Jenkins pipeline will be triggered and it will run Canary Wharf",
    "start": "3050249",
    "end": "3056279"
  },
  {
    "text": "rose.i Canary Wharf or it is basically the same as the production workflow that you want to deploy except that it works",
    "start": "3056279",
    "end": "3062099"
  },
  {
    "text": "on a subset of the input data so it doesn't run forever and write to another",
    "start": "3062099",
    "end": "3067229"
  },
  {
    "text": "destination than the production one and once this Canary Wharf finishes successfully we proceed on with",
    "start": "3067229",
    "end": "3073619"
  },
  {
    "text": "deploying the production one structure focusing on how the user interacts with",
    "start": "3073619",
    "end": "3079559"
  },
  {
    "text": "our system helped us also discover places where we didn't provide something",
    "start": "3079559",
    "end": "3087539"
  },
  {
    "text": "that was needed and if we in this case it was the user didn't have a way to",
    "start": "3087539",
    "end": "3093650"
  },
  {
    "text": "push back information from within the running code so like from from his Park",
    "start": "3093650",
    "end": "3099479"
  },
  {
    "text": "job for example the user couldn't push back information to Amazon that could be used then in the downstream jobs and we",
    "start": "3099479",
    "end": "3107309"
  },
  {
    "text": "found that basically by providing this actually they would be able to leverage and get much more power from some other",
    "start": "3107309",
    "end": "3113910"
  },
  {
    "text": "advanced features that we have in the system and some of those systems as some of those features are for some the loops",
    "start": "3113910",
    "end": "3119249"
  },
  {
    "text": "off for which you can imagine a first step that would basically where some database does do some processing I get a",
    "start": "3119249",
    "end": "3125459"
  },
  {
    "text": "list of countries then omit this list of countries back to Amazon and then we use a for each step that will iterate",
    "start": "3125459",
    "end": "3132329"
  },
  {
    "text": "through this list of countries and to run a job that would maybe train a model for each of those different countries",
    "start": "3132329",
    "end": "3138509"
  },
  {
    "text": "the other example where we think it can be very helpful and the strong feature",
    "start": "3138509",
    "end": "3144180"
  },
  {
    "text": "for users is the debugging information that you've seen before and the David's",
    "start": "3144180",
    "end": "3149640"
  },
  {
    "text": "also research it a bit that would describe basically a link to that will",
    "start": "3149640",
    "end": "3157920"
  },
  {
    "text": "be an URL to a job or could be an image that represents a graph represent the",
    "start": "3157920",
    "end": "3163920"
  },
  {
    "text": "validation metrics of your model maybe so this kind of information now can be",
    "start": "3163920",
    "end": "3169499"
  },
  {
    "text": "emitted back from the user code and then they can customize and face the information they want directly",
    "start": "3169499",
    "end": "3176720"
  },
  {
    "text": "in the missile UI so this is something we are currently working actively on and",
    "start": "3176720",
    "end": "3184300"
  },
  {
    "text": "also as Mason has been very widely adopted internally this year and will",
    "start": "3184300",
    "end": "3189500"
  },
  {
    "text": "continue to be so we also want to make sure that action is on scales scaling",
    "start": "3189500",
    "end": "3195440"
  },
  {
    "text": "not only from a performance point of view but also scaling in supporting all the different use cases that come in we",
    "start": "3195440",
    "end": "3202339"
  },
  {
    "text": "also want to improve the integration and make a tighter integration with a user code at runtime the additional context",
    "start": "3202339",
    "end": "3208280"
  },
  {
    "text": "and we also want to choose supermost officiate by plans that integrate better",
    "start": "3208280",
    "end": "3214790"
  },
  {
    "text": "with machine learning usages so and",
    "start": "3214790",
    "end": "3219849"
  },
  {
    "text": "there are a few other talks that our peers from Netflix are giving so I",
    "start": "3219849",
    "end": "3224900"
  },
  {
    "text": "invite you to check them out I hope that you learned one or two things from this presentation and if you have any",
    "start": "3224900",
    "end": "3232460"
  },
  {
    "text": "questions it's the moment [Applause]",
    "start": "3232460",
    "end": "3239660"
  },
  {
    "text": "as I mentioned earlier on not we also are at the Netflix booth number 136 from",
    "start": "3242250",
    "end": "3250210"
  },
  {
    "text": "1 to 2 p.m. if you wanna learn about Mason or other questions about things that we do you're more than welcome and",
    "start": "3250210",
    "end": "3256480"
  },
  {
    "text": "we're gonna hang out for here for a few more minutes thank you",
    "start": "3256480",
    "end": "3261420"
  }
]