[
  {
    "text": "hey everyone this is Kabal jit KMI",
    "start": "4759",
    "end": "6279"
  },
  {
    "text": "working as principal AML specialist",
    "start": "6279",
    "end": "7879"
  },
  {
    "text": "Solutions architect in this session we",
    "start": "7879",
    "end": "9760"
  },
  {
    "text": "will discuss one of the recommended best",
    "start": "9760",
    "end": "11320"
  },
  {
    "text": "practices to prepare a large data set to",
    "start": "11320",
    "end": "13240"
  },
  {
    "text": "pre-train a generative V Foundation",
    "start": "13240",
    "end": "14799"
  },
  {
    "text": "model using Amazon stemer so with that",
    "start": "14799",
    "end": "17439"
  },
  {
    "text": "let us get started so let us drive this",
    "start": "17439",
    "end": "19880"
  },
  {
    "text": "discussion uh with the use case and the",
    "start": "19880",
    "end": "21279"
  },
  {
    "text": "requirements are we want to create a",
    "start": "21279",
    "end": "22600"
  },
  {
    "text": "framework uh which could process a data",
    "start": "22600",
    "end": "25439"
  },
  {
    "text": "set which is in gigabytes or terabytes",
    "start": "25439",
    "end": "26840"
  },
  {
    "text": "in size we want to save the process data",
    "start": "26840",
    "end": "28720"
  },
  {
    "text": "in a persistent storage for f analysis",
    "start": "28720",
    "end": "30920"
  },
  {
    "text": "and we want to pre-train a model from",
    "start": "30920",
    "end": "33000"
  },
  {
    "text": "scratch and we'll take Falcon as an",
    "start": "33000",
    "end": "34360"
  },
  {
    "text": "example and pass this processed data to",
    "start": "34360",
    "end": "36680"
  },
  {
    "text": "this training cluster through a high",
    "start": "36680",
    "end": "38320"
  },
  {
    "text": "performance file system and what we need",
    "start": "38320",
    "end": "40320"
  },
  {
    "text": "from this solution uh we need a manage",
    "start": "40320",
    "end": "42200"
  },
  {
    "text": "experience where we could quickly spin",
    "start": "42200",
    "end": "43719"
  },
  {
    "text": "up a development environment for data",
    "start": "43719",
    "end": "45120"
  },
  {
    "text": "processing and Analysis uh we need the",
    "start": "45120",
    "end": "47320"
  },
  {
    "text": "flexibility in the choice of compute and",
    "start": "47320",
    "end": "49760"
  },
  {
    "text": "machine learning Frameworks or libraries",
    "start": "49760",
    "end": "51680"
  },
  {
    "text": "and we need a high performance system",
    "start": "51680",
    "end": "52960"
  },
  {
    "text": "which could be optimized for cost so let",
    "start": "52960",
    "end": "55719"
  },
  {
    "text": "us take a step-by-step approach to this",
    "start": "55719",
    "end": "57760"
  },
  {
    "text": "solution in step one uh we will spin up",
    "start": "57760",
    "end": "60559"
  },
  {
    "text": "uh Sage piaker Studio Jupiter lab",
    "start": "60559",
    "end": "63120"
  },
  {
    "text": "notebook environment uh you can use this",
    "start": "63120",
    "end": "64559"
  },
  {
    "text": "environment to analyze and process a",
    "start": "64559",
    "end": "66920"
  },
  {
    "text": "smaller data set however when you are",
    "start": "66920",
    "end": "69040"
  },
  {
    "text": "working with a logic data set that's",
    "start": "69040",
    "end": "70600"
  },
  {
    "text": "when you want to process that at scale",
    "start": "70600",
    "end": "73360"
  },
  {
    "text": "right and we will be using sagemaker job",
    "start": "73360",
    "end": "75320"
  },
  {
    "text": "parallelism here now using this uh",
    "start": "75320",
    "end": "77799"
  },
  {
    "text": "concept you can spend a multiple",
    "start": "77799",
    "end": "79159"
  },
  {
    "text": "stagemaker jobs each job running one or",
    "start": "79159",
    "end": "81680"
  },
  {
    "text": "more instances and we'll use FSX for",
    "start": "81680",
    "end": "84240"
  },
  {
    "text": "luster file system as a file system",
    "start": "84240",
    "end": "86680"
  },
  {
    "text": "attached to these nodes now FSX for",
    "start": "86680",
    "end": "89079"
  },
  {
    "text": "luster is a managed shared storage uh",
    "start": "89079",
    "end": "91960"
  },
  {
    "text": "which offers um scalability and",
    "start": "91960",
    "end": "93799"
  },
  {
    "text": "performance of the popular luster file",
    "start": "93799",
    "end": "95479"
  },
  {
    "text": "system and it provides hundreds of Gaby",
    "start": "95479",
    "end": "98520"
  },
  {
    "text": "per second of throughput and millions of",
    "start": "98520",
    "end": "100360"
  },
  {
    "text": "iops exactly what we need in this use",
    "start": "100360",
    "end": "103439"
  },
  {
    "text": "case we will use hugging face data set",
    "start": "103439",
    "end": "106159"
  },
  {
    "text": "C4 um which is a common craw Corpus data",
    "start": "106159",
    "end": "109960"
  },
  {
    "text": "set created by Allen AI uh this data set",
    "start": "109960",
    "end": "112600"
  },
  {
    "text": "is clean D duplicated um and is commonly",
    "start": "112600",
    "end": "115520"
  },
  {
    "text": "used to process large language model uh",
    "start": "115520",
    "end": "117960"
  },
  {
    "text": "now hugging fa C4 uh shorts it data set",
    "start": "117960",
    "end": "121039"
  },
  {
    "text": "into multiple different files and we",
    "start": "121039",
    "end": "122880"
  },
  {
    "text": "will process those files in batches U",
    "start": "122880",
    "end": "125840"
  },
  {
    "text": "with the sagemaker job um that we have",
    "start": "125840",
    "end": "128080"
  },
  {
    "text": "spun up and every job will be processing",
    "start": "128080",
    "end": "129720"
  },
  {
    "text": "its own uh batch of data and once they",
    "start": "129720",
    "end": "132319"
  },
  {
    "text": "are done with processing each job will",
    "start": "132319",
    "end": "134599"
  },
  {
    "text": "save those batches as a data set uh in",
    "start": "134599",
    "end": "137840"
  },
  {
    "text": "the arrow",
    "start": "137840",
    "end": "138840"
  },
  {
    "text": "format now FSX for luster could be",
    "start": "138840",
    "end": "141440"
  },
  {
    "text": "linked with S3 as well S3 is a simple",
    "start": "141440",
    "end": "144080"
  },
  {
    "text": "storage service and uh we could link FSX",
    "start": "144080",
    "end": "147480"
  },
  {
    "text": "using data access repositories and once",
    "start": "147480",
    "end": "149319"
  },
  {
    "text": "you do that any changes that you make to",
    "start": "149319",
    "end": "151440"
  },
  {
    "text": "the FSX for luster file system will",
    "start": "151440",
    "end": "153560"
  },
  {
    "text": "automatically be synced up with",
    "start": "153560",
    "end": "155840"
  },
  {
    "text": "S3 and then we will Mount the same FSX",
    "start": "155840",
    "end": "159400"
  },
  {
    "text": "luster which is already pre-warmed with",
    "start": "159400",
    "end": "160959"
  },
  {
    "text": "our process data to the training cluster",
    "start": "160959",
    "end": "163440"
  },
  {
    "text": "where every noting that cluster will",
    "start": "163440",
    "end": "165519"
  },
  {
    "text": "have access to that mounted of local",
    "start": "165519",
    "end": "168440"
  },
  {
    "text": "folder and the data set that we have",
    "start": "168440",
    "end": "170680"
  },
  {
    "text": "processed we will concatenate that",
    "start": "170680",
    "end": "172400"
  },
  {
    "text": "together into one big data set and we'll",
    "start": "172400",
    "end": "174239"
  },
  {
    "text": "use pytorch fstp libraries to run our",
    "start": "174239",
    "end": "178040"
  },
  {
    "text": "training in a distributed fashion so so",
    "start": "178040",
    "end": "179959"
  },
  {
    "text": "with that uh let us see this demo in",
    "start": "179959",
    "end": "182200"
  },
  {
    "text": "action okay uh let's look at the hugging",
    "start": "182200",
    "end": "184319"
  },
  {
    "text": "face data set first right so this is the",
    "start": "184319",
    "end": "186159"
  },
  {
    "text": "Len AI C4 data set and if you see uh we",
    "start": "186159",
    "end": "188920"
  },
  {
    "text": "have 1,24 shots so there are 1,24 files",
    "start": "188920",
    "end": "193120"
  },
  {
    "text": "uh that we could process um in batches",
    "start": "193120",
    "end": "195680"
  },
  {
    "text": "now next step is let's create uh and see",
    "start": "195680",
    "end": "198080"
  },
  {
    "text": "an FSX for luster file system so I go to",
    "start": "198080",
    "end": "201120"
  },
  {
    "text": "a console and you can um go to FSX for",
    "start": "201120",
    "end": "204280"
  },
  {
    "text": "luster using the search bar uh we have",
    "start": "204280",
    "end": "206400"
  },
  {
    "text": "already created a file system let's",
    "start": "206400",
    "end": "207799"
  },
  {
    "text": "quickly look at the key parameters in",
    "start": "207799",
    "end": "209280"
  },
  {
    "text": "that file system",
    "start": "209280",
    "end": "211239"
  },
  {
    "text": "system so um once you create the FSX for",
    "start": "211239",
    "end": "214120"
  },
  {
    "text": "ler file system U this will create a",
    "start": "214120",
    "end": "216680"
  },
  {
    "text": "unique ID which will uniquely identify",
    "start": "216680",
    "end": "218640"
  },
  {
    "text": "this file system uh it will also create",
    "start": "218640",
    "end": "220799"
  },
  {
    "text": "a mount name uh which you will use to",
    "start": "220799",
    "end": "222720"
  },
  {
    "text": "mount this file system to an ec2 node or",
    "start": "222720",
    "end": "225159"
  },
  {
    "text": "to the sagemaker training cluster uh you",
    "start": "225159",
    "end": "227959"
  },
  {
    "text": "can Define your storage capacity when",
    "start": "227959",
    "end": "229680"
  },
  {
    "text": "you create it and you can change that",
    "start": "229680",
    "end": "230920"
  },
  {
    "text": "later and same applies to throughput and",
    "start": "230920",
    "end": "233640"
  },
  {
    "text": "there is a network configuration that",
    "start": "233640",
    "end": "235200"
  },
  {
    "text": "you will specify when you create uh this",
    "start": "235200",
    "end": "237239"
  },
  {
    "text": "file system uh the VPC and subnet a",
    "start": "237239",
    "end": "240040"
  },
  {
    "text": "quick tip here uh make sure that your",
    "start": "240040",
    "end": "242000"
  },
  {
    "text": "FSX file system is created in the same",
    "start": "242000",
    "end": "244000"
  },
  {
    "text": "subnet where you'll be running your",
    "start": "244000",
    "end": "245360"
  },
  {
    "text": "sagemaker training cluster so that they",
    "start": "245360",
    "end": "247319"
  },
  {
    "text": "can stay close to each other or giving",
    "start": "247319",
    "end": "248920"
  },
  {
    "text": "you the low lowest latency in your",
    "start": "248920",
    "end": "250560"
  },
  {
    "text": "training run one other thing um is the",
    "start": "250560",
    "end": "253760"
  },
  {
    "text": "data repository that we have talked",
    "start": "253760",
    "end": "255120"
  },
  {
    "text": "about here we have created a data",
    "start": "255120",
    "end": "257759"
  },
  {
    "text": "repository and mapped a file system path",
    "start": "257759",
    "end": "260959"
  },
  {
    "text": "/ C4 to an S3 location right we'll use",
    "start": "260959",
    "end": "265280"
  },
  {
    "text": "this path to access the data that we",
    "start": "265280",
    "end": "267520"
  },
  {
    "text": "have processed in our training cluster",
    "start": "267520",
    "end": "271400"
  },
  {
    "text": "so with that we will uh Now quickly look",
    "start": "271400",
    "end": "273880"
  },
  {
    "text": "uh at the stagemaker studio and we'll",
    "start": "273880",
    "end": "275440"
  },
  {
    "text": "spin up our jbor lab application to",
    "start": "275440",
    "end": "277800"
  },
  {
    "text": "start data",
    "start": "277800",
    "end": "280120"
  },
  {
    "text": "processing now sagemaker studio is a",
    "start": "280120",
    "end": "282360"
  },
  {
    "text": "web- based ID environment uh which",
    "start": "282360",
    "end": "284520"
  },
  {
    "text": "provides purpose buil tools for data",
    "start": "284520",
    "end": "286759"
  },
  {
    "text": "preparation model building training",
    "start": "286759",
    "end": "288360"
  },
  {
    "text": "deployment and many more we'll be using",
    "start": "288360",
    "end": "290360"
  },
  {
    "text": "the Jupiter lab application of sbaker",
    "start": "290360",
    "end": "292880"
  },
  {
    "text": "studio so you click on this link and",
    "start": "292880",
    "end": "295440"
  },
  {
    "text": "this will take you to this page where",
    "start": "295440",
    "end": "297240"
  },
  {
    "text": "you can create multiple different",
    "start": "297240",
    "end": "299120"
  },
  {
    "text": "Jupiter spaces every space is private to",
    "start": "299120",
    "end": "301840"
  },
  {
    "text": "your studio environment and it manages",
    "start": "301840",
    "end": "304160"
  },
  {
    "text": "the compute um and storage resources for",
    "start": "304160",
    "end": "306520"
  },
  {
    "text": "you and uh we will click on this open",
    "start": "306520",
    "end": "308680"
  },
  {
    "text": "link and this will uh spin up a Jupiter",
    "start": "308680",
    "end": "312919"
  },
  {
    "text": "lab okay so we are on the Jupiter lab uh",
    "start": "312960",
    "end": "316199"
  },
  {
    "text": "notebook here and we're going to run",
    "start": "316199",
    "end": "319080"
  },
  {
    "text": "this so to start with uh we will be uh",
    "start": "319080",
    "end": "322960"
  },
  {
    "text": "importing certain dependencies that we",
    "start": "322960",
    "end": "324639"
  },
  {
    "text": "will run to uh we will need to run this",
    "start": "324639",
    "end": "327080"
  },
  {
    "text": "uh Jupiter notebook uh we'll be working",
    "start": "327080",
    "end": "329840"
  },
  {
    "text": "with sagemaker python SDK now this is a",
    "start": "329840",
    "end": "331639"
  },
  {
    "text": "high level abstraction uh which U helps",
    "start": "331639",
    "end": "334880"
  },
  {
    "text": "you interact with sagemaker and one of",
    "start": "334880",
    "end": "336680"
  },
  {
    "text": "the key components of that SDK is",
    "start": "336680",
    "end": "338360"
  },
  {
    "text": "sagemaker session right here uh",
    "start": "338360",
    "end": "340319"
  },
  {
    "text": "sagemaker session allows you to interact",
    "start": "340319",
    "end": "342720"
  },
  {
    "text": "with sagemaker apis in a very abstract",
    "start": "342720",
    "end": "346080"
  },
  {
    "text": "way and um as we have discussed we will",
    "start": "346080",
    "end": "348639"
  },
  {
    "text": "be using Falcon 7B model in this example",
    "start": "348639",
    "end": "351440"
  },
  {
    "text": "uh this is a model created by Technology",
    "start": "351440",
    "end": "353479"
  },
  {
    "text": "Innovation Institute one of the very",
    "start": "353479",
    "end": "355199"
  },
  {
    "text": "popular models of this time",
    "start": "355199",
    "end": "359440"
  },
  {
    "text": "so the step one is uh we will use a",
    "start": "361000",
    "end": "363120"
  },
  {
    "text": "utility function uh where we will feed",
    "start": "363120",
    "end": "365160"
  },
  {
    "text": "in as parameters the number of split",
    "start": "365160",
    "end": "367599"
  },
  {
    "text": "files which is24 as we have seen and we",
    "start": "367599",
    "end": "370880"
  },
  {
    "text": "have decided randomly in this demo there",
    "start": "370880",
    "end": "373560"
  },
  {
    "text": "will 15 workers that will be working on",
    "start": "373560",
    "end": "375520"
  },
  {
    "text": "those split files in parallel now this",
    "start": "375520",
    "end": "378960"
  },
  {
    "text": "uh function will create a list of 15 uh",
    "start": "378960",
    "end": "382880"
  },
  {
    "text": "batches where every batch is of size",
    "start": "382880",
    "end": "385840"
  },
  {
    "text": "68 so so we will be spinning up 15",
    "start": "385840",
    "end": "388360"
  },
  {
    "text": "stemer jobs uh we be mounting FSX for",
    "start": "388360",
    "end": "391039"
  },
  {
    "text": "luster to each one of those and each job",
    "start": "391039",
    "end": "393319"
  },
  {
    "text": "will be processing a batch of 68 files",
    "start": "393319",
    "end": "396000"
  },
  {
    "text": "in",
    "start": "396000",
    "end": "397560"
  },
  {
    "text": "parallel and um the way you will",
    "start": "397560",
    "end": "400440"
  },
  {
    "text": "configure FSX for luster in this case is",
    "start": "400440",
    "end": "403599"
  },
  {
    "text": "you will use file system input uh API",
    "start": "403599",
    "end": "406360"
  },
  {
    "text": "here uh this is the API which will allow",
    "start": "406360",
    "end": "408280"
  },
  {
    "text": "you to um use FSX as a data source uh",
    "start": "408280",
    "end": "411759"
  },
  {
    "text": "for Saker training runs and you would",
    "start": "411759",
    "end": "414800"
  },
  {
    "text": "need the mount name and the file system",
    "start": "414800",
    "end": "417199"
  },
  {
    "text": "path that we have connected to S3 and",
    "start": "417199",
    "end": "420240"
  },
  {
    "text": "you would need the unique ID that will",
    "start": "420240",
    "end": "422479"
  },
  {
    "text": "identify what file system you'll be",
    "start": "422479",
    "end": "424000"
  },
  {
    "text": "working with right and then you will",
    "start": "424000",
    "end": "426800"
  },
  {
    "text": "create a data Channel which you will",
    "start": "426800",
    "end": "428400"
  },
  {
    "text": "pass on to the sagemaker training",
    "start": "428400",
    "end": "431240"
  },
  {
    "text": "cluster okay now before we spin up 15",
    "start": "431240",
    "end": "434319"
  },
  {
    "text": "different jobs we will just try out with",
    "start": "434319",
    "end": "436160"
  },
  {
    "text": "one job and we'll see if it runs",
    "start": "436160",
    "end": "437879"
  },
  {
    "text": "successfully right so there is a for",
    "start": "437879",
    "end": "439560"
  },
  {
    "text": "Loop here and we have intentionally",
    "start": "439560",
    "end": "441759"
  },
  {
    "text": "running it for one job and we'll be",
    "start": "441759",
    "end": "443400"
  },
  {
    "text": "passing on 68 split files for that job",
    "start": "443400",
    "end": "446039"
  },
  {
    "text": "to process few key things here um we",
    "start": "446039",
    "end": "449240"
  },
  {
    "text": "will uh first create uh the",
    "start": "449240",
    "end": "450960"
  },
  {
    "text": "hyperparameters here we are specifying",
    "start": "450960",
    "end": "453120"
  },
  {
    "text": "the number of processes that we want to",
    "start": "453120",
    "end": "454960"
  },
  {
    "text": "run in parallel to work on data",
    "start": "454960",
    "end": "457240"
  },
  {
    "text": "processing now we'll be using M5 24x",
    "start": "457240",
    "end": "460039"
  },
  {
    "text": "large instance which comes with 96 vcpus",
    "start": "460039",
    "end": "463199"
  },
  {
    "text": "and we are just defining that we want",
    "start": "463199",
    "end": "465280"
  },
  {
    "text": "our thread for every",
    "start": "465280",
    "end": "467639"
  },
  {
    "text": "CPU we'll pass on the split range which",
    "start": "467639",
    "end": "470039"
  },
  {
    "text": "is uh 68 in this case and the job name",
    "start": "470039",
    "end": "473120"
  },
  {
    "text": "that will help us identify the specific",
    "start": "473120",
    "end": "475000"
  },
  {
    "text": "job uh and browse the FSX uh later on",
    "start": "475000",
    "end": "477720"
  },
  {
    "text": "after the job is completed",
    "start": "477720",
    "end": "480360"
  },
  {
    "text": "okay now after that uh we uh have the",
    "start": "480360",
    "end": "482120"
  },
  {
    "text": "pytorch estimator uh now this is an API",
    "start": "482120",
    "end": "484680"
  },
  {
    "text": "which does couple of things for you",
    "start": "484680",
    "end": "486240"
  },
  {
    "text": "first thing is it helps you spin up a",
    "start": "486240",
    "end": "488080"
  },
  {
    "text": "training cluster as specified um in the",
    "start": "488080",
    "end": "491319"
  },
  {
    "text": "configuration so we are saying that we",
    "start": "491319",
    "end": "494280"
  },
  {
    "text": "want one instance to be spun up which is",
    "start": "494280",
    "end": "496599"
  },
  {
    "text": "of type M5 24x large sagemaker will",
    "start": "496599",
    "end": "499879"
  },
  {
    "text": "handle the setup and management of this",
    "start": "499879",
    "end": "501400"
  },
  {
    "text": "cluster uh which brings down your total",
    "start": "501400",
    "end": "503479"
  },
  {
    "text": "cost of ownership and secondly this will",
    "start": "503479",
    "end": "506599"
  },
  {
    "text": "also provide you with the pre-built",
    "start": "506599",
    "end": "508280"
  },
  {
    "text": "containers managed by stage maker which",
    "start": "508280",
    "end": "510400"
  },
  {
    "text": "you can specify using the framework",
    "start": "510400",
    "end": "512399"
  },
  {
    "text": "version and python version now these",
    "start": "512399",
    "end": "514880"
  },
  {
    "text": "containers are optimized um they have",
    "start": "514880",
    "end": "517760"
  },
  {
    "text": "the compiled version of py torge",
    "start": "517760",
    "end": "519839"
  },
  {
    "text": "framework and the related dependencies",
    "start": "519839",
    "end": "522159"
  },
  {
    "text": "it has CPU libraries GPU libraries CA",
    "start": "522159",
    "end": "524800"
  },
  {
    "text": "stack uh the network stack which allows",
    "start": "524800",
    "end": "527680"
  },
  {
    "text": "uh different nodes in your cluster to",
    "start": "527680",
    "end": "529440"
  },
  {
    "text": "communicate with each other so if you",
    "start": "529440",
    "end": "531080"
  },
  {
    "text": "see there are a lot of libraries that",
    "start": "531080",
    "end": "532279"
  },
  {
    "text": "kind of um plays out when you run a",
    "start": "532279",
    "end": "534839"
  },
  {
    "text": "multi-node training and you don't have",
    "start": "534839",
    "end": "536519"
  },
  {
    "text": "to worry about that U sagemaker Already",
    "start": "536519",
    "end": "538399"
  },
  {
    "text": "handles that in in the pre-built",
    "start": "538399",
    "end": "540000"
  },
  {
    "text": "containers and you can focus on your",
    "start": "540000",
    "end": "541680"
  },
  {
    "text": "code right and you can pass on that Co",
    "start": "541680",
    "end": "543959"
  },
  {
    "text": "code to these uh training clusters as an",
    "start": "543959",
    "end": "546200"
  },
  {
    "text": "entry point right here right so data.",
    "start": "546200",
    "end": "548920"
  },
  {
    "text": "python file is the one that I have",
    "start": "548920",
    "end": "550240"
  },
  {
    "text": "already created and I'm passing on to",
    "start": "550240",
    "end": "552360"
  },
  {
    "text": "this training so that our cluster can",
    "start": "552360",
    "end": "554120"
  },
  {
    "text": "process",
    "start": "554120",
    "end": "555320"
  },
  {
    "text": "that before we go further let's quickly",
    "start": "555320",
    "end": "557800"
  },
  {
    "text": "look at this data. python",
    "start": "557800",
    "end": "561079"
  },
  {
    "text": "file few key things in this file um we",
    "start": "561079",
    "end": "563880"
  },
  {
    "text": "will uh use the create batch function",
    "start": "563880",
    "end": "565680"
  },
  {
    "text": "which will batch will create the batches",
    "start": "565680",
    "end": "568160"
  },
  {
    "text": "of the actual file names",
    "start": "568160",
    "end": "569959"
  },
  {
    "text": "uh we will download the data set using",
    "start": "569959",
    "end": "571320"
  },
  {
    "text": "hugging face low data set API right here",
    "start": "571320",
    "end": "574440"
  },
  {
    "text": "uh we will pass on that split range uh",
    "start": "574440",
    "end": "576640"
  },
  {
    "text": "the list of files that we want to",
    "start": "576640",
    "end": "578600"
  },
  {
    "text": "download and this is a multiprocess",
    "start": "578600",
    "end": "580880"
  },
  {
    "text": "environment so we will um mention how",
    "start": "580880",
    "end": "583000"
  },
  {
    "text": "many processors we want to spun up uh to",
    "start": "583000",
    "end": "584920"
  },
  {
    "text": "do this activity and the cache directory",
    "start": "584920",
    "end": "587279"
  },
  {
    "text": "where we want to save our data set and",
    "start": "587279",
    "end": "589000"
  },
  {
    "text": "cach it now a quick note here make sure",
    "start": "589000",
    "end": "591360"
  },
  {
    "text": "that your cache directory is mentioned u",
    "start": "591360",
    "end": "594160"
  },
  {
    "text": "in the file system FSX file system and",
    "start": "594160",
    "end": "595760"
  },
  {
    "text": "not the local directory in your computer",
    "start": "595760",
    "end": "598079"
  },
  {
    "text": "instance and then then we will uh",
    "start": "598079",
    "end": "600560"
  },
  {
    "text": "pre-process data set we will use hugging",
    "start": "600560",
    "end": "602880"
  },
  {
    "text": "phas tokenizer to tokenize our data uh",
    "start": "602880",
    "end": "605360"
  },
  {
    "text": "using data set. map function and once",
    "start": "605360",
    "end": "607440"
  },
  {
    "text": "the data set is tokenized we want to um",
    "start": "607440",
    "end": "610560"
  },
  {
    "text": "use a particular function in the partial",
    "start": "610560",
    "end": "612480"
  },
  {
    "text": "mode to map that tokens to a specific",
    "start": "612480",
    "end": "615640"
  },
  {
    "text": "sequence length so we are using 2048 um",
    "start": "615640",
    "end": "617959"
  },
  {
    "text": "as the batch size here which will be",
    "start": "617959",
    "end": "620640"
  },
  {
    "text": "handled by this group text function so",
    "start": "620640",
    "end": "622959"
  },
  {
    "text": "with that we'll quickly move back to our",
    "start": "622959",
    "end": "625880"
  },
  {
    "text": "notebook so once you have defined this",
    "start": "625880",
    "end": "628040"
  },
  {
    "text": "estimator uh you will call call the fit",
    "start": "628040",
    "end": "630160"
  },
  {
    "text": "function to spin up your training",
    "start": "630160",
    "end": "633079"
  },
  {
    "text": "cluster right we have kept a weight flag",
    "start": "633079",
    "end": "635920"
  },
  {
    "text": "here to set a true which means we will",
    "start": "635920",
    "end": "638000"
  },
  {
    "text": "wait for that execution to end and all",
    "start": "638000",
    "end": "641399"
  },
  {
    "text": "the output that your container will emit",
    "start": "641399",
    "end": "643279"
  },
  {
    "text": "will be uh will be emitted here right",
    "start": "643279",
    "end": "645920"
  },
  {
    "text": "right down the cell okay so if we look",
    "start": "645920",
    "end": "648680"
  },
  {
    "text": "at the",
    "start": "648680",
    "end": "649600"
  },
  {
    "text": "output we'll see uh that we are",
    "start": "649600",
    "end": "651760"
  },
  {
    "text": "downloading the",
    "start": "651760",
    "end": "652959"
  },
  {
    "text": "data we are generating train split uh we",
    "start": "652959",
    "end": "656440"
  },
  {
    "text": "are running a tokenizer on the data set",
    "start": "656440",
    "end": "657920"
  },
  {
    "text": "to create tokens",
    "start": "657920",
    "end": "660519"
  },
  {
    "text": "and finally we will map the data set to",
    "start": "660519",
    "end": "665600"
  },
  {
    "text": "the coups of 2048 uh sequence length and",
    "start": "665600",
    "end": "669000"
  },
  {
    "text": "save the data set to the fs luster file",
    "start": "669000",
    "end": "672880"
  },
  {
    "text": "system so once we have seen that our",
    "start": "672880",
    "end": "675519"
  },
  {
    "text": "single job is running successfully uh",
    "start": "675519",
    "end": "677959"
  },
  {
    "text": "then we will uh run a for Loop to spin",
    "start": "677959",
    "end": "681360"
  },
  {
    "text": "up 15 different jobs that can work on",
    "start": "681360",
    "end": "683519"
  },
  {
    "text": "their own batches in",
    "start": "683519",
    "end": "685519"
  },
  {
    "text": "parall okay so we'll use the same for",
    "start": "685519",
    "end": "687720"
  },
  {
    "text": "Loop uh we'll call estimated function",
    "start": "687720",
    "end": "690079"
  },
  {
    "text": "and every um single function call Will",
    "start": "690079",
    "end": "692360"
  },
  {
    "text": "spin up one job and we are passing a",
    "start": "692360",
    "end": "694639"
  },
  {
    "text": "flag weight is equal to false here uh",
    "start": "694639",
    "end": "696959"
  },
  {
    "text": "which will not wait for the cluster to",
    "start": "696959",
    "end": "700040"
  },
  {
    "text": "ex to complete the run and this will",
    "start": "700040",
    "end": "702480"
  },
  {
    "text": "happen in the background and you can",
    "start": "702480",
    "end": "703519"
  },
  {
    "text": "track the execution of all of these uh",
    "start": "703519",
    "end": "705360"
  },
  {
    "text": "sagemaker jobs um either through",
    "start": "705360",
    "end": "707519"
  },
  {
    "text": "sagemaker con console um or through",
    "start": "707519",
    "end": "710000"
  },
  {
    "text": "sagemaker Studio web ID",
    "start": "710000",
    "end": "712839"
  },
  {
    "text": "interface okay now once uh the data set",
    "start": "712839",
    "end": "715880"
  },
  {
    "text": "is prepared and saved to the FSX file",
    "start": "715880",
    "end": "718120"
  },
  {
    "text": "system then you can browse data set in",
    "start": "718120",
    "end": "720240"
  },
  {
    "text": "one way where you can create a smaller",
    "start": "720240",
    "end": "723279"
  },
  {
    "text": "E2 instance and you can mount FSX on",
    "start": "723279",
    "end": "726320"
  },
  {
    "text": "that instance and then you can SSH to",
    "start": "726320",
    "end": "728000"
  },
  {
    "text": "that instance to see if the data set",
    "start": "728000",
    "end": "729760"
  },
  {
    "text": "created is in the right format and the",
    "start": "729760",
    "end": "731519"
  },
  {
    "text": "directory structure is something that",
    "start": "731519",
    "end": "733160"
  },
  {
    "text": "you",
    "start": "733160",
    "end": "735160"
  },
  {
    "text": "expect cool so once we have prepared",
    "start": "735160",
    "end": "737519"
  },
  {
    "text": "data set now we are in the Second Step",
    "start": "737519",
    "end": "739000"
  },
  {
    "text": "where we'll be pre-training Falcon 7B",
    "start": "739000",
    "end": "741000"
  },
  {
    "text": "model right and uh you know the",
    "start": "741000",
    "end": "743560"
  },
  {
    "text": "similarly what we did in the in the in",
    "start": "743560",
    "end": "745720"
  },
  {
    "text": "the previous case we will create our",
    "start": "745720",
    "end": "747279"
  },
  {
    "text": "hyper parameters first where we will",
    "start": "747279",
    "end": "748600"
  },
  {
    "text": "pass on all the variables that our",
    "start": "748600",
    "end": "750399"
  },
  {
    "text": "training script would need uh like model",
    "start": "750399",
    "end": "752880"
  },
  {
    "text": "ID um gradient checkpointing if you if",
    "start": "752880",
    "end": "755480"
  },
  {
    "text": "you need that uh the fstp W policy uh",
    "start": "755480",
    "end": "758720"
  },
  {
    "text": "the maximum number of steps that you",
    "start": "758720",
    "end": "760079"
  },
  {
    "text": "want to run and then pass on that hyper",
    "start": "760079",
    "end": "763399"
  },
  {
    "text": "parameter to the pytorch",
    "start": "763399",
    "end": "765279"
  },
  {
    "text": "estimator right and here we have",
    "start": "765279",
    "end": "767360"
  },
  {
    "text": "specified that we want to spend up a",
    "start": "767360",
    "end": "768600"
  },
  {
    "text": "cluster of two p4d 24x large",
    "start": "768600",
    "end": "772000"
  },
  {
    "text": "instances",
    "start": "772000",
    "end": "774240"
  },
  {
    "text": "okay so here FSX for luster will be",
    "start": "774240",
    "end": "777440"
  },
  {
    "text": "mounted to each of these training nodes",
    "start": "777440",
    "end": "779440"
  },
  {
    "text": "as well uh which we will pass on as a",
    "start": "779440",
    "end": "782440"
  },
  {
    "text": "data channel to our estimator F function",
    "start": "782440",
    "end": "784880"
  },
  {
    "text": "and here we kept a weight flag to true",
    "start": "784880",
    "end": "786760"
  },
  {
    "text": "just to see what kind of output this",
    "start": "786760",
    "end": "788480"
  },
  {
    "text": "training cluster will generate right and",
    "start": "788480",
    "end": "791360"
  },
  {
    "text": "um you know this is a training where you",
    "start": "791360",
    "end": "793800"
  },
  {
    "text": "know you can track the progress of those",
    "start": "793800",
    "end": "795360"
  },
  {
    "text": "25 steps and once the training is",
    "start": "795360",
    "end": "798000"
  },
  {
    "text": "completed uh your artifacts will be",
    "start": "798000",
    "end": "800199"
  },
  {
    "text": "saved into S3 as well as in FSX and then",
    "start": "800199",
    "end": "804199"
  },
  {
    "text": "your billable time is the time when your",
    "start": "804199",
    "end": "807639"
  },
  {
    "text": "training is actually running as soon as",
    "start": "807639",
    "end": "809839"
  },
  {
    "text": "the training completes Hemer will",
    "start": "809839",
    "end": "811320"
  },
  {
    "text": "terminate that FML cluster and you don't",
    "start": "811320",
    "end": "813360"
  },
  {
    "text": "have to pay beyond what you have",
    "start": "813360",
    "end": "815440"
  },
  {
    "text": "used Now quickly looking at this train.",
    "start": "815440",
    "end": "818320"
  },
  {
    "text": "python file that we have used here",
    "start": "818320",
    "end": "821240"
  },
  {
    "text": "right now the key things that I would uh",
    "start": "821240",
    "end": "823839"
  },
  {
    "text": "like to highlight in this file um first",
    "start": "823839",
    "end": "827320"
  },
  {
    "text": "we have prepared our data set uh by",
    "start": "827320",
    "end": "829240"
  },
  {
    "text": "concatenating all the data uh sets that",
    "start": "829240",
    "end": "831680"
  },
  {
    "text": "each of the sagemaker job have created",
    "start": "831680",
    "end": "835440"
  },
  {
    "text": "and we will uh use this Falcon",
    "start": "835440",
    "end": "837800"
  },
  {
    "text": "configuration uh which will be training",
    "start": "837800",
    "end": "840160"
  },
  {
    "text": "from scratch and we pulling in this this",
    "start": "840160",
    "end": "842320"
  },
  {
    "text": "configuration from hugging hugging phase",
    "start": "842320",
    "end": "844360"
  },
  {
    "text": "um repository using the hugging phase",
    "start": "844360",
    "end": "846720"
  },
  {
    "text": "apis and uh we will download the",
    "start": "846720",
    "end": "848720"
  },
  {
    "text": "tokenizer to uh to tokenize our data",
    "start": "848720",
    "end": "852600"
  },
  {
    "text": "set and uh we will wrap our model in the",
    "start": "852600",
    "end": "855720"
  },
  {
    "text": "fstp wrapper and we'll pass on all the",
    "start": "855720",
    "end": "858759"
  },
  {
    "text": "um uh parameters which will Define the",
    "start": "858759",
    "end": "861240"
  },
  {
    "text": "behavior of how you want to Shard your",
    "start": "861240",
    "end": "863160"
  },
  {
    "text": "model right for example here we are",
    "start": "863160",
    "end": "865240"
  },
  {
    "text": "passing the auto rap policy uh which",
    "start": "865240",
    "end": "867959"
  },
  {
    "text": "will consider this particular ular class",
    "start": "867959",
    "end": "870199"
  },
  {
    "text": "for sharding the model parameters or",
    "start": "870199",
    "end": "872240"
  },
  {
    "text": "gradients and optimize the states and",
    "start": "872240",
    "end": "874839"
  },
  {
    "text": "finally once you have wrapped the model",
    "start": "874839",
    "end": "876120"
  },
  {
    "text": "in fstp you will be running your",
    "start": "876120",
    "end": "877759"
  },
  {
    "text": "training Loop we'll be passing the",
    "start": "877759",
    "end": "879920"
  },
  {
    "text": "batches of data to your model uh you'll",
    "start": "879920",
    "end": "882560"
  },
  {
    "text": "compute the loss and will run the",
    "start": "882560",
    "end": "884399"
  },
  {
    "text": "backward pass which will compute the",
    "start": "884399",
    "end": "885880"
  },
  {
    "text": "gradients and finally you will use",
    "start": "885880",
    "end": "887959"
  },
  {
    "text": "Optimizer do step to update your",
    "start": "887959",
    "end": "892000"
  },
  {
    "text": "parameters so this concludes the demo so",
    "start": "892160",
    "end": "895040"
  },
  {
    "text": "we have seen with sagemaker you get the",
    "start": "895040",
    "end": "896959"
  },
  {
    "text": "flexibility uh in bringing in um and",
    "start": "896959",
    "end": "899199"
  },
  {
    "text": "working with the choice of frame machine",
    "start": "899199",
    "end": "900519"
  },
  {
    "text": "learning Frameworks and libraries and",
    "start": "900519",
    "end": "902240"
  },
  {
    "text": "you get a manage experience with p as",
    "start": "902240",
    "end": "903880"
  },
  {
    "text": "youo prising so you bring down your",
    "start": "903880",
    "end": "905800"
  },
  {
    "text": "total cost of ownership by offloading",
    "start": "905800",
    "end": "907720"
  },
  {
    "text": "the complex task like workload",
    "start": "907720",
    "end": "909880"
  },
  {
    "text": "orchestration and management of",
    "start": "909880",
    "end": "911440"
  },
  {
    "text": "underlying compute to sagemaker now this",
    "start": "911440",
    "end": "914199"
  },
  {
    "text": "manage cluster is resilient a sagemaker",
    "start": "914199",
    "end": "916519"
  },
  {
    "text": "will ensure that if there is a bad node",
    "start": "916519",
    "end": "919000"
  },
  {
    "text": "which could be because of GPU failures",
    "start": "919000",
    "end": "920800"
  },
  {
    "text": "or Hardware failures sagemaker will",
    "start": "920800",
    "end": "922759"
  },
  {
    "text": "replace that with a good node and then",
    "start": "922759",
    "end": "925000"
  },
  {
    "text": "if you are using a managed container as",
    "start": "925000",
    "end": "927120"
  },
  {
    "text": "we have seen in this example um those",
    "start": "927120",
    "end": "929560"
  },
  {
    "text": "are optimized um for networking and",
    "start": "929560",
    "end": "932199"
  },
  {
    "text": "compute and if you're using FSX for",
    "start": "932199",
    "end": "934399"
  },
  {
    "text": "luster as a high performance file system",
    "start": "934399",
    "end": "936480"
  },
  {
    "text": "um you make the entire end to end system",
    "start": "936480",
    "end": "938279"
  },
  {
    "text": "highly performant and because you're",
    "start": "938279",
    "end": "940120"
  },
  {
    "text": "paying only for the amount that you're",
    "start": "940120",
    "end": "941720"
  },
  {
    "text": "using these resources and for the time",
    "start": "941720",
    "end": "943839"
  },
  {
    "text": "that a training is actually running uh",
    "start": "943839",
    "end": "945639"
  },
  {
    "text": "we are optimizing this entire system for",
    "start": "945639",
    "end": "948040"
  },
  {
    "text": "cost so this concludes the demo uh these",
    "start": "948040",
    "end": "950680"
  },
  {
    "text": "are the resources that you can refer to",
    "start": "950680",
    "end": "952680"
  },
  {
    "text": "dive deeper into the examples that we",
    "start": "952680",
    "end": "954399"
  },
  {
    "text": "have seen and the documentation uh we",
    "start": "954399",
    "end": "957279"
  },
  {
    "text": "will Deep dive further into pre-training",
    "start": "957279",
    "end": "959040"
  },
  {
    "text": "large language models in the upcoming",
    "start": "959040",
    "end": "960839"
  },
  {
    "text": "videos in the series I hope you have",
    "start": "960839",
    "end": "962519"
  },
  {
    "text": "liked this session uh thank you so much",
    "start": "962519",
    "end": "966839"
  }
]