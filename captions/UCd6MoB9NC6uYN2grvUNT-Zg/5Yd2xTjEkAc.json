[
  {
    "start": "0",
    "end": "33000"
  },
  {
    "text": "welcome I was deciding whether or not I should run out and jump while running but it's probably best not to uh welcome",
    "start": "1000",
    "end": "7839"
  },
  {
    "text": "to the um security session five secure automation improvements you can make by",
    "start": "7839",
    "end": "13480"
  },
  {
    "text": "using Amazon cloudwatch events and AWS config rules um or the longest slide",
    "start": "13480",
    "end": "19080"
  },
  {
    "text": "session we could ever fit on a single page uh my name is Henri Jansen uh I'm a",
    "start": "19080",
    "end": "24199"
  },
  {
    "text": "security specialist solution architect in the Americas which you probably guessed by my name and my for",
    "start": "24199",
    "end": "32279"
  },
  {
    "text": "accent uh so today we're going to cover a couple of items um just a heads up",
    "start": "32840",
    "end": "38840"
  },
  {
    "start": "33000",
    "end": "33000"
  },
  {
    "text": "this is a level 400 uh session we're going to have a lot of um code and demos",
    "start": "38840",
    "end": "45360"
  },
  {
    "text": "and more code um if you don't like that um so when I say Jason I'm not talking",
    "start": "45360",
    "end": "50879"
  },
  {
    "text": "to whoever is in here called Jason um so if you don't like code I won't be offended if you want to",
    "start": "50879",
    "end": "57840"
  },
  {
    "text": "leave if you do like code or just want to learn what you can do with secure automation on AWS feel free to say I",
    "start": "57840",
    "end": "63559"
  },
  {
    "text": "love to have you here um so we're going to cover a couple of different topics this um this session so we're going to",
    "start": "63559",
    "end": "68680"
  },
  {
    "text": "start with a bonus session um do reverse order uh quick talk about why you want",
    "start": "68680",
    "end": "74680"
  },
  {
    "text": "to do secured automation um quick mention on the tooling because we're going to focus on the actual uh scripts",
    "start": "74680",
    "end": "81799"
  },
  {
    "text": "and um go through a little bit of the anatomy of uh secured automation how you should build your rules um and then",
    "start": "81799",
    "end": "89079"
  },
  {
    "text": "we're going to go through demo and code for five different automation pieces like we promised um and we're going to",
    "start": "89079",
    "end": "95560"
  },
  {
    "text": "cover a couple of other resources after um the five automation pieces we're going to go through is actually um five",
    "start": "95560",
    "end": "102079"
  },
  {
    "text": "different script scenarios that cover different security scenarios that are not too uncommon of happening in your um",
    "start": "102079",
    "end": "108680"
  },
  {
    "text": "or in other people's environments um those going to be automatic cloud trail uh remediation so",
    "start": "108680",
    "end": "114079"
  },
  {
    "text": "what happens when something uh someone does something on your AWS services like turnoff cloud trail uh cloud inform",
    "start": "114079",
    "end": "120119"
  },
  {
    "text": "template audit uh we're going to go through awsc Foundation framework account assessment so it's basically a",
    "start": "120119",
    "end": "125520"
  },
  {
    "text": "benchmarking tool um Auto MFA for IM IM and lastly the tainted server uh Auto",
    "start": "125520",
    "end": "133120"
  },
  {
    "text": "isolation um I did promise a bonus and the bonus is that the code for all these",
    "start": "133120",
    "end": "139080"
  },
  {
    "text": "sessions uh is going to be released on open source so it will be available on GitHub um as open source that you can",
    "start": "139080",
    "end": "145800"
  },
  {
    "text": "use and do whatever you want with um there two GitHub repos one for for AWS security automation that's going to",
    "start": "145800",
    "end": "151840"
  },
  {
    "text": "contain most of them and then one for AWS security Benchmark that's going to contain the CIS uh Foundation benchmark",
    "start": "151840",
    "end": "158959"
  },
  {
    "text": "test um if anyone were at a session earlier this week for uh the CIS",
    "start": "158959",
    "end": "164239"
  },
  {
    "text": "Foundation Frameworks and general benchmarking um this is actually the tool that created a report that was",
    "start": "164239",
    "end": "171560"
  },
  {
    "text": "demoed in that session so what do you want to do secure automation well we want to reduce the",
    "start": "171560",
    "end": "178319"
  },
  {
    "start": "174000",
    "end": "174000"
  },
  {
    "text": "risk of human error uh whether or not it's malicious or by accident we still",
    "start": "178319",
    "end": "184120"
  },
  {
    "text": "want to reduce them humans do make errors whether they want to or not automation is also effective um you",
    "start": "184120",
    "end": "192440"
  },
  {
    "text": "can run one script or you can run a million scripts um we don't really care about that we can scale as we need to",
    "start": "192440",
    "end": "199560"
  },
  {
    "text": "it's Al also reliable most humans don't like getting up at 2:30 a.m. to turn off",
    "start": "199560",
    "end": "205360"
  },
  {
    "text": "a server scripts love that uh it's scalable um we can scale it",
    "start": "205360",
    "end": "212519"
  },
  {
    "text": "out as we need to according to our own environment size so even if you only have five servers you can still",
    "start": "212519",
    "end": "218280"
  },
  {
    "text": "implement the same script that you can do with 5,000 servers that should not",
    "start": "218280",
    "end": "223480"
  },
  {
    "text": "matter and don't worry we still need humans someone's got to innovate someone's got to be the space cets",
    "start": "223480",
    "end": "229000"
  },
  {
    "text": "someone's got to come up with this stuff and we want to not use red shirts because you want to have your run",
    "start": "229000",
    "end": "236760"
  },
  {
    "text": "um the second reason is also High pace of of innovation is awesome uh we talk about high pace of innovation a lot but",
    "start": "236879",
    "end": "243519"
  },
  {
    "text": "we also need High pace of detection alerting remediation countermeasures",
    "start": "243519",
    "end": "248879"
  },
  {
    "text": "forensics things that usually take time and it's crucial to get started within",
    "start": "248879",
    "end": "254640"
  },
  {
    "text": "seconds after they happen um as an example if someone does breach your",
    "start": "254640",
    "end": "260000"
  },
  {
    "text": "account getting that 2:30 call in the morning is not that good because you're still going to have that person wake up",
    "start": "260000",
    "end": "266240"
  },
  {
    "text": "he's going to go to his computer turn it on and versus a script that was already",
    "start": "266240",
    "end": "271919"
  },
  {
    "text": "there and took care of it and disabled all the accounts within half a",
    "start": "271919",
    "end": "277879"
  },
  {
    "text": "minute some of the tooling uh like I said we're not going to go through too much uh if you haven't used Lambda",
    "start": "278280",
    "end": "284440"
  },
  {
    "text": "absolutely do that as a secured practitioner especially in the secured automation role um Lambda is going to be",
    "start": "284440",
    "end": "289600"
  },
  {
    "text": "your best friend um also look at config rules and cloudwatch events um go down",
    "start": "289600",
    "end": "294960"
  },
  {
    "text": "to the expo hall and talk to the different product teams around them uh cloud trail inspector same thing there",
    "start": "294960",
    "end": "300520"
  },
  {
    "text": "uh for tracking and logging awesome tools cloudwatch logs Dynamo DB uh make sure you use them um for Al leering SNS",
    "start": "300520",
    "end": "308160"
  },
  {
    "text": "is one thing you can also use combination of SNS with for example cloudwatch events um just have some way",
    "start": "308160",
    "end": "314039"
  },
  {
    "text": "of alerting and making people aware what's going on and a bunch of third party open source tools I'm going to",
    "start": "314039",
    "end": "319240"
  },
  {
    "text": "list a couple of them uh more of the sort of bigger Frameworks out there um and we'll do that in the",
    "start": "319240",
    "end": "326199"
  },
  {
    "text": "end so I'm not going to go through too much of this uh just a hint when you build your secur automation tools make",
    "start": "326199",
    "end": "333280"
  },
  {
    "text": "sure that you have a framework to follow don't just go ahead and start riding away that's that's good for like",
    "start": "333280",
    "end": "338440"
  },
  {
    "text": "figuring stuff out but once you put something in production make sure that you have a framework to follow so when",
    "start": "338440",
    "end": "344639"
  },
  {
    "text": "the next person writes it even better when the next person needs to troubleshoot it he knows the structure",
    "start": "344639",
    "end": "349800"
  },
  {
    "text": "of it he doesn't have to go in and figure out what's going on when did he actually do logging or did he forget",
    "start": "349800",
    "end": "355639"
  },
  {
    "text": "about it have a framework so have your priority actions what do you need to do first what is the most important thing",
    "start": "355639",
    "end": "361919"
  },
  {
    "text": "for this script to do forensics figure out what happened U countermeasures do",
    "start": "361919",
    "end": "367120"
  },
  {
    "text": "we need to prevent it again um there's two cases for counter measures one someone did something wrong and they're",
    "start": "367120",
    "end": "372800"
  },
  {
    "text": "going to do something wrong over and over again until someone stops them or someone did something malicious both",
    "start": "372800",
    "end": "378479"
  },
  {
    "text": "cases we want to prevent from happening over and over again um alerting make",
    "start": "378479",
    "end": "383520"
  },
  {
    "text": "sure you make people aware you can have automation that protects you for a year",
    "start": "383520",
    "end": "389080"
  },
  {
    "text": "but if no one knows about it you might have fixed it in a day instead um and then logging and logging",
    "start": "389080",
    "end": "396160"
  },
  {
    "text": "has a actually a dual purpose uh and we're going to show that in the first demo why you absolutely need to do",
    "start": "396160",
    "end": "401319"
  },
  {
    "text": "proper logging in your secure automation as well so the first thing we're going to",
    "start": "401319",
    "end": "406759"
  },
  {
    "start": "404000",
    "end": "404000"
  },
  {
    "text": "look at is uh automatic Cloud TR remediation um and this is just as a",
    "start": "406759",
    "end": "411800"
  },
  {
    "text": "sample you can do any kind of service action whatever is that you need to do this is just a example um so what we're",
    "start": "411800",
    "end": "419759"
  },
  {
    "text": "going to do is that we're going to verify that cloud trail is always running because there shouldn't be a reason to turn off cloud trail if",
    "start": "419759",
    "end": "426080"
  },
  {
    "text": "someone is doing that they're doing it because they're doing something wrong or they're trying to prevent",
    "start": "426080",
    "end": "432720"
  },
  {
    "text": "something um and we also want to issue some countermeasures because if someone is",
    "start": "432919",
    "end": "439879"
  },
  {
    "text": "doing this for whatever reason we want to prevent them from doing it again so in this case we can use uh Lambda",
    "start": "439879",
    "end": "445400"
  },
  {
    "text": "cloudshell Cloud events um and just a python script running on",
    "start": "445400",
    "end": "450680"
  },
  {
    "text": "Lambda so let's kick off with a demo and if you can switch and just a heads up we are doing",
    "start": "450680",
    "end": "458319"
  },
  {
    "text": "five live demos or four um so if they don't work or",
    "start": "458319",
    "end": "463960"
  },
  {
    "text": "other so this is not going to be too complicated uh what we're going to do is",
    "start": "463960",
    "end": "470720"
  },
  {
    "text": "we're simply going to stop Cloud shell um so Cloud tril",
    "start": "470720",
    "end": "477479"
  },
  {
    "text": "stopped and we're just checking um we can see the cloud tril is not logging um so our stop event was perfect",
    "start": "477479",
    "end": "485520"
  },
  {
    "text": "um this is scenario where someone went in and stopped it either by a mistake or malicious because they want to do",
    "start": "485520",
    "end": "491400"
  },
  {
    "text": "something on the back end and they don't want anyone to find out what is happening um so in this script I simply",
    "start": "491400",
    "end": "497840"
  },
  {
    "text": "issued a stop logging event and then in this case I'm just looking for uh Cloud",
    "start": "497840",
    "end": "503479"
  },
  {
    "text": "to start logging and this is where I'm hoping that I got the right account there um",
    "start": "503479",
    "end": "510000"
  },
  {
    "text": "the important thing here when we run these is again uh report back what is",
    "start": "510000",
    "end": "515440"
  },
  {
    "text": "going on because if we don't have that backtrack uh we can't issue the correct countermeasures so in this case we're",
    "start": "515440",
    "end": "522240"
  },
  {
    "text": "actually using um the countermeasure sorry the logging event of what happened",
    "start": "522240",
    "end": "528040"
  },
  {
    "text": "to determine whether or not we should uh Implement counter measures uh on the account so in this case we saw that um",
    "start": "528040",
    "end": "536120"
  },
  {
    "text": "after a while here and again we're running on Limited band with um the uh",
    "start": "536120",
    "end": "542000"
  },
  {
    "text": "um the kind misses went in they started Cloud again um this is just ping for",
    "start": "542000",
    "end": "548160"
  },
  {
    "text": "cloud status um and this is the same user I'm running from so the same user",
    "start": "548160",
    "end": "554360"
  },
  {
    "text": "has access to both U stop the cloud trail and also uh run it again the really important thing here why we want",
    "start": "554360",
    "end": "559959"
  },
  {
    "text": "to U log is because we want to be able to track and see if they've done it again before so we track and log for",
    "start": "559959",
    "end": "567680"
  },
  {
    "text": "forensic perspective but also to see in our countermeasure process we can go in the same log and pull out information to",
    "start": "567680",
    "end": "574720"
  },
  {
    "text": "see has this user done it before all using cloudwatch events and",
    "start": "574720",
    "end": "580480"
  },
  {
    "text": "Lambda so when I run it over and over again um this script will actually look",
    "start": "584600",
    "end": "590560"
  },
  {
    "text": "in the uh the database and see has he run it before or um is this the first",
    "start": "590560",
    "end": "597240"
  },
  {
    "text": "time so while that is running if we want to switch over to the other",
    "start": "597240",
    "end": "604399"
  },
  {
    "text": "one and I'll show you the effect uh once we go to the the code piece",
    "start": "604440",
    "end": "610079"
  },
  {
    "text": "there um so again lot of code lot of Json um Don't Be Afraid um so the first",
    "start": "610079",
    "end": "618120"
  },
  {
    "start": "611000",
    "end": "611000"
  },
  {
    "text": "thing we're going to go through a couple of different scenarios and a couple of different important pieces of these automation scripts so for example first",
    "start": "618120",
    "end": "624959"
  },
  {
    "text": "thing we want to know is who did this so we need to extract the information from the event coming in from cloudwatch",
    "start": "624959",
    "end": "630519"
  },
  {
    "text": "events and in this case we don't want all the information but we want enough so we can do forensics after the key",
    "start": "630519",
    "end": "635880"
  },
  {
    "text": "here is that um in the beginning there you can see that we have two different usernames and this is really important",
    "start": "635880",
    "end": "642120"
  },
  {
    "text": "that you test these scripts first because if these usernames are if this is a im user that's going to look",
    "start": "642120",
    "end": "649079"
  },
  {
    "text": "different than if it is a um uh federative",
    "start": "649079",
    "end": "654519"
  },
  {
    "text": "user so we need to go in and and look at the actual event there",
    "start": "654519",
    "end": "660320"
  },
  {
    "start": "660000",
    "end": "660000"
  },
  {
    "text": "um as I said execution order so in this case we have a number of different cases uh so we have our priority action what",
    "start": "660320",
    "end": "666720"
  },
  {
    "text": "is the most important thing we want to do well we want to start Cloud shell we have our alerting um which is we want to",
    "start": "666720",
    "end": "673279"
  },
  {
    "text": "send the information to someone to make them aware of it then we have the forensics what has actually happened",
    "start": "673279",
    "end": "678600"
  },
  {
    "text": "here so we're looking up the Dynamo table where we store our our um track Rec in um and then just look have have",
    "start": "678600",
    "end": "685720"
  },
  {
    "text": "this happened before was it the same user if we want to we can add range searching so we can for example",
    "start": "685720",
    "end": "691079"
  },
  {
    "text": "look for time stamp and say it's okay to make mistakes once a day but if you make them twice a day we're going to prevent",
    "start": "691079",
    "end": "696519"
  },
  {
    "text": "you um and the forensics is also what leads whether or not you should do countermeasures um and once you've done",
    "start": "696519",
    "end": "703079"
  },
  {
    "text": "the counter measures um go on to logging because as I said we are going to use",
    "start": "703079",
    "end": "708560"
  },
  {
    "text": "that information later on as well um as I mentioned forensics it's",
    "start": "708560",
    "end": "715399"
  },
  {
    "start": "711000",
    "end": "711000"
  },
  {
    "text": "not hard to do a simple version of forensics forensic can be be anything from memory analysis to looking at up in",
    "start": "715399",
    "end": "723040"
  },
  {
    "text": "other uh databases or extracting information from the file system but it could also be as simple thing as has",
    "start": "723040",
    "end": "729680"
  },
  {
    "text": "this happened before so in this case we're just looking up in the in the um Dynamo table can we find this username",
    "start": "729680",
    "end": "736040"
  },
  {
    "text": "in the Dynamo table yes okay prevent it from happening again and in this case we",
    "start": "736040",
    "end": "741079"
  },
  {
    "text": "can say that if it's uh a first time don't issue the the counter measures but if it's done before issue the counter",
    "start": "741079",
    "end": "747880"
  },
  {
    "text": "measures and it kind measures in this case it's simple we just want to deploy a new IM policy because we don't want to",
    "start": "747880",
    "end": "754000"
  },
  {
    "start": "748000",
    "end": "748000"
  },
  {
    "text": "delete the user we don't want to cause sort of irreversible harm uh we're just going to disable the user and we're",
    "start": "754000",
    "end": "761040"
  },
  {
    "text": "going to just applo a um deny policy on him so this is a simple IM am denied policy that we automatically apply as an",
    "start": "761040",
    "end": "767440"
  },
  {
    "text": "inline policy on that user um this could extend longer we could apply for example",
    "start": "767440",
    "end": "773199"
  },
  {
    "text": "for temporary tokens we could apply for um disabling and removing groups they have access to creating a report but",
    "start": "773199",
    "end": "780199"
  },
  {
    "text": "just make sure that you prevent this from happening",
    "start": "780199",
    "end": "784240"
  },
  {
    "text": "again and if we switch back uh we can now see that any time I",
    "start": "785440",
    "end": "791279"
  },
  {
    "text": "try to do this again I get an access denied simply",
    "start": "791279",
    "end": "796480"
  },
  {
    "text": "because um the uh cloudwatch event on the backend server went in and applied",
    "start": "796480",
    "end": "802240"
  },
  {
    "text": "this uh disabled user policy and since it's IM IM deny will always win and this",
    "start": "802240",
    "end": "808199"
  },
  {
    "text": "is just a very simple script that you can just take Implement and change from for example Cloud stopping to anything",
    "start": "808199",
    "end": "814680"
  },
  {
    "text": "that you want to this could be a security group that get changed it could be an ec2 instance that being stun up it",
    "start": "814680",
    "end": "819800"
  },
  {
    "text": "could be a KMS permission being changed anything that you want to do that is API based you can just issue a simple script",
    "start": "819800",
    "end": "826480"
  },
  {
    "text": "to revert that and alert it on",
    "start": "826480",
    "end": "830079"
  },
  {
    "text": "it oops um so if we switch back we're going to switch a lot",
    "start": "832279",
    "end": "837519"
  },
  {
    "text": "today um there we",
    "start": "837519",
    "end": "843600"
  },
  {
    "start": "842000",
    "end": "842000"
  },
  {
    "text": "go uh and as I mentioned the the script is going to be available this script is already out there and available to",
    "start": "843600",
    "end": "848959"
  },
  {
    "text": "download today um so you can just go out on the git repo and get it and modify to whatever you want to check for this is",
    "start": "848959",
    "end": "854959"
  },
  {
    "text": "an inspirational script um if you want to do Cloud you can just take that one but go in and change it to whatever you",
    "start": "854959",
    "end": "861560"
  },
  {
    "text": "want to the second piece is a cloud information template audit and this is",
    "start": "861560",
    "end": "866920"
  },
  {
    "text": "just to show um how how you can Implement easy methods of uh infrastructure governance before you",
    "start": "866920",
    "end": "873680"
  },
  {
    "text": "deploy uh anything out in your production environment so in this case we have users that are deploying",
    "start": "873680",
    "end": "879720"
  },
  {
    "text": "infrastructure that do not conform to your corporate policies that could be for example they put out a cloud",
    "start": "879720",
    "end": "885040"
  },
  {
    "text": "information template that have a security group that opens up access to your backend resources um straight from",
    "start": "885040",
    "end": "890279"
  },
  {
    "text": "the Internet or it could be that they have a um um they start opening up unused",
    "start": "890279",
    "end": "896959"
  },
  {
    "text": "protocols they don't want to we don't want to have Port 80 and things like that so we want to catch everything that",
    "start": "896959",
    "end": "902079"
  },
  {
    "text": "doesn't conform to our standard we also want to risk uh the uh reduce the risk of un unapproved changes so if you have",
    "start": "902079",
    "end": "908920"
  },
  {
    "text": "something in production already and someone makes a change to it you can also see that is this user authorized to",
    "start": "908920",
    "end": "914399"
  },
  {
    "text": "do this change even though he has permission he might not be in that environment normally um and the services we use in",
    "start": "914399",
    "end": "920279"
  },
  {
    "text": "this case and this one we're not going to demo uh because it requires a little more but um we use cod pipan and",
    "start": "920279",
    "end": "925959"
  },
  {
    "text": "cloudwatch events and Lambda uh and code commit as well or any type of git repo",
    "start": "925959",
    "end": "931880"
  },
  {
    "text": "uh and that's also an important thing always check your Cloud information templates into git use a code version",
    "start": "931880",
    "end": "938680"
  },
  {
    "text": "control system for your infrastructure as well that's the easiest way that you can do governance on infrastructure and",
    "start": "938680",
    "end": "945319"
  },
  {
    "text": "do it in predeployment",
    "start": "945319",
    "end": "948160"
  },
  {
    "text": "check in or an admin will check in their code to a git repo nothing strange what we're going to do is that we have a code",
    "start": "958639",
    "end": "964560"
  },
  {
    "text": "Pipeline and this could be any type of automation tool as well um that just monitors that git repo anytime someone",
    "start": "964560",
    "end": "970519"
  },
  {
    "text": "checks in a code a file there it's going to extract the file send it to a Lambda",
    "start": "970519",
    "end": "975639"
  },
  {
    "text": "function and have that Lambda function do audit and then decide what the next step is so in this case we just",
    "start": "975639",
    "end": "981480"
  },
  {
    "text": "Gathering a lot of information like the input artifacts meaning that what file it is um where it's stored where they",
    "start": "981480",
    "end": "987240"
  },
  {
    "text": "can put it uh fetch it information so we can report back status after and again this is just so you can get more",
    "start": "987240",
    "end": "993399"
  },
  {
    "text": "comfortable with uh doing different kind of validation governance and autom automation",
    "start": "993399",
    "end": "998839"
  },
  {
    "text": "flows um then once we have the template so we do the get template first with the",
    "start": "998839",
    "end": "1004040"
  },
  {
    "start": "999000",
    "end": "999000"
  },
  {
    "text": "information we got uh we're going to get some rules because we're doing audit so we want to make sure that we audit the",
    "start": "1004040",
    "end": "1010199"
  },
  {
    "text": "stuff with real rules um we're going to go through that rules and do a full evaluation of the template I'm going to",
    "start": "1010199",
    "end": "1015680"
  },
  {
    "text": "show you how um and then simply decide what's the next step for this uh file so",
    "start": "1015680",
    "end": "1021279"
  },
  {
    "text": "if you're doing a deployment pipeline it's very easy to set up multiple scenarios based on the risk assessment",
    "start": "1021279",
    "end": "1027199"
  },
  {
    "text": "so for example if it's a low risk you can just have that U that cloud information templ go straight out into a",
    "start": "1027199",
    "end": "1033079"
  },
  {
    "text": "production environment or a test environment um and say that we've deemed it low risk enough that nothing's going",
    "start": "1033079",
    "end": "1038319"
  },
  {
    "text": "to change and affect our uh overall security posture so just have Co code",
    "start": "1038319",
    "end": "1043600"
  },
  {
    "text": "pipeline directly pushed out into a production environment or we can say that",
    "start": "1043600",
    "end": "1050160"
  },
  {
    "text": "we think it's low risk but there are a couple of items where we're a little bit unsure um so what we do is that we can",
    "start": "1050160",
    "end": "1056000"
  },
  {
    "text": "send it to a second code pipeline or any type of pipeline orchestration um and",
    "start": "1056000",
    "end": "1061200"
  },
  {
    "text": "say that we want to we probably want to push it out but we want to validate it so we can introduce a manual gate so",
    "start": "1061200",
    "end": "1067559"
  },
  {
    "text": "push the information what is unsure and send it to a manual gate process where someone has to go in and approve it and",
    "start": "1067559",
    "end": "1074720"
  },
  {
    "text": "once they approve it follows the same path goes out into the next uh um infrastructure step or they can also",
    "start": "1074720",
    "end": "1080919"
  },
  {
    "text": "decline it and send it back to the um the developers or in the third scenario if",
    "start": "1080919",
    "end": "1086440"
  },
  {
    "text": "we deem this as a big uh major high risk cancel it instantly just don't let it go",
    "start": "1086440",
    "end": "1091799"
  },
  {
    "text": "anywhere stop it cancel the flow delete the file or send an email back saying that this is not approved here's why the",
    "start": "1091799",
    "end": "1099120"
  },
  {
    "text": "important thing is that include here's why because if you say that it's not approved it's just going to",
    "start": "1099120",
    "end": "1106679"
  },
  {
    "text": "repeat um so in this case with the rules um what we want to do and especially if",
    "start": "1106679",
    "end": "1112799"
  },
  {
    "start": "1107000",
    "end": "1107000"
  },
  {
    "text": "you're dealing with code uh with uh Cloud information templates so the way Cloud information template is built up",
    "start": "1112799",
    "end": "1118600"
  },
  {
    "text": "it's built up by a number of different resources these resources could be easy2 instances could be security groups",
    "start": "1118600",
    "end": "1125039"
  },
  {
    "text": "Dynamo tables any type of resource in AWS and we want to break this out and separate them so in this case we take",
    "start": "1125039",
    "end": "1131840"
  },
  {
    "text": "the whole Cloud template we read it in and then we extract the separate groups",
    "start": "1131840",
    "end": "1136880"
  },
  {
    "text": "so we extract all security groups in one place the E2 instances in one place um",
    "start": "1136880",
    "end": "1142360"
  },
  {
    "text": "if we want to add support for more features we can just add more and more categories and these would match with",
    "start": "1142360",
    "end": "1147480"
  },
  {
    "text": "the cloud fishing templates but it might be something that we're not interested in like we don't care what you do with",
    "start": "1147480",
    "end": "1154000"
  },
  {
    "text": "um with your Dynamo table or we don't care what you do with this just an example um and then you don't need to",
    "start": "1154000",
    "end": "1159480"
  },
  {
    "text": "have that as a category but make sure you break it out into separate groups because the more um isolated you can get",
    "start": "1159480",
    "end": "1165480"
  },
  {
    "text": "it the easier it is to write your rules uh and evaluate that",
    "start": "1165480",
    "end": "1170799"
  },
  {
    "text": "information so the rules in this case is a simple Rex um the reason for that is",
    "start": "1170799",
    "end": "1177280"
  },
  {
    "start": "1171000",
    "end": "1171000"
  },
  {
    "text": "that it's fast it's easy to conform and it can catch a lot of the different things in a predeployment scenario that",
    "start": "1177280",
    "end": "1182760"
  },
  {
    "text": "otherwise would go on um so we have a couple of items here we have a rule name and we store these in Dynamo DB we have",
    "start": "1182760",
    "end": "1189600"
  },
  {
    "text": "a rule name we have a category as I mentioned we have security groups ec2 instances so in this case we want to",
    "start": "1189600",
    "end": "1195400"
  },
  {
    "text": "apply this only to the security groups we don't want to run this on everything else because that's just going to take compute time uh we can choose whether or",
    "start": "1195400",
    "end": "1202200"
  },
  {
    "text": "not we want to activate it or deactivate it so for example if we realize that we get a lot of false positives okay",
    "start": "1202200",
    "end": "1208640"
  },
  {
    "text": "deactivate it and and figure out later what we want to do with it the key item here is risk value how do you classify",
    "start": "1208640",
    "end": "1215520"
  },
  {
    "text": "this risk and we want to make sure that something that is really sensitive like a security group is treated accordingly",
    "start": "1215520",
    "end": "1222039"
  },
  {
    "text": "and mapped according to your internal risk process so if you have a risk analysis or a threat assessment on your",
    "start": "1222039",
    "end": "1227840"
  },
  {
    "text": "environment map that to the rules that you create so for example we deem a a this is again",
    "start": "1227840",
    "end": "1234640"
  },
  {
    "text": "just an example if you open up Port 80 we say okay that might be a risk of",
    "start": "1234640",
    "end": "1239880"
  },
  {
    "text": "three but if you were to say that we have SSH open through world so in this",
    "start": "1239880",
    "end": "1245480"
  },
  {
    "text": "case we're looking for any type where we have open port 22 to anywhere and if you don't like red",
    "start": "1245480",
    "end": "1253240"
  },
  {
    "text": "JS they get complicated um but",
    "start": "1253240",
    "end": "1259000"
  },
  {
    "text": "make sure that you capture the information that could cause a threat to you um and then apply the proper risk",
    "start": "1259000",
    "end": "1266480"
  },
  {
    "text": "value um in this case we're using Rex it's really easy to replace this or have multiple versions so you can have Rex",
    "start": "1266480",
    "end": "1273600"
  },
  {
    "text": "you can also have a code snippet and just apply that code snippet to the rule if you want to do more advanced things",
    "start": "1273600",
    "end": "1279120"
  },
  {
    "text": "than a Rex if there is such a thing um but uh or complicated maybe the word is",
    "start": "1279120",
    "end": "1286159"
  },
  {
    "text": "but uh make sure that you handle the risk value and the risk value is that once we run through uh and again this",
    "start": "1286159",
    "end": "1293559"
  },
  {
    "start": "1289000",
    "end": "1289000"
  },
  {
    "text": "will make a little easier when you download if you download after but once",
    "start": "1293559",
    "end": "1298679"
  },
  {
    "text": "we have our our different resources and our different rules we're just going to go through all the resources uh category",
    "start": "1298679",
    "end": "1304840"
  },
  {
    "text": "by category and apply the risk uh the rules on that category and once we've applied all of",
    "start": "1304840",
    "end": "1311840"
  },
  {
    "text": "them so here's we extracting the the resources um we're going to get a risk value and we can have multiple risk",
    "start": "1311840",
    "end": "1319240"
  },
  {
    "text": "values on the same resource so for example a security group could have two risk values it could get one because it had open up everything to the world or",
    "start": "1319240",
    "end": "1326840"
  },
  {
    "text": "just open to the world it could have a second risk value because it was Port 80 and a third risk value because it also",
    "start": "1326840",
    "end": "1332880"
  },
  {
    "text": "had Port 22 in it um we want to add up all of these risk values you can also",
    "start": "1332880",
    "end": "1338320"
  },
  {
    "text": "weigh them depending on if it's for example security groups might have higher weight than ec2 resources but we",
    "start": "1338320",
    "end": "1345360"
  },
  {
    "text": "want to um add all of them together together and then make assessment if for",
    "start": "1345360",
    "end": "1350720"
  },
  {
    "text": "example in this case if we have a total risk value of five okay we're going to go forward with it because we know that",
    "start": "1350720",
    "end": "1356600"
  },
  {
    "text": "the highrisk items would pass that limit by just themselves or if we have for",
    "start": "1356600",
    "end": "1361799"
  },
  {
    "text": "example between a certain limmit and you can Implement as many different limits as you want here you can also category",
    "start": "1361799",
    "end": "1367559"
  },
  {
    "text": "and say that I approve five on E2 but three on on security groups um and then",
    "start": "1367559",
    "end": "1373919"
  },
  {
    "text": "let's go through a loop and say okay if it's low risk tell code pip plan to push it out into production if it's medium",
    "start": "1373919",
    "end": "1380000"
  },
  {
    "text": "risk okay we're going to need a manual approval if it's high risk just fail it don't do anything just fail",
    "start": "1380000",
    "end": "1387640"
  },
  {
    "text": "it and if we can switch",
    "start": "1390240",
    "end": "1394480"
  },
  {
    "text": "over so when you build these uh these scripts um try to categorize them as",
    "start": "1398320",
    "end": "1403960"
  },
  {
    "text": "much as possible for what they're doing so for example don't build everything one big function um follow the same",
    "start": "1403960",
    "end": "1410919"
  },
  {
    "text": "principles as we do you would when you develop an application separate them out do a get ARA do a get template um have a",
    "start": "1410919",
    "end": "1418720"
  },
  {
    "text": "separate function to put the job result back into the uh the pipeline queue um",
    "start": "1418720",
    "end": "1424760"
  },
  {
    "text": "it's much much easier when you go in and troubleshoot them um and then have a way to deploy the different rules I mean",
    "start": "1424760",
    "end": "1430960"
  },
  {
    "text": "normally you would have this in a Dynamo table in the the code that uh is going to get available to you uh it's going to",
    "start": "1430960",
    "end": "1437159"
  },
  {
    "text": "deploy it inside inside the python um in the the script this is something that you want to tie into your risk",
    "start": "1437159",
    "end": "1443240"
  },
  {
    "text": "assessment uh so if you have your risk assessment values available try to merge them or at least have a way to fetch",
    "start": "1443240",
    "end": "1450240"
  },
  {
    "text": "that information and put it in your um your script as",
    "start": "1450240",
    "end": "1455480"
  },
  {
    "text": "well so if we jump back again so here's the probably the biggest",
    "start": "1456880",
    "end": "1465520"
  },
  {
    "text": "one um so this this is the uh how many people have seen the uh CIS Foundation",
    "start": "1465520",
    "end": "1471240"
  },
  {
    "text": "framework that we released a while ago couple um so if you go ahead and",
    "start": "1471240",
    "end": "1476799"
  },
  {
    "text": "search for the AWS CIS Foundation framework it's a white paper that describes uh a number of different",
    "start": "1476799",
    "end": "1483039"
  },
  {
    "text": "security controls I think it's about 40 something uh they will evaluate uh also",
    "start": "1483039",
    "end": "1489120"
  },
  {
    "text": "more they will set a standard for what your AWS account should conform to so it",
    "start": "1489120",
    "end": "1494159"
  },
  {
    "text": "includes things like you should the obvious one don't have rout access um you must have MFA token on the route uh",
    "start": "1494159",
    "end": "1501559"
  },
  {
    "text": "it should be a hardware token um all the way down to do you have proper alerting",
    "start": "1501559",
    "end": "1507240"
  },
  {
    "text": "in place uh will you see if you get a authentication error is there a rule that um or is there a configuration that",
    "start": "1507240",
    "end": "1514399"
  },
  {
    "text": "will actually send an email or an alert when something happens um so all of these rules uh are",
    "start": "1514399",
    "end": "1521840"
  },
  {
    "text": "to get in that framework and it also contains information on how to remediate in case you fail that framework uh it",
    "start": "1521840",
    "end": "1527799"
  },
  {
    "text": "also contains uh the AWS commands that you can run to figure out whether or not",
    "start": "1527799",
    "end": "1532919"
  },
  {
    "text": "um your environment conforms to that so what we did is to simplify that uh",
    "start": "1532919",
    "end": "1538880"
  },
  {
    "text": "created a single python script that you can run either Standalone or you can run",
    "start": "1538880",
    "end": "1544679"
  },
  {
    "text": "it as part of config rules that will evaluate your entire account against all those 40 plus control Frameworks and it",
    "start": "1544679",
    "end": "1551960"
  },
  {
    "text": "will give you a report uh in various formats and we're going to show the various formats um and it's also going",
    "start": "1551960",
    "end": "1559200"
  },
  {
    "text": "to uh allow you to capture the information and put it in for example a Sim by using the simple API commands of",
    "start": "1559200",
    "end": "1566120"
  },
  {
    "text": "config um in this case we simply use Lambda config rules and a lot of different API",
    "start": "1566120",
    "end": "1573200"
  },
  {
    "text": "commands um this script is 2200 lines long um so it's fairly heavy one it will",
    "start": "1573200",
    "end": "1580679"
  },
  {
    "text": "take time to run uh just because it does a lot of inventory the reason why we have it as a single file is simply",
    "start": "1580679",
    "end": "1587760"
  },
  {
    "text": "because uh putting it as single individual files you can always extract out individual controls uh you can also",
    "start": "1587760",
    "end": "1594279"
  },
  {
    "text": "enable and disable the controls you're not interested in so if you don't want to run a control simply disable it um",
    "start": "1594279",
    "end": "1601600"
  },
  {
    "text": "but the reason why we have it as one file is that if you're going to report on individual controls that means you",
    "start": "1601600",
    "end": "1606919"
  },
  {
    "text": "would need 45 50 60 um individual config Rules running in your account they",
    "start": "1606919",
    "end": "1612600"
  },
  {
    "text": "constantly run and check your environment instead of running one control once a day or once a week or how",
    "start": "1612600",
    "end": "1618120"
  },
  {
    "text": "often you want to run it that gives you a total estimate of all your",
    "start": "1618120",
    "end": "1623679"
  },
  {
    "text": "resources um so if we switch over so the",
    "start": "1623679",
    "end": "1631960"
  },
  {
    "text": "um the script has a number of different outputs that you can use uh all depending on how you want to do it so we",
    "start": "1632799",
    "end": "1639279"
  },
  {
    "text": "have for example a um uh Json output that is simply going to report it back",
    "start": "1639279",
    "end": "1644960"
  },
  {
    "text": "to the console so this is more if you're running it uh local on your computer because you want to just check out your",
    "start": "1644960",
    "end": "1650080"
  },
  {
    "text": "environment and see how it is it's going to give you a Json structure that you can import into whatever tool you to use",
    "start": "1650080",
    "end": "1655880"
  },
  {
    "text": "so you can convert it between formats as well uh and it's simply going to be structured according to the the main category uh and these are logging",
    "start": "1655880",
    "end": "1662919"
  },
  {
    "text": "monitoring um and a couple of others um a subcategory uh which is the actual",
    "start": "1662919",
    "end": "1668159"
  },
  {
    "text": "control ID and here you can see as an example the first control is avoid the use of root account so we're just going",
    "start": "1668159",
    "end": "1673799"
  },
  {
    "text": "to look if you have access to the root account um we have for example if MFA is enabled on it and Hardware MFA and the",
    "start": "1673799",
    "end": "1681480"
  },
  {
    "text": "script will simply um have as an output all the different controls and as I said",
    "start": "1681480",
    "end": "1687240"
  },
  {
    "text": "there's a couple of them um it will also show you all the items that fail so for",
    "start": "1687240",
    "end": "1694440"
  },
  {
    "text": "example we can see that on control 1.16 uh it says ensure that there's an",
    "start": "1694440",
    "end": "1699919"
  },
  {
    "text": "IM policy attached only to group or roles not as inline policies we can see",
    "start": "1699919",
    "end": "1704960"
  },
  {
    "text": "that the offenders in this case happen to be me um and uh it's going to report back to Arn",
    "start": "1704960",
    "end": "1710919"
  },
  {
    "text": "so Amazon resource name for the individual controls that failed so again if you import this into some other tool",
    "start": "1710919",
    "end": "1717279"
  },
  {
    "text": "it's full suggestion structure so you can just ask which are the offenders on control 1.6 and it's going to give you",
    "start": "1717279",
    "end": "1723440"
  },
  {
    "text": "all the users and all the groups of resources that fail that control and if you go to the end of it",
    "start": "1723440",
    "end": "1730919"
  },
  {
    "text": "so said it's a long one uh there's also a separate separate reporting feature uh which is assigned",
    "start": "1730919",
    "end": "1737720"
  },
  {
    "text": "URL so as part of the report it's just going to uh create assigned URL create HTML file upload that",
    "start": "1737720",
    "end": "1744600"
  },
  {
    "text": "file and you can go into a see we can make that a little",
    "start": "1744600",
    "end": "1751159"
  },
  {
    "text": "larger a you get a HTML report that you can send to your managers or your um",
    "start": "1751159",
    "end": "1756600"
  },
  {
    "text": "security team or whoever needs it it's going to contain information on when it was run with version a link to the benchmark test so you can download The",
    "start": "1756600",
    "end": "1763159"
  },
  {
    "text": "Benchmark with the remediation features uh it has a short summary of the failed controls so these are all the controls",
    "start": "1763159",
    "end": "1770159"
  },
  {
    "text": "and this is a demo count that's why a lot of fails um all the controls that failed and then a list with all the",
    "start": "1770159",
    "end": "1778240"
  },
  {
    "text": "different controls uh whether or not they failed or success uh color coded for E viewing um quick heads up that",
    "start": "1778240",
    "end": "1785720"
  },
  {
    "text": "there are some controls that don't support Automation in there these are going to be yellow marked um and that's",
    "start": "1785720",
    "end": "1791679"
  },
  {
    "text": "because you have to go in and manually verify those controls um but it's still going to give",
    "start": "1791679",
    "end": "1797320"
  },
  {
    "text": "give you a full list of all the controls in the test um and it has a last one",
    "start": "1797320",
    "end": "1804399"
  },
  {
    "text": "it's also using if you're running this in config rule uh it's also going to give you something called annotation um",
    "start": "1804399",
    "end": "1811039"
  },
  {
    "text": "so annotation is a way to add information to config Rule and config whether or not something is compliant or",
    "start": "1811039",
    "end": "1816640"
  },
  {
    "text": "non-compliant so if we find that your account is non-compliant it's also going to contain the short form um it has a",
    "start": "1816640",
    "end": "1823159"
  },
  {
    "text": "size limit of 256 character so if like this demo account if you have a a lot of failed controls um it will not par put",
    "start": "1823159",
    "end": "1830640"
  },
  {
    "text": "all of them in there hopefully you're never going to see the Etc in the end um",
    "start": "1830640",
    "end": "1836960"
  },
  {
    "text": "but it will report back all the compliance reports um and the benefit of this is that this is available through",
    "start": "1836960",
    "end": "1842480"
  },
  {
    "text": "apis so this is just the AWS API that you call in so if you call to get the uh",
    "start": "1842480",
    "end": "1847840"
  },
  {
    "text": "the control element um you can show it there so it's basically for the config service get compliance detailed by",
    "start": "1847840",
    "end": "1854519"
  },
  {
    "text": "config rule uh and this is a separate shout out if you're using config rules always use annotation annotation is a",
    "start": "1854519",
    "end": "1861480"
  },
  {
    "text": "perfect way to inform people what is going wrong in your",
    "start": "1861480",
    "end": "1866080"
  },
  {
    "text": "account I'm just switching there so if we can switch",
    "start": "1869799",
    "end": "1876080"
  },
  {
    "text": "over so looking a little bit on the actual script uh this is available today uh we soft launched it um on Tuesday for",
    "start": "1877000",
    "end": "1885440"
  },
  {
    "start": "1878000",
    "end": "1878000"
  },
  {
    "text": "the other session um so you can go in and download this today and run it on your account um and there's a couple of",
    "start": "1885440",
    "end": "1891760"
  },
  {
    "text": "options in there uh one is just as an informational uh which Benchmark version where uh The Benchmark current one is",
    "start": "1891760",
    "end": "1898039"
  },
  {
    "text": "1.1 um you have a couple of different options on the controls that need to",
    "start": "1898039",
    "end": "1903399"
  },
  {
    "text": "have uh setting so for example when was the last time you used a root account you can set that we of course want to",
    "start": "1903399",
    "end": "1908679"
  },
  {
    "text": "say zero you should never use it um so if you've used it it will alert on it um",
    "start": "1908679",
    "end": "1914600"
  },
  {
    "text": "you can also choose whether or not you want that web control or not uh not everyone wants to have that HTML file if you're just going to run it on your",
    "start": "1914600",
    "end": "1920279"
  },
  {
    "text": "account single time you can turn that off um but then also if you do have it",
    "start": "1920279",
    "end": "1926000"
  },
  {
    "text": "uh you can choose where to put it which S3 bucket and how long you want that report to be available using the presign",
    "start": "1926000",
    "end": "1931480"
  },
  {
    "text": "URL and this is hours so by default we set it up so it's available for S days after that you cannot use that URL",
    "start": "1931480",
    "end": "1938360"
  },
  {
    "text": "anymore um we also have a feature so we can obate the result and this is more if you want to share it with multiple",
    "start": "1938360",
    "end": "1944120"
  },
  {
    "text": "people and you don't want to show which account information account number it is account number is not a secret but for",
    "start": "1944120",
    "end": "1949240"
  },
  {
    "text": "internal competition um you can choose whether or not you want to show that otherwise it's just going to replace it with the",
    "start": "1949240",
    "end": "1954480"
  },
  {
    "text": "account number one um and then finally whether or not you want that script to be uh published out to uh the uh the",
    "start": "1954480",
    "end": "1961720"
  },
  {
    "text": "console um so if you run it on your local uh local computer it's going to push it out to the console there if you",
    "start": "1961720",
    "end": "1968200"
  },
  {
    "text": "run it in um Cloud sorry in um config rule you can actually get the full",
    "start": "1968200",
    "end": "1973720"
  },
  {
    "text": "report from the cloudwatch logs uh database as well so just go into Cloud logs and it's going to be available",
    "start": "1973720",
    "end": "1978760"
  },
  {
    "text": "there as well as an output couple of options in here every",
    "start": "1978760",
    "end": "1984559"
  },
  {
    "text": "items uh all the controls are completely isolated that means that you can individually make changes in a control",
    "start": "1984559",
    "end": "1991760"
  },
  {
    "text": "and not affect any other control checks uh there are a couple of um centralized resources so when you build things like",
    "start": "1991760",
    "end": "1998600"
  },
  {
    "text": "this this is why we built this showed it you can build a full framework and compliance framework in this case we use",
    "start": "1998600",
    "end": "2004960"
  },
  {
    "text": "the CIS controls you can map this to any framework that you have and that you have to follow and get a full inventory",
    "start": "2004960",
    "end": "2011039"
  },
  {
    "text": "of your account um couple of items though is that there are some resources that you don't want to hammer too much",
    "start": "2011039",
    "end": "2017200"
  },
  {
    "text": "and do in individual controls so we lift out for example credentials report because it's a full report that you run",
    "start": "2017200",
    "end": "2023600"
  },
  {
    "text": "on the account and you have to wait for it to be delivered takes a couple of seconds um but we don't want to do that",
    "start": "2023600",
    "end": "2028919"
  },
  {
    "text": "for every control that uses it same thing with password policy uh and same thing with Cloud shells it's things",
    "start": "2028919",
    "end": "2035120"
  },
  {
    "text": "that's going to be reused because they will not change change during the time of the script uh we just export those uh",
    "start": "2035120",
    "end": "2040880"
  },
  {
    "text": "sorry we uh get those in a central location and then use those to pass parameters to the different controls but",
    "start": "2040880",
    "end": "2046720"
  },
  {
    "text": "besides that all controls are isolated in its own function um so you can easily",
    "start": "2046720",
    "end": "2051800"
  },
  {
    "start": "2047000",
    "end": "2047000"
  },
  {
    "text": "turn on and off them change them if CIS updates the control framework it has a",
    "start": "2051800",
    "end": "2057720"
  },
  {
    "text": "um um a change list so you can go in and see okay control number 1.1 changed okay",
    "start": "2057720",
    "end": "2063398"
  },
  {
    "text": "we can go in and change 1.1 all the controls are structured exactly the same we have an insection",
    "start": "2063399",
    "end": "2070720"
  },
  {
    "text": "with all the information we need so result fail reason offenders control number things like that we have a",
    "start": "2070720",
    "end": "2076760"
  },
  {
    "text": "midsection which is the actual control this is exactly what we're doing so in this case we're just going to see if the",
    "start": "2076760",
    "end": "2082560"
  },
  {
    "text": "cloud Trails have log file validation enabled on them and we have a last section which is the return function and",
    "start": "2082560",
    "end": "2089480"
  },
  {
    "text": "here's all the information We Gather so the only thing that you need to change is the middle section all the other",
    "start": "2089480",
    "end": "2094839"
  },
  {
    "text": "pieces are the same for all the different controls and this is just to simplify updates uh simplify reusability",
    "start": "2094839",
    "end": "2102040"
  },
  {
    "text": "and make it easy to understand how they're built um we also have as I mentioned the",
    "start": "2102040",
    "end": "2107280"
  },
  {
    "text": "evaluation uh the um config rule integration so once it's run through",
    "start": "2107280",
    "end": "2112680"
  },
  {
    "text": "this it's simply going to see do we have any kind of annotations and any kind of failures on it if so we're going to",
    "start": "2112680",
    "end": "2118800"
  },
  {
    "text": "report it back as a non-compliant if not we're going to say it is compliant and if you go into config you're going to",
    "start": "2118800",
    "end": "2123920"
  },
  {
    "text": "see a green Mark where it says your CIS Benchmark control is green you're good to go or it's going to say your C",
    "start": "2123920",
    "end": "2131200"
  },
  {
    "text": "compliance is red here's why and as I mentioned use annotation",
    "start": "2131200",
    "end": "2138599"
  },
  {
    "text": "annotation is absolutely fantastic um there's a couple of Cavs",
    "start": "2138599",
    "end": "2143640"
  },
  {
    "text": "with annotation or actually it's one annotation uh Cavit it supports 256 characters so if we have a lot of",
    "start": "2143640",
    "end": "2150200"
  },
  {
    "text": "failures we have to make sure that we don't exceed that number or the control the uh evaluation will not be accepted",
    "start": "2150200",
    "end": "2156400"
  },
  {
    "text": "by conf fig so we just want to make sure we introduce fail saves there and this is the same when you build something on",
    "start": "2156400",
    "end": "2161880"
  },
  {
    "text": "your own as well introduce the fail saves test it out um we have the HTML report um you",
    "start": "2161880",
    "end": "2169520"
  },
  {
    "text": "might wonder why we're not using one of those super fancy libraries um there's a ton of different uh good libraries to",
    "start": "2169520",
    "end": "2176400"
  },
  {
    "text": "build uh HTML reports the downside of using external libraries is that you might have to create a um zip file with",
    "start": "2176400",
    "end": "2183520"
  },
  {
    "text": "all the code instead uh instead of just using a single python file so in this",
    "start": "2183520",
    "end": "2189000"
  },
  {
    "text": "case to avoid having multiple files uh which means that when you upload it to Lambda you cannot see the code straight",
    "start": "2189000",
    "end": "2195119"
  },
  {
    "text": "into the the console and also if you want to send it to someone you can just give them the the python file uh we just",
    "start": "2195119",
    "end": "2201720"
  },
  {
    "text": "built uh our own um HTML generator that is not super fancy but if you need to",
    "start": "2201720",
    "end": "2207440"
  },
  {
    "text": "change something and you want to introduce like your own logos or whatever you can just go in here and add your own Graphics your own information",
    "start": "2207440",
    "end": "2214200"
  },
  {
    "text": "if you want something else to to show up there you can just add whatever you want to straight in the the the main python",
    "start": "2214200",
    "end": "2220720"
  },
  {
    "text": "file there's no external libraries that you're dependent on when it comes to the the HML",
    "start": "2220720",
    "end": "2227520"
  },
  {
    "text": "file and like I said uh S3 Library if you want to do the the report uh make",
    "start": "2227920",
    "end": "2233640"
  },
  {
    "text": "sure you provide a bucket where you can deliver but you absolutely want to use presign URLs so you can get a secure",
    "start": "2233640",
    "end": "2238960"
  },
  {
    "text": "method of sharing that information and make sure you set an expiration date on",
    "start": "2238960",
    "end": "2244680"
  },
  {
    "text": "it so if we switch",
    "start": "2245599",
    "end": "2250680"
  },
  {
    "text": "over so as I mentioned we have a number of different uh controls in the beginning uh that just sets options for",
    "start": "2256240",
    "end": "2262520"
  },
  {
    "text": "the the actual script um and then it is a large amount of different controls so",
    "start": "2262520",
    "end": "2268160"
  },
  {
    "text": "when you write your control framework like this keep in mind that some of them will be super easy some of them is",
    "start": "2268160",
    "end": "2274520"
  },
  {
    "text": "literally two lines of code while some of them will require you to do a lot of more code so this is all part of the",
    "start": "2274520",
    "end": "2281319"
  },
  {
    "text": "same one where we have to calculate time Deltas between now and from when we thought something happened or time Delta",
    "start": "2281319",
    "end": "2288040"
  },
  {
    "text": "between when something was used the first time to now um sometimes they get a little complicated uh and in other",
    "start": "2288040",
    "end": "2294839"
  },
  {
    "text": "cases um like I said it's just a single um a single check that says do you",
    "start": "2294839",
    "end": "2301680"
  },
  {
    "text": "require uppercase in passwords no okay good that's the only thing that you need to check",
    "start": "2301680",
    "end": "2307440"
  },
  {
    "text": "but uh the benefit of isolating them like I said is very easy to replace um",
    "start": "2307440",
    "end": "2312720"
  },
  {
    "text": "and it is a lot of lot of text um so if we go",
    "start": "2312720",
    "end": "2320078"
  },
  {
    "text": "to eventually we'll get there to the end um as I mentioned you",
    "start": "2321520",
    "end": "2329720"
  },
  {
    "text": "can go in and individually enable and disable the different controls that you want to run if there is something that",
    "start": "2329720",
    "end": "2335440"
  },
  {
    "text": "you don't want to run because it doesn't apply to you it's not of interest to you just go in and disable it um there's no",
    "start": "2335440",
    "end": "2341599"
  },
  {
    "text": "point in having a failed report for something that doesn't apply to you and you can do that for each",
    "start": "2341599",
    "end": "2348079"
  },
  {
    "text": "individual controls um and one key item here as well is that um if you want to",
    "start": "2348079",
    "end": "2354480"
  },
  {
    "text": "run it in config rules you don't need to do any changes to it it will automatically detect if it's called from",
    "start": "2354480",
    "end": "2360560"
  },
  {
    "text": "config rules and just adapt to it and report back the information needed for config rules so there's no no need to do",
    "start": "2360560",
    "end": "2367079"
  },
  {
    "text": "anything just download it run it on your computer test it run it externally um",
    "start": "2367079",
    "end": "2372440"
  },
  {
    "text": "there's also a Json policy document with all the permissions that are required by the CRS control uh and by the Lambda",
    "start": "2372440",
    "end": "2379440"
  },
  {
    "text": "function so you don't give it overly uh too many permissions you only need to give the permissions that are listed",
    "start": "2379440",
    "end": "2384920"
  },
  {
    "text": "there uh and they are all described calls um except for the put evaluation and uploading the S3 bucket and also of",
    "start": "2384920",
    "end": "2392200"
  },
  {
    "text": "course creating Cloud Wars logs because it's a Lambda function so so go outad and check it out",
    "start": "2392200",
    "end": "2397520"
  },
  {
    "text": "today highly recommend uh if we switch to the other",
    "start": "2397520",
    "end": "2403160"
  },
  {
    "text": "one so the next one I want to check uh look at is aut MFA for IM users so this",
    "start": "2406000",
    "end": "2412599"
  },
  {
    "text": "is something I created a while ago uh because we had a couple of customers that thought that when they create IM users they don't want to have to call",
    "start": "2412599",
    "end": "2419359"
  },
  {
    "text": "the the user to ask them to pick up their phone to do their MFA token to give them the two tokens back it's it",
    "start": "2419359",
    "end": "2425839"
  },
  {
    "text": "was time assuming um they also want to be able to bulk create users and know that they still get an MFA user uh sorry",
    "start": "2425839",
    "end": "2433440"
  },
  {
    "text": "MFA token assigned to them so this feature will actually look for anytime you create an IM user once you've done",
    "start": "2433440",
    "end": "2440920"
  },
  {
    "text": "that it's going to automatically create an NFA token a virtual MFA token um calculate the numbers needed the two six",
    "start": "2440920",
    "end": "2448440"
  },
  {
    "text": "digigit numbers assign that token to the user take that string so when you create a virtual token you get something uh um",
    "start": "2448440",
    "end": "2455839"
  },
  {
    "text": "a 302 string seed a seed that we going to store in a Dynamo table encrypted",
    "start": "2455839",
    "end": "2461560"
  },
  {
    "text": "format and that's the only token that you need to give the user so when they feel ready uh to start using it you can",
    "start": "2461560",
    "end": "2468200"
  },
  {
    "text": "just give them that uh string uh same process as when you give them out the U",
    "start": "2468200",
    "end": "2474520"
  },
  {
    "text": "the access keys or the username and password give them that token string and they just copy paste that straight into",
    "start": "2474520",
    "end": "2480119"
  },
  {
    "text": "their uh Google Authenticator or whatever two Factor authentication system they use and it's ready to go",
    "start": "2480119",
    "end": "2486520"
  },
  {
    "text": "synced up and they have a two Factor authentication without having to talk to the admin at all um and you can",
    "start": "2486520",
    "end": "2492560"
  },
  {
    "text": "Implement that using whatever distribution tools that you have I don't know if if you use um well whatever chat",
    "start": "2492560",
    "end": "2499880"
  },
  {
    "text": "chat system or uh paper system that you have to give them the access tokens just add the MFA token as a separate part of",
    "start": "2499880",
    "end": "2507000"
  },
  {
    "text": "course because you don't want to send everything into the same package uh so if",
    "start": "2507000",
    "end": "2512520"
  },
  {
    "text": "we demo this if you switch over",
    "start": "2512520",
    "end": "2518240"
  },
  {
    "text": "so this demo is not the most exciting one not it's even",
    "start": "2520240",
    "end": "2526440"
  },
  {
    "text": "though in the movie theater so we're just going to say that",
    "start": "2526440",
    "end": "2531880"
  },
  {
    "text": "I'm going to create a MFA test user so this is just going to go in and look for okay we don't have a user um so",
    "start": "2531880",
    "end": "2539480"
  },
  {
    "text": "it's going to create the user and then it's just going to sit there and PLL so this is just a demo script everything happens on the back end so it doesn't",
    "start": "2539480",
    "end": "2546000"
  },
  {
    "text": "matter if you run one user or a thousand users that you create it's just going to batch up in the background and kick off",
    "start": "2546000",
    "end": "2551800"
  },
  {
    "text": "a bunch of Lambda functions and this is where we have the whole um scalability from Lambda and the benefit of using",
    "start": "2551800",
    "end": "2558119"
  },
  {
    "text": "that so in this case we see that okay we found a user in the back end uh and we found that that user also had an MFA",
    "start": "2558119",
    "end": "2564839"
  },
  {
    "text": "token now and we see that we got an MFA token we got a version MF created it got",
    "start": "2564839",
    "end": "2571520"
  },
  {
    "text": "assigned to the user and we can see that it had a serial number a username a 32bit string seed number and that seed",
    "start": "2571520",
    "end": "2578680"
  },
  {
    "text": "number is stored now in the backend database using KMS encryption because we don't want to store",
    "start": "2578680",
    "end": "2584040"
  },
  {
    "text": "unencrypted and once we need to send that out to the user we can either have a script we can have a separate Lambda",
    "start": "2584040",
    "end": "2590200"
  },
  {
    "text": "function and have that as the only one that has access to that uh KMS key so we",
    "start": "2590200",
    "end": "2595559"
  },
  {
    "text": "know that no one can get that information without having access to the KMS key and as I said it doesn't look",
    "start": "2595559",
    "end": "2601520"
  },
  {
    "text": "much reward in a in a console but what happened was that uh actually let show",
    "start": "2601520",
    "end": "2607200"
  },
  {
    "text": "you that just switch over",
    "start": "2607200",
    "end": "2611040"
  },
  {
    "text": "again so what happened was that we have our priority action um in this case it's",
    "start": "2613480",
    "end": "2619040"
  },
  {
    "start": "2614000",
    "end": "2614000"
  },
  {
    "text": "look for the user so when the user is created we're simply going to look for create an MFA token so in this case we",
    "start": "2619040",
    "end": "2625920"
  },
  {
    "text": "have our priority action is a number of steps it's not just one step but we have them in the order we need to do them so",
    "start": "2625920",
    "end": "2632480"
  },
  {
    "text": "we need to First create the MFA token because without that token we can't that get that seed string then we need to",
    "start": "2632480",
    "end": "2638760"
  },
  {
    "text": "calculate the numbers for the actual MFA token so first of we create a virtual",
    "start": "2638760",
    "end": "2645040"
  },
  {
    "start": "2642000",
    "end": "2642000"
  },
  {
    "text": "MFA uh we name it the same as the username so we can easily find them using um any kind of automation we just",
    "start": "2645040",
    "end": "2651920"
  },
  {
    "text": "name it username Dash have an MFA um and then we verify that it actually got created if not we just",
    "start": "2651920",
    "end": "2658400"
  },
  {
    "text": "retry and make sure we have a retry structure uh we have a fail save so in case this in case it cannot assign an",
    "start": "2658400",
    "end": "2665119"
  },
  {
    "text": "MFA token to use User it's actually going to delete that user and send a report back because we don't want to",
    "start": "2665119",
    "end": "2670240"
  },
  {
    "text": "send out the user by mistake that didn't get an MFA token assigned um and then we're going to do",
    "start": "2670240",
    "end": "2676160"
  },
  {
    "start": "2675000",
    "end": "2675000"
  },
  {
    "text": "the uh enable the MFA and if you run these kind of scripts and if you create them yourself especially when working",
    "start": "2676160",
    "end": "2681400"
  },
  {
    "text": "with MFA tokens so you can generate that seed number with a seed that is less than six characters but it has to be six",
    "start": "2681400",
    "end": "2687880"
  },
  {
    "text": "characters so in this case we simply generate a token until we get a token that has six characters and this is a um",
    "start": "2687880",
    "end": "2696200"
  },
  {
    "text": "uh h-based token so it's not a Time based token it's an hmac based token so",
    "start": "2696200",
    "end": "2701319"
  },
  {
    "text": "hotp um and we're going to try that and we also need to create two tokens because we need to add both of them so",
    "start": "2701319",
    "end": "2707119"
  },
  {
    "text": "we create the first one we wait a little bit because there's a time between them we have a 30 second timeout when we",
    "start": "2707119",
    "end": "2712960"
  },
  {
    "text": "calculate the actual hmac token and time based token and it's a Time based token",
    "start": "2712960",
    "end": "2718040"
  },
  {
    "text": "that we want to have in the end um so we create the first one we create the second one we compare them and make sure",
    "start": "2718040",
    "end": "2723960"
  },
  {
    "text": "that a they're not the same because then the time wasn't enough and also that both of them are six",
    "start": "2723960",
    "end": "2730319"
  },
  {
    "text": "characters and the six characters is really important otherwise it will fail uh once we have that uh oh actually",
    "start": "2730319",
    "end": "2737520"
  },
  {
    "text": "so the way we calculate is by using an hmac uh function so we use hmac bas6 to4",
    "start": "2737520",
    "end": "2742559"
  },
  {
    "text": "decode um and then offset function so this is just available in the script you can go in and take a look at it if you",
    "start": "2742559",
    "end": "2748520"
  },
  {
    "text": "want to and see if you want to change something uh but this is just a way to generate the actual hemac",
    "start": "2748520",
    "end": "2754680"
  },
  {
    "text": "token um and once we have it we're going to take both of those two token together",
    "start": "2754680",
    "end": "2760079"
  },
  {
    "text": "with the serial number for the MFA token and assign it to the user and verify that yes we could assign it if it fails",
    "start": "2760079",
    "end": "2766359"
  },
  {
    "text": "we're just going to fail that user and delete it again again we want to make sure that it's",
    "start": "2766359",
    "end": "2772280"
  },
  {
    "text": "foolproof um and finally once we created user once we created MFA token store the",
    "start": "2772280",
    "end": "2777599"
  },
  {
    "text": "information back here uh so we can extract it later really really important I said it many times encrypt the",
    "start": "2777599",
    "end": "2783960"
  },
  {
    "text": "information uh it's really easy to call KMS directly from Lambda uh so just add",
    "start": "2783960",
    "end": "2790359"
  },
  {
    "text": "a string that encrypts the cipher text and this is the 32bit seed string that you're going to give to the user so they",
    "start": "2790359",
    "end": "2796240"
  },
  {
    "text": "can add to the Token because that Streed string is their MFA token that is the equivalent of sending them the hardware",
    "start": "2796240",
    "end": "2803200"
  },
  {
    "text": "token so you need to protect it and don't send it in the same package with",
    "start": "2803200",
    "end": "2808319"
  },
  {
    "text": "the username and password if we can switch again",
    "start": "2808319",
    "end": "2817800"
  },
  {
    "text": "so again this script is not uh this is also available uh to download it's not that complicated from a script",
    "start": "2819319",
    "end": "2825680"
  },
  {
    "text": "perspective um the piece that I may want to make sure here is that make sure you see that it's approved make sure that",
    "start": "2825680",
    "end": "2832040"
  },
  {
    "text": "you see that it went through and they use a got the token assigned to them um",
    "start": "2832040",
    "end": "2837400"
  },
  {
    "text": "because otherwise you will not you should not have that user available um it has a preview feature that um I've",
    "start": "2837400",
    "end": "2844040"
  },
  {
    "text": "introduced as well which is create password and this is if you don't want to deal with password as well you can",
    "start": "2844040",
    "end": "2849319"
  },
  {
    "text": "just have the script at a um randomized password and store that in encrypted",
    "start": "2849319",
    "end": "2854559"
  },
  {
    "text": "seed as well in the uh the Dynamo table using KMS and that's also to reduce the",
    "start": "2854559",
    "end": "2860559"
  },
  {
    "text": "amount of information that the administrators have because they should not have the username and password for",
    "start": "2860559",
    "end": "2866240"
  },
  {
    "text": "uh that user as well this is also why we want to have this system created where on a human that is sitting there doing",
    "start": "2866240",
    "end": "2872400"
  },
  {
    "text": "things um we want to remove the human part from from the security",
    "start": "2872400",
    "end": "2878440"
  },
  {
    "text": "validation and then simply create the log data and in this case we're going to add more than just the string we want to",
    "start": "2878640",
    "end": "2884559"
  },
  {
    "text": "add for example where was run who actually created this because we also want to know who created that user was",
    "start": "2884559",
    "end": "2890319"
  },
  {
    "text": "it someone this approved to do it or not we switch over",
    "start": "2890319",
    "end": "2898880"
  },
  {
    "text": "again so the last script we're going to show is the tainted server uh and what we",
    "start": "2902680",
    "end": "2909520"
  },
  {
    "start": "2903000",
    "end": "2903000"
  },
  {
    "text": "mean with that is that let's say we have an immutable infrastructure no one is supposed to log on to the SSS at all um",
    "start": "2909520",
    "end": "2916480"
  },
  {
    "text": "in some cases people remove the the ability completely by removing SSH access um but that's not practical in",
    "start": "2916480",
    "end": "2922359"
  },
  {
    "text": "some cases because you might have a need to go in um as a sort of a super administrative mode um even though it's",
    "start": "2922359",
    "end": "2929119"
  },
  {
    "text": "immutable you might have to go in and extract some information or you have processes that need to go in and do",
    "start": "2929119",
    "end": "2934359"
  },
  {
    "text": "something um but what we want to do is prevent users from logging on so in this",
    "start": "2934359",
    "end": "2939520"
  },
  {
    "text": "case we actually have infrastructure that is deployed with a cloudformation template in an Autos Skilling group and",
    "start": "2939520",
    "end": "2945920"
  },
  {
    "text": "a script running on that server so anytime someone logs on locally on that",
    "start": "2945920",
    "end": "2951319"
  },
  {
    "text": "script uh on that server um the server will be automatically ripped out of this the autoscaling group and ripped out of",
    "start": "2951319",
    "end": "2958280"
  },
  {
    "text": "the uh elb and ALB um assigned a isolation Security",
    "start": "2958280",
    "end": "2963720"
  },
  {
    "text": "Group that's going to isolate it on network because we still want to maintain the server in case we need to do forensics why someone logged on to",
    "start": "2963720",
    "end": "2970240"
  },
  {
    "text": "that server uh but it's going to rip it out of the network and just isolated on network for you as a security team to go",
    "start": "2970240",
    "end": "2976839"
  },
  {
    "text": "in and do whatever it is that you need to do and it's simply going to AO heal because we using uh Autos scaling groups",
    "start": "2976839",
    "end": "2983240"
  },
  {
    "text": "the environment will just Auto heal itself uh so in this case we're using Cloud logs config rules um and we can",
    "start": "2983240",
    "end": "2990079"
  },
  {
    "text": "use cloud logs or uh Cloud events or config rules in this case uh it's more do you want to run it on a daily basis",
    "start": "2990079",
    "end": "2996799"
  },
  {
    "text": "so for example if it's it's not the end of the world if someone logs on to them but we don't want to have them in",
    "start": "2996799",
    "end": "3002319"
  },
  {
    "text": "production because something happened you can run this on a Time basis run it once a day and just clean up all the",
    "start": "3002319",
    "end": "3007400"
  },
  {
    "text": "servers that have been um touched by human or you can run it using Cloud events and run it instantly when someone",
    "start": "3007400",
    "end": "3013920"
  },
  {
    "text": "logs onto it and then use Lambda uh you can also tie this into VPC flow logs and",
    "start": "3013920",
    "end": "3019119"
  },
  {
    "text": "get the information there so if you start seeing weird behavior in VPC flow logs you can use exactly the same script",
    "start": "3019119",
    "end": "3025760"
  },
  {
    "text": "uh just change where it's triggering from so instead of triggering from um the taging event it triggers from for",
    "start": "3025760",
    "end": "3032280"
  },
  {
    "text": "example a VPC flow log analyzer in this case uh because it's the easiest way to show it we're actually using tagging um",
    "start": "3032280",
    "end": "3039880"
  },
  {
    "text": "to determine if someone has logged onto the server or not um you can use any type of event so the way we do it is",
    "start": "3039880",
    "end": "3046559"
  },
  {
    "text": "that we trigger a uh awli command on the server uh that we then pick up using",
    "start": "3046559",
    "end": "3052599"
  },
  {
    "text": "cloudwatch events uh in this case we use tagging with a specific string but you can do any type of event",
    "start": "3052599",
    "end": "3059040"
  },
  {
    "text": "there so if we switch",
    "start": "3059040",
    "end": "3062920"
  },
  {
    "text": "over this is the most scary demo if it works or not so we can see that we have a",
    "start": "3069040",
    "end": "3077240"
  },
  {
    "text": "instance up and running with an IP address uh it has a security group called instant Security Group nothing",
    "start": "3077240",
    "end": "3082440"
  },
  {
    "text": "strange um it's part of a cloud information stack called the tainted server and has a Autos scaling group",
    "start": "3082440",
    "end": "3091280"
  },
  {
    "text": "name we then go in and you can see that those are the only tags that are available on that",
    "start": "3095640",
    "end": "3102720"
  },
  {
    "text": "server so we now log on to that",
    "start": "3102720",
    "end": "3107240"
  },
  {
    "text": "server and we wait for our outut update and we see now that server has another tag so so suddenly got a tag called",
    "start": "3110280",
    "end": "3116920"
  },
  {
    "text": "tainted that means that someone actually logged on to that server they didn't do anything but they logged on that's",
    "start": "3116920",
    "end": "3122280"
  },
  {
    "text": "enough for us to be uh",
    "start": "3122280",
    "end": "3125920"
  },
  {
    "text": "suspicious so let's",
    "start": "3130480",
    "end": "3138280"
  },
  {
    "text": "oops so we're just going to trigger something so we can see that the server is actually Alive and Kicking um",
    "start": "3139280",
    "end": "3146359"
  },
  {
    "text": "and this is where my My Demo environment failed a little bit earlier so we'll see if it actually works this",
    "start": "3146359",
    "end": "3153839"
  },
  {
    "text": "time so if we switch over to the other screen while that is going in the",
    "start": "3155440",
    "end": "3161319"
  },
  {
    "text": "background because what is going to happen is that it's a number of different steps so we're going to go and check the code",
    "start": "3161319",
    "end": "3167119"
  },
  {
    "text": "first when you if you test this script there's one really really important thing that you got to decide first do",
    "start": "3167119",
    "end": "3173040"
  },
  {
    "text": "you want to isolate non AOS scaling group instances so this is adapted to handle Autos scaling because Autos",
    "start": "3173040",
    "end": "3178400"
  },
  {
    "text": "scaling has a cell feel um you might not want to do this on non autoscaling group",
    "start": "3178400",
    "end": "3183599"
  },
  {
    "text": "servers you might just want to send an alert instead because if you do that on something that is not it will not repair",
    "start": "3183599",
    "end": "3189400"
  },
  {
    "text": "itself so make sure you do an active Choice there this is a good way to get phone calls",
    "start": "3189400",
    "end": "3194960"
  },
  {
    "start": "3193000",
    "end": "3193000"
  },
  {
    "text": "otherwise um so what we do is simply that we look for all the servers that have that tagging um which is called the",
    "start": "3194960",
    "end": "3200799"
  },
  {
    "text": "tainted server so we look for that tag extract all the information on it uh this is a lot of info on one page but uh",
    "start": "3200799",
    "end": "3208160"
  },
  {
    "text": "one key item here is since we're triggering on tagging",
    "start": "3208160",
    "end": "3213640"
  },
  {
    "text": "normally you can trigger on anything like I said we trigger on tagging tagging happens a lot even when autoscaling spins up a server it will",
    "start": "3213640",
    "end": "3220720"
  },
  {
    "text": "tag the inst with the Autos scaling information so we don't want to trigger we want to make sure that we don't do",
    "start": "3220720",
    "end": "3226000"
  },
  {
    "text": "anything on the Autos scaling instances because otherwise we're just going to end up in a loop where as soon as Autos scaling kicks up a server we're going to",
    "start": "3226000",
    "end": "3232559"
  },
  {
    "text": "isolate it and we're going to make Autos scaling really mad so make sure that you extract the",
    "start": "3232559",
    "end": "3237880"
  },
  {
    "text": "information and don't do anything on server that are not affected by it you can use another command as well like I",
    "start": "3237880",
    "end": "3243079"
  },
  {
    "text": "said doesn't have to be tagging the benefit of cloudwatch events is that it doesn't even have to succeed you can run",
    "start": "3243079",
    "end": "3249680"
  },
  {
    "text": "any command and just say that hey if I see this event and it failed then I want to run my script so you can run",
    "start": "3249680",
    "end": "3256079"
  },
  {
    "text": "something that no one would ever run or no one would ever touch second item here is that uh this",
    "start": "3256079",
    "end": "3262400"
  },
  {
    "text": "script also has an Autos sense feature so if you run this manually or through a",
    "start": "3262400",
    "end": "3267480"
  },
  {
    "text": "script uh instead of running it as part of a cloud events so you can run it both as Cloud events or you can run it as um",
    "start": "3267480",
    "end": "3275200"
  },
  {
    "text": "config rules it needs to adapt because should it run on a single instance or should it run on multiple",
    "start": "3275200",
    "end": "3282040"
  },
  {
    "text": "instances um and then what we're going to do is that we're just going to detach it from the Autos scaling group and rip it out there uh key item here is should",
    "start": "3282040",
    "end": "3289839"
  },
  {
    "text": "you um decrease the uh descided capacity on the outou scaling groups no we don't",
    "start": "3289839",
    "end": "3295240"
  },
  {
    "text": "otherwise we're going to drain that out scaling group we want to make sure that it just self",
    "start": "3295240",
    "end": "3300400"
  },
  {
    "start": "3300000",
    "end": "3300000"
  },
  {
    "text": "heals um second thing we want to identify the security group that we're going to use because our isolation group",
    "start": "3300400",
    "end": "3306920"
  },
  {
    "text": "is a security group it's bound by the VPC so if you have multiple vpcs we got to make sure that we extract the right",
    "start": "3306920",
    "end": "3312720"
  },
  {
    "text": "one so first check what what VPC is This Server running in and use that specific",
    "start": "3312720",
    "end": "3319640"
  },
  {
    "text": "VPC one really important thing here as well key word here is that we're isolating it",
    "start": "3320240",
    "end": "3325760"
  },
  {
    "text": "when you default create a security group it allows eess traffic so when our",
    "start": "3325760",
    "end": "3331680"
  },
  {
    "text": "script has found the right Security Group to use it's going to validate and see that there's no egress rule on it uh",
    "start": "3331680",
    "end": "3338280"
  },
  {
    "text": "if it is it's going to remove that egress rule uh that is also a default um",
    "start": "3338280",
    "end": "3343440"
  },
  {
    "text": "check on the Cs Foundation framework that you don't have the default security groups in there but we we don't want any",
    "start": "3343440",
    "end": "3349680"
  },
  {
    "text": "ESS traffic we don't want Ingress or ESS um finally we're going to take that",
    "start": "3349680",
    "end": "3355599"
  },
  {
    "text": "security group and we're going to assign it uh directly to the server and that Security Group will lock all kind of",
    "start": "3355599",
    "end": "3361119"
  },
  {
    "text": "access on that server and if we switch back uh we can now see that there are",
    "start": "3361119",
    "end": "3368839"
  },
  {
    "text": "two servers there uh there is one I don't know if we can see that we can",
    "start": "3368839",
    "end": "3375599"
  },
  {
    "text": "do there we go um we can see that we have um a new server we can see that the",
    "start": "3375599",
    "end": "3383319"
  },
  {
    "text": "security group on the top server oh on the bottom server is the instant security group that we created with the",
    "start": "3383319",
    "end": "3388680"
  },
  {
    "text": "server when we spun up in the other scaling group and we can see that the top server now has a security group",
    "start": "3388680",
    "end": "3393839"
  },
  {
    "text": "called isolation Security Group so what happened was that the script found the server ripped out the the ripped it out",
    "start": "3393839",
    "end": "3401319"
  },
  {
    "text": "from the autoscaling group assigned the new isolation server on it an isolation Security Group on it and autoscaling",
    "start": "3401319",
    "end": "3407839"
  },
  {
    "text": "just simply self healed and put in a new uh Security Group and we can also see that my SSH connection to that server",
    "start": "3407839",
    "end": "3415400"
  },
  {
    "text": "that I was running a ping on got killed because I no longer have either egress",
    "start": "3415400",
    "end": "3420480"
  },
  {
    "text": "or Ingress access to that server so the server can no longer send data to me so if you had a malicious attempt there",
    "start": "3420480",
    "end": "3427319"
  },
  {
    "text": "that user have no access anymore but the server is available and this is the key the serve is still available for",
    "start": "3427319",
    "end": "3435200"
  },
  {
    "text": "forensics oops if we switch back uh before we end I want to give you",
    "start": "3436640",
    "end": "3442200"
  },
  {
    "text": "a couple of uh heads up on some other projects out there so these are a couple of code examples that we released just because we want to get you something in",
    "start": "3442200",
    "end": "3448559"
  },
  {
    "text": "your hands that you can use as is or modify uh for your needs uh here's a",
    "start": "3448559",
    "end": "3453960"
  },
  {
    "text": "couple of other uh there are many more projects out there but I want to do want to highlight that uh these are good to",
    "start": "3453960",
    "end": "3459760"
  },
  {
    "text": "start with when you want to go into the secur automation world uh there's a lot of stuff that you can do out here um so",
    "start": "3459760",
    "end": "3465960"
  },
  {
    "text": "for example we have threat respons of cloud uh Cloud custodian um security monkey and Pho are Netflix projects um",
    "start": "3465960",
    "end": "3472920"
  },
  {
    "text": "Cloud exploit is a um uh cloud is also available Cloud custodian is by Capital One uh they",
    "start": "3472920",
    "end": "3479760"
  },
  {
    "text": "release their internal framework as well so there's a lot of people that have uh build different kind of Frameworks so if",
    "start": "3479760",
    "end": "3485039"
  },
  {
    "text": "you don't want to build your own or if you don't want to start on a sort of an individual level go out there and get",
    "start": "3485039",
    "end": "3490440"
  },
  {
    "text": "the scripts available for you today um as I said reminder you can",
    "start": "3490440",
    "end": "3496079"
  },
  {
    "text": "download them today to test it um most of them are available today some of them will Avail will be available during the",
    "start": "3496079",
    "end": "3501839"
  },
  {
    "text": "week uh the CIS Foundation framework is ailable today um couple of other sessions most",
    "start": "3501839",
    "end": "3508720"
  },
  {
    "start": "3506000",
    "end": "3506000"
  },
  {
    "text": "of them have actually happened already uh but once conferen is out go out on",
    "start": "3508720",
    "end": "3513799"
  },
  {
    "text": "YouTube uh definitely check out these sessions on secured automation um this",
    "start": "3513799",
    "end": "3518920"
  },
  {
    "text": "are really cool sessions by some awesome people so go in and check them out on YouTube um otherwise want to thank you",
    "start": "3518920",
    "end": "3525920"
  },
  {
    "text": "for coming uh it's awesome to see so many people are interested in Secure automation um and absolutely remember to",
    "start": "3525920",
    "end": "3532000"
  },
  {
    "text": "come fill out your surveys uh we want your feedback otherwise uh I'm going to be available",
    "start": "3532000",
    "end": "3537799"
  },
  {
    "text": "after for answering question probably going to get kicked out so I'm going to stand right outside the theater happy to",
    "start": "3537799",
    "end": "3543559"
  },
  {
    "text": "answer any question I don't have any meetings uh if you want to go uh the final night part is tonight I think um",
    "start": "3543559",
    "end": "3549720"
  },
  {
    "text": "otherwise thank you so much",
    "start": "3549720",
    "end": "3557520"
  }
]