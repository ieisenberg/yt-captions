[
  {
    "start": "0",
    "end": "22000"
  },
  {
    "text": "Welcome to\n\"This is my Architecture.\"",
    "start": "6580",
    "end": "8220"
  },
  {
    "text": "I'm Matt from AWS.",
    "start": "8220",
    "end": "9590"
  },
  {
    "text": "Today, I'm joined by\nRoaan from Atlassian.",
    "start": "9590",
    "end": "11840"
  },
  {
    "text": "Thanks for joining.",
    "start": "11840",
    "end": "12530"
  },
  {
    "text": "- Hi, Matt,\nthanks for having me.",
    "start": "12530",
    "end": "13710"
  },
  {
    "text": "- So, I'm a big Atlassian fan,",
    "start": "13710",
    "end": "15080"
  },
  {
    "text": "Jira, Confluence,\na lot of great products.",
    "start": "15080",
    "end": "17010"
  },
  {
    "text": "But today we're\ngoing to talk about",
    "start": "17010",
    "end": "18330"
  },
  {
    "text": "something called\nAtlassian Forge, right?",
    "start": "18330",
    "end": "19910"
  },
  {
    "text": "- That's correct.",
    "start": "19910",
    "end": "20740"
  },
  {
    "text": "- So tell us\nabout Atlassian Forge.",
    "start": "20740",
    "end": "22550"
  },
  {
    "start": "22000",
    "end": "49000"
  },
  {
    "text": "- Atlassian Forge",
    "start": "22550",
    "end": "23220"
  },
  {
    "text": "is Atlassian's\nnext-generation platform,",
    "start": "23220",
    "end": "25269"
  },
  {
    "text": "enabling customers\nand developers,",
    "start": "25270",
    "end": "27310"
  },
  {
    "text": "third-party vendors to\ndevelop customer applications",
    "start": "27310",
    "end": "29939"
  },
  {
    "text": "and extend our product.",
    "start": "29940",
    "end": "31110"
  },
  {
    "text": "- Okay, so what\ndoes that mean?",
    "start": "31110",
    "end": "32759"
  },
  {
    "text": "Like making different Atlassian\nproducts work together?",
    "start": "32760",
    "end": "34940"
  },
  {
    "text": "- It allows them to make products work together,",
    "start": "34940",
    "end": "37969"
  },
  {
    "text": "they can both\ncustom add-ons.",
    "start": "37970",
    "end": "39480"
  },
  {
    "text": "If they want to share data\nfrom another data source,",
    "start": "39480",
    "end": "42110"
  },
  {
    "text": "they can share it\nin Confluence, for example.",
    "start": "42110",
    "end": "43830"
  },
  {
    "text": "- So I could take\na Jira ticket, for example,",
    "start": "43830",
    "end": "45830"
  },
  {
    "text": "and show it in Confluence?",
    "start": "45830",
    "end": "46740"
  },
  {
    "text": "- You can take a Jira ticket\nand show it in Confluence.",
    "start": "46740",
    "end": "48600"
  },
  {
    "text": "- Okay, cool.",
    "start": "48600",
    "end": "49539"
  },
  {
    "start": "49000",
    "end": "110000"
  },
  {
    "text": "Well, let's dig in to\nhow that actually works.",
    "start": "49540",
    "end": "50920"
  },
  {
    "text": "So I see we have\nCLI and Browser.",
    "start": "50920",
    "end": "55019"
  },
  {
    "text": "How does this all begin?",
    "start": "55020",
    "end": "56060"
  },
  {
    "text": "- So they're basically two\nparts to the Forge platform.",
    "start": "56060",
    "end": "59210"
  },
  {
    "text": "The first part has\nto do with deployment,",
    "start": "59210",
    "end": "61070"
  },
  {
    "text": "because we're\ndeploying customer code.",
    "start": "61070",
    "end": "63190"
  },
  {
    "text": "The second part\nhas to do with invocation",
    "start": "63190",
    "end": "64960"
  },
  {
    "text": "of that customer code,",
    "start": "64960",
    "end": "65890"
  },
  {
    "text": "where we actually execute\nthe code that was deployed.\n- OK",
    "start": "65890",
    "end": "68500"
  },
  {
    "text": "- So I'll take\nyou through the first part.",
    "start": "68500",
    "end": "70620"
  },
  {
    "text": "So it starts with a\ndeveloper writing code",
    "start": "70620",
    "end": "72520"
  },
  {
    "text": "in JavaScript typically.",
    "start": "72520",
    "end": "74450"
  },
  {
    "text": "I then deploy that\nusing our CLI",
    "start": "74450",
    "end": "77759"
  },
  {
    "text": "to one of our services.",
    "start": "77760",
    "end": "80240"
  },
  {
    "text": "- So when you say deploying\ncode or deploying an application,",
    "start": "80240",
    "end": "82060"
  },
  {
    "text": "does that mean\na Lamdba function I'm guessing,",
    "start": "82060",
    "end": "83570"
  },
  {
    "text": "or how does it represent?",
    "start": "83570",
    "end": "84830"
  },
  {
    "text": "- It will eventually turn out\nto be a Lambda function.",
    "start": "84830",
    "end": "86810"
  },
  {
    "text": "To them it looks like\na normal JavaScript function,",
    "start": "86810",
    "end": "89280"
  },
  {
    "text": "which we translate\ninto a Lambda function.",
    "start": "89280",
    "end": "91470"
  },
  {
    "text": "- OK, so the customer in your case",
    "start": "91470",
    "end": "92730"
  },
  {
    "text": "is not writing\na Lambda function;",
    "start": "92730",
    "end": "93740"
  },
  {
    "text": "they're writing the code",
    "start": "93740",
    "end": "94600"
  },
  {
    "text": "and deploying through a\nweb service on EC2.",
    "start": "94600",
    "end": "96380"
  },
  {
    "text": "- That's correct.",
    "start": "96380",
    "end": "97590"
  },
  {
    "text": "These web services\nare behind ALB,",
    "start": "97590",
    "end": "99820"
  },
  {
    "text": "so it can scale to handle the\nload from various customers.",
    "start": "99820",
    "end": "102560"
  },
  {
    "text": "- Okay, and you said scaling.",
    "start": "102560",
    "end": "104500"
  },
  {
    "text": "Are you talking like\nhundreds of customers,",
    "start": "104500",
    "end": "106380"
  },
  {
    "text": "thousand of customers?",
    "start": "106380",
    "end": "107210"
  },
  {
    "text": "What kind of scale\nare we talking about?",
    "start": "107210",
    "end": "108240"
  },
  {
    "text": "- We're talking\nthousands of customers.",
    "start": "108240",
    "end": "109579"
  },
  {
    "text": "- Wow, okay.",
    "start": "109580",
    "end": "110890"
  },
  {
    "start": "110000",
    "end": "134000"
  },
  {
    "text": "So, scalable, sort of, application injection",
    "start": "110890",
    "end": "112909"
  },
  {
    "text": "to your whatever\nyou want to call it.",
    "start": "112910",
    "end": "114050"
  },
  {
    "text": "- Exactly.",
    "start": "114050",
    "end": "115040"
  },
  {
    "text": "- And so what happens next?",
    "start": "115040",
    "end": "116000"
  },
  {
    "text": "- So we need to keep track of all\nthe deployments we want to do.",
    "start": "116000",
    "end": "118800"
  },
  {
    "text": "To do that we store\nthe state in DynamoDB.",
    "start": "118800",
    "end": "122890"
  },
  {
    "text": "This allows us to know the\nprogress of a deployment;",
    "start": "122890",
    "end": "125990"
  },
  {
    "text": "whether it's completed,\nfiled, et cetera,",
    "start": "125990",
    "end": "128050"
  },
  {
    "text": "so we can\nreport back to the user",
    "start": "128050",
    "end": "129000"
  },
  {
    "text": "as to what happened\nto their deployment.",
    "start": "129000",
    "end": "130630"
  },
  {
    "text": "- Great, yeah, Dynamo DB and noSQL database",
    "start": "130630",
    "end": "132350"
  },
  {
    "text": "is great for storing\nthings like state, for example.",
    "start": "132350",
    "end": "134100"
  },
  {
    "text": "- Exactly.",
    "start": "134100",
    "end": "135210"
  },
  {
    "text": "- Now you have multiple EC2s\nwith an SQS queue in the middle.",
    "start": "135210",
    "end": "138250"
  },
  {
    "text": "Why do you\nhave this architecture?",
    "start": "138250",
    "end": "139630"
  },
  {
    "text": "- Well as we mentioned previously,\nwe have thousands of customers",
    "start": "139630",
    "end": "142090"
  },
  {
    "text": "that potentially want\nto do deployment,",
    "start": "142090",
    "end": "143959"
  },
  {
    "text": "and we are typically limit on\nthe control plane on Lambda",
    "start": "143960",
    "end": "147180"
  },
  {
    "text": "on how many\ninvocations we can do,",
    "start": "147180",
    "end": "148739"
  },
  {
    "text": "how many Lambdas we can create\nin a certain time interval.",
    "start": "148740",
    "end": "151750"
  },
  {
    "text": "To account for that,",
    "start": "151750",
    "end": "153160"
  },
  {
    "text": "what we do is we queue the\ndeployment request onto SQS.",
    "start": "153160",
    "end": "157700"
  },
  {
    "text": "Then on the back end,\nwe have a service",
    "start": "157700",
    "end": "160040"
  },
  {
    "text": "that reads the\ndeployment request from SQS.",
    "start": "160040",
    "end": "163329"
  },
  {
    "text": "It can then,\nin its own time,",
    "start": "163330",
    "end": "165250"
  },
  {
    "text": "create the Lambda\nwhen it's allowed to do that.",
    "start": "165250",
    "end": "168640"
  },
  {
    "text": "So it won't be rate-limited.",
    "start": "168640",
    "end": "170360"
  },
  {
    "text": "- Great, so to\navoid rate limiting",
    "start": "170360",
    "end": "171600"
  },
  {
    "text": "for creating new\nfunctions in Lambda,",
    "start": "171600",
    "end": "173000"
  },
  {
    "text": "you sort of separated\nby having a queue in the middle",
    "start": "173000",
    "end": "175900"
  },
  {
    "text": "so you can pull them\noff the queue as you go?",
    "start": "175900",
    "end": "177909"
  },
  {
    "text": "- Exactly.",
    "start": "177910",
    "end": "179130"
  },
  {
    "start": "178000",
    "end": "207000"
  },
  {
    "text": "- OK, now I see there's a line here though.",
    "start": "179130",
    "end": "180480"
  },
  {
    "text": "Does that denote a\nVPC or an account boundary?",
    "start": "180480",
    "end": "183230"
  },
  {
    "text": "What's going on here?",
    "start": "183230",
    "end": "184159"
  },
  {
    "text": "- The line here\nis an account boundary.",
    "start": "184160",
    "end": "186260"
  },
  {
    "text": "So for us, trust or security\nis extremely important.",
    "start": "186260",
    "end": "189019"
  },
  {
    "text": "So the customer code runs in\nits own account.",
    "start": "189020",
    "end": "191620"
  },
  {
    "text": "There's nothing else\nin that account.",
    "start": "191620",
    "end": "193470"
  },
  {
    "text": "And the Forge platform\nruns in a separate account.",
    "start": "193470",
    "end": "196110"
  },
  {
    "text": "That does not touch\nthe customer Lambda account",
    "start": "196110",
    "end": "198540"
  },
  {
    "text": "or the Lambda account does\nnot touch our Forge account.",
    "start": "198540",
    "end": "201980"
  },
  {
    "text": "- So the\nAtlassian Forge platform,",
    "start": "201980",
    "end": "203680"
  },
  {
    "text": "like other Atlassian products,\nI imagine,",
    "start": "203680",
    "end": "205349"
  },
  {
    "text": "is a SaaS application,\nmulti-tenant?",
    "start": "205350",
    "end": "207010"
  },
  {
    "start": "207000",
    "end": "242000"
  },
  {
    "text": "- That's correct.",
    "start": "207010",
    "end": "207739"
  },
  {
    "text": "- Is this part over here with\nLambda functions also multi-tenant?",
    "start": "207740",
    "end": "210780"
  },
  {
    "text": "Or is it one per customer?",
    "start": "210780",
    "end": "211910"
  },
  {
    "text": "How does it work?",
    "start": "211910",
    "end": "213590"
  },
  {
    "text": "- That is multi-tenant.",
    "start": "213590",
    "end": "214950"
  },
  {
    "text": "So a Lambda can be shared\nbetween multiple customers.",
    "start": "214950",
    "end": "218040"
  },
  {
    "text": "- Okay, well then how do you\nhandle security considerations?",
    "start": "218040",
    "end": "220420"
  },
  {
    "text": "- That's a very good point.",
    "start": "220420",
    "end": "222060"
  },
  {
    "text": "As you know, Lambdas can\nkeep static",
    "start": "222060",
    "end": "224130"
  },
  {
    "text": "between invocations,",
    "start": "224130",
    "end": "225200"
  },
  {
    "text": "and since we'll\nhave multiple customer,",
    "start": "225200",
    "end": "226900"
  },
  {
    "text": "different customer requests\ncoming through the Lambda,",
    "start": "226900",
    "end": "229030"
  },
  {
    "text": "that's not an\nideal state to be in.",
    "start": "229030",
    "end": "230870"
  },
  {
    "text": "So what we do\non every request,",
    "start": "230870",
    "end": "232780"
  },
  {
    "text": "we spin up a v8 isolate\nto run a customer's code",
    "start": "232780",
    "end": "235680"
  },
  {
    "text": "in that specific isolate.",
    "start": "235680",
    "end": "237280"
  },
  {
    "text": "- So you wouldn't want,\nfor example,",
    "start": "237280",
    "end": "238220"
  },
  {
    "text": "like a global variable",
    "start": "238220",
    "end": "239240"
  },
  {
    "text": "that could be available\nbetween the two invocations",
    "start": "239240",
    "end": "241420"
  },
  {
    "text": "to be shared between customers?",
    "start": "241420",
    "end": "242569"
  },
  {
    "start": "242000",
    "end": "290000"
  },
  {
    "text": "- Exactly.",
    "start": "242570",
    "end": "243410"
  },
  {
    "text": "So even though the customer",
    "start": "243410",
    "end": "244210"
  },
  {
    "text": "might write code\nthat tries to do that,",
    "start": "244210",
    "end": "245750"
  },
  {
    "text": "what we do,",
    "start": "245750",
    "end": "246820"
  },
  {
    "text": "because we spin up an isolate\non every invocation,",
    "start": "246820",
    "end": "249370"
  },
  {
    "text": "and delete the isolate\nafter the invocation",
    "start": "249370",
    "end": "251909"
  },
  {
    "text": "that global variable\ndisappears again.",
    "start": "251910",
    "end": "253720"
  },
  {
    "text": "- So, some of our viewers",
    "start": "253720",
    "end": "254390"
  },
  {
    "text": "may not be\nfamiliar with isolates.",
    "start": "254390",
    "end": "255819"
  },
  {
    "text": "Can you  tell us a\nlittle bit more about that?",
    "start": "255820",
    "end": "257190"
  },
  {
    "text": "- v8 isolate is a\nJavaScript v8 engine construct",
    "start": "257190",
    "end": "261230"
  },
  {
    "text": "that allows JavaScript\nto spin up a very small,",
    "start": "261230",
    "end": "264860"
  },
  {
    "text": "almost like a virtual machine\nin which they run JavaScript",
    "start": "264860",
    "end": "267729"
  },
  {
    "text": "with nothing in\nthat virtual machine.",
    "start": "267730",
    "end": "269640"
  },
  {
    "text": "So that virtual machine\ncan almost do nothing.",
    "start": "269640",
    "end": "271820"
  },
  {
    "text": "It can't do anything really,",
    "start": "271820",
    "end": "272820"
  },
  {
    "text": "and we have to allow it to\ndo very specific things.",
    "start": "272820",
    "end": "275160"
  },
  {
    "text": "- Okay, and then you can\nexplicitly wipe it out",
    "start": "275160",
    "end": "276600"
  },
  {
    "text": "when it terminates or if it's\nnot used or whatever.",
    "start": "276600",
    "end": "278900"
  },
  {
    "text": "- Exactly,\nonce the request is finished,\nwe delete the isolate,",
    "start": "278900",
    "end": "281620"
  },
  {
    "text": "leaving all traces of all the\ncode all the variables,",
    "start": "281620",
    "end": "284560"
  },
  {
    "text": "are gone, disappeared.",
    "start": "284560",
    "end": "285870"
  },
  {
    "text": "- Interesting. I love that\nmulti-level security approach",
    "start": "285870",
    "end": "287970"
  },
  {
    "text": "to really make it safe\nand secure for your customers.",
    "start": "287970",
    "end": "290820"
  },
  {
    "start": "290000",
    "end": "302000"
  },
  {
    "text": "Okay, so I understand\nhow you load the application",
    "start": "290820",
    "end": "293480"
  },
  {
    "text": "you've de-coupled it\nwith a queue in the middle,",
    "start": "293480",
    "end": "295490"
  },
  {
    "text": "you create the Lambda function\nwith the customer code",
    "start": "295490",
    "end": "297840"
  },
  {
    "text": "and you store the state\nin Dynamo DB.",
    "start": "297840",
    "end": "299139"
  },
  {
    "text": "It all makes sense so far.",
    "start": "299140",
    "end": "300490"
  },
  {
    "text": "It's a good,\nsecure architecture.",
    "start": "300490",
    "end": "301880"
  },
  {
    "text": "What's happens next?",
    "start": "301880",
    "end": "303080"
  },
  {
    "start": "302000",
    "end": "339000"
  },
  {
    "text": "- So now we've got\nthe Lambda deployed,",
    "start": "303080",
    "end": "304840"
  },
  {
    "text": "but Lambda's sitting\nthere doing nothing.",
    "start": "304840",
    "end": "306510"
  },
  {
    "text": "It's not much use.",
    "start": "306510",
    "end": "307660"
  },
  {
    "text": "So we have the browser",
    "start": "307660",
    "end": "308540"
  },
  {
    "text": "that now needs\nto invite the Lambda.",
    "start": "308540",
    "end": "309960"
  },
  {
    "text": "What happens in that case is,",
    "start": "309960",
    "end": "312020"
  },
  {
    "text": "the browser makes a call to\none of our internal services.",
    "start": "312020",
    "end": "315449"
  },
  {
    "text": "That does various things.",
    "start": "315450",
    "end": "316850"
  },
  {
    "text": "It checks\nsecurity permissions;",
    "start": "316850",
    "end": "318800"
  },
  {
    "text": "is the user behind the browser",
    "start": "318800",
    "end": "320370"
  },
  {
    "text": "allowed to\nexecute that Lambda?",
    "start": "320370",
    "end": "322190"
  },
  {
    "text": "It finds the right Lambda\nassociated with that user",
    "start": "322190",
    "end": "324910"
  },
  {
    "text": "with that product.",
    "start": "324910",
    "end": "325940"
  },
  {
    "text": "Once it's\nfound that information,",
    "start": "325940",
    "end": "327490"
  },
  {
    "text": "it goes in and\ninvokes the Lambda.",
    "start": "327490",
    "end": "331190"
  },
  {
    "text": "- So, in addition\nto authentication,",
    "start": "331190",
    "end": "332830"
  },
  {
    "text": "there's a bunch of logic\nthat happens at this level",
    "start": "332830",
    "end": "335569"
  },
  {
    "text": "and that it picks up the Lambda",
    "start": "335570",
    "end": "336890"
  },
  {
    "text": "that's associated\nwith that request",
    "start": "336890",
    "end": "337940"
  },
  {
    "text": "and returns the\ndata to the user?",
    "start": "337940",
    "end": "339330"
  },
  {
    "start": "339000",
    "end": "365000"
  },
  {
    "text": "- Exactly, because no\ndata stored in the Lambda",
    "start": "339330",
    "end": "341810"
  },
  {
    "text": "and the service actually\nsends the correct parameters",
    "start": "341810",
    "end": "345560"
  },
  {
    "text": "to the Lambda, so the\nLambda knows what to do.",
    "start": "345560",
    "end": "348340"
  },
  {
    "text": "So once the\nLambda's executed,",
    "start": "348340",
    "end": "350280"
  },
  {
    "text": "we can get information\nfrom other systems,",
    "start": "350280",
    "end": "353620"
  },
  {
    "text": "from other products,\nfrom whatever it feels like,",
    "start": "353620",
    "end": "357100"
  },
  {
    "text": "it will return that data",
    "start": "357100",
    "end": "358610"
  },
  {
    "text": "and a page fragment\nwill be constructed,",
    "start": "358610",
    "end": "361659"
  },
  {
    "text": "which is returned\nto the browser.",
    "start": "361660",
    "end": "362790"
  },
  {
    "text": "And the browser will then\nreinvent that page fragment.",
    "start": "362790",
    "end": "365720"
  },
  {
    "text": "- OK, well I really like how\nyou approach security.",
    "start": "365720",
    "end": "367780"
  },
  {
    "text": "You're really making it\na secure, safe offering",
    "start": "367780",
    "end": "369610"
  },
  {
    "text": "for your customers\nwith the account boundaries,",
    "start": "369610",
    "end": "371289"
  },
  {
    "text": "with the isolates, having\nall sorts of techniques.",
    "start": "371290",
    "end": "373990"
  },
  {
    "text": "You scale by adding\nthings like SQS",
    "start": "373990",
    "end": "376870"
  },
  {
    "text": "and scalable tiers\nbehind ALB.",
    "start": "376870",
    "end": "378949"
  },
  {
    "text": "It's really an\nelegant architecture.",
    "start": "378950",
    "end": "380880"
  },
  {
    "start": "380000",
    "end": "407000"
  },
  {
    "text": "- Thank you very much.",
    "start": "380880",
    "end": "381950"
  },
  {
    "text": "As you mentioned,",
    "start": "381950",
    "end": "382890"
  },
  {
    "text": "security is of\nprimary concern for us.",
    "start": "382890",
    "end": "384840"
  },
  {
    "text": "That's why we have these\nmultiple layers of security,",
    "start": "384840",
    "end": "387360"
  },
  {
    "text": "so that in case\nsomething goes wrong,",
    "start": "387360",
    "end": "388830"
  },
  {
    "text": "an attack will have\nto go through various layers",
    "start": "388830",
    "end": "390759"
  },
  {
    "text": "to even affect\nanything else",
    "start": "390760",
    "end": "392080"
  },
  {
    "text": "- Great, well,\nlike we always say,",
    "start": "392080",
    "end": "393449"
  },
  {
    "text": "security is job zero.",
    "start": "393450",
    "end": "394830"
  },
  {
    "text": "- Exactly.",
    "start": "394830",
    "end": "395900"
  },
  {
    "text": "- So thanks for\nsharing this with us.",
    "start": "395900",
    "end": "396699"
  },
  {
    "text": "- Thank you very much.",
    "start": "396700",
    "end": "397600"
  },
  {
    "text": "- And thank you for watching\n\"This is My Architecture.\"",
    "start": "397600",
    "end": "401020"
  },
  {
    "start": "401020",
    "end": "404020"
  },
  {
    "start": "404020",
    "end": "405520"
  },
  {
    "start": "405520",
    "end": "407020"
  }
]