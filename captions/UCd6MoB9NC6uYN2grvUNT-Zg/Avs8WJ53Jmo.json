[
  {
    "start": "0",
    "end": "121000"
  },
  {
    "text": "good afternoon everyone my name is Lee actors enormous solutions architects fray WS based in the UK team based in",
    "start": "60",
    "end": "7470"
  },
  {
    "text": "London I primarily work with media and entertainment customers but we're going",
    "start": "7470",
    "end": "12570"
  },
  {
    "text": "to talk about the edge services specifically here so if anybody was here",
    "start": "12570",
    "end": "19350"
  },
  {
    "text": "last year you may have recognized the title of this presentation this is an",
    "start": "19350",
    "end": "25859"
  },
  {
    "text": "updated version of this presentation I actually delivered this presentation last year I think it was the day before",
    "start": "25859",
    "end": "32219"
  },
  {
    "text": "lambda edge was announced therefore I couldn't talk about lambda edge so with the updated version today I can talk",
    "start": "32219",
    "end": "39570"
  },
  {
    "text": "about lambda edge so the agenda we're going to talk about what we mean or what",
    "start": "39570",
    "end": "45930"
  },
  {
    "text": "I mean I would say regarding the AWS edge we're going to talk about the application edge and then patterns for a",
    "start": "45930",
    "end": "54000"
  },
  {
    "text": "DevOps edge before I go on to the next slide I just want to set the scene around what I mean by DevOps I'm not",
    "start": "54000",
    "end": "60270"
  },
  {
    "text": "going to talk about everything about DevOps the DevOps coach I'm just going to take the the important essences of",
    "start": "60270",
    "end": "66180"
  },
  {
    "text": "DevOps the idea of working together as a team you got developers and operations",
    "start": "66180",
    "end": "71600"
  },
  {
    "text": "building a solution integrating a solution automating it testing it",
    "start": "71600",
    "end": "77790"
  },
  {
    "text": "monitoring that's the the principles I'm going to talk about here using a degress",
    "start": "77790",
    "end": "82830"
  },
  {
    "text": "edge services so what do I mean by the a diverse edge so the first thing we can",
    "start": "82830",
    "end": "89729"
  },
  {
    "text": "talk about is the infrastructure the edge infrastructure so to start off we have 44 availability zones or AZ's I'm",
    "start": "89729",
    "end": "97860"
  },
  {
    "text": "British but I still call them a Z's and these are grouped into 16 a diverse",
    "start": "97860",
    "end": "104610"
  },
  {
    "text": "regions we've got 17 80s and six regions and already announced so the age of West",
    "start": "104610",
    "end": "110640"
  },
  {
    "text": "regions themselves that's where the majority of age aware services run in executing so things like easy to s3 etc",
    "start": "110640",
    "end": "118009"
  },
  {
    "text": "but in addition to these regions there's also the a Jewess edge network these",
    "start": "118009",
    "end": "125540"
  },
  {
    "start": "121000",
    "end": "121000"
  },
  {
    "text": "edge network we have 107 points of presence we launched another six last",
    "start": "125540",
    "end": "132420"
  },
  {
    "text": "week and those of those 107 points or presents we have 96 edge locations and",
    "start": "132420",
    "end": "140520"
  },
  {
    "text": "11 regional edge cashiers now the edge locations are small you can think of",
    "start": "140520",
    "end": "147120"
  },
  {
    "text": "those as smaller instances of infrastructure for AWS these are close",
    "start": "147120",
    "end": "153360"
  },
  {
    "text": "to the user they're connected to users ISPs network connections to be as close",
    "start": "153360",
    "end": "159360"
  },
  {
    "text": "to the users as possible the regional education is are actually located in the a diverse regions and",
    "start": "159360",
    "end": "165780"
  },
  {
    "text": "these provide extra features which I'll talk about later we've also got the age",
    "start": "165780",
    "end": "173250"
  },
  {
    "text": "of west edge services so these services run in a diverse Edge network they also",
    "start": "173250",
    "end": "181230"
  },
  {
    "text": "some of them will also run it in the regions so to go through them in a list there's Amazon CloudFront our content",
    "start": "181230",
    "end": "187080"
  },
  {
    "text": "delivery network was a route 53 our DNS service address wofe our Web Application",
    "start": "187080",
    "end": "193530"
  },
  {
    "text": "Firewall ADA shield our DDoS protection service an aide West lambda edge now",
    "start": "193530",
    "end": "200970"
  },
  {
    "text": "CloudFront runs both in the regional edge caches and the edge locations route",
    "start": "200970",
    "end": "206190"
  },
  {
    "text": "53 the actual DNS servers are running in the edge locations a duress wofe and a",
    "start": "206190",
    "end": "213360"
  },
  {
    "text": "Jewish shield both run in the regions and in the edge locations and lambda edge is running in the edge network",
    "start": "213360",
    "end": "219900"
  },
  {
    "text": "providing lambda so the standard lambda that we use for service computes lambda",
    "start": "219900",
    "end": "227340"
  },
  {
    "text": "edge is running in response to events of cloud front so requests and responses",
    "start": "227340",
    "end": "233760"
  },
  {
    "text": "coming into the cloud front network so",
    "start": "233760",
    "end": "240290"
  },
  {
    "text": "the next thing is to talk about the application edge so what do we think",
    "start": "240290",
    "end": "246660"
  },
  {
    "text": "about your application as being the origin and the client what I mean by the",
    "start": "246660",
    "end": "253170"
  },
  {
    "text": "origin is if you look at the specification for HTTP it talks about the origin rather than a web server so",
    "start": "253170",
    "end": "259769"
  },
  {
    "text": "the origin is what where the content is originating from so it could be a static web server it could be s3 but",
    "start": "259769",
    "end": "267190"
  },
  {
    "text": "more likely to be a web server that's generating content so the origin runs on",
    "start": "267190",
    "end": "275920"
  },
  {
    "text": "82 lbs 3 it could run somewhere else on the internet could run in your own data",
    "start": "275920",
    "end": "281560"
  },
  {
    "text": "centers for instance and then you've got the client the client is the interaction",
    "start": "281560",
    "end": "286990"
  },
  {
    "text": "with the origin so it could be an HTML could be a web a website web browser it",
    "start": "286990",
    "end": "293140"
  },
  {
    "text": "could be a mobile application or a desktop application and often people will classically think that you have this you know effect it's a",
    "start": "293140",
    "end": "299290"
  },
  {
    "text": "client-server application your clients making requests to the server just happens to be a web server a web server",
    "start": "299290",
    "end": "304780"
  },
  {
    "text": "responds and the client is rendering and working with that content the key point",
    "start": "304780",
    "end": "310930"
  },
  {
    "text": "I want to get today is to think about actually there's one more component of that application and it's the edge in",
    "start": "310930",
    "end": "318910"
  },
  {
    "text": "between the origin and the client so the edge is DNS CloudFront the content",
    "start": "318910",
    "end": "326680"
  },
  {
    "text": "delivery network and also perimeter protection using a 2's wife and ADA a shield and additionally also have lambda",
    "start": "326680",
    "end": "335620"
  },
  {
    "text": "edge so we can also do compute at the edge the key thing here is often people",
    "start": "335620",
    "end": "342160"
  },
  {
    "text": "think of DNS and CloudFront or DNS and CD ends I should say as something that's",
    "start": "342160",
    "end": "347560"
  },
  {
    "text": "a bit of an afterthought so you may build your application and you build your your clients and you put them",
    "start": "347560",
    "end": "353410"
  },
  {
    "text": "together and you're working and maybe you need a performance boost so you you think about well actually I should add",
    "start": "353410",
    "end": "358690"
  },
  {
    "text": "caching so I will use a to do no I'll configure this the CDN to do caching I",
    "start": "358690",
    "end": "363820"
  },
  {
    "text": "need a domain name to our Bible Dan domain name I will configure that domain name to point to my web servers so often",
    "start": "363820",
    "end": "371110"
  },
  {
    "text": "these DNS and CDN often an afterthought and often they're also not part of the",
    "start": "371110",
    "end": "376390"
  },
  {
    "text": "application itself in the in the design of the application and the deployment of the application it's often done by",
    "start": "376390",
    "end": "381460"
  },
  {
    "text": "separate team adri√† soif and ad where she of them the security protection may also be done by the security team rather",
    "start": "381460",
    "end": "388450"
  },
  {
    "text": "than the application team so my key point here is actually treat all three",
    "start": "388450",
    "end": "393640"
  },
  {
    "text": "components as part of your application and work together even if you're separate teams you're working together",
    "start": "393640",
    "end": "398740"
  },
  {
    "text": "to deploy this application so just a few points on clown front so",
    "start": "398740",
    "end": "405630"
  },
  {
    "start": "403000",
    "end": "403000"
  },
  {
    "text": "Cloudant helps improve the user experience I've show you're going to run through a request from a client for a",
    "start": "405630",
    "end": "414060"
  },
  {
    "text": "website that's fronted with CloudFront so you've go to the top you've got the",
    "start": "414060",
    "end": "419420"
  },
  {
    "text": "origin so the web server that's going to originate the content the bottom left",
    "start": "419420",
    "end": "425010"
  },
  {
    "text": "you've got the clients in this case they are mobile devices and then we've got cloud front in the middle I'm just",
    "start": "425010",
    "end": "431430"
  },
  {
    "text": "showing the edge locations I'm not showing the regional education at the moment I will talk about that later just trying to keep the diagram as simple as",
    "start": "431430",
    "end": "438210"
  },
  {
    "text": "possible so the first thing to do is the clients going to make a request to the",
    "start": "438210",
    "end": "443850"
  },
  {
    "text": "website to get some content the first thing he's got to do he's got to establish B even before it makes an HTTP",
    "start": "443850",
    "end": "450360"
  },
  {
    "text": "request it's got to establish a TCP connection one thing I should have said",
    "start": "450360",
    "end": "456120"
  },
  {
    "text": "just before key point all of the main public age of West regions are all on",
    "start": "456120",
    "end": "461910"
  },
  {
    "text": "the Amazon backbone and many of the age where age locations are all on the Amazon backbone the benefits we're all",
    "start": "461910",
    "end": "467910"
  },
  {
    "text": "been on the Amazon backbone is it performance improvement so we can offer the tuning that we can provide the the",
    "start": "467910",
    "end": "475020"
  },
  {
    "text": "more that you can stay on the Amazon backbone delivering content to your users the better performance you'll get",
    "start": "475020",
    "end": "482270"
  },
  {
    "text": "so the client makes a request it first got to establish a TCP connection otz to",
    "start": "483170",
    "end": "489690"
  },
  {
    "text": "establish a TCP connection you've got to make a three-way handshake so the",
    "start": "489690",
    "end": "494760"
  },
  {
    "text": "packets have to transfer between the client and the edge location backwards and forwards to establish that TCP",
    "start": "494760",
    "end": "501600"
  },
  {
    "text": "connection before it can even make an HTTP request so the short of the distance you making this TCP connection",
    "start": "501600",
    "end": "508320"
  },
  {
    "text": "the quicker that connection can be made so the benefit of using cloud front is that the edge locations are located as",
    "start": "508320",
    "end": "514409"
  },
  {
    "text": "close to the users as possible but that initial TCP connection can be set up as quickly as possible so once you set up a",
    "start": "514410",
    "end": "523169"
  },
  {
    "text": "set up the TP connection the client can make an H to be request to cloud front to receive the piece of content now in",
    "start": "523169",
    "end": "530520"
  },
  {
    "text": "this case it's not in the cloud front cache so CloudFront is going to make a request back to the",
    "start": "530520",
    "end": "535750"
  },
  {
    "text": "origin server now it's going to do the same thing of establishing a TCP connection now this is over a longer",
    "start": "535750",
    "end": "541960"
  },
  {
    "text": "distance typically so it will take longer to establish but the one benefit is that that TCP connection is a",
    "start": "541960",
    "end": "548470"
  },
  {
    "text": "persistent connection so once the connections set up will keep that TCP connection persistent open for future",
    "start": "548470",
    "end": "555070"
  },
  {
    "text": "requests who are now established the TCP connection you can make the HTTP",
    "start": "555070",
    "end": "560740"
  },
  {
    "text": "requests get it back into cloud front and then we can deliver it to the client",
    "start": "560740",
    "end": "566920"
  },
  {
    "text": "and optionally we can store that object in the cache of cloud front for a future",
    "start": "566920",
    "end": "571990"
  },
  {
    "text": "requests so let's say a second client makes a request for the same object it's",
    "start": "571990",
    "end": "578470"
  },
  {
    "text": "going to have to establish this TCP connection again the advantages it's over a small small distance so it can be",
    "start": "578470",
    "end": "585270"
  },
  {
    "text": "configured and set up quickly and then it can make the request now in this case",
    "start": "585270",
    "end": "590530"
  },
  {
    "text": "it's already in the CloudFront cache so the object can be delivered back to the client without the even the edge",
    "start": "590530",
    "end": "597220"
  },
  {
    "text": "location have to make a second request back to the origin now if it did have to",
    "start": "597220",
    "end": "603400"
  },
  {
    "text": "make a second request the advantage is that that persistent connection between the edge location and the origin is",
    "start": "603400",
    "end": "609640"
  },
  {
    "text": "already established so even if the request has to go back to the origin and",
    "start": "609640",
    "end": "615130"
  },
  {
    "text": "be quicker than going directly to the origin because over that part the distance the TCP connections is already",
    "start": "615130",
    "end": "621580"
  },
  {
    "text": "established it's a cloud front isn't just for static content even if your",
    "start": "621580",
    "end": "628600"
  },
  {
    "text": "website is completely dynamic there's still a benefit in user experience and user performance by using cloud fronts",
    "start": "628600",
    "end": "635710"
  },
  {
    "text": "because you've got persistent connections and that the majority of the traffic is going over the Amazon",
    "start": "635710",
    "end": "641830"
  },
  {
    "text": "backbone until that last section from the edge location to the client as I",
    "start": "641830",
    "end": "650260"
  },
  {
    "text": "mentioned there's also regional edge caches a regional edge cash it's between the edge location and the origin the",
    "start": "650260",
    "end": "657670"
  },
  {
    "text": "regional education is that based on the region so they have a great deal of cache bandwidth or cache width I should",
    "start": "657670",
    "end": "663370"
  },
  {
    "text": "say so that means you get a better past performance better cache hit ratio because this cache is wider and it's",
    "start": "663370",
    "end": "670760"
  },
  {
    "text": "also shared across the edge locations within that area so that means even if the edge location hasn't got a calf",
    "start": "670760",
    "end": "676850"
  },
  {
    "text": "table depth it can go back to the regionalised cache before the regional head cast would have to go back all the",
    "start": "676850",
    "end": "682550"
  },
  {
    "text": "way to the origin so the regional education provide even better cache performance and it also takes more load",
    "start": "682550",
    "end": "688910"
  },
  {
    "text": "off the origin because not every single request from a regional education or so from an education would go back to a",
    "start": "688910",
    "end": "695209"
  },
  {
    "text": "region all the way back to the origin so you've got a mid tier cache another",
    "start": "695209",
    "end": "703779"
  },
  {
    "start": "703000",
    "end": "703000"
  },
  {
    "text": "point to be made with cloud front is it helps to reduce the costs so the first",
    "start": "703779",
    "end": "709040"
  },
  {
    "text": "thing is data transfer from an age of rest region so if your origin is based",
    "start": "709040",
    "end": "714050"
  },
  {
    "text": "on age west region where it's easy to or s3 or ELB the data transfer from that",
    "start": "714050",
    "end": "719600"
  },
  {
    "text": "region to cloud front is free you don't pay for the data transfer you're only pay for the data transfer out of cloud",
    "start": "719600",
    "end": "726500"
  },
  {
    "text": "front itself and this is charged at a lower data rates than the out of a",
    "start": "726500",
    "end": "732950"
  },
  {
    "text": "native West region so by using cloud fronts you get a cost saving typically whether you're using it for caching or",
    "start": "732950",
    "end": "740089"
  },
  {
    "text": "not you'll be using cloud front and the lower data charges to deliver content to",
    "start": "740089",
    "end": "745279"
  },
  {
    "text": "your end-users now if you do cache",
    "start": "745279",
    "end": "750500"
  },
  {
    "text": "content that means that you'll make fewer requests back to the origin and",
    "start": "750500",
    "end": "757250"
  },
  {
    "text": "because you're going to have fewer sistent connections going back to the or fewer connections going back to the origin because you're going to only",
    "start": "757250",
    "end": "763550"
  },
  {
    "text": "going to have the regional education is making those connections back to your origin it means there's less load on the",
    "start": "763550",
    "end": "769940"
  },
  {
    "text": "origin so there's less CPU less memory usage which often means you can actually",
    "start": "769940",
    "end": "776630"
  },
  {
    "text": "scale your origin to a smaller size and therefore save you save money as well",
    "start": "776630",
    "end": "783610"
  },
  {
    "text": "so the next section is to talk about patterns for a DevOps edge you can think of this is just some some tips that you",
    "start": "788170",
    "end": "794300"
  },
  {
    "text": "may you may want to consider so I've got five in total the key thing is to try",
    "start": "794300",
    "end": "801350"
  },
  {
    "text": "and cache as much content as possible at the edge to think about forwarding as",
    "start": "801350",
    "end": "806660"
  },
  {
    "text": "little information back to the origin and I'll explain that you know we work through these and explain that later to",
    "start": "806660",
    "end": "813020"
  },
  {
    "text": "try and validate content so validate whether you've got the most recent version in your cache as as efficiently",
    "start": "813020",
    "end": "819050"
  },
  {
    "text": "as possible to automate the edge and also to monitor it so let's just talk",
    "start": "819050",
    "end": "825500"
  },
  {
    "text": "about cache as much as possible so I'm just going to explain how H to P cache",
    "start": "825500",
    "end": "830630"
  },
  {
    "start": "828000",
    "end": "828000"
  },
  {
    "text": "control works this is not specific to cloud front at all this is just the HTTP",
    "start": "830630",
    "end": "836240"
  },
  {
    "text": "specification in this example I've got the origin and a client the client is going to make a request to",
    "start": "836240",
    "end": "843470"
  },
  {
    "text": "the origin so the first thing it does issues a request so you can see here then we're going to get a bar chart JPEG",
    "start": "843470",
    "end": "850400"
  },
  {
    "text": "I specified here HSP 1.1 the key point to just to notice that CloudFront also",
    "start": "850400",
    "end": "856160"
  },
  {
    "text": "supports HTTP 2 there's it provides better performance but I'm not going to focus on that and just focus on on HTTP",
    "start": "856160",
    "end": "862820"
  },
  {
    "text": "request itself so it's issued that requests now the origin is going to",
    "start": "862820",
    "end": "869480"
  },
  {
    "text": "return the the object and with that object it's going to specify a few extra",
    "start": "869480",
    "end": "875510"
  },
  {
    "text": "headers so last modified is fairly obvious it's it's a date and time basically when when the last time that",
    "start": "875510",
    "end": "881930"
  },
  {
    "text": "that object was modified but the key one no one's talked about is cache control",
    "start": "881930",
    "end": "887060"
  },
  {
    "text": "so cache control is ahead of the sent from the origin to the client to",
    "start": "887060",
    "end": "892340"
  },
  {
    "text": "indicate and direct and provide information about how it can cache that",
    "start": "892340",
    "end": "897800"
  },
  {
    "text": "object and when it would need to validate that cached object in the future so there's a number of different",
    "start": "897800",
    "end": "904400"
  },
  {
    "text": "directives within the cache control header I've set one here is called max age eighteen hundred means eighteen",
    "start": "904400",
    "end": "910970"
  },
  {
    "text": "hundred seconds that's 30 minutes what max age means is effectively the origin",
    "start": "910970",
    "end": "916340"
  },
  {
    "text": "is saying to the client here is here is the object you can cache it",
    "start": "916340",
    "end": "921640"
  },
  {
    "text": "but and you can keep on using that cached object but in 30 minutes time if",
    "start": "921640",
    "end": "926930"
  },
  {
    "text": "you use it again come back to me and validate that you've still got the most recent version I may have a newer",
    "start": "926930",
    "end": "932900"
  },
  {
    "text": "version that you may want to use instead what it's not necessarily saying is you",
    "start": "932900",
    "end": "939620"
  },
  {
    "text": "have to cash it for 1800 seconds it's totally up to the client how long it",
    "start": "939620",
    "end": "945380"
  },
  {
    "text": "will cache the object for it may choose not to maybe a small device that doesn't have in have the capacity to cache so",
    "start": "945380",
    "end": "951590"
  },
  {
    "text": "don't assume just because the origin is saying to the client 1800 seconds that the client will obey and crush it for",
    "start": "951590",
    "end": "957440"
  },
  {
    "text": "1800 seconds it's also not saying that cache it's for 1800 seconds but after",
    "start": "957440",
    "end": "963380"
  },
  {
    "text": "1800 seconds delete it all it's saying is if you do cache it after 1800 seconds",
    "start": "963380",
    "end": "970160"
  },
  {
    "text": "come back to me and validate that you've got the current version there's a few",
    "start": "970160",
    "end": "976490"
  },
  {
    "text": "other directives that you can also add number one that it's very sad it's very similar to at max age it's called s max",
    "start": "976490",
    "end": "982880"
  },
  {
    "text": "age the S stands for shared so what this is saying is the max age is for the",
    "start": "982880",
    "end": "990350"
  },
  {
    "text": "client s max age means shared cache so effectively if there's any caches in between the origin and the client that",
    "start": "990350",
    "end": "997850"
  },
  {
    "text": "are shared so this could be a content delivery network it could be an office cache it could be an ISP cache anything",
    "start": "997850",
    "end": "1005770"
  },
  {
    "text": "like that that's shared that's going to have multiple clients using it it's going to set a different max age so what",
    "start": "1005770",
    "end": "1013150"
  },
  {
    "text": "it says here is setting nine 900 so it's a shorter time focally what it's saying is to the shared caches you need to come",
    "start": "1013150",
    "end": "1020530"
  },
  {
    "text": "back and validate you've got the current version earlier than the client needs to",
    "start": "1020530",
    "end": "1027030"
  },
  {
    "text": "number one is private so this is effectively saying max age 1800 seconds",
    "start": "1027839",
    "end": "1034870"
  },
  {
    "text": "but private I don't want this cached in a shared cache only to be cached in a private cache which is typically the",
    "start": "1034870",
    "end": "1041050"
  },
  {
    "text": "browser's cache because obviously it's only used by a one user there's another",
    "start": "1041050",
    "end": "1047380"
  },
  {
    "text": "one called no cache that's it people often think no cache that means",
    "start": "1047380",
    "end": "1052799"
  },
  {
    "text": "it doesn't actually mean not to cache it means you can cache it but you must",
    "start": "1052799",
    "end": "1058450"
  },
  {
    "text": "validate with me before you use it again so so it will be it will get cached by",
    "start": "1058450",
    "end": "1064539"
  },
  {
    "text": "the colleague can be cached by the clients but if the clients going to use it in the future even though it's in the cache it must come back to the origin to",
    "start": "1064539",
    "end": "1071409"
  },
  {
    "text": "validate to make sure it's got the current version no store is where it",
    "start": "1071409",
    "end": "1077230"
  },
  {
    "text": "means do not store the cached object don't store it in your cache you need to come back every time and requesting make",
    "start": "1077230",
    "end": "1085330"
  },
  {
    "text": "a new request for the object so I'm going to stick with the max age 1800",
    "start": "1085330",
    "end": "1091570"
  },
  {
    "text": "seconds I'm also going to add an e-tag which is short for entity tag so this is",
    "start": "1091570",
    "end": "1098590"
  },
  {
    "text": "you can think of this as a versioning of the object it's just a text string often",
    "start": "1098590",
    "end": "1104169"
  },
  {
    "text": "many applications will use some sort of hashing function on the object itself as a as an e-tank",
    "start": "1104169",
    "end": "1110679"
  },
  {
    "text": "but the actual value itself is what we call a cake it means you shouldn't infer",
    "start": "1110679",
    "end": "1116320"
  },
  {
    "text": "what it means you shouldn't infer that it's an md5 hash often it is but it you shouldn't infer that all it means is if you've got",
    "start": "1116320",
    "end": "1123309"
  },
  {
    "text": "to eat eggs or two objects if they're really tags are different it means that the objects are different if they are",
    "start": "1123309",
    "end": "1129850"
  },
  {
    "text": "the same the objects are the same it's basically a versioning of that object so",
    "start": "1129850",
    "end": "1137159"
  },
  {
    "text": "the origin returns that object to the client and then it displays it and",
    "start": "1137159",
    "end": "1143710"
  },
  {
    "text": "optionally it can cache the object so now if it's in the object it's sorry",
    "start": "1143710",
    "end": "1149710"
  },
  {
    "text": "it's if it's in the cache the client can continue to use it so if it goes to another web page with the same",
    "start": "1149710",
    "end": "1155470"
  },
  {
    "text": "referencing the same object it can just display that out of the cache it doesn't need to go back to the origin again but",
    "start": "1155470",
    "end": "1162700"
  },
  {
    "text": "after those 30 minutes although it may still be in the cache it needs to now validate with the origin to make sure",
    "start": "1162700",
    "end": "1169809"
  },
  {
    "text": "that it's got the current version the most up-to-date version so in this case it'll do a conditional get so it looks",
    "start": "1169809",
    "end": "1177460"
  },
  {
    "text": "the guess itself is exactly the same we've got this extra header it's got a if none match what this is saying is I",
    "start": "1177460",
    "end": "1185009"
  },
  {
    "text": "want bard bar chart JPEG but only send it to me if",
    "start": "1185009",
    "end": "1190630"
  },
  {
    "text": "the e-tag is different to the e-tag i've already got in my cache so let's assume",
    "start": "1190630",
    "end": "1196659"
  },
  {
    "text": "that the object hasn't changed it's still the same version it would be the same etag so the origin can just respond",
    "start": "1196659",
    "end": "1203230"
  },
  {
    "text": "saying not modified basically you've got the current version you can continue to to use that that that's already cached",
    "start": "1203230",
    "end": "1211980"
  },
  {
    "text": "but let's assume that the object has been updated so the client makes a",
    "start": "1212250",
    "end": "1217840"
  },
  {
    "text": "request it specifies the e-tag and the infinim match but the e-tag of the",
    "start": "1217840",
    "end": "1223840"
  },
  {
    "text": "current object is now different so the origin returns our object and as you can",
    "start": "1223840",
    "end": "1229179"
  },
  {
    "text": "see the e-tag is different it's the best affine cache controller game so all this",
    "start": "1229179",
    "end": "1234519"
  },
  {
    "text": "is just standard HTTP specification it's the origin is defining how long it could",
    "start": "1234519",
    "end": "1242080"
  },
  {
    "text": "be cached how long it should be before it's there needs to be validated but CloudFront understands cache control so",
    "start": "1242080",
    "end": "1249429"
  },
  {
    "text": "when you've got CloudFront in between the origin and the client if it sees this cache control directors coming from",
    "start": "1249429",
    "end": "1255220"
  },
  {
    "text": "the origin it will then use that to determine how long and what whether that content can be stored in its cache but",
    "start": "1255220",
    "end": "1264970"
  },
  {
    "text": "as well as the cache control header defining how long the contents should",
    "start": "1264970",
    "end": "1270070"
  },
  {
    "text": "stay in the CloudFront cache before it needs to be revalidated kai often also supports the",
    "start": "1270070",
    "end": "1275950"
  },
  {
    "text": "configuration as well through a configuration the TTL so the TTL that",
    "start": "1275950",
    "end": "1281110"
  },
  {
    "text": "you set in CloudFront can be set at the cache behavior level a cache behavior in",
    "start": "1281110",
    "end": "1286210"
  },
  {
    "text": "CloudFront is defined as a group of configuration which is applied based on",
    "start": "1286210",
    "end": "1291429"
  },
  {
    "text": "matching the path of the request so you have these TTL that can be configured in",
    "start": "1291429",
    "end": "1297880"
  },
  {
    "text": "cloud for entity you've got these cache control headers how does CloudFront determine which one to use so i've got a",
    "start": "1297880",
    "end": "1307000"
  },
  {
    "text": "flow diagram here just to walk through the decision that CloudFront makes on the on a response from our origin on how",
    "start": "1307000",
    "end": "1315370"
  },
  {
    "text": "long it should store it in the cache before it needs to revalidate for a few request so CloudFront prefers the",
    "start": "1315370",
    "end": "1323500"
  },
  {
    "text": "estimate page if the estimate page is there it will then use that as the TTL",
    "start": "1323500",
    "end": "1328980"
  },
  {
    "text": "vest max-age in the cache control headers not there it will then fall back",
    "start": "1328980",
    "end": "1334090"
  },
  {
    "text": "to use than the max-age there's another",
    "start": "1334090",
    "end": "1339610"
  },
  {
    "text": "header which record expires as ah it's a header that was specified in an earlier",
    "start": "1339610",
    "end": "1344680"
  },
  {
    "text": "version of HTTP it's still it's still valid still use the difference between expires and say cache controllers that",
    "start": "1344680",
    "end": "1351460"
  },
  {
    "text": "expires is a simpler header it's got less functionality and what you do is",
    "start": "1351460",
    "end": "1356920"
  },
  {
    "text": "rather than specifying a maximum age you specify a point in time a date and time",
    "start": "1356920",
    "end": "1362010"
  },
  {
    "text": "typically it's in the future but at that point the cached object needs to be",
    "start": "1362010",
    "end": "1367780"
  },
  {
    "text": "revalidated so if you haven't got a cache control with a mess back later on max-age in",
    "start": "1367780",
    "end": "1374080"
  },
  {
    "text": "your response clown front will then use the expires header though I'd recommend that you try and use cache control",
    "start": "1374080",
    "end": "1380290"
  },
  {
    "text": "wherever you can your application it gives you a lot more functionality so",
    "start": "1380290",
    "end": "1386920"
  },
  {
    "text": "after looking at all those headers within the response from the origin",
    "start": "1386920",
    "end": "1393000"
  },
  {
    "text": "CloudFront has now got a TTL that's been defined by the origin but if it doesn't",
    "start": "1393000",
    "end": "1400300"
  },
  {
    "text": "find in any of those will use the configure default TTL so this is a specified number of seconds that it will",
    "start": "1400300",
    "end": "1407230"
  },
  {
    "text": "store in the cache so the object in its cache before it goes back to the origin to revalidate that it's got the current",
    "start": "1407230",
    "end": "1413500"
  },
  {
    "text": "version so now we've got the origin as defined a TTL but we we can also put",
    "start": "1413500",
    "end": "1418960"
  },
  {
    "text": "restrictions on on the maximum and the minimum of that TTL so max TTL is",
    "start": "1418960",
    "end": "1424330"
  },
  {
    "text": "another configuration within CloudFront now if the TTL were that we found from",
    "start": "1424330",
    "end": "1429850"
  },
  {
    "text": "the origin is actually greater than max TTL will actually use the max TTL value and similarly for the minimum TTL min",
    "start": "1429850",
    "end": "1437230"
  },
  {
    "text": "TTL if the TTL defined by the origin is actually lower than the min TTL we can",
    "start": "1437230",
    "end": "1442450"
  },
  {
    "text": "also will override that and use them in TTL so now once we put up the",
    "start": "1442450",
    "end": "1450640"
  },
  {
    "text": "constraints the minimum the Tet maximum TTL we've now defined the TTL that CloudFront is going to use in its cache",
    "start": "1450640",
    "end": "1458830"
  },
  {
    "text": "one thing i want to point out is that CloudFront won't actually change the cache control header as it's passing",
    "start": "1458830",
    "end": "1465140"
  },
  {
    "text": "through so even if you set a maximum TTL of say 60 seconds the origin defines two",
    "start": "1465140",
    "end": "1472040"
  },
  {
    "text": "minutes CloudFront won't change the cache control that it passes on to the",
    "start": "1472040",
    "end": "1477440"
  },
  {
    "text": "client the client will still have to still receive that two minutes it's just that CloudFront will only use",
    "start": "1477440",
    "end": "1483200"
  },
  {
    "text": "the TTL of 60 seconds another thing to",
    "start": "1483200",
    "end": "1491990"
  },
  {
    "start": "1488000",
    "end": "1488000"
  },
  {
    "text": "think about is how you can increase the cache ability of an object the I the ideal thing is you can try and store",
    "start": "1491990",
    "end": "1497960"
  },
  {
    "text": "your responses in cloud France or any HTTP cache for that matter for as long",
    "start": "1497960",
    "end": "1503660"
  },
  {
    "text": "as possible you want to have the cache hit ratio as close to 100% as possible",
    "start": "1503660",
    "end": "1508670"
  },
  {
    "text": "it's hard to do especially we got dynamic content you've got personalized content but the thing what you want to",
    "start": "1508670",
    "end": "1514370"
  },
  {
    "text": "try and do is to strive to get the cache hit ratio as high as possible why do you want to do that that improves",
    "start": "1514370",
    "end": "1519530"
  },
  {
    "text": "the performance it reduces the latency of delivering content to the users and also it reduces the cost and reduce the",
    "start": "1519530",
    "end": "1526520"
  },
  {
    "text": "load on your origin servers let's just take a random website let's say just any",
    "start": "1526520",
    "end": "1533990"
  },
  {
    "text": "any random website and if you look at a website itself there's lots of different",
    "start": "1533990",
    "end": "1539060"
  },
  {
    "text": "components of a web page you've got images and scripts and stylesheets etc there's quite a lot of HTML there now",
    "start": "1539060",
    "end": "1546800"
  },
  {
    "text": "the thing is with HTTP the cache control header is for the whole of that object",
    "start": "1546800",
    "end": "1552110"
  },
  {
    "text": "that you returned so whether you've turned an HTML page or a image or a JavaScript file you can only especially",
    "start": "1552110",
    "end": "1559640"
  },
  {
    "text": "the cat control or the cache ability of that response for the whole of the response but if we just focus in on the",
    "start": "1559640",
    "end": "1567650"
  },
  {
    "text": "the HTML content of this web page I understand it's quite hard to work out but let's just say looking at the HTML",
    "start": "1567650",
    "end": "1572930"
  },
  {
    "text": "content the web site most of that is pretty you would say static so for",
    "start": "1572930",
    "end": "1579050"
  },
  {
    "text": "instance if I look for things like shot by Department that text is not going to change obvi",
    "start": "1579050",
    "end": "1585300"
  },
  {
    "text": "would be different for a different language but it will say this stays the same for a long time but there are",
    "start": "1585300",
    "end": "1591090"
  },
  {
    "text": "certain parts of that HTML page which are a bit more dynamic a bit different",
    "start": "1591090",
    "end": "1596790"
  },
  {
    "text": "so customer since 2000 so I've been an Amazon customer since the year 2000",
    "start": "1596790",
    "end": "1603770"
  },
  {
    "text": "that's not going to change for me that I will always be a customer since the year 2000 however other people will have",
    "start": "1603770",
    "end": "1611010"
  },
  {
    "text": "different years so this is a difference between dynamic content and static content but also whether it's",
    "start": "1611010",
    "end": "1617070"
  },
  {
    "text": "personalized content because it's personalized to me but it's static to me",
    "start": "1617070",
    "end": "1623780"
  },
  {
    "text": "similarly to my name my name is fairly static I'm not planning to change my",
    "start": "1623840",
    "end": "1629880"
  },
  {
    "text": "name so so the name in the website is static however I might change my name at",
    "start": "1629880",
    "end": "1636120"
  },
  {
    "text": "some time in the future so it's static it's unlikely to change but there's a possibility that it could change in the",
    "start": "1636120",
    "end": "1642600"
  },
  {
    "text": "future and then there's components which do change often yeah about the basket",
    "start": "1642600",
    "end": "1648810"
  },
  {
    "text": "will change I would like to see the basket update as soon as I put something in the basket and it's likely that the",
    "start": "1648810",
    "end": "1654540"
  },
  {
    "text": "recent orders will change as well so we've been just this web page content",
    "start": "1654540",
    "end": "1660270"
  },
  {
    "text": "within that web page has slightly different caching characteristics that we content that won't change for a long",
    "start": "1660270",
    "end": "1667170"
  },
  {
    "text": "time they'll be content that will never change this content that's specific to me and it would be different to you but",
    "start": "1667170",
    "end": "1673890"
  },
  {
    "text": "then there's also personalized content and dynamic content which changed often",
    "start": "1673890",
    "end": "1678960"
  },
  {
    "text": "and I would like to see that change if I put something in the basket I would expect to see an update in that basket",
    "start": "1678960",
    "end": "1685519"
  },
  {
    "text": "now how do we do all this is quite difficult all I could do is set the HTML",
    "start": "1686300",
    "end": "1692610"
  },
  {
    "text": "page probably set a cache control max age of 1 seconds that's all I could do",
    "start": "1692610",
    "end": "1698970"
  },
  {
    "text": "I'd have to set it specifically so that this object is cut just for me so it has my name in it and if I put a link in a",
    "start": "1698970",
    "end": "1706260"
  },
  {
    "text": "basket I would like to see an update immediately but that means that then I've got to set that cache level for the",
    "start": "1706260",
    "end": "1712980"
  },
  {
    "text": "whole of that object and if I want to be as it efficient as possible I need to think of other options",
    "start": "1712980",
    "end": "1718770"
  },
  {
    "text": "now one thing I could use is to generate this object so you take things from the",
    "start": "1718770",
    "end": "1725310"
  },
  {
    "text": "cache and generate a combined object the one option to do that is you could do that in the client we've got a web",
    "start": "1725310",
    "end": "1731340"
  },
  {
    "text": "browser we've got JavaScript we can run that we can pull in content from an API to add and change that web page and",
    "start": "1731340",
    "end": "1739020"
  },
  {
    "text": "update it so it's specifically for me and you might notice there are some websites that will dynamically update",
    "start": "1739020",
    "end": "1746100"
  },
  {
    "text": "and change one example I'm in the UK if I look at the BBC News website I see changes in that website as things",
    "start": "1746100",
    "end": "1752970"
  },
  {
    "text": "update as it adds my username into that website when I'm outside of UK I see",
    "start": "1752970",
    "end": "1758430"
  },
  {
    "text": "advertising appearing inside the UK I don't see advertising that all that content has been dynamically modified",
    "start": "1758430",
    "end": "1763860"
  },
  {
    "text": "the website that's really to improve that improves the cache ability of that object of that website so moving on to",
    "start": "1763860",
    "end": "1774210"
  },
  {
    "text": "the next one we got forward as little as possible so what do I mean by forwarding this is the when CloudFront receives a",
    "start": "1774210",
    "end": "1782580"
  },
  {
    "text": "request for a comment piece of content and it's not in the cache it's going to",
    "start": "1782580",
    "end": "1787770"
  },
  {
    "text": "forward that request to the origin now it doesn't forward the whole of the",
    "start": "1787770",
    "end": "1793170"
  },
  {
    "text": "request it will forward certain components certain parts of that request to the origin for the origins to return",
    "start": "1793170",
    "end": "1798660"
  },
  {
    "text": "a response so these components are things such as the age to be methods the path query string headers cookies now",
    "start": "1798660",
    "end": "1808380"
  },
  {
    "text": "whenever you forward something to the origin there's a possibility that as",
    "start": "1808380",
    "end": "1814620"
  },
  {
    "text": "your origin could respond to that extra bit of information that that particular header value or that particular cookie",
    "start": "1814620",
    "end": "1820200"
  },
  {
    "text": "value it will vary the response that it sends back to you if you're going to",
    "start": "1820200",
    "end": "1826290"
  },
  {
    "text": "vary vary the response you need to store that under a separate cache object so",
    "start": "1826290",
    "end": "1832020"
  },
  {
    "text": "what happens is a cloud front whatever you forward CloudFront will add that particular component the value of that",
    "start": "1832020",
    "end": "1837630"
  },
  {
    "text": "component to the cache key so for instance ample if you were to forward a",
    "start": "1837630",
    "end": "1844640"
  },
  {
    "text": "cookie value the session cookie value now would make sense for instance let's",
    "start": "1844640",
    "end": "1851970"
  },
  {
    "text": "say count webpage my account webpage is different to your account webpage so I",
    "start": "1851970",
    "end": "1857299"
  },
  {
    "text": "would like I would configure cloud went to forward the session cookie so that I get a version you get a version they are",
    "start": "1857299",
    "end": "1863240"
  },
  {
    "text": "cached separately so only I can see my cached version only you can see your customers but as you add these forwarded",
    "start": "1863240",
    "end": "1870889"
  },
  {
    "text": "values and they're being added to the cache key that has a tendency to reduce your cache hit ratio so you want to try",
    "start": "1870889",
    "end": "1877490"
  },
  {
    "text": "and make sure that you don't send forward unnecessarily components in your",
    "start": "1877490",
    "end": "1882679"
  },
  {
    "text": "requests so let's just walk through this so here's an example HTTP request there",
    "start": "1882679",
    "end": "1890389"
  },
  {
    "text": "CloudFront will always forward the HTTP method and the path of the request we can't change that that's always sent and",
    "start": "1890389",
    "end": "1896840"
  },
  {
    "text": "they will always be a part of the age of the cache key for CloudFront you can",
    "start": "1896840",
    "end": "1902570"
  },
  {
    "text": "also specify the query string so by default the query strings not forwarded but you can enable the query string",
    "start": "1902570",
    "end": "1908600"
  },
  {
    "text": "forwarding and you can also specify the specific values that get added to the",
    "start": "1908600",
    "end": "1913879"
  },
  {
    "text": "cache came so in this example I'm before doing the whole query string to the origin but I only want widget to be",
    "start": "1913879",
    "end": "1920659"
  },
  {
    "text": "added to the cash game I can forward all headers so I can just configure to",
    "start": "1920659",
    "end": "1927740"
  },
  {
    "text": "forward all headers but also I could be specific about head I could forward just the host header that's often used you",
    "start": "1927740",
    "end": "1934789"
  },
  {
    "text": "may have a web of web servers that are actually hosting multiple web sites so you probably need to identify the actual",
    "start": "1934789",
    "end": "1941059"
  },
  {
    "text": "host that's coming in so CloudFront can forward the host header to on your origin you can identify the website",
    "start": "1941059",
    "end": "1947600"
  },
  {
    "text": "that's been requested and also forwarded accept language maybe I've got a",
    "start": "1947600",
    "end": "1953240"
  },
  {
    "text": "multi-language website so I need the information about the language of the user to determine what language language",
    "start": "1953240",
    "end": "1959059"
  },
  {
    "text": "I return as a response I can also forward all cookies but also I can",
    "start": "1959059",
    "end": "1964970"
  },
  {
    "text": "actually be very specific in the cookies I want so I mentioned earlier about a session cookie",
    "start": "1964970",
    "end": "1970129"
  },
  {
    "text": "perhaps this particular webpage the session has no impact so it doesn't vary the response let's say it could be a",
    "start": "1970129",
    "end": "1976159"
  },
  {
    "text": "help like help section or websites so it's the same no matter who the user is",
    "start": "1976159",
    "end": "1981200"
  },
  {
    "text": "but perhaps I do vary the response based on say the currency that selected all the theme I've selected so",
    "start": "1981200",
    "end": "1988039"
  },
  {
    "text": "I can be specific in which cookies I'm going to respond forward to the origin and therefore allow it to vary that",
    "start": "1988039",
    "end": "1994369"
  },
  {
    "text": "response so here's some tips for",
    "start": "1994369",
    "end": "1999679"
  },
  {
    "start": "1999000",
    "end": "1999000"
  },
  {
    "text": "forwarding as I mentioned before I only forward the what can vote vary the",
    "start": "1999679",
    "end": "2005859"
  },
  {
    "text": "response there's no point vote forwarding all headers if there's headers that you're not go you're not",
    "start": "2005859",
    "end": "2011769"
  },
  {
    "text": "going to vary the response on trying to use forward the headers or the cookies that you actually need at the origin you",
    "start": "2011769",
    "end": "2017589"
  },
  {
    "text": "want to try and maximize the Kashuk ratio as much as possible ideally you",
    "start": "2017589",
    "end": "2023259"
  },
  {
    "text": "want to reduce the variability of for forwarded values what I mean by that is",
    "start": "2023259",
    "end": "2028570"
  },
  {
    "text": "if you're forwarding a header and it could have potentially many different values each one will be stored as a",
    "start": "2028570",
    "end": "2035559"
  },
  {
    "text": "separate cache with a separate cache key if you can constrain and reduce the",
    "start": "2035559",
    "end": "2040570"
  },
  {
    "text": "variability of that value you limit the number of potential cache hit cache keys",
    "start": "2040570",
    "end": "2045609"
  },
  {
    "text": "you'll have that will improve the cache hit ratio and prefer improve the performance often some people might want",
    "start": "2045609",
    "end": "2053799"
  },
  {
    "text": "to track the user or log information about the user on the request so might",
    "start": "2053799",
    "end": "2058839"
  },
  {
    "text": "they might want to forward everything like the session key the session cookie maybe if they forward the session cookie",
    "start": "2058839",
    "end": "2065289"
  },
  {
    "text": "they know that that particular user went to that particular website or that particular part the website but if that",
    "start": "2065289",
    "end": "2071019"
  },
  {
    "text": "particular part the website is going to look the same no matter who the user is",
    "start": "2071019",
    "end": "2076108"
  },
  {
    "text": "you're going to be generating that response each time it's going to be stored as a separate cache object you",
    "start": "2076109",
    "end": "2081519"
  },
  {
    "text": "know reduce your cache hit ratio even though the response is identical every single time we do want to log and track",
    "start": "2081519",
    "end": "2089769"
  },
  {
    "text": "the user where their journey through the website consider using cloud from access logs or perhaps including a beacon in",
    "start": "2089769",
    "end": "2097089"
  },
  {
    "text": "your website so this might be just a single one pixel image that you do forward that particular session cookie",
    "start": "2097089",
    "end": "2103450"
  },
  {
    "text": "back to cloud front and back to the origin but it's just a small thing that's going back and it",
    "start": "2103450",
    "end": "2108789"
  },
  {
    "text": "it's unobtrusive it won't slow down the the viewing of the website most of that can then still be cached another thing",
    "start": "2108789",
    "end": "2117009"
  },
  {
    "text": "is don't forward for authorization so including authorization headers so that",
    "start": "2117009",
    "end": "2122680"
  },
  {
    "text": "you can authorize on the origin whether the users should be should be able to access the content try and use things",
    "start": "2122680",
    "end": "2130180"
  },
  {
    "text": "that are built into CloudFront such a signed you a signed URLs and signed cookies or things like geo restrictions",
    "start": "2130180",
    "end": "2136359"
  },
  {
    "text": "a dress raff to authorize and restrict access to your users but still maintaining the cache the cache ability",
    "start": "2136359",
    "end": "2142809"
  },
  {
    "text": "of the object and then finally using the HTTP vary response header a CloudFront",
    "start": "2142809",
    "end": "2150099"
  },
  {
    "text": "doesn't use the very header effective the very header is part of the h-2b specification it's saying it's",
    "start": "2150099",
    "end": "2156099"
  },
  {
    "text": "allowing the origin to say to downstream caches into the client itself the web browser itself i will vary the response",
    "start": "2156099",
    "end": "2164440"
  },
  {
    "text": "in the future if the if this particular header is different is a different value",
    "start": "2164440",
    "end": "2169799"
  },
  {
    "text": "so it's it's a good thing to do for downstream caches it doesn't have any",
    "start": "2169799",
    "end": "2174849"
  },
  {
    "text": "impact on cloud fun but it's just the best yeah but good advice to use that clown front determines the cache key",
    "start": "2174849",
    "end": "2181660"
  },
  {
    "text": "effectively think that what will vary the response through the configuration of forwarding headers and cookies so I'm",
    "start": "2181660",
    "end": "2193150"
  },
  {
    "start": "2191000",
    "end": "2191000"
  },
  {
    "text": "going to do an example here so forwarding the user agent string so perhaps let's just say I've got an",
    "start": "2193150",
    "end": "2199359"
  },
  {
    "text": "application and I need to know what the user agent is perhaps I need to know",
    "start": "2199359",
    "end": "2204460"
  },
  {
    "text": "whether it's a mobile device or whether it's a desktop device for instance so",
    "start": "2204460",
    "end": "2209769"
  },
  {
    "text": "that I can vary the risk I can vary the what I return the HTML I return maybe there the stylesheet or some sort of",
    "start": "2209769",
    "end": "2216279"
  },
  {
    "text": "something to do with the besides the display or something specific about that client so I make an HTTP request to",
    "start": "2216279",
    "end": "2224440"
  },
  {
    "text": "CloudFront and now configured cloud front to forward the user agent so what it does it will forward the request back",
    "start": "2224440",
    "end": "2231910"
  },
  {
    "text": "to the origin and it will also include the user agent string and the user agent string value will then be added to the",
    "start": "2231910",
    "end": "2238029"
  },
  {
    "text": "cache King the issue is that the user agent string varies considerably between",
    "start": "2238029",
    "end": "2243880"
  },
  {
    "text": "different browsers there's a lots of information in there there's lots of versions lots of different rendering",
    "start": "2243880",
    "end": "2250390"
  },
  {
    "text": "engine versions and all that sort of thing throating systems often you don't",
    "start": "2250390",
    "end": "2256180"
  },
  {
    "text": "probably don't need all that information to make your decision on what kind of response you return back to the client",
    "start": "2256180",
    "end": "2262710"
  },
  {
    "text": "so klawans got this feature of including headers that it can generate itself so",
    "start": "2262710",
    "end": "2270089"
  },
  {
    "text": "this is an example here that it's the header CloudFront is mobile viewer if",
    "start": "2270089",
    "end": "2275619"
  },
  {
    "text": "you forward that header that instructs cloud front to inspect the user agent itself extract the information about",
    "start": "2275619",
    "end": "2283750"
  },
  {
    "text": "whether it's likely to be a mobile a mobile via a viewer mobile browser and",
    "start": "2283750",
    "end": "2289779"
  },
  {
    "text": "if it is it will then send this header and add true to it if it's not a mobile",
    "start": "2289779",
    "end": "2296619"
  },
  {
    "text": "viewer it will still had the ADA but it would just be false but by doing this you've reduced the variability all that",
    "start": "2296619",
    "end": "2302859"
  },
  {
    "text": "variability in the user agent strings has been reduced to a boolean value that",
    "start": "2302859",
    "end": "2308470"
  },
  {
    "text": "means actually you're only going to cache two versions of the response whether it's a mobile viewer or whether",
    "start": "2308470",
    "end": "2316450"
  },
  {
    "text": "it's not so improves your cache hit ratio because you've CloudFront itself is extract the information that that you",
    "start": "2316450",
    "end": "2322630"
  },
  {
    "text": "need to know whether it's a mobile view or not there's also one for tablet",
    "start": "2322630",
    "end": "2328630"
  },
  {
    "text": "viewer desktop and for Smart TV as well",
    "start": "2328630",
    "end": "2334680"
  },
  {
    "text": "but let's say you actually need to know a bit more information that you you don't just want to know whether it's a",
    "start": "2334920",
    "end": "2340480"
  },
  {
    "text": "mobile or desktop via browser maybe you want to know the particular browser itself it's Firefox Chrome age whatever",
    "start": "2340480",
    "end": "2348930"
  },
  {
    "text": "maybe you also need to know the version what you can now use is lambda edge so",
    "start": "2348930",
    "end": "2355720"
  },
  {
    "text": "lambda edge can be invoked on a viewer request it can risk inspect the user",
    "start": "2355720",
    "end": "2363130"
  },
  {
    "text": "agent that's been sent by the client and extract the information you want so in",
    "start": "2363130",
    "end": "2368680"
  },
  {
    "text": "this case I'm extracting the the browser products name and its version and I'm",
    "start": "2368680",
    "end": "2374230"
  },
  {
    "text": "only sending that and forwarding that to the origin so by doing that I'm only gonna send the information that the",
    "start": "2374230",
    "end": "2379960"
  },
  {
    "text": "origin needs to know I'm going to reduce the variability of the user agent string therefore increase the cache it ray",
    "start": "2379960",
    "end": "2386119"
  },
  {
    "text": "show in the improved performance here's for the code bit so this is a lambda",
    "start": "2386119",
    "end": "2393890"
  },
  {
    "start": "2391000",
    "end": "2391000"
  },
  {
    "text": "edge function that's doing just that so we can see that I'm using an OGS NPM",
    "start": "2393890",
    "end": "2401299"
  },
  {
    "text": "module called user agent so this is just a standard no GS module I'm going to include to my lambda edge function what",
    "start": "2401299",
    "end": "2408890"
  },
  {
    "text": "its uses to it can pass information any user agent string and extract different types of information held within so I'm",
    "start": "2408890",
    "end": "2418099"
  },
  {
    "text": "including that into my into my function and then if you see the exports handler",
    "start": "2418099",
    "end": "2423200"
  },
  {
    "text": "that this is the function that's going to be executed by lambda edge whenever a request comes in from the from the",
    "start": "2423200",
    "end": "2429589"
  },
  {
    "text": "viewer from the client I'm going to get the user agent header I'm going to check",
    "start": "2429589",
    "end": "2435230"
  },
  {
    "text": "that it the user agent header exists I'm going to feed the value of that user agent header into the user agent module",
    "start": "2435230",
    "end": "2442910"
  },
  {
    "text": "the library that I'm using and then I'm going to rewrite the user agent header and set the value so that it's the user",
    "start": "2442910",
    "end": "2450440"
  },
  {
    "text": "agent family slash user agent version number once I've set that I then call",
    "start": "2450440",
    "end": "2455989"
  },
  {
    "text": "back to lambda edge then lambda edge will then set that and CloudFront will forward that user agent with that",
    "start": "2455989",
    "end": "2461930"
  },
  {
    "text": "normalized simplified user agent string so I've now maximized the cache hit",
    "start": "2461930",
    "end": "2468650"
  },
  {
    "text": "ratio as much as possible because I'm only sending the information that I need back to the origin here's another",
    "start": "2468650",
    "end": "2476450"
  },
  {
    "text": "example so web peers are image format it's often it's more optimized than typically other",
    "start": "2476450",
    "end": "2483799"
  },
  {
    "text": "image formats but it's not supported in all browsers so in this example what I",
    "start": "2483799",
    "end": "2491480"
  },
  {
    "text": "want to do is I want to use WebP II and return the web P to the browser's but only if they support the web P format",
    "start": "2491480",
    "end": "2498759"
  },
  {
    "text": "now I could use a user agent example previously so I could send the user",
    "start": "2498759",
    "end": "2504440"
  },
  {
    "text": "agents and the Virgin send it back to the origin I could then use the origin to determine whether that user agent",
    "start": "2504440",
    "end": "2510739"
  },
  {
    "text": "supports web P the issue with that is I'm going to have to support and define and determine which which",
    "start": "2510739",
    "end": "2518030"
  },
  {
    "text": "versions support web P and which don't and then I'm gonna have to update it when the version version numbers and new",
    "start": "2518030",
    "end": "2523100"
  },
  {
    "text": "browsers come out and maybe they will add that support later HTTP has what's",
    "start": "2523100",
    "end": "2531020"
  },
  {
    "text": "called the accept header so this the accept header in a request is indicating from the browser from the user agent I",
    "start": "2531020",
    "end": "2538190"
  },
  {
    "text": "support files of this particular type so",
    "start": "2538190",
    "end": "2543530"
  },
  {
    "text": "in this example what I'm doing is I'm looking for that header except I'm looking to see if image slash web P",
    "start": "2543530",
    "end": "2551360"
  },
  {
    "text": "which is the the content type for web P check to see if that exists within the content and the accept header if it is",
    "start": "2551360",
    "end": "2558230"
  },
  {
    "text": "there that I know that the web browser is indicating to me that it supports web P so I can what I then do is I'm",
    "start": "2558230",
    "end": "2565040"
  },
  {
    "text": "rewriting the the URI though the request path I'm actually taking the file extension off the end and replacing that",
    "start": "2565040",
    "end": "2571880"
  },
  {
    "text": "work with web P so what this is doing it's going to change the request path that goes back to the origin so the",
    "start": "2571880",
    "end": "2578360"
  },
  {
    "text": "origin will get request for web P if I know that the browser's are supported or it's going to get a request say for a",
    "start": "2578360",
    "end": "2584840"
  },
  {
    "text": "PNG file when I know that the web browser doesn't support web P it supports PNG one of the things they need",
    "start": "2584840",
    "end": "2595160"
  },
  {
    "text": "to do is to configure the ability that it will cache those as two separate",
    "start": "2595160",
    "end": "2600800"
  },
  {
    "text": "versions as well what we don't want is to overwrite different different image",
    "start": "2600800",
    "end": "2608060"
  },
  {
    "text": "image cached objects as well so I'll show two examples where you can vary the",
    "start": "2608060",
    "end": "2614780"
  },
  {
    "text": "response based on information that's returned by all given by the user agent",
    "start": "2614780",
    "end": "2621070"
  },
  {
    "text": "but I just will also want to add this the concept of using responsive web design so it's great that we've got this",
    "start": "2621070",
    "end": "2627530"
  },
  {
    "start": "2622000",
    "end": "2622000"
  },
  {
    "text": "power within lambda H to do rewrites and extract information but we've also got the the functionality most modern",
    "start": "2627530",
    "end": "2633770"
  },
  {
    "text": "browsers do responsive web design so as an example we can vary the look of a",
    "start": "2633770",
    "end": "2638990"
  },
  {
    "text": "website based on things such as using css3 media selectors so in this example",
    "start": "2638990",
    "end": "2644900"
  },
  {
    "text": "we're changing that the design of the website the layer the website client site with no server",
    "start": "2644900",
    "end": "2651660"
  },
  {
    "text": "required in this bit purely through CSS stylesheets so the next thing to talk",
    "start": "2651660",
    "end": "2662400"
  },
  {
    "text": "about is to validate efficiently so important point to make is that HTTP",
    "start": "2662400",
    "end": "2669029"
  },
  {
    "text": "itself doesn't support invalidation the idea being that you can invalidate something that's already in yet in an",
    "start": "2669029",
    "end": "2674729"
  },
  {
    "text": "HTTP cache now many CDN support invalidation so",
    "start": "2674729",
    "end": "2680989"
  },
  {
    "text": "including CloudFront well obviously if you've got you've got control and ownership of your origin service you can",
    "start": "2680989",
    "end": "2687989"
  },
  {
    "text": "invalidate local caches there but what you can't do is you can't invalidate content downstream you can't invalidate",
    "start": "2687989",
    "end": "2694680"
  },
  {
    "text": "content that may be in an ISP cache or in a public cache you can't invalidate content in a",
    "start": "2694680",
    "end": "2701219"
  },
  {
    "text": "browser cache so although you can invalidate content in CloudFront it's",
    "start": "2701219",
    "end": "2706319"
  },
  {
    "text": "not all it's not really the answer when you want to update you want to change you've got a new version of content the",
    "start": "2706319",
    "end": "2713039"
  },
  {
    "text": "better way is to use validation validation is built into HSB spec I",
    "start": "2713039",
    "end": "2718109"
  },
  {
    "start": "2715000",
    "end": "2715000"
  },
  {
    "text": "mentioned it previously it's what's called conditional HTTP requests so I can say perform this particular action",
    "start": "2718109",
    "end": "2725509"
  },
  {
    "text": "but only if so for examples if modifies give me give me the object but only if",
    "start": "2725509",
    "end": "2733829"
  },
  {
    "text": "it's modified since this particular date and time or the other one I mentioned",
    "start": "2733829",
    "end": "2739499"
  },
  {
    "text": "was if none match so that would be a case of give me the object but only if the entity check the e-tag is different",
    "start": "2739499",
    "end": "2747269"
  },
  {
    "text": "to the one I've got if match is used for things like if you're doing a pert if",
    "start": "2747269",
    "end": "2752519"
  },
  {
    "text": "you're putting an object you may only want to overwrite an object if you know the object that's currently stored so",
    "start": "2752519",
    "end": "2759839"
  },
  {
    "text": "for instance if I take if I download an object I make a change and I do a put on",
    "start": "2759839",
    "end": "2765029"
  },
  {
    "text": "what if I want to be sure that I'm actually overwriting the version that I previously had I'd use an if match",
    "start": "2765029",
    "end": "2770309"
  },
  {
    "text": "conditional put now if the object hasn't",
    "start": "2770309",
    "end": "2775710"
  },
  {
    "text": "changed in a conditional get the origin should return a 304 not modified this",
    "start": "2775710",
    "end": "2781049"
  },
  {
    "text": "indicates the client you've got the currentversion continued to use that from your from your cache now the origin",
    "start": "2781049",
    "end": "2789060"
  },
  {
    "text": "itself could determine how would it determine whether it's not modified one option is I will generate the response I",
    "start": "2789060",
    "end": "2796290"
  },
  {
    "text": "will talk to my database I will render the response and then I will generate",
    "start": "2796290",
    "end": "2801420"
  },
  {
    "text": "the e-tag I might do a hash and then I'll realize well actually it's exactly the same tag as you've already gotten",
    "start": "2801420",
    "end": "2807690"
  },
  {
    "text": "your cache and that's fine but then you've used a lot of CPU cycles and you've called your database just to find",
    "start": "2807690",
    "end": "2814440"
  },
  {
    "text": "out they actually you they've already got that same version so options around this is some time to be able to",
    "start": "2814440",
    "end": "2819570"
  },
  {
    "text": "determine maybe maybe you've got the old version maybe so you could store for instance the e-tag in the database so",
    "start": "2819570",
    "end": "2825990"
  },
  {
    "text": "you could check the the e-tag in the database or in a memory cache to determine whether you've whether the",
    "start": "2825990",
    "end": "2832380"
  },
  {
    "text": "client has got the current version and therefore save CPU time by generating the response unnecessarily often some",
    "start": "2832380",
    "end": "2842610"
  },
  {
    "text": "people will often use a lower shared max-age s max-age and a higher max age",
    "start": "2842610",
    "end": "2848790"
  },
  {
    "text": "so what this means is content will stay in the cache of the object and before",
    "start": "2848790",
    "end": "2856110"
  },
  {
    "text": "it's validated in the client longer but you'll actually refresh the content in",
    "start": "2856110",
    "end": "2862440"
  },
  {
    "text": "the shared caches sometimes the reason is it's not too bad if the user has",
    "start": "2862440",
    "end": "2868110"
  },
  {
    "text": "received an object that they keep using that object for a longer term but maybe",
    "start": "2868110",
    "end": "2873300"
  },
  {
    "text": "a new user you want to make the most up-to-date object and then also consider",
    "start": "2873300",
    "end": "2878430"
  },
  {
    "text": "using URL versioning too if you want to cache bust if you want to update an object and basically bypass the cache",
    "start": "2878430",
    "end": "2885480"
  },
  {
    "text": "this is often done things such as like Java scripts so Java scripts are",
    "start": "2885480",
    "end": "2891270"
  },
  {
    "text": "typically then they don't change that often so it's good practice to cache that as long as possible but when you do",
    "start": "2891270",
    "end": "2898080"
  },
  {
    "text": "make that change you often want to make that change it's fairly fairly quickly so one thing to do is to upload that",
    "start": "2898080",
    "end": "2905040"
  },
  {
    "text": "JavaScript and give it a different name so that when there and refer to that new version so when a new request is made",
    "start": "2905040",
    "end": "2911070"
  },
  {
    "text": "you'll get that new version and it won't respond with the old version because that's completely different part of the cache",
    "start": "2911070",
    "end": "2917420"
  },
  {
    "text": "we were different cache game the next",
    "start": "2917420",
    "end": "2922430"
  },
  {
    "text": "thing to talk about is automating the edge so these sort of keep things for",
    "start": "2922430",
    "end": "2929000"
  },
  {
    "start": "2925000",
    "end": "2925000"
  },
  {
    "text": "obviously like many a SS services we've got the ability to control our edge",
    "start": "2929000",
    "end": "2934040"
  },
  {
    "text": "services using ap is it's often it's probably more of a traditional thing that other CD ends are controlled",
    "start": "2934040",
    "end": "2942350"
  },
  {
    "text": "typically through through a console through a web GUI GUI possibly using",
    "start": "2942350",
    "end": "2947390"
  },
  {
    "text": "having to engage with professional services a duress edge a duress edge services themselves are controlled",
    "start": "2947390",
    "end": "2953930"
  },
  {
    "text": "through an API you can use their web console you can use API you can use the edge of esos SDKs there's no reason for",
    "start": "2953930",
    "end": "2960560"
  },
  {
    "text": "you to engage professional services or engage with a partner unless you want to it allows you to make changes",
    "start": "2960560",
    "end": "2966620"
  },
  {
    "text": "immediately you can work it and develop it as you develop your application the",
    "start": "2966620",
    "end": "2973010"
  },
  {
    "text": "key thing is also that these edge services are deployable through in cloud formation so you can create a CloudFormation template that defines",
    "start": "2973010",
    "end": "2979250"
  },
  {
    "text": "your origin application as well as your edge services and deploy the changes using cloud formation one other thing is",
    "start": "2979250",
    "end": "2988670"
  },
  {
    "text": "also that I am is supported across these different edge services so again you've got that access control to make",
    "start": "2988670",
    "end": "2993920"
  },
  {
    "text": "modifications and changes so let's think about the edges code so I've got an",
    "start": "2993920",
    "end": "3001180"
  },
  {
    "start": "2998000",
    "end": "2998000"
  },
  {
    "text": "example here it's fairly simple I've got I'm using route 53 to host the dns name",
    "start": "3001180",
    "end": "3006910"
  },
  {
    "text": "the domain name for that website about CloudFront it's the content delivery serving the content I'm using a ADA",
    "start": "3006910",
    "end": "3013930"
  },
  {
    "text": "graph to protect my application and I'm also using it ADA where certificate manager to provide a SSL TLS certificate",
    "start": "3013930",
    "end": "3022450"
  },
  {
    "text": "to my website and in this example I've just got a single origin running in EU",
    "start": "3022450",
    "end": "3028360"
  },
  {
    "text": "West one and it's a load balancer of ec2 service but let's say I've got some",
    "start": "3028360",
    "end": "3034060"
  },
  {
    "text": "static content I want to store I could store them on my web servers but the other option is I could store it on s3",
    "start": "3034060",
    "end": "3040440"
  },
  {
    "text": "so now their web the static content is being served out of s3 means I don't need to have",
    "start": "3040440",
    "end": "3046789"
  },
  {
    "text": "as many et2 servers because I'm the only serving dynamic content from those",
    "start": "3046789",
    "end": "3053289"
  },
  {
    "text": "perhaps I've got web servers located in my data center I can also have those as",
    "start": "3053289",
    "end": "3058910"
  },
  {
    "text": "origins behind CloudFront and then perhaps maybe I decided I'm going global",
    "start": "3058910",
    "end": "3064669"
  },
  {
    "text": "therefore I create a new origin server as close to my users I can I host that",
    "start": "3064669",
    "end": "3069890"
  },
  {
    "text": "in the U in u.s. West one and then I can use Amazon route 53 latency based",
    "start": "3069890",
    "end": "3075559"
  },
  {
    "text": "routing to route requests to the nearest origin for that particular cloud front",
    "start": "3075559",
    "end": "3080959"
  },
  {
    "text": "edge location now all of these have been performed using cloud formation so",
    "start": "3080959",
    "end": "3086959"
  },
  {
    "text": "whenever I want to make a change I can update my CloudFormation template and deploy the update to make that change",
    "start": "3086959",
    "end": "3093140"
  },
  {
    "text": "all through code rather than making changes through the console I can also",
    "start": "3093140",
    "end": "3101150"
  },
  {
    "text": "use a u.s. lambda to make changes so for instance I can update my a debris soif configuration responding to known",
    "start": "3101150",
    "end": "3108410"
  },
  {
    "text": "attacks and I can also use lambda edge on my cloud front edge layer CloudFront",
    "start": "3108410",
    "end": "3114619"
  },
  {
    "text": "distribution now all of this can be deployed Yuda major West code pipeline",
    "start": "3114619",
    "end": "3121479"
  },
  {
    "start": "3118000",
    "end": "3118000"
  },
  {
    "text": "so I can have a cloud formation template and use code commit to store that and",
    "start": "3121479",
    "end": "3127339"
  },
  {
    "text": "version it I can then deploy that to a development CloudFront distribution do",
    "start": "3127339",
    "end": "3135619"
  },
  {
    "text": "the testing and then do deploy it to a production CloudFront distribution and",
    "start": "3135619",
    "end": "3142519"
  },
  {
    "text": "all of this can be done using a duress code pipeline in my previous when I did",
    "start": "3142519",
    "end": "3149479"
  },
  {
    "text": "this session last year I did do a demo times there's a time constraint for this",
    "start": "3149479",
    "end": "3156019"
  },
  {
    "text": "year with extra content they thought if you want to see a demo if you search for of taking DevOps to the edge reinvent",
    "start": "3156019",
    "end": "3163489"
  },
  {
    "text": "2016 on YouTube there's a link there but that will show you the recording of last year's session",
    "start": "3163489",
    "end": "3171410"
  },
  {
    "text": "while I do a demo using code pipe code pipeline to deploy changes to a cloud",
    "start": "3171410",
    "end": "3177110"
  },
  {
    "text": "front another thing I want to mention is ADA West wofe security automations so",
    "start": "3177110",
    "end": "3183740"
  },
  {
    "start": "3180000",
    "end": "3180000"
  },
  {
    "text": "these this is a collection of of code and templates to do automated",
    "start": "3183740",
    "end": "3189130"
  },
  {
    "text": "configuration of ADA West woth such as checking for IP reputation list so if",
    "start": "3189130",
    "end": "3195410"
  },
  {
    "text": "there's a bad reputation on particular IP addresses ADA West wofe can be automated to block those IP addresses as",
    "start": "3195410",
    "end": "3202190"
  },
  {
    "text": "many different types of also such as bad bot detection so even if you specify in your robots.txt file two robots",
    "start": "3202190",
    "end": "3209180"
  },
  {
    "text": "shouldn't go to a particular URL if they go there you know that they're behaving badly and therefore you can block them",
    "start": "3209180",
    "end": "3215440"
  },
  {
    "text": "and in addition we launched this week the ability for partner managed ADA West",
    "start": "3215440",
    "end": "3222170"
  },
  {
    "text": "waffles as well so the last section",
    "start": "3222170",
    "end": "3228220"
  },
  {
    "text": "monitored the edge so route 53 CloudFront wofe and lambda edge",
    "start": "3228220",
    "end": "3234320"
  },
  {
    "text": "they they all support cloud trail so cloud trail wilmot log activity again",
    "start": "3234320",
    "end": "3240050"
  },
  {
    "text": "the api's of those particular ada breath services so it allow you to track what's happening against your your services or",
    "start": "3240050",
    "end": "3247010"
  },
  {
    "text": "your resources within those services these services are also supported in",
    "start": "3247010",
    "end": "3252050"
  },
  {
    "text": "cloud watch metrics on alarms so you can set metrics around cloud front and dns",
    "start": "3252050",
    "end": "3258380"
  },
  {
    "text": "etc and set alerts as well CloudFront also supports reporting so you can see",
    "start": "3258380",
    "end": "3264200"
  },
  {
    "text": "error rates geographical locations of clients making the request and you've",
    "start": "3264200",
    "end": "3271190"
  },
  {
    "start": "3271000",
    "end": "3271000"
  },
  {
    "text": "also got access logs of cloud front so these are standard w3c formatted log files and these are delivered to an s3",
    "start": "3271190",
    "end": "3279320"
  },
  {
    "text": "bucket that you configure when you're creating your cloud for distribution and you can use for instance a Jewish glue",
    "start": "3279320",
    "end": "3286490"
  },
  {
    "text": "to take the log files perhaps enrich those log files add extra information maybe it's content stuff",
    "start": "3286490",
    "end": "3293150"
  },
  {
    "text": "that you've logged in your application you could add those to your cloud from access logs and then from there you can",
    "start": "3293150",
    "end": "3298970"
  },
  {
    "text": "then start to use stall the content in s3 or in redshift and then use Amazon quick site to",
    "start": "3298970",
    "end": "3306340"
  },
  {
    "text": "analyze that content and visualize that content you can also use Amazon Athena",
    "start": "3306340",
    "end": "3312740"
  },
  {
    "text": "against the log files in s3 - to query that data using SQL or you can use your",
    "start": "3312740",
    "end": "3320660"
  },
  {
    "text": "favorite W 3 log parser so that's what",
    "start": "3320660",
    "end": "3327020"
  },
  {
    "text": "the patterns for the DevOps edge and the final key takeaways I have for you it's",
    "start": "3327020",
    "end": "3332450"
  },
  {
    "start": "3331000",
    "end": "3331000"
  },
  {
    "text": "a key point is to consider the age of where Sage's part of your application it's not something that you add on at",
    "start": "3332450",
    "end": "3338480"
  },
  {
    "text": "the end of your project is something that you should consider right at the beginning of your project and also to",
    "start": "3338480",
    "end": "3343580"
  },
  {
    "text": "think that your ad west edge configuration will change and adapt over",
    "start": "3343580",
    "end": "3348950"
  },
  {
    "text": "time as your application adapt and evolve so so your edge configuration",
    "start": "3348950",
    "end": "3355370"
  },
  {
    "text": "should do key point is to optimize and use caching efficiently so you want your",
    "start": "3355370",
    "end": "3361760"
  },
  {
    "text": "aim is to maximize your cache hit ratio so that as much content can be served out of the cloud from tak√°cs cache as",
    "start": "3361760",
    "end": "3368000"
  },
  {
    "text": "possible so try and be as efficiently as possible so reduce the variability reduce the very how much you forward",
    "start": "3368000",
    "end": "3376160"
  },
  {
    "text": "back to your origin automate your configuration of age of west edge so",
    "start": "3376160",
    "end": "3381770"
  },
  {
    "text": "this can be done in using CloudFormation to automate it but also think about using things like a dress lambda to",
    "start": "3381770",
    "end": "3388460"
  },
  {
    "text": "automate your configuration to vary your ada west waffles in response to known threats then finally to monitor your age",
    "start": "3388460",
    "end": "3396860"
  },
  {
    "text": "of race age using cloud trail cloud watch and also the service logs that the individual services provides that's the",
    "start": "3396860",
    "end": "3405620"
  },
  {
    "text": "end of this session thank you very much",
    "start": "3405620",
    "end": "3408910"
  }
]