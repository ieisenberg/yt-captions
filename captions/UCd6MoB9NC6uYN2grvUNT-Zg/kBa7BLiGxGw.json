[
  {
    "text": "- [Satesh] If you can't monitor\nit, you can't manage it.",
    "start": "930",
    "end": "4259"
  },
  {
    "text": "This is true not only\nfor people and processes,",
    "start": "4260",
    "end": "7020"
  },
  {
    "text": "but also for data warehouses.",
    "start": "7020",
    "end": "9840"
  },
  {
    "text": "That is the reason why\nAmazon Redshift focuses",
    "start": "9840",
    "end": "13140"
  },
  {
    "text": "on providing new monitoring capabilities,",
    "start": "13140",
    "end": "16230"
  },
  {
    "text": "such as visual query profiler,",
    "start": "16230",
    "end": "18330"
  },
  {
    "text": "enhanced console dashboards,\nand new system views.",
    "start": "18330",
    "end": "22353"
  },
  {
    "text": "I'm Satesh Sonti,",
    "start": "23880",
    "end": "25380"
  },
  {
    "text": "senior specialist solution\narchitect with AWS.",
    "start": "25380",
    "end": "28470"
  },
  {
    "text": "In this session, I'll walk\nyou through recently launched",
    "start": "28470",
    "end": "32160"
  },
  {
    "text": "enhanced monitoring\ncapabilities in Amazon Redshift.",
    "start": "32160",
    "end": "35343"
  },
  {
    "text": "Amazon Redshift now offers",
    "start": "38640",
    "end": "40770"
  },
  {
    "text": "enhanced query monitoring capabilities,",
    "start": "40770",
    "end": "42630"
  },
  {
    "text": "enabling you to efficiently identify",
    "start": "42630",
    "end": "45240"
  },
  {
    "text": "and isolate performance bottlenecks.",
    "start": "45240",
    "end": "47970"
  },
  {
    "text": "So with this new feature,",
    "start": "47970",
    "end": "49710"
  },
  {
    "text": "you can analyze queries\nin specific timeframe,",
    "start": "49710",
    "end": "53370"
  },
  {
    "text": "find problematic queries,",
    "start": "53370",
    "end": "54899"
  },
  {
    "text": "and also drill down for\ndetailed query clouds.",
    "start": "54900",
    "end": "58890"
  },
  {
    "text": "You can also review performance\nstrengths of a query",
    "start": "58890",
    "end": "61829"
  },
  {
    "text": "over a period of time,",
    "start": "61830",
    "end": "63660"
  },
  {
    "text": "so this provides you\nwith necessary insights",
    "start": "63660",
    "end": "66900"
  },
  {
    "text": "to optimize your workloads",
    "start": "66900",
    "end": "68940"
  },
  {
    "text": "and ensure efficient data\nwarehouse operations.",
    "start": "68940",
    "end": "72003"
  },
  {
    "text": "In this demo, we will\ncover how you can access",
    "start": "73770",
    "end": "77159"
  },
  {
    "text": "and navigate the new enhanced\nmonitoring user interface,",
    "start": "77160",
    "end": "81180"
  },
  {
    "text": "then we will get into the\ndetails on how you can drill down",
    "start": "81180",
    "end": "84170"
  },
  {
    "text": "to specific timeframe\nand see the queries ran",
    "start": "84170",
    "end": "86988"
  },
  {
    "text": "during that timeframe",
    "start": "86988",
    "end": "89296"
  },
  {
    "text": "and look at the different\nphases of the query,",
    "start": "89296",
    "end": "91890"
  },
  {
    "text": "like the compilation time,\nplanning time, execution time,",
    "start": "91890",
    "end": "95280"
  },
  {
    "text": "and see which phase took longer time",
    "start": "95280",
    "end": "96748"
  },
  {
    "text": "and which phase finished faster.",
    "start": "96748",
    "end": "98973"
  },
  {
    "text": "We'll also debug a query\nusing visual query profiler.",
    "start": "100320",
    "end": "104820"
  },
  {
    "text": "We will take a query and\nsee what is the bottleneck",
    "start": "104820",
    "end": "107232"
  },
  {
    "text": "in the query execution, fix\nit, and observe the difference.",
    "start": "107232",
    "end": "110853"
  },
  {
    "text": "Finally, we will cover monitoring trends",
    "start": "111720",
    "end": "113473"
  },
  {
    "text": "in query performance.",
    "start": "113473",
    "end": "115229"
  },
  {
    "text": "We will take an example query",
    "start": "115230",
    "end": "116520"
  },
  {
    "text": "and see the effects of\nchanging compute capacity",
    "start": "116520",
    "end": "120570"
  },
  {
    "text": "on that query execution\nfor a period of time.",
    "start": "120570",
    "end": "123243"
  },
  {
    "text": "Let's get into the demo.",
    "start": "124740",
    "end": "126092"
  },
  {
    "text": "We are now in Amazon Redshift console.",
    "start": "127729",
    "end": "130259"
  },
  {
    "text": "On the left hand side, you will see query",
    "start": "130260",
    "end": "132150"
  },
  {
    "text": "and database monitoring option.",
    "start": "132150",
    "end": "134579"
  },
  {
    "text": "If you click on that, it will take you",
    "start": "134580",
    "end": "136290"
  },
  {
    "text": "to the enhanced monitoring\nview by default.",
    "start": "136290",
    "end": "139319"
  },
  {
    "text": "If you turn this off, you will\ngo back to the older view,",
    "start": "139320",
    "end": "142590"
  },
  {
    "text": "but by default, it will be turned on",
    "start": "142590",
    "end": "144032"
  },
  {
    "text": "so that you can get the\nnew visual experience.",
    "start": "144032",
    "end": "147480"
  },
  {
    "text": "I have four data warehouses in my account.",
    "start": "147480",
    "end": "150599"
  },
  {
    "text": "Some are provisioned,\nand some are serverless.",
    "start": "150600",
    "end": "153150"
  },
  {
    "text": "You can see all of them in single pane.",
    "start": "153150",
    "end": "155819"
  },
  {
    "text": "For provisioned, currently,\nyou need to connect",
    "start": "155820",
    "end": "157560"
  },
  {
    "text": "to the database to see the\nmetrics, and for serverless,",
    "start": "157560",
    "end": "160290"
  },
  {
    "text": "you can get started with the IAM user",
    "start": "160290",
    "end": "162827"
  },
  {
    "text": "or the role with which you logged in.",
    "start": "162828",
    "end": "165540"
  },
  {
    "text": "On this pane, you can see\nthe average query duration",
    "start": "165540",
    "end": "168750"
  },
  {
    "text": "for each instance and the\naverage number of queries ran,",
    "start": "168751",
    "end": "173130"
  },
  {
    "text": "so that will give you a high-level view",
    "start": "173130",
    "end": "175217"
  },
  {
    "text": "of all the instances,",
    "start": "175217",
    "end": "176614"
  },
  {
    "text": "how they're performing in your account.",
    "start": "176614",
    "end": "178953"
  },
  {
    "text": "Now, I would like to analyze the workload",
    "start": "181197",
    "end": "183660"
  },
  {
    "text": "in CAD demo work group, so I select that.",
    "start": "183660",
    "end": "186930"
  },
  {
    "text": "As soon as I select that,\nI'll be able to see the number",
    "start": "186930",
    "end": "190200"
  },
  {
    "text": "of completed queries running\nversus queued queries,",
    "start": "190200",
    "end": "193020"
  },
  {
    "text": "average query elapsed time,",
    "start": "193020",
    "end": "194910"
  },
  {
    "text": "and database connections\nunder the compute used,",
    "start": "194910",
    "end": "197100"
  },
  {
    "text": "so these are some of the\nmetrics that are available",
    "start": "197100",
    "end": "199560"
  },
  {
    "text": "as soon as you click on the work group,",
    "start": "199560",
    "end": "202470"
  },
  {
    "text": "but let me dive deep into it.",
    "start": "202470",
    "end": "203910"
  },
  {
    "text": "If I click on that, it will\nlist down the query run times",
    "start": "203910",
    "end": "207990"
  },
  {
    "text": "over a period of time.",
    "start": "207990",
    "end": "209280"
  },
  {
    "text": "I will analyze for last 12 hours,",
    "start": "209280",
    "end": "212970"
  },
  {
    "text": "so I select that time range.",
    "start": "212970",
    "end": "215013"
  },
  {
    "text": "I will go in the range of one hour,",
    "start": "216360",
    "end": "218683"
  },
  {
    "text": "so then I can see that during the day,",
    "start": "220200",
    "end": "223290"
  },
  {
    "text": "there's significant queuing\nbetween 11:45 to 12:45.",
    "start": "223290",
    "end": "227685"
  },
  {
    "text": "After that, there is no\nqueuing, it's slowed down,",
    "start": "227686",
    "end": "231600"
  },
  {
    "text": "and I see queuing time to zero,",
    "start": "231600",
    "end": "233284"
  },
  {
    "text": "and most of the queries are\nspending time in execution.",
    "start": "233284",
    "end": "237450"
  },
  {
    "text": "So if you'd like to drill down",
    "start": "237450",
    "end": "239103"
  },
  {
    "text": "and find out the specific timeframe",
    "start": "239103",
    "end": "243450"
  },
  {
    "text": "where I saw most amount of queuing,",
    "start": "243450",
    "end": "246075"
  },
  {
    "text": "I can click on drill down,",
    "start": "246075",
    "end": "248073"
  },
  {
    "text": "then it will goes to\nthe specific time period",
    "start": "249630",
    "end": "251447"
  },
  {
    "text": "between 12:44 to 13:44.",
    "start": "251447",
    "end": "256200"
  },
  {
    "text": "It comes down here, it\nlists down all the queries",
    "start": "256200",
    "end": "258237"
  },
  {
    "text": "that are run by different\nusers, and if I keep moving on,",
    "start": "258237",
    "end": "263237"
  },
  {
    "text": "I can see the queries where\nthere's significant queuing",
    "start": "263250",
    "end": "266370"
  },
  {
    "text": "and then find out why there\nis significant queuing",
    "start": "266370",
    "end": "269580"
  },
  {
    "text": "during that time for these queries.",
    "start": "269580",
    "end": "270974"
  },
  {
    "text": "Is it like it is waiting\non some resources?",
    "start": "270975",
    "end": "273960"
  },
  {
    "text": "I can do further analysis on top of it.",
    "start": "273960",
    "end": "276840"
  },
  {
    "text": "Additionally, I can also see,",
    "start": "276840",
    "end": "279090"
  },
  {
    "text": "who are the users running\nqueries during this timeframe?",
    "start": "279090",
    "end": "282270"
  },
  {
    "text": "In my environment, I have only two,",
    "start": "282270",
    "end": "283919"
  },
  {
    "text": "but in the real production environment,",
    "start": "283920",
    "end": "285870"
  },
  {
    "text": "you may see more number of\nusers, and along with the users,",
    "start": "285870",
    "end": "289440"
  },
  {
    "text": "you'll also see the number\nof queries they're running",
    "start": "289440",
    "end": "291930"
  },
  {
    "text": "and where they are\nspending most of the time.",
    "start": "291930",
    "end": "294090"
  },
  {
    "text": "If you look at the first one,\nthis is significant queuing,",
    "start": "294090",
    "end": "296633"
  },
  {
    "text": "and this user does not have any queuing,",
    "start": "296633",
    "end": "299940"
  },
  {
    "text": "and it also tells us who is contributing",
    "start": "299940",
    "end": "302022"
  },
  {
    "text": "to clogging in the data\nwarehouse environment.",
    "start": "302022",
    "end": "305163"
  },
  {
    "text": "And you can also see\nadditional performance metrics,",
    "start": "306090",
    "end": "308790"
  },
  {
    "text": "like the completed queries\nand running queries.",
    "start": "308790",
    "end": "311400"
  },
  {
    "text": "This you saw when when we\nselected the work group,",
    "start": "311400",
    "end": "315150"
  },
  {
    "text": "the same metrics you can see here as well.",
    "start": "315150",
    "end": "317820"
  },
  {
    "text": "Now, we will see how to debug a query",
    "start": "317820",
    "end": "320550"
  },
  {
    "text": "using new visual query profiler.",
    "start": "320550",
    "end": "323250"
  },
  {
    "text": "Using query editor V2,",
    "start": "323250",
    "end": "324630"
  },
  {
    "text": "where I have some tables\nloaded with sample data",
    "start": "324630",
    "end": "328290"
  },
  {
    "text": "and I ran a query joining\nsupplier and nation.",
    "start": "328290",
    "end": "331260"
  },
  {
    "text": "This query ran for almost 205 seconds.",
    "start": "331260",
    "end": "334474"
  },
  {
    "text": "You can see that from the elapsed time,",
    "start": "334474",
    "end": "336930"
  },
  {
    "text": "and there's a problem in this query.",
    "start": "336930",
    "end": "338460"
  },
  {
    "text": "We'll find out what is that problem.",
    "start": "338460",
    "end": "340443"
  },
  {
    "text": "So I'll take the query ID\nfrom the query editor V2",
    "start": "341340",
    "end": "344790"
  },
  {
    "text": "that I'm collecting here,",
    "start": "344790",
    "end": "346920"
  },
  {
    "text": "and we will go back to the\nenhanced monitoring view.",
    "start": "346920",
    "end": "351920"
  },
  {
    "text": "and if you come to the query\nhistory and paste the query ID,",
    "start": "352080",
    "end": "355620"
  },
  {
    "text": "you can see that query here.",
    "start": "355620",
    "end": "358380"
  },
  {
    "text": "If you look at it quickly,\nthere is no queuing time.",
    "start": "358380",
    "end": "361530"
  },
  {
    "text": "Most of the time, it's spent on execution,",
    "start": "361530",
    "end": "363990"
  },
  {
    "text": "so let's go ahead and see further details.",
    "start": "363990",
    "end": "367110"
  },
  {
    "text": "This brings up a visual\nrepresentation of the query we ran",
    "start": "367110",
    "end": "371340"
  },
  {
    "text": "and the amount of data that traveled",
    "start": "371340",
    "end": "374580"
  },
  {
    "text": "from one step to another step.",
    "start": "374580",
    "end": "376770"
  },
  {
    "text": "Usually, we should turn\non the view streams",
    "start": "376770",
    "end": "378854"
  },
  {
    "text": "and see the stream which\ntook longer period of time.",
    "start": "378855",
    "end": "383550"
  },
  {
    "text": "In this case, if you observe,",
    "start": "383550",
    "end": "385830"
  },
  {
    "text": "stream one took longer period\nof time among all three,",
    "start": "385830",
    "end": "389610"
  },
  {
    "text": "so we'll start our analysis there.",
    "start": "389610",
    "end": "391473"
  },
  {
    "text": "If you observe, the first\nstep is scanning supply table.",
    "start": "393600",
    "end": "398600"
  },
  {
    "text": "It pulled up 300 million rows",
    "start": "398610",
    "end": "401340"
  },
  {
    "text": "and joined with a nation\ntable, which has 25 rows,",
    "start": "401340",
    "end": "406290"
  },
  {
    "text": "and after the join,",
    "start": "406290",
    "end": "408360"
  },
  {
    "text": "it resulted in almost 7.5 billion records,",
    "start": "408360",
    "end": "412500"
  },
  {
    "text": "and there's a nested loop here,",
    "start": "412500",
    "end": "415230"
  },
  {
    "text": "and you also see that the nested loop",
    "start": "415230",
    "end": "418530"
  },
  {
    "text": "was called out by the query\nprofiler, and generally,",
    "start": "418530",
    "end": "422880"
  },
  {
    "text": "a Cartesian join is a very\ntime-consuming operation",
    "start": "422880",
    "end": "427880"
  },
  {
    "text": "and often not intended operation,",
    "start": "428880",
    "end": "432600"
  },
  {
    "text": "so let's go ahead and fix this query.",
    "start": "432600",
    "end": "434763"
  },
  {
    "text": "I fixed this query by\nadding a join condition",
    "start": "437010",
    "end": "439234"
  },
  {
    "text": "between supplier and nation on nation key.",
    "start": "439234",
    "end": "442530"
  },
  {
    "text": "If you notice, now, the\nelapsed time came down",
    "start": "442530",
    "end": "445624"
  },
  {
    "text": "to just eight seconds from prior query,",
    "start": "445624",
    "end": "448680"
  },
  {
    "text": "which is 205 seconds.",
    "start": "448680",
    "end": "451440"
  },
  {
    "text": "Let's look at the query\nplan of the updated query.",
    "start": "451440",
    "end": "453644"
  },
  {
    "text": "Take this query ID, go back\nto the query monitoring,",
    "start": "453644",
    "end": "458644"
  },
  {
    "text": "and going to the same work group",
    "start": "459270",
    "end": "463080"
  },
  {
    "text": "and sticking in the new query ID,",
    "start": "463080",
    "end": "466020"
  },
  {
    "text": "then I should get the new query ID here,",
    "start": "466020",
    "end": "468783"
  },
  {
    "text": "and if I click on that,",
    "start": "471030",
    "end": "472743"
  },
  {
    "text": "you will see the new plan\nin the query planning,",
    "start": "478410",
    "end": "480935"
  },
  {
    "text": "and while it bringing up the new plan,",
    "start": "480935",
    "end": "483206"
  },
  {
    "text": "you can notice that most of the time,",
    "start": "483206",
    "end": "485626"
  },
  {
    "text": "it's spent in compile\ntime and execution time,",
    "start": "485626",
    "end": "487987"
  },
  {
    "text": "and the overall time is just eight seconds",
    "start": "487987",
    "end": "490710"
  },
  {
    "text": "instead of 205 seconds.",
    "start": "490710",
    "end": "492990"
  },
  {
    "text": "Let's open there, and now\nturn on the view streams,",
    "start": "492990",
    "end": "497220"
  },
  {
    "text": "and you can notice that now,",
    "start": "497220",
    "end": "498380"
  },
  {
    "text": "the stream one has only four\nseconds, and if you go here,",
    "start": "498380",
    "end": "502920"
  },
  {
    "text": "instead of an nested\nloop, it is a hash join,",
    "start": "502920",
    "end": "505830"
  },
  {
    "text": "and it is pulling out 300 million records,",
    "start": "505830",
    "end": "508349"
  },
  {
    "text": "and the same amount of records",
    "start": "508350",
    "end": "509700"
  },
  {
    "text": "are coming out after the join,",
    "start": "509700",
    "end": "511290"
  },
  {
    "text": "so this is a quicker\nand easier way for you",
    "start": "511290",
    "end": "514328"
  },
  {
    "text": "to identify the bottleneck and fix them.",
    "start": "514329",
    "end": "518130"
  },
  {
    "text": "Now, let's see how you\ncan monitor query trends",
    "start": "518130",
    "end": "521130"
  },
  {
    "text": "over a period of time.",
    "start": "521130",
    "end": "522090"
  },
  {
    "text": "So to demonstrate that\nfeature, I'm taking a scenario",
    "start": "522090",
    "end": "526290"
  },
  {
    "text": "where I changed our compute capacity",
    "start": "526290",
    "end": "530459"
  },
  {
    "text": "of the serverless work group from 128.",
    "start": "530460",
    "end": "533610"
  },
  {
    "text": "If you look at this\ngraph, right around 11:30",
    "start": "533610",
    "end": "535727"
  },
  {
    "text": "and prior to line 11:30,\nit's all 128 RPUs.",
    "start": "535728",
    "end": "540728"
  },
  {
    "text": "There, I reached a state\nand lowered it to 64 RPUs,",
    "start": "540930",
    "end": "544710"
  },
  {
    "text": "so there is a compute capacity change",
    "start": "544710",
    "end": "547290"
  },
  {
    "text": "in the last six hours at around 11:45.",
    "start": "547290",
    "end": "551130"
  },
  {
    "text": "Let's see the effect\nof this on the queries",
    "start": "551130",
    "end": "554610"
  },
  {
    "text": "and also specific query,",
    "start": "554610",
    "end": "556110"
  },
  {
    "text": "how you can monitor the\ntrend over a period of time.",
    "start": "556110",
    "end": "559560"
  },
  {
    "text": "So if we go to queries\nand database monitoring",
    "start": "559560",
    "end": "562149"
  },
  {
    "text": "and then click on the work group",
    "start": "562149",
    "end": "565594"
  },
  {
    "text": "where I changed the compute capacity",
    "start": "565594",
    "end": "568130"
  },
  {
    "text": "and look at last six hours,",
    "start": "568130",
    "end": "570723"
  },
  {
    "text": "so this will show the trend overall.",
    "start": "573210",
    "end": "576060"
  },
  {
    "text": "So if you see, around the same timeframe",
    "start": "576060",
    "end": "577795"
  },
  {
    "text": "where I changed the compute capacity,",
    "start": "577795",
    "end": "579503"
  },
  {
    "text": "from after that time, the\nquery started taking longer",
    "start": "579503",
    "end": "583320"
  },
  {
    "text": "because I lowered the compute capacity",
    "start": "583320",
    "end": "585240"
  },
  {
    "text": "from 128 RPUs to 64 RPUs,\nso they're taking longer.",
    "start": "585240",
    "end": "590240"
  },
  {
    "text": "At a classical level,\nyou can see the trend",
    "start": "591720",
    "end": "595259"
  },
  {
    "text": "and we can also see for a specific one,",
    "start": "595260",
    "end": "598260"
  },
  {
    "text": "Let's say I'm taking one query,",
    "start": "598260",
    "end": "600069"
  },
  {
    "text": "and I'll put the query ID in\nthe query history and see,",
    "start": "600069",
    "end": "605069"
  },
  {
    "text": "how is the trend?",
    "start": "605627",
    "end": "606840"
  },
  {
    "text": "Let's take this query\nand see what's the trend",
    "start": "606840",
    "end": "609990"
  },
  {
    "text": "by clicking on view query\npattern for the last six hours,",
    "start": "609990",
    "end": "614490"
  },
  {
    "text": "so if you look at that, you\ncan monitor the specific query,",
    "start": "614490",
    "end": "619290"
  },
  {
    "text": "how it performed when the\ncompute capacity changed.",
    "start": "619290",
    "end": "621959"
  },
  {
    "text": "So prior to compute capacity\nchange, when it was 128 RPUs,",
    "start": "621960",
    "end": "626670"
  },
  {
    "text": "it was finishing around 72 seconds,",
    "start": "626670",
    "end": "629610"
  },
  {
    "text": "and after changing the compute capacity,",
    "start": "629610",
    "end": "631316"
  },
  {
    "text": "it started taking double the time.",
    "start": "631317",
    "end": "633363"
  },
  {
    "text": "With that, I conclude the\ndemo. Thanks for watching.",
    "start": "634230",
    "end": "637053"
  }
]