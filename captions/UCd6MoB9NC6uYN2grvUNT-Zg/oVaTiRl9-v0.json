[
  {
    "text": "aws Loft Talks my name is Alex Graham um",
    "start": "4480",
    "end": "8720"
  },
  {
    "text": "I'm a senior operations engineer at the",
    "start": "8720",
    "end": "10719"
  },
  {
    "text": "on the technical operations team at",
    "start": "10719",
    "end": "12360"
  },
  {
    "text": "Slack and I've been at Slack for a",
    "start": "12360",
    "end": "15519"
  },
  {
    "text": "little over a year and a half now and",
    "start": "15519",
    "end": "16800"
  },
  {
    "text": "I've watched our infrastructure grow",
    "start": "16800",
    "end": "18240"
  },
  {
    "text": "from hundreds of servers to thousands of",
    "start": "18240",
    "end": "19920"
  },
  {
    "text": "servers and it's it's really been an",
    "start": "19920",
    "end": "21520"
  },
  {
    "text": "amazing experience um so I'm sure",
    "start": "21520",
    "end": "24160"
  },
  {
    "text": "there's some of you in the audience who",
    "start": "24160",
    "end": "25119"
  },
  {
    "text": "are like what's this Slack thing that",
    "start": "25119",
    "end": "26960"
  },
  {
    "text": "everyone's talking about and Slack is a",
    "start": "26960",
    "end": "29439"
  },
  {
    "text": "messaging app for teams that integrates",
    "start": "29439",
    "end": "31199"
  },
  {
    "text": "with dozens of popular tools and",
    "start": "31199",
    "end": "32558"
  },
  {
    "text": "services tonight I'm going to talk a",
    "start": "32559",
    "end": "34480"
  },
  {
    "text": "little bit about a project that I worked",
    "start": "34480",
    "end": "35600"
  },
  {
    "text": "on at Slack where we're using CloudFront",
    "start": "35600",
    "end": "38000"
  },
  {
    "text": "to accelerate our API but it also gives",
    "start": "38000",
    "end": "40239"
  },
  {
    "text": "us the flexibility to apply some",
    "start": "40239",
    "end": "41760"
  },
  {
    "text": "security measures at the edge here's",
    "start": "41760",
    "end": "43200"
  },
  {
    "text": "what I'm going to go over um first I",
    "start": "43200",
    "end": "45280"
  },
  {
    "text": "just want to talk about just to give",
    "start": "45280",
    "end": "47280"
  },
  {
    "text": "give a general overview of the Slack API",
    "start": "47280",
    "end": "50000"
  },
  {
    "text": "um and I think this will help you",
    "start": "50000",
    "end": "51280"
  },
  {
    "text": "understand some of the reasons why we're",
    "start": "51280",
    "end": "53120"
  },
  {
    "text": "able to utilize the features of",
    "start": "53120",
    "end": "54399"
  },
  {
    "text": "CloudFront the next thing I'll talk",
    "start": "54399",
    "end": "56719"
  },
  {
    "text": "about is just some of the features that",
    "start": "56719",
    "end": "58399"
  },
  {
    "text": "made us interested in CloudFront then",
    "start": "58399",
    "end": "60399"
  },
  {
    "text": "I'm going to go into a kind of a",
    "start": "60399",
    "end": "61840"
  },
  {
    "text": "technical explanation on how we actually",
    "start": "61840",
    "end": "63760"
  },
  {
    "text": "migrated our traffic from a single ELB",
    "start": "63760",
    "end": "66479"
  },
  {
    "text": "over to",
    "start": "66479",
    "end": "67880"
  },
  {
    "text": "CloudFront and uh the next thing I want",
    "start": "67880",
    "end": "70720"
  },
  {
    "text": "to go into is just talk about some of",
    "start": "70720",
    "end": "72479"
  },
  {
    "text": "the performance benefits that we saw",
    "start": "72479",
    "end": "74000"
  },
  {
    "text": "after rolling out CloudFront and then",
    "start": "74000",
    "end": "76159"
  },
  {
    "text": "the last thing I'll cover is just a few",
    "start": "76159",
    "end": "78960"
  },
  {
    "text": "of the things that we have planned as we",
    "start": "78960",
    "end": "81200"
  },
  {
    "text": "continue to develop on the CloudFront",
    "start": "81200",
    "end": "82640"
  },
  {
    "text": "platform as I promised before I dive",
    "start": "82640",
    "end": "84320"
  },
  {
    "text": "into the CloudFront portion I just want",
    "start": "84320",
    "end": "85840"
  },
  {
    "text": "to give a brief overview of our API",
    "start": "85840",
    "end": "88240"
  },
  {
    "text": "here's some some examples of our web API",
    "start": "88240",
    "end": "91520"
  },
  {
    "text": "and it's what people think of as a more",
    "start": "91520",
    "end": "93439"
  },
  {
    "text": "traditional API and responses are or",
    "start": "93439",
    "end": "96799"
  },
  {
    "text": "requests are made as get or post",
    "start": "96799",
    "end": "99600"
  },
  {
    "text": "requests and all the responses come back",
    "start": "99600",
    "end": "102000"
  },
  {
    "text": "as a JSON object um so many people have",
    "start": "102000",
    "end": "105119"
  },
  {
    "text": "written integrations to that utilize",
    "start": "105119",
    "end": "107360"
  },
  {
    "text": "this API however all of the official",
    "start": "107360",
    "end": "109759"
  },
  {
    "text": "Slack clients including our web client",
    "start": "109759",
    "end": "111840"
  },
  {
    "text": "are also using this API under the hood",
    "start": "111840",
    "end": "113680"
  },
  {
    "text": "so that might not be something that",
    "start": "113680",
    "end": "114880"
  },
  {
    "text": "you're aware of here's just a few",
    "start": "114880",
    "end": "116399"
  },
  {
    "text": "examples of the Slack API being used in",
    "start": "116399",
    "end": "118880"
  },
  {
    "text": "real world scenarios so in this first",
    "start": "118880",
    "end": "121439"
  },
  {
    "text": "example we're using the search.all API",
    "start": "121439",
    "end": "124079"
  },
  {
    "text": "method and what we're searching for is",
    "start": "124079",
    "end": "126000"
  },
  {
    "text": "just a list of all the messages that",
    "start": "126000",
    "end": "129119"
  },
  {
    "text": "contain the string hello so what we'd",
    "start": "129119",
    "end": "131440"
  },
  {
    "text": "get back here is just a JSON formatted",
    "start": "131440",
    "end": "133599"
  },
  {
    "text": "response that contains a list of our",
    "start": "133599",
    "end": "136319"
  },
  {
    "text": "search results",
    "start": "136319",
    "end": "138319"
  },
  {
    "text": "and in the second example we're asking",
    "start": "138319",
    "end": "140400"
  },
  {
    "text": "for a list of all channels and all the",
    "start": "140400",
    "end": "142800"
  },
  {
    "text": "members that belong to those channels",
    "start": "142800",
    "end": "144160"
  },
  {
    "text": "using the channels.list method and we'll",
    "start": "144160",
    "end": "147760"
  },
  {
    "text": "also get a JSON format a response back",
    "start": "147760",
    "end": "149720"
  },
  {
    "text": "here and then the last example is just",
    "start": "149720",
    "end": "152480"
  },
  {
    "text": "using our channels.create API method and",
    "start": "152480",
    "end": "155360"
  },
  {
    "text": "with that we'll just get back a response",
    "start": "155360",
    "end": "156959"
  },
  {
    "text": "that says if it completed successfully",
    "start": "156959",
    "end": "158560"
  },
  {
    "text": "or not and that we're creating a channel",
    "start": "158560",
    "end": "160160"
  },
  {
    "text": "called test there so as you look at some",
    "start": "160160",
    "end": "162239"
  },
  {
    "text": "of these API requests you can see as",
    "start": "162239",
    "end": "164959"
  },
  {
    "text": "somebody browses around the Slack client",
    "start": "164959",
    "end": "166640"
  },
  {
    "text": "you can see how quickly those API",
    "start": "166640",
    "end": "167840"
  },
  {
    "text": "requests might add up and this is why we",
    "start": "167840",
    "end": "170480"
  },
  {
    "text": "need to make sure that we're delivering",
    "start": "170480",
    "end": "171440"
  },
  {
    "text": "those as fast as possible so here's just",
    "start": "171440",
    "end": "173360"
  },
  {
    "text": "some stats on our API um Slack currently",
    "start": "173360",
    "end": "176319"
  },
  {
    "text": "has about 3 million daily active users",
    "start": "176319",
    "end": "179040"
  },
  {
    "text": "and we're handling about 1.5 billion",
    "start": "179040",
    "end": "181840"
  },
  {
    "text": "requests per day to our frontends and",
    "start": "181840",
    "end": "184640"
  },
  {
    "text": "just over 50% of those requests are API",
    "start": "184640",
    "end": "187040"
  },
  {
    "text": "requests let's talk a little bit about",
    "start": "187040",
    "end": "188400"
  },
  {
    "text": "why we ended up deciding on CloudFront",
    "start": "188400",
    "end": "190720"
  },
  {
    "text": "there's a lot of CDNs out there and we",
    "start": "190720",
    "end": "192560"
  },
  {
    "text": "tested a few of them before we actually",
    "start": "192560",
    "end": "194640"
  },
  {
    "text": "decided to go with CloudFront these are",
    "start": "194640",
    "end": "196239"
  },
  {
    "text": "just some of the benefits that we get",
    "start": "196239",
    "end": "197360"
  },
  {
    "text": "with CloudFront the project originally",
    "start": "197360",
    "end": "199040"
  },
  {
    "text": "started off as us looking for an",
    "start": "199040",
    "end": "201280"
  },
  {
    "text": "ondemand DOS mitigation provider and",
    "start": "201280",
    "end": "204000"
  },
  {
    "text": "when I started looking into this I I",
    "start": "204000",
    "end": "206159"
  },
  {
    "text": "realized that there was a trend that",
    "start": "206159",
    "end": "207360"
  },
  {
    "text": "appeared most of these ondemand DOS",
    "start": "207360",
    "end": "209599"
  },
  {
    "text": "mitigation providers were were basically",
    "start": "209599",
    "end": "211280"
  },
  {
    "text": "just CDNs and they were applying some",
    "start": "211280",
    "end": "213440"
  },
  {
    "text": "filtering at the edge to filter out the",
    "start": "213440",
    "end": "214959"
  },
  {
    "text": "malicious traffic um so I was put into",
    "start": "214959",
    "end": "219360"
  },
  {
    "text": "contact with Nate at AWS and he let me",
    "start": "219360",
    "end": "222239"
  },
  {
    "text": "know that CloudFront was just already",
    "start": "222239",
    "end": "224319"
  },
  {
    "text": "doing a lot of these things",
    "start": "224319",
    "end": "225560"
  },
  {
    "text": "automatically and we could probably just",
    "start": "225560",
    "end": "228400"
  },
  {
    "text": "leave it enabled all the time and we'd",
    "start": "228400",
    "end": "229760"
  },
  {
    "text": "see we'd probably see a performance",
    "start": "229760",
    "end": "230959"
  },
  {
    "text": "benefit so we kind of the best of all",
    "start": "230959",
    "end": "233280"
  },
  {
    "text": "worlds these are the reasons why we",
    "start": "233280",
    "end": "235040"
  },
  {
    "text": "actually ended up going with CloudFront",
    "start": "235040",
    "end": "236959"
  },
  {
    "text": "uh I really like that CloudFront could",
    "start": "236959",
    "end": "238720"
  },
  {
    "text": "be fully customized and we could",
    "start": "238720",
    "end": "240159"
  },
  {
    "text": "continue using our own Slack branded",
    "start": "240159",
    "end": "242239"
  },
  {
    "text": "error pages we tested a few providers",
    "start": "242239",
    "end": "244319"
  },
  {
    "text": "and we what we did is we compared",
    "start": "244319",
    "end": "245920"
  },
  {
    "text": "performance and reliability over about a",
    "start": "245920",
    "end": "248080"
  },
  {
    "text": "month and CloudFront beat out the other",
    "start": "248080",
    "end": "249920"
  },
  {
    "text": "providers there um and reliability was",
    "start": "249920",
    "end": "253519"
  },
  {
    "text": "like probably one of the most important",
    "start": "253519",
    "end": "255280"
  },
  {
    "text": "things here we're putting a lot of trust",
    "start": "255280",
    "end": "257359"
  },
  {
    "text": "in whatever provider we choose here if",
    "start": "257359",
    "end": "259199"
  },
  {
    "text": "for some reason that provider has any",
    "start": "259199",
    "end": "261040"
  },
  {
    "text": "sort of issue that means our API is",
    "start": "261040",
    "end": "262880"
  },
  {
    "text": "going to have problems too so we need to",
    "start": "262880",
    "end": "264800"
  },
  {
    "text": "make sure this is highly",
    "start": "264800",
    "end": "266199"
  },
  {
    "text": "available um the next thing was just",
    "start": "266199",
    "end": "268800"
  },
  {
    "text": "that CloudFront paired nicely with some",
    "start": "268800",
    "end": "270560"
  },
  {
    "text": "of the existing technologies we already",
    "start": "270560",
    "end": "272080"
  },
  {
    "text": "using so ELB and S3 and this made the",
    "start": "272080",
    "end": "276080"
  },
  {
    "text": "migration from ELB to CloudFront",
    "start": "276080",
    "end": "278160"
  },
  {
    "text": "relatively easy let's talk a little bit",
    "start": "278160",
    "end": "279680"
  },
  {
    "text": "about how we did that migration um this",
    "start": "279680",
    "end": "282080"
  },
  {
    "text": "was not or this was a this can be a",
    "start": "282080",
    "end": "285199"
  },
  {
    "text": "little bit of a difficult change to roll",
    "start": "285199",
    "end": "286639"
  },
  {
    "text": "out but with using some Route 53 and DNS",
    "start": "286639",
    "end": "290160"
  },
  {
    "text": "magic we were able to pull it off so I",
    "start": "290160",
    "end": "292000"
  },
  {
    "text": "just want to take a look at the",
    "start": "292000",
    "end": "293600"
  },
  {
    "text": "configuration we have on our CloudFront",
    "start": "293600",
    "end": "295120"
  },
  {
    "text": "distribution right now um caching is",
    "start": "295120",
    "end": "297840"
  },
  {
    "text": "totally disabled there's nothing you can",
    "start": "297840",
    "end": "300000"
  },
  {
    "text": "really cache on on our API everything is",
    "start": "300000",
    "end": "303120"
  },
  {
    "text": "dynamically generated and all nothing's",
    "start": "303120",
    "end": "305840"
  },
  {
    "text": "really shared between clients we also",
    "start": "305840",
    "end": "308160"
  },
  {
    "text": "forward everything back to the origin so",
    "start": "308160",
    "end": "310880"
  },
  {
    "text": "all headers cookies query strings etc",
    "start": "310880",
    "end": "313680"
  },
  {
    "text": "all forwarded back to the origin ELB and",
    "start": "313680",
    "end": "316400"
  },
  {
    "text": "then the last thing we have set up is",
    "start": "316400",
    "end": "317919"
  },
  {
    "text": "just an S3 bucket which contains several",
    "start": "317919",
    "end": "320479"
  },
  {
    "text": "HTML static HTML error pages and what",
    "start": "320479",
    "end": "324000"
  },
  {
    "text": "this allows us to do is if for some",
    "start": "324000",
    "end": "326479"
  },
  {
    "text": "reason the origin ELB is not responding",
    "start": "326479",
    "end": "329360"
  },
  {
    "text": "we're we're still going to display a",
    "start": "329360",
    "end": "331039"
  },
  {
    "text": "custom formatted error page and we hope",
    "start": "331039",
    "end": "332960"
  },
  {
    "text": "this won't happen too often because if",
    "start": "332960",
    "end": "335039"
  },
  {
    "text": "that's happening it means there's a",
    "start": "335039",
    "end": "336479"
  },
  {
    "text": "problem and somebody on my team is",
    "start": "336479",
    "end": "338080"
  },
  {
    "text": "probably up troubleshooting it this is",
    "start": "338080",
    "end": "339840"
  },
  {
    "text": "what we had before we actually moved to",
    "start": "339840",
    "end": "341759"
  },
  {
    "text": "CloudFront so it's just it's a pretty",
    "start": "341759",
    "end": "343840"
  },
  {
    "text": "standard setup we have slack.com",
    "start": "343840",
    "end": "346720"
  },
  {
    "text": "pointing to a route 53 alias and then",
    "start": "346720",
    "end": "349600"
  },
  {
    "text": "that points to a load elastic load",
    "start": "349600",
    "end": "351680"
  },
  {
    "text": "balancer and then we just have a pool of",
    "start": "351680",
    "end": "352880"
  },
  {
    "text": "EC2 instances behind that so I'm sure",
    "start": "352880",
    "end": "354960"
  },
  {
    "text": "there's a few of you out there who are",
    "start": "354960",
    "end": "356240"
  },
  {
    "text": "pretty familiar with this setup it's a",
    "start": "356240",
    "end": "358080"
  },
  {
    "text": "pretty common setup um and what we",
    "start": "358080",
    "end": "361199"
  },
  {
    "text": "wanted to do is just figure out a way",
    "start": "361199",
    "end": "363600"
  },
  {
    "text": "that we could move that traffic over",
    "start": "363600",
    "end": "366800"
  },
  {
    "text": "slowly like we didn't want to just flip",
    "start": "366800",
    "end": "369039"
  },
  {
    "text": "CloudFront on for everyone and hope for",
    "start": "369039",
    "end": "370880"
  },
  {
    "text": "the best um so what we did is we",
    "start": "370880",
    "end": "373120"
  },
  {
    "text": "actually we wanted to come up with a way",
    "start": "373120",
    "end": "374800"
  },
  {
    "text": "to kind of feature flag it on but our",
    "start": "374800",
    "end": "377520"
  },
  {
    "text": "typical pattern is to apply a feature",
    "start": "377520",
    "end": "379759"
  },
  {
    "text": "flag inside of the code and then either",
    "start": "379759",
    "end": "382080"
  },
  {
    "text": "enable that for some teams or enable",
    "start": "382080",
    "end": "383680"
  },
  {
    "text": "that for some percentage of users and we",
    "start": "383680",
    "end": "385440"
  },
  {
    "text": "couldn't really do that here because",
    "start": "385440",
    "end": "386479"
  },
  {
    "text": "it's such a drastic infrastructure",
    "start": "386479",
    "end": "387919"
  },
  {
    "text": "change so what we had to do is do this",
    "start": "387919",
    "end": "390319"
  },
  {
    "text": "apply this at the DNS level what we're",
    "start": "390319",
    "end": "392240"
  },
  {
    "text": "able to use is the weighted roundroin",
    "start": "392240",
    "end": "394400"
  },
  {
    "text": "feature of Route 53 and what we did is",
    "start": "394400",
    "end": "397280"
  },
  {
    "text": "we set slack.com to point to two records",
    "start": "397280",
    "end": "400960"
  },
  {
    "text": "and for one of those records we pointed",
    "start": "400960",
    "end": "402880"
  },
  {
    "text": "it at CloudFront and for the other we",
    "start": "402880",
    "end": "404560"
  },
  {
    "text": "pointed it directly at the ELB so in",
    "start": "404560",
    "end": "406720"
  },
  {
    "text": "this example we have a one record",
    "start": "406720",
    "end": "409600"
  },
  {
    "text": "pointing at the ELB which has a weight",
    "start": "409600",
    "end": "411039"
  },
  {
    "text": "of 99 and then we have the second record",
    "start": "411039",
    "end": "413680"
  },
  {
    "text": "pointing at CloudFront which just has a",
    "start": "413680",
    "end": "415199"
  },
  {
    "text": "weight of one so what will happen here",
    "start": "415199",
    "end": "417440"
  },
  {
    "text": "is one in every 100 requests will be",
    "start": "417440",
    "end": "420080"
  },
  {
    "text": "sent through CloudFront and then 99 in",
    "start": "420080",
    "end": "422880"
  },
  {
    "text": "every 100 requests will remain on the",
    "start": "422880",
    "end": "424240"
  },
  {
    "text": "ELB so what we did is we just continued",
    "start": "424240",
    "end": "427039"
  },
  {
    "text": "incrementing these values while",
    "start": "427039",
    "end": "429039"
  },
  {
    "text": "monitoring the graphs and having a few",
    "start": "429039",
    "end": "431039"
  },
  {
    "text": "drinks of course and we eventually ended",
    "start": "431039",
    "end": "433840"
  },
  {
    "text": "up at a point where we had 100% of our",
    "start": "433840",
    "end": "435599"
  },
  {
    "text": "traffic migrated over to CloudFront this",
    "start": "435599",
    "end": "437680"
  },
  {
    "text": "is the end result of our CloudFront",
    "start": "437680",
    "end": "438880"
  },
  {
    "text": "rollout and this is the stack that's",
    "start": "438880",
    "end": "440319"
  },
  {
    "text": "powering Slack today well we just we",
    "start": "440319",
    "end": "442639"
  },
  {
    "text": "have a route 53 alias for sack.com which",
    "start": "442639",
    "end": "445759"
  },
  {
    "text": "points to cloudfront and then we're",
    "start": "445759",
    "end": "447919"
  },
  {
    "text": "forwarding across the AWS network",
    "start": "447919",
    "end": "449599"
  },
  {
    "text": "backbone to our ELB in the US East1",
    "start": "449599",
    "end": "452240"
  },
  {
    "text": "region where we have a bunch of EC2",
    "start": "452240",
    "end": "454000"
  },
  {
    "text": "instances behind it i want to talk a",
    "start": "454000",
    "end": "455599"
  },
  {
    "text": "little bit about the performance metrics",
    "start": "455599",
    "end": "457039"
  },
  {
    "text": "we collected and we we used a tool",
    "start": "457039",
    "end": "459840"
  },
  {
    "text": "called Thousandize um and what that is",
    "start": "459840",
    "end": "462400"
  },
  {
    "text": "is it's mainly designed to be an always",
    "start": "462400",
    "end": "464639"
  },
  {
    "text": "on constant monitor for your application",
    "start": "464639",
    "end": "467599"
  },
  {
    "text": "and we kind of used it in a little bit",
    "start": "467599",
    "end": "468960"
  },
  {
    "text": "of a different way here because CDNs are",
    "start": "468960",
    "end": "471440"
  },
  {
    "text": "a little bit tricky to benchmark there's",
    "start": "471440",
    "end": "473120"
  },
  {
    "text": "there's a lot of factors that come into",
    "start": "473120",
    "end": "474800"
  },
  {
    "text": "play and my main goal here was just to",
    "start": "474800",
    "end": "477599"
  },
  {
    "text": "make sure that performance was not",
    "start": "477599",
    "end": "479280"
  },
  {
    "text": "decreased by adding extra hop because",
    "start": "479280",
    "end": "481360"
  },
  {
    "text": "most people probably assume that you're",
    "start": "481360",
    "end": "483360"
  },
  {
    "text": "just adding an extra hop to the to the",
    "start": "483360",
    "end": "485360"
  },
  {
    "text": "whole request that's probably going to",
    "start": "485360",
    "end": "487039"
  },
  {
    "text": "decrease performance but we actually",
    "start": "487039",
    "end": "488639"
  },
  {
    "text": "found that that wasn't the case this is",
    "start": "488639",
    "end": "490400"
  },
  {
    "text": "just a graph of the network latency from",
    "start": "490400",
    "end": "493120"
  },
  {
    "text": "about 200 locations around the world and",
    "start": "493120",
    "end": "495599"
  },
  {
    "text": "at the top of the graph here that's",
    "start": "495599",
    "end": "497599"
  },
  {
    "text": "where we were actually on we're all",
    "start": "497599",
    "end": "499599"
  },
  {
    "text": "requests were going directly back to the",
    "start": "499599",
    "end": "501479"
  },
  {
    "text": "ELB and as it starts to ramp down here",
    "start": "501479",
    "end": "504240"
  },
  {
    "text": "that's where we started the roll out so",
    "start": "504240",
    "end": "506240"
  },
  {
    "text": "you can see that towards the top of the",
    "start": "506240",
    "end": "507919"
  },
  {
    "text": "graph we at about 90 milliseconds of",
    "start": "507919",
    "end": "510240"
  },
  {
    "text": "latency this is average about from 200",
    "start": "510240",
    "end": "513039"
  },
  {
    "text": "locations around the world and then",
    "start": "513039",
    "end": "514640"
  },
  {
    "text": "towards the bottom of the graph we ended",
    "start": "514640",
    "end": "516080"
  },
  {
    "text": "up at about 15 milliseconds of latency",
    "start": "516080",
    "end": "518560"
  },
  {
    "text": "and this is just latency to slack.com so",
    "start": "518560",
    "end": "521120"
  },
  {
    "text": "it's basically a ping to slack.com so",
    "start": "521120",
    "end": "523599"
  },
  {
    "text": "now it makes sense that we saw this",
    "start": "523599",
    "end": "525120"
  },
  {
    "text": "because now we're on CloudFront at the",
    "start": "525120",
    "end": "527120"
  },
  {
    "text": "edge and all of those distributed nodes",
    "start": "527120",
    "end": "530480"
  },
  {
    "text": "means that they're not the client does",
    "start": "530480",
    "end": "532000"
  },
  {
    "text": "not have to make many hops before it",
    "start": "532000",
    "end": "533360"
  },
  {
    "text": "hits this this graph while it may not",
    "start": "533360",
    "end": "535120"
  },
  {
    "text": "look as exciting it's actually this is",
    "start": "535120",
    "end": "536959"
  },
  {
    "text": "more exciting to me um so what we saw",
    "start": "536959",
    "end": "539279"
  },
  {
    "text": "here was that the average response time",
    "start": "539279",
    "end": "541920"
  },
  {
    "text": "for a simple endpoint on the Slack API",
    "start": "541920",
    "end": "545200"
  },
  {
    "text": "dropped from about 480 milliseconds down",
    "start": "545200",
    "end": "548240"
  },
  {
    "text": "to about 200 milliseconds and this graph",
    "start": "548240",
    "end": "551440"
  },
  {
    "text": "is it's scaled a little bit differently",
    "start": "551440",
    "end": "552880"
  },
  {
    "text": "but we started the roll out somewhere",
    "start": "552880",
    "end": "554640"
  },
  {
    "text": "around here and then towards the end of",
    "start": "554640",
    "end": "556560"
  },
  {
    "text": "the roll it's down here and it doesn't",
    "start": "556560",
    "end": "558399"
  },
  {
    "text": "look as impressive but up at the top we",
    "start": "558399",
    "end": "560640"
  },
  {
    "text": "have 480 milliseconds and then down at",
    "start": "560640",
    "end": "562640"
  },
  {
    "text": "the bottom is 45 milliseconds so it's a",
    "start": "562640",
    "end": "565519"
  },
  {
    "text": "it's a pretty it's a pretty major jump",
    "start": "565519",
    "end": "568160"
  },
  {
    "text": "um and what we noticed here was that",
    "start": "568160",
    "end": "570000"
  },
  {
    "text": "some of the largest improvements came",
    "start": "570000",
    "end": "571680"
  },
  {
    "text": "from clients who were located",
    "start": "571680",
    "end": "573279"
  },
  {
    "text": "geographically far away from US East1",
    "start": "573279",
    "end": "575279"
  },
  {
    "text": "such as India China and Australia in",
    "start": "575279",
    "end": "578880"
  },
  {
    "text": "these graphs we're taking that same",
    "start": "578880",
    "end": "580399"
  },
  {
    "text": "average response time and we're just",
    "start": "580399",
    "end": "581760"
  },
  {
    "text": "breaking it down by the various phases",
    "start": "581760",
    "end": "583279"
  },
  {
    "text": "of the connection so what we saw here",
    "start": "583279",
    "end": "585760"
  },
  {
    "text": "was that um the SSL uh the SSL setup",
    "start": "585760",
    "end": "589920"
  },
  {
    "text": "time was drastically um affected that's",
    "start": "589920",
    "end": "593760"
  },
  {
    "text": "because we moved that HTTPS termination",
    "start": "593760",
    "end": "595760"
  },
  {
    "text": "much closer to the client so we're now",
    "start": "595760",
    "end": "597920"
  },
  {
    "text": "able to avoid those long round trips as",
    "start": "597920",
    "end": "599920"
  },
  {
    "text": "the client establishes the SSL session",
    "start": "599920",
    "end": "602720"
  },
  {
    "text": "um we're still using HTTPS from",
    "start": "602720",
    "end": "606240"
  },
  {
    "text": "CloudFront to the ELB but thanks to",
    "start": "606240",
    "end": "608480"
  },
  {
    "text": "connection pooling we're not",
    "start": "608480",
    "end": "609519"
  },
  {
    "text": "reestablishing that session for every",
    "start": "609519",
    "end": "611360"
  },
  {
    "text": "request so we there's it's kind of a",
    "start": "611360",
    "end": "614800"
  },
  {
    "text": "free connection at that point we can",
    "start": "614800",
    "end": "616800"
  },
  {
    "text": "also see that the overall response time",
    "start": "616800",
    "end": "619600"
  },
  {
    "text": "for this API endpoint dropped from about",
    "start": "619600",
    "end": "621680"
  },
  {
    "text": "488 milliseconds down to 199",
    "start": "621680",
    "end": "624399"
  },
  {
    "text": "milliseconds so while SSL was a huge",
    "start": "624399",
    "end": "627680"
  },
  {
    "text": "portion of that we still saw a little",
    "start": "627680",
    "end": "629839"
  },
  {
    "text": "bit of benefits from going across the",
    "start": "629839",
    "end": "632000"
  },
  {
    "text": "AWS network backbone and things like",
    "start": "632000",
    "end": "634320"
  },
  {
    "text": "that so while this weight time might",
    "start": "634320",
    "end": "636959"
  },
  {
    "text": "look like a big piece of the pie it's",
    "start": "636959",
    "end": "639279"
  },
  {
    "text": "just because this whole pie only",
    "start": "639279",
    "end": "640880"
  },
  {
    "text": "represents 199 milliseconds slack was",
    "start": "640880",
    "end": "643519"
  },
  {
    "text": "now about 300 milliseconds faster all",
    "start": "643519",
    "end": "645600"
  },
  {
    "text": "around the world and people were really",
    "start": "645600",
    "end": "647279"
  },
  {
    "text": "excited about this including one of our",
    "start": "647279",
    "end": "648880"
  },
  {
    "text": "founders who threatened to kiss me to",
    "start": "648880",
    "end": "650560"
  },
  {
    "text": "death these are just some of the direct",
    "start": "650560",
    "end": "652560"
  },
  {
    "text": "benefits that we saw after rolling out",
    "start": "652560",
    "end": "654519"
  },
  {
    "text": "CloudFront i'm sure many of you are",
    "start": "654519",
    "end": "656480"
  },
  {
    "text": "aware there's been a ton of public",
    "start": "656480",
    "end": "658240"
  },
  {
    "text": "internet outages lately um and there was",
    "start": "658240",
    "end": "660640"
  },
  {
    "text": "actually just one the other day on",
    "start": "660640",
    "end": "662079"
  },
  {
    "text": "Monday and by using CloudFront kind of",
    "start": "662079",
    "end": "664959"
  },
  {
    "text": "like a distributed load balancer and",
    "start": "664959",
    "end": "666959"
  },
  {
    "text": "getting that endpoint closer to the",
    "start": "666959",
    "end": "668560"
  },
  {
    "text": "clients we're able to avoid some of",
    "start": "668560",
    "end": "670560"
  },
  {
    "text": "those internet outages which is really",
    "start": "670560",
    "end": "672760"
  },
  {
    "text": "nice every hop that a client needs to",
    "start": "672760",
    "end": "675440"
  },
  {
    "text": "make through the public internet is kind",
    "start": "675440",
    "end": "677920"
  },
  {
    "text": "of just a it's a place for something to",
    "start": "677920",
    "end": "680399"
  },
  {
    "text": "go wrong so the quicker we can get those",
    "start": "680399",
    "end": "682560"
  },
  {
    "text": "clients onto the AWS network the better",
    "start": "682560",
    "end": "685040"
  },
  {
    "text": "off we're going to be in most",
    "start": "685040",
    "end": "687000"
  },
  {
    "text": "cases the other really cool thing is",
    "start": "687000",
    "end": "689120"
  },
  {
    "text": "that Slack really does load more quickly",
    "start": "689120",
    "end": "691120"
  },
  {
    "text": "all around the world we we saw in the",
    "start": "691120",
    "end": "693600"
  },
  {
    "text": "previous graph we dropped by about 300",
    "start": "693600",
    "end": "696079"
  },
  {
    "text": "milliseconds which was huge and now any",
    "start": "696079",
    "end": "699519"
  },
  {
    "text": "API request or any cl anything the",
    "start": "699519",
    "end": "702320"
  },
  {
    "text": "client was doing that was waiting on an",
    "start": "702320",
    "end": "703680"
  },
  {
    "text": "API request now completes much more",
    "start": "703680",
    "end": "705680"
  },
  {
    "text": "quickly and you're you're able to see",
    "start": "705680",
    "end": "707839"
  },
  {
    "text": "those results when you're like browsing",
    "start": "707839",
    "end": "709279"
  },
  {
    "text": "around",
    "start": "709279",
    "end": "710120"
  },
  {
    "text": "Slack my favorite part is that we don't",
    "start": "710120",
    "end": "712800"
  },
  {
    "text": "need to worry about enabling DOS",
    "start": "712800",
    "end": "714160"
  },
  {
    "text": "protection if we experience an attack it",
    "start": "714160",
    "end": "716880"
  },
  {
    "text": "will CloudFront will automatically scale",
    "start": "716880",
    "end": "718880"
  },
  {
    "text": "and it will automatically handle the",
    "start": "718880",
    "end": "721079"
  },
  {
    "text": "attack this is this is great news for me",
    "start": "721079",
    "end": "723519"
  },
  {
    "text": "because this was the main goal of the",
    "start": "723519",
    "end": "725040"
  },
  {
    "text": "whole project and the performance",
    "start": "725040",
    "end": "726800"
  },
  {
    "text": "benefits were just like the icing on the",
    "start": "726800",
    "end": "728160"
  },
  {
    "text": "cake as I promised I want to talk a",
    "start": "728160",
    "end": "729680"
  },
  {
    "text": "little bit about our future plans we're",
    "start": "729680",
    "end": "731519"
  },
  {
    "text": "really just scratching the surface of",
    "start": "731519",
    "end": "732880"
  },
  {
    "text": "what can be done with CloudFront and we",
    "start": "732880",
    "end": "734720"
  },
  {
    "text": "have a lot of plans in mind as we",
    "start": "734720",
    "end": "736320"
  },
  {
    "text": "continue to develop on the platform rate",
    "start": "736320",
    "end": "738399"
  },
  {
    "text": "limiting so rate limiting is huge since",
    "start": "738399",
    "end": "741360"
  },
  {
    "text": "a large majority of our traffic at Slack",
    "start": "741360",
    "end": "743440"
  },
  {
    "text": "is API calls we have a pretty massive",
    "start": "743440",
    "end": "745600"
  },
  {
    "text": "rate limiting infrastructure and what we",
    "start": "745600",
    "end": "748160"
  },
  {
    "text": "do right now is we have different rate",
    "start": "748160",
    "end": "750160"
  },
  {
    "text": "limits that are applied including per",
    "start": "750160",
    "end": "751839"
  },
  {
    "text": "user per team and even per IP rate",
    "start": "751839",
    "end": "754440"
  },
  {
    "text": "limits and the way we handle these is",
    "start": "754440",
    "end": "756800"
  },
  {
    "text": "just by incrementing counters in",
    "start": "756800",
    "end": "758079"
  },
  {
    "text": "memcache so as our traffic grows we also",
    "start": "758079",
    "end": "761120"
  },
  {
    "text": "need to grow those memcache clusters so",
    "start": "761120",
    "end": "763120"
  },
  {
    "text": "it's it's a little bit of work and what",
    "start": "763120",
    "end": "766160"
  },
  {
    "text": "we can do is like we can take these rate",
    "start": "766160",
    "end": "768399"
  },
  {
    "text": "limits and if we can push them out to",
    "start": "768399",
    "end": "769839"
  },
  {
    "text": "the edge that's less infrastructure that",
    "start": "769839",
    "end": "771600"
  },
  {
    "text": "we have to maintain and less less",
    "start": "771600",
    "end": "774880"
  },
  {
    "text": "resources we're spending on dealing with",
    "start": "774880",
    "end": "776480"
  },
  {
    "text": "those requests that we probably don't",
    "start": "776480",
    "end": "777920"
  },
  {
    "text": "even care",
    "start": "777920",
    "end": "779000"
  },
  {
    "text": "about so the next thing is",
    "start": "779000",
    "end": "781519"
  },
  {
    "text": "unauthenticated requests and these are a",
    "start": "781519",
    "end": "784240"
  },
  {
    "text": "little bit tough to deal with mainly",
    "start": "784240",
    "end": "785680"
  },
  {
    "text": "because the only information you really",
    "start": "785680",
    "end": "787600"
  },
  {
    "text": "have is whatever comes in on the header",
    "start": "787600",
    "end": "789040"
  },
  {
    "text": "of the request so typically these sort",
    "start": "789040",
    "end": "791360"
  },
  {
    "text": "of rate limits are IP based and",
    "start": "791360",
    "end": "795279"
  },
  {
    "text": "attackers know that unauthenticated",
    "start": "795279",
    "end": "797519"
  },
  {
    "text": "requests are probably one of the tougher",
    "start": "797519",
    "end": "799040"
  },
  {
    "text": "things to deal with so typically when a",
    "start": "799040",
    "end": "800560"
  },
  {
    "text": "DOS attack happens it's going to be",
    "start": "800560",
    "end": "802240"
  },
  {
    "text": "against some unauthenticated part of",
    "start": "802240",
    "end": "803920"
  },
  {
    "text": "your infrastructure by blocking these at",
    "start": "803920",
    "end": "806160"
  },
  {
    "text": "the edge there's much less of a risk",
    "start": "806160",
    "end": "807920"
  },
  {
    "text": "that an attack might be able to take our",
    "start": "807920",
    "end": "810160"
  },
  {
    "text": "infrastructure",
    "start": "810160",
    "end": "811720"
  },
  {
    "text": "offline um the next as we work to roll",
    "start": "811720",
    "end": "814959"
  },
  {
    "text": "out these changes we want to make sure",
    "start": "814959",
    "end": "816240"
  },
  {
    "text": "that we know when these limits are being",
    "start": "816240",
    "end": "817920"
  },
  {
    "text": "hit so by alerting and building",
    "start": "817920",
    "end": "819920"
  },
  {
    "text": "dashboards and posting this information",
    "start": "819920",
    "end": "821600"
  },
  {
    "text": "to Slack we'll be able to keep an eye on",
    "start": "821600",
    "end": "823600"
  },
  {
    "text": "things and know at a high level what's",
    "start": "823600",
    "end": "825600"
  },
  {
    "text": "going on the other really neat thing",
    "start": "825600",
    "end": "827120"
  },
  {
    "text": "that we'll be able to do is block",
    "start": "827120",
    "end": "828560"
  },
  {
    "text": "malicious traffic right at the edge so",
    "start": "828560",
    "end": "830800"
  },
  {
    "text": "if someone does decide to attack Slack",
    "start": "830800",
    "end": "832720"
  },
  {
    "text": "with a high layer DOS attack what we can",
    "start": "832720",
    "end": "834959"
  },
  {
    "text": "do is we can apply WFT rules to just",
    "start": "834959",
    "end": "837040"
  },
  {
    "text": "block that malicious traffic and drop it",
    "start": "837040",
    "end": "838639"
  },
  {
    "text": "right at the edge that buys us some time",
    "start": "838639",
    "end": "840560"
  },
  {
    "text": "and allows us to figure out what we're",
    "start": "840560",
    "end": "843760"
  },
  {
    "text": "going to do about this attack um and by",
    "start": "843760",
    "end": "846320"
  },
  {
    "text": "combining AWS WFT with Lambda we also we",
    "start": "846320",
    "end": "848800"
  },
  {
    "text": "open up a whole new box of possibilities",
    "start": "848800",
    "end": "850480"
  },
  {
    "text": "there um we might start blocking traffic",
    "start": "850480",
    "end": "852720"
  },
  {
    "text": "from known bad IP ranges um by taking",
    "start": "852720",
    "end": "856000"
  },
  {
    "text": "like spam lists and botn nets and making",
    "start": "856000",
    "end": "858800"
  },
  {
    "text": "sure we're just blocking that right at",
    "start": "858800",
    "end": "860399"
  },
  {
    "text": "the edge and doing this allows us",
    "start": "860399",
    "end": "864160"
  },
  {
    "text": "there's there's really no point in",
    "start": "864160",
    "end": "865600"
  },
  {
    "text": "dealing with those bad requests if you",
    "start": "865600",
    "end": "867199"
  },
  {
    "text": "already know they're bad if you're",
    "start": "867199",
    "end": "868560"
  },
  {
    "text": "letting them into your infrastructure",
    "start": "868560",
    "end": "869680"
  },
  {
    "text": "you're just you're wasting resources to",
    "start": "869680",
    "end": "871440"
  },
  {
    "text": "deal with them",
    "start": "871440",
    "end": "873120"
  },
  {
    "text": "so the other thing we can do is we can",
    "start": "873120",
    "end": "874880"
  },
  {
    "text": "use Lambda to kind of scan through our",
    "start": "874880",
    "end": "878160"
  },
  {
    "text": "logs and then we can apply if we find",
    "start": "878160",
    "end": "882079"
  },
  {
    "text": "depending on what rules we set if we",
    "start": "882079",
    "end": "883600"
  },
  {
    "text": "find malicious traffic we can block it",
    "start": "883600",
    "end": "885920"
  },
  {
    "text": "permanently or temporarily and that's",
    "start": "885920",
    "end": "887519"
  },
  {
    "text": "about it thanks for coming out tonight",
    "start": "887519",
    "end": "891880"
  },
  {
    "text": "aws loft talks",
    "start": "893519",
    "end": "896800"
  }
]