[
  {
    "text": "If you want to build a native mobile app that serves free and paid users, stick around.",
    "start": "779",
    "end": "5838"
  },
  {
    "text": "I'll show you the services you need in this episode.",
    "start": "5838",
    "end": "9069"
  },
  {
    "text": "How to Build This\nwith Jillian Forde.",
    "start": "12568",
    "end": "17696"
  },
  {
    "text": "Today's episode comes from Shashwat.",
    "start": "17696",
    "end": "19840"
  },
  {
    "text": "He wants to build an app that requires people to play a game ",
    "start": "19840",
    "end": "23060"
  },
  {
    "text": "in order for them to snooze their alarm.",
    "start": "23060",
    "end": "25496"
  },
  {
    "text": "I don't know about you, but I'm definitely not ready to play any games before I've had my morning coffee.",
    "start": "25496",
    "end": "31259"
  },
  {
    "text": "Let's hear from Shashwat.",
    "start": "31259",
    "end": "33226"
  },
  {
    "text": "Hi I am Shashwat and I would like to build an alarm app but with a twist.",
    "start": "33226",
    "end": "37429"
  },
  {
    "text": "So basically, every time a person\nsets an alarm. and it rings,",
    "start": "37429",
    "end": "40782"
  },
  {
    "text": "they would have to play a game for at least a minute\nor until they have to change the game",
    "start": "40782",
    "end": "45746"
  },
  {
    "text": "by achieving certain desired points.",
    "start": "45746",
    "end": "48268"
  },
  {
    "text": "This would help anyone who has a problem\nin maybe getting up in the morning",
    "start": "48269",
    "end": "53022"
  },
  {
    "text": "or has a habit of turning off their alarm as soon as it rings.",
    "start": "53022",
    "end": "57186"
  },
  {
    "text": "As completing a task before they can turn off the alarm would help them to awaken up",
    "start": "57186",
    "end": "61863"
  },
  {
    "text": "and would remove the urge to go back to sleep.",
    "start": "61863",
    "end": "64573"
  },
  {
    "text": "In this episode I'll also show you the service that you need to build a mobile app",
    "start": "64573",
    "end": "69590"
  },
  {
    "text": "that has free content\nand paid members-only content.",
    "start": "69590",
    "end": "73625"
  },
  {
    "text": "You will need to build an iOS app\nand an Android app.",
    "start": "73625",
    "end": "77502"
  },
  {
    "text": "These apps will be distributed on the Google Play and the Apple Store",
    "start": "77502",
    "end": "81466"
  },
  {
    "text": "which is also where you set up store billing and subscription features.",
    "start": "81467",
    "end": "85618"
  },
  {
    "text": "You'll provision the back end of your app using AWS Amplify.",
    "start": "85618",
    "end": "90146"
  },
  {
    "text": "Amplify is a set of tools and services\nthat helps you build applications on AWS quickly.",
    "start": "90896",
    "end": "97324"
  },
  {
    "text": "You'll use separate Git repositories for iOS and Android.",
    "start": "97324",
    "end": "101328"
  },
  {
    "text": "The Android application would be the primary application",
    "start": "101329",
    "end": "104617"
  },
  {
    "text": "where you'll define the backend components.",
    "start": "104617",
    "end": "107437"
  },
  {
    "text": "The iOS application will then be able to pull the Amplify metadata ",
    "start": "107437",
    "end": "111847"
  },
  {
    "text": "to use the same backend.",
    "start": "111847",
    "end": "113627"
  },
  {
    "text": "The same logic applies if iOS is the primary application.",
    "start": "113627",
    "end": "118590"
  },
  {
    "text": "The Android version would pull\nthe Amplify metadata to use the same backend.",
    "start": "118590",
    "end": "123675"
  },
  {
    "text": "You can configure infrastructure in the cloud using the Amplify CLI or the console.",
    "start": "123676",
    "end": "129604"
  },
  {
    "text": "In the console you run the #amplify init command\nto initialize Amplify.",
    "start": "129604",
    "end": "134555"
  },
  {
    "text": "To add authentication,\nrun #amplify add auth.",
    "start": "134555",
    "end": "138271"
  },
  {
    "text": "This will create an Amazon Cognito User Pool.",
    "start": "138272",
    "end": "141127"
  },
  {
    "text": "Cognito lets you add user signup,\nsign in and access control.",
    "start": "143166",
    "end": "147521"
  },
  {
    "text": "Cognito has a concept called User pools,\nwhich you can think of as a user directory.",
    "start": "147521",
    "end": "152976"
  },
  {
    "text": "The Cognito Identity Pool provides credentials for the client application ",
    "start": "152977",
    "end": "157834"
  },
  {
    "text": "so your users can connect\nto AWS Services like AppSync or S3.",
    "start": "157834",
    "end": "162523"
  },
  {
    "text": "You exchange your identity tokens for temporary AWS credentials. ",
    "start": "162523",
    "end": "167149"
  },
  {
    "text": "If you're happy with your setup, you can push it to AWS ",
    "start": "167833",
    "end": "171142"
  },
  {
    "text": "to provision it with the CLI command:\namplify push.",
    "start": "171142",
    "end": "175313"
  },
  {
    "text": "You'll use that command every time you want to update your cloud resources.",
    "start": "175313",
    "end": "180573"
  },
  {
    "text": "Your application will need a backend API\nto talk to a database to store data.",
    "start": "180573",
    "end": "185497"
  },
  {
    "text": "You can use amplify to provision an AWS AppSync API",
    "start": "185497",
    "end": "189735"
  },
  {
    "text": "that is backed by the NoSQL database Amazon DynamoDB.",
    "start": "189735",
    "end": "193938"
  },
  {
    "text": "AppSync is a fully managed service\nthat makes it easy to develop GraphQL APIs.",
    "start": "195528",
    "end": "200722"
  },
  {
    "text": "DynamoDB is a fast and flexible\nNoSQL database for any scale.",
    "start": "200722",
    "end": "206592"
  },
  {
    "text": " Run amplify add api in the CLI\nto create your backend API and database.",
    "start": "206592",
    "end": "212670"
  },
  {
    "text": "Make sure you select the GraphQL type of API\nand Amazon Cognito User Pool for authentication. ",
    "start": "212670",
    "end": "220388"
  },
  {
    "text": "You will be asked to set up your data model,\nbut don't worry,",
    "start": "220455",
    "end": "223753"
  },
  {
    "text": "you can always change your configuration later.",
    "start": "223753",
    "end": "226556"
  },
  {
    "text": "Based on the data schema you created, Amplify can generate client-side libraries,",
    "start": "226556",
    "end": "231518"
  },
  {
    "text": "so it's easy to use your API.",
    "start": "231518",
    "end": "234068"
  },
  {
    "text": "Run amplify codegen models\nto generate your models.",
    "start": "234068",
    "end": "238528"
  },
  {
    "text": "The generated files are automatically imported in your project.",
    "start": "238528",
    "end": "243736"
  },
  {
    "text": "In order for your iOS app to use the same backend as the Android app,",
    "start": "243736",
    "end": "248836"
  },
  {
    "text": "you can pull the Amplify metadata\nusing the command amplify pull in the CLI.",
    "start": "248837",
    "end": "254409"
  },
  {
    "text": "Now it's time to think about how your backend\ncan distinguish between paying users and nonpaying users.",
    "start": "254409",
    "end": "261923"
  },
  {
    "text": "Only authenticated users that have paid\nthrough the Google or Apple Store",
    "start": "261923",
    "end": "265865"
  },
  {
    "text": "should be able to access premium content or premium features.",
    "start": "265865",
    "end": "270293"
  },
  {
    "text": "AWS Cognito Identity Pool allows\nboth unauthenticated and authenticated users",
    "start": "270293",
    "end": "276400"
  },
  {
    "text": "to gain credentials to access AWS services.",
    "start": "276400",
    "end": "279850"
  },
  {
    "text": "You can offer some functionality to unauthenticated users early in their experience, ",
    "start": "279850",
    "end": "285186"
  },
  {
    "text": "without creating friction, and then restrict access to premium features for authenticated users only.",
    "start": "285186",
    "end": "291681"
  },
  {
    "text": "Post authentication, Cognito allows you\nto trigger an AWS Lambda function",
    "start": "292765",
    "end": "297546"
  },
  {
    "text": "which can be used to save the user in DynamoDB\nand maintain a user profile.",
    "start": "297546",
    "end": "303508"
  },
  {
    "text": "Lambda allows you to run code\nwithout thinking about servers or clusters.",
    "start": "303508",
    "end": "308695"
  },
  {
    "text": "Make sure you use the username\nas a unique key in your DynamoDB table ",
    "start": "308695",
    "end": "314306"
  },
  {
    "text": "to uniquely identify users.",
    "start": "314306",
    "end": "316904"
  },
  {
    "text": "These user profiles will track\nwhich in app features have been bought by a user.",
    "start": "316904",
    "end": "322587"
  },
  {
    "text": "For simple in-app purchases, your application\nwill need to validate transactions. ",
    "start": "322588",
    "end": "327128"
  },
  {
    "text": "It is strongly recommended\nto validate transactions on your backend",
    "start": "327128",
    "end": "331783"
  },
  {
    "text": "and not from your mobile app directly\nas this cannot be trusted.",
    "start": "331783",
    "end": "336288"
  },
  {
    "text": "After a user makes an in-app purchase,\nApple will provide a receipt ID",
    "start": "336827",
    "end": "341392"
  },
  {
    "text": "and Google a purchase token.",
    "start": "341392",
    "end": "343863"
  },
  {
    "text": "You'll need to validate the receipt ID\nand purchase token in Lambda",
    "start": "343864",
    "end": "348009"
  },
  {
    "text": "before turning the purchase feature on.",
    "start": "348009",
    "end": "350634"
  },
  {
    "text": "In Shashwat's case, this purchase\nwill unlock premium games.",
    "start": "350634",
    "end": "355213"
  },
  {
    "text": "Create an API gateway endpoint and a Lambda function\nto validate your receipt ID and purchase token.",
    "start": "355213",
    "end": "361392"
  },
  {
    "text": "API Gateway enables you to create,\nmaintain and secure APIs at any scale.",
    "start": "361392",
    "end": "367233"
  },
  {
    "text": "The data to know\nwhich authenticated user has made a purchase",
    "start": "367233",
    "end": "370971"
  },
  {
    "text": "Can be found in the API call\nwhich has been authenticated by Cognito.",
    "start": "370971",
    "end": "376450"
  },
  {
    "text": "Once the token is validated, your Lambda function\ncan update user records in DynamoDB",
    "start": "376450",
    "end": "382252"
  },
  {
    "text": "to indicate that this user\nis a paying customer",
    "start": "382252",
    "end": "385607"
  },
  {
    "text": "For in app subscriptions, asynchronous events\nfrom the Apple and Google Store",
    "start": "386427",
    "end": "391266"
  },
  {
    "text": "need to be captured\nto update your application status.",
    "start": "391266",
    "end": "394718"
  },
  {
    "text": "You can do this by creating a new API gateway endpoint\nto receive webhook events",
    "start": "394718",
    "end": "400201"
  },
  {
    "text": "and forward them to a Lambda function.",
    "start": "400201",
    "end": "403272"
  },
  {
    "text": "Apple and Google will call this webhook for events\nlike failed renewals and subscription cancellations.",
    "start": "403273",
    "end": "410124"
  },
  {
    "text": "API Gateway will pass the input payload coming from the\nApple and Google Store to the Lambda function.",
    "start": "410124",
    "end": "417354"
  },
  {
    "text": "You can use the receipt ID from Apple\nor purchase token from Google",
    "start": "417355",
    "end": "421411"
  },
  {
    "text": "to find the user in your database\nto update its status.",
    "start": "421411",
    "end": "425282"
  },
  {
    "text": "Now that I've had my morning coffee,\nI'm ready for your game, Shashwat.",
    "start": "425282",
    "end": "429003"
  },
  {
    "text": "Let's recap.",
    "start": "429003",
    "end": "430723"
  },
  {
    "text": "Use Amplify to provision your resources in the cloud.",
    "start": "430723",
    "end": "433748"
  },
  {
    "text": "Add authentication using the\nauthentication module in Amplify",
    "start": "433748",
    "end": "438271"
  },
  {
    "text": "which will use Amazon Cognito\nbehind the scenes.",
    "start": "438271",
    "end": "441070"
  },
  {
    "text": "Get and store user information\nusing AWS AppSync with Amazon DynamoDB.",
    "start": "441070",
    "end": "447210"
  },
  {
    "text": "Control access to paid content or features\nwith Amazon API Gateway with AWS Lambda.",
    "start": "447210",
    "end": "453505"
  },
  {
    "text": "Those are the features that you need\nto build an MVP of a mobile app",
    "start": "453506",
    "end": "457623"
  },
  {
    "text": "that has free and paid content.",
    "start": "457623",
    "end": "460241"
  },
  {
    "text": "Make sure you check out the resources below this video\nbefore you start building.",
    "start": "460242",
    "end": "465146"
  },
  {
    "text": "And remember, it doesn't matter when you start,\nas long as you just get started.",
    "start": "465146",
    "end": "469690"
  },
  {
    "text": "Thanks for hanging out with me, see you soon.",
    "start": "469690",
    "end": "472246"
  },
  {
    "text": "Thank you for watching.",
    "start": "472246",
    "end": "473711"
  },
  {
    "text": "Check out more about Solutions Architecture on AWS\naws.amazon.com/architecture",
    "start": "473711",
    "end": "480409"
  }
]