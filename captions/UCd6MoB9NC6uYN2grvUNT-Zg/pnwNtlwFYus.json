[
  {
    "text": "hello welcome everyone thank you for coming to our talk today on red team vs.",
    "start": "2689",
    "end": "8429"
  },
  {
    "text": "blue team on eight of us this is called the Alan and my name is stereo Nicol we",
    "start": "8429",
    "end": "13860"
  },
  {
    "text": "used to work together but we don't anymore but we still run the Seattle AWS architects and engineers Meetup",
    "start": "13860",
    "end": "19590"
  },
  {
    "text": "we have about 2,500 members in this Meetup and we're celebrating our fifth year anniversary in January so if you",
    "start": "19590",
    "end": "26580"
  },
  {
    "text": "happen to be in Seattle in January come hang out with us and help us celebrate that so we come to you today with a",
    "start": "26580",
    "end": "33420"
  },
  {
    "text": "diverse experience I have about 25 years of software development architecture and",
    "start": "33420",
    "end": "40110"
  },
  {
    "text": "engineering experience as well as security experience and I've done a",
    "start": "40110",
    "end": "45329"
  },
  {
    "text": "number of different things in the realm of software architecture including financial systems for capital one back",
    "start": "45329",
    "end": "50700"
  },
  {
    "text": "office systems for Nordstrom architected a SAS IOT solution those are just some",
    "start": "50700",
    "end": "56190"
  },
  {
    "text": "examples of some software development experience I have I also have a number of security certifications if any of you",
    "start": "56190",
    "end": "63480"
  },
  {
    "text": "are familiar with the sans GX PN it's an advanced pen testing certification actually just got this last week it's",
    "start": "63480",
    "end": "70170"
  },
  {
    "text": "very challenging but I don't just have certifications I have real-world experience in security and it started",
    "start": "70170",
    "end": "76740"
  },
  {
    "text": "when I ran my own company of part of the whenever and now was a software consulting business and I would have",
    "start": "76740",
    "end": "82470"
  },
  {
    "text": "security breaches and incidents and I didn't have anyone to help me I just figure it out I didn't know what to do",
    "start": "82470",
    "end": "87720"
  },
  {
    "text": "sometimes I had to figure out how the Malheur got on their systems and solve those problems so now what I really like",
    "start": "87720",
    "end": "93540"
  },
  {
    "text": "to do is help other people with their security so the past few years have been",
    "start": "93540",
    "end": "99299"
  },
  {
    "text": "focusing primarily on cloud security I really got into this because I looked at the cloud and based on my experiences I",
    "start": "99299",
    "end": "105299"
  },
  {
    "text": "thought well some people could be more secure in the cloud potentially but you have to configure things correctly if",
    "start": "105299",
    "end": "111840"
  },
  {
    "text": "you don't configure things correctly you could have problems and that's what we're going to talk to you about here",
    "start": "111840",
    "end": "116939"
  },
  {
    "text": "today so now I run my own software consulting business as Sarris cloud",
    "start": "116939",
    "end": "122280"
  },
  {
    "text": "security consulting business called second site lab and I help people with cloud security consulting training and",
    "start": "122280",
    "end": "129539"
  },
  {
    "text": "pen testing this past year I was teaching for SANS Institute I still have some good friends that teach there some of them in the cloud we",
    "start": "129539",
    "end": "135920"
  },
  {
    "text": "talk to the cloud security architecture in operations class but next year I'm teaching my own classes running my own",
    "start": "135920",
    "end": "141109"
  },
  {
    "text": "classes that are gonna be a little bit different and they're really geared at helping developers and security people work together better like we're doing",
    "start": "141109",
    "end": "147500"
  },
  {
    "text": "here on Sage today so I'm Colby so as Terry said we've known each other for about four years and we run the",
    "start": "147500",
    "end": "153980"
  },
  {
    "text": "community group together and have worked together I actually started life as a physical chemist and so I started in",
    "start": "153980",
    "end": "161060"
  },
  {
    "text": "chemistry got really tired of chemistry and so liked the technology side of it and went into consulting started using",
    "start": "161060",
    "end": "167780"
  },
  {
    "text": "AWS and got passionate about that and I was able to move through a few different jobs currently I work at zip whip so",
    "start": "167780",
    "end": "175489"
  },
  {
    "text": "we're a startup based out of Seattle we provide landline and toll free texting services for businesses to be able to",
    "start": "175489",
    "end": "182090"
  },
  {
    "text": "communicate with their customers and as Terry said you know just talk is this",
    "start": "182090",
    "end": "187579"
  },
  {
    "text": "kind of gonna be about things that we've learned and done over the years with building stuff on Amazon okay so as we",
    "start": "187579",
    "end": "198829"
  },
  {
    "text": "said we're gonna talk to you about red team versus blue team on AWS and if you're not familiar with those terms the",
    "start": "198829",
    "end": "204409"
  },
  {
    "text": "red team is a team that usually works inside of a company and simulates tax",
    "start": "204409",
    "end": "209629"
  },
  {
    "text": "attacks on company systems it tries to find ways to break in and traverse a network and find security gaps in holes",
    "start": "209629",
    "end": "216859"
  },
  {
    "text": "and that team helps the blue team who is the defensive team the team that sets up",
    "start": "216859",
    "end": "222139"
  },
  {
    "text": "the defenses the security controls on the network and on the applications and tries to defend the environment and",
    "start": "222139",
    "end": "228109"
  },
  {
    "text": "there's a saying that offense informs defense so the offensive team is going to attack the systems and be based on",
    "start": "228109",
    "end": "235009"
  },
  {
    "text": "what they find the blue team is going to make adjustments to secure the environment you may have also heard the",
    "start": "235009",
    "end": "241939"
  },
  {
    "text": "term pen testing and just to get this out of the way penetration testing or pen testing is usually done by an",
    "start": "241939",
    "end": "247459"
  },
  {
    "text": "external company that comes in and tests the environment sometimes this is required for PCI compliance or otherwise",
    "start": "247459",
    "end": "253040"
  },
  {
    "text": "and some people debate what these terms mean for our purposes today we're kind",
    "start": "253040",
    "end": "259039"
  },
  {
    "text": "of just talking about an attacker versus a defender and so for today I am going",
    "start": "259039",
    "end": "265370"
  },
  {
    "text": "to be the stealthy ninja on the screen I'm gonna go into the account and I'm gonna try to attack it and see if I can get through and",
    "start": "265370",
    "end": "271759"
  },
  {
    "text": "steal some of your data and Colby's gonna be Superman he's gonna come in and save the day",
    "start": "271759",
    "end": "276800"
  },
  {
    "text": "he's going to show you how to fix the problems that I'd find so let's just get",
    "start": "276800",
    "end": "282830"
  },
  {
    "text": "this out of the way whenever you're doing standard pen testing one of the goals when the on-premises environment",
    "start": "282830",
    "end": "289789"
  },
  {
    "text": "is to get domain admin and what this means is the ultimate achievement of a",
    "start": "289789",
    "end": "294830"
  },
  {
    "text": "pen tester is to get administrative credentials on the domain administrator because what does that mean",
    "start": "294830",
    "end": "300979"
  },
  {
    "text": "that means I can go in I can create myself accounts I can basically give myself permission to anyone anything in",
    "start": "300979",
    "end": "307009"
  },
  {
    "text": "your environment and do whatever I want so in the cloud we're calling this cloud admin and if you get cloud administrator",
    "start": "307009",
    "end": "315380"
  },
  {
    "text": "credentials and you've given your cloud administrator full credentials to everything in your account I want to get",
    "start": "315380",
    "end": "320630"
  },
  {
    "text": "those credentials because then I can do anything I want in your account but if I",
    "start": "320630",
    "end": "326449"
  },
  {
    "text": "was able to do that this would be a really boring talk because there's pretty much game over right and there's",
    "start": "326449",
    "end": "332060"
  },
  {
    "text": "actually a company that faced this problem you may have heard of called code spaces and I like to say it's the company that got deleted because what",
    "start": "332060",
    "end": "340069"
  },
  {
    "text": "happened was an attacker got their credentials demanded some money so give me some money or I'm going to do bad",
    "start": "340069",
    "end": "346370"
  },
  {
    "text": "things in your account and they said no and so then the attacker proceeded to delete everything they had in our cloud",
    "start": "346370",
    "end": "352159"
  },
  {
    "text": "they hosted code and files for other companies and all their customers data was deleted and they went out of",
    "start": "352159",
    "end": "358039"
  },
  {
    "text": "business so instead of talking about that we want to do something a little more interesting we're gonna go on a",
    "start": "358039",
    "end": "365389"
  },
  {
    "text": "treasure hunt we're gonna search for buried treasure so your data is like your treasure it's like your gold right",
    "start": "365389",
    "end": "370759"
  },
  {
    "text": "so the thing that you're trying to protect in your account it's what's really valuable to you all most of the time this is the goal of",
    "start": "370759",
    "end": "376069"
  },
  {
    "text": "attackers to go in and get some data and steal it as you've seen in many of the security breaches that have been in the",
    "start": "376069",
    "end": "382310"
  },
  {
    "text": "news recently and in order to attack your account and get this data I'm going",
    "start": "382310",
    "end": "388520"
  },
  {
    "text": "not going to use standard pen testing tool so you may have heard of Metasploit or perish the Empire and there's",
    "start": "388520",
    "end": "393770"
  },
  {
    "text": "actually I have some friends that work for Rhino security up in Seattle and they created a cool tool",
    "start": "393770",
    "end": "399819"
  },
  {
    "text": "called PACU and I like to say it's the Metasploit of AWS right it has functions",
    "start": "399819",
    "end": "404900"
  },
  {
    "text": "you can use to try to get into the account but we're gonna use a different methodology it's called living off the",
    "start": "404900",
    "end": "409940"
  },
  {
    "text": "land what this means is I'm not going to use any tools other than the ones that are already existing in your account the",
    "start": "409940",
    "end": "416240"
  },
  {
    "text": "things that your developers and your DevOps people are using I'm going to use those tools and leverage them to traverse and get through your account in",
    "start": "416240",
    "end": "422659"
  },
  {
    "text": "your network and figure out how I can get out at your data and steal it so",
    "start": "422659",
    "end": "428710"
  },
  {
    "text": "before we dive in we're gonna kind of go over some background how we set things up so we treated this as if we had our",
    "start": "428710",
    "end": "435740"
  },
  {
    "text": "manager asked us this goes start to point stuff on AWS we spun up a brand new AWS account we had a single user",
    "start": "435740",
    "end": "442490"
  },
  {
    "text": "made base VPC and default so we left it as vanilla as possible we then realized",
    "start": "442490",
    "end": "448879"
  },
  {
    "text": "what we want to deploy some type of web applications so we search for some tutorials we found elastic Beanstalk",
    "start": "448879",
    "end": "454370"
  },
  {
    "text": "tutorial with wordpress we followed that tutorial all the way through so this is on Amazon's web site and then also",
    "start": "454370",
    "end": "461060"
  },
  {
    "text": "because server list is fun and new we decided to do some new server lists and we have databases so why not serve a",
    "start": "461060",
    "end": "467300"
  },
  {
    "text": "list in databases so we looked up a tutorial on using lambda with relational database service so RDS and running that",
    "start": "467300",
    "end": "474740"
  },
  {
    "text": "inside of your V PC and so again we just follow that tutorial exactly for how it was written and didn't do anything extra",
    "start": "474740",
    "end": "481490"
  },
  {
    "text": "with the account okay so in this case",
    "start": "481490",
    "end": "486680"
  },
  {
    "text": "let's say that you were trying to be secure and you set up some users but you did not give them full administrative",
    "start": "486680",
    "end": "492349"
  },
  {
    "text": "access you gave them read-only credentials I want to get a hold of some of those credentials and see what I can",
    "start": "492349",
    "end": "498379"
  },
  {
    "text": "do with them and even though they're read-only they may be able to help me out so you may know this but the",
    "start": "498379",
    "end": "504469"
  },
  {
    "text": "credentials when you use Amazon credentials are stored in a file on a",
    "start": "504469",
    "end": "509509"
  },
  {
    "text": "laptop and they're in plain text and so if I can get on to someone's laptop I",
    "start": "509509",
    "end": "515209"
  },
  {
    "text": "can grab those credentials and start using them there's a number of different ways again this is kind of outside the",
    "start": "515209",
    "end": "521089"
  },
  {
    "text": "realm what we're talking about here today but standard pentesting teeth techniques we're getting in there and getting those credentials I'll just give",
    "start": "521089",
    "end": "527720"
  },
  {
    "text": "you a couple examples I could send your developer phishing email say free ticket to read a",
    "start": "527720",
    "end": "534900"
  },
  {
    "text": "mint or something you know and then I could go in there I could try to get them to click on that email and grab",
    "start": "534900",
    "end": "540540"
  },
  {
    "text": "those credentials by some sort of malware I could also set up a drive-by download site if you try to trick them",
    "start": "540540",
    "end": "546240"
  },
  {
    "text": "into going to my site and getting some hour in their machine that way or I could just be really nice and try to use",
    "start": "546240",
    "end": "553020"
  },
  {
    "text": "some social engineering and say can I borrow your keys there's a number of different ways that you can get at",
    "start": "553020",
    "end": "559290"
  },
  {
    "text": "credentials on a machine so let's say I got those credentials what can I do with them so the first thing I want to do is",
    "start": "559290",
    "end": "566940"
  },
  {
    "text": "I want to know where your data is and I want to know where your important data is now I've worked for a lot of financial organizations and I've worked",
    "start": "566940",
    "end": "572700"
  },
  {
    "text": "with a lot of PII data or you know protected data that you don't want someone to get at and I know that a lot",
    "start": "572700",
    "end": "578730"
  },
  {
    "text": "of times this type of data is short stored in a database that's transactional or a relational database",
    "start": "578730",
    "end": "584910"
  },
  {
    "text": "and typically this is where I'm gonna find data like that so I'm gonna start",
    "start": "584910",
    "end": "590070"
  },
  {
    "text": "there and using those credentials that are just read-only I can run this query here and I can say show me all of the",
    "start": "590070",
    "end": "597240"
  },
  {
    "text": "RDS databases in this account and then I can look at the information about those",
    "start": "597240",
    "end": "603120"
  },
  {
    "text": "databases the metadata and I can charge figure out which one I want to attack in this case Colby it was really nice and",
    "start": "603120",
    "end": "609510"
  },
  {
    "text": "he named one of the databases this super-secret DB so let's see what's in that one so what are the controls that I",
    "start": "609510",
    "end": "618780"
  },
  {
    "text": "have to get through to get to this database there's a few of them there are some network controls the first thing I",
    "start": "618780",
    "end": "625260"
  },
  {
    "text": "have to get through is the network access control lists that are associated with subnets that that this database is",
    "start": "625260",
    "end": "632010"
  },
  {
    "text": "located in so what I can do is like in query the subnets associated with this database and I find - and I can look at",
    "start": "632010",
    "end": "640560"
  },
  {
    "text": "those and I can use that subnet ID to go examine the network access control lists",
    "start": "640560",
    "end": "646200"
  },
  {
    "text": "the network access control lists are going to define the traffic that is allowed in or out of the subnet in which",
    "start": "646200",
    "end": "652860"
  },
  {
    "text": "these database database resides so as you can see here we have a series of rules and in the case of a network",
    "start": "652860",
    "end": "659280"
  },
  {
    "text": "access control list the first rule that it matches will apply we have some",
    "start": "659280",
    "end": "664320"
  },
  {
    "text": "ingress rules and we have some egress rules meaning inbound and outbound and in both cases the first rule allows side roblox",
    "start": "664320",
    "end": "671820"
  },
  {
    "text": "0.0.0.0 / 0 which means anywhere on the internet on any protocol to get into the",
    "start": "671820",
    "end": "679320"
  },
  {
    "text": "subnet so this is a default that comes with subnets on AWS and if you have a developer deploying their code and the",
    "start": "679320",
    "end": "686520"
  },
  {
    "text": "resources they may just go with the defaults and so in this case I know that from here on out I don't have to worry",
    "start": "686520",
    "end": "692130"
  },
  {
    "text": "about those subnets or those network access control lists because they're wide open anything in this subnet can",
    "start": "692130",
    "end": "697710"
  },
  {
    "text": "that is in the subnet can talk to this database so the next thing I have to get",
    "start": "697710",
    "end": "704850"
  },
  {
    "text": "through are the security groups right so now I have a database name and it's",
    "start": "704850",
    "end": "711450"
  },
  {
    "text": "associated with a particular security group ID so I can go get that from the database and I can plug in into this",
    "start": "711450",
    "end": "716760"
  },
  {
    "text": "query right here and I can say show me the information about the security group as associated with the Stata base and",
    "start": "716760",
    "end": "722340"
  },
  {
    "text": "what I find here is that this security group allows access inbound on port 3306",
    "start": "722340",
    "end": "727500"
  },
  {
    "text": "which tells me it's probably my sequel right and I can see that it is anything",
    "start": "727500",
    "end": "732780"
  },
  {
    "text": "in this site or block 1 7 2 3 1 0 0 / 16 is allowed to talk to my database ok so",
    "start": "732780",
    "end": "740100"
  },
  {
    "text": "I need to figure out what is in that particular site or block that can talk to this database so how can I use this",
    "start": "740100",
    "end": "746760"
  },
  {
    "text": "information well I can look for V pcs and subnets maybe that are assigned to",
    "start": "746760",
    "end": "752760"
  },
  {
    "text": "this particular slider block to try to figure out and lucky for me I do query",
    "start": "752760",
    "end": "757980"
  },
  {
    "text": "the V pcs and I use this header block as you can see here and I find out that the entire V PC is allowed to talk to my",
    "start": "757980",
    "end": "765720"
  },
  {
    "text": "database on 3306 anything in this database ok so now what",
    "start": "765720",
    "end": "774210"
  },
  {
    "text": "I want to do is I want to find out okay I know anything can talk to this database but the the thing that is",
    "start": "774210",
    "end": "780750"
  },
  {
    "text": "talking to this database needs outbound access on port 3306 so let me see if I can figure out what is talking to this",
    "start": "780750",
    "end": "786840"
  },
  {
    "text": "database that might help me and I can look here in query on port 3306 outbound",
    "start": "786840",
    "end": "792330"
  },
  {
    "text": "in this V PC and I find another security group so probably what",
    "start": "792330",
    "end": "797680"
  },
  {
    "text": "in this security group has permission to talk to this database alright so I know",
    "start": "797680",
    "end": "804070"
  },
  {
    "text": "there's probably likely some compute resource maybe lambda or Fargate or maybe an ec2 instance so I'm gonna query",
    "start": "804070",
    "end": "810490"
  },
  {
    "text": "those and I'm gonna see if any of them are using the security group and of course I find one here this is a lambda",
    "start": "810490",
    "end": "815950"
  },
  {
    "text": "function his name create table records and read and it's based off of that tutorial that Kobe show you and here's",
    "start": "815950",
    "end": "823750"
  },
  {
    "text": "where it gets interesting so when we were first playing around with this trying to figure out what what we're going to show you and what we're going",
    "start": "823750",
    "end": "829570"
  },
  {
    "text": "to attack I did a query of the lambda function you can use this function called get function and it'll give you a",
    "start": "829570",
    "end": "835540"
  },
  {
    "text": "whole bunch of information and one of the values in there is called code dot",
    "start": "835540",
    "end": "840730"
  },
  {
    "text": "and this gives you back a URL and what I noticed was when I went to this URL I",
    "start": "840730",
    "end": "846130"
  },
  {
    "text": "didn't have to have you know any credentials I wasn't logged in to my account and I could get to it I also",
    "start": "846130",
    "end": "853089"
  },
  {
    "text": "send it to cobia text it over to him to see if he could get to and he could and so this is a time-based URL you don't",
    "start": "853089",
    "end": "859360"
  },
  {
    "text": "even need credentials in the account to see this and this is by design it's how it works so if I can get access and read",
    "start": "859360",
    "end": "866440"
  },
  {
    "text": "this information then I can use this URL to go and what does it show me it shows",
    "start": "866440",
    "end": "871930"
  },
  {
    "text": "me the code for the lambda function and how is this useful well there's a lot of ways if I can see your code there's a",
    "start": "871930",
    "end": "877630"
  },
  {
    "text": "lot of ways that's useful I can look for vulnerabilities or configuration problems I can look for programming",
    "start": "877630",
    "end": "883330"
  },
  {
    "text": "errors but in this case I see a file here called RDS underscore config hmm",
    "start": "883330",
    "end": "889420"
  },
  {
    "text": "RDS what could be in this file oh it's database username and password",
    "start": "889420",
    "end": "896050"
  },
  {
    "text": "don't do this it's really bad so you",
    "start": "896050",
    "end": "901570"
  },
  {
    "text": "should never put your secrets in your code right because if someone gets out your code they can get your secrets now I can use",
    "start": "901570",
    "end": "908320"
  },
  {
    "text": "these credentials and I can log into this database even though I only had read-only access so how am I gonna do",
    "start": "908320",
    "end": "914980"
  },
  {
    "text": "that well if I try to use this limited function it's gonna be a little tricky because this these files I don't really",
    "start": "914980",
    "end": "920410"
  },
  {
    "text": "have access to them I don't have write access to the account so skinny a little challenging so I'm gonna think of",
    "start": "920410",
    "end": "926260"
  },
  {
    "text": "another way to get in here first of all I need to get to an instance that has access to the",
    "start": "926260",
    "end": "932750"
  },
  {
    "text": "Internet I need to find something I can attack and get in that way so I can query your account see all the ec2 instances that",
    "start": "932750",
    "end": "939860"
  },
  {
    "text": "have a public IP or a public DNS name and that might give me a clue as to what I can get into and once I get in there I",
    "start": "939860",
    "end": "948080"
  },
  {
    "text": "can find some instances now I need to find out if these particular instances that I want to get into have access to",
    "start": "948080",
    "end": "953600"
  },
  {
    "text": "our database now you may know this but when you deploy a security group but you don't specify any outbound rules by",
    "start": "953600",
    "end": "960920"
  },
  {
    "text": "default there will be a rule in that security group that says 0.0.0.0 slash zero on any port that means that",
    "start": "960920",
    "end": "968660"
  },
  {
    "text": "whatever resource you assign the security group to can talk outbound to anything else so I'm gonna hope that in",
    "start": "968660",
    "end": "975650"
  },
  {
    "text": "this account you had some people that just use those default rules and set me up some security groups around some",
    "start": "975650",
    "end": "981500"
  },
  {
    "text": "instance with some public internet access that I can use to get at this database and sure enough I found a whole",
    "start": "981500",
    "end": "986930"
  },
  {
    "text": "list of security groups that have this default out that rule and one of them is associated with one of those instances",
    "start": "986930",
    "end": "994190"
  },
  {
    "text": "and when I go to that instance I find out hey this is a WordPress website great how does that help me well now",
    "start": "994190",
    "end": "1002770"
  },
  {
    "text": "what I'm gonna do is we're going back into kind of the land of standard pentacene and what a pen tester or a red",
    "start": "1002770",
    "end": "1008020"
  },
  {
    "text": "teamer will do is they will scan your externally exposed assets for example in",
    "start": "1008020",
    "end": "1013270"
  },
  {
    "text": "this case a WordPress website looking for vulnerabilities looking for CVS",
    "start": "1013270",
    "end": "1018550"
  },
  {
    "text": "looking for problems in the code that they can exploit and what I can do is once I find one of these vulnerabilities",
    "start": "1018550",
    "end": "1023920"
  },
  {
    "text": "only takes one then I can get on to that system I can upload my code I can use",
    "start": "1023920",
    "end": "1030220"
  },
  {
    "text": "those database credentials that I stole earlier I can grab the data from the database I can just publish it to a",
    "start": "1030220",
    "end": "1036550"
  },
  {
    "text": "public web page and then I can scrape it and steal it right and so this is what I",
    "start": "1036550",
    "end": "1042610"
  },
  {
    "text": "may try to do and so there are a number of ways that you can attack these systems I'll just give you an example I",
    "start": "1042610",
    "end": "1047829"
  },
  {
    "text": "we did this talk at RSA and I talked about how in a previous test I was able",
    "start": "1047830",
    "end": "1053320"
  },
  {
    "text": "to get into a website that had a file upload field and it was you know not",
    "start": "1053320",
    "end": "1059710"
  },
  {
    "text": "properly sanitized so I could upload any code I wanted and then I could change the code and so",
    "start": "1059710",
    "end": "1066730"
  },
  {
    "text": "lo and behold after that talk there came a new CVE came out and WordPress that is related that says hey if you don't",
    "start": "1066730",
    "end": "1075100"
  },
  {
    "text": "properly or you had a control that was not properly sanitized that allowed someone to get in there and upload a",
    "start": "1075100",
    "end": "1080320"
  },
  {
    "text": "file and change something on that WordPress website so all I need to do is find any published known girl in the",
    "start": "1080320",
    "end": "1085930"
  },
  {
    "text": "abilities that you haven't patched appropriately or any sort of code flaw to getting to that website so in summary",
    "start": "1085930",
    "end": "1093940"
  },
  {
    "text": "what have I done I stole some keys I did some recon on your environment to find",
    "start": "1093940",
    "end": "1101530"
  },
  {
    "text": "out what was in there what I might attack what kind of resources were there what I might leverage and then I found",
    "start": "1101530",
    "end": "1107380"
  },
  {
    "text": "some database credentials cool got those I exploited a web server and then that",
    "start": "1107380",
    "end": "1113260"
  },
  {
    "text": "web server was allowed to by you know poor Network programming rules I was able to get at database get the data out",
    "start": "1113260",
    "end": "1120940"
  },
  {
    "text": "and then exfiltrate it from the environment and so we have a number of problems here we have you know read-only",
    "start": "1120940",
    "end": "1127630"
  },
  {
    "text": "permissions to the whole entire account we have single-factor credentials meaning no MFA a wide open network we",
    "start": "1127630",
    "end": "1135730"
  },
  {
    "text": "have secrets in code and more and now Colby's gonna tell you how to fix it so",
    "start": "1135730",
    "end": "1141370"
  },
  {
    "text": "wow I did a bad job so let's go through and talk about the all the different ways we can leverage EWS tools to make",
    "start": "1141370",
    "end": "1149650"
  },
  {
    "text": "it better so to begin with everything I'm gonna talk about it's all built in the AWS I'm not gonna use anything special all we're gonna go through and",
    "start": "1149650",
    "end": "1156250"
  },
  {
    "text": "talk through some different tools first thing is protecting credentials right Terry was able to get a set of creds so",
    "start": "1156250",
    "end": "1162700"
  },
  {
    "text": "they're the biggest and easiest way to do this is user training protect your users teach their users how to identify",
    "start": "1162700",
    "end": "1167920"
  },
  {
    "text": "phishing campaigns how to handle credentials they shouldn't be sharing them even if it's a read-only credential",
    "start": "1167920",
    "end": "1173470"
  },
  {
    "text": "as we just showed they're powerful and so you shouldn't be sharing those password policies and rotation is",
    "start": "1173470",
    "end": "1180370"
  },
  {
    "text": "important right so Terry was able to use those creds I mean we created those creds and she used them over three",
    "start": "1180370",
    "end": "1185800"
  },
  {
    "text": "months you know I never rotated them once and so during those three months she could have kept going back in and",
    "start": "1185800",
    "end": "1191590"
  },
  {
    "text": "continued exfilling data from our account require MFA right there was no",
    "start": "1191590",
    "end": "1196990"
  },
  {
    "text": "hey here so once Terry had those credentials she had all the auth pieces she there was no extra piece needed",
    "start": "1196990",
    "end": "1202890"
  },
  {
    "text": "require frequent real especially to sensitive parts of your application or your infrastructure so that those",
    "start": "1202890",
    "end": "1209950"
  },
  {
    "text": "credentials are getting refresh and you know I'll go through some examples of this and then as you saw I put creds in",
    "start": "1209950",
    "end": "1216220"
  },
  {
    "text": "code I followed a tutorial that told me to do that you know we need to protect against that AWS has a tool that we can leverage",
    "start": "1216220",
    "end": "1223720"
  },
  {
    "text": "in with get called get secrets which we'll go through and actually scan as a pre-commit hook for AWS credentials by",
    "start": "1223720",
    "end": "1230410"
  },
  {
    "text": "default and you can actually write your own reg X's because those are delightful or right and integrating them yourself",
    "start": "1230410",
    "end": "1238540"
  },
  {
    "text": "right so here's just an example a Python script where we have you know the boto 3 session coming online you have a set of",
    "start": "1238540",
    "end": "1244720"
  },
  {
    "text": "creds in there I go try to check in the file it doesn't let me so you can roll this out to your developers just as that",
    "start": "1244720",
    "end": "1251620"
  },
  {
    "text": "final sanity check to make sure credentials aren't being uploaded to get and you're protecting them there so",
    "start": "1251620",
    "end": "1259300"
  },
  {
    "text": "let's talk about I am so this is how she made you know did the main compromise so",
    "start": "1259300",
    "end": "1266230"
  },
  {
    "text": "how can you protect about this so again I'm not gonna do an I am top 10 talk I'm just gonna go over a few points that you",
    "start": "1266230",
    "end": "1272590"
  },
  {
    "text": "know we've deemed important and methodologies that can help you do a bunch of things really easily that we've",
    "start": "1272590",
    "end": "1278830"
  },
  {
    "text": "found useful but you know there's a bunch of great I am top 10 talks out there and I recommend everybody to",
    "start": "1278830",
    "end": "1284740"
  },
  {
    "text": "listen to them because they're all good but the big thing that I'm gonna focus on are going to be roles least privilege",
    "start": "1284740",
    "end": "1290770"
  },
  {
    "text": "and segregation of duties and I'm gonna leverage roles to get me the last one",
    "start": "1290770",
    "end": "1295929"
  },
  {
    "text": "for free okay so I'm gonna create a user and this user is going to have the most minimum amount of permissions possible",
    "start": "1295929",
    "end": "1302710"
  },
  {
    "text": "literally they can manage themselves and I am that is it you know they can set an mfa token they",
    "start": "1302710",
    "end": "1309160"
  },
  {
    "text": "can't do anything else and so we're gonna go through and set these permissions up and so we're gonna go",
    "start": "1309160",
    "end": "1315130"
  },
  {
    "text": "through and show you this gambol to set this up so we're gonna give them some permissions you know the first ones are",
    "start": "1315130",
    "end": "1320260"
  },
  {
    "text": "just kind of some I am console permissions it's gonna allow the user to view enough information so they can get into I am and actually see themselves",
    "start": "1320260",
    "end": "1328080"
  },
  {
    "text": "we're gonna let them get the password policy because we just said we're gonna set a password policy so we got to make sure they can get that and apply it I mean",
    "start": "1328080",
    "end": "1335139"
  },
  {
    "text": "then again we'll let them list all the users you probably could refine that but this will let them find themselves in",
    "start": "1335139",
    "end": "1340509"
  },
  {
    "text": "the list pretty easily so this one's pretty generic this is just to kind of get the console to work from there we're",
    "start": "1340509",
    "end": "1347529"
  },
  {
    "text": "gonna lock them down so I'm gonna give them only a very small set of privileges and it's literally just privileges to",
    "start": "1347529",
    "end": "1354220"
  },
  {
    "text": "change their I am account permission alright or not their permissions but just change their I am account important",
    "start": "1354220",
    "end": "1359769"
  },
  {
    "text": "thing is I'm not gonna let them change their permissions okay so they can set their password change their password SSH",
    "start": "1359769",
    "end": "1366669"
  },
  {
    "text": "keys to use some of the code star tools and different things like this but we're gonna use a special tag and I am so you",
    "start": "1366669",
    "end": "1373600"
  },
  {
    "text": "know this is a cool feature I don't know if anybody's using this but we're gonna leverage this I am tag that effectively",
    "start": "1373600",
    "end": "1378820"
  },
  {
    "text": "when you log in it pulls in your user information so our team that's managing",
    "start": "1378820",
    "end": "1384669"
  },
  {
    "text": "I am only has to create one set of templates to apply to all users because when you log in it assumes your identity",
    "start": "1384669",
    "end": "1392139"
  },
  {
    "text": "and so that's that AWS colon username so we've limited who you know who you can",
    "start": "1392139",
    "end": "1397960"
  },
  {
    "text": "actually change the next piece is we're gonna do some MFA stuff okay we're gonna",
    "start": "1397960",
    "end": "1404409"
  },
  {
    "text": "let the user add in FA and we're only gonna let them add in FA okay we've",
    "start": "1404409",
    "end": "1409929"
  },
  {
    "text": "decided you know for us we found that we don't want them to delete it so the problem is is if you let them delete MFA",
    "start": "1409929",
    "end": "1416320"
  },
  {
    "text": "if someone were to compromise a set of credentials they could go in and remove the MFA and now you don't have it",
    "start": "1416320",
    "end": "1421629"
  },
  {
    "text": "anymore this also lets you separate your IAM and your user control team from the team",
    "start": "1421629",
    "end": "1427029"
  },
  {
    "text": "that's actually using AWS they have to initiate you know a ticket with your IT or something like that have the MFA",
    "start": "1427029",
    "end": "1433990"
  },
  {
    "text": "removed you have two parties they're some type of ticketing of tracking system in place so it gives you some",
    "start": "1433990",
    "end": "1440110"
  },
  {
    "text": "good practices on how to handle that okay so this user is gonna have like I",
    "start": "1440110",
    "end": "1445240"
  },
  {
    "text": "said very little to no permissions at all beyond setting passwords and enrolling themselves then we're going to",
    "start": "1445240",
    "end": "1452230"
  },
  {
    "text": "add one final role to the ability to the user that's the ability to assume set",
    "start": "1452230",
    "end": "1457269"
  },
  {
    "text": "roles okay and we're gonna require some special things with this so we're going",
    "start": "1457269",
    "end": "1463480"
  },
  {
    "text": "to create a bunch rolls these rolls are gonna be very limited to scope rules right your network admin your you know kubernetes",
    "start": "1463480",
    "end": "1470970"
  },
  {
    "text": "admin what we know whatever tool and scope these down we're gonna require MFA to assume these roles so they're gonna",
    "start": "1470970",
    "end": "1477240"
  },
  {
    "text": "have to have a two-factor off into this and then we're also gonna put some time Bush constraints around these roles so",
    "start": "1477240",
    "end": "1483210"
  },
  {
    "text": "these you know more sensitive roles are gonna have a lot less time that they're gonna be able to be assumed than some of",
    "start": "1483210",
    "end": "1489720"
  },
  {
    "text": "the other ones and so your user now comes in they have this default set of credentials the ones that teri",
    "start": "1489720",
    "end": "1495390"
  },
  {
    "text": "compromised but they can't do anything you know sites changed the users password that you don't require MFA to",
    "start": "1495390",
    "end": "1501240"
  },
  {
    "text": "assume any privilege and so we've protected the roles there we're the leverage the secured token system so",
    "start": "1501240",
    "end": "1507840"
  },
  {
    "text": "we're gonna get back a temporary set of credentials that we can then use to do our action but the important piece here",
    "start": "1507840",
    "end": "1513690"
  },
  {
    "text": "is now is all those credentials are temporary they all have some sort of expiration associated with that so we",
    "start": "1513690",
    "end": "1520770"
  },
  {
    "text": "can actually then define you know your network admin has 15 minutes of access and they have to re off our EMF aan and",
    "start": "1520770",
    "end": "1527700"
  },
  {
    "text": "you're better protecting that network and so you're able to require frequent re off a lot easier with this leveraging",
    "start": "1527700",
    "end": "1535380"
  },
  {
    "text": "the MFA or integrating with any type of off source that you want so what does",
    "start": "1535380",
    "end": "1540690"
  },
  {
    "text": "this actually look like so here's the same command to terry ran against the account so I have my default set of",
    "start": "1540690",
    "end": "1547110"
  },
  {
    "text": "credentials as a user all I can do is manage myself and I tried to describe the RDS instances and I get not act yeah",
    "start": "1547110",
    "end": "1554940"
  },
  {
    "text": "I can't access it I don't have the rights I created a secure read-only role that",
    "start": "1554940",
    "end": "1560070"
  },
  {
    "text": "does let me read the account first set amount of time I assume it the important thing though is I required MFA to assume",
    "start": "1560070",
    "end": "1566909"
  },
  {
    "text": "that role so I assume Intuit I have my second factor of off and can get into it I'll get back instead of temporary",
    "start": "1566909",
    "end": "1573539"
  },
  {
    "text": "credentials the key there is a are temporary we get at back an expiration time on when those credentials are no",
    "start": "1573539",
    "end": "1579690"
  },
  {
    "text": "longer valid we even leverage those credentials run the command I get the things back these",
    "start": "1579690",
    "end": "1585510"
  },
  {
    "text": "credentials are going to expire they're no longer will work after a set amount of time and then we have to read off and",
    "start": "1585510",
    "end": "1590970"
  },
  {
    "text": "so we're not just sitting around for months on end sitting there for someone to exploit once they're done they're",
    "start": "1590970",
    "end": "1596940"
  },
  {
    "text": "done okay so that lets us go through and manage the credentials we can also be",
    "start": "1596940",
    "end": "1602950"
  },
  {
    "text": "proactive in monitoring this credentials so I'm assuming everybody in the room use AWS uses cloud trail you should",
    "start": "1602950",
    "end": "1609220"
  },
  {
    "text": "because new accounts have it down by default now so Cloud trail is gonna monitor all of those API actions for us",
    "start": "1609220",
    "end": "1615970"
  },
  {
    "text": "and so we'll be able to see what all of our users are doing okay we can monitor",
    "start": "1615970",
    "end": "1621280"
  },
  {
    "text": "them all the nice thing is like a lot of Amazon's services these go into some type of event stream that event stream",
    "start": "1621280",
    "end": "1627400"
  },
  {
    "text": "we can subscribe to and we can do stuff with it and so we can create lambda functions that watch for certain types",
    "start": "1627400",
    "end": "1633309"
  },
  {
    "text": "of actions and so we can actually respond back whether that be paging some type of on-call team sending a slack",
    "start": "1633309",
    "end": "1640660"
  },
  {
    "text": "message or actually doing some auto remediation against it to fix itself so",
    "start": "1640660",
    "end": "1645820"
  },
  {
    "text": "you're in real-time responding you can also build profiles of your users if you know that your team shouldn't be",
    "start": "1645820",
    "end": "1651910"
  },
  {
    "text": "deploying servers outside of work hours you can program this into a lot of your functionality and see what's happening",
    "start": "1651910",
    "end": "1658150"
  },
  {
    "text": "and taking place you know you the attacker you know is gonna be doing stuff at different times",
    "start": "1658150",
    "end": "1663220"
  },
  {
    "text": "and you can slowly see what's going on there this will also let you track users that have permissions that things they",
    "start": "1663220",
    "end": "1668860"
  },
  {
    "text": "shouldn't have access to you'd let you track it did you remove that users ability to do certain actions once they",
    "start": "1668860",
    "end": "1675370"
  },
  {
    "text": "change teams and so we have those there but it's important that we can subscribe to this and then we can get into that",
    "start": "1675370",
    "end": "1680799"
  },
  {
    "text": "more real-time Blue Team type effective responding to the events as they happen",
    "start": "1680799",
    "end": "1686910"
  },
  {
    "text": "okay so that's our I am the next was secrets so I messed up really bad on",
    "start": "1686910",
    "end": "1692860"
  },
  {
    "text": "secrets I mean she have them in plain text so we're gonna talk about secret management now Amazon released AWS",
    "start": "1692860",
    "end": "1699100"
  },
  {
    "text": "secrets manager we're not going to talk about that that tools designed more for an RDS type application it's a great",
    "start": "1699100",
    "end": "1705309"
  },
  {
    "text": "tool we're gonna focus on ec2 parameter store for secrets when using these just",
    "start": "1705309",
    "end": "1711580"
  },
  {
    "text": "look at what use case works better for you in the example that we're using this one works a little bit better for us so",
    "start": "1711580",
    "end": "1717940"
  },
  {
    "text": "easy to parameter stores a secure location for us to store things anything from key value stores to secrets it's",
    "start": "1717940",
    "end": "1726790"
  },
  {
    "text": "all controlled access wise by iam so we can manage who can that's it and who can't and so we can",
    "start": "1726790",
    "end": "1734100"
  },
  {
    "text": "set things up the nice thing is also integrates tightly with kms so we can encrypt the data that sits inside of it",
    "start": "1734100",
    "end": "1740129"
  },
  {
    "text": "which is perfect for secrets so what we can do is we can actually then also take it one step further since its I am and",
    "start": "1740129",
    "end": "1746879"
  },
  {
    "text": "do segregation of duties we can build rules that let database administrators cede credentials into the store lets",
    "start": "1746879",
    "end": "1754440"
  },
  {
    "text": "them encrypt it but doesn't let them pull data out we then can roll out instances that have roles attached to",
    "start": "1754440",
    "end": "1760409"
  },
  {
    "text": "them that has the ability to pull credentials out and also decrypt it and so we're able to this control that and",
    "start": "1760409",
    "end": "1767249"
  },
  {
    "text": "what's nice we control it two levels at the parameter level and then also the ability to leverage the kms keys for",
    "start": "1767249",
    "end": "1773369"
  },
  {
    "text": "encryption and decryption and so we can actually protect the credentials and know what's going on here the other nice",
    "start": "1773369",
    "end": "1780360"
  },
  {
    "text": "things because using I am all of the actions are tracked in cloud trail so we can watch what's happening so if",
    "start": "1780360",
    "end": "1786679"
  },
  {
    "text": "credentials are being seated at weird times in the night when you know you're DBAs aren't online or your ITR you know",
    "start": "1786679",
    "end": "1794490"
  },
  {
    "text": "team is online doing that you can respond accordingly you can also track what instances are getting secrets out",
    "start": "1794490",
    "end": "1800610"
  },
  {
    "text": "so you can track and say okay well that instance no longer needs a secret we need to adjust those iam rules in order",
    "start": "1800610",
    "end": "1806399"
  },
  {
    "text": "to make sure that instance really is acting under the most minimum amount of permissions possible for it to do its",
    "start": "1806399",
    "end": "1812159"
  },
  {
    "text": "job so again just an example of what this looks like so left sides the file Terry",
    "start": "1812159",
    "end": "1817320"
  },
  {
    "text": "showed you right it's got the password in it the right side is the new file no password in it and it's pretty minimal",
    "start": "1817320",
    "end": "1823259"
  },
  {
    "text": "amount of work to get this set up and Python it's only three lines of code for us to set this up so we just call into",
    "start": "1823259",
    "end": "1829860"
  },
  {
    "text": "the parameter store we can pull the data out and you leverage it for our application and use it and if we look at",
    "start": "1829860",
    "end": "1835889"
  },
  {
    "text": "the AWS console it's there and based off your console access you can either see or not see the credential so it's also",
    "start": "1835889",
    "end": "1842309"
  },
  {
    "text": "nice is for those people that are using IT teams to see you know store secrets they have a console that they can go in",
    "start": "1842309",
    "end": "1848190"
  },
  {
    "text": "and do this so the encryptions managed by KMS we get all the nice KMS features",
    "start": "1848190",
    "end": "1853559"
  },
  {
    "text": "of key rotation in the backend you know that come for free with that that we don't have to to manage so to do this is",
    "start": "1853559",
    "end": "1860429"
  },
  {
    "text": "fairly minimal amount of work it's not a lot of extra code and we're able to make this quick change",
    "start": "1860429",
    "end": "1866180"
  },
  {
    "text": "and now she no longer has the database secrets especially with you know us",
    "start": "1866180",
    "end": "1871310"
  },
  {
    "text": "discovering you know that lambda link is public for a set amount of time you know so people can't go in and download that",
    "start": "1871310",
    "end": "1878770"
  },
  {
    "text": "so now let's discuss some more of the monitoring side of things so those are those previous ones cover some of the",
    "start": "1878770",
    "end": "1885110"
  },
  {
    "text": "proactive stuff we can do let's talk about more of the reactive stuff to do so for monitoring the big one that we",
    "start": "1885110",
    "end": "1890750"
  },
  {
    "text": "can start leveraging is guard duty so who in the room uses guard duty it's an",
    "start": "1890750",
    "end": "1896450"
  },
  {
    "text": "awesome tool we released I think last year at Raymond and so guard duty is gonna analyze VPC flow logs DNS logs and",
    "start": "1896450",
    "end": "1904130"
  },
  {
    "text": "your cloud trail logs I'm gonna build a profile on your account of actual usage and then start",
    "start": "1904130",
    "end": "1910280"
  },
  {
    "text": "alerting based off of anomalies outside of that regular usage it also has a set of heuristics programmed into it that it",
    "start": "1910280",
    "end": "1917510"
  },
  {
    "text": "will watch for like brute-force attempts and things like that it learns your account for the first 30 days and then",
    "start": "1917510",
    "end": "1924410"
  },
  {
    "text": "after there it builds a profile that's really interesting so it learns your account for the first 30 days so don't do it we did and set up an account and",
    "start": "1924410",
    "end": "1931160"
  },
  {
    "text": "don't log into it for 30 days because on 31 days guard duty lets you know that",
    "start": "1931160",
    "end": "1936620"
  },
  {
    "text": "something's going on that's not right so you have that again for monitoring with",
    "start": "1936620",
    "end": "1943130"
  },
  {
    "text": "guard duty it's like all the rest of the tools there's an event stream that you can subscribe to she can watch the guard",
    "start": "1943130",
    "end": "1948290"
  },
  {
    "text": "duty alerts come off and then do actions against those whether that's just simple paging posting to slack or actually",
    "start": "1948290",
    "end": "1955730"
  },
  {
    "text": "building some type of remediation process in order to handle the exploit other monitoring as we talked about is",
    "start": "1955730",
    "end": "1963020"
  },
  {
    "text": "look at cloud trail DPC flow logs are a good tool to make sure you know where all your traffic is going you know you",
    "start": "1963020",
    "end": "1970280"
  },
  {
    "text": "should see profiles that look correct AWS configs an awesome tool to watch",
    "start": "1970280",
    "end": "1975410"
  },
  {
    "text": "your account watch and make sure no changes are taking place and either rollback or alert you based off that and",
    "start": "1975410",
    "end": "1981830"
  },
  {
    "text": "then some non AWS monitoring thing you know make sure you ship your logs you're watching your logs securely backing",
    "start": "1981830",
    "end": "1987560"
  },
  {
    "text": "those logs up they're gonna have information for you that you can work on and then leverage any type of automated",
    "start": "1987560",
    "end": "1993530"
  },
  {
    "text": "remediation as possible so village of you haven't used is the guard duty console just for",
    "start": "1993530",
    "end": "1999600"
  },
  {
    "text": "everybody to see so here's what's going on there it builds these profiles and it",
    "start": "1999600",
    "end": "2005270"
  },
  {
    "text": "shows a lot of really cool information you know by defaults gonna track like",
    "start": "2005270",
    "end": "2010850"
  },
  {
    "text": "SSH brute-force attacks so you actually get to see how many people are trying to get into your stuff it's really makes it",
    "start": "2010850",
    "end": "2017270"
  },
  {
    "text": "a really good point for why you don't publicly expose SSH it'll help find if there's crypto mining",
    "start": "2017270",
    "end": "2023600"
  },
  {
    "text": "type actions taking place in the account which is a fun exploit if anybody's had their account compromised for that one the rack up bills real quick and you can",
    "start": "2023600",
    "end": "2032030"
  },
  {
    "text": "watch those things again alert blackhole those instances for forensics later or just delete them and get rid of them as",
    "start": "2032030",
    "end": "2038360"
  },
  {
    "text": "needed AWS just have some tools to to",
    "start": "2038360",
    "end": "2043670"
  },
  {
    "text": "handle like CVE actions so this is if you're not using immutable",
    "start": "2043670",
    "end": "2048919"
  },
  {
    "text": "infrastructure they have a system manager which will go through and let you patch your systems through a very",
    "start": "2048919",
    "end": "2055399"
  },
  {
    "text": "nice automated method and so you can have it you know create profiles and",
    "start": "2055400",
    "end": "2060620"
  },
  {
    "text": "documents that go through and patch the systems again this works the same way",
    "start": "2060620",
    "end": "2065780"
  },
  {
    "text": "that parameter store works where I am controls all of the access to this so you can do two party type creation of",
    "start": "2065780",
    "end": "2071960"
  },
  {
    "text": "those documents and make sure you understand what's going into those and then limiting which instances can talk to which things storing secrets in the",
    "start": "2071960",
    "end": "2078050"
  },
  {
    "text": "parameter store so that you can leverage those later we can also leverage AWS inspector to scan our account and what's",
    "start": "2078050",
    "end": "2085100"
  },
  {
    "text": "nice is again like I've said a few times now is there's an event stream that we can subscribe to that we can trigger",
    "start": "2085100",
    "end": "2090800"
  },
  {
    "text": "system manager calls out of so we can actually use inspector to trigger our",
    "start": "2090800",
    "end": "2096290"
  },
  {
    "text": "auto updates to patch our system if you're running immutable infrastructure the system manager ones probably not as",
    "start": "2096290",
    "end": "2102970"
  },
  {
    "text": "important to you but inspector can trigger a role of all your instances if",
    "start": "2102970",
    "end": "2108020"
  },
  {
    "text": "you're running immutable and bring on new patched up-to-date instances so that you're protected there and so again",
    "start": "2108020",
    "end": "2114530"
  },
  {
    "text": "these two tools are here and available for people to run and really protect their systems and be more proactive so",
    "start": "2114530",
    "end": "2121400"
  },
  {
    "text": "as Terry scanning the environment trying to find those CDs and those exploits we have something in the background running",
    "start": "2121400",
    "end": "2127640"
  },
  {
    "text": "the whole time scanning and protecting our own ass in order to make sure that harry can't",
    "start": "2127640",
    "end": "2133440"
  },
  {
    "text": "get the data off the other problem we ran into choose protecting external",
    "start": "2133440",
    "end": "2140849"
  },
  {
    "text": "facing resources right so terry was able to exploit wordpress which is a fun one to exploit so there's a whole suite of",
    "start": "2140849",
    "end": "2148530"
  },
  {
    "text": "tools and some cool things here that we can do that's actually very straightforward very simple so here we",
    "start": "2148530",
    "end": "2153720"
  },
  {
    "text": "get CloudFront this is kind of the core of what we have running here and CloudFront is amazon",
    "start": "2153720",
    "end": "2159270"
  },
  {
    "text": "CDN and in front of cloud fronts that shield so we get some DDoS protection so that someone can't just DDoS the account",
    "start": "2159270",
    "end": "2165930"
  },
  {
    "text": "cause overflows are weird things to happen but we can also attack on laughs the Web Application Firewall so we can",
    "start": "2165930",
    "end": "2173550"
  },
  {
    "text": "protect against those sequel injections cross-site scripting actions we can auto",
    "start": "2173550",
    "end": "2178800"
  },
  {
    "text": "block any type of nefarious IP address that exists these are auto-updating black lists we can create our own black",
    "start": "2178800",
    "end": "2185880"
  },
  {
    "text": "lists so that IPS that are hitting our system at rates that are not acceptable they can get auto blacklisted for",
    "start": "2185880",
    "end": "2192109"
  },
  {
    "text": "permanent or sets amount of time and we can turn those on and so that provides a nice layer of separation it also",
    "start": "2192109",
    "end": "2199680"
  },
  {
    "text": "separates your infrastructure from the internet because this is all handled through secure networking on Amazon side",
    "start": "2199680",
    "end": "2205589"
  },
  {
    "text": "and so people aren't actually hitting directly to your infrastructure they're going through some layers some proxy",
    "start": "2205589",
    "end": "2211650"
  },
  {
    "text": "layers the other tool that people don't tend to think about and really we didn't think about until we were diving more on",
    "start": "2211650",
    "end": "2217859"
  },
  {
    "text": "this as ELB ELB is actually a fairly decent security tool it provides a layer",
    "start": "2217859",
    "end": "2223349"
  },
  {
    "text": "of separation it only does one thing it just load balances the traffic coming in and only load balances the traffic you",
    "start": "2223349",
    "end": "2229770"
  },
  {
    "text": "want coming in and so leveraging ELB to protect your infrastructure also you know adds that extra layer of separation",
    "start": "2229770",
    "end": "2236790"
  },
  {
    "text": "between your infrastructure and the public internet and so that's a it's an easy tool to use also so now with",
    "start": "2236790",
    "end": "2245580"
  },
  {
    "text": "network architecture okay and so the other thing that we saw is terry had the",
    "start": "2245580",
    "end": "2251910"
  },
  {
    "text": "ability to pivot pretty badly within our set up and so we have some network architecture guidelines that we didn't",
    "start": "2251910",
    "end": "2258210"
  },
  {
    "text": "follow you know we have this you know your traditional three-tier architecture model where you're really trying to",
    "start": "2258210",
    "end": "2263790"
  },
  {
    "text": "protect your database layers so that your front-end layers aren't ever talking to them directly we also like to in a true",
    "start": "2263790",
    "end": "2270059"
  },
  {
    "text": "this archetype of architecture really limit the access between those layers whether that be knackles or security",
    "start": "2270059",
    "end": "2275700"
  },
  {
    "text": "groups or firewall rules of some sorts so that things are only talking to what they need to talk to and then finally we",
    "start": "2275700",
    "end": "2282660"
  },
  {
    "text": "need to probably limit outbound traffic so that things that don't need to talk to the internet don't talk to the Internet I mean it's not needed and so",
    "start": "2282660",
    "end": "2290490"
  },
  {
    "text": "we can protect things there so here's a picture of our original architecture we",
    "start": "2290490",
    "end": "2296579"
  },
  {
    "text": "had wide open knackles way wide open as you saw there was a zeros all over the place right security groups I mean I set",
    "start": "2296579",
    "end": "2304829"
  },
  {
    "text": "it up not like pretending like I didn't know networking so I just white listed what was easy was my V PC subnet right",
    "start": "2304829",
    "end": "2310589"
  },
  {
    "text": "that should be safe that's my network right and so we were able to see the",
    "start": "2310589",
    "end": "2315660"
  },
  {
    "text": "security groups allowed the whole full the V PC cider out of that there was a",
    "start": "2315660",
    "end": "2320819"
  },
  {
    "text": "lot of a lateral transition and a lot of movement that was able to take place she was able to go from services that I",
    "start": "2320819",
    "end": "2327180"
  },
  {
    "text": "thought were only talking to each other to services I didn't know could talk to each other by taking the WordPress site directly to the database so this is not",
    "start": "2327180",
    "end": "2333990"
  },
  {
    "text": "a good architecture it's pretty wide open and you know fairly easy to get around we also let all outbound traffic",
    "start": "2333990",
    "end": "2340829"
  },
  {
    "text": "so I wasn't protecting anything going out right I was letting it all come out of the network and not doing anything so",
    "start": "2340829",
    "end": "2348119"
  },
  {
    "text": "we can go to a better architecture though and really try to fit into this three layer network architecture so",
    "start": "2348119",
    "end": "2354089"
  },
  {
    "text": "we're just a three layer but we all know WordPress doesn't really fit a three layer architecture very well because",
    "start": "2354089",
    "end": "2359430"
  },
  {
    "text": "it's presentation application the same layer but we can still kind of fit it in here and protect things so here what",
    "start": "2359430",
    "end": "2365940"
  },
  {
    "text": "we've done is set up three distinct subnets and had very strong knackles",
    "start": "2365940",
    "end": "2371010"
  },
  {
    "text": "between all of them and in that case the front-end subnet the first time that was only allowed to talk to the second one",
    "start": "2371010",
    "end": "2377520"
  },
  {
    "text": "and vice-versa the second subnet was only allowed to talk to you the database layer and the",
    "start": "2377520",
    "end": "2383940"
  },
  {
    "text": "front-end layer and then our database layer was only allowing traffic inbound to it from the application layer the",
    "start": "2383940",
    "end": "2389790"
  },
  {
    "text": "middle layer here we also cleaned up our security groups so as opposed to just",
    "start": "2389790",
    "end": "2395190"
  },
  {
    "text": "allowing all traffic from the VP we trusted only traffic from specific",
    "start": "2395190",
    "end": "2400520"
  },
  {
    "text": "security groups and so our RDS database for wordpress only allow traffic from",
    "start": "2400520",
    "end": "2405830"
  },
  {
    "text": "the wordpress security group i was the only thing that could take place there our RDS database the super-secret DB",
    "start": "2405830",
    "end": "2413000"
  },
  {
    "text": "only allow traffic from the lambda security group so the WordPress site was no longer able to access directly to the",
    "start": "2413000",
    "end": "2420680"
  },
  {
    "text": "super-secret DB we had knackles in place protecting it we had security groups in place protecting it to make sure things",
    "start": "2420680",
    "end": "2427370"
  },
  {
    "text": "couldn't get back there and so we were able to really limit the amount of pivoting that could take place in the",
    "start": "2427370",
    "end": "2432740"
  },
  {
    "text": "account the other thing we've done is we've blocked internet so a lot of the Amazon resources don't need internet",
    "start": "2432740",
    "end": "2439760"
  },
  {
    "text": "because uh all of the loading and all the stuff happens behind the scenes in Amazon's infrastructure lambdas in the",
    "start": "2439760",
    "end": "2446750"
  },
  {
    "text": "subnet don't need internet access RDS databases don't need internet access so",
    "start": "2446750",
    "end": "2452720"
  },
  {
    "text": "we cut off internet access to a lot of those resources so that they're not able to exfil data directly and really",
    "start": "2452720",
    "end": "2459830"
  },
  {
    "text": "minimize and locked it down and now if we turn on V PC full locks we should see things only behaving this way we can",
    "start": "2459830",
    "end": "2466880"
  },
  {
    "text": "then monitor those react to those and say okay these things are talking they shouldn't be talking and be able to",
    "start": "2466880",
    "end": "2473600"
  },
  {
    "text": "respond pretty quickly to those types of incidents all right so what have we",
    "start": "2473600",
    "end": "2480920"
  },
  {
    "text": "shown you today we have shown you that attackers can use the same tools that",
    "start": "2480920",
    "end": "2486230"
  },
  {
    "text": "your DevOps teams are using those are very powerful tools and they allow you to do a lot of really cool things",
    "start": "2486230",
    "end": "2491480"
  },
  {
    "text": "if attackers can get your credentials they can do those cool things to the cloud api's can really help you map out",
    "start": "2491480",
    "end": "2499370"
  },
  {
    "text": "what is in the account and what you can attack and how its configured and that information is very useful for us",
    "start": "2499370",
    "end": "2505700"
  },
  {
    "text": "hackers who's trying to figure out how they can get at your data and how they can get at your systems then we showed",
    "start": "2505700",
    "end": "2512120"
  },
  {
    "text": "you that read-only access seems innocuous right but it can be very powerful it can give me a lot of",
    "start": "2512120",
    "end": "2517490"
  },
  {
    "text": "information as to how I can attack your account and then finally wide open",
    "start": "2517490",
    "end": "2523400"
  },
  {
    "text": "networks are a very powerful tool for an attacker if they make it very easy to",
    "start": "2523400",
    "end": "2528920"
  },
  {
    "text": "traverse the network and from one system to another called pivoting and so showed you how you can",
    "start": "2528920",
    "end": "2534320"
  },
  {
    "text": "do some of that if the network is misconfigured then from the blue team perspective restrict access minimize the",
    "start": "2534320",
    "end": "2541280"
  },
  {
    "text": "amount of stuff people can get to and have those lock down you know to the bare minimum amount of rolls automate",
    "start": "2541280",
    "end": "2547700"
  },
  {
    "text": "the deployments we talked about a lot of Auto remediation the more you run automation the less likely you're gonna",
    "start": "2547700",
    "end": "2553460"
  },
  {
    "text": "introduce some type of human error drift into the config and if it's all automated you can just keep running it",
    "start": "2553460",
    "end": "2558770"
  },
  {
    "text": "over and over and over again to make sure your configuration stays the same architecture networks to minimize open",
    "start": "2558770",
    "end": "2565160"
  },
  {
    "text": "ports for pivoting so make sure that things can only talk to things that you",
    "start": "2565160",
    "end": "2570680"
  },
  {
    "text": "want them to talk to you we're not able to cross boundaries where we don't want boundaries crossed protect your secrets",
    "start": "2570680",
    "end": "2577250"
  },
  {
    "text": "don't embed them in code just because I stored that lambda function in a cryptid s3 bucket with a kms key that I managed",
    "start": "2577250",
    "end": "2584510"
  },
  {
    "text": "you know lambda creates a link that's good for a certain amount of time protect your secrets don't put them",
    "start": "2584510",
    "end": "2589910"
  },
  {
    "text": "there there's tools available it's not difficult to start implementing and leveraging those tools to pull those",
    "start": "2589910",
    "end": "2595220"
  },
  {
    "text": "secret's out securely ok and then monitor everything Amazon has a ton of",
    "start": "2595220",
    "end": "2600830"
  },
  {
    "text": "monitoring tools built into it a ton of event-driven ability with the event streams that you can subscribe to and",
    "start": "2600830",
    "end": "2607610"
  },
  {
    "text": "then auto remediate a lot of those actions and so monitor everything and make sure it's all there",
    "start": "2607610",
    "end": "2614410"
  },
  {
    "text": "so we just both want to thank you all for coming to our talk you can reach terry on twitter at terry ridicul or me",
    "start": "2614410",
    "end": "2622190"
  },
  {
    "text": "at kholby alan we're here to answer any questions that you guys have and thank",
    "start": "2622190",
    "end": "2627440"
  },
  {
    "text": "you again [Applause]",
    "start": "2627440",
    "end": "2639150"
  }
]