[
  {
    "start": "0",
    "end": "320000"
  },
  {
    "text": "hey there everybody my name is Tim Bray and I'm a senior engineer here at Amazon Web Services and this is our fourth",
    "start": "30",
    "end": "6509"
  },
  {
    "text": "session on messaging technologies the range that we offer what you might use them for and so on today we're going to",
    "start": "6509",
    "end": "13559"
  },
  {
    "text": "be talking about the use of large scale messaging technology mostly sqs in the",
    "start": "13559",
    "end": "19350"
  },
  {
    "text": "BBC British Broadcasting Corporation and we have with us all the way eight time zones away from London",
    "start": "19350",
    "end": "25080"
  },
  {
    "text": "Stephen Godwin and Chris Darlington from the BBC and before we proceed with",
    "start": "25080",
    "end": "30269"
  },
  {
    "text": "introductions and so on just a reminder that this is twitch it's it's interactive and if there's anything you'd like to ask us about streaming or",
    "start": "30269",
    "end": "37590"
  },
  {
    "text": "broadcasting or really anything at all drop it into the twitch and we'll probably see it and get back to you",
    "start": "37590",
    "end": "44430"
  },
  {
    "text": "under no circumstances are our guests prepared to discuss the Royal Wedding however so gentlemen perhaps you could",
    "start": "44430",
    "end": "50700"
  },
  {
    "text": "introduce yourselves and tell people how you fit into the picture over at the BBC",
    "start": "50700",
    "end": "56000"
  },
  {
    "text": "I'm Christopher Dalston I'm the development lead on the broadcast",
    "start": "56030",
    "end": "62609"
  },
  {
    "text": "interactive data service on TVs and my team is responsible for helping getting",
    "start": "62609",
    "end": "70260"
  },
  {
    "text": "the journalistic content from some internal tools through our AWS estate",
    "start": "70260",
    "end": "76560"
  },
  {
    "text": "and then out through our broadcast and transmission system where ultimately it",
    "start": "76560",
    "end": "83009"
  },
  {
    "text": "makes its way to TV sets across the UK where it can then be viewed I and I'm",
    "start": "83009",
    "end": "90810"
  },
  {
    "text": "Stephen Godwin I'm a lead architect to the BBC and I helped design the systems",
    "start": "90810",
    "end": "96210"
  },
  {
    "text": "that make the audio and video content from the BBC available online cool",
    "start": "96210",
    "end": "101490"
  },
  {
    "text": "excellent now in Canada when we think of the BBC one of the big things we think about is of course Doctor Who and I have",
    "start": "101490",
    "end": "107670"
  },
  {
    "text": "here with me a little set of Doctor Who lego hound assembled by our own Jeff bar for the very first show in this series",
    "start": "107670",
    "end": "114060"
  },
  {
    "text": "and since we're on twitch and talking about the BBC and Doctor Who I suggest that if you care about that kind of",
    "start": "114060",
    "end": "120180"
  },
  {
    "text": "stuff you go and type BBC twitch into your favorite search engine and you will",
    "start": "120180",
    "end": "125189"
  },
  {
    "text": "discover that we have just twitch has just made a deal with with the BBC to",
    "start": "125189",
    "end": "130890"
  },
  {
    "text": "broadcast what does it say 100 classic Doctor Who episodes all of them between 1963 and 1989 on Twitch and it's",
    "start": "130890",
    "end": "138540"
  },
  {
    "text": "gonna go on for seven weeks if your if your sign up says can take that so so good luck with that",
    "start": "138540",
    "end": "144080"
  },
  {
    "text": "okay now in this today we're going to be talking about messaging technologies and",
    "start": "144080",
    "end": "149220"
  },
  {
    "text": "mostly sqs so I'm going to assume that most of the people watching this know what sqs is but probably for I should",
    "start": "149220",
    "end": "156450"
  },
  {
    "text": "outline it for the sake of those who may not so so very very briefly sqs is one",
    "start": "156450",
    "end": "161610"
  },
  {
    "text": "of our very oldest Amazon Web Services it's like twelve years old these days and it's the simplest thing imaginable",
    "start": "161610",
    "end": "168000"
  },
  {
    "text": "you have queues you can create as many queues as you want and there are really only three interesting api's send a",
    "start": "168000",
    "end": "174329"
  },
  {
    "text": "message receive a message delete a message that's all there is to it one of",
    "start": "174329",
    "end": "179640"
  },
  {
    "text": "the ways it differs from some other messaging services is that it's accepted",
    "start": "179640",
    "end": "184950"
  },
  {
    "text": "and normal to have multiple readers reading from a queue but it's not the case that they all see all the messages",
    "start": "184950",
    "end": "190290"
  },
  {
    "text": "each of them see a subset of the messages they read a message they are they're deleted and what guess it's gone or they timeout or something like that",
    "start": "190290",
    "end": "196560"
  },
  {
    "text": "which case eventually somebody else will pick it up xq s is super highly reliable",
    "start": "196560",
    "end": "201720"
  },
  {
    "text": "you will not lose the message once it goes on on sqs and extremely scalable you know during hot days we observe",
    "start": "201720",
    "end": "211519"
  },
  {
    "text": "messages running through it at the rate of millions per second and that's fine in fact these days serverless is sort of",
    "start": "211519",
    "end": "217980"
  },
  {
    "text": "the hot new thing in town and if you think about it sqs is sort of a canonical example of what a serverless",
    "start": "217980",
    "end": "223650"
  },
  {
    "text": "service should be like because you don't have to pre reserve any capacity you don't have to do any kind of that kind",
    "start": "223650",
    "end": "229650"
  },
  {
    "text": "of planning you just say create a queue start sending messages to it if you're sending ten messages a second that's",
    "start": "229650",
    "end": "234870"
  },
  {
    "text": "fine if you're sending 10,000 messages a second that's fine and you can switch from ten messages to 10,000 pretty well",
    "start": "234870",
    "end": "242099"
  },
  {
    "text": "at the drop of a hat so that's what I think you know we'd like our elastic serverless cloud to feel like and even",
    "start": "242099",
    "end": "247650"
  },
  {
    "text": "though sqs is old it still feels pretty modern in practice oh and yes I'd the",
    "start": "247650",
    "end": "252810"
  },
  {
    "text": "other thing I should say is SQS classically does not promise first-in first-out it is not promised you will",
    "start": "252810",
    "end": "258060"
  },
  {
    "text": "receive things in the same order that they were sent nor does it promise that you will receive something only once so",
    "start": "258060",
    "end": "264270"
  },
  {
    "text": "they're just a year ago now I guess we introduced s spiteful which is not quite as massively",
    "start": "264270",
    "end": "269580"
  },
  {
    "text": "scalable as sqs classic but it does make those promises you can arrange that things are processed exactly once and",
    "start": "269580",
    "end": "275820"
  },
  {
    "text": "that they will arrive in the order that they were sent and and that's interesting in a lot of cases okay",
    "start": "275820",
    "end": "281940"
  },
  {
    "text": "enough about that so I think today we're going to be looking at two different applications from the BBC the one is",
    "start": "281940",
    "end": "287700"
  },
  {
    "text": "called video Factory and secondly the red button now to those of us in the new",
    "start": "287700",
    "end": "292980"
  },
  {
    "text": "world in Asia the red button may be sound a little puzzling but I guarantee you that most people in Britain know",
    "start": "292980",
    "end": "298110"
  },
  {
    "text": "exactly what we're talking about and stay with us for a few minutes and you will too so let's start with Stephen in",
    "start": "298110",
    "end": "304230"
  },
  {
    "text": "the media factory problem by the way there was a presentation on this reinvent easy enough to find on YouTube",
    "start": "304230",
    "end": "310200"
  },
  {
    "text": "just go type BBC godwyn into into into YouTube and it'll pop right up so",
    "start": "310200",
    "end": "317130"
  },
  {
    "text": "Stephen what is media Factory what did you need to do with it so media Factory",
    "start": "317130",
    "end": "322590"
  },
  {
    "start": "320000",
    "end": "608000"
  },
  {
    "text": "is the system that basically powers all our online video and audio content it's",
    "start": "322590",
    "end": "331550"
  },
  {
    "text": "soap ad systems like BBC iPlayer and our news clips behind behind the scenes it's",
    "start": "331550",
    "end": "340080"
  },
  {
    "text": "responsible for let me think it's",
    "start": "340080",
    "end": "345690"
  },
  {
    "text": "responsible for sort of putting it's responsible for taking files that come in in this sort high-res high bitrate",
    "start": "345690",
    "end": "352740"
  },
  {
    "text": "format and turning them into all the different formats we need for things",
    "start": "352740",
    "end": "359760"
  },
  {
    "text": "like iPhones and Android phones or Smart TVs tablets PCs Macs all these different",
    "start": "359760",
    "end": "369210"
  },
  {
    "text": "formats you can imagine that the format you use for something like a smartphone is very different to what you'd use for",
    "start": "369210",
    "end": "376590"
  },
  {
    "text": "a smart TV because the sizes of the screens and so on and then it puts those files where they can be accessed by the",
    "start": "376590",
    "end": "383669"
  },
  {
    "text": "player and distributed easily out fire things like see the ends we we actually",
    "start": "383669",
    "end": "390390"
  },
  {
    "text": "support over a thousand different devices for iPlayer and on a typical",
    "start": "390390",
    "end": "395940"
  },
  {
    "text": "week this system we'll process over 10,000 hours of content so it's it's quite a busy system",
    "start": "395940",
    "end": "403040"
  },
  {
    "text": "and up on screen now you can see this is the I play user interface I can't",
    "start": "403040",
    "end": "409130"
  },
  {
    "text": "actually play any video for you because most of our video is limited to being available in the UK but I think we do",
    "start": "409130",
    "end": "416810"
  },
  {
    "text": "have a little bit video that shows you sort of user journeys you might get an AI player if we can switch to the video",
    "start": "416810",
    "end": "424610"
  },
  {
    "text": "oh there it is",
    "start": "424610",
    "end": "432909"
  },
  {
    "text": "so what are we looking up there Stephen so this is the main I player homepage that you'd see on a PC if you would have",
    "start": "434990",
    "end": "441509"
  },
  {
    "text": "coming into our web browser you can see we've got some box sets up there of content going into one and I'm just",
    "start": "441509",
    "end": "450509"
  },
  {
    "text": "looking at details like I say I'm sorry I can't play and actually show you the player but then we've got all our",
    "start": "450509",
    "end": "456029"
  },
  {
    "text": "different TV stations up there so one of our TV stations BBC three is actually",
    "start": "456029",
    "end": "461159"
  },
  {
    "text": "online only this is BBC one and here you could actually watch what's currently",
    "start": "461159",
    "end": "466889"
  },
  {
    "text": "being broadcast live on BBC one or in fact we've got a rewind window so you can actually rewind to the beginning of",
    "start": "466889",
    "end": "472559"
  },
  {
    "text": "the currently prior playing program or up to two hours and watch that so yeah",
    "start": "472559",
    "end": "478889"
  },
  {
    "text": "it's used quite extensively inside the UK I think rough figures it's regularly",
    "start": "478889",
    "end": "484830"
  },
  {
    "text": "used by about 30% of adults in the UK so it's quite quite heavily used system do",
    "start": "484830",
    "end": "492689"
  },
  {
    "text": "we have the CBC of course and it's got some of this stuff but not nearly as slick this is this is great-looking stuff so so let's zero in on the",
    "start": "492689",
    "end": "499499"
  },
  {
    "text": "messaging technology I what was the problem you needed to solve with the messaging technology and why was it hard and and where did you end up so the",
    "start": "499499",
    "end": "511139"
  },
  {
    "text": "problem we had was we wanted to rebuild the systems that were powering BBC",
    "start": "511139",
    "end": "517500"
  },
  {
    "text": "iPlayer and get them on to get them up",
    "start": "517500",
    "end": "522560"
  },
  {
    "text": "get them into the cloud and so we were looking at sort of messaging",
    "start": "522560",
    "end": "527940"
  },
  {
    "text": "technologies that would work well in the cloud and particularly for our sort of",
    "start": "527940",
    "end": "533040"
  },
  {
    "text": "scenarios then we wanted to be able to be certain that a message wouldn't get",
    "start": "533040",
    "end": "539730"
  },
  {
    "text": "lost and you were talking about the reliability of sqs in your introduction and you know that's really important to",
    "start": "539730",
    "end": "545250"
  },
  {
    "text": "us here because each message represents a piece of work so each message a message could represent giving a piece",
    "start": "545250",
    "end": "550980"
  },
  {
    "text": "of Doctor Who up onto iPlayer and if that message got lost then people would get very upset with me",
    "start": "550980",
    "end": "557449"
  },
  {
    "text": "so that needs you know needs to have that degree of reliability and we also",
    "start": "557449",
    "end": "563459"
  },
  {
    "text": "needed the system to not be overwhelmed we sometimes get big peeks of video coming through for",
    "start": "563459",
    "end": "571790"
  },
  {
    "text": "processing so a whole load of content for the next couple of weeks might arrive in one evening and so suddenly",
    "start": "571790",
    "end": "579209"
  },
  {
    "text": "we've got hundreds of files to process and we wanted to be able to scale up our",
    "start": "579209",
    "end": "585899"
  },
  {
    "text": "systems to be able to cope when those sorts of things happens not only did we need sqs or whichever messaging system",
    "start": "585899",
    "end": "592320"
  },
  {
    "text": "we chose to be able to cope with those Peaks but we needed to be able to have a",
    "start": "592320",
    "end": "597600"
  },
  {
    "text": "good way of being able to scale up our systems to also cope with that and mean",
    "start": "597600",
    "end": "603240"
  },
  {
    "text": "that it wouldn't take forever for us to get through that backlog so we designed",
    "start": "603240",
    "end": "608820"
  },
  {
    "start": "608000",
    "end": "990000"
  },
  {
    "text": "the system and I'll move on - I've got an architecture diagram here we designed the system as a set of small surfaces of",
    "start": "608820",
    "end": "616260"
  },
  {
    "text": "micro-services all linked together via sqs or a combination of SNS and SQS",
    "start": "616260",
    "end": "623160"
  },
  {
    "text": "so we used SNS where there are other people who would be interested in the",
    "start": "623160",
    "end": "628350"
  },
  {
    "text": "events and then we would be one of them and we would subscribe and SQS queue to that event or if it was just two of our",
    "start": "628350",
    "end": "635220"
  },
  {
    "text": "components talking together we just talking to each other we just have an sqs queue between them and this enables",
    "start": "635220",
    "end": "640980"
  },
  {
    "text": "us to run these as lots of small java applications running on ec2 instances",
    "start": "640980",
    "end": "646079"
  },
  {
    "text": "and gives us quite enough scaling model which I'll talk about a little bit in a",
    "start": "646079",
    "end": "651959"
  },
  {
    "text": "moment now I hear a rumor that you had to build all this in nine months with your back to the wall yes yes so we",
    "start": "651959",
    "end": "660029"
  },
  {
    "text": "actually put this system we started building the system in January 2013 and",
    "start": "660029",
    "end": "666560"
  },
  {
    "text": "we didn't actually and we had a con we had a cup a contract that was going to",
    "start": "666560",
    "end": "672750"
  },
  {
    "text": "run out in September of 2013 so we decided we were going to move everything up to the cloud we're going",
    "start": "672750",
    "end": "678899"
  },
  {
    "text": "to rewrite it all in Java as well at the same time and we had nine months to do it in and if we didn't then iPlayer",
    "start": "678899",
    "end": "685860"
  },
  {
    "text": "stopped working which would have been fairly dramatic so it worked it went",
    "start": "685860",
    "end": "691170"
  },
  {
    "text": "very well we were into sort of migration and testing stage by August so it was",
    "start": "691170",
    "end": "698550"
  },
  {
    "text": "quite quite comfortable actually in the end but yeah it's pattern the work really well for us to the to our",
    "start": "698550",
    "end": "705750"
  },
  {
    "text": "listeners out there I don't actually recommend that approach I yeah yeah yeah",
    "start": "705750",
    "end": "712740"
  },
  {
    "text": "it was it was it was one of our first forays into the cloud as well so we did",
    "start": "712740",
    "end": "719040"
  },
  {
    "text": "all the hard things at once but it went very well so talk to these there's these diagrams",
    "start": "719040",
    "end": "727290"
  },
  {
    "text": "a bit yes so this this diagram shows our overall architecture it's actually this",
    "start": "727290",
    "end": "732990"
  },
  {
    "text": "is a simplification the original system we went live with was made up of over 20",
    "start": "732990",
    "end": "738180"
  },
  {
    "text": "micro services the system today does an awful lot more it does things like power",
    "start": "738180",
    "end": "744000"
  },
  {
    "text": "brick box which is a service which makes BBC and other British broadcaster",
    "start": "744000",
    "end": "750560"
  },
  {
    "text": "content from other British broadcasters available in the US and Canada and it",
    "start": "750560",
    "end": "757380"
  },
  {
    "text": "also now does radio and live programs and lots lots and lots of things so now",
    "start": "757380",
    "end": "763589"
  },
  {
    "text": "it's up to like 100 micro services but yeah he can see the system's linked",
    "start": "763589",
    "end": "768899"
  },
  {
    "text": "together by the queues we take video in from our broadcast feeds or we have it",
    "start": "768899",
    "end": "774569"
  },
  {
    "text": "pre delivered and we then have to sort of slice that video up if it's a live programme coming in off the broadcast",
    "start": "774569",
    "end": "780810"
  },
  {
    "text": "feed we have this time addressable media store where we can do that and we use",
    "start": "780810",
    "end": "787529"
  },
  {
    "text": "actually elementals platform as a service offering in the cloud to do the transcoding the original version we",
    "start": "787529",
    "end": "793199"
  },
  {
    "text": "built as a sort prototype we used ffmpeg but these days we use the elementals I use elementals platform as a service",
    "start": "793199",
    "end": "800010"
  },
  {
    "text": "offering we have a question from was it again oh I forget who it was I'll get",
    "start": "800010",
    "end": "806399"
  },
  {
    "text": "their name in a sec but they asked are you using the elastic transcoder service we not were actually so we using",
    "start": "806399",
    "end": "813899"
  },
  {
    "text": "elementals platform as a service offering which elemental are now an",
    "start": "813899",
    "end": "819209"
  },
  {
    "text": "Amazon company as well I believe so there's a little bit sort of duplication",
    "start": "819209",
    "end": "824939"
  },
  {
    "text": "there in functionality available we were elemental customers before before they were purchased so",
    "start": "824939",
    "end": "831279"
  },
  {
    "text": "we've been on that system for a little while and we have some quite specific requirements that's actually why we're",
    "start": "831279",
    "end": "837699"
  },
  {
    "text": "using that rather than ETS because our video will go out to things like set-top",
    "start": "837699",
    "end": "843459"
  },
  {
    "text": "boxes which are particularly fussy about the format of video they take because",
    "start": "843459",
    "end": "849490"
  },
  {
    "text": "they've been built down to a price and things like Smart TVs and things often will be a little bit fussy about there's",
    "start": "849490",
    "end": "856089"
  },
  {
    "text": "another question here from M Musset when they want to know the sort of aggregate throughput and concurrent connections",
    "start": "856089",
    "end": "861810"
  },
  {
    "text": "sqs and SNS is able to support for applications such as iPlayer now I know you probably aren't at liberty to give",
    "start": "861810",
    "end": "868449"
  },
  {
    "text": "exact numbers but have you ever run into a generally a capacity problem we",
    "start": "868449",
    "end": "874000"
  },
  {
    "text": "haven't run into a capacity problem with sqs or SNS I don't think although I need",
    "start": "874000",
    "end": "879009"
  },
  {
    "text": "to double-check I don't think we've ever we've even had to ask for limits to be raised but we are using quite a lot of",
    "start": "879009",
    "end": "884949"
  },
  {
    "text": "Q's and we certainly put a reasonable amount of the reasonable amount of messages through those queues so in fact",
    "start": "884949",
    "end": "893259"
  },
  {
    "text": "I said earlier in the intro on on days when we're running particularly hot like prime day or our Black Monday is it our",
    "start": "893259",
    "end": "900550"
  },
  {
    "text": "Black Friday one of those black days that thing is running at many millions of messages per second and I've seen sqs",
    "start": "900550",
    "end": "907870"
  },
  {
    "text": "queues that have over a billion messages saved up in them at a time so so you know this may not be a perfect an",
    "start": "907870",
    "end": "913779"
  },
  {
    "text": "entirely ideal piece of software but it's not going to run over the capacity I knew that that's one yeah yes so if I go on now I can talk a",
    "start": "913779",
    "end": "922029"
  },
  {
    "text": "little bit about how each one of those services is written so there are typically a Java service running on an",
    "start": "922029",
    "end": "929170"
  },
  {
    "text": "ec2 instance and it's you know the the average one would have just an input",
    "start": "929170",
    "end": "935529"
  },
  {
    "text": "queue and an output queue like this and it'll be a camel we use the camel framework for our java application about",
    "start": "935529",
    "end": "945130"
  },
  {
    "text": "a year ago and now it's crossing my radar all the time it seems to be a sort of a universal one layer of indirection",
    "start": "945130",
    "end": "951220"
  },
  {
    "text": "between application code and messaging infrastructure is that a fair way to talk about it yeah it gives you a couple",
    "start": "951220",
    "end": "957040"
  },
  {
    "text": "of things so it gives you that level of indirection when I first built this system actually had to promise that I'd be able to bring",
    "start": "957040",
    "end": "963080"
  },
  {
    "text": "it back down off the cloud if it didn't work so that was part of the reason for choosing it but also that's obviously",
    "start": "963080",
    "end": "971180"
  },
  {
    "text": "quite a academic point now it also it gives a quite a nice abstraction layer",
    "start": "971180",
    "end": "979160"
  },
  {
    "text": "for you building your processing of messages so you can have things called routes which you specify actually I'll",
    "start": "979160",
    "end": "987620"
  },
  {
    "text": "go on to talk about one let me just find the code that's right tradition here that no Agusta skips without showing",
    "start": "987620",
    "end": "993950"
  },
  {
    "start": "990000",
    "end": "1298000"
  },
  {
    "text": "code so let's have something so this this is this is a this is our one of our",
    "start": "993950",
    "end": "1001090"
  },
  {
    "text": "routes let me find it so it's just a root is just a Java class and inside it",
    "start": "1001090",
    "end": "1009790"
  },
  {
    "text": "there is this configure method and the actual there's some error handling stuff",
    "start": "1009790",
    "end": "1015460"
  },
  {
    "text": "at the top here which I might come back to but the interesting bit really starts here with this from import endpoint and",
    "start": "1015460",
    "end": "1023110"
  },
  {
    "text": "then this is a what they call them a",
    "start": "1023110",
    "end": "1028980"
  },
  {
    "text": "fluent builder which then describes what happens to a message when it goes",
    "start": "1028980",
    "end": "1035110"
  },
  {
    "text": "through the system so it comes from this input endpoint goes through all these processing stages",
    "start": "1035110",
    "end": "1040410"
  },
  {
    "text": "talk a little bit more about those and it eventually hits this two piece at the",
    "start": "1040410",
    "end": "1045730"
  },
  {
    "text": "end here and that actually generates a message going out so this is you know one of those simple programs where we",
    "start": "1045730",
    "end": "1052510"
  },
  {
    "text": "just have a message coming in message going out it might be producing might be consuming many many hundreds of them but",
    "start": "1052510",
    "end": "1059170"
  },
  {
    "text": "this is its basic outline and if shown and then comma at the top yeah so if you",
    "start": "1059170",
    "end": "1064960"
  },
  {
    "text": "look at the input end point here this we actually wire queues into our programs",
    "start": "1064960",
    "end": "1070180"
  },
  {
    "text": "dynamically deployment time so it's actually done as part of the CloudFormation and so the applications",
    "start": "1070180",
    "end": "1076900"
  },
  {
    "text": "themselves don't know which queues they're talking to they just know I have an input queue and an output queue and",
    "start": "1076900",
    "end": "1082050"
  },
  {
    "text": "but at runtime that would be then be resolved to this camel URL so camel has",
    "start": "1082050",
    "end": "1087850"
  },
  {
    "text": "this URL format to enable it to sort of act as this indirection layer so else",
    "start": "1087850",
    "end": "1093460"
  },
  {
    "text": "starts off with AWS sqs which tells it that's that's the type of messaging",
    "start": "1093460",
    "end": "1098500"
  },
  {
    "text": "system we're dealing with here where it says in queue that would actually be the AR n of the queue and then everything",
    "start": "1098500",
    "end": "1105340"
  },
  {
    "text": "after the question mark is parameters effectually to the client library so using long calling yeah so this piece",
    "start": "1105340",
    "end": "1114399"
  },
  {
    "text": "here just says use the standard Amazon client basically and then here yeah",
    "start": "1114399",
    "end": "1120309"
  },
  {
    "text": "we're using we set wait time seconds equals 20 so that enables long polling we set visibility timeout when we get",
    "start": "1120309",
    "end": "1127240"
  },
  {
    "text": "the message of 60 seconds so that's how long the message you'll remain hidden before reappearing if we don't do",
    "start": "1127240",
    "end": "1133029"
  },
  {
    "text": "anything and we've actually got this magic option as well the extend message visibility equals true and what that",
    "start": "1133029",
    "end": "1139120"
  },
  {
    "text": "will do is if camel is happy that the process is running as it should be then",
    "start": "1139120",
    "end": "1145510"
  },
  {
    "text": "it will actually automatically extend the visibility timeout so you can actually run for much longer than 60",
    "start": "1145510",
    "end": "1151480"
  },
  {
    "text": "seconds it will just keep on in the background renewing the the lease on that message so if you've got something",
    "start": "1151480",
    "end": "1157120"
  },
  {
    "text": "that's running for significantly longer as long as the application is still actually up and running and has a",
    "start": "1157120",
    "end": "1162880"
  },
  {
    "text": "heartbeat effective like it'll keep on renewing that lease you know I think a higher proportion of the people who are",
    "start": "1162880",
    "end": "1168760"
  },
  {
    "text": "using sqs at scale are doing the long polling you know the wait times seconds option there because it makes it almost",
    "start": "1168760",
    "end": "1174610"
  },
  {
    "text": "like screaming you know it you know it begins you essentially you keep the connection wired up in practice yeah",
    "start": "1174610",
    "end": "1180820"
  },
  {
    "text": "yeah so it means it means much much faster turnaround times in in getting the messages off the kid and then yeah I",
    "start": "1180820",
    "end": "1189100"
  },
  {
    "text": "can talk through these very quickly we've got these process these processes basically do something to the message",
    "start": "1189100",
    "end": "1195190"
  },
  {
    "text": "each time so you see we've got whole load of things here to do with ice by",
    "start": "1195190",
    "end": "1201159"
  },
  {
    "text": "context hi spies our internal name for our distributed trace system and I can talk a little bit more about that later",
    "start": "1201159",
    "end": "1207490"
  },
  {
    "text": "and you'll notice that some things people probably recognize in here an SMS message extractor so because this is",
    "start": "1207490",
    "end": "1213640"
  },
  {
    "text": "actually a general pattern we use for a lot of our applications if the messages come from SNS it'll have an SNS an",
    "start": "1213640",
    "end": "1219580"
  },
  {
    "text": "envelope on it and this takes that envelope off and gives us the content of",
    "start": "1219580",
    "end": "1224860"
  },
  {
    "text": "the message again the unmarshal here basically we've got the content than body of the message is",
    "start": "1224860",
    "end": "1232530"
  },
  {
    "text": "a jack speed checked it's an XML object and we're passing it as a Jack speed object and this basically just checks",
    "start": "1232530",
    "end": "1239100"
  },
  {
    "text": "that the message and passes properly the message palaces properly and then we",
    "start": "1239100",
    "end": "1244440"
  },
  {
    "text": "actually have validate is on the individual field so it may still be in a valid XML document but the fields may",
    "start": "1244440",
    "end": "1249810"
  },
  {
    "text": "actually not be make sense for this application this is our standard sample",
    "start": "1249810",
    "end": "1255600"
  },
  {
    "text": "application so it then just goes and calls a HelloWorld function which would be it's just a POJO and the input to a",
    "start": "1255600",
    "end": "1263820"
  },
  {
    "text": "function on upon the Pocho would be the jax v object and what it returns would",
    "start": "1263820",
    "end": "1268860"
  },
  {
    "text": "then be sent to the output queue and the configuration of that output endpoint would probably look something like that",
    "start": "1268860",
    "end": "1274680"
  },
  {
    "text": "so we don't actually specify many options on their output endpoint and then finally we do a little bit of extra",
    "start": "1274680",
    "end": "1281520"
  },
  {
    "text": "trace to say yep all done and completed built this thing I deployed it installed",
    "start": "1281520",
    "end": "1289140"
  },
  {
    "text": "it and put it into production what have you learned what are the some key lessons that you think would be useful",
    "start": "1289140",
    "end": "1294360"
  },
  {
    "text": "to pass on to the people who are thinking about doing something like this yeah ok so if I go back to my slides and",
    "start": "1294360",
    "end": "1304130"
  },
  {
    "start": "1298000",
    "end": "1713000"
  },
  {
    "text": "hopefully all no that's really not happy that a there we go ok so right it's just",
    "start": "1304130",
    "end": "1312540"
  },
  {
    "text": "I think a little bit unhappy with there we go the switching of the switching of",
    "start": "1312540",
    "end": "1321210"
  },
  {
    "text": "the presentation so the things we've learnt so we scaled scaling to handle",
    "start": "1321210",
    "end": "1326850"
  },
  {
    "text": "Peaks we can do really rail well with the sqs queues so we use competing",
    "start": "1326850",
    "end": "1332040"
  },
  {
    "text": "consumer pattern so if messages build up on an sqs queue what we can do we can",
    "start": "1332040",
    "end": "1338430"
  },
  {
    "text": "run multiple instances of the service that's pulling messages from naku and because each instance when it gets a",
    "start": "1338430",
    "end": "1345930"
  },
  {
    "text": "message it hides it from the others that means that we don't end up with the instances treading on each other's toes",
    "start": "1345930",
    "end": "1352970"
  },
  {
    "text": "one mess one instance will grab the message well we'll get the message we'll",
    "start": "1352970",
    "end": "1358260"
  },
  {
    "text": "hide that message any other services can't see it when they go to get a message they will get out the other yes we oughta scale on cue",
    "start": "1358260",
    "end": "1368130"
  },
  {
    "text": "depth will typically run a minimum of three services one in each availability",
    "start": "1368130",
    "end": "1373710"
  },
  {
    "text": "zone but because of that competing consumer pattern if we need to grow to",
    "start": "1373710",
    "end": "1380700"
  },
  {
    "text": "cope with a queue that's because suddenly got very full I can scale up to thirty instances and I will just go well",
    "start": "1380700",
    "end": "1387270"
  },
  {
    "text": "ten times faster than three instances and it's pretty much linear scaling for that so that's that's wonderful for",
    "start": "1387270",
    "end": "1393240"
  },
  {
    "text": "systems where you get a large peak or something you know that sort of linear",
    "start": "1393240",
    "end": "1400230"
  },
  {
    "text": "scaling so easy to say and so hard to achieve it's nice when you see exactly exactly that's right so the other thing",
    "start": "1400230",
    "end": "1405929"
  },
  {
    "text": "we learnt was around error handling so I",
    "start": "1405929",
    "end": "1411360"
  },
  {
    "text": "mentioned up visibility timeout earlier and I actually skipped over the exception handling code but we've got it",
    "start": "1411360",
    "end": "1417750"
  },
  {
    "text": "set up in camel and this is another thing I quite like about the way camera works that if we throw an exception and",
    "start": "1417750",
    "end": "1424620"
  },
  {
    "text": "it bubbles up to the top therefore what camel will do is actually just let go of the message or stop renewing that",
    "start": "1424620",
    "end": "1429630"
  },
  {
    "text": "visibility timeout on it and that means the message reappears on the queue which means that if the reason something went",
    "start": "1429630",
    "end": "1438179"
  },
  {
    "text": "wrong was that the application crashed or that some dependent system we were",
    "start": "1438179",
    "end": "1443370"
  },
  {
    "text": "calling perhaps our network in perhaps a networking problem had occurred then basically if we don't have a specific",
    "start": "1443370",
    "end": "1449390"
  },
  {
    "text": "handling of an error we just let go of the message and let it reappear on the queue and that will happen up to five",
    "start": "1449390",
    "end": "1457410"
  },
  {
    "text": "times the way we've got it configured and that's a really good way of just handling sort of generic hmm I don't",
    "start": "1457410",
    "end": "1465300"
  },
  {
    "text": "know there was a networking glitch or this system suddenly had a problem and it gives us a very common way of",
    "start": "1465300",
    "end": "1471000"
  },
  {
    "text": "handling error code rather than having to write that in all our apps if we don't want specific error handling we",
    "start": "1471000",
    "end": "1476550"
  },
  {
    "text": "can just fall back on this and it will retry five times with a sixty seconds between each time try basically if that",
    "start": "1476550",
    "end": "1483929"
  },
  {
    "text": "fails if it goes all through all five times and it doesn't work then it'll actually put the message on the",
    "start": "1483929",
    "end": "1489630"
  },
  {
    "text": "dead-letter here right and technically this is what we used to have to do because we actually used to have",
    "start": "1489630",
    "end": "1495780"
  },
  {
    "text": "to look at the I think it's the approximate retry count header in the service and write the blesser message",
    "start": "1495780",
    "end": "1501090"
  },
  {
    "text": "after the dead letter Q ourselves this line should really actually be all the way back here now because this",
    "start": "1501090",
    "end": "1507300"
  },
  {
    "text": "functionality has actually been built into sqs for several years now and it's the read drive policy I think it's",
    "start": "1507300",
    "end": "1514470"
  },
  {
    "text": "called and you can specify exactly this the deal whew machinery dead letter cube",
    "start": "1514470",
    "end": "1519630"
  },
  {
    "text": "machinery is is popular in a lot of services now it seems to be a good and useful pattern a couple of interesting",
    "start": "1519630",
    "end": "1524790"
  },
  {
    "text": "questions somebody's what MIT asks is the time addressable media star also built on the cloud he tastes it is it's",
    "start": "1524790",
    "end": "1533220"
  },
  {
    "text": "built on s3 I've given a talk previously",
    "start": "1533220",
    "end": "1538350"
  },
  {
    "text": "there's a my architecture video about how that's built yeah that's that uses",
    "start": "1538350",
    "end": "1545130"
  },
  {
    "text": "s3 very extensively yep that question was from split bit another question from Marshall BG wouldn't wouldn't land this",
    "start": "1545130",
    "end": "1552720"
  },
  {
    "text": "be better for this lambdas would be lovely but they don't support sqs so so that's that that will be",
    "start": "1552720",
    "end": "1562470"
  },
  {
    "text": "fantastic because yeah we have we build it like this at the moment I mean lambdas didn't exist when we",
    "start": "1562470",
    "end": "1567930"
  },
  {
    "text": "first built this system but they are yeah what we're doing here is very very similar to a lambda approach right I'm",
    "start": "1567930",
    "end": "1575100"
  },
  {
    "text": "with equal to scaling groups and so on yeah that's been quite a while coming it turns out that the the process of",
    "start": "1575100",
    "end": "1580830"
  },
  {
    "text": "hooking sqs up to lambda was harder than we thought you know molding 1q is easy pulling a",
    "start": "1580830",
    "end": "1586050"
  },
  {
    "text": "hundred thousand queues is you know a serious engineering challenge but they've announced it and I I don't know",
    "start": "1586050",
    "end": "1591480"
  },
  {
    "text": "what the actual data is but it should be with us soon and and then you know even more even more your scaling problems go",
    "start": "1591480",
    "end": "1597720"
  },
  {
    "text": "away what well thanks Steven that's terrific let's turn our attention now to the red",
    "start": "1597720",
    "end": "1602820"
  },
  {
    "text": "button and I'm willing to bet that a large part of our listeners today have no idea what a red button might be so so",
    "start": "1602820",
    "end": "1609600"
  },
  {
    "text": "so Chris do you want to take over and raise their consciousness yeah definitely we've got a couple of",
    "start": "1609600",
    "end": "1615570"
  },
  {
    "text": "videos to show basically the red button application is it's an interactive data",
    "start": "1615570",
    "end": "1623340"
  },
  {
    "text": "system that can be accessed through your television set so on most remote",
    "start": "1623340",
    "end": "1630410"
  },
  {
    "text": "controls you have a set of color keys a red a green a yellow and a blue and if",
    "start": "1630410",
    "end": "1636890"
  },
  {
    "text": "you're on one of the BBC channels then you can press red and you get into the",
    "start": "1636890",
    "end": "1642500"
  },
  {
    "text": "interactive date system now depending on whether your TV is connected to the",
    "start": "1642500",
    "end": "1649040"
  },
  {
    "text": "internet or not depends on how rich an experience you get when looking at the",
    "start": "1649040",
    "end": "1655850"
  },
  {
    "text": "data if you are not connected then we're very limited by the bandwidth that we",
    "start": "1655850",
    "end": "1662750"
  },
  {
    "text": "can send through the broadcast system to actually get to all the TVs and so it's",
    "start": "1662750",
    "end": "1669980"
  },
  {
    "text": "very text-based whereas if you have a connected system then obviously we have",
    "start": "1669980",
    "end": "1676940"
  },
  {
    "text": "got a back channel being able to leverage off the internet and then you",
    "start": "1676940",
    "end": "1682490"
  },
  {
    "text": "can have a lot more graphics in there and you can hook into things like iPlayer and be able to play video",
    "start": "1682490",
    "end": "1688520"
  },
  {
    "text": "streams as well through that and so you get the same data but if you're in a",
    "start": "1688520",
    "end": "1696470"
  },
  {
    "text": "connected experience then you will get a more fulfilling and richer experience",
    "start": "1696470",
    "end": "1702380"
  },
  {
    "text": "out of it excellent so what's the technology behind it well if Steven can bring up this slide",
    "start": "1702380",
    "end": "1708950"
  },
  {
    "text": "for me we had a similar problem that Steven had in that we had to go from an",
    "start": "1708950",
    "end": "1716600"
  },
  {
    "text": "a solution that was dealt with by a third party so we would push our data to",
    "start": "1716600",
    "end": "1723080"
  },
  {
    "text": "a third party who would then go through their systems and pushed up to the",
    "start": "1723080",
    "end": "1729740"
  },
  {
    "text": "broadcast and we had a two-year project that meant that we had to bring that",
    "start": "1729740",
    "end": "1735200"
  },
  {
    "text": "in-house and similar to Stephens example we looked at various different layers of",
    "start": "1735200",
    "end": "1743270"
  },
  {
    "text": "our stack and how we could wire those up through SNS and SQS",
    "start": "1743270",
    "end": "1749350"
  },
  {
    "text": "and build a parallel processing stream alongside the existing",
    "start": "1749350",
    "end": "1756960"
  },
  {
    "text": "broadcast content and be able to make sure that where we were looking at the",
    "start": "1756960",
    "end": "1764760"
  },
  {
    "text": "data were getting from internal tools make sure that the new system that we",
    "start": "1764760",
    "end": "1770399"
  },
  {
    "text": "had in place produce the same output when we had verified that then we could",
    "start": "1770399",
    "end": "1776700"
  },
  {
    "text": "look at transforming that into platform specific now when I say platform we have",
    "start": "1776700",
    "end": "1783470"
  },
  {
    "text": "different ways of broadcasting to our audience whether that is through Sky",
    "start": "1783470",
    "end": "1791820"
  },
  {
    "text": "platform whether it's through a free view set-top box or Smart TV",
    "start": "1791820",
    "end": "1797309"
  },
  {
    "text": "or whether it's through Freesat or virgin cable these are different ways",
    "start": "1797309",
    "end": "1802980"
  },
  {
    "text": "and all have different code that is then interpreted by the television or the",
    "start": "1802980",
    "end": "1810919"
  },
  {
    "text": "set-top box to be able to take the content and show it we were able to look",
    "start": "1810919",
    "end": "1819210"
  },
  {
    "text": "through and to de-risk this project look at using SNS to fan out to an sqs in the",
    "start": "1819210",
    "end": "1829860"
  },
  {
    "text": "new world or through to our existing broadcast platform and be able to",
    "start": "1829860",
    "end": "1836669"
  },
  {
    "text": "decommission parts of the legacy estate as we were going through the project",
    "start": "1836669",
    "end": "1845720"
  },
  {
    "text": "yeah when it came time to actually switch on our very final component and",
    "start": "1845720",
    "end": "1852440"
  },
  {
    "text": "to move off the legacy platform to AWS -",
    "start": "1852440",
    "end": "1858090"
  },
  {
    "text": "on Prem through Direct Connect it was almost a non-event because we knew it",
    "start": "1858090",
    "end": "1865950"
  },
  {
    "text": "was going to earth and someone in our central coding facility and multiplexing",
    "start": "1865950",
    "end": "1873799"
  },
  {
    "text": "press to switch and lo and behold the old system was not used the new system",
    "start": "1873799",
    "end": "1880289"
  },
  {
    "text": "was used and there was no interruption to surface to the entire of the UK on",
    "start": "1880289",
    "end": "1885750"
  },
  {
    "text": "that that's great because you know building cloud applications these days is reasonably straightforward but migrating applications from old to",
    "start": "1885750",
    "end": "1893760"
  },
  {
    "text": "new almost regardless of what old and new are is always a very tense and nervous kind of thing yes yeah yeah so",
    "start": "1893760",
    "end": "1901910"
  },
  {
    "text": "being able to use AWS and being able to stand up a second complete chain and",
    "start": "1901910",
    "end": "1910050"
  },
  {
    "text": "being able to validate each of those stats meant that actually when it came",
    "start": "1910050",
    "end": "1915780"
  },
  {
    "text": "through to switching over as I say it was something that we we validated and",
    "start": "1915780",
    "end": "1923340"
  },
  {
    "text": "we could switch platform by platform and there was no running around with your",
    "start": "1923340",
    "end": "1929520"
  },
  {
    "text": "hair on fire when there was a problem because there wasn't a problem yeah",
    "start": "1929520",
    "end": "1934530"
  },
  {
    "text": "excellent so are you gonna show us some code as well I am indeed yeah so Stephen can",
    "start": "1934530",
    "end": "1940470"
  },
  {
    "text": "bring up the code we use a very similar system to as Steven mentioned what",
    "start": "1940470",
    "end": "1948120"
  },
  {
    "start": "1942000",
    "end": "2125000"
  },
  {
    "text": "you've got code here is we have a library function that is calling through",
    "start": "1948120",
    "end": "1955740"
  },
  {
    "text": "to SNS and it will publish out through",
    "start": "1955740",
    "end": "1961190"
  },
  {
    "text": "the to the SNS topic so a very simple function they're going on to the next",
    "start": "1961190",
    "end": "1968550"
  },
  {
    "text": "piece of code we're not we have both",
    "start": "1968550",
    "end": "1975600"
  },
  {
    "text": "Java and JavaScript rather than bringing up duplicate code for each steps that we",
    "start": "1975600",
    "end": "1981840"
  },
  {
    "text": "were using I pulled one of the types of examples and it just so happened to be",
    "start": "1981840",
    "end": "1987450"
  },
  {
    "text": "the same type that Steven has got as well yeah when we in each of our stat",
    "start": "1987450",
    "end": "1996030"
  },
  {
    "text": "sets of SNS and SQS we also have s3",
    "start": "1996030",
    "end": "2001190"
  },
  {
    "text": "involved and that so that for us securities the main concern with us",
    "start": "2001190",
    "end": "2008740"
  },
  {
    "text": "taking journalistic content and publishing it out to all the homes in",
    "start": "2008740",
    "end": "2015470"
  },
  {
    "text": "the UK then you want to make sure that the content that is published by the",
    "start": "2015470",
    "end": "2021470"
  },
  {
    "text": "journalist is the content that gets all the way out to the TV and so we use s3 as a way of",
    "start": "2021470",
    "end": "2032010"
  },
  {
    "text": "storing that content and then SNS and SQS for the message and in that message",
    "start": "2032010",
    "end": "2040470"
  },
  {
    "text": "we then have a H mark in there to validate that the message has not been",
    "start": "2040470",
    "end": "2045480"
  },
  {
    "text": "tampered with from the publisher right through to the consumer that picks it up",
    "start": "2045480",
    "end": "2050970"
  },
  {
    "text": "and you can see in this piece we have a",
    "start": "2050970",
    "end": "2056159"
  },
  {
    "text": "parallel stream for uploading all of the files twist three we've got an X ray",
    "start": "2056160",
    "end": "2063090"
  },
  {
    "text": "tracing question on that I see using files but parallel stream there in your Java code are you just turning it loose",
    "start": "2063090",
    "end": "2070350"
  },
  {
    "text": "and letting it take as many threads as it once or do you control the concurrency at all we are controlling",
    "start": "2070350",
    "end": "2075899"
  },
  {
    "text": "the concurrency that's through the config of the application okay you know",
    "start": "2075900",
    "end": "2081780"
  },
  {
    "text": "so depending on which of our platforms and which of the environments that we",
    "start": "2081780",
    "end": "2086909"
  },
  {
    "text": "have we can then define exactly how many streams that it's going to use we've got",
    "start": "2086910",
    "end": "2095220"
  },
  {
    "text": "an X ray trace in there so using X ray were able to try and track each of the",
    "start": "2095220",
    "end": "2101870"
  },
  {
    "text": "transactions through from where it enters our system through the different",
    "start": "2101870",
    "end": "2107730"
  },
  {
    "text": "hops that it makes so that if there is a problem at any point we can then use the",
    "start": "2107730",
    "end": "2115050"
  },
  {
    "text": "X rate and then be able to narrow down and understand where the problem was in there so if we go into the next piece of",
    "start": "2115050",
    "end": "2123390"
  },
  {
    "text": "content here you can see our routes file in camel yeah very similar to the way",
    "start": "2123390",
    "end": "2130800"
  },
  {
    "start": "2125000",
    "end": "2242000"
  },
  {
    "text": "that Steven had his headset you can see ours is a lot smaller and we actually",
    "start": "2130800",
    "end": "2137850"
  },
  {
    "text": "have the sqs name in there and you can see that we have a visibility timeout of",
    "start": "2137850",
    "end": "2144270"
  },
  {
    "text": "30 seconds in there and we've got the extend message visibility in there as",
    "start": "2144270",
    "end": "2150750"
  },
  {
    "text": "well one thing you'll notice is we've got concurrent consumers want in there and that's very",
    "start": "2150750",
    "end": "2158510"
  },
  {
    "text": "much so that we can make sure that we're only picking up one message off the",
    "start": "2158510",
    "end": "2163730"
  },
  {
    "text": "queue at a time and this is because although we we don't actually have a lot",
    "start": "2163730",
    "end": "2172910"
  },
  {
    "text": "of messages flowing through our system but they are deltas so you have you",
    "start": "2172910",
    "end": "2179390"
  },
  {
    "text": "highlighted at the start that SQS you may get out of order messaging you may",
    "start": "2179390",
    "end": "2185630"
  },
  {
    "text": "get your message more than once so we wanted to limit the message that we were",
    "start": "2185630",
    "end": "2192140"
  },
  {
    "text": "pulling in and then being able to within the Java code understand had we seen",
    "start": "2192140",
    "end": "2198710"
  },
  {
    "text": "this message before were we getting an older message and then deal with it at",
    "start": "2198710",
    "end": "2204440"
  },
  {
    "text": "that point in the java code this was of course before sqs FIFO came out and that",
    "start": "2204440",
    "end": "2212270"
  },
  {
    "text": "was one of our problems that we had when we were wiring together sqs and this is",
    "start": "2212270",
    "end": "2218330"
  },
  {
    "text": "it worthwhile for you to switch over to ask us 5'4 is this basically okay it's",
    "start": "2218330",
    "end": "2223400"
  },
  {
    "text": "okay at the moment but we do have a project on the go where we are looking",
    "start": "2223400",
    "end": "2228410"
  },
  {
    "text": "at using sqs FIFO and looking at migrating to lambdas from EC twos as",
    "start": "2228410",
    "end": "2235670"
  },
  {
    "text": "well yeah the next what you have here is",
    "start": "2235670",
    "end": "2245000"
  },
  {
    "start": "2242000",
    "end": "2665000"
  },
  {
    "text": "this is our reading of the message as it comes off the stream so further down in",
    "start": "2245000",
    "end": "2252110"
  },
  {
    "text": "the application and you can see it's a very simple code that all we're doing is",
    "start": "2252110",
    "end": "2259030"
  },
  {
    "text": "getting the AWS message as a string",
    "start": "2259030",
    "end": "2264040"
  },
  {
    "text": "pulling that through and then doing a JSON path read on it storing it in an",
    "start": "2264040",
    "end": "2271370"
  },
  {
    "text": "object and then that will then get passed into the core of the system where",
    "start": "2271370",
    "end": "2278300"
  },
  {
    "text": "the call will then go off talk to s3 download all of the files that it needs",
    "start": "2278300",
    "end": "2285350"
  },
  {
    "text": "to from s3 a-after validating that the message is a message 38 wants to deal with and hasn't",
    "start": "2285350",
    "end": "2293630"
  },
  {
    "text": "been tampered with looking at those s3 files it will validate that again those have not",
    "start": "2293630",
    "end": "2301069"
  },
  {
    "text": "changed from where the producer has published them twice three before them",
    "start": "2301069",
    "end": "2308720"
  },
  {
    "text": "doing what it needs to do to those files and then publishing them on further down",
    "start": "2308720",
    "end": "2314119"
  },
  {
    "text": "the chain that that's really admirably simple and readable I like to see that hey and there's another question not",
    "start": "2314119",
    "end": "2320809"
  },
  {
    "text": "really directly related to this basically are you using containers at all and specifically are using any ECS",
    "start": "2320809",
    "end": "2327819"
  },
  {
    "text": "we are using some containers but we're not using ACS at the moment but it is",
    "start": "2327819",
    "end": "2334130"
  },
  {
    "text": "something that we are investigating at the time at the moment okay given that",
    "start": "2334130",
    "end": "2339440"
  },
  {
    "text": "we're getting 40 minutes in which we should move right along here so let me ask you having gone through the work of building all this stuff and",
    "start": "2339440",
    "end": "2345859"
  },
  {
    "text": "getting it going any lessons to share with people watching I it's a lot",
    "start": "2345859",
    "end": "2353059"
  },
  {
    "text": "simpler than when you look at it you think it could be you know don't be afraid of it Oh excellent another",
    "start": "2353059",
    "end": "2360859"
  },
  {
    "text": "question you see this up a bit how how do you do your monitoring and",
    "start": "2360859",
    "end": "2365960"
  },
  {
    "text": "dashboarding and so on how do you monitor this the system question for both of you really can go over spy stuff",
    "start": "2365960",
    "end": "2372920"
  },
  {
    "text": "so I mentioned the skipped over it but I mentioned the out spy stuff earlier which is our internal trace system so",
    "start": "2372920",
    "end": "2381109"
  },
  {
    "text": "let me just bring that slide up so the way we do this is actually you saw there",
    "start": "2381109",
    "end": "2389270"
  },
  {
    "text": "were several points in the roots where we have this thing called I spy what wired in that actually generates SNS",
    "start": "2389270",
    "end": "2397309"
  },
  {
    "text": "messages off to the side so we'll start processing a message and we'll generate",
    "start": "2397309",
    "end": "2403250"
  },
  {
    "text": "an SNS message saying yep we received that and then as we go through sort of the work that what that component is",
    "start": "2403250",
    "end": "2410030"
  },
  {
    "text": "doing at sort of business critical points we will generate other so this is an example of us assembling a",
    "start": "2410030",
    "end": "2418119"
  },
  {
    "text": "source piece of video for a for a live program and those SNS events all then",
    "start": "2418119",
    "end": "2427219"
  },
  {
    "text": "get wired into a queue that then goes actually we've got a bridge that takes it off to Splunk so we take those events",
    "start": "2427219",
    "end": "2434479"
  },
  {
    "text": "put them all into Splunk and one of the key things we do is each message as it",
    "start": "2434479",
    "end": "2439669"
  },
  {
    "text": "enters our system is given a correlation ID and then that ID is copied across",
    "start": "2439669",
    "end": "2445749"
  },
  {
    "text": "from one message to another as is processed you have any time yes so we",
    "start": "2445749",
    "end": "2453739"
  },
  {
    "text": "will typically do alarming or the set up alarms on the actual queues themselves",
    "start": "2453739",
    "end": "2460459"
  },
  {
    "text": "so I'll often use the cloud watch metrics for the queues themselves so if",
    "start": "2460459",
    "end": "2465469"
  },
  {
    "text": "we see messages backing up particularly those dead letter queues I mentioned earlier though should always have a",
    "start": "2465469",
    "end": "2471319"
  },
  {
    "text": "queue depth of 0 basic right so if there's more than one message on the dead letter Q then or more than 0",
    "start": "2471319",
    "end": "2477769"
  },
  {
    "text": "messages on the dead letter Q then that's the problem and that will alert",
    "start": "2477769",
    "end": "2482779"
  },
  {
    "text": "our monitoring team I hope you know",
    "start": "2482779",
    "end": "2488209"
  },
  {
    "text": "paged at night very often no it's it's pretty it's pretty smooth most of the time but we have written tools for our",
    "start": "2488209",
    "end": "2494929"
  },
  {
    "text": "monitoring team so they can actually refill those messages off the dead letter Q and back into the input queue",
    "start": "2494929",
    "end": "2500900"
  },
  {
    "text": "of the the application so if the if the problems being caused by you know",
    "start": "2500900",
    "end": "2506179"
  },
  {
    "text": "another system that's down our monitoring team are very likely to be aware of that and they can actually",
    "start": "2506179",
    "end": "2512329"
  },
  {
    "text": "safely leave the messages on the red letter queue until the point of that other systems up and then they can press",
    "start": "2512329",
    "end": "2518509"
  },
  {
    "text": "the the respawn button and have the messages will be processed again which",
    "start": "2518509",
    "end": "2523579"
  },
  {
    "text": "is much better than us sitting there hammering a poor system while it's it's having trouble I mean for us one of the",
    "start": "2523579",
    "end": "2531109"
  },
  {
    "text": "additional things that we do apart from you know the cloud watch matrix of you",
    "start": "2531109",
    "end": "2536179"
  },
  {
    "text": "know queue length queue age we monitor how often we've seen a file that comes",
    "start": "2536179",
    "end": "2543650"
  },
  {
    "text": "through that is an older file we also monitor how long we see a",
    "start": "2543650",
    "end": "2550460"
  },
  {
    "text": "publish go through the system so we in inject a test scene into each of our",
    "start": "2550460",
    "end": "2557030"
  },
  {
    "text": "platforms right at the top of our system and then we pull down the actual",
    "start": "2557030",
    "end": "2563599"
  },
  {
    "text": "broadcast transmission from the local transmitter decode that stream and check",
    "start": "2563599",
    "end": "2569569"
  },
  {
    "text": "to see that we've got that file through and we have a dashboard that then shows how long it takes for that file to get",
    "start": "2569569",
    "end": "2576950"
  },
  {
    "text": "through and so one of the first things I do every morning when I come in is have",
    "start": "2576950",
    "end": "2582289"
  },
  {
    "text": "a look at the graph overnight and see whether we've seen any spikes in there and if we see a small spike we can go",
    "start": "2582289",
    "end": "2591170"
  },
  {
    "text": "and investigate if we see a larger spike then hopefully an on-call engineer has",
    "start": "2591170",
    "end": "2596480"
  },
  {
    "text": "been called out anyway but we can then go back and find out exactly which part",
    "start": "2596480",
    "end": "2602359"
  },
  {
    "text": "of our system has then had a problem why that problem occurred and then look to",
    "start": "2602359",
    "end": "2610700"
  },
  {
    "text": "resolver well that's sounds like life at AWS actually so folks it being 45",
    "start": "2610700",
    "end": "2616940"
  },
  {
    "text": "minutes past the hour there's lots more we could talk about but at this point I think we'll draw a line in it under it",
    "start": "2616940",
    "end": "2621950"
  },
  {
    "text": "now I put it out we ran our separation from these gentlemen which means it's after 6:00 p.m. they're now in London so",
    "start": "2621950",
    "end": "2627200"
  },
  {
    "text": "so thank you for coming in to our office and and staying late and that'll be it",
    "start": "2627200",
    "end": "2632960"
  },
  {
    "text": "for this week now I'd like to remind everybody we'll be back next week to talk about our I think our newest",
    "start": "2632960",
    "end": "2638180"
  },
  {
    "text": "messaging service or one of our newest anyhow pin point which is really quite a bit different from all the others and",
    "start": "2638180",
    "end": "2643700"
  },
  {
    "text": "unlike it'll be the first one we're going into where I don't actually understand it very well so I'm going to",
    "start": "2643700",
    "end": "2650420"
  },
  {
    "text": "be learning along with the audience the title of the thing is messaging for real-time user engagement so thank you",
    "start": "2650420",
    "end": "2657140"
  },
  {
    "text": "Stephen thank you Chris goodbye everybody and we'll see you next week thank you thank you thank you",
    "start": "2657140",
    "end": "2665619"
  }
]