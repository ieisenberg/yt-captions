[
  {
    "start": "0",
    "end": "203000"
  },
  {
    "text": "oh well hey everybody thank you so much",
    "start": "0",
    "end": "5009"
  },
  {
    "text": "for coming out at 4 o'clock the Thursday afternoon I hope you're all having a",
    "start": "5009",
    "end": "10080"
  },
  {
    "text": "great conference and really appreciate you taking the time to join my session my name is Todd Golding and I'm a",
    "start": "10080",
    "end": "15630"
  },
  {
    "text": "partner Solutions Architect at AWS and I'm part of this team that's called the SAS factory team and that team basically",
    "start": "15630",
    "end": "22250"
  },
  {
    "text": "is involved with customers who are building SAS solutions and we're we're",
    "start": "22250",
    "end": "27570"
  },
  {
    "text": "helping them with either design or development or or you know rebuild of a solution and the SAS model and as part",
    "start": "27570",
    "end": "34680"
  },
  {
    "text": "of that team we build all kinds of content in fact I encourage you if you're just generally interested in SAS",
    "start": "34680",
    "end": "39690"
  },
  {
    "text": "to go look up the SAS Factory and you'll find all kinds of reference content related to best practices and approaches",
    "start": "39690",
    "end": "45360"
  },
  {
    "text": "both on the business and the technical side and as part of that team we",
    "start": "45360",
    "end": "51090"
  },
  {
    "text": "generally and even as part of content we deliver here we'll often talk about you know competing approaches different",
    "start": "51090",
    "end": "57149"
  },
  {
    "text": "strategies and try to give you some idea of patterns and practices that are good ideas for you but what we also decided a",
    "start": "57149",
    "end": "64018"
  },
  {
    "text": "while back was I think it'd be really helpful to show people sort of an end end working example people are saying to",
    "start": "64019",
    "end": "71220"
  },
  {
    "text": "us that's great we love all these sort of patterns and practices they're all great things and they're good things for",
    "start": "71220",
    "end": "76500"
  },
  {
    "text": "us to think about but could you just show us an end-to-end working example of",
    "start": "76500",
    "end": "81509"
  },
  {
    "text": "a SAS application and yes we know that may not be exactly how we'll build our SAS application but you know if with",
    "start": "81509",
    "end": "89130"
  },
  {
    "text": "that example it'll give us a much better idea of how some of the building blocks come together and what what a real",
    "start": "89130",
    "end": "95700"
  },
  {
    "text": "working sort of version of this looks like and so last year a member of my team and I Judah Bernstein and I we",
    "start": "95700",
    "end": "101909"
  },
  {
    "text": "built what's called a QuickStart and if you haven't used a QuickStart at AWS that's just this downloadable construct",
    "start": "101909",
    "end": "108450"
  },
  {
    "text": "you can download it install it and so on and in fact there's a whole range of",
    "start": "108450",
    "end": "113610"
  },
  {
    "text": "good quickstarts out there for you to look at but this particular QuickStart was focused on this very specific",
    "start": "113610",
    "end": "119610"
  },
  {
    "text": "problem how could we show you a working example of an application and it's not",
    "start": "119610",
    "end": "124860"
  },
  {
    "text": "meant to be a production application it's just meant to be a reference point a starting point and everything we're",
    "start": "124860",
    "end": "131520"
  },
  {
    "text": "going to talk about in this session today is based entirely on that working example so our goal here is not to",
    "start": "131520",
    "end": "138140"
  },
  {
    "text": "wander off into all the sort of parallel paths you might go and all the alternatives instead we're going to pick",
    "start": "138140",
    "end": "144769"
  },
  {
    "text": "a slice of a specific kind of SAS application and walk you through that end-to-end now a couple caveats this",
    "start": "144769",
    "end": "153500"
  },
  {
    "text": "some people will come to these sessions on their like brand new to SAS and they haven't really sort of dove into the",
    "start": "153500",
    "end": "158870"
  },
  {
    "text": "concepts this is a 400 level session I'm not going to like teach SAS fundamentals",
    "start": "158870",
    "end": "164450"
  },
  {
    "text": "in here that there are plenty of good content out there for this this is a 400 level",
    "start": "164450",
    "end": "169760"
  },
  {
    "text": "session which means we're gonna poke at some code and we're gonna stay under the hood more we're not gonna crack open the",
    "start": "169760",
    "end": "176209"
  },
  {
    "text": "IDE and I'm not going to build SAS from scratch in a few minutes but we will poke it code and so",
    "start": "176209",
    "end": "182000"
  },
  {
    "text": "hopefully based on the abstract and everything else you sort of read about this session that absolutely fits for",
    "start": "182000",
    "end": "187819"
  },
  {
    "text": "you and then I will say at the end of all this I'll give you the link to the content that's here so you can go out",
    "start": "187819",
    "end": "193639"
  },
  {
    "text": "and get a good look at this and absolutely take a look at what we've created and give us feedback on what",
    "start": "193639",
    "end": "198919"
  },
  {
    "text": "kind of things you'd want to see so enough about the sort of set up here let's actually dig in and look at this",
    "start": "198919",
    "end": "204229"
  },
  {
    "start": "203000",
    "end": "203000"
  },
  {
    "text": "application and what it's all about and before we can kind of wander into the code and the services that are part of this solution I need to give you some",
    "start": "204229",
    "end": "211010"
  },
  {
    "text": "sort of foundational view of what are the moving parts of this environment and what what's in it right and obviously",
    "start": "211010",
    "end": "217790"
  },
  {
    "text": "we're building a multi-tenant solution we're SAS we have to have tenants multiple tenants in here and we're",
    "start": "217790",
    "end": "223250"
  },
  {
    "text": "building a very specific kind of multi tenant solution we're building what we call a pooled SAS solution and when we",
    "start": "223250",
    "end": "231769"
  },
  {
    "text": "say pooled what we're basically saying is the resources of our application the infrastructure resources compute and",
    "start": "231769",
    "end": "238099"
  },
  {
    "text": "storage and so on they're going to be shared by tenants in this model now there are other models of SAS for",
    "start": "238099",
    "end": "244609"
  },
  {
    "text": "example we talked about silo models where each tenant will either get their own storage or their own compute and",
    "start": "244609",
    "end": "250189"
  },
  {
    "text": "those those environments are entirely valid as well but not in the scope of what we're gonna talk about today but I absolutely want you to know there are",
    "start": "250189",
    "end": "256789"
  },
  {
    "text": "other patterns out there other strategies and if you go look at our content you'll see that now the first",
    "start": "256789",
    "end": "262789"
  },
  {
    "text": "piece we're going to look at is onboarding and usually when I go talk to customers and partners and they want to talk to me",
    "start": "262789",
    "end": "268889"
  },
  {
    "text": "about SAS and I bring up onboarding the typical response is we don't that's like not something we need to think a whole",
    "start": "268889",
    "end": "275099"
  },
  {
    "text": "lot about we're more interested in our micro services and our storage and all these other bits and I will say to them",
    "start": "275099",
    "end": "280889"
  },
  {
    "text": "I think on boarding is one of the most important pieces of building a SAS solution getting onboarding right how",
    "start": "280889",
    "end": "286830"
  },
  {
    "text": "tenants get introduced into your environment how you create a footprint for a SAS tenant is essential to the",
    "start": "286830",
    "end": "293520"
  },
  {
    "text": "rest of the architecture of your solution how you resolve a user to a tenant how that tenant has a billing",
    "start": "293520",
    "end": "300150"
  },
  {
    "text": "perp life cycle now what provisioning you might have to do in configuration to set that all up when we're done with",
    "start": "300150",
    "end": "306210"
  },
  {
    "text": "this exercise you you will see how the work we did in onboarding set up the flow through all this in a way that made",
    "start": "306210",
    "end": "312930"
  },
  {
    "text": "our developers more productive made our isolations story a better isolation story and so on and I want this process",
    "start": "312930",
    "end": "321539"
  },
  {
    "text": "to be really robust I want your onboarding to be robust I want it to be repeatable",
    "start": "321539",
    "end": "326729"
  },
  {
    "text": "you don't want tenants trying to onboard onto your system and having that be a somewhat flaky process you can't have",
    "start": "326729",
    "end": "333300"
  },
  {
    "text": "well it fails every other time and we just retry and I know this doesn't matter whether you're b2c or enterprise",
    "start": "333300",
    "end": "339060"
  },
  {
    "text": "or b2b I want this process to be automated and robust the next thing",
    "start": "339060",
    "end": "345330"
  },
  {
    "text": "we're going to look at is authentication and on the surface you'd say well authentication I only know that I know",
    "start": "345330",
    "end": "350550"
  },
  {
    "text": "how to write a connect to an identity provider and all the user and get them into the system but right here in a SAS",
    "start": "350550",
    "end": "357210"
  },
  {
    "text": "environment we're not just all thing you as a user to get you into the system we're not going to talk about how to do that what I have to do is when I off you",
    "start": "357210",
    "end": "364620"
  },
  {
    "text": "here as a user and you come in somehow when I off you I have to know which tenant you're connected to because the",
    "start": "364620",
    "end": "372120"
  },
  {
    "text": "context I need is not just you as a user I need you as a user for a tenant so",
    "start": "372120",
    "end": "378210"
  },
  {
    "text": "when we off you were going to look at how we offer you and how we get an identity profile that flows all of that",
    "start": "378210",
    "end": "384449"
  },
  {
    "text": "additional SAS context through our application finally we'll look at the",
    "start": "384449",
    "end": "390779"
  },
  {
    "text": "actual way that you build multi tenant application services right and here's where everybody thinks well this is",
    "start": "390779",
    "end": "396089"
  },
  {
    "text": "where the nuts and bolts of real good architecture real good SAS design are gonna come in now not really the truth is in fact if",
    "start": "396089",
    "end": "403350"
  },
  {
    "text": "you write a really good multi tenant solution and you build a really good isolation model you really build a good",
    "start": "403350",
    "end": "410099"
  },
  {
    "text": "identity model and all these other bits our goal really is to say building multi tenant application service shouldn't",
    "start": "410099",
    "end": "415800"
  },
  {
    "text": "look all that different than building a single tenant multi tenant service so we're gonna look instead at how we",
    "start": "415800",
    "end": "421770"
  },
  {
    "text": "surround those services with frameworks or tools or libraries or mechanisms that",
    "start": "421770",
    "end": "427050"
  },
  {
    "text": "will take all the multi tenant context and hide it away from the services",
    "start": "427050",
    "end": "432949"
  },
  {
    "text": "finally we look at storage partitioning and this is often where a lot of people when they're looking at SAS solutions I",
    "start": "433940",
    "end": "439949"
  },
  {
    "text": "think that's where it's at in fact what they'll do is they'll essentially take an environment they'll make a database",
    "start": "439949",
    "end": "445800"
  },
  {
    "text": "for every single tenant and then everything else stays the same and that'll be their multi-tenant environment and here we're not going to",
    "start": "445800",
    "end": "452220"
  },
  {
    "text": "dig a ton into storage partitioning strategies there's white papers I have out there and blog post and all kinds of other bits here we're just going to look",
    "start": "452220",
    "end": "458669"
  },
  {
    "text": "at in the context of this application how did we partition the data its stores and how do we resolve tenant context for",
    "start": "458669",
    "end": "466320"
  },
  {
    "text": "that storage partitioning and then the last piece of this application side of the house is one that most gets",
    "start": "466320",
    "end": "473520"
  },
  {
    "text": "overlooked and is often highest on my radar which is this notion of tenant isolation if you think about selling a",
    "start": "473520",
    "end": "481800"
  },
  {
    "text": "SAS product and you think about somebody coming to you and buying your product who's specially gonna maybe in a space",
    "start": "481800",
    "end": "488250"
  },
  {
    "text": "where they're very worried about their data but today actually the truth is generally just individuals are very worried about how their data is",
    "start": "488250",
    "end": "494190"
  },
  {
    "text": "protected but also how their environment and their resources are protected you have to have a scheme you have to have",
    "start": "494190",
    "end": "500310"
  },
  {
    "text": "an answer for those customers it says to them what have you done to ensure that my data my resources can't somehow be",
    "start": "500310",
    "end": "507479"
  },
  {
    "text": "accessed by another tenant imagine us having a SAS business and having some",
    "start": "507479",
    "end": "512880"
  },
  {
    "text": "tenant come back to you and say hey I'm seeing somebody else's data I I don't",
    "start": "512880",
    "end": "518070"
  },
  {
    "text": "know what's going on but I'm seeing their data what kind of ripple effect is that gonna have through your business that's gonna be huge so we have to look",
    "start": "518070",
    "end": "524399"
  },
  {
    "text": "at tenant isolation not just from the perspective of authentication yes we want to authenticate people we want to",
    "start": "524399",
    "end": "530130"
  },
  {
    "text": "be sure we have a good security wait get in the front door we want to look at how we can build layers of security in",
    "start": "530130",
    "end": "535769"
  },
  {
    "text": "here a multi-tenant security and we want to look at ways that we can apply policies and and rules here to prohibit",
    "start": "535769",
    "end": "543149"
  },
  {
    "text": "cross tenant access so if you came here thinking you know identity and isolation would be outside of the story they're",
    "start": "543149",
    "end": "549449"
  },
  {
    "text": "just sort of tangential concepts know they're gonna flow through this whole discussion cuz they're table stakes for",
    "start": "549449",
    "end": "554850"
  },
  {
    "text": "a SAS solution finally we'll look at a couple other topics very lightly here we'll talk about metrics cuz just",
    "start": "554850",
    "end": "562050"
  },
  {
    "text": "fundamentally metrics are super important metrics and analytics to assassin vironment s-- but unfortunately",
    "start": "562050",
    "end": "567149"
  },
  {
    "text": "just because of time constraints we won't be able to dig into that area but I just did a webinar on this I've got",
    "start": "567149",
    "end": "572249"
  },
  {
    "text": "other talks out there on this other members of my team have talks on metrics and analytics out there we talk in",
    "start": "572249",
    "end": "577290"
  },
  {
    "text": "factor about cost per tenant and things like that really important bits well touch on billing lightly also we won't",
    "start": "577290",
    "end": "583139"
  },
  {
    "text": "even get into management monitoring even though I think it's a super important topic but that's the architecture we",
    "start": "583139",
    "end": "588689"
  },
  {
    "text": "have and that's what that's the moving parts of it now what is the stack what",
    "start": "588689",
    "end": "593850"
  },
  {
    "start": "591000",
    "end": "591000"
  },
  {
    "text": "are the language what's the tools if you were to go get this out of github what would it look like what are you gonna get well the client of this is an",
    "start": "593850",
    "end": "601620"
  },
  {
    "text": "angularjs application hosted in an s3 bucket essentially what we try to do is",
    "start": "601620",
    "end": "607350"
  },
  {
    "text": "push all the client over the browser host it from the edge and obviously",
    "start": "607350",
    "end": "612689"
  },
  {
    "text": "we're angularjs and we wrote this a year ago and just like you would expect with UI frameworks there's already better",
    "start": "612689",
    "end": "618420"
  },
  {
    "text": "angular or there's already react and there's all kinds of other cool things we wish we probably would have used here that will be out date by next year's",
    "start": "618420",
    "end": "624839"
  },
  {
    "text": "reinvent probably I don't know it feels like those the client libraries move a lot but anyway we're for better worse",
    "start": "624839",
    "end": "631139"
  },
  {
    "text": "weren't angularjs and then we're going through the API gateway to get to our actual application services and we'll",
    "start": "631139",
    "end": "638129"
  },
  {
    "text": "look here at how we use this notion of a custom authorizer as one of the security layers of our application to control flow through that",
    "start": "638129",
    "end": "644339"
  },
  {
    "text": "gateway and limit access to the data and then finally we will get to the nuts and",
    "start": "644339",
    "end": "649410"
  },
  {
    "text": "bolts of what the application services are themselves and here you'll see these services there's a few of them that are",
    "start": "649410",
    "end": "655740"
  },
  {
    "text": "sort of domain services this is a really cheesy really lightweight order management system that does almost",
    "start": "655740",
    "end": "660899"
  },
  {
    "text": "nothing because we really weren't worried about what the app did we were more worried about the mechanisms here so you'll see order",
    "start": "660899",
    "end": "666780"
  },
  {
    "text": "management and product management but then you'll see a handful of other services here that are more about orchestrating the onboarding supporting",
    "start": "666780",
    "end": "673200"
  },
  {
    "text": "the isolation supporting the registration of users and so on and finally I have to list Cognito here",
    "start": "673200",
    "end": "679980"
  },
  {
    "text": "because a lot of this solution relies on Cognito it's using Cognito for identity it's using Cognito for as part of our",
    "start": "679980",
    "end": "686670"
  },
  {
    "text": "isolation story now that just because I have cogito here I wouldn't want you think this would only be achieved with",
    "start": "686670",
    "end": "692910"
  },
  {
    "text": "Cognito there's plenty of other good authentic providers that could be plugged in this equation and and solve",
    "start": "692910",
    "end": "699030"
  },
  {
    "text": "this problem for you there are some nuances with identity and kognito that give us some ways of applying isolation",
    "start": "699030",
    "end": "705810"
  },
  {
    "text": "that are kind of clever because i'm kognito has awareness of I am so it's",
    "start": "705810",
    "end": "711030"
  },
  {
    "text": "kind of helpful in that respect but don't think that you need to use all these tools these ways these concepts are still valid with or without the",
    "start": "711030",
    "end": "717840"
  },
  {
    "text": "tools I've chosen here the last bit and I'll go through this quickly is well",
    "start": "717840",
    "end": "722880"
  },
  {
    "text": "yeah but if I actually go install this thing and I go download it and I run the cloud formation that sets it all up and",
    "start": "722880",
    "end": "728310"
  },
  {
    "text": "I go look in the console what kind of resources are gonna get provision of that as part of that well you can",
    "start": "728310",
    "end": "734370"
  },
  {
    "text": "imagine we've built this using sort of the best practices well architected model for any",
    "start": "734370",
    "end": "739920"
  },
  {
    "text": "QuickStart or any solution that's out there at AWS we built for redundancy and high availability and so on here so",
    "start": "739920",
    "end": "746370"
  },
  {
    "text": "we've got a multi a Z solution we're running in a V PC and then our client is",
    "start": "746370",
    "end": "752520"
  },
  {
    "text": "out at the edge running in s3 coming through the API gateway with this custom authorizer I mentioned and then we have",
    "start": "752520",
    "end": "758490"
  },
  {
    "text": "public and private subnets so at the public subnet we just have a NAT gateway because we don't want our services in",
    "start": "758490",
    "end": "764130"
  },
  {
    "text": "the public subnet and then you'll see here we got load balanced access to our",
    "start": "764130",
    "end": "769170"
  },
  {
    "text": "private subnet where our services are going to reside and then we actually have our services which are running in",
    "start": "769170",
    "end": "774420"
  },
  {
    "text": "an e CS cluster this is like you could just didn't you could take SAS off the",
    "start": "774420",
    "end": "779460"
  },
  {
    "text": "branding of this entirely and just say this is you know sort of a boilerplate approach to just a good ECS architecture",
    "start": "779460",
    "end": "788400"
  },
  {
    "text": "so anyway that's the that's the moving parts of it let's now get into the",
    "start": "788400",
    "end": "793890"
  },
  {
    "start": "793000",
    "end": "793000"
  },
  {
    "text": "onboarding and like I said onboarding out to me has lots more moving parts to it took a while to write the onboarding",
    "start": "793890",
    "end": "799899"
  },
  {
    "text": "bits of this and I'm gonna do two phases to looking at onboarding I'm gonna look at the surface of onboarding even though",
    "start": "799899",
    "end": "806350"
  },
  {
    "text": "it's not very technical and just go with me for a minute because this isn't about the UI but I'm gonna show you the",
    "start": "806350",
    "end": "812290"
  },
  {
    "text": "surface and then we'll talk about why that surface is important and then we'll dig underneath it a little bit but if",
    "start": "812290",
    "end": "817480"
  },
  {
    "text": "you look at the onboarding of this application it's just a very simple collect my data tell them what tier I'm",
    "start": "817480",
    "end": "823480"
  },
  {
    "text": "signing up for cuz usually when you sign up for a SAS solution you provided tier and then once I sign up and push",
    "start": "823480",
    "end": "828759"
  },
  {
    "text": "register I'll get a message saying hooray you you did it I'll get an email sent to me that tells me you've signed",
    "start": "828759",
    "end": "835629"
  },
  {
    "text": "up validate who you are here's some temporary credentials I'll log in with my temporary credentials the system will",
    "start": "835629",
    "end": "843009"
  },
  {
    "text": "detect that hey you have a temporary password it'll challenge me to change my password a flow you've probably seen",
    "start": "843009",
    "end": "848769"
  },
  {
    "text": "probably much more elegant than this but generally seen in a whole bunch of applications so why did I show you this",
    "start": "848769",
    "end": "855660"
  },
  {
    "text": "well the point of all showing you this is that almost all the moving parts of",
    "start": "855660",
    "end": "861399"
  },
  {
    "text": "this if you were to like open up the Quick Start and look under the hood of the QuickStart and look at the implementation of this you'd find that",
    "start": "861399",
    "end": "867579"
  },
  {
    "text": "almost none of our code is orchestrating this process Cognito is doing almost all",
    "start": "867579",
    "end": "872829"
  },
  {
    "text": "the heavy lifting here the email that gets sent the template of the email that gets set the generation of the temporary",
    "start": "872829",
    "end": "879579"
  },
  {
    "text": "password the challenge when my I log in to recognize that I've got a temporary password and the reset of this the",
    "start": "879579",
    "end": "886420"
  },
  {
    "text": "password policy that is the policy that says what characters are accepted and how long does it need to be those are",
    "start": "886420",
    "end": "892240"
  },
  {
    "text": "all part of Cognito and so my point here is whichever solution you build on your own if you're orchestrating all of this",
    "start": "892240",
    "end": "898839"
  },
  {
    "text": "on your own and implementing all these policies on your own you shouldn't be you should be relying on somebody else",
    "start": "898839",
    "end": "904990"
  },
  {
    "text": "to do that because guess what this space is changing all the time all kinds of new identity mechanisms are coming along",
    "start": "904990",
    "end": "910899"
  },
  {
    "text": "here we even with incognito I can say do you want multi-factor authentication what's password expiration policies all",
    "start": "910899",
    "end": "917679"
  },
  {
    "text": "these other goodness and it's all not part of my code so the reason the only reason I showed you that was that now",
    "start": "917679",
    "end": "923529"
  },
  {
    "text": "let's look underneath the hood of it so now these are the services that were orchestrating underneath it the micro",
    "start": "923529",
    "end": "928990"
  },
  {
    "start": "924000",
    "end": "924000"
  },
  {
    "text": "services that are part of the solution and so when you push that register button on this application and you hit",
    "start": "928990",
    "end": "934360"
  },
  {
    "text": "the registration service it will then orchestrate the creation of all the moving parts and the first thing",
    "start": "934360",
    "end": "940450"
  },
  {
    "text": "it does is go to the user management and service and say I need to create the identity for the user that just signed",
    "start": "940450",
    "end": "945940"
  },
  {
    "text": "up so it it will go out to Cognito and in this case we're using Cognito by the",
    "start": "945940",
    "end": "951790"
  },
  {
    "text": "way and in an open ID Connect model so there are many people who implement open ID Connect it's an open standard and we",
    "start": "951790",
    "end": "958449"
  },
  {
    "text": "very much rely on that model for our solution and then within open ID Connect we we configure some very important",
    "start": "958449",
    "end": "965709"
  },
  {
    "text": "moving parts here the first one and the most controversial one is probably this user pool when we first built this we",
    "start": "965709",
    "end": "972850"
  },
  {
    "text": "said in fact it's still this way today we said it would be really nice to have one user pool for each tenant in our",
    "start": "972850",
    "end": "979720"
  },
  {
    "text": "system because if and we thought that was a really good idea because we thought when we when we want",
    "start": "979720",
    "end": "986050"
  },
  {
    "text": "to go configure all these options that are available passwords MFA all these things I just talked about they're",
    "start": "986050",
    "end": "991570"
  },
  {
    "text": "configured at the user pool level and so this gives us a way it gives us a way to",
    "start": "991570",
    "end": "997540"
  },
  {
    "text": "pass that ability along to the tenant and let the tenant decide what do you want your password policy to be what do",
    "start": "997540",
    "end": "1003300"
  },
  {
    "text": "you want your what do you want your MFA policy to be and each tenant could have",
    "start": "1003300",
    "end": "1008850"
  },
  {
    "text": "their own sort of rules for that that didn't turn out to be a great decision",
    "start": "1008850",
    "end": "1014550"
  },
  {
    "text": "and I'll talk about why in a minute it's I wouldn't say it's a bad decision as much as it comes with some constraints that you'll want to be aware",
    "start": "1014550",
    "end": "1020790"
  },
  {
    "text": "of also we have to provision an identity pool this is just a moving part of Cognito which is our federated identity",
    "start": "1020790",
    "end": "1026730"
  },
  {
    "text": "and then we actually have to create this very first user who's the user our system the admin user and then the last",
    "start": "1026730",
    "end": "1033150"
  },
  {
    "text": "bit is the most important piece you should note on this slide is this custom claims so Open ID Connect has this",
    "start": "1033150",
    "end": "1040140"
  },
  {
    "text": "notion of a set of attributes that are claims that are the standard claims that",
    "start": "1040140",
    "end": "1045178"
  },
  {
    "text": "are part of the specification name and email address phone numbers things you would expect but it also says hey if you",
    "start": "1045179",
    "end": "1051240"
  },
  {
    "text": "want to introduce any of your own custom attributes you can add your own claims",
    "start": "1051240",
    "end": "1056270"
  },
  {
    "text": "to the to the identity profile and those claims will follow you as a user through",
    "start": "1056270",
    "end": "1063240"
  },
  {
    "text": "the system well you can imagine what represented to us when we looked at it we said well we have these users we've",
    "start": "1063240",
    "end": "1069240"
  },
  {
    "text": "got these users in the system but we want to bind these users to tenants and we want to know about the tenants tier",
    "start": "1069240",
    "end": "1074820"
  },
  {
    "text": "and their status and all these other things as we look at individual users if we bind them to the user here through",
    "start": "1074820",
    "end": "1081600"
  },
  {
    "text": "these custom claims they'll just follow us through the whole process so that's",
    "start": "1081600",
    "end": "1087240"
  },
  {
    "text": "so we introduce those custom claims we configure them we configure tier and client I'm sorry status and tenant ID",
    "start": "1087240",
    "end": "1095010"
  },
  {
    "text": "and so on as part of custom claims then we go over to I am and then I am we go",
    "start": "1095010",
    "end": "1100890"
  },
  {
    "text": "over and configure some policies I'm not going to dig into these policies here right now but essentially for every role",
    "start": "1100890",
    "end": "1105930"
  },
  {
    "text": "for the tenant we provision a set of policies and these policies are going to be used as part of our tenant isolation",
    "start": "1105930",
    "end": "1112560"
  },
  {
    "text": "story I'll circle back to how they come into play near the end of the talk",
    "start": "1112560",
    "end": "1117740"
  },
  {
    "text": "finally at the user management service you'll see that I map the user to the",
    "start": "1117740",
    "end": "1123570"
  },
  {
    "text": "user pool and that may not be so obvious from the diagram but this is what I'm talking about user to user pool and here's one of the",
    "start": "1123570",
    "end": "1130980"
  },
  {
    "text": "points of having a tenant per user pool that's a problem with this implementation I'm going to have to",
    "start": "1130980",
    "end": "1137010"
  },
  {
    "text": "authenticate at some point and when I have to authenticate I have to authenticate against the user pool but when the user comes in I don't know what",
    "start": "1137010",
    "end": "1143010"
  },
  {
    "text": "user pool they're part of so I have to introduce this user management service that has one role is to map the user to",
    "start": "1143010",
    "end": "1148740"
  },
  {
    "text": "the user pools so I know what to auth against now that means that the data",
    "start": "1148740",
    "end": "1154170"
  },
  {
    "text": "that doesn't mean data about the user relies and you lives in user management it still lives in the identity provider",
    "start": "1154170",
    "end": "1159690"
  },
  {
    "text": "and it should stay in the provider identity provider instead we just have this mapping here finally we actually",
    "start": "1159690",
    "end": "1166590"
  },
  {
    "text": "have to create the tenant we still didn't have a tenant yet so we have to go out and put the footprint of a tenant here what's our ID what plan what's",
    "start": "1166590",
    "end": "1173190"
  },
  {
    "text": "their status what are all the attributes and policies you might have about your tenant and there's an important takeaway here which is when we first provision",
    "start": "1173190",
    "end": "1180690"
  },
  {
    "text": "this the user we provision here will have a one to one relationship with the tenant however over the life cycle of",
    "start": "1180690",
    "end": "1187290"
  },
  {
    "text": "this tenant we will add users and so on and they'll actually be a one to many relationship between tenants and users",
    "start": "1187290",
    "end": "1195049"
  },
  {
    "text": "now just to show you we talked about these custom claims if you were to crack open the",
    "start": "1195830",
    "end": "1200880"
  },
  {
    "start": "1197000",
    "end": "1197000"
  },
  {
    "text": "console and look inside of Cognito after you at provision a new tenant you'd see these custom attributes got populated so",
    "start": "1200880",
    "end": "1207750"
  },
  {
    "text": "here you'll see tenant ID tier company name and so on these are those custom attributes that are so fundamental to",
    "start": "1207750",
    "end": "1213210"
  },
  {
    "text": "what we're doing the last piece of this provisioning is the billing piece of it now a lot of people don't factor billing",
    "start": "1213210",
    "end": "1220230"
  },
  {
    "start": "1215000",
    "end": "1215000"
  },
  {
    "text": "into the wrong boarding but the truth is if I'm setting up a brand new user I've got to be charging that user somehow and",
    "start": "1220230",
    "end": "1226170"
  },
  {
    "text": "in most systems that charging is done based on some formula of consumption or number of users or something so I have",
    "start": "1226170",
    "end": "1233520"
  },
  {
    "text": "to go set that account up in some kind of system typically a third party system",
    "start": "1233520",
    "end": "1238560"
  },
  {
    "text": "hopefully but if it's not even if it's your own external system you still have to your own internal system you still",
    "start": "1238560",
    "end": "1244200"
  },
  {
    "text": "have to go provision that account so what I want to say here is hey this account eventually has to exist but I",
    "start": "1244200",
    "end": "1251670"
  },
  {
    "text": "don't want my registration process to count on the creation of that account right now if so for some reason that the",
    "start": "1251670",
    "end": "1259320"
  },
  {
    "text": "billing system isn't upwards doesn't succeed at creating it I don't want the whole registration process to fail so",
    "start": "1259320",
    "end": "1265770"
  },
  {
    "text": "what I do here is I just send to a queue okay go create the the tenant I want to",
    "start": "1265770",
    "end": "1271950"
  },
  {
    "text": "created I'm done go ahead registration you're done you succeeded go go let the tenant know that there they can log in",
    "start": "1271950",
    "end": "1278700"
  },
  {
    "text": "right now and then in the background I'll have another service that will actually pull the message out of the",
    "start": "1278700",
    "end": "1283950"
  },
  {
    "text": "queue talk to the billing system and say hey I'm gonna try to create the account in the billing system here and if it",
    "start": "1283950",
    "end": "1289890"
  },
  {
    "text": "fails for some reason I'll have some kind of fallback strategy here we'll keep retrying till it gets created but",
    "start": "1289890",
    "end": "1296940"
  },
  {
    "text": "conceptually here make sure you realize that somewhere out there in this billing system is the notion of your account for",
    "start": "1296940",
    "end": "1303300"
  },
  {
    "text": "this customer and over the life cycle of this there's going to be a point at which somebody's going to go in and who",
    "start": "1303300",
    "end": "1309120"
  },
  {
    "text": "manages that account and says I may need to up some update something about this tenant they move from basic tier to",
    "start": "1309120",
    "end": "1315840"
  },
  {
    "text": "premium tier or they're not paying their bill and so they're going from there going their status is going to go to on",
    "start": "1315840",
    "end": "1321990"
  },
  {
    "text": "hold or something of that nature so I also have to have an integration it's not here and it's not in the example but",
    "start": "1321990",
    "end": "1327960"
  },
  {
    "text": "I want you to realize there's also an integration that has to come I can update the tenant status in that",
    "start": "1327960",
    "end": "1333090"
  },
  {
    "text": "tenant management system from your account management okay everything's",
    "start": "1333090",
    "end": "1338490"
  },
  {
    "text": "here and just one more caveat often another big piece of this onboarding that isn't here is is the provisioning",
    "start": "1338490",
    "end": "1346200"
  },
  {
    "text": "of actual infrastructure if you're in a siloed environment and each tenant has their own infrastructure that would mean",
    "start": "1346200",
    "end": "1352080"
  },
  {
    "text": "our onboarding would also have to include provisioning and configuration here that would go out and actually",
    "start": "1352080",
    "end": "1357630"
  },
  {
    "text": "create whatever infrastructures needed okay tenants n tenants created the whole",
    "start": "1357630",
    "end": "1365460"
  },
  {
    "start": "1361000",
    "end": "1361000"
  },
  {
    "text": "identity profiles created now let's get a user into the actual system let's off them so now the app comes in we the",
    "start": "1365460",
    "end": "1374010"
  },
  {
    "text": "tenant comes in they hit our web app and in a normal authentication flow the web",
    "start": "1374010",
    "end": "1379409"
  },
  {
    "text": "app would typically go right here and redirect to the identity provider and say go off them but we have a challenge",
    "start": "1379409",
    "end": "1386220"
  },
  {
    "text": "here we can't go straight to the identity provider because we don't know which user pool to authenticate you",
    "start": "1386220",
    "end": "1392100"
  },
  {
    "text": "against so this is caveat number two related to having a tenant per user pool",
    "start": "1392100",
    "end": "1397980"
  },
  {
    "text": "I need to go get what's user pools so we have an auth manager service well now my auth manager service is a point of",
    "start": "1397980",
    "end": "1404549"
  },
  {
    "text": "failure in my identity process something I have to absorb and think about for scale here enough caveats on that why",
    "start": "1404549",
    "end": "1410940"
  },
  {
    "text": "I'm just gonna add real quick as a tangent so when you look at user pools and you're thinking about how many",
    "start": "1410940",
    "end": "1416250"
  },
  {
    "text": "whether you should have user pool poor tenant think about how many tenants you're going to have in your system if you tell me you don't ever have a",
    "start": "1416250",
    "end": "1421950"
  },
  {
    "text": "hundred tenants in your system use user pool because all the things that are good about it are still good about it if you tell me you're gonna have 10,000",
    "start": "1421950",
    "end": "1428460"
  },
  {
    "text": "users in your system you might not be able to use user pool per tenant that may not be a good fit for you now we go to the auth manager the auth",
    "start": "1428460",
    "end": "1436980"
  },
  {
    "text": "manager goes to that user manager we had before it looks in there to say I need",
    "start": "1436980",
    "end": "1442200"
  },
  {
    "text": "to find the user pool for this particular user ID and does the mapping goes out to Amazon Cognito and says find",
    "start": "1442200",
    "end": "1449730"
  },
  {
    "text": "me that user pool because that's the pool I need to off against and it returns that back to the off manager now",
    "start": "1449730",
    "end": "1455909"
  },
  {
    "text": "if the user didn't have a mapping the user pool or it didn't find it incognito we'd fail the authentication but in the",
    "start": "1455909",
    "end": "1462390"
  },
  {
    "text": "scenario where it succeeds we go out and off against kognito now",
    "start": "1462390",
    "end": "1468460"
  },
  {
    "text": "most of this is pretty straightforward and it's already probably obvious but this token that comes back from the auth",
    "start": "1468460",
    "end": "1475399"
  },
  {
    "text": "experience and I show ID token the truth is there's ID token there's an access token there's actually there's think",
    "start": "1475399",
    "end": "1481100"
  },
  {
    "text": "there's three tokens from that Oh somebody help me there's a third one refresh thank you very much I lost it",
    "start": "1481100",
    "end": "1486350"
  },
  {
    "text": "there for a minute there's three tokens and in fact open ID Connect defines a very specific way these tokens are",
    "start": "1486350",
    "end": "1491539"
  },
  {
    "text": "supposed to be used ID token versus access token I'm not going to dig into all that but know that the goodness of",
    "start": "1491539",
    "end": "1498019"
  },
  {
    "text": "these ID tokens now have these custom claims that we defined embedded them so",
    "start": "1498019",
    "end": "1503210"
  },
  {
    "text": "not only do I have the user identity in here I also have the tenant identity in here as well and that is now going to be",
    "start": "1503210",
    "end": "1509630"
  },
  {
    "text": "key to when we write our application services so speaking of application",
    "start": "1509630",
    "end": "1516019"
  },
  {
    "start": "1513000",
    "end": "1513000"
  },
  {
    "text": "services we now have the context were authenticated and we want to flow into",
    "start": "1516019",
    "end": "1521120"
  },
  {
    "text": "one of those authentic those application services and now we're going to go get products out of a DynamoDB database for",
    "start": "1521120",
    "end": "1528230"
  },
  {
    "text": "our product management service and so we're going to take an HB request in and that HP request is going to be just like",
    "start": "1528230",
    "end": "1534559"
  },
  {
    "text": "any other HB request on our service but in the header of this h-2b request is",
    "start": "1534559",
    "end": "1539750"
  },
  {
    "text": "going to be a bearer token and that token of course is the jot token that I",
    "start": "1539750",
    "end": "1546649"
  },
  {
    "text": "just spoke about a second ago the JWT token now the product management service shouldn't care about the fact that",
    "start": "1546649",
    "end": "1553340"
  },
  {
    "text": "there's a bearer token there I don't want the service manipulating that token open it up doing any kind of work with",
    "start": "1553340",
    "end": "1560299"
  },
  {
    "text": "that I like I said at the beginning I want these services to not have to know a lot about multi-tenancy so what I'm",
    "start": "1560299",
    "end": "1567500"
  },
  {
    "text": "going to do is I'm going to introduce some helpers here and by the way I'm going to add caveat zero that I think",
    "start": "1567500",
    "end": "1572750"
  },
  {
    "text": "there's a better helper scheme than what we actually implemented but I want to show you what we actually implemented we",
    "start": "1572750",
    "end": "1578149"
  },
  {
    "text": "created this little note node module just a little helper and we said everything about token management",
    "start": "1578149",
    "end": "1583850"
  },
  {
    "text": "everything about the manipulation of tokens is going to be buried over there so that the product management service doesn't have to know about it and so",
    "start": "1583850",
    "end": "1590840"
  },
  {
    "text": "when the product management service says I need a tenant ID because I want to do something with the tenant it just says",
    "start": "1590840",
    "end": "1596299"
  },
  {
    "text": "get tenant ID at hands the Qwest into the token manager and says I don't even know what's in there but",
    "start": "1596299",
    "end": "1601669"
  },
  {
    "text": "somehow I know it's in there somewhere go crack it open token manager decode it",
    "start": "1601669",
    "end": "1606769"
  },
  {
    "text": "and send me back the tenant ID okay now I have the tenant ID and I'm about to",
    "start": "1606769",
    "end": "1612139"
  },
  {
    "text": "call storage and you could say right now um I have everything I need because the",
    "start": "1612139",
    "end": "1618139"
  },
  {
    "text": "truth is I I could take that tenant ID I could formulate a call to the SDK and dynamodb and that would return to me the",
    "start": "1618139",
    "end": "1625460"
  },
  {
    "text": "appropriate items from the database but I really worry about when somebody goes",
    "start": "1625460",
    "end": "1632239"
  },
  {
    "text": "to access data whether or not they're accessing in the context of the tenant",
    "start": "1632239",
    "end": "1637340"
  },
  {
    "text": "that they're currently handling I don't this is all the way back to that isolation story when somebody goes to",
    "start": "1637340",
    "end": "1643580"
  },
  {
    "text": "get to data I want to be able to say to them you can only get to the items in that database that are valid for you",
    "start": "1643580",
    "end": "1649369"
  },
  {
    "text": "tenant and if somebody in that code tries to cross that boundary I'm gonna stop them so what I'm gonna do now is a",
    "start": "1649369",
    "end": "1655489"
  },
  {
    "text": "secondary step which is I'm going to go out to my token manager and say go get me credentials passing that same request",
    "start": "1655489",
    "end": "1662809"
  },
  {
    "text": "in it'll crack the token open and it'll give me about a second set of credentials now we're gonna dig into",
    "start": "1662809",
    "end": "1667999"
  },
  {
    "text": "that process and what happens under the hood of that in code in a minute but for",
    "start": "1667999",
    "end": "1673190"
  },
  {
    "text": "a moment just trust me when it comes back it gets a set of scoped credentials and it uses those credentials as the",
    "start": "1673190",
    "end": "1679759"
  },
  {
    "text": "credentials to wit the SDK to go access and get those items out of the database with the assumption that those",
    "start": "1679759",
    "end": "1685669"
  },
  {
    "text": "credentials are scoped in a way that that I will not be able to cross the tenant boundary now you could argue",
    "start": "1685669",
    "end": "1692239"
  },
  {
    "text": "that's a whole lot of extra work I could have just used a global set of credentials there my code would have",
    "start": "1692239",
    "end": "1698359"
  },
  {
    "text": "been simpler there's not all this I am bits involved and I would say to you this is back to the isolation story I",
    "start": "1698359",
    "end": "1704659"
  },
  {
    "text": "was sort of harping on at the beginning of this this is essential to protecting your data and preventing cross tented",
    "start": "1704659",
    "end": "1710600"
  },
  {
    "text": "access and you do have to implement it this way no but you ought to be thinking about some way to do this so that gets",
    "start": "1710600",
    "end": "1717499"
  },
  {
    "text": "me the protection I need now we implemented this as a token manager and it's awesome but to me the truth is this",
    "start": "1717499",
    "end": "1724279"
  },
  {
    "text": "product management service should have never known anything about tenet ID it shouldn't even know anything about get credentials it should have just called",
    "start": "1724279",
    "end": "1730399"
  },
  {
    "text": "the data access and said get me some products data access layer should've did all these",
    "start": "1730399",
    "end": "1735530"
  },
  {
    "text": "calls under the hood of the data access layer and just got me the rose and returned them that would have been the better implementation that would be a",
    "start": "1735530",
    "end": "1741710"
  },
  {
    "text": "great of all waited with all this we haven't done it yet so I want to show you at least what you get when you download it now step one of getting",
    "start": "1741710",
    "end": "1753950"
  },
  {
    "text": "these credentials is is to just look at what it means to pull the token out and this is no js' code here but if you will",
    "start": "1753950",
    "end": "1761810"
  },
  {
    "text": "follow the pseudocode it's pretty straightforward if you look at the top here's get credentials from from token",
    "start": "1761810",
    "end": "1767360"
  },
  {
    "text": "and it takes our request in and then on the second parameter you'll see it take it has update credentials and in nodejs",
    "start": "1767360",
    "end": "1773870"
  },
  {
    "text": "they just use callback functions to return a result all the time so update credentials is actually a function",
    "start": "1773870",
    "end": "1779390"
  },
  {
    "text": "pointer we're gonna call that function pointer when we're done and use it to pass the result back to the caller",
    "start": "1779390",
    "end": "1784670"
  },
  {
    "text": "so then inside the function well not if I go forward it won't push the right",
    "start": "1784670",
    "end": "1789920"
  },
  {
    "text": "button I'm gonna break open the bearer token if it's a good bearer token I'm going to parse it out decode it and then",
    "start": "1789920",
    "end": "1797840"
  },
  {
    "text": "I'm gonna do some magic steps here that we're gonna look at later which is actually gonna go get me these scope credentials and then the last step this",
    "start": "1797840",
    "end": "1804530"
  },
  {
    "text": "function at the end assuming I come back with the results that are successful I'm gonna call update credentials that",
    "start": "1804530",
    "end": "1810020"
  },
  {
    "text": "callback function and return back the credentials now that gets me that's",
    "start": "1810020",
    "end": "1815510"
  },
  {
    "text": "that's the details of sort of cracking open the token but we really haven't showed you yet still how that token gets",
    "start": "1815510",
    "end": "1820910"
  },
  {
    "text": "mapped to the policies we're gonna get there now so far the layer security I",
    "start": "1820910",
    "end": "1827420"
  },
  {
    "text": "talked about was all the way down in the service we use these credentials and we said hey this service can't cross a boundary now and it tries to get data",
    "start": "1827420",
    "end": "1834010"
  },
  {
    "text": "but we can also protect ours our environment and protect our data and protect our resources at the API gateway",
    "start": "1834010",
    "end": "1841640"
  },
  {
    "text": "level of our solution as well and like I said I want security over level just because I have it down in the service",
    "start": "1841640",
    "end": "1847010"
  },
  {
    "text": "doesn't mean I'm not gonna wander up the tiers of the architecture and say where else can I prevent somebody from getting",
    "start": "1847010",
    "end": "1852440"
  },
  {
    "text": "through and so here at the API gateway we have this same old token coming in that is an awesome token with all the",
    "start": "1852440",
    "end": "1858560"
  },
  {
    "text": "goodness we talked about and now we can put this lambda function out there call the custom authorizer",
    "start": "1858560",
    "end": "1864160"
  },
  {
    "text": "and this custom authorizer will let us crack open that token see who you are as a tenant see what role you're in and",
    "start": "1864160",
    "end": "1870910"
  },
  {
    "text": "decide which paths through the API gateway are allowed for you so that I only open up the paths to services that",
    "start": "1870910",
    "end": "1878049"
  },
  {
    "text": "you're allowed to touch now if we crack that open and we look inside that and",
    "start": "1878049",
    "end": "1883450"
  },
  {
    "start": "1882000",
    "end": "1882000"
  },
  {
    "text": "this is a much more simplified version of the code paired down from that what you'll actually see but the concepts are",
    "start": "1883450",
    "end": "1889090"
  },
  {
    "text": "here essentially I'll go out I'll get that I'll get the jot token out of the request you'll see here then I'll",
    "start": "1889090",
    "end": "1895720"
  },
  {
    "text": "construct this off policy you'll see the off policy this is just an API gateway construct here that is that is the",
    "start": "1895720",
    "end": "1902679"
  },
  {
    "text": "policy that's going to tell me which paths are allowed through the API gateway and then the part you really",
    "start": "1902679",
    "end": "1907840"
  },
  {
    "text": "want to pay attention to is this if statement in this if statement I'll look in the token and say are you an admin oh",
    "start": "1907840",
    "end": "1914080"
  },
  {
    "text": "you're an admin then I'll configure this policy object to say every path through the API gateways allowed if you're not",
    "start": "1914080",
    "end": "1921490"
  },
  {
    "text": "an admin I'm gonna constrain this to only allow a get on all the functions and I'm gonna allow you one post to",
    "start": "1921490",
    "end": "1928330"
  },
  {
    "text": "create users now obviously the the final version of this looks more elaborate than this but you can see how this",
    "start": "1928330",
    "end": "1933970"
  },
  {
    "text": "policies control paths through the API gateway and you can see how looking at",
    "start": "1933970",
    "end": "1939190"
  },
  {
    "text": "that token would let me say hey you're an admin role you're and there's like four or five roles in the system based",
    "start": "1939190",
    "end": "1945250"
  },
  {
    "text": "on each one of those roles I will open up the pass through to varying degrees",
    "start": "1945250",
    "end": "1951419"
  },
  {
    "text": "okay so we looked at app services we looked at how our app service got the token and used it to get to data well",
    "start": "1952830",
    "end": "1959470"
  },
  {
    "start": "1953000",
    "end": "1953000"
  },
  {
    "text": "what did we really do to represent data in our system and we used a pretty straightforward model because we really",
    "start": "1959470",
    "end": "1965799"
  },
  {
    "text": "didn't want to go way down the sort of the rat hole of all the different things you need to think about partitioning so",
    "start": "1965799",
    "end": "1970900"
  },
  {
    "text": "here we basically said let's use DynamoDB to store our products and in this case we're going to store our",
    "start": "1970900",
    "end": "1976780"
  },
  {
    "text": "products and we're going to use the partition key this is a pooled model for storage so instead of having separate",
    "start": "1976780",
    "end": "1982450"
  },
  {
    "text": "databases or separate tables here we're using a shared table for all tenants and in the partition key I will",
    "start": "1982450",
    "end": "1989740"
  },
  {
    "text": "sorry about that pointing the wrong place in the partition key I will put the tenant ID so you'll see that in the",
    "start": "1989740",
    "end": "1995980"
  },
  {
    "text": "left-hand side of that table and that will be my way of determining which data belongs to which tenants and then",
    "start": "1995980",
    "end": "2003120"
  },
  {
    "text": "what we've done here is we've said let's put something between the service and the actual access to the data so that",
    "start": "2003120",
    "end": "2011070"
  },
  {
    "text": "the service itself doesn't know anything about the partitioning scheme so when we go through DynamoDB helper here this",
    "start": "2011070",
    "end": "2017010"
  },
  {
    "text": "helper class it's the helpers job to say is it a key is at a table which table how do I",
    "start": "2017010",
    "end": "2022860"
  },
  {
    "text": "figure out how to do all that make that all dynamodb spa responsibility and then let all that happen on the other side of",
    "start": "2022860",
    "end": "2029010"
  },
  {
    "text": "the line and to me that's an important point because I never want my application service is going well what's",
    "start": "2029010",
    "end": "2035100"
  },
  {
    "text": "the connection string oh this is two separate tables for each tenant so here's how I'll resolve it - a",
    "start": "2035100",
    "end": "2040140"
  },
  {
    "text": "connection string and then that ends up in the service and it ends up propagated across all the services in the system",
    "start": "2040140",
    "end": "2045600"
  },
  {
    "text": "instead I want the partitioning scheme on the other side of some helper and then just for for an example here I also",
    "start": "2045600",
    "end": "2053220"
  },
  {
    "text": "want to make it clear that you could have other kinds of storage on the other side of the service so I said what if we added product images they're not in the",
    "start": "2053220",
    "end": "2059790"
  },
  {
    "text": "current solution you'll get but if we added product images to our product catalog we'd added Amazon s3 helper and",
    "start": "2059790",
    "end": "2065639"
  },
  {
    "text": "in this case we have a different partitioning scheme we'd use tags on s3 objects to say which objects in the s3",
    "start": "2065640",
    "end": "2072780"
  },
  {
    "text": "buckets belong to which tenants from the consumer of the product management's perspective this is all just you know a",
    "start": "2072780",
    "end": "2080700"
  },
  {
    "text": "rest interface and I don't care about how the data is represented now this is",
    "start": "2080700",
    "end": "2087690"
  },
  {
    "start": "2086000",
    "end": "2086000"
  },
  {
    "text": "going to look like a really simple function and it is but there's an important caveat in this function this",
    "start": "2087690",
    "end": "2093000"
  },
  {
    "text": "is the function that actually goes out and gets the data from dynamodb and if you look at this function this is the",
    "start": "2093000",
    "end": "2099600"
  },
  {
    "text": "down stream we've got the credentials we've got those scope credentials that we talked about earlier those credentials come into here as a",
    "start": "2099600",
    "end": "2106650"
  },
  {
    "text": "parameter on that function that you see there and then we configure the search parameters for our dynamodb sdk call so",
    "start": "2106650",
    "end": "2113400"
  },
  {
    "text": "you'll see here I put the table name in and then I put the tenant ID which was",
    "start": "2113400",
    "end": "2119370"
  },
  {
    "text": "acquired in a scope outside of here into this expression I construct this dynamodb helper Opik object and I call",
    "start": "2119370",
    "end": "2127020"
  },
  {
    "text": "query on it to go get the products really basic really straight forward but one nuance in here that was",
    "start": "2127020",
    "end": "2134070"
  },
  {
    "text": "really challenging for us at least was that you'll notice here I passed the credentials to the dynamodb helper when",
    "start": "2134070",
    "end": "2140850"
  },
  {
    "text": "I construct it when we looked at other sort of wrappers of dynamodb and other",
    "start": "2140850",
    "end": "2146190"
  },
  {
    "text": "tools because we really didn't want to write a helper ourselves we found that most of those tools had a global",
    "start": "2146190",
    "end": "2152280"
  },
  {
    "text": "configuration of the module that once it got the creds those were the creds for",
    "start": "2152280",
    "end": "2157560"
  },
  {
    "text": "the life of that of that you know instance well in our case here those",
    "start": "2157560",
    "end": "2162990"
  },
  {
    "text": "credentials change every single call potentially and so we needed the",
    "start": "2162990",
    "end": "2168870"
  },
  {
    "text": "DynamoDB interactions to apply brand-new credentials every time and the only way we could find to do it was to create our",
    "start": "2168870",
    "end": "2175050"
  },
  {
    "text": "own wrapper around DynamoDB sdk to do it now my guess is since we created this or just because we couldn't figure it out",
    "start": "2175050",
    "end": "2181080"
  },
  {
    "text": "there's some library out that does this and by all means if you find one a let me know and be use it instead of this",
    "start": "2181080",
    "end": "2188610"
  },
  {
    "text": "approach ok so we've talked about",
    "start": "2188610",
    "end": "2194580"
  },
  {
    "text": "credentials and getting this data and identity and all these things in the storage and it sort of looks like I've",
    "start": "2194580",
    "end": "2202800"
  },
  {
    "text": "isolated the data with those credentials but the truth is right now with the implementation as I've showed it to you",
    "start": "2202800",
    "end": "2209040"
  },
  {
    "text": "I really haven't done anything that connects the ID the the ID of the user",
    "start": "2209040",
    "end": "2215160"
  },
  {
    "text": "the identity of the user to it these iam policies that were created so right now when 10 and 8 comes in and they evoke",
    "start": "2215160",
    "end": "2222540"
  },
  {
    "text": "this function to go get the items out of the database yes they're going to go get credentials but the truth is they could",
    "start": "2222540",
    "end": "2228510"
  },
  {
    "text": "plug any tenant ID they want into that request so instead of 10 at 8 they could put 10 at 1 into that request and go get",
    "start": "2228510",
    "end": "2235170"
  },
  {
    "text": "out items for 10 at 1 because there's nothing that connects the identity to the policies that enforce that access so",
    "start": "2235170",
    "end": "2243390"
  },
  {
    "text": "that's the missing piece I need to plug in for you and it's probably of the pieces to me at least the most confusing",
    "start": "2243390",
    "end": "2249450"
  },
  {
    "text": "one so hopefully I'll I'll straighten it out for you so part 1 of solving this problem of connecting the policies to",
    "start": "2249450",
    "end": "2256110"
  },
  {
    "start": "2253000",
    "end": "2253000"
  },
  {
    "text": "the identity is we need to look at what's actually in the policies so if you look if you remember at the very",
    "start": "2256110",
    "end": "2262080"
  },
  {
    "text": "beginning I said we're provision in these iam policies and I'll tell you what they're all about here's an example we",
    "start": "2262080",
    "end": "2267299"
  },
  {
    "text": "have these rolls and I have one example of one roll here and what you want to look at is at the very bottom of this",
    "start": "2267299",
    "end": "2273509"
  },
  {
    "text": "policy where you see the conditions section you'll see it down here and in",
    "start": "2273509",
    "end": "2279509"
  },
  {
    "text": "this condition section we have specifically this idea of a leading key and then what the leading key says is",
    "start": "2279509",
    "end": "2285930"
  },
  {
    "text": "essentially this value must be the leading value in the partition key or you can't access the data in this case",
    "start": "2285930",
    "end": "2293819"
  },
  {
    "text": "it's a tenant ID so if you don't have this tenant ID you can't see that's the",
    "start": "2293819",
    "end": "2298950"
  },
  {
    "text": "only data you can see so that gives us a way to describe the policy but we still",
    "start": "2298950",
    "end": "2305999"
  },
  {
    "text": "haven't attached it to the identity and the way we attached it to the identity",
    "start": "2305999",
    "end": "2311670"
  },
  {
    "start": "2309000",
    "end": "2309000"
  },
  {
    "text": "to me is kind of clever in fact I was in the code when we built this and I was working with judah bernstein and our",
    "start": "2311670",
    "end": "2318180"
  },
  {
    "text": "team on this and i'm looking for and i'm trying to figure out how did that policy get attached to the user it's working",
    "start": "2318180",
    "end": "2323579"
  },
  {
    "text": "but I don't see any code that ever connects it to it and it's because kognito is doing much of the work for us",
    "start": "2323579",
    "end": "2330749"
  },
  {
    "text": "here so you remember at the beginning we created this cog user pool and we configured these custom claims and we",
    "start": "2330749",
    "end": "2338309"
  },
  {
    "text": "put tenant ID and role on these other bits in here but we also had to create this federated identity that we got back",
    "start": "2338309",
    "end": "2345809"
  },
  {
    "text": "and what you didn't see because we didn't talk about it was as part of creating that federated identity we also",
    "start": "2345809",
    "end": "2352440"
  },
  {
    "text": "created these auth role matching rules that you see on the right hand side and",
    "start": "2352440",
    "end": "2357720"
  },
  {
    "text": "these role matching rules in fact if you go in the Cognito console and open it up and look at a federated identity",
    "start": "2357720",
    "end": "2362970"
  },
  {
    "text": "provider you'll actually see a place you can configure these role matching rules and the whole point of these role",
    "start": "2362970",
    "end": "2369089"
  },
  {
    "text": "matching rules is to say hey if you ask me for a token back for a given role of",
    "start": "2369089",
    "end": "2375569"
  },
  {
    "text": "a user I can match it to a policy and that token will come back with the",
    "start": "2375569",
    "end": "2380700"
  },
  {
    "text": "policy attached to it and so what we did is got when we went out and created all",
    "start": "2380700",
    "end": "2385859"
  },
  {
    "text": "the roles for our tenants we configured this federated identity with the mapping",
    "start": "2385859",
    "end": "2392579"
  },
  {
    "text": "rules to map each of our roles to the specific policies so here's an example of what",
    "start": "2392579",
    "end": "2400430"
  },
  {
    "text": "was on to the hood of that when you look in the application you'll see these are basically expressions and these fresh in",
    "start": "2400430",
    "end": "2406400"
  },
  {
    "text": "space basically our role matching rules that say hey if role equals if role",
    "start": "2406400",
    "end": "2412550"
  },
  {
    "text": "equals some specific value in this case role system then connect it to this policy if role equals role support only",
    "start": "2412550",
    "end": "2421790"
  },
  {
    "text": "then map it to this policy those are the role mapping rules and after you're done in fact if you saw after you provision a",
    "start": "2421790",
    "end": "2428330"
  },
  {
    "text": "user in this environment if you went and cracked open the console you'd see that these role matching rules would have",
    "start": "2428330",
    "end": "2433610"
  },
  {
    "text": "been created now where does this happen in the code where do I actually do this",
    "start": "2433610",
    "end": "2440360"
  },
  {
    "start": "2436000",
    "end": "2436000"
  },
  {
    "text": "well if you remember at the beginning I said we're gonna we're going to ignore part of that get credentials part that",
    "start": "2440360",
    "end": "2445370"
  },
  {
    "text": "was another couple of function calls in there well this is the sub part of that function that actually goes and gets the",
    "start": "2445370",
    "end": "2452270"
  },
  {
    "text": "credentials based on that role so here if we look at this function here you'll see that that it essentially if we give",
    "start": "2452270",
    "end": "2460550"
  },
  {
    "text": "it the identity pool that's that federated identity pool idea we just have to have that we have it as part of your identity and then we put the token",
    "start": "2460550",
    "end": "2467330"
  },
  {
    "text": "in there we didn't give it a role we didn't give it anything else we just have whatever the token is from your identity and now we make this Cognito",
    "start": "2467330",
    "end": "2474920"
  },
  {
    "text": "call this is a Cognito API call here kognito identity get credentials for identity and that takes these this",
    "start": "2474920",
    "end": "2482330"
  },
  {
    "text": "params truck that we populated now when I call that function that basically goes",
    "start": "2482330",
    "end": "2488420"
  },
  {
    "text": "over to Cognito it applies those role matching rules looks for the role in your token it cracks open that token and",
    "start": "2488420",
    "end": "2495590"
  },
  {
    "text": "finds it and then attaches the policy to that and gives you credentials back that",
    "start": "2495590",
    "end": "2501320"
  },
  {
    "text": "are scoped by that policy to me that's the secret sauce moment of this and just",
    "start": "2501320",
    "end": "2507230"
  },
  {
    "text": "a hammer this home one more bit just with a little bit of animation and we'll be done with this part of it so if you",
    "start": "2507230",
    "end": "2512720"
  },
  {
    "text": "look at this end-to-end I hit my app service my ab sever says I want to go get data okay go to kognito",
    "start": "2512720",
    "end": "2519650"
  },
  {
    "text": "say get credentials for identity given the token for the user Cognito matches the role you can see by the way at the",
    "start": "2519650",
    "end": "2525380"
  },
  {
    "text": "top this is the token with a couple of the elements one of which is our role the I match the role",
    "start": "2525380",
    "end": "2530779"
  },
  {
    "text": "Isao this is the policy for the role I create you a token and I hand you back",
    "start": "2530779",
    "end": "2536059"
  },
  {
    "text": "the credentials and then at the bottom you'll see I have a secret key in an access key and that's the secret key and",
    "start": "2536059",
    "end": "2541189"
  },
  {
    "text": "access key I'm gonna go and to use to access the data now I can't cross the boundary and in fact in a lab we do here",
    "start": "2541189",
    "end": "2548569"
  },
  {
    "text": "or we have a workshop ran monday runs again Friday you'll actually see this in action if you go do that workshop where",
    "start": "2548569",
    "end": "2554390"
  },
  {
    "text": "we you'll see hey you see where you could poke in the code and accidentally cross a boundary until you this policy",
    "start": "2554390",
    "end": "2559999"
  },
  {
    "text": "gets successfully apart applied now you could argue that's an awful lot of work to get there but I would say most of",
    "start": "2559999",
    "end": "2566779"
  },
  {
    "text": "it's pretty seamless and the value is pretty easy to argue yes developers are going to try to do the right thing",
    "start": "2566779",
    "end": "2572869"
  },
  {
    "text": "inherently but that doesn't mean we don't have to protect them from mistakes they may not intentionally introduce the",
    "start": "2572869",
    "end": "2582949"
  },
  {
    "text": "last bit we're going to look at and we'll go through this very fast is what is the multi-tenant view on the client",
    "start": "2582949",
    "end": "2588140"
  },
  {
    "text": "and it's always hard to talk about the client side of this because client frameworks are all over the place and they the way people implement clients",
    "start": "2588140",
    "end": "2593959"
  },
  {
    "text": "vary widely but what we did here is we wanted to say we're gonna build one single page application for all the",
    "start": "2593959",
    "end": "2600439"
  },
  {
    "text": "views of our applications so we have an admin system admin which is the ISV that owns all the tenants on the system we're",
    "start": "2600439",
    "end": "2606979"
  },
  {
    "text": "gonna build a console for them and then we're gonna have a tenant admin console that for that one tenant so they can",
    "start": "2606979",
    "end": "2612259"
  },
  {
    "text": "configure their environment and then we'll actually have this notion of a tenant user which is just somebody using",
    "start": "2612259",
    "end": "2617929"
  },
  {
    "text": "our application and show how the application based on your role would would show different views or enable",
    "start": "2617929",
    "end": "2624259"
  },
  {
    "text": "different views so you see here system admin can view all the tenants they can",
    "start": "2624259",
    "end": "2629539"
  },
  {
    "text": "see system health that can manage system users so on tenant admin is more about",
    "start": "2629539",
    "end": "2635539"
  },
  {
    "text": "how can I set up a tenant users within my tenant and so on now we're gonna go past this real quick",
    "start": "2635539",
    "end": "2642109"
  },
  {
    "start": "2640000",
    "end": "2640000"
  },
  {
    "text": "cuz it's angularjs and nobody wants to look at it real close but I want to highlight a couple of points in here in the angularjs this root scope was just a",
    "start": "2642109",
    "end": "2649309"
  },
  {
    "text": "global scope you'll look and we'll get after we off this bearer token back so",
    "start": "2649309",
    "end": "2654319"
  },
  {
    "text": "you'll see in the response I have this data token on the second line here that will come back and get put in my bearer",
    "start": "2654319",
    "end": "2660829"
  },
  {
    "text": "token now I'll decode that token you'll see now I have the decoder token I have all",
    "start": "2660829",
    "end": "2666829"
  },
  {
    "text": "that goodness that that I'm also passing the service available on the client so I'll display your name hi Todd welcome",
    "start": "2666829",
    "end": "2673040"
  },
  {
    "text": "to the system and I'll also more importantly extract your role from that token now I can use that role to decide",
    "start": "2673040",
    "end": "2680359"
  },
  {
    "text": "which views are enabled or disabled then I'm gonna go create this little I",
    "start": "2680359",
    "end": "2685369"
  },
  {
    "start": "2683000",
    "end": "2683000"
  },
  {
    "text": "created this little helper function that is this is link enabled function and the whole goal of this function is",
    "start": "2685369",
    "end": "2690920"
  },
  {
    "text": "essentially to take a view location which is a portion of the app somebody wants to try to access a path it takes",
    "start": "2690920",
    "end": "2698119"
  },
  {
    "text": "that as a parameter and then it evaluates that view view location to see which path in the application you're",
    "start": "2698119",
    "end": "2704060"
  },
  {
    "text": "trying to get to are you trying to get to login are you trying to get to tenants are you trying to get to products which pages of the app you're",
    "start": "2704060",
    "end": "2710000"
  },
  {
    "text": "trying to get to and this is link enabled will essentially turn enabled true or false based on whether or not",
    "start": "2710000",
    "end": "2715790"
  },
  {
    "text": "your role is allowed to see that page so we'll you'll see like here is system",
    "start": "2715790",
    "end": "2722089"
  },
  {
    "text": "user that goes out and looks at your role is admin user goes out and looks at your role and determines whether or not",
    "start": "2722089",
    "end": "2727130"
  },
  {
    "text": "you can see that page and then the last bit here is the actual HTML of this and",
    "start": "2727130",
    "end": "2733099"
  },
  {
    "start": "2729000",
    "end": "2729000"
  },
  {
    "text": "the HTML calls that is link enabled on from the previous page and says hey I'm trying to ask this particular link is it",
    "start": "2733099",
    "end": "2742310"
  },
  {
    "text": "presentable if it is or isn't I will then turn on or off that link based on their action don't really care",
    "start": "2742310",
    "end": "2749300"
  },
  {
    "text": "about any of the HTML or the angular bits of that what I really care is that you're saying I want you to realize",
    "start": "2749300",
    "end": "2755089"
  },
  {
    "text": "those roles and those tokens on that identity flow black back to the client and need to be applied on the client as",
    "start": "2755089",
    "end": "2761930"
  },
  {
    "text": "well and having all those bits about your tenant embedded inside that token when it gets back to the client is",
    "start": "2761930",
    "end": "2767810"
  },
  {
    "text": "valuable on that side of the equation as well but if I broke it apart and really said one of the things I really wants",
    "start": "2767810",
    "end": "2774319"
  },
  {
    "text": "you to do I really just want you to extract the role from the token go do something to provide some helper that",
    "start": "2774319",
    "end": "2781339"
  },
  {
    "text": "say what are the policies for what's enabled and disabled and then in the HTML turn on and off the views as you",
    "start": "2781339",
    "end": "2787430"
  },
  {
    "text": "need them an important note here is the note at the bottom of this page whatever I'm doing on the client to turn views on",
    "start": "2787430",
    "end": "2793609"
  },
  {
    "text": "or off isn't part of my security story yes I'm those things on and off because I don't",
    "start": "2793609",
    "end": "2799070"
  },
  {
    "text": "want users to see certain things but the truth is even if the user got a view they weren't supposed to get if they try",
    "start": "2799070",
    "end": "2805340"
  },
  {
    "text": "to try to go to the server I would hope my custom authorizer would stop them from getting from something",
    "start": "2805340",
    "end": "2810740"
  },
  {
    "text": "they're not supposed to and if they get past the custom authorizer I would hope that my access policies in the services",
    "start": "2810740",
    "end": "2818180"
  },
  {
    "text": "themselves would at least keep them from getting data they're supposed to it's all about layers here now I mentioned",
    "start": "2818180",
    "end": "2825950"
  },
  {
    "start": "2825000",
    "end": "2825000"
  },
  {
    "text": "that I highlight metrics I don't think this is the most complete implementation",
    "start": "2825950",
    "end": "2832160"
  },
  {
    "text": "of metrics and we said we don't have enough time to dig into this but I at least wanted to connect metrics to this",
    "start": "2832160",
    "end": "2837620"
  },
  {
    "text": "billing story because we talked about billing as well but it's a really important way to tell everybody who's",
    "start": "2837620",
    "end": "2843200"
  },
  {
    "text": "building SAS metering and metrics these are sir very different purposes to me",
    "start": "2843200",
    "end": "2849590"
  },
  {
    "text": "absolutely I want a meter consumption of our environment then that might drive a billing story but a completely separate",
    "start": "2849590",
    "end": "2855800"
  },
  {
    "text": "from that is the desire to just generally have metrics about activity and health and and data that I can mine",
    "start": "2855800",
    "end": "2863570"
  },
  {
    "text": "to tell me how is my system running how're tenants using my system what we're doin does it go healthy when does",
    "start": "2863570",
    "end": "2870050"
  },
  {
    "text": "it go unhealthy and how can I do that with the granularity of a tenant so I want to be able to come back and say",
    "start": "2870050",
    "end": "2876100"
  },
  {
    "text": "which parts of the system are being used just by this one tenant I ought to be able to filter down to that tenant if a",
    "start": "2876100",
    "end": "2882470"
  },
  {
    "text": "tenant comes to me and says I'm having a bad experience and the whole dashboard looks green in my management monitoring",
    "start": "2882470",
    "end": "2887840"
  },
  {
    "text": "experience I still want to drill in and be able to say filter by tenant oh I see tenant 3 is actually even though",
    "start": "2887840",
    "end": "2894770"
  },
  {
    "text": "everybody else is green there's some yellow bits here for 10 and 3 that are looked like they're in bottleneck",
    "start": "2894770",
    "end": "2900080"
  },
  {
    "text": "problems here so the whole point here is when I instrument the metrics I want to put in really good metrics in detail",
    "start": "2900080",
    "end": "2905840"
  },
  {
    "text": "about all the activity of my system and then I want to embed the tenant context in those metrics events and so of course",
    "start": "2905840",
    "end": "2913490"
  },
  {
    "text": "I'm gonna do this just the way any good architect or designer work I'm gonna introduce some kind of framework e-library tool between me and the metric",
    "start": "2913490",
    "end": "2921200"
  },
  {
    "text": "system here it's shown as metering so yet my tenants come in the API gateway they hit my services I show this an",
    "start": "2921200",
    "end": "2928520"
  },
  {
    "text": "metering config here just because you may have different configs for different services and different tenants but the",
    "start": "2928520",
    "end": "2936050"
  },
  {
    "text": "most important thing are these purple boxes here which are metering and my point is in the service because I'm sticking consistent to my theme but",
    "start": "2936050",
    "end": "2942470"
  },
  {
    "text": "don't want my services to know a lot about how to successfully meter I just want them to say somebody wants this metric publish the metric and let",
    "start": "2942470",
    "end": "2950120"
  },
  {
    "text": "the metering library say oh I'll figure out the tenant context I'll figure out the bits about how these standard",
    "start": "2950120",
    "end": "2955820"
  },
  {
    "text": "metrics need to get published and I'll publish it with that context for you and then I send it out to firehose here and",
    "start": "2955820",
    "end": "2962600"
  },
  {
    "text": "then eventually into redshift and these are just examples of aggregation",
    "start": "2962600",
    "end": "2968030"
  },
  {
    "text": "technologies they're really good ones but I would say to you if you want to use elastic search in Cabana or whatever",
    "start": "2968030",
    "end": "2974060"
  },
  {
    "text": "you want to use here there's tons of good aggregation technologies I happen to pick these two because I happen to",
    "start": "2974060",
    "end": "2979520"
  },
  {
    "text": "have built a sample with them but another key takeaway here is all your metrics should land in this data",
    "start": "2979520",
    "end": "2985820"
  },
  {
    "text": "warehouse and then you should let consumers of those metrics decide what",
    "start": "2985820",
    "end": "2991550"
  },
  {
    "text": "data is interesting for them to surface on their dashboards I will often see product managers who want a very",
    "start": "2991550",
    "end": "2996800"
  },
  {
    "text": "different view of what's going on than an architect and an Operations person who wants a very different view of those",
    "start": "2996800",
    "end": "3002830"
  },
  {
    "text": "that data I even see business sometimes wanting a higher level view of just",
    "start": "3002830",
    "end": "3007930"
  },
  {
    "text": "generally how many tenants have we onboard it how long does it take a tenant to go from on-boarded to successfully using the system there's",
    "start": "3007930",
    "end": "3013810"
  },
  {
    "text": "all kinds of bits here and what I want to say is I don't want to constrain that in any way put all the data as a",
    "start": "3013810",
    "end": "3019210"
  },
  {
    "text": "developer in here encourage everybody to publish really good metrics and then let everybody consume it but in this",
    "start": "3019210",
    "end": "3025450"
  },
  {
    "text": "particular case I've talked about billing and certainly one of the consumers of that data will be billing",
    "start": "3025450",
    "end": "3030910"
  },
  {
    "text": "billing will pull the data out of redshift it will find the billable unit that's irrelevant to my billing system",
    "start": "3030910",
    "end": "3036760"
  },
  {
    "text": "and it will publish it to my billing system so that data can get there and the last piece I always hesitate to even",
    "start": "3036760",
    "end": "3043870"
  },
  {
    "start": "3042000",
    "end": "3042000"
  },
  {
    "text": "include this slide but because we built this and we thought it was fun when we built it I throw this little slide at",
    "start": "3043870",
    "end": "3049810"
  },
  {
    "text": "the end which is we did create a little bit of a dashboard in here and we mostly created this dashboard because we wanted",
    "start": "3049810",
    "end": "3055780"
  },
  {
    "text": "to show the differences between what might be a system users view of the universe versus say a tenant admins view",
    "start": "3055780",
    "end": "3062470"
  },
  {
    "text": "of the use versus a tenant user so we that toggle some you eyes on and off so you'll see at the top here we have this",
    "start": "3062470",
    "end": "3068560"
  },
  {
    "text": "notion of service health and all service health is meant to be here is you have all these micro services there green if",
    "start": "3068560",
    "end": "3074740"
  },
  {
    "text": "the service is healthy so when you're working with the app and for some reason the service goes down you could give",
    "start": "3074740",
    "end": "3079750"
  },
  {
    "text": "some notion of this the idea whether was to plant the seed that you could build more interesting dashboards that were custom to your domain here for system",
    "start": "3079750",
    "end": "3086830"
  },
  {
    "text": "view separate from all the great management monitoring tools you might be using and then the bottom part were metrics and those metrics are for tenant",
    "start": "3086830",
    "end": "3094840"
  },
  {
    "text": "admins as well so if you log in as a system you get this whole page if you log is in a tenant admin you won't get the system health parts at the top",
    "start": "3094840",
    "end": "3101760"
  },
  {
    "text": "finally takeaways well I hope after this",
    "start": "3101760",
    "end": "3108040"
  },
  {
    "text": "whole discussion that identity doesn't now feel like it's this tangential topic that yes we have to solve identity but",
    "start": "3108040",
    "end": "3114790"
  },
  {
    "text": "in actuality tenet identity and the whole concept of how you represent",
    "start": "3114790",
    "end": "3120040"
  },
  {
    "text": "identity affects the entire experience in your SAS architecture you saw through",
    "start": "3120040",
    "end": "3125530"
  },
  {
    "text": "onboarding and how we created it how we float it through and off how it arrived at services and how it was used to",
    "start": "3125530",
    "end": "3131109"
  },
  {
    "text": "connect policies and if you do that well it's not so hard if you don't do it well",
    "start": "3131109",
    "end": "3137230"
  },
  {
    "text": "and you start sort of doing all these one-off bits to try to get it to work it can get complicated really fast",
    "start": "3137230",
    "end": "3142930"
  },
  {
    "text": "so don't underestimate the importance of investing in identity I think here that",
    "start": "3142930",
    "end": "3149349"
  },
  {
    "text": "I am we talked about and the way it can control access to resources and then we can use it as part of our isolation",
    "start": "3149349",
    "end": "3154990"
  },
  {
    "text": "story here is a super powerful construct I will also add the caveat here that I",
    "start": "3154990",
    "end": "3162430"
  },
  {
    "text": "am also has limits on the number of policies you can introduce and there are issues here so as you look at the",
    "start": "3162430",
    "end": "3168910"
  },
  {
    "text": "solution and you're trying to decide can I use this model in my solution you need to ask yourself how many roles will I",
    "start": "3168910",
    "end": "3175510"
  },
  {
    "text": "really have remember here we had roles per per tenant we did not have policies",
    "start": "3175510",
    "end": "3181420"
  },
  {
    "text": "per user we had policies per role so that kept the policies from exploding",
    "start": "3181420",
    "end": "3186520"
  },
  {
    "text": "but you might still say well given all our roles in the way that we have to describe policies we may run up against",
    "start": "3186520",
    "end": "3193180"
  },
  {
    "text": "the limits of I am and don't look at the soft limits are hard limits out there so you'll obviously potentially run up against",
    "start": "3193180",
    "end": "3199769"
  },
  {
    "text": "soft limits but you the hard limits are much further out so look at that",
    "start": "3199769",
    "end": "3205160"
  },
  {
    "text": "generally and I beat this one to death but I think it's worth reminding you in my app services they don't want",
    "start": "3205160",
    "end": "3210839"
  },
  {
    "text": "developers thinking about tenant context I don't want them sort of improvising",
    "start": "3210839",
    "end": "3217349"
  },
  {
    "text": "security in isolation for me I want all those bits out of their view and I want to write really good code to surround it",
    "start": "3217349",
    "end": "3223619"
  },
  {
    "text": "so that I don't have to deal with that this is a latter point we didn't hit",
    "start": "3223619",
    "end": "3229499"
  },
  {
    "text": "this really hard but I've talked about this notion of a system user which is potentially all of you as the user who",
    "start": "3229499",
    "end": "3235799"
  },
  {
    "text": "are managing all of your tenants when you go to tell build your identity story",
    "start": "3235799",
    "end": "3240900"
  },
  {
    "text": "this user often gets left out of the equation so then you come back and you introduce some super user that has a",
    "start": "3240900",
    "end": "3247319"
  },
  {
    "text": "special key or something that has a path through a bastion host to get into the system I would prefer that you think of",
    "start": "3247319",
    "end": "3254459"
  },
  {
    "text": "system users while you think about tenant users so that you can potentially leverage in fact I have whole talks on",
    "start": "3254459",
    "end": "3260939"
  },
  {
    "text": "an identity where I talked about this I would like you to leverage the same mechanisms that you're using for tenant",
    "start": "3260939",
    "end": "3266039"
  },
  {
    "text": "users policies and tokens and all those other bits for system users now they may get provision through a different",
    "start": "3266039",
    "end": "3272130"
  },
  {
    "text": "process but the way they get applied in the code the way they realize isolation they can leverage common mechanisms and",
    "start": "3272130",
    "end": "3281400"
  },
  {
    "text": "then metering and analytics hopefully it's clear that that should be an early priority to me if I'm building a SAS",
    "start": "3281400",
    "end": "3286589"
  },
  {
    "text": "system from scratch tomorrow um I don't want to wait to get this data in fact as",
    "start": "3286589",
    "end": "3292079"
  },
  {
    "text": "I'm making decisions about how data is partitioned and how my services are going to scale and how parts of the",
    "start": "3292079",
    "end": "3297900"
  },
  {
    "text": "system I'm expecting to work really well will work I want the data to back that",
    "start": "3297900",
    "end": "3302910"
  },
  {
    "text": "up right away I want QA and my automated testing to be pushing these bits and looking at these metrics and telling me",
    "start": "3302910",
    "end": "3310170"
  },
  {
    "text": "is my system doing what I expect and the last one is and this may already be",
    "start": "3310170",
    "end": "3316049"
  },
  {
    "text": "obvious to some of you may already work this way but don't make don't don't sort",
    "start": "3316049",
    "end": "3321359"
  },
  {
    "text": "of go after multi-tenant in a in a siloed model where you attack one part",
    "start": "3321359",
    "end": "3327539"
  },
  {
    "text": "of the system and then you eventually do you build that all out you eventually attack the next part of the system I",
    "start": "3327539",
    "end": "3333090"
  },
  {
    "text": "would Purdue say let's get this little piece of onboarding working let's get this little piece of auth working let's",
    "start": "3333090",
    "end": "3339300"
  },
  {
    "text": "flow that through to an auth service and we'll write this cheesy little helper that only does a little bit of what it's supposed to do right now and see that",
    "start": "3339300",
    "end": "3346080"
  },
  {
    "text": "work all the way in to end and then iterate on that before and then learn",
    "start": "3346080",
    "end": "3351750"
  },
  {
    "text": "from that and get and evolve all of those moving parts I feel like you'll learn more in that path so I promised",
    "start": "3351750",
    "end": "3360230"
  },
  {
    "text": "links at the end these are the links to the the QuickStart if you want to just",
    "start": "3360230",
    "end": "3366600"
  },
  {
    "text": "go to the github repository where this all lives there's a nice big huge document that should resonate with all",
    "start": "3366600",
    "end": "3372600"
  },
  {
    "text": "the things I've talked about here and then if you just want general AWS content from the sass factory team the",
    "start": "3372600",
    "end": "3379260"
  },
  {
    "text": "last content the last link will get you that webinars are out there and so on and we have not evolved this QuickStart",
    "start": "3379260",
    "end": "3388140"
  },
  {
    "text": "a lot since we introduced it we're looking at whether or not we're going to push real hard on adding functionality",
    "start": "3388140",
    "end": "3394710"
  },
  {
    "text": "that our build standalone versions of billing and monitoring some of these",
    "start": "3394710",
    "end": "3399750"
  },
  {
    "text": "other bits but I would love your feedback on how you think it evolved and how how we could evolve it in a way that",
    "start": "3399750",
    "end": "3405660"
  },
  {
    "text": "would be better for you finally let's see if there's any days left here that would be relevant these",
    "start": "3405660",
    "end": "3412950"
  },
  {
    "text": "are we have a whole bunch there's like 18 just on my team there's like 18 sessions related to sass there are chalk",
    "start": "3412950",
    "end": "3420600"
  },
  {
    "text": "talks still remaining tomorrow on looks like here on multi-tenant what migrating",
    "start": "3420600",
    "end": "3428100"
  },
  {
    "text": "and on optimizing there's also the workshop tomorrow that I talked about that if you're interested and you've",
    "start": "3428100",
    "end": "3433470"
  },
  {
    "text": "still got the energy that you could give a try so that's it that's the sass",
    "start": "3433470",
    "end": "3439410"
  },
  {
    "text": "application we pulled it apart hope you enjoyed it hope it was valuable to you and I really appreciate you being here",
    "start": "3439410",
    "end": "3445020"
  },
  {
    "text": "and enjoy what's left of the show [Applause]",
    "start": "3445020",
    "end": "3454659"
  }
]