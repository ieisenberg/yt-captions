[
  {
    "start": "0",
    "end": "29000"
  },
  {
    "text": "my name is Eric these days I'm with the AWS security team but when I joined Amazon 8 years ago I was with the team",
    "start": "399",
    "end": "6919"
  },
  {
    "text": "that defined and launched VPC and that's what we're going to be talking about today clicker works so this is a reprise",
    "start": "6919",
    "end": "14920"
  },
  {
    "text": "of a version of this talk that I gave at reinvent two years ago I'd like to manage expectations a lot of the content",
    "start": "14920",
    "end": "20720"
  },
  {
    "text": "is the same there is some new stuff but if you're expecting a completely new talk I'd rather you leave angry now than",
    "start": "20720",
    "end": "25920"
  },
  {
    "text": "leave angry at the end of The Talk the problem that we're trying to",
    "start": "25920",
    "end": "31279"
  },
  {
    "start": "29000",
    "end": "29000"
  },
  {
    "text": "solve with VPC is simple we're AWS we have the cloud the cloud is full",
    "start": "31279",
    "end": "36760"
  },
  {
    "text": "of all sorts of AWC goodness services like ec2 and elastic load balancing and",
    "start": "36760",
    "end": "42559"
  },
  {
    "text": "the elastic Block store and our relational database service and Amazon redshift or columnar uh data store and",
    "start": "42559",
    "end": "51440"
  },
  {
    "text": "elasticache customers have data centers these are data centers they've owned for years they're expensive",
    "start": "51440",
    "end": "57399"
  },
  {
    "start": "53000",
    "end": "53000"
  },
  {
    "text": "Capital Investments they're not going to go away immediately and so as good Engineers we go to the",
    "start": "57399",
    "end": "62600"
  },
  {
    "start": "60000",
    "end": "60000"
  },
  {
    "text": "Whiteboard and we draw an arrow this is what we wanted to do we wanted to plug customer data centers into the cloud",
    "start": "62600",
    "end": "69680"
  },
  {
    "text": "this is going to be a really important deployment scenario for us we have customers you hear stories about Netflix",
    "start": "69680",
    "end": "75400"
  },
  {
    "text": "and customers like that that are all in on the cloud they're closing their last data center but for every Netflix that",
    "start": "75400",
    "end": "81040"
  },
  {
    "text": "we have for every customer that's ending that Journey we've got another customer beginning that Journey so as a service",
    "start": "81040",
    "end": "86520"
  },
  {
    "text": "provider we are always going to have customers that are running hybrid operations between their existing",
    "start": "86520",
    "end": "92640"
  },
  {
    "text": "infrastructure and their new infrastructure in the cloud and it's it's unrealistic and unwise to expect people to do big bang migrations it's",
    "start": "92640",
    "end": "99479"
  },
  {
    "text": "going to be applications moving gradually data moving gradually so in order to to to win this business in",
    "start": "99479",
    "end": "104560"
  },
  {
    "text": "order to do Cloud right we're going to have to support this for the long term",
    "start": "104560",
    "end": "110280"
  },
  {
    "text": "so at the first reinvent we had a talk entitled drinking your own Champagne by Laura Grid it's available on YouTube I",
    "start": "110280",
    "end": "117079"
  },
  {
    "text": "highly recommend it um it's about Amazon Own Story moving to AWS we we are an",
    "start": "117079",
    "end": "123680"
  },
  {
    "text": "Enterprise just like many of you we had data centers they were built to serve our needs they were built without",
    "start": "123680",
    "end": "128959"
  },
  {
    "text": "considering a future move to the cloud and we we had some challenges there VPC",
    "start": "128959",
    "end": "134319"
  },
  {
    "text": "was critical to that adoption it was one of the major building blocks that we used and this is a story we've seen",
    "start": "134319",
    "end": "139360"
  },
  {
    "text": "unfold with a lot of other uh customers so in the beginning we had",
    "start": "139360",
    "end": "145599"
  },
  {
    "start": "143000",
    "end": "143000"
  },
  {
    "text": "ec2 and when you launched an instance we would sign an IP address to that instance and it was effectively a 32-bit",
    "start": "145599",
    "end": "153000"
  },
  {
    "text": "random number it was it was unique in the cloud you could you'd get a DNS name you could Route traffic to it and when",
    "start": "153000",
    "end": "160040"
  },
  {
    "text": "you launched another instance you'd get another IP address and it was another 32-bit random number and meanwhile there",
    "start": "160040",
    "end": "166080"
  },
  {
    "text": "were other tenants the cloud is multi-tenant there are other customers launching instances in the cloud and we would assign them 32-bit random numbers",
    "start": "166080",
    "end": "172920"
  },
  {
    "text": "as well and this would go on and everything was great now we come to a",
    "start": "172920",
    "end": "178440"
  },
  {
    "start": "177000",
    "end": "177000"
  },
  {
    "text": "customer Data Center and let's say that someday 20 years ago 10 years ago",
    "start": "178440",
    "end": "183519"
  },
  {
    "text": "whenever this data center was built some network engineer chose 192168 0016 as the IP range for the data center",
    "start": "183519",
    "end": "191480"
  },
  {
    "text": "perfectly reasonable choice so there's a router there this is a router Router like piece of sheet",
    "start": "191480",
    "end": "197200"
  },
  {
    "text": "metal comes from one of the major router vendors it's got some embedded firmware on it some tcam and it's got a routing",
    "start": "197200",
    "end": "203799"
  },
  {
    "text": "table in it and it says 192168 that's here so if we're going to plug that into",
    "start": "203799",
    "end": "209560"
  },
  {
    "text": "the Cloud if we're going to plug that into the ec2 network that we had well you're going to launch an instance and",
    "start": "209560",
    "end": "215400"
  },
  {
    "text": "we're going to need to route to that instance so we're going to have to add it to your routing table but we have to add a sl32 route we have to add a host",
    "start": "215400",
    "end": "221120"
  },
  {
    "text": "route because the next instance that launches right next door the next IP address could be a different customer",
    "start": "221120",
    "end": "226760"
  },
  {
    "text": "you don't want that instance routing back to your data center so as you launch instances we have to add them to",
    "start": "226760",
    "end": "232640"
  },
  {
    "text": "the routing table and as you terminate instances we have to make sure that you remove them",
    "start": "232640",
    "end": "238920"
  },
  {
    "text": "from the routing table so your routing table is going to one contain a set of routes the size of your",
    "start": "238920",
    "end": "246000"
  },
  {
    "text": "instance Fleet not good and two your routing table is going to absorb updates at the rate of instance launch and",
    "start": "246000",
    "end": "251799"
  },
  {
    "text": "terminate also not good but that's not all let's say that a",
    "start": "251799",
    "end": "257720"
  },
  {
    "text": "decade ago your network engineer chose 10440 Z16 an equally reasonable Choice",
    "start": "257720",
    "end": "263800"
  },
  {
    "text": "it's rfc1918 it's not going to be routed on the internet there's absolutely nothing that we can put in that routing table table",
    "start": "263800",
    "end": "270400"
  },
  {
    "text": "that'll make sense we've got 10.44 in the cloud we've got 10.44 in the data center you can do things like double",
    "start": "270400",
    "end": "276039"
  },
  {
    "text": "natat um if you ever say double Nat to a network engineer make sure that you're standing far away from",
    "start": "276039",
    "end": "281680"
  },
  {
    "text": "them like this horrible Network design so we've got a problem here so from a a",
    "start": "281680",
    "end": "288880"
  },
  {
    "text": "customer facing uh perspective we have customer selected IP addresses customers",
    "start": "288880",
    "end": "294199"
  },
  {
    "text": "want to bring their own IPS you have a network it has some design decisions that were made years ago they're not",
    "start": "294199",
    "end": "299320"
  },
  {
    "text": "good bad design decisions it's what you have it needs to work with our stuff we need route aggregation your",
    "start": "299320",
    "end": "306000"
  },
  {
    "text": "router you can try this if you want but I guarantee you your router will be sad if you add and remove route updates if",
    "start": "306000",
    "end": "312199"
  },
  {
    "text": "you add and remove uh routing table entries every time you launch your terminate an instance so we need some way of aggregating this so that routing",
    "start": "312199",
    "end": "318840"
  },
  {
    "text": "table updates are infrequent they they happen when they're network configuration events or network connectivity",
    "start": "318840",
    "end": "324560"
  },
  {
    "text": "changes and we need conformance with existing Network designs this was a aun",
    "start": "324560",
    "end": "329880"
  },
  {
    "text": "conversation that we had internally we like we want to build a beautiful new abstract Cloud Network and I I was",
    "start": "329880",
    "end": "336440"
  },
  {
    "text": "arguing that no actually customers have a preconceived notion of how networks go together and you you need to conform",
    "start": "336440",
    "end": "343800"
  },
  {
    "text": "with that you need to you need to meet them where they are you need to allow them to photocopy their existing Network designs through our",
    "start": "343800",
    "end": "349800"
  },
  {
    "text": "apis and then we had an early customer um who happens to be sponsoring this",
    "start": "349800",
    "end": "355440"
  },
  {
    "text": "conference and they came to us and they said all networks have to be sl24 is are provisioning tools can't deal with",
    "start": "355440",
    "end": "360479"
  },
  {
    "text": "anything else and that sold the case for me Amazon's own data centers which are amazing like we were very very good at",
    "start": "360479",
    "end": "367280"
  },
  {
    "text": "automated data centers automated provisioning scale and all of that the tools there were built by us to work in",
    "start": "367280",
    "end": "373639"
  },
  {
    "text": "our data centers for our provisioning use cases and all of our subnets were rack siiz they were all SL 24s and we",
    "start": "373639",
    "end": "380520"
  },
  {
    "text": "just assumed that all networks forever would be SL 24s which was the right decision to make when we built those provisioning tools we never thought",
    "start": "380520",
    "end": "386800"
  },
  {
    "text": "about the cloud and so my own company helped me sell the idea to my company it was a a nice turn of",
    "start": "386800",
    "end": "394160"
  },
  {
    "text": "events so the highle presentation is you have a data center it has some arbitrary",
    "start": "394160",
    "end": "400639"
  },
  {
    "text": "Network range that you've chosen you create a VPC this is an API call into our control plane and when you create",
    "start": "400639",
    "end": "407039"
  },
  {
    "text": "the VPC you specify the CER block you want for the VPC so this customer's chosen 17231",
    "start": "407039",
    "end": "414800"
  },
  {
    "text": "0018 it's an arbitrary Choice it's up to you it should be something that doesn't overlap with anything else you want to",
    "start": "414800",
    "end": "420280"
  },
  {
    "text": "plug into it then you create a VPN Gateway this is our end of a private",
    "start": "420280",
    "end": "427000"
  },
  {
    "text": "connection you create a customer Gateway and we don't yet have apis that cause routers to pop into existence this is",
    "start": "427000",
    "end": "433039"
  },
  {
    "text": "more telling us about the device on your side so you give us the IP address and things like that um and we know now what",
    "start": "433039",
    "end": "439919"
  },
  {
    "text": "the far end of the the VPN connection is and then you configure a VPN connection uh it's done programmatically on our",
    "start": "439919",
    "end": "446240"
  },
  {
    "text": "side we give you the router configuration you need to install on your side and now network connectivity can come up and your router is going to",
    "start": "446240",
    "end": "452639"
  },
  {
    "text": "learn a route for that VPC one route that covers the entire VPC within the VPC you can allocate subnets the subnets",
    "start": "452639",
    "end": "460800"
  },
  {
    "text": "have to be within the CER for the VPC itself you can create as many of these as you'd like and",
    "start": "460800",
    "end": "467120"
  },
  {
    "text": "now as you launch instances and terminate them there are no changes to your routing table on Prem so we've",
    "start": "467120",
    "end": "474479"
  },
  {
    "text": "solved the overlapping IP address problem and we've solved the high velocity routing table update problem",
    "start": "474479",
    "end": "481440"
  },
  {
    "start": "481000",
    "end": "481000"
  },
  {
    "text": "why why am I telling you about this this is a solved problem we've been doing this for decades like a subnet you're",
    "start": "481800",
    "end": "487639"
  },
  {
    "text": "using these fancy Cloud terms but it's just a VLAN like I know what this is um",
    "start": "487639",
    "end": "492879"
  },
  {
    "text": "not as many people know about vrfs virtual routing and forwarding you basically it's the same thing as vlans but for layer three you fragment your",
    "start": "492879",
    "end": "498879"
  },
  {
    "text": "routing table into multiple virtual routing tables so you take the the the smart complicated physical Network that",
    "start": "498879",
    "end": "503960"
  },
  {
    "text": "you've used for years and you ask it to make virtual copies of itself this is a mature business it's used in in data",
    "start": "503960",
    "end": "510000"
  },
  {
    "text": "centers all over the world but our application is not the same as those",
    "start": "510000",
    "end": "517039"
  },
  {
    "start": "518000",
    "end": "518000"
  },
  {
    "text": "applications the VLAN header perfectly reasonable thing no one thought that 496",
    "start": "518880",
    "end": "524039"
  },
  {
    "text": "was going to be a constraint we publicly talk about how AWS has more than a million customers a million is larger",
    "start": "524039",
    "end": "530560"
  },
  {
    "text": "than 4,096",
    "start": "530560",
    "end": "536640"
  },
  {
    "text": "um even more concerning like the the 486 that's easy to test like it's a 12-bit",
    "start": "536640",
    "end": "542800"
  },
  {
    "text": "field in the header you can iterate through all of them uh vrfs are complicated and most vendors haven't",
    "start": "542800",
    "end": "549600"
  },
  {
    "text": "actually tested Beyond 512 uh we know we we tried but even if you do go beyond",
    "start": "549600",
    "end": "555320"
  },
  {
    "text": "that large like Blast Furnace full rack routers the things that cost more than your house support 1 to 2,000 vrfs one",
    "start": "555320",
    "end": "563399"
  },
  {
    "text": "to 2,000 is still less than a million um if you're buying a device that claims to support more than 2K vrfs",
    "start": "563399",
    "end": "570959"
  },
  {
    "text": "and you are intending to use more than 2K vrfs you are a beta tester this is",
    "start": "570959",
    "end": "576120"
  },
  {
    "text": "not what we want to be building our Production Services on and there's a fixed ratio of vlans to",
    "start": "576120",
    "end": "581800"
  },
  {
    "text": "vrfs you get 4,096 vlans on a port you get 1,000 vrfs in the Box what if your",
    "start": "581800",
    "end": "588360"
  },
  {
    "text": "customers want more than four subnets per VPC what if they want less you're going to be stranding some",
    "start": "588360",
    "end": "593959"
  },
  {
    "text": "resources but that's not all we're talking about these giant Blast Furnace routers and these things are fast they",
    "start": "593959",
    "end": "600800"
  },
  {
    "start": "595000",
    "end": "595000"
  },
  {
    "text": "are amazingly capable but we're talking about the data plane here these are custom switch as6 the fabric cards this",
    "start": "600800",
    "end": "608760"
  },
  {
    "text": "is the fast part of the router inside the router is a control",
    "start": "608760",
    "end": "614160"
  },
  {
    "text": "plane many of them are actually x86 boxes running free SD or Linux these days except they have less RAM and less",
    "start": "614160",
    "end": "621440"
  },
  {
    "text": "horsepower than this laptop and they cost as much as a car and it's connected to the data plane",
    "start": "621440",
    "end": "627279"
  },
  {
    "text": "via a straw you've got a data plane plane that's got 110 gig ports and the",
    "start": "627279",
    "end": "633279"
  },
  {
    "text": "control plane is going to have dramatically less connectivity there it's the control plane that's dealing with all of this configuration",
    "start": "633279",
    "end": "640480"
  },
  {
    "text": "complexity and the way you scale these things is you do one plus one failover but it's failover between the",
    "start": "640480",
    "end": "646720"
  },
  {
    "text": "control planes so we loaded this up we we actually did this we we had a pair of",
    "start": "646720",
    "end": "652000"
  },
  {
    "text": "routers and these were amazing routers like you could push terabits of capacity through them but when you failed one of the",
    "start": "652000",
    "end": "659320"
  },
  {
    "text": "routers over the control planes would go dark there was actually one router brand where there was a watchdog timer the",
    "start": "659320",
    "end": "665120"
  },
  {
    "text": "control plane went dark so long trying to Recon Converge All of the routing protocols that this one rebooted so then",
    "start": "665120",
    "end": "671000"
  },
  {
    "text": "this one came up and tried to Recon Converge All of the routing protocols and rebooted and we just had routers seawing back and",
    "start": "671000",
    "end": "678680"
  },
  {
    "text": "forth so these routers are configured using text files if we figure an average rouer",
    "start": "678680",
    "end": "685720"
  },
  {
    "start": "679000",
    "end": "679000"
  },
  {
    "text": "config line is 50 characters it takes us 10 lines of router config to describe a VPC a vrf",
    "start": "685720",
    "end": "693200"
  },
  {
    "text": "figure an average of four subnets per VPC takes us five lines of router config to describe a subnet and we've got 2,000",
    "start": "693200",
    "end": "700760"
  },
  {
    "text": "customers on the box it's a 3 megabyte text file committing one of these configs on",
    "start": "700760",
    "end": "708440"
  },
  {
    "text": "one of these routers literally it could take it 3 to five minutes just to parse the configuration not to apply anything",
    "start": "708440",
    "end": "715519"
  },
  {
    "text": "just to parse the configuration and validate it textually these routers are just computers with strange",
    "start": "715519",
    "end": "721480"
  },
  {
    "text": "Hardware they have the same bugs that every other system has the software is written by humans humans write all the",
    "start": "721480",
    "end": "727880"
  },
  {
    "text": "bugs and so there are assumptions in these routers and they work really well",
    "start": "727880",
    "end": "733880"
  },
  {
    "text": "for their design point but they work really poorly if you use them outside that design Point sometimes uh for example we had a a device that we were",
    "start": "733880",
    "end": "740720"
  },
  {
    "text": "using and it was a similar use case we had a lot of a certain kind of config um",
    "start": "740720",
    "end": "745800"
  },
  {
    "text": "where the typical you'd have like a dozen of these and we would have thousands of or tens of thousands of them it turns out the internal",
    "start": "745800",
    "end": "751680"
  },
  {
    "text": "implementation of that was a singly linked list so if you wanted to add one to that list you had to chase pointers",
    "start": "751680",
    "end": "757680"
  },
  {
    "text": "all the way down to the end of the list if you wanted to delete one from the middle you had to chase pointers until you found it and Stitch it out when you",
    "start": "757680",
    "end": "764240"
  },
  {
    "text": "have eight of them or 12 of them no one notices this computers are fast when you have 10,000 of them all of a sudden the",
    "start": "764240",
    "end": "769800"
  },
  {
    "text": "control plane starts to fall over there's another problem we found with a device every time you committed the",
    "start": "769800",
    "end": "775880"
  },
  {
    "text": "config it would leak two words of memory well how often you commit config on a router like a dozen times when you're",
    "start": "775880",
    "end": "782160"
  },
  {
    "text": "building the thing out maybe every couple of months when there's a network design change you add new capacity we",
    "start": "782160",
    "end": "787880"
  },
  {
    "text": "commit config to routers every time customers make API calls you want a VPC you want a new subnet we're going to be",
    "start": "787880",
    "end": "793360"
  },
  {
    "text": "committing config so we exhausted memory on the control plane due to this memory leak it had been present in the code for",
    "start": "793360",
    "end": "799639"
  },
  {
    "text": "like 10 years and no one had found it until we did this it's because we were operating outside of the common envelope",
    "start": "799639",
    "end": "805839"
  },
  {
    "text": "we'd become beta testers again so this doesn't",
    "start": "805839",
    "end": "810880"
  },
  {
    "text": "scale it's going to be expensive the closest I have come to Career suicide was when I proposed this",
    "start": "810880",
    "end": "818000"
  },
  {
    "text": "design in front of a bunch of network engineers at Amazon I swear to God one of them was in the back of the room sharpening a big knife like this is this",
    "start": "818000",
    "end": "826760"
  },
  {
    "text": "is not the way to make your network Engineers like you um we're tied to",
    "start": "826760",
    "end": "832440"
  },
  {
    "text": "vendor bug fix Cycles if you've got something that goes wrong in your data center it affects you and we have",
    "start": "832440",
    "end": "837880"
  },
  {
    "text": "something that goes wrong in our data center it affects all of our customers and it's likely to affect multiple devices in our data center because we",
    "start": "837880",
    "end": "844279"
  },
  {
    "text": "keep cookie cutter in out the same design we like to control our own destiny we like to be able to fix things on our time scale you know that memory",
    "start": "844279",
    "end": "851279"
  },
  {
    "text": "link bug that had been present for a decade it's not a high priority bug for literally any other customer of that",
    "start": "851279",
    "end": "856600"
  },
  {
    "text": "vendor but it's super high priority for us and that imp penis mismatch causes problems and so we want to be on the",
    "start": "856600",
    "end": "863560"
  },
  {
    "text": "commodity curve we want these things to be getting cheaper as quickly as our compute and storage are getting cheaper",
    "start": "863560",
    "end": "868880"
  },
  {
    "text": "and and a lot of the selling points for these large vertically integrated devices is all sorts of advanced",
    "start": "868880",
    "end": "874399"
  },
  {
    "text": "features but the interoperability of those Advanced features is pretty poor and we don't care about them we want the",
    "start": "874399",
    "end": "881040"
  },
  {
    "text": "network to be fast and dumb we want it to pass the bits we don't want the fancy features we don't want to pay for the",
    "start": "881040",
    "end": "886079"
  },
  {
    "text": "fancy features and I keep saying we we we",
    "start": "886079",
    "end": "891639"
  },
  {
    "start": "888000",
    "end": "888000"
  },
  {
    "text": "horizontally scale we we Stamp Out multiple of these things but this isn't horizontal scaling it looks like",
    "start": "891639",
    "end": "897320"
  },
  {
    "text": "horizontal scaling because there's two similar things sitting next to each other but it's really silos of capacity",
    "start": "897320",
    "end": "903160"
  },
  {
    "text": "so we've got routers and because I I got tired of making boxes in PowerPoint each router can support four customers and 40",
    "start": "903160",
    "end": "910680"
  },
  {
    "text": "instances worth of capacity and so customer a shows up and asks for three instances we arbitrarily",
    "start": "910680",
    "end": "917279"
  },
  {
    "text": "choose to place them on the left Silo customer B shows up arbitrarily place",
    "start": "917279",
    "end": "922320"
  },
  {
    "text": "them on the right Silo customer see like there there's some sort of load balancing placement algorithm going on",
    "start": "922320",
    "end": "928240"
  },
  {
    "text": "here and as launches come and go we we add them now customer agents launch two more instances because their VPC is",
    "start": "928240",
    "end": "935000"
  },
  {
    "text": "hosted in the left Silo I have to place them in the left Silo that placement decision is made for me customer e shows",
    "start": "935000",
    "end": "942160"
  },
  {
    "text": "up it's one instance looks puny this is an incredibly important customer for us",
    "start": "942160",
    "end": "947639"
  },
  {
    "text": "this is the getting started guide every single one of our customers was want a one instance customer this customer may",
    "start": "947639",
    "end": "954000"
  },
  {
    "text": "get off the platform tomorrow and we may never hear from them again they may be the next Netflix I I don't",
    "start": "954000",
    "end": "959920"
  },
  {
    "text": "know uh F shows up this is a large Enterprise customer this is a planned",
    "start": "959920",
    "end": "965360"
  },
  {
    "text": "migration maybe we knew how much capacity they were going to need and we could make a an intentional manual decision",
    "start": "965360",
    "end": "970839"
  },
  {
    "text": "here uh customer G I just allocated the last customer on",
    "start": "970839",
    "end": "977360"
  },
  {
    "text": "that left Silo it's full I've got a bunch of capacity available but I can",
    "start": "977360",
    "end": "983079"
  },
  {
    "text": "only sell it to those four customers obviously in the real world it'd be a lot more than four you'd get better statistical averaging but still I'm",
    "start": "983079",
    "end": "989759"
  },
  {
    "text": "stranding some capacity here and I can hide that by increasing prices if I get",
    "start": "989759",
    "end": "995639"
  },
  {
    "text": "90% utilization out of the fleet compared to what I used to get 11% higher prices and we're back where we",
    "start": "995639",
    "end": "1000839"
  },
  {
    "text": "started now we just announced our 50th price decrease pitching products at Amazon that cause things to get more",
    "start": "1000839",
    "end": "1006959"
  },
  {
    "text": "expensive is not a good path to success so this is bad but this isn't the",
    "start": "1006959",
    "end": "1013360"
  },
  {
    "text": "worst customer B is some sort of social media application whatever the the kids are using these",
    "start": "1013360",
    "end": "1019519"
  },
  {
    "text": "days I've stranded some router capacity there but that's nowhere near as bad as the fact that I've exhausted my instance",
    "start": "1019519",
    "end": "1026678"
  },
  {
    "text": "capacity I can't hide this from the customer customer B wants one more instance or even poor dnf who have no",
    "start": "1026679",
    "end": "1033798"
  },
  {
    "text": "idea that they're collocated with B I have to expose that to them they have to go create another subnet or they have to",
    "start": "1033799",
    "end": "1039280"
  },
  {
    "text": "create a new VPC that's an unacceptable customer experience so to do this",
    "start": "1039280",
    "end": "1045918"
  },
  {
    "start": "1044000",
    "end": "1044000"
  },
  {
    "text": "internally and this is actually a line from our original design doc we want to support millions of environments the",
    "start": "1045919",
    "end": "1051120"
  },
  {
    "text": "size of amazon.com we must not further constrain the placement problem any instance",
    "start": "1051120",
    "end": "1057760"
  },
  {
    "text": "anywhere can be in any Subnet in any VPC so to do",
    "start": "1057760",
    "end": "1063440"
  },
  {
    "start": "1061000",
    "end": "1061000"
  },
  {
    "text": "this we've got servers someone has to be the bottom Turtle we're the ones that own the sheet metal so we've got a",
    "start": "1063440",
    "end": "1070080"
  },
  {
    "text": "physical network with physical servers on those servers we place",
    "start": "1070080",
    "end": "1076440"
  },
  {
    "text": "instances those instances are grouped together into vpc's virtual private clouds in our apis vpcs have identifiers",
    "start": "1076440",
    "end": "1084799"
  },
  {
    "text": "VPC -8 hex cars um I also got tired of typing those in so I used colors here so",
    "start": "1084799",
    "end": "1090880"
  },
  {
    "text": "we've got three vpcs running around in this network and then the mapping service",
    "start": "1090880",
    "end": "1096880"
  },
  {
    "text": "this is a piece of VPC that's not exposed directly to customers the mapping service is the Lynch pin around",
    "start": "1096880",
    "end": "1102559"
  },
  {
    "text": "everything around which everything re revolves so these are the basic building",
    "start": "1102559",
    "end": "1107760"
  },
  {
    "text": "blocks this is layer 2 ethernet this is how ethernet has been working for decades it comes off the operating",
    "start": "1107760",
    "end": "1114200"
  },
  {
    "start": "1108000",
    "end": "1108000"
  },
  {
    "text": "system DVD or I guess whatever it is we used to distribute os's these days",
    "start": "1114200",
    "end": "1120200"
  },
  {
    "text": "um 102 wants to talk to 103 he's going to ARP uh last time I",
    "start": "1120200",
    "end": "1127200"
  },
  {
    "text": "gave this talk I said uh I'm using this this Mac of IP address notation uh because typing in Mac addresses is",
    "start": "1127200",
    "end": "1133400"
  },
  {
    "text": "arduous and it's hard to remember which Macs go with which IP addresses and I said please substitute your favorite",
    "start": "1133400",
    "end": "1138840"
  },
  {
    "text": "48-bit number one of my co-workers kindly pointed out that not all 48-bit numbers are valid Mac addresses so",
    "start": "1138840",
    "end": "1144840"
  },
  {
    "text": "please substitute a valid 48-bit Mac address hi",
    "start": "1144840",
    "end": "1151240"
  },
  {
    "text": "Andrew the ethernet switch doesn't know where 103 is Let's Pretend everything is freshly booted so ethernet switch is",
    "start": "1151240",
    "end": "1157559"
  },
  {
    "text": "going to flood that ARP request out every port including the port that happens to have 103 connected to it 103",
    "start": "1157559",
    "end": "1165280"
  },
  {
    "text": "is going to respond and say hey that's me we're going to learn the MAC at this switch and the ethernet switch will",
    "start": "1165280",
    "end": "1170840"
  },
  {
    "text": "forward the response so now 102 has managed to learn the Mac of 103 the",
    "start": "1170840",
    "end": "1176159"
  },
  {
    "text": "switch happens to have programmed its Cam and so now we can send some sort of Ip packet um the L2 and L3 Source match",
    "start": "1176159",
    "end": "1184360"
  },
  {
    "text": "the L2 and L uh three destinations match the ethernet switch forwards it across the network this is happening I don't",
    "start": "1184360",
    "end": "1191240"
  },
  {
    "text": "know how many trillions of times a second all around the world that's what we have to make work so 102 wants to",
    "start": "1191240",
    "end": "1198120"
  },
  {
    "text": "talk to 10 003 he's going to send that exact same AR request we're going to trap that AR request and we're going to",
    "start": "1198120",
    "end": "1204480"
  },
  {
    "text": "send a query to the mapping service we're going to say hey we're looking for blue 103 mapping service is going to tell us",
    "start": "1204480",
    "end": "1210880"
  },
  {
    "text": "where 103 is we learn the Mac but we also learn the physical server on which blue 103 lives and we form an ARP",
    "start": "1210880",
    "end": "1219559"
  },
  {
    "text": "response and uh propagate it back to the guest one interesting wrinkle here that",
    "start": "1219559",
    "end": "1225480"
  },
  {
    "text": "AR request never made it to 103 you can do this to day in VPC spin up an instance run TCP dump you'll never see",
    "start": "1225480",
    "end": "1231480"
  },
  {
    "text": "art requests it turns out you don't actually need to see the art requests it totally doesn't matter so",
    "start": "1231480",
    "end": "1239679"
  },
  {
    "text": "now we can send that packet it's the exact same packet we're going to send across the physical Network we're going to trap that packet",
    "start": "1239679",
    "end": "1246679"
  },
  {
    "text": "we're going to wrap it with a VPC header it's tagged to the blue VPC we're going to wrap it with a physical Network a",
    "start": "1246679",
    "end": "1252640"
  },
  {
    "text": "substrate network uh IP header and we're going to send it directly to the server that's hosting blue 10",
    "start": "1252640",
    "end": "1260480"
  },
  {
    "text": "3 on re seip we're going to ask the mapping service hey I just got this packet from uh someone claiming to be",
    "start": "1260480",
    "end": "1267480"
  },
  {
    "text": "blue 102 what's up the mapping service is going say that's cool and I didn't",
    "start": "1267480",
    "end": "1272960"
  },
  {
    "text": "draw it here in the slide but this is how uh we fill in the MAC address uh for the source uh at receipt",
    "start": "1272960",
    "end": "1279480"
  },
  {
    "text": "time and then we can deliver this packet to the guest so this is it this is the",
    "start": "1279480",
    "end": "1285400"
  },
  {
    "text": "ethernet stack this is Layer Two packet forwarding within a subnet working straight off the OS DVD we didn't have",
    "start": "1285400",
    "end": "1291080"
  },
  {
    "text": "to change anything in the instances Windows Linux whatever it just works um in order for these two",
    "start": "1291080",
    "end": "1298320"
  },
  {
    "text": "instances to communicate the only requirements are they have to have direct IP connectivity to each other and they have to be able to talk to the",
    "start": "1298320",
    "end": "1304080"
  },
  {
    "text": "mapping service we know how to build networks that span data centers that span the globe so we've succeeded here",
    "start": "1304080",
    "end": "1310679"
  },
  {
    "text": "we have we have not constrained the placement problem any two physical servers can host a pair of instances in",
    "start": "1310679",
    "end": "1317159"
  },
  {
    "text": "any subnet regardless of their placement on the IP network uh so the virtual L2 topology is",
    "start": "1317159",
    "end": "1323120"
  },
  {
    "text": "completely decoupled from the physical topology so that mapping check on receipt let's dig into that for a",
    "start": "1323120",
    "end": "1330200"
  },
  {
    "start": "1330000",
    "end": "1330000"
  },
  {
    "text": "moment so let's say that for whatever reason gray 104 wants to talk to",
    "start": "1330200",
    "end": "1338240"
  },
  {
    "text": "103 we're going to send a query to the mapping service but it's going to be tagged to gray you have full access to the IP",
    "start": "1338240",
    "end": "1345720"
  },
  {
    "text": "headers and the packets you generate you can fill in any 32-bit Des destination address you want we will always",
    "start": "1345720",
    "end": "1350960"
  },
  {
    "text": "interpret that in the context of your VPC and so you can scan you can literally scan a/ Zero from within your",
    "start": "1350960",
    "end": "1357640"
  },
  {
    "text": "VPC and unless you have routes to them you can't talk to instances in other",
    "start": "1357640",
    "end": "1363120"
  },
  {
    "text": "vpcs via some means we've got a a corrupt mapping uh",
    "start": "1363960",
    "end": "1370640"
  },
  {
    "text": "something something has gone wrong here we're going to send this query and it's tagged to",
    "start": "1370640",
    "end": "1377000"
  },
  {
    "text": "Blue so we claimed to be from the blue VPC the mapping service knows that there",
    "start": "1377000",
    "end": "1382760"
  },
  {
    "text": "aren't any blue instances on that physical server this is an errant packet it should not flow so we're going to",
    "start": "1382760",
    "end": "1388400"
  },
  {
    "text": "deny that mapping we're not going to tell the source where that destination is and we're going to call a",
    "start": "1388400",
    "end": "1394279"
  },
  {
    "text": "human if via some means we manage to obtain the mapping and we send the",
    "start": "1394279",
    "end": "1400039"
  },
  {
    "text": "packet across the physical Network on receipt we're going to do that reverse mapping check we're going to say could",
    "start": "1400039",
    "end": "1406720"
  },
  {
    "text": "you please verify for me that the the instance claiming to be blue 104 is really at that physical",
    "start": "1406720",
    "end": "1413000"
  },
  {
    "text": "Source no it's not this this mapping is invalid this packet is",
    "start": "1413000",
    "end": "1418159"
  },
  {
    "text": "invalid so we're going to drop that packet we're going to call for a human what this means is that packets can't",
    "start": "1418159",
    "end": "1424840"
  },
  {
    "text": "flow across the network unless all parties involved the source the destination and the mapping service agree that the packets should flow our",
    "start": "1424840",
    "end": "1431840"
  },
  {
    "text": "control plan has 100% visibility into where every L2 and L3 address is placed in the network and we can very strictly",
    "start": "1431840",
    "end": "1439000"
  },
  {
    "text": "control which packets flow so next up is",
    "start": "1439000",
    "end": "1444080"
  },
  {
    "start": "1442000",
    "end": "1442000"
  },
  {
    "text": "L3 again this is straight off the OS DVD it's the way it's worked for years um in this case we have uh if we assume sl24",
    "start": "1444080",
    "end": "1451559"
  },
  {
    "text": "net masks we're talking across a subnet boundary so 102 wants to talk to 1013",
    "start": "1451559",
    "end": "1456880"
  },
  {
    "text": "this is in a different subnet we have to go through our Gateway so we're going to ARP for our Gateway it's the exact same",
    "start": "1456880",
    "end": "1462799"
  },
  {
    "text": "dance packet floods we learned the mac and we uh we we learned the destination Mac address and so now we can send a",
    "start": "1462799",
    "end": "1469960"
  },
  {
    "text": "packet and in this case the L2 and L3 sources line up but the L2 and L3",
    "start": "1469960",
    "end": "1475320"
  },
  {
    "text": "destinations don't the L2 destination is the Gateway the L3 destination is the eventual host we send it to the router",
    "start": "1475320",
    "end": "1483000"
  },
  {
    "text": "the router swaps out the Mac addresses now the source is the router interface on the right subnet um and the uh L3",
    "start": "1483000",
    "end": "1490240"
  },
  {
    "text": "destination is still the eventual box and we deliver it this is L3 IP",
    "start": "1490240",
    "end": "1495399"
  },
  {
    "text": "forwarding as routers have been doing it since time began so we've got the same situation in",
    "start": "1495399",
    "end": "1502640"
  },
  {
    "text": "VPC we're going to ARP for our Gateway the mapping service is going to tell us",
    "start": "1502640",
    "end": "1508679"
  },
  {
    "text": "it's a special host it's a Gateway so we get a MAC address for it but we don't have a physical destination for it we",
    "start": "1508679",
    "end": "1515559"
  },
  {
    "text": "can send the ARP response back to the guest thus completing the protocol and so now the guest is going to try and",
    "start": "1515559",
    "end": "1521919"
  },
  {
    "text": "send a packet this is the exact same packet that it would have put on the wire in the previous slide we stop that packet we queue it up",
    "start": "1521919",
    "end": "1528919"
  },
  {
    "text": "and we make a secondary query to the mapping service and this time we don't query on the L2 destination we query on",
    "start": "1528919",
    "end": "1534559"
  },
  {
    "text": "the L3 destination so we learn that uh blue 1013 is located in that box on the",
    "start": "1534559",
    "end": "1540799"
  },
  {
    "text": "lower right 1921 16814 so now we can send this packet",
    "start": "1540799",
    "end": "1545840"
  },
  {
    "text": "across the physical Network wrap it in the VPC header wrap it in the physical header and deliver it the exact same",
    "start": "1545840",
    "end": "1552679"
  },
  {
    "text": "reverse mapping check gets performed we swap out the MAC address es",
    "start": "1552679",
    "end": "1559480"
  },
  {
    "text": "deliver to the guest this again achieves our",
    "start": "1559480",
    "end": "1567399"
  },
  {
    "text": "goal we've placed no further constraints on L3 packet forwarding compared to L2 packet forwarding any two boxes that",
    "start": "1567520",
    "end": "1574760"
  },
  {
    "text": "have IP connectivity with each other and with the mapping service can host any two instances in any VPC across subnet",
    "start": "1574760",
    "end": "1581440"
  },
  {
    "text": "boundaries so this is this is the system we went with the system is not without",
    "start": "1581440",
    "end": "1586919"
  },
  {
    "text": "scaling limits but it's with scaling limits that match our use case it's designed to match our very specific very",
    "start": "1586919",
    "end": "1593840"
  },
  {
    "text": "narrow use case and we own it we can fix it we can alter it as time goes",
    "start": "1593840",
    "end": "1600120"
  },
  {
    "text": "on so I queed this packet the customer sent",
    "start": "1600120",
    "end": "1605559"
  },
  {
    "start": "1601000",
    "end": "1601000"
  },
  {
    "text": "it I snagged it and I queried the mapping service so this means that the mapping service is now critical to",
    "start": "1605559",
    "end": "1611360"
  },
  {
    "text": "packet flows that if the mapping service isn't available the packets won't flow and in addition even if the mapping",
    "start": "1611360",
    "end": "1618360"
  },
  {
    "text": "Services working correctly there's now two paths through the system there's a fast path where we've already got the mappings and there's a slow path where",
    "start": "1618360",
    "end": "1624919"
  },
  {
    "text": "we have to Q packets and query the mapping service and so in reality there's a mapping service replica a",
    "start": "1624919",
    "end": "1631200"
  },
  {
    "text": "little cache on every single one of our physical boxes and they subscribe to the",
    "start": "1631200",
    "end": "1636360"
  },
  {
    "text": "mapping service it's logically exactly the same we have strict akles on all of",
    "start": "1636360",
    "end": "1641600"
  },
  {
    "text": "the records and the mapping service the cach can't populate records that it shouldn't have access to we get the same",
    "start": "1641600",
    "end": "1647200"
  },
  {
    "text": "kinds of alarms raised when instances try and fetch the wrong records but it means that we have a 100% cash hit ratio",
    "start": "1647200",
    "end": "1653679"
  },
  {
    "text": "we actually did not implement the cash miss path the only way to translate packets is through this cache and so",
    "start": "1653679",
    "end": "1660159"
  },
  {
    "text": "that gets us dead flat latency and it mitigates a bunch of availability concerns",
    "start": "1660159",
    "end": "1666120"
  },
  {
    "text": "so new new content warning I've told you how we can talk",
    "start": "1666120",
    "end": "1671799"
  },
  {
    "text": "within a subnet L2 forwarding and how we can talk across subnet boundaries L3 forwarding",
    "start": "1671799",
    "end": "1678679"
  },
  {
    "text": "but I haven't answered the problem that motivated the entire talk how do you get back to your home office or your your",
    "start": "1678679",
    "end": "1684600"
  },
  {
    "text": "existing data centers and we we know how to send the packet like there's a source IP a",
    "start": "1684600",
    "end": "1690720"
  },
  {
    "text": "destination IP life is good we can wrap it with a VPC header but then what do we",
    "start": "1690720",
    "end": "1696200"
  },
  {
    "text": "put in for the destination or if I do put in your your VPN router as the",
    "start": "1696200",
    "end": "1701720"
  },
  {
    "text": "destination it's going to get this proprietary Amazon wrapped packet and be all confused droing on the floor and",
    "start": "1701720",
    "end": "1706880"
  },
  {
    "text": "your packets aren't going to flow and so we've got a new kind of thing in",
    "start": "1706880",
    "end": "1712080"
  },
  {
    "text": "the VPC world we call them edges we're very creative people so if we look at the mappings",
    "start": "1712080",
    "end": "1719640"
  },
  {
    "text": "that are cached on this physical server there's actually two kinds of mappings there there's SL 32s effectively there's",
    "start": "1719640",
    "end": "1726799"
  },
  {
    "text": "Host mappings this is for talking to other instances but then there's also routes there's CER mappings and so we",
    "start": "1726799",
    "end": "1733799"
  },
  {
    "text": "have a route here that says 17216 0016 which is the home office or the data",
    "start": "1733799",
    "end": "1740039"
  },
  {
    "text": "center routes to this Edge and so we know how to do this like",
    "start": "1740039",
    "end": "1745559"
  },
  {
    "text": "you send the packet we wrap it up we send it onto the edge The Edge will",
    "start": "1745559",
    "end": "1750720"
  },
  {
    "start": "1749000",
    "end": "1749000"
  },
  {
    "text": "perform exactly the same reverse mapping checks it's just another participant in the VPC Network and so what this thing",
    "start": "1750720",
    "end": "1757480"
  },
  {
    "text": "does if for example we're talking down a VPN connection we send the packet to the",
    "start": "1757480",
    "end": "1763240"
  },
  {
    "text": "edge the packet is familiar with our virtual networking protocols it can unwrap this packet figure out where it's",
    "start": "1763240",
    "end": "1769320"
  },
  {
    "text": "going and it can rewrap this packet and in the case of VPN it's all IPC so we've",
    "start": "1769320",
    "end": "1775919"
  },
  {
    "text": "got a A system that takes VPC encapsulated packets determines whether",
    "start": "1775919",
    "end": "1781080"
  },
  {
    "text": "or not they should flow Maps them onto customer IPS tunnels and sends them out over the open",
    "start": "1781080",
    "end": "1787240"
  },
  {
    "text": "internet if you're using Direct Connect rather than using IPC tunnels over the internet you can get a Hardline",
    "start": "1787240",
    "end": "1793240"
  },
  {
    "text": "connection a a fiber gigabit 10 GB connection to AWS if you're using Direct connect we do almost exactly the same",
    "start": "1793240",
    "end": "1800840"
  },
  {
    "text": "thing except that rather than doing IPC we put A1 QV land tag for handoff to our",
    "start": "1800840",
    "end": "1806679"
  },
  {
    "text": "Direct Connect router I I I complained about VLAN tags earlier so I owe you guys an explanation",
    "start": "1806679",
    "end": "1813640"
  },
  {
    "text": "4,096 isn't a lot but this vline is literally that long it moves from one",
    "start": "1813640",
    "end": "1818720"
  },
  {
    "text": "router in a cage to another router in the same cage and so we're limited to",
    "start": "1818720",
    "end": "1824159"
  },
  {
    "text": "4,000 customers per Port that's not a limitation for for us we reuse VLAN tags",
    "start": "1824159",
    "end": "1829880"
  },
  {
    "text": "per Port so there's also the internet people",
    "start": "1829880",
    "end": "1835120"
  },
  {
    "text": "like talking to the internet there's a lot of stuff out there send the packet to the edge this",
    "start": "1835120",
    "end": "1841240"
  },
  {
    "text": "is getting boring but then what do we do with it how do how do we encapsulate it for",
    "start": "1841240",
    "end": "1846640"
  },
  {
    "text": "sending to the internet and the reality is we don't want to encapsulate it to send it to the internet we just want IP",
    "start": "1846640",
    "end": "1852760"
  },
  {
    "text": "packets that's what the internet runs on and so",
    "start": "1852760",
    "end": "1859919"
  },
  {
    "text": "there you go if I send this packet out to the internet with this Source IP it'll actually",
    "start": "1859919",
    "end": "1865799"
  },
  {
    "text": "arrive the destination will get it and it'll attempt to send return traffic 102",
    "start": "1865799",
    "end": "1871080"
  },
  {
    "text": "is an rfc1918 IP address it's not routable on the internet so the host actually doesn't know that it'll if it's",
    "start": "1871080",
    "end": "1877320"
  },
  {
    "text": "a a TCP connection the sin packet will go out the sin act packet will be generated by the server he'll drop it",
    "start": "1877320",
    "end": "1882639"
  },
  {
    "text": "into his Network it'll fall on the floor this is an unsuccessful network connection so we do one to one Nat this",
    "start": "1882639",
    "end": "1889360"
  },
  {
    "text": "is where elastic IP addresses enter the story so when you map an EIP an elastic IP address a public internet routable IP",
    "start": "1889360",
    "end": "1895320"
  },
  {
    "text": "address to your instance this Edge is the box that's performing that one toone translation so on the way out we replace",
    "start": "1895320",
    "end": "1901919"
  },
  {
    "text": "the source IP with your EIP on the way back it's going to be sent to your EIP we swap out the destination IP address",
    "start": "1901919",
    "end": "1908279"
  },
  {
    "text": "for the private IP of your instance so we've got a box now it does",
    "start": "1908279",
    "end": "1914320"
  },
  {
    "text": "packet mangling for us packet translations and uh an interesting story there's a",
    "start": "1914320",
    "end": "1922600"
  },
  {
    "start": "1918000",
    "end": "1918000"
  },
  {
    "text": "good-sized chunk of the ec2 team in Cape Town South Africa which is almost as far as you can get from Seattle uh it's",
    "start": "1922600",
    "end": "1929679"
  },
  {
    "text": "called antipodes if you put a globe on a drill press and you start in Seattle the",
    "start": "1929679",
    "end": "1935399"
  },
  {
    "text": "drill will come out in the Indian Ocean off the coast of South Africa if you go there you will",
    "start": "1935399",
    "end": "1943519"
  },
  {
    "text": "encounter the African penguin the African penguin is also known as the jackass penguin because",
    "start": "1943519",
    "end": "1949880"
  },
  {
    "text": "they really do sound like donkeys but it's also known as the Blackfoot penguin and Tux is the Linux",
    "start": "1949880",
    "end": "1957399"
  },
  {
    "text": "mascot so when we built a Linux based Network Appliance for ec2 we named it",
    "start": "1957399",
    "end": "1962919"
  },
  {
    "text": "the Blackfoot so if you hear any Amazon people talking about black feet that's those Edge devices and it also happens",
    "start": "1962919",
    "end": "1969360"
  },
  {
    "text": "to be the name of one of our office buildings in Seattle so most of AWS works in the Blackfoot",
    "start": "1969360",
    "end": "1975440"
  },
  {
    "text": "building so pricing VPC costs",
    "start": "1975440",
    "end": "1981480"
  },
  {
    "start": "1976000",
    "end": "1976000"
  },
  {
    "text": "nothing subnets cost nothing and we instances in a VPC don't cost anymore",
    "start": "1981480",
    "end": "1989000"
  },
  {
    "text": "and so I mentioned that earlier we had our 50th price decrease at AWS VPC will",
    "start": "1989000",
    "end": "1995639"
  },
  {
    "text": "never participate in aws's tradition of decreasing",
    "start": "1995639",
    "end": "2000480"
  },
  {
    "text": "prices but this is exactly where we want it to be we can now offer customers a",
    "start": "2001919",
    "end": "2007200"
  },
  {
    "text": "flexible programmable virtual Network at no charge in addition to being the day",
    "start": "2007200",
    "end": "2013960"
  },
  {
    "text": "after my birthday um this is the day that the last us retail web server last",
    "start": "2013960",
    "end": "2019639"
  },
  {
    "text": "us retail physical web server was turned off I saw the slide from Lauri Gritz drinking our own champagne talk so if",
    "start": "2019639",
    "end": "2026880"
  },
  {
    "text": "you've bought anything if you've surfed the Amazon website since November 10th 2010 and I hope you all",
    "start": "2026880",
    "end": "2034279"
  },
  {
    "text": "have the page you viewed was rendered by an ec2 instance 100% of us retail uh Pages have been",
    "start": "2034279",
    "end": "2042880"
  },
  {
    "text": "rendered in ec2 since this day so this is not a research project for us this is",
    "start": "2042880",
    "end": "2048280"
  },
  {
    "text": "a robust production Network we run our business on it and we carried Q4 in",
    "start": "2048280",
    "end": "2054560"
  },
  {
    "text": "November this year it's going to be the sixth Q4 for Amazon retail that we carry in",
    "start": "2054560",
    "end": "2061519"
  },
  {
    "text": "VPC VPC has grown a lot it it's become a platform so you were always able to get",
    "start": "2062159",
    "end": "2068638"
  },
  {
    "text": "instances in your VPC but a lot of our services like RDS",
    "start": "2068639",
    "end": "2073839"
  },
  {
    "text": "databases and redshift clusters can be launched inside your VPC and so now",
    "start": "2073839",
    "end": "2079280"
  },
  {
    "text": "clients in your home office can access these things over the private Network these things can access your existing",
    "start": "2079280",
    "end": "2085079"
  },
  {
    "text": "data centers over Direct Connect connections to load data and to interact with existing",
    "start": "2085079",
    "end": "2090280"
  },
  {
    "text": "applications there have been a ton of features that we've launched with ec2 we didn't have a network to describe that there was no network you",
    "start": "2090280",
    "end": "2097440"
  },
  {
    "start": "2091000",
    "end": "2091000"
  },
  {
    "text": "had IP address and now that we have a network we've added Network features so we started off with VPN and direct to",
    "start": "2097440",
    "end": "2103079"
  },
  {
    "text": "connect private connectivity to the cloud uh security groups we've always had security groups in ec2 but in VPC we",
    "start": "2103079",
    "end": "2110200"
  },
  {
    "text": "added egress filtering so if you want to filter packets outbound from your instances you can do it in VPC Network",
    "start": "2110200",
    "end": "2116599"
  },
  {
    "text": "accles we have a lot of customers that are used to grouping instances together in ec2 IP addresses were random numbers",
    "start": "2116599",
    "end": "2123760"
  },
  {
    "text": "two IP addresses that were close together didn't mean that they were doing the same job they weren't both web servers they may not even be owned by",
    "start": "2123760",
    "end": "2129560"
  },
  {
    "text": "the same customer in VPC you can lay out your subnets however you want if you have it policies that say that these",
    "start": "2129560",
    "end": "2136280"
  },
  {
    "text": "kind of servers must be separated from those kind of servers you can do it with a couple of API calls and then you can use Network accles as you do today in",
    "start": "2136280",
    "end": "2143280"
  },
  {
    "text": "your data center to separate those servers uh routing tables this allows you to implement virtual",
    "start": "2143280",
    "end": "2149200"
  },
  {
    "text": "appliances um with elastic network interfaces um we like our elasticity at",
    "start": "2149200",
    "end": "2155359"
  },
  {
    "text": "AWS you can basically plug multiple Nicks into an ec2 instance and so once you have two Nicks in a box you can set",
    "start": "2155359",
    "end": "2163000"
  },
  {
    "text": "it up as a virtual Appliance you can plug it into two subnets and now you've got a firewall or a load balancer or",
    "start": "2163000",
    "end": "2168400"
  },
  {
    "text": "whatever it is that you want to program that box to do um multiple IP addresses per Nick we had customers that wanted to",
    "start": "2168400",
    "end": "2174800"
  },
  {
    "text": "serve multiple uh sites off of their uh instances and they didn't have Sni support so they needed to serve",
    "start": "2174800",
    "end": "2180079"
  },
  {
    "text": "different CS based on who is contacting them uh things like this are uh really useful to",
    "start": "2180079",
    "end": "2186560"
  },
  {
    "text": "customers and a fun one that we launched recently I'm I'm really a fan of this feature is",
    "start": "2186560",
    "end": "2192800"
  },
  {
    "start": "2187000",
    "end": "2187000"
  },
  {
    "text": "S3 endpoints prior to launching this feature if your instances wanted to talk",
    "start": "2192800",
    "end": "2198480"
  },
  {
    "text": "to S3 they had to do so over the internet you had to create an internet gateway in your VPC and you sent the",
    "start": "2198480",
    "end": "2203760"
  },
  {
    "text": "traffic out this meant that either this instance or a Nat instance something had a public IP address and this traffic was",
    "start": "2203760",
    "end": "2211359"
  },
  {
    "text": "traversing the Amazon border Network so we introduced the ability to create an S3 endpoint",
    "start": "2211359",
    "end": "2218280"
  },
  {
    "text": "you you declare this via our apis you say I want an S3 endpoint and I want to attach it to this VPC and it's a",
    "start": "2218280",
    "end": "2224280"
  },
  {
    "text": "routable Target and so your instance talks to your S3 Gateway your S3",
    "start": "2224280",
    "end": "2230640"
  },
  {
    "text": "endpoint and the S3 endpoint takes care of getting that traffic to S3 via Amazon's private",
    "start": "2230640",
    "end": "2237440"
  },
  {
    "text": "Network and the way we implemented this this should look very familiar we added a new kind of",
    "start": "2237440",
    "end": "2244280"
  },
  {
    "text": "Route so rather than routing a cider block you can now route what we called a named prefix so there's a set of IP",
    "start": "2244280",
    "end": "2251920"
  },
  {
    "text": "addresses that represent S3 in this case in us east1 and you can say S3 in Us",
    "start": "2251920",
    "end": "2258040"
  },
  {
    "text": "East one doesn't go towards the internet it goes towards there and so exactly the same thing it's",
    "start": "2258040",
    "end": "2265800"
  },
  {
    "text": "a little bit more constrained I assume you're not going to be sending UDP or icmp traffic to S3 you can if you want",
    "start": "2265800",
    "end": "2271040"
  },
  {
    "text": "we're not going to do anything useful with it we can wrap that packet send it to an edge and pass on and what we've",
    "start": "2271040",
    "end": "2279160"
  },
  {
    "start": "2277000",
    "end": "2277000"
  },
  {
    "text": "done here is we've created a new encapsulation that's specific to VPC",
    "start": "2279160",
    "end": "2285119"
  },
  {
    "text": "endpoints and we don't NAD when this packet arrives at S3 it has the original",
    "start": "2285119",
    "end": "2291640"
  },
  {
    "text": "Source IP address the private IP address of that instance when it gets to S3 and it also has that green header there it's",
    "start": "2291640",
    "end": "2297599"
  },
  {
    "text": "tagged with the VPC endpoint ID the reason we created a new encapsulation was to decouple State we",
    "start": "2297599",
    "end": "2304079"
  },
  {
    "text": "didn't want S3 to have to understand all of the placement of instances this doesn't tell you where the physical",
    "start": "2304079",
    "end": "2309119"
  },
  {
    "text": "server is located in the VPC Network it just tells you it came from this VPC endpoint uh lows our two teams to",
    "start": "2309119",
    "end": "2316040"
  },
  {
    "text": "iterate separately we weren't coupled so because you get the original",
    "start": "2316040",
    "end": "2321440"
  },
  {
    "text": "Source IP address and you get the VPC endpoint ID you can do some interesting",
    "start": "2321440",
    "end": "2326520"
  },
  {
    "start": "2325000",
    "end": "2325000"
  },
  {
    "text": "things you can apply an aspen policy a standard AWS Access Control policy to",
    "start": "2326520",
    "end": "2332200"
  },
  {
    "text": "that endpoint and you can say only this bucket is accessible via this endpoint",
    "start": "2332200",
    "end": "2339400"
  },
  {
    "text": "instances that are routing through that endpoint will not be able to get to any other buckets likewise you can apply a policy",
    "start": "2339400",
    "end": "2347000"
  },
  {
    "text": "to your S3 bucket you've been able to do this for years but now you can speak to the VPC",
    "start": "2347000",
    "end": "2353040"
  },
  {
    "text": "endpoint or the VPC ID in the policy and so I've said that my bucket is only",
    "start": "2353040",
    "end": "2359319"
  },
  {
    "text": "accessible from this one VPC I could give you my AWS keys I could",
    "start": "2359319",
    "end": "2365319"
  },
  {
    "text": "crack open everything else about that bucket but you still wouldn't be able to get to it unless you were inside my VPC",
    "start": "2365319",
    "end": "2371280"
  },
  {
    "text": "and so now you can use the exact same policies that you use elsewhere in AWS to enforce uh to enforce your desired",
    "start": "2371280",
    "end": "2378119"
  },
  {
    "text": "security stance end to end so there's there's a spectrum",
    "start": "2378119",
    "end": "2385119"
  },
  {
    "text": "here on the one hand you've got simple on the other hand you've got complex simple things tend to be limited",
    "start": "2385119",
    "end": "2391760"
  },
  {
    "text": "there are fewer knobs to turn fewer dials to play with things that are",
    "start": "2391760",
    "end": "2396880"
  },
  {
    "text": "complex tend to be more flexible there's more of a learning curve well the ec2 network was simple you got an IP address",
    "start": "2396880",
    "end": "2402400"
  },
  {
    "text": "you got a public IP address you were done the VPC network is complicated but there's a lot more you can do with it",
    "start": "2402400",
    "end": "2409079"
  },
  {
    "text": "and this isn't a value judgment I own both a multimeter and oscilloscope they're both good tools but I use them",
    "start": "2409079",
    "end": "2414520"
  },
  {
    "text": "for different things and so a feature that we added uh a couple of years ago is default",
    "start": "2414520",
    "end": "2422520"
  },
  {
    "text": "VPC the problem we had is we want everyone to be in a VPC if you you launch an ec2 instance it's perfectly",
    "start": "2422520",
    "end": "2429640"
  },
  {
    "text": "reasonable thing to do we like it when people launch ec2 instances and you decide 3 years later that now your",
    "start": "2429640",
    "end": "2435079"
  },
  {
    "text": "scaled application needs private connectivity somewhere you want egress filtering on uh your security groups or",
    "start": "2435079",
    "end": "2440720"
  },
  {
    "text": "you want an S3 endpoint you have to move into a VPC this is hard to",
    "start": "2440720",
    "end": "2447319"
  },
  {
    "text": "do so we wanted everyone to have a VPC but we didn't want everyone to have to",
    "start": "2447319",
    "end": "2452440"
  },
  {
    "text": "deal with all of the complexity of VPC on their first day as a customer",
    "start": "2452440",
    "end": "2457800"
  },
  {
    "text": "and so it needed to be code compatible with ec2 we've got a getting started guide we can fix our getting started guide we've",
    "start": "2457800",
    "end": "2463960"
  },
  {
    "text": "got an SDK we can fix our SDK there's an infinite number of blog posts out there that talk about how you do something in",
    "start": "2463960",
    "end": "2470680"
  },
  {
    "text": "AWS and we couldn't invalidate that whole body of knowledge it had to continue working so we had to be code",
    "start": "2470680",
    "end": "2476000"
  },
  {
    "text": "compatible with ec2 and so it is you can launch and terminate instances you can",
    "start": "2476000",
    "end": "2481160"
  },
  {
    "text": "run those shell scripts you find on web pages all over the place and it works but if one day you decide you need the",
    "start": "2481160",
    "end": "2486599"
  },
  {
    "text": "functionality of VPC you can break the glass you can peek at the man behind the curtain and it turns out that when you",
    "start": "2486599",
    "end": "2492800"
  },
  {
    "text": "launched that first instance we created a VPC we laid out subnets and then we hid everything from you and so the",
    "start": "2492800",
    "end": "2498880"
  },
  {
    "text": "getting started guide is still pick an Amy run an instance but if you later want con activity to your home office or",
    "start": "2498880",
    "end": "2505119"
  },
  {
    "text": "to your data center you can go through all of that and so we've managed to span a",
    "start": "2505119",
    "end": "2510839"
  },
  {
    "text": "fairly large swath of this spectrum we've got one service that allows",
    "start": "2510839",
    "end": "2516240"
  },
  {
    "text": "customers to get started easily and quickly just like ec2 did but allows them to evolve incrementally as they",
    "start": "2516240",
    "end": "2521839"
  },
  {
    "text": "need the additional flexibility additional functionality of EPC to address some very complicated use",
    "start": "2521839",
    "end": "2528720"
  },
  {
    "text": "cases so thank you for your time and I've been told that my return",
    "start": "2528720",
    "end": "2534520"
  },
  {
    "text": "ticket home is in danger if you do not fill out your evaluations so please fill out your evaluations we value your",
    "start": "2534520",
    "end": "2542359"
  },
  {
    "text": "feedback",
    "start": "2544040",
    "end": "2547040"
  }
]