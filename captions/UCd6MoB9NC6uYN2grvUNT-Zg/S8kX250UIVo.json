[
  {
    "text": "hello and welcome my name is chirag dave",
    "start": "80",
    "end": "2560"
  },
  {
    "text": "i'm a senior database specialist",
    "start": "2560",
    "end": "4640"
  },
  {
    "text": "solution architect here at aws and i'm",
    "start": "4640",
    "end": "7839"
  },
  {
    "text": "here to talk to you about",
    "start": "7839",
    "end": "9040"
  },
  {
    "text": "minimal downtime major version upgrade",
    "start": "9040",
    "end": "11360"
  },
  {
    "text": "strategy for amazon rds and amazon",
    "start": "11360",
    "end": "13840"
  },
  {
    "text": "aurora postgres so agenda for today i'm",
    "start": "13840",
    "end": "16800"
  },
  {
    "text": "going to talk about",
    "start": "16800",
    "end": "18160"
  },
  {
    "text": "what is major and minor version upgrade",
    "start": "18160",
    "end": "21279"
  },
  {
    "text": "when it comes to postgres",
    "start": "21279",
    "end": "22640"
  },
  {
    "text": "i'll talk about how do you perform major",
    "start": "22640",
    "end": "24720"
  },
  {
    "text": "minor version upgrade in rds or",
    "start": "24720",
    "end": "26640"
  },
  {
    "text": "postgres and more importantly i'll be",
    "start": "26640",
    "end": "29119"
  },
  {
    "text": "spending time on",
    "start": "29119",
    "end": "30640"
  },
  {
    "text": "demonstrating and talking about use of",
    "start": "30640",
    "end": "33120"
  },
  {
    "text": "logical replication for major version",
    "start": "33120",
    "end": "35040"
  },
  {
    "text": "upgrade",
    "start": "35040",
    "end": "35840"
  },
  {
    "text": "or rather minimal downtime major version",
    "start": "35840",
    "end": "38239"
  },
  {
    "text": "upgrade",
    "start": "38239",
    "end": "39680"
  },
  {
    "text": "so let's talk about what is major and",
    "start": "39680",
    "end": "41200"
  },
  {
    "text": "minor version upgrade so minor version",
    "start": "41200",
    "end": "43360"
  },
  {
    "text": "of gradient postgres are typically",
    "start": "43360",
    "end": "45680"
  },
  {
    "text": "contains security fixes and bug fixes",
    "start": "45680",
    "end": "48960"
  },
  {
    "text": "they do not contain any new feature and",
    "start": "48960",
    "end": "51600"
  },
  {
    "text": "generally there are patches to the",
    "start": "51600",
    "end": "52960"
  },
  {
    "text": "binary",
    "start": "52960",
    "end": "53760"
  },
  {
    "text": "and more importantly they are compatible",
    "start": "53760",
    "end": "55760"
  },
  {
    "text": "with the earlier or later minor version",
    "start": "55760",
    "end": "58399"
  },
  {
    "text": "of the same major version",
    "start": "58399",
    "end": "60000"
  },
  {
    "text": "so for example if you're running on",
    "start": "60000",
    "end": "61359"
  },
  {
    "text": "10.12 for example",
    "start": "61359",
    "end": "63359"
  },
  {
    "text": "uh 10.13 will be if you the next",
    "start": "63359",
    "end": "66000"
  },
  {
    "text": "available minor version it'll be",
    "start": "66000",
    "end": "67600"
  },
  {
    "text": "compatible with 10.12 and any newer",
    "start": "67600",
    "end": "69760"
  },
  {
    "text": "minor version that comes for version 10.",
    "start": "69760",
    "end": "73200"
  },
  {
    "text": "major version in contrast introduced new",
    "start": "73200",
    "end": "76560"
  },
  {
    "text": "functionality and feature",
    "start": "76560",
    "end": "78159"
  },
  {
    "text": "and we typically track the postgres",
    "start": "78159",
    "end": "80159"
  },
  {
    "text": "community which they release",
    "start": "80159",
    "end": "81600"
  },
  {
    "text": "major version every year and",
    "start": "81600",
    "end": "84799"
  },
  {
    "text": "typically major version do require some",
    "start": "84799",
    "end": "87920"
  },
  {
    "text": "system catalog",
    "start": "87920",
    "end": "88960"
  },
  {
    "text": "and the page format do change so it",
    "start": "88960",
    "end": "90960"
  },
  {
    "text": "requires significant amount of",
    "start": "90960",
    "end": "92880"
  },
  {
    "text": "testing and planning around it because",
    "start": "92880",
    "end": "94720"
  },
  {
    "text": "of the functionality feature",
    "start": "94720",
    "end": "96320"
  },
  {
    "text": "and the overall the structure of the",
    "start": "96320",
    "end": "98479"
  },
  {
    "text": "data is changing",
    "start": "98479",
    "end": "100640"
  },
  {
    "text": "and the time requires to upgrade is even",
    "start": "100640",
    "end": "103920"
  },
  {
    "text": "takes longer than the minor version",
    "start": "103920",
    "end": "105680"
  },
  {
    "text": "upgrade so let's talk about how",
    "start": "105680",
    "end": "107360"
  },
  {
    "text": "the minor version upgrade works in rds",
    "start": "107360",
    "end": "109680"
  },
  {
    "text": "and then we'll talk about major version",
    "start": "109680",
    "end": "112079"
  },
  {
    "text": "so minor version upgrade in postgres uh",
    "start": "112079",
    "end": "114720"
  },
  {
    "text": "typically",
    "start": "114720",
    "end": "115759"
  },
  {
    "text": "means changing the binary of the",
    "start": "115759",
    "end": "117920"
  },
  {
    "text": "postgres database so we shut down the",
    "start": "117920",
    "end": "119600"
  },
  {
    "text": "instance",
    "start": "119600",
    "end": "120560"
  },
  {
    "text": "we replace the binary and restart the",
    "start": "120560",
    "end": "122640"
  },
  {
    "text": "database",
    "start": "122640",
    "end": "123600"
  },
  {
    "text": "so generally the time it takes for minor",
    "start": "123600",
    "end": "125680"
  },
  {
    "text": "version upgrade is typically",
    "start": "125680",
    "end": "127360"
  },
  {
    "text": "less than five or ten minutes and as",
    "start": "127360",
    "end": "129840"
  },
  {
    "text": "long as you don't have any long running",
    "start": "129840",
    "end": "131280"
  },
  {
    "text": "transaction",
    "start": "131280",
    "end": "132400"
  },
  {
    "text": "typically the process is really really",
    "start": "132400",
    "end": "134319"
  },
  {
    "text": "fast so you can reduce the time to",
    "start": "134319",
    "end": "137040"
  },
  {
    "text": "do a minor version upgrade as long as",
    "start": "137040",
    "end": "138720"
  },
  {
    "text": "you do you're not running any long",
    "start": "138720",
    "end": "140400"
  },
  {
    "text": "running transaction",
    "start": "140400",
    "end": "141360"
  },
  {
    "text": "during the minor version upgrade window",
    "start": "141360",
    "end": "144400"
  },
  {
    "text": "and in rds you can perform",
    "start": "144400",
    "end": "147760"
  },
  {
    "text": "minor version upgrade either",
    "start": "147760",
    "end": "149360"
  },
  {
    "text": "automatically or manually so we have a",
    "start": "149360",
    "end": "151120"
  },
  {
    "text": "feature called auto miner version",
    "start": "151120",
    "end": "152720"
  },
  {
    "text": "upgrade which is default",
    "start": "152720",
    "end": "154239"
  },
  {
    "text": "on and at this point",
    "start": "154239",
    "end": "157519"
  },
  {
    "text": "if it's on we will upgrade your postgres",
    "start": "157519",
    "end": "160400"
  },
  {
    "text": "to a newer minor version upgrade",
    "start": "160400",
    "end": "162480"
  },
  {
    "text": "when it's available during the next",
    "start": "162480",
    "end": "164160"
  },
  {
    "text": "available maintenance window",
    "start": "164160",
    "end": "166800"
  },
  {
    "text": "major version upgrade in postgres",
    "start": "166800",
    "end": "170319"
  },
  {
    "text": "there are a few options so first option",
    "start": "170319",
    "end": "173120"
  },
  {
    "text": "is",
    "start": "173120",
    "end": "173360"
  },
  {
    "text": "yes we have an automated in-place",
    "start": "173360",
    "end": "175599"
  },
  {
    "text": "upgrade available to you",
    "start": "175599",
    "end": "177040"
  },
  {
    "text": "so we call it using modify db instance",
    "start": "177040",
    "end": "179840"
  },
  {
    "text": "so you can either use",
    "start": "179840",
    "end": "180959"
  },
  {
    "text": "cli or console with a click of a button",
    "start": "180959",
    "end": "183920"
  },
  {
    "text": "we will",
    "start": "183920",
    "end": "184560"
  },
  {
    "text": "upgrade your database from let's say",
    "start": "184560",
    "end": "186319"
  },
  {
    "text": "version 10 to 12",
    "start": "186319",
    "end": "188239"
  },
  {
    "text": "or going from one version to another",
    "start": "188239",
    "end": "190159"
  },
  {
    "text": "version so behind the scene we use",
    "start": "190159",
    "end": "192319"
  },
  {
    "text": "pg upgrade as a utility and we'll",
    "start": "192319",
    "end": "194640"
  },
  {
    "text": "upgrade your database",
    "start": "194640",
    "end": "196239"
  },
  {
    "text": "so it's all managed for you at the click",
    "start": "196239",
    "end": "198400"
  },
  {
    "text": "of a button or the cli",
    "start": "198400",
    "end": "199840"
  },
  {
    "text": "however it does take time uh it",
    "start": "199840",
    "end": "203040"
  },
  {
    "text": "time to upgrade uh depends on",
    "start": "203040",
    "end": "206959"
  },
  {
    "text": "how many objects it's not depending on",
    "start": "206959",
    "end": "209040"
  },
  {
    "text": "how large is your database it really",
    "start": "209040",
    "end": "210560"
  },
  {
    "text": "depends on how many objects you",
    "start": "210560",
    "end": "212000"
  },
  {
    "text": "have uh typically what happens behind",
    "start": "212000",
    "end": "214480"
  },
  {
    "text": "the scene is we're changing the catalog",
    "start": "214480",
    "end": "216159"
  },
  {
    "text": "so",
    "start": "216159",
    "end": "216799"
  },
  {
    "text": "more objects you have more work to do",
    "start": "216799",
    "end": "219599"
  },
  {
    "text": "and more time it takes to upgrade and",
    "start": "219599",
    "end": "221360"
  },
  {
    "text": "during the upgrade",
    "start": "221360",
    "end": "222720"
  },
  {
    "text": "you're not able to connect to the",
    "start": "222720",
    "end": "224239"
  },
  {
    "text": "database so it's a down time for you",
    "start": "224239",
    "end": "227200"
  },
  {
    "text": "and it could be a few minutes to several",
    "start": "227200",
    "end": "229440"
  },
  {
    "text": "minutes",
    "start": "229440",
    "end": "230640"
  },
  {
    "text": "the second option that you have is the",
    "start": "230640",
    "end": "232640"
  },
  {
    "text": "database migration service where you can",
    "start": "232640",
    "end": "235040"
  },
  {
    "text": "read data from a version 10 and then you",
    "start": "235040",
    "end": "238239"
  },
  {
    "text": "can replicate it to another version of",
    "start": "238239",
    "end": "239760"
  },
  {
    "text": "postgres",
    "start": "239760",
    "end": "240640"
  },
  {
    "text": "so that's the option available to you",
    "start": "240640",
    "end": "242239"
  },
  {
    "text": "which allows you a minimal downtime",
    "start": "242239",
    "end": "244400"
  },
  {
    "text": "upgrade however it does add up more",
    "start": "244400",
    "end": "247280"
  },
  {
    "text": "complexity in terms of adding more",
    "start": "247280",
    "end": "249200"
  },
  {
    "text": "service and the cost associated with it",
    "start": "249200",
    "end": "251840"
  },
  {
    "text": "you can always use pg dump and restore",
    "start": "251840",
    "end": "254239"
  },
  {
    "text": "which are postgres native tool",
    "start": "254239",
    "end": "256160"
  },
  {
    "text": "and as long as you have a capability of",
    "start": "256160",
    "end": "258479"
  },
  {
    "text": "taking a downtime",
    "start": "258479",
    "end": "260239"
  },
  {
    "text": "this is a perfectly good use of pg dump",
    "start": "260239",
    "end": "263040"
  },
  {
    "text": "and restore",
    "start": "263040",
    "end": "263840"
  },
  {
    "text": "for a tiny database however there's",
    "start": "263840",
    "end": "266240"
  },
  {
    "text": "another fourth option as a logical",
    "start": "266240",
    "end": "267759"
  },
  {
    "text": "replication which i'm going to talk",
    "start": "267759",
    "end": "269040"
  },
  {
    "text": "about more",
    "start": "269040",
    "end": "270080"
  },
  {
    "text": "and which allows you to do a minimal",
    "start": "270080",
    "end": "271840"
  },
  {
    "text": "downtime upgrade",
    "start": "271840",
    "end": "274560"
  },
  {
    "text": "so what is logical replication real",
    "start": "274560",
    "end": "276080"
  },
  {
    "text": "quick logical replication is a",
    "start": "276080",
    "end": "278000"
  },
  {
    "text": "method of replicating data object and",
    "start": "278000",
    "end": "280240"
  },
  {
    "text": "there are changes based upon their",
    "start": "280240",
    "end": "281759"
  },
  {
    "text": "replication identity usually primary key",
    "start": "281759",
    "end": "283759"
  },
  {
    "text": "or some sort of a unique key",
    "start": "283759",
    "end": "285759"
  },
  {
    "text": "so what's happening is you write or",
    "start": "285759",
    "end": "287680"
  },
  {
    "text": "things gets committed to your",
    "start": "287680",
    "end": "289680"
  },
  {
    "text": "primary instance let's get written to",
    "start": "289680",
    "end": "291280"
  },
  {
    "text": "your transaction log",
    "start": "291280",
    "end": "292720"
  },
  {
    "text": "and it translate back into a logical",
    "start": "292720",
    "end": "296160"
  },
  {
    "text": "change so anything gets written to a",
    "start": "296160",
    "end": "297919"
  },
  {
    "text": "wall file we translate into logical",
    "start": "297919",
    "end": "300160"
  },
  {
    "text": "change",
    "start": "300160",
    "end": "300880"
  },
  {
    "text": "typically the old and new value and",
    "start": "300880",
    "end": "302800"
  },
  {
    "text": "that's the change we apply",
    "start": "302800",
    "end": "304479"
  },
  {
    "text": "to the subscriber node and because of",
    "start": "304479",
    "end": "307440"
  },
  {
    "text": "that change the way it's happening",
    "start": "307440",
    "end": "309280"
  },
  {
    "text": "we can replicate data between two",
    "start": "309280",
    "end": "311199"
  },
  {
    "text": "postgres major version",
    "start": "311199",
    "end": "314400"
  },
  {
    "text": "inside there is a wall sender process",
    "start": "314400",
    "end": "317280"
  },
  {
    "text": "that starts logical decoding of your",
    "start": "317280",
    "end": "319600"
  },
  {
    "text": "right head log and loads the standard",
    "start": "319600",
    "end": "322080"
  },
  {
    "text": "logical decoding plugin",
    "start": "322080",
    "end": "323680"
  },
  {
    "text": "which is pg output and we do support",
    "start": "323680",
    "end": "325520"
  },
  {
    "text": "other",
    "start": "325520",
    "end": "326880"
  },
  {
    "text": "decoders like pg logical wall to json",
    "start": "326880",
    "end": "329440"
  },
  {
    "text": "and test decoding",
    "start": "329440",
    "end": "331280"
  },
  {
    "text": "so here's a quick diagram your wall file",
    "start": "331280",
    "end": "334000"
  },
  {
    "text": "wall sender is starting a logical",
    "start": "334000",
    "end": "335360"
  },
  {
    "text": "decoding using pg output as one of the",
    "start": "335360",
    "end": "337759"
  },
  {
    "text": "decoding plugin",
    "start": "337759",
    "end": "339120"
  },
  {
    "text": "all your wall changes the old and new",
    "start": "339120",
    "end": "341759"
  },
  {
    "text": "value",
    "start": "341759",
    "end": "342800"
  },
  {
    "text": "logically decoded value will get applied",
    "start": "342800",
    "end": "344960"
  },
  {
    "text": "to your logically",
    "start": "344960",
    "end": "346400"
  },
  {
    "text": "logical replica we call it so on the",
    "start": "346400",
    "end": "348800"
  },
  {
    "text": "left side it could be version 10",
    "start": "348800",
    "end": "350560"
  },
  {
    "text": "on the right side could be version 1213",
    "start": "350560",
    "end": "353520"
  },
  {
    "text": "or any other version",
    "start": "353520",
    "end": "356400"
  },
  {
    "text": "when it comes to logical replication you",
    "start": "356639",
    "end": "358240"
  },
  {
    "text": "have two options you have native logical",
    "start": "358240",
    "end": "359840"
  },
  {
    "text": "replication",
    "start": "359840",
    "end": "360639"
  },
  {
    "text": "and pg logical pg logical is an",
    "start": "360639",
    "end": "363360"
  },
  {
    "text": "extension to postgres",
    "start": "363360",
    "end": "365039"
  },
  {
    "text": "while native is part of the core",
    "start": "365039",
    "end": "368240"
  },
  {
    "text": "so what is the difference really the",
    "start": "368240",
    "end": "370160"
  },
  {
    "text": "difference is the",
    "start": "370160",
    "end": "371440"
  },
  {
    "text": "the functionality right so it's pg",
    "start": "371440",
    "end": "374080"
  },
  {
    "text": "logical has some more enhanced",
    "start": "374080",
    "end": "375680"
  },
  {
    "text": "functionality compared to native logical",
    "start": "375680",
    "end": "377520"
  },
  {
    "text": "replication however for",
    "start": "377520",
    "end": "379440"
  },
  {
    "text": "upgrade it's perfectly fine to use",
    "start": "379440",
    "end": "381440"
  },
  {
    "text": "native logical replication as long as",
    "start": "381440",
    "end": "383199"
  },
  {
    "text": "you're moving from version 10 and about",
    "start": "383199",
    "end": "386560"
  },
  {
    "text": "and we support both and in this video",
    "start": "386560",
    "end": "389680"
  },
  {
    "text": "i'm going to be doing a demo",
    "start": "389680",
    "end": "391280"
  },
  {
    "text": "uh showing you how to use native logical",
    "start": "391280",
    "end": "394319"
  },
  {
    "text": "replication for",
    "start": "394319",
    "end": "395280"
  },
  {
    "text": "upgrade so yeah let's talk about my demo",
    "start": "395280",
    "end": "398400"
  },
  {
    "text": "here the setup is going to be i have",
    "start": "398400",
    "end": "400240"
  },
  {
    "text": "postgres version 10 and 13",
    "start": "400240",
    "end": "402639"
  },
  {
    "text": "created and then the first part is i'll",
    "start": "402639",
    "end": "405919"
  },
  {
    "text": "be loading some of the schema",
    "start": "405919",
    "end": "407440"
  },
  {
    "text": "and data then i'll be dumping the global",
    "start": "407440",
    "end": "410720"
  },
  {
    "text": "objects and the schema from my source",
    "start": "410720",
    "end": "412639"
  },
  {
    "text": "and loading it to",
    "start": "412639",
    "end": "414240"
  },
  {
    "text": "version 13 that's my destination and",
    "start": "414240",
    "end": "416720"
  },
  {
    "text": "then i'll be using a publication and",
    "start": "416720",
    "end": "418400"
  },
  {
    "text": "subscription and i'll talk more about it",
    "start": "418400",
    "end": "420240"
  },
  {
    "text": "during the demo so let's go and uh jump",
    "start": "420240",
    "end": "423280"
  },
  {
    "text": "to the demo here",
    "start": "423280",
    "end": "424400"
  },
  {
    "text": "we went ahead and created two postgres",
    "start": "424400",
    "end": "426720"
  },
  {
    "text": "cluster one on postgres10",
    "start": "426720",
    "end": "428800"
  },
  {
    "text": "and one on postgres13 let's make sure",
    "start": "428800",
    "end": "431199"
  },
  {
    "text": "that his cluster is up and running so",
    "start": "431199",
    "end": "432720"
  },
  {
    "text": "i'm running this little script",
    "start": "432720",
    "end": "434479"
  },
  {
    "text": "which is going to show me the cluster",
    "start": "434479",
    "end": "435840"
  },
  {
    "text": "status",
    "start": "435840",
    "end": "438080"
  },
  {
    "text": "and you can see here that i'm running",
    "start": "438080",
    "end": "440160"
  },
  {
    "text": "cli rds",
    "start": "440160",
    "end": "441680"
  },
  {
    "text": "describe db instance for my identifier",
    "start": "441680",
    "end": "444080"
  },
  {
    "text": "mypg-10 and my pg-13 respectively and i",
    "start": "444080",
    "end": "446880"
  },
  {
    "text": "can see my cluster is up and running",
    "start": "446880",
    "end": "449120"
  },
  {
    "text": "the next thing i will do is i will",
    "start": "449120",
    "end": "450880"
  },
  {
    "text": "create certain roles",
    "start": "450880",
    "end": "452479"
  },
  {
    "text": "i will create a database and i will",
    "start": "452479",
    "end": "453919"
  },
  {
    "text": "create certain roles which is nothing",
    "start": "453919",
    "end": "455759"
  },
  {
    "text": "but a user",
    "start": "455759",
    "end": "456960"
  },
  {
    "text": "in postgres to mimic something which is",
    "start": "456960",
    "end": "458960"
  },
  {
    "text": "similar to in a production instance",
    "start": "458960",
    "end": "461280"
  },
  {
    "text": "so i'm going to go ahead and run this",
    "start": "461280",
    "end": "462960"
  },
  {
    "text": "script",
    "start": "462960",
    "end": "464879"
  },
  {
    "text": "which is creating my database as i said",
    "start": "464879",
    "end": "467120"
  },
  {
    "text": "and i'm creating a couple of roles",
    "start": "467120",
    "end": "468720"
  },
  {
    "text": "and couple of users here so i'm going to",
    "start": "468720",
    "end": "471199"
  },
  {
    "text": "go ahead and run that",
    "start": "471199",
    "end": "472479"
  },
  {
    "text": "and this is i'm running to set up my",
    "start": "472479",
    "end": "475199"
  },
  {
    "text": "source",
    "start": "475199",
    "end": "475680"
  },
  {
    "text": "or my postgres10 so i'm running this on",
    "start": "475680",
    "end": "477840"
  },
  {
    "text": "my postgres 10 instance",
    "start": "477840",
    "end": "479280"
  },
  {
    "text": "as you can see the server instance is",
    "start": "479280",
    "end": "480879"
  },
  {
    "text": "10.16 and i've created a database and",
    "start": "480879",
    "end": "483360"
  },
  {
    "text": "few roles to mimic what you have",
    "start": "483360",
    "end": "485199"
  },
  {
    "text": "probably in your production the next",
    "start": "485199",
    "end": "487360"
  },
  {
    "text": "thing i'm doing is",
    "start": "487360",
    "end": "488479"
  },
  {
    "text": "i have to load some data so for that i",
    "start": "488479",
    "end": "490960"
  },
  {
    "text": "will create some tables and load data",
    "start": "490960",
    "end": "493280"
  },
  {
    "text": "and for that i'm using a pg bench script",
    "start": "493280",
    "end": "496800"
  },
  {
    "text": "which is going to be initializing it pg",
    "start": "496800",
    "end": "499680"
  },
  {
    "text": "bench is a generic postgres benchmarking",
    "start": "499680",
    "end": "501680"
  },
  {
    "text": "tool which is going to create a few",
    "start": "501680",
    "end": "503039"
  },
  {
    "text": "tables and insert",
    "start": "503039",
    "end": "504319"
  },
  {
    "text": "some records in it so in this case i'm",
    "start": "504319",
    "end": "506479"
  },
  {
    "text": "creating a pg dump and",
    "start": "506479",
    "end": "507680"
  },
  {
    "text": "inserting about a million record so now",
    "start": "507680",
    "end": "509919"
  },
  {
    "text": "i have a table",
    "start": "509919",
    "end": "511199"
  },
  {
    "text": "four tables and the accounts table will",
    "start": "511199",
    "end": "514000"
  },
  {
    "text": "have about",
    "start": "514000",
    "end": "514560"
  },
  {
    "text": "million records and that's the data that",
    "start": "514560",
    "end": "517440"
  },
  {
    "text": "i'm going to be using",
    "start": "517440",
    "end": "518560"
  },
  {
    "text": "to replicate now at this point",
    "start": "518560",
    "end": "521599"
  },
  {
    "text": "my source database postgres10 has",
    "start": "521599",
    "end": "524640"
  },
  {
    "text": "roles has a database it has a database",
    "start": "524640",
    "end": "527040"
  },
  {
    "text": "object and it has a data in it",
    "start": "527040",
    "end": "529360"
  },
  {
    "text": "now the next step for the upgrade is to",
    "start": "529360",
    "end": "532080"
  },
  {
    "text": "take the schema dump from postgres10",
    "start": "532080",
    "end": "534320"
  },
  {
    "text": "and load it to postgres13 so the next",
    "start": "534320",
    "end": "536720"
  },
  {
    "text": "step is",
    "start": "536720",
    "end": "537920"
  },
  {
    "text": "to dump schema from postgres10",
    "start": "537920",
    "end": "541839"
  },
  {
    "text": "so i'm going to be running this script",
    "start": "541839",
    "end": "545200"
  },
  {
    "text": "so notice here the first thing i'm doing",
    "start": "545200",
    "end": "546800"
  },
  {
    "text": "here is i'm doing pg dump all",
    "start": "546800",
    "end": "548880"
  },
  {
    "text": "with the dash g that's g is a global",
    "start": "548880",
    "end": "552640"
  },
  {
    "text": "object or global only object",
    "start": "552640",
    "end": "556000"
  },
  {
    "text": "and what this is going to do is it's",
    "start": "556000",
    "end": "558080"
  },
  {
    "text": "going to",
    "start": "558080",
    "end": "559040"
  },
  {
    "text": "dump all your global object meaning all",
    "start": "559040",
    "end": "561440"
  },
  {
    "text": "your roles and users and privileges",
    "start": "561440",
    "end": "563600"
  },
  {
    "text": "which are",
    "start": "563600",
    "end": "565120"
  },
  {
    "text": "global for all your databases so in",
    "start": "565120",
    "end": "567120"
  },
  {
    "text": "postgres you can have any number of",
    "start": "567120",
    "end": "568399"
  },
  {
    "text": "database",
    "start": "568399",
    "end": "569200"
  },
  {
    "text": "but all your roles and users they are",
    "start": "569200",
    "end": "571440"
  },
  {
    "text": "common across",
    "start": "571440",
    "end": "572240"
  },
  {
    "text": "all of your databases so i'm dumping all",
    "start": "572240",
    "end": "574560"
  },
  {
    "text": "my global object first",
    "start": "574560",
    "end": "576240"
  },
  {
    "text": "another option is the no role password",
    "start": "576240",
    "end": "579120"
  },
  {
    "text": "that's something you need to pass",
    "start": "579120",
    "end": "580320"
  },
  {
    "text": "because in rds",
    "start": "580320",
    "end": "582399"
  },
  {
    "text": "we cannot see a password",
    "start": "582399",
    "end": "586240"
  },
  {
    "text": "so if you try to dump pg dump all",
    "start": "586240",
    "end": "588080"
  },
  {
    "text": "without this option you might get some",
    "start": "588080",
    "end": "589519"
  },
  {
    "text": "error messages so",
    "start": "589519",
    "end": "590959"
  },
  {
    "text": "this will avoid dumping any password so",
    "start": "590959",
    "end": "594000"
  },
  {
    "text": "this is how we're going to get",
    "start": "594000",
    "end": "594800"
  },
  {
    "text": "global.sql",
    "start": "594800",
    "end": "596560"
  },
  {
    "text": "and then the next thing i'm doing is i'm",
    "start": "596560",
    "end": "598320"
  },
  {
    "text": "doing my schema done for my database my",
    "start": "598320",
    "end": "600399"
  },
  {
    "text": "database name is my",
    "start": "600399",
    "end": "601920"
  },
  {
    "text": "database and for that database i'm doing",
    "start": "601920",
    "end": "604800"
  },
  {
    "text": "the schema only dump which is just the",
    "start": "604800",
    "end": "606560"
  },
  {
    "text": "data definition language",
    "start": "606560",
    "end": "608880"
  },
  {
    "text": "and what i'm doing it is i'm dividing",
    "start": "608880",
    "end": "611279"
  },
  {
    "text": "into two different parts i'm",
    "start": "611279",
    "end": "612959"
  },
  {
    "text": "doing a pre-data and the post data this",
    "start": "612959",
    "end": "615040"
  },
  {
    "text": "is an option available for pg dumb",
    "start": "615040",
    "end": "617760"
  },
  {
    "text": "pre is going to give you a schema with",
    "start": "617760",
    "end": "619920"
  },
  {
    "text": "just the table definition no index no",
    "start": "619920",
    "end": "621920"
  },
  {
    "text": "referential integrity",
    "start": "621920",
    "end": "623279"
  },
  {
    "text": "and the post will have everything",
    "start": "623279",
    "end": "625680"
  },
  {
    "text": "related to your index and referential",
    "start": "625680",
    "end": "627519"
  },
  {
    "text": "integrity",
    "start": "627519",
    "end": "628399"
  },
  {
    "text": "so when you load these files into your",
    "start": "628399",
    "end": "631360"
  },
  {
    "text": "postgres 13",
    "start": "631360",
    "end": "632959"
  },
  {
    "text": "you want to do the global first and then",
    "start": "632959",
    "end": "636160"
  },
  {
    "text": "the pre-schema first",
    "start": "636160",
    "end": "637839"
  },
  {
    "text": "and then once your initial copy is done",
    "start": "637839",
    "end": "640640"
  },
  {
    "text": "then we'll run the post schema",
    "start": "640640",
    "end": "642240"
  },
  {
    "text": "and the reason behind it is when you do",
    "start": "642240",
    "end": "644399"
  },
  {
    "text": "initial copy which is large chunk of",
    "start": "644399",
    "end": "646160"
  },
  {
    "text": "data",
    "start": "646160",
    "end": "646800"
  },
  {
    "text": "you don't want to do it on your index",
    "start": "646800",
    "end": "648800"
  },
  {
    "text": "table or the table with all the",
    "start": "648800",
    "end": "650240"
  },
  {
    "text": "referential integrity",
    "start": "650240",
    "end": "652240"
  },
  {
    "text": "so now that i have dumped the data from",
    "start": "652240",
    "end": "653920"
  },
  {
    "text": "post or dumped the schema from",
    "start": "653920",
    "end": "655680"
  },
  {
    "text": "postgres10",
    "start": "655680",
    "end": "656880"
  },
  {
    "text": "i'll be loading it on my postgres13 so",
    "start": "656880",
    "end": "659839"
  },
  {
    "text": "let's go ahead and do that",
    "start": "659839",
    "end": "662399"
  },
  {
    "text": "so i'm just loading schema so first part",
    "start": "662399",
    "end": "665040"
  },
  {
    "text": "will be",
    "start": "665040",
    "end": "665920"
  },
  {
    "text": "loading the global object followed by",
    "start": "665920",
    "end": "668000"
  },
  {
    "text": "pre-schema",
    "start": "668000",
    "end": "670160"
  },
  {
    "text": "so you might see some error that's",
    "start": "670160",
    "end": "671920"
  },
  {
    "text": "something you can safely ignore",
    "start": "671920",
    "end": "674079"
  },
  {
    "text": "because you are trying to alter some of",
    "start": "674079",
    "end": "677040"
  },
  {
    "text": "the rds admin which is not",
    "start": "677040",
    "end": "678560"
  },
  {
    "text": "allowed but that's safe to ignore but",
    "start": "678560",
    "end": "680640"
  },
  {
    "text": "you can see that when i",
    "start": "680640",
    "end": "681920"
  },
  {
    "text": "apply the schema changes i can see how",
    "start": "681920",
    "end": "683920"
  },
  {
    "text": "my pg bench account branches and history",
    "start": "683920",
    "end": "686480"
  },
  {
    "text": "table has been replicated",
    "start": "686480",
    "end": "688000"
  },
  {
    "text": "sorry it's been copied so now my",
    "start": "688000",
    "end": "690399"
  },
  {
    "text": "postgres 13 has the exact same schema as",
    "start": "690399",
    "end": "693040"
  },
  {
    "text": "my postgres 10",
    "start": "693040",
    "end": "694720"
  },
  {
    "text": "but no data let's verify",
    "start": "694720",
    "end": "698000"
  },
  {
    "text": "what i have so i have another script",
    "start": "698000",
    "end": "701200"
  },
  {
    "text": "that i can run",
    "start": "701200",
    "end": "702399"
  },
  {
    "text": "which can show you me the count in both",
    "start": "702399",
    "end": "704880"
  },
  {
    "text": "my databases so let's verify that just",
    "start": "704880",
    "end": "707040"
  },
  {
    "text": "real quick",
    "start": "707040",
    "end": "709120"
  },
  {
    "text": "so as you can see in my postgres 10 i",
    "start": "709120",
    "end": "711120"
  },
  {
    "text": "have four tables with million record 10",
    "start": "711120",
    "end": "713839"
  },
  {
    "text": "0 100 respectively for account branches",
    "start": "713839",
    "end": "716560"
  },
  {
    "text": "history and teller",
    "start": "716560",
    "end": "717920"
  },
  {
    "text": "and postgres 13 the data is not there",
    "start": "717920",
    "end": "721519"
  },
  {
    "text": "but i do have a schema",
    "start": "721519",
    "end": "722880"
  },
  {
    "text": "that's what i did location and",
    "start": "722880",
    "end": "724639"
  },
  {
    "text": "subscription so for publication i'll be",
    "start": "724639",
    "end": "727120"
  },
  {
    "text": "publishing all my tables from my",
    "start": "727120",
    "end": "728959"
  },
  {
    "text": "postgres 10",
    "start": "728959",
    "end": "730240"
  },
  {
    "text": "and then i'm subscribing on my postgres",
    "start": "730240",
    "end": "732480"
  },
  {
    "text": "13.",
    "start": "732480",
    "end": "733279"
  },
  {
    "text": "so let's go ahead and create first the",
    "start": "733279",
    "end": "734959"
  },
  {
    "text": "publication",
    "start": "734959",
    "end": "736560"
  },
  {
    "text": "on my source that is postgres10 and as",
    "start": "736560",
    "end": "739040"
  },
  {
    "text": "you can see i ran a simple",
    "start": "739040",
    "end": "740399"
  },
  {
    "text": "command create subscription create",
    "start": "740399",
    "end": "742399"
  },
  {
    "text": "publication called mice pub",
    "start": "742399",
    "end": "744399"
  },
  {
    "text": "for all tables again you do have option",
    "start": "744399",
    "end": "747279"
  },
  {
    "text": "if you want to selectively replicate",
    "start": "747279",
    "end": "748880"
  },
  {
    "text": "only certain tables you can",
    "start": "748880",
    "end": "750399"
  },
  {
    "text": "certainly create publication and then",
    "start": "750399",
    "end": "752240"
  },
  {
    "text": "you can provide a set of tables",
    "start": "752240",
    "end": "754720"
  },
  {
    "text": "once the publication is created we're",
    "start": "754720",
    "end": "756720"
  },
  {
    "text": "going to go and create subscription",
    "start": "756720",
    "end": "758560"
  },
  {
    "text": "on your subscribing site which is your",
    "start": "758560",
    "end": "760959"
  },
  {
    "text": "postgres13",
    "start": "760959",
    "end": "762079"
  },
  {
    "text": "so this is my postgres13 let's make sure",
    "start": "762079",
    "end": "766190"
  },
  {
    "text": "[Music]",
    "start": "766190",
    "end": "769279"
  },
  {
    "text": "and that's my process 13. and this is",
    "start": "769279",
    "end": "771600"
  },
  {
    "text": "the node where i'll be running",
    "start": "771600",
    "end": "772800"
  },
  {
    "text": "subscription so while the subscription",
    "start": "772800",
    "end": "774240"
  },
  {
    "text": "is running",
    "start": "774240",
    "end": "774800"
  },
  {
    "text": "which i'm going to run this script here",
    "start": "774800",
    "end": "777200"
  },
  {
    "text": "which is showing me",
    "start": "777200",
    "end": "778480"
  },
  {
    "text": "the output of pg replication slot that's",
    "start": "778480",
    "end": "781600"
  },
  {
    "text": "the view",
    "start": "781600",
    "end": "782320"
  },
  {
    "text": "in the database which shows you if there",
    "start": "782320",
    "end": "784160"
  },
  {
    "text": "is any slot and there are none",
    "start": "784160",
    "end": "785680"
  },
  {
    "text": "because there is no subscription at this",
    "start": "785680",
    "end": "787200"
  },
  {
    "text": "point and it shows you the status of",
    "start": "787200",
    "end": "789040"
  },
  {
    "text": "your application through another view",
    "start": "789040",
    "end": "790399"
  },
  {
    "text": "called pg stat replication",
    "start": "790399",
    "end": "792240"
  },
  {
    "text": "both are showing no data now i'm going",
    "start": "792240",
    "end": "795680"
  },
  {
    "text": "to create a subscription",
    "start": "795680",
    "end": "797200"
  },
  {
    "text": "as soon as i create a subscription you",
    "start": "797200",
    "end": "799360"
  },
  {
    "text": "will see that",
    "start": "799360",
    "end": "800240"
  },
  {
    "text": "the slot gets created and the",
    "start": "800240",
    "end": "802639"
  },
  {
    "text": "replication will start to proceed",
    "start": "802639",
    "end": "804480"
  },
  {
    "text": "which is the initial copy of your data",
    "start": "804480",
    "end": "806800"
  },
  {
    "text": "from pros 10 to 13.",
    "start": "806800",
    "end": "809519"
  },
  {
    "text": "there you go i created a subscription",
    "start": "809519",
    "end": "811519"
  },
  {
    "text": "and it gave a name to a subscription and",
    "start": "811519",
    "end": "813120"
  },
  {
    "text": "you pass an argument about your",
    "start": "813120",
    "end": "814639"
  },
  {
    "text": "connection string",
    "start": "814639",
    "end": "815839"
  },
  {
    "text": "and the part of the subscription",
    "start": "815839",
    "end": "817120"
  },
  {
    "text": "creation is it creates the slot",
    "start": "817120",
    "end": "819199"
  },
  {
    "text": "right here you can see a slot getting",
    "start": "819199",
    "end": "820720"
  },
  {
    "text": "created and you see the initial sync is",
    "start": "820720",
    "end": "822959"
  },
  {
    "text": "happening",
    "start": "822959",
    "end": "824240"
  },
  {
    "text": "and at some point the initial sync is",
    "start": "824240",
    "end": "826320"
  },
  {
    "text": "done you see that initial sync was",
    "start": "826320",
    "end": "828160"
  },
  {
    "text": "running",
    "start": "828160",
    "end": "828639"
  },
  {
    "text": "and at this point the initial sync is",
    "start": "828639",
    "end": "830399"
  },
  {
    "text": "done and now the regular cdc is",
    "start": "830399",
    "end": "832880"
  },
  {
    "text": "proceeding at this point",
    "start": "832880",
    "end": "834480"
  },
  {
    "text": "now let's go and verify that the data",
    "start": "834480",
    "end": "836240"
  },
  {
    "text": "got copied to my",
    "start": "836240",
    "end": "837920"
  },
  {
    "text": "my postgres 10 or not right so i'm going",
    "start": "837920",
    "end": "840480"
  },
  {
    "text": "to run this script again",
    "start": "840480",
    "end": "842320"
  },
  {
    "text": "which shows me the count in both the",
    "start": "842320",
    "end": "845120"
  },
  {
    "text": "databases and yes i do",
    "start": "845120",
    "end": "846959"
  },
  {
    "text": "all my million records in pg bench",
    "start": "846959",
    "end": "849120"
  },
  {
    "text": "account got copied and the rest of the",
    "start": "849120",
    "end": "850639"
  },
  {
    "text": "table as well",
    "start": "850639",
    "end": "851680"
  },
  {
    "text": "so that's exactly what i want and now if",
    "start": "851680",
    "end": "854000"
  },
  {
    "text": "i go to my postgres 10 and if i want to",
    "start": "854000",
    "end": "856399"
  },
  {
    "text": "verify one more time",
    "start": "856399",
    "end": "857920"
  },
  {
    "text": "i can certainly do that and have my data",
    "start": "857920",
    "end": "860639"
  },
  {
    "text": "replicating",
    "start": "860639",
    "end": "862160"
  },
  {
    "text": "the next thing i want to show you is",
    "start": "862160",
    "end": "863920"
  },
  {
    "text": "that how the cdc works",
    "start": "863920",
    "end": "865760"
  },
  {
    "text": "uh in order to do that i am",
    "start": "865760",
    "end": "868880"
  },
  {
    "text": "going to run another script which is",
    "start": "868880",
    "end": "871199"
  },
  {
    "text": "going to do some more",
    "start": "871199",
    "end": "872480"
  },
  {
    "text": "update and delete in my database again",
    "start": "872480",
    "end": "875680"
  },
  {
    "text": "i'm using pg bench",
    "start": "875680",
    "end": "877680"
  },
  {
    "text": "and pg bench is going to load",
    "start": "877680",
    "end": "880720"
  },
  {
    "text": "some more data so let's go and verify",
    "start": "880720",
    "end": "884160"
  },
  {
    "text": "that but before we do that",
    "start": "884160",
    "end": "885519"
  },
  {
    "text": "we need to make sure that we apply that",
    "start": "885519",
    "end": "888480"
  },
  {
    "text": "post schema we were talking about",
    "start": "888480",
    "end": "890240"
  },
  {
    "text": "so after the initial work initial scheme",
    "start": "890240",
    "end": "893440"
  },
  {
    "text": "initial copy is done we want to create",
    "start": "893440",
    "end": "895040"
  },
  {
    "text": "all the primary key and indexes on those",
    "start": "895040",
    "end": "896800"
  },
  {
    "text": "so it's very important that you",
    "start": "896800",
    "end": "898720"
  },
  {
    "text": "run that step which is going to create",
    "start": "898720",
    "end": "901360"
  },
  {
    "text": "the post schema so i'm going to run that",
    "start": "901360",
    "end": "902959"
  },
  {
    "text": "as well",
    "start": "902959",
    "end": "904399"
  },
  {
    "text": "so this is going to connect to my",
    "start": "904399",
    "end": "905680"
  },
  {
    "text": "postgres13 and create",
    "start": "905680",
    "end": "908079"
  },
  {
    "text": "all the remaining indexes on those",
    "start": "908079",
    "end": "909920"
  },
  {
    "text": "tables so as you can see it's altering",
    "start": "909920",
    "end": "912800"
  },
  {
    "text": "my accounts branches and teller and it's",
    "start": "912800",
    "end": "914959"
  },
  {
    "text": "creating a primary key if you have any",
    "start": "914959",
    "end": "916480"
  },
  {
    "text": "referential integrity",
    "start": "916480",
    "end": "917760"
  },
  {
    "text": "it will create this step so this is part",
    "start": "917760",
    "end": "920240"
  },
  {
    "text": "of my",
    "start": "920240",
    "end": "921279"
  },
  {
    "text": "initial schema dump which was the post",
    "start": "921279",
    "end": "923440"
  },
  {
    "text": "schema",
    "start": "923440",
    "end": "924839"
  },
  {
    "text": "sql now that's done i'm going to go",
    "start": "924839",
    "end": "927440"
  },
  {
    "text": "ahead",
    "start": "927440",
    "end": "927839"
  },
  {
    "text": "and load some more bg bench workload",
    "start": "927839",
    "end": "930800"
  },
  {
    "text": "here",
    "start": "930800",
    "end": "931759"
  },
  {
    "text": "uh so this is just doing some pg bench",
    "start": "931759",
    "end": "934480"
  },
  {
    "text": "benchmarking which is updating a record",
    "start": "934480",
    "end": "936240"
  },
  {
    "text": "and one of the thing it does it updates",
    "start": "936240",
    "end": "938079"
  },
  {
    "text": "or",
    "start": "938079",
    "end": "938320"
  },
  {
    "text": "insert record in the history table now",
    "start": "938320",
    "end": "940480"
  },
  {
    "text": "let's go and verify that",
    "start": "940480",
    "end": "942720"
  },
  {
    "text": "that my data got replicated",
    "start": "942720",
    "end": "946319"
  },
  {
    "text": "[Music]",
    "start": "946360",
    "end": "949680"
  },
  {
    "text": "and you can see here that my data is",
    "start": "949680",
    "end": "952399"
  },
  {
    "text": "replicated now the history table did not",
    "start": "952399",
    "end": "954240"
  },
  {
    "text": "add any record",
    "start": "954240",
    "end": "955199"
  },
  {
    "text": "now the 5000 records got replicated",
    "start": "955199",
    "end": "957600"
  },
  {
    "text": "perfect",
    "start": "957600",
    "end": "958800"
  },
  {
    "text": "however there's one key thing that you",
    "start": "958800",
    "end": "961360"
  },
  {
    "text": "need to be aware of",
    "start": "961360",
    "end": "962880"
  },
  {
    "text": "in the history table i do not have any",
    "start": "962880",
    "end": "966320"
  },
  {
    "text": "primary key",
    "start": "966320",
    "end": "967120"
  },
  {
    "text": "so if i describe my history table there",
    "start": "967120",
    "end": "969839"
  },
  {
    "text": "it does not have any primary key that's",
    "start": "969839",
    "end": "971759"
  },
  {
    "text": "the default",
    "start": "971759",
    "end": "973199"
  },
  {
    "text": "and when that's the case you can",
    "start": "973199",
    "end": "975680"
  },
  {
    "text": "replicate the inserts",
    "start": "975680",
    "end": "977440"
  },
  {
    "text": "but you cannot replicate any update or",
    "start": "977440",
    "end": "979600"
  },
  {
    "text": "delete so that's an",
    "start": "979600",
    "end": "980839"
  },
  {
    "text": "important consideration you have to make",
    "start": "980839",
    "end": "983360"
  },
  {
    "text": "when you",
    "start": "983360",
    "end": "984000"
  },
  {
    "text": "are replicating logically so let's go",
    "start": "984000",
    "end": "986399"
  },
  {
    "text": "and try and do this",
    "start": "986399",
    "end": "987920"
  },
  {
    "text": "i'm going to connect to my postgres 10",
    "start": "987920",
    "end": "989839"
  },
  {
    "text": "and i'm going to try and",
    "start": "989839",
    "end": "991040"
  },
  {
    "text": "update my history table",
    "start": "991040",
    "end": "994639"
  },
  {
    "text": "and set one of the column called m time",
    "start": "994639",
    "end": "997440"
  },
  {
    "text": "for example",
    "start": "997440",
    "end": "998560"
  },
  {
    "text": "it's a date of time stamp field so i'm",
    "start": "998560",
    "end": "1001120"
  },
  {
    "text": "just going to say",
    "start": "1001120",
    "end": "1002000"
  },
  {
    "text": "set it to now for all all",
    "start": "1002000",
    "end": "1005519"
  },
  {
    "text": "all rows and i get the error message",
    "start": "1005519",
    "end": "1008000"
  },
  {
    "text": "saying you cannot update because",
    "start": "1008000",
    "end": "1010000"
  },
  {
    "text": "it is part of the replication logical",
    "start": "1010000",
    "end": "1012000"
  },
  {
    "text": "application it does not have replica",
    "start": "1012000",
    "end": "1013759"
  },
  {
    "text": "identity",
    "start": "1013759",
    "end": "1014880"
  },
  {
    "text": "so in order for this table to get",
    "start": "1014880",
    "end": "1016959"
  },
  {
    "text": "replicated for",
    "start": "1016959",
    "end": "1018079"
  },
  {
    "text": "update and delete you have to make sure",
    "start": "1018079",
    "end": "1020560"
  },
  {
    "text": "that you set your",
    "start": "1020560",
    "end": "1021920"
  },
  {
    "text": "replication identity to full so this is",
    "start": "1021920",
    "end": "1024240"
  },
  {
    "text": "one important step you need to do",
    "start": "1024240",
    "end": "1026640"
  },
  {
    "text": "before you set your logical replication",
    "start": "1026640",
    "end": "1029600"
  },
  {
    "text": "ensure that",
    "start": "1029600",
    "end": "1030319"
  },
  {
    "text": "all the tables have the primary key so",
    "start": "1030319",
    "end": "1033199"
  },
  {
    "text": "now i'm going to alter this table",
    "start": "1033199",
    "end": "1035038"
  },
  {
    "text": "and i'm going to set replica identity to",
    "start": "1035039",
    "end": "1036839"
  },
  {
    "text": "fall i'll put some link",
    "start": "1036839",
    "end": "1039520"
  },
  {
    "text": "in the slides here that will show you",
    "start": "1039520",
    "end": "1041918"
  },
  {
    "text": "the",
    "start": "1041919",
    "end": "1042880"
  },
  {
    "text": "description around what is replica",
    "start": "1042880",
    "end": "1044480"
  },
  {
    "text": "identity full mean",
    "start": "1044480",
    "end": "1047199"
  },
  {
    "text": "once the replicator default is done at",
    "start": "1047199",
    "end": "1049840"
  },
  {
    "text": "this point",
    "start": "1049840",
    "end": "1051440"
  },
  {
    "text": "postgres is going to capture all the",
    "start": "1051440",
    "end": "1053440"
  },
  {
    "text": "changes for all the columns in this",
    "start": "1053440",
    "end": "1055280"
  },
  {
    "text": "table",
    "start": "1055280",
    "end": "1056240"
  },
  {
    "text": "and now if i do an update you can see",
    "start": "1056240",
    "end": "1058400"
  },
  {
    "text": "that i don't get any error message",
    "start": "1058400",
    "end": "1060000"
  },
  {
    "text": "and i'm able to replicate all the data",
    "start": "1060000",
    "end": "1062240"
  },
  {
    "text": "let's verify the data got replicated",
    "start": "1062240",
    "end": "1064480"
  },
  {
    "text": "so if i do",
    "start": "1064480",
    "end": "1066850"
  },
  {
    "text": "[Music]",
    "start": "1066850",
    "end": "1068720"
  },
  {
    "text": "record for this and if i run the same",
    "start": "1068720",
    "end": "1072799"
  },
  {
    "text": "query on my postgres 13",
    "start": "1072799",
    "end": "1074960"
  },
  {
    "text": "i would see the same timestamp which got",
    "start": "1074960",
    "end": "1077679"
  },
  {
    "text": "replicated",
    "start": "1077679",
    "end": "1079440"
  },
  {
    "text": "so with this demo you can see that some",
    "start": "1079440",
    "end": "1081840"
  },
  {
    "text": "of the best practices",
    "start": "1081840",
    "end": "1083200"
  },
  {
    "text": "to upgrade your postgres 10",
    "start": "1083200",
    "end": "1086480"
  },
  {
    "text": "to postgres 13 with the minimal down",
    "start": "1086480",
    "end": "1088320"
  },
  {
    "text": "time with the logical replication",
    "start": "1088320",
    "end": "1090320"
  },
  {
    "text": "now that both the data are in sync at",
    "start": "1090320",
    "end": "1093520"
  },
  {
    "text": "any given time",
    "start": "1093520",
    "end": "1094640"
  },
  {
    "text": "you can shut your application which is",
    "start": "1094640",
    "end": "1096720"
  },
  {
    "text": "connecting to postgres 10",
    "start": "1096720",
    "end": "1098400"
  },
  {
    "text": "and move your application to postgres13",
    "start": "1098400",
    "end": "1100960"
  },
  {
    "text": "and you can",
    "start": "1100960",
    "end": "1102720"
  },
  {
    "text": "upgrade your database to postgres13",
    "start": "1102720",
    "end": "1104960"
  },
  {
    "text": "essentially with a minimal downtime",
    "start": "1104960",
    "end": "1108480"
  },
  {
    "text": "one of the most important step of your",
    "start": "1108480",
    "end": "1110320"
  },
  {
    "text": "upgrade process is to promote",
    "start": "1110320",
    "end": "1112400"
  },
  {
    "text": "or make your postgres 13 as a standalone",
    "start": "1112400",
    "end": "1114880"
  },
  {
    "text": "node",
    "start": "1114880",
    "end": "1115840"
  },
  {
    "text": "remember at this point you're still",
    "start": "1115840",
    "end": "1117360"
  },
  {
    "text": "replicating from postgres 10 to 13",
    "start": "1117360",
    "end": "1119840"
  },
  {
    "text": "and that is done using a replication",
    "start": "1119840",
    "end": "1122559"
  },
  {
    "text": "slot",
    "start": "1122559",
    "end": "1123280"
  },
  {
    "text": "so as you can see here my replication",
    "start": "1123280",
    "end": "1124960"
  },
  {
    "text": "stop is still active that is replicating",
    "start": "1124960",
    "end": "1127039"
  },
  {
    "text": "from 10 to 13.",
    "start": "1127039",
    "end": "1128880"
  },
  {
    "text": "so what you want to do is you want to",
    "start": "1128880",
    "end": "1130320"
  },
  {
    "text": "remove this replication slot",
    "start": "1130320",
    "end": "1132240"
  },
  {
    "text": "and one of the easiest way you can do",
    "start": "1132240",
    "end": "1133760"
  },
  {
    "text": "that is just simply by dropping a",
    "start": "1133760",
    "end": "1136080"
  },
  {
    "text": "subscription that we created earlier",
    "start": "1136080",
    "end": "1138720"
  },
  {
    "text": "upon deleting or dropping the",
    "start": "1138720",
    "end": "1140960"
  },
  {
    "text": "subscription",
    "start": "1140960",
    "end": "1141919"
  },
  {
    "text": "we're essentially dropping a slot from",
    "start": "1141919",
    "end": "1144640"
  },
  {
    "text": "which is",
    "start": "1144640",
    "end": "1145520"
  },
  {
    "text": "created on postgres10 and will enable",
    "start": "1145520",
    "end": "1148240"
  },
  {
    "text": "your",
    "start": "1148240",
    "end": "1148960"
  },
  {
    "text": "postgres 13 to become a standalone node",
    "start": "1148960",
    "end": "1151919"
  },
  {
    "text": "so at this point as you can see here",
    "start": "1151919",
    "end": "1154000"
  },
  {
    "text": "my replication slot is dropped at this",
    "start": "1154000",
    "end": "1157120"
  },
  {
    "text": "point you can decommission your postgres",
    "start": "1157120",
    "end": "1159120"
  },
  {
    "text": "10 and start using your postgres 13.",
    "start": "1159120",
    "end": "1162960"
  },
  {
    "text": "well that concludes my talk i've",
    "start": "1162960",
    "end": "1164720"
  },
  {
    "text": "demonstrated use of logical replication",
    "start": "1164720",
    "end": "1167039"
  },
  {
    "text": "for a major version upgrade with a",
    "start": "1167039",
    "end": "1168799"
  },
  {
    "text": "minimal downtime",
    "start": "1168799",
    "end": "1170960"
  },
  {
    "text": "one last thing i would like to mention",
    "start": "1170960",
    "end": "1172400"
  },
  {
    "text": "that if you're on version 9.6 for",
    "start": "1172400",
    "end": "1174400"
  },
  {
    "text": "example",
    "start": "1174400",
    "end": "1174960"
  },
  {
    "text": "and if you like to use logical",
    "start": "1174960",
    "end": "1176640"
  },
  {
    "text": "application pg logical is another option",
    "start": "1176640",
    "end": "1179440"
  },
  {
    "text": "for you",
    "start": "1179440",
    "end": "1180320"
  },
  {
    "text": "and you can use pg logical just as i've",
    "start": "1180320",
    "end": "1182799"
  },
  {
    "text": "used shown with the native logical",
    "start": "1182799",
    "end": "1184720"
  },
  {
    "text": "application to upgrade",
    "start": "1184720",
    "end": "1186320"
  },
  {
    "text": "from 9.6 to let's say version 10 and",
    "start": "1186320",
    "end": "1188720"
  },
  {
    "text": "above",
    "start": "1188720",
    "end": "1190080"
  },
  {
    "text": "thank you again for watching and have a",
    "start": "1190080",
    "end": "1192480"
  },
  {
    "text": "great day",
    "start": "1192480",
    "end": "1200400"
  }
]