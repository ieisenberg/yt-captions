[
  {
    "text": "hey I'm Robert I'm one of the co-founders and CEO of any scale and I'm Goku and I work on machine learning here",
    "start": "3760",
    "end": "9200"
  },
  {
    "text": "at any scale we're going to talk about solving some of the core infrastructure challenges for building llm and",
    "start": "9200",
    "end": "15360"
  },
  {
    "text": "generative AI applications a lot of the stuff that we're going to show you today is based on Ray Ray is an open source",
    "start": "15360",
    "end": "21359"
  },
  {
    "text": "project started out of UC Berkeley it's been used by uh companies like open AI",
    "start": "21359",
    "end": "27279"
  },
  {
    "text": "to to train gp4 it's being used by companies like uber and Pinterest to run all their deep learning so this is",
    "start": "27279",
    "end": "33719"
  },
  {
    "text": "really starting to be the heart of um scaling AI workloads at a lot of tech companies and really that is spanning",
    "start": "33719",
    "end": "41280"
  },
  {
    "text": "the Spectrum from getting started on your laptop writing your python script all the way through the most cuttingedge",
    "start": "41280",
    "end": "47079"
  },
  {
    "text": "Foundation model uh use cases out there yeah I've heard about Ray actually since uh 2019 which is I guess half a decade",
    "start": "47079",
    "end": "53520"
  },
  {
    "text": "ago now and it's amazing to see U kind of the adoption behind it Go could you want to talk a little bit about some of",
    "start": "53520",
    "end": "59480"
  },
  {
    "text": "the challeng Alles around actually that teams face when doing Ai and trying to build AI",
    "start": "59480",
    "end": "65640"
  },
  {
    "text": "applications and get them in production yeah I mean regardless of what kind of machine learning application you're",
    "start": "65640",
    "end": "70680"
  },
  {
    "text": "trying to build whether it's more traditional deep learning uh or you know LMS or gen two of the most important",
    "start": "70680",
    "end": "76680"
  },
  {
    "text": "factors here are Velocity uh how quickly can my team move um and actually doing",
    "start": "76680",
    "end": "82640"
  },
  {
    "text": "things at scale yeah and and for and how quickly your team can move is also related to how quickly the individual",
    "start": "82640",
    "end": "89079"
  },
  {
    "text": "developers can move right and we've seen a lot of um obstacles to moving quickly",
    "start": "89079",
    "end": "94960"
  },
  {
    "text": "as an AI uh engineer because you are you know you're hired to do Ai and to build",
    "start": "94960",
    "end": "100759"
  },
  {
    "text": "AI applications but a lot of these people find themselves having to manage clusters right having to scale workloads",
    "start": "100759",
    "end": "108520"
  },
  {
    "text": "having to think about gpus and other Hardware accelerators right and these are um think about how to move from",
    "start": "108520",
    "end": "114520"
  },
  {
    "text": "development to production it's it's there can be a lot of challenges exactly yeah you're not just on your local",
    "start": "114520",
    "end": "119960"
  },
  {
    "text": "laptop anymore uh in fact these models just won't fit so um thinking about kind of scale is something that developers",
    "start": "119960",
    "end": "127200"
  },
  {
    "text": "think about from day one uh even even in the development uh stage yeah I mean scale is just a fact of life and and if",
    "start": "127200",
    "end": "132840"
  },
  {
    "text": "you're only scaling to your point if you're only scaling in production and not scaling dream development then you",
    "start": "132840",
    "end": "139000"
  },
  {
    "text": "have a different development and a different production environment a different codebase different Frameworks and that increases the gap between uh",
    "start": "139000",
    "end": "147760"
  },
  {
    "text": "what's running in development what's running in production it means that it's more likely that things will go wrong",
    "start": "147760",
    "end": "152800"
  },
  {
    "text": "when you transition and that uh there will be a more expensive handoff between those two stages maybe a hand off to",
    "start": "152800",
    "end": "158280"
  },
  {
    "text": "another team a rewrite or something absolutely that's actually where almost all the mistakes and errors happen and",
    "start": "158280",
    "end": "163440"
  },
  {
    "text": "I'm sure you heard the quote uh well it worked in my laptop um yeah that's exactly one of the biggest challenges",
    "start": "163440",
    "end": "168680"
  },
  {
    "text": "yeah let's dive into data processing first so what we have here is kind of an",
    "start": "168680",
    "end": "174879"
  },
  {
    "text": "overall diagram uh this specific task you may recognize is kind of prepping your data for uh kind of filling your",
    "start": "174879",
    "end": "181040"
  },
  {
    "text": "vector database for rag applications but I'm just going to use that as a kind of a skeleton of of data processing",
    "start": "181040",
    "end": "186920"
  },
  {
    "text": "workload and there's a lot of um different reasons you need to prepare your your data this could be preparing",
    "start": "186920",
    "end": "192480"
  },
  {
    "text": "it for pre-training it could be preparing it for fine-tuning it could be even comp preparing it for some kind of",
    "start": "192480",
    "end": "197879"
  },
  {
    "text": "batch inference task right yeah and of course I want to say there's a lot of interesting challenges here in the fact",
    "start": "197879",
    "end": "203680"
  },
  {
    "text": "this diagram in some sense may be oversimplified right there's um you have CPU compute like some of reading and",
    "start": "203680",
    "end": "210400"
  },
  {
    "text": "writing and um and and pre-processing but you also it's often typical to have GPU compute as well doing inference",
    "start": "210400",
    "end": "217560"
  },
  {
    "text": "embeding computations and so on exactly yeah you're going to want to kind of work with all different kinds of uh",
    "start": "217560",
    "end": "222799"
  },
  {
    "text": "Computer Resources um and your data could be anywhere it could be in your local system cloud storage data warehous",
    "start": "222799",
    "end": "229920"
  },
  {
    "text": "um and you want to be able to kind of read and write to all these different sources and actually when you're when you have mixed CPU and GPU compute the",
    "start": "229920",
    "end": "236319"
  },
  {
    "text": "challenges can get even harder for example uh you may want to auto scale the or scale the uh CPU pool of workers",
    "start": "236319",
    "end": "243720"
  },
  {
    "text": "and the GPU pool of workers independently right it may be more CPU or more GPU intensive you may have the a",
    "start": "243720",
    "end": "250040"
  },
  {
    "text": "batch size may be appropriate like different batch sizes may be appropriate on the CPU versus on the GPU and we'll",
    "start": "250040",
    "end": "256680"
  },
  {
    "text": "see all this in action where kind of per workload within the data processing uh cycle here we'll have full control as to",
    "start": "256680",
    "end": "264000"
  },
  {
    "text": "exactly what kind of compute strategy I want to use here and uh and do it in a way where we don't actually we're not actually maintaining the for ourselves",
    "start": "264000",
    "end": "270639"
  },
  {
    "text": "and connecting these different devices together we can just focus on the actual code that we want to um develop and you",
    "start": "270639",
    "end": "276800"
  },
  {
    "text": "mentioned that um you may need to scale dream development can you say a little bit more about that and some of the",
    "start": "276800",
    "end": "282960"
  },
  {
    "text": "challenges of uh scaling dream development and and really creating a good productive development experience",
    "start": "282960",
    "end": "289199"
  },
  {
    "text": "for data processing yeah so obviously if your data lives on a single file uh",
    "start": "289199",
    "end": "294639"
  },
  {
    "text": "you're not really thinking about scale uh you know you can kind of have it on your local laptop and it just works but",
    "start": "294639",
    "end": "299960"
  },
  {
    "text": "now when we're talking about U even during kind of this experimentation development phase we have very large data sets I'm not even going to get to",
    "start": "299960",
    "end": "305880"
  },
  {
    "text": "the models yet but just large data sets let's say living in uh cloud storage uh like an S3 bucket or something I don't",
    "start": "305880",
    "end": "312759"
  },
  {
    "text": "it's impossible to just kind of read from there uh if it doesn't fit in your in your one machine right uh let alone",
    "start": "312759",
    "end": "318199"
  },
  {
    "text": "actually doing the processing and then being able to write that again back to like cloud storage so these are things that actually won't fit in memory and",
    "start": "318199",
    "end": "325120"
  },
  {
    "text": "you really you want the ability to uh be able to select different sizes or different portions of data right you",
    "start": "325120",
    "end": "331319"
  },
  {
    "text": "often want to be able to try running something with 10 data points or a thousand data points or a million and",
    "start": "331319",
    "end": "336600"
  },
  {
    "text": "and be able to go back and forth between them run and run at different scales y yeah the same kind of traditional",
    "start": "336600",
    "end": "342520"
  },
  {
    "text": "principles of doing machine learning uh you know for decades still holds here you still want to kind of try it out on a small uh chunk first but um you",
    "start": "342520",
    "end": "350000"
  },
  {
    "text": "actually want to be able to apply that at scale to your entire data set especially before fine tuning and even though you're doing this at scale the",
    "start": "350000",
    "end": "356639"
  },
  {
    "text": "same usual principles of of software development and uh debugging are",
    "start": "356639",
    "end": "362520"
  },
  {
    "text": "relevant right you may run something at scale on a bunch of on a 100 machines and then find out you were you forgot to",
    "start": "362520",
    "end": "368680"
  },
  {
    "text": "import some python liver you need to install some extra dependency right so you pip install it of course pip install",
    "start": "368680",
    "end": "374479"
  },
  {
    "text": "it you need to get it on all of those machines make sure it's there so it's not um and if you don't have a good setup for doing this you're running",
    "start": "374479",
    "end": "380680"
  },
  {
    "text": "sshing to 100 machines and running pip install in all of them and you're going to run into a lot of challenges right these are the kinds of things that uh",
    "start": "380680",
    "end": "386919"
  },
  {
    "text": "any scale features like workspaces uh really just solve out of the box you just pip andall at once the same",
    "start": "386919",
    "end": "392039"
  },
  {
    "text": "environment is going to be present on all the machines you can do that interactively at different scales yeah",
    "start": "392039",
    "end": "397599"
  },
  {
    "text": "yep and we'll see workspaces in action where uh kind of just focus on our code and environment and uh we just have kind",
    "start": "397599",
    "end": "403720"
  },
  {
    "text": "of this seemingly INF infinite compute underneath uh that will'll leverage it's also important to have a good ide story",
    "start": "403720",
    "end": "410280"
  },
  {
    "text": "right A lot of people like developing in vs code what does that look like in the distributed setting if you're running on",
    "start": "410280",
    "end": "416000"
  },
  {
    "text": "on a cluster right you want to be able to integrate that vment environment with your IDE so you have the same familiar",
    "start": "416000",
    "end": "422960"
  },
  {
    "text": "development environment you know you can set break points you can step through the code even if it happens to be running AC it's backed by a cluster and",
    "start": "422960",
    "end": "430160"
  },
  {
    "text": "running across a bunch of machines again these are the kinds of things that we've built into workspaces and really uh move",
    "start": "430160",
    "end": "436520"
  },
  {
    "text": "the needle for just overall developer prod productivity and really like dynamically configuring the cluster is",
    "start": "436520",
    "end": "443240"
  },
  {
    "text": "important because the last thing you want to do is get all your dependencies installed set everything up just right",
    "start": "443240",
    "end": "449680"
  },
  {
    "text": "you know scale the cluster run your application only to figure out actually you use the wrong instance type you know",
    "start": "449680",
    "end": "455800"
  },
  {
    "text": "you need different instance type or the wrong type of GPU wrong Hardware accelerator and then you have to tear",
    "start": "455800",
    "end": "461080"
  },
  {
    "text": "everything down spin up a new cluster reinstall everything it's we've all been there yeah and that's exactly what you",
    "start": "461080",
    "end": "467680"
  },
  {
    "text": "want to avoid or the other side uh what a lot of data scies and uh machine learning Engineers do is get the",
    "start": "467680",
    "end": "473479"
  },
  {
    "text": "beefiest machine possible and uh usually have some questions to answer to your infr platform team on why you wasted so",
    "start": "473479",
    "end": "478680"
  },
  {
    "text": "many resources work is great to just kind of start with aan simple head um",
    "start": "478680",
    "end": "484039"
  },
  {
    "text": "and then as I need to kind of use it for different workloads like large scale data processing or kicking off a",
    "start": "484039",
    "end": "489080"
  },
  {
    "text": "fine-tuning job um it it's runs a separate workload and those workers uh work on that specific uh task and then",
    "start": "489080",
    "end": "496560"
  },
  {
    "text": "uh go scale back down to zero so kind of just very efficiently using uh this compute only for the workloads that",
    "start": "496560",
    "end": "502639"
  },
  {
    "text": "needs to actually have it available for first off Robert uh we're going to jump into kind of data processing let's do it",
    "start": "502639",
    "end": "507919"
  },
  {
    "text": "and um obviously we're going to be talking about everything in the context of a specific task because I always think it's look it's great to actually",
    "start": "507919",
    "end": "514440"
  },
  {
    "text": "learn about things by looking at code that works yeah um but just know that obviously all of this can easily",
    "start": "514440",
    "end": "519640"
  },
  {
    "text": "translate to different data modalities uh different types of models we'll look at and just kind of any kind of machine",
    "start": "519640",
    "end": "524720"
  },
  {
    "text": "learning workload so what task do you have in mind so today we're going to start off with uh a pretty popular data",
    "start": "524720",
    "end": "530120"
  },
  {
    "text": "set um it's called the vgo data set uh so first thing we're going to do is actually just uh load this data uh so",
    "start": "530120",
    "end": "535640"
  },
  {
    "text": "this is available through hugging face um and I'm going to have it uh locally available obviously this tutorial uh",
    "start": "535640",
    "end": "541160"
  },
  {
    "text": "where I don't want to spend too much time kind of loading data from large sources so we picked a data set like this if you did want to load a larger",
    "start": "541160",
    "end": "546720"
  },
  {
    "text": "data set you'd be in a good position to do it uh on here absolutely yeah right because uh it's not it's we don't think",
    "start": "546720",
    "end": "553839"
  },
  {
    "text": "about it as kind of one machine but I can now read data uh and have it chart across multiple workers for this looks like a regular notebook but it is it's",
    "start": "553839",
    "end": "560839"
  },
  {
    "text": "actually backed by any size cluster that you want any kind of compute resources if you need a ton of gpus a ton of other",
    "start": "560839",
    "end": "567040"
  },
  {
    "text": "compute resources accelerators it's right there exactly yeah so this is actually uh you know the workspaces on any scale and I'm showing you the vs",
    "start": "567040",
    "end": "574079"
  },
  {
    "text": "code here because that's my kind of preferred ID this is in fact a a notebook running in vs code but you have",
    "start": "574079",
    "end": "579640"
  },
  {
    "text": "option to choose kind of between a jupyter lab uh experience a terminal as well um and as you mentioned this this",
    "start": "579640",
    "end": "586440"
  },
  {
    "text": "feels just like my Lo local laptop here but uh if I go here uh I've actually started this workspace on top of a",
    "start": "586440",
    "end": "593000"
  },
  {
    "text": "compute uh that is actually running on cloud so I've picked a head node that has 8 CPUs and 32 gigs um and we'll talk",
    "start": "593000",
    "end": "600320"
  },
  {
    "text": "about kind of what else is available on top of this when we need it but right now that's all I'm using uh it's a kind of a very lean machine that I'm running",
    "start": "600320",
    "end": "606760"
  },
  {
    "text": "in this and that's exactly what you want if you're not using not running intense computation you don't want a lot of uh",
    "start": "606760",
    "end": "612440"
  },
  {
    "text": "machines started up but I like the the look of this Auto Select worker nodes button yeah we'll take we'll take a look",
    "start": "612440",
    "end": "618760"
  },
  {
    "text": "at that uh in just about a second okay so I've loaded the data set uh and just like kind of you know traditionally",
    "start": "618760",
    "end": "624640"
  },
  {
    "text": "dealing with data sets I I'm going to go ahead and split it uh so this comes automatically with a train Val validation and test split let's just",
    "start": "624640",
    "end": "630720"
  },
  {
    "text": "look at a sample here uh what I want to focus on is uh kind of the inputs and outputs so here this is a data set that",
    "start": "630720",
    "end": "636240"
  },
  {
    "text": "has something structured so it starts with an intent uh then it extracts a bunch of entities um and then the output",
    "start": "636240",
    "end": "643360"
  },
  {
    "text": "actually for this data set is an very like unstructured sentence that's composed using these structured inputs",
    "start": "643360",
    "end": "649639"
  },
  {
    "text": "um now what I'm going to propose is actually we flip this I actually want to have this unstructured sentence as the",
    "start": "649639",
    "end": "655360"
  },
  {
    "text": "input and let's see if we can leverage large language models to be able to extract the structured information and",
    "start": "655360",
    "end": "660839"
  },
  {
    "text": "you know everyone kind of talks about llms in kind of this generative space uh but this is kind of an example where",
    "start": "660839",
    "end": "666279"
  },
  {
    "text": "it's going kind of back to structured um and we've seen a lot of our customers and kind of the world frankly um a lot",
    "start": "666279",
    "end": "672600"
  },
  {
    "text": "of these applications were reserved for traditional deep learning um but now people are leveraging LMS to do the same because first they can get away with",
    "start": "672600",
    "end": "679760"
  },
  {
    "text": "having far less data to actually have very uh performant models um and number two uh a lot of other perks like open",
    "start": "679760",
    "end": "686720"
  },
  {
    "text": "domain the LMS have a lot of uh kind of underlying knowledge that they can leverage to to do tasks like this yeah",
    "start": "686720",
    "end": "692560"
  },
  {
    "text": "actually that's a that's a good point we often think about llms and generative AI really uh favoring unstructured data",
    "start": "692560",
    "end": "699600"
  },
  {
    "text": "over structured data but I think one point that people sometimes underestimate or Miss is that the potential for generative Ai and llms to",
    "start": "699600",
    "end": "707639"
  },
  {
    "text": "really make it easy to create structure from unstructured data and actually lead to way more uh structured data",
    "start": "707639",
    "end": "714800"
  },
  {
    "text": "absolutely yep awesome so uh let's before we can actually uses data to",
    "start": "714800",
    "end": "720120"
  },
  {
    "text": "start fine-tuning a model uh there's a couple pre-processing steps we want to take um and I'm going to do this uh",
    "start": "720120",
    "end": "725720"
  },
  {
    "text": "start with Ray right now because even though this data set is small um we want to be able to extend this to a data set",
    "start": "725720",
    "end": "731720"
  },
  {
    "text": "of any arbitrary size so first thing we going to do is actually import Ray and uh wrap wrap this data set um with Ray",
    "start": "731720",
    "end": "738240"
  },
  {
    "text": "now here the data set's already in memory uh but this could be done with something let's say in cloud storage as well where I can kind of uh uh read data",
    "start": "738240",
    "end": "745880"
  },
  {
    "text": "from cloud storage or any other source um and have it be be able to be shed across workers um and a typical place to",
    "start": "745880",
    "end": "752639"
  },
  {
    "text": "store your data might be a a cloud cloud storage like S3 exct or Google Cloud Storage or data bricks or snowflake",
    "start": "752639",
    "end": "759279"
  },
  {
    "text": "there are many different options there exactly okay so once I've loaded the data set uh kind of works very similar I",
    "start": "759279",
    "end": "764480"
  },
  {
    "text": "can kind of take a look at the data uh you can see uh What uh the data point actually looks like and I'm going to",
    "start": "764480",
    "end": "770360"
  },
  {
    "text": "prepare like couple small functions so U thinking ahead a little bit here but to actually find tune our model we need our",
    "start": "770360",
    "end": "776240"
  },
  {
    "text": "data set to look a certain way and follow certain schema um and we need this is actually very",
    "start": "776240",
    "end": "781639"
  },
  {
    "text": "similar to how everybody does fine tuning these days open a follows a very similar standard um and I'm going to",
    "start": "781639",
    "end": "787519"
  },
  {
    "text": "wrap this into a function called pre-process uh that'll just kind of uh apply this schema to all of our data",
    "start": "787519",
    "end": "792800"
  },
  {
    "text": "points now uh this is a system content here I'm basically telling the llm um",
    "start": "792800",
    "end": "798240"
  },
  {
    "text": "kind of how to behave and because we do want structured outputs I'm kind of telling it uh first like predict you",
    "start": "798240",
    "end": "803680"
  },
  {
    "text": "know what kind of intent uh that we want and then extract these kind of different types of entities um and the output can",
    "start": "803680",
    "end": "809959"
  },
  {
    "text": "have basically have a subset of these types of enties makes sense and of course this is specific to the particular task we're trying to do right",
    "start": "809959",
    "end": "815680"
  },
  {
    "text": "now yes exactly so so far if you looked at the functions everything's in pure Python and to actually apply this at",
    "start": "815680",
    "end": "821160"
  },
  {
    "text": "scale I don't really have to do anything crazy all I'm going to do is take my function it was called pre-process and",
    "start": "821160",
    "end": "826760"
  },
  {
    "text": "we have our data set uh train DS here and I use this function from Ray data called map batches and I can simply take",
    "start": "826760",
    "end": "832759"
  },
  {
    "text": "the data set and apply this function on that data set and I can specify things",
    "start": "832759",
    "end": "837880"
  },
  {
    "text": "like uh you know any function arguments and uh you know our documentation has a lot more but we can even specify",
    "start": "837880",
    "end": "843000"
  },
  {
    "text": "different compute strategies how many of what device type do I want to use and and you really want to do that to be",
    "start": "843000",
    "end": "849040"
  },
  {
    "text": "able to have full control over what resources do I do I want to spend on this how much is it going to cost me Etc",
    "start": "849040",
    "end": "855160"
  },
  {
    "text": "and now for the really cool part Robert when we actually run this uh this is no longer running just on this head node",
    "start": "855160",
    "end": "861440"
  },
  {
    "text": "right here so because we've enabled this Auto Select worker nodes based on things like my data size uh the workload that",
    "start": "861440",
    "end": "868040"
  },
  {
    "text": "that I'm actually running the compute strategy we specified and in this case I'm using the default compute strategy",
    "start": "868040",
    "end": "873160"
  },
  {
    "text": "the appropriate number of worker nodes actually get uh spun up uh they work on this workload that we have and then they",
    "start": "873160",
    "end": "879480"
  },
  {
    "text": "scale back down to zero that's incredible yeah and you know you can see kind of uh there logs a lot of logs that",
    "start": "879480",
    "end": "885199"
  },
  {
    "text": "come out of this um and we get to see uh at the end I'm going to take a sample and you can see that it's actually has",
    "start": "885199",
    "end": "891079"
  },
  {
    "text": "applied successfully applied that pre-processing function on all of our data wow um and then I'm going to",
    "start": "891079",
    "end": "896959"
  },
  {
    "text": "actually just uh do this for the other data splits as well cuz we're going to be using it later on um and then finally",
    "start": "896959",
    "end": "902480"
  },
  {
    "text": "I'd love to just save this data I've already gone ahead and done this uh so that uh folks can easily access this",
    "start": "902480",
    "end": "907560"
  },
  {
    "text": "data um but once it's there you can easily uh read from that cloud storage as well um and something convenient that",
    "start": "907560",
    "end": "913360"
  },
  {
    "text": "workspaces comes with comes with is that every workspace has kind of a default cloud storage uh and even shared storage",
    "start": "913360",
    "end": "919959"
  },
  {
    "text": "as well if you're working with a group of folks um but it's just very convenient to be able to save your data",
    "start": "919959",
    "end": "925160"
  },
  {
    "text": "to various not just data but any kind of artifacts um to storage and be able to retrieve that later on totally and that",
    "start": "925160",
    "end": "931440"
  },
  {
    "text": "that is one of the challenges with distributed computing in general is like okay I I ran my application it's on some",
    "start": "931440",
    "end": "937959"
  },
  {
    "text": "there's some artifact that was produced it's on some machine somewhere maybe I saved it to disk but like where is it now and if I need it on another machine",
    "start": "937959",
    "end": "944480"
  },
  {
    "text": "or another the next job that I'm running how do I how do I get it how do I hand it off between different pieces of my",
    "start": "944480",
    "end": "950319"
  },
  {
    "text": "application uh so just having a clear consistent story for storage and",
    "start": "950319",
    "end": "955800"
  },
  {
    "text": "producing artifacts and using them Downstream uh that's huge thanks for walking us through that notebook yep and now we'll uh put it to",
    "start": "955800",
    "end": "962199"
  },
  {
    "text": "good use",
    "start": "962199",
    "end": "965279"
  },
  {
    "text": "awesome all right Robert so now we're going to leverage the data set that we pre-processed and actually use it to",
    "start": "968160",
    "end": "973959"
  },
  {
    "text": "fine tunes and models all right let's do it this is the fun part all right so",
    "start": "973959",
    "end": "979319"
  },
  {
    "text": "before we kind of get into fine tuning I did want to make it clear that traditionally we wouldn't just jump to fine tuning uh we'd want to actually",
    "start": "979319",
    "end": "986360"
  },
  {
    "text": "experiment with some base models and actually evaluate those Bas models to see what we're working with yes I mean the whole point of fine tuning is to",
    "start": "986360",
    "end": "993160"
  },
  {
    "text": "improve the model quality right so if you don't have a a way of comparing the",
    "start": "993160",
    "end": "998800"
  },
  {
    "text": "quality evaluating the quality of the fine tuned model and saying hey this is better than uh you know the base model",
    "start": "998800",
    "end": "1004639"
  },
  {
    "text": "you're not going to know what to do with that exactly yep now for fine-tuning there are a couple different methods um",
    "start": "1004639",
    "end": "1011199"
  },
  {
    "text": "and we're going to talk about both of them but um the two popular ones are Laura and full parameter and on any",
    "start": "1011199",
    "end": "1018120"
  },
  {
    "text": "scale we actually have a couple different uh recipes that are available and of course we're going to allow you to do both exactly yep uh we have got a",
    "start": "1018120",
    "end": "1024199"
  },
  {
    "text": "couple different recipes uh inside U uh this training configs directory uh which comes with all the workspace templates",
    "start": "1024199",
    "end": "1030280"
  },
  {
    "text": "for fine tuning and these are basically recipes that the community has uh really worked hard on and pulled together every",
    "start": "1030280",
    "end": "1036319"
  },
  {
    "text": "time a new model comes out and it comes with a set of kind of default configuration uh options that just work",
    "start": "1036319",
    "end": "1043319"
  },
  {
    "text": "for this specific model and we've exposed all these recipes and of course you can modify all these different Val",
    "start": "1043319",
    "end": "1049120"
  },
  {
    "text": "as well and you have full control in terms of like what exactly you want to change and what you want to experiment with now the one thing we're going to go",
    "start": "1049120",
    "end": "1054919"
  },
  {
    "text": "through a few of these the one thing you definitely want to change is um the train validation path especially if our users are expanding with their own data",
    "start": "1054919",
    "end": "1061160"
  },
  {
    "text": "sets so I've gone ahead and changed it to the cloud storage uh locations that we've saved our data set to um but then",
    "start": "1061160",
    "end": "1066840"
  },
  {
    "text": "you know the rest of the parameters we'll look at a few that are kind of model specific uh context length um for",
    "start": "1066840",
    "end": "1072280"
  },
  {
    "text": "actually what how do you want to actually train this so I'm setting the number of devices here um number of",
    "start": "1072280",
    "end": "1077760"
  },
  {
    "text": "epoch you want to EXP and the fact that you can just change the number of devices from 16 to 32 or whatever you",
    "start": "1077760",
    "end": "1083600"
  },
  {
    "text": "want and use more gpus and have it run faster that's awesome all right so after",
    "start": "1083600",
    "end": "1088960"
  },
  {
    "text": "this you can kind of uh play around with more traditional parameters like learning rate uh what kind of padding",
    "start": "1088960",
    "end": "1094200"
  },
  {
    "text": "logic you want to have how many checkpoints you want to save by default we kind of save the best and the last checkpoint but full control over that as",
    "start": "1094200",
    "end": "1100400"
  },
  {
    "text": "well so a couple more uh interesting configurations here um we have deep speed which is another uh open source",
    "start": "1100400",
    "end": "1105640"
  },
  {
    "text": "library that we leverage and uh the community has really worked to kind of make it really easy to do things like",
    "start": "1105640",
    "end": "1111640"
  },
  {
    "text": "distributed uh training uh mix Precision checkpointing gradient accumulation all these kind of different uh things that",
    "start": "1111640",
    "end": "1118960"
  },
  {
    "text": "are really important for training but as a developer I don't really want to think about that kind of managing those",
    "start": "1118960",
    "end": "1124080"
  },
  {
    "text": "aspects I want to focus on my training logic and and actually just work on uh the model itself our team here as well",
    "start": "1124080",
    "end": "1129600"
  },
  {
    "text": "as the community uh they're always working on the next set of optimizations uh to enable for these kind of workloads",
    "start": "1129600",
    "end": "1135919"
  },
  {
    "text": "so um we we make sure that's available uh Al through these configurations things like flash attention um and you",
    "start": "1135919",
    "end": "1142960"
  },
  {
    "text": "know it's guaranteed that we kind of stay on top of this as well keep enabling that for our users now uh in",
    "start": "1142960",
    "end": "1148720"
  },
  {
    "text": "terms of uh you know kind of the compute strategy you again have uh control you chose a number of devices or workers",
    "start": "1148720",
    "end": "1153960"
  },
  {
    "text": "that you want you can also choose kind of the accelerator type and things like that and we'll see that in action when we actually run off the workload um and",
    "start": "1153960",
    "end": "1161200"
  },
  {
    "text": "now for actual uh fine tuning logic we can either change the um entire set of",
    "start": "1161200",
    "end": "1166919"
  },
  {
    "text": "Weights in our model it's called Full parameter fine tuning uh or we can do something called Laura which uh says uh",
    "start": "1166919",
    "end": "1172120"
  },
  {
    "text": "stands for low rank adaptation um that's really a great strategy if you want to not tweak the entire set of Weights in",
    "start": "1172120",
    "end": "1178360"
  },
  {
    "text": "the model but uh really kind of uh develop these low rank patencies and alter those weights uh instead of the",
    "start": "1178360",
    "end": "1185120"
  },
  {
    "text": "original St learnings from our customers and our internal applications you always want to start with Laura um it's just",
    "start": "1185120",
    "end": "1190600"
  },
  {
    "text": "kind of a a simpler faster way to kind of uh fine-tune uh and then based on your task and what you're learning from",
    "start": "1190600",
    "end": "1197000"
  },
  {
    "text": "these uh you you'll want to open up full full parameter fine tuning will be more powerful AB um but they're both great",
    "start": "1197000",
    "end": "1203360"
  },
  {
    "text": "techniques y exactly um and of course you have full control here as well you can obviously control uh the ranking um",
    "start": "1203360",
    "end": "1209600"
  },
  {
    "text": "a several other kind of parameters in terms of the actual uh weight matricies and the training logic as well awesome",
    "start": "1209600",
    "end": "1215760"
  },
  {
    "text": "so with these configurations you uh again you have full control over these and to actually launch this job uh we",
    "start": "1215760",
    "end": "1221880"
  },
  {
    "text": "have a script here that takes in this configuration um and kind of the computer strategy that we have and it",
    "start": "1221880",
    "end": "1227400"
  },
  {
    "text": "just executes this so now because we've uh enabled this Auto Select worker nodes",
    "start": "1227400",
    "end": "1232600"
  },
  {
    "text": "our head node is still this lean machine right here but when we kick off this workload um it automatically uh",
    "start": "1232600",
    "end": "1238760"
  },
  {
    "text": "Provisions the appropriate workers this workload executes and then these workers scale back down to zero so when this is",
    "start": "1238760",
    "end": "1245440"
  },
  {
    "text": "actually running uh the appropriate workers will be uh kind of provisioned and executed there and we have a",
    "start": "1245440",
    "end": "1251799"
  },
  {
    "text": "fantastic Ray dashboard which gives kind of full uh observability and full view into what's actually happening and we",
    "start": "1251799",
    "end": "1257760"
  },
  {
    "text": "get to see our GPU use Gober here so um GPU utilization CP utilization what's happening on the disc uh and then",
    "start": "1257760",
    "end": "1264320"
  },
  {
    "text": "obviously what work workers are actually provisioned um just and it's just a great oversight to actually see what's",
    "start": "1264320",
    "end": "1269640"
  },
  {
    "text": "happening under the hood um and and U make sure that trainings uh properly happen when you're debugging or building",
    "start": "1269640",
    "end": "1275760"
  },
  {
    "text": "these types of applications they typically two types of things you're trying to debug one is just correctness",
    "start": "1275760",
    "end": "1281720"
  },
  {
    "text": "like is the thing running is it crashing if it's crashing what's the error message and that's one type of monitoring that's very important but",
    "start": "1281720",
    "end": "1288080"
  },
  {
    "text": "another is about performance right so it's running it's correct and everything but the question you're asking yourself",
    "start": "1288080",
    "end": "1293880"
  },
  {
    "text": "is why isn't it faster yeah and in that case you really need to know what different resource might be the",
    "start": "1293880",
    "end": "1299080"
  },
  {
    "text": "bottleneck whether that is GPU utilization GPU memory disk space many different things like that and having",
    "start": "1299080",
    "end": "1305279"
  },
  {
    "text": "those um metrics across the cluster at your fingertips is essential so once this is actually done it's one of the",
    "start": "1305279",
    "end": "1312799"
  },
  {
    "text": "most frustrating things for me is that I run let's say a large workload like this and then I have uh my code fail on the",
    "start": "1312799",
    "end": "1318039"
  },
  {
    "text": "actual check that sounds I'm going to have to restart so again as I mentioned in the previous template uh workspaces comes with a",
    "start": "1318039",
    "end": "1324640"
  },
  {
    "text": "default cloud storage location you can use that or anything else that you want um but now our models um and kind of key",
    "start": "1324640",
    "end": "1331120"
  },
  {
    "text": "artifacts are automatically stored for us so things like um the actual uh checkpoints the best one the last one",
    "start": "1331120",
    "end": "1336960"
  },
  {
    "text": "the results these are all automatically stored in in the default cloud storage and now I can access these for uh kind",
    "start": "1336960",
    "end": "1343120"
  },
  {
    "text": "of inspection and other workloads that's brilliant awesome so here I'm just going to quickly show what that looks like uh",
    "start": "1343120",
    "end": "1348960"
  },
  {
    "text": "this is the default cloud storage I go ahead and uh extract these from cloud storage I pull them locally um and then",
    "start": "1348960",
    "end": "1355080"
  },
  {
    "text": "I just visualize for example our result. Json file and again if you have a tensor board or other Integrations you can also",
    "start": "1355080",
    "end": "1361240"
  },
  {
    "text": "visualize these things there I'll show uh what it looks like to actually pull up the checkpoints and now use it for um",
    "start": "1361240",
    "end": "1367200"
  },
  {
    "text": "evaluating this model um because we need to actually see that it worked",
    "start": "1367200",
    "end": "1373000"
  },
  {
    "text": "excellent all right Robert so now that we find two in our model we're actually going to see if it worked now so far uh",
    "start": "1374799",
    "end": "1382080"
  },
  {
    "text": "when we actually did the fine tuning uh we had a metric out of the box uh and it's typically perplexity and we have",
    "start": "1382080",
    "end": "1388200"
  },
  {
    "text": "you can alter that as well but perplexities while it's a meaningful metric and it's really kind of based off",
    "start": "1388200",
    "end": "1393960"
  },
  {
    "text": "of how perplex the model is at kind of seeing a new token it's not going to be most scenarios it's not going to be",
    "start": "1393960",
    "end": "1399600"
  },
  {
    "text": "representative of the underlying task for example in our scenario we're wanting to go from um an unstructured",
    "start": "1399600",
    "end": "1405400"
  },
  {
    "text": "sentence and extract structured outputs I'm sure we can think of a lot of different ways to evaluate this but kind",
    "start": "1405400",
    "end": "1411000"
  },
  {
    "text": "of picking a random distance or entropy based metric is isn't going to be truly reflective so um to get started we're",
    "start": "1411000",
    "end": "1418320"
  },
  {
    "text": "going to be uh uh setting up Ray again um we're going to have a hugging face token here that will pass uh and we'll",
    "start": "1418320",
    "end": "1424799"
  },
  {
    "text": "use this to actually uh load our base model so far we jumped to fine-tuning a model but I also want to do evaluation",
    "start": "1424799",
    "end": "1431679"
  },
  {
    "text": "on the base model just to see what it looks like sounds all right so I'm going to load",
    "start": "1431679",
    "end": "1436960"
  },
  {
    "text": "our data set that we had uh and if you if you recall we actually had uh we created a test set as well now the model",
    "start": "1436960",
    "end": "1442279"
  },
  {
    "text": "did not have access to this which is very important we had only saw the train in validation awesome so once uh we have",
    "start": "1442279",
    "end": "1448279"
  },
  {
    "text": "our test set I'm actually going to separate it into inputs and outputs so just to recap uh the inputs here are",
    "start": "1448279",
    "end": "1453880"
  },
  {
    "text": "going to be that system and user content that we had before um and then the outputs are going to be the actual structured outputs that the uh LM",
    "start": "1453880",
    "end": "1461000"
  },
  {
    "text": "hopefully also generates um so just to look at that uh here's one example I'm",
    "start": "1461000",
    "end": "1466399"
  },
  {
    "text": "going to actually also uh load a tokenizer um so if you recall the model that we ended up fine tuning was this llama 38",
    "start": "1466399",
    "end": "1472640"
  },
  {
    "text": "the instruct version um I'm going to load the tokenizer from hugging face and the reason I want to do this is because",
    "start": "1472640",
    "end": "1479240"
  },
  {
    "text": "there's something called a chat template so uh during fine-tuning uh what we had",
    "start": "1479240",
    "end": "1484399"
  },
  {
    "text": "done was we obviously uh created our data set uh and we pre-processed to fit",
    "start": "1484399",
    "end": "1489520"
  },
  {
    "text": "fit a certain schema when that's actually being inserted into the model those that piece of text is actually uh",
    "start": "1489520",
    "end": "1496679"
  },
  {
    "text": "um templatized so the LMS uh during pre-processing uh for the LM itself it'll add some special tokens like a",
    "start": "1496679",
    "end": "1503600"
  },
  {
    "text": "beginning of sentence token end of sentence token and we want to make sure that we apply the same template uh when",
    "start": "1503600",
    "end": "1510480"
  },
  {
    "text": "we feed the data from our test samples into our same model um so this is this is exactly why we need the tokenizer um",
    "start": "1510480",
    "end": "1517600"
  },
  {
    "text": "and what I'm going to do is uh load uh one of the uh model artifacts from our",
    "start": "1517600",
    "end": "1522679"
  },
  {
    "text": "fine tuning uh run so from our fine tuning which model artifact yeah so inside uh from from our fine tuning uh",
    "start": "1522679",
    "end": "1529200"
  },
  {
    "text": "the uh model artifacts that were stored in cloud storage um it basically just saves all the artifacts in one location",
    "start": "1529200",
    "end": "1535080"
  },
  {
    "text": "perfect and inside this bucket there's a file called to tokenizer config and inside there there's uh an attribute",
    "start": "1535080",
    "end": "1541880"
  },
  {
    "text": "called chat template so very simple I just load up the chat template um and now I can actually apply that chat",
    "start": "1541880",
    "end": "1547679"
  },
  {
    "text": "template to all the uh examples in our test set so this way I can now have the",
    "start": "1547679",
    "end": "1553559"
  },
  {
    "text": "same inputs uh be available for U uh basically um offline inference for our",
    "start": "1553559",
    "end": "1559559"
  },
  {
    "text": "models okay so now that I have um here's a quick example so this was originally",
    "start": "1559559",
    "end": "1564760"
  },
  {
    "text": "just the input and now we've added uh kind of Applied the chat template to it okay awesome so from this step here",
    "start": "1564760",
    "end": "1573520"
  },
  {
    "text": "uh we're actually going to kick off uh batch inference um and just to kind of recap here evaluation is one of those tasks uh",
    "start": "1573520",
    "end": "1580919"
  },
  {
    "text": "that's really ripe for batch inference because you have a set of uh let's say a large set of inputs you have a model and",
    "start": "1580919",
    "end": "1587600"
  },
  {
    "text": "in this case it's a large model I don't want to feed this one at a time I want to take the entire batch because it's available right now and I want to be",
    "start": "1587600",
    "end": "1593600"
  },
  {
    "text": "able to feed it to my model and look at the entire set of outputs yeah and this is just one example of many different",
    "start": "1593600",
    "end": "1600399"
  },
  {
    "text": "types of batch workloads that you may come across you may you do batch workloads for um evaluation you may also",
    "start": "1600399",
    "end": "1607000"
  },
  {
    "text": "want to do it for just processing a large amount of data you have earlier on we talked about um taking uh",
    "start": "1607000",
    "end": "1613799"
  },
  {
    "text": "unstructured data and producing structured data it's a very natural batch task to perform on a large data",
    "start": "1613799",
    "end": "1619399"
  },
  {
    "text": "set that you collected absolutely and if you recall before uh when we applied map",
    "start": "1619399",
    "end": "1624480"
  },
  {
    "text": "batches from Ray data we had applied a specific function to our entire data set um this is a great time to show how um",
    "start": "1624480",
    "end": "1632120"
  },
  {
    "text": "this offline batch inference we can actually follow very similar logic same match B map batch as function but",
    "start": "1632120",
    "end": "1637720"
  },
  {
    "text": "instead of a a function we'll actually pass in a class yeah so why why uh why a",
    "start": "1637720",
    "end": "1642919"
  },
  {
    "text": "class this time yeah so in terms of like what we actually want to the operation we want to apply on the the the data set",
    "start": "1642919",
    "end": "1649000"
  },
  {
    "text": "itself so in our case now we took the test data set we've applied the chat template and now I want to apply this",
    "start": "1649000",
    "end": "1655240"
  },
  {
    "text": "class because there are certain attributes that I want uh available for every kind of uh operation on this data",
    "start": "1655240",
    "end": "1661279"
  },
  {
    "text": "set so for example here the class itself will have a couple uh pieces of information the llm uh sampling",
    "start": "1661279",
    "end": "1668039"
  },
  {
    "text": "parameters which I'll talk about in a bit um and then kind of our Laura path these are things I I don't need to",
    "start": "1668039",
    "end": "1673159"
  },
  {
    "text": "change in between each function call but they are pieces of information that I want to instantiate my class with and",
    "start": "1673159",
    "end": "1679640"
  },
  {
    "text": "then the class itself the function that it'll be responsible for is under this call yeah I mean so you're running the",
    "start": "1679640",
    "end": "1685320"
  },
  {
    "text": "the uh fun llm on all of the data ex right which which of course is a function exactly now you mentioned",
    "start": "1685320",
    "end": "1692399"
  },
  {
    "text": "there's this information you want to share between all of the invocations of that function but I think the part of the key is that that that information is",
    "start": "1692399",
    "end": "1699240"
  },
  {
    "text": "kind of large and kind of um perhaps expensive to initialize exactly right and so if we were to do that repeatedly",
    "start": "1699240",
    "end": "1705440"
  },
  {
    "text": "every single time could be kind of bad exactly yeah so there's a very efficient way to apply that apply our model",
    "start": "1705440",
    "end": "1711399"
  },
  {
    "text": "basically to to that uh data set awesome so I've actually written this function um again going back to kind of really",
    "start": "1711399",
    "end": "1718399"
  },
  {
    "text": "relying on open source um we're using VM here which is uh one of the most popular and and reliable well adopted uh",
    "start": "1718399",
    "end": "1725240"
  },
  {
    "text": "inference engines yes um and you know any here any scale I think we're also we actually contributed quite a bit to VM",
    "start": "1725240",
    "end": "1731880"
  },
  {
    "text": "absolutely um and it's a fantastic Library that's really matured over the last couple months now and I'm in it",
    "start": "1731880",
    "end": "1738519"
  },
  {
    "text": "here to basically really easily switch between our base model and Laura so if",
    "start": "1738519",
    "end": "1743600"
  },
  {
    "text": "you look at the actual call that's executing here I have a self. llm and that uses the uh offline LM class from",
    "start": "1743600",
    "end": "1750159"
  },
  {
    "text": "VM and to actually generate the outputs I just pass in my inputs pass in a",
    "start": "1750159",
    "end": "1755679"
  },
  {
    "text": "sampling parameters which I'll uh just cover in a second and it's the exact same thing for if I want to generate",
    "start": "1755679",
    "end": "1761120"
  },
  {
    "text": "outputs from a Lowa Verge all I have to pass in is this Laura uh path itself so",
    "start": "1761120",
    "end": "1766360"
  },
  {
    "text": "what's happening here is that for the base model we have a base set of weights and then for our fine tune model which is Laura use the same base model set of",
    "start": "1766360",
    "end": "1773120"
  },
  {
    "text": "weights and then just merges it with these Laura weights which again are saved uh from our fine tuning run so",
    "start": "1773120",
    "end": "1778279"
  },
  {
    "text": "it's as simple as pass passing in an extra path to uh use our fine tune model okay um and in terms of the",
    "start": "1778279",
    "end": "1785360"
  },
  {
    "text": "outputs Again full control here I want to actually have access to the prompt so what were the inputs that went in uh",
    "start": "1785360",
    "end": "1791039"
  },
  {
    "text": "what are the expected outputs which is just again from the batch uh that were passed in and then what are the generated outputs from this model so I",
    "start": "1791039",
    "end": "1797519"
  },
  {
    "text": "want all three pieces of information and so here are you expecting the expected outputs and the generated outputs to be",
    "start": "1797519",
    "end": "1803200"
  },
  {
    "text": "identical they should match y exactly okay so first let's uh go ahead and uh",
    "start": "1803200",
    "end": "1808399"
  },
  {
    "text": "apply this for using our base model so set the model the sampling parameters here are kind of how you want the model",
    "start": "1808399",
    "end": "1813679"
  },
  {
    "text": "to behave there's a lot more parameters that you control here but two that I care about right now are temperature is zero and then uh max number of tokens so",
    "start": "1813679",
    "end": "1820919"
  },
  {
    "text": "this really again depends on which model that you use but I want I don't want the output to I know my outputs are going to",
    "start": "1820919",
    "end": "1826480"
  },
  {
    "text": "be are not going to be too large um this is something you'll want to set if you want to kind of place any constraints on",
    "start": "1826480",
    "end": "1831640"
  },
  {
    "text": "how large the output should be and where Generations would stop for example okay so I'm going to go ahead and apply the",
    "start": "1831640",
    "end": "1837760"
  },
  {
    "text": "base model to our data set so it looks very similar I have the uh test data set and we've applied the chat template map",
    "start": "1837760",
    "end": "1843799"
  },
  {
    "text": "batches and I just passed in the class and now just before if you remember we used the default computer strategy where",
    "start": "1843799",
    "end": "1850480"
  },
  {
    "text": "just uh allocated the number of workers for that job but now I'm going to actually decide how many uh LM instances",
    "start": "1850480",
    "end": "1857360"
  },
  {
    "text": "that I want uh how many GPS per worker and what what is the batch size and we can play with this based on what we care",
    "start": "1857360",
    "end": "1863080"
  },
  {
    "text": "about um and you know full control here and I I love this this is the fact that you can just pass into class or the",
    "start": "1863080",
    "end": "1869639"
  },
  {
    "text": "function yeah right the fact that you can just specify the concurrency and the gpus with a single number and the batch",
    "start": "1869639",
    "end": "1876200"
  },
  {
    "text": "size and of course again there are defaults for all of these things but um",
    "start": "1876200",
    "end": "1881320"
  },
  {
    "text": "this is just and then as a consequence you can scale this across the same computation on all of your data across a",
    "start": "1881320",
    "end": "1886679"
  },
  {
    "text": "huge amount of data CL cluster that's fantastic exactly and of course you can play around the accelerator type as well",
    "start": "1886679",
    "end": "1894159"
  },
  {
    "text": "awesome so going to go ahead and I just want to look at a couple examples so um here's kind of the I guess bad part of",
    "start": "1894159",
    "end": "1901240"
  },
  {
    "text": "uh using one of these base models for a complicated task like this I feed in the prompt and you can see the expected",
    "start": "1901240",
    "end": "1906679"
  },
  {
    "text": "outputs are you know the intent and the different entities but our model has never seen this before uh uh and so the",
    "start": "1906679",
    "end": "1914080"
  },
  {
    "text": "generated text is actually a very long story which is very meaningless in fact if I actually print this it's actually",
    "start": "1914080",
    "end": "1921080"
  },
  {
    "text": "writing out a class for us so it's completely uh kind of misunderstood the task um and this is actually definitely",
    "start": "1921080",
    "end": "1928960"
  },
  {
    "text": "expected Behavior right we haven't done anything like uh prompt enging here something we could have done to help the",
    "start": "1928960",
    "end": "1934679"
  },
  {
    "text": "base model a little bit maybe provided a few shot a few examples here and and that might work but um certainly just",
    "start": "1934679",
    "end": "1941039"
  },
  {
    "text": "using the raw base model uh is not giving the right output next we're going to actually do the same thing with our fine tune model um very similar and",
    "start": "1941039",
    "end": "1947919"
  },
  {
    "text": "you'll notice the only thing that I'm adding here is a Lura path by passing in that it now uses the same boss uh base",
    "start": "1947919",
    "end": "1953200"
  },
  {
    "text": "model merge the Lura weights and now same in call happens so let's look at a few examples here uh you can see the",
    "start": "1953200",
    "end": "1960039"
  },
  {
    "text": "expected output and you can see the generated text is actually in this case uh exactly the same um but let's go",
    "start": "1960039",
    "end": "1966600"
  },
  {
    "text": "ahead and do like a quick eval here so I'm going to keep it simple I'm let's be a little bit strict so let's look at",
    "start": "1966600",
    "end": "1972720"
  },
  {
    "text": "exact matches um so I just say any time that the expected output matches exact",
    "start": "1972720",
    "end": "1978080"
  },
  {
    "text": "the generated textt uh count that as a as a match obviously you can do many different metrics here recall you can be",
    "start": "1978080",
    "end": "1983799"
  },
  {
    "text": "a little more lenient completely up to the user but I just wanted to quickly show the effectiveness even with this strict evaluation uh there's a 90 almost",
    "start": "1983799",
    "end": "1990639"
  },
  {
    "text": "a 96% uh match here W uh which is great to see from just like a you know just I",
    "start": "1990639",
    "end": "1995919"
  },
  {
    "text": "think a few epochs of this as well the last thing I just wanted to mention about eval is that we had the luxury of",
    "start": "1995919",
    "end": "2002000"
  },
  {
    "text": "almost kind of uh working with the structured output but a lot of LM or gen applications the outputs are very",
    "start": "2002000",
    "end": "2007919"
  },
  {
    "text": "subjective um so you're not always going to have kind of cleancut metrics like this and you won't always be able to",
    "start": "2007919",
    "end": "2012960"
  },
  {
    "text": "kind of rely on those out of the-box distance or entropy based metrics um so here's kind of where um a very popular",
    "start": "2012960",
    "end": "2020880"
  },
  {
    "text": "technique uh people call it kind of llm as a judge or GPT judge uh where you use a much larger sometimes even proprietary",
    "start": "2020880",
    "end": "2027760"
  },
  {
    "text": "model to actually do uh kind of the evaluation and this is just wild this is",
    "start": "2027760",
    "end": "2033840"
  },
  {
    "text": "like beautiful in some ways it is beautiful and also uh a little bit uh anxiety Rising because you you don't",
    "start": "2033840",
    "end": "2039760"
  },
  {
    "text": "really have control over what's happening but in this scenario you'd pass in kind of your let's say this fine tun lm's output um and then you'll ask",
    "start": "2039760",
    "end": "2047799"
  },
  {
    "text": "uh that that larger judge llm to basically assess the quality of it and well often times people also add kind of",
    "start": "2047799",
    "end": "2054200"
  },
  {
    "text": "a a suggested answer or or a a golden answer to ask it to compare and rate",
    "start": "2054200",
    "end": "2059919"
  },
  {
    "text": "between one through five and things like that so either way you want to have some strategy towards like quantifying the",
    "start": "2059919",
    "end": "2065240"
  },
  {
    "text": "evals otherwise you're just relying on sniff tests and um those those fall apart pretty quickly well if you don't",
    "start": "2065240",
    "end": "2071599"
  },
  {
    "text": "quantify it then you're never going to automate it right so that part is essential",
    "start": "2071599",
    "end": "2077440"
  },
  {
    "text": "exactly now we're finally at the last template where we get to serve our model",
    "start": "2079000",
    "end": "2084520"
  },
  {
    "text": "that we've evaluated so obviously there's a lot of different ways to serve these models and before we talk about race serve and all that I just wanted to",
    "start": "2084520",
    "end": "2091200"
  },
  {
    "text": "make it clear that um we do have guides for how to use uh vlm or any other",
    "start": "2091200",
    "end": "2096599"
  },
  {
    "text": "inference engine and use race serve to be able to serve your models but today I'm actually going to demonstrate some of the uh any skill capabilities for",
    "start": "2096599",
    "end": "2104000"
  },
  {
    "text": "serving these models using these INF engines but also um with a lot more features in terms of uh uh kind of doing",
    "start": "2104000",
    "end": "2111240"
  },
  {
    "text": "multiple Laura tensor parallelism more like production grade features that our users are going to care about and just",
    "start": "2111240",
    "end": "2116359"
  },
  {
    "text": "to explain that distinction um text generation like TGI VM uh tens tlm these",
    "start": "2116359",
    "end": "2123520"
  },
  {
    "text": "handle the like single machine GPU performance of you know optimizing the inference engine on a single uh piece of",
    "start": "2123520",
    "end": "2130720"
  },
  {
    "text": "Hardware right or on a single machine whereas Ray serve and any scale handle the multimachine scaling Auto scaling",
    "start": "2130720",
    "end": "2137520"
  },
  {
    "text": "scale to zero all these kinds of features High availability and all of the operational aspects around uh",
    "start": "2137520",
    "end": "2143720"
  },
  {
    "text": "running doing Serving and production exactly um now under our documentation on our website we have a lot of",
    "start": "2143720",
    "end": "2151000"
  },
  {
    "text": "different tutorials for serving more like traditional models to serving like deep learning ba BT based models today",
    "start": "2151000",
    "end": "2157240"
  },
  {
    "text": "of course we're we're going to focus on serving LM models everything we have we're going to show today you can create yourself configuration wise but we built",
    "start": "2157240",
    "end": "2164240"
  },
  {
    "text": "a really kind of useful CI for the service template so I'm going to go ahead and run that just to show what it looks like I like how traditional models",
    "start": "2164240",
    "end": "2170520"
  },
  {
    "text": "now refers to deep learning that's right things uh times have changed um so first thing it's going to ask you is kind of",
    "start": "2170520",
    "end": "2176520"
  },
  {
    "text": "the model ID you want to serve um and here obviously there's a couple that we support out of the box but you can really pass in uh any model from hugging",
    "start": "2176520",
    "end": "2183880"
  },
  {
    "text": "face hub for example um and I'm going to go ahead and uh I believe we fine-tuned",
    "start": "2183880",
    "end": "2189000"
  },
  {
    "text": "the uh metal Lama 3 8B instruct so I'm going to go ahead and paste that ID um",
    "start": "2189000",
    "end": "2194960"
  },
  {
    "text": "you're also going to uh if if you haven't already It'll ask you for the hugging face token in case you need to have access to that and GPU type here um",
    "start": "2194960",
    "end": "2202119"
  },
  {
    "text": "I'm just going to choose A10 uh to serve this model tensor parallelism uh I'm going to go with the default value here",
    "start": "2202119",
    "end": "2209119"
  },
  {
    "text": "now uh enable Laura serving so our find 11 instead of one oh but well let's uh",
    "start": "2209119",
    "end": "2214960"
  },
  {
    "text": "11 let's do 11 here um again that's like the flexibility of what you want and while this is a demo I think uh we'll",
    "start": "2214960",
    "end": "2221119"
  },
  {
    "text": "show kind of what that looks like um enable Laura serving we find H to model uh with Laura so we have those Lura that",
    "start": "2221119",
    "end": "2227680"
  },
  {
    "text": "those set of Weights available so I do want to say Yes um and while you're doing that just want to point out Laura",
    "start": "2227680",
    "end": "2234160"
  },
  {
    "text": "of course we talked about some of the advantages for fine tuning in terms of training speed but Laura also has a lot of advantages for serving in particular",
    "start": "2234160",
    "end": "2241280"
  },
  {
    "text": "if you have many different fine tuned models that you want to serve you do you want to have a separate pool of gpus for",
    "start": "2241280",
    "end": "2247200"
  },
  {
    "text": "each of those models or do you want to uh share the same base model and have",
    "start": "2247200",
    "end": "2252520"
  },
  {
    "text": "between all of the fine tun models and have a small number of adapters and this is something we can enable you to do out",
    "start": "2252520",
    "end": "2257800"
  },
  {
    "text": "of the box on any scales really uh can be way more resource efficient absolutely extremely efficient here um",
    "start": "2257800",
    "end": "2264560"
  },
  {
    "text": "and then obviously it'll ask for where those Lura weights are uh so I have our our location here I'm going to go ahead",
    "start": "2264560",
    "end": "2270400"
  },
  {
    "text": "and paste that and then it'll ask you the maximum number of replicas you want um so this is uh this is a demo here so",
    "start": "2270400",
    "end": "2276760"
  },
  {
    "text": "I'm going to not choose too many but you're welcome to have as many different replicas as you want I'm going to just keep it simple and have two um and then",
    "start": "2276760",
    "end": "2283400"
  },
  {
    "text": "it'll ask you if you want to further customize your config and apparent and obviously you can do this later as well on on your own um but these include",
    "start": "2283400",
    "end": "2290440"
  },
  {
    "text": "things like tensor parallelism and other configs I'll talk about a few other uh kind of changes that users may want to",
    "start": "2290440",
    "end": "2295599"
  },
  {
    "text": "do at the end but I'm going to say no here for now and it'll give you the option to start it locally uh so it'll",
    "start": "2295599",
    "end": "2301560"
  },
  {
    "text": "just spin that up and we'll query it I'm going to say no right now cuz I actually want to run it myself so I'll go ahead",
    "start": "2301560",
    "end": "2307040"
  },
  {
    "text": "and say no so this created configuration under this file uh this is just kind of a Tim stamp here so let's look at one",
    "start": "2307040",
    "end": "2312920"
  },
  {
    "text": "that I've already created um and you can see here that it basically has the lur path uh it's got if you've asked for any",
    "start": "2312920",
    "end": "2320000"
  },
  {
    "text": "any other kind of components here it'll have that um and now we're ready to actually serve this so what I'm going to",
    "start": "2320000",
    "end": "2325240"
  },
  {
    "text": "do is serve the model locally um and I'm going to all I have to do is kind of serve uh run this one oops I'm actually",
    "start": "2325240",
    "end": "2332400"
  },
  {
    "text": "going to run this on the terminal here",
    "start": "2332400",
    "end": "2337640"
  },
  {
    "text": "okay so now this is actually going to kick off locally um following the configuration that we have I believe we",
    "start": "2338599",
    "end": "2343760"
  },
  {
    "text": "just did two replicas so yes it'll kick off uh two uh instances of the lower model that we have and now we can",
    "start": "2343760",
    "end": "2350319"
  },
  {
    "text": "actually uh query this so um I'm going to you again you can query this however",
    "start": "2350319",
    "end": "2356200"
  },
  {
    "text": "you want I'd like to kind of stick with the same kind of uh schema conenction uh convention that we have from open AI so",
    "start": "2356200",
    "end": "2362359"
  },
  {
    "text": "uh I pass in a a system content and a user content and because in our model we",
    "start": "2362359",
    "end": "2368400"
  },
  {
    "text": "had the chat template we don't have to do this stuff manually so we can just uh just pass in text as we normally would",
    "start": "2368400",
    "end": "2375520"
  },
  {
    "text": "and all the templating all that will be done automatically under the hood so convenient exactly and again I'm going",
    "start": "2375520",
    "end": "2381000"
  },
  {
    "text": "to set temperature to zero and I'm going to say Stream True so we can see the outputs as they're coming so now let's query this locally uh you saw the inputs",
    "start": "2381000",
    "end": "2388000"
  },
  {
    "text": "Above This is local so I don't need to pass an actual key here but uh we'll show that in action in a bit as well um",
    "start": "2388000",
    "end": "2394079"
  },
  {
    "text": "but I just passed in uh one of the inputs from uh the data set um and uh",
    "start": "2394079",
    "end": "2399599"
  },
  {
    "text": "ask for it to generate the structured outputs all right so now we're going to go ahead and actually uh run this call",
    "start": "2399599",
    "end": "2404839"
  },
  {
    "text": "here uh and you can see here uh well logs are on the right side but um you can see the output and I think I",
    "start": "2404839",
    "end": "2410800"
  },
  {
    "text": "actually printed the output as well so that's why you see it twice but um looks like the right structured output that we're looking for nice awesome so now to",
    "start": "2410800",
    "end": "2419200"
  },
  {
    "text": "go to make this an actual Production service again uh you can alter the configuration maybe locally when you're",
    "start": "2419200",
    "end": "2425160"
  },
  {
    "text": "testing you did two replicas but maybe in production you want 200 um we're going you can play with the",
    "start": "2425160",
    "end": "2430359"
  },
  {
    "text": "configurations and to go to production all we have to do is actually uh deploy the service so uh with any scale we have",
    "start": "2430359",
    "end": "2436240"
  },
  {
    "text": "a command uh to use the same configuration and deploy it and when you run a service like this on a workspace",
    "start": "2436240",
    "end": "2441839"
  },
  {
    "text": "uh you got a little modal down here that says you know the service name of the service is deployed you can go ahead and click view the service or from our any",
    "start": "2441839",
    "end": "2448480"
  },
  {
    "text": "scale dashboard you can go over to Home and Services and you'll see it as well but this will take you directly to our main Central dashboard for the service",
    "start": "2448480",
    "end": "2455640"
  },
  {
    "text": "um you can see it's still spinning up right now but here anytime you or anybody ever makes a request for this uh uh service",
    "start": "2455640",
    "end": "2462839"
  },
  {
    "text": "here you'll see kind of um the QPS any errors that uh that are coming up the uh",
    "start": "2462839",
    "end": "2468720"
  },
  {
    "text": "kind of latency uh numbers as well um and one of my favorite Parts is the full logs um and I can you know kind of do it",
    "start": "2468720",
    "end": "2475880"
  },
  {
    "text": "by component the log like severity level time period And even regular Expressions",
    "start": "2475880",
    "end": "2481520"
  },
  {
    "text": "here as well nice that's fantastic um so let's go ahead and actually uh send a quick request here so",
    "start": "2481520",
    "end": "2487920"
  },
  {
    "text": "um the neat part about uh the service here is that up top I have a little query button um and here I have uh",
    "start": "2487920",
    "end": "2494960"
  },
  {
    "text": "information about like the actual URL uh that it's running in so I'm going to go ahead and copy that obviously you can",
    "start": "2494960",
    "end": "2500520"
  },
  {
    "text": "curl this command as well we've done it locally so far so now I'm going to uh Weill in these credentials using the um",
    "start": "2500520",
    "end": "2507000"
  },
  {
    "text": "kind of the query uh instructions from here so replace the URL and the special token as well um and I'm going to use",
    "start": "2507000",
    "end": "2513119"
  },
  {
    "text": "the same query function to now pass in these credentials instead and we can see the output is the same and it's the",
    "start": "2513119",
    "end": "2519160"
  },
  {
    "text": "correct output nice all right Robert so now we've seen",
    "start": "2519160",
    "end": "2526400"
  },
  {
    "text": "all four workloads together um and any kind of big takeaways well it's just",
    "start": "2526400",
    "end": "2532920"
  },
  {
    "text": "amazing to me typically if you go back before Ray or before an scale each of",
    "start": "2532920",
    "end": "2538040"
  },
  {
    "text": "these different boxes would have been a different framework or a different distributed system the fact that you can",
    "start": "2538040",
    "end": "2543680"
  },
  {
    "text": "handle the data workloads handle the training workloads handle the serving workloads evaluation all in the same",
    "start": "2543680",
    "end": "2551960"
  },
  {
    "text": "framework in the same system that's mind-blowing to me yeah and it didn't have to change context at all um you're",
    "start": "2551960",
    "end": "2558800"
  },
  {
    "text": "writing python code exactly um and there are obviously actually many things we haven't had a chance to show yet that",
    "start": "2558800",
    "end": "2564040"
  },
  {
    "text": "hopefully our users find through documentation and future webinars but um each of these things are have been",
    "start": "2564040",
    "end": "2570040"
  },
  {
    "text": "completely isolated and can be combined or uh be uh kind of stay separate and we",
    "start": "2570040",
    "end": "2575680"
  },
  {
    "text": "can launch kind of Productions of all these and for example uh we took our model that we serve locally and we went",
    "start": "2575680",
    "end": "2581680"
  },
  {
    "text": "to production with one line and we went to production in very highly scalable and reliable manner we could have done",
    "start": "2581680",
    "end": "2588079"
  },
  {
    "text": "the same for the other workloads as well for example our data pre-processing step or our uh model fine-tuning aspect those",
    "start": "2588079",
    "end": "2594359"
  },
  {
    "text": "again also one line to take that script that does that said workload and run it as an anyscale job these are kind of",
    "start": "2594359",
    "end": "2600240"
  },
  {
    "text": "isolated workloads that people could execute manually attach uh web hooks to happen on certain uh kind of actions M",
    "start": "2600240",
    "end": "2607440"
  },
  {
    "text": "and it's just a great way to kind of create um great cicd workflow around all these yeah I mean I think for someone",
    "start": "2607440",
    "end": "2613440"
  },
  {
    "text": "just casually watching this it may have just felt like writing python code on your laptop it feels like just",
    "start": "2613440",
    "end": "2619520"
  },
  {
    "text": "developing in a notebook or developing in your in vs code but whatever",
    "start": "2619520",
    "end": "2624720"
  },
  {
    "text": "resources you need when you needed a GPU for training or multiple gpus they were there when you needed a larger cluster",
    "start": "2624720",
    "end": "2630359"
  },
  {
    "text": "for the data processing it's there and when you don't need them they're gone right like the fact that you can really",
    "start": "2630359",
    "end": "2637240"
  },
  {
    "text": "enable people who know how to program in in Python to uh do all of these workloads at scale without needing to",
    "start": "2637240",
    "end": "2644000"
  },
  {
    "text": "learn about the scheduling and the fault tolerance and the distributed systems that's uh to me one of the most",
    "start": "2644000",
    "end": "2649200"
  },
  {
    "text": "impressive Parts exactly and I didn't have to make any compromises on the tools that I could use so uh you know",
    "start": "2649200",
    "end": "2655160"
  },
  {
    "text": "coming from kind of a local Laptop World to running a lot workloads now still get to use my favorite tools both from the",
    "start": "2655160",
    "end": "2661760"
  },
  {
    "text": "IDE standpoint but also specific libraries py toch hugging face Integrations with great tools as well um",
    "start": "2661760",
    "end": "2667599"
  },
  {
    "text": "I kind of bring in my world or my world of machine learning and be able to run these uh same workloads at a very large",
    "start": "2667599",
    "end": "2674119"
  },
  {
    "text": "scale absolutely and you showcase this but open source is really the foundation of of uh the AI ecosystem you mentioned",
    "start": "2674119",
    "end": "2681480"
  },
  {
    "text": "pytorch of course and deep speed and VM and Ray and all of these different tools and these are hugging phase and these",
    "start": "2681480",
    "end": "2686839"
  },
  {
    "text": "are really work together to to make AI possible awesome Robert so we just went through this but um how can our users",
    "start": "2686839",
    "end": "2693319"
  },
  {
    "text": "actually get started with this and then start to use it for their own applications that's a great question so",
    "start": "2693319",
    "end": "2698520"
  },
  {
    "text": "Goku put together these you put together these fantastic notebooks and now I personally want to try them out so what",
    "start": "2698520",
    "end": "2705760"
  },
  {
    "text": "our anyone watching can do is they can go to nysc.com and on nysc.com there's",
    "start": "2705760",
    "end": "2712720"
  },
  {
    "text": "going to be a button that says try this out and what you're going to have to do is click on that button and you'll have",
    "start": "2712720",
    "end": "2717760"
  },
  {
    "text": "access to everything that Goku just showed you so um you'll be able to do the data prep you'll be able to",
    "start": "2717760",
    "end": "2723280"
  },
  {
    "text": "fine-tune the models deploy the models do evaluation uh we have templates for everything so it's going to be fantastic",
    "start": "2723280",
    "end": "2729720"
  },
  {
    "text": "and this was a pretty lean tutorial where we weren't really using too large of data sets but it still involves kind",
    "start": "2729720",
    "end": "2736400"
  },
  {
    "text": "of training models and stuff are uh do users get some kind of free credit yeah there are free credits to uh get started",
    "start": "2736400",
    "end": "2741800"
  },
  {
    "text": "and and try things out hopefully our users found all this useful and we look forward to sharing more capabilities in",
    "start": "2741800",
    "end": "2747000"
  },
  {
    "text": "the future yeah lots more to come",
    "start": "2747000",
    "end": "2751079"
  }
]