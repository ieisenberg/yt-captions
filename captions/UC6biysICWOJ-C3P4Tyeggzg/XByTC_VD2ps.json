[
  {
    "text": "ladies and gentlemen boys and girls EA",
    "start": "320",
    "end": "3760"
  },
  {
    "text": "released the source code for Command and",
    "start": "3760",
    "end": "5839"
  },
  {
    "text": "Conquer Generals: Zero Hour this",
    "start": "5839",
    "end": "7759"
  },
  {
    "text": "happened about two months ago in a rare",
    "start": "7759",
    "end": "10000"
  },
  {
    "text": "EAW to try to support the modding",
    "start": "10000",
    "end": "12240"
  },
  {
    "text": "community to give them access to the",
    "start": "12240",
    "end": "13679"
  },
  {
    "text": "source code so that they can make",
    "start": "13679",
    "end": "15040"
  },
  {
    "text": "modifications to this beloved game from",
    "start": "15040",
    "end": "17840"
  },
  {
    "text": "2003 very very old you can see here by",
    "start": "17840",
    "end": "20800"
  },
  {
    "text": "the box you know back when you used to",
    "start": "20800",
    "end": "22160"
  },
  {
    "text": "buy video games that came in a box",
    "start": "22160",
    "end": "23840"
  },
  {
    "text": "glorious times to be a kid i was in",
    "start": "23840",
    "end": "25920"
  },
  {
    "text": "third grade in 03 and the graphics just",
    "start": "25920",
    "end": "28720"
  },
  {
    "text": "uh captivating but honestly this is one",
    "start": "28720",
    "end": "30720"
  },
  {
    "text": "of my favorite eras of gaming cuz the",
    "start": "30720",
    "end": "33040"
  },
  {
    "text": "games were so simple but they were so",
    "start": "33040",
    "end": "34719"
  },
  {
    "text": "fun to play you get your friends on a",
    "start": "34719",
    "end": "36559"
  },
  {
    "text": "land network and you'd get together and",
    "start": "36559",
    "end": "38399"
  },
  {
    "text": "you would just throw armies at each",
    "start": "38399",
    "end": "40879"
  },
  {
    "text": "other and have a grand old time now the",
    "start": "40879",
    "end": "43360"
  },
  {
    "text": "source code for these games is available",
    "start": "43360",
    "end": "45600"
  },
  {
    "text": "it came out on February 7th of this year",
    "start": "45600",
    "end": "48239"
  },
  {
    "text": "now note that the assets of the game are",
    "start": "48239",
    "end": "50559"
  },
  {
    "text": "not included that is still EA",
    "start": "50559",
    "end": "51840"
  },
  {
    "text": "proprietary so while the source code is",
    "start": "51840",
    "end": "53920"
  },
  {
    "text": "available you cannot compile it you",
    "start": "53920",
    "end": "55840"
  },
  {
    "text": "can't just build the game from scratch",
    "start": "55840",
    "end": "57840"
  },
  {
    "text": "now as a good hacker that is what I am i",
    "start": "57840",
    "end": "60480"
  },
  {
    "text": "am a hacker i'm an offensive security",
    "start": "60480",
    "end": "62640"
  },
  {
    "text": "researcher i'm a security engineer i",
    "start": "62640",
    "end": "64478"
  },
  {
    "text": "wanted to look into what's going on in",
    "start": "64479",
    "end": "66720"
  },
  {
    "text": "the code of this game is there anything",
    "start": "66720",
    "end": "68400"
  },
  {
    "text": "spicy is there anything fun that we",
    "start": "68400",
    "end": "70000"
  },
  {
    "text": "could look at that may be a network",
    "start": "70000",
    "end": "72320"
  },
  {
    "text": "attack surface how is the security of",
    "start": "72320",
    "end": "74400"
  },
  {
    "text": "this game and so I did this you can go",
    "start": "74400",
    "end": "77280"
  },
  {
    "text": "into the source code of the game and you",
    "start": "77280",
    "end": "79200"
  },
  {
    "text": "know read all the source code files that",
    "start": "79200",
    "end": "80960"
  },
  {
    "text": "you want but as a hacker I am",
    "start": "80960",
    "end": "83200"
  },
  {
    "text": "immediately drawn to things like game",
    "start": "83200",
    "end": "85920"
  },
  {
    "text": "network ooh how does the network code",
    "start": "85920",
    "end": "88400"
  },
  {
    "text": "work in this game if me and my buddies",
    "start": "88400",
    "end": "90560"
  },
  {
    "text": "are on a LAN network can I hack into",
    "start": "90560",
    "end": "92720"
  },
  {
    "text": "their computer because they're using",
    "start": "92720",
    "end": "94320"
  },
  {
    "text": "this game and it's written improperly",
    "start": "94320",
    "end": "96560"
  },
  {
    "text": "understand that this game was written in",
    "start": "96560",
    "end": "99119"
  },
  {
    "text": "2003 this is well before cyber security",
    "start": "99119",
    "end": "102479"
  },
  {
    "text": "was the thing code just had to kind of",
    "start": "102479",
    "end": "104560"
  },
  {
    "text": "work and when it works okay good this is",
    "start": "104560",
    "end": "106720"
  },
  {
    "text": "back before like the MS0867 like just",
    "start": "106720",
    "end": "110000"
  },
  {
    "text": "the word zero day was barely a thing so",
    "start": "110000",
    "end": "112479"
  },
  {
    "text": "this is a a crazy time in computing",
    "start": "112479",
    "end": "114799"
  },
  {
    "text": "where it was kind of just the wild west",
    "start": "114799",
    "end": "116399"
  },
  {
    "text": "shooting off the the cuff and just",
    "start": "116399",
    "end": "117759"
  },
  {
    "text": "hoping that the code works i was going",
    "start": "117759",
    "end": "119280"
  },
  {
    "text": "through this code and there's a lot of",
    "start": "119280",
    "end": "120799"
  },
  {
    "text": "code to go through and in this video I'm",
    "start": "120799",
    "end": "122240"
  },
  {
    "text": "not going to cover all of it understand",
    "start": "122240",
    "end": "123680"
  },
  {
    "text": "that this code was written by an entire",
    "start": "123680",
    "end": "126159"
  },
  {
    "text": "dev team an entire team of engineers",
    "start": "126159",
    "end": "128720"
  },
  {
    "text": "over the course of multiple years i",
    "start": "128720",
    "end": "130560"
  },
  {
    "text": "don't have that kind of time i'm a dad",
    "start": "130560",
    "end": "132560"
  },
  {
    "text": "but there are some fun little tidbits",
    "start": "132560",
    "end": "134400"
  },
  {
    "text": "this video will go through the first one",
    "start": "134400",
    "end": "135760"
  },
  {
    "text": "you see here is lobby port right we want",
    "start": "135760",
    "end": "138239"
  },
  {
    "text": "to figure out you know if there is",
    "start": "138239",
    "end": "139840"
  },
  {
    "text": "network attack surface how do I get",
    "start": "139840",
    "end": "141920"
  },
  {
    "text": "access to it what port do I have to hit",
    "start": "141920",
    "end": "144400"
  },
  {
    "text": "to open up another person's computer is",
    "start": "144400",
    "end": "146720"
  },
  {
    "text": "there any fun stuff that I can inject",
    "start": "146720",
    "end": "148720"
  },
  {
    "text": "into that port and right off the bat so",
    "start": "148720",
    "end": "150560"
  },
  {
    "text": "in this room is my studio for YouTube i",
    "start": "150560",
    "end": "152720"
  },
  {
    "text": "have my actual personal office in the",
    "start": "152720",
    "end": "154400"
  },
  {
    "text": "other room I have Command and Conquer",
    "start": "154400",
    "end": "156319"
  },
  {
    "text": "running and you'll see here that in that",
    "start": "156319",
    "end": "158560"
  },
  {
    "text": "room I have it open in a game right so I",
    "start": "158560",
    "end": "160879"
  },
  {
    "text": "made a local area network game a LAN",
    "start": "160879",
    "end": "163120"
  },
  {
    "text": "game and you can see right off the cuff",
    "start": "163120",
    "end": "165840"
  },
  {
    "text": "that that computer is broadcasting on",
    "start": "165840",
    "end": "167760"
  },
  {
    "text": "port 8086 which is kind of cute right",
    "start": "167760",
    "end": "170160"
  },
  {
    "text": "because first of all this is the port",
    "start": "170160",
    "end": "172239"
  },
  {
    "text": "that is indicated in the source code so",
    "start": "172239",
    "end": "173760"
  },
  {
    "text": "we kind of have like a reality anchor",
    "start": "173760",
    "end": "175280"
  },
  {
    "text": "cool like it's doing what we think it's",
    "start": "175280",
    "end": "176640"
  },
  {
    "text": "supposed to do and also 8086 is the uh",
    "start": "176640",
    "end": "179840"
  },
  {
    "text": "the short name of the Intel processor",
    "start": "179840",
    "end": "182239"
  },
  {
    "text": "from a million years ago so that's",
    "start": "182239",
    "end": "183920"
  },
  {
    "text": "that's kind of fun too now if we go into",
    "start": "183920",
    "end": "186159"
  },
  {
    "text": "this source code we can do the hacker",
    "start": "186159",
    "end": "187680"
  },
  {
    "text": "thing and we can zoom in and we can",
    "start": "187680",
    "end": "189120"
  },
  {
    "text": "enhance and we see that you know it's",
    "start": "189120",
    "end": "191360"
  },
  {
    "text": "kind of emitting the same content over",
    "start": "191360",
    "end": "192959"
  },
  {
    "text": "and over again but you will see that",
    "start": "192959",
    "end": "194959"
  },
  {
    "text": "this content is slightly changing and",
    "start": "194959",
    "end": "197760"
  },
  {
    "text": "also it's kind of just garbage right",
    "start": "197760",
    "end": "199599"
  },
  {
    "text": "it's kind of just gobblelygy there's",
    "start": "199599",
    "end": "201120"
  },
  {
    "text": "nothing super fun in there so I guess",
    "start": "201120",
    "end": "203680"
  },
  {
    "text": "our adventures are done no obviously",
    "start": "203680",
    "end": "206640"
  },
  {
    "text": "this is lowlevel man this is a channel",
    "start": "206640",
    "end": "208319"
  },
  {
    "text": "where we hack stuff what you can go into",
    "start": "208319",
    "end": "210560"
  },
  {
    "text": "actually is you can read through the",
    "start": "210560",
    "end": "212239"
  },
  {
    "text": "source code and maybe they're doing a a",
    "start": "212239",
    "end": "214720"
  },
  {
    "text": "key exchange where you know you have to",
    "start": "214720",
    "end": "216720"
  },
  {
    "text": "connect to it over TLS and be given a",
    "start": "216720",
    "end": "219599"
  },
  {
    "text": "sensitive key that you use to encrypt",
    "start": "219599",
    "end": "221280"
  },
  {
    "text": "and decrypt traffic or maybe they're",
    "start": "221280",
    "end": "224879"
  },
  {
    "text": "using exor encryption which mind you is",
    "start": "224879",
    "end": "227920"
  },
  {
    "text": "is not encryption period full stop not",
    "start": "227920",
    "end": "230799"
  },
  {
    "text": "encryption uh this is kind of funny",
    "start": "230799",
    "end": "233120"
  },
  {
    "text": "right so again this is 2003 this is back",
    "start": "233120",
    "end": "235519"
  },
  {
    "text": "before cyber security was really a thing",
    "start": "235519",
    "end": "237760"
  },
  {
    "text": "uh so they have these two functions",
    "start": "237760",
    "end": "239519"
  },
  {
    "text": "called encrypt buff and decrypt buff and",
    "start": "239519",
    "end": "241599"
  },
  {
    "text": "there are actually a like a lot of funny",
    "start": "241599",
    "end": "243439"
  },
  {
    "text": "things that happen inside of this",
    "start": "243439",
    "end": "245439"
  },
  {
    "text": "function so if you don't know if you're",
    "start": "245439",
    "end": "246480"
  },
  {
    "text": "not in the world of cyber security in",
    "start": "246480",
    "end": "248319"
  },
  {
    "text": "exor is not encryption to do encryption",
    "start": "248319",
    "end": "251680"
  },
  {
    "text": "typically fisal networks right that are",
    "start": "251680",
    "end": "253920"
  },
  {
    "text": "used inside of encryption algorithms",
    "start": "253920",
    "end": "256160"
  },
  {
    "text": "will do exor operations but there's a",
    "start": "256160",
    "end": "258320"
  },
  {
    "text": "ton of shifting and substitutions and",
    "start": "258320",
    "end": "261120"
  },
  {
    "text": "like mathematical hardening on",
    "start": "261120",
    "end": "262639"
  },
  {
    "text": "encryption that make it more secure than",
    "start": "262639",
    "end": "264479"
  },
  {
    "text": "just doing the exclusive or operation so",
    "start": "264479",
    "end": "268000"
  },
  {
    "text": "in encrypt buff for example what it does",
    "start": "268000",
    "end": "270240"
  },
  {
    "text": "is it takes a mask the mask is just the",
    "start": "270240",
    "end": "272160"
  },
  {
    "text": "value that you're going to encrypt with",
    "start": "272160",
    "end": "274080"
  },
  {
    "text": "and they set it to some default value i",
    "start": "274080",
    "end": "276960"
  },
  {
    "text": "will say the first very interesting kind",
    "start": "276960",
    "end": "279280"
  },
  {
    "text": "of funny part is that they use a Uint",
    "start": "279280",
    "end": "281919"
  },
  {
    "text": "pointer which for the Intel architecture",
    "start": "281919",
    "end": "283680"
  },
  {
    "text": "is a four byte wide or a four byt wide",
    "start": "283680",
    "end": "286800"
  },
  {
    "text": "type but then they leave the first two",
    "start": "286800",
    "end": "289360"
  },
  {
    "text": "bytes of the mask as zero and anything",
    "start": "289360",
    "end": "292800"
  },
  {
    "text": "xor zero is itself so they are by",
    "start": "292800",
    "end": "295759"
  },
  {
    "text": "default just not encrypting every two",
    "start": "295759",
    "end": "298560"
  },
  {
    "text": "bytes so what they do is they take a",
    "start": "298560",
    "end": "300160"
  },
  {
    "text": "pointer to the buffer they cast it as an",
    "start": "300160",
    "end": "301840"
  },
  {
    "text": "unintent pointer so they're pointing to",
    "start": "301840",
    "end": "303199"
  },
  {
    "text": "every four byte chunks and they're going",
    "start": "303199",
    "end": "304560"
  },
  {
    "text": "to exor it they're going to say the",
    "start": "304560",
    "end": "306080"
  },
  {
    "text": "thing pointed to with the pointer is",
    "start": "306080",
    "end": "307600"
  },
  {
    "text": "equal to itself exor the mask they do",
    "start": "307600",
    "end": "310320"
  },
  {
    "text": "just for fun they increment the mask",
    "start": "310320",
    "end": "312800"
  },
  {
    "text": "they make the mask a little bigger so",
    "start": "312800",
    "end": "314240"
  },
  {
    "text": "that they're changing the exor value as",
    "start": "314240",
    "end": "316160"
  },
  {
    "text": "they kind of run down the packet but",
    "start": "316160",
    "end": "317919"
  },
  {
    "text": "they're they're incrementing it by such",
    "start": "317919",
    "end": "319840"
  },
  {
    "text": "a small value that for multiple",
    "start": "319840",
    "end": "322560"
  },
  {
    "text": "operations for like multiple iterations",
    "start": "322560",
    "end": "325199"
  },
  {
    "text": "of of exor encrypting this encrypting",
    "start": "325199",
    "end": "327280"
  },
  {
    "text": "this the value is still going to have",
    "start": "327280",
    "end": "329039"
  },
  {
    "text": "these zeros up up in the upper nibble of",
    "start": "329039",
    "end": "331280"
  },
  {
    "text": "the word so there's just going to be no",
    "start": "331280",
    "end": "333360"
  },
  {
    "text": "encryption on those things again I keep",
    "start": "333360",
    "end": "334880"
  },
  {
    "text": "saying encryption it's it's encryption",
    "start": "334880",
    "end": "336240"
  },
  {
    "text": "in in air decrypt buff functionality is",
    "start": "336240",
    "end": "338720"
  },
  {
    "text": "the same one more thing that's kind of",
    "start": "338720",
    "end": "340000"
  },
  {
    "text": "funny this assumes the buffer is a",
    "start": "340000",
    "end": "342160"
  },
  {
    "text": "multiple of four bytes the extra is not",
    "start": "342160",
    "end": "344479"
  },
  {
    "text": "encrypted which means that like if you",
    "start": "344479",
    "end": "346479"
  },
  {
    "text": "have a packet that is 281 bytes the",
    "start": "346479",
    "end": "349880"
  },
  {
    "text": "281st bite will not be encrypted but",
    "start": "349880",
    "end": "352880"
  },
  {
    "text": "also by this logic it won't be Indian",
    "start": "352880",
    "end": "355199"
  },
  {
    "text": "corrected but meaning it like it won't",
    "start": "355199",
    "end": "356720"
  },
  {
    "text": "be properly stored for network traffic",
    "start": "356720",
    "end": "359039"
  },
  {
    "text": "which is also kind of weird uh but yeah",
    "start": "359039",
    "end": "361280"
  },
  {
    "text": "anyways that's super fun this is a",
    "start": "361280",
    "end": "363120"
  },
  {
    "text": "function that is called to handle all",
    "start": "363120",
    "end": "365680"
  },
  {
    "text": "inbound traffic for the game there's a",
    "start": "365680",
    "end": "368400"
  },
  {
    "text": "bunch of debug stuff here basically this",
    "start": "368400",
    "end": "370400"
  },
  {
    "text": "is code that would be included in a",
    "start": "370400",
    "end": "371759"
  },
  {
    "text": "debug build for the developers so they",
    "start": "371759",
    "end": "373680"
  },
  {
    "text": "can see oh you know was there packet",
    "start": "373680",
    "end": "375919"
  },
  {
    "text": "loss oh you know um what time is it now",
    "start": "375919",
    "end": "378479"
  },
  {
    "text": "stuff like this just to help them debug",
    "start": "378479",
    "end": "379759"
  },
  {
    "text": "the game but when we eventually get a",
    "start": "379759",
    "end": "381680"
  },
  {
    "text": "receive what the receive does is it",
    "start": "381680",
    "end": "383360"
  },
  {
    "text": "reads off that UDP socket that 8 uh",
    "start": "383360",
    "end": "385639"
  },
  {
    "text": "80086 to a max message length value into",
    "start": "385639",
    "end": "388880"
  },
  {
    "text": "an incoming or actually no into a buffer",
    "start": "388880",
    "end": "390960"
  },
  {
    "text": "right we have this buffer here they",
    "start": "390960",
    "end": "392720"
  },
  {
    "text": "decrypt the buffer which is great it",
    "start": "392720",
    "end": "394639"
  },
  {
    "text": "makes sense we're going to unwrap all",
    "start": "394639",
    "end": "395919"
  },
  {
    "text": "that that wrapping we did to encrypt it",
    "start": "395919",
    "end": "398080"
  },
  {
    "text": "and then we're going to call this",
    "start": "398080",
    "end": "398960"
  },
  {
    "text": "function called is general packet ooh",
    "start": "398960",
    "end": "401440"
  },
  {
    "text": "what is an is general packet so they do",
    "start": "401440",
    "end": "403919"
  },
  {
    "text": "another kind of weird archaic thing they",
    "start": "403919",
    "end": "406240"
  },
  {
    "text": "compute a CRC on the packet it's a cycl",
    "start": "406240",
    "end": "409199"
  },
  {
    "text": "cyclical redundancy check which",
    "start": "409199",
    "end": "411120"
  },
  {
    "text": "basically just means we want to see is",
    "start": "411120",
    "end": "414080"
  },
  {
    "text": "the data in the packet right is the sum",
    "start": "414080",
    "end": "417120"
  },
  {
    "text": "of all that data equal to the indicated",
    "start": "417120",
    "end": "420400"
  },
  {
    "text": "sum right we're doing this to see if",
    "start": "420400",
    "end": "421759"
  },
  {
    "text": "there are random bit flips on the wire",
    "start": "421759",
    "end": "423599"
  },
  {
    "text": "we're doing this to see if there are",
    "start": "423599",
    "end": "424960"
  },
  {
    "text": "random errors in the packet it also acts",
    "start": "424960",
    "end": "427520"
  },
  {
    "text": "as kind of like a do you know who you're",
    "start": "427520",
    "end": "429520"
  },
  {
    "text": "talking to like are you and I talking in",
    "start": "429520",
    "end": "431360"
  },
  {
    "text": "the same protocol because if you and I",
    "start": "431360",
    "end": "433120"
  },
  {
    "text": "don't do the same CRC you know maybe",
    "start": "433120",
    "end": "435440"
  },
  {
    "text": "that means that you're not supposed to",
    "start": "435440",
    "end": "436560"
  },
  {
    "text": "talk to me and I can drop the packet so",
    "start": "436560",
    "end": "438319"
  },
  {
    "text": "what it does is the is general's packet",
    "start": "438319",
    "end": "440080"
  },
  {
    "text": "is like a sanity check to see is this",
    "start": "440080",
    "end": "442319"
  },
  {
    "text": "person speaking my language should I",
    "start": "442319",
    "end": "444319"
  },
  {
    "text": "even continue to process this packet now",
    "start": "444319",
    "end": "446800"
  },
  {
    "text": "what they do is they say okay is the CRC",
    "start": "446800",
    "end": "450080"
  },
  {
    "text": "of the data right calculate the CRC of",
    "start": "450080",
    "end": "452639"
  },
  {
    "text": "the data is it equal to the CRC",
    "start": "452639",
    "end": "455919"
  },
  {
    "text": "indicated in the packet okay and if it",
    "start": "455919",
    "end": "458400"
  },
  {
    "text": "isn't drop the packet otherwise continue",
    "start": "458400",
    "end": "461039"
  },
  {
    "text": "and then if the CRC of the packet or",
    "start": "461039",
    "end": "463520"
  },
  {
    "text": "sorry if the header of the packet is",
    "start": "463520",
    "end": "464960"
  },
  {
    "text": "equal to this general's magic number and",
    "start": "464960",
    "end": "466960"
  },
  {
    "text": "we're going to see that that it's",
    "start": "466960",
    "end": "468080"
  },
  {
    "text": "actually pretty funny here in a second",
    "start": "468080",
    "end": "469440"
  },
  {
    "text": "uh if it's not equal to this general's",
    "start": "469440",
    "end": "471039"
  },
  {
    "text": "magic number drop the packet otherwise",
    "start": "471039",
    "end": "473039"
  },
  {
    "text": "it is a general's packet let's continue",
    "start": "473039",
    "end": "475360"
  },
  {
    "text": "processing it now you will see that uh",
    "start": "475360",
    "end": "478160"
  },
  {
    "text": "if I go and control shift F for",
    "start": "478160",
    "end": "480560"
  },
  {
    "text": "general's magic number the general's",
    "start": "480560",
    "end": "483599"
  },
  {
    "text": "magic number is equal to drum roll food",
    "start": "483599",
    "end": "486720"
  },
  {
    "text": "it's food the number is food so that I",
    "start": "486720",
    "end": "489680"
  },
  {
    "text": "thought that was pretty funny we kind of",
    "start": "489680",
    "end": "490879"
  },
  {
    "text": "are we're we're taking the building",
    "start": "490879",
    "end": "492240"
  },
  {
    "text": "blocks and we now know generally what",
    "start": "492240",
    "end": "494800"
  },
  {
    "text": "needs to be accomplished to to take",
    "start": "494800",
    "end": "497520"
  },
  {
    "text": "these messages apart and so I wrote a",
    "start": "497520",
    "end": "499680"
  },
  {
    "text": "little nifty scripty uh that that",
    "start": "499680",
    "end": "502280"
  },
  {
    "text": "literally reimplements the functionality",
    "start": "502280",
    "end": "505280"
  },
  {
    "text": "that was done in C in Python because the",
    "start": "505280",
    "end": "507919"
  },
  {
    "text": "reason I want to use Python is Python",
    "start": "507919",
    "end": "509440"
  },
  {
    "text": "has this thing called scape uh where",
    "start": "509440",
    "end": "511599"
  },
  {
    "text": "scape is a library for Python you can",
    "start": "511599",
    "end": "514240"
  },
  {
    "text": "read traffic off the network and use",
    "start": "514240",
    "end": "515839"
  },
  {
    "text": "that to like pull packets out and like",
    "start": "515839",
    "end": "517680"
  },
  {
    "text": "they come in a a bite string for Python",
    "start": "517680",
    "end": "519440"
  },
  {
    "text": "so you can like manipulate them uh but",
    "start": "519440",
    "end": "521279"
  },
  {
    "text": "also Scapy allows you to inject packets",
    "start": "521279",
    "end": "523518"
  },
  {
    "text": "so in theory if we can decrypt and",
    "start": "523519",
    "end": "526320"
  },
  {
    "text": "validate the CRC and the magic value we",
    "start": "526320",
    "end": "529040"
  },
  {
    "text": "then could also replay the CRC replay",
    "start": "529040",
    "end": "532160"
  },
  {
    "text": "the magic value and inject our own",
    "start": "532160",
    "end": "534000"
  },
  {
    "text": "packets without having the game source",
    "start": "534000",
    "end": "535920"
  },
  {
    "text": "code running which is kind of a cool",
    "start": "535920",
    "end": "537040"
  },
  {
    "text": "concept we use scape to sniff a sniff is",
    "start": "537040",
    "end": "540160"
  },
  {
    "text": "a scape function we simp for all UDP on",
    "start": "540160",
    "end": "542560"
  },
  {
    "text": "port 8086 and we decrypt it and I print",
    "start": "542560",
    "end": "545360"
  },
  {
    "text": "the decrypted packet both in hex and raw",
    "start": "545360",
    "end": "548000"
  },
  {
    "text": "and you can see right here there is now",
    "start": "548000",
    "end": "551279"
  },
  {
    "text": "plain text data there's a lot of garbage",
    "start": "551279",
    "end": "553040"
  },
  {
    "text": "here there's a lot of garbage going on",
    "start": "553040",
    "end": "554560"
  },
  {
    "text": "the screen but I want to show you some",
    "start": "554560",
    "end": "555600"
  },
  {
    "text": "interesting things um first of all you",
    "start": "555600",
    "end": "558399"
  },
  {
    "text": "will see this / r/fu which also happens",
    "start": "558399",
    "end": "561040"
  },
  {
    "text": "here",
    "start": "561040",
    "end": "562600"
  },
  {
    "text": "/dfo that's the magic value that is the",
    "start": "562600",
    "end": "566000"
  },
  {
    "text": "uh general's magic number that must be",
    "start": "566000",
    "end": "568160"
  },
  {
    "text": "indicated in the packet to make sure",
    "start": "568160",
    "end": "570240"
  },
  {
    "text": "that it is actually our number also",
    "start": "570240",
    "end": "572160"
  },
  {
    "text": "you'll see there is this other magic",
    "start": "572160",
    "end": "573519"
  },
  {
    "text": "value that is not a magic value that is",
    "start": "573519",
    "end": "574880"
  },
  {
    "text": "the CRC that is the calculated CRC value",
    "start": "574880",
    "end": "578080"
  },
  {
    "text": "of the packet that we have to validate",
    "start": "578080",
    "end": "580080"
  },
  {
    "text": "as a receiver to make sure that it's",
    "start": "580080",
    "end": "581519"
  },
  {
    "text": "actually a sane uh general's packet",
    "start": "581519",
    "end": "583920"
  },
  {
    "text": "right and then after that you'll see",
    "start": "583920",
    "end": "585360"
  },
  {
    "text": "some pretty interesting asky text so",
    "start": "585360",
    "end": "587120"
  },
  {
    "text": "like I said in my other computer I have",
    "start": "587120",
    "end": "589360"
  },
  {
    "text": "a a uh a user of this game sitting in a",
    "start": "589360",
    "end": "592720"
  },
  {
    "text": "lobby waiting for other people to join",
    "start": "592720",
    "end": "594560"
  },
  {
    "text": "so inside this LAN API.h function we can",
    "start": "594560",
    "end": "597440"
  },
  {
    "text": "actually see all of the different types",
    "start": "597440",
    "end": "599279"
  },
  {
    "text": "of messages that can be sent in this",
    "start": "599279",
    "end": "601760"
  },
  {
    "text": "lobby context right we have from zero",
    "start": "601760",
    "end": "604560"
  },
  {
    "text": "request locations game announce all the",
    "start": "604560",
    "end": "606720"
  },
  {
    "text": "way up to 0 1 2 3 4 5 6 7 8 9 10 11 12",
    "start": "606720",
    "end": "612480"
  },
  {
    "text": "13 so what we're actually advertising",
    "start": "612480",
    "end": "615360"
  },
  {
    "text": "here is that we are advertising hey a",
    "start": "615360",
    "end": "618320"
  },
  {
    "text": "game exists these are the options that",
    "start": "618320",
    "end": "621120"
  },
  {
    "text": "are currently present in the game",
    "start": "621120",
    "end": "622720"
  },
  {
    "text": "there's a lot of fun things here like we",
    "start": "622720",
    "end": "624640"
  },
  {
    "text": "have the map that the game is playing we",
    "start": "624640",
    "end": "627279"
  },
  {
    "text": "have the uh the CRC of my binary to make",
    "start": "627279",
    "end": "630320"
  },
  {
    "text": "sure that me and the opposite player are",
    "start": "630320",
    "end": "632240"
  },
  {
    "text": "playing the same version of the game i",
    "start": "632240",
    "end": "634000"
  },
  {
    "text": "have my serial number to make sure that",
    "start": "634000",
    "end": "635760"
  },
  {
    "text": "they are not me right i can't join my",
    "start": "635760",
    "end": "637760"
  },
  {
    "text": "own game and also here there's this fun",
    "start": "637760",
    "end": "639519"
  },
  {
    "text": "little string which basically says um",
    "start": "639519",
    "end": "641519"
  },
  {
    "text": "all of the slots in the game right so",
    "start": "641519",
    "end": "644000"
  },
  {
    "text": "you have 1 2 1 all of the slots in the",
    "start": "644000",
    "end": "647680"
  },
  {
    "text": "game and who is currently occupying them",
    "start": "647680",
    "end": "649920"
  },
  {
    "text": "what team right team one is like you",
    "start": "649920",
    "end": "651440"
  },
  {
    "text": "know my team team two is is the enemy",
    "start": "651440",
    "end": "653200"
  },
  {
    "text": "team negative 1 negative one I think are",
    "start": "653200",
    "end": "654959"
  },
  {
    "text": "closed and these are like AI slots right",
    "start": "654959",
    "end": "656720"
  },
  {
    "text": "so there's fun little stuff that right",
    "start": "656720",
    "end": "657839"
  },
  {
    "text": "there a bunch of other cool uh you know",
    "start": "657839",
    "end": "660000"
  },
  {
    "text": "just metadata about the game now again",
    "start": "660000",
    "end": "662640"
  },
  {
    "text": "this is a a piece of code base written",
    "start": "662640",
    "end": "664320"
  },
  {
    "text": "by a team over the course of several",
    "start": "664320",
    "end": "666079"
  },
  {
    "text": "years i'm not going to reverse engineer",
    "start": "666079",
    "end": "667360"
  },
  {
    "text": "all of it uh but you can see now I have",
    "start": "667360",
    "end": "669120"
  },
  {
    "text": "the you know the player uh lowlevel X",
    "start": "669120",
    "end": "672160"
  },
  {
    "text": "right here you know just like back in",
    "start": "672160",
    "end": "673600"
  },
  {
    "text": "the old days xx Lowle XX Death by",
    "start": "673600",
    "end": "676720"
  },
  {
    "text": "Night24 like just it's just fun okay so",
    "start": "676720",
    "end": "679120"
  },
  {
    "text": "I just went to my other computer um and",
    "start": "679120",
    "end": "680880"
  },
  {
    "text": "I sent a chat message in the game now",
    "start": "680880",
    "end": "683600"
  },
  {
    "text": "you can see that it's a chat message",
    "start": "683600",
    "end": "685440"
  },
  {
    "text": "here by looking at this again these four",
    "start": "685440",
    "end": "687680"
  },
  {
    "text": "bytes are the CRC of the packet this RFO",
    "start": "687680",
    "end": "692000"
  },
  {
    "text": "is the the food value it's the the food",
    "start": "692000",
    "end": "694560"
  },
  {
    "text": "number that has to be in the packet and",
    "start": "694560",
    "end": "696399"
  },
  {
    "text": "then you have this slashn the slashn is",
    "start": "696399",
    "end": "699120"
  },
  {
    "text": "the asky value for the number 10 and if",
    "start": "699120",
    "end": "701839"
  },
  {
    "text": "you look at the source code here the",
    "start": "701839",
    "end": "703519"
  },
  {
    "text": "number 10 0 1 2 3 4 5 6 7 8 9 10 is a",
    "start": "703519",
    "end": "709279"
  },
  {
    "text": "message chat wow look at that and you'll",
    "start": "709279",
    "end": "712240"
  },
  {
    "text": "see encoded in the packet uh is my name",
    "start": "712240",
    "end": "715120"
  },
  {
    "text": "so I have",
    "start": "715120",
    "end": "716600"
  },
  {
    "text": "xx",
    "start": "716600",
    "end": "718200"
  },
  {
    "text": "lowle x and you'll notice that it's uh",
    "start": "718200",
    "end": "721440"
  },
  {
    "text": "interled with null bytes this is a",
    "start": "721440",
    "end": "723279"
  },
  {
    "text": "function actually of windows right so in",
    "start": "723279",
    "end": "725279"
  },
  {
    "text": "the source code they use these things",
    "start": "725279",
    "end": "726560"
  },
  {
    "text": "called wares or wide characters are a 16",
    "start": "726560",
    "end": "729360"
  },
  {
    "text": "byt character and this is used for unic",
    "start": "729360",
    "end": "731680"
  },
  {
    "text": "code encoding right if you want to have",
    "start": "731680",
    "end": "732880"
  },
  {
    "text": "a two byte unicode scheme you have to",
    "start": "732880",
    "end": "734560"
  },
  {
    "text": "use w cares and so when you do normal",
    "start": "734560",
    "end": "737120"
  },
  {
    "text": "asy in w cares what actually happens is",
    "start": "737120",
    "end": "739440"
  },
  {
    "text": "you interle the uh the data with null",
    "start": "739440",
    "end": "742000"
  },
  {
    "text": "bite so you have lowle here and then",
    "start": "742000",
    "end": "743839"
  },
  {
    "text": "there's some more kind of like check sum",
    "start": "743839",
    "end": "745920"
  },
  {
    "text": "data I'm pretty sure this is actually",
    "start": "745920",
    "end": "747120"
  },
  {
    "text": "the game ID so it's just it's containing",
    "start": "747120",
    "end": "750320"
  },
  {
    "text": "what game lobby the message came from",
    "start": "750320",
    "end": "753680"
  },
  {
    "text": "and then you will see that uh the",
    "start": "753680",
    "end": "756959"
  },
  {
    "text": "message starts here it says says",
    "start": "756959",
    "end": "759000"
  },
  {
    "text": "\"Wow this is rad wow look at that all of",
    "start": "759000",
    "end": "764079"
  },
  {
    "text": "the contents of the lobby completely",
    "start": "764079",
    "end": "766480"
  },
  {
    "text": "decrypted.\" Decrypted again in air",
    "start": "766480",
    "end": "768000"
  },
  {
    "text": "quotes uh in plain text what is",
    "start": "768000",
    "end": "770079"
  },
  {
    "text": "interesting I think about this in",
    "start": "770079",
    "end": "771440"
  },
  {
    "text": "general is that this is being broadcast",
    "start": "771440",
    "end": "773680"
  },
  {
    "text": "to the entire network right so basically",
    "start": "773680",
    "end": "775519"
  },
  {
    "text": "if you're on a LAN regardless of if or",
    "start": "775519",
    "end": "778079"
  },
  {
    "text": "or if not you are in the lobby you are",
    "start": "778079",
    "end": "780399"
  },
  {
    "text": "getting this this data i will say one",
    "start": "780399",
    "end": "782959"
  },
  {
    "text": "more thing about the security of this",
    "start": "782959",
    "end": "784959"
  },
  {
    "text": "code and this is authentication right so",
    "start": "784959",
    "end": "788000"
  },
  {
    "text": "we want to figure out the kind of the",
    "start": "788000",
    "end": "790160"
  },
  {
    "text": "end state here is can I inject packets",
    "start": "790160",
    "end": "793360"
  },
  {
    "text": "can I send packets to somebody who has",
    "start": "793360",
    "end": "795760"
  },
  {
    "text": "this port open and send fake data now I",
    "start": "795760",
    "end": "798959"
  },
  {
    "text": "was not able to figure this out in its",
    "start": "798959",
    "end": "800639"
  },
  {
    "text": "entirety because again this is a huge",
    "start": "800639",
    "end": "802079"
  },
  {
    "text": "codebase i don't have time to be doing",
    "start": "802079",
    "end": "803519"
  },
  {
    "text": "this for for all day every day i have a",
    "start": "803519",
    "end": "805360"
  },
  {
    "text": "job i have a kid but what I will say is",
    "start": "805360",
    "end": "808720"
  },
  {
    "text": "we have these functions right these are",
    "start": "808720",
    "end": "811440"
  },
  {
    "text": "the callbacks that are handled by the",
    "start": "811440",
    "end": "813680"
  },
  {
    "text": "transport layer when it receives the",
    "start": "813680",
    "end": "816480"
  },
  {
    "text": "data and you will notice something a",
    "start": "816480",
    "end": "818959"
  },
  {
    "text": "little suspicious the only like",
    "start": "818959",
    "end": "821040"
  },
  {
    "text": "arguments to these functions are LAN",
    "start": "821040",
    "end": "824480"
  },
  {
    "text": "message the message itself right and",
    "start": "824480",
    "end": "826480"
  },
  {
    "text": "then unsigned int sender IP right so if",
    "start": "826480",
    "end": "830160"
  },
  {
    "text": "we go to these",
    "start": "830160",
    "end": "831639"
  },
  {
    "text": "functions in LAN API",
    "start": "831639",
    "end": "834440"
  },
  {
    "text": "handlers really the only way that it's",
    "start": "834440",
    "end": "838079"
  },
  {
    "text": "checking to see if the packet came from",
    "start": "838079",
    "end": "840639"
  },
  {
    "text": "the proper person is by the IP address",
    "start": "840639",
    "end": "843600"
  },
  {
    "text": "of the packet now if you're into infosc",
    "start": "843600",
    "end": "846399"
  },
  {
    "text": "at all you'll know that this is also a",
    "start": "846399",
    "end": "848560"
  },
  {
    "text": "UDP protocol which means there's no",
    "start": "848560",
    "end": "851040"
  },
  {
    "text": "three-way handshake required to get the",
    "start": "851040",
    "end": "853760"
  },
  {
    "text": "data into the computer it just you can",
    "start": "853760",
    "end": "855680"
  },
  {
    "text": "just willy-nilly broadcast UDP and it",
    "start": "855680",
    "end": "858560"
  },
  {
    "text": "will just and you can just make up",
    "start": "858560",
    "end": "860240"
  },
  {
    "text": "packets the reason why this is important",
    "start": "860240",
    "end": "862480"
  },
  {
    "text": "is that in UDP in incap rather you can",
    "start": "862480",
    "end": "867040"
  },
  {
    "text": "spoof the IP address of the person that",
    "start": "867040",
    "end": "870160"
  },
  {
    "text": "sent the package i've created a a class",
    "start": "870160",
    "end": "872399"
  },
  {
    "text": "here called transport message this is a",
    "start": "872399",
    "end": "874320"
  },
  {
    "text": "a crruct which basically in Python",
    "start": "874320",
    "end": "876720"
  },
  {
    "text": "allows you to write a strruct definition",
    "start": "876720",
    "end": "879199"
  },
  {
    "text": "and then you can use these fields in",
    "start": "879199",
    "end": "881519"
  },
  {
    "text": "python and like add content to them",
    "start": "881519",
    "end": "883279"
  },
  {
    "text": "right uh you have the CRC the magic the",
    "start": "883279",
    "end": "885680"
  },
  {
    "text": "type of the packet so if it's a chat",
    "start": "885680",
    "end": "887040"
  },
  {
    "text": "message if it's a lobby announcement if",
    "start": "887040",
    "end": "888399"
  },
  {
    "text": "it's whatever and then you have this I",
    "start": "888399",
    "end": "890079"
  },
  {
    "text": "think the message length is 467 just",
    "start": "890079",
    "end": "892240"
  },
  {
    "text": "based on what Wireshark is showing us",
    "start": "892240",
    "end": "893680"
  },
  {
    "text": "here um but what we can do with this is",
    "start": "893680",
    "end": "897040"
  },
  {
    "text": "do uh we can make the transport message",
    "start": "897040",
    "end": "899760"
  },
  {
    "text": "type we instantiate it we add the food",
    "start": "899760",
    "end": "902399"
  },
  {
    "text": "magic we say the type is a type two",
    "start": "902399",
    "end": "904320"
  },
  {
    "text": "which actually is not what I want i want",
    "start": "904320",
    "end": "905519"
  },
  {
    "text": "a type 10 this is from a different",
    "start": "905519",
    "end": "906880"
  },
  {
    "text": "experiment I was running uh and we can",
    "start": "906880",
    "end": "908560"
  },
  {
    "text": "say the message is la again this won't",
    "start": "908560",
    "end": "910399"
  },
  {
    "text": "work and then we could do the CRC of",
    "start": "910399",
    "end": "912079"
  },
  {
    "text": "that packet using our CRC function and",
    "start": "912079",
    "end": "914160"
  },
  {
    "text": "then we can encrypt it right we can just",
    "start": "914160",
    "end": "915680"
  },
  {
    "text": "add the encrypted data uh to the packet",
    "start": "915680",
    "end": "918399"
  },
  {
    "text": "print it out just to prove that it's the",
    "start": "918399",
    "end": "919839"
  },
  {
    "text": "right the right data and then we can",
    "start": "919839",
    "end": "922160"
  },
  {
    "text": "actually with scape just spoof that the",
    "start": "922160",
    "end": "925600"
  },
  {
    "text": "source came from my other computer this",
    "start": "925600",
    "end": "927440"
  },
  {
    "text": "is not my IP address this is on a",
    "start": "927440",
    "end": "928880"
  },
  {
    "text": "different computer but because it's just",
    "start": "928880",
    "end": "930399"
  },
  {
    "text": "going out broadcast to the network I can",
    "start": "930399",
    "end": "932720"
  },
  {
    "text": "say \"Hey man this packet actually came",
    "start": "932720",
    "end": "936240"
  },
  {
    "text": "from this other guy what are we going to",
    "start": "936240",
    "end": "938800"
  },
  {
    "text": "do about it?\" And then the source code",
    "start": "938800",
    "end": "940240"
  },
  {
    "text": "will just use that IP address to",
    "start": "940240",
    "end": "943680"
  },
  {
    "text": "determine what functionality to take",
    "start": "943680",
    "end": "945839"
  },
  {
    "text": "right there's no authentication other",
    "start": "945839",
    "end": "948399"
  },
  {
    "text": "than is the user at an IP address okay",
    "start": "948399",
    "end": "952000"
  },
  {
    "text": "let's do a thing before we continue",
    "start": "952000",
    "end": "953600"
  },
  {
    "text": "let's take a break and hear a quick word",
    "start": "953600",
    "end": "955360"
  },
  {
    "text": "from our sponsor me today's video is",
    "start": "955360",
    "end": "958320"
  },
  {
    "text": "sponsored by me i honestly believe that",
    "start": "958320",
    "end": "960480"
  },
  {
    "text": "if you want to get into the world of",
    "start": "960480",
    "end": "961839"
  },
  {
    "text": "cyber security software security",
    "start": "961839",
    "end": "963600"
  },
  {
    "text": "programming really anything you need to",
    "start": "963600",
    "end": "965519"
  },
  {
    "text": "know how computers work at a fundamental",
    "start": "965519",
    "end": "967519"
  },
  {
    "text": "level and in my opinion the best way to",
    "start": "967519",
    "end": "969199"
  },
  {
    "text": "do that is by learning the basic",
    "start": "969199",
    "end": "971199"
  },
  {
    "text": "languages that run the world by learning",
    "start": "971199",
    "end": "972959"
  },
  {
    "text": "C and assembly with my courses you can",
    "start": "972959",
    "end": "975279"
  },
  {
    "text": "learn the C programming language with",
    "start": "975279",
    "end": "976880"
  },
  {
    "text": "zero to her C programmer you can learn",
    "start": "976880",
    "end": "978800"
  },
  {
    "text": "how to write network code for C how to",
    "start": "978800",
    "end": "981040"
  },
  {
    "text": "use threads in C and if you want to even",
    "start": "981040",
    "end": "983279"
  },
  {
    "text": "write your own HTTP server in C for a",
    "start": "983279",
    "end": "986480"
  },
  {
    "text": "onetime price you get access to every",
    "start": "986480",
    "end": "988160"
  },
  {
    "text": "course as well as a private Discord you",
    "start": "988160",
    "end": "989920"
  },
  {
    "text": "can ask me questions you can't write",
    "start": "989920",
    "end": "991759"
  },
  {
    "text": "good code without knowing the",
    "start": "991759",
    "end": "992800"
  },
  {
    "text": "fundamentals and where do you learn the",
    "start": "992800",
    "end": "994160"
  },
  {
    "text": "fundamentals on low academy so that's it",
    "start": "994160",
    "end": "996320"
  },
  {
    "text": "guys pretty fun little video i I love",
    "start": "996320",
    "end": "998560"
  },
  {
    "text": "doing stuff like this dude if there's",
    "start": "998560",
    "end": "1000480"
  },
  {
    "text": "ever a chance for you to read the source",
    "start": "1000480",
    "end": "1002560"
  },
  {
    "text": "code of a thing that you used to play or",
    "start": "1002560",
    "end": "1005040"
  },
  {
    "text": "some big functionality some big program",
    "start": "1005040",
    "end": "1007839"
  },
  {
    "text": "comes out that has a lot of network",
    "start": "1007839",
    "end": "1008959"
  },
  {
    "text": "functionality go read the source code go",
    "start": "1008959",
    "end": "1010720"
  },
  {
    "text": "check it out it's a lot of fun i love",
    "start": "1010720",
    "end": "1012399"
  },
  {
    "text": "this stuff uh from a security standpoint",
    "start": "1012399",
    "end": "1014480"
  },
  {
    "text": "I would give this a high four out of 10",
    "start": "1014480",
    "end": "1017120"
  },
  {
    "text": "the reason I don't give it a zero is all",
    "start": "1017120",
    "end": "1019440"
  },
  {
    "text": "of the operations that are being done",
    "start": "1019440",
    "end": "1021040"
  },
  {
    "text": "here are actually using uh the C++",
    "start": "1021040",
    "end": "1025360"
  },
  {
    "text": "string class which is really really hard",
    "start": "1025360",
    "end": "1028798"
  },
  {
    "text": "to get wrong so they're doing like",
    "start": "1028799",
    "end": "1030480"
  },
  {
    "text": "they're not doing like stir copies or",
    "start": "1030480",
    "end": "1032000"
  },
  {
    "text": "mem copies they're doing like kingcat",
    "start": "1032000",
    "end": "1033918"
  },
  {
    "text": "which is very very safe uh but other",
    "start": "1033919",
    "end": "1036079"
  },
  {
    "text": "than that exort is an encryption",
    "start": "1036079",
    "end": "1037918"
  },
  {
    "text": "authentication cannot be done strictly",
    "start": "1037919",
    "end": "1039520"
  },
  {
    "text": "off of IP address especially with UDP",
    "start": "1039520",
    "end": "1042079"
  },
  {
    "text": "data um yeah but that's it for now guys",
    "start": "1042079",
    "end": "1044798"
  },
  {
    "text": "thanks for watching if you like this",
    "start": "1044799",
    "end": "1045678"
  },
  {
    "text": "video if you like stuff like this leave",
    "start": "1045679",
    "end": "1046880"
  },
  {
    "text": "a comment down below please let me know",
    "start": "1046880",
    "end": "1048880"
  },
  {
    "text": "say \"Hey lowlevel how you doing?\" And",
    "start": "1048880",
    "end": "1050720"
  },
  {
    "text": "then uh hit subscribe and then go check",
    "start": "1050720",
    "end": "1052640"
  },
  {
    "text": "this video out which I think we will uh",
    "start": "1052640",
    "end": "1054320"
  },
  {
    "text": "you will you will also enjoy okay",
    "start": "1054320",
    "end": "1056240"
  },
  {
    "text": "goodbye",
    "start": "1056240",
    "end": "1058480"
  }
]