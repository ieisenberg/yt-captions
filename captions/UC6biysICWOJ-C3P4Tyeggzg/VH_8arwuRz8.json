[
  {
    "text": "they told me I was crazy but this time",
    "start": "40",
    "end": "2760"
  },
  {
    "text": "yet again I was right whenever I play",
    "start": "2760",
    "end": "5080"
  },
  {
    "text": "games with my friends they always insist",
    "start": "5080",
    "end": "7359"
  },
  {
    "text": "that I download a ton of crazy mods to",
    "start": "7359",
    "end": "10040"
  },
  {
    "text": "the game like Go download the anime",
    "start": "10040",
    "end": "12280"
  },
  {
    "text": "waifu mod for Minecraft or go download",
    "start": "12280",
    "end": "14879"
  },
  {
    "text": "the no pants mod for Skyrim and the",
    "start": "14879",
    "end": "17480"
  },
  {
    "text": "reason that I'm always so skeptical of",
    "start": "17480",
    "end": "19520"
  },
  {
    "text": "downloading these mods is at the end of",
    "start": "19520",
    "end": "21600"
  },
  {
    "text": "the day a mod is just code it's code",
    "start": "21600",
    "end": "24400"
  },
  {
    "text": "that you run that makes a modification",
    "start": "24400",
    "end": "26519"
  },
  {
    "text": "to the game so it behaves in a different",
    "start": "26519",
    "end": "28800"
  },
  {
    "text": "way one of the easiest ways to get",
    "start": "28800",
    "end": "31039"
  },
  {
    "text": "hacked is to run code by an author that",
    "start": "31039",
    "end": "33680"
  },
  {
    "text": "you don't necessarily know or trust and",
    "start": "33680",
    "end": "36280"
  },
  {
    "text": "this exact thing happened to the city",
    "start": "36280",
    "end": "38399"
  },
  {
    "text": "skylines Community earlier this week a",
    "start": "38399",
    "end": "40960"
  },
  {
    "text": "malicious hacker hacked an account that",
    "start": "40960",
    "end": "43280"
  },
  {
    "text": "was being used to submit modifications",
    "start": "43280",
    "end": "45399"
  },
  {
    "text": "to the traffic mod in City skylines and",
    "start": "45399",
    "end": "48000"
  },
  {
    "text": "as a result everyone that had that mod",
    "start": "48000",
    "end": "50559"
  },
  {
    "text": "ended up downloading malware now in this",
    "start": "50559",
    "end": "52559"
  },
  {
    "text": "video we're going to talk about the fast",
    "start": "52559",
    "end": "54320"
  },
  {
    "text": "math dll malware the multiple stages of",
    "start": "54320",
    "end": "57280"
  },
  {
    "text": "how it works and why It ultimately",
    "start": "57280",
    "end": "59199"
  },
  {
    "text": "didn't get picked up by antivirus for a",
    "start": "59199",
    "end": "61120"
  },
  {
    "text": "very very long time now it all started",
    "start": "61120",
    "end": "62920"
  },
  {
    "text": "here at paradoxplaza.com now if you",
    "start": "62920",
    "end": "65119"
  },
  {
    "text": "don't know what this place is this is a",
    "start": "65119",
    "end": "67240"
  },
  {
    "text": "place where you can download",
    "start": "67240",
    "end": "68360"
  },
  {
    "text": "modifications for Paradox games and one",
    "start": "68360",
    "end": "70479"
  },
  {
    "text": "of the games being City skylines 2 a",
    "start": "70479",
    "end": "72920"
  },
  {
    "text": "major city emulator that you can build",
    "start": "72920",
    "end": "74960"
  },
  {
    "text": "your own City it has an economy it has a",
    "start": "74960",
    "end": "76560"
  },
  {
    "text": "whole bunch of cool features I actually",
    "start": "76560",
    "end": "77920"
  },
  {
    "text": "personally love these kind of sandbox",
    "start": "77920",
    "end": "79920"
  },
  {
    "text": "build uh simulation games but one of the",
    "start": "79920",
    "end": "82400"
  },
  {
    "text": "mods here is called traffic pretty",
    "start": "82400",
    "end": "83960"
  },
  {
    "text": "straightforward all it does is it gives",
    "start": "83960",
    "end": "85159"
  },
  {
    "text": "you the ability to uh intricately design",
    "start": "85159",
    "end": "87920"
  },
  {
    "text": "intersections and kind of give your city",
    "start": "87920",
    "end": "89920"
  },
  {
    "text": "a more customized traffic flow that",
    "start": "89920",
    "end": "91720"
  },
  {
    "text": "sounds all very you know benign and",
    "start": "91720",
    "end": "93600"
  },
  {
    "text": "simple and so you know you go through",
    "start": "93600",
    "end": "95560"
  },
  {
    "text": "and you download the modification here",
    "start": "95560",
    "end": "97000"
  },
  {
    "text": "it's 2.2 Megs not that big considering",
    "start": "97000",
    "end": "99159"
  },
  {
    "text": "that the game has 3D Graphics a lot of",
    "start": "99159",
    "end": "100920"
  },
  {
    "text": "code that it has to import to run a",
    "start": "100920",
    "end": "102680"
  },
  {
    "text": "modification and you'll also see here",
    "start": "102680",
    "end": "104719"
  },
  {
    "text": "that there are um",
    "start": "104719",
    "end": "106799"
  },
  {
    "text": "372,000 subscribers to this modification",
    "start": "106799",
    "end": "110000"
  },
  {
    "text": "so not only is it you know pretty",
    "start": "110000",
    "end": "111759"
  },
  {
    "text": "popular it has a a pretty large",
    "start": "111759",
    "end": "113479"
  },
  {
    "text": "following so if this was to be",
    "start": "113479",
    "end": "114880"
  },
  {
    "text": "compromised it hits a lot of people and",
    "start": "114880",
    "end": "116680"
  },
  {
    "text": "so what do you do you download the mod",
    "start": "116680",
    "end": "118240"
  },
  {
    "text": "here and it comes with a few files I'll",
    "start": "118240",
    "end": "120399"
  },
  {
    "text": "try to zoom in here so you guys can see",
    "start": "120399",
    "end": "122119"
  },
  {
    "text": "all the files here but when you install",
    "start": "122119",
    "end": "124320"
  },
  {
    "text": "modifications to games depending on how",
    "start": "124320",
    "end": "126200"
  },
  {
    "text": "the game is written most of the time you",
    "start": "126200",
    "end": "128759"
  },
  {
    "text": "just install a dll a dynamic link",
    "start": "128759",
    "end": "131080"
  },
  {
    "text": "Library which is uh like a shared object",
    "start": "131080",
    "end": "133360"
  },
  {
    "text": "in Linux it's this way of transporting",
    "start": "133360",
    "end": "135640"
  },
  {
    "text": "code to be loaded by an application",
    "start": "135640",
    "end": "137560"
  },
  {
    "text": "that's already compiled so by putting",
    "start": "137560",
    "end": "139239"
  },
  {
    "text": "this into the game folder for City",
    "start": "139239",
    "end": "141319"
  },
  {
    "text": "skylines it'll load the dll and do",
    "start": "141319",
    "end": "143680"
  },
  {
    "text": "whatever is happening inside of the dll",
    "start": "143680",
    "end": "145760"
  },
  {
    "text": "itself now what happened recently is",
    "start": "145760",
    "end": "148680"
  },
  {
    "text": "that this traffic . dlod came with an",
    "start": "148680",
    "end": "151920"
  },
  {
    "text": "additional file that you're not seeing",
    "start": "151920",
    "end": "154120"
  },
  {
    "text": "inside of this download this download",
    "start": "154120",
    "end": "155879"
  },
  {
    "text": "has the um the fixed version without the",
    "start": "155879",
    "end": "158239"
  },
  {
    "text": "malware it came with another file",
    "start": "158239",
    "end": "160599"
  },
  {
    "text": "traffic. dll used to not be the only",
    "start": "160599",
    "end": "163800"
  },
  {
    "text": "library that this mod would come with it",
    "start": "163800",
    "end": "165760"
  },
  {
    "text": "would also come with this other Library",
    "start": "165760",
    "end": "168000"
  },
  {
    "text": "here called fast.do uh you may look at",
    "start": "168000",
    "end": "171519"
  },
  {
    "text": "this library and say hm okay well it's a",
    "start": "171519",
    "end": "174280"
  },
  {
    "text": "library that has to do with a game games",
    "start": "174280",
    "end": "176760"
  },
  {
    "text": "need to do math I want to do math fast",
    "start": "176760",
    "end": "179120"
  },
  {
    "text": "so it makes sense that this Library",
    "start": "179120",
    "end": "181040"
  },
  {
    "text": "comes here uh but this actually is where",
    "start": "181040",
    "end": "184440"
  },
  {
    "text": "all of the malware was stored for this",
    "start": "184440",
    "end": "187799"
  },
  {
    "text": "mod so when we're doing our initial",
    "start": "187799",
    "end": "189319"
  },
  {
    "text": "triage of a malicious file we want to",
    "start": "189319",
    "end": "191480"
  },
  {
    "text": "kind of discover the basic Primitives of",
    "start": "191480",
    "end": "194120"
  },
  {
    "text": "the file does the file do the thing that",
    "start": "194120",
    "end": "196159"
  },
  {
    "text": "it's supposed to do and what are like",
    "start": "196159",
    "end": "197760"
  },
  {
    "text": "the major red flags that are kind of",
    "start": "197760",
    "end": "199280"
  },
  {
    "text": "tipping us off to what is happening well",
    "start": "199280",
    "end": "201560"
  },
  {
    "text": "if you run the read PE file here and I'm",
    "start": "201560",
    "end": "204280"
  },
  {
    "text": "doing some fix UPS on my LD Library path",
    "start": "204280",
    "end": "206360"
  },
  {
    "text": "because the program isn't functioning",
    "start": "206360",
    "end": "208239"
  },
  {
    "text": "but read PE what it it does what it says",
    "start": "208239",
    "end": "210319"
  },
  {
    "text": "it does it reads the portable executable",
    "start": "210319",
    "end": "212239"
  },
  {
    "text": "file format which is the type of any dll",
    "start": "212239",
    "end": "214879"
  },
  {
    "text": "any executable on Windows be it an exe",
    "start": "214879",
    "end": "217040"
  },
  {
    "text": "or a dll they all pees um we're going to",
    "start": "217040",
    "end": "219560"
  },
  {
    "text": "run read PE on Fast Math and you'll see",
    "start": "219560",
    "end": "222680"
  },
  {
    "text": "pretty quickly here there are um no",
    "start": "222680",
    "end": "226599"
  },
  {
    "text": "exported functions in the dll the whole",
    "start": "226599",
    "end": "229159"
  },
  {
    "text": "point of using a dll is that there are",
    "start": "229159",
    "end": "231239"
  },
  {
    "text": "Snippets of code in here that you want",
    "start": "231239",
    "end": "233040"
  },
  {
    "text": "to be reusable right you write this very",
    "start": "233040",
    "end": "235079"
  },
  {
    "text": "very fast math library and you don't",
    "start": "235079",
    "end": "237120"
  },
  {
    "text": "want to bake it into your code over and",
    "start": "237120",
    "end": "238799"
  },
  {
    "text": "over and over again you make one file",
    "start": "238799",
    "end": "240760"
  },
  {
    "text": "and then that file exports a function so",
    "start": "240760",
    "end": "243239"
  },
  {
    "text": "when a file like Fast Math doesn't have",
    "start": "243239",
    "end": "245319"
  },
  {
    "text": "any exports initially that's like a whoa",
    "start": "245319",
    "end": "247319"
  },
  {
    "text": "what is going on so why did Fast Math",
    "start": "247319",
    "end": "250480"
  },
  {
    "text": "not get picked up by anti any antivirus",
    "start": "250480",
    "end": "253400"
  },
  {
    "text": "the way that fast math actually",
    "start": "253400",
    "end": "255200"
  },
  {
    "text": "distributes its stage two and stage",
    "start": "255200",
    "end": "257079"
  },
  {
    "text": "three payloads is really really",
    "start": "257079",
    "end": "258400"
  },
  {
    "text": "interesting hey guys real quick before",
    "start": "258400",
    "end": "259720"
  },
  {
    "text": "we continue I want to talk about my",
    "start": "259720",
    "end": "261120"
  },
  {
    "text": "website lowlevel Academy I honestly",
    "start": "261120",
    "end": "263240"
  },
  {
    "text": "believe that if you want to be a good",
    "start": "263240",
    "end": "264759"
  },
  {
    "text": "programmer or a good cyber security",
    "start": "264759",
    "end": "266639"
  },
  {
    "text": "analyst you have to know the",
    "start": "266639",
    "end": "268040"
  },
  {
    "text": "fundamentals of how computers work all",
    "start": "268040",
    "end": "269880"
  },
  {
    "text": "my computers are designed around this by",
    "start": "269880",
    "end": "271600"
  },
  {
    "text": "teaching you the core languages of how",
    "start": "271600",
    "end": "273240"
  },
  {
    "text": "the CPU works at a basic level like C",
    "start": "273240",
    "end": "276160"
  },
  {
    "text": "assembly or network code or threading",
    "start": "276160",
    "end": "278520"
  },
  {
    "text": "all happening in C you can go try out my",
    "start": "278520",
    "end": "280479"
  },
  {
    "text": "courses right now for free there are",
    "start": "280479",
    "end": "281840"
  },
  {
    "text": "some lessons that are completely free",
    "start": "281840",
    "end": "283360"
  },
  {
    "text": "you don't have to log in or do anything",
    "start": "283360",
    "end": "284560"
  },
  {
    "text": "to see them like right now you can do",
    "start": "284560",
    "end": "285720"
  },
  {
    "text": "the load operation lesson in my arm",
    "start": "285720",
    "end": "287400"
  },
  {
    "text": "course or maybe even learn about how",
    "start": "287400",
    "end": "289039"
  },
  {
    "text": "arrays work in my C course can't be a",
    "start": "289039",
    "end": "291560"
  },
  {
    "text": "good programmer if you don't know the",
    "start": "291560",
    "end": "292560"
  },
  {
    "text": "fundamentals of computing and where do",
    "start": "292560",
    "end": "293960"
  },
  {
    "text": "you learn that on low-level Academy",
    "start": "293960",
    "end": "295840"
  },
  {
    "text": "thanks for watching let's keep going now",
    "start": "295840",
    "end": "297000"
  },
  {
    "text": "the analysis of this mod has been kind",
    "start": "297000",
    "end": "298919"
  },
  {
    "text": "of crowdsourced by a community called r/",
    "start": "298919",
    "end": "301280"
  },
  {
    "text": "antivirus on Reddit between r/ antivirus",
    "start": "301280",
    "end": "304320"
  },
  {
    "text": "r/ Exodus which is the name of the",
    "start": "304320",
    "end": "306240"
  },
  {
    "text": "crypto wallet that this malware targets",
    "start": "306240",
    "end": "308320"
  },
  {
    "text": "and r/ City skylines people have all",
    "start": "308320",
    "end": "310560"
  },
  {
    "text": "kind of come together to do some",
    "start": "310560",
    "end": "311600"
  },
  {
    "text": "research on how this mod is actually",
    "start": "311600",
    "end": "313560"
  },
  {
    "text": "behaving and you'll see one of the the",
    "start": "313560",
    "end": "315160"
  },
  {
    "text": "major contributes here tough Edition is",
    "start": "315160",
    "end": "317759"
  },
  {
    "text": "exposing all of the Imports that this",
    "start": "317759",
    "end": "320880"
  },
  {
    "text": "Library actually Imports to do its",
    "start": "320880",
    "end": "322960"
  },
  {
    "text": "nefarious things right so you'll see",
    "start": "322960",
    "end": "324440"
  },
  {
    "text": "here Colonel 32.dll uh create thread",
    "start": "324440",
    "end": "327360"
  },
  {
    "text": "sleep Alec console uh Mal",
    "start": "327360",
    "end": "330440"
  },
  {
    "text": "socket connect send to clean up if you",
    "start": "330440",
    "end": "333360"
  },
  {
    "text": "see a single program using all of these",
    "start": "333360",
    "end": "337520"
  },
  {
    "text": "functions and maybe exclusively using",
    "start": "337520",
    "end": "339639"
  },
  {
    "text": "these functions 99% of the time it's",
    "start": "339639",
    "end": "342280"
  },
  {
    "text": "going to be malware because why else",
    "start": "342280",
    "end": "343720"
  },
  {
    "text": "would you need to do all of these things",
    "start": "343720",
    "end": "345800"
  },
  {
    "text": "almost in order and exclusively now when",
    "start": "345800",
    "end": "348400"
  },
  {
    "text": "you're looking at this you're probably",
    "start": "348400",
    "end": "349400"
  },
  {
    "text": "thinking okay shouldn't antivirus like",
    "start": "349400",
    "end": "351759"
  },
  {
    "text": "pick up on this exclusively like",
    "start": "351759",
    "end": "353319"
  },
  {
    "text": "wouldn't they just signature all these",
    "start": "353319",
    "end": "355880"
  },
  {
    "text": "Imports and say that it's it's malware",
    "start": "355880",
    "end": "358600"
  },
  {
    "text": "well what's really interesting actually",
    "start": "358600",
    "end": "359639"
  },
  {
    "text": "actually is if you do a a string search",
    "start": "359639",
    "end": "362240"
  },
  {
    "text": "on the malware you're not going to find",
    "start": "362240",
    "end": "364759"
  },
  {
    "text": "pretty much any of those strings in the",
    "start": "364759",
    "end": "367800"
  },
  {
    "text": "binary the way that the malware author",
    "start": "367800",
    "end": "370120"
  },
  {
    "text": "hid the additional layers of execution",
    "start": "370120",
    "end": "372880"
  },
  {
    "text": "called stages into this binary is super",
    "start": "372880",
    "end": "375000"
  },
  {
    "text": "interesting now when you're doing any",
    "start": "375000",
    "end": "376680"
  },
  {
    "text": "kind of binary analysis what you want to",
    "start": "376680",
    "end": "378080"
  },
  {
    "text": "do first is go to where the program",
    "start": "378080",
    "end": "380120"
  },
  {
    "text": "starts called the entry point and the",
    "start": "380120",
    "end": "382639"
  },
  {
    "text": "entry point is the place that a binary",
    "start": "382639",
    "end": "385240"
  },
  {
    "text": "is told by the loader to begin to begin",
    "start": "385240",
    "end": "388039"
  },
  {
    "text": "code execution now technically dlls",
    "start": "388039",
    "end": "390319"
  },
  {
    "text": "don't have entry points because you're",
    "start": "390319",
    "end": "392080"
  },
  {
    "text": "not actually running the dll itself you",
    "start": "392080",
    "end": "394319"
  },
  {
    "text": "are running the exports of that program",
    "start": "394319",
    "end": "397360"
  },
  {
    "text": "now as I said before aside from the",
    "start": "397360",
    "end": "399280"
  },
  {
    "text": "entry point this dll the malicious one",
    "start": "399280",
    "end": "401520"
  },
  {
    "text": "doesn't actually export anything so this",
    "start": "401520",
    "end": "404080"
  },
  {
    "text": "is again another reason why it's kind of",
    "start": "404080",
    "end": "405440"
  },
  {
    "text": "a weird Mal form dll but if you go and",
    "start": "405440",
    "end": "408280"
  },
  {
    "text": "you look at the exception Handler table",
    "start": "408280",
    "end": "411680"
  },
  {
    "text": "that is registered in the binary let me",
    "start": "411680",
    "end": "413280"
  },
  {
    "text": "pull this up here this is the tree of",
    "start": "413280",
    "end": "416879"
  },
  {
    "text": "functions that are meant to handle",
    "start": "416879",
    "end": "418400"
  },
  {
    "text": "exceptions in Windows so when you have",
    "start": "418400",
    "end": "419960"
  },
  {
    "text": "an error in Windows like a try catch",
    "start": "419960",
    "end": "422160"
  },
  {
    "text": "statement for example you have to do",
    "start": "422160",
    "end": "424240"
  },
  {
    "text": "this thing called stack unwinding and",
    "start": "424240",
    "end": "426160"
  },
  {
    "text": "figure out which function was written in",
    "start": "426160",
    "end": "428319"
  },
  {
    "text": "a way that it can handle this error and",
    "start": "428319",
    "end": "430680"
  },
  {
    "text": "what's actually really interesting is",
    "start": "430680",
    "end": "432400"
  },
  {
    "text": "the very first exception Handler",
    "start": "432400",
    "end": "434440"
  },
  {
    "text": "registered to this dll is this function",
    "start": "434440",
    "end": "437599"
  },
  {
    "text": "here which you'll notice gidra which is",
    "start": "437599",
    "end": "439360"
  },
  {
    "text": "the reverse engineering framework by the",
    "start": "439360",
    "end": "440720"
  },
  {
    "text": "NSA they didn't catch this function the",
    "start": "440720",
    "end": "444199"
  },
  {
    "text": "automatic analyzer just sees this as a",
    "start": "444199",
    "end": "446840"
  },
  {
    "text": "string of bytes so first of all any",
    "start": "446840",
    "end": "449080"
  },
  {
    "text": "automatic analyzer may not pick this up",
    "start": "449080",
    "end": "451080"
  },
  {
    "text": "because it's it's installed into the",
    "start": "451080",
    "end": "452599"
  },
  {
    "text": "program kind of a weird in kind of a",
    "start": "452599",
    "end": "454479"
  },
  {
    "text": "weird way so if we click on this",
    "start": "454479",
    "end": "456000"
  },
  {
    "text": "function we hit D we'll see that it does",
    "start": "456000",
    "end": "458440"
  },
  {
    "text": "disassemble into a San and I'm saying",
    "start": "458440",
    "end": "461080"
  },
  {
    "text": "sane in quotes for a reason you'll see",
    "start": "461080",
    "end": "462720"
  },
  {
    "text": "here in a second in a San function you",
    "start": "462720",
    "end": "464520"
  },
  {
    "text": "can see that it's a sane function",
    "start": "464520",
    "end": "465840"
  },
  {
    "text": "because we have Push RDI push RSI and",
    "start": "465840",
    "end": "468599"
  },
  {
    "text": "then uh some subtraction of edx right so",
    "start": "468599",
    "end": "471159"
  },
  {
    "text": "we're creating some room on the stack to",
    "start": "471159",
    "end": "473960"
  },
  {
    "text": "do some operation right so this is this",
    "start": "473960",
    "end": "476080"
  },
  {
    "text": "is kind of a hidden function that the",
    "start": "476080",
    "end": "477919"
  },
  {
    "text": "malware authors were kind of oping that",
    "start": "477919",
    "end": "479960"
  },
  {
    "text": "no one saw so normally we would wait for",
    "start": "479960",
    "end": "481800"
  },
  {
    "text": "gedra to decompile this program and turn",
    "start": "481800",
    "end": "484400"
  },
  {
    "text": "the assembly into what it thinks the C",
    "start": "484400",
    "end": "486919"
  },
  {
    "text": "output would be um but because of how",
    "start": "486919",
    "end": "489919"
  },
  {
    "text": "long this function is and I'm scrolling",
    "start": "489919",
    "end": "491639"
  },
  {
    "text": "down you can see how many instructions",
    "start": "491639",
    "end": "493440"
  },
  {
    "text": "there are there's actually it's going to",
    "start": "493440",
    "end": "495159"
  },
  {
    "text": "crash the decompiler when it's trying to",
    "start": "495159",
    "end": "496680"
  },
  {
    "text": "decompile this now the reason that this",
    "start": "496680",
    "end": "499440"
  },
  {
    "text": "is kind of a suspicious looking function",
    "start": "499440",
    "end": "501919"
  },
  {
    "text": "is when you see a program loading single",
    "start": "501919",
    "end": "505919"
  },
  {
    "text": "bytes into an array by hand over and",
    "start": "505919",
    "end": "509159"
  },
  {
    "text": "over over and over again for if this",
    "start": "509159",
    "end": "511319"
  },
  {
    "text": "goes on for literally like 18 hex 18,000",
    "start": "511319",
    "end": "514360"
  },
  {
    "text": "I'll literally hold the page down button",
    "start": "514360",
    "end": "515839"
  },
  {
    "text": "I'm not going to do this the whole time",
    "start": "515839",
    "end": "517200"
  },
  {
    "text": "when it's doing this inefficient of an",
    "start": "517200",
    "end": "519560"
  },
  {
    "text": "operation the question becomes why why",
    "start": "519560",
    "end": "522719"
  },
  {
    "text": "why are we doing this well what's",
    "start": "522719",
    "end": "524039"
  },
  {
    "text": "actually really interesting is this",
    "start": "524039",
    "end": "526040"
  },
  {
    "text": "function is the dll this function is the",
    "start": "526040",
    "end": "529480"
  },
  {
    "text": "malware loading its second stage and",
    "start": "529480",
    "end": "532200"
  },
  {
    "text": "it's going to write this buffer to disk",
    "start": "532200",
    "end": "534760"
  },
  {
    "text": "and it's going to use that to run the",
    "start": "534760",
    "end": "536600"
  },
  {
    "text": "rest of the malware now why would it do",
    "start": "536600",
    "end": "538880"
  },
  {
    "text": "this why would they make this weird",
    "start": "538880",
    "end": "540440"
  },
  {
    "text": "second stage here well the way this",
    "start": "540440",
    "end": "541959"
  },
  {
    "text": "works actually is if you look at the",
    "start": "541959",
    "end": "544040"
  },
  {
    "text": "string representation of this",
    "start": "544040",
    "end": "546560"
  },
  {
    "text": "instruction you don't see just the bite",
    "start": "546560",
    "end": "549480"
  },
  {
    "text": "of the payload you see the bite of the",
    "start": "549480",
    "end": "551480"
  },
  {
    "text": "payload and the rest of the instruction",
    "start": "551480",
    "end": "553560"
  },
  {
    "text": "this is a really good way of obfuscating",
    "start": "553560",
    "end": "556079"
  },
  {
    "text": "payloads into a program because it's",
    "start": "556079",
    "end": "558640"
  },
  {
    "text": "it's woven into the actual assembly",
    "start": "558640",
    "end": "560880"
  },
  {
    "text": "that's required to do the operation and",
    "start": "560880",
    "end": "563399"
  },
  {
    "text": "on top of that they exor encoded or I",
    "start": "563399",
    "end": "566160"
  },
  {
    "text": "guess exor encrypted encrypting being in",
    "start": "566160",
    "end": "568000"
  },
  {
    "text": "in very heavy quotes there uh the",
    "start": "568000",
    "end": "569720"
  },
  {
    "text": "payload with hex 33 so the tldr is if",
    "start": "569720",
    "end": "573120"
  },
  {
    "text": "you extract all the bytes of this move",
    "start": "573120",
    "end": "575079"
  },
  {
    "text": "operation and then exor encrypt them or",
    "start": "575079",
    "end": "577560"
  },
  {
    "text": "decrypt them into the same operation",
    "start": "577560",
    "end": "578800"
  },
  {
    "text": "it's single time pad uh with hex 33 you",
    "start": "578800",
    "end": "581720"
  },
  {
    "text": "will eventually get the second stage of",
    "start": "581720",
    "end": "584279"
  },
  {
    "text": "the payload which is this Prof api.dll",
    "start": "584279",
    "end": "587600"
  },
  {
    "text": "now again a very benign a very normal",
    "start": "587600",
    "end": "591880"
  },
  {
    "text": "looking API function or a name of a dll",
    "start": "591880",
    "end": "594880"
  },
  {
    "text": "uh that you probably wouldn't suspect",
    "start": "594880",
    "end": "596079"
  },
  {
    "text": "anything of okay so here we have that",
    "start": "596079",
    "end": "597959"
  },
  {
    "text": "second binary loaded up Prof api.dll",
    "start": "597959",
    "end": "600600"
  },
  {
    "text": "remember this is the dll that got",
    "start": "600600",
    "end": "603200"
  },
  {
    "text": "dropped by fast maath it did that thing",
    "start": "603200",
    "end": "605800"
  },
  {
    "text": "where it loaded all those btes onto the",
    "start": "605800",
    "end": "607360"
  },
  {
    "text": "stack exor decoded them and then wrote",
    "start": "607360",
    "end": "609600"
  },
  {
    "text": "that out to the dis now again don't",
    "start": "609600",
    "end": "611600"
  },
  {
    "text": "forget we are looking for all of these",
    "start": "611600",
    "end": "614560"
  },
  {
    "text": "functions we're trying to find out you",
    "start": "614560",
    "end": "616120"
  },
  {
    "text": "know where in the binary are these",
    "start": "616120",
    "end": "618200"
  },
  {
    "text": "functions getting ran and how is",
    "start": "618200",
    "end": "620480"
  },
  {
    "text": "antivirus not picking up on them well",
    "start": "620480",
    "end": "622839"
  },
  {
    "text": "the way that this program resolves those",
    "start": "622839",
    "end": "626399"
  },
  {
    "text": "Imports is through a very interesting uh",
    "start": "626399",
    "end": "629880"
  },
  {
    "text": "technique now the initial way that",
    "start": "629880",
    "end": "631160"
  },
  {
    "text": "they're doing this is very common for",
    "start": "631160",
    "end": "632959"
  },
  {
    "text": "malware they're doing this thing called",
    "start": "632959",
    "end": "634760"
  },
  {
    "text": "a called a PEB walk and let me talk",
    "start": "634760",
    "end": "637800"
  },
  {
    "text": "about what the PEB actually is the PEB",
    "start": "637800",
    "end": "640880"
  },
  {
    "text": "in a Windows binary is called the",
    "start": "640880",
    "end": "643240"
  },
  {
    "text": "process environment block it is a region",
    "start": "643240",
    "end": "646639"
  },
  {
    "text": "within memory that contains a ton of",
    "start": "646639",
    "end": "649040"
  },
  {
    "text": "information about the running process",
    "start": "649040",
    "end": "652120"
  },
  {
    "text": "now the PEB contains a bunch of",
    "start": "652120",
    "end": "654399"
  },
  {
    "text": "different data structures that are",
    "start": "654399",
    "end": "655959"
  },
  {
    "text": "really really important for people who",
    "start": "655959",
    "end": "657320"
  },
  {
    "text": "are trying to do nefarious things right",
    "start": "657320",
    "end": "659360"
  },
  {
    "text": "and one of them is called the inload",
    "start": "659360",
    "end": "662839"
  },
  {
    "text": "order module list and what that list",
    "start": "662839",
    "end": "665880"
  },
  {
    "text": "actually is is it's a list of the dlls",
    "start": "665880",
    "end": "669519"
  },
  {
    "text": "that are loaded into the program live in",
    "start": "669519",
    "end": "672440"
  },
  {
    "text": "memory it's literally a list to all of",
    "start": "672440",
    "end": "674519"
  },
  {
    "text": "the dlls that the program is using and",
    "start": "674519",
    "end": "677000"
  },
  {
    "text": "the reason this is important for malware",
    "start": "677000",
    "end": "678839"
  },
  {
    "text": "is let's say for example that they want",
    "start": "678839",
    "end": "680600"
  },
  {
    "text": "to run the Ws 232 uh con or socket or",
    "start": "680600",
    "end": "685200"
  },
  {
    "text": "connect functions right it doesn't know",
    "start": "685200",
    "end": "687600"
  },
  {
    "text": "where the address of these function are",
    "start": "687600",
    "end": "689760"
  },
  {
    "text": "it's been either randomized by aslr or",
    "start": "689760",
    "end": "692200"
  },
  {
    "text": "they they really just don't know where",
    "start": "692200",
    "end": "693279"
  },
  {
    "text": "in the memory map the functions are and",
    "start": "693279",
    "end": "695399"
  },
  {
    "text": "you could like search through from 0 to",
    "start": "695399",
    "end": "698079"
  },
  {
    "text": "7 FFF to find a signature here but doing",
    "start": "698079",
    "end": "701440"
  },
  {
    "text": "it like this where you're walking the",
    "start": "701440",
    "end": "702639"
  },
  {
    "text": "PEB reduces the amount of workload the",
    "start": "702639",
    "end": "705279"
  },
  {
    "text": "dll has to do to find those functions so",
    "start": "705279",
    "end": "707279"
  },
  {
    "text": "you see this for Loop here what this for",
    "start": "707279",
    "end": "709519"
  },
  {
    "text": "Loop is doing is it's searching through",
    "start": "709519",
    "end": "711959"
  },
  {
    "text": "the PEB walking this list and trying to",
    "start": "711959",
    "end": "714639"
  },
  {
    "text": "see if this condition matches now maybe",
    "start": "714639",
    "end": "717519"
  },
  {
    "text": "you're thinking okay okay if it's",
    "start": "717519",
    "end": "718839"
  },
  {
    "text": "looking for for Colonel 32.dll maybe",
    "start": "718839",
    "end": "721320"
  },
  {
    "text": "this is the asky representation of",
    "start": "721320",
    "end": "723639"
  },
  {
    "text": "Kernel 32.dll well you'll see here the",
    "start": "723639",
    "end": "726720"
  },
  {
    "text": "first bite is hex 95 which means it's",
    "start": "726720",
    "end": "728480"
  },
  {
    "text": "not asky printable also hex1 n is not",
    "start": "728480",
    "end": "730600"
  },
  {
    "text": "asky printable or FD so what is this",
    "start": "730600",
    "end": "733079"
  },
  {
    "text": "magic value what's really really cool",
    "start": "733079",
    "end": "735519"
  },
  {
    "text": "about this piece of malware is they",
    "start": "735519",
    "end": "737399"
  },
  {
    "text": "brought their own custom hashing",
    "start": "737399",
    "end": "739839"
  },
  {
    "text": "function so what they're doing is",
    "start": "739839",
    "end": "741360"
  },
  {
    "text": "they're iterating o over every module in",
    "start": "741360",
    "end": "744480"
  },
  {
    "text": "the PEB and then they're hashing the",
    "start": "744480",
    "end": "746760"
  },
  {
    "text": "name the dll name of that module and",
    "start": "746760",
    "end": "749480"
  },
  {
    "text": "trying to see if it matches a",
    "start": "749480",
    "end": "751160"
  },
  {
    "text": "pre-computed hash and the pre-computed",
    "start": "751160",
    "end": "752959"
  },
  {
    "text": "hash comes from this hash table here",
    "start": "752959",
    "end": "754600"
  },
  {
    "text": "which is just a long string of bytes if",
    "start": "754600",
    "end": "757040"
  },
  {
    "text": "they're using to do their own custom",
    "start": "757040",
    "end": "758240"
  },
  {
    "text": "hashing function so they're searching",
    "start": "758240",
    "end": "760000"
  },
  {
    "text": "for this hash here now my buddy Nord",
    "start": "760000",
    "end": "762839"
  },
  {
    "text": "Garen and my buddy John Hammond who are",
    "start": "762839",
    "end": "764560"
  },
  {
    "text": "working on this also go check out his",
    "start": "764560",
    "end": "766040"
  },
  {
    "text": "video on this when it comes out uh they",
    "start": "766040",
    "end": "767600"
  },
  {
    "text": "sent me this script here called hash",
    "start": "767600",
    "end": "769959"
  },
  {
    "text": "dopy and if I do Python 3 hash dopy and",
    "start": "769959",
    "end": "773320"
  },
  {
    "text": "I type in kernel32.dll you'll see that",
    "start": "773320",
    "end": "776920"
  },
  {
    "text": "this string here is the string for colel",
    "start": "776920",
    "end": "780959"
  },
  {
    "text": "32.dll so what they're looking for here",
    "start": "780959",
    "end": "783760"
  },
  {
    "text": "they're walking the pev they're walking",
    "start": "783760",
    "end": "785360"
  },
  {
    "text": "the process environment block and trying",
    "start": "785360",
    "end": "787399"
  },
  {
    "text": "to see okay cool where is colel 32.dll",
    "start": "787399",
    "end": "791360"
  },
  {
    "text": "so then they take this and they set this",
    "start": "791360",
    "end": "794079"
  },
  {
    "text": "variable to be a pointer into that",
    "start": "794079",
    "end": "796160"
  },
  {
    "text": "module so we'll save this as",
    "start": "796160",
    "end": "797760"
  },
  {
    "text": "kernel32.dll right this is a pointer",
    "start": "797760",
    "end": "800639"
  },
  {
    "text": "into that module so once theyve found",
    "start": "800639",
    "end": "802959"
  },
  {
    "text": "this module they jump ahead Here and Now",
    "start": "802959",
    "end": "805120"
  },
  {
    "text": "what they're going to do is they're",
    "start": "805120",
    "end": "806120"
  },
  {
    "text": "going to walk the export address table",
    "start": "806120",
    "end": "809320"
  },
  {
    "text": "which is the table inside the dll that",
    "start": "809320",
    "end": "811600"
  },
  {
    "text": "tells you what functions are exported",
    "start": "811600",
    "end": "814079"
  },
  {
    "text": "and they're going to look for another",
    "start": "814079",
    "end": "816079"
  },
  {
    "text": "hash another signature and after doing",
    "start": "816079",
    "end": "817760"
  },
  {
    "text": "some kind of brute forcing here we found",
    "start": "817760",
    "end": "819600"
  },
  {
    "text": "out that this actually stands for create",
    "start": "819600",
    "end": "821959"
  },
  {
    "text": "thread right so this is that string here",
    "start": "821959",
    "end": "824519"
  },
  {
    "text": "this is a really really interesting",
    "start": "824519",
    "end": "826279"
  },
  {
    "text": "technique of knowing what functions you",
    "start": "826279",
    "end": "828760"
  },
  {
    "text": "need ahead of time being able to save",
    "start": "828760",
    "end": "831480"
  },
  {
    "text": "them but not reveal to an antivirus",
    "start": "831480",
    "end": "834160"
  },
  {
    "text": "engine or some kind of signature-based",
    "start": "834160",
    "end": "836680"
  },
  {
    "text": "detection what is actually happening now",
    "start": "836680",
    "end": "839320"
  },
  {
    "text": "typically a behavior-based detection",
    "start": "839320",
    "end": "841639"
  },
  {
    "text": "engine will see a dll walking the pet",
    "start": "841639",
    "end": "844199"
  },
  {
    "text": "and be like wao what what are you doing",
    "start": "844199",
    "end": "846320"
  },
  {
    "text": "um but if it's looking for a set of",
    "start": "846320",
    "end": "848160"
  },
  {
    "text": "strings like this this malware actually",
    "start": "848160",
    "end": "850680"
  },
  {
    "text": "will not pick up on that so ultimately",
    "start": "850680",
    "end": "853120"
  },
  {
    "text": "when you're doing reverse engineering",
    "start": "853120",
    "end": "854519"
  },
  {
    "text": "for malware you could sit there and you",
    "start": "854519",
    "end": "856079"
  },
  {
    "text": "could spend a lot of time diving into",
    "start": "856079",
    "end": "857920"
  },
  {
    "text": "the weeds of exactly what the malware is",
    "start": "857920",
    "end": "860120"
  },
  {
    "text": "doing or you could just run it now I",
    "start": "860120",
    "end": "862639"
  },
  {
    "text": "suggest not running it locally you can",
    "start": "862639",
    "end": "864199"
  },
  {
    "text": "use website like for example uh you know",
    "start": "864199",
    "end": "866000"
  },
  {
    "text": "Joe's Cloud sandbox and they put it into",
    "start": "866000",
    "end": "868360"
  },
  {
    "text": "a VM for you they virtualize it to the",
    "start": "868360",
    "end": "870639"
  },
  {
    "text": "point where hopefully the the malware",
    "start": "870639",
    "end": "872680"
  },
  {
    "text": "can't see that it's in a VM and they run",
    "start": "872680",
    "end": "875079"
  },
  {
    "text": "the program to see what happens and they",
    "start": "875079",
    "end": "876560"
  },
  {
    "text": "eventually CAU that it does do dll side",
    "start": "876560",
    "end": "879040"
  },
  {
    "text": "loading process injection and it",
    "start": "879040",
    "end": "881480"
  },
  {
    "text": "enumerates a ton of information about",
    "start": "881480",
    "end": "883240"
  },
  {
    "text": "your system and eventually tries to",
    "start": "883240",
    "end": "885320"
  },
  {
    "text": "steal a crypto wallet if you have one",
    "start": "885320",
    "end": "887519"
  },
  {
    "text": "right so pretty standard stuff for",
    "start": "887519",
    "end": "889800"
  },
  {
    "text": "crypto uh crypto wallet stealing but",
    "start": "889800",
    "end": "892199"
  },
  {
    "text": "very advanced in terms of how much work",
    "start": "892199",
    "end": "893959"
  },
  {
    "text": "went into hiding the details of the",
    "start": "893959",
    "end": "896160"
  },
  {
    "text": "malware I'm assuming probably to do",
    "start": "896160",
    "end": "897560"
  },
  {
    "text": "antivirus or antivirus bypass so what",
    "start": "897560",
    "end": "899839"
  },
  {
    "text": "should you take away from this video",
    "start": "899839",
    "end": "901279"
  },
  {
    "text": "first of all when you're playing video",
    "start": "901279",
    "end": "902920"
  },
  {
    "text": "games be very careful of what you",
    "start": "902920",
    "end": "904240"
  },
  {
    "text": "download uh a lot of mods end up just",
    "start": "904240",
    "end": "906199"
  },
  {
    "text": "being code and do you know about the",
    "start": "906199",
    "end": "908240"
  },
  {
    "text": "details of all the code maybe you reduce",
    "start": "908240",
    "end": "910399"
  },
  {
    "text": "your trust to just the game manufacturer",
    "start": "910399",
    "end": "912040"
  },
  {
    "text": "itself or like me maybe if it's Riot",
    "start": "912040",
    "end": "914440"
  },
  {
    "text": "games for example you don't play the",
    "start": "914440",
    "end": "915519"
  },
  {
    "text": "game at all um and yeah so that's it for",
    "start": "915519",
    "end": "918120"
  },
  {
    "text": "the video guys I appreciate you watching",
    "start": "918120",
    "end": "919720"
  },
  {
    "text": "um I hope you enjoyed this one if you",
    "start": "919720",
    "end": "920720"
  },
  {
    "text": "did hit subscribe and then go check out",
    "start": "920720",
    "end": "922120"
  },
  {
    "text": "this video that I think you will also",
    "start": "922120",
    "end": "923720"
  },
  {
    "text": "enjoy just as much appreciate it",
    "start": "923720",
    "end": "927319"
  }
]