[
  {
    "text": "some bugs are straight up unforgivable",
    "start": "40",
    "end": "2120"
  },
  {
    "text": "now before we start I understand this",
    "start": "2120",
    "end": "4000"
  },
  {
    "text": "video is going to get no views because",
    "start": "4000",
    "end": "5440"
  },
  {
    "text": "I'm wearing a collared shirt and",
    "start": "5440",
    "end": "6480"
  },
  {
    "text": "apparently like genen Z hates callar but",
    "start": "6480",
    "end": "8639"
  },
  {
    "text": "in this video I want to talk about a",
    "start": "8639",
    "end": "10200"
  },
  {
    "text": "vulnerability in the dlink NZ a network",
    "start": "10200",
    "end": "13040"
  },
  {
    "text": "attached storage that is so egregious",
    "start": "13040",
    "end": "15480"
  },
  {
    "text": "that I'm not sure how a company like",
    "start": "15480",
    "end": "17480"
  },
  {
    "text": "this is not held legally responsible for",
    "start": "17480",
    "end": "19880"
  },
  {
    "text": "this vulnerability in this video we're",
    "start": "19880",
    "end": "21359"
  },
  {
    "text": "talking about the bug we're going to",
    "start": "21359",
    "end": "22560"
  },
  {
    "text": "break it down in gjo we're going to find",
    "start": "22560",
    "end": "24279"
  },
  {
    "text": "the vulnerability now if you're new here",
    "start": "24279",
    "end": "26279"
  },
  {
    "text": "hi my name is Ed this is lowle TV a",
    "start": "26279",
    "end": "28519"
  },
  {
    "text": "channel where I talk about cyber",
    "start": "28519",
    "end": "29560"
  },
  {
    "text": "security software security a bunch of",
    "start": "29560",
    "end": "30880"
  },
  {
    "text": "other cool stuff so if you like this",
    "start": "30880",
    "end": "32040"
  },
  {
    "text": "stuff or just want to hang out with me",
    "start": "32040",
    "end": "33600"
  },
  {
    "text": "hit that sub button I really appreciate",
    "start": "33600",
    "end": "34719"
  },
  {
    "text": "it today attackers now Target a critical",
    "start": "34719",
    "end": "36920"
  },
  {
    "text": "severity vulnerability with publicly",
    "start": "36920",
    "end": "38800"
  },
  {
    "text": "available exploit code that affects",
    "start": "38800",
    "end": "40200"
  },
  {
    "text": "multiple models of endof Life dlink",
    "start": "40200",
    "end": "42480"
  },
  {
    "text": "network attached storage devices tracked",
    "start": "42480",
    "end": "44879"
  },
  {
    "text": "as cve 2024",
    "start": "44879",
    "end": "47680"
  },
  {
    "text": "10914 the command injection",
    "start": "47680",
    "end": "49920"
  },
  {
    "text": "vulnerability allows sending shell",
    "start": "49920",
    "end": "52199"
  },
  {
    "text": "commands arbitrarily by sending a",
    "start": "52199",
    "end": "54600"
  },
  {
    "text": "malicious HTTP get request to vulnerable",
    "start": "54600",
    "end": "57960"
  },
  {
    "text": "devices exposed online and not only that",
    "start": "57960",
    "end": "61079"
  },
  {
    "text": "it oh it gets better hold on the attack",
    "start": "61079",
    "end": "63399"
  },
  {
    "text": "started after dink stated on Friday that",
    "start": "63399",
    "end": "66680"
  },
  {
    "text": "it wouldn't be fixing the security flaw",
    "start": "66680",
    "end": "69240"
  },
  {
    "text": "because it only impacts end of life Nas",
    "start": "69240",
    "end": "71920"
  },
  {
    "text": "models warning customers to retire",
    "start": "71920",
    "end": "74040"
  },
  {
    "text": "affected devices or upgrade them to",
    "start": "74040",
    "end": "75640"
  },
  {
    "text": "newer product so what that means in",
    "start": "75640",
    "end": "77400"
  },
  {
    "text": "layman's terms is hey our code is so bad",
    "start": "77400",
    "end": "80720"
  },
  {
    "text": "and so old that now it's your problem if",
    "start": "80720",
    "end": "83479"
  },
  {
    "text": "you get hacked because we don't want to",
    "start": "83479",
    "end": "85320"
  },
  {
    "text": "deal with it cuz who determines the end",
    "start": "85320",
    "end": "87520"
  },
  {
    "text": "of life timeline for a product oh yeah",
    "start": "87520",
    "end": "89960"
  },
  {
    "text": "it's the manufacturer okay so what this",
    "start": "89960",
    "end": "92600"
  },
  {
    "text": "means is that dink is putting it on the",
    "start": "92600",
    "end": "94600"
  },
  {
    "text": "consumer to buy another Nas that",
    "start": "94600",
    "end": "97280"
  },
  {
    "text": "definitely doesn't have other",
    "start": "97280",
    "end": "98680"
  },
  {
    "text": "vulnerabilities in it because you",
    "start": "98680",
    "end": "101520"
  },
  {
    "text": "um it's absolutely insane to me so I",
    "start": "101520",
    "end": "103399"
  },
  {
    "text": "want to talk a little bit about this bug",
    "start": "103399",
    "end": "104560"
  },
  {
    "text": "again 20241 914 found by this guy named",
    "start": "104560",
    "end": "108079"
  },
  {
    "text": "net SE fish props to him now what you're",
    "start": "108079",
    "end": "110399"
  },
  {
    "text": "probably thinking is like oh my God",
    "start": "110399",
    "end": "112360"
  },
  {
    "text": "arbitrary command injection that has to",
    "start": "112360",
    "end": "114200"
  },
  {
    "text": "be some kind of crazy vulnerability that",
    "start": "114200",
    "end": "116560"
  },
  {
    "text": "exploits a buffer overflow and you use",
    "start": "116560",
    "end": "119079"
  },
  {
    "text": "that to R round you call ECT and that d",
    "start": "119079",
    "end": "122399"
  },
  {
    "text": "ects a page and you can use that to run",
    "start": "122399",
    "end": "124479"
  },
  {
    "text": "Shell Code nope it's this it's this it's",
    "start": "124479",
    "end": "131039"
  },
  {
    "text": "this a single curl command to the Target",
    "start": "131239",
    "end": "135040"
  },
  {
    "text": "IP with the command CGI add username oh",
    "start": "135040",
    "end": "138640"
  },
  {
    "text": "look at that and you just kind of you",
    "start": "138640",
    "end": "140040"
  },
  {
    "text": "just kind of put your shell command in",
    "start": "140040",
    "end": "141840"
  },
  {
    "text": "the command and it echoes it the",
    "start": "141840",
    "end": "144800"
  },
  {
    "text": "commands here is them showing over TCP",
    "start": "144800",
    "end": "147480"
  },
  {
    "text": "in wire shark uh if they inject the",
    "start": "147480",
    "end": "149519"
  },
  {
    "text": "command and Echo some B Bas 64 string",
    "start": "149519",
    "end": "153040"
  },
  {
    "text": "out comes the base 64 strings this means",
    "start": "153040",
    "end": "155519"
  },
  {
    "text": "that it is running the command via a",
    "start": "155519",
    "end": "157360"
  },
  {
    "text": "command injection and and that's it and",
    "start": "157360",
    "end": "160000"
  },
  {
    "text": "so this guy found the bug you know he",
    "start": "160000",
    "end": "161720"
  },
  {
    "text": "reported it to dink they told him the",
    "start": "161720",
    "end": "163040"
  },
  {
    "text": " off and the recommendation is apply",
    "start": "163040",
    "end": "165400"
  },
  {
    "text": "available patches and updates from the",
    "start": "165400",
    "end": "166840"
  },
  {
    "text": "manufacturer oh wait there aren't any",
    "start": "166840",
    "end": "169080"
  },
  {
    "text": "because dlink gave up and then uh to",
    "start": "169080",
    "end": "171519"
  },
  {
    "text": "just I guess not use the IP addresses",
    "start": "171519",
    "end": "174080"
  },
  {
    "text": "now obviously like you shouldn't have",
    "start": "174080",
    "end": "176239"
  },
  {
    "text": "your Nas with like its butt and the",
    "start": "176239",
    "end": "178200"
  },
  {
    "text": "ethernet port like facing out to the",
    "start": "178200",
    "end": "180159"
  },
  {
    "text": "Internet so like if you're doing that",
    "start": "180159",
    "end": "182400"
  },
  {
    "text": "already shame on you I guess but also um",
    "start": "182400",
    "end": "185280"
  },
  {
    "text": "the fact that there isn't a simple patch",
    "start": "185280",
    "end": "186640"
  },
  {
    "text": "for this is kind of crazy When I Was",
    "start": "186640",
    "end": "188720"
  },
  {
    "text": "preparing to make this video um I did",
    "start": "188720",
    "end": "191879"
  },
  {
    "text": "some initial reverse engineering on this",
    "start": "191879",
    "end": "193560"
  },
  {
    "text": "I wanted to look at the bug and to just",
    "start": "193560",
    "end": "195519"
  },
  {
    "text": "kind of able to show in the binary where",
    "start": "195519",
    "end": "197400"
  },
  {
    "text": "the bug was happening and this bug is so",
    "start": "197400",
    "end": "200840"
  },
  {
    "text": "silly I cannot even describe to you how",
    "start": "200840",
    "end": "203400"
  },
  {
    "text": "silly it is I have to show it to you and",
    "start": "203400",
    "end": "205680"
  },
  {
    "text": "you may pee your pants let's go I",
    "start": "205680",
    "end": "208120"
  },
  {
    "text": "personally believe that in a world where",
    "start": "208120",
    "end": "210000"
  },
  {
    "text": "JavaScript and typescript and python",
    "start": "210000",
    "end": "212000"
  },
  {
    "text": "these higher level languages are",
    "start": "212000",
    "end": "213360"
  },
  {
    "text": "becoming more and more popular it is",
    "start": "213360",
    "end": "215040"
  },
  {
    "text": "becoming more and more important to",
    "start": "215040",
    "end": "216920"
  },
  {
    "text": "understand the fundamentals of computers",
    "start": "216920",
    "end": "219080"
  },
  {
    "text": "on my site level Academy I have courses",
    "start": "219080",
    "end": "221159"
  },
  {
    "text": "that'll teach you just that in my course",
    "start": "221159",
    "end": "223439"
  },
  {
    "text": "Zero to Hero C programming I'll teach",
    "start": "223439",
    "end": "224879"
  },
  {
    "text": "you how to code in the C programming",
    "start": "224879",
    "end": "226400"
  },
  {
    "text": "language we'll build a nice little",
    "start": "226400",
    "end": "227760"
  },
  {
    "text": "project to get your hands dirty I'll",
    "start": "227760",
    "end": "229120"
  },
  {
    "text": "Teach You How Network code works and",
    "start": "229120",
    "end": "230799"
  },
  {
    "text": "we'll build on that and get into threads",
    "start": "230799",
    "end": "232239"
  },
  {
    "text": "and even if you want to get even crazier",
    "start": "232239",
    "end": "233680"
  },
  {
    "text": "I'll teach you how to code in assembly",
    "start": "233680",
    "end": "235599"
  },
  {
    "text": "you can go right now and take my load",
    "start": "235599",
    "end": "237200"
  },
  {
    "text": "operations lesson learn how the load",
    "start": "237200",
    "end": "238720"
  },
  {
    "text": "instruction Works in AR assembly or even",
    "start": "238720",
    "end": "240959"
  },
  {
    "text": "try a lesson on arrays for free right",
    "start": "240959",
    "end": "243319"
  },
  {
    "text": "now the courses are on sale get them",
    "start": "243319",
    "end": "244959"
  },
  {
    "text": "while the sale is still going on you",
    "start": "244959",
    "end": "246519"
  },
  {
    "text": "can't be a good coder without knowing",
    "start": "246519",
    "end": "248040"
  },
  {
    "text": "the fundamentals and where do you learn",
    "start": "248040",
    "end": "249319"
  },
  {
    "text": "the fundamentals on lowlevel Academy",
    "start": "249319",
    "end": "251239"
  },
  {
    "text": "back to the video okay so we're in my my",
    "start": "251239",
    "end": "253000"
  },
  {
    "text": "hacking environment here for those of",
    "start": "253000",
    "end": "254200"
  },
  {
    "text": "you that ask I use um a buntu 2204 uh",
    "start": "254200",
    "end": "257160"
  },
  {
    "text": "long-term service and I'm using om my",
    "start": "257160",
    "end": "259000"
  },
  {
    "text": "zsh with zsh shell power level 10K all",
    "start": "259000",
    "end": "261400"
  },
  {
    "text": "those upgrades to make my shell look",
    "start": "261400",
    "end": "263199"
  },
  {
    "text": "nice and pretty um so I was able to",
    "start": "263199",
    "end": "264919"
  },
  {
    "text": "download the firmware for one of the",
    "start": "264919",
    "end": "266800"
  },
  {
    "text": "affected models here this is the DNS 340",
    "start": "266800",
    "end": "269919"
  },
  {
    "text": "L you'll see it has a compile date in",
    "start": "269919",
    "end": "272000"
  },
  {
    "text": "2018 and there are no additional",
    "start": "272000",
    "end": "274080"
  },
  {
    "text": "firmware downloads so that means that",
    "start": "274080",
    "end": "275680"
  },
  {
    "text": "like this is the last firmware you can",
    "start": "275680",
    "end": "277160"
  },
  {
    "text": "get and this one is vulnerable to the",
    "start": "277160",
    "end": "279039"
  },
  {
    "text": "attack so to triage this we have to do a",
    "start": "279039",
    "end": "281120"
  },
  {
    "text": "few things when you download the",
    "start": "281120",
    "end": "282560"
  },
  {
    "text": "firmware you actually get it in this ZIP",
    "start": "282560",
    "end": "284160"
  },
  {
    "text": "file unzip this ZIP file that will",
    "start": "284160",
    "end": "286520"
  },
  {
    "text": "eventually yield this binary file and if",
    "start": "286520",
    "end": "288479"
  },
  {
    "text": "we type file on this we'll see that it's",
    "start": "288479",
    "end": "290199"
  },
  {
    "text": "just data okay so what do we do with",
    "start": "290199",
    "end": "291680"
  },
  {
    "text": "data well a lot of the times if the",
    "start": "291680",
    "end": "293240"
  },
  {
    "text": "firmware isn't encrypted which is what",
    "start": "293240",
    "end": "294880"
  },
  {
    "text": "happens for a lot of these device",
    "start": "294880",
    "end": "295919"
  },
  {
    "text": "manufacturers we can do this thing",
    "start": "295919",
    "end": "297600"
  },
  {
    "text": "called uh binwalk what binwalk does is",
    "start": "297600",
    "end": "299880"
  },
  {
    "text": "it recursively as the capital M does for",
    "start": "299880",
    "end": "301960"
  },
  {
    "text": "mrika dolls it walks through the",
    "start": "301960",
    "end": "304560"
  },
  {
    "text": "firmware image it finds a known file",
    "start": "304560",
    "end": "307280"
  },
  {
    "text": "type that is uncompressible and then it",
    "start": "307280",
    "end": "309320"
  },
  {
    "text": "goes into that and runs the same Pro",
    "start": "309320",
    "end": "311199"
  },
  {
    "text": "program recursively uh and by doing that",
    "start": "311199",
    "end": "313280"
  },
  {
    "text": "we're able to find this thing called a",
    "start": "313280",
    "end": "315320"
  },
  {
    "text": "squashfs file system the squash FS file",
    "start": "315320",
    "end": "318199"
  },
  {
    "text": "system is going to be where all of the",
    "start": "318199",
    "end": "320240"
  },
  {
    "text": "code on the device lives right you'll",
    "start": "320240",
    "end": "322120"
  },
  {
    "text": "see this is literally just the root file",
    "start": "322120",
    "end": "324080"
  },
  {
    "text": "system that would be on the dlink Nas If",
    "start": "324080",
    "end": "326520"
  },
  {
    "text": "you're a bug Bounty Hunter for example",
    "start": "326520",
    "end": "327840"
  },
  {
    "text": "if you want to find vulnerabilities and",
    "start": "327840",
    "end": "329759"
  },
  {
    "text": "fix things in software for embedded",
    "start": "329759",
    "end": "332280"
  },
  {
    "text": "devices this is how you start 99% of the",
    "start": "332280",
    "end": "334560"
  },
  {
    "text": "projects right you go and you get the",
    "start": "334560",
    "end": "335880"
  },
  {
    "text": "firmware you run binw walk and out will",
    "start": "335880",
    "end": "338160"
  },
  {
    "text": "pop out either a squashfs file system",
    "start": "338160",
    "end": "340360"
  },
  {
    "text": "which is a uh runtime compressed and",
    "start": "340360",
    "end": "343360"
  },
  {
    "text": "readon file system or a jf2 jffs2 file",
    "start": "343360",
    "end": "348440"
  },
  {
    "text": "system which is a journaled flash file",
    "start": "348440",
    "end": "350360"
  },
  {
    "text": "system version 2 uh and you can use",
    "start": "350360",
    "end": "352400"
  },
  {
    "text": "those now on your disc to look at the",
    "start": "352400",
    "end": "354160"
  },
  {
    "text": "binaries now as we saw in the article",
    "start": "354160",
    "end": "356520"
  },
  {
    "text": "before we know the vulnerability is",
    "start": "356520",
    "end": "357720"
  },
  {
    "text": "hiding out in this accountmanager cgis",
    "start": "357720",
    "end": "360520"
  },
  {
    "text": "script so let's let's find out if we can",
    "start": "360520",
    "end": "362600"
  },
  {
    "text": "let's see if we can find where this",
    "start": "362600",
    "end": "363840"
  },
  {
    "text": "account manager CGI script runs now",
    "start": "363840",
    "end": "366039"
  },
  {
    "text": "luckily we can go to uh CD CGI and LS",
    "start": "366039",
    "end": "369319"
  },
  {
    "text": "and wow look literally the first thing",
    "start": "369319",
    "end": "371400"
  },
  {
    "text": "that is there is that file what I think",
    "start": "371400",
    "end": "374280"
  },
  {
    "text": "literally happened when this guy was",
    "start": "374280",
    "end": "375720"
  },
  {
    "text": "doing this research is he wanted to find",
    "start": "375720",
    "end": "377960"
  },
  {
    "text": "bugs in this thing and I think what he",
    "start": "377960",
    "end": "379840"
  },
  {
    "text": "probably did is he opened the first CGI",
    "start": "379840",
    "end": "383039"
  },
  {
    "text": "file and like found a bug immediately",
    "start": "383039",
    "end": "385160"
  },
  {
    "text": "because of how bad this code is let's go",
    "start": "385160",
    "end": "387800"
  },
  {
    "text": "into it and show you how bad the code is",
    "start": "387800",
    "end": "390360"
  },
  {
    "text": "if you know anything about CGI typically",
    "start": "390360",
    "end": "392520"
  },
  {
    "text": "CGI takes two forms either it is a bash",
    "start": "392520",
    "end": "395520"
  },
  {
    "text": "script that runs when you give it CGI",
    "start": "395520",
    "end": "397880"
  },
  {
    "text": "perams or it is an elf that runs an",
    "start": "397880",
    "end": "400880"
  },
  {
    "text": "executable linkable format file like in",
    "start": "400880",
    "end": "402680"
  },
  {
    "text": "Linux that runs uh when you give it",
    "start": "402680",
    "end": "405720"
  },
  {
    "text": "commands right so if I go to the SL CGI",
    "start": "405720",
    "end": "408280"
  },
  {
    "text": "bin account manager. cgip path it'll run",
    "start": "408280",
    "end": "411520"
  },
  {
    "text": "the associated program so that here is",
    "start": "411520",
    "end": "413720"
  },
  {
    "text": "going to be account manager. CGI now",
    "start": "413720",
    "end": "416240"
  },
  {
    "text": "I've loaded this up into gidra here",
    "start": "416240",
    "end": "418120"
  },
  {
    "text": "gidra if you don't know is the reverse",
    "start": "418120",
    "end": "419840"
  },
  {
    "text": "engineering framework that was produced",
    "start": "419840",
    "end": "421560"
  },
  {
    "text": "by the NSA it's really really good I",
    "start": "421560",
    "end": "423440"
  },
  {
    "text": "like it they also have dark mode which",
    "start": "423440",
    "end": "424960"
  },
  {
    "text": "is super awesome uh but you'll see here",
    "start": "424960",
    "end": "427199"
  },
  {
    "text": "we have this thing called the CGI main",
    "start": "427199",
    "end": "428960"
  },
  {
    "text": "function the CGI main function as it",
    "start": "428960",
    "end": "430759"
  },
  {
    "text": "kind of implies is the main function",
    "start": "430759",
    "end": "433599"
  },
  {
    "text": "that gets ran whenever you call this CGI",
    "start": "433599",
    "end": "436199"
  },
  {
    "text": "binary and what it does is it extracts",
    "start": "436199",
    "end": "439240"
  },
  {
    "text": "the name of the the parameter that you",
    "start": "439240",
    "end": "441520"
  },
  {
    "text": "want to run and puts it into the stir",
    "start": "441520",
    "end": "443199"
  },
  {
    "text": "compare operation and so we know the",
    "start": "443199",
    "end": "445000"
  },
  {
    "text": "vulnerability from before comes from the",
    "start": "445000",
    "end": "447879"
  },
  {
    "text": "what is it the CGI user app add",
    "start": "447879",
    "end": "449720"
  },
  {
    "text": "functions we're just going to go into",
    "start": "449720",
    "end": "451080"
  },
  {
    "text": "the function that gets called if the",
    "start": "451080",
    "end": "452800"
  },
  {
    "text": "stir compare returns zero which is going",
    "start": "452800",
    "end": "455280"
  },
  {
    "text": "to be this function here the one that",
    "start": "455280",
    "end": "456520"
  },
  {
    "text": "handles adding the user so when I Was",
    "start": "456520",
    "end": "459160"
  },
  {
    "text": "preparing this video I I opened this and",
    "start": "459160",
    "end": "462560"
  },
  {
    "text": "immediately I saw this safe system",
    "start": "462560",
    "end": "464919"
  },
  {
    "text": "function and so if you've ever done uh",
    "start": "464919",
    "end": "467680"
  },
  {
    "text": "programming or you've you've you've used",
    "start": "467680",
    "end": "469840"
  },
  {
    "text": "C before you know that the system",
    "start": "469840",
    "end": "472440"
  },
  {
    "text": "function on its own is very very easy to",
    "start": "472440",
    "end": "475120"
  },
  {
    "text": "get wrong if you don't know how to",
    "start": "475120",
    "end": "476360"
  },
  {
    "text": "program I can talk about it real quick",
    "start": "476360",
    "end": "478400"
  },
  {
    "text": "the the system function is literally how",
    "start": "478400",
    "end": "481080"
  },
  {
    "text": "can you in C run a shell command so if I",
    "start": "481080",
    "end": "484800"
  },
  {
    "text": "for example wanted to have my program",
    "start": "484800",
    "end": "487159"
  },
  {
    "text": "Echo uh hello right hello would print",
    "start": "487159",
    "end": "490560"
  },
  {
    "text": "nothing but if I say hello equals 1 and",
    "start": "490560",
    "end": "493599"
  },
  {
    "text": "I say Echo hello it it echoes one I can",
    "start": "493599",
    "end": "497080"
  },
  {
    "text": "run all these commands in C by simply",
    "start": "497080",
    "end": "499879"
  },
  {
    "text": "doing the system command now the reason",
    "start": "499879",
    "end": "502120"
  },
  {
    "text": "there are vulnerabilities in this",
    "start": "502120",
    "end": "503479"
  },
  {
    "text": "command is if I were able to say for",
    "start": "503479",
    "end": "505599"
  },
  {
    "text": "example that hello is equal to bin LS",
    "start": "505599",
    "end": "509199"
  },
  {
    "text": "and then I say Echo and then Echo the",
    "start": "509199",
    "end": "512518"
  },
  {
    "text": "contents of hello this will actually run",
    "start": "512519",
    "end": "514680"
  },
  {
    "text": "the command inside of it this this whole",
    "start": "514680",
    "end": "516159"
  },
  {
    "text": "thing is known as a command injection",
    "start": "516159",
    "end": "517919"
  },
  {
    "text": "where basically if you're able to",
    "start": "517919",
    "end": "519039"
  },
  {
    "text": "control the contents of a system command",
    "start": "519039",
    "end": "521360"
  },
  {
    "text": "you can put malicious stuff in there",
    "start": "521360",
    "end": "523640"
  },
  {
    "text": "okay so how do we get around this well",
    "start": "523640",
    "end": "525519"
  },
  {
    "text": "dlink actually initially and this is",
    "start": "525519",
    "end": "528120"
  },
  {
    "text": "where it starts to get really funny they",
    "start": "528120",
    "end": "529800"
  },
  {
    "text": "they wrote this rapper called safe",
    "start": "529800",
    "end": "531720"
  },
  {
    "text": "system and so I I dove deep into safe",
    "start": "531720",
    "end": "534680"
  },
  {
    "text": "system I'm like okay so they call",
    "start": "534680",
    "end": "536880"
  },
  {
    "text": "account which is probably a program that",
    "start": "536880",
    "end": "538959"
  },
  {
    "text": "adds an account okay and so they get",
    "start": "538959",
    "end": "541079"
  },
  {
    "text": "this U from oh the name variable that's",
    "start": "541079",
    "end": "543760"
  },
  {
    "text": "probably the username oh they get this P",
    "start": "543760",
    "end": "546079"
  },
  {
    "text": "flag from the password variable oh",
    "start": "546079",
    "end": "548279"
  },
  {
    "text": "probably the password for the account",
    "start": "548279",
    "end": "549880"
  },
  {
    "text": "and then I okay so maybe there's a",
    "start": "549880",
    "end": "551000"
  },
  {
    "text": "vulnerability in safe system so you'll",
    "start": "551000",
    "end": "554040"
  },
  {
    "text": "actually see that safe system is",
    "start": "554040",
    "end": "555680"
  },
  {
    "text": "imported from this lib safe system.so",
    "start": "555680",
    "end": "558640"
  },
  {
    "text": "binary okay okay okay so let's see what",
    "start": "558640",
    "end": "560760"
  },
  {
    "text": "safe system does um let's see it parses",
    "start": "560760",
    "end": "564160"
  },
  {
    "text": "some string it's iterating over some set",
    "start": "564160",
    "end": "566560"
  },
  {
    "text": "of strings and then it passes that into",
    "start": "566560",
    "end": "568920"
  },
  {
    "text": "safe exec oh interesting okay so how",
    "start": "568920",
    "end": "571640"
  },
  {
    "text": "does exec work well safe exec what it",
    "start": "571640",
    "end": "573760"
  },
  {
    "text": "does is it sets up a bunch of these Sig",
    "start": "573760",
    "end": "575480"
  },
  {
    "text": "actions that handle different signals in",
    "start": "575480",
    "end": "577920"
  },
  {
    "text": "the program right don't worry about that",
    "start": "577920",
    "end": "579160"
  },
  {
    "text": "what that means but at the end of the",
    "start": "579160",
    "end": "580480"
  },
  {
    "text": "day what it does is it Forks which means",
    "start": "580480",
    "end": "581880"
  },
  {
    "text": "it makes a new process and eventually it",
    "start": "581880",
    "end": "584440"
  },
  {
    "text": "calls this function exec CVP or",
    "start": "584440",
    "end": "588360"
  },
  {
    "text": "execvp now execvp is actually much much",
    "start": "588360",
    "end": "592160"
  },
  {
    "text": "safer than system the reason being when",
    "start": "592160",
    "end": "595160"
  },
  {
    "text": "you run the system command a system",
    "start": "595160",
    "end": "597680"
  },
  {
    "text": "command is just saying EX ex the command",
    "start": "597680",
    "end": "601120"
  },
  {
    "text": "in a shell which means that all of the",
    "start": "601120",
    "end": "603600"
  },
  {
    "text": "command substitution things like this",
    "start": "603600",
    "end": "605519"
  },
  {
    "text": "for example will actually get",
    "start": "605519",
    "end": "607360"
  },
  {
    "text": "interpreted if I were to instead do",
    "start": "607360",
    "end": "611640"
  },
  {
    "text": "execvp I don't have the command",
    "start": "611640",
    "end": "614360"
  },
  {
    "text": "substitutions I'm not running it in a",
    "start": "614360",
    "end": "616399"
  },
  {
    "text": "shell I'm just doing a direct CIS call",
    "start": "616399",
    "end": "619160"
  },
  {
    "text": "to the operating system so when I was",
    "start": "619160",
    "end": "621160"
  },
  {
    "text": "reading this code I was like man what",
    "start": "621160",
    "end": "623160"
  },
  {
    "text": "what could they possibly be doing wrong",
    "start": "623160",
    "end": "625399"
  },
  {
    "text": "that enables a command injection this is",
    "start": "625399",
    "end": "627040"
  },
  {
    "text": "actually the canonically correct way to",
    "start": "627040",
    "end": "629320"
  },
  {
    "text": "to write code that doesn't have a",
    "start": "629320",
    "end": "631760"
  },
  {
    "text": "command injection what is happening here",
    "start": "631760",
    "end": "633959"
  },
  {
    "text": "so I go back I go look at the path and",
    "start": "633959",
    "end": "635720"
  },
  {
    "text": "I'm like okay so what they're they're",
    "start": "635720",
    "end": "637279"
  },
  {
    "text": "calling safe system that calls exec what",
    "start": "637279",
    "end": "640079"
  },
  {
    "text": "are they calling safe system on account",
    "start": "640079",
    "end": "643240"
  },
  {
    "text": "oh okay so they they wrote another",
    "start": "643240",
    "end": "645680"
  },
  {
    "text": "program to create accounts okay okay",
    "start": "645680",
    "end": "648279"
  },
  {
    "text": "let's go into account and see what's",
    "start": "648279",
    "end": "649560"
  },
  {
    "text": "going on in",
    "start": "649560",
    "end": "652000"
  },
  {
    "text": "account and so",
    "start": "652440",
    "end": "655399"
  },
  {
    "text": "it do you see do you see this do you see",
    "start": "655399",
    "end": "658440"
  },
  {
    "text": "what's happening",
    "start": "658440",
    "end": "659959"
  },
  {
    "text": "in the account program that they",
    "start": "659959",
    "end": "664160"
  },
  {
    "text": "wrote that they call with safe system",
    "start": "664160",
    "end": "667880"
  },
  {
    "text": "they not only use S printf which is a",
    "start": "667880",
    "end": "671120"
  },
  {
    "text": "vulnerable function that enables stack",
    "start": "671120",
    "end": "672880"
  },
  {
    "text": "overflows onto the stack but then they",
    "start": "672880",
    "end": "675920"
  },
  {
    "text": "call not safe system they call system so",
    "start": "675920",
    "end": "681079"
  },
  {
    "text": "what does that mean you can arbitrarily",
    "start": "681079",
    "end": "684120"
  },
  {
    "text": "include commands in your username and it",
    "start": "684120",
    "end": "687920"
  },
  {
    "text": "will get ran as system",
    "start": "687920",
    "end": "689880"
  },
  {
    "text": "despite the fact that they put it into",
    "start": "689880",
    "end": "693560"
  },
  {
    "text": "safe system I I like you can't make this",
    "start": "693560",
    "end": "696880"
  },
  {
    "text": "stuff up dude they wrote an entire",
    "start": "696880",
    "end": "698920"
  },
  {
    "text": "function to prevent this from happening",
    "start": "698920",
    "end": "701639"
  },
  {
    "text": "and then the program that they call with",
    "start": "701639",
    "end": "704120"
  },
  {
    "text": "this other",
    "start": "704120",
    "end": "705399"
  },
  {
    "text": "program has the vulnerability they were",
    "start": "705399",
    "end": "707519"
  },
  {
    "text": "trying to avoid it it is truly a",
    "start": "707519",
    "end": "710120"
  },
  {
    "text": "vulnerability of the times I just it's I",
    "start": "710120",
    "end": "713000"
  },
  {
    "text": "I I don't know what to make out of this",
    "start": "713000",
    "end": "714760"
  },
  {
    "text": "the the whole point of this video is",
    "start": "714760",
    "end": "715959"
  },
  {
    "text": "that some bugs are acceptable some d",
    "start": "715959",
    "end": "719360"
  },
  {
    "text": "bugs are understandable a time of check",
    "start": "719360",
    "end": "722160"
  },
  {
    "text": "time of use vulnerability that enables a",
    "start": "722160",
    "end": "723920"
  },
  {
    "text": "use after free or a race condition um a",
    "start": "723920",
    "end": "727040"
  },
  {
    "text": "buffer overflow where like you do a",
    "start": "727040",
    "end": "729160"
  },
  {
    "text": "minus one and you wrap around the length",
    "start": "729160",
    "end": "731279"
  },
  {
    "text": "value and you get this Max in copy okay",
    "start": "731279",
    "end": "733800"
  },
  {
    "text": "okay you missed that but bro like look",
    "start": "733800",
    "end": "737079"
  },
  {
    "text": "at this it's a percent s into a",
    "start": "737079",
    "end": "740480"
  },
  {
    "text": "Sprint F into a system man how how is",
    "start": "740480",
    "end": "745360"
  },
  {
    "text": "nobody held accountable I don't get it",
    "start": "745360",
    "end": "748959"
  },
  {
    "text": "it's it's crazy to me anyway if you want",
    "start": "748959",
    "end": "751560"
  },
  {
    "text": "to go poke around at this I'm going to",
    "start": "751560",
    "end": "752839"
  },
  {
    "text": "leave a link to the firmware in the",
    "start": "752839",
    "end": "754360"
  },
  {
    "text": "description below if you think these",
    "start": "754360",
    "end": "755600"
  },
  {
    "text": "videos are good if you enjoyed this if",
    "start": "755600",
    "end": "757959"
  },
  {
    "text": "you think I'm stupid any one of them hit",
    "start": "757959",
    "end": "759639"
  },
  {
    "text": "subscribe I appreciate it and then go",
    "start": "759639",
    "end": "761399"
  },
  {
    "text": "check out this video where I did",
    "start": "761399",
    "end": "762880"
  },
  {
    "text": "something actually very similar for a",
    "start": "762880",
    "end": "764320"
  },
  {
    "text": "different iot device um we'll see you",
    "start": "764320",
    "end": "766760"
  },
  {
    "text": "there thanks for watching guys I",
    "start": "766760",
    "end": "767920"
  },
  {
    "text": "appreciate it",
    "start": "767920",
    "end": "771120"
  }
]