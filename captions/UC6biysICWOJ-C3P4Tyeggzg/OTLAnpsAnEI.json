[
  {
    "start": "0",
    "end": "36000"
  },
  {
    "text": "The Internet of Things sucks now this is",
    "start": "80",
    "end": "2240"
  },
  {
    "text": "an adage you've probably heard time and",
    "start": "2240",
    "end": "4040"
  },
  {
    "text": "time again in this video we're going to",
    "start": "4040",
    "end": "5480"
  },
  {
    "text": "go down the rabbit hole of why this is",
    "start": "5480",
    "end": "7480"
  },
  {
    "text": "the case we're to talk about a zero day",
    "start": "7480",
    "end": "9519"
  },
  {
    "text": "that was found in an IP camera that is",
    "start": "9519",
    "end": "12000"
  },
  {
    "text": "now being turned into a botnet to Dos or",
    "start": "12000",
    "end": "14879"
  },
  {
    "text": "denial of service websites across the",
    "start": "14879",
    "end": "16640"
  },
  {
    "text": "internet we're going to talk about the",
    "start": "16640",
    "end": "17760"
  },
  {
    "text": "vulnerability itself we're actually",
    "start": "17760",
    "end": "18920"
  },
  {
    "text": "going to reverse engineer the binary to",
    "start": "18920",
    "end": "21199"
  },
  {
    "text": "figure out what's going on inside the",
    "start": "21199",
    "end": "23000"
  },
  {
    "text": "camera and then we'll talk about why",
    "start": "23000",
    "end": "24920"
  },
  {
    "text": "this is such a problem and how maybe we",
    "start": "24920",
    "end": "26279"
  },
  {
    "text": "can fix it now if you're new here hi my",
    "start": "26279",
    "end": "28880"
  },
  {
    "text": "name is Ed this is all learn a channel",
    "start": "28880",
    "end": "30359"
  },
  {
    "text": "where I talk about cyber security",
    "start": "30359",
    "end": "31679"
  },
  {
    "text": "software security bunch of other cool",
    "start": "31679",
    "end": "33200"
  },
  {
    "text": "stuff if you like that or just want to",
    "start": "33200",
    "end": "34680"
  },
  {
    "text": "hang out hit that sub button I really",
    "start": "34680",
    "end": "35920"
  },
  {
    "text": "appreciate it ah another day another",
    "start": "35920",
    "end": "37960"
  },
  {
    "start": "36000",
    "end": "340000"
  },
  {
    "text": "vulnerability uh this one says",
    "start": "37960",
    "end": "39719"
  },
  {
    "text": "unpatchable zero day in surveillance cam",
    "start": "39719",
    "end": "42280"
  },
  {
    "text": "is being exploited to install marai",
    "start": "42280",
    "end": "44640"
  },
  {
    "text": "we're going to walk through what this",
    "start": "44640",
    "end": "45719"
  },
  {
    "text": "bug is all about and I actually have the",
    "start": "45719",
    "end": "47399"
  },
  {
    "text": "firmware of this camera in my virtual",
    "start": "47399",
    "end": "49399"
  },
  {
    "text": "machine we're going to rip that apart",
    "start": "49399",
    "end": "51160"
  },
  {
    "text": "and I'm actually going to go through the",
    "start": "51160",
    "end": "52440"
  },
  {
    "text": "binary and figure out exactly what the",
    "start": "52440",
    "end": "54239"
  },
  {
    "text": "bug is and talk about honestly how",
    "start": "54239",
    "end": "56520"
  },
  {
    "text": "ridiculous this is and how ridiculous",
    "start": "56520",
    "end": "58840"
  },
  {
    "text": "the state of the iot software ecosystem",
    "start": "58840",
    "end": "61519"
  },
  {
    "text": "is is this is like unacceptable behavior",
    "start": "61519",
    "end": "63640"
  },
  {
    "text": "on the part of software security",
    "start": "63640",
    "end": "65239"
  },
  {
    "text": "companies or software companies um and I",
    "start": "65239",
    "end": "67360"
  },
  {
    "text": "wanted just kind of go into it I'm not",
    "start": "67360",
    "end": "68439"
  },
  {
    "text": "going to read the whole thing but I want",
    "start": "68439",
    "end": "69320"
  },
  {
    "text": "to give you a highle overview to",
    "start": "69320",
    "end": "70759"
  },
  {
    "text": "understand what's going on here",
    "start": "70759",
    "end": "71560"
  },
  {
    "text": "malicious hackers are exploiting a",
    "start": "71560",
    "end": "72799"
  },
  {
    "text": "critical vulnerability and a widely used",
    "start": "72799",
    "end": "74640"
  },
  {
    "text": "security camera to spread marai a family",
    "start": "74640",
    "end": "77240"
  },
  {
    "text": "of malware that wrangles infected iot",
    "start": "77240",
    "end": "79640"
  },
  {
    "text": "devices into large networks for uses and",
    "start": "79640",
    "end": "81680"
  },
  {
    "text": "attacks that take down websites and",
    "start": "81680",
    "end": "83280"
  },
  {
    "text": "other iot devices so if you don't know",
    "start": "83280",
    "end": "85439"
  },
  {
    "text": "what a lot of that means hackers are",
    "start": "85439",
    "end": "87240"
  },
  {
    "text": "using vulnerabilities in Internet of",
    "start": "87240",
    "end": "89360"
  },
  {
    "text": "Things software iot software to install",
    "start": "89360",
    "end": "91840"
  },
  {
    "text": "a variant of malware called marai now",
    "start": "91840",
    "end": "94640"
  },
  {
    "text": "marai has been around for a very long",
    "start": "94640",
    "end": "96920"
  },
  {
    "text": "time it actually goes back to like 2016",
    "start": "96920",
    "end": "99360"
  },
  {
    "text": "2015 time period um and I originally",
    "start": "99360",
    "end": "102040"
  },
  {
    "text": "learned of marai when it took down Den",
    "start": "102040",
    "end": "104799"
  },
  {
    "text": "now Den or D however you want to",
    "start": "104799",
    "end": "106320"
  },
  {
    "text": "pronounce it is a g is a gigantic",
    "start": "106320",
    "end": "109040"
  },
  {
    "text": "Dynamic domain name provider right so",
    "start": "109040",
    "end": "110840"
  },
  {
    "text": "it's a provider of a lot of the DNS",
    "start": "110840",
    "end": "112439"
  },
  {
    "text": "resolutions around the internet in 2016",
    "start": "112439",
    "end": "115520"
  },
  {
    "text": "the Mari botnet was able to take down",
    "start": "115520",
    "end": "118719"
  },
  {
    "text": "Den or take down dime and what it did is",
    "start": "118719",
    "end": "120960"
  },
  {
    "text": "it made it so that people just across",
    "start": "120960",
    "end": "122560"
  },
  {
    "text": "the internet couldn't resolve the",
    "start": "122560",
    "end": "123920"
  },
  {
    "text": "domains of basic things they needed",
    "start": "123920",
    "end": "126840"
  },
  {
    "text": "throughout their day there was a huge",
    "start": "126840",
    "end": "128080"
  },
  {
    "text": "showing how a botn net when properly",
    "start": "128080",
    "end": "130239"
  },
  {
    "text": "targeted could take out a huge swap of",
    "start": "130239",
    "end": "131879"
  },
  {
    "text": "the internet and if you dove into the",
    "start": "131879",
    "end": "133720"
  },
  {
    "text": "marai malare we won't do that today but",
    "start": "133720",
    "end": "135599"
  },
  {
    "text": "the morai malware all it did was it",
    "start": "135599",
    "end": "137920"
  },
  {
    "text": "would infect a device by guessing the",
    "start": "137920",
    "end": "140640"
  },
  {
    "text": "default credentials of that device and",
    "start": "140640",
    "end": "143120"
  },
  {
    "text": "then it would log into that device and",
    "start": "143120",
    "end": "145000"
  },
  {
    "text": "install itself and then find more",
    "start": "145000",
    "end": "147080"
  },
  {
    "text": "targets and guess more default",
    "start": "147080",
    "end": "148360"
  },
  {
    "text": "credentials and just literally by doing",
    "start": "148360",
    "end": "149959"
  },
  {
    "text": "like admin admin admin password auntu",
    "start": "149959",
    "end": "153120"
  },
  {
    "text": "auntu admin abc123 Etc it was able to",
    "start": "153120",
    "end": "156680"
  },
  {
    "text": "spread itself across the internet and",
    "start": "156680",
    "end": "159000"
  },
  {
    "text": "shoot like gigabits if not I think",
    "start": "159000",
    "end": "160920"
  },
  {
    "text": "potentially terabits per second at dine",
    "start": "160920",
    "end": "163280"
  },
  {
    "text": "and take it down so that's back in 2016",
    "start": "163280",
    "end": "165000"
  },
  {
    "text": "the malware has evolved it's no longer",
    "start": "165000",
    "end": "167040"
  },
  {
    "text": "just doing the password stuff it's now",
    "start": "167040",
    "end": "169360"
  },
  {
    "text": "taking advantage of vulnerabilities and",
    "start": "169360",
    "end": "170640"
  },
  {
    "text": "installing itself into new hosts and one",
    "start": "170640",
    "end": "172360"
  },
  {
    "text": "of them here is this AVM 123 uh camera",
    "start": "172360",
    "end": "175239"
  },
  {
    "text": "that we will go into the firmware of",
    "start": "175239",
    "end": "176760"
  },
  {
    "text": "here in a second what's crazy about",
    "start": "176760",
    "end": "179879"
  },
  {
    "text": "about this bug is that it is not your",
    "start": "179879",
    "end": "183159"
  },
  {
    "text": "traditional uh exploitation via a buffer",
    "start": "183159",
    "end": "185920"
  },
  {
    "text": "overflow or a memory corruption right",
    "start": "185920",
    "end": "187640"
  },
  {
    "text": "typically we have bugs where you know a",
    "start": "187640",
    "end": "189480"
  },
  {
    "text": "programmer makes it pretty pretty easy",
    "start": "189480",
    "end": "191040"
  },
  {
    "text": "to make a mistake where they don't check",
    "start": "191040",
    "end": "192640"
  },
  {
    "text": "the bounds of their input and they cop",
    "start": "192640",
    "end": "194920"
  },
  {
    "text": "copy it into a smaller buffer because of",
    "start": "194920",
    "end": "196680"
  },
  {
    "text": "that uh that allows us to get remote",
    "start": "196680",
    "end": "198319"
  },
  {
    "text": "code execution or at least corrupt the",
    "start": "198319",
    "end": "200239"
  },
  {
    "text": "memory of the remote process and do evil",
    "start": "200239",
    "end": "202120"
  },
  {
    "text": "things with it what is so bad about this",
    "start": "202120",
    "end": "204879"
  },
  {
    "text": "bug is that it is what is called a",
    "start": "204879",
    "end": "207400"
  },
  {
    "text": "command injection a command injection is",
    "start": "207400",
    "end": "210319"
  },
  {
    "text": "when a programmer uses a function like",
    "start": "210319",
    "end": "212760"
  },
  {
    "text": "system or poop or exec and doesn't",
    "start": "212760",
    "end": "216280"
  },
  {
    "text": "sanitize the input and what you can see",
    "start": "216280",
    "end": "218720"
  },
  {
    "text": "here on to the side of my my fat head is",
    "start": "218720",
    "end": "222000"
  },
  {
    "text": "when they do the action on the camera",
    "start": "222000",
    "end": "224400"
  },
  {
    "text": "that I'm guessing like changes the",
    "start": "224400",
    "end": "225760"
  },
  {
    "text": "brightness of an LED instead of",
    "start": "225760",
    "end": "227799"
  },
  {
    "text": "specifying a brightness value that would",
    "start": "227799",
    "end": "230319"
  },
  {
    "text": "be the regular input of this they can",
    "start": "230319",
    "end": "232680"
  },
  {
    "text": "input CD to Temp W get a file chamod the",
    "start": "232680",
    "end": "236280"
  },
  {
    "text": "file and run the file oh and then also",
    "start": "236280",
    "end": "238640"
  },
  {
    "text": "remove it and out put all of the",
    "start": "238640",
    "end": "241239"
  },
  {
    "text": "standard error to n and that's it okay",
    "start": "241239",
    "end": "243400"
  },
  {
    "text": "taada that's it that's the brightness",
    "start": "243400",
    "end": "245360"
  },
  {
    "text": "value is that string there so what's",
    "start": "245360",
    "end": "248360"
  },
  {
    "text": "crazy is that this is so easy to exploit",
    "start": "248360",
    "end": "251560"
  },
  {
    "text": "for hackers because they don't have to",
    "start": "251560",
    "end": "253000"
  },
  {
    "text": "know the version of the firmware they",
    "start": "253000",
    "end": "254599"
  },
  {
    "text": "don't have to know exactly how big the",
    "start": "254599",
    "end": "256840"
  },
  {
    "text": "stack frame is they don't have to know",
    "start": "256840",
    "end": "258759"
  },
  {
    "text": "any of that stuff dude they literally",
    "start": "258759",
    "end": "260639"
  },
  {
    "text": "can just spray and prey and if the thing",
    "start": "260639",
    "end": "263080"
  },
  {
    "text": "is vulnerable and they can reach this IP",
    "start": "263080",
    "end": "265040"
  },
  {
    "text": "address it will pull down the malware",
    "start": "265040",
    "end": "266840"
  },
  {
    "text": "and it will be added to the botnet and",
    "start": "266840",
    "end": "268639"
  },
  {
    "text": "this is just how iot devices across the",
    "start": "268639",
    "end": "271800"
  },
  {
    "text": "internet have been for a very long time",
    "start": "271800",
    "end": "274080"
  },
  {
    "text": "I have an example here this is an old",
    "start": "274080",
    "end": "275520"
  },
  {
    "text": "router that I used to have in my house I",
    "start": "275520",
    "end": "276840"
  },
  {
    "text": "no longer have it as my house router for",
    "start": "276840",
    "end": "278400"
  },
  {
    "text": "obvious reasons um but that family of",
    "start": "278400",
    "end": "280840"
  },
  {
    "text": "router and if you can guess what it is",
    "start": "280840",
    "end": "281960"
  },
  {
    "text": "in the comments I'd be curious to see if",
    "start": "281960",
    "end": "283240"
  },
  {
    "text": "you know what it is uh every model of",
    "start": "283240",
    "end": "286000"
  },
  {
    "text": "that router was vulnerable to a zero day",
    "start": "286000",
    "end": "288919"
  },
  {
    "text": "for a decade things like this are common",
    "start": "288919",
    "end": "292840"
  },
  {
    "text": "devices that are typically embedded and",
    "start": "292840",
    "end": "294840"
  },
  {
    "text": "Tiny like this little board for example",
    "start": "294840",
    "end": "296600"
  },
  {
    "text": "this is just like how it is I want to go",
    "start": "296600",
    "end": "298280"
  },
  {
    "text": "into the firmware of this camera quick",
    "start": "298280",
    "end": "299960"
  },
  {
    "text": "and kind of show you guys exactly where",
    "start": "299960",
    "end": "302360"
  },
  {
    "text": "the bug comes from now real quick before",
    "start": "302360",
    "end": "303880"
  },
  {
    "text": "you go I want to show you my website",
    "start": "303880",
    "end": "305039"
  },
  {
    "text": "lowlevel Academy it is my personal",
    "start": "305039",
    "end": "307000"
  },
  {
    "text": "course website that I run where I teach",
    "start": "307000",
    "end": "309000"
  },
  {
    "text": "people about the fundamentals of",
    "start": "309000",
    "end": "309960"
  },
  {
    "text": "computers right I think if you want to",
    "start": "309960",
    "end": "311160"
  },
  {
    "text": "be a good programmer you have to know",
    "start": "311160",
    "end": "313000"
  },
  {
    "text": "how computers work at a basic level",
    "start": "313000",
    "end": "314960"
  },
  {
    "text": "languages like assembly languages like C",
    "start": "314960",
    "end": "317320"
  },
  {
    "text": "will teach you that and you can learn",
    "start": "317320",
    "end": "318520"
  },
  {
    "text": "that here on the level Academy and if",
    "start": "318520",
    "end": "320080"
  },
  {
    "text": "you don't want to buy it you want to try",
    "start": "320080",
    "end": "321199"
  },
  {
    "text": "it first you can go and free preview it",
    "start": "321199",
    "end": "323160"
  },
  {
    "text": "you can go check out the lesson on load",
    "start": "323160",
    "end": "324560"
  },
  {
    "text": "operations learn about how assembly",
    "start": "324560",
    "end": "326080"
  },
  {
    "text": "operations and arm workor to load data",
    "start": "326080",
    "end": "327680"
  },
  {
    "text": "in the registers you can go do c and you",
    "start": "327680",
    "end": "329880"
  },
  {
    "text": "can learn and see how arrays work for",
    "start": "329880",
    "end": "332000"
  },
  {
    "text": "example if you want to try it before you",
    "start": "332000",
    "end": "333319"
  },
  {
    "text": "buy it go give it a shot you can't code",
    "start": "333319",
    "end": "335440"
  },
  {
    "text": "efficiently if you don't know how",
    "start": "335440",
    "end": "336560"
  },
  {
    "text": "computers work and where do you learn",
    "start": "336560",
    "end": "337880"
  },
  {
    "text": "that on lowlevel Academy thanks for",
    "start": "337880",
    "end": "339440"
  },
  {
    "text": "watching back to the video so if you're",
    "start": "339440",
    "end": "340919"
  },
  {
    "text": "not like a person who does security",
    "start": "340919",
    "end": "342160"
  },
  {
    "text": "research and this may be like",
    "start": "342160",
    "end": "343199"
  },
  {
    "text": "intimidating for you I promise this is",
    "start": "343199",
    "end": "344759"
  },
  {
    "text": "not a complicated process I'm going to",
    "start": "344759",
    "end": "346000"
  },
  {
    "text": "do the best that I can to explain",
    "start": "346000",
    "end": "347319"
  },
  {
    "text": "exactly what's going on um but so here",
    "start": "347319",
    "end": "349560"
  },
  {
    "text": "is the image of that camera so it was a",
    "start": "349560",
    "end": "352440"
  },
  {
    "text": "camera from a Tai when company called I",
    "start": "352440",
    "end": "353880"
  },
  {
    "text": "think avtech and it was an AV 1203",
    "start": "353880",
    "end": "356080"
  },
  {
    "text": "camera right and so you can see right",
    "start": "356080",
    "end": "357600"
  },
  {
    "text": "here oh sorry 1023 and this is the the",
    "start": "357600",
    "end": "359919"
  },
  {
    "text": "firmware image you can download from the",
    "start": "359919",
    "end": "361680"
  },
  {
    "text": "manufacturer website right and that's",
    "start": "361680",
    "end": "363400"
  },
  {
    "text": "kind of like I think issue number one or",
    "start": "363400",
    "end": "365280"
  },
  {
    "text": "not issue number one but like a big",
    "start": "365280",
    "end": "367120"
  },
  {
    "text": "symptom of a lot of the embedded things",
    "start": "367120",
    "end": "369280"
  },
  {
    "text": "is people tend to find vulnerabilities",
    "start": "369280",
    "end": "371039"
  },
  {
    "text": "in these so easily because these devices",
    "start": "371039",
    "end": "374000"
  },
  {
    "text": "the manufacturers allow you to go",
    "start": "374000",
    "end": "375440"
  },
  {
    "text": "download the firmware right so by having",
    "start": "375440",
    "end": "376919"
  },
  {
    "text": "easy access to the firmware itself you",
    "start": "376919",
    "end": "378639"
  },
  {
    "text": "can just go pull it and look for",
    "start": "378639",
    "end": "379680"
  },
  {
    "text": "yourself and find weird bugs and things",
    "start": "379680",
    "end": "381280"
  },
  {
    "text": "to take this binary part cuz if you like",
    "start": "381280",
    "end": "383639"
  },
  {
    "text": "cat this binary right and pump it into",
    "start": "383639",
    "end": "385560"
  },
  {
    "text": "less it's just it's just garbage well",
    "start": "385560",
    "end": "387880"
  },
  {
    "text": "inside of the binary image itself there",
    "start": "387880",
    "end": "390360"
  },
  {
    "text": "are a bunch of interesting pieces of of",
    "start": "390360",
    "end": "392479"
  },
  {
    "text": "data about like the metadata of the",
    "start": "392479",
    "end": "394479"
  },
  {
    "text": "image itself it's the the compile date",
    "start": "394479",
    "end": "396680"
  },
  {
    "text": "the the type of data that it contain",
    "start": "396680",
    "end": "398120"
  },
  {
    "text": "stuff like that but there are ultimately",
    "start": "398120",
    "end": "400120"
  },
  {
    "text": "data structures that contain file",
    "start": "400120",
    "end": "401960"
  },
  {
    "text": "systems that contain the binaries that",
    "start": "401960",
    "end": "404120"
  },
  {
    "text": "run on the device that we're looking for",
    "start": "404120",
    "end": "406199"
  },
  {
    "text": "now if this firmware image were in uh",
    "start": "406199",
    "end": "408479"
  },
  {
    "text": "encrypted for example that'd be a",
    "start": "408479",
    "end": "409800"
  },
  {
    "text": "problem we wouldn't be able to to take",
    "start": "409800",
    "end": "411039"
  },
  {
    "text": "it apart because we wouldn't know the",
    "start": "411039",
    "end": "412199"
  },
  {
    "text": "key we wouldn't be able to see what's on",
    "start": "412199",
    "end": "413560"
  },
  {
    "text": "the inside uh but luckily this",
    "start": "413560",
    "end": "415759"
  },
  {
    "text": "manufacturer well L luckily for some",
    "start": "415759",
    "end": "417960"
  },
  {
    "text": "unluckily for others uh this is not this",
    "start": "417960",
    "end": "420240"
  },
  {
    "text": "is not encrypted right so what we do do",
    "start": "420240",
    "end": "422440"
  },
  {
    "text": "this little command here called binwalk",
    "start": "422440",
    "end": "423919"
  },
  {
    "text": "Tac me which is uh recursive extraction",
    "start": "423919",
    "end": "427319"
  },
  {
    "text": "on that image and what that'll do is",
    "start": "427319",
    "end": "429120"
  },
  {
    "text": "that'll actually rip the binary apart",
    "start": "429120",
    "end": "430879"
  },
  {
    "text": "and give us all of the subsystems that",
    "start": "430879",
    "end": "432840"
  },
  {
    "text": "are inside of that binary if binwalk",
    "start": "432840",
    "end": "435280"
  },
  {
    "text": "knows the signature of them so we can go",
    "start": "435280",
    "end": "437039"
  },
  {
    "text": "into the file that was produced by this",
    "start": "437039",
    "end": "439080"
  },
  {
    "text": "and we have a bunch of stuff that comes",
    "start": "439080",
    "end": "440759"
  },
  {
    "text": "out some header data and then ultimately",
    "start": "440759",
    "end": "442759"
  },
  {
    "text": "we have this thing called the J ffs 2",
    "start": "442759",
    "end": "444800"
  },
  {
    "text": "journaled flash filing system uh the",
    "start": "444800",
    "end": "447160"
  },
  {
    "text": "second version and this is what's going",
    "start": "447160",
    "end": "448720"
  },
  {
    "text": "to contain all of the binaries that run",
    "start": "448720",
    "end": "451160"
  },
  {
    "text": "on this device right so we're going to",
    "start": "451160",
    "end": "452440"
  },
  {
    "text": "go into there and I also downloaded",
    "start": "452440",
    "end": "453759"
  },
  {
    "text": "Jefferson which if you want to play",
    "start": "453759",
    "end": "454919"
  },
  {
    "text": "along I guess this is a binary this is a",
    "start": "454919",
    "end": "456960"
  },
  {
    "text": "program that does the uh extraction of",
    "start": "456960",
    "end": "459360"
  },
  {
    "text": "the of the data right so we'll go into",
    "start": "459360",
    "end": "461759"
  },
  {
    "text": "this file here 2 ea15 and this is just",
    "start": "461759",
    "end": "464560"
  },
  {
    "text": "the offset in the binary that that file",
    "start": "464560",
    "end": "466919"
  },
  {
    "text": "comes from and then so in here we have",
    "start": "466919",
    "end": "469080"
  },
  {
    "text": "some of the files that live on that",
    "start": "469080",
    "end": "471000"
  },
  {
    "text": "camera okay pretty cool so if we go one",
    "start": "471000",
    "end": "473159"
  },
  {
    "text": "level deeper we see inside of this",
    "start": "473159",
    "end": "475280"
  },
  {
    "text": "there's a bunch of files that are",
    "start": "475280",
    "end": "476400"
  },
  {
    "text": "interesting but there's no there there's",
    "start": "476400",
    "end": "478039"
  },
  {
    "text": "a there's a bin folder but are some",
    "start": "478039",
    "end": "479919"
  },
  {
    "text": "there are no files in there right so we",
    "start": "479919",
    "end": "481199"
  },
  {
    "text": "want to figure out okay where are the",
    "start": "481199",
    "end": "483120"
  },
  {
    "text": "binary files for this camera well",
    "start": "483120",
    "end": "485080"
  },
  {
    "text": "luckily we saw another file in there",
    "start": "485080",
    "end": "487560"
  },
  {
    "text": "that's called app app. sqfs this is a",
    "start": "487560",
    "end": "490680"
  },
  {
    "text": "squash FS which is a file system that is",
    "start": "490680",
    "end": "493360"
  },
  {
    "text": "actually compressed when it's live and",
    "start": "493360",
    "end": "495199"
  },
  {
    "text": "you can't edit it when it's live you can",
    "start": "495199",
    "end": "497080"
  },
  {
    "text": "uncompress it and see what's inside the",
    "start": "497080",
    "end": "498960"
  },
  {
    "text": "the app right so we do app. squashfs",
    "start": "498960",
    "end": "501280"
  },
  {
    "text": "very good and then we can go into the",
    "start": "501280",
    "end": "502800"
  },
  {
    "text": "squashfs and inside of here the bin",
    "start": "502800",
    "end": "505080"
  },
  {
    "text": "folder is where we see all the programs",
    "start": "505080",
    "end": "508039"
  },
  {
    "text": "that actually run the the primary",
    "start": "508039",
    "end": "510120"
  },
  {
    "text": "functionality of the camera now the",
    "start": "510120",
    "end": "512320"
  },
  {
    "text": "question is like which binary has the",
    "start": "512320",
    "end": "514959"
  },
  {
    "text": "bug this is like the the entire job of",
    "start": "514959",
    "end": "517599"
  },
  {
    "text": "security researchers and Bug hunters and",
    "start": "517599",
    "end": "519000"
  },
  {
    "text": "vulnerability researchers is that like",
    "start": "519000",
    "end": "520560"
  },
  {
    "text": "they have to figure out where the bugs",
    "start": "520560",
    "end": "521800"
  },
  {
    "text": "are so like no one really knows where",
    "start": "521800",
    "end": "523080"
  },
  {
    "text": "the bugs are luckily for us the article",
    "start": "523080",
    "end": "525040"
  },
  {
    "text": "that was written up by RS Technic",
    "start": "525040",
    "end": "526560"
  },
  {
    "text": "includes some data from siza which I",
    "start": "526560",
    "end": "528480"
  },
  {
    "text": "think came from the security company",
    "start": "528480",
    "end": "530040"
  },
  {
    "text": "that found this bug uh the vulnerability",
    "start": "530040",
    "end": "532120"
  },
  {
    "text": "lies on the brightness function within",
    "start": "532120",
    "end": "533560"
  },
  {
    "text": "the file CGI bin supervisor factory. CGI",
    "start": "533560",
    "end": "537640"
  },
  {
    "text": "so what we can do is we can go pull pull",
    "start": "537640",
    "end": "539560"
  },
  {
    "text": "up this binary factory. CGI and see",
    "start": "539560",
    "end": "541640"
  },
  {
    "text": "what's going on so let's go play with",
    "start": "541640",
    "end": "542800"
  },
  {
    "text": "factory. CGI so we're in here we're",
    "start": "542800",
    "end": "545200"
  },
  {
    "text": "going to look for this file we'll say",
    "start": "545200",
    "end": "546640"
  },
  {
    "text": "find and GP for factory oh look factory.",
    "start": "546640",
    "end": "549720"
  },
  {
    "text": "CGI very cool and it's CGI B supervisor",
    "start": "549720",
    "end": "551880"
  },
  {
    "text": "so we're in the right spot let's run",
    "start": "551880",
    "end": "553720"
  },
  {
    "text": "file on that file it's a symbolic link",
    "start": "553720",
    "end": "555760"
  },
  {
    "text": "to CGI box interesting so let's see what",
    "start": "555760",
    "end": "558640"
  },
  {
    "text": "CGI box is a 32-bit uh arm elf that is",
    "start": "558640",
    "end": "561920"
  },
  {
    "text": "dynamically linked and it uses UC Lipsy",
    "start": "561920",
    "end": "564040"
  },
  {
    "text": "okay nothing too interesting there but",
    "start": "564040",
    "end": "565600"
  },
  {
    "text": "what we then do is we take this",
    "start": "565600",
    "end": "566720"
  },
  {
    "text": "vulnerability we take this binary that",
    "start": "566720",
    "end": "568160"
  },
  {
    "text": "we think has a bug in it potentially and",
    "start": "568160",
    "end": "569640"
  },
  {
    "start": "569000",
    "end": "813000"
  },
  {
    "text": "then we go into gidra now if you don't",
    "start": "569640",
    "end": "571399"
  },
  {
    "text": "know what gedra is gidra is the reverse",
    "start": "571399",
    "end": "573200"
  },
  {
    "text": "engineering framework that was published",
    "start": "573200",
    "end": "574560"
  },
  {
    "text": "by the NSA uh it has the assembly output",
    "start": "574560",
    "end": "577880"
  },
  {
    "text": "of the binary over here and it does its",
    "start": "577880",
    "end": "580640"
  },
  {
    "text": "best guess at lifting it into",
    "start": "580640",
    "end": "582680"
  },
  {
    "text": "representation of what the C would look",
    "start": "582680",
    "end": "584440"
  },
  {
    "text": "like right so this is the actual binary",
    "start": "584440",
    "end": "586920"
  },
  {
    "text": "of the program this is the best",
    "start": "586920",
    "end": "589360"
  },
  {
    "text": "representation that gedra can make of",
    "start": "589360",
    "end": "591480"
  },
  {
    "text": "the C code I'm going to I'm going to",
    "start": "591480",
    "end": "593200"
  },
  {
    "text": "zoom in as far as I can but if you can't",
    "start": "593200",
    "end": "595120"
  },
  {
    "text": "see it cuz you're on mobile or something",
    "start": "595120",
    "end": "596279"
  },
  {
    "text": "I'm sorry uh but if you are on mobile",
    "start": "596279",
    "end": "598240"
  },
  {
    "text": "and you can see it me a favor say thanks",
    "start": "598240",
    "end": "600640"
  },
  {
    "text": "Triple L you're the best in the comments",
    "start": "600640",
    "end": "602920"
  },
  {
    "text": "okay um very cool so what we're doing",
    "start": "602920",
    "end": "605480"
  },
  {
    "text": "here is this is like the main function",
    "start": "605480",
    "end": "607079"
  },
  {
    "text": "right you can think of this as main you",
    "start": "607079",
    "end": "608399"
  },
  {
    "text": "can tell that it's main because it gets",
    "start": "608399",
    "end": "610040"
  },
  {
    "text": "called by the UC liy main startup right",
    "start": "610040",
    "end": "612920"
  },
  {
    "text": "the first function called to that is",
    "start": "612920",
    "end": "614279"
  },
  {
    "text": "always the main function ultimately it",
    "start": "614279",
    "end": "617320"
  },
  {
    "text": "sets a bunch of a bunch of environment",
    "start": "617320",
    "end": "618720"
  },
  {
    "text": "stuff up but the main meat and Poors is",
    "start": "618720",
    "end": "621600"
  },
  {
    "text": "going to be the function that gets",
    "start": "621600",
    "end": "624120"
  },
  {
    "text": "called when it parses the name of the",
    "start": "624120",
    "end": "627959"
  },
  {
    "text": "binary right this is very common for CGI",
    "start": "627959",
    "end": "630240"
  },
  {
    "text": "bin binaries what they do is they parse",
    "start": "630240",
    "end": "633040"
  },
  {
    "text": "rv0 and say what is the name of my",
    "start": "633040",
    "end": "635480"
  },
  {
    "text": "binary okay because of that I will",
    "start": "635480",
    "end": "638120"
  },
  {
    "text": "perform function X right so you can see",
    "start": "638120",
    "end": "640639"
  },
  {
    "text": "here there's a lookup table if my name",
    "start": "640639",
    "end": "642639"
  },
  {
    "text": "is factory. CGI I will run the function",
    "start": "642639",
    "end": "645440"
  },
  {
    "text": "at this location okay very cool so let's",
    "start": "645440",
    "end": "647360"
  },
  {
    "text": "go ahead and click on that and then over",
    "start": "647360",
    "end": "649120"
  },
  {
    "text": "to the right we see the code of this",
    "start": "649120",
    "end": "651920"
  },
  {
    "text": "function so I'm looking for that white",
    "start": "651920",
    "end": "654360"
  },
  {
    "text": "LED string or that brightness string",
    "start": "654360",
    "end": "656600"
  },
  {
    "text": "right because those are the two strings",
    "start": "656600",
    "end": "658279"
  },
  {
    "text": "that are associated with the",
    "start": "658279",
    "end": "659279"
  },
  {
    "text": "vulnerability so it's going to get the",
    "start": "659279",
    "end": "661240"
  },
  {
    "text": "action variable okay CU you saw action",
    "start": "661240",
    "end": "663240"
  },
  {
    "text": "equals white LED so we can say that this",
    "start": "663240",
    "end": "665120"
  },
  {
    "text": "variable here is going to be the action",
    "start": "665120",
    "end": "667279"
  },
  {
    "text": "and it's going to do a stir compare on",
    "start": "667279",
    "end": "669200"
  },
  {
    "text": "action for some value okay that makes",
    "start": "669200",
    "end": "671000"
  },
  {
    "text": "sense nothing nothing too crazy right",
    "start": "671000",
    "end": "672519"
  },
  {
    "text": "there um I am seeing debug functionality",
    "start": "672519",
    "end": "676120"
  },
  {
    "text": "that is unauthenticated so I'm already",
    "start": "676120",
    "end": "677760"
  },
  {
    "text": "not happy the code smell is already poor",
    "start": "677760",
    "end": "680320"
  },
  {
    "text": "but we can go down and we can look for",
    "start": "680320",
    "end": "682639"
  },
  {
    "text": "the white LED function okay very cool so",
    "start": "682639",
    "end": "685560"
  },
  {
    "text": "stir compar to action is white LED and",
    "start": "685560",
    "end": "687959"
  },
  {
    "text": "that does not equal zero we'll do",
    "start": "687959",
    "end": "690040"
  },
  {
    "text": "something else but if it does equal zero",
    "start": "690040",
    "end": "691519"
  },
  {
    "text": "I want to go to the other end of this so",
    "start": "691519",
    "end": "693480"
  },
  {
    "text": "this is the code that will run if the",
    "start": "693480",
    "end": "695440"
  },
  {
    "text": "white LED is the action we're doing in",
    "start": "695440",
    "end": "697639"
  },
  {
    "text": "the factory binary and I'm already",
    "start": "697639",
    "end": "701240"
  },
  {
    "text": "seeing the vulnerability okay so again",
    "start": "701240",
    "end": "703720"
  },
  {
    "text": "this is this is why this is a problem",
    "start": "703720",
    "end": "706120"
  },
  {
    "text": "dude what it does is it gets the value",
    "start": "706120",
    "end": "709880"
  },
  {
    "text": "from the query right it say query CGI",
    "start": "709880",
    "end": "712399"
  },
  {
    "text": "value it gets brightness and then it",
    "start": "712399",
    "end": "714639"
  },
  {
    "text": "just removes this one character and then",
    "start": "714639",
    "end": "717680"
  },
  {
    "text": "it SN printfs that so it puts that value",
    "start": "717680",
    "end": "720240"
  },
  {
    "text": "from the URL into this string Echo Duty",
    "start": "720240",
    "end": "723839"
  },
  {
    "text": "ratio equals this pumps it to this",
    "start": "723839",
    "end": "726360"
  },
  {
    "text": "output and then calls system on it they",
    "start": "726360",
    "end": "728800"
  },
  {
    "text": "do absolutely zero sanitization of the",
    "start": "728800",
    "end": "732639"
  },
  {
    "text": "string itself and because of that you",
    "start": "732639",
    "end": "734800"
  },
  {
    "text": "are able to arbitrarily inject code into",
    "start": "734800",
    "end": "738000"
  },
  {
    "text": "this that runs on bash without doing",
    "start": "738000",
    "end": "739600"
  },
  {
    "text": "memory corruption and this is a question",
    "start": "739600",
    "end": "741279"
  },
  {
    "text": "I get asked a lot right like would would",
    "start": "741279",
    "end": "743680"
  },
  {
    "text": "languages like rust would languages like",
    "start": "743680",
    "end": "745480"
  },
  {
    "text": "Zig for example make the world more",
    "start": "745480",
    "end": "747160"
  },
  {
    "text": "secure and the answer that I give is 70%",
    "start": "747160",
    "end": "749160"
  },
  {
    "text": "% of the time yes 70% of the time which",
    "start": "749160",
    "end": "751320"
  },
  {
    "text": "is the percentage of bugs that are found",
    "start": "751320",
    "end": "753519"
  },
  {
    "text": "that are memory corruption",
    "start": "753519",
    "end": "754560"
  },
  {
    "text": "vulnerabilities we would save the world",
    "start": "754560",
    "end": "757040"
  },
  {
    "text": "with rust or Zig something like that",
    "start": "757040",
    "end": "758600"
  },
  {
    "text": "right I know Zig isn't memory safe",
    "start": "758600",
    "end": "760120"
  },
  {
    "text": "whatever um but these are the the rare I",
    "start": "760120",
    "end": "763839"
  },
  {
    "text": "guess in quotes 30% that even if I wrote",
    "start": "763839",
    "end": "766760"
  },
  {
    "text": "this in Rust even if I wrote this in Zig",
    "start": "766760",
    "end": "768240"
  },
  {
    "text": "even if I wrote this in some other",
    "start": "768240",
    "end": "769560"
  },
  {
    "text": "memory safe language like oaml or",
    "start": "769560",
    "end": "771199"
  },
  {
    "text": "whatever because I did not do the",
    "start": "771199",
    "end": "774240"
  },
  {
    "text": "sanitization of the input this would",
    "start": "774240",
    "end": "776760"
  },
  {
    "text": "still be vulnerable no matter no matter",
    "start": "776760",
    "end": "778120"
  },
  {
    "text": "how you spun it because I'm literally",
    "start": "778120",
    "end": "779480"
  },
  {
    "text": "just effectively saying hey there user I",
    "start": "779480",
    "end": "782120"
  },
  {
    "text": "trust you to not put Bad characters into",
    "start": "782120",
    "end": "784279"
  },
  {
    "text": "this and go from there now I would try",
    "start": "784279",
    "end": "787240"
  },
  {
    "text": "to emulate this I would try to show you",
    "start": "787240",
    "end": "789120"
  },
  {
    "text": "guys this but if you're in this world or",
    "start": "789120",
    "end": "790560"
  },
  {
    "text": "you know anything about this you would",
    "start": "790560",
    "end": "791720"
  },
  {
    "text": "know that in that emulating embedded",
    "start": "791720",
    "end": "793760"
  },
  {
    "text": "devices is like very complicated um and",
    "start": "793760",
    "end": "796240"
  },
  {
    "text": "if you sit there the midwit",
    "start": "796240",
    "end": "798959"
  },
  {
    "text": "response of like it's really hard no",
    "start": "798959",
    "end": "801320"
  },
  {
    "text": "it's easy you just have to stub out Envy",
    "start": "801320",
    "end": "803240"
  },
  {
    "text": "RAM and like run the device and then at",
    "start": "803240",
    "end": "805560"
  },
  {
    "text": "the end it's like it's hard I don't want",
    "start": "805560",
    "end": "806839"
  },
  {
    "text": "to deal with it it's hard um but this",
    "start": "806839",
    "end": "809639"
  },
  {
    "text": "right here is where the bug comes from",
    "start": "809639",
    "end": "811160"
  },
  {
    "text": "they don't sanitize the input of that",
    "start": "811160",
    "end": "812519"
  },
  {
    "text": "function and so be it anyway guys that's",
    "start": "812519",
    "end": "815079"
  },
  {
    "start": "813000",
    "end": "872000"
  },
  {
    "text": "that's the video I just we we live in a",
    "start": "815079",
    "end": "816920"
  },
  {
    "text": "weird world where we have like all these",
    "start": "816920",
    "end": "818440"
  },
  {
    "text": "devices on our homes and stuff and like",
    "start": "818440",
    "end": "820040"
  },
  {
    "text": "I mean this is a this is a security",
    "start": "820040",
    "end": "821279"
  },
  {
    "text": "camera so I'm sure there are like",
    "start": "821279",
    "end": "822519"
  },
  {
    "text": "corporations around the world that have",
    "start": "822519",
    "end": "824680"
  },
  {
    "text": "these things and their businesses I mean",
    "start": "824680",
    "end": "826079"
  },
  {
    "text": "they're they're being taken over to you",
    "start": "826079",
    "end": "827800"
  },
  {
    "text": "know spread a bot Nets obviously they're",
    "start": "827800",
    "end": "829600"
  },
  {
    "text": "around um but it's just crazy that bugs",
    "start": "829600",
    "end": "833000"
  },
  {
    "text": "that are so obvious and so detrimental",
    "start": "833000",
    "end": "836519"
  },
  {
    "text": "exist like this and there's like almost",
    "start": "836519",
    "end": "839199"
  },
  {
    "text": "no repercussion right like you would",
    "start": "839199",
    "end": "840600"
  },
  {
    "text": "think a company should be held",
    "start": "840600",
    "end": "841680"
  },
  {
    "text": "responsible for the damages of their",
    "start": "841680",
    "end": "842759"
  },
  {
    "text": "stuff like Boeing for example got bopped",
    "start": "842759",
    "end": "844880"
  },
  {
    "text": "because their planes are falling out of",
    "start": "844880",
    "end": "845959"
  },
  {
    "text": "the sky that's not great um maybe",
    "start": "845959",
    "end": "849000"
  },
  {
    "text": "companies should have the same thing",
    "start": "849000",
    "end": "850240"
  },
  {
    "text": "when they have and again the the",
    "start": "850240",
    "end": "852120"
  },
  {
    "text": "question legally I think could be like",
    "start": "852120",
    "end": "853560"
  },
  {
    "text": "gross negligence and to me again I'm not",
    "start": "853560",
    "end": "856320"
  },
  {
    "text": "a lawyer I have no power here but like",
    "start": "856320",
    "end": "858720"
  },
  {
    "text": "this this feels a little a little gross",
    "start": "858720",
    "end": "861360"
  },
  {
    "text": "negligent see so anyway I don't know if",
    "start": "861360",
    "end": "863800"
  },
  {
    "text": "you like this video do me a favor hit",
    "start": "863800",
    "end": "864880"
  },
  {
    "text": "like hit subscribe then go watch this",
    "start": "864880",
    "end": "866199"
  },
  {
    "text": "other video over here about a",
    "start": "866199",
    "end": "868240"
  },
  {
    "text": "vulnerability that's equally as crazy",
    "start": "868240",
    "end": "870680"
  },
  {
    "text": "we'll see you guys in that one take care",
    "start": "870680",
    "end": "871800"
  },
  {
    "text": "bye-bye",
    "start": "871800",
    "end": "874079"
  }
]