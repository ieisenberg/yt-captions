[
  {
    "text": "the amount of trust that we put into",
    "start": "80",
    "end": "2000"
  },
  {
    "text": "devices we use every day is absolutely",
    "start": "2000",
    "end": "4880"
  },
  {
    "text": "insane in this video we're going to talk",
    "start": "4880",
    "end": "6240"
  },
  {
    "text": "about a crazy story where a security",
    "start": "6240",
    "end": "7799"
  },
  {
    "text": "researcher found a way that he could not",
    "start": "7799",
    "end": "10000"
  },
  {
    "text": "only hack into his own modem but",
    "start": "10000",
    "end": "12360"
  },
  {
    "text": "literally any modem that anybody used in",
    "start": "12360",
    "end": "15160"
  },
  {
    "text": "his entire isp's network also if you're",
    "start": "15160",
    "end": "17640"
  },
  {
    "text": "new here hi my name is the love learning",
    "start": "17640",
    "end": "19240"
  },
  {
    "text": "I make videos about software security",
    "start": "19240",
    "end": "21240"
  },
  {
    "text": "and cyber security so if you're new here",
    "start": "21240",
    "end": "23119"
  },
  {
    "text": "or just want to hang out with me hit",
    "start": "23119",
    "end": "24439"
  },
  {
    "text": "that sub button two years ago something",
    "start": "24439",
    "end": "26080"
  },
  {
    "text": "very strange happened to me while I was",
    "start": "26080",
    "end": "27480"
  },
  {
    "text": "working for my home network this guy was",
    "start": "27480",
    "end": "29160"
  },
  {
    "text": "doing pen testing right and he had this",
    "start": "29160",
    "end": "30679"
  },
  {
    "text": "blind xxc which is he's allowed to",
    "start": "30679",
    "end": "32558"
  },
  {
    "text": "inject arbitrary XML and then use that",
    "start": "32559",
    "end": "35160"
  },
  {
    "text": "to run command execution and for it to",
    "start": "35160",
    "end": "37280"
  },
  {
    "text": "happen he had to have a different",
    "start": "37280",
    "end": "38440"
  },
  {
    "text": "endpoint that he could point and",
    "start": "38440",
    "end": "40079"
  },
  {
    "text": "download HTTP files from so we went up",
    "start": "40079",
    "end": "42320"
  },
  {
    "text": "on AWS and spun Up This Server here and",
    "start": "42320",
    "end": "44920"
  },
  {
    "text": "once the web server was running I sent a",
    "start": "44920",
    "end": "46440"
  },
  {
    "text": "curl request from my home computer to",
    "start": "46440",
    "end": "48000"
  },
  {
    "text": "make sure that it could receive external",
    "start": "48000",
    "end": "50320"
  },
  {
    "text": "HTTP requests so he he sent this request",
    "start": "50320",
    "end": "53320"
  },
  {
    "text": "to the server and then just a few",
    "start": "53320",
    "end": "55320"
  },
  {
    "text": "seconds later I saw the following log so",
    "start": "55320",
    "end": "58320"
  },
  {
    "text": "you know this is him tracing out the the",
    "start": "58320",
    "end": "60280"
  },
  {
    "text": "logs of that server and you can see that",
    "start": "60280",
    "end": "62079"
  },
  {
    "text": "this is his get request this is his curl",
    "start": "62079",
    "end": "64400"
  },
  {
    "text": "request to that server perfect this",
    "start": "64400",
    "end": "66000"
  },
  {
    "text": "meant that I was able to receive Network",
    "start": "66000",
    "end": "67720"
  },
  {
    "text": "traffic on the box everything seemed",
    "start": "67720",
    "end": "69920"
  },
  {
    "text": "good to go but right as I switched back",
    "start": "69920",
    "end": "71840"
  },
  {
    "text": "to exploiting the vulnerability",
    "start": "71840",
    "end": "73360"
  },
  {
    "text": "something very unexpected appeared in my",
    "start": "73360",
    "end": "75479"
  },
  {
    "text": "log file so you see his initial request",
    "start": "75479",
    "end": "78280"
  },
  {
    "text": "here and then there's a second request",
    "start": "78280",
    "end": "81000"
  },
  {
    "text": "coming from a different IP address that",
    "start": "81000",
    "end": "83040"
  },
  {
    "text": "was not his he runs his initial request",
    "start": "83040",
    "end": "85799"
  },
  {
    "text": "you see his request hit the box and then",
    "start": "85799",
    "end": "88759"
  },
  {
    "text": "the exact same request hits the box from",
    "start": "88759",
    "end": "91920"
  },
  {
    "text": "a different IP address that is not his",
    "start": "91920",
    "end": "95360"
  },
  {
    "text": "very suspicious all right an unknown IP",
    "start": "95360",
    "end": "98119"
  },
  {
    "text": "address had replayed the exact same HTTP",
    "start": "98119",
    "end": "101399"
  },
  {
    "text": "request just 10 seconds later wow that's",
    "start": "101399",
    "end": "105079"
  },
  {
    "text": "seriously weird I thought somewhere",
    "start": "105079",
    "end": "106479"
  },
  {
    "text": "between my home network and AWS someone",
    "start": "106479",
    "end": "109520"
  },
  {
    "text": "had intercepted and replayed by HTTP",
    "start": "109520",
    "end": "112640"
  },
  {
    "text": "traffic the traffic should not be",
    "start": "112640",
    "end": "114200"
  },
  {
    "text": "accessible there is no intermediary",
    "start": "114200",
    "end": "115880"
  },
  {
    "text": "between these two systems who should",
    "start": "115880",
    "end": "117360"
  },
  {
    "text": "have seen this my intermediate thought",
    "start": "117360",
    "end": "119520"
  },
  {
    "text": "was that my computer had been hacked and",
    "start": "119520",
    "end": "121000"
  },
  {
    "text": "that the hacker was actively monitoring",
    "start": "121000",
    "end": "122759"
  },
  {
    "text": "my traffic he has his box he has AWS",
    "start": "122759",
    "end": "125600"
  },
  {
    "text": "he's thinking that there's somebody in a",
    "start": "125600",
    "end": "127159"
  },
  {
    "text": "box in the middle that can go in and see",
    "start": "127159",
    "end": "129360"
  },
  {
    "text": "all of his stuff now to check if this",
    "start": "129360",
    "end": "131039"
  },
  {
    "text": "Behavior occurred on a different device",
    "start": "131039",
    "end": "132480"
  },
  {
    "text": "I pulled out my iPhone so originally he",
    "start": "132480",
    "end": "134360"
  },
  {
    "text": "was on his computer at his house homie",
    "start": "134360",
    "end": "136319"
  },
  {
    "text": "pulls out his iPhone and he typed in the",
    "start": "136319",
    "end": "138480"
  },
  {
    "text": "URL to Safari and he sent the request",
    "start": "138480",
    "end": "140480"
  },
  {
    "text": "and peaked at his log file so again this",
    "start": "140480",
    "end": "142680"
  },
  {
    "text": "is his request uh and then this is the",
    "start": "142680",
    "end": "146160"
  },
  {
    "text": "same IP address doing the same replay",
    "start": "146160",
    "end": "149000"
  },
  {
    "text": "attack so it's not just his computer",
    "start": "149000",
    "end": "151319"
  },
  {
    "text": "that could be hacked it's also his",
    "start": "151319",
    "end": "153160"
  },
  {
    "text": "iPhone the same unknown IP address had",
    "start": "153160",
    "end": "155519"
  },
  {
    "text": "intercepted and replayed both HTTP",
    "start": "155519",
    "end": "158360"
  },
  {
    "text": "requests from my computer and my iPhone",
    "start": "158360",
    "end": "161120"
  },
  {
    "text": "somehow somebody was intercepting and",
    "start": "161120",
    "end": "163000"
  },
  {
    "text": "replaying the web traffic from likely",
    "start": "163000",
    "end": "165080"
  },
  {
    "text": "every single device on my home network",
    "start": "165080",
    "end": "167280"
  },
  {
    "text": "so then from a security standpoint what",
    "start": "167280",
    "end": "168920"
  },
  {
    "text": "does that mean either literally every",
    "start": "168920",
    "end": "171319"
  },
  {
    "text": "device in your house is compromised by",
    "start": "171319",
    "end": "173000"
  },
  {
    "text": "the same pie of malware or someone in",
    "start": "173000",
    "end": "175640"
  },
  {
    "text": "the middle is snooping on your traffic",
    "start": "175640",
    "end": "177480"
  },
  {
    "text": "or a device in the middle is compromised",
    "start": "177480",
    "end": "179920"
  },
  {
    "text": "it's a bit of a foreshadow you'll see",
    "start": "179920",
    "end": "181239"
  },
  {
    "text": "later in the video so panicked I spun up",
    "start": "181239",
    "end": "183239"
  },
  {
    "text": "a new AWS box running engine X to make",
    "start": "183239",
    "end": "185959"
  },
  {
    "text": "sure that the original instance had not",
    "start": "185959",
    "end": "187400"
  },
  {
    "text": "been compromised somehow so now he's",
    "start": "187400",
    "end": "188879"
  },
  {
    "text": "thinking like okay was it that the",
    "start": "188879",
    "end": "191080"
  },
  {
    "text": "server I was on that got hacked so we",
    "start": "191080",
    "end": "192840"
  },
  {
    "text": "made a new box made engine X so not",
    "start": "192840",
    "end": "195560"
  },
  {
    "text": "python just a regular engine X server",
    "start": "195560",
    "end": "197720"
  },
  {
    "text": "did the same thing from his iPhone and",
    "start": "197720",
    "end": "199519"
  },
  {
    "text": "saw the exact same log so someone is",
    "start": "199519",
    "end": "203000"
  },
  {
    "text": "sniffing on his data coming out of his",
    "start": "203000",
    "end": "205480"
  },
  {
    "text": "house has nothing to do with that AWS",
    "start": "205480",
    "end": "207599"
  },
  {
    "text": "instance it's literally just if it's",
    "start": "207599",
    "end": "209480"
  },
  {
    "text": "coming out of my house someone is",
    "start": "209480",
    "end": "210879"
  },
  {
    "text": "replaying it so something crazy is going",
    "start": "210879",
    "end": "213599"
  },
  {
    "text": "on here through what could only be my",
    "start": "213599",
    "end": "215439"
  },
  {
    "text": "ISP my modem foreshadowing or AWS being",
    "start": "215439",
    "end": "218640"
  },
  {
    "text": "compromised someone was intercepting and",
    "start": "218640",
    "end": "220920"
  },
  {
    "text": "replaying my HTTP traffic immediately",
    "start": "220920",
    "end": "223439"
  },
  {
    "text": "after I sent it to eliminate the Absurd",
    "start": "223439",
    "end": "225480"
  },
  {
    "text": "idea that AWS had been compromised I",
    "start": "225480",
    "end": "227280"
  },
  {
    "text": "spun up a box on gcp instead another",
    "start": "227280",
    "end": "229480"
  },
  {
    "text": "cloud provider and observed the same",
    "start": "229480",
    "end": "232040"
  },
  {
    "text": "unknown IP address replaying my HTTP",
    "start": "232040",
    "end": "234799"
  },
  {
    "text": "requests so it wasn't AWS the only real",
    "start": "234799",
    "end": "238079"
  },
  {
    "text": "option left was that my modem had been",
    "start": "238079",
    "end": "239840"
  },
  {
    "text": "hacked but who was the attacker I quered",
    "start": "239840",
    "end": "242200"
  },
  {
    "text": "the owner of the IP address and found",
    "start": "242200",
    "end": "243799"
  },
  {
    "text": "that it belonged to digital ocean",
    "start": "243799",
    "end": "245480"
  },
  {
    "text": "strange it definitely didn't belong to",
    "start": "245480",
    "end": "247159"
  },
  {
    "text": "my ISP to kick off an investigation I",
    "start": "247159",
    "end": "249040"
  },
  {
    "text": "sent the IP address to some friends who",
    "start": "249040",
    "end": "250519"
  },
  {
    "text": "worked for threat intelligence companies",
    "start": "250519",
    "end": "252159"
  },
  {
    "text": "they sent me a link to the virus total",
    "start": "252159",
    "end": "253480"
  },
  {
    "text": "listing for the IP address which",
    "start": "253480",
    "end": "254959"
  },
  {
    "text": "detailed all of the domains which",
    "start": "254959",
    "end": "256600"
  },
  {
    "text": "resolved the IP address over the years",
    "start": "256600",
    "end": "258639"
  },
  {
    "text": "and this was odd the IP address just one",
    "start": "258639",
    "end": "260440"
  },
  {
    "text": "year prior was being used to host",
    "start": "260440",
    "end": "262639"
  },
  {
    "text": "fishing infrastructure that targeted a",
    "start": "262639",
    "end": "264400"
  },
  {
    "text": "South American cyber security company",
    "start": "264400",
    "end": "266520"
  },
  {
    "text": "assuming that they had been in control",
    "start": "266520",
    "end": "267600"
  },
  {
    "text": "of this IP address for 3 years it would",
    "start": "267600",
    "end": "269199"
  },
  {
    "text": "mean that they had had used it for at",
    "start": "269199",
    "end": "271080"
  },
  {
    "text": "least two different fishing campaigns",
    "start": "271080",
    "end": "272840"
  },
  {
    "text": "and is what appeared to be a CNC server",
    "start": "272840",
    "end": "274880"
  },
  {
    "text": "for router malware so again this guy is",
    "start": "274880",
    "end": "276400"
  },
  {
    "text": "thinking that his modem has been",
    "start": "276400",
    "end": "278360"
  },
  {
    "text": "compromised and this IP address which",
    "start": "278360",
    "end": "280520"
  },
  {
    "text": "resolves to is Glam or whatever is being",
    "start": "280520",
    "end": "283039"
  },
  {
    "text": "used to C2 that malware so okay",
    "start": "283039",
    "end": "284919"
  },
  {
    "text": "something weird is going on here handing",
    "start": "284919",
    "end": "286560"
  },
  {
    "text": "over the evidence the modem that I've",
    "start": "286560",
    "end": "288080"
  },
  {
    "text": "been using was the Cox panoramic Wi-Fi",
    "start": "288080",
    "end": "290360"
  },
  {
    "text": "Gateway after learning that it was",
    "start": "290360",
    "end": "292000"
  },
  {
    "text": "likely compromised I went to the local",
    "start": "292000",
    "end": "293759"
  },
  {
    "text": " door to show them my device and ask",
    "start": "293759",
    "end": "295840"
  },
  {
    "text": "for a new one the one issue with this",
    "start": "295840",
    "end": "297400"
  },
  {
    "text": "request was that in order for me to",
    "start": "297400",
    "end": "298520"
  },
  {
    "text": "receive a new modem I had hand over the",
    "start": "298520",
    "end": "300360"
  },
  {
    "text": "old one sadly it wasn't actually my",
    "start": "300360",
    "end": "302320"
  },
  {
    "text": "property I was only renting it from the",
    "start": "302320",
    "end": "304400"
  },
  {
    "text": "ISP so classic ISP move where they put a",
    "start": "304400",
    "end": "308360"
  },
  {
    "text": "device in your house your device gets",
    "start": "308360",
    "end": "310520"
  },
  {
    "text": "hacked and when you want to look at it",
    "start": "310520",
    "end": "312199"
  },
  {
    "text": "they're like sorry that's not actually",
    "start": "312199",
    "end": "314039"
  },
  {
    "text": "your device we need to to get it back um",
    "start": "314039",
    "end": "317120"
  },
  {
    "text": "I explained to the employee how I wanted",
    "start": "317120",
    "end": "319520"
  },
  {
    "text": "to keep it and reverse engineer the",
    "start": "319520",
    "end": "320960"
  },
  {
    "text": "device their eyes shot up a little bit",
    "start": "320960",
    "end": "323280"
  },
  {
    "text": "they were much less enthusiastic about",
    "start": "323280",
    "end": "325240"
  },
  {
    "text": "giving it back to me this is like they",
    "start": "325240",
    "end": "327440"
  },
  {
    "text": "he went to a Cox store and literally",
    "start": "327440",
    "end": "329440"
  },
  {
    "text": "there a guy making like $18 an hour and",
    "start": "329440",
    "end": "332440"
  },
  {
    "text": "this and Sam Curry is like I literally",
    "start": "332440",
    "end": "334440"
  },
  {
    "text": "have uncovered a malware campaign that's",
    "start": "334440",
    "end": "337280"
  },
  {
    "text": "targeting your ISP modem like you have",
    "start": "337280",
    "end": "339840"
  },
  {
    "text": "to let me keep this and the guy is like",
    "start": "339840",
    "end": "341600"
  },
  {
    "text": "running his checklist and it's like uh",
    "start": "341600",
    "end": "343880"
  },
  {
    "text": "it says I'm not allowed to let you do",
    "start": "343880",
    "end": "346080"
  },
  {
    "text": "that and so that's just like what",
    "start": "346080",
    "end": "347759"
  },
  {
    "text": "happens um there's no way I can keep it",
    "start": "347759",
    "end": "350560"
  },
  {
    "text": "question mark I asked no we need to take",
    "start": "350560",
    "end": "353080"
  },
  {
    "text": "your old one and give you a new one the",
    "start": "353080",
    "end": "355160"
  },
  {
    "text": "ISP representative said again Steve he's",
    "start": "355160",
    "end": "358000"
  },
  {
    "text": "at the end of his 8 hour shift he's an",
    "start": "358000",
    "end": "360280"
  },
  {
    "text": "hour and a half in and there's no",
    "start": "360280",
    "end": "362720"
  },
  {
    "text": "budging as much as I wanted to take it",
    "start": "362720",
    "end": "364400"
  },
  {
    "text": "apart dump the firmware and see if",
    "start": "364400",
    "end": "365720"
  },
  {
    "text": "there's any trace of what ever",
    "start": "365720",
    "end": "366919"
  },
  {
    "text": "potentially compromised it I had already",
    "start": "366919",
    "end": "369199"
  },
  {
    "text": "passed the device off to the employee I",
    "start": "369199",
    "end": "371319"
  },
  {
    "text": "took my new device and left the store",
    "start": "371319",
    "end": "373280"
  },
  {
    "text": "disappointed that I wasn't able to do",
    "start": "373280",
    "end": "374680"
  },
  {
    "text": "anything more with it after setting up",
    "start": "374680",
    "end": "376680"
  },
  {
    "text": "my new modem the previous Behavior",
    "start": "376680",
    "end": "378400"
  },
  {
    "text": "completely stopped my traffic was no",
    "start": "378400",
    "end": "380599"
  },
  {
    "text": "longer being replayed there was no other",
    "start": "380599",
    "end": "383240"
  },
  {
    "text": "IP in the logs everything seemed fixed",
    "start": "383240",
    "end": "386479"
  },
  {
    "text": "so guy is getting his internet traffic",
    "start": "386479",
    "end": "389000"
  },
  {
    "text": "replayed",
    "start": "389000",
    "end": "390360"
  },
  {
    "text": "thinks it's the modem gives the modem to",
    "start": "390360",
    "end": "392440"
  },
  {
    "text": "Cox Cox gives him a new modem traffic",
    "start": "392440",
    "end": "395199"
  },
  {
    "text": "stops so without a doubt there was a",
    "start": "395199",
    "end": "398319"
  },
  {
    "text": "piece of malware living in his Cox ISP",
    "start": "398319",
    "end": "401199"
  },
  {
    "text": "modem if I say Cox again I think I'm",
    "start": "401199",
    "end": "403639"
  },
  {
    "text": "going to get demonetized Cox three years",
    "start": "403639",
    "end": "407160"
  },
  {
    "text": "later so this is like in one of those",
    "start": "407160",
    "end": "408919"
  },
  {
    "text": "movies where you you you see people they",
    "start": "408919",
    "end": "411919"
  },
  {
    "text": "have some event happen to them and they",
    "start": "411919",
    "end": "413280"
  },
  {
    "text": "they they know they they have to go",
    "start": "413280",
    "end": "414720"
  },
  {
    "text": "through some traumatic life event and",
    "start": "414720",
    "end": "416000"
  },
  {
    "text": "three years later they figure it out",
    "start": "416000",
    "end": "417080"
  },
  {
    "text": "this is literally what happened so this",
    "start": "417080",
    "end": "419280"
  },
  {
    "text": "guy",
    "start": "419280",
    "end": "420160"
  },
  {
    "text": "is doing this research on his home",
    "start": "420160",
    "end": "421919"
  },
  {
    "text": "device getting hacked getting his his",
    "start": "421919",
    "end": "423440"
  },
  {
    "text": "Coxs hacked and then 3 years later he",
    "start": "423440",
    "end": "425960"
  },
  {
    "text": "figures out a way to get through it",
    "start": "425960",
    "end": "427160"
  },
  {
    "text": "three years later in early 2024 almost 3",
    "start": "427160",
    "end": "429680"
  },
  {
    "text": "years later I was on vacation with some",
    "start": "429680",
    "end": "431680"
  },
  {
    "text": "friends who also worked in cyber",
    "start": "431680",
    "end": "433199"
  },
  {
    "text": "security we were having a conversation",
    "start": "433199",
    "end": "434759"
  },
  {
    "text": "over dinner when I explained the story",
    "start": "434759",
    "end": "436360"
  },
  {
    "text": "to them curious to learn more they asked",
    "start": "436360",
    "end": "438440"
  },
  {
    "text": "me for all the details and thought it'd",
    "start": "438440",
    "end": "439879"
  },
  {
    "text": "be fun to run their own investigation",
    "start": "439879",
    "end": "441919"
  },
  {
    "text": "the first thing that caught their",
    "start": "441919",
    "end": "442960"
  },
  {
    "text": "attention having worked on more malware",
    "start": "442960",
    "end": "444639"
  },
  {
    "text": "analysis a lot more than I had was the",
    "start": "444639",
    "end": "446440"
  },
  {
    "text": "format of the two mail server domains so",
    "start": "446440",
    "end": "448479"
  },
  {
    "text": "it's you know it's this and they're",
    "start": "448479",
    "end": "450039"
  },
  {
    "text": "saying that basically every uh every",
    "start": "450039",
    "end": "452360"
  },
  {
    "text": "single domain that was registered by the",
    "start": "452360",
    "end": "453800"
  },
  {
    "text": "discovered IP address use the same",
    "start": "453800",
    "end": "455400"
  },
  {
    "text": "naming convention so you have word six",
    "start": "455400",
    "end": "457720"
  },
  {
    "text": "numbers and a top level domain due to",
    "start": "457720",
    "end": "459879"
  },
  {
    "text": "the mass number of domains and",
    "start": "459879",
    "end": "461479"
  },
  {
    "text": "algorithmic structure of the registered",
    "start": "461479",
    "end": "462919"
  },
  {
    "text": "addresses this appeared to be a domain",
    "start": "462919",
    "end": "464720"
  },
  {
    "text": "generation algorithm used by Mau",
    "start": "464720",
    "end": "466680"
  },
  {
    "text": "operators to rotate the resolving",
    "start": "466680",
    "end": "468360"
  },
  {
    "text": "address for the CNC server for the",
    "start": "468360",
    "end": "470159"
  },
  {
    "text": "purpose of obfuscation so basically",
    "start": "470159",
    "end": "471639"
  },
  {
    "text": "they're trying to make sure that you",
    "start": "471639",
    "end": "473879"
  },
  {
    "text": "can't get you don't you don't have a",
    "start": "473879",
    "end": "475319"
  },
  {
    "text": "good pattern of life on the DNS record",
    "start": "475319",
    "end": "477520"
  },
  {
    "text": "for that IP address there's a good",
    "start": "477520",
    "end": "479120"
  },
  {
    "text": "chance the IP address replaying my",
    "start": "479120",
    "end": "480919"
  },
  {
    "text": "traffic was a CNC server and the two",
    "start": "480919",
    "end": "483159"
  },
  {
    "text": "domains where I thought there were mail",
    "start": "483159",
    "end": "484240"
  },
  {
    "text": "servers were actually algorithmically",
    "start": "484240",
    "end": "486080"
  },
  {
    "text": "generated pointers to the CNC server",
    "start": "486080",
    "end": "488400"
  },
  {
    "text": "something disappointing was that all of",
    "start": "488400",
    "end": "489960"
  },
  {
    "text": "these domains were historical the last",
    "start": "489960",
    "end": "491560"
  },
  {
    "text": "one scene was registered in March 17",
    "start": "491560",
    "end": "493879"
  },
  {
    "text": "2023 none of the hosts resolved anything",
    "start": "493879",
    "end": "496280"
  },
  {
    "text": "anymore and we couldn't seem to identify",
    "start": "496280",
    "end": "498159"
  },
  {
    "text": "anything similar being anything similar",
    "start": "498159",
    "end": "500960"
  },
  {
    "text": "being registered to the same IP Address",
    "start": "500960",
    "end": "502919"
  },
  {
    "text": "given that my new modem was the same",
    "start": "502919",
    "end": "504560"
  },
  {
    "text": "model that had been compromised I was",
    "start": "504560",
    "end": "506280"
  },
  {
    "text": "curious if the attacker had found a way",
    "start": "506280",
    "end": "507840"
  },
  {
    "text": "back in from a quick Google search I",
    "start": "507840",
    "end": "510120"
  },
  {
    "text": "discovered that there was no public",
    "start": "510120",
    "end": "511159"
  },
  {
    "text": "vulnerabilities of the model of the",
    "start": "511159",
    "end": "512360"
  },
  {
    "text": "modem that I had the other option was",
    "start": "512360",
    "end": "514240"
  },
  {
    "text": "seemed more and more likely that they",
    "start": "514240",
    "end": "515479"
  },
  {
    "text": "had exploited something outside of a",
    "start": "515479",
    "end": "517479"
  },
  {
    "text": "generic router exploit I was super",
    "start": "517479",
    "end": "519279"
  },
  {
    "text": "curious to investigate this and try to",
    "start": "519279",
    "end": "520440"
  },
  {
    "text": "brainstorm ways my device could have",
    "start": "520440",
    "end": "521880"
  },
  {
    "text": "been compromised so this is where the",
    "start": "521880",
    "end": "524480"
  },
  {
    "text": "article gets absolutely insane so things",
    "start": "524480",
    "end": "527560"
  },
  {
    "text": "start to get pretty crazy here because",
    "start": "527560",
    "end": "529320"
  },
  {
    "text": "the this is where the tr69 protocol and",
    "start": "529320",
    "end": "532399"
  },
  {
    "text": "the idea of an ISP being able to",
    "start": "532399",
    "end": "534880"
  },
  {
    "text": "remotely control your device comes into",
    "start": "534880",
    "end": "537200"
  },
  {
    "text": "play but effectively if you've ever had",
    "start": "537200",
    "end": "539160"
  },
  {
    "text": "an ISP like work with your house they",
    "start": "539160",
    "end": "542320"
  },
  {
    "text": "can remotely control the device that",
    "start": "542320",
    "end": "545240"
  },
  {
    "text": "they give you when they set up your",
    "start": "545240",
    "end": "546800"
  },
  {
    "text": "internet so if you have like a Verizon",
    "start": "546800",
    "end": "548120"
  },
  {
    "text": "router right you plug an ethernet cable",
    "start": "548120",
    "end": "550839"
  },
  {
    "text": "into that Verizon router and the ISP can",
    "start": "550839",
    "end": "552880"
  },
  {
    "text": "completely remotely control it right",
    "start": "552880",
    "end": "555560"
  },
  {
    "text": "something about that smells Incorrect",
    "start": "555560",
    "end": "557360"
  },
  {
    "text": "and if it's not implemented correctly",
    "start": "557360",
    "end": "559800"
  },
  {
    "text": "bad things can happen and are those end",
    "start": "559800",
    "end": "562200"
  },
  {
    "text": "points TLS encrypted last loyal Raven",
    "start": "562200",
    "end": "565000"
  },
  {
    "text": "let me tell you the answer is no and",
    "start": "565000",
    "end": "567279"
  },
  {
    "text": "you're about to find out uh why in this",
    "start": "567279",
    "end": "569160"
  },
  {
    "text": "chat targeting rest apis using the tr69",
    "start": "569160",
    "end": "572200"
  },
  {
    "text": "nice protocol after getting back home a",
    "start": "572200",
    "end": "574720"
  },
  {
    "text": "close friend had asked if I had been",
    "start": "574720",
    "end": "576040"
  },
  {
    "text": "able to help him move furniture into his",
    "start": "576040",
    "end": "578000"
  },
  {
    "text": "new house what this also meant was",
    "start": "578000",
    "end": "579760"
  },
  {
    "text": "helping him transfer over his Cox modem",
    "start": "579760",
    "end": "582279"
  },
  {
    "text": "after connecting his device to the fiber",
    "start": "582279",
    "end": "583880"
  },
  {
    "text": "line I went ahead and called the ISP",
    "start": "583880",
    "end": "585800"
  },
  {
    "text": "support and asked they'd be able to push",
    "start": "585800",
    "end": "587440"
  },
  {
    "text": "out an update to allow the device to",
    "start": "587440",
    "end": "589360"
  },
  {
    "text": "work in a new location the agent",
    "start": "589360",
    "end": "591279"
  },
  {
    "text": "confirmed that they could remotely",
    "start": "591279",
    "end": "592800"
  },
  {
    "text": "update the device settings including",
    "start": "592800",
    "end": "594959"
  },
  {
    "text": "changing the Wi-Fi password and viewing",
    "start": "594959",
    "end": "597320"
  },
  {
    "text": "the connected devices now again this is",
    "start": "597320",
    "end": "600320"
  },
  {
    "text": "where things get weird man like it makes",
    "start": "600320",
    "end": "603000"
  },
  {
    "text": "sense that your ISP can help fix your",
    "start": "603000",
    "end": "604680"
  },
  {
    "text": "device can update the firmware but the",
    "start": "604680",
    "end": "606959"
  },
  {
    "text": "question is like how are they doing that",
    "start": "606959",
    "end": "609040"
  },
  {
    "text": "and what is preventing one person from",
    "start": "609040",
    "end": "610920"
  },
  {
    "text": "doing that and not the rest of the world",
    "start": "610920",
    "end": "613240"
  },
  {
    "text": "right how why is the ISP special now the",
    "start": "613240",
    "end": "615399"
  },
  {
    "text": "ability of support agents to control",
    "start": "615399",
    "end": "616959"
  },
  {
    "text": "devices really interested me especially",
    "start": "616959",
    "end": "618640"
  },
  {
    "text": "since they could update pretty much",
    "start": "618640",
    "end": "620079"
  },
  {
    "text": "anything on the device this extensive",
    "start": "620079",
    "end": "622040"
  },
  {
    "text": "access is facilitated by a protocol",
    "start": "622040",
    "end": "623519"
  },
  {
    "text": "known as",
    "start": "623519",
    "end": "624360"
  },
  {
    "text": "tr69 implemented in 04 which allowed",
    "start": "624360",
    "end": "627200"
  },
  {
    "text": "isbs to manage devices within their own",
    "start": "627200",
    "end": "628959"
  },
  {
    "text": "network via Port",
    "start": "628959",
    "end": "630800"
  },
  {
    "text": "7547 this protocol had already been the",
    "start": "630800",
    "end": "633000"
  },
  {
    "text": "subject of a few great tfon talks and",
    "start": "633000",
    "end": "635079"
  },
  {
    "text": "wasn't externally exposed so I wasn't",
    "start": "635079",
    "end": "637120"
  },
  {
    "text": "super interested in bug hunting that",
    "start": "637120",
    "end": "638480"
  },
  {
    "text": "protocol itself so typically these isps",
    "start": "638480",
    "end": "641040"
  },
  {
    "text": "are able to have different planes of",
    "start": "641040",
    "end": "642680"
  },
  {
    "text": "management where even though the port is",
    "start": "642680",
    "end": "644320"
  },
  {
    "text": "open you can't hit it from the outside",
    "start": "644320",
    "end": "646320"
  },
  {
    "text": "only the ISP can so in theory that's not",
    "start": "646320",
    "end": "648519"
  },
  {
    "text": "a great attack service which is why Sam",
    "start": "648519",
    "end": "650320"
  },
  {
    "text": "didn't go after it the theory craft a",
    "start": "650320",
    "end": "651800"
  },
  {
    "text": "little bit if I were a hacker who wanted",
    "start": "651800",
    "end": "653560"
  },
  {
    "text": "to compromise my modem I'd likely Target",
    "start": "653560",
    "end": "655680"
  },
  {
    "text": "whatever infrastructure powered the",
    "start": "655680",
    "end": "657320"
  },
  {
    "text": "support tools that the agents were using",
    "start": "657320",
    "end": "659760"
  },
  {
    "text": "there were probably some internal",
    "start": "659760",
    "end": "661200"
  },
  {
    "text": "website for device management that",
    "start": "661200",
    "end": "663000"
  },
  {
    "text": "support agents used backed by an API",
    "start": "663000",
    "end": "665399"
  },
  {
    "text": "that could execute arbitrary commands",
    "start": "665399",
    "end": "667200"
  },
  {
    "text": "and change view administrative settings",
    "start": "667200",
    "end": "668959"
  },
  {
    "text": "on customer devices foreshadowing if I",
    "start": "668959",
    "end": "671760"
  },
  {
    "text": "could find some way to access this",
    "start": "671760",
    "end": "673160"
  },
  {
    "text": "functionality it might shed light on how",
    "start": "673160",
    "end": "675040"
  },
  {
    "text": "I might have been originally hacked and",
    "start": "675040",
    "end": "676920"
  },
  {
    "text": "Patch out at least one method for",
    "start": "676920",
    "end": "678240"
  },
  {
    "text": "somebody to compromise my modem the",
    "start": "678240",
    "end": "679639"
  },
  {
    "text": "first thing that I decided to do was",
    "start": "679639",
    "end": "680959"
  },
  {
    "text": "look at the Cox Business portal this app",
    "start": "680959",
    "end": "683519"
  },
  {
    "text": "had a ton of interesting functionality",
    "start": "683519",
    "end": "685240"
  },
  {
    "text": "to remotely manage devices set firewall",
    "start": "685240",
    "end": "687839"
  },
  {
    "text": "rules and monitor Network traffic now",
    "start": "687839",
    "end": "690720"
  },
  {
    "text": "you see there's a basic login portal",
    "start": "690720",
    "end": "692000"
  },
  {
    "text": "here and again this isn't internal to",
    "start": "692000",
    "end": "693200"
  },
  {
    "text": "his house this is just a regular page",
    "start": "693200",
    "end": "695040"
  },
  {
    "text": "you can log into and again like",
    "start": "695040",
    "end": "697480"
  },
  {
    "text": "basically behind this wall of off if",
    "start": "697480",
    "end": "699760"
  },
  {
    "text": "implemented incorrectly could be a way",
    "start": "699760",
    "end": "702440"
  },
  {
    "text": "to touch every modem that exists on",
    "start": "702440",
    "end": "704639"
  },
  {
    "text": "Cox's Network without actually having a",
    "start": "704639",
    "end": "706800"
  },
  {
    "text": "Cox business account myself I opened the",
    "start": "706800",
    "end": "709160"
  },
  {
    "text": "login page for the portal and grabbed a",
    "start": "709160",
    "end": "711160"
  },
  {
    "text": "copy of main. this that powered the core",
    "start": "711160",
    "end": "714200"
  },
  {
    "text": "functionality of the app after",
    "start": "714200",
    "end": "715720"
  },
  {
    "text": "beautifying it I parsed out all the",
    "start": "715720",
    "end": "717480"
  },
  {
    "text": "routes and scrolled through them so this",
    "start": "717480",
    "end": "718920"
  },
  {
    "text": "guy traditional hacker stuff you're",
    "start": "718920",
    "end": "720720"
  },
  {
    "text": "doing web web exploitation you have all",
    "start": "720720",
    "end": "723000"
  },
  {
    "text": "these JavaScript files that are coded to",
    "start": "723000",
    "end": "725639"
  },
  {
    "text": "reach out and touch certain endpoints",
    "start": "725639",
    "end": "727480"
  },
  {
    "text": "okay so let's see what those endpoints",
    "start": "727480",
    "end": "728680"
  },
  {
    "text": "do and you see we have here API",
    "start": "728680",
    "end": "730839"
  },
  {
    "text": "voicemail transcribe message user roles",
    "start": "730839",
    "end": "733480"
  },
  {
    "text": "verify contact validate and the",
    "start": "733480",
    "end": "735680"
  },
  {
    "text": "Assumption guys is that these are going",
    "start": "735680",
    "end": "737480"
  },
  {
    "text": "to be authenticated right these are",
    "start": "737480",
    "end": "739519"
  },
  {
    "text": "these are uh API endpoints that are",
    "start": "739519",
    "end": "741560"
  },
  {
    "text": "going to behind some kind of off token",
    "start": "741560",
    "end": "743440"
  },
  {
    "text": "that you as a regular user don't have",
    "start": "743440",
    "end": "745240"
  },
  {
    "text": "there were over a 100 different API",
    "start": "745240",
    "end": "746959"
  },
  {
    "text": "calls that all had the same base path of",
    "start": "746959",
    "end": "749199"
  },
  {
    "text": "API cbma since this route seemed to",
    "start": "749199",
    "end": "751079"
  },
  {
    "text": "power most device related functionality",
    "start": "751079",
    "end": "753040"
  },
  {
    "text": "I thought it was worth investigating if",
    "start": "753040",
    "end": "754320"
  },
  {
    "text": "the API cbma endpoint happened to be a",
    "start": "754320",
    "end": "756839"
  },
  {
    "text": "reverse proxy to another host I tested",
    "start": "756839",
    "end": "759440"
  },
  {
    "text": "this by sending the following requests",
    "start": "759440",
    "end": "761600"
  },
  {
    "text": "HTTP requests that does not start with",
    "start": "761600",
    "end": "763320"
  },
  {
    "text": "apmi cbma returns a 301 so that's a",
    "start": "763320",
    "end": "765880"
  },
  {
    "text": "redirect HTTP requests that does start",
    "start": "765880",
    "end": "768040"
  },
  {
    "text": "with API cbma returns 500 so from",
    "start": "768040",
    "end": "770399"
  },
  {
    "text": "sending the above requests we learn that",
    "start": "770399",
    "end": "772399"
  },
  {
    "text": "API cbma endpoint is an explicit route",
    "start": "772399",
    "end": "775320"
  },
  {
    "text": "that is likely a reverse proxy to",
    "start": "775320",
    "end": "777079"
  },
  {
    "text": "another host due to the differing",
    "start": "777079",
    "end": "778720"
  },
  {
    "text": "Behavior between the HTTP responses",
    "start": "778720",
    "end": "780760"
  },
  {
    "text": "basically this is a blind test where he",
    "start": "780760",
    "end": "783959"
  },
  {
    "text": "has a hypothesis and he tests it by",
    "start": "783959",
    "end": "786440"
  },
  {
    "text": "running two commands and between the two",
    "start": "786440",
    "end": "788240"
  },
  {
    "text": "commands he gets result a and result B",
    "start": "788240",
    "end": "790519"
  },
  {
    "text": "and by doing that he's able to prove",
    "start": "790519",
    "end": "792240"
  },
  {
    "text": "that the back end is just a reverse",
    "start": "792240",
    "end": "793839"
  },
  {
    "text": "proxy and when it can't connect you get",
    "start": "793839",
    "end": "795040"
  },
  {
    "text": "a server error so since the API itself",
    "start": "795040",
    "end": "797560"
  },
  {
    "text": "had all the interesting device",
    "start": "797560",
    "end": "798720"
  },
  {
    "text": "management functionality it made sense",
    "start": "798720",
    "end": "800279"
  },
  {
    "text": "to focus on everything behind the API",
    "start": "800279",
    "end": "802199"
  },
  {
    "text": "cbma route and see if there was any lwh",
    "start": "802199",
    "end": "804880"
  },
  {
    "text": "hanging fruit like exposed actuators API",
    "start": "804880",
    "end": "807560"
  },
  {
    "text": "documentation or any directory tral",
    "start": "807560",
    "end": "809320"
  },
  {
    "text": "vulnerabilities that would allow us to",
    "start": "809320",
    "end": "810600"
  },
  {
    "text": "escalate permission so right now he's",
    "start": "810600",
    "end": "811920"
  },
  {
    "text": "trying to see what can I what can I",
    "start": "811920",
    "end": "813600"
  },
  {
    "text": "touch I went ahead and proxy the",
    "start": "813600",
    "end": "814920"
  },
  {
    "text": "registration request for the coxm portal",
    "start": "814920",
    "end": "816920"
  },
  {
    "text": "which is underneath the API cpma request",
    "start": "816920",
    "end": "819040"
  },
  {
    "text": "so basically he is going to validate an",
    "start": "819040",
    "end": "821440"
  },
  {
    "text": "email address uh request to this this",
    "start": "821440",
    "end": "824519"
  },
  {
    "text": "endpoint right he's basically testing",
    "start": "824519",
    "end": "826079"
  },
  {
    "text": "can I proxy arbitrary requests through",
    "start": "826079",
    "end": "829320"
  },
  {
    "text": "API cbma to run these functions right so",
    "start": "829320",
    "end": "832040"
  },
  {
    "text": "he's running the validate email V1 on",
    "start": "832040",
    "end": "835160"
  },
  {
    "text": "email test example.com and it says okay",
    "start": "835160",
    "end": "838000"
  },
  {
    "text": "message success so",
    "start": "838000",
    "end": "839560"
  },
  {
    "text": "the HTTP request contained a bunch of",
    "start": "839560",
    "end": "841720"
  },
  {
    "text": "different authorization headers",
    "start": "841720",
    "end": "843160"
  },
  {
    "text": "including what looked to be a generic",
    "start": "843160",
    "end": "845040"
  },
  {
    "text": "use API key that was shared between",
    "start": "845040",
    "end": "847079"
  },
  {
    "text": "users client ID and the CB session Keys",
    "start": "847079",
    "end": "849040"
  },
  {
    "text": "looked very custom and indicated there",
    "start": "849040",
    "end": "850759"
  },
  {
    "text": "were multiple roles and permissions",
    "start": "850759",
    "end": "852560"
  },
  {
    "text": "using the application the HTTP response",
    "start": "852560",
    "end": "855560"
  },
  {
    "text": "look like a generic spring response and",
    "start": "855560",
    "end": "857040"
  },
  {
    "text": "we can likely quickly confirm that the",
    "start": "857040",
    "end": "858880"
  },
  {
    "text": "backend API was running Spring by simply",
    "start": "858880",
    "end": "861160"
  },
  {
    "text": "changing the post to get and observing",
    "start": "861160",
    "end": "863160"
  },
  {
    "text": "the response so again basic hacker stuff",
    "start": "863160",
    "end": "865320"
  },
  {
    "text": "he has a hypothesis you change one",
    "start": "865320",
    "end": "867399"
  },
  {
    "text": "variable does that return response you",
    "start": "867399",
    "end": "869720"
  },
  {
    "text": "expect and by changing the get to a post",
    "start": "869720",
    "end": "871959"
  },
  {
    "text": "he gets another 500 error which means",
    "start": "871959",
    "end": "874040"
  },
  {
    "text": "that he now knows it is a spring related",
    "start": "874040",
    "end": "875880"
  },
  {
    "text": "error a spring is a a server type that",
    "start": "875880",
    "end": "877880"
  },
  {
    "text": "is very common to host these AP these",
    "start": "877880",
    "end": "879839"
  },
  {
    "text": "rest end points now since we could",
    "start": "879839",
    "end": "881079"
  },
  {
    "text": "confirm that the reverse proxy was",
    "start": "881079",
    "end": "882360"
  },
  {
    "text": "running spring I decided to look for",
    "start": "882360",
    "end": "884519"
  },
  {
    "text": "actuators and exposed API docs I went ah",
    "start": "884519",
    "end": "887440"
  },
  {
    "text": "went ahead and tried the uh actuator",
    "start": "887440",
    "end": "889360"
  },
  {
    "text": "route and again these are all just",
    "start": "889360",
    "end": "890920"
  },
  {
    "text": "spring internals so now that he knows",
    "start": "890920",
    "end": "893600"
  },
  {
    "text": "the type of framework that is being used",
    "start": "893600",
    "end": "895920"
  },
  {
    "text": "here he can follow the patterns that",
    "start": "895920",
    "end": "897720"
  },
  {
    "text": "that framework typically uses and get",
    "start": "897720",
    "end": "900079"
  },
  {
    "text": "some kind of information out of it right",
    "start": "900079",
    "end": "901600"
  },
  {
    "text": "so he's trying to enumerate all the",
    "start": "901600",
    "end": "903040"
  },
  {
    "text": "actuators trying to enumerate all the",
    "start": "903040",
    "end": "904959"
  },
  {
    "text": "documentation and eventually he does hit",
    "start": "904959",
    "end": "908199"
  },
  {
    "text": "a Swagger UI index with HTML So",
    "start": "908199",
    "end": "910720"
  },
  {
    "text": "eventually what happens here he's able",
    "start": "910720",
    "end": "911959"
  },
  {
    "text": "to enumerate these API end points and he",
    "start": "911959",
    "end": "914480"
  },
  {
    "text": "sees literally by doing this he's able",
    "start": "914480",
    "end": "916639"
  },
  {
    "text": "to see all 700 different API calls the",
    "start": "916639",
    "end": "920519"
  },
  {
    "text": "Swagger routes had loaded I use the same",
    "start": "920519",
    "end": "922199"
  },
  {
    "text": "trick to load all the Swagger docks on",
    "start": "922199",
    "end": "924079"
  },
  {
    "text": "all the other API endpoints and in total",
    "start": "924079",
    "end": "926000"
  },
  {
    "text": "there were 700 different API calls with",
    "start": "926000",
    "end": "928480"
  },
  {
    "text": "each AP Pi having the following number",
    "start": "928480",
    "end": "930199"
  },
  {
    "text": "of calls and these are literally every",
    "start": "930199",
    "end": "931880"
  },
  {
    "text": "endpoint that is exposed on the Cox",
    "start": "931880",
    "end": "934560"
  },
  {
    "text": "Business Network yeah so this is this is",
    "start": "934560",
    "end": "936839"
  },
  {
    "text": "where the article takes a wild turn so",
    "start": "936839",
    "end": "939319"
  },
  {
    "text": "here it's looking like oh the API Dev",
    "start": "939319",
    "end": "942920"
  },
  {
    "text": "forgot to turn off swagger like Swagger",
    "start": "942920",
    "end": "945480"
  },
  {
    "text": "went to prod so now you can see all the",
    "start": "945480",
    "end": "947240"
  },
  {
    "text": "end points oh boohoo but surely the",
    "start": "947240",
    "end": "949880"
  },
  {
    "text": "authentication is good I mean surely you",
    "start": "949880",
    "end": "952040"
  },
  {
    "text": "need to have an access key that only an",
    "start": "952040",
    "end": "953959"
  },
  {
    "text": "admin can have to get into this thing",
    "start": "953959",
    "end": "955639"
  },
  {
    "text": "right accidentally discovering an",
    "start": "955639",
    "end": "957519"
  },
  {
    "text": "authorization bypass on the Cox's",
    "start": "957519",
    "end": "959519"
  },
  {
    "text": "backend API after the Intruder scan of",
    "start": "959519",
    "end": "961560"
  },
  {
    "text": "all the API endpoints completed I",
    "start": "961560",
    "end": "963199"
  },
  {
    "text": "scrolled through to see if any had any",
    "start": "963199",
    "end": "964880"
  },
  {
    "text": "interesting responses the following",
    "start": "964880",
    "end": "966720"
  },
  {
    "text": "profile search endpoint had an",
    "start": "966720",
    "end": "968480"
  },
  {
    "text": "interesting HTTP response which appeared",
    "start": "968480",
    "end": "970600"
  },
  {
    "text": "to be a blank Json object from what",
    "start": "970600",
    "end": "972560"
  },
  {
    "text": "looked like to be an empty search so he",
    "start": "972560",
    "end": "974399"
  },
  {
    "text": "searched for profile search he did not",
    "start": "974399",
    "end": "976639"
  },
  {
    "text": "provide any data and because there was",
    "start": "976639",
    "end": "978680"
  },
  {
    "text": "no data he got a response back that said",
    "start": "978680",
    "end": "980880"
  },
  {
    "text": "success zero hits so looking at the",
    "start": "980880",
    "end": "983639"
  },
  {
    "text": "JavaScript it seemed that we needed to",
    "start": "983639",
    "end": "984920"
  },
  {
    "text": "add an argument to the URI for a profile",
    "start": "984920",
    "end": "986639"
  },
  {
    "text": "to search for he added that ur ur U and",
    "start": "986639",
    "end": "989360"
  },
  {
    "text": "searched test in the URI and got the",
    "start": "989360",
    "end": "991519"
  },
  {
    "text": "following response message authorization",
    "start": "991519",
    "end": "994079"
  },
  {
    "text": "error invalid user token invalid user",
    "start": "994079",
    "end": "996800"
  },
  {
    "text": "token but I had just been able to hit",
    "start": "996800",
    "end": "998440"
  },
  {
    "text": "this endpoint I removed the word test",
    "start": "998440",
    "end": "1000360"
  },
  {
    "text": "from the URI resent the request and",
    "start": "1000360",
    "end": "1002519"
  },
  {
    "text": "another authorization error for some",
    "start": "1002519",
    "end": "1005160"
  },
  {
    "text": "reason the original endpoint without",
    "start": "1005160",
    "end": "1007079"
  },
  {
    "text": "parameters was now returning an",
    "start": "1007079",
    "end": "1008360"
  },
  {
    "text": "authorization error even though I just",
    "start": "1008360",
    "end": "1011000"
  },
  {
    "text": "hit it when running Intruder I did a",
    "start": "1011000",
    "end": "1013319"
  },
  {
    "text": "sanity check and confirmed that nothing",
    "start": "1013319",
    "end": "1014920"
  },
  {
    "text": "had changed between my requested",
    "start": "1014920",
    "end": "1016360"
  },
  {
    "text": "Intruder and the repeater request I",
    "start": "1016360",
    "end": "1018360"
  },
  {
    "text": "replayed the request one more time but",
    "start": "1018360",
    "end": "1019839"
  },
  {
    "text": "surprisingly this time it gave me the",
    "start": "1019839",
    "end": "1021240"
  },
  {
    "text": "original 200 okay and the Json response",
    "start": "1021240",
    "end": "1023880"
  },
  {
    "text": "from Intruder what was going on it",
    "start": "1023880",
    "end": "1025839"
  },
  {
    "text": "seemed to be intermittently giving me",
    "start": "1025839",
    "end": "1027319"
  },
  {
    "text": "authorization errors and then saying the",
    "start": "1027319",
    "end": "1029438"
  },
  {
    "text": "request have been successful so what it",
    "start": "1029439",
    "end": "1031319"
  },
  {
    "text": "sounds like is internal in this system",
    "start": "1031319",
    "end": "1033918"
  },
  {
    "text": "there are multiple servers and it's",
    "start": "1033919",
    "end": "1035678"
  },
  {
    "text": "doing like round robin load balancing",
    "start": "1035679",
    "end": "1037959"
  },
  {
    "text": "and every once in a while he is hitting",
    "start": "1037959",
    "end": "1039798"
  },
  {
    "text": "a server where the authorization is just",
    "start": "1039799",
    "end": "1042720"
  },
  {
    "text": "not correctly set up like it is just a",
    "start": "1042720",
    "end": "1045199"
  },
  {
    "text": "naked server that anyone can go in and",
    "start": "1045199",
    "end": "1047319"
  },
  {
    "text": "and touch the endpoints without a user",
    "start": "1047319",
    "end": "1049360"
  },
  {
    "text": "token now this may be because there's",
    "start": "1049360",
    "end": "1051280"
  },
  {
    "text": "some weird caching issue going on where",
    "start": "1051280",
    "end": "1053480"
  },
  {
    "text": "maybe someone somewhere else made a",
    "start": "1053480",
    "end": "1055679"
  },
  {
    "text": "successful request and then there's like",
    "start": "1055679",
    "end": "1057039"
  },
  {
    "text": "a knat translation in the Middle where",
    "start": "1057039",
    "end": "1058640"
  },
  {
    "text": "like it sees that authorization session",
    "start": "1058640",
    "end": "1060679"
  },
  {
    "text": "coming from the right server but either",
    "start": "1060679",
    "end": "1062200"
  },
  {
    "text": "way this person is able to run these",
    "start": "1062200",
    "end": "1065160"
  },
  {
    "text": "queries by typing in uh by by doing a",
    "start": "1065160",
    "end": "1068679"
  },
  {
    "text": "profile search and they you know they",
    "start": "1068679",
    "end": "1069840"
  },
  {
    "text": "redacted all this but to test it I",
    "start": "1069840",
    "end": "1071840"
  },
  {
    "text": "could if to test if I could reproduce",
    "start": "1071840",
    "end": "1073280"
  },
  {
    "text": "this with an actual search query I wrote",
    "start": "1073280",
    "end": "1074880"
  },
  {
    "text": "down Cox in the URI and replayed the",
    "start": "1074880",
    "end": "1076880"
  },
  {
    "text": "request two or three more times so I got",
    "start": "1076880",
    "end": "1078360"
  },
  {
    "text": "the following response and he got",
    "start": "1078360",
    "end": "1080120"
  },
  {
    "text": "success he got 10,000 hits and he G gave",
    "start": "1080120",
    "end": "1082840"
  },
  {
    "text": "him a search list and even crazier these",
    "start": "1082840",
    "end": "1086039"
  },
  {
    "text": "looked like profiles of Cox Business",
    "start": "1086039",
    "end": "1087960"
  },
  {
    "text": "customers not really expecting results I",
    "start": "1087960",
    "end": "1090080"
  },
  {
    "text": "replaced the word Cox with FBI to see if",
    "start": "1090080",
    "end": "1093200"
  },
  {
    "text": "it was polling actual customer data and",
    "start": "1093200",
    "end": "1096000"
  },
  {
    "text": "you're you're seeing there's FBI",
    "start": "1096000",
    "end": "1097640"
  },
  {
    "text": "redacted FBI redacted FBI redacted the",
    "start": "1097640",
    "end": "1100880"
  },
  {
    "text": "above response contained the physical",
    "start": "1100880",
    "end": "1102919"
  },
  {
    "text": "addresses of several FBI field offices",
    "start": "1102919",
    "end": "1106200"
  },
  {
    "text": "who were Cox's business customers the",
    "start": "1106200",
    "end": "1108840"
  },
  {
    "text": "administrative customer search API was",
    "start": "1108840",
    "end": "1110520"
  },
  {
    "text": "working not good so he not only found an",
    "start": "1110520",
    "end": "1113159"
  },
  {
    "text": "API he thought oh I don't have off on",
    "start": "1113159",
    "end": "1116080"
  },
  {
    "text": "this API surely it's just a test API",
    "start": "1116080",
    "end": "1119880"
  },
  {
    "text": "where there's not real data behind it",
    "start": "1119880",
    "end": "1122240"
  },
  {
    "text": "and so as kind of a joke he puts FBI",
    "start": "1122240",
    "end": "1125320"
  },
  {
    "text": "into the search and he got legit like",
    "start": "1125320",
    "end": "1128120"
  },
  {
    "text": "FBI sites in the request uh so we had",
    "start": "1128120",
    "end": "1130200"
  },
  {
    "text": "confirmed there was an off bypass for",
    "start": "1130200",
    "end": "1131880"
  },
  {
    "text": "the API endpoints by simply replaying",
    "start": "1131880",
    "end": "1134159"
  },
  {
    "text": "the HTTP request multiple times and",
    "start": "1134159",
    "end": "1136559"
  },
  {
    "text": "there were over 78 API requests that we",
    "start": "1136559",
    "end": "1139960"
  },
  {
    "text": "could hit it was time to see what the",
    "start": "1139960",
    "end": "1142840"
  },
  {
    "text": "real impact was and this is where the",
    "start": "1142840",
    "end": "1145720"
  },
  {
    "text": "article kind of like boils to the top",
    "start": "1145720",
    "end": "1147760"
  },
  {
    "text": "and you can just smell the the hacker",
    "start": "1147760",
    "end": "1150480"
  },
  {
    "text": "Grease the hacker Essence not the hacker",
    "start": "1150480",
    "end": "1152360"
  },
  {
    "text": "grease Sam's a great guy I looked back",
    "start": "1152360",
    "end": "1154080"
  },
  {
    "text": "at the results of the Intruder scan not",
    "start": "1154080",
    "end": "1156880"
  },
  {
    "text": "know or now knowing that I could bypass",
    "start": "1156880",
    "end": "1158559"
  },
  {
    "text": "authorization by simply replaying a",
    "start": "1158559",
    "end": "1160480"
  },
  {
    "text": "request in order to figure out if this",
    "start": "1160480",
    "end": "1162440"
  },
  {
    "text": "vulnerability could have been used to",
    "start": "1162440",
    "end": "1164120"
  },
  {
    "text": "hack my modem I needed to know if this",
    "start": "1164120",
    "end": "1166120"
  },
  {
    "text": "API had access to the residential",
    "start": "1166120",
    "end": "1167919"
  },
  {
    "text": "Network at an Access Control level Cox",
    "start": "1167919",
    "end": "1170720"
  },
  {
    "text": "offered both residential and business",
    "start": "1170720",
    "end": "1172720"
  },
  {
    "text": "services under the hood I was guessing",
    "start": "1172720",
    "end": "1174559"
  },
  {
    "text": "the underlying API had access to both I",
    "start": "1174559",
    "end": "1177559"
  },
  {
    "text": "went ahead and pulled out the simplest",
    "start": "1177559",
    "end": "1179039"
  },
  {
    "text": "looking request that took in a MAC",
    "start": "1179039",
    "end": "1180720"
  },
  {
    "text": "address parameter to test if I could",
    "start": "1180720",
    "end": "1182679"
  },
  {
    "text": "access my own modem via the API and I I",
    "start": "1182679",
    "end": "1186039"
  },
  {
    "text": "just think this article is crazy because",
    "start": "1186039",
    "end": "1188000"
  },
  {
    "text": "it goes from zero to 100 so fast dude it",
    "start": "1188000",
    "end": "1190360"
  },
  {
    "text": "goes from uh I can query if a profile",
    "start": "1190360",
    "end": "1193360"
  },
  {
    "text": "exists in the Cox database to uh I'm",
    "start": "1193360",
    "end": "1196080"
  },
  {
    "text": "going to see if I can change settings on",
    "start": "1196080",
    "end": "1197360"
  },
  {
    "text": "my modem via the MAC address",
    "start": "1197360",
    "end": "1199240"
  },
  {
    "text": "like what this was a get request to",
    "start": "1199240",
    "end": "1201360"
  },
  {
    "text": "retrieve a modem IP address that",
    "start": "1201360",
    "end": "1202840"
  },
  {
    "text": "required a MAC address parameter I",
    "start": "1202840",
    "end": "1204559"
  },
  {
    "text": "logged into Cox retrieve my own Mac",
    "start": "1204559",
    "end": "1206360"
  },
  {
    "text": "address and then hit the HTP request",
    "start": "1206360",
    "end": "1208159"
  },
  {
    "text": "over and over again until it returned",
    "start": "1208159",
    "end": "1209600"
  },
  {
    "text": "200 okay so it returned this right and",
    "start": "1209600",
    "end": "1212000"
  },
  {
    "text": "so what is this this request is account",
    "start": "1212000",
    "end": "1214120"
  },
  {
    "text": "equipment V1 equipment he puts in his",
    "start": "1214120",
    "end": "1215880"
  },
  {
    "text": "account number and it returns a list of",
    "start": "1215880",
    "end": "1218559"
  },
  {
    "text": "all the Cox's equipment that is on",
    "start": "1218559",
    "end": "1220520"
  },
  {
    "text": "premises at this guy's house it worked",
    "start": "1220520",
    "end": "1223360"
  },
  {
    "text": "my connected equipment was returned in",
    "start": "1223360",
    "end": "1225919"
  },
  {
    "text": "the HTTP response so like by using his",
    "start": "1225919",
    "end": "1228840"
  },
  {
    "text": "Mac address and Uno he was able to query",
    "start": "1228840",
    "end": "1231400"
  },
  {
    "text": "if he had oh a Cox Business TV uh a",
    "start": "1231400",
    "end": "1235000"
  },
  {
    "text": "telephony device a Cisco router a Cisco",
    "start": "1235000",
    "end": "1238039"
  },
  {
    "text": "phone a Nokia on a fiber Network",
    "start": "1238039",
    "end": "1241159"
  },
  {
    "text": "transmitter like yeah dude it it's crazy",
    "start": "1241159",
    "end": "1244880"
  },
  {
    "text": "accessing and updating any Cox Business",
    "start": "1244880",
    "end": "1247080"
  },
  {
    "text": "customer account to test if this could",
    "start": "1247080",
    "end": "1248919"
  },
  {
    "text": "reabuse the access and modifi business",
    "start": "1248919",
    "end": "1250760"
  },
  {
    "text": "customer accounts I found an API request",
    "start": "1250760",
    "end": "1252720"
  },
  {
    "text": "which could query customers via email I",
    "start": "1252720",
    "end": "1255159"
  },
  {
    "text": "sent the following HTTP request and saw",
    "start": "1255159",
    "end": "1257360"
  },
  {
    "text": "the following response so we put API",
    "start": "1257360",
    "end": "1259520"
  },
  {
    "text": "this whole thing trying to query what",
    "start": "1259520",
    "end": "1260840"
  },
  {
    "text": "the user data is and he put admin",
    "start": "1260840",
    "end": "1262760"
  },
  {
    "text": "cox.net and he got legitimate data he",
    "start": "1262760",
    "end": "1266120"
  },
  {
    "text": "redacted a lot of it being a good a good",
    "start": "1266120",
    "end": "1267960"
  },
  {
    "text": "responsible hacker um but yeah this guy",
    "start": "1267960",
    "end": "1271080"
  },
  {
    "text": "like was able to use the endpoint and he",
    "start": "1271080",
    "end": "1272760"
  },
  {
    "text": "literally queried admin cox.net and",
    "start": "1272760",
    "end": "1275400"
  },
  {
    "text": "other similar post uh account update",
    "start": "1275400",
    "end": "1277320"
  },
  {
    "text": "requests worked so he was able to read",
    "start": "1277320",
    "end": "1280240"
  },
  {
    "text": "and write business accounts another",
    "start": "1280240",
    "end": "1282360"
  },
  {
    "text": "similar post account update uh worked",
    "start": "1282360",
    "end": "1284039"
  },
  {
    "text": "and we already read this so at this",
    "start": "1284039",
    "end": "1285360"
  },
  {
    "text": "point I demonstrated it was possible to",
    "start": "1285360",
    "end": "1286760"
  },
  {
    "text": "one search a customer and retrieve their",
    "start": "1286760",
    "end": "1288640"
  },
  {
    "text": "business account pii using only their",
    "start": "1288640",
    "end": "1290400"
  },
  {
    "text": "name two retrieve the Mac addresses of",
    "start": "1290400",
    "end": "1292919"
  },
  {
    "text": "connected Hardware on their account and",
    "start": "1292919",
    "end": "1294919"
  },
  {
    "text": "then three run commands against that Mac",
    "start": "1294919",
    "end": "1297279"
  },
  {
    "text": "address via the API so you can",
    "start": "1297279",
    "end": "1299360"
  },
  {
    "text": "completely not only enumerate your",
    "start": "1299360",
    "end": "1300600"
  },
  {
    "text": "network but run commands via Mac address",
    "start": "1300600",
    "end": "1303760"
  },
  {
    "text": "it's not rce yet someone just said in",
    "start": "1303760",
    "end": "1305720"
  },
  {
    "text": "chat retrieve crypto private keys so if",
    "start": "1305720",
    "end": "1308039"
  },
  {
    "text": "this were done properly this would be",
    "start": "1308039",
    "end": "1309880"
  },
  {
    "text": "okay if there were a a a keying scheme",
    "start": "1309880",
    "end": "1313760"
  },
  {
    "text": "where the company had a private key the",
    "start": "1313760",
    "end": "1315760"
  },
  {
    "text": "other end had a public key you signed",
    "start": "1315760",
    "end": "1317440"
  },
  {
    "text": "the request with the with the private",
    "start": "1317440",
    "end": "1318799"
  },
  {
    "text": "key and then you decrypt it you verify",
    "start": "1318799",
    "end": "1321000"
  },
  {
    "text": "the digital signature and you say okay",
    "start": "1321000",
    "end": "1322480"
  },
  {
    "text": "it came from the ISP overriding anyone's",
    "start": "1322480",
    "end": "1324559"
  },
  {
    "text": "device settings via leaked cryptographic",
    "start": "1324559",
    "end": "1326279"
  },
  {
    "text": "secret and looking through the Swagger",
    "start": "1326279",
    "end": "1327480"
  },
  {
    "text": "docs it seemed that every Hardware",
    "start": "1327480",
    "end": "1328960"
  },
  {
    "text": "modification request for example update",
    "start": "1328960",
    "end": "1330799"
  },
  {
    "text": "device password required a parameter",
    "start": "1330799",
    "end": "1333320"
  },
  {
    "text": "called encrypted value if I could find a",
    "start": "1333320",
    "end": "1335960"
  },
  {
    "text": "way to generate this value then I could",
    "start": "1335960",
    "end": "1337960"
  },
  {
    "text": "demonstrate right access to modems that",
    "start": "1337960",
    "end": "1339919"
  },
  {
    "text": "would lead to remote code execution now",
    "start": "1339919",
    "end": "1342120"
  },
  {
    "text": "again in terms of basic cryptographic",
    "start": "1342120",
    "end": "1346279"
  },
  {
    "text": "Primitives if you know how cryptography",
    "start": "1346279",
    "end": "1348320"
  },
  {
    "text": "works works if you are trying to",
    "start": "1348320",
    "end": "1349960"
  },
  {
    "text": "authenticate that a response came from",
    "start": "1349960",
    "end": "1352600"
  },
  {
    "text": "your ISP you would use a signing scheme",
    "start": "1352600",
    "end": "1356559"
  },
  {
    "text": "a signing scheme uses asymmetric",
    "start": "1356559",
    "end": "1358880"
  },
  {
    "text": "cryptography things like RSA elliptic",
    "start": "1358880",
    "end": "1361840"
  },
  {
    "text": "curve under the hood to exchange a",
    "start": "1361840",
    "end": "1364559"
  },
  {
    "text": "signature that you then verify with the",
    "start": "1364559",
    "end": "1366120"
  },
  {
    "text": "public key assert would be enough yeah",
    "start": "1366120",
    "end": "1367720"
  },
  {
    "text": "exactly they could use assert they could",
    "start": "1367720",
    "end": "1368919"
  },
  {
    "text": "they could do they could do something",
    "start": "1368919",
    "end": "1370200"
  },
  {
    "text": "like this okay so to know if I could",
    "start": "1370200",
    "end": "1373000"
  },
  {
    "text": "even generate this encrypt value",
    "start": "1373000",
    "end": "1374480"
  },
  {
    "text": "parameter I had to dig through the",
    "start": "1374480",
    "end": "1375600"
  },
  {
    "text": "original JavaScript to figure out",
    "start": "1375600",
    "end": "1377039"
  },
  {
    "text": "exactly how it was being signed and",
    "start": "1377039",
    "end": "1378320"
  },
  {
    "text": "again he's using the word signed here",
    "start": "1378320",
    "end": "1380240"
  },
  {
    "text": "and I think as you're getting from my",
    "start": "1380240",
    "end": "1381360"
  },
  {
    "text": "inflection of my voice it's not going to",
    "start": "1381360",
    "end": "1382760"
  },
  {
    "text": "be a signing scheme after tracing the",
    "start": "1382760",
    "end": "1384360"
  },
  {
    "text": "encrypted value parameter back to the",
    "start": "1384360",
    "end": "1385720"
  },
  {
    "text": "JavaScript I landed on these two",
    "start": "1385720",
    "end": "1387279"
  },
  {
    "text": "functions yep in JavaScript both of",
    "start": "1387279",
    "end": "1389279"
  },
  {
    "text": "these functions took in variables which",
    "start": "1389279",
    "end": "1391120"
  },
  {
    "text": "existed at runtime so the easiest way to",
    "start": "1391120",
    "end": "1393919"
  },
  {
    "text": "actually call these functions would it",
    "start": "1393919",
    "end": "1395480"
  },
  {
    "text": "be to find somewhere that it was called",
    "start": "1395480",
    "end": "1396880"
  },
  {
    "text": "using the actual API and after searching",
    "start": "1396880",
    "end": "1399039"
  },
  {
    "text": "for a little while I realized that the",
    "start": "1399039",
    "end": "1400520"
  },
  {
    "text": "four-digit pin I set was a registering",
    "start": "1400520",
    "end": "1402640"
  },
  {
    "text": "my account was encrypting using the same",
    "start": "1402640",
    "end": "1404640"
  },
  {
    "text": "function now that I had a breakpoint set",
    "start": "1404640",
    "end": "1406159"
  },
  {
    "text": "I was in the correct context for the",
    "start": "1406159",
    "end": "1407520"
  },
  {
    "text": "function I could simply paste the",
    "start": "1407520",
    "end": "1409360"
  },
  {
    "text": "function into my console and run",
    "start": "1409360",
    "end": "1411440"
  },
  {
    "text": "whatever I wanted so again this is the",
    "start": "1411440",
    "end": "1413600"
  },
  {
    "text": "issue with doing critical functions on",
    "start": "1413600",
    "end": "1415960"
  },
  {
    "text": "the front end because the code is not",
    "start": "1415960",
    "end": "1418400"
  },
  {
    "text": "closed Source you could have done this",
    "start": "1418400",
    "end": "1420480"
  },
  {
    "text": "on the modem you could have done this",
    "start": "1420480",
    "end": "1422159"
  },
  {
    "text": "somewhere else where there is a hardware",
    "start": "1422159",
    "end": "1424240"
  },
  {
    "text": "root of trust the hardware root of trust",
    "start": "1424240",
    "end": "1426279"
  },
  {
    "text": "stores the key and then the kernel",
    "start": "1426279",
    "end": "1428159"
  },
  {
    "text": "retrieves the encrypted data from the",
    "start": "1428159",
    "end": "1429720"
  },
  {
    "text": "hardware root of trust there are so many",
    "start": "1429720",
    "end": "1431679"
  },
  {
    "text": "ways you could have done this",
    "start": "1431679",
    "end": "1432360"
  },
  {
    "text": "differently but they are using a a",
    "start": "1432360",
    "end": "1435000"
  },
  {
    "text": "symmetric key scheme on the front end to",
    "start": "1435000",
    "end": "1438440"
  },
  {
    "text": "to access the API okay let's keep",
    "start": "1438440",
    "end": "1440159"
  },
  {
    "text": "reading to validate that it worked I",
    "start": "1440159",
    "end": "1441559"
  },
  {
    "text": "copied the encrypted value of the PIN",
    "start": "1441559",
    "end": "1442799"
  },
  {
    "text": "code that was set to the post request",
    "start": "1442799",
    "end": "1443960"
  },
  {
    "text": "and passed it to the decrypt function so",
    "start": "1443960",
    "end": "1446520"
  },
  {
    "text": "he decrypts this he takes the value that",
    "start": "1446520",
    "end": "1448880"
  },
  {
    "text": "was sent by the to the API he decrypts",
    "start": "1448880",
    "end": "1451640"
  },
  {
    "text": "it and out pops 8042 which is his pin",
    "start": "1451640",
    "end": "1455320"
  },
  {
    "text": "perfectly it works as expected the only",
    "start": "1455320",
    "end": "1457480"
  },
  {
    "text": "issue now is getting the encrypted value",
    "start": "1457480",
    "end": "1458880"
  },
  {
    "text": "of a device so where where is that",
    "start": "1458880",
    "end": "1460520"
  },
  {
    "text": "device encrypted value I asked around",
    "start": "1460520",
    "end": "1462640"
  },
  {
    "text": "for a while until I found uh until I",
    "start": "1462640",
    "end": "1464279"
  },
  {
    "text": "found a friend who owned an MSP a few",
    "start": "1464279",
    "end": "1465799"
  },
  {
    "text": "states away he used Cox's business the",
    "start": "1465799",
    "end": "1467720"
  },
  {
    "text": "game of the log into the account and I",
    "start": "1467720",
    "end": "1468840"
  },
  {
    "text": "saw what appeared to be an encrypted",
    "start": "1468840",
    "end": "1470159"
  },
  {
    "text": "value parameter in one of the HTTP",
    "start": "1470159",
    "end": "1472520"
  },
  {
    "text": "responses after authenticating into",
    "start": "1472520",
    "end": "1474200"
  },
  {
    "text": "their account so this guy logged in I",
    "start": "1474200",
    "end": "1475880"
  },
  {
    "text": "copied the value and pass it into the",
    "start": "1475880",
    "end": "1477279"
  },
  {
    "text": "function once again and out poops this",
    "start": "1477279",
    "end": "1479640"
  },
  {
    "text": "long string of data and something in",
    "start": "1479640",
    "end": "1482159"
  },
  {
    "text": "here is a little suspicious this looks",
    "start": "1482159",
    "end": "1484200"
  },
  {
    "text": "like a MAC address okay let's see what's",
    "start": "1484200",
    "end": "1487039"
  },
  {
    "text": "going on well that's annoying it looked",
    "start": "1487039",
    "end": "1489120"
  },
  {
    "text": "like the encrypted parameter had the MAC",
    "start": "1489120",
    "end": "1490640"
  },
  {
    "text": "address but also an account ID and a few",
    "start": "1490640",
    "end": "1493799"
  },
  {
    "text": "extra parameters So within this",
    "start": "1493799",
    "end": "1495960"
  },
  {
    "text": "encrypted value that his friend got from",
    "start": "1495960",
    "end": "1497640"
  },
  {
    "text": "the the API request it had the account",
    "start": "1497640",
    "end": "1500480"
  },
  {
    "text": "number the device name the device ID",
    "start": "1500480",
    "end": "1503240"
  },
  {
    "text": "something unknown a label and a MAC",
    "start": "1503240",
    "end": "1505600"
  },
  {
    "text": "address if there was some validation",
    "start": "1505600",
    "end": "1507159"
  },
  {
    "text": "with check the MAC address attached to",
    "start": "1507159",
    "end": "1508799"
  },
  {
    "text": "the account ID it would make exploiting",
    "start": "1508799",
    "end": "1510760"
  },
  {
    "text": "this somewhat complicated I investigated",
    "start": "1510760",
    "end": "1512600"
  },
  {
    "text": "further on a leap of faith I tried",
    "start": "1512600",
    "end": "1515440"
  },
  {
    "text": "signing and again the issue here is he's",
    "start": "1515440",
    "end": "1517240"
  },
  {
    "text": "using the word signing there is no",
    "start": "1517240",
    "end": "1519240"
  },
  {
    "text": "signing happening here it is decryption",
    "start": "1519240",
    "end": "1521440"
  },
  {
    "text": "I'm not on Sam I'm just saying",
    "start": "1521440",
    "end": "1522799"
  },
  {
    "text": "like you could do this semi- correctly",
    "start": "1522799",
    "end": "1525120"
  },
  {
    "text": "if you had a proper signing scheme but",
    "start": "1525120",
    "end": "1527320"
  },
  {
    "text": "they're using AAS",
    "start": "1527320",
    "end": "1528919"
  },
  {
    "text": "uh I tried assigning encrypted value",
    "start": "1528919",
    "end": "1530880"
  },
  {
    "text": "string with a junk data for everything",
    "start": "1530880",
    "end": "1532480"
  },
  {
    "text": "so he he's basically not caring about",
    "start": "1532480",
    "end": "1534399"
  },
  {
    "text": "any of this data except for the MAC",
    "start": "1534399",
    "end": "1536520"
  },
  {
    "text": "address which is the MAC address of a",
    "start": "1536520",
    "end": "1538880"
  },
  {
    "text": "device he wants to attack uh to see if",
    "start": "1538880",
    "end": "1540720"
  },
  {
    "text": "it actually validated that the account",
    "start": "1540720",
    "end": "1542080"
  },
  {
    "text": "ID matched the MAC address if this",
    "start": "1542080",
    "end": "1543840"
  },
  {
    "text": "request worked it meant that I could use",
    "start": "1543840",
    "end": "1545320"
  },
  {
    "text": "encrypted value parameter in the API",
    "start": "1545320",
    "end": "1547279"
  },
  {
    "text": "that didn't have a matching account ID I",
    "start": "1547279",
    "end": "1549720"
  },
  {
    "text": "sent the request and I saw the exact",
    "start": "1549720",
    "end": "1551679"
  },
  {
    "text": "same response as aboved this confirmed",
    "start": "1551679",
    "end": "1553880"
  },
  {
    "text": "that we didn't need any extra parameters",
    "start": "1553880",
    "end": "1556799"
  },
  {
    "text": "we could just query any hardware device",
    "start": "1556799",
    "end": "1559480"
  },
  {
    "text": "just by knowing the MAC address we now",
    "start": "1559480",
    "end": "1561240"
  },
  {
    "text": "essentially had a full kill chain I",
    "start": "1561240",
    "end": "1563200"
  },
  {
    "text": "formed the following HTTP request to",
    "start": "1563200",
    "end": "1565799"
  },
  {
    "text": "change the SSID of one of my own devices",
    "start": "1565799",
    "end": "1569520"
  },
  {
    "text": "so here he's changing the SSID of his",
    "start": "1569520",
    "end": "1572799"
  },
  {
    "text": "device via this this endpoint to the",
    "start": "1572799",
    "end": "1574919"
  },
  {
    "text": "name Curry okay he got a success message",
    "start": "1574919",
    "end": "1577840"
  },
  {
    "text": "and sure as after five minutes",
    "start": "1577840",
    "end": "1579919"
  },
  {
    "text": "later my network rebooted and the SSID",
    "start": "1579919",
    "end": "1582679"
  },
  {
    "text": "name of my device had been changed to",
    "start": "1582679",
    "end": "1584679"
  },
  {
    "text": "Curry I could read and write anyone's",
    "start": "1584679",
    "end": "1587440"
  },
  {
    "text": "device via this exploit absolutely wild",
    "start": "1587440",
    "end": "1591200"
  },
  {
    "text": "this demonstrated that the API cost",
    "start": "1591200",
    "end": "1592720"
  },
  {
    "text": "update device configuration worked this",
    "start": "1592720",
    "end": "1594919"
  },
  {
    "text": "meant that an attacker could have access",
    "start": "1594919",
    "end": "1596720"
  },
  {
    "text": "this API to overwrite configuration",
    "start": "1596720",
    "end": "1598840"
  },
  {
    "text": "settings access the router and execute",
    "start": "1598840",
    "end": "1601080"
  },
  {
    "text": "commands on this device at this point we",
    "start": "1601080",
    "end": "1603559"
  },
  {
    "text": "had a similar set of permissions as the",
    "start": "1603559",
    "end": "1605120"
  },
  {
    "text": "ISP tech support and could have used",
    "start": "1605120",
    "end": "1606720"
  },
  {
    "text": "this account to exploit the millions of",
    "start": "1606720",
    "end": "1609080"
  },
  {
    "text": "devices that were accessible to the apis",
    "start": "1609080",
    "end": "1611279"
  },
  {
    "text": "so the total impact is that the series",
    "start": "1611279",
    "end": "1612799"
  },
  {
    "text": "of vulnerabilities demonstrated in a way",
    "start": "1612799",
    "end": "1614120"
  },
  {
    "text": "which fully a fully external attacker",
    "start": "1614120",
    "end": "1616520"
  },
  {
    "text": "with no prerequisites could have",
    "start": "1616520",
    "end": "1618559"
  },
  {
    "text": "executed commands and modified the",
    "start": "1618559",
    "end": "1620080"
  },
  {
    "text": "settings of millions of modems accessed",
    "start": "1620080",
    "end": "1622760"
  },
  {
    "text": "any business customer pii and gained",
    "start": "1622760",
    "end": "1625399"
  },
  {
    "text": "essentially the same permissions as an",
    "start": "1625399",
    "end": "1626760"
  },
  {
    "text": "ISP support team remotely from your",
    "start": "1626760",
    "end": "1629279"
  },
  {
    "text": "house and So eventually they did take",
    "start": "1629279",
    "end": "1631320"
  },
  {
    "text": "this they reported all it by a",
    "start": "1631320",
    "end": "1632480"
  },
  {
    "text": "responsible disclosure and he didn't",
    "start": "1632480",
    "end": "1634200"
  },
  {
    "text": "published this article until Cox went",
    "start": "1634200",
    "end": "1635840"
  },
  {
    "text": "through and fixed it Cox actually did a",
    "start": "1635840",
    "end": "1637960"
  },
  {
    "text": "very good job and they uh they I think",
    "start": "1637960",
    "end": "1640480"
  },
  {
    "text": "they fixed the the issue in a matter of",
    "start": "1640480",
    "end": "1642080"
  },
  {
    "text": "like a month or two which is really",
    "start": "1642080",
    "end": "1643159"
  },
  {
    "text": "really solid but it's just truly insane",
    "start": "1643159",
    "end": "1645799"
  },
  {
    "text": "so after reporting the vulnerability to",
    "start": "1645799",
    "end": "1647000"
  },
  {
    "text": "Cox they investigated if this if the",
    "start": "1647000",
    "end": "1649039"
  },
  {
    "text": "specific vendor had ever been",
    "start": "1649039",
    "end": "1650159"
  },
  {
    "text": "maliciously exploited in the past and",
    "start": "1650159",
    "end": "1651760"
  },
  {
    "text": "they found no history of abuse um they",
    "start": "1651760",
    "end": "1654200"
  },
  {
    "text": "had also informed me that they had no",
    "start": "1654200",
    "end": "1655799"
  },
  {
    "text": "affiliation with the digital IP address",
    "start": "1655799",
    "end": "1657399"
  },
  {
    "text": "or the digital ocean IP addresses",
    "start": "1657399",
    "end": "1658760"
  },
  {
    "text": "meaning that the device had definitely",
    "start": "1658760",
    "end": "1660200"
  },
  {
    "text": "been hacked and ju and just not using",
    "start": "1660200",
    "end": "1662840"
  },
  {
    "text": "the method disclosing this blog post",
    "start": "1662840",
    "end": "1665159"
  },
  {
    "text": "anyway thanks for reading more than",
    "start": "1665159",
    "end": "1666240"
  },
  {
    "text": "happy to listen to any theories comments",
    "start": "1666240",
    "end": "1667720"
  },
  {
    "text": "or whatever about what happened here",
    "start": "1667720",
    "end": "1669519"
  },
  {
    "text": "feel free feel free to reach out at samw",
    "start": "1669519",
    "end": "1671600"
  },
  {
    "text": "Curry gmail.com I think what probably",
    "start": "1671600",
    "end": "1674519"
  },
  {
    "text": "happened is that someone else figured",
    "start": "1674519",
    "end": "1676360"
  },
  {
    "text": "out this vulnerability in the API",
    "start": "1676360",
    "end": "1678760"
  },
  {
    "text": "they use this API to do some kind of",
    "start": "1678760",
    "end": "1681399"
  },
  {
    "text": "command injection vulnerability every",
    "start": "1681399",
    "end": "1683200"
  },
  {
    "text": "device that that can be touched by this",
    "start": "1683200",
    "end": "1685000"
  },
  {
    "text": "endpoint has to process that data or",
    "start": "1685000",
    "end": "1687720"
  },
  {
    "text": "that there could be a command injection",
    "start": "1687720",
    "end": "1689480"
  },
  {
    "text": "vulnerability in any of these fields",
    "start": "1689480",
    "end": "1691519"
  },
  {
    "text": "that he now can touch via these",
    "start": "1691519",
    "end": "1693760"
  },
  {
    "text": "endpoints like there may not be",
    "start": "1693760",
    "end": "1695640"
  },
  {
    "text": "necessarily a run arbitrary code",
    "start": "1695640",
    "end": "1698480"
  },
  {
    "text": "endpoint on this API that device has",
    "start": "1698480",
    "end": "1700760"
  },
  {
    "text": "endpoints that only that API could hit",
    "start": "1700760",
    "end": "1703200"
  },
  {
    "text": "if that API could touch any of the code",
    "start": "1703200",
    "end": "1705039"
  },
  {
    "text": "in there and there's a simple system",
    "start": "1705039",
    "end": "1706880"
  },
  {
    "text": "command injection in that that code then",
    "start": "1706880",
    "end": "1709480"
  },
  {
    "text": "I mean you're you're basically just",
    "start": "1709480",
    "end": "1710880"
  },
  {
    "text": "opening up the attack surface for other",
    "start": "1710880",
    "end": "1713600"
  },
  {
    "text": "bugs that could exist and I think that",
    "start": "1713600",
    "end": "1714960"
  },
  {
    "text": "probably is what happened now why",
    "start": "1714960",
    "end": "1716360"
  },
  {
    "text": "they're replaying the HTTP requests like",
    "start": "1716360",
    "end": "1719000"
  },
  {
    "text": "in the order of like 10 seconds or 5",
    "start": "1719000",
    "end": "1720679"
  },
  {
    "text": "Seconds that I don't know that's really",
    "start": "1720679",
    "end": "1722519"
  },
  {
    "text": "weird um but yeah man it's super weird",
    "start": "1722519",
    "end": "1725640"
  },
  {
    "text": "anyway go show uh Sam some love and then",
    "start": "1725640",
    "end": "1728399"
  },
  {
    "text": "hit that like button and that sub button",
    "start": "1728399",
    "end": "1729720"
  },
  {
    "text": "and then go watch this video this video",
    "start": "1729720",
    "end": "1731640"
  },
  {
    "text": "this video about how um what was my last",
    "start": "1731640",
    "end": "1734600"
  },
  {
    "text": "video then go check this video out",
    "start": "1734600",
    "end": "1737120"
  },
  {
    "text": "about Microsoft recall it's pretty crazy",
    "start": "1737120",
    "end": "1739200"
  },
  {
    "text": "we'll see you guys in the next one take",
    "start": "1739200",
    "end": "1740200"
  },
  {
    "text": "care bye bye",
    "start": "1740200",
    "end": "1743278"
  }
]