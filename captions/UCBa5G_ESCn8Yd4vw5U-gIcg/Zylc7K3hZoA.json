[
  {
    "text": "And so the way that we're going\nto do this is by saying, well,",
    "start": "0",
    "end": "2420"
  },
  {
    "text": "under the null hypothesis,\nthere's really no difference",
    "start": "2420",
    "end": "4520"
  },
  {
    "text": "between the x's and the y's.",
    "start": "4520",
    "end": "5840"
  },
  {
    "text": "They all have the same mean\nunder the null hypothesis.",
    "start": "5840",
    "end": "8172"
  },
  {
    "text": "So I'm just going\nto scramble them.",
    "start": "8172",
    "end": "9630"
  },
  {
    "text": "I'm just going to\nshuffle them together,",
    "start": "9630",
    "end": "10790"
  },
  {
    "text": "I'm going to permute them,\nI'm going to re-sample them,",
    "start": "10790",
    "end": "13082"
  },
  {
    "text": "and I'm going to generate a\nt-statistic on that shuffle",
    "start": "13082",
    "end": "15860"
  },
  {
    "text": "data.",
    "start": "15860",
    "end": "16410"
  },
  {
    "text": "I'm going to do that a huge\nnumber of times in order",
    "start": "16410",
    "end": "19010"
  },
  {
    "text": "to simulate the\nnull distribution.",
    "start": "19010",
    "end": "22040"
  },
  {
    "text": "And the idea here is that\nif I shuffle the data,",
    "start": "22040",
    "end": "24590"
  },
  {
    "text": "I'm essentially guaranteeing\nthat the null distribution is",
    "start": "24590",
    "end": "27080"
  },
  {
    "text": "correct.",
    "start": "27080",
    "end": "27860"
  },
  {
    "text": "Because even if there\nwas a difference, once",
    "start": "27860",
    "end": "30620"
  },
  {
    "text": "I've shuffled it, that\ndifference will go away.",
    "start": "30620",
    "end": "32900"
  },
  {
    "text": "Or stated another way,\nunder the null distribution,",
    "start": "32900",
    "end": "35172"
  },
  {
    "text": "it doesn't matter whether\nwe shuffled our data,",
    "start": "35172",
    "end": "37130"
  },
  {
    "text": "it's all the same either way.",
    "start": "37130",
    "end": "38750"
  },
  {
    "text": "So the first thing\nwe're going to do",
    "start": "38750",
    "end": "40250"
  },
  {
    "text": "is we're going to compute\na two-sample t-statistic",
    "start": "40250",
    "end": "42740"
  },
  {
    "text": "on our data.",
    "start": "42740",
    "end": "44030"
  },
  {
    "text": "And then we're going to do\nsomething a huge number of times",
    "start": "44030",
    "end": "46910"
  },
  {
    "text": "where B is a really big number.",
    "start": "46910",
    "end": "48650"
  },
  {
    "text": "If you're lazy,\nthen B might be 100.",
    "start": "48650",
    "end": "50700"
  },
  {
    "text": "And if you are a very\nenergetic person--",
    "start": "50700",
    "end": "52640"
  },
  {
    "text": "or actually maybe if you're a\nlazy person because your code",
    "start": "52640",
    "end": "55098"
  },
  {
    "text": "will run for a long time so\nyou'll have a long time to go",
    "start": "55098",
    "end": "57473"
  },
  {
    "text": "get a coffee--",
    "start": "57473",
    "end": "58110"
  },
  {
    "text": "well, whatever, your B might\nbe larger, like 10,000--",
    "start": "58110",
    "end": "61080"
  },
  {
    "text": "but bigger B is better.",
    "start": "61080",
    "end": "62067"
  },
  {
    "text": "So what you're going to do is\nyou're going to randomly shuffle",
    "start": "62067",
    "end": "64650"
  },
  {
    "text": "the observations and\nthen you're going",
    "start": "64650",
    "end": "67110"
  },
  {
    "text": "to call the first n\nsub x observations x",
    "start": "67110",
    "end": "70140"
  },
  {
    "text": "1 star through\n[? x-- ?] n x star.",
    "start": "70140",
    "end": "72113"
  },
  {
    "text": "And the remaining\nobservations are",
    "start": "72113",
    "end": "73530"
  },
  {
    "text": "going to be y 1 star\nthrough y n y star.",
    "start": "73530",
    "end": "75680"
  },
  {
    "text": "So all that you've\ndone so far is you took",
    "start": "75680",
    "end": "77430"
  },
  {
    "text": "your x's and your y's,\nyou put them in a basket,",
    "start": "77430",
    "end": "79920"
  },
  {
    "text": "you shook up the basket, you\ngrabbed n x and call them x",
    "start": "79920",
    "end": "83009"
  },
  {
    "text": "stars, you grabbed n\ny, called them y stars,",
    "start": "83010",
    "end": "85473"
  },
  {
    "text": "and now you're going to compute\na two-sample t-statistic on this",
    "start": "85473",
    "end": "88140"
  },
  {
    "text": "shuffled data and you're\ngoing to call it T star,",
    "start": "88140",
    "end": "91220"
  },
  {
    "text": "where the little b is because\nthis is the little b'th time",
    "start": "91220",
    "end": "95180"
  },
  {
    "text": "that we're going to\ndo this procedure.",
    "start": "95180",
    "end": "97790"
  },
  {
    "text": "And then after we've done\nthis capital B times,",
    "start": "97790",
    "end": "99890"
  },
  {
    "text": "like 1,000 times, we're\ngoing to compute a p-value.",
    "start": "99890",
    "end": "102450"
  },
  {
    "text": "And the p-value is just\nthe fraction of the time",
    "start": "102450",
    "end": "106219"
  },
  {
    "text": "that the t-statistic\non the shuffled data",
    "start": "106220",
    "end": "108980"
  },
  {
    "text": "exceeded an absolute value, the\nt-statistic on the real data.",
    "start": "108980",
    "end": "112610"
  },
  {
    "text": "So what does this notation\nmean, [? Gareth, ?] that 1",
    "start": "112610",
    "end": "115100"
  },
  {
    "text": "with the subscript?",
    "start": "115100",
    "end": "116189"
  },
  {
    "text": "So this is just counts\nas a 1-- a value of 1",
    "start": "116190",
    "end": "120300"
  },
  {
    "text": "if this quantity\nin the parentheses",
    "start": "120300",
    "end": "123110"
  },
  {
    "text": "is true and 0 otherwise.",
    "start": "123110",
    "end": "125020"
  },
  {
    "text": "So it's just-- so with\nthe summation here,",
    "start": "125020",
    "end": "127039"
  },
  {
    "text": "this is just counting the\nnumber of times that's true.",
    "start": "127040",
    "end": "129740"
  },
  {
    "text": "Yeah, so this-- the\nnumerator is just",
    "start": "129740",
    "end": "131600"
  },
  {
    "text": "the number of\nsimulated data sets--",
    "start": "131600",
    "end": "134000"
  },
  {
    "text": "or the number of\nresampled data sets,",
    "start": "134000",
    "end": "136340"
  },
  {
    "text": "reshuffled data sets for which\nthe test statistic exceeded",
    "start": "136340",
    "end": "139970"
  },
  {
    "text": "the test statistic that\nwe got on our real data.",
    "start": "139970",
    "end": "142210"
  },
  {
    "text": "And I'm dividing it\nby the number of times",
    "start": "142210",
    "end": "143960"
  },
  {
    "text": "I did this reshuffling.",
    "start": "143960",
    "end": "145307"
  },
  {
    "text": "And the reason we have\nthese absolute values",
    "start": "145307",
    "end": "147140"
  },
  {
    "text": "here is because we're computing\na two-sided p-value, where we're",
    "start": "147140",
    "end": "150680"
  },
  {
    "text": "equally interested in\nif the means are unequal",
    "start": "150680",
    "end": "155150"
  },
  {
    "text": "or we're equally interested\nand the x's mean being larger",
    "start": "155150",
    "end": "157680"
  },
  {
    "text": "than the y's mean\nversus the y's mean",
    "start": "157680",
    "end": "159278"
  },
  {
    "text": "being larger than the x's mean.",
    "start": "159278",
    "end": "160570"
  },
  {
    "text": "This is a two-sided p-value.",
    "start": "160570",
    "end": "162100"
  },
  {
    "text": "If you only wanted\na one-sided p-value,",
    "start": "162100",
    "end": "163800"
  },
  {
    "text": "you could get rid of\nthose absolute values.",
    "start": "163800",
    "end": "165760"
  },
  {
    "text": "And the concept here is that if\nthe resampled t-statistics are",
    "start": "165760",
    "end": "171000"
  },
  {
    "text": "almost all smaller than the\nobserved t-statistic, then",
    "start": "171000",
    "end": "174870"
  },
  {
    "text": "we're pretty suspicious that\nthe null hypothesis is not true.",
    "start": "174870",
    "end": "178299"
  },
  {
    "text": "But if we get quite a few\nresampled t-statistics that",
    "start": "178300",
    "end": "181770"
  },
  {
    "text": "are just as large or even\nlarger than what we observed,",
    "start": "181770",
    "end": "184680"
  },
  {
    "text": "then we're not so interested.",
    "start": "184680",
    "end": "186459"
  },
  {
    "text": "We're no longer suspicious\nabout that value.",
    "start": "186460",
    "end": "189230"
  },
  {
    "text": "Right.",
    "start": "189230",
    "end": "191330"
  },
  {
    "text": "So here's what we get if we\ntake some gene expression data",
    "start": "191330",
    "end": "195270"
  },
  {
    "text": "and we look at a\nparticular gene where",
    "start": "195270",
    "end": "197790"
  },
  {
    "text": "we have a control\ngroup and treatment",
    "start": "197790",
    "end": "199739"
  },
  {
    "text": "group measured for this gene.",
    "start": "199740",
    "end": "201963"
  },
  {
    "text": "And for this particular\ngene on the real data,",
    "start": "201963",
    "end": "203880"
  },
  {
    "text": "our t-statistic\nis negative 2.09.",
    "start": "203880",
    "end": "205900"
  },
  {
    "text": "That's the blue line.",
    "start": "205900",
    "end": "207040"
  },
  {
    "text": "And in orange, I'm showing\nyou the theoretical null",
    "start": "207040",
    "end": "209250"
  },
  {
    "text": "distribution for\nthat t-statistic.",
    "start": "209250",
    "end": "210880"
  },
  {
    "text": "So that's in orange.",
    "start": "210880",
    "end": "212080"
  },
  {
    "text": "And if I take this shuffling\nor sampling approach in order",
    "start": "212080",
    "end": "215010"
  },
  {
    "text": "to simulate the\nnull distribution,",
    "start": "215010",
    "end": "216959"
  },
  {
    "text": "I get the histogram\nshown in yellow.",
    "start": "216960",
    "end": "219000"
  },
  {
    "text": "And indeed what I see here\nis that the yellow histogram,",
    "start": "219000",
    "end": "221760"
  },
  {
    "text": "so that reshuffled\ndistribution that I",
    "start": "221760",
    "end": "223530"
  },
  {
    "text": "got for the null\ndistribution, is",
    "start": "223530",
    "end": "224915"
  },
  {
    "text": "pretty similar to the\ntheoretical null distribution",
    "start": "224915",
    "end": "227040"
  },
  {
    "text": "shown in orange.",
    "start": "227040",
    "end": "227872"
  },
  {
    "text": "It doesn't really matter\nmuch that I did reshuffling.",
    "start": "227872",
    "end": "230079"
  },
  {
    "text": "And, in fact, here the\ntheoretical p-value,",
    "start": "230080",
    "end": "232380"
  },
  {
    "text": "if I use that\ntheoretical normal 0, 1",
    "start": "232380",
    "end": "234540"
  },
  {
    "text": "distribution as my null\ndistribution for the t-statistic",
    "start": "234540",
    "end": "236939"
  },
  {
    "text": "is 0.041, my sampling\np-value is 0.042.",
    "start": "236940",
    "end": "240970"
  },
  {
    "text": "So in this particular example,\nthis was a big load of nothing.",
    "start": "240970",
    "end": "243910"
  },
  {
    "text": "And the reason it was a\nbig load of nothing, again,",
    "start": "243910",
    "end": "246090"
  },
  {
    "text": "is because the theoretical\nnull distribution actually",
    "start": "246090",
    "end": "248474"
  },
  {
    "text": "was pretty close to my\nreshuffled null distribution",
    "start": "248475",
    "end": "250600"
  },
  {
    "text": "anyway, so it just\ndidn't really matter.",
    "start": "250600",
    "end": "252430"
  },
  {
    "text": "Though, it does add confidence\nthat we had the right answer.",
    "start": "252430",
    "end": "255081"
  },
  {
    "text": "Yeah, there is\nsomething to be said",
    "start": "255082",
    "end": "256540"
  },
  {
    "text": "for just like using a\nsampling approach when",
    "start": "256540",
    "end": "259060"
  },
  {
    "text": "you can because why not?",
    "start": "259060",
    "end": "260989"
  },
  {
    "text": "It just feels a little you've\nmade fewer assumptions.",
    "start": "260990",
    "end": "265103"
  },
  {
    "text": "And actually here is on the\nsame data set a different gene",
    "start": "265103",
    "end": "267520"
  },
  {
    "text": "and you can really see.",
    "start": "267520",
    "end": "268870"
  },
  {
    "text": "Now, here's a gene where\nour results are actually",
    "start": "268870",
    "end": "271150"
  },
  {
    "text": "a bit different\ndepending on whether I",
    "start": "271150",
    "end": "273370"
  },
  {
    "text": "use the theoretical null\ndistribution shown in orange",
    "start": "273370",
    "end": "276160"
  },
  {
    "text": "versus the reshuffled null\ndistribution shown in yellow,",
    "start": "276160",
    "end": "280090"
  },
  {
    "text": "as the yellow histogram.",
    "start": "280090",
    "end": "281720"
  },
  {
    "text": "And we can see that actually\nthose two distributions",
    "start": "281720",
    "end": "284590"
  },
  {
    "text": "do look a bit different.",
    "start": "284590",
    "end": "285860"
  },
  {
    "text": "Our observed test statistic\nis negative 0.5696.",
    "start": "285860",
    "end": "289210"
  },
  {
    "text": "And my theoretical\np-value resulting",
    "start": "289210",
    "end": "291197"
  },
  {
    "text": "from the theoretical\nnull distribution",
    "start": "291197",
    "end": "292780"
  },
  {
    "text": "is 0.571, whereas the\nsampling p-value is 0.673.",
    "start": "292780",
    "end": "296780"
  },
  {
    "text": "So in this particular case,\nboth p-values are large,",
    "start": "296780",
    "end": "299232"
  },
  {
    "text": "so this won't really probably\naffect any conclusions that I",
    "start": "299232",
    "end": "301690"
  },
  {
    "text": "draw about the data--",
    "start": "301690",
    "end": "303190"
  },
  {
    "text": "or rather conclusions\nthat I draw from the data.",
    "start": "303190",
    "end": "305420"
  },
  {
    "text": "But, nonetheless,\nwe can see here",
    "start": "305420",
    "end": "306940"
  },
  {
    "text": "that sometimes a sampling\napproach can give you",
    "start": "306940",
    "end": "309590"
  },
  {
    "text": "a result that is\na bit different.",
    "start": "309590",
    "end": "311240"
  },
  {
    "text": "And, in general, a\nsampling approach--",
    "start": "311240",
    "end": "313310"
  },
  {
    "text": "you're trading off\ncomputational time for making",
    "start": "313310",
    "end": "317139"
  },
  {
    "text": "slightly weaker assumptions.",
    "start": "317140",
    "end": "319240"
  },
  {
    "text": "And the computer doesn't mind\ndoing that extra work, so--",
    "start": "319240",
    "end": "321759"
  },
  {
    "text": "A computer doesn't mind\ndoing the extra work.",
    "start": "321760",
    "end": "323750"
  },
  {
    "text": "That's true.",
    "start": "323750",
    "end": "324910"
  },
  {
    "text": "And it's always a good excuse\nto go get a long coffee while",
    "start": "324910",
    "end": "327730"
  },
  {
    "text": "your computer is running through\nthose capital B equals 10,000",
    "start": "327730",
    "end": "332770"
  },
  {
    "text": "reshuffles.",
    "start": "332770",
    "end": "334389"
  },
  {
    "text": "All right, so when are\nre-sampling approachs useful?",
    "start": "334390",
    "end": "337180"
  },
  {
    "text": "Well, they're\ndefinitely useful if",
    "start": "337180",
    "end": "339048"
  },
  {
    "text": "the theoretical null\ndistribution is unavailable.",
    "start": "339048",
    "end": "341090"
  },
  {
    "text": "So in the case of a\ntwo-sample t-statistic,",
    "start": "341090",
    "end": "343449"
  },
  {
    "text": "if you have a\nlarge sample size--",
    "start": "343450",
    "end": "346053"
  },
  {
    "text": "this is just my opinion and\na different statistician",
    "start": "346053",
    "end": "348220"
  },
  {
    "text": "might disagree with me--",
    "start": "348220",
    "end": "349220"
  },
  {
    "text": "I feel like if you're doing\na two-sample t-statistic",
    "start": "349220",
    "end": "351550"
  },
  {
    "text": "and your sample size is\nreally, really large,",
    "start": "351550",
    "end": "353560"
  },
  {
    "text": "maybe you don't really need\na re-sampling approach.",
    "start": "353560",
    "end": "356139"
  },
  {
    "text": "But if your sample\nsize is smaller,",
    "start": "356140",
    "end": "358090"
  },
  {
    "text": "then that's a really\ngood reason you",
    "start": "358090",
    "end": "359680"
  },
  {
    "text": "might want a re-sampling\napproach for a two-sample t-test",
    "start": "359680",
    "end": "362253"
  },
  {
    "text": "because, in that\ncase, we actually",
    "start": "362253",
    "end": "363669"
  },
  {
    "text": "don't know the theoretical\nnull distribution.",
    "start": "363670",
    "end": "365690"
  },
  {
    "text": "Or maybe there's\na test statistic",
    "start": "365690",
    "end": "367852"
  },
  {
    "text": "that you're interested\nin or a null",
    "start": "367852",
    "end": "369310"
  },
  {
    "text": "hypothesis you're testing\nfor which you really just",
    "start": "369310",
    "end": "370900"
  },
  {
    "text": "don't know the theoretical\nnull distribution at all",
    "start": "370900",
    "end": "373030"
  },
  {
    "text": "without making some\nreally strong assumptions.",
    "start": "373030",
    "end": "375485"
  },
  {
    "text": "So one way to think about this\nis that re-sampling approaches--",
    "start": "375485",
    "end": "378110"
  },
  {
    "text": "maybe we can just say they're\nalways useful because they don't",
    "start": "378110",
    "end": "380693"
  },
  {
    "text": "usually cost us very\nmuch to do and they",
    "start": "380693",
    "end": "385320"
  },
  {
    "text": "can allow us to overcome\nsome hurdles associated",
    "start": "385320",
    "end": "387390"
  },
  {
    "text": "with not knowing a\ntheoretical null distribution.",
    "start": "387390",
    "end": "389550"
  },
  {
    "text": "So here we've talked\nabout using re-sampling",
    "start": "389550",
    "end": "392069"
  },
  {
    "text": "to compute a p-value.",
    "start": "392070",
    "end": "393400"
  },
  {
    "text": "It turns out you can also\nuse a sampling approach",
    "start": "393400",
    "end": "395669"
  },
  {
    "text": "to control the FDR.",
    "start": "395670",
    "end": "396880"
  },
  {
    "text": "If you look it up\nin the textbook,",
    "start": "396880",
    "end": "398490"
  },
  {
    "text": "actually we work through that.",
    "start": "398490",
    "end": "400090"
  },
  {
    "text": "And we also worked\nthrough it in the R lab.",
    "start": "400090",
    "end": "402460"
  },
  {
    "text": "So you can see how\nwe can use sampling",
    "start": "402460",
    "end": "404130"
  },
  {
    "text": "to control FDR in the book.",
    "start": "404130",
    "end": "405730"
  },
  {
    "text": "We're not going to cover\nit today in this lecture.",
    "start": "405730",
    "end": "409140"
  },
  {
    "text": "And then, finally,\nhere, we talked",
    "start": "409140",
    "end": "410580"
  },
  {
    "text": "about a two-sample\nt-test, but you",
    "start": "410580",
    "end": "412199"
  },
  {
    "text": "can develop similar approaches\nfor other test statistics.",
    "start": "412200",
    "end": "414950"
  },
  {
    "text": "It just requires\na bit of thinking.",
    "start": "414950",
    "end": "416590"
  },
  {
    "text": "It's not usually\nlike just a command",
    "start": "416590",
    "end": "418530"
  },
  {
    "text": "in R, where you just type it in\nand then you get a p-value out.",
    "start": "418530",
    "end": "421338"
  },
  {
    "text": "You need to think\nabout how would you",
    "start": "421338",
    "end": "422880"
  },
  {
    "text": "design a re-sampling\napproach based",
    "start": "422880",
    "end": "424493"
  },
  {
    "text": "on your particular\nnull hypothesis",
    "start": "424493",
    "end": "425910"
  },
  {
    "text": "and your particular\ntest statistic.",
    "start": "425910",
    "end": "427660"
  },
  {
    "text": "And it's not always\nso clear how to do it.",
    "start": "427660",
    "end": "429580"
  },
  {
    "text": "A two-sample t-statistic\nis a very easy example,",
    "start": "429580",
    "end": "432569"
  },
  {
    "text": "but it can often be trickier.",
    "start": "432570",
    "end": "434700"
  },
  {
    "text": "All right, well, that's it.",
    "start": "434700",
    "end": "436140"
  },
  {
    "text": "Well, I'm looking\nforward to trying to do",
    "start": "436140",
    "end": "437970"
  },
  {
    "text": "all of this in the R lab next.",
    "start": "437970",
    "end": "439810"
  },
  {
    "text": "Yes, if there are any--\nif anything doesn't run,",
    "start": "439810",
    "end": "442380"
  },
  {
    "text": "it's because we're using\n[? Gareth's ?] computer,",
    "start": "442380",
    "end": "444710"
  },
  {
    "text": "so just be warned.",
    "start": "444710",
    "end": "446212"
  },
  {
    "text": "Can I make a joke about\nhow your computer's a PC.",
    "start": "446213",
    "end": "448255"
  },
  {
    "text": "[? Daniela ?] doesn't like PCs.",
    "start": "448255",
    "end": "449600"
  },
  {
    "text": "So--",
    "start": "449600",
    "end": "449770"
  },
  {
    "text": "Yeah, I've never been\nseen with a PC before.",
    "start": "449770",
    "end": "451603"
  },
  {
    "text": "This is hopefully--",
    "start": "451603",
    "end": "452395"
  },
  {
    "text": "She wanted to make it\nclear that this is not her.",
    "start": "452395",
    "end": "454460"
  },
  {
    "text": "I actually wanted to put\nan Apple sticker on this,",
    "start": "454460",
    "end": "456789"
  },
  {
    "text": "but I did not have one with me,\nso I wasn't able to do that.",
    "start": "456790",
    "end": "460690"
  },
  {
    "text": "Dell would probably\nsue you as well.",
    "start": "460690",
    "end": "462430"
  },
  {
    "text": "All right.",
    "start": "462430",
    "end": "464100"
  }
]