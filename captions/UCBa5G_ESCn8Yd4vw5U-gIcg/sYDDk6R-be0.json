[
  {
    "text": "OK.",
    "start": "0",
    "end": "1660"
  },
  {
    "text": "Now we slip one thing by you.",
    "start": "1660",
    "end": "4460"
  },
  {
    "text": "We said in South Africa,\nthe risk for heart disease",
    "start": "4460",
    "end": "9790"
  },
  {
    "text": "is about 5% in\nthis age category.",
    "start": "9790",
    "end": "14260"
  },
  {
    "text": "But in our sample, we've got\n160 cases and 302 controls.",
    "start": "14260",
    "end": "19020"
  },
  {
    "text": "So in the sample, we\nshow in a risk of 0.35.",
    "start": "19020",
    "end": "24060"
  },
  {
    "text": "So it seems like the\nmodel is going to be off,",
    "start": "24060",
    "end": "26949"
  },
  {
    "text": "it's going to estimate\nprobabilities too high.",
    "start": "26950",
    "end": "30340"
  },
  {
    "text": "Well case control sampling\nis one of the favorite tools",
    "start": "30340",
    "end": "34360"
  },
  {
    "text": "in epidemiology.",
    "start": "34360",
    "end": "35800"
  },
  {
    "text": "Especially when you have a rare\ndisease, you take all the cases,",
    "start": "35800",
    "end": "39710"
  },
  {
    "text": "you can find, and then you can\njust sample from the controls.",
    "start": "39710",
    "end": "43480"
  },
  {
    "text": "And the reason is, is that for\nthe logistic regression model,",
    "start": "43480",
    "end": "47620"
  },
  {
    "text": "it turns out that you can\nestimate the regression",
    "start": "47620",
    "end": "50710"
  },
  {
    "text": "parameters of interest,\nthese are the coefficients",
    "start": "50710",
    "end": "53050"
  },
  {
    "text": "of the x's in this\ncase, accurately, that's",
    "start": "53050",
    "end": "56170"
  },
  {
    "text": "if the model is correct, but the\nconstant term will be incorrect.",
    "start": "56170",
    "end": "60940"
  },
  {
    "text": "And then you can just go ahead\nand correct the constant term",
    "start": "60940",
    "end": "63910"
  },
  {
    "text": "by a simple transformation.",
    "start": "63910",
    "end": "65890"
  },
  {
    "text": "And in fact, for those\nthat are interested,",
    "start": "65890",
    "end": "68560"
  },
  {
    "text": "I just give you\nthe transformation.",
    "start": "68560",
    "end": "70890"
  },
  {
    "text": "So pi tilde is the apparent\nrisk of heart disease",
    "start": "70890",
    "end": "76830"
  },
  {
    "text": "in this case in our\npopulation, which is 0.35.",
    "start": "76830",
    "end": "80640"
  },
  {
    "text": "And after all, this is just\nthe logit transformation",
    "start": "80640",
    "end": "84330"
  },
  {
    "text": "of the prior probability, or\nthe prior parent probability.",
    "start": "84330",
    "end": "89850"
  },
  {
    "text": "And here's the logit\ntransformation of the true risk,",
    "start": "89850",
    "end": "93540"
  },
  {
    "text": "which is pi in this case, 0.05.",
    "start": "93540",
    "end": "96740"
  },
  {
    "text": "And so we take the loads of\ntransformation of those two,",
    "start": "96740",
    "end": "99780"
  },
  {
    "text": "and we correct the intercept,\nthis is the currently estimated",
    "start": "99780",
    "end": "102979"
  },
  {
    "text": "intercept, and we\ncorrect it by adding",
    "start": "102980",
    "end": "105320"
  },
  {
    "text": "in the log odds of\nthe true probability",
    "start": "105320",
    "end": "108270"
  },
  {
    "text": "subtract the apparent one\nthat corrects the intercept.",
    "start": "108270",
    "end": "111289"
  },
  {
    "text": "Maybe it's worth saying a little\nbit about case control sampling.",
    "start": "111290",
    "end": "115110"
  },
  {
    "text": "Why the sampling\nwas done this way.",
    "start": "115110",
    "end": "116588"
  },
  {
    "text": "One thing we could\nhave done instead,",
    "start": "116588",
    "end": "118130"
  },
  {
    "text": "or the investigators\ncould have done,",
    "start": "118130",
    "end": "119672"
  },
  {
    "text": "was to take maybe 1,000 people,\nand to follow them for 20 years,",
    "start": "119672",
    "end": "123170"
  },
  {
    "text": "and to record\ntheir risk factors,",
    "start": "123170",
    "end": "125119"
  },
  {
    "text": "and then see who\ngets heart disease.",
    "start": "125120",
    "end": "126780"
  },
  {
    "text": "And we think about 5%\nwould get heart disease.",
    "start": "126780",
    "end": "129179"
  },
  {
    "text": "And that's a valid thing to do.",
    "start": "129180",
    "end": "131129"
  },
  {
    "text": "But the problem is\nit takes 20 years,",
    "start": "131130",
    "end": "132680"
  },
  {
    "text": "and maybe more than a few\nthousand people to get enough,",
    "start": "132680",
    "end": "136310"
  },
  {
    "text": "actually, 1,000 people\nwould get, what, 50 cases.",
    "start": "136310",
    "end": "140120"
  },
  {
    "text": "So that's not very practical,\nwe need a large sample,",
    "start": "140120",
    "end": "142940"
  },
  {
    "text": "and we need many years to do it.",
    "start": "142940",
    "end": "144598"
  },
  {
    "text": "Case control sampling\nsays, well, let's not",
    "start": "144598",
    "end": "146390"
  },
  {
    "text": "do things prospectively\nlike that,",
    "start": "146390",
    "end": "148020"
  },
  {
    "text": "let's rather find people who\nwe already have heart disease,",
    "start": "148020",
    "end": "151670"
  },
  {
    "text": "or don't have heart disease,\nand then sample them.",
    "start": "151670",
    "end": "155200"
  },
  {
    "text": "And now in the\nproportion in this case,",
    "start": "155200",
    "end": "158140"
  },
  {
    "text": "we will take 160 cases\nand 302 controls,",
    "start": "158140",
    "end": "161350"
  },
  {
    "text": "and then record\ntheir risk factors.",
    "start": "161350",
    "end": "163600"
  },
  {
    "text": "So we start with\ncases and controls,",
    "start": "163600",
    "end": "166310"
  },
  {
    "text": "and we get lots of cases.",
    "start": "166310",
    "end": "167510"
  },
  {
    "text": "And we can do this\nwithout waiting 20 years,",
    "start": "167510",
    "end": "169342"
  },
  {
    "text": "we can do it right now, and\nthen we record the risk factors.",
    "start": "169343",
    "end": "172010"
  },
  {
    "text": "That's a good point, Robert.",
    "start": "172010",
    "end": "173409"
  },
  {
    "text": "And that's a very\npopular in epidemiology.",
    "start": "173410",
    "end": "177040"
  },
  {
    "text": "There are other issues involved\nwith case control sampling,",
    "start": "177040",
    "end": "181060"
  },
  {
    "text": "retrospective sampling.",
    "start": "181060",
    "end": "184270"
  },
  {
    "text": "But we won't take that\nup now, but that's",
    "start": "184270",
    "end": "186490"
  },
  {
    "text": "the reason it's so popular.",
    "start": "186490",
    "end": "188650"
  },
  {
    "text": "On the same issue, in\nmany modern data sets,",
    "start": "188650",
    "end": "194620"
  },
  {
    "text": "we'll have very\nimbalanced situations.",
    "start": "194620",
    "end": "196940"
  },
  {
    "text": "For example, if you're\nmodeling the clickthrough rate",
    "start": "196940",
    "end": "199630"
  },
  {
    "text": "on an ad on a web page, the\nprobability of someone clicking",
    "start": "199630",
    "end": "204190"
  },
  {
    "text": "is less than 1%, maybe 0.005,\nor even smaller, 0.001.",
    "start": "204190",
    "end": "210820"
  },
  {
    "text": "Which means if you just take\na random sample of subject",
    "start": "210820",
    "end": "214705"
  },
  {
    "text": "who've have been exposed to\nads, you're going to get very,",
    "start": "214705",
    "end": "217750"
  },
  {
    "text": "very few 1's and a\nhuge amount of 0's.",
    "start": "217750",
    "end": "221200"
  },
  {
    "text": "And these data sets\nget really large.",
    "start": "221200",
    "end": "224780"
  },
  {
    "text": "So the question is, do we need\nto use all of that 01 data",
    "start": "224780",
    "end": "228520"
  },
  {
    "text": "to fit the models?",
    "start": "228520",
    "end": "229760"
  },
  {
    "text": "Well, from what we've\ntold you, no, you can",
    "start": "229760",
    "end": "232030"
  },
  {
    "text": "take a sample of the controls.",
    "start": "232030",
    "end": "234250"
  },
  {
    "text": "And this picture\nover here just gives",
    "start": "234250",
    "end": "237280"
  },
  {
    "text": "an indication of the trade-off.",
    "start": "237280",
    "end": "239805"
  },
  {
    "start": "239805",
    "end": "242379"
  },
  {
    "text": "The main point is that\nultimately the variance",
    "start": "242380",
    "end": "245680"
  },
  {
    "text": "of your parameter estimates has\nto do with the number of cases",
    "start": "245680",
    "end": "249909"
  },
  {
    "text": "that you got, which\nis the smaller class.",
    "start": "249910",
    "end": "251950"
  },
  {
    "text": "And so what this\nplot shows is it's",
    "start": "251950",
    "end": "253810"
  },
  {
    "text": "showing the variance\nof the coefficients",
    "start": "253810",
    "end": "256120"
  },
  {
    "text": "as a function of the\ncase control ratio,",
    "start": "256120",
    "end": "260380"
  },
  {
    "text": "or in fact, the\ncontrol case ratio.",
    "start": "260380",
    "end": "263000"
  },
  {
    "text": "And what it says is when\nyou've got about 5 or 6 to 1,",
    "start": "263000",
    "end": "265960"
  },
  {
    "text": "the variance levels off\nhere, and so there's",
    "start": "265960",
    "end": "269919"
  },
  {
    "text": "diminishing returns in\ngetting even more controls.",
    "start": "269920",
    "end": "273380"
  },
  {
    "text": "So if you've got a\nvery sparse situation,",
    "start": "273380",
    "end": "275810"
  },
  {
    "text": "sample about five or six\ncontrols for every case,",
    "start": "275810",
    "end": "280400"
  },
  {
    "text": "and now you can work with a\nmuch more manageable data set.",
    "start": "280400",
    "end": "283710"
  },
  {
    "text": "So it's very handy, especially\nin modern, extremely large data",
    "start": "283710",
    "end": "288289"
  },
  {
    "text": "sets.",
    "start": "288290",
    "end": "289340"
  },
  {
    "text": "So just a comment about what\nthis case control sampling is,",
    "start": "289340",
    "end": "293389"
  },
  {
    "text": "the most obvious way to study\nthe risk factors for heart",
    "start": "293390",
    "end": "296000"
  },
  {
    "text": "disease would be to take\na large group of people,",
    "start": "296000",
    "end": "298370"
  },
  {
    "text": "maybe 1,000 or 100,000 people,\nfollow them for maybe 20 years,",
    "start": "298370",
    "end": "302780"
  },
  {
    "text": "record their risk factors, and\nthen see who gets heart disease",
    "start": "302780",
    "end": "305510"
  },
  {
    "text": "and who doesn't after 20 years.",
    "start": "305510",
    "end": "306920"
  },
  {
    "text": "If you're still around.",
    "start": "306920",
    "end": "307878"
  },
  {
    "start": "307878",
    "end": "308860"
  },
  {
    "text": "If we're still around.",
    "start": "308860",
    "end": "311000"
  },
  {
    "text": "Now, that actually is a\ngood way to do things,",
    "start": "311000",
    "end": "313730"
  },
  {
    "text": "except it's very expensive\nand takes a long time.",
    "start": "313730",
    "end": "316023"
  },
  {
    "text": "You have to get a lot\nof people, and you",
    "start": "316023",
    "end": "317690"
  },
  {
    "text": "have to wait for many years.",
    "start": "317690",
    "end": "319220"
  },
  {
    "text": "Case control sampling is\na lot more attractive,",
    "start": "319220",
    "end": "321710"
  },
  {
    "text": "because what you do is, rather\nthan taking people and following",
    "start": "321710",
    "end": "325490"
  },
  {
    "text": "them forward in time, you\nsample people who you know,",
    "start": "325490",
    "end": "328340"
  },
  {
    "text": "have heart disease, and\nyou also get a comparison",
    "start": "328340",
    "end": "331880"
  },
  {
    "text": "sample of people who do not have\nheart disease, the controls,",
    "start": "331880",
    "end": "334530"
  },
  {
    "text": "and then you record\ntheir risk factors.",
    "start": "334530",
    "end": "336330"
  },
  {
    "text": "So it's much cheaper and,\nagain, it's much quicker to do.",
    "start": "336330",
    "end": "338879"
  },
  {
    "text": "And that's why case control\nsampling is a very commonly",
    "start": "338880",
    "end": "341210"
  },
  {
    "text": "used technique in epidemiology.",
    "start": "341210",
    "end": "343850"
  },
  {
    "text": "What if we have more\nthan two classes,",
    "start": "343850",
    "end": "347420"
  },
  {
    "text": "can we still do\nlogistic regression?",
    "start": "347420",
    "end": "350070"
  },
  {
    "text": "Well, we can.",
    "start": "350070",
    "end": "352290"
  },
  {
    "text": "It easily generalizes to\nmore than two classes.",
    "start": "352290",
    "end": "355890"
  },
  {
    "text": "And there's various\nways of doing this.",
    "start": "355890",
    "end": "357610"
  },
  {
    "text": "And one version,\nwhich actually is",
    "start": "357610",
    "end": "360330"
  },
  {
    "text": "how we do it in the Glmnet\npackage in R, which you'll",
    "start": "360330",
    "end": "364020"
  },
  {
    "text": "be learning more about, is\nwe have this exponential form",
    "start": "364020",
    "end": "369780"
  },
  {
    "text": "that we saw before, but\nmodified for multiple classes.",
    "start": "369780",
    "end": "373780"
  },
  {
    "text": "So notice in the\nnumerator, we've",
    "start": "373780",
    "end": "375600"
  },
  {
    "text": "got an e to the linear model,\nand this is for the probability",
    "start": "375600",
    "end": "381030"
  },
  {
    "text": "that y is k, given x,\nsmall k, and we've got",
    "start": "381030",
    "end": "384600"
  },
  {
    "text": "say capital K classes where\ncapital K is bigger than 2.",
    "start": "384600",
    "end": "389580"
  },
  {
    "text": "And in the\ndenominator, we've just",
    "start": "389580",
    "end": "391800"
  },
  {
    "text": "got the sum of\nthose exponentials",
    "start": "391800",
    "end": "394620"
  },
  {
    "text": "for all the classes.",
    "start": "394620",
    "end": "396240"
  },
  {
    "text": "So in this case, each class\ngets its own linear model,",
    "start": "396240",
    "end": "401400"
  },
  {
    "text": "and then we just weigh\nthem against each other",
    "start": "401400",
    "end": "403740"
  },
  {
    "text": "with this exponential\nfunction, sometimes",
    "start": "403740",
    "end": "407190"
  },
  {
    "text": "called the softmax function.",
    "start": "407190",
    "end": "408515"
  },
  {
    "start": "408515",
    "end": "413380"
  },
  {
    "text": "The mathier students will\nrecognize that some cancelation",
    "start": "413380",
    "end": "416410"
  },
  {
    "text": "is possible in this ratio.",
    "start": "416410",
    "end": "420490"
  },
  {
    "text": "And that's true.",
    "start": "420490",
    "end": "421849"
  },
  {
    "text": "And what that means\nis actually you only",
    "start": "421850",
    "end": "424270"
  },
  {
    "text": "need k minus 1 linear\nfunctions as you",
    "start": "424270",
    "end": "428080"
  },
  {
    "text": "do in a two-class\nlogistic regression.",
    "start": "428080",
    "end": "430759"
  },
  {
    "text": "That's somewhat of a\ndetail, and it turns out",
    "start": "430760",
    "end": "433090"
  },
  {
    "text": "for our glmnet application,\nthis is a more symmetric",
    "start": "433090",
    "end": "436930"
  },
  {
    "text": "representation, and it's\nactually more useful.",
    "start": "436930",
    "end": "439634"
  },
  {
    "start": "439635",
    "end": "442440"
  },
  {
    "text": "This multi-class\nlogistic regression",
    "start": "442440",
    "end": "444270"
  },
  {
    "text": "is also referred to as\nmultinomial regression.",
    "start": "444270",
    "end": "448310"
  },
  {
    "start": "448310",
    "end": "449000"
  }
]