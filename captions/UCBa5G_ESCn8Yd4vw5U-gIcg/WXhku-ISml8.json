[
  {
    "start": "0",
    "end": "750"
  },
  {
    "text": "OK, well, welcome back.",
    "start": "750",
    "end": "2580"
  },
  {
    "text": "We're going to have\na R session now.",
    "start": "2580",
    "end": "4720"
  },
  {
    "text": "And once again,\nwe'll use RStudio,",
    "start": "4720",
    "end": "7290"
  },
  {
    "text": "which is a very convenient\nplatform for running R",
    "start": "7290",
    "end": "11820"
  },
  {
    "text": "and for demonstrating R. So\nwe'll go to our screen now",
    "start": "11820",
    "end": "17039"
  },
  {
    "text": "and we'll do an RStudio session\non linear discriminant analysis,",
    "start": "17040",
    "end": "21030"
  },
  {
    "text": "first of all, and then\nfollowed by nearest neighbor,",
    "start": "21030",
    "end": "24450"
  },
  {
    "text": "classification.",
    "start": "24450",
    "end": "26700"
  },
  {
    "text": "So here we are in our,\nRStudio session window.",
    "start": "26700",
    "end": "33790"
  },
  {
    "text": "And the first thing\nwe do is we require",
    "start": "33790",
    "end": "36310"
  },
  {
    "text": "ISLR, that's our package\nwith some of our data sets.",
    "start": "36310",
    "end": "40230"
  },
  {
    "text": "So I hit the Control\nbutton and Return,",
    "start": "40230",
    "end": "42930"
  },
  {
    "text": "and it loads the package.",
    "start": "42930",
    "end": "44470"
  },
  {
    "text": "And then we require\nthe mass package,",
    "start": "44470",
    "end": "48540"
  },
  {
    "text": "which is Venables and Ripley's\npackage of useful functions,",
    "start": "48540",
    "end": "53460"
  },
  {
    "text": "including the function for doing\nlinear discriminant analysis.",
    "start": "53460",
    "end": "57180"
  },
  {
    "text": "You'll see in the\nright-hand panel",
    "start": "57180",
    "end": "58620"
  },
  {
    "text": "I've got a help file for\nlinear discriminant analysis.",
    "start": "58620",
    "end": "61860"
  },
  {
    "text": "So as always in R,\nif you don't know",
    "start": "61860",
    "end": "65099"
  },
  {
    "text": "or you're not too familiar with\nthe new procedure, you do help.",
    "start": "65099",
    "end": "67950"
  },
  {
    "text": "And make sure you understand\nthe syntax, and all the options,",
    "start": "67950",
    "end": "71439"
  },
  {
    "text": "and so on.",
    "start": "71440",
    "end": "72630"
  },
  {
    "text": "So the first thing we do, we're\ngoing to use the stock market",
    "start": "72630",
    "end": "77340"
  },
  {
    "text": "data here.",
    "start": "77340",
    "end": "78399"
  },
  {
    "text": "And the response is going to be\nthe direction that the market",
    "start": "78400",
    "end": "84060"
  },
  {
    "text": "took on a particular day.",
    "start": "84060",
    "end": "86290"
  },
  {
    "text": "And we're going to use the\nreturns on the previous two days",
    "start": "86290",
    "end": "90090"
  },
  {
    "text": "to try and predict the direction\non this particular day.",
    "start": "90090",
    "end": "94539"
  },
  {
    "text": "OK, and so there, we use\na command, lda.fit, and it",
    "start": "94540",
    "end": "99220"
  },
  {
    "text": "takes a formula.",
    "start": "99220",
    "end": "100400"
  },
  {
    "text": "So the response is direction,\nthey are the two predictors,",
    "start": "100400",
    "end": "103930"
  },
  {
    "text": "it's telling you the data comes\nfrom S market, stock market.",
    "start": "103930",
    "end": "108580"
  },
  {
    "text": "And we're going to use\nthe subset, which is years",
    "start": "108580",
    "end": "113380"
  },
  {
    "text": "less than 2005, because later on\nwe're going to make predictions",
    "start": "113380",
    "end": "118060"
  },
  {
    "text": "for year 2005.",
    "start": "118060",
    "end": "119829"
  },
  {
    "text": "So you can put that\ndirectly in the formula,",
    "start": "119830",
    "end": "122570"
  },
  {
    "text": "subset equals year\nless than 2005.",
    "start": "122570",
    "end": "125930"
  },
  {
    "text": "And this variable\nyear, of course,",
    "start": "125930",
    "end": "127780"
  },
  {
    "text": "is referenced in S\nmarket as well as",
    "start": "127780",
    "end": "130060"
  },
  {
    "text": "these variables over here.",
    "start": "130060",
    "end": "131680"
  },
  {
    "text": "OK, so off we go and we fit it.",
    "start": "131680",
    "end": "134260"
  },
  {
    "text": "And it fits it so very\nquickly, and we print it",
    "start": "134260",
    "end": "138430"
  },
  {
    "text": "by just typing its name.",
    "start": "138430",
    "end": "140150"
  },
  {
    "text": "And there's a little\nsummary printed below here.",
    "start": "140150",
    "end": "143290"
  },
  {
    "text": "And you see, typically\nyou get the formula",
    "start": "143290",
    "end": "146319"
  },
  {
    "text": "that was used to create it.",
    "start": "146320",
    "end": "147950"
  },
  {
    "text": "And then it gives a summary\nof the linear discriminant",
    "start": "147950",
    "end": "150459"
  },
  {
    "text": "analysis.",
    "start": "150460",
    "end": "151430"
  },
  {
    "text": "So the prior\nprobabilities are just",
    "start": "151430",
    "end": "153609"
  },
  {
    "text": "the proportions of ups\nand downs in the data set,",
    "start": "153610",
    "end": "156190"
  },
  {
    "text": "it's roughly 50%, which says\nsomething about the market.",
    "start": "156190",
    "end": "161680"
  },
  {
    "text": "It's kind of a random walk.",
    "start": "161680",
    "end": "164170"
  },
  {
    "text": "Half the time it goes up,\nhalf the time it goes down.",
    "start": "164170",
    "end": "168180"
  },
  {
    "text": "It summarizes the group\nmeans for the two groups,",
    "start": "168180",
    "end": "171760"
  },
  {
    "text": "for the downs and\nthe ups. It looks",
    "start": "171760",
    "end": "174030"
  },
  {
    "text": "like there may be a slight\ndifference in these two groups,",
    "start": "174030",
    "end": "178870"
  },
  {
    "text": "the means seem to be\nseparated a little bit,",
    "start": "178870",
    "end": "182640"
  },
  {
    "text": "and then it gives\nthe LDA coefficients.",
    "start": "182640",
    "end": "185050"
  },
  {
    "text": "So if you remember,\nthe LDA function",
    "start": "185050",
    "end": "186930"
  },
  {
    "text": "fits a linear function for\nseparating the two groups.",
    "start": "186930",
    "end": "191150"
  },
  {
    "text": "And so it's got\ntwo coefficients.",
    "start": "191150",
    "end": "194129"
  },
  {
    "text": "OK, well, there's some\nmethods that work for LDA.",
    "start": "194130",
    "end": "198400"
  },
  {
    "text": "For example, you can plot a\nlda.fit, which we'll do here,",
    "start": "198400",
    "end": "201840"
  },
  {
    "text": "and it gives a very\nconvenient plot.",
    "start": "201840",
    "end": "205129"
  },
  {
    "text": "It plots the values of\nthe linear discriminant",
    "start": "205130",
    "end": "210570"
  },
  {
    "text": "function separately for the\nup group and the down group.",
    "start": "210570",
    "end": "214930"
  },
  {
    "text": "And when we look at\nthis, it looks to the eye",
    "start": "214930",
    "end": "217793"
  },
  {
    "text": "like there's really\nnot much difference.",
    "start": "217793",
    "end": "219460"
  },
  {
    "text": "Those two histograms\nlook pretty much on top",
    "start": "219460",
    "end": "221440"
  },
  {
    "text": "of each other, which, of\ncourse, is not a big surprise,",
    "start": "221440",
    "end": "225220"
  },
  {
    "text": "because if we could\nvery easily, like this,",
    "start": "225220",
    "end": "227530"
  },
  {
    "text": "predict the movement\nof the stock market,",
    "start": "227530",
    "end": "229660"
  },
  {
    "text": "we'd be making lots of money\nand we wouldn't be sitting here",
    "start": "229660",
    "end": "232210"
  },
  {
    "text": "giving our demonstrations.",
    "start": "232210",
    "end": "235090"
  },
  {
    "text": "So now, we're going to see\nhow well our rule predicts",
    "start": "235090",
    "end": "238629"
  },
  {
    "text": "on the year 2005.",
    "start": "238630",
    "end": "241330"
  },
  {
    "text": "OK, so I'm doing this in\na slightly different way",
    "start": "241330",
    "end": "245360"
  },
  {
    "text": "as to what was\ndescribed in the book.",
    "start": "245360",
    "end": "249960"
  },
  {
    "text": "We first of all, make a subset\nof the data frame, S market,",
    "start": "249960",
    "end": "254100"
  },
  {
    "text": "and we'll call\nit's Smarket.2005,",
    "start": "254100",
    "end": "257609"
  },
  {
    "text": "and we use a command in R, a\nuseful command, called subset.",
    "start": "257610",
    "end": "261569"
  },
  {
    "text": "And so the first argument\nis the data frame",
    "start": "261570",
    "end": "264150"
  },
  {
    "text": "that you're going to\nsubset, which is S market,",
    "start": "264150",
    "end": "266710"
  },
  {
    "text": "and then following that are\nsome logical expressions that",
    "start": "266710",
    "end": "271360"
  },
  {
    "text": "can use variables in that data\nframe to define the subset.",
    "start": "271360",
    "end": "274729"
  },
  {
    "text": "And so here, it is year\nequals equals 2005.",
    "start": "274730",
    "end": "278620"
  },
  {
    "text": "OK, and that will create a\ndata frame with just the year",
    "start": "278620",
    "end": "283180"
  },
  {
    "text": "2005 observations.",
    "start": "283180",
    "end": "286060"
  },
  {
    "text": "OK, and so now we can use that\nas the test data or the place",
    "start": "286060",
    "end": "291730"
  },
  {
    "text": "where we want to\nmake our predictions.",
    "start": "291730",
    "end": "293570"
  },
  {
    "text": "So we call the predict\nmethod for an lda.fit",
    "start": "293570",
    "end": "301450"
  },
  {
    "text": "and we give it our fit and\nwe give it this new data",
    "start": "301450",
    "end": "304750"
  },
  {
    "text": "frame, Smarket.2005, and it will\nproduce some predictions for us.",
    "start": "304750",
    "end": "310790"
  },
  {
    "text": "And let's just print the\nfirst five of these and--",
    "start": "310790",
    "end": "314290"
  },
  {
    "text": "oops, it didn't like that.",
    "start": "314290",
    "end": "315920"
  },
  {
    "text": "So I was assuming it was in a\nmatrix format, and it's not.",
    "start": "315920",
    "end": "322150"
  },
  {
    "text": "So what format is it?",
    "start": "322150",
    "end": "323810"
  },
  {
    "text": "So we don't throw up\nour hands and run away",
    "start": "323810",
    "end": "326660"
  },
  {
    "text": "when we get an error,\nwe just investigate.",
    "start": "326660",
    "end": "329420"
  },
  {
    "text": "So let's look at the\nclass of lda.pred.",
    "start": "329420",
    "end": "332630"
  },
  {
    "text": "Well, it's a list.",
    "start": "332630",
    "end": "335320"
  },
  {
    "text": "Now, I happen to know\nwhat kind of list it is.",
    "start": "335320",
    "end": "338080"
  },
  {
    "text": "And when you have\na list of variables",
    "start": "338080",
    "end": "340750"
  },
  {
    "text": "and each of the variables have\nthe same number of observations,",
    "start": "340750",
    "end": "345220"
  },
  {
    "text": "the convenient way of\nlooking at such a list",
    "start": "345220",
    "end": "347570"
  },
  {
    "text": "is through data frame.",
    "start": "347570",
    "end": "349190"
  },
  {
    "text": "And so we can do data\nframe of lda.pred",
    "start": "349190",
    "end": "353420"
  },
  {
    "text": "and then look at the first five\nrows, and this is what we get.",
    "start": "353420",
    "end": "358950"
  },
  {
    "text": "And you'll see what\nit gives is it gives",
    "start": "358950",
    "end": "363080"
  },
  {
    "text": "a row name, it gives\nthe classification,",
    "start": "363080",
    "end": "366979"
  },
  {
    "text": "the first five are all up.",
    "start": "366980",
    "end": "368260"
  },
  {
    "start": "368260",
    "end": "371330"
  },
  {
    "text": "One of the components\nof the list",
    "start": "371330",
    "end": "372800"
  },
  {
    "text": "was a matrix of posterior\nprobabilities, which",
    "start": "372800",
    "end": "375259"
  },
  {
    "text": "had actually a\ntwo-column matrix,",
    "start": "375260",
    "end": "376790"
  },
  {
    "text": "but data frame is smart enough\nto understand that these",
    "start": "376790",
    "end": "382730"
  },
  {
    "text": "can fit into the data frame.",
    "start": "382730",
    "end": "384420"
  },
  {
    "text": "And so it makes two columns,\none for up and one for down,",
    "start": "384420",
    "end": "388820"
  },
  {
    "text": "the posterior\nprobabilities, and then",
    "start": "388820",
    "end": "390950"
  },
  {
    "text": "there's the actual values\nof the LDA score, OK.",
    "start": "390950",
    "end": "395240"
  },
  {
    "text": "And so now we realize\nthat the output of pred",
    "start": "395240",
    "end": "401690"
  },
  {
    "text": "has these different components.",
    "start": "401690",
    "end": "403432"
  },
  {
    "text": "The thing we're really\ninterested in here",
    "start": "403432",
    "end": "405140"
  },
  {
    "text": "is the classification,\nso that's class.",
    "start": "405140",
    "end": "407610"
  },
  {
    "text": "So we're going to do a table\nof lda.pred dollar class,",
    "start": "407610",
    "end": "411960"
  },
  {
    "text": "that's the true class\nlabel for the 2005,",
    "start": "411960",
    "end": "414560"
  },
  {
    "text": "versus the prediction--",
    "start": "414560",
    "end": "418030"
  },
  {
    "text": "sorry that is the prediction,\nversus the true value.",
    "start": "418030",
    "end": "421940"
  },
  {
    "text": "So this is the predicted class\nand this is the true value",
    "start": "421940",
    "end": "424900"
  },
  {
    "text": "over here in the data frame.",
    "start": "424900",
    "end": "427009"
  },
  {
    "text": "We'll do a table of that.",
    "start": "427010",
    "end": "429420"
  },
  {
    "text": "And we get the little\nconfusion matrix,",
    "start": "429420",
    "end": "431970"
  },
  {
    "text": "which tells us which downs\nwe're classified as down,",
    "start": "431970",
    "end": "434880"
  },
  {
    "text": "and which downs were classified\nas up, and so on, OK.",
    "start": "434880",
    "end": "438340"
  },
  {
    "text": "And It's the off\ndiagonal elements",
    "start": "438340",
    "end": "440820"
  },
  {
    "text": "of those that are the mistakes\nand the diagonal elements which",
    "start": "440820",
    "end": "445260"
  },
  {
    "text": "are the correct classifications.",
    "start": "445260",
    "end": "447400"
  },
  {
    "text": "And so one simple command tells\nus our correct classification",
    "start": "447400",
    "end": "452220"
  },
  {
    "text": "rate, which is we've\ngot a conditional year,",
    "start": "452220",
    "end": "455580"
  },
  {
    "text": "which is the predicted class\nis equal to the true class.",
    "start": "455580",
    "end": "459629"
  },
  {
    "text": "So that will be true\nif they're equal",
    "start": "459630",
    "end": "462700"
  },
  {
    "text": "and it'll be false\nif they're not.",
    "start": "462700",
    "end": "464320"
  },
  {
    "text": "And since trues and falses can\nbe coerced to be zeros and ones,",
    "start": "464320",
    "end": "470130"
  },
  {
    "text": "we can just take\nthe mean of that",
    "start": "470130",
    "end": "471720"
  },
  {
    "text": "and it'll give us our correct\nclassification rate, which",
    "start": "471720",
    "end": "476380"
  },
  {
    "text": "in this case is about 0.56.",
    "start": "476380",
    "end": "479020"
  },
  {
    "text": "So it's not huge.",
    "start": "479020",
    "end": "480410"
  },
  {
    "text": "But again, in this\nkind of industry,",
    "start": "480410",
    "end": "483610"
  },
  {
    "text": "any little edge like\nthat actually helps.",
    "start": "483610",
    "end": "488620"
  },
  {
    "text": "So that's a little session using\nlinear discriminant analysis.",
    "start": "488620",
    "end": "494889"
  },
  {
    "text": "And there's many\nother approaches.",
    "start": "494890",
    "end": "497040"
  },
  {
    "text": "There's some more\nexamples in the book,",
    "start": "497040",
    "end": "499780"
  },
  {
    "text": "and you should\nhave a look there.",
    "start": "499780",
    "end": "502320"
  },
  {
    "start": "502320",
    "end": "503000"
  }
]