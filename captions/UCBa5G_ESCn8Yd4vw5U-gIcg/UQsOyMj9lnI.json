[
  {
    "text": "We're now gonna look at a method for approximately",
    "start": "4400",
    "end": "8430"
  },
  {
    "text": "or heuristically solving the nonlinear least squares problem.",
    "start": "8430",
    "end": "11985"
  },
  {
    "text": "There's actually many methods that can be used.",
    "start": "11985",
    "end": "14264"
  },
  {
    "text": "So that's a whole world by itself.",
    "start": "14265",
    "end": "15930"
  },
  {
    "text": "You can take whole courses on- on this.",
    "start": "15930",
    "end": "18180"
  },
  {
    "text": "And we're gonna look at one, it's called Levenberg-Marquardt.",
    "start": "18180",
    "end": "21045"
  },
  {
    "text": "Uh, we're- we actually look at this one for a couple of reasons.",
    "start": "21045",
    "end": "25110"
  },
  {
    "text": "Number 1, it works extremely well in practice, and number 2,",
    "start": "25110",
    "end": "27720"
  },
  {
    "text": "it uses actually ideas that come immediately from this book and course.",
    "start": "27720",
    "end": "33300"
  },
  {
    "text": "So all the idea should be utterly clear.",
    "start": "33300",
    "end": "35595"
  },
  {
    "text": "Okay. So here's the basic idea and it's a- it's a very general one in applied math.",
    "start": "35595",
    "end": "42390"
  },
  {
    "text": "So what we're gonna do is we want to minimize this, something like that.",
    "start": "42390",
    "end": "49875"
  },
  {
    "text": "Okay. So, um, now,",
    "start": "49875",
    "end": "52440"
  },
  {
    "text": "if f here were affine,",
    "start": "52440",
    "end": "54719"
  },
  {
    "text": "we would know how to do that.",
    "start": "54720",
    "end": "56235"
  },
  {
    "text": "That's least squares.",
    "start": "56235",
    "end": "57360"
  },
  {
    "text": "We would spend- we just spend,",
    "start": "57360",
    "end": "59025"
  },
  {
    "text": "uh, what- we spend a lot of time on that.",
    "start": "59025",
    "end": "61125"
  },
  {
    "text": "There would be a backslash involved in your code.",
    "start": "61125",
    "end": "63405"
  },
  {
    "text": "Okay? So- so if f were affine,",
    "start": "63405",
    "end": "66284"
  },
  {
    "text": "we can solve the least squares problem, but f is not affine.",
    "start": "66285",
    "end": "68805"
  },
  {
    "text": "So what we're gonna do is we're going to do this.",
    "start": "68805",
    "end": "71780"
  },
  {
    "text": "We are going to form an affine approximation of f near the current point.",
    "start": "71780",
    "end": "77180"
  },
  {
    "text": "I should say this is an iterative method, right?",
    "start": "77180",
    "end": "79550"
  },
  {
    "text": "So we're gonna iterate.",
    "start": "79550",
    "end": "81080"
  },
  {
    "text": "We're gonna take a point,",
    "start": "81080",
    "end": "82700"
  },
  {
    "text": "you know, then, uh,",
    "start": "82700",
    "end": "84229"
  },
  {
    "text": "maybe get an- get a better point,",
    "start": "84230",
    "end": "86300"
  },
  {
    "text": "and keep going until we're not making progress.",
    "start": "86300",
    "end": "89045"
  },
  {
    "text": "Okay. So okay.",
    "start": "89045",
    "end": "91125"
  },
  {
    "text": "Um, so we're going to form an affine approximation.",
    "start": "91125",
    "end": "93390"
  },
  {
    "text": "Now, how do you form an affine approximation of a function?",
    "start": "93390",
    "end": "95765"
  },
  {
    "text": "Well, that's what differential calculus is literally. That is what it is.",
    "start": "95765",
    "end": "99680"
  },
  {
    "text": "I mean, it's- it's a way for- it's a way to,",
    "start": "99680",
    "end": "101860"
  },
  {
    "text": "in an organized way to, uh,",
    "start": "101860",
    "end": "104355"
  },
  {
    "text": "go ahead- to get an affine approximation of",
    "start": "104355",
    "end": "107150"
  },
  {
    "text": "a function that's really accurate near- near a given point.",
    "start": "107150",
    "end": "110260"
  },
  {
    "text": "Okay. And that's the first-order Taylor approximation or affine approximation.",
    "start": "110260",
    "end": "114830"
  },
  {
    "text": "So we're gonna write f hat of x at z.",
    "start": "114830",
    "end": "118970"
  },
  {
    "text": "So the semi-colon means that the second argument is special.",
    "start": "118970",
    "end": "122150"
  },
  {
    "text": "It's not special, it just means it's hat,",
    "start": "122150",
    "end": "124010"
  },
  {
    "text": "and it's read f hat at z or f hat near z.",
    "start": "124010",
    "end": "127085"
  },
  {
    "text": "That's another thing you'd hear people say.",
    "start": "127085",
    "end": "128740"
  },
  {
    "text": "Okay. And that's equal to f of z,",
    "start": "128740",
    "end": "131295"
  },
  {
    "text": "the value at that point, plus,",
    "start": "131295",
    "end": "133319"
  },
  {
    "text": "and then the- this is the deviation,",
    "start": "133320",
    "end": "135210"
  },
  {
    "text": "the vector deviation from z multiplied by the,",
    "start": "135210",
    "end": "139415"
  },
  {
    "text": "um, the derivative matrix.",
    "start": "139415",
    "end": "141715"
  },
  {
    "text": "That's the Jacobian or the matrix of partial derivatives.",
    "start": "141715",
    "end": "144890"
  },
  {
    "text": "So that's it. Um, makes perfect sense,",
    "start": "144890",
    "end": "147890"
  },
  {
    "text": "it's the first-order Taylor expansion. That's it.",
    "start": "147890",
    "end": "150155"
  },
  {
    "text": "Okay. Now, the idea behind this is that f hat is- of x is extremely close to f of x,",
    "start": "150155",
    "end": "159060"
  },
  {
    "text": "provided x is near z.",
    "start": "159060",
    "end": "160935"
  },
  {
    "text": "When x is not near z, all bets are off.",
    "start": "160935",
    "end": "163905"
  },
  {
    "text": "Okay. And in fact, that's kind of the definition of the derivative in- in a sense, right?",
    "start": "163905",
    "end": "169295"
  },
  {
    "text": "Um, okay.",
    "start": "169295",
    "end": "171120"
  },
  {
    "text": "So just bear that in mind,",
    "start": "171120",
    "end": "172860"
  },
  {
    "text": "that f hat a little- I'll put it another",
    "start": "172860",
    "end": "175320"
  },
  {
    "text": "way just to- which is going to come up momentarily.",
    "start": "175320",
    "end": "178230"
  },
  {
    "text": "Um, f hat- you shouldn't trust f hat of x semicolon z if x is too far from z.",
    "start": "178230",
    "end": "188310"
  },
  {
    "text": "Okay. You shouldn't trust it because the approximation may not be good.",
    "start": "188310",
    "end": "192525"
  },
  {
    "text": "Okay. So that's kind of the- that's the idea there.",
    "start": "192525",
    "end": "196275"
  },
  {
    "text": "Makes perfect sense, and that's actually",
    "start": "196275",
    "end": "197900"
  },
  {
    "text": "the technical term we'll see later is used is trust.",
    "start": "197900",
    "end": "200845"
  },
  {
    "text": "Do I trust my approximation?",
    "start": "200845",
    "end": "202815"
  },
  {
    "text": "If x is close to z, we really- we can definitely trust it.",
    "start": "202815",
    "end": "205725"
  },
  {
    "text": "Now one minor problem is that calculus is vague on that.",
    "start": "205725",
    "end": "208390"
  },
  {
    "text": "And what calculus says is when x is near z,",
    "start": "208390",
    "end": "212220"
  },
  {
    "text": "and when you ask the crucial question, how near?",
    "start": "212220",
    "end": "214800"
  },
  {
    "text": "They're like, \"I don't know,\" like near enough.",
    "start": "214800",
    "end": "217545"
  },
  {
    "text": "And they use the concept of a limit.",
    "start": "217545",
    "end": "219194"
  },
  {
    "text": "They say that yes, it becomes extremely accurate in the limit of x going to z. Um,",
    "start": "219195",
    "end": "223860"
  },
  {
    "text": "to be honest, in a practical setting,",
    "start": "223860",
    "end": "225300"
  },
  {
    "text": "that doesn't help us in the slightest,",
    "start": "225300",
    "end": "226560"
  },
  {
    "text": "but whatever, we- we'll get around that as well.",
    "start": "226560",
    "end": "229155"
  },
  {
    "text": "Okay. Now, we're gonna do- now,",
    "start": "229155",
    "end": "232200"
  },
  {
    "text": "we're gonna come to the idea,",
    "start": "232200",
    "end": "233700"
  },
  {
    "text": "and the idea is, you know,",
    "start": "233700",
    "end": "235275"
  },
  {
    "text": "you don't know how to solve- how to minimize norm squared of f of x.",
    "start": "235275",
    "end": "239224"
  },
  {
    "text": "That's your problem. Um, so what we'll do is we're gonna replace f with an approximation,",
    "start": "239225",
    "end": "243650"
  },
  {
    "text": "f hat, which is affine.",
    "start": "243650",
    "end": "244939"
  },
  {
    "text": "And we do know how to minimize the norm squared of an affine function,",
    "start": "244940",
    "end": "249095"
  },
  {
    "text": "that's called least- linearly squares in this context,",
    "start": "249095",
    "end": "251600"
  },
  {
    "text": "but outside this context you just call it least squares.",
    "start": "251600",
    "end": "254680"
  },
  {
    "text": "Okay. Oh, and by the way,",
    "start": "254680",
    "end": "255989"
  },
  {
    "text": "that sub-problem, we can solve exactly.",
    "start": "255990",
    "end": "258375"
  },
  {
    "text": "That's completely non-heuristic, right?",
    "start": "258375",
    "end": "260250"
  },
  {
    "text": "I didn't have to say it earlier in the course when we were talking about",
    "start": "260250",
    "end": "262220"
  },
  {
    "text": "QR factorization and blah, blah, blah.",
    "start": "262220",
    "end": "264670"
  },
  {
    "text": "We're actually finding the exact solution.",
    "start": "264670",
    "end": "268095"
  },
  {
    "text": "These are not your- these are- none of those were heuristic algorithms.",
    "start": "268095",
    "end": "270705"
  },
  {
    "text": "We found the- we found the exact solution.",
    "start": "270705",
    "end": "272595"
  },
  {
    "text": "Okay? So, um- so this is the idea,",
    "start": "272595",
    "end": "276585"
  },
  {
    "text": "is you will form an",
    "start": "276585",
    "end": "278220"
  },
  {
    "text": "an approx- you'll- you- you- you can't solve the problem that you need to solve,",
    "start": "278220",
    "end": "281680"
  },
  {
    "text": "so you approximate the problem essentially by",
    "start": "281680",
    "end": "284960"
  },
  {
    "text": "linearizing the function and then minimizing that or something like that.",
    "start": "284960",
    "end": "288875"
  },
  {
    "text": "Um, and then we're going to iterate,",
    "start": "288875",
    "end": "291180"
  },
  {
    "text": "that- that's- that's the idea.",
    "start": "291180",
    "end": "292755"
  },
  {
    "text": "Um, now, there's another objective in this which I haven't said.",
    "start": "292755",
    "end": "295715"
  },
  {
    "text": "I mean, although it's kind of implicit here,",
    "start": "295715",
    "end": "297500"
  },
  {
    "text": "and it's this: that you would like this thing to be small,",
    "start": "297500",
    "end": "301280"
  },
  {
    "text": "but you also want X to be near z,",
    "start": "301280",
    "end": "303125"
  },
  {
    "text": "and that's- that's a question of trust, right?",
    "start": "303125",
    "end": "305750"
  },
  {
    "text": "So like if you- if x deviates too far from z,",
    "start": "305750",
    "end": "309380"
  },
  {
    "text": "then the approximation may not be good.",
    "start": "309380",
    "end": "312100"
  },
  {
    "text": "Okay. So here's the Levenberg-Marquardt algorithm.",
    "start": "312100",
    "end": "315900"
  },
  {
    "text": "It combines these ideas.",
    "start": "315900",
    "end": "317205"
  },
  {
    "text": "Um, and it combine- it's just ideas from the course. Here it is.",
    "start": "317205",
    "end": "320414"
  },
  {
    "text": "Um, it has iterates x_1, x_2, x_3,",
    "start": "320415",
    "end": "323280"
  },
  {
    "text": "so this superscript describes the iterates, right?",
    "start": "323280",
    "end": "326790"
  },
  {
    "text": "Um, it's an iterative algorithm in the sense that it-",
    "start": "326790",
    "end": "329060"
  },
  {
    "text": "it- it produces a sequence of these.",
    "start": "329060",
    "end": "331580"
  },
  {
    "text": "Okay. Now an iteration k, here's what we do.",
    "start": "331580",
    "end": "335414"
  },
  {
    "text": "Um, we first form the affine approximation of f at- at the current point, right?",
    "start": "335415",
    "end": "340940"
  },
  {
    "text": "So the current point is sort of like our best guess now,",
    "start": "340940",
    "end": "344050"
  },
  {
    "text": "if k is- if the iteration k is now.",
    "start": "344050",
    "end": "346365"
  },
  {
    "text": "It's our best guess now of what the solution is",
    "start": "346365",
    "end": "349039"
  },
  {
    "text": "or an approximation of the solution or something like that.",
    "start": "349040",
    "end": "351815"
  },
  {
    "text": "So we have f hat.",
    "start": "351815",
    "end": "353555"
  },
  {
    "text": "We- we formed this- this approximation, that's f hat.",
    "start": "353555",
    "end": "356455"
  },
  {
    "text": "And now what we're gonna do is this,",
    "start": "356455",
    "end": "358169"
  },
  {
    "text": "and it's- it makes perfect sense.",
    "start": "358170",
    "end": "360570"
  },
  {
    "text": "We are gonna minimize, uh,",
    "start": "360570",
    "end": "363420"
  },
  {
    "text": "well, the norm squared of the approximation, okay?",
    "start": "363420",
    "end": "367425"
  },
  {
    "text": "Um, but we're going to add a secondary objective,",
    "start": "367425",
    "end": "369909"
  },
  {
    "text": "and the secondary objective is super interesting.",
    "start": "369910",
    "end": "372125"
  },
  {
    "text": "It says, please make this small,",
    "start": "372125",
    "end": "374740"
  },
  {
    "text": "while at the same time,",
    "start": "374740",
    "end": "377324"
  },
  {
    "text": "please don't be too far from my current x_k.",
    "start": "377325",
    "end": "380625"
  },
  {
    "text": "Um, now, the idea there is very simple,",
    "start": "380625",
    "end": "384960"
  },
  {
    "text": "that the closer you are to x_k,",
    "start": "384960",
    "end": "387465"
  },
  {
    "text": "the more we trust this approximation.",
    "start": "387465",
    "end": "390840"
  },
  {
    "text": "Trust the approximation simply means that f hat is close to f. It doesn't do you any good",
    "start": "390840",
    "end": "395600"
  },
  {
    "text": "to minimize f hat if f hat and f are completely wildly different,",
    "start": "395600",
    "end": "400805"
  },
  {
    "text": "uh, it doesn't make any difference.",
    "start": "400805",
    "end": "402199"
  },
  {
    "text": "It doesn't make any sense at all. So that's the idea.",
    "start": "402200",
    "end": "404995"
  },
  {
    "text": "Um, and- um, so lambda actually",
    "start": "404995",
    "end": "409650"
  },
  {
    "text": "is- is sometimes referred to lambda_k because it's going to vary with step size.",
    "start": "409650",
    "end": "414245"
  },
  {
    "text": "Um, that's something that tells you how far- you know,",
    "start": "414245",
    "end": "418695"
  },
  {
    "text": "when you- you trade off the two objectives, right?",
    "start": "418695",
    "end": "420690"
  },
  {
    "text": "You wanna- you wanna minimize the norm squared of the affine approximation, number 1.",
    "start": "420690",
    "end": "427750"
  },
  {
    "text": "But number 2, you don't wanna go too far from where x_k is.",
    "start": "427750",
    "end": "430725"
  },
  {
    "text": "Not because you don't think the solution is far away.",
    "start": "430725",
    "end": "433250"
  },
  {
    "text": "It could be far away. But that's a- that's a question of trust.",
    "start": "433250",
    "end": "436250"
  },
  {
    "text": "Okay. And lambda_k essentially gives you your level of distrust, um,",
    "start": "436250",
    "end": "441525"
  },
  {
    "text": "in the following sense,",
    "start": "441525",
    "end": "443310"
  },
  {
    "text": "that if lambda is super big,",
    "start": "443310",
    "end": "445350"
  },
  {
    "text": "then when you solve this,",
    "start": "445350",
    "end": "446820"
  },
  {
    "text": "it- you're gonna get a point that's very near x_k.",
    "start": "446820",
    "end": "449280"
  },
  {
    "text": "And that means that you don't trust the model very much at all.",
    "start": "449280",
    "end": "452110"
  },
  {
    "text": "Or you trust it, but only if you're very close to x_k.",
    "start": "452110",
    "end": "454435"
  },
  {
    "text": "When lambda gets really small,",
    "start": "454435",
    "end": "456825"
  },
  {
    "text": "that means you really trust your model.",
    "start": "456825",
    "end": "458520"
  },
  {
    "text": "Uh, that's what it means.",
    "start": "458520",
    "end": "459720"
  },
  {
    "text": "And you're gonna find that x_k is going- x is going to be very far from x_k.",
    "start": "459720",
    "end": "463110"
  },
  {
    "text": "Okay. So this is the idea. That's the whole thing.",
    "start": "463110",
    "end": "467789"
  },
  {
    "text": "This is- this is the Levenberg-Marquardt algorithm.",
    "start": "467790",
    "end": "470145"
  },
  {
    "text": "Oh, I haven't told you how to update this lambda yet, but we'll get to that.",
    "start": "470145",
    "end": "476215"
  },
  {
    "text": "Okay. So x_k plus 1 is a solution of a least squares problem,",
    "start": "476215",
    "end": "482930"
  },
  {
    "text": "and in fact, it's a- if you like to say it's",
    "start": "482930",
    "end": "485479"
  },
  {
    "text": "a bi-criteria or bi-objective least-squares problem.",
    "start": "485480",
    "end": "489125"
  },
  {
    "text": "We have a primary objective,",
    "start": "489125",
    "end": "490894"
  },
  {
    "text": "and we have a secondary one.",
    "start": "490894",
    "end": "492685"
  },
  {
    "text": "And we can solve that.",
    "start": "492685",
    "end": "494355"
  },
  {
    "text": "That's- that's- just analytically and you get the solution as this thing.",
    "start": "494355",
    "end": "498325"
  },
  {
    "text": "Is- is this.",
    "start": "498325",
    "end": "499935"
  },
  {
    "text": "And you'll actually recognize this part as the general solution",
    "start": "499935",
    "end": "504889"
  },
  {
    "text": "to a bi-criterion or bi-objective",
    "start": "504890",
    "end": "507020"
  },
  {
    "text": "least squares problem that we solved when we studied that chapter.",
    "start": "507020",
    "end": "510520"
  },
  {
    "text": "Okay. So a couple of things to mention about it.",
    "start": "510520",
    "end": "514685"
  },
  {
    "text": "The solution always exists.",
    "start": "514685",
    "end": "518659"
  },
  {
    "text": "In other words, this thing- I'm sorry,",
    "start": "518660",
    "end": "521190"
  },
  {
    "text": "the inverse always exists,",
    "start": "521190",
    "end": "522240"
  },
  {
    "text": "so you can always solve the set of equations.",
    "start": "522240",
    "end": "524435"
  },
  {
    "text": "This thing is invertible,",
    "start": "524435",
    "end": "526309"
  },
  {
    "text": "um, so that's nice.",
    "start": "526309",
    "end": "528155"
  },
  {
    "text": "It doesn't matter or a Df or anything like that,",
    "start": "528155",
    "end": "530270"
  },
  {
    "text": "it just- it just- it's just invertible, period.",
    "start": "530270",
    "end": "532670"
  },
  {
    "text": "That gets invertible at Df is 0, which is just fine.",
    "start": "532670",
    "end": "536940"
  },
  {
    "text": "The other interesting thing is the- you",
    "start": "536940",
    "end": "539640"
  },
  {
    "text": "have x_k plus 1 is x_k, and there's a name for that.",
    "start": "539640",
    "end": "542325"
  },
  {
    "text": "That says that x_k is a stationary point of our algorithm.",
    "start": "542325",
    "end": "545855"
  },
  {
    "text": "So stationary point means what it sounds like.",
    "start": "545855",
    "end": "548570"
  },
  {
    "text": "It means that if you apply your algorithm to that point,",
    "start": "548570",
    "end": "551530"
  },
  {
    "text": "you do a bunch of computation,",
    "start": "551530",
    "end": "553090"
  },
  {
    "text": "and then there's a drum roll and you get back to the same point you had before.",
    "start": "553090",
    "end": "557355"
  },
  {
    "text": "That's called the stationary point.",
    "start": "557355",
    "end": "558570"
  },
  {
    "text": "Because if you do it again, it's going to stay there.",
    "start": "558570",
    "end": "560730"
  },
  {
    "text": "It's going to always just stay- if you think of",
    "start": "560730",
    "end": "563255"
  },
  {
    "text": "the algorithm iteration as- as- as- as being some kind of a nonlinear dynamical system,",
    "start": "563255",
    "end": "570255"
  },
  {
    "text": "then what this says is it's a- it's",
    "start": "570255",
    "end": "572030"
  },
  {
    "text": "an equilibrium point or stationary point of that dynamical system.",
    "start": "572030",
    "end": "574735"
  },
  {
    "text": "Okay. And to check that, you know,",
    "start": "574735",
    "end": "577170"
  },
  {
    "text": "we would just say what would happen if this whole thing over here were 0, right?",
    "start": "577170",
    "end": "581930"
  },
  {
    "text": "Because that's what it would mean if x_k plus 1 is x_k.",
    "start": "581930",
    "end": "584290"
  },
  {
    "text": "Well, this is an invertible matrix, so I can get rid of that.",
    "start": "584290",
    "end": "587610"
  },
  {
    "text": "And it says, that's 0, and I see, Oh,",
    "start": "587610",
    "end": "589605"
  },
  {
    "text": "Df transpose x is 0,",
    "start": "589605",
    "end": "592154"
  },
  {
    "text": "hey- except for the factor of 2,",
    "start": "592155",
    "end": "594270"
  },
  {
    "text": "which obviously doesn't matter.",
    "start": "594270",
    "end": "595680"
  },
  {
    "text": "That's exactly the condition- the stationarity condition for the problem.",
    "start": "595680",
    "end": "599045"
  },
  {
    "text": "So- so that says that,",
    "start": "599045",
    "end": "601355"
  },
  {
    "text": "that if a point is stationary in Levenberg-Marquardt,",
    "start": "601355",
    "end": "605889"
  },
  {
    "text": "then it says that the optimality condition holds.",
    "start": "605890",
    "end": "608525"
  },
  {
    "text": "And now, recall that that does not mean that,",
    "start": "608525",
    "end": "611225"
  },
  {
    "text": "you know, x_k is necessarily the solution, right?",
    "start": "611225",
    "end": "614505"
  },
  {
    "text": "It means it's a candidate to be a solution or something like that.",
    "start": "614505",
    "end": "617885"
  },
  {
    "text": "Frankly, no one really- I mean, depends on the application.",
    "start": "617885",
    "end": "620390"
  },
  {
    "text": "People don't really care about that.",
    "start": "620390",
    "end": "621800"
  },
  {
    "text": "They just want to know, you know, have you found a good a good point?",
    "start": "621800",
    "end": "624334"
  },
  {
    "text": "Good point means one with a small residual. Okay.",
    "start": "624335",
    "end": "628500"
  },
  {
    "text": "And now I'm gonna explain how to update, um, Lambda.",
    "start": "628500",
    "end": "631540"
  },
  {
    "text": "Actually, there are many, many ways to do it.",
    "start": "631540",
    "end": "633579"
  },
  {
    "text": "Some are more sophisticated.",
    "start": "633580",
    "end": "634719"
  },
  {
    "text": "This is a super-duper, simple, uh,",
    "start": "634719",
    "end": "636745"
  },
  {
    "text": "and it's also extremely intuitive,",
    "start": "636745",
    "end": "639010"
  },
  {
    "text": "uh, and it connects to the ideas we have in the class.",
    "start": "639010",
    "end": "641455"
  },
  {
    "text": "Okay. So if Lambda is too big,",
    "start": "641455",
    "end": "645295"
  },
  {
    "text": "then here's what's gonna happen.",
    "start": "645295",
    "end": "646899"
  },
  {
    "text": "Um, your x_k plus 1 is gonna be too close to x_k.",
    "start": "646900",
    "end": "651025"
  },
  {
    "text": "Um, no, actually that's fine because it'll mean",
    "start": "651025",
    "end": "654610"
  },
  {
    "text": "the af- the affine approximation is very good.",
    "start": "654610",
    "end": "658225"
  },
  {
    "text": "Um, but the point is x_k is- x_k plus 1 is just a little bit away from x_k, right?",
    "start": "658225",
    "end": "663714"
  },
  {
    "text": "So, um, and it may take a very large number of iterations.",
    "start": "663715",
    "end": "668050"
  },
  {
    "text": "So there's nothing wrong with having Lambda too big.",
    "start": "668050",
    "end": "670195"
  },
  {
    "text": "It just means you're gonna take a whole lot of iterations, uh,",
    "start": "670195",
    "end": "673045"
  },
  {
    "text": "to get to a solution or something,",
    "start": "673045",
    "end": "675610"
  },
  {
    "text": "to an approximate solution I should say.",
    "start": "675610",
    "end": "677394"
  },
  {
    "text": "Now, um, having Lambda too small,",
    "start": "677395",
    "end": "680440"
  },
  {
    "text": "then you can actually get into trouble.",
    "start": "680440",
    "end": "681985"
  },
  {
    "text": "If Lambda is too small,",
    "start": "681985",
    "end": "683860"
  },
  {
    "text": "x_k is gonna be- it's gonna venture to, it trusts the affine approximation too much,",
    "start": "683860",
    "end": "689605"
  },
  {
    "text": "and it's gonna choose the next point relatively far from x_k.",
    "start": "689605",
    "end": "693084"
  },
  {
    "text": "Um, now, if you're lucky, that's fine.",
    "start": "693085",
    "end": "696090"
  },
  {
    "text": "Um, but if you're unlucky,",
    "start": "696090",
    "end": "697620"
  },
  {
    "text": "the affine approximation is poor and you can even- you can even lead to the case where,",
    "start": "697620",
    "end": "702300"
  },
  {
    "text": "in this case, uh, it would be possible for the-",
    "start": "702300",
    "end": "704760"
  },
  {
    "text": "the objective value at the next- at this next iterate to be higher than the current one.",
    "start": "704760",
    "end": "709490"
  },
  {
    "text": "That's not what we call progress, okay?",
    "start": "709490",
    "end": "711805"
  },
  {
    "text": "So here's the update mechanism.",
    "start": "711805",
    "end": "714040"
  },
  {
    "text": "It says, if the norm squared,",
    "start": "714040",
    "end": "716980"
  },
  {
    "text": "that's the objective, at the k plus 1, uh,",
    "start": "716980",
    "end": "720355"
  },
  {
    "text": "iterate is better, that's the strict inequal- strict inequality,",
    "start": "720355",
    "end": "724885"
  },
  {
    "text": "if it's better than the current objective,",
    "start": "724885",
    "end": "727180"
  },
  {
    "text": "that means you made progress, right?",
    "start": "727180",
    "end": "729339"
  },
  {
    "text": "And so you update the new x,",
    "start": "729340",
    "end": "731380"
  },
  {
    "text": "you accept the new x, and you reduce Lambda.",
    "start": "731380",
    "end": "733705"
  },
  {
    "text": "And, you know, you might reduce it by 20%.",
    "start": "733705",
    "end": "737035"
  },
  {
    "text": "I mean, it doesn't matter.",
    "start": "737035",
    "end": "738144"
  },
  {
    "text": "It just turned out at this- it doesn't matter, right?",
    "start": "738145",
    "end": "740170"
  },
  {
    "text": "But, you know, you reduce it by 20%.",
    "start": "740170",
    "end": "741925"
  },
  {
    "text": "And the reason is, uh, it means it worked,",
    "start": "741925",
    "end": "744310"
  },
  {
    "text": "but you kind of want Lambda to be,",
    "start": "744310",
    "end": "747205"
  },
  {
    "text": "uh, as small as possible that allows you to make progress.",
    "start": "747205",
    "end": "750280"
  },
  {
    "text": "So this- you might- you might de-",
    "start": "750280",
    "end": "752830"
  },
  {
    "text": "you'll be a little bit more aggressive on the next step. That's this.",
    "start": "752830",
    "end": "756085"
  },
  {
    "text": "Now, if- if this is false,",
    "start": "756085",
    "end": "758590"
  },
  {
    "text": "it means that you found your next po- your next tentative point.",
    "start": "758590",
    "end": "763840"
  },
  {
    "text": "First of all, it's not progress because the objective value went up,",
    "start": "763840",
    "end": "766990"
  },
  {
    "text": "not down, and so that's something you definitely don't want.",
    "start": "766990",
    "end": "769285"
  },
  {
    "text": "So what you do is you don't update x,",
    "start": "769285",
    "end": "772329"
  },
  {
    "text": "um, you just keep it the same value, um,",
    "start": "772330",
    "end": "775555"
  },
  {
    "text": "and what you do is you double Lambda,",
    "start": "775555",
    "end": "778495"
  },
  {
    "text": "and that means that you are- I mean, by the way,",
    "start": "778495",
    "end": "780820"
  },
  {
    "text": "double it could be- it could both one and by 1.5,",
    "start": "780820",
    "end": "782980"
  },
  {
    "text": "three, whatever you like.",
    "start": "782980",
    "end": "784180"
  },
  {
    "text": "Um, what that means is,",
    "start": "784180",
    "end": "786680"
  },
  {
    "text": "if this inequality fails to hold,",
    "start": "786680",
    "end": "790260"
  },
  {
    "text": "that means that you did not make progress or,",
    "start": "790260",
    "end": "792510"
  },
  {
    "text": "I mean, you could even have a- do it this way.",
    "start": "792510",
    "end": "794235"
  },
  {
    "text": "Meaning, your next point is worse than your current point.",
    "start": "794235",
    "end": "797175"
  },
  {
    "text": "If that's the case, it means that you were too trusting of your affine model,",
    "start": "797175",
    "end": "801065"
  },
  {
    "text": "and that means you need to update Lambda.",
    "start": "801065",
    "end": "803035"
  },
  {
    "text": "You need to increase Lambda specifically because that'll",
    "start": "803035",
    "end": "805269"
  },
  {
    "text": "cause- when you solve that least squares problem,",
    "start": "805270",
    "end": "807760"
  },
  {
    "text": "it'll cause you to be closer to x_k,",
    "start": "807760",
    "end": "809545"
  },
  {
    "text": "where we hope the affine model will be more accurate.",
    "start": "809545",
    "end": "813220"
  },
  {
    "text": "So if we do that,",
    "start": "813220",
    "end": "815139"
  },
  {
    "text": "we'll- we'll double Lambda, uh, that's it.",
    "start": "815140",
    "end": "817555"
  },
  {
    "text": "And we keep the same x.",
    "start": "817555",
    "end": "818725"
  },
  {
    "text": "So that's- that- that- that's what this looks like.",
    "start": "818725",
    "end": "820810"
  },
  {
    "text": "Okay. Um, okay.",
    "start": "820810",
    "end": "822970"
  },
  {
    "text": "So this is, uh, and now that's the whole algorithm, that's it.",
    "start": "822970",
    "end": "825685"
  },
  {
    "text": "I mean, you have to give it an initial point.",
    "start": "825685",
    "end": "827860"
  },
  {
    "text": "Uh, you have to give it an initial value of Lambda.",
    "start": "827860",
    "end": "830560"
  },
  {
    "text": "But other than that, we've told you everything about- about the- the thing.",
    "start": "830560",
    "end": "833815"
  },
  {
    "text": "And this will be a Lambda often people just take it to be 1, something like that.",
    "start": "833815",
    "end": "838450"
  },
  {
    "text": "So let's look at an  example.",
    "start": "838450",
    "end": "840550"
  },
  {
    "text": "[NOISE] It's gonna be a range,",
    "start": "840550",
    "end": "843264"
  },
  {
    "text": "uh, a range estimation problem, okay?",
    "start": "843264",
    "end": "846055"
  },
  {
    "text": "So, um, so here it is.",
    "start": "846055",
    "end": "848710"
  },
  {
    "text": "Uh, you, uh, the- the minimum,",
    "start": "848710",
    "end": "852250"
  },
  {
    "text": "that- the one that minimizes,",
    "start": "852250",
    "end": "853570"
  },
  {
    "text": "uh, the norm squared of f of x.",
    "start": "853570",
    "end": "855940"
  },
  {
    "text": "And remember that's the sum of the squares of the residuals to the ranges, right?",
    "start": "855940",
    "end": "859045"
  },
  {
    "text": "The blue things, by the way, show you where that beacons are,",
    "start": "859045",
    "end": "861445"
  },
  {
    "text": "which is kind of interesting.",
    "start": "861445",
    "end": "862510"
  },
  {
    "text": "So basically, it says you're somewhere, um,",
    "start": "862510",
    "end": "866020"
  },
  {
    "text": "and you get a noisy measurement of the distance or range to each of those blue dots.",
    "start": "866020",
    "end": "872035"
  },
  {
    "text": "Those are, you know beacons or- it doesn't matter.",
    "start": "872035",
    "end": "875035"
  },
  {
    "text": "I mean, this can also be turned around,",
    "start": "875035",
    "end": "876790"
  },
  {
    "text": "and these could- can be individual radar, uh,",
    "start": "876790",
    "end": "878949"
  },
  {
    "text": "installations which are giving you range to a target.",
    "start": "878950",
    "end": "881770"
  },
  {
    "text": "And now they're coordinating to try to figure out where is the target.",
    "start": "881770",
    "end": "885100"
  },
  {
    "text": "Uh, that language suggests, uh,",
    "start": "885100",
    "end": "888865"
  },
  {
    "text": "not socially positive applications of this, but unfortunately,",
    "start": "888865",
    "end": "892105"
  },
  {
    "text": "this is used sometimes for non-socially positive applications.",
    "start": "892105",
    "end": "896529"
  },
  {
    "text": "Okay. Um, so the contour lines show you the- the- the, um,",
    "start": "896530",
    "end": "900025"
  },
  {
    "text": "the bet- the- the set of points where-",
    "start": "900025",
    "end": "903025"
  },
  {
    "text": "where f of x norm squared takes a particular value.",
    "start": "903025",
    "end": "906205"
  },
  {
    "text": "Red is actually the mini- minimizer,",
    "start": "906205",
    "end": "908440"
  },
  {
    "text": "uh, and then you could see, you know,",
    "start": "908440",
    "end": "910540"
  },
  {
    "text": "all- all the points in here, you know,",
    "start": "910540",
    "end": "912459"
  },
  {
    "text": "are- are- are close to minimum and so on.",
    "start": "912460",
    "end": "914950"
  },
  {
    "text": "Anyway, that- that's it.",
    "start": "914950",
    "end": "916315"
  },
  {
    "text": "And here's a graph of it if you wanna see what that looks like, as a function of x.",
    "start": "916315",
    "end": "919900"
  },
  {
    "text": "Now, what we're looking for is that point right there,",
    "start": "919900",
    "end": "923020"
  },
  {
    "text": "uh, this- that's this one.",
    "start": "923020",
    "end": "924370"
  },
  {
    "text": "That's the one that minimizes this thing.",
    "start": "924370",
    "end": "926589"
  },
  {
    "text": "Um, that's gonna be kind of our best estimate of the position,",
    "start": "926590",
    "end": "930070"
  },
  {
    "text": "you know, of x. Um, now,",
    "start": "930070",
    "end": "932590"
  },
  {
    "text": "[NOISE] what you'll look at and see is it also",
    "start": "932590",
    "end": "934630"
  },
  {
    "text": "the weird bumps and [LAUGHTER] stuff in here and it's not- it's- it's not,",
    "start": "934630",
    "end": "938095"
  },
  {
    "text": "uh, it- we'll actually see momentarily.",
    "start": "938095",
    "end": "940959"
  },
  {
    "text": "There some, uh, so-called local minimum.",
    "start": "940960",
    "end": "943270"
  },
  {
    "text": "Okay. So, um, here's the way it works, uh,",
    "start": "943270",
    "end": "947800"
  },
  {
    "text": "and we're showing here Levenberg- Marquardt [NOISE] from- from three initial points.",
    "start": "947800",
    "end": "953110"
  },
  {
    "text": "So here's- here's like the first- the first run of Levenberg- Marquardt.",
    "start": "953110",
    "end": "956709"
  },
  {
    "text": "We start there, I mean, who- who knows why?",
    "start": "956710",
    "end": "958705"
  },
  {
    "text": "Okay. And the first step takes in here,",
    "start": "958705",
    "end": "961210"
  },
  {
    "text": "then here, then here,",
    "start": "961210",
    "end": "962350"
  },
  {
    "text": "then here, then here, then here,",
    "start": "962350",
    "end": "963940"
  },
  {
    "text": "and you can see that it found what we know is- is actually the- the global minimum, okay?",
    "start": "963940",
    "end": "969700"
  },
  {
    "text": "Um, global minimum means it's- it's the one that",
    "start": "969700",
    "end": "972550"
  },
  {
    "text": "actually minimizes the norm squared of f, okay?",
    "start": "972550",
    "end": "975355"
  },
  {
    "text": "Um, here, we start this one from here,",
    "start": "975355",
    "end": "978055"
  },
  {
    "text": "and it kinda goes along here,",
    "start": "978055",
    "end": "980035"
  },
  {
    "text": "and then it- it- it also finds the global minimum.",
    "start": "980035",
    "end": "984024"
  },
  {
    "text": "Okay. This is interesting. Look at this.",
    "start": "984025",
    "end": "986845"
  },
  {
    "text": "Here, we started the initial thing not very",
    "start": "986845",
    "end": "989050"
  },
  {
    "text": "far from this other point where I'd found the minimum.",
    "start": "989050",
    "end": "991404"
  },
  {
    "text": "And this one kinda goes here, here,",
    "start": "991405",
    "end": "993430"
  },
  {
    "text": "here, here, here, and then it gets stuck there.",
    "start": "993430",
    "end": "996010"
  },
  {
    "text": "Uh, I mean, it finds an okay point,",
    "start": "996010",
    "end": "997990"
  },
  {
    "text": "but it is not the actual global minimum of the problem.",
    "start": "997990",
    "end": "1000870"
  },
  {
    "text": "So in that case,",
    "start": "1000870",
    "end": "1002070"
  },
  {
    "text": "you would say in this case, uh,",
    "start": "1002070",
    "end": "1004770"
  },
  {
    "text": "Levenberg-Marquardt actually solve the non-linear least squares problem,",
    "start": "1004770",
    "end": "1009765"
  },
  {
    "text": "actually solved it, starting from this point or this point,",
    "start": "1009765",
    "end": "1012510"
  },
  {
    "text": "but not from that point.",
    "start": "1012510",
    "end": "1014160"
  },
  {
    "text": "So that- that's kind of the- the picture.",
    "start": "1014160",
    "end": "1015975"
  },
  {
    "text": "Now, of course, in many dimensions because we don't really",
    "start": "1015975",
    "end": "1019199"
  },
  {
    "text": "run- you don't need Levenberg-Marquardt if it's a function,",
    "start": "1019200",
    "end": "1022890"
  },
  {
    "text": "uh, of two variables, right?",
    "start": "1022890",
    "end": "1024120"
  },
  {
    "text": "Because you just make a grid and plot it and use your eyeball.",
    "start": "1024120",
    "end": "1026490"
  },
  {
    "text": "And you- I mean you- you make a plot like that",
    "start": "1026490",
    "end": "1028589"
  },
  {
    "text": "and you find out where the- where's the smallest point.",
    "start": "1028590",
    "end": "1030584"
  },
  {
    "text": "Um, so the point is- what you really use this for, of course,",
    "start": "1030585",
    "end": "1034875"
  },
  {
    "text": "is for, uh, cases with, you know, 10 variables,",
    "start": "1034875",
    "end": "1037470"
  },
  {
    "text": "20, uh, 2,000 variables, 20,000 variables.",
    "start": "1037470",
    "end": "1040275"
  },
  {
    "text": "This is where you really do it,",
    "start": "1040275",
    "end": "1041459"
  },
  {
    "text": "where it goes without saying you cannot possibly visualize anything.",
    "start": "1041460",
    "end": "1044895"
  },
  {
    "text": "Okay. So here, if you look at how the,",
    "start": "1044895",
    "end": "1050100"
  },
  {
    "text": "uh, the norm squared of, um,",
    "start": "1050100",
    "end": "1053265"
  },
  {
    "text": "of the- the objective of what, uh,",
    "start": "1053265",
    "end": "1055830"
  },
  {
    "text": "f of x k looks like, um, well,",
    "start": "1055830",
    "end": "1058289"
  },
  {
    "text": "you can see that in these case that it converges to",
    "start": "1058290",
    "end": "1060300"
  },
  {
    "text": "a number that's not- it's not zero because of the noises,",
    "start": "1060300",
    "end": "1063149"
  },
  {
    "text": "but it's pretty, you know, it's pretty small.",
    "start": "1063149",
    "end": "1065400"
  },
  {
    "text": "Uh, and you can see that in these two cases,",
    "start": "1065400",
    "end": "1067530"
  },
  {
    "text": "the brown trace and the blue trace,",
    "start": "1067530",
    "end": "1069990"
  },
  {
    "text": "um, we actually made it to the global minimum.",
    "start": "1069990",
    "end": "1072720"
  },
  {
    "text": "This red trace, we would say,",
    "start": "1072720",
    "end": "1074895"
  },
  {
    "text": "this red run at Levenberg-Marquardt actually got stuck,",
    "start": "1074895",
    "end": "1077760"
  },
  {
    "text": "and it got stuck in a pretty bad- in",
    "start": "1077760",
    "end": "1079950"
  },
  {
    "text": "a pretty bad so-called local minimum or stationary point.",
    "start": "1079950",
    "end": "1083100"
  },
  {
    "text": "It found one, it has, uh,",
    "start": "1083100",
    "end": "1084945"
  },
  {
    "text": "a norm squared of about 2,",
    "start": "1084945",
    "end": "1086429"
  },
  {
    "text": "more than 2, uh,",
    "start": "1086430",
    "end": "1087495"
  },
  {
    "text": "whereas this thing is really very small.",
    "start": "1087495",
    "end": "1089550"
  },
  {
    "text": "I don't know how small it is,",
    "start": "1089550",
    "end": "1090765"
  },
  {
    "text": "0.1 or something like that.",
    "start": "1090765",
    "end": "1092325"
  },
  {
    "text": "Uh, and then what this will show you is- is actually",
    "start": "1092325",
    "end": "1096075"
  },
  {
    "text": "a trajectory of the- of this trust parameter Lambda k. Actually,",
    "start": "1096075",
    "end": "1100934"
  },
  {
    "text": "you should call it the distrust parameter because the larger Lambda k,",
    "start": "1100935",
    "end": "1104055"
  },
  {
    "text": "it means the less that you trust your model.",
    "start": "1104055",
    "end": "1106140"
  },
  {
    "text": "And so I think they all started at 0.1.",
    "start": "1106140",
    "end": "1109170"
  },
  {
    "text": "And you can see like in the first case,",
    "start": "1109170",
    "end": "1112245"
  },
  {
    "text": "you can actually work out what happened, right?",
    "start": "1112245",
    "end": "1114090"
  },
  {
    "text": "Like- so every time it went down,",
    "start": "1114090",
    "end": "1116025"
  },
  {
    "text": "it meant that your last iteration was better than your current one.",
    "start": "1116025",
    "end": "1119100"
  },
  {
    "text": "Every time it goes up by a factor of two,",
    "start": "1119100",
    "end": "1121095"
  },
  {
    "text": "it means that you were too aggressive and went to a point that was too,",
    "start": "1121095",
    "end": "1124965"
  },
  {
    "text": "uh, where- where it actually,",
    "start": "1124965",
    "end": "1126690"
  },
  {
    "text": "you- you double the Lambda, right?",
    "start": "1126690",
    "end": "1128669"
  },
  {
    "text": "So every time you do this,",
    "start": "1128670",
    "end": "1129720"
  },
  {
    "text": "this goes up if that's 0.1,",
    "start": "1129720",
    "end": "1131580"
  },
  {
    "text": "I don't know what that is, 0.13.",
    "start": "1131580",
    "end": "1133649"
  },
  {
    "text": "This is probably 0.26, right?",
    "start": "1133650",
    "end": "1135705"
  },
  {
    "text": "Well, it's double, right?",
    "start": "1135705",
    "end": "1137414"
  },
  {
    "text": "And you can see how this works.",
    "start": "1137415",
    "end": "1138840"
  },
  {
    "text": "Uh, so this is still all of these parts here.",
    "start": "1138840",
    "end": "1141510"
  },
  {
    "text": "It means that- it- it means that you met",
    "start": "1141510",
    "end": "1144450"
  },
  {
    "text": "that criterion which is the- you actually improved, uh, the objective.",
    "start": "1144450",
    "end": "1149250"
  },
  {
    "text": "Um, so I- I should say that over here,",
    "start": "1149250",
    "end": "1152190"
  },
  {
    "text": "yeah, over here we're not showing, um, those values.",
    "start": "1152190",
    "end": "1155820"
  },
  {
    "text": "Uh, we show them this way.",
    "start": "1155820",
    "end": "1157559"
  },
  {
    "text": "We don't show the tentative values.",
    "start": "1157560",
    "end": "1158790"
  },
  {
    "text": "What we do is- let- let's find one here between 4 and 5, that's here.",
    "start": "1158790",
    "end": "1161820"
  },
  {
    "text": "So what we simply do is this- it's the same x_k,",
    "start": "1161820",
    "end": "1164519"
  },
  {
    "text": "it's x- x_4, it's x_5.",
    "start": "1164520",
    "end": "1166735"
  },
  {
    "text": "And that simply means that we computed a x_5 or tentative x_5.",
    "start": "1166735",
    "end": "1171804"
  },
  {
    "text": "Unfortunately, the objective was [LAUGHTER] higher than where we were,",
    "start": "1171805",
    "end": "1175260"
  },
  {
    "text": "so we did not make progress,",
    "start": "1175260",
    "end": "1176580"
  },
  {
    "text": "and so we didn't accept it,",
    "start": "1176580",
    "end": "1177870"
  },
  {
    "text": "and so we kept the same one.",
    "start": "1177870",
    "end": "1179385"
  },
  {
    "text": "That's why this is level, a bit flat.",
    "start": "1179385",
    "end": "1181035"
  },
  {
    "text": "And that also corresponds to this jump up,",
    "start": "1181035",
    "end": "1183375"
  },
  {
    "text": "because what it does is it- what we do is when- when you have",
    "start": "1183375",
    "end": "1186020"
  },
  {
    "text": "found you've been too aggressive in updating, uh,",
    "start": "1186020",
    "end": "1189180"
  },
  {
    "text": "in trusting your affine model,",
    "start": "1189180",
    "end": "1191055"
  },
  {
    "text": "what happens is you increase Lambda",
    "start": "1191055",
    "end": "1193320"
  },
  {
    "text": "by a factor of 2 and you keep the- you keep the old x.",
    "start": "1193320",
    "end": "1196929"
  }
]