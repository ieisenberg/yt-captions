[
  {
    "start": "0",
    "end": "60000"
  },
  {
    "text": "We're now going to look at chapter 4, which is on methods for clustering. Actually, we haven't done that much in the course so far,",
    "start": "4070",
    "end": "11690"
  },
  {
    "text": "we've just seen vectors, some examples, we know just a handful of operations on them.",
    "start": "11690",
    "end": "16700"
  },
  {
    "text": "For example, we can look at the norm, which is a measure of size. We can look at distance between two vectors,",
    "start": "16700",
    "end": "23860"
  },
  {
    "text": "and in fact, that's where we take off from in the idea of clustering. Um, but we'll find that even just with this extremely small list,",
    "start": "23860",
    "end": "32255"
  },
  {
    "text": "uh, things we know about, and in fact, in this case, specifically, only simply the distance between two vectors,",
    "start": "32255",
    "end": "38255"
  },
  {
    "text": "we can already do interesting and useful things. So, uh, in some sense,",
    "start": "38255",
    "end": "43340"
  },
  {
    "text": "this is just a- a detour out of the main topic of the course, but it's just to show you that even with this extremely small list of things you know about,",
    "start": "43340",
    "end": "51095"
  },
  {
    "text": "we can actually do cool and useful stuff. You can use this at your next internship, by the way.",
    "start": "51095",
    "end": "56390"
  },
  {
    "text": "And if people don't know about it, they'll be very impressed. Okay. So the idea behind clustering is this, um,",
    "start": "56390",
    "end": "63739"
  },
  {
    "start": "60000",
    "end": "257000"
  },
  {
    "text": "we start with a whole bunch of n-vectors, where we have capital N n-vectors, and we're gonna call them x_1 through x_n, that's a subscript.",
    "start": "63740",
    "end": "71609"
  },
  {
    "text": "Notice this is a little ambiguous, right? Because x_7 is actually a vector.",
    "start": "71610",
    "end": "77520"
  },
  {
    "text": "It is the seventh vector in our list of vectors, right? So if you wanted to refer to a component of x_7,",
    "start": "77520",
    "end": "83915"
  },
  {
    "text": "for example, you might do this, and that would be- this would in- this thing here,",
    "start": "83915",
    "end": "89645"
  },
  {
    "text": "that notation would indicate x_7 is a seventh vector. This is a number now, uh, it's with fifth entry of the seventh vector.",
    "start": "89645",
    "end": "97689"
  },
  {
    "text": "Okay. So I have a list of vectors, and the goal is to take these capital N vectors and divide or cluster them,",
    "start": "97690",
    "end": "105875"
  },
  {
    "text": "uh, into part itself. Either partitions, groups, subsets, however you wanna say it.",
    "start": "105875",
    "end": "111410"
  },
  {
    "text": "Um, so for example, we might wanna divide them into three or five,",
    "start": "111410",
    "end": "117495"
  },
  {
    "text": "um, by convention, uh, actually because of the no- the- that's a long history,",
    "start": "117495",
    "end": "122910"
  },
  {
    "text": "uh, the- we're going to call the number, uh, of groups that we partition the vectors into k. Um, okay.",
    "start": "122910",
    "end": "130384"
  },
  {
    "text": "So here's the idea, uh, the idea is you want to make these partitions of vectors,",
    "start": "130385",
    "end": "136770"
  },
  {
    "text": "you wanna group them into groups that are close to each other. And so down here we're gonna see a picture. Here's our actual data.",
    "start": "136770",
    "end": "142325"
  },
  {
    "text": "Now, in this case, uh, these are vectors in- these are two vectors, right?",
    "start": "142325",
    "end": "147500"
  },
  {
    "text": "So we can plot them. Um, of course, we're not that interested in clustering two vectors, right? We're much more interested in clustering 10 vectors,",
    "start": "147500",
    "end": "155155"
  },
  {
    "text": "um, 10,000 vectors, or even a million vectors, right? Million vectors. And I don't know how many we've got here,",
    "start": "155155",
    "end": "161120"
  },
  {
    "text": "maybe 100, couple hundred, it really doesn't matter, but you can see them here. Now, your eyeball tells you right away that,",
    "start": "161120",
    "end": "169595"
  },
  {
    "text": "you know, you could cluster them into like kind of three groups like that. Okay? That's just your eyeball.",
    "start": "169595",
    "end": "175665"
  },
  {
    "text": "And of course your eyeball is not going to work when you have vectors of dimension 10,000, right? So- but here, and it's a- it's a- it's kinda like, you know,",
    "start": "175665",
    "end": "184250"
  },
  {
    "text": "there's some question as to which cluster does- do the ones likes near that- between two lie in,",
    "start": "184250",
    "end": "190040"
  },
  {
    "text": "but these are like detailed. The idea is just a- is a rough idea to- you get three groups here. Okay. So here's an example of a clustering,",
    "start": "190040",
    "end": "197370"
  },
  {
    "text": "and what we've done is we have color-code, we- we've had k equal- we have k equals 3 here, and we've color-coded them.",
    "start": "197370",
    "end": "202500"
  },
  {
    "text": "So you can see which of the- uh, which are the vectors over here have been assigned to which group.",
    "start": "202500",
    "end": "208489"
  },
  {
    "text": "And so we have a green group, a red group, and a blue group. Okay? And you know, you could quibble with some of our choices here, like for example,",
    "start": "208490",
    "end": "215795"
  },
  {
    "text": "I don't know if you can see, but there's a little green dot right there, you might say, oh no, that one should be red, you know,",
    "start": "215795",
    "end": "221430"
  },
  {
    "text": "your- you know, these are- this is minor, it's not an- it's not a very precise concept, it's just- and-",
    "start": "221430",
    "end": "226459"
  },
  {
    "text": "and we'll see that in applications it'll be clear that it's not a very precise concept, but we'll see also it's unbelievably useful.",
    "start": "226460",
    "end": "231970"
  },
  {
    "text": "Okay. So this is the idea. So the question is, how do we automatically, uh, come up with a clustering,",
    "start": "231970",
    "end": "237690"
  },
  {
    "text": "uh, like the one shown here? Um, I should add that if we're doing this- if we're doing this for vectors that are in,",
    "start": "237690",
    "end": "244069"
  },
  {
    "text": "uh, that have dimension 2, you use your eyeball to do the clustering. You get out a pencil and you cluster them just like I did over here.",
    "start": "244070",
    "end": "251770"
  },
  {
    "text": "That's exactly what- it's manual clustering. That's not gonna cut it in higher dimensions. Okay. So before we talk about how to do it,",
    "start": "251770",
    "end": "260884"
  },
  {
    "text": "uh, I want to talk about what you might, uh, use it for. What would you use clustering for? Or what would be the setting in which you would use clustering?",
    "start": "260885",
    "end": "267580"
  },
  {
    "text": "Well, it's actually super interesting. So here's an example. Let's suppose that the vectors are word count histograms for a collection of documents.",
    "start": "267580",
    "end": "275510"
  },
  {
    "text": "Uh, some people call it a collection of documents of corpus. Uh, so for example, Wikipedia is sometimes considered a corpus, right?",
    "start": "275510",
    "end": "281870"
  },
  {
    "text": "I forget how many, uh, documents, well, it's changing everyday. Wikipedia, but that's a corpus of documents, right?",
    "start": "281870",
    "end": "288035"
  },
  {
    "text": "And then for each document, uh, you would have, uh, a word count histogram,",
    "start": "288035",
    "end": "293130"
  },
  {
    "text": "it just counts the number of words. Uh, so, um, no, it- it's- it's very unsophisticated.",
    "start": "293130",
    "end": "299600"
  },
  {
    "text": "Um, you know, I wanna add that, that means that when we associate a vector with each document,",
    "start": "299600",
    "end": "306710"
  },
  {
    "text": "it is really profoundly stupid. It does not- it does not understand English, it does not understand syntax,",
    "start": "306710",
    "end": "313430"
  },
  {
    "text": "it doesn't know what a sentence is, it doesn't know what a paragraph is, it has absolutely no meaning what any of the words are,",
    "start": "313430",
    "end": "318725"
  },
  {
    "text": "and it simply counts the words in our dictionary and that's our vector. Okay, so I just emphasize how crude- how crude,",
    "start": "318725",
    "end": "324510"
  },
  {
    "text": "uh, this really is. Uh, and yet we'll see, it's pretty shocking what happens. Okay. Here would be another, uh,",
    "start": "324510",
    "end": "331410"
  },
  {
    "text": "potential area where you might do this is let's go back, let's do patient clustering. So let's have a large hospital or network of hospitals,",
    "start": "331410",
    "end": "339544"
  },
  {
    "text": "and we- what we do is each vector is going to represent one patient and what it's gonna have,",
    "start": "339545",
    "end": "345440"
  },
  {
    "text": "the entries are gonna things- go- are going to encode things like age, sex, weight, height, uh,",
    "start": "345440",
    "end": "352035"
  },
  {
    "text": "blood pressure, diastolic, systolic. Uh, whether or not they're currently experiencing chest pain.",
    "start": "352035",
    "end": "358145"
  },
  {
    "text": "Uh, it could give- uh, the vector can also have entries, uh, that tell you that encode whether, um,",
    "start": "358145",
    "end": "364345"
  },
  {
    "text": "not just symptoms, but also the results of tests, right? Have they tested negative for something or positive for something?",
    "start": "364345",
    "end": "370324"
  },
  {
    "text": "So that would be, or if it's a numerical test, uh, it could, that- I mean that- that's also- that would be encoded in x.",
    "start": "370325",
    "end": "377460"
  },
  {
    "text": "Okay. So these are- your vector is a- is- is- is actually a set of attributes of each patient.",
    "start": "377460",
    "end": "384605"
  },
  {
    "text": "Okay. Now, there, um, it would be very useful, if you had 100,000 patients to group them into,",
    "start": "384605",
    "end": "392775"
  },
  {
    "text": "I don't know, I'm not making this up, but you know, 60 different clusters. And you could probably find out some interesting stuff that way.",
    "start": "392775",
    "end": "399050"
  },
  {
    "text": "Um, okay. Um, customer market segmentation. So this is, uh, as a matter of fact,",
    "start": "399050",
    "end": "404870"
  },
  {
    "text": "this is done pretty much universally. And the way that works is, um, at each- each vector corresponds in or a set of attributes that correspond to a customer.",
    "start": "404870",
    "end": "415945"
  },
  {
    "text": "And so what you do, is it would include things like their purchase history. How much ma- how many dollars over the last month, uh,",
    "start": "415945",
    "end": "422360"
  },
  {
    "text": "of items, such and such have they- have they purchased, right? That's an example. It could include others,",
    "start": "422360",
    "end": "428360"
  },
  {
    "text": "other attributes of a- it could include like where they live, age group, education level,",
    "start": "428360",
    "end": "435139"
  },
  {
    "text": "I mean, any of -all of these are both possible, right. So we can- tha- that's the idea. And now what you do is,",
    "start": "435140",
    "end": "442160"
  },
  {
    "text": "uh, you would cluster these vectors, right? So, um, and the idea is we would get, I don't know,",
    "start": "442160",
    "end": "447635"
  },
  {
    "text": "68 groups or clusters, um, and, uh, groups or clusters of customers.",
    "start": "447635",
    "end": "454440"
  },
  {
    "text": "And then a person would get their eyeball in there and go in and look and they'd say, oh, I see what this is,",
    "start": "454440",
    "end": "459830"
  },
  {
    "text": "this- the- these are, you know, these are 18 to 22-year-old college students",
    "start": "459830",
    "end": "465680"
  },
  {
    "text": "or something, I don't know, that kinda thing. Okay. So, uh, there this- there are this- this would be, uh, quite useful, right?",
    "start": "465680",
    "end": "472000"
  },
  {
    "text": "Because you could then tune your marketing and other stuff, advertising. Okay. Um, here's a- here's an application, it's actually one of the- uh,",
    "start": "472000",
    "end": "479355"
  },
  {
    "text": "it's a famous one that people have, uh, you know, typically shown, uh, all the time, um,",
    "start": "479355",
    "end": "484800"
  },
  {
    "text": "and it's, uh, color compression of images, right? So, uh, an- an image, uh,",
    "start": "484800",
    "end": "490845"
  },
  {
    "text": "here what you do is you have an image, and what you do is you think of each of its pixels. So you might have four million pixels,",
    "start": "490845",
    "end": "497900"
  },
  {
    "text": "right, in a 4k by 1k image. You have four million pixels. Each pixel is a 3-vector, uh,",
    "start": "497900",
    "end": "503355"
  },
  {
    "text": "which give you the R, G, and B, that's red, green, and blue intensity. Right? Um, now, for historical reasons,",
    "start": "503355",
    "end": "510770"
  },
  {
    "text": "those go between 0 and 255, but we'll just call them between 0 and 1. I mean, they actually it doesn't- it's not gonna make any difference.",
    "start": "510770",
    "end": "517745"
  },
  {
    "text": "It's just a three vector, right? Okay. So, um, if you cluster three vectors,",
    "start": "517745",
    "end": "523669"
  },
  {
    "text": "it's actually super-duper interesting, right? So you can actually cluster- uh, cluster the number of different colors,",
    "start": "523670",
    "end": "530944"
  },
  {
    "text": "uh, to maybe 100. Um, by the way, that's not that many, right?",
    "start": "530944",
    "end": "536810"
  },
  {
    "text": "Because these are 3-vectors. Uh, but you know, once you get 100, you- you actually images are that way,",
    "start": "536810",
    "end": "544080"
  },
  {
    "text": "and then the advantage, of course, is you don't have to give three real numbers for every pixel, you just say, oh,",
    "start": "544080",
    "end": "549290"
  },
  {
    "text": "that's cluster number 45, that one is- is cluster number 66 or something like that.",
    "start": "549290",
    "end": "554480"
  },
  {
    "text": "And so that- that's kind of the idea. That's used for compression, uh, because you can- say,",
    "start": "554480",
    "end": "560630"
  },
  {
    "text": "you can describe an image way faster if you have only 100 different colors. Okay. Um, here's another example,",
    "start": "560630",
    "end": "567465"
  },
  {
    "text": "is in- in finance. So each vector corresponds to a company, and my vector includes attributes of that company.",
    "start": "567465",
    "end": "575690"
  },
  {
    "text": "It could be, for example, the return of their stock last month, last year, you could have both of them.",
    "start": "575690",
    "end": "581060"
  },
  {
    "text": "It could be their total capitalization. It could be their price to earnings ratio.",
    "start": "581060",
    "end": "586815"
  },
  {
    "text": "It could- we could encode the sector they're in, right? So for example, if there- we can have a- a fe- we can have a feature that's either 0,",
    "start": "586815",
    "end": "594440"
  },
  {
    "text": "if you're not in the energy sector and 1, if you're in the energy sector, these are examples. Um, okay.",
    "start": "594440",
    "end": "600765"
  },
  {
    "text": "So this would be, uh, this- so the vectors correspond to companies, basically.",
    "start": "600765",
    "end": "607320"
  },
  {
    "text": "Um, and now, uh, what would happen is we would take, uh, these vectors, it might be 10,000 of them,",
    "start": "607320",
    "end": "613980"
  },
  {
    "text": "15,000, 30,000, and they might have each- I don't know, hundreds of attributes, and then we would cluster them, right?",
    "start": "613980",
    "end": "620280"
  },
  {
    "text": "And so, uh, this would be the idea, and so nearby vectors there mean companies that are similar,",
    "start": "620280",
    "end": "627430"
  },
  {
    "text": "uh, in terms of the attributes. It means they're probably kind of in the same area, um,",
    "start": "627430",
    "end": "634279"
  },
  {
    "text": "they have about the same capitalization, you know, this kind of thing, right? They- they're- they're- they're just similar.",
    "start": "634280",
    "end": "640899"
  },
  {
    "text": "And you could use this for lots and lots of things. Um, but in fact, what would appear when you do this kind of automatically,",
    "start": "640900",
    "end": "646800"
  },
  {
    "text": "are financial sectors, right? When you'd see companies that cluster together, those would be considered a- that- that's typically",
    "start": "646800",
    "end": "652730"
  },
  {
    "text": "called like a- a financial sector or something. Okay, so these are the examples. Um, we're gonna come back to the practical examples later,",
    "start": "652730",
    "end": "660199"
  },
  {
    "text": "because what we're gonna do now, is we're gonna talk about actually how to do clustering. Um, actually it's a huge field,",
    "start": "660200",
    "end": "665600"
  },
  {
    "text": "you're gonna take an entire course on nothing but how to do clustering. Um, but we're going to show you a shockingly simple algorithm that was one of the first,",
    "start": "665600",
    "end": "674420"
  },
  {
    "text": "and it's still very widely used. It, or actually variations on what we're about- we are about to show you are actually widely used right now.",
    "start": "674420",
    "end": "682680"
  },
  {
    "start": "682000",
    "end": "1025000"
  },
  {
    "text": "Okay. So the way this is gonna work, first- first the notation. And it's- it's not pretty, but it's just we have to be able to say to describe a clustering.",
    "start": "682680",
    "end": "691915"
  },
  {
    "text": "And so we're gonna describe a cluster in two different ways. One way is we're going to give, um, we're- we're gonna part- we're gonna take- so this- this is a set notation,",
    "start": "691915",
    "end": "700375"
  },
  {
    "text": "when you see that squiggly bracket that constructs a set. And so this is a set with n elements and the elements are the integers 1,",
    "start": "700375",
    "end": "708130"
  },
  {
    "text": "2, 3 up to capital N. Those are the indices of our- our vectors. Um, this symbol means that G is a subset of those, uh, G_j.",
    "start": "708130",
    "end": "716620"
  },
  {
    "text": "Um, and a subset means it is, well, it's just what it sounds like. It means that it is a selection of some of the entries there.",
    "start": "716620",
    "end": "724855"
  },
  {
    "text": "Okay? So for example, uh, okay, here's- let's say we have- I'll do something really simple here.",
    "start": "724855",
    "end": "732625"
  },
  {
    "text": "That's our- that- that it- it's just- here capital N is 4. So I have four vectors.",
    "start": "732625",
    "end": "737830"
  },
  {
    "text": "Um, and then I can have two groups. So I would have something like this: G_1 is 1 and 4,",
    "start": "737830",
    "end": "745450"
  },
  {
    "text": "and G_2 is 2 and 3. There. Okay? So that's an example of a clustering.",
    "start": "745450",
    "end": "752860"
  },
  {
    "text": "I- I put the first and last one together and I put the middle two together and that's my two groups. Okay. Now we're also gonna use, um, a c_i.",
    "start": "752860",
    "end": "762760"
  },
  {
    "text": "So c is a vector, which is capital N long. Um, and what we're gonna do,",
    "start": "762760",
    "end": "769180"
  },
  {
    "text": "c_i is going to give you the group that x_i is in.",
    "start": "769180",
    "end": "774190"
  },
  {
    "text": "So, in this case, uh, let's see. Um, so here, c_1 is gonna equal 1,",
    "start": "774190",
    "end": "782665"
  },
  {
    "text": "and c_2 equals 2, right? Because this says that entry item 1 is in group 1.",
    "start": "782665",
    "end": "790404"
  },
  {
    "text": "You can see that from here. And so c_1 is 1, c_2 equals 2, uh, c_3 equals 3, and c4 eq- whoa,",
    "start": "790405",
    "end": "797995"
  },
  {
    "text": "no, no, that is very wrong. This is 2, there we go. And 1, there we go. Sorry. [NOISE] Okay.",
    "start": "797995",
    "end": "803620"
  },
  {
    "text": "So, um, yeah, so these are- this is how we would- these are two ways that we'll use to describe the clusters, right?",
    "start": "803620",
    "end": "811735"
  },
  {
    "text": "Um, okay. Uh, now what we're gonna do is we're gonna have group representatives.",
    "start": "811735",
    "end": "817900"
  },
  {
    "text": "Um, and so these are vectors z_1 through z_k, remember we have k groups, and these vectors don't have to be in our original data.",
    "start": "817900",
    "end": "824904"
  },
  {
    "text": "In fact, generally, they are not. They're just arbitrary n-vectors, and we're gonna call them the group representatives.",
    "start": "824905",
    "end": "831190"
  },
  {
    "text": "We're gonna later see what they are, and actually, there's- by the way, by themselves, it's gonna be super interesting. But let's just take- look, they're just group representatives.",
    "start": "831190",
    "end": "837775"
  },
  {
    "text": "Okay. Now the cluster- the best, I mean, a- a very good way to actually kind of do anything is to make it an optimization problem.",
    "start": "837775",
    "end": "846805"
  },
  {
    "text": "So the way you do that is you say- what you're gonna do is you're gonna write down, uh, an objective function.",
    "start": "846805",
    "end": "853855"
  },
  {
    "text": "And in this case, we're gonna write down this objective function. I will talk about it momentarily.",
    "start": "853855",
    "end": "860245"
  },
  {
    "text": "But then the idea is we say that if this is smaller, if that objective is smaller,",
    "start": "860245",
    "end": "865480"
  },
  {
    "text": "we like that clustering better, okay? So, uh, you should be very suspicious of people who tell you about something",
    "start": "865480",
    "end": "871510"
  },
  {
    "text": "and launch into a method before they tell you what it is that would make them happy. So now I'm telling you what would make us happy.",
    "start": "871510",
    "end": "878035"
  },
  {
    "text": "What makes us happy is this J_clust, uh, being small.",
    "start": "878035",
    "end": "883225"
  },
  {
    "text": "And so that way there's no arguments, right? If you come up with another algorithm and I come up with an algorithm and",
    "start": "883225",
    "end": "888519"
  },
  {
    "text": "we evaluate our two clustering objectives, then who's ever is smaller,",
    "start": "888520",
    "end": "895360"
  },
  {
    "text": "is bet- their- their clustering is better, period. Okay? So this is kind of the- the approach.",
    "start": "895360",
    "end": "900970"
  },
  {
    "text": "In fact, it's the approach for a whole lot of, uh, of- of sort of, you know, mathematically-oriented methods, and- and frankly,",
    "start": "900970",
    "end": "906580"
  },
  {
    "text": "it's the correct approach, right? Otherwise, things get weird and vague and you'd say, \"I don't like your clustering, it doesn't look good.\"",
    "start": "906580",
    "end": "912820"
  },
  {
    "text": "And they say, \"Yeah, well, I don't like your clustering,\" and so on. Anyway, so fine. All right. So, um, let's look at this clustering.",
    "start": "912820",
    "end": "920365"
  },
  {
    "text": "What it- this cluster objective? So here's what it is. Um, what it does is it- it- it iterates over all of the data,",
    "start": "920365",
    "end": "927955"
  },
  {
    "text": "and for each- each vector x_i, it finds the distance squared to its representative, okay?",
    "start": "927955",
    "end": "937540"
  },
  {
    "text": "So that's the z_c_i. Uh, so that's- that's- so this is- this is the distance without the square,",
    "start": "937540",
    "end": "943450"
  },
  {
    "text": "that's the distance of item i to its cluster representative.",
    "start": "943450",
    "end": "948730"
  },
  {
    "text": "So that- that's how that works. Um, and this says that we should take the sum and squares of those things and",
    "start": "948730",
    "end": "954550"
  },
  {
    "text": "then we could divide by n. So you get a mean squared clustering objective, right? And so this is it.",
    "start": "954550",
    "end": "960715"
  },
  {
    "text": "So, you know, your job here, uh, well, here's your job. Your job is to choose the z_1 through z_k,",
    "start": "960715",
    "end": "967980"
  },
  {
    "text": "that's the cluster representatives, uh, and your other job is to choose, if you like, the c's,",
    "start": "967980",
    "end": "973830"
  },
  {
    "text": "which is the same as choosing the G's. So the c means you have to say for each item which cluster are you in.",
    "start": "973830",
    "end": "979315"
  },
  {
    "text": "So for item 22, are you in cluster 1, 2, 3, 4, 5, something like that.",
    "start": "979315",
    "end": "984325"
  },
  {
    "text": "So that this- this is gonna be your job is to do that. Okay. Uh, so that's- this is the clustering objective and it's perfectly reasonable, right.",
    "start": "984325",
    "end": "993385"
  },
  {
    "text": "Okay. Um, so that's gonna be our goal is to choose our clustering and representatives to minimize, uh, this number.",
    "start": "993385",
    "end": "1002040"
  },
  {
    "text": "And that's, uh, that's how we're gonna- we'll, I mean, we'll have an algorithm that does this and we're gonna monitor our progress by looking how- how J_cluster is,",
    "start": "1002040",
    "end": "1008970"
  },
  {
    "text": "is it going down, has it stopped decreasing, that sort of thing. And that's also how we're gonna compare two different methods for",
    "start": "1008970",
    "end": "1015090"
  },
  {
    "text": "example if we- if- if we tried two different methods or, uh, well- well, two different clustering- potential clusterings,",
    "start": "1015090",
    "end": "1021690"
  },
  {
    "text": "we'll judge them by this objective. Okay. So we're gonna now talk about the- an algorithm.",
    "start": "1021690",
    "end": "1029834"
  },
  {
    "start": "1025000",
    "end": "1035000"
  },
  {
    "text": "Uh, it's a very famous algorithm. It's actually very, very simple and yet very powerful.",
    "start": "1029835",
    "end": "1034995"
  },
  {
    "text": "Okay. So here's the way it's gonna work. Um, so what we're gonna do is we're gonna- we're gonna solve the problem not all at once.",
    "start": "1034995",
    "end": "1042870"
  },
  {
    "text": "Remember our job is to find the representatives and also the assignments to clusters. Those are the c_is, right?",
    "start": "1042870",
    "end": "1049380"
  },
  {
    "text": "So instead what we're gonna do is we're gonna break it down and- and- and try to figure out how to do one,",
    "start": "1049380",
    "end": "1055245"
  },
  {
    "text": "to how to choose, say, the assignments if you knew the representatives and how- and then the converse.",
    "start": "1055245",
    "end": "1060990"
  },
  {
    "text": "How would you choose the representatives if you knew the assignments? So we're gonna start right now saying, suppose we knew the representatives,",
    "start": "1060990",
    "end": "1067575"
  },
  {
    "text": "that's these, z_1 through z_k. So we're not gonna mess with it. They're- they're just fixed. And the question is,",
    "start": "1067575",
    "end": "1073035"
  },
  {
    "text": "what assignment would minimize the- the cluster, uh, the J_cluster, right?",
    "start": "1073035",
    "end": "1078600"
  },
  {
    "text": "And so the answer is actually easy, uh, to- to figure this out. Um, what happens is if you go back to the cost here,",
    "start": "1078600",
    "end": "1088815"
  },
  {
    "text": "um, you'll see that if we look at- so z, if- if I ask like, how do I which- let's- let's consider, uh,",
    "start": "1088815",
    "end": "1095730"
  },
  {
    "text": "entry i, um, uh, c_i appears nowhere else except that one entry.",
    "start": "1095730",
    "end": "1101325"
  },
  {
    "text": "And so what it really says is, uh, to make this as small as possible, I should choose- I should choose c_i to be the index corresponding to",
    "start": "1101325",
    "end": "1110399"
  },
  {
    "text": "the nearest neighbor of x_i in the representative set z_1 through z_k.",
    "start": "1110400",
    "end": "1116970"
  },
  {
    "text": "So that's what I should do. Okay? So- so that's the idea.",
    "start": "1116970",
    "end": "1122100"
  },
  {
    "start": "1119000",
    "end": "1334000"
  },
  {
    "text": "Um, and that's it. So we would- you'd say that this way. You will assign each vector to its nearest representative.",
    "start": "1122100",
    "end": "1128549"
  },
  {
    "text": "By the way, another way to say that is, if you haven't assigned- if you have not assigned the vector to its nearest z,",
    "start": "1128550",
    "end": "1135705"
  },
  {
    "text": "then in fact, uh, by assigning it to its nearest z, we can reduce J_clust or whatever, the cluster objective.",
    "start": "1135705",
    "end": "1143325"
  },
  {
    "text": "Okay? So this is- this makes perfect sense, uh, it's just perfect sense. Okay? Please note this is not solving the problem.",
    "start": "1143325",
    "end": "1150164"
  },
  {
    "text": "This is if you knew the rep- if you knew the representatives, the- the- the way to assign items to",
    "start": "1150165",
    "end": "1157500"
  },
  {
    "text": "the clusters is to assign them to their nearest neighbor among the representatives. And again, that makes just perfect sense.",
    "start": "1157500",
    "end": "1163980"
  },
  {
    "text": "Okay. Now we're gonna look at the other, uh, the other way around. Now suppose we fix- we fix the clusters,",
    "start": "1163980",
    "end": "1171960"
  },
  {
    "text": "that means every vector has been assigned to a cluster, and then the question is, how do you choose now the representatives to minimize our objective?",
    "start": "1171960",
    "end": "1181154"
  },
  {
    "text": "Okay. So, in this case, what we can do is the original objective is a sum over 1 over N,",
    "start": "1181155",
    "end": "1186780"
  },
  {
    "text": "but what we're gonna- uh, of- of n items, right? But what we're gonna do is gonna reor- we're gonna rearrange them and- and collect all the terms together that are in each cluster.",
    "start": "1186780",
    "end": "1194835"
  },
  {
    "text": "And so what it is is that the cluster objective, which is the mean square, uh, mean square distance to your representative,",
    "start": "1194835",
    "end": "1201315"
  },
  {
    "text": "we're gonna write it as a sum of k different numbers, um, and each of these pertains only to cluster j.",
    "start": "1201315",
    "end": "1211815"
  },
  {
    "text": "So let's look at this notation. This says that I should sum over x_i minus z_j,",
    "start": "1211815",
    "end": "1217950"
  },
  {
    "text": "but I- I'm only gonna look at one- the i that are in G_j. That means that is the items which are assigned to group j.",
    "start": "1217950",
    "end": "1225255"
  },
  {
    "text": "Okay? So that's what this sum here means. Um, and I put a 1 over N in- in front of it,",
    "start": "1225255",
    "end": "1230790"
  },
  {
    "text": "that- that- that- I got that from the original one. Okay. Now, then the question would be this;",
    "start": "1230790",
    "end": "1235934"
  },
  {
    "text": "how do you choose, let's say for example, z_j? Well, z_j only affects one of these,",
    "start": "1235935",
    "end": "1242175"
  },
  {
    "text": "which is J_j, right? And then, it's this thing.",
    "start": "1242175",
    "end": "1247470"
  },
  {
    "text": "And so we're left with the question, how do you- if I give you a set of vectors,",
    "start": "1247470",
    "end": "1252654"
  },
  {
    "text": "namely the x_i's that are in partition- in- in partition J in J_j,",
    "start": "1252654",
    "end": "1258245"
  },
  {
    "text": "group J, then the question is, how do you choose a single number that minimizes the mean squared distance to them?",
    "start": "1258245",
    "end": "1263745"
  },
  {
    "text": "Um, now that has a very simple ans- say a very simple solution which, you know,",
    "start": "1263745",
    "end": "1268815"
  },
  {
    "text": "in the book we describe, uh, worked it out or whatever, and it's completely intuitive; it's the mean.",
    "start": "1268815",
    "end": "1273960"
  },
  {
    "text": "In other words, if someone says, how do you find a vector that minimizes the mean squared distance to a set of other vectors,",
    "start": "1273960",
    "end": "1280200"
  },
  {
    "text": "you simply average all those vectors and that's- that's the solution of that problem. Okay. So that says z_j is literally the representative,",
    "start": "1280200",
    "end": "1289124"
  },
  {
    "text": "is the average of the vectors in its group. Makes per- again, this is completely natural.",
    "start": "1289124",
    "end": "1295365"
  },
  {
    "text": "Now, I want to point out that at this point, we have absolutely not solved the problem because we've been asked",
    "start": "1295365",
    "end": "1300779"
  },
  {
    "text": "to optimize over both the partition and the representatives. Now, all we know how to do, but at least we know how to do.",
    "start": "1300780",
    "end": "1307890"
  },
  {
    "text": "We know how to do two things pretty well. If you fix the representatives, we know how to- we know how to, um, choose the clustering.",
    "start": "1307890",
    "end": "1314685"
  },
  {
    "text": "If we know the clustering, we know how to choose the representatives. And now we're gonna learn something very famous in mathematics- algorithmic mathematics anyway, uh,",
    "start": "1314685",
    "end": "1321810"
  },
  {
    "text": "when you can't really solve the problem but you can do one [LAUGHTER] you- you know how to solve part of it if one thing is fixed and,",
    "start": "1321810",
    "end": "1328320"
  },
  {
    "text": "you know, they converse, right? And that's just called iteration. It's- it's really, it- it's- it's pretty dumb.",
    "start": "1328320",
    "end": "1333855"
  },
  {
    "text": "And that gives us to- brings us to a very famous algorithm, it's called k-means.",
    "start": "1333855",
    "end": "1338929"
  },
  {
    "start": "1334000",
    "end": "1487000"
  },
  {
    "text": "Uh, that's actually from the '60s. Uh, but like, actually, like a lot of things when you start looking,",
    "start": "1338930",
    "end": "1343955"
  },
  {
    "text": "the history goes back, uh, older than that and the ideas were certainly there. All right. So here's the- here's the way it's gonna work. It's very simple.",
    "start": "1343955",
    "end": "1350500"
  },
  {
    "text": "Uh, we are gonna alternate between updating the partition, that means literally assign each item to its cluster.",
    "start": "1350500",
    "end": "1359115"
  },
  {
    "text": "Sorry, to- you assign each item to the cluster which corresponding to the closest representative. Okay?",
    "start": "1359115",
    "end": "1368265"
  },
  {
    "text": "Then we're going to update the representatives. And to do that, it's simple, we'd simply- for each group we are going",
    "start": "1368265",
    "end": "1376020"
  },
  {
    "text": "to look at- we're going to set- set the representative to be the average of that group. Okay, that's a famous algorithm.",
    "start": "1376020",
    "end": "1382530"
  },
  {
    "text": "And in fact, what happens is in every single step our objective goes down. That's good because it makes us happy when our objective is small.",
    "start": "1382530",
    "end": "1390045"
  },
  {
    "text": "And the reason is pretty clear, right? That in the first step, when I assign each element.",
    "start": "1390045",
    "end": "1395760"
  },
  {
    "text": "If I- if I move an element, if an element had been in group 3 of a vector had been in group 3 and I move it to group 6 because the group 6 centroid is closer,",
    "start": "1395760",
    "end": "1403470"
  },
  {
    "text": "my objective is going to go down. Same for- same for the other part. The second step that if I update the representatives by assigning them to be the mean,",
    "start": "1403470",
    "end": "1413520"
  },
  {
    "text": "once again, the objective goes down. Okay, so here's the algorithm, here's- here's how we're going to write it.",
    "start": "1413520",
    "end": "1419625"
  },
  {
    "text": "It says that we should simply update the partition. So you find the nearest neighbor.",
    "start": "1419625",
    "end": "1425220"
  },
  {
    "text": "And then you update the centroids. And what will happen is at some point um,",
    "start": "1425220",
    "end": "1430845"
  },
  {
    "text": "you're going to get to the point where the partition doesn't change and thereafter nothing will ever happen, right? That- that's- that's- in other words,",
    "start": "1430845",
    "end": "1437955"
  },
  {
    "text": "every item is assigned to its nearest neighbor. That nearest neighbor among the representatives, number 1.",
    "start": "1437955",
    "end": "1444885"
  },
  {
    "text": "And number 2, each centroid is the average of its entries. The entries in its group.",
    "start": "1444885",
    "end": "1451010"
  },
  {
    "text": "Okay? Each, sorry, each- each representative or centroid. I should say that, the centroid here is",
    "start": "1451010",
    "end": "1456890"
  },
  {
    "text": "an alternate- alternate name for the representative, or mean. Okay. So- and then when it stops,",
    "start": "1456890",
    "end": "1463110"
  },
  {
    "text": "we just- then we quit if the part- if the partition is the same on 2. You know, if the partition doesn't update then there's nothing to do.",
    "start": "1463110",
    "end": "1470025"
  },
  {
    "text": "And we quit because nothing's ever going to change again. So that's the k-means algorithm, very famous algorithm. Oh, and notice that it- to- to understand this,",
    "start": "1470025",
    "end": "1479175"
  },
  {
    "text": "you only need to know a very little bit, you know what a vector is, and you know what the distance between two vectors is.",
    "start": "1479175",
    "end": "1484320"
  },
  {
    "text": "It's- I mean it's not much. Okay. Now let's see.",
    "start": "1484320",
    "end": "1489870"
  },
  {
    "start": "1487000",
    "end": "1602000"
  },
  {
    "text": "As I said, the objective goes down every step until they stop changing, right?",
    "start": "1489870",
    "end": "1495330"
  },
  {
    "text": "Now, one thing about this is that- you know, you might think this would actually solve the problem.",
    "start": "1495330",
    "end": "1501765"
  },
  {
    "text": "Um, okay, so now the fact is it does not. We will even see specific examples",
    "start": "1501765",
    "end": "1508814"
  },
  {
    "text": "where the algorithm stops and it is not the optimal clustering. Optimal clustering means that,",
    "start": "1508814",
    "end": "1515640"
  },
  {
    "text": "that clustering- there's no clustering that has in set a choice of representative, it has a lower objective.",
    "start": "1515640",
    "end": "1521265"
  },
  {
    "text": "And we'll see that that's just not the case. So it doesn't actually solve the problem.",
    "start": "1521265",
    "end": "1526695"
  },
  {
    "text": "And so when you have an algorithm, that's not guaranteed to really fully, completely solve your problem.",
    "start": "1526695",
    "end": "1531750"
  },
  {
    "text": "It's called a heuristic, okay? Um, and there's many heuristics around.",
    "start": "1531750",
    "end": "1538260"
  },
  {
    "text": "Uh, I mean, honestly, it's obviously better to have an algorithm that solves- that solves something exactly.",
    "start": "1538260",
    "end": "1543435"
  },
  {
    "text": "I mean- of course, because then you don't have to worry about it. There's no worry. But there are many, many cases where basically we can't do that.",
    "start": "1543435",
    "end": "1551235"
  },
  {
    "text": "And so we resort to heuristics. And- and heuristics can be extremely powerful. And this is one of the cases where it works uh, very,",
    "start": "1551235",
    "end": "1559185"
  },
  {
    "text": "very well. Okay- okay. So one- one fact about that is,",
    "start": "1559185",
    "end": "1564990"
  },
  {
    "text": "for example, depending on how you initialize the algorithm, right? You initialize it either with some representatives or with",
    "start": "1564990",
    "end": "1570450"
  },
  {
    "text": "an assignment to- of assignment of items to clusters. Depending on how you do that, that can actually affect the final result.",
    "start": "1570450",
    "end": "1577410"
  },
  {
    "text": "Okay. And what people do uh, sometimes is, they run k-means like 10 times,",
    "start": "1577410",
    "end": "1582450"
  },
  {
    "text": "let's say with different- different initializations, they let it converge. And then among those 10,",
    "start": "1582450",
    "end": "1587789"
  },
  {
    "text": "they just choose the one that has the lowest value of J clust, because that's a kind of what we're after. Okay, so this- that's the idea.",
    "start": "1587790",
    "end": "1593985"
  },
  {
    "text": "But as we remembered that depending on how you initialize it, you- you can get different clusterings. Okay, so that's just the way this works.",
    "start": "1593985",
    "end": "1601919"
  },
  {
    "text": "Okay. We're going to look at an example. Now, the first one's going to be an abstract example.",
    "start": "1601920",
    "end": "1608054"
  },
  {
    "start": "1602000",
    "end": "1897000"
  },
  {
    "text": "In fact, that's the example we started with uh, at the beginning of the lecture. And so what we're going to do is we're going to take this data.",
    "start": "1608055",
    "end": "1613980"
  },
  {
    "text": "Now, of course, this data, it had- it's in two vectors, and the right way to cluster 2 vectors is with your eyeball and draw.",
    "start": "1613980",
    "end": "1621390"
  },
  {
    "text": "Okay? But we're just going to see how we're going to walk through k-means and see how it- see what it does in this case.",
    "start": "1621390",
    "end": "1627150"
  },
  {
    "text": "Okay. So here we go. So we initialize it with these cluster representatives, okay?",
    "start": "1627150",
    "end": "1636440"
  },
  {
    "text": "I don't know why, but we did. Okay, there's just three- three different vectors, the red- the red,",
    "start": "1636440",
    "end": "1642545"
  },
  {
    "text": "the blue, and the green square. Okay? Then wha- what's happened here is I have- I have colored",
    "start": "1642545",
    "end": "1650015"
  },
  {
    "text": "the points according to their nearest neighbor among those three.",
    "start": "1650015",
    "end": "1655460"
  },
  {
    "text": "So if you're a green point, like all these guys are green down here. They're green because they are closest- they're closer to",
    "start": "1655460",
    "end": "1662000"
  },
  {
    "text": "the green centroid representative than the red or the blue. And up here this is just sad, it's very sad.",
    "start": "1662000",
    "end": "1668279"
  },
  {
    "text": "It's just two points that are closer- closest to the red- the red representative than the blue or green.",
    "start": "1668280",
    "end": "1675809"
  },
  {
    "text": "Okay, now, the next step you'll recall is we now update the centroids. And what that means is- or the representatives.",
    "start": "1675810",
    "end": "1682485"
  },
  {
    "text": "That means that among all of these green ones here, we're going to calculate the average and that's going to be our updated-",
    "start": "1682485",
    "end": "1688845"
  },
  {
    "text": "our updated representative for greens and you know, look, eyeball. There's something in the center, okay?",
    "start": "1688845",
    "end": "1694155"
  },
  {
    "text": "It's like right there. Okay. Well, okay. Here's where it is exactly. Okay. So that's- that's the- that's the updated green centroid.",
    "start": "1694155",
    "end": "1703290"
  },
  {
    "text": "Okay, or representative. All right. The blue is going to shift over to here. And you can see that- that blue thing is kind in the center of where the blue things are.",
    "start": "1703290",
    "end": "1711285"
  },
  {
    "text": "And- okay, it's kind of pathetic. There's two points and the- the average of the two is a point right smack in the middle.",
    "start": "1711285",
    "end": "1718830"
  },
  {
    "text": "And so this red- this sample red box here uh, is telling us it's- it is- it is now the average of its two- its two constituents.",
    "start": "1718830",
    "end": "1728655"
  },
  {
    "text": "Okay, that's iteration one. That- if you look at that, that is a pretty bad clustering right there.",
    "start": "1728655",
    "end": "1734355"
  },
  {
    "text": "But the point is we're going to iterate. So that's iteration one. Let's look at iteration two. On the next step, things are getting a little more reasonable because",
    "start": "1734355",
    "end": "1742230"
  },
  {
    "text": "now what we do is we go back and for every data point, we- we fix the new centroids which are here, here, and here.",
    "start": "1742230",
    "end": "1749340"
  },
  {
    "text": "And we now go back and we asked every point, which one are you nearest, and then that's your color.",
    "start": "1749340",
    "end": "1755295"
  },
  {
    "text": "Or if that's your assignment, group assignment. And uh, we do that. And now you see, well, we've got a big old group down here.",
    "start": "1755295",
    "end": "1761670"
  },
  {
    "text": "We've got a few more reds. And then we update the centers. And so now the- these- these update this way and we keep going.",
    "start": "1761670",
    "end": "1769530"
  },
  {
    "text": "Okay, so um, this is iteration three. Here's iteration 10, and you can see we're getting there, right?",
    "start": "1769530",
    "end": "1778020"
  },
  {
    "text": "So by now- I mean it's still a bit wrong, right? You can see that these green things morally should be blue and so on.",
    "start": "1778020",
    "end": "1786299"
  },
  {
    "text": "This little bottom down here, morally should be read and by morally. Um- I'm just joking, it means like our eyeball can see what the clustering is.",
    "start": "1786300",
    "end": "1794355"
  },
  {
    "text": "And what it is- you know, if you go like up to iteration 15, the thing just stops, and that's the final clustering you get, right?",
    "start": "1794355",
    "end": "1801195"
  },
  {
    "text": "And so there it is. And you know, you might quibble with it. You might say, that green point maybe should be red whatever.",
    "start": "1801195",
    "end": "1808620"
  },
  {
    "text": "But that the point is, you know, that this is the final clustering. Now, of course, this is- this is to just to walk you through what it looks like.",
    "start": "1808620",
    "end": "1818190"
  },
  {
    "text": "What- what- how k-means works. Obviously, the point of k-means is not to cluster two vectors,",
    "start": "1818190",
    "end": "1825480"
  },
  {
    "text": "because you can do that with your eyeball and a pencil. Okay? So that's not the point. Uh, the point is this algorithm works in dimension 10,",
    "start": "1825480",
    "end": "1832230"
  },
  {
    "text": "and it works in dimension of a 100 or a 1000 or a million, right? Um, if Amazon clusters their customers,",
    "start": "1832230",
    "end": "1840405"
  },
  {
    "text": "there's a whole lot of customers and a whole lot of items that they may have bought last month, right?",
    "start": "1840405",
    "end": "1845760"
  },
  {
    "text": "So you know, these are very very big problems, and this- is the- basically the exact same algorithm just runs.",
    "start": "1845760",
    "end": "1853545"
  },
  {
    "text": "Okay, so that's that. Okay. All right.",
    "start": "1853545",
    "end": "1857800"
  },
  {
    "text": "Let's look at how this algorithm converges as a- as a function of iterations.",
    "start": "1858620",
    "end": "1864360"
  },
  {
    "text": "Well, this is J-clust and remember the whole point of having an objective is so we know when we're happier or not, right?",
    "start": "1864360",
    "end": "1871170"
  },
  {
    "text": "So on the first step it goes down, it kind of makes some little baby progress.",
    "start": "1871170",
    "end": "1876240"
  },
  {
    "text": "And all of a sudden ooh, it goes down here. And then this is- this ends up being our final clustering objective.",
    "start": "1876240",
    "end": "1882090"
  },
  {
    "text": "And it's about whatever it is- it's about 0.1, oh, I don't know, 0.3- 0.35.",
    "start": "1882090",
    "end": "1887205"
  },
  {
    "text": "I don't know. So- so that's how k-means ran  on this thing. And this is actually kind of typical.",
    "start": "1887205",
    "end": "1894100"
  }
]