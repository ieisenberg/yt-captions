[
  {
    "start": "0",
    "end": "5150"
  },
  {
    "text": "OK. So let's remind ourselves\nwhere we left off last time. So last time, we\nstarted with looking",
    "start": "5150",
    "end": "11690"
  },
  {
    "text": "at the GPS signal model, which\nis given by this equation. Pretty straightforward.",
    "start": "11690",
    "end": "17699"
  },
  {
    "text": "So it's like a signal that\nis modulated with in phase and a quadrature component.",
    "start": "17700",
    "end": "23869"
  },
  {
    "text": "There is a carrier\nfrequency f sub c. So you have cosine 2 pi fct\nfor the carrier of in phase,",
    "start": "23870",
    "end": "30980"
  },
  {
    "text": "and then the quadrature\nis sine 2 pi fct. And then there is two\nsignals basically being",
    "start": "30980",
    "end": "39290"
  },
  {
    "text": "simultaneously modulated\non top of the carrier. There's an x, which\nis a ranging code,",
    "start": "39290",
    "end": "45890"
  },
  {
    "text": "and there is a d, which\nis a navigation signal. And we said that the ranging\nencodes are typically",
    "start": "45890",
    "end": "52100"
  },
  {
    "text": "modulated very fast, so\nfrom a megabits per second to tens of megabits per second,\nand the navigation signals",
    "start": "52100",
    "end": "60620"
  },
  {
    "text": "are modulated very slowly,\nso tens of bits per second. Like 50 bits per second, 100\nbits per second, they're slow.",
    "start": "60620",
    "end": "69170"
  },
  {
    "text": "And just by the virtue of\nthat this major difference",
    "start": "69170",
    "end": "74900"
  },
  {
    "text": "between the modulation\nspeeds, the receiver can basically distinguish\nwhat's x and what is d?",
    "start": "74900",
    "end": "82460"
  },
  {
    "text": "And we talked about some pretty\nboring but important stuff, which was different\nranging codes.",
    "start": "82460",
    "end": "89270"
  },
  {
    "text": "And some of them were\nthe legacy signals, which are still\nbeing transmitted,",
    "start": "89270",
    "end": "94520"
  },
  {
    "text": "and then the modern signals. So this course\nacquisition and the P(Y) are the civilian and military\nlegacy ranging codes.",
    "start": "94520",
    "end": "104360"
  },
  {
    "text": "And then we have the\nM, L1C, L2C, and L5, which are the modern\nversions basically.",
    "start": "104360",
    "end": "109740"
  },
  {
    "text": "And then we talked a bit\nabout the navigation signals. So again, there is the\nlegacy, which is LNAV,",
    "start": "109740",
    "end": "117140"
  },
  {
    "text": "and then there is the military\nand civilian modern navigation signals, MNAV and CNAV.",
    "start": "117140",
    "end": "123409"
  },
  {
    "text": "And these navigation\nsignals, what's important about them is\nthat these are-- basically,",
    "start": "123410",
    "end": "129679"
  },
  {
    "text": "they're human understandable\ninformation in it. So it's like data\npackets with messages",
    "start": "129680",
    "end": "137390"
  },
  {
    "text": "that are things like\ndate, time, the satellite status is in there. And then two very important\nparts of each navigation signal",
    "start": "137390",
    "end": "147590"
  },
  {
    "text": "packet is what is called\nthe ephomeris, which, as we'll see today, tells the\nreceiver about the satellite",
    "start": "147590",
    "end": "155690"
  },
  {
    "text": "position in orbit because the\nreceiver needs to know that. And then there's what is\ncalled the Almanac, which",
    "start": "155690",
    "end": "161810"
  },
  {
    "text": "gives basically the status and\nsome low resolution orbital information about the\nrest of the satellites",
    "start": "161810",
    "end": "167959"
  },
  {
    "text": "in the constellation, OK? Any questions on this\nbefore we continue?",
    "start": "167960",
    "end": "174909"
  },
  {
    "text": "OK. So today, the topic is-- basically, there's two things,\nwhich are hopefully not boring.",
    "start": "174910",
    "end": "182453"
  },
  {
    "text": "I think these are exciting\nstuff and very important. And one is we are going to\ntalk about the satellite orbits",
    "start": "182453",
    "end": "188959"
  },
  {
    "text": "and specifically how this\nephomeris information is used to find the satellite\nlocation in orbit,",
    "start": "188960",
    "end": "195380"
  },
  {
    "text": "and then we will talk\nabout these ranging codes and the mathematics behind\nthem and how they actually",
    "start": "195380",
    "end": "201980"
  },
  {
    "text": "are used to find time of flight\ninformation and then ranges.",
    "start": "201980",
    "end": "207599"
  },
  {
    "text": "OK. So let's get started\nwith the satellite orbit.",
    "start": "207600",
    "end": "215150"
  },
  {
    "text": "So what's important\ngenerally when it comes to sensing and then\nspecifically for the GPS is",
    "start": "215150",
    "end": "221450"
  },
  {
    "text": "that whenever there is a\nsensor that's operating and there's some sensing\ninformation coming in,",
    "start": "221450",
    "end": "228319"
  },
  {
    "text": "we should specify\nwhat coordinate system was used for\nthe measurements or what reference\nframe was used?",
    "start": "228320",
    "end": "234533"
  },
  {
    "text": "And it says this is very\nimportant, especially in robotics because you have\nmultiple sensors on a robot,",
    "start": "234533",
    "end": "240739"
  },
  {
    "text": "and each sensor has its\nlocal reference frame. And sometimes, you\nneed to translate information between\ndifferent reference",
    "start": "240740",
    "end": "247490"
  },
  {
    "text": "frames of different sensors. For the GPS, it's\nslightly more complicated because it's a\ndistributed system.",
    "start": "247490",
    "end": "253890"
  },
  {
    "text": "So you have your receivers on\nthe Earth, which is rotating, and then you have these\nsatellites in orbit",
    "start": "253890",
    "end": "260060"
  },
  {
    "text": "that are not bound to the\nEarth coordinates directly, OK? So that's why we need\nto be very careful",
    "start": "260060",
    "end": "266300"
  },
  {
    "text": "about the coordinate systems\nand the reference frames. So specifically, there are\nthree coordinate systems",
    "start": "266300",
    "end": "272780"
  },
  {
    "text": "associated with the GPS\nthat we'll talk about. The first one is\nthe Earth centered",
    "start": "272780",
    "end": "278210"
  },
  {
    "text": "fixed coordinate system or\nthe geocentric system as it's called, and it's a\nCartesian coordinate system,",
    "start": "278210",
    "end": "285949"
  },
  {
    "text": "so you get the x, y, z. And the way it\nworks is that it's centered at the center\nof mass the Earth,",
    "start": "285950",
    "end": "293030"
  },
  {
    "text": "and then the x-axis points to\nthe Prime Meridian or the 0",
    "start": "293030",
    "end": "298460"
  },
  {
    "text": "degree longitude. Your y-axis points\nto 90 degrees, and the z-axis points to\nthe geographical North Pole.",
    "start": "298460",
    "end": "305240"
  },
  {
    "text": "And this coordinate system, the\nreason it's called Earth fixed is that it rotates with Earth. That's very important.",
    "start": "305240",
    "end": "310919"
  },
  {
    "text": "So if you are on the\nsurface of the Earth and you're not moving your\ngeocentric coordinates",
    "start": "310920",
    "end": "316910"
  },
  {
    "text": "will not change over time\nbecause your coordinate system is rotating with Earth.",
    "start": "316910",
    "end": "322250"
  },
  {
    "text": "So it's not an inertial\ncoordinate system. So this is the coordinate\nsystem that the GPS uses",
    "start": "322250",
    "end": "329420"
  },
  {
    "text": "when it's doing localization. It basically solves\nthe equations in this coordinate system\nand finds an x, y, z",
    "start": "329420",
    "end": "335690"
  },
  {
    "text": "location for the receiver. Now, for historical\npurposes, when",
    "start": "335690",
    "end": "341000"
  },
  {
    "text": "it comes to mapping\non the Earth, because the Earth is\nnot a flat surface,",
    "start": "341000",
    "end": "347849"
  },
  {
    "text": "it's actually an\nellipsoid, people use a different\ncoordinate system, which",
    "start": "347850",
    "end": "353360"
  },
  {
    "text": "is a polar system, and\nthat's the latitude longitude and height system. So for instance, if you\nlook at any map-- let's",
    "start": "353360",
    "end": "359060"
  },
  {
    "text": "look at a quick one together. So this grid that you see on the\nmap, this is not a Cartesian.",
    "start": "359060",
    "end": "364750"
  },
  {
    "text": "This is your-- you have\nbasically your latitude and longitude\nangles with respect",
    "start": "364750",
    "end": "369830"
  },
  {
    "text": "to coordinate system\nthat is called geodetic. So for this reason, any GPS,\nafter it solves the equations",
    "start": "369830",
    "end": "378770"
  },
  {
    "text": "and finds the xyz\nposition, it needs to translate it to\nthis system and find",
    "start": "378770",
    "end": "384110"
  },
  {
    "text": "the latitude, longitude,\nand the height so it becomes basically\ncompatible with the maps that",
    "start": "384110",
    "end": "389350"
  },
  {
    "text": "exist. So for instance, if you want\nto-- if you go to Google Maps and you want to find\nwhere something is,",
    "start": "389350",
    "end": "398720"
  },
  {
    "text": "it doesn't take\nx, y, z from you. It asks for latitude\nand longitude. So that's how maps work,\nand then every receiver",
    "start": "398720",
    "end": "405770"
  },
  {
    "text": "needs to basically,\nafter finding the Cartesian\ncoordinates, translate it to this polar coordinates.",
    "start": "405770",
    "end": "412380"
  },
  {
    "text": "So the geodetic system, again-- so for any position with the\ngeocentric, it's an x, y, z.",
    "start": "412380",
    "end": "420710"
  },
  {
    "text": "It's a Cartesian system. And then in the\ngeodetic coordinates, you get a lambda that is\nyour longitude, the phi that",
    "start": "420710",
    "end": "429080"
  },
  {
    "text": "is the latitude-- so\nthese are two angles, and then there is an h which\nis the height from the surface",
    "start": "429080",
    "end": "434960"
  },
  {
    "text": "of the Earth, OK? Now very, very important\nabout the geodetic system",
    "start": "434960",
    "end": "441169"
  },
  {
    "text": "is the fact that the Earth\nis not a perfect sphere. So when you want to work\nwith these coordinates,",
    "start": "441170",
    "end": "448130"
  },
  {
    "text": "you need to have a model of the\ngeometry of the Earth, which is an ellipsoid as we know.",
    "start": "448130",
    "end": "454057"
  },
  {
    "text": "There is different models\nthat have been developed which very accurately\nbasically describe the shape of the Earth.",
    "start": "454057",
    "end": "460159"
  },
  {
    "text": "Specifically, the one\nthat most GPS systems use is called the World Geodetic\nSystem 1984 or WGS 1984.",
    "start": "460160",
    "end": "468230"
  },
  {
    "text": "There is a lot of\ninformation in this. If you look it up, there's a\nton of stuff about the geometry",
    "start": "468230",
    "end": "473840"
  },
  {
    "text": "of the Earth. It even describes the\ngravitational field around the Earth and\nso on and so forth. But what's important for\nGPS systems is basically",
    "start": "473840",
    "end": "482270"
  },
  {
    "text": "just the shape of this\nellipsoid, which is described by a major and a minor axis.",
    "start": "482270",
    "end": "488520"
  },
  {
    "text": "So A and B, the exact\nvalues are given here. And then from there you can\nalso calculate and extend",
    "start": "488520",
    "end": "494180"
  },
  {
    "text": "eccentricity, which is\nlike how much it deviates from a perfect sphere basically,\nthat's what the E is, OK?",
    "start": "494180",
    "end": "503120"
  },
  {
    "text": "So let's look at graphically\nhow these two coordinate systems",
    "start": "503120",
    "end": "508820"
  },
  {
    "text": "or reference frames are related. So here, there is a\npicture of the ellipsoid,",
    "start": "508820",
    "end": "514469"
  },
  {
    "text": "which is the Earth. And then relative\nto this, let's first look at our geocentric system,\nwhich is these blue axes.",
    "start": "514470",
    "end": "521909"
  },
  {
    "text": "So there is an x, there's\na y, and there's a z. And as I said, the x points\ntowards your Prime Meridian",
    "start": "521909",
    "end": "527790"
  },
  {
    "text": "or 0 degree longitude,\nyour y-axis points to 90 degrees East\nlongitude, and the z access",
    "start": "527790",
    "end": "534390"
  },
  {
    "text": "points to the\ngeographical North. And again, remember that\nthis one rotates with Earth.",
    "start": "534390",
    "end": "540690"
  },
  {
    "text": "It's an Earth fixed system. Now, if you have some point--\nlet's zoom in into this point.",
    "start": "540690",
    "end": "546030"
  },
  {
    "text": "You have some position\nPR that is not exactly on the surface of\nthis ellipsoid,",
    "start": "546030",
    "end": "552930"
  },
  {
    "text": "so this one in the\ngeocentric coordinates, it has an x, y, Z.\nAnd the way it--",
    "start": "552930",
    "end": "559020"
  },
  {
    "text": "basically, you can\nfind the geodetic or the polar coordinates of it. The height is basically\njust the distance",
    "start": "559020",
    "end": "565170"
  },
  {
    "text": "from this point to the\nsurface of the ellipsoid. Now, if you extrapolate\nthis line that is",
    "start": "565170",
    "end": "572370"
  },
  {
    "text": "perpendicular to the surface-- so that becomes\nthis orange line, and then we are just going to\ncontinue it, at some point,",
    "start": "572370",
    "end": "578130"
  },
  {
    "text": "it's going to intersect your\nbasically equatorial plane. And it's very important\nyou see this line does not",
    "start": "578130",
    "end": "585570"
  },
  {
    "text": "go through the center of\ncenter of mass of the Earth. This is not an error\nin the graphics.",
    "start": "585570",
    "end": "591520"
  },
  {
    "text": "This is because it\nis an ellipsoid. If it was a perfect\nsphere, the line would go through the center.",
    "start": "591520",
    "end": "597690"
  },
  {
    "text": "Now, you continue this\nline, and the angle it makes with the equatorial\nplane, that is your latitude,",
    "start": "597690",
    "end": "604480"
  },
  {
    "text": "so that's the phi, and then\nthe lambda is if you basically",
    "start": "604480",
    "end": "609779"
  },
  {
    "text": "project down this point\nto your xy plane, then",
    "start": "609780",
    "end": "616530"
  },
  {
    "text": "the angle it makes here, that\nis your Lambda or longitude, OK?",
    "start": "616530",
    "end": "622150"
  },
  {
    "text": "So this is graphically how\nthe two coordinate systems are related. Again, remember that you get--",
    "start": "622150",
    "end": "629050"
  },
  {
    "text": "we will see out of\nsolving your equations, you get Cartesian coordinates\nin geocentric reference frame,",
    "start": "629050",
    "end": "635620"
  },
  {
    "text": "and then you need to\ntranslate them or convert them to the geodetic to get\nthe latitude, longitude,",
    "start": "635620",
    "end": "641820"
  },
  {
    "text": "and height. And then you can use\nany map of the Earth and find where you\nare on the map. That's how it works.",
    "start": "641820",
    "end": "648250"
  },
  {
    "text": "So there is equations for\ngoing basically back and forth between the two reference frames\nor two coordinate systems.",
    "start": "648250",
    "end": "656190"
  },
  {
    "text": "Here are the\nequations to go from the geodetic to\ngeocentric, which is not what the receiver does.",
    "start": "656190",
    "end": "662820"
  },
  {
    "text": "So the receiver needs to\ngo the other way around. It finds things in\ngeocentric coordinates and it needs to go to geodetic.",
    "start": "662820",
    "end": "668670"
  },
  {
    "text": "But I've included\nthese just so you know. Pretty straightforward. So this is like--",
    "start": "668670",
    "end": "674010"
  },
  {
    "text": "just plug-in numbers basically. So say you have your longitude\nlambda, your latitude phi,",
    "start": "674010",
    "end": "680130"
  },
  {
    "text": "and your height\nh, and then there is this radius of curvature\nthat you can calculate. That's the radius of curvature\nat the point you are on Earth.",
    "start": "680130",
    "end": "688410"
  },
  {
    "text": "That's n, and you just plug-in\neverything into these three equations and you\nget your z, which",
    "start": "688410",
    "end": "693930"
  },
  {
    "text": "is the coordinates in the\ngeocentric coordinate system. Pretty straightforward.",
    "start": "693930",
    "end": "699580"
  },
  {
    "text": "And this is pure geometry. I mean, the picture\nyou saw in the slide before, you can basically-- if\nyou do some geometry carefully,",
    "start": "699580",
    "end": "706830"
  },
  {
    "text": "you can derive this. Not that you have to, but\nthere's really no magic here. It's just pure geometry.",
    "start": "706830",
    "end": "712890"
  },
  {
    "text": "Now, as I said, what\nthe receiver needs to do is the other way around. So it needs to go\nfrom the geocentric to",
    "start": "712890",
    "end": "718830"
  },
  {
    "text": "the geodetic coordinate system. And these are the\nequations for it. So you have your x, y, z and\nyou want to translate them",
    "start": "718830",
    "end": "725820"
  },
  {
    "text": "to Lambda, phi, and h. Lambda, the longitude, is easy. It's just the arctan\nof basically y over x.",
    "start": "725820",
    "end": "733800"
  },
  {
    "text": "We're doing the arctan just\nto take care of the fact that lambda can be\nanywhere from 0 to 360.",
    "start": "733800",
    "end": "740890"
  },
  {
    "text": "So you have to take account\nfor the sine of x and y to be able to tell in which\nquadrant you fall basically",
    "start": "740890",
    "end": "748440"
  },
  {
    "text": "on the plane. Now, phi and h, it's a\nslightly more complicated. Because if you look at\nthese two equations,",
    "start": "748440",
    "end": "754410"
  },
  {
    "text": "the phi depends on the h in\nthis very nonlinear manner. So it has arctan and inside\nthe argument, there's h.",
    "start": "754410",
    "end": "761520"
  },
  {
    "text": "And also h, in a very nonlinear\nway, depends on your phi. So basically, your longitude and\nheight or latitude and height",
    "start": "761520",
    "end": "771120"
  },
  {
    "text": "are very nonlinear decoupled. So it's not like you can\njust plug-in numbers and go from geocentric to geodetic.",
    "start": "771120",
    "end": "777450"
  },
  {
    "text": "To do the conversion, you\nneed to solve this nonlinear system of equations.",
    "start": "777450",
    "end": "784260"
  },
  {
    "text": "Not a big deal really. You can use any type of\niterative solver like Newton's method or something\nlike that to iteratively solve",
    "start": "784260",
    "end": "791310"
  },
  {
    "text": "for it, and that's actually what\nthe receiver does to go from your x,y, z to\nLambda, phi, and h.",
    "start": "791310",
    "end": "798700"
  },
  {
    "text": "OK. So that's about the\nfirst two coordinates,",
    "start": "798700",
    "end": "803850"
  },
  {
    "text": "and there's one more that I'll\ntell you about in a minute. But now, this was about the\nreceiver side of things.",
    "start": "803850",
    "end": "810399"
  },
  {
    "text": "Let's talk about the\nsatellite that's in orbit. So as we know,\nthe receiver needs",
    "start": "810400",
    "end": "816590"
  },
  {
    "text": "to calculate the accurate\nposition of the satellite. And as a satellite is\norbiting the Earth,",
    "start": "816590",
    "end": "823370"
  },
  {
    "text": "there is a number of\nforces that affect its basically trajectory.",
    "start": "823370",
    "end": "829190"
  },
  {
    "text": "The main one is gravity. The gravitational\nforce of the Earth is the main one that affects\nhow this satellites move.",
    "start": "829190",
    "end": "838100"
  },
  {
    "text": "Now, there are a number\nof secondary forces which perturb these--",
    "start": "838100",
    "end": "844040"
  },
  {
    "text": "basically, the main force that\nis the gravity of the Earth, and the secondary effects,\nthey vary with time.",
    "start": "844040",
    "end": "852330"
  },
  {
    "text": "So these are not\nconstant forces. Over time, they can change.",
    "start": "852330",
    "end": "857600"
  },
  {
    "text": "Some of these are for instance,\nthe gravitation of moon and sun can affect your satellite,\nthings like solar radiations",
    "start": "857600",
    "end": "864649"
  },
  {
    "text": "can affect it, an effect\ncalled outgassing, which is this unintentional\nslow release of gases",
    "start": "864650",
    "end": "870830"
  },
  {
    "text": "from the satellite can\naffect its trajectory, tidal variations\non the Earth can",
    "start": "870830",
    "end": "876470"
  },
  {
    "text": "affect the forces\non the satellites and affect their\ntrajectories, and finally,",
    "start": "876470",
    "end": "881690"
  },
  {
    "text": "some intentional\norbital maneuvers that the satellite can do\nto course correct basically",
    "start": "881690",
    "end": "887420"
  },
  {
    "text": "will, of course,\naffect its trajectory. So all of these need\nto be factored in when it comes to finding the position\nof the satellite in orbit.",
    "start": "887420",
    "end": "896180"
  },
  {
    "text": "Now, as I said, the satellite\ntells you where it is. So as part of these\nnavigation messages,",
    "start": "896180",
    "end": "902810"
  },
  {
    "text": "there's this ephomeris\npart which tells you where the satellite is.",
    "start": "902810",
    "end": "907880"
  },
  {
    "text": "But the satellite uses a\ndifferent reference frame to basically tell you.",
    "start": "907880",
    "end": "914120"
  },
  {
    "text": "Because again, it's\nnot bound to the Earth, it's moving in\nspace, it does not make sense for the\nsatellite to use",
    "start": "914120",
    "end": "921710"
  },
  {
    "text": "a geocentric, for\ninstance coordinate, system that rotates\nwith the Earth. So the satellite uses\na coordinate system",
    "start": "921710",
    "end": "926990"
  },
  {
    "text": "called Earth Centered\nInertial or ECI which is exactly like the ECF, except\nit does not rotate with Earth.",
    "start": "926990",
    "end": "934070"
  },
  {
    "text": "So it's a Cartesian\ncoordinate system, it's centered at the center\nof mass of the Earth,",
    "start": "934070",
    "end": "939110"
  },
  {
    "text": "but the x, y, z coordinates\nalways point to fixed direction",
    "start": "939110",
    "end": "944140"
  },
  {
    "text": "with respect to stars\nand other constellations. So it's an inertial\ncoordinate system.",
    "start": "944140",
    "end": "951530"
  },
  {
    "text": "And then the satellite,\nwhen you decode that or read that ephomeris data, the\nposition of the satellite,",
    "start": "951530",
    "end": "959570"
  },
  {
    "text": "it's in the ECI\ncoordinate system, and then the receiver translates\nthat to the geocentric",
    "start": "959570",
    "end": "965750"
  },
  {
    "text": "so it's consistent with\nbasically what it needs to do, OK?",
    "start": "965750",
    "end": "971210"
  },
  {
    "text": "Any questions? So again three coordinate\nsystems we talked about.",
    "start": "971210",
    "end": "976730"
  },
  {
    "text": "The geocentric is\nthe one that the GPS uses to solve for the\nposition as we'll see.",
    "start": "976730",
    "end": "981740"
  },
  {
    "text": "There is the geodetic, which\nis, for historical reasons, it's this latitude longitude\nsystem that maps use.",
    "start": "981740",
    "end": "988339"
  },
  {
    "text": "So the GPS after\nfinds the position, it translates it to that.",
    "start": "988340",
    "end": "994230"
  },
  {
    "text": "And then the ECI is the\none that the satellite uses when it tells you where\nit is, and then you",
    "start": "994230",
    "end": "999470"
  },
  {
    "text": "need to go from ECI\nto ECF before you use that positional\ninformation in the satellite.",
    "start": "999470",
    "end": "1005560"
  },
  {
    "text": "OK. So let's talk about some\nphysics or orbital mechanics",
    "start": "1005560",
    "end": "1010930"
  },
  {
    "text": "of the satellite. So assume that your satellite's\nposition is given by a three",
    "start": "1010930",
    "end": "1017170"
  },
  {
    "text": "vector p sub s which is xyz\nposition of the satellite and in the ECI\ncoordinate system, OK?",
    "start": "1017170",
    "end": "1025060"
  },
  {
    "text": "And first, let's talk\nabout the ideal case. So if Earth was a perfect\nsphere with uniform mass density",
    "start": "1025060",
    "end": "1033760"
  },
  {
    "text": "and there were no other\nperturbing forces, so it was only the gravitational\nforce of this perfect sphere",
    "start": "1033760",
    "end": "1040390"
  },
  {
    "text": "acting on the\nsatellite, its dynamics would be basically governed\nby the Newton's law of motion,",
    "start": "1040390",
    "end": "1048339"
  },
  {
    "text": "which is force equals\nmass times acceleration. So the acceleration\nof your satellite",
    "start": "1048339",
    "end": "1053679"
  },
  {
    "text": "is the force\ndivided by its mass, and the only force, again, would\nbe this gravitational force",
    "start": "1053680",
    "end": "1060399"
  },
  {
    "text": "of a perfect sphere. So the acceleration\nof the satellite, which is the second\nderivative of its position",
    "start": "1060400",
    "end": "1067419"
  },
  {
    "text": "relative to time,\nwould basically be given by this\nsimple equation here. There's a constant mu divided\nby the square of the distance",
    "start": "1067420",
    "end": "1077770"
  },
  {
    "text": "of the satellite to the\ncenter of the Earth, so that's r sub s squared. And this p hat is\na unit vector that",
    "start": "1077770",
    "end": "1084820"
  },
  {
    "text": "points from the\ncenter of the Earth to where the satellite is, and\nthat determines the direction",
    "start": "1084820",
    "end": "1090280"
  },
  {
    "text": "of the acceleration. Of course, the\nEarth is pulling-- the gravity is pulling the\nsatellite towards the Earth,",
    "start": "1090280",
    "end": "1095560"
  },
  {
    "text": "so it makes sense\nfor the acceleration to be n minus p hat direction.",
    "start": "1095560",
    "end": "1101260"
  },
  {
    "text": "It's always getting\naccelerated towards the Earth. Mu in this equation is\nitself a multiplication",
    "start": "1101260",
    "end": "1110020"
  },
  {
    "text": "of two other constants. It's g times m where is\nthe universal gravitational",
    "start": "1110020",
    "end": "1115480"
  },
  {
    "text": "constant and m is the\nmass of the Earth, which is 5.9 times 10 to the 24.",
    "start": "1115480",
    "end": "1123100"
  },
  {
    "text": "There's a little typo here. OK. And this is easy.",
    "start": "1123100",
    "end": "1129070"
  },
  {
    "text": "So if this was the\nideal case, this, you can actually\nanalytically solve. And it turns out that\nthe shape of the orbit",
    "start": "1129070",
    "end": "1136020"
  },
  {
    "text": "becomes a perfect ellipse with\nEarth at its focal point, OK?",
    "start": "1136020",
    "end": "1141130"
  },
  {
    "text": "Now, in reality, as I\nsaid, this is not the case. Well, for one, Earth is\nnot a perfect sphere.",
    "start": "1141130",
    "end": "1147960"
  },
  {
    "text": "Also, its mass density is\nnot uniform, as we know, and then there's a whole bunch\nof secondary forces affecting",
    "start": "1147960",
    "end": "1153510"
  },
  {
    "text": "on your satellite. So in reality, the\nequation you need to solve to find the\ntrajectory of your satellite",
    "start": "1153510",
    "end": "1160649"
  },
  {
    "text": "is this one given here\nwhere the acceleration is given by this equation\nhere, which has two terms.",
    "start": "1160650",
    "end": "1168430"
  },
  {
    "text": "One is the gradient of V. V\nis the gravitational potential of the Earth.",
    "start": "1168430",
    "end": "1174600"
  },
  {
    "text": "And then there's\nthis a sub d, which is the lumped effect of all\nthese secondary forces acting",
    "start": "1174600",
    "end": "1182460"
  },
  {
    "text": "on your satellite. And you can just sum\nthem up, make them this additional perturbing\nacceleration term",
    "start": "1182460",
    "end": "1188010"
  },
  {
    "text": "that's getting added here. And just a remind that\nthe gradient is basically",
    "start": "1188010",
    "end": "1195029"
  },
  {
    "text": "the vector of the\nfirst derivative of V with respect to the\nthree coordinates. So it's partial d partial--",
    "start": "1195030",
    "end": "1201720"
  },
  {
    "text": "partial v partial x, partial v\npartial y, partial b partial z. And you evaluate that\ngradient at the position--",
    "start": "1201720",
    "end": "1209190"
  },
  {
    "text": "the current position\nof your satellite, and that gives you basically\nwhat the acceleration is.",
    "start": "1209190",
    "end": "1215280"
  },
  {
    "text": "This is called the two-body\nor the Keplerian equation of motion. In principle, you\ncan solve this.",
    "start": "1215280",
    "end": "1223200"
  },
  {
    "text": "It's still a ordinary\ndifferential equation.",
    "start": "1223200",
    "end": "1228610"
  },
  {
    "text": "So you can-- if you know V,\nyou can find its gradient. And let's say also,\na sub d is known",
    "start": "1228610",
    "end": "1236070"
  },
  {
    "text": "or you can ignore it\nif it's negligible, and then that gives\nyou your acceleration.",
    "start": "1236070",
    "end": "1241179"
  },
  {
    "text": "And if you integrate\nthat once, you get velocity because\nacceleration is a derivative of the velocity.",
    "start": "1241180",
    "end": "1247200"
  },
  {
    "text": "And then you integrate\nagain, you get position. So if you double\nintegrate this, you can, in principle, get the\nposition of your satellite.",
    "start": "1247200",
    "end": "1255360"
  },
  {
    "text": "In practice, it is\nnot done this way. And the reason is, this V,\nthe gravitational potential",
    "start": "1255360",
    "end": "1261300"
  },
  {
    "text": "of the Earth, the actual\nbasically model of it is extremely complicated.",
    "start": "1261300",
    "end": "1267460"
  },
  {
    "text": "So it's this function\ngiven here, OK? So don't worry. We're not going to do this. I'm basically just\nput it in there",
    "start": "1267460",
    "end": "1273660"
  },
  {
    "text": "to scare you off because\nit's this very complicated. I mean, it's not outrageous, but\nit's this complicated function.",
    "start": "1273660",
    "end": "1280710"
  },
  {
    "text": "It's modeled by what is\ncalled a spherical harmonics. It has an infinite\nnumber of terms in it.",
    "start": "1280710",
    "end": "1286410"
  },
  {
    "text": "You can always approximate\nit with some finite sum. These PLMs are called\nLegendre polynomials.",
    "start": "1286410",
    "end": "1293600"
  },
  {
    "text": "So these are some\nknown polynomials, and then there's a\nwhole bunch of constants that go in there and a bunch\nof geometric parameters",
    "start": "1293600",
    "end": "1301620"
  },
  {
    "text": "like the alpha and the r\nand so on and so forth, OK? So again, this is just--",
    "start": "1301620",
    "end": "1308190"
  },
  {
    "text": "it's in there. Just so you know, it is doable. And the actual\ngravitational field",
    "start": "1308190",
    "end": "1313890"
  },
  {
    "text": "of the Earth it's very well\nknown, very well studied. And in some\napplications, if need be,",
    "start": "1313890",
    "end": "1320230"
  },
  {
    "text": "you can actually work with it. But that's not how the GPS\ndoes, and the main reason",
    "start": "1320230",
    "end": "1325860"
  },
  {
    "text": "is computational complexity. I mean, this function, if\nyou need to constantly--",
    "start": "1325860",
    "end": "1332279"
  },
  {
    "text": "well, first find\nthe gradient of it and then double integrate\nto find position,",
    "start": "1332280",
    "end": "1338370"
  },
  {
    "text": "it becomes very\ncomputationally expensive. So the way it's done\nfor the GPS is actually",
    "start": "1338370",
    "end": "1348780"
  },
  {
    "text": "pretty elegant and simple. So what happens is that\nevery ephomeris message--",
    "start": "1348780",
    "end": "1354130"
  },
  {
    "text": "so the core idea\nhere is, OK, if you look at very long timescales,\nthe full trajectory",
    "start": "1354130",
    "end": "1360780"
  },
  {
    "text": "of this satellite\naround the Earth is this complicated\nthing governed",
    "start": "1360780",
    "end": "1367200"
  },
  {
    "text": "by the exact gravitational\npotential of the Earth and other perturbing forces. But on much shorter\ntimescales-- so",
    "start": "1367200",
    "end": "1375000"
  },
  {
    "text": "if you just consider a\nfew minutes or seconds, you can very well approximate\nit by a perfect ellipse, so",
    "start": "1375000",
    "end": "1384420"
  },
  {
    "text": "on a much shorter time scale. So again, the idea here is-- ",
    "start": "1384420",
    "end": "1391940"
  },
  {
    "text": "say, this is the Earth. This is this satellite orbiting.",
    "start": "1391940",
    "end": "1397419"
  },
  {
    "text": "So in a perfect case,\nit's a perfect ellipsoid. In a nonperfect case,\nit's something else.",
    "start": "1397420",
    "end": "1404580"
  },
  {
    "text": "I don't know exactly\nwhat it is, but there's some deviations\nmaybe or something. Maybe it's something\nlike that, OK?",
    "start": "1404580",
    "end": "1411610"
  },
  {
    "text": "But if you look at a very,\nvery short time scale like just around here,\nyou can very well",
    "start": "1411610",
    "end": "1417210"
  },
  {
    "text": "approximate the actual black\ntrajectory by the blue ellipse.",
    "start": "1417210",
    "end": "1424049"
  },
  {
    "text": "And that's how the GPS works as\npart of every ephomeris message it sends just six parameters\nsix numbers basically",
    "start": "1424050",
    "end": "1431580"
  },
  {
    "text": "that are the approximation\nof the actual trajectory",
    "start": "1431580",
    "end": "1437460"
  },
  {
    "text": "of the satellite\nwith an ellipse. And that is what\nthe receiver uses",
    "start": "1437460",
    "end": "1444870"
  },
  {
    "text": "to find the location\nof the satellite. And these are called\nthe orbital parameters.",
    "start": "1444870",
    "end": "1452820"
  },
  {
    "text": "There is also a\ntimestamp that is part of the ephomeris message. So it basically tells you,\nat this point in time, t0,",
    "start": "1452820",
    "end": "1462270"
  },
  {
    "text": "my trajectory is very well\napproximated by an ellipse, and these are the six parameters\nyou need to know basically",
    "start": "1462270",
    "end": "1470820"
  },
  {
    "text": "know the shape and orientation\nof this ellipse, OK? So those are basically the\nsix orbital parameters.",
    "start": "1470820",
    "end": "1481020"
  },
  {
    "text": "And as I said,\nthere is a timestamp as part of the\nephomeris message,",
    "start": "1481020",
    "end": "1486870"
  },
  {
    "text": "and that time is also called\nthe epoch for that message.",
    "start": "1486870",
    "end": "1493470"
  },
  {
    "text": "And also, remember that\nthese navigation messages",
    "start": "1493470",
    "end": "1499080"
  },
  {
    "text": "are coming very slowly. So you might receive one\nevery couple of minutes",
    "start": "1499080",
    "end": "1504299"
  },
  {
    "text": "or maybe even less. So it is not-- that's why the GPS\nsatellite doesn't just",
    "start": "1504300",
    "end": "1511650"
  },
  {
    "text": "send you a position. It just doesn't\nsend you an x, y, z. Because the x, y, z is only\nvalid at a single point",
    "start": "1511650",
    "end": "1518250"
  },
  {
    "text": "in time, and then you need to\nextrapolate between the two",
    "start": "1518250",
    "end": "1524250"
  },
  {
    "text": "navigation messages. And if it's just\none x, y, z, there is no way for the\nreceiver to extrapolate. So that's why\ninstead, the satellite",
    "start": "1524250",
    "end": "1532559"
  },
  {
    "text": "tells you the trajectory. It tells you the shape and\norientation of this ellipse so the receiver can\nactually extrapolate",
    "start": "1532560",
    "end": "1540450"
  },
  {
    "text": "where the satellite is going to\nbe or interpolate between two navigation messages.",
    "start": "1540450",
    "end": "1546210"
  },
  {
    "text": "And on top of, that just to\nmake things more accurate, not only the satellite tells\nyou the shape of this ellipse,",
    "start": "1546210",
    "end": "1555059"
  },
  {
    "text": "it also sends you some\nsecondary correction factors which tells you over time,\nhow these orbital parameters",
    "start": "1555060",
    "end": "1563230"
  },
  {
    "text": "change. And that helps the\nreceiver to even more accurately interpolate\nbetween two messages.",
    "start": "1563230",
    "end": "1569530"
  },
  {
    "text": "So let's see what these\nsix parameters are. The first three describe\nthe shape of the ellipse",
    "start": "1569530",
    "end": "1578160"
  },
  {
    "text": "and also where the satellite is\non that elliptical trajectory, OK?",
    "start": "1578160",
    "end": "1583710"
  },
  {
    "text": "So pretty simple. It's an ellipse. There's very many different\nparameter options for it.",
    "start": "1583710",
    "end": "1589780"
  },
  {
    "text": "The one that GPS uses is-- as part of the\nephomeris, you get,",
    "start": "1589780",
    "end": "1596010"
  },
  {
    "text": "A, the semi-major\naxis of the ellipse, you also get the\neccentricity, OK?",
    "start": "1596010",
    "end": "1601270"
  },
  {
    "text": "So with that, you can\nperfectly basically find the shape of this ellipse,\nand also where the Earth is,",
    "start": "1601270",
    "end": "1607260"
  },
  {
    "text": "that's the focal point. So you just need to know A and\nthe eccentricity and that's it.",
    "start": "1607260",
    "end": "1612450"
  },
  {
    "text": "But you also-- the\nsatellite needs to tell you at this\ntime t0, where am I on this elliptical trajectory?",
    "start": "1612450",
    "end": "1619980"
  },
  {
    "text": "And the velocity of\nthe satellite on this is not constant, OK?",
    "start": "1619980",
    "end": "1625620"
  },
  {
    "text": "Again, there's different\nparameterization that you can use to basically\nfind where the satellite is.",
    "start": "1625620",
    "end": "1632580"
  },
  {
    "text": "The one that is\nused by the GPS it's called the tower or\nthe time of perigee.",
    "start": "1632580",
    "end": "1638220"
  },
  {
    "text": "So on this elliptical\ntrajectory, there is a point P here,\nwhich is the closest point",
    "start": "1638220",
    "end": "1645030"
  },
  {
    "text": "to the Earth on the trajectory. So that's called\nthe time of peri-- point of perigee.",
    "start": "1645030",
    "end": "1650130"
  },
  {
    "text": "And tau is basically\nthe time it's going to take the satellite\nfrom this t0, which",
    "start": "1650130",
    "end": "1657570"
  },
  {
    "text": "is the transmit time, to\nget to the point of perigee. So it tells you, OK, it's going\nto take me, for instance, I",
    "start": "1657570",
    "end": "1666060"
  },
  {
    "text": "don't two hours to get to this\npoint P on the trajectory.",
    "start": "1666060",
    "end": "1671400"
  },
  {
    "text": "And with that, using that\nand some simple math, the receiver can back out\nwhere exactly the satellite is",
    "start": "1671400",
    "end": "1679710"
  },
  {
    "text": "on the trajectory at time t0,\nand also extrapolate because it",
    "start": "1679710",
    "end": "1685169"
  },
  {
    "text": "knows the trajectory, it\nknows where it is on it , now and also, it can basically\ntell how it's going to move",
    "start": "1685170",
    "end": "1693210"
  },
  {
    "text": "over time. Only short periods\nof time, remember. Because over long\nperiods, this trajectory",
    "start": "1693210",
    "end": "1698857"
  },
  {
    "text": "is not going to be valid. This trajectory is only\nvalid for minutes or seconds.",
    "start": "1698858",
    "end": "1704010"
  },
  {
    "text": "But still, it's pretty good for\nthose kinds of calculations.",
    "start": "1704010",
    "end": "1709170"
  },
  {
    "text": "Yes. How does the satellite\nknow the point of perigee? Oh, excellent question.",
    "start": "1709170",
    "end": "1715000"
  },
  {
    "text": "So the question is,\nhow does the satellite know the point of perigee? So this is where--",
    "start": "1715000",
    "end": "1721530"
  },
  {
    "text": "I think I very briefly\nmentioned that there's a very important part\nof the GPS system,",
    "start": "1721530",
    "end": "1727570"
  },
  {
    "text": "which is the ground system. There is this network\nof ground stations that monitor the\nsatellites and constantly",
    "start": "1727570",
    "end": "1733770"
  },
  {
    "text": "communicate with them. Actually, it's told\nby the ground system,",
    "start": "1733770",
    "end": "1739409"
  },
  {
    "text": "the satellite-- a lot of\nthese orbital calculations are done on the ground\nand then they're",
    "start": "1739410",
    "end": "1744420"
  },
  {
    "text": "transmitted to the satellites. So that's basically\nhow it's done.",
    "start": "1744420",
    "end": "1750420"
  },
  {
    "text": "Yeah. But does it require\ntoo many resources for that ground system to keep\ntrack of the location of all",
    "start": "1750420",
    "end": "1757110"
  },
  {
    "text": "the satellites? It kind of does. So in terms of-- the question was, does it take\ntoo many resources for the GPS",
    "start": "1757110",
    "end": "1763800"
  },
  {
    "text": "ground system to track\nall these satellites and tell them all the\ntrajectory information?",
    "start": "1763800",
    "end": "1770040"
  },
  {
    "text": "It kind of does. It's not outrageous. Again, by today's\nstandards, we are talking about solving system\nsimple differential equations",
    "start": "1770040",
    "end": "1778620"
  },
  {
    "text": "and things like that. So by today's\nstandards, not really. In the 70s, yes, it was\nconsidered a heavy operation.",
    "start": "1778620",
    "end": "1785880"
  },
  {
    "text": "But again, remember\nthat there's only like 30 something\nsatellites in orbit, and there's a lot\nof ground stations.",
    "start": "1785880",
    "end": "1792120"
  },
  {
    "text": "And so if you like distribute\nthe compute among them,",
    "start": "1792120",
    "end": "1797470"
  },
  {
    "text": "it's not that-- I mean, these days, these\nkinds of calculations",
    "start": "1797470",
    "end": "1802649"
  },
  {
    "text": "can run on a cell\nphone basically. So again, in the\n70s, yes, maybe it was considered compute heavy.",
    "start": "1802650",
    "end": "1808230"
  },
  {
    "text": "But today, not really. But ground stations do a\nlot more than just this. So this is part of what\nthey do, but there's",
    "start": "1808230",
    "end": "1815490"
  },
  {
    "text": "a whole lot of other stuff\nthat GPS ground system does. OK.",
    "start": "1815490",
    "end": "1820620"
  },
  {
    "text": "So far, these three\nparameters-- the A, the E, the major axis,\nthe eccentricity,",
    "start": "1820620",
    "end": "1827730"
  },
  {
    "text": "and the time of perigee\ndescribe the shape of this elliptical\ntrajectory and where the satellite is on it, OK?",
    "start": "1827730",
    "end": "1834090"
  },
  {
    "text": "But that's not enough because\nremember, we're in 3D space, so we also need to know the\norientation of this ellipse",
    "start": "1834090",
    "end": "1844020"
  },
  {
    "text": "with respect to the Earth. So if you will, you need three\nmore parameters like a pitch",
    "start": "1844020",
    "end": "1850650"
  },
  {
    "text": "and a role and a yaw. So three angles to describe\nhow this elliptical plane is",
    "start": "1850650",
    "end": "1856470"
  },
  {
    "text": "oriented. And that's the other three\nbasically orbital parameters",
    "start": "1856470",
    "end": "1861990"
  },
  {
    "text": "that are part of the\nephomeris message. Again, there's many\ndifferent formulations",
    "start": "1861990",
    "end": "1868080"
  },
  {
    "text": "you can use to describe the\norientation of the ellipse. Again, for instance,\nthe pitch, roll, and yaw",
    "start": "1868080",
    "end": "1874919"
  },
  {
    "text": "is a perfectly valid\nparameterization, but that's not what the GPS use.",
    "start": "1874920",
    "end": "1880200"
  },
  {
    "text": "It uses something\nslightly different. Here's a picture that\ndescribes-- its three angles.",
    "start": "1880200",
    "end": "1887580"
  },
  {
    "text": "They're called I, big\nomega, and little omega. And what they are is--",
    "start": "1887580",
    "end": "1892800"
  },
  {
    "text": "let me maybe add some\ncolor to the picture. So here, you have two planes.",
    "start": "1892800",
    "end": "1898500"
  },
  {
    "text": "This one that I'm\nhighlighting in red is the equatorial plane of\nthe Earth, and the other one,",
    "start": "1898500",
    "end": "1905190"
  },
  {
    "text": "let's keep it black,\nthat's the plane of the elliptical\ntrajectory of the satellite. So we want to describe the\norientation between the two.",
    "start": "1905190",
    "end": "1914050"
  },
  {
    "text": "So the I is the angle\nbetween the equatorial plane and the orbital plane,\nso that's this angle.",
    "start": "1914050",
    "end": "1921060"
  },
  {
    "text": "So if you look at the two\nsurface normals of the two planes, that's the angle I, OK?",
    "start": "1921060",
    "end": "1926280"
  },
  {
    "text": "And then big omega,\nit's the longitude angle of the ascending node.",
    "start": "1926280",
    "end": "1931710"
  },
  {
    "text": "And the ascending\nnode is basically, if you look at this-- we use a different color here.",
    "start": "1931710",
    "end": "1937560"
  },
  {
    "text": "If you look at this basically\nelliptical trajectory-- let's say that's a trajectory\nof the satellite, at some point,",
    "start": "1937560",
    "end": "1947610"
  },
  {
    "text": "it's going to cross\nthe orbital plane of-- sorry, the equatorial\nplane of the Earth.",
    "start": "1947610",
    "end": "1954539"
  },
  {
    "text": "And that point is called\nthe ascending node. The one where it goes\nfrom underneath it to",
    "start": "1954540",
    "end": "1961950"
  },
  {
    "text": "above it, that's\ncalled the node. And if you calculate\nthe longitude of that, that is your big omega.",
    "start": "1961950",
    "end": "1968450"
  },
  {
    "text": "So that's the second angle,\nand the third one little omega is the angle between the\nascending node and the vector",
    "start": "1968450",
    "end": "1976000"
  },
  {
    "text": "that points to the point of\nperigee of the orbital plane. Again, this is a\nkind of thing you",
    "start": "1976000",
    "end": "1982210"
  },
  {
    "text": "have to look at it a\nlittle bit and then it becomes clear exactly\nwhat the three angles are.",
    "start": "1982210",
    "end": "1988330"
  },
  {
    "text": "Again, it's just\none parameterization to describe the 3D orientation\nof the orbital plane.",
    "start": "1988330",
    "end": "1995690"
  },
  {
    "text": "OK. So those are basically\nthe six parameters that are in every ephomeris message.",
    "start": "1995690",
    "end": "2002550"
  },
  {
    "text": "And these parameters,\nagain, remember, the six orbital parameters,\nthey're exact only at time t0,",
    "start": "2002550",
    "end": "2011460"
  },
  {
    "text": "which is the transit time\nof the navigation message. And if you deviate\nfrom t0, because",
    "start": "2011460",
    "end": "2020760"
  },
  {
    "text": "of these perturbing\nforces and other effects, your orbital parameters\ncan change, OK?",
    "start": "2020760",
    "end": "2026460"
  },
  {
    "text": "And that's why as part of\nevery ephomeris message, there is also correction factors\nthat describe how these six",
    "start": "2026460",
    "end": "2034860"
  },
  {
    "text": "parameters are going\nto change over time, and then the receiver can\nalso apply the correction",
    "start": "2034860",
    "end": "2040470"
  },
  {
    "text": "factors as it's\ninterpolating the position of the satellite between\ntwo navigation messages, OK?",
    "start": "2040470",
    "end": "2048480"
  },
  {
    "text": "So you get something\nexact at time 0. And then from this time 0 to\nthe arrival of the next epoch",
    "start": "2048480",
    "end": "2055589"
  },
  {
    "text": "or navigation message, you\nuse your correction factor. And by you, I mean the receiver\nuses the correction factors",
    "start": "2055590",
    "end": "2063030"
  },
  {
    "text": "to constantly basically\ntrack the position of the satellite in orbit.",
    "start": "2063030",
    "end": "2069569"
  },
  {
    "text": "OK. Two questions. Why not send a ephomeris\nmessages very frequently?",
    "start": "2069570",
    "end": "2076350"
  },
  {
    "text": "Why is it so slow? Send it fast and then we don't\nneed to apply these correction factors. And it's for a very\npractical reason",
    "start": "2076350",
    "end": "2083309"
  },
  {
    "text": "because it becomes too\ncomputationally expensive for the satellite if it needs\nto constantly communicate this.",
    "start": "2083310",
    "end": "2090030"
  },
  {
    "text": "And again, when it\ncomes to satellites, power consumption is always\na very, very big constraint,",
    "start": "2090030",
    "end": "2097860"
  },
  {
    "text": "and that was a design decision\nthat was made by the GPS design engineers.",
    "start": "2097860",
    "end": "2103290"
  },
  {
    "text": "The other question, which\nwe already answered, is why not-- why\ndoesn't the receiver integrate the fully\nperturbed equation of motion",
    "start": "2103290",
    "end": "2111390"
  },
  {
    "text": "to find a satellite\norbit trajectory? And again, that's too\ncomputationally expensive",
    "start": "2111390",
    "end": "2118830"
  },
  {
    "text": "for the receiver, OK? So for these two reasons,\nbasically, the design decision",
    "start": "2118830",
    "end": "2124200"
  },
  {
    "text": "was made to describe the\ntrajectory with the six orbital parameters plus\nthe correction factors",
    "start": "2124200",
    "end": "2131470"
  },
  {
    "text": "and then send them on a slow-- over slow intervals.",
    "start": "2131470",
    "end": "2138510"
  },
  {
    "text": "Any questions? ",
    "start": "2138510",
    "end": "2143540"
  },
  {
    "text": "OK. I really hope you stop me\nwhen things don't make sense",
    "start": "2143540",
    "end": "2149180"
  },
  {
    "text": "because it's really important. I mean, it's my job to make sure\nwhen you walk out of the door,",
    "start": "2149180",
    "end": "2157010"
  },
  {
    "text": "stuff we talked\nabout made sense. So if it doesn't,\nplease stop me, and we can talk about\nand clarify things.",
    "start": "2157010",
    "end": "2163400"
  },
  {
    "text": "And don't be shy to\nreally just flat out tell me, hey, this doesn't make\nsense, and I'll try to clarify.",
    "start": "2163400",
    "end": "2171350"
  },
  {
    "text": "But so far, again, we\nsaid there's two things",
    "start": "2171350",
    "end": "2177800"
  },
  {
    "text": "that the receiver needs\nto estimate before it can start localizing itself.",
    "start": "2177800",
    "end": "2184610"
  },
  {
    "text": "And one was the position\nof the satellite or each satellite in orbit,\nand we talked about it.",
    "start": "2184610",
    "end": "2190970"
  },
  {
    "text": "So that was the first\nitem that's checked now, and now we are going\nto talk about how",
    "start": "2190970",
    "end": "2196460"
  },
  {
    "text": "these ranging codes work and\nhow time of flight estimation is done using them, OK?",
    "start": "2196460",
    "end": "2201859"
  },
  {
    "text": "Here, I'm going to need-- it's going to become a\nlittle bit math heavy, and I really need\nyour full attention",
    "start": "2201860",
    "end": "2207980"
  },
  {
    "text": "because this concept that we\nare going to talk about now goes way beyond GPS. It's a very core idea that\nwe introduce it in GPS",
    "start": "2207980",
    "end": "2217069"
  },
  {
    "text": "but we're going to see it\nagain and again in class and generally for sensing\nthis is one of those really",
    "start": "2217070",
    "end": "2222560"
  },
  {
    "text": "core very interesting ideas. So let's kind of focus\non it together and again",
    "start": "2222560",
    "end": "2230359"
  },
  {
    "text": "at any point if things\ndon't make sense, stop me away and let's talk about it.",
    "start": "2230360",
    "end": "2236220"
  },
  {
    "text": "So let's first build a\nsimplified signal model for time of flight estimation.",
    "start": "2236220",
    "end": "2242580"
  },
  {
    "text": "So we have a GPS satellite\nthat's transmitting a signal. And right now, we're\ncompletely abstracting out what",
    "start": "2242580",
    "end": "2250100"
  },
  {
    "text": "the specifics of the signal is. We called it ranging codes,\nbut it can be anything now. Some x of t is transmitted,\nit's a waveform.",
    "start": "2250100",
    "end": "2258260"
  },
  {
    "text": "And then it gets sometimes\ntau to reach the receiver, and the receiver\nreceives the y of t,",
    "start": "2258260",
    "end": "2264710"
  },
  {
    "text": "which is x of t minus tau. So it's some delayed version of\nt, and it also gets attenuated.",
    "start": "2264710",
    "end": "2269839"
  },
  {
    "text": "So for completeness, we have\nincluded this alpha parameter, which is an\nattenuation factor, OK?",
    "start": "2269840",
    "end": "2275720"
  },
  {
    "text": "Very generic model. And the job of the receiver\nis to basically estimate tau.",
    "start": "2275720",
    "end": "2282890"
  },
  {
    "text": "What is the time of flight? Now, usually, any receiver to do\nDSP or any type of algorithms,",
    "start": "2282890",
    "end": "2292369"
  },
  {
    "text": "it works with discrete signals. So the signals are\nsampled basically. And let's say you have some\nsampling frequency F sub",
    "start": "2292370",
    "end": "2298970"
  },
  {
    "text": "s or sampling time t sub s. So F is 1 over t,\nand then you work",
    "start": "2298970",
    "end": "2304099"
  },
  {
    "text": "with the discretized signal. So you get x of k, which is x of\nk times your sampling interval,",
    "start": "2304100",
    "end": "2310460"
  },
  {
    "text": "k times ts, and then y of k is\nalpha, x of k minus n sub tau.",
    "start": "2310460",
    "end": "2315650"
  },
  {
    "text": "This n sub tau is like the\ndiscretized time of flight. So it's going to\nbe the floor of tau",
    "start": "2315650",
    "end": "2322609"
  },
  {
    "text": "over your sampling\ninterval, ts, OK? So that's super\nsimplified already",
    "start": "2322610",
    "end": "2331070"
  },
  {
    "text": "signal model that\nwe can work with. And let's frame an estimation\nproblem using this.",
    "start": "2331070",
    "end": "2337520"
  },
  {
    "text": "So you're the receiver,\nyou have measured a y of k,",
    "start": "2337520",
    "end": "2342650"
  },
  {
    "text": "and let's say you also know\nwhat signal was transmitted. X of k is known to you. So you have previously\nagreed with the transmitter",
    "start": "2342650",
    "end": "2350210"
  },
  {
    "text": "that this is the\nexact waveform x of k that you're going to\ntransmit, and you are not going to change that, OK?",
    "start": "2350210",
    "end": "2356120"
  },
  {
    "text": "Now, you want to\nestimate the attenuation and the time of flight--\nn sub tau and alpha.",
    "start": "2356120",
    "end": "2361910"
  },
  {
    "text": "Attenuation, for GPS, it\ndoesn't really matter. There is nothing useful\nyou can do with it.",
    "start": "2361910",
    "end": "2366960"
  },
  {
    "text": "But as we see, it's\njust a byproduct of this estimation problem. It just comes out\nof the equations.",
    "start": "2366960",
    "end": "2372890"
  },
  {
    "text": "In some other\napplications, it might be interesting to know\nwhat the attenuation was. For GPS, we only care\nabout time of flight.",
    "start": "2372890",
    "end": "2379760"
  },
  {
    "text": "How do we do this? We can frame a least\nsquares problem. So basically, now\nyou have this model",
    "start": "2379760",
    "end": "2386900"
  },
  {
    "text": "which is alpha times x\nsub n minus n sub tau, and you want to fit the model\nto your measurements, which",
    "start": "2386900",
    "end": "2394460"
  },
  {
    "text": "are y case. How do we do that? So one way is basically to\nminimize the mean squared error",
    "start": "2394460",
    "end": "2402349"
  },
  {
    "text": "between your measurements\nand the signal model. So you sum over all k's.",
    "start": "2402350",
    "end": "2408110"
  },
  {
    "text": "You subtract yk from\nbasically this fit, which is alpha x of k minus n.",
    "start": "2408110",
    "end": "2413780"
  },
  {
    "text": "You square all the error\nterms, sum them up, that's your mean squared error. And then you want to\npick alpha hat and hat",
    "start": "2413780",
    "end": "2421220"
  },
  {
    "text": "that minimize your\nmean squared error. Yes. Question. So on the last slide, you said\ntau was the time of flight.",
    "start": "2421220",
    "end": "2429900"
  },
  {
    "text": "Yeah. On this page, you're\nusing n sub tau. Yes.",
    "start": "2429900",
    "end": "2435690"
  },
  {
    "text": "Is there a difference\nbetween the two? Yeah. So the question was, on this\nslide, we said time of flight",
    "start": "2435690",
    "end": "2441119"
  },
  {
    "text": "is now, and then I\nchanged to n sub tau. And are these\ndifferent or related?",
    "start": "2441120",
    "end": "2447059"
  },
  {
    "text": "They're related. So as we scrutinize\nties the signal or sample it with some\nsampling interval t sub S,",
    "start": "2447060",
    "end": "2454500"
  },
  {
    "text": "as it's written over\nhere, basically, n sub tau is the discrete index\nthat corresponds",
    "start": "2454500",
    "end": "2461549"
  },
  {
    "text": "to the time of flight. So that's how-- it's like\nthe discrete equivalent",
    "start": "2461550",
    "end": "2466950"
  },
  {
    "text": "of your time of\nflight basically. OK.",
    "start": "2466950",
    "end": "2472230"
  },
  {
    "text": "So this is basically our\noptimization problem. If we solve this and minimize\nthis objective function,",
    "start": "2472230",
    "end": "2479220"
  },
  {
    "text": "the alpha and n\nthat minimize this are going to be our least\nsquares estimates of the time",
    "start": "2479220",
    "end": "2484589"
  },
  {
    "text": "of flight and the attenuation. So let's solve this together. First thing is we expand this. It's just a squared term.",
    "start": "2484590",
    "end": "2490990"
  },
  {
    "text": "So as you expand it,\nyou get three terms. You get sum of y squared,\nyou get alpha squared times",
    "start": "2490990",
    "end": "2497460"
  },
  {
    "text": "sum of x squared or x\nminus n squared, and then you get the cross term, which\nis minus 2 alpha summation",
    "start": "2497460",
    "end": "2504300"
  },
  {
    "text": "ykxk minus n, OK? First term does not\ndepend on n or alpha.",
    "start": "2504300",
    "end": "2510490"
  },
  {
    "text": "So this one, you can just\nignore it, the y squared term.",
    "start": "2510490",
    "end": "2517110"
  },
  {
    "text": "And what we get then\nis this equation here. And here, also, have\ndone a little thing.",
    "start": "2517110",
    "end": "2523770"
  },
  {
    "text": "I flipped the sine inside\nand then changed min to the max just for\nmathematical convenience.",
    "start": "2523770",
    "end": "2530490"
  },
  {
    "text": "There's really no\nscientific reason behind it, but just to make the\nnotation a little easier.",
    "start": "2530490",
    "end": "2537435"
  },
  {
    "text": "OK. So this is what we\nwant to minimize. It's our objective function. And let's first estimate alpha.",
    "start": "2537435",
    "end": "2544049"
  },
  {
    "text": "And the way you do it,\nwhen a function is given and you want to\nmaximize or minimize it,",
    "start": "2544050",
    "end": "2549690"
  },
  {
    "text": "you take the\nderivative, set it to 0. So let's take the derivative\nwith respect to alpha, set that to 0.",
    "start": "2549690",
    "end": "2555600"
  },
  {
    "text": "This is the equation you get\nfor your alpha hat or the least squares estimate to alpha.",
    "start": "2555600",
    "end": "2561839"
  },
  {
    "text": "And as you solve this-- so\nit's 2 times this yk times",
    "start": "2561840",
    "end": "2567150"
  },
  {
    "text": "summation yk times xa minus\nn minus 2 alpha hat times summation of x squared.",
    "start": "2567150",
    "end": "2573670"
  },
  {
    "text": "So your alpha hat becomes\nbasically this expression, OK? So this is the least squares\nsmart of the attenuation.",
    "start": "2573670",
    "end": "2583740"
  },
  {
    "text": "Now, what we really,\nreally care about is the n hat or an hat tau. So to find that, you can\nplug this alpha hat back",
    "start": "2583740",
    "end": "2591090"
  },
  {
    "text": "into this equation here\nand then solve for n hat.",
    "start": "2591090",
    "end": "2597060"
  },
  {
    "text": "Plugging it in, things\nreally simplify very quickly as you plug that in.",
    "start": "2597060",
    "end": "2603630"
  },
  {
    "text": "And basically, your n\nhat becomes the arg max",
    "start": "2603630",
    "end": "2610890"
  },
  {
    "text": "of this function here, OK? And if you look at this function\nhere, something is interesting.",
    "start": "2610890",
    "end": "2617970"
  },
  {
    "text": "So it's a ratio. The numerator is the square\nof the summation yk times xk",
    "start": "2617970",
    "end": "2626340"
  },
  {
    "text": "minus n, and then\nthe denominator is summation over k\nof x squared k minus.",
    "start": "2626340",
    "end": "2632579"
  },
  {
    "text": "The denominator here\nis really the energy",
    "start": "2632580",
    "end": "2637920"
  },
  {
    "text": "in your transmit waveform x\nor a delayed version of it. So k minus n-- minus n is\njust shifting or offsetting",
    "start": "2637920",
    "end": "2645870"
  },
  {
    "text": "or delaying your\nsignal, and then you're squaring it and summing it up. So that's the total energy\nin your transmit signal,",
    "start": "2645870",
    "end": "2653200"
  },
  {
    "text": "and it really does\nnot depend on n. If you delay a signal, the\nenergy in it does not change.",
    "start": "2653200",
    "end": "2658859"
  },
  {
    "text": "So you can ignore\nthe denominator and just go find the\nmax of the numerator.",
    "start": "2658860",
    "end": "2666660"
  },
  {
    "text": "And that's what you do, and\nthen your basically estimate of the time of flight\nor n hat becomes",
    "start": "2666660",
    "end": "2673319"
  },
  {
    "text": "the arg max of this function,\nwhich we call Ryx of n. And this is the\ncross correlation",
    "start": "2673320",
    "end": "2680700"
  },
  {
    "text": "of your received signal y and\nthe transmitted waveform x, which is basically\nthis sum here.",
    "start": "2680700",
    "end": "2688950"
  },
  {
    "text": "Which is the same sum\nthat was on top here. We have just renamed\nit, called it yx. And it's sum over\nk, yk, xk minus n.",
    "start": "2688950",
    "end": "2697049"
  },
  {
    "text": "This should look familiar\nfrom, say, maybe a signal processing course\nthat you have taken.",
    "start": "2697050",
    "end": "2702630"
  },
  {
    "text": "It's awfully close to the\ncorrelation between x and y. Not exactly the\ncorrelation though.",
    "start": "2702630",
    "end": "2708570"
  },
  {
    "text": "There's a minus sign\nchange somewhere. I'll let you figure out\nthe exact difference, but basically, it's like\nthe correlation of x with--",
    "start": "2708570",
    "end": "2716940"
  },
  {
    "text": "x of n with y of minus n\nor something like that. You flip one and then\ndo the correlation.",
    "start": "2716940",
    "end": "2722400"
  },
  {
    "text": "The point is, it's\nlike a linear filter. You have your y, you have\nx with different delays,",
    "start": "2722400",
    "end": "2731970"
  },
  {
    "text": "and then you multiply\nand sum over k. And then what you want to do\nis you want to square this guy",
    "start": "2731970",
    "end": "2740310"
  },
  {
    "text": "and find the value of\nn that maximizes it. So if you calculate your\nRyx and then square it,",
    "start": "2740310",
    "end": "2749410"
  },
  {
    "text": "then you have this\nfunction of n. And then you can just\nlook at this function and find where there is a peak,\nand the index for that peak",
    "start": "2749410",
    "end": "2758290"
  },
  {
    "text": "basically gives you your\ntime of flight delay. There's one more\nsimplification we can do,",
    "start": "2758290",
    "end": "2764930"
  },
  {
    "text": "and that's the fact that we know\ny is just a scaled and delayed",
    "start": "2764930",
    "end": "2771670"
  },
  {
    "text": "version of x. From the physics\nof our problem, we know y is just alpha times\nx sub n minus some n tau.",
    "start": "2771670",
    "end": "2779470"
  },
  {
    "text": "So using this information and if\nyou plug that why or that model",
    "start": "2779470",
    "end": "2785970"
  },
  {
    "text": "for y into this, this cross\ncorrelation basically just becomes the autocorrelation\nof x with itself.",
    "start": "2785970",
    "end": "2794400"
  },
  {
    "text": "So what I'm doing here,\njust to be very concrete, I'm setting this\nequal to sum over k.",
    "start": "2794400",
    "end": "2800880"
  },
  {
    "text": "For y, I'm plugging in alpha\nx of k minus n sub tau,",
    "start": "2800880",
    "end": "2807630"
  },
  {
    "text": "and then that's multiplied\nby x of k minus n. Alpha as a constant\ncomes out, and then",
    "start": "2807630",
    "end": "2813930"
  },
  {
    "text": "what's under the\nsummation is just the autocorrelation of x\nthat is shifted by n sub tau.",
    "start": "2813930",
    "end": "2823310"
  },
  {
    "text": "So just to summarize,\nnow we basically have a procedure or an algorithm\nto find time of flight.",
    "start": "2823310",
    "end": "2833750"
  },
  {
    "text": "So here is a high\nlevel summary of it. A signal y is received.",
    "start": "2833750",
    "end": "2840050"
  },
  {
    "text": "And then you correlate\nthat-- and by correlate, I mean, that equation that we\njust looked at, that summation",
    "start": "2840050",
    "end": "2847640"
  },
  {
    "text": "of y and xk minus n. So you correlate\nthat with x of n, which is the waveform that the\ntransmitter and the receiver",
    "start": "2847640",
    "end": "2855290"
  },
  {
    "text": "agreed on. We know that was\nthe transmitter. So you do that correlation. You get this correlation\nfunction out.",
    "start": "2855290",
    "end": "2861110"
  },
  {
    "text": "It's a function of n. And you can take-- you\ncan square it or just take",
    "start": "2861110",
    "end": "2866180"
  },
  {
    "text": "the absolute value of it and\nthen find the maximum value",
    "start": "2866180",
    "end": "2871430"
  },
  {
    "text": "or find the peak in this\ncorrelation, and the end or the index that is the peak,\nthat is your n hat, which",
    "start": "2871430",
    "end": "2879860"
  },
  {
    "text": "is basically the discrete--\nthe discretized time of flight. And then what is-- if you want to change that\nor convert that from an index",
    "start": "2879860",
    "end": "2887509"
  },
  {
    "text": "to an actual time,\nwe said that tau hat it is n hat tau times your ts,\nwhich is your sampling interval",
    "start": "2887510",
    "end": "2896089"
  },
  {
    "text": "basically. So that's the procedure. This is also-- in\ncommunication theory,",
    "start": "2896090",
    "end": "2902480"
  },
  {
    "text": "this is very well\nknown technique for receiving signal packets. It's called matched filtering.",
    "start": "2902480",
    "end": "2908869"
  },
  {
    "text": "So in communication systems,\nthis is used very often.",
    "start": "2908870",
    "end": "2914090"
  },
  {
    "text": "Now, here's what is\nvery interesting. So as we did this derivation,\nwe did not make any assumption",
    "start": "2914090",
    "end": "2923090"
  },
  {
    "text": "about what x is. So we completely abstracted\nout the specifics of x of t",
    "start": "2923090",
    "end": "2929510"
  },
  {
    "text": "or x of n, the\ndiscrete version of it. So in general, it\ncan be anything.",
    "start": "2929510",
    "end": "2936380"
  },
  {
    "text": "The receiver and\nthe transmitter can agree on any waveform\nthey like and use that for this time of\nflight measurement.",
    "start": "2936380",
    "end": "2944120"
  },
  {
    "text": "But from this procedure, now\nthat we have an algorithm, that helps us decide, what\nis a good choice for x?",
    "start": "2944120",
    "end": "2953270"
  },
  {
    "text": "What properties should x have\nto make this procedure better,",
    "start": "2953270",
    "end": "2961920"
  },
  {
    "text": "more robust, and easier to do? OK? And so at a very\nhigh level, there's",
    "start": "2961920",
    "end": "2969380"
  },
  {
    "text": "this function that comes\nout of the correlated, we call it like are x sub\nn, which is, as we said,",
    "start": "2969380",
    "end": "2980619"
  },
  {
    "text": "just a scaled and offseted\nversion of the autocorrelation effect. So it's alpha times Rxx\nof n minus and sub tau.",
    "start": "2980620",
    "end": "2993650"
  },
  {
    "text": "So if you were free-- and\nthen the way you find ends up now is that you look at the--\nlet me use a different market",
    "start": "2993650",
    "end": "3000910"
  },
  {
    "text": "here, you look at the absolute\nvalue or the square of this--",
    "start": "3000910",
    "end": "3009740"
  },
  {
    "text": "let's ignore alpha. It's just a constant. We don't care about it. We care about\nfinding this n tau.",
    "start": "3009740",
    "end": "3015950"
  },
  {
    "text": "So as a function of\nn, if I plot, say, the absolute value\nor the absolute value",
    "start": "3015950",
    "end": "3021350"
  },
  {
    "text": "squared-- let's just plot\nthe absolute value for now. Abs of Rxx of n minus n sub tau.",
    "start": "3021350",
    "end": "3030830"
  },
  {
    "text": " It's going to be some\nfunction, and hopefully, it",
    "start": "3030830",
    "end": "3036350"
  },
  {
    "text": "has some peak. And where does peak is\nmy n hat of tau, OK?",
    "start": "3036350",
    "end": "3042859"
  },
  {
    "text": "This is the ideal. So the ideal function\nyou want here is something that has a very\nshort peak where your actual n",
    "start": "3042860",
    "end": "3051619"
  },
  {
    "text": "hat is and is almost\n0 everywhere else. And mathematically, that's\ncalled a delta function.",
    "start": "3051620",
    "end": "3058310"
  },
  {
    "text": "So if you can find with\nan autocorrelation that",
    "start": "3058310",
    "end": "3063680"
  },
  {
    "text": "is very close to\na delta function, so it has a very sharp\nlong large peak and what",
    "start": "3063680",
    "end": "3068839"
  },
  {
    "text": "we call the side lobes,\nwhich is the stuff here and here is very\nlow, ideally zero,",
    "start": "3068840",
    "end": "3074210"
  },
  {
    "text": "that would be very easy\nfor this procedure. If you have some other x\nwhere has very large side",
    "start": "3074210",
    "end": "3083210"
  },
  {
    "text": "lobes and a peak here, these\nside lobes can be troublesome.",
    "start": "3083210",
    "end": "3088520"
  },
  {
    "text": "So because we are\nfree to choose any x, we should find one with what we\ncall very good autocorrelation",
    "start": "3088520",
    "end": "3095750"
  },
  {
    "text": "properties. And good autocorrelation\nproperties, again, it's sharp\npeak and very low side lobes as close to a delta\nfunction as possible.",
    "start": "3095750",
    "end": "3102830"
  },
  {
    "text": "And then that makes\nour lives really, really easy when it comes to\ntime of flight estimation. Now, it turns out that\nthese ranging codes",
    "start": "3102830",
    "end": "3111710"
  },
  {
    "text": "that, for instance, GPS\nuses are exactly chosen according to this criteria.",
    "start": "3111710",
    "end": "3116765"
  },
  {
    "text": "These are these\nbasically functions that have really, really good\nautocorrelation properties.",
    "start": "3116765",
    "end": "3125630"
  },
  {
    "text": "And generally, there is\na family of waveforms that are called pseudo random\nnoise or PRN sequences,",
    "start": "3125630",
    "end": "3133819"
  },
  {
    "text": "and these all have very good\nautocorrelation properties. And from this family\nof PRN sequences,",
    "start": "3133820",
    "end": "3144019"
  },
  {
    "text": "the specific ones that\nGPS, for instance, uses, they are called maximal length\nsequences or MLS or also M",
    "start": "3144020",
    "end": "3151730"
  },
  {
    "text": "sequences. And those are like a subcategory\nof PRNs that the GPS uses.",
    "start": "3151730",
    "end": "3158630"
  },
  {
    "text": "Again, exactly for\nthis reason that they have very good, as we see--\nwe will see in a minute,",
    "start": "3158630",
    "end": "3164420"
  },
  {
    "text": "autocorrelation properties,\nbut also they have some other good properties. They're very, very\neasy to generate,",
    "start": "3164420",
    "end": "3170510"
  },
  {
    "text": "almost free to generate. Using just a very simple\nlinear feedback shift register, as I'll show, you\ncan generate these codes.",
    "start": "3170510",
    "end": "3178830"
  },
  {
    "text": "And if you have a shift\nregister with n bits,",
    "start": "3178830",
    "end": "3183950"
  },
  {
    "text": "that generates a code of a\nlength 2 to the n minus 1. That's just from the\nmathematics of it.",
    "start": "3183950",
    "end": "3190730"
  },
  {
    "text": "And here, now you\ncan connect two dots. When we're talking about\nthese ranging codes",
    "start": "3190730",
    "end": "3196580"
  },
  {
    "text": "like the CA or the\nPY everything-- all the number of chips and\nso on was a multiple of 1023.",
    "start": "3196580",
    "end": "3204650"
  },
  {
    "text": "And that's where the number is\ncoming from because these use sequences that have 10 bits,\nand 2 to the 10 minus 1 is 1023,",
    "start": "3204650",
    "end": "3216950"
  },
  {
    "text": "and that's the length of all the\nnumber of chips in these codes. There's this beautiful,\nbeautiful mathematical theory",
    "start": "3216950",
    "end": "3224720"
  },
  {
    "text": "behind these codes,\nand there's just so many very interesting\nthings about them. We're going to barely\nscratch the surface.",
    "start": "3224720",
    "end": "3232560"
  },
  {
    "text": "I know people who have\ndone their entire PhDs on these codes. We're not going to go\nthat deep, of course,",
    "start": "3232560",
    "end": "3238400"
  },
  {
    "text": "but I want to tell you a\nlittle more about them. Let's start with what is a\nlinear feedback shift register",
    "start": "3238400",
    "end": "3247050"
  },
  {
    "text": "and how do we\ngenerate these codes? Here's a very simple example. So we're going to\ngenerate a 15 chip",
    "start": "3247050",
    "end": "3253290"
  },
  {
    "text": "code, so that's 2 to the 4 minus\n1, which, based on what I said, you need a length for a linear\nfeedback shift register, K?",
    "start": "3253290",
    "end": "3261180"
  },
  {
    "text": "So this is how it operates. So the shift register here\njust have basically four memory",
    "start": "3261180",
    "end": "3267960"
  },
  {
    "text": "bits, so it only takes\nfour bits of memory. And you initialize\nit with four bits.",
    "start": "3267960",
    "end": "3275010"
  },
  {
    "text": "We start with 1111. That's the initial state. And then you take feedback from,\nsay, two of these memory bits,",
    "start": "3275010",
    "end": "3285630"
  },
  {
    "text": "and modulo 2 add them, and\nfeed it back to the input. So at each clock\ncycle, what happens",
    "start": "3285630",
    "end": "3292710"
  },
  {
    "text": "is that every bit as\nshifted to the right. So you go right, right, right.",
    "start": "3292710",
    "end": "3299060"
  },
  {
    "text": "And then you push out\none bit, and that's your code waveform\nx of t coming out, and then the input is\ncoming from this feedback.",
    "start": "3299060",
    "end": "3307200"
  },
  {
    "text": "So after the first\nclock cycle, you generate the first\nchip of your code, which is this one coming out.",
    "start": "3307200",
    "end": "3313130"
  },
  {
    "text": "And then what you\npush into the A3 is modulo 2 added of a 1\nand a 0, they are both one.",
    "start": "3313130",
    "end": "3320330"
  },
  {
    "text": "So you push in a 0, and\nthen you just continue. And what comes out\nof it is, again--",
    "start": "3320330",
    "end": "3326553"
  },
  {
    "text": "of course, the\nfirst four bits are going to be all ones because\nthat's how we initialized the shift register.",
    "start": "3326553",
    "end": "3332800"
  },
  {
    "text": "And then after that, it's\ngoing to, basically based on the feedback, go\nto zeros and ones.",
    "start": "3332800",
    "end": "3337869"
  },
  {
    "text": "So it generates\nthis thing for you, which is 1111000100 and so on.",
    "start": "3337870",
    "end": "3343220"
  },
  {
    "text": "But the point is, it repeats\nwith a period of exactly 15.",
    "start": "3343220",
    "end": "3348460"
  },
  {
    "text": "So if you look at\nthe first 15 bits-- and we call that a code word\nhere, then it starts to repeat.",
    "start": "3348460",
    "end": "3355480"
  },
  {
    "text": "So infinitely repeats the exact\nsame code of length 15 for you",
    "start": "3355480",
    "end": "3361210"
  },
  {
    "text": "over and over again. So this is just to illustrate\nthat it's very, very easy to generate these codes.",
    "start": "3361210",
    "end": "3367540"
  },
  {
    "text": "Almost free. I mean, in today's\ncomputer standards, this is literally free, OK?",
    "start": "3367540",
    "end": "3375880"
  },
  {
    "text": "What's also important is that\nthis feedback-- like here we have taken the feedback from\na1 and a0, this is not random.",
    "start": "3375880",
    "end": "3384550"
  },
  {
    "text": "So you need to\ntake your feedback from very specific bits\nin the shift register",
    "start": "3384550",
    "end": "3390340"
  },
  {
    "text": "to get an m sequence out\nwith the good properties that we want. And there is ways of finding\nfor a given length, what",
    "start": "3390340",
    "end": "3398680"
  },
  {
    "text": "are the feedback\ntaps that you need, and there's tables\nthat tell you that. So for instance in\nthe previous slide,",
    "start": "3398680",
    "end": "3405760"
  },
  {
    "text": "if you go to this\nhyperlink here, it's a very interesting\nwebsite that tells you,",
    "start": "3405760",
    "end": "3414470"
  },
  {
    "text": "I want to generate a\n1023-bit m sequence, and it tells you what a\nspecific feedback taps",
    "start": "3414470",
    "end": "3421720"
  },
  {
    "text": "you need to use for\nyour shift register, and then you can generate that. Another thing to note, which\nis also practically extremely",
    "start": "3421720",
    "end": "3428559"
  },
  {
    "text": "important for GPS, is that\nsay here for instance, we are generating 15 chip\nsequence, it's not unique.",
    "start": "3428560",
    "end": "3438920"
  },
  {
    "text": "So you can have different\n15 chip sequences with different basically\nshift register feedback taps.",
    "start": "3438920",
    "end": "3448450"
  },
  {
    "text": "And the autocorrelation of those\ndifferent 15 chip m sequences",
    "start": "3448450",
    "end": "3453820"
  },
  {
    "text": "are all exactly good at this-- or identical to each other,\nthey're all very good,",
    "start": "3453820",
    "end": "3459970"
  },
  {
    "text": "but the cross\ncorrelations are very low. And that's where these codes\nare like almost orthogonal.",
    "start": "3459970",
    "end": "3465880"
  },
  {
    "text": "If we think of this\ncross correlation as like an inner\nproduct between the two,",
    "start": "3465880",
    "end": "3472000"
  },
  {
    "text": "the cross correlations\nof different sequences with different numbers--\nwith the same number of chips is very low.",
    "start": "3472000",
    "end": "3478750"
  },
  {
    "text": "In the limit that the\ncodes become very long, it actually approaches\n0, which I'll tell you it's an important property.",
    "start": "3478750",
    "end": "3484880"
  },
  {
    "text": "So just as a summary,\nwhy GPS uses m sequences?",
    "start": "3484880",
    "end": "3490180"
  },
  {
    "text": "They have lots and lots\nof interesting properties. But specific to GPS, they're\nvery easily generated. You can generate them\nin hardware and software",
    "start": "3490180",
    "end": "3496780"
  },
  {
    "text": "almost for free. As I'll show you\nin a minute, they have very good autocorrelation\nproperties with very low side",
    "start": "3496780",
    "end": "3502840"
  },
  {
    "text": "lobes as we want for to do\ntime of flight estimation,",
    "start": "3502840",
    "end": "3507970"
  },
  {
    "text": "and different m sequences\nor MLs's of the same length have very small\ncross correlation.",
    "start": "3507970",
    "end": "3515030"
  },
  {
    "text": "So they are almost\northogonal, and that's how the receiver can\ndistinguish the signals between different\nGPS satellites,",
    "start": "3515030",
    "end": "3521320"
  },
  {
    "text": "because each satellite transmits\na unique m sequence for you. So let's look at the\nautocorrelation of these m",
    "start": "3521320",
    "end": "3529060"
  },
  {
    "text": "sequences. Remember that we use BPSK\nmodulation for these signals.",
    "start": "3529060",
    "end": "3534829"
  },
  {
    "text": "So we map the 0 and 1 bits\nto plus 1 and minus 1. That's how they're transmitted.",
    "start": "3534830",
    "end": "3540130"
  },
  {
    "text": "And let t chip be the duration\nof one chip of your code,",
    "start": "3540130",
    "end": "3547759"
  },
  {
    "text": "and then we're going to have-- you're going to sample it. So we work with\ndiscrete signals,",
    "start": "3547760",
    "end": "3553720"
  },
  {
    "text": "and let's say you get\nn samples per chip. So visually, basically,\nwhat we have is, let's say,",
    "start": "3553720",
    "end": "3560410"
  },
  {
    "text": "this is your code\nwaveform, and this here is going to be your t chip.",
    "start": "3560410",
    "end": "3568530"
  },
  {
    "text": "And say if, for instance, m\nequals three-- so if you sample it at three samples per\nchip, you get 1, 2, 3",
    "start": "3568530",
    "end": "3577050"
  },
  {
    "text": "samples for this\nchip, and all of these are going to be, for\ninstance, plus 1, OK?",
    "start": "3577050",
    "end": "3582720"
  },
  {
    "text": "That's how the sampling works. So x of n again,\nis x sub n times ts which in terms of the t chip and\nthe m is x is n t chip over m,",
    "start": "3582720",
    "end": "3592140"
  },
  {
    "text": "and then the n varies from\n0 to m times n minus 1. Big N is the total\nnumber of chips,",
    "start": "3592140",
    "end": "3598710"
  },
  {
    "text": "m is the number of\nsamples per chip. So your index varies from\n0 to m times n minus 1.",
    "start": "3598710",
    "end": "3605400"
  },
  {
    "text": "Now, to simplify our notation,\nlet's call m times nk.",
    "start": "3605400",
    "end": "3610859"
  },
  {
    "text": "So k is the total\nnumber of samples in the discrete code,\nbasically, after sampling",
    "start": "3610860",
    "end": "3617970"
  },
  {
    "text": "at n samples per chip. And then we can find the\nautocorrelation function here.",
    "start": "3617970",
    "end": "3623700"
  },
  {
    "text": "Because these signals\nare periodic-- so it has 2 to the\nn minus 1 chips",
    "start": "3623700",
    "end": "3630150"
  },
  {
    "text": "and it just repeats as the\nshift register operates, we don't need to\nfind an infinite sum",
    "start": "3630150",
    "end": "3637109"
  },
  {
    "text": "for the correlation. We just sum over\none period, and it's called the cyclic\nautocorrelation",
    "start": "3637110",
    "end": "3643300"
  },
  {
    "text": "for that reason. So we just take one period\nof your x sub n, vk from 0",
    "start": "3643300",
    "end": "3648360"
  },
  {
    "text": "to the k minus 1, and\nthen we are finding the autocorrelation of x.",
    "start": "3648360",
    "end": "3653670"
  },
  {
    "text": "So you multiply x of\nk by x of k minus n. But for this k minus\nn, just so that it",
    "start": "3653670",
    "end": "3659490"
  },
  {
    "text": "doesn't go out of bounds of one\nperiod, we do that modulo k.",
    "start": "3659490",
    "end": "3665330"
  },
  {
    "text": "So as you go outside\nthe one period, you just wrap around your index. So we are always bound to\njust one period of the signal,",
    "start": "3665330",
    "end": "3672780"
  },
  {
    "text": "and that is basically your\nautocorrelation function. Now, as you do the math\nand find this function,",
    "start": "3672780",
    "end": "3680849"
  },
  {
    "text": "it becomes this discrete\ntriangle function, which is very interesting. So for n equals 0,\nyou get a value of 1.",
    "start": "3680850",
    "end": "3689400"
  },
  {
    "text": "So if you plug n equals\n0 into this equation, the value of the autocorrelation\nis exactly equal to 1. And then as you deviate\nn, your index from one",
    "start": "3689400",
    "end": "3698250"
  },
  {
    "text": "go to positive or\nnegative side, as you see, it linearly decreases. So that's where this\ntriangle happens.",
    "start": "3698250",
    "end": "3705750"
  },
  {
    "text": "And then if your n is basically\nbigger than m minus 1,",
    "start": "3705750",
    "end": "3713640"
  },
  {
    "text": "you get this\nconstant side level, which is negative 1 over n.",
    "start": "3713640",
    "end": "3718829"
  },
  {
    "text": "And n, remember,\nis the total number of chips in your m sequence. So as you increase n,\nyour side load levels",
    "start": "3718830",
    "end": "3726540"
  },
  {
    "text": "become smaller and smaller. And in the limit of\nvery large codes, they actually approach 0.",
    "start": "3726540",
    "end": "3731910"
  },
  {
    "text": "So you almost get\na perfect triangle with zero side lobes as\nthe correlation function.",
    "start": "3731910",
    "end": "3738329"
  },
  {
    "text": "OK. So one important thing\nabout this function-- again,",
    "start": "3738330",
    "end": "3743369"
  },
  {
    "text": "because we are working\nwith periodic signals, the autocorrelation\nfunction also is periodic with a\nperiod of k, where",
    "start": "3743370",
    "end": "3750660"
  },
  {
    "text": "k is the total number of samples\nin one period of your code",
    "start": "3750660",
    "end": "3756119"
  },
  {
    "text": "or sample code. So Rxx of n plus a multiple of\nk is exactly equal to Rxx of k.",
    "start": "3756120",
    "end": "3764490"
  },
  {
    "text": "And for the cyclic\ncorrelation, again, it's",
    "start": "3764490",
    "end": "3770100"
  },
  {
    "text": "like a linear operation. So if you shift your x,\nfor instance, by some n0,",
    "start": "3770100",
    "end": "3777720"
  },
  {
    "text": "the autocorrelation also\ngets shifted by the same n0.",
    "start": "3777720",
    "end": "3784050"
  },
  {
    "text": "That's just a property of\nthis linear filter basically.",
    "start": "3784050",
    "end": "3789600"
  },
  {
    "text": "OK. So this is-- basically here, we\nare reiterating the same fact that the minus 1 over n is\nlike your side lobe level",
    "start": "3789600",
    "end": "3797850"
  },
  {
    "text": "for these codes. And as you increase n, which\nis the number of chips,",
    "start": "3797850",
    "end": "3803220"
  },
  {
    "text": "you get smaller and\nsmaller side lobe. So just to compare, your course\nacquisition code, for instance, remember it had 1023 chips, so\nyour side lobe level is minus 1",
    "start": "3803220",
    "end": "3813510"
  },
  {
    "text": "over 1023. Already pretty low. But if you just compare that\nto PY which is a military code,",
    "start": "3813510",
    "end": "3818820"
  },
  {
    "text": "and that had times\n10 to the 12 chips, it has much, much,\nmuch lower side lobe.",
    "start": "3818820",
    "end": "3824370"
  },
  {
    "text": "And that's why the military\nGPS gets better SNR because it's less-- the\ncorrelation functions are",
    "start": "3824370",
    "end": "3831210"
  },
  {
    "text": "less noisy. Now, graphically, perhaps\nthis is the easiest way",
    "start": "3831210",
    "end": "3836279"
  },
  {
    "text": "to see what's happening here. So the 15 chip code that we\ngenerated using the shift",
    "start": "3836280",
    "end": "3843120"
  },
  {
    "text": "register in a couple\nof slides before, let's sample that at\nfour samples per chip,",
    "start": "3843120",
    "end": "3848220"
  },
  {
    "text": "and then we find the\nautocorrelation function of it. And this is Rxx of n\nas a function of n,",
    "start": "3848220",
    "end": "3853650"
  },
  {
    "text": "and it's exactly the\nproperties that we want. You get very sharp\npeak at 0, and that's",
    "start": "3853650",
    "end": "3860369"
  },
  {
    "text": "your triangle function there. You see the samples linearly\ndrop as you go away from 0,",
    "start": "3860370",
    "end": "3867510"
  },
  {
    "text": "and then you get this side\nlobe level, which in this case is exactly minus 1 over\nn, which is 15, OK?",
    "start": "3867510",
    "end": "3877080"
  },
  {
    "text": "So that's that. Now, just to show you why\nthese codes are magical-- I mean, call them\npseudo random noise.",
    "start": "3877080",
    "end": "3883690"
  },
  {
    "text": "So the name is\nmisleading because it suggests that they're\njust like random bits. So let's generate a 15 chip\nrandom binary sequence.",
    "start": "3883690",
    "end": "3893250"
  },
  {
    "text": "You go on Python, you\nuse your rand function, binaries it to 0s and 1 15\nbits, and then sample that",
    "start": "3893250",
    "end": "3900089"
  },
  {
    "text": "at four samples per chip, and\nthen find the autocorrelation function of that. And you get something\nlike this, OK?",
    "start": "3900090",
    "end": "3907080"
  },
  {
    "text": "Well, yes, you still have-- the peak is at 0, sure, but\nlook at the side load levels",
    "start": "3907080",
    "end": "3913260"
  },
  {
    "text": "here and compare that\nto the m sequence. I mean, it's day\nand night different.",
    "start": "3913260",
    "end": "3918539"
  },
  {
    "text": "I mean, assume how\nmuch SNR gain you get. Again, remember, to\nfind time of flight,",
    "start": "3918540",
    "end": "3924180"
  },
  {
    "text": "you're searching for this peak. So if your side lobes are too\nhigh, there's going to be noise",
    "start": "3924180",
    "end": "3929580"
  },
  {
    "text": "and nonidealities\nand nonlinearities added that corrupt the signal. So if you don't have a\nvery solid foundation",
    "start": "3929580",
    "end": "3938309"
  },
  {
    "text": "for your autocorrelation\nto start with, as you add noise and\nother nonidealities, it's just going to\nmake it very, very hard",
    "start": "3938310",
    "end": "3944910"
  },
  {
    "text": "for you to find that peak. So that's why you don't want\nto work with random sequences. You want to work\nwith these codes that",
    "start": "3944910",
    "end": "3951750"
  },
  {
    "text": "have really, really good\ncorrelation properties to start with.",
    "start": "3951750",
    "end": "3957390"
  },
  {
    "text": "OK. One more thing. So let's look at\none more example.",
    "start": "3957390",
    "end": "3962730"
  },
  {
    "text": "Here, we are working with\nslightly longer code, so 31 chips. So these are coming\nfrom a five-bit--",
    "start": "3962730",
    "end": "3968580"
  },
  {
    "text": "is that five-- yeah,\nfive-bit shift register. And now we are generating\ntwo of them, OK?",
    "start": "3968580",
    "end": "3974440"
  },
  {
    "text": "So we do two different shift\nregisters with feedback tabs. Let's say we go to that\nwebsite that there's a link.",
    "start": "3974440",
    "end": "3980880"
  },
  {
    "text": "You go where it says,\nOK, five-bit shift LFSRs, and you choose two of\nbasically feedback tap values",
    "start": "3980880",
    "end": "3990600"
  },
  {
    "text": "that it gives you. You generate those\nshift registers, and then you get an x1 and\nan x2, both are 31 chips,",
    "start": "3990600",
    "end": "3999750"
  },
  {
    "text": "and we sample them at\nthree samples per chip, OK? If you find the\nautocorrelation of x1--",
    "start": "3999750",
    "end": "4006290"
  },
  {
    "text": "so Rx1x1 or Rx2x2,\nthey're identical. Exact same. Both give you this very\nnice triangle, sharp peak,",
    "start": "4006290",
    "end": "4015470"
  },
  {
    "text": "with side lobe level\nthat is minus 1 over 31.",
    "start": "4015470",
    "end": "4020840"
  },
  {
    "text": "Now, if you look at the cross\ncorrelation of the two-- so you find Rx1x2, you\nwould see that it's",
    "start": "4020840",
    "end": "4026900"
  },
  {
    "text": "not exactly 0 everywhere,\nbut it's pretty low. It doesn't have a sharp\npeak or anything like that.",
    "start": "4026900",
    "end": "4033870"
  },
  {
    "text": "So this is that principle of\northogonality of these codes. So now from this, you can\nimagine if you are a receiver",
    "start": "4033870",
    "end": "4042780"
  },
  {
    "text": "and there's this 30 something\nsatellites in orbit, each is transmitting\na different m sequence",
    "start": "4042780",
    "end": "4047870"
  },
  {
    "text": "and you know exactly\nall the m sequences, but then you can build\ncorrelators and make",
    "start": "4047870",
    "end": "4053180"
  },
  {
    "text": "the kernel of these correlators\ncorrespond to different codes from different satellites.",
    "start": "4053180",
    "end": "4058400"
  },
  {
    "text": "And as you feed in,\nyou receive signals. By this principle of\northogonality clarity,",
    "start": "4058400",
    "end": "4063800"
  },
  {
    "text": "each correlator\njust shows a peak for the code that corresponds to\nthe kernel of the correlation,",
    "start": "4063800",
    "end": "4070849"
  },
  {
    "text": "and it naturally filters\nout the interference from the other\nsatellites for you.",
    "start": "4070850",
    "end": "4075860"
  },
  {
    "text": "And this is what\nis the principle of basically code\ndivision multiple",
    "start": "4075860",
    "end": "4080870"
  },
  {
    "text": "access that the receiver-- the GPS system receivers use. And that's how they\ncan distinguish signals",
    "start": "4080870",
    "end": "4088700"
  },
  {
    "text": "from different satellites,\nalthough they're transmitted at the exact same\nfrequency, so you",
    "start": "4088700",
    "end": "4093770"
  },
  {
    "text": "get a lot of in\nprinciple interference when you receive these signals.",
    "start": "4093770",
    "end": "4098929"
  },
  {
    "text": "But by basically just using\nthis almost orthogonality",
    "start": "4098930",
    "end": "4104630"
  },
  {
    "text": "of the signals through\nthe correlators, you can completely\nseparate them out, OK?",
    "start": "4104630",
    "end": "4110660"
  },
  {
    "text": "So let's summarize. How does this time of flight\nranging work for the receivers?",
    "start": "4110660",
    "end": "4117649"
  },
  {
    "text": "So we start with\nthe GPS satellite, and let's look at the\nidealized scenario now. So we're not accounting\nfor timing offsets",
    "start": "4117649",
    "end": "4124429"
  },
  {
    "text": "and a few other effects\nthat I'll tell you. So let's say this\nis ideal scenario. So the satellite transmits\na unique code, x of t,",
    "start": "4124430",
    "end": "4131929"
  },
  {
    "text": "at some carrier\nfrequency f sub c, which is one of the\nfive GPS frequencies. X of t and carrier frequency\nare known to the receiver.",
    "start": "4131930",
    "end": "4141799"
  },
  {
    "text": "And what the receiver does\nis as it receives the signal, it's coming in\nmodulated at f sub c.",
    "start": "4141800",
    "end": "4149089"
  },
  {
    "text": "So if first demodulates the\nsignal by the carrier frequency to bring it basically to\nbaseband, and what it gives",
    "start": "4149090",
    "end": "4156140"
  },
  {
    "text": "you is just some delayed version\nof x of t by time of flight. So receiver recovers this y of\nt, which is x of t minus tau,",
    "start": "4156140",
    "end": "4163729"
  },
  {
    "text": "and we are ignoring attenuation. Remember, that there is some\nattenuation factor alpha here.",
    "start": "4163729",
    "end": "4169609"
  },
  {
    "text": "It does not affect\nthe GPS in any way. So we can completely\nignore that.",
    "start": "4169609",
    "end": "4175560"
  },
  {
    "text": "Assume there is no attenuation. We are just looking\nfor a time of flight. And again, this is\nidealized scenario.",
    "start": "4175560",
    "end": "4181778"
  },
  {
    "text": "So receiver has its clock\nperfectly synchronized with the transmitter for\nnow, so tau sub d zero,",
    "start": "4181779",
    "end": "4188040"
  },
  {
    "text": "we'll talk about that later. And what the receiver\ncan do is that it",
    "start": "4188040",
    "end": "4193560"
  },
  {
    "text": "generates a local replica\nof the ranging code. Call that x hat of t.",
    "start": "4193560",
    "end": "4199440"
  },
  {
    "text": "So x hat of t is exactly\nequal to x of t because x of t is known to the receiver.",
    "start": "4199440",
    "end": "4205170"
  },
  {
    "text": "The clock is perfectly\nsynchronized, so you can generate a local\nreplica of the ranging code.",
    "start": "4205170",
    "end": "4210750"
  },
  {
    "text": "And then what the\nreceiver does is that it calculates the\ncorrelation between x hat,",
    "start": "4210750",
    "end": "4216100"
  },
  {
    "text": "which is the local\nreplica, and y of t, which is the delayed\nversion of the code,",
    "start": "4216100",
    "end": "4221760"
  },
  {
    "text": "and that correlation\nwill have a peak exactly at the time of flight tau.",
    "start": "4221760",
    "end": "4229050"
  },
  {
    "text": "Or in the discrete\nversion, it has a peak at the index that corresponds to\nthe discretized time of flight.",
    "start": "4229050",
    "end": "4235810"
  },
  {
    "text": "So you find the peak,\nyou find the index of the correlation\nfor that peak,",
    "start": "4235810",
    "end": "4241980"
  },
  {
    "text": "and then you estimate\nyour time of flight. Tau hat is the-- receiver's\nestimate of the time of flight",
    "start": "4241980",
    "end": "4247770"
  },
  {
    "text": "is just n hat times the sampling\ninterval, which is t sub s. And then you can\nconvert the time",
    "start": "4247770",
    "end": "4254130"
  },
  {
    "text": "to the range using the\ntime of flight principle. So you just multiply your tau\nhat by the speed of light,",
    "start": "4254130",
    "end": "4259320"
  },
  {
    "text": "and that gives\nyou the range, OK? Simple procedure. Let's see how it\nworks graphically.",
    "start": "4259320",
    "end": "4265960"
  },
  {
    "text": "So again, same idea. This is some pictures\nto illustrate.",
    "start": "4265960",
    "end": "4271390"
  },
  {
    "text": "So your satellite is\ntransmitting this ranging code, x of t at some m sequence.",
    "start": "4271390",
    "end": "4276850"
  },
  {
    "text": "And this is star here is\njust for us to visually track at reference point in time.",
    "start": "4276850",
    "end": "4282449"
  },
  {
    "text": "There's no physical\nsignificance to it really. So that's x of t. What the receiver receives is\nx of t delayed by some tau,",
    "start": "4282450",
    "end": "4291600"
  },
  {
    "text": "so your star shifts\nby tau seconds. But also, because the\nreceiver is perfectly",
    "start": "4291600",
    "end": "4298590"
  },
  {
    "text": "synchronized to\nthe transmitter, it can generate a local\nreplica, x hat,",
    "start": "4298590",
    "end": "4303810"
  },
  {
    "text": "of the code, which is perfectly\naligned with the satellite's version, OK?",
    "start": "4303810",
    "end": "4309810"
  },
  {
    "text": "For now, we are\nignoring timing offsets. And then what you do is you\nlook at the correlation of x hat",
    "start": "4309810",
    "end": "4316020"
  },
  {
    "text": "with y, and that correlation--\nright now, there is no noise. Everything is ideal.",
    "start": "4316020",
    "end": "4321869"
  },
  {
    "text": "Everything is perfect. So it gives you a perfect\ntriangle function with a peak at n hat, which is your\ndiscrete time of flight.",
    "start": "4321870",
    "end": "4329400"
  },
  {
    "text": "It's just tau over ts. The floor of tau over\nts, you find your n hat.",
    "start": "4329400",
    "end": "4334500"
  },
  {
    "text": "Multiplied by ts, that\ngives you a tau hat. Multiplied by c,\nthat gives you range. So that's how ranging in\nidealized scenario works, OK?",
    "start": "4334500",
    "end": "4343980"
  },
  {
    "text": "Now, let's talk about\na few nonidealities. The first one is, of course-- which is the big\none, is the fact",
    "start": "4343980",
    "end": "4349890"
  },
  {
    "text": "that you never have\nyour clock as a receiver perfectly synchronized\nwith the GPS.",
    "start": "4349890",
    "end": "4355230"
  },
  {
    "text": "So what happens in\nthat scenario is that the local\nreplica of the code that the receiver generates,\nit is not perfectly aligned.",
    "start": "4355230",
    "end": "4364980"
  },
  {
    "text": "It is offset by some tau\nsub d from the receiver. It's OK.",
    "start": "4364980",
    "end": "4370197"
  },
  {
    "text": "You can still do\neverything we talked about. You can look at the correlation\nof your local replica with x,",
    "start": "4370197",
    "end": "4376559"
  },
  {
    "text": "find the correlation\npeak, and convert that to a time of flight. But now, you should remember\nthat what you recover",
    "start": "4376560",
    "end": "4383219"
  },
  {
    "text": "is not just the\ntime of flight tau. What you recover is tau plus\nyour timing offset, tau sub d.",
    "start": "4383220",
    "end": "4389940"
  },
  {
    "text": "So then when you\nconvert that to range-- when you multiply by\nthe speed of light,",
    "start": "4389940",
    "end": "4395250"
  },
  {
    "text": "you don't get the\nphysical range. You get what we call\nthe pseudo range. Call it rho.",
    "start": "4395250",
    "end": "4400260"
  },
  {
    "text": "So rho is c times tau hat,\nand tau hat, in this case, is the actual tau, the\nphysical time of flight,",
    "start": "4400260",
    "end": "4406080"
  },
  {
    "text": "plus your tau d. C times tau is the\nphysical range r, and then you get this error\nterm, which is c times tau",
    "start": "4406080",
    "end": "4413355"
  },
  {
    "text": "d that the receiver later\nneeds to correct for. But for now, from these\nprinciples using these codes,",
    "start": "4413355",
    "end": "4421620"
  },
  {
    "text": "receiver recovers a pseudo\nrange for every satellite, not the physical range. And next time, I'll tell you\nhow you can convert your pseudo",
    "start": "4421620",
    "end": "4430110"
  },
  {
    "text": "range to a physical range. There's two more\nnon ideologies, just to make things more\ncomplicated for the receiver,",
    "start": "4430110",
    "end": "4437040"
  },
  {
    "text": "that I want to talk about. The first one is Doppler shift. So what Doppler shift\nis is that in practice,",
    "start": "4437040",
    "end": "4446040"
  },
  {
    "text": "neither receiver in most\ncases and definitely not the transmitter\nare stationary.",
    "start": "4446040",
    "end": "4451410"
  },
  {
    "text": "These are moving, and\nespecially the satellite is moving at very\nhigh velocities. So they have some relative\nvelocity, delta V,",
    "start": "4451410",
    "end": "4458460"
  },
  {
    "text": "which is the velocity of the\nreceiver minus the velocity of the satellite. Now, what happens in practice\nis that if there is a component",
    "start": "4458460",
    "end": "4468960"
  },
  {
    "text": "of the velocity that is radio-- and by radio, I mean,\nit's in the direction of the line that connects the\nreceiver to the transmitter.",
    "start": "4468960",
    "end": "4476880"
  },
  {
    "text": "If that delta V has\na radial component, that would cause, from\nthe receivers point",
    "start": "4476880",
    "end": "4482699"
  },
  {
    "text": "of view, a shift in the\ncarrier frequency, which is called the Doppler shift. And the Doppler shift is\ngiven by this expression here.",
    "start": "4482700",
    "end": "4490930"
  },
  {
    "text": "So you take your\ndelta V, you projected into the radial\ndirection-- this r",
    "start": "4490930",
    "end": "4495960"
  },
  {
    "text": "hat is a unit vector that\npoints from the receiver to the satellite. And delta V, in our\nproduct with r hat,",
    "start": "4495960",
    "end": "4502980"
  },
  {
    "text": "you project that\nrelative velocity to find the component\nof it that is radio.",
    "start": "4502980",
    "end": "4511050"
  },
  {
    "text": "Divide that by the speed\nof light, multiplied by your carrier frequency,\nand that is the Doppler shift",
    "start": "4511050",
    "end": "4517199"
  },
  {
    "text": "f sub d. So receiver, even if\neverything was perfect, it had a perfect\ncrystal oscillator",
    "start": "4517200",
    "end": "4524700"
  },
  {
    "text": "and there was no noise\nor anything, just because of the movement, from the\nreceiver's point of view,",
    "start": "4524700",
    "end": "4530370"
  },
  {
    "text": "the signal doesn't come at\na carrier frequency of fc. It comes at-- fc shifted\nby the Doppler shift, OK?",
    "start": "4530370",
    "end": "4538200"
  },
  {
    "text": "In reality, there\nis other things there's like inaccuracies\nin the local oscillators that the receiver uses\nat some timing jitter.",
    "start": "4538200",
    "end": "4546970"
  },
  {
    "text": "So that also becomes like\nan apparent Doppler shift.",
    "start": "4546970",
    "end": "4552930"
  },
  {
    "text": "And this effect\ncan be pretty big. So for typical velocities of\nGPS satellites and devices",
    "start": "4552930",
    "end": "4559830"
  },
  {
    "text": "that operate on\nEarth, f sub d can be as large as plus\nand minus 10 kilohertz,",
    "start": "4559830",
    "end": "4565990"
  },
  {
    "text": "which is significant. Now, what happens is\nthat as I was describing this procedure of time\nof flight ranging,",
    "start": "4565990",
    "end": "4572489"
  },
  {
    "text": "the first step for\nthe receiver was to demodulate the\nreceived signal by f sub c to bring it to basement.",
    "start": "4572490",
    "end": "4579480"
  },
  {
    "text": "Now, if you ignore\nyour Doppler shift, if you just use the\nnominal carrier frequency,",
    "start": "4579480",
    "end": "4585810"
  },
  {
    "text": "you don't bring your\nsignal to basement. There's going to be\nsome offset modulation by the Doppler shift.",
    "start": "4585810",
    "end": "4592170"
  },
  {
    "text": "And that would significantly\nalmost entirely kill your correlation SNR.",
    "start": "4592170",
    "end": "4599470"
  },
  {
    "text": "So it is essential\nfor the receiver to also estimate the Doppler\nshift somehow and track it.",
    "start": "4599470",
    "end": "4606540"
  },
  {
    "text": "And when it wants to\ndemodulate, not just demodulate by the nominal\ncarrier frequency fc,",
    "start": "4606540",
    "end": "4612510"
  },
  {
    "text": "it should modulate by fc\nplus the Doppler shift to perfectly bring your received\nsignal down to basement,",
    "start": "4612510",
    "end": "4620070"
  },
  {
    "text": "and then do correlation on it. Super essential. So just to summarize,\nthere's this receiver",
    "start": "4620070",
    "end": "4628230"
  },
  {
    "text": "to find pseudo ranges, it\nneeds to do two things. It needs to find and track and\ncompensate for Doppler shift,",
    "start": "4628230",
    "end": "4636270"
  },
  {
    "text": "and it also needs to\nfind these time of flight",
    "start": "4636270",
    "end": "4641760"
  },
  {
    "text": "plus its timing\noffset, tau plus tau d, using the correlation\nprinciple, and then",
    "start": "4641760",
    "end": "4647520"
  },
  {
    "text": "it can recover a pseudo\nrange to each satellite. And then it can use the sudo\nranges to basically find",
    "start": "4647520",
    "end": "4655470"
  },
  {
    "text": "a time of flight. I'm sorry, it can use pseudo\nranges to localize itself.",
    "start": "4655470",
    "end": "4661679"
  },
  {
    "text": "And that will be the\nnext topic we talk about. There is a third\ncomplication here,",
    "start": "4661680",
    "end": "4667470"
  },
  {
    "text": "and I'll briefly mention it\nand complete it next time because we are\nrunning out of time. And that has to do\nwith the fact that when",
    "start": "4667470",
    "end": "4674970"
  },
  {
    "text": "I introduced this\nconcept of correlation, I told you that it is-- because we are transmitting\nsignals periodically,",
    "start": "4674970",
    "end": "4682260"
  },
  {
    "text": "your correlation function\nis also periodic. We just calculated over\none period of the code,",
    "start": "4682260",
    "end": "4688320"
  },
  {
    "text": "but it is a periodic function. So your Rxx, if you add any\nmultiple of the code length",
    "start": "4688320",
    "end": "4695670"
  },
  {
    "text": "to the index, the\nvalue doesn't change. So graphically, what happens\nis if I do this Ryx hat, which",
    "start": "4695670",
    "end": "4705060"
  },
  {
    "text": "is the correlation\nof my received signal with the local\nreplica of the code, if I calculate that and plot\nthat not over just one period,",
    "start": "4705060",
    "end": "4713460"
  },
  {
    "text": "just k samples, but over like\nall possible values of n, it's a periodic function,\nwhich means the peak also",
    "start": "4713460",
    "end": "4721170"
  },
  {
    "text": "repeats every k samples. So you don't get just one peak.",
    "start": "4721170",
    "end": "4727170"
  },
  {
    "text": "If you look at an extended\nbase for this dysfunction, you actually get an\ninfinite number of peaks.",
    "start": "4727170",
    "end": "4733230"
  },
  {
    "text": "It repeats every\nk samples, which is the duration of your code. So then the question is,\nthis idea of range ambiguity",
    "start": "4733230",
    "end": "4740550"
  },
  {
    "text": "is like, which of these\ninfinite number of peaks is the real peak? Which of them corresponds to\nthe actual time of flight,",
    "start": "4740550",
    "end": "4748710"
  },
  {
    "text": "and then which are just\nartifacts of the math? It's very important because if\nyou just pick the first one,",
    "start": "4748710",
    "end": "4756120"
  },
  {
    "text": "you don't know is\nthat real or is it just an artifact of the math? And next time, I'll tell\nyou how you disambiguate.",
    "start": "4756120",
    "end": "4761550"
  },
  {
    "text": "There is a few different ideas\nfor range disambiguation. Any questions before we quit?",
    "start": "4761550",
    "end": "4768599"
  },
  {
    "text": "Yes. Like geostationary\norbits, is the Doppler effect reduced or\nis it still present?",
    "start": "4768600",
    "end": "4774690"
  },
  {
    "text": "It's still present because-- well, first you\nreceiver can move.",
    "start": "4774690",
    "end": "4779903"
  },
  {
    "text": "You're in a car. You're moving, so\nthat still affects it. There is some very\nlucky situations",
    "start": "4779903",
    "end": "4785760"
  },
  {
    "text": "that the two movements\ncancel each other or there is no radial component\nto it or something like that.",
    "start": "4785760",
    "end": "4791070"
  },
  {
    "text": "But almost always, there\nis some Doppler shift. Yeah. OK, I'll see you next time.",
    "start": "4791070",
    "end": "4797070"
  },
  {
    "text": "Thank you. ",
    "start": "4797070",
    "end": "4802000"
  }
]