[
  {
    "text": "Our next topic is the\nfalse discovery rate.",
    "start": "0",
    "end": "2150"
  },
  {
    "text": "This is similar to the\nfamily-wise error rate.",
    "start": "2150",
    "end": "4190"
  },
  {
    "text": "This is a sort of quantity that\nstatisticians have worked out",
    "start": "4190",
    "end": "8360"
  },
  {
    "text": "how to design testing\nprocedures so that we have",
    "start": "8360",
    "end": "11120"
  },
  {
    "text": "a guarantee that we can\ncontrol this quantity",
    "start": "11120",
    "end": "14270"
  },
  {
    "text": "at a reasonable level.",
    "start": "14270",
    "end": "15750"
  },
  {
    "text": "And so the big difference\nbetween the false discovery",
    "start": "15750",
    "end": "18272"
  },
  {
    "text": "rate and the\nfamily-wise error rate",
    "start": "18272",
    "end": "19730"
  },
  {
    "text": "is the false discovery rate\nis really not as strict.",
    "start": "19730",
    "end": "22430"
  },
  {
    "text": "The family-wise error rate,\nwhat it tries to control",
    "start": "22430",
    "end": "25460"
  },
  {
    "text": "is a chance of\nmaking any mistakes.",
    "start": "25460",
    "end": "27679"
  },
  {
    "text": "And the false discovery\nrate, roughly speaking,",
    "start": "27680",
    "end": "30200"
  },
  {
    "text": "tries to control the proportion\nof mistakes among the rejected",
    "start": "30200",
    "end": "34760"
  },
  {
    "text": "that we make.",
    "start": "34760",
    "end": "35670"
  },
  {
    "text": "So if we make-- if we\nreject 100 hypotheses,",
    "start": "35670",
    "end": "41269"
  },
  {
    "text": "we can expect if we\ncontrol the false discovery",
    "start": "41270",
    "end": "43700"
  },
  {
    "text": "rate around 20%, that\nabout 20 of those 100",
    "start": "43700",
    "end": "46880"
  },
  {
    "text": "are likely to be truly null,\nthat we didn't actually",
    "start": "46880",
    "end": "50000"
  },
  {
    "text": "make a discovery.",
    "start": "50000",
    "end": "50840"
  },
  {
    "text": "But on the other hand,\nwe would have made maybe",
    "start": "50840",
    "end": "53030"
  },
  {
    "text": "80 out of 100 true discoveries.",
    "start": "53030",
    "end": "55324"
  },
  {
    "text": "In many situations, this\nis much more useful.",
    "start": "55325",
    "end": "57980"
  },
  {
    "text": "You think of a\nbiologist who's looking",
    "start": "57980",
    "end": "59780"
  },
  {
    "text": "to find genes that are\nresponsible for a type",
    "start": "59780",
    "end": "62579"
  },
  {
    "text": "of cancer.",
    "start": "62580",
    "end": "64410"
  },
  {
    "text": "If you declare there's 25 genes\nresponsible based on testing",
    "start": "64410",
    "end": "68910"
  },
  {
    "text": "and you say the false\ndiscovery rate is 5%,",
    "start": "68910",
    "end": "74770"
  },
  {
    "text": "then you know you have\nsome idea of those 25 genes",
    "start": "74770",
    "end": "79320"
  },
  {
    "text": "that you've discovered\nhow many are",
    "start": "79320",
    "end": "81659"
  },
  {
    "text": "likely to be false discoveries.",
    "start": "81660",
    "end": "84330"
  },
  {
    "text": "But the bulk of them\nwill be good discoveries.",
    "start": "84330",
    "end": "87570"
  },
  {
    "text": "That's a more meaningful way\nof controlling the error rate",
    "start": "87570",
    "end": "91860"
  },
  {
    "text": "when you do multiple testing.",
    "start": "91860",
    "end": "94260"
  },
  {
    "text": "Yeah, so there are some places\nwhere family-wise error rate",
    "start": "94260",
    "end": "96990"
  },
  {
    "text": "might be like in\na clinical trial,",
    "start": "96990",
    "end": "98536"
  },
  {
    "text": "for instance, if you don't\nwant to have any really",
    "start": "98537",
    "end": "100620"
  },
  {
    "text": "adverse reactions that might\nbe better rather than having",
    "start": "100620",
    "end": "103140"
  },
  {
    "text": "some proportion of\nadverse reactions",
    "start": "103140",
    "end": "104700"
  },
  {
    "text": "you might want to have very few.",
    "start": "104700",
    "end": "106259"
  },
  {
    "text": "So their applications vary\nbut false discovery rate",
    "start": "106260",
    "end": "110460"
  },
  {
    "text": "is certainly a very, very\npopular and meaningful",
    "start": "110460",
    "end": "112830"
  },
  {
    "text": "in many contexts.",
    "start": "112830",
    "end": "114010"
  },
  {
    "text": "So instead of genes like\nTrevor's example here,",
    "start": "114010",
    "end": "117900"
  },
  {
    "text": "we're going to apply\nthe false discovery",
    "start": "117900",
    "end": "120000"
  },
  {
    "text": "rate to our fund manager.",
    "start": "120000",
    "end": "121260"
  },
  {
    "text": "So we have 2,000 fund managers.",
    "start": "121260",
    "end": "123270"
  },
  {
    "text": "Earlier, we looked\nat five of them",
    "start": "123270",
    "end": "125250"
  },
  {
    "text": "and we're going\nto try and choose",
    "start": "125250",
    "end": "128100"
  },
  {
    "text": "a threshold for the p values\nto control the false discovery",
    "start": "128100",
    "end": "135550"
  },
  {
    "text": "rate.",
    "start": "135550",
    "end": "136050"
  },
  {
    "text": "And the big difference in\nterms of implementation,",
    "start": "136050",
    "end": "138840"
  },
  {
    "text": "we're going to use the same\nfunction to compute adjusted P",
    "start": "138840",
    "end": "142260"
  },
  {
    "text": "values, instead of\nHolm and Bonferroni,",
    "start": "142260",
    "end": "145799"
  },
  {
    "text": "we give this fdr_bh\nas the argument.",
    "start": "145800",
    "end": "149050"
  },
  {
    "text": "So FDR stands for\nfalse discovery rate,",
    "start": "149050",
    "end": "151530"
  },
  {
    "text": "BH stands for\nBenjamini-Hochberg,",
    "start": "151530",
    "end": "154140"
  },
  {
    "text": "which is the procedure\nthat's used to control",
    "start": "154140",
    "end": "157020"
  },
  {
    "text": "the family-wise error rate.",
    "start": "157020",
    "end": "159690"
  },
  {
    "text": "OK.",
    "start": "159690",
    "end": "160200"
  },
  {
    "text": "And so when we look at the--\nthese things are called--",
    "start": "160200",
    "end": "163739"
  },
  {
    "text": "often called values q\nrather than p values.",
    "start": "163740",
    "end": "167590"
  },
  {
    "text": "So when we look at now\nthe first 10 q values,",
    "start": "167590",
    "end": "170879"
  },
  {
    "text": "we actually see a really\nstrong performing manager,",
    "start": "170880",
    "end": "173760"
  },
  {
    "text": "actually no longer is under 5%.",
    "start": "173760",
    "end": "176700"
  },
  {
    "text": "On the other hand--",
    "start": "176700",
    "end": "179040"
  },
  {
    "text": "well, it's not necessarily clear\nthat 5% is the right threshold.",
    "start": "179040",
    "end": "183360"
  },
  {
    "text": "Often for FDR, people\nwill choose a threshold",
    "start": "183360",
    "end": "185490"
  },
  {
    "text": "like 20% instead of 5%.",
    "start": "185490",
    "end": "187990"
  },
  {
    "text": "So the 20% FDR cut off\nmanager, the first manager",
    "start": "187990",
    "end": "193290"
  },
  {
    "text": "looks pretty well.",
    "start": "193290",
    "end": "194110"
  },
  {
    "text": "So maybe you will still want\nhis phone number later, Trevor.",
    "start": "194110",
    "end": "198570"
  },
  {
    "text": "OK.",
    "start": "198570",
    "end": "201210"
  },
  {
    "text": "So let's take a look\ncomparing these two methods.",
    "start": "201210",
    "end": "205630"
  },
  {
    "text": "So suppose we control\nfalse discovery at 10%,",
    "start": "205630",
    "end": "209280"
  },
  {
    "text": "how many of our managers\nare out of the 2,000,",
    "start": "209280",
    "end": "213150"
  },
  {
    "text": "seem to be beating the\nmarket at a level of 10%?",
    "start": "213150",
    "end": "218280"
  },
  {
    "text": "Well, it seems there\nare 146 of them that",
    "start": "218280",
    "end": "221430"
  },
  {
    "text": "beat the market-- that according\nto this threshold of 10%",
    "start": "221430",
    "end": "225000"
  },
  {
    "text": "are beating the market.",
    "start": "225000",
    "end": "226060"
  },
  {
    "text": "So we'd expect out of\nthese 150, roughly 15 or so",
    "start": "226060",
    "end": "231948"
  },
  {
    "text": "might be ones who can't\nreally beat the market",
    "start": "231948",
    "end": "234750"
  },
  {
    "text": "and are maybe guessing randomly\nor something like that.",
    "start": "234750",
    "end": "238060"
  },
  {
    "text": "Let's compare that\nto Bonferroni.",
    "start": "238060",
    "end": "240569"
  },
  {
    "text": "So the simple way to implement\nthe Bonferroni procedure",
    "start": "240570",
    "end": "244290"
  },
  {
    "text": "is just to take the raw\np values and we either",
    "start": "244290",
    "end": "249480"
  },
  {
    "text": "multiply them and compare\nit to 10% or take the 10%",
    "start": "249480",
    "end": "253500"
  },
  {
    "text": "and divide it by the\nnumber of p values.",
    "start": "253500",
    "end": "255670"
  },
  {
    "text": "So 0.01 divided by 2,000.",
    "start": "255670",
    "end": "257549"
  },
  {
    "text": "And we see here\nactually no one seems",
    "start": "257550",
    "end": "259229"
  },
  {
    "text": "to be outperforming\nthe market that way.",
    "start": "259230",
    "end": "262360"
  },
  {
    "text": "So if these were genes\nand there were actually",
    "start": "262360",
    "end": "264810"
  },
  {
    "text": "some really important\ngenes, well, we",
    "start": "264810",
    "end": "266669"
  },
  {
    "text": "would have made more discoveries\nfor potential future research",
    "start": "266670",
    "end": "271020"
  },
  {
    "text": "if we controlled false discovery\nrate than family-wise error",
    "start": "271020",
    "end": "274440"
  },
  {
    "text": "rate.",
    "start": "274440",
    "end": "276340"
  },
  {
    "text": "So there's a plot\nthat goes along",
    "start": "276340",
    "end": "278100"
  },
  {
    "text": "with the Benjamini-Hochberg\nprocedure that's quite popular,",
    "start": "278100",
    "end": "281970"
  },
  {
    "text": "and we're just going to\ntake a look at it below.",
    "start": "281970",
    "end": "284535"
  },
  {
    "text": "So there's a particular\nrule for Benjamini-Hochberg",
    "start": "284535",
    "end": "292230"
  },
  {
    "text": "and I'll just write\nit quickly here.",
    "start": "292230",
    "end": "294420"
  },
  {
    "text": "It compares the j's\nsmallest p value,",
    "start": "294420",
    "end": "297510"
  },
  {
    "text": "that's p_j to the\nquantity alpha let's",
    "start": "297510",
    "end": "303710"
  },
  {
    "text": "say 10%, 0.1 times j over m.",
    "start": "303710",
    "end": "307250"
  },
  {
    "text": "So it compares these two things.",
    "start": "307250",
    "end": "308810"
  },
  {
    "start": "308810",
    "end": "311350"
  },
  {
    "text": "It asks whether the j's p value\nis smaller than that threshold",
    "start": "311350",
    "end": "314750"
  },
  {
    "text": "or not.",
    "start": "314750",
    "end": "315260"
  },
  {
    "text": "And that's what this\nline here represents.",
    "start": "315260",
    "end": "319580"
  },
  {
    "text": "And the way the procedure\nis done is it finds the--",
    "start": "319580",
    "end": "325189"
  },
  {
    "text": "let's see, the largest j that\nis the most liberal threshold,",
    "start": "325190",
    "end": "328850"
  },
  {
    "text": "the last time that\np_j is less than",
    "start": "328850",
    "end": "330620"
  },
  {
    "text": "or equal to alpha j over m.",
    "start": "330620",
    "end": "332540"
  },
  {
    "text": "And you can see here,\nthese are the p values",
    "start": "332540",
    "end": "335670"
  },
  {
    "text": "and this is the last\ntime this curve is",
    "start": "335670",
    "end": "337310"
  },
  {
    "text": "below this dashed line.",
    "start": "337310",
    "end": "338760"
  },
  {
    "text": "So this marks the\nBenjamini-Hochberg threshold",
    "start": "338760",
    "end": "341300"
  },
  {
    "text": "and it rejects\neverything to the left.",
    "start": "341300",
    "end": "343370"
  },
  {
    "text": "And you see it\nactually included some",
    "start": "343370",
    "end": "345139"
  },
  {
    "text": "of these p values\nthat to start off",
    "start": "345140",
    "end": "347360"
  },
  {
    "text": "didn't seem to get\nunder that line.",
    "start": "347360",
    "end": "350629"
  },
  {
    "text": "So if we stop the\nfirst time, the p value",
    "start": "350630",
    "end": "353150"
  },
  {
    "text": "was not less than that,\nwe would have stopped here",
    "start": "353150",
    "end": "355250"
  },
  {
    "text": "and that would be nothing.",
    "start": "355250",
    "end": "358980"
  },
  {
    "text": "So this is a sort of\nvisual description",
    "start": "358980",
    "end": "361380"
  },
  {
    "text": "of the Benjamini-Hochberg\nprocedure.",
    "start": "361380",
    "end": "364310"
  },
  {
    "start": "364310",
    "end": "368000"
  }
]