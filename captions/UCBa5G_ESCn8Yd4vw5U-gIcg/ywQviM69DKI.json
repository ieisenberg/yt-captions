[
  {
    "start": "0",
    "end": "910"
  },
  {
    "text": "OK, welcome back.",
    "start": "910",
    "end": "2170"
  },
  {
    "text": "We're going to have\nanother R session now.",
    "start": "2170",
    "end": "4360"
  },
  {
    "text": "And today, we're going to\nexplore fitting nonlinear",
    "start": "4360",
    "end": "8590"
  },
  {
    "text": "functions using R. And once\nagain, we're going to-- we",
    "start": "8590",
    "end": "12730"
  },
  {
    "text": "can actually work\nwithin the R studio",
    "start": "12730",
    "end": "15759"
  },
  {
    "text": "markdown environment, which\nI showed you last time,",
    "start": "15760",
    "end": "19120"
  },
  {
    "text": "which allows us to\ndocument what we're doing",
    "start": "19120",
    "end": "21850"
  },
  {
    "text": "and produce a nice web document\nthat records everything",
    "start": "21850",
    "end": "26380"
  },
  {
    "text": "we've done, the output\nof our function calls",
    "start": "26380",
    "end": "28900"
  },
  {
    "text": "and the graphics\nthat we've produced.",
    "start": "28900",
    "end": "30920"
  },
  {
    "text": "So this is a very easy way\nof documenting sessions",
    "start": "30920",
    "end": "36310"
  },
  {
    "text": "in R, both for yourself\nand people that you--",
    "start": "36310",
    "end": "39550"
  },
  {
    "text": "for whom you're\ndoing the analysis.",
    "start": "39550",
    "end": "41710"
  },
  {
    "text": "So in we go.",
    "start": "41710",
    "end": "45820"
  },
  {
    "text": "Just to remind you, if you want\nto learn a little bit about R",
    "start": "45820",
    "end": "49270"
  },
  {
    "text": "Markdown, if you click\non this button over here,",
    "start": "49270",
    "end": "53260"
  },
  {
    "text": "up on the right,\nyou'll get the help",
    "start": "53260",
    "end": "54940"
  },
  {
    "text": "and just gives you a\nvery brief overview",
    "start": "54940",
    "end": "58180"
  },
  {
    "text": "of all the simple commands\nand ways of indenting,",
    "start": "58180",
    "end": "66640"
  },
  {
    "text": "highlighting, and so on, the\nmain things we need to know.",
    "start": "66640",
    "end": "70960"
  },
  {
    "text": "OK, so let's get going.",
    "start": "70960",
    "end": "73430"
  },
  {
    "text": "We'll once again require ISLR\nor our library with data sets",
    "start": "73430",
    "end": "78340"
  },
  {
    "text": "and we'll attach the data set\nwage, the data frame wage.",
    "start": "78340",
    "end": "84064"
  },
  {
    "text": "So the first thing\nwe're going to look at",
    "start": "84065",
    "end": "85990"
  },
  {
    "text": "is polynomials,\npolynomial regression,",
    "start": "85990",
    "end": "89140"
  },
  {
    "text": "and we'll do a regression\nof the response wage on age,",
    "start": "89140",
    "end": "94000"
  },
  {
    "text": "and we'll fit a fourth\ndegree polynomial.",
    "start": "94000",
    "end": "97570"
  },
  {
    "text": "Now, normally that\nwould require building",
    "start": "97570",
    "end": "100840"
  },
  {
    "text": "up a matrix of with columns\nx, x squared, x cubed,",
    "start": "100840",
    "end": "104780"
  },
  {
    "text": "x to the fourth, and then\nusing your regression function.",
    "start": "104780",
    "end": "108860"
  },
  {
    "text": "Well, this is where R\nreally comes to the fore.",
    "start": "108860",
    "end": "111830"
  },
  {
    "text": "We have this lovely formula\nlanguage which lets us just",
    "start": "111830",
    "end": "114850"
  },
  {
    "text": "in one equation here,\nwe've got a function poly",
    "start": "114850",
    "end": "118119"
  },
  {
    "text": "which automatically\ngenerates that basis for us.",
    "start": "118120",
    "end": "122750"
  },
  {
    "text": "And we tell it to take as input\nage and 4 is the degree that'll",
    "start": "122750",
    "end": "127880"
  },
  {
    "text": "make the matrix,\nand then LM will",
    "start": "127880",
    "end": "129800"
  },
  {
    "text": "fit the model with\nresponse wage,",
    "start": "129800",
    "end": "131820"
  },
  {
    "text": "and so it just all\nhappens for us.",
    "start": "131820",
    "end": "134510"
  },
  {
    "text": "And then we do a\nsummary of the fit,",
    "start": "134510",
    "end": "136819"
  },
  {
    "text": "and you'll see below we get\nthe summary sort of short space",
    "start": "136820",
    "end": "141920"
  },
  {
    "text": "here, but the usual kinds of\nsummaries that we get from LM.",
    "start": "141920",
    "end": "145430"
  },
  {
    "text": "We get the formula,\nsummary of the residuals,",
    "start": "145430",
    "end": "148549"
  },
  {
    "text": "and then the coefficients.",
    "start": "148550",
    "end": "150200"
  },
  {
    "text": "And we see that the\ncoefficients, they all",
    "start": "150200",
    "end": "156220"
  },
  {
    "text": "named poly (age, 4) and\nthen 1, 2, 3, and 4.",
    "start": "156220",
    "end": "159080"
  },
  {
    "text": "This will be for degree 1, 2,\n3, and 4, the different degree",
    "start": "159080",
    "end": "163090"
  },
  {
    "text": "monomials.",
    "start": "163090",
    "end": "164140"
  },
  {
    "text": "The first two are\nvery significant.",
    "start": "164140",
    "end": "166310"
  },
  {
    "text": "The cubic is significant and\nthe quartic is just barely not",
    "start": "166310",
    "end": "171849"
  },
  {
    "text": "significant, so it seems\nlike a cubic polynomial",
    "start": "171850",
    "end": "175330"
  },
  {
    "text": "would be sufficient.",
    "start": "175330",
    "end": "177580"
  },
  {
    "text": "Now, normally you can't--",
    "start": "177580",
    "end": "179980"
  },
  {
    "text": "when you have a\nwhole matrix, you",
    "start": "179980",
    "end": "181720"
  },
  {
    "text": "can't just look at these\ncoefficients independently.",
    "start": "181720",
    "end": "185450"
  },
  {
    "text": "Usually what it\nmeans is, the effect",
    "start": "185450",
    "end": "187599"
  },
  {
    "text": "of, say, this coefficient in\nthe presence of all the others.",
    "start": "187600",
    "end": "191480"
  },
  {
    "text": "And if the variables\nare correlated,",
    "start": "191480",
    "end": "194394"
  },
  {
    "text": "you just can't make\nsequential decisions.",
    "start": "194395",
    "end": "196820"
  },
  {
    "text": "But yeah, it's a\nlittle different,",
    "start": "196820",
    "end": "198520"
  },
  {
    "text": "and that's because the\nfunction poly generates",
    "start": "198520",
    "end": "201640"
  },
  {
    "text": "orthogonal polynomials.",
    "start": "201640",
    "end": "203390"
  },
  {
    "text": "So it's like we\ndo in a regression",
    "start": "203390",
    "end": "205150"
  },
  {
    "text": "with uncorrelated predictors,\nand we'll get back to that again",
    "start": "205150",
    "end": "208713"
  },
  {
    "text": "in a little moment.",
    "start": "208713",
    "end": "209505"
  },
  {
    "start": "209505",
    "end": "214400"
  },
  {
    "text": "What we want to do now is\nmake a plot of the function.",
    "start": "214400",
    "end": "217250"
  },
  {
    "text": "We're usually not interested\nin the individual coefficients",
    "start": "217250",
    "end": "219982"
  },
  {
    "text": "of a polynomial, but we're\ninterested in the function",
    "start": "219982",
    "end": "222189"
  },
  {
    "text": "that it's produced.",
    "start": "222190",
    "end": "224140"
  },
  {
    "text": "So we're going to\ngo through the steps",
    "start": "224140",
    "end": "225730"
  },
  {
    "text": "now of how to actually\nproduce that plot.",
    "start": "225730",
    "end": "229050"
  },
  {
    "text": "So we tell our studio\nthat we-- the next segment",
    "start": "229050",
    "end": "232390"
  },
  {
    "text": "is going to have a figure.",
    "start": "232390",
    "end": "233740"
  },
  {
    "text": "And well, we need-- if we\nwant to specify the width",
    "start": "233740",
    "end": "236800"
  },
  {
    "text": "and height of the figure, we\nadd that in the little opening",
    "start": "236800",
    "end": "240670"
  },
  {
    "text": "incantation there,\nand so now we're",
    "start": "240670",
    "end": "243520"
  },
  {
    "text": "going to set up for our plot.",
    "start": "243520",
    "end": "245540"
  },
  {
    "text": "So first of all, we want\nto get the range of age.",
    "start": "245540",
    "end": "248920"
  },
  {
    "text": "And so we'll just use the\nfunction range to get agelims,",
    "start": "248920",
    "end": "253040"
  },
  {
    "text": "that gives us-- returns\nthe vector of length 2 with",
    "start": "253040",
    "end": "255879"
  },
  {
    "text": "a maximum--",
    "start": "255880",
    "end": "256690"
  },
  {
    "text": "minimum and maximum.",
    "start": "256690",
    "end": "258459"
  },
  {
    "text": "And now we use a function, seek\nto make a grid of values of age.",
    "start": "258459",
    "end": "262500"
  },
  {
    "text": "So age.grid will go seek.",
    "start": "262500",
    "end": "265630"
  },
  {
    "text": "From=agelims[1],\nto = agelims[2],",
    "start": "265630",
    "end": "269850"
  },
  {
    "text": "so that's the minimum\nto the maximum.",
    "start": "269850",
    "end": "272540"
  },
  {
    "text": "And by default,\nseek will just make",
    "start": "272540",
    "end": "275330"
  },
  {
    "text": "a sequence of numbers\nincrementing by one each time",
    "start": "275330",
    "end": "278389"
  },
  {
    "text": "unless you tell it otherwise.",
    "start": "278390",
    "end": "280080"
  },
  {
    "text": "Since age is our\ninteger values here,",
    "start": "280080",
    "end": "282889"
  },
  {
    "text": "that'll just be fine for us.",
    "start": "282890",
    "end": "285590"
  },
  {
    "text": "We can execute this, and let's\njust look at our age.grid",
    "start": "285590",
    "end": "291460"
  },
  {
    "text": "below here.",
    "start": "291460",
    "end": "292125"
  },
  {
    "start": "292125",
    "end": "294810"
  },
  {
    "text": "And there you see a sequence of\nincrementing by one each time.",
    "start": "294810",
    "end": "299940"
  },
  {
    "text": "OK, so now, we're going\nto make predictions.",
    "start": "299940",
    "end": "302890"
  },
  {
    "text": "So we will predict\nfrom fit, and then we",
    "start": "302890",
    "end": "305460"
  },
  {
    "text": "tell it that the\nnew data, which has",
    "start": "305460",
    "end": "307740"
  },
  {
    "text": "got to be a data frame\nor a list, at least,",
    "start": "307740",
    "end": "309750"
  },
  {
    "text": "with named variables that\nwere used in the original fit.",
    "start": "309750",
    "end": "312870"
  },
  {
    "text": "And since age is the one\nthat was used in the fit,",
    "start": "312870",
    "end": "315360"
  },
  {
    "text": "and that's where we want\nto make predictions,",
    "start": "315360",
    "end": "317409"
  },
  {
    "text": "we say newdata=list\n(age=age.grid) and then we also",
    "start": "317410",
    "end": "321750"
  },
  {
    "text": "tell it that we want\nstandard errors.",
    "start": "321750",
    "end": "325330"
  },
  {
    "text": "OK.",
    "start": "325330",
    "end": "327159"
  },
  {
    "text": "Your preds now will\nbe a component,",
    "start": "327160",
    "end": "330310"
  },
  {
    "text": "a list with two components,\nand one will be fit,",
    "start": "330310",
    "end": "333500"
  },
  {
    "text": "and one will be se.fit.",
    "start": "333500",
    "end": "337480"
  },
  {
    "text": "OK, so now, we're going to make\nthe standard error bands that",
    "start": "337480",
    "end": "342490"
  },
  {
    "text": "we're-- we're going to make a\nplot with the fitted function",
    "start": "342490",
    "end": "345069"
  },
  {
    "text": "and plus or minus 2\nstandard error bands.",
    "start": "345070",
    "end": "347830"
  },
  {
    "text": "So here we make the\nstandard error bands.",
    "start": "347830",
    "end": "350830"
  },
  {
    "text": "So we call-- we're going to\nmake a matrix with two columns.",
    "start": "350830",
    "end": "353960"
  },
  {
    "text": "So we call the\nfunction cbind, which",
    "start": "353960",
    "end": "355990"
  },
  {
    "text": "is a way of making\nbinding together",
    "start": "355990",
    "end": "358150"
  },
  {
    "text": "columns to make a matrix, and\nit's going to have two columns.",
    "start": "358150",
    "end": "362770"
  },
  {
    "text": "The first one is\ngoing to be preds$fit,",
    "start": "362770",
    "end": "365090"
  },
  {
    "text": "so that's the fitted function\nplus 2 times the standard error,",
    "start": "365090",
    "end": "369580"
  },
  {
    "text": "which also comes from preds.",
    "start": "369580",
    "end": "371449"
  },
  {
    "text": "And then the next column is\ngoing to be preds$fit-2 times",
    "start": "371450",
    "end": "375130"
  },
  {
    "text": "the standard error.",
    "start": "375130",
    "end": "376190"
  },
  {
    "text": "So that's going to give us\nour standard error bands.",
    "start": "376190",
    "end": "379450"
  },
  {
    "text": "So we send that\ndown to the process,",
    "start": "379450",
    "end": "381970"
  },
  {
    "text": "and now we make our plot.",
    "start": "381970",
    "end": "383690"
  },
  {
    "text": "So we'll plot the age,\nfirst plot the data, so",
    "start": "383690",
    "end": "387830"
  },
  {
    "text": "age versus wage, and\nwe'll make it dark gray,",
    "start": "387830",
    "end": "390889"
  },
  {
    "text": "so there we get the plot.",
    "start": "390890",
    "end": "393440"
  },
  {
    "text": "And now we'll do\nlines of the-- we'll",
    "start": "393440",
    "end": "397310"
  },
  {
    "text": "use the lines function to plot\nagainst age.grid the predicted",
    "start": "397310",
    "end": "402260"
  },
  {
    "text": "function, and we\nmake it in blue.",
    "start": "402260",
    "end": "405680"
  },
  {
    "text": "And line width equals\n2 is how you control",
    "start": "405680",
    "end": "409789"
  },
  {
    "text": "the thickness of the plot, and\nby default the line width is 1.",
    "start": "409790",
    "end": "415190"
  },
  {
    "text": "And then we use the function\nmat lines, which in this case,",
    "start": "415190",
    "end": "419550"
  },
  {
    "text": "we've got a single\nx, which is age.grid,",
    "start": "419550",
    "end": "422210"
  },
  {
    "text": "but we've got our two\ncolumn matrix that",
    "start": "422210",
    "end": "424039"
  },
  {
    "text": "have the standard\nerror bands, and you",
    "start": "424040",
    "end": "425750"
  },
  {
    "text": "can use a function mat lines to\nplot those both simultaneously.",
    "start": "425750",
    "end": "430380"
  },
  {
    "text": "And again, we want\nthem blue, and we",
    "start": "430380",
    "end": "433100"
  },
  {
    "text": "say line type equals 2\nwhich means a broken line.",
    "start": "433100",
    "end": "436560"
  },
  {
    "text": "And so there you see\nthe fitted function",
    "start": "436560",
    "end": "438740"
  },
  {
    "text": "plus or minus 2 standard\nerrors, and so now we're done.",
    "start": "438740",
    "end": "443099"
  },
  {
    "text": "So that's typically\nwhat we'd like",
    "start": "443100",
    "end": "445340"
  },
  {
    "text": "to produce when we\nfit a polynomial,",
    "start": "445340",
    "end": "447110"
  },
  {
    "text": "we'd like to see\nthe fitted function,",
    "start": "447110",
    "end": "449090"
  },
  {
    "text": "and it's done for us with\na little bit of work.",
    "start": "449090",
    "end": "453000"
  },
  {
    "text": "We've had to do, essentially\nconstruct the function",
    "start": "453000",
    "end": "455930"
  },
  {
    "text": "and the standard error bands.",
    "start": "455930",
    "end": "457800"
  },
  {
    "text": "And we'll see later on\nthat the gam package has",
    "start": "457800",
    "end": "461449"
  },
  {
    "text": "a nice ways of doing\nthat for us without us",
    "start": "461450",
    "end": "463550"
  },
  {
    "text": "going through all the work.",
    "start": "463550",
    "end": "465970"
  },
  {
    "text": "Now, there are other\nways to fit polynomials.",
    "start": "465970",
    "end": "470110"
  },
  {
    "text": "We didn't have to use\nour poly function.",
    "start": "470110",
    "end": "473099"
  },
  {
    "text": "For example, you\ncan fit it directly.",
    "start": "473100",
    "end": "475000"
  },
  {
    "text": "So here we're going to fit\nthe polynomial directly",
    "start": "475000",
    "end": "477750"
  },
  {
    "text": "by just specifying age\nsquared, age cubed, and age",
    "start": "477750",
    "end": "480600"
  },
  {
    "text": "to the fourth.",
    "start": "480600",
    "end": "481650"
  },
  {
    "text": "And so here's the call to LM,\neach of the terms separated",
    "start": "481650",
    "end": "487919"
  },
  {
    "text": "by a plus.",
    "start": "487920",
    "end": "488980"
  },
  {
    "text": "Now, notice we've\nhad to wrap age",
    "start": "488980",
    "end": "491550"
  },
  {
    "text": "squared in a function,\nthe identity function.",
    "start": "491550",
    "end": "496099"
  },
  {
    "text": "We've seen this one\nbefore, I believe,",
    "start": "496100",
    "end": "498800"
  },
  {
    "text": "and that's because the\npower sign, this carrot,",
    "start": "498800",
    "end": "502789"
  },
  {
    "text": "has a special\nmeaning in a formula.",
    "start": "502790",
    "end": "504930"
  },
  {
    "text": "And so if we want to\njust do mean squared,",
    "start": "504930",
    "end": "507139"
  },
  {
    "text": "we need to protect\nit, and we do that",
    "start": "507140",
    "end": "509300"
  },
  {
    "text": "by wrapping it in the\nidentity function.",
    "start": "509300",
    "end": "512539"
  },
  {
    "text": "So that'll fit a degree\nfourth polynomial.",
    "start": "512539",
    "end": "516320"
  },
  {
    "text": "And if we do a\nsummary, what we'll see",
    "start": "516320",
    "end": "520460"
  },
  {
    "text": "is we see the four variables,\nage, age squared, age cubed,",
    "start": "520460",
    "end": "526220"
  },
  {
    "text": "and age to the fourth.",
    "start": "526220",
    "end": "527870"
  },
  {
    "text": "And the p values, the\ncoefficients and the p values",
    "start": "527870",
    "end": "531620"
  },
  {
    "text": "are different to\nwhat we saw before,",
    "start": "531620",
    "end": "533810"
  },
  {
    "text": "and that's because we're using a\ndifferent basis for representing",
    "start": "533810",
    "end": "537154"
  },
  {
    "text": "the polynomial.",
    "start": "537155",
    "end": "539223"
  },
  {
    "text": "Let's say if you\nchange the basis,",
    "start": "539223",
    "end": "540640"
  },
  {
    "text": "you get different coefficients,\nand therefore, you'll",
    "start": "540640",
    "end": "542800"
  },
  {
    "text": "get different p-values.",
    "start": "542800",
    "end": "543758"
  },
  {
    "start": "543758",
    "end": "547227"
  },
  {
    "text": "That may sound a\nlittle disconcerting,",
    "start": "547228",
    "end": "549530"
  },
  {
    "text": "but the real thing\nwe're interested in",
    "start": "549530",
    "end": "551240"
  },
  {
    "text": "is the fitted polynomial, and as\nwe'll see, that hasn't changed.",
    "start": "551240",
    "end": "556130"
  },
  {
    "text": "OK, so we can just\ncheck that crudely",
    "start": "556130",
    "end": "560750"
  },
  {
    "text": "by just doing a plot of the fit\nfrom our original polynomial,",
    "start": "560750",
    "end": "564470"
  },
  {
    "text": "which we'll just\nextract by fitted,",
    "start": "564470",
    "end": "566500"
  },
  {
    "text": "so it just takes a\nfitted-- it will extract",
    "start": "566500",
    "end": "568580"
  },
  {
    "text": "the fitted values at the given\nX's, the given values of age",
    "start": "568580",
    "end": "572750"
  },
  {
    "text": "when we fit the function, and\nwe'll plot that against fitted",
    "start": "572750",
    "end": "575660"
  },
  {
    "text": "or fita, and you see a\nperfectly straight line, which",
    "start": "575660",
    "end": "579350"
  },
  {
    "text": "says those fitted\nvalues are the same,",
    "start": "579350",
    "end": "581310"
  },
  {
    "text": "so the fitted\npolynomial was the same,",
    "start": "581310",
    "end": "583670"
  },
  {
    "text": "but the representation\nwas different.",
    "start": "583670",
    "end": "586740"
  },
  {
    "start": "586740",
    "end": "590899"
  },
  {
    "text": "So as I mentioned\nearlier, by using",
    "start": "590900",
    "end": "593570"
  },
  {
    "text": "the orthogonal polynomials,\nwe can test each",
    "start": "593570",
    "end": "596060"
  },
  {
    "text": "of the coefficients separately.",
    "start": "596060",
    "end": "600065"
  },
  {
    "text": "And again, if we look at\nthe summary of the fit,",
    "start": "600065",
    "end": "602960"
  },
  {
    "text": "we can separately look\nat the significance",
    "start": "602960",
    "end": "605300"
  },
  {
    "text": "of each of those\ncoefficients and decide",
    "start": "605300",
    "end": "607160"
  },
  {
    "text": "which ones are not needed.",
    "start": "607160",
    "end": "609959"
  },
  {
    "text": "In this case, it\nwas just the cubic.",
    "start": "609960",
    "end": "613220"
  },
  {
    "text": "Now, orthogonal\npolynomials are convenient.",
    "start": "613220",
    "end": "617129"
  },
  {
    "text": "They considered a better\nway of fitting polynomials,",
    "start": "617130",
    "end": "622160"
  },
  {
    "text": "but this idea of\ntesting separately only",
    "start": "622160",
    "end": "624709"
  },
  {
    "text": "works if that's the\nonly term in the model,",
    "start": "624710",
    "end": "627050"
  },
  {
    "text": "and if it's not a GLM it doesn't\nwork, so it's got a limited use.",
    "start": "627050",
    "end": "631339"
  },
  {
    "text": "More generally, if you want to\ntest whether, say, one degree",
    "start": "631340",
    "end": "635300"
  },
  {
    "text": "polynomial is better\nthan another degree,",
    "start": "635300",
    "end": "637250"
  },
  {
    "text": "you need to use the more\ngeneral and over function,",
    "start": "637250",
    "end": "640560"
  },
  {
    "text": "and so that's going to be\ntrue, for example, if you have",
    "start": "640560",
    "end": "644150"
  },
  {
    "text": "other variables in the model.",
    "start": "644150",
    "end": "645660"
  },
  {
    "text": "So here we have a\nsimple sequence fita",
    "start": "645660",
    "end": "648560"
  },
  {
    "text": "is a linear model\njust with education.",
    "start": "648560",
    "end": "653120"
  },
  {
    "text": "Fitb has got education and age\nboth trying to predict wage.",
    "start": "653120",
    "end": "660360"
  },
  {
    "text": "And fitc is a linear\nmodel with education",
    "start": "660360",
    "end": "664260"
  },
  {
    "text": "and a polynomial\nof degree 2 in age,",
    "start": "664260",
    "end": "668350"
  },
  {
    "text": "and fit D is the same, but the\npolynomial of degree 3 in age.",
    "start": "668350",
    "end": "672399"
  },
  {
    "text": "So that's a nested sequence of\nmodels, a nested in complexity.",
    "start": "672400",
    "end": "677200"
  },
  {
    "text": "In other words, the second\nmodel contains the first",
    "start": "677200",
    "end": "680440"
  },
  {
    "text": "as a special case\nLikewise, the third",
    "start": "680440",
    "end": "683140"
  },
  {
    "text": "contains the second and\nthe first as special cases,",
    "start": "683140",
    "end": "686210"
  },
  {
    "text": "and so on.",
    "start": "686210",
    "end": "687370"
  },
  {
    "text": "So that's called\na nested sequence,",
    "start": "687370",
    "end": "689900"
  },
  {
    "text": "and then we use\nthe anova function",
    "start": "689900",
    "end": "691840"
  },
  {
    "text": "to sort out which ones we need.",
    "start": "691840",
    "end": "695620"
  },
  {
    "text": "And so this is the output\nof anova, and what it tells",
    "start": "695620",
    "end": "700810"
  },
  {
    "text": "us is that certainly\nage is needed",
    "start": "700810",
    "end": "704320"
  },
  {
    "text": "in the model with education.",
    "start": "704320",
    "end": "707020"
  },
  {
    "text": "Also age squared is\ncertainly needed, as well as",
    "start": "707020",
    "end": "711400"
  },
  {
    "text": "age in the model, but age cubed\nis not necessarily needed,",
    "start": "711400",
    "end": "718100"
  },
  {
    "text": "it's not quite significant.",
    "start": "718100",
    "end": "720639"
  },
  {
    "text": "Well, it's significant\nat the 5% level,",
    "start": "720640",
    "end": "722710"
  },
  {
    "text": "but it's kind of marginal.",
    "start": "722710",
    "end": "724210"
  },
  {
    "text": "So using anova like this to\ntest nested sequences of models",
    "start": "724210",
    "end": "728720"
  },
  {
    "text": "is the right way\nto go in general.",
    "start": "728720",
    "end": "732019"
  },
  {
    "text": "So this has all been\nusing squared error loss",
    "start": "732020",
    "end": "735470"
  },
  {
    "text": "and fitting linear regressions.",
    "start": "735470",
    "end": "737220"
  },
  {
    "text": "Now, we can, of course,\nuse the same technology",
    "start": "737220",
    "end": "741860"
  },
  {
    "text": "to fit other models such\nas logistic regressions.",
    "start": "741860",
    "end": "745880"
  },
  {
    "text": "And so to do that, we'll\nmake a binary response.",
    "start": "745880",
    "end": "750860"
  },
  {
    "text": "If you recall in the\nfigure of wage versus age,",
    "start": "750860",
    "end": "757010"
  },
  {
    "text": "there was a band at the top.",
    "start": "757010",
    "end": "758910"
  },
  {
    "text": "Let's just get it\nback up on the screen.",
    "start": "758910",
    "end": "762699"
  },
  {
    "text": "There was a band at the\ntop of high wage earners.",
    "start": "762700",
    "end": "767820"
  },
  {
    "text": "Let's see, where's our plot?",
    "start": "767820",
    "end": "769710"
  },
  {
    "text": "Here we go.",
    "start": "769710",
    "end": "770550"
  },
  {
    "text": "We'll put that plot up again.",
    "start": "770550",
    "end": "772565"
  },
  {
    "text": "There's a band up at the top\nhere of high wage earners.",
    "start": "772565",
    "end": "776220"
  },
  {
    "text": "And it looks like if we\nthreshold it around 250,",
    "start": "776220",
    "end": "779269"
  },
  {
    "text": "we'll capture those\nguys, and we're",
    "start": "779270",
    "end": "781340"
  },
  {
    "text": "going to call those\nthe ones, and the rest",
    "start": "781340",
    "end": "783350"
  },
  {
    "text": "are going to be zeros.",
    "start": "783350",
    "end": "784360"
  },
  {
    "text": "There will be a relatively\nsmall group of ones",
    "start": "784360",
    "end": "787010"
  },
  {
    "text": "that we're going to turn\nthat into a binary response.",
    "start": "787010",
    "end": "790280"
  },
  {
    "text": "So let's find our place again.",
    "start": "790280",
    "end": "791965"
  },
  {
    "start": "791965",
    "end": "795290"
  },
  {
    "text": "And so here we are, so we\ncan do that on the fly.",
    "start": "795290",
    "end": "798959"
  },
  {
    "text": "Again, we use our\nindicator function",
    "start": "798960",
    "end": "801080"
  },
  {
    "text": "and there we just provide\nthe conditional wage bigger",
    "start": "801080",
    "end": "803930"
  },
  {
    "text": "than 250.",
    "start": "803930",
    "end": "805020"
  },
  {
    "text": "Well, that evaluates to\na true/false variable,",
    "start": "805020",
    "end": "807950"
  },
  {
    "text": "but if you coerce\nthat to numeric,",
    "start": "807950",
    "end": "811370"
  },
  {
    "text": "it will be a 0, 1 variable,\nand so that will just",
    "start": "811370",
    "end": "813980"
  },
  {
    "text": "happens for us here.",
    "start": "813980",
    "end": "815389"
  },
  {
    "text": "And so that is\ngoing to be modeled",
    "start": "815390",
    "end": "817100"
  },
  {
    "text": "as a polynomial in age\nwith degree equals 3,",
    "start": "817100",
    "end": "820709"
  },
  {
    "text": "and we do that-- and we fit\nthat using GLM and tell it",
    "start": "820710",
    "end": "824510"
  },
  {
    "text": "family equals binomial.",
    "start": "824510",
    "end": "826430"
  },
  {
    "text": "And again, we can do\nthe summary of the fit,",
    "start": "826430",
    "end": "829339"
  },
  {
    "text": "and it gives us a\nsummary of coefficients.",
    "start": "829340",
    "end": "836470"
  },
  {
    "text": "And now because it's a GLM,\neven though the polynomial was",
    "start": "836470",
    "end": "840060"
  },
  {
    "text": "orthogonal, is an\northogonal basis,",
    "start": "840060",
    "end": "843240"
  },
  {
    "text": "it's no longer\nstrictly orthogonal",
    "start": "843240",
    "end": "846270"
  },
  {
    "text": "when we fit a GLM\nbecause there's different",
    "start": "846270",
    "end": "849300"
  },
  {
    "text": "GLM involves having weights\nfor the observations,",
    "start": "849300",
    "end": "851920"
  },
  {
    "text": "and so the orthogonality\nis somewhat lost.",
    "start": "851920",
    "end": "854790"
  },
  {
    "text": "And so if we really wanted\nto test, for example,",
    "start": "854790",
    "end": "857820"
  },
  {
    "text": "if a polynomial of\ndegree 3 was needed,",
    "start": "857820",
    "end": "860100"
  },
  {
    "text": "we'd have to fit another GLM\nwith a polynomial of degree 2",
    "start": "860100",
    "end": "863370"
  },
  {
    "text": "and test to see if the\ntwo were different.",
    "start": "863370",
    "end": "867510"
  },
  {
    "text": "We can get standard error bands\nas well, just like before.",
    "start": "867510",
    "end": "870695"
  },
  {
    "start": "870695",
    "end": "873350"
  },
  {
    "text": "So we'll first make a\nprediction of preds,",
    "start": "873350",
    "end": "879500"
  },
  {
    "text": "and we'll ask for\nstandard errors.",
    "start": "879500",
    "end": "881780"
  },
  {
    "text": "And here we do things\nslightly differently.",
    "start": "881780",
    "end": "884260"
  },
  {
    "text": "We make standard error bands,\nsome being a little tricky here.",
    "start": "884260",
    "end": "889280"
  },
  {
    "text": "We want preds$fit to be in the\nmiddle of the standard error",
    "start": "889280",
    "end": "892850"
  },
  {
    "text": "bands, so that's\njust a single vector.",
    "start": "892850",
    "end": "895190"
  },
  {
    "text": "And here I see bind three\nthings together, just a 0,",
    "start": "895190",
    "end": "901430"
  },
  {
    "text": "and I name them as well.",
    "start": "901430",
    "end": "902820"
  },
  {
    "text": "Fit=0, lower=-2*$se\nand upper=2*predse.",
    "start": "902820",
    "end": "908735"
  },
  {
    "start": "908735",
    "end": "911390"
  },
  {
    "text": "So these are just--",
    "start": "911390",
    "end": "912590"
  },
  {
    "text": "this is a 0 and a\nminus 2 standard errors",
    "start": "912590",
    "end": "915290"
  },
  {
    "text": "and a plus 2 standard errors.",
    "start": "915290",
    "end": "917070"
  },
  {
    "text": "So two things are\nhappening here.",
    "start": "917070",
    "end": "919080"
  },
  {
    "text": "These are two\nvectors of length n.",
    "start": "919080",
    "end": "921590"
  },
  {
    "text": "If you include a scalar\nlike 0 in c bind,",
    "start": "921590",
    "end": "925430"
  },
  {
    "text": "it will just\nreplicate it n times,",
    "start": "925430",
    "end": "927960"
  },
  {
    "text": "so this will make a\nthree column matrix.",
    "start": "927960",
    "end": "931790"
  },
  {
    "text": "And then we add to it a\nsingle vector, an n vector,",
    "start": "931790",
    "end": "935690"
  },
  {
    "text": "and that will just get\nreplicated three times,",
    "start": "935690",
    "end": "938190"
  },
  {
    "text": "so it adds it to\neach of the columns.",
    "start": "938190",
    "end": "940340"
  },
  {
    "text": "So that's a little\nbit of trickery,",
    "start": "940340",
    "end": "943520"
  },
  {
    "text": "but it's good to learn tricks.",
    "start": "943520",
    "end": "945860"
  },
  {
    "text": "And let's look at this\nmatrix that's resulted.",
    "start": "945860",
    "end": "948480"
  },
  {
    "text": "We'll look at the\nfirst five rows,",
    "start": "948480",
    "end": "950510"
  },
  {
    "text": "and there we see it's\ndone exactly what we said,",
    "start": "950510",
    "end": "954350"
  },
  {
    "text": "and so in the--",
    "start": "954350",
    "end": "956660"
  },
  {
    "text": "over here is the fit itself,\nthis is going to be the lower,",
    "start": "956660",
    "end": "960529"
  },
  {
    "text": "and this is the upper,\nand this is going down",
    "start": "960530",
    "end": "963470"
  },
  {
    "text": "with values of age.",
    "start": "963470",
    "end": "964569"
  },
  {
    "start": "964570",
    "end": "969450"
  },
  {
    "text": "So that gives the standard\nerrors for the fitted values.",
    "start": "969450",
    "end": "974320"
  },
  {
    "text": "Well, actually the predict fits\nthe linear predictor for us,",
    "start": "974320",
    "end": "979360"
  },
  {
    "text": "so that's on the logit scale.",
    "start": "979360",
    "end": "981570"
  },
  {
    "text": "We usually are more\ninterested in the predictions",
    "start": "981570",
    "end": "984900"
  },
  {
    "text": "on the probability scale,\nespecially if we fit in",
    "start": "984900",
    "end": "987420"
  },
  {
    "text": "against a single variable.",
    "start": "987420",
    "end": "990930"
  },
  {
    "text": "And so we want to\ndo the conversion.",
    "start": "990930",
    "end": "994290"
  },
  {
    "text": "So yeah, I've got an expression.",
    "start": "994290",
    "end": "996750"
  },
  {
    "text": "We need to do the\ninverse logit, which",
    "start": "996750",
    "end": "999480"
  },
  {
    "text": "I've got an expression here\nthat's written in LaTeX.",
    "start": "999480",
    "end": "1003589"
  },
  {
    "text": "And if you know LaTeX\nor here it says TeX,",
    "start": "1003590",
    "end": "1008780"
  },
  {
    "text": "but it's a TeX language.",
    "start": "1008780",
    "end": "1011330"
  },
  {
    "text": "If you know TeX or LaTeX,\nyou'll know what this means.",
    "start": "1011330",
    "end": "1014430"
  },
  {
    "text": "What this is mainly\nshowing you is",
    "start": "1014430",
    "end": "1016250"
  },
  {
    "text": "that you can embed TeX and\nLaTeX expressions in MarkDown,",
    "start": "1016250",
    "end": "1022100"
  },
  {
    "text": "and it will format properly.",
    "start": "1022100",
    "end": "1024020"
  },
  {
    "text": "So instead of waiting to show\nyou the formatted document,",
    "start": "1024020",
    "end": "1028310"
  },
  {
    "text": "I'm going to run it right now.",
    "start": "1028310",
    "end": "1030569"
  },
  {
    "text": "You see, it runs through\nthe whole document,",
    "start": "1030569",
    "end": "1032880"
  },
  {
    "text": "and then it produces the output.",
    "start": "1032880",
    "end": "1035260"
  },
  {
    "text": "And I really want to show you\nwhat that formula ended up",
    "start": "1035260",
    "end": "1038459"
  },
  {
    "text": "looking like once we\nformatted it with LaTeX.",
    "start": "1038460",
    "end": "1042299"
  },
  {
    "text": "So here's all the output of\neverything we've done so far,",
    "start": "1042300",
    "end": "1046050"
  },
  {
    "text": "and there we have\nit, so it's formatted",
    "start": "1046050",
    "end": "1048780"
  },
  {
    "text": "in a mathematical formula.",
    "start": "1048780",
    "end": "1050350"
  },
  {
    "text": "So if you know how to use TeX,\nyou'll know how to do that,",
    "start": "1050350",
    "end": "1053200"
  },
  {
    "text": "and you'll see now you can embed\nthat directly in the MarkDown.",
    "start": "1053200",
    "end": "1058230"
  },
  {
    "text": "If you didn't know about\nTeX, don't be worried.",
    "start": "1058230",
    "end": "1062580"
  },
  {
    "text": "It's a very popular language\nused for most people",
    "start": "1062580",
    "end": "1066000"
  },
  {
    "text": "who do mathematical work,\nconvenient way of typesetting.",
    "start": "1066000",
    "end": "1071790"
  },
  {
    "text": "So we want to apply\nthat transformation",
    "start": "1071790",
    "end": "1075790"
  },
  {
    "text": "to both our fitted\nfunction and the upper",
    "start": "1075790",
    "end": "1080890"
  },
  {
    "text": "and lower standard error\nbands to transform them",
    "start": "1080890",
    "end": "1085360"
  },
  {
    "text": "to the probability scale.",
    "start": "1085360",
    "end": "1087580"
  },
  {
    "text": "And so in R, this\nis how we do it,",
    "start": "1087580",
    "end": "1090399"
  },
  {
    "text": "and we can apply that\ninverse logit function.",
    "start": "1090400",
    "end": "1094730"
  },
  {
    "text": "So you see it's e to\nthe se bands over 1 plus",
    "start": "1094730",
    "end": "1098770"
  },
  {
    "text": "e to the se bands or\nexponential of se bands.",
    "start": "1098770",
    "end": "1102420"
  },
  {
    "text": "It's going to do\nthis simultaneously",
    "start": "1102420",
    "end": "1104350"
  },
  {
    "text": "to all the elements\nof the matrix",
    "start": "1104350",
    "end": "1106330"
  },
  {
    "text": "and return a matrix\nfor us, which",
    "start": "1106330",
    "end": "1108789"
  },
  {
    "text": "is exactly what we want here.",
    "start": "1108790",
    "end": "1111370"
  },
  {
    "text": "And now we can make a\nplot, and so we do it.",
    "start": "1111370",
    "end": "1118900"
  },
  {
    "text": "I've limited the range here\nbecause the standard error",
    "start": "1118900",
    "end": "1123010"
  },
  {
    "text": "bands are new in advance,\nwe're going to be very wide,",
    "start": "1123010",
    "end": "1126220"
  },
  {
    "text": "and it would have\nsquashed the plot down.",
    "start": "1126220",
    "end": "1128059"
  },
  {
    "text": "So this is the estimate\nof the fitted probability.",
    "start": "1128060",
    "end": "1131875"
  },
  {
    "text": "And this is an estimated\nconfidence interval,",
    "start": "1131875",
    "end": "1135850"
  },
  {
    "text": "95% confidence interval\nfor the fitted probability,",
    "start": "1135850",
    "end": "1140169"
  },
  {
    "text": "so now you see the value of\ndoing it on the logit scale.",
    "start": "1140170",
    "end": "1144490"
  },
  {
    "text": "The confidence bands first\ncomputed on the logit scale",
    "start": "1144490",
    "end": "1148000"
  },
  {
    "text": "and then transformed to\nthe probability scale.",
    "start": "1148000",
    "end": "1151280"
  },
  {
    "text": "And what you get for that\nis that your standard error",
    "start": "1151280",
    "end": "1153640"
  },
  {
    "text": "bands for the probabilities\nall lie within 0 and 1,",
    "start": "1153640",
    "end": "1156940"
  },
  {
    "text": "so this guy never gets below\n0, it's wedged in at 0,",
    "start": "1156940",
    "end": "1160330"
  },
  {
    "text": "but never gets below zero, and\nthat's kind of what you'd like.",
    "start": "1160330",
    "end": "1164851"
  },
  {
    "text": "And now, we add some points\nto show where the data occur.",
    "start": "1164852",
    "end": "1168105"
  },
  {
    "start": "1168105",
    "end": "1170679"
  },
  {
    "text": "And they'll appear,\nthere they are.",
    "start": "1170680",
    "end": "1175230"
  },
  {
    "text": "And I've actually--\nwhat I've done",
    "start": "1175230",
    "end": "1178010"
  },
  {
    "text": "here is I first of\nall use jitter of age",
    "start": "1178010",
    "end": "1180560"
  },
  {
    "text": "because there were\nlots of ties in age",
    "start": "1180560",
    "end": "1182570"
  },
  {
    "text": "at each of the\ninteger values of age.",
    "start": "1182570",
    "end": "1185059"
  },
  {
    "text": "To give an indication of how\nmuch data occurred at each age,",
    "start": "1185060",
    "end": "1188950"
  },
  {
    "text": "I use the jitter function,\nwhich randomly adds",
    "start": "1188950",
    "end": "1191630"
  },
  {
    "text": "to each element\nof the vector age",
    "start": "1191630",
    "end": "1193550"
  },
  {
    "text": "a little bit of\nuniform, random noise,",
    "start": "1193550",
    "end": "1195740"
  },
  {
    "text": "so you can get an\nidea of the density.",
    "start": "1195740",
    "end": "1198160"
  },
  {
    "text": "So there are these\nzeros, there the ones.",
    "start": "1198160",
    "end": "1201560"
  },
  {
    "text": "To have them fit on the page\nsince I've limited the scale",
    "start": "1201560",
    "end": "1204560"
  },
  {
    "text": "to up to 0.1, which means that\nwe can see only 4% at most",
    "start": "1204560",
    "end": "1210560"
  },
  {
    "text": "of the population in any given\nage category earned above 250k,",
    "start": "1210560",
    "end": "1216570"
  },
  {
    "text": "we had to limit the range.",
    "start": "1216570",
    "end": "1219330"
  },
  {
    "text": "We had to shrink down\nthe ones to point--",
    "start": "1219330",
    "end": "1222200"
  },
  {
    "text": "to make them 0.1, so we\ncan include them and just",
    "start": "1222200",
    "end": "1224539"
  },
  {
    "text": "see them in the plot.",
    "start": "1224540",
    "end": "1226130"
  },
  {
    "text": "OK, so this is similar to\na plot we have in the book,",
    "start": "1226130",
    "end": "1230450"
  },
  {
    "text": "and it shows the\nfitted probability.",
    "start": "1230450",
    "end": "1234836"
  },
  {
    "text": "So we've learned how\nto use polynomials,",
    "start": "1234836",
    "end": "1237720"
  },
  {
    "text": "we've learned how to compare\ndifferent polynomials,",
    "start": "1237720",
    "end": "1240750"
  },
  {
    "text": "and we've learned how to\nplot the fitted functions",
    "start": "1240750",
    "end": "1244770"
  },
  {
    "text": "with the standard error\nbands, and we've also",
    "start": "1244770",
    "end": "1247230"
  },
  {
    "text": "learned how to use them with\nGLMs as well as linear models.",
    "start": "1247230",
    "end": "1251160"
  },
  {
    "text": "So in the next\nsegment, we're going",
    "start": "1251160",
    "end": "1253650"
  },
  {
    "text": "to look at different functions.",
    "start": "1253650",
    "end": "1255150"
  },
  {
    "text": "We're going to look\nat splines, which",
    "start": "1255150",
    "end": "1256692"
  },
  {
    "text": "are more general functions,\nusually better behaved",
    "start": "1256692",
    "end": "1259830"
  },
  {
    "text": "than polynomials,\nand we're going",
    "start": "1259830",
    "end": "1262380"
  },
  {
    "text": "to see how to fit splines,\nboth with single variables",
    "start": "1262380",
    "end": "1266160"
  },
  {
    "text": "and with multiple variables,\nusing the gam package.",
    "start": "1266160",
    "end": "1270410"
  },
  {
    "start": "1270410",
    "end": "1272000"
  }
]