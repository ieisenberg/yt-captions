[
  {
    "start": "0",
    "end": "198000"
  },
  {
    "start": "0",
    "end": "580"
  },
  {
    "text": "OK, well, so we've\nalready got a long list",
    "start": "580",
    "end": "4480"
  },
  {
    "text": "of ways of fitting\nnon-linear functions.",
    "start": "4480",
    "end": "7330"
  },
  {
    "text": "There's another whole family of\nmethods called local regression.",
    "start": "7330",
    "end": "12830"
  },
  {
    "text": "In fact, Rob, wasn't there\na PhD thesis from Stanford",
    "start": "12830",
    "end": "16190"
  },
  {
    "text": "on local regression?",
    "start": "16190",
    "end": "18270"
  },
  {
    "text": "I don't remember.",
    "start": "18270",
    "end": "19490"
  },
  {
    "text": "Rob's PhD thesis was\ncalled local likelihood",
    "start": "19490",
    "end": "22490"
  },
  {
    "text": "and was an extension of\nthese local regression ideas",
    "start": "22490",
    "end": "25610"
  },
  {
    "text": "to a whole range of problems\nand still used widely today.",
    "start": "25610",
    "end": "30060"
  },
  {
    "text": "I wouldn't say widely.",
    "start": "30060",
    "end": "31019"
  },
  {
    "text": "I'd say--",
    "start": "31020",
    "end": "32210"
  },
  {
    "text": "You're too modest, Rob.",
    "start": "32210",
    "end": "33600"
  },
  {
    "text": "Yes.",
    "start": "33600",
    "end": "34730"
  },
  {
    "text": "So here we have--",
    "start": "34730",
    "end": "37820"
  },
  {
    "text": "we're not going to go in great\ndetail into local regression,",
    "start": "37820",
    "end": "40640"
  },
  {
    "text": "but I'll just give you the idea.",
    "start": "40640",
    "end": "42860"
  },
  {
    "text": "Here, we have some data.",
    "start": "42860",
    "end": "45350"
  },
  {
    "text": "And we've got a\nregion over here where",
    "start": "45350",
    "end": "49280"
  },
  {
    "text": "we fit a linear function just\nto the data in this region.",
    "start": "49280",
    "end": "52489"
  },
  {
    "text": "The points in the region\nare the orange points.",
    "start": "52490",
    "end": "55910"
  },
  {
    "text": "So it's a local set of points.",
    "start": "55910",
    "end": "57860"
  },
  {
    "text": "And so we locally fit\na linear function.",
    "start": "57860",
    "end": "61400"
  },
  {
    "text": "And in fact, we fit it\nby weighted least squares",
    "start": "61400",
    "end": "63710"
  },
  {
    "text": "and the weights are given by\nthe heights of this kernel here.",
    "start": "63710",
    "end": "68970"
  },
  {
    "text": "So the highest weights\nare given two points",
    "start": "68970",
    "end": "71610"
  },
  {
    "text": "at the target point, which\nis where this orange dot is.",
    "start": "71610",
    "end": "75120"
  },
  {
    "text": "And then the weights die\ndown as we move away.",
    "start": "75120",
    "end": "79410"
  },
  {
    "text": "And from doing all that\nwhole linear function,",
    "start": "79410",
    "end": "81390"
  },
  {
    "text": "you'll just get one fitted\nvalue at this point over here.",
    "start": "81390",
    "end": "84870"
  },
  {
    "text": "But then the idea is that you\nslide the target point along",
    "start": "84870",
    "end": "88260"
  },
  {
    "text": "and as you slide it along,\nthe whole region slides along.",
    "start": "88260",
    "end": "91540"
  },
  {
    "text": "So here we see the target\npoint at this point over here.",
    "start": "91540",
    "end": "96200"
  },
  {
    "text": "There is a weighting function.",
    "start": "96200",
    "end": "98119"
  },
  {
    "text": "The orange points have moved.",
    "start": "98120",
    "end": "100950"
  },
  {
    "text": "So we fit in locally at\nthis region over here.",
    "start": "100950",
    "end": "104310"
  },
  {
    "text": "We fit a linear function\nand the fitted value",
    "start": "104310",
    "end": "106939"
  },
  {
    "text": "is taken to be this orange\npoint here at the target point.",
    "start": "106940",
    "end": "111320"
  },
  {
    "text": "And so as we slide the region\nalong or the target point along,",
    "start": "111320",
    "end": "114980"
  },
  {
    "text": "this whole system\nslides along and we",
    "start": "114980",
    "end": "117350"
  },
  {
    "text": "fit different linear functions.",
    "start": "117350",
    "end": "119330"
  },
  {
    "text": "And that traces out the\norange curve over here.",
    "start": "119330",
    "end": "122940"
  },
  {
    "text": "And the reason we like to fit\nlocally linear as you might",
    "start": "122940",
    "end": "126327"
  },
  {
    "text": "think why don't we just\nfit a local constant",
    "start": "126327",
    "end": "128160"
  },
  {
    "text": "or like a moving\naverage is that it",
    "start": "128160",
    "end": "131310"
  },
  {
    "text": "does much better, for\nexample, at the boundaries.",
    "start": "131310",
    "end": "133980"
  },
  {
    "text": "It gives you a much better\nextrapolation at the boundaries.",
    "start": "133980",
    "end": "139739"
  },
  {
    "text": "So this is called\nlocal regression,",
    "start": "139740",
    "end": "141630"
  },
  {
    "text": "and it's a very popular way of\nfitting non-linear functions,",
    "start": "141630",
    "end": "146730"
  },
  {
    "text": "but just focusing\nlocally on the data.",
    "start": "146730",
    "end": "150090"
  },
  {
    "text": "Turns out--",
    "start": "150090",
    "end": "151319"
  },
  {
    "text": "It's probably fair\nto say that loess",
    "start": "151320",
    "end": "153717"
  },
  {
    "text": "and cubic splines or\ncubic smoothing splines",
    "start": "153717",
    "end": "155549"
  },
  {
    "text": "are probably the two best\nways of doing smoothing.",
    "start": "155550",
    "end": "157660"
  },
  {
    "text": "And if you set the degrees of\nfreedom of both to be equal,",
    "start": "157660",
    "end": "160077"
  },
  {
    "text": "roughly, they look pretty\nsimilar too, in general.",
    "start": "160077",
    "end": "162659"
  },
  {
    "text": "Would you agree?",
    "start": "162660",
    "end": "163328"
  },
  {
    "text": "That's right.",
    "start": "163328",
    "end": "163870"
  },
  {
    "text": "So either one of these\nis a good choice.",
    "start": "163870",
    "end": "166980"
  },
  {
    "text": "So as Rob says,\nloess is the function",
    "start": "166980",
    "end": "169739"
  },
  {
    "text": "in R for fitting this\nlocal regression.",
    "start": "169740",
    "end": "172020"
  },
  {
    "text": "And we'll play with that\na little bit in the lab,",
    "start": "172020",
    "end": "175320"
  },
  {
    "text": "and you'll see it's\nvery easy to use.",
    "start": "175320",
    "end": "178590"
  },
  {
    "text": "So we're not going\nto say anything",
    "start": "178590",
    "end": "180180"
  },
  {
    "text": "much more about\nlocal regression,",
    "start": "180180",
    "end": "182040"
  },
  {
    "text": "but the concept of local\nregression is important.",
    "start": "182040",
    "end": "184659"
  },
  {
    "text": "You can read more\nabout it in the book",
    "start": "184660",
    "end": "186390"
  },
  {
    "text": "and in our other book, elements\nof statistical learning.",
    "start": "186390",
    "end": "190030"
  },
  {
    "text": "And you'll see it's\nactually a very rich area",
    "start": "190030",
    "end": "192630"
  },
  {
    "text": "and allows you to do\nlots of flexible things.",
    "start": "192630",
    "end": "195275"
  },
  {
    "start": "195275",
    "end": "200390"
  },
  {
    "start": "198000",
    "end": "368000"
  },
  {
    "text": "The final topic--\ngeneralized additive models.",
    "start": "200390",
    "end": "205410"
  },
  {
    "text": "So the general idea\nhere is that you're",
    "start": "205410",
    "end": "207570"
  },
  {
    "text": "going to fit nonlinear functions\nin a bunch of variables",
    "start": "207570",
    "end": "210420"
  },
  {
    "text": "at the same time.",
    "start": "210420",
    "end": "211800"
  },
  {
    "text": "But the additive\nin the name means",
    "start": "211800",
    "end": "213720"
  },
  {
    "text": "that you're going to retain the\nadditivity of linear models.",
    "start": "213720",
    "end": "217030"
  },
  {
    "text": "And the reason that's\nattractive is because it",
    "start": "217030",
    "end": "219300"
  },
  {
    "text": "leads to interpretable models.",
    "start": "219300",
    "end": "221790"
  },
  {
    "text": "So here's our model for\ny is an additive function",
    "start": "221790",
    "end": "225209"
  },
  {
    "text": "of the different xs.",
    "start": "225210",
    "end": "227040"
  },
  {
    "text": "So we've got a function\nof x1, a function of x2,",
    "start": "227040",
    "end": "229500"
  },
  {
    "text": "and a function of xp.",
    "start": "229500",
    "end": "231420"
  },
  {
    "text": "These are different\nvariables in the model.",
    "start": "231420",
    "end": "234140"
  },
  {
    "text": "And once you fit\nthis model, you can",
    "start": "234140",
    "end": "237020"
  },
  {
    "text": "plot the different contributions\nto the fitted model.",
    "start": "237020",
    "end": "241250"
  },
  {
    "text": "So if f-- if the first\nvariable is here,",
    "start": "241250",
    "end": "244790"
  },
  {
    "text": "we've got a nonlinear\nfunction of here.",
    "start": "244790",
    "end": "247519"
  },
  {
    "text": "And then we've got a\nnonlinear function of age.",
    "start": "247520",
    "end": "251000"
  },
  {
    "text": "And the third variable\nin this case--",
    "start": "251000",
    "end": "253102"
  },
  {
    "text": "there were three\nvariables was education,",
    "start": "253102",
    "end": "254810"
  },
  {
    "text": "and that was a factor variable.",
    "start": "254810",
    "end": "256380"
  },
  {
    "text": "And so there are piecewise\nconstant function",
    "start": "256380",
    "end": "258470"
  },
  {
    "text": "is a natural thing to fit one\nconstant for each of the levels.",
    "start": "258470",
    "end": "263450"
  },
  {
    "text": "But the point is, the additive\nmodel gives you a picture",
    "start": "263450",
    "end": "265820"
  },
  {
    "text": "that you can look\nat and appreciate",
    "start": "265820",
    "end": "268280"
  },
  {
    "text": "the contributions of each\nof the functions-- each",
    "start": "268280",
    "end": "270620"
  },
  {
    "text": "of the variables to\nthe composite model.",
    "start": "270620",
    "end": "275172"
  },
  {
    "text": "And so the technology is about\nfitting nonlinear functions",
    "start": "275172",
    "end": "280340"
  },
  {
    "text": "of several variables\nin this additive form.",
    "start": "280340",
    "end": "282940"
  },
  {
    "start": "282940",
    "end": "285860"
  },
  {
    "text": "So you can fit a generalized\nadditive model very easily",
    "start": "285860",
    "end": "290479"
  },
  {
    "text": "using some of the earlier tools,\nfor example, natural splines.",
    "start": "290480",
    "end": "294010"
  },
  {
    "text": "So it's as simple as this.",
    "start": "294010",
    "end": "295770"
  },
  {
    "text": "Let's suppose we want to fit an\nadditive model in year and age.",
    "start": "295770",
    "end": "299139"
  },
  {
    "text": "We can just have it\ncall to linear model LM.",
    "start": "299140",
    "end": "303960"
  },
  {
    "text": "And we give it two terms.",
    "start": "303960",
    "end": "306370"
  },
  {
    "text": "We've got the response wage.",
    "start": "306370",
    "end": "308280"
  },
  {
    "text": "We have a natural spline in\nhere with 5 degrees of freedom,",
    "start": "308280",
    "end": "311850"
  },
  {
    "text": "plus a natural spline in age\nwith 5 degrees of freedom--",
    "start": "311850",
    "end": "316410"
  },
  {
    "text": "sorry, plus education.",
    "start": "316410",
    "end": "317830"
  },
  {
    "text": "So that's the\nprevious term here.",
    "start": "317830",
    "end": "319560"
  },
  {
    "text": "Education is already\na factor variable,",
    "start": "319560",
    "end": "321720"
  },
  {
    "text": "so it will automatically fit\na piecewise constant function.",
    "start": "321720",
    "end": "326901"
  },
  {
    "text": "And that'll do it for you.",
    "start": "326901",
    "end": "329400"
  },
  {
    "text": "As we said earlier,\nthe coefficients",
    "start": "329400",
    "end": "331770"
  },
  {
    "text": "that you end up because\nthis term natural spline",
    "start": "331770",
    "end": "335069"
  },
  {
    "text": "in the degrees of\nfreedom equals 5",
    "start": "335070",
    "end": "337110"
  },
  {
    "text": "will actually generate\na basis matrix",
    "start": "337110",
    "end": "339419"
  },
  {
    "text": "for doing natural cubic splines.",
    "start": "339420",
    "end": "341610"
  },
  {
    "text": "So that's a matrix of xs\ncontributions to the model",
    "start": "341610",
    "end": "346229"
  },
  {
    "text": "matrix.",
    "start": "346230",
    "end": "347020"
  },
  {
    "text": "And each one of them is\ngoing to get a coefficient.",
    "start": "347020",
    "end": "349470"
  },
  {
    "text": "But we're not interested in\nthe separate coefficients.",
    "start": "349470",
    "end": "351720"
  },
  {
    "text": "We're interested in the\noverall function that it fits.",
    "start": "351720",
    "end": "354730"
  },
  {
    "text": "So it's a fitted function\nor this part of it that--",
    "start": "354730",
    "end": "358320"
  },
  {
    "text": "for each part of it,\nthat's interesting.",
    "start": "358320",
    "end": "361260"
  },
  {
    "text": "So this previous plot here\nwas produced by plot.gam.",
    "start": "361260",
    "end": "367550"
  },
  {
    "text": "If you try to plot this\nmodel, which is fit by LM,",
    "start": "367550",
    "end": "371870"
  },
  {
    "start": "368000",
    "end": "509000"
  },
  {
    "text": "by just using the\ngeneric function plot,",
    "start": "371870",
    "end": "375350"
  },
  {
    "text": "it will make a plot\nfor linear models,",
    "start": "375350",
    "end": "377540"
  },
  {
    "text": "which which I'm not going\nto give you the right plot.",
    "start": "377540",
    "end": "380120"
  },
  {
    "text": "But if you use plot.gam, it will\ntreat it as an additive model",
    "start": "380120",
    "end": "384410"
  },
  {
    "text": "and plot a plot\nthat looks very much",
    "start": "384410",
    "end": "386450"
  },
  {
    "text": "like the one in\nthe previous slide,",
    "start": "386450",
    "end": "388820"
  },
  {
    "text": "focusing on the functions\nrather than the residuals",
    "start": "388820",
    "end": "392570"
  },
  {
    "text": "and whatever the\nlinear model plot does.",
    "start": "392570",
    "end": "397030"
  },
  {
    "text": "So, of course, with\ngeneralized additive models,",
    "start": "397030",
    "end": "399610"
  },
  {
    "text": "you can mix terms.",
    "start": "399610",
    "end": "400900"
  },
  {
    "text": "So you can have some terms\nlinear, some nonlinear,",
    "start": "400900",
    "end": "403750"
  },
  {
    "text": "and you can use, for\nexample, the ANOVA function",
    "start": "403750",
    "end": "406630"
  },
  {
    "text": "to compare models and\ntest whether a term should",
    "start": "406630",
    "end": "409390"
  },
  {
    "text": "be linear or nonlinear.",
    "start": "409390",
    "end": "412660"
  },
  {
    "text": "You can also use other\nmethods for smoothing.",
    "start": "412660",
    "end": "416990"
  },
  {
    "text": "So, for example, here we\nuse GAM to fit the model.",
    "start": "416990",
    "end": "421280"
  },
  {
    "text": "Because in the first variable we\nwant a smoothing spline in here.",
    "start": "421280",
    "end": "425460"
  },
  {
    "text": "So there, we use the\nsymbol S to tell GAM",
    "start": "425460",
    "end": "428530"
  },
  {
    "text": "that it wants to use a\nsmoothing spline with 5",
    "start": "428530",
    "end": "431410"
  },
  {
    "text": "degrees of freedom.",
    "start": "431410",
    "end": "433090"
  },
  {
    "text": "And just to be interested\nin the second term,",
    "start": "433090",
    "end": "436419"
  },
  {
    "text": "we want to fit with loess.",
    "start": "436420",
    "end": "437860"
  },
  {
    "text": "So there the shortcut\nis LO in age,",
    "start": "437860",
    "end": "441280"
  },
  {
    "text": "and there we specify the\nwidth of the window--",
    "start": "441280",
    "end": "445300"
  },
  {
    "text": "the local window\nby something called",
    "start": "445300",
    "end": "446800"
  },
  {
    "text": "a span, which is the fraction\nof the data in the window.",
    "start": "446800",
    "end": "450659"
  },
  {
    "text": "And then plus education.",
    "start": "450660",
    "end": "453200"
  },
  {
    "text": "So that's like a fully blown\ngeneralized additive model.",
    "start": "453200",
    "end": "456865"
  },
  {
    "start": "456865",
    "end": "461599"
  },
  {
    "text": "GAMs are additive,\nwhich means they aren't",
    "start": "461600",
    "end": "463370"
  },
  {
    "text": "interactions in the model.",
    "start": "463370",
    "end": "466460"
  },
  {
    "text": "Now you can put low\norder actions in--",
    "start": "466460",
    "end": "468949"
  },
  {
    "text": "by just including\nthem in a natural way.",
    "start": "468950",
    "end": "471080"
  },
  {
    "text": "And there's several\nways of doing that.",
    "start": "471080",
    "end": "473310"
  },
  {
    "text": "You do get things called\nbivariate smoothers that",
    "start": "473310",
    "end": "475730"
  },
  {
    "text": "take several variables,\ntwo or more variables,",
    "start": "475730",
    "end": "478850"
  },
  {
    "text": "or you can put in\ninteractions in other forms.",
    "start": "478850",
    "end": "481820"
  },
  {
    "text": "For example, this\nis a way you can",
    "start": "481820",
    "end": "484510"
  },
  {
    "text": "fit a bivariate function in age\nin year using natural splines.",
    "start": "484510",
    "end": "488380"
  },
  {
    "text": "It creates a tensor product of\nthe two sets of bases and result",
    "start": "488380",
    "end": "493390"
  },
  {
    "text": "in a bivariate function.",
    "start": "493390",
    "end": "494960"
  },
  {
    "text": "So this is somewhat more\ndetailed, but you can do this.",
    "start": "494960",
    "end": "497710"
  },
  {
    "text": "And again, you can look at--",
    "start": "497710",
    "end": "500110"
  },
  {
    "text": "I don't think you'll see\ndetails in the current book,",
    "start": "500110",
    "end": "502360"
  },
  {
    "text": "but in elements of\nstatistical learning,",
    "start": "502360",
    "end": "504129"
  },
  {
    "text": "you can certainly see about\ndoing things like this.",
    "start": "504130",
    "end": "506640"
  },
  {
    "start": "506640",
    "end": "510300"
  },
  {
    "start": "509000",
    "end": "646000"
  },
  {
    "text": "You can fit game models\nfor classification.",
    "start": "510300",
    "end": "512740"
  },
  {
    "text": "It's the same idea.",
    "start": "512740",
    "end": "513909"
  },
  {
    "text": "Yeah, we fit in the\nlogit of the probability",
    "start": "513909",
    "end": "516809"
  },
  {
    "text": "as an additive model.",
    "start": "516809",
    "end": "518880"
  },
  {
    "text": "And in this case,\nwhen you do a plot,",
    "start": "518880",
    "end": "522870"
  },
  {
    "text": "it will plot the\ncontributions to the logit",
    "start": "522870",
    "end": "526839"
  },
  {
    "text": "because the fitted\nprobabilities are not",
    "start": "526840",
    "end": "530170"
  },
  {
    "text": "additive in the functions,\nbut the logit is additive.",
    "start": "530170",
    "end": "533470"
  },
  {
    "text": "And so there we get the logit.",
    "start": "533470",
    "end": "536720"
  },
  {
    "text": "This was actually fit using\nthe following GAM expression",
    "start": "536720",
    "end": "539800"
  },
  {
    "text": "to-- call to GAM.",
    "start": "539800",
    "end": "541480"
  },
  {
    "text": "So there's our binary response.",
    "start": "541480",
    "end": "544290"
  },
  {
    "text": "We ask for a linear term in\nyear, a smooth term in age",
    "start": "544290",
    "end": "548820"
  },
  {
    "text": "fit by a smoothing spline\nwith 5 degrees of freedom,",
    "start": "548820",
    "end": "551820"
  },
  {
    "text": "and then the education term.",
    "start": "551820",
    "end": "554710"
  },
  {
    "text": "And we tell GAM the\nfamily is binomial.",
    "start": "554710",
    "end": "557620"
  },
  {
    "text": "So that's just like GLM--",
    "start": "557620",
    "end": "559480"
  },
  {
    "text": "we tell the family was binomial.",
    "start": "559480",
    "end": "561820"
  },
  {
    "text": "And it knows to fit the\nlogistic regression model.",
    "start": "561820",
    "end": "566770"
  },
  {
    "text": "Interesting to see\nthe standard error",
    "start": "566770",
    "end": "569080"
  },
  {
    "text": "bands for the linear function.",
    "start": "569080",
    "end": "570940"
  },
  {
    "text": "It's giving you a standard\nerrors for the slope.",
    "start": "570940",
    "end": "573740"
  },
  {
    "text": "You're not-- there's no\nintercept in these terms.",
    "start": "573740",
    "end": "576140"
  },
  {
    "text": "They all centered at 0.",
    "start": "576140",
    "end": "577580"
  },
  {
    "text": "So the slope is\nof interest here.",
    "start": "577580",
    "end": "579170"
  },
  {
    "text": "And, of course, the\nstandard error for a slope",
    "start": "579170",
    "end": "581087"
  },
  {
    "text": "is going to be like\na cone-shaped bow tie",
    "start": "581087",
    "end": "583149"
  },
  {
    "text": "kind of standard error band.",
    "start": "583150",
    "end": "585500"
  },
  {
    "text": "So that's a generalized\nadditive model.",
    "start": "585500",
    "end": "589460"
  },
  {
    "text": "OK.",
    "start": "589460",
    "end": "590960"
  },
  {
    "text": "Well, so that's it.",
    "start": "590960",
    "end": "592590"
  },
  {
    "text": "That's a whole\ncollection of tools",
    "start": "592590",
    "end": "595550"
  },
  {
    "text": "you have for fitting\nnon-linear functions.",
    "start": "595550",
    "end": "598339"
  },
  {
    "text": "Some of them you can fit\ndirectly using LM and GLM.",
    "start": "598340",
    "end": "601730"
  },
  {
    "text": "And for the more\nsophisticated ones,",
    "start": "601730",
    "end": "603740"
  },
  {
    "text": "you use the GAM package in R.",
    "start": "603740",
    "end": "607190"
  },
  {
    "text": "There's also a\npackage called MGCV,",
    "start": "607190",
    "end": "609590"
  },
  {
    "text": "which is another package\nthat has GAM models in it.",
    "start": "609590",
    "end": "613790"
  },
  {
    "text": "Also using smoothing\nsplines, slightly different",
    "start": "613790",
    "end": "616220"
  },
  {
    "text": "approach to what we take, but\nyou can use those as well.",
    "start": "616220",
    "end": "620750"
  },
  {
    "text": "So you have plenty of\ntools at your disposal.",
    "start": "620750",
    "end": "623783"
  },
  {
    "text": "In our next section,\nI think we're",
    "start": "623783",
    "end": "625200"
  },
  {
    "text": "going to talk about\ntree-based methods, which",
    "start": "625200",
    "end": "627075"
  },
  {
    "text": "are non-linearities\nas well, but involving",
    "start": "627075",
    "end": "630260"
  },
  {
    "text": "more than one variable, the\ninteractions between variables.",
    "start": "630260",
    "end": "632730"
  },
  {
    "text": "So it's a good way of\nfinding non-linearities,",
    "start": "632730",
    "end": "634647"
  },
  {
    "text": "but of variables in combination.",
    "start": "634647",
    "end": "637069"
  },
  {
    "text": "So we'll talk about\nthings like cart",
    "start": "637070",
    "end": "639200"
  },
  {
    "text": "and other tree-based\nmethods for non-linearities.",
    "start": "639200",
    "end": "644140"
  },
  {
    "start": "644140",
    "end": "645000"
  }
]