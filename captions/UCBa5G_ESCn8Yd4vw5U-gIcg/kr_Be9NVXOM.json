[
  {
    "text": "OK, logistic regression.",
    "start": "0",
    "end": "1710"
  },
  {
    "text": "So now we're going to get\na little bit more mathy.",
    "start": "1710",
    "end": "4730"
  },
  {
    "text": "Let's for shorthand write p of x\nfor the probability that y is 1",
    "start": "4730",
    "end": "9320"
  },
  {
    "text": "given x.",
    "start": "9320",
    "end": "9889"
  },
  {
    "start": "9890",
    "end": "12990"
  },
  {
    "text": "And we're going to\nconsider a simple model",
    "start": "12990",
    "end": "15960"
  },
  {
    "text": "for predicting default\nyes or no using balance,",
    "start": "15960",
    "end": "20550"
  },
  {
    "text": "one of the variables.",
    "start": "20550",
    "end": "21519"
  },
  {
    "text": "So a single variable.",
    "start": "21520",
    "end": "23400"
  },
  {
    "text": "So here's the form of\nlogistic regression.",
    "start": "23400",
    "end": "27800"
  },
  {
    "text": "So that e is the scientific\nconstant, the exponential value.",
    "start": "27800",
    "end": "36829"
  },
  {
    "text": "And we raise e to the\npower of a linear model.",
    "start": "36830",
    "end": "41370"
  },
  {
    "text": "We've got a beta 0,\nwhich is the intercept,",
    "start": "41370",
    "end": "43520"
  },
  {
    "text": "and beta 1 is the\ncoefficient of x.",
    "start": "43520",
    "end": "46910"
  },
  {
    "text": "And you see that appears in the\nnumerator and the denominator,",
    "start": "46910",
    "end": "51080"
  },
  {
    "text": "but there's 1 plus\nin the denominator.",
    "start": "51080",
    "end": "53810"
  },
  {
    "text": "So it's a somewhat\ncomplicated expression,",
    "start": "53810",
    "end": "57050"
  },
  {
    "text": "but you can see straight\naway that the values have",
    "start": "57050",
    "end": "64099"
  },
  {
    "text": "to lie between 0 and 1.",
    "start": "64099",
    "end": "66850"
  },
  {
    "text": "Because in the numerator,\ne to anything is positive",
    "start": "66850",
    "end": "74062"
  },
  {
    "text": "and the denominator is\nbigger than the numerator.",
    "start": "74062",
    "end": "76939"
  },
  {
    "text": "So it's always going\nto be bigger than 0,",
    "start": "76940",
    "end": "80350"
  },
  {
    "text": "and you can show that it's\ngot to be less than 1.",
    "start": "80350",
    "end": "83680"
  },
  {
    "text": "When beta 0 plus beta x gets\nvery large, this approach is 1.",
    "start": "83680",
    "end": "88370"
  },
  {
    "text": "So this is a special\nconstruct, a transformation",
    "start": "88370",
    "end": "91810"
  },
  {
    "text": "of a linear model to\nguarantee that what we get out",
    "start": "91810",
    "end": "95710"
  },
  {
    "text": "is a probability.",
    "start": "95710",
    "end": "99110"
  },
  {
    "text": "So that's called the\nlogistic regression model.",
    "start": "99110",
    "end": "102710"
  },
  {
    "text": "And actually, the name logistic\ncomes from the transformation",
    "start": "102710",
    "end": "106370"
  },
  {
    "text": "of this model.",
    "start": "106370",
    "end": "107340"
  },
  {
    "text": "So this called-- this is\na monotone transformation.",
    "start": "107340",
    "end": "110909"
  },
  {
    "text": "We take log of p of x over\n1 minus p of x and out",
    "start": "110910",
    "end": "115940"
  },
  {
    "text": "pops our linear model.",
    "start": "115940",
    "end": "117330"
  },
  {
    "text": "And that transformation\nis called",
    "start": "117330",
    "end": "119240"
  },
  {
    "text": "the log odds or the\nlogit transformation",
    "start": "119240",
    "end": "122119"
  },
  {
    "text": "of the probability.",
    "start": "122120",
    "end": "124660"
  },
  {
    "text": "And this is the model that we're\ngoing to talk about right now.",
    "start": "124660",
    "end": "128080"
  },
  {
    "text": "To summarize, we've got\na linear model still,",
    "start": "128080",
    "end": "130479"
  },
  {
    "text": "but it's modeling\nthe probabilities",
    "start": "130479",
    "end": "132580"
  },
  {
    "text": "on a nonlinear scale.",
    "start": "132580",
    "end": "135130"
  },
  {
    "text": "And so back to\nour picture again.",
    "start": "135130",
    "end": "138270"
  },
  {
    "text": "The picture on the\nright was produced",
    "start": "138270",
    "end": "140260"
  },
  {
    "text": "by a logistic regression model.",
    "start": "140260",
    "end": "141860"
  },
  {
    "text": "And that's why the probabilities\nlie between 0 and 1.",
    "start": "141860",
    "end": "145360"
  },
  {
    "text": "So we've written down the model.",
    "start": "145360",
    "end": "148020"
  },
  {
    "text": "How do we estimate\nthe model from data?",
    "start": "148020",
    "end": "152340"
  },
  {
    "text": "Well, the popular way is\nto use maximum likelihood.",
    "start": "152340",
    "end": "156209"
  },
  {
    "text": "Maximum likelihood\nwas introduced by who?",
    "start": "156210",
    "end": "160350"
  },
  {
    "text": "Me, actually.",
    "start": "160350",
    "end": "161170"
  },
  {
    "text": "Oh, you?",
    "start": "161170",
    "end": "161670"
  },
  {
    "text": "Yes, just last week.",
    "start": "161670",
    "end": "163390"
  },
  {
    "text": "Did you reinvent it or?",
    "start": "163390",
    "end": "164680"
  },
  {
    "text": "I didn't realize it.",
    "start": "164680",
    "end": "165750"
  },
  {
    "text": "Actually, the correct answer\nis Fisher back in the 1920s,",
    "start": "165750",
    "end": "169780"
  },
  {
    "text": "Ronald Fisher.",
    "start": "169780",
    "end": "170470"
  },
  {
    "text": "Fisher.",
    "start": "170470",
    "end": "171630"
  },
  {
    "text": "Ronald Fisher, very\nfamous statistician,",
    "start": "171630",
    "end": "174570"
  },
  {
    "text": "invented a lot of\nthe tools that we",
    "start": "174570",
    "end": "176340"
  },
  {
    "text": "use in modern\napplied statistics,",
    "start": "176340",
    "end": "178709"
  },
  {
    "text": "and maximum likelihood\nis one of them.",
    "start": "178710",
    "end": "182130"
  },
  {
    "text": "Well, the way maximum\nlikelihood works",
    "start": "182130",
    "end": "183960"
  },
  {
    "text": "is you've got a data series\nof observed zeros and ones,",
    "start": "183960",
    "end": "188730"
  },
  {
    "text": "and you've got a model\nfor the probabilities.",
    "start": "188730",
    "end": "190959"
  },
  {
    "text": "And that model\ninvolves parameters,",
    "start": "190960",
    "end": "192780"
  },
  {
    "text": "in this case, beta 0 and beta.",
    "start": "192780",
    "end": "195300"
  },
  {
    "text": "So for any values\nof the parameters,",
    "start": "195300",
    "end": "197790"
  },
  {
    "text": "we can write down\nthe probability",
    "start": "197790",
    "end": "199709"
  },
  {
    "text": "of the observed data.",
    "start": "199710",
    "end": "201360"
  },
  {
    "text": "And since each\nobservation is meant",
    "start": "201360",
    "end": "203400"
  },
  {
    "text": "to be independent\nof each other one,",
    "start": "203400",
    "end": "205230"
  },
  {
    "text": "the probability of\nthe observed data",
    "start": "205230",
    "end": "208190"
  },
  {
    "text": "is the probability\nof the observed",
    "start": "208190",
    "end": "210690"
  },
  {
    "text": "string of zeros and ones.",
    "start": "210690",
    "end": "213490"
  },
  {
    "text": "So wherever we observed a 1,\nwe write down the probability",
    "start": "213490",
    "end": "217240"
  },
  {
    "text": "of a 1, which is p of x.",
    "start": "217240",
    "end": "219140"
  },
  {
    "text": "So if observation i was a 1,\nthe probability is p of xi,",
    "start": "219140",
    "end": "225460"
  },
  {
    "text": "and we write that down.",
    "start": "225460",
    "end": "227320"
  },
  {
    "text": "And since they're\nall independent,",
    "start": "227320",
    "end": "229030"
  },
  {
    "text": "we just multiply\nthese probabilities.",
    "start": "229030",
    "end": "231069"
  },
  {
    "text": "And these are the\nprobabilities of a 0, which is",
    "start": "231070",
    "end": "233560"
  },
  {
    "text": "1 minus the probability of a 1.",
    "start": "233560",
    "end": "235690"
  },
  {
    "text": "So this is the joint probability\nof the observed sequence",
    "start": "235690",
    "end": "239410"
  },
  {
    "text": "of zeros and ones.",
    "start": "239410",
    "end": "241060"
  },
  {
    "text": "And, of course, it\ninvolves the parameters.",
    "start": "241060",
    "end": "243489"
  },
  {
    "text": "And so the idea of\nmaximum likelihood",
    "start": "243490",
    "end": "245410"
  },
  {
    "text": "is pick the parameters to\nmake that probability as large",
    "start": "245410",
    "end": "248740"
  },
  {
    "text": "as possible because\nafter all, you",
    "start": "248740",
    "end": "250600"
  },
  {
    "text": "did observe the sequence\nof zeros and ones.",
    "start": "250600",
    "end": "253680"
  },
  {
    "text": "And so that's the idea.",
    "start": "253680",
    "end": "255530"
  },
  {
    "text": "Simple to say, not\nalways simple to execute.",
    "start": "255530",
    "end": "259620"
  },
  {
    "text": "But luckily, we have\nprograms that can do this.",
    "start": "259620",
    "end": "262360"
  },
  {
    "text": "And for example, in R,\nwe've got the GLM function",
    "start": "262360",
    "end": "266009"
  },
  {
    "text": "which in a snap of a finger\nwill fit this model for you",
    "start": "266010",
    "end": "270060"
  },
  {
    "text": "and estimate the parameters.",
    "start": "270060",
    "end": "271860"
  },
  {
    "text": "And in this case, this\nis what it produced.",
    "start": "271860",
    "end": "274979"
  },
  {
    "text": "The coefficient estimates were\nminus 10 for the intercept",
    "start": "274980",
    "end": "278490"
  },
  {
    "text": "and 0.0055 for the\nslope for balance.",
    "start": "278490",
    "end": "283699"
  },
  {
    "text": "That's beta and beta 0.",
    "start": "283700",
    "end": "286170"
  },
  {
    "text": "It also gives you the-- so\nthere the coefficient estimates.",
    "start": "286170",
    "end": "289625"
  },
  {
    "text": "It also gives you\nstandard errors",
    "start": "289625",
    "end": "291000"
  },
  {
    "text": "for each of the\ncoefficient estimates.",
    "start": "291000",
    "end": "294110"
  },
  {
    "text": "It computes a z-statistic, and\nit also gives you p-values.",
    "start": "294110",
    "end": "298206"
  },
  {
    "text": "Oh, I think I just\nrealized something.",
    "start": "298207",
    "end": "299790"
  },
  {
    "text": "So you had a picture a couple\nof slides ago of the curve.",
    "start": "299790",
    "end": "303000"
  },
  {
    "text": "Yes.",
    "start": "303000",
    "end": "303500"
  },
  {
    "text": "And is that how you found the--",
    "start": "303500",
    "end": "304680"
  },
  {
    "text": "I was wondering how you found\nthe parameters for that curve.",
    "start": "304680",
    "end": "307039"
  },
  {
    "text": "Is that how you found--",
    "start": "307040",
    "end": "307998"
  },
  {
    "text": "That's exactly right, Rob.",
    "start": "307998",
    "end": "309289"
  },
  {
    "text": "So this curve over here\nis the curve corresponding",
    "start": "309290",
    "end": "314150"
  },
  {
    "text": "to those estimates that we\njust produced in the table.",
    "start": "314150",
    "end": "317090"
  },
  {
    "text": "And you might be surprised\nbecause the slope is very small",
    "start": "317090",
    "end": "320449"
  },
  {
    "text": "here, yet it seemed to\nproduce such a big change",
    "start": "320450",
    "end": "325670"
  },
  {
    "text": "in the probabilities.",
    "start": "325670",
    "end": "327020"
  },
  {
    "text": "There may be a typo or is it--",
    "start": "327020",
    "end": "330199"
  },
  {
    "text": "I certainly hope not.",
    "start": "330200",
    "end": "332120"
  },
  {
    "text": "But let's look a bit closer.",
    "start": "332120",
    "end": "334169"
  },
  {
    "text": "Look at the units of balance.",
    "start": "334170",
    "end": "336920"
  },
  {
    "text": "They're in dollars.",
    "start": "336920",
    "end": "338310"
  },
  {
    "text": "So we've got $2,000, $2,500.",
    "start": "338310",
    "end": "342620"
  },
  {
    "text": "And so the values\nof the coefficients,",
    "start": "342620",
    "end": "345720"
  },
  {
    "text": "which are going to multiply\nthat balance variable,",
    "start": "345720",
    "end": "348710"
  },
  {
    "text": "they take into account\nthe units that are used.",
    "start": "348710",
    "end": "352994"
  },
  {
    "text": "So this is 0.005 per dollar,\nbut it would be 5 per $1,000.",
    "start": "352994",
    "end": "361849"
  },
  {
    "text": "So slopes, you have to take\nthe units into account.",
    "start": "361850",
    "end": "365500"
  },
  {
    "text": "And so the z-statistic, which\nis a kind of standardized slope,",
    "start": "365500",
    "end": "369400"
  },
  {
    "text": "does that.",
    "start": "369400",
    "end": "370520"
  },
  {
    "text": "And then if we look\nat the p-value,",
    "start": "370520",
    "end": "372400"
  },
  {
    "text": "we see that the chance that\nactually this balance slope is 0",
    "start": "372400",
    "end": "378610"
  },
  {
    "text": "is very small, less than 0.001.",
    "start": "378610",
    "end": "381349"
  },
  {
    "text": "So both intercept and\nslope strongly significant",
    "start": "381350",
    "end": "384340"
  },
  {
    "text": "in this case.",
    "start": "384340",
    "end": "385160"
  },
  {
    "text": "How do I interpret that\np-value for the intercept?",
    "start": "385160",
    "end": "387243"
  },
  {
    "text": "Do I care about that or?",
    "start": "387243",
    "end": "388480"
  },
  {
    "text": "We usually don't care so\nmuch about the p-value",
    "start": "388480",
    "end": "391210"
  },
  {
    "text": "for the intercept.",
    "start": "391210",
    "end": "393009"
  },
  {
    "text": "The intercept is largely to do\nwith the preponderance of zeros",
    "start": "393010",
    "end": "398650"
  },
  {
    "text": "and ones in the data set.",
    "start": "398650",
    "end": "400225"
  },
  {
    "start": "400225",
    "end": "404170"
  },
  {
    "text": "And so that's of\nless importance.",
    "start": "404170",
    "end": "406058"
  },
  {
    "text": "That's just inherent\nin the data set.",
    "start": "406058",
    "end": "407600"
  },
  {
    "text": "It's the slope that's\nreally important.",
    "start": "407600",
    "end": "409720"
  },
  {
    "text": "What do we do with this model?",
    "start": "409720",
    "end": "411890"
  },
  {
    "text": "We can predict probabilities.",
    "start": "411890",
    "end": "414330"
  },
  {
    "text": "And so let's suppose we take a\nperson with a balance of $1,000.",
    "start": "414330",
    "end": "419009"
  },
  {
    "text": "Well, we can estimate\ntheir probabilities.",
    "start": "419010",
    "end": "421480"
  },
  {
    "text": "So we just plug in the $1,000\ninto this formula over here.",
    "start": "421480",
    "end": "425920"
  },
  {
    "text": "And notice I've put hats\non beta 0 and beta 1",
    "start": "425920",
    "end": "429390"
  },
  {
    "text": "to indicate that they've now\nbeen estimated from the data.",
    "start": "429390",
    "end": "433490"
  },
  {
    "text": "Put a hat on the probability.",
    "start": "433490",
    "end": "436440"
  },
  {
    "text": "And here we've\nplugged in the numbers",
    "start": "436440",
    "end": "438990"
  },
  {
    "text": "and we use our calculator, a\ncomputer, and we get 0.006.",
    "start": "438990",
    "end": "444370"
  },
  {
    "text": "So somebody with a balance\nof $1,000 has a probability",
    "start": "444370",
    "end": "449410"
  },
  {
    "text": "of 0.006 of defaulting.",
    "start": "449410",
    "end": "451670"
  },
  {
    "text": "In other words, pretty small.",
    "start": "451670",
    "end": "453460"
  },
  {
    "text": "What if they've got a credit\ncard balance of $2,000?",
    "start": "453460",
    "end": "457440"
  },
  {
    "text": "That means they owe\n$2,000 rather than $1,000.",
    "start": "457440",
    "end": "461230"
  },
  {
    "text": "Well, if we go through\nthe same procedure,",
    "start": "461230",
    "end": "463230"
  },
  {
    "text": "now the probability\nhas jumped up to 0.586.",
    "start": "463230",
    "end": "466420"
  },
  {
    "text": "So it's got much higher.",
    "start": "466420",
    "end": "467940"
  },
  {
    "text": "And you can imagine if we put\nin $3,000, we'd get even higher.",
    "start": "467940",
    "end": "473030"
  },
  {
    "text": "Let's do this again using\nsome of the other variables.",
    "start": "473030",
    "end": "475970"
  },
  {
    "text": "We haven't seen student yet,\nbut one of our predictors",
    "start": "475970",
    "end": "478670"
  },
  {
    "text": "is student.",
    "start": "478670",
    "end": "479540"
  },
  {
    "text": "And it's a binary\nvariable, in this case.",
    "start": "479540",
    "end": "481880"
  },
  {
    "text": "It's a yes or no variable.",
    "start": "481880",
    "end": "484040"
  },
  {
    "text": "Is the credit card\nowner a student or not?",
    "start": "484040",
    "end": "489260"
  },
  {
    "text": "And so we code that as\n0, 1 variable and we",
    "start": "489260",
    "end": "492740"
  },
  {
    "text": "fit a simple logistic\nregression model,",
    "start": "492740",
    "end": "494930"
  },
  {
    "text": "and it gets a\ncoefficient of 0.4049.",
    "start": "494930",
    "end": "500400"
  },
  {
    "text": "And that's also significant.",
    "start": "500400",
    "end": "502699"
  },
  {
    "text": "OK, let's do it again using the\nvariable student as a predictor.",
    "start": "502700",
    "end": "506450"
  },
  {
    "text": "This is a binary variable.",
    "start": "506450",
    "end": "508350"
  },
  {
    "text": "Is the credit card\nholder student or not?",
    "start": "508350",
    "end": "511130"
  },
  {
    "text": "And we get a\ncoefficient of 0.4049,",
    "start": "511130",
    "end": "515479"
  },
  {
    "text": "in this case, which\nis also significant.",
    "start": "515480",
    "end": "517940"
  },
  {
    "text": "So this is another\nvariable in our database.",
    "start": "517940",
    "end": "520740"
  },
  {
    "text": "And just like before,\nwe can evaluate",
    "start": "520740",
    "end": "522799"
  },
  {
    "text": "the probability\nof default is yes.",
    "start": "522799",
    "end": "526700"
  },
  {
    "text": "Given that the cardholder is a\nstudent, it comes out to 0.04.",
    "start": "526700",
    "end": "532110"
  },
  {
    "text": "And if they're not\na student, comes out",
    "start": "532110",
    "end": "533880"
  },
  {
    "text": "to be a bit lower,\n0.029 close to 0.03.",
    "start": "533880",
    "end": "539100"
  },
  {
    "text": "And we're going to examine the\ninteractions between student",
    "start": "539100",
    "end": "543329"
  },
  {
    "text": "and balance and other\nvariables in a little while.",
    "start": "543330",
    "end": "547730"
  }
]