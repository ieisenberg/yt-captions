[
  {
    "start": "0",
    "end": "6000"
  },
  {
    "start": "0",
    "end": "6015"
  },
  {
    "start": "6000",
    "end": "17000"
  },
  {
    "text": "Hi, in this module, I'm going to\npresent the particle filtering",
    "start": "6015",
    "end": "8639"
  },
  {
    "text": "algorithm for performing\napproximate inference in Hidden",
    "start": "8640",
    "end": "11610"
  },
  {
    "text": "Markov models, which\nis really useful when",
    "start": "11610",
    "end": "14340"
  },
  {
    "text": "the size of a domain of the\nvariables is very large.",
    "start": "14340",
    "end": "18200"
  },
  {
    "start": "17000",
    "end": "101000"
  },
  {
    "text": "So let's start with our\nfamiliar object tracking HMM.",
    "start": "18200",
    "end": "22670"
  },
  {
    "text": "In this case, for\nevery time step,",
    "start": "22670",
    "end": "24170"
  },
  {
    "text": "we have a position Hi of an\nobject which we don't see.",
    "start": "24170",
    "end": "28490"
  },
  {
    "text": "And instead we see some\nnoisy sensor readings.",
    "start": "28490",
    "end": "32369"
  },
  {
    "text": "So the probabilistic story of\nobject tracking is as follows.",
    "start": "32369",
    "end": "36420"
  },
  {
    "text": "H1, the first object position is\ngenerated uniformly across all",
    "start": "36420",
    "end": "42245"
  },
  {
    "text": "of the values--",
    "start": "42245",
    "end": "42870"
  },
  {
    "text": "0, 1, 2.",
    "start": "42870",
    "end": "44899"
  },
  {
    "text": "Subsequently, H2 is\ngenerated conditioned",
    "start": "44900",
    "end": "48380"
  },
  {
    "text": "on H1 via this transition\ndistribution which goes up",
    "start": "48380",
    "end": "52610"
  },
  {
    "text": "with probability one quarter.",
    "start": "52610",
    "end": "54800"
  },
  {
    "text": "Stays the same\nwith probabiliy one",
    "start": "54800",
    "end": "56340"
  },
  {
    "text": "half, down with probability\none quarter, and returns at H3.",
    "start": "56340",
    "end": "63150"
  },
  {
    "text": "Now at each time step,\nwe get a sensor reading--",
    "start": "63150",
    "end": "66675"
  },
  {
    "text": "E1, E2, E3 conditioned on\nthe respective locations,",
    "start": "66675",
    "end": "71060"
  },
  {
    "text": "and that's governed by the\nemission distribution, which",
    "start": "71060",
    "end": "76310"
  },
  {
    "text": "takes Hi and goes\nup by a quarter.",
    "start": "76310",
    "end": "80360"
  },
  {
    "text": "It's the same with 1/2.",
    "start": "80360",
    "end": "82760"
  },
  {
    "text": "Goes down with\nprobably one-quarter.",
    "start": "82760",
    "end": "85890"
  },
  {
    "text": "So now you multiply all of these\nlocal conditional distributions",
    "start": "85890",
    "end": "89280"
  },
  {
    "text": "together, and you get one\nglorious joint distribution",
    "start": "89280",
    "end": "92580"
  },
  {
    "text": "over all the object locations,\nas well as the sensor readings.",
    "start": "92580",
    "end": "98940"
  },
  {
    "text": "That's our HMM.",
    "start": "98940",
    "end": "101490"
  },
  {
    "start": "101000",
    "end": "197000"
  },
  {
    "text": "So now, given this\nHMM, we can ask",
    "start": "101490",
    "end": "104040"
  },
  {
    "text": "all sorts of questions on it.",
    "start": "104040",
    "end": "106890"
  },
  {
    "text": "In particular, we looked\nat filtering and smoothing",
    "start": "106890",
    "end": "109080"
  },
  {
    "text": "questions.",
    "start": "109080",
    "end": "110232"
  },
  {
    "text": "But particle\nfiltering, as the name",
    "start": "110232",
    "end": "111690"
  },
  {
    "text": "might suggest, does filtering,\nso let's focus on filtering.",
    "start": "111690",
    "end": "116450"
  },
  {
    "text": "So in filtering, we're asking\nfor the position of an object",
    "start": "116450",
    "end": "122600"
  },
  {
    "text": "at a particular time step\nconditioned on the past.",
    "start": "122600",
    "end": "126500"
  },
  {
    "text": "So time step 1,\nwe're asking for--",
    "start": "126500",
    "end": "128869"
  },
  {
    "text": "I'm looking at only the\nevidence at time step 1",
    "start": "128870",
    "end": "132530"
  },
  {
    "text": "in terms of was like,\nwhere is this object?",
    "start": "132530",
    "end": "135350"
  },
  {
    "text": "At time step 2, I now\nhave two observations.",
    "start": "135350",
    "end": "139020"
  },
  {
    "text": "Now I ask what is the\nobject at time step 2.",
    "start": "139020",
    "end": "142835"
  },
  {
    "text": "At time step 3, I have\nthree observations,",
    "start": "142835",
    "end": "145520"
  },
  {
    "text": "and now I'm at [AUDIO OUT] four\nwords object at time step 3.",
    "start": "145520",
    "end": "150270"
  },
  {
    "text": "So now I could apply\nforward-backward algorithm",
    "start": "150270",
    "end": "153780"
  },
  {
    "text": "to this scenario.",
    "start": "153780",
    "end": "157060"
  },
  {
    "text": "And that would work,\nbut the problem",
    "start": "157060",
    "end": "159630"
  },
  {
    "text": "is that there is-- if you\nhave a setting where there's",
    "start": "159630",
    "end": "162000"
  },
  {
    "text": "many, many location values\nfor Hi, in our simple example,",
    "start": "162000",
    "end": "166758"
  },
  {
    "text": "there's only three.",
    "start": "166758",
    "end": "167550"
  },
  {
    "text": "But in practice, they're\ngoing to be 100,000.",
    "start": "167550",
    "end": "170650"
  },
  {
    "text": "And in that case,\nforward-backward",
    "start": "170650",
    "end": "172450"
  },
  {
    "text": "is going to be really, really\nslow because its running time",
    "start": "172450",
    "end": "175660"
  },
  {
    "text": "scales quadratically\nwith a number",
    "start": "175660",
    "end": "177370"
  },
  {
    "text": "of 100,000 squared, which\nis not a nice [AUDIO OUT]..",
    "start": "177370",
    "end": "182400"
  },
  {
    "text": "The goal of particle\nfiltering is",
    "start": "182400",
    "end": "183810"
  },
  {
    "text": "to realize that, well, you\nhave 100,000 possible values",
    "start": "183810",
    "end": "188220"
  },
  {
    "text": "but only a very small\nfraction of them",
    "start": "188220",
    "end": "190110"
  },
  {
    "text": "are really likely given\nthe data you have.",
    "start": "190110",
    "end": "195690"
  },
  {
    "text": "So to start introducing\nparticle filtering,",
    "start": "195690",
    "end": "198710"
  },
  {
    "start": "197000",
    "end": "404000"
  },
  {
    "text": "let us revisit beam search\nbecause structurally, particle",
    "start": "198710",
    "end": "202340"
  },
  {
    "text": "and beam search are analogous.",
    "start": "202340",
    "end": "206750"
  },
  {
    "text": "And beam search,\nremember the idea",
    "start": "206750",
    "end": "208490"
  },
  {
    "text": "was to keep track of at most\nK partial assignments, which",
    "start": "208490",
    "end": "213230"
  },
  {
    "text": "we're going to call particles\nnow in the particle filtering",
    "start": "213230",
    "end": "216739"
  },
  {
    "text": "lingo.",
    "start": "216740",
    "end": "218500"
  },
  {
    "text": "So beam search starts\nwith a candidate set",
    "start": "218500",
    "end": "221620"
  },
  {
    "text": "of only one assignment,\nwhich is the empty assignment",
    "start": "221620",
    "end": "224105"
  },
  {
    "text": "and it's going to go through\neach variable in turn--",
    "start": "224105",
    "end": "227950"
  },
  {
    "text": "1 to n.",
    "start": "227950",
    "end": "229780"
  },
  {
    "text": "And now we're\ngoing to-- for each",
    "start": "229780",
    "end": "231730"
  },
  {
    "text": "of these partial assignments,\nfor H1 through Hi minus 1.",
    "start": "231730",
    "end": "237700"
  },
  {
    "text": "I'm going to take\nthat, and then I'm",
    "start": "237700",
    "end": "239739"
  },
  {
    "text": "going to consider all possible\nvalues I can assign to Hi.",
    "start": "239740",
    "end": "243970"
  },
  {
    "text": "I'm going to extend\nthat assignment.",
    "start": "243970",
    "end": "245560"
  },
  {
    "text": "So now we get a bunch of\nassignments from Hi to Hi my i.",
    "start": "245560",
    "end": "252150"
  },
  {
    "text": "And now, I'm going to\ncompute the weight of each",
    "start": "252150",
    "end": "254150"
  },
  {
    "text": "of these candidate\nparticles, and I'm just",
    "start": "254150",
    "end": "258528"
  },
  {
    "text": "going to take the K\nhighest weight particles.",
    "start": "258529",
    "end": "264190"
  },
  {
    "text": "So let's recall beam search\non this example here.",
    "start": "264190",
    "end": "269730"
  },
  {
    "text": "Here we have our\nobject tracking HMM.",
    "start": "269730",
    "end": "273840"
  },
  {
    "text": "We have the variables and\nall the local conditional",
    "start": "273840",
    "end": "277230"
  },
  {
    "text": "distributions, and\nI'm observing 0, 0, 2.",
    "start": "277230",
    "end": "281670"
  },
  {
    "text": "So a beam search starts out,\nextending to variable H1,",
    "start": "281670",
    "end": "286860"
  },
  {
    "text": "and it produces 0, 1, and 2\nare the possible particles",
    "start": "286860",
    "end": "292439"
  },
  {
    "text": "with weights--",
    "start": "292440",
    "end": "294210"
  },
  {
    "text": "these probabilities here.",
    "start": "294210",
    "end": "297180"
  },
  {
    "text": "And a prune which does\nnothing because K is 3.",
    "start": "297180",
    "end": "300449"
  },
  {
    "text": "And then next, I'm\ngoing to extend to H2.",
    "start": "300450",
    "end": "305220"
  },
  {
    "text": "So each of these particles\nkind of multiplies into three",
    "start": "305220",
    "end": "310950"
  },
  {
    "text": "particles.",
    "start": "310950",
    "end": "312250"
  },
  {
    "text": "And now the weight of\neach of these particles",
    "start": "312250",
    "end": "315870"
  },
  {
    "text": "is going to now include\nthe factors, which",
    "start": "315870",
    "end": "319440"
  },
  {
    "text": "are the transition into\nH2, and the emission of e2",
    "start": "319440",
    "end": "322830"
  },
  {
    "text": "equals 2 given H2.",
    "start": "322830",
    "end": "325830"
  },
  {
    "text": "Now I'm going to\nprune down to 3.",
    "start": "325830",
    "end": "330150"
  },
  {
    "text": "I'm going to now extend to\nH3, and I'm going to prune--",
    "start": "330150",
    "end": "334695"
  },
  {
    "start": "334695",
    "end": "337230"
  },
  {
    "text": "and at the end, I get\na set of particles.",
    "start": "337230",
    "end": "342760"
  },
  {
    "text": "So here I have 0, 1, 2.",
    "start": "342760",
    "end": "346110"
  },
  {
    "text": "I have 1-- so 0, 1, 1.",
    "start": "346110",
    "end": "350069"
  },
  {
    "text": "I also have 1, 2, 2.",
    "start": "350070",
    "end": "352980"
  },
  {
    "text": "And each particle\nhas some weight.",
    "start": "352980",
    "end": "356820"
  },
  {
    "text": "Normally in beam search,\nwe're interested in the--",
    "start": "356820",
    "end": "360810"
  },
  {
    "text": "presented in a context of\nfinding max weight assignments.",
    "start": "360810",
    "end": "363690"
  },
  {
    "text": "So in this case, you\nwould just return 1, 2, 2.",
    "start": "363690",
    "end": "367290"
  },
  {
    "text": "But in the case of\nparticle filtering,",
    "start": "367290",
    "end": "368940"
  },
  {
    "text": "we're interested in\nanswering filtering queries.",
    "start": "368940",
    "end": "372815"
  },
  {
    "text": "So what we're\ngoing to do instead",
    "start": "372815",
    "end": "374190"
  },
  {
    "text": "is we're going to normalize the\nweights over all the particles",
    "start": "374190",
    "end": "378600"
  },
  {
    "text": "to get an approximate\ndistribution over assignments.",
    "start": "378600",
    "end": "383532"
  },
  {
    "text": "And now we're going\nto pretend this",
    "start": "383532",
    "end": "384990"
  },
  {
    "text": "is a joint distribution over\nH1 to Hm, given the evidence.",
    "start": "384990",
    "end": "391190"
  },
  {
    "text": "And now I'm going to\njust sum probabilities",
    "start": "391190",
    "end": "393650"
  },
  {
    "text": "to get any approximate\nsmoothing-- a filter query",
    "start": "393650",
    "end": "398145"
  },
  {
    "text": "I like.",
    "start": "398145",
    "end": "398645"
  },
  {
    "start": "398645",
    "end": "401990"
  },
  {
    "text": "So this is fine, but it\nhas two problems with it.",
    "start": "401990",
    "end": "408410"
  },
  {
    "start": "404000",
    "end": "474000"
  },
  {
    "text": "One is that the\nextend step is slow",
    "start": "408410",
    "end": "412480"
  },
  {
    "text": "because it requires considering\nevery possible value of Hi.",
    "start": "412480",
    "end": "418760"
  },
  {
    "text": "So sometimes you can be clever.",
    "start": "418760",
    "end": "420310"
  },
  {
    "text": "You don't have to enumerate\nall the values in the domain,",
    "start": "420310",
    "end": "423250"
  },
  {
    "text": "and you can only\nenumerate over values",
    "start": "423250",
    "end": "428780"
  },
  {
    "text": "that are going to\nhave positive weight,",
    "start": "428780",
    "end": "433310"
  },
  {
    "text": "but even that could be a lot.",
    "start": "433310",
    "end": "436960"
  },
  {
    "text": "So the second problem\nis that we are greedily",
    "start": "436960",
    "end": "441310"
  },
  {
    "text": "taking the K particles\nwith the highest weight.",
    "start": "441310",
    "end": "446530"
  },
  {
    "text": "So this is going to,\nas we'll see later,",
    "start": "446530",
    "end": "449670"
  },
  {
    "text": "doesn't provide\nenough diversity.",
    "start": "449670",
    "end": "452130"
  },
  {
    "text": "So we're going to have\nto do something about it.",
    "start": "452130",
    "end": "455790"
  },
  {
    "text": "So particle filtering is going\nto solve both of these issues,",
    "start": "455790",
    "end": "460760"
  },
  {
    "text": "and particle filtering is\ngoing to contain three steps",
    "start": "460760",
    "end": "463520"
  },
  {
    "text": "to replace the extend prune\n2-step procedure of beam",
    "start": "463520",
    "end": "467810"
  },
  {
    "text": "search.",
    "start": "467810",
    "end": "469220"
  },
  {
    "text": "So propose, weight, and\nresample are the three steps,",
    "start": "469220",
    "end": "471960"
  },
  {
    "text": "and we're going to go\nthrough them in turn.",
    "start": "471960",
    "end": "475039"
  },
  {
    "start": "474000",
    "end": "572000"
  },
  {
    "text": "The first step is propose.",
    "start": "475040",
    "end": "476740"
  },
  {
    "text": "So in general, you should think\nabout the set of particles",
    "start": "476740",
    "end": "480250"
  },
  {
    "text": "as an approximating a\ncertain distribution.",
    "start": "480250",
    "end": "483820"
  },
  {
    "text": "In general, the\nfiltering distribution",
    "start": "483820",
    "end": "485470"
  },
  {
    "text": "is the probability\nof the variables",
    "start": "485470",
    "end": "488440"
  },
  {
    "text": "that you are considering\nconditioned on the evidence",
    "start": "488440",
    "end": "491090"
  },
  {
    "text": "so far.",
    "start": "491090",
    "end": "492340"
  },
  {
    "text": "And suppose we have just two\nparticles here, 0, 1, and 1, 2.",
    "start": "492340",
    "end": "500000"
  },
  {
    "text": "So now the propose\nstep is going to take",
    "start": "500000",
    "end": "505250"
  },
  {
    "text": "each of these\nparticles, and I'm just",
    "start": "505250",
    "end": "507410"
  },
  {
    "text": "going to sample a value for\nH3 the next variable-- given",
    "start": "507410",
    "end": "513679"
  },
  {
    "text": "the transmission distribution.",
    "start": "513679",
    "end": "516219"
  },
  {
    "text": "Remember it was up and\ndown with probability one",
    "start": "516220",
    "end": "519219"
  },
  {
    "text": "quarter and the same\nwith probability 1/2.",
    "start": "519220",
    "end": "523909"
  },
  {
    "text": "So that is going to produce\nthese extended articles",
    "start": "523909",
    "end": "528890"
  },
  {
    "text": "conditioned on\nthe same evidence.",
    "start": "528890",
    "end": "531720"
  },
  {
    "text": "So for example, I'm\ngoing to take 0, 1.",
    "start": "531720",
    "end": "536160"
  },
  {
    "text": "I'm going to-- now that\nwill produce this particle",
    "start": "536160",
    "end": "542790"
  },
  {
    "text": "with probability 1/2\nbecause I'm just keeping",
    "start": "542790",
    "end": "549220"
  },
  {
    "text": "the value of the same year.",
    "start": "549220",
    "end": "551829"
  },
  {
    "text": "And I'm going to\ntake this particle,",
    "start": "551830",
    "end": "554230"
  },
  {
    "text": "and I'm going to extend it to 2.",
    "start": "554230",
    "end": "556420"
  },
  {
    "text": "And that's also going to\nhappen with probability 1/2.",
    "start": "556420",
    "end": "558730"
  },
  {
    "text": "Now, this is a random algorithm.",
    "start": "558730",
    "end": "561290"
  },
  {
    "text": "So I could have sampled\nfrom the distribution.",
    "start": "561290",
    "end": "563500"
  },
  {
    "text": "I could have got 1 here.",
    "start": "563500",
    "end": "565720"
  },
  {
    "text": "I could have gotten 3 here,\nbut let's just go with 1, 2.",
    "start": "565720",
    "end": "569379"
  },
  {
    "start": "569380",
    "end": "572830"
  },
  {
    "start": "572000",
    "end": "669000"
  },
  {
    "text": "So in the next\nstep, I'm going to--",
    "start": "572830",
    "end": "575680"
  },
  {
    "text": "wait, so you should think about\nthese particles as a guess",
    "start": "575680",
    "end": "581800"
  },
  {
    "text": "as to what H3 is going to be.",
    "start": "581800",
    "end": "585490"
  },
  {
    "text": "But we need to fact-check\nthis guess with evidence.",
    "start": "585490",
    "end": "589010"
  },
  {
    "text": "And so the weighting\nstep is going",
    "start": "589010",
    "end": "592210"
  },
  {
    "text": "to assign a weight\nto each article.",
    "start": "592210",
    "end": "597080"
  },
  {
    "text": "And that weight is going\nto be the probability",
    "start": "597080",
    "end": "600430"
  },
  {
    "text": "of the new evidence I got\nconditioned on H3 here.",
    "start": "600430",
    "end": "607190"
  },
  {
    "text": "So this is going to produce\na set of new particles, which",
    "start": "607190",
    "end": "612110"
  },
  {
    "text": "are weighted representing\nthe distribution--",
    "start": "612110",
    "end": "616160"
  },
  {
    "text": "the h1, h2, h3 conditioned\non all the evidence so far.",
    "start": "616160",
    "end": "622370"
  },
  {
    "text": "So let's work out this example.",
    "start": "622370",
    "end": "625170"
  },
  {
    "text": "So for the first particle,\nI have h3 equals 1.",
    "start": "625170",
    "end": "629779"
  },
  {
    "text": "So h3 equals 1 is going to\ngenerate the evidence E2 equals",
    "start": "629780",
    "end": "634250"
  },
  {
    "text": "2 with probability one quarter.",
    "start": "634250",
    "end": "636500"
  },
  {
    "text": "So I have a weight of 1/4\nattached to the first particle.",
    "start": "636500",
    "end": "640250"
  },
  {
    "text": "The second particle has--",
    "start": "640250",
    "end": "644580"
  },
  {
    "start": "644580",
    "end": "647130"
  },
  {
    "text": "there should be a\n2 here, actually.",
    "start": "647130",
    "end": "648870"
  },
  {
    "text": "So the second particle\nhas h3 equals 2.",
    "start": "648870",
    "end": "652080"
  },
  {
    "text": "And I'm going to\nlook up this table,",
    "start": "652080",
    "end": "653910"
  },
  {
    "text": "and that's going\nto have weight 1/2",
    "start": "653910",
    "end": "658440"
  },
  {
    "text": "because the probability\nof generating a 2",
    "start": "658440",
    "end": "660300"
  },
  {
    "text": "given a 2 is 1/2.",
    "start": "660300",
    "end": "662880"
  },
  {
    "text": "So I have a weight of\n1/2 on this particle.",
    "start": "662880",
    "end": "668320"
  },
  {
    "text": "So now, at this\npoint, I have a set",
    "start": "668320",
    "end": "671910"
  },
  {
    "start": "669000",
    "end": "776000"
  },
  {
    "text": "of particles that represent\nthe advanced filtering",
    "start": "671910",
    "end": "677670"
  },
  {
    "text": "distribution.",
    "start": "677670",
    "end": "679910"
  },
  {
    "text": "But notice that the\nweights are not the same",
    "start": "679910",
    "end": "684079"
  },
  {
    "text": "and some weights are small,\nsome weights are big.",
    "start": "684080",
    "end": "686960"
  },
  {
    "text": "And in particular, the\nparticles with small weight",
    "start": "686960",
    "end": "690410"
  },
  {
    "text": "are kind of wasting space.",
    "start": "690410",
    "end": "693819"
  },
  {
    "text": "Just think about the K particles\nas kind of a limited resource",
    "start": "693820",
    "end": "697400"
  },
  {
    "text": "for representing\nthis distribution.",
    "start": "697400",
    "end": "699630"
  },
  {
    "text": "So if you have a particle with\nweight 0.0001 or maybe even 0,",
    "start": "699630",
    "end": "705620"
  },
  {
    "text": "then certainly, we shouldn't be\nwasting one of the valuable K",
    "start": "705620",
    "end": "710450"
  },
  {
    "text": "slots for that value.",
    "start": "710450",
    "end": "714110"
  },
  {
    "text": "So what we're going\nto do is to reallocate",
    "start": "714110",
    "end": "717070"
  },
  {
    "text": "our resources via resampling.",
    "start": "717070",
    "end": "720040"
  },
  {
    "text": "So in the resampling\nstep, we're going",
    "start": "720040",
    "end": "721870"
  },
  {
    "text": "to normalize these\nweights and draw K sample.",
    "start": "721870",
    "end": "726130"
  },
  {
    "text": "So normalizing these weights\nproduces this distribution",
    "start": "726130",
    "end": "730750"
  },
  {
    "text": "1/3, 2/3.",
    "start": "730750",
    "end": "733850"
  },
  {
    "text": "And now, I'm going to draw K\nsamples from that distribution",
    "start": "733850",
    "end": "737769"
  },
  {
    "text": "so redistribute.",
    "start": "737770",
    "end": "740420"
  },
  {
    "text": "So the resulting\nparticles are still",
    "start": "740420",
    "end": "743450"
  },
  {
    "text": "going to represent\nthe same distribution,",
    "start": "743450",
    "end": "746720"
  },
  {
    "text": "but slightly in a different\nway without weight.",
    "start": "746720",
    "end": "750319"
  },
  {
    "text": "So I'm going to sample.",
    "start": "750320",
    "end": "753710"
  },
  {
    "text": "Maybe I get 1, 2, 2.",
    "start": "753710",
    "end": "756440"
  },
  {
    "text": "I've got that with\nprobability 2/3.",
    "start": "756440",
    "end": "758900"
  },
  {
    "text": "Sample again, and maybe I get\nthe same particle again 2/3.",
    "start": "758900",
    "end": "763790"
  },
  {
    "text": "Now, of course, this is\nagain a random algorithm.",
    "start": "763790",
    "end": "766139"
  },
  {
    "text": "So I could have gotten the\nfirst one and the second one,",
    "start": "766140",
    "end": "768965"
  },
  {
    "text": "or the second one and the\nfirst one, the first one,",
    "start": "768965",
    "end": "771090"
  },
  {
    "text": "and the first one.",
    "start": "771090",
    "end": "771840"
  },
  {
    "start": "771840",
    "end": "775750"
  },
  {
    "text": "So now you might wonder\nwhy are we resampling?",
    "start": "775750",
    "end": "779490"
  },
  {
    "start": "776000",
    "end": "1062000"
  },
  {
    "text": "Why leave the result of\nthe algorithm up to chance?",
    "start": "779490",
    "end": "783529"
  },
  {
    "text": "So to see why consider\nthe following setting.",
    "start": "783530",
    "end": "786410"
  },
  {
    "text": "So we have a distribution over\na bunch of possible locations.",
    "start": "786410",
    "end": "792399"
  },
  {
    "text": "And suppose that distribution\nwere very close to uniform.",
    "start": "792400",
    "end": "796420"
  },
  {
    "text": "So you can see--",
    "start": "796420",
    "end": "797560"
  },
  {
    "text": "maybe you can see that\nthere's a slight higher",
    "start": "797560",
    "end": "801550"
  },
  {
    "text": "probability in the middle,\nbut it's pretty flat.",
    "start": "801550",
    "end": "806810"
  },
  {
    "text": "So now, if you did\nbeam search, which",
    "start": "806810",
    "end": "809590"
  },
  {
    "text": "takes the K possible positions\nwith the highest weight,",
    "start": "809590",
    "end": "813310"
  },
  {
    "text": "you would end up with this.",
    "start": "813310",
    "end": "816140"
  },
  {
    "text": "And so you would end up with\nall the particles clustering",
    "start": "816140",
    "end": "818650"
  },
  {
    "text": "around the middle,\nwhich is really not",
    "start": "818650",
    "end": "820690"
  },
  {
    "text": "representative of\nthe distribution",
    "start": "820690",
    "end": "823235"
  },
  {
    "text": "because you have all\nof these positions",
    "start": "823235",
    "end": "824860"
  },
  {
    "text": "out here with non-negligible\nprobability mass, which",
    "start": "824860",
    "end": "828640"
  },
  {
    "text": "have no support.",
    "start": "828640",
    "end": "829630"
  },
  {
    "text": "So it's kind of like\nputting all your eggs",
    "start": "829630",
    "end": "831490"
  },
  {
    "text": "in the same basket or the\nsame K baskets, I guess,",
    "start": "831490",
    "end": "835330"
  },
  {
    "text": "as a [AUDIO OUT].",
    "start": "835330",
    "end": "837400"
  },
  {
    "text": "So instead, if you resample or\nsample from this distribution K",
    "start": "837400",
    "end": "841450"
  },
  {
    "text": "times, you're going\nto get something",
    "start": "841450",
    "end": "842950"
  },
  {
    "text": "more like this,\nwhich I would argue",
    "start": "842950",
    "end": "844900"
  },
  {
    "text": "is more representative\nof the distribution.",
    "start": "844900",
    "end": "850570"
  },
  {
    "text": "So in cases where most of the\nweight is on a few locations,",
    "start": "850570",
    "end": "855750"
  },
  {
    "text": "sampling versus taking the top\nK is not really a big deal.",
    "start": "855750",
    "end": "860320"
  },
  {
    "text": "But when there's\nhigh uncertainty,",
    "start": "860320",
    "end": "862170"
  },
  {
    "text": "as in this example,\nsampling is really important",
    "start": "862170",
    "end": "865660"
  },
  {
    "text": "because it allows you to\nmaintain some certainty.",
    "start": "865660",
    "end": "871259"
  },
  {
    "text": "So now we're ready to present\nour final particle filtering",
    "start": "871260",
    "end": "874500"
  },
  {
    "text": "algorithm, which is,\nagain, structured",
    "start": "874500",
    "end": "876990"
  },
  {
    "text": "very similar to beam search.",
    "start": "876990",
    "end": "879330"
  },
  {
    "text": "So like beam search,\nwe initialize",
    "start": "879330",
    "end": "881310"
  },
  {
    "text": "with the empty assignment.",
    "start": "881310",
    "end": "883170"
  },
  {
    "text": "For each of these\ntime steps, we're",
    "start": "883170",
    "end": "886500"
  },
  {
    "text": "going to propose,\nweight, and resample.",
    "start": "886500",
    "end": "889360"
  },
  {
    "text": "So here we're going to propose--",
    "start": "889360",
    "end": "891690"
  },
  {
    "text": "we're going to take\neach assignment to h1",
    "start": "891690",
    "end": "895650"
  },
  {
    "text": "through hi minus 1.",
    "start": "895650",
    "end": "897750"
  },
  {
    "text": "And we're going to look at\nthe transition distribution",
    "start": "897750",
    "end": "900840"
  },
  {
    "text": "and generate one possible\nassignment to hi,",
    "start": "900840",
    "end": "906540"
  },
  {
    "text": "and I'm just going to take that.",
    "start": "906540",
    "end": "908130"
  },
  {
    "text": "So in beam search, I'm going\nto consider all of them, which",
    "start": "908130",
    "end": "912480"
  },
  {
    "text": "can result in a blob, but\nin particle filtering,",
    "start": "912480",
    "end": "914730"
  },
  {
    "text": "I'm going to only look at one.",
    "start": "914730",
    "end": "917829"
  },
  {
    "text": "Now I'm going to\nweight the particles",
    "start": "917830",
    "end": "921120"
  },
  {
    "text": "based on the evidence, which\nis this emission distribution.",
    "start": "921120",
    "end": "927670"
  },
  {
    "text": "And finally, I'm going to\nredistribute my resources",
    "start": "927670",
    "end": "930959"
  },
  {
    "text": "by normalizing this\nweight distribution",
    "start": "930960",
    "end": "936120"
  },
  {
    "text": "and drawing a\nparticles independently",
    "start": "936120",
    "end": "939540"
  },
  {
    "text": "from that distribution, OK?",
    "start": "939540",
    "end": "942019"
  },
  {
    "text": "So let's see a demo here.",
    "start": "942020",
    "end": "943220"
  },
  {
    "start": "943220",
    "end": "945990"
  },
  {
    "text": "So here I have my\nobject tracking HMM.",
    "start": "945990",
    "end": "949370"
  },
  {
    "text": "I'm going to run particle\nfiltering with 100 particles,",
    "start": "949370",
    "end": "953900"
  },
  {
    "text": "instead of beam search.",
    "start": "953900",
    "end": "956660"
  },
  {
    "text": "So I'm going to start\nout with extending",
    "start": "956660",
    "end": "961310"
  },
  {
    "text": "to just the first variable.",
    "start": "961310",
    "end": "967760"
  },
  {
    "text": "And now I have three part--",
    "start": "967760",
    "end": "969650"
  },
  {
    "text": "Well, I have 100 particles,\nbut 38 of them are 0.",
    "start": "969650",
    "end": "975230"
  },
  {
    "text": "33 of them are 1\nand 29 of them 2.",
    "start": "975230",
    "end": "978649"
  },
  {
    "text": "And these are the weights.",
    "start": "978650",
    "end": "980840"
  },
  {
    "text": "I resample, and now I\nredistribute probability",
    "start": "980840",
    "end": "986540"
  },
  {
    "text": "to 0 and 1 with these\nparticle counts.",
    "start": "986540",
    "end": "992570"
  },
  {
    "text": "So now I'm going to extend.",
    "start": "992570",
    "end": "995670"
  },
  {
    "text": "And notice that before,\nI had 73 particles at 0.",
    "start": "995670",
    "end": "1000920"
  },
  {
    "text": "Now 51 of them go to H2\nequals 0, and 22 of them",
    "start": "1000920",
    "end": "1005630"
  },
  {
    "text": "go to H2 equal 1.",
    "start": "1005630",
    "end": "1007370"
  },
  {
    "start": "1007370",
    "end": "1010520"
  },
  {
    "text": "And then I'm going to\nresample, which redistributes",
    "start": "1010520",
    "end": "1017320"
  },
  {
    "text": "the particles again.",
    "start": "1017320",
    "end": "1019060"
  },
  {
    "text": "Now I'm going to\npropose and reweight.",
    "start": "1019060",
    "end": "1024189"
  },
  {
    "text": "Now all the particles\nare all over the place.",
    "start": "1024190",
    "end": "1028329"
  },
  {
    "text": "And now, I redistribute\nmass so that the particles",
    "start": "1028329",
    "end": "1032829"
  },
  {
    "text": "are used more effectively.",
    "start": "1032829",
    "end": "1037439"
  },
  {
    "text": "OK, so now, at the end,\nI have now 100 particles",
    "start": "1037440",
    "end": "1043049"
  },
  {
    "text": "covering all of these\ndifferent assignments.",
    "start": "1043050",
    "end": "1045869"
  },
  {
    "text": "I can simply count\nthe fraction of them",
    "start": "1045869",
    "end": "1049620"
  },
  {
    "text": "for that satisfy\nvarious values of h3",
    "start": "1049620",
    "end": "1052980"
  },
  {
    "text": "and I get my approximate\nfiltering distribution",
    "start": "1052980",
    "end": "1055919"
  },
  {
    "text": "over h3 conditioned on this.",
    "start": "1055920",
    "end": "1058192"
  },
  {
    "start": "1058192",
    "end": "1062750"
  },
  {
    "start": "1062000",
    "end": "1121000"
  },
  {
    "text": "OK, so there are two ways to\nmake particle filtering more",
    "start": "1062750",
    "end": "1067430"
  },
  {
    "text": "efficient.",
    "start": "1067430",
    "end": "1068870"
  },
  {
    "text": "So particle filtering--\nwe've casted",
    "start": "1068870",
    "end": "1072200"
  },
  {
    "text": "in terms of generating\na distribution",
    "start": "1072200",
    "end": "1074179"
  },
  {
    "text": "over complete assignments\nto all of the variables.",
    "start": "1074180",
    "end": "1078000"
  },
  {
    "text": "But if you're only interested\nin filtering queries, which",
    "start": "1078000",
    "end": "1081980"
  },
  {
    "text": "look at the last variables,\nthen what we can do",
    "start": "1081980",
    "end": "1085490"
  },
  {
    "text": "is, instead of storing\nall the assignments,",
    "start": "1085490",
    "end": "1091220"
  },
  {
    "text": "we only need to keep the\nvalue of the last hi.",
    "start": "1091220",
    "end": "1095059"
  },
  {
    "text": "So I'm going to only\nlook at h3 because this",
    "start": "1095060",
    "end": "1099860"
  },
  {
    "text": "is sufficient to continue\nthe algorithm forward.",
    "start": "1099860",
    "end": "1105530"
  },
  {
    "text": "And Furthermore, if you\nhave multiple particles that",
    "start": "1105530",
    "end": "1111020"
  },
  {
    "text": "have the same value,\nyou can actually",
    "start": "1111020",
    "end": "1113030"
  },
  {
    "text": "just store the counts,\nas we saw in the demo.",
    "start": "1113030",
    "end": "1115970"
  },
  {
    "text": "One occurs twice, and\ntwo occurs three times.",
    "start": "1115970",
    "end": "1118159"
  },
  {
    "start": "1118160",
    "end": "1121950"
  },
  {
    "start": "1121000",
    "end": "1321000"
  },
  {
    "text": "So now, let's visualize\nparticle filtering",
    "start": "1121950",
    "end": "1124110"
  },
  {
    "text": "in a more realistic interactive\nobject tracking setting.",
    "start": "1124110",
    "end": "1129320"
  },
  {
    "text": "So here we have a\ngrid, and we have",
    "start": "1129320",
    "end": "1133610"
  },
  {
    "text": "an object that's going\nto be moving in this grid",
    "start": "1133610",
    "end": "1136910"
  },
  {
    "text": "where we're trying to\ndetermine its location.",
    "start": "1136910",
    "end": "1140080"
  },
  {
    "text": "So the HMM is going to put--",
    "start": "1140080",
    "end": "1143880"
  },
  {
    "text": "have a transition\ndistribution that",
    "start": "1143880",
    "end": "1146550"
  },
  {
    "text": "places a uniform\ndistribution over moving",
    "start": "1146550",
    "end": "1149370"
  },
  {
    "text": "North, South, East,\nWest or staying put.",
    "start": "1149370",
    "end": "1153600"
  },
  {
    "text": "And the emission\ndistribution is going",
    "start": "1153600",
    "end": "1155880"
  },
  {
    "text": "to put a uniform\ndistribution over locations",
    "start": "1155880",
    "end": "1158190"
  },
  {
    "text": "that are within three\nsteps, either vertically",
    "start": "1158190",
    "end": "1161580"
  },
  {
    "text": "or horizontally.",
    "start": "1161580",
    "end": "1162950"
  },
  {
    "text": "So you can kind of see this\ndefinition of this emission",
    "start": "1162950",
    "end": "1166080"
  },
  {
    "text": "distribution which only depends\non the x distance and the y",
    "start": "1166080",
    "end": "1170039"
  },
  {
    "text": "distance, and it's going to\nlook at a uniform distribution",
    "start": "1170040",
    "end": "1174720"
  },
  {
    "text": "over basically a box.",
    "start": "1174720",
    "end": "1178980"
  },
  {
    "text": "So if I hit Control+Enter here,\nwe can see the observations.",
    "start": "1178980",
    "end": "1184440"
  },
  {
    "text": "They're very noisy,\nand we're trying",
    "start": "1184440",
    "end": "1187259"
  },
  {
    "text": "to guess where the object is.",
    "start": "1187260",
    "end": "1188520"
  },
  {
    "text": "So I don't know where\n[AUDIO OUT] somewhere.",
    "start": "1188520",
    "end": "1192350"
  },
  {
    "text": "So what we're going\nto do is we're going",
    "start": "1192350",
    "end": "1196669"
  },
  {
    "text": "to run particle filtering.",
    "start": "1196670",
    "end": "1199410"
  },
  {
    "text": "Let's say we have\n10,000 particles.",
    "start": "1199410",
    "end": "1204230"
  },
  {
    "text": "We hit Control + Enter again.",
    "start": "1204230",
    "end": "1206340"
  },
  {
    "text": "And now what we're going\nto see is a red blob,",
    "start": "1206340",
    "end": "1211940"
  },
  {
    "text": "and this represents\nwhere the particles are,",
    "start": "1211940",
    "end": "1215059"
  },
  {
    "text": "with the intensity\nof the particle",
    "start": "1215060",
    "end": "1218060"
  },
  {
    "text": "representing the\nnumber of particles",
    "start": "1218060",
    "end": "1220700"
  },
  {
    "text": "at that particular location.",
    "start": "1220700",
    "end": "1224950"
  },
  {
    "text": "So you'll see that this\nis our kind of best guess",
    "start": "1224950",
    "end": "1228269"
  },
  {
    "text": "of where the object is, OK?",
    "start": "1228270",
    "end": "1232700"
  },
  {
    "text": "So you can see how\nwell we're doing",
    "start": "1232700",
    "end": "1234649"
  },
  {
    "text": "by showing the true position.",
    "start": "1234650",
    "end": "1238110"
  },
  {
    "text": "So let's see where this\nobject actually is,",
    "start": "1238110",
    "end": "1240470"
  },
  {
    "text": "and we'll see that we're\ntracking it rather well.",
    "start": "1240470",
    "end": "1245630"
  },
  {
    "text": "Sometimes, I think you'll\nnotice that in my mess",
    "start": "1245630",
    "end": "1248150"
  },
  {
    "text": "up but, on the whole,\nit's pretty good.",
    "start": "1248150",
    "end": "1252380"
  },
  {
    "text": "So also, notice that\nthe red blob where",
    "start": "1252380",
    "end": "1258900"
  },
  {
    "text": "it thinks the object\nis, is not fooled",
    "start": "1258900",
    "end": "1261590"
  },
  {
    "text": "by where the observation is\nbecause there's enough noise",
    "start": "1261590",
    "end": "1264559"
  },
  {
    "text": "here that what I'm modeling--",
    "start": "1264560",
    "end": "1269750"
  },
  {
    "text": "the particle filter\nis doing is that it's",
    "start": "1269750",
    "end": "1272220"
  },
  {
    "text": "essentially kind of\nsmoothing out the noise.",
    "start": "1272220",
    "end": "1276270"
  },
  {
    "text": "The noise is jumping around a\nlot, but it's kind of tracking",
    "start": "1276270",
    "end": "1279620"
  },
  {
    "text": "and knows that the object\ncan't be teleporting,",
    "start": "1279620",
    "end": "1282230"
  },
  {
    "text": "and it's moving only by one\nstep at most each time step.",
    "start": "1282230",
    "end": "1289500"
  },
  {
    "text": "So you can play with\nthis demo a bit more.",
    "start": "1289500",
    "end": "1293710"
  },
  {
    "text": "We also have implemented,\ninstead of this box noise,",
    "start": "1293710",
    "end": "1297539"
  },
  {
    "text": "you have Gaussian\nnoise, which looks kind",
    "start": "1297540",
    "end": "1300450"
  },
  {
    "text": "of similar of a spherical blob.",
    "start": "1300450",
    "end": "1304260"
  },
  {
    "text": "You can also play with this kind\nof really weird-looking noise",
    "start": "1304260",
    "end": "1308190"
  },
  {
    "text": "which places uniform\ndistributions",
    "start": "1308190",
    "end": "1310860"
  },
  {
    "text": "over all positions\non this lattice that",
    "start": "1310860",
    "end": "1314610"
  },
  {
    "text": "have a certain kind of parity.",
    "start": "1314610",
    "end": "1317955"
  },
  {
    "start": "1317955",
    "end": "1321929"
  },
  {
    "start": "1321000",
    "end": "1442000"
  },
  {
    "text": "OK, so in summary, we've\npresented the particle",
    "start": "1321930",
    "end": "1324810"
  },
  {
    "text": "filtering algorithm,\nwhich allows",
    "start": "1324810",
    "end": "1326760"
  },
  {
    "text": "us to answer filtering\nquestions of the following,",
    "start": "1326760",
    "end": "1332230"
  },
  {
    "text": "where is this object at a\nparticular time step, given",
    "start": "1332230",
    "end": "1335830"
  },
  {
    "text": "the evidence so far?",
    "start": "1335830",
    "end": "1338399"
  },
  {
    "text": "And the key idea\nis using particles",
    "start": "1338400",
    "end": "1340800"
  },
  {
    "text": "to represent this\napproximate distribution.",
    "start": "1340800",
    "end": "1346340"
  },
  {
    "text": "So remember, particle\nfiltering has",
    "start": "1346340",
    "end": "1350080"
  },
  {
    "text": "three steps, which is used to\nadvance the set of particles.",
    "start": "1350080",
    "end": "1356200"
  },
  {
    "text": "First, we propose where we take\na particle and transition them",
    "start": "1356200",
    "end": "1362080"
  },
  {
    "text": "to the next time step.",
    "start": "1362080",
    "end": "1365880"
  },
  {
    "text": "This is a guess of where\nthe object is going",
    "start": "1365880",
    "end": "1367860"
  },
  {
    "text": "to be at the next time step.",
    "start": "1367860",
    "end": "1369750"
  },
  {
    "text": "Then we're going to\nfact-check our guess",
    "start": "1369750",
    "end": "1374010"
  },
  {
    "text": "by reweighting the\nparticles based",
    "start": "1374010",
    "end": "1376380"
  },
  {
    "text": "on the emission distribution\nof what we actually saw.",
    "start": "1376380",
    "end": "1382050"
  },
  {
    "text": "And then we're going to\nreallocate our resources",
    "start": "1382050",
    "end": "1384720"
  },
  {
    "text": "by resampling.",
    "start": "1384720",
    "end": "1385950"
  },
  {
    "text": "And this will allow the\nparticles to occupy the regions",
    "start": "1385950",
    "end": "1390960"
  },
  {
    "text": "with higher weight.",
    "start": "1390960",
    "end": "1394390"
  },
  {
    "text": "So unlike forward-backward\nalgorithm,",
    "start": "1394390",
    "end": "1396810"
  },
  {
    "text": "particle filtering\nallows us to scale up",
    "start": "1396810",
    "end": "1399120"
  },
  {
    "text": "to cases where there are a\nlarge number of locations.",
    "start": "1399120",
    "end": "1403100"
  },
  {
    "text": "And also, unlike\na beam search, it",
    "start": "1403100",
    "end": "1406730"
  },
  {
    "text": "allows us to maintain better\nparticle diversity, especially",
    "start": "1406730",
    "end": "1411260"
  },
  {
    "text": "in situations where\nthe distribution is",
    "start": "1411260",
    "end": "1413810"
  },
  {
    "text": "close to uniform.",
    "start": "1413810",
    "end": "1416970"
  },
  {
    "text": "So now particle filtering is\nalso called a sequential Monte",
    "start": "1416970",
    "end": "1420284"
  },
  {
    "text": "Carlo, and there's many, many\nmore sophisticated extensions",
    "start": "1420285",
    "end": "1424560"
  },
  {
    "text": "that I haven't covered.",
    "start": "1424560",
    "end": "1426155"
  },
  {
    "text": "In particular,\nparticle filtering",
    "start": "1426155",
    "end": "1427530"
  },
  {
    "text": "works for general factor graphs,\nnot just hidden Markov models.",
    "start": "1427530",
    "end": "1431070"
  },
  {
    "text": "And I encourage you to read\nup and learn more about it.",
    "start": "1431070",
    "end": "1435610"
  },
  {
    "text": "That's all.",
    "start": "1435610",
    "end": "1437370"
  },
  {
    "start": "1437370",
    "end": "1442000"
  }
]