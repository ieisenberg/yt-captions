[
  {
    "start": "0",
    "end": "5390"
  },
  {
    "text": "So today we have a guest\nlecture I'm super excited about. We have Professor Somil Bansal\nwho's in the AA department here.",
    "start": "5390",
    "end": "14700"
  },
  {
    "text": "He leads the Safe and\nIntelligent Autonomy Lab, and before that he was\nan assistant professor in electrical and computer\nengineering at USC.",
    "start": "14700",
    "end": "22550"
  },
  {
    "text": "And before that he was a\nresearch scientist at Waymo. So super excited to\nhear your lecture.",
    "start": "22550",
    "end": "27860"
  },
  {
    "text": "Thank you. Hello, everyone. I'm Somil. First of all, thank you so much,\nMichael and Sydney for offering",
    "start": "27860",
    "end": "33650"
  },
  {
    "text": "this wonderful course. Several of my students\nare taking this course and they absolutely\nrave about this.",
    "start": "33650",
    "end": "40050"
  },
  {
    "text": "So in my spring\nbreak, I'm planning on catching up on the lecture\nvideos, which I have access to.",
    "start": "40050",
    "end": "47629"
  },
  {
    "text": "And so I'm very excited to be\nhere and talking about some of the work our group has\nbeen doing on mining failures",
    "start": "47630",
    "end": "55363"
  },
  {
    "text": "in vision-based\ncontrollers, which I think is quite related to\nsome of the topics covered in this class.",
    "start": "55363",
    "end": "62120"
  },
  {
    "text": "So at a high level, our group\nfocuses on robotics and autonomy",
    "start": "62120",
    "end": "68360"
  },
  {
    "text": "with the general goal being\ndeveloping robot algorithms that operate with guaranteed\nsafety and performance",
    "start": "68360",
    "end": "73850"
  },
  {
    "text": "in new and uncertain\nenvironments. And we focus on developing\nthese algorithms",
    "start": "73850",
    "end": "79009"
  },
  {
    "text": "in the context of a variety\nof different applications, ranging from autonomous drones,\nautonomous cars, aircrafts,",
    "start": "79010",
    "end": "86100"
  },
  {
    "text": "and space robotics. And a lot of these\nsystems, machine learning",
    "start": "86100",
    "end": "93049"
  },
  {
    "text": "is becoming increasingly\npervasive in their autonomy stacks. The predominant one still\nremains perception and vision.",
    "start": "93050",
    "end": "100410"
  },
  {
    "text": "But now also in prediction and\nbehavior forecasting and then planning and control as well.",
    "start": "100410",
    "end": "107120"
  },
  {
    "text": "And for a number\nof good reasons, machine learning is\nreally good at capturing the complexity of real world\nsituations these systems must",
    "start": "107120",
    "end": "114830"
  },
  {
    "text": "operate in, which\ncould otherwise be very hard to model using\nengineering domain knowledge.",
    "start": "114830",
    "end": "121750"
  },
  {
    "text": "But not without some pitfalls. So incorporating\nmachine learning",
    "start": "121750",
    "end": "127240"
  },
  {
    "text": "has also opened up a set\nof new safety challenges. And the one very\nclose to my heart",
    "start": "127240",
    "end": "134980"
  },
  {
    "text": "is this rollback of cruise cars\nfrom the San Francisco City. And since then, actually they\nhave terminated their operations",
    "start": "134980",
    "end": "141670"
  },
  {
    "text": "altogether in\nautonomous driving. And the issues were severe\nenough that the US government",
    "start": "141670",
    "end": "149739"
  },
  {
    "text": "now almost 1 and 1/2 years\nback, but also a couple of other governments, notably\nUK government,",
    "start": "149740",
    "end": "155599"
  },
  {
    "text": "passed this executive order\nto prioritize discussion on AI safety, both for autonomy\nbut AI more broadly.",
    "start": "155600",
    "end": "163330"
  },
  {
    "text": "And so coming back\nto autonomy, there is this tension that we have a\nlot in autonomous systems today,",
    "start": "163330",
    "end": "169970"
  },
  {
    "text": "which is how can we leverage\nthe capabilities offered by modern machine\nlearning methods while also maintaining safety?",
    "start": "169970",
    "end": "176390"
  },
  {
    "text": "And so that really is the core\nfocus of our lab these days. ",
    "start": "176390",
    "end": "182890"
  },
  {
    "text": "And our approach to\novercoming this challenge is to think of safety\nof AI-based systems",
    "start": "182890",
    "end": "190480"
  },
  {
    "text": "more as a continuous\nprocess where safety is integrated in different\nstages of this data",
    "start": "190480",
    "end": "196209"
  },
  {
    "text": "cycle or the system cycle,\nstarting from the training time to the deployment of the systems\nand iteratively improving",
    "start": "196210",
    "end": "202840"
  },
  {
    "text": "the safety over the\nsystem's life cycle. And so that's a mouthful. What that means really\nis we think of safety",
    "start": "202840",
    "end": "211209"
  },
  {
    "text": "in three different stages. We start from the training\ntime, and we ask ourselves, how can we programmatically\nincorporate safety requirements",
    "start": "211210",
    "end": "219849"
  },
  {
    "text": "in the training phase itself so\nthat we get policies or safety aware AI systems as a result?",
    "start": "219850",
    "end": "227980"
  },
  {
    "text": "And so one way to\nthink about this is we are asking\nquestions of how to ensure safety within the\ntraining data distribution.",
    "start": "227980",
    "end": "236069"
  },
  {
    "text": "But that is not\nsufficient when we deploy these systems in new\nand uncertain conditions.",
    "start": "236070",
    "end": "241120"
  },
  {
    "text": "So we have to ask\nourselves, when are we going out of\ndistribution and how can we adapt our safety corresponding\nto these out-of-distribution",
    "start": "241120",
    "end": "248370"
  },
  {
    "text": "scenarios? And finally, we focus\non developing methods",
    "start": "248370",
    "end": "254160"
  },
  {
    "text": "that allow for stress\ntesting of these systems to mine their safety\ncritical failures and use them to improve\nthe design of the system.",
    "start": "254160",
    "end": "262120"
  },
  {
    "text": "So thereby closing this loop. And so together, this framework\nallows for a continual safety",
    "start": "262120",
    "end": "268949"
  },
  {
    "text": "assurances for\nlearning-based systems, where safety is\nprovided provisionally during the training time.",
    "start": "268950",
    "end": "275110"
  },
  {
    "text": "They are adapted during\nthe operation time, and they are improved over\nthe system's life cycle.",
    "start": "275110",
    "end": "280140"
  },
  {
    "text": "But for the remaining\ntime that I have today, I want to focus on\nthis last component,",
    "start": "280140",
    "end": "285300"
  },
  {
    "text": "and in particular, the\nstress testing component, which is how can we stress test\nthe learning-based controller",
    "start": "285300",
    "end": "292470"
  },
  {
    "text": "to minor safety\ncritical failures? And then I will talk\nabout how can we use those failures to\nimprove the system itself.",
    "start": "292470",
    "end": "299014"
  },
  {
    "text": " And we have been\nparticularly asking",
    "start": "299015",
    "end": "304680"
  },
  {
    "text": "this question in the context of\nvision-based controllers for two reasons.",
    "start": "304680",
    "end": "309789"
  },
  {
    "text": "One, vision-based controllers\nare becoming quite ubiquitous now in the autonomy stacks. But also traditionally, stress\ntesting these controllers",
    "start": "309790",
    "end": "317250"
  },
  {
    "text": "have been very challenging for\ncontrol theoretic tools because of the high dimensionality\nof vision-based controllers",
    "start": "317250",
    "end": "322650"
  },
  {
    "text": "and also their complicated\ninput spaces like RGB images. So let's talk about how can\nwe stress test these systems.",
    "start": "322650",
    "end": "331090"
  },
  {
    "text": "So these vision-based\ncontrollers. So let me first formulate\nthe problem mathematically.",
    "start": "331090",
    "end": "336460"
  },
  {
    "text": "So we are given a\nsystem which has-- so this could be a robot which\nhas some dynamics with state",
    "start": "336460",
    "end": "342630"
  },
  {
    "text": "x and control u. Now at each state we have a\nvisual sensor that gives me",
    "start": "342630",
    "end": "349680"
  },
  {
    "text": "some visual observations. So this could be RGB\nimages or point clouds, which are then taken as input\nby the vision-based controller,",
    "start": "349680",
    "end": "356639"
  },
  {
    "text": "and that gives me the control\nto be applied on the robot. So this forms a\nclosed loop system.",
    "start": "356640",
    "end": "362010"
  },
  {
    "text": "And we also assume\naccess to a simulator that we can use for stress\ntesting this controller.",
    "start": "362010",
    "end": "367729"
  },
  {
    "text": "And so our goal here is to find\nthese safety critical failures. In other words, find\nthe visual inputs eye",
    "start": "367730",
    "end": "374900"
  },
  {
    "text": "that leads to the\nsafety of the overall or that leads to the violation\nof safety of the overall system. ",
    "start": "374900",
    "end": "383870"
  },
  {
    "text": "And really, the\napproach we take here is to cast this\nfailure discovery",
    "start": "383870",
    "end": "388910"
  },
  {
    "text": "as a reachability problem. And so the way to do that is\nessentially we can concatenate",
    "start": "388910",
    "end": "395840"
  },
  {
    "text": "the visual observation\nfunction along with the vision-based\ncontroller to obtain",
    "start": "395840",
    "end": "401690"
  },
  {
    "text": "an equivalent state-based\npolicy for the robot. And so I can simplify for\nthe stress testing purposes",
    "start": "401690",
    "end": "409340"
  },
  {
    "text": "my closed-loop\nsystem as the robot in closed-loop with this\nequivalent state-based policy.",
    "start": "409340",
    "end": "414505"
  },
  {
    "text": " And on this particular\nclosed-loop system,",
    "start": "414505",
    "end": "420600"
  },
  {
    "text": "we can use a lot of existing\nreachability-based methods that, at the end of the day,\ncompute what we call backward",
    "start": "420600",
    "end": "427849"
  },
  {
    "text": "reachability or some version of\nbackward reachable tube, which at least in English, means\nthe set of all initial states",
    "start": "427850",
    "end": "435259"
  },
  {
    "text": "of the system, which\nwill eventually steer the system into\nsome predefined failure region under this controller.",
    "start": "435260",
    "end": "442200"
  },
  {
    "text": "In our case, this controller g. So what I want to do is I\nwant to talk a little bit",
    "start": "442200",
    "end": "449060"
  },
  {
    "text": "about what this backward\nreachable tube is and how can we compute this\nbackward reachable tube. And then I'm going to\ncome back to this problem",
    "start": "449060",
    "end": "455450"
  },
  {
    "text": "and talk about how that\nbackward reachable tube could be useful to find the\nsafety critical failures",
    "start": "455450",
    "end": "460460"
  },
  {
    "text": "that I'm after. So let me give a\nfive-minute primer",
    "start": "460460",
    "end": "465590"
  },
  {
    "text": "of Hamilton-Jacobi\nreachability, which is one of the\nreachability methods to compute this\nbackward reachable tube.",
    "start": "465590",
    "end": "472570"
  },
  {
    "text": "So in reachability\nanalysis, we start with the dynamics of\nthe underlying system,",
    "start": "472570",
    "end": "477740"
  },
  {
    "text": "which we assume has some state\nx, control u, and disturbance d. Disturbance here could represent\nthe modeling uncertainty",
    "start": "477740",
    "end": "485320"
  },
  {
    "text": "in the system. So for example, we might not\nhave fully modeled the system. Or it could be some\nexternal disturbances",
    "start": "485320",
    "end": "491980"
  },
  {
    "text": "that we may want to\nsafeguard against. Now given these\ndynamics once again, the key thing we are\ninterested in is the backward",
    "start": "491980",
    "end": "498910"
  },
  {
    "text": "reachable tube of\nthe system, which is the set of all initial states\nfrom which it will be ultimately",
    "start": "498910",
    "end": "504310"
  },
  {
    "text": "driven to an undesirable\nset of states, sometimes also referred to as\nfailure set despite the best",
    "start": "504310",
    "end": "509710"
  },
  {
    "text": "control effort. Pictorially, what\nthat means is, let's",
    "start": "509710",
    "end": "514780"
  },
  {
    "text": "consider a very simple example. Imagine there is a quadrotor\nflying longitudinally in this room.",
    "start": "514780",
    "end": "519799"
  },
  {
    "text": "So in this particular\ncase, ceiling and floor might be that failure set that\nwe don't want the quadrotor",
    "start": "519799",
    "end": "525850"
  },
  {
    "text": "to crash into. And this light red\nregion over here",
    "start": "525850",
    "end": "531040"
  },
  {
    "text": "is the backward\nreachable tube, meaning that if the quadrotor\nstarts inside this set,",
    "start": "531040",
    "end": "537470"
  },
  {
    "text": "then no matter what it does,\nit will eventually crash into the ceiling or the floor. Or in other words,\nit will eventually",
    "start": "537470",
    "end": "543422"
  },
  {
    "text": "enter the failure set. The converse of this\nbackward reachable tube",
    "start": "543422",
    "end": "549430"
  },
  {
    "text": "is this blue region\nor this safe set and reachability analysis\nprovides the guarantee",
    "start": "549430",
    "end": "556930"
  },
  {
    "text": "that if the system\nstarts inside this set, then there exists\na policy to keep it inside the set at all times.",
    "start": "556930",
    "end": "562850"
  },
  {
    "text": "In other words, this blue\nset is control invariant set. And the way we compute this blue\nset and the corresponding safety",
    "start": "562850",
    "end": "572020"
  },
  {
    "text": "controller is by converting\nthis whole safety problem into an optimal\ncontrol problem, which",
    "start": "572020",
    "end": "577972"
  },
  {
    "text": "can then be solved using a\nvariety of optimal control methods. And the first step to do so\nis to implicitly represent",
    "start": "577972",
    "end": "585840"
  },
  {
    "text": "our failure set such that this\nfunction, which we are using",
    "start": "585840",
    "end": "591090"
  },
  {
    "text": "to implicitly represent\nthe failure set, is negative inside the failure\nset and positive outside.",
    "start": "591090",
    "end": "596290"
  },
  {
    "text": "So in this particular\ncase, it should be negative inside the\nceiling and the floor and positive everywhere else.",
    "start": "596290",
    "end": "602550"
  },
  {
    "text": "And the intuitive way to\nthink about this function L is the safety reward the\nsystem gets at state x.",
    "start": "602550",
    "end": "609100"
  },
  {
    "text": "So if you are inside the failure\nset, you get a negative reward. And if you are outside\nthe failure set, you get a positive reward.",
    "start": "609100",
    "end": "616860"
  },
  {
    "text": "And there are many such\nreward functions one can use. In fact, any reward\nfunction that satisfies this property is good\nenough, so we only",
    "start": "616860",
    "end": "623700"
  },
  {
    "text": "care about the sign of it. And a popular reward function\nis the signed distance function to the failure region.",
    "start": "623700",
    "end": "629780"
  },
  {
    "text": " Now, given that reward function,\nthe cumulative reward or cost",
    "start": "629780",
    "end": "638310"
  },
  {
    "text": "of a trajectory is given by the\nminimum safety reward incurred along the trajectory.",
    "start": "638310",
    "end": "643959"
  },
  {
    "text": "So the reason to define\nsuch a reward function is that if the trajectory\never enters the failure",
    "start": "643960",
    "end": "650670"
  },
  {
    "text": "set, this reward,\nthis cumulative reward will be negative. Otherwise, this cumulative\nreward will be positive.",
    "start": "650670",
    "end": "656439"
  },
  {
    "text": "So by just looking at the sign\nof this cumulative reward, I'm able to tell whether\nthe robot trajectory",
    "start": "656440",
    "end": "661530"
  },
  {
    "text": "has been safe or unsafe.  Now, of course, I\ncan pick my control",
    "start": "661530",
    "end": "669120"
  },
  {
    "text": "so as to maximize this reward. In other words, to\nkeep the system safe. So what we are after\nis really this game",
    "start": "669120",
    "end": "677340"
  },
  {
    "text": "where the disturbance\nor the uncertainty is attempting to force me\ninside the failure region.",
    "start": "677340",
    "end": "683020"
  },
  {
    "text": "In other words, it tries to\nminimize this cumulative safety reward, and the control\nis trying to keep me safe.",
    "start": "683020",
    "end": "689680"
  },
  {
    "text": "In other words, it tries to\nmaximize this cumulative reward. ",
    "start": "689680",
    "end": "696029"
  },
  {
    "text": "In other words, we are\ninterested in the value function corresponding to this\ncumulative reward function.",
    "start": "696030",
    "end": "702149"
  },
  {
    "text": "And value function here\nintuitively represents the closest the system will\never get to the failure set.",
    "start": "702150",
    "end": "709240"
  },
  {
    "text": "So the value\nfunction is negative. That means despite my\nbest control effort,",
    "start": "709240",
    "end": "715120"
  },
  {
    "text": "my trajectory must have\nentered into the failure region at some point, and hence the\nstates where the value function",
    "start": "715120",
    "end": "721200"
  },
  {
    "text": "is negative are the unsafe\nstates for the system, and the converse\nis the case when the value function is positive.",
    "start": "721200",
    "end": "727060"
  },
  {
    "text": "That means the trajectory\nof the robot remained outside the failure region. And so this optimal\ncontrol problem,",
    "start": "727060",
    "end": "735790"
  },
  {
    "text": "once we solve this and\nobtain the value function, it gives us a simple\ncharacterization of the unsafe set or the\nbackward reachable tube,",
    "start": "735790",
    "end": "742180"
  },
  {
    "text": "which is the backward reachable\ntube is same as the states where the value\nfunction is negative.",
    "start": "742180",
    "end": "747190"
  },
  {
    "text": " Now, to obtain the\nvalue function,",
    "start": "747190",
    "end": "753208"
  },
  {
    "text": "we can use a variety of\ndifferent optimal control methods ranging from\nMPC, dynamic programming.",
    "start": "753208",
    "end": "759150"
  },
  {
    "text": "The one that's quite popular\nfor assurance reasons is the dynamic programming\nbecause it provides the globally optimal solution\nto this value function,",
    "start": "759150",
    "end": "766020"
  },
  {
    "text": "and that results into a Bellman\nbackup or a Bellman iteration, just like value iteration.",
    "start": "766020",
    "end": "771030"
  },
  {
    "text": "But when you're operating in\ncontinuous state and time, that Bellman backup is given by\na partial differential equation.",
    "start": "771030",
    "end": "777840"
  },
  {
    "text": "It's just a continuous time\nversion of the Bellman equation.",
    "start": "777840",
    "end": "783290"
  },
  {
    "text": "But it does exactly what\nBellman equation does. It tries to measure the\nchange in the value function",
    "start": "783290",
    "end": "788810"
  },
  {
    "text": "upon taking a\nparticular action u. And if we solve this partial\ndifferential equation,",
    "start": "788810",
    "end": "796700"
  },
  {
    "text": "we get the value function. Here I'm showing the value\nfunction for that quadrotor example.",
    "start": "796700",
    "end": "802310"
  },
  {
    "text": "So the red meaning or the darker\nred meaning the value function is more negative. The darker blue means the value\nfunction is more positive.",
    "start": "802310",
    "end": "809970"
  },
  {
    "text": "So in this particular case,\nintuitively, the value function is maximum in the middle of\nthe room, which makes sense",
    "start": "809970",
    "end": "818570"
  },
  {
    "text": "because I'm further from\nthe ceiling or the floor and farthest from\nthe failure region.",
    "start": "818570",
    "end": "823980"
  },
  {
    "text": "Whereas if I go towards\nthe failure region, it starts becoming red. ",
    "start": "823980",
    "end": "832580"
  },
  {
    "text": "Now one quick question is the\nvalue function is more red here,",
    "start": "832580",
    "end": "839100"
  },
  {
    "text": "but not so much on the top. Even though the failure set\nis symmetric, its ceiling and the floor.",
    "start": "839100",
    "end": "845300"
  },
  {
    "text": "Why do you think this disparity\nin the value function? ",
    "start": "845300",
    "end": "852860"
  },
  {
    "text": "The control part is it\ntakes more control authority near the bottom to save\nthe drone from crashing",
    "start": "852860",
    "end": "858709"
  },
  {
    "text": "than it does near the top. And why is that? I guess it probably has to do\nwith the dynamics of the drone.",
    "start": "858710",
    "end": "865160"
  },
  {
    "text": "Yes, that's exactly right. It's because of gravity. Because of the gravity,\nby default, the robot",
    "start": "865160",
    "end": "872390"
  },
  {
    "text": "is being pushed\ntowards the downside. So with the same control\neffort, I have to develop,",
    "start": "872390",
    "end": "879137"
  },
  {
    "text": "which is going to be more\nnegative towards the bottom as compared to the top. So again, in this particular\ncase, this is a simple example.",
    "start": "879137",
    "end": "888035"
  },
  {
    "text": "We don't really need to go\nthrough the trouble of solving this partial differential\nequation to come up with the unsafe set.",
    "start": "888035",
    "end": "893810"
  },
  {
    "text": "But the point of this example is\nA, this method is quite general, and B, it captures these\neffects in the dynamics that",
    "start": "893810",
    "end": "901210"
  },
  {
    "text": "could be otherwise very hard\nto reason about automatically in the value\nfunction computation.",
    "start": "901210",
    "end": "908200"
  },
  {
    "text": "Now, along with\nthis value function, which tells me about\nthe safety, it also",
    "start": "908200",
    "end": "916270"
  },
  {
    "text": "gives me a safety controller. So keep me within\nthis blue region.",
    "start": "916270",
    "end": "921280"
  },
  {
    "text": "And intuitively, what\nthis equation is saying is that at any state\nx, this controller",
    "start": "921280",
    "end": "926350"
  },
  {
    "text": "is trying to do gradient\nascent in the value function. In other words, it's\ntrying to push me towards more and more positive\nvalues of the value function",
    "start": "926350",
    "end": "933730"
  },
  {
    "text": "because the higher values\nor higher positive values means I'm more safe.",
    "start": "933730",
    "end": "940300"
  },
  {
    "text": "OK, before I continue,\na shameless plug.",
    "start": "940300",
    "end": "946269"
  },
  {
    "text": "I'm offering a\ncourse where I cover all of this in much more\ndetail in the spring quarter.",
    "start": "946270",
    "end": "952730"
  },
  {
    "text": "So where we will\ndiscuss different ways to compute backward\nreachable tube and safe sets",
    "start": "952730",
    "end": "958060"
  },
  {
    "text": "using techniques like\nartificial potential fields, control barrier functions, and\nHamilton-Jacobi reachability",
    "start": "958060",
    "end": "963460"
  },
  {
    "text": "that I just presented. It's a graduate level\ncourse with the focus more on the course project and\na couple of homeworks.",
    "start": "963460",
    "end": "974320"
  },
  {
    "text": "OK, let's go back\nto the core problem at hand, which is\nhow can we mine",
    "start": "974320",
    "end": "980440"
  },
  {
    "text": "the safety critical failures\nof vision-based controllers? And just to recap, I was saying\nthat we can combine the robot",
    "start": "980440",
    "end": "987310"
  },
  {
    "text": "observation function\nalong with the controller to obtain an equivalent\nstate-based policy",
    "start": "987310",
    "end": "992820"
  },
  {
    "text": "for the robot. So my closed-loop system can\nbe simplified as follows.",
    "start": "992820",
    "end": "999870"
  },
  {
    "text": "And then for this system,\nI can compute the backward reachable tube, which is the\nset of all states from which",
    "start": "999870",
    "end": "1006380"
  },
  {
    "text": "the system will eventually\nsteer into the failure region despite the best control\neffort, which now we",
    "start": "1006380",
    "end": "1012217"
  },
  {
    "text": "know is equivalent to solving\nthis partial differential equation that we saw earlier. Except that here I'm not\nlooking for best control action.",
    "start": "1012218",
    "end": "1019980"
  },
  {
    "text": "I'm already given a controller,\nthis learning-based controller over here. So I can just do\nsmall substitution,",
    "start": "1019980",
    "end": "1026959"
  },
  {
    "text": "which is the set of states which\nwould fail under this controller g of x, which is same as, rather\nthan optimizing the controller,",
    "start": "1026960",
    "end": "1035339"
  },
  {
    "text": "we will just plug-in\na specific controller. So we still need to solve a\npartial differential equation, but a simplified one.",
    "start": "1035339",
    "end": "1042140"
  },
  {
    "text": "And if we do that, then we can\nget the backward reachable tube. And here is one example.",
    "start": "1042140",
    "end": "1047490"
  },
  {
    "text": "I will go through this case\nstudy in much more detail. But once we can compute this\nbackward reachable tube,",
    "start": "1047490",
    "end": "1052710"
  },
  {
    "text": "we might get this region, for\nexample, this red region, which indicates the set of all\ninitial states that's",
    "start": "1052710",
    "end": "1058460"
  },
  {
    "text": "going to eventually fail. So we can look at\nthe images seen by the robot along these states\nand get the failure images.",
    "start": "1058460",
    "end": "1066890"
  },
  {
    "text": "So that will be the strategy. So we start with a\nvision-based controller. Convert it into a state-based\nreachability problem.",
    "start": "1066890",
    "end": "1072630"
  },
  {
    "text": "We solve that\nreachability problem, and then go back to the\nvision or the RGB image space",
    "start": "1072630",
    "end": "1078230"
  },
  {
    "text": "by looking at those\nfailure states. Any question on this strategy\nbefore I move forward?",
    "start": "1078230",
    "end": "1085465"
  },
  {
    "text": " Does this [INAUDIBLE]\nlike one state",
    "start": "1085465",
    "end": "1091790"
  },
  {
    "text": "is mapped to multiple\ndifferent images? That's a very good point. So the images are a\nfunction, of course,",
    "start": "1091790",
    "end": "1099150"
  },
  {
    "text": "the state but other\nenvironment parameters. So for example, the same\nimage would be different if you are in the daytime\nor in the nighttime.",
    "start": "1099150",
    "end": "1105677"
  },
  {
    "text": "So I will-- to some extent\nwe can account for it. But environment variations are\nstill very hard to handle here,",
    "start": "1105677",
    "end": "1112211"
  },
  {
    "text": "and that's one of the things\nI want to discuss later. ",
    "start": "1112212",
    "end": "1119650"
  },
  {
    "text": "OK, I'm going to skip\na couple of slides. ",
    "start": "1119650",
    "end": "1126040"
  },
  {
    "text": "So let's apply this framework\nin the context of an autonomous",
    "start": "1126040",
    "end": "1132070"
  },
  {
    "text": "aircraft taxiing problem. So here, this aircraft is\nusing a vision-based controller",
    "start": "1132070",
    "end": "1137530"
  },
  {
    "text": "that uses the camera images from\nthe right wing of the aircraft to keep this aircraft\non this runway or taxi",
    "start": "1137530",
    "end": "1143470"
  },
  {
    "text": "the aircraft on the runway. But in the process\nof doing so, we don't want this\naircraft to steer off the runway, which in this case\nrepresents the failure set over",
    "start": "1143470",
    "end": "1152260"
  },
  {
    "text": "here. Now, using the method described\nthat we just discussed,",
    "start": "1152260",
    "end": "1157820"
  },
  {
    "text": "we computed the backward\nreachable tube of the system. And so the red region\nhere represents the set",
    "start": "1157820",
    "end": "1163540"
  },
  {
    "text": "of all initial conditions of\nthe aircraft from which it will be driven off the runway\nunder this vision-based",
    "start": "1163540",
    "end": "1171130"
  },
  {
    "text": "controller. Similarly, the blue\nregion represents the set of all initial states of the\naircraft from which it will",
    "start": "1171130",
    "end": "1177280"
  },
  {
    "text": "remain on the\nrunway at all times under this vision-based\ncontroller.",
    "start": "1177280",
    "end": "1183519"
  },
  {
    "text": "And here are some\nof the images robot sees along this failure region.",
    "start": "1183520",
    "end": "1189440"
  },
  {
    "text": "So these are essentially\nour set of failure images that I was after earlier.",
    "start": "1189440",
    "end": "1195430"
  },
  {
    "text": "Now let's take one of\nthese failure images and let's see what's going on. So this is just a bigger\nview of the same image.",
    "start": "1195430",
    "end": "1204110"
  },
  {
    "text": "So this is the first person\nview, which the controller sees to make the decision. And the top view here\nis just for reference.",
    "start": "1204110",
    "end": "1211390"
  },
  {
    "text": "And based on our analysis, we\nexpect that from this condition",
    "start": "1211390",
    "end": "1217150"
  },
  {
    "text": "the aircraft will steer off the\nrunway as it is happening here. But what was interesting\nis why the aircraft",
    "start": "1217150",
    "end": "1225190"
  },
  {
    "text": "failing in this\nparticular initial state. And upon the analysis,\nwe figured out",
    "start": "1225190",
    "end": "1230940"
  },
  {
    "text": "it is because of these\nmarkings on the runway. The CNN here was confusing\nthese runway markings",
    "start": "1230940",
    "end": "1239220"
  },
  {
    "text": "with the center\nline of the runway, and it was steering the\naircraft towards it.",
    "start": "1239220",
    "end": "1244288"
  },
  {
    "text": "But by the time it's\nrealizing that it's actually not the runway center line,\nit is already too late",
    "start": "1244288",
    "end": "1249299"
  },
  {
    "text": "and the system steers\noff the runway. So by doing this\nreachability analysis,",
    "start": "1249300",
    "end": "1255280"
  },
  {
    "text": "we can find such\nsemantic failures of this vision-based\ncontrollers. Now, what I want to highlight,\nwhich is very important,",
    "start": "1255280",
    "end": "1263260"
  },
  {
    "text": "is that these are not\njust any vision failures. These are the vision\nfailures that then lead",
    "start": "1263260",
    "end": "1270240"
  },
  {
    "text": "to the system failure as well. So to highlight that\ndifference here on the left,",
    "start": "1270240",
    "end": "1275932"
  },
  {
    "text": "I have the backward\nreachable tube, which is an indicator\nof the system failure. So the red mean system fails\nand the blue means it does not.",
    "start": "1275932",
    "end": "1282690"
  },
  {
    "text": "On the right here is I'm\nloading the prediction error of this\nvision-based controller.",
    "start": "1282690",
    "end": "1288180"
  },
  {
    "text": "So the red means a high\nprediction error and the blue means a low prediction error. Now what's interesting is that\nthere is a whole bunch of states",
    "start": "1288180",
    "end": "1295860"
  },
  {
    "text": "where the prediction error is\nreally high, like on the top there, but that has absolutely\nno effect on the system safety.",
    "start": "1295860",
    "end": "1302920"
  },
  {
    "text": "So the vision can\nmake a high error, but that's compensated\ndownstream by my planner, and hence that does not\nlead to the system failure.",
    "start": "1302920",
    "end": "1310510"
  },
  {
    "text": "On the other hand,\nthere are some states where the prediction\nerror is really low, but that is sufficient to\ntrigger the system failure.",
    "start": "1310510",
    "end": "1319950"
  },
  {
    "text": "And so what this is indicating\nis that not all perception errors are equal. Some of these learning\nerrors can matter much more",
    "start": "1319950",
    "end": "1327540"
  },
  {
    "text": "for system level safety. And here when we are developing\nthis BIT-based framework,",
    "start": "1327540",
    "end": "1333610"
  },
  {
    "text": "we are targeting those failures\nof the vision component. Then that lead to\nsystem level failure.",
    "start": "1333610",
    "end": "1339502"
  },
  {
    "text": "So it's going to be very\ndifferent than if you would do a component level analysis of\nthe same vision-based control.",
    "start": "1339503",
    "end": "1346890"
  },
  {
    "text": "So with this\nreachability analysis, we find the set of initial\nstates that lead to failure.",
    "start": "1346890",
    "end": "1353220"
  },
  {
    "text": "There are images that we\ncapture along the trajectory that we spot over the\ncourse of the trajectory.",
    "start": "1353220",
    "end": "1358570"
  },
  {
    "text": "So do actually have a way to\nknow which of those images, I guess, are more important\nfor why we result in failure?",
    "start": "1358570",
    "end": "1367600"
  },
  {
    "text": "Yeah, that's a good question. And something that I have\nthought a lot about myself too, which is this\nimage I should",
    "start": "1367600",
    "end": "1374520"
  },
  {
    "text": "assign the blame of failure to. And the short answer is that\nI do not have right now a way",
    "start": "1374520",
    "end": "1385019"
  },
  {
    "text": "to assign the failure. Even if you tell me the image,\nwhich is actually corresponding",
    "start": "1385020",
    "end": "1390570"
  },
  {
    "text": "to the failure,\nI don't know what is the visual feature\nin that image that's causing the failure.",
    "start": "1390570",
    "end": "1396340"
  },
  {
    "text": "So that's actually\none of the limitations of this whole pipeline, which is\nit tells me the set of failure",
    "start": "1396340",
    "end": "1402320"
  },
  {
    "text": "images but doesn't\ngive me any underlying reason for that failure. So this analysis that\nwe did, where I said,",
    "start": "1402320",
    "end": "1408000"
  },
  {
    "text": "this is the center line of the\naircraft or this runway marking is what's causing the failure,\nwe had to do a lot of analysis,",
    "start": "1408000",
    "end": "1415522"
  },
  {
    "text": "blocking in different\nparts of the images to figure out what in\nthis image is actually throwing the CNN off.",
    "start": "1415522",
    "end": "1421500"
  },
  {
    "text": "So it's a very hard\nanalysis to do. In fact, even in\nthe state space, that's a very hard\nanalysis to do.",
    "start": "1421500",
    "end": "1428010"
  },
  {
    "text": "So given a failure\nstate, it's hard to tell which part of the state is\nprecisely causing the failure.",
    "start": "1428010",
    "end": "1435080"
  },
  {
    "text": "I think I missed a little bit\nwhat type of vision models we're considering. You mentioned a CNN, but\ncan you have really large,",
    "start": "1435080",
    "end": "1441185"
  },
  {
    "text": "let's say a ResNet or something\nlike that or vision transformer unit? Yes, in fact, the next case\nstudy is going to use a ResNet.",
    "start": "1441185",
    "end": "1448445"
  },
  {
    "text": "To answer your\nquestion in short, here I am treating the\nentire vision-based control as a black box. So it could be anything.",
    "start": "1448445",
    "end": "1453780"
  },
  {
    "text": "It doesn't even have to be\na neural network-based yet. So it's a black box\nanalysis in that sense.",
    "start": "1453780",
    "end": "1458830"
  },
  {
    "text": " So earlier somebody\nasked me what",
    "start": "1458830",
    "end": "1464990"
  },
  {
    "text": "happens across variations\nin the visual variations.",
    "start": "1464990",
    "end": "1470160"
  },
  {
    "text": "So we can also compute this\nbackward reachable tube as a function of different\nenvironmental agents.",
    "start": "1470160",
    "end": "1475200"
  },
  {
    "text": "So for example, here I'm\nshowing the BRT, the same BRT corresponding to different\ntimes of the day here.",
    "start": "1475200",
    "end": "1481100"
  },
  {
    "text": "And what's interesting is that\nA or maybe a little bit less interesting part is\nthat the BRT overall",
    "start": "1481100",
    "end": "1488000"
  },
  {
    "text": "grows when you go from day\nto night, which we expect for a vision-based\ncontroller because visibility",
    "start": "1488000",
    "end": "1493490"
  },
  {
    "text": "is lower in the night. But what's particularly\ninteresting is the state that was\ncausing a failure earlier",
    "start": "1493490",
    "end": "1500899"
  },
  {
    "text": "because of these runway markings\nis actually not a failure state in the night.",
    "start": "1500900",
    "end": "1506250"
  },
  {
    "text": "It's actually in\nthe safe region. It's in the right region. And that was very\ncounterintuitive at first.",
    "start": "1506250",
    "end": "1512580"
  },
  {
    "text": "But then if we think\ndeeply about it, the state was causing a failure\nbecause of this runway marking.",
    "start": "1512580",
    "end": "1519345"
  },
  {
    "text": "And in the night when those\nrunway markings are not as clearly visible, the CNN\nis not thrown away by that.",
    "start": "1519345",
    "end": "1525230"
  },
  {
    "text": "And hence, it remains\nsafe during the night at the same state. ",
    "start": "1525230",
    "end": "1531820"
  },
  {
    "text": "[? Michael, ?] maybe\njust a question on the previous slide, which\nI think is related to this.",
    "start": "1531820",
    "end": "1537490"
  },
  {
    "text": "How did you make the\nplot on the right? So here I'm using the full\nprivileged information",
    "start": "1537490",
    "end": "1544419"
  },
  {
    "text": "about each state. So what I'm doing is I'm\ngoing each state by state. I'm looking at the image\ncorresponding to that state.",
    "start": "1544420",
    "end": "1551860"
  },
  {
    "text": "So you teleport the aircraft\nwith that particular heading angle, and then you measure the\nprediction error by the offset.",
    "start": "1551860",
    "end": "1561560"
  },
  {
    "text": "Exactly. So because I'm in the same\nI have the privileged access to what it should be predicting.",
    "start": "1561560",
    "end": "1567230"
  },
  {
    "text": "And I can see what it\nis actually predicting. And then I'm\ncomputing that error. Got it.",
    "start": "1567230",
    "end": "1573910"
  },
  {
    "text": "But that would be for one\nparticular time of day. Yes, that is for the night.",
    "start": "1573910",
    "end": "1579850"
  },
  {
    "text": "Yeah, OK. ",
    "start": "1579850",
    "end": "1585610"
  },
  {
    "text": "So here we are looking\nat the variations across time of the day. We can do also variations\nacross cloud conditions.",
    "start": "1585610",
    "end": "1592150"
  },
  {
    "text": "So this is what the\nvalue of that state looks like across\ncloud conditions. And by doing this analysis\nacross different environment",
    "start": "1592150",
    "end": "1599710"
  },
  {
    "text": "latents, we can collect\na set of failure images across a bunch of\nenvironment conditions.",
    "start": "1599710",
    "end": "1605946"
  },
  {
    "start": "1605946",
    "end": "1610960"
  },
  {
    "text": "Now, here we are applying\nthe same framework to a different\nvision-based controller. So this is for\nindoor navigation.",
    "start": "1610960",
    "end": "1617680"
  },
  {
    "text": "Here, this robot is using an RGB\nimage from the onboard camera",
    "start": "1617680",
    "end": "1624910"
  },
  {
    "text": "and using a ResNet\narchitecture to convert it to a waypoint to go to,\nwhich is then tracked using",
    "start": "1624910",
    "end": "1631630"
  },
  {
    "text": "a low-level MPC controller. So my entire\nvision-based controller here is going from this\nimage to some control",
    "start": "1631630",
    "end": "1637169"
  },
  {
    "text": "to be applied on the road. But internally, it has a\nbunch of different submodules. ",
    "start": "1637170",
    "end": "1644250"
  },
  {
    "text": "And a little bit\nof context about this vision-based controller. This was trained\nentirely in simulation",
    "start": "1644250",
    "end": "1651840"
  },
  {
    "text": "using photorealistic simulators\nwhere most of the data was actually collected\nin Stanford buildings.",
    "start": "1651840",
    "end": "1659070"
  },
  {
    "text": "And this controller leads\nto a pretty good sim to real transfer. Here is one experiment\nthat was done",
    "start": "1659070",
    "end": "1667140"
  },
  {
    "text": "in Berkeley so clearly was not\nseen during the training data. This is only what the\nrobot has access to.",
    "start": "1667140",
    "end": "1673360"
  },
  {
    "text": "These are just for the context. And it leads to a pretty\ngood sim to real transfer overall, where it's going\nthrough very cluttered hallways",
    "start": "1673360",
    "end": "1681510"
  },
  {
    "text": "based on this\nmonocular RGB image and reaching its\ngoal in the end. ",
    "start": "1681510",
    "end": "1687870"
  },
  {
    "text": "But once again, we use this\nvision-based controller and pass it through our\nstress test pipeline,",
    "start": "1687870",
    "end": "1694480"
  },
  {
    "text": "and we encounter a number\nof interesting failures. I just want to highlight\none that I thought",
    "start": "1694480",
    "end": "1700200"
  },
  {
    "text": "was puzzling me for a long time,\nuntil we did a lot of analysis on it, is that this\nCNN actually learns",
    "start": "1700200",
    "end": "1706740"
  },
  {
    "text": "a correlation between\nlight-colored walls and traversability, or\nlight-colored surfaces and traversability.",
    "start": "1706740",
    "end": "1712620"
  },
  {
    "text": "And the reason for\nthat is this controller was trained entirely in sim. And in sim, all the\ndata that we had",
    "start": "1712620",
    "end": "1720539"
  },
  {
    "text": "had light-colored floors\nand dark-colored walls.",
    "start": "1720540",
    "end": "1725610"
  },
  {
    "text": "So it learned this\nspurious correlation that whenever you see a\nlight-colored surface, you can go through it.",
    "start": "1725610",
    "end": "1730659"
  },
  {
    "text": "So during the test time when\nwe did the opposite, where you have light-colored walls and\ndark-colored surfaces or floors,",
    "start": "1730660",
    "end": "1737410"
  },
  {
    "text": "it thinks that it can go\nthrough the wall and collides in the end. So there are these type\nof spurious correlation",
    "start": "1737410",
    "end": "1743159"
  },
  {
    "text": "that CNN learned, and we can\nexpose that through this stress testing mechanism. ",
    "start": "1743160",
    "end": "1750799"
  },
  {
    "text": "OK, so where am I\ngoing with this? Well, we now have a\nset of failure inputs",
    "start": "1750800",
    "end": "1758630"
  },
  {
    "text": "for these vision-based\ncontrollers. So we can use them to improve\nour controller itself.",
    "start": "1758630",
    "end": "1764460"
  },
  {
    "text": "The one thing we\ncan do is we can use these for our\nruntime anomaly detector.",
    "start": "1764460",
    "end": "1769830"
  },
  {
    "text": "So we can simply train\nan anomaly detector that, given an image,\npredicts whether this image is likely to cause\na failure or not.",
    "start": "1769830",
    "end": "1776419"
  },
  {
    "text": "And this anomaly\ndetector then can be used to trigger a\nfallback controller in case",
    "start": "1776420",
    "end": "1782390"
  },
  {
    "text": "a failure is predicted\nto safeguard the system. Otherwise, we can\njust keep running our vision-based\ncontroller as it is.",
    "start": "1782390",
    "end": "1788220"
  },
  {
    "text": "Yes. So how is the anomaly\ndetector implemented? What are you giving it? What actually happens?",
    "start": "1788220",
    "end": "1793560"
  },
  {
    "text": "And how is it making\nthe prediction? Yes, so I'm going to\nshow an example soon. But essentially, the failure--",
    "start": "1793560",
    "end": "1799590"
  },
  {
    "text": "so we got this bunch\nof images which we know are going to cause a\nfailure in the system.",
    "start": "1799590",
    "end": "1805279"
  },
  {
    "text": "Similarly, we go\nin the safe region and do the same process\nthat we're going to get a set of safe images.",
    "start": "1805280",
    "end": "1810299"
  },
  {
    "text": "So essentially, it's\nsimply a binary classifier, which gives me either\na failure or success",
    "start": "1810300",
    "end": "1815330"
  },
  {
    "text": "depending on the image. So it seems like you just\nhave a neural network here.",
    "start": "1815330",
    "end": "1820560"
  },
  {
    "text": "So it seems like the\nanomaly detector doesn't have to be 100% deterministic. Why is that the case?",
    "start": "1820560",
    "end": "1827550"
  },
  {
    "text": "It doesn't have to be-- it is still deterministic\nat the end of the day because we're going to put\nsome threshold on the failure",
    "start": "1827550",
    "end": "1834143"
  },
  {
    "text": "and success detection. It is not 100% correct for\nsure if that's what you meant. Yes.",
    "start": "1834143",
    "end": "1839310"
  },
  {
    "text": "So it is only likely to work in\nthe, I guess, in distribution.",
    "start": "1839310",
    "end": "1844740"
  },
  {
    "text": "In other words,\nwhatever environments you use for stress testing, you\ngot failure images within that.",
    "start": "1844740",
    "end": "1850493"
  },
  {
    "text": "And so if you're going\nto encounter the images from the same distribution,\nthen this anomaly detector is going to work,\notherwise it does not.",
    "start": "1850493",
    "end": "1858620"
  },
  {
    "text": "So far in general, I\nhaven't commented anything about what happens\nout of distribution.",
    "start": "1858620",
    "end": "1863850"
  },
  {
    "text": "So out of distribution\nof the environment, out of distribution of\nthe visual variations. And I'm going to talk\nabout that in a little bit.",
    "start": "1863850",
    "end": "1870955"
  },
  {
    "text": " So here is this that\nanomaly detector in action.",
    "start": "1870955",
    "end": "1878120"
  },
  {
    "text": "So this is the same\nimage if you recall where the vision-based\ncontroller was earlier failing because of these\nrunway markings over there.",
    "start": "1878120",
    "end": "1884750"
  },
  {
    "text": "But now you will\nsee that as soon as the aircraft sees this\nimage, anomaly detector flags.",
    "start": "1884750",
    "end": "1889890"
  },
  {
    "text": "That is the failure\nimage fallback controller triggers, which in this case\nsimply slows down the aircraft.",
    "start": "1889890",
    "end": "1895350"
  },
  {
    "text": "So it's a very simple\nfallback controller. And once the aircraft\npasses these markings,",
    "start": "1895350",
    "end": "1900809"
  },
  {
    "text": "then the vision-based\ncontroller takes over again because the anomaly detector\nclassifies it as safe. So this is a simple mechanism\nfor runtime anomaly detection",
    "start": "1900810",
    "end": "1909380"
  },
  {
    "text": "that we can use once we\nhave the failure data set. ",
    "start": "1909380",
    "end": "1916010"
  },
  {
    "text": "We can also use\nthis failure data set for the incremental training\nor targeted incremental training",
    "start": "1916010",
    "end": "1921560"
  },
  {
    "text": "of a vision-based controller. So we collected a bunch\nof images and the labels",
    "start": "1921560",
    "end": "1927220"
  },
  {
    "text": "corresponding to those. And then we just did\nmore training iterations of our vision-based controller.",
    "start": "1927220",
    "end": "1932680"
  },
  {
    "text": "In the gray is the\nbackward reachable tube before retraining, and the\nblue is after retraining.",
    "start": "1932680",
    "end": "1939260"
  },
  {
    "text": "So as we probably would\nexpect in this case, the BRT gets smaller\nwhen we retrain",
    "start": "1939260",
    "end": "1945250"
  },
  {
    "text": "because now the vision-based\ncontroller knows how to act under these failure scenarios.",
    "start": "1945250",
    "end": "1950756"
  },
  {
    "text": " Did you [? look and ?]\nsee what would happen like\n[INAUDIBLE] because I",
    "start": "1950756",
    "end": "1958180"
  },
  {
    "text": "think there's\nstill some mistakes that you can't recover from. Yeah, actually I'm\ngoing to show you",
    "start": "1958180",
    "end": "1967462"
  },
  {
    "text": "some more slices of what happens\nwith incremental training. And the issues are much deeper. But to answer your\nquestion, in short, yes.",
    "start": "1967462",
    "end": "1974270"
  },
  {
    "text": "So after retraining, the\nvision-based controller still has some failure modes.",
    "start": "1974270",
    "end": "1980559"
  },
  {
    "text": "But two, if we use a\nperfect controller. So imagine the vision-based\ncontroller was perfect.",
    "start": "1980560",
    "end": "1986680"
  },
  {
    "text": "Just because of the\nchoice of our controller, we may still have some\nfailures that we cannot avoid.",
    "start": "1986680",
    "end": "1992450"
  },
  {
    "text": "And here the blue set\nis quite close to that. I mean, we did that\nanalysis, but I'm not showing it over here.",
    "start": "1992450",
    "end": "1997995"
  },
  {
    "text": " So let me quickly\nsummarize this part.",
    "start": "1997995",
    "end": "2006030"
  },
  {
    "text": "So we have been\ntalking about stress testing vision-based\ncontrollers. And what maybe my two cents here\nis that data-driven reachability",
    "start": "2006030",
    "end": "2015059"
  },
  {
    "text": "methods can help with the\nefficient stress testing of vision-based controllers. And these mind\nfailures can be used",
    "start": "2015060",
    "end": "2021870"
  },
  {
    "text": "for closing the loop with\nboth with offline design, for example, this\ntargeted retraining or with online deployment, for\nexample via anomaly detection.",
    "start": "2021870",
    "end": "2030010"
  },
  {
    "text": "So that could be quite useful\nfor real world systems.",
    "start": "2030010",
    "end": "2035400"
  },
  {
    "text": "Now I want to talk about\nsome of the challenges which already came up when we were\ngoing through the framework.",
    "start": "2035400",
    "end": "2043710"
  },
  {
    "text": "One is I can only\nhope to safeguard against the environments that I\nhave seen in my stress testing",
    "start": "2043710",
    "end": "2051830"
  },
  {
    "text": "or during my stress testing. So, for example, I never\ntalked about the runways",
    "start": "2051830",
    "end": "2059330"
  },
  {
    "text": "with snow or ice on them. So if the aircraft is\noperating on such a runway,",
    "start": "2059330",
    "end": "2066719"
  },
  {
    "text": "I have no hope that the\nanomaly detector would work. So it's an open question so\nfar, for at least for this work,",
    "start": "2066719",
    "end": "2072629"
  },
  {
    "text": "is how to generalize\nto new environments? Now, there could\nbe a few methods",
    "start": "2072630",
    "end": "2077840"
  },
  {
    "text": "to tackle that which\nwe've been thinking about. For example, we can\ndo digital twins.",
    "start": "2077840",
    "end": "2082969"
  },
  {
    "text": "So as we go to the\nnew environment, we can try to create a\ntwin of that in simulation and then use it\nfor stress testing,",
    "start": "2082969",
    "end": "2088636"
  },
  {
    "text": "just like we've been doing\nfor other environments. The other interesting idea\ncould be vision models. So we have NeRFs and Gaussian\nsplatting models now,",
    "start": "2088636",
    "end": "2097350"
  },
  {
    "text": "which can generate rich visual\nmodels with a few images. So you can imagine that as\nwe go to the new environment,",
    "start": "2097350",
    "end": "2104460"
  },
  {
    "text": "we can create\nthese visual models and use them for stress testing. So we have a good sense\nof the failure scenarios",
    "start": "2104460",
    "end": "2110750"
  },
  {
    "text": "within a particular environment. So if the stress\ntesting pipeline can be run efficiently\nenough or quickly enough",
    "start": "2110750",
    "end": "2117230"
  },
  {
    "text": "in an online manner,\nthen we can deploy them to new and new settings. ",
    "start": "2117230",
    "end": "2124940"
  },
  {
    "text": "A second and something\nvery interesting to me is when we do this incremental\ntraining, which by the way,",
    "start": "2124940",
    "end": "2133920"
  },
  {
    "text": "is very common across\nindustry as well. Am I being recorded? I'm being recorded.",
    "start": "2133920",
    "end": "2139690"
  },
  {
    "text": "OK, so I'm just going to\nkeep it industry generic. So if you look at different\nautonomy pipelines",
    "start": "2139690",
    "end": "2147320"
  },
  {
    "text": "and many companies\nkeep track of, sorry, keep track of\nwhat are all the failure",
    "start": "2147320",
    "end": "2154400"
  },
  {
    "text": "modes of their pipeline is. I mean, they don't necessarily\nalways do stress testing in the way I'm proposing here.",
    "start": "2154400",
    "end": "2161330"
  },
  {
    "text": "So the stress testing can be\ndone with an infill testing, for example. Maybe like there is\nan actual human that",
    "start": "2161330",
    "end": "2167140"
  },
  {
    "text": "is operating the\nautonomous system and taking a look\nat where it fails. So essentially, we might\nhave a catalog of failures.",
    "start": "2167140",
    "end": "2174170"
  },
  {
    "text": "But using that\ncatalog of failures for improving the system is a\nhuge challenge because there's",
    "start": "2174170",
    "end": "2180309"
  },
  {
    "text": "an underlying issue in our\nmachine learning systems today, which is\nwe don't know how to lead to monotonic improvement\nin our neural networks.",
    "start": "2180310",
    "end": "2187340"
  },
  {
    "text": "So if I give you a\ndata set D1 and I add 100 more data points to D1\nand I give you a new data set D2, there's absolutely\nno guarantee",
    "start": "2187340",
    "end": "2194440"
  },
  {
    "text": "that D2 will actually\nlead to a better performance of this neural\nnetwork compared to D1.",
    "start": "2194440",
    "end": "2199880"
  },
  {
    "text": "So there is no rule for\nmonotonic improvement in our neural network. And those cracks are\nalso apparent here.",
    "start": "2199880",
    "end": "2207580"
  },
  {
    "text": "So it is the same BRT\nbefore retraining, which is in the gray, and after\nretraining, which is whatever",
    "start": "2207580",
    "end": "2215320"
  },
  {
    "text": "this color is, light brown. I showed you one slice earlier. Here is another slice\nof the same BRT.",
    "start": "2215320",
    "end": "2223269"
  },
  {
    "text": "And you can see\nthat actually now the system is failing\nin the situations where it was fine earlier.",
    "start": "2223270",
    "end": "2229810"
  },
  {
    "text": "So this is what I'm talking\nabout where we train it on more data, more\ntargeted data,",
    "start": "2229810",
    "end": "2235369"
  },
  {
    "text": "yet the safety might\nactually took a downturn in some of these situations.",
    "start": "2235370",
    "end": "2241869"
  },
  {
    "text": "And the another big\nchallenge here really is how to identify the\nunderlying failure reasons.",
    "start": "2241870",
    "end": "2248059"
  },
  {
    "text": "So currently, the framework\nonly gives me these images. All it tells me that\nstarting from these images",
    "start": "2248060",
    "end": "2254680"
  },
  {
    "text": "the robot is going to fail. But what is in this image\nthat's causing this failure",
    "start": "2254680",
    "end": "2260620"
  },
  {
    "text": "is very, very hard to tell. So for that, we are doing\nmanual analysis for now.",
    "start": "2260620",
    "end": "2266140"
  },
  {
    "text": "So I guess more my students\nand myself are just looking at these\nimages and trying to come up with the reasons for\nwhy it might be failing maybe",
    "start": "2266140",
    "end": "2274660"
  },
  {
    "text": "with the foundation\nmodels that might change, but still, finding\nthe underlying reasons concretely is a very,\nvery big challenge.",
    "start": "2274660",
    "end": "2281980"
  },
  {
    "text": "So whatever I told you\nregarding pedestrian crossings-- it should not be\npedestrian crossing.",
    "start": "2281980",
    "end": "2286990"
  },
  {
    "text": "I was told. Runway markings or narrow\ngaps or wide walls, the reason it was\ncausing the failure",
    "start": "2286990",
    "end": "2293130"
  },
  {
    "text": "is all manual analysis so far. And part of the\nreason for why we",
    "start": "2293130",
    "end": "2298260"
  },
  {
    "text": "have to do this manual\nanalysis is also because of the choice of\nthe framework I'm using. So I'm treating this entire\nvision-based controller",
    "start": "2298260",
    "end": "2306570"
  },
  {
    "text": "as a black box. And yes, that allows me to do a\nslightly simpler stress testing",
    "start": "2306570",
    "end": "2312930"
  },
  {
    "text": "analysis. The issue comes up at the\ninterpretability level.",
    "start": "2312930",
    "end": "2318400"
  },
  {
    "text": "So given a failure image,\nthis black box mechanism makes it very challenging\nto assign the blame",
    "start": "2318400",
    "end": "2325710"
  },
  {
    "text": "on any particular module\nof the entire pipeline.",
    "start": "2325710",
    "end": "2331650"
  },
  {
    "text": "On the other hand, if we look at\nmost of the autonomous systems today. And here I'm taking autonomous\ndriving as an example.",
    "start": "2331650",
    "end": "2337460"
  },
  {
    "text": "We have a modular pipeline. We have perception\ncomponents, which then feeds into for example,\nprediction component, which then",
    "start": "2337460",
    "end": "2344890"
  },
  {
    "text": "feeds into planning component. And so an interesting\nquestion to ask here",
    "start": "2344890",
    "end": "2350620"
  },
  {
    "text": "is what is the difference\nbetween this black box end-to-end stress testing\nversus modular stress testing",
    "start": "2350620",
    "end": "2358569"
  },
  {
    "text": "and anomaly detection? And can it help in any way\nwith the interpretability?",
    "start": "2358570",
    "end": "2363940"
  },
  {
    "text": "In particular, we\nhave years of research on each of these\ncomponents individually.",
    "start": "2363940",
    "end": "2369620"
  },
  {
    "text": "So for example, today we have\nvery good perception monitors which can rely on sensor fusion,\nfor example, LiDAR, radars,",
    "start": "2369620",
    "end": "2377440"
  },
  {
    "text": "and cameras in the case of an\nautonomous vehicle, and tells me if a particular scene might\nhave a perception error.",
    "start": "2377440",
    "end": "2387490"
  },
  {
    "text": "That's all it's able to tell. Not necessarily the failure of\nthe entire pipeline, but just whether there is an error\nin the perception component.",
    "start": "2387490",
    "end": "2396950"
  },
  {
    "text": "But as we talked about\nin the aircraft example,",
    "start": "2396950",
    "end": "2402839"
  },
  {
    "text": "not all component\nlevel errors are equal. So let me rephrase that in\nthe context of this autonomous",
    "start": "2402840",
    "end": "2409610"
  },
  {
    "text": "driving example. So imagine we have this green\ncar is our autonomous car.",
    "start": "2409610",
    "end": "2418040"
  },
  {
    "text": "Both the yellow and the red\ncars are the other agents. And suppose I come up with\nthis blue plan to turn around.",
    "start": "2418040",
    "end": "2425840"
  },
  {
    "text": "Now imagine my\nperception component here fails to detect both\nof these red cars.",
    "start": "2425840",
    "end": "2431930"
  },
  {
    "text": "Now, if it fails to\ndetect red car 1, it does not affect the\nsafety of my plan whatsoever.",
    "start": "2431930",
    "end": "2439050"
  },
  {
    "text": "My plan would not change\nat all whether or not I detect the red car 1. I'm not saying that the modern\nperception camera would not",
    "start": "2439050",
    "end": "2445640"
  },
  {
    "text": "be able to detect red car 1. Just to be clear. I'm just taking a\ncartoon example. On the other hand, if it fails\nto detect the red car two,",
    "start": "2445640",
    "end": "2453920"
  },
  {
    "text": "that has a clear\neffect on my safety. And so when we are looking\nat these modular pipelines,",
    "start": "2453920",
    "end": "2461000"
  },
  {
    "text": "an equally important\nquestion to ask is which of the\nperception errors",
    "start": "2461000",
    "end": "2466030"
  },
  {
    "text": "or how does a\nperception error affects the overall safety or the system\nlevel safety of my system?",
    "start": "2466030",
    "end": "2472645"
  },
  {
    "text": " And so we have been studying\nthis problem in collaboration",
    "start": "2472645",
    "end": "2479839"
  },
  {
    "text": "with NVIDIA in the context\nof autonomous cars,",
    "start": "2479840",
    "end": "2484970"
  },
  {
    "text": "where we have been\nlooking at coming up with ways to evaluate the system\nlevel safety given a perception",
    "start": "2484970",
    "end": "2491990"
  },
  {
    "text": "failure. So we are starting with a\nperception monitor, which takes",
    "start": "2491990",
    "end": "2498230"
  },
  {
    "text": "a scene, or rho sensory inputs.",
    "start": "2498230",
    "end": "2504060"
  },
  {
    "text": "And it tells me what\nwe call monitor input. So it tells me if it has\nmissed some of the cars",
    "start": "2504060",
    "end": "2509580"
  },
  {
    "text": "and if so where. So it's essentially a\nprobability distribution of some of the missed\nagent positions.",
    "start": "2509580",
    "end": "2515200"
  },
  {
    "text": "That's what it is in\nthis particular case. And what we do is we design\nthis neural network, which",
    "start": "2515200",
    "end": "2523049"
  },
  {
    "text": "we call SPARQ, which takes\nthat monitor input along with an ego plan and\nthe scene, and tries",
    "start": "2523050",
    "end": "2530820"
  },
  {
    "text": "to do a safety\nassessment of that plan, meaning it's trying to tell me\nwhether that particular plan can",
    "start": "2530820",
    "end": "2537450"
  },
  {
    "text": "be unsafe under this\nparticular perception error.",
    "start": "2537450",
    "end": "2544410"
  },
  {
    "text": "And if it is leading to an\nerror, it also suggests a repair",
    "start": "2544410",
    "end": "2550319"
  },
  {
    "text": "or how to change that plan\nso as to maintain safety. ",
    "start": "2550320",
    "end": "2557520"
  },
  {
    "text": "So yes. Sorry, is this is something\nat runtime or at like-- Yes, this is runtime.",
    "start": "2557520",
    "end": "2563559"
  },
  {
    "text": "I'm going to train\nthis network offline. But the hope is\nto run it online.",
    "start": "2563560",
    "end": "2569080"
  },
  {
    "text": "OK. Sorry, go ahead. I [? can't understand ?] you\nsaid that we can put in an input",
    "start": "2569080",
    "end": "2576220"
  },
  {
    "text": "but leave out some of\nthe cars or whatever. And so at the very input--",
    "start": "2576220",
    "end": "2583060"
  },
  {
    "text": "Yeah. This is running at runtime. So we put in the runtime input. But then we might\nhave missed the car.",
    "start": "2583060",
    "end": "2590050"
  },
  {
    "text": "Yeah, so this\nperception monitor which is more like a sensor\nfusion in this case",
    "start": "2590050",
    "end": "2595090"
  },
  {
    "text": "that taking in all the\ninputs and telling me if there is a probability\nof misprediction",
    "start": "2595090",
    "end": "2600670"
  },
  {
    "text": "of some of the cars. Like predictive uncertainty? Exactly. And there could be different\ntype of predictive uncertainty.",
    "start": "2600670",
    "end": "2607520"
  },
  {
    "text": "It could be about\nspeed of the car or it could be about\nmiss detection. In particular case here, I'm\nlooking at miss detection, which",
    "start": "2607520",
    "end": "2614380"
  },
  {
    "text": "is this is essentially\ngoing to tell me about the position of and some\nuncertain agent, for example,",
    "start": "2614380",
    "end": "2621050"
  },
  {
    "text": "or a distribution\nof that, which I'm trying to figure out if it's\ngoing to affect my safety or not.",
    "start": "2621050",
    "end": "2627650"
  },
  {
    "text": "And the whole problem\nreally here is runtime. The issue is that the latency\nrequirements of these autonomous",
    "start": "2627650",
    "end": "2634850"
  },
  {
    "text": "cars is very, very low. So we can-- indeed, we don't\neven need a neural network. We can actually come up\nwith the safety evaluation",
    "start": "2634850",
    "end": "2642980"
  },
  {
    "text": "by planning, assuming this\nagent is there, for instance,",
    "start": "2642980",
    "end": "2648660"
  },
  {
    "text": "and seeing if that's going to\ncause a safety violation or not. But the problem with\nthat whole process is that it's just too\nslow to run in real time.",
    "start": "2648660",
    "end": "2656870"
  },
  {
    "text": "So here we are trying to use\na neural network to quickly assess, given some perception\nuncertainty and given some plan,",
    "start": "2656870",
    "end": "2664027"
  },
  {
    "text": "is it going to cause\na failure or not, or is it likely to\ncause a failure or not. I have one more question.",
    "start": "2664027",
    "end": "2669690"
  },
  {
    "text": "Yes. So we have this perception\nthat predicted uncertainty.",
    "start": "2669690",
    "end": "2676160"
  },
  {
    "text": "Is it more typical to do\nmany rollouts and sample",
    "start": "2676160",
    "end": "2681289"
  },
  {
    "text": "from the predicted\ndistributions, or do you try to\nreason in a Bayesian or some kind of distribution?",
    "start": "2681290",
    "end": "2686430"
  },
  {
    "text": "During the training,\nwe are using rollouts in this particular case. I mean, I would love to\ndo Bayesian reasoning,",
    "start": "2686430",
    "end": "2693370"
  },
  {
    "text": "but the problem is that this\nuncertainty propagation needs to happen through\nprediction pipeline, which",
    "start": "2693370",
    "end": "2698850"
  },
  {
    "text": "are just really complex today. So it's very, very\nhard to do it. Yeah, so that's in general\none of the challenges",
    "start": "2698850",
    "end": "2705510"
  },
  {
    "text": "with modular pipelines that\none of the benefits of them is that they can really\ncharacterize the uncertainty",
    "start": "2705510",
    "end": "2710820"
  },
  {
    "text": "at each output head. But propagating that uncertainty\nin a tractable manner",
    "start": "2710820",
    "end": "2717000"
  },
  {
    "text": "is still a very,\nvery big challenge. So we're somewhat\nlimited in planning",
    "start": "2717000",
    "end": "2722430"
  },
  {
    "text": "in the uncertainty aware manner. OK, thank you.",
    "start": "2722430",
    "end": "2728190"
  },
  {
    "text": "So I mean, the exact\narchitecture is not as important, but this is work--",
    "start": "2728190",
    "end": "2733240"
  },
  {
    "text": "this is what our SPARQ\nneural network looks like. It takes as input the output\nof the perception monitor.",
    "start": "2733240",
    "end": "2740650"
  },
  {
    "text": "So that is the\npredictive uncertainty along with a bunch of\ninformation about the scene, for example, what is the\nagent history, autonomous car",
    "start": "2740650",
    "end": "2748290"
  },
  {
    "text": "history, and what is\nmy road graphs where the lanes are, along with\na candidate ego plan.",
    "start": "2748290",
    "end": "2753660"
  },
  {
    "text": "And under the hood\nis this prediction of all of these agents.",
    "start": "2753660",
    "end": "2758890"
  },
  {
    "text": "And then evaluate, at\nthe end of the day, whether a particular plan\nis safe, risky, or critical.",
    "start": "2758890",
    "end": "2764870"
  },
  {
    "text": " So again, a simple classifier.",
    "start": "2764870",
    "end": "2771839"
  },
  {
    "text": "And the way we train this\nframework is actually purely in a supervised\nlearning manner,",
    "start": "2771840",
    "end": "2777640"
  },
  {
    "text": "where offline we\ncan generate data sets by simulating different\nperception uncertainty",
    "start": "2777640",
    "end": "2783809"
  },
  {
    "text": "and evaluating whether\na plan is safe or not. Once again, that we can\ndo offline because we",
    "start": "2783810",
    "end": "2789750"
  },
  {
    "text": "have sufficient time. The only problem\nis that evaluation might be just too slow for\ndoing in an online manner.",
    "start": "2789750",
    "end": "2796349"
  },
  {
    "text": "So here I'm just showing\nthe data set generation. For instance, here this green\nis again my ego vehicle.",
    "start": "2796350",
    "end": "2803130"
  },
  {
    "text": "Suppose my perception monitor\ntells me or miss this agent.",
    "start": "2803130",
    "end": "2808890"
  },
  {
    "text": "So suppose it misses this agent. And then we can evaluate whether\nthis plan remains safe or not.",
    "start": "2808890",
    "end": "2814050"
  },
  {
    "text": "So in this case, as you can\nimagine, whether we detect or not this agent, this plan\nis going to remain safe.",
    "start": "2814050",
    "end": "2819180"
  },
  {
    "text": "On the other hand, if I\nmiss an agent somewhere near the ego vehicle, the same\nplan is going to be unsafe.",
    "start": "2819180",
    "end": "2824700"
  },
  {
    "text": "So that's how we can\ngenerate the data set. ",
    "start": "2824700",
    "end": "2830960"
  },
  {
    "text": "And here's one snapshot of\nscenarios during the test time.",
    "start": "2830960",
    "end": "2837240"
  },
  {
    "text": "So now we train that network\nand we are evaluating it. So this is the\nperceived scene, meaning",
    "start": "2837240",
    "end": "2844730"
  },
  {
    "text": "this is what the autonomous car\nthought is the scene around it. But actually, it\ndid miss this agent.",
    "start": "2844730",
    "end": "2851002"
  },
  {
    "text": "So perception monitor\ntells me that there might be an agent here. And it will give me some\nuncertainty around the position",
    "start": "2851002",
    "end": "2856790"
  },
  {
    "text": "of this agent. So this framework SPARQ now\nwould take this perceived scene",
    "start": "2856790",
    "end": "2862400"
  },
  {
    "text": "along with the perception\ninput and this blue plan, and will predict whether this\nplan is going to be safe or not.",
    "start": "2862400",
    "end": "2869039"
  },
  {
    "text": "So in this case, it\npredicts that it's actually an unsafe plan. And then it proposes\na candidate safe plan,",
    "start": "2869040",
    "end": "2875069"
  },
  {
    "text": "the green in this case,\nwhich predicts the lane change in this case, that\nyou should do lane change",
    "start": "2875070",
    "end": "2880730"
  },
  {
    "text": "and keeps the system safe. Yes. Just for the perception\nfor when you're",
    "start": "2880730",
    "end": "2886040"
  },
  {
    "text": "reporting like how does\nthat work I guess or would you have that same\ncapability when you're",
    "start": "2886040",
    "end": "2892910"
  },
  {
    "text": "driving an autonomous car? Because it's like being able to\ntell like, oh, what we perceive is actually as true\nas it might seem.",
    "start": "2892910",
    "end": "2899370"
  },
  {
    "text": "So the question is, how do I\ncome up with that red thing? Yeah. Yeah, so, I mean, there are\ndifferent perception monitors",
    "start": "2899370",
    "end": "2906740"
  },
  {
    "text": "in the literature. The one that we are\nusing here is actually just doing sensor fusion.",
    "start": "2906740",
    "end": "2911955"
  },
  {
    "text": "So what it is doing\nis taking the input from the camera and\nLiDAR and radar, and it's trying to look at the\nagreement between them, which",
    "start": "2911955",
    "end": "2920650"
  },
  {
    "text": "is that if an agent is\ndetected by a camera, is that also detected by\nLiDAR, and if any of them",
    "start": "2920650",
    "end": "2925900"
  },
  {
    "text": "has a mismatch, then there could\nbe a potential missing agent.",
    "start": "2925900",
    "end": "2931010"
  },
  {
    "text": "And so it's just using\nthat as a way to enumerate both potential missing agents.",
    "start": "2931010",
    "end": "2938829"
  },
  {
    "text": "But this is an input\nto the framework. So this is not something\nthat we developed here. So for example in\nthe runway setting",
    "start": "2938830",
    "end": "2947800"
  },
  {
    "text": "I feel like when you consider\nsomething safe or unsafe, you can write it down\nas a specification. For example, let's\nsay if the airplane",
    "start": "2947800",
    "end": "2954490"
  },
  {
    "text": "stays in the [INAUDIBLE]\nrunway or something. Now I feel like we've moved\nto a territory where actually, instead of me saying\nit's safe or not",
    "start": "2954490",
    "end": "2960369"
  },
  {
    "text": "you have a neural network that\nmakes a judgment call on this.",
    "start": "2960370",
    "end": "2965420"
  },
  {
    "text": "And I'm wondering, why\ncan we not just or I mean, can you not just look\nat the different states. And then just see if it is\nwithin your SPARQ or not.",
    "start": "2965420",
    "end": "2973220"
  },
  {
    "text": "And why do we need to\ntrain unsafe detectors? Simply because of\nlatency requirements. So in fact, what\nyou're suggesting",
    "start": "2973220",
    "end": "2979763"
  },
  {
    "text": "is what we are doing\noffline to generate data for this neural network. This whole pipeline of putting\nthe agent at different location",
    "start": "2979763",
    "end": "2986740"
  },
  {
    "text": "affects the behavior prediction\nof all the other agents. That then feeds\ninto your planner,",
    "start": "2986740",
    "end": "2992762"
  },
  {
    "text": "and you want to figure\nout whether that plan is safe or unsafe or not. So it's kind of a surrogate\nmodel for the whole-- Exactly, exactly.",
    "start": "2992762",
    "end": "2999260"
  },
  {
    "text": "So if we do that precisely\nwhat you suggested it takes-- currently, this whole\npipeline can run at 10 Hertz.",
    "start": "2999260",
    "end": "3005860"
  },
  {
    "text": "OK. And then you do your stress\ntest again this guy also. Yeah, so we stress test\nnot to the same extent",
    "start": "3005860",
    "end": "3013530"
  },
  {
    "text": "that I proposed earlier,\nbut we do, I mean, this is honestly very\npreliminary work and very",
    "start": "3013530",
    "end": "3019110"
  },
  {
    "text": "recent work. So we are still developing\nthe pieces of it. But I just wanted\nto present this work",
    "start": "3019110",
    "end": "3024810"
  },
  {
    "text": "to highlight the difference\nbetween modular testing versus end-to-end testing\nand what it can enable.",
    "start": "3024810",
    "end": "3033400"
  },
  {
    "text": "But here is another snapshot\nof the same framework where",
    "start": "3033400",
    "end": "3038960"
  },
  {
    "text": "we are looking at if\nthere is a missing agent at different location\nin this scene, what",
    "start": "3038960",
    "end": "3044059"
  },
  {
    "text": "will be the prediction\nof this framework? So red is the position\nof the missing",
    "start": "3044060",
    "end": "3049310"
  },
  {
    "text": "agent for which this would\nhave predicted an unsafe plan. Other cases would be\npredicting a safe plan.",
    "start": "3049310",
    "end": "3055710"
  },
  {
    "text": "And in this case, it makes sense\nthat roughly around this ego agent, but more importantly in\nthe forward direction of the ego",
    "start": "3055710",
    "end": "3062599"
  },
  {
    "text": "agent, when there is an agent,\nit predicts unsafe behavior. But as I said earlier,\nthe main reason",
    "start": "3062600",
    "end": "3069380"
  },
  {
    "text": "to do this, as opposed to doing\nthe exhaustive evaluation, is that we can run this\npipeline at 42 hertz, which",
    "start": "3069380",
    "end": "3076237"
  },
  {
    "text": "is the latency requirement\nin this particular case on a standard GPU. ",
    "start": "3076237",
    "end": "3083300"
  },
  {
    "text": "OK, so let me summarize\nwhat I talked about.",
    "start": "3083300",
    "end": "3090750"
  },
  {
    "text": "So probably not a\nnews to this class. Stress testing is an important\nvalidation and improvement",
    "start": "3090750",
    "end": "3096200"
  },
  {
    "text": "mechanism for\nautonomous systems, both for offline deployment\nof these systems,",
    "start": "3096200",
    "end": "3103140"
  },
  {
    "text": "or both for improving\nthe offline design, but also for online deployment. Perhaps what we saw a\nlittle bit in the talk today",
    "start": "3103140",
    "end": "3110960"
  },
  {
    "text": "is that control theory provides\na number of interesting tools for stress testing, in addition\nto many other stress testing",
    "start": "3110960",
    "end": "3116960"
  },
  {
    "text": "tools that we have available. There are several open questions\nthat I would love to discuss.",
    "start": "3116960",
    "end": "3123869"
  },
  {
    "text": "One is what is the advantage\nof system level stress testing versus component-level\nstress testing?",
    "start": "3123870",
    "end": "3129930"
  },
  {
    "text": "So we have a lot of mechanisms\nin machine learning, for example,\nadversarial robustness, which are more targeting\ncomponent-level testing.",
    "start": "3129930",
    "end": "3136890"
  },
  {
    "text": "So given a classifier they\nwill tell us like can we classify a panda into an Apple.",
    "start": "3136890",
    "end": "3142560"
  },
  {
    "text": "But that's just a\ncomponent-level stress testing. Maybe a pink sky doesn't\nmatter for an autonomous car,",
    "start": "3142560",
    "end": "3149340"
  },
  {
    "text": "so even the component is\ndoing really, really bad. It may not matter\nfor the system level. So there is this\nquestion of system level",
    "start": "3149340",
    "end": "3158000"
  },
  {
    "text": "versus component level. That's important. The second is modular\nversus end-to-end testing.",
    "start": "3158000",
    "end": "3163620"
  },
  {
    "text": "In a lot of cases, end-to-end\nSPARQ is easy to write. It's easy to write what is the\nfailure mode for my autonomous",
    "start": "3163620",
    "end": "3170540"
  },
  {
    "text": "car, which is a\ncollision, for example. But writing that\nspecification of failure for each of the individual\ncomponent, for perception,",
    "start": "3170540",
    "end": "3177060"
  },
  {
    "text": "for prediction can\nbe very, very hard. So there is an advantage to\nend-to-end testing in the sense that I can write my failure\ncriteria very neatly,",
    "start": "3177060",
    "end": "3185090"
  },
  {
    "text": "but they are not\ninterpretable or they are not. It's very hard to use\nend-to-end testing",
    "start": "3185090",
    "end": "3191210"
  },
  {
    "text": "for improving individual\ncomponents because what it does not tell me is where\nthis failure came from.",
    "start": "3191210",
    "end": "3196859"
  },
  {
    "text": "Was perception at fault,\nor was prediction at fault, or was planning at fault? So modular stress testing\ncan actually help with that.",
    "start": "3196860",
    "end": "3205470"
  },
  {
    "text": "But then writing the SPARQ\ncould be challenging. And finally, generalization.",
    "start": "3205470",
    "end": "3210820"
  },
  {
    "text": "So the stress\ntesting outcomes are limited by where we\ndid the stress testing.",
    "start": "3210820",
    "end": "3216920"
  },
  {
    "text": "So what environment\ndistribution did we consider during stress testing. If we go beyond that,\nthese results may not hold.",
    "start": "3216920",
    "end": "3223340"
  },
  {
    "text": "So how to generalize or\nhow to do stress testing in an online manner\nis still could",
    "start": "3223340",
    "end": "3229270"
  },
  {
    "text": "be very interesting question. I'm happy to discuss any\nquestions or any of these topics",
    "start": "3229270",
    "end": "3235420"
  },
  {
    "text": "more. [APPLAUSE] ",
    "start": "3235420",
    "end": "3243930"
  },
  {
    "text": "Thank you.  Yes. So in the end, you\nwere talking about",
    "start": "3243930",
    "end": "3250720"
  },
  {
    "text": "that it can be useful\nor useful to break down your pipeline into many subsets\nbecause for example, one reason",
    "start": "3250720",
    "end": "3259418"
  },
  {
    "text": "is that you can write down\na SPARQ for each part, and then you can actually\ndo testing on this. Now, famously recently Tesla\nclaims to have developed",
    "start": "3259418",
    "end": "3268985"
  },
  {
    "text": "or at least that's\nwhat it was publicly known more like an end-to-end. We just make one\ndeep learning SPARQ",
    "start": "3268985",
    "end": "3274750"
  },
  {
    "text": "and have it do the\nend-to-end problem. And with this, I\nalways, I guess, we probably agree that maybe\nyou can get half decent results,",
    "start": "3274750",
    "end": "3283580"
  },
  {
    "text": "but it will be really difficult\nto go to a regulator agency and be like, we're\ngoing to prove to you",
    "start": "3283580",
    "end": "3289990"
  },
  {
    "text": "that this is a\nvery robust system. I don't know. Can you maybe say a little\nbit your thoughts on--",
    "start": "3289990",
    "end": "3295720"
  },
  {
    "text": "in these kind of\nsituations where you need to work together\nwith the regulator on the different\ntypes of systems.",
    "start": "3295720",
    "end": "3301130"
  },
  {
    "text": "Yeah, and I think\nlike, I mean, it's one thing to go to\nthe regulator and say",
    "start": "3301130",
    "end": "3307120"
  },
  {
    "text": "it will work in these\nkind of scenarios. But more importantly, I'm\nthinking, suppose I'm investing money in this company.",
    "start": "3307120",
    "end": "3313605"
  },
  {
    "text": "I would think about, OK, what\ndo I do with this result? I stress tested it.",
    "start": "3313605",
    "end": "3318980"
  },
  {
    "text": "I figured out a whole bunch\nof failure situations. Generally, you want\nto improve on those or at least mitigate\nthem by designing",
    "start": "3318980",
    "end": "3326140"
  },
  {
    "text": "some of fallback mechanism. That part becomes\nreally challenging with end-to-end framework\nbecause which part do you",
    "start": "3326140",
    "end": "3333600"
  },
  {
    "text": "improve? Because these are not\ngenerally a single CNN. These are very complex\nlines of codes.",
    "start": "3333600",
    "end": "3339430"
  },
  {
    "text": "So it's also equally\nimportant to figure out which part was at fault when\nthis particular failure happens",
    "start": "3339430",
    "end": "3346360"
  },
  {
    "text": "because that is going to be the\nway to then fix that failure. That becomes very, very\nchallenging with end-to-end.",
    "start": "3346360",
    "end": "3352530"
  },
  {
    "text": "And I don't have\nany better solution. This is just a problem that\nI've seen throughout my time,",
    "start": "3352530",
    "end": "3359530"
  },
  {
    "text": "both in academia\nand in industry, that this is something\neverybody is discussing, and it's still an\nopen area of research.",
    "start": "3359530",
    "end": "3366859"
  },
  {
    "text": " So and up to this\npoint, have you seen cases where doing\nend-to-end testing",
    "start": "3366860",
    "end": "3373432"
  },
  {
    "text": "dramatically turns\ndown the search space in the sense of like\nsuppose an end-to-end system has just certain behavior\nwhere it's entirely not",
    "start": "3373433",
    "end": "3380789"
  },
  {
    "text": "possible for the\ncontroller to do? Whereas if it has\na component wise [? what's ?] it\nlike in this class.",
    "start": "3380790",
    "end": "3387210"
  },
  {
    "text": "It's like a natural\nnotion of you can just propagate\nall of the errors",
    "start": "3387210",
    "end": "3392310"
  },
  {
    "text": "that you get giant, giant\nbounds, but otherwise end-to-end testing, it\nhelps us get better. Oh, yeah. So what happens\noftentimes is that if you",
    "start": "3392310",
    "end": "3402240"
  },
  {
    "text": "do individual component\nlevel testing, the failure region that\nyou get is much bigger.",
    "start": "3402240",
    "end": "3408760"
  },
  {
    "text": "Not necessarily you should\nbe getting it bigger, but because of the\npractical constraint it gets bigger,\nwhich is that it's",
    "start": "3408760",
    "end": "3415079"
  },
  {
    "text": "very hard to propagate\nthe uncertainty from one component to another component. If you could do that,\nideally, if you could do that,",
    "start": "3415080",
    "end": "3421270"
  },
  {
    "text": "then they will be exactly equal. So assuming\nend-to-end is perfect and what you're doing in\nmodular world is also perfect,",
    "start": "3421270",
    "end": "3427059"
  },
  {
    "text": "they should match up because you\nare propagating modular errors also all the way to the\ndownstream control level.",
    "start": "3427060",
    "end": "3435600"
  },
  {
    "text": "The problem is that propagation\nis very challenging. So oftentimes you\nget a superset. ",
    "start": "3435600",
    "end": "3443330"
  },
  {
    "text": "Yes. So just go back\nto the example you brought up with the\nanomaly detector.",
    "start": "3443330",
    "end": "3448790"
  },
  {
    "text": "I was a bit curious about\nout-of-distribution anomaly detection. So let's say you have your data\nset where you're giving it,",
    "start": "3448790",
    "end": "3457580"
  },
  {
    "text": "like the failures from the\naircraft taxiing example. If you already trained a\nmodel to do failure detection,",
    "start": "3457580",
    "end": "3464280"
  },
  {
    "text": "how would you make it more\nrobust like different data sets or at least like\nvariations in data sets. Because it seems\nlike if you train it",
    "start": "3464280",
    "end": "3470420"
  },
  {
    "text": "on one failure data\nset, it's probably going to lose a\nlot of performance on looking at [? error. ?] That's true. So I mean, so\nthat's why, I mean,",
    "start": "3470420",
    "end": "3479348"
  },
  {
    "text": "I've been careful\nwith not calling it out-of-distribution detection. So that's maybe is\none differentiating",
    "start": "3479348",
    "end": "3485270"
  },
  {
    "text": "point between anomaly detection\nout-of-distribution detection. So I am only talking about\nin-distribution anomalies.",
    "start": "3485270",
    "end": "3492500"
  },
  {
    "text": "Out-of-distribution detectors\nis a very, very important topic and requires its own attention.",
    "start": "3492500",
    "end": "3497849"
  },
  {
    "text": "So I in my worldview\nat least, I think there are two\ndetectors required. One is out-of-distribution\ndetector.",
    "start": "3497850",
    "end": "3503779"
  },
  {
    "text": "And then even within\nin-distribution, our machine learning systems\nmight not be perfect. So we also require\nin-distribution anomaly",
    "start": "3503780",
    "end": "3510049"
  },
  {
    "text": "detectors. And here I'm talking\nabout the latter one. Out-of-distribution\ndetection is something",
    "start": "3510050",
    "end": "3515990"
  },
  {
    "text": "that we haven't handled here. And you're absolutely right. If I go to a new type of runway,\nit might very well be failing.",
    "start": "3515990",
    "end": "3522780"
  },
  {
    "text": "So for those kinds of\nexamples, just to follow up, how would you\ntheoretically construct",
    "start": "3522780",
    "end": "3529130"
  },
  {
    "text": "that distribution detector? Good question. I wonder if--",
    "start": "3529130",
    "end": "3534170"
  },
  {
    "text": "[INAUDIBLE] Yeah, that's true. That was going to be my answer.",
    "start": "3534170",
    "end": "3539520"
  },
  {
    "text": "Michael is a whole book. So I mean, yeah, I don't know\nfor one single way to do it,",
    "start": "3539520",
    "end": "3546150"
  },
  {
    "text": "to be honest. I mean, but the\nrecent advances in AI is being leveraged\nquite a bit for",
    "start": "3546150",
    "end": "3552079"
  },
  {
    "text": "out-of-distribution detection. So people are combining\ndifferent type of data sources. So for example, in\nautonomous driving land,",
    "start": "3552080",
    "end": "3560690"
  },
  {
    "text": "what is happening a lot is\nthat for whenever there are some accidents\nthat are happening, police needs to file a report.",
    "start": "3560690",
    "end": "3566840"
  },
  {
    "text": "These reports are in language,\nso people are now actually using those language reports to\ngenerate those scenarios",
    "start": "3566840",
    "end": "3573280"
  },
  {
    "text": "in simulation and for\nout-of-distribution detection. So it's a very different\ntype of data source than what",
    "start": "3573280",
    "end": "3579082"
  },
  {
    "text": "we are collecting here. But those could be helpful here. I should also come\nto the lecture that is giving an\nout-of-detection that maybe I'll",
    "start": "3579082",
    "end": "3585970"
  },
  {
    "text": "[? use ?] it. They were using\nliterally like the text of the reports in\nconjunction with what",
    "start": "3585970",
    "end": "3592809"
  },
  {
    "text": "the model is perceiving. So they're using\nthe text reports and using the generative models\nto generate the simulation",
    "start": "3592810",
    "end": "3599410"
  },
  {
    "text": "scenarios.  So given the report you could\ngenerate the exact scenario",
    "start": "3599410",
    "end": "3606099"
  },
  {
    "text": "that's describing and then-- Exact scenario, yeah. I mean, I'm going to put that\nin quotation because from text",
    "start": "3606100",
    "end": "3612130"
  },
  {
    "text": "to generation it's still not\none-to-one mapping quite, but, yes. So that's the idea.",
    "start": "3612130",
    "end": "3617210"
  },
  {
    "text": "So that way you can stress\ntest the system, maybe beyond what you have envisioned\nhere by using different data",
    "start": "3617210",
    "end": "3625720"
  },
  {
    "text": "sources. So that's GenAI could really\nhelp in such kind of scenarios.",
    "start": "3625720",
    "end": "3634210"
  },
  {
    "text": "Other questions. So one interesting\ntopic you touched on is that you want to\npropagate uncertainty",
    "start": "3634210",
    "end": "3641650"
  },
  {
    "text": "through many stages\nof your system, but it's very difficult\nto do closed form also because you have typical\nruntime requirements,",
    "start": "3641650",
    "end": "3649370"
  },
  {
    "text": "latency requirements. And so now more like from\nyour let's say engineering experience, is it\nbasically the solution",
    "start": "3649370",
    "end": "3657040"
  },
  {
    "text": "that every individual\ncomponent maybe outputs. Let's say a Gaussian\nor something like this. But in the end you just\nalways sample from that.",
    "start": "3657040",
    "end": "3664750"
  },
  {
    "text": "Put each sample\ninto the next stage, predict into the Gaussian\nsample from that. Or what's the most practical\nway to do this kind of things?",
    "start": "3664750",
    "end": "3673990"
  },
  {
    "text": "So I would say that accounting\nfor uncertainty and propagating",
    "start": "3673990",
    "end": "3679950"
  },
  {
    "text": "that is still a very\nunderexplored area in industry. So I've seen very,\nvery few companies",
    "start": "3679950",
    "end": "3685800"
  },
  {
    "text": "doing that in my experience. The fact that my experience is\nstill outdated by three years,",
    "start": "3685800",
    "end": "3691810"
  },
  {
    "text": "but in terms of\npractical approaches, I think something like what is\ndone in POMDP literature I think",
    "start": "3691810",
    "end": "3697590"
  },
  {
    "text": "is really, really powerful. These particle-based\nfilters that are being used to propagate\nthe uncertainty",
    "start": "3697590",
    "end": "3703920"
  },
  {
    "text": "in that particular case\nbelief uncertainty. Those could be really\ninteresting to explore.",
    "start": "3703920",
    "end": "3710650"
  },
  {
    "text": "I honestly think that\nthere's a very good scope for those set of problems, but\nin industry they are really",
    "start": "3710650",
    "end": "3715770"
  },
  {
    "text": "underexplored at the moment. ",
    "start": "3715770",
    "end": "3722850"
  },
  {
    "text": "Thank you. Any other questions. No.",
    "start": "3722850",
    "end": "3728280"
  },
  {
    "text": "Awesome, thank you. Thanks so much. [APPLAUSE] ",
    "start": "3728280",
    "end": "3736000"
  }
]