[
  {
    "start": "0",
    "end": "64000"
  },
  {
    "text": "The next section is on the augmented Lagrangian method,",
    "start": "4250",
    "end": "7950"
  },
  {
    "text": "which- which basically is an improvement on the penalty, uh, method.",
    "start": "7950",
    "end": "11894"
  },
  {
    "text": "Specifically, it's a method that has actually all the benefits of the penalty method,",
    "start": "11895",
    "end": "16305"
  },
  {
    "text": "which is to say it- it kind of works,",
    "start": "16305",
    "end": "18570"
  },
  {
    "text": "or at least as a heuristic it works, um,",
    "start": "18570",
    "end": "21029"
  },
  {
    "text": "but it doesn't require that parameter Mu, uh,",
    "start": "21030",
    "end": "23820"
  },
  {
    "text": "to become infinitely large before you get a good solution.",
    "start": "23820",
    "end": "27255"
  },
  {
    "text": "So that's actually- and in practice it also actually works better.",
    "start": "27255",
    "end": "30945"
  },
  {
    "text": "Okay. So, uh, as I said,",
    "start": "30945",
    "end": "34410"
  },
  {
    "text": "uh, drawback in the penalty method is that Mu,",
    "start": "34410",
    "end": "37760"
  },
  {
    "text": "uh, this- this penalty parameter Mu_k increases",
    "start": "37760",
    "end": "40730"
  },
  {
    "text": "rapidly and it has to get big to drive g of x to zero.",
    "start": "40730",
    "end": "44620"
  },
  {
    "text": "Um, and what happens is when you do that,",
    "start": "44620",
    "end": "46879"
  },
  {
    "text": "the non-linear least squares subproblem becomes harder to solve.",
    "start": "46880",
    "end": "50360"
  },
  {
    "text": "Um, and then it says that, you know,",
    "start": "50360",
    "end": "53190"
  },
  {
    "text": "for- we observe that for very large Mu_k,",
    "start": "53190",
    "end": "55635"
  },
  {
    "text": "Levenberg-Marquardt can either take a large number of iterations or fail.",
    "start": "55635",
    "end": "59734"
  },
  {
    "text": "By fail it just means it's a practical matter,",
    "start": "59735",
    "end": "61730"
  },
  {
    "text": "it just takes too long, and- and just doesn't work.",
    "start": "61730",
    "end": "64805"
  },
  {
    "start": "64000",
    "end": "311000"
  },
  {
    "text": "So to correct that,",
    "start": "64805",
    "end": "67445"
  },
  {
    "text": "I'm gonna show a method that it's actually, um,",
    "start": "67445",
    "end": "69770"
  },
  {
    "text": "actually just a minor modification of the penalty method,",
    "start": "69770",
    "end": "73225"
  },
  {
    "text": "um, that keeps a different- keeps another,",
    "start": "73225",
    "end": "75689"
  },
  {
    "text": "uh, vector, uh, around,",
    "start": "75690",
    "end": "77895"
  },
  {
    "text": "um, and updates it in a different way,",
    "start": "77895",
    "end": "79810"
  },
  {
    "text": "and- and it actually doesn't suffer from that, um,",
    "start": "79810",
    "end": "82610"
  },
  {
    "text": "that- that drawback of the, uh, penalty method.",
    "start": "82610",
    "end": "86080"
  },
  {
    "text": "So here's what it is.",
    "start": "86080",
    "end": "88305"
  },
  {
    "text": "Um, it's this, the so-called,",
    "start": "88305",
    "end": "91005"
  },
  {
    "text": "uh, and this is pretty standard optimization stuff,",
    "start": "91005",
    "end": "93185"
  },
  {
    "text": "you may see this,",
    "start": "93185",
    "end": "94825"
  },
  {
    "text": "um, in your later studies,",
    "start": "94825",
    "end": "97034"
  },
  {
    "text": "you might not too,",
    "start": "97035",
    "end": "98805"
  },
  {
    "text": "um, but it is standard in- in optimization.",
    "start": "98805",
    "end": "101925"
  },
  {
    "text": "So the so-called augmented Lagrangian is this.",
    "start": "101925",
    "end": "106665"
  },
  {
    "text": "Um, it is going to be the original Lagrangian,",
    "start": "106665",
    "end": "111440"
  },
  {
    "text": "um, plus Mu times g of x squared.",
    "start": "111440",
    "end": "114980"
  },
  {
    "text": "Um, now, uh, that's equal to norm f of x squared plus g of x transpose z.",
    "start": "114980",
    "end": "121940"
  },
  {
    "text": "This is the, uh, Lagrange multiplier term,",
    "start": "121940",
    "end": "124445"
  },
  {
    "text": "and that's another term,",
    "start": "124445",
    "end": "125630"
  },
  {
    "text": "and you might even say it's gratuitous.",
    "start": "125630",
    "end": "127895"
  },
  {
    "text": "This other term. Um, I'll tell you why.",
    "start": "127895",
    "end": "130649"
  },
  {
    "text": "Because if your feasible,",
    "start": "130650",
    "end": "132105"
  },
  {
    "text": "g of x is 0,",
    "start": "132105",
    "end": "133200"
  },
  {
    "text": "so like this thing is 0.",
    "start": "133200",
    "end": "135069"
  },
  {
    "text": "So, um, you could think of the augmented Lagrangian as the Lagrangian of this.",
    "start": "135070",
    "end": "140900"
  },
  {
    "text": "This is the equivalent problem to the original problem, right?",
    "start": "140900",
    "end": "143180"
  },
  {
    "text": "The original problem doesn't have this term,",
    "start": "143180",
    "end": "145415"
  },
  {
    "text": "but it's a bit silly because anything feasible for the original problem,",
    "start": "145415",
    "end": "149060"
  },
  {
    "text": "this term goes away.",
    "start": "149060",
    "end": "150425"
  },
  {
    "text": "So what that says is this problem is equivalent to the original problem.",
    "start": "150425",
    "end": "156125"
  },
  {
    "text": "I mean, it's got the same set of minimizers.",
    "start": "156125",
    "end": "158120"
  },
  {
    "text": "If- if- if x is a solution of this one,",
    "start": "158120",
    "end": "161030"
  },
  {
    "text": "it's a solution of the other one.",
    "start": "161030",
    "end": "162230"
  },
  {
    "text": "If it's a solution of this one, it's a solution of the other one.",
    "start": "162230",
    "end": "164360"
  },
  {
    "text": "So it- it just goes back and forth.",
    "start": "164360",
    "end": "166505"
  },
  {
    "text": "Now, you might add like, why would you do this,",
    "start": "166505",
    "end": "168620"
  },
  {
    "text": "and how would adding this extra term help?",
    "start": "168620",
    "end": "171560"
  },
  {
    "text": "Um, shockingly, it does.",
    "start": "171560",
    "end": "173849"
  },
  {
    "text": "[NOISE] Oh, I should say that, um,",
    "start": "173850",
    "end": "178185"
  },
  {
    "text": "this is the- when you say augmenting the Lagrangian,",
    "start": "178185",
    "end": "181955"
  },
  {
    "text": "this is the Lagrangian and that's the augmented term.",
    "start": "181955",
    "end": "186175"
  },
  {
    "text": "Okay. Um, now, when you minimize the,",
    "start": "186175",
    "end": "192419"
  },
  {
    "text": "ah, well, okay, first- first,",
    "start": "192419",
    "end": "194870"
  },
  {
    "text": "we're going to look at some equivalent expressions",
    "start": "194870",
    "end": "196940"
  },
  {
    "text": "for the augmented, uh, Lagrangian, right?",
    "start": "196940",
    "end": "199130"
  },
  {
    "text": "So, um, this is what it is, right?",
    "start": "199130",
    "end": "201480"
  },
  {
    "text": "That's that augmenting term,",
    "start": "201480",
    "end": "202894"
  },
  {
    "text": "which seems like a silly term because that term is zero for any feasible point.",
    "start": "202895",
    "end": "206995"
  },
  {
    "text": "Um, so what we can do though,",
    "start": "206995",
    "end": "209420"
  },
  {
    "text": "is actually move some stuff.",
    "start": "209420",
    "end": "211145"
  },
  {
    "text": "I mean, you see a- a norm g of x,",
    "start": "211145",
    "end": "212780"
  },
  {
    "text": "you know, squared here and so on.",
    "start": "212780",
    "end": "214805"
  },
  {
    "text": "And we can simply move some stuff in and out.",
    "start": "214805",
    "end": "217234"
  },
  {
    "text": "Um, and here's what we're gonna do.",
    "start": "217235",
    "end": "219185"
  },
  {
    "text": "Um, it's equal to- we're going to actually rewrite this, this way.",
    "start": "219185",
    "end": "223370"
  },
  {
    "text": "If you just simply expand this, um,",
    "start": "223370",
    "end": "226150"
  },
  {
    "text": "and then you- you're going to get this, plus that,",
    "start": "226150",
    "end": "228579"
  },
  {
    "text": "you can just verify it by expanding the norm squared.",
    "start": "228580",
    "end": "230975"
  },
  {
    "text": "Um, but this says that this augmented Lagrangian is gonna look like this.",
    "start": "230975",
    "end": "235850"
  },
  {
    "text": "It's actually going to look like the norm squared.",
    "start": "235850",
    "end": "238960"
  },
  {
    "text": "It's going to look like a non-linear least squares objective.",
    "start": "238960",
    "end": "241910"
  },
  {
    "text": "That's this first part.",
    "start": "241910",
    "end": "243410"
  },
  {
    "text": "Um, and then minus a weird term that depends on z.",
    "start": "243410",
    "end": "247855"
  },
  {
    "text": "Okay. Um, now let me make a couple of comments.",
    "start": "247855",
    "end": "250655"
  },
  {
    "text": "Oh, first of all, it reduces absolutely correctly to the- to the non-linear,",
    "start": "250655",
    "end": "256660"
  },
  {
    "text": "uh, to the penalty method, right?",
    "start": "256660",
    "end": "258290"
  },
  {
    "text": "When I take z equals 0,",
    "start": "258290",
    "end": "259790"
  },
  {
    "text": "this just reduces to the penalty method.",
    "start": "259790",
    "end": "261560"
  },
  {
    "text": "I think you'll see that, um,",
    "start": "261560",
    "end": "263195"
  },
  {
    "text": "because that's 0 and over here,",
    "start": "263195",
    "end": "265910"
  },
  {
    "text": "this is just the- it's- it's actually- it's- it's the stacked,",
    "start": "265910",
    "end": "269960"
  },
  {
    "text": "ah, norm squared expression for the objective.",
    "start": "269960",
    "end": "273949"
  },
  {
    "text": "Um, now, I can minimize, ah,",
    "start": "273950",
    "end": "277730"
  },
  {
    "text": "if I fix Mu and z,",
    "start": "277730",
    "end": "279605"
  },
  {
    "text": "I can minimize this Lagrangian over x.",
    "start": "279605",
    "end": "282820"
  },
  {
    "text": "Well, because I just minimize this.",
    "start": "282820",
    "end": "284510"
  },
  {
    "text": "And notice it's very close to what we were doing for the penalty method.",
    "start": "284510",
    "end": "288265"
  },
  {
    "text": "There's only this one little extra term, right?",
    "start": "288265",
    "end": "290630"
  },
  {
    "text": "So this is the sort of magic term that we're going to add to the second component.",
    "start": "290630",
    "end": "295170"
  },
  {
    "text": "It's the component, ah,",
    "start": "295170",
    "end": "296615"
  },
  {
    "text": "that corresponds to feasibility.",
    "start": "296615",
    "end": "298985"
  },
  {
    "text": "And instead of just say making this 0,",
    "start": "298985",
    "end": "301669"
  },
  {
    "text": "we're going to have this very cleverly chosen thing, uh, here.",
    "start": "301670",
    "end": "305680"
  },
  {
    "text": "Now, I haven't said what z is yet,",
    "start": "305680",
    "end": "307419"
  },
  {
    "text": "but we're going- we're going to decide what z should be shortly.",
    "start": "307420",
    "end": "311150"
  },
  {
    "start": "311000",
    "end": "400000"
  },
  {
    "text": "So that we're going to figure out from the optimality conditions.",
    "start": "311450",
    "end": "315950"
  },
  {
    "text": "So, um, the minimizer of the augmented Lagrangian, so in other words,",
    "start": "315950",
    "end": "320210"
  },
  {
    "text": "if I minimize this thing,",
    "start": "320210",
    "end": "322220"
  },
  {
    "text": "ah, it will be the solution of this, right? This thing.",
    "start": "322220",
    "end": "325830"
  },
  {
    "text": "If I minimize that over x,",
    "start": "325830",
    "end": "327620"
  },
  {
    "text": "the optimality condition for that is that- is this,",
    "start": "327620",
    "end": "332720"
  },
  {
    "text": "is if you work it out and see,",
    "start": "332720",
    "end": "334100"
  },
  {
    "text": "it's exactly this is Dg at, uh,",
    "start": "334100",
    "end": "336230"
  },
  {
    "text": "2 times, uh, the derivative of f at x transpose f of x and so on.",
    "start": "336230",
    "end": "341365"
  },
  {
    "text": "Um, and here you get the 2Mu g plus z equals 0.",
    "start": "341365",
    "end": "344979"
  },
  {
    "text": "So what we're gonna do is we're going to define z Tilde to be z plus 2 Mu g of x Tilde.",
    "start": "344980",
    "end": "351415"
  },
  {
    "text": "Um, then we can write this big thing up here as this.",
    "start": "351415",
    "end": "355625"
  },
  {
    "text": "Um, wow, that's awesome,",
    "start": "355625",
    "end": "358055"
  },
  {
    "text": "because that is actually this first equation.",
    "start": "358055",
    "end": "360275"
  },
  {
    "text": "Okay? Um, and what that",
    "start": "360275",
    "end": "363860"
  },
  {
    "text": "shows is that we have a similar thing with this augmented Lagrangian um,",
    "start": "363860",
    "end": "368030"
  },
  {
    "text": "as we do with a penalty method.",
    "start": "368030",
    "end": "370205"
  },
  {
    "text": "In other words, that with this choice of z,",
    "start": "370205",
    "end": "374044"
  },
  {
    "text": "here it is, z Tilde, ah,",
    "start": "374045",
    "end": "376055"
  },
  {
    "text": "it says that that- that the first condition that we",
    "start": "376055",
    "end": "378620"
  },
  {
    "text": "need for optimality just holds automatically,",
    "start": "378620",
    "end": "381095"
  },
  {
    "text": "and it's only the second, it's just feasibility we need.",
    "start": "381095",
    "end": "383660"
  },
  {
    "text": "So once you're close enough to feasible, you quit.",
    "start": "383660",
    "end": "386515"
  },
  {
    "text": "Okay. Um, and what this says is that if- if g of x Tilde is not small,",
    "start": "386515",
    "end": "393945"
  },
  {
    "text": "it suggests that z Tilde is a very good update.",
    "start": "393945",
    "end": "397035"
  },
  {
    "text": "That's this one, for z, um,",
    "start": "397035",
    "end": "399330"
  },
  {
    "text": "and that's- that actually describes the augmented Lagrangian method.",
    "start": "399330",
    "end": "402780"
  },
  {
    "start": "400000",
    "end": "584000"
  },
  {
    "text": "So here's the way it works.",
    "start": "402780",
    "end": "404730"
  },
  {
    "text": "Um, you set the next x to be the approximate minimizer of this expression.",
    "start": "404730",
    "end": "411020"
  },
  {
    "text": "Now, that- that actually is minimizing the augmented Lagrangian.",
    "start": "411020",
    "end": "415490"
  },
  {
    "text": "So the first step is you just simply minimize the augmented Lagrangian,",
    "start": "415490",
    "end": "419918"
  },
  {
    "text": "um, oh, with the previous value of z_k.",
    "start": "419919",
    "end": "423135"
  },
  {
    "text": "Um, and you use Levenberg-Marquardt starting from the initial point x_k.",
    "start": "423135",
    "end": "427215"
  },
  {
    "text": "Now, you do a multiplier update and you simply use this formula right here, right?",
    "start": "427215",
    "end": "431990"
  },
  {
    "text": "So- and that multiplier update, that- this one,",
    "start": "431990",
    "end": "435544"
  },
  {
    "text": "is the one that guarantees that as long as this algorithm runs,",
    "start": "435545",
    "end": "439280"
  },
  {
    "text": "the first optimality condition of the two just always holds.",
    "start": "439280",
    "end": "443495"
  },
  {
    "text": "Um, then we do a para- a penalty parameter update.",
    "start": "443495",
    "end": "448970"
  },
  {
    "text": "Now, in the uh,",
    "start": "448970",
    "end": "450830"
  },
  {
    "text": "penalty method, what you do is you increase Mu every single time.",
    "start": "450830",
    "end": "454444"
  },
  {
    "text": "You have to increase Mu,",
    "start": "454445",
    "end": "455690"
  },
  {
    "text": "otherwise you're not going to drive g to be 0.",
    "start": "455690",
    "end": "457810"
  },
  {
    "text": "Um, here though, you don't.",
    "start": "457810",
    "end": "460735"
  },
  {
    "text": "Ah, if for example, uh,",
    "start": "460735",
    "end": "463530"
  },
  {
    "text": "the- the- this is a measure of how feasible you are.",
    "start": "463530",
    "end": "466310"
  },
  {
    "text": "I should say how infeasible you are, right?",
    "start": "466310",
    "end": "468230"
  },
  {
    "text": "So this says, if you have made substantial progress in making it less feasible,",
    "start": "468230",
    "end": "474575"
  },
  {
    "text": "um, you, ah, you just keep the current Mu, it's fine, okay?",
    "start": "474575",
    "end": "480045"
  },
  {
    "text": "If that's not the case,",
    "start": "480045",
    "end": "481430"
  },
  {
    "text": "if you haven't made substantial progress, substantial progress,",
    "start": "481430",
    "end": "484169"
  },
  {
    "text": "we arbitrarily defined it to be dividing the-",
    "start": "484170",
    "end": "487140"
  },
  {
    "text": "the infeasibility resi- the residual by a factor of four.",
    "start": "487140",
    "end": "490940"
  },
  {
    "text": "If you don't, then you crank up Mu.",
    "start": "490940",
    "end": "493500"
  },
  {
    "text": "Ah, but notice that you have this thing, right?",
    "start": "493500",
    "end": "495810"
  },
  {
    "text": "That if- that- that- that's there,",
    "start": "495810",
    "end": "498080"
  },
  {
    "text": "that you don't increase it if you've- if you've automatically made progress towards,",
    "start": "498080",
    "end": "502759"
  },
  {
    "text": "um, driving the residual to 0.",
    "start": "502760",
    "end": "504805"
  },
  {
    "text": "Um, so the idea here is that Mu is increased only when needed,",
    "start": "504805",
    "end": "508780"
  },
  {
    "text": "and therefore it's more slow than in the penalty method.",
    "start": "508780",
    "end": "511670"
  },
  {
    "text": "Um, and you simply continue until g of x_k is, uh, sufficiently small.",
    "start": "511670",
    "end": "516860"
  },
  {
    "text": "That's- that's the method. Um, okay.",
    "start": "516860",
    "end": "519265"
  },
  {
    "text": "So, ah, let's see how it works on that same example as we looked at before.",
    "start": "519265",
    "end": "523715"
  },
  {
    "text": "Um, so here what happens is- is actually pretty amazing.",
    "start": "523715",
    "end": "528175"
  },
  {
    "text": "On the first step, we start with Mu equals 1,",
    "start": "528175",
    "end": "530615"
  },
  {
    "text": "z_1 equals 0, we get this point.",
    "start": "530615",
    "end": "532975"
  },
  {
    "text": "It turned out, um, we did not make prog- enough progress,",
    "start": "532975",
    "end": "536290"
  },
  {
    "text": "so we bump Mu to 2,",
    "start": "536290",
    "end": "538550"
  },
  {
    "text": "um, and then we get this point.",
    "start": "538550",
    "end": "540685"
  },
  {
    "text": "Um, well, ah, on the next one,",
    "start": "540685",
    "end": "544390"
  },
  {
    "text": "ah, that also did not make sufficient progress.",
    "start": "544390",
    "end": "546760"
  },
  {
    "text": "Sufficient progress mean- meant that we- the norm of g was reduced by a factor of 4,",
    "start": "546760",
    "end": "550870"
  },
  {
    "text": "and I mean, that was just a choice that we made.",
    "start": "550870",
    "end": "553025"
  },
  {
    "text": "Um, so here, now it,",
    "start": "553025",
    "end": "555540"
  },
  {
    "text": "ah, af- after it goes to 4,",
    "start": "555540",
    "end": "558100"
  },
  {
    "text": "you calculate something, and you can see right now on the third step,",
    "start": "558100",
    "end": "561550"
  },
  {
    "text": "you're- you're- you're very close to feasible.",
    "start": "561550",
    "end": "565190"
  },
  {
    "text": "So at that point, you're close enough to feasible,",
    "start": "565190",
    "end": "567680"
  },
  {
    "text": "and in fact you keep Mu at 4,",
    "start": "567680",
    "end": "569990"
  },
  {
    "text": "um, and you do just a couple more iterations.",
    "start": "569990",
    "end": "572584"
  },
  {
    "text": "And you've really got a very good solution here in,",
    "start": "572585",
    "end": "576050"
  },
  {
    "text": "I guess this is six steps.",
    "start": "576050",
    "end": "578180"
  },
  {
    "text": "So, um, so this appear- appears at least on",
    "start": "578180",
    "end": "581060"
  },
  {
    "text": "this baby example to work better than the so-called penalty method.",
    "start": "581060",
    "end": "585205"
  },
  {
    "start": "584000",
    "end": "826000"
  },
  {
    "text": "Okay? And so now this looks like this.",
    "start": "585205",
    "end": "588060"
  },
  {
    "text": "Um, it, ah, it takes us down to 10 to the minus 4.",
    "start": "588060",
    "end": "593055"
  },
  {
    "text": "Uh, pretty quickly again,",
    "start": "593055",
    "end": "594410"
  },
  {
    "text": "using the two components of- of this after the first step,",
    "start": "594410",
    "end": "597899"
  },
  {
    "text": "ah, which also takes like 50-odd iterations.",
    "start": "597900",
    "end": "601290"
  },
  {
    "text": "Um, the- the sec- the second- the first- the first optimality condition is satisfied,",
    "start": "601290",
    "end": "605980"
  },
  {
    "text": "and then we'll just weight for feasibility, and it  looks like that.",
    "start": "605980",
    "end": "608620"
  },
  {
    "text": "Um, here's what's very cool,",
    "start": "608620",
    "end": "610400"
  },
  {
    "text": "is if you look at the penalty parameter,",
    "start": "610400",
    "end": "612110"
  },
  {
    "text": "um, the other one went up to 10,000.",
    "start": "612110",
    "end": "615185"
  },
  {
    "text": "Here, it goes up to 4 and stops.",
    "start": "615185",
    "end": "618305"
  },
  {
    "text": "Um, so that is actually the idea behind the augmented Lagrangian method.",
    "start": "618305",
    "end": "623960"
  },
  {
    "text": "Yeah. Oh, I should say that, um, you know,",
    "start": "623960",
    "end": "627570"
  },
  {
    "text": "there's whole courses on- on- on solving,",
    "start": "627570",
    "end": "630785"
  },
  {
    "text": "you know, so-called non-linear optimization problems.",
    "start": "630785",
    "end": "633745"
  },
  {
    "text": "And maybe you'll take one, maybe you won't.",
    "start": "633745",
    "end": "636490"
  },
  {
    "text": "Um, the truth is most nor- most normal people",
    "start": "636490",
    "end": "638990"
  },
  {
    "text": "do not need to know the details of all these algorithms.",
    "start": "638990",
    "end": "641274"
  },
  {
    "text": "Most normal people access these by",
    "start": "641275",
    "end": "644255"
  },
  {
    "text": "software packages that implement things like Levenberg-Marquardt or other algorithms.",
    "start": "644255",
    "end": "649255"
  },
  {
    "text": "Um, still, it's good for you to know,",
    "start": "649255",
    "end": "651930"
  },
  {
    "text": "ah, it's good for you to know like what's inside some of these packages.",
    "start": "651930",
    "end": "655730"
  },
  {
    "text": "Um, and these are not so bad that you couldn't,",
    "start": "655730",
    "end": "657829"
  },
  {
    "text": "ah, you couldn't write them yourself.",
    "start": "657830",
    "end": "659750"
  },
  {
    "text": "I mean, these are- these are pretty straightforward.",
    "start": "659750",
    "end": "662520"
  },
  {
    "text": "We're gonna finish with,",
    "start": "664710",
    "end": "667180"
  },
  {
    "text": "er, one example, um, just to show what it is.",
    "start": "667180",
    "end": "670435"
  },
  {
    "text": "And it is a simple model of a car.",
    "start": "670435",
    "end": "674005"
  },
  {
    "text": "Um, and so it's- what we're gonna do is,",
    "start": "674005",
    "end": "677590"
  },
  {
    "text": "so let me- let me get the model.",
    "start": "677590",
    "end": "679435"
  },
  {
    "text": "So um, the model is- here's a picture of the car",
    "start": "679435",
    "end": "683350"
  },
  {
    "text": "in- in- in I guess in blue schematic here.",
    "start": "683350",
    "end": "687940"
  },
  {
    "text": "Um, and you can see here the steering angle, that's theta.",
    "start": "687940",
    "end": "691480"
  },
  {
    "text": "So sorry, that's not theta.",
    "start": "691480",
    "end": "692935"
  },
  {
    "text": "Theta is the orientation of the vehicle, right?",
    "start": "692935",
    "end": "696760"
  },
  {
    "text": "So what we'll do is we'll say,",
    "start": "696760",
    "end": "698780"
  },
  {
    "text": "um, p is the position,",
    "start": "698780",
    "end": "700470"
  },
  {
    "text": "say of the center of the car.",
    "start": "700470",
    "end": "702045"
  },
  {
    "text": "Um, s of t is the speed of the vehicle,",
    "start": "702045",
    "end": "705019"
  },
  {
    "text": "um, that's the speed.",
    "start": "705020",
    "end": "706930"
  },
  {
    "text": "Um, and then phi of t is the steering angle.",
    "start": "706930",
    "end": "709120"
  },
  {
    "text": "The steering angle is defined as the angle of the front wheels,",
    "start": "709120",
    "end": "712150"
  },
  {
    "text": "er, compared to the orientation of the car.",
    "start": "712150",
    "end": "714580"
  },
  {
    "text": "So that's- that's illustrated here and the orientation of",
    "start": "714580",
    "end": "717670"
  },
  {
    "text": "the car is the angle of the car relative to,",
    "start": "717670",
    "end": "721135"
  },
  {
    "text": "I would say horizontal but cars don't drive up and down.",
    "start": "721135",
    "end": "723550"
  },
  {
    "text": "So whatever we decided to- this axis to be,",
    "start": "723550",
    "end": "726714"
  },
  {
    "text": "maybe that's due, let's say that that's due East or something, right?",
    "start": "726715",
    "end": "730510"
  },
  {
    "text": "So it's the number of degrees North,",
    "start": "730510",
    "end": "733480"
  },
  {
    "text": "er, compared to a due East heading.",
    "start": "733480",
    "end": "736045"
  },
  {
    "text": "Okay. So- and here's the model, um,",
    "start": "736045",
    "end": "739630"
  },
  {
    "text": "it's usually given in a- in a continuous time,",
    "start": "739630",
    "end": "742885"
  },
  {
    "text": "er, you know, continuous time way to say it.",
    "start": "742885",
    "end": "745570"
  },
  {
    "text": "And it's this, er,",
    "start": "745570",
    "end": "747790"
  },
  {
    "text": "let's see if we can even try to figure this out.",
    "start": "747790",
    "end": "749860"
  },
  {
    "text": "So um, so dp_1 means how far does the car go in- in- in sort of- in this direction.",
    "start": "749860",
    "end": "757120"
  },
  {
    "text": "Er, what's its speed?",
    "start": "757120",
    "end": "759145"
  },
  {
    "text": "and that's going to be it's speed which is a scalar,",
    "start": "759145",
    "end": "761230"
  },
  {
    "text": "a positive scalar which is s of t,",
    "start": "761230",
    "end": "763345"
  },
  {
    "text": "sorry doesn't have to be positive, s can be negative.",
    "start": "763345",
    "end": "766254"
  },
  {
    "text": "Um, that corresponds to the car, er,",
    "start": "766255",
    "end": "768100"
  },
  {
    "text": "backing up, so s can be negative my apologies.",
    "start": "768100",
    "end": "771024"
  },
  {
    "text": "Okay. Um, times cosine theta of t, make that, make sense.",
    "start": "771025",
    "end": "775465"
  },
  {
    "text": "Dp_2 dt is s of t the speed times sine theta of t. Theta is the- is the,",
    "start": "775465",
    "end": "781330"
  },
  {
    "text": "er, vehicle, er, orientation.",
    "start": "781330",
    "end": "783355"
  },
  {
    "text": "Um, and then you have this one, uh,",
    "start": "783355",
    "end": "787014"
  },
  {
    "text": "d theta dt that is the change in orientation is equal to s of t",
    "start": "787015",
    "end": "792535"
  },
  {
    "text": "that's the speed [NOISE] divided by L. L is the length of the wheel base,",
    "start": "792535",
    "end": "798625"
  },
  {
    "text": "um, times the tangent of phi of t,",
    "start": "798625",
    "end": "801265"
  },
  {
    "text": "so tangent of the steering angle.",
    "start": "801265",
    "end": "803590"
  },
  {
    "text": "Okay. This has got a name.",
    "start": "803590",
    "end": "805600"
  },
  {
    "text": "[NOISE] I think this is called the Dubins model of a car,",
    "start": "805600",
    "end": "809769"
  },
  {
    "text": "er, but don't- don't quote me on that.",
    "start": "809770",
    "end": "811855"
  },
  {
    "text": "It doesn't matter because it's a very simple model of car motion.",
    "start": "811855",
    "end": "815725"
  },
  {
    "text": "Okay. And what we'll do is we'll look at a problem where your job",
    "start": "815725",
    "end": "819714"
  },
  {
    "text": "is to choose the speed and steering angle, as a function of time.",
    "start": "819715",
    "end": "823720"
  },
  {
    "text": "[NOISE] Okay.",
    "start": "823720",
    "end": "827004"
  },
  {
    "start": "826000",
    "end": "923000"
  },
  {
    "text": "So we're going to discretize it, um,",
    "start": "827005",
    "end": "830585"
  },
  {
    "text": "and we'll do that by taking a small time interval",
    "start": "830585",
    "end": "834085"
  },
  {
    "text": "h. And we'll simply say that the new position is the current position plus h,",
    "start": "834085",
    "end": "838585"
  },
  {
    "text": "times the velocity or the- the derivative at the previous time stamp.",
    "start": "838585",
    "end": "843145"
  },
  {
    "text": "And so this is very common.",
    "start": "843145",
    "end": "844945"
  },
  {
    "text": "Um, this [NOISE] simple discretization method is called- so called Forward Euler,",
    "start": "844945",
    "end": "850975"
  },
  {
    "text": "Euler after the famous mathematician Euler.",
    "start": "850975",
    "end": "853375"
  },
  {
    "text": "Um, if you take a course on differential equations and numerical treatment of them,",
    "start": "853375",
    "end": "858205"
  },
  {
    "text": "you'll find out that this is an incredibly unsophisticated discretization",
    "start": "858205",
    "end": "862420"
  },
  {
    "text": "and there are way better ones.",
    "start": "862420",
    "end": "863769"
  },
  {
    "text": "Nevertheless this one is just fine it's",
    "start": "863770",
    "end": "865480"
  },
  {
    "text": "just- and it's the one that's kinda the most obvious.",
    "start": "865480",
    "end": "868240"
  },
  {
    "text": "Um, so we'll define an input vector u [NOISE] it's going to have two components,",
    "start": "868240",
    "end": "873760"
  },
  {
    "text": "um, but at each time step and it's going to be s of kh, the speed,",
    "start": "873760",
    "end": "877810"
  },
  {
    "text": "er, and the steering angle.",
    "start": "877810",
    "end": "879250"
  },
  {
    "text": "[NOISE] And we'll make a state vector, we'll call that x_k.",
    "start": "879250",
    "end": "883780"
  },
  {
    "text": "It's going to be your two positions and your orientation.",
    "start": "883780",
    "end": "887005"
  },
  {
    "text": "So that's the state of the car.",
    "start": "887005",
    "end": "889975"
  },
  {
    "text": "And then the discretized model looks like this,",
    "start": "889975",
    "end": "892675"
  },
  {
    "text": "x_k plus 1 the new state is f of x_k,",
    "start": "892675",
    "end": "895615"
  },
  {
    "text": "u_k and f of x_k,",
    "start": "895615",
    "end": "897355"
  },
  {
    "text": "u_k is this, er, this function here.",
    "start": "897355",
    "end": "901435"
  },
  {
    "text": "Um, that's a complicated function from r3 to r3.",
    "start": "901435",
    "end": "905185"
  },
  {
    "text": "Um, well, actually sorry x_k is r3 it's actually",
    "start": "905185",
    "end": "908710"
  },
  {
    "text": "from r5 to r3 because that's three vectors and that's two.",
    "start": "908710",
    "end": "913690"
  },
  {
    "text": "So this tells you how your next position and",
    "start": "913690",
    "end": "916780"
  },
  {
    "text": "your next orientation depends on how you set the steering angle,",
    "start": "916780",
    "end": "920245"
  },
  {
    "text": "and what speed you choose for- at that- at that time.",
    "start": "920245",
    "end": "923930"
  },
  {
    "start": "923000",
    "end": "1191000"
  },
  {
    "text": "Okay. Now we'll look at a control problem.",
    "start": "924330",
    "end": "928360"
  },
  {
    "text": "Er, and the problem is two move the car from a given initial,",
    "start": "928360",
    "end": "931599"
  },
  {
    "text": "er, to a desired final position and orientation.",
    "start": "931599",
    "end": "934945"
  },
  {
    "text": "So um, and we also want a small and slowly varying input sequence, right?",
    "start": "934945",
    "end": "941890"
  },
  {
    "text": "so we don't want gigantic speeds and things like that.",
    "start": "941890",
    "end": "945250"
  },
  {
    "text": "We also don't want you- the- the speed or",
    "start": "945250",
    "end": "947530"
  },
  {
    "text": "the steering angle to change abruptly so we want that smooth.",
    "start": "947530",
    "end": "950800"
  },
  {
    "text": "And so we'll make a second strain non-linear least squares problem.",
    "start": "950800",
    "end": "954084"
  },
  {
    "text": "Um, we're going to er, minimize the sum of the norms of u squared er,",
    "start": "954085",
    "end": "958990"
  },
  {
    "text": "plus gamma times a smoothness constraint on- on- on u.",
    "start": "958990",
    "end": "964180"
  },
  {
    "text": "This is a- actually this is nice that's- that's-",
    "start": "964180",
    "end": "968665"
  },
  {
    "text": "this thing is completely- that- that",
    "start": "968665",
    "end": "971079"
  },
  {
    "text": "is at least linear least squares or something like that.",
    "start": "971080",
    "end": "973675"
  },
  {
    "text": "Um, and now we have the constraints which are not linear",
    "start": "973675",
    "end": "977709"
  },
  {
    "text": "and they are [NOISE] we- we insist,",
    "start": "977710",
    "end": "981940"
  },
  {
    "text": "er, that the final state,",
    "start": "981940",
    "end": "985375"
  },
  {
    "text": "er, that the final one has to equal this thing.",
    "start": "985375",
    "end": "988255"
  },
  {
    "text": "And we would have, er,",
    "start": "988255",
    "end": "990685"
  },
  {
    "text": "here f of- this says this is the state equation, right?",
    "start": "990685",
    "end": "994855"
  },
  {
    "text": "This says that x_k plus 1 is f of x_k, u_k.",
    "start": "994855",
    "end": "998260"
  },
  {
    "text": "Um, and here, er,",
    "start": "998260",
    "end": "1000285"
  },
  {
    "text": "we're starting from, er,",
    "start": "1000285",
    "end": "1003420"
  },
  {
    "text": "this doesn't look right.",
    "start": "1003420",
    "end": "1005925"
  },
  {
    "text": "This should say that the initial- the initial state should be x_init, right?",
    "start": "1005925",
    "end": "1011370"
  },
  {
    "text": "that's- I suspect what that is supposed to say.",
    "start": "1011370",
    "end": "1013680"
  },
  {
    "text": "So that should be x_init equals,",
    "start": "1013680",
    "end": "1018585"
  },
  {
    "text": "um, and then x_1,",
    "start": "1018585",
    "end": "1021960"
  },
  {
    "text": "er, I suspect I'm not- not quite sure what that is.",
    "start": "1021960",
    "end": "1025319"
  },
  {
    "text": "Okay. So if we run the augmented Lagrangian method,",
    "start": "1025320",
    "end": "1030524"
  },
  {
    "text": "um, it actually comes up with a- with- with a,",
    "start": "1030525",
    "end": "1033089"
  },
  {
    "text": "um, with a trajectory.",
    "start": "1033090",
    "end": "1035339"
  },
  {
    "text": "Um, and it's a pretty sophisticated trajectory,",
    "start": "1035340",
    "end": "1038865"
  },
  {
    "text": "um, and here we're given- we're- we're giving you various things.",
    "start": "1038865",
    "end": "1043679"
  },
  {
    "text": "I think in all of these the initial state, um,",
    "start": "1043680",
    "end": "1048569"
  },
  {
    "text": "is maybe zero or maybe- maybe that was this,",
    "start": "1048570",
    "end": "1051840"
  },
  {
    "text": "er, 0 and u_1 I'm not sure what that's about.",
    "start": "1051840",
    "end": "1055409"
  },
  {
    "text": "But, um, here x_1 perhaps the initial state is- is- is just,",
    "start": "1055410",
    "end": "1060885"
  },
  {
    "text": "um, here starting from 0, okay?",
    "start": "1060885",
    "end": "1064815"
  },
  {
    "text": "Um, so here see if we can figure that out.",
    "start": "1064815",
    "end": "1067500"
  },
  {
    "text": "Yes so it looks like you start here, right?",
    "start": "1067500",
    "end": "1070335"
  },
  {
    "text": "and then, er, this is getting you- you have to get",
    "start": "1070335",
    "end": "1072899"
  },
  {
    "text": "over to- get over to here and you do, right?",
    "start": "1072900",
    "end": "1075660"
  },
  {
    "text": "because the final state is 0, 1, 0.",
    "start": "1075660",
    "end": "1078660"
  },
  {
    "text": "Um, and that means that your- your,",
    "start": "1078660",
    "end": "1081060"
  },
  {
    "text": "er, orientation, er, is still, er,",
    "start": "1081060",
    "end": "1084150"
  },
  {
    "text": "is still the same, it's 0, it's looking due East, um,",
    "start": "1084150",
    "end": "1087510"
  },
  {
    "text": "and your position goes from 0,",
    "start": "1087510",
    "end": "1089190"
  },
  {
    "text": "0 to 0, 1 which is right here.",
    "start": "1089190",
    "end": "1091965"
  },
  {
    "text": "Um, I'm pretty sure by the way this involves backing up.",
    "start": "1091965",
    "end": "1094875"
  },
  {
    "text": "We'll- we'll check if that's the case in this one.",
    "start": "1094875",
    "end": "1097065"
  },
  {
    "text": "Um, here's for another final condition.",
    "start": "1097065",
    "end": "1099450"
  },
  {
    "text": "This is where you're here,",
    "start": "1099450",
    "end": "1101100"
  },
  {
    "text": "you start here pointing that direction,",
    "start": "1101100",
    "end": "1103679"
  },
  {
    "text": "and what you wanna do is you want to be up here,",
    "start": "1103680",
    "end": "1105645"
  },
  {
    "text": "you want to be up at the same position,",
    "start": "1105645",
    "end": "1107025"
  },
  {
    "text": "but you want to be pointed due North.",
    "start": "1107025",
    "end": "1108900"
  },
  {
    "text": "Um, and that would be this one.",
    "start": "1108900",
    "end": "1110370"
  },
  {
    "text": "And that one- and that one you take- you take off",
    "start": "1110370",
    "end": "1112559"
  },
  {
    "text": "driving well in- in forward not reverse,",
    "start": "1112560",
    "end": "1115995"
  },
  {
    "text": "and you simply go up- up to there and through that.",
    "start": "1115995",
    "end": "1119025"
  },
  {
    "text": "Um, here's a crazy one,",
    "start": "1119025",
    "end": "1120705"
  },
  {
    "text": "if I say x_final is 0.5 and 0,",
    "start": "1120705",
    "end": "1124695"
  },
  {
    "text": "it means you want to be here and the trajectory found is actually kinda cool.",
    "start": "1124695",
    "end": "1129585"
  },
  {
    "text": "What it does is, it- it goes back- it goes in reverse,",
    "start": "1129585",
    "end": "1132149"
  },
  {
    "text": "it backs up, slows down,",
    "start": "1132150",
    "end": "1134250"
  },
  {
    "text": "stops, then comes out in forward,",
    "start": "1134250",
    "end": "1137520"
  },
  {
    "text": "er, and ends up where it's supposed to be.",
    "start": "1137520",
    "end": "1139680"
  },
  {
    "text": "So that's a pretty fancy driving maneuver if you don't mind my saying so and it's",
    "start": "1139680",
    "end": "1143730"
  },
  {
    "text": "kinda crazy that this- just running the augmented Lagrangian thing finds that.",
    "start": "1143730",
    "end": "1147929"
  },
  {
    "text": "Um, here's another one where, er,",
    "start": "1147930",
    "end": "1151185"
  },
  {
    "text": "you start here and you want to end up at the point 0.5,",
    "start": "1151185",
    "end": "1154665"
  },
  {
    "text": "0.5 and minus Pi over 2,",
    "start": "1154665",
    "end": "1156930"
  },
  {
    "text": "and so that means, er, pointed down this way.",
    "start": "1156930",
    "end": "1160020"
  },
  {
    "text": "And so the way you do that is you drive forward here,",
    "start": "1160020",
    "end": "1163260"
  },
  {
    "text": "you stop, and then you simply backup along here.",
    "start": "1163260",
    "end": "1166335"
  },
  {
    "text": "So these are pretty crazy trajectories, right?",
    "start": "1166335",
    "end": "1169274"
  },
  {
    "text": "Um, So by the way I should add that, um,",
    "start": "1169275",
    "end": "1172695"
  },
  {
    "text": "people do find trajectories for cars,",
    "start": "1172695",
    "end": "1175889"
  },
  {
    "text": "um, you know, this way or ways that look like this.",
    "start": "1175890",
    "end": "1179445"
  },
  {
    "text": "Um, so this is done for, you know,",
    "start": "1179445",
    "end": "1181370"
  },
  {
    "text": "sort of self-driving cars,",
    "start": "1181370",
    "end": "1183155"
  },
  {
    "text": "auto parking, all sorts of other crazy stuff.",
    "start": "1183155",
    "end": "1185945"
  },
  {
    "text": "They do something that's equivalent to this",
    "start": "1185945",
    "end": "1187924"
  },
  {
    "text": "it's actually probably pretty close to just this.",
    "start": "1187925",
    "end": "1191220"
  },
  {
    "start": "1191000",
    "end": "1302000"
  },
  {
    "text": "So here are the inputs for these four,",
    "start": "1192410",
    "end": "1195555"
  },
  {
    "text": "we can take one and try to figure it out.",
    "start": "1195555",
    "end": "1197565"
  },
  {
    "text": "Um, let's- let's take this last one here.",
    "start": "1197565",
    "end": "1199799"
  },
  {
    "text": "So this says that over your 50 steps or so, um,",
    "start": "1199800",
    "end": "1203760"
  },
  {
    "text": "you start with, er, some speed,",
    "start": "1203760",
    "end": "1206535"
  },
  {
    "text": "kind of keep up that speed and then sort of in the middle, the speed goes down 0.",
    "start": "1206535",
    "end": "1210060"
  },
  {
    "text": "And then negative speed means you've gone into reverse and so on.",
    "start": "1210060",
    "end": "1213720"
  },
  {
    "text": "And then the steering angle should look like this at 0.",
    "start": "1213720",
    "end": "1216270"
  },
  {
    "text": "Then you- you turn hard to the- I suppose that's the right.",
    "start": "1216270",
    "end": "1220485"
  },
  {
    "text": "Um, you would turn the steering wheel to the right,",
    "start": "1220485",
    "end": "1222975"
  },
  {
    "text": "hardest steer, then right at that point when you- when you go through zero velocity",
    "start": "1222975",
    "end": "1226950"
  },
  {
    "text": "your steering wheel is straight then you turn it the",
    "start": "1226950",
    "end": "1228840"
  },
  {
    "text": "other way to the left, and that's this thing.",
    "start": "1228840",
    "end": "1231075"
  },
  {
    "text": "And let's see if that kinda makes sense for this one and I think it does",
    "start": "1231075",
    "end": "1233909"
  },
  {
    "text": "because what it is is you drive- you drive straight here,",
    "start": "1233910",
    "end": "1237075"
  },
  {
    "text": "you slow down, you stop there.",
    "start": "1237075",
    "end": "1239490"
  },
  {
    "text": "So you've turned the wheel to the right, er,",
    "start": "1239490",
    "end": "1241485"
  },
  {
    "text": "now right at the end your wheel is straight,",
    "start": "1241485",
    "end": "1244890"
  },
  {
    "text": "it's- it's at 0.",
    "start": "1244890",
    "end": "1246390"
  },
  {
    "text": "Then you start negative speed which means you back- this is backing up.",
    "start": "1246390",
    "end": "1251535"
  },
  {
    "text": "And when you backup here, er,",
    "start": "1251535",
    "end": "1253500"
  },
  {
    "text": "you're- you're turning the wheel this is to the left in order",
    "start": "1253500",
    "end": "1258120"
  },
  {
    "text": "to backup and sure enough that is exactly what happens here, right?",
    "start": "1258120",
    "end": "1262650"
  },
  {
    "text": "So it's pretty cool I mean that- that- that just this dumb algorithm can- can- can find,",
    "start": "1262650",
    "end": "1268440"
  },
  {
    "text": "you know, pretty sophisticated, um,",
    "start": "1268440",
    "end": "1270884"
  },
  {
    "text": "trajectories of maneuvers, er,",
    "start": "1270885",
    "end": "1272415"
  },
  {
    "text": "for- for our car.",
    "start": "1272415",
    "end": "1273870"
  },
  {
    "text": "So this is just to show that this stuff we put",
    "start": "1273870",
    "end": "1275910"
  },
  {
    "text": "together it's-it's not simple, it's not obvious.",
    "start": "1275910",
    "end": "1280155"
  },
  {
    "text": "Um, I mean, if you didn't know any of this,",
    "start": "1280155",
    "end": "1283200"
  },
  {
    "text": "this would be insuperable.",
    "start": "1283200",
    "end": "1284835"
  },
  {
    "text": "I mean, how would you make- what you do-",
    "start": "1284835",
    "end": "1286904"
  },
  {
    "text": "I- I didn't even know how you would do this if someone said,",
    "start": "1286905",
    "end": "1289065"
  },
  {
    "text": "oh, make me something that auto parks a car or",
    "start": "1289065",
    "end": "1291179"
  },
  {
    "text": "something like this, where would you begin?",
    "start": "1291180",
    "end": "1293670"
  },
  {
    "text": "And the answer is this is a pretty important component, er, of it.",
    "start": "1293670",
    "end": "1297730"
  }
]