[
  {
    "start": "0",
    "end": "6000"
  },
  {
    "start": "0",
    "end": "5370"
  },
  {
    "text": "All right, in this\nmodule, I'm going",
    "start": "5370",
    "end": "6870"
  },
  {
    "start": "6000",
    "end": "14000"
  },
  {
    "text": "to talk about k-means, a simple\nalgorithm for clustering,",
    "start": "6870",
    "end": "10590"
  },
  {
    "text": "one form of\nunsupervised learning.",
    "start": "10590",
    "end": "13930"
  },
  {
    "text": "So I want to start with\na classical example",
    "start": "13930",
    "end": "16590"
  },
  {
    "start": "14000",
    "end": "104000"
  },
  {
    "text": "of clustering from the NLP\nliterature around clustering.",
    "start": "16590",
    "end": "20920"
  },
  {
    "text": "So this was the unsupervised\nlearning method of choice",
    "start": "20920",
    "end": "24480"
  },
  {
    "text": "before word vector or\ncontextualized word and so on.",
    "start": "24480",
    "end": "30320"
  },
  {
    "text": "So the input to the\nalgorithm was simply",
    "start": "30320",
    "end": "32560"
  },
  {
    "text": "raw text, lots and lots\nof words of news articles.",
    "start": "32560",
    "end": "36250"
  },
  {
    "text": "And the output was a\nclustering of those words.",
    "start": "36250",
    "end": "40670"
  },
  {
    "text": "So the algorithm was able\nto pick out a cluster",
    "start": "40670",
    "end": "43929"
  },
  {
    "text": "1, which is Friday,\nMonday, Thursday",
    "start": "43930",
    "end": "46900"
  },
  {
    "text": "and, generally,\ndays of the week.",
    "start": "46900",
    "end": "49170"
  },
  {
    "text": "Cluster 2 had months.",
    "start": "49170",
    "end": "51609"
  },
  {
    "text": "Cluster 3 had some sort\nof natural resources",
    "start": "51610",
    "end": "54760"
  },
  {
    "text": "and you can list.",
    "start": "54760",
    "end": "56530"
  },
  {
    "text": "And each cluster had barely\ncoherent structure in it.",
    "start": "56530",
    "end": "64220"
  },
  {
    "text": "The one thing that's\nquite interesting to note",
    "start": "64220",
    "end": "66900"
  },
  {
    "text": "is that no one told\nthis algorithm what",
    "start": "66900",
    "end": "70170"
  },
  {
    "text": "days of the week,\nor what months are,",
    "start": "70170",
    "end": "71850"
  },
  {
    "text": "or what family relations are.",
    "start": "71850",
    "end": "73950"
  },
  {
    "text": "It was able to simply figure\nit all the stuff out just",
    "start": "73950",
    "end": "77430"
  },
  {
    "text": "by looking at the data.",
    "start": "77430",
    "end": "80100"
  },
  {
    "text": "Well, on a personal\nnote, Brown clustering",
    "start": "80100",
    "end": "82260"
  },
  {
    "text": "was actually my\nfirst experience that",
    "start": "82260",
    "end": "84390"
  },
  {
    "text": "got me to pursue research\nin NLP in the first place.",
    "start": "84390",
    "end": "87330"
  },
  {
    "text": "Seeing the results of\nunsupervised learning, when",
    "start": "87330",
    "end": "90360"
  },
  {
    "text": "it worked, was kind\nof really magical.",
    "start": "90360",
    "end": "93120"
  },
  {
    "text": "And, of course,\ntoday we're seeing",
    "start": "93120",
    "end": "94770"
  },
  {
    "text": "even more strong evidence\nof the sheer potential",
    "start": "94770",
    "end": "97619"
  },
  {
    "text": "of unsupervised learning with a\nlanguage model with attention.",
    "start": "97620",
    "end": "101868"
  },
  {
    "start": "101868",
    "end": "104619"
  },
  {
    "start": "104000",
    "end": "142000"
  },
  {
    "text": "So I want to contrast--",
    "start": "104620",
    "end": "107410"
  },
  {
    "text": "do unsupervised learning\nand supervised learning.",
    "start": "107410",
    "end": "110690"
  },
  {
    "text": "So in supervised learning,\nwe looked at classification.",
    "start": "110690",
    "end": "114520"
  },
  {
    "text": "You're given a training\nset, which is labeled.",
    "start": "114520",
    "end": "117700"
  },
  {
    "text": "So inputs are labeled\nwith an output y.",
    "start": "117700",
    "end": "121360"
  },
  {
    "text": "This goes into a\nlearning algorithm.",
    "start": "121360",
    "end": "122860"
  },
  {
    "text": "You get a classifier, and then\nyou [INAUDIBLE] new points.",
    "start": "122860",
    "end": "128259"
  },
  {
    "text": "And then the main challenge\nwith the labeled data",
    "start": "128259",
    "end": "132220"
  },
  {
    "text": "is that labeled data\nis expensive to obtain.",
    "start": "132220",
    "end": "134470"
  },
  {
    "text": "You have to have it annotated,\noften domain experts had.",
    "start": "134470",
    "end": "141730"
  },
  {
    "text": "So in contrast,\nunsupervised learning,",
    "start": "141730",
    "end": "147099"
  },
  {
    "start": "142000",
    "end": "216000"
  },
  {
    "text": "of which clustering\nis a form of,",
    "start": "147100",
    "end": "150550"
  },
  {
    "text": "uses unlabeled data that's\na very cheap to obtain.",
    "start": "150550",
    "end": "154980"
  },
  {
    "text": "So as a concrete\nexample, suppose",
    "start": "154980",
    "end": "157470"
  },
  {
    "text": "you have some points here, and\nthey're just unlabeled points.",
    "start": "157470",
    "end": "164490"
  },
  {
    "text": "Any data can be\n[INAUDIBLE] here.",
    "start": "164490",
    "end": "166350"
  },
  {
    "text": "There's the points.",
    "start": "166350",
    "end": "168570"
  },
  {
    "text": "And we want a learning\nalgorithm that",
    "start": "168570",
    "end": "170850"
  },
  {
    "text": "can produce, not a predictor,\nbut an assignment of each point",
    "start": "170850",
    "end": "176550"
  },
  {
    "text": "to a cluster--",
    "start": "176550",
    "end": "178410"
  },
  {
    "text": "two clusters.",
    "start": "178410",
    "end": "179890"
  },
  {
    "text": "So let's assign the\nfirst four points--",
    "start": "179890",
    "end": "184200"
  },
  {
    "text": "the blue cluster.",
    "start": "184200",
    "end": "186510"
  },
  {
    "text": "Here are the four\npoints, blue cluster,",
    "start": "186510",
    "end": "189060"
  },
  {
    "text": "and the second set of\npoints to the orange cluster",
    "start": "189060",
    "end": "193890"
  },
  {
    "text": "for the point set.",
    "start": "193890",
    "end": "195107"
  },
  {
    "start": "195107",
    "end": "197730"
  },
  {
    "text": "So intuitively, we want\nto assign nearby points",
    "start": "197730",
    "end": "202230"
  },
  {
    "text": "to the same cluster.",
    "start": "202230",
    "end": "203760"
  },
  {
    "text": "And you can kind of\nsee that these points",
    "start": "203760",
    "end": "205650"
  },
  {
    "text": "are closer to each other.",
    "start": "205650",
    "end": "207000"
  },
  {
    "text": "And these points are closer\ntogether and on separation",
    "start": "207000",
    "end": "212205"
  },
  {
    "text": "clusters here.",
    "start": "212205",
    "end": "213210"
  },
  {
    "start": "213210",
    "end": "216160"
  },
  {
    "start": "216000",
    "end": "254000"
  },
  {
    "text": "So more formally, the\ntask of clustering",
    "start": "216160",
    "end": "218980"
  },
  {
    "text": "is you're given some\ntraining points, D train.",
    "start": "218980",
    "end": "221860"
  },
  {
    "text": "And this is a list\nof points under Xn.",
    "start": "221860",
    "end": "225700"
  },
  {
    "text": "And the output is an assignment\nof each point to a cluster.",
    "start": "225700",
    "end": "230800"
  },
  {
    "text": "Formally, we have an\nassignment vector,",
    "start": "230800",
    "end": "234350"
  },
  {
    "text": "which is described z1\nall the way through zn,",
    "start": "234350",
    "end": "238690"
  },
  {
    "text": "where each zi is\nan element from--",
    "start": "238690",
    "end": "243190"
  },
  {
    "text": "is a number between\n1 and K. So assuming",
    "start": "243190",
    "end": "247310"
  },
  {
    "text": "we have big K\nclusters, each point",
    "start": "247310",
    "end": "249830"
  },
  {
    "text": "is assigned to one of them.",
    "start": "249830",
    "end": "251330"
  },
  {
    "start": "251330",
    "end": "255790"
  },
  {
    "start": "254000",
    "end": "327000"
  },
  {
    "text": "So what makes a cluster?",
    "start": "255790",
    "end": "259278"
  },
  {
    "text": "The key assumption\nbehind k-means",
    "start": "259279",
    "end": "263960"
  },
  {
    "text": "is that each cluster can\nbe represented vaguely",
    "start": "263960",
    "end": "267470"
  },
  {
    "text": "by a centroid, denoted mu k.",
    "start": "267470",
    "end": "270930"
  },
  {
    "text": "And we're going to concatenate\nall the centroids together",
    "start": "270930",
    "end": "273500"
  },
  {
    "text": "to form a--",
    "start": "273500",
    "end": "276800"
  },
  {
    "text": "So this diagram\nillustrates what a centroid",
    "start": "276800",
    "end": "279379"
  },
  {
    "text": "is trying to capture.",
    "start": "279380",
    "end": "280910"
  },
  {
    "text": "The centroid is, in\nsome sense, a point,",
    "start": "280910",
    "end": "285480"
  },
  {
    "text": "which is closest to all the\nother points in that cluster,",
    "start": "285480",
    "end": "289265"
  },
  {
    "text": "so it represents a cluster by\nsome concrete point in space--",
    "start": "289265",
    "end": "294950"
  },
  {
    "text": "centroid.",
    "start": "294950",
    "end": "296550"
  },
  {
    "text": "So the intuition in\nterms of centroid",
    "start": "296550",
    "end": "299069"
  },
  {
    "text": "is that we want each point\nto be close to its assigned",
    "start": "299070",
    "end": "304080"
  },
  {
    "text": "centroid--",
    "start": "304080",
    "end": "305139"
  },
  {
    "text": "u of zi's, bit of notation,\nwhich we'll go through later.",
    "start": "305140",
    "end": "309330"
  },
  {
    "text": "But intuitively, you can\nlook at this point over here.",
    "start": "309330",
    "end": "312990"
  },
  {
    "text": "We want this point to be close\nto the centroid of the sign",
    "start": "312990",
    "end": "318630"
  },
  {
    "text": "cluster, and this point\nclose to the centroid.",
    "start": "318630",
    "end": "324290"
  },
  {
    "start": "324290",
    "end": "327920"
  },
  {
    "start": "327000",
    "end": "429000"
  },
  {
    "text": "So now we can define the\nk-means objective function.",
    "start": "327920",
    "end": "332040"
  },
  {
    "text": "Here's a picture, which\nI'm going to talk through.",
    "start": "332040",
    "end": "334280"
  },
  {
    "text": "The K-means objective\nfunction is denoted as a loss.",
    "start": "334280",
    "end": "339440"
  },
  {
    "text": "k means loss function.",
    "start": "339440",
    "end": "341210"
  },
  {
    "text": "And it's a function of\nthe cluster assignments, 1",
    "start": "341210",
    "end": "345560"
  },
  {
    "text": "through zn and the cluster\ncentroids, mu 1 through mu k.",
    "start": "345560",
    "end": "351870"
  },
  {
    "text": "And this is equal to--",
    "start": "351870",
    "end": "353970"
  },
  {
    "text": "I'm going to look at all the\nendpoints, sum over them--",
    "start": "353970",
    "end": "359360"
  },
  {
    "text": "look at the ith point.",
    "start": "359360",
    "end": "363259"
  },
  {
    "text": "Look at the difference\nbetween them.",
    "start": "363260",
    "end": "366932"
  },
  {
    "text": "So zi is a number\nbetween 1 and k,",
    "start": "366932",
    "end": "371150"
  },
  {
    "text": "which specifies which cluster\na point i is assigned to.",
    "start": "371150",
    "end": "376340"
  },
  {
    "text": "And I'm going to\naccess its centroid.",
    "start": "376340",
    "end": "381070"
  },
  {
    "text": "And I'm going to take a\ndifference between these two",
    "start": "381070",
    "end": "384310"
  },
  {
    "text": "and square it.",
    "start": "384310",
    "end": "385510"
  },
  {
    "text": "So this is the\nsquared difference--",
    "start": "385510",
    "end": "388230"
  },
  {
    "text": "distance between the\npoint and a centroid.",
    "start": "388230",
    "end": "392110"
  },
  {
    "text": "And so pictorially, what I'm\nlooking at is for each point,",
    "start": "392110",
    "end": "396340"
  },
  {
    "text": "I look at its assigned\ncentroid, and I'm",
    "start": "396340",
    "end": "400840"
  },
  {
    "text": "looking at the squared of the\nlength of these dashed lines.",
    "start": "400840",
    "end": "406630"
  },
  {
    "text": "The sum of all the squares\nof the dashed lines",
    "start": "406630",
    "end": "408820"
  },
  {
    "text": "is exactly k means plus, that\nhas to be as small as possible.",
    "start": "408820",
    "end": "414230"
  },
  {
    "text": "So I want to minimize, with\nrespect to both the cluster",
    "start": "414230",
    "end": "418330"
  },
  {
    "text": "centroids, the cluster\nassignments and the centroids",
    "start": "418330",
    "end": "424120"
  },
  {
    "text": "of this objective function.",
    "start": "424120",
    "end": "425800"
  },
  {
    "start": "425800",
    "end": "429759"
  },
  {
    "start": "429000",
    "end": "579000"
  },
  {
    "text": "So to get some intuition, let's\nconsider a simpler example",
    "start": "429760",
    "end": "436560"
  },
  {
    "text": "in one dimension.",
    "start": "436560",
    "end": "437745"
  },
  {
    "text": "So here we have four\npoints at 0, 2, 10, and 12.",
    "start": "437745",
    "end": "446120"
  },
  {
    "text": "OK, so I'm going to consider\nthe optimistic case of if we",
    "start": "446120",
    "end": "451010"
  },
  {
    "text": "know what the centroids are--",
    "start": "451010",
    "end": "453270"
  },
  {
    "text": "because that makes\nour life easier.",
    "start": "453270",
    "end": "455949"
  },
  {
    "text": "So if we know this\ncentroids are at 1 and 11,",
    "start": "455950",
    "end": "460110"
  },
  {
    "text": "indeed, this becomes a\npretty trivial problem.",
    "start": "460110",
    "end": "462990"
  },
  {
    "text": "Because now-- remember\nhow do we assign points?",
    "start": "462990",
    "end": "466169"
  },
  {
    "text": "Well, for the first\npoint, we just",
    "start": "466170",
    "end": "468630"
  },
  {
    "text": "assign it to the\nclosest centroid.",
    "start": "468630",
    "end": "471090"
  },
  {
    "text": "Because we know where\nthe centroids are.",
    "start": "471090",
    "end": "473669"
  },
  {
    "text": "So this point is 0.",
    "start": "473670",
    "end": "475290"
  },
  {
    "text": "It's closest to 1, so I'm\ngoing to assign this to 1.",
    "start": "475290",
    "end": "478980"
  },
  {
    "text": "For z2, this point\nis closest to 1,",
    "start": "478980",
    "end": "482200"
  },
  {
    "text": "so I'm going to assign it to 1.",
    "start": "482200",
    "end": "485220"
  },
  {
    "text": "This point is closest to\nthe center of the cluster 2",
    "start": "485220",
    "end": "489000"
  },
  {
    "text": "and same with this one.",
    "start": "489000",
    "end": "492020"
  },
  {
    "text": "So all I'm doing is looking\nat all the centroids,",
    "start": "492020",
    "end": "495349"
  },
  {
    "text": "and computing which one is\nthe closest to the point",
    "start": "495350",
    "end": "499400"
  },
  {
    "text": "I'm trying to assign.",
    "start": "499400",
    "end": "502620"
  },
  {
    "text": "So now let's consider\nthe case where",
    "start": "502620",
    "end": "505400"
  },
  {
    "text": "I don't know the centroids\nbut I have the assignments.",
    "start": "505400",
    "end": "510880"
  },
  {
    "text": "If I have the\nassignments, then I",
    "start": "510880",
    "end": "514599"
  },
  {
    "text": "can also compute the\ncentroid [INAUDIBLE]..",
    "start": "514600",
    "end": "517539"
  },
  {
    "text": "So for the first\ncluster, I simply",
    "start": "517539",
    "end": "521200"
  },
  {
    "text": "look at all the points that\nare assigned to that cluster.",
    "start": "521200",
    "end": "524290"
  },
  {
    "text": "And remember, I want to\nfind the centroid, which",
    "start": "524290",
    "end": "529970"
  },
  {
    "text": "is as close as possible\nto all of them on average.",
    "start": "529970",
    "end": "534300"
  },
  {
    "text": "And so this is going\nto be minimum over some",
    "start": "534300",
    "end": "537589"
  },
  {
    "text": "of the square distances.",
    "start": "537590",
    "end": "539600"
  },
  {
    "text": "And recall that that is exactly\noptimized in closed form",
    "start": "539600",
    "end": "543920"
  },
  {
    "text": "by setting it to the mean\nof the points assigned",
    "start": "543920",
    "end": "548300"
  },
  {
    "text": "to that cluster.",
    "start": "548300",
    "end": "550230"
  },
  {
    "text": "So for mu 2, points 10 and 12\nare assigned to that cluster.",
    "start": "550230",
    "end": "555079"
  },
  {
    "text": "So the mean of those is 11.",
    "start": "555080",
    "end": "559470"
  },
  {
    "text": "So now given either the cluster\nassignments or the centroids,",
    "start": "559470",
    "end": "566069"
  },
  {
    "text": "we can successfully\nrecover optimally.",
    "start": "566070",
    "end": "570030"
  },
  {
    "text": "But this is a chicken\nand egg problem.",
    "start": "570030",
    "end": "571830"
  },
  {
    "text": "Because we neither\nhave the centroids",
    "start": "571830",
    "end": "574920"
  },
  {
    "text": "nor we have the\nassignments to begin with.",
    "start": "574920",
    "end": "578389"
  },
  {
    "text": "So what can we do?",
    "start": "578390",
    "end": "580400"
  },
  {
    "start": "579000",
    "end": "774000"
  },
  {
    "text": "Well, let's just take a gamble\nand just initialize randomly.",
    "start": "580400",
    "end": "587600"
  },
  {
    "text": "And so we're going to initialize\nthe centroids, some random--",
    "start": "587600",
    "end": "593540"
  },
  {
    "text": "so usually, they are assigned\nto some of the existing points,",
    "start": "593540",
    "end": "598690"
  },
  {
    "text": "data points.",
    "start": "598690",
    "end": "599690"
  },
  {
    "text": "Let's just assign them to it.",
    "start": "599690",
    "end": "602380"
  },
  {
    "text": "So clearly this is not optimum.",
    "start": "602380",
    "end": "604480"
  },
  {
    "text": "But let's try to iterate to it.",
    "start": "604480",
    "end": "608089"
  },
  {
    "text": "So first iteration,\nwhat we're going to do",
    "start": "608090",
    "end": "611570"
  },
  {
    "text": "is we're going to\nfix these centroids",
    "start": "611570",
    "end": "614840"
  },
  {
    "text": "and optimize the\ncluster assignments.",
    "start": "614840",
    "end": "617510"
  },
  {
    "text": "But let's look at each\npoint and try to assign it",
    "start": "617510",
    "end": "619820"
  },
  {
    "text": "to one of the clusters.",
    "start": "619820",
    "end": "622330"
  },
  {
    "text": "So 0 is closest\nto 0, so I'm going",
    "start": "622330",
    "end": "624890"
  },
  {
    "text": "to assign that to cluster 1.",
    "start": "624890",
    "end": "628910"
  },
  {
    "text": "This point, 2, is\nclosest to cluster 2",
    "start": "628910",
    "end": "632930"
  },
  {
    "text": "because it's right\non top, so that's 2.",
    "start": "632930",
    "end": "635540"
  },
  {
    "text": "And these two points are\nalso closest to cluster 2.",
    "start": "635540",
    "end": "642600"
  },
  {
    "text": "So I'll annotate them,\nassign them to 2.",
    "start": "642600",
    "end": "646810"
  },
  {
    "text": "And then I'm going to\nuse these new assignments",
    "start": "646810",
    "end": "651880"
  },
  {
    "text": "and try to re-estimate\nthe centroid.",
    "start": "651880",
    "end": "655170"
  },
  {
    "text": "So for the first\ncluster, I'm just",
    "start": "655170",
    "end": "658620"
  },
  {
    "text": "going-- that's\nonly at this point.",
    "start": "658620",
    "end": "660040"
  },
  {
    "text": "So I'm going to--",
    "start": "660040",
    "end": "661410"
  },
  {
    "text": "the centroid right there.",
    "start": "661410",
    "end": "663810"
  },
  {
    "text": "And for the second cluster,\nnow I have these three points,",
    "start": "663810",
    "end": "667380"
  },
  {
    "text": "and I'm going to find a place\nthe centroid that minimizes",
    "start": "667380",
    "end": "673120"
  },
  {
    "text": "the square distance\nto all them, which",
    "start": "673120",
    "end": "675060"
  },
  {
    "text": "is going to be the average\nat 8, which is 2 plus 10,",
    "start": "675060",
    "end": "679700"
  },
  {
    "text": "plus 12, divided by 3.",
    "start": "679700",
    "end": "682470"
  },
  {
    "text": "OK, so now have these\nupdated centroids at 0 and 8,",
    "start": "682470",
    "end": "686399"
  },
  {
    "text": "and see that this is\nlooking a bit better.",
    "start": "686400",
    "end": "689080"
  },
  {
    "text": "And now the second\niteration, I'm",
    "start": "689080",
    "end": "691560"
  },
  {
    "text": "going to reassign the\npoints based on these--",
    "start": "691560",
    "end": "696975"
  },
  {
    "text": "plus new centroids [INAUDIBLE].",
    "start": "696975",
    "end": "700470"
  },
  {
    "text": "So the first at\nthis point is going",
    "start": "700470",
    "end": "705189"
  },
  {
    "text": "to be assigned to\ncluster right there.",
    "start": "705190",
    "end": "709930"
  },
  {
    "text": "This point is also going to\nbe close assigned to cluster 1",
    "start": "709930",
    "end": "715180"
  },
  {
    "text": "because 0 is closer\nto 2 than this.",
    "start": "715180",
    "end": "719760"
  },
  {
    "text": "And point 10 is going to be\nclosest to the second cluster",
    "start": "719760",
    "end": "726360"
  },
  {
    "text": "and same with point 2.",
    "start": "726360",
    "end": "729959"
  },
  {
    "text": "OK, so now we have new\ncluster assignments.",
    "start": "729960",
    "end": "732990"
  },
  {
    "text": "We can go back and\nre-estimate the centroids.",
    "start": "732990",
    "end": "738209"
  },
  {
    "text": "And now we're back in\nour familiar problem",
    "start": "738210",
    "end": "741300"
  },
  {
    "text": "from the previous slide, where\nwe look at the first cluster,",
    "start": "741300",
    "end": "745660"
  },
  {
    "text": "assign the centroid to be\njust the mean between the two",
    "start": "745660",
    "end": "750029"
  },
  {
    "text": "points.",
    "start": "750030",
    "end": "750960"
  },
  {
    "text": "And same with the second\ncluster, the mean of a 10",
    "start": "750960",
    "end": "754880"
  },
  {
    "text": "and a 12 is 11.",
    "start": "754880",
    "end": "756890"
  },
  {
    "text": "And now, we actually converged.",
    "start": "756890",
    "end": "759800"
  },
  {
    "text": "If you try to repeat this\nprocess, nothing will change.",
    "start": "759800",
    "end": "762290"
  },
  {
    "text": "So we're done.",
    "start": "762290",
    "end": "763800"
  },
  {
    "text": "And in this case, it\nhappens to recover",
    "start": "763800",
    "end": "766640"
  },
  {
    "text": "the optimum of clustering\nfor these four points,",
    "start": "766640",
    "end": "770030"
  },
  {
    "text": "even though we didn't know\nanything about algorithms.",
    "start": "770030",
    "end": "775200"
  },
  {
    "start": "774000",
    "end": "1021000"
  },
  {
    "text": "So here is the k-means\nalgorithm stated more formally.",
    "start": "775200",
    "end": "780590"
  },
  {
    "text": "So first, we are\ngoing to initialize",
    "start": "780590",
    "end": "783070"
  },
  {
    "text": "all of the centroids randomly.",
    "start": "783070",
    "end": "785500"
  },
  {
    "text": "Then we're going to iterate T\ntimes, or until convergence.",
    "start": "785500",
    "end": "790730"
  },
  {
    "text": "And we're going to alternate\nbetween step one, which",
    "start": "790730",
    "end": "793209"
  },
  {
    "text": "is set the assignments\ngiven the centroids,",
    "start": "793210",
    "end": "796660"
  },
  {
    "text": "and step two, which is\nsetting the centroids given",
    "start": "796660",
    "end": "799329"
  },
  {
    "text": "assignments.",
    "start": "799330",
    "end": "801430"
  },
  {
    "text": "So step one, we're going\nto go through each point.",
    "start": "801430",
    "end": "805720"
  },
  {
    "text": "And we're going to\ntry to assign it.",
    "start": "805720",
    "end": "807220"
  },
  {
    "text": "We're going to\nassign it to the zi.",
    "start": "807220",
    "end": "809350"
  },
  {
    "text": "It's going to be equal to.",
    "start": "809350",
    "end": "812019"
  },
  {
    "text": "We're going to look at all\nthe clusters, 1 through K.",
    "start": "812020",
    "end": "819820"
  },
  {
    "text": "For each one of\nthese, we're going",
    "start": "819820",
    "end": "821710"
  },
  {
    "text": "to look at where that\npoint is and look",
    "start": "821710",
    "end": "825130"
  },
  {
    "text": "at the square distance between\nthe centroid of that cluster.",
    "start": "825130",
    "end": "829240"
  },
  {
    "start": "829240",
    "end": "831795"
  },
  {
    "text": "And then we're\njust going to take",
    "start": "831795",
    "end": "833170"
  },
  {
    "text": "the argument, which\nis the cluster",
    "start": "833170",
    "end": "837310"
  },
  {
    "text": "k, which minimizes this one.",
    "start": "837310",
    "end": "842260"
  },
  {
    "text": "For step two, we're going\nto loop over the clusters,",
    "start": "842260",
    "end": "847210"
  },
  {
    "text": "and we're going to set the\ncentroid for that cluster",
    "start": "847210",
    "end": "850510"
  },
  {
    "text": "to be--",
    "start": "850510",
    "end": "852550"
  },
  {
    "text": "We're going to look\nat all of the points",
    "start": "852550",
    "end": "855325"
  },
  {
    "text": "i, which are assigned to that\ncluster k and just average--",
    "start": "855325",
    "end": "863290"
  },
  {
    "text": "sum of all the points.",
    "start": "863290",
    "end": "866110"
  },
  {
    "text": "And this-- we want to divide\nby the number of points.",
    "start": "866110",
    "end": "868990"
  },
  {
    "text": "I'm summing over to get\nthe average equals k.",
    "start": "868990",
    "end": "875020"
  },
  {
    "text": "Great, so that is the\nk-means algorithm.",
    "start": "875020",
    "end": "878813"
  },
  {
    "start": "878813",
    "end": "882269"
  },
  {
    "text": "So one word about whether\nit will work somehow--",
    "start": "882270",
    "end": "886760"
  },
  {
    "text": "the k-means algorithm\nis guaranteed",
    "start": "886760",
    "end": "888230"
  },
  {
    "text": "to converge to a local\nminimum of k-means objective,",
    "start": "888230",
    "end": "893540"
  },
  {
    "text": "but is not guaranteed\nto converge--",
    "start": "893540",
    "end": "895699"
  },
  {
    "text": "to find the global minimum.",
    "start": "895700",
    "end": "898010"
  },
  {
    "text": "The cartoon picture\nof optimization",
    "start": "898010",
    "end": "900110"
  },
  {
    "text": "function-- it can converge\nto a local minimum but not",
    "start": "900110",
    "end": "902480"
  },
  {
    "text": "global minimum.",
    "start": "902480",
    "end": "904240"
  },
  {
    "text": "So if you click here I have\nthis demo, which shows you",
    "start": "904240",
    "end": "910330"
  },
  {
    "text": "how k-means works.",
    "start": "910330",
    "end": "913240"
  },
  {
    "text": "So you can actually\nconstruct your own set",
    "start": "913240",
    "end": "915730"
  },
  {
    "text": "of training examples.",
    "start": "915730",
    "end": "917269"
  },
  {
    "text": "And if you step through\nthe k-means algorithm,",
    "start": "917270",
    "end": "921490"
  },
  {
    "text": "you initialize, and\nit will alternate",
    "start": "921490",
    "end": "925300"
  },
  {
    "text": "between moving these centroids\naround and reassigning",
    "start": "925300",
    "end": "928269"
  },
  {
    "text": "the points.",
    "start": "928270",
    "end": "929380"
  },
  {
    "text": "And in this happy\ncase, we actually",
    "start": "929380",
    "end": "932080"
  },
  {
    "text": "get to a pretty good clustering.",
    "start": "932080",
    "end": "935160"
  },
  {
    "text": "The blue points over here, red\npoints over here, and green.",
    "start": "935160",
    "end": "939889"
  },
  {
    "text": "Training error-- k-means\nobjective function is 44.7.",
    "start": "939890",
    "end": "945190"
  },
  {
    "text": "But if I initialize in a\nslightly different way,",
    "start": "945190",
    "end": "950870"
  },
  {
    "text": "so let's see what happens.",
    "start": "950870",
    "end": "952990"
  },
  {
    "text": "It converges to something\nwith much worst error.",
    "start": "952990",
    "end": "956733"
  },
  {
    "text": "And you can see\nvisually that this",
    "start": "956733",
    "end": "958149"
  },
  {
    "text": "is a suboptimal clustering\nbecause this point has",
    "start": "958150",
    "end": "961090"
  },
  {
    "text": "only one--",
    "start": "961090",
    "end": "962740"
  },
  {
    "text": "this cluster only has one point.",
    "start": "962740",
    "end": "964600"
  },
  {
    "text": "Whereas, this cluster\nhas so many other points,",
    "start": "964600",
    "end": "967569"
  },
  {
    "text": "which are spread out.",
    "start": "967570",
    "end": "971090"
  },
  {
    "text": "So what do you do about this?",
    "start": "971090",
    "end": "976690"
  },
  {
    "text": "Well, there are a\ncouple of things.",
    "start": "976690",
    "end": "979570"
  },
  {
    "text": "One is that you can just\nrun it multiple times",
    "start": "979570",
    "end": "981600"
  },
  {
    "text": "from different randomizations\nand take the best one.",
    "start": "981600",
    "end": "986180"
  },
  {
    "text": "Another thing you can do\nis use a smarter heuristic.",
    "start": "986180",
    "end": "989140"
  },
  {
    "text": "So I didn't say very much\nabout initialization.",
    "start": "989140",
    "end": "993310"
  },
  {
    "text": "But there's a cool thing\nyou can do called k-means++,",
    "start": "993310",
    "end": "997750"
  },
  {
    "text": "where you initialize the\nclusters one at a time--",
    "start": "997750",
    "end": "1002640"
  },
  {
    "text": "the centroids one\nat a time to be",
    "start": "1002640",
    "end": "1004800"
  },
  {
    "text": "the data points, which\nare as far away as",
    "start": "1004800",
    "end": "1007110"
  },
  {
    "text": "possible from all the others.",
    "start": "1007110",
    "end": "1008683"
  },
  {
    "text": "So this kind of make sure is\nthat the centroids are spread",
    "start": "1008683",
    "end": "1011100"
  },
  {
    "text": "out and that they can kind of\nmove over time to capture all",
    "start": "1011100",
    "end": "1016350"
  },
  {
    "text": "the points in your data set.",
    "start": "1016350",
    "end": "1018048"
  },
  {
    "start": "1018048",
    "end": "1021370"
  },
  {
    "start": "1021000",
    "end": "1164000"
  },
  {
    "text": "OK, to wrap things\nup, so far we've",
    "start": "1021370",
    "end": "1024430"
  },
  {
    "text": "talked about k-means which is an\nalgorithm for doing clustering.",
    "start": "1024430",
    "end": "1028359"
  },
  {
    "text": "And clustering is\na useful task that",
    "start": "1028359",
    "end": "1031089"
  },
  {
    "text": "can be allowed to\ndiscover structure",
    "start": "1031089",
    "end": "1034449"
  },
  {
    "text": "in unlabeled data in\nparticular-- group points",
    "start": "1034450",
    "end": "1036579"
  },
  {
    "text": "together.",
    "start": "1036579",
    "end": "1038189"
  },
  {
    "text": "It's useful to\ndistinguish k-means to--",
    "start": "1038190",
    "end": "1043858"
  },
  {
    "text": "the meanings of k-means.",
    "start": "1043859",
    "end": "1045849"
  },
  {
    "text": "The first is the\nk-means objective.",
    "start": "1045849",
    "end": "1048580"
  },
  {
    "text": "So this is objective\nfunction that says,",
    "start": "1048580",
    "end": "1051909"
  },
  {
    "text": "find assignments\nand find centroids",
    "start": "1051910",
    "end": "1054880"
  },
  {
    "text": "that minimizes the\nsquared distance",
    "start": "1054880",
    "end": "1057850"
  },
  {
    "text": "between each point and the\ncentroid of assigned cluster.",
    "start": "1057850",
    "end": "1063840"
  },
  {
    "text": "And then there's a\nk-means algorithm,",
    "start": "1063840",
    "end": "1065730"
  },
  {
    "text": "which performs\nalternative minimization",
    "start": "1065730",
    "end": "1068340"
  },
  {
    "text": "on the k-means objective.",
    "start": "1068340",
    "end": "1071190"
  },
  {
    "text": "So this is setting the\nassignments given the centroids",
    "start": "1071190",
    "end": "1076169"
  },
  {
    "text": "and setting the centroid\ngiven assignments.",
    "start": "1076170",
    "end": "1081220"
  },
  {
    "text": "Chicken-egg problem--\nso this is not",
    "start": "1081220",
    "end": "1082900"
  },
  {
    "text": "guaranteed to globally\nminimize the k-means objective.",
    "start": "1082900",
    "end": "1087130"
  },
  {
    "text": "Although, it usually get\npretty good results robustly.",
    "start": "1087130",
    "end": "1092560"
  },
  {
    "text": "Stepping back a little bit,\nk-means is for clustering.",
    "start": "1092560",
    "end": "1096730"
  },
  {
    "text": "There's other types of\nclustering methods out there.",
    "start": "1096730",
    "end": "1100570"
  },
  {
    "text": "And clustering is a form\nof unsupervised learning.",
    "start": "1100570",
    "end": "1104500"
  },
  {
    "text": "And, generally, unsupervised\nlearning has a few use cases.",
    "start": "1104500",
    "end": "1109310"
  },
  {
    "text": "One is just data\nexploration and discovery.",
    "start": "1109310",
    "end": "1112030"
  },
  {
    "text": "You get a pile of data.",
    "start": "1112030",
    "end": "1113570"
  },
  {
    "text": "You might not have had a\nchance to annotate or label it.",
    "start": "1113570",
    "end": "1117789"
  },
  {
    "text": "So you can run\nclustering or other types",
    "start": "1117790",
    "end": "1120310"
  },
  {
    "text": "of unsupervised\nlearning to group points",
    "start": "1120310",
    "end": "1123550"
  },
  {
    "text": "and discover any sort of\nstructure to get insight.",
    "start": "1123550",
    "end": "1128500"
  },
  {
    "text": "And a second use case is that\nwhen you perform clustering",
    "start": "1128500",
    "end": "1132760"
  },
  {
    "text": "or some sort of\nrepresentation learning.",
    "start": "1132760",
    "end": "1135220"
  },
  {
    "text": "You can actually get useful\nrepresentations or features",
    "start": "1135220",
    "end": "1139929"
  },
  {
    "text": "that you can stick them in to\ndownstream supervised learning",
    "start": "1139930",
    "end": "1143740"
  },
  {
    "text": "problems when you do get\na bunch of labeled data.",
    "start": "1143740",
    "end": "1147370"
  },
  {
    "text": "And this generally is helpful\nfor helping supervised learning",
    "start": "1147370",
    "end": "1152770"
  },
  {
    "text": "work better.",
    "start": "1152770",
    "end": "1155160"
  },
  {
    "text": "OK, so that's the\nend of this module.",
    "start": "1155160",
    "end": "1158210"
  },
  {
    "start": "1158210",
    "end": "1163000"
  }
]