[
  {
    "start": "0",
    "end": "5610"
  },
  {
    "text": "Let's do a quick review\nof lecture three. So last time, we talked about\ntwo key ideas about GPS.",
    "start": "5610",
    "end": "13170"
  },
  {
    "text": "One was, how does the\nreceiver determine the position of the satellites? And we said, that's done\nusing the information",
    "start": "13170",
    "end": "20340"
  },
  {
    "text": "in the navigation messages. And specifically, the ephemeris\npart of the navigation message",
    "start": "20340",
    "end": "27330"
  },
  {
    "text": "has six parameters\nin it, which are called the orbital parameters. And with these\nparameters, three of them",
    "start": "27330",
    "end": "35970"
  },
  {
    "text": "determine basically an\nelliptical trajectory of the satellite\nat a point in time",
    "start": "35970",
    "end": "42640"
  },
  {
    "text": "and also the position of the\nsatellite within that ellipse. And the other three\ndetermine the orientation",
    "start": "42640",
    "end": "49800"
  },
  {
    "text": "of this elliptical\nplane with respect to the Earth-centered,\nEarth-fixed coordinate system.",
    "start": "49800",
    "end": "57399"
  },
  {
    "text": "So with those six\nparameters, the receiver can estimate very accurately\nthe position of the satellite",
    "start": "57400",
    "end": "63840"
  },
  {
    "text": "at a given point in time. There is also some\ncorrection parameters that tells the receiver how\neach of these six parameters",
    "start": "63840",
    "end": "70770"
  },
  {
    "text": "change over time. So the receiver can\nextrapolate or interpolate",
    "start": "70770",
    "end": "76620"
  },
  {
    "text": "between two navigation\nmessages and continuously track the satellite's\nposition very accurate.",
    "start": "76620",
    "end": "83650"
  },
  {
    "text": "So that was the first thing. The second key idea\nwe talked about--",
    "start": "83650",
    "end": "88710"
  },
  {
    "text": "we demystify this idea of time\nof flight estimation using",
    "start": "88710",
    "end": "94080"
  },
  {
    "text": "ranging codes. So we basically derived the\nleast mean square estimate",
    "start": "94080",
    "end": "101400"
  },
  {
    "text": "of the time of flight\nin a very general setup. We formulated it as an\noptimization problem.",
    "start": "101400",
    "end": "108180"
  },
  {
    "text": "Some signal x of k is\ntransmitted, which its waveform is known to the receiver.",
    "start": "108180",
    "end": "114640"
  },
  {
    "text": "The receiver measures\ny of k, which is an attenuated and\ndelayed version of x of k.",
    "start": "114640",
    "end": "121710"
  },
  {
    "text": "And then we show that\nthe optimal estimator of and sub tau is given by the\nindex at which this correlation",
    "start": "121710",
    "end": "133560"
  },
  {
    "text": "function is maximized. So you calculate this\nthing which is very closely",
    "start": "133560",
    "end": "138659"
  },
  {
    "text": "related to a convolution. And if you calculate\nthis function,",
    "start": "138660",
    "end": "144150"
  },
  {
    "text": "you can also think of it as a\nlinear filter with the kernel or the impulse\nresponse of the filter",
    "start": "144150",
    "end": "150750"
  },
  {
    "text": "being x of minus k or\nsomething like that. And then you can\ncalculate this function.",
    "start": "150750",
    "end": "156519"
  },
  {
    "text": "And if you plot its absolute\nvalue-- and the absolute value is because sometimes\nthere could be sine flips.",
    "start": "156520",
    "end": "164107"
  },
  {
    "text": "So that's why you take\nthe absolute value or you can also square it. And you find the peak. And the index at\nwhich the peak happens",
    "start": "164107",
    "end": "171780"
  },
  {
    "text": "is your best estimate of\nthe time of flight delay",
    "start": "171780",
    "end": "178290"
  },
  {
    "text": "in the least squared sense. And then from this-- and this\nis true about any signal.",
    "start": "178290",
    "end": "185489"
  },
  {
    "text": "Whatever x you send, if this\nmeasurement model is valid--",
    "start": "185490",
    "end": "190800"
  },
  {
    "text": "as long as this is a\nvalid measurement model-- then the correlation\nis basically",
    "start": "190800",
    "end": "196410"
  },
  {
    "text": "the optimal way of determining\nyour time of flight. But what is interesting\nabout this is,",
    "start": "196410",
    "end": "203489"
  },
  {
    "text": "when you're designing\na system, you're free to choose what x of k is.",
    "start": "203490",
    "end": "209260"
  },
  {
    "text": "And then based on this-- because at the end\nof the day, it's a correlation function\nthat matters--",
    "start": "209260",
    "end": "214890"
  },
  {
    "text": "you can choose an x with\ngood correlation properties. And by good properties we\nmean a nice sharp peak.",
    "start": "214890",
    "end": "221490"
  },
  {
    "text": "So you don't want this peak\nto be too broad, for instance. Because then finding the\nactual maximum point of it",
    "start": "221490",
    "end": "228930"
  },
  {
    "text": "can be a little tricky\nin noisy situations. And also you want the\nside lobes to be very low.",
    "start": "228930",
    "end": "236610"
  },
  {
    "text": "And then it turns\nout that there's many, many different codes--",
    "start": "236610",
    "end": "242430"
  },
  {
    "text": "as we call them-- that\nhave good properties. The specific class that GPS\nuses are called m-sequences,",
    "start": "242430",
    "end": "250800"
  },
  {
    "text": "also called maximal\nlength sequences. And we said that these\nare good because they",
    "start": "250800",
    "end": "256588"
  },
  {
    "text": "have specifically three\nvery interesting properties.",
    "start": "256589",
    "end": "261660"
  },
  {
    "text": "They, of course, have good\ncorrelations, as we showed. They have these\ntriangle functions with constant, very\nlow side lobes.",
    "start": "261660",
    "end": "268740"
  },
  {
    "text": "They're extremely\neasy to generate. All you need is basically\na shift register with n bits and\nsome feedback taps.",
    "start": "268740",
    "end": "274650"
  },
  {
    "text": "And then you get a\ncode with a number of chips that is equal to\ntwo to the n minus one.",
    "start": "274650",
    "end": "280110"
  },
  {
    "text": "So which is 10-bit\nshift register, you can generate a code\nthat is 1,023 bits or chips.",
    "start": "280110",
    "end": "287250"
  },
  {
    "text": "And also you can\ngenerate multiple codes of the same length with\ndifferent shift register",
    "start": "287250",
    "end": "295110"
  },
  {
    "text": "feedback taps. And those codes each of them\nhas very good auto-correlation.",
    "start": "295110",
    "end": "301253"
  },
  {
    "text": "And the auto-correlation\nfunctions are in fact exact\nsame between those. But the cross\ncorrelations are very low.",
    "start": "301253",
    "end": "307630"
  },
  {
    "text": "And this low cross correlation\nis the key idea behind code division multiple axis.",
    "start": "307630",
    "end": "312780"
  },
  {
    "text": "Because, the receiver\ncan essentially have different correlations\nwith different channels.",
    "start": "312780",
    "end": "319290"
  },
  {
    "text": "And each of them only\nresponds to the specific code",
    "start": "319290",
    "end": "325020"
  },
  {
    "text": "that is the kernel\nof that correlate. And if you pass a\ndifferent code through it,",
    "start": "325020",
    "end": "330210"
  },
  {
    "text": "you basically get not exactly\nzero but very low output.",
    "start": "330210",
    "end": "336389"
  },
  {
    "text": "Any questions about this? Yes. Question about-- you said that,\nyou should take absolute value",
    "start": "336390",
    "end": "341820"
  },
  {
    "text": "in case there is a sine shifts. What's an example\nof a sine shift?",
    "start": "341820",
    "end": "347100"
  },
  {
    "text": "So an example of a sine\nshift is, for instance, well,",
    "start": "347100",
    "end": "352410"
  },
  {
    "text": "here we said, alpha is\njust an attenuation factor. In reality, alpha can\nbe a complex number",
    "start": "352410",
    "end": "360390"
  },
  {
    "text": "because there's\nalso phase effects. And once you make your\nalpha a complex number,",
    "start": "360390",
    "end": "366849"
  },
  {
    "text": "if you have a 90\ndegree phase shift, that's like a minus sign. So this alpha-- if the phase\neffect gives you a 90 degree",
    "start": "366850",
    "end": "375840"
  },
  {
    "text": "phase shift, it can\nflip the sine of your x, for instance,\nthat's one example.",
    "start": "375840",
    "end": "381660"
  },
  {
    "text": "So, generally, yeah, that's\nwhy we take the absolute value or squared.",
    "start": "381660",
    "end": "388740"
  },
  {
    "text": "Any other questions? All right, so let's\ncontinue the discussion. So we said this\nwas the ideal case.",
    "start": "388740",
    "end": "400150"
  },
  {
    "text": "But we said there is three\ncomplications or nine idealities that the\nreceiver has to deal with.",
    "start": "400150",
    "end": "408580"
  },
  {
    "text": "First one was the Doppler shift. And we'll get back\nto it and show you how Doppler shift\nis compensated for.",
    "start": "408580",
    "end": "416470"
  },
  {
    "text": "The other one was the fact that\nthe receiver clock is never",
    "start": "416470",
    "end": "422710"
  },
  {
    "text": "perfectly synchronized\nwith the GPS clock. So what happens is that there\nis some extra shift in here",
    "start": "422710",
    "end": "430450"
  },
  {
    "text": "just due to the receiver\nclock offset that also needs to be compensated for. And that's what\nwe call tau sub d.",
    "start": "430450",
    "end": "437080"
  },
  {
    "text": "And because of\nthat, the receiver doesn't recover\nthe physical range. It recovers what we\ncall the pseudo range.",
    "start": "437080",
    "end": "444580"
  },
  {
    "text": "And the third one-- which\nwe didn't quite finish. We just set up the problem-- is this idea of range ambiguity.",
    "start": "444580",
    "end": "451120"
  },
  {
    "text": "And the idea of\nambiguity is the signals",
    "start": "451120",
    "end": "456610"
  },
  {
    "text": "that are being\ntransmitted are periodic. So the correlations\nalso are periodic.",
    "start": "456610",
    "end": "463030"
  },
  {
    "text": "We usually just calculated\nover one period of the signal.",
    "start": "463030",
    "end": "468940"
  },
  {
    "text": "So in here for instance,\nin this picture, if this was a C/A\ncode, your correlation",
    "start": "468940",
    "end": "474130"
  },
  {
    "text": "you can start from index\nzero and only go to 1022.",
    "start": "474130",
    "end": "480410"
  },
  {
    "text": "Write only one period\nof your signal. But in reality, the n hat\nthat you find from here--",
    "start": "480410",
    "end": "491510"
  },
  {
    "text": "the physical n hat can be that\nplus any multiple of the chord",
    "start": "491510",
    "end": "496760"
  },
  {
    "text": "length. So it could be n hat one plus\nk, plus 2k, plus 3k, and so",
    "start": "496760",
    "end": "502880"
  },
  {
    "text": "on, and so forth. And that's why we have this\nambiguity in our ranging.",
    "start": "502880",
    "end": "509120"
  },
  {
    "text": "And we need to exactly\nfind what is the correct-- so the actual physical\ntime of flight",
    "start": "509120",
    "end": "516200"
  },
  {
    "text": "is n hat 1 plus some m times k. And remember k is the number\nof samples in the code.",
    "start": "516200",
    "end": "522919"
  },
  {
    "text": "And we need to find what is m? Is m called to 1, is it 2? M is an integer.",
    "start": "522919",
    "end": "528590"
  },
  {
    "text": "So you need to disambiguate that\ninteger m, which corresponds to the physical range.",
    "start": "528590",
    "end": "534089"
  },
  {
    "text": "So how can we do this? There is a simple solution,\nwhich is basically,",
    "start": "534090",
    "end": "539660"
  },
  {
    "text": "if we have some idea roughly of\nwhat the actual time of flight",
    "start": "539660",
    "end": "546170"
  },
  {
    "text": "delay is or what the\nactual pseudorange we expect from the satellite is--",
    "start": "546170",
    "end": "552079"
  },
  {
    "text": "roughly, it doesn't\nneed to be exact. But if we know\nthat, that can help us disambiguate\nbetween these solutions",
    "start": "552080",
    "end": "560300"
  },
  {
    "text": "that we get from\nthe correlation. So, for instance,\none thing we know is that the GPS\nsatellites they are",
    "start": "560300",
    "end": "567410"
  },
  {
    "text": "orbiting the Earth an elevation\nthat is 2,200 kilometers.",
    "start": "567410",
    "end": "573029"
  },
  {
    "text": "So if the receiver was exactly\nbelow one of these satellites, then the range would\nbe 2,200 kilometers.",
    "start": "573030",
    "end": "580970"
  },
  {
    "text": "But in reality, these\nsatellites cover a large portion of the Earth. So your range or pseudorange\ncan be hundreds or possibly",
    "start": "580970",
    "end": "589430"
  },
  {
    "text": "thousands of kilometers\naway from this number.",
    "start": "589430",
    "end": "594470"
  },
  {
    "text": "That's still, OK. That's a ballpark\nnumber to work with. So let's see if that is\nuseful for disambiguation.",
    "start": "594470",
    "end": "600950"
  },
  {
    "text": "So in order to see what we\ncan do, we need to basically--",
    "start": "600950",
    "end": "608630"
  },
  {
    "text": "from one peak to the next,\nwhat is the delta range?",
    "start": "608630",
    "end": "613760"
  },
  {
    "text": "And is that large or small\ncompared to this number. If it's very large, then\nonly one of the peaks",
    "start": "613760",
    "end": "620360"
  },
  {
    "text": "would be very close\nto this number. So let's calculate that. So the range variation delta\nr is c times the delta tau.",
    "start": "620360",
    "end": "626990"
  },
  {
    "text": "And the delta tau\nwe are talking about is between two basically\nadjacent peaks in this extended",
    "start": "626990",
    "end": "632750"
  },
  {
    "text": "correlation function. So what is the delta tau? It's basically the number\nof samples between two",
    "start": "632750",
    "end": "640730"
  },
  {
    "text": "of those peaks times\nyour sampling time. Number of samples it's\nbasically m times n.",
    "start": "640730",
    "end": "646670"
  },
  {
    "text": "So remember this is our k-- total number of samples\nin a discrete code.",
    "start": "646670",
    "end": "653000"
  },
  {
    "text": "And this would be equal to n\ntimes the chip time interval.",
    "start": "653000",
    "end": "659360"
  },
  {
    "text": "Or also you can write it as\nc times the total duration of the code.",
    "start": "659360",
    "end": "665779"
  },
  {
    "text": "So that's the delta\nrange that you get between two consecutive peaks. So what is that\nactually equal to?",
    "start": "665780",
    "end": "671540"
  },
  {
    "text": "Let's look at a\nfew numbers here. So, for instance, if you're\nworking with the P Y code--",
    "start": "671540",
    "end": "678620"
  },
  {
    "text": "this was the military code. Let's see what the range\nambiguity for that is. A chip duration for that\nis 97.89 nanoseconds.",
    "start": "678620",
    "end": "687350"
  },
  {
    "text": "And it has very large\nnumber of chips. Remember this was six\ntimes 10 to the 12 chips. So you calculate your delta r,\nit comes out as 1.8 times 10",
    "start": "687350",
    "end": "696320"
  },
  {
    "text": "to the 11 kilometers. With this delta r, it's very,\nvery easy to disambiguate.",
    "start": "696320",
    "end": "703160"
  },
  {
    "text": "Because if your peaks are in\nthe index and the correlation are this far apart,\nof course, there's",
    "start": "703160",
    "end": "709340"
  },
  {
    "text": "only one of them that is even\nremotely close to this number. So with P Y, not a problem.",
    "start": "709340",
    "end": "715820"
  },
  {
    "text": "You can easily\ndisambiguate your range. How about the civilian code. Let's look at the C/A code.",
    "start": "715820",
    "end": "721490"
  },
  {
    "text": "So the C/A code remember\nwas much, much shorter. So it has a chip duration\nof 977.590 nanoseconds.",
    "start": "721490",
    "end": "729260"
  },
  {
    "text": "Total number of chips is 1023. Plug the numbers into\nour delta r equation.",
    "start": "729260",
    "end": "734960"
  },
  {
    "text": "It comes out to\nalmost 300 kilometers. With this, we have a problem.",
    "start": "734960",
    "end": "740690"
  },
  {
    "text": "Because if these peaks in\nthe extended correlation-- I'm going to go back. If these peaks are only in\nrange 300 kilometers apart,",
    "start": "740690",
    "end": "749810"
  },
  {
    "text": "we cannot decide which one. Multiple of them could be\nthe actual physical range.",
    "start": "749810",
    "end": "758450"
  },
  {
    "text": "It's not enough separation\nto let us disambiguate. Yes. Why not pick the one that\nhas the lowest correlation?",
    "start": "758450",
    "end": "766700"
  },
  {
    "text": "So like the lowest distance. Well, because that--\nthe question is,",
    "start": "766700",
    "end": "772459"
  },
  {
    "text": "why not pick the peak which is-- do you mean closest\nto the 20,000 number?",
    "start": "772460",
    "end": "778190"
  },
  {
    "text": "Is that-- [INAUDIBLE] OK, well, because physically\nthat might not be.",
    "start": "778190",
    "end": "784730"
  },
  {
    "text": "So if I draw a\npicture here for you. Let's say this is the Earth. And we have a satellite here.",
    "start": "784730",
    "end": "792800"
  },
  {
    "text": "Remember these satellites\ncover a very large surface area and very wide beams.",
    "start": "792800",
    "end": "800300"
  },
  {
    "text": "So if your receiver is directly\nunder the sky, if you're here, then you're 20,000k.",
    "start": "800300",
    "end": "807620"
  },
  {
    "text": "But if you're here, you could be\n40,000 kilometers or something. I mean, we can't\nexactly calculate.",
    "start": "807620",
    "end": "813200"
  },
  {
    "text": "I don't know off the top of my\nhead like what's the delta is. But this can be thousands\nof kilometers away from 20.",
    "start": "813200",
    "end": "822980"
  },
  {
    "text": "And if our delta ranges\nare only 300 kilometers, it is not enough.",
    "start": "822980",
    "end": "828740"
  },
  {
    "text": "So the simple idea doesn't\nwork for the civilian code. What do we do?",
    "start": "828740",
    "end": "835020"
  },
  {
    "text": "It turns out that this strange\ndisambiguation, there's multiple ways around it. And different GPS\nmanufacturers, they kind of",
    "start": "835020",
    "end": "842510"
  },
  {
    "text": "have their own secret\nsource of how they do this. And they don't, of course,\ntell us what they do.",
    "start": "842510",
    "end": "848180"
  },
  {
    "text": "But there is ideas out\nthere and which can work. So if you were to, for\ninstance, implement your own,",
    "start": "848180",
    "end": "854825"
  },
  {
    "text": "you can pick some of these. And there's more than the\nthree ideas listed here. But these are the easier ones.",
    "start": "854825",
    "end": "861420"
  },
  {
    "text": "So one is-- well, the range\nfrom or the pseudorange from each satellite\nis ambiguous.",
    "start": "861420",
    "end": "869090"
  },
  {
    "text": "But we always have multiple\nsatellites to work with. So you can use your\nmultiple measurements.",
    "start": "869090",
    "end": "874250"
  },
  {
    "text": "And remember, these\nshould define spheres that intersect at almost one point.",
    "start": "874250",
    "end": "879390"
  },
  {
    "text": "So based on that\ngeometric constraint, that can help you disambiguate\nand pick the pseudoranges that",
    "start": "879390",
    "end": "884780"
  },
  {
    "text": "are geometrically consistent. So that's one idea. The other one is even\nwith just one satellite,",
    "start": "884780",
    "end": "891829"
  },
  {
    "text": "if you wait for the satellite\nto move a little bit in orbit by a non-negligible amount, then\nyou know the exact trajectory",
    "start": "891830",
    "end": "902390"
  },
  {
    "text": "of the satellite. And again that's another\ngeometric constraint that can help you disambiguate\nwhat's the true range.",
    "start": "902390",
    "end": "908149"
  },
  {
    "text": "You can pick the\npseudorange that is consistent with your\ntrajectory of the satellite",
    "start": "908150",
    "end": "913431"
  },
  {
    "text": "that you're estimating. So that's the second idea. The third one doesn't have\nany geometry grounding.",
    "start": "913432",
    "end": "922580"
  },
  {
    "text": "It's more about the structure of\nthe bits in the LNAV messages.",
    "start": "922580",
    "end": "928410"
  },
  {
    "text": "So there's this thing called\nthe bit synchronization. And that has to do with how\nthe codes and the navigation",
    "start": "928410",
    "end": "936829"
  },
  {
    "text": "message frames are arranged\ninside the GPS data packets. And that bit synchronization\ncan help you disambiguate.",
    "start": "936830",
    "end": "945890"
  },
  {
    "text": "It gets a bit technical. But I just wanted\nto put the idea out there in case you want\nto read more about it.",
    "start": "945890",
    "end": "951630"
  },
  {
    "text": "So those are some ideas. And you could use these or\nother ideas to disambiguate.",
    "start": "951630",
    "end": "959030"
  },
  {
    "text": "But an important point\nis this range ambiguity",
    "start": "959030",
    "end": "966590"
  },
  {
    "text": "it's only a problem to\nsolve when you cold start your receiver.",
    "start": "966590",
    "end": "971750"
  },
  {
    "text": "And by cold start you\nmean, you just turn it on. You have no idea where you are. It's the very first position\nfixed that you want to make.",
    "start": "971750",
    "end": "978079"
  },
  {
    "text": "And then you have this\nambiguity problem. As soon as your first position\nfix comes in for the next one,",
    "start": "978080",
    "end": "985820"
  },
  {
    "text": "you can always use your previous\nestimate to disambiguate. Because remember, for\ninstance, the C/A code",
    "start": "985820",
    "end": "992420"
  },
  {
    "text": "is updating every millisecond. So in principle,\nevery millisecond you can update your position.",
    "start": "992420",
    "end": "998060"
  },
  {
    "text": "And in a millisecond, you're\nnot going to move by much or your pseudorange is not\ngoing to change by much.",
    "start": "998060",
    "end": "1003590"
  },
  {
    "text": "So you can always look\nat the previous one and then go back\nto the simple idea. And say, OK, my\nprevious pseudorange",
    "start": "1003590",
    "end": "1009940"
  },
  {
    "text": "was 25,000 kilometers. My next one I just choose the\npeak that is close to that.",
    "start": "1009940",
    "end": "1017270"
  },
  {
    "text": "So this is again, it's only a\nchallenge after a cold start, you do your first thing.",
    "start": "1017270",
    "end": "1023260"
  },
  {
    "text": "And then you get going\nwith the simple method of range disambiguation.",
    "start": "1023260",
    "end": "1030130"
  },
  {
    "text": "So with this, I think,\nwe have cleared the two important things that\nthe receiver needs to do.",
    "start": "1030130",
    "end": "1037119"
  },
  {
    "text": "We now know how the\nlocations in orbit are calculated for\nthe satellites.",
    "start": "1037119",
    "end": "1042189"
  },
  {
    "text": "And we also know\nhow time of flight is calculated using\nthe ranging coded. The one thing we have\nnot clarified yet",
    "start": "1042190",
    "end": "1049300"
  },
  {
    "text": "is based on two things. One is how Doppler\nshift is estimated and how is the timing\noffset compensated for.",
    "start": "1049300",
    "end": "1057460"
  },
  {
    "text": "So we'll talk about those. And, of course, we\nhave not yet gotten to a point where we actually use\nthese pseudorange measurements",
    "start": "1057460",
    "end": "1065710"
  },
  {
    "text": "to localize ourselves. That's also a topic after\nthe discussion for today.",
    "start": "1065710",
    "end": "1070909"
  },
  {
    "text": "Any questions before we-- Continue. OK, so we talked a\nlot about the physics.",
    "start": "1070910",
    "end": "1079809"
  },
  {
    "text": "We developed a signal model. We also developed a\nmathematical model of how ranging using\nthese codes work.",
    "start": "1079810",
    "end": "1086920"
  },
  {
    "text": "Now, we are at a level where\nwe can start looking at the GPS receiver from a system level.",
    "start": "1086920",
    "end": "1093009"
  },
  {
    "text": "So now we're going to build\na system model for the GPS",
    "start": "1093010",
    "end": "1098920"
  },
  {
    "text": "receiver. Let's look at the\ntransmitter very briefly. We're not going to spend\ntoo much time on it. So this is the satellite model.",
    "start": "1098920",
    "end": "1106360"
  },
  {
    "text": "In reality, it's a lot\nmore complex than this. But what we care about is that\nthere's a local oscillator that",
    "start": "1106360",
    "end": "1112060"
  },
  {
    "text": "generates a carrier frequency. And then there are two\nsignals modulated on it. So there is the x of t\nwhich is our ranging code--",
    "start": "1112060",
    "end": "1118930"
  },
  {
    "text": "let's say the C/A code. And then there is a d e t,\nwhich is the navigation message. And the data rates\nare very different.",
    "start": "1118930",
    "end": "1127250"
  },
  {
    "text": "One is very fast--\nmegabits per second. The other one is very\nslow-- bits per second. And then basically, the\nsignal is transmitted",
    "start": "1127250",
    "end": "1134409"
  },
  {
    "text": "to us via an antenna. And this is the signal model.",
    "start": "1134410",
    "end": "1139520"
  },
  {
    "text": "And here-- just to make the\nmath a little more tractable-- we're ignoring the quadrature.",
    "start": "1139520",
    "end": "1145810"
  },
  {
    "text": "So we assume, for now,\nwe are only transmitting an n-phase component. So that's why there is\njust a cosine 2 pi f c t.",
    "start": "1145810",
    "end": "1153070"
  },
  {
    "text": "We are ignoring the sine. Just to make the math a\nlittle easier to track.",
    "start": "1153070",
    "end": "1159160"
  },
  {
    "text": "But everything we\nsay is general. Even if you have both\nquadrature in there, everything will work out.",
    "start": "1159160",
    "end": "1165010"
  },
  {
    "text": "So that's the transmitter part. We're going to spend a lot more\ntime on the receiver system architecture.",
    "start": "1165010",
    "end": "1170240"
  },
  {
    "text": "So this is what it looks like. So this is like a\nsystem block diagram",
    "start": "1170240",
    "end": "1175270"
  },
  {
    "text": "of what a GPS receiver is. It, of course, has an antenna. It's going to receive a\nsignal called that s r of t.",
    "start": "1175270",
    "end": "1184840"
  },
  {
    "text": "And then from a high level\nfunctional point of view, these are the main\nblocks in the receiver.",
    "start": "1184840",
    "end": "1192790"
  },
  {
    "text": "There's an RF front-end. And then the signal from\nthere goes to an analog to digital conversion\nblock or an ADC.",
    "start": "1192790",
    "end": "1199540"
  },
  {
    "text": "Then there is a\ndemodulation block which takes input\nfrom a numerically",
    "start": "1199540",
    "end": "1205480"
  },
  {
    "text": "controlled oscillator, NCO. And then the output\nfrom that goes to the correlator which has an\ninput from a local code replica",
    "start": "1205480",
    "end": "1214810"
  },
  {
    "text": "generator. And at the output\nof the correlation, we need to basically\nfind and track",
    "start": "1214810",
    "end": "1221200"
  },
  {
    "text": "the peak index\nwhich basically is a measure of the pseudorange.",
    "start": "1221200",
    "end": "1227960"
  },
  {
    "text": "The demodulation block\nspecifically what it does is that it finds, and tracks,\nand cancels the Doppler",
    "start": "1227960",
    "end": "1234580"
  },
  {
    "text": "shift for us as we'll see. And the correlation\nblock as we know, basically finds and tracks\nplus tau d or the pseudorange.",
    "start": "1234580",
    "end": "1246550"
  },
  {
    "text": "So this is high level. Now, what we are\ngoing to do is we are going to double click\non each box if you will",
    "start": "1246550",
    "end": "1253540"
  },
  {
    "text": "and go a level deeper. And track the signal\nfrom the input to the antenna all the way to\nthe output of the correlator.",
    "start": "1253540",
    "end": "1260230"
  },
  {
    "text": "And basically do\nthe full derivation of what happens to\nour signal as it's",
    "start": "1260230",
    "end": "1266470"
  },
  {
    "text": "processed through the system. So first, let's look\nat the RF front-end.",
    "start": "1266470",
    "end": "1272860"
  },
  {
    "text": "So this here--\neverything you see here is basically inside\nthe RF front-end.",
    "start": "1272860",
    "end": "1278190"
  },
  {
    "text": "So we're zooming in\nand seeing what's happening inside what we\ncall the RF front-end.",
    "start": "1278190",
    "end": "1283809"
  },
  {
    "text": "So there is a signal\ncoming in, that's SR. That's the power\nin it, root 2 PR.",
    "start": "1283810",
    "end": "1291870"
  },
  {
    "text": "And then there's the navigation\nand the code signal that are delayed by the time of flight--",
    "start": "1291870",
    "end": "1298440"
  },
  {
    "text": "so d ft minus tau,\nx of t minus tau. And then you have\nyour carrier that is",
    "start": "1298440",
    "end": "1305010"
  },
  {
    "text": "shifted by the Doppler shift. So you get 2 pi of fc which is\nthe nominal carrier frequency",
    "start": "1305010",
    "end": "1310200"
  },
  {
    "text": "plus the Doppler shift. And there is some phase\nshift due to basically",
    "start": "1310200",
    "end": "1316309"
  },
  {
    "text": "the propagation delays. And just to make our\nmodel more complete,",
    "start": "1316310",
    "end": "1321419"
  },
  {
    "text": "we are adding a noise term here. So this n ft is the noise term.",
    "start": "1321420",
    "end": "1327000"
  },
  {
    "text": "And then it can be any\nnoise model-- usually, white Gaussian noise is what's\nassumed for these systems.",
    "start": "1327000",
    "end": "1332850"
  },
  {
    "text": "But it can be anything. So what happens\nhere is first, you have a low noise amplifier--",
    "start": "1332850",
    "end": "1339480"
  },
  {
    "text": "LNA. And we assume it\nhas some gain, g. And then the signal goes\nthrough a RF band-pass filter",
    "start": "1339480",
    "end": "1347309"
  },
  {
    "text": "centered at the nominal\nk of frequency f sub c. Why do we have the filter? Because we only want to work\nwith where the information is.",
    "start": "1347310",
    "end": "1356370"
  },
  {
    "text": "Everything that is far away\nfrom the carrier frequency is just noise and interference\nthat we want to filter out",
    "start": "1356370",
    "end": "1363179"
  },
  {
    "text": "as early as possible. Then we have our first\ndemodulation step. So what happens here is,\nwe have a local oscillator",
    "start": "1363180",
    "end": "1372360"
  },
  {
    "text": "that is generating this sine\nwave at the nominal carrier frequency offsetted\nit with what is called",
    "start": "1372360",
    "end": "1380160"
  },
  {
    "text": "the intermediate frequency. So it's generating a cosine\n2 pi fc minus f i s t.",
    "start": "1380160",
    "end": "1387330"
  },
  {
    "text": "Why that? Why not just demodulate by fc?",
    "start": "1387330",
    "end": "1392820"
  },
  {
    "text": "Why are we going to this\nintermediate frequency? It's an architecture decision. There's nothing\nwrong with going--",
    "start": "1392820",
    "end": "1399300"
  },
  {
    "text": "basically, demodulating\nright down to fc. But this idea-- which is\ncalled the heterogeneous",
    "start": "1399300",
    "end": "1405060"
  },
  {
    "text": "architecture-- it's used\na lot in communications. And the reason is, usually, if\nyou look at the noise spectrum,",
    "start": "1405060",
    "end": "1413460"
  },
  {
    "text": "the closer you get to dc,\nthings get more noisy. There's the 1 over f noise.",
    "start": "1413460",
    "end": "1419640"
  },
  {
    "text": "There's other effects\nthat make the dc portion of the spectrum pretty noisy.",
    "start": "1419640",
    "end": "1425170"
  },
  {
    "text": "So you want to delay\nbringing your signal down to that part of the spectrum\nto the digital domain.",
    "start": "1425170",
    "end": "1432570"
  },
  {
    "text": "Because then you don't mix in\nall these analog low frequency noises to your signal.",
    "start": "1432570",
    "end": "1438610"
  },
  {
    "text": "So you first bring it just-- if I were to draw a\npicture of the spectrum.",
    "start": "1438610",
    "end": "1445630"
  },
  {
    "text": "So if this is f, what\nyou receive first is centered at fc which\nis your k frequency.",
    "start": "1445630",
    "end": "1451200"
  },
  {
    "text": "Well, technically, fc\nplus a Doppler shift. Doppler shift is\na small relative",
    "start": "1451200",
    "end": "1456299"
  },
  {
    "text": "to your carrier frequency. This is kilohertz. Carrier is gigahertz.",
    "start": "1456300",
    "end": "1461850"
  },
  {
    "text": "But anyway, so you have\nsome signal around this. And the first step\nbrings this down.",
    "start": "1461850",
    "end": "1470320"
  },
  {
    "text": "And let's say this is zero. Brings this down to some\nintermediate frequency. ",
    "start": "1470320",
    "end": "1478410"
  },
  {
    "text": "Still we have the fd offset. So you come here.",
    "start": "1478410",
    "end": "1483960"
  },
  {
    "text": "And then later in d s p,\nyou bring it further down as we'll see to base plan. And then you do\nyour correlation.",
    "start": "1483960",
    "end": "1489720"
  },
  {
    "text": "And again, the reason you come\nhere first and not directly to around dc is that,\nthere's a lot of noise",
    "start": "1489720",
    "end": "1496770"
  },
  {
    "text": "usually around here. So there's noise. And you don't want\nto directly bring",
    "start": "1496770",
    "end": "1502470"
  },
  {
    "text": "your signal to the noisiest\npart of the spectrum. It's just one\narchitecture choice.",
    "start": "1502470",
    "end": "1507779"
  },
  {
    "text": "There are systems\nthat do homodyne which brings it directly to the dc.",
    "start": "1507780",
    "end": "1515190"
  },
  {
    "text": "So let's see, what\nmathematically, what happens to our signal. So what happens is\nthat, well, first, s",
    "start": "1515190",
    "end": "1521610"
  },
  {
    "text": "is multiplied by the gain\nof the low noise amplifier. We are just modeling\nit as a gain block.",
    "start": "1521610",
    "end": "1526980"
  },
  {
    "text": "So we are not\ngoing to the detail of what the actual\nfrequency response of this",
    "start": "1526980",
    "end": "1533690"
  },
  {
    "text": "is-- just assume\nsignal is in-band. And it's just this g multiplier. And then you filter it.",
    "start": "1533690",
    "end": "1539150"
  },
  {
    "text": "And then the important\nthings happens at this mixer\nwhere you basically multiply this local oscillator\noutput with your signal.",
    "start": "1539150",
    "end": "1547919"
  },
  {
    "text": "So you get cosine of fc minus f\ni s times cosine of fc plus fd.",
    "start": "1547920",
    "end": "1553310"
  },
  {
    "text": "And you get two cross terms. One is at the sum frequency. One is at the\ndifference frequency.",
    "start": "1553310",
    "end": "1558770"
  },
  {
    "text": "The sum of the-- the difference of the two\nfrequencies, the f carrier",
    "start": "1558770",
    "end": "1563810"
  },
  {
    "text": "cancels out. And you're left\nwith this frequency which is your Doppler shift\nplus the intermediate frequency.",
    "start": "1563810",
    "end": "1570590"
  },
  {
    "text": "And the second term is\nthat the sum which goes to twice the carrier frequency. So you go to 2fc plus\nf sub d minus f i f.",
    "start": "1570590",
    "end": "1580460"
  },
  {
    "text": "Then what you do is you put\na band-pass filter centered at the intermediate frequency. And what the band-pass\nfilter does is,",
    "start": "1580460",
    "end": "1587030"
  },
  {
    "text": "it filters out this part,\nthis term, which is a 2fc. Because again, in this\npicture, the one that's a 2fc",
    "start": "1587030",
    "end": "1595160"
  },
  {
    "text": "this goes way out. That copy would be\nhere centered at 2fc.",
    "start": "1595160",
    "end": "1601490"
  },
  {
    "text": "And then when you band-pass\nfilter around here, this guy goes up.",
    "start": "1601490",
    "end": "1607830"
  },
  {
    "text": "So that's what the band-pass\nfilter does for you. And what comes out we call\nit the intermediate frequency",
    "start": "1607830",
    "end": "1614000"
  },
  {
    "text": "or s i f signal. Yes. [INAUDIBLE] ",
    "start": "1614000",
    "end": "1619805"
  },
  {
    "text": "Great question. So the question is, why is there\na phase shift theta hat, theta",
    "start": "1619805",
    "end": "1625820"
  },
  {
    "text": "tilde, in the local oscillator? Because it's not phase locked\nto the received signal.",
    "start": "1625820",
    "end": "1634140"
  },
  {
    "text": "So that's just a non\nreality in the system. So the received signal is coming\nwith some unknown phase theta.",
    "start": "1634140",
    "end": "1642110"
  },
  {
    "text": "And I'm generating\nsome sine wave. So this also has its\nown phase because I",
    "start": "1642110",
    "end": "1647120"
  },
  {
    "text": "don't know the phase of\nthe carrier to lock to it. My local oscillator\nis free running.",
    "start": "1647120",
    "end": "1652190"
  },
  {
    "text": "So its output is going\nto have some theta tilde. Can't you just make the theta\non the signal relative to--",
    "start": "1652190",
    "end": "1659765"
  },
  {
    "text": "You can, yes. Maybe that's a better choice. But I want it to be more\nexplicit in like what's",
    "start": "1659765",
    "end": "1668900"
  },
  {
    "text": "phase locked and what's not. So I'm like intentionally\nadding the two thetas.",
    "start": "1668900",
    "end": "1673973"
  },
  {
    "text": "But you're absolutely right. I mean, mathematically,\nyou can just say theta is relative to\nmy low and make this zero.",
    "start": "1673973",
    "end": "1680840"
  },
  {
    "text": "Perfectly fine.  Let's continue.",
    "start": "1680840",
    "end": "1686850"
  },
  {
    "text": "OK. So this is again, this\nSIF is what comes out of your low pass filter.",
    "start": "1686850",
    "end": "1692480"
  },
  {
    "text": "Just this term at the double,\nthe 2fc is filtered out",
    "start": "1692480",
    "end": "1699320"
  },
  {
    "text": "and you're left with what\nis d of t minus t minus l",
    "start": "1699320",
    "end": "1705289"
  },
  {
    "text": "times cosine of the Doppler\nplus intermediate frequency plus the delta theta.",
    "start": "1705290",
    "end": "1711000"
  },
  {
    "text": "So in your notation,\nthis is the delta theta. So I'm just calling\ntheta minus theta",
    "start": "1711000",
    "end": "1717020"
  },
  {
    "text": "till the delta theta and\nthat's exactly your suggestion. And then your noise\nis still there.",
    "start": "1717020",
    "end": "1723620"
  },
  {
    "text": "The noise is also going through\nthis entire chain, right? So it gets filtered, it\ngets amplified and filtered",
    "start": "1723620",
    "end": "1729440"
  },
  {
    "text": "and mixed down and\nagain, filtered. So now we are calling it the\nintermediate frequency noise,",
    "start": "1729440",
    "end": "1735110"
  },
  {
    "text": "OK? So next is you have the ABC\nand the Doppler demodulation,",
    "start": "1735110",
    "end": "1742100"
  },
  {
    "text": "right? ADC is easy. So your intermediate frequency\nsignal is coming here. We are just sampling it\nwith some sampling rate, fs",
    "start": "1742100",
    "end": "1749300"
  },
  {
    "text": "or sampling interval t sub s. So you get SIF of n which\nis SIF of n times ds.",
    "start": "1749300",
    "end": "1756620"
  },
  {
    "text": "And here, what we\nhave is basically we want to separate out the\nin-phase and quadrature",
    "start": "1756620",
    "end": "1765110"
  },
  {
    "text": "components of our signal, right? And we also want to compensate\nor cancel out the Doppler",
    "start": "1765110",
    "end": "1771409"
  },
  {
    "text": "shift, right? So we have what we call\na numerically controlled",
    "start": "1771410",
    "end": "1776600"
  },
  {
    "text": "oscillator. So it is an oscillator whose\noutput frequency and phase",
    "start": "1776600",
    "end": "1783260"
  },
  {
    "text": "can be controlled by a\nnumerical input, right? So it takes in kind of like a\nnominal oscillator or a fixed",
    "start": "1783260",
    "end": "1789800"
  },
  {
    "text": "oscillator input and\nthen a second input that is kind of like a knob to\ntune the output frequency",
    "start": "1789800",
    "end": "1796220"
  },
  {
    "text": "and phase of this thing, right? And let's say for\nnow, the receiver",
    "start": "1796220",
    "end": "1802580"
  },
  {
    "text": "has some estimate somehow. We'll tell you where this\nis coming from, the f hat",
    "start": "1802580",
    "end": "1807810"
  },
  {
    "text": "but if you have some estimate\nof what the Doppler shift is, you can tune your numerically\ncontrolled oscillator",
    "start": "1807810",
    "end": "1814460"
  },
  {
    "text": "to output sine and a cosine term\nthat is exactly at FIS plus f",
    "start": "1814460",
    "end": "1821090"
  },
  {
    "text": "Doppler or f hat Doppler. So f hat Doppler is\nthe receiver's estimate",
    "start": "1821090",
    "end": "1827299"
  },
  {
    "text": "of the Doppler shift. OK? And if FIF, the\nintermediate frequency is known so because the\nreceiver knows where it brought",
    "start": "1827300",
    "end": "1837240"
  },
  {
    "text": "or what intermediate\nfrequency it's using. And then you have to do\nanother mixing basically",
    "start": "1837240",
    "end": "1843870"
  },
  {
    "text": "of your discrete ties IF signal. And one is mixing with a\ncosine term the other one is",
    "start": "1843870",
    "end": "1850020"
  },
  {
    "text": "mixing with a sine term. And this is just\nsome algebra here.",
    "start": "1850020",
    "end": "1856350"
  },
  {
    "text": "Again, you multiply\nthe two terms you get-- or multiply them and you get two\ntimes one at the sum frequency,",
    "start": "1856350",
    "end": "1864090"
  },
  {
    "text": "one at the difference frequency. And if you put a low\npass filter here, it only gives you the\ndifference frequency output.",
    "start": "1864090",
    "end": "1872220"
  },
  {
    "text": "The sum gets\nfiltered out exactly as it happened with\nthe first mixer",
    "start": "1872220",
    "end": "1877860"
  },
  {
    "text": "and you're left with this. So again, we have discrete ties. So now we have df nts x\nminus tau times x of nts",
    "start": "1877860",
    "end": "1885660"
  },
  {
    "text": "minus tau times the\ncosine of-- this is again, we are keeping just the\ndifference frequency, which",
    "start": "1885660",
    "end": "1891960"
  },
  {
    "text": "is the actual Doppler\nshift minus our estimate of the Doppler shift, right?",
    "start": "1891960",
    "end": "1897030"
  },
  {
    "text": "So you get fd minus f hat d\nplus some phase turn, right? And noise is also\njust carrying through.",
    "start": "1897030",
    "end": "1905610"
  },
  {
    "text": "Here again-- so we now\nhave two outputs, right? There is an end phase and\nthere is a quadrature.",
    "start": "1905610",
    "end": "1911519"
  },
  {
    "text": "So that's the si and the sq\nis exact same, except you have a sine instead\nof a cosine, right?",
    "start": "1911520",
    "end": "1918330"
  },
  {
    "text": "Now here's something\ninteresting. If somehow your estimate of\nthe Doppler shift is perfect,",
    "start": "1918330",
    "end": "1926539"
  },
  {
    "text": "both the frequency\nand the phase, then what happens if\nyour estimate is perfect",
    "start": "1926540",
    "end": "1932600"
  },
  {
    "text": "is this term is zero, right? The delta theta is also zero.",
    "start": "1932600",
    "end": "1938360"
  },
  {
    "text": "So you get cosine of\nzero for your end phase, which is one, right? What do we get for\nthe quadrature?",
    "start": "1938360",
    "end": "1944990"
  },
  {
    "text": "Same thing. So the argument of the\nsine term becomes zero.",
    "start": "1944990",
    "end": "1950000"
  },
  {
    "text": "You get sine of zero which is\nzero so your quadrature term becomes just noise, right?",
    "start": "1950000",
    "end": "1957500"
  },
  {
    "text": "Which exactly makes sense. So if you are correctly\nestimating and tracking",
    "start": "1957500",
    "end": "1964640"
  },
  {
    "text": "your Doppler shift and\nthat phase term here, your SI signal just becomes some\nconstant times the LNAB message",
    "start": "1964640",
    "end": "1973220"
  },
  {
    "text": "times the coding\nrange plus noise and your quadrature\nsignal becomes just noise,",
    "start": "1973220",
    "end": "1978990"
  },
  {
    "text": "which makes complete\nsense because we started with the assumption that we\nare not transmitting anything in the quadrature, right?",
    "start": "1978990",
    "end": "1985220"
  },
  {
    "text": "So, of course, our quadrature\noutput for now is just noise. If you had a q component, you\nwould get some real output",
    "start": "1985220",
    "end": "1992629"
  },
  {
    "text": "in here, OK? Again, this is-- I'm going really\ndetailed in here",
    "start": "1992630",
    "end": "1998600"
  },
  {
    "text": "because I think\nit's important to be comfortable with this type\nof system level analysis. You have a system\ndesign, the blocks.",
    "start": "1998600",
    "end": "2005470"
  },
  {
    "text": "You kind of break it down\nand track your signal down the chain and\nyou can exactly",
    "start": "2005470",
    "end": "2011470"
  },
  {
    "text": "derive what is\nhappening to the signal as it's going through\neach of these blocks, OK?",
    "start": "2011470",
    "end": "2016570"
  },
  {
    "text": "So now we are on to\nsomething, right? Because if you look at\nhere, we have gotten rid",
    "start": "2016570",
    "end": "2022150"
  },
  {
    "text": "of all the carrier modulation\nand the Doppler shift, right? And we have kind of down\nto what we care for.",
    "start": "2022150",
    "end": "2029350"
  },
  {
    "text": "We want to get to a point where\nwe just have the delayed x and then we can correlate\nit with our local replica",
    "start": "2029350",
    "end": "2035320"
  },
  {
    "text": "and find the peak and we're\nvery, very close to that. In fact, we are\nexactly there why",
    "start": "2035320",
    "end": "2040720"
  },
  {
    "text": "because here what we\ndon't like is-- well, this is just a constant\ng times root p. That's fine.",
    "start": "2040720",
    "end": "2046420"
  },
  {
    "text": "Multiplicative\nconstant, don't care. Noise is always there. You're never going\nto get completely rid",
    "start": "2046420",
    "end": "2051908"
  },
  {
    "text": "of noise so fine. It's going to be\nsome noise added to the output of the correlated. It's the lab message here\nthat's annoying, right?",
    "start": "2051909",
    "end": "2062690"
  },
  {
    "text": "But is it really annoying? And the answer is no.",
    "start": "2062690",
    "end": "2068480"
  },
  {
    "text": "Why is the answer no? Because remember, this d\nvaries very, very slowly",
    "start": "2068480",
    "end": "2074379"
  },
  {
    "text": "compared to the coding signal. I'm sorry, ranging code.",
    "start": "2074380",
    "end": "2081408"
  },
  {
    "text": "And because this varies\nvery, very slowly, you can assume this\nd is also constant. On the time scales that\nyou care for correlation",
    "start": "2081409",
    "end": "2089199"
  },
  {
    "text": "like milliseconds,\nyou can assume D is just either a plus\none or a minus one, which also is related\nto the question raised",
    "start": "2089199",
    "end": "2099400"
  },
  {
    "text": "earlier that why do we\ntake the absolute value out of the correlated?",
    "start": "2099400",
    "end": "2105380"
  },
  {
    "text": "This is another case where\nthere could be a sign shift if our d is equal to\nminus 1 versus a plus 1,",
    "start": "2105380",
    "end": "2112000"
  },
  {
    "text": "that could make a sine shift\nat the output of the correlated but we take the absolute value\nso that that's not important.",
    "start": "2112000",
    "end": "2118670"
  },
  {
    "text": "OK. So then we are essentially done. So all we need to do is now\nrun a correlation on this d",
    "start": "2118670",
    "end": "2126490"
  },
  {
    "text": "modulated and Doppler\ncompensated signal and find a peak. The way the receiver operates is\ninstead of actually generating",
    "start": "2126490",
    "end": "2136599"
  },
  {
    "text": "one fixed replica\ncode and calculating the correlation for all\npossible values of n",
    "start": "2136600",
    "end": "2144400"
  },
  {
    "text": "and then doing a\npeak search, instead it does it the other way around. It generates a\nshifted replica code",
    "start": "2144400",
    "end": "2152500"
  },
  {
    "text": "by what it thinks the\ntime of flight is. So it generates an\nx of nts plus tau",
    "start": "2152500",
    "end": "2159220"
  },
  {
    "text": "d-- this is the time\ndelay, plus tau hat, which is the receiver's estimate\nof the time of flight",
    "start": "2159220",
    "end": "2167290"
  },
  {
    "text": "and then it looks at the\ncorrelation just at the zero index, right?",
    "start": "2167290",
    "end": "2172360"
  },
  {
    "text": "And if this tau hat is\ncorrect, then the peak would happen at zero.",
    "start": "2172360",
    "end": "2178840"
  },
  {
    "text": "Does this make sense? So instead of basically\ncalculating rx hat y of n",
    "start": "2178840",
    "end": "2193790"
  },
  {
    "text": "as a function of n and then\nsearching through this function",
    "start": "2193790",
    "end": "2199550"
  },
  {
    "text": "and finding where\nour N hat tau is. This is one way of doing it. The receiver actually\njust monitors",
    "start": "2199550",
    "end": "2207380"
  },
  {
    "text": "the output of the\ncorrelator at zero and instead finds r\nhat of n minus n tau",
    "start": "2207380",
    "end": "2215700"
  },
  {
    "text": "and various the n tau as\nenough to bring this as-- it's a linear operation, right?",
    "start": "2215700",
    "end": "2221700"
  },
  {
    "text": "So if you shift the input,\nthe peak is going to shift. You can always just\nmonitor the value of the correlation at zero.",
    "start": "2221700",
    "end": "2228060"
  },
  {
    "text": "And if this shift value\nis equal to N hat, you bring this peak to zero.",
    "start": "2228060",
    "end": "2236790"
  },
  {
    "text": "And if you maximize\nthis value, that means you found the\ncorrect and N hat.",
    "start": "2236790",
    "end": "2243390"
  },
  {
    "text": "So that's how the receiver\nactually operates. It's generates the\nshifted version of--",
    "start": "2243390",
    "end": "2249900"
  },
  {
    "text": "shifted replica of the\ncode and varies the shift, varies the tau hat until the\noutput of the correlated at 0",
    "start": "2249900",
    "end": "2259380"
  },
  {
    "text": "is maximized. And then it's like,\noh, I found the tau hat because it's\nperfectly aligned what",
    "start": "2259380",
    "end": "2265500"
  },
  {
    "text": "I receive with the shifted\nreplica of the coat and that's my tau hat. OK.",
    "start": "2265500",
    "end": "2270690"
  },
  {
    "text": "And mathematically again,\nthis is what it is. Don't get scared off by this.",
    "start": "2270690",
    "end": "2276210"
  },
  {
    "text": "I've put everything\nin there and just so you get comfortable\nwith this level of detail",
    "start": "2276210",
    "end": "2283650"
  },
  {
    "text": "when you're analyzing\nyour system. But we can break it down. Again, this is just all the\nmultiplicative constants,",
    "start": "2283650",
    "end": "2291700"
  },
  {
    "text": "right? G was the gain of the\nlow noise amplifier. Root pr is the received\nbasically signal power.",
    "start": "2291700",
    "end": "2298170"
  },
  {
    "text": "D is our navigation message. I'm taking it out\nof the summation because we said we can assume\nit's a constant, right?",
    "start": "2298170",
    "end": "2304560"
  },
  {
    "text": "So this d is either\na plus 1 or a minus 1 depending on what the\nvalue of the lnab message",
    "start": "2304560",
    "end": "2309839"
  },
  {
    "text": "was at the time. This one over nc\nis just a constant for the cyclic\ncorrelation because it's",
    "start": "2309840",
    "end": "2316920"
  },
  {
    "text": "a normalization constant\nby the number of samples. And then the summation inside\nis this is what you've received,",
    "start": "2316920",
    "end": "2324420"
  },
  {
    "text": "X of NTS minus tau, right? The discrete ties ranging code.",
    "start": "2324420",
    "end": "2330090"
  },
  {
    "text": "This one is what the\nreceiver generates, right? So it's the copy of the code or\nthe local replica of the code,",
    "start": "2330090",
    "end": "2338410"
  },
  {
    "text": "which is anti [INAUDIBLE]. Again, it's sampled at\nthe same sampling rate. There is a plus tau d here.",
    "start": "2338410",
    "end": "2345030"
  },
  {
    "text": "That's the timing\noffset of the receiver. And then this tau\nhat again, is what",
    "start": "2345030",
    "end": "2352080"
  },
  {
    "text": "we are trying to find and\nmatch it to tau, right?",
    "start": "2352080",
    "end": "2357450"
  },
  {
    "text": "So the receiver very\ntau hat and looks",
    "start": "2357450",
    "end": "2362720"
  },
  {
    "text": "at this number, which is\nthe value of the correlation at zero and when this\nnumber SI is maximized,",
    "start": "2362720",
    "end": "2369380"
  },
  {
    "text": "that means your tau hat is\nequal to tau because you have perfectly aligned things.",
    "start": "2369380",
    "end": "2374630"
  },
  {
    "text": "Yes. Can tau d be equal\nto [INAUDIBLE].. Oh, yeah. You're exactly right.",
    "start": "2374630",
    "end": "2380780"
  },
  {
    "text": "It's actually tau\nhat minus tau d. I was assuming tau d is zero\nbut you're absolutely right.",
    "start": "2380780",
    "end": "2387140"
  },
  {
    "text": "Again, what is this cosine? We'll get to that but\nlet me finish this. So what is this\ncosine term here? That's basically the\nresidual modulation",
    "start": "2387140",
    "end": "2396290"
  },
  {
    "text": "if your estimate of the Doppler\nshift is not perfect, right? So this delta f here is\nthe actual Doppler shift",
    "start": "2396290",
    "end": "2404840"
  },
  {
    "text": "minus your estimate\nof the Doppler shift. If you are estimating the\nDoppler shift perfectly,",
    "start": "2404840",
    "end": "2410869"
  },
  {
    "text": "this becomes zero. The delta theta becomes zero\nand this whole cosine term becomes 1.",
    "start": "2410870",
    "end": "2416450"
  },
  {
    "text": "It doesn't matter, right? But it's very\nimportant because this means if you are not estimating\nyour Doppler shift correctly,",
    "start": "2416450",
    "end": "2425300"
  },
  {
    "text": "you get this extra cosine\nterm inside the summation and that can completely kill\nthe output of your corelator",
    "start": "2425300",
    "end": "2433280"
  },
  {
    "text": "as we'll see. So that's why it's essential\nto have Doppler compensation. If you don't, it\ncan significantly",
    "start": "2433280",
    "end": "2440480"
  },
  {
    "text": "reduce that peak value\nor even entirely kill it. ",
    "start": "2440480",
    "end": "2447650"
  },
  {
    "text": "So just to summarize,\nagain, we are assuming the DFT is equal\nto either plus or minus 1.",
    "start": "2447650",
    "end": "2453230"
  },
  {
    "text": "So we assume it constant in the\ntimescales of the correlation.",
    "start": "2453230",
    "end": "2459109"
  },
  {
    "text": "And to maximize what we call\ns sub I output, two things",
    "start": "2459110",
    "end": "2466610"
  },
  {
    "text": "need to happen for that\nthing to get maximized. One is as I said, you have\nto track and compensate",
    "start": "2466610",
    "end": "2473660"
  },
  {
    "text": "for Doppler correctly so that\ndelta f term should be zero, which means your estimate\nof the Doppler shift",
    "start": "2473660",
    "end": "2479599"
  },
  {
    "text": "should be equal to the\nactual Doppler shift and also your\nestimate of the phase should be the actual\nphase and that",
    "start": "2479600",
    "end": "2486590"
  },
  {
    "text": "makes that cosine term zero. That's number one. Number two, which is exactly\nwhat Tom said is your tau hat",
    "start": "2486590",
    "end": "2493640"
  },
  {
    "text": "should be equal\nto tau plus tau d. And the tau had again\nis like as you generate",
    "start": "2493640",
    "end": "2499220"
  },
  {
    "text": "this local replica of the\ncode, you're shifting it around by tau hat and seeing\nat what value of it",
    "start": "2499220",
    "end": "2507230"
  },
  {
    "text": "I'm maximizing my\ncorrelator output and the value at\nwhich it maximizes is exactly tau plus tau d.",
    "start": "2507230",
    "end": "2514010"
  },
  {
    "text": "If tau d was 0 if you\nhad no timing offset, that means you had found the\nactual physical time of flight.",
    "start": "2514010",
    "end": "2519170"
  },
  {
    "text": "But because it's\nalways non-zero, you find the time of flight\nplus your timing delay.",
    "start": "2519170",
    "end": "2524599"
  },
  {
    "text": "OK? And this is graphically\nwhat happens. Again, assume we\nare plotting things",
    "start": "2524600",
    "end": "2531950"
  },
  {
    "text": "as a function of the hat, which\nis how much the receiver shifts around the replica\ncode that is generating",
    "start": "2531950",
    "end": "2540440"
  },
  {
    "text": "and this is the output\nof the correlator plotted as a\nfunction of tau hat. So it's a small, small,\nsmall, small, small, small and",
    "start": "2540440",
    "end": "2546800"
  },
  {
    "text": "suddenly peaks and it\npeaks where your tau hat is equal to tau plus tau d. And once you find that peak,\nyou just hold it there.",
    "start": "2546800",
    "end": "2553970"
  },
  {
    "text": "You're like I found the peak\nand that's my time of flight, right?",
    "start": "2553970",
    "end": "2559490"
  },
  {
    "text": "Or time of flight\nplus my timing offset. So this is for in phase. The quadrature\noutput is just noise",
    "start": "2559490",
    "end": "2566190"
  },
  {
    "text": "so you just feed\nnoise to the core later you get noise\nout there's no peak and that makes sense because\nwe didn't send anything",
    "start": "2566190",
    "end": "2573170"
  },
  {
    "text": "over the quadrature\nin this example. If you had another\ncode over quadrature, that correlator would also\nhave its own peak related",
    "start": "2573170",
    "end": "2581630"
  },
  {
    "text": "to the other ranging code. Any questions? ",
    "start": "2581630",
    "end": "2587470"
  },
  {
    "text": "Does everything\nreally make sense? Because some stuff should\nnot fully make sense so",
    "start": "2587470",
    "end": "2593650"
  },
  {
    "text": "feel free to ask questions. It's important to\nclarify things.",
    "start": "2593650",
    "end": "2598810"
  },
  {
    "text": "Still no questions? All right.  OK.",
    "start": "2598810",
    "end": "2605990"
  },
  {
    "text": "So this was like\nat a system level. Again, let's look at\nthis slide real quick.",
    "start": "2605990",
    "end": "2615390"
  },
  {
    "text": "So we fully basically\ntrace signal from the input of\nour receiver system",
    "start": "2615390",
    "end": "2621840"
  },
  {
    "text": "through the entire signal\nchain from the amplification,",
    "start": "2621840",
    "end": "2627430"
  },
  {
    "text": "the heterodox down conversion,\nanalog to digital conversion",
    "start": "2627430",
    "end": "2632490"
  },
  {
    "text": "and then the second step the\nmodulation with the Doppler tracking and then\nfinally, the correlation",
    "start": "2632490",
    "end": "2640109"
  },
  {
    "text": "and then tracking basic\nor finding this peak at the correlated\noutput, which happens",
    "start": "2640110",
    "end": "2647160"
  },
  {
    "text": "when two things are correct. One is our estimate of\nDoppler should be correct",
    "start": "2647160",
    "end": "2653400"
  },
  {
    "text": "and our estimate of\nbasically the time of flight plus our timing offset\nshould be correct.",
    "start": "2653400",
    "end": "2661260"
  },
  {
    "text": "And that's when we get a\nlarge peak at the output of the correlator, OK?",
    "start": "2661260",
    "end": "2667440"
  },
  {
    "text": "Now, I still\nhaven't told you how do we make these two\nconditions satisfied, right?",
    "start": "2667440",
    "end": "2673170"
  },
  {
    "text": "So you still need to-- again,\nyou cold start your receiver,",
    "start": "2673170",
    "end": "2678240"
  },
  {
    "text": "how do you estimate\nDoppler and how do you make f hat equal to\nf hat d equal to fd and how",
    "start": "2678240",
    "end": "2684840"
  },
  {
    "text": "do you set your tau\nhat equal to tau d? It's actually pretty\nstraightforward.",
    "start": "2684840",
    "end": "2692140"
  },
  {
    "text": "So that's this idea of\nacquisition and tracking. So after a cold start, there's\ntwo phases of operation",
    "start": "2692140",
    "end": "2698250"
  },
  {
    "text": "for a GPS receiver. The first one is\ncalled acquisition and in the acquisition\nphase, basically the receiver",
    "start": "2698250",
    "end": "2706320"
  },
  {
    "text": "needs to find its first estimate\nof what the Doppler shift is and what the pseudo range is\nor the time equivalent of it,",
    "start": "2706320",
    "end": "2714460"
  },
  {
    "text": "which is tau plus tau D for\nmultiple satellites, right? For at least four\nsatellites, you",
    "start": "2714460",
    "end": "2719730"
  },
  {
    "text": "need to find both the Doppler\nshift and the pseudo range or the time equivalent of it.",
    "start": "2719730",
    "end": "2726240"
  },
  {
    "text": "And after that, that's called\nthe acquisition phase, right? Which is typically slow.",
    "start": "2726240",
    "end": "2731670"
  },
  {
    "text": "It can take 10\nseconds, for instance, for an older GPS receiver. And after you find that first\nestimate for every satellite",
    "start": "2731670",
    "end": "2740819"
  },
  {
    "text": "of FDD and tau plus tau d, then\nyou can go to a tracking phase because from there on--",
    "start": "2740820",
    "end": "2746970"
  },
  {
    "text": "the first estimate is a\nlittle trickier to find but afterwards because you're\noperating on very small time",
    "start": "2746970",
    "end": "2753930"
  },
  {
    "text": "scales, you can just track. These things that are\ngoing to vary slowly. You always have a previous\nestimate of your Doppler shift",
    "start": "2753930",
    "end": "2761460"
  },
  {
    "text": "and for you're\nnot next estimate, you use your previous\nestimate as a starting point and you just track\nthe variations of it",
    "start": "2761460",
    "end": "2770040"
  },
  {
    "text": "around your previous estimate. Same for pseudo range. You always have\nyour previous one",
    "start": "2770040",
    "end": "2775470"
  },
  {
    "text": "and the next one you can just\ntrack how much it changed. So tracking is fast\nbecause you have",
    "start": "2775470",
    "end": "2782430"
  },
  {
    "text": "a very good estimate already of\nwhere these values should be, OK? So let's start with\nthe acquisition.",
    "start": "2782430",
    "end": "2790030"
  },
  {
    "text": "So essentially,\nwhat you have to do, you have a 2D\nsearch space, right?",
    "start": "2790030",
    "end": "2795900"
  },
  {
    "text": "One dimension is Doppler\nshift, the other dimension is tau hat or that time\nequivalent of the pseudo range,",
    "start": "2795900",
    "end": "2803130"
  },
  {
    "text": "right? And what's good is that both\nof these are bounded, right?",
    "start": "2803130",
    "end": "2809760"
  },
  {
    "text": "We set for instance,\nthe Doppler shift for typical applications\nof vehicles and robots",
    "start": "2809760",
    "end": "2817290"
  },
  {
    "text": "on the surface of the Earth\nis bound to plus or minus 10 kilohertz, all right? And then for your tau hat,\nbecause these correlations",
    "start": "2817290",
    "end": "2825090"
  },
  {
    "text": "are periodic you just\nneed to search over one period of the\ncorrelation, which, for instance for a\nCA code, you have",
    "start": "2825090",
    "end": "2831960"
  },
  {
    "text": "10,023 chips to search through. And that's exactly\nwhat the receiver does.",
    "start": "2831960",
    "end": "2839160"
  },
  {
    "text": "So again, for a course\nacquisition code, you have f hat between\nminus 10 and 10 kilohertz.",
    "start": "2839160",
    "end": "2845130"
  },
  {
    "text": "You have tau hat between\n0 and 1 milliseconds. So one millisecond again, is\nthe duration of one full ranging",
    "start": "2845130",
    "end": "2852000"
  },
  {
    "text": "code and you perform 2D search. Here is graphically\nhow it's done.",
    "start": "2852000",
    "end": "2857340"
  },
  {
    "text": "So you have two axes. You have your Doppler shift\ngoing from minus 10 to 10 and you have your tau hat.",
    "start": "2857340",
    "end": "2864780"
  },
  {
    "text": "I'm showing it in units\nof chips but you can also convert that to time. So it goes from 0\nto 1023 or in time,",
    "start": "2864780",
    "end": "2871920"
  },
  {
    "text": "it goes from 0 to 1\nmillisecond, right? And then you do a\ngreat search basically. That's exactly what\nthe receiver does.",
    "start": "2871920",
    "end": "2878430"
  },
  {
    "text": "So you start from one whatever\ncombination like Doppler shift minus 10\nkilohertz and tau hat",
    "start": "2878430",
    "end": "2884340"
  },
  {
    "text": "zero and you monitor the\noutput of your correlator. That's just one number, right?",
    "start": "2884340",
    "end": "2890309"
  },
  {
    "text": "That SI that was coming\nout of your correlator and you do your grid search. You just search the\ngrid in some pattern",
    "start": "2890310",
    "end": "2897640"
  },
  {
    "text": "and when you hit the right\ncombination of Doppler shift and tau hat, you get\na very large output",
    "start": "2897640",
    "end": "2904500"
  },
  {
    "text": "out of your corelator. And you typically have\nsome acquisition threshold and you monitor the\noutput of your later",
    "start": "2904500",
    "end": "2912030"
  },
  {
    "text": "and it goes above that,\nyou're like, all right, I acquired my\nsatellite which means",
    "start": "2912030",
    "end": "2919680"
  },
  {
    "text": "I have a very good estimate\nof both the Doppler shift and the pseudo range, right?",
    "start": "2919680",
    "end": "2927450"
  },
  {
    "text": "You can look at slices\nhere just so you get an idea of how sensitive you\nare to residual errors in tau",
    "start": "2927450",
    "end": "2938490"
  },
  {
    "text": "or in Doppler. Usually, the way these\ncodes behave mathematically",
    "start": "2938490",
    "end": "2944610"
  },
  {
    "text": "is that in tau you're\nextremely sensitive.",
    "start": "2944610",
    "end": "2949950"
  },
  {
    "text": "So here's a slice for-- I'm showing a slice\nof this 2D function",
    "start": "2949950",
    "end": "2955290"
  },
  {
    "text": "for the correct Doppler. So here, already we have\nfound the correct ft and we are just varying\ntau here, right?",
    "start": "2955290",
    "end": "2962910"
  },
  {
    "text": "And you only see\na very sharp peak where your tau hat is\nequal to tau plus tau d",
    "start": "2962910",
    "end": "2969510"
  },
  {
    "text": "and if you're one band off\nessentially or one chip off in code, you get almost nothing.",
    "start": "2969510",
    "end": "2976829"
  },
  {
    "text": "And that's again, because that\nwas the mathematical property of these m sequences. The correlation has\na very sharp peak",
    "start": "2976830",
    "end": "2983670"
  },
  {
    "text": "and then it quickly drops\nto almost zero, right? So that's that.",
    "start": "2983670",
    "end": "2988950"
  },
  {
    "text": "In Doppler, it's a\nlittle more forgiving. So if you look at the slice,\nat the right tau hat--",
    "start": "2988950",
    "end": "2996089"
  },
  {
    "text": "so you have found your\npseudo range correctly and you just have some\nresidual error in Doppler,",
    "start": "2996090",
    "end": "3001250"
  },
  {
    "text": "that's the behavior. It's almost like a\nsync function, right? So at the correct\nDoppler when f hat",
    "start": "3001250",
    "end": "3007880"
  },
  {
    "text": "is equal to the actual Doppler,\nof course, that's its maximum and then it drops. It's still a pretty\nsharp drop, right?",
    "start": "3007880",
    "end": "3014090"
  },
  {
    "text": "So remember that\nlike end to end, this is just 20\nkilohertz, right?",
    "start": "3014090",
    "end": "3019100"
  },
  {
    "text": "But you can be off by\na few hundreds of Hertz and still have a decent output\nout of your correlated but",
    "start": "3019100",
    "end": "3027420"
  },
  {
    "text": "if you're off by more than\nlike to 250 kilohertz or so-- 250 Hertz or so,\nyou almost entirely",
    "start": "3027420",
    "end": "3033600"
  },
  {
    "text": "kill the correlation output. And that's actually\na good thing. This is not a bad\nthing, because the fact",
    "start": "3033600",
    "end": "3040770"
  },
  {
    "text": "that both these peaks\nare reasonably sharp, it means that you\ncan very accurately",
    "start": "3040770",
    "end": "3046140"
  },
  {
    "text": "find both the Doppler shift and\nthe tau hat with the 2D search. So this is the\nacquisition phase and this",
    "start": "3046140",
    "end": "3052710"
  },
  {
    "text": "is why it's slow because\nyou need to do a full 2D search over a grid. And I'll get to your question\nin a second but real quick,",
    "start": "3052710",
    "end": "3060990"
  },
  {
    "text": "just so you get an idea of how\nbig of a search you need to do. So for a CA code, you want\nto search all of your range",
    "start": "3060990",
    "end": "3071099"
  },
  {
    "text": "basically bins. And so let's say the full\ncode is one millisecond",
    "start": "3071100",
    "end": "3079410"
  },
  {
    "text": "and one chip is\n0.98 microseconds. So again, you almost\nhave or you exactly",
    "start": "3079410",
    "end": "3085980"
  },
  {
    "text": "have 1023 range bins to search\nor tau hat bins to search.",
    "start": "3085980",
    "end": "3092160"
  },
  {
    "text": "And then for Doppler,\na typical number for the size of these\nDoppler cells for the search",
    "start": "3092160",
    "end": "3098069"
  },
  {
    "text": "is 250 Hertz. And then you have a 20 kilohertz\nbasically Doppler bandwidth",
    "start": "3098070",
    "end": "3105030"
  },
  {
    "text": "to search. So that's 80 times\nroughly 1,000. So about 80,000\ncombinations of tau hat",
    "start": "3105030",
    "end": "3113099"
  },
  {
    "text": "and FD that you need\nto search and that's why on older receivers\nit takes a few seconds. Really on modern things, this\ncan be done in super quickly.",
    "start": "3113100",
    "end": "3121950"
  },
  {
    "text": "We're talking probably\ntens of milliseconds to get the first fix. It's not really that bad\nbecause each of these,",
    "start": "3121950",
    "end": "3129210"
  },
  {
    "text": "remember to each search\nat the end of the day, what you want, you want\nto get one number out,",
    "start": "3129210",
    "end": "3134650"
  },
  {
    "text": "which is just an inner product\nwith the shifted replica of the code and\nwhat you received.",
    "start": "3134650",
    "end": "3139860"
  },
  {
    "text": "And you just want the\ncorrelation value at 0 so that's just one inner\nproduct that you do and that gives the\nvalue of this function.",
    "start": "3139860",
    "end": "3145860"
  },
  {
    "text": "Question. [INAUDIBLE] peak correlation\nare the Doppler effects",
    "start": "3145860",
    "end": "3151769"
  },
  {
    "text": "going to change? Yeah. That's why you need to\ndo it relatively fast. Yes.",
    "start": "3151770",
    "end": "3156780"
  },
  {
    "text": "And again, so for\ninstance, if you are on--",
    "start": "3156780",
    "end": "3163080"
  },
  {
    "text": "just to repeat the question,\nas you're doing the search, isn't the Doppler\ngoing to change, right?",
    "start": "3163080",
    "end": "3170580"
  },
  {
    "text": "There's two things. First, you do it\nrelatively fast. So are we talking\nlike seconds at most",
    "start": "3170580",
    "end": "3175710"
  },
  {
    "text": "for really old receivers. Modern ones, probably\nmilliseconds. But also even if it's\nchanging, so let's say",
    "start": "3175710",
    "end": "3182130"
  },
  {
    "text": "you're on some vehicle that\nis accelerating extremely fast so the Doppler is like ever\nchanging something like that,",
    "start": "3182130",
    "end": "3190050"
  },
  {
    "text": "you can still get lucky. You're searching and\nthis thing is moving, you can still intersect it.",
    "start": "3190050",
    "end": "3196690"
  },
  {
    "text": "It might jump over you, right? But if you do a\nfew passes, you're going to catch it even\nif it's shifting around",
    "start": "3196690",
    "end": "3202410"
  },
  {
    "text": "if you do it fast. OK. Other questions? No. All right.",
    "start": "3202410",
    "end": "3208770"
  },
  {
    "text": "OK. So that's the acquisition step. And what you want\nto do, you want",
    "start": "3208770",
    "end": "3216810"
  },
  {
    "text": "to acquire multiple\nsatellites, right? So for that, the receiver has--\nso that basically signal chain",
    "start": "3216810",
    "end": "3223260"
  },
  {
    "text": "that I showed you, imagine\nthat the receiver has multiple of those in parallel, right?",
    "start": "3223260",
    "end": "3228840"
  },
  {
    "text": "So your signal is\ncoming in and when it comes to Doppler\ncompensation and the correlation",
    "start": "3228840",
    "end": "3234480"
  },
  {
    "text": "the receiver can have multiple\nchannels and for each of them",
    "start": "3234480",
    "end": "3239580"
  },
  {
    "text": "is basically acquiring and\ntracking a specific satellite,",
    "start": "3239580",
    "end": "3245310"
  },
  {
    "text": "right? And again, this is where\nthis idea of co division multiple axis really\nhelps because each",
    "start": "3245310",
    "end": "3252000"
  },
  {
    "text": "of these correlators\nif it's correlating with a local replica\nof the specific code,",
    "start": "3252000",
    "end": "3257920"
  },
  {
    "text": "so let's say this one is doing\nwith course acquisition number one, this is CA\nnumber two and so on.",
    "start": "3257920",
    "end": "3265300"
  },
  {
    "text": "And these are known codes. We know exactly what the code\nevery satellite is transmitting is.",
    "start": "3265300",
    "end": "3271660"
  },
  {
    "text": "Then if you feed the\nCA two into this,",
    "start": "3271660",
    "end": "3277720"
  },
  {
    "text": "you're not going to affect\nthe output of the correlated because the cost correlation\nof these codes is very low.",
    "start": "3277720",
    "end": "3283600"
  },
  {
    "text": "And that's how part of\nthe magic of these codes is that this almost orthogonal\nthrough the correlation",
    "start": "3283600",
    "end": "3292500"
  },
  {
    "text": "naturally filters\nout interferences from other channels, right? So again, in this space of\nDoppler and pseudo range or tau",
    "start": "3292500",
    "end": "3303420"
  },
  {
    "text": "hat, I'm using time and\nrange interchangeably as you've noticed.",
    "start": "3303420",
    "end": "3308580"
  },
  {
    "text": "So in my mind, tau\nhat and pseudo range, which is just tau hat\ntimes the speed of light. It's the same thing.",
    "start": "3308580",
    "end": "3314950"
  },
  {
    "text": "It's like time and space\nare kind of interchangeable. But you have this thing which\nis tau hat between 0 and 1",
    "start": "3314950",
    "end": "3321270"
  },
  {
    "text": "millisecond and f hat from\nminus 10 and 10 and then you acquire a bunch of\nsatellites and each of them",
    "start": "3321270",
    "end": "3326490"
  },
  {
    "text": "is basically a point in\nthis 2D search map, right? So you acquire your satellites,\nyou acquire at least 4",
    "start": "3326490",
    "end": "3334200"
  },
  {
    "text": "and then from there on\nthe job of the receiver is a little easier. So you're going to tracking.",
    "start": "3334200",
    "end": "3340140"
  },
  {
    "text": "And as I said, the\ntracking is basically-- on this picture, each of\nthese points over time,",
    "start": "3340140",
    "end": "3346062"
  },
  {
    "text": "it's going to move around\nbecause both the Doppler is going to change and the range or\npseudo range is going to change",
    "start": "3346062",
    "end": "3351300"
  },
  {
    "text": "but it doesn't randomize, right? If you do this fast from now\nto a few milliseconds from now,",
    "start": "3351300",
    "end": "3360900"
  },
  {
    "text": "things don't change that fast. So you only need to limit. When we started\nat the cold start,",
    "start": "3360900",
    "end": "3366750"
  },
  {
    "text": "your search space was\nthis entire square, right? Yep.",
    "start": "3366750",
    "end": "3372150"
  },
  {
    "text": "[INAUDIBLE] resemblance. Say that one more time. [INAUDIBLE] ranging codes\nas there are satellites? Yes.",
    "start": "3372150",
    "end": "3377490"
  },
  {
    "text": "Exactly. Yes. The question was are\nthere as many unique ranging codes as\nsatellites and yes.",
    "start": "3377490",
    "end": "3382770"
  },
  {
    "text": " [INAUDIBLE] channels in\nhardware for every GPS receiver",
    "start": "3382770",
    "end": "3389310"
  },
  {
    "text": "you have. Yeah, you can. But these are the\nnumber of channels.",
    "start": "3389310",
    "end": "3394860"
  },
  {
    "text": "If it's fully implemented\nin hardware, yes. But these days, these are\nlike software defined, right?",
    "start": "3394860",
    "end": "3400740"
  },
  {
    "text": "So the local replica,\nthere is like-- this is all in digital, right? So assume like a\nmicrocontroller and FPGA",
    "start": "3400740",
    "end": "3409140"
  },
  {
    "text": "and then it can\nbasically in runtime, change what code it's\ncorrelating against.",
    "start": "3409140",
    "end": "3417000"
  },
  {
    "text": "Old ones, it was all\nin hardware actually and yes, they had\nalmost like at the time",
    "start": "3417000",
    "end": "3422407"
  },
  {
    "text": "whatever the number\nof satellites was. But these days, it's software\ndefined so they have-- I don't, eight or 10\nchannels at a time",
    "start": "3422407",
    "end": "3428940"
  },
  {
    "text": "and then they kind of\nflip through the codes and find which ones give\na response basically.",
    "start": "3428940",
    "end": "3435960"
  },
  {
    "text": "OK. So then the idea of tracking--\nlike when you're cold start",
    "start": "3435960",
    "end": "3441090"
  },
  {
    "text": "for acquisition phase, you need\nto search the big search space which is like 80,000\ncombinations but when you go",
    "start": "3441090",
    "end": "3447210"
  },
  {
    "text": "to tracking, . you basically\njust around this you limit your search by a few bins and\nsee how these things move over",
    "start": "3447210",
    "end": "3455070"
  },
  {
    "text": "time. And that's basically\nthe idea of tracking. So you have a tracking region\naround the point corresponding",
    "start": "3455070",
    "end": "3463859"
  },
  {
    "text": "to every satellite and then you\nkind of track where it's not. The algorithms were tracking\ncan be super, super simple.",
    "start": "3463860",
    "end": "3472270"
  },
  {
    "text": "So for instance, to track\ntau hat, the simplest one you can do if we go back\nto this picture, which",
    "start": "3472270",
    "end": "3479940"
  },
  {
    "text": "was I believe here, yeah. If you go to this picture to\ntrack tau hat for instance how",
    "start": "3479940",
    "end": "3488400"
  },
  {
    "text": "it's changing over\ntime, what you can do is that at the output of\nyour correlator instead of just looking at\nthis peak, if you also",
    "start": "3488400",
    "end": "3496170"
  },
  {
    "text": "look at the sample like the one\nbefore and the one after it, right? And based on how those\ntwo are changing,",
    "start": "3496170",
    "end": "3503609"
  },
  {
    "text": "if the one to your\nright is increasing and the one to your\nleft is decreasing, that means your tau hat\nis increasing, right?",
    "start": "3503610",
    "end": "3511080"
  },
  {
    "text": "If the other way around,\nyour tau hat is decreasing. So as easy as that,\njust by monitoring like three samples\nout of the correlated,",
    "start": "3511080",
    "end": "3517770"
  },
  {
    "text": "it can almost perfectly\ntrack tau hat. Same for f. And then you feed\nthese back basically",
    "start": "3517770",
    "end": "3524730"
  },
  {
    "text": "so you can generate\nthis feedback signal. The one for Doppler goes to\nthe numerically controlled oscillator.",
    "start": "3524730",
    "end": "3530440"
  },
  {
    "text": "So the output of that kind\nof tracks the Doppler shift and then the one for tau hat\ngoes to your local cold replica",
    "start": "3530440",
    "end": "3538530"
  },
  {
    "text": "generator. So that guy also\ntracks changes in tone. And then almost continuously\nin time, you can track--",
    "start": "3538530",
    "end": "3550079"
  },
  {
    "text": "sorry, I am a few slides back. You can track basically\nall your satellites. Any questions?",
    "start": "3550080",
    "end": "3558090"
  },
  {
    "text": "OK. So the last thing, which is\nextremely important that we",
    "start": "3558090",
    "end": "3563380"
  },
  {
    "text": "need to talk about is that, OK? So we have a very good\nunderstanding from the physics",
    "start": "3563380",
    "end": "3569410"
  },
  {
    "text": "all the way up to\nthe system level of how the GPS acquires\nthe satellites, find their positions, finds\nthese time of flights",
    "start": "3569410",
    "end": "3577810"
  },
  {
    "text": "plus the timing offset or the\npseudo range to each satellite but we haven't talked about\nhow do we localize ourselves",
    "start": "3577810",
    "end": "3585460"
  },
  {
    "text": "with all this information. So that's the last piece\nthat we'll talk about.",
    "start": "3585460",
    "end": "3591829"
  },
  {
    "text": "And the idea is\npretty simple actually once you break it down. So the receiver so\nfar, what it does",
    "start": "3591830",
    "end": "3599890"
  },
  {
    "text": "is it requires a\nbunch of satellites and starts tracking\nthem and over time, it",
    "start": "3599890",
    "end": "3606940"
  },
  {
    "text": "needs to estimate\nits own position, pr using the measured pseudo\nranges to these satellites.",
    "start": "3606940",
    "end": "3615620"
  },
  {
    "text": "And remember that\neach pseudo range rho i is the speed of\nlight times the tau hat.",
    "start": "3615620",
    "end": "3620800"
  },
  {
    "text": "So tau hat is that output\nthat you're tracking, which is equal to tau plus\nyour time delay or your clock",
    "start": "3620800",
    "end": "3628780"
  },
  {
    "text": "delay, which is tau d. So the pseudo range is equal\nto the physical range ri,",
    "start": "3628780",
    "end": "3635950"
  },
  {
    "text": "to each satellite\nplus this error term, which is the speed of\nlight times your timing delay.",
    "start": "3635950",
    "end": "3641350"
  },
  {
    "text": "And you have these rhos\nfor as many satellites as you are tracking. Let's say big end and\nit's at least four, right?",
    "start": "3641350",
    "end": "3648670"
  },
  {
    "text": "So these are the\nmeasurements that you have. And just to be more\nconcrete, what is ri?",
    "start": "3648670",
    "end": "3654400"
  },
  {
    "text": "The ri is the distance from\nthe receiver at 0 point pr to the satellite at point PSI.",
    "start": "3654400",
    "end": "3663670"
  },
  {
    "text": "So it's the norm of\npr minus psi, which is the position of the\nreceiver and the satellite",
    "start": "3663670",
    "end": "3669250"
  },
  {
    "text": "which is equal to the square\nroot of xr minus xsi squared",
    "start": "3669250",
    "end": "3674290"
  },
  {
    "text": "plus y minus ys squared\nplus z minus cs squared. So this is just\npure geometry here.",
    "start": "3674290",
    "end": "3679690"
  },
  {
    "text": "OK. Now you have at least\none of these measurements and what you're trying\nto estimate remember",
    "start": "3679690",
    "end": "3685330"
  },
  {
    "text": "is 4 parameters. You need-- well, your pr which\nis an x and y and z itself.",
    "start": "3685330",
    "end": "3690680"
  },
  {
    "text": "So you have xr, yr\nand zr, three numbers plus tau d that you\nneed to estimate.",
    "start": "3690680",
    "end": "3696820"
  },
  {
    "text": "You can formulate this as a\nnonlinear system of equations and then solve it using your\nfavorite nonlinear solver.",
    "start": "3696820",
    "end": "3703930"
  },
  {
    "text": "The easiest one is the Gaussian\nmethod that we will talk about but let's set up\nthe problem first.",
    "start": "3703930",
    "end": "3710029"
  },
  {
    "text": "So basically, you have this\nfunction, call it f off--",
    "start": "3710030",
    "end": "3716050"
  },
  {
    "text": "it's a function of the\nreceiver's position and it's time delay or the\nclock offset tau d, right?",
    "start": "3716050",
    "end": "3722860"
  },
  {
    "text": "And this function it's-- here, I'm highly,\nhighly overloading",
    "start": "3722860",
    "end": "3728650"
  },
  {
    "text": "my notation so be very\nconscious about what's a vector and what's a scalar.",
    "start": "3728650",
    "end": "3734410"
  },
  {
    "text": "From context, there's\nno ambiguity but mind that I'm using a highly, highly\noverloaded notation here.",
    "start": "3734410",
    "end": "3741290"
  },
  {
    "text": "So for instance, pr-- I'm just going to do it\nonce and then the rest I'll",
    "start": "3741290",
    "end": "3746990"
  },
  {
    "text": "let you from context. Pr is a vector in r3, right? That's our position vector.",
    "start": "3746990",
    "end": "3752260"
  },
  {
    "text": "Tau is a number. That's just a number. So what I mean by this--",
    "start": "3752260",
    "end": "3757770"
  },
  {
    "text": "so f is a function\nof pr and tau d so if you stack them together,\nit takes a vector in r4",
    "start": "3757770",
    "end": "3765480"
  },
  {
    "text": "as an input. And then the F itself--",
    "start": "3765480",
    "end": "3771180"
  },
  {
    "text": "f of pn tau, it is\na vector in our rn",
    "start": "3771180",
    "end": "3777710"
  },
  {
    "text": "and n is the number\nof satellites you're tracking, right? So each entry of f,\nf sub i is basically",
    "start": "3777710",
    "end": "3787069"
  },
  {
    "text": "your pseudo range to the\ncorresponding satellite minus ri minus c\nsub tau d, right?",
    "start": "3787070",
    "end": "3793730"
  },
  {
    "text": "So if you have solved your\nGPS equations correctly,",
    "start": "3793730",
    "end": "3799520"
  },
  {
    "text": "these f sub Is should\nbe almost zero, right? Because we started with\nthe fact that rho i should",
    "start": "3799520",
    "end": "3807510"
  },
  {
    "text": "be actually equal to\nri plus c tau d, right? So with the correct\nsolution, this rho",
    "start": "3807510",
    "end": "3814859"
  },
  {
    "text": "i minus ri minus c tau\nd should be almost zero. There's noise not ideally\nthat's why it's not exactly zero",
    "start": "3814860",
    "end": "3821970"
  },
  {
    "text": "and that justifies this\noptimization problem. So if we are minimizing the\nsum squared of all these terms",
    "start": "3821970",
    "end": "3827940"
  },
  {
    "text": "which in the ideal case\nshould be all zero, OK? Does the problem\nset up make sense?",
    "start": "3827940",
    "end": "3833940"
  },
  {
    "text": "OK. So do we agree that if we\nminimize this function over p and tau, we have not\nonly localized ourselves,",
    "start": "3833940",
    "end": "3842170"
  },
  {
    "text": "we have also found our timing\noffset with respect to the GPS system. OK.",
    "start": "3842170",
    "end": "3847510"
  },
  {
    "text": "Let's solve it. So it's a nonlinear\nfunction, of course, right? There's square roots\nand other stuff.",
    "start": "3847510",
    "end": "3854380"
  },
  {
    "text": "But again, there's many, many,\nmany, many different algorithms",
    "start": "3854380",
    "end": "3859690"
  },
  {
    "text": "for solving nonlinear systems. We'll use the Gauss-Newton and\nthe way the Gauss-Newton works,",
    "start": "3859690",
    "end": "3865270"
  },
  {
    "text": "just as a reminder, is if\nour function was linear-- so if you had another optimization\nproblem, which was minimized",
    "start": "3865270",
    "end": "3874350"
  },
  {
    "text": "some like ax minus\nb normal squared, we all know this is a\nlinear least squares",
    "start": "3874350",
    "end": "3880050"
  },
  {
    "text": "and we all know how\nto solve this, right? Your x hat is equal to\na transpose a inverse,",
    "start": "3880050",
    "end": "3887430"
  },
  {
    "text": "a transpose b, the famous\nequation you probably have seen like in 108\nor some other course.",
    "start": "3887430",
    "end": "3893260"
  },
  {
    "text": "So linear stuff, we know\nthere's closed form solutions. And then nonlinear,\nthe idea of Gaussian is start from some guess for\nyour solution at each step.",
    "start": "3893260",
    "end": "3902010"
  },
  {
    "text": "Linearize this function\nso approximated by some ax minus b. Find your linearized solution,\nuse that as your new iterate",
    "start": "3902010",
    "end": "3911070"
  },
  {
    "text": "and then continue. So you linearize,\nsolve, linearize solve until you converge.",
    "start": "3911070",
    "end": "3917580"
  },
  {
    "text": "And by convergence, we mean\nthat your solution is not changing much and that that's\nthe point of convergence, OK?",
    "start": "3917580",
    "end": "3923890"
  },
  {
    "text": "So let's say that\nagain, the objective is",
    "start": "3923890",
    "end": "3929190"
  },
  {
    "text": "minimize this function here. And this is the Gauss Newton.",
    "start": "3929190",
    "end": "3934280"
  },
  {
    "text": "You start from some initial\nguess of your position and timing offset. Really doesn't matter much\nespecially at a cold start,",
    "start": "3934280",
    "end": "3942770"
  },
  {
    "text": "you might not have a good guess. Modern receivers\ndo because there's other ways of guessing\nwhere you are for instance.",
    "start": "3942770",
    "end": "3950510"
  },
  {
    "text": "From Wi-Fi signals\nthese days, you can reasonably well\nlocalize yourself just from the IP address.",
    "start": "3950510",
    "end": "3955970"
  },
  {
    "text": "You can query on the internet\nwhere am I or whatnot and that already gives you a\ndecent estimate of your rho.",
    "start": "3955970",
    "end": "3962330"
  },
  {
    "text": "If not, just start\nrandom, right? Just pick a point on the surface\nof the Earth and then usually,",
    "start": "3962330",
    "end": "3969530"
  },
  {
    "text": "these problems are\nwell behaved then you converge to\nthe right solution. But again, so at each\nstep, you linearize",
    "start": "3969530",
    "end": "3975860"
  },
  {
    "text": "as your f near the current\nguess and then your new guess is the least squared solution\nusing the linearized version",
    "start": "3975860",
    "end": "3983240"
  },
  {
    "text": "of f and then you update and\ncontinue until convergence",
    "start": "3983240",
    "end": "3988520"
  },
  {
    "text": "and by convergence, we\nmean the value of your f that you're trying to minimize\nat the current iterate",
    "start": "3988520",
    "end": "3993740"
  },
  {
    "text": "minus its value at\nthe previous iterate. If it's less than some\nthreshold, then you can decide.",
    "start": "3993740",
    "end": "4000849"
  },
  {
    "text": "Then you call it good\nand you stop, OK? All right. ",
    "start": "4000850",
    "end": "4007839"
  },
  {
    "text": "Let's go one step deeper\nand actually derive what the linearization\nlooks like for this.",
    "start": "4007840",
    "end": "4014560"
  },
  {
    "text": "These days, you can\njust go to Python and just enter this\ninto, I don't know, your favorite again,\nlike scikit learn",
    "start": "4014560",
    "end": "4021070"
  },
  {
    "text": "or whatever package you use\nand it will take care of it. But I think it's\nimportant to not be",
    "start": "4021070",
    "end": "4027100"
  },
  {
    "text": "scared of doing these\nkinds of derivations. That's why I like to\nreally, from scratch,",
    "start": "4027100",
    "end": "4033700"
  },
  {
    "text": "derive what all the\nsteps are for instance for the Gauss-Newton. OK.",
    "start": "4033700",
    "end": "4039250"
  },
  {
    "text": "So again, the idea is at a\nstep, we linearize our function.",
    "start": "4039250",
    "end": "4044650"
  },
  {
    "text": "And the linear position is-- the value is equal to the value\nof f at the current point plus",
    "start": "4044650",
    "end": "4051309"
  },
  {
    "text": "again, don't be scared\nby the notation. This is just the first\norder tailor expansion.",
    "start": "4051310",
    "end": "4056320"
  },
  {
    "text": "This df which is the derivative\nor for the vector case, the Jacobian matrix of f at the\ncurrent iterate times the point",
    "start": "4056320",
    "end": "4064780"
  },
  {
    "text": "minus its current estimate. Again, the notation\ngets a little scary",
    "start": "4064780",
    "end": "4069910"
  },
  {
    "text": "but this is nothing other\nthan in the scalar case if you had some\nfunction f of x, you",
    "start": "4069910",
    "end": "4075609"
  },
  {
    "text": "can say my f of x is almost\nequal to around the point x0. I'm linearizing so fx0 plus\nf prime x0 times x minus x0.",
    "start": "4075610",
    "end": "4086710"
  },
  {
    "text": "This is exactly that except\nthe notation is a little uglier because our x is now this guy.",
    "start": "4086710",
    "end": "4092349"
  },
  {
    "text": "So that's x, right? Or x0 and that's x0.",
    "start": "4092350",
    "end": "4097740"
  },
  {
    "text": "And df is like the f\nprime for the vector case and this is x and that's my\ncurrent iterate x 0, right?",
    "start": "4097740",
    "end": "4106649"
  },
  {
    "text": "Nothing really beyond\nthat, as simple as that. But let's actually\nfind what the Jacobian",
    "start": "4106649",
    "end": "4112710"
  },
  {
    "text": "or the derivative of our f is. We explicitly know the\nfunction from here, right?",
    "start": "4112710",
    "end": "4118979"
  },
  {
    "text": "These are the FIs. So we can take the derivative\nof this guy with respect to xyz and tell and\nexplicitly find the Jacobian.",
    "start": "4118979",
    "end": "4126839"
  },
  {
    "text": "And if you do that, it's\nactually not too bad. You take the derivative. So for instance,\nthe first rho of t",
    "start": "4126840",
    "end": "4134130"
  },
  {
    "text": "is the partial derivative\nfi or the first column is the partial\nderivative fi partial x",
    "start": "4134130",
    "end": "4140250"
  },
  {
    "text": "and that becomes equal\nto this guy here, which is the current iterate of\nx minus the x of the satellite.",
    "start": "4140250",
    "end": "4147100"
  },
  {
    "text": "This is very\nimportant, minus xsi. So this is the receiver,\nthis is for satellite. So xr minus xs over\nbasically PR minus ps",
    "start": "4147100",
    "end": "4155219"
  },
  {
    "text": "which is the total distance from\nthe receiver to the satellite. Y and z look very similar\nbasically because the function",
    "start": "4155220",
    "end": "4164219"
  },
  {
    "text": "was exactly identical for xyz. The one that is different\nand simpler is tau. Once you take the derivative\nwith respect to tau,",
    "start": "4164220",
    "end": "4171568"
  },
  {
    "text": "you just get minus c, right? And again, if you go back here\nto where our function was,",
    "start": "4171569",
    "end": "4177120"
  },
  {
    "text": "this is clear. If you take the derivative of\nthis guy with respect to tau, this goes away. There's no tau dependency\nhere, it's just minus c, right?",
    "start": "4177120",
    "end": "4185370"
  },
  {
    "text": "OK. So now you have this and that's\nbasically your linearization",
    "start": "4185370",
    "end": "4192750"
  },
  {
    "text": "step. So now you can approximate\nyour f as ax minus b. That's a linear approximation.",
    "start": "4192750",
    "end": "4198719"
  },
  {
    "text": "And as I said, explicitly,\nthat's what the a is. That's is the Jacobian\nevaluated at the case iterate",
    "start": "4198720",
    "end": "4208350"
  },
  {
    "text": "and the b is this term. And this we know how\nto solve basically.",
    "start": "4208350",
    "end": "4214920"
  },
  {
    "text": "Your next iterate is just\na transpose a inverse, a transpose b with the\nand b that are coming",
    "start": "4214920",
    "end": "4221190"
  },
  {
    "text": "from the linerization step. So that gives you a\nnext iterate and then you keep continuing\nuntil convergence.",
    "start": "4221190",
    "end": "4228870"
  },
  {
    "text": "And again, at the end of\nthis process of Gauss-Newton, you have localize\nyourself so you",
    "start": "4228870",
    "end": "4235740"
  },
  {
    "text": "have found your\nposition vector and you have found your time delay.",
    "start": "4235740",
    "end": "4243389"
  },
  {
    "text": "OK. So how long does it take? After a cold start, usually\nyou don't need that many steps",
    "start": "4243390",
    "end": "4248720"
  },
  {
    "text": "actually for the Gaussian. Usually five or so steps is\nenough to get to convergence and that's at a cold\nstart so you almost",
    "start": "4248720",
    "end": "4255710"
  },
  {
    "text": "have no idea where you are. After that, you can\nalways initialize your gas with your previous\nestimate of tau and p",
    "start": "4255710",
    "end": "4263270"
  },
  {
    "text": "and then almost in one\nstep always, just converge, which is extremely\nfast and that's",
    "start": "4263270",
    "end": "4268400"
  },
  {
    "text": "why the GPS works so fast and\nreliably even without much",
    "start": "4268400",
    "end": "4273620"
  },
  {
    "text": "compute resources. OK. One more thing that GPS\ncan do and actually does",
    "start": "4273620",
    "end": "4280849"
  },
  {
    "text": "which we haven't\ntalked about yet, you could also estimate\nyour velocity in addition to position, which is\nextremely, extremely useful.",
    "start": "4280850",
    "end": "4288530"
  },
  {
    "text": "And why can we do that? Because remember, we also\nhave the Doppler information. We are tracking the Doppler\nshift at the receiver.",
    "start": "4288530",
    "end": "4296130"
  },
  {
    "text": "So what is the Doppler shift? Remember, the Doppler shift\nwith respect to the satellite is basically given by\nthis expression, which",
    "start": "4296130",
    "end": "4304160"
  },
  {
    "text": "is the inner product of\nthe relative velocity of the receiver to the\nsatellite to the inner product",
    "start": "4304160",
    "end": "4311690"
  },
  {
    "text": "with the unit vector that\npoints from the receiver to the satellite divided by the\nspeed of light times FC, right?",
    "start": "4311690",
    "end": "4318860"
  },
  {
    "text": "So it's the projection\nof the relative velocity into the radial direction\nfrom the receiver",
    "start": "4318860",
    "end": "4324260"
  },
  {
    "text": "to the satellite the scaled\nby the speed of light or divided by the speed of light\ntimes the carrier frequency.",
    "start": "4324260",
    "end": "4330620"
  },
  {
    "text": "So specifically, it's equal\nto your receiver velocity minus the satellite velocity\ninner producted with--",
    "start": "4330620",
    "end": "4338120"
  },
  {
    "text": "this is r hat,\nwhich is p receiver minus p satellite divided by\nthe norm of p receiver minus p",
    "start": "4338120",
    "end": "4344579"
  },
  {
    "text": "satellite. So that's the unit vector\npointing from the receiver to the satellite\nover C times FC. Now, if you look at\nthis expression here,",
    "start": "4344580",
    "end": "4352490"
  },
  {
    "text": "everything except VR is\nknown to the receiver, right? You have already solved\nyour GPS equation",
    "start": "4352490",
    "end": "4359070"
  },
  {
    "text": "so you know your own\nposition, PR is known. PSI is a satellite\nposition, which is known from the femoris, right?",
    "start": "4359070",
    "end": "4365740"
  },
  {
    "text": "Denominator, same thing. Speed of light is\nknown, pr, ps are known. Fc, that's the carrier\nfrequency is known, right?",
    "start": "4365740",
    "end": "4372500"
  },
  {
    "text": "The Doppler shift is known. You're estimating and tracking\nit so the FTI is also known",
    "start": "4372500",
    "end": "4378470"
  },
  {
    "text": "and the satellite\nvelocity is also known. Again, because you're\nvery accurately tracking the position\nof the satellite,",
    "start": "4378470",
    "end": "4384929"
  },
  {
    "text": "you can just\nestimate its velocity from the consecutive\nposition measurements. So the only thing that is\nnot known to the receiver",
    "start": "4384930",
    "end": "4392120"
  },
  {
    "text": "is this VR, right? So again, you have a\nsystem of equations",
    "start": "4392120",
    "end": "4398210"
  },
  {
    "text": "that you can solve and\nfind your velocity. It's even easier than position\nbecause this one is linear,",
    "start": "4398210",
    "end": "4405530"
  },
  {
    "text": "right? For position, we had a\nnonlinear system of equations. Here you have a perfect. It's just inner products\nand scale factors basically.",
    "start": "4405530",
    "end": "4414560"
  },
  {
    "text": "So you can form a linear\nsystem of equations, solve it and then you also estimate\nyour velocity, which is again,",
    "start": "4414560",
    "end": "4421610"
  },
  {
    "text": "extremely, extremely useful. So that's why if\nyou remember, we said there's some\nlimited odometry that you",
    "start": "4421610",
    "end": "4427219"
  },
  {
    "text": "get from GPS which is good. Why is it limited?",
    "start": "4427220",
    "end": "4432860"
  },
  {
    "text": "Because remember, the estimate\nof Doppler is kind of course.",
    "start": "4432860",
    "end": "4438230"
  },
  {
    "text": "It's 250 Hertz bins. So that's what makes it a\nlittle limited because FD",
    "start": "4438230",
    "end": "4445460"
  },
  {
    "text": "is coarsely estimated. It's not a very, very,\nvery accurate estimate but other than that,\nthis works perfectly",
    "start": "4445460",
    "end": "4451820"
  },
  {
    "text": "and pretty much\nevery GPS does that. Any questions about localization\nand basically the velocity",
    "start": "4451820",
    "end": "4463080"
  },
  {
    "text": "estimation or odometery here? OK.",
    "start": "4463080",
    "end": "4468179"
  },
  {
    "text": "Almost done with the GPS. There's just a final closing\nremarks I want to make.",
    "start": "4468180",
    "end": "4473650"
  },
  {
    "text": "So one is about the air\nresources of the GPS. GPS is very error prone as\nall of us know from experience",
    "start": "4473650",
    "end": "4480929"
  },
  {
    "text": "and the main\nsources of error one is the satellite position\nbroadcasts there.",
    "start": "4480930",
    "end": "4486330"
  },
  {
    "text": "So the first messages that come,\nthey're not perfect, right?",
    "start": "4486330",
    "end": "4492450"
  },
  {
    "text": "So there could be up\nto 1 meter inaccuracy in the broadcast\nposition of the satellite",
    "start": "4492450",
    "end": "4498090"
  },
  {
    "text": "versus the axial position. So that's one. The other one is\natmospheric delay. So there's different layers\nin the atmosphere and the two",
    "start": "4498090",
    "end": "4506520"
  },
  {
    "text": "that are troublesome for the\nGPS are the upper layer, which is the ionosphere and then\none of the lower layers, which",
    "start": "4506520",
    "end": "4513030"
  },
  {
    "text": "is the troposphere. And the speed of light changes\nin these layers and it's",
    "start": "4513030",
    "end": "4519300"
  },
  {
    "text": "dependent on the\nangle of incidence. So that's a source\nof error and it",
    "start": "4519300",
    "end": "4525600"
  },
  {
    "text": "can add up to five meters of\nlocalization error to the GPS. The biggest one is\nmulti-path interference.",
    "start": "4525600",
    "end": "4532199"
  },
  {
    "text": "And what multi-path\nis that the signal-- what you want\nreally is the signal that is direct line of\nsight from the transmitter",
    "start": "4532200",
    "end": "4539970"
  },
  {
    "text": "to the receiver, right? And that's-- then the time\nof flight is proportional to the range.",
    "start": "4539970",
    "end": "4545940"
  },
  {
    "text": "But what can happen is that you\ncan bounce off other surfaces so the GPS signal might hit\nsome other building near you",
    "start": "4545940",
    "end": "4553560"
  },
  {
    "text": "or some other surface and\nsome of these surfaces at the gigahertz frequencies,\nthey kind of act like mirrors.",
    "start": "4553560",
    "end": "4560880"
  },
  {
    "text": "So the signal\nbounces off of that and then reaches you and\nthen the actual pseudo range",
    "start": "4560880",
    "end": "4566850"
  },
  {
    "text": "that you find is actually\nthen the sum of the two pieces of the multi-bounce or it\ncan be more than two actually.",
    "start": "4566850",
    "end": "4574030"
  },
  {
    "text": "You can have multi-bounce that\nis reflected three or four times and that completely\nmesses up your localization",
    "start": "4574030",
    "end": "4582270"
  },
  {
    "text": "because the underlying\nassumption in the GPS localization is-- the time of flight is in\na direct line of sight.",
    "start": "4582270",
    "end": "4590730"
  },
  {
    "text": "That can introduce\nup to 100 meters. If you have used your GPS\nin downtown San Francisco,",
    "start": "4590730",
    "end": "4596580"
  },
  {
    "text": "it's almost useless. You always like get lost\nbecause and that's multi-path because you get hundreds\nof meters of inaccuracy.",
    "start": "4596580",
    "end": "4604500"
  },
  {
    "text": "And the final one is\nthe interferences. There's always like\nelectromagnetic interferences and natural noise\nin the environment",
    "start": "4604500",
    "end": "4611130"
  },
  {
    "text": "that couples into the signals. Not a big deal but it can cause\nup to a meter of inaccuracy.",
    "start": "4611130",
    "end": "4616920"
  },
  {
    "text": "So all in all, you can have\nup to 100 meters of inaccuracy in the worst case,\nmaybe a little more.",
    "start": "4616920",
    "end": "4622020"
  },
  {
    "text": "But on average, GPS\nis reasonably accurate and you get like up\nto a meter or so.",
    "start": "4622020",
    "end": "4630220"
  },
  {
    "text": "The other one is\nabout time on GPS. So as we saw, a byproduct\nof solving the GPS equations",
    "start": "4630220",
    "end": "4636930"
  },
  {
    "text": "is you estimate your timing\noffset tau d and then",
    "start": "4636930",
    "end": "4642150"
  },
  {
    "text": "with that, you can compensate\nthat and subtract it from your clock\nbasically and then",
    "start": "4642150",
    "end": "4647880"
  },
  {
    "text": "every clock and\nevery receiver is synchronized to the GPS clock. And this is a very\naccurate synchronization",
    "start": "4647880",
    "end": "4654989"
  },
  {
    "text": "because even with the\nslowest code which is the CA, it's one millisecond,\n1,000 bins.",
    "start": "4654990",
    "end": "4661650"
  },
  {
    "text": "So one bin is a microsecond. So your timing\noffset is compensated",
    "start": "4661650",
    "end": "4666810"
  },
  {
    "text": "to microsecond accuracy, right? And then the amazing\nbasically byproduct of the GPS",
    "start": "4666810",
    "end": "4672719"
  },
  {
    "text": "is that now you can\nglobally synchronize clocks across the Earth up to\nmicrosecond accuracy",
    "start": "4672720",
    "end": "4679410"
  },
  {
    "text": "and that's why our timings\nthese days are so accurate. Like back in even in\nlike '50s and '40s,",
    "start": "4679410",
    "end": "4688350"
  },
  {
    "text": "time was not as\naccurate especially globally, the clocks\nwere not synchronized",
    "start": "4688350",
    "end": "4695310"
  },
  {
    "text": "is this accurately. That's that. And then the final\nremark is that GPS",
    "start": "4695310",
    "end": "4700830"
  },
  {
    "text": "is only one\nimplementation of what we call a global navigation\nsatellite system or GNSS.",
    "start": "4700830",
    "end": "4707219"
  },
  {
    "text": "There's many different versions. China has its own,\nit's called Beidou. European Union has Galileo,\nRussia has GLONASS,",
    "start": "4707220",
    "end": "4715260"
  },
  {
    "text": "Japan has its own,\nIndia has its own. So there's other systems\nthat do basically navigation",
    "start": "4715260",
    "end": "4723420"
  },
  {
    "text": "and localization using\nsatellite systems. The underlying principle\nof operation, the math,",
    "start": "4723420",
    "end": "4729930"
  },
  {
    "text": "the physics, system\narchitecture, all is pretty much exact same.",
    "start": "4729930",
    "end": "4735840"
  },
  {
    "text": "And that's why\nreceivers today are called GNSS receivers,\nthe more advanced ones",
    "start": "4735840",
    "end": "4742800"
  },
  {
    "text": "and they actually acquire\nsignals from different systems and use all of them\ntogether to do even more",
    "start": "4742800",
    "end": "4749099"
  },
  {
    "text": "accurate localization. And that's pretty much it. I think with this, we are\ndone with the GPS chapter",
    "start": "4749100",
    "end": "4757260"
  },
  {
    "text": "and next time, we'll start\ntalking about inertial sensors. Questions?",
    "start": "4757260",
    "end": "4762300"
  },
  {
    "text": "Yes. For the atmospheric\ndelays, why can't the GPS",
    "start": "4762300",
    "end": "4768739"
  },
  {
    "text": "communicate the whole\natmospheric model? Great question. So the question is for\nthe atmospheric delays,",
    "start": "4768740",
    "end": "4775940"
  },
  {
    "text": "why can't the receiver use\nsome model to compensate? And the more\nsophisticated ones do.",
    "start": "4775940",
    "end": "4781430"
  },
  {
    "text": "The way the models\nwork is that the delays are frequency dependent. So if you acquire signals\nfrom two separate channels,",
    "start": "4781430",
    "end": "4788210"
  },
  {
    "text": "say l1 and l2 or l1 and l5,\nyou can use that extra piece of information.",
    "start": "4788210",
    "end": "4793489"
  },
  {
    "text": "You know your underlying\nrange is constant but you get different\npseudo ranges",
    "start": "4793490",
    "end": "4799430"
  },
  {
    "text": "because of different amounts\nof atmospheric delays and then you mix\nthat with some models",
    "start": "4799430",
    "end": "4805010"
  },
  {
    "text": "that the receivers\nhave based on angle of incidence and thickness\nof the layers and whatnot. And to some extent,\nthey can compensate.",
    "start": "4805010",
    "end": "4812120"
  },
  {
    "text": "There's more advanced techniques\nlike differential GPS which also uses ground\nstations which don't have",
    "start": "4812120",
    "end": "4818119"
  },
  {
    "text": "the atmospheric\ndelay factor then and they can even more\naccurately compensate for it.",
    "start": "4818120",
    "end": "4823370"
  },
  {
    "text": "So you're absolutely right. There's things you can\ndo to-- even multi-path, there's techniques you can do to\nsome extent compensate for it.",
    "start": "4823370",
    "end": "4832310"
  },
  {
    "text": "OK? All right. That's it. Thank you guys. ",
    "start": "4832310",
    "end": "4841000"
  }
]