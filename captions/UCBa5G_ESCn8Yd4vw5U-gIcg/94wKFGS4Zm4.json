[
  {
    "start": "0",
    "end": "240"
  },
  {
    "text": "OK.",
    "start": "240",
    "end": "740"
  },
  {
    "text": "Welcome back.",
    "start": "740",
    "end": "1282"
  },
  {
    "text": "Today, we're going to\ntalk about-- we're going",
    "start": "1282",
    "end": "3198"
  },
  {
    "text": "to do the lab for chapter 9.",
    "start": "3198",
    "end": "4580"
  },
  {
    "text": "That is the chapter on\nsupport vector machines.",
    "start": "4580",
    "end": "8870"
  },
  {
    "text": "And as usual, we\nhave some imports,",
    "start": "8870",
    "end": "12710"
  },
  {
    "text": "and we have some new imports.",
    "start": "12710",
    "end": "14630"
  },
  {
    "text": "So today, we're talking about\nsupport vector machines,",
    "start": "14630",
    "end": "18500"
  },
  {
    "text": "in particular, support\nvector classifiers.",
    "start": "18500",
    "end": "21000"
  },
  {
    "text": "So that's what this\nSVC stands for.",
    "start": "21000",
    "end": "23390"
  },
  {
    "text": "There are other estimators,\nsupport vector regression,",
    "start": "23390",
    "end": "26270"
  },
  {
    "text": "and other things that we're\nnot going to talk about.",
    "start": "26270",
    "end": "28440"
  },
  {
    "text": "So that's the main\nestimator that we'll",
    "start": "28440",
    "end": "31040"
  },
  {
    "text": "use from scikit-learn today.",
    "start": "31040",
    "end": "34400"
  },
  {
    "text": "The other thing\nwe're going to do",
    "start": "34400",
    "end": "36170"
  },
  {
    "text": "is compare classifiers\nusing an ROC curve.",
    "start": "36170",
    "end": "40109"
  },
  {
    "text": "And so there's a nice way to\nplot an ROC curve for a given",
    "start": "40110",
    "end": "44120"
  },
  {
    "text": "estimator that we'll\nuse from scikit-learn.",
    "start": "44120",
    "end": "46410"
  },
  {
    "text": "And finally, we wrote a\nlittle helper function",
    "start": "46410",
    "end": "48530"
  },
  {
    "text": "to sort of display some of\nthe boundaries of support",
    "start": "48530",
    "end": "51890"
  },
  {
    "text": "vector the support vector\nclassifiers that we'll use,",
    "start": "51890",
    "end": "54800"
  },
  {
    "text": "that will help us visualize\nhow these things work.",
    "start": "54800",
    "end": "58340"
  },
  {
    "start": "58340",
    "end": "62047"
  },
  {
    "text": "OK.",
    "start": "62047",
    "end": "62547"
  },
  {
    "text": "So we're going to use our\nsupport vector classifier,",
    "start": "62547",
    "end": "66770"
  },
  {
    "text": "and let's just make a\ntoy, little data set here.",
    "start": "66770",
    "end": "71329"
  },
  {
    "text": "So I'm not going to dwell on\nthe code we used to make it.",
    "start": "71330",
    "end": "76520"
  },
  {
    "text": "For us, we're going to\nlook at the points today.",
    "start": "76520",
    "end": "80399"
  },
  {
    "text": "So we're going to start\noff with a case, where",
    "start": "80400",
    "end": "82640"
  },
  {
    "text": "the two classes are not\nvery well separated,",
    "start": "82640",
    "end": "85280"
  },
  {
    "text": "or they're not actually\nseparable in this case,",
    "start": "85280",
    "end": "88070"
  },
  {
    "text": "and fit a classifier to that to\nsee what kind of support points",
    "start": "88070",
    "end": "91850"
  },
  {
    "text": "we get and how the support\nchanges a little bit",
    "start": "91850",
    "end": "95720"
  },
  {
    "text": "as we change the cost parameter.",
    "start": "95720",
    "end": "97730"
  },
  {
    "text": "That's the main parameter in\nsupport vector classifier.",
    "start": "97730",
    "end": "102705"
  },
  {
    "text": "OK.",
    "start": "102705",
    "end": "103205"
  },
  {
    "text": "So here's how we fit a\nsupport vector classifier.",
    "start": "103205",
    "end": "106850"
  },
  {
    "text": "We have to give it\na cost parameter.",
    "start": "106850",
    "end": "108810"
  },
  {
    "text": "And if you remember\nin the class,",
    "start": "108810",
    "end": "110509"
  },
  {
    "text": "we discussed how that\ncost parameter plays.",
    "start": "110510",
    "end": "113780"
  },
  {
    "text": "The higher the cost, the\nmore support vectors we have,",
    "start": "113780",
    "end": "118850"
  },
  {
    "text": "and the wider the margin is--",
    "start": "118850",
    "end": "121220"
  },
  {
    "text": "there's also this\nargument here, kernel,",
    "start": "121220",
    "end": "124250"
  },
  {
    "text": "and we'll see-- we're going\nto use a linear kernel here.",
    "start": "124250",
    "end": "126980"
  },
  {
    "text": "That means that\nthe boundaries are",
    "start": "126980",
    "end": "128810"
  },
  {
    "text": "going to be determined\nby linear functions.",
    "start": "128810",
    "end": "132110"
  },
  {
    "text": "There are other kernels.",
    "start": "132110",
    "end": "134398"
  },
  {
    "text": "One of the most commonly used\nkernels, which we'll see later,",
    "start": "134398",
    "end": "136940"
  },
  {
    "text": "is the radial basis function\nkernel, also a Gaussian kernel.",
    "start": "136940",
    "end": "140240"
  },
  {
    "text": "So these are the\ntwo main arguments",
    "start": "140240",
    "end": "141700"
  },
  {
    "text": "you have to choose when fitting\na support vector classifier.",
    "start": "141700",
    "end": "144200"
  },
  {
    "text": "OK.",
    "start": "144200",
    "end": "146580"
  },
  {
    "text": "So again, it's a\nscikit-learn estimator.",
    "start": "146580",
    "end": "149190"
  },
  {
    "text": "So we fit it the same way, and\nwe can predict the same way.",
    "start": "149190",
    "end": "152315"
  },
  {
    "start": "152315",
    "end": "155570"
  },
  {
    "text": "So here's the function.",
    "start": "155570",
    "end": "158020"
  },
  {
    "text": "We made this function\nplot_svm that",
    "start": "158020",
    "end": "160960"
  },
  {
    "text": "takes a feature\nmatrix, and an outcome,",
    "start": "160960",
    "end": "164650"
  },
  {
    "text": "and a fitted classifier, and\nplots the decision boundaries",
    "start": "164650",
    "end": "168430"
  },
  {
    "text": "as well as the support points.",
    "start": "168430",
    "end": "170510"
  },
  {
    "text": "So in this svm_linear,\nthere's information",
    "start": "170510",
    "end": "173170"
  },
  {
    "text": "about what points are used\nas the support points,",
    "start": "173170",
    "end": "175599"
  },
  {
    "text": "and we've labeled\nthose with a plus here.",
    "start": "175600",
    "end": "178240"
  },
  {
    "text": "I see it changed colors on us.",
    "start": "178240",
    "end": "181000"
  },
  {
    "text": "The reds have become greens.",
    "start": "181000",
    "end": "182680"
  },
  {
    "text": "Yes.",
    "start": "182680",
    "end": "183790"
  },
  {
    "text": "That's a bit unfortunate.",
    "start": "183790",
    "end": "185709"
  },
  {
    "text": "That is likely-- well,\nI didn't re-plot them.",
    "start": "185710",
    "end": "188920"
  },
  {
    "text": "It plotted them itself.",
    "start": "188920",
    "end": "190360"
  },
  {
    "text": "Yeah.",
    "start": "190360",
    "end": "191272"
  },
  {
    "text": "That's all right.",
    "start": "191272",
    "end": "191980"
  },
  {
    "text": "Yes.",
    "start": "191980",
    "end": "192480"
  },
  {
    "start": "192480",
    "end": "195940"
  },
  {
    "text": "So what we see here is\nthis the decision boundary.",
    "start": "195940",
    "end": "199100"
  },
  {
    "text": "It is linear for this\nlinear classifier.",
    "start": "199100",
    "end": "201580"
  },
  {
    "text": "And these points here, these\nare points within the margin,",
    "start": "201580",
    "end": "205600"
  },
  {
    "text": "and these are the\npoints that are",
    "start": "205600",
    "end": "207747"
  },
  {
    "text": "on the wrong side of the margin.",
    "start": "207747",
    "end": "209079"
  },
  {
    "text": "They are marked\nhere with the plus.",
    "start": "209080",
    "end": "210850"
  },
  {
    "text": "So these here should be green,\nand these here should be blue.",
    "start": "210850",
    "end": "213725"
  },
  {
    "text": "OK.",
    "start": "213725",
    "end": "214225"
  },
  {
    "start": "214225",
    "end": "216880"
  },
  {
    "text": "And there are about\n25 points there.",
    "start": "216880",
    "end": "219760"
  },
  {
    "text": "I'm not exactly sure.",
    "start": "219760",
    "end": "222280"
  },
  {
    "text": "So we're going to change\nthe cost parameter 0.1.",
    "start": "222280",
    "end": "230730"
  },
  {
    "text": "Oh, I think I misspoke before.",
    "start": "230730",
    "end": "232260"
  },
  {
    "text": "There is a parameter.",
    "start": "232260",
    "end": "233400"
  },
  {
    "text": "So yes, to my defense,\nthere are a few different--",
    "start": "233400",
    "end": "236970"
  },
  {
    "text": "let me say how did I\nmisspeak before, shall we?",
    "start": "236970",
    "end": "240280"
  },
  {
    "text": "Please go.",
    "start": "240280",
    "end": "240780"
  },
  {
    "text": "No, I see it now.",
    "start": "240780",
    "end": "242280"
  },
  {
    "text": "It is the cost.",
    "start": "242280",
    "end": "243160"
  },
  {
    "text": "So the cost, if the lower\ncost on the other side",
    "start": "243160",
    "end": "248040"
  },
  {
    "text": "of the margin, you'll allow\nmore points on the other side.",
    "start": "248040",
    "end": "252090"
  },
  {
    "text": "Yes.",
    "start": "252090",
    "end": "253599"
  },
  {
    "text": "I was hoping we could\njust let that one slip by.",
    "start": "253600",
    "end": "255600"
  },
  {
    "text": "But anyway, you picked up on--",
    "start": "255600",
    "end": "256859"
  },
  {
    "text": "Yes.",
    "start": "256860",
    "end": "257359"
  },
  {
    "text": "Well, I mean--",
    "start": "257360",
    "end": "258000"
  },
  {
    "text": "So the smaller the cost, the\nmore support points you get.",
    "start": "258000",
    "end": "261898"
  },
  {
    "text": "Yes.",
    "start": "261899",
    "end": "262530"
  },
  {
    "text": "You pay less of a price\nfor being on the wrong side",
    "start": "262530",
    "end": "265650"
  },
  {
    "text": "of the margin.",
    "start": "265650",
    "end": "266250"
  },
  {
    "text": "Yes.",
    "start": "266250",
    "end": "267720"
  },
  {
    "text": "my slight difference,\nsome people",
    "start": "267720",
    "end": "269880"
  },
  {
    "text": "parameterize cost inversely.",
    "start": "269880",
    "end": "271720"
  },
  {
    "text": "Yeah.",
    "start": "271720",
    "end": "272220"
  },
  {
    "text": "And then I would have\nbeen OK in that case,",
    "start": "272220",
    "end": "274270"
  },
  {
    "text": "but it matters actually\nhow it's parameterized.",
    "start": "274270",
    "end": "276690"
  },
  {
    "text": "And so with this\ncost, the smaller one",
    "start": "276690",
    "end": "279155"
  },
  {
    "text": "means there's smaller cost\nbeing on the wrong side,",
    "start": "279155",
    "end": "281280"
  },
  {
    "text": "so it's easier.",
    "start": "281280",
    "end": "283080"
  },
  {
    "text": "And what we're meant to see here\nis that there are more support",
    "start": "283080",
    "end": "285870"
  },
  {
    "text": "points.",
    "start": "285870",
    "end": "286169"
  },
  {
    "text": "There are about the same\nnumber of support points,",
    "start": "286170",
    "end": "288000"
  },
  {
    "text": "but there are some regions,\nlike this region here,",
    "start": "288000",
    "end": "290320"
  },
  {
    "text": "that have come in.",
    "start": "290320",
    "end": "291260"
  },
  {
    "text": "And if you look at the margin,\nlet's see, this point here",
    "start": "291260",
    "end": "295150"
  },
  {
    "text": "must not be in the other plot.",
    "start": "295150",
    "end": "296660"
  },
  {
    "text": "Let's take a look.",
    "start": "296660",
    "end": "297520"
  },
  {
    "text": "That's the farthest one.",
    "start": "297520",
    "end": "298870"
  },
  {
    "text": "So that point is not across\nthe margin when we use 10.",
    "start": "298870",
    "end": "303100"
  },
  {
    "text": "So in a sense, the\nsmaller the cost,",
    "start": "303100",
    "end": "305980"
  },
  {
    "text": "the more support points\nyou got, and that",
    "start": "305980",
    "end": "309820"
  },
  {
    "text": "means the solution's somehow\nmore regularized because you're",
    "start": "309820",
    "end": "312940"
  },
  {
    "text": "using more of the training data\nto determine the orientation",
    "start": "312940",
    "end": "317860"
  },
  {
    "text": "of the decision boundary.",
    "start": "317860",
    "end": "319330"
  },
  {
    "text": "That's right.",
    "start": "319330",
    "end": "320110"
  },
  {
    "text": "Yes, the slope of\nthis line here is",
    "start": "320110",
    "end": "321610"
  },
  {
    "text": "determined by somehow averaging\nthe points on each side.",
    "start": "321610",
    "end": "326800"
  },
  {
    "text": "Exactly.",
    "start": "326800",
    "end": "327370"
  },
  {
    "text": "Yeah.",
    "start": "327370",
    "end": "327940"
  },
  {
    "text": "So if you only have a few,\nthen it will be less robust.",
    "start": "327940",
    "end": "330890"
  },
  {
    "text": "OK.",
    "start": "330890",
    "end": "331390"
  },
  {
    "start": "331390",
    "end": "335440"
  },
  {
    "text": "So since it's a\nlinear classifier,",
    "start": "335440",
    "end": "339040"
  },
  {
    "text": "you can actually\nfind the direction",
    "start": "339040",
    "end": "341890"
  },
  {
    "text": "of the decision boundary.",
    "start": "341890",
    "end": "343450"
  },
  {
    "text": "And that, of course, would\nbe not this direction here,",
    "start": "343450",
    "end": "346420"
  },
  {
    "text": "but it would be this direction\nhere that you can use",
    "start": "346420",
    "end": "349330"
  },
  {
    "text": "to determine the classifier.",
    "start": "349330",
    "end": "352865"
  },
  {
    "text": "OK.",
    "start": "352865",
    "end": "353365"
  },
  {
    "text": "Well, we have this\ntuning parameter C.",
    "start": "353365",
    "end": "356169"
  },
  {
    "text": "We had used two values\nbefore 0.1 and 10.",
    "start": "356170",
    "end": "360790"
  },
  {
    "text": "Why don't we see if we can\nfind a good one automatically?",
    "start": "360790",
    "end": "365350"
  },
  {
    "text": "Well, this is one\nof the nice things",
    "start": "365350",
    "end": "369130"
  },
  {
    "text": "about scikit-learn,\nof course, is",
    "start": "369130",
    "end": "370900"
  },
  {
    "text": "that if you have\nan estimator, you",
    "start": "370900",
    "end": "373600"
  },
  {
    "text": "can pick a cross-validation\nmethod, like five-fold cross",
    "start": "373600",
    "end": "376360"
  },
  {
    "text": "validation or a\ntrain test split.",
    "start": "376360",
    "end": "380680"
  },
  {
    "text": "And then you can use\nthis GridSearchCV to try",
    "start": "380680",
    "end": "383560"
  },
  {
    "text": "and tune that parameter.",
    "start": "383560",
    "end": "386348"
  },
  {
    "text": "So the parameters that\nwe're going to search over",
    "start": "386348",
    "end": "388389"
  },
  {
    "text": "are given by the\nsecond argument.",
    "start": "388390",
    "end": "390440"
  },
  {
    "text": "And here, this is a dictionary,\nwith the argument C being",
    "start": "390440",
    "end": "396950"
  },
  {
    "text": "the possible values that will.",
    "start": "396950",
    "end": "398570"
  },
  {
    "text": "So we'll look at C from 0.01\nto 100 fitting the grid search.",
    "start": "398570",
    "end": "404640"
  },
  {
    "text": "Yeah.",
    "start": "404640",
    "end": "405140"
  },
  {
    "text": "And by the way, we saw the\ncross-validation in action",
    "start": "405140",
    "end": "408290"
  },
  {
    "text": "in the labs for\nchapter 6 as well.",
    "start": "408290",
    "end": "410468"
  },
  {
    "text": "That's right.",
    "start": "410468",
    "end": "411009"
  },
  {
    "text": "That's where we encountered\nthis GridSearchCV.",
    "start": "411010",
    "end": "416050"
  },
  {
    "text": "And so it's picked the best\nparameters and the cost",
    "start": "416050",
    "end": "420009"
  },
  {
    "text": "being 1.",
    "start": "420010",
    "end": "422710"
  },
  {
    "text": "And like in chapter 6, the\nbest estimator is stored",
    "start": "422710",
    "end": "426639"
  },
  {
    "text": "as grid.best_estimator_.",
    "start": "426640",
    "end": "430360"
  },
  {
    "text": "So we can use that to predict\nnew methods going forward.",
    "start": "430360",
    "end": "432909"
  },
  {
    "start": "432910",
    "end": "435145"
  },
  {
    "text": "OK.",
    "start": "435145",
    "end": "435645"
  },
  {
    "text": "So let's take a look at\nhow this choice was made.",
    "start": "435645",
    "end": "439490"
  },
  {
    "text": "As we saw in chapter 6, the\ngrid computes the test score",
    "start": "439490",
    "end": "445440"
  },
  {
    "text": "as a function of the\ndifferent parameters,",
    "start": "445440",
    "end": "447580"
  },
  {
    "text": "and we can see here,\nhere's the mean test score,",
    "start": "447580",
    "end": "449639"
  },
  {
    "text": "in this case, accuracy.",
    "start": "449640",
    "end": "451110"
  },
  {
    "text": "And actually, although it\npicked this value 0.1 here,",
    "start": "451110",
    "end": "455520"
  },
  {
    "text": "that's the index\ncorresponding to 0.1,",
    "start": "455520",
    "end": "458759"
  },
  {
    "text": "there are actually four\ndifferent cost parameters",
    "start": "458760",
    "end": "461400"
  },
  {
    "text": "that gave us the\nsame classification.",
    "start": "461400",
    "end": "463080"
  },
  {
    "text": "So it's not necessarily a\nvery clear-cut choice that--",
    "start": "463080",
    "end": "469780"
  },
  {
    "text": "that 1 is the best.",
    "start": "469780",
    "end": "470850"
  },
  {
    "text": "So since small c's correspond\nto more regularization,",
    "start": "470850",
    "end": "474630"
  },
  {
    "text": "it's choosing the most\nregularized solution.",
    "start": "474630",
    "end": "480390"
  },
  {
    "text": "That gives the same--",
    "start": "480390",
    "end": "481740"
  },
  {
    "text": "Among the same.",
    "start": "481740",
    "end": "482520"
  },
  {
    "text": "Yes.",
    "start": "482520",
    "end": "483190"
  },
  {
    "text": "Errors.",
    "start": "483190",
    "end": "483690"
  },
  {
    "text": "Yeah.",
    "start": "483690",
    "end": "484190"
  },
  {
    "start": "484190",
    "end": "487170"
  },
  {
    "text": "OK.",
    "start": "487170",
    "end": "487670"
  },
  {
    "text": "And if we want to\nevaluate this estimator,",
    "start": "487670",
    "end": "492600"
  },
  {
    "text": "again, the\ngrid-best_estimator is the one",
    "start": "492600",
    "end": "494860"
  },
  {
    "text": "that was tuned by GridSearchCV.",
    "start": "494860",
    "end": "497439"
  },
  {
    "text": "We can generate new data\nfrom the same distribution",
    "start": "497440",
    "end": "500240"
  },
  {
    "text": "and compute a confusion matrix.",
    "start": "500240",
    "end": "504919"
  },
  {
    "text": "So here, we're just going to\ngenerate some new X's and Y's",
    "start": "504920",
    "end": "507850"
  },
  {
    "text": "using the same data-generating\nmechanism as above,",
    "start": "507850",
    "end": "511990"
  },
  {
    "text": "and we'll compute the\npredictions using our best",
    "start": "511990",
    "end": "516219"
  },
  {
    "text": "estimator and compare\nthem to our actual labels.",
    "start": "516220",
    "end": "521928"
  },
  {
    "text": "And here, our\nclassifier got about 70%",
    "start": "521929",
    "end": "526240"
  },
  {
    "text": "accurate, which is pretty\nclose to the 74% that the--",
    "start": "526240",
    "end": "529790"
  },
  {
    "text": "yeah.",
    "start": "529790",
    "end": "530290"
  },
  {
    "text": "And then we only used 20 points.",
    "start": "530290",
    "end": "532320"
  },
  {
    "text": "We could have used more.",
    "start": "532320",
    "end": "533320"
  },
  {
    "text": "We might have gotten\neven closer to 74%.",
    "start": "533320",
    "end": "534987"
  },
  {
    "start": "534987",
    "end": "538262"
  },
  {
    "text": "OK.",
    "start": "538262",
    "end": "538762"
  },
  {
    "text": "So instead of taking\nthe best estimator,",
    "start": "538762",
    "end": "541320"
  },
  {
    "text": "we choose a parameter\nthat was not",
    "start": "541320",
    "end": "544710"
  },
  {
    "text": "chosen to be best, like\nsomething very small.",
    "start": "544710",
    "end": "549030"
  },
  {
    "text": "So this is quite\nregularized, right?",
    "start": "549030",
    "end": "555210"
  },
  {
    "text": "Now, I'm getting the\nindex wrong again.",
    "start": "555210",
    "end": "559560"
  },
  {
    "text": "Here, it's 60% on this data set.",
    "start": "559560",
    "end": "562029"
  },
  {
    "text": "So it did seem to make\na reasonable choice",
    "start": "562030",
    "end": "564870"
  },
  {
    "text": "at choosing 1.",
    "start": "564870",
    "end": "565950"
  },
  {
    "text": "At least 1 seems\nbetter than 0.001.",
    "start": "565950",
    "end": "572550"
  },
  {
    "text": "Also, we're going to\nlook at an example",
    "start": "572550",
    "end": "575850"
  },
  {
    "text": "where we can linearly\nseparate the data.",
    "start": "575850",
    "end": "578440"
  },
  {
    "text": "So here, we've just\nmoved the mean of the red",
    "start": "578440",
    "end": "581130"
  },
  {
    "text": "and the blue points a\nlittle bit further apart.",
    "start": "581130",
    "end": "584076"
  },
  {
    "text": "And if we fit the\nsupport vector machine,",
    "start": "584076",
    "end": "590519"
  },
  {
    "text": "we should see that it\nshould be separable.",
    "start": "590520",
    "end": "595080"
  },
  {
    "text": "And here, we put a\nvery large cost here.",
    "start": "595080",
    "end": "597530"
  },
  {
    "text": "So if the cost is not--",
    "start": "597530",
    "end": "601540"
  },
  {
    "text": "I wonder if any cost--",
    "start": "601540",
    "end": "602529"
  },
  {
    "start": "602530",
    "end": "606280"
  },
  {
    "text": "for a very high cost, it should\npick the separable solution.",
    "start": "606280",
    "end": "609220"
  },
  {
    "text": "But for low cost, actually,\nyeah, off the top of my head.",
    "start": "609220",
    "end": "612439"
  },
  {
    "text": "I'm not sure if it would\npick the separable solution.",
    "start": "612440",
    "end": "614860"
  },
  {
    "text": "No, it would still allow\nmore support points.",
    "start": "614860",
    "end": "617820"
  },
  {
    "text": "Yeah.",
    "start": "617820",
    "end": "618320"
  },
  {
    "start": "618320",
    "end": "621975"
  },
  {
    "text": "OK.",
    "start": "621975",
    "end": "622475"
  },
  {
    "text": "And here, we can see that\nthis is a case where there's",
    "start": "622475",
    "end": "624889"
  },
  {
    "text": "a very few support points.",
    "start": "624890",
    "end": "626120"
  },
  {
    "text": "Compared to the 20\nor so, we had 4.",
    "start": "626120",
    "end": "627920"
  },
  {
    "text": "We had 3.",
    "start": "627920",
    "end": "629690"
  },
  {
    "text": "So if we sort of change\nthis class a little bit",
    "start": "629690",
    "end": "635240"
  },
  {
    "text": "or this class a little\nbit, these points here",
    "start": "635240",
    "end": "637220"
  },
  {
    "text": "that are the support\npoints are likely to move.",
    "start": "637220",
    "end": "639620"
  },
  {
    "text": "And hence, the plane,\nas we discussed before,",
    "start": "639620",
    "end": "643279"
  },
  {
    "text": "formed by these support points,\nmight also be quite variable.",
    "start": "643280",
    "end": "646700"
  },
  {
    "text": "And of course, there are many\nseparating hyperplanes here.",
    "start": "646700",
    "end": "649760"
  },
  {
    "text": "So we'd expect this\nto vary a lot as we",
    "start": "649760",
    "end": "651710"
  },
  {
    "text": "change training and test data.",
    "start": "651710",
    "end": "653230"
  },
  {
    "text": "As statisticians, when\nwe look at this plot,",
    "start": "653230",
    "end": "655829"
  },
  {
    "text": "we see that the decision\nboundary is determined here",
    "start": "655830",
    "end": "659330"
  },
  {
    "text": "by just three data points.",
    "start": "659330",
    "end": "661170"
  },
  {
    "text": "And so that makes\nyou suspect it's not",
    "start": "661170",
    "end": "663500"
  },
  {
    "text": "that robust because these are\ndata points on the boundaries",
    "start": "663500",
    "end": "666800"
  },
  {
    "text": "of each of their classes.",
    "start": "666800",
    "end": "668519"
  },
  {
    "text": "And so as Jonathan said,\nchange the data little bit,",
    "start": "668520",
    "end": "672440"
  },
  {
    "text": "and that can change your\norientation of the decision",
    "start": "672440",
    "end": "675920"
  },
  {
    "text": "boundary dramatically.",
    "start": "675920",
    "end": "676940"
  },
  {
    "text": "Yeah.",
    "start": "676940",
    "end": "677600"
  },
  {
    "text": "I mean, there's also--",
    "start": "677600",
    "end": "679490"
  },
  {
    "text": "this is one\nseparating hyperplane,",
    "start": "679490",
    "end": "681390"
  },
  {
    "text": "but there are many here, right?",
    "start": "681390",
    "end": "682810"
  },
  {
    "text": "Yes.",
    "start": "682810",
    "end": "684310"
  },
  {
    "text": "Exactly.",
    "start": "684310",
    "end": "684810"
  },
  {
    "start": "684810",
    "end": "693420"
  },
  {
    "text": "So I'm just going to move\non to the next topic.",
    "start": "693420",
    "end": "700320"
  },
  {
    "text": "We saw above the linear\nsupport vector classifier.",
    "start": "700320",
    "end": "704560"
  },
  {
    "text": "So that's used as linear\ndecision boundaries.",
    "start": "704560",
    "end": "708430"
  },
  {
    "text": "One of the main uses of\nsupport vector classifiers",
    "start": "708430",
    "end": "711570"
  },
  {
    "text": "is for non-linear\nboundaries, and the way",
    "start": "711570",
    "end": "714030"
  },
  {
    "text": "it does that is changing\nthis kernel argument.",
    "start": "714030",
    "end": "716940"
  },
  {
    "text": "Earlier, we used\nkernel with linear.",
    "start": "716940",
    "end": "719370"
  },
  {
    "text": "Other popular choices are\npolynomial or radial basis",
    "start": "719370",
    "end": "723029"
  },
  {
    "text": "function kernel.",
    "start": "723030",
    "end": "723840"
  },
  {
    "text": "So the radial basis function\nkernel that's a Gaussian.",
    "start": "723840",
    "end": "726670"
  },
  {
    "text": "So it looks something like this.",
    "start": "726670",
    "end": "730269"
  },
  {
    "text": "So under the hood, what's\ngoing to happen is,",
    "start": "730270",
    "end": "732840"
  },
  {
    "text": "there will be each--",
    "start": "732840",
    "end": "735300"
  },
  {
    "text": "point in the two\nclasses will have",
    "start": "735300",
    "end": "737070"
  },
  {
    "text": "a potential little radial\nbasis function attached to it,",
    "start": "737070",
    "end": "740850"
  },
  {
    "text": "and the weights we saw for the\nlinear decision boundary will",
    "start": "740850",
    "end": "744300"
  },
  {
    "text": "be attached to the\npoints, multiplying",
    "start": "744300",
    "end": "748560"
  },
  {
    "text": "those bumps we saw before.",
    "start": "748560",
    "end": "750160"
  },
  {
    "text": "So in this case, the\ndecision boundary",
    "start": "750160",
    "end": "752040"
  },
  {
    "text": "is going to be where some\nlinear combination of bumps,",
    "start": "752040",
    "end": "755019"
  },
  {
    "text": "like this bump and\nthat bump or that 0.",
    "start": "755020",
    "end": "757960"
  },
  {
    "text": "So it's going to be some kind\nof possibly complicated shape.",
    "start": "757960",
    "end": "760810"
  },
  {
    "start": "760810",
    "end": "763220"
  },
  {
    "text": "OK.",
    "start": "763220",
    "end": "763720"
  },
  {
    "text": "So we're going to make a\nslightly more complex data set",
    "start": "763720",
    "end": "768399"
  },
  {
    "text": "here and by hiding sort of\none cloud of one red class",
    "start": "768400",
    "end": "775840"
  },
  {
    "text": "in between two blue classes.",
    "start": "775840",
    "end": "777890"
  },
  {
    "text": "So let's just take a look at\nwhat our data looks like here.",
    "start": "777890",
    "end": "781900"
  },
  {
    "text": "Oh, yeah.",
    "start": "781900",
    "end": "782710"
  },
  {
    "text": "So this is one where\nwe wouldn't expect",
    "start": "782710",
    "end": "785290"
  },
  {
    "text": "a linear decision boundary\ncould do very well, right?",
    "start": "785290",
    "end": "787779"
  },
  {
    "text": "because there's blue.",
    "start": "787780",
    "end": "788950"
  },
  {
    "text": "Anyway, we cut through the red.",
    "start": "788950",
    "end": "790390"
  },
  {
    "text": "There's going to be blue\non either side of it.",
    "start": "790390",
    "end": "792620"
  },
  {
    "text": "So using this radial\nbasis function,",
    "start": "792620",
    "end": "796600"
  },
  {
    "text": "abstractly, we could\nput a big bump here,",
    "start": "796600",
    "end": "799029"
  },
  {
    "text": "a big bump here with\npositive weights,",
    "start": "799030",
    "end": "801220"
  },
  {
    "text": "and then maybe a bump down\nhere with negative weights,",
    "start": "801220",
    "end": "803470"
  },
  {
    "text": "and that might separate\nthe classes pretty well.",
    "start": "803470",
    "end": "807050"
  },
  {
    "text": "It's not exactly doing one\nor two bumps like that,",
    "start": "807050",
    "end": "809709"
  },
  {
    "text": "but it's doing some linear\ncombination of bumps",
    "start": "809710",
    "end": "812170"
  },
  {
    "text": "to try and make a good\nboundary in a non-linear space.",
    "start": "812170",
    "end": "816130"
  },
  {
    "text": "That's a weird\ndata set, isn't it?",
    "start": "816130",
    "end": "818110"
  },
  {
    "text": "Yes.",
    "start": "818110",
    "end": "819070"
  },
  {
    "text": "I wonder why we chose that one.",
    "start": "819070",
    "end": "821230"
  },
  {
    "text": "Well, I think to make\nit more complicated.",
    "start": "821230",
    "end": "823480"
  },
  {
    "text": "Because the next picture\nlooks really good.",
    "start": "823480",
    "end": "825492"
  },
  {
    "text": "Yes.",
    "start": "825492",
    "end": "825992"
  },
  {
    "text": "OK.",
    "start": "825992",
    "end": "826492"
  },
  {
    "start": "826492",
    "end": "830860"
  },
  {
    "text": "So we're going to do a training\nand test split to evaluate it",
    "start": "830860",
    "end": "835779"
  },
  {
    "text": "later, and we're going to fit\nour SVM on the training data.",
    "start": "835780",
    "end": "841100"
  },
  {
    "text": "So here is the part\nwhere we actually",
    "start": "841100",
    "end": "843940"
  },
  {
    "text": "fit the support vector machine.",
    "start": "843940",
    "end": "846430"
  },
  {
    "text": "We give it this kernel argument\nas radial basis function.",
    "start": "846430",
    "end": "849760"
  },
  {
    "text": "We still have this cost.",
    "start": "849760",
    "end": "850870"
  },
  {
    "text": "And then there's\nthis gamma parameter.",
    "start": "850870",
    "end": "852700"
  },
  {
    "text": "And this gamma\nparameter determines",
    "start": "852700",
    "end": "854920"
  },
  {
    "text": "the size of the bumps.",
    "start": "854920",
    "end": "856358"
  },
  {
    "text": "Not necessarily the height,\nbut really the width.",
    "start": "856358",
    "end": "858399"
  },
  {
    "text": "So I've just made one--",
    "start": "858400",
    "end": "859810"
  },
  {
    "text": "so as you change gamma, you'll\nget different sizes like that.",
    "start": "859810",
    "end": "863020"
  },
  {
    "text": "And you should check\nthe documentation",
    "start": "863020",
    "end": "865360"
  },
  {
    "text": "whether the radial\nbasis function",
    "start": "865360",
    "end": "867310"
  },
  {
    "text": "looks like e to the minus\ngamma x squared over 2.",
    "start": "867310",
    "end": "870850"
  },
  {
    "text": "That's going to disappear,\nwhether gamma is above",
    "start": "870850",
    "end": "873639"
  },
  {
    "text": "or e to the minus x squared\nover 2 gamma down there.",
    "start": "873640",
    "end": "877210"
  },
  {
    "text": "And that will make a difference\nas how you vary gamma,",
    "start": "877210",
    "end": "879932"
  },
  {
    "text": "whether it makes a bigger\none or a smaller one.",
    "start": "879932",
    "end": "881890"
  },
  {
    "text": "OK.",
    "start": "881890",
    "end": "882390"
  },
  {
    "start": "882390",
    "end": "885520"
  },
  {
    "text": "So let's see what's happened.",
    "start": "885520",
    "end": "887090"
  },
  {
    "text": "Oh.",
    "start": "887090",
    "end": "887590"
  },
  {
    "text": "Look at that.",
    "start": "887590",
    "end": "888190"
  },
  {
    "text": "Oh, wow.",
    "start": "888190",
    "end": "888760"
  },
  {
    "text": "That did really well.",
    "start": "888760",
    "end": "889990"
  },
  {
    "text": "Yeah.",
    "start": "889990",
    "end": "890620"
  },
  {
    "text": "It must always do really well.",
    "start": "890620",
    "end": "892540"
  },
  {
    "text": "No, it doesn't always\ndo really well.",
    "start": "892540",
    "end": "894100"
  },
  {
    "text": "Oh, that's too bad.",
    "start": "894100",
    "end": "895540"
  },
  {
    "text": "Yes.",
    "start": "895540",
    "end": "896110"
  },
  {
    "text": "So we did pick a\ndata set for which",
    "start": "896110",
    "end": "898600"
  },
  {
    "text": "some non-linear method, like\nthe radial basis function,",
    "start": "898600",
    "end": "901509"
  },
  {
    "text": "will produce a nice plot.",
    "start": "901510",
    "end": "905770"
  },
  {
    "text": "Obviously, any\nparticular method is not",
    "start": "905770",
    "end": "907935"
  },
  {
    "text": "going to work well\nin every case,",
    "start": "907935",
    "end": "909310"
  },
  {
    "text": "but we're trying\nto illustrate how",
    "start": "909310",
    "end": "912055"
  },
  {
    "text": "you can use the radial\nbasis function to make",
    "start": "912055",
    "end": "913930"
  },
  {
    "text": "a non-linear boundary, and here,\nit did it did relatively well.",
    "start": "913930",
    "end": "918800"
  },
  {
    "text": "And again, these points here\nindicate the support vectors.",
    "start": "918800",
    "end": "923480"
  },
  {
    "text": "So the decision boundary\nis a linear combination",
    "start": "923480",
    "end": "926620"
  },
  {
    "text": "of those bumps, and it has a\nweight for each of these points",
    "start": "926620",
    "end": "929170"
  },
  {
    "text": "here.",
    "start": "929170",
    "end": "930250"
  },
  {
    "text": "Adding the bumps\nwith those weights",
    "start": "930250",
    "end": "932920"
  },
  {
    "text": "makes a function on the plane,\nand this decision boundary",
    "start": "932920",
    "end": "936130"
  },
  {
    "text": "is really the 0 set\nof that function.",
    "start": "936130",
    "end": "938390"
  },
  {
    "text": "So where it's\npositive, let's say,",
    "start": "938390",
    "end": "940630"
  },
  {
    "text": "we'll classify as blue,\nwhich was originally red.",
    "start": "940630",
    "end": "943480"
  },
  {
    "text": "And when it's negative,\nwe'll classify as blue.",
    "start": "943480",
    "end": "947160"
  },
  {
    "text": "The support points aren't\nas intuitive in this picture",
    "start": "947160",
    "end": "949959"
  },
  {
    "text": "as it was in the linear one.",
    "start": "949960",
    "end": "951620"
  },
  {
    "text": "No.",
    "start": "951620",
    "end": "952120"
  },
  {
    "text": "Yeah.",
    "start": "952120",
    "end": "952620"
  },
  {
    "text": "It's not clear why we have\nthese far points there,",
    "start": "952620",
    "end": "956480"
  },
  {
    "text": "and that's because there is a\nlinear separation in a higher",
    "start": "956480",
    "end": "961089"
  },
  {
    "text": "dimensional space,\nand we're only",
    "start": "961090",
    "end": "962590"
  },
  {
    "text": "seeing some the\ntwo-dimensional picture here.",
    "start": "962590",
    "end": "964862"
  },
  {
    "text": "Yeah.",
    "start": "964862",
    "end": "965362"
  },
  {
    "text": "OK.",
    "start": "965362",
    "end": "965862"
  },
  {
    "start": "965862",
    "end": "971620"
  },
  {
    "text": "So let's see.",
    "start": "971620",
    "end": "972850"
  },
  {
    "text": "Again, we can change\nthis cost parameter.",
    "start": "972850",
    "end": "975800"
  },
  {
    "text": "So if we increase\nthe cost parameter,",
    "start": "975800",
    "end": "980649"
  },
  {
    "text": "we'd expect to see\nfewer support points",
    "start": "980650",
    "end": "983530"
  },
  {
    "text": "as we did in the linear case.",
    "start": "983530",
    "end": "985060"
  },
  {
    "text": "And actually, with a\nquite high value here,",
    "start": "985060",
    "end": "987247"
  },
  {
    "text": "we have gotten rid of\na lot of these support",
    "start": "987247",
    "end": "989080"
  },
  {
    "text": "points around here.",
    "start": "989080",
    "end": "992140"
  },
  {
    "text": "And you're going to get\nmore wiggly solutions now",
    "start": "992140",
    "end": "994420"
  },
  {
    "text": "because what it's trying\nto do, is not misclassify",
    "start": "994420",
    "end": "998200"
  },
  {
    "text": "any of the training data.",
    "start": "998200",
    "end": "999860"
  },
  {
    "text": "So it's going to make its\ndecision boundary wrap around",
    "start": "999860",
    "end": "1002940"
  },
  {
    "text": "to this--",
    "start": "1002940",
    "end": "1003680"
  },
  {
    "text": "This is an example here.",
    "start": "1003680",
    "end": "1004710"
  },
  {
    "text": "Make sure there's no mistakes.",
    "start": "1004710",
    "end": "1005640"
  },
  {
    "text": "There's a little tiny island.",
    "start": "1005640",
    "end": "1006930"
  },
  {
    "text": "If we compare that\nto the previous one,",
    "start": "1006930",
    "end": "1008880"
  },
  {
    "text": "it's considerably smoother.",
    "start": "1008880",
    "end": "1011250"
  },
  {
    "text": "It doesn't have\nany little islands.",
    "start": "1011250",
    "end": "1013140"
  },
  {
    "text": "So overfitting in\nthe case like this.",
    "start": "1013140",
    "end": "1015540"
  },
  {
    "text": "Yes.",
    "start": "1015540",
    "end": "1017310"
  },
  {
    "text": "So let's see what the\ngrid search thinks",
    "start": "1017310",
    "end": "1022650"
  },
  {
    "text": "is the best parameter.",
    "start": "1022650",
    "end": "1023567"
  },
  {
    "text": "So now, we're going\nto look at an example.",
    "start": "1023567",
    "end": "1025317"
  },
  {
    "text": "We'll use the\nGridSearchCV again,",
    "start": "1025317",
    "end": "1026699"
  },
  {
    "text": "but our radial basis function\nsupport vector machine has two",
    "start": "1026700",
    "end": "1030209"
  },
  {
    "text": "parameters-- a\ncost and a gamma--",
    "start": "1030210",
    "end": "1032130"
  },
  {
    "text": "and we're going to use\nthe GridSearchCV function,",
    "start": "1032130",
    "end": "1035790"
  },
  {
    "text": "as we have in other examples,\nto find the best parameters.",
    "start": "1035790",
    "end": "1039209"
  },
  {
    "text": "Now, one difference\nin this example",
    "start": "1039210",
    "end": "1041039"
  },
  {
    "text": "is that we have two parameters.",
    "start": "1041040",
    "end": "1042810"
  },
  {
    "text": "So the argument we give\nfor the grid of values",
    "start": "1042810",
    "end": "1045359"
  },
  {
    "text": "is a dictionary with two\nentries-- one for the cost",
    "start": "1045359",
    "end": "1048480"
  },
  {
    "text": "and one for gamma.",
    "start": "1048480",
    "end": "1050100"
  },
  {
    "text": "But other than that, it's\nan estimated that we fit,",
    "start": "1050100",
    "end": "1053220"
  },
  {
    "text": "and it still returns\nthe best parameters.",
    "start": "1053220",
    "end": "1055500"
  },
  {
    "text": "But now, there\nare two parameters",
    "start": "1055500",
    "end": "1057330"
  },
  {
    "text": "in the dictionary because we\nhad two grids-- a grid of costs",
    "start": "1057330",
    "end": "1060269"
  },
  {
    "text": "and a grid of gammas--\nto search over.",
    "start": "1060270",
    "end": "1062100"
  },
  {
    "text": "So this is practical for small\ngrids and simple estimators.",
    "start": "1062100",
    "end": "1066480"
  },
  {
    "text": "If you have many\nparameters, of course,",
    "start": "1066480",
    "end": "1068590"
  },
  {
    "text": "this is going to be a\nlot of estimators to fit,",
    "start": "1068590",
    "end": "1070650"
  },
  {
    "text": "and that might take a while.",
    "start": "1070650",
    "end": "1071820"
  },
  {
    "start": "1071820",
    "end": "1074142"
  },
  {
    "text": "OK.",
    "start": "1074142",
    "end": "1074642"
  },
  {
    "text": "So it tells us cost 1, and\ngamma 0.5 is the best estimator,",
    "start": "1074642",
    "end": "1078480"
  },
  {
    "text": "and we're going to evaluate\nthe accuracy of this best",
    "start": "1078480",
    "end": "1081460"
  },
  {
    "text": "estimator on our test data and\ntake a look at the decision",
    "start": "1081460",
    "end": "1084042"
  },
  {
    "text": "boundary.",
    "start": "1084042",
    "end": "1084542"
  },
  {
    "text": "OK.",
    "start": "1084542",
    "end": "1086320"
  },
  {
    "text": "So we produce our predictions on\nthe test data, as we always do.",
    "start": "1086320",
    "end": "1094179"
  },
  {
    "text": "We store the best\nestimator as best_svm,",
    "start": "1094180",
    "end": "1097750"
  },
  {
    "text": "and we make a confusion\nmatrix, as we saw in chapter 4,",
    "start": "1097750",
    "end": "1101680"
  },
  {
    "text": "and it does quite well.",
    "start": "1101680",
    "end": "1103130"
  },
  {
    "text": "It has about 88% accuracy here.",
    "start": "1103130",
    "end": "1106630"
  },
  {
    "text": "Let's take a look at\nthe decision boundary.",
    "start": "1106630",
    "end": "1109130"
  },
  {
    "text": "It got a little pushed\ndown in this file here.",
    "start": "1109130",
    "end": "1112400"
  },
  {
    "text": "But if we look at this one,\nit looks pretty smooth,",
    "start": "1112400",
    "end": "1116860"
  },
  {
    "text": "similar to the one we saw\nour first set of parameters",
    "start": "1116860",
    "end": "1121120"
  },
  {
    "text": "and perhaps has a\nfew fewer support",
    "start": "1121120",
    "end": "1123138"
  },
  {
    "text": "vectors on the outskirts,\nbut it definitely",
    "start": "1123138",
    "end": "1124929"
  },
  {
    "text": "looks smoother than the\nvery highly flexible one",
    "start": "1124930",
    "end": "1127945"
  },
  {
    "text": "with a very high cost.",
    "start": "1127945",
    "end": "1129820"
  },
  {
    "text": "Looks really good.",
    "start": "1129820",
    "end": "1131820"
  },
  {
    "start": "1131820",
    "end": "1137000"
  }
]