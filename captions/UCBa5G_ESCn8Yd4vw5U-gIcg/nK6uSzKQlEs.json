[
  {
    "start": "0",
    "end": "156000"
  },
  {
    "text": "Chapter 18 is on an extension of, uh,",
    "start": "4280",
    "end": "7545"
  },
  {
    "text": "least squares, uh, to nonlinear least squares.",
    "start": "7545",
    "end": "10965"
  },
  {
    "text": "Uh, we'll explain that momentarily,",
    "start": "10965",
    "end": "12734"
  },
  {
    "text": "it's a very interesting topic.",
    "start": "12734",
    "end": "14865"
  },
  {
    "text": "So we'll start with the idea of nonlinear equations and nonlinear least squares.",
    "start": "14865",
    "end": "21415"
  },
  {
    "text": "So a set of nonlinear equations,",
    "start": "21415",
    "end": "24480"
  },
  {
    "text": "uh, looks something like this.",
    "start": "24480",
    "end": "26074"
  },
  {
    "text": "I have some variables,",
    "start": "26075",
    "end": "27425"
  },
  {
    "text": "uh, x_1 through x_n.",
    "start": "27425",
    "end": "29330"
  },
  {
    "text": "And those are scalar variables,",
    "start": "29330",
    "end": "30860"
  },
  {
    "text": "and I think of them altogether as simply a vec- uh, vector x.",
    "start": "30860",
    "end": "34380"
  },
  {
    "text": "Um, and then I have a set of equations like fi",
    "start": "34380",
    "end": "37610"
  },
  {
    "text": "of these variables is equal to 0 and I have m of those.",
    "start": "37610",
    "end": "41225"
  },
  {
    "text": "And this is like a- if f is affine,",
    "start": "41225",
    "end": "44269"
  },
  {
    "text": "this becomes a set of linear equations.",
    "start": "44270",
    "end": "47150"
  },
  {
    "text": "Um, so we refer to fi of x equals 0 as the ith equation.",
    "start": "47150",
    "end": "52650"
  },
  {
    "text": "Um, and if I commit- if I choose an x,",
    "start": "52650",
    "end": "55500"
  },
  {
    "text": "then fi of x is the ith residual.",
    "start": "55500",
    "end": "57915"
  },
  {
    "text": "Residual is usually something like an error",
    "start": "57915",
    "end": "60350"
  },
  {
    "text": "or it's- it's an amount by which something fails to hold.",
    "start": "60350",
    "end": "63495"
  },
  {
    "text": "And in this case, if fi of x is, you know,",
    "start": "63495",
    "end": "66600"
  },
  {
    "text": "with the- the residual,",
    "start": "66600",
    "end": "67715"
  },
  {
    "text": "it tells you if it's a zero,",
    "start": "67715",
    "end": "69579"
  },
  {
    "text": "that means that equation holds.",
    "start": "69580",
    "end": "71110"
  },
  {
    "text": "If it's, you know, uh, 0.003,",
    "start": "71110",
    "end": "74140"
  },
  {
    "text": "that means it almost holds.",
    "start": "74140",
    "end": "75760"
  },
  {
    "text": "And if it's minus 0.0001,",
    "start": "75760",
    "end": "77570"
  },
  {
    "text": "that means it also almost holds.",
    "start": "77570",
    "end": "79280"
  },
  {
    "text": "Okay, um, so we can write this set of eq- this system of equations,",
    "start": "79280",
    "end": "84979"
  },
  {
    "text": "up here, in a very compact form,",
    "start": "84980",
    "end": "86360"
  },
  {
    "text": "which is f of x equals zero.",
    "start": "86360",
    "end": "88315"
  },
  {
    "text": "Here, f is a function that maps R_n to R_m.",
    "start": "88315",
    "end": "92970"
  },
  {
    "text": "And that- what that means is it takes in an n vector or n- or n sca- uh,",
    "start": "92970",
    "end": "97410"
  },
  {
    "text": "scalar arguments, x_1 through x_n.",
    "start": "97410",
    "end": "99795"
  },
  {
    "text": "And it returns, uh,",
    "start": "99795",
    "end": "101880"
  },
  {
    "text": "an m vector, uh,",
    "start": "101880",
    "end": "103439"
  },
  {
    "text": "and these are the residuals.",
    "start": "103440",
    "end": "104565"
  },
  {
    "text": "The m residuals.",
    "start": "104565",
    "end": "106140"
  },
  {
    "text": "So- and sometimes you- you can write it this way,",
    "start": "106140",
    "end": "108290"
  },
  {
    "text": "it's f of x equals f_1 of x up to f_m of x.",
    "start": "108290",
    "end": "111470"
  },
  {
    "text": "[NOISE] Now, um, if f is affine,",
    "start": "111470",
    "end": "114980"
  },
  {
    "text": "the system of equations f of x equals zero is just a set- a set of linear equations.",
    "start": "114980",
    "end": "119555"
  },
  {
    "text": "And we'll refer to this set of linear equation, uh, sorry,",
    "start": "119555",
    "end": "122105"
  },
  {
    "text": "nonlinear equations, um, following the- uh,",
    "start": "122105",
    "end": "125965"
  },
  {
    "text": "following the nomenclature we used for linear equations,",
    "start": "125965",
    "end": "129274"
  },
  {
    "text": "we're going to refer to these as overdetermined,",
    "start": "129275",
    "end": "131555"
  },
  {
    "text": "if there is more- if there are more equations than variables.",
    "start": "131555",
    "end": "135564"
  },
  {
    "text": "Um, it's going to be underdetermined if there are fewer variables,",
    "start": "135565",
    "end": "139670"
  },
  {
    "text": "m, then- um, sorry.",
    "start": "139670",
    "end": "142215"
  },
  {
    "text": "If there's fewer, uh, equations than variables.",
    "start": "142215",
    "end": "145360"
  },
  {
    "text": "So m is the number of equations,",
    "start": "145360",
    "end": "146840"
  },
  {
    "text": "n is the number of variables and square if they're exactly equal.",
    "start": "146840",
    "end": "150739"
  },
  {
    "text": "So we're gonna follow the- the same nomenclature we used for,",
    "start": "150740",
    "end": "153970"
  },
  {
    "text": "uh, systems of linear equations.",
    "start": "153970",
    "end": "156970"
  },
  {
    "start": "156000",
    "end": "237000"
  },
  {
    "text": "Nonlinear least squares, uh,",
    "start": "157220",
    "end": "159855"
  },
  {
    "text": "is the following problem.",
    "start": "159855",
    "end": "161220"
  },
  {
    "text": "It's find- find a vector x hat that minimizes the following.",
    "start": "161220",
    "end": "166220"
  },
  {
    "text": "Simply, norm f of x squared.",
    "start": "166220",
    "end": "168055"
  },
  {
    "text": "And that's f_1 of x squared plus- it's basically",
    "start": "168055",
    "end": "170870"
  },
  {
    "text": "the sum of the squares of the residuals in an equation.",
    "start": "170870",
    "end": "174504"
  },
  {
    "text": "Okay. Um, now this includes the- the problem of solving,",
    "start": "174505",
    "end": "178440"
  },
  {
    "text": "uh, the equation- simply,",
    "start": "178440",
    "end": "179730"
  },
  {
    "text": "the nonlinear equations f of x equals 0,",
    "start": "179730",
    "end": "181364"
  },
  {
    "text": "that's a special case.",
    "start": "181365",
    "end": "182400"
  },
  {
    "text": "Um, because if there is an x for which f of x equals 0,",
    "start": "182400",
    "end": "187760"
  },
  {
    "text": "then for sure that x, uh,",
    "start": "187760",
    "end": "189724"
  },
  {
    "text": "is- is uh, solves- minimizes this.",
    "start": "189725",
    "end": "193195"
  },
  {
    "text": "Because then the norm squared is zero,",
    "start": "193195",
    "end": "195600"
  },
  {
    "text": "and norm squareds don't come any smaller than zero,",
    "start": "195600",
    "end": "198180"
  },
  {
    "text": "so that means that no other point x, uh, could beat it.",
    "start": "198180",
    "end": "201614"
  },
  {
    "text": "Okay? So- so this is just a special case.",
    "start": "201615",
    "end": "204675"
  },
  {
    "text": "Um, uh, but like linear least squares,",
    "start": "204675",
    "end": "207465"
  },
  {
    "text": "uh, it's super useful on its own.",
    "start": "207465",
    "end": "209254"
  },
  {
    "text": "In other words, even when there is no x for which f of x equals 0,",
    "start": "209255",
    "end": "213260"
  },
  {
    "text": "this find you something that kinda gives you a nice compromise,",
    "start": "213260",
    "end": "216680"
  },
  {
    "text": "that minimizes the sum of the squares of the residuals.",
    "start": "216680",
    "end": "219049"
  },
  {
    "text": "So very similar to, uh,",
    "start": "219049",
    "end": "221025"
  },
  {
    "text": "linear least squares, but this is the nonlinear least squares problem,",
    "start": "221025",
    "end": "224909"
  },
  {
    "text": "and so we have these- these functions and the goal is simply to minimize the-",
    "start": "224910",
    "end": "230210"
  },
  {
    "text": "basically the norm squared of f of x where f of x is this mapping from R_n to R_m.",
    "start": "230210",
    "end": "236590"
  },
  {
    "start": "237000",
    "end": "433000"
  },
  {
    "text": "So let's look at the optimality condition.",
    "start": "237860",
    "end": "241010"
  },
  {
    "text": "Uh, and we'll get that from, uh, calculus.",
    "start": "241010",
    "end": "243545"
  },
  {
    "text": "Um, and there may a  few things I'm going to say about that.",
    "start": "243545",
    "end": "246605"
  },
  {
    "text": "Um, so the first is that the gradient of the, uh, one- you know,",
    "start": "246605",
    "end": "252780"
  },
  {
    "text": "calculus tells us that if I have a function of many variables, um,",
    "start": "252780",
    "end": "257150"
  },
  {
    "text": "it- if a point x is optimal,",
    "start": "257150",
    "end": "260074"
  },
  {
    "text": "then the gradient vanishes at that point.",
    "start": "260075",
    "end": "264170"
  },
  {
    "text": "Um, by the way,",
    "start": "264170",
    "end": "265310"
  },
  {
    "text": "if that weren't the case,",
    "start": "265310",
    "end": "266375"
  },
  {
    "text": "you can just step in any dir- in, you know,",
    "start": "266375",
    "end": "268160"
  },
  {
    "text": "in one of the directions in order, uh,",
    "start": "268160",
    "end": "270080"
  },
  {
    "text": "a very small amount along one of the, uh,",
    "start": "270080",
    "end": "272699"
  },
  {
    "text": "along one of the axes to actually find a point that has slightly smaller,",
    "start": "272700",
    "end": "277415"
  },
  {
    "text": "uh, object- objective value.",
    "start": "277415",
    "end": "279230"
  },
  {
    "text": "In this case, the norm squared of f of x. Um, now also,",
    "start": "279230",
    "end": "283475"
  },
  {
    "text": "you should remember that there are points where the gradient vanishes,",
    "start": "283475",
    "end": "286850"
  },
  {
    "text": "but they don't minimize the function.",
    "start": "286850",
    "end": "288480"
  },
  {
    "text": "For example, they could maximize the function.",
    "start": "288480",
    "end": "290620"
  },
  {
    "text": "Okay. So as I said,",
    "start": "290620",
    "end": "293675"
  },
  {
    "text": "you know, points can satisfy this and not be optimal.",
    "start": "293675",
    "end": "296300"
  },
  {
    "text": "I think, uh, one way to say- points that satisfy this are sometimes called stationary.",
    "start": "296300",
    "end": "301115"
  },
  {
    "text": "Um, because- yeah, that's what it means.",
    "start": "301115",
    "end": "303509"
  },
  {
    "text": "And stationary means that if you move a little bit in any direction,",
    "start": "303510",
    "end": "307009"
  },
  {
    "text": "the function doesn't decrease, uh, fast.",
    "start": "307009",
    "end": "311120"
  },
  {
    "text": "Right? It might decrease a very,",
    "start": "311120",
    "end": "312290"
  },
  {
    "text": "very small amount, but that's- the- that's stationary.",
    "start": "312290",
    "end": "314485"
  },
  {
    "text": "Um, and the gradient of the norm squared of f of x,",
    "start": "314485",
    "end": "319250"
  },
  {
    "text": "um, we could write this out.",
    "start": "319250",
    "end": "320705"
  },
  {
    "text": "And, uh, by the way, this is a formula",
    "start": "320705",
    "end": "322550"
  },
  {
    "text": "completely analogous to what you'd see in the scalar case.",
    "start": "322550",
    "end": "325384"
  },
  {
    "text": "I'm not going to drive it here,",
    "start": "325385",
    "end": "326630"
  },
  {
    "text": "you- you'll find that in the book to see how that's derived.",
    "start": "326630",
    "end": "328855"
  },
  {
    "text": "But it turns out that this thing is exactly two times Df of x,",
    "start": "328855",
    "end": "334990"
  },
  {
    "text": "uh, hat transpose times f of x equals zero.",
    "start": "334990",
    "end": "338780"
  },
  {
    "text": "Okay? So that is the condition.",
    "start": "338780",
    "end": "340625"
  },
  {
    "text": "And you don't- look, that would be the same if I- if f were a scalar function,",
    "start": "340625",
    "end": "344240"
  },
  {
    "text": "and I said what- what's the condition that this is minimized?",
    "start": "344240",
    "end": "347935"
  },
  {
    "text": "Well, we'd take the gradient of this thing or- well,",
    "start": "347935",
    "end": "350480"
  },
  {
    "text": "in this case, just the derivative,",
    "start": "350480",
    "end": "351815"
  },
  {
    "text": "and we get two, uh,",
    "start": "351815",
    "end": "353780"
  },
  {
    "text": "f prime of x,",
    "start": "353780",
    "end": "356130"
  },
  {
    "text": "uh, times f of x.",
    "start": "356130",
    "end": "358260"
  },
  {
    "text": "Here is what we'd get.",
    "start": "358260",
    "end": "359730"
  },
  {
    "text": "And that would be- we'd want that to be zero if that's minimized.",
    "start": "359730",
    "end": "364275"
  },
  {
    "text": "Um, now, in the scalar case,",
    "start": "364275",
    "end": "366210"
  },
  {
    "text": "it's- it's pretty simple.",
    "start": "366210",
    "end": "367995"
  },
  {
    "text": "Um, it's either f of x is- it's either f of x is- is 0 or f prime of x is 0,",
    "start": "367995",
    "end": "373139"
  },
  {
    "text": "and this kinda makes sense. Um, okay.",
    "start": "373140",
    "end": "375555"
  },
  {
    "text": "So this is the matrix analog of this scalar equation here.",
    "start": "375555",
    "end": "381360"
  },
  {
    "text": "Um, right. Of course you don't see transposes here because these are just scalars.",
    "start": "381360",
    "end": "385085"
  },
  {
    "text": "All right. Now this matrix Df of x,",
    "start": "385085",
    "end": "388699"
  },
  {
    "text": "uh, Df evaluated at x hat,",
    "start": "388700",
    "end": "390875"
  },
  {
    "text": "that's the derivative or Jacobian matrix of the function f. Um,",
    "start": "390875",
    "end": "395445"
  },
  {
    "text": "and that's simply the matrix of partial derivatives.",
    "start": "395445",
    "end": "398385"
  },
  {
    "text": "So the ij entry is the partial deriv of fi,",
    "start": "398385",
    "end": "402540"
  },
  {
    "text": "uh, with respect to the variable x_j,",
    "start": "402540",
    "end": "405750"
  },
  {
    "text": "and all evaluated at x hat.",
    "start": "405750",
    "end": "407955"
  },
  {
    "text": "Okay. Now, this condition,",
    "start": "407955",
    "end": "411104"
  },
  {
    "text": "if f is affine, uh,",
    "start": "411105",
    "end": "414645"
  },
  {
    "text": "then this condition is- reduces exactly to the normal equations you see in- in normal,",
    "start": "414645",
    "end": "421490"
  },
  {
    "text": "uh- in- in- in linear least squares,",
    "start": "421490",
    "end": "423259"
  },
  {
    "text": "so-called linear least squares.",
    "start": "423260",
    "end": "424340"
  },
  {
    "text": "Oh, I should say that when we're talking about nonlinear least squares,",
    "start": "424340",
    "end": "426919"
  },
  {
    "text": "we refer to least squares as linear least squares to- to help distinguish.",
    "start": "426920",
    "end": "431930"
  },
  {
    "text": "[NOISE] Now we get to, uh, an admission.",
    "start": "431930",
    "end": "437215"
  },
  {
    "start": "433000",
    "end": "642000"
  },
  {
    "text": "So here's the admission.",
    "start": "437215",
    "end": "438620"
  },
  {
    "text": "It turns out solving nonlinear equations is like basically super hard.",
    "start": "438620",
    "end": "443495"
  },
  {
    "text": "So in other words,",
    "start": "443495",
    "end": "445169"
  },
  {
    "text": "simply, you know, if I give you, uh,",
    "start": "445170",
    "end": "447240"
  },
  {
    "text": "eve- even things with, you know,",
    "start": "447240",
    "end": "448740"
  },
  {
    "text": "as few as 10 or 20 variables,",
    "start": "448740",
    "end": "450599"
  },
  {
    "text": "and it turns out is just insanely difficult to actually",
    "start": "450599",
    "end": "453490"
  },
  {
    "text": "minimize the norm squared of f of x.",
    "start": "453490",
    "end": "456444"
  },
  {
    "text": "Um, so in- in particular,",
    "start": "456445",
    "end": "459445"
  },
  {
    "text": "it's much harder than solving linear equations.",
    "start": "459445",
    "end": "462530"
  },
  {
    "text": "We can solve linear equations with- easily with thousands of variables,",
    "start": "462530",
    "end": "466060"
  },
  {
    "text": "thousands of equations, no problem.",
    "start": "466060",
    "end": "468210"
  },
  {
    "text": "And we will always get exactly the solution, period.",
    "start": "468210",
    "end": "471440"
  },
  {
    "text": "Um, that's the least squares,",
    "start": "471440",
    "end": "472860"
  },
  {
    "text": "and will get it, by the way, super fast.",
    "start": "472860",
    "end": "474824"
  },
  {
    "text": "Um, nonlinear- nonlinear equations,",
    "start": "474825",
    "end": "477330"
  },
  {
    "text": "nonlinear least squares is a different story.",
    "start": "477330",
    "end": "479280"
  },
  {
    "text": "And in fact, the following is even hard.",
    "start": "479280",
    "end": "482955"
  },
  {
    "text": "If I give you a, um,",
    "start": "482955",
    "end": "485069"
  },
  {
    "text": "a nonlinear function f and I simply say,",
    "start": "485070",
    "end": "487320"
  },
  {
    "text": "\"Does there exist a solution?\"",
    "start": "487320",
    "end": "489525"
  },
  {
    "text": "So just find me- find me an x for which f of x equals 0.",
    "start": "489525",
    "end": "493675"
  },
  {
    "text": "Even that problem is hard.",
    "start": "493675",
    "end": "496095"
  },
  {
    "text": "Now, um, when I say it's- it's hard,",
    "start": "496095",
    "end": "499080"
  },
  {
    "text": "and I'm - what I am is I'm- I'm- I'm actually",
    "start": "499080",
    "end": "500789"
  },
  {
    "text": "lit- I'm just interpreting what it means to solve a problem.",
    "start": "500790",
    "end": "502940"
  },
  {
    "text": "It means to find a point where the norm squared is smaller than any other point.",
    "start": "502940",
    "end": "506960"
  },
  {
    "text": "Um, that is actually hard to do.",
    "start": "506960",
    "end": "509699"
  },
  {
    "text": "Uh, but we- turns out,",
    "start": "509700",
    "end": "511170"
  },
  {
    "text": "they're still methods, uh,",
    "start": "511170",
    "end": "512505"
  },
  {
    "text": "that do very well in a practical sense.",
    "start": "512505",
    "end": "515180"
  },
  {
    "text": "Um, and we'll use,",
    "start": "515180",
    "end": "517010"
  },
  {
    "text": "uh, so-called heuristic algorithms.",
    "start": "517010",
    "end": "519020"
  },
  {
    "text": "Now a heuristic algorithm is one that is- it's not always guaranteed to work,",
    "start": "519020",
    "end": "523925"
  },
  {
    "text": "work in the sense of actually finding the actual point that minimizes.",
    "start": "523925",
    "end": "528019"
  },
  {
    "text": "Um, but they often work very well in practice.",
    "start": "528020",
    "end": "530460"
  },
  {
    "text": "By the way, even when they failed to find a point that",
    "start": "530460",
    "end": "532580"
  },
  {
    "text": "truly minimizes the objective function,",
    "start": "532580",
    "end": "535185"
  },
  {
    "text": "um, they can find a point that is quite good.",
    "start": "535185",
    "end": "538000"
  },
  {
    "text": "Um, and the truth is often they do actually solve the problem.",
    "start": "538000",
    "end": "541565"
  },
  {
    "text": "Um, but we've encountered this before.",
    "start": "541565",
    "end": "544050"
  },
  {
    "text": "So, uh, the k-means algorithm is- that",
    "start": "544050",
    "end": "548295"
  },
  {
    "text": "is a- that is a heuristic for solving the quadratic clustering problem.",
    "start": "548295",
    "end": "554329"
  },
  {
    "text": "Um, and what that means is that the k-means algorithm.",
    "start": "554330",
    "end": "558690"
  },
  {
    "text": "When you run it, it is absolutely not guaranteed to",
    "start": "558690",
    "end": "561710"
  },
  {
    "text": "find the point that minimizes the objective in the k-means problem.",
    "start": "561710",
    "end": "564955"
  },
  {
    "text": "Okay? So- and we even saw that that was",
    "start": "564955",
    "end": "567230"
  },
  {
    "text": "the case because we'd run k-means a couple of times,",
    "start": "567230",
    "end": "569644"
  },
  {
    "text": "and we would indeed find that sometimes it- it finds,",
    "start": "569645",
    "end": "573075"
  },
  {
    "text": "you know, a point with one value,",
    "start": "573075",
    "end": "574590"
  },
  {
    "text": "and then later it finds a point with a lower value.",
    "start": "574590",
    "end": "576355"
  },
  {
    "text": "Meaning that in the first case, that was not optimal.",
    "start": "576355",
    "end": "578800"
  },
  {
    "text": "Period. It's also likely that the one you found later wasn't optimal.",
    "start": "578800",
    "end": "582339"
  },
  {
    "text": "So, um, nevertheless, uh,",
    "start": "582340",
    "end": "585160"
  },
  {
    "text": "heuristics like this still work very,",
    "start": "585160",
    "end": "587569"
  },
  {
    "text": "very well in practice.",
    "start": "587570",
    "end": "588800"
  },
  {
    "text": "Right? Hasn't- hasn't stopped the use of k-means,",
    "start": "588800",
    "end": "590959"
  },
  {
    "text": "k-means is used all over the world in hundreds of applications and areas all the time,",
    "start": "590960",
    "end": "597460"
  },
  {
    "text": "and it works just fine.",
    "start": "597460",
    "end": "598895"
  },
  {
    "text": "Thank you, in a practical sense.",
    "start": "598895",
    "end": "601020"
  },
  {
    "text": "Right? So the only thing I would say about that is if someone says,",
    "start": "601020",
    "end": "603770"
  },
  {
    "text": "\"Have you really minimized that?\"",
    "start": "603770",
    "end": "605420"
  },
  {
    "text": "You know, and if you're in a court of law or there's, I don't know,",
    "start": "605420",
    "end": "608570"
  },
  {
    "text": "mathematicians hanging around or something like that,",
    "start": "608570",
    "end": "611435"
  },
  {
    "text": "then your answer would have to be, \"Okay, no.",
    "start": "611435",
    "end": "614465"
  },
  {
    "text": "Technically I don't know that I've actually minimized it.",
    "start": "614465",
    "end": "616805"
  },
  {
    "text": "But boy, that's a pretty good- you know,",
    "start": "616805",
    "end": "618695"
  },
  {
    "text": "that's pretty good clustering, wouldn't you say?\"",
    "start": "618695",
    "end": "620795"
  },
  {
    "text": "So, uh- so that's the same idea with, um,",
    "start": "620795",
    "end": "623495"
  },
  {
    "text": "it's exactly the same for nonlinear equations where they generally,",
    "start": "623495",
    "end": "627304"
  },
  {
    "text": "um- generally we just use the heuristic",
    "start": "627304",
    "end": "630365"
  },
  {
    "text": "and the only thing happens here is you can't- you can't say that for sure,",
    "start": "630365",
    "end": "633890"
  },
  {
    "text": "uh, that is actually the point that minimizes the norm squared of f of x.",
    "start": "633890",
    "end": "641190"
  },
  {
    "start": "642000",
    "end": "1200000"
  },
  {
    "text": "We're now gonna look at a couple of examples,",
    "start": "643080",
    "end": "646150"
  },
  {
    "text": "uh, just to see,",
    "start": "646150",
    "end": "647650"
  },
  {
    "text": "uh, what, what do nonlinear least squares equations, I'm sorry, look like?",
    "start": "647650",
    "end": "652240"
  },
  {
    "text": "What, what the- what, what are",
    "start": "652240",
    "end": "653440"
  },
  {
    "text": "some nonlinear equations you might want to solve and so on.",
    "start": "653440",
    "end": "656560"
  },
  {
    "text": "Um, and by the way,",
    "start": "656560",
    "end": "657985"
  },
  {
    "text": "later I'll tell you- we'll describe these heuristic methods for,",
    "start": "657985",
    "end": "662260"
  },
  {
    "text": "uh, solving the nonlinear least squares problem,",
    "start": "662260",
    "end": "665845"
  },
  {
    "text": "which includes the special case solving nonlinear least squares.",
    "start": "665845",
    "end": "668529"
  },
  {
    "text": "But let's right now look just at some examples.",
    "start": "668530",
    "end": "671620"
  },
  {
    "text": "Okay. Here's one, is computing equilibrium points.",
    "start": "671620",
    "end": "676630"
  },
  {
    "text": "This comes up in a ton of fields all over,",
    "start": "676630",
    "end": "678730"
  },
  {
    "text": "all over it comes up.",
    "start": "678730",
    "end": "680245"
  },
  {
    "text": "And the general setting is that you've got a bunch of variables, n of them.",
    "start": "680245",
    "end": "684510"
  },
  {
    "text": "And then usually what you have is some kind of equilibrium condition.",
    "start": "684510",
    "end": "688650"
  },
  {
    "text": "And the equilibrium condition,",
    "start": "688650",
    "end": "690240"
  },
  {
    "text": "generally speaking, means that, you know,",
    "start": "690240",
    "end": "692250"
  },
  {
    "text": "sort of consumption matches,",
    "start": "692250",
    "end": "694800"
  },
  {
    "text": "uh- consumption matches production.",
    "start": "694800",
    "end": "697135"
  },
  {
    "text": "I mean, it- and it can depend what it is.",
    "start": "697135",
    "end": "699250"
  },
  {
    "text": "So these are- these are called computing.",
    "start": "699250",
    "end": "700300"
  },
  {
    "text": "You know, that's generally in equilibrium- an equilibrium point is when that happens.",
    "start": "700300",
    "end": "703945"
  },
  {
    "text": "Um, so I'll look at two examples,",
    "start": "703945",
    "end": "706750"
  },
  {
    "text": "uh, one from economics, one from chemistry.",
    "start": "706750",
    "end": "709825"
  },
  {
    "text": "So in economics you look at,",
    "start": "709825",
    "end": "712180"
  },
  {
    "text": "uh- you have the idea of equilibrium prices.",
    "start": "712180",
    "end": "714415"
  },
  {
    "text": "And so what that is is this, is I have a function S. And what it does is,",
    "start": "714415",
    "end": "720160"
  },
  {
    "text": "as I- we, we vary the prices of end goods,",
    "start": "720160",
    "end": "723175"
  },
  {
    "text": "that's the vector p, um,",
    "start": "723175",
    "end": "725380"
  },
  {
    "text": "S of p tells you what will be the supply, um,",
    "start": "725380",
    "end": "729775"
  },
  {
    "text": "of those goods if,",
    "start": "729775",
    "end": "732040"
  },
  {
    "text": "uh, the prices are p, right?",
    "start": "732040",
    "end": "734560"
  },
  {
    "text": "And so, you know that this is kind of- it's,",
    "start": "734560",
    "end": "736210"
  },
  {
    "text": "it's kind of clear intuitively how that might work.",
    "start": "736210",
    "end": "738730"
  },
  {
    "text": "Um, that for example,",
    "start": "738730",
    "end": "741084"
  },
  {
    "text": "as you increase the, the price, uh,",
    "start": "741085",
    "end": "744010"
  },
  {
    "text": "if you increase the price of some good,",
    "start": "744010",
    "end": "745825"
  },
  {
    "text": "then more people are gonna manufacture it or supply it,",
    "start": "745825",
    "end": "748855"
  },
  {
    "text": "and so the supply would go up.",
    "start": "748855",
    "end": "750595"
  },
  {
    "text": "Um, that's roughly the idea.",
    "start": "750595",
    "end": "752709"
  },
  {
    "text": "Um, we also had the demand.",
    "start": "752710",
    "end": "754870"
  },
  {
    "text": "Um, the demand will kinda go the other way.",
    "start": "754870",
    "end": "757180"
  },
  {
    "text": "Right? That if I have,",
    "start": "757180",
    "end": "758425"
  },
  {
    "text": "uh- if I have a demand function and I increase the supply of a good,",
    "start": "758425",
    "end": "763105"
  },
  {
    "text": "presumably, it's demand will go down.",
    "start": "763105",
    "end": "766014"
  },
  {
    "text": "Now we've already seen in the price",
    "start": "766015",
    "end": "767905"
  },
  {
    "text": "elasticity matrix the idea that when you put one- when you,",
    "start": "767905",
    "end": "771685"
  },
  {
    "text": "when you increase one price, um,",
    "start": "771685",
    "end": "774130"
  },
  {
    "text": "it could easily be, uh, that,",
    "start": "774130",
    "end": "777355"
  },
  {
    "text": "that the demand for other things,",
    "start": "777355",
    "end": "780220"
  },
  {
    "text": "other goods can either go up or go down.",
    "start": "780220",
    "end": "782740"
  },
  {
    "text": "Right? So depending on whether it's a substitute or something or a correlator.",
    "start": "782740",
    "end": "786910"
  },
  {
    "text": "I forget what they call it. Okay. Um, all right,",
    "start": "786910",
    "end": "789714"
  },
  {
    "text": "so back to our problem.",
    "start": "789715",
    "end": "791065"
  },
  {
    "text": "These are our functions,",
    "start": "791065",
    "end": "792850"
  },
  {
    "text": "the supply function and the demand function.",
    "start": "792850",
    "end": "795845"
  },
  {
    "text": "Um, and here's the goal,",
    "start": "795845",
    "end": "798660"
  },
  {
    "text": "find a set of prices for which the supply balances the demand. That's the idea.",
    "start": "798660",
    "end": "805315"
  },
  {
    "text": "Okay? So this is a,",
    "start": "805315",
    "end": "806740"
  },
  {
    "text": "a very classic problem.",
    "start": "806740",
    "end": "808735"
  },
  {
    "text": "And what we'll do is we'll take f of p to be S of p",
    "start": "808735",
    "end": "812154"
  },
  {
    "text": "minus D of p. That's the- I think some people call that the excess supply or something.",
    "start": "812155",
    "end": "816700"
  },
  {
    "text": "[NOISE] I don't remember.",
    "start": "816700",
    "end": "818500"
  },
  {
    "text": "Anyway, when that- when f of p is 0,",
    "start": "818500",
    "end": "821245"
  },
  {
    "text": "that means that the prices are such that the supply exactly balances the demand.",
    "start": "821245",
    "end": "827305"
  },
  {
    "text": "Okay? So that's the- that's called an equilibrium price.",
    "start": "827305",
    "end": "830290"
  },
  {
    "text": "A set- sorry, a set of equilibrium prices.",
    "start": "830290",
    "end": "832810"
  },
  {
    "text": "It's an equilibrium price vector.",
    "start": "832810",
    "end": "835060"
  },
  {
    "text": "Okay. So that's one example of solving nonlinear equations.",
    "start": "835060",
    "end": "839590"
  },
  {
    "text": "Um, I should add something that",
    "start": "839590",
    "end": "842650"
  },
  {
    "text": "if- if the supply and demand functions are both, are fine,",
    "start": "842650",
    "end": "846415"
  },
  {
    "text": "this is a set of linear equations and we can solve it, when- well,",
    "start": "846415",
    "end": "849670"
  },
  {
    "text": "we can solve it exactly in that case,",
    "start": "849670",
    "end": "851185"
  },
  {
    "text": "using the methods previously in the course.",
    "start": "851185",
    "end": "853495"
  },
  {
    "text": "Okay. Next example, um, which,",
    "start": "853495",
    "end": "857230"
  },
  {
    "text": "although on the face of it, looks radically different,",
    "start": "857230",
    "end": "859660"
  },
  {
    "text": "is actually kinda the same example, but here it is.",
    "start": "859660",
    "end": "862524"
  },
  {
    "text": "Um, so in chemical equilibrium,",
    "start": "862525",
    "end": "864625"
  },
  {
    "text": "what I have, uh,",
    "start": "864625",
    "end": "865795"
  },
  {
    "text": "is I have a bunch- I have an n vector of concentrations,",
    "start": "865795",
    "end": "869725"
  },
  {
    "text": "c of n different species, right?",
    "start": "869725",
    "end": "874810"
  },
  {
    "text": "So these can be species in,",
    "start": "874810",
    "end": "876835"
  },
  {
    "text": "in, in, in some chemical solution let's say.",
    "start": "876835",
    "end": "879085"
  },
  {
    "text": "Um, then what I have is this,",
    "start": "879085",
    "end": "881095"
  },
  {
    "text": "is I have, uh- if I have various reactions that both,",
    "start": "881095",
    "end": "884589"
  },
  {
    "text": "some reactions consume this species,",
    "start": "884590",
    "end": "886930"
  },
  {
    "text": "others generate additional species, right?",
    "start": "886930",
    "end": "891010"
  },
  {
    "text": "So these are the reactants and products.",
    "start": "891010",
    "end": "893095"
  },
  {
    "text": "And they are given by reaction rates,",
    "start": "893095",
    "end": "896394"
  },
  {
    "text": "and those are given this way.",
    "start": "896395",
    "end": "898015"
  },
  {
    "text": "So capital C of little c, that,",
    "start": "898015",
    "end": "900865"
  },
  {
    "text": "that tells you the consumption of the species as a function of the concentrations.",
    "start": "900865",
    "end": "905170"
  },
  {
    "text": "So that's, that's how that works.",
    "start": "905170",
    "end": "906940"
  },
  {
    "text": "So you know, usually if the concentration of a reactant goes up then it's,",
    "start": "906940",
    "end": "911935"
  },
  {
    "text": "it's gonna- it's gonna consume more- more",
    "start": "911935",
    "end": "914770"
  },
  {
    "text": "of it will be consumed because there's re- there's a reaction tha- that,",
    "start": "914770",
    "end": "917605"
  },
  {
    "text": "that, that, um, consumes it or something like that.",
    "start": "917605",
    "end": "921324"
  },
  {
    "text": "Um, now we also have G of c,",
    "start": "921325",
    "end": "923695"
  },
  {
    "text": "That's the generation of species.",
    "start": "923695",
    "end": "925330"
  },
  {
    "text": "These are essentially the reactant and products.",
    "start": "925330",
    "end": "927250"
  },
  {
    "text": "So that says that, as a function of the concentrations,",
    "start": "927250",
    "end": "930460"
  },
  {
    "text": "this tells you the rate at which the species are created, right?",
    "start": "930460",
    "end": "936220"
  },
  {
    "text": "And that means that there are- that,",
    "start": "936220",
    "end": "938139"
  },
  {
    "text": "that means what's the rate at which the reaction",
    "start": "938140",
    "end": "940660"
  },
  {
    "text": "in which these things are on the right-hand side,",
    "start": "940660",
    "end": "943569"
  },
  {
    "text": "uh, they are products not reactants.",
    "start": "943570",
    "end": "946220"
  },
  {
    "text": "Okay, so that's the idea.",
    "start": "946220",
    "end": "947910"
  },
  {
    "text": "[NOISE] And then- then what we'll",
    "start": "947910",
    "end": "950490"
  },
  {
    "text": "do is we'll take- what we'll do- would like to do is find me",
    "start": "950490",
    "end": "953640"
  },
  {
    "text": "concentrations of the species in this solution or whatever it is",
    "start": "953640",
    "end": "957910"
  },
  {
    "text": "so that the consumption is exactly equal to the generation.",
    "start": "957910",
    "end": "962470"
  },
  {
    "text": "And what that means is that the reactants,",
    "start": "962470",
    "end": "964855"
  },
  {
    "text": "um- reactants and products are balanced.",
    "start": "964855",
    "end": "966970"
  },
  {
    "text": "You may still have the- you will have chemical reactions going on,",
    "start": "966970",
    "end": "970435"
  },
  {
    "text": "but what will happen is at equilibrium,",
    "start": "970435",
    "end": "973495"
  },
  {
    "text": "uh, the amount of, you know,",
    "start": "973495",
    "end": "976089"
  },
  {
    "text": "whatever some hydrogen ion being consumed per second",
    "start": "976090",
    "end": "980125"
  },
  {
    "text": "is gonna exactly balance the amount of hydrogen ion being generated,",
    "start": "980125",
    "end": "984685"
  },
  {
    "text": "uh, as a product, uh,",
    "start": "984685",
    "end": "986425"
  },
  {
    "text": "every second, you know,",
    "start": "986425",
    "end": "988149"
  },
  {
    "text": "due to multiple reactions.",
    "start": "988150",
    "end": "989815"
  },
  {
    "text": "So that's the idea, that's,",
    "start": "989815",
    "end": "990985"
  },
  {
    "text": "that's referred to as a chemical equilibrium.",
    "start": "990985",
    "end": "993579"
  },
  {
    "text": "And you can- you know,",
    "start": "993580",
    "end": "995125"
  },
  {
    "text": "you can check how does that vary with external things that we're",
    "start": "995125",
    "end": "998380"
  },
  {
    "text": "not counting here like temperature or something like that, pressure.",
    "start": "998380",
    "end": "1001500"
  },
  {
    "text": "Okay? So and to- and to do that,",
    "start": "1001500",
    "end": "1003630"
  },
  {
    "text": "we'll set that up as f of c is equal to,",
    "start": "1003630",
    "end": "1007605"
  },
  {
    "text": "uh, the consumption minus the generation.",
    "start": "1007605",
    "end": "1010274"
  },
  {
    "text": "And so when f of c is 0,",
    "start": "1010275",
    "end": "1012885"
  },
  {
    "text": "that means you have chemical equilibrium. So that's the idea.",
    "start": "1012885",
    "end": "1015840"
  },
  {
    "text": "So these are just computing equilibrium points,",
    "start": "1015840",
    "end": "1017880"
  },
  {
    "text": "or generally nonlinear equations,",
    "start": "1017880",
    "end": "1020475"
  },
  {
    "text": "systems of nonlinear equations.",
    "start": "1020475",
    "end": "1022110"
  },
  {
    "text": "And by the way, very typically with an equal number,",
    "start": "1022110",
    "end": "1025064"
  },
  {
    "text": "uh, with m and n equal to each other.",
    "start": "1025065",
    "end": "1027480"
  },
  {
    "text": "So these are squ- typically square systems.",
    "start": "1027480",
    "end": "1031689"
  },
  {
    "text": "Another example. Now it comes- it comes up in a lot of areas,",
    "start": "1032030",
    "end": "1036630"
  },
  {
    "text": "but it's, it's, it's really part of GPS, Global Positioning System.",
    "start": "1036630",
    "end": "1040485"
  },
  {
    "text": "So here, um, I have a 3-vector x,",
    "start": "1040485",
    "end": "1043245"
  },
  {
    "text": "and that's a position in three-dimensions.",
    "start": "1043245",
    "end": "1045240"
  },
  {
    "text": "And our- your job is to estimate it,",
    "start": "1045240",
    "end": "1046964"
  },
  {
    "text": "like what is x.",
    "start": "1046965",
    "end": "1048404"
  },
  {
    "text": "And what we have is actually so-called range measurements.",
    "start": "1048405",
    "end": "1052455"
  },
  {
    "text": "So of course I'll draw in 2D,",
    "start": "1052455",
    "end": "1054120"
  },
  {
    "text": "but here's x and you might have a, a,",
    "start": "1054120",
    "end": "1057210"
  },
  {
    "text": "a beacon or something like that,",
    "start": "1057210",
    "end": "1059265"
  },
  {
    "text": "um, what- a satellite,",
    "start": "1059265",
    "end": "1061410"
  },
  {
    "text": "whatever you like, it's here.",
    "start": "1061410",
    "end": "1062955"
  },
  {
    "text": "And then what we measure is actually the distance.",
    "start": "1062955",
    "end": "1066375"
  },
  {
    "text": "So we measure the distance, right?",
    "start": "1066375",
    "end": "1067770"
  },
  {
    "text": "So here's a_1 and here's a_2, this point.",
    "start": "1067770",
    "end": "1071145"
  },
  {
    "text": "And so what we know is the distance.",
    "start": "1071145",
    "end": "1073635"
  },
  {
    "text": "Now, then the question is,",
    "start": "1073635",
    "end": "1075780"
  },
  {
    "text": "given a set of distances, oh,",
    "start": "1075780",
    "end": "1077790"
  },
  {
    "text": "and I should say, we get the distance but with a noise.",
    "start": "1077790",
    "end": "1081165"
  },
  {
    "text": "So Vi is a- is a noise that we- we don't know.",
    "start": "1081165",
    "end": "1084975"
  },
  {
    "text": "And it's just measurement error.",
    "start": "1084975",
    "end": "1086865"
  },
  {
    "text": "Okay. And so the idea is from these distance measurements,",
    "start": "1086865",
    "end": "1090660"
  },
  {
    "text": "they're called range measurements, right?",
    "start": "1090660",
    "end": "1092280"
  },
  {
    "text": "Because the range is like the distance from you to some target or",
    "start": "1092280",
    "end": "1095580"
  },
  {
    "text": "from you to some beacon or something like that.",
    "start": "1095580",
    "end": "1099465"
  },
  {
    "text": "Um, so given these noisy range measurements,",
    "start": "1099465",
    "end": "1101985"
  },
  {
    "text": "your job is to figure out what x is.",
    "start": "1101985",
    "end": "1104850"
  },
  {
    "text": "Okay. Um, now what least squares- least squares",
    "start": "1104850",
    "end": "1109230"
  },
  {
    "text": "location estimation does is it says I- these things here are essentially,",
    "start": "1109230",
    "end": "1114450"
  },
  {
    "text": "this is, is gonna sum them- we're going to minimize this sum of Vi squared.",
    "start": "1114450",
    "end": "1118950"
  },
  {
    "text": "Okay? And this is just- so this is the, the,",
    "start": "1118950",
    "end": "1122669"
  },
  {
    "text": "uh- so what we're gonna do here is we're going to choose x to minimize this.",
    "start": "1122670",
    "end": "1126300"
  },
  {
    "text": "Rho i is the measured range or distance.",
    "start": "1126300",
    "end": "1129870"
  },
  {
    "text": "And this is of course a function of x. Um,",
    "start": "1129870",
    "end": "1134145"
  },
  {
    "text": "it is definitely not affine.",
    "start": "1134145",
    "end": "1136680"
  },
  {
    "text": "And we'll wanna minimize this.",
    "start": "1136680",
    "end": "1138420"
  },
  {
    "text": "And that is- that is a set- that is a nonlinear least squares.",
    "start": "1138420",
    "end": "1142020"
  },
  {
    "text": "Uh, that's nonlinear least squares, right?",
    "start": "1142020",
    "end": "1144570"
  },
  {
    "text": "And a variation on this actually is kind of what's used in,",
    "start": "1144570",
    "end": "1147705"
  },
  {
    "text": "in GPS, the Global Positioning System.",
    "start": "1147705",
    "end": "1149789"
  },
  {
    "text": "Um, there- there's one, a",
    "start": "1149790",
    "end": "1151770"
  },
  {
    "text": "couple of tricks in GPS or variations on this- this that are not in my formulation here.",
    "start": "1151770",
    "end": "1159210"
  },
  {
    "text": "Um, what is this?",
    "start": "1159210",
    "end": "1160830"
  },
  {
    "text": "Is that, in addition,",
    "start": "1160830",
    "end": "1162705"
  },
  {
    "text": "um, when you get your distance to a satellite,",
    "start": "1162705",
    "end": "1165090"
  },
  {
    "text": "there's an additional offset term which depends on your, uh,",
    "start": "1165090",
    "end": "1168929"
  },
  {
    "text": "your- how- how far your clock is from the true clock, right?",
    "start": "1168930",
    "end": "1173040"
  },
  {
    "text": "So unless you happen to have an atomic clock with you, very few people do.",
    "start": "1173040",
    "end": "1176895"
  },
  {
    "text": "Uh, so there's an additional variable there,",
    "start": "1176895",
    "end": "1179460"
  },
  {
    "text": "but otherwise it's basically this.",
    "start": "1179460",
    "end": "1181485"
  },
  {
    "text": "And in fact, this is kind of what's used for GPS.",
    "start": "1181485",
    "end": "1184604"
  },
  {
    "text": "Actually, really what's used for GPS is it's a combination of this and the",
    "start": "1184604",
    "end": "1188460"
  },
  {
    "text": "Kalman filtering or state estimation that we looked at in the previous lecture.",
    "start": "1188460",
    "end": "1192659"
  },
  {
    "text": "Um, but this is the essential idea.",
    "start": "1192660",
    "end": "1195790"
  }
]