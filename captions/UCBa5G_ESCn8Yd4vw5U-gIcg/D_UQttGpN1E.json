[
  {
    "start": "0",
    "end": "11010"
  },
  {
    "text": "So yeah. As Marco said today, I'm\ngoing to be talking about some of our latest work on\narchitecting next generation",
    "start": "11010",
    "end": "16560"
  },
  {
    "text": "autonomous vehicle\nautonomy stacks. And here we're really\nfocusing on developing",
    "start": "16560",
    "end": "22410"
  },
  {
    "text": "the next generation\nof AV autonomy stacks. And to understand why we\nneed a next generation, let's talk a little bit about\nwhat the classical architecture",
    "start": "22410",
    "end": "30420"
  },
  {
    "text": "for autonomy stacks look like. So typically, they look\nsomething like this. They're very highly modular.",
    "start": "30420",
    "end": "36570"
  },
  {
    "text": "And you typically\nhave key components for detection, tracking,\nprediction, planning,",
    "start": "36570",
    "end": "41760"
  },
  {
    "text": "and control. And this is the\ntypical structure that's taught, for\nexample, to students here or around at other\nuniversities and that many AV",
    "start": "41760",
    "end": "49649"
  },
  {
    "text": "companies adopt. So some key advantages here\nare that you can interpret what",
    "start": "49650",
    "end": "55110"
  },
  {
    "text": "these modules are outputting. You can develop\nthem independently. However, there are\ninformation bottlenecks",
    "start": "55110",
    "end": "61352"
  },
  {
    "text": "between each of these components\nso you might have a performance ceiling based on the information\nthat you can actually pass",
    "start": "61352",
    "end": "66780"
  },
  {
    "text": "from upstream to downstream. Now, on the other hand,\nkind of a recent advancement",
    "start": "66780",
    "end": "72370"
  },
  {
    "text": "has also been looking at\nend to end architectures where, typically, you're trying\nto connect perception directly",
    "start": "72370",
    "end": "78250"
  },
  {
    "text": "to control through\nlike a neural network or a few neural networks. And you're only really\nimplicitly encoding",
    "start": "78250",
    "end": "85540"
  },
  {
    "text": "key capabilities like agent\nprediction, or detection, or tracking. Now some key advantages\nare that you might actually",
    "start": "85540",
    "end": "92680"
  },
  {
    "text": "have a higher performance\nceiling because now there's no information bottlenecks. However, you also don't know\nif you can guarantee safety",
    "start": "92680",
    "end": "101080"
  },
  {
    "text": "because you typically\ncan't analyze are you detecting all the objects. Are you able to track\nthem through time? Are you able to actually\nsafely avoid them?",
    "start": "101080",
    "end": "107492"
  },
  {
    "text": " So there are some difficulties\nabout making formal safety",
    "start": "107492",
    "end": "113230"
  },
  {
    "text": "claims as compared to maybe\nmodular autonomy stacks. So given the current\nstate of things,",
    "start": "113230",
    "end": "118530"
  },
  {
    "text": "a natural question is\nwhether we can maybe design something that takes\nthe best of both worlds without maybe having too\nmuch of the detriments.",
    "start": "118530",
    "end": "125229"
  },
  {
    "text": "And in particular, if we\nview these architectures on a spectrum, what would\nsomething in the middle look",
    "start": "125230",
    "end": "131410"
  },
  {
    "text": "like? And so this is\nactually part of what I'll talk about today,\nwhich is I'll be going over",
    "start": "131410",
    "end": "137200"
  },
  {
    "text": "some of our latest\nwork on designing modular and differentiable\nautonomy stacks which combine",
    "start": "137200",
    "end": "142510"
  },
  {
    "text": "the reusability and\ninterpretability of the modularity stack but\nalso with the theoretical higher",
    "start": "142510",
    "end": "147910"
  },
  {
    "text": "performance ceiling of\nend-to-end AV architectures. Now the other\nnecessary innovation",
    "start": "147910",
    "end": "154270"
  },
  {
    "text": "in order to actually develop\nnewer architectures like this is in the surrounding\ninfrastructure.",
    "start": "154270",
    "end": "159790"
  },
  {
    "text": "So in particular,\nI'll also talk later in the talk about some of our\nlatest work on simulation,",
    "start": "159790",
    "end": "166030"
  },
  {
    "text": "leveraging data for\nbetter behavior. And I'll show some of our really\nlatest, latest, latest work",
    "start": "166030",
    "end": "171250"
  },
  {
    "text": "that we just submitted a couple\nof weeks ago in this direction as well. So this is actually exactly\nwhat I'll talk about today.",
    "start": "171250",
    "end": "178750"
  },
  {
    "text": "So I'll first talk\nabout some methods for how to expand the flow of\ninformation between the modules",
    "start": "178750",
    "end": "188500"
  },
  {
    "text": "in the autonomy stack. I'll talk about how we can\noptimize some components directly for downstream\nperformance because of enabling",
    "start": "188500",
    "end": "195280"
  },
  {
    "text": "modular differentiability. And then lastly, I'll talk about\nleveraging data for simulation and some of our latest work on\ngenerating realistic humanlike",
    "start": "195280",
    "end": "204040"
  },
  {
    "text": "traffic. So without further ado, I want\nto focus the first part here",
    "start": "204040",
    "end": "209540"
  },
  {
    "text": "on talking about how we can\ncombine three typically learned modules-- detection, tracking,\nand prediction--",
    "start": "209540",
    "end": "215810"
  },
  {
    "text": "to enable better performance. So typically, when we want to\nremove information bottlenecks",
    "start": "215810",
    "end": "221510"
  },
  {
    "text": "in the AV stack, it very quickly\nbecomes a question of robustness because all of these\ncomponents produce uncertainty,",
    "start": "221510",
    "end": "229877"
  },
  {
    "text": "or at least they're not\ngoing to be perfect. You're going to have errors. You're going to have\nsomething that you need to take into account.",
    "start": "229877",
    "end": "235220"
  },
  {
    "text": "And so there are many sources\nin the uncertainty stack. And the running example I'm\ngoing to show here first",
    "start": "235220",
    "end": "240950"
  },
  {
    "text": "is in detection where you\nmight have probabilities about what class\nan object is or you",
    "start": "240950",
    "end": "247220"
  },
  {
    "text": "might have uncertainty about\nwhere it's located in the image. And I guess it's hard maybe\nto see if you're sitting here",
    "start": "247220",
    "end": "253878"
  },
  {
    "text": "but there's kind of a lot\nof these probabilities, they fluctuate and you\nhave these kind of classes that switch over time.",
    "start": "253878",
    "end": "259430"
  },
  {
    "text": "But as you can imagine,\nthis uncertainty is going to affect\ntracking, which is going to affect\nprediction, which",
    "start": "259430",
    "end": "265620"
  },
  {
    "text": "is going to affect\nplanning, which is going to affect how your\nvehicle moves in the world. And so all of this is\nactually really interconnected",
    "start": "265620",
    "end": "272250"
  },
  {
    "text": "whether you want\nit to be or not. And so our group has\ndone quite a lot of work",
    "start": "272250",
    "end": "278669"
  },
  {
    "text": "in trying to analyze\nsome of this uncertainty and explicitly incorporate\nit in different modules",
    "start": "278670",
    "end": "286260"
  },
  {
    "text": "here in the stack. But today, in\nparticular, I'm going to focus on this connection\nbetween tracking and prediction.",
    "start": "286260",
    "end": "293700"
  },
  {
    "text": "And I'm going to focus on how we\ncan make prediction models that are robust to the\nkinds of errors that you typically\nsee in tracking.",
    "start": "293700",
    "end": "300389"
  },
  {
    "text": "And in particular, I'll talk\nabout the most common kinds which are fragmentation\nand ID switching. And I'll show some examples\nof what those look like.",
    "start": "300390",
    "end": "307800"
  },
  {
    "text": "So in this video, we can see\nwhat some of the tracking errors look like in the wild where,\nbasically, an ID switch is kind",
    "start": "307800",
    "end": "315930"
  },
  {
    "text": "of like if you have two vehicles\nin the real world that maybe come very close to each other\nor one obscures the other,",
    "start": "315930",
    "end": "322800"
  },
  {
    "text": "then your tracking system might\nthink, ah, these two vehicles, they didn't just continue\nstraight past each other.",
    "start": "322800",
    "end": "328950"
  },
  {
    "text": "Turned around and went\nlike this because, again, they look maybe the same. They're passing in\nfront of each other. They're very close.",
    "start": "328950",
    "end": "334572"
  },
  {
    "text": "It's very easy to get confused. Another kind of problem\nis called fragmentation where you have, let's say\nagain, another vehicle",
    "start": "334572",
    "end": "341280"
  },
  {
    "text": "passing in front of the other. And you say, OK, the\nvehicle that was occluded, it's now not the same vehicle\nthat you observe later.",
    "start": "341280",
    "end": "348509"
  },
  {
    "text": "You give it a new ID because,\nhey, I saw one vehicle, then I didn't see anything,\nand then I saw another vehicle.",
    "start": "348510",
    "end": "353910"
  },
  {
    "text": "And so this is typically\ncalled fragmentation. So these two problems are very\ncommon in multiobject tracking.",
    "start": "353910",
    "end": "362430"
  },
  {
    "text": "And it's not just that\nthey're common in tracking. They're extraordinarily\ndetrimental in prediction",
    "start": "362430",
    "end": "369743"
  },
  {
    "text": "because, in\nprediction, you really rely on these\ntracked trajectories to develop an understanding\nof dynamics, of motion",
    "start": "369743",
    "end": "376290"
  },
  {
    "text": "of these objects. So to give an illustration\nhere, on the top left, we have an object that\nwas tracked perfectly.",
    "start": "376290",
    "end": "383039"
  },
  {
    "text": "It's a car that's turning left. And we can see that the\nresulting yellow predictions, they're more or less reasonable.",
    "start": "383040",
    "end": "389040"
  },
  {
    "text": "They're continuing\ntowards the left. They're kind of\nstaying on the road. I know it's tough to see that\nthis is a road here because I'm",
    "start": "389040",
    "end": "394702"
  },
  {
    "text": "kind of visualizing the lidar\noutputs but that's my bad. But you can see that the\npredictions look reasonable.",
    "start": "394702",
    "end": "402240"
  },
  {
    "text": "When we have a tracking error\nhere and we have an ID switch, you can see that\nnow we have let's",
    "start": "402240",
    "end": "408419"
  },
  {
    "text": "say like a false\npositive detection that causes your tracker to\nthink this vehicle now",
    "start": "408420",
    "end": "414120"
  },
  {
    "text": "moved up suddenly. It has an errant acceleration. And as you can see,\nthe predictions are now off the screen.",
    "start": "414120",
    "end": "420530"
  },
  {
    "text": "They're useless. And actually, when you evaluate\nthis quantitatively over",
    "start": "420530",
    "end": "426659"
  },
  {
    "text": "like an autonomous\ndriving data set, you can see that these kinds\nof tracking errors, they significantly increase the\npresence of prediction errors.",
    "start": "426660",
    "end": "434550"
  },
  {
    "text": "And they can really make\nyour lovely predictor that you train on\nground truth data completely unusable\nin the real world",
    "start": "434550",
    "end": "441000"
  },
  {
    "text": "with errors that are so high. So to remedy this, what we\nasked in the group was, OK,",
    "start": "441000",
    "end": "448260"
  },
  {
    "text": "the hard part here is\nthat tracking typically needs to make a hard decision\nof which detection is mapped",
    "start": "448260",
    "end": "455910"
  },
  {
    "text": "to which previous track. And the question we had was,\nOK, this hard choice really",
    "start": "455910",
    "end": "463065"
  },
  {
    "text": "loses a lot of\ndata because there could be a lot of\nuncertainty that you just have to say, OK, if it's 51%,\n49%, I just have to take the 51%",
    "start": "463065",
    "end": "469240"
  },
  {
    "text": "and you're neglecting\nall of this uncertainty. So we asked, OK, can we\nremove these hard associations",
    "start": "469240",
    "end": "475840"
  },
  {
    "text": "that need to be made? And can we instead pass\nall of this information to your downstream predictor\nwhich I here draw as",
    "start": "475840",
    "end": "482620"
  },
  {
    "text": "like a transformer-based model? So this is actually the\nexact idea that we evaluated.",
    "start": "482620",
    "end": "488590"
  },
  {
    "text": "And rather than\njust directly taking all the previous detections,\nwe took the previous detections as well as their\nsimilarities over time.",
    "start": "488590",
    "end": "495717"
  },
  {
    "text": "So when I say here\nsimilarity, I mean, for example, visual\nsimilarity or the how close they are in\nframe by frame in space.",
    "start": "495717",
    "end": "503889"
  },
  {
    "text": "And how similar an object\nis from frame to frame, we call that affinity.",
    "start": "503890",
    "end": "508930"
  },
  {
    "text": "This is a term that you might\nhear in computer vision a lot. And so we take this\naffinity information as well",
    "start": "508930",
    "end": "514039"
  },
  {
    "text": "and directly structure it inside\nthe transformer's attention",
    "start": "514039",
    "end": "519729"
  },
  {
    "text": "where we're trying to attend\none set of objects in one frame",
    "start": "519730",
    "end": "525279"
  },
  {
    "text": "to sets of objects\nin previous frames. And when we take this\nsoft information now",
    "start": "525280",
    "end": "531459"
  },
  {
    "text": "rather than making\na hard choice, we can actually reduce the\npresence of prediction errors",
    "start": "531460",
    "end": "537100"
  },
  {
    "text": "in these cases where there are\ntracking errors by, what is it, up to 80% here. So now finally, we\ncan actually start",
    "start": "537100",
    "end": "543820"
  },
  {
    "text": "to harness some of\nthis uncertainty and not get demolished\nwhen we have these errors.",
    "start": "543820",
    "end": "549310"
  },
  {
    "text": "And to show an example of what\nthis looks like, on the left here, I have the\nstandard pipeline where you have decomposed system\nof tracking and then prediction.",
    "start": "549310",
    "end": "556540"
  },
  {
    "text": "And what you can see is you see\nthese are all parked cars here. But you can see\nthat when there's like this errant\nassociations, there's",
    "start": "556540",
    "end": "564070"
  },
  {
    "text": "like predictions that are being\nmade for these parked vehicles to move, which is problematic\nif you're going to try and pass",
    "start": "564070",
    "end": "569890"
  },
  {
    "text": "next to them, whereas on the\nright with these same detection",
    "start": "569890",
    "end": "574900"
  },
  {
    "text": "errors, we don't have any of\nthese same predictions being made. We don't have any of\nthese errant predictions for parked cars.",
    "start": "574900",
    "end": "580690"
  },
  {
    "start": "580690",
    "end": "585890"
  },
  {
    "text": "So when you say you changed\nit from a hard decision to a soft decision,\nessentially what you did is you had the model implicitly\nfigured out how to track.",
    "start": "585890",
    "end": "593180"
  },
  {
    "text": "Exactly correct. That's exactly correct. Yeah. In case the question\nwasn't heard,",
    "start": "593180",
    "end": "598728"
  },
  {
    "text": "by switching from hard\ndecision to soft decision, it's basically tasking the model\nwith doing tracking implicitly",
    "start": "598728",
    "end": "604490"
  },
  {
    "text": "under the hood.  Perfect.",
    "start": "604490",
    "end": "609580"
  },
  {
    "text": "So moving on looking a\nlittle bit more downstream, the next thing that\nwe wanted to look at",
    "start": "609580",
    "end": "616029"
  },
  {
    "text": "was, so OK, maybe this\nwasn't so surprising because at least detection,\ntracking, and prediction, a lot",
    "start": "616030",
    "end": "622223"
  },
  {
    "text": "of those are learned components\nso it's actually very easy to connect things without maybe\nlosing too much information. I know tracking\nwasn't learned here",
    "start": "622223",
    "end": "628900"
  },
  {
    "text": "but we found a nice way\nto bypass it and have the model implicitly encoded. What about when\nwe look downstream",
    "start": "628900",
    "end": "635290"
  },
  {
    "text": "at prediction, planning, and\ncontrol, which typically have a mixture of learning\nbased components",
    "start": "635290",
    "end": "641320"
  },
  {
    "text": "and handcrafted components? And traditionally here,\nprediction, for example,",
    "start": "641320",
    "end": "647709"
  },
  {
    "text": "is typically a neural network. So you know, I'm going\nto go with a running example of some specific\nprediction network",
    "start": "647710",
    "end": "654519"
  },
  {
    "text": "but, typically,\nit's learning based. And then we have a\nplanner and a controller which are typically handcrafted,\nhand-designed, hand-engineered",
    "start": "654520",
    "end": "661660"
  },
  {
    "text": "for let's say the\nspecific vehicle that you want to control or\nthe specific design domain that you have in mind.",
    "start": "661660",
    "end": "667960"
  },
  {
    "text": "And so the question here is how\ncan we actually combine these and maybe enable\ndifferentiability",
    "start": "667960",
    "end": "675170"
  },
  {
    "text": "throughout all of these modules\nso that the actual final goal of driving behavior can\ninfluence how the prediction",
    "start": "675170",
    "end": "682610"
  },
  {
    "text": "model learns. So in a traditional\nsystem, typically, the only component\nthat's learned",
    "start": "682610",
    "end": "689360"
  },
  {
    "text": "is your prediction model. And your prediction\nmodel is tasked with estimating what will\nhappen in the future for all",
    "start": "689360",
    "end": "694520"
  },
  {
    "text": "the agents around you. And then you use that\ninformation in a planner. So in this running example,\nthe planner that we use",
    "start": "694520",
    "end": "700100"
  },
  {
    "text": "is a very simple\nsampling-based planner. You sample some\namount of candidates and then you evaluate them\nusing a cost function,",
    "start": "700100",
    "end": "707029"
  },
  {
    "text": "taking into account your\npredictions so you could say, OK, I want to\nsample the one that has the lowest chance of\ncolliding as an example.",
    "start": "707030",
    "end": "713930"
  },
  {
    "text": "And then you'll take\nthe lowest cost plan. You'll pass that\ninto a controller.",
    "start": "713930",
    "end": "719870"
  },
  {
    "text": "It'll apply a little\nbit of dynamic smoothing and then you can just drive on. So this is like a very\nsimple but typical",
    "start": "719870",
    "end": "727460"
  },
  {
    "text": "prediction-planning-control\nstack. What we wanted to\nlook at in this work was making those two end\ncomponents differentiable.",
    "start": "727460",
    "end": "736233"
  },
  {
    "text": "And in particular,\nthe way that we did this was, for the\ncontroller, we used prior work.",
    "start": "736233",
    "end": "741460"
  },
  {
    "text": "There exists quite a\nlot of work on making MPC and other\noptimization algorithms like it differentiable.",
    "start": "741460",
    "end": "748480"
  },
  {
    "text": "And then we also made that\nsimple sampling-based planning algorithm differentiable by\nswitching from just ranking",
    "start": "748480",
    "end": "757060"
  },
  {
    "text": "these sample trajectories\nby a cost function, and we change it to more like a\nclassification algorithm where",
    "start": "757060",
    "end": "763690"
  },
  {
    "text": "you still have these\nsample trajectories, but now you have a model that's\nclassifying which of these is most likely to be the best.",
    "start": "763690",
    "end": "769542"
  },
  {
    "text": "Because then, at least, now\nyou have that differentiability in mind rather than having to\npick like an arg max or an arg",
    "start": "769542",
    "end": "774970"
  },
  {
    "text": "min, I guess, in\nthis case, which is nondifferentiable for planning. And so the key thing\nhere-- like I said,",
    "start": "774970",
    "end": "783160"
  },
  {
    "text": "the key thing here connecting\nus back to our original goal was to enable downstream\ntask losses and gradients",
    "start": "783160",
    "end": "792829"
  },
  {
    "text": "to propagate all the way\nthrough these modules and inform how we\ntrain our prediction module, or at least prediction\nand maybe anything upstream.",
    "start": "792830",
    "end": "801949"
  },
  {
    "text": "And so the way that we trained\nour model was basically we",
    "start": "801950",
    "end": "807380"
  },
  {
    "text": "have some data set\nthat we're using, some public open source\nautonomous vehicle data set.",
    "start": "807380",
    "end": "813890"
  },
  {
    "text": "And what we do is we add costs\nfor each of these components to train them. We need to train that\nclassification module",
    "start": "813890",
    "end": "822110"
  },
  {
    "text": "in the planner. We don't have to train\nanything in the controller but we at least can evaluate\nthe overall performance of the output trajectory by\ncomputing like a hindsight cost.",
    "start": "822110",
    "end": "830900"
  },
  {
    "text": "So hindsight costs\nhere basically means how different is\nthe control that you enacted compared to if you had\nperfect knowledge of the world.",
    "start": "830900",
    "end": "838950"
  },
  {
    "text": "So at least you have\na sense of maybe what the best\npossible performance is compared to what you did. And that's kind of what we\nuse as like downstream final",
    "start": "838950",
    "end": "846050"
  },
  {
    "text": "performance measurement. And then basically, we trained\nthese different components.",
    "start": "846050",
    "end": "854003"
  },
  {
    "text": "So we kind of trained\neach of them separately. And then we had a final round\nof passing all the gradients through and training each\nof the modules all together.",
    "start": "854003",
    "end": "862970"
  },
  {
    "text": "And what we found\nwas that, compared to the traditional stack where\nyou have the decomposed system,",
    "start": "862970",
    "end": "870980"
  },
  {
    "text": "what's funny is actually\nthe prediction performance was more or less the same.",
    "start": "870980",
    "end": "876200"
  },
  {
    "text": "So in terms of like\nthe actual if you just measure the prediction output,\nnothing really changed.",
    "start": "876200",
    "end": "883459"
  },
  {
    "text": "But the planning performance\nsignificantly improved. And what this basically means--\nand so here the hindsight reward",
    "start": "883460",
    "end": "890420"
  },
  {
    "text": "is basically how close\nare you to optimal? So to that perfect trajectory,\nif you had perfect information--",
    "start": "890420",
    "end": "895820"
  },
  {
    "text": "so here the plan with\nour differentiable stack was 83% of the reward\nof this perfect plan,",
    "start": "895820",
    "end": "903380"
  },
  {
    "text": "or at least the\nall-knowing plan, whereas the other standard\nmodule stack was only 71% of the way there.",
    "start": "903380",
    "end": "908640"
  },
  {
    "text": "And so what you're\nable to see here is that although the\nkind of average accuracy",
    "start": "908640",
    "end": "915029"
  },
  {
    "text": "of the predictor didn't\nchange at all, where it made errors did change.",
    "start": "915030",
    "end": "920130"
  },
  {
    "text": "So now what we were\nable to do was basically learn a prediction module that\nwas more useful for planning.",
    "start": "920130",
    "end": "927690"
  },
  {
    "text": "So rather than just making kind\nof uniformly distributed errors all across the scene,\nit learned, for example,",
    "start": "927690",
    "end": "933209"
  },
  {
    "text": "to care a little bit less about\nobjects that are 80 meters away or a little bit\nless about objects that are turning completely\naway from us that will never",
    "start": "933210",
    "end": "939863"
  },
  {
    "text": "be able to turn back and\ninfluence the vehicle's behavior. ",
    "start": "939863",
    "end": "947280"
  },
  {
    "text": "I see a question back there. How do you know that it\nwas that the places where the errors changed, like that's\nthe reason why you [INAUDIBLE]??",
    "start": "947280",
    "end": "954810"
  },
  {
    "text": "Couldn't it also be\njust that the planner-- the calibration between the\npredictions and the planner,",
    "start": "954810",
    "end": "960660"
  },
  {
    "text": "they kind of match because\nyou're training both of them in parallel? Yeah. It's a good question. So the first thing\nis we visualize.",
    "start": "960660",
    "end": "966390"
  },
  {
    "text": "We have visualization\nso that helps. But actually, the\nsecond thing you said is also an important point.",
    "start": "966390",
    "end": "972990"
  },
  {
    "text": "Maybe the calibration is better. Maybe the uncertainties\nare better. I don't have numbers for you. So I don't have like I can\nsay one thing definitively.",
    "start": "972990",
    "end": "980670"
  },
  {
    "text": "But at least towards\nsuch an approach like this, I think that's only\na benefit if you can actually align the output of uncertainty\nwith the use of uncertainty.",
    "start": "980670",
    "end": "989160"
  },
  {
    "text": " Yeah. Thank you for the question. ",
    "start": "989160",
    "end": "996087"
  },
  {
    "text": "Are there any other\nquestions before I move on to the topic of\nevaluation and simulation? ",
    "start": "996087",
    "end": "1004170"
  },
  {
    "text": "Perfect. So the final broad\ntopic that I'll discuss is let's say that we\nhave a fantastic stack.",
    "start": "1004170",
    "end": "1014495"
  },
  {
    "text": "And it's differentiable,\nand modular, and whatever. It's perfect. And we're really happy. How can we actually be certain\nthat this thing is really",
    "start": "1014495",
    "end": "1021600"
  },
  {
    "text": "as good as we think it is before\nwe actually want to deploy it in the real world where\nit kind of matters",
    "start": "1021600",
    "end": "1027059"
  },
  {
    "text": "how good your plans are? So simulation is, in\nmany ways, the holy grail",
    "start": "1027060",
    "end": "1034470"
  },
  {
    "text": "to scaling up the verification\nand validation of autonomy stacks.",
    "start": "1034470",
    "end": "1039930"
  },
  {
    "text": "And indeed in the\npast few decades, we've seen the autonomous\nvehicle research community has",
    "start": "1039930",
    "end": "1045180"
  },
  {
    "text": "made tremendous progress in\ndeveloping tons of simulators with very strong--",
    "start": "1045180",
    "end": "1050730"
  },
  {
    "text": "I mean earlier on it\nwas very strong dynamic and kinematic\nmodeling performance, but now we have simulators\nthat can photorealistically",
    "start": "1050730",
    "end": "1059220"
  },
  {
    "text": "render an environment so you can\nnow even test your perception stack as well in the mix.",
    "start": "1059220",
    "end": "1067059"
  },
  {
    "text": "However, even with all\nthese fantastic simulators, it's still difficult to actually\njust directly apply them",
    "start": "1067060",
    "end": "1075730"
  },
  {
    "text": "to the task that we have\nat hand of really fully evaluating an autonomy stack. And that's because, arguably,\nthe key missing piece",
    "start": "1075730",
    "end": "1083050"
  },
  {
    "text": "is that the behaviors of other\nsimulated agents such as cars and pedestrians in\nurban environments",
    "start": "1083050",
    "end": "1089410"
  },
  {
    "text": "are still controlled by very\nsimple logic or very simple, differentiable\nwhat's it called--",
    "start": "1089410",
    "end": "1096820"
  },
  {
    "text": "differential equation type\nmodel, like state space models. But unfortunately, real\nworld driving behaviors",
    "start": "1096820",
    "end": "1102310"
  },
  {
    "text": "are much more complex\nthan these simple models. And so to truly create a\nrealistic driving simulation",
    "start": "1102310",
    "end": "1108453"
  },
  {
    "text": "where you can\nactually harness all of these photorealistic\nelements, we need to build\nintelligent agents",
    "start": "1108453",
    "end": "1114160"
  },
  {
    "text": "as well so that we can generate\nrealistic, humanlike driving behaviors around the\n[? eagle ?] vehicle.",
    "start": "1114160",
    "end": "1120280"
  },
  {
    "text": "So concretely, we've identified\nhere four key desiderata for simulation--",
    "start": "1120280",
    "end": "1126070"
  },
  {
    "text": "for traffic models to be\nuseful for simulation. So the first is probably\nobviously fidelity,",
    "start": "1126070",
    "end": "1132940"
  },
  {
    "text": "which is can we actually\nsynthesize agent behaviors that are realistic and faithful\nto how humans drive",
    "start": "1132940",
    "end": "1139300"
  },
  {
    "text": "in the real world; diversity-- can we generate a wide range\nof realistic traffic behaviors",
    "start": "1139300",
    "end": "1145809"
  },
  {
    "text": "because it's not just, if\nyou're at an intersection, there's not just\none way that traffic could move through\nthat intersection",
    "start": "1145810",
    "end": "1151899"
  },
  {
    "text": "or through whatever environment. There's multiple possible ways\nthat are more or less equally likely.",
    "start": "1151900",
    "end": "1158379"
  },
  {
    "text": "The third is controllability. So we don't just\nwant to generate tons of varying types of scenarios.",
    "start": "1158380",
    "end": "1167020"
  },
  {
    "text": "We want to actually\nsteer these simulations to the kinds of\nscenarios we care about. Maybe we want to\nspecifically evaluate",
    "start": "1167020",
    "end": "1173320"
  },
  {
    "text": "a left turn, or an\nunpredicted left turn, or some kind of strange right\nturn scenario with weird road",
    "start": "1173320",
    "end": "1181750"
  },
  {
    "text": "geometry. So we actually need to\nbe able to also steer these models to\ngive us behaviors that we're particularly\nlooking for.",
    "start": "1181750",
    "end": "1189070"
  },
  {
    "text": "And then lastly is a bit more\nof a broader goal of adaptivity.",
    "start": "1189070",
    "end": "1194529"
  },
  {
    "text": "So typically, a\nlot of the models that we'll be training to\ngenerate realistic behaviors,",
    "start": "1194530",
    "end": "1200625"
  },
  {
    "text": "we'll be training them from\nspecific data sets that were captured in take your\npick of cities in the US",
    "start": "1200625",
    "end": "1206560"
  },
  {
    "text": "or around the world. The problem is the whole\npromise of simulation is that we can simulate\nanything or theoretically we",
    "start": "1206560",
    "end": "1212380"
  },
  {
    "text": "want to simulate anything. And so if I have a model that's\ntrained in data from Boston, New York City, Singapore,\nor whatever,",
    "start": "1212380",
    "end": "1218410"
  },
  {
    "text": "what happens when I move it now\nto San Francisco, or Seattle, or Toronto, or whatever?",
    "start": "1218410",
    "end": "1224650"
  },
  {
    "text": "We need to be able to\nactually adapt these models to new regions and\nhopefully without having to collect a ton of data or do\na ton of hand-engineered fine",
    "start": "1224650",
    "end": "1231730"
  },
  {
    "text": "tuning because that's\nnot really scalable.  Now along the way, we'll talk\nabout some of the challenges",
    "start": "1231730",
    "end": "1238210"
  },
  {
    "text": "that you run into and maybe\nsome ways to solve them, but the first typical\nchallenge is stability.",
    "start": "1238210",
    "end": "1243460"
  },
  {
    "text": "So how do you actually\nprevent your simulation from leaving nice,\nsmooth driving behaviors?",
    "start": "1243460",
    "end": "1250570"
  },
  {
    "text": "And this typically happens\nwhen you have longer horizon simulations where maybe you've\ntrained your models to only",
    "start": "1250570",
    "end": "1256840"
  },
  {
    "text": "predict motion for, at\nmost, five or 10 seconds but now you're simulating for\npotentially a minute or longer",
    "start": "1256840",
    "end": "1264100"
  },
  {
    "text": "if some scenarios need it? So we'll talk about\nsome of these challenges",
    "start": "1264100",
    "end": "1269560"
  },
  {
    "text": "as we get to them. But I want to start-- and also, unfortunately,\ndue to lack of time,",
    "start": "1269560",
    "end": "1276490"
  },
  {
    "text": "I won't talk about\nadaptivity today but we do have work on\nthis so, by all means, check out some of the links\nI'll put up at the end",
    "start": "1276490",
    "end": "1282413"
  },
  {
    "text": "and you'll see some\nof our work there. Now as I've shown in some\nof the previous slides,",
    "start": "1282413",
    "end": "1287980"
  },
  {
    "text": "we definitely have\nthe capability to model human\nbehavior because we're",
    "start": "1287980",
    "end": "1293050"
  },
  {
    "text": "learning it in\nthe car to predict the motion of other vehicles. So why don't we just\ntry and use some",
    "start": "1293050",
    "end": "1299260"
  },
  {
    "text": "of these already quite\nstrong and quite accurate behavior models in order\nto simulate agents for us?",
    "start": "1299260",
    "end": "1307710"
  },
  {
    "text": "So the question here\nis can we just do this, and problem solved, and\nwe're all really happy?",
    "start": "1307710",
    "end": "1312780"
  },
  {
    "text": "Unfortunately, no. And I'll show an example\nof what that looks like.",
    "start": "1312780",
    "end": "1318460"
  },
  {
    "text": "So on the left here, I just\nhave a normal driving trajectory that's taken from\njust logged data.",
    "start": "1318460",
    "end": "1324180"
  },
  {
    "text": "So this is very\nsmooth driving motion. As you can see, cars are just\ntypically sticking to the lane and the orange car\nhere is the agent",
    "start": "1324180",
    "end": "1331710"
  },
  {
    "text": "that's being modeled let's say. So this is ground trip data. If I just take out even a state\nof the art prediction model",
    "start": "1331710",
    "end": "1339809"
  },
  {
    "text": "and I apply it to\ncontrol this vehicle in an autoregressive fashion\nby making some predictions, driving for a bit, feeding that\nnew data back in and repeatedly",
    "start": "1339810",
    "end": "1348120"
  },
  {
    "text": "doing this, as you can see, very\nquickly this prediction model",
    "start": "1348120",
    "end": "1357690"
  },
  {
    "text": "gets out of normal\ndriving behavior and it's basically useless. It's just stopping here\nin the middle of the road.",
    "start": "1357690",
    "end": "1364620"
  },
  {
    "text": "And the fundamental\nreason behind this kind of divergence from good\nbehavior lies in the fact",
    "start": "1364620",
    "end": "1369990"
  },
  {
    "text": "that prediction model\nerrors accumulate over time. And when they accumulate\nenough, now your neural network",
    "start": "1369990",
    "end": "1377520"
  },
  {
    "text": "is kind of outside of the\ntraining data distribution that it was originally\ntrained for.",
    "start": "1377520",
    "end": "1383350"
  },
  {
    "text": "And neural networks have\nquite a difficult time. Even with all the\namazing methods that have been\ndeveloped since, that's",
    "start": "1383350",
    "end": "1388800"
  },
  {
    "text": "still a very difficult problem. And so unfortunately,\nyou make a bit of error",
    "start": "1388800",
    "end": "1394140"
  },
  {
    "text": "at the first time step, then you\nfeed that back into the model, make an error on the next time\nstep, and then it just grows",
    "start": "1394140",
    "end": "1399870"
  },
  {
    "text": "and it's hopeless,\nas you've seen. So the first of our\nworks in this direction",
    "start": "1399870",
    "end": "1406230"
  },
  {
    "text": "was actually targeted to\ntackling this problem. So the way that we\ntackled this problem is that we decomposed the\nproblem of behavioral modeling",
    "start": "1406230",
    "end": "1416570"
  },
  {
    "text": "for simulation into\ntwo sub problems. The first is predicting\nwhere the agent wants to go.",
    "start": "1416570",
    "end": "1424520"
  },
  {
    "text": "And then once we have kind\nof like a goal point in mind, the second sub problem is\nbasically connecting A to B",
    "start": "1424520",
    "end": "1430429"
  },
  {
    "text": "and connecting where\nthe agent is currently to where it wants to go\nthrough this inferred goal.",
    "start": "1430430",
    "end": "1436580"
  },
  {
    "text": "And the video I'm showing\nhere, which I'll play again-- so what you can see\nhere on the right",
    "start": "1436580",
    "end": "1442970"
  },
  {
    "text": "is that first level\nof the hierarchy where we're estimating the goal\nof where the agent wants",
    "start": "1442970",
    "end": "1448460"
  },
  {
    "text": "to go using this kind of\nspatial probability heat map over the scene. And then on the left, you\ncan see the resulting--",
    "start": "1448460",
    "end": "1455950"
  },
  {
    "text": "the trajectory that\nconnects the two, but you can also see that\neven when we're repeatedly running this, we actually have\nvery stable driving behavior",
    "start": "1455950",
    "end": "1463760"
  },
  {
    "text": "that you can actually\njust run for a while. And most importantly, this\nmodeling of this agent happens--",
    "start": "1463760",
    "end": "1472669"
  },
  {
    "text": "it's like every agent is\nmodeled independently. And what's good about this\nis every agent actually",
    "start": "1472670",
    "end": "1480110"
  },
  {
    "text": "can think for itself. And it has kind of like an\nobservation neighborhood around itself as well. So you can actually get\nvery complicated behaviors",
    "start": "1480110",
    "end": "1489020"
  },
  {
    "text": "even from a simple model like\nthis, which is just estimating a very likely place\nfor this agent to go without really\nmuch prior information.",
    "start": "1489020",
    "end": "1496640"
  },
  {
    "text": "And even better,\nbecause this model that we've developed--\nspecifically, it's called BITS.",
    "start": "1496640",
    "end": "1502429"
  },
  {
    "text": "This model that we developed\nalso has stochasticity inside it so we can actually, even from\nthe exact same initialization",
    "start": "1502430",
    "end": "1509180"
  },
  {
    "text": "of the scenario, we can\ngenerate diverse rollouts for even the exact same map.",
    "start": "1509180",
    "end": "1515590"
  },
  {
    "text": "And this is a really\ngood thing because it enables counterfactual\nreasoning or also known as what if reasoning.",
    "start": "1515590",
    "end": "1523580"
  },
  {
    "text": "Now I've shown you some\nnice GIFs here but all",
    "start": "1523580",
    "end": "1529970"
  },
  {
    "text": "of that's really nice but\nis it actually-- how can we actually evaluate that these\ntrajectories are indeed good?",
    "start": "1529970",
    "end": "1535790"
  },
  {
    "text": "And this is quite a\ndifficult question because it's very difficult\nto evaluate behavioral realism",
    "start": "1535790",
    "end": "1541100"
  },
  {
    "text": "especially when you don't have\nan associated ground truth trajectory that\nyou can compare to.",
    "start": "1541100",
    "end": "1546920"
  },
  {
    "text": "Remember the whole\npoint of simulation is that I want to generate\nnew, and diverse, and realistic",
    "start": "1546920",
    "end": "1552770"
  },
  {
    "text": "but not necessarily seen\nbefore trajectories. And so you can't really\ncompare that to just ground",
    "start": "1552770",
    "end": "1558200"
  },
  {
    "text": "truth data that you collected. And so the way that we tackled\nthis problem in this paper",
    "start": "1558200",
    "end": "1563419"
  },
  {
    "text": "and in some of our\nfollow-on simulation works is to basically come up\nwith a concert of metrics",
    "start": "1563420",
    "end": "1569780"
  },
  {
    "text": "that kind of help\nyou pinpoint what are the strengths and weaknesses\nof different simulation approaches.",
    "start": "1569780",
    "end": "1575480"
  },
  {
    "text": "And there's three different\nlevels to these metrics. So the first is analyzing\nthe specific trajectory level",
    "start": "1575480",
    "end": "1585240"
  },
  {
    "text": "information that is output\nby your simulation model. So here, what you can\nlook at is, for example,",
    "start": "1585240",
    "end": "1591780"
  },
  {
    "text": "over repeated\nsimulations, how much area is covered by your\nmotion, how diverse",
    "start": "1591780",
    "end": "1598200"
  },
  {
    "text": "are the trajectories that\nare generated per rollout, and what are the failure rates? So here, for example, collision\nrate or driving off road.",
    "start": "1598200",
    "end": "1605700"
  },
  {
    "text": "So at least we have some\nsemblance of following rules.",
    "start": "1605700",
    "end": "1610980"
  },
  {
    "text": "The second level is\nthat you can look-- you can step back a\nlittle bit and look at statistical differences\nto real world data.",
    "start": "1610980",
    "end": "1617310"
  },
  {
    "text": "So maybe I can't compare\nexactly on a trajectory per trajectory basis. But what I can do is I can\ncompare the general distribution",
    "start": "1617310",
    "end": "1625200"
  },
  {
    "text": "of some of the dynamic\nquantities that were output by the model. So I can look, for example, at\nthe difference in the histogram",
    "start": "1625200",
    "end": "1631470"
  },
  {
    "text": "of speed or jerk or acceleration\nor whatever else quantity that you care about\nand compare that",
    "start": "1631470",
    "end": "1637080"
  },
  {
    "text": "to real world\ncollected data sets. And then lastly-- and this\nis probably a little bit",
    "start": "1637080",
    "end": "1642800"
  },
  {
    "text": "in the researchy space-- is maybe I can try and\nlearn a separate model",
    "start": "1642800",
    "end": "1648110"
  },
  {
    "text": "that's just focused on devising\na measure of human likeness or human likelihood of\nthe kinds of trajectories",
    "start": "1648110",
    "end": "1657050"
  },
  {
    "text": "that you're generating. It's a bit weird though\nbecause you're using one model to evaluate the other. So I'm going to say definitely\nstill more work needs",
    "start": "1657050",
    "end": "1663230"
  },
  {
    "text": "to be done on this space. But there are some ideas here. And you'll see some research\nworks that are doing this.",
    "start": "1663230",
    "end": "1670850"
  },
  {
    "text": "Now, I already so far talked\nabout fidelity and diversity.",
    "start": "1670850",
    "end": "1676700"
  },
  {
    "text": "The third desiderata\nwas controllability. So one thing is--",
    "start": "1676700",
    "end": "1683240"
  },
  {
    "text": "it's one thing to\ngenerate nice behaviors. But the other thing\nis, how can we actually generate the specific\nbehaviors that we care about?",
    "start": "1683240",
    "end": "1689210"
  },
  {
    "text": "And so the first\napproach that we did here was to first of\nall change the way",
    "start": "1689210",
    "end": "1695450"
  },
  {
    "text": "that we're generating\ntrajectories, so before we had this\nhierarchical distribution.",
    "start": "1695450",
    "end": "1700650"
  },
  {
    "text": "So here we still have\nthis hierarchical idea.",
    "start": "1700650",
    "end": "1705750"
  },
  {
    "text": "But it's now being done\nby a diffusion model. What's nice about\nthe diffusion model is that it has this internal\nprocess of denoising and--",
    "start": "1705750",
    "end": "1713310"
  },
  {
    "text": "what is it called-- diffusion. And why this is nice is\nbecause we can actually",
    "start": "1713310",
    "end": "1718470"
  },
  {
    "text": "inject some guidance\ninto that process in order to generate the kinds\nof motions that we care about.",
    "start": "1718470",
    "end": "1724590"
  },
  {
    "text": "And the way that we chose\nto do this for this work is we chose to allow the user\nto specify formal logic for how",
    "start": "1724590",
    "end": "1732840"
  },
  {
    "text": "they want a scene to evolve. And the language\nthat we use for this is STL or signal temporal logic.",
    "start": "1732840",
    "end": "1738270"
  },
  {
    "text": "So basically, users can\ncome up to this simulator, specify, OK, I want all\nvehicles to not collide.",
    "start": "1738270",
    "end": "1745200"
  },
  {
    "text": "I want this vehicle to be at\nthis position at this velocity. I want in this kind\nof formal language.",
    "start": "1745200",
    "end": "1751650"
  },
  {
    "text": "And then we can use the\nresulting robustness formulas that this STL\nframework generates",
    "start": "1751650",
    "end": "1760170"
  },
  {
    "text": "and use that to\nguide the generation process of this model. And what this allows\nus to do is exactly--",
    "start": "1760170",
    "end": "1767430"
  },
  {
    "text": "so here's an example of,\nsay, we wanted some vehicles to stop in specific places. I'm visualizing here some\nof these trajectories.",
    "start": "1767430",
    "end": "1774420"
  },
  {
    "text": "But basically, what you can\nsee is that, in the top, I give no guidance. These vehicles are just\nmoving through an intersection",
    "start": "1774420",
    "end": "1781080"
  },
  {
    "text": "with some nominal speed. But in the bottom,\nwhen we ask them to stop at a specific\npoint, you could",
    "start": "1781080",
    "end": "1786120"
  },
  {
    "text": "see that they started slowing\ndown much earlier on so that they kind of perfectly\nend up in that place.",
    "start": "1786120",
    "end": "1793730"
  },
  {
    "text": "Now, I also understand that,\nfrom a user perspective, maybe not everyone\nis a mathematician",
    "start": "1793730",
    "end": "1799280"
  },
  {
    "text": "and knows how to\nspecify STL formulas. It's not really\nthat user friendly. So something that we then\nsubsequently worked on",
    "start": "1799280",
    "end": "1807230"
  },
  {
    "text": "was how to make that interface\na little bit more natural. And here we turn to language. And this was\nespecially important,",
    "start": "1807230",
    "end": "1814100"
  },
  {
    "text": "as now we actually\nhave such models that can interpret language. And in our case,\nwhat we did was we",
    "start": "1814100",
    "end": "1820880"
  },
  {
    "text": "took a user's\nlanguage specification for how they wanted a scene to\nevolve, use a large language",
    "start": "1820880",
    "end": "1827420"
  },
  {
    "text": "model to then output for us\nthe kinds of logical formula that guide the scene generation.",
    "start": "1827420",
    "end": "1835130"
  },
  {
    "text": "And then, as per\nnormal, as per before, we use that guidance to\ngenerate a simulation.",
    "start": "1835130",
    "end": "1841670"
  },
  {
    "text": "And the good thing\nis this doesn't just have to come from user-- you typing yourself.",
    "start": "1841670",
    "end": "1847370"
  },
  {
    "text": "It actually unlocks\nan entire new area of data that can be used\nthat otherwise was not",
    "start": "1847370",
    "end": "1853070"
  },
  {
    "text": "able to be used for. And that's primarily\ntextual data like police reports, insurance\nreports, crash reports",
    "start": "1853070",
    "end": "1858810"
  },
  {
    "text": "from governmental\nagencies, which we can now reconstruct and then use to\nsimulate these kinds of very",
    "start": "1858810",
    "end": "1866250"
  },
  {
    "text": "rare scenarios. And I'll show you\nsome examples of this. So for this\nparticular case where",
    "start": "1866250",
    "end": "1871412"
  },
  {
    "text": "I want to generate a vehicle\nthat crashes into another one, at a very specific--\na very specific way. I want to crash on the left\nside or something like that.",
    "start": "1871412",
    "end": "1878280"
  },
  {
    "text": "You can see that,\nwhen we pass this in, it's actually able to\ndo this just like that.",
    "start": "1878280",
    "end": "1884540"
  },
  {
    "text": "And towards the point\nI was making earlier, we can take in some real\nworld collision reports",
    "start": "1884540",
    "end": "1892070"
  },
  {
    "text": "like from the-- these ones\nare from the National Highway Traffic Safety Authority,\nTransportation Safety Authority,",
    "start": "1892070",
    "end": "1898050"
  },
  {
    "text": "something like that. And we're able to actually\nreconstruct them here and use",
    "start": "1898050",
    "end": "1903530"
  },
  {
    "text": "them as simulation\nenvironments, which we can then put our own\nvehicle in, for example.",
    "start": "1903530",
    "end": "1908645"
  },
  {
    "text": " Even nicer is that,\nthese language models,",
    "start": "1908645",
    "end": "1916050"
  },
  {
    "text": "they have so much inherent\ndomain understanding of natural language input,\nthat even if we never--",
    "start": "1916050",
    "end": "1922980"
  },
  {
    "text": "even if a lot of our\noriginal training regime never had the words like\nsparse or crowded or whatever,",
    "start": "1922980",
    "end": "1929040"
  },
  {
    "text": "we're able to use these\nkinds of modifiers and actually have output that\nmatches what the user wants here",
    "start": "1929040",
    "end": "1935400"
  },
  {
    "text": "in terms of sparsity\nfor traffic. Or, beyond just\ngenerating a scene",
    "start": "1935400",
    "end": "1941549"
  },
  {
    "text": "like one time initial\nscene generation, our method also enables editing\nan already generated scene.",
    "start": "1941550",
    "end": "1947183"
  },
  {
    "text": "So let's say you do have a\nscene that was generated, but there's one or two\nthings wrong with it and you want to change\nthat, so here you",
    "start": "1947183",
    "end": "1953903"
  },
  {
    "text": "can actually continually\nmake updates by specifying, OK, make this car do this. Make this car do this. Make this car do this.",
    "start": "1953903",
    "end": "1959490"
  },
  {
    "text": "And one thing that I want to\npoint out here on the very right, when we give it a prompt\nto speed up cars that are moving",
    "start": "1959490",
    "end": "1966029"
  },
  {
    "text": "in the same direction--\nin particular, here, same direction with respect\nto this red vehicle-- what you can see is,\ncompared to this one,",
    "start": "1966030",
    "end": "1972720"
  },
  {
    "text": "it had to move the blue\nvehicle to the right. Because otherwise,\nthese vehicles are turning left, which\nmeans that they're naturally",
    "start": "1972720",
    "end": "1979080"
  },
  {
    "text": "going to be going slower\nthan someone who's just going straight through. And so it actually moved\nthis blue vehicle over. It has enough\ndomain understanding",
    "start": "1979080",
    "end": "1985207"
  },
  {
    "text": "of driving to move\nthat blue vehicle over to then enable it\nto actually speed up through that intersection, which\nwas quite interesting to see",
    "start": "1985207",
    "end": "1993060"
  },
  {
    "text": "from our perspective. Now, all of this is great. But everything I showed is still\nat the traffic simulation level.",
    "start": "1993060",
    "end": "2002250"
  },
  {
    "text": "So this is great for testing\nout prediction planning control. But remember, to fully\nevaluate an av stack,",
    "start": "2002250",
    "end": "2007920"
  },
  {
    "text": "we also have perception\nin everything that happens upstream. And so, recently, when\nyou need to handle--",
    "start": "2007920",
    "end": "2017220"
  },
  {
    "text": "when you need to model the\nworld and actually perceive it, this is where you start entering\nthe problems of dynamic scene",
    "start": "2017220",
    "end": "2023790"
  },
  {
    "text": "representation and dynamic\nscene reconstruction. And so, in particular,\nthere's been",
    "start": "2023790",
    "end": "2029010"
  },
  {
    "text": "a lot of recent work using\nneural radiance fields or NERFs. Maybe some of you\nhave heard this term.",
    "start": "2029010",
    "end": "2034260"
  },
  {
    "text": "To reconstruct,\ncollect environments that an autonomous\nvehicle has already passed",
    "start": "2034260",
    "end": "2040950"
  },
  {
    "text": "through and already\ncollected some data from-- in order to reconstruct a\nvery realistic looking data",
    "start": "2040950",
    "end": "2054480"
  },
  {
    "text": "capture of this-- and NERF is able to\nrepresent that and then allow you to resimulate what\nyour sensors would have seen",
    "start": "2054480",
    "end": "2062800"
  },
  {
    "text": "if you placed your car\nat a specific point and you had a specific\nview direction or something like that.",
    "start": "2062800",
    "end": "2069699"
  },
  {
    "text": "Now, a lot of these\nmethods, the way that they work-- and maybe\nyou'll notice in these videos",
    "start": "2069699",
    "end": "2075279"
  },
  {
    "text": "there's no moving vehicles\nanywhere in this video. And that's because\nNERF methods typically",
    "start": "2075280",
    "end": "2082539"
  },
  {
    "text": "struggle to handle dynamic\nobjects because they break a lot of the multi-view\nconsistency assumptions that you make within NERF.",
    "start": "2082540",
    "end": "2088840"
  },
  {
    "text": "And so what methods\ntypically do is they'll have an\ninitial masking step",
    "start": "2088840",
    "end": "2094570"
  },
  {
    "text": "or maybe they'll use a\nground truth annotations or maybe they'll use a\npre-trained model for object",
    "start": "2094570",
    "end": "2100000"
  },
  {
    "text": "detection to detect cars,\npedestrians, bicyclists, whatever, to get their bounding\nboxes and then remove those,",
    "start": "2100000",
    "end": "2106599"
  },
  {
    "text": "subtract those from the scene. And actually, you can see this\nhere if you have good eyes. You see these black\nsplotches here on the left,",
    "start": "2106600",
    "end": "2112720"
  },
  {
    "text": "those are parked cars\nthat were removed. But they didn't\nremove their shadows. Difficult thing to do.",
    "start": "2112720",
    "end": "2118260"
  },
  {
    "text": "So you can see. They do this first step. Then they regenerate\nthe static world. And hey, it looks beautiful.",
    "start": "2118260",
    "end": "2123670"
  },
  {
    "text": "But you are missing\nthis dynamic element. So can we leverage this\nhigh fidelity representation",
    "start": "2123670",
    "end": "2131859"
  },
  {
    "text": "capability of NERF but still\nrepresent dynamic objects? Because obviously, for driving,\nthis is extremely important.",
    "start": "2131860",
    "end": "2137920"
  },
  {
    "text": "And more importantly,\ncan we do this without requiring\nground truth annotation or using some pre-trained\nbounding box detection model,",
    "start": "2137920",
    "end": "2145660"
  },
  {
    "text": "which might have some errors\nor something like that? Absolutely.",
    "start": "2145660",
    "end": "2151010"
  },
  {
    "text": "Otherwise, I wouldn't be\nasking these questions. [CHUCKLES] And I'm going to show\nyou first some of the results, and then I'll talk\nabout the method.",
    "start": "2151010",
    "end": "2157510"
  },
  {
    "text": "But what you can\nsee here, so each of these-- in each of these\nvideos, this method that I'll",
    "start": "2157510",
    "end": "2164860"
  },
  {
    "text": "talk about in the next\nslide is able to purely, from self-supervision,\ndecompose the static and dynamic",
    "start": "2164860",
    "end": "2173650"
  },
  {
    "text": "components of a scene. So what you're looking\nat here on the top-- and I'll talk about what\nthese colors are later.",
    "start": "2173650",
    "end": "2179307"
  },
  {
    "text": "But what you're\nlooking at on the top is basically anything\nthat just has a normal RGB color from the sensor.",
    "start": "2179308",
    "end": "2184450"
  },
  {
    "text": "This is static. This has been\ndecomposed by our method to be static non changing\nthroughout the entire scene.",
    "start": "2184450",
    "end": "2190329"
  },
  {
    "text": "And then everything\nthat has this funky colors is some dynamic element.",
    "start": "2190330",
    "end": "2195550"
  },
  {
    "text": "So we can see that here\npedestrians are highlighted. Vehicles are highlighted\nand all that as they",
    "start": "2195550",
    "end": "2201280"
  },
  {
    "text": "as they pass through. Same thing at the bottom here. We can see a similar\nthing, where I'm just",
    "start": "2201280",
    "end": "2207280"
  },
  {
    "text": "showing you the dynamic elements\nof a scene without any static-- all the static\nelements are removed.",
    "start": "2207280",
    "end": "2213760"
  },
  {
    "text": "So the way that we do this while\nstill using a neural field based approach is we--",
    "start": "2213760",
    "end": "2221405"
  },
  {
    "text": "and this is the title,\nactually, of the paper which will soon be online. So give it a few days. The way that we do this is\nwe decompose every scene",
    "start": "2221405",
    "end": "2229580"
  },
  {
    "text": "into three separate components. The first is a static field. So this is like a\ntraditional NERF.",
    "start": "2229580",
    "end": "2236210"
  },
  {
    "text": "I'm just modeling\nthe static world without any dynamic\nobjects in there.",
    "start": "2236210",
    "end": "2241460"
  },
  {
    "text": "The second is a dynamic field. So, whereas the first\nfield just takes in the XYZ position of your\ncamera and the view direction,",
    "start": "2241460",
    "end": "2248960"
  },
  {
    "text": "the dynamic field is 4D. So it takes in the\nXYZ and the time because it matters where these\nvehicles are in time as well",
    "start": "2248960",
    "end": "2256220"
  },
  {
    "text": "as the view direction. But now, just having these\ntwo is not good enough.",
    "start": "2256220",
    "end": "2261260"
  },
  {
    "text": "And actually, I'll\nshow you-- you guys might have noticed the\ndifference between these two videos.",
    "start": "2261260",
    "end": "2267453"
  },
  {
    "text": "You see, in the bottom\none, when the car is moving-- it'll replay again. When you see when the car\nis moving at the beginning,",
    "start": "2267453",
    "end": "2272558"
  },
  {
    "text": "do you see a lot of this\nartifacts around the edge? If you just do a static\nand dynamic field,",
    "start": "2272558",
    "end": "2278120"
  },
  {
    "text": "this is what you\nget, where, when the car is moving, insensibly,\neverything in the world is moving relative to the car.",
    "start": "2278120",
    "end": "2283760"
  },
  {
    "text": "And so you get these artifacts. And then when\neverything's stationary, everything's looking great. This is an earlier result\ncompared to this result.",
    "start": "2283760",
    "end": "2290900"
  },
  {
    "text": "To really sharpen up this\ndynamic understanding, this is where we also\nintroduce a flow field.",
    "start": "2290900",
    "end": "2297140"
  },
  {
    "text": "This is also a 4D field. But the whole point\nof the flow field is to connect the individual\ndynamic field objects in time.",
    "start": "2297140",
    "end": "2307050"
  },
  {
    "text": "And so what the flow\nfield is tasked with doing is calculating. OK, if we do have elements in\nthe dynamic field, what flow",
    "start": "2307050",
    "end": "2314180"
  },
  {
    "text": "or what delta should\nI add to them so that I know where they'll\nbe in the next time step? And what you can do is\nyou can use this flow",
    "start": "2314180",
    "end": "2319970"
  },
  {
    "text": "field to associate your\ndynamic components in time. And this yields a very\nstrong learning signal",
    "start": "2319970",
    "end": "2327530"
  },
  {
    "text": "because now you can aggregate-- what's it called-- you can\naggregate features over time. But it's also\nmutually reinforcing.",
    "start": "2327530",
    "end": "2335030"
  },
  {
    "text": "So static dynamic\ndecomposition is improved by also trying to learn flow.",
    "start": "2335030",
    "end": "2340070"
  },
  {
    "text": "And then flow is also\nimproved by having a better dynamic field and et-cetera. So actually, during\nlearning, both of these",
    "start": "2340070",
    "end": "2346520"
  },
  {
    "text": "are really improving the\nperformance of the other. And what this allows\nyou to do is--",
    "start": "2346520",
    "end": "2355340"
  },
  {
    "text": "so I have here some\nof the outputs of when you use this full model.",
    "start": "2355340",
    "end": "2360410"
  },
  {
    "text": "So on the top is just the\nground truth image that was passed in by the sensors. Here is the rerendered thing.",
    "start": "2360410",
    "end": "2365685"
  },
  {
    "text": "So from your guys'\nperspective, there's going to be no difference. You have to zoom in very,\nvery deep to see differences.",
    "start": "2365685",
    "end": "2370922"
  },
  {
    "text": "And then here, I\nwant to point out. In this third row, we can see\nthe decomposed static RGB.",
    "start": "2370922",
    "end": "2377059"
  },
  {
    "text": "So you see this car here gone\nwith no shadow remnant left behind, because that shadow--",
    "start": "2377060",
    "end": "2384200"
  },
  {
    "text": "first of all, we have a special\nhead for capturing that. But also, that kind of stuff\nis captured in the flow field.",
    "start": "2384200",
    "end": "2389570"
  },
  {
    "text": "So those kinds of remnants\nwhich otherwise you would get if you just\ntried to naively remove it",
    "start": "2389570",
    "end": "2394730"
  },
  {
    "text": "are actually now just\nnaturally handled by the model. Same thing on this side. Do you see all\nthese pedestrians?",
    "start": "2394730",
    "end": "2401510"
  },
  {
    "text": "Gone as if it was\ndone by Photoshop. And here's the dynamic.",
    "start": "2401510",
    "end": "2407530"
  },
  {
    "text": "If you just want to parse\nout just the dynamic objects, you can see what\nthat looks like here. And here's the flow.",
    "start": "2407530",
    "end": "2413682"
  },
  {
    "text": "It's hard to interpret. But it's basically\nshowing you the speeds of things moving in the scene.",
    "start": "2413682",
    "end": "2419049"
  },
  {
    "text": "Now, the final thing that's very\nimpressive about this model, so not only are we trying\nto reconstruct the RGB",
    "start": "2419050",
    "end": "2427690"
  },
  {
    "text": "and depth and then this\ndynamic static stuff, we can also add\nadditional features here.",
    "start": "2427690",
    "end": "2433970"
  },
  {
    "text": "And what's quite\ninteresting here-- and some parallel lines of\nwork that you might be aware of",
    "start": "2433970",
    "end": "2439130"
  },
  {
    "text": "are there are some very powerful\nvisual foundation models nowadays, which are also\ntrained from self-supervision.",
    "start": "2439130",
    "end": "2444830"
  },
  {
    "text": "But they learn these very\nstrong semantic features. So I'm going to-- I'm showing here an\nexample of DINOv2, which was released by Meta.",
    "start": "2444830",
    "end": "2450890"
  },
  {
    "text": "I don't know how\nmany months ago. I forget now. But these kinds of features\nyou can also try and train",
    "start": "2450890",
    "end": "2457250"
  },
  {
    "text": "this model that I showed in\nthe last slide to reconstruct. And what this allows you\nto do is generate, well,",
    "start": "2457250",
    "end": "2464963"
  },
  {
    "text": "one, some very wacky colors. But two, what I'm\nvisualizing here is those reconstructed\nsemantic features",
    "start": "2464963",
    "end": "2472310"
  },
  {
    "text": "pass through PCA just\nso that we can actually have some colors here. And remember, this is all--",
    "start": "2472310",
    "end": "2477552"
  },
  {
    "text": "there's no labeling here\nor anything like that. So just by using these\npre-trained features from another model, which exists\nfor free, we can color buildings",
    "start": "2477552",
    "end": "2486413"
  },
  {
    "text": "or we can identify the\nbuildings or buildings. They're all the same color. We can see all vehicles\nhere all the same--",
    "start": "2486413",
    "end": "2492630"
  },
  {
    "text": "all static vehicles\nhere, all the same color. And I'm showing here an RGB. I'm decomposing the\ndynamic static, at least,",
    "start": "2492630",
    "end": "2499020"
  },
  {
    "text": "so you can see. But what's really\nnice about this is that now that this method\nthat we developed originally",
    "start": "2499020",
    "end": "2504750"
  },
  {
    "text": "for simulation you\ncan now actually use this for auto labeling. Because once you have a car\npass through an environment,",
    "start": "2504750",
    "end": "2512099"
  },
  {
    "text": "you can, with our\napproach, decompose it into dynamic static, remove\nthe dynamic parts if you want,",
    "start": "2512100",
    "end": "2518370"
  },
  {
    "text": "reconstruct these very\nimportant semantic features.",
    "start": "2518370",
    "end": "2523470"
  },
  {
    "text": "And now you can label the map,\nthe buildings, the whatever just like this without\nhuman labeling,",
    "start": "2523470",
    "end": "2530730"
  },
  {
    "text": "without tons of\nmodels behind the mix.",
    "start": "2530730",
    "end": "2535920"
  },
  {
    "text": "So I know that was\na lot to take in. But stepping back a little bit,\nI want to say, in general, now",
    "start": "2535920",
    "end": "2542790"
  },
  {
    "text": "is really a fantastic\ntime for AV research. I know a lot of people\nsay, oh, but Waymo is driving around in SF.",
    "start": "2542790",
    "end": "2548609"
  },
  {
    "text": "Yes, there's so many\nproblems, though, that still need to be solved\nin order to really get us",
    "start": "2548610",
    "end": "2554010"
  },
  {
    "text": "from 90% performance\nto 99.9999 performance.",
    "start": "2554010",
    "end": "2559440"
  },
  {
    "text": "And one thing that's been\nreally helpful in accelerating this kind of research\nin this space",
    "start": "2559440",
    "end": "2564810"
  },
  {
    "text": "is that there's been a\nsignificant amount of data that's been open sourced. Ever since about\n2019 or so, there's",
    "start": "2564810",
    "end": "2570993"
  },
  {
    "text": "been thousands of hours of data\nnow that researchers have access to. And it's not just from one\ncity or this other city",
    "start": "2570993",
    "end": "2579690"
  },
  {
    "text": "or even from just the\nWestern hemisphere. We have data from\nall around the world. The only downside is that all of\nthis data is in a unique format.",
    "start": "2579690",
    "end": "2589230"
  },
  {
    "text": "So, at least, when I\nremember doing this research, it was really annoying to-- OK, I want to train something\non new scenes and then test it.",
    "start": "2589230",
    "end": "2595569"
  },
  {
    "text": "OK, now I have to spend 2 and\n1/2 weeks to switch my code base over entirely to\na different data set and then do the\nexact same thing.",
    "start": "2595570",
    "end": "2601480"
  },
  {
    "text": "And then, hey,\npresto, I have a paper with two evaluations\nor whatever. So to make life a\nlittle bit easier,",
    "start": "2601480",
    "end": "2606640"
  },
  {
    "text": "something we've also been\nworking on in the group is to develop a unified API\nfor loading multiple data sets",
    "start": "2606640",
    "end": "2614950"
  },
  {
    "text": "trajectory data. And at least, from our\nperspective, this has been so-- at least, for us, foundational,\nbefore we can even",
    "start": "2614950",
    "end": "2622359"
  },
  {
    "text": "start to do a lot of other\ninteresting research, you have to build\nthis data foundation. It has been\nsimplifying our lives.",
    "start": "2622360",
    "end": "2629350"
  },
  {
    "text": "And I know the reason\nI bring it up is because we've open sourced it. It has a very open license\nApache 2.0 and all this.",
    "start": "2629350",
    "end": "2636640"
  },
  {
    "text": "So if you're ever doing\nany research like this and you think something\nlike this would be helpful, by all means, check it out.",
    "start": "2636640",
    "end": "2642250"
  },
  {
    "text": "Feel free to ask\nquestions on GitHub. Or just email me if\nyou have any questions.",
    "start": "2642250",
    "end": "2649432"
  },
  {
    "text": "And also, on the simulation\nside, as you can imagine, there's a ton of\nbehind-the-scenes work that has to go in to actually\nmaking this all work.",
    "start": "2649432",
    "end": "2656240"
  },
  {
    "text": "And so we've also released\nour simulation framework, which has that model bits.",
    "start": "2656240",
    "end": "2662290"
  },
  {
    "text": "And the other model,\nwe're soon going to release that other--\nthe language ones. We're soon going to\nbe releasing them also",
    "start": "2662290",
    "end": "2668110"
  },
  {
    "text": "in this similar framework. So if you're interested in this\nkind of research, by all means,",
    "start": "2668110",
    "end": "2673270"
  },
  {
    "text": "take a look. Maybe it helps you. So some key takeaways here,\nbefore I conclude, is--",
    "start": "2673270",
    "end": "2680920"
  },
  {
    "text": "I guess, to conclude,\nsome key takeaways are whenever autonomy\nstack components",
    "start": "2680920",
    "end": "2687220"
  },
  {
    "text": "are being designed\nresearched, et cetera, just keep in mind that you're\nnever evaluating just one block.",
    "start": "2687220",
    "end": "2693190"
  },
  {
    "text": "They impact\ndownstream components. They follow other components. There are uncertainties.",
    "start": "2693190",
    "end": "2698980"
  },
  {
    "text": "There are other things\nto take into account. So just make sure to\nkeep that in mind. And actually, from a\nresearch perspective,",
    "start": "2698980",
    "end": "2705520"
  },
  {
    "text": "revisiting the interfaces\nbetween modules is likely actually to yield more\nimprovements, more advancements,",
    "start": "2705520",
    "end": "2712120"
  },
  {
    "text": "rather than just focusing\non modules themselves. Also, there's a full\nspectrum of architectures",
    "start": "2712120",
    "end": "2718960"
  },
  {
    "text": "between classical modular\napproaches and end to end approaches. We showed one\nexample here where we have a differentiable\nmodular approach.",
    "start": "2718960",
    "end": "2725050"
  },
  {
    "text": "But keep in mind, there's\na lot of other things that can be done. So whenever you're developing\nthese kinds of things",
    "start": "2725050",
    "end": "2731230"
  },
  {
    "text": "in your robotics\nresearch or coursework, keep the idea of\ndifferentiability and task",
    "start": "2731230",
    "end": "2737420"
  },
  {
    "text": "awareness in mind. And I think you'll find it\ncan be surprisingly helpful. And lastly, closed loop\nsimulation is really",
    "start": "2737420",
    "end": "2744710"
  },
  {
    "text": "the key enabling capability\nfor really vastly scaling up the verification and validation\nof autonomous vehicle stacks.",
    "start": "2744710",
    "end": "2754580"
  },
  {
    "text": "And I think, really, data driven\nhuman and environment modeling",
    "start": "2754580",
    "end": "2760250"
  },
  {
    "text": "is really the key that\nwe need in order-- it's the key final piece\nthat we need in order to really scale up and use the\nsimulation for evaluation use.",
    "start": "2760250",
    "end": "2770750"
  },
  {
    "text": "So with that, I want to thank\nyou all for your attention. Please, if you\nhave any questions or you want to see any of\nthese papers, take a look here.",
    "start": "2770750",
    "end": "2777230"
  },
  {
    "text": "We're hiring. So thank you all\nfor your time again. [APPLAUSE] ",
    "start": "2777230",
    "end": "2786940"
  },
  {
    "text": "Thank you, Boris. I think we have time\nfor one quick question. But then we can of course\ninterrupt the speaker",
    "start": "2786940",
    "end": "2794049"
  },
  {
    "text": "outside where we have pizza. So who is the lucky person\nto ask the question?",
    "start": "2794050",
    "end": "2800800"
  },
  {
    "text": "Go ahead. So in the model previously,\nwhat about objects",
    "start": "2800800",
    "end": "2806740"
  },
  {
    "text": "that transition from static to\ndynamic or dynamic to static? Great question. So the good thing about\nthis work is that what we do",
    "start": "2806740",
    "end": "2816010"
  },
  {
    "text": "is we first take all the data\nfrom the entire traversal of a scene. So after a car has\nalready moved through.",
    "start": "2816010",
    "end": "2822369"
  },
  {
    "text": "And because we have\nthis flow field, if there was an object\nthat, let's say, was dynamic, let's say,\ntowards the end of the scene,",
    "start": "2822370",
    "end": "2828550"
  },
  {
    "text": "that information\nmakes its way back. So I wonder if I have--",
    "start": "2828550",
    "end": "2833665"
  },
  {
    "text": "I have other videos. I guess it's not this one. But I have other videos where\nthere is a parked car that",
    "start": "2833665",
    "end": "2838960"
  },
  {
    "text": "starts moving, and it's\nalways highlighted, because it brought\nthat information back as well from the\nfuture as well when",
    "start": "2838960",
    "end": "2844570"
  },
  {
    "text": "it was doing this optimization. So we had trouble with it\nearlier on in the project, but this flow field\nreally helped crisp up",
    "start": "2844570",
    "end": "2853090"
  },
  {
    "text": "some of that annoyance as well. It's a good question. ",
    "start": "2853090",
    "end": "2859345"
  },
  {
    "text": "And you can even see here-- I'm sorry. Sorry, Marco. You can see here because\nthey're all stopped. The pedestrians are all\njust standing still.",
    "start": "2859345",
    "end": "2865203"
  },
  {
    "text": "So yeah, yeah, yeah, it's there. All right, so I think,\nunfortunately, we",
    "start": "2865203",
    "end": "2870970"
  },
  {
    "text": "have to wrap up. But as I said, we're going\nto have pizza outside. So take that as an opportunity\nto ask any questions",
    "start": "2870970",
    "end": "2877000"
  },
  {
    "text": "you might have, of course. [APPLAUSE] Thank you. ",
    "start": "2877000",
    "end": "2887000"
  }
]