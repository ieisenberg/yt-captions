[
  {
    "start": "0",
    "end": "81000"
  },
  {
    "text": "We're now gonna talk about a very important topic in uh, building prediction models um, which is validation.",
    "start": "4250",
    "end": "13450"
  },
  {
    "text": "The basic idea is this. Uh, the goal- when you're building a model,",
    "start": "13520",
    "end": "19195"
  },
  {
    "text": "a prediction model of some kind, your goal is not to predict the outcome on the given data.",
    "start": "19195",
    "end": "25710"
  },
  {
    "text": "Uh, after all, you know exactly what the outcome is. So you don't have to do any prediction at all or unless you have an excellent [NOISE] uh, prediction of it.",
    "start": "25710",
    "end": "32345"
  },
  {
    "text": "Uh, so in fact, what it's really about is you really want to be able to predict the outcome on new unseen data.",
    "start": "32345",
    "end": "38954"
  },
  {
    "text": "So- or for example, you don't wanna build a- I mean, you might wanna build- build a model, but you really want it to work next week.",
    "start": "38955",
    "end": "45454"
  },
  {
    "text": "That's it. That- that's- that's basically the idea. Okay. Now a model that makes reasonable predictions on new unseen data um,",
    "start": "45455",
    "end": "53985"
  },
  {
    "text": "is- it- it's said to generalize well. In other words, it worked well on that data I use to build the model,",
    "start": "53985",
    "end": "60785"
  },
  {
    "text": "and now it generalizes to this new data, which it has never seen before. Now if it fails to make good predictions,",
    "start": "60785",
    "end": "69154"
  },
  {
    "text": "you would say that the model is suffering from overfit. Uh, although there are couple of other reasons why the- the- the um,",
    "start": "69154",
    "end": "77345"
  },
  {
    "text": "it may perform uh, poorly. Okay, so this is the actual goal. So a very simple way, uh,",
    "start": "77345",
    "end": "85645"
  },
  {
    "start": "81000",
    "end": "315000"
  },
  {
    "text": "to simulate how the model will really be used in practice is- is called validation.",
    "start": "85645",
    "end": "92145"
  },
  {
    "text": "And so the way that works, uh, is- it's really very simple, um, and it looks like this.",
    "start": "92145",
    "end": "98160"
  },
  {
    "text": "You have- you're given an initial set of data and what you do is you- you remove part of that data.",
    "start": "98160",
    "end": "105050"
  },
  {
    "text": "Uh, people often just choose, you know, like 20% of the data or something like that,",
    "start": "105050",
    "end": "110395"
  },
  {
    "text": "30%, 10%. And they hold that data, which you really know, that,",
    "start": "110395",
    "end": "115895"
  },
  {
    "text": "you know, that data, you know the values of y. And you kind of- you'd put that aside and you kind of hold it in escrow.",
    "start": "115895",
    "end": "121160"
  },
  {
    "text": "So it's just sitting there waiting. Then what you do is you build the model or fit the model, and the slang,",
    "start": "121160",
    "end": "128990"
  },
  {
    "text": "uh, term for that is to train, uh, the model, um, on the training dataset.",
    "start": "128990",
    "end": "135135"
  },
  {
    "text": "That's the data from your data that you did not hold in reserve. That- the stuff you're holding in reserve is- is called the test set,",
    "start": "135135",
    "end": "142099"
  },
  {
    "text": "uh, or validation set. Um, so what you do is you- you train or fit the model based on your training data,",
    "start": "142100",
    "end": "149990"
  },
  {
    "text": "and then what you do is you now do a very good simulation of what you really want the model to do, which is to see- to- is to work well on data it has never seen.",
    "start": "149990",
    "end": "159330"
  },
  {
    "text": "And so what you do now is you take the data that you have, but which you did not use to build the model,",
    "start": "159330",
    "end": "164390"
  },
  {
    "text": "that's the test data, and you simply try your model on that. And then you- then because you know what the actual outcome is,",
    "start": "164390",
    "end": "172129"
  },
  {
    "text": "you know what the outcome is, and you also have- you have a y and you have a y hat, and now we can assess how well we did.",
    "start": "172130",
    "end": "178415"
  },
  {
    "text": "So that's the idea. I mean, is it actually a very simple, uh, idea. Um, and so you can do several things here.",
    "start": "178415",
    "end": "185990"
  },
  {
    "text": "Uh, one is you might check the RMS prediction error on the training and test sets. I mean, uh, it would make you feel,",
    "start": "185990",
    "end": "191795"
  },
  {
    "text": "uh, very confident if they were about the same. You would- you would not expect them to be the same, but you'd expect them to be about the same.",
    "start": "191795",
    "end": "198235"
  },
  {
    "text": "Typically, you might expect that the test data, RMS error, to be a little bit worse.",
    "start": "198235",
    "end": "203895"
  },
  {
    "text": "Um, actually, sometimes it's much worse, but- okay. Um, the important point here is that it's actually the- the RMS error on the test data,",
    "start": "203895",
    "end": "213635"
  },
  {
    "text": "which really matters sort of in practice right? Um, now if this all tests out,",
    "start": "213635",
    "end": "219495"
  },
  {
    "text": "um, you can guess the model will generalize. Now that's not a guarantee, uh, by any means, um,",
    "start": "219495",
    "end": "225375"
  },
  {
    "text": "but it- it's- it's a good guess, right? So if you go to someone and you say, I am able to predict demand for this product, uh,",
    "start": "225375",
    "end": "231209"
  },
  {
    "text": "one week ahead, I can get it basically around plus or minus 5%. And then someone would say,",
    "start": "231210",
    "end": "237355"
  },
  {
    "text": "well, how do you know that? And the answer would be something like, well, I did it very carefully. I- I- I took all the data from the last two years.",
    "start": "237355",
    "end": "244400"
  },
  {
    "text": "I took the last- you know, I took the first year and a half of that data and I use that to build my model.",
    "start": "244400",
    "end": "250745"
  },
  {
    "text": "And then I took that model and I tried it on the last six months of data, which might- which- that- when I trained or fit the model parameters,",
    "start": "250745",
    "end": "259704"
  },
  {
    "text": "well, I never use- never saw that data. So- so that's as if that's actually an honest test because it's actually testing of it.",
    "start": "259705",
    "end": "266220"
  },
  {
    "text": "And then you'd say, and, you know, and there I do, plus- about plus, minus 7%. And that would be a very happy outcome.",
    "start": "266220",
    "end": "272660"
  },
  {
    "text": "And then someone would say to you, well, uh, how about next year? How do you think you're gonna do there?",
    "start": "272660",
    "end": "278115"
  },
  {
    "text": "Um, the answer is a bit tricky. You could- an honest answer. Well, you could say something like this.",
    "start": "278115",
    "end": "284099"
  },
  {
    "text": "Well, I would guess or expect to be around plus,",
    "start": "284100",
    "end": "289430"
  },
  {
    "text": "minus 7%, right? That- that's reasonable. Um, and they'd say, but can you guarantee it?",
    "start": "289430",
    "end": "295580"
  },
  {
    "text": "And the answer is no, you can't. You absolutely cannot. So- okay. Um, I should say that you'll see all of the topics we're gonna talk about here, um,",
    "start": "295580",
    "end": "304225"
  },
  {
    "text": "in a- you know, from a different point of view and in much more technical detail in a statistics course or machine learning course.",
    "start": "304225",
    "end": "310195"
  },
  {
    "text": "Um, but the ideas are all accessible, uh, even without those concepts. [NOISE] Okay.",
    "start": "310195",
    "end": "316949"
  },
  {
    "start": "315000",
    "end": "409000"
  },
  {
    "text": "So validation is actually super useful because it ends arguments about,",
    "start": "316950",
    "end": "322535"
  },
  {
    "text": "uh, you know, which model is better, right? So if you have- you have two competing models and in fact,",
    "start": "322535",
    "end": "327889"
  },
  {
    "text": "it's very common for people to produce 50 or 60 different competing models. Uh, we'll see a lot of that later.",
    "start": "327890",
    "end": "334070"
  },
  {
    "text": "Um, and then the question is, which is better? Um, example would be, should I fit some data with a polynomial of degree 3 or degree 8?",
    "start": "334070",
    "end": "344210"
  },
  {
    "text": "And so the point about that question is it's not- it's nothing you can answer by looking at this- the training data alone.",
    "start": "344210",
    "end": "351340"
  },
  {
    "text": "Absolutely, know because the degree 8 polynomial model is gonna fit better than the degree 2.",
    "start": "351340",
    "end": "356710"
  },
  {
    "text": "Does not mean it's going to fit better on next year's data or whatever, you know, future unseen data.",
    "start": "356710",
    "end": "362020"
  },
  {
    "text": "So uh, that's kind of the- the idea there. That- the- so you also have radically different types of model.",
    "start": "362020",
    "end": "368690"
  },
  {
    "text": "And you would say, you know, should I use this model, that model, and this would actually- uh, validation, would answer that question, right?",
    "start": "368690",
    "end": "375030"
  },
  {
    "text": "So [NOISE] and you'd use- what you do is among all your candidate model, you'd use the one that has- I mean,",
    "start": "375030",
    "end": "382200"
  },
  {
    "text": "the traditional- the simplest way to say is the one that has the lowest error. But you might also factor in other things. Like all other things being equal,",
    "start": "382200",
    "end": "388340"
  },
  {
    "text": "you probably want the model to be simple, right? So for example, if a, whatever, if a tenth order polynomial model gave you",
    "start": "388340",
    "end": "395419"
  },
  {
    "text": "the slightest improvement in the test error over a cubic, you'd probably choose a cubic, okay?",
    "start": "395420",
    "end": "402290"
  },
  {
    "text": "So as I said, in other courses, you will see this treated in more detail and things like that, more formally.",
    "start": "402290",
    "end": "409550"
  },
  {
    "start": "409000",
    "end": "617000"
  },
  {
    "text": "Okay, so let's look at an example. So you'll- we- there's 100- we- there's 100 data points, actually 200.",
    "start": "409550",
    "end": "418590"
  },
  {
    "text": "Uh, 100 of them are the training set. And we use that to fit, um, a quadratic,",
    "start": "418590",
    "end": "423929"
  },
  {
    "text": "uh, a degree 6 polynomial, a degree 10, and a degree 15 polynomial.",
    "start": "423929",
    "end": "429320"
  },
  {
    "text": "Now what's showing here is another set of 100 data points,",
    "start": "429320",
    "end": "434730"
  },
  {
    "text": "which is the test, uh, data point. And actually just if you run your eyeball over it, looks pretty good.",
    "start": "434730",
    "end": "441095"
  },
  {
    "text": "I mean, you know, this is, um, and it's honest, right? That- that here, those- that blue curve is making",
    "start": "441095",
    "end": "446600"
  },
  {
    "text": "a prediction on data it has never seen before. So it's actually, it's an honest simulation of how- of what you want a prediction model to do.",
    "start": "446600",
    "end": "455035"
  },
  {
    "text": "Okay. This is sort of a typical- yes, this is- this is a typical situation.",
    "start": "455035",
    "end": "461374"
  },
  {
    "text": "Um, so here for example, I have, uh, increasing degree in my model. Now by the way, a- a model of degree, you know,",
    "start": "461374",
    "end": "469025"
  },
  {
    "text": "10 is also a model of degree 15, because you just- the last five coefficients, you just make them zero.",
    "start": "469025",
    "end": "474919"
  },
  {
    "text": "Um, what that tells you is this, is that the- as the degree increases,",
    "start": "474920",
    "end": "480185"
  },
  {
    "text": "your training error just gets- it just goes down. Gets better and better because, well,",
    "start": "480185",
    "end": "485305"
  },
  {
    "text": "I- I- it could also stay con- constant, right? Because the point there is if I can fit something with a- you know,",
    "start": "485305",
    "end": "491075"
  },
  {
    "text": "a tenth degree polynomial. Um, I can fit it worse with the 15 degree polynomial, I can only do better.",
    "start": "491075",
    "end": "497795"
  },
  {
    "text": "Okay, so the blue curve here shows you the training error and sure enough it just goes down.",
    "start": "497795",
    "end": "503824"
  },
  {
    "text": "Now a lot of times common sense tells you that what you're looking for is the- I guess that's the traditional knee of the curve.",
    "start": "503825",
    "end": "511090"
  },
  {
    "text": "Knee of the curve means something around right here where the marginal improvement it- is not- is not- it- is not good.",
    "start": "511090",
    "end": "519044"
  },
  {
    "text": "Okay. So um, but validation makes this pretty clear. So the red shows you the performance of the model on data it has not seen, okay?",
    "start": "519045",
    "end": "532730"
  },
  {
    "text": "And let's see what that looks like. Well, for order, uh, 0, that's a constant model,",
    "start": "532730",
    "end": "538010"
  },
  {
    "text": "by the way, 1, 2, 3, 4, it's pretty close. Um, and what you see though, is very interesting.",
    "start": "538010",
    "end": "545005"
  },
  {
    "text": "Uh, the sixth order- sixth degree mo- sorry. Seventh degree model is actually- is",
    "start": "545005",
    "end": "552640"
  },
  {
    "text": "actually worse on the test data than the sixth degree. So um, now that's not something you could- you could guess or know.",
    "start": "552640",
    "end": "561225"
  },
  {
    "text": "I mean, you just simply have to try this with the data to- to- to see- to see- to see that. Uh, and it's pretty simp- you know, you can understand why.",
    "start": "561225",
    "end": "567785"
  },
  {
    "text": "And out here, it's like considerably worse, right? So that here, uh, if I fit with a 20 degree polynomial,",
    "start": "567785",
    "end": "574128"
  },
  {
    "text": "I- I have an RMS error, uh, of, you know, 0.2 whatever- 0.21, right?",
    "start": "574129",
    "end": "580350"
  },
  {
    "text": "On the training set. And yet on the, uh, test set, um, almost double that at 0.4, right?",
    "start": "580350",
    "end": "586710"
  },
  {
    "text": "So the old-school rule of thumb might be to say, you know, that- it- it's order- it's degree 6 that has the lowest test error.",
    "start": "586710",
    "end": "595295"
  },
  {
    "text": "But honestly, uh, you know, degree 4 looks pretty good to me too. Uh, and the reason is, it's not a whole lot- uh,",
    "start": "595295",
    "end": "603390"
  },
  {
    "text": "it's on a whole lot worse than that and it's a simpler model. So- okay. So this is the- these- these are very important things.",
    "start": "603390",
    "end": "609350"
  },
  {
    "text": "You're gonna see this in other classes, or you may already have seen in other classes, but you- you will see this in other classes. Let's just leave it that way.",
    "start": "609350",
    "end": "617060"
  },
  {
    "start": "617000",
    "end": "804000"
  },
  {
    "text": "Okay. Now, um, that, ah, validation is also called out-of-sample validation, right?",
    "start": "617060",
    "end": "624265"
  },
  {
    "text": "Um, ah, there are many variations and extensions on it. Um, and I'll just mention one other one, and this is another one,",
    "start": "624265",
    "end": "631420"
  },
  {
    "text": "probably the second most widely used, it might even be the most widely used, called cross-validation.",
    "start": "631420",
    "end": "636820"
  },
  {
    "text": "Um, and it goes like this, I mean, so this is how it, works for- is what you do is you take your original data,",
    "start": "636820",
    "end": "643495"
  },
  {
    "text": "and you divide it into 10 groups. Um, by the way, very often this is done, ah, randomly. So you just- you randomly take your data and assign them to 10 different groups.",
    "start": "643495",
    "end": "652655"
  },
  {
    "text": "Then what you do is the following, um, for- ah, and these are called folds of data.",
    "start": "652655",
    "end": "658950"
  },
  {
    "text": "What you do is, ah, for each, for i equals 1 to 10, you- you fit a model using all the folds except the ith one.",
    "start": "658950",
    "end": "668560"
  },
  {
    "text": "Okay? And then you test that model on the ith fold. And so this is an honest test in the sense that",
    "start": "668560",
    "end": "674980"
  },
  {
    "text": "you are building a model based on some data, and then you are evaluating on data it has never seen,",
    "start": "674980",
    "end": "681265"
  },
  {
    "text": "which is after all, what we want a model to do. So- so here you get 10 different honest tests of your model.",
    "start": "681265",
    "end": "689454"
  },
  {
    "text": "Honest test means you are trying it on data it has never seen. Okay. So this is very common, ah,",
    "start": "689455",
    "end": "696444"
  },
  {
    "text": "five-fold as means you do this and you chop it into five parts, 10-fold. And by the way, there's lots of other methods,",
    "start": "696445",
    "end": "702820"
  },
  {
    "text": "but these are the- these are the kind of ones you might hear about the most. Um, now, it also- it's actually also very good,",
    "start": "702820",
    "end": "709570"
  },
  {
    "text": "ah, sort of engineering, because you get to check- do some commonsense checks. Um, so, [NOISE] you get to see the- what you do is you look at the test RMS errors,",
    "start": "709570",
    "end": "719980"
  },
  {
    "text": "and if they're much bigger than the train RMS errors, it- that's a- that's a red flag. Um, the other thing is you can- you can- you can look and see if the- if",
    "start": "719980",
    "end": "728709"
  },
  {
    "text": "the test and train RMS errors are consistent, um, then that- that allows you to guess with",
    "start": "728710",
    "end": "735490"
  },
  {
    "text": "considerable confidence that it's going to work- that- that model is going to work similarly in the future.",
    "start": "735490",
    "end": "740980"
  },
  {
    "text": "Ah, it's not a guarantee. Um, so I remember once in class I- I asked someb- I remember asking,",
    "start": "740980",
    "end": "747565"
  },
  {
    "text": "ah, I- I said something like, \"Oh, but that would never happen, right? I mean, you're- you're, you know, once you do cross-validation,",
    "start": "747565",
    "end": "753790"
  },
  {
    "text": "your model's going to work, right?\" And there was silence, and then, ah, somebody raised their hand,",
    "start": "753790",
    "end": "759160"
  },
  {
    "text": "and said, \"No, that could happen. You- you could do full cross-validation and- and then all of a sudden your model can work very poorly.",
    "start": "759160",
    "end": "765460"
  },
  {
    "text": "\"And I would say, \"Well, what would you do when the CEO comes into your office and pounds the desk and says,",
    "start": "765460",
    "end": "771370"
  },
  {
    "text": "you know, \"Do you realize what the consequences of this are, blah, blah, blah.\" And, ah, and the student, ah,",
    "start": "771370",
    "end": "776665"
  },
  {
    "text": "looked up and just- and -and the CEO screams, and says, \"What happened? \" And then, ah, the student just looked at me and said, \"Things changed.\"",
    "start": "776665",
    "end": "785214"
  },
  {
    "text": "So, that's simple, right? So if you're making a model of like for advertising or demand of",
    "start": "785214",
    "end": "791259"
  },
  {
    "text": "a product or anything- anything involving kind of people in social systems, in economic systems, of course,",
    "start": "791260",
    "end": "797050"
  },
  {
    "text": "they can change, right? Um, Newtonian mechanics, by the way, doesn't change that often,",
    "start": "797050",
    "end": "802330"
  },
  {
    "text": "but okay, another story. Let's look at an example, and just see how this works.",
    "start": "802330",
    "end": "808180"
  },
  {
    "start": "804000",
    "end": "1052000"
  },
  {
    "text": "So this is a super simple example, right? But nevertheless, it's going to show you how this works.",
    "start": "808180",
    "end": "814630"
  },
  {
    "text": "So this is this really dumb thing where we are going to predict a house price in thousands of dollars based on [NOISE] a mere two features,",
    "start": "814630",
    "end": "822190"
  },
  {
    "text": "which are the area, ah, in thousands of square feet, and the number of bedrooms.",
    "start": "822190",
    "end": "827290"
  },
  {
    "text": "Okay? And we took 774 houses, this is in some place, I forget where,",
    "start": "827290",
    "end": "834670"
  },
  {
    "text": "ah, over some time period, you know, not expanding, you know, like 10- not- not covering ten of years but,",
    "start": "834670",
    "end": "840385"
  },
  {
    "text": "you know, maybe a year or something like that. Um, and that was divided into five folds",
    "start": "840385",
    "end": "846025"
  },
  {
    "text": "of 155 sales each completely rand- at- at just at random. Okay. Then let's look at what we did.",
    "start": "846025",
    "end": "851800"
  },
  {
    "text": "So in the first one, we treat- we removed fold 1, that's 155 houses- house sales.",
    "start": "851800",
    "end": "859389"
  },
  {
    "text": "We removed it, built it on the remaining whatever, 774 minus, ah, 155, so 620 odd.",
    "start": "859390",
    "end": "866709"
  },
  {
    "text": "You know, about 620 things. We- that's how we fit our parameters, of which we have three. By the way, we have the Offset,",
    "start": "866710",
    "end": "873115"
  },
  {
    "text": "we have Beta 1 and, Beta 2. These are very, very elementary simple models, right? Um, okay, and here are the results.",
    "start": "873115",
    "end": "879985"
  },
  {
    "text": "These are my three parameters, ah, that's my training test, and that's my test, ah, sorry,",
    "start": "879985",
    "end": "885655"
  },
  {
    "text": "that is my training RMS error, and that's my test RMS error. This is exactly what you'd expect.",
    "start": "885655",
    "end": "892020"
  },
  {
    "text": "You'd say, whoa, 74, now the test you don't expect it to be as good as the train or whatever, but same ballpark.",
    "start": "892020",
    "end": "898320"
  },
  {
    "text": "Um, so, you see 74 and 78 and you go yeah, that's a- that's good. But if someone says, look,",
    "start": "898320",
    "end": "904459"
  },
  {
    "text": "before we put this model into production, I- I really need to be more confident than just this, right? You know, okay.",
    "start": "904460",
    "end": "910705"
  },
  {
    "text": "So then what you do is in fold 2, we remove a different 155, once it's fold- we remove fold 2,",
    "start": "910705",
    "end": "917560"
  },
  {
    "text": "fit the model. And here's what we get. And, you know, what's kind of cool is the parameters are not the same,",
    "start": "917560",
    "end": "923034"
  },
  {
    "text": "but they're kind of in the same ballpark, which is- which is also a good sign. Here the training RMS error is 75,",
    "start": "923034",
    "end": "931305"
  },
  {
    "text": "which is like okay, this is- by the way, if these were exactly the same, you'd be suspicious, right? You'd say it doesn't look right.",
    "start": "931305",
    "end": "937485"
  },
  {
    "text": "And here, ah, oh, this is interesting, look at that. On the test RMS error on the second model,",
    "start": "937485",
    "end": "945565"
  },
  {
    "text": "ah, is actually better than the training one, and can that happen?",
    "start": "945565",
    "end": "951024"
  },
  {
    "text": "And the answer is sure. And if someone says, \"How did that happen?\" I think the answer would be, \"Luck,\" right?",
    "start": "951025",
    "end": "957100"
  },
  {
    "text": "So basically what happened was you fit a model, you applied it, ah, to, ah,",
    "start": "957100",
    "end": "962635"
  },
  {
    "text": "you may have used it to predict the prices of houses in fold 2, and for whatever reason, that was a set of 155 houses that were- where our model was- is- was reasonably,",
    "start": "962635",
    "end": "973360"
  },
  {
    "text": "ah, good at making the guesses. And so we actually did a little bit better. Ah, and look at it, you know, so you keep- you- you go on,",
    "start": "973360",
    "end": "979750"
  },
  {
    "text": "and you kind of get the idea. Actually, ah, the test set did better a bunch of times. You know, usually this is because there's some hard to fit houses,",
    "start": "979750",
    "end": "988450"
  },
  {
    "text": "and maybe if they land in the training set, that's cool, and if your test set is more benign, you do well, but- but this gives the idea,",
    "start": "988450",
    "end": "994870"
  },
  {
    "text": "and this gives a whole lot of confidence in- in this model, right? And so [NOISE] based on this,",
    "start": "994870",
    "end": "1001529"
  },
  {
    "text": "you would say, um, oh, by the way, based on this, you could go back and refit,",
    "start": "1001530",
    "end": "1007635"
  },
  {
    "text": "based on all the data, right? Ah, or you could just choose any of these. I mean, it wouldn't matter. But the point is that the Offset should be on the order of,",
    "start": "1007635",
    "end": "1015120"
  },
  {
    "text": "I don't know, ah, 55? I mean, I'm just making that up, right? Something like that.",
    "start": "1015120",
    "end": "1020130"
  },
  {
    "text": "Um, Beta 1 clearly should be on the order of, I don't know, 150, ah, Beta 2 is like,",
    "start": "1020130",
    "end": "1026490"
  },
  {
    "text": "you know, I- I don't know, minus 19. I'm just making this up, right? Um, and we could expect a test error that is somewhere in the range of,",
    "start": "1026490",
    "end": "1035295"
  },
  {
    "text": "you know, 70 to high 80s, and perfectly reasonable. We would not be shocked with any of those numbers if- if we use",
    "start": "1035295",
    "end": "1042839"
  },
  {
    "text": "this model to predict housing prices- other houses- house prices, this- this would be sort of our confidence.",
    "start": "1042840",
    "end": "1048225"
  },
  {
    "text": "Okay. So this is just an example of five-fold cross-validation. The last topic we're going to talk about, ah,",
    "start": "1048225",
    "end": "1056505"
  },
  {
    "start": "1052000",
    "end": "1165000"
  },
  {
    "text": "very briefly, ah, is- is, ah, the so-called feature engineering. It's a way you interpret,",
    "start": "1056505",
    "end": "1061634"
  },
  {
    "text": "ah, those basis functions, ah, that we talked about, ah, earlier when we- when we started.",
    "start": "1061634",
    "end": "1067095"
  },
  {
    "text": "And it's also, ah- ah, a very important thing in fitting prediction models, is so-called feature engineering.",
    "start": "1067095",
    "end": "1072450"
  },
  {
    "text": "I'll- I'll show you what that is. Ah, this is just- just- just a hint of what feature engineering is.",
    "start": "1072450",
    "end": "1078450"
  },
  {
    "text": "As, you know, you'll- you will see this in other classes, internships, whatever you're going to see this.",
    "start": "1078450",
    "end": "1084255"
  },
  {
    "text": "So it- it- but this is not a bad time to sort of explain the basic idea. Okay. So basic idea is this,",
    "start": "1084255",
    "end": "1091245"
  },
  {
    "text": "is you'll start with some original or base feature x, right? That's- that's the actual like raw data that you have, right?",
    "start": "1091245",
    "end": "1098250"
  },
  {
    "text": "Um, then, well as- as this whole chapter started, the key was to choose these basis functions.",
    "start": "1098250",
    "end": "1105645"
  },
  {
    "text": "And one way to think of them is that they are mapped or,",
    "start": "1105645",
    "end": "1110790"
  },
  {
    "text": "ah, it's a transformation on the original stuff, and maybe sometimes the transformation is very minimal. For example, in a,",
    "start": "1110790",
    "end": "1117030"
  },
  {
    "text": "ah, regression model- pure regression model, the transformation is we take your original x and we add a new feature,",
    "start": "1117030",
    "end": "1123660"
  },
  {
    "text": "which is one, in front of it. So that- that's very benign, but it can also get real weird and crazy, ah, what you do in- in- in- in these, ah, mappings, right?",
    "start": "1123660",
    "end": "1131385"
  },
  {
    "text": "Um, [NOISE] once you've chosen these, what you do is of course you fit a model, this way.",
    "start": "1131385",
    "end": "1136870"
  },
  {
    "text": "Um, and then, of course, and this is always the case, you check the model using validation.",
    "start": "1136870",
    "end": "1142980"
  },
  {
    "text": "Period. No one wants to hear, you'd say- you'd say, \"How's your model?\" you'd say, \"Oh awesome,\" you know,",
    "start": "1142980",
    "end": "1148409"
  },
  {
    "text": "\"I have this RMS error,\" and they say, so basically it would be expected you would report to another person the test RMS error,",
    "start": "1148410",
    "end": "1156570"
  },
  {
    "text": "or out-of-sample RMS error, or cross-validated RMS error, something like that, right? Not- certainly not the train because no one cares about the training error basically.",
    "start": "1156570",
    "end": "1165465"
  },
  {
    "start": "1165000",
    "end": "1387000"
  },
  {
    "text": "Okay. So I'll just mention a couple of things that people do to transform features.",
    "start": "1165465",
    "end": "1172815"
  },
  {
    "text": "Um, one, and this is very common, now, again, this is not, you know, essential to this course, ah,",
    "start": "1172815",
    "end": "1178170"
  },
  {
    "text": "this is just that we've arrived at a point where you can actually do some like pretty cool stuff. I mean, like actually,",
    "start": "1178170",
    "end": "1184245"
  },
  {
    "text": "very powerful, very cool stuff. Um, one is called standardizing. And that does nothing but take your original features,",
    "start": "1184245",
    "end": "1191039"
  },
  {
    "text": "and then it- it offsets it and scales it. Ah, the idea being that you would like",
    "start": "1191039",
    "end": "1196940"
  },
  {
    "text": "your features to kind of have a range from minus 1 to plus 1. I mean, roughly, right? So that is actually, ah,",
    "start": "1196940",
    "end": "1204545"
  },
  {
    "text": "maybe almost universally done, ah, in- in when you're using these types of models, right?",
    "start": "1204545",
    "end": "1209850"
  },
  {
    "text": "Is you would do that. And these new standardized features are- are- are- are called, I mean, they're approximately standardized.",
    "start": "1209850",
    "end": "1216000"
  },
  {
    "text": "Um, they're called z-scores, not surprisingly, right? And now they're completely interpretable, right?",
    "start": "1216000",
    "end": "1221429"
  },
  {
    "text": "So- so if Z3 equals 0.2, it means that the third feature is a little bit above the mean. That's what it means.",
    "start": "1221430",
    "end": "1231000"
  },
  {
    "text": "If it's minus 2.5, it's surprisingly below the mean, like, ah, kind of a 1  in 100 kind of thing, below the mean.",
    "start": "1231000",
    "end": "1239010"
  },
  {
    "text": "That's all. Um, okay. Here's another trick. If x_i is non-negative and spans a wide range,",
    "start": "1239010",
    "end": "1246795"
  },
  {
    "text": "you replace it with the log of 1 plus x_i. So I- I'll give you a couple of examples of this. Um, well, here's one.",
    "start": "1246795",
    "end": "1253915"
  },
  {
    "text": "Um, well, actually we could start with- uh, here's one. Things like this. Often counts, like the count of how many people",
    "start": "1253915",
    "end": "1261570"
  },
  {
    "text": "listened to a song or how many people bought a product, um, some products have sales measured in like,",
    "start": "1261570",
    "end": "1268559"
  },
  {
    "text": "you know, 5-10, right? Others, you moved like, you know, 350,000 or something like that,",
    "start": "1268560",
    "end": "1275385"
  },
  {
    "text": "and so these- when the- when the x_i's span this huge range like that, it's very common to take a log or log 1 plus x to- to just get the scale right.",
    "start": "1275385",
    "end": "1285585"
  },
  {
    "text": "Right. So that's a- that's a- that's extremely common in this and that- that's- that's just a log transform.",
    "start": "1285585",
    "end": "1292395"
  },
  {
    "text": "Um, you can create new features, um, by- er as functions of the existing features.",
    "start": "1292395",
    "end": "1300180"
  },
  {
    "text": "Now, we've already seen that because that's one way to think of what a polyno- what a polynomial thing does, right? In a- in a polynom- when we do polynomial fit,",
    "start": "1300180",
    "end": "1308070"
  },
  {
    "text": "the raw feature is a single- is a scalar, it's a- it's a number. Then we tran- you can think of it,",
    "start": "1308070",
    "end": "1313890"
  },
  {
    "text": "we transform it, right? You know, F_1 gives you 1, F_2, gives you x, F_3 gives you x squared,",
    "start": "1313890",
    "end": "1320640"
  },
  {
    "text": "that's like a transform, then x cubed and so on. So that- that's how you think of a polynomial er,",
    "start": "1320640",
    "end": "1326220"
  },
  {
    "text": "model, but you can do other cool ones like here's one, is you take- here I'm taking the first raw feature,",
    "start": "1326220",
    "end": "1332880"
  },
  {
    "text": "[NOISE] I subtract B, and I take the max of that and 0, and so I get a kind of a cool thing.",
    "start": "1332880",
    "end": "1339405"
  },
  {
    "text": "So here's- here's b, and so it just simply looks like this, right? It's, uh- it's the max,",
    "start": "1339405",
    "end": "1345810"
  },
  {
    "text": "it's this function here. It goes there, and then- and then there, right? And so this new feature,",
    "start": "1345810",
    "end": "1352275"
  },
  {
    "text": "if x_1 is less than b, it's just 0, right? Above b gives you the amount by which it's above b,",
    "start": "1352275",
    "end": "1358695"
  },
  {
    "text": "and that's a- that's a- that's, er- we call that the high feature, right? Now, by the way,",
    "start": "1358695",
    "end": "1364935"
  },
  {
    "text": "this is useful to do in conjunction with standardiza- standardization. So if you do standardization,",
    "start": "1364935",
    "end": "1370245"
  },
  {
    "text": "a- a good number for b might be 1 or 1.5,",
    "start": "1370245",
    "end": "1375270"
  },
  {
    "text": "and you'd say that's a feature which is almost always 0, but basically what it does is it tells you the amount by which",
    "start": "1375270",
    "end": "1380820"
  },
  {
    "text": "b is real- the fea- the original feature is really large, and you can do the same thing with min. I won't- I won't talk about that so- now we'll do an example,",
    "start": "1380820",
    "end": "1390559"
  },
  {
    "start": "1387000",
    "end": "1565000"
  },
  {
    "text": "um, and, you know, we're going to predict house prices, and, you know, it's a- [NOISE] it's, you know,",
    "start": "1390560",
    "end": "1396529"
  },
  {
    "text": "this is a very simple thing, but I'll- I'll- I'll start with the raw, the base features.",
    "start": "1396530",
    "end": "1401940"
  },
  {
    "text": "So the base features we have about- we have four. Um I should say that, you know, when people actually predict house prices,",
    "start": "1401940",
    "end": "1408150"
  },
  {
    "text": "it's not based on four raw features, it's based on hundreds and hundreds, right? Just tones of stuff, right?",
    "start": "1408150",
    "end": "1413715"
  },
  {
    "text": "So these are highly simplified, but at least this model will not be as, ah- as- as extremely simple as the other",
    "start": "1413715",
    "end": "1420240"
  },
  {
    "text": "one where we were predicting it based on the house area, you know, and the number of bedrooms, okay? So- okay. So here it is,",
    "start": "1420240",
    "end": "1426465"
  },
  {
    "text": "x_1 is the area of the house in thousand square feet, x_2 is the number of bedrooms, x_3 is what people would call a Boolean feature.",
    "start": "1426465",
    "end": "1433905"
  },
  {
    "text": "So it's either got the value 1, means that that's a condo, actually,",
    "start": "1433905",
    "end": "1438975"
  },
  {
    "text": "a condominium, 0 means it's a house. Um, x_4 is the zip code.",
    "start": "1438975",
    "end": "1444299"
  },
  {
    "text": "Now, that's- that's, uh- that's interesting, right? So it's a five digit integer.",
    "start": "1444300",
    "end": "1449565"
  },
  {
    "text": "It's a, it's a zip code, um, and it- there are 62 different zip codes, okay?",
    "start": "1449565",
    "end": "1454890"
  },
  {
    "text": "So x_4 is, again you don't need to know this, but it's what you call a categorical feature,",
    "start": "1454890",
    "end": "1460890"
  },
  {
    "text": "meaning it only takes a finite number of values, in this case 62 different zip codes. Okay. So we'll do,",
    "start": "1460890",
    "end": "1467910"
  },
  {
    "text": "er, we'll use eight basis functions. Er, I'll say a little bit about, you know, how do you come up- how do you do this?",
    "start": "1467910",
    "end": "1473505"
  },
  {
    "text": "Oh, by the way, the act of taking raw features and coming up with these- these feature mappings are basis functions f_i,",
    "start": "1473505",
    "end": "1480405"
  },
  {
    "text": "that's called feature engineering and is probably one of the- it's- it's like in someone- in some sense that's- that's sort of the essence of building models.",
    "start": "1480405",
    "end": "1488580"
  },
  {
    "text": "Okay. So we'll use f_1 of x equals one. That's a constant, that's an offset feature. F_2 is x_1, which I believe is just the area of the house.",
    "start": "1488580",
    "end": "1496665"
  },
  {
    "text": "F_3 is interesting. It's the max of x_1 minus 1.5 and 0. So f_3 is a feature that is the number of thousand square feet",
    "start": "1496665",
    "end": "1505245"
  },
  {
    "text": "by which your house area exceeds 1,500 square feet, that's what x_3 is. So x- that is indeed what x_3- er, sorry.",
    "start": "1505245",
    "end": "1513765"
  },
  {
    "text": "Yes, the- the f_3 of x is that, but the transformed feature is,",
    "start": "1513765",
    "end": "1519030"
  },
  {
    "text": "I guess we call that x-tilde_3 anyway, whatever it is. Um, so it tells you that- so it's 0 for small houses and for big houses might be big.",
    "start": "1519030",
    "end": "1526590"
  },
  {
    "text": "Okay. Um, f_4 is simply gonna be the number of bedrooms,",
    "start": "1526590",
    "end": "1531900"
  },
  {
    "text": "um, f_5 is gonna- so these are very simple encod- encodings or feature mappings or engineering, right?",
    "start": "1531900",
    "end": "1537510"
  },
  {
    "text": "So I'll just use- I'll just use the Boolean as it is. Um f_ 6,7 and 8, they're boolean,",
    "start": "1537510",
    "end": "1544730"
  },
  {
    "text": "so they're either 0 or 1, and what they're gonna do is they'll encode four groups of near- of zip codes.",
    "start": "1544730",
    "end": "1549755"
  },
  {
    "text": "So in other words we take the 62 values of zip codes, we divide that into four, like, neighborhoods, and then what will happen is each of these",
    "start": "1549755",
    "end": "1557909"
  },
  {
    "text": "[NOISE] will be 0 or 1 and that'll encode which neighborhood you live in. Okay, we do five-fold model validation,",
    "start": "1557910",
    "end": "1565799"
  },
  {
    "text": "and here are the results. Um, so we have, uh, eight parameters in- in this- in- in this model.",
    "start": "1565800",
    "end": "1572850"
  },
  {
    "text": "It's slightly, you know, it's a bit more complicated, and here are the- so the first thing you do is pretty cool.",
    "start": "1572850",
    "end": "1578730"
  },
  {
    "text": "The first thing we should do is look at this table here. Um, so the- you scan down the train thing,",
    "start": "1578730",
    "end": "1585330"
  },
  {
    "text": "and you get different training RMS errors, so like 67, you know, up to 70,",
    "start": "1585330",
    "end": "1591299"
  },
  {
    "text": "and that's- that's good, um, okay, and you look at the test. The cool thing is that the test is,",
    "start": "1591300",
    "end": "1597720"
  },
  {
    "text": "it's not hideously off from the train. It's in the same ballpark, a little bit bigger, for sure a little bit bigger, right?",
    "start": "1597720",
    "end": "1604530"
  },
  {
    "text": "Like look at that guy right there. Um, of course, there's- here's a time when you were super lucky, um, but the point is it's in the same ballpark,",
    "start": "1604530",
    "end": "1612645"
  },
  {
    "text": "and so I think what this would tell you is that you- this model- I could refit the model on",
    "start": "1612645",
    "end": "1617700"
  },
  {
    "text": "all the data and I could make a pretty good guess that for houses you have never analyzed,",
    "start": "1617700",
    "end": "1623519"
  },
  {
    "text": "you're gonna get probably around an RMS error of about 70, whatever it is, run- on the order of 70, okay?",
    "start": "1623520",
    "end": "1630810"
  },
  {
    "text": "So um, that's, uh- that- that's what this shows. Uh, you can also look at the coefficients and you'll- and what",
    "start": "1630810",
    "end": "1637410"
  },
  {
    "text": "you see is- is actually kind of encouraging. It- it basically says that the coefficients [NOISE] are what people call stable.",
    "start": "1637410",
    "end": "1644190"
  },
  {
    "text": "In other words that, uh, you know, looking at different folds of the data, you don't get exactly the same parameters,",
    "start": "1644190",
    "end": "1650535"
  },
  {
    "text": "of course, but they're, you know, they're kind of stable. Like, you know, yeah, just take a look at this one, you'd say, well, okay,",
    "start": "1650535",
    "end": "1657225"
  },
  {
    "text": "that's- that's- there's no true value of Theta 7 there, that's ridiculous, right?",
    "start": "1657225",
    "end": "1662565"
  },
  {
    "text": "But the point is this says that we consistently assign a value of around, I don't know,",
    "start": "1662565",
    "end": "1668370"
  },
  {
    "text": "minus 109 or 8 or something like that to- to to Theta- Theta 7 , okay?",
    "start": "1668370",
    "end": "1674715"
  },
  {
    "text": "So this is the- this is the basic idea, and this would show you how you might do it in- in some real setting. Now in a real setting you would- it's probably much more",
    "start": "1674715",
    "end": "1681330"
  },
  {
    "text": "complicated and you wouldn't have eight parameters, you could easily have 800 or 8000 parameters.",
    "start": "1681330",
    "end": "1687270"
  },
  {
    "text": "Um, oh, one last thing is you could reasonably ask, like, how did you come up with this?",
    "start": "1687270",
    "end": "1694305"
  },
  {
    "text": "Like, and I'll- and here I'm just gonna tell you the truth, um, by fiddling around, okay?",
    "start": "1694305",
    "end": "1699705"
  },
  {
    "text": "So that's how it was done. You just try to- well, you try couplings. Oh, very important point about that,",
    "start": "1699705",
    "end": "1705885"
  },
  {
    "text": "which is a part that you do- we do not apologize for, and that's this, um,",
    "start": "1705885",
    "end": "1710895"
  },
  {
    "text": "you might try 50, 100 different weird candidates. Like for example over here.",
    "start": "1710895",
    "end": "1716970"
  },
  {
    "text": "Why 1.5? Why not one? Why not 0.5? Why not two? Um, so the way you do that is, you just try it.",
    "start": "1716970",
    "end": "1725325"
  },
  {
    "text": "You build it, and then you do five-fold cross-validation, and you see which- which of your 50 different attempted models",
    "start": "1725325",
    "end": "1734040"
  },
  {
    "text": "has the best five-fold test error or simply the best test error out of sample, and that's your candidate.",
    "start": "1734040",
    "end": "1740399"
  },
  {
    "text": "So in this sense you let the data tell you which model is the right one, right?",
    "start": "1740400",
    "end": "1745575"
  },
  {
    "text": "And by the way, if it's not a who- if it's not a whole lot better than this much simpler model, you kinda go with the simpler model, right?",
    "start": "1745575",
    "end": "1752370"
  },
  {
    "text": "So I didn't mention that, but I do wanna mention that somewhere about now. Here you can see that we're getting test errors in the 58-70 range, it's fine, right?",
    "start": "1752370",
    "end": "1761565"
  },
  {
    "text": "But let's go back and look at our really simple model over here. Here you go, and here's what you see.",
    "start": "1761565",
    "end": "1768255"
  },
  {
    "text": "These numbers are definitely larger, period, right? So, um- so our other conclusion from this analysis is",
    "start": "1768255",
    "end": "1776700"
  },
  {
    "text": "that all of this feature engineering that we did here, uh, actually did something.",
    "start": "1776700",
    "end": "1782190"
  },
  {
    "text": "We came up with a better model. Uh, so now, whether or not this is sufficiently better to justify this crazy, um,",
    "start": "1782190",
    "end": "1789630"
  },
  {
    "text": "model is another story, um, and I guess that story depends on what you're gonna do, right?",
    "start": "1789630",
    "end": "1795360"
  },
  {
    "text": "In some applications it's important that the model will be simple because you have to explain it to somebody,",
    "start": "1795360",
    "end": "1801095"
  },
  {
    "text": "for example, possibly a regulator or somebody like that who, you know, needs to know: what are you doing and how are you doing this?",
    "start": "1801095",
    "end": "1807304"
  },
  {
    "text": "Um or, uh, to take another example, it could just be like some crazy hedge fund where you-",
    "start": "1807305",
    "end": "1814520"
  },
  {
    "text": "I couldn't care- I couldn't care in the slightest what the- what the model means.",
    "start": "1814520",
    "end": "1819980"
  },
  {
    "text": "What you- what you're interested in is, does it make good predictions of the way prices are going to move?",
    "start": "1819980",
    "end": "1826120"
  },
  {
    "text": "And if it does, we'll use the model, and we don't care what it means. So there are lots of variations on that.",
    "start": "1826120",
    "end": "1832540"
  }
]