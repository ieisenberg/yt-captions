[
  {
    "text": "We're now going to look at solving linear equations,",
    "start": "4250",
    "end": "7440"
  },
  {
    "text": "systems of linear equations.",
    "start": "7440",
    "end": "10000"
  },
  {
    "text": "So we'll start with something called back substitution.",
    "start": "10130",
    "end": "14565"
  },
  {
    "text": "The name will become clear, uh, shortly.",
    "start": "14565",
    "end": "16904"
  },
  {
    "text": "So here is the idea.",
    "start": "16905",
    "end": "18090"
  },
  {
    "text": "Uh, we have a matrix R,",
    "start": "18090",
    "end": "20265"
  },
  {
    "text": "it's upper triangular with non-zero diagonal entries.",
    "start": "20265",
    "end": "22800"
  },
  {
    "text": "Now, that means that R is invertible.",
    "start": "22800",
    "end": "24734"
  },
  {
    "text": "We've already discussed that.",
    "start": "24735",
    "end": "26220"
  },
  {
    "text": "Um, and so we're going to write out the equation Rx equals b,",
    "start": "26220",
    "end": "30250"
  },
  {
    "text": "uh, and of course, what we're actually calculating here, if we're going to solve for x,",
    "start": "30250",
    "end": "33860"
  },
  {
    "text": "is we have x equals R inverse b. I can write this because R is invertible,",
    "start": "33860",
    "end": "38750"
  },
  {
    "text": "because it's upper triangular with,",
    "start": "38750",
    "end": "41190"
  },
  {
    "text": "uh- with- with non-zero diagonal entries.",
    "start": "41190",
    "end": "43695"
  },
  {
    "text": "Okay. So I'm gonna write out- write this out, uh, in scalars.",
    "start": "43695",
    "end": "47895"
  },
  {
    "text": "And this is basically- R is upper triangular, so it looks like this.",
    "start": "47895",
    "end": "50870"
  },
  {
    "text": "It's R_11 x_1 plus R_12 x_2, and so on.",
    "start": "50870",
    "end": "53635"
  },
  {
    "text": "That's the first equation.",
    "start": "53635",
    "end": "54890"
  },
  {
    "text": "And the first equation, notice,",
    "start": "54890",
    "end": "56180"
  },
  {
    "text": "involves all the variables,",
    "start": "56180",
    "end": "57875"
  },
  {
    "text": "x_1, x_2, x_3, all the way up to x_n.",
    "start": "57875",
    "end": "60370"
  },
  {
    "text": "The second equation, by the way,",
    "start": "60370",
    "end": "62735"
  },
  {
    "text": "involves only the variables x_2,",
    "start": "62735",
    "end": "64940"
  },
  {
    "text": "x_3, x_4, up to x_n.",
    "start": "64940",
    "end": "66815"
  },
  {
    "text": "That's because it's upper triangular.",
    "start": "66815",
    "end": "68390"
  },
  {
    "text": "Um, and the last equation,",
    "start": "68390",
    "end": "70385"
  },
  {
    "text": "let's write down here.",
    "start": "70385",
    "end": "71675"
  },
  {
    "text": "Pretty simple. It simply only involves x_n, right?",
    "start": "71675",
    "end": "75725"
  },
  {
    "text": "The penultimate equation only involves x_n minus 1 and x_n.",
    "start": "75725",
    "end": "79205"
  },
  {
    "text": "Now, let's- what we want to do and we want to calculate x.",
    "start": "79205",
    "end": "82890"
  },
  {
    "text": "We want to basically solve for x.",
    "start": "82890",
    "end": "84500"
  },
  {
    "text": "So let's start from the last equation.",
    "start": "84500",
    "end": "87050"
  },
  {
    "text": "From the last equation you see R_nn x_n equals bn.",
    "start": "87050",
    "end": "90540"
  },
  {
    "text": "Now, these are just numbers, right?",
    "start": "90540",
    "end": "92100"
  },
  {
    "text": "Oh, and not only that, and this is critical,",
    "start": "92100",
    "end": "94020"
  },
  {
    "text": "we know that R_nn is not 0.",
    "start": "94020",
    "end": "96759"
  },
  {
    "text": "And so that tells us immediately that we just divide and we get",
    "start": "96760",
    "end": "100115"
  },
  {
    "text": "x_n equals bn over R_nn. Now we know x_n.",
    "start": "100115",
    "end": "104330"
  },
  {
    "text": "Okay. Now, from the second to last equation,",
    "start": "104330",
    "end": "108425"
  },
  {
    "text": "let's focus on that one.",
    "start": "108425",
    "end": "110000"
  },
  {
    "text": "Um, it says R_n minus 1,",
    "start": "110000",
    "end": "112220"
  },
  {
    "text": "n minus 1 x _n minus 1 plus R_n minus 1 x_n equals n. And- but you know what we know x_n.",
    "start": "112220",
    "end": "117440"
  },
  {
    "text": "And so what we're gonna do is we're going to take",
    "start": "117440",
    "end": "119450"
  },
  {
    "text": "this equation and we're going to write x_n is the right-hand side,",
    "start": "119450",
    "end": "124229"
  },
  {
    "text": "bn minus 1, minus this part.",
    "start": "124230",
    "end": "126210"
  },
  {
    "text": "Now, we already know that part, this thing,",
    "start": "126210",
    "end": "128149"
  },
  {
    "text": "because we just calculated x_n,",
    "start": "128150",
    "end": "130319"
  },
  {
    "text": "uh, divided by R_n minus 1, R_n minus 1.",
    "start": "130320",
    "end": "132505"
  },
  {
    "text": "And again, we can do that because R_n minus 1 comma n minus 1",
    "start": "132505",
    "end": "136400"
  },
  {
    "text": "is a diagonal entry of R and it's assumed to be non-zero. So I get x_n.",
    "start": "136400",
    "end": "140739"
  },
  {
    "text": "And then basically, we just continue this.",
    "start": "140740",
    "end": "143385"
  },
  {
    "text": "Uh, we- now we know after this step we know x_n and we know x_n minus 1.",
    "start": "143385",
    "end": "148325"
  },
  {
    "text": "Now we get x_n minus 2 and x_n minus 3,",
    "start": "148325",
    "end": "151175"
  },
  {
    "text": "and eventually we end up with x_1.",
    "start": "151175",
    "end": "153130"
  },
  {
    "text": "Okay? Uh, so it's called back substitution for the obvious reason,",
    "start": "153130",
    "end": "157370"
  },
  {
    "text": "because, we're going backwards.",
    "start": "157370",
    "end": "158989"
  },
  {
    "text": "We're- we're first calculating x_n and then substituting in known values into the,",
    "start": "158990",
    "end": "163780"
  },
  {
    "text": "uh- the formulas and then, uh,",
    "start": "163780",
    "end": "166015"
  },
  {
    "text": "just analytically working out what,",
    "start": "166015",
    "end": "167740"
  },
  {
    "text": "uh- what the various x's are in backward order.",
    "start": "167740",
    "end": "170465"
  },
  {
    "text": "Okay. Um, so this is the idea,",
    "start": "170465",
    "end": "173575"
  },
  {
    "text": "and it's going to compute x equals R_n inverse b.",
    "start": "173575",
    "end": "176110"
  },
  {
    "text": "So we now have a perfectly good way to do that.",
    "start": "176110",
    "end": "179630"
  },
  {
    "text": "Let's talk about the complexity.",
    "start": "179630",
    "end": "181305"
  },
  {
    "text": "Like how long does this take?",
    "start": "181305",
    "end": "182625"
  },
  {
    "text": "Well, the first step is,",
    "start": "182625",
    "end": "184455"
  },
  {
    "text": "uh, well, you have to divide- it's,",
    "start": "184455",
    "end": "185850"
  },
  {
    "text": "you know- it's whatever it is,",
    "start": "185850",
    "end": "186880"
  },
  {
    "text": "it's bn divided by R_nn.",
    "start": "186880",
    "end": "188980"
  },
  {
    "text": "That's one flop, one division.",
    "start": "188980",
    "end": "190504"
  },
  {
    "text": "Now, the second step,",
    "start": "190505",
    "end": "192175"
  },
  {
    "text": "and the second step is over here.",
    "start": "192175",
    "end": "193600"
  },
  {
    "text": "Let's see what we've got to do. We've got to multiply,",
    "start": "193600",
    "end": "195820"
  },
  {
    "text": "uh, these two numbers.",
    "start": "195820",
    "end": "197560"
  },
  {
    "text": "We've gotta do a subtraction and then maybe a division.",
    "start": "197560",
    "end": "200260"
  },
  {
    "text": "So maybe that's three flops, uh, here.",
    "start": "200260",
    "end": "203120"
  },
  {
    "text": "Okay, so the second step needs three flops and the- the ith,",
    "start": "203120",
    "end": "207045"
  },
  {
    "text": "you know, the third step needs five flops,",
    "start": "207045",
    "end": "209700"
  },
  {
    "text": "then seven, and so on.",
    "start": "209700",
    "end": "211605"
  },
  {
    "text": "And so the total is going to be 1 plus 3 plus 5 plus 7,",
    "start": "211605",
    "end": "215430"
  },
  {
    "text": "all the way up to 2n minus 1.",
    "start": "215430",
    "end": "217290"
  },
  {
    "text": "And it's a- it's a famous identity, uh,",
    "start": "217290",
    "end": "221094"
  },
  {
    "text": "that tells you that the sum of the first 2n minus- what- the first-",
    "start": "221095",
    "end": "224915"
  },
  {
    "text": "the sum of odd numbers up to 2n minus 1 is just n squared.",
    "start": "224915",
    "end": "229189"
  },
  {
    "text": "Um, so- and you can check that.",
    "start": "229190",
    "end": "231290"
  },
  {
    "text": "It's easy enough, but we may even, uh,",
    "start": "231290",
    "end": "233780"
  },
  {
    "text": "explain how you figure that out in the book or something like that, anyway.",
    "start": "233780",
    "end": "237575"
  },
  {
    "text": "Um, it's- it's- it's actually not too hard to show.",
    "start": "237575",
    "end": "240530"
  },
  {
    "text": "Um, so it's going to cost you n squared flops,",
    "start": "240530",
    "end": "244010"
  },
  {
    "text": "uh, to actually do back substitution.",
    "start": "244010",
    "end": "247135"
  },
  {
    "text": "Um, by the way, it's the same order as matrix vector multiply, uh, right.",
    "start": "247135",
    "end": "251000"
  },
  {
    "text": "So if you multiply a matrix,",
    "start": "251000",
    "end": "252500"
  },
  {
    "text": "n by n matrix by a vector,",
    "start": "252500",
    "end": "254150"
  },
  {
    "text": "yeah, it's around n-squared.",
    "start": "254150",
    "end": "255500"
  },
  {
    "text": "Maybe it's 2n squared flops, something like that.",
    "start": "255500",
    "end": "257480"
  },
  {
    "text": "So back substitution is in the same order as that.",
    "start": "257480",
    "end": "260590"
  },
  {
    "text": "Okay. Now, uh- it turns out now we can solve linear equations via QR factorization.",
    "start": "260590",
    "end": "267055"
  },
  {
    "text": "Um, so let's start with a- a matrix a that's invertible,",
    "start": "267055",
    "end": "270500"
  },
  {
    "text": "so it's squared and we're going to solve,",
    "start": "270500",
    "end": "272480"
  },
  {
    "text": "uh, Ax equals b,",
    "start": "272480",
    "end": "273800"
  },
  {
    "text": "which means to compute x equals A inverse b. Um,",
    "start": "273800",
    "end": "277925"
  },
  {
    "text": "so we start with the QR factorization of A. Um,",
    "start": "277925",
    "end": "281580"
  },
  {
    "text": "A has independent columns because it's invertible.",
    "start": "281580",
    "end": "283830"
  },
  {
    "text": "So the QR factorization completes and we write it as A equals QR, Q is square.",
    "start": "283830",
    "end": "288800"
  },
  {
    "text": "It's an orthogonal matrix,",
    "start": "288800",
    "end": "290240"
  },
  {
    "text": "meaning it's square and its columns are orthonormal.",
    "start": "290240",
    "end": "293349"
  },
  {
    "text": "You know, by the way, so are its rows.",
    "start": "293350",
    "end": "294800"
  },
  {
    "text": "Uh, and then R. R is an upper triangular matrix with positive diagonal entries,",
    "start": "294800",
    "end": "300185"
  },
  {
    "text": "and therefore, it's invertible.",
    "start": "300185",
    "end": "301585"
  },
  {
    "text": "So A is a product of two invertible matrices.",
    "start": "301585",
    "end": "304229"
  },
  {
    "text": "And so the inverse, first of all,",
    "start": "304230",
    "end": "305720"
  },
  {
    "text": "number 1, we conclude A is invertible.",
    "start": "305720",
    "end": "308165"
  },
  {
    "text": "Number 1, number 2,",
    "start": "308165",
    "end": "309500"
  },
  {
    "text": "its inverse is the product is the- a product of the inverses of the multiplicans,",
    "start": "309500",
    "end": "314795"
  },
  {
    "text": "uh, in reverse order.",
    "start": "314795",
    "end": "316020"
  },
  {
    "text": "Uh, so A inverse is going to be QR inverse,",
    "start": "316020",
    "end": "319370"
  },
  {
    "text": "and that's going to be R inverse times Q inverse,",
    "start": "319370",
    "end": "321979"
  },
  {
    "text": "but Q inverse is Q transpose.",
    "start": "321980",
    "end": "323795"
  },
  {
    "text": "So, um- so that's it.",
    "start": "323795",
    "end": "326180"
  },
  {
    "text": "So what we do then is,",
    "start": "326180",
    "end": "328100"
  },
  {
    "text": "now we know how to do it,",
    "start": "328100",
    "end": "329180"
  },
  {
    "text": "because what we can do is we're going to compute this.",
    "start": "329180",
    "end": "332930"
  },
  {
    "text": "Uh, we're gonna compute x by back substitution.",
    "start": "332930",
    "end": "335180"
  },
  {
    "text": "First, we're going to multiply by Q transpose b.",
    "start": "335180",
    "end": "337639"
  },
  {
    "text": "We know how to do matrix vector multiplication.",
    "start": "337640",
    "end": "339710"
  },
  {
    "text": "And then to compute x equals R_n inverse Q transpose b,",
    "start": "339710",
    "end": "343550"
  },
  {
    "text": "we use back substitution, right?",
    "start": "343550",
    "end": "345740"
  },
  {
    "text": "So that's kind of the idea.",
    "start": "345740",
    "end": "347360"
  },
  {
    "text": "So here's the algorithm written out as some pseudocode.",
    "start": "347360",
    "end": "350914"
  },
  {
    "text": "It works like this.",
    "start": "350915",
    "end": "352535"
  },
  {
    "text": "Um, a pseudocode, it works like this.",
    "start": "352535",
    "end": "355110"
  },
  {
    "text": "We're going to- we're- we're given an- an n by n invertible matrix A and an n-vector b.",
    "start": "355110",
    "end": "359564"
  },
  {
    "text": "The first thing is you do QR factorization.",
    "start": "359565",
    "end": "362535"
  },
  {
    "text": "Um, that costs us, uh- well, we'll get to that.",
    "start": "362535",
    "end": "365340"
  },
  {
    "text": "That's 2n cubed flops roughly.",
    "start": "365340",
    "end": "368055"
  },
  {
    "text": "Uh, then we calculate Q transpose b.",
    "start": "368055",
    "end": "370949"
  },
  {
    "text": "Uh, that's a matrix vector multiply.",
    "start": "370950",
    "end": "373020"
  },
  {
    "text": "Um, and then finally,",
    "start": "373020",
    "end": "374310"
  },
  {
    "text": "we call back substitution on- on this system of equations.",
    "start": "374310",
    "end": "377710"
  },
  {
    "text": "We can do that because R is upper triangular",
    "start": "377710",
    "end": "380824"
  },
  {
    "text": "with non-zero diagonal elements and that's using back substitution.",
    "start": "380825",
    "end": "384860"
  },
  {
    "text": "So step 1 here costs,",
    "start": "384860",
    "end": "387555"
  },
  {
    "text": "uh, 2n cubed flops.",
    "start": "387555",
    "end": "389610"
  },
  {
    "text": "Step 2, that's a matrix-vector multiply,",
    "start": "389610",
    "end": "391759"
  },
  {
    "text": "that's 2n squared, and the last one,",
    "start": "391760",
    "end": "394010"
  },
  {
    "text": "back substitution is n squared.",
    "start": "394010",
    "end": "396505"
  },
  {
    "text": "Um, and so the total- what you see immediately is when you add these up,",
    "start": "396505",
    "end": "401195"
  },
  {
    "text": "um, steps 2 and 3 cost, very little.",
    "start": "401195",
    "end": "405315"
  },
  {
    "text": "Um, in fact, they're negligible,",
    "start": "405315",
    "end": "407145"
  },
  {
    "text": "um, because we're imagining n to be large.",
    "start": "407145",
    "end": "409115"
  },
  {
    "text": "I mean, we're not thinking n10,",
    "start": "409115",
    "end": "410495"
  },
  {
    "text": "were thinking n100, 1,000, 10,000.",
    "start": "410495",
    "end": "412955"
  },
  {
    "text": "And what it turns out is that steps 2 and 3 are actually",
    "start": "412955",
    "end": "415789"
  },
  {
    "text": "negligible because they're proportional- their order is n squared,",
    "start": "415790",
    "end": "419690"
  },
  {
    "text": "and the first step is just this QR factorization.",
    "start": "419690",
    "end": "422240"
  },
  {
    "text": "So what it means is that",
    "start": "422240",
    "end": "424039"
  },
  {
    "text": "the real cost of solving linear equations is this QR factorization,",
    "start": "424040",
    "end": "427790"
  },
  {
    "text": "which can be calculated by the Gram-Schmidt algorithm.",
    "start": "427790",
    "end": "430970"
  },
  {
    "text": "Okay. So by the way,",
    "start": "430970",
    "end": "432260"
  },
  {
    "text": "uh, this- at this point,",
    "start": "432260",
    "end": "433460"
  },
  {
    "text": "the Gram-Schmidt algorithm should be looking a lot more interesting.",
    "start": "433460",
    "end": "437014"
  },
  {
    "text": "Uh, earlier in the course,",
    "start": "437015",
    "end": "439175"
  },
  {
    "text": "Gram-Schmidt algorithm was nothing but an al- a",
    "start": "439175",
    "end": "442069"
  },
  {
    "text": "numerical algorithm that tells you whether a set of vectors is linearly independent.",
    "start": "442070",
    "end": "446200"
  },
  {
    "text": "Now, what we see is it can be used to solve equations,",
    "start": "446200",
    "end": "451249"
  },
  {
    "text": "linear- systems of linear equations.",
    "start": "451249",
    "end": "453169"
  },
  {
    "text": "And that's great because that's already a whole lot of",
    "start": "453170",
    "end": "455360"
  },
  {
    "text": "applications this can be done, uh, this way.",
    "start": "455360",
    "end": "458034"
  },
  {
    "text": "So the total complexity,",
    "start": "458035",
    "end": "459735"
  },
  {
    "text": "altogether, is the second and third are completely negligible,",
    "start": "459735",
    "end": "462539"
  },
  {
    "text": "uh, that when you're doing a flop count,",
    "start": "462540",
    "end": "464270"
  },
  {
    "text": "you would ignore, uh, something proportional to n squared compared to n cubed.",
    "start": "464270",
    "end": "467419"
  },
  {
    "text": "So it's basically 2n cubed, uh,",
    "start": "467420",
    "end": "470010"
  },
  {
    "text": "is- is what the cost of solving,",
    "start": "470010",
    "end": "472830"
  },
  {
    "text": "um, Ax equals b is for A in an n by n matrix.",
    "start": "472830",
    "end": "476955"
  },
  {
    "text": "Um, and I'll give you some rough,",
    "start": "476955",
    "end": "478379"
  },
  {
    "text": "uh, ideas about this.",
    "start": "478380",
    "end": "479520"
  },
  {
    "text": "Let's, uh- oh, let's- let's do this.",
    "start": "479520",
    "end": "482550"
  },
  {
    "text": "Let's solve Ax equals b with A, a 1000 by 1000 matrix.",
    "start": "482550",
    "end": "489330"
  },
  {
    "text": "Okay. So, um, first of all,",
    "start": "489330",
    "end": "492449"
  },
  {
    "text": "that is a- they would appear to be,",
    "start": "492450",
    "end": "494220"
  },
  {
    "text": "at least to a person,",
    "start": "494220",
    "end": "495520"
  },
  {
    "text": "that looks like a pretty big set of linear equations.",
    "start": "495520",
    "end": "498259"
  },
  {
    "text": "It's- we have 1000 variables, x1, x2, x3,",
    "start": "498260",
    "end": "501500"
  },
  {
    "text": "up to x1000, number 1,",
    "start": "501500",
    "end": "503045"
  },
  {
    "text": "and we have a thousand equations in them, right?",
    "start": "503045",
    "end": "505430"
  },
  {
    "text": "So altogether, the matrix A,",
    "start": "505430",
    "end": "507500"
  },
  {
    "text": "which are the coefficients in a system of linear equations,",
    "start": "507500",
    "end": "509810"
  },
  {
    "text": "has a million numbers in it.",
    "start": "509810",
    "end": "511460"
  },
  {
    "text": "I mean, I can make it sound like super,",
    "start": "511460",
    "end": "514580"
  },
  {
    "text": "you know, complicated and big.",
    "start": "514580",
    "end": "516604"
  },
  {
    "text": "Uh, I can solve this in one tenth of a second on my laptop which is five years old.",
    "start": "516605",
    "end": "524154"
  },
  {
    "text": "Okay, so that is just absolutely stunning, right?",
    "start": "524155",
    "end": "529635"
  },
  {
    "text": "It- it- it's stun- and in fact,",
    "start": "529635",
    "end": "531080"
  },
  {
    "text": "that's a very interesting part about this class, right?",
    "start": "531080",
    "end": "533870"
  },
  {
    "text": "Is that- is that we- we do these things,",
    "start": "533870",
    "end": "536720"
  },
  {
    "text": "but they're actually like fully actionable and you can solve a whole lot bigger-",
    "start": "536720",
    "end": "539509"
  },
  {
    "text": "and it's a lot faster on other types of hardware.",
    "start": "539510",
    "end": "542375"
  },
  {
    "text": "Like on a GPU or something like that.",
    "start": "542375",
    "end": "544340"
  },
  {
    "text": "It's very, very fast.",
    "start": "544340",
    "end": "546005"
  },
  {
    "text": "Um, but these are just stunning speeds, uh,",
    "start": "546005",
    "end": "549490"
  },
  {
    "text": "that- so we can solve giant sets of equations,",
    "start": "549490",
    "end": "552495"
  },
  {
    "text": "uh, this way. Okay. Uh-",
    "start": "552495",
    "end": "555214"
  },
  {
    "text": "The next thing we're gonna talk about is actually solving",
    "start": "555215",
    "end": "557875"
  },
  {
    "text": "multiple sets of linear equations.",
    "start": "557875",
    "end": "560290"
  },
  {
    "text": "Ah, and it's gonna come back to this idea that of",
    "start": "560290",
    "end": "562509"
  },
  {
    "text": "the three steps required to solve Ax equals b,",
    "start": "562510",
    "end": "565630"
  },
  {
    "text": "it's only the QR factorization of the coefficient matrix that actually costs anything,",
    "start": "565630",
    "end": "570880"
  },
  {
    "text": "the others, I mean, they cost something in terms of flops,",
    "start": "570880",
    "end": "573415"
  },
  {
    "text": "but they're negligible compared to the first step.",
    "start": "573415",
    "end": "575695"
  },
  {
    "text": "So [NOISE] what that means is this,",
    "start": "575695",
    "end": "578575"
  },
  {
    "text": "it's a situation where we're going to solve Axi equals b_i,",
    "start": "578575",
    "end": "582475"
  },
  {
    "text": "i equals 1 to k. So I'm gonna call- I'm gonna solve k systems of linear equations,",
    "start": "582475",
    "end": "588625"
  },
  {
    "text": "um, with an invertible,",
    "start": "588625",
    "end": "590035"
  },
  {
    "text": "and- so the right-hand sides are different.",
    "start": "590035",
    "end": "592810"
  },
  {
    "text": "I have b_1, b_2,",
    "start": "592810",
    "end": "594040"
  },
  {
    "text": "b_3 up to bk,",
    "start": "594040",
    "end": "595570"
  },
  {
    "text": "um, and of course the solutions are different.",
    "start": "595570",
    "end": "597280"
  },
  {
    "text": "That's x1, x2, x3.",
    "start": "597280",
    "end": "599200"
  },
  {
    "text": "Um, but the coefficient matrix a is the same for all of them.",
    "start": "599200",
    "end": "602125"
  },
  {
    "text": "And so what we do is,",
    "start": "602125",
    "end": "603835"
  },
  {
    "text": "we're gonna be smart and we're gonna carry out the qr factorization just once, okay?",
    "start": "603835",
    "end": "608830"
  },
  {
    "text": "And then the only thing we're gonna repeat, um,",
    "start": "608830",
    "end": "612400"
  },
  {
    "text": "is- we're gonna repeat for each back- right-hand side, uh,",
    "start": "612400",
    "end": "616195"
  },
  {
    "text": "we're gonna actually do the back substitution and multiplication by Q transpose, right?",
    "start": "616195",
    "end": "620980"
  },
  {
    "text": "That- that's n squared, uh, flops.",
    "start": "620980",
    "end": "623545"
  },
  {
    "text": "Um, and so the total is 2n cubed plus 3k n squared flops.",
    "start": "623545",
    "end": "628430"
  },
  {
    "text": "And what you see is pretty stunning that as long as k is, like,",
    "start": "628430",
    "end": "632730"
  },
  {
    "text": "small, it's- it basically is still completely negligible.",
    "start": "632730",
    "end": "636945"
  },
  {
    "text": "And this just completely weird and insane.",
    "start": "636945",
    "end": "639210"
  },
  {
    "text": "This is one of the first things that- that,",
    "start": "639210",
    "end": "641040"
  },
  {
    "text": "you know, is kinda shocking.",
    "start": "641040",
    "end": "643014"
  },
  {
    "text": "So basically what it says is,",
    "start": "643015",
    "end": "644935"
  },
  {
    "text": "oh, let's take my laptop.",
    "start": "644935",
    "end": "646255"
  },
  {
    "text": "Suppose I ask you to solve Axi equals b_i for i equals 1 up to 10.",
    "start": "646255",
    "end": "656290"
  },
  {
    "text": "Okay. So I wanna go to- I wanna do 10,",
    "start": "656290",
    "end": "658630"
  },
  {
    "text": "I wanna- I wanna solve 10 systems of linear equations.",
    "start": "658630",
    "end": "662035"
  },
  {
    "text": "And A is 1,000 by 1,000.",
    "start": "662035",
    "end": "663745"
  },
  {
    "text": "And we already discussed that.",
    "start": "663745",
    "end": "665005"
  },
  {
    "text": "We found out that I can solve this in about a tenth of a second on my laptop.",
    "start": "665005",
    "end": "669190"
  },
  {
    "text": "Fine. No, sorry. I can solve one of them in a tenth of a second.",
    "start": "669190",
    "end": "673345"
  },
  {
    "text": "Okay. So the naive method would be to just",
    "start": "673345",
    "end": "676569"
  },
  {
    "text": "simply solve this 10 times and that would give me 10 times a tenth of a second,",
    "start": "676570",
    "end": "680800"
  },
  {
    "text": "which is one second.",
    "start": "680800",
    "end": "682315"
  },
  {
    "text": "Okay. Um, but in fact,",
    "start": "682315",
    "end": "684715"
  },
  {
    "text": "what this says is if I'm smart,",
    "start": "684715",
    "end": "686485"
  },
  {
    "text": "I only have to- the only one I- I- I- I do- let's go back here.",
    "start": "686485",
    "end": "689935"
  },
  {
    "text": "I do step 1 once.",
    "start": "689935",
    "end": "691900"
  },
  {
    "text": "And then it's step 2 and 3 that I repeat 10 times.",
    "start": "691900",
    "end": "695005"
  },
  {
    "text": "But the point is that- that the- it's the,",
    "start": "695005",
    "end": "696835"
  },
  {
    "text": "what people would say is that the first step dominates,",
    "start": "696835",
    "end": "699309"
  },
  {
    "text": "meaning it's much- it takes much more time to carry out the first step.",
    "start": "699309",
    "end": "703015"
  },
  {
    "text": "And so what we conclude here is that I can solve,",
    "start": "703015",
    "end": "707320"
  },
  {
    "text": "uh- you know, someone walks up to you and says,",
    "start": "707320",
    "end": "709000"
  },
  {
    "text": "\"Help me solve one set of linear equations 1,000 by 1,000.\" I go,",
    "start": "709000",
    "end": "711745"
  },
  {
    "text": "\"No problem, tenth of a second.\"",
    "start": "711745",
    "end": "713455"
  },
  {
    "text": "And they go, \"Cool.",
    "start": "713455",
    "end": "714775"
  },
  {
    "text": "I'd like to solve now 10- 10 systems of linear equations, same coefficient matrix.",
    "start": "714775",
    "end": "719215"
  },
  {
    "text": "How long is that going to take?\"",
    "start": "719215",
    "end": "720340"
  },
  {
    "text": "And you would normally think, well a second.",
    "start": "720340",
    "end": "722290"
  },
  {
    "text": "And the actual answer is 0.1 seconds. It's the same.",
    "start": "722290",
    "end": "726610"
  },
  {
    "text": "So- and that is- you can make the crazy statement,",
    "start": "726610",
    "end": "729339"
  },
  {
    "text": "as a practical matter,",
    "start": "729340",
    "end": "730600"
  },
  {
    "text": "I can solve 10 systems of linear equations,",
    "start": "730600",
    "end": "733255"
  },
  {
    "text": "1,000 by 1,000, in basically the same time it takes me to solve one.",
    "start": "733255",
    "end": "736990"
  },
  {
    "text": "Okay. So that is weird.",
    "start": "736990",
    "end": "740005"
  },
  {
    "text": "I mean, unexpected, but, you know,",
    "start": "740005",
    "end": "741580"
  },
  {
    "text": "all- once you know all the parts,",
    "start": "741580",
    "end": "742960"
  },
  {
    "text": "it- it all- it all makes perfect sense.",
    "start": "742960",
    "end": "745945"
  },
  {
    "text": "Okay. What we're gonna do now is look at it just a couple of very simple examples.",
    "start": "745945",
    "end": "751210"
  },
  {
    "text": "Uh, there are many- many- many others.",
    "start": "751210",
    "end": "752920"
  },
  {
    "text": "Um, but let's take a look at them.",
    "start": "752920",
    "end": "754930"
  },
  {
    "text": "Um, the first one is in polynomial interpolation.",
    "start": "754930",
    "end": "757660"
  },
  {
    "text": "So what we'll do is we're going to represent a polynomial,",
    "start": "757660",
    "end": "760660"
  },
  {
    "text": "that's P of x, it's a polynomial of one variable, scalar variable x.",
    "start": "760660",
    "end": "764290"
  },
  {
    "text": "And I'm going to write it as c_1 plus c_2 x plus c_2- c_3 x squared plus c_4 x cubed.",
    "start": "764290",
    "end": "769720"
  },
  {
    "text": "Okay? So it's a- it's a quartic, No, it's a cubic,",
    "start": "769720",
    "end": "772420"
  },
  {
    "text": "sorry it's a cubic polynomial it has four coefficients,",
    "start": "772420",
    "end": "775510"
  },
  {
    "text": "four because it also has the constant coefficients.",
    "start": "775510",
    "end": "777640"
  },
  {
    "text": "So c_1 is the x_0 coefficient,",
    "start": "777640",
    "end": "780550"
  },
  {
    "text": "c_2 as the x_one coefficient, and so on.",
    "start": "780550",
    "end": "783430"
  },
  {
    "text": "Okay. And what I'll do,",
    "start": "783430",
    "end": "785274"
  },
  {
    "text": "is I'm going to represent, um,",
    "start": "785275",
    "end": "787540"
  },
  {
    "text": "the coefficient- of the polynomial,",
    "start": "787540",
    "end": "789415"
  },
  {
    "text": "its coefficients as a four-vector c. Okay.",
    "start": "789415",
    "end": "792370"
  },
  {
    "text": "So when you see a four-vector,",
    "start": "792370",
    "end": "794200"
  },
  {
    "text": "now, it's going to represent a polynomial.",
    "start": "794200",
    "end": "796270"
  },
  {
    "text": "Okay. And What I wanna do is I want to",
    "start": "796270",
    "end": "799330"
  },
  {
    "text": "find a cubic polynomial that satisfies these conditions.",
    "start": "799330",
    "end": "803485"
  },
  {
    "text": "Um, so when you evaluate it at minus 1.1, you should get b_1.",
    "start": "803485",
    "end": "807565"
  },
  {
    "text": "When you evaluate it at minus 0.40, you should get b_2.",
    "start": "807565",
    "end": "810550"
  },
  {
    "text": "At 0.1, you should get b_3,",
    "start": "810550",
    "end": "812515"
  },
  {
    "text": "and at a, you should get b_4.",
    "start": "812515",
    "end": "814210"
  },
  {
    "text": "And b_1 through b_4 are numbers that I have not yet specified.",
    "start": "814210",
    "end": "817435"
  },
  {
    "text": "Okay? So- oh, and by the way,",
    "start": "817435",
    "end": "819190"
  },
  {
    "text": "this is called polynomial interpolation because what it means",
    "start": "819190",
    "end": "821620"
  },
  {
    "text": "is you want the plot of the polynomial,",
    "start": "821620",
    "end": "824770"
  },
  {
    "text": "the curve of the polynomial when you draw it,",
    "start": "824770",
    "end": "826870"
  },
  {
    "text": "it should go through specific points.",
    "start": "826870",
    "end": "828370"
  },
  {
    "text": "So it should go through the point minus 1.1,  b.",
    "start": "828370",
    "end": "831745"
  },
  {
    "text": "Okay. So that's called interpolation when you go through these interpolation points.",
    "start": "831745",
    "end": "836440"
  },
  {
    "text": "Okay. Now, we can write these interpolation conditions as,",
    "start": "836440",
    "end": "841644"
  },
  {
    "text": "uh- well, as just a set of linear equations.",
    "start": "841644",
    "end": "843925"
  },
  {
    "text": "It's ac equals b.",
    "start": "843925",
    "end": "845410"
  },
  {
    "text": "Okay. And to check that,",
    "start": "845410",
    "end": "847480"
  },
  {
    "text": "you would put c_1, uh, you know,",
    "start": "847480",
    "end": "850779"
  },
  {
    "text": "c_2, c_3, and c_4 here, right?",
    "start": "850780",
    "end": "854275"
  },
  {
    "text": "And- and see if this is what it's supposed to be.",
    "start": "854275",
    "end": "858340"
  },
  {
    "text": "Uh, okay.",
    "start": "858340",
    "end": "860335"
  },
  {
    "text": "I mean that's not a equals,",
    "start": "860335",
    "end": "861460"
  },
  {
    "text": "I'll just get rid of that. There we go.",
    "start": "861460",
    "end": "862855"
  },
  {
    "text": "Okay so let's see if this faithfully gives you these interpolation conditions.",
    "start": "862855",
    "end": "867324"
  },
  {
    "text": "Well, if you look at- if you go across this first row and with these coefficients,",
    "start": "867325",
    "end": "872605"
  },
  {
    "text": "what you will find is that you are about- this first row,",
    "start": "872605",
    "end": "875769"
  },
  {
    "text": "uh, of- of the product is actually evaluating p at",
    "start": "875770",
    "end": "879340"
  },
  {
    "text": "the point minus 1.1. h but that should be b_1,",
    "start": "879340",
    "end": "882940"
  },
  {
    "text": "and sure enough, that's the right-hand side.",
    "start": "882940",
    "end": "884605"
  },
  {
    "text": "So- so this is correct.",
    "start": "884605",
    "end": "886029"
  },
  {
    "text": "So these- these polynomial interpolation conditions, uh,",
    "start": "886030",
    "end": "889720"
  },
  {
    "text": "basically, uh, I write as a set of four by four,",
    "start": "889720",
    "end": "893199"
  },
  {
    "text": "uh, linear, uh, equations.",
    "start": "893200",
    "end": "895660"
  },
  {
    "text": "A system of linear equations. Uh, yeah.",
    "start": "895660",
    "end": "898464"
  },
  {
    "text": "By the way, this would be exactly- even though this is like,",
    "start": "898465",
    "end": "901375"
  },
  {
    "text": "it's from a computer's point of view,",
    "start": "901375",
    "end": "903070"
  },
  {
    "text": "this is pathetically small.",
    "start": "903070",
    "end": "904405"
  },
  {
    "text": "This is already way bigger than what any human being should do,",
    "start": "904405",
    "end": "907000"
  },
  {
    "text": "like so- well, it's too late now.",
    "start": "907000",
    "end": "909310"
  },
  {
    "text": "But if you had classes before where people, you know,",
    "start": "909310",
    "end": "911770"
  },
  {
    "text": "tortured you by solving like three by three sets of linear systems,",
    "start": "911770",
    "end": "915130"
  },
  {
    "text": "that was really, in my opinion,",
    "start": "915130",
    "end": "916480"
  },
  {
    "text": "a complete waste of time, and four-by-four would be off-scale.",
    "start": "916480",
    "end": "918730"
  },
  {
    "text": "So could you do this by hand using some kind of high-school method,",
    "start": "918730",
    "end": "922135"
  },
  {
    "text": "you know, whatever it is, Gaussian elimination?",
    "start": "922135",
    "end": "924025"
  },
  {
    "text": "Well, you could, but it wouldn't be fun and",
    "start": "924025",
    "end": "926200"
  },
  {
    "text": "it's a complete waste of time, I should add that also.",
    "start": "926200",
    "end": "928345"
  },
  {
    "text": "Okay. So poly- this- if we solve this set of equations,",
    "start": "928345",
    "end": "932379"
  },
  {
    "text": "we will get the coefficients.",
    "start": "932380",
    "end": "933940"
  },
  {
    "text": "Um, okay.",
    "start": "933940",
    "end": "935230"
  },
  {
    "text": "And in fact, we can even say this c is equal",
    "start": "935230",
    "end": "938305"
  },
  {
    "text": "to A inverse b. I should say a couple of things.",
    "start": "938305",
    "end": "941785"
  },
  {
    "text": "This matrix has a name, uh, now,",
    "start": "941785",
    "end": "943579"
  },
  {
    "text": "a matrix whose rows consist of a number to the 0,",
    "start": "943580",
    "end": "946990"
  },
  {
    "text": "number to the 1, 2,",
    "start": "946990",
    "end": "948190"
  },
  {
    "text": "3 up to certain powers,",
    "start": "948190",
    "end": "949510"
  },
  {
    "text": "it's called a Vandermonde matrix,",
    "start": "949510",
    "end": "951175"
  },
  {
    "text": "named after a mathematician named Vandermonde.",
    "start": "951175",
    "end": "953320"
  },
  {
    "text": "Um, and it is invertible.",
    "start": "953320",
    "end": "954955"
  },
  {
    "text": "Uh, and it's invertible because these- these numbers were all different.",
    "start": "954955",
    "end": "959425"
  },
  {
    "text": "Right. So that's- that's actually the condition.",
    "start": "959425",
    "end": "961225"
  },
  {
    "text": "I haven't shown that, uh, but that's the case.",
    "start": "961225",
    "end": "963399"
  },
  {
    "text": "That's the idea. Okay. So I get-",
    "start": "963400",
    "end": "966685"
  },
  {
    "text": "this is just a compact formula that tells me these are the- you know,",
    "start": "966685",
    "end": "970570"
  },
  {
    "text": "you tell me what you want- where you want",
    "start": "970570",
    "end": "972790"
  },
  {
    "text": "your polynomial to go through over these four points,",
    "start": "972790",
    "end": "975235"
  },
  {
    "text": "and I'll tell you what the coefficients are.",
    "start": "975235",
    "end": "977079"
  },
  {
    "text": "So that's how that works. Okay. Um, so here, we got a inverse,",
    "start": "977080",
    "end": "982450"
  },
  {
    "text": "uh, this is to four significant figures.",
    "start": "982450",
    "end": "984430"
  },
  {
    "text": "I mean, obviously, there- there's more- more than this, but here it is.",
    "start": "984430",
    "end": "987279"
  },
  {
    "text": "The A inverse is this matrix here.",
    "start": "987280",
    "end": "989050"
  },
  {
    "text": "Um, and you look at it and you think,",
    "start": "989050",
    "end": "990580"
  },
  {
    "text": "wow, well, okay, whatever.",
    "start": "990580",
    "end": "992710"
  },
  {
    "text": "Uh, so if you multiply this matrix by this matrix here,",
    "start": "992710",
    "end": "998020"
  },
  {
    "text": "uh, you will get something close to the identity, actually,",
    "start": "998020",
    "end": "1001515"
  },
  {
    "text": "because I have only given the other ones to four significant figures,",
    "start": "1001515",
    "end": "1004035"
  },
  {
    "text": "you'd- you'd get numbers on the diagonals like",
    "start": "1004035",
    "end": "1005970"
  },
  {
    "text": "0.99999 and- and the off-diagonal entries would be super small, right?",
    "start": "1005970",
    "end": "1010785"
  },
  {
    "text": "Okay, so here's a inverse.",
    "start": "1010785",
    "end": "1012884"
  },
  {
    "text": "Um, and let's see what it is.",
    "start": "1012885",
    "end": "1015300"
  },
  {
    "text": "What's the interpretation of A inverse?",
    "start": "1015300",
    "end": "1016920"
  },
  {
    "text": "Well, A inverse, uh,",
    "start": "1016920",
    "end": "1019695"
  },
  {
    "text": "and entries of A inverse map b,",
    "start": "1019695",
    "end": "1023024"
  },
  {
    "text": "these are the- the values that you're- that you're,",
    "start": "1023024",
    "end": "1025694"
  },
  {
    "text": "uh- that- that your polynomial should take at these four points into the coefficients.",
    "start": "1025695",
    "end": "1029564"
  },
  {
    "text": "And so, for example,",
    "start": "1029565",
    "end": "1030659"
  },
  {
    "text": "we would notice that, um,",
    "start": "1030660",
    "end": "1032535"
  },
  {
    "text": "that- these are- these are like the smallest entries in the whole matrix.",
    "start": "1032535",
    "end": "1037005"
  },
  {
    "text": "And what it says is, let's interpret that.",
    "start": "1037005",
    "end": "1039329"
  },
  {
    "text": "So over here, I would put b and then this would give me the",
    "start": "1039330",
    "end": "1042240"
  },
  {
    "text": "c. This would give me c. And so what this means is,",
    "start": "1042240",
    "end": "1045780"
  },
  {
    "text": "I can say that the first coefficient is not very sensitive to what b_1 or b_4 is.",
    "start": "1045780",
    "end": "1051015"
  },
  {
    "text": "Okay. Well, who knew? But it's true.",
    "start": "1051015",
    "end": "1053625"
  },
  {
    "text": "That's what this says. Another interesting thing",
    "start": "1053625",
    "end": "1056370"
  },
  {
    "text": "is to- is to actually interpret the columns.",
    "start": "1056370",
    "end": "1059190"
  },
  {
    "text": "Right. Columns are super interesting,",
    "start": "1059190",
    "end": "1061889"
  },
  {
    "text": "like, let's figure out what the first column means.",
    "start": "1061890",
    "end": "1064230"
  },
  {
    "text": "So here's the first column. What does it mean?",
    "start": "1064230",
    "end": "1066585"
  },
  {
    "text": "Well, that column is if I multiply A inverse by e_1, I get the first column.",
    "start": "1066585",
    "end": "1072284"
  },
  {
    "text": "That's true for any matrix.",
    "start": "1072285",
    "end": "1073785"
  },
  {
    "text": "Um, ah, but wait a minute,",
    "start": "1073785",
    "end": "1075510"
  },
  {
    "text": "e_1 are the values that that polynomial should take.",
    "start": "1075510",
    "end": "1079290"
  },
  {
    "text": "And that says that the first- the first column gives you",
    "start": "1079290",
    "end": "1083040"
  },
  {
    "text": "the coefficients of a polynomial that satisfies this.",
    "start": "1083040",
    "end": "1086580"
  },
  {
    "text": "At minus 1.1, it's 1.",
    "start": "1086580",
    "end": "1088200"
  },
  {
    "text": "At minus 0.4, it's 0, 0, 0.",
    "start": "1088200",
    "end": "1090284"
  },
  {
    "text": "This is like e_1, the right-hand side.",
    "start": "1090285",
    "end": "1092535"
  },
  {
    "text": "Okay. Now, that's got a name, uh,",
    "start": "1092535",
    "end": "1095670"
  },
  {
    "text": "a polynomial that is equal to one at a specified value and 0 at- at other values,",
    "start": "1095670",
    "end": "1102300"
  },
  {
    "text": "that's called the Lagrange polynomial.",
    "start": "1102300",
    "end": "1104430"
  },
  {
    "text": "Um, and it's literally the coefficients of the,",
    "start": "1104430",
    "end": "1107010"
  },
  {
    "text": "uh- of- of the coefficients of the- it's-",
    "start": "1107010",
    "end": "1110525"
  },
  {
    "text": "that appear in the column of the inverse of this Vandermonde matrix.",
    "start": "1110525",
    "end": "1114410"
  },
  {
    "text": "Okay. And here's an example.",
    "start": "1114410",
    "end": "1116940"
  },
  {
    "text": "Um, and what we're showing you here is,",
    "start": "1116940",
    "end": "1120470"
  },
  {
    "text": "uh, a couple of these.",
    "start": "1120470",
    "end": "1121630"
  },
  {
    "text": "So first of all, this is us um,",
    "start": "1121630",
    "end": "1124020"
  },
  {
    "text": "so- solving this for a couple of,",
    "start": "1124020",
    "end": "1125415"
  },
  {
    "text": "uh- for- for a couple of different cases.",
    "start": "1125415",
    "end": "1127180"
  },
  {
    "text": "This is minus 1.1.",
    "start": "1127180",
    "end": "1128680"
  },
  {
    "text": "And so, for example,",
    "start": "1128680",
    "end": "1129820"
  },
  {
    "text": "if you specify these values,",
    "start": "1129820",
    "end": "1131719"
  },
  {
    "text": "um, you know, this one, this one, this one,",
    "start": "1131719",
    "end": "1134340"
  },
  {
    "text": "and this one, you'll get the polynomial,",
    "start": "1134340",
    "end": "1135960"
  },
  {
    "text": "it would go right through- uh,",
    "start": "1135960",
    "end": "1138220"
  },
  {
    "text": "it'll go right through those points because we've constructed it that way.",
    "start": "1138220",
    "end": "1141205"
  },
  {
    "text": "So that's the idea. Um, here are the Lagrange, uh, polynomials.",
    "start": "1141205",
    "end": "1144990"
  },
  {
    "text": "So, um, here's the first Lagrange polynomial uh,",
    "start": "1144990",
    "end": "1149530"
  },
  {
    "text": "associated with these points here.",
    "start": "1149530",
    "end": "1152140"
  },
  {
    "text": "Um, and let's see how that works.",
    "start": "1152140",
    "end": "1154210"
  },
  {
    "text": "Well, uh, what it says is that you have 1e,",
    "start": "1154210",
    "end": "1158304"
  },
  {
    "text": "uh, and, you have 1 and 0.",
    "start": "1158305",
    "end": "1161000"
  },
  {
    "text": "And so this first polynomial looks like that. It's a cubic.",
    "start": "1161000",
    "end": "1163435"
  },
  {
    "text": "And sure enough, look at that,",
    "start": "1163435",
    "end": "1164650"
  },
  {
    "text": "at minus 1.1, it's 1.",
    "start": "1164650",
    "end": "1166330"
  },
  {
    "text": "At minus 0.4, it's 0.",
    "start": "1166330",
    "end": "1168865"
  },
  {
    "text": "It's again 0 at 0.2 and also at 0.8.",
    "start": "1168865",
    "end": "1172355"
  },
  {
    "text": "Here's the second Lagrange polynomial.",
    "start": "1172355",
    "end": "1174605"
  },
  {
    "text": "Lagrange polynomial associated with these points is this.",
    "start": "1174605",
    "end": "1177520"
  },
  {
    "text": "Uh, it's 0 at minus 1.1.",
    "start": "1177520",
    "end": "1180130"
  },
  {
    "text": "At minus 0.8, it is- minus 0.4, I'm sorry,",
    "start": "1180130",
    "end": "1183540"
  },
  {
    "text": "it's one, uh, it is point- it's again 0 at 0.2 and also 0.8.",
    "start": "1183540",
    "end": "1188600"
  },
  {
    "text": "So these are the Lagrange polynomials, okay?",
    "start": "1188600",
    "end": "1191440"
  },
  {
    "text": "So- and these are- each one has coefficients",
    "start": "1191440",
    "end": "1193779"
  },
  {
    "text": "associated with the columns of the inverse of A.",
    "start": "1193780",
    "end": "1197630"
  }
]