[
  {
    "start": "0",
    "end": "6240"
  },
  {
    "text": "Hi, everyone. So while the others\njoin, let me get started.",
    "start": "6240",
    "end": "11760"
  },
  {
    "text": "I will make some\nannouncements and then I will hand it over to\nKedar who will be delivering the majority of the\nlecture, and then",
    "start": "11760",
    "end": "18600"
  },
  {
    "text": "I will come back at the very\nend for a end of class thing.",
    "start": "18600",
    "end": "24170"
  },
  {
    "text": "Right, so today's talk\nis on video compression by our guest speaker, Kedar\nTatwawadi, just introducing.",
    "start": "24170",
    "end": "32240"
  },
  {
    "text": " So Kedar did his PhD from\nStanford under the guidance",
    "start": "32240",
    "end": "40850"
  },
  {
    "text": "of Professor [? Saki ?]\n[? Weissman ?] in 2020. He has since worked\nin WaveOne, which",
    "start": "40850",
    "end": "47239"
  },
  {
    "text": "was a startup focusing\non compressing videos, and he is currently in Apple.",
    "start": "47240",
    "end": "53973"
  },
  {
    "text": "You have heard his\nname many, many times throughout the class. He was the one who basically\ngave birth to this class",
    "start": "53973",
    "end": "61160"
  },
  {
    "text": "and to the Stanford\nCompression Library, and then Pulkit\nand I tagged along.",
    "start": "61160",
    "end": "66290"
  },
  {
    "text": "And he has been a friend and\nmentor to both me and Pulkit, so very excited about this.",
    "start": "66290",
    "end": "72950"
  },
  {
    "text": "Without further ado, please. Right, thank you all for\ncoming, and thanks, Shubham,",
    "start": "72950",
    "end": "79850"
  },
  {
    "text": "for the introduction. Yeah, so I think\nso today's lecture,",
    "start": "79850",
    "end": "85340"
  },
  {
    "text": "we are going to discuss\nvideo compression. Until now in the\ncourse, you have looked at various\nmodalities, starting",
    "start": "85340",
    "end": "92180"
  },
  {
    "text": "from lossless compression of\ntext, log files, genomic data, and so on.",
    "start": "92180",
    "end": "97549"
  },
  {
    "text": "You also looked at\nimage compression. I believe there was a\nhomework on a question which",
    "start": "97550",
    "end": "103190"
  },
  {
    "text": "we designed for the JPEG style\ncompression in the homework four.",
    "start": "103190",
    "end": "108230"
  },
  {
    "text": "Hopefully, you have\nalso looked at that. And so we are just\ngoing to build upon all that knowledge\ntowards the final frontier,",
    "start": "108230",
    "end": "115820"
  },
  {
    "text": "and probably the\nmost important one in compression, which is\nvideo compression, right?",
    "start": "115820",
    "end": "121310"
  },
  {
    "text": "So today's talk will be\nslightly more higher level, but let me know if there\nare specific questions and I can go into more\ndetails about a few things.",
    "start": "121310",
    "end": "131420"
  },
  {
    "text": "All right, so let\nme get started.  Yeah, OK, so I think no\none needs any introduction",
    "start": "131420",
    "end": "140330"
  },
  {
    "text": "to this slide. Everyone knows that video\nis growing and innovating. And just based on the amount\nof video which I consume daily,",
    "start": "140330",
    "end": "148860"
  },
  {
    "text": "I mean, the amount of YouTube\nand Netflix and so on which I myself watch, it's\njust crazy how much",
    "start": "148860",
    "end": "157680"
  },
  {
    "text": "the amount of video being\ngenerated, consumed. And these are numbers\nfrom a few years back, so it just tells us\nthat the amount of data which",
    "start": "157680",
    "end": "166290"
  },
  {
    "text": "we have is just incredible. And of course, that's one\nof the reasons why we really",
    "start": "166290",
    "end": "172830"
  },
  {
    "text": "need video compression to\nwork quite well, all right?",
    "start": "172830",
    "end": "178320"
  },
  {
    "text": "OK, so just to give a sense of\nthe video compression or video codecs out there, so you might\nhave heard about these terms",
    "start": "178320",
    "end": "187340"
  },
  {
    "text": "here or these codecs here,\nH.264, H.265, VP9 and so on.",
    "start": "187340",
    "end": "192360"
  },
  {
    "text": "So these are different\ncompression algorithms or compression\nstandards for video.",
    "start": "192360",
    "end": "197990"
  },
  {
    "text": "H.264 is actually the most\ncommon one which you would see. So if you are typically\nencoding or typically having",
    "start": "197990",
    "end": "204590"
  },
  {
    "text": "a video anywhere, most\nlikely it is going to be encoded using H.264.",
    "start": "204590",
    "end": "210416"
  },
  {
    "text": "H.264 is today around\n15 to 20 years old, but it's still widely used\njust because, I mean, it",
    "start": "210416",
    "end": "216847"
  },
  {
    "text": "is reasonable. At the same time,\nit's something which is supported on almost\nall the devices, right?",
    "start": "216847",
    "end": "222440"
  },
  {
    "text": "And so these are basically\ndifferent generations. H.265 is the newer\none which came maybe",
    "start": "222440",
    "end": "227720"
  },
  {
    "text": "around five to 10 years back. And H.266 is something which\nis in active development,",
    "start": "227720",
    "end": "232910"
  },
  {
    "text": "so you might not have H.266\ntoday on your devices yet, but it's something\nwhich is being added.",
    "start": "232910",
    "end": "242360"
  },
  {
    "text": "So this is basically\na set of video codecs. And the goal is,\nobviously, to take a video",
    "start": "242360",
    "end": "247700"
  },
  {
    "text": "and convert it to bits, right? So that's the goal. And today, we are going to try\nto understand how they really",
    "start": "247700",
    "end": "253430"
  },
  {
    "text": "work. OK, so one thing which I\nwanted to actually just to emphasize that how\nimportant video compression is.",
    "start": "253430",
    "end": "261350"
  },
  {
    "text": "I mean, the thing is that\nvideo compression is, first, so important today.",
    "start": "261350",
    "end": "266780"
  },
  {
    "text": "And at the same time\nit's so intensive that video codecs have been--\nboth encoding and decoding",
    "start": "266780",
    "end": "272840"
  },
  {
    "text": "have been put on silicon. So people have put in\nthe effort and the money to put a reasonably small\nbut still quite important",
    "start": "272840",
    "end": "282560"
  },
  {
    "text": "media engine. For example, this is a\nsnapshot from the M2 chip which Apple has, where, I\nmean, part of the chip",
    "start": "282560",
    "end": "292370"
  },
  {
    "text": "has a portion which does video\nencoding, video decoding, and so on. So it just tells us how\nimportant video compression is,",
    "start": "292370",
    "end": "299840"
  },
  {
    "text": "and at the same time,\nalso how costly it is because video\nencoding, decoding",
    "start": "299840",
    "end": "306440"
  },
  {
    "text": "does take a bit of an\neffort on your machine, and so putting it on\nsilicon is something which",
    "start": "306440",
    "end": "312500"
  },
  {
    "text": "is what makes it tractable. And so there have been n\nnumber of PhDs on this,",
    "start": "312500",
    "end": "317570"
  },
  {
    "text": "just to make the video codec\nwork, but at the same time, I mean, optimize it\nto every millisecond",
    "start": "317570",
    "end": "324770"
  },
  {
    "text": "and so on, and then run\nit on chips and so on. So we are not going to discuss\nthis aspect of the codec,",
    "start": "324770",
    "end": "331382"
  },
  {
    "text": "trying to keep it\nhigh level today. But definitely, there\nis a lot of literature out there if you want to try to\nunderstand how video codecs are",
    "start": "331382",
    "end": "339140"
  },
  {
    "text": "implemented on chips and make\nit to make them run efficiently and so on, right?",
    "start": "339140",
    "end": "346260"
  },
  {
    "text": "All right, so OK, so\nlet's try to understand how video compression works. But even before then,\nlet's go to the basics.",
    "start": "346260",
    "end": "353670"
  },
  {
    "text": "What do we actually\nmean by a video? And the answer is quite simple. I mean, I assume\neveryone knows this.",
    "start": "353670",
    "end": "360960"
  },
  {
    "text": "But the way in which we\ninterpret video or one way to think about the\nvideo is that it's",
    "start": "360960",
    "end": "366180"
  },
  {
    "text": "a sequence of frames\nor images, right? So it's a sequence of images\nwhich we have captured, and that's where\nthe name comes from,",
    "start": "366180",
    "end": "373080"
  },
  {
    "text": "motion pictures, and\npictures and motion in a way. And so this is basically a set\nof sequence of images which",
    "start": "373080",
    "end": "381660"
  },
  {
    "text": "is what we want to compress. Now, this is something which\nI found quite interesting when",
    "start": "381660",
    "end": "388110"
  },
  {
    "text": "I was preparing for\nthis lecture last year, which was that, actually,\nthe first video was captured",
    "start": "388110",
    "end": "393270"
  },
  {
    "text": "on Stanford's campus, and it\nwas Leland Stanford's Horse. You might have seen this\nvideo or image at some point,",
    "start": "393270",
    "end": "401370"
  },
  {
    "text": "and really, they call it a\nvideo but it was basically a few images of a horse,\nmaybe 12 images or something",
    "start": "401370",
    "end": "408880"
  },
  {
    "text": "which they clicked. And the reason for\nthis video capture was to really know\nif horses' legs are",
    "start": "408880",
    "end": "415660"
  },
  {
    "text": "in the air for a fraction\nof a second or not. I mean, that was\nthe first video,",
    "start": "415660",
    "end": "421180"
  },
  {
    "text": "so it's nice that we are\nhaving this talk at Stanford given the history. ",
    "start": "421180",
    "end": "428080"
  },
  {
    "text": "OK, so let's take a\nlook at, I mean, what-- so this is just a sample\nvideo which we will",
    "start": "428080",
    "end": "437610"
  },
  {
    "text": "work with during the lecture. I mean, if you look at, it's a\njockey video, again, a horse.",
    "start": "437610",
    "end": "445110"
  },
  {
    "text": "Just given the history, we are\ngoing to take a horse video and try to compress it. Now, whenever you\nlook at a video,",
    "start": "445110",
    "end": "450180"
  },
  {
    "text": "there are a couple of things\nto understand or look at, and the two numbers are\nthe FPS and the frame size",
    "start": "450180",
    "end": "457650"
  },
  {
    "text": "or the resolution, right? The frame resolution\nis just the number of pixels along the height\nand width dimension,",
    "start": "457650",
    "end": "463770"
  },
  {
    "text": "and here, this is a 720p frame. At the same time,\nFPS is the frames",
    "start": "463770",
    "end": "471030"
  },
  {
    "text": "per second, so that's the\nnumber of frames which you have or which the video has\nwhen it was recorded,",
    "start": "471030",
    "end": "476490"
  },
  {
    "text": "which is 30, right? So it just tells you\nthe amount of, I mean, images which are\nthere in this video.",
    "start": "476490",
    "end": "481889"
  },
  {
    "text": "It's quite incredible. I mean, today,\nmost of the videos are also captured at 60 FPS,\nso this is slightly old,",
    "start": "481890",
    "end": "487977"
  },
  {
    "text": "but it just tells you\nthat you are basically capturing relatively large\nimages 30 times a second.",
    "start": "487977",
    "end": "493230"
  },
  {
    "text": "And if you are recording a\nvideo for five, 10 minutes, then it's going to be\na crazy big file which needs to be compressed, right?",
    "start": "493230",
    "end": "499530"
  },
  {
    "text": "OK. So far so good? Any questions as of now?",
    "start": "499530",
    "end": "505830"
  },
  {
    "text": "OK, cool. So let's try to understand\nthis video a bit more. So what I'm going\nto do is that I'm going to use a utility\ncalled media info.",
    "start": "505830",
    "end": "515429"
  },
  {
    "text": "You can just install\non your machines, and look at this video. So this is a raw .y4m file\nis a raw video encoding file,",
    "start": "515429",
    "end": "522269"
  },
  {
    "text": "and we can look at this encoded\nfile to see what is happening. And so you can see\nthe usual suspects.",
    "start": "522270",
    "end": "528810"
  },
  {
    "text": "There is the\nresolution here, which is one quality,\ncross 720, and so on.",
    "start": "528810",
    "end": "534180"
  },
  {
    "text": "There's 30 FPS as we discussed. The color scheme is\nactually YUV 4:2:0.",
    "start": "534180",
    "end": "539250"
  },
  {
    "text": "I believe Pulkit\nmight have discussed this in one of the lectures\non why we use YUV 4:2:0",
    "start": "539250",
    "end": "545310"
  },
  {
    "text": "color scheme, right? At the same time, one very\ninteresting fact to note",
    "start": "545310",
    "end": "551550"
  },
  {
    "text": "here is this 332 megabits\nper second bit rate.",
    "start": "551550",
    "end": "556860"
  },
  {
    "text": "So that is actually\nthe file size. If you are going to\nrecord, just store",
    "start": "556860",
    "end": "562080"
  },
  {
    "text": "this video as it is, raw\nvideo, one second, it's going to take 332 megabits--",
    "start": "562080",
    "end": "568230"
  },
  {
    "text": "I mean, divide by\n8 to get megabytes. But it just tells you that\nit's quite incredible. I mean, if I have to, I mean,\nstream this video to my home,",
    "start": "568230",
    "end": "576420"
  },
  {
    "text": "I mean, I have maybe 100\nmegabits per second Comcast net at home. It's not going to play.",
    "start": "576420",
    "end": "581670"
  },
  {
    "text": "I mean, the video is just\nnot going to play, right? So it just tells\nus that, I mean, we really need\nvideo compression.",
    "start": "581670",
    "end": "588120"
  },
  {
    "text": "I mean, our infrastructure\ncan't really handle videos in the raw format. I mean, this is also\na much smaller video.",
    "start": "588120",
    "end": "595380"
  },
  {
    "text": "Today, we watch\nNetflix at 4K and so on so it's going to be\nmuch bigger than this. So it just tells us that we need\nvideo compression quite a bit.",
    "start": "595380",
    "end": "605320"
  },
  {
    "text": "All right, OK. So let's see. I mean, let's try to use\nH.264 to compress this video",
    "start": "605320",
    "end": "613600"
  },
  {
    "text": "and see what file\nsize we get, right? So I'm putting these\ncommands at the bottom.",
    "start": "613600",
    "end": "619300"
  },
  {
    "text": "So the most common\nway you will use-- I mean, apart from just\nusing some of the UIs,",
    "start": "619300",
    "end": "626283"
  },
  {
    "text": "if you're using\ncommand line, then you can use FFmpeg which\nis a very common utility to work with video, not\njust compression, anything",
    "start": "626283",
    "end": "632620"
  },
  {
    "text": "related to video processing. And here, I'm\nusing at x264 which is one specific encoder\nfor the H.264 codec.",
    "start": "632620",
    "end": "640779"
  },
  {
    "text": "And I'm encoding this video at\nthis parameter called CRF20.",
    "start": "640780",
    "end": "647080"
  },
  {
    "text": "You probably might\nhave heard about this when JPEG compression\nwas discussed, but CRF basically tells\nyou the quality parameter",
    "start": "647080",
    "end": "654970"
  },
  {
    "text": "or the quality level,\nand 20, typically, corresponds to\nhuman imperceptible.",
    "start": "654970",
    "end": "660399"
  },
  {
    "text": "So this is at a level where\nhumans typically don't really perceive.",
    "start": "660400",
    "end": "665750"
  },
  {
    "text": "I mean, there are no distortions\nwhich you will perceive, and so this is at this\nparticular compression level,",
    "start": "665750",
    "end": "672199"
  },
  {
    "text": "right? And at this level, what we\nsee is that already, I mean, the compression which we\nget is quite incredible.",
    "start": "672200",
    "end": "677870"
  },
  {
    "text": "I mean, it's almost 50X. The video using\nH.264, we already",
    "start": "677870",
    "end": "683060"
  },
  {
    "text": "get it down to 6.2\nmegabits per second, which is quite incredible. And I'm not sure if\nyou can see anything.",
    "start": "683060",
    "end": "688910"
  },
  {
    "text": "Let me play the video, if\nyou see any weird artifacts, at least I don't. So it's relatively good.",
    "start": "688910",
    "end": "694190"
  },
  {
    "text": "I mean, probably there might be\nsome artifacts in the fountains and so on, but it's\nrelatively good,",
    "start": "694190",
    "end": "703940"
  },
  {
    "text": "depending on the\napplication, so OK. So let's try to go ahead. I'm going to use, again, the\nsame command, and x264 codec",
    "start": "703940",
    "end": "711920"
  },
  {
    "text": "to encode it at CRF40. So this is a more aggressive\ncompression level, and you will see that.",
    "start": "711920",
    "end": "718043"
  },
  {
    "text": "I mean, we get much\nbetter compression, right? It's 0.8, it's even 6X lower. But at the same time, I mean,\nif I play the video, some of you",
    "start": "718043",
    "end": "726519"
  },
  {
    "text": "might notice, some of\nyou might not notice but there are a bunch of\nartifacts which crop up. So I don't know if maybe\nat the head of the jockey,",
    "start": "726520",
    "end": "735140"
  },
  {
    "text": "there are some weird blocky\nartifacts which come up, and which are-- even here, you can\nsee on the legs,",
    "start": "735140",
    "end": "741410"
  },
  {
    "text": "there are a lot\nof artifacts which come up at this\ncompression level, right? So I mean, of course,\nat least using x264,",
    "start": "741410",
    "end": "748670"
  },
  {
    "text": "there is some limit, but\nwe know that at least we can get this 50X compression\nusing x264, so OK.",
    "start": "748670",
    "end": "756020"
  },
  {
    "text": "Let's try to understand\nhow we can get this, right? OK, so now, as I\nmentioned, we are",
    "start": "756020",
    "end": "763149"
  },
  {
    "text": "going to use all our\npast knowledge, whatever you learned in this course\nto try to achieve this. And I know that, I mean,\neveryone is at this point",
    "start": "763150",
    "end": "770380"
  },
  {
    "text": "familiar with how\nJPEG works, and so we are going to use\nimage compression to go towards video\ncompression, right?",
    "start": "770380",
    "end": "776170"
  },
  {
    "text": "And so image compression will\nuse just as a black box or as a utility function\nin the beginning,",
    "start": "776170",
    "end": "782589"
  },
  {
    "text": "and see what we can\ndo with that, right? So, OK. ",
    "start": "782590",
    "end": "789420"
  },
  {
    "text": "Maybe a quick question. What is the first\nthing you would do? Let's say you have an image\ncompressor implemented.",
    "start": "789420",
    "end": "795415"
  },
  {
    "text": "You have the JPEG\ncompressor which you implemented in\nyour homework and you want to apply that\nfor a video, right?",
    "start": "795415",
    "end": "801600"
  },
  {
    "text": "What is the first\nthing you would do? Any thoughts? Yeah.",
    "start": "801600",
    "end": "806769"
  },
  {
    "text": "Compress each\nframe individually. Exactly. Yeah, so the simplest idea,\njust from definition, a video",
    "start": "806770",
    "end": "812380"
  },
  {
    "text": "is a sequence of\nimages, so that just try to compress each frame\nindependently, right? And if you do that, and\nwe can in fact do that,",
    "start": "812380",
    "end": "820600"
  },
  {
    "text": "and that's actually called\nI-frame compression. You will see this term thrown\naround in video compression",
    "start": "820600",
    "end": "827649"
  },
  {
    "text": "literature. It just means that if a frame\nis compressed independently",
    "start": "827650",
    "end": "832899"
  },
  {
    "text": "as an image, it's\ncalled a I-frame, right? And so we can just compress\neach of these frames",
    "start": "832900",
    "end": "838089"
  },
  {
    "text": "independently like an image, and\nthat's why I-frame compression. And so let's see\nhow good it does.",
    "start": "838090",
    "end": "845060"
  },
  {
    "text": "So you actually see that\non this video actually, if you just do image-based\ncompression, just individually,",
    "start": "845060",
    "end": "851800"
  },
  {
    "text": "compress every frame, then\nwe get a very, I mean, amazing compression. It's already within\nalmost half of the--",
    "start": "851800",
    "end": "858850"
  },
  {
    "text": "I mean, it's not\nas good as if you use the H.264 codec, but just\nI-frame compression of H.264,",
    "start": "858850",
    "end": "866060"
  },
  {
    "text": "you get 9 megabits per\nsecond as compared to six, what we got there, right? So I mean, the\nresults could differ.",
    "start": "866060",
    "end": "873920"
  },
  {
    "text": "I'll show a couple of more\nvideos where there is not as much motion, and we'll see\nthat if we just compress them",
    "start": "873920",
    "end": "880040"
  },
  {
    "text": "as it is, then the compression\nis much worse with I-frames. But on this video, because\nthere is a lot of motion,",
    "start": "880040",
    "end": "885680"
  },
  {
    "text": "we see that just I-frame,\njust this simple idea which you mentioned, we are\nable to get within 9",
    "start": "885680",
    "end": "890810"
  },
  {
    "text": "megabits per second, right? And so now, the next\nquestion is, OK, how can we go from here towards\nthe 6 megabits or even lower?",
    "start": "890810",
    "end": "898100"
  },
  {
    "text": "So that's the next\nquestion to answer, OK? All right, so again,\nthis is the video",
    "start": "898100",
    "end": "904420"
  },
  {
    "text": "compressed using the I-frames. It's relatively good. OK, so I'm going to\nshow a couple of images",
    "start": "904420",
    "end": "910678"
  },
  {
    "text": "and I'm going to\ntoggle between them. And let's see if there\nis another thought",
    "start": "910678",
    "end": "916300"
  },
  {
    "text": "on how to go forward, so yeah. I mean, the key\nidea or the hint is",
    "start": "916300",
    "end": "922779"
  },
  {
    "text": "that compression is all\nabout removing redundancy. Wherever you see redundancy,\nwherever you see correlation,",
    "start": "922780",
    "end": "929080"
  },
  {
    "text": "you have to correlate\nthese things, right? So any, again, thoughts\non what we could do to improve the compression?",
    "start": "929080",
    "end": "936160"
  },
  {
    "start": "936160",
    "end": "943470"
  },
  {
    "text": "OK, one hint, OK, yeah? There's a correlation\nbetween the frames so if we do something like\nencode the first frame,",
    "start": "943470",
    "end": "950970"
  },
  {
    "text": "then we can use that. We can say the second\nframe shares a lot of the same components.",
    "start": "950970",
    "end": "956070"
  },
  {
    "text": "Yeah, that's right. I mean, both of these\nframes if you look, they share a lot of\ncommon information, right?",
    "start": "956070",
    "end": "962010"
  },
  {
    "text": "I mean, it's quite obvious. So if we have the Frame-0\nencoded as an image, then if you look at frame\none, then most of it",
    "start": "962010",
    "end": "970110"
  },
  {
    "text": "is just shifted\nto one direction. So we could basically just\ncopy paste most of it as it is. And if there is a\nsmall difference,",
    "start": "970110",
    "end": "976290"
  },
  {
    "text": "that's what we could encode\nusing an image and so on, right? So that's what we actually do.",
    "start": "976290",
    "end": "981360"
  },
  {
    "text": "So the overall pipeline actually\nlooks something like this, that you take Frame-0, Frame-1.",
    "start": "981360",
    "end": "987090"
  },
  {
    "text": "So this Frame-0 is\nactually the encoded frame. I'm calling it Frame-0.",
    "start": "987090",
    "end": "993130"
  },
  {
    "text": "We find the motion. So here, there is some motion. The logo is static.",
    "start": "993130",
    "end": "998940"
  },
  {
    "text": "That's a different story. And then we basically\nfind the motion. And then to compute the\nFrame-1, what we can do",
    "start": "998940",
    "end": "1007019"
  },
  {
    "text": "is that we can apply this\nmotion on top of this Frame-0 to get a compensated frame.",
    "start": "1007020",
    "end": "1012270"
  },
  {
    "text": "And then we can encode this\nresidual, the difference, separately as an image.",
    "start": "1012270",
    "end": "1019259"
  },
  {
    "text": "Is this clear? So this is the broad idea of\nhow video compression works,",
    "start": "1019260",
    "end": "1024359"
  },
  {
    "text": "that you compress one frame\nas it is and then encode the difference in\na separate way.",
    "start": "1024359",
    "end": "1030000"
  },
  {
    "text": "And this mainly works\nbecause our frame rate, FPS is quite fast. I mean, one by\n30th is quite fast",
    "start": "1030000",
    "end": "1036930"
  },
  {
    "text": "and so the motion is\ntypically much smaller. If you look at two frames\nseparated with one by 30th",
    "start": "1036930",
    "end": "1042809"
  },
  {
    "text": "of a second,\ntypically, they're not going to be different\nby quite a bit.",
    "start": "1042810",
    "end": "1048240"
  },
  {
    "text": "So, all right.  So this is actually what\nis called P-frame coding.",
    "start": "1048240",
    "end": "1054900"
  },
  {
    "text": "So we spoke about I-frame\ncoding where every frame is independently encoded. This is the P-frame\ncoding where the P-frame",
    "start": "1054900",
    "end": "1061740"
  },
  {
    "text": "is the predicted frame. So what you do is that\nyou first encode the-- let us say we start\nwith the first frame.",
    "start": "1061740",
    "end": "1067260"
  },
  {
    "text": "It's encoded as\nan image, then you encode the second\nframe, the P-frame dependent upon the first\nframe, and then the third frame",
    "start": "1067260",
    "end": "1075043"
  },
  {
    "text": "dependent upon the\nsecond encoded frame, and so on, so on, so on. And at some point,\nobviously, your prediction is not going to be great because\nevery time you are doing this,",
    "start": "1075043",
    "end": "1082510"
  },
  {
    "text": "there is some noise added to it\nand it might become a bit more expensive so you refresh\nby adding a new I-frame.",
    "start": "1082510",
    "end": "1090029"
  },
  {
    "text": "Or if the scene changes,\nlet's just say-- I mean, when the\nhorse is running, something else comes\ninto the middle,",
    "start": "1090030",
    "end": "1095190"
  },
  {
    "text": "then you can add\nanother I-frame. And so that's how,\ntypically, the P-frame works.",
    "start": "1095190",
    "end": "1102630"
  },
  {
    "text": "Another key one thing\nwhich I wanted to mention is this keyint. So the keyint, you will\nalso see this term.",
    "start": "1102630",
    "end": "1109920"
  },
  {
    "text": "It implies the distance\nbetween two I-frames, so that's the distance between\ntwo I-frames or key frames,",
    "start": "1109920",
    "end": "1116610"
  },
  {
    "text": "which is six in this case. Is this fine? OK, cool.",
    "start": "1116610",
    "end": "1122890"
  },
  {
    "text": "So this is the\noverall block diagram for our IP-coding, which\nis that, I mean, we first",
    "start": "1122890",
    "end": "1128730"
  },
  {
    "text": "find the motion, we\nencode the motion, and then we apply this decoded\nmotion on top of the previously",
    "start": "1128730",
    "end": "1135330"
  },
  {
    "text": "reconstructed frame. And that gives us the\nmotion compensated frame. And then we take the difference\nand then encode this difference",
    "start": "1135330",
    "end": "1142260"
  },
  {
    "text": "as an image compression, right? OK, so now maybe\nanother question is that, I mean, in the\nprevious I-frame coding,",
    "start": "1142260",
    "end": "1149138"
  },
  {
    "text": "we also had image\ncompression block, right? It was basically operating on\na same image again and again.",
    "start": "1149138",
    "end": "1154230"
  },
  {
    "text": "In this case, we have a\nmuch more complicated thing. There is this motion\ncompensation and so on.",
    "start": "1154230",
    "end": "1159240"
  },
  {
    "text": "And again, there is image\ncompression block here. So why do you think\nthis should do better? I mean, even though we still\nhave the image compression",
    "start": "1159240",
    "end": "1166320"
  },
  {
    "text": "block here, right? So why do you think\nthis does better",
    "start": "1166320",
    "end": "1172140"
  },
  {
    "text": "or this should do better? Yeah? The residual should be very low.",
    "start": "1172140",
    "end": "1178019"
  },
  {
    "text": "Yeah, good answer. It should be mostly space or--",
    "start": "1178020",
    "end": "1183630"
  },
  {
    "text": "Yeah. Some artifacts. Yeah, that's a good answer. So we know that\nimage compression",
    "start": "1183630",
    "end": "1189779"
  },
  {
    "text": "depends on the image itself. If the image is\nsimple, then you are going to be able to\ncompress it much better.",
    "start": "1189780",
    "end": "1194910"
  },
  {
    "text": "If there is a lot of things\nhappening in the image, then it's going to\ntake a lot of bits. And so the residual,\nas you mentioned,",
    "start": "1194910",
    "end": "1201900"
  },
  {
    "text": "if it's simple, if it's\nall blank most of it, then if we use something\nlike JPEG to compress it,",
    "start": "1201900",
    "end": "1207870"
  },
  {
    "text": "the residual we should be\nable to do much better. So that's the idea. We are trying to extract\nout all correlation",
    "start": "1207870",
    "end": "1213870"
  },
  {
    "text": "before we use our image\ncompression techniques here. And that's what most\nof the video codecs do.",
    "start": "1213870",
    "end": "1220860"
  },
  {
    "text": " OK. ",
    "start": "1220860",
    "end": "1230010"
  },
  {
    "text": "All right, so let's now\ntry to discuss how this--",
    "start": "1230010",
    "end": "1236220"
  },
  {
    "text": "I mean, we already\nknow this block. We already know how the image\ncompression works, right? I mean, we looked at it.",
    "start": "1236220",
    "end": "1241810"
  },
  {
    "text": "So let's first try to\nfocus on this part here. How do we really find the motion\nand how do we encode it, right?",
    "start": "1241810",
    "end": "1248160"
  },
  {
    "text": "So the encoding part, I'm not\ngoing to discuss as much today, but it's similar to what\nyou have seen in the class",
    "start": "1248160",
    "end": "1253889"
  },
  {
    "text": "but let's look at how do\nwe really find the motion. And so in H.264 and most\nof the traditional codecs,",
    "start": "1253890",
    "end": "1259080"
  },
  {
    "text": "the simplest idea is that, it's\nagain, based on correlation. So you take the reference frame,\nyou take a reference block,",
    "start": "1259080",
    "end": "1267570"
  },
  {
    "text": "and then try to move\nthis block, try to check",
    "start": "1267570",
    "end": "1272610"
  },
  {
    "text": "whether where this\nblock matches, right? And wherever this\nblock matches, you know the location of that\nblock, that's the motion.",
    "start": "1272610",
    "end": "1279029"
  },
  {
    "text": "And so that's the\nsimple idea based on block matching algorithm. By the way, there are\na lot of good resources",
    "start": "1279030",
    "end": "1285840"
  },
  {
    "text": "from a past course at Stanford. Unfortunately, it\ndoesn't run anymore but Bernd Girod has a lot of\ngood resources on the website",
    "start": "1285840",
    "end": "1292960"
  },
  {
    "text": "so do look at that if\nyou want to really go into the nitty gritty\ndetails of video coding.",
    "start": "1292960",
    "end": "1297970"
  },
  {
    "text": "So that's basically\nthe broad idea. It's quite simple. You just take a block. Again, it depends\non the algorithm.",
    "start": "1297970",
    "end": "1303700"
  },
  {
    "text": "What block size do\nyou want to take and how do you want to do\nthe searching and so on? But the broad idea is\nthat you take a block,",
    "start": "1303700",
    "end": "1310390"
  },
  {
    "text": "you try to match it, and\nwherever you get a good match, that's your motion, OK?",
    "start": "1310390",
    "end": "1316090"
  },
  {
    "text": "And, OK. So maybe here is some\nexamples from, again,",
    "start": "1316090",
    "end": "1321760"
  },
  {
    "text": "if we apply the motion. As you can see here,\nthere is some motion. Most of it is static.",
    "start": "1321760",
    "end": "1326958"
  },
  {
    "text": "There is some motion in these\nbranches while they are moving, and we take the\nresidual and so on.",
    "start": "1326958",
    "end": "1334000"
  },
  {
    "text": "Now, again, I mentioned there\nare different strategies to do the block search but\nI'll just mention a few.",
    "start": "1334000",
    "end": "1340990"
  },
  {
    "text": "So here is full searching\nwhere you can basically search across the entire\nimage, which is obviously",
    "start": "1340990",
    "end": "1347590"
  },
  {
    "text": "way more expensive. But the way in which most of\nthe times people implement this is hierarchical searching.",
    "start": "1347590",
    "end": "1353409"
  },
  {
    "text": "So what you will\ndo is that, I mean, if you want to do\nblock matching, you will actually start\nfrom the lowest level.",
    "start": "1353410",
    "end": "1359890"
  },
  {
    "text": "You will downsample\nyour frame by say, 4X. You will do block\nmatching there.",
    "start": "1359890",
    "end": "1365110"
  },
  {
    "text": "Once you find a\ncoarse match, then you will, again, sample\nyour frame and find",
    "start": "1365110",
    "end": "1370240"
  },
  {
    "text": "matches there and\nso on and so on. So you can do this\nas a multi scale, just to make the problem\nmore tractable and solvable.",
    "start": "1370240",
    "end": "1377770"
  },
  {
    "text": "And this is very similar to-- I mean, a lot of the\nvideo processing which you will see today, I mean, in\nmost of the video processing",
    "start": "1377770",
    "end": "1386860"
  },
  {
    "text": "or even image processing\nuses image pyramids which is very similar to this idea.",
    "start": "1386860",
    "end": "1392110"
  },
  {
    "text": "Is this fine? People understand how the\nmotion vectors are found?",
    "start": "1392110",
    "end": "1398279"
  },
  {
    "text": "Yeah, and then once you\nhave found these vectors, you can just encode\nthe differences are",
    "start": "1398280",
    "end": "1405660"
  },
  {
    "text": "your motions per block, and then\nyou will encode these motions, right?",
    "start": "1405660",
    "end": "1411710"
  },
  {
    "text": "OK, so maybe let's take\na pause and I actually want to show you a\nsample encoded video.",
    "start": "1411710",
    "end": "1420610"
  },
  {
    "text": "So we are going to use\nactually something called [? Stream-I. ?]",
    "start": "1420610",
    "end": "1426090"
  },
  {
    "text": "OK, so even before we\nlook at our jockey video,",
    "start": "1426090",
    "end": "1434039"
  },
  {
    "text": "because the horse video is\nslightly more complicated, I'm going to look at this one. So this is a slightly simpler\none because it's just smaller.",
    "start": "1434040",
    "end": "1444360"
  },
  {
    "text": "OK, let me-- yeah, so\nthis is a software which--",
    "start": "1444360",
    "end": "1452160"
  },
  {
    "text": "what it is doing is that it's\nlooking at the encoded file and it's just trying to display\nall the encoded information",
    "start": "1452160",
    "end": "1458760"
  },
  {
    "text": "in a much different way, right? All right, so here,\nwhat it's showing",
    "start": "1458760",
    "end": "1464190"
  },
  {
    "text": "is that it's showing the\nnumber of bits used per frame. So this bar chart\nactually tells the number",
    "start": "1464190",
    "end": "1470520"
  },
  {
    "text": "of bits used per frame\nand every frame here. So maybe one quick\nquestion is that, you",
    "start": "1470520",
    "end": "1479730"
  },
  {
    "text": "see that there is\nthis high bar here and there are these\nsmaller bars after that, and again, high bar\nhere and smaller bars.",
    "start": "1479730",
    "end": "1484860"
  },
  {
    "text": "Any idea what is happening? Why are some of\nthese frames have such high motion\nwhile some of them just don't have as\nmuch high motion?",
    "start": "1484860",
    "end": "1491650"
  },
  {
    "text": "I mean, sorry, not motion,\nthe file size, the bits used for that frame is so high in\nsome cases while not as much",
    "start": "1491650",
    "end": "1499020"
  },
  {
    "text": "in other cases. Any idea? What are these frames?",
    "start": "1499020",
    "end": "1504389"
  },
  {
    "text": "[INAUDIBLE] Yeah, that's right. Yeah, so in this case,\nactually, you see that, I mean,",
    "start": "1504390",
    "end": "1510310"
  },
  {
    "text": "the I-frame which we\ncompress independently takes a lot of the bits. And after that, the\nsubsequent frames",
    "start": "1510310",
    "end": "1516669"
  },
  {
    "text": "don't really take as many bits. And in fact, that's seen here. So here, it shows the number\nof I and P-frame counts.",
    "start": "1516670",
    "end": "1524409"
  },
  {
    "text": "The I-frame is two\nframes, P-frame is 14, but this number of\nbits used in terms of I",
    "start": "1524410",
    "end": "1530799"
  },
  {
    "text": "and P totally is just\nskewed towards I-frames in this video, which is quite\nincredible to see, right?",
    "start": "1530800",
    "end": "1538850"
  },
  {
    "text": "Cool. So maybe let's look at\nsome of these frames.",
    "start": "1538850",
    "end": "1547880"
  },
  {
    "text": "Again, here, it's showing the-- so this software is\nactually quite useful.",
    "start": "1547880",
    "end": "1554030"
  },
  {
    "text": "You can also put it on\nyour machines and see. It shows you the raw\nbit stream and a bunch",
    "start": "1554030",
    "end": "1559370"
  },
  {
    "text": "of other information\nabout every block. But here, we are just\nshowing the motion vectors.",
    "start": "1559370",
    "end": "1564830"
  },
  {
    "text": "So as you can see here, I'm\nnot sure if it's visible but you can see the\narrows which tells you the motion vectors\nin every frame",
    "start": "1564830",
    "end": "1571460"
  },
  {
    "text": "and how it is going, right? And as you can see, the block\nsize is quite different.",
    "start": "1571460",
    "end": "1576980"
  },
  {
    "text": "It need not be the\nsame block size. H.264 allows the block size\nto be, again, similar to BPG",
    "start": "1576980",
    "end": "1583070"
  },
  {
    "text": "or which you might\nhave seen in class. What people have seen is\nthat variable block size",
    "start": "1583070",
    "end": "1588440"
  },
  {
    "text": "works better because\nin some cases, if the area is not\nas much textured, you",
    "start": "1588440",
    "end": "1593498"
  },
  {
    "text": "can have a much bigger block\nsize, while in some cases, you can have a much\nsmaller block size, so on.",
    "start": "1593498",
    "end": "1600480"
  },
  {
    "text": "So, yeah. So again, as you can see, we\ncan see these motion vectors",
    "start": "1600480",
    "end": "1606300"
  },
  {
    "text": "in this case. I also wanted to\nshow the predicted. ",
    "start": "1606300",
    "end": "1613330"
  },
  {
    "text": "OK, one second.  Yeah, so here, it's showing the\ndecoded, at the same time it's",
    "start": "1613330",
    "end": "1621310"
  },
  {
    "text": "also showing the\npredicted frame, right? I think that you should be able\nto see some of the difference.",
    "start": "1621310",
    "end": "1628060"
  },
  {
    "text": "So the predicted is\nactually the prediction from the previous frame, the\nmotion compensated frame,",
    "start": "1628060",
    "end": "1633490"
  },
  {
    "text": "and you see some differences. Let's look at this frame. Here, I see some\ndifference here,",
    "start": "1633490",
    "end": "1640090"
  },
  {
    "text": "some blocky artifacts here. And then it should be\nreflected in the residual.",
    "start": "1640090",
    "end": "1645340"
  },
  {
    "text": "The residual, as you\nmentioned, it's quite sparse. It's almost zeros,\nand then this residual",
    "start": "1645340",
    "end": "1651730"
  },
  {
    "text": "is encoded using image\ncompression techniques.",
    "start": "1651730",
    "end": "1657970"
  },
  {
    "text": "Yeah, so it's quite cool to see. You can spend a lot of\ntime just staring at these and trying to understand.",
    "start": "1657970",
    "end": "1663400"
  },
  {
    "text": " Cool. All right, let's get back.",
    "start": "1663400",
    "end": "1668980"
  },
  {
    "text": " Actually, let's also\nsee another video which is the jockey one,\nwhich is our standard video.",
    "start": "1668980",
    "end": "1679730"
  },
  {
    "text": "Yeah? So for the compressing\nthe residual frames, we use a different\nimage compressor",
    "start": "1679730",
    "end": "1685870"
  },
  {
    "text": "or with some\ndifferent parameters compared to the I-frames? Because these do look\ndifferent from natural images.",
    "start": "1685870",
    "end": "1692010"
  },
  {
    "text": "Yeah, good point. So the hyper parameters\nwhich are used for encoding",
    "start": "1692010",
    "end": "1699679"
  },
  {
    "text": "can be different and it\ndepends on the encoder. So actually, I mean, for\nthe residual frame itself,",
    "start": "1699680",
    "end": "1706850"
  },
  {
    "text": "I believe the Huffman\ncoding, Huffman tables itself which are used are--",
    "start": "1706850",
    "end": "1713400"
  },
  {
    "text": "I mean, the preset Huffman\ntables which are used are slightly different\nin this case.",
    "start": "1713400",
    "end": "1719040"
  },
  {
    "text": "Yeah.  I mean, the H.264 standard\nactually only specifies",
    "start": "1719040",
    "end": "1725480"
  },
  {
    "text": "the decoder so you will see\nthat different encoders, they can do whatever they want. ",
    "start": "1725480",
    "end": "1732880"
  },
  {
    "text": "Yeah.  OK, so we'll see another\nfile which is jockey",
    "start": "1732880",
    "end": "1740390"
  },
  {
    "text": "but it's encoded at\na very high bit rate so we are encoding this jockey\nvideo at a much higher quality.",
    "start": "1740390",
    "end": "1745640"
  },
  {
    "text": " Yeah, and again, here\nI just wanted to show--",
    "start": "1745640",
    "end": "1751434"
  },
  {
    "text": " OK, this video is really big.",
    "start": "1751435",
    "end": "1757220"
  },
  {
    "text": "I can put those\nthings up and you can see the blocks are\nmuch, much, much smaller. But again, one thing to\nnotice as a contrast is that",
    "start": "1757220",
    "end": "1764780"
  },
  {
    "text": "at high quality, and\nalso when there is motion is already high, you see that\nthe I and P frames are similar.",
    "start": "1764780",
    "end": "1771290"
  },
  {
    "text": "Just doesn't make\nmuch of a difference, and it's also reflected\nin the file size.",
    "start": "1771290",
    "end": "1776330"
  },
  {
    "text": "We saw that. Just I-frame compression\non this video takes 9 megabits per\nsecond while I and P",
    "start": "1776330",
    "end": "1781940"
  },
  {
    "text": "takes 6 megabits per\nsecond so it doesn't help as much in this case, right? And yeah, it's quite thin here.",
    "start": "1781940",
    "end": "1788180"
  },
  {
    "text": "It's just because we are relying\non the P-frame, the residual to be sparse for\ngood compression.",
    "start": "1788180",
    "end": "1793670"
  },
  {
    "text": "But if there is a lot of motion\nand if the motion is weird, then we might not be able to\npredict the next frame as well",
    "start": "1793670",
    "end": "1801140"
  },
  {
    "text": "based on the previous\none, and so then you will be using a lot of bits. And I think if we view the\nmotions, it should be quite--",
    "start": "1801140",
    "end": "1811664"
  },
  {
    "text": "so this is the first frame.  Yeah, again, I mean,\nif I zoom into it,",
    "start": "1811665",
    "end": "1819049"
  },
  {
    "text": "it should be quite obvious. But again, here also,\nyou see the it does flip.",
    "start": "1819050",
    "end": "1824390"
  },
  {
    "text": " The split is different\nbut the I-frame still",
    "start": "1824390",
    "end": "1832670"
  },
  {
    "text": "take a bunch of space. That's what it looks like. ",
    "start": "1832670",
    "end": "1841320"
  },
  {
    "text": "All right, OK.",
    "start": "1841320",
    "end": "1847480"
  },
  {
    "text": " Yeah, so this is\nthe P-frame video.",
    "start": "1847480",
    "end": "1852925"
  },
  {
    "start": "1852925",
    "end": "1858140"
  },
  {
    "text": "Any questions as of now? Is the [? Stream-I ?] demo fine?",
    "start": "1858140",
    "end": "1863570"
  },
  {
    "text": "OK, so another thing\nwhich I wanted to do is just open up this\nfile, again, in mediainfo. So I mentioned mediainfo\nis a quick tool which",
    "start": "1863570",
    "end": "1870110"
  },
  {
    "text": "you can use to view things. And I showed the\nraw file before,",
    "start": "1870110",
    "end": "1876950"
  },
  {
    "text": "so now we can look\nat the encoded file. And you can see\na bunch of things here like this\nadvanced video codec.",
    "start": "1876950",
    "end": "1883669"
  },
  {
    "text": "I mean, advanced video codec\nis another name for H.264. It used to be advanced\n10 years back,",
    "start": "1883670",
    "end": "1889790"
  },
  {
    "text": "it's not as advanced today but\nyeah, anyway, that's the name. And so you will see AVC also put\nin the files at various places.",
    "start": "1889790",
    "end": "1900260"
  },
  {
    "text": "And again, another thing\nwhich you see, the stream size is 3.16 megabits.",
    "start": "1900260",
    "end": "1907850"
  },
  {
    "text": "Let's see, where is the-- OK, so this is the bit rate.",
    "start": "1907850",
    "end": "1914510"
  },
  {
    "text": "Bit rate is 6 megabit\nper second, which is what we had seen earlier. And you see a lot of settings\nhere, encoding settings.",
    "start": "1914510",
    "end": "1922417"
  },
  {
    "text": "And you will see\nthat this is metadata which is the encoding settings. So FFmpeg internally\ndoes a lot of options",
    "start": "1922417",
    "end": "1928679"
  },
  {
    "text": "while encoding this file and\nyou have the manual control to change these things. For example, it uses cabac\nwhich is adaptive arithmetic",
    "start": "1928680",
    "end": "1935370"
  },
  {
    "text": "coder instead of Huffman,\nor it will use LookAhead while finding the motion because\nin case of P-frames, one frame",
    "start": "1935370",
    "end": "1945210"
  },
  {
    "text": "also impacts the next future\n8 P-frames, for example. And so you need to\nlook ahead to see",
    "start": "1945210",
    "end": "1950820"
  },
  {
    "text": "what the motion is and so on. So you can do all\nsorts of optimizations to improve the\ncompression and that",
    "start": "1950820",
    "end": "1956490"
  },
  {
    "text": "makes the encoding much slower,\nbut sometimes better, right? Yeah, so there's\njust a lot of options",
    "start": "1956490",
    "end": "1962040"
  },
  {
    "text": "which you can look into. We are not going to try to\nunderstand anything of here",
    "start": "1962040",
    "end": "1967050"
  },
  {
    "text": "today, but it's quite\ninteresting to see that. ",
    "start": "1967050",
    "end": "1972870"
  },
  {
    "text": "Cool. OK, so another one thing\nwhich you could ask is that why restrict us\nto this kind of a coding",
    "start": "1972870",
    "end": "1979769"
  },
  {
    "text": "where we just\nstart with an image then we encode one\nframe independently,",
    "start": "1979770",
    "end": "1984955"
  },
  {
    "text": "and then we encode the next\nframe conditioned on that one and then go on go on? Instead, what we\ncould do is that--",
    "start": "1984955",
    "end": "1991230"
  },
  {
    "text": "because this is extrapolation. You are taking one frame,\nyou are extrapolating it to the next frame, and then\nencoding the difference.",
    "start": "1991230",
    "end": "1997410"
  },
  {
    "text": "Typically, in real life, we\nknow that interpolation works better, so why not\nencode, do it that way?",
    "start": "1997410",
    "end": "2003710"
  },
  {
    "text": "So let's just have\none image frame. Let's predict this P-frame\nbased on I-frame like here.",
    "start": "2003710",
    "end": "2011270"
  },
  {
    "text": "But then the\nintermediate two frames, let's interpolate between\nframe number one and three,",
    "start": "2011270",
    "end": "2017450"
  },
  {
    "text": "one and four, right? And that, I mean, potentially\nbecause this P-frame is further away, it's\nthree or four frames away,",
    "start": "2017450",
    "end": "2024413"
  },
  {
    "text": "there will be much more\nmotion and the P-frame could cost us more bits. But the frame number\ntwo and three here",
    "start": "2024413",
    "end": "2031610"
  },
  {
    "text": "could basically cause-- I mean, could be much simpler. I mean, the bit rate to use\nthem could be much simpler, much",
    "start": "2031610",
    "end": "2037730"
  },
  {
    "text": "smaller, right? And so this is called\nB-frame encoding.",
    "start": "2037730",
    "end": "2043340"
  },
  {
    "text": "I mentioned P stands\nfor predictive coding, the B stands for bilinear\ncoding because it references",
    "start": "2043340",
    "end": "2049610"
  },
  {
    "text": "both left to right directions. Yeah, so again,\nwe could do this. And in fact, if you\nencode your video, I mean,",
    "start": "2049610",
    "end": "2058129"
  },
  {
    "text": "when you upload your video on\nYouTube or most of the times, videos nowadays are actually\nencoded using B-frames.",
    "start": "2058130",
    "end": "2065360"
  },
  {
    "text": "In fact, I'll come to that. There's something called\nhierarchical B-frames which is what is used,\nbut B-frames is what",
    "start": "2065360",
    "end": "2070669"
  },
  {
    "text": "is used for encoding\nmost of the videos which you watch on Netflix or\nYouTube and so on, right?",
    "start": "2070670",
    "end": "2077929"
  },
  {
    "text": "And the main reason\nwhy this works better is just interpolation\nor extrapolation, that interpolation is\na much simpler problem.",
    "start": "2077929",
    "end": "2083929"
  },
  {
    "text": "So if you have one frame\nhere and one frame ahead, you can interpolate\nbetween them quite well. ",
    "start": "2083929",
    "end": "2091260"
  },
  {
    "text": "Cool. I mean, we know that it should\nlead to better compression",
    "start": "2091260",
    "end": "2097200"
  },
  {
    "text": "but let me show you that. Again, we'll do that later. But any thoughts on when\nyou might want to use--",
    "start": "2097200",
    "end": "2104730"
  },
  {
    "text": "I mean, sometime, in some cases,\nI and P frame coding might be better in some applications.",
    "start": "2104730",
    "end": "2110610"
  },
  {
    "text": "Any thoughts on when you might\nprefer I and P-frame coding versus IPB frame coding.",
    "start": "2110610",
    "end": "2115619"
  },
  {
    "start": "2115620",
    "end": "2122140"
  },
  {
    "text": "Yeah, OK, so the hint is\nthat, I mean, in compression in this class,\nmost of our concern has been just better\ncompression, right?",
    "start": "2122140",
    "end": "2129820"
  },
  {
    "text": "But at the same time in\nreal life, a lot of times, there are other constraints\nlike, I mean, speed,",
    "start": "2129820",
    "end": "2135819"
  },
  {
    "text": "latency, and so on. And so those constraints\ncome into the picture. For example, with\nthe B-frame, let",
    "start": "2135820",
    "end": "2142330"
  },
  {
    "text": "us say you want to start\nlooking at this video, right? Now, if you want\nto, the frame one",
    "start": "2142330",
    "end": "2148302"
  },
  {
    "text": "will get decoded quickly because\nit's an independent image. But to decode frame\nnumber two, you first need to decode frame\nnumber four and then decode",
    "start": "2148302",
    "end": "2155128"
  },
  {
    "text": "frame number three. So it adds to this latency. It adds to one frame\nlatency, which in some cases is OK, in some cases\nit might not be.",
    "start": "2155128",
    "end": "2162640"
  },
  {
    "text": "For example, if you are\ndoing real time video calling with someone, then, I mean,\nit might be prohibitive.",
    "start": "2162640",
    "end": "2169540"
  },
  {
    "text": "I mean, first of all, you don't\nknow what is this future frame. You can't just wait for n number\nof frames until someone talks",
    "start": "2169540",
    "end": "2176132"
  },
  {
    "text": "and then encode. Otherwise, the Zoom talk\nis going to be delayed. Everyone is going to\nreceive delayed frames.",
    "start": "2176133",
    "end": "2182500"
  },
  {
    "text": "So it's just not possible. And so you will see that Zoom\nchats or whatever, Google Meet,",
    "start": "2182500",
    "end": "2189670"
  },
  {
    "text": "Facetime, all of those\nuse I and P style coding, but at the\nsame time, Netflix",
    "start": "2189670",
    "end": "2194980"
  },
  {
    "text": "or any video-on-demand uses\nB-frame because there, it's OK. There, it's fine. You already know\nthe entire video",
    "start": "2194980",
    "end": "2201039"
  },
  {
    "text": "and so you can encode\nusing B-frames. And so you might have seen that\nif you are watching on YouTube, if you try to seek\nto some point,",
    "start": "2201040",
    "end": "2207820"
  },
  {
    "text": "it might not start\nfrom that exact point. It will go somewhere\ntowards the left or towards the right\nor somewhere, right?",
    "start": "2207820",
    "end": "2213040"
  },
  {
    "text": "So what happens is that it syncs\nit towards the closest I-frame because it can't start decoding\nat some arbitrary points.",
    "start": "2213040",
    "end": "2219280"
  },
  {
    "text": "It has to start decoding\nfrom an I-frame. And so if you go\nto YouTube and try to seek to some arbitrary\npoint, it will maybe not",
    "start": "2219280",
    "end": "2226717"
  },
  {
    "text": "start at that exact point. It will go somewhere\nleft or right. Yeah, is the B-frame\nclear right now?",
    "start": "2226717",
    "end": "2234970"
  },
  {
    "text": "All right, yeah. So this is what I was\nmentioning that B-frames",
    "start": "2234970",
    "end": "2240160"
  },
  {
    "text": "is low latency settings\nfor video conferencing.",
    "start": "2240160",
    "end": "2245260"
  },
  {
    "text": "I plus P plus B-frames, it's\nalso called random access mode, again, because it\nallows you to--",
    "start": "2245260",
    "end": "2251290"
  },
  {
    "text": "I mean, it's a slightly\nmisnomer but it allows you to get much better\ncompression, at the same time,",
    "start": "2251290",
    "end": "2256809"
  },
  {
    "text": "seek at various points. At the same time, you will see\nI-frame compression is also",
    "start": "2256810",
    "end": "2261819"
  },
  {
    "text": "useful, and it's actually useful\nin video editing softwares. So you have used ProRes or I\nmean, if you have one of you",
    "start": "2261820",
    "end": "2269950"
  },
  {
    "text": "is a YouTuber, then there are\nthese mezzanine formats which encodes the video. And the reason is not to\nsave space on the file,",
    "start": "2269950",
    "end": "2277960"
  },
  {
    "text": "it's just that to make this\nediting at least possible. If the file size is few\ngigabytes, just editing",
    "start": "2277960",
    "end": "2284410"
  },
  {
    "text": "an image is going to be crazy. So what it does is\nthat you compress every image independently,\nand so if you want to edit this video,\nyou can load one frame,",
    "start": "2284410",
    "end": "2291260"
  },
  {
    "text": "you can do operations on\nit, put it back, and so on. So it just makes\nit more possible. So the I-frame\ncompression is also",
    "start": "2291260",
    "end": "2297020"
  },
  {
    "text": "used more as an\nintermediate step when you are processing the video. ",
    "start": "2297020",
    "end": "2303410"
  },
  {
    "text": "Cool. All right, so I also\nwanted to show-- ",
    "start": "2303410",
    "end": "2311350"
  },
  {
    "text": "maybe let's take a look at\nanother video, which is, again, B-frame based encoding. ",
    "start": "2311350",
    "end": "2318250"
  },
  {
    "text": "Again, we'll select our second\nfavorite video, the foreman. ",
    "start": "2318250",
    "end": "2325070"
  },
  {
    "text": "Yeah, and again.  So another thing here,\nagain, it should be possible",
    "start": "2325070",
    "end": "2333680"
  },
  {
    "text": "for you to guess\nbased on the bit rates here, what is the\nframe structure? Which frames are P, which frames\nare B, which frames are I?",
    "start": "2333680",
    "end": "2340940"
  },
  {
    "text": "Any idea what is which frames? Which frame is P, which\nframe is B in this case",
    "start": "2340940",
    "end": "2347450"
  },
  {
    "text": "based on the bit rates? ",
    "start": "2347450",
    "end": "2354407"
  },
  {
    "text": "Yeah, OK, so I'll give the hint. So these two are\nI-frames because, I mean, they take a lot\nof space so I'm guessing",
    "start": "2354407",
    "end": "2360210"
  },
  {
    "text": "that they are I-frames. And then there's a\nslight peak here, and there's a slight\npeak here, so these are",
    "start": "2360210",
    "end": "2366780"
  },
  {
    "text": "most likely P-frames, right? Predictive frames, we\nare predicting ahead. And then all these\nthree in the middle,",
    "start": "2366780",
    "end": "2373262"
  },
  {
    "text": "these are the B-frames\nwhich are encoded, conditioned on this\none, based on these two. These are the\ninterpolated frames.",
    "start": "2373262",
    "end": "2379080"
  },
  {
    "text": "And as you can see, it takes\nmuch less space than this one. Yeah? It says that there's four\nP-frames though, right?",
    "start": "2379080",
    "end": "2387330"
  },
  {
    "text": "The left side [INAUDIBLE]. ",
    "start": "2387330",
    "end": "2393350"
  },
  {
    "text": "Sorry, what you're saying? Four P-frames?  OK, so let's see.",
    "start": "2393350",
    "end": "2398600"
  },
  {
    "text": "There's one P-frame here,\nthere's one P-frame here.  Yeah, sorry.",
    "start": "2398600",
    "end": "2404090"
  },
  {
    "start": "2404090",
    "end": "2410380"
  },
  {
    "text": "OK, let me see. Where are the frames? So we can also look at this\ndependency structure graph",
    "start": "2410380",
    "end": "2416829"
  },
  {
    "text": "here to know what is happening. So this is an I-frame.",
    "start": "2416830",
    "end": "2423430"
  },
  {
    "text": "This is an I-frame. And what are we predicting?",
    "start": "2423430",
    "end": "2432010"
  },
  {
    "text": "So this is a P-frame,\nthis is a B-frame. ",
    "start": "2432010",
    "end": "2444270"
  },
  {
    "text": "Yes, I think it's encoding. If you look at this curve,\nthen this is a P-frame,",
    "start": "2444270",
    "end": "2451290"
  },
  {
    "text": "this is also a P-frame,\nthis is a P-frame, and this is also a P-frame. That's what it looks like.",
    "start": "2451290",
    "end": "2456880"
  },
  {
    "text": "So again, we can look\nat the decoding order. So first, this is the video. The second frame\nis this one which",
    "start": "2456880",
    "end": "2462090"
  },
  {
    "text": "is decoded based\non the first one, then it decodes\nthese ones, right?",
    "start": "2462090",
    "end": "2467099"
  },
  {
    "text": " Now, it decodes this one.",
    "start": "2467100",
    "end": "2472380"
  },
  {
    "text": "This probably might be-- I mean, not 100% sure\nwhy it does that. Maybe because it found--",
    "start": "2472380",
    "end": "2479369"
  },
  {
    "text": "the I-frame, it also\ndepends on the encoder. What we do, again, this is\nthe IP-frame, second P-frame,",
    "start": "2479370",
    "end": "2486340"
  },
  {
    "text": "right? Again, we do B-frames,\nagain, third P-frame, and fourth P-frame.",
    "start": "2486340",
    "end": "2491480"
  },
  {
    "start": "2491480",
    "end": "2496853"
  },
  {
    "text": "The result of the\nencoder deciding that there is a some kind of\na scene cut at this point.",
    "start": "2496853",
    "end": "2503220"
  },
  {
    "text": "Maybe these two frames\nare slightly different, that's what the encoder decided. But yeah, they're right.",
    "start": "2503220",
    "end": "2509220"
  },
  {
    "text": "So I mean, we were\ncorrect on that part, but there was another P-frame\nhere which is in here.",
    "start": "2509220",
    "end": "2515760"
  },
  {
    "text": "And it's easy to see based on\nalso this dependency graph, which tells us which frames\nare being referenced and so on.",
    "start": "2515760",
    "end": "2522210"
  },
  {
    "text": " Yeah. And again, it's interesting to\nsee the size for IP versus B.",
    "start": "2522210",
    "end": "2533730"
  },
  {
    "text": "I mean, even if the B contains\nmost of the number of B's",
    "start": "2533730",
    "end": "2539340"
  },
  {
    "text": "just higher, the B files\ncontain much lesser in terms of proportion. ",
    "start": "2539340",
    "end": "2547230"
  },
  {
    "text": "And another thing\nwhich I wanted to show is that, actually, you will\nsee that in some cases,",
    "start": "2547230",
    "end": "2558619"
  },
  {
    "text": "you will see the\nframes referencing more than two frames. The B-frame need not\nreference just two frames.",
    "start": "2558620",
    "end": "2565070"
  },
  {
    "text": "For example, here it's\nreferencing three frames, so that's another thing\nthe codec can decide.",
    "start": "2565070",
    "end": "2571830"
  },
  {
    "text": "It wants to reference the\nP-frame and the I-frame but it can also\nreference other frames",
    "start": "2571830",
    "end": "2578930"
  },
  {
    "text": "in there, other P-frames\nwhich are in there. Yeah?",
    "start": "2578930",
    "end": "2585650"
  },
  {
    "text": "Cool.  All right, so we can also\nlook at our jockey video here.",
    "start": "2585650",
    "end": "2594785"
  },
  {
    "start": "2594785",
    "end": "2602950"
  },
  {
    "text": "Yeah, I mean, again,\nit's slightly weird because it remains-- ",
    "start": "2602950",
    "end": "2608690"
  },
  {
    "text": "even if I am encoding\nwith B-frames, the encoder decides that because\nthere is a lot of motion,",
    "start": "2608690",
    "end": "2614137"
  },
  {
    "text": "it doesn't make sense to\nencode using the B-frames and so you'll see that\nat least in this case, I'm seeing that\nit's all P-frames.",
    "start": "2614137",
    "end": "2620540"
  },
  {
    "text": "We'll see a go ahead. In the first thing, it's\nall P-frames, right?",
    "start": "2620540",
    "end": "2626630"
  },
  {
    "text": "Here, it's again, P-frames. And then maybe--",
    "start": "2626630",
    "end": "2637940"
  },
  {
    "text": "OK, there are some\nB-frames here, right? So even if we specify\nto the encoder",
    "start": "2637940",
    "end": "2643220"
  },
  {
    "text": "that I want to use IPB\nframes, it need not use them. If the motion is a lot\nmore, it might just",
    "start": "2643220",
    "end": "2648560"
  },
  {
    "text": "think that it's probably\nOK to use I and P frames in this case. ",
    "start": "2648560",
    "end": "2654750"
  },
  {
    "text": "OK, cool. So just to summarize\nthe motion encoding,",
    "start": "2654750",
    "end": "2663890"
  },
  {
    "text": "I mean, basically, the\nblock based searching and the encoding\nwhich we discussed",
    "start": "2663890",
    "end": "2670310"
  },
  {
    "text": "is extremely efficient. But at the same\ntime, it's very axis aligned so very similar\nto BPG and JPEG.",
    "start": "2670310",
    "end": "2677630"
  },
  {
    "text": "It will produce these\nblocky artifacts which you will see if your video\nsometimes your bandwidth drops",
    "start": "2677630",
    "end": "2683300"
  },
  {
    "text": "on Zoom or something, you\nwill see a lot of weird blocky artifacts and that's mainly\nbecause of these algorithms.",
    "start": "2683300",
    "end": "2689510"
  },
  {
    "text": "And so these algorithms\nalso need these deep blocking algorithm\nfiltering which is part of the loop, which does\nsome post-processing to make",
    "start": "2689510",
    "end": "2699290"
  },
  {
    "text": "the video look slightly better. But, I mean, a lot\nof times it just doesn't work because\nthere is just so much of blocky artifacts that\nit typically might not work.",
    "start": "2699290",
    "end": "2709320"
  },
  {
    "text": "Cool. All right, so I just\nwanted to quickly touch",
    "start": "2709320",
    "end": "2715150"
  },
  {
    "text": "base on how there have been\nin parallel literature ongoing",
    "start": "2715150",
    "end": "2720700"
  },
  {
    "text": "from traditional video\ncoding towards machine learning-based\nvideo coding, right? And we did this exercise in\nthe class where you took JPEG",
    "start": "2720700",
    "end": "2728320"
  },
  {
    "text": "and transformed it into a\nlearned image coder, right/ So we could think of\nin that same lines.",
    "start": "2728320",
    "end": "2733780"
  },
  {
    "text": "And maybe the first thing\nwhich you could do here is that let's keep this\nmotion-based block alone.",
    "start": "2733780",
    "end": "2740110"
  },
  {
    "text": "We know that we have\nlearned image compressor. Let's just try to replace the\ntraditional image compression",
    "start": "2740110",
    "end": "2747220"
  },
  {
    "text": "pipeline here using\nML-based coder, right? And so that obviously could\ngive you much benefits.",
    "start": "2747220",
    "end": "2753190"
  },
  {
    "text": "But at the same time,\nif the entire thing is trained machine\nlearning-based,",
    "start": "2753190",
    "end": "2758619"
  },
  {
    "text": "then it could also\ngive benefits. And the reason is that the\nflow quality might be better.",
    "start": "2758620",
    "end": "2764932"
  },
  {
    "text": "The motion quality\nmight be better. Instead of using\nblock by block, you could have motion which\nis much more smoother",
    "start": "2764932",
    "end": "2770500"
  },
  {
    "text": "and that can give you much\nbetter benefits, right? So I just wanted to show some. So this is, again, a\nfew years old video.",
    "start": "2770500",
    "end": "2778270"
  },
  {
    "text": "So if you use\nblock-based searching, your motion is\nsomething like this,",
    "start": "2778270",
    "end": "2783610"
  },
  {
    "text": "but learned techniques can\nhave much smoother video just because, I mean, they\nare a bit more stronger",
    "start": "2783610",
    "end": "2790960"
  },
  {
    "text": "and they can have a bit more\nbiases built into it, right? And that, typically, can\nlead to less artifacts.",
    "start": "2790960",
    "end": "2796570"
  },
  {
    "text": "So for example, here\nis H.265 which is one generation ahead of H.264. And you see that there are a\nbunch of these blocky artifacts",
    "start": "2796570",
    "end": "2804430"
  },
  {
    "text": "in here at lower bit rates,\nwhile ML-based codecs are a bit more smoother as\ncompared to H.265, right?",
    "start": "2804430",
    "end": "2814020"
  },
  {
    "text": "Yeah. And so there has\nbeen a lot of work. Again, this is a few years old.",
    "start": "2814020",
    "end": "2820760"
  },
  {
    "text": "There has been a\nlot more progress, not as much on the PSNR-based\nmetrics but on other metrics,",
    "start": "2820760",
    "end": "2827810"
  },
  {
    "text": "but you see that the ML-based\ncodecs are already much better",
    "start": "2827810",
    "end": "2833060"
  },
  {
    "text": "than-- the purple curve is the H.265\nand it's much better than that. AV1 is something a newer\ncodec which is already",
    "start": "2833060",
    "end": "2842840"
  },
  {
    "text": "part of some of the machines\nbut not adopted everywhere, but it's also better than\nthat, and things have",
    "start": "2842840",
    "end": "2848960"
  },
  {
    "text": "improved since then as well.  At the same time,\nI mean, one thing",
    "start": "2848960",
    "end": "2855270"
  },
  {
    "text": "which we saw in the\nimage compression class is that it's not very easy to--",
    "start": "2855270",
    "end": "2861518"
  },
  {
    "text": "it's very easy for a\nmachine learning-based codec to optimize for a more\ncomplex metric, right?",
    "start": "2861518",
    "end": "2866590"
  },
  {
    "text": "And so if we take\nthe metric as, say, MSSIM, which is a more\nperceptual-based metric, then ML-based codecs have\na much higher advantage",
    "start": "2866590",
    "end": "2874030"
  },
  {
    "text": "and they can do much better. And so that's what we see here. And so that's where\nmaybe the future is",
    "start": "2874030",
    "end": "2879640"
  },
  {
    "text": "going towards, that I mean,\nvideo-based coding, what we know now, H.264,\nH.265 is simple.",
    "start": "2879640",
    "end": "2888200"
  },
  {
    "text": "It works, but at the same\ntime, ML-based codings can do much better. But at the same time,\nthere is a lot of tradeoff",
    "start": "2888200",
    "end": "2894760"
  },
  {
    "text": "because I mentioned that\nthe another constraint is that video decoding\nor video encoding",
    "start": "2894760",
    "end": "2900640"
  },
  {
    "text": "needs to run in real time. You are running these things 30\nFPS or 60 FPS on your machines,",
    "start": "2900640",
    "end": "2907270"
  },
  {
    "text": "and so it needs to\nrun extremely fast. And so that's the reason why\nyou can't really rely on,",
    "start": "2907270",
    "end": "2912910"
  },
  {
    "text": "I mean, using a machine learning\nmodel which is crazy big. One of the large language\nmodels, large video models,",
    "start": "2912910",
    "end": "2919000"
  },
  {
    "text": "it might not work\non your machines because it definitely won't\nrun in real time today.",
    "start": "2919000",
    "end": "2924470"
  },
  {
    "text": "But of course, with\na bit more of effort, it's possible to run it\nreal time at some point.",
    "start": "2924470",
    "end": "2930290"
  },
  {
    "text": "Yeah, cool. All right, thank you.",
    "start": "2930290",
    "end": "2938030"
  },
  {
    "text": "That's it. Any questions? ",
    "start": "2938030",
    "end": "2944260"
  },
  {
    "text": "OK, I'll hand it over to Shubham\nfor the rest of the talk.",
    "start": "2944260",
    "end": "2951640"
  },
  {
    "text": "Yeah, so just one final thing\nwhich I wanted to mention. So yeah, I mean, my\nteam at Apple is hiring.",
    "start": "2951640",
    "end": "2959290"
  },
  {
    "text": "We work on various\nproblems on both, I mean, ML-based image and\nvideo processing compression",
    "start": "2959290",
    "end": "2966130"
  },
  {
    "text": "and so on. So yeah, if you're interested\nfor both internships",
    "start": "2966130",
    "end": "2971349"
  },
  {
    "text": "or full-time roles,\ndo send me an email. And yeah, that's it.",
    "start": "2971350",
    "end": "2977560"
  },
  {
    "text": "Thanks. Thanks for that. Sadly, I can't say that the\ncompression team at Amazon",
    "start": "2977560",
    "end": "2984850"
  },
  {
    "text": "is hiring but yeah. OK, so concluding\njust a short sort",
    "start": "2984850",
    "end": "2991839"
  },
  {
    "text": "of summary of what we\nhave learned together. ",
    "start": "2991840",
    "end": "3000800"
  },
  {
    "text": "So yeah, so in the early\ndays, a couple of months ago, we started looking\nat very simple IID data.",
    "start": "3000800",
    "end": "3007160"
  },
  {
    "text": "We did some theory the\nfirst few lectures. We learnt about entropy and then\nwe define prefix-free codes.",
    "start": "3007160",
    "end": "3015619"
  },
  {
    "text": "We looked at a few specific\nexamples of prefix-free codes, Huffman codes,\narithmetic codes, rANS.",
    "start": "3015620",
    "end": "3022490"
  },
  {
    "text": "And as you might have\nseen, since then, both in the first half\nand in lossy compression,",
    "start": "3022490",
    "end": "3029540"
  },
  {
    "text": "these are fundamental\nbuilding blocks, right? Even today, Kedar\nmentioned cabac",
    "start": "3029540",
    "end": "3034730"
  },
  {
    "text": "which is very efficient\narithmetic coder. And so all of these are used.",
    "start": "3034730",
    "end": "3043220"
  },
  {
    "text": "Even if your data is\nnot IID, right, you can transform your\ndata in various ways get to something that is almost\nIID, and then use one of these,",
    "start": "3043220",
    "end": "3050809"
  },
  {
    "text": "basically. And all of these have\ndifferent tradeoffs in terms of how close\nthey get to the entropy",
    "start": "3050810",
    "end": "3056240"
  },
  {
    "text": "and how efficient they are\nin encoding and decoding. Right.",
    "start": "3056240",
    "end": "3061400"
  },
  {
    "text": "And then the other thing we\nlooked at in the first half was, fundamentally--\nalso in the second half,",
    "start": "3061400",
    "end": "3067610"
  },
  {
    "text": "but in the first half\nwe looked at entropy, which is the fundamental\nlimit of compression. This is one thing I really liked\nabout compression in the years",
    "start": "3067610",
    "end": "3075350"
  },
  {
    "text": "I've worked on it, is that the\ntheory really helps you out",
    "start": "3075350",
    "end": "3081470"
  },
  {
    "text": "in practice. You can use the\ntheory, especially for lossless\ncompression, I've seen.",
    "start": "3081470",
    "end": "3086960"
  },
  {
    "text": "You can start with the theory,\nmake a model for your data, get some numbers,\nand then actually",
    "start": "3086960",
    "end": "3092359"
  },
  {
    "text": "compare what you're getting\nin practice with the numbers, and that gives you\na lot of insight. ",
    "start": "3092360",
    "end": "3099535"
  },
  {
    "text": "And not only that,\nactually some of the tools from information theory are used\nbeyond just information theory.",
    "start": "3099535",
    "end": "3106059"
  },
  {
    "text": "Because if you remember the\nfundamental result for lossless compression where we showed that\nno compressor in the world can",
    "start": "3106060",
    "end": "3115720"
  },
  {
    "text": "do better than entropy,\nit's a very strong result. It's non-trivial to prove\nresults where any algorithm",
    "start": "3115720",
    "end": "3121809"
  },
  {
    "text": "in the world cannot do\nbetter than something, right? And it's used in various places.",
    "start": "3121810",
    "end": "3128470"
  },
  {
    "text": "You are actually\ngetting a glimpse and define the best role\nproblem, the homework for,",
    "start": "3128470",
    "end": "3134885"
  },
  {
    "text": "right? ",
    "start": "3134885",
    "end": "3140870"
  },
  {
    "text": "And the last thing we saw in\nthe first half, the last three lectures, basically,\nwas non-IID data",
    "start": "3140870",
    "end": "3146480"
  },
  {
    "text": "or what we call\nreal data, right? And so one key idea we learned\nwas, we looked at entropy rate,",
    "start": "3146480",
    "end": "3155090"
  },
  {
    "text": "we looked at\nconditional entropy, and then we learned that\na good predictor gives you a good compressor, and a\ngood compressor gives you",
    "start": "3155090",
    "end": "3161960"
  },
  {
    "text": "a good predictor, right? And we saw some different\ntypes of models.",
    "start": "3161960",
    "end": "3167030"
  },
  {
    "text": "We saw kth order\nadaptive coders. Many of you, some of the\nprojects you are doing,",
    "start": "3167030",
    "end": "3172310"
  },
  {
    "text": "there are a few projects on\ncontext tree weighting, EPM, which are more advanced\npredictors, right?",
    "start": "3172310",
    "end": "3179210"
  },
  {
    "text": "And you also had some fun. This was very new this\nyear with the llama models",
    "start": "3179210",
    "end": "3186490"
  },
  {
    "text": "and so on, to look at how LLMs\nor very powerful predictors can be used as very\ngood compressors, right?",
    "start": "3186490",
    "end": "3194140"
  },
  {
    "text": "And then we saw universal\ncompressors, right, where you don't even try to\nmodel your data explicitly.",
    "start": "3194140",
    "end": "3202119"
  },
  {
    "text": "It's very implicit. Basically, you have\na compressor that achieves the entropy for entropy\nrate for any stationary source,",
    "start": "3202120",
    "end": "3210170"
  },
  {
    "text": "right? And we focused mostly\non LZ77, but we have projects on both LZ77 and\nLZ78 as part of the projects.",
    "start": "3210170",
    "end": "3219550"
  },
  {
    "text": "And the last thing we did\nin lossless compression was we looked at some tips on how\nto use lossless compression",
    "start": "3219550",
    "end": "3227380"
  },
  {
    "text": "in practice, right? So in future, I would\nsuggest whenever you have a problem\nin your research,",
    "start": "3227380",
    "end": "3234849"
  },
  {
    "text": "at your job,\nwhatever, right, you want to compress something, take\na look at those slides, right?",
    "start": "3234850",
    "end": "3240550"
  },
  {
    "text": "Because oftentimes, we\nsee that people who are--",
    "start": "3240550",
    "end": "3246350"
  },
  {
    "text": "now that you know\ncompression, if you remember, if you did that quiz\nquestion, right, where you are asked to build\na compressor for your company",
    "start": "3246350",
    "end": "3253490"
  },
  {
    "text": "and what do you do, so always\nstart from first principles, right? Before you do anything\ncrazy, evaluate the thing,",
    "start": "3253490",
    "end": "3260599"
  },
  {
    "text": "understand how is\nthe standard doing? Do I have a model of the data? Can I compute the entropy?",
    "start": "3260600",
    "end": "3267829"
  },
  {
    "text": "Is there a gap between what\na standard compressor already gives me and what I\nwant to get to, right?",
    "start": "3267830",
    "end": "3273680"
  },
  {
    "text": "Don't just start writing\nyour own compressor for every file you get, right?",
    "start": "3273680",
    "end": "3279109"
  },
  {
    "text": "And so one key idea which kept\nrepeating in the first half and also in the second\nhalf is that however",
    "start": "3279110",
    "end": "3285590"
  },
  {
    "text": "complicated your data looks at\nthe first glance, what you want to do is you want\nto model it, you",
    "start": "3285590",
    "end": "3290600"
  },
  {
    "text": "want to transform\nit into something that can be used with\nstandard compressors, right?",
    "start": "3290600",
    "end": "3295730"
  },
  {
    "text": "Try to reuse the tools,\ndon't re-implement your Huffman coders\nand your arithmetic",
    "start": "3295730",
    "end": "3301010"
  },
  {
    "text": "coders and your LZ77 coders. Of course, for projects,\nyou do that, that's fine.",
    "start": "3301010",
    "end": "3306030"
  },
  {
    "text": "But in real life, right, you\nwant to use tools that exist.",
    "start": "3306030",
    "end": "3311130"
  },
  {
    "text": "And then we switch to\nlossy compression, right? So mostly Pulkit [INAUDIBLE]\nand Saki talked about it.",
    "start": "3311130",
    "end": "3319420"
  },
  {
    "text": "So we started with\nsome fundamentals. We looked at\nquantization, the simplest",
    "start": "3319420",
    "end": "3324510"
  },
  {
    "text": "form of lossy compression. Scalar quantization,\nuniform scalar quantization.",
    "start": "3324510",
    "end": "3330360"
  },
  {
    "text": "We looked at rate-distortion\ntheory, which is the corresponding\nthing to entropy,",
    "start": "3330360",
    "end": "3336030"
  },
  {
    "text": "and we understood the\nfundamental limits there. And then we looked at\nvector quantization and then",
    "start": "3336030",
    "end": "3342150"
  },
  {
    "text": "we looked at transform coding\nbased on the intuition with-- we looked at that\neigenvector decomposition",
    "start": "3342150",
    "end": "3348480"
  },
  {
    "text": "and tried to understand how to\ndecorrelate the input, right? And we learned about DCT,\nwhich is a transform that",
    "start": "3348480",
    "end": "3358800"
  },
  {
    "text": "works really well for images. As you might have seen\nif you didn't see now, you will see later if\nyou ever try to use this,",
    "start": "3358800",
    "end": "3365820"
  },
  {
    "text": "is that the theory\nfor lossy compression is maybe not as\nuseful as the theory for lossless compression.",
    "start": "3365820",
    "end": "3373200"
  },
  {
    "text": "If I give you for lossless\ncompression for an IID source,",
    "start": "3373200",
    "end": "3378210"
  },
  {
    "text": "you know how to\nachieve the entropy within two bits using arithmetic\ncoding, for example, right?",
    "start": "3378210",
    "end": "3383700"
  },
  {
    "text": "But in lossy compression, there\nis no such simple algorithms, unfortunately. So that's one thing.",
    "start": "3383700",
    "end": "3390528"
  },
  {
    "text": "And the other thing\nis you don't even know the fundamental limit. If you go beyond the\nGaussian distribution,",
    "start": "3390528",
    "end": "3396240"
  },
  {
    "text": "you go to some\nother distribution. Oftentimes, you can only\nestimate the rate distortion function.",
    "start": "3396240",
    "end": "3402030"
  },
  {
    "text": "However, it still gives you a\nlot of good insights, right? And as we saw in\nthe design of JPEG,",
    "start": "3402030",
    "end": "3407460"
  },
  {
    "text": "it was a very nice mix of theory\nand human perception, right?",
    "start": "3407460",
    "end": "3413450"
  },
  {
    "text": "So oftentimes, you\nstart with the theory then you bring in\nhuman perception.",
    "start": "3413450",
    "end": "3418970"
  },
  {
    "text": "Not anymore. Nowadays, you just do machine\nlearning but in the olden days,",
    "start": "3418970",
    "end": "3424230"
  },
  {
    "text": "this is not correct, right? Even in machine learning, you\nneed to understand the theory",
    "start": "3424230",
    "end": "3429440"
  },
  {
    "text": "to do things, but yeah. And then we looked at image\ncompression for a few lectures.",
    "start": "3429440",
    "end": "3438230"
  },
  {
    "text": "So we looked at JPEG. We looked at ML-based\nimage compression. Some of you might have gotten\nan intro to transforms signals",
    "start": "3438230",
    "end": "3446359"
  },
  {
    "text": "and systems, DCT. And we looked at a demo\non audio compression.",
    "start": "3446360",
    "end": "3454299"
  },
  {
    "text": "And today's lecture, we looked\nat video compression, right? And as you might\nhave noticed, you",
    "start": "3454300",
    "end": "3461800"
  },
  {
    "text": "keep seeing this block diagram\nmany, many times, right? So you start with something, you\ntransform it to decorrelate it,",
    "start": "3461800",
    "end": "3468640"
  },
  {
    "text": "and then in the cases\nof images or audio, you apply some sort\nof quantization.",
    "start": "3468640",
    "end": "3474790"
  },
  {
    "text": "In case of video, there\nis this residual thing happening where you try\nto subtract, compensate",
    "start": "3474790",
    "end": "3481240"
  },
  {
    "text": "for the motion and so on. And after you do this\nquantization, which is the only lossy\npart of the equation,",
    "start": "3481240",
    "end": "3487090"
  },
  {
    "text": "you do some lossless coding. And here, you can use any\nof your lossless coders. And in fact, PNG uses LZ77, JPEG\nuses Huffman coding and so on.",
    "start": "3487090",
    "end": "3497410"
  },
  {
    "text": "The new ones use\narithmetic coding or ANS. ",
    "start": "3497410",
    "end": "3505610"
  },
  {
    "text": "And it's a big,\nbig topic, right? Even the things we covered, we\ncouldn't cover in full detail. Video compression, this was just\na very initial basic flavor.",
    "start": "3505610",
    "end": "3513619"
  },
  {
    "text": "Image compression, we just\ntalked mostly about JPEG, but JPEG is now 20 years old.",
    "start": "3513620",
    "end": "3519710"
  },
  {
    "text": "And there were topics that\nare very exciting that we didn't even get to. So for example,\ndistributed compression.",
    "start": "3519710",
    "end": "3527990"
  },
  {
    "text": "If you have multiple\nsensors, multiple nodes, they want to compress\ntheir own data",
    "start": "3527990",
    "end": "3533299"
  },
  {
    "text": "but their data\ndepends on each other. So how can they compress\nit together, right?",
    "start": "3533300",
    "end": "3539569"
  },
  {
    "text": "And actually, the puzzle\nin homework three, the one that you wanted to\nsend X and the other guy",
    "start": "3539570",
    "end": "3545660"
  },
  {
    "text": "had Y gives you some\nsense of how to do this. And this actually ties\ninto the other part of information theory, which\nis error correction coding.",
    "start": "3545660",
    "end": "3553520"
  },
  {
    "text": "And the tools from\nerror correction coding are used for distributed\ncompression very often.",
    "start": "3553520",
    "end": "3558800"
  },
  {
    "text": "Another thing we didn't look\nat as much as succinct data structures, which is--",
    "start": "3558800",
    "end": "3564840"
  },
  {
    "text": "so the way we thought\nabout compression throughout the\nclass was you start with an uncompressed file.",
    "start": "3564840",
    "end": "3570003"
  },
  {
    "text": "You compress it. You keep it in cold storage,\nthen you bring it out then you decompress it, right? ",
    "start": "3570003",
    "end": "3576848"
  },
  {
    "text": "I guess, the first time you saw\nsomething different was today in case of videos, where you\nsaw that you have a large video",
    "start": "3576848",
    "end": "3583019"
  },
  {
    "text": "file on YouTube,\nand you certainly want to seek to a particular\nspot in the video.",
    "start": "3583020",
    "end": "3588280"
  },
  {
    "text": "You don't want to decompress\nthe whole video to do that. You want some level of\nrandom access to the video.",
    "start": "3588280",
    "end": "3593619"
  },
  {
    "text": "This happens a lot, right? I've seen it in\ngenomics a lot where you have a lot of genomic data\nand you want to search over",
    "start": "3593620",
    "end": "3600970"
  },
  {
    "text": "the data very quickly,\nbut you also want to store it compressed, right? So you want to get the\nbenefits of compression",
    "start": "3600970",
    "end": "3607930"
  },
  {
    "text": "without losing your ability\nto randomly access the data, or do some operations\non the data, right?",
    "start": "3607930",
    "end": "3614859"
  },
  {
    "text": "So this is just\nlike one big field of succinct data structures. ",
    "start": "3614860",
    "end": "3621340"
  },
  {
    "text": "And one thing we saw a\nlittle but not as much as-- ",
    "start": "3621340",
    "end": "3627750"
  },
  {
    "text": "I think [? Saki ?] likes to call\nit compression for hardware, in hardware, or compression\nfor neural networks,",
    "start": "3627750",
    "end": "3635520"
  },
  {
    "text": "of neural networks,\nby neural networks. So I guess, we did\nsee compression using neural networks, right?",
    "start": "3635520",
    "end": "3641760"
  },
  {
    "text": "But there is a\ncorresponding thing where you have a\nneural network model. Some of you might have been\nfollowing the recent LLM",
    "start": "3641760",
    "end": "3649590"
  },
  {
    "text": "trend might have seen\nthat people are trying to quantize the models, right? They're trying to sparsify the\nmodels to all sorts of things",
    "start": "3649590",
    "end": "3656010"
  },
  {
    "text": "to make the models\nsmaller, right? And oftentimes, various ideas\nfrom compression are useful,",
    "start": "3656010",
    "end": "3661290"
  },
  {
    "text": "they're also from optimization. So you want to do it in a way\nthat does not lose accuracy.",
    "start": "3661290",
    "end": "3667369"
  },
  {
    "text": "So it's a form of\nlossy compression where the distortion is not\nhuman perception, right?",
    "start": "3667370",
    "end": "3673090"
  },
  {
    "text": "There is no human\nperception related to the weights of\na neural network, but the distortion is the\naccuracy of the model.",
    "start": "3673090",
    "end": "3679943"
  },
  {
    "text": "You want to lossily\ncompress it in a way that it does not\nlose its accuracy. Another thing is\ncompression in hardware.",
    "start": "3679943",
    "end": "3686810"
  },
  {
    "text": "So we saw today that the\nApple chips, for example, or most of these processors\nhave a dedicated video coding",
    "start": "3686810",
    "end": "3692480"
  },
  {
    "text": "hardware. Similarly, Z standard,\none of the reasons it's so much faster\nthan gzip is that it",
    "start": "3692480",
    "end": "3698570"
  },
  {
    "text": "can use dedicated instructions. It can use special\nsame-day instructions,",
    "start": "3698570",
    "end": "3703579"
  },
  {
    "text": "so that's a big\nfield, basically. How do you use the existing\ninstructions on your processor",
    "start": "3703580",
    "end": "3711180"
  },
  {
    "text": "to make compression faster? We have some projects which\nare doing compression on a GPU, for example.",
    "start": "3711180",
    "end": "3716940"
  },
  {
    "text": "And the corresponding thing\nis, if you have a compression problem, can you then\ndesign specialized hardware",
    "start": "3716940",
    "end": "3723300"
  },
  {
    "text": "that can improve that\nparticular algorithm? ",
    "start": "3723300",
    "end": "3728570"
  },
  {
    "text": "And then we mostly stuck to\ngeneral purpose compression, except for image and\nvideo, which is very big.",
    "start": "3728570",
    "end": "3735170"
  },
  {
    "text": "But there are a lot of work\non special domains, right? So AR/VR is one.",
    "start": "3735170",
    "end": "3741830"
  },
  {
    "text": "I think Pulkit\nbriefly mentioned it. If you have this\nvirtual reality headset,",
    "start": "3741830",
    "end": "3748100"
  },
  {
    "text": "right, you are transmitting huge\namounts of data to the headset. It's a 3D model of\nthe thing, and you",
    "start": "3748100",
    "end": "3754280"
  },
  {
    "text": "want to be very intentional\nabout how you compress it, right? If the person is looking at\nthis spot in their VR thing,",
    "start": "3754280",
    "end": "3761270"
  },
  {
    "text": "you use more bits\non the part they are looking at and\nless bits for the part they're not looking at. So people optimized very fine\ngrained way to get the best.",
    "start": "3761270",
    "end": "3771440"
  },
  {
    "text": "Basically, you want the\nheadset to not heat up and the wires to not be\nsuper thick and so on, right?",
    "start": "3771440",
    "end": "3778700"
  },
  {
    "text": "So compression plays\na big role, right? I don't know about\nthe Vision Pro,",
    "start": "3778700",
    "end": "3784220"
  },
  {
    "text": "maybe Kedar can tell\nus about some secrets, but I'm sure there was some\ncompression somewhere in there.",
    "start": "3784220",
    "end": "3790715"
  },
  {
    "text": " Similarly, genomics, right?",
    "start": "3790715",
    "end": "3796819"
  },
  {
    "text": "It's a very rapidly\ngrowing field. And I got my opportunity to work\non genomics for most of my PhD.",
    "start": "3796820",
    "end": "3806410"
  },
  {
    "text": "Lots of very interesting\napplications there, both in terms of\ncompressing things and sometimes\nlosslessly, sometimes",
    "start": "3806410",
    "end": "3813339"
  },
  {
    "text": "lossily compressing things. And also, being able to\ncompress while maintaining",
    "start": "3813340",
    "end": "3819010"
  },
  {
    "text": "random access, so succinct data\nstructures and so on, right? People here I think are working\non a few different domains.",
    "start": "3819010",
    "end": "3826450"
  },
  {
    "text": "We will see on Wednesday\nwith the projects. So yeah, some part we got to,\nsome part we didn't get to.",
    "start": "3826450",
    "end": "3835240"
  },
  {
    "text": "But hopefully, you enjoyed it. So what next?",
    "start": "3835240",
    "end": "3842200"
  },
  {
    "text": "So if you liked the\nclass, even if you didn't like, in any case,\nthere are these resources",
    "start": "3842200",
    "end": "3847510"
  },
  {
    "text": "available to you. One is this Stanford\nCompression Library. ",
    "start": "3847510",
    "end": "3854310"
  },
  {
    "text": "You have used it\nfor your homework. There are parts you\nmight have not seen as part of the\nhomework, so we will",
    "start": "3854310",
    "end": "3862110"
  },
  {
    "text": "try to keep improving\nit over the years. And hopefully, some of you,\nyour projects we want to",
    "start": "3862110",
    "end": "3867359"
  },
  {
    "text": "include as-- basically, if you create\na merge request and we do want to include some of\nthat in the library itself.",
    "start": "3867360",
    "end": "3875130"
  },
  {
    "text": "And the whole idea\nis to make something that's easy for people to\nuse and easy for people",
    "start": "3875130",
    "end": "3883290"
  },
  {
    "text": "to use experiment with\nand understand, right? A lot of it started with us\nwanting to understand how",
    "start": "3883290",
    "end": "3889470"
  },
  {
    "text": "arithmetic coding or ANS\nor range coding works, and running into very optimized\nC code where people don't even",
    "start": "3889470",
    "end": "3898170"
  },
  {
    "text": "want to write-- they don't even write and like\na normal beginner programmer.",
    "start": "3898170",
    "end": "3904440"
  },
  {
    "text": "They just combine everything\ninto a weird bitmask thing, very, very hard to interpret\na lot of that code.",
    "start": "3904440",
    "end": "3910605"
  },
  {
    "text": " So we made an effort,\nand it's been useful for us to teach the\nclass, if nothing else,",
    "start": "3910605",
    "end": "3917170"
  },
  {
    "text": "and hopefully, it's\nuseful to some of you. The website has some resources.",
    "start": "3917170",
    "end": "3923020"
  },
  {
    "text": "Take a look. We hope to keep\nupdating it over time. ",
    "start": "3923020",
    "end": "3929190"
  },
  {
    "text": "And then there are other\nclasses at Stanford which you might find interesting. So EE276, information theory,\nthe first few lectures",
    "start": "3929190",
    "end": "3939960"
  },
  {
    "text": "of this class will be\ncommon, but then, there is a lot more theory. You will get much\nbetter at the basics.",
    "start": "3939960",
    "end": "3946380"
  },
  {
    "text": "[? Saki, ?] are\nyou teaching this? So [? Saki ?] will be\nteaching it this year, right?",
    "start": "3946380",
    "end": "3952848"
  },
  {
    "text": "And especially, in\nlossy compression, I think you will see\nmuch more theory. ",
    "start": "3952848",
    "end": "3962349"
  },
  {
    "text": "EE376 topics in\ninformation theory. There used to be a\nseries E, 376 ABC.",
    "start": "3962350",
    "end": "3969760"
  },
  {
    "text": "376C was the first\ncourse I took at Stanford when I came to Stanford. It was called universal schemes\nin information theory, where",
    "start": "3969760",
    "end": "3977290"
  },
  {
    "text": "we actually proved\nthat LZ78 achieves the entropy rate for stationary\nsources and even more",
    "start": "3977290",
    "end": "3983380"
  },
  {
    "text": "powerful finite results.",
    "start": "3983380",
    "end": "3988480"
  },
  {
    "text": "I don't know if\nthere is a plan to-- is there plan?",
    "start": "3988480",
    "end": "3993714"
  },
  {
    "text": "There is a plan but-- OK. [INAUDIBLE] OK, OK, so yeah.",
    "start": "3993715",
    "end": "3998980"
  },
  {
    "text": "If you are at Stanford when\nthat happens, take a look.",
    "start": "3998980",
    "end": "4004460"
  },
  {
    "text": "For those who are\ninterested in music audio, there is a class\ncalled Music 422 which",
    "start": "4004460",
    "end": "4011390"
  },
  {
    "text": "I think is running this year. Please check, right? We looked at a bit of audio\ncoding in that one notebook",
    "start": "4011390",
    "end": "4019340"
  },
  {
    "text": "that Pulkit showed. But there is much more, there's\na lot of psycho acoustics type",
    "start": "4019340",
    "end": "4025340"
  },
  {
    "text": "things, a lot of human\nperception comes in. And if you look at the mp3 or\nAAC or any of these codecs,",
    "start": "4025340",
    "end": "4033500"
  },
  {
    "text": "they are pretty complicated. They do a lot of things\nto optimize things.",
    "start": "4033500",
    "end": "4038930"
  },
  {
    "text": "And in fact, audio coding\nis also one of those domains where recently, machine\nlearning-based methods,",
    "start": "4038930",
    "end": "4045350"
  },
  {
    "text": "particularly from Facebook, have\nbeen very, very influential.",
    "start": "4045350",
    "end": "4050780"
  },
  {
    "text": "And finally this class, which\nis not strictly on compression, it's on modeling probabilistic\ngraphical models.",
    "start": "4050780",
    "end": "4058369"
  },
  {
    "text": "And I would say, in today's\nday and age, even CS 236 which is on generative\nmodels in AI,",
    "start": "4058370",
    "end": "4066510"
  },
  {
    "text": "those might be useful for\nyou because we talked about, if you have a good\nmodel, then you can build a good compressor.",
    "start": "4066510",
    "end": "4072029"
  },
  {
    "text": "But how do you get\nthe good model? How do you actually\nfind a good model? And that usually comes in terms\nof either this sort of more",
    "start": "4072030",
    "end": "4078810"
  },
  {
    "text": "probabilistic techniques or\nmore machine learning type techniques, right? ",
    "start": "4078810",
    "end": "4086190"
  },
  {
    "text": "So, yeah. So my journey in compression\nbasically started in 2016 when I joined [? Saki's ?] lab.",
    "start": "4086190",
    "end": "4092430"
  },
  {
    "text": "I had no idea I was going\nto do compression in my PhD. He gave me a problem,\nI started with it.",
    "start": "4092430",
    "end": "4098930"
  },
  {
    "text": "It's coming to an end\nnow, but hopefully, I will come back to it and I\nwill be in touch, definitely.",
    "start": "4098930",
    "end": "4106278"
  },
  {
    "text": "So thank you. Hopefully, you enjoyed. Thank you to all the instructors\nand to the students and ITA.",
    "start": "4106279",
    "end": "4113380"
  },
  {
    "start": "4113380",
    "end": "4118000"
  }
]