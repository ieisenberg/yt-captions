[
  {
    "start": "0",
    "end": "5360"
  },
  {
    "text": "Today, we're going to\njump back into where we left off last week. And then, I'm just going to\nfinish up these last two things.",
    "start": "5360",
    "end": "11760"
  },
  {
    "text": "And then, we're going to\nhave a really cool guest lecture that I think you\nguys will really enjoy. OK, so last week we talked\nabout doing falsification, so",
    "start": "11760",
    "end": "20990"
  },
  {
    "text": "finding failures of systems. And specifically,\nlast Thursday, we talked about doing falsification\nusing planning techniques.",
    "start": "20990",
    "end": "27870"
  },
  {
    "text": "So we talked a lot about\ntree search specifically, two different types of tree\nsearch, heuristic search and Monte Carlo tree search,\nwhere heuristic search",
    "start": "27870",
    "end": "35390"
  },
  {
    "text": "was a lot of\ndifferent variations of an algorithm called rapidly\nexploring random trees.",
    "start": "35390",
    "end": "41030"
  },
  {
    "text": "And we left off with\nMonte Carlo tree search. And so today, I just want to\ndive into these two last things,",
    "start": "41030",
    "end": "47250"
  },
  {
    "text": "starting with\nreinforcement learning. So if we take a\nstep back and think",
    "start": "47250",
    "end": "52370"
  },
  {
    "text": "about the high-level approach\nto what we were doing or the high-level setup\nthat we have here is",
    "start": "52370",
    "end": "58579"
  },
  {
    "text": "we have this kind of system\nthat we've been testing, and we can think\nof ourselves kind of testing this system as\nan adversary for the system.",
    "start": "58580",
    "end": "66270"
  },
  {
    "text": "So we're trying to cause\nthe system to fail. And what the adversary can do\nis it can give disturbances",
    "start": "66270",
    "end": "72350"
  },
  {
    "text": "to the system at each time step. The system then takes its\nstep, calling that step",
    "start": "72350",
    "end": "77600"
  },
  {
    "text": "function we talked about. And then, the\nsystem can spit back out some reward\nfor the adversary. And so it's kind\nof weird to think",
    "start": "77600",
    "end": "83900"
  },
  {
    "text": "of reward as being a bad thing. But in this case, because\nit's an adversary, the adversary gets rewarded,\nthe worse the situation is.",
    "start": "83900",
    "end": "91110"
  },
  {
    "text": "So the closer that the\nsystem is to failure, the higher the\nreward, the adversary would get because the adversary\nis trying to make it fail.",
    "start": "91110",
    "end": "97670"
  },
  {
    "text": "And so this kind of loop here,\nwhere you have the system here, you have this\nadversary, this might look familiar to some of you,\nand it might specifically",
    "start": "97670",
    "end": "105618"
  },
  {
    "text": "remind you of the answers\nkind of already on the slide. It might remind you of\nreinforcement learning.",
    "start": "105618",
    "end": "110870"
  },
  {
    "text": "And so what's really cool\nand the key insight here is that this is exactly\nthe setup that we have for reinforcement\nlearning, where",
    "start": "110870",
    "end": "117049"
  },
  {
    "text": "we're trying to train an\nagent to do some task, and it gets some\nreward feedback, and it can take some actions.",
    "start": "117050",
    "end": "123160"
  },
  {
    "text": "In this case, the\nactions are disturbances and we don't call it an agent. We call it an\nadversary in this class",
    "start": "123160",
    "end": "128910"
  },
  {
    "text": "because we don't want to get it\nconfused with the agent that's in the systems.",
    "start": "128910",
    "end": "133980"
  },
  {
    "text": "But the idea here\nis now we can just take advantage of all of\nthese reinforcement learning algorithms that are out\nthere, using this setup",
    "start": "133980",
    "end": "139950"
  },
  {
    "text": "to train an adversary that\ncan cause our system to fail. So I'm not really\ngoing to get into what",
    "start": "139950",
    "end": "146040"
  },
  {
    "text": "the different reinforcement\nlearning algorithms are. That's obviously another\nentire course here at Stanford. But what's cool is, if we can\nset our system up in this way,",
    "start": "146040",
    "end": "154117"
  },
  {
    "text": "we can just plug in off the\nshelf reinforcement learning algorithms to do this. Why would we want to do this?",
    "start": "154117",
    "end": "161310"
  },
  {
    "text": "So what's really\ncool about this is there's been a ton of research\nin the field of reinforcement learning over the\nlast couple of decades",
    "start": "161310",
    "end": "168210"
  },
  {
    "text": "to design reinforcement\nlearning algorithms that are sample-efficient. So we want to do the fewest\nsteps through this loop",
    "start": "168210",
    "end": "174360"
  },
  {
    "text": "as we can to learn a good policy\nor to learn a good adversary and the entire field\nof reinforcement",
    "start": "174360",
    "end": "180239"
  },
  {
    "text": "learning, a huge focus area is\nthis kind of sample efficiency. So we can take advantage of all\nof this research and work that's",
    "start": "180240",
    "end": "186450"
  },
  {
    "text": "already been done in\nthat field in order to very efficiently find\nfailures using reinforcement",
    "start": "186450",
    "end": "192060"
  },
  {
    "text": "learning, which is pretty cool. Another thing that's\ncool, that's kind of different from the other\nalgorithms that we saw last week",
    "start": "192060",
    "end": "200040"
  },
  {
    "text": "is that it can generalize\nto different initial states. So if you remember when\nwe were doing tree search, we started from\nsome initial state,",
    "start": "200040",
    "end": "205659"
  },
  {
    "text": "and then we just built\na tree out from that. And so we would need to\nstart from a whole bunch of different\ninitial states if we",
    "start": "205660",
    "end": "211890"
  },
  {
    "text": "wanted to find failures\nfrom different states using tree search. But with reinforcement learning,\na lot of these algorithms",
    "start": "211890",
    "end": "218700"
  },
  {
    "text": "allow the agent to generalize\nto a lot of different states or the adversary to generalize\nto a lot of different states.",
    "start": "218700",
    "end": "224700"
  },
  {
    "text": "And so we can actually\njust, off the bat, find failures from a lot of\ndifferent starting points.",
    "start": "224700",
    "end": "232170"
  },
  {
    "text": "OK, so now, I'm going\nto show an example. So what's going on here is we\nhave our continuum world again.",
    "start": "232170",
    "end": "238215"
  },
  {
    "text": "But now, instead\nof just starting from one initial\nstate over here, as we had been for the\nrest-- for the other part",
    "start": "238215",
    "end": "244209"
  },
  {
    "text": "of this lecture, we're going\nto start from a whole bunch of different initial states. So all of these\nkind of trajectories",
    "start": "244210",
    "end": "249790"
  },
  {
    "text": "here are just trajectories that\nstart from some initial state and then roll out to some path.",
    "start": "249790",
    "end": "256058"
  },
  {
    "text": "And our goal is to make all\nof these trajectories fail. So right now, none\nof them are actually ending up in the obstacle. So none of them fail.",
    "start": "256058",
    "end": "261829"
  },
  {
    "text": "And what we want to do is train\na reinforcement learning agent to select disturbances in\neach of these different states",
    "start": "261829",
    "end": "267729"
  },
  {
    "text": "that it's in throughout\nits trajectory to cause it to run into the obstacle. So when I show this\nanimation, you'll",
    "start": "267730",
    "end": "275020"
  },
  {
    "text": "see over time what the training\nof this reinforcement learning agent looks like. And you'll see that\nwe can progressively",
    "start": "275020",
    "end": "280810"
  },
  {
    "text": "train it to produce failures\nfrom these different initial states. ",
    "start": "280810",
    "end": "289840"
  },
  {
    "text": "OK, cool. So now, you see that most\nof these trajectories, they start from\nsome initial state, and we've trained this adversary\nto pick disturbances that cause",
    "start": "289840",
    "end": "297820"
  },
  {
    "text": "it to move into the obstacle. OK, and so this is what\nthe training kind of looked",
    "start": "297820",
    "end": "303190"
  },
  {
    "text": "like over time. So after a few\ntraining steps, it's still not hasn't\nquite figured it out.",
    "start": "303190",
    "end": "308539"
  },
  {
    "text": "But as we train for\nlonger, the adversary is able to get better and better\nat causing the system to fail.",
    "start": "308540",
    "end": "315000"
  },
  {
    "text": "Yeah. Sorry, can you\nclarify what exactly we mean by causing it to fail. Is it perturbing the environment\nfrom the agent's perspective,",
    "start": "315000",
    "end": "321789"
  },
  {
    "text": "or is forcing an agent's hands,\nor what exactly is it doing? Yeah, good question. So the question was, can\nI explain what exactly I",
    "start": "321790",
    "end": "329170"
  },
  {
    "text": "mean by causing it to fail. So what's going on\nhere is that loop we had that I showed a few\nslides ago, this loop here,",
    "start": "329170",
    "end": "339169"
  },
  {
    "text": "so at every single time\nstep the adversary gets to pick a disturbance. So the disturbance\nis like those things we talked about before where\nit could be on the agent.",
    "start": "339170",
    "end": "345590"
  },
  {
    "text": "It could be on the environment. It could be on the sensor. Whatever the disturbances\nare for the system, at every time step, the\nagent-- or the adversary",
    "start": "345590",
    "end": "351870"
  },
  {
    "text": "is picking that. So we're basically\ntraining an adversary to pick disturbances that\nshould cause the system to fail.",
    "start": "351870",
    "end": "358435"
  },
  {
    "text": "Yeah.  I think we'll just have to\nwatch that cool animation again.",
    "start": "358435",
    "end": "365250"
  },
  {
    "text": "Oh, darn.  OK, I can't see it animating\non my screen, which",
    "start": "365250",
    "end": "372870"
  },
  {
    "text": "is why I always look up there\nwhen it's actually moving. OK, cool. So one last thing here.",
    "start": "372870",
    "end": "379240"
  },
  {
    "text": "I think I have found the actual\nuse for the fireworks animation.",
    "start": "379240",
    "end": "385117"
  },
  {
    "text": "[LAUGHING] All right. OK.",
    "start": "385118",
    "end": "391860"
  },
  {
    "text": "So just one more note here. So using MCTS, which is what\nwe talked about last week,",
    "start": "391860",
    "end": "397870"
  },
  {
    "text": "and then reinforcement\nlearning to search for the most likely\nfailure of a system is often referred\nto as a concept",
    "start": "397870",
    "end": "404280"
  },
  {
    "text": "that we call adaptive\nstress testing. So if you've heard that phrase\nthrown around, all it means",
    "start": "404280",
    "end": "409290"
  },
  {
    "text": "is kind of doing\nwhat we just did. And typically, we associate\nadaptive stress testing if you're objective\nthat you're using.",
    "start": "409290",
    "end": "415585"
  },
  {
    "text": "So in that case,\nmaybe the reward for the reinforcement\nlearning agent has some notion of\nlikelihood in it.",
    "start": "415585",
    "end": "420979"
  },
  {
    "text": "But in general,\nit's just when we're trying to find the\nmost likely failure. We call it adaptive\nstress testing.",
    "start": "420980",
    "end": "426000"
  },
  {
    "text": "And Anthony is going to talk\na lot more about that today in his guest lecture. But what's kind of cool is that\nthe idea of adaptive stress",
    "start": "426000",
    "end": "432319"
  },
  {
    "text": "testing was actually\nformed in our lab here by a former student\nnamed Ritchie Lee. So you can check out this\nwork if you're interested.",
    "start": "432320",
    "end": "439860"
  },
  {
    "text": "And Anthony, again, we'll\ntalk a lot more about it. So that's\nreinforcement learning.",
    "start": "439860",
    "end": "445530"
  },
  {
    "text": "And then, finally, I just\nwant to briefly touch on simulator requirements. But more generally, I just want\nto talk about this topic of OK,",
    "start": "445530",
    "end": "453240"
  },
  {
    "text": "how do I actually go about\npicking a falsification method? So we just went over a ton of\nmethods in the last week or so",
    "start": "453240",
    "end": "459890"
  },
  {
    "text": "for doing falsification. And so you might be\nwondering like, OK, well, how do I decide what to do. And maybe this is also relevant\nas you're doing the project.",
    "start": "459890",
    "end": "467600"
  },
  {
    "text": "Like, what do I even\ndecide what to do? And so there's a lot\nof considerations here. So one is just a\ngeneral consideration.",
    "start": "467600",
    "end": "477490"
  },
  {
    "text": "It's very domain-specific. So some of these algorithms\nmight work really well in one domain and work\nterribly in another domain,",
    "start": "477490",
    "end": "483190"
  },
  {
    "text": "and sometimes you don't know\nuntil you just try them out. Another thing to think about\nis the rarity of failures.",
    "start": "483190",
    "end": "490419"
  },
  {
    "text": "So if the failures of your\nsystem are not super rare, it's not safety\ncritical or it's just",
    "start": "490420",
    "end": "495630"
  },
  {
    "text": "in one of its initial\nstages, and it's still failing quite often,\nthen it might not be super efficient to go\nall the way to applying",
    "start": "495630",
    "end": "503340"
  },
  {
    "text": "like MCTS to find failures\nor these big gradient-based optimization to find failures.",
    "start": "503340",
    "end": "508900"
  },
  {
    "text": "You might just find\nthe failures by doing like that direct sampling\nthat we talked about of that first algorithm.",
    "start": "508900",
    "end": "515250"
  },
  {
    "text": "We talked about--\nand in that case, it's probably going to be\nmore efficient because there's no reason to sit down and try to\ntake gradients or do tree search",
    "start": "515250",
    "end": "521429"
  },
  {
    "text": "or anything like that\nif failures are already easy to find. But the more rare\nthese failures get,",
    "start": "521429",
    "end": "526920"
  },
  {
    "text": "the more benefit\nwe'll see to using these very sample-efficient\nalgorithms like tree search.",
    "start": "526920",
    "end": "534910"
  },
  {
    "text": "And then, finally, what's\nshown on this slide, this is a figure that\nwe have in the book. We just want to talk about--\nso one thing that will already",
    "start": "534910",
    "end": "542830"
  },
  {
    "text": "limit you to what\nfalsification methods you use is the type of\nsimulator that you have, so the type of\nmodel or simulator",
    "start": "542830",
    "end": "548980"
  },
  {
    "text": "that you're using to\nsimulate your system. So for example, suppose\nwe have a simulator",
    "start": "548980",
    "end": "555190"
  },
  {
    "text": "that we can put in\nan initial state, and we can put in a\nsequence of disturbances, and we get out the\ntrajectory that occurred",
    "start": "555190",
    "end": "561770"
  },
  {
    "text": "or maybe it's robustness\nor something like that, but we don't get to see what\nactually happened in between to generate that trajectory.",
    "start": "561770",
    "end": "567890"
  },
  {
    "text": "So maybe, for example, this is\nlike a big flight simulator. We don't actually know what's\ngoing on under the hood.",
    "start": "567890",
    "end": "573579"
  },
  {
    "text": "In that case, then,\nwe could use methods like direct sampling,\nfuzzing, direct methods,",
    "start": "573580",
    "end": "578930"
  },
  {
    "text": "population methods,\nall these methods that don't require gradients. So that's something that could\nalready kind of limit you",
    "start": "578930",
    "end": "584950"
  },
  {
    "text": "off the bat. If you can't take the\ngradient of your system, then you can't use\nthese first-order and second-order methods.",
    "start": "584950",
    "end": "591160"
  },
  {
    "text": "And then, furthermore,\nthese kind of reinforcement\nlearning-based methods or tree search-based methods, they\nrequire us to actually",
    "start": "591160",
    "end": "597280"
  },
  {
    "text": "be able to take individual\nsteps of our system and stop, see what happened in\nbetween, make a new decision,",
    "start": "597280",
    "end": "602920"
  },
  {
    "text": "and then take another step. And so if you can't do\nthat with your simulator, if all you get to do\nis put in one thing and it gives you a\nwhole trajectory,",
    "start": "602920",
    "end": "609050"
  },
  {
    "text": "then you're not going to be able\nto use these types of methods. So this is just a rule of thumb\nto be thinking about as you",
    "start": "609050",
    "end": "615580"
  },
  {
    "text": "pick falsification methods. Yeah. Could you just pick\none [INAUDIBLE]?",
    "start": "615580",
    "end": "622300"
  },
  {
    "text": "What's the difference between\nthat one and the first category? Yeah, so the question was,\ncan I talk a little bit more",
    "start": "622300",
    "end": "627940"
  },
  {
    "text": "about first-order and\nsecond-order methods, what's the difference between\nthese and the first category. So first-order and\nsecond-order methods,",
    "start": "627940",
    "end": "634190"
  },
  {
    "text": "they're a type of method that\nfits in that local descent category that we talked\nabout last week, where you're",
    "start": "634190",
    "end": "640149"
  },
  {
    "text": "basically starting from\nan initial design point and you're taking steps\ntowards the minimum.",
    "start": "640150",
    "end": "645220"
  },
  {
    "text": "And when you do it using\nfirst-order and second-order methods, they require the\nfirst and second derivative",
    "start": "645220",
    "end": "650890"
  },
  {
    "text": "of the function or the\ngradient and the Hessian. And so if you can't\ncompute the gradient and the Hessian, for\nexample, maybe you",
    "start": "650890",
    "end": "657165"
  },
  {
    "text": "have a big flight\nsimulator, it's black box, you don't actually know\nwhat's going on inside. You can't compute the gradient\nof this with respect to this.",
    "start": "657165",
    "end": "664459"
  },
  {
    "text": "And so you wouldn't\nbe able to use these first- and\nsecond-order methods. But that said, if you\ncan compute the gradient,",
    "start": "664460",
    "end": "671533"
  },
  {
    "text": "the gradient tends to be a very\npowerful tool for actually doing this optimization. And so if you can\ncompute the gradient",
    "start": "671533",
    "end": "676630"
  },
  {
    "text": "it's a big plus because these\nmethods might perform better. Yeah.",
    "start": "676630",
    "end": "681639"
  },
  {
    "text": "Could you remind me\nagain what the difference is between direct sampling\nand direct methods? Sure, direct sampling\nis like we just--",
    "start": "681640",
    "end": "689115"
  },
  {
    "text": "it's that first\nalgorithm we presented. It's like Monte Carlo sampling. We just sample the system\na whole bunch of times.",
    "start": "689115",
    "end": "694389"
  },
  {
    "text": "Direct methods would be like\nlocal descent methods that take a step, but they don't\nuse gradient information",
    "start": "694390",
    "end": "701335"
  },
  {
    "text": "to decide what step they\nwant to take towards minimum. It's just like zero order. Yeah, exactly, zero order. Yeah, so another name for direct\nmethods is zero order methods.",
    "start": "701335",
    "end": "711500"
  },
  {
    "text": "Cool, so that's it for me today. So now, I'm super excited to\nintroduce our guest lecturer who",
    "start": "711500",
    "end": "718160"
  },
  {
    "text": "told me not to read his\nbio for an introduction. So here's Anthony.",
    "start": "718160",
    "end": "723949"
  },
  {
    "text": "Cool. Well, thanks so\nmuch for having me. Thank you. Sydney, I feel one of the worst\nthings that you can possibly do",
    "start": "723950",
    "end": "730490"
  },
  {
    "text": "is do a presentation\ndirectly after Sydney, so I don't recommend it. Her slides are always amazing.",
    "start": "730490",
    "end": "737010"
  },
  {
    "text": "I will do my best. So yeah, thank you for\njust saying my name. My name is Anthony Corso.",
    "start": "737010",
    "end": "743930"
  },
  {
    "text": "I'll give a short\nbackground of who I am. So I did my PhD here at Stanford\nwith Michael Kochenderfer",
    "start": "743930",
    "end": "752630"
  },
  {
    "text": "in SISL, and I worked a lot\nwith both Sydney and Robert and Harrison and a bunch\nof other folks in SISL",
    "start": "752630",
    "end": "758660"
  },
  {
    "text": "during my time here, and it's\na place I love very deeply. So it's a pleasure to be back,\nto be chatting with you all.",
    "start": "758660",
    "end": "765860"
  },
  {
    "text": "So after I did my\nPhD, I graduated in the middle of COVID,\nwhich was not maybe the best",
    "start": "765860",
    "end": "770899"
  },
  {
    "text": "time to go searching for a job. So I decided to stay\non as a postdoc, and I also helped run the\nStanford Center for AI safety.",
    "start": "770900",
    "end": "778380"
  },
  {
    "text": "For three years I was\nthe executive director. And during my time,\nboth as a PhD student",
    "start": "778380",
    "end": "783470"
  },
  {
    "text": "and as a postdoc and\nrunning the center, I got to work on a lot of\nreally cool, safety critical AI applications.",
    "start": "783470",
    "end": "790160"
  },
  {
    "text": "So for example, Sydney and I\nbuilt a vision-based aircraft collision avoidance system on\nan exchange trip in Edinburgh.",
    "start": "790160",
    "end": "799760"
  },
  {
    "text": "We worked on formal\nmethods for verifying machine learning components,\neven those that process images.",
    "start": "799760",
    "end": "806625"
  },
  {
    "text": "You'll learn a little bit more\nabout formal verification, I think, in later in the\ncourse, which is quite exciting.",
    "start": "806625",
    "end": "813120"
  },
  {
    "text": "And then, I worked a lot,\nespecially in my PhD, on the discovery of failure. So using these optimization,\nfalsification approaches,",
    "start": "813120",
    "end": "820240"
  },
  {
    "text": "and that's primarily what\nI'll be talking about today. Being at Stanford also get\na lot of cool opportunities",
    "start": "820240",
    "end": "826950"
  },
  {
    "text": "to work on random things. I worked on a project where we\nuse language models to simulate",
    "start": "826950",
    "end": "832949"
  },
  {
    "text": "human war games with a\nfew folks in our lab,",
    "start": "832950",
    "end": "838840"
  },
  {
    "text": "as well as at CSAC, worked on\nsome stuff related to the index report. But basically, the big concept\nthat I'm most interested in",
    "start": "838840",
    "end": "846270"
  },
  {
    "text": "is how we can use AI\nfor really important, safety-critical applications. So later on in my\npostdoc, I actually",
    "start": "846270",
    "end": "853140"
  },
  {
    "text": "switched directions a little bit\nor picked up some new research topics that really\nkind of changed",
    "start": "853140",
    "end": "858330"
  },
  {
    "text": "the direction of my\nlife, I would say. So Michael established a\nreally cool collaboration",
    "start": "858330",
    "end": "863610"
  },
  {
    "text": "with the folks at the Stanford\nSchool of Sustainability, who are thinking a lot about how\ndo we use the Earth's subsurface",
    "start": "863610",
    "end": "869970"
  },
  {
    "text": "to support the net\nzero transition. So we need things\nlike raw materials. We need copper, nickel, lithium,\nthings that go into batteries.",
    "start": "869970",
    "end": "879220"
  },
  {
    "text": "And infrastructure. We can get renewable\nenergy from the subsurface in terms of geothermal energy\nproduction as well as hydrogen",
    "start": "879220",
    "end": "886020"
  },
  {
    "text": "production and storage. And we can also\nuse the subsurface as a place to store carbon.",
    "start": "886020",
    "end": "891610"
  },
  {
    "text": "So instead of pumping it\nout into the atmosphere, if you trap it in\nsufficient concentrations,",
    "start": "891610",
    "end": "896860"
  },
  {
    "text": "you can put it underground and\ntrap it there for a long term, for a long time.",
    "start": "896860",
    "end": "902010"
  },
  {
    "text": "Now, what's cool about these\nproblems is they're very, very challenging decision problems. You have to figure out\nwhat to do in order",
    "start": "902010",
    "end": "907700"
  },
  {
    "text": "to operate these projects\nefficiently and safely. But they have a huge\namount of uncertainty. So we have no idea what's really\nunderneath the subsurface.",
    "start": "907700",
    "end": "915580"
  },
  {
    "text": "It's very difficult to observe. And so applying\nthese AI techniques for understanding\nwhat's in the subsurface",
    "start": "915580",
    "end": "921360"
  },
  {
    "text": "and how you make\ngood decisions there became the target of\nmy research interests.",
    "start": "921360",
    "end": "927060"
  },
  {
    "text": "And then, earlier in\n2024, in the spring, I started a company\ncalled Terra AI, which",
    "start": "927060",
    "end": "933960"
  },
  {
    "text": "I'll talk maybe a little\nbit more about at the end. That basically does\nthis type of work, but in an industrial setting.",
    "start": "933960",
    "end": "940750"
  },
  {
    "text": "So with that little\nintro, let me give you a quick outline of what I\nwant to talk about today.",
    "start": "940750",
    "end": "945920"
  },
  {
    "text": "So in the first\npart of the talk, for maybe 30\nminutes or so, we're going to talk about how\nwe use adaptive stress",
    "start": "945920",
    "end": "951070"
  },
  {
    "text": "testing in a variety of\ntransportation systems and use it in the\nreal-world, validating",
    "start": "951070",
    "end": "957850"
  },
  {
    "text": "real and complex\nautonomous systems. Then, the second part, I'm\ngoing to talk a little bit more about those Earth resource\nproblems that we talked about,",
    "start": "957850",
    "end": "965420"
  },
  {
    "text": "demonstrate why those\nare also safety-critical, and maybe float some\nideas about things you could think about for your\nfinal project or future research",
    "start": "965420",
    "end": "972970"
  },
  {
    "text": "directions. OK, so let's jump in. Oh, and by the way,\nfeel free to stop me",
    "start": "972970",
    "end": "978310"
  },
  {
    "text": "at any time for questions\nor comments or whatever. I want this to be as\ninteractive as possible. So please do so.",
    "start": "978310",
    "end": "985990"
  },
  {
    "text": "OK, so I think when it comes to\nthinking about using autonomous systems in really\nsafety-critical domains,",
    "start": "985990",
    "end": "992420"
  },
  {
    "text": "and I personally thought a lot\nabout the possible bad outcomes that could occur. It's always important\nto remember why we want",
    "start": "992420",
    "end": "999440"
  },
  {
    "text": "to do this in the first place. And I think there's a lot\nof really amazing things that could come\nfrom bringing more autonomy into our\ntransportation systems.",
    "start": "999440",
    "end": "1006880"
  },
  {
    "text": "So aircraft already--\naviation already enjoys a very high degree\nof safety standards,",
    "start": "1006880",
    "end": "1011930"
  },
  {
    "text": "but spaces are getting\nmore complex, more dense, and we really want to\nbe able to maintain that really high\nlevel of safety,",
    "start": "1011930",
    "end": "1018910"
  },
  {
    "text": "and things like\nthe ACAS X system that Michael and Robert and\nSydney have all worked on,",
    "start": "1018910",
    "end": "1025329"
  },
  {
    "text": "has been shown to improve\nthe factor of safety on for collision avoidance\nby a factor of 3 to 5,",
    "start": "1025329",
    "end": "1031369"
  },
  {
    "text": "which is pretty exciting. Similarly, right now,\ndriving accidents kill over a million\npeople every year,",
    "start": "1031369",
    "end": "1037159"
  },
  {
    "text": "and something like 94% of them\nare just due to human error. So if we could just\nbring that number down, that could be a huge\nbenefit to the world.",
    "start": "1037160",
    "end": "1046007"
  },
  {
    "text": "But of course, there are risks. So you may or may not\nhave already heard about this particular collision\nthat occurred back in 2018.",
    "start": "1046008",
    "end": "1054140"
  },
  {
    "text": "This was considered the\nfirst pedestrian fatality due to an autonomous vehicle. It was Uber ATG, which was\nUber's self-driving division,",
    "start": "1054140",
    "end": "1062390"
  },
  {
    "text": "which has now since collapsed. They were operating in\nArizona, and a woman",
    "start": "1062390",
    "end": "1068362"
  },
  {
    "text": "was crossing the street\nwith her bicycle. And due to a sequence of errors,\nbut primarily due to the system",
    "start": "1068362",
    "end": "1074710"
  },
  {
    "text": "not correctly classifying this\nperson bicycle combination and then poorly predicting\nwhere she would be,",
    "start": "1074710",
    "end": "1082039"
  },
  {
    "text": "the vehicle struck\nand killed her. So they're really,\nreally, really intense real-world consequences for\noperating these types of systems",
    "start": "1082040",
    "end": "1088570"
  },
  {
    "text": "out in the real world. Of course, now, we have a lot\nmore autonomy on the roads. So this was actually\njust from two years ago.",
    "start": "1088570",
    "end": "1095110"
  },
  {
    "text": "There were tons\nand tons of crashes related to the Tesla\nAutopilot feature, which",
    "start": "1095110",
    "end": "1100389"
  },
  {
    "text": "is not fully autonomous,\nbut indeed has led to a number of\nfatal collisions.",
    "start": "1100390",
    "end": "1106180"
  },
  {
    "text": "And really, what's\ngoing on here is that these systems are\njust brittle in the ways that machine learning\nsystems are brittle.",
    "start": "1106180",
    "end": "1111260"
  },
  {
    "text": "So here's someone\nvideotaping in their Tesla. It's seeing a bunch\nof traffic lights",
    "start": "1111260",
    "end": "1117460"
  },
  {
    "text": "kind of coming at\nit down the street, and you might wonder\nwhat's going on there, and then you see\nthat it's actually a truck transporting\ntraffic lights, driving",
    "start": "1117460",
    "end": "1124540"
  },
  {
    "text": "in front of the Tesla. And so it's these types\nof bizarre edge cases that you can't\nnecessarily predict",
    "start": "1124540",
    "end": "1132490"
  },
  {
    "text": "when you're going to put\nthese things on the road. OK.",
    "start": "1132490",
    "end": "1137632"
  },
  {
    "text": "Another thing that makes the\ndelivery of safe autonomy out in the world\nvery challenging is that we have very\nstringent safety",
    "start": "1137632",
    "end": "1144177"
  },
  {
    "text": "requirements in a lot of these\ndomains, as it should be. So in aviation, for example,\nwe might have a specification",
    "start": "1144177",
    "end": "1150340"
  },
  {
    "text": "that says, we can't have more\nthan a probability of failure that's higher than\n10 to the minus 9 for every 100 and 50\nseconds of flight time.",
    "start": "1150340",
    "end": "1158559"
  },
  {
    "text": "And so the companies that\nare building this autonomy have this extra challenge\nof proving to the regulators",
    "start": "1158560",
    "end": "1164410"
  },
  {
    "text": "that the system they are\nbuilding is sufficiently safe. And if you do that\nin simulation, and I think you\nguys may have talked",
    "start": "1164410",
    "end": "1170540"
  },
  {
    "text": "about this a lecture or two ago,\nif you need a level of safety at 10 to the minus 9, it's going\nto require billions and billions",
    "start": "1170540",
    "end": "1177890"
  },
  {
    "text": "of simulations in order\nfor us to gain confidence that we're reaching\nthat level of threshold.",
    "start": "1177890",
    "end": "1183200"
  },
  {
    "text": "How many simulations did\nyou guys run for ACAS X. Maybe about 100 billion.",
    "start": "1183200",
    "end": "1190040"
  },
  {
    "text": "100 billion, yeah, and that was\nusing a gigantic supercomputer. And it's tricky.",
    "start": "1190040",
    "end": "1197179"
  },
  {
    "text": "So all of this is to\nsay that if we just take a very naive approach to\nthe kind of safety validation",
    "start": "1197180",
    "end": "1203090"
  },
  {
    "text": "problem, it's going\nto be very difficult. And so that's why a lot\nof the research that's been done in this\nlab and many others",
    "start": "1203090",
    "end": "1209627"
  },
  {
    "text": "has focused on how can you more\nefficiently find these failure modes of the systems\nthat we wish to deploy.",
    "start": "1209627",
    "end": "1215419"
  },
  {
    "text": "So I want to talk a little bit. And thank you, Sydney, for\nthe introduction of what adaptive stress testing is. So adaptive stress testing\nis like a fancy term",
    "start": "1215420",
    "end": "1223970"
  },
  {
    "text": "for just doing falsification\nwith the most likely failure objective. So the key insight\nthat was brought",
    "start": "1223970",
    "end": "1230330"
  },
  {
    "text": "about in the original\nwork done by Ritchie Lee was, instead of just naively\nsearching for failures, let's actively look for those\nfailures using some known",
    "start": "1230330",
    "end": "1238610"
  },
  {
    "text": "optimization\ntechniques like tree search or deep\nreinforcement learning and setting up your\nproblem like this.",
    "start": "1238610",
    "end": "1245670"
  },
  {
    "text": "So this should look fairly\nsimilar to maybe some things that you've seen before. But the idea being that you\nhave your system under test,",
    "start": "1245670",
    "end": "1252410"
  },
  {
    "text": "this would be like\nyour agent, and it's taking actions in\nsome environment, and then we have an\nadversary that's perturbing",
    "start": "1252410",
    "end": "1260000"
  },
  {
    "text": "the environment in some way. So maybe that's controlling\nthe noise of the sensors or it's controlling the\nbehavior of other agents",
    "start": "1260000",
    "end": "1265700"
  },
  {
    "text": "in the environment,\nand it's doing so with some information\nabout what's happening within the environment.",
    "start": "1265700",
    "end": "1272052"
  },
  {
    "text": "And so when you\nset it up this way, you can apply those\noptimization and reinforcement learning algorithms\npretty straightforwardly.",
    "start": "1272052",
    "end": "1278300"
  },
  {
    "text": "The other key insight that\ncame in the original work on adaptive stress testing\nwas rather than just looking",
    "start": "1278300",
    "end": "1283700"
  },
  {
    "text": "for any old failure, which\nactually is sometimes easy to find\nbecause you can make",
    "start": "1283700",
    "end": "1289020"
  },
  {
    "text": "really extreme\ndisturbances, maybe you want to look for the\nmost likely failure, so those failures that are\nstill somewhat likely to occur",
    "start": "1289020",
    "end": "1297810"
  },
  {
    "text": "and are not really\nextreme examples of the types of disturbances\nthat you could apply.",
    "start": "1297810",
    "end": "1303780"
  },
  {
    "text": "So the early work on AST\nlooked something like this. So it's a pretty\nsimilar picture, but there's a few\nslight differences.",
    "start": "1303780",
    "end": "1309430"
  },
  {
    "text": "So they had a simulator. In this case, it was an ACAS\nX-style collision avoidance system, and it was packaged\nin a black box simulator",
    "start": "1309430",
    "end": "1318480"
  },
  {
    "text": "that they couldn't get a\nlot of internal workings of. But what they could\ndo is, at each step,",
    "start": "1318480",
    "end": "1323710"
  },
  {
    "text": "they could set the random\nseed of the simulator, and that random\nseed would change what the outcome of a\nprobabilistic sampling process",
    "start": "1323710",
    "end": "1330240"
  },
  {
    "text": "was. So they could put\nin the random seed, and then out would come\na transition probability.",
    "start": "1330240",
    "end": "1335265"
  },
  {
    "text": "So basically, if\nyou give a seed, it would you how likely that\ntransition was to occur. And then, it would also give\nyou some information about,",
    "start": "1335265",
    "end": "1341380"
  },
  {
    "text": "for example, whether or\nnot a collision occurred. That's the rare event\nthat you were looking for, but also a notion\nof how close the two",
    "start": "1341380",
    "end": "1347410"
  },
  {
    "text": "aircraft were at the\npoint of closest approach. So this can give you a\nlittle bit of a signal that you can work off of\nto inform the optimization.",
    "start": "1347410",
    "end": "1354800"
  },
  {
    "text": "So they put this into a\ntree search-style algorithm. And what came out\nwas very interesting.",
    "start": "1354800",
    "end": "1360340"
  },
  {
    "text": "What came out was the ability\nto find a fairly large number of near mid-air collisions\nbetween two aircraft that",
    "start": "1360340",
    "end": "1368050"
  },
  {
    "text": "were running this\ncollision avoidance system. So here we have of\na top-down view. And a side view. And it basically shows a\nparticular trajectory that",
    "start": "1368050",
    "end": "1374860"
  },
  {
    "text": "occurred, as well as some\nreversals in the advisory that was given, and\nthese results were",
    "start": "1374860",
    "end": "1381757"
  },
  {
    "text": "really useful to the\ndesigners of the system to understand what are\nthose configurations that could lead to failure.",
    "start": "1381757",
    "end": "1387940"
  },
  {
    "text": "OK, so-- yeah, please. [INAUDIBLE] question\nabout this seed that we put for the\n[INAUDIBLE], is there",
    "start": "1387940",
    "end": "1393730"
  },
  {
    "text": "any sort of-- so I guess\non the previous slide, is there any sort of\ninterpretation of that seed",
    "start": "1393730",
    "end": "1400809"
  },
  {
    "text": "or is it completely, I\nguess, in random generators. We think of the seed as really\nindependent of what comes out.",
    "start": "1400810",
    "end": "1407590"
  },
  {
    "text": "We can't really interpret it. So I wonder if there's\nany intuition as to why",
    "start": "1407590",
    "end": "1413080"
  },
  {
    "text": "the reinforcement learners\nshould be able to find good seeds, I guess. Yeah, great question.",
    "start": "1413080",
    "end": "1418520"
  },
  {
    "text": "So the question was\naround, is there a way to interpret the seed? The seed is something that's\nkind of just an input that",
    "start": "1418520",
    "end": "1425920"
  },
  {
    "text": "shouldn't necessarily\nlike choose seeds that are close will not necessarily\nlead to two outcomes that are similar.",
    "start": "1425920",
    "end": "1431450"
  },
  {
    "text": "And so why would why is it\nthe case that a reinforcement learner might be able to\nlearn something in this case.",
    "start": "1431450",
    "end": "1436930"
  },
  {
    "text": "So it's a great question. The algorithm that was used here\nwas not a deep reinforcement",
    "start": "1436930",
    "end": "1442059"
  },
  {
    "text": "learning algorithm. It was actually Monte\nCarlo tree search. And so what Monte Carlo\ntree search does is it's",
    "start": "1442060",
    "end": "1447430"
  },
  {
    "text": "actually just a pretty\nefficient way of searching down a branching tree. So you can think of the\nselection of each seed",
    "start": "1447430",
    "end": "1453340"
  },
  {
    "text": "as a different action. And then, it would explore\nregions of the tree where a few seeds in a row\nkind of led to a configuration",
    "start": "1453340",
    "end": "1460299"
  },
  {
    "text": "where the aircraft were\nalready getting close, and then it would do some\nmore random sampling. So you can think of it as almost\nlike Monte Carlo sampling,",
    "start": "1460300",
    "end": "1467570"
  },
  {
    "text": "but for parts of\nthe trajectory that are already leading to things\nthat are close to failure. And so it was just\nan efficient search.",
    "start": "1467570",
    "end": "1473690"
  },
  {
    "text": "Yeah. But in this graph,\nwe won't always know what the\nterminal tau is if we",
    "start": "1473690",
    "end": "1479710"
  },
  {
    "text": "were supplying a simulator with\nmultiple seeds in a sequence, right? So at every-- yeah,\nso the question is",
    "start": "1479710",
    "end": "1486160"
  },
  {
    "text": "like how do when the\nsimulation is over or when do you get\nthat signal tau? So I believe, and\nMichael can correct me--",
    "start": "1486160",
    "end": "1493179"
  },
  {
    "text": "so you're giving a seed\nthat's producing one step, and then the simulator\nwill tell you, was that step terminal or\nNot,0 Or was there a failure.",
    "start": "1493180",
    "end": "1500235"
  },
  {
    "text": "This is like a [INAUDIBLE] Yeah, correct. Yeah, great.",
    "start": "1500235",
    "end": "1505970"
  },
  {
    "text": "And yeah. Is there a connection between\nthe seed and the transition probability? Yeah. [INAUDIBLE]",
    "start": "1505970",
    "end": "1512170"
  },
  {
    "text": "Yeah, so the seed\nis what determines what the random\nnumber generator does.",
    "start": "1512170",
    "end": "1517460"
  },
  {
    "text": "And whatever the random\nnumber generator does, it will return to you the\nprobability that occurred.",
    "start": "1517460",
    "end": "1522809"
  },
  {
    "text": "So occasionally a seed will\nproduce a very low probability transition. And then most of the time,\nit 0 be a higher probability",
    "start": "1522810",
    "end": "1528889"
  },
  {
    "text": "transition. Yeah. And I believe this technique was\ntaken because of these H world",
    "start": "1528890",
    "end": "1535102"
  },
  {
    "text": "requirements that\nSydney was just talking about on the simulator itself. It just didn't\nhave an API exposed",
    "start": "1535102",
    "end": "1540318"
  },
  {
    "text": "that allowed you to tweak\nthe things you'd really want to tweak, which are like\nthe sensor noise or the behavior of the other pilots.",
    "start": "1540318",
    "end": "1548450"
  },
  {
    "text": "OK, so with that kind of\nhistorical background, if you want to call it\nhistory from a few years ago,",
    "start": "1548450",
    "end": "1555763"
  },
  {
    "text": "I want to talk a little bit\nabout where the research and adaptive stress testing\nhas gone since then, and I want to do this by\ntalking about just what",
    "start": "1555763",
    "end": "1562250"
  },
  {
    "text": "are the challenges that\ncome up when you begin trying to apply some of these\nalgorithms into the real world.",
    "start": "1562250",
    "end": "1568100"
  },
  {
    "text": "So I broke it down into\nthree broad categories. The first is the difficulty\nin specifying the objective.",
    "start": "1568100",
    "end": "1574529"
  },
  {
    "text": "So in some cases, the objective\nyou care about is quite clear. Maybe in collision avoidance\nthe thing you want to avoid",
    "start": "1574530",
    "end": "1580220"
  },
  {
    "text": "is the two aircraft colliding. On the road, driving, it\nmight be a little less clear,",
    "start": "1580220",
    "end": "1586350"
  },
  {
    "text": "so it might be a collision. You definitely\nwant to avoid that. But it might be other\nmore nuanced things",
    "start": "1586350",
    "end": "1592670"
  },
  {
    "text": "like traffic rules. So this right here is a\ntemporal logic specification for how you should behave\nat an intersection.",
    "start": "1592670",
    "end": "1599870"
  },
  {
    "text": "And so don't try to read it. It'll strain your eyes. You can go take a look here. But these specifications\ncan get extremely complex,",
    "start": "1599870",
    "end": "1607530"
  },
  {
    "text": "and you're very likely to miss\nimportant things, because we probably don't all operate\nat intersections exactly",
    "start": "1607530",
    "end": "1614108"
  },
  {
    "text": "by the rules of the road. You're doing it based on the\ncultural norms of the area and things like that.",
    "start": "1614108",
    "end": "1619940"
  },
  {
    "text": "Another challenge which has\nbeen talked about earlier is just how do you\nmodel the environment. So in the driving and\ntransportation domain,",
    "start": "1619940",
    "end": "1625918"
  },
  {
    "text": "this can get super challenging. I'll show some examples of that. And then, lastly, how do we\noptimize in these very complex",
    "start": "1625918",
    "end": "1631820"
  },
  {
    "text": "long time horizon environments? So I'll show you a\nfew examples of how we address some of these problems.",
    "start": "1631820",
    "end": "1637690"
  },
  {
    "text": "So let's start by talking\nabout specifying the problems. So pretty shortly after\nRitchie did his work",
    "start": "1637690",
    "end": "1643810"
  },
  {
    "text": "showing this adaptive\nstress testing approach, working in the\naviation sector, we",
    "start": "1643810",
    "end": "1648940"
  },
  {
    "text": "started thinking about\nhow we might apply this in the driving sector. There was a lot of\ninterest in ensuring the safety of these systems\nas they were beginning",
    "start": "1648940",
    "end": "1655163"
  },
  {
    "text": "to be tested on the road. So we set up a pretty\nsimple kind of scenario where you have a\npedestrian that's",
    "start": "1655163",
    "end": "1660309"
  },
  {
    "text": "walking across the street,\nand we have our agent being a vehicle that\nhas some simple policy",
    "start": "1660310",
    "end": "1666639"
  },
  {
    "text": "that it should just stop for the\npedestrian if it observes it. But then we said, OK,\nthere's some noise,",
    "start": "1666640",
    "end": "1672679"
  },
  {
    "text": "there's some disturbances that\ncould occur in the environment. So number one, the\npedestrian could not choose to walk in a straight\nline at constant velocity.",
    "start": "1672680",
    "end": "1678890"
  },
  {
    "text": "So there's some maybe variation\nin how the pedestrian behaves. Additionally, the vehicle is\nnot going to necessarily sense",
    "start": "1678890",
    "end": "1686080"
  },
  {
    "text": "the pedestrian\nexactly accurately in terms of localizing\nwhere they are in space. So we specified those as the\ndisturbances, the behavior",
    "start": "1686080",
    "end": "1693430"
  },
  {
    "text": "of the pedestrian\nand the sensor noise, and we wrote what we thought was\na pretty fancy reward function.",
    "start": "1693430",
    "end": "1699190"
  },
  {
    "text": "So we said, OK, we're going\nto give a penalty for not finding a failure. We're going to have\na heuristic about how close the vehicle\nand the pedestrian",
    "start": "1699190",
    "end": "1705930"
  },
  {
    "text": "were because that's\nwhat Richie did, and that worked\nreally well, and we're going to penalize rare actions.",
    "start": "1705930",
    "end": "1711370"
  },
  {
    "text": "So that we try to find this\nmost likely failure outcome. And then we threw some solvers\nat it, MCTS and deep RL.",
    "start": "1711370",
    "end": "1718710"
  },
  {
    "text": "So we did that, and\nthe results were this.",
    "start": "1718710",
    "end": "1723750"
  },
  {
    "text": "So we'll let it replay. But basically, the vehicle\ncorrectly identifies the pedestrian,\ncomes to a safe stop,",
    "start": "1723750",
    "end": "1729990"
  },
  {
    "text": "and the pedestrian runs\nheadlong into the vehicle. And so what went wrong here?",
    "start": "1729990",
    "end": "1735730"
  },
  {
    "text": "Well, first of all,\nwhat went wrong is that we didn't necessarily\nspecify our objective correctly.",
    "start": "1735730",
    "end": "1741520"
  },
  {
    "text": "So we just said that\na failure occurs only when the two objects come\ninto contact and not that say,",
    "start": "1741520",
    "end": "1747810"
  },
  {
    "text": "for example, the\nvehicle was at fault for the collision, which\nmight have been something that we care about. Also, we might have had an\noversimplified model of how",
    "start": "1747810",
    "end": "1754732"
  },
  {
    "text": "pedestrians behave,\nalthough people have shown me videos\nof people doing this very thing for insurance\nfraud after showing this video,",
    "start": "1754732",
    "end": "1762620"
  },
  {
    "text": "so maybe it's something\nwe should worry about. OK. So the idea here then is OK, how\ncan we modify our specification",
    "start": "1762620",
    "end": "1771940"
  },
  {
    "text": "or at least change\nthe objective function that we're optimizing\nfor in order to account for some of\nthese more nuanced things",
    "start": "1771940",
    "end": "1778090"
  },
  {
    "text": "that we might care about. So in this particular\nwork, we pulled",
    "start": "1778090",
    "end": "1783309"
  },
  {
    "text": "from a concept called\nresponsibility sensitive safety. So this is an effort\nto basically codify",
    "start": "1783310",
    "end": "1791200"
  },
  {
    "text": "a lot of the rules of\nsafe driving, so like, rules of the road\ncodified as very specific mathematical specifications.",
    "start": "1791200",
    "end": "1798340"
  },
  {
    "text": "And they kind of took\nthese high-level things, like don't hit someone from\nbehind, don't cut in recklessly, and they formalize them\nin this mathematical way.",
    "start": "1798340",
    "end": "1806169"
  },
  {
    "text": "And then, they used it\nas a way to identify in certain situations\nwho is at fault.",
    "start": "1806170",
    "end": "1811750"
  },
  {
    "text": "And how you should have behaved\nin order to drive safely.",
    "start": "1811750",
    "end": "1816790"
  },
  {
    "text": "So they were thinking\nof this as a way that you could write down\nthe rules of the road.",
    "start": "1816790",
    "end": "1821918"
  },
  {
    "text": "I don't think that was ever\nreally going to quite work, but it is a very\nuseful tool in order to evaluate certain scenarios\nand see who was at fault.",
    "start": "1821918",
    "end": "1829360"
  },
  {
    "text": "So the key idea is that\nwe took those statements, and we used them to evaluate the\nsafety and the responsibility",
    "start": "1829360",
    "end": "1834460"
  },
  {
    "text": "of each party involved\nin the collision. And so you can see\nhere, the trajectory that occurred with the\nvehicle and the pedestrian.",
    "start": "1834460",
    "end": "1841250"
  },
  {
    "text": "And basically, what we\ndetermined from this is that while the kind of situation\nwas dangerous in the sense that",
    "start": "1841250",
    "end": "1847240"
  },
  {
    "text": "there could have\nbeen a collision, the response of the vehicle\nwas, quote unquote, \"proper.\" So it applied the\ncorrect braking,",
    "start": "1847240",
    "end": "1853745"
  },
  {
    "text": "and it actually came\nto a complete stop prior to the collision. So the key idea here is,\nlet's change our objective",
    "start": "1853745",
    "end": "1858970"
  },
  {
    "text": "to search for failures\nwhere the autonomous vehicle itself is to blame, and that\nwe're not in this situation right here.",
    "start": "1858970",
    "end": "1865030"
  },
  {
    "text": "So if we change our objective\nand run the optimization again, we get a situation that\nlooks something like this.",
    "start": "1865030",
    "end": "1871279"
  },
  {
    "text": "So now, the most likely\nfailure that emerges is one in which\nthe pedestrian has this kind of diagonal\nwalk, which is actually",
    "start": "1871280",
    "end": "1878370"
  },
  {
    "text": "quite similar to the\nUber ATG collision, and the sensor noise is\namplified in a biased way",
    "start": "1878370",
    "end": "1885240"
  },
  {
    "text": "such that the vehicle thinks\nthe pedestrian is actually still on the sidewalk, and the\nresult is a collision.",
    "start": "1885240",
    "end": "1891385"
  },
  {
    "text": "So it's using these\ntechniques that you can find much more\nrelevant or at fault failure modes for\nautonomous driving.",
    "start": "1891385",
    "end": "1899429"
  },
  {
    "text": "OK, so let me pause\nthere for a second and see if there are questions. Yeah. What confuses me\na little bit when",
    "start": "1899430",
    "end": "1905220"
  },
  {
    "text": "we talk about\namplifying sensor noise and then biasing in a certain\ndirection, how much of that is really just\nsearching for a failure,",
    "start": "1905220",
    "end": "1911740"
  },
  {
    "text": "and how much are we biasing our\nwhole system model in a sense and changing the system model? Yeah, so the question\nis, when we're",
    "start": "1911740",
    "end": "1919140"
  },
  {
    "text": "talking about the resulting\nbias in the observations here, how does that come about?",
    "start": "1919140",
    "end": "1925409"
  },
  {
    "text": "And what's going on here is that\nwe have a model of the sensor noise that maybe you\nlearn from some data,",
    "start": "1925410",
    "end": "1930920"
  },
  {
    "text": "so you understand what\nare the range of noises that you might expect. And in the nominal operation,\nwhich you see here,",
    "start": "1930920",
    "end": "1940009"
  },
  {
    "text": "that sensor noise\nactually is being applied, and it's uniformly distributed\nwith zero mean and whatnot.",
    "start": "1940010",
    "end": "1946730"
  },
  {
    "text": "And so what the false or the\nadaptive stress testing is doing is basically just finding\nsequences of sensor noise",
    "start": "1946730",
    "end": "1953900"
  },
  {
    "text": "that lead to failure,\nand it just so happens that the failures occur\nwhen the sensor noise is biased.",
    "start": "1953900",
    "end": "1961640"
  },
  {
    "text": "So like, it just\nfinds those outcomes because a failure only occurs if\nthe car thinks the pedestrian is",
    "start": "1961640",
    "end": "1967340"
  },
  {
    "text": "on the sidewalk, and that\nonly occurs if there's a negative bias to the thing. And so it's able to tease out\nthose types of relationships",
    "start": "1967340",
    "end": "1974600"
  },
  {
    "text": "and give you those trajectories. Now, this doesn't\nmean that the sensor noise that's going to be\nexperienced in the real world",
    "start": "1974600",
    "end": "1981049"
  },
  {
    "text": "is biased. It just tells the engineer who's\nbuilding the system, hey, be careful about this\nparticular situation",
    "start": "1981050",
    "end": "1986920"
  },
  {
    "text": "and maybe learn from it. Does that answer your question? Yeah. Yeah, yeah.",
    "start": "1986920",
    "end": "1992760"
  },
  {
    "text": "To what extent do you think you\ncould modify these kind of ideas to be more scalable, I\nguess, like because here you",
    "start": "1992760",
    "end": "2000110"
  },
  {
    "text": "have to design the\nreward function and the scenario one-in-one,\nlike hand-in-hand?",
    "start": "2000110",
    "end": "2007490"
  },
  {
    "text": "How would you do it\nfor multiple scenarios? Do you really have\nto start from scratch every time you want to\ntest a different scenario",
    "start": "2007490",
    "end": "2013820"
  },
  {
    "text": "for an interaction? Yeah, that's a great question. I don't have these in backup. So Robert's actually done\nsome very nice work on that.",
    "start": "2013820",
    "end": "2021300"
  },
  {
    "text": "He can maybe share\nwith you offline of basically developing\na broader framework",
    "start": "2021300",
    "end": "2027297"
  },
  {
    "text": "for this type of approach. So they've\npre-selected, I think, 10 different types of\nscenarios that are common",
    "start": "2027297",
    "end": "2034110"
  },
  {
    "text": "and then different\nconfigurations and initial conditions\nof those scenarios, and then search for\nfailures across all of them.",
    "start": "2034110",
    "end": "2040610"
  },
  {
    "text": "And the trick is\nbasically finding-- well, first of all, like\nbeing able to create",
    "start": "2040610",
    "end": "2045950"
  },
  {
    "text": "a bunch of scenarios\nand a generative fashion so that you don't have to\nhand-design these things, and you can do that.",
    "start": "2045950",
    "end": "2052369"
  },
  {
    "text": "I mean, these days people are\nprobably doing in-context LLM type stuff, but then it\nwas finding frameworks",
    "start": "2052370",
    "end": "2059570"
  },
  {
    "text": "that were useful for specifying\nthese types of scenarios and generating\nthem automatically.",
    "start": "2059570",
    "end": "2064860"
  },
  {
    "text": "And then, it's also\nabout finding objectives that allow you to solve for\nrelevant failures in each",
    "start": "2064860",
    "end": "2071090"
  },
  {
    "text": "of those. And a lot of these things\nlike responsibility, sensitive safety,\nactually do apply",
    "start": "2071090",
    "end": "2077329"
  },
  {
    "text": "for a wide range of scenarios. We just kind of\npulled the minimum set that was useful for this\nparticular scenario.",
    "start": "2077330",
    "end": "2083023"
  },
  {
    "text": "But you could\nimagine scaling that up and using the same\ntechnique for a lot of different scenarios.",
    "start": "2083023",
    "end": "2088199"
  },
  {
    "text": "But yeah, it's a great question,\nand it's a big engineering effort to get that to happen. ",
    "start": "2088199",
    "end": "2094739"
  },
  {
    "text": "Cool. Other questions? OK, great.",
    "start": "2094739",
    "end": "2100730"
  },
  {
    "text": "OK, so let's talk about the\nsecond set of challenges for adaptive stress\ntesting, and I'm not going to linger on this too much\nbecause I think this was already",
    "start": "2100730",
    "end": "2108720"
  },
  {
    "text": "covered to some extent in\nlecture, which is, how do you actually model the\nenvironment in such a way that it's realistic to the\noperational environment",
    "start": "2108720",
    "end": "2116430"
  },
  {
    "text": "that you intend your\nsystem to operate within? So the challenges here,\nespecially in the driving",
    "start": "2116430",
    "end": "2123270"
  },
  {
    "text": "context, are twofold. So number one, human behavior on\nthe road is incredibly complex.",
    "start": "2123270",
    "end": "2128619"
  },
  {
    "text": "So if you think about\nthe problem of saying, hey, I want to evaluate\nmy self-driving car policy",
    "start": "2128620",
    "end": "2134369"
  },
  {
    "text": "in simulation, and I want to\ncreate a bunch of other agents on the road that behave\nlike other drivers would.",
    "start": "2134370",
    "end": "2139930"
  },
  {
    "text": "Well, creating agents that\nbehave like other drivers would is exactly as\nhard a problem as building a self-driving\ncar itself.",
    "start": "2139930",
    "end": "2146609"
  },
  {
    "text": "So you need a way to\nmimic this behavior without necessarily\ngoing full bore and creating a bunch of\nautonomous vehicles on the road.",
    "start": "2146610",
    "end": "2155160"
  },
  {
    "text": "And that can get very tricky. Also, the sensors that the\nvehicles use are not so simple.",
    "start": "2155160",
    "end": "2161820"
  },
  {
    "text": "So we have LiDAR sensors,\nwe have camera sensors. These are very, very\nhigh-dimensional",
    "start": "2161820",
    "end": "2167160"
  },
  {
    "text": "and tricky sensors to model. So if you want to try\nto capture like what is the noise\ndistribution in a sensor,",
    "start": "2167160",
    "end": "2173880"
  },
  {
    "text": "it has to respect what is\ntrue about LiDAR, for example. And that can get very\ncomplicated as opposed",
    "start": "2173880",
    "end": "2180600"
  },
  {
    "text": "to something like\nmaybe GPS, which has a much more well\ncharacterized error distribution and things like that.",
    "start": "2180600",
    "end": "2187020"
  },
  {
    "text": "OK, so what do people do? So people generally try to\nmodel the environment from data.",
    "start": "2187020",
    "end": "2192880"
  },
  {
    "text": "So this should be\nfamiliar, thinking about getting some samples\nof your environment, either from the real world\nor through simulation",
    "start": "2192880",
    "end": "2199200"
  },
  {
    "text": "and then learning models\nfrom those samples. And there are a lot of\ncool data sets out there",
    "start": "2199200",
    "end": "2204240"
  },
  {
    "text": "for driving in particular,\nwhere for example, maybe they flew a drone over a highway,\nand they record with a camera",
    "start": "2204240",
    "end": "2211290"
  },
  {
    "text": "all the different vehicles\ninteracting on the highway, and then they do some of\nautomated segmentation",
    "start": "2211290",
    "end": "2216930"
  },
  {
    "text": "and object detection\nto figure out who's who and then how they're\nbehaving over time. And the result is\nlike you basically",
    "start": "2216930",
    "end": "2222250"
  },
  {
    "text": "get a data set with a\nbunch of trajectories of what other agents\nare doing on the road.",
    "start": "2222250",
    "end": "2227830"
  },
  {
    "text": "Additionally, they can get this\ninformation from fixed cameras. And importantly, there's data\nsets where they kind observe",
    "start": "2227830",
    "end": "2236505"
  },
  {
    "text": "the interactions through\nintersections where things can get very complex\nand people are kind of interacting in\nvery sophisticated ways.",
    "start": "2236505",
    "end": "2244990"
  },
  {
    "text": "Now, what do you\ndo with that data, well, you can build\nall sorts of models, but one of the\ntypes of models that",
    "start": "2244990",
    "end": "2250030"
  },
  {
    "text": "has been pretty effective\nfor imitating real-world data are deep generative models.",
    "start": "2250030",
    "end": "2255740"
  },
  {
    "text": "And that's obviously\neven way more present now with large language\nmodels and diffusion models.",
    "start": "2255740",
    "end": "2261500"
  },
  {
    "text": "But at the time that a\nlot of this work was done, the best model for this were\ngenerative adversarial networks,",
    "start": "2261500",
    "end": "2269390"
  },
  {
    "text": "which are deep generative\nmodels that play this zero sum game where the a generator tries\nto produce realistic images that",
    "start": "2269390",
    "end": "2276130"
  },
  {
    "text": "look like the data\nyou've provided it and a discriminator tries\nto figure out which are real and which are fake, and the\nresult is that you lear these.",
    "start": "2276130",
    "end": "2284740"
  },
  {
    "text": "A generator that's able\nto produce, in this case, handwritten digits from\nthe MNIST data set.",
    "start": "2284740",
    "end": "2290530"
  },
  {
    "text": "Now, versions of GANs have been\napplied in a lot of domains. One of them is actually\nmodeling the sequential behavior",
    "start": "2290530",
    "end": "2298090"
  },
  {
    "text": "of multiple agents on the road. So this was some\nwork out of SISL",
    "start": "2298090",
    "end": "2303279"
  },
  {
    "text": "as well that took\none of these data sets and began learning\nmodels of how drivers interact",
    "start": "2303280",
    "end": "2309160"
  },
  {
    "text": "on the highway. So you can watch the little\nvehicles drive around. These are all from\nthe learned policy,",
    "start": "2309160",
    "end": "2314660"
  },
  {
    "text": "and you can see they\ncause each other to brake when the one in\nfront brakes, and you",
    "start": "2314660",
    "end": "2319780"
  },
  {
    "text": "get kind of realistic-looking\ntraffic behavior. And this is a\nreally useful model for when you want to evaluate\nyour system on a highway,",
    "start": "2319780",
    "end": "2326329"
  },
  {
    "text": "for example. You can also use these same\ntypes of deep generative models",
    "start": "2326330",
    "end": "2332230"
  },
  {
    "text": "for modeling the sensor\ndynamics that you might observe",
    "start": "2332230",
    "end": "2337810"
  },
  {
    "text": "as an autonomous vehicle. So actually, this\none on the right here is from Sydney\nand myself and others",
    "start": "2337810",
    "end": "2344260"
  },
  {
    "text": "where we trained a GAN\nto look like the images that an aircraft might\nsee when it's taxiing down",
    "start": "2344260",
    "end": "2350530"
  },
  {
    "text": "a runway, for example. And I'll talk a little bit more\nabout this specific example in a few moments.",
    "start": "2350530",
    "end": "2356560"
  },
  {
    "text": "So the idea here-- and\nI won't linger on it-- is that a huge amount\nof the effort that goes into actual validation.",
    "start": "2356560",
    "end": "2363260"
  },
  {
    "text": "Is this piece of it. So how do you make your\nsimulator effectively look a lot-- look and\nact like the real world?",
    "start": "2363260",
    "end": "2369620"
  },
  {
    "text": "Because if you don't do\nthat, then any validation you get out of the\nsimulator won't necessarily translate into that\nreal-world environment.",
    "start": "2369620",
    "end": "2377620"
  },
  {
    "text": "OK, so now, let's talk\nabout this third challenge, and I'll share a little\nbit more work from SISL,",
    "start": "2377620",
    "end": "2382780"
  },
  {
    "text": "and that is the challenge\nof optimization. So now what we're\ngoing to say is that we have our objective locked down.",
    "start": "2382780",
    "end": "2388160"
  },
  {
    "text": "We've modeled our environment,\nand we have a simulator setup up. How do we actually\nsearch for these failures",
    "start": "2388160",
    "end": "2393250"
  },
  {
    "text": "in a way that is efficient. So that we actually find\nfailures and we find failures that have high\nlikelihood because that",
    "start": "2393250",
    "end": "2399290"
  },
  {
    "text": "is the overall objective here. So one really cool\nexample of a system",
    "start": "2399290",
    "end": "2405800"
  },
  {
    "text": "that we looked at before is\nthis system called TaxiNet. So TaxiNet is a very\nsimple autonomous system,",
    "start": "2405800",
    "end": "2413340"
  },
  {
    "text": "but it has some really\ngood real world impact. So the idea is that you\nwould have an aircraft. It wants to autonomously\ntaxi around a runway",
    "start": "2413340",
    "end": "2421190"
  },
  {
    "text": "so that it can take off,\ngo from airport to airport and all autonomously.",
    "start": "2421190",
    "end": "2426627"
  },
  {
    "text": "So the idea is that\nwe'd have a camera on the wing of the aircraft\nthat would be pointing down the runway. And our main objective would\nbe that the aircraft is",
    "start": "2426627",
    "end": "2434030"
  },
  {
    "text": "able to just taxi\nstraight down the runway and not go off on either side. And so the question that\nwe asked was, can images--",
    "start": "2434030",
    "end": "2441810"
  },
  {
    "text": "errors in the images that\nwe get from that camera lead the aircraft to eventually\nfind its way off the runway?",
    "start": "2441810",
    "end": "2447660"
  },
  {
    "text": "Because that would be really\nconcerning if that was the case. So to get a little more detail\nabout how the system actually",
    "start": "2447660",
    "end": "2454790"
  },
  {
    "text": "she operated. So we get in the\nhigh-resolution image. We downsample it to a much\nmore smaller, a much smaller",
    "start": "2454790",
    "end": "2463400"
  },
  {
    "text": "low-resolution image\nthat's just in grayscale. And this is done so that\nwe can have a very, very",
    "start": "2463400",
    "end": "2468920"
  },
  {
    "text": "small neural network,\nprocess that image and basically give us\nan estimate of where we are on the runway so that\nwe can then produce a control",
    "start": "2468920",
    "end": "2476780"
  },
  {
    "text": "input that allows us to stay\nstraight and stay aligned with the runway\nas we go down it.",
    "start": "2476780",
    "end": "2482190"
  },
  {
    "text": "And so this is operating\nin closed loops, which means that at every step\nwe take in a new image, we downsample it, run it\nthrough the neural network,",
    "start": "2482190",
    "end": "2489049"
  },
  {
    "text": "and then decide on a\nrudder control that allows us to stay straight. And the reason for wanting to\nhave a very small neural network",
    "start": "2489050",
    "end": "2496640"
  },
  {
    "text": "is so that we can apply some\ntechniques that I'll talk about in a little bit in order to\nverify the neural network",
    "start": "2496640",
    "end": "2503750"
  },
  {
    "text": "and also do some stuff that\nI'll show you in a second.",
    "start": "2503750",
    "end": "2509368"
  },
  {
    "text": "So if you actually just\nrun this controller in a few different\nkind of environments, so this would be your\nMonte Carlo sampling",
    "start": "2509368",
    "end": "2515140"
  },
  {
    "text": "to evaluate how well\nthe system behaves, then you get the\nfollowing results. So no matter where you\nstart on the runway,",
    "start": "2515140",
    "end": "2521330"
  },
  {
    "text": "it's able to determine\nwhere it's at and nicely make its\nway to the center and then carry on straight.",
    "start": "2521330",
    "end": "2527900"
  },
  {
    "text": "And then, even when it gets\nsome slightly different weather conditions, it's\novercast or something, you're able to still get\nreally good performance.",
    "start": "2527900",
    "end": "2536320"
  },
  {
    "text": "But as you should know\nnow from this course, that does not mean that this\nsystem is necessarily safe,",
    "start": "2536320",
    "end": "2541630"
  },
  {
    "text": "just because we only ran\na handful of simulations. OK, so what's the idea here?",
    "start": "2541630",
    "end": "2548360"
  },
  {
    "text": "The idea is we know\nthat the camera is going to have some amount of noise,\nand that noise is maybe going to be roughly\nGaussian-distributed at each",
    "start": "2548360",
    "end": "2555070"
  },
  {
    "text": "of the pixels. You get that fuzzy\nnoise that can occur. And so the question\nis, what kind of noise",
    "start": "2555070",
    "end": "2561490"
  },
  {
    "text": "might occur on the image\nthat would lead the aircraft to have a very incorrect\nsteering angle one",
    "start": "2561490",
    "end": "2567362"
  },
  {
    "text": "way or the other. So maybe it's like\noff to the right. It should steer to the left. But based on the noise\nit got it actually",
    "start": "2567362",
    "end": "2572710"
  },
  {
    "text": "is steering back to the right,\nwhich would be very bad. And so what we\ncan do is say, OK,",
    "start": "2572710",
    "end": "2579020"
  },
  {
    "text": "let's try to figure out\nwhat configuration of noise would lead to a maximum\ndeviation at a single time step.",
    "start": "2579020",
    "end": "2584802"
  },
  {
    "text": "And since our neural network\nis very small, we can actually use some tools from the neural\nverification literature,",
    "start": "2584802",
    "end": "2590630"
  },
  {
    "text": "which we'll learn about in\na few lectures or later on in the quarter, you can actually\nsolve this problem exactly.",
    "start": "2590630",
    "end": "2597430"
  },
  {
    "text": "So you can say I want to\nmaximize the error in my output based on the input noise,\nand we can figure out",
    "start": "2597430",
    "end": "2603550"
  },
  {
    "text": "what that little bit\nof noise would be to lead to that maximum error. And we can say, maximize\nthe error to the right",
    "start": "2603550",
    "end": "2609880"
  },
  {
    "text": "or to the left. OK, so then maybe what\nyou do is say, all right, what if it got the\nworst possible error",
    "start": "2609880",
    "end": "2615370"
  },
  {
    "text": "at every single time step? What would happen. So we say like we\nare always biasing it to want to turn to the\nleft, and it's already",
    "start": "2615370",
    "end": "2621970"
  },
  {
    "text": "on the left side of\nthe runway, so maybe it will just go off the runway. So when you do that,\nthis is what happens.",
    "start": "2621970",
    "end": "2628430"
  },
  {
    "text": "So what you're seeing here is\non the bottom the trajectory of the aircraft, the true image,\nthe downsampled image, and then",
    "start": "2628430",
    "end": "2635410"
  },
  {
    "text": "the perturbed image, which\nis getting this kind of noise applied to it, that's\ncausing the aircraft to think that it should be turning left.",
    "start": "2635410",
    "end": "2642730"
  },
  {
    "text": "So we let this run for a\nwhile, and what we find is that we actually don't\never leave the runway,",
    "start": "2642730",
    "end": "2649099"
  },
  {
    "text": "so we've just biased it\nevery time to the left. But the network is robust enough\nthat it can understand, even",
    "start": "2649100",
    "end": "2655600"
  },
  {
    "text": "in this worst case\nscenario, that it's on the left side of the runway,\nand it should at very least, not continue going left, and we\nend up with a safe trajectory.",
    "start": "2655600",
    "end": "2663619"
  },
  {
    "text": "Yeah. So in this case, we were\ndefining this worst case scenario. Are you saying then that\nthe noise is bounded?",
    "start": "2663620",
    "end": "2668869"
  },
  {
    "text": "Yes, yeah, so the question\nis, is the noise bounded? And yes, the noise is\nbounded to a certain level.",
    "start": "2668870",
    "end": "2674060"
  },
  {
    "text": "So we're saying\nthe noise can only go up to a certain threshold. And within that threshold, we're\nfinding the worst case scenario.",
    "start": "2674060",
    "end": "2679990"
  },
  {
    "text": "Yes. How do you quantify\nworse in this case? And also, how do you get it to\nbe the left, like in particular?",
    "start": "2679990",
    "end": "2685670"
  },
  {
    "text": "Yeah, so the question is,\nhow do you quantify worst? And then, how do we force it to\nbe to the left or to the right?",
    "start": "2685670",
    "end": "2691790"
  },
  {
    "text": "So we're quantifying\nworst based on the-- we know what the\ncontrol input should be.",
    "start": "2691790",
    "end": "2697330"
  },
  {
    "text": "And then we want to say, we\nwant to maximize the input to be the opposite direction. So if we know that it\nshould be like to the right,",
    "start": "2697330",
    "end": "2703845"
  },
  {
    "text": "the worst case\nfor the left would be like it produces a steering\ncontrol that actually like deviates it to the left.",
    "start": "2703845",
    "end": "2709520"
  },
  {
    "text": "So it's that output piece. [INAUDIBLE] which then pass\nthrough your entire [? column ?] and then [INAUDIBLE]",
    "start": "2709520",
    "end": "2715025"
  },
  {
    "text": "That's correct, yeah. All right, thanks. Cool. Other questions? Yeah. Can you clarify how\nit knows to stay in",
    "start": "2715025",
    "end": "2721900"
  },
  {
    "text": "not to go pass the runway? Yeah, so the question is,\ncan I clarify how it knows",
    "start": "2721900",
    "end": "2727510"
  },
  {
    "text": "to not carry on off the runway? So what's going on here is\nthat the neural network that",
    "start": "2727510",
    "end": "2733960"
  },
  {
    "text": "is controlling the\noutput has been trained to basically\npredict where",
    "start": "2733960",
    "end": "2740440"
  },
  {
    "text": "the aircraft is on the runway. And then the control kind\nof comes out of that, because if it's very\nfar to the left,",
    "start": "2740440",
    "end": "2745990"
  },
  {
    "text": "it'll kind of cause\nit to correct. So what's going on here\nis that even in the case where the aircraft\nis off to the side,",
    "start": "2745990",
    "end": "2753110"
  },
  {
    "text": "and we're perturbing\nit adversarially, the neural network\nis robust enough that it has a pretty\ngood estimate, still,",
    "start": "2753110",
    "end": "2759210"
  },
  {
    "text": "of where we are on\nthe neural network-- or sorry, where we\nare on the runway. And because it has a\npretty good estimate,",
    "start": "2759210",
    "end": "2765263"
  },
  {
    "text": "then the resulting control\nmeans that at very least, it's not going to carry\non over to the left.",
    "start": "2765263",
    "end": "2770795"
  },
  {
    "text": "So it's just a function\nof the neural network actually being pretty good\nat what it was trained on. ",
    "start": "2770795",
    "end": "2778670"
  },
  {
    "text": "Cool, yeah. Love the questions. So that's what happens when\nwe apply the same disturbance",
    "start": "2778670",
    "end": "2785240"
  },
  {
    "text": "at all times. But as you should also\nknow from this course, it really matters the\nsequence of events",
    "start": "2785240",
    "end": "2792020"
  },
  {
    "text": "that might occur, right? And so we can't conclude\nthat this system is safe.",
    "start": "2792020",
    "end": "2797750"
  },
  {
    "text": "So what the folks\ndid here was to, again, apply Monte\nCarlo tree search to figure out at every\nstep I can either",
    "start": "2797750",
    "end": "2804920"
  },
  {
    "text": "apply the worst case disturbance\nto the left or to the right. And we're going to do\nthis kind of overtime",
    "start": "2804920",
    "end": "2811070"
  },
  {
    "text": "with the goal of trying\nto find failure outcomes. And we did this with\ndifferent levels of asked about the\nbounding of the noise,",
    "start": "2811070",
    "end": "2817740"
  },
  {
    "text": "so you can change how much noise\nyou allow for and for example, at a 2% perturbation\non the pixels,",
    "start": "2817740",
    "end": "2823470"
  },
  {
    "text": "which is very, very small,\nwe don't find any errors. So of course, we can't conclude\nthat there are no failures",
    "start": "2823470",
    "end": "2829670"
  },
  {
    "text": "at all, but we don't see any. But when you bump that\nperturbation up to 3%, we start to see some really\ninteresting things happen.",
    "start": "2829670",
    "end": "2836720"
  },
  {
    "text": "So what's going on here is\nthat the MCTS algorithm found a failure trajectory where\ninitially the aircraft was being",
    "start": "2836720",
    "end": "2844580"
  },
  {
    "text": "biased to drive to\nthe left for a while, but then it gets out to a\ncertain point, and it switches.",
    "start": "2844580",
    "end": "2850620"
  },
  {
    "text": "So it now biases\nyou to the right. And so the aircraft is actually\nalready way off the runway, and now, it turns, and it's\nlooking across the runway.",
    "start": "2850620",
    "end": "2858540"
  },
  {
    "text": "And that image is so outside\nof the training set, which only occurred, from casually,\ngoing down the runway",
    "start": "2858540",
    "end": "2865780"
  },
  {
    "text": "that it became really bad\nat the task of figuring out where it is. And it ultimately allowed the\naircraft to run off the runway.",
    "start": "2865780",
    "end": "2872619"
  },
  {
    "text": "And you see other\nconfigurations here. Obviously, the more\nnoise that we allow, it's the easier it is to\ncause the system to fail,",
    "start": "2872620",
    "end": "2879560"
  },
  {
    "text": "and you can find failure\ntrajectories that are of shorter. This is one here where\nyou are able to just cause",
    "start": "2879560",
    "end": "2885180"
  },
  {
    "text": "it to go to the left entirely. But this really\ndrives home the point that you actually\nneed to understand",
    "start": "2885180",
    "end": "2890430"
  },
  {
    "text": "the sequence of\nevents that could occur because failures\ncan emerge from really complex interactions.",
    "start": "2890430",
    "end": "2898650"
  },
  {
    "text": "Yeah. This is really cool. But also, when you start\nthese type of experiments,",
    "start": "2898650",
    "end": "2904182"
  },
  {
    "text": "you don't go in\nknowing that you're going to find these things? So when do you know to stop. Yeah, that's a\nphenomenal question.",
    "start": "2904182",
    "end": "2910900"
  },
  {
    "text": "So the question is, going\ninto these experiments, you have no idea if there is\na failure that you could find.",
    "start": "2910900",
    "end": "2916270"
  },
  {
    "text": "So when do you know\nto stop looking? And yeah, I mean I think that's\na very, very difficult question",
    "start": "2916270",
    "end": "2924030"
  },
  {
    "text": "because it's very\ndifficult to build a high enough degree of\nconfidence that you say,",
    "start": "2924030",
    "end": "2929910"
  },
  {
    "text": "I am certain that this\nsystem is safe to fly. I think Michael could\nprobably speak to this.",
    "start": "2929910",
    "end": "2935410"
  },
  {
    "text": "So I think it was\nin evaluation for 7, 8 years prior to its deployment.",
    "start": "2935410",
    "end": "2941080"
  },
  {
    "text": "So how did the FAA know that\nit was time to stop evaluating? It's just gradual\nbuilding of trust.",
    "start": "2941080",
    "end": "2948010"
  },
  {
    "text": "There's no well-defined\ntermination condition. Yeah.",
    "start": "2948010",
    "end": "2953700"
  },
  {
    "text": "Fundamentally, it can be\nlike a needle in a haystack kind of problem\nwhere I don't know,",
    "start": "2953700",
    "end": "2960621"
  },
  {
    "text": "you utter some\nincantation, and then suddenly, the Earth explodes.",
    "start": "2960621",
    "end": "2965970"
  },
  {
    "text": "There's no way to prove\nthat that doesn't exist.",
    "start": "2965970",
    "end": "2972580"
  },
  {
    "text": "Yeah, yeah, so there's-- Well, there is a way to prove\nthe absence of failures, but it's not always so scalable.",
    "start": "2972580",
    "end": "2978280"
  },
  {
    "text": "And you'll learn about that in\nthe formal methods a section. But yeah, it's a\nreally great question,",
    "start": "2978280",
    "end": "2984290"
  },
  {
    "text": "and it's very difficult to\never have full confidence that you found-- that you have\nproven that no failure exists.",
    "start": "2984290",
    "end": "2992200"
  },
  {
    "text": "Yeah. Cool. Yeah. I'm curious what the\nintention of-- or I guess,",
    "start": "2992200",
    "end": "2998660"
  },
  {
    "text": "what the consequences of\nthese results can mean for, for example, earlier,\nwe were trying",
    "start": "2998660",
    "end": "3004020"
  },
  {
    "text": "to find most likely failures. In this case, now, we\nhave some bounded error. So I can imagine that what\nwe say with these results",
    "start": "3004020",
    "end": "3010800"
  },
  {
    "text": "are then we impose\nsome constraint on the accuracy of our sensor,\nor I guess how else would you--",
    "start": "3010800",
    "end": "3017820"
  },
  {
    "text": "Yeah, that's great. So the question is\nbroadly around how do you use these results and\nwhat they might mean maybe for the design of\nthe system, and I",
    "start": "3017820",
    "end": "3024420"
  },
  {
    "text": "think there's a spectrum of\nthings of what it can mean. So you can take these results\nand treat them qualitatively.",
    "start": "3024420",
    "end": "3030890"
  },
  {
    "text": "You can look at them\nand say, like, here's the behavior that we\nwant to try to avoid in future versions\nof the system.",
    "start": "3030890",
    "end": "3036480"
  },
  {
    "text": "You could take the\nresult, I think, as your suggestion was,\nto be like, all right, at the 2% level of sensor\nnoise, we seem to be OK,",
    "start": "3036480",
    "end": "3044380"
  },
  {
    "text": "though again, we can\nnever be fully confident. And so maybe we treat that as\na specification on our sensor",
    "start": "3044380",
    "end": "3050490"
  },
  {
    "text": "to say that we can't allow for\ndisturbances on the sensor that are larger than 2%,\nand you can use-- yeah,",
    "start": "3050490",
    "end": "3058869"
  },
  {
    "text": "you can use failure traces also\nto train your model further. And there's lots of ways that\nyou can use these results.",
    "start": "3058870",
    "end": "3065468"
  },
  {
    "text": "Is there any case where\nwe think about this in a probabilistic\nsense, like relating that to some probability of failure?",
    "start": "3065468",
    "end": "3073089"
  },
  {
    "text": "Yeah, so you might\nconsider-- and we'll talk about computing\nprobabilities of failure I think in the next lecture\nor the lecture after.",
    "start": "3073090",
    "end": "3081270"
  },
  {
    "text": "But yeah, you could\nimagine saying that OK, for different\nlevels of sensor noise, you could compute a probability\nthat your system fails, and then",
    "start": "3081270",
    "end": "3088380"
  },
  {
    "text": "you could say, OK, what are we\ncomfortable with for failure probability? Yeah, lots of ways\nyou can slice it.",
    "start": "3088380",
    "end": "3094480"
  },
  {
    "text": "Yeah. Maybe for this example, creating\na probabilistic model of noise",
    "start": "3094480",
    "end": "3099520"
  },
  {
    "text": "in the sensors is just\nreally very difficult",
    "start": "3099520",
    "end": "3104620"
  },
  {
    "text": "because have a lot of latent\nvariables and so forth. And so this is basically\ngiving an epsilon ball kind",
    "start": "3104620",
    "end": "3115180"
  },
  {
    "text": "of worst-case noise model. And that's really just a proxy\nfor what we would really love,",
    "start": "3115180",
    "end": "3122359"
  },
  {
    "text": "which is a probabilistic model. But that's too hard to make. ",
    "start": "3122360",
    "end": "3128020"
  },
  {
    "text": "Wonderful. OK. So let's carry on. So the last thing I\nwant to talk about today",
    "start": "3128020",
    "end": "3134590"
  },
  {
    "text": "is just like, what are\nthe kind of latest things that are happening\nin this domain?",
    "start": "3134590",
    "end": "3140150"
  },
  {
    "text": "And if you were\ninterested in doing some research on this topic,\nnumber one, who you should do it with?",
    "start": "3140150",
    "end": "3145700"
  },
  {
    "text": "But also, number two, what are\nthe things that are still open? So this is some\nwork that Harrison's",
    "start": "3145700",
    "end": "3153850"
  },
  {
    "text": "been working on using\ndiffusion models, which are a type of deep\ngenerative model that",
    "start": "3153850",
    "end": "3159740"
  },
  {
    "text": "have seen a lot of success\nover the past couple of years. These are the models\nthat underlie things like Stable Diffusion or Dall-E,\nthe image generation type stuff.",
    "start": "3159740",
    "end": "3168750"
  },
  {
    "text": "And they're really\ngood at representing very complex distributions. And so one use case of\nvery complex distributions",
    "start": "3168750",
    "end": "3176540"
  },
  {
    "text": "is finding interesting\nfailures of really-high dimensional autonomous systems. And so that's the idea that\nHarrison was working on.",
    "start": "3176540",
    "end": "3184340"
  },
  {
    "text": "So diffusion models\nhave been used in a bunch of different domains. So as I said initially, these\nwere used for image generation",
    "start": "3184340",
    "end": "3192500"
  },
  {
    "text": "tasks similar to GANs or VAEs. But then, people\nquickly realized that could also treat\nthings like robotic planning",
    "start": "3192500",
    "end": "3202160"
  },
  {
    "text": "as a high-dimensional kind of\ndistribution matching task where",
    "start": "3202160",
    "end": "3208520"
  },
  {
    "text": "you might say you\nhave your robot arm in a particular location,\nyou have a target goal,",
    "start": "3208520",
    "end": "3213569"
  },
  {
    "text": "and you want to learn the path\nthat the robot should take in order to reach that goal.",
    "start": "3213570",
    "end": "3219196"
  },
  {
    "text": "And you can produce a\nbunch of training data by basically having a bunch of\nrandom configurations of where the arm is.",
    "start": "3219197",
    "end": "3224790"
  },
  {
    "text": "It moves to some\nplace and say, well, imagine I wanted to\nget to that place. Here's what the path\nwould have looked like.",
    "start": "3224790",
    "end": "3229863"
  },
  {
    "text": "And you can use that to\ntrain a diffusion model that is conditioned on\nthe start and end, and it will produce\na trajectory.",
    "start": "3229863",
    "end": "3236210"
  },
  {
    "text": "So that could start sounding\na little bit like what we might want to do\nfor failure discovery, where the objective is\nyou're in an initial state,",
    "start": "3236210",
    "end": "3243470"
  },
  {
    "text": "and you want to have a\npotential failure outcome. We just need to think of a\nway to produce that data.",
    "start": "3243470",
    "end": "3250880"
  },
  {
    "text": "So that's what Harrison\nwas thinking about-- can we use these types of\nconditional diffusion models to sample diverse and\nlikely failure modes?",
    "start": "3250880",
    "end": "3259310"
  },
  {
    "text": "So the algorithm that\ncame out of this called DiFS, or diffusion-based\nfailure sampling,",
    "start": "3259310",
    "end": "3264660"
  },
  {
    "text": "the idea was that\nwe would basically like because\nfailures are rare, we",
    "start": "3264660",
    "end": "3269697"
  },
  {
    "text": "can't just generate\na bunch of samples where we have initial\nstates and failures. So instead, what\nwe're going to say",
    "start": "3269697",
    "end": "3275360"
  },
  {
    "text": "is we're going to have\ndefine some risk metric. This is like that miss\ndistance that we talked about at the beginning here,\nwhere the two aircraft,",
    "start": "3275360",
    "end": "3281730"
  },
  {
    "text": "how close they got together\nas a proxy for how close we are to failure. So we're going to call\nthat r, and that's going to be our risk measure.",
    "start": "3281730",
    "end": "3287880"
  },
  {
    "text": "And what we can do is, we can\nrun a bunch of random samples. We can compute the risk\nmetric of those samples. Maybe all of them are still\nfar away from failure,",
    "start": "3287880",
    "end": "3294900"
  },
  {
    "text": "but nonetheless, there's\nsome distribution of risk that we would get\nfrom these samples. And we'll turn that\ninto a data set.",
    "start": "3294900",
    "end": "3301880"
  },
  {
    "text": "And then, we can train\na diffusion model on that data set so that\nwe can produce posterior samples of our disturbances\nconditioned on a particular risk",
    "start": "3301880",
    "end": "3308930"
  },
  {
    "text": "measure. Now, this diffusion\nmodel is only going to be good around the risk\nmeasures that we've showed it.",
    "start": "3308930",
    "end": "3314828"
  },
  {
    "text": "But we should be able to\nproduce additional disturbance samples with a particular risk.",
    "start": "3314828",
    "end": "3319850"
  },
  {
    "text": "And so we can sample\nsome more disturbances. But then, what we\nmight want to do is update the thresh\nthe risk threshold.",
    "start": "3319850",
    "end": "3325330"
  },
  {
    "text": "So now we're going to\nup the level of risk that we want to see, produce\nmore samples there, and then retrain the model\nto be more effective",
    "start": "3325330",
    "end": "3331910"
  },
  {
    "text": "in the higher-risk areas. And so we can\niterate this process and ultimately try to produce\nsamples that lead to failure.",
    "start": "3331910",
    "end": "3337870"
  },
  {
    "text": "Yeah. When you say you\nupdate the threshold to produce more samples,\nare these samples from the diffusion model or\nfrom [INAUDIBLE] [? out? ?]",
    "start": "3337870",
    "end": "3343650"
  },
  {
    "text": "From the diffusion model. I see. So it's bootstrapping. Yeah, so the disturbance samples\nare from the diffusion model.",
    "start": "3343650",
    "end": "3350530"
  },
  {
    "text": "You then run them\nthrough the simulator, and then you get the risk out. Yeah, so to walkthrough\nthis a little more slowly.",
    "start": "3350530",
    "end": "3357840"
  },
  {
    "text": "We're going to define\na toy problem here. So the idea is that we imagine\nthat our disturbances are coming",
    "start": "3357840",
    "end": "3364619"
  },
  {
    "text": "from a 2D Gaussian. So it would be centered\nat this 0, 0 mark. And you get some\nsamples in the center.",
    "start": "3364620",
    "end": "3370080"
  },
  {
    "text": "And then, we'll say\nthat a failure occurs if one of those samples\nlands in one of these boxes in the top left or top right.",
    "start": "3370080",
    "end": "3376452"
  },
  {
    "text": "And then, our risk\nmeasure is going to be just the distance to\none of those failure regions, and we'll say a failure\noccurs when our risk",
    "start": "3376452",
    "end": "3382859"
  },
  {
    "text": "level is greater than 3. And that's what the\nred box is defined.",
    "start": "3382860",
    "end": "3387869"
  },
  {
    "text": "So the first step is we\njust produce some samples from our original unit\nGaussian distribution.",
    "start": "3387870",
    "end": "3393670"
  },
  {
    "text": "And indeed, none of them kind of\nhit our very rare failure modes. But we have a pretty good spread\nof the different risk that's",
    "start": "3393670",
    "end": "3400170"
  },
  {
    "text": "associated with each sample. So we can train our\ndiffusion model on it. And in particular,\nwe're again training",
    "start": "3400170",
    "end": "3406559"
  },
  {
    "text": "on these pairs of what the risk\nis and what the disturbance is. And then, what we can say is all\nright we're going to then take--",
    "start": "3406560",
    "end": "3415620"
  },
  {
    "text": "we're going to sample-- we're going to create new\nsamples of our disturbances that are conditioned--\nthat are sampled from risks",
    "start": "3415620",
    "end": "3421200"
  },
  {
    "text": "between uniformly sampled\nat higher levels of our risk threshold. So we'll produce those\nsamples and then evaluate",
    "start": "3421200",
    "end": "3427859"
  },
  {
    "text": "the risk of each one. And on that second iteration,\nwe get more samples in the higher-risk zones.",
    "start": "3427860",
    "end": "3433710"
  },
  {
    "text": "And we can see those\nthere, and then we can add those to our data set,\ncreate a new risk threshold to take the upper\nquantile of those,",
    "start": "3433710",
    "end": "3441069"
  },
  {
    "text": "and just continue\nrepeating on this process until we've basically-- oh, and we combine it\nwith the other data.",
    "start": "3441070",
    "end": "3447730"
  },
  {
    "text": "We repeat this process until\nwe're getting closer and closer to that failure distribution. And we iterate on this until our\nmovable risk threshold matches",
    "start": "3447730",
    "end": "3456700"
  },
  {
    "text": "the failure distribution\nthat we care about, and we ultimately\nend up with samples that look something like this.",
    "start": "3456700",
    "end": "3462859"
  },
  {
    "text": "And you can compare this down\nto the little plot that's on the left here. These are samples from the\nactual failure distribution",
    "start": "3462860",
    "end": "3470560"
  },
  {
    "text": "that Harrison produced by just\nrunning lots and lots and lots of Monte Carlo simulations. So the results are pretty cool.",
    "start": "3470560",
    "end": "3476630"
  },
  {
    "text": "But you might say, OK, this is\njust a simple toy problem that's meant to be visual, but\nHarrison has done this",
    "start": "3476630",
    "end": "3482320"
  },
  {
    "text": "on a bunch of other problems. So these are\ntrajectories that might look a little bit familiar\nfrom the inverted pendulum",
    "start": "3482320",
    "end": "3488920"
  },
  {
    "text": "problem, where the\ndisturbances are kind of on the talk of the pendulum,\nand what you're visualizing here",
    "start": "3488920",
    "end": "3494500"
  },
  {
    "text": "is steps in that sequence of\ndiffusion modeling process where over time, it is getting\nbetter and better",
    "start": "3494500",
    "end": "3501760"
  },
  {
    "text": "at producing failures that\nlook a lot like the most likely failures of the system.",
    "start": "3501760",
    "end": "3507760"
  },
  {
    "text": "Another really cool example\ncomes from the F-16 model, which I understand some\nof you might be working on",
    "start": "3507760",
    "end": "3514210"
  },
  {
    "text": "for the final project. So this is a very\nhigh-dimensional model with many degrees of freedom\nthat's operating over time.",
    "start": "3514210",
    "end": "3520100"
  },
  {
    "text": "And this model is able to find\nthese higher likelihood failure modes where the\naircraft actually",
    "start": "3520100",
    "end": "3526839"
  },
  {
    "text": "comes into contact\nwith the ground at the tip of that trajectory. So it's actually like\nthese types of problems",
    "start": "3526840",
    "end": "3532359"
  },
  {
    "text": "are extremely difficult to solve\nwith traditional optimizers because of the high\ndimensionality.",
    "start": "3532360",
    "end": "3537619"
  },
  {
    "text": "And doing this combined\ndata-driven iterative approach has been surprisingly effective.",
    "start": "3537620",
    "end": "3543770"
  },
  {
    "text": "So that's at a\nreally high level, you should definitely\ntalk to Harrison to learn more about what\nhe's doing with that work,",
    "start": "3543770",
    "end": "3549890"
  },
  {
    "text": "as well as some\nfollow on works that I think are going on as well. OK, so I think the\nvery last thing",
    "start": "3549890",
    "end": "3556990"
  },
  {
    "text": "I want to say before we wrap\nup the transportation systems piece, this is\nsomething that I'm sure Sidney has talked\nabout, and as Michael just",
    "start": "3556990",
    "end": "3564940"
  },
  {
    "text": "mentioned, safety is\nreally something that is very holistic\nfrom how you think about the requirements of your\nsystem to how you design it,",
    "start": "3564940",
    "end": "3572520"
  },
  {
    "text": "how you test it, and\nhow do you ultimately decide whether or not it's\nready to be out in the world.",
    "start": "3572520",
    "end": "3577530"
  },
  {
    "text": "And adaptive stress testing just\nrepresents one very small piece of the puzzle here,\nwhere it allows",
    "start": "3577530",
    "end": "3582800"
  },
  {
    "text": "us to automate a laborious\npart of this cycle, which is to discover those edge cases\nor the interesting outcomes",
    "start": "3582800",
    "end": "3590120"
  },
  {
    "text": "or failure modes\nthat we can't really find by just thinking about it. But then, that has to cycle\nback into the whole process",
    "start": "3590120",
    "end": "3597320"
  },
  {
    "text": "in order to ultimately\nend up with a product that we feel comfortable\nreleasing out into the world.",
    "start": "3597320",
    "end": "3602990"
  },
  {
    "text": "OK, so let me pause there and\nsee what questions you have, and then I will jump a\nlittle bit into the work",
    "start": "3602990",
    "end": "3608510"
  },
  {
    "text": "that I've been\nworking on at Terra AI and on these Earth\nresource problems.",
    "start": "3608510",
    "end": "3613740"
  },
  {
    "text": "Yeah. You [? might ?] [? say ?]\nsomething about transfer learning? Sure, yeah, that's a\nreally great question.",
    "start": "3613740",
    "end": "3619559"
  },
  {
    "text": "So the one other problem\nhere is that because it's",
    "start": "3619560",
    "end": "3625370"
  },
  {
    "text": "very labor-intensive to\ngenerate these failure cases for a particular system. So maybe you've\ndesigned your system,",
    "start": "3625370",
    "end": "3631040"
  },
  {
    "text": "and then you spent 10 weeks\nof a huge server farm running simulations, and you're really,\nreally happy with the results.",
    "start": "3631040",
    "end": "3637860"
  },
  {
    "text": "But you found one or two things\nthat you'd maybe to tweak. So you go back and you\nupdate your system. All of those safety\nvalidation that you just did",
    "start": "3637860",
    "end": "3644840"
  },
  {
    "text": "becomes basically\nirrelevant now. Your system has changed. And so you can't really\ntrust the outcomes",
    "start": "3644840",
    "end": "3650480"
  },
  {
    "text": "because you don't\nreally especially in this day and age, what those\nsmall changes that you just did",
    "start": "3650480",
    "end": "3655580"
  },
  {
    "text": "might-- what outcomes they might have. So some other work that's come\nout of the lab and some things",
    "start": "3655580",
    "end": "3661550"
  },
  {
    "text": "that I've worked on are\nrelated to transfer learning. So maybe you can't take\nthose validation results and just trust them\nwholesale on the new system,",
    "start": "3661550",
    "end": "3669089"
  },
  {
    "text": "but maybe you can use them\nto warm-start the validation process on another\niteration of your system",
    "start": "3669090",
    "end": "3674450"
  },
  {
    "text": "that might be better or\nhave different failure modes or whatever. And this can dramatically\nreduce the amount of time",
    "start": "3674450",
    "end": "3680780"
  },
  {
    "text": "you're spending searching\nfor failure modes by leveraging what\nyou already are maybe difficult scenarios for\nthese types of systems.",
    "start": "3680780",
    "end": "3687790"
  },
  {
    "text": "So I think that's also a\nvery exciting direction for future research. ",
    "start": "3687790",
    "end": "3693930"
  },
  {
    "text": "Cool. So we got about 15 minutes left. I'll go through this\npart pretty quickly",
    "start": "3693930",
    "end": "3699180"
  },
  {
    "text": "and then happy to take questions\nafterward or offline as well. OK, so I want to\ntalk a little bit",
    "start": "3699180",
    "end": "3705482"
  },
  {
    "text": "about what got me interested. So I was working a lot on\nautonomous driving aviation.",
    "start": "3705482",
    "end": "3711450"
  },
  {
    "text": "And when I started encountering\nthese problems in the climate space, I became\nreally hooked in part",
    "start": "3711450",
    "end": "3718079"
  },
  {
    "text": "because I think they're really\ndeeply interesting problems, but also, they have a\nreally important impact. So right now, we are at a\nreally, really big inflection",
    "start": "3718080",
    "end": "3726060"
  },
  {
    "text": "point in terms of what\ncould or could not occur with the climate crisis. So this is showing a variety\nof possible heating outcomes",
    "start": "3726060",
    "end": "3735089"
  },
  {
    "text": "that could occur with\ndifferent types of policies that might be enacted. So we have in orange here, like\nthe current set of policies,",
    "start": "3735090",
    "end": "3742080"
  },
  {
    "text": "which may or may not hold\nup now may or may not have been followed.",
    "start": "3742080",
    "end": "3747390"
  },
  {
    "text": "If we do nothing, we're in a\nvery, very serious situation here with more than\n4 degrees heating.",
    "start": "3747390",
    "end": "3753089"
  },
  {
    "text": "But there are even\npathways down to things that only lock in temperature\nincrease of around 1.5",
    "start": "3753090",
    "end": "3759260"
  },
  {
    "text": "to 2 degrees C, which\nis still very, very bad, but it's a lot better\nthan what could be.",
    "start": "3759260",
    "end": "3764640"
  },
  {
    "text": "So I think it's\njust super important that a lot of good\ntechnology and policy comes online right\nnow in order for us",
    "start": "3764640",
    "end": "3771090"
  },
  {
    "text": "to address this\nproblem going forward. But there are a\nlot of open issues.",
    "start": "3771090",
    "end": "3776140"
  },
  {
    "text": "So number one, the demand for\nenergy is just increasing. So as the rest of the world is\ndeveloping, and in fact, even",
    "start": "3776140",
    "end": "3783930"
  },
  {
    "text": "in the more developed\nworld, the amount of energy that each person consumes\nis just going up. And some amount of\nchanging of behavior",
    "start": "3783930",
    "end": "3791579"
  },
  {
    "text": "is likely to be necessary here. But we can't necessarily\nask the rest of the world",
    "start": "3791580",
    "end": "3797010"
  },
  {
    "text": "to not develop, for example. And so we need ways of\nbasically dramatically upping",
    "start": "3797010",
    "end": "3802540"
  },
  {
    "text": "the amount of energy\nthat we produce, as well as reduce our\nCO2 emissions if we're going to hit these goals.",
    "start": "3802540",
    "end": "3808370"
  },
  {
    "text": "And so it's going to be a suite\nof technologies that do this. So you can see here the\nchange in behavior, the energy",
    "start": "3808370",
    "end": "3814810"
  },
  {
    "text": "efficiency, electrification, and\nthen correspondingly renewable energies, and then things\nlike carbon storage",
    "start": "3814810",
    "end": "3821950"
  },
  {
    "text": "where certain things that\nare hard to decarbonize, like the production of cement\nor fertilizer or air travel,",
    "start": "3821950",
    "end": "3830119"
  },
  {
    "text": "we need a way of taking\nCO2 and keeping it from going into the atmosphere.",
    "start": "3830120",
    "end": "3836710"
  },
  {
    "text": "Additionally, there's projected\nto be a huge shortfall in the amount of\ncritical minerals",
    "start": "3836710",
    "end": "3841750"
  },
  {
    "text": "that we need for the development\nor the electrification of all of the grid as well\nas the need for all",
    "start": "3841750",
    "end": "3847598"
  },
  {
    "text": "these different batteries\nand all the electronics that we need, basically,\nthere's a huge lack of minerals",
    "start": "3847598",
    "end": "3855279"
  },
  {
    "text": "that we need to pull\nout of the ground. And yet, we seem to be\ngetting worse and worse",
    "start": "3855280",
    "end": "3860890"
  },
  {
    "text": "at finding new mineral deposits. So what you see\nhere is basically how many new discoveries\nhave been made recently.",
    "start": "3860890",
    "end": "3869470"
  },
  {
    "text": "And you can see that\nthere's a trend downwards despite the yellow\ncurve, which is the amount of\nexploration investment",
    "start": "3869470",
    "end": "3875020"
  },
  {
    "text": "that's been done is going up. So people are spending more\nmoney to try to find things, and they're getting worse\nand worse at finding it,",
    "start": "3875020",
    "end": "3880760"
  },
  {
    "text": "and the explanation for\nthis is pretty simple. It's that all the easy\nstuff has been found. And so we need to look deeper\nand find more complex systems",
    "start": "3880760",
    "end": "3889780"
  },
  {
    "text": "in order to find the\nminerals that we need. So all of this is to say\nthat the subsurface is",
    "start": "3889780",
    "end": "3895300"
  },
  {
    "text": "a really key resource. So historically, it's\nbeen a key resource because it's where we got\nhydrocarbons and pulled them out",
    "start": "3895300",
    "end": "3900477"
  },
  {
    "text": "of the ground. But now, it's also going to be\na key resource for the net zero transition. So I showed this slide already.",
    "start": "3900477",
    "end": "3907089"
  },
  {
    "text": "But we have the raw materials. We have renewable energy,\nand we have carbon storage.",
    "start": "3907090",
    "end": "3912670"
  },
  {
    "text": "So what's interesting\nabout these problems is that although they are\nextremely different from one another, the development of\nnew energy systems, the storage",
    "start": "3912670",
    "end": "3920510"
  },
  {
    "text": "of carbon, they actually have\none commonality to them, which is that you need to make very\ncomplex decisions in highly",
    "start": "3920510",
    "end": "3927530"
  },
  {
    "text": "uncertain environments. And again, that\nuncertainty comes from the viability in\nthe geology of what",
    "start": "3927530",
    "end": "3932720"
  },
  {
    "text": "could be underneath the Earth. So let me talk about what that\nproblem looks like in the setup",
    "start": "3932720",
    "end": "3938630"
  },
  {
    "text": "of a carbon storage problem. So in carbon storage,\nwe are basically drilling deep into the ground\ninto these typically saline",
    "start": "3938630",
    "end": "3947030"
  },
  {
    "text": "aquifers. So it's like this porous rock\nthat has saltwater in it. So it's not that\nuseful for drinking.",
    "start": "3947030",
    "end": "3953150"
  },
  {
    "text": "And usually, that rock is\ncapped by a harder rock so that you can\ninject CO2, which wants to float its way\nback to the surface,",
    "start": "3953150",
    "end": "3959760"
  },
  {
    "text": "but it will remain trapped\nlike an inverted bowl underneath the ground. And our goal is to basically\ninject as much CO2 as we can",
    "start": "3959760",
    "end": "3967819"
  },
  {
    "text": "and keep it trapped there. So if that CO2 does find\nits way back to the surface, that can be a very bad thing.",
    "start": "3967820",
    "end": "3973050"
  },
  {
    "text": "I'll talk more about\nthat in a second. But the trick here is\nthat we don't actually know what this thing that we're\ninjecting into, what it actually",
    "start": "3973050",
    "end": "3981170"
  },
  {
    "text": "looks like. So what we can do is we can\nmaybe drill an exploration hole. We can observe, at a\nparticular point, what",
    "start": "3981170",
    "end": "3988220"
  },
  {
    "text": "are the properties of the rock. We may also-- when we're\noperating the reservoir,",
    "start": "3988220",
    "end": "3994770"
  },
  {
    "text": "so we've drilled a hole, we\ncan put a sensor down there and observe what's going on\nat that particular position.",
    "start": "3994770",
    "end": "4000230"
  },
  {
    "text": "Or, we can do things\ntake measurements from the ground like seismic\nmeasurements, which is basically",
    "start": "4000230",
    "end": "4005950"
  },
  {
    "text": "like an ultrasound, but\nfor the Earth subsurface. So you can get some\nmeasurements of the rock density",
    "start": "4005950",
    "end": "4011560"
  },
  {
    "text": "and stuff like that. But all of this paints a\nvery, very incomplete picture of what's going on there.",
    "start": "4011560",
    "end": "4016930"
  },
  {
    "text": "And why this matters is if\nwe're uncertain about what the subsurface looks\nlike, we can't really",
    "start": "4016930",
    "end": "4023650"
  },
  {
    "text": "answer questions about where\nwe should inject into it, because there are better and\nworse places for the ability",
    "start": "4023650",
    "end": "4029290"
  },
  {
    "text": "to inject CO2. We can't answer basic questions\nlike how much CO2 will we be able to inject.",
    "start": "4029290",
    "end": "4034410"
  },
  {
    "text": "And that's important from\na business perspective when you need to\nsign contracts saying I will store x amount of CO2.",
    "start": "4034410",
    "end": "4040850"
  },
  {
    "text": "And then, if we do want to try\nto learn more about the system, what types of measurements\nshould we take? Should we go take\nseismic measurements?",
    "start": "4040850",
    "end": "4047220"
  },
  {
    "text": "Should we go drill\ninto the ground in what order should we\ndo those measurements. And what's really cool about\nthis problem in my opinion.",
    "start": "4047220",
    "end": "4053640"
  },
  {
    "text": "So for those of you who have\ntaken Michael's other courses around decision-making\nunder uncertainty is that you can formulate\nthis problem as a POMDP.",
    "start": "4053640",
    "end": "4062042"
  },
  {
    "text": "So it's partially observed\nbecause we don't know what the state of the subsurface is.",
    "start": "4062042",
    "end": "4067440"
  },
  {
    "text": "And yet, you're taking\nactions, and you have objectives and constraints.",
    "start": "4067440",
    "end": "4072710"
  },
  {
    "text": "And then, what we can do is,\nwe can throw our various POMDP solvers at it, and we can\ndo Bayesian inference.",
    "start": "4072710",
    "end": "4078290"
  },
  {
    "text": "When we get new\nsources of data, how do update our belief\nabout the subsurface? Some of the other things\nthat we work on are--",
    "start": "4078290",
    "end": "4085250"
  },
  {
    "text": "one thing a POMDP always has\nis a transition function, which describes how the\nsystem will evolve over time.",
    "start": "4085250",
    "end": "4093450"
  },
  {
    "text": "So in the case of\ncarbon storage, we're injecting CO2\ninto the ground, and then it is migrating\nunderground over time.",
    "start": "4093450",
    "end": "4100200"
  },
  {
    "text": "And we need to make sure, again\nthat this CO2 is being trapped for thousands of years or until\nit actually solidifies and turns",
    "start": "4100200",
    "end": "4107600"
  },
  {
    "text": "into salt, basically. And so we need to be able\nto simulate that process. And historically,\npeople have spent",
    "start": "4107600",
    "end": "4115700"
  },
  {
    "text": "a lot of effort building these\nphysics-based simulators of how gas would evolve underground,\nbut they're super, super slow.",
    "start": "4115700",
    "end": "4122939"
  },
  {
    "text": "So running one simulation would\ntake us maybe 10 or 12 hours. And if we want to do\nany AI or optimization,",
    "start": "4122939",
    "end": "4130649"
  },
  {
    "text": "we need to be able to do\nthat much, much faster. So some of the work that we\nfocus on, both in research",
    "start": "4130649",
    "end": "4135679"
  },
  {
    "text": "and at the company, is\nbuilding surrogate models for this type of process. So what we do here, it's a\npurely supervised learning task.",
    "start": "4135680",
    "end": "4142409"
  },
  {
    "text": "We run some physics-based\nsimulator to produce. What would the CO2 plume\nlook like underground,",
    "start": "4142410",
    "end": "4148920"
  },
  {
    "text": "how would it evolve, and then\nwe train a deep neural network to just imitate that\nphysical behavior.",
    "start": "4148920",
    "end": "4154239"
  },
  {
    "text": "And we just do it on a\nbunch of diverse samples. And what you get\nout is basically a simulator that is\nthousands of times faster,",
    "start": "4154240",
    "end": "4161880"
  },
  {
    "text": "and it's a little less accurate,\nbut it more than makes up for that lack of\naccuracy by being",
    "start": "4161880",
    "end": "4168149"
  },
  {
    "text": "able to consider way more\nscenarios of what could occur.",
    "start": "4168149",
    "end": "4173250"
  },
  {
    "text": "OK, and the result of\nthis-- and this is a paper that's in submission right now--",
    "start": "4173250",
    "end": "4178830"
  },
  {
    "text": "is that a POMDP solution that\nwas done using a basic optimizer",
    "start": "4178830",
    "end": "4185729"
  },
  {
    "text": "is able to do better\nthan the human reservoir engineers who are being tasked\nto design these reservoirs.",
    "start": "4185729",
    "end": "4192900"
  },
  {
    "text": "So what we're showing\nhere basically is the design of the reservoir,\nso where they put the injectors.",
    "start": "4192900",
    "end": "4198370"
  },
  {
    "text": "They inject CO2. And then, that CO2 evolves\nover roughly 1,000-year period. And then, we can measure,\nin this simulation,",
    "start": "4198370",
    "end": "4205500"
  },
  {
    "text": "how much of the CO2 remained\ntrapped in the reservoir, or how much of it exited the\ndomain, and therefore, could",
    "start": "4205500",
    "end": "4211260"
  },
  {
    "text": "potentially leak back\nup to the surface. And in the case of the\nreservoir engineering expert,",
    "start": "4211260",
    "end": "4217330"
  },
  {
    "text": "they still had situations\nwhere 16% of the CO2 leaked out of this\nvolume, whereas the AI was",
    "start": "4217330",
    "end": "4224250"
  },
  {
    "text": "able to do it with a very,\nvery small leakage fraction. So this shows the\npotential of applying",
    "start": "4224250",
    "end": "4229590"
  },
  {
    "text": "these algorithmic\ndecision-making tools to this problem. Now, let me talk about\nsome of the risks.",
    "start": "4229590",
    "end": "4235360"
  },
  {
    "text": "And this is why these\nproblems are safety-critical. So number one, this\nis a risk that's",
    "start": "4235360",
    "end": "4240420"
  },
  {
    "text": "probably most associated\nwith the production of geothermal energy. But it's also associated\nwith carbon storage.",
    "start": "4240420",
    "end": "4246840"
  },
  {
    "text": "And that is the risk\nof induced seismicity. So in geothermal energy,\ntypically what you're doing is,",
    "start": "4246840",
    "end": "4251940"
  },
  {
    "text": "you drill two holes\nin the ground. You pump cold water into one,\nand you extract hot water from the other one.",
    "start": "4251940",
    "end": "4257670"
  },
  {
    "text": "And sometimes when you're\ninjecting water into the ground, they are injecting it\nat really high pressures",
    "start": "4257670",
    "end": "4263500"
  },
  {
    "text": "so that you can get a lot\nof throughput of water and therefore pull a lot\nof heat out of the ground. But when you do that\nat high pressures,",
    "start": "4263500",
    "end": "4269870"
  },
  {
    "text": "you can basically reactivate\nfaults that are in the area. So faults are these\nbreaks in the subsurface",
    "start": "4269870",
    "end": "4276820"
  },
  {
    "text": "that are typically under\nsome of stress state. And when they slip, that's\nwhat causes earthquakes.",
    "start": "4276820",
    "end": "4281840"
  },
  {
    "text": "And so there's even\nbeen earthquakes that have been caused\nby geothermal sites. So there was a huge\nearthquake in South Korea",
    "start": "4281840",
    "end": "4288159"
  },
  {
    "text": "that they ultimately tied\nto a geothermal plant that was just outside the city. And because geothermal is used\nto produce electricity and heat,",
    "start": "4288160",
    "end": "4297680"
  },
  {
    "text": "they're often nearby cities. And so therefore, these\ntypes of disasters can really harm people.",
    "start": "4297680",
    "end": "4305170"
  },
  {
    "text": "Another potential issue-- so\ngoing back to the carbon storage case is when you pump a\nbunch of CO2 into the ground,",
    "start": "4305170",
    "end": "4312290"
  },
  {
    "text": "as I described it wants\nto find its way back. So if it can find a\nfault or something,",
    "start": "4312290",
    "end": "4317420"
  },
  {
    "text": "it will begin to migrate back to\nthe surface and can potentially, in the best case, it'll just go\nback out into the atmosphere,",
    "start": "4317420",
    "end": "4323615"
  },
  {
    "text": "and it kind of defeats the whole\npurpose of what we were doing. But in the worst case, it\ncan actually kill people.",
    "start": "4323615",
    "end": "4328875"
  },
  {
    "text": "So this is not a\ncarbon storage case, but it is a naturally occurring\nthing that occurred in 1986.",
    "start": "4328875",
    "end": "4335942"
  },
  {
    "text": "There was a lake. There was a huge amount of\nCO2 trapped like geologically",
    "start": "4335942",
    "end": "4341080"
  },
  {
    "text": "under this lake, that\nfor whatever reason, all came out in one big\nplume, and it actually suffocated a local village\nand a bunch of livestock.",
    "start": "4341080",
    "end": "4348260"
  },
  {
    "text": "So this is an extremely\ndangerous thing. Ideally, we do this\ntype of operation",
    "start": "4348260",
    "end": "4353440"
  },
  {
    "text": "offshore where there\naren't people around, but there are projects\nthat are being discussed for onshore operation as well.",
    "start": "4353440",
    "end": "4360170"
  },
  {
    "text": "And so these are some of\nthe really important things that we need to focus on. And yet, we're in\nthis situation where",
    "start": "4360170",
    "end": "4367540"
  },
  {
    "text": "we have a lot of\nuncertainty in our state. We have very complex\ntransition dynamics,",
    "start": "4367540",
    "end": "4372560"
  },
  {
    "text": "and we have very\nlimited observations of how we might operate. And so some of the\nwork that I think",
    "start": "4372560",
    "end": "4379360"
  },
  {
    "text": "SISL will be doing\nover the next few years and that we will be\ndoing at the company is how do we actually do the\nsafety evaluation for these more",
    "start": "4379360",
    "end": "4386210"
  },
  {
    "text": "automated decision-making\nagents that are going to be thinking about\nhow to solve these problems.",
    "start": "4386210",
    "end": "4391250"
  },
  {
    "text": "So let me pause\nthere for a second and also welcome\nyou guys to share",
    "start": "4391250",
    "end": "4396829"
  },
  {
    "text": "with me now or in the\nfuture what your ideas are. How would you tackle this as\na safety evaluation problem",
    "start": "4396830",
    "end": "4403369"
  },
  {
    "text": "based on what you\nlearned here in the class or what you learned for the\nremainder of the course?",
    "start": "4403370",
    "end": "4410010"
  },
  {
    "text": "So any thoughts? Actually, I would love\nto hear how would you apply some of the\ntechniques that you",
    "start": "4410010",
    "end": "4415550"
  },
  {
    "text": "have been learning about? ",
    "start": "4415550",
    "end": "4421190"
  },
  {
    "text": "Question? Yeah. How does the observations\nlook like during these years?",
    "start": "4421190",
    "end": "4426390"
  },
  {
    "text": "Because I guess, do you have\nenough to make conclusions on? Yeah, so what are the\nobservations look like.",
    "start": "4426390",
    "end": "4432230"
  },
  {
    "text": "So the observations\nare very diverse. So there's these big\nsurveys, seismic surveys,",
    "start": "4432230",
    "end": "4437760"
  },
  {
    "text": "geophysical surveys, and then\nthere are these localized point measurements. And yeah, the observations\ndo constrain what",
    "start": "4437760",
    "end": "4446450"
  },
  {
    "text": "could be in the subsurface. But typically, part\nof this whole process",
    "start": "4446450",
    "end": "4451790"
  },
  {
    "text": "is encouraging these companies\nto do additional data collection in order to better understand\nthe reservoir before operating",
    "start": "4451790",
    "end": "4458690"
  },
  {
    "text": "these projects. So it's kind of it varies a lot. Yeah, a question?",
    "start": "4458690",
    "end": "4464480"
  },
  {
    "text": "So to answer your\nprevious question-- well, not to answer it,\nbut to say, I feel",
    "start": "4464480",
    "end": "4469910"
  },
  {
    "text": "like the first half of the talk\nwas very focused on optimizing some disturbance. But in the second half\nof the talk is like,",
    "start": "4469910",
    "end": "4475770"
  },
  {
    "text": "let's watch what happens\nand see what happens. Yeah. And I'm curious if\nthere's opportunities to apply disturbances in the\nshape of these are some Earth",
    "start": "4475770",
    "end": "4484010"
  },
  {
    "text": "events or whatever. I'm not sure what\nthe right term is for that in a more\nactive way, search",
    "start": "4484010",
    "end": "4489320"
  },
  {
    "text": "for failures in these cases. Yeah, that's great. So the idea being,\ncan we take some of the more active\nsearching of failures",
    "start": "4489320",
    "end": "4495500"
  },
  {
    "text": "to these types of problems? So indeed, I think\nprobably one of the biggest drivers of outcomes here is\nthe geological uncertainty.",
    "start": "4495500",
    "end": "4502960"
  },
  {
    "text": "And so you could look for\nspecific geological instances, let's say, that would lead\nto some adverse outcome.",
    "start": "4502960",
    "end": "4508305"
  },
  {
    "text": "And then maybe you go\ndo some data collection to look for those in particular. So I know we're\ncoming up on time.",
    "start": "4508305",
    "end": "4513460"
  },
  {
    "text": "So we can chat more after this. I just want to do a quick plug. There is a simplified\nCO2 injection",
    "start": "4513460",
    "end": "4521910"
  },
  {
    "text": "POMDP that we did for a NeurIPS\nworkshop paper a couple of years",
    "start": "4521910",
    "end": "4527940"
  },
  {
    "text": "ago. So you'd be welcome to work on\nthis, either for this project or in the future.",
    "start": "4527940",
    "end": "4532960"
  },
  {
    "text": "Feel free to reach out if\nyou have questions about it. And then, one other thing,\nif you are an undergraduate, we are doing internships\nfunded by the TomKat Center",
    "start": "4532960",
    "end": "4541050"
  },
  {
    "text": "here at Stanford for\nthis summer if you're interested in thinking about\nthese types of problems in intern fashion.",
    "start": "4541050",
    "end": "4547989"
  },
  {
    "text": "But thank you all so much. Feel free to reach out\nto me with questions, and it was a pleasure\nchatting with you all.",
    "start": "4547990",
    "end": "4553143"
  },
  {
    "text": "[APPLAUSE] ",
    "start": "4553143",
    "end": "4561000"
  }
]