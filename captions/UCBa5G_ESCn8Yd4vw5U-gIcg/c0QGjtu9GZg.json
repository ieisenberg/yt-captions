[
  {
    "start": "0",
    "end": "5840"
  },
  {
    "text": "Happy Friday, CS109. How are you guys doing today? Good. Awesome.",
    "start": "5840",
    "end": "11120"
  },
  {
    "text": "I appreciate that. And I also appreciate it\nbecause I know it's a Friday, and I know it's a Friday\nbefore the midterm. So wow, do I appreciate\nyou guys coming to class.",
    "start": "11120",
    "end": "17250"
  },
  {
    "text": "Thank you so much. A couple quick things\nbefore we jump into things.",
    "start": "17250",
    "end": "22700"
  },
  {
    "text": "Because it's a Friday, I'll\nstart by telling a story, as always. And I think the\nlast time I told you",
    "start": "22700",
    "end": "28310"
  },
  {
    "text": "the story of how I met my wife. Is that right? But where do we end up?",
    "start": "28310",
    "end": "33860"
  },
  {
    "text": "Did I get in the truck? Yeah, yes. And did I make it all\nthe way to Romania? Yes.",
    "start": "33860",
    "end": "38990"
  },
  {
    "text": "Oh, OK. So then I get to Romania, and\nthere I run into my wife again. And she's so-- she's\nnot my wife at the time.",
    "start": "38990",
    "end": "46429"
  },
  {
    "text": "I run, and I say,\n\"Hi, I made it.\" And then I got this\nwonderful story",
    "start": "46430",
    "end": "51473"
  },
  {
    "text": "to tell her about how I\ntook all these trucks, and I think she\nwas very impressed. And at this point, it\njust was a great reunion.",
    "start": "51473",
    "end": "59809"
  },
  {
    "text": "We had about four or\nfive days together and just felt fantastic. But as life would\nhave it, she continued",
    "start": "59810",
    "end": "67260"
  },
  {
    "text": "to have these exciting plans. She was going to go working\nat a refugee camp in Hungary for a while, and\nwe thought we were",
    "start": "67260",
    "end": "73905"
  },
  {
    "text": "going to go different ways. And we went\ndifferent ways again, but the most serendipitous\nthing happened.",
    "start": "73905",
    "end": "80640"
  },
  {
    "text": "A few days later, I was\nin a train in Hungary in the middle of the night,\nand it's kind of cold.",
    "start": "80640",
    "end": "87000"
  },
  {
    "text": "I'm just minding\nmy own business, and I'm talking a little bit to\nthe person in the car with me.",
    "start": "87000",
    "end": "92100"
  },
  {
    "text": "And then Laura shows up. Apparently, she had\ngotten into the same train in the same random part\nof Hungary the same night",
    "start": "92100",
    "end": "99510"
  },
  {
    "text": "and then sat down in the\ncar right next to me. And then she heard my voice. She was like, \"What?\" The person who came all the way\nby the trucks to come find me",
    "start": "99510",
    "end": "107190"
  },
  {
    "text": "in Romania, how did\nyou end up here? And so at this point,\nwe're like, oh my gosh, the world has\nbrought us together",
    "start": "107190",
    "end": "112740"
  },
  {
    "text": "in so many different ways. We ran into each other\non the island a bunch. We managed to make it\nto Romania together. Now we ran into each\nother on a train.",
    "start": "112740",
    "end": "119063"
  },
  {
    "text": "And at that point, we decided,\nhey, what if we intentionally ran into each other? So even though she was going\nto a different destination",
    "start": "119063",
    "end": "125729"
  },
  {
    "text": "than me, we decided,\nhey, let's go meet up. And then we met up, and we\nstarted traveling together.",
    "start": "125730",
    "end": "130739"
  },
  {
    "text": "And then our paths didn't\nreally go that different ways until this day. So that's the second part of\nthe story of how I met my wife.",
    "start": "130740",
    "end": "138690"
  },
  {
    "text": "And I suppose even\nthough there's this really cute meet-cute,\ncertainly, the more interesting part of the story\nis the one where",
    "start": "138690",
    "end": "144990"
  },
  {
    "text": "we got to intentionally\nchoose to spend time together, and I got to know\nthis wonderful woman. And all those moments, those\nare the really special things.",
    "start": "144990",
    "end": "152010"
  },
  {
    "text": "The meet-cute is\njust like a nice-- but that's not\nimportant right now. What is important is,\noh boy, do we have",
    "start": "152010",
    "end": "157620"
  },
  {
    "text": "a cool lecture for you guys. I appreciate you guys\ncoming to this lecture, so I want to give you something\nvery useful, very cool.",
    "start": "157620",
    "end": "162870"
  },
  {
    "text": "We're going to be learning\ngeneral inference. In particular, you're going to\nbe learning an algorithm called",
    "start": "162870",
    "end": "168420"
  },
  {
    "text": "rejection sampling. You guys might know some of the\nother professors at Stanford. But I was talking to a\nprofessor, Noah Goodman,",
    "start": "168420",
    "end": "175230"
  },
  {
    "text": "who is one of the more\nfamous modern statisticians of our times, who happens\nto also be at Stanford. And we were talking.",
    "start": "175230",
    "end": "180810"
  },
  {
    "text": "I said, \"You know, I think\nthis is something I really want to bring into our\nIntro to Probability class because I think it\nclarifies so much.",
    "start": "180810",
    "end": "186540"
  },
  {
    "text": "And he says, \"Yeah, if there\nis one thing that I thought all Intro to Probability\npeople should see earlier",
    "start": "186540",
    "end": "191819"
  },
  {
    "text": "is this idea of\nrejection sampling. So you're going to\nsee a beautiful idea, with Noah Goodman's\nstamp of approval.",
    "start": "191820",
    "end": "197820"
  },
  {
    "text": "In today's class, we're\ngoing to do two things. We're going to finish\nour conversation about correlations,\nand we're going",
    "start": "197820",
    "end": "202997"
  },
  {
    "text": "to be learning about\nrejection sampling. And it really comes\naround this beautiful idea that you guys saw on Wednesday\ncalled Bayesian networks.",
    "start": "202998",
    "end": "210090"
  },
  {
    "text": "And in case people\nlost the plot, I put the whole plot line\nup here on the board.",
    "start": "210090",
    "end": "215890"
  },
  {
    "text": "So the whole plot line\nof what we're doing is, we would like\nto be able to solve beautiful,\ninteresting real world",
    "start": "215890",
    "end": "222630"
  },
  {
    "text": "problems with the power\nof probability tools. But most real world problems\nhave a lot of random variables.",
    "start": "222630",
    "end": "229590"
  },
  {
    "text": "That in itself\nshouldn't be too big a problem, except it leads to\nthis interesting computational problem.",
    "start": "229590",
    "end": "235200"
  },
  {
    "text": "One of the most\nstraightforward ways to represent many\nrandom variables together is a thing\ncalled a joint table.",
    "start": "235200",
    "end": "242310"
  },
  {
    "text": "And a joint table is\nexponentially large. So as you have bigger worlds\nthat you want to represent,",
    "start": "242310",
    "end": "248310"
  },
  {
    "text": "a joint table would\nneed exponential numbers of probabilities. That's both a space\nissue, and you'll",
    "start": "248310",
    "end": "253428"
  },
  {
    "text": "have to do exponential\namount of work in order to estimate those. Big problems. How sad. We wanted to do\nthis, but we can't.",
    "start": "253428",
    "end": "260759"
  },
  {
    "text": "Enter this great idea of Bayes\nnets that we saw on Wednesday. And Bayes nets is a way to\nrepresent a probabilistic model",
    "start": "260760",
    "end": "267270"
  },
  {
    "text": "for a real world problem. But it has this\nbeautiful property that is going to be\nO of n in terms of n,",
    "start": "267270",
    "end": "274140"
  },
  {
    "text": "the number of random variables. So Bayes nets allowed\nus to do probability for real world problems.",
    "start": "274140",
    "end": "280289"
  },
  {
    "text": "Now, that leaves two\nto-dos for you guys. You would need to know\nhow to create a Bayes net, and you need to do this\ntask that we call inference.",
    "start": "280290",
    "end": "287340"
  },
  {
    "text": "But inference is\njust a fancy word for saying, do conditional\nprobability in the context",
    "start": "287340",
    "end": "292680"
  },
  {
    "text": "of this big random variable. If you guys have plot line\nquestions, please do ask me.",
    "start": "292680",
    "end": "299230"
  },
  {
    "text": "Now, towards this\nidea of a Bayes net, the key concept was, if you can\nhave some expression of which",
    "start": "299230",
    "end": "307210"
  },
  {
    "text": "random variables cause which\nother random variables, you can really compress\nhow you represent the joint distribution.",
    "start": "307210",
    "end": "313780"
  },
  {
    "text": "But that would require you to\nbe able to create a Bayes net. And there was this side\nplot in Wednesday's class,",
    "start": "313780",
    "end": "319240"
  },
  {
    "text": "and I'd like to pick up on it. Oh, and of course, there's\nlots of real world problems that you could think about,\nbut our running theme",
    "start": "319240",
    "end": "326169"
  },
  {
    "text": "has been WebMD. So WebMD, you say a\nbunch of symptoms, and it can tell you for\nall the possible diseases",
    "start": "326170",
    "end": "332860"
  },
  {
    "text": "the probability of you having\nall those different diseases. The Bayesian network was\ndefined in a few ways.",
    "start": "332860",
    "end": "342020"
  },
  {
    "text": "One of the ways it's\ndefined is, first you take all your\nrandom variables, and you make them\nnodes in a graph.",
    "start": "342020",
    "end": "347740"
  },
  {
    "text": "And then we're\ngoing to draw lines in a directed way from nodes\nthat we think are causally",
    "start": "347740",
    "end": "354580"
  },
  {
    "text": "impacting other nodes. So we think flu causes\nyou to have fever and flu causes you to be tired.",
    "start": "354580",
    "end": "359950"
  },
  {
    "text": "Now, there is a big\nasterisk here in the O of n. It's that this O of\nn assumes that you",
    "start": "359950",
    "end": "365199"
  },
  {
    "text": "don't have too many arrows. So if you have a sparse\nnumber of arrows, then you get the\nnice compression.",
    "start": "365200",
    "end": "371600"
  },
  {
    "text": "Once you draw arrows,\nyou have to give the probability of every\nrandom variable given",
    "start": "371600",
    "end": "376610"
  },
  {
    "text": "its causal parents. And if you do that,\nthat's your compressed way of representing the\nentire joint distribution.",
    "start": "376610",
    "end": "382920"
  },
  {
    "text": "So for every probability,\ngive it the probability of the node given its parents.",
    "start": "382920",
    "end": "388260"
  },
  {
    "text": "So for example, tired has two\nparents, flu and undergraduate. For every combination of\nvalues for its parents,",
    "start": "388260",
    "end": "393950"
  },
  {
    "text": "you have to give the\nprobability of tired. But if you do that for\nevery random variable, you would define a joint\nin a very compressed way.",
    "start": "393950",
    "end": "400580"
  },
  {
    "text": "Wonderful. There is a semantic way of\nthinking about these Bayes nets, why they're so amazing.",
    "start": "400580",
    "end": "407180"
  },
  {
    "text": "And one way of thinking about\nit is that they're generative. They tell you the story of\nhow the joint comes to be.",
    "start": "407180",
    "end": "413789"
  },
  {
    "text": "And the story that's told\nhere is, first, people have these priors, whether\nor not they have the flu",
    "start": "413790",
    "end": "419340"
  },
  {
    "text": "or whether or not\nthey're undergrad. And then we generate whether\nthey have fever from those. So it's like the world gets\ngenerated from top to bottom.",
    "start": "419340",
    "end": "426910"
  },
  {
    "text": "And I really like this idea\nof thinking generatively and thinking about the process\nfrom which a joint is created.",
    "start": "426910",
    "end": "434040"
  },
  {
    "text": "It's not just for\nWebMD, you know? There's lots of\ndifferent situations where people might use\nthese, like figuring out",
    "start": "434040",
    "end": "440430"
  },
  {
    "text": "why you have communication\nloss or battery failure for how",
    "start": "440430",
    "end": "447270"
  },
  {
    "text": "systems can go down. Or maybe you care about\ndetecting whether or not there is a chemical in a\nparticular matter in the air.",
    "start": "447270",
    "end": "455457"
  },
  {
    "text": "For all these things, you\nmight want a Bayes net. They're a very powerful tool. It's just a general way of\nthinking about probability,",
    "start": "455458",
    "end": "461289"
  },
  {
    "text": "and what a language to have. So if you want to be\nworking on this skill, creating a Bayes net, we\nhave to be able to come up",
    "start": "461290",
    "end": "468630"
  },
  {
    "text": "with a structure. But then we also have to define\nfor every random variable its probability\ngiven its parents.",
    "start": "468630",
    "end": "474960"
  },
  {
    "text": "You could express\nthat in a few ways. You can express\nit mathematically, or you can express\nit through code. What a time to be alive.",
    "start": "474960",
    "end": "481139"
  },
  {
    "text": "And then of course,\nas we mentioned, the assumption in\nthe Bayes net is that if you take the probability\nof every random variable given",
    "start": "481140",
    "end": "489365"
  },
  {
    "text": "the values of its\nparents, if you multiply all those\ntogether, that's where the joint comes from. So it's a simplification of\nhow to express the joint.",
    "start": "489365",
    "end": "497840"
  },
  {
    "text": "OK, that's where we left off. What we haven't\nreally talked about is how do people in the\nreal world design these.",
    "start": "497840",
    "end": "505080"
  },
  {
    "text": "Like, if I gave\nyou a data set, you could make a Bayesian network. But you maybe know\nthe causality.",
    "start": "505080",
    "end": "510397"
  },
  {
    "text": "And if you know the\ncausality, you're done. Just draw your nodes\nand put the causality. But I want to give\nyou a real world",
    "start": "510398",
    "end": "516570"
  },
  {
    "text": "data set where people might want\nto design the Bayesian network. The real world data\nset I have for you guys",
    "start": "516570",
    "end": "522269"
  },
  {
    "text": "is all these people in the\nUK saying what sort of music they want. So every row here is a person\nin the UK saying, one to five,",
    "start": "522270",
    "end": "529079"
  },
  {
    "text": "do I like dance music,\nfolk music, country music, classical music,\nmusicals, pop, and so on.",
    "start": "529080",
    "end": "535420"
  },
  {
    "text": "And you'd like to\nhave a model of how all these random variables\nare interacting together.",
    "start": "535420",
    "end": "541100"
  },
  {
    "text": "Making a joint table\nwould be too hard. But if you could come up\nwith a Bayesian network which",
    "start": "541100",
    "end": "546910"
  },
  {
    "text": "says how these different random\nvariables might be causing each other, you could express\nthis entire complex system",
    "start": "546910",
    "end": "555220"
  },
  {
    "text": "in O of n space. If you could design this, great.",
    "start": "555220",
    "end": "560370"
  },
  {
    "text": "You have an expression\nfrom which we can solve probability questions. We'll start to be able to\nsay things like, OK, you",
    "start": "560370",
    "end": "565550"
  },
  {
    "text": "listen to a punk song. Therefore, I think\nyou like punk, which will change my\nbelief in all these things, and I'll have a better\nbelief of whether",
    "start": "565550",
    "end": "571386"
  },
  {
    "text": "or not you like reggae or opera. And you'd be able to do all\nthese wonderful inference tasks, if you could design it.",
    "start": "571387",
    "end": "576440"
  },
  {
    "text": "Now, maybe you just\nknow how music works. And maybe you just sit\ndown and be like, OK, people who like pop music also\nlike classy music like opera,",
    "start": "576440",
    "end": "585560"
  },
  {
    "text": "dance music. They maybe like punk music too. And maybe you can just\ndesign this from scratch.",
    "start": "585560",
    "end": "591260"
  },
  {
    "text": "But one of the cool\nideas we touched on at the end of\nyesterday's class is, there are data-driven\nthings that I",
    "start": "591260",
    "end": "597500"
  },
  {
    "text": "do when I'm given a data set\nto try and inform my decisions. And one of them is I take\nevery random variable,",
    "start": "597500",
    "end": "604760"
  },
  {
    "text": "and I see how much it covaries\nwith other random variables. So if one random variable tends\nto-- if for like a person,",
    "start": "604760",
    "end": "612540"
  },
  {
    "text": "they tend to be\nmore rocky, then how does that change my\nbelief in whether or not",
    "start": "612540",
    "end": "617900"
  },
  {
    "text": "they're into classical\nmusic, or dance music, or alternative folk music?",
    "start": "617900",
    "end": "624663"
  },
  {
    "text": "It would be great if\nwe had a statistic. And I do have a statistic\nthat I calculate for every pair of\nrandom variables.",
    "start": "624663",
    "end": "632560"
  },
  {
    "text": "That particular statistic\nthat we talked about lightly, I just want to finish\nthe conversation on, is called covariance.",
    "start": "632560",
    "end": "639070"
  },
  {
    "text": "And covariance measures\nfor two random variables. Like, let's say x-axis is how\nmuch somebody likes heavy metal",
    "start": "639070",
    "end": "646480"
  },
  {
    "text": "rock, and y-axis is how much\nsomebody likes, let's say, punk.",
    "start": "646480",
    "end": "651590"
  },
  {
    "text": "When people tend to\ndeviate from the mean in a positive\ndirection, so they're more likely to like heavy metal\nrock than the average person,",
    "start": "651590",
    "end": "658260"
  },
  {
    "text": "they're also more likely to like\nrock than the-- or sorry, punk than the average person.",
    "start": "658260",
    "end": "663900"
  },
  {
    "text": "So these two random\nvariables, when people deviate\nfrom the mean, they tend to deviate in\nthe same direction.",
    "start": "663900",
    "end": "669710"
  },
  {
    "text": "And we can measure that. We can quantify what\nwe want as this. It's like the expectation\nof the product",
    "start": "669710",
    "end": "676550"
  },
  {
    "text": "of the deviations of the\nmeans in both directions. And if you were to then rework\nthe mathematics of what this",
    "start": "676550",
    "end": "682400"
  },
  {
    "text": "is, you would get that it's\nequivalent statement to, take the expectation of the\nproduct of the random variables",
    "start": "682400",
    "end": "687410"
  },
  {
    "text": "minus the expectation of\none times the expectation of the other, something you\ncould calculate from data.",
    "start": "687410",
    "end": "694070"
  },
  {
    "text": "And this is a measure that\npeople use to try and suss out, are two random\nvariables related.",
    "start": "694070",
    "end": "699297"
  },
  {
    "text": "I want to talk about\nthis a little bit because it's just a cool concept\nand something that you're going to need later on. So it's a cool concept buried in\nthis idea of Bayesian networks.",
    "start": "699297",
    "end": "708199"
  },
  {
    "text": "Can I just tell you a little\nbit about this number? So there is this number\nyou can calculate for any two random variables.",
    "start": "708200",
    "end": "713490"
  },
  {
    "text": "And when I see a high\nvalue of that number, I think those two random\nvariables are very related.",
    "start": "713490",
    "end": "718880"
  },
  {
    "text": "When I see a very\nhigh negative value, I think that those two\nrandom variables are",
    "start": "718880",
    "end": "724890"
  },
  {
    "text": "related but in a negative way. So if you see one random\nvariable becoming high, you expect the other\nrandom variable to go low.",
    "start": "724890",
    "end": "732230"
  },
  {
    "text": "But when I see a 0, it turns out\nthere's a complicated analysis. I think that there's one\nof two things going on,",
    "start": "732230",
    "end": "739370"
  },
  {
    "text": "either they're not related or\ntheir relationship is somehow not captured by this number.",
    "start": "739370",
    "end": "745910"
  },
  {
    "text": "Can I give you an example of two\nvery related random variables whose relationship\nis not captured",
    "start": "745910",
    "end": "751610"
  },
  {
    "text": "by this measure of how much\ntwo random variables covary? OK, here it is. It's not-- there's not\na beautiful picture",
    "start": "751610",
    "end": "758300"
  },
  {
    "text": "to go with it, but\nit's a simple idea. Imagine I have a\nrandom variable that's negative 1, 0, or 1,\nequal probability,",
    "start": "758300",
    "end": "765030"
  },
  {
    "text": "so 1/3 chance of being\neach of those things. On its own, that's\nfine to think about.",
    "start": "765030",
    "end": "770210"
  },
  {
    "text": "And I'm going to have a\nsecond random variable, and it's so related to\nthe first random variable that if you tell me what X\nis, I will tell you what Y is.",
    "start": "770210",
    "end": "778370"
  },
  {
    "text": "If you chose X to be 0,\nthen Y is going to be 1.",
    "start": "778370",
    "end": "784580"
  },
  {
    "text": "If you chose X to be\nanything other than 0, Y is going to be 0. Are these two random\nvariables related?",
    "start": "784580",
    "end": "791509"
  },
  {
    "text": "Oh, yeah. One is defined in terms\nof the other one's value. So if you tell me X, your\nbelief in Y will really change.",
    "start": "791510",
    "end": "798350"
  },
  {
    "text": "In fact, you'll know what Y is. They're not independent at all.",
    "start": "798350",
    "end": "803780"
  },
  {
    "text": "But I just want to show you the\nlimitation of this measurement. So X is about 1/3 chance\nof being negative 1,",
    "start": "803780",
    "end": "810110"
  },
  {
    "text": "1/3 chance of being 0,\n1/3 chance of being 1. Y is going to be\ndetermined based on X.",
    "start": "810110",
    "end": "815690"
  },
  {
    "text": "And it turns out because as\nlong as X is 0, then Y is 1, there is a 1/3 chance that Y is\n1 and a 2/3 chance that it's 0.",
    "start": "815690",
    "end": "824030"
  },
  {
    "text": "What you have in front of you\nis the full joint probability table. If you were to calculate\nthe covariance,",
    "start": "824030",
    "end": "832490"
  },
  {
    "text": "you'd first get the expectation\nof X. Well, the expectation of X, you're going to\ntake each of these numbers",
    "start": "832490",
    "end": "838430"
  },
  {
    "text": "and weight it by its value. Good times, expectation review. Know how to do that by Tuesday. What if you wanted\nthe expectation of Y?",
    "start": "838430",
    "end": "844970"
  },
  {
    "text": "What a reasonable thing to want. Well, Y can take on\ntwo values, 0 and 1. And it takes on 0 with\nthe probability 2/3",
    "start": "844970",
    "end": "850190"
  },
  {
    "text": "and takes on 1 with\nprobability 1/3. So its expectation of 1/3. Not so bad.",
    "start": "850190",
    "end": "856250"
  },
  {
    "text": "Now, no matter what value X is--",
    "start": "856250",
    "end": "861730"
  },
  {
    "text": "or if X is 0, then Y\nis something nonzero. But if X is nonzero,\nthen Y is 0.",
    "start": "861730",
    "end": "866920"
  },
  {
    "text": "One of them will always be 0. So if you multiply X and Y,\nno matter what value X was,",
    "start": "866920",
    "end": "874360"
  },
  {
    "text": "that product will be 0. So in all cases, the\nproduct of X and Y is 0.",
    "start": "874360",
    "end": "879370"
  },
  {
    "text": "So the expectation\nof X and Y is 0. Now, if you want to calculate\nthis statistic we've",
    "start": "879370",
    "end": "885800"
  },
  {
    "text": "been talking about, this\nmeasure of covariance, it would be 0 minus 0 times\n1/3, which leaves you with 0.",
    "start": "885800",
    "end": "893769"
  },
  {
    "text": "So covariance,\nit's supposed to be a number which captures how\nmuch these two variables covary.",
    "start": "893770",
    "end": "899170"
  },
  {
    "text": "It's in the fricking name. And yet even though these things\nare very deterministically related, covariance\nends up being 0.",
    "start": "899170",
    "end": "906610"
  },
  {
    "text": "What's gone wrong here? Covariance is one\nnumber to capture",
    "start": "906610",
    "end": "912310"
  },
  {
    "text": "a very complicated concept. If you have very large values\nof covariance or very large",
    "start": "912310",
    "end": "917590"
  },
  {
    "text": "negative values,\nthat is meaningful. But covariances of 0 could\nmean one of two things, either there is no relationship\nor there is a relationship",
    "start": "917590",
    "end": "927639"
  },
  {
    "text": "but somehow the\ncovariance is washing out. And there's a very\nfancy proof that",
    "start": "927640",
    "end": "935200"
  },
  {
    "text": "shows that this is going\nto be 0 if there is somehow a very nonlinear\nrelationship, but that's",
    "start": "935200",
    "end": "941080"
  },
  {
    "text": "a little bit beyond\nthe point of CS109. The point of CS109\nis you need to know that there's this thing,\ncovariance, between two",
    "start": "941080",
    "end": "947260"
  },
  {
    "text": "random variables. I want you to\nthink about it when you want to construct\na Bayes net as a way to get information.",
    "start": "947260",
    "end": "952353"
  },
  {
    "text": "And I want you to be able\nto interpret those values. And I want you to know\nthat even though covariance",
    "start": "952353",
    "end": "957940"
  },
  {
    "text": "is a signal of relationship,\ncovariance of 0 could mean few things. It's not a proof that\nthey're independent.",
    "start": "957940",
    "end": "963695"
  },
  {
    "text": "Yes. Will the value of a covariance-- if you calculate the\ncovariance of two variables,",
    "start": "963695",
    "end": "969530"
  },
  {
    "text": "will the result always\nbe between 1 and minus 1? It will not be. What a good question. So that's the first\nproblem, is this one.",
    "start": "969530",
    "end": "975894"
  },
  {
    "text": "And the second\nproblem that we're going to talk about in a second\nis that it's not bounded. Covariance could be a\nlarge or small number.",
    "start": "975895",
    "end": "982490"
  },
  {
    "text": "So let me give you a\nconcrete example of that. Here is weight and\nheight for some people.",
    "start": "982490",
    "end": "989840"
  },
  {
    "text": "And you could calculate\nthe covariance, which says to what extent do\nthese two random variables vary",
    "start": "989840",
    "end": "995630"
  },
  {
    "text": "together. And you can get the\ncovariance formula. And you can calculate\neach of the terms.",
    "start": "995630",
    "end": "1001720"
  },
  {
    "text": "And then you can get\na covariance of 46. And you're like, does\n46 mean anything?",
    "start": "1001720",
    "end": "1007480"
  },
  {
    "text": "Is 46 large? It's smaller than, like, 2,000,\nbut it's bigger than, like, 5. I don't know.",
    "start": "1007480",
    "end": "1013010"
  },
  {
    "text": "Is this a meaningful number? And people thought\nabout this for a while. And they thought, OK,\neven though covariance",
    "start": "1013010",
    "end": "1018113"
  },
  {
    "text": "is semantically\nsomething we care about, people don't know how to\ninterpret these numbers. So come along a very\nfancy person who",
    "start": "1018113",
    "end": "1025180"
  },
  {
    "text": "came up with a very fancy idea. There is something called the\nCauchy-Schwarz inequality,",
    "start": "1025180",
    "end": "1031790"
  },
  {
    "text": "which the proof is beyond CS109,\nbut the conclusion is this. If you calculate the covariance\nof any two random variables,",
    "start": "1031790",
    "end": "1039789"
  },
  {
    "text": "it is always going to be less\nthan the standard deviation of one random\nvariable multiplied by the standard deviation of\nthe other random variable.",
    "start": "1039790",
    "end": "1047470"
  },
  {
    "text": "And it's also always\ngoing to be larger than the negative of that. It's not possible for them to\nbe bigger than this product.",
    "start": "1047470",
    "end": "1054880"
  },
  {
    "text": "Proving that's beyond class,\nbut the result of that is a different number\nthat you've heard about.",
    "start": "1054880",
    "end": "1061090"
  },
  {
    "text": "You've heard about this\nthing called a correlation. And the correlation is\njust a normalized version",
    "start": "1061090",
    "end": "1067280"
  },
  {
    "text": "of covariance. We take the covariance, and\nwe divide it by this number. Why this number?",
    "start": "1067280",
    "end": "1073130"
  },
  {
    "text": "Because we know\nthat the covariance will always be less\nthan this number. Why is that nice?",
    "start": "1073130",
    "end": "1078990"
  },
  {
    "text": "Correlation is a scaled\nversion of covariance, which is always between negative\n1 and 1, which is great.",
    "start": "1078990",
    "end": "1088460"
  },
  {
    "text": "If you go back to this plot, I\nactually used correlation here",
    "start": "1088460",
    "end": "1093956"
  },
  {
    "text": "instead of covariance\nbecause I wanted everything between negative\n1 and 1 so that everything was on the same scale.",
    "start": "1093957",
    "end": "1099930"
  },
  {
    "text": "So correlation is a scaled\nversion of covariance, and covariance is your\nmeasure of how much",
    "start": "1099930",
    "end": "1105470"
  },
  {
    "text": "two random variables\nrelate to each other. OK, and then since\nit's a Friday, I just have some\nrelaxing, chill,",
    "start": "1105470",
    "end": "1113210"
  },
  {
    "text": "let's laugh at correlations. So one problem I've talked\nabout for correlations",
    "start": "1113210",
    "end": "1118310"
  },
  {
    "text": "is, a correlation\nof 0 doesn't mean that two random\nvariables are actually",
    "start": "1118310",
    "end": "1124280"
  },
  {
    "text": "independent of each other. They could be very dependent. Just, their relationship\nisn't captured by this particular way of\ntalking about them deviating",
    "start": "1124280",
    "end": "1131540"
  },
  {
    "text": "from means together. But this is a little\nbit funny too. Sometimes things have\nhigh correlations,",
    "start": "1131540",
    "end": "1137000"
  },
  {
    "text": "but they're not at all related. So if you go into\ndata, people have mined for funny correlations.",
    "start": "1137000",
    "end": "1143330"
  },
  {
    "text": "And here's two\nrandom variables that just happen to correlate\nbut we think there might not be a deeper reason, rock music\nquality and US oil production.",
    "start": "1143330",
    "end": "1151059"
  },
  {
    "text": "So apparently, the 1960s\nwere like the golden age",
    "start": "1151060",
    "end": "1156150"
  },
  {
    "text": "of rock music, and\nthere was a whole bunch of US crude made between then. And this ends at 2007.",
    "start": "1156150",
    "end": "1162240"
  },
  {
    "text": "But we don't think that\noil is causing rock music, and we don't think that\nrock music is causing oil. I'll ask you why there\nmight be high correlations",
    "start": "1162240",
    "end": "1169830"
  },
  {
    "text": "for these things. So think about\nthat for a second. Two other things that\nhave high correlation",
    "start": "1169830",
    "end": "1175110"
  },
  {
    "text": "but maybe aren't that related,\nper capita consumption of cheese and number of\npeople who died by becoming",
    "start": "1175110",
    "end": "1181289"
  },
  {
    "text": "tangled up in their bedsheets. Unrelated, but they tend\nto have a high correlation.",
    "start": "1181290",
    "end": "1186870"
  },
  {
    "text": "Divorce rates and\nbutter consumption. Butter consumption is\ndown, so are divorce rates.",
    "start": "1186870",
    "end": "1192389"
  },
  {
    "text": "Is it a coincidence? Perhaps, perhaps not. Does anyone know why these\nthings that seem unrelated",
    "start": "1192390",
    "end": "1201960"
  },
  {
    "text": "might have high correlations? Yeah, in the back.",
    "start": "1201960",
    "end": "1207924"
  },
  {
    "text": "There may be something else\nthat's causing them directly. There could be something\nelse that's causing. That is possible. Turns out, for\nthese three, there",
    "start": "1207925",
    "end": "1214380"
  },
  {
    "text": "is a different\nmechanism going on. ",
    "start": "1214380",
    "end": "1223510"
  },
  {
    "text": "Sets of data-- you can\nfind relationships within. Yeah, if I took a\nrandom number generator",
    "start": "1223510",
    "end": "1230255"
  },
  {
    "text": "and a different random\nnumber generator and I generated a\ndata set from them, they're probably going\nto be uncorrelated",
    "start": "1230255",
    "end": "1236620"
  },
  {
    "text": "because they're all random. But if I repeated this\nprocess a billion times, two random number generators are\ngoing to produce two random--",
    "start": "1236620",
    "end": "1245620"
  },
  {
    "text": "a random set of data. And it will just happen to\nbe that they look correlated. If you look for enough\npairs of random variables,",
    "start": "1245620",
    "end": "1253360"
  },
  {
    "text": "even if they're all unrelated,\neventually, just by chance, you'll find two that happen\nto be high in this correlation",
    "start": "1253360",
    "end": "1259270"
  },
  {
    "text": "thing. So there's like-- we are fishing\nthrough too many data sets to find correlations. Anyways, that's\njust a fun aside.",
    "start": "1259270",
    "end": "1266950"
  },
  {
    "text": "But the real reason\nI brought it up is because when I\nlook at a big data set and I don't know\nhow to model, one",
    "start": "1266950",
    "end": "1273370"
  },
  {
    "text": "of the pro tips\nthat I would use is I calculate the correlation\nbetween every pair of random variable to\ntry and figure out which",
    "start": "1273370",
    "end": "1279580"
  },
  {
    "text": "ones are related to each other. So at this point in\nthe plot, could you",
    "start": "1279580",
    "end": "1287480"
  },
  {
    "text": "create a Bayesian network? Well, sure, there's\na few options. For the structure, you could\neither guess at causality",
    "start": "1287480",
    "end": "1293809"
  },
  {
    "text": "or you could calculate\ncorrelations and, again, try and artfully design\na nice Bayesian network.",
    "start": "1293810",
    "end": "1300590"
  },
  {
    "text": "You then need to give the\nprobability of every child given its parents. We'll talk about that in a bit. But at this point, sure,\nyou could create a Bayes net",
    "start": "1300590",
    "end": "1307400"
  },
  {
    "text": "if you needed to. Question. Is there a mathematical\nway to determine the direction of causality?",
    "start": "1307400",
    "end": "1314150"
  },
  {
    "text": "Is there a way to determine\nthe direction of causality? A little bit. Here's what's easy to do.",
    "start": "1314150",
    "end": "1319740"
  },
  {
    "text": "You can disprove causality or\nyou can have a high probability that there's not causality. It turns out it's very\nhard from historical data",
    "start": "1319740",
    "end": "1326750"
  },
  {
    "text": "to say there is causality. Maybe you've heard the\nthing like correlation",
    "start": "1326750",
    "end": "1331790"
  },
  {
    "text": "does not imply causation. It's very hard to\npull out causality, though it turns out\nsophisticated mathematics can",
    "start": "1331790",
    "end": "1337100"
  },
  {
    "text": "disprove different\ncausal relationships. Yes? Last time you talked about how\nthe flu might cause you to be",
    "start": "1337100",
    "end": "1344690"
  },
  {
    "text": "tired or might have you to-- how it's giving a lot of fevers. How does it work where\nit's like the opposite?",
    "start": "1344690",
    "end": "1351170"
  },
  {
    "text": "Like, something causes\nsomething not to happen. Does that work with\nwith the Bayes model? Yeah, you would\nstill use causality.",
    "start": "1351170",
    "end": "1356540"
  },
  {
    "text": "So if like, I don't know,\ntaking a vaccine will mean you're less\nlikely to have flu,",
    "start": "1356540",
    "end": "1362059"
  },
  {
    "text": "I would still call that\ncausal even though it's like a negative cause. It's still one is\nreally influencing the--",
    "start": "1362060",
    "end": "1368899"
  },
  {
    "text": "and creating the value\nof the other one. Good question.",
    "start": "1368900",
    "end": "1373920"
  },
  {
    "text": "But the real point\nof today's lesson is, let's say you have\na Bayesian network.",
    "start": "1373920",
    "end": "1378990"
  },
  {
    "text": "I want you guys to now be\nable to solve any probability question you might\nwant to ask about it.",
    "start": "1378990",
    "end": "1384440"
  },
  {
    "text": "One option is algebra. So by algebra, I mean like,\ntake this Bayesian network",
    "start": "1384440",
    "end": "1391130"
  },
  {
    "text": "and you can just calculate,\nusing pencil and paper or maybe a piece of Python, any\nprobability question.",
    "start": "1391130",
    "end": "1397190"
  },
  {
    "text": "We talked about this one, where\nyou could compute the joint just by calculating the\nprobability of things in order",
    "start": "1397190",
    "end": "1405230"
  },
  {
    "text": "from parent to child. So probability of\nflu times probability of undergraduate times\nprobability of fever given flu",
    "start": "1405230",
    "end": "1412100"
  },
  {
    "text": "equals 0, times the\nprobability that tired equals 1 given that undergrad\nequals 1 and flu equals 0,",
    "start": "1412100",
    "end": "1418490"
  },
  {
    "text": "if you multiply all\nthose things together, you can get the\nprobability of the joint. It's like the\nBayesian network is",
    "start": "1418490",
    "end": "1423765"
  },
  {
    "text": "hiding probabilities of joints. It's a way of representing\njoint probabilities. But if you want to do a\nconditional probability--",
    "start": "1423765",
    "end": "1430940"
  },
  {
    "text": "we talked about this last time-- you could still do it\nusing joint probabilities.",
    "start": "1430940",
    "end": "1437910"
  },
  {
    "text": "I mean, using joint\nprobabilities, you could know the probability\nof any particular combination to all random variables.",
    "start": "1437910",
    "end": "1444960"
  },
  {
    "text": "And because of this, you\ncould use the definition of conditional probability. This probability is\nequal to the probability",
    "start": "1444960",
    "end": "1450960"
  },
  {
    "text": "of everything divided by the\nprobability of the right hand side. But that probability\nof the right hand side,",
    "start": "1450960",
    "end": "1456940"
  },
  {
    "text": "you can get through\nmarginalization. You can take your\njoint, and you can think about the case\nof the right hand side,",
    "start": "1456940",
    "end": "1462539"
  },
  {
    "text": "these three, where flu equals 1,\nand the case of the right hand side where flu equals 0. Add those two things together.",
    "start": "1462540",
    "end": "1467850"
  },
  {
    "text": "You marginalize out\nflu, and you're just left with the probability\nof the right hand side. So that works.",
    "start": "1467850",
    "end": "1473430"
  },
  {
    "text": "It's one way to calculate it. But what about this probability? So I have a little\nchallenge for you",
    "start": "1473430",
    "end": "1479900"
  },
  {
    "text": "guys, chance for\nwarming up, chance to meet the person next to you. How would you calculate this\nconditional probability?",
    "start": "1479900",
    "end": "1487400"
  },
  {
    "text": "I've given you a Bayes\nnet, which means basically, I've given you a\nway to calculate the probability of a joint. Could you calculate\nthis probability?",
    "start": "1487400",
    "end": "1493790"
  },
  {
    "text": "And I'd encourage you to think,\nwell, I've got the joint. If I write this in terms\nof conditional probability,",
    "start": "1493790",
    "end": "1500120"
  },
  {
    "text": "could I use the fact\nthat I've got a joint to calculate each of the\nthings in my definition",
    "start": "1500120",
    "end": "1505125"
  },
  {
    "text": "of conditional\nprobability that I need? Can you go from a joint to a\nprobability of a assignment to fewer random variables?",
    "start": "1505125",
    "end": "1512930"
  },
  {
    "text": "Think about it. Talk to the person next to you. And then we're going to come\nup with something all together.",
    "start": "1512930",
    "end": "1518299"
  },
  {
    "start": "1518300",
    "end": "1528970"
  },
  {
    "text": "[SIDE CONVERSATION] ",
    "start": "1528970",
    "end": "1629300"
  },
  {
    "text": "OK, OK, let's talk together. Questions? Concerns? What's confusing about this?",
    "start": "1629300",
    "end": "1635730"
  },
  {
    "text": "I wrote the definition of\nconditional probability for the thing you're\nsupposed to calculate, and I want to remind you\nthat with a Bayesian network",
    "start": "1635730",
    "end": "1645380"
  },
  {
    "text": "or any probabilistic model\nfor many random variables, the first thing is to make\nsure you can calculate",
    "start": "1645380",
    "end": "1650667"
  },
  {
    "text": "the probability of a joint,\nwhich is, if you're thinking about it as a programmer, it's\nlike I'm giving you a function.",
    "start": "1650667",
    "end": "1656150"
  },
  {
    "text": "If you give me assignment to\nall four random variables, I've got a function\nwhich will give you the probability of\nthat joint assignment.",
    "start": "1656150",
    "end": "1663140"
  },
  {
    "text": "What I don't have is a\ncalculation for the probability of just two random variables.",
    "start": "1663140",
    "end": "1669310"
  },
  {
    "text": "So I've got this. I want these things. Is there a way to go\nfrom one to the other?",
    "start": "1669310",
    "end": "1675360"
  },
  {
    "text": " You could use law of\ntotal probability.",
    "start": "1675360",
    "end": "1682200"
  },
  {
    "text": "You could use law of\ntotal probability, yes. It has another name. It is the law of\ntotal probability,",
    "start": "1682200",
    "end": "1687270"
  },
  {
    "text": "but the law of total\nprobability has another name often when we're talking about\nmany random variables together. Does anyone remember\nwhat that other name is?",
    "start": "1687270",
    "end": "1694350"
  },
  {
    "text": "Marginalization. Marginalization. Law of total probability\nis the same thing. It's just law of total\nprobability applied to joints.",
    "start": "1694350",
    "end": "1700750"
  },
  {
    "text": "So if you use marginalization,\nit's a way to go from the fact that you've got a probability\nof many random variables",
    "start": "1700750",
    "end": "1707190"
  },
  {
    "text": "to calculate a probability\nwith fewer, where you just don't know if\nsomebody has got fever or you don't know\nif they've got flu.",
    "start": "1707190",
    "end": "1714450"
  },
  {
    "text": "So you know, again, if you want\nto know the probability of flu",
    "start": "1714450",
    "end": "1720769"
  },
  {
    "text": "and fever, you want to\nthink about all combinations of undergraduate and tired.",
    "start": "1720770",
    "end": "1726139"
  },
  {
    "text": "So one way of thinking\nabout this-- sorry, this",
    "start": "1726140",
    "end": "1731780"
  },
  {
    "text": "is for the top bit. So this is the one where\nyou just don't have fever. So for the top bit,\nit's like you're",
    "start": "1731780",
    "end": "1737180"
  },
  {
    "text": "going to add in fever equals\n1 with fever equals 2. And if you add those two\nprobabilities together,",
    "start": "1737180",
    "end": "1742700"
  },
  {
    "text": "you marginalize out fever. And you're just left with\nprobability of this, and this, and this.",
    "start": "1742700",
    "end": "1748040"
  },
  {
    "text": "Fantastic. For the bottom, we\nneed to marginalize out both flu and fever.",
    "start": "1748040",
    "end": "1755160"
  },
  {
    "text": "And so it's like you loop\nover all possible combinations of flu and fever. And for each of them, you\ncalculate the probability",
    "start": "1755160",
    "end": "1761610"
  },
  {
    "text": "of those things you're\nmarginalizing out with the probability\nof the things that you're holding constant. And then you can end up\nwith just the probability--",
    "start": "1761610",
    "end": "1769409"
  },
  {
    "text": " oh, of undergraduate and tired. Yes, you're left\nwith just probably",
    "start": "1769410",
    "end": "1775490"
  },
  {
    "text": "of undergraduate equals\n1 and tired equals 1. Marginalization allows you\nto go from knowing probably of many random variables\nto knowing the probability",
    "start": "1775490",
    "end": "1782120"
  },
  {
    "text": "of fewer of them. Yes. How do you determine what\nneeds to be marginalized out",
    "start": "1782120",
    "end": "1787320"
  },
  {
    "text": "and how do you-- what does it mean to\nmarginalize something out? OK, so I want this.",
    "start": "1787320",
    "end": "1792600"
  },
  {
    "text": "I want U and T. What I've got\nis U, and T, and the two Fs.",
    "start": "1792600",
    "end": "1799000"
  },
  {
    "text": "So I know I need to\nmarginalize out the two Fs. And to marginalize out, I\njust sum over assignments",
    "start": "1799000",
    "end": "1806230"
  },
  {
    "text": "to the two Fs. So I'm going to call\nX my assignment to flu and Y my assignment to fever. So you have to sum over\nthe ones you don't want.",
    "start": "1806230",
    "end": "1814059"
  },
  {
    "text": "Take the joint, sum over\nthe ones you don't want, and you're good. If you did this,\nif you did this,",
    "start": "1814060",
    "end": "1821640"
  },
  {
    "text": "then you would end up\nwith the probability that somebody has a flu\ngiven these two assignments.",
    "start": "1821640",
    "end": "1827200"
  },
  {
    "text": "This is great, and you can\ndefinitely calculate this, but it does get a\nlittle bit complicated.",
    "start": "1827200",
    "end": "1833610"
  },
  {
    "text": "It can become really hard. If you had thousands\nof random variables and you only\nobserved two, you're",
    "start": "1833610",
    "end": "1841030"
  },
  {
    "text": "going to have to marginalize\nout every unobserved random variable. And think about WebMD. You could have\npain in your toes.",
    "start": "1841030",
    "end": "1847550"
  },
  {
    "text": "You could have a headache. You could have a stomachache. Maybe you just feel a little\nbit tired today, or funny.",
    "start": "1847550",
    "end": "1853180"
  },
  {
    "text": "There's thousands\nof random variables, and we have to\nmarginalize them all out. Hey, sorry, you guys.",
    "start": "1853180",
    "end": "1858519"
  },
  {
    "text": "OK, and so if you have\ntoo many random variables, you have to marginalize\nthem all out. This calculation is going\nto become really, really",
    "start": "1858520",
    "end": "1866080"
  },
  {
    "text": "expensive. Darn it. We were doing so well. We want to be able\nto do inference",
    "start": "1866080",
    "end": "1871467"
  },
  {
    "text": "and we want to be able to\ndo it in a scalable way, but right now, even though\nwe've got a mathematical way of doing inference, it's\nnot going to help us",
    "start": "1871467",
    "end": "1877730"
  },
  {
    "text": "as computer scientists. We need to think of another way. And the beauty of the way\nI'm going to teach you--",
    "start": "1877730",
    "end": "1883610"
  },
  {
    "text": "I will teach you a more general\nway that is very powerful, but it also covers so many\nintuitions about probability.",
    "start": "1883610",
    "end": "1891000"
  },
  {
    "text": "So if you can follow\nalong, not only are you going to learn an\namazing randomized algorithm that will teach you how to\ndo inference for any Bayesian",
    "start": "1891000",
    "end": "1897290"
  },
  {
    "text": "network, or any probabilistic\nmodel, for that matter, it's also going to just teach\nus some good, hearty probability",
    "start": "1897290",
    "end": "1905150"
  },
  {
    "text": "along the way. The very simple idea is we're\ngoing to have this thing called rejection sampling.",
    "start": "1905150",
    "end": "1911259"
  },
  {
    "text": "Step 0, you have to\ndefine a Bayesian network, and you have to\ndefine it in code.",
    "start": "1911260",
    "end": "1917770"
  },
  {
    "text": "To define a Bayesian\nnetwork in code, you basically need to write\nall of these probabilities, and you have to write\na function which",
    "start": "1917770",
    "end": "1923523"
  },
  {
    "text": "can generate a\nsample of the joint or calculate the\nprobability of a joint. ",
    "start": "1923523",
    "end": "1930230"
  },
  {
    "text": "The steps are going to be-- maybe you're going to get an\nobservation from the user.",
    "start": "1930230",
    "end": "1937150"
  },
  {
    "text": "So the user is going to tell\nyou, I observe undergraduate and I observe that\nsomebody is tired. There is no algorithm here.",
    "start": "1937150",
    "end": "1943290"
  },
  {
    "text": "This is just the\nuser telling you the puzzle you have to solve. And now we're going\nto try and figure out",
    "start": "1943290",
    "end": "1949170"
  },
  {
    "text": "the probability of the flu\ngiven their observation. And there's a two-step process.",
    "start": "1949170",
    "end": "1955390"
  },
  {
    "text": "And it's so\nstraightforward, you guys could have invented\nrejection sampling yourself.",
    "start": "1955390",
    "end": "1960650"
  },
  {
    "text": "The straightforward way is,\ncan you generate me a whole-- billions and billions of\nfake samples from your joint?",
    "start": "1960650",
    "end": "1969679"
  },
  {
    "text": "And we're going to put\nthat into a big data set. So give me a billion fake\nexamples from your joint.",
    "start": "1969680",
    "end": "1976220"
  },
  {
    "text": "And then to calculate\nany probability, I'm just going to\nresort to counting. And so it's got like a little\nbit from every part of class.",
    "start": "1976220",
    "end": "1983660"
  },
  {
    "text": "You've got a bit from\nthe probabilistic models part of class. You've got a bit from the\nfoundation part of class",
    "start": "1983660",
    "end": "1989240"
  },
  {
    "text": "and a little bit of counting\nfrom the beginning of class. And through all of\nthis, you're going to be able to do\nthe inference task",
    "start": "1989240",
    "end": "1994940"
  },
  {
    "text": "for any probabilistic model. It's going to be\nthat straightforward. Are you guys ready for it?",
    "start": "1994940",
    "end": "2000980"
  },
  {
    "text": "You should have two questions. Your first question should\nbe, how do I sample a ton?",
    "start": "2000980",
    "end": "2006149"
  },
  {
    "text": "And the second question\nshould be, how would I do counting if I've got samples\nto answer any probability question?",
    "start": "2006150",
    "end": "2012600"
  },
  {
    "text": "Shall we jump into the first\none, how do we sample a ton? It's this easy. If you want to sample a\nton, you loop many times,",
    "start": "2012600",
    "end": "2020190"
  },
  {
    "text": "and make one sample, and\nadd that to your list. You're like, oh, Chris, that's\na very satisfying answer--",
    "start": "2020190",
    "end": "2025680"
  },
  {
    "text": "says nobody. Why is this not a\nsatisfying answer? It's like, OK, sampling a\nton obviously requires you",
    "start": "2025680",
    "end": "2033570"
  },
  {
    "text": "to be able to create samples. What I really want to understand\nis, how do you create a sample?",
    "start": "2033570",
    "end": "2040050"
  },
  {
    "text": "Creating a sample\nmeans I'm just going to generate one fake person. And this fake person, we're\ngoing to observe everything",
    "start": "2040050",
    "end": "2047190"
  },
  {
    "text": "about them. We'll know if they have the flu. We'll know if\nthey're undergrads. We're going to know\nif they have fever. It'll know if they're tired.",
    "start": "2047190",
    "end": "2053136"
  },
  {
    "text": "In fact, we did this a little\nbit on Wednesday's class. I showed you a\nfunction like this. And this function\nmade me a fake person",
    "start": "2053136",
    "end": "2060960"
  },
  {
    "text": "where you observe\neverything about them. You observe if they have the\nflu, an undergraduate, fever, or tired-- not that they have\nan undergraduate, whether they",
    "start": "2060960",
    "end": "2068100"
  },
  {
    "text": "are an undergraduate. If you run this, it\ngives you one person.",
    "start": "2068100",
    "end": "2073460"
  },
  {
    "text": "And it turns out, that\nperson's probability of having this\nparticular assignment comes straight from the joint.",
    "start": "2073460",
    "end": "2079710"
  },
  {
    "text": "If you run this 10 times,\nyou'll get 10 people, where you'll observe everything.",
    "start": "2079710",
    "end": "2085070"
  },
  {
    "text": "If you run this\n100,000 times, you'll get a whole 100,000 fake people.",
    "start": "2085070",
    "end": "2090290"
  },
  {
    "text": "If you look at any\nparticular assignment-- like, they have a flu, they\nare an undergraduate, they have a fever, and\nthey are tired, like,",
    "start": "2090290",
    "end": "2096770"
  },
  {
    "text": "ones to everything-- the probability of\nseeing 1, 1, 1, 1",
    "start": "2096770",
    "end": "2102670"
  },
  {
    "text": "will be the true\nprobability according to the Bayesian network. If you generate 100,000-- let's\nsay the probability of getting",
    "start": "2102670",
    "end": "2108673"
  },
  {
    "text": "a 1, 1, 1, 1 is truly 10%, if\nyou generate 100,000 of these,",
    "start": "2108673",
    "end": "2113740"
  },
  {
    "text": "you would expect to see 10,000\npeople with a 1, 1, 1, 1.",
    "start": "2113740",
    "end": "2118780"
  },
  {
    "text": "Sampling is such a\nnice, intuitive idea. It sometimes weird\nto think about. But do you guys know, in\nproblem set two, where",
    "start": "2118780",
    "end": "2125560"
  },
  {
    "text": "you guys had to write\na function which would sample from a Poisson-- like, you'd run the Poisson\nfunction, you pass in a lambda,",
    "start": "2125560",
    "end": "2131140"
  },
  {
    "text": "and it'd give you back a number? That's a sample. And then you wrote the\nexponential function.",
    "start": "2131140",
    "end": "2136370"
  },
  {
    "text": "And you would run it, and it\nwould give you back a number every time you ran it. That's a sample. This is just a joint sample.",
    "start": "2136370",
    "end": "2141855"
  },
  {
    "text": "Instead of giving\nyou one number, it's giving you a number\nfor every random variable. OK, this is half\nof the algorithm.",
    "start": "2141855",
    "end": "2148130"
  },
  {
    "text": "So maybe you have questions. It would be great if\nyou had questions. I would love to talk about it. Yes. How do we guarantee that\nthat probability in the end",
    "start": "2148130",
    "end": "2155410"
  },
  {
    "text": "is sampled from the joint? I guarantee you that it's\nsampled from your Bayesian network.",
    "start": "2155410",
    "end": "2161320"
  },
  {
    "text": "And if your Bayesian\nnetwork is any good, this will be a really\ngood representation of the real world.",
    "start": "2161320",
    "end": "2166390"
  },
  {
    "text": "If your Bayesian\nnetwork is totally made up and completely useless,\nthen so will these samples be.",
    "start": "2166390",
    "end": "2171580"
  },
  {
    "text": "So if your Bayesian\nnetwork is good, these samples will be good. But they perfectly\nrepresent the network.",
    "start": "2171580",
    "end": "2177410"
  },
  {
    "text": "Yeah, question? How is BERN implemented? Oh, BERN. I get a probability\nuniformly between 0 and 1.",
    "start": "2177410",
    "end": "2185920"
  },
  {
    "text": "And so maybe when you pull\na number between 0 and 1, you get like a 0.892.",
    "start": "2185920",
    "end": "2191870"
  },
  {
    "text": "And if that number is\nless than the parameter,",
    "start": "2191870",
    "end": "2197480"
  },
  {
    "text": "then I return back a 1. Otherwise, I return back a 0. Yeah, lots of good\nways to implement it.",
    "start": "2197480",
    "end": "2202890"
  },
  {
    "text": "Yeah, question? How wrong your\nsampling be if you",
    "start": "2202890",
    "end": "2209035"
  },
  {
    "text": "had-- the arrows\nin your Bayesian were flipped, like if\nyou had the children as the causal parents?",
    "start": "2209035",
    "end": "2215210"
  },
  {
    "text": "Good question. You know, it's hard to quantify. What I'll tell you this is,\nif I were to try this out,",
    "start": "2215210",
    "end": "2221990"
  },
  {
    "text": "I might do something like\nhave a few Bayesian networks. And maybe I'd have some people\nfor whom I know whether or not",
    "start": "2221990",
    "end": "2228440"
  },
  {
    "text": "they had the fever. And I would try seeing\nwhich Bayesian network is leading to the most\naccurate predictions.",
    "start": "2228440",
    "end": "2233990"
  },
  {
    "text": "But otherwise, if you flip\nthe arrows, you'd be wrong. It'd be so hard to come\nup with the probabilities.",
    "start": "2233990",
    "end": "2240049"
  },
  {
    "text": "Like, the probability of\nbeing an undergraduate given you have a fever seems\nlike a harder probability",
    "start": "2240050",
    "end": "2247010"
  },
  {
    "text": "to come up with. But if you did it\nand if you came up",
    "start": "2247010",
    "end": "2252310"
  },
  {
    "text": "with reasonable\nprobabilities, you would still get a\nreasonable answer. Have you guys heard this\nsaying, \"All models are wrong,",
    "start": "2252310",
    "end": "2258650"
  },
  {
    "text": "but some models are useful?\" Turns out, the more\nrealistic your model looks, the better your answers will be.",
    "start": "2258650",
    "end": "2263860"
  },
  {
    "text": "But even if you're\na little bit wrong, you'll probably get\npretty good answers. I think that I'm just so\nconfused because like, back",
    "start": "2263860",
    "end": "2270480"
  },
  {
    "text": "to the covariance thing,\nsince we can't tell determine causation from covariance,\nhow does it actually",
    "start": "2270480",
    "end": "2279480"
  },
  {
    "text": "help us create our network? I mean, it's an art form. Creating a network\nis an art form.",
    "start": "2279480",
    "end": "2285008"
  },
  {
    "text": "It turns out there is\nthis algorithm called structure learning, which you'll\nlearn about in CS228, where you can just learn the whole\nthing purely from data",
    "start": "2285008",
    "end": "2291630"
  },
  {
    "text": "and you try and do things like\nlearn different causal patterns which can't be there. There are algorithms\nfor that, but I'd",
    "start": "2291630",
    "end": "2298020"
  },
  {
    "text": "say most people making Bayesian\nnetworks, it's art, and love, and dedication, and data. So they'll look at\nthe correlations.",
    "start": "2298020",
    "end": "2304243"
  },
  {
    "text": "They'll come up with\ntheir understanding of how the world works. They will artfully create\na Bayesian network. And then they'll\nprobably test it.",
    "start": "2304243",
    "end": "2310320"
  },
  {
    "text": "Maybe they make a few\nBayesian networks, and they'll test them,\nsee which ones come up with the best predictions. It's a good question, and the\nreal answer is art and craft.",
    "start": "2310320",
    "end": "2319350"
  },
  {
    "text": "But you need it because\nif you don't do it, you're stuck in something\nwhere you can't even compute. Yes?",
    "start": "2319350",
    "end": "2325020"
  },
  {
    "text": "Just to summarize, you basically\nrandomly generate people from your probability model.",
    "start": "2325020",
    "end": "2330660"
  },
  {
    "text": "And then you see if any\nof those people can exist? Oh, yeah, now you're\ngetting into my second step.",
    "start": "2330660",
    "end": "2337320"
  },
  {
    "text": "All I've done so far is\nmake a bunch of fake people. But the important thing\nabout the fake people is that for every fake person, I\ncan see all of their variables.",
    "start": "2337320",
    "end": "2344730"
  },
  {
    "text": "How many fake people-- Hey, how big is your computer? I'd say 100,000 will\njust take you a second.",
    "start": "2344730",
    "end": "2351880"
  },
  {
    "text": "But if you wanted, if it\nwas like life or death, then maybe you'd want\nto do like 200,000. I'm kidding.",
    "start": "2351880",
    "end": "2356910"
  },
  {
    "text": "Choice is yours. There is a formal way to think\nabout how many you'd need, and we'll talk about that later.",
    "start": "2356910",
    "end": "2362839"
  },
  {
    "text": "But basically, just recall, if\nyou're making a fake person, start with choosing the\nvalues of the parents of the node, the network.",
    "start": "2362840",
    "end": "2368470"
  },
  {
    "text": "And then you choose\nthe children. Like, flu is dependent on\nwhether or not-- sorry, fever is dependent on\nwhether or not you had a flu.",
    "start": "2368470",
    "end": "2374840"
  },
  {
    "text": "So you want to choose flu first. And tired is dependent on\nwhether you're an undergraduate and flu.",
    "start": "2374840",
    "end": "2379880"
  },
  {
    "text": "So you want to make\nsure you choose tired after you choose those\ntwo random variables. And after this, you've sampled.",
    "start": "2379880",
    "end": "2386320"
  },
  {
    "text": "I have explained to you half\nof this beautiful randomized algorithm. Do you guys want to\nhear the other half?",
    "start": "2386320",
    "end": "2391690"
  },
  {
    "text": "The other half is\ncalled rejecting. And that's why it gets its\nname, rejection sampling.",
    "start": "2391690",
    "end": "2397030"
  },
  {
    "text": "But just to be clear, after I\ncall this part of the function, I'll get a whole\nbunch of fake people. And then in this fake\ndata set, this was flu,",
    "start": "2397030",
    "end": "2405280"
  },
  {
    "text": "this was undergraduate, this\nwas fever, and this was tired. Everyone's tired.",
    "start": "2405280",
    "end": "2411250"
  },
  {
    "text": "The second half is simply\nrejecting and counting.",
    "start": "2411250",
    "end": "2416390"
  },
  {
    "text": "The simple idea is, if you\nwant to figure out, say, the probability of\nsomebody having a fever",
    "start": "2416390",
    "end": "2422420"
  },
  {
    "text": "given they're an\nundergraduate and tired, you're going to go through all\nof your 100,000 fake people,",
    "start": "2422420",
    "end": "2428960"
  },
  {
    "text": "and you're going to throw\naway every data point that's not consistent with\nthese observations.",
    "start": "2428960",
    "end": "2434359"
  },
  {
    "text": "Recall, when we taught\nyou conditioning, what were the semantics\nof a conditioning? You enter the world where\nthese two things are true.",
    "start": "2434360",
    "end": "2441500"
  },
  {
    "text": "With your data\nset, you can enter the world where undergraduate\nis true and tired is true.",
    "start": "2441500",
    "end": "2447330"
  },
  {
    "text": "And you can do that\nby only looking at the samples that are\nconsistent with those two things.",
    "start": "2447330",
    "end": "2452670"
  },
  {
    "text": "So you take your\n100,000, you throw out all the grad students, you\nthrow out all the professors, you throw out all the\nbabies-- but you know,",
    "start": "2452670",
    "end": "2458540"
  },
  {
    "text": "I just mean from your data\nset-- and you throw out everyone who is not tired. And you're just left all the\nundergraduates who are tired.",
    "start": "2458540",
    "end": "2465160"
  },
  {
    "text": "That's the first step. So you can call it\nrejecting, or you can call it keeping the\nones that are consistent.",
    "start": "2465160",
    "end": "2470450"
  },
  {
    "text": "So I'm going to just\nloop over every sample, and I'm only going to\nkeep the ones that are",
    "start": "2470450",
    "end": "2476740"
  },
  {
    "text": "consistent with my observation. So for every sample, I'll\nsee, are you an undergraduate and are you tired?",
    "start": "2476740",
    "end": "2481940"
  },
  {
    "text": "And if so, I'm just going\nto keep that sample. After this step, kept\nsamples will be strictly",
    "start": "2481940",
    "end": "2487180"
  },
  {
    "text": "smaller than 100,000. Well, it will be\n100,000 or smaller.",
    "start": "2487180",
    "end": "2493080"
  },
  {
    "text": "Now you've got a small subset\nof data of all the people who are consistent with\nundergraduate and tired.",
    "start": "2493080",
    "end": "2499620"
  },
  {
    "text": "And your simple next step is,\nfrom that smaller data set,",
    "start": "2499620",
    "end": "2505400"
  },
  {
    "text": "count how many people\nhave the fever. So if you have, let's say,\n30,000 people in your fake data",
    "start": "2505400",
    "end": "2514869"
  },
  {
    "text": "set who are\nundergraduates and tired, you're just going to figure out\nthe ratio of how many of those have fevers.",
    "start": "2514870",
    "end": "2520180"
  },
  {
    "text": "So if 10,000 of those\npeople have fevers, then the probability of fever\nequaling 1 given undergraduate",
    "start": "2520180",
    "end": "2528700"
  },
  {
    "text": "equals 1 and tired equals 1\nis just going to be equal-- approximately equal\nto this ratio.",
    "start": "2528700",
    "end": "2536839"
  },
  {
    "text": "And I'm done. And you've calculated\nconditional probability. And the beautiful\nthing about this",
    "start": "2536840",
    "end": "2542540"
  },
  {
    "text": "is you can change\nyour observation. You could possibly even keep\nthe 100,000 fake people.",
    "start": "2542540",
    "end": "2547700"
  },
  {
    "text": "And you can calculate any\nconditional probability you want for any network.",
    "start": "2547700",
    "end": "2553690"
  },
  {
    "text": "Cool or what? Do you guys want to see\nthis thing in action? OK, let's do this. No more slides.",
    "start": "2553690",
    "end": "2559410"
  },
  {
    "text": "Take me to the code. So here I have the same program.",
    "start": "2559410",
    "end": "2564770"
  },
  {
    "text": "It's just now I use underscores\ninstead of camel case. I fought that hard. When I switched to Python,\nI still did camel case.",
    "start": "2564770",
    "end": "2571490"
  },
  {
    "text": "Everyone else did\nunderscores, snake case. I fought it hard, but\nI've finally come around, and I've drunk the Kool-Aid,\nand I'm one of the kids who does",
    "start": "2571490",
    "end": "2579260"
  },
  {
    "text": "underscores now. Not important. What is important is\nrejection sampling. It's a cool algorithm. How is this related\nto the rejection",
    "start": "2579260",
    "end": "2585680"
  },
  {
    "text": "sampling of simulating\na continuous PDF from a different PDF? Wait, wait, wait. We'll talk about\ncontinuous in a hot second.",
    "start": "2585680",
    "end": "2591980"
  },
  {
    "text": "Good question, though. I want to first just show you\nguys this thing in action.",
    "start": "2591980",
    "end": "2597381"
  },
  {
    "text": "So I'm going to run it. It's called Joint Sample. You know, when I\nfirst taught this, I didn't want to call\nit Rejection Sample.",
    "start": "2597382",
    "end": "2602809"
  },
  {
    "text": "Doesn't that sound so mean? Like, I don't like\nto reject people. That's not what I'm about. I'm about solving\ninference tasks,",
    "start": "2602810",
    "end": "2608030"
  },
  {
    "text": "but I don't want to\ndo any rejection. So I called it joint sampling. But then I realized that's\nnot what people in literature call it. So now you know.",
    "start": "2608030",
    "end": "2614320"
  },
  {
    "text": "Here's the simple thing. I get an observation\nfrom the user.",
    "start": "2614320",
    "end": "2620170"
  },
  {
    "text": "And right now, I\njust hard coded that. So I said my observation is\nthat somebody has a fever",
    "start": "2620170",
    "end": "2625260"
  },
  {
    "text": "and they're an undergraduate. But I don't know\nif they're tired, and I don't know\nif they have flu.",
    "start": "2625260",
    "end": "2630660"
  },
  {
    "text": "If I want to say I observe\nthat they aren't tired, then I would make this false.",
    "start": "2630660",
    "end": "2636210"
  },
  {
    "text": "But if I put None, it just means\nI don't observe whether or not they're tired. Do you guys want to\ngive me an observation?",
    "start": "2636210",
    "end": "2642510"
  },
  {
    "text": "We're trying to predict\nif somebody has the flu. So we want to keep\nthat one None. OK, this person, do\nthey have a fever?",
    "start": "2642510",
    "end": "2647970"
  },
  {
    "text": "Let's just yell\nit, and I'll just go with what the mass says. Do they have a fever? Yes. Oh, poor them.",
    "start": "2647970",
    "end": "2653850"
  },
  {
    "text": "OK, are they an undergraduate? No. Oh. Are they tired?",
    "start": "2653850",
    "end": "2659720"
  },
  {
    "text": "Yes. [LAUGHS] Well, that's\nincredibly consistent. OK, we have somebody who\nis not an undergraduate,",
    "start": "2659720",
    "end": "2668098"
  },
  {
    "text": "but they are tired, and we want\nto know if they have a fever. So we're just going\nto sample a ton.",
    "start": "2668098",
    "end": "2673339"
  },
  {
    "text": "We're going to throw\nout every sample that's not consistent with\nour observation, and we'll figure\nout the probability that they have a flu.",
    "start": "2673340",
    "end": "2679610"
  },
  {
    "text": "In this case, it\nsays these people-- this person, 95%\nchance definitely has a flu, according to\nyour Bayesian network.",
    "start": "2679610",
    "end": "2687320"
  },
  {
    "text": "Now, you could try\na different one. I just want to give\nus one other example. I'm going to show us having\nno observation for tired.",
    "start": "2687320",
    "end": "2694505"
  },
  {
    "text": "And in fact, actually,\nshould we do this one? Should we do undergraduate\nequals 1 and tired equals 1, but you don't know\nif they have a fever?",
    "start": "2694505",
    "end": "2700560"
  },
  {
    "text": "OK, undergraduate\nequals 1, true. We don't know if\nthey have a fever,",
    "start": "2700560",
    "end": "2705720"
  },
  {
    "text": "but we know that they are tired. So here None means you don't\nknow, and True means you know",
    "start": "2705720",
    "end": "2712745"
  },
  {
    "text": "and it's a 1. OK, undergraduates\nwho are tired, how many of them have the flu?",
    "start": "2712745",
    "end": "2717870"
  },
  {
    "text": "So you're just like, I'm tired. You probably don't have the flu. Now, if you tell me you\ndon't have a fever--",
    "start": "2717870",
    "end": "2725040"
  },
  {
    "text": "so now you're saying,\nI'm tired and I know I don't have a fever-- I kind of expect\nthat probability to go down because now you've\njust told me more information.",
    "start": "2725040",
    "end": "2732590"
  },
  {
    "text": "Yeah, you tell me you\ndefinitely don't have a fever. I'm like, yeah, it's\nprobably just tired.",
    "start": "2732590",
    "end": "2737809"
  },
  {
    "text": "Could be the flu, 1%\nchance it's the flu. But you're probably just tired. Yes?",
    "start": "2737810",
    "end": "2743142"
  },
  {
    "text": "How is this different\nfrom what we were doing on the first\nP set when we were trying to figure out the genes, that\nthey were causing the traits",
    "start": "2743143",
    "end": "2749480"
  },
  {
    "text": "or not? I feel like it was\nthe same process. Yeah, when you were\ntrying to figure out for the genes, if\nthey were causing",
    "start": "2749480",
    "end": "2755450"
  },
  {
    "text": "the trait, what you\nguys were looking for were independencies. You know what you guys\nwere secretly doing? You were secretly trying to find\nthe structure of the Bayesian",
    "start": "2755450",
    "end": "2763859"
  },
  {
    "text": "network. You weren't\nnecessarily calculating the conditional\nprobabilities that you would need to pull out a sample.",
    "start": "2763860",
    "end": "2769650"
  },
  {
    "text": "Like, it would be hard\nfor you guys to sample one row of that data set. But once you have the\ndata set, then yeah,",
    "start": "2769650",
    "end": "2775530"
  },
  {
    "text": "the conditional probabilities\nwere just counting. Like, the second step of this,\nyou use the exact same thing for the bat data set.",
    "start": "2775530",
    "end": "2781090"
  },
  {
    "text": "So the first step of\nbat was just really about creating a Bayes\nnet, and the second step was about doing the second\nhalf of rejection sampling.",
    "start": "2781090",
    "end": "2787230"
  },
  {
    "text": "You already had a real data set. You didn't have to simulate it. Yes? Do these different traits\nhave to be independent?",
    "start": "2787230",
    "end": "2794400"
  },
  {
    "text": "Like, do you ever integrate with\nlike conditional probabilities? Oh, these things are very\nmuch not independent.",
    "start": "2794400",
    "end": "2799483"
  },
  {
    "text": "There's a whole\nBayesian network that is to explain their relationship. So if you're undergraduate, that\nvery much changes our belief",
    "start": "2799483",
    "end": "2805200"
  },
  {
    "text": "that you're tired. If you have a flu, that\nvery much changes our belief that you've got a fever.",
    "start": "2805200",
    "end": "2811078"
  },
  {
    "text": "So you have a lot of things\nthat are very much related. So how does it-- making\nthe joint table work if it's like-- if they\nhave different conditional",
    "start": "2811078",
    "end": "2817560"
  },
  {
    "text": "probabilities, that effect? The conditional probabilities\nare encoded here. Let me show you where\nthey're encoded.",
    "start": "2817560",
    "end": "2823710"
  },
  {
    "text": "There is a part where\nyou have to sample. Where's my sample?",
    "start": "2823710",
    "end": "2828870"
  },
  {
    "text": "There's my sample. Aw, hi, sample. So there's a part of your\ncode where you sample.",
    "start": "2828870",
    "end": "2837330"
  },
  {
    "text": "And this is where all\nthe probabilities lie. I'm saying the chance that\nyou have a flu and the chance that you have undergraduate,\nthe chance that you have",
    "start": "2837330",
    "end": "2843800"
  },
  {
    "text": "a fever given you have a\nflu, the chance that you have a fever given you don't have a\nflu, the chance that you have--",
    "start": "2843800",
    "end": "2849050"
  },
  {
    "text": "that you're tired given\nthis particular setting of probabilities. I've defined all these\nconditional probabilities.",
    "start": "2849050",
    "end": "2854720"
  },
  {
    "text": "I've put them into\nPython, and I've put them into Python in a way\nthat I can create one sample. These conditional probabilities\nare true for everyone.",
    "start": "2854720",
    "end": "2861980"
  },
  {
    "text": "The model is universal. But if you have a\nparticular human being, they might show\nup, and you might",
    "start": "2861980",
    "end": "2867890"
  },
  {
    "text": "want to do a query\nbased on some traits. The model is universal. The query is for\nparticular individuals.",
    "start": "2867890",
    "end": "2874130"
  },
  {
    "text": "But the conditional\nprobabilities in the model, they'll be for everybody.",
    "start": "2874130",
    "end": "2879180"
  },
  {
    "text": "Good question. Yes? I just want to summarize\nto make sure I know what's happening in this code. So what you're\nsaying is that we're",
    "start": "2879180",
    "end": "2884970"
  },
  {
    "text": "going to take out\nall the samples that don't meet the initial\nconditions that we set? Well, that's the second part. This is the first part,\nwhich is generating a ton.",
    "start": "2884970",
    "end": "2891329"
  },
  {
    "text": "Do you guys want to\nsee the rejection part? Yes. OK, here. So we take out, for\nexample, everything",
    "start": "2891330",
    "end": "2897790"
  },
  {
    "text": "that is not undergraduate\nequals 1 and tired equals 1. Perfect. And from that, that's\nthe denominator.",
    "start": "2897790",
    "end": "2903970"
  },
  {
    "text": "And the top is\nfrom those samples. We go through and see\nwhat samples have the flu, equals 1, and then that\nwill bring it there?",
    "start": "2903970",
    "end": "2910450"
  },
  {
    "text": "Yeah, so I just go\nthrough all the samples, and I count how many\npeople have the flu. And then I just return--",
    "start": "2910450",
    "end": "2915880"
  },
  {
    "text": "well, I didn't need to do float,\nbut you know, so it goes-- how many people\nhad the flu divided",
    "start": "2915880",
    "end": "2921910"
  },
  {
    "text": "by how many samples I kept. You got it exactly right. OK, full rejection sampling.",
    "start": "2921910",
    "end": "2931030"
  },
  {
    "text": "Doo-doo-doo-doo. I imagine there's probably\nquestions at this point, though. So I really appreciate them.",
    "start": "2931030",
    "end": "2936867"
  },
  {
    "text": "But it really comes down to,\nget the query from the user. This algorithm will handle\nany query for this model.",
    "start": "2936867",
    "end": "2944430"
  },
  {
    "text": "Then we're going\nto sample a ton. And then we're\ngoing to calculate our conditional probability\njust by rejecting and counting.",
    "start": "2944430",
    "end": "2951160"
  },
  {
    "text": "And then you can solve\nany probability query you have for this particular model.",
    "start": "2951160",
    "end": "2956319"
  },
  {
    "text": "And the real challenge\nwasn't the rejection part. The real challenge is only,\ncan you write the sample.",
    "start": "2956320",
    "end": "2963369"
  },
  {
    "text": "And so if you have\na Bayesian network and you can write\nthis function, which does the sample from\nthe Bayesian network,",
    "start": "2963370",
    "end": "2969760"
  },
  {
    "text": "then you can solve\nany inference task. So I'm going to put a\nlittle check mark here. I do owe you an explanation for\ncontinuous random variables,",
    "start": "2969760",
    "end": "2976260"
  },
  {
    "text": "but we'll get to\nthat in a second. Do you have to make\nmore samples if you know you're going to reject more?",
    "start": "2976260",
    "end": "2982350"
  },
  {
    "text": "Yes. If you know you're going\nto have to reject more, you would need more samples. And that's why continuous\nbecomes so interesting.",
    "start": "2982350",
    "end": "2990870"
  },
  {
    "text": "OK. So at this point, you know, if\nI gave you a thing like WebMD,",
    "start": "2990870",
    "end": "2998520"
  },
  {
    "text": "if you want to make\na Bayes net, tell me how you think the\nworld's organized. And then you need to get your\nconditional probabilities.",
    "start": "2998520",
    "end": "3004340"
  },
  {
    "text": "You can either talk to an expert\nor use a data set for those. Then, once you have\na Bayesian network,",
    "start": "3004340",
    "end": "3009630"
  },
  {
    "text": "we can use rejection sampling\nand answer any probability question we've got. OK.",
    "start": "3009630",
    "end": "3016100"
  },
  {
    "text": "So here's the claim\nbehind rejection sampling. It's not that crazy.",
    "start": "3016100",
    "end": "3022460"
  },
  {
    "text": "The claim behind\nrejection sampling is that this\nconditional probability is about equal to\nhow many samples",
    "start": "3022460",
    "end": "3030440"
  },
  {
    "text": "are consistent with\nthe observation and what proportion of those are\nconsistent with the observation",
    "start": "3030440",
    "end": "3036319"
  },
  {
    "text": "and also have flu equals 1. And this really harks back\nto the original definition",
    "start": "3036320",
    "end": "3041694"
  },
  {
    "text": "of probabilities,\nwhich is saying that the probability of our\nevent of somebody having a flu is the ratio of number\nof times that happens.",
    "start": "3041695",
    "end": "3049550"
  },
  {
    "text": "This is in the universe\nof what we observe, so in the universe\nof what we observe,",
    "start": "3049550",
    "end": "3054560"
  },
  {
    "text": "what fraction of\npeople have the flu. So it's like counting\nthe number of people of flu divided by\nthe number of people",
    "start": "3054560",
    "end": "3061220"
  },
  {
    "text": "in this particular universe, so\nthe universe of people who are undergraduates and are tired. So the theory behind it\nis rather straightforward.",
    "start": "3061220",
    "end": "3068970"
  },
  {
    "text": "And this is why\nrejection sampling works. What does it require\nyou to understand?",
    "start": "3068970",
    "end": "3074067"
  },
  {
    "text": "You need to know what\na Bayesian network is. You need to know what it means\nto sample from a Bayesian network, to get a\nwhole joint sample.",
    "start": "3074067",
    "end": "3080760"
  },
  {
    "text": "And then you need to know\nthe simple idea of counting. And then you can answer\nyour inference questions.",
    "start": "3080760",
    "end": "3085859"
  },
  {
    "text": "Yes? Would we be required to sort\nof reproduce those rejection",
    "start": "3085860",
    "end": "3092100"
  },
  {
    "text": "algorithm during\nthe midterm, where-- You know, I might--",
    "start": "3092100",
    "end": "3098039"
  },
  {
    "text": "I can use Bayesian\nnetworks to create interesting joint\nprobability questions. So there's things from your last\nsection, where you guys talked",
    "start": "3098040",
    "end": "3106560"
  },
  {
    "text": "about joint distributions. And a Bayesian network is\njust a really elegant way for expressing a joint.",
    "start": "3106560",
    "end": "3112020"
  },
  {
    "text": "Would I make you\nguys do rejection sampling on the midterm? Maybe not because, you know,\nthe code for rejection sampling",
    "start": "3112020",
    "end": "3119010"
  },
  {
    "text": "it's always the same. Like, this part of the\ncode is always the same.",
    "start": "3119010",
    "end": "3124240"
  },
  {
    "text": "The only part of the\ncode, which is different, if you were to do\nit differently, is to write this code where\nyou pull a single sample.",
    "start": "3124240",
    "end": "3131910"
  },
  {
    "text": "Would I make you\nwrite a code that could pull a single sample? I'm definitely going\nto ask it for you in the next problem set.",
    "start": "3131910",
    "end": "3137790"
  },
  {
    "text": "I think on the\nmidterm I probably wouldn't make you do this. I would possibly, though--",
    "start": "3137790",
    "end": "3143130"
  },
  {
    "text": "I think this is fair\ngame, this idea that you can count to calculate a\nconditional probability.",
    "start": "3143130",
    "end": "3148393"
  },
  {
    "text": "So if you have a data\nset, like the bats that we talked\nabout earlier, you could get probabilities\nby counting from subsets.",
    "start": "3148393",
    "end": "3154319"
  },
  {
    "text": "That's very much fair game. Good question.",
    "start": "3154320",
    "end": "3159420"
  },
  {
    "text": "OK, now, if you\ncan sample enough from the joint distribution,\nyou can answer any probability",
    "start": "3159420",
    "end": "3165990"
  },
  {
    "text": "question. Wow, what a fun time. But there is a problem\nwith rejection sampling. And the a problem with\nrejection sampling",
    "start": "3165990",
    "end": "3172890"
  },
  {
    "text": "is, if you condition off\nsomething incredibly rare, so if you condition off\nsomething that hardly ever",
    "start": "3172890",
    "end": "3180360"
  },
  {
    "text": "happens, and if in your\n100,000 fake samples, you just didn't see the\nthing you condition off of,",
    "start": "3180360",
    "end": "3186180"
  },
  {
    "text": "you'll reject everything. So imagine you're\nconditioning off like a very rare occurrence.",
    "start": "3186180",
    "end": "3191720"
  },
  {
    "text": "Like, somebody has a fever, but\nmaybe they don't have a flu. Like, this almost never happens.",
    "start": "3191720",
    "end": "3198230"
  },
  {
    "text": "If you condition off that,\nyou take your 100,000 samples, you look through\nall of them that has that particular\nassignment, and maybe you",
    "start": "3198230",
    "end": "3204080"
  },
  {
    "text": "throw away everything. And if you throw\naway everything, you've got a problem, right? Because the definition\nof probability",
    "start": "3204080",
    "end": "3211070"
  },
  {
    "text": "here was supposed to be the\nlimit as n goes to infinity. And if you've thrown\naway everything,",
    "start": "3211070",
    "end": "3217369"
  },
  {
    "text": "you're left with like\n0, 1, 2, or 3 samples. This is getting pretty far\naway from the definition",
    "start": "3217370",
    "end": "3222530"
  },
  {
    "text": "of probability\nthat we were using. So the problem with\nrejection sampling is if you reject\neverything, kind",
    "start": "3222530",
    "end": "3229310"
  },
  {
    "text": "of like the problem with life. So let's think about\nthis a little bit. And I can give you\na particular version",
    "start": "3229310",
    "end": "3235670"
  },
  {
    "text": "of this which really\nbreaks rejection sampling. And that's if I took\nmy Bayesian network",
    "start": "3235670",
    "end": "3240800"
  },
  {
    "text": "and I allowed for a\ncontinuous random variable-- fever is not something\nthat's a 1 or a 0.",
    "start": "3240800",
    "end": "3246530"
  },
  {
    "text": "It's a continuous number. You say, I have a fever of 92. Wait, I have a fever of 102.",
    "start": "3246530",
    "end": "3253280"
  },
  {
    "text": "You don't say I\njust have a fever. So what if we wanted to\ntake a Bayesian network and we want to allow one random\nvariable to be continuous?",
    "start": "3253280",
    "end": "3261530"
  },
  {
    "text": "We have seen Bayesian\nnetworks with continuous random variables,\nlike for example, the elephant one. We would have weight as a\ncontinuous random variable--",
    "start": "3261530",
    "end": "3268070"
  },
  {
    "text": "or in the gaze, with how\nmuch the child's view moved. That was a continuous\nrandom variable. So we have seen it before.",
    "start": "3268070",
    "end": "3273750"
  },
  {
    "text": "And the way we saw it\nwere things like this. If somebody has the flu--",
    "start": "3273750",
    "end": "3280010"
  },
  {
    "text": "that is definitely wrong. ",
    "start": "3280010",
    "end": "3285339"
  },
  {
    "text": "If somebody does\nhave the flu, then",
    "start": "3285340",
    "end": "3290570"
  },
  {
    "text": "the distribution of\ntheir temperature is going to be a normal\nwith a higher mean.",
    "start": "3290570",
    "end": "3296390"
  },
  {
    "text": "And it turns out there is\nquite a bit more variance. If somebody doesn't\nhave the flu, then the distribution\nof their temperature",
    "start": "3296390",
    "end": "3303040"
  },
  {
    "text": "is the average\ntemperature of a human. But there's also variance to the\naverage temperature of a human.",
    "start": "3303040",
    "end": "3308290"
  },
  {
    "text": "Some people present\nwith 99 degrees even when they're healthy. But when people have\na fever, it could be",
    "start": "3308290",
    "end": "3314589"
  },
  {
    "text": "anything from like 98 to 102. There's a whole\nbunch of variance.",
    "start": "3314590",
    "end": "3320050"
  },
  {
    "text": "So this is a more precise\nway of expressing fever. Does that make sense?",
    "start": "3320050",
    "end": "3326339"
  },
  {
    "text": "OK, so at this point we've\ngot a Bayesian network. Could we still write\na sampling algorithm? Because that was the\nfirst thing we need to do.",
    "start": "3326340",
    "end": "3333270"
  },
  {
    "text": "As I said, the most complicated\nthing we'd have to do is a sampling algorithm. Could you sample flu\nfor a new person?",
    "start": "3333270",
    "end": "3339740"
  },
  {
    "text": "Yeah, that's good. Can you sample undergrad? Yeah, it's just going\nto be that BERN 0.8.",
    "start": "3339740",
    "end": "3344869"
  },
  {
    "text": "Could you sample tired? Well, you know if\nthey've got the flu, you know if they're\nundergraduate, and we're just using\nthe same algorithm.",
    "start": "3344870",
    "end": "3351427"
  },
  {
    "text": "So yeah, we could. Could you sample fever if\nyou're making a joint sample?",
    "start": "3351427",
    "end": "3360258"
  },
  {
    "text": "Talk to the person next to you. How would you sample fever? See if you can figure\nit out, and then we'll just check or not check\nif you can sample fever.",
    "start": "3360258",
    "end": "3365966"
  },
  {
    "text": "How would you do it? How would you write\nthis in Python? [SIDE CONVERSATION]",
    "start": "3365967",
    "end": "3372270"
  },
  {
    "start": "3372270",
    "end": "3443490"
  },
  {
    "text": "I don't know what you\nguys came up with, but it turns out the answer\nis yes, you can sample.",
    "start": "3443490",
    "end": "3449520"
  },
  {
    "text": "Here's what happens, is,\nyou go back to your sample. You have to choose flu\nfirst because if flu is 1,",
    "start": "3449520",
    "end": "3454965"
  },
  {
    "text": "we're going to be sampling from\ndifferent normal distributions. If flu is 1, we're going\nto be sampling fever from a normal distribution\nwith that higher mean.",
    "start": "3454965",
    "end": "3461610"
  },
  {
    "text": "If flu is 0, we're\ngoing to sample from a normal distribution\nwith that lower mean. Now, norm, that's\nnot a function.",
    "start": "3461610",
    "end": "3467740"
  },
  {
    "text": "Here's how you\nsample from a normal. SciPy has a stats library, and\nyou can see stats.norm.rvs.",
    "start": "3467740",
    "end": "3473776"
  },
  {
    "text": "And you just pass the mean\nand standard deviation, and it will give\nyou a random sample from that normal distribution.",
    "start": "3473777",
    "end": "3479830"
  },
  {
    "text": "So can we sample? Absolutely. The problem isn't that we\ncan't create joint samples.",
    "start": "3479830",
    "end": "3486420"
  },
  {
    "text": "And if we go to\nour code, I'm going",
    "start": "3486420",
    "end": "3492599"
  },
  {
    "text": "to now create an observation. My observation is, somebody\nis an undergraduate, and they are tired, and\nwe observe a fever of 101.",
    "start": "3492600",
    "end": "3501940"
  },
  {
    "text": "And I'm just going to use the\nexact same rejection sampling. Now we've got those\nnormal distributions to sample for fever.",
    "start": "3501940",
    "end": "3507970"
  },
  {
    "text": "Let's do this. Python jointSample continuous.",
    "start": "3507970",
    "end": "3514380"
  },
  {
    "text": "Here comes our fake people. And look, they've\nall got temperatures. How cute is that? It's like, it's so\nmuch more exciting.",
    "start": "3514380",
    "end": "3520568"
  },
  {
    "text": "There goes their numbers. ",
    "start": "3520568",
    "end": "3526330"
  },
  {
    "text": "That's not right. I might have played\naround with this, and I must have fixed something\nbecause that probability was",
    "start": "3526330",
    "end": "3534200"
  },
  {
    "text": "supposed to give us the\nsurprising result of a null. OK, let's see my--",
    "start": "3534200",
    "end": "3539390"
  },
  {
    "text": "doo-doo-doo-doo-doo--\ncheck observation match. ",
    "start": "3539390",
    "end": "3549450"
  },
  {
    "text": "I'm not doing anything\nreally fancy here, am I? Doo-doo-doo-doo-doo. Sorry.",
    "start": "3549450",
    "end": "3556520"
  },
  {
    "text": "Print observation. Oh, wait, I know\nwhat I did here.",
    "start": "3556520",
    "end": "3563530"
  },
  {
    "text": "So cute. Oh my god, so cute,\nso cute of me.",
    "start": "3563530",
    "end": "3568600"
  },
  {
    "text": "No. OK, back to my demo that\nwas supposed to fail",
    "start": "3568600",
    "end": "3575450"
  },
  {
    "text": "but somehow didn't fail.  [STUDENTS LAUGH]",
    "start": "3575450",
    "end": "3580650"
  },
  {
    "text": "Now it really failed. Probability is not defined. ",
    "start": "3580650",
    "end": "3586204"
  },
  {
    "text": "[VOCALIZING] Terminal, New Terminal. I feel like people go to watch\nrace cars because there's",
    "start": "3586205",
    "end": "3594600"
  },
  {
    "text": "a chance that they'll crash. [STUDENTS LAUGH] OK, here comes my fake people.",
    "start": "3594600",
    "end": "3602099"
  },
  {
    "text": "And from these\nfake people, we're going to reject everything\nthat doesn't match our sample.",
    "start": "3602100",
    "end": "3607710"
  },
  {
    "text": "Oh, no, it broke. And our sample had-- this was the thing we were\ngoing to condition off.",
    "start": "3607710",
    "end": "3614279"
  },
  {
    "text": "So we rejected everything\nthat didn't match this. And we looked for exact matches. You know, like, wait, something\ndefinitely matched that.",
    "start": "3614280",
    "end": "3621413"
  },
  {
    "text": "And you go over, and\nyou're like, [HUMS] and you're like, that one. That one matches, almost. And you're like,\nnope, not exactly.",
    "start": "3621413",
    "end": "3627750"
  },
  {
    "text": "You're like, that\none doesn't match. And you get to this one. You're like, that\nmatches, right?",
    "start": "3627750",
    "end": "3634440"
  },
  {
    "text": "No, you condition\noff an exact match. That is the proper\nprobabilistic thing to do.",
    "start": "3634440",
    "end": "3639905"
  },
  {
    "text": "You went through\nall your samples and you looked for 101.0. We've talked about this. For a continuous\nrandom variable,",
    "start": "3639905",
    "end": "3646015"
  },
  {
    "text": "what's the chance that it\ngives you exactly 101.0? 0. 0. That's never happening. Sad times.",
    "start": "3646015",
    "end": "3652319"
  },
  {
    "text": "And so like, sad times expressed\nin computer science is here. Aw, division by 0.",
    "start": "3652320",
    "end": "3660360"
  },
  {
    "text": "When I went to count, I\nhad rejected everything. And I was just left alone,\nwithout any samples,",
    "start": "3660360",
    "end": "3666660"
  },
  {
    "text": "crying in my bedroom. Division by 0. And then unfortunately,\nI accidentally showed you",
    "start": "3666660",
    "end": "3673250"
  },
  {
    "text": "a solution. So a solution was, what if\nevery time you generate somebody",
    "start": "3673250",
    "end": "3678710"
  },
  {
    "text": "with a fever, you round it? So doo-doo-doo-doo-doo. Does anyone remember the math,\nor the function for rounding?",
    "start": "3678710",
    "end": "3685770"
  },
  {
    "text": "There it is. There it is. Oh, well, there's definitely\na nice function for rounding,",
    "start": "3685770",
    "end": "3691310"
  },
  {
    "text": "but Python has a Round. And so you can just\ntake any fever. And if you round it, now\nwhen we create our samples,",
    "start": "3691310",
    "end": "3698840"
  },
  {
    "text": "once they get rounded,\nyou have a nonzero chance of people actually\nmatching 101.0.",
    "start": "3698840",
    "end": "3705230"
  },
  {
    "text": "Do many of these match 101.0? No, you don't see\na lot of people. But you do see enough that you\ncan calculate a probability.",
    "start": "3705230",
    "end": "3713990"
  },
  {
    "text": "If you don't see many 101.0s,\nif that is a very rare event, how can it still be the case\nthat the probability of fever",
    "start": "3713990",
    "end": "3721040"
  },
  {
    "text": "is very high? The thing I condition\noff is rare,",
    "start": "3721040",
    "end": "3726720"
  },
  {
    "text": "but the probability of\nfever was very large. Sorry, the probability\nof flu was very large. ",
    "start": "3726720",
    "end": "3733569"
  },
  {
    "text": "Because the thing I\ncondition off is rare doesn't tell you about\nthe probability of flu. What that tells you\nis I'm going to be",
    "start": "3733570",
    "end": "3739143"
  },
  {
    "text": "rejecting a lot of my samples. So maybe of 100,000 fake\npeople, only 100 of them",
    "start": "3739143",
    "end": "3744880"
  },
  {
    "text": "had that particular\nfever temperature. But when we looked at\nthose 100 people who had that particular\nfever temperature,",
    "start": "3744880",
    "end": "3751269"
  },
  {
    "text": "a whole bunch of them\nactually had the flu. So going back to the\ntheory-- or maybe I",
    "start": "3751270",
    "end": "3758100"
  },
  {
    "text": "should answer questions there. Doo-doo-doo-doo-doo. Could you just clarify\nwhat you changed?",
    "start": "3758100",
    "end": "3763200"
  },
  {
    "text": "Oh, I made it round. So what I changed here is--",
    "start": "3763200",
    "end": "3768840"
  },
  {
    "text": "doo-doo-doo-doo-doo-- when\nI generate my samples, before I would generate a\ncontinuous number to full",
    "start": "3768840",
    "end": "3774400"
  },
  {
    "text": "precision. And now I just generate\none to one decimal point. Would you have\ndone the same thing by creating a small range?",
    "start": "3774400",
    "end": "3780420"
  },
  {
    "text": "Yeah, you could have said\nfever is low, medium, high. You could have said\nyour fever is 100--",
    "start": "3780420",
    "end": "3787220"
  },
  {
    "text": "or 90 to 95, 95 to\n100, 100 to 100. Any way you\ndiscretize would work.",
    "start": "3787220",
    "end": "3793600"
  },
  {
    "text": "And this is a way\nof discretizing. I'm just discretizing\nto one decimal point. So discretization is\nhelping us once again.",
    "start": "3793600",
    "end": "3800370"
  },
  {
    "text": "Yeah? Could you just explain how\nyou generated the random fever numbers? Oh, yeah.",
    "start": "3800370",
    "end": "3805800"
  },
  {
    "text": "So I used-- [VOCALIZING]\nlet's check this line out.",
    "start": "3805800",
    "end": "3812300"
  },
  {
    "text": "So I'm just going\nto pull up Python. So Terminal, Python,\nPyron, whatever,",
    "start": "3812300",
    "end": "3820950"
  },
  {
    "text": "from scipy import stats. You want a random normal?",
    "start": "3820950",
    "end": "3828440"
  },
  {
    "text": "But what normal? Give me a mean. Five.",
    "start": "3828440",
    "end": "3833609"
  },
  {
    "text": "Ooh, good choice,\nstandard deviation. No, that's too big. I'm just joking. That's fine.",
    "start": "3833610",
    "end": "3839240"
  },
  {
    "text": "OK, I'm going to\ncall this function, and it gives you one sample. So if I call it again, you\nget a different sample.",
    "start": "3839240",
    "end": "3846540"
  },
  {
    "text": "It's not always the same number. And the distribution\nfrom which this comes is the probability\ndensity function.",
    "start": "3846540",
    "end": "3854420"
  },
  {
    "text": "But it's not uniform. It's random from this\nparticular normal. It's from the PDF of the normal.",
    "start": "3854420",
    "end": "3861350"
  },
  {
    "text": "Yes? Is this RVS set point? Oh, random variables, I\nthink, or random values.",
    "start": "3861350",
    "end": "3868157"
  },
  {
    "text": "And I think there might\nbe a parameter where you can be like 10 and it might\ngive you back 10 of these. Yeah.",
    "start": "3868157",
    "end": "3873170"
  },
  {
    "text": "The S is for multiple and\nbecause this function allows you to get multiple. How optimized is my code?",
    "start": "3873170",
    "end": "3879310"
  },
  {
    "text": "And you're like, not at all. I could definitely\noptimize this. But the point is the\nlearning, not how fast you could run this.",
    "start": "3879310",
    "end": "3885070"
  },
  {
    "text": "OK. Wait, I want to talk\nmore about this. So if you guys have\nquestions, this is very fun.",
    "start": "3885070",
    "end": "3891920"
  },
  {
    "text": "So this is the\nthing we're trying to learn how to do, any\ninference task for any Bayesian",
    "start": "3891920",
    "end": "3896930"
  },
  {
    "text": "network. And rejection sampling\nis such a good idea. It requires you to know\nhow to do two things.",
    "start": "3896930",
    "end": "3902970"
  },
  {
    "text": "You need to know how\nto sample, and then you just need to write\nrejection sampling. It fails if you're\ndoing a query where",
    "start": "3902970",
    "end": "3909590"
  },
  {
    "text": "the condition thing is so rare,\nyou throw out all your samples. And so we used a trick\nhere to solve that problem.",
    "start": "3909590",
    "end": "3918720"
  },
  {
    "text": "Questions, comments, concerns? Yeah? How do you decide to what\nprecision you discretize your",
    "start": "3918720",
    "end": "3925069"
  },
  {
    "text": "[INAUDIBLE]? That's a good question. You know, I had-- I think I made 100,000 samples.",
    "start": "3925070",
    "end": "3930170"
  },
  {
    "text": "So that discretization\ngave me enough samples for each reasonable thing. But if I wanted to\nmake a billion samples,",
    "start": "3930170",
    "end": "3937310"
  },
  {
    "text": "I could probably get away\nwith a finer discretization. So it's dependent on how\nmany samples you have. It really comes down to\nwhat's the probability",
    "start": "3937310",
    "end": "3943940"
  },
  {
    "text": "of your observation. And if that probability\ngets too low, it fails, or you\nneed more samples.",
    "start": "3943940",
    "end": "3949130"
  },
  {
    "text": "Yes? Is there a way that we can\ndo this without discretizing, via some other training? Yes, there is.",
    "start": "3949130",
    "end": "3954830"
  },
  {
    "text": "Next question. No, I'm just joking. I'll explain to you\nhow in just a second.",
    "start": "3954830",
    "end": "3959903"
  },
  {
    "text": "I don't know if this is\nlike outside the scope of the problem, but\nhow exactly does the function that creates the\nnormal distribution people",
    "start": "3959903",
    "end": "3968570"
  },
  {
    "text": "work? Oh, how does that work? Ask me after class, but I think\nI talked about it earlier. Basically, there's this\nthing called a CDF.",
    "start": "3968570",
    "end": "3975937"
  },
  {
    "text": "It's a beautiful thing. And if you take the CDF of the\nnormal you're sampling from, it turns out, you choose a\nrandom value between 0 and 1.",
    "start": "3975937",
    "end": "3982230"
  },
  {
    "text": "And you inverse transform\nit onto that CDF, and you return back. This goes back to the user.",
    "start": "3982230",
    "end": "3987310"
  },
  {
    "text": "So you start here,\nchoose your y of the CDF,",
    "start": "3987310",
    "end": "3993240"
  },
  {
    "text": "and figure out which x\nwould lead to that y, give that to the user, and\nit gives you a proper sample. It's a beautiful thing. ",
    "start": "3993240",
    "end": "4001440"
  },
  {
    "text": "OK. I'm not going to teach\nyou this, but I'm going to teach you\nthat it exists.",
    "start": "4001440",
    "end": "4007109"
  },
  {
    "text": "There is this thing called\nMarkov chain Monte Carlo. It is a cool\nalgorithm if you want",
    "start": "4007110",
    "end": "4013740"
  },
  {
    "text": "to go beyond rejection sampling. Rejection sampling\nworks for so many cases, especially if you're\njust a little bit",
    "start": "4013740",
    "end": "4018885"
  },
  {
    "text": "thoughtful about\nyour discretizations, but I did want you\nto know that there are other things out there. And Markov chain Monte\nCarlo does the same thing",
    "start": "4018885",
    "end": "4026550"
  },
  {
    "text": "as rejection sampling,\nbut look at my samples. Notice anything funny? ",
    "start": "4026550",
    "end": "4033917"
  },
  {
    "text": "You're like, ha-ha-ha,\neveryone has a fever. That's not funny, Chris. They've got a fever. That's scary.",
    "start": "4033917",
    "end": "4039470"
  },
  {
    "text": "The interesting\nthing about this is, even though I'm pulling\nsamples, every single sample",
    "start": "4039470",
    "end": "4044540"
  },
  {
    "text": "that I pull from has\nexactly the query in it. So it's like, set\nthe query to be 101",
    "start": "4044540",
    "end": "4051150"
  },
  {
    "text": "and then choose the other random\nvariables to be correct given that the query is that number. And then you don't have\nto reject anything.",
    "start": "4051150",
    "end": "4058320"
  },
  {
    "text": "How would you pull a sample\nlike this is beyond CS109. It's super cool. You can go check it out.",
    "start": "4058320",
    "end": "4064500"
  },
  {
    "text": "But it's the next\nalgorithm if you were to learn beyond\nrejection sampling.",
    "start": "4064500",
    "end": "4070410"
  },
  {
    "text": "Rejection sampling gets you so\nfar, but there are other ones. There's MCMC. There's actually even\na package written",
    "start": "4070410",
    "end": "4077069"
  },
  {
    "text": "by Noah Goodman called\nPyro, so that you can just write this in code,\nand then the code",
    "start": "4077070",
    "end": "4082560"
  },
  {
    "text": "will choose which algorithm\nit should use to do inference, a beautiful thing.",
    "start": "4082560",
    "end": "4087810"
  },
  {
    "text": "And then we even wrote one\nin our lab for Idea2Text. And I'd love to tell you\njust a little bit about this.",
    "start": "4087810",
    "end": "4093390"
  },
  {
    "text": "Do you guys want to hear\nabout something cool? Yeah. Yay, OK. So I'm going to motivate\nthis by a problem that",
    "start": "4093390",
    "end": "4098909"
  },
  {
    "text": "doesn't feel like WebMD at all. The problem that I'm going to\nmotivate this cool algorithm",
    "start": "4098910",
    "end": "4105270"
  },
  {
    "text": "for is, how can\nwe figure out what mistakes students have made? So imagine a student trying to\nwrite code to draw this thing.",
    "start": "4105270",
    "end": "4112120"
  },
  {
    "text": "And if you think about\nit, it's like, that's pretty annoying code to write. You have to have like,\nnested for loops, and there's a whole\nbunch of things changing.",
    "start": "4112120",
    "end": "4117922"
  },
  {
    "text": "It's very mind blowing\nfor a new student. And they're going to write it\nusing a block-based language. Their solutions will probably\nbe about 10 lines or less.",
    "start": "4117922",
    "end": "4125460"
  },
  {
    "text": "But you need to then\nbe able to say what is the feedback I should give you.",
    "start": "4125460",
    "end": "4130549"
  },
  {
    "text": "Your inference task is\nfeedback given code.",
    "start": "4130550",
    "end": "4135920"
  },
  {
    "text": "Those are hard random variables\nto think about, aren't they? And long story short, we wanted\nto use rejection sampling,",
    "start": "4135920",
    "end": "4144310"
  },
  {
    "text": "something like it. So what did that mean we\nneeded to be able to write? We needed to write a Python\nfunction called Sample.",
    "start": "4144310",
    "end": "4151830"
  },
  {
    "text": "And when you write this\nPython function called Sample, it's going to make\na fake student with all of their misconceptions\nand all of their code.",
    "start": "4151830",
    "end": "4160250"
  },
  {
    "text": "And if we could write\nthis sampling algorithm, then we could sample a ton.",
    "start": "4160250",
    "end": "4166080"
  },
  {
    "text": "And then we could look, out of\nall the sampled fake students, have we ever get\nall the students",
    "start": "4166080",
    "end": "4171899"
  },
  {
    "text": "who have exactly this code? And we could look\nat all the students who had exactly\nthis code, and we could say, OK, what\nmisconceptions did they have?",
    "start": "4171899",
    "end": "4177839"
  },
  {
    "text": "What's the distribution\nof people who didn't understand for loops here? What's the distribution\nof people who didn't understand if statements?",
    "start": "4177840",
    "end": "4183520"
  },
  {
    "text": "So all we had to do was\nwrite a sampling function. And we were inspired\nby this picture.",
    "start": "4183520",
    "end": "4188589"
  },
  {
    "text": "You're like, what is\ngoing on in this picture? In 2015, somebody wrote one\nof the more influential papers",
    "start": "4188590",
    "end": "4194969"
  },
  {
    "text": "in our field. And all that they really\nhad to do in this paper was write a function\nthat was called Sample.",
    "start": "4194970",
    "end": "4201449"
  },
  {
    "text": "But instead of just sampling\na regular random variable, it was sampling\nhand-drawn digits.",
    "start": "4201450",
    "end": "4206980"
  },
  {
    "text": "So imagine you have somebody\ntrying to write this digit. And there's all these\nother characters,",
    "start": "4206980",
    "end": "4212958"
  },
  {
    "text": "and you might be\ntrying to figure out what's the probability\nthat what they've drawn is this character as\nopposed to this character.",
    "start": "4212958",
    "end": "4219510"
  },
  {
    "text": "Well, what they had is they\nhad a sampling algorithm. They wrote a generator. Boy, they should\nhave used Python.",
    "start": "4219510",
    "end": "4224820"
  },
  {
    "text": "In their paper, they\nwrote this crazy insanity, which is basically a\nmask around Python, where they would\nsample curves, sample",
    "start": "4224820",
    "end": "4232590"
  },
  {
    "text": "connections of those\ncurves, sample how people put those components together.",
    "start": "4232590",
    "end": "4238949"
  },
  {
    "text": "And then from those,\nthey could just write a forward\ngenerative process and end up with pictures\nof hand-drawn characters.",
    "start": "4238950",
    "end": "4246090"
  },
  {
    "text": "And I said, if they can\nsample hand-drawn characters, we can sample code. They sampled a lot of\nhand-drawn characters,",
    "start": "4246090",
    "end": "4252180"
  },
  {
    "text": "and they got very good results. They beat all the neural\nnetworks at the time. And so the idea was, can\nyou do this for code?",
    "start": "4252180",
    "end": "4259420"
  },
  {
    "text": "And so we just thought, OK,\nwe're going to write sample. And when we write the sample,\nwe're just going to try",
    "start": "4259420",
    "end": "4264630"
  },
  {
    "text": "and generatively think through\na student's decision process. OK, they decided to\nwork on this problem. That's where they went wrong.",
    "start": "4264630",
    "end": "4270210"
  },
  {
    "text": "OK, and then we would set\nall their misconceptions. And then based on\ntheir misconceptions, we'd start to generate the\ncode probabilistically,",
    "start": "4270210",
    "end": "4276588"
  },
  {
    "text": "and we would sample from the\njoint as much as possible. It's like we made the\nBayesian network but for code.",
    "start": "4276588",
    "end": "4282190"
  },
  {
    "text": "And we wrote a\nparticular library that would allow us to write\nthe Bayesian network for code. And it worked really,\nreally, really well",
    "start": "4282190",
    "end": "4289330"
  },
  {
    "text": "and to the point where you could\nwrite this Bayesian network. Teachers don't know\nthe generative process.",
    "start": "4289330",
    "end": "4294778"
  },
  {
    "text": "Does anyone know\nthe Bayesian network for how a student thinks? No. There wasn't like a place I\ncould go research and look up",
    "start": "4294778",
    "end": "4301232"
  },
  {
    "text": "what is the Bayesian network. We did have to invent\nit based on just what we thought students would do.",
    "start": "4301232",
    "end": "4306610"
  },
  {
    "text": "But generative is not so hard. If you're thinking\ngeneratively, it's like making the WebMD model. It's not that hard.",
    "start": "4306610",
    "end": "4312500"
  },
  {
    "text": "You can be like, OK, I\nthink flu causes fever. That's not insane. And similarly, you\ncan be like, if people",
    "start": "4312500",
    "end": "4317710"
  },
  {
    "text": "have this\nmisconception, I've seen them write this piece of code. It wasn't insane for\nus to write this, and it turned out to\nbe very, very useful,",
    "start": "4317710",
    "end": "4324440"
  },
  {
    "text": "and not just for code. We used it on code. We used it on short answers.",
    "start": "4324440",
    "end": "4330650"
  },
  {
    "text": "And by we, I mean some\nwonderful scientists, which also included\nour own head here.",
    "start": "4330650",
    "end": "4336340"
  },
  {
    "text": "Actually, the first time I met\nWill, you were like a freshman. And you came, and you're like,\nI want to do some research.",
    "start": "4336340",
    "end": "4341950"
  },
  {
    "text": "I'm like, no. Sorry, I'm just joking. But you're like, hey, can I have\na challenge for winter break?",
    "start": "4341950",
    "end": "4348040"
  },
  {
    "text": "And I said, well, we're thinking\na lot about these sampling things. Could you sample-- I think it was graphics. I gave you a graphics thing.",
    "start": "4348040",
    "end": "4354037"
  },
  {
    "text": "I said, people who are in 106A,\nthey do a pyramid assignment. Can you sample people\ndrawing pyramids?",
    "start": "4354037",
    "end": "4359830"
  },
  {
    "text": "And you sampled a\nton, Will, and it was part of this wonderful\nresearch project that seemed to work very well.",
    "start": "4359830",
    "end": "4365840"
  },
  {
    "text": "So we wrote the decision\nmaking Bayesian network. And then we would sample a ton. We would get a bunch of fake\nstudents with fake code.",
    "start": "4365840",
    "end": "4372850"
  },
  {
    "text": "And then we would do inference. We could have used\nrejection sampling. That would have\nworked pretty well. I do want to be\nhonest that we also",
    "start": "4372850",
    "end": "4379408"
  },
  {
    "text": "used a little bit\nof a neural network to make our rejection sampling\na little bit more efficient. But rejection sampling would\nhave been fine for inference,",
    "start": "4379408",
    "end": "4386560"
  },
  {
    "text": "just, there was-- because we could, we used\na slightly different one.",
    "start": "4386560",
    "end": "4391900"
  },
  {
    "text": "Now, before I let\nyou go, I just want to make this a little\nbit more relevant. You guys should be asking\nyourselves this question--",
    "start": "4391900",
    "end": "4399912"
  },
  {
    "text": "or here's one of the weirdest\nthings you could ask yourself while studying for a midterm.",
    "start": "4399912",
    "end": "4405520"
  },
  {
    "text": "What is-- you look at\na problem, and you're like, what's the\nprobability that this is a binomial\ndistribution problem?",
    "start": "4405520",
    "end": "4411739"
  },
  {
    "text": "Right? Isn't that what\nyou're kind of doing? And in fact, if you want\nto really solve that, you know what you should do?",
    "start": "4411740",
    "end": "4417070"
  },
  {
    "text": "You should write a\nBayesian network. You should think, what's\nthe generative process through which Chris creates\nbinomial distribution problems?",
    "start": "4417070",
    "end": "4423700"
  },
  {
    "text": "And if you could write\nthat Bayesian network, you would know\neverything about how to solve any CS109 binomial\ndistribution problem, right?",
    "start": "4423700",
    "end": "4431590"
  },
  {
    "text": "Wouldn't that be cool? So I went ahead and\ndid that for you guys. I wrote a generative model.",
    "start": "4431590",
    "end": "4437830"
  },
  {
    "text": "And when you run it-- I think currently,\nit just creates like 100 random binomial\ndistribution problems.",
    "start": "4437830",
    "end": "4443880"
  },
  {
    "text": "And sorry, they're written all\nin HTML with LaTeX in them. But it'll say\nsomething like, a ball",
    "start": "4443880",
    "end": "4449310"
  },
  {
    "text": "hit a series of 30 pins,\nwhere it can bounce either to the left or the right. The probability of a\nright on each pin is 1/3.",
    "start": "4449310",
    "end": "4454527"
  },
  {
    "text": "What is the probability that\nthe number of rights is 28? Did somebody just\nwrite the answer?",
    "start": "4454527",
    "end": "4460947"
  },
  {
    "text": "It doesn't say the answer. Oh, there is the answer. Oh, there it is. It's very, very low. But anyways, I sampled that.",
    "start": "4460947",
    "end": "4467910"
  },
  {
    "text": "I just had a\ndistribution for it. And potentially using\nsome rejection sampling, or something like MCMC, or\nsomething more complicated,",
    "start": "4467910",
    "end": "4474120"
  },
  {
    "text": "you could put this\nas your query. And you can say, what is\nthe probability that this is binomial given the query?",
    "start": "4474120",
    "end": "4479247"
  },
  {
    "text": "Or you could even say, what's\nthe probability of the answer? You can even say, what's\nthe answer given the query?",
    "start": "4479247",
    "end": "4484679"
  },
  {
    "text": "Anyways-- but that is\nan interesting thing. A funny way to talk about\nstudying for a midterm",
    "start": "4484680",
    "end": "4491310"
  },
  {
    "text": "is to try and write your own. That's maybe one takeaway. I can't write that\nmany problems.",
    "start": "4491310",
    "end": "4496660"
  },
  {
    "text": "I'm an old man. I've written many midterms. I'm running out of creativity. And there's only\nso many ways you can ask about binomials, and\npoissons, and all those things.",
    "start": "4496660",
    "end": "4504270"
  },
  {
    "text": "I probably have a generative\nprocess in my mind. And if you tried to\nwrite your own midterm, you would have to generate.",
    "start": "4504270",
    "end": "4510947"
  },
  {
    "text": "You would have to get into\nthe generative process. And maybe, by\nthinking about that, you would get really good\nat the inference task",
    "start": "4510947",
    "end": "4516772"
  },
  {
    "text": "because one of the stories\nof Bayesian networks is the ability to generate--\nis an important precursor",
    "start": "4516772",
    "end": "4522430"
  },
  {
    "text": "to the ability to infer. OK. I'll just tell you what\nwe haven't talked about.",
    "start": "4522430",
    "end": "4529560"
  },
  {
    "text": "As I mentioned, there\nis a field of study where you can learn the\narrows from data that's called structure learning. We haven't talked about this.",
    "start": "4529560",
    "end": "4536340"
  },
  {
    "text": "And we haven't\nparticularly talked about how you could get\nthese probabilities. Basically, I've told you\nto make them up so far,",
    "start": "4536340",
    "end": "4541980"
  },
  {
    "text": "but it turns out that\nthere are data-driven ways you could do this. If I gave you some\nhistorical data, you could infer these\nprobabilities pretty well.",
    "start": "4541980",
    "end": "4550960"
  },
  {
    "text": "I hope you guys have\na fantastic weekend. Study for the midterm. We'll see you guys. There's no class on Monday. See you guys on\nTuesday or Wednesday.",
    "start": "4550960",
    "end": "4557950"
  },
  {
    "text": "Have a fantastic weekend. I'll be thinking\nabout you guys a lot. Come to the review session\nthat starts in 40 minutes.",
    "start": "4557950",
    "end": "4564389"
  },
  {
    "start": "4564390",
    "end": "4569000"
  }
]