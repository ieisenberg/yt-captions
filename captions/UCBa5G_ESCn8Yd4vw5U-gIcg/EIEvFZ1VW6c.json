[
  {
    "start": "0",
    "end": "10670"
  },
  {
    "text": "Hi. My name is Sylvia. Today, I'm going to be\ntalking about some of the work that we have going on in my lab.",
    "start": "10670",
    "end": "15970"
  },
  {
    "text": "I'm not going to be\ntalking about all of it. I do want to quickly\nhighlight my lab which has grown very quickly since\nstarting at the end of 2020.",
    "start": "15970",
    "end": "23439"
  },
  {
    "text": "I have a wonderful PhD\nstudents, an undergraduate, and master's students. And they're working on\na range of projects.",
    "start": "23440",
    "end": "29019"
  },
  {
    "text": "I want to quickly\nmention things that I won't be talking about\ntoday in case anybody wants to meet up later.",
    "start": "29020",
    "end": "34270"
  },
  {
    "text": "So we do a lot of\nwork on this thing called reachability theory. I'll go into it a\nlittle bit more.",
    "start": "34270",
    "end": "39910"
  },
  {
    "text": "Safe reinforcement learning\nusing iterative reachability estimation is something\nthat we've been working on.",
    "start": "39910",
    "end": "45670"
  },
  {
    "text": "Something called Koopman-Hopf\nreachability analysis for fast and scalable nonlinear\nreachability approximations",
    "start": "45670",
    "end": "52120"
  },
  {
    "text": "where we can, for example, drive\nthis 10 d glycolysis model, the ATP levels up to desired\nvalues very efficiently.",
    "start": "52120",
    "end": "60700"
  },
  {
    "text": "Advances in reachability\nusing system decomposition and handling noise and\npartial observations.",
    "start": "60700",
    "end": "67055"
  },
  {
    "text": "We also have some work that's\njust more generally control and machine learning. Reasoning about safety\nwhen interacting",
    "start": "67055",
    "end": "72820"
  },
  {
    "text": "with uncertain environments. So, for example, debris a.k.a. Pringles cans that you need to\nmove around to get to a goal",
    "start": "72820",
    "end": "79505"
  },
  {
    "text": "while hopefully not\nknocking them over. And you have to reason\nabout this online. Continuously trading model\nerror with planning speed.",
    "start": "79505",
    "end": "86830"
  },
  {
    "text": "So how can you get away with\nas much error as possible such that you can still make\nyour way towards the goal?",
    "start": "86830",
    "end": "94210"
  },
  {
    "text": "Conformal prediction and\ntemporal correlations for reducing conservativeness\nand pedestrian predictions while maintaining safety.",
    "start": "94210",
    "end": "100390"
  },
  {
    "text": "And some control theory applied\nto policy gradient methods, identifying when the\noptimization landscape,",
    "start": "100390",
    "end": "105490"
  },
  {
    "text": "and the control policy space\nis very non-smooth or fractal using control theory. I know that was very fast.",
    "start": "105490",
    "end": "111490"
  },
  {
    "text": "I just want to give\na quick highlight on some of the other\ndirections that we're doing that I'm not going into today.",
    "start": "111490",
    "end": "117729"
  },
  {
    "text": "Today, I'm mostly going\nto talk about these value functions for safe control\nwhere the basic idea is",
    "start": "117730",
    "end": "123789"
  },
  {
    "text": "that we want to be able\nto take our state space and define a value function\nover the state space.",
    "start": "123790",
    "end": "130179"
  },
  {
    "text": "That takes the desired\nsafety constraint and the long-term effects of\nthe dynamics of your system",
    "start": "130180",
    "end": "135319"
  },
  {
    "text": "and composes that into a\nsingle scalar function. So if I query a\nparticular state, it tells me by the level of\nthat, the measure of the safety,",
    "start": "135320",
    "end": "143720"
  },
  {
    "text": "so if it's positive\nsafe, negative unsafe. And the gradient tells\nme the safe direction.",
    "start": "143720",
    "end": "149270"
  },
  {
    "text": "So it informs the constraints\nfor my safe control. This is the basic idea of\nwhat I would like to use.",
    "start": "149270",
    "end": "154970"
  },
  {
    "text": "We use these online\nfor something called safety\nfilters where you say I want as much as possible\nto follow the direction I'd",
    "start": "154970",
    "end": "160459"
  },
  {
    "text": "like to subject to maintaining\nthe safety properties with respect to this function.",
    "start": "160460",
    "end": "166549"
  },
  {
    "text": "There are two communities\nthat use this a lot. Potentially, I guess more. But two of the ones that\nI see a lot right now",
    "start": "166550",
    "end": "173870"
  },
  {
    "text": "are control barrier functions\nand Hamilton-Jacobi reachability analysis. I'm from this background, which\nI'll get into in a minute.",
    "start": "173870",
    "end": "181880"
  },
  {
    "text": "And when I was interviewing,\nI was asked regularly why I wasn't just using\ncontrol barrier functions.",
    "start": "181880",
    "end": "188720"
  },
  {
    "text": "And I wasn't really sure\nhonestly what the answer was. So I made up some things. And then when I\nstarted my job, I",
    "start": "188720",
    "end": "195230"
  },
  {
    "text": "figured I should\nactually dive into this and see what is\nthe relationship. Because both of these are\nultimately trying to find that",
    "start": "195230",
    "end": "200562"
  },
  {
    "text": "function that I showed\non the previous slide. So my very quick summary\nis if I split this up",
    "start": "200563",
    "end": "207320"
  },
  {
    "text": "into the initialization\nof how we find these functions, the\nconstruction of how we develop",
    "start": "207320",
    "end": "212720"
  },
  {
    "text": "these functions, and then\nthe use of how we use these functions online,\ncontrol barrier functions are",
    "start": "212720",
    "end": "218810"
  },
  {
    "text": "very similar to control\nLyapunov functions. They're essentially\nupside-down Lyapunov functions. And they come with\nall the challenges",
    "start": "218810",
    "end": "225110"
  },
  {
    "text": "of finding a control Lyapunov\nfunction for a nonlinear system. And so, for\ninitialization, there's",
    "start": "225110",
    "end": "232129"
  },
  {
    "text": "ways to hand design these for\nvery certain types of systems where you can then find\nan analytic function.",
    "start": "232130",
    "end": "239090"
  },
  {
    "text": "And it's very popular to do\ndata-driven approximations to trying to construct\nthese just from data",
    "start": "239090",
    "end": "244442"
  },
  {
    "text": "that tells you\nthings that are safe and things that are not safe. But for construction,\nin general, there's",
    "start": "244442",
    "end": "251500"
  },
  {
    "text": "not a method for general\nnonlinear dynamic systems with control bounds,\npotentially disturbance bounds.",
    "start": "251500",
    "end": "256720"
  },
  {
    "text": "There's no general\nconstructive method for this. On the reachability\nside of things,",
    "start": "256720",
    "end": "263550"
  },
  {
    "text": "we typically initialize with\na signed distance function to obstacles or failure.",
    "start": "263550",
    "end": "268830"
  },
  {
    "text": "And then we do just brute-force\ndynamic programming to that. So we encode given the dynamics\nof our system, what trajectories",
    "start": "268830",
    "end": "277020"
  },
  {
    "text": "will end up inside\nhigh-cost areas and which ones will\nmaintain low-cost.",
    "start": "277020",
    "end": "282570"
  },
  {
    "text": "Doing brute-force\ndynamic programming means that we have a very\nslow, but rigorous method of constructing these functions.",
    "start": "282570",
    "end": "289470"
  },
  {
    "text": "They have general systems,\ninput and disturbance bounds, provides the maximal\nsafe set, et cetera.",
    "start": "289470",
    "end": "295289"
  },
  {
    "text": "And then for use of\nthis in reachability, we end up with an optimal\nsafe control where it tells me",
    "start": "295290",
    "end": "302790"
  },
  {
    "text": "that the change in value, my\nchange in safety over time will always be greater\nthan or equal to 0.",
    "start": "302790",
    "end": "308639"
  },
  {
    "text": "This means that if I start at\na particular value of safety, I must be monotonically\nincreasing in safety.",
    "start": "308640",
    "end": "315870"
  },
  {
    "text": "So that means that\nyou're constantly moving upwards or at the same\nlevel of your safety function.",
    "start": "315870",
    "end": "322449"
  },
  {
    "text": "This is very conservative\nto be always running away from obstacles forever. So instead, what we use\nin reachability analysis",
    "start": "322450",
    "end": "329410"
  },
  {
    "text": "is something called least\nrestrictive control where we set that threshold to 0. When you're above\nthat threshold,",
    "start": "329410",
    "end": "335830"
  },
  {
    "text": "when you have a positive safety\nvalue, do whatever you want. As you approach the\nboundary of that threshold,",
    "start": "335830",
    "end": "341290"
  },
  {
    "text": "you override it with this\noptimal safe controller. This is nice in that\nit's least restrictive.",
    "start": "341290",
    "end": "348400"
  },
  {
    "text": "But you can end up with\nthese very choppy-looking trajectories. So how we typically use this\nin reachability analysis?",
    "start": "348400",
    "end": "356199"
  },
  {
    "text": "Can either be very\nconservative and or jerky? In practice, people\noften do some sort of averaging heuristic\nbetween the two,",
    "start": "356200",
    "end": "363940"
  },
  {
    "text": "but not very principled. The control barrier\nside of things",
    "start": "363940",
    "end": "369630"
  },
  {
    "text": "uses this control\nbarrier function quadratic program, which is a\nQP for control affine systems.",
    "start": "369630",
    "end": "378840"
  },
  {
    "text": "That's saying minimize the\ncontrol effort such that you obey the safety condition. Where now instead of v dot is\ngreater than or equal to 0,",
    "start": "378840",
    "end": "386730"
  },
  {
    "text": "it's greater than or equal\nto this minus gamma v. If I plot out that\nminus gamma v,",
    "start": "386730",
    "end": "392910"
  },
  {
    "text": "that's going to be\nthis curve here. And so what we're saying\nis that your safety value",
    "start": "392910",
    "end": "398460"
  },
  {
    "text": "must stay above this curve. So when you're very safe,\nyou can decrease quite a bit",
    "start": "398460",
    "end": "404460"
  },
  {
    "text": "your amount of safety. As you approach the\nboundary of safety where safety\napproaches zero, you",
    "start": "404460",
    "end": "409470"
  },
  {
    "text": "must stay above that boundary. So this is a nice\nway of trading off between being less\nrestrictive when you're well",
    "start": "409470",
    "end": "416970"
  },
  {
    "text": "inside the safe set\nand more restrictive when you're near the boundary. It's often called like the\nsmooth breaking condition.",
    "start": "416970",
    "end": "423509"
  },
  {
    "text": "So you can have these\nnice smoother trajectories that gives you fast analysis\nand nice trajectories.",
    "start": "423510",
    "end": "431470"
  },
  {
    "text": "OK, so that's the very\nquick high-level summary. Once we've looked\ninto this, we then",
    "start": "431470",
    "end": "438370"
  },
  {
    "text": "asked, well, can we smush\nthese things together. So can we take all\nof the work being",
    "start": "438370",
    "end": "444580"
  },
  {
    "text": "done on trying to\nconstruct approximations for control barrier functions? Apply some minimal, hopefully,\nrigorous dynamic programming",
    "start": "444580",
    "end": "453730"
  },
  {
    "text": "to them. And then online use this nice\nQP to trade off the controllers.",
    "start": "453730",
    "end": "459490"
  },
  {
    "text": " So that's what I\nproposed in this honor.",
    "start": "459490",
    "end": "466020"
  },
  {
    "text": "Yep, so can theory\nand tools from Hamilton-Jacobi reachability\nbe used to construct the best",
    "start": "466020",
    "end": "471780"
  },
  {
    "text": "control barrier functions? Next, can tools for quickly\napproximating control barrier",
    "start": "471780",
    "end": "478379"
  },
  {
    "text": "functions be used to initialize\nthat reachability rather than starting from that\nsigned distance function?",
    "start": "478380",
    "end": "483870"
  },
  {
    "text": "Can we start from\nsomething that's very close to the true function? And then finally, can we\nupdate these functions",
    "start": "483870",
    "end": "491310"
  },
  {
    "text": "online based on changing\nassumptions and information? The last one that\nI'm going to mention",
    "start": "491310",
    "end": "497270"
  },
  {
    "text": "is, how can we reduce\nconservativeness for unmodeled dynamics? And I'll give the\nmotivation for that soon.",
    "start": "497270",
    "end": "503360"
  },
  {
    "text": "I'm hoping to spend most of\nmy time on this and this. So first for the theory and\ntools to smush them together.",
    "start": "503360",
    "end": "511580"
  },
  {
    "text": "I'm not going to go too\nfar into the details. But the answer is yes, we can. So in reachability analysis, the\ndynamic programming that we do",
    "start": "511580",
    "end": "520159"
  },
  {
    "text": "uses something that's very\nsimilar to the Bellman equation, but for a continuous\ntime in space. It looks a little bit\nmore intimidating.",
    "start": "520159",
    "end": "526550"
  },
  {
    "text": "But this is our\nupdate that we do. You can think of this\nas the Bellman equation. The result from this\nencodes this v dot",
    "start": "526550",
    "end": "535160"
  },
  {
    "text": "is greater than or equal to 0. We realize that if we just\nmodify this Bellman equation",
    "start": "535160",
    "end": "541370"
  },
  {
    "text": "by just adding that\nterm that we want to show up into the\nconstraint, that gamma v, when we go through\nthe process, we",
    "start": "541370",
    "end": "547460"
  },
  {
    "text": "end up with 0s greater\nthan v dot plus gamma v. So we embed the constraint\nthat we want inside",
    "start": "547460",
    "end": "555720"
  },
  {
    "text": "of our construction using\ndynamic programming. So we end up with v\ndot is greater than or equal to the minus gamma v.",
    "start": "555720",
    "end": "563310"
  },
  {
    "text": "This allows us to obey that\nCBF-QP constraint with that rate gamma that makes that curve.",
    "start": "563310",
    "end": "570069"
  },
  {
    "text": "And so we can construct\na CBF-like function that encodes control\nand disturbance bounds and the maximal\ndecay rate that you want.",
    "start": "570070",
    "end": "579580"
  },
  {
    "text": "So a quick peek at some of\nthe highlights of this work. So here, we have, let's\nsay, a goal and we",
    "start": "579580",
    "end": "585540"
  },
  {
    "text": "have just one obstacle. And I'm showing the\nboundary of the safe set. So you're safe\nwhen you're outside and you're unsafe\nwhen you're inside.",
    "start": "585540",
    "end": "591882"
  },
  {
    "text": "And I'm showing a slice at the\ncurrent orientation of my robot here. If I just use my\nsafe controller,",
    "start": "591882",
    "end": "599010"
  },
  {
    "text": "it's going to run away\nfrom the obstacle. It knows nothing about the goal. It's just trying to move\nup the value of safety.",
    "start": "599010",
    "end": "607530"
  },
  {
    "text": "If I do the least\nrestrictive control instead, only activate the\nsafe controller when you're on\nthe boundary here.",
    "start": "607530",
    "end": "613470"
  },
  {
    "text": "Then I end up with something\nthat looks like this. Great, I reach my goal. But this is what my control\ntrajectory looks like.",
    "start": "613470",
    "end": "621019"
  },
  {
    "text": "If I then instead use the\nCBF-QP, I reach my goal, and I have a much smoother\ncontrol signal over time.",
    "start": "621020",
    "end": "630290"
  },
  {
    "text": "We also using this can\nlook into other benefits of using Hamilton-Jacobi\nreachability like reasoning",
    "start": "630290",
    "end": "637399"
  },
  {
    "text": "about infinite time\nversus finite time safety. So, here, I have an\nexample where there's a goal and two obstacles.",
    "start": "637400",
    "end": "643970"
  },
  {
    "text": "And these are the unsafe sets. And if I want to\nguarantee infinite safety, I cannot reach this goal.",
    "start": "643970",
    "end": "650450"
  },
  {
    "text": "So if I try to reach this\ngoal, it gets pushed away. Because if I reach the\ngoal, based on my dynamics",
    "start": "650450",
    "end": "655850"
  },
  {
    "text": "where I can't stop,\nI will inevitably end up hitting the\nobstacle afterwards.",
    "start": "655850",
    "end": "661340"
  },
  {
    "text": "If say a hybrid\nsystem where once you reach a particular goal, you\nswitch into a different state",
    "start": "661340",
    "end": "668060"
  },
  {
    "text": "space. And so you don't care\nabout what happens after you reach the goal. Then we can consider\nfinite time safety.",
    "start": "668060",
    "end": "674540"
  },
  {
    "text": "So only be safe up until\nyou reach the goal. And then we can\nactually encode that into the construction\nof this function.",
    "start": "674540",
    "end": "680720"
  },
  {
    "text": " We've also flipped this around. I mentioned that control\nbarrier functions",
    "start": "680720",
    "end": "687070"
  },
  {
    "text": "are upside-down control\nLyapunov functions. And so with some pretty\nminimal changes to the theory, we're able to construct control\nLyapunov-like functions where",
    "start": "687070",
    "end": "696360"
  },
  {
    "text": "for systems without control,\nwe can conservatively estimate the region of attraction. So here's a region of\nattraction for this system.",
    "start": "696360",
    "end": "703860"
  },
  {
    "text": "And here is what the\nreachability analysis produces for us. ",
    "start": "703860",
    "end": "711490"
  },
  {
    "text": "For systems with control,\nwe can conservatively estimate the region now of\nexponential stabilizability",
    "start": "711490",
    "end": "718000"
  },
  {
    "text": "given a desired decay rate. So if you want to\nreach a particular goal with a very high rate,\na very aggressive rate,",
    "start": "718000",
    "end": "725435"
  },
  {
    "text": "then there's a smaller region\nfrom which you can reach it than say if you use a less\naggressive rate that you",
    "start": "725435",
    "end": "730840"
  },
  {
    "text": "want to reach the goal by. And given the different\nrates that you want, we can encode what the\nappropriate function looks like.",
    "start": "730840",
    "end": "738830"
  },
  {
    "text": "And then for systems without an\nequilibrium point where you're not just stabilizing\nto one point,",
    "start": "738830",
    "end": "743980"
  },
  {
    "text": "we can stabilize to the\nsmallest control invariant set around the origin. So here for a Dubin's\ncar, a car that's",
    "start": "743980",
    "end": "750790"
  },
  {
    "text": "at a fixed speed\nwhere it can't stop. So there's no equilibrium point. Its tightest set is\none in which it's",
    "start": "750790",
    "end": "755860"
  },
  {
    "text": "doing donuts around the origin. And we can show, we can\nrecover that you get the set.",
    "start": "755860",
    "end": "761560"
  },
  {
    "text": "And you can stabilize\ndown to that donut. So we just presented\nthis in ACC.",
    "start": "761560",
    "end": "770920"
  },
  {
    "text": "And that was my very quick\nhigh-level introduction to the background here.",
    "start": "770920",
    "end": "775990"
  },
  {
    "text": "So, now, we figured\nout this step. And now, we've started expanding\ninto now can we use tools",
    "start": "775990",
    "end": "783460"
  },
  {
    "text": "from control barrier\nfunction community in order to efficiently\ninitialize this.",
    "start": "783460",
    "end": "789790"
  },
  {
    "text": "And this was led\nlargely by my student Sander who's coming to me\nfrom his master's with Marco.",
    "start": "789790",
    "end": "797080"
  },
  {
    "text": "So thank you, Marco. The motivation here is\nsomething like this paper",
    "start": "797080",
    "end": "803830"
  },
  {
    "text": "from my colleague\nSicun Gao at UCSD, where there's a lot of\ninterest in developing",
    "start": "803830",
    "end": "809860"
  },
  {
    "text": "these data-driven control\nbarrier functions. So you gather a bunch of\ntrajectories information",
    "start": "809860",
    "end": "815560"
  },
  {
    "text": "on what's safe and unsafe. And you try to fit\nusing a neural network. That function, that\nencodes positive is safe,",
    "start": "815560",
    "end": "822795"
  },
  {
    "text": "and negative is unsafe,\nand the gradient points you in the direction of safety. This is great because it's\nmuch more scalable and doing",
    "start": "822795",
    "end": "829800"
  },
  {
    "text": "brute-force dynamic programming. But you end up with\nregions that do not satisfy",
    "start": "829800",
    "end": "835399"
  },
  {
    "text": "all of these constraints. When you use those regions\nas counterexamples, then in continue training, then\nyou refit your function and test",
    "start": "835400",
    "end": "843230"
  },
  {
    "text": "again. And eventually, you\nmay get to a point where each time you\nrefit your function. You may recover safety for those\ninitial parts that were unsafe,",
    "start": "843230",
    "end": "852230"
  },
  {
    "text": "but introduce new\nregions that are now unsafe because of each\ntime that you fit it, you get something\nslightly different.",
    "start": "852230",
    "end": "858350"
  },
  {
    "text": "So, eventually, you\nmay get to the point where you have something\nlike this in this paper. All of the green\ntrajectories stay safe.",
    "start": "858350",
    "end": "865370"
  },
  {
    "text": "And all the orange trajectories\nhighlight the regions where the barrier was leaky at\nthe boundary of the safe set.",
    "start": "865370",
    "end": "872660"
  },
  {
    "text": "People from formal methods,\nlike my colleague Sicun Gao can identify the regions where they\ncan formally guarantee this",
    "start": "872660",
    "end": "880040"
  },
  {
    "text": "and the regions\nwhere they cannot. And so can we use\nthat information to seed our\nreachability analysis,",
    "start": "880040",
    "end": "886760"
  },
  {
    "text": "that painful dynamic\nprogramming method? So enter my student Sander.",
    "start": "886760",
    "end": "892170"
  },
  {
    "text": "Here he shows an\nexample where he's using one of these\ndata-driven control barrier functions as a safety filter.",
    "start": "892170",
    "end": "898860"
  },
  {
    "text": "And he, for example, if you're\ntrying to reach this goal, this particular function is\ntoo aggressive in its safety.",
    "start": "898860",
    "end": "906480"
  },
  {
    "text": "So it keeps you from being\nable to reach the goal. If you want to reach\nthis particular goal, you actually end up\nviolating safety here.",
    "start": "906480",
    "end": "913860"
  },
  {
    "text": "So that function was\ninvalid the safety filter.  If we use that as\nour initialization",
    "start": "913860",
    "end": "921570"
  },
  {
    "text": "for Hamilton-Jacobi\nreachability, we find that if we\nstart with a set that's",
    "start": "921570",
    "end": "926940"
  },
  {
    "text": "too conservative, a\nfunction that describes a safe region that's\ntoo conservative, each iteration will maintain or\nimprove the conservativeness.",
    "start": "926940",
    "end": "937550"
  },
  {
    "text": "If we start with\nsomething that's unsafe, each iteration of\nreachability will provide",
    "start": "937550",
    "end": "943610"
  },
  {
    "text": "something that is safer. So when he plugged in that\ndata-driven control barrier",
    "start": "943610",
    "end": "952510"
  },
  {
    "text": "function, and we\ndid this analysis, and we continued to operate\nthe dynamic programming until convergence, we ended\nup with a safety filter",
    "start": "952510",
    "end": "960190"
  },
  {
    "text": "that did this, for example. Managed to maintain safety\nand also increase performance",
    "start": "960190",
    "end": "967270"
  },
  {
    "text": "compared to the\noriginal approximation.",
    "start": "967270",
    "end": "972570"
  },
  {
    "text": "So he presented this\nat IROS last year. The initialization can\ncome from, for example,",
    "start": "972570",
    "end": "978300"
  },
  {
    "text": "an analytic CBF for a\ndifferent problem formulation. So, for example, one\nthat has no input bounds, or slightly different\ndynamics, or constraint set.",
    "start": "978300",
    "end": "986370"
  },
  {
    "text": "It can come from an\ninvalid control barrier function that's paired with\na backup control policy. This is something that's\npopular in the CBF field",
    "start": "986370",
    "end": "993389"
  },
  {
    "text": "where if you have a function\nthat you know is wrong, if you have some backup\npolicy like break early",
    "start": "993390",
    "end": "1000128"
  },
  {
    "text": "because you know\nthat the function is wrong in these\nregions, then you can slap that backup policy onto an\naddition to your safety filter.",
    "start": "1000128",
    "end": "1008840"
  },
  {
    "text": "We can actually now\nembed that policy into the construction\nof the function itself.",
    "start": "1008840",
    "end": "1015230"
  },
  {
    "text": "And it can also come from\ndata-driven control barrier functions. This is nice.",
    "start": "1015230",
    "end": "1020810"
  },
  {
    "text": "The convergence is\nmuch faster than with standard\nHamilton-Jacobi reachability because we're starting\nwith something",
    "start": "1020810",
    "end": "1026689"
  },
  {
    "text": "closer to the true solution. But each iteration is\nstill over a global grid of the state space.",
    "start": "1026690",
    "end": "1032579"
  },
  {
    "text": "So in this particular work, we\nwere still updating everywhere at every instant in time.",
    "start": "1032579",
    "end": "1038049"
  },
  {
    "text": "And so it still was a\nvery tedious process. So, now, we're asking\nwell, again, Sicun",
    "start": "1038050",
    "end": "1044310"
  },
  {
    "text": "was able to show in these\nregions, everything's fine. And maybe in these regions, I\ndon't really care that much.",
    "start": "1044310",
    "end": "1051000"
  },
  {
    "text": "It's not on the\nboundary of safety. The important regions are\nreally around these areas",
    "start": "1051000",
    "end": "1056280"
  },
  {
    "text": "that he's identified\nbeing leaky. So our current work is on taking\none of these approximations",
    "start": "1056280",
    "end": "1063990"
  },
  {
    "text": "along with that information of\nwhat cannot be certified to be guaranteed to be safe. And this example\nhere is our function.",
    "start": "1063990",
    "end": "1072059"
  },
  {
    "text": "And here is the 2D\nslice at 0, where you go from safe to unsafe.",
    "start": "1072060",
    "end": "1078810"
  },
  {
    "text": "And we're highlighting the\npoints that Sicun's students cannot guarantee obeys\nthe CBF constraint.",
    "start": "1078810",
    "end": "1088320"
  },
  {
    "text": "We then use reachability\nanalysis in this region locally.",
    "start": "1088320",
    "end": "1093929"
  },
  {
    "text": "And reason about what\nregions of the space need to be active currently\nand need to be updated.",
    "start": "1093930",
    "end": "1103820"
  },
  {
    "text": "And we adjust the function and\nthe corresponding zero level set accordingly. ",
    "start": "1103820",
    "end": "1112190"
  },
  {
    "text": "Doing this, we can either\nfind the barrier function",
    "start": "1112190",
    "end": "1117740"
  },
  {
    "text": "associated with the trained\nneural control policy. So if you trained\na control policy, you don't want to modify it.",
    "start": "1117740",
    "end": "1124220"
  },
  {
    "text": "And you just want to know\nwhat is the region in which this control policy is safe. We can identify that.",
    "start": "1124220",
    "end": "1130190"
  },
  {
    "text": "Or if you're willing to let us\nmess with your control policy, we can then tweak\nit at this boundary",
    "start": "1130190",
    "end": "1136940"
  },
  {
    "text": "and say really you should\noverride your policy and use in this region and you\ncan maintain safety better.",
    "start": "1136940",
    "end": "1142460"
  },
  {
    "text": "So we can update the control\npolicy along the boundary to define the control barrier. We call it value function\nwith the largest safe subset",
    "start": "1142460",
    "end": "1149480"
  },
  {
    "text": "of the initial safe\nset approximation. ",
    "start": "1149480",
    "end": "1154880"
  },
  {
    "text": "Here's the slice of the\ndata-driven control barrier function. The safe set in green\nagain are the trajectories",
    "start": "1154880",
    "end": "1161480"
  },
  {
    "text": "that maintain safety and red\nare the ones that did not. Here's what happens\nafter we patched it.",
    "start": "1161480",
    "end": "1167150"
  },
  {
    "text": "Notice that we do have\nstill a few trajectories that end up leaving. We believe that this has to do\nwith the density of the grids",
    "start": "1167150",
    "end": "1174410"
  },
  {
    "text": "that we're sampling. And so we have to do\nsome adaptive sampling method in order to reduce\nthese trajectories that leave.",
    "start": "1174410",
    "end": "1183950"
  },
  {
    "text": "In terms of rolling\nout these trajectories and looking at what's\nsafe and unsafe,",
    "start": "1183950",
    "end": "1188990"
  },
  {
    "text": "if we just use the neural\nnominal policy that's used to train that\nbarrier function, so we use the same\ncontrol policy",
    "start": "1188990",
    "end": "1195470"
  },
  {
    "text": "that's used to make\nthe barrier function, then both are fairly safe. But still are\npatched one is safer.",
    "start": "1195470",
    "end": "1202700"
  },
  {
    "text": "If we use a different\ncontrol policy, just LQR. If you're just trying to\nget to a goal using LQR",
    "start": "1202700",
    "end": "1209360"
  },
  {
    "text": "and you're using this\nas a true safety filter, then the neural CBF\nis much, much worse.",
    "start": "1209360",
    "end": "1214559"
  },
  {
    "text": "It's really just directly paired\nwith its particular control policy.",
    "start": "1214560",
    "end": "1219900"
  },
  {
    "text": "Our patch CBF is much better. This local patching is\napproximately two orders",
    "start": "1219900",
    "end": "1226710"
  },
  {
    "text": "of magnitude faster than the\noriginal refined CBF work where we updated\nthe entire grid.",
    "start": "1226710",
    "end": "1232200"
  },
  {
    "text": "I say approximately\nbecause it really depends on how good\nthat initialization is. If it's really good, and we\nhave to just tweak it slightly,",
    "start": "1232200",
    "end": "1238770"
  },
  {
    "text": "then that's great. In practice, finding these\ndata-driven CBF is quite hard. And there's many,\nmany regions that",
    "start": "1238770",
    "end": "1245250"
  },
  {
    "text": "end up being questionable\nthat we have to deal with. So that's what\nwe're exploring now.",
    "start": "1245250",
    "end": "1252600"
  },
  {
    "text": "And then the next\nplan is, can we update these online\nbased on changing assumptions and information?",
    "start": "1252600",
    "end": "1258210"
  },
  {
    "text": "This is now the next\nstep for Sander. I pointed him towards\ndoing experiments. We're just now starting to\nhe has one master's student",
    "start": "1258210",
    "end": "1265710"
  },
  {
    "text": "over the summer started getting\nour Ross platform up and running with our motion capture. To start some\ninitial stuff, we're",
    "start": "1265710",
    "end": "1271320"
  },
  {
    "text": "now expanding into using more\nvehicles, aerial vehicles, et cetera.",
    "start": "1271320",
    "end": "1276690"
  },
  {
    "text": "We also starting collaborations\nwith Nikolay Atanasov and Jorge Cortes.",
    "start": "1276690",
    "end": "1281850"
  },
  {
    "text": "Because all of my\nwork up until now is assumed perfect\nstate information. So assume that I\ncan instantaneously",
    "start": "1281850",
    "end": "1287970"
  },
  {
    "text": "get exactly the information\nabout the state of my system and the state of the\nobstacles in the world.",
    "start": "1287970",
    "end": "1294480"
  },
  {
    "text": "Fortunately, I sit right next to\nprofessors that do not do that. And so we're going to\nincorporate with their work",
    "start": "1294480",
    "end": "1300545"
  },
  {
    "text": "on control barrier\nfunctions that are robust to measurement\nerrors in the perception-based navigation.",
    "start": "1300545",
    "end": "1307410"
  },
  {
    "text": "And then Sicun and I are\ninterested in applying this to Henrik's robot.",
    "start": "1307410",
    "end": "1312850"
  },
  {
    "text": "So Henrik is the director\nof our robotics institute. And he has this fleet of both\nground robots, aerial robots,",
    "start": "1312850",
    "end": "1318850"
  },
  {
    "text": "but also golf carts,\nautonomous golf carts that he wants to\ndrive around campus and not hit students with.",
    "start": "1318850",
    "end": "1324760"
  },
  {
    "text": "And he said that if\nwe get this working, we can try playing around with\nnot hitting students, hopefully.",
    "start": "1324760",
    "end": "1331660"
  },
  {
    "text": "And so we're very excited about\nmoving into this direction. The problem is when you're\ndealing with people now,",
    "start": "1331660",
    "end": "1340120"
  },
  {
    "text": "you have to deal with either\nhow do you model these people.",
    "start": "1340120",
    "end": "1345309"
  },
  {
    "text": "In control, we typically\nassume worst-case analysis. So assume that all humans\nmight be trying to run at you",
    "start": "1345310",
    "end": "1352150"
  },
  {
    "text": "and throw themselves in\nfront of you at all times. On the learning side\nof things, we typically",
    "start": "1352150",
    "end": "1357850"
  },
  {
    "text": "just do a bunch of\ntraining and then hope that the people\nonline in the real world",
    "start": "1357850",
    "end": "1363027"
  },
  {
    "text": "behave the same way as the\npeople in the training. And so how do we deal\nwith modeling humans?",
    "start": "1363027",
    "end": "1368962"
  },
  {
    "text": "You got question? If you hit a student, do you\nhave to pay their tuition? That's a good question. I have no idea how\nHenrik gets away",
    "start": "1368962",
    "end": "1375370"
  },
  {
    "text": "with this in terms of\nthe IRB and all of that. So that's a lot. That's my screen here.",
    "start": "1375370",
    "end": "1381070"
  },
  {
    "text": "That's a lot of why I am\neager to just hop on board and let him handle this stuff.",
    "start": "1381070",
    "end": "1390070"
  },
  {
    "text": "Anyway, so this is\nwhat I mean about-- I'm coming from\nthe control side.",
    "start": "1390070",
    "end": "1396190"
  },
  {
    "text": "So I'm used to doing\nthis worst-case modeling. And I really don't want to\ndeal with that conservativeness because then you end\nup with the freezing",
    "start": "1396190",
    "end": "1402040"
  },
  {
    "text": "the robot situation where it's\nafraid of every single person on campus and\ndoesn't move at all.",
    "start": "1402040",
    "end": "1408779"
  },
  {
    "text": "So, yeah, this is\nthe motivation. You have a robot. You want it to be able to\nget through to other people.",
    "start": "1408780",
    "end": "1415360"
  },
  {
    "text": "One thing that we\ndo within control is using these safety\nfunctions is that we consider pairwise collision avoidance.",
    "start": "1415360",
    "end": "1421600"
  },
  {
    "text": "So we just slap down\none of these functions on each human that\njust says, OK,",
    "start": "1421600",
    "end": "1427000"
  },
  {
    "text": "what are the safe\nactions that will avoid entering this unsafe set\nwith respect to this one,",
    "start": "1427000",
    "end": "1432010"
  },
  {
    "text": "this one, this one? You consider them\ncompletely independently. And then you say\nI want to minimize",
    "start": "1432010",
    "end": "1437590"
  },
  {
    "text": "the difference between\nmy desired control subject to obeying the\nsafe actions with respect",
    "start": "1437590",
    "end": "1443200"
  },
  {
    "text": "to each person. Note, you can also take the\npointwise men to make one CBF.",
    "start": "1443200",
    "end": "1449440"
  },
  {
    "text": "Though, you may have some\ndifferentiability issues. There's a problem\nthough with doing that.",
    "start": "1449440",
    "end": "1454780"
  },
  {
    "text": "So analytical or dynamic\nprogramming-based control barrier functions for\npairwise collision avoidance",
    "start": "1454780",
    "end": "1460630"
  },
  {
    "text": "tend to assume that the\nactions of other agents are all equally likely. This is the worst-case\nanalysis that I mentioned.",
    "start": "1460630",
    "end": "1466179"
  },
  {
    "text": "So if I'm assuming that any\nhuman might go anywhere at once, then I have this\nhuge unsafe set.",
    "start": "1466180",
    "end": "1472130"
  },
  {
    "text": "And the robot has to take very,\nvery conservative behavior. Data-driven control\nbarrier functions,",
    "start": "1472130",
    "end": "1478730"
  },
  {
    "text": "the stuff that\nSicun's dealing with, are very sensitive to\nthe training environment and may not be representative\nin other environments.",
    "start": "1478730",
    "end": "1484880"
  },
  {
    "text": "So as an extreme\nillustration, let's say, you train in an environment\nwith just one person,",
    "start": "1484880",
    "end": "1490549"
  },
  {
    "text": "and so you ended\nup with a safe set that pretty much said just\ndon't go in front of the person. They tend to walk\nin straight lines.",
    "start": "1490550",
    "end": "1497330"
  },
  {
    "text": "Now, if you were to test on an\nenvironment with two people, now you assume that these people\nare completely independent",
    "start": "1497330",
    "end": "1504500"
  },
  {
    "text": "and therefore can walk\nthrough each other. And so the unsafe sets will\nlook something like this. And you say, great, they\nwill walk through each other.",
    "start": "1504500",
    "end": "1511310"
  },
  {
    "text": "And I can take this\ntrajectory right nearby them. And clearly, we did not capture\nsome of the interaction effects",
    "start": "1511310",
    "end": "1518270"
  },
  {
    "text": "that happen between humans\nby training on just one. Again, extreme example. But to illustrate.",
    "start": "1518270",
    "end": "1525260"
  },
  {
    "text": "So the core issue\nhere is that I want to maintain these\nindependent control barrier",
    "start": "1525260",
    "end": "1530610"
  },
  {
    "text": "functions for scaling reasons. Being able to just see a\nhuman slap down a function, see a human slap down\nfunction is great",
    "start": "1530610",
    "end": "1536210"
  },
  {
    "text": "because I don't have to think\nabout their joint dynamics and reason about the\njoint state space.",
    "start": "1536210",
    "end": "1542390"
  },
  {
    "text": "But I also want to encode\ninteraction effects, which seems like by\ndefinition, you have",
    "start": "1542390",
    "end": "1547820"
  },
  {
    "text": "to reason about joint things. So are these two desires\ncompletely at odds? I thought yes.",
    "start": "1547820",
    "end": "1554120"
  },
  {
    "text": "Sicun said no. And he proposed this idea.",
    "start": "1554120",
    "end": "1559440"
  },
  {
    "text": "So let's imagine that\nyou're this robot in this dense environment. You know that it's\na dense environment, but you're only\nfocusing on one person.",
    "start": "1559440",
    "end": "1566600"
  },
  {
    "text": "And you see that they're moving. And you reason, can\nI safely move forward",
    "start": "1566600",
    "end": "1571730"
  },
  {
    "text": "given how they're moving? Well, yes, probably, they're\ngoing to keep moving straight. If instead you see that\nthis person suddenly",
    "start": "1571730",
    "end": "1579050"
  },
  {
    "text": "makes a turn, knowing that\nyou're in a dense crowd, you could probably\ninfer that they're",
    "start": "1579050",
    "end": "1584900"
  },
  {
    "text": "making this turn because\nthere is some interaction effect that's happening\nwith another human.",
    "start": "1584900",
    "end": "1590150"
  },
  {
    "text": "And therefore, taking\nthat path is not safe. Instead of explicitly\ndoing all this reasoning,",
    "start": "1590150",
    "end": "1596600"
  },
  {
    "text": "if we trained in an environment\nwith multiple people,",
    "start": "1596600",
    "end": "1601900"
  },
  {
    "text": "then we could encode these\ninteraction effects implicitly just by crashing when you\ncrash into the second person",
    "start": "1601900",
    "end": "1608410"
  },
  {
    "text": "and you mark that as\nunsafe, you eventually learn that when this\nperson moves this way,",
    "start": "1608410",
    "end": "1613450"
  },
  {
    "text": "you probably shouldn't\nmove straight. So the idea is to\ntrain an environment with multiple agents,\nbut only measure",
    "start": "1613450",
    "end": "1620200"
  },
  {
    "text": "the current and a little\nbit of history of one agent.",
    "start": "1620200",
    "end": "1625399"
  },
  {
    "text": "Keep track of what age actions\nlead to collision versus safety with anybody and use this to\ntrain a pairwise collision",
    "start": "1625400",
    "end": "1633290"
  },
  {
    "text": "control barrier function. We call this idea sequential\nneural CBF where the training",
    "start": "1633290",
    "end": "1642080"
  },
  {
    "text": "procedure now is we're going to\nuse trajectory samples to get a rough landscape of the\ncontrol barrier function.",
    "start": "1642080",
    "end": "1647929"
  },
  {
    "text": "And then we're going to\nre-sample around the boundary of the safe set to refine it. And I'll show you what I\nmean by that in a second.",
    "start": "1647930",
    "end": "1656330"
  },
  {
    "text": "So the training procedure is\nwe have a loss function that encodes that, first,\nthe value of safe state",
    "start": "1656330",
    "end": "1663050"
  },
  {
    "text": "should be positive. So this penalizes if the value\nof certain states that are safe",
    "start": "1663050",
    "end": "1669440"
  },
  {
    "text": "is negative. We're here. This is the agent state, this\nis the human state sequence.",
    "start": "1669440",
    "end": "1674600"
  },
  {
    "text": "And this gives us\nan error margin. So I sum this up over all of the\nstates that are in the safe set",
    "start": "1674600",
    "end": "1682010"
  },
  {
    "text": "and ensure that if any of\nthem are marked as negative, that that's encoded\nin the loss function.",
    "start": "1682010",
    "end": "1688159"
  },
  {
    "text": "Vice versa, the value of unsafe\nstates should be negative. So, now, we have that we're\nsumming over the unsafe set.",
    "start": "1688160",
    "end": "1694910"
  },
  {
    "text": "And we took out the\nnegative sign here. And then finally,\nthe gradient should obey that CBF-QP condition\nwith that gamma term.",
    "start": "1694910",
    "end": "1702110"
  },
  {
    "text": "Whereas we approach\nthe boundary of safety, we have to act more safely.",
    "start": "1702110",
    "end": "1707330"
  },
  {
    "text": "So it's just those three\nterms in the loss function. We take the agent state and the\nagent obstacle relative states,",
    "start": "1707330",
    "end": "1713660"
  },
  {
    "text": "throw that through\nan MLP and LSTM, and end up with this\nbarrier function conditioned on the relative state\nand that history.",
    "start": "1713660",
    "end": "1721560"
  },
  {
    "text": "This is what it looks like. These are the two\ndifferent steps. This is the initial stage, and\nthis is the refining stage.",
    "start": "1721560",
    "end": "1728429"
  },
  {
    "text": "Here in red is the average\npath length to the goal. And in blue is the collision\nrate over training time.",
    "start": "1728430",
    "end": "1734789"
  },
  {
    "text": " For the training and testing set\nup in simulation and in person,",
    "start": "1734790",
    "end": "1741865"
  },
  {
    "text": "for the simulation\nenvironments, the training is performed with\nsix human pedestrians using ORCA for the policy.",
    "start": "1741865",
    "end": "1749530"
  },
  {
    "text": "And then for\nexperiments, the training is performed with two human\npedestrians using grad students.",
    "start": "1749530",
    "end": "1755740"
  },
  {
    "text": "For evaluation, we randomly\ninitialize the robot-human and goal configurations\nin denser environments.",
    "start": "1755740",
    "end": "1761560"
  },
  {
    "text": "And if at any point\nin the trajectory, the robot collides with a human\nor cannot find a safe control",
    "start": "1761560",
    "end": "1767380"
  },
  {
    "text": "action, then we consider that\nfull trajectory of failure. So if there's any\nfeasibility issues, we consider that a failure.",
    "start": "1767380",
    "end": "1775140"
  },
  {
    "text": "How we compose this online is\nthe same way as we said before, where every time we\nsee a human, I just",
    "start": "1775140",
    "end": "1780179"
  },
  {
    "text": "slap down one of these\nbarrier functions. And then I say minimize the\ndifference between my desired",
    "start": "1780180",
    "end": "1786480"
  },
  {
    "text": "control and the control\nthat's required to satisfy all the safety constraints.",
    "start": "1786480",
    "end": "1792570"
  },
  {
    "text": "So I'm still treating these\ncompletely independently in terms of how I'm\nreasoning online.",
    "start": "1792570",
    "end": "1798480"
  },
  {
    "text": "So these are the level\nsets of these functions that were slapped down\nby the grad student.",
    "start": "1798480",
    "end": "1805710"
  },
  {
    "text": "But the hope is that in\nthe shape of the function, I am implicitly capturing\nthese interaction effects.",
    "start": "1805710",
    "end": "1812610"
  },
  {
    "text": "These are some baselines\nthat we compare to. First sampling-based\npotential field methods.",
    "start": "1812610",
    "end": "1818400"
  },
  {
    "text": "So here we're using\npotential fields, which are like control barrier\nfunctions without dynamics. We have repulsive fields\naround each obstacle",
    "start": "1818400",
    "end": "1825090"
  },
  {
    "text": "and attractive fields\naround the goal based on Euclidean distance. In each step, we sample\nactions and evaluate",
    "start": "1825090",
    "end": "1830130"
  },
  {
    "text": "the predicted next\nstates of those actions. We have a gradient-based\nversion of that where the control is\nbased on the gradients",
    "start": "1830130",
    "end": "1835928"
  },
  {
    "text": "of the potential field. We compare to a black box\nmulti-agent control barrier function. So this is just using our normal\ndata-driven control barrier",
    "start": "1835928",
    "end": "1843850"
  },
  {
    "text": "function. Here, we're using\nthe max pooling layer in order to deal with extra\npeople in the environment.",
    "start": "1843850",
    "end": "1853420"
  },
  {
    "text": "We compare also to a\nsampling-based model predictive control\nwhere we learn a neural dynamics\nmodel and then unroll",
    "start": "1853420",
    "end": "1858820"
  },
  {
    "text": "it online to generate\na tree of future states and select the action that leads\nto the best-predicted outcome.",
    "start": "1858820",
    "end": "1863980"
  },
  {
    "text": "And then we also compare\nit to PPO and DQN. First, let's look\nat just these three.",
    "start": "1863980",
    "end": "1869680"
  },
  {
    "text": "So here's using a robot that's\na double integrator, a bicycle, and a Dubin's car.",
    "start": "1869680",
    "end": "1875950"
  },
  {
    "text": "In blue is our method. In orange and green and red\nare these appropriate methods.",
    "start": "1875950",
    "end": "1881470"
  },
  {
    "text": "And you see that\nour method scales, even though we trained\nin just six people",
    "start": "1881470",
    "end": "1886600"
  },
  {
    "text": "as we go up to 600 people\nin the same environment, our method tends to avoid\ncollision much better",
    "start": "1886600",
    "end": "1893559"
  },
  {
    "text": "than these other methods. We can keep the collision rate\nunder 10% when scaling to 60",
    "start": "1893560",
    "end": "1899160"
  },
  {
    "text": "times denser environments. And the collision\nonly reaches 15% in a bicycle model case\nwith 100 time denser",
    "start": "1899160",
    "end": "1906450"
  },
  {
    "text": "environment than the training. I note that the gap in\nsafety is more significant when the robot has more\ncomplicated dynamics,",
    "start": "1906450",
    "end": "1913409"
  },
  {
    "text": "such as the non-holonomic\nDubin's car we're actually embedding the\ndynamics of the robot into the construction of\nthis function is important.",
    "start": "1913410",
    "end": "1920760"
  },
  {
    "text": " Here's an example of\nwhere this works well.",
    "start": "1920760",
    "end": "1927240"
  },
  {
    "text": "Here, we have a narrow\ncorridor situation where two humans are\npassing by each other.",
    "start": "1927240",
    "end": "1932400"
  },
  {
    "text": "If you're using\npotential field methods, then just following\nthe gradient directly ends up causing the robot to\nturn and actually collide.",
    "start": "1932400",
    "end": "1941340"
  },
  {
    "text": "Whereas here,\nlooking at the level sets of the control\nbarrier function, you see that the robot is able\nto navigate through the space",
    "start": "1941340",
    "end": "1948090"
  },
  {
    "text": "by looking at the\nhistory of the agents. So here's what the\nbicycle and with the car.",
    "start": "1948090",
    "end": "1954690"
  },
  {
    "text": "Note that the CBF that encodes\nthe bicycle dynamics has a wider gap between level sets\na.k.a. a steeper gradient.",
    "start": "1954690",
    "end": "1961860"
  },
  {
    "text": "Reflecting the need to initiate\ncollision avoidance much farther away from the obstacles because\nof the dynamics of the system.",
    "start": "1961860",
    "end": "1970410"
  },
  {
    "text": "OK, let's compare it to MPC. So standard MPC requires the\nuse of analytic dynamics.",
    "start": "1970410",
    "end": "1976710"
  },
  {
    "text": "So both the ego\nrobot and the humans. And so we can't just\nthrow MPC into this",
    "start": "1976710",
    "end": "1982200"
  },
  {
    "text": "without modifying it somewhat. So, instead, that's why we\nfind that neural dynamics.",
    "start": "1982200",
    "end": "1987270"
  },
  {
    "text": "And then we roll it out. We sample actions\nand forward predict the future states, 10 or 100.",
    "start": "1987270",
    "end": "1993360"
  },
  {
    "text": "And then select actions based\non the potential field values of those predicted states. And we also consider the case\nwhere the sampling-based model",
    "start": "1993360",
    "end": "2000740"
  },
  {
    "text": "predictive control has access to\nthe true dynamics of the human. So we tell it exactly\nwhat the humans are going to do and allow it to do MPC.",
    "start": "2000740",
    "end": "2007190"
  },
  {
    "text": "This is in order to get like a\nbaseline, an oracle in a way. Because you can imagine if\nthere's 600 people in a space.",
    "start": "2007190",
    "end": "2012950"
  },
  {
    "text": "Perhaps, there does not exist\na safe path to your goal. So that one where we give\nthe MPC access to what",
    "start": "2012950",
    "end": "2019850"
  },
  {
    "text": "the humans really are doing. This is what the curve\nlooks like there. Here's where the other\nsampling-based methods.",
    "start": "2019850",
    "end": "2025610"
  },
  {
    "text": "And then here's ours. We think that ours work better\nhere because it does not",
    "start": "2025610",
    "end": "2030720"
  },
  {
    "text": "require multi-step unrolling\nand it avoids the accumulation of model prediction\nerrors that are",
    "start": "2030720",
    "end": "2036030"
  },
  {
    "text": "inherent in the learned\nmodels of dynamics. ",
    "start": "2036030",
    "end": "2041290"
  },
  {
    "text": "And then finally,\nthere's so many baselines that we compare\nto because it kept getting rejected from\nmachine learning conferences.",
    "start": "2041290",
    "end": "2046980"
  },
  {
    "text": "So we just kept\nadding more baselines. So let's do now PPO and DQN.",
    "start": "2046980",
    "end": "2052260"
  },
  {
    "text": "So here, again, we\ntrain in environment with six tested on 600.",
    "start": "2052260",
    "end": "2058440"
  },
  {
    "text": "And actually, in\neach of these cases, we use the action produced by\nPPO or DQN as the nominal action",
    "start": "2058440",
    "end": "2065129"
  },
  {
    "text": "that we want to use in our QP. So we say try to\nfollow this action and just override it\nif you need safety.",
    "start": "2065130",
    "end": "2071879"
  },
  {
    "text": "And we're able to deal\nwith denser environments because we made our method\nbetter at scaling than just",
    "start": "2071880",
    "end": "2080280"
  },
  {
    "text": "standard training. And then we have a little\ninitial hardware demo. We now moved into our\nfancy new building.",
    "start": "2080280",
    "end": "2086969"
  },
  {
    "text": "And so I have a lot\nmore room to play around with and all of Henrik's toys. But for the initial one in\nthis small temporary lab space,",
    "start": "2086969",
    "end": "2094500"
  },
  {
    "text": "we have the training\nwith two people. Ignore the person\ncarrying the battery. That was just the\nbattery holder.",
    "start": "2094500",
    "end": "2102460"
  },
  {
    "text": "And the robot is\ntrying to get along this path is what its\ndesired reference is.",
    "start": "2102460",
    "end": "2109427"
  },
  {
    "text": "And then we test this in an\nenvironment with more people note again because it's\na small environment. The people have to move\nawkwardly around each other.",
    "start": "2109427",
    "end": "2117369"
  },
  {
    "text": "So we really want to\ndo this differently. And now that we have more room. So we're trying to follow\nagain the same path.",
    "start": "2117370",
    "end": "2124300"
  },
  {
    "text": "And you see that\noften here, the robot has to deviate quite\na bit from that path in order to gain safety\nwith respect to the people.",
    "start": "2124300",
    "end": "2132069"
  },
  {
    "text": "Here are the people were told\nto look up and not look down at the robot at all and just\ninteract with each other.",
    "start": "2132070",
    "end": "2139690"
  },
  {
    "text": "This is an assumption that\nwe're making in general in order to help with data augmentation\nthat humans do not react to the robot, which is\na silly assumption that we're",
    "start": "2139690",
    "end": "2147100"
  },
  {
    "text": "trying to now tackle. OK, so in summary, we exploit\nthe important observation",
    "start": "2147100",
    "end": "2153970"
  },
  {
    "text": "that the spatial interaction\npatterns of multiple obstacles can be decomposed and predicted\nthrough sequential modeling",
    "start": "2153970",
    "end": "2159250"
  },
  {
    "text": "of individual obstacles. So we can take\nspatial interaction and instead encode that\nas temporal information.",
    "start": "2159250",
    "end": "2167859"
  },
  {
    "text": "We design these models that\nincorporate sequential modeling of individual\nobstacles so they can be composed in environments with\nan arbitrary number of obstacles",
    "start": "2167860",
    "end": "2174558"
  },
  {
    "text": "online. Next, we want to do our\nlarger-scale experimental validation and some analysis\nof the probabilistic safety",
    "start": "2174558",
    "end": "2180490"
  },
  {
    "text": "properties of the methods\nunder certain assumptions on the environments. We just presented this at\nIROS and actually then won",
    "start": "2180490",
    "end": "2187360"
  },
  {
    "text": "the RoboCup Best Paper Award. So, I guess, keep getting\nyour things rejected from machine learning things.",
    "start": "2187360",
    "end": "2193150"
  },
  {
    "text": "Build up all your baselines, and\nthen submit to robotics, seems like a pretty good strategy.",
    "start": "2193150",
    "end": "2199480"
  },
  {
    "text": "I don't know. But it turned into a\npretty good paper, I think. And consider other\ninformation that we",
    "start": "2199480",
    "end": "2205510"
  },
  {
    "text": "can encode into the\ncontrol barrier function. So that's the pitch\nthat I told ONR.",
    "start": "2205510",
    "end": "2213620"
  },
  {
    "text": "And that's the things that\nwe have been working on. I went to again highlight my\nPhD students, my undergraduate,",
    "start": "2213620",
    "end": "2220220"
  },
  {
    "text": "and master's students,\nand all my collaborators for this particular project. The Green Thrust was done by\nstudents Jason and Donggan",
    "start": "2220220",
    "end": "2230720"
  },
  {
    "text": "and their advisors Kaushal and\nClaire at Berkeley with me. And then my student\nZheng did the extension",
    "start": "2230720",
    "end": "2237710"
  },
  {
    "text": "to control Lyapunov\nfunctions along with my TA who is a\nstudent of Tom Bewley. For the second one,\nquickly approximating CBFs",
    "start": "2237710",
    "end": "2245810"
  },
  {
    "text": "and use that for initialization,\nmy student Sander and Alex who's now at Brain Corp worked\non that along with Sicun",
    "start": "2245810",
    "end": "2252650"
  },
  {
    "text": "Gao and his students updating\nthese online based on changing assumptions and information.",
    "start": "2252650",
    "end": "2258440"
  },
  {
    "text": "Sander is now guiding a team\nof undergraduate and master's students for doing\nexperiments now",
    "start": "2258440",
    "end": "2264350"
  },
  {
    "text": "that we've moved into our space. And for reducing\nthe conservativeness for unmodeled\ndynamics, that's work",
    "start": "2264350",
    "end": "2270090"
  },
  {
    "text": "with Sicun and his students. And with that, I am done\nand happy to talk now",
    "start": "2270090",
    "end": "2275475"
  },
  {
    "text": "in about questions and\ncomments and concerns. If we don't get to all\nof these things for you, my email is very\neasy to remember.",
    "start": "2275475",
    "end": "2282060"
  },
  {
    "text": "It's sherbert or\nsherbert@ucsd.edu. And with that, I am done.",
    "start": "2282060",
    "end": "2287190"
  },
  {
    "text": "Thank you. [APPLAUSE] ",
    "start": "2287190",
    "end": "2296734"
  },
  {
    "text": "This is time for questions. So I hope you'll get some. What are the steps\nyou have to take?",
    "start": "2296735",
    "end": "2303200"
  },
  {
    "text": "And are there any\nunique steps you have to take to\ndiscretize the CBF HJR",
    "start": "2303200",
    "end": "2309740"
  },
  {
    "text": "formulation that you showed? For the patching thing? No. Way early on, I think it\nwas in the green section",
    "start": "2309740",
    "end": "2315530"
  },
  {
    "text": "or the blue section. You showed the formulation where\nyou included the CBF requirement with the HJR formulation.",
    "start": "2315530",
    "end": "2321740"
  },
  {
    "text": "But that's done in continuous\ntime when you implement it. When you implement it, you do\nit on a discretized state space.",
    "start": "2321740",
    "end": "2327350"
  },
  {
    "text": "And all this Hamilton-Jacobi\nreachability stuff is done ultimately in\na discretized state",
    "start": "2327350",
    "end": "2332480"
  },
  {
    "text": "space using dynamic\nprogramming because we have digital computers. And so, yes, there's a lot,\nboth in space and time,",
    "start": "2332480",
    "end": "2339410"
  },
  {
    "text": "you have to sample\nfinely enough. And there's work on what\nfinely enough means.",
    "start": "2339410",
    "end": "2344569"
  },
  {
    "text": "In fact, if you really want to\nbother someone, it's somewhere.",
    "start": "2344570",
    "end": "2350160"
  },
  {
    "text": "And you should track him down. ",
    "start": "2350160",
    "end": "2360560"
  },
  {
    "text": "Yeah. So really more of\nan observation. I thought it was interesting\nthat you were starting to work with real robots.",
    "start": "2360560",
    "end": "2368200"
  },
  {
    "text": "Because, of course, they\ndo have uncertain sensing, there is noise, and so on.",
    "start": "2368200",
    "end": "2373600"
  },
  {
    "text": "And you start to\nsay a little bit how you're dealing with that. And I even noticed\nin the video that you",
    "start": "2373600",
    "end": "2379990"
  },
  {
    "text": "showed at the end\nof people walking around you say, well, two people\nare walking towards each other. They want to see each other.",
    "start": "2379990",
    "end": "2386319"
  },
  {
    "text": "But even when there, isn't\nanybody coming towards you? I saw people walking\nand then just randomly",
    "start": "2386320",
    "end": "2391990"
  },
  {
    "text": "making sharp turns\nto left or right. Yeah, I don't know. Yeah, absolutely. So some of the work\nthat I did in my PhD",
    "start": "2391990",
    "end": "2398620"
  },
  {
    "text": "with Claire and\nwith Anca Dragan was on can you get away with using\nreally dumb models of humans.",
    "start": "2398620",
    "end": "2406420"
  },
  {
    "text": "And when they obey\nyour dumb models, then you have very tight\nconfidence around them. And when they act differently,\nwhatever that means,",
    "start": "2406420",
    "end": "2414250"
  },
  {
    "text": "then you degrade your\nconfidence and end up in the extreme considering\nthe worst-case example.",
    "start": "2414250",
    "end": "2420450"
  },
  {
    "text": "So how do you switch between\nlevels of confidence here? I think we'd be curious\nto incorporate something",
    "start": "2420450",
    "end": "2426080"
  },
  {
    "text": "like that in here. But there's this trade-off\nbetween how much reasoning do you want to do\nonline versus offline,",
    "start": "2426080",
    "end": "2431900"
  },
  {
    "text": "how are you reasoning\nabout uncertainty. Yeah, all of that, we're\nvery interested in. The state estimation stuff\nwe're very interested in.",
    "start": "2431900",
    "end": "2437660"
  },
  {
    "text": "There's a project with\nanother TA of mine who now comes to my\ngroup meetings, who",
    "start": "2437660",
    "end": "2443750"
  },
  {
    "text": "is interested in how do\nyou reason about what is the state that is best\nto believe you are in",
    "start": "2443750",
    "end": "2450845"
  },
  {
    "text": "in order to be robust rather\nthan the state that you're most likely to be in.",
    "start": "2450845",
    "end": "2456140"
  },
  {
    "text": "So we're exploring\nsome things like that, which has been fun\nand good for me when",
    "start": "2456140",
    "end": "2461180"
  },
  {
    "text": "I've been very much protected\nin this world of just assuming perfect information. And I'm pushing out of it.",
    "start": "2461180",
    "end": "2469190"
  },
  {
    "text": "So, on a related note,\ncould you share a bit more about how you are\nconsidering the humans",
    "start": "2469190",
    "end": "2474950"
  },
  {
    "text": "response to the robot? Yes. Yes. Thank you. So it's been forced upon me.",
    "start": "2474950",
    "end": "2480260"
  },
  {
    "text": "Because one of my\nstudents Nikhil here he's a co-advised\nby Mike Yip at UCSD",
    "start": "2480260",
    "end": "2485359"
  },
  {
    "text": "who is in surgical robotics. And he wants to do safe\nsurgical robotics which is a crazy hard thing\nfor him to want to do.",
    "start": "2485360",
    "end": "2492170"
  },
  {
    "text": "But so we're starting\noff with the rubble thing that I showed you before the\nPringles cans where we say, OK, let's not tug\non people's tissue.",
    "start": "2492170",
    "end": "2499040"
  },
  {
    "text": "But let's start with\nsome Pringles cans. You want to try to push\nthem around in order to get to the goal without\nknocking things over,",
    "start": "2499040",
    "end": "2505849"
  },
  {
    "text": "where eventually we're hoping\nto move that towards how do you tug and move around\ntissue in such a way",
    "start": "2505850",
    "end": "2511310"
  },
  {
    "text": "that you maintain safety while\ngetting towards your goal with the da Vinci robot. Anyway, he wants to\ntry porting this over",
    "start": "2511310",
    "end": "2519530"
  },
  {
    "text": "onto that situation, where now\nthe humans are Pringles cans. And we were very\nexcited about that.",
    "start": "2519530",
    "end": "2525570"
  },
  {
    "text": "And then we realized Pringles\ncans do not move independently like they literally will\nonly respond based on actions",
    "start": "2525570",
    "end": "2532010"
  },
  {
    "text": "that you take as the robot. So we actually have\nto deal with this fact that the humans and\nrobots are humans.",
    "start": "2532010",
    "end": "2537740"
  },
  {
    "text": "And robots are interacting. And so in terms of\nthe training itself,",
    "start": "2537740",
    "end": "2544010"
  },
  {
    "text": "it doesn't break\ntoo much the process of what we do at a high level. But it does change how\nwe have to gather data.",
    "start": "2544010",
    "end": "2552410"
  },
  {
    "text": "So before we would take some\nsamples of robots and human moving across the lab,\nand then post-processing,",
    "start": "2552410",
    "end": "2560390"
  },
  {
    "text": "we would ask, OK, what\nif the robot was here, or here, or here? Would it have remained safe?",
    "start": "2560390",
    "end": "2566088"
  },
  {
    "text": "And by assuming that the\nhumans ignore the robot, we can just use\nthe same recording of the human trajectories\nand be able to refine",
    "start": "2566088",
    "end": "2572990"
  },
  {
    "text": "our safe set using that. Now, we have to actually\ngather enough data with actually knocking\naround Pringles cans",
    "start": "2572990",
    "end": "2579710"
  },
  {
    "text": "in order to do that. So we're exploring a\nfew different methods for how to deal with that. And that is very much still\nin the active exploration",
    "start": "2579710",
    "end": "2587240"
  },
  {
    "text": "side of things. So people have ideas. I'd love to hear them. ",
    "start": "2587240",
    "end": "2600490"
  },
  {
    "text": "No questions.  OK, perfect.",
    "start": "2600490",
    "end": "2606099"
  },
  {
    "text": "Well, again, if you have\nany follow up thoughts, comments, questions, please\nfeel free to reach out to me.",
    "start": "2606100",
    "end": "2611109"
  },
  {
    "text": "And I'm also here for\nthe rest of the day. All right. Thanks so much. [APPLAUSE]",
    "start": "2611110",
    "end": "2617910"
  },
  {
    "start": "2617910",
    "end": "2621000"
  }
]