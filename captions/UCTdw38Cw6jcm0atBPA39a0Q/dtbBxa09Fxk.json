[
  {
    "text": "welcome I'm happy to see all of you here because we can't take that for granted",
    "start": "1140",
    "end": "9179"
  },
  {
    "text": "because I guess most of you registered on the NDC security webpage and then you",
    "start": "9179",
    "end": "14400"
  },
  {
    "text": "paid and to do that oops clicker is not working",
    "start": "14400",
    "end": "19800"
  },
  {
    "text": "to do that you'd likely sorry",
    "start": "19800",
    "end": "26119"
  },
  {
    "text": "let's try to start it again start I just had a blue screen of death five minutes ago",
    "start": "26880",
    "end": "33660"
  },
  {
    "text": "so we will um there we go so you might remember this",
    "start": "33660",
    "end": "40920"
  },
  {
    "text": "from registering and paying the check-in service that NDC is using",
    "start": "40920",
    "end": "46860"
  },
  {
    "text": "I know some years ago a friend of mine was the an event administrator of an",
    "start": "46860",
    "end": "52320"
  },
  {
    "text": "event on check-in and check-in had just redone their entire web page",
    "start": "52320",
    "end": "57899"
  },
  {
    "text": "and he realized that he could add any other check-in user to his event",
    "start": "57899",
    "end": "63359"
  },
  {
    "text": "as an event administrator and then in case they had registered something wrong he could change their",
    "start": "63359",
    "end": "69960"
  },
  {
    "text": "details like their email address what if he had found an NDC event",
    "start": "69960",
    "end": "76920"
  },
  {
    "text": "administrator and changed their email address to his own",
    "start": "76920",
    "end": "83100"
  },
  {
    "text": "he could hijack that user but if he found the NDC account administrator",
    "start": "83100",
    "end": "88860"
  },
  {
    "text": "and changed the bank account number for payouts there might not have been an NDC",
    "start": "88860",
    "end": "94680"
  },
  {
    "text": "security so",
    "start": "94680",
    "end": "101100"
  },
  {
    "text": "it's um things like that I'm going to talk about today my name is Hallberg I'm the application",
    "start": "101100",
    "end": "107520"
  },
  {
    "text": "security lead at Foresta you may not have heard about four star it's a quite new name it's a merger of",
    "start": "107520",
    "end": "114600"
  },
  {
    "text": "multiple companies one of them is confirm it which is a what was a Norwegian software",
    "start": "114600",
    "end": "121619"
  },
  {
    "text": "company that I worked for for 11 years started as a developer then moved into security",
    "start": "121619",
    "end": "128039"
  },
  {
    "text": "full time so I do scanning I do some hacking I",
    "start": "128039",
    "end": "133260"
  },
  {
    "text": "build some tools run scanners yeah and and also talk about security teach",
    "start": "133260",
    "end": "139620"
  },
  {
    "text": "security today I'm going to talk about broken",
    "start": "139620",
    "end": "145020"
  },
  {
    "text": "Access Control and it's pretty much like this door you",
    "start": "145020",
    "end": "150599"
  },
  {
    "text": "might see what's wrong this is discrimination",
    "start": "150599",
    "end": "156599"
  },
  {
    "text": "against people who can walk stairs but can't climb",
    "start": "156599",
    "end": "161760"
  },
  {
    "text": "and this is the way a lot of applications are",
    "start": "161760",
    "end": "166980"
  },
  {
    "text": "if you just try to find your way around the obstacles or the authorization",
    "start": "166980",
    "end": "173099"
  },
  {
    "text": "checks you will but you know what's really wrong here",
    "start": "173099",
    "end": "180200"
  },
  {
    "text": "you can't see it the door isn't locked and that's of course also how a lot of",
    "start": "180900",
    "end": "187680"
  },
  {
    "text": "applications are if you just do something which is not kind of what you are allowed to in the UI if you just",
    "start": "187680",
    "end": "194400"
  },
  {
    "text": "kind of start changing something and testing some other requests",
    "start": "194400",
    "end": "199800"
  },
  {
    "text": "you're suddenly allowed to bypass things",
    "start": "199800",
    "end": "204680"
  },
  {
    "text": "so broken access control is on the ovas top 10 list does anyone know which position it is in",
    "start": "205019",
    "end": "212959"
  },
  {
    "text": "in the first that's right because this is like the SQL injection node 2023",
    "start": "213120",
    "end": "221819"
  },
  {
    "text": "it's not just one thing it's a lot of different things like this list is all",
    "start": "221819",
    "end": "227159"
  },
  {
    "text": "of them so it doesn't continue below the screen this is all it's just 34 different things",
    "start": "227159",
    "end": "233040"
  },
  {
    "text": "so go tell the developers this is what you need to care about to cover the first item on the ovas top 10 lists",
    "start": "233040",
    "end": "241379"
  },
  {
    "text": "I'm gonna focus on something called idor or insecure direct object reference",
    "start": "241379",
    "end": "248340"
  },
  {
    "text": "someone tried to change to another term Bola broken object level authorization",
    "start": "248340",
    "end": "253560"
  },
  {
    "text": "it is the same thing",
    "start": "253560",
    "end": "257060"
  },
  {
    "text": "so what is authorization because we're going to talk about authorization quite a bit so authorization is the function",
    "start": "259760",
    "end": "266160"
  },
  {
    "text": "of specifying access rights or privileges to resources if you go a little further down",
    "start": "266160",
    "end": "272520"
  },
  {
    "text": "during operation the system uses the access control rules to decide whether access requests from authenticated",
    "start": "272520",
    "end": "278820"
  },
  {
    "text": "consumers shall be approved or disapproved now this is the theory in practice",
    "start": "278820",
    "end": "287940"
  },
  {
    "text": "it doesn't happen all the time as it should sometimes it's completely forgotten",
    "start": "287940",
    "end": "294360"
  },
  {
    "text": "that's luckily very few times sometimes it's just here and there but my",
    "start": "294360",
    "end": "301199"
  },
  {
    "text": "experience is that it's very common for an application to have an authorization flaw somewhere",
    "start": "301199",
    "end": "309000"
  },
  {
    "text": "now is it a good thing for a speaker to read straight from Wikipedia well I've tried to to Define",
    "start": "309000",
    "end": "315600"
  },
  {
    "text": "authorization before and being sloppy in the definition one time I held that speech one of the",
    "start": "315600",
    "end": "321720"
  },
  {
    "text": "authorities on the subject was in the audience and quickly corrected me so that's a speaker tip",
    "start": "321720",
    "end": "330300"
  },
  {
    "text": "so when you bought something you might end up with a path like this in the",
    "start": "330300",
    "end": "335460"
  },
  {
    "text": "address line and are you ever tempted to change it",
    "start": "335460",
    "end": "342680"
  },
  {
    "text": "yes me too I'm also tempted to change it when I see something like this because I",
    "start": "342680",
    "end": "348240"
  },
  {
    "text": "know that if I change this and I can see someone else's order then they can see mine",
    "start": "348240",
    "end": "355139"
  },
  {
    "text": "it works both ways and I I'm not very fond of people being",
    "start": "355139",
    "end": "360660"
  },
  {
    "text": "able to see what I bought how much I paid or anything like that and also if I go to see my profile and I",
    "start": "360660",
    "end": "368699"
  },
  {
    "text": "see something like this see like users 542.",
    "start": "368699",
    "end": "373280"
  },
  {
    "text": "and then I think why aren't they using current user why do they need to expose my user ID",
    "start": "375180",
    "end": "383300"
  },
  {
    "text": "and I might be tempted to change this one as well and here now this is the solution if you",
    "start": "384120",
    "end": "391380"
  },
  {
    "text": "want to do some basic broken Access Control testing the solution is to do",
    "start": "391380",
    "end": "396960"
  },
  {
    "text": "plus one 542-543 that's the entire Foundation of",
    "start": "396960",
    "end": "402539"
  },
  {
    "text": "this type of testing and I can promise you that if you do that in a lot of places",
    "start": "402539",
    "end": "408240"
  },
  {
    "text": "you're likely going to find something interesting I think you get the picture",
    "start": "408240",
    "end": "414440"
  },
  {
    "text": "so sometimes we can do that in the browser just change the address bar it's",
    "start": "415979",
    "end": "421500"
  },
  {
    "text": "really simple just flip a number A5 year old can do it yes even my",
    "start": "421500",
    "end": "427139"
  },
  {
    "text": "five-year-old can do it and I actually do have a five year old uh sometimes it's not that easy",
    "start": "427139",
    "end": "433080"
  },
  {
    "text": "sometimes it's a request that you don't see like to be sent from the browser like behind the scenes you it's not in",
    "start": "433080",
    "end": "440039"
  },
  {
    "text": "like a URL that you can change in the browser then you just attach a web proxy so",
    "start": "440039",
    "end": "447060"
  },
  {
    "text": "you're basically mind and middling yourself and this web proxy is like a pit stop for requests",
    "start": "447060",
    "end": "453180"
  },
  {
    "text": "you stop a request you change something you pass it on to the server you can even change things on the way back but",
    "start": "453180",
    "end": "460199"
  },
  {
    "text": "here the important thing here is that you change the request you change something for instance an ID",
    "start": "460199",
    "end": "466259"
  },
  {
    "text": "like a number still simplest part",
    "start": "466259",
    "end": "471199"
  },
  {
    "text": "okay not legal advice are you allowed to change the url",
    "start": "471840",
    "end": "478220"
  },
  {
    "text": "yeah there have been people threatened with court cases for changing a URL are you allowed to view the source of a",
    "start": "479759",
    "end": "486180"
  },
  {
    "text": "web page same thing there all that they retracted",
    "start": "486180",
    "end": "491520"
  },
  {
    "text": "that or they did never made it to court so yeah the best thing of course is to",
    "start": "491520",
    "end": "498479"
  },
  {
    "text": "have permission to test on your own system not not test another other systems",
    "start": "498479",
    "end": "504780"
  },
  {
    "text": "so to actually give some legal advice don't script",
    "start": "504780",
    "end": "510660"
  },
  {
    "text": "if you find something don't make a script to download all the data don't even make a script to estimate how",
    "start": "510660",
    "end": "518099"
  },
  {
    "text": "long it would take to download all the data and don't do it on a competitor",
    "start": "518099",
    "end": "526039"
  },
  {
    "text": "so real world example some years ago one of my colleagues",
    "start": "529080",
    "end": "534360"
  },
  {
    "text": "wanted to go on a cabin trip and he said in my area all the good cabins",
    "start": "534360",
    "end": "540000"
  },
  {
    "text": "are on this system they're not on Airbnb they are on the system that has a really",
    "start": "540000",
    "end": "545880"
  },
  {
    "text": "crappy web page it's really old or it seems old the UI is terrible it's yeah it's just terrible I bet you it has",
    "start": "545880",
    "end": "552660"
  },
  {
    "text": "security vulnerabilities the subject of the email he sent me was hack requests",
    "start": "552660",
    "end": "559140"
  },
  {
    "text": "this site is still online we try to report stuff to the owner they didn't",
    "start": "559140",
    "end": "565140"
  },
  {
    "text": "really understand the word vulnerability so I'm not going to tell you which side",
    "start": "565140",
    "end": "570420"
  },
  {
    "text": "it is but the the parts was pretty much like this so",
    "start": "570420",
    "end": "576420"
  },
  {
    "text": "this was the only thing he sent me like the URL to his cabin contract",
    "start": "576420",
    "end": "582660"
  },
  {
    "text": "so it would tell me and him like which cabin and of course all the cabins would be",
    "start": "582660",
    "end": "588060"
  },
  {
    "text": "publicly listed on this webpage but it would tell me when he had booked this cabin it would tell me his name and his phone",
    "start": "588060",
    "end": "595800"
  },
  {
    "text": "number and his home address his email address and also the name and age of everyone going on this cabin trip",
    "start": "595800",
    "end": "603720"
  },
  {
    "text": "including pets so what's the problem here I guess you",
    "start": "603720",
    "end": "608820"
  },
  {
    "text": "already guessed it because well how much can you change here and still get something interesting well you can change the number",
    "start": "608820",
    "end": "614880"
  },
  {
    "text": "so I tried a few other numbers one thing I forgot to say about the",
    "start": "614880",
    "end": "621120"
  },
  {
    "text": "legal advice do the plus one and then you stop don't like try every single number once",
    "start": "621120",
    "end": "628140"
  },
  {
    "text": "you kind of establish that you get the data you shouldn't see stop there don't",
    "start": "628140",
    "end": "633720"
  },
  {
    "text": "go on if you get some data that you think you or might be able to see okay test a few",
    "start": "633720",
    "end": "640200"
  },
  {
    "text": "more until you establish if you can see data you definitely shouldn't I tried some higher numbers and some",
    "start": "640200",
    "end": "646380"
  },
  {
    "text": "lower numbers and well I could see past and future bookings random people random",
    "start": "646380",
    "end": "652079"
  },
  {
    "text": "cabins what's the problem with that well",
    "start": "652079",
    "end": "657660"
  },
  {
    "text": "this this is in Europe it was pre-gdpr or it's no longer pretty gdpr so there",
    "start": "657660",
    "end": "663660"
  },
  {
    "text": "was a lot of personal information in there another thing is it says when you're going to be at this",
    "start": "663660",
    "end": "669899"
  },
  {
    "text": "cabin also the number of vehicles of course so in case someone wants to break into your home they know when you're gone and",
    "start": "669899",
    "end": "677279"
  },
  {
    "text": "when your guard dog is also gone which is convenient for them",
    "start": "677279",
    "end": "682880"
  },
  {
    "text": "another real world example I wasn't involved neither in this or nor the What",
    "start": "683820",
    "end": "689820"
  },
  {
    "text": "followed so this is the January 6 Insurgency and the service in question",
    "start": "689820",
    "end": "696480"
  },
  {
    "text": "was parlor not that much used or well known here it's a right wing Trump",
    "start": "696480",
    "end": "702180"
  },
  {
    "text": "supporter social media a lot of the people",
    "start": "702180",
    "end": "707360"
  },
  {
    "text": "storming the Congress two years ago used parlor posted a lot of stuff from the",
    "start": "707360",
    "end": "712980"
  },
  {
    "text": "event on parlor and right after there were rumors of",
    "start": "712980",
    "end": "718440"
  },
  {
    "text": "parlor being hacked and I remember some of those rumors and they were like yeah I think some um SMS based",
    "start": "718440",
    "end": "726000"
  },
  {
    "text": "two-factor authentication has been breached no",
    "start": "726000",
    "end": "731779"
  },
  {
    "text": "it was an either they just found some ID and they could just iterate through all the posts from",
    "start": "731779",
    "end": "739380"
  },
  {
    "text": "parlor so they scraped the data and posted it online like they said more than 99 of",
    "start": "739380",
    "end": "746880"
  },
  {
    "text": "the data from parlor but",
    "start": "746880",
    "end": "752519"
  },
  {
    "text": "you think that that's the data I was there but that was all the data that was also the deleted posts so people who",
    "start": "752519",
    "end": "759720"
  },
  {
    "text": "thought after this that oh this is a failed Coupe let's go delete well the data was still there data wasn't deleted",
    "start": "759720",
    "end": "766440"
  },
  {
    "text": "data was still accessible and it was scraped and in addition to that of course",
    "start": "766440",
    "end": "772980"
  },
  {
    "text": "images and videos included geolocation this was used in the second impeachment",
    "start": "772980",
    "end": "779399"
  },
  {
    "text": "of Donald Trump it's likely still being used in court cases today",
    "start": "779399",
    "end": "784880"
  },
  {
    "text": "so when you hear about a hack we often think it's some like black magic hacking they started with social engineering",
    "start": "784920",
    "end": "790380"
  },
  {
    "text": "then they chained three different vulnerabilities to attain remote code execution",
    "start": "790380",
    "end": "795480"
  },
  {
    "text": "no it's often so much simpler you remember the users 542",
    "start": "795480",
    "end": "802339"
  },
  {
    "text": "what if you can see other users and maybe even change other users why if you just start at the beginning use the",
    "start": "802500",
    "end": "808139"
  },
  {
    "text": "number one who's user number one typically the admin and if you get control of the",
    "start": "808139",
    "end": "816180"
  },
  {
    "text": "admin account what can you do it's more of a question what can you not",
    "start": "816180",
    "end": "822360"
  },
  {
    "text": "do so I've been a developer and I've been",
    "start": "822360",
    "end": "828120"
  },
  {
    "text": "working on a few systems some of them from the very beginning somewhere I've come in later and um",
    "start": "828120",
    "end": "834360"
  },
  {
    "text": "I've seen that we often struggle with authorization",
    "start": "834360",
    "end": "839120"
  },
  {
    "text": "but when we start out it's really easy we typically start off with something really simple solving some problem we",
    "start": "839399",
    "end": "845639"
  },
  {
    "text": "have so we start out with one object type and one user type and maybe an administrator",
    "start": "845639",
    "end": "851399"
  },
  {
    "text": "and it's not complex at all it's possible to do authorization kind of get",
    "start": "851399",
    "end": "856680"
  },
  {
    "text": "all the rules in place it works and it doesn't matter if you add more objects add more users because the rules work",
    "start": "856680",
    "end": "865819"
  },
  {
    "text": "the problem is of course as time goes by and complexity grows because we need to",
    "start": "866040",
    "end": "872940"
  },
  {
    "text": "change adapt our systems we need to be attractive to cater for the demands of",
    "start": "872940",
    "end": "878160"
  },
  {
    "text": "new clients or old clients so we create another object type which of course has some implicit rules that",
    "start": "878160",
    "end": "885060"
  },
  {
    "text": "if you have access to one object you'll also have object to have access to this one or we start to group users",
    "start": "885060",
    "end": "892380"
  },
  {
    "text": "in like groups of friends or in companies or some other way and they by definition",
    "start": "892380",
    "end": "898800"
  },
  {
    "text": "should share some things they should not share other things as you understand complexity grows and",
    "start": "898800",
    "end": "905639"
  },
  {
    "text": "it keeps growing new requests come in short timelines we push out a new",
    "start": "905639",
    "end": "911220"
  },
  {
    "text": "feature even more complex relationships between the objects",
    "start": "911220",
    "end": "916440"
  },
  {
    "text": "yeah another user level because sales wanted to license another user or",
    "start": "916440",
    "end": "922260"
  },
  {
    "text": "cheaper user so they could sell more but of course this one needs a different",
    "start": "922260",
    "end": "928920"
  },
  {
    "text": "permissioning system so we need to introduce that so complexity grows and grows",
    "start": "928920",
    "end": "934800"
  },
  {
    "text": "and then what happens mergers and acquisitions",
    "start": "934800",
    "end": "939959"
  },
  {
    "text": "suddenly we have to reconcile two systems in a record time and we already know that our authorization system isn't",
    "start": "939959",
    "end": "948540"
  },
  {
    "text": "very good but now we're into trouble because these two systems can't easily be",
    "start": "948540",
    "end": "955740"
  },
  {
    "text": "aligned they have done this or solved authorization into completely different ways",
    "start": "955740",
    "end": "961320"
  },
  {
    "text": "and now we need them to work together in a record time so that's the time we've kind of pretty",
    "start": "961320",
    "end": "968459"
  },
  {
    "text": "much just give up we know that we should do this better but we just kind of yeah it's good",
    "start": "968459",
    "end": "975300"
  },
  {
    "text": "enough hope nobody finds out",
    "start": "975300",
    "end": "978980"
  },
  {
    "text": "so that's when we need to start testing and I'm my favorite thing to test is",
    "start": "983720",
    "end": "989279"
  },
  {
    "text": "actually for idors it's a bit boring but it's quite fun when you find something",
    "start": "989279",
    "end": "995820"
  },
  {
    "text": "so how does canvas system look when we start testing these things okay so we",
    "start": "995820",
    "end": "1001040"
  },
  {
    "text": "have a system with Alice and Bob they have two different accounts you need to authenticate",
    "start": "1001040",
    "end": "1007639"
  },
  {
    "text": "Alice creates a few objects they're only for her to see and Bob also creates an object and he",
    "start": "1007639",
    "end": "1014600"
  },
  {
    "text": "wants to share this with Alice and gives her read permission yeah",
    "start": "1014600",
    "end": "1019940"
  },
  {
    "text": "now turns out that Alice doesn't only have the read permission she can also update",
    "start": "1019940",
    "end": "1026480"
  },
  {
    "text": "this object why well maybe the code was complex and",
    "start": "1026480",
    "end": "1032120"
  },
  {
    "text": "someone didn't realize that when they changed something they didn't only give the read permission they accidentally also gave the update",
    "start": "1032120",
    "end": "1039558"
  },
  {
    "text": "permission through a code change Bob creates a few other objects like the",
    "start": "1039559",
    "end": "1045438"
  },
  {
    "text": "blue one and the green one and the blue one or any blue object",
    "start": "1045439",
    "end": "1051040"
  },
  {
    "text": "Alice can delete how come well",
    "start": "1051040",
    "end": "1057340"
  },
  {
    "text": "uh they were in a rush to push out this the functionality for the blue objects",
    "start": "1057559",
    "end": "1062840"
  },
  {
    "text": "delete was the last thing to be implemented they were gonna fix this later",
    "start": "1062840",
    "end": "1068000"
  },
  {
    "text": "yeah you know that's the one of The Lies We Tell ourselves the green object she has full access she",
    "start": "1068000",
    "end": "1075080"
  },
  {
    "text": "can do anything I'll come back to why in a minute Charlie is with a different tenant like",
    "start": "1075080",
    "end": "1082220"
  },
  {
    "text": "another company he has some objects supposedly they should be totally",
    "start": "1082220",
    "end": "1088160"
  },
  {
    "text": "separate from other companies because you shouldn't be able to see data from a competitor",
    "start": "1088160",
    "end": "1094520"
  },
  {
    "text": "but Alice can they'll read you can see his objects one of them at least and why is that",
    "start": "1094520",
    "end": "1102260"
  },
  {
    "text": "well maybe someone may had to make some functionality for sales or for support or services",
    "start": "1102260",
    "end": "1108440"
  },
  {
    "text": "so they didn't have to kind of change their user to be in a different company to help their clients with their",
    "start": "1108440",
    "end": "1114500"
  },
  {
    "text": "problems they could start to see objects cross-company but it wasn't restricted to just support",
    "start": "1114500",
    "end": "1122059"
  },
  {
    "text": "or services the green object what's the problem",
    "start": "1122059",
    "end": "1129880"
  },
  {
    "text": "why can Alex see it well anyone on the internet can see it because",
    "start": "1130340",
    "end": "1136100"
  },
  {
    "text": "it doesn't even require Authentication does this happen",
    "start": "1136100",
    "end": "1142280"
  },
  {
    "text": "well if you go and look at my NDC talk from 2017 I found something like this",
    "start": "1142280",
    "end": "1149059"
  },
  {
    "text": "there was a system used by probably 50 000 Norwegians plus minus 10",
    "start": "1149059",
    "end": "1156500"
  },
  {
    "text": "to 20 000. um where you could go and look at the user",
    "start": "1156500",
    "end": "1162260"
  },
  {
    "text": "details and um it was open to anyone you just could",
    "start": "1162260",
    "end": "1169820"
  },
  {
    "text": "just do the different IDs and you could see the name and the home address phone numbers email addresses and I think",
    "start": "1169820",
    "end": "1176660"
  },
  {
    "text": "there was a few other things which was bad but a probably the worst thing was that",
    "start": "1176660",
    "end": "1182660"
  },
  {
    "text": "the same applied to the change password function so you could just take the user ID you",
    "start": "1182660",
    "end": "1188419"
  },
  {
    "text": "just learned on the other page and you could change the password and it did not require the existing password so",
    "start": "1188419",
    "end": "1194720"
  },
  {
    "text": "you could set a new password on any user and hijack their account",
    "start": "1194720",
    "end": "1200780"
  },
  {
    "text": "so it does happen so",
    "start": "1200780",
    "end": "1206539"
  },
  {
    "text": "to do the authorization checks we introduce very often permissions so",
    "start": "1206539",
    "end": "1212780"
  },
  {
    "text": "we can give permissions that like say that someone can see my object or",
    "start": "1212780",
    "end": "1217940"
  },
  {
    "text": "someone can update my object or even delete it but we also have to remember that this",
    "start": "1217940",
    "end": "1223820"
  },
  {
    "text": "is also something we need to have the correct access control on if you want to set permissions you",
    "start": "1223820",
    "end": "1230000"
  },
  {
    "text": "typically need to set at least three things which objects are you giving permission to",
    "start": "1230000",
    "end": "1235940"
  },
  {
    "text": "which permission are you giving and which user are we giving this permission too",
    "start": "1235940",
    "end": "1243020"
  },
  {
    "text": "so the object if you can give permission to any object you're",
    "start": "1243020",
    "end": "1249620"
  },
  {
    "text": "just gonna doing um this hacking making this hacking just a",
    "start": "1249620",
    "end": "1255620"
  },
  {
    "text": "little bit harder because an attacker can't just go directly to your object they will first",
    "start": "1255620",
    "end": "1260780"
  },
  {
    "text": "need to go to the permissions and add permissions for themselves then they can get to whatever data is",
    "start": "1260780",
    "end": "1267380"
  },
  {
    "text": "there if you don't restrict the permission correctly well then I could go here and",
    "start": "1267380",
    "end": "1273799"
  },
  {
    "text": "I could change from read-only to write or administrate",
    "start": "1273799",
    "end": "1278900"
  },
  {
    "text": "and the last one can I give permission to any user",
    "start": "1278900",
    "end": "1285940"
  },
  {
    "text": "can't I well maybe I shouldn't be able to now I found a few instances like this",
    "start": "1286520",
    "end": "1292280"
  },
  {
    "text": "where you're only supposed to be able to give permissions to people in your own company",
    "start": "1292280",
    "end": "1298340"
  },
  {
    "text": "but it turns out you can give it to anyone",
    "start": "1298340",
    "end": "1302860"
  },
  {
    "text": "isn't that fine well there are some problems with this and first one is that you need to",
    "start": "1303620",
    "end": "1309080"
  },
  {
    "text": "populate this table so you need at least some name and some user ID and a company",
    "start": "1309080",
    "end": "1314960"
  },
  {
    "text": "name and that typically will come from the API and often it's not just that it's",
    "start": "1314960",
    "end": "1321320"
  },
  {
    "text": "often a lot more coming from the API and it could be things like this could be like the user ID the username and the",
    "start": "1321320",
    "end": "1327919"
  },
  {
    "text": "name and the email address Company ID company name",
    "start": "1327919",
    "end": "1334100"
  },
  {
    "text": "and this is quite interesting if you start to learn about all the different users you need to learn about the different companies all the other",
    "start": "1334100",
    "end": "1340700"
  },
  {
    "text": "people who use this system now can you find all your competitors",
    "start": "1340700",
    "end": "1346940"
  },
  {
    "text": "users okay you learn how many of them are using the system",
    "start": "1346940",
    "end": "1352220"
  },
  {
    "text": "maybe you can search for your email address maybe find a breached password and maybe they were even reused it and",
    "start": "1352220",
    "end": "1358940"
  },
  {
    "text": "now we can log in as them or maybe you can just lock all of them out at once",
    "start": "1358940",
    "end": "1366640"
  },
  {
    "text": "what's in your logs if you have someone that haven't a",
    "start": "1367460",
    "end": "1374600"
  },
  {
    "text": "hacker looking for an either earlocks will probably tell you a lot",
    "start": "1374600",
    "end": "1380480"
  },
  {
    "text": "about that they hit permission denied again and again and again",
    "start": "1380480",
    "end": "1385940"
  },
  {
    "text": "until they succeeded at that point your log looks perfectly",
    "start": "1385940",
    "end": "1392539"
  },
  {
    "text": "normal there is no errors there's like 200 okay in your access log there is no like 401 or 403 or 404 or",
    "start": "1392539",
    "end": "1400280"
  },
  {
    "text": "whatever you choose to tell in that instance there is nothing the Earth it's",
    "start": "1400280",
    "end": "1405740"
  },
  {
    "text": "indistinguishable from legitimate traffic",
    "start": "1405740",
    "end": "1410140"
  },
  {
    "text": "so we need to test we need to find out ourselves if we have idors",
    "start": "1411260",
    "end": "1417080"
  },
  {
    "text": "and to do that we need to send requests to test it if we kind of do it",
    "start": "1417080",
    "end": "1423919"
  },
  {
    "text": "in a manual way and let's say that we have one object and we have an API where we have these",
    "start": "1423919",
    "end": "1430100"
  },
  {
    "text": "verbs and if we're going to test this we need to test all the different verbs and even",
    "start": "1430100",
    "end": "1436340"
  },
  {
    "text": "hidden options might give us some interesting information even though it doesn't give us a lot",
    "start": "1436340",
    "end": "1442580"
  },
  {
    "text": "and we might also need to create sensible payloads for a lot of these requests",
    "start": "1442580",
    "end": "1448340"
  },
  {
    "text": "but just for this one object with this one endpoint that's six requests",
    "start": "1448340",
    "end": "1454220"
  },
  {
    "text": "and let's say that we have multiple user types obviously a word used to type here that could be",
    "start": "1454220",
    "end": "1460340"
  },
  {
    "text": "um different roles or different type different types of users different",
    "start": "1460340",
    "end": "1466280"
  },
  {
    "text": "permissioning and if we're going to repeat this for all the different user types",
    "start": "1466280",
    "end": "1473360"
  },
  {
    "text": "well six times three we're up to 18 requests but we should perhaps also repeat these",
    "start": "1473360",
    "end": "1480080"
  },
  {
    "text": "for users in another company to check that we aren't leaking information across companies",
    "start": "1480080",
    "end": "1486799"
  },
  {
    "text": "that then we double it we're up to 36 requests to test",
    "start": "1486799",
    "end": "1492020"
  },
  {
    "text": "and what if this object also have another more limited API endpoint",
    "start": "1492020",
    "end": "1497120"
  },
  {
    "text": "now we're up to 50 manual tests just for this one object",
    "start": "1497120",
    "end": "1503419"
  },
  {
    "text": "and if you have a lot of objects you have several hundred tests to do which is kind of infeasible doesn't",
    "start": "1503419",
    "end": "1510440"
  },
  {
    "text": "really scale and then there are some other vectors",
    "start": "1510440",
    "end": "1516080"
  },
  {
    "text": "you don't need to repeat all the requests with all of these but you can these are some other idler techniques",
    "start": "1516080",
    "end": "1521900"
  },
  {
    "text": "bios that I found on Twitter from someone called mephadal what about changing",
    "start": "1521900",
    "end": "1529520"
  },
  {
    "text": "um the request content type what about supplying the the same",
    "start": "1529520",
    "end": "1535100"
  },
  {
    "text": "parameter multiple times with the same or with different values or what about putting the ID in an array",
    "start": "1535100",
    "end": "1543500"
  },
  {
    "text": "this could bypass things so I've seen I've seen a lot dividers",
    "start": "1543500",
    "end": "1550400"
  },
  {
    "text": "I've found a lot dividers and I've been working as a developer so I can see in this from",
    "start": "1550400",
    "end": "1556039"
  },
  {
    "text": "various places and also also may have been working with security test",
    "start": "1556039",
    "end": "1562100"
  },
  {
    "text": "tools and penetration tests so I want to kind of give a picture of why this is",
    "start": "1562100",
    "end": "1567440"
  },
  {
    "text": "happening and why we are too optimistic and why we're not or how we're not doing the job so I'll start on top here with",
    "start": "1567440",
    "end": "1574279"
  },
  {
    "text": "product managers and product managers are very different uh their role and",
    "start": "1574279",
    "end": "1581059"
  },
  {
    "text": "their job is very different some of them Define the actually Define the product and a lot of them use use their stories",
    "start": "1581059",
    "end": "1588020"
  },
  {
    "text": "like this one as a user I want to edit update my profile so that I can change my information",
    "start": "1588020",
    "end": "1594500"
  },
  {
    "text": "probably seen things like this what you might not have seen is kind of",
    "start": "1594500",
    "end": "1600080"
  },
  {
    "text": "something like this as a user I don't want anyone else to access my profile so that they can see modify or delete my",
    "start": "1600080",
    "end": "1607340"
  },
  {
    "text": "information anyone seen this oh",
    "start": "1607340",
    "end": "1613419"
  },
  {
    "text": "very few people have seen anything like this because what happens if you have",
    "start": "1613419",
    "end": "1618440"
  },
  {
    "text": "this it's not anyone else probably the third one for as an administrator I need to",
    "start": "1618440",
    "end": "1626059"
  },
  {
    "text": "access and what if be able to modify all profiles so it's a lot of specification that we",
    "start": "1626059",
    "end": "1631940"
  },
  {
    "text": "actually need to do so we're too optimistic product managers",
    "start": "1631940",
    "end": "1637039"
  },
  {
    "text": "they only write the positive user stories and they pretty much leave it for others",
    "start": "1637039",
    "end": "1642200"
  },
  {
    "text": "to decide of course developers are used to this",
    "start": "1642200",
    "end": "1648140"
  },
  {
    "text": "so developers will then sometimes they will sit down discuss",
    "start": "1648140",
    "end": "1654620"
  },
  {
    "text": "what the rules should be and they will document it and then they will start implementing it but a lot of",
    "start": "1654620",
    "end": "1660380"
  },
  {
    "text": "times they will just start implementing and yeah make up the rules as they go",
    "start": "1660380",
    "end": "1666380"
  },
  {
    "text": "and they might even write tests they'll write tests like this to start out user",
    "start": "1666380",
    "end": "1672799"
  },
  {
    "text": "can see user can update user can delete administrator has full access",
    "start": "1672799",
    "end": "1679539"
  },
  {
    "text": "still only the positive happy cases so what they should do and some do",
    "start": "1679700",
    "end": "1687799"
  },
  {
    "text": "is to write something like unauthenticated is not authorized",
    "start": "1687799",
    "end": "1693380"
  },
  {
    "text": "and user in different company can't see can't modify can't delete",
    "start": "1693380",
    "end": "1699940"
  },
  {
    "text": "but they also do some functional testing in the browser with the administrator user of course",
    "start": "1700039",
    "end": "1706460"
  },
  {
    "text": "or with only one user but this is not complete test coverage",
    "start": "1706460",
    "end": "1713799"
  },
  {
    "text": "yeah if if the if the developer is actually documented",
    "start": "1716120",
    "end": "1722360"
  },
  {
    "text": "and not expected to be changed next week anyway then the testers might get some ideas on",
    "start": "1722360",
    "end": "1727640"
  },
  {
    "text": "what they should test but what do testers do well I think we all know from this joke",
    "start": "1727640",
    "end": "1733760"
  },
  {
    "text": "a QA engineer walks into a bar she orders two beers orders zero beers orders minus one beers orders a lizard",
    "start": "1733760",
    "end": "1742279"
  },
  {
    "text": "or there's a null pointer tries to leave without paying satisfied she declares the bar ready for",
    "start": "1742279",
    "end": "1748520"
  },
  {
    "text": "business the first customer comes in and asks where the bathroom is the bar explodes",
    "start": "1748520",
    "end": "1755720"
  },
  {
    "text": "now as developers we think that this is really outside the box None Like We Only expected positive",
    "start": "1755720",
    "end": "1763880"
  },
  {
    "text": "numbers non-negative positive numbers",
    "start": "1763880",
    "end": "1768940"
  },
  {
    "text": "and this is what we get strings negative numbers ah",
    "start": "1769760",
    "end": "1775640"
  },
  {
    "text": "don't people understand our UI now this is not outside the box this is",
    "start": "1775640",
    "end": "1780740"
  },
  {
    "text": "more outside the box change the unit price to one cent change the currency to Zimbabwe dollars",
    "start": "1780740",
    "end": "1787880"
  },
  {
    "text": "order with another customer ID load the order verification with another order ID maybe the order is ready to",
    "start": "1787880",
    "end": "1795559"
  },
  {
    "text": "pick up and you can do it try to access slash admin maybe it's accessible",
    "start": "1795559",
    "end": "1802279"
  },
  {
    "text": "why not try to send it as HTTP 1.0 to see what happens well hasn't been",
    "start": "1802279",
    "end": "1807919"
  },
  {
    "text": "necessary for the last 15 years order from another origin just to see what happens then",
    "start": "1807919",
    "end": "1814760"
  },
  {
    "text": "because then the bar explodes so testers often if they do it at all if",
    "start": "1814760",
    "end": "1822380"
  },
  {
    "text": "they test it all or if they test something they're not testing the really crazy cases and they're very often not testing",
    "start": "1822380",
    "end": "1829580"
  },
  {
    "text": "broken Access Control and they're also lacking the knowledge and the tools to do so so you can ask",
    "start": "1829580",
    "end": "1836179"
  },
  {
    "text": "your tester what do you use to test for broken Access Control and there aren't many answers really",
    "start": "1836179",
    "end": "1842840"
  },
  {
    "text": "that are good uh so I'll come back to some of them later",
    "start": "1842840",
    "end": "1849620"
  },
  {
    "text": "and you can also ask them do you use the web proxy if they if they're not using any kind of",
    "start": "1849620",
    "end": "1854840"
  },
  {
    "text": "web proxy they're likely not testing for broken Access Control or they do it like with their hands tied",
    "start": "1854840",
    "end": "1862640"
  },
  {
    "text": "in their back at least it's very impractical to not use the web proxy or another tool",
    "start": "1862640",
    "end": "1869059"
  },
  {
    "text": "So speaking of tools security test tools your boss or your boss's boss spent a",
    "start": "1869059",
    "end": "1875899"
  },
  {
    "text": "lot of money on security test tools and those who sold them say that yeah use this tool you will be you'll they'll",
    "start": "1875899",
    "end": "1884000"
  },
  {
    "text": "fix ovas top 10 or find OS top 10 problems still the PCI DSS compliant and",
    "start": "1884000",
    "end": "1889640"
  },
  {
    "text": "yeah they will find all these different types of vulnerabilities they will never ever find an either",
    "start": "1889640",
    "end": "1898640"
  },
  {
    "text": "they will not find broken access control of that type somewhere I'm showing here because that needs human intervention",
    "start": "1898640",
    "end": "1907760"
  },
  {
    "text": "it needs to have the rules defined it you need or you need to verify the",
    "start": "1907760",
    "end": "1913039"
  },
  {
    "text": "outcome so and fully automated tool cannot find this",
    "start": "1913039",
    "end": "1918260"
  },
  {
    "text": "so you need to you need to put some human effort into it",
    "start": "1918260",
    "end": "1923720"
  },
  {
    "text": "but you did you had a penetration test you paid a lot of money for that as well",
    "start": "1923720",
    "end": "1929799"
  },
  {
    "text": "that didn't show it and that could be your fault or it could",
    "start": "1930200",
    "end": "1935960"
  },
  {
    "text": "be the penetration tester's fault and if you set up a test server created a user created some data and",
    "start": "1935960",
    "end": "1943880"
  },
  {
    "text": "gave the credentials to the tester it's your fault because then we made it extremely hard",
    "start": "1943880",
    "end": "1949820"
  },
  {
    "text": "to find idors well if you had created multiple users",
    "start": "1949820",
    "end": "1955279"
  },
  {
    "text": "of different user types and in different tenants or companies or whatever segregation there is in your system if",
    "start": "1955279",
    "end": "1961399"
  },
  {
    "text": "any create data for all of them and then hand all the credentials to the",
    "start": "1961399",
    "end": "1967700"
  },
  {
    "text": "tester then the tester will be able to log in as one user see the objects available to",
    "start": "1967700",
    "end": "1974419"
  },
  {
    "text": "that one log in as another one and then try to access the objects from the from another user",
    "start": "1974419",
    "end": "1981559"
  },
  {
    "text": "then it's possible and kind of fairly easy to try to find idors",
    "start": "1981559",
    "end": "1987278"
  },
  {
    "text": "but does that help I've done that",
    "start": "1988100",
    "end": "1993860"
  },
  {
    "text": "every single time I've had a penetration test done and I also lately specifically",
    "start": "1993860",
    "end": "1999320"
  },
  {
    "text": "ask the tester to look for authorization vulnerabilities have they given me any findings",
    "start": "1999320",
    "end": "2007179"
  },
  {
    "text": "no have I found stuff myself yes because the penetration gestures they",
    "start": "2007179",
    "end": "2014200"
  },
  {
    "text": "really like to just fill the report with output from automated tools because",
    "start": "2014200",
    "end": "2020080"
  },
  {
    "text": "that's easy they also run some kind of scripts like login change password try to find",
    "start": "2020080",
    "end": "2025779"
  },
  {
    "text": "something there because looking for idors is boring it's",
    "start": "2025779",
    "end": "2031360"
  },
  {
    "text": "laborious work it's much easier to to find some other",
    "start": "2031360",
    "end": "2036519"
  },
  {
    "text": "items to put in the report",
    "start": "2036519",
    "end": "2040380"
  },
  {
    "text": "how did we get here let me ask you some questions and raise your hand who has in their studies had a mandatory",
    "start": "2042340",
    "end": "2050320"
  },
  {
    "text": "application security course",
    "start": "2050320",
    "end": "2053940"
  },
  {
    "text": "not many um okay next question who has been trading application security by their",
    "start": "2055720",
    "end": "2061898"
  },
  {
    "text": "current or a former employer yeah this this is a filtered group",
    "start": "2061899",
    "end": "2069820"
  },
  {
    "text": "so this this result is quite good who has been trained",
    "start": "2069820",
    "end": "2076419"
  },
  {
    "text": "uh in um at any time studies or later in",
    "start": "2076419",
    "end": "2081540"
  },
  {
    "text": "avoiding or avoiding or detecting broken Access Control",
    "start": "2081540",
    "end": "2089220"
  },
  {
    "text": "not bad yeah as I said it's a filtered population",
    "start": "2089399",
    "end": "2096540"
  },
  {
    "text": "so I've been trained I've taken this course by Sans which is giving certif certifications and",
    "start": "2096879",
    "end": "2103780"
  },
  {
    "text": "education in security the web app penetration and testing and ethical hockey so it was six days of",
    "start": "2103780",
    "end": "2111520"
  },
  {
    "text": "course and um we learned a lot about a lot of",
    "start": "2111520",
    "end": "2116560"
  },
  {
    "text": "different tools and techniques and vulnerabilities and writing reports and oceans and a lot",
    "start": "2116560",
    "end": "2123400"
  },
  {
    "text": "of different things packed days did they teach us",
    "start": "2123400",
    "end": "2128920"
  },
  {
    "text": "what the five-year-old can do you guessed the answer no they did not",
    "start": "2128920",
    "end": "2134140"
  },
  {
    "text": "and I gave them feedback but it seems like the curriculum for the course is still the same it's much more fun to use some tools",
    "start": "2134140",
    "end": "2141339"
  },
  {
    "text": "than to actually do the nitty-gritty work of changing requests and testing stuff that way",
    "start": "2141339",
    "end": "2148440"
  },
  {
    "text": "so what should you do if you're sitting here with this uneasy",
    "start": "2149680",
    "end": "2154900"
  },
  {
    "text": "feeling that we're just doing this kind of a pat down we don't really check the details",
    "start": "2154900",
    "end": "2160359"
  },
  {
    "text": "because we don't dare to do it and if we yeah we have that feeling then go",
    "start": "2160359",
    "end": "2168760"
  },
  {
    "text": "back and when you racket work tomorrow maybe then do some random samples and and check if",
    "start": "2168760",
    "end": "2175599"
  },
  {
    "text": "the state is really bad and if if it's bad or really bad then try to speak to",
    "start": "2175599",
    "end": "2181780"
  },
  {
    "text": "your manager and say well I think we really need to to look into this and we need to improve our",
    "start": "2181780",
    "end": "2188520"
  },
  {
    "text": "authorization because it seems like we have some broken Access Control",
    "start": "2188520",
    "end": "2195240"
  },
  {
    "text": "what should the tester do apart from ordering beer",
    "start": "2195760",
    "end": "2201300"
  },
  {
    "text": "pester should get some tools could uh like a web proxy um I like Fiddler and I'll just come",
    "start": "2201700",
    "end": "2207820"
  },
  {
    "text": "come back to Fiddler on the next slide but burp suit it's a security testing tool",
    "start": "2207820",
    "end": "2213880"
  },
  {
    "text": "that I think a tester is at least one tester each company should have access to it's not that expensive",
    "start": "2213880",
    "end": "2221680"
  },
  {
    "text": "it has an extension called authorize which is perfect for authorization",
    "start": "2221680",
    "end": "2226720"
  },
  {
    "text": "testing who would have guessed with that name with authorize you log into your",
    "start": "2226720",
    "end": "2234579"
  },
  {
    "text": "application as a low typical low privileged user and um",
    "start": "2234579",
    "end": "2240460"
  },
  {
    "text": "you just take the whatever authentication tokens there are like it's cookie or under authorization header",
    "start": "2240460",
    "end": "2246220"
  },
  {
    "text": "and then you give it to authorize and then you're going to close that browser start",
    "start": "2246220",
    "end": "2253000"
  },
  {
    "text": "another one and you log in as a high privileged user like an administrator",
    "start": "2253000",
    "end": "2258220"
  },
  {
    "text": "and then when you start authorized for every request that you issue as the",
    "start": "2258220",
    "end": "2263440"
  },
  {
    "text": "administrator or a high privileged user authorized will repeat the request",
    "start": "2263440",
    "end": "2269820"
  },
  {
    "text": "once for the user you provided and once for an unauthenticated user",
    "start": "2269820",
    "end": "2277300"
  },
  {
    "text": "and then it will give you this color coding of all the responses that we'll get then compare it to what the",
    "start": "2277300",
    "end": "2283960"
  },
  {
    "text": "administrator user that you are actually browsing with is getting and it will tell you like yeah seems",
    "start": "2283960",
    "end": "2291760"
  },
  {
    "text": "like it's bypassed could be because it's a public resource could be that you're actually lacking",
    "start": "2291760",
    "end": "2299079"
  },
  {
    "text": "Access Control or you could say that well that seems to be enforced you get a 401 or it's the",
    "start": "2299079",
    "end": "2305740"
  },
  {
    "text": "the response length is zero or it doesn't really know so you'll have to",
    "start": "2305740",
    "end": "2311980"
  },
  {
    "text": "um inspect manually and this is what I mean by you it needs",
    "start": "2311980",
    "end": "2317260"
  },
  {
    "text": "human intervention it needs someone to look at these cases is it a public resource is it okay",
    "start": "2317260",
    "end": "2323560"
  },
  {
    "text": "due to something so if you don't have burp suits you can",
    "start": "2323560",
    "end": "2330339"
  },
  {
    "text": "also do this with Fiddler I've created a script that you can get on this page you also find that",
    "start": "2330339",
    "end": "2336579"
  },
  {
    "text": "um host or URL in the last slide",
    "start": "2336579",
    "end": "2342060"
  },
  {
    "text": "and something I called automated or additional authorization testing with Fiddler script",
    "start": "2342579",
    "end": "2349240"
  },
  {
    "text": "so I'm using the Juice Shop the Celia here had a talk about Juice Shop yesterday",
    "start": "2349240",
    "end": "2356320"
  },
  {
    "text": "um see if I have Fiddler and Juice Shop now I need to",
    "start": "2356320",
    "end": "2363280"
  },
  {
    "text": "oh sorry I'll get them over I had the blue screen as I said like right before I started so but I managed to hopefully",
    "start": "2363280",
    "end": "2370320"
  },
  {
    "text": "get all this set up now we'll see if I really managed",
    "start": "2370320",
    "end": "2377500"
  },
  {
    "text": "so we had Juice Shop here okay let's",
    "start": "2377500",
    "end": "2384460"
  },
  {
    "text": "try to make Fiddler give it some more space here even more okay and we'll just remove",
    "start": "2384640",
    "end": "2392560"
  },
  {
    "text": "that and of course it has restarted",
    "start": "2392560",
    "end": "2398440"
  },
  {
    "text": "try to make it a little bigger for you to see okay there we go uh",
    "start": "2398440",
    "end": "2405720"
  },
  {
    "text": "maybe I'll make this even bigger so okay now we're ready so what we'll do first is to harvest",
    "start": "2407800",
    "end": "2414820"
  },
  {
    "text": "users because we need just like with authorize this is pretty much the same thing except that we can have an unlimited",
    "start": "2414820",
    "end": "2421960"
  },
  {
    "text": "amount of users authorize only can take one authenticated users here we can have any and here we can also modify the",
    "start": "2421960",
    "end": "2428680"
  },
  {
    "text": "scripts as you like so the first thing we will do is to go and harvest authentication tokens",
    "start": "2428680",
    "end": "2437020"
  },
  {
    "text": "and then I will go to the app click on account",
    "start": "2437020",
    "end": "2444780"
  },
  {
    "text": "my account and then Fiddler asks me because it found the user",
    "start": "2445000",
    "end": "2450220"
  },
  {
    "text": "it says that well this is the user without any um authorization header so that's likely an",
    "start": "2450220",
    "end": "2457599"
  },
  {
    "text": "unauthenticated user so I'll call this one unauthenticated",
    "start": "2457599",
    "end": "2462880"
  },
  {
    "text": "just for Simplicity okay",
    "start": "2462880",
    "end": "2468599"
  },
  {
    "text": "to go back here well I was expecting one more user um yeah and now I can see it somewhere",
    "start": "2471820",
    "end": "2477880"
  },
  {
    "text": "there it is yeah so this is the this is the authenticated user and this",
    "start": "2477880",
    "end": "2485200"
  },
  {
    "text": "is in the incognito window so I'll just call this one in kogi oh incognito",
    "start": "2485200",
    "end": "2492880"
  },
  {
    "text": "uh whatever might be a mistake there but that's okay now we have harvested two users then",
    "start": "2492880",
    "end": "2498820"
  },
  {
    "text": "authenticated and the authenticated user now we stop harvesting users",
    "start": "2498820",
    "end": "2506460"
  },
  {
    "text": "and we can log in a different user",
    "start": "2507160",
    "end": "2512200"
  },
  {
    "text": "okay and you also need to track that one over",
    "start": "2512200",
    "end": "2516780"
  },
  {
    "text": "let's play screen okay we'll log in there we go",
    "start": "2520000",
    "end": "2525160"
  },
  {
    "text": "so now we're logged in to Juice Shop with this user that we're gonna kind of",
    "start": "2525160",
    "end": "2530940"
  },
  {
    "text": "be issuing the request to it and um Juice Shop is uh designed to be a",
    "start": "2530940",
    "end": "2538300"
  },
  {
    "text": "vulnerable web application so it's like you can play and try to find different things I guess you can",
    "start": "2538300",
    "end": "2544300"
  },
  {
    "text": "also try to fix the vulnerabilities there as an exercise",
    "start": "2544300",
    "end": "2549460"
  },
  {
    "text": "very good thing about Juice Shop is that it's very visual when you find something",
    "start": "2549460",
    "end": "2554880"
  },
  {
    "text": "so now I'm going to change something here in filtering again",
    "start": "2554880",
    "end": "2561099"
  },
  {
    "text": "this is from the script saying additional authorization requests",
    "start": "2561099",
    "end": "2567099"
  },
  {
    "text": "so the first thing I will do is to click on add to baskets so this user adds the",
    "start": "2567099",
    "end": "2572560"
  },
  {
    "text": "apple juice to the basket oh we got the confetti Canon because we found a vulnerability in the system",
    "start": "2572560",
    "end": "2580540"
  },
  {
    "text": "and if we look at Fiddler we see that this is the original user the one issuing the request",
    "start": "2580540",
    "end": "2588160"
  },
  {
    "text": "added something to the basket got a 200. the unauthenticated user and the",
    "start": "2588160",
    "end": "2593440"
  },
  {
    "text": "Incognito user got a 401 so that seemed to be okay",
    "start": "2593440",
    "end": "2598540"
  },
  {
    "text": "but down here looking at their shopping baskets",
    "start": "2598540",
    "end": "2604420"
  },
  {
    "text": "the original user got the 200 the unauthenticated user got a 401",
    "start": "2604420",
    "end": "2609520"
  },
  {
    "text": "while they won in the incognito window 200.",
    "start": "2609520",
    "end": "2614859"
  },
  {
    "text": "so in here here we can see that well this is likely something which is not",
    "start": "2614920",
    "end": "2619960"
  },
  {
    "text": "good and of course this one even says that you successfully sold the challenge view",
    "start": "2619960",
    "end": "2625060"
  },
  {
    "text": "basket view another user's shopping baskets also provoke to narrow message",
    "start": "2625060",
    "end": "2631440"
  },
  {
    "text": "this request here it's just likely just a public resource",
    "start": "2632200",
    "end": "2640240"
  },
  {
    "text": "okay one more example so we have reviews in Juice Shop we can review different items",
    "start": "2640900",
    "end": "2647740"
  },
  {
    "text": "so we can say something about this one yeah maybe it's too sour",
    "start": "2647740",
    "end": "2654359"
  },
  {
    "text": "oh confetti Canon what happens",
    "start": "2655300",
    "end": "2661599"
  },
  {
    "text": "well let's um give Fiddler the full screen",
    "start": "2661599",
    "end": "2668680"
  },
  {
    "text": "oh can't click when I'm looking at an angle",
    "start": "2668680",
    "end": "2673839"
  },
  {
    "text": "okay what does the request look like",
    "start": "2673839",
    "end": "2680220"
  },
  {
    "text": "can't I see the Raw",
    "start": "2681400",
    "end": "2685318"
  },
  {
    "text": "maybe the best no isn't it that one no this is that's this one review",
    "start": "2687760",
    "end": "2695160"
  },
  {
    "text": "so the request is just like the author you can specify any user that doesn't have",
    "start": "2695680",
    "end": "2702040"
  },
  {
    "text": "to be yourself and a message so all three users send this one",
    "start": "2702040",
    "end": "2710760"
  },
  {
    "text": "and they're all accepted because you all see they come or not sorry it's here they all get a 201",
    "start": "2711280",
    "end": "2717720"
  },
  {
    "text": "and if you want to see here there are three",
    "start": "2718780",
    "end": "2723880"
  },
  {
    "text": "reviews made from that one request where Fiddler duplicated it",
    "start": "2723880",
    "end": "2731760"
  },
  {
    "text": "what should you do as a developer",
    "start": "2735880",
    "end": "2739318"
  },
  {
    "text": "if you look at the code it could be like this you have some method",
    "start": "2741520",
    "end": "2748119"
  },
  {
    "text": "where actually most of it is authorization and this authorization is Tangled into all the other application",
    "start": "2748119",
    "end": "2754240"
  },
  {
    "text": "logic and the problem with this one is that this function it has the same",
    "start": "2754240",
    "end": "2761680"
  },
  {
    "text": "name as like the function we're calling at the bottom and it's very easy in this case to just",
    "start": "2761680",
    "end": "2767619"
  },
  {
    "text": "forget to call this a method that actually does stay authorization so we",
    "start": "2767619",
    "end": "2772780"
  },
  {
    "text": "might just forget about it but let's look at the rules I've seen things like this",
    "start": "2772780",
    "end": "2778900"
  },
  {
    "text": "uh so you're honest you want to see a report and you can see the report if the",
    "start": "2778900",
    "end": "2784300"
  },
  {
    "text": "report and the user are in the same company and if your role is viewer or",
    "start": "2784300",
    "end": "2789400"
  },
  {
    "text": "designer then you can see the report that's a sensible rule you can see the",
    "start": "2789400",
    "end": "2794560"
  },
  {
    "text": "report if you're an administrator then you can see all reports or you can see the report if you have",
    "start": "2794560",
    "end": "2801099"
  },
  {
    "text": "specific permissions in the database fair enough",
    "start": "2801099",
    "end": "2806260"
  },
  {
    "text": "but this is not how we should do it we should not have like the authorization logic right here with all the other code",
    "start": "2806260",
    "end": "2815380"
  },
  {
    "text": "we should try to move it out to a different class or a different service that can do",
    "start": "2815380",
    "end": "2822160"
  },
  {
    "text": "the authorization why",
    "start": "2822160",
    "end": "2827440"
  },
  {
    "text": "well it's reusable and it's also a lot easier to test with",
    "start": "2827440",
    "end": "2832540"
  },
  {
    "text": "unit tests but we shouldn't really stop here we",
    "start": "2832540",
    "end": "2838300"
  },
  {
    "text": "should move it all the way out of of the of the logic in this method",
    "start": "2838300",
    "end": "2845200"
  },
  {
    "text": "we should if the language allows use authorization attribute",
    "start": "2845200",
    "end": "2853000"
  },
  {
    "text": "because we could even say that all functions like this like get and put and",
    "start": "2853000",
    "end": "2859420"
  },
  {
    "text": "post and delete must have another authorization attribute and if we could even make checks on that",
    "start": "2859420",
    "end": "2865780"
  },
  {
    "text": "so we don't compile if some of them are missing and if we don't need authorization we can have a no authorization attribute",
    "start": "2865780",
    "end": "2873660"
  },
  {
    "text": "and then you could also use open policy agent or also to take care of",
    "start": "2875500",
    "end": "2881920"
  },
  {
    "text": "authorization there was a very good talk yesterday about the open policy agent and if you've done what I just said",
    "start": "2881920",
    "end": "2889359"
  },
  {
    "text": "you already have the tests in place so when you swap in open policy agent you",
    "start": "2889359",
    "end": "2894940"
  },
  {
    "text": "can just run the same test and see if your rules they have for open policy agent",
    "start": "2894940",
    "end": "2900640"
  },
  {
    "text": "are um are the same as the one you already had and you might need to change something",
    "start": "2900640",
    "end": "2906819"
  },
  {
    "text": "or might realize that your rules have always been wrong",
    "start": "2906819",
    "end": "2911519"
  },
  {
    "text": "what else should a developer do you should write automated tests no you should not",
    "start": "2912339",
    "end": "2919240"
  },
  {
    "text": "that may come as a surprise you should make an automated test framework",
    "start": "2919240",
    "end": "2925119"
  },
  {
    "text": "some of my colleagues have done this I'll really like this project",
    "start": "2925119",
    "end": "2931300"
  },
  {
    "text": "so they take as inputs all the endpoints and they get them from Swagger or open",
    "start": "2931300",
    "end": "2937720"
  },
  {
    "text": "API definition and then they also insert in the fixture",
    "start": "2937720",
    "end": "2943000"
  },
  {
    "text": "all the different user types so you can test every endpoint for every user type",
    "start": "2943000",
    "end": "2948520"
  },
  {
    "text": "and for every verb so this is kind of the simple part you",
    "start": "2948520",
    "end": "2954280"
  },
  {
    "text": "might not have to kind of do the nitty-gritty details of adding all the correct payloads",
    "start": "2954280",
    "end": "2961619"
  },
  {
    "text": "but you know this is quite simple actually it's not hard to build this framework it does it's not very many",
    "start": "2961619",
    "end": "2967839"
  },
  {
    "text": "lines of code and then you can output something like they use Excel it's fairly readable by",
    "start": "2967839",
    "end": "2974079"
  },
  {
    "text": "both man and machine where you get all the rules from the system",
    "start": "2974079",
    "end": "2979839"
  },
  {
    "text": "and then you can take this and you can give it to product manager and say are",
    "start": "2979839",
    "end": "2985540"
  },
  {
    "text": "these rules correct this these are the current rules in as they are enforced in the system are they correct or and you",
    "start": "2985540",
    "end": "2992980"
  },
  {
    "text": "can join in into the discussion is this how we want this to work or is it not and you might find out you might",
    "start": "2992980",
    "end": "2999880"
  },
  {
    "text": "have some surprises and you might want to change something and then you can feed that file back",
    "start": "2999880",
    "end": "3006359"
  },
  {
    "text": "into the system because that's now how the rules that's how it should be and if you change something well the",
    "start": "3006359",
    "end": "3013440"
  },
  {
    "text": "test will fail until you make the corresponding change in the rules if you add another endpoint",
    "start": "3013440",
    "end": "3021119"
  },
  {
    "text": "test will fail if you make a change that actually changes something in the",
    "start": "3021119",
    "end": "3027359"
  },
  {
    "text": "authorization well test will fail it's a super safe card and once you if",
    "start": "3027359",
    "end": "3032640"
  },
  {
    "text": "you have a lot of code or like different applications with heads pretty much the same users",
    "start": "3032640",
    "end": "3039000"
  },
  {
    "text": "your user types this is actually a very good way to do a",
    "start": "3039000",
    "end": "3045240"
  },
  {
    "text": "lot of testing because it will run as you see here it will run very many tests in a very short time",
    "start": "3045240",
    "end": "3052200"
  },
  {
    "text": "and you will really find out if you have broken Access Control",
    "start": "3052200",
    "end": "3058040"
  },
  {
    "text": "so have you solved the problem if you do this we have at least sold a lot of the EC",
    "start": "3058920",
    "end": "3065940"
  },
  {
    "text": "cases that are most easily found but of course there are more advanced",
    "start": "3065940",
    "end": "3071339"
  },
  {
    "text": "ones which I won't cover like when you have multiple items to authorize at once",
    "start": "3071339",
    "end": "3078119"
  },
  {
    "text": "or when there's like extra parameters that will do something that you don't",
    "start": "3078119",
    "end": "3084180"
  },
  {
    "text": "normally see I actually found a one like this where I could add role ID and suddenly I could",
    "start": "3084180",
    "end": "3090300"
  },
  {
    "text": "be become the administrator well that wasn't meant to discourage you but because I want just you to know that",
    "start": "3090300",
    "end": "3098520"
  },
  {
    "text": "these are things you can do idors are everywhere go find them and um",
    "start": "3098520",
    "end": "3105059"
  },
  {
    "text": "and stay secure thank you",
    "start": "3105059",
    "end": "3110119"
  },
  {
    "text": "any questions",
    "start": "3116760",
    "end": "3119420"
  },
  {
    "text": "yes",
    "start": "3126420",
    "end": "3129020"
  },
  {
    "text": "so the question is is there legitimate reasons for having a user ID in a URL",
    "start": "3132839",
    "end": "3138599"
  },
  {
    "text": "not many um like the case I gave where look at your own profile use current user don't",
    "start": "3138599",
    "end": "3145680"
  },
  {
    "text": "don't flag the user IDs because showing predictable ideas is not a very",
    "start": "3145680",
    "end": "3152040"
  },
  {
    "text": "good thing to do there might of course be cases but",
    "start": "3152040",
    "end": "3158880"
  },
  {
    "text": "yeah maybe you shouldn't have it in the URL if you can avoid it keep them out",
    "start": "3158880",
    "end": "3165140"
  },
  {
    "text": "yeah that's if it's public it's uh this whole set of different",
    "start": "3170040",
    "end": "3175260"
  },
  {
    "text": "rules should apply",
    "start": "3175260",
    "end": "3178220"
  },
  {
    "text": "no",
    "start": "3182640",
    "end": "3185058"
  },
  {
    "text": "what about using quits in your advice for",
    "start": "3189740",
    "end": "3196040"
  },
  {
    "text": "so the question is what about grids they are a lot better but they they're you",
    "start": "3204619",
    "end": "3210420"
  },
  {
    "text": "know somebody who wrote something that they're not always good there are some problems with Goods",
    "start": "3210420",
    "end": "3216780"
  },
  {
    "text": "um or the main problem is often Google if things are cached or like or indexed",
    "start": "3216780",
    "end": "3225599"
  },
  {
    "text": "um because that's something you can do if if the",
    "start": "3225599",
    "end": "3230940"
  },
  {
    "text": "if the request URLs are indexed by Google or other browse or other search",
    "start": "3230940",
    "end": "3236520"
  },
  {
    "text": "engines it might be possible to find grids and grids are not fully random like secure",
    "start": "3236520",
    "end": "3242940"
  },
  {
    "text": "random they are pseudor random so it's really hard to guess squids",
    "start": "3242940",
    "end": "3249119"
  },
  {
    "text": "um they don't have like the full bit strength because there is uh they're also like time based and they have some",
    "start": "3249119",
    "end": "3255660"
  },
  {
    "text": "other information so they're not like super strong but to to if you just want",
    "start": "3255660",
    "end": "3261960"
  },
  {
    "text": "Randomness like so they're not easily guessed oh goods are a lot better than having uh",
    "start": "3261960",
    "end": "3269700"
  },
  {
    "text": "like sequential numeric IDs starting like one two three four you come a long way with the grid",
    "start": "3269700",
    "end": "3276800"
  },
  {
    "text": "other questions",
    "start": "3283680",
    "end": "3286460"
  },
  {
    "text": "okay thank you",
    "start": "3290160",
    "end": "3293359"
  }
]