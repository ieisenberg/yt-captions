[
  {
    "start": "0",
    "end": "473000"
  },
  {
    "text": "so I want to congratulating you guys because you must be the bravest people at NDC coming to a",
    "start": "7840",
    "end": "15330"
  },
  {
    "text": "crypto talk just after lunch so thanks for that the goal of this talk is to not",
    "start": "15330",
    "end": "21539"
  },
  {
    "text": "to dive into like how a es or some other encryption algorithm works internally",
    "start": "21539",
    "end": "26610"
  },
  {
    "text": "but rather talk about how to use or more how to not use encryption so quickly",
    "start": "26610",
    "end": "34559"
  },
  {
    "text": "about me I'm I work as a developer most of the time but also do security testing you do some bug bounty hunting and I'm",
    "start": "34559",
    "end": "43049"
  },
  {
    "text": "also the creator and maintainer of retired yes if anyone has used that and I'm head of a weapon or way but and also",
    "start": "43049",
    "end": "50400"
  },
  {
    "text": "i'm not a crypto expert I couldn't define an encryption algorithm if someone asked me to but I know a bit",
    "start": "50400",
    "end": "56280"
  },
  {
    "text": "about how to use it because I've studied it for some time ah Bruce Schneier says",
    "start": "56280",
    "end": "63110"
  },
  {
    "text": "anyone from the most clueless amateur to the best cryptographer trying to create an algorithm that he himself cannot",
    "start": "63110",
    "end": "70229"
  },
  {
    "text": "break and this is something you should remember never ever try to invent your",
    "start": "70229",
    "end": "75420"
  },
  {
    "text": "own encryption algorithm it's super hard and the people who are actually designing algorithms they're usually",
    "start": "75420",
    "end": "81420"
  },
  {
    "text": "like they build something then they ask someone else review it and then they find all kinds of slow us and then they",
    "start": "81420",
    "end": "86430"
  },
  {
    "text": "go back and forth like this forever so ah don't invent one yourself if you want",
    "start": "86430",
    "end": "92220"
  },
  {
    "text": "to learn more after this talk you should go do these like these crypto challenges these are super good and you can learn a",
    "start": "92220",
    "end": "99180"
  },
  {
    "text": "lot of the stuff that i'm going to show you by doing these and a lot more than that as well i'm going to use a bit of",
    "start": "99180",
    "end": "107159"
  },
  {
    "text": "code throughout or later in the session this is just some javascript stuff that i use so that i can do stuff like this",
    "start": "107159",
    "end": "113940"
  },
  {
    "text": "so i can have a variable with a string secret message and i can generate a key which is 16 bytes and then i could do",
    "start": "113940",
    "end": "120450"
  },
  {
    "text": "some encoding and stuff that's just to make things a bit faster when i do the demos so if you don't find these",
    "start": "120450",
    "end": "127229"
  },
  {
    "text": "functions in regular jas it's because they're not there but let's start so",
    "start": "127229",
    "end": "133080"
  },
  {
    "text": "first a couple of words that we need to know when we talk about crypto already using the words i'm going to use like",
    "start": "133080",
    "end": "138390"
  },
  {
    "text": "plain text that's the message that we want to send the actual data the ciphertext is the encrypted data we have a key which",
    "start": "138390",
    "end": "145460"
  },
  {
    "text": "we can use to encrypt or decrypt or sign we have an IV and nonsense those are",
    "start": "145460",
    "end": "151460"
  },
  {
    "text": "basically salts if you think in terms of passwords those add noise symmetric",
    "start": "151460",
    "end": "158150"
  },
  {
    "text": "encryption means we encrypt and decrypt with the same key and asymmetric encryption means we have a public key",
    "start": "158150",
    "end": "164480"
  },
  {
    "text": "which we can publicize anywhere and then we have a private key that we ourselves holes and then someone can encrypt the",
    "start": "164480",
    "end": "170750"
  },
  {
    "text": "message with the public key and only we can decrypt it and then the same thing holds for signing we have hydro",
    "start": "170750",
    "end": "175910"
  },
  {
    "text": "symmetric or asymmetric signing so why are we using crypto well there are a",
    "start": "175910",
    "end": "181910"
  },
  {
    "text": "couple of things that we want we might use it because we want confidentiality so we want to be able to exchange secret",
    "start": "181910",
    "end": "188450"
  },
  {
    "text": "messages we might also want to make sure that data hasn't been changed or they",
    "start": "188450",
    "end": "193700"
  },
  {
    "text": "can't be changed and we also often use it for identification typically we sign tokens and we pass those around and",
    "start": "193700",
    "end": "199850"
  },
  {
    "text": "those kind of prove that we are who we claim to be the next guy I'm going to",
    "start": "199850",
    "end": "207260"
  },
  {
    "text": "quote is a person called August kirchhoff's and if you see when he was",
    "start": "207260",
    "end": "212630"
  },
  {
    "text": "alive it's quite far back what he said was a cryptosystem should be secure even",
    "start": "212630",
    "end": "218030"
  },
  {
    "text": "if everything about the system except the key is public knowledge that means",
    "start": "218030",
    "end": "223459"
  },
  {
    "text": "that if you have an encryption algorithm that doesn't take a key it's not an encryption algorithm it's encoding so",
    "start": "223459",
    "end": "230780"
  },
  {
    "text": "the key is the thing that's going to protect those not knowledge about the algorithm itself so all the algorithms",
    "start": "230780",
    "end": "236750"
  },
  {
    "text": "that were using today like a s and all the other ones of course everything about how they work is probably get the",
    "start": "236750",
    "end": "243080"
  },
  {
    "text": "key that protects us when we're going to create this key we need to have a secure",
    "start": "243080",
    "end": "249680"
  },
  {
    "text": "random generator not something like this",
    "start": "249680",
    "end": "254560"
  },
  {
    "text": "but people are failing at this so there was a couple of researchers that we're",
    "start": "254830",
    "end": "260510"
  },
  {
    "text": "looking at hard drives and they figured out that some of these cells encrypting",
    "start": "260510",
    "end": "265760"
  },
  {
    "text": "hard drives they're not doing it in the right way so one of them was actually it was opposed to generate a big key but",
    "start": "265760",
    "end": "273800"
  },
  {
    "text": "that key was actually a small key repeated four times so it the actual entropy of it was like",
    "start": "273800",
    "end": "280700"
  },
  {
    "text": "32 bits instead of what we normally would want which is like 256 bits or something like that another thing is for",
    "start": "280700",
    "end": "289310"
  },
  {
    "text": "instance if you're using the non-secure random functions like this is the one from Java if you get two inch from that",
    "start": "289310",
    "end": "296840"
  },
  {
    "text": "random like you ask it give me an int give me another int and then or actually give give me along because along is two",
    "start": "296840",
    "end": "303590"
  },
  {
    "text": "inch just a pendant feature then you can reverse-engineer the state the internal",
    "start": "303590",
    "end": "309140"
  },
  {
    "text": "state of the random function and there's even some github code for it where you can test it yourself I played around",
    "start": "309140",
    "end": "317660"
  },
  {
    "text": "with an application this is quite a few months ago I was trying to start an",
    "start": "317660",
    "end": "323210"
  },
  {
    "text": "application in docker and the application wouldn't start and I was like what's going on why won't my",
    "start": "323210",
    "end": "328550"
  },
  {
    "text": "application start and it turned out this was a this was a web application and was trying to generate a key for sessions",
    "start": "328550",
    "end": "334670"
  },
  {
    "text": "but the docker container didn't have any entropy it didn't have any random source so just it was just hanging waiting for",
    "start": "334670",
    "end": "342140"
  },
  {
    "text": "more random so it could actually seed and start the application so that that was a problem either it's not a problem",
    "start": "342140",
    "end": "347840"
  },
  {
    "text": "with dr. anymore but it used to be like you couldn't get any random in there and this has also been a problem with debug",
    "start": "347840",
    "end": "353450"
  },
  {
    "text": "devices like a Wi-Fi routers where they would generate like these instead of every one every router coming with",
    "start": "353450",
    "end": "359750"
  },
  {
    "text": "security disabled they would have liked these default passwords but some of them",
    "start": "359750",
    "end": "364820"
  },
  {
    "text": "they were generating these passwords in the wrong way and so they were easily trackable when we talk about like the",
    "start": "364820",
    "end": "372950"
  },
  {
    "text": "length of a key we often end up talking about the birthday paradox so if there",
    "start": "372950",
    "end": "380030"
  },
  {
    "text": "are 23 people in a room that's enough to be quite sure that two of them have a",
    "start": "380030",
    "end": "385460"
  },
  {
    "text": "birthday at the same time which is kind of counterintuitive if you think about it because like 365 days you would think",
    "start": "385460",
    "end": "391820"
  },
  {
    "text": "it was more around like half of that not 23 which is fairly low but the thing is",
    "start": "391820",
    "end": "398870"
  },
  {
    "text": "we have to take into account that there are many things that has happened already so not only can you have the",
    "start": "398870",
    "end": "404540"
  },
  {
    "text": "same birthday as this person but you can have the same birthday as every other person in the room as well so the if we try to sort of calculated",
    "start": "404540",
    "end": "412390"
  },
  {
    "text": "it looks something like this and it's fairly close to the square root so we",
    "start": "412390",
    "end": "417790"
  },
  {
    "text": "often use the square root as an approximation and this means that if you can choose from 10,000 values you're",
    "start": "417790",
    "end": "424810"
  },
  {
    "text": "going to get a collision at after around 100 and if you have a key that's 2 to the 64 you're going to get a collision",
    "start": "424810",
    "end": "431380"
  },
  {
    "text": "after two to the 32 seconds which is also quite weird ah this is me just",
    "start": "431380",
    "end": "437890"
  },
  {
    "text": "calculating numbers between 0 & 999 and",
    "start": "437890",
    "end": "443140"
  },
  {
    "text": "seeing how many times do I need to do it before I get a duplicates so is here the average I got here was 116 and not a",
    "start": "443140",
    "end": "450580"
  },
  {
    "text": "hundred so but that's just the actual number is a bit higher than hundred but i got i found that wicked somewhere",
    "start": "450580",
    "end": "456400"
  },
  {
    "text": "after eleven here after 27 after ten and sometimes i have to go higher than what's expected and I can do this many",
    "start": "456400",
    "end": "463540"
  },
  {
    "text": "times the last number there is just the average so i can i can just keep going",
    "start": "463540",
    "end": "470140"
  },
  {
    "text": "and it stays at around the same place so I'm just doing numbers so once we have a",
    "start": "470140",
    "end": "477700"
  },
  {
    "start": "473000",
    "end": "510000"
  },
  {
    "text": "key now everything is super good like we create a master key and everything is fine and then we have this this tells us",
    "start": "477700",
    "end": "490330"
  },
  {
    "text": "something about the keys that we have and how we should handle them if it's",
    "start": "490330",
    "end": "497380"
  },
  {
    "text": "easy to get the key then it doesn't matter if we encrypted stuff really well so if we encrypt a lot of stuff and put",
    "start": "497380",
    "end": "503110"
  },
  {
    "text": "it in the database and we also put the key in the database sequel injection will extract all of that and it's back",
    "start": "503110",
    "end": "508990"
  },
  {
    "text": "to zero but ok so let's start trying to encrypt something so we're going to",
    "start": "508990",
    "end": "514780"
  },
  {
    "start": "510000",
    "end": "970000"
  },
  {
    "text": "start with an attempt at defining what we want so given a ciphertext it should",
    "start": "514780",
    "end": "521680"
  },
  {
    "text": "be impossible to find the plain text so if I want to communicate with one of you it should be impossible for everyone",
    "start": "521680",
    "end": "527050"
  },
  {
    "text": "else to to figure out what's going on the first thing we could do is we could share some keys up front so this is a",
    "start": "527050",
    "end": "535360"
  },
  {
    "text": "one-time pad from Wikipedia we get also and this was this is kind of used to",
    "start": "535360",
    "end": "540910"
  },
  {
    "text": "substitute letters but we can do it in a more computer friendly way so we can generate",
    "start": "540910",
    "end": "546670"
  },
  {
    "text": "random key and share that key so we we have columns of it and then we can X or",
    "start": "546670",
    "end": "551920"
  },
  {
    "text": "whatever we want to send with this key we just excerpt the letters together and then the shin is the same we just",
    "start": "551920",
    "end": "558550"
  },
  {
    "text": "excerpt the ciphertext than with the key so we have a plain text which is a message we generate a key and we take",
    "start": "558550",
    "end": "567430"
  },
  {
    "text": "the values that's all day the hex values of the letters and we XOR them and this",
    "start": "567430",
    "end": "573760"
  },
  {
    "text": "is the hyper text that we get that looks nice ok is there any problem with this",
    "start": "573760",
    "end": "580330"
  },
  {
    "text": "well first let's look at how extra works by the way so we do it bit by bit so if a looks like this and a lower case I",
    "start": "580330",
    "end": "588370"
  },
  {
    "text": "looks like this and space looks like this we see the difference between the capital a in the locus days it's",
    "start": "588370",
    "end": "595360"
  },
  {
    "text": "actually just the the third base is 0 and a 1 and the space character is actually the exact same thing so if we",
    "start": "595360",
    "end": "601660"
  },
  {
    "text": "XOR an a with space we at locating which is quite funny and we can do the same",
    "start": "601660",
    "end": "606700"
  },
  {
    "text": "with all the letters even just crazy Norwegian letters that we have here works for them as well and there are",
    "start": "606700",
    "end": "614410"
  },
  {
    "text": "some rules there as well if we XOR a letter with 1 1111 we get the exact opposite if we XOR it with 0 we get the",
    "start": "614410",
    "end": "622510"
  },
  {
    "text": "same thing back if we exert the same thing with itself we get 0 and it you",
    "start": "622510",
    "end": "627520"
  },
  {
    "text": "can switch them around it doesn't really matter and also if you have one thing that's exerted with something and you",
    "start": "627520",
    "end": "633490"
  },
  {
    "text": "XOR that with one thing that's extra with the same thing the 2 a's fair in this case they cancel each other out and",
    "start": "633490",
    "end": "639250"
  },
  {
    "text": "so the end result is the excerpt would see this sounds a bit why am I talking",
    "start": "639250",
    "end": "646090"
  },
  {
    "text": "about this we'll get to that in a second because the one-time pad its",
    "start": "646090",
    "end": "651120"
  },
  {
    "text": "confidentiality but wise quite secure for a single message it's super hard to",
    "start": "651120",
    "end": "657190"
  },
  {
    "text": "break it because I mean the key that we are using it could mean anything right there are a lot of different valid",
    "start": "657190",
    "end": "663670"
  },
  {
    "text": "values that could come out once we do the X or it could be secret message as I jordans just earlier or it could be like",
    "start": "663670",
    "end": "669880"
  },
  {
    "text": "a Britney Spears song with hit me baby one more time or whatever it doesn't matter it could be anything so we don't",
    "start": "669880",
    "end": "676090"
  },
  {
    "text": "know but the problem is we can only use the key ones that's not a nice thing for an",
    "start": "676090",
    "end": "682999"
  },
  {
    "text": "encryption scheme that's why it's called a one-time pad and how do we exchange the key because the key actually has to",
    "start": "682999",
    "end": "690620"
  },
  {
    "text": "be the same or longer than a message we want to send so we need to have some way",
    "start": "690620",
    "end": "696110"
  },
  {
    "text": "of actually transferring these fees and and for like all the encryption systems they used to have these like long long",
    "start": "696110",
    "end": "702829"
  },
  {
    "text": "paper things we're with the pads in them and they could transfer them upfront and",
    "start": "702829",
    "end": "708769"
  },
  {
    "text": "then they would have a secure messaging system but this is not very computer friendly for us why can we only use it",
    "start": "708769",
    "end": "715939"
  },
  {
    "text": "once well if we have obtained text and we exert with the key and we get a",
    "start": "715939",
    "end": "721279"
  },
  {
    "text": "ciphertext and we do the same thing with another plane txt what happens if we make sure the two cipher texts well the",
    "start": "721279",
    "end": "729709"
  },
  {
    "text": "keys cancel each other out and what we end up with is the one plain text excerpt with the other that doesn't work",
    "start": "729709",
    "end": "736490"
  },
  {
    "text": "well and if you have a lot of these then you can start looking at these in combining them and you will actually be",
    "start": "736490",
    "end": "742670"
  },
  {
    "text": "able to get back the original data that's one of the tasks on these critical challenges that you can play",
    "start": "742670",
    "end": "747800"
  },
  {
    "text": "with also if I know one cypher text and one plain text I can explore them",
    "start": "747800",
    "end": "754220"
  },
  {
    "text": "together and then I get the key which also isn't a nice feature and yeah if",
    "start": "754220",
    "end": "760089"
  },
  {
    "text": "the message is longer than the key then I would have to repeat the key and then I'm actually using the key more than",
    "start": "760089",
    "end": "765769"
  },
  {
    "text": "once so that doesn't work but all right there's also another problem here if I",
    "start": "765769",
    "end": "772459"
  },
  {
    "text": "can submit data to a system and have that system encrypted for me and get the",
    "start": "772459",
    "end": "777499"
  },
  {
    "text": "encrypting back well I could just send in a bunch of zeros and I would get the",
    "start": "777499",
    "end": "782509"
  },
  {
    "text": "key back which is also not a nice feature but for sure no one is doing",
    "start": "782509",
    "end": "788209"
  },
  {
    "text": "this right unfortunately that's not true there was an app called into walls which",
    "start": "788209",
    "end": "793939"
  },
  {
    "text": "was I think in android apps and it was used it had lots of downloads and it was supposed to encrypt everything you had",
    "start": "793939",
    "end": "799819"
  },
  {
    "text": "on your phone but first of all it only encrypted the first 128 bytes of each",
    "start": "799819",
    "end": "805730"
  },
  {
    "text": "file and the way that it was it took the password that you entered",
    "start": "805730",
    "end": "811080"
  },
  {
    "text": "and it took the hashcode of that and it did an and operation which means it's",
    "start": "811080",
    "end": "816960"
  },
  {
    "text": "reduced it to a single bite so now you have 256 different case so it's actually",
    "start": "816960",
    "end": "823170"
  },
  {
    "text": "easier to brute force the key than to brute force the password that's not a nice feature all right ah this doesn't",
    "start": "823170",
    "end": "830310"
  },
  {
    "text": "really work let's try to find a better definition so given a ciphertext it",
    "start": "830310",
    "end": "835380"
  },
  {
    "text": "should be put impossible to find the plaintext we want to stick with that one but we want to have a reusable key one",
    "start": "835380",
    "end": "841500"
  },
  {
    "text": "that we can use more than once and we also want to be able to have a plain text that's longer than the key and",
    "start": "841500",
    "end": "848870"
  },
  {
    "text": "there are a couple of ways we could go there are basically two types of fibers",
    "start": "848870",
    "end": "854280"
  },
  {
    "text": "or are actually more in this but two main types stream ciphers and block ciphers in a stream cipher we generate a",
    "start": "854280",
    "end": "862740"
  },
  {
    "text": "key f key stream from a key so we take the key as input we generate a long key from it and then we can do exactly as we",
    "start": "862740",
    "end": "870150"
  },
  {
    "text": "did with the we can do exactly as we did with the one-time pad we kind of just",
    "start": "870150",
    "end": "875190"
  },
  {
    "text": "extra stuff together and then we get some of it one example is our c4 but",
    "start": "875190",
    "end": "880350"
  },
  {
    "text": "that's not something we should use anymore because it's been probably broken it it has a tendency to have one",
    "start": "880350",
    "end": "886800"
  },
  {
    "text": "of the bits the one more or more often than a serial or the other way around that's enough to break it it does",
    "start": "886800",
    "end": "894780"
  },
  {
    "text": "support having a plain text length larger than the key size because you're sort of stretching the key out ah it",
    "start": "894780",
    "end": "901200"
  },
  {
    "text": "does however kind of leak the plain text link so if we look at this this is a",
    "start": "901200",
    "end": "906260"
  },
  {
    "text": "voting database where we have four different boats and I'm pretty sure you can figure out who voted no so I",
    "start": "906260",
    "end": "913950"
  },
  {
    "text": "encrypted all of them with the same key alright so let's encrypt them with different keys well you can kind of",
    "start": "913950",
    "end": "920010"
  },
  {
    "text": "still figure out which one voted no because it's shorter than the others all",
    "start": "920010",
    "end": "925380"
  },
  {
    "text": "right let's look at block ciphers instead so the way block ciphers work is",
    "start": "925380",
    "end": "930570"
  },
  {
    "text": "we split the data into blocks of a given size and we encrypt each block separately so AES is an example of this",
    "start": "930570",
    "end": "937110"
  },
  {
    "text": "or des or crippled s is also an example of this the first way we could go was",
    "start": "937110",
    "end": "942510"
  },
  {
    "text": "something called the electronic cook mode so we take our plain text and we have our encryption function that takes",
    "start": "942510",
    "end": "948540"
  },
  {
    "text": "a key and then we split the plain text into blocks we pads the last one we move",
    "start": "948540",
    "end": "954360"
  },
  {
    "text": "run them all through this encryption function and there's our cipher text and when we want to decrypt it we spit it",
    "start": "954360",
    "end": "961050"
  },
  {
    "text": "back into blocks we take the decryption function taking the same key run them through remove the padding and we have",
    "start": "961050",
    "end": "969180"
  },
  {
    "text": "our plain text back but the problem is what happens if two blocks are equal now",
    "start": "969180",
    "end": "975390"
  },
  {
    "text": "AES is a for instance is a deterministic algorithm there's no randomness involved",
    "start": "975390",
    "end": "980640"
  },
  {
    "text": "so if you have the same key and the same plain text you get the same ciphertext block which means if you encrypt the",
    "start": "980640",
    "end": "987600"
  },
  {
    "text": "linux penguin you can easily from the just studying the bits you can sort of reverse engineer the picture that's",
    "start": "987600",
    "end": "994140"
  },
  {
    "text": "buying it all right so what what is the",
    "start": "994140",
    "end": "999690"
  },
  {
    "text": "natural next step was to find some other modes where we kind of add some noise this is where the IV comes in so there's",
    "start": "999690",
    "end": "1006080"
  },
  {
    "text": "something called CBC cipher block chaining mode so we start out the same",
    "start": "1006080",
    "end": "1011660"
  },
  {
    "text": "way with better spit up and we pad but then we introduce this IV and what we do",
    "start": "1011660",
    "end": "1017330"
  },
  {
    "text": "with the IV's we XOR is with the plain text before encrypting and then we take",
    "start": "1017330",
    "end": "1023420"
  },
  {
    "text": "this first block of ciphertext and we expert that with the next one so we kind of propagate the noise that we got from",
    "start": "1023420",
    "end": "1029270"
  },
  {
    "text": "the IV throughout so we go ahead like this and we get our ciphertext and we",
    "start": "1029270",
    "end": "1034699"
  },
  {
    "text": "usually then send it together with the IV to the one who wants to decrypt it and it goes like this so we run it",
    "start": "1034699",
    "end": "1042350"
  },
  {
    "text": "through the algorithm we XOR it and we get it back and then we take this thing and it works like this fairly simple now",
    "start": "1042350",
    "end": "1049460"
  },
  {
    "text": "we've propagated some noise through it should be it so now we won't have the linux linux penguin problem anymore but",
    "start": "1049460",
    "end": "1056900"
  },
  {
    "text": "there are some other problems here so on the on the left hand side here we have",
    "start": "1056900",
    "end": "1062690"
  },
  {
    "text": "the ID that's the i0 i1 that's the individual bytes of the IV and on the",
    "start": "1062690",
    "end": "1068060"
  },
  {
    "text": "right hand side with the say you have the ciphertext cybertek spikes and when we decrypt this we first get what we",
    "start": "1068060",
    "end": "1074330"
  },
  {
    "text": "call an intermediate value and then we extra it with the IV and outcome the plaintext fairly simple so if we",
    "start": "1074330",
    "end": "1080479"
  },
  {
    "text": "change a single bit up there in the ciphertext because of the way it is a",
    "start": "1080479",
    "end": "1086869"
  },
  {
    "text": "decryption algorithm work that will completely change the intermediate value it will become something completely",
    "start": "1086869",
    "end": "1091999"
  },
  {
    "text": "different and thus when we exert with the IV the end result is probably going",
    "start": "1091999",
    "end": "1098239"
  },
  {
    "text": "to be garbage however if we change a single bit in the IV we will only change",
    "start": "1098239",
    "end": "1104960"
  },
  {
    "text": "a single bit in the results and this is something we can use so let's say we",
    "start": "1104960",
    "end": "1110929"
  },
  {
    "text": "have something looking like this so this could be like a signed cookie or an encrypted cooking i'm going to say",
    "start": "1110929",
    "end": "1116659"
  },
  {
    "text": "unencrypted cookie with the adjacent there's a user ID five if we change the",
    "start": "1116659",
    "end": "1122779"
  },
  {
    "text": "eleventh bite of the IV we would change the outcome of the eleventh bite here in",
    "start": "1122779",
    "end": "1129859"
  },
  {
    "text": "the plain text so if we remember the extra stuff we could say okay so the the",
    "start": "1129859",
    "end": "1137419"
  },
  {
    "text": "letter five has an ASCII value of x 35 so we know that I 11 and d 11 that",
    "start": "1137419",
    "end": "1144950"
  },
  {
    "text": "becomes certified and we wanted to become a 1 because we want to be user with ID one that's usually the admin so",
    "start": "1144950",
    "end": "1152389"
  },
  {
    "text": "we can calculate it and figure out that what we want is just to take the original value up there we XOR it with",
    "start": "1152389",
    "end": "1159679"
  },
  {
    "text": "35 and 31 and thus it becomes one so but",
    "start": "1159679",
    "end": "1166009"
  },
  {
    "text": "this is this is boring to just see on the slide so here I have this nice",
    "start": "1166009",
    "end": "1171649"
  },
  {
    "text": "little application where I can log in and out with a password but I own I can only log in as Homer because that's the only guy I know the password for but",
    "start": "1171649",
    "end": "1178700"
  },
  {
    "text": "there's a cookie here",
    "start": "1178700",
    "end": "1181988"
  },
  {
    "text": "and okay so there's something called session 2 and something that looked kind of like some some encrypted stuff at",
    "start": "1187370",
    "end": "1194840"
  },
  {
    "text": "this base 64 so we could go ahead and we could try to to grab that one so we can",
    "start": "1194840",
    "end": "1200180"
  },
  {
    "text": "say okay I'm going to split on a spit on the semicolon sign take the first part",
    "start": "1200180",
    "end": "1205610"
  },
  {
    "text": "played on the equals take the second part and that would give me that value okay and then I can take that and I can",
    "start": "1205610",
    "end": "1213340"
  },
  {
    "text": "base64 decode it so this is the functions i talked about earlier and then convert it to a bike a ring like",
    "start": "1213340",
    "end": "1221690"
  },
  {
    "text": "this i'm going to store that in variable so i can play with it so now i have the",
    "start": "1221690",
    "end": "1228380"
  },
  {
    "text": "the ciphertext as a x derivative so now i'm going to change the letters so I'm",
    "start": "1228380",
    "end": "1237140"
  },
  {
    "text": "gonna take the H up there maybe this is a bit too small i'm gonna try to make it a bit larger so i'm going to take the",
    "start": "1237140",
    "end": "1244550"
  },
  {
    "text": "age up there and I'm gonna XOR it with the a then I'm going to first expert",
    "start": "1244550",
    "end": "1249950"
  },
  {
    "text": "with an H to get it down to zero and then with an A and then I can do the same thing with the next one because I",
    "start": "1249950",
    "end": "1256790"
  },
  {
    "text": "want to become the admin of course so I can go I'd love em in admin and Homer is",
    "start": "1256790",
    "end": "1262910"
  },
  {
    "text": "at the same spots I'm not going to touch that one I'm going to change the 12th",
    "start": "1262910",
    "end": "1268309"
  },
  {
    "text": "one and the 13 1 so just doing the same operation all over again and then I'm",
    "start": "1268309",
    "end": "1275150"
  },
  {
    "text": "going to pack it back into the to the cookie like this i'm going to take the",
    "start": "1275150",
    "end": "1280790"
  },
  {
    "text": "i'm going to set a new cookie called session to so i'm going to overwrite the old one i'm going to take this array that and I've changed and i'm going to",
    "start": "1280790",
    "end": "1287420"
  },
  {
    "text": "create a string from it and then basically four encoded and when I now refresh hopefully I've become the admin",
    "start": "1287420",
    "end": "1294830"
  },
  {
    "text": "so I've changed the countenance and I wasn't supposed to be able to do that I would get so that's that's not exactly",
    "start": "1294830",
    "end": "1304790"
  },
  {
    "text": "what many people are expecting when they're encrypting stuff like that okay so we can change stuff that's not good",
    "start": "1304790",
    "end": "1310610"
  },
  {
    "text": "but encryption isn't the same as signing that's why we have two different things called signing and encryption and",
    "start": "1310610",
    "end": "1316490"
  },
  {
    "text": "encryption doesn't imply signing in many cases not for this one-time pad I because we could just flip it and I",
    "start": "1316490",
    "end": "1322940"
  },
  {
    "text": "would flip the end result all right when we're patting this this is also",
    "start": "1322940",
    "end": "1328940"
  },
  {
    "start": "1325000",
    "end": "1625000"
  },
  {
    "text": "interesting there are many ways of padding data to make it compliant with the block size one of the most common",
    "start": "1328940",
    "end": "1335539"
  },
  {
    "text": "one is called Kiki pkcs7 and we basically add let's say we needed to add",
    "start": "1335539",
    "end": "1341990"
  },
  {
    "text": "seven padding bytes then we set all these 27 and if we need at six with seven to six and for the last thing if",
    "start": "1341990",
    "end": "1349039"
  },
  {
    "text": "it if the main tech actually is at the block sites we need to add an entire padding block because it or else it",
    "start": "1349039",
    "end": "1356029"
  },
  {
    "text": "wouldn't be able to separate if the p7 here was a seven and it then would think",
    "start": "1356029",
    "end": "1361250"
  },
  {
    "text": "it oh I need to remove all the all the padding and it would be wrong so then we need to add an entire padding block so",
    "start": "1361250",
    "end": "1367879"
  },
  {
    "text": "why is this interesting well a lot of frameworks if you do if you mess with",
    "start": "1367879",
    "end": "1373429"
  },
  {
    "text": "the padding so here it says they're supposed to be a free and according to do this then there should be 3 33 but",
    "start": "1373429",
    "end": "1379850"
  },
  {
    "text": "here is 3 10 5 and then we will typically get an exception so the",
    "start": "1379850",
    "end": "1384980"
  },
  {
    "text": "decryption function will say hey the padding is wrong I try to remove this but the first one is a 3 the next was a",
    "start": "1384980",
    "end": "1390080"
  },
  {
    "text": "10 that doesn't make sense and we'll get like a padding is invalid or something and this is actually enough to decrypt",
    "start": "1390080",
    "end": "1397370"
  },
  {
    "text": "the data because we can abuse it so",
    "start": "1397370",
    "end": "1402559"
  },
  {
    "text": "again I have the same setup I have the IV on the left and the cipher text on the right but now I know nothing about",
    "start": "1402559",
    "end": "1410360"
  },
  {
    "text": "the values here so that's why there ? so first I'm going to take a copy of the",
    "start": "1410360",
    "end": "1416629"
  },
  {
    "text": "original ID up there because that's the original idea that was used to encrypt it so I'm going to take a copy of it down there and then I'm just going to",
    "start": "1416629",
    "end": "1422659"
  },
  {
    "text": "randomize put a completely different I be up there which is very likely going to cause the end result of the",
    "start": "1422659",
    "end": "1429409"
  },
  {
    "text": "decryption to be garbage and then I'm going to get a padding error because",
    "start": "1429409",
    "end": "1435039"
  },
  {
    "text": "it's likely not going to be a valid padding the thing I'm going to do next",
    "start": "1435039",
    "end": "1440210"
  },
  {
    "text": "is I'm going to start the last bite of the IV i'm going to start flipping it",
    "start": "1440210",
    "end": "1446570"
  },
  {
    "text": "i'm going to start at zero and then go all the way up to 255 at some point i will get a valid padding because then",
    "start": "1446570",
    "end": "1453679"
  },
  {
    "text": "this thing ba1 so let's go ahead and do this I'm not sending a request to the server sending lots of requests through the",
    "start": "1453679",
    "end": "1460130"
  },
  {
    "text": "server and you can see it's going up it's going up it's going up and at some point it will tell me hey this will this",
    "start": "1460130",
    "end": "1467540"
  },
  {
    "text": "was a valid padding when I get a 1 sometimes it happens early sometimes it's happens at all the way to work",
    "start": "1467540",
    "end": "1474890"
  },
  {
    "text": "again we'll see how lucky we have to bathe looks like it's going to be all the way to our say okay so there if I",
    "start": "1474890",
    "end": "1480980"
  },
  {
    "text": "sent in da there I got a 1 so now I know that this is the one and then I can",
    "start": "1480980",
    "end": "1487970"
  },
  {
    "text": "excerpt that with da to get that value and then they can exploit that value with this values to get this value I",
    "start": "1487970",
    "end": "1494230"
  },
  {
    "text": "know this is kind of hard to grasp and went just after lunch and everything but it's that's the way it works so now I",
    "start": "1494230",
    "end": "1501320"
  },
  {
    "text": "know that it's a three and i know that this one was padded with three the original message then I change this one",
    "start": "1501320",
    "end": "1507890"
  },
  {
    "text": "to become a two and I try to brute force the next character to change this one to become a two I simply have to take the",
    "start": "1507890",
    "end": "1515210"
  },
  {
    "text": "last slice and extra it with the one and A two so we go back to zero and then we go to two and then I can start reversing",
    "start": "1515210",
    "end": "1521840"
  },
  {
    "text": "the next one and this is speeding up now so it's not going to be as slow as it",
    "start": "1521840",
    "end": "1527240"
  },
  {
    "text": "was for the first one because it's it's going to take a bit of time to brute force all of them so the cool thing",
    "start": "1527240",
    "end": "1533570"
  },
  {
    "text": "about this if you've seen a movie where they're attacking something and they come up to door and they have this card",
    "start": "1533570",
    "end": "1538760"
  },
  {
    "text": "that they're sticking in and like oh yeah now we're going to get the password back and you get this they guess it's one character at the time well this is",
    "start": "1538760",
    "end": "1545750"
  },
  {
    "text": "the exact thing that's going to happen here right now look at this it's finding one letter at the time you can see now",
    "start": "1545750",
    "end": "1553010"
  },
  {
    "text": "it's now is speeding up so it should be [Music] but look at the request count over there",
    "start": "1553010",
    "end": "1560780"
  },
  {
    "text": "so I would have to spend a lot of requests to the server to do this and",
    "start": "1560780",
    "end": "1566320"
  },
  {
    "text": "soon we will have the very boring message that was actually encrypted here",
    "start": "1566320",
    "end": "1571490"
  },
  {
    "text": "the funny thing is this is actually running in the browser right now",
    "start": "1571490",
    "end": "1576580"
  },
  {
    "text": "almost there and there we go so stolen",
    "start": "1578630",
    "end": "1587960"
  },
  {
    "text": "secret that was the plaintext so by using this we were actually able to get the original message back without",
    "start": "1587960",
    "end": "1594170"
  },
  {
    "text": "knowing the key just by abusing the padding so why why is this important well there has been boxed around this",
    "start": "1594170",
    "end": "1600620"
  },
  {
    "text": "like in in two thousand 2010 there was this problem with the way that files",
    "start": "1600620",
    "end": "1607040"
  },
  {
    "text": "were being downloaded from or actually Ajax and JavaScript files were downloaded using asp.net the thing is",
    "start": "1607040",
    "end": "1613730"
  },
  {
    "text": "you can actually use a padding Oracle also to encrypt messages so you could change this to be the file that you",
    "start": "1613730",
    "end": "1619850"
  },
  {
    "text": "wanted for instance web config and you could download that by using this this error and there's been a lot of them in",
    "start": "1619850",
    "end": "1626480"
  },
  {
    "start": "1625000",
    "end": "1685000"
  },
  {
    "text": "TLS and where ssl as well example hair poodle which is padding Oracle on",
    "start": "1626480",
    "end": "1634250"
  },
  {
    "text": "downgraded legacy encryption so there's padding Oracle again and there was one last year which someone called lucky",
    "start": "1634250",
    "end": "1641330"
  },
  {
    "text": "negative 20 or something but it was also a padding Oracle problem in TLS okay so",
    "start": "1641330",
    "end": "1648020"
  },
  {
    "text": "let's let's kind of try and avoid these padding Oracle so let's do something like this can anyone tell me what's",
    "start": "1648020",
    "end": "1655430"
  },
  {
    "text": "wrong with this code make sense right we",
    "start": "1655430",
    "end": "1661280"
  },
  {
    "text": "okay so if the decryption fails we get up adding exception and then we return not found and that's the same thing that",
    "start": "1661280",
    "end": "1666650"
  },
  {
    "text": "we're going to yes it takes a different amount of time because if the value is",
    "start": "1666650",
    "end": "1673700"
  },
  {
    "text": "correct we're going to look it up if it's not correct we're just going to go straight down here so we have a timing",
    "start": "1673700",
    "end": "1679160"
  },
  {
    "text": "problem this was actually a timing problem the one I just talked about and",
    "start": "1679160",
    "end": "1685130"
  },
  {
    "start": "1685000",
    "end": "1769000"
  },
  {
    "text": "there are a lot of other of these sides channels as we call them as well it could be response time or computation",
    "start": "1685130",
    "end": "1692000"
  },
  {
    "text": "time it could be cpu usage it could be power consumption if you can measure a power consumption that's something they",
    "start": "1692000",
    "end": "1697430"
  },
  {
    "text": "often do if they're attacking like chips on smart cards or things like that it could be electromagnetic leaks it could",
    "start": "1697430",
    "end": "1704120"
  },
  {
    "text": "be the size and more stuff so here's an example of a size problem in this case",
    "start": "1704120",
    "end": "1710150"
  },
  {
    "text": "the headers of an HTTP request are compressed so if we create if we are",
    "start": "1710150",
    "end": "1715610"
  },
  {
    "text": "as an attacker can make someone's browser do a request and we can observe the links of the data as its flowing",
    "start": "1715610",
    "end": "1721820"
  },
  {
    "text": "over the wire like let's say we're sniffing a a conference network we will",
    "start": "1721820",
    "end": "1727220"
  },
  {
    "text": "see a difference in the encryption here or actually on the size because of the compression so the first one will say je",
    "start": "1727220",
    "end": "1733399"
  },
  {
    "text": "session equals a and then an excellent such a session equals B but if we get get it right it's sort of shrinks a bit",
    "start": "1733399",
    "end": "1740210"
  },
  {
    "text": "and that's enough to also decrypt data and then there's this thing I found the",
    "start": "1740210",
    "end": "1746029"
  },
  {
    "text": "other day I'm going to assume in a bit by measuring the targets electromagnetic emanations the attacker extracts the",
    "start": "1746029",
    "end": "1753289"
  },
  {
    "text": "sacred decryption key within seconds from a target located in an adjacent room across a wall that's kind of scary",
    "start": "1753289",
    "end": "1760389"
  },
  {
    "text": "just by like measuring radiation from your laptop they can get the encryption",
    "start": "1760389",
    "end": "1765860"
  },
  {
    "text": "key all right but what if we kind of could get also our integrity from",
    "start": "1765860",
    "end": "1773570"
  },
  {
    "start": "1769000",
    "end": "1920000"
  },
  {
    "text": "encryption there is something called authenticated encryption and what we're",
    "start": "1773570",
    "end": "1779240"
  },
  {
    "text": "doing when we're using authenticated encryption is that the encryption algorithm also generates a tag or a Mac on the data and that proves that it",
    "start": "1779240",
    "end": "1785899"
  },
  {
    "text": "hasn't been tampered with so that would foil our previous attacks an example of such algorithms are AES GCM or a sec em",
    "start": "1785899",
    "end": "1793639"
  },
  {
    "text": "you've probably seen a GCM used on the web now it's often used in TLS connections but it has some weird",
    "start": "1793639",
    "end": "1800899"
  },
  {
    "text": "properties as well so both GCM and CCM are based on something called aes",
    "start": "1800899",
    "end": "1805940"
  },
  {
    "text": "counter mode and a is counter mode works like this so we take the plaintext and",
    "start": "1805940",
    "end": "1811070"
  },
  {
    "text": "we generate a non a number to be used only once we split it into three blocks",
    "start": "1811070",
    "end": "1819830"
  },
  {
    "text": "because we're gonna need three blocks in this case and this is the counter that's why it's called the counter mode because",
    "start": "1819830",
    "end": "1825499"
  },
  {
    "text": "this essentially becomes the counter so the first log is of 0 1 2 etc and then we encrypt these counters to generate a",
    "start": "1825499",
    "end": "1834230"
  },
  {
    "text": "key stream and then we remove the stuff that we don't need from the key stream",
    "start": "1834230",
    "end": "1839809"
  },
  {
    "text": "and then we excerpt them together and we get the ciphertext and we send that off and then the",
    "start": "1839809",
    "end": "1847119"
  },
  {
    "text": "receiving party can do the same thing it takes the nonce adds to these numbers and encrypts them and you can see it",
    "start": "1847119",
    "end": "1854210"
  },
  {
    "text": "happens in parallel that's why a lot of people like to see em because you can encrypt the individual blocks in parallel in cbc you would have you",
    "start": "1854210",
    "end": "1860720"
  },
  {
    "text": "always needed a result from the previous operation so it's not paralyzed able but this one is and then we have the key",
    "start": "1860720",
    "end": "1867289"
  },
  {
    "text": "stream we drop the stuff that we don't need we exert them together and then we get the same text back now the problem",
    "start": "1867289",
    "end": "1873619"
  },
  {
    "text": "here is what happens if we reuse the nuns then we get the same key stream and",
    "start": "1873619",
    "end": "1880340"
  },
  {
    "text": "then we're back to the one-time pad right if we XOR two things together so this is how you see'em actually looks",
    "start": "1880340",
    "end": "1886419"
  },
  {
    "text": "the stuff that i just talked about it was going on up here and but there's some stuffs going out here and so stuff",
    "start": "1886419",
    "end": "1892279"
  },
  {
    "text": "which takes the which generates this tag that's going on down here and we get a",
    "start": "1892279",
    "end": "1897320"
  },
  {
    "text": "tag at the end so this is what what kind of GCM adds a to is a CTR and and",
    "start": "1897320",
    "end": "1904700"
  },
  {
    "text": "there's been problems with this as well there was something called the forbidden attacks on GC MHT HTTP s where it was",
    "start": "1904700",
    "end": "1912320"
  },
  {
    "text": "found that some implementations they would reuse the nonce from time to time and then it all falls apart the next",
    "start": "1912320",
    "end": "1921169"
  },
  {
    "start": "1920000",
    "end": "1986000"
  },
  {
    "text": "thing is asymmetric encryption so we're just going to briefly talk about that",
    "start": "1921169",
    "end": "1926739"
  },
  {
    "text": "the most common one that people are familiar with is probably RSA RSA",
    "start": "1926739",
    "end": "1932570"
  },
  {
    "text": "actually has this property that's if we're going to take a plain text we can only encrypt something that that's lower",
    "start": "1932570",
    "end": "1938749"
  },
  {
    "text": "than the key link i think it even has to be long a bit shorter than the key length but usually the way we do this is",
    "start": "1938749",
    "end": "1946279"
  },
  {
    "text": "we generate a symmetric key because symmetric encryption is a lot faster than a symmetric encryption and then we",
    "start": "1946279",
    "end": "1951559"
  },
  {
    "text": "encrypt the data with this symmetric key and then we encrypt the symmetric key with the RSA key so this is the way",
    "start": "1951559",
    "end": "1957019"
  },
  {
    "text": "HTTPS or GLS works this is a good algorithm for doing that this is not so",
    "start": "1957019",
    "end": "1964070"
  },
  {
    "text": "good but this is very very common still and if you have to be cryptography",
    "start": "1964070",
    "end": "1969259"
  },
  {
    "text": "professor Matthew Greene he says peaky pkcs12 five is awesome if you're",
    "start": "1969259",
    "end": "1976070"
  },
  {
    "text": "teaching a class on how to attack cryptographic protocols in all other circumstances it sucks so all",
    "start": "1976070",
    "end": "1982940"
  },
  {
    "text": "right we shouldn't use that anymore if we're going to like try to use for",
    "start": "1982940",
    "end": "1989450"
  },
  {
    "start": "1986000",
    "end": "2050000"
  },
  {
    "text": "instance CBC we need to add integrity to it so we could do something like this we",
    "start": "1989450",
    "end": "1994700"
  },
  {
    "text": "could take our ciphertext we can encrypt it and then we could sign it with a signature algorithm and then we can send",
    "start": "1994700",
    "end": "2001690"
  },
  {
    "text": "that over to the client and then the client should check the signature first and then decrypt it because then the",
    "start": "2001690",
    "end": "2008050"
  },
  {
    "text": "signature will fail if you tampered with it so we wouldn't have a padding Oracle it's super important to check the",
    "start": "2008050",
    "end": "2014530"
  },
  {
    "text": "signature first but all right let's talk a bit more about signing so the first",
    "start": "2014530",
    "end": "2020230"
  },
  {
    "text": "thing to note is don't invent your own signing there's a lot of people who are trying to be clever and they're doing",
    "start": "2020230",
    "end": "2026890"
  },
  {
    "text": "something like this so the signature that we're going to have is we use md5 and we take a secret key that only we",
    "start": "2026890",
    "end": "2032260"
  },
  {
    "text": "know and we take the message we want to sign and we just concatenate them together and we generate a signature it",
    "start": "2032260",
    "end": "2037960"
  },
  {
    "text": "doesn't matter if it's sha-256 or if it's 75 it doesn't really matter even putting this secret at the end is not a",
    "start": "2037960",
    "end": "2044470"
  },
  {
    "text": "good thing this is why we have something called H max we should use that instead",
    "start": "2044470",
    "end": "2049530"
  },
  {
    "text": "an example from Flickr they had an API back in 2009 that was using this",
    "start": "2049530",
    "end": "2055179"
  },
  {
    "start": "2050000",
    "end": "2171000"
  },
  {
    "text": "construct of secret plus something in the md5 and they have some other issues",
    "start": "2055179",
    "end": "2060460"
  },
  {
    "text": "as well if these were the URL parameters it would do a normalization of that we",
    "start": "2060460",
    "end": "2066760"
  },
  {
    "text": "just remove the ampersands and the equal signs and shove them after the secret",
    "start": "2066760",
    "end": "2072310"
  },
  {
    "text": "and then that's what would be signed the problem is that according to this algorithm these two are the exact same",
    "start": "2072310",
    "end": "2079090"
  },
  {
    "text": "because was it a be with this value or was it actually bar to and etc etc it",
    "start": "2079090",
    "end": "2084580"
  },
  {
    "text": "doesn't know to briefly explain how this works imagine let's we have some data",
    "start": "2084580",
    "end": "2092050"
  },
  {
    "text": "and we want to sign it so the purple stuff here that's the secret that only",
    "start": "2092050",
    "end": "2097120"
  },
  {
    "text": "the owners of the side note and that the blue stuff is the data so also md5 is a",
    "start": "2097120",
    "end": "2102550"
  },
  {
    "text": "block page so which made it up into blocks wee pads the last block and then",
    "start": "2102550",
    "end": "2108310"
  },
  {
    "text": "we run the same function with the previous thing as input so first we start out with what's called",
    "start": "2108310",
    "end": "2113320"
  },
  {
    "text": "the escrow which is like a starting value for md5 and then we run the function on it and mix those two",
    "start": "2113320",
    "end": "2119260"
  },
  {
    "text": "together and then we take the output of that and mix it with the next block and then the next block and we end up with a",
    "start": "2119260",
    "end": "2125650"
  },
  {
    "text": "with this result the problem here is you can do something called the length extension attacked if you for some",
    "start": "2125650",
    "end": "2131170"
  },
  {
    "text": "reason wanted to have something that incidentally had the same padding value",
    "start": "2131170",
    "end": "2138040"
  },
  {
    "text": "here so let's go back a bit so if this",
    "start": "2138040",
    "end": "2143050"
  },
  {
    "text": "thing has the exact same padding value here these things the first part here is",
    "start": "2143050",
    "end": "2148120"
  },
  {
    "text": "equal so if we have the output of this we can simply use that here and add new",
    "start": "2148120",
    "end": "2157960"
  },
  {
    "text": "data and add a new valid padding and thus with added stuff to an already valid signature this is pretty bad so",
    "start": "2157960",
    "end": "2171720"
  },
  {
    "start": "2171000",
    "end": "2394000"
  },
  {
    "text": "use H max if you're going to sign stuff with a symmetric key if you're going to",
    "start": "2172020",
    "end": "2177490"
  },
  {
    "text": "do it with a private key or an asymmetric signing you could use elliptic curve cryptography or you could",
    "start": "2177490",
    "end": "2184540"
  },
  {
    "text": "use RSA if you're gonna use RSA use a decent padding scheme and not this P",
    "start": "2184540",
    "end": "2191620"
  },
  {
    "text": "cases or 15 again because that's broken there as well signatures are used in",
    "start": "2191620",
    "end": "2199750"
  },
  {
    "text": "many different places and one of them is in XML so I'm going to briefly explain",
    "start": "2199750",
    "end": "2206110"
  },
  {
    "text": "how XML signatures work so we have this token and we're adding a signature and",
    "start": "2206110",
    "end": "2212910"
  },
  {
    "text": "signature consists of a signature tag and there's a signed info tags inside it",
    "start": "2212910",
    "end": "2217930"
  },
  {
    "text": "and the signed info is basically saying how this thing is signed so first it",
    "start": "2217930",
    "end": "2223660"
  },
  {
    "text": "tells us which canonicalization method is being used that's to ensure that the verifier and the signer sees the same",
    "start": "2223660",
    "end": "2230470"
  },
  {
    "text": "XML because XML can be in a lot of different ways like you can have an empty tag that's a start tag an end tag",
    "start": "2230470",
    "end": "2235960"
  },
  {
    "text": "or you can merge them together and have the slash at the end you could have white space between tags and not etc etc",
    "start": "2235960",
    "end": "2242530"
  },
  {
    "text": "what kind of the canonicalization is about and here we say the signature method that we're going to use is our essay and we're going to use sha-1 as",
    "start": "2242530",
    "end": "2249040"
  },
  {
    "text": "the hashing algorithm then there's a reference and the reference tells us",
    "start": "2249040",
    "end": "2254080"
  },
  {
    "text": "which element is actually signed so in this case it says something with an ID",
    "start": "2254080",
    "end": "2260050"
  },
  {
    "text": "of underscore 0 which is the username up here so this one has an ID of underscore",
    "start": "2260050",
    "end": "2265720"
  },
  {
    "text": "0 so this is the thing that's going to be signed and then it tells us how that one is canonicalize and then it's being",
    "start": "2265720",
    "end": "2273670"
  },
  {
    "text": "hashed so here we say we're using sha-1 as the hash function and this is the hash of this element and then what we're",
    "start": "2273670",
    "end": "2282880"
  },
  {
    "text": "actually signing with XML signature is this find info element so we can have",
    "start": "2282880",
    "end": "2288850"
  },
  {
    "text": "multiple references in here and then we end up signing this so we're kind of signing a hash of something that's",
    "start": "2288850",
    "end": "2294190"
  },
  {
    "text": "already a hash of something else and it's kind of weird but that's the way it works what's wrong with this code who",
    "start": "2294190",
    "end": "2303730"
  },
  {
    "text": "can tell me what's wrong here it's very",
    "start": "2303730",
    "end": "2309550"
  },
  {
    "text": "obvious when you know it it's not necessarily if you haven't seen it before yes it's not a timing attack in",
    "start": "2309550",
    "end": "2317620"
  },
  {
    "text": "this case yeah we'll get back to that",
    "start": "2317620",
    "end": "2325260"
  },
  {
    "text": "yes",
    "start": "2325260",
    "end": "2328260"
  },
  {
    "text": "yeah we'll get back to that as well the thing here is it says valid there's a",
    "start": "2330940",
    "end": "2337130"
  },
  {
    "text": "hint or validate all the signatures yeah what if there are no signatures it's",
    "start": "2337130",
    "end": "2343160"
  },
  {
    "text": "going to pass right okay so we need to be clever let's check that it's actually",
    "start": "2343160",
    "end": "2348680"
  },
  {
    "text": "signed and validate all the signatures and then we're going to grab the",
    "start": "2348680",
    "end": "2353720"
  },
  {
    "text": "username from this xml that we have huh but this is wrong as well and now we get",
    "start": "2353720",
    "end": "2358849"
  },
  {
    "text": "what you two guys were saying are we actually signing the stuff that we're using what happens if we move this user",
    "start": "2358849",
    "end": "2366920"
  },
  {
    "text": "name underneath somewhere tag that we don't care about and introduce a new user name of here well this thing is",
    "start": "2366920",
    "end": "2373579"
  },
  {
    "text": "still going to be a valid signature of this element it doesn't care if it has been moved it just looks for something",
    "start": "2373579",
    "end": "2379579"
  },
  {
    "text": "with the ID of underscore zero and it's there so this is still a valid signature of this element but this xpath function",
    "start": "2379579",
    "end": "2387589"
  },
  {
    "text": "at the end here will actually find this one all right maybe we can try to do",
    "start": "2387589",
    "end": "2395210"
  },
  {
    "start": "2394000",
    "end": "2479000"
  },
  {
    "text": "that as well so I have a sign-in button here and it loves me in that former Shipton okay that's not very interesting",
    "start": "2395210",
    "end": "2402650"
  },
  {
    "text": "what they did it actually do well let's try to look at the code will see there's a form and in their forum it's pays its",
    "start": "2402650",
    "end": "2410569"
  },
  {
    "text": "sending in assigned XML so I'm just going to do like this change it to text",
    "start": "2410569",
    "end": "2417319"
  },
  {
    "text": "for some reason it's actually better to edit it here and I'm just going to add a new user name fields with admin and",
    "start": "2417319",
    "end": "2425779"
  },
  {
    "text": "close that and i'm going to add a an a",
    "start": "2425779",
    "end": "2430819"
  },
  {
    "text": "tag around the original one see so just",
    "start": "2430819",
    "end": "2436910"
  },
  {
    "text": "a random fact that i don't care about and now I'm login as admin because the signatures are still valid i'm just not",
    "start": "2436910",
    "end": "2443960"
  },
  {
    "text": "signing the thing I'm think I'm fine ok so this all sounds a bit yeah but would",
    "start": "2443960",
    "end": "2449690"
  },
  {
    "text": "anyone actually make this mistake turns out yes the researchers from from",
    "start": "2449690",
    "end": "2455990"
  },
  {
    "text": "Germany they looked at a lot of the different sam'l libraries some years ago",
    "start": "2455990",
    "end": "2461430"
  },
  {
    "text": "this is what they found they looked at fourteen different ones and 11 of them",
    "start": "2461430",
    "end": "2468450"
  },
  {
    "text": "have these problems for some of them you can actually just remove the signature and it will work you could just so could",
    "start": "2468450",
    "end": "2473819"
  },
  {
    "text": "just become anyone you wanted to which is pretty bad now what's wrong with this",
    "start": "2473819",
    "end": "2481589"
  },
  {
    "start": "2479000",
    "end": "2614000"
  },
  {
    "text": "code then in this case it's it's a",
    "start": "2481589",
    "end": "2486960"
  },
  {
    "text": "little more so it's this is a timing attack again so where we have a signature that's been generated and",
    "start": "2486960",
    "end": "2493500"
  },
  {
    "text": "we're comparing it with something that looks like a we're comparing each character and they have hopefully this",
    "start": "2493500",
    "end": "2500430"
  },
  {
    "text": "will return something that makes sense and this is typically how the equals functions on strings work something like",
    "start": "2500430",
    "end": "2506730"
  },
  {
    "text": "this in this case we will have an early exit air at the first invalid bites the",
    "start": "2506730",
    "end": "2511890"
  },
  {
    "text": "first one that doesn't equal so we have a problem okay so let's change it so",
    "start": "2511890",
    "end": "2517619"
  },
  {
    "text": "we're going to put the boolean outside here and then we're going to change this in here and then we're going to return",
    "start": "2517619",
    "end": "2523230"
  },
  {
    "text": "to we're sure that we run through all of them but it's still wrong why is that",
    "start": "2523230",
    "end": "2529500"
  },
  {
    "text": "well because we have something called jet just-in-time compilation and it's",
    "start": "2529500",
    "end": "2534900"
  },
  {
    "text": "actually going to see this well if this one changes to full it's never going to change back to true so I might as well",
    "start": "2534900",
    "end": "2541799"
  },
  {
    "text": "exit damn it okay so we need something called constant time comparison so",
    "start": "2541799",
    "end": "2549869"
  },
  {
    "text": "here's the XOR and we're doing some more stuff here and then you don't have to understand it it's just the weight it",
    "start": "2549869",
    "end": "2555930"
  },
  {
    "text": "ensures that it just wants to come in and mess things up so um the next thing",
    "start": "2555930",
    "end": "2562650"
  },
  {
    "text": "we could think about is JSON web tokens because those have become quite popular so typically when we're using addition",
    "start": "2562650",
    "end": "2571109"
  },
  {
    "text": "we're talking we should do it we can encode it in many different ways in this case we're using age max sha-256 so we",
    "start": "2571109",
    "end": "2578670"
  },
  {
    "text": "have a header that tells us which algorithm is in use so in this case that that's HS 2 326 @ h max sha-256 and the",
    "start": "2578670",
    "end": "2587490"
  },
  {
    "text": "tight is jb t and the payload is logged in as admin and there's a time stamp",
    "start": "2587490",
    "end": "2593070"
  },
  {
    "text": "so we basically for encode these two and we concatenate them with a dot in",
    "start": "2593070",
    "end": "2598420"
  },
  {
    "text": "between we signed that and that becomes the signature that which we also add to",
    "start": "2598420",
    "end": "2603610"
  },
  {
    "text": "n so everything is basic different code looks really nice the problem is the",
    "start": "2603610",
    "end": "2608710"
  },
  {
    "text": "implementations of this have not been at the best quality sometimes so there was",
    "start": "2608710",
    "end": "2615700"
  },
  {
    "start": "2614000",
    "end": "2714000"
  },
  {
    "text": "a vulnerability in many of the different jbg libraries one thing is that the JV t",
    "start": "2615700",
    "end": "2623380"
  },
  {
    "text": "standard it supports an algorithm called none which means what it says there is",
    "start": "2623380",
    "end": "2629530"
  },
  {
    "text": "no signature so if you could send in a token and just set it to none then you",
    "start": "2629530",
    "end": "2634869"
  },
  {
    "text": "could once again become whoever you want it to be another problem was that there was something called a type confusion",
    "start": "2634869",
    "end": "2641440"
  },
  {
    "text": "where you would send in something that was was signed with RSA but the attacker if he had a copy of it could alter the",
    "start": "2641440",
    "end": "2649210"
  },
  {
    "text": "header to say h match and the code running on the server side would then look at the this incoming JVG token and",
    "start": "2649210",
    "end": "2657340"
  },
  {
    "text": "it would have a key which used to be a public key for RSA but because it got in",
    "start": "2657340",
    "end": "2663790"
  },
  {
    "text": "the token and this is okay so this is supposed to be an age Mac and I have a key so I'm going to use the key as an",
    "start": "2663790",
    "end": "2668950"
  },
  {
    "text": "age mackay and verify the signature so it ended up using the public key which",
    "start": "2668950",
    "end": "2674430"
  },
  {
    "text": "was known to everyone as the signing key which means you could once again porch tokens and also there's been problems",
    "start": "2674430",
    "end": "2683170"
  },
  {
    "text": "with this RSA 15 stuff that I've been talking about which was about half a",
    "start": "2683170",
    "end": "2689590"
  },
  {
    "text": "year ago there was a problem with with this library and more recently meaning a",
    "start": "2689590",
    "end": "2695410"
  },
  {
    "text": "couple of weeks ago on this thing was they should actually less than a couple",
    "start": "2695410",
    "end": "2700720"
  },
  {
    "text": "of weeks ago so it was January tense this thing with issued it says there's some vulnerabilities in these token",
    "start": "2700720",
    "end": "2707470"
  },
  {
    "text": "signing verification things in the Microsoft identity tokens and then I went on Twitter to figure out what is",
    "start": "2707470",
    "end": "2713320"
  },
  {
    "text": "this thing and I find this thing so if you use our tent identity models fighters one with symmetric signing keys",
    "start": "2713320",
    "end": "2719680"
  },
  {
    "start": "2714000",
    "end": "2744000"
  },
  {
    "text": "don't miss this important security advisory okay still a bit low on detail but then we scroll down",
    "start": "2719680",
    "end": "2726580"
  },
  {
    "text": "which means you can truncate the JWT signature to force the comparison on",
    "start": "2726580",
    "end": "2731920"
  },
  {
    "text": "only one bite so you just stripped all of it and left one bite and then we say",
    "start": "2731920",
    "end": "2737200"
  },
  {
    "text": "okay so the length of this H mag is obviously one and yeah so you could sign whatever you want it so if we're going",
    "start": "2737200",
    "end": "2745420"
  },
  {
    "start": "2744000",
    "end": "2809000"
  },
  {
    "text": "to use signatures we should first verify that the signature is correct that we need to verify that the elements we",
    "start": "2745420",
    "end": "2751480"
  },
  {
    "text": "expect to be signed are in fact signed so we don't have this where we can move stuff around in the XML and then we have",
    "start": "2751480",
    "end": "2759670"
  },
  {
    "text": "to ensure that they're signed in the way that we expect them to be signed someone",
    "start": "2759670",
    "end": "2764830"
  },
  {
    "text": "hasn't like after designing algorithm to be something completely different and then make sure we actually use the data",
    "start": "2764830",
    "end": "2771220"
  },
  {
    "text": "that was fine so circling back to Bruce",
    "start": "2771220",
    "end": "2776680"
  },
  {
    "text": "Schneier there's been a lot of discussion lately about is crypto good enough right do we have good enough",
    "start": "2776680",
    "end": "2783310"
  },
  {
    "text": "crypto all with the FBI phones and all the breaches and all kinds of stuff and what he says is the math is good but",
    "start": "2783310",
    "end": "2791680"
  },
  {
    "text": "math has no agency code has an agency and the code has been subverted so this is actually what we've been looking at",
    "start": "2791680",
    "end": "2797260"
  },
  {
    "text": "like we've seen a lot of places where the code that's using the crypto is wrong it's not the crypto itself like",
    "start": "2797260",
    "end": "2802840"
  },
  {
    "text": "it's not a yes that's wrong it's the way that it has been used so some",
    "start": "2802840",
    "end": "2809980"
  },
  {
    "start": "2809000",
    "end": "2898000"
  },
  {
    "text": "recommendations here towards the end never ever invent your own crypto Bruce",
    "start": "2809980",
    "end": "2816010"
  },
  {
    "text": "Schneier is watching you use a crypto library and learn how to use the",
    "start": "2816010",
    "end": "2822130"
  },
  {
    "text": "cryptographic constructs correctly so you don't make any of these mistakes i use the Cure randoms of course and never",
    "start": "2822130",
    "end": "2830710"
  },
  {
    "text": "ever ever ever ever put the keys in source control don't put your keys on",
    "start": "2830710",
    "end": "2836140"
  },
  {
    "text": "github they're being scraped all the time if you do this this could be your",
    "start": "2836140",
    "end": "2843010"
  },
  {
    "text": "application I'm going to zoom in so we have a door with a card reader and we",
    "start": "2843010",
    "end": "2849910"
  },
  {
    "text": "have what's going on here I think I could squeeze in there this is just like a piece of cloth that's holding this",
    "start": "2849910",
    "end": "2857350"
  },
  {
    "text": "thing and this there's like a drywall piece or some this is something I show on my way to",
    "start": "2857350",
    "end": "2863290"
  },
  {
    "text": "work one day don't let this be your application like you have something really super secure in the middle and then you can just like easily",
    "start": "2863290",
    "end": "2869020"
  },
  {
    "text": "circumvented to be fair to these guys this was like a very temporal a temporary solution a couple of days",
    "start": "2869020",
    "end": "2875560"
  },
  {
    "text": "later they could actually fixed it and attach these things in the in the right ways so that was better um gonna give an",
    "start": "2875560",
    "end": "2884830"
  },
  {
    "text": "i have time i'm going to show you one more thing so this is a research",
    "start": "2884830",
    "end": "2890200"
  },
  {
    "text": "facility and then they they have some papers that they want to allow you to download and in this case if we click",
    "start": "2890200",
    "end": "2896620"
  },
  {
    "text": "this link we're going to get to see this super cool research that they've done if",
    "start": "2896620",
    "end": "2904420"
  },
  {
    "start": "2898000",
    "end": "3060000"
  },
  {
    "text": "we look at the URL which is a bit too small for you to see i'm going to paste",
    "start": "2904420",
    "end": "2909790"
  },
  {
    "text": "it down here we see ok so there's a URL and there's a signature a long signature",
    "start": "2909790",
    "end": "2915790"
  },
  {
    "text": "which looks like some hex stuff ok so what happens if we tamper with it let's",
    "start": "2915790",
    "end": "2923320"
  },
  {
    "text": "change the last the last from Oh from a tooth to 10 bad decrypt hmm what's this",
    "start": "2923320",
    "end": "2937380"
  },
  {
    "text": "you should know this by now this is a padding Oracle right this is a padding",
    "start": "2937380",
    "end": "2943240"
  },
  {
    "text": "Oracle staring us in our faces because it tried to decrypt something so this wasn't a signature it was in fact and",
    "start": "2943240",
    "end": "2949960"
  },
  {
    "text": "encryption of the filing so if we if we're a nice enough to try to guess what",
    "start": "2949960",
    "end": "2957070"
  },
  {
    "text": "the file and was so this one is called paper one maybe they have some unpublished research that we could still",
    "start": "2957070",
    "end": "2962950"
  },
  {
    "text": "that's called paper too ok so let's grab this so-called signature and we're going",
    "start": "2962950",
    "end": "2971860"
  },
  {
    "text": "to see let's just delete this frown I'm",
    "start": "2971860",
    "end": "2980560"
  },
  {
    "text": "going to hex the code that so we get back your by doreen and we're going to change something",
    "start": "2980560",
    "end": "2988970"
  },
  {
    "text": "we're going to a so we have to count so like the paper that's one two three four",
    "start": "2988970",
    "end": "2995930"
  },
  {
    "text": "five letters so the sixth letter we're going to change that from a1 to a2 which",
    "start": "2995930",
    "end": "3001630"
  },
  {
    "text": "means we need to change of course the fifth one because that's the way it works and we're going to say okay so I",
    "start": "3001630",
    "end": "3009880"
  },
  {
    "text": "need to change that from a 22 a or",
    "start": "3009880",
    "end": "3018120"
  },
  {
    "text": "actually from a one doesn't matter but from a 22 a1 to a2 and now we're going",
    "start": "3018120",
    "end": "3030640"
  },
  {
    "text": "to pack it back together again so hex encode this okay so now we have a so",
    "start": "3030640",
    "end": "3039760"
  },
  {
    "text": "called signature and we're going to go back up here and going to change from paper 12 paper to and we're going to",
    "start": "3039760",
    "end": "3048670"
  },
  {
    "text": "paste or modified signature and we get access to a new unpublished document",
    "start": "3048670",
    "end": "3055800"
  },
  {
    "text": "because yeah signing in crypto and stuff if you want to learn more there's a long",
    "start": "3055800",
    "end": "3063580"
  },
  {
    "start": "3060000",
    "end": "3232000"
  },
  {
    "text": "presentation called everything you need to know about cryptography in one hour and it's two hours long some people you",
    "start": "3063580",
    "end": "3071320"
  },
  {
    "text": "might want to follow matcha green and dealers here do the crypto pals",
    "start": "3071320",
    "end": "3076630"
  },
  {
    "text": "challenges I'm right now trying to do them in JavaScript but they're there are solutions out there we can do you can",
    "start": "3076630",
    "end": "3081940"
  },
  {
    "text": "find solutions in Java and all kinds of stuff let's go go to the go look it up also there's a really good book called",
    "start": "3081940",
    "end": "3087970"
  },
  {
    "text": "cryptography engineering design principles and practical applications by schneider and the solder that's",
    "start": "3087970",
    "end": "3095410"
  },
  {
    "text": "basically it so thank you for listening any questions",
    "start": "3095410",
    "end": "3101320"
  },
  {
    "text": "[Applause]",
    "start": "3101320",
    "end": "3107570"
  },
  {
    "text": "yes you'll get a microphone just a second okay with the slides be available",
    "start": "3109750",
    "end": "3118010"
  },
  {
    "text": "yes I will make the slides available thank you anybody else i'll be here at",
    "start": "3118010",
    "end": "3127849"
  },
  {
    "text": "the rest of the day so if you find me and you there's something you want to know just grabbed me and asked no gentleman over here communities",
    "start": "3127849",
    "end": "3140890"
  },
  {
    "text": "basically you're different platforms any specific sets of community should be reverting to when you start and spot",
    "start": "3140890",
    "end": "3147589"
  },
  {
    "text": "these types of issues i see you at a list of individual names but certain communities that that are well known and",
    "start": "3147589",
    "end": "3154280"
  },
  {
    "text": "respected to be able to follow i'm not",
    "start": "3154280",
    "end": "3159740"
  },
  {
    "text": "sure maybe you'll probably find some really good cryptic communities around universities because a lot of crypto",
    "start": "3159740",
    "end": "3165980"
  },
  {
    "text": "research is usually academic space around this german university in in",
    "start": "3165980",
    "end": "3172609"
  },
  {
    "text": "bottom in Germany they have a lot of really good cryptography research coming out the guy who found these sam'l bugs",
    "start": "3172609",
    "end": "3179960"
  },
  {
    "text": "and also one of these TLS bugs he's he's also written a new test suite for",
    "start": "3179960",
    "end": "3186640"
  },
  {
    "text": "protesting TLS and trying to uncover these kinds of mistakes in TLS implementations google recently also",
    "start": "3186640",
    "end": "3194630"
  },
  {
    "text": "released a a tool for testing java based encryption and actually the guy who",
    "start": "3194630",
    "end": "3201290"
  },
  {
    "text": "found many of the likely many of the bugs that i've shown now especially the",
    "start": "3201290",
    "end": "3207410"
  },
  {
    "text": "pkc as 15 bugs he's called the Bison baka I think he's involved in that",
    "start": "3207410",
    "end": "3213230"
  },
  {
    "text": "google project she will find some really smart people there as well normal",
    "start": "3213230",
    "end": "3221990"
  },
  {
    "text": "question nope okay you just adjusted your glasses that's fine okay thanks a lot enjoy the",
    "start": "3221990",
    "end": "3230069"
  },
  {
    "text": "rest of the conference",
    "start": "3230069",
    "end": "3232549"
  }
]