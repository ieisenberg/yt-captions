[
  {
    "text": "welcome everybody thank you so much for coming spending your Wednesday afternoon",
    "start": "8960",
    "end": "14360"
  },
  {
    "text": "with me my name's Paul yovich I'm one of the um heads of product in Azure my team",
    "start": "14360",
    "end": "21800"
  },
  {
    "text": "works on serverless and paths and functions um but we also kind of",
    "start": "21800",
    "end": "27039"
  },
  {
    "text": "contribute to other things like app service and container apps and security",
    "start": "27039",
    "end": "32599"
  },
  {
    "text": "um this is a talk that's uh in it just kind of a subject matter that's really close to me um hopefully close to you",
    "start": "32600",
    "end": "40440"
  },
  {
    "text": "too you know how to get really pragmatic and how to secure our Cloud applications um I'll be honest over the last year um",
    "start": "40440",
    "end": "48160"
  },
  {
    "text": "we've really been humbled by the level of you know security exploits and vulnerabilities that have been tried on",
    "start": "48160",
    "end": "54840"
  },
  {
    "text": "us at Microsoft um I spent the better part of this year as especially this",
    "start": "54840",
    "end": "60480"
  },
  {
    "text": "summer doing absolutely nothing but improving our security in the platform",
    "start": "60480",
    "end": "65640"
  },
  {
    "text": "and also working with all of our internal Services whether it's like Office 365 or our health platform uh",
    "start": "65640",
    "end": "73320"
  },
  {
    "text": "just helping all of our own cloud services kind of apply security best practices and we learned a lot as we",
    "start": "73320",
    "end": "79479"
  },
  {
    "text": "went um so what I'm hoping to do is have a little bit of fun and also share some of the hard lessons learned that we had",
    "start": "79479",
    "end": "86079"
  },
  {
    "text": "securing and hopefully uh together we can all get in front of these bad guys who are trying to make",
    "start": "86079",
    "end": "92759"
  },
  {
    "text": "our lives um not so good so that's what we'll do today so what I want to do I",
    "start": "92759",
    "end": "98119"
  },
  {
    "text": "want to talk about just a few of the attack examples that for me are top of mind um if I miss any I'd love to hear",
    "start": "98119",
    "end": "105040"
  },
  {
    "text": "from you from you all too and we're going to go from very basic prevention",
    "start": "105040",
    "end": "110079"
  },
  {
    "text": "all the way to pretty sophisticated prevention we're going to talk a lot about going passwordless and using",
    "start": "110079",
    "end": "116960"
  },
  {
    "text": "identity I think that's one of the absolute things I hope everybody could take away today also from the networking",
    "start": "116960",
    "end": "123960"
  },
  {
    "text": "side network security is absolutely Paramount and we're going to talk about how to do Network isolation and setting",
    "start": "123960",
    "end": "130640"
  },
  {
    "text": "up um Network perimeters and how to really think about that and and how to",
    "start": "130640",
    "end": "136040"
  },
  {
    "text": "actually do it in Azure I'll even hopefully I have time to show you some tips and tricks I can show you some",
    "start": "136040",
    "end": "141440"
  },
  {
    "text": "tools I can show you how to debug and diagnose some of the stuff um as we go",
    "start": "141440",
    "end": "146599"
  },
  {
    "text": "through so hopefully you get a bit of conceptual a lot of Hands-On on um I am providing you with all the code",
    "start": "146599",
    "end": "153440"
  },
  {
    "text": "including the infrastructures code like the actual bicep code so you can apply these policies in these templates uh for",
    "start": "153440",
    "end": "160239"
  },
  {
    "text": "your apps right away and you can kind of try it out you can actually take one of these templates and deploy it under two",
    "start": "160239",
    "end": "165640"
  },
  {
    "text": "minutes um in your own Azure subscription and see what's going on so hopefully that sounds good okay that's",
    "start": "165640",
    "end": "171879"
  },
  {
    "text": "the plan for today see if the clicker Works did I turn it off there we go all right let's",
    "start": "171879",
    "end": "178800"
  },
  {
    "text": "talk about the the midnight blizzard attack um if you're interested or you want to Google for it um you know we",
    "start": "178800",
    "end": "186560"
  },
  {
    "text": "with our msrc team we've published guidance on what happened with midnight blizzard we published follow on guidance",
    "start": "186560",
    "end": "193680"
  },
  {
    "text": "on how you can uh prevent that and I think it's really good guidance and what I hope to do is go like a click further",
    "start": "193680",
    "end": "200680"
  },
  {
    "text": "saying like here's actually how you take an Azure service and you do some of these msrc practices um so midnight",
    "start": "200680",
    "end": "206959"
  },
  {
    "text": "blizzard so State actors um and uh you know hackers basically",
    "start": "206959",
    "end": "213799"
  },
  {
    "text": "leveraged a multi-phased attack in a coordinated attack um first starting",
    "start": "213799",
    "end": "220799"
  },
  {
    "text": "with our Legacy servers like our Legacy Devon test servers you can kind of think",
    "start": "220799",
    "end": "226400"
  },
  {
    "text": "of those servers that we have that maybe haven't been patched in a while um and you know we do at Microsoft we I think",
    "start": "226400",
    "end": "233360"
  },
  {
    "text": "we're pretty good about OS patching but there's the next level of things that maybe we hadn't thought about which is",
    "start": "233360",
    "end": "240200"
  },
  {
    "text": "um we started with secure posture you know for maybe five years ago and so we",
    "start": "240200",
    "end": "246200"
  },
  {
    "text": "would set up service principles in the active directory now called entra and we",
    "start": "246200",
    "end": "251959"
  },
  {
    "text": "had these service principles that effectively had full god mode access to",
    "start": "251959",
    "end": "257040"
  },
  {
    "text": "other things on the network and so these servers even though they weren't as important to us they were Dev test and",
    "start": "257040",
    "end": "263639"
  },
  {
    "text": "nature they had these Legacy credentials assigned to them and those credentials",
    "start": "263639",
    "end": "268680"
  },
  {
    "text": "now had keys to the kingdom to get in so um I think there's a you know we'll talk",
    "start": "268680",
    "end": "274120"
  },
  {
    "text": "about kind of the lessons learned and what happened but kind of keep that in mind um as",
    "start": "274120",
    "end": "279520"
  },
  {
    "text": "we're you know as things age they start to create more and more vulnerability",
    "start": "279520",
    "end": "284919"
  },
  {
    "text": "and the absolute key in my opinion is to have a strong devops process and a strong auditing process to really find",
    "start": "284919",
    "end": "291840"
  },
  {
    "text": "and mitigate this it's kind of like changing a whole bunch of locks okay so once once there were these Dev test",
    "start": "291840",
    "end": "298520"
  },
  {
    "text": "Services um that were findable now there are some service principles and then a",
    "start": "298520",
    "end": "304280"
  },
  {
    "text": "combination of that and just using public information on the internet um little hints about well who are the",
    "start": "304280",
    "end": "310039"
  },
  {
    "text": "usernames what are the email addresses what are the Azure accounts What are some of the server names right people",
    "start": "310039",
    "end": "315199"
  },
  {
    "text": "can watch demos see the server names well those uh come up or people blog about it so there's all this public",
    "start": "315199",
    "end": "321160"
  },
  {
    "text": "information that was out there and for sale on the you know Black Market effectively and with that information",
    "start": "321160",
    "end": "328000"
  },
  {
    "text": "plus a few of the keys that'll allowed the first breach which is you know the attackers are on our network and on our",
    "start": "328000",
    "end": "335520"
  },
  {
    "text": "servers the ones that we thought were less interesting but what got really scary is they had some of these service",
    "start": "335520",
    "end": "340880"
  },
  {
    "text": "principles that we had basically forgotten about how powerful they are and they could get in then the next",
    "start": "340880",
    "end": "346639"
  },
  {
    "text": "thing that happened using some of this information like let's say Paul yuck at",
    "start": "346639",
    "end": "351720"
  },
  {
    "text": "microsoft.com so they've got my address and then they could start a technique called password spring I don't know if",
    "start": "351720",
    "end": "357639"
  },
  {
    "text": "you're familiar with that but it's kind of like it's kind of like Hammer attacking someone just guessing passwords using a a bot that can rotate",
    "start": "357639",
    "end": "365479"
  },
  {
    "text": "through guesses and usually what happens if you attack a modern thing over and over with the same password it shuts you",
    "start": "365479",
    "end": "371919"
  },
  {
    "text": "down it slows you down for an hour a day like you can't just keep doing it but",
    "start": "371919",
    "end": "377440"
  },
  {
    "text": "these password spray attacks are very sophisticated they keep coming from different addresses they use vpns they",
    "start": "377440",
    "end": "383800"
  },
  {
    "text": "use coffee shops they use all these like really diverse networks in in identities",
    "start": "383800",
    "end": "390360"
  },
  {
    "text": "to come from so it didn't look like a single attacker trying to hammer a password it just looked like a bunch of",
    "start": "390360",
    "end": "396639"
  },
  {
    "text": "anonymous things that oh like the password didn't work this one time okay no big deal but every time the",
    "start": "396639",
    "end": "402080"
  },
  {
    "text": "collective was getting smarter and smarter you a eliminating things from the list and eventually you know you're",
    "start": "402080",
    "end": "409039"
  },
  {
    "text": "able to do some smart guessing and hoping and get through with passwords so",
    "start": "409039",
    "end": "415080"
  },
  {
    "text": "we got old service principles we've got passwords that people were able",
    "start": "415080",
    "end": "420120"
  },
  {
    "text": "to guess or or Hammer attack through password springing and then there's another",
    "start": "420120",
    "end": "425680"
  },
  {
    "text": "flavor which is there's a number of these ooth apps so the third the Third Kind of breach was oo apps um and",
    "start": "425680",
    "end": "434639"
  },
  {
    "text": "remember ooth apps when you when you join an app to entra or to the",
    "start": "434639",
    "end": "440080"
  },
  {
    "text": "directory in the original days they would all also have a service principle a service principle is just another",
    "start": "440080",
    "end": "447199"
  },
  {
    "text": "flavor of a secret that you have on your local dis right so it's um it's like having a certificate it's like having a",
    "start": "447199",
    "end": "454039"
  },
  {
    "text": "password so these ooth apps get these identities with a password on local disk",
    "start": "454039",
    "end": "459919"
  },
  {
    "text": "and they happened to be admins which allowed the last terrible level of attack which allowed you know these",
    "start": "459919",
    "end": "466960"
  },
  {
    "text": "attackers to basically own servers that we actually cared about so they were able to hop from these Dev test things",
    "start": "466960",
    "end": "473560"
  },
  {
    "text": "that we weren't thinking about to the networks that had the important prod things use these oo apps that basic",
    "start": "473560",
    "end": "479479"
  },
  {
    "text": "basally had admin and uh and off they went and even once it was kind of like I",
    "start": "479479",
    "end": "485479"
  },
  {
    "text": "don't know Settlers of Katan or something so they attack one you know settlement and then they get some passwords and some emails and some more",
    "start": "485479",
    "end": "492960"
  },
  {
    "text": "information you know customer support information and they go to the next one and attack the next one so though um",
    "start": "492960",
    "end": "498360"
  },
  {
    "text": "this was an awful attack we unfortunately you know learned a lot the hard way um but we're going to come back",
    "start": "498360",
    "end": "504960"
  },
  {
    "text": "stronger I'm going to teach you how to deal with this kind of stuff all right so basic strategies number one I'm going",
    "start": "504960",
    "end": "510879"
  },
  {
    "text": "to be a little cheeky hopefully you're okay with that with some of these memes so um most important thing I know it's",
    "start": "510879",
    "end": "517240"
  },
  {
    "text": "obvious but using modern patch servers with modern devops practices with modern",
    "start": "517240",
    "end": "524279"
  },
  {
    "text": "vetted secure Supply chains libraries Registries absolutely critical um you",
    "start": "524279",
    "end": "531320"
  },
  {
    "text": "know if you think about some versions of Windows Server don't even have the modern oath standards or the modern",
    "start": "531320",
    "end": "537839"
  },
  {
    "text": "identity standards because it wasn't invented yet right so you want to be on the latest version of an OS the latest",
    "start": "537839",
    "end": "544440"
  },
  {
    "text": "version of a framework the latest version of your dependencies you want to know where your dependencies come from",
    "start": "544440",
    "end": "550120"
  },
  {
    "text": "it's really just making sure the infrastructure you have is modern and patched um another lesson that we learn",
    "start": "550120",
    "end": "557519"
  },
  {
    "text": "is you know only install exactly what you need narrow that surface area because every one of those pieces of",
    "start": "557519",
    "end": "564440"
  },
  {
    "text": "software servers or demons on the machine are attack vectors that can be owned in used against you to attack you",
    "start": "564440",
    "end": "571120"
  },
  {
    "text": "you know so it's kind of like limiting the number of roles and services that you install um limiting the number of of",
    "start": "571120",
    "end": "578920"
  },
  {
    "text": "ports just really locking it down that stuff matters a lot um and I think you you can learn",
    "start": "578920",
    "end": "586320"
  },
  {
    "text": "from the last case study it's really important to separate the concerns of your servers so",
    "start": "586320",
    "end": "592040"
  },
  {
    "text": "lower uh lower risk things like Dev test you know those are great to have they",
    "start": "592040",
    "end": "597680"
  },
  {
    "text": "should be a little bit more permissive but absolutely keep those separate and never mix them with your prod resources",
    "start": "597680",
    "end": "603680"
  },
  {
    "text": "keep them absolutely separate separate identities separate networks um physical separation if you",
    "start": "603680",
    "end": "611040"
  },
  {
    "text": "need that you just don't want any um bu to be able you know hop from",
    "start": "611040",
    "end": "616959"
  },
  {
    "text": "something less privileged to something more privileged um all right enough of that",
    "start": "616959",
    "end": "623600"
  },
  {
    "text": "so going on we're going to move from Ultra Basics kind of obvious stuff to hopefully things that you haven't",
    "start": "623600",
    "end": "630720"
  },
  {
    "text": "heard okay so let's talk about going passwordless I think if you think of the",
    "start": "630720",
    "end": "636040"
  },
  {
    "text": "root cause with what I talked about with midnight blizzard it was two or three forms of passwords passwords are kind of",
    "start": "636040",
    "end": "643040"
  },
  {
    "text": "nasty because they say they stay around they're machine readable they're human readable they're copy and",
    "start": "643040",
    "end": "649480"
  },
  {
    "text": "pastable right so anyone gets that password it's as good as a weigh in it's kind of like having the key you know",
    "start": "649480",
    "end": "655680"
  },
  {
    "text": "that you give to a uh ex-girlfriend boyfriend partner you know like that",
    "start": "655680",
    "end": "661760"
  },
  {
    "text": "that key is good like forever you're just giving it away so we want to get rid of we want to go passwordless the",
    "start": "661760",
    "end": "667720"
  },
  {
    "text": "number number one thing I would try to do is to go managed identity with all your services that will cover your your",
    "start": "667720",
    "end": "675279"
  },
  {
    "text": "service identities um also there's a whole new way to do things so there's pass Keys which are like virtual keys",
    "start": "675279",
    "end": "682920"
  },
  {
    "text": "that are on your device that rotate there's also these things like a phto key or a UB key I brought mine with me",
    "start": "682920",
    "end": "689320"
  },
  {
    "text": "just as a prop um they're as good as one factor of authentication so instead of needing one password you can use one of",
    "start": "689320",
    "end": "696440"
  },
  {
    "text": "these and then you can have other things like it has to be on a trusted device you have phone off so you have a phone",
    "start": "696440",
    "end": "703240"
  },
  {
    "text": "off in one of these um there there's a number of things you can pair together and it becomes really hard because",
    "start": "703240",
    "end": "710360"
  },
  {
    "text": "someone would have to you know Ambush me get this get me to unlock this and this and the code into this and it's just it",
    "start": "710360",
    "end": "717000"
  },
  {
    "text": "reduces the easy stuff and I think a lot of these attackers are going after the easy",
    "start": "717000",
    "end": "722680"
  },
  {
    "text": "stuff not only do you want to not use passwords but the next step is turn off",
    "start": "722680",
    "end": "728040"
  },
  {
    "text": "the ability to even use passwords so if you see us talk about local off local",
    "start": "728040",
    "end": "734040"
  },
  {
    "text": "off is talking about we locally allow you to authenticate with passwords you want to turn off local off as soon as",
    "start": "734040",
    "end": "740880"
  },
  {
    "text": "you can and I know it's a journey to get your users your customers your partners",
    "start": "740880",
    "end": "747240"
  },
  {
    "text": "your machines off of passwords it's a journey believe me I know um but when you do as soon as you can and you feel",
    "start": "747240",
    "end": "754000"
  },
  {
    "text": "like you can do it turn off that password capability and then there's no way because like you're kind of only as",
    "start": "754000",
    "end": "760480"
  },
  {
    "text": "secure as your least secure weighin so if you allow passwords and um a more",
    "start": "760480",
    "end": "766199"
  },
  {
    "text": "secure managed identity well anyone who still has that password or any password you've forgotten about that's lingering",
    "start": "766199",
    "end": "771320"
  },
  {
    "text": "around that can still be the thing that is used to own you in our case that's absolutely what owned us right it's",
    "start": "771320",
    "end": "777000"
  },
  {
    "text": "these service principles and these ooth apps that we forgot about that we weren't",
    "start": "777000",
    "end": "782120"
  },
  {
    "text": "inventorying that we weren't expiring those are the ones that got us um use multif Factor off to um absolutely",
    "start": "782120",
    "end": "789639"
  },
  {
    "text": "critical I think we know this but these are just kind of good hygiene reminders um never accepting unrecognized requests",
    "start": "789639",
    "end": "797160"
  },
  {
    "text": "so even like these things the phone off a new favorite thing is like they'll start hammering me and I'm like what the",
    "start": "797160",
    "end": "802959"
  },
  {
    "text": "heck like why is someone ask asking me uh to sign into Microsoft no right right",
    "start": "802959",
    "end": "809320"
  },
  {
    "text": "so like any one of those I wouldn't you know if you don't know exactly what it is just say no cuz they actually could",
    "start": "809320",
    "end": "815320"
  },
  {
    "text": "literally be threats um and a number of our employees were attacked exactly that way and still are attacked that way all",
    "start": "815320",
    "end": "822360"
  },
  {
    "text": "right the last thing if you absolutely must use a password or token or secret we have a technology called key Vault",
    "start": "822360",
    "end": "829040"
  },
  {
    "text": "also an open source there's things like Vault just please use one of those and try to use it sparingly uh but I",
    "start": "829040",
    "end": "835800"
  },
  {
    "text": "understand you know there's a number of like Legacy services there third party services that you just there's no other",
    "start": "835800",
    "end": "842000"
  },
  {
    "text": "way in you have to use this sort of password then you can use the key Vault and we have guidance online published",
    "start": "842000",
    "end": "849040"
  },
  {
    "text": "about how you can set up key Vault to do an auto rotation and kind of an auto expiration so that at least even after a",
    "start": "849040",
    "end": "855639"
  },
  {
    "text": "while you're required to reauthenticate the key vault key all right next access control um so",
    "start": "855639",
    "end": "864000"
  },
  {
    "text": "once you have an identity and that identity isn't based on passwords the most important thing is set access",
    "start": "864000",
    "end": "869920"
  },
  {
    "text": "control um this is another one we learned the super hard way I think the easy and the default thing to do was to",
    "start": "869920",
    "end": "876680"
  },
  {
    "text": "make things admin right it's like hey I got to get this thing working set it as admin we'll lock it down later uh that's",
    "start": "876680",
    "end": "883040"
  },
  {
    "text": "what kind of gets you so you know we talk about a principle of start with lease privilege I highly recommend that",
    "start": "883040",
    "end": "889440"
  },
  {
    "text": "if you can um we're getting a lot better at Microsoft saying hey for these common scenarios here's the lease privilege you",
    "start": "889440",
    "end": "896199"
  },
  {
    "text": "need to Grant and those our back grants um will also save you because then you",
    "start": "896199",
    "end": "901920"
  },
  {
    "text": "can make sure hey this one service is only allowed to do what it's intended to do and it can never be an attack Vector",
    "start": "901920",
    "end": "909480"
  },
  {
    "text": "for an elevation of privilege and I I think I've said it like a 100 thousand times beware of service principles use",
    "start": "909480",
    "end": "915839"
  },
  {
    "text": "them very sparingly look for approaches with managed identities instead of service principles and we more and more",
    "start": "915839",
    "end": "923160"
  },
  {
    "text": "The more I've worked on it with my platform team we've been enabling managed identity absolutely everywhere",
    "start": "923160",
    "end": "929000"
  },
  {
    "text": "so if like if you can find one for me of a thing that doesn't use managed identity please tell me because we've",
    "start": "929000",
    "end": "934920"
  },
  {
    "text": "been trying to turn that um over to manage identity everywhere and I feel pretty good about it okay um last thing",
    "start": "934920",
    "end": "944000"
  },
  {
    "text": "let's talk about Network isolation I'm going to do a deep dive on this later um because I I feel like I have to uh",
    "start": "944000",
    "end": "950600"
  },
  {
    "text": "because it was hard for me to learn maybe you'll get something from it but this is about fencing your networks by",
    "start": "950600",
    "end": "956639"
  },
  {
    "text": "fencing your Networks you're automatically giving physical or at least network software level separation",
    "start": "956639",
    "end": "963639"
  },
  {
    "text": "of assets right so we want to keep protected assets on their own networks you want to have only one pinhole",
    "start": "963639",
    "end": "970959"
  },
  {
    "text": "through that firewall from untrusted networks into the trusted Network and it's going to give you a lot more depth",
    "start": "970959",
    "end": "978000"
  },
  {
    "text": "of Defense so what I literally mean so we we have this concept of v-net folks familiar with v-ets or vpcs if you come",
    "start": "978000",
    "end": "985040"
  },
  {
    "text": "from AWS world so yeah v-net is kind of like your private Network your private",
    "start": "985040",
    "end": "990199"
  },
  {
    "text": "subnet your private Network um it's your secure thing and you know we even we have at home we probably have routers",
    "start": "990199",
    "end": "997279"
  },
  {
    "text": "right you have the outside kind of dirty internet with all the threats and inside our Network it's one step safer then you",
    "start": "997279",
    "end": "1004519"
  },
  {
    "text": "can imagine if you have a server on your network you want that on its own network too it's like all these things that have",
    "start": "1004519",
    "end": "1011240"
  },
  {
    "text": "the data um and have the resources that you want to protect you put them on separate networks and in the limit what",
    "start": "1011240",
    "end": "1018680"
  },
  {
    "text": "we actually recommend what we actually do inside of Microsoft is every single dependency we've gotten into the",
    "start": "1018680",
    "end": "1025038"
  },
  {
    "text": "practice of putting it on another um Network and so the v-net is kind of this",
    "start": "1025039",
    "end": "1032160"
  },
  {
    "text": "trusted array of networks you can use but even within that v-net you can partition into",
    "start": "1032160",
    "end": "1038798"
  },
  {
    "text": "different subnets and there's only one way in and only one way out it's kind of like a net right only one way in one way",
    "start": "1038799",
    "end": "1045760"
  },
  {
    "text": "out and at that one way in and one way out we can use off we can use owless we",
    "start": "1045760",
    "end": "1051600"
  },
  {
    "text": "can absolutely lock down the network to trusted traffic and we kind of think about now",
    "start": "1051600",
    "end": "1057919"
  },
  {
    "text": "like all traffic is untrusted by default until we trust it and that's been a flip",
    "start": "1057919",
    "end": "1063400"
  },
  {
    "text": "and mindset for us uh but it's really helping us so far so good kind of making",
    "start": "1063400",
    "end": "1068720"
  },
  {
    "text": "sense I'm going to show you now all right so um one thing this might be a good one to",
    "start": "1068720",
    "end": "1075360"
  },
  {
    "text": "get a picture of I'll I'll send it to you afterwards um the this aka.ms",
    "start": "1075360",
    "end": "1081440"
  },
  {
    "text": "functions-- samples um everything I'm showing you here every team that everything that my",
    "start": "1081440",
    "end": "1087720"
  },
  {
    "text": "team's worked on for the last year is secure by Design and we have from like",
    "start": "1087720",
    "end": "1093440"
  },
  {
    "text": "easy to hard examples of how to secure things um you can play with them now you can play play with them you go",
    "start": "1093440",
    "end": "1100960"
  },
  {
    "text": "home all right so what I'm about to show you in the sample is based on uh a few",
    "start": "1100960",
    "end": "1107039"
  },
  {
    "text": "Concepts that I want to tell you and then we're going to look at them again and kind of reinforce them in the code so the first most important thing of",
    "start": "1107039",
    "end": "1113400"
  },
  {
    "text": "this whole hour forget everything else managed identity so managed identity is",
    "start": "1113400",
    "end": "1119640"
  },
  {
    "text": "um it's kind of like there's an identity and I think we've known about identities for a long time like we all have an",
    "start": "1119640",
    "end": "1124840"
  },
  {
    "text": "identity at our work right for me it's Paul yuck microsoft.com we have identities at home",
    "start": "1124840",
    "end": "1131640"
  },
  {
    "text": "you know Paul Yuki at Hotmail kind of a thing uh I'm dating myself with Hotmail sorry um we we have these identities but",
    "start": "1131640",
    "end": "1141200"
  },
  {
    "text": "now we want that identity to be like very virtual and to be backed by keys that rotate preferably with no password",
    "start": "1141200",
    "end": "1148919"
  },
  {
    "text": "at all and that identity and that set of credentials are things that we can",
    "start": "1148919",
    "end": "1154360"
  },
  {
    "text": "expire um very easily and not have to worry about so a managed identity lets",
    "start": "1154360",
    "end": "1159520"
  },
  {
    "text": "you do what a password can do and a whole lot more because you can decide who is this what do they have access to",
    "start": "1159520",
    "end": "1167240"
  },
  {
    "text": "um it's never using an actual password that can be reused forever it's using a",
    "start": "1167240",
    "end": "1172400"
  },
  {
    "text": "token that's only allowed for one purpose and expires very quickly right so it can't last long it's only allowed",
    "start": "1172400",
    "end": "1178400"
  },
  {
    "text": "for one thing and the identity can be applied to an actual service so we call",
    "start": "1178400",
    "end": "1185240"
  },
  {
    "text": "something a system assigned identity just kind of means a service let's say an app service web app or a function or",
    "start": "1185240",
    "end": "1192760"
  },
  {
    "text": "container app they can have a default system assigned identity which is just the identity of that running process",
    "start": "1192760",
    "end": "1198760"
  },
  {
    "text": "process in that server and it's always the same um so that's a system assigned manage identity that's really good in my",
    "start": "1198760",
    "end": "1204840"
  },
  {
    "text": "opinion for like quick I want to turn on managed identity Dev test you can use system assigned you",
    "start": "1204840",
    "end": "1211880"
  },
  {
    "text": "just turn it on really really easy don't have to think about it but it's got some downsides and I'll talk about that too",
    "start": "1211880",
    "end": "1218400"
  },
  {
    "text": "my favorite is the user assigned identity and that's kind of like remember machine accounts it's kind of",
    "start": "1218400",
    "end": "1224080"
  },
  {
    "text": "like a machine account or a user identity in that you know exactly",
    "start": "1224080",
    "end": "1229600"
  },
  {
    "text": "what the role of that identity is intended for like hey this is the role so that all my functions can talk to",
    "start": "1229600",
    "end": "1235159"
  },
  {
    "text": "databases that's the identity I want to have and it's very",
    "start": "1235159",
    "end": "1240200"
  },
  {
    "text": "durable um and it's very auditable and for prod it's actually my favorite thing",
    "start": "1240200",
    "end": "1245280"
  },
  {
    "text": "to use so it's kind of like first set of guidance use identity either kind of identity is fine",
    "start": "1245280",
    "end": "1251280"
  },
  {
    "text": "user assigned identity is better for prod it's durable like imagine you go and delete a web app or you delete a",
    "start": "1251280",
    "end": "1257159"
  },
  {
    "text": "function that ident identity if it's tied to the service also gets deleted and goes away whereas a user sign",
    "start": "1257159",
    "end": "1264120"
  },
  {
    "text": "identity is an independent resource and you control the life cycle of it and it",
    "start": "1264120",
    "end": "1269679"
  },
  {
    "text": "never goes away you have complete control so I like user signed um a",
    "start": "1269679",
    "end": "1274919"
  },
  {
    "text": "really important thing is and remember this when you're troubleshooting if you're ever using the default identity in Azure or in a favorite framework like",
    "start": "1274919",
    "end": "1282559"
  },
  {
    "text": "um you know the python sdks or the net sdks when you use that default Azure",
    "start": "1282559",
    "end": "1288159"
  },
  {
    "text": "credential it will automatically default to system assign managed identity that's just the",
    "start": "1288159",
    "end": "1294360"
  },
  {
    "text": "way the Frameworks work and that's why I'm also saying for Dev test that's a really easy way to just be like hey I'm",
    "start": "1294360",
    "end": "1300080"
  },
  {
    "text": "G to have my app do things with default identity I'm going to have a system assigned identity on the service things",
    "start": "1300080",
    "end": "1305600"
  },
  {
    "text": "will just work but if you're starting to use user assign managed identity which",
    "start": "1305600",
    "end": "1310799"
  },
  {
    "text": "again is kind of a best practice for prod that's your default identity will always break you're going to be",
    "start": "1310799",
    "end": "1316320"
  },
  {
    "text": "wondering hey why am I getting permission deny 403 unauthorized kind of Errors you have",
    "start": "1316320",
    "end": "1322080"
  },
  {
    "text": "to go further and kind of disambiguate um which credential you",
    "start": "1322080",
    "end": "1328240"
  },
  {
    "text": "want to use if you want to use a user signed identity and just to kind of bottom line it for you as we can see in",
    "start": "1328240",
    "end": "1334320"
  },
  {
    "text": "the the Json app settings on the right it's that client ID the client ID is the",
    "start": "1334320",
    "end": "1340000"
  },
  {
    "text": "thing that maps to your identity that disambiguates which identity you want to use um so be you know just be careful",
    "start": "1340000",
    "end": "1348240"
  },
  {
    "text": "about this one um if you want to use default identity remember it's system",
    "start": "1348240",
    "end": "1353360"
  },
  {
    "text": "assigned if you want to use a particular one always set that client ID and it's going to kind of reconfigure what your",
    "start": "1353360",
    "end": "1359400"
  },
  {
    "text": "default identity is um third thing you know once you get into the realm of",
    "start": "1359400",
    "end": "1365159"
  },
  {
    "text": "using user sign managed identity you always need three things you need that client ID you need to set the credential",
    "start": "1365159",
    "end": "1373679"
  },
  {
    "text": "property and you need to set the equivalent of the resource name or the URI to the resource each each resource",
    "start": "1373679",
    "end": "1380960"
  },
  {
    "text": "in Azure has a little bit of a different flavor like a storage account has an account name or each of the Uris like",
    "start": "1380960",
    "end": "1387400"
  },
  {
    "text": "blob service table service Q service they all have a URI you can set here um",
    "start": "1387400",
    "end": "1393320"
  },
  {
    "text": "and that's kind of that's kind of saying hey this is the exact Vector into the service I want to use the client ID is",
    "start": "1393320",
    "end": "1400400"
  },
  {
    "text": "saying which you know identity are you going to use and credential is just",
    "start": "1400400",
    "end": "1405679"
  },
  {
    "text": "instructing the system I'm going to use managed identity so simply just the string value managed identities which",
    "start": "1405679",
    "end": "1411600"
  },
  {
    "text": "you need um this is kind of useful because really all of azure Works entirely this way with arbac and I roles",
    "start": "1411600",
    "end": "1419919"
  },
  {
    "text": "everything follows this pattern the Azure sdks um all of our services um",
    "start": "1419919",
    "end": "1425520"
  },
  {
    "text": "whether it's like hosting services like app service or receiving services like Cosmos DB they all work exactly this way",
    "start": "1425520",
    "end": "1432360"
  },
  {
    "text": "and if you remember this pattern you'll be set um also notice that I'm using the SDK pattern here so",
    "start": "1432360",
    "end": "1439159"
  },
  {
    "text": "um if we have a connection string instead of saying you know in the past it would' be like Azure web job storage",
    "start": "1439159",
    "end": "1445880"
  },
  {
    "text": "and you'd have a connection string with a key now you have this underscore underscore and that's the way in the",
    "start": "1445880",
    "end": "1452200"
  },
  {
    "text": "Azure sdks to say hey I'm setting a property of a",
    "start": "1452200",
    "end": "1457240"
  },
  {
    "text": "connection um so it's basically just kind of saying hey this is a pointer in to the connection and I'm going to",
    "start": "1457240",
    "end": "1463240"
  },
  {
    "text": "override these values let's see is there anything else I want to say um in an app service or",
    "start": "1463240",
    "end": "1470720"
  },
  {
    "text": "function or container app actually I should even ask you who's using App services today web apps okay",
    "start": "1470720",
    "end": "1477480"
  },
  {
    "text": "functions okay uh container apps",
    "start": "1477480",
    "end": "1482520"
  },
  {
    "text": "VMS AKs kubernetes what did I miss it's kind of",
    "start": "1482520",
    "end": "1488360"
  },
  {
    "text": "awesome you're using everything thanks um but this this pattern uh will work in",
    "start": "1488360",
    "end": "1493960"
  },
  {
    "text": "all the cases and I'm going to take you through it and then let's take things from the app service or the functions",
    "start": "1493960",
    "end": "1499760"
  },
  {
    "text": "family couple things to know and this boggled my mind when I first started",
    "start": "1499760",
    "end": "1505480"
  },
  {
    "text": "working on this um every service has its own State Management like take an Azure",
    "start": "1505480",
    "end": "1511640"
  },
  {
    "text": "function the way a function kind of keeps track of uh Kon jobs or the way",
    "start": "1511640",
    "end": "1517679"
  },
  {
    "text": "that we're going to scale out multi- instances there is a bit of State Management we know how many instances are out there we know which instance is",
    "start": "1517679",
    "end": "1524320"
  },
  {
    "text": "handling which event it's it's the guts of the internal system but that State Management is usually backed by a",
    "start": "1524320",
    "end": "1531399"
  },
  {
    "text": "storage account and the runtime for a function or web app won't even start it",
    "start": "1531399",
    "end": "1537120"
  },
  {
    "text": "won't even boot if you don't have the identity set up right and maybe you've seen this I see a couple heads nodding",
    "start": "1537120",
    "end": "1543320"
  },
  {
    "text": "like you'll get in this awful state where you're in a continuous crash Loop because your app is trying to deal with",
    "start": "1543320",
    "end": "1549399"
  },
  {
    "text": "its own internal State Management and it can't reach it it can't access it so we have to think about that Azure web job",
    "start": "1549399",
    "end": "1555000"
  },
  {
    "text": "storage for web apps and functions that are stateful even functions if you think they're stateless they're still stateful",
    "start": "1555000",
    "end": "1561240"
  },
  {
    "text": "they always need it um also web jobs those all need it so we're going to set that Azure web job storage and we're",
    "start": "1561240",
    "end": "1567240"
  },
  {
    "text": "going to follow these principles the the next Vector is the deployment itself if",
    "start": "1567240",
    "end": "1572360"
  },
  {
    "text": "you're using an Azure manage service a pass service like app service functions um we use zip files like",
    "start": "1572360",
    "end": "1579960"
  },
  {
    "text": "literally zip files to deploy and our endpoints take these zip files and they",
    "start": "1579960",
    "end": "1585360"
  },
  {
    "text": "slam them into your running resource they dehy at them by unzipping them on disk and then they start the app for you",
    "start": "1585360",
    "end": "1592279"
  },
  {
    "text": "well think about when your app one app starts up or when you do a scale out multi- instances start up they all need",
    "start": "1592279",
    "end": "1599559"
  },
  {
    "text": "to pull that zip file unpack on the disc provision and and run them um so that's",
    "start": "1599559",
    "end": "1605799"
  },
  {
    "text": "yet another internal mechanism where your app at runtime needs pull access to",
    "start": "1605799",
    "end": "1612679"
  },
  {
    "text": "that storage and you want to use that with managed identity as well now that you could use your your web job storage",
    "start": "1612679",
    "end": "1619159"
  },
  {
    "text": "account or you just might have some other deployment storage account but you're going to follow this exact same",
    "start": "1619159",
    "end": "1624360"
  },
  {
    "text": "pattern to set up and configure the identity whether it's system assigned or user assigned to access that and then",
    "start": "1624360",
    "end": "1631640"
  },
  {
    "text": "the third thing is if your app has outbound dependencies and all the things I mentioned you know VMS kubernetes apps",
    "start": "1631640",
    "end": "1638840"
  },
  {
    "text": "web apps functions container apps all of them they all have this concept of a",
    "start": "1638840",
    "end": "1644120"
  },
  {
    "text": "connection um an external connection we're going to set it up exactly the same way with the URI or account name",
    "start": "1644120",
    "end": "1649640"
  },
  {
    "text": "the client ID or the credential so the the awesome thing is if you kind of like memorize this slide and apply it you've",
    "start": "1649640",
    "end": "1656159"
  },
  {
    "text": "got it licked and just remember those those vectors the deployment package the",
    "start": "1656159",
    "end": "1662000"
  },
  {
    "text": "internal State Management and then all your outbound dependencies like sdks triggers",
    "start": "1662000",
    "end": "1668360"
  },
  {
    "text": "bindings all right um this is another one if you want to follow along you have laptops or you want to go back and try",
    "start": "1668640",
    "end": "1674679"
  },
  {
    "text": "it along this is a this is kind of my favorite starter template where just going to look at the absolute Basics",
    "start": "1674679",
    "end": "1680240"
  },
  {
    "text": "getting applied all right so we're going to pop",
    "start": "1680240",
    "end": "1685919"
  },
  {
    "text": "out I'm gonna talk talk at you less with slides I get bored myself I like to use",
    "start": "1685919",
    "end": "1691960"
  },
  {
    "text": "code um um so we're going to go into vs code and this is that exact",
    "start": "1691960",
    "end": "1700360"
  },
  {
    "text": "uh sample that I was",
    "start": "1700360",
    "end": "1704480"
  },
  {
    "text": "recommending actually I should start even back a little bit so the link that I gave you that",
    "start": "1705799",
    "end": "1712679"
  },
  {
    "text": "aka.ms you know secure Das functions uh samples it's going to take you here this",
    "start": "1712679",
    "end": "1718640"
  },
  {
    "text": "is a gallery of like curated samples that um our bigger team has done and I'm",
    "start": "1718640",
    "end": "1725080"
  },
  {
    "text": "going to take you through these um really basic HTTP trigger kind of",
    "start": "1725080",
    "end": "1730640"
  },
  {
    "text": "samples so this just setting up a simple web API and we have one in absolutely every language and for every platform",
    "start": "1730640",
    "end": "1737039"
  },
  {
    "text": "and it's kind of the hello world world of azure services and then as you get more sophisticated maybe you're using AI",
    "start": "1737039",
    "end": "1744159"
  },
  {
    "text": "cognitive Services Cosmos DB Lang chain whatever we're going to follow these secure practices on every sample on the",
    "start": "1744159",
    "end": "1751039"
  },
  {
    "text": "site it's kind of cool so we we're getting secure by Design um if you use any of these you know you're you're",
    "start": "1751039",
    "end": "1756519"
  },
  {
    "text": "starting off with a good reference um all right and we provide BP and",
    "start": "1756519",
    "end": "1762440"
  },
  {
    "text": "infrastructures code which I'm going to walk you through so let's come back here",
    "start": "1762440",
    "end": "1768679"
  },
  {
    "text": "and here's my actual code my actual code's like incredibly simple it's an HTTP Handler so I have one",
    "start": "1768720",
    "end": "1776039"
  },
  {
    "text": "function let's go into zen mode you guys know Zen mode this my favorite control shift p Zen mode built into vs code now",
    "start": "1776039",
    "end": "1784640"
  },
  {
    "text": "it's just my code so like I said this this is ridiculously simple function",
    "start": "1784640",
    "end": "1790080"
  },
  {
    "text": "it's going to sit on the HTTP get route and it's going to take input from the",
    "start": "1790080",
    "end": "1795159"
  },
  {
    "text": "user and it's going to return you know a happy 200 HTTP result or an unhappy if you had",
    "start": "1795159",
    "end": "1801279"
  },
  {
    "text": "an exception um that's all this thing does but the amazing thing is so this was I don't know let's look at how many",
    "start": "1801279",
    "end": "1807880"
  },
  {
    "text": "lines of code was this um this was 28 lines of code but",
    "start": "1807880",
    "end": "1814200"
  },
  {
    "text": "really it's probably 10 of actually real lines of code but there's a whole bunch of infrastructure to secure hello",
    "start": "1814200",
    "end": "1821279"
  },
  {
    "text": "world but we wrote that for you so we um we have the bicep that comes with this",
    "start": "1821279",
    "end": "1827159"
  },
  {
    "text": "let's go back and Design mode and bicep I don't know if you're familiar with it this is our um our domain language to",
    "start": "1827159",
    "end": "1835240"
  },
  {
    "text": "basically have infrastructure as code this is kind of our native language to create resources and configure them um",
    "start": "1835240",
    "end": "1840880"
  },
  {
    "text": "also if you use terraform terraform is perfectly good um but we're we're doing infrastructures code which is kind of",
    "start": "1840880",
    "end": "1847120"
  },
  {
    "text": "like immutable and it goes in source code control and I really love it so I recommend this and as you can see we",
    "start": "1847120",
    "end": "1853559"
  },
  {
    "text": "take some input from the user we're going to create a resource Group we're going to create the user assigned",
    "start": "1853559",
    "end": "1858799"
  },
  {
    "text": "managed identity which is my favorite we can create the app service which works for web apps or for functions um this is",
    "start": "1858799",
    "end": "1866279"
  },
  {
    "text": "an API so I'm going to create an actual function that goes in the plan and we have a storage account like",
    "start": "1866279",
    "end": "1872679"
  },
  {
    "text": "I said everything needs some internal State Management and that is when it kind of gets interesting so we're going",
    "start": "1872679",
    "end": "1878760"
  },
  {
    "text": "to set up managed identity and we're going to apply rback roles so that the",
    "start": "1878760",
    "end": "1884039"
  },
  {
    "text": "function app has access to the storage account and the critical access to have",
    "start": "1884039",
    "end": "1889519"
  },
  {
    "text": "read write um in this case to a storage account is storage blob data owner um",
    "start": "1889519",
    "end": "1896039"
  },
  {
    "text": "storage is the Uber service blob is the specific service and then this is a tip and trick for you all of these rback",
    "start": "1896039",
    "end": "1903200"
  },
  {
    "text": "roles if you want to get to it through the data plane or you want to like have your client app reach the data it's",
    "start": "1903200",
    "end": "1909240"
  },
  {
    "text": "going to have data in the name usually so if I have owner owner is not good enough all owner means is I'm an admin",
    "start": "1909240",
    "end": "1916279"
  },
  {
    "text": "of that resource and I can change properties like kind of Management Properties but if I actually want to access the data I'm looking for a role",
    "start": "1916279",
    "end": "1922919"
  },
  {
    "text": "that has a data access role so this one gives me data owner meaning I'm data read write and I do need read write",
    "start": "1922919",
    "end": "1929159"
  },
  {
    "text": "because I'm reading and writing the state of the function over and over again rapidly and I need that read write",
    "start": "1929159",
    "end": "1936320"
  },
  {
    "text": "capability um and then we're going to set up a v-net we're GNA I to I promised",
    "start": "1936320",
    "end": "1941399"
  },
  {
    "text": "you I'll dig into that later so we won't worry about that right now oops",
    "start": "1941399",
    "end": "1947440"
  },
  {
    "text": "oh I switched somehow I alt tabbed there we go all right vnet um vnet private",
    "start": "1951360",
    "end": "1958360"
  },
  {
    "text": "endpoint we'll talk about that here's the monitoring monitoring also if you want your monitoring to work it needs",
    "start": "1958360",
    "end": "1964600"
  },
  {
    "text": "identity access so we show you how to do that um and that's the basics and this",
    "start": "1964600",
    "end": "1969720"
  },
  {
    "text": "is kind of a simple file to set up my whole Resource Group each one of these resources has a bicep module in detail",
    "start": "1969720",
    "end": "1977519"
  },
  {
    "text": "that we we kind of maintain um that does everything underneath so if you look under here",
    "start": "1977519",
    "end": "1983519"
  },
  {
    "text": "identity storage app service all of that has like definitions that we provide to you and",
    "start": "1983519",
    "end": "1990360"
  },
  {
    "text": "maybe you and your admins want to customize that further that's totally good so you've got the resource as code",
    "start": "1990360",
    "end": "1996200"
  },
  {
    "text": "and the nice thing with this sample you can simply just do an a up has everyone seen azd by now Azure developer CLI so",
    "start": "1996200",
    "end": "2004399"
  },
  {
    "text": "um what we try to do is we give you the code and then we give you the infrastructures code and then",
    "start": "2004399",
    "end": "2011200"
  },
  {
    "text": "you can run this simple command azd up it will take all the infrastructures code it'll provision it um it's item",
    "start": "2011200",
    "end": "2018880"
  },
  {
    "text": "potent so if it needs to reconfigure it it will and then it zip deploys and pushes your payload into",
    "start": "2018880",
    "end": "2024960"
  },
  {
    "text": "it okay so that's that so now we've we've seen the source code we've seen the infrastructure source code we've",
    "start": "2024960",
    "end": "2031760"
  },
  {
    "text": "seen how we deployed it easily we've got the bicep which we can use later in our devops pipelines and our C iicd rigs",
    "start": "2031760",
    "end": "2039120"
  },
  {
    "text": "let's look at the live Resource Group",
    "start": "2039120",
    "end": "2044760"
  },
  {
    "text": "um people in the back can you see this okay a little bigger just do this if it needs to be",
    "start": "2044760",
    "end": "2052000"
  },
  {
    "text": "bigger I'll know what you mean um okay so what we got here is I mean we",
    "start": "2052000",
    "end": "2059280"
  },
  {
    "text": "thought we were building a function but in reality we had to build a whole bunch of stuff even to make Hello World work",
    "start": "2059280",
    "end": "2065520"
  },
  {
    "text": "so like I mentioned we want to have that us user assigned managed identity um we want to have monitoring",
    "start": "2065520",
    "end": "2072200"
  },
  {
    "text": "of course if anything goes wrong we want that observability we've got that storage account which is doing the state",
    "start": "2072200",
    "end": "2077560"
  },
  {
    "text": "management of our app um I picked a harder service this one's",
    "start": "2077560",
    "end": "2083079"
  },
  {
    "text": "using open AI but that's not the one I want to show I'm being like a Nutty Professor",
    "start": "2083079",
    "end": "2088158"
  },
  {
    "text": "right now all right let's go to this one okay so the same idea um and also in",
    "start": "2088159",
    "end": "2096320"
  },
  {
    "text": "like I promis you later we're going to go through the v-net and the private endpoints that we set up so that this",
    "start": "2096320",
    "end": "2102440"
  },
  {
    "text": "thing is Network parameter by default um what I'm proud of of this app is if you",
    "start": "2102440",
    "end": "2107599"
  },
  {
    "text": "follow this pattern there's absolutely no passwords make this a little",
    "start": "2107599",
    "end": "2113400"
  },
  {
    "text": "smaller just for a sec all",
    "start": "2113400",
    "end": "2119520"
  },
  {
    "text": "right so if I go in the environment variables a year ago I could never do this demo I'd be like sent away but now",
    "start": "2119800",
    "end": "2128400"
  },
  {
    "text": "I can actually show you the values of all my environment variables with confidence because there's absolutely no",
    "start": "2128400",
    "end": "2133960"
  },
  {
    "text": "passwords and that's the way we should roll right no passwords the ability to even use passwords is turned off on the",
    "start": "2133960",
    "end": "2139960"
  },
  {
    "text": "App instead what we're seeing is we're seeing this managed identity configuration right so to get to my",
    "start": "2139960",
    "end": "2145640"
  },
  {
    "text": "storage account I'm seeing those three properties that I went on and on about I've got my client ID which points to my",
    "start": "2145640",
    "end": "2151280"
  },
  {
    "text": "user signed identity I'm flagging that I'm using managed identity and I'm pointing to the resource that I want to",
    "start": "2151280",
    "end": "2157160"
  },
  {
    "text": "connect to that's it so it's kind of like we have connection strings but the connection string is just a pointer to",
    "start": "2157160",
    "end": "2164680"
  },
  {
    "text": "the service I want to use telling it the identity to use it doesn't actually have the key anymore there's no connection",
    "start": "2164680",
    "end": "2170800"
  },
  {
    "text": "string key or secret and then you know pay attention to this client ID because we're going to use it in all the",
    "start": "2170800",
    "end": "2177800"
  },
  {
    "text": "dependencies so I used it for my storage account but also if you look at app insights which I'm using for monitoring",
    "start": "2177800",
    "end": "2184079"
  },
  {
    "text": "it's using the same exact client ID right so that's identifying the user identity it's kind of your credentials",
    "start": "2184079",
    "end": "2191359"
  },
  {
    "text": "your your passport that you're showing um and then the service itself",
    "start": "2191359",
    "end": "2196520"
  },
  {
    "text": "will enforce if that identity has rights to come in or not and let's let's take a look at the",
    "start": "2196520",
    "end": "2203319"
  },
  {
    "text": "managed identity itself so when you create the managed identity",
    "start": "2203319",
    "end": "2210079"
  },
  {
    "text": "oops go here I was just looking for yellow I got my function all right um if",
    "start": "2210079",
    "end": "2217599"
  },
  {
    "text": "we take this managed identity and we kind of say hey what's the associated resources this is really",
    "start": "2217599",
    "end": "2224240"
  },
  {
    "text": "handy we can see that this is associated with my function so the only resource in",
    "start": "2224240",
    "end": "2231880"
  },
  {
    "text": "my Resource Group that holds this identity is the function app itself and that's exactly what I want this is a",
    "start": "2231880",
    "end": "2238079"
  },
  {
    "text": "great audit tool to make sure you and your team didn't inadvertently share identities all over the place because",
    "start": "2238079",
    "end": "2244440"
  },
  {
    "text": "remember we want like one app talking to one dependent and the more you share a credential the",
    "start": "2244440",
    "end": "2250560"
  },
  {
    "text": "more trouble you get into where like Services can talk to other services that they shouldn't be another thing we can",
    "start": "2250560",
    "end": "2257359"
  },
  {
    "text": "look at is the role assignments and a rooll assignment is always about one resource having access",
    "start": "2257359",
    "end": "2263640"
  },
  {
    "text": "to another resource and having a very particular Grant or rback role so in",
    "start": "2263640",
    "end": "2269000"
  },
  {
    "text": "this case I can see that this identity is allowed Downstream to be a data owner",
    "start": "2269000",
    "end": "2275480"
  },
  {
    "text": "of the storage account I can also see that I'm allowed to basically write or publish metrics and logs to app insights",
    "start": "2275480",
    "end": "2283359"
  },
  {
    "text": "right so this is really cool by using the user assigned identity I have this durable thing I can always look at I can",
    "start": "2283359",
    "end": "2289280"
  },
  {
    "text": "always audit see what it has access to and when it comes to troubleshooting this thing is like super invaluable um",
    "start": "2289280",
    "end": "2296200"
  },
  {
    "text": "ask me how I know uh hours and hours and hours um so that's that's the identity",
    "start": "2296200",
    "end": "2303319"
  },
  {
    "text": "piece and this is like kind of the simple Hello World um I want to riff off of this a little bit and I'm going to",
    "start": "2303319",
    "end": "2309400"
  },
  {
    "text": "show you all the places that we apply the same thing so now let's go to a more sophisticated",
    "start": "2309400",
    "end": "2315640"
  },
  {
    "text": "app so this is another sample in that Gallery this one uses cognitive services",
    "start": "2315640",
    "end": "2320760"
  },
  {
    "text": "in AI all right so in addition to the function and the identity we're also",
    "start": "2320760",
    "end": "2327079"
  },
  {
    "text": "seeing that it's using Azure open AI cognitive services and in here I have a",
    "start": "2327079",
    "end": "2333040"
  },
  {
    "text": "a GPT 40 model um which I'm going to use for embeddings I'm going to use for chat",
    "start": "2333040",
    "end": "2339720"
  },
  {
    "text": "um and uh basically I I'm going to this is a chatbot app and I'll actually kind of show you how it works in the second",
    "start": "2339720",
    "end": "2346560"
  },
  {
    "text": "um let's look at how we configured the function so the function has an",
    "start": "2346560",
    "end": "2354960"
  },
  {
    "text": "identity I really wish the portal didn't make the left side disappear come on so here we go so if I",
    "start": "2355040",
    "end": "2363040"
  },
  {
    "text": "scan down the function has this identity I've turned off system assigned",
    "start": "2363040",
    "end": "2368359"
  },
  {
    "text": "because again I I like that for Dev tests but I don't like it for more serious stuff I have a user assigned",
    "start": "2368359",
    "end": "2373400"
  },
  {
    "text": "identity so this app is going to be able to run as this identity and then um if I",
    "start": "2373400",
    "end": "2379599"
  },
  {
    "text": "look at the environment variables let's look at them in Json view um same thing as we saw before app",
    "start": "2379599",
    "end": "2386839"
  },
  {
    "text": "insights has an identity based connection string um I'm seeing a couple new things so globally I can set the",
    "start": "2386839",
    "end": "2394440"
  },
  {
    "text": "client ID for everything in the entire Azure host app and this is kind of",
    "start": "2394440",
    "end": "2399640"
  },
  {
    "text": "saying override whatever you think the default Azure credential is override it",
    "start": "2399640",
    "end": "2405200"
  },
  {
    "text": "to use this identity um this is this can be a good thing but it can be a bad thing it's",
    "start": "2405200",
    "end": "2411000"
  },
  {
    "text": "kind of like pinning a version right like you have to make sure that you understand you've pinned this identity",
    "start": "2411000",
    "end": "2417680"
  },
  {
    "text": "to the whole app and if this config lives anywhere and you're trying to use a different identity this will be the",
    "start": "2417680",
    "end": "2423440"
  },
  {
    "text": "reason why your app doesn't work so just kind of keep in mind you're pinning here to a a client identity and in limited",
    "start": "2423440",
    "end": "2429440"
  },
  {
    "text": "cases that's fine um and then unlike the last tella",
    "start": "2429440",
    "end": "2434920"
  },
  {
    "text": "World app here I'm using Azure open Ai and as I mentioned every service has",
    "start": "2434920",
    "end": "2441520"
  },
  {
    "text": "something like an endpoint or a name or a URI and all we do is we set that",
    "start": "2441520",
    "end": "2447040"
  },
  {
    "text": "endpoint or URI property in addition to the client ID and now we're using us",
    "start": "2447040",
    "end": "2452200"
  },
  {
    "text": "user assign managed identity to call our Downstream service so like this",
    "start": "2452200",
    "end": "2457520"
  },
  {
    "text": "technique setting the client ID and setting the endpoint in config is the way across all the host types kubernetes",
    "start": "2457520",
    "end": "2464839"
  },
  {
    "text": "VMS app service functions I don't care excuse me they all work this way even on your local",
    "start": "2464839",
    "end": "2470599"
  },
  {
    "text": "machine um so far so good got to making sense now like let's try this let's kind",
    "start": "2470599",
    "end": "2475839"
  },
  {
    "text": "of pressure test this let's look at it locally so here",
    "start": "2475839",
    "end": "2481839"
  },
  {
    "text": "um in vs code I have the same chat GPT app um",
    "start": "2481839",
    "end": "2487960"
  },
  {
    "text": "the the last one was net this one just happens to be python doesn't doesn't really matter but in this case as a",
    "start": "2487960",
    "end": "2493960"
  },
  {
    "text": "developer all I thought about was hey I'm going to write my function code um this one's a chatbot so I can here let",
    "start": "2493960",
    "end": "2501280"
  },
  {
    "text": "me show you the HTP file so the way I'm going to use this app is I can um I could do a simple",
    "start": "2501280",
    "end": "2509640"
  },
  {
    "text": "completion I can make a prompt and the model will respond or I can do a",
    "start": "2509640",
    "end": "2514880"
  },
  {
    "text": "stateful chatbot this is pretty cool with functions so I can start a chat",
    "start": "2514880",
    "end": "2520760"
  },
  {
    "text": "session and then I can issue basically prompts or messages to it um and I can",
    "start": "2520760",
    "end": "2526760"
  },
  {
    "text": "even get the chat State and see all the history right so this is kind of how I'm I'm going to use the API um so what",
    "start": "2526760",
    "end": "2532400"
  },
  {
    "text": "we've got is we've got a function function's got some State Management the function's got a deployment concern and",
    "start": "2532400",
    "end": "2538720"
  },
  {
    "text": "then it's got a connection to Azure open AI um we saw how to set that up in the",
    "start": "2538720",
    "end": "2544280"
  },
  {
    "text": "cloud to set it up locally I'm going to use an app config file or in the functions case a local",
    "start": "2544280",
    "end": "2551000"
  },
  {
    "text": "settings. Json file if you're wondering how to do",
    "start": "2551000",
    "end": "2559720"
  },
  {
    "text": "this so if I'm running locally this is like a little bit of a mind Bender we",
    "start": "2560200",
    "end": "2567119"
  },
  {
    "text": "can connect to services using an identity based um credential but we're not going to use managed identity",
    "start": "2567119",
    "end": "2573920"
  },
  {
    "text": "managed identity is about Services talking to other services in this case I'm Paul I'm running on my",
    "start": "2573920",
    "end": "2579680"
  },
  {
    "text": "local machine so I actually want to run as my interactive login identity which is Paul yuck at microsoft.com that's an",
    "start": "2579680",
    "end": "2586800"
  },
  {
    "text": "entra identity that's inside of entra so I'm using Paul's identity I'm not using the function in the Cloud's identity to",
    "start": "2586800",
    "end": "2593359"
  },
  {
    "text": "talk to my Downstream dependencies So based on that I'm going to use the same kind of uh approach where I take the",
    "start": "2593359",
    "end": "2601559"
  },
  {
    "text": "account name or the URI and I specify just that but no secrets um um and this",
    "start": "2601559",
    "end": "2607960"
  },
  {
    "text": "next part is very very very important we want to use the default Azure credential",
    "start": "2607960",
    "end": "2613280"
  },
  {
    "text": "so we need to make sure we don't specify managed identity and we don't specify client ID right because remember if you",
    "start": "2613280",
    "end": "2619760"
  },
  {
    "text": "specify a client ID no matter what it's going to override and use that like user assign identity and your app will",
    "start": "2619760",
    "end": "2626760"
  },
  {
    "text": "break and you're going to spend time debugging why it's broken all um so in this case we just want the user assigned",
    "start": "2626760",
    "end": "2633079"
  },
  {
    "text": "identity to flow through and if you think about it I'm in vs code or I'm at the command line or I'm in Visual Studio",
    "start": "2633079",
    "end": "2639880"
  },
  {
    "text": "when you sign into those those applied your user's identity to that process and now it's going to use your interactive",
    "start": "2639880",
    "end": "2646559"
  },
  {
    "text": "login identity to go through um so these are kind of the best practices you want",
    "start": "2646559",
    "end": "2651760"
  },
  {
    "text": "to use only the URI or account information never client ID never",
    "start": "2651760",
    "end": "2657640"
  },
  {
    "text": "managed identity for local if you want to get this to work using identity based credentials the second thing to pull",
    "start": "2657640",
    "end": "2664720"
  },
  {
    "text": "this off is if you look back in the",
    "start": "2664720",
    "end": "2671200"
  },
  {
    "text": "cloud let's go back let's actually go to our our cognitive",
    "start": "2671480",
    "end": "2678680"
  },
  {
    "text": "service and let's go to the access control this is where all the aess and rols are set and if we look at the roll",
    "start": "2679800",
    "end": "2688960"
  },
  {
    "text": "assignments give it a second to load in um remember owner owner sort of",
    "start": "2688960",
    "end": "2696480"
  },
  {
    "text": "doesn't matter that means I'm an admin of the resources that doesn't give me access into the data plane of my",
    "start": "2696480",
    "end": "2703160"
  },
  {
    "text": "service um what I actually want to be is a",
    "start": "2703160",
    "end": "2710160"
  },
  {
    "text": "cognitive Services user and I can see that both the user assigned identity",
    "start": "2710160",
    "end": "2715200"
  },
  {
    "text": "which is held by my function my web app that has access to be a cognitive Services user but so does Paul yuck",
    "start": "2715200",
    "end": "2722400"
  },
  {
    "text": "microsoft.com and see how this one is like hey that's a managed identity this is a user identity not to be confused",
    "start": "2722400",
    "end": "2729119"
  },
  {
    "text": "with user assign managed identity it's just a user identity so um the bottom line of what I'm saying here is both my",
    "start": "2729119",
    "end": "2736400"
  },
  {
    "text": "users's identity as developer needed access and so did the app now you might",
    "start": "2736400",
    "end": "2741960"
  },
  {
    "text": "decide like let's say a prod resource I probably wouldn't add my user identity I'd be like nope only my cicd uh rig has",
    "start": "2741960",
    "end": "2750960"
  },
  {
    "text": "access to do this definitely not Paul that's fine but for Dev test this is a pretty reasonable configuration and if",
    "start": "2750960",
    "end": "2756720"
  },
  {
    "text": "you're ever kind of like hey I'm locally trying to connect to an Azure resource and I'm getting access denied just",
    "start": "2756720",
    "end": "2762400"
  },
  {
    "text": "remember you might have set up a managed identity for the app but not for you um",
    "start": "2762400",
    "end": "2767440"
  },
  {
    "text": "and this supports users and groups so you could also like let a team have access to something and use this",
    "start": "2767440",
    "end": "2774000"
  },
  {
    "text": "sparingly right because this means I have data access to anything in this app like anything interesting going on any",
    "start": "2774000",
    "end": "2780240"
  },
  {
    "text": "logs I I have access in this case I even have the entire model like I can access the entire model",
    "start": "2780240",
    "end": "2787119"
  },
  {
    "text": "um again so far so good so this is kind of my identity and access um use managed identity use user identity definitely",
    "start": "2787119",
    "end": "2794200"
  },
  {
    "text": "not service principles definitely definitely not passwords I think we showed the different config tricks um",
    "start": "2794200",
    "end": "2800720"
  },
  {
    "text": "remember that you know kind of here every one of these samples in the INF",
    "start": "2800720",
    "end": "2807280"
  },
  {
    "text": "folder comes with the the infrastructure is code so you",
    "start": "2807280",
    "end": "2812640"
  },
  {
    "text": "don't have to do click Ops you don't have to go through the portal and click click click and set all the stuff up this is effectively your deterministic",
    "start": "2812640",
    "end": "2819160"
  },
  {
    "text": "script that will apply the correct users en roles and you know if you can reuse",
    "start": "2819160",
    "end": "2825119"
  },
  {
    "text": "this all over the place and we definitely do all right so that's my that's kind of my crash course and users",
    "start": "2825119",
    "end": "2831359"
  },
  {
    "text": "identity managed identity and like remember if we kind of step back to the beginning midnight blizzard if we had",
    "start": "2831359",
    "end": "2838079"
  },
  {
    "text": "done the right things with identities a lot of that would have been curbed now I want to talk about another defense",
    "start": "2838079",
    "end": "2844680"
  },
  {
    "text": "in-depth technique on network perimeters",
    "start": "2844680",
    "end": "2848838"
  },
  {
    "text": "and I have to talk less and do more because I'm going to run out of time um okay so Network isolation it's basically",
    "start": "2852640",
    "end": "2860240"
  },
  {
    "text": "about restricting inbound and outbound traffic um outbound this was actually a",
    "start": "2860240",
    "end": "2867000"
  },
  {
    "text": "surprise to me this is something I learned the hard way outbound is the first place where attackers try to",
    "start": "2867000",
    "end": "2872800"
  },
  {
    "text": "exploit you because once you're on the machine they try to get to other machines",
    "start": "2872800",
    "end": "2878280"
  },
  {
    "text": "um and so you want to really think about outbound only allowing traffic to very",
    "start": "2878280",
    "end": "2885800"
  },
  {
    "text": "specific places and then it's up to the service to at least use",
    "start": "2885800",
    "end": "2891520"
  },
  {
    "text": "identity to decide if that uh request should come in it could also use",
    "start": "2891520",
    "end": "2897280"
  },
  {
    "text": "networking to decide inbound if something can come in as well um but I would kind of say like best practice if",
    "start": "2897280",
    "end": "2903520"
  },
  {
    "text": "you have to do something right away use identity set out sound networking controls and that will like eliminate",
    "start": "2903520",
    "end": "2911520"
  },
  {
    "text": "the um midnight blizzard style attack inbound is also interesting it makes",
    "start": "2911520",
    "end": "2917319"
  },
  {
    "text": "life more difficult this is basically so think about a web app or a service if",
    "start": "2917319",
    "end": "2923040"
  },
  {
    "text": "you put inbound networking restriction that means no public traffic can get to it now that's an awfully good idea for",
    "start": "2923040",
    "end": "2928880"
  },
  {
    "text": "your databases your background dependencies or even you know your key vaults right you don't want people",
    "start": "2928880",
    "end": "2935400"
  },
  {
    "text": "Hammer attacking your key vaults they have no business doing that um but it's going to make your user experience very",
    "start": "2935400",
    "end": "2941920"
  },
  {
    "text": "difficult and tricky right because it basically means you need a VPN or some",
    "start": "2941920",
    "end": "2946960"
  },
  {
    "text": "kind of private endpoint solution to even have network access to authenticate into the app um so we we're we're still",
    "start": "2946960",
    "end": "2957200"
  },
  {
    "text": "figuring out what we want to do um in Microsoft should we make everything Network restricted inbound by default or",
    "start": "2957200",
    "end": "2963520"
  },
  {
    "text": "not we haven't quite done that yet Azure container apps is probably the first service that we've done that rist rexs",
    "start": "2963520",
    "end": "2970200"
  },
  {
    "text": "inbound or Ingress by default um but we might actually do that over time so this",
    "start": "2970200",
    "end": "2975240"
  },
  {
    "text": "is a good concept to get used to all right now how do we do the network isolation here's a little bit of a",
    "start": "2975240",
    "end": "2982440"
  },
  {
    "text": "picture did I put labels shoot I didn't put labels sorry about that so I'll kind of walk you through it on the left hand",
    "start": "2982440",
    "end": "2989400"
  },
  {
    "text": "side we have a client think your browser or or some other mobile app it's coming",
    "start": "2989400",
    "end": "2994880"
  },
  {
    "text": "into a function or an app and the function needs to run its code",
    "start": "2994880",
    "end": "3001079"
  },
  {
    "text": "but the function also needs access to a back-end storage account and storage and data is of the utmost importance to um",
    "start": "3001079",
    "end": "3010200"
  },
  {
    "text": "to kind of protect like there that web browser has no business getting into",
    "start": "3010200",
    "end": "3015400"
  },
  {
    "text": "your internal storage whatsoever it should never make sense ever ever ever so what we're going to do first is we're",
    "start": "3015400",
    "end": "3021680"
  },
  {
    "text": "going to deny outbound network access to anything from this function other than",
    "start": "3021680",
    "end": "3028440"
  },
  {
    "text": "um it having a pinhole access through the storage um we don't want it accessing",
    "start": "3028440",
    "end": "3034799"
  },
  {
    "text": "active directory we don't want it accessing my other databases we don't want it accessing my other microservices",
    "start": "3034799",
    "end": "3041000"
  },
  {
    "text": "or apis we want this function to be locked down the only thing it can talk to is what I want it to talk to that's",
    "start": "3041000",
    "end": "3046839"
  },
  {
    "text": "it and so that's all about outbound um network security isolation and then we",
    "start": "3046839",
    "end": "3051880"
  },
  {
    "text": "could also think about inbound we can IP restrict it or we can can uh like turn",
    "start": "3051880",
    "end": "3058359"
  },
  {
    "text": "it fully off and require vpns to come into that IP space and that's like the",
    "start": "3058359",
    "end": "3064319"
  },
  {
    "text": "most protective you could possibly",
    "start": "3064319",
    "end": "3068440"
  },
  {
    "text": "be all right so um for inbound traffic the most secure thing we can do today is",
    "start": "3070160",
    "end": "3077520"
  },
  {
    "text": "we can um if we're using Azure software and not additional like Hardware in",
    "start": "3077520",
    "end": "3082799"
  },
  {
    "text": "front of it we can use a v-net um again if you put on a v-net it completely will",
    "start": "3082799",
    "end": "3089040"
  },
  {
    "text": "deny by default all traffic all traffic is untrusted and then you basically have",
    "start": "3089040",
    "end": "3094559"
  },
  {
    "text": "a few things you can do you can allow list trusted IPS um and",
    "start": "3094559",
    "end": "3102319"
  },
  {
    "text": "uh otherwise you can just you know it's kind of like poking a hole in your firewall otherwise you could just have a",
    "start": "3102319",
    "end": "3107599"
  },
  {
    "text": "VPN and then you rely on off methods like easy off as being a good way to",
    "start": "3107599",
    "end": "3114079"
  },
  {
    "text": "decide not only should the traffic packet come in um at layer seven or layer um layer",
    "start": "3114079",
    "end": "3120599"
  },
  {
    "text": "three but I also am going to make sure that that is authorized to to reach my",
    "start": "3120599",
    "end": "3125960"
  },
  {
    "text": "app um for outbound you want to join the v-net and that's less uh aggressive and",
    "start": "3125960",
    "end": "3132319"
  },
  {
    "text": "disruptive to your user experience it's more about protecting the rest of your Fleet from that app so you join the",
    "start": "3132319",
    "end": "3138960"
  },
  {
    "text": "v-net and then we create tiny little pokes through the firewall with things",
    "start": "3138960",
    "end": "3145280"
  },
  {
    "text": "called service endpoints and private endpoints um and if you want to be um if",
    "start": "3145280",
    "end": "3151119"
  },
  {
    "text": "you want to have a little bit of convenience you can take a list of ips that should have um access and you can",
    "start": "3151119",
    "end": "3157920"
  },
  {
    "text": "do an outbound natat Network translation which is like a many to one relationship",
    "start": "3157920",
    "end": "3163000"
  },
  {
    "text": "you can have many IP addresses in a service tag list that go out through one IP and that one IP is the single IP that",
    "start": "3163000",
    "end": "3170400"
  },
  {
    "text": "has access to the outbound dependency um that's a best practice we do now if it's",
    "start": "3170400",
    "end": "3176040"
  },
  {
    "text": "just one service calling one dependency you don't have to worry about it but if you're a service as big as app service",
    "start": "3176040",
    "end": "3182440"
  },
  {
    "text": "itself we have millions of public IP addresses so rather than having AOW lists of millions of IP addresses which",
    "start": "3182440",
    "end": "3189760"
  },
  {
    "text": "doesn't really scale we do our own mapping through a service tag with a million to one so a million things map",
    "start": "3189760",
    "end": "3196119"
  },
  {
    "text": "into the one IP address and the one IP address is the only thing that can talk to our",
    "start": "3196119",
    "end": "3202240"
  },
  {
    "text": "storage all right and with the the of the time I have I want to show you a demo of this so we're going to go back",
    "start": "3203760",
    "end": "3210400"
  },
  {
    "text": "to the same hello world the secure hello world all right so here we",
    "start": "3210400",
    "end": "3217440"
  },
  {
    "text": "go and let's look at some of the concepts we added so we added a v-net right and this is this is our corporate",
    "start": "3217440",
    "end": "3224000"
  },
  {
    "text": "or our private Network just for our service and rule of thumb only",
    "start": "3224000",
    "end": "3230079"
  },
  {
    "text": "Associated things that should talk to each other belong in the same v-net everything else absolutely should be out",
    "start": "3230079",
    "end": "3235280"
  },
  {
    "text": "of your vnet no question questions asked and even once we have a v-net there's more to think about so in",
    "start": "3235280",
    "end": "3243119"
  },
  {
    "text": "the v-net we start getting into physical networking Concepts um like subnets and the best",
    "start": "3243119",
    "end": "3250520"
  },
  {
    "text": "practice here is that your app is always in one subnet and your dependencies are",
    "start": "3250520",
    "end": "3256079"
  },
  {
    "text": "always in their own subnet so you've kind of firewalled even within your virtual Network you're",
    "start": "3256079",
    "end": "3262520"
  },
  {
    "text": "firewalling your apps IPS from your dependencies IPS right and",
    "start": "3262520",
    "end": "3270119"
  },
  {
    "text": "if you have multiple dependencies like I showed you that AI case I have the storage account I have",
    "start": "3270119",
    "end": "3276319"
  },
  {
    "text": "monitoring and I had the AI service three dependencies three subnets plus",
    "start": "3276319",
    "end": "3282520"
  },
  {
    "text": "the app so that's four and you can kind of see like it there's a little bit of complexity that kind of comes with this",
    "start": "3282520",
    "end": "3288559"
  },
  {
    "text": "but if you want to do the full like you know 300 400 level security treatment",
    "start": "3288559",
    "end": "3293680"
  },
  {
    "text": "this is what we do we Define one subnet for each dependency one for the app um",
    "start": "3293680",
    "end": "3299240"
  },
  {
    "text": "and that's really the best practice and then we have these things called private",
    "start": "3299240",
    "end": "3304440"
  },
  {
    "text": "endpoints um and the private endpoint is effectively that that little tiny hole through the",
    "start": "3305160",
    "end": "3312520"
  },
  {
    "text": "through the firewall so I have to come in so to get",
    "start": "3312520",
    "end": "3318280"
  },
  {
    "text": "to that storage account I have to come in through a trusted IP and this private",
    "start": "3318280",
    "end": "3323319"
  },
  {
    "text": "endpoint in the private DNS Zone gives me me a feature where I can refer to a",
    "start": "3323319",
    "end": "3328839"
  },
  {
    "text": "well-known domain here and I can find that storage account and talk to it using the right",
    "start": "3328839",
    "end": "3335240"
  },
  {
    "text": "IP to get through so only this function can use this private endpoint which",
    "start": "3335240",
    "end": "3340559"
  },
  {
    "text": "gives me that IP which can get to that storage account so the combination of private endpoints DNS",
    "start": "3340559",
    "end": "3347280"
  },
  {
    "text": "Zone um plus v-net this is the story to set up the network isolation for",
    "start": "3347280",
    "end": "3354480"
  },
  {
    "text": "outbound and you end up again with basically one endpoint and one subnet",
    "start": "3354480",
    "end": "3360960"
  },
  {
    "text": "for every single dependency that you have and one unfortunate bit of news for you is that um if you take the storage",
    "start": "3360960",
    "end": "3368400"
  },
  {
    "text": "service even though we logically think of azure storage as one service it's actually Four it's the blob service the",
    "start": "3368400",
    "end": "3375039"
  },
  {
    "text": "table service the Q service and the file service each one of those from a network",
    "start": "3375039",
    "end": "3380280"
  },
  {
    "text": "standpoint is a different service that means an endpoint and an IP address for",
    "start": "3380280",
    "end": "3385640"
  },
  {
    "text": "every one of those so you kind of start to see a little bit of a matrix explosion with this um and by the way I",
    "start": "3385640",
    "end": "3392640"
  },
  {
    "text": "want to make now that I've felt the pain we're going to make this easier and easier so you can in a more automated",
    "start": "3392640",
    "end": "3398880"
  },
  {
    "text": "way get like hey we've identified you have these four dependencies should we",
    "start": "3398880",
    "end": "3403960"
  },
  {
    "text": "give you a secure network perimeter to just have private end points to all these we're working on that productivity",
    "start": "3403960",
    "end": "3410200"
  },
  {
    "text": "unfortunately that's not there right now so I think the best I could do for you is like the bicep and the guidance on",
    "start": "3410200",
    "end": "3416400"
  },
  {
    "text": "here's how you do it the very last piece uh was there anything else I want to say about",
    "start": "3416400",
    "end": "3423200"
  },
  {
    "text": "that I think that's the key remember we have the bicep for all of this also so",
    "start": "3423200",
    "end": "3429920"
  },
  {
    "text": "remember in here in the main bicep we had a",
    "start": "3429920",
    "end": "3436599"
  },
  {
    "text": "module sorry for the sculling as I mentioned there's a matrix",
    "start": "3440480",
    "end": "3445680"
  },
  {
    "text": "explosion here it is virtual Network so it looks really simple like hey just drop a virtual Network in here so this",
    "start": "3445680",
    "end": "3451520"
  },
  {
    "text": "is backed by the vet. bicep file and i' I'd recommend studying this a little",
    "start": "3451520",
    "end": "3457640"
  },
  {
    "text": "bit because this really to me kind of makes the concepts",
    "start": "3457640",
    "end": "3463839"
  },
  {
    "text": "clear so here we're going to define the virtual Network and we're going to Define each of the subnets and as I",
    "start": "3464079",
    "end": "3471520"
  },
  {
    "text": "mentioned it's critical the app has its own subnet each dependency has its own subnet so you can see we walk through",
    "start": "3471520",
    "end": "3477760"
  },
  {
    "text": "and we kind of say Okay um the app here's its subnet it's on the two dot",
    "start": "3477760",
    "end": "3483640"
  },
  {
    "text": "subnet and by the way every function we've we've done the math to make sure you have enough IPS per subnet and you",
    "start": "3483640",
    "end": "3489240"
  },
  {
    "text": "don't run out um we had we used to hit some limits but we've done some work to",
    "start": "3489240",
    "end": "3495000"
  },
  {
    "text": "make sure you won't run out um and then each of the dependencies like whether",
    "start": "3495000",
    "end": "3500160"
  },
  {
    "text": "it's storage or whether it's AI you know we give it a new subnet and then there's",
    "start": "3500160",
    "end": "3506319"
  },
  {
    "text": "more things we have to do we have to enable uh the private endpoints so that you can call that DNS name it will",
    "start": "3506319",
    "end": "3513280"
  },
  {
    "text": "reverse proxy you into that endpoint um a little bit of heavy",
    "start": "3513280",
    "end": "3518760"
  },
  {
    "text": "lifting but again I think with this template this is what you want to do and it's repeatable literally for every host",
    "start": "3518760",
    "end": "3524640"
  },
  {
    "text": "service every dependency that you have um and more and more that secure sample Gallery I pointed you to there's more",
    "start": "3524640",
    "end": "3531400"
  },
  {
    "text": "like common apps that we're showing on there or think of them as Solutions hey if I have an AI app this is what my",
    "start": "3531400",
    "end": "3536760"
  },
  {
    "text": "network looks like if I have a function if I have a container app this is what it looks like um so you can get a feel",
    "start": "3536760",
    "end": "3542720"
  },
  {
    "text": "for that and just reuse the the pieces of that code um very last thing if you want to",
    "start": "3542720",
    "end": "3548359"
  },
  {
    "text": "do that inbound networking right you're getting into the um the world of of uh",
    "start": "3548359",
    "end": "3554440"
  },
  {
    "text": "vpns how many of you require vpns for your apps today just kind of curious this number of hands goes up every year",
    "start": "3554440",
    "end": "3561200"
  },
  {
    "text": "it's becoming more more at at Microsoft we actually don't a lot of the times but that's changing",
    "start": "3561200",
    "end": "3567400"
  },
  {
    "text": "um and uh I again I see it more and more the other thing it even if you don't",
    "start": "3567400",
    "end": "3572920"
  },
  {
    "text": "secure the network parameter inbound I highly recommend at least turning on off",
    "start": "3572920",
    "end": "3579280"
  },
  {
    "text": "require every inbound connection to your app uses off of some form and in our",
    "start": "3579280",
    "end": "3584640"
  },
  {
    "text": "platform the easiest thing to to use is called easy off I think that's beyond",
    "start": "3584640",
    "end": "3590119"
  },
  {
    "text": "what I have time to talk about in an hour um but I I'll leave you the reference for that you turn on easy off",
    "start": "3590119",
    "end": "3595559"
  },
  {
    "text": "and easy off accepts entra it accepts a lot of the social IDs like Google's",
    "start": "3595559",
    "end": "3600640"
  },
  {
    "text": "identity Facebook um many many many of them um and it also supports something",
    "start": "3600640",
    "end": "3606960"
  },
  {
    "text": "called oidc or open ID connect so if you've ever thought about like how does Google which technically is its own",
    "start": "3606960",
    "end": "3613319"
  },
  {
    "text": "company and its own identity talk to Azure it does it through oidc connect which is a um an open ID protocol and",
    "start": "3613319",
    "end": "3621760"
  },
  {
    "text": "that open ID protocol understands managed identity and entro identity so it can kind of broker that back and",
    "start": "3621760",
    "end": "3628200"
  },
  {
    "text": "forth relationship so easo makes it easy to kind of bring your own o Tech and put",
    "start": "3628200",
    "end": "3634039"
  },
  {
    "text": "that as the off front door in front of your apis in front of your apps um easy",
    "start": "3634039",
    "end": "3640200"
  },
  {
    "text": "off is easy on the service to be honest a limitation is easy off is not easy yet on the client but we have docs for it",
    "start": "3640200",
    "end": "3647559"
  },
  {
    "text": "but I promised I'd talk about limitations and that's that's one of them um so I think that's it we're going",
    "start": "3647559",
    "end": "3653119"
  },
  {
    "text": "to run out of time so I'm going to leave you with some",
    "start": "3653119",
    "end": "3658240"
  },
  {
    "text": "resources um I'll send out the slide deck afterwards but we we have decks um",
    "start": "3659920",
    "end": "3666079"
  },
  {
    "text": "we we have docs rather for app service Azure functions I'll add one for AKs and",
    "start": "3666079",
    "end": "3671480"
  },
  {
    "text": "VMS since you raised your hands and container apps um we've got these quick starts which show you all the solutions",
    "start": "3671480",
    "end": "3677720"
  },
  {
    "text": "I'd highly recommend starting there um when all out fails you can X or tweet me",
    "start": "3677720",
    "end": "3683160"
  },
  {
    "text": "or whatever you say nowadays um I'd love to talk to you and kind of help point you in the right direction also we've",
    "start": "3683160",
    "end": "3688640"
  },
  {
    "text": "we've kind of trained search engines and even like chat GPT so if you just say",
    "start": "3688640",
    "end": "3694520"
  },
  {
    "text": "write a secure Azure web app or write a secure function this guidance and these",
    "start": "3694520",
    "end": "3699680"
  },
  {
    "text": "samples will come right up so yes uh that's pretty cool so hopefully everyone learned something uh that you got",
    "start": "3699680",
    "end": "3706119"
  },
  {
    "text": "something out of this please give me some feedback afterwards I'd love that and uh hopefully we're in it together to",
    "start": "3706119",
    "end": "3712440"
  },
  {
    "text": "lock this stuff down and get a few steps ahead of the attackers thank you very much [Applause]",
    "start": "3712440",
    "end": "3724590"
  }
]