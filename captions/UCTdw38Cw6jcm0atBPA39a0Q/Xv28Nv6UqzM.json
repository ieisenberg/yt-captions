[
  {
    "text": "get silence Wow good afternoon everyone welcome to the",
    "start": "10620",
    "end": "17410"
  },
  {
    "text": "last talk of NDC 2019 I hope you guys have had a good conference so far I",
    "start": "17410",
    "end": "23680"
  },
  {
    "text": "certainly did I enjoyed lots of talks I particularly like the ones on cloud and architecture the ones on communities and",
    "start": "23680",
    "end": "30970"
  },
  {
    "text": "docker and things like that and I got nothing against any of them I particularly like them but a lot of use",
    "start": "30970",
    "end": "37329"
  },
  {
    "text": "case scenarios something like a service architecture is a lot more simpler and a lot more easier to use and the reason",
    "start": "37329",
    "end": "44949"
  },
  {
    "text": "for that is just not the simplicity of it even the cost modeling works quite well when you're dealing with serverless",
    "start": "44949",
    "end": "51309"
  },
  {
    "text": "a lot of startups actually prefer working in this stuff and of course with",
    "start": "51309",
    "end": "57129"
  },
  {
    "text": "with something like serverless technology pretty much most of the stuff",
    "start": "57129",
    "end": "63609"
  },
  {
    "text": "is taken care of by the cloud vendor things like how you do your scaling how",
    "start": "63609",
    "end": "69520"
  },
  {
    "text": "you do a patching and things like that but one of the things that you really need to worry about is security and",
    "start": "69520",
    "end": "75070"
  },
  {
    "text": "that's what this talk is all about my name is Manish Krishnan I work for AGL energy and I've been working in cloud",
    "start": "75070",
    "end": "81940"
  },
  {
    "text": "and architecture for a number of years now I used to be a cloud as your MVP for",
    "start": "81940",
    "end": "87340"
  },
  {
    "text": "about four years or so and my co-presenter is Prateek pratik also",
    "start": "87340",
    "end": "92770"
  },
  {
    "text": "works at HCL he's one of the cloud solution architects and one thing even before I get started I'll say is that",
    "start": "92770",
    "end": "99630"
  },
  {
    "text": "we're gonna be talking about civil as security and we're gonna be focusing primarily on the azure cloud but the",
    "start": "99630",
    "end": "105730"
  },
  {
    "text": "concept that we are going to be talking about will translate quite easily to any of the other cloud providers as well",
    "start": "105730",
    "end": "111130"
  },
  {
    "text": "whether you're using AWS or or Google or any of those things anything with support service you know",
    "start": "111130",
    "end": "116920"
  },
  {
    "text": "you'll be able to use those concepts so what the hell is the service architecture itself right if you look at",
    "start": "116920",
    "end": "122740"
  },
  {
    "text": "I suppose like the martin fowler's description of it he basically says servers architectures are application",
    "start": "122740",
    "end": "128379"
  },
  {
    "text": "designs that incorporate third-party baths are back in as a service and this is actually exposed through custom code",
    "start": "128379",
    "end": "134980"
  },
  {
    "text": "run in in managed ephemeral containers on as a function as as a service it's a",
    "start": "134980",
    "end": "140710"
  },
  {
    "text": "lot of words and I can keep reading on that but you know if I've already explained this with a simple diagram right if akley have in most of these",
    "start": "140710",
    "end": "148590"
  },
  {
    "text": "architectures you have like a single page application so you got your HTML and your JavaScript and everything else and they end up calling an API and this",
    "start": "148590",
    "end": "157680"
  },
  {
    "text": "API is basically in runs in a as a function in a civilus fashion that's",
    "start": "157680",
    "end": "165390"
  },
  {
    "text": "your function as a service and these functions are service end up calling some kind of a back-end services or back",
    "start": "165390",
    "end": "171180"
  },
  {
    "text": "into the service this is where you may have some kind of a no sequel database or even even a sequel database but",
    "start": "171180",
    "end": "178769"
  },
  {
    "text": "pretty much the you know these days people are more leveraging towards no sequel database to represent the data in",
    "start": "178769",
    "end": "184950"
  },
  {
    "text": "this case and that's what it is it's a very very simple simple architecture and",
    "start": "184950",
    "end": "190170"
  },
  {
    "text": "when one thing said if you see look at this very simple architecture aspire plication definitely running on your",
    "start": "190170",
    "end": "195599"
  },
  {
    "text": "browser is not running on a server so you don't need a server for spy application the sparkling scene can I",
    "start": "195599",
    "end": "200730"
  },
  {
    "text": "mean we're going to show you a very simple one one javascript file sim it can be an angular application or as we",
    "start": "200730",
    "end": "206280"
  },
  {
    "text": "saw in in DC today the new thing that is coming out is blazer webassembly the client deployment model which is also single page application you don't need a",
    "start": "206280",
    "end": "212819"
  },
  {
    "text": "server to run that our client which is are quite powerful the browser's are quite powerful now they got very good",
    "start": "212819",
    "end": "217919"
  },
  {
    "text": "JavaScript engine that can run the application right on on the desktop for actual functions there also suffer less",
    "start": "217919",
    "end": "224010"
  },
  {
    "text": "the scale on demand very very cost effective you pay power consumption per call and back in the service again like",
    "start": "224010",
    "end": "230549"
  },
  {
    "text": "things like tables table storage in in Azure is simply a very good solution",
    "start": "230549",
    "end": "235859"
  },
  {
    "text": "like Troy hand runs a billion queries from a table storage and if you even it",
    "start": "235859",
    "end": "241470"
  },
  {
    "text": "with other vendor you got like Google firebase or Amazon DynamoDB they all fit into that category called",
    "start": "241470",
    "end": "246540"
  },
  {
    "text": "back-end as a service if you want to be a little bit more fancier a proper database you can use cosmos DB which",
    "start": "246540",
    "end": "251639"
  },
  {
    "text": "which is a pretty much a back-end a service as well yeah absolutely and one of the key things aren't we keep talking about server less and servers and so on there",
    "start": "251639",
    "end": "258269"
  },
  {
    "text": "are a couple of key things that I want to mention about it one is the fact that when you're talking about service it doesn't mean it's not right you got no",
    "start": "258269",
    "end": "264120"
  },
  {
    "text": "service right I mean obviously the cloud providers are cloud vendors are running in a server but that is completely",
    "start": "264120",
    "end": "271440"
  },
  {
    "text": "abstracted away from you and that's one of the key takeaways of this run right that it means that you know how to manage the service these are managed by",
    "start": "271440",
    "end": "277860"
  },
  {
    "text": "the cloud vendor they take care of things like scaling is basically it's based on consumption you make as many",
    "start": "277860",
    "end": "283530"
  },
  {
    "text": "calls as you want and just pay for what you use you don't have to worry about things like patching these servers and so on",
    "start": "283530",
    "end": "288870"
  },
  {
    "text": "and so forth but like a call out earlier you still need to manage the security and it's gonna be a key part of it and I",
    "start": "288870",
    "end": "296219"
  },
  {
    "text": "like this particular diagram that Amazon have put out right they talk about the shared responsibility model and what",
    "start": "296219",
    "end": "302370"
  },
  {
    "text": "they say is that cloud vendors like Amazon and Google and so on they're responsible for the security of the",
    "start": "302370",
    "end": "308520"
  },
  {
    "text": "cloud whereas you and they call it customer customers ethically all of us who are deploying applications in the",
    "start": "308520",
    "end": "314909"
  },
  {
    "text": "cloud we are responsible for the security in the cloud so if you think about it the customers data is your",
    "start": "314909",
    "end": "322020"
  },
  {
    "text": "responsibility how you authenticate the user is your responsibility how you",
    "start": "322020",
    "end": "327960"
  },
  {
    "text": "actually secure the data is the security of the the securing the data while it's in rest and transit encrypting it all of",
    "start": "327960",
    "end": "334949"
  },
  {
    "text": "these things are response your responsibility the the cloud vendor on the other hand takes care of everything",
    "start": "334949",
    "end": "340919"
  },
  {
    "text": "else you know the security of the infrastructure is their responsibility in the case of things like like function",
    "start": "340919",
    "end": "347580"
  },
  {
    "text": "as a service you know the the the operating system or the containers that actually actually run these functions",
    "start": "347580",
    "end": "353430"
  },
  {
    "text": "are also they're responsible teams they need to pass these things they will actually do it for you so you know in a",
    "start": "353430",
    "end": "360810"
  },
  {
    "text": "way it is a shared responsibility right but again when you think about it when",
    "start": "360810",
    "end": "366330"
  },
  {
    "text": "something actually goes wrong in whether you're running if you're running it in in Amazon or Azure and things like that",
    "start": "366330",
    "end": "373020"
  },
  {
    "text": "if something goes wrong from a security point of view you are the one who's going to be responsible for it so you",
    "start": "373020",
    "end": "378659"
  },
  {
    "text": "got to make sure that from an application perspective there are the things that you need to worry about you know if there is cross-site scripting",
    "start": "378659",
    "end": "384449"
  },
  {
    "text": "attack or sequel injection attack and things like that there's those are things that you still need to do take care of I mean often times we are",
    "start": "384449",
    "end": "391229"
  },
  {
    "text": "delivering in agile mode we're doing Sprint's are pushing the code out for our business functionality the business",
    "start": "391229",
    "end": "396539"
  },
  {
    "text": "values and sometimes security can take a sort of it can fall on the website or not very you know focusing on that one",
    "start": "396539",
    "end": "403020"
  },
  {
    "text": "what's actually very important because because even with Australian laws you are responsible for your customer",
    "start": "403020",
    "end": "408759"
  },
  {
    "text": "that are your enterprises data even if you outsource some of the responsibility cloud but the hen responsibilities with",
    "start": "408759",
    "end": "414249"
  },
  {
    "text": "you so you really need to think about security when you are doing your application there are some tips that my",
    "start": "414249",
    "end": "420009"
  },
  {
    "text": "shall go through on how it can help you so if you look at a real quick security",
    "start": "420009",
    "end": "425529"
  },
  {
    "text": "101 there are there are three things that we actually talk about in terms of security we talk about the CIA triad confidentiality integrity and",
    "start": "425529",
    "end": "431949"
  },
  {
    "text": "availability right confidentiality is the thing where if you put your your",
    "start": "431949",
    "end": "437469"
  },
  {
    "text": "data up in the cloud you're you're quite you know the that the data is it's not",
    "start": "437469",
    "end": "444099"
  },
  {
    "text": "being accessed by someone who's not supposed to access it right number one the second thing is about the integrity",
    "start": "444099",
    "end": "449559"
  },
  {
    "text": "of the data that the data that you put in isn't being modified by someone who's",
    "start": "449559",
    "end": "454719"
  },
  {
    "text": "not supposed to be modifying it the third one is availability of the data is whenever you need the data the",
    "start": "454719",
    "end": "460029"
  },
  {
    "text": "information it's actually available for you to use now those are the three things that we actually focus on in security itself right and so if you look",
    "start": "460029",
    "end": "466089"
  },
  {
    "text": "at app security practices itself you know if I want to when I talk about security 101 I'm giving this in let's",
    "start": "466089",
    "end": "471939"
  },
  {
    "text": "say less than a couple of minutes right there are certain things that you want to do is like the first time is like every application is different so you",
    "start": "471939",
    "end": "477939"
  },
  {
    "text": "know most applications you know we want to start doing a some kind of a trick model for the application itself we",
    "start": "477939",
    "end": "484870"
  },
  {
    "text": "focus on things like stride to do kind of like determine where what kind of",
    "start": "484870",
    "end": "491349"
  },
  {
    "text": "threats your application will be facing straight actually stands for spoofing identity tampering data repudiation",
    "start": "491349",
    "end": "497520"
  },
  {
    "text": "information disclosure and elevation of religious so you look at your application itself and then figure out a",
    "start": "497520",
    "end": "503499"
  },
  {
    "text": "you know what kind of threats your application has once you identify these things you know there are several Tetzel",
    "start": "503499",
    "end": "509740"
  },
  {
    "text": "actually your application can have and was for instance publishes like the top ten threats that are available and you",
    "start": "509740",
    "end": "515500"
  },
  {
    "text": "look at it every every time to actually release it you'll have some some things that keep appearing over and over again",
    "start": "515500",
    "end": "520959"
  },
  {
    "text": "things like sequel injection or cry site cross-site scripting and so on so it's",
    "start": "520959",
    "end": "526029"
  },
  {
    "text": "up to you to actually fix these things and also also publish a whole bunch of guidance if you go look at the wasp ASVs",
    "start": "526029",
    "end": "532149"
  },
  {
    "text": "there's a whole bunch of guidance on what you can actually do from an implication perspective to make sure",
    "start": "532149",
    "end": "537160"
  },
  {
    "text": "these threats are actually handled in a good way you also need to make sure that you",
    "start": "537160",
    "end": "543199"
  },
  {
    "text": "follow good engineering practices in terms of security itself and once you actually done all of these things you",
    "start": "543199",
    "end": "550790"
  },
  {
    "text": "know larger player enterprises will start to do things like vulnerability testing and you can also run your code",
    "start": "550790",
    "end": "557990"
  },
  {
    "text": "through a as part of the build pipeline run through some tools that can actually do some static and dynamic checking and",
    "start": "557990",
    "end": "564199"
  },
  {
    "text": "that can that can find vulnerabilities in your in your code as well now the things that I'm actually talking about",
    "start": "564199",
    "end": "569750"
  },
  {
    "text": "is affecting like the basic hygiene in terms of security itself so the you're not gonna you know in this talk talk",
    "start": "569750",
    "end": "576470"
  },
  {
    "text": "about things like how do you do you know how do you prevent your application from sequel injection and cross-site",
    "start": "576470",
    "end": "581540"
  },
  {
    "text": "scripting and things like that but you're going to talk at an overall level on how you secure your application",
    "start": "581540",
    "end": "587439"
  },
  {
    "text": "server this application as a whole so let's start looking at a typical server",
    "start": "587439",
    "end": "593689"
  },
  {
    "text": "let's application the Weaver actually you have we've got a very simple servers",
    "start": "593689",
    "end": "599120"
  },
  {
    "text": "application architecture right and we've got a to-do application example so that",
    "start": "599120",
    "end": "606050"
  },
  {
    "text": "is built as a single page app it's got about maybe about four four files or",
    "start": "606050",
    "end": "611060"
  },
  {
    "text": "five files yeah actually two files HTML right so what we've done is we're",
    "start": "611060",
    "end": "617899"
  },
  {
    "text": "deploying it into blob storage and we use static hosting that that's available in blob storage so you think about it's",
    "start": "617899",
    "end": "624800"
  },
  {
    "text": "a very simple application you look at spa applications these days all the containers HTML you've got CSS you've",
    "start": "624800",
    "end": "631100"
  },
  {
    "text": "got some bunch of JavaScript or some images that go along with it right that's all it has and you really don't need the processing power of a web",
    "start": "631100",
    "end": "638110"
  },
  {
    "text": "server to actually host these things there's just basically static files so",
    "start": "638110",
    "end": "643759"
  },
  {
    "text": "we check all of these things into blob storage and we basically you know expose it to the web in enterprise if you",
    "start": "643759",
    "end": "650779"
  },
  {
    "text": "really want to do you can actually put a CDN on top of that one absolutely but for our case we're going to do the",
    "start": "650779",
    "end": "655850"
  },
  {
    "text": "blahblah CDN doesn't affect the security of it but you might use a CDN as your a CDN the third party zillions yeah you",
    "start": "655850",
    "end": "660889"
  },
  {
    "text": "can do that yeah and you look at and then we have an API that actually runs",
    "start": "660889",
    "end": "666290"
  },
  {
    "text": "right this API is a simple as your function and and this function calls a back-end",
    "start": "666290",
    "end": "675060"
  },
  {
    "text": "the back end is officially in our case table storage again and we kept it really simple now what we will do is",
    "start": "675060",
    "end": "681560"
  },
  {
    "text": "this application when we start with it's not completely secure so as we go along this talk will make it more and more",
    "start": "681560",
    "end": "688170"
  },
  {
    "text": "secure and kind of like step by step we'll show you how to actually fix it fix the security of the application so I think you want to dig in and show the",
    "start": "688170",
    "end": "694830"
  },
  {
    "text": "demo so there are three things we want to show in the demo so first thing is we're going to show the configuration of the spy itself in blob storage and how",
    "start": "694830",
    "end": "700770"
  },
  {
    "text": "we've actually configured it we're going to show you how we are calling the API from from single page app and finally",
    "start": "700770",
    "end": "708390"
  },
  {
    "text": "how there's your function is configured to talk to the backend so we're gonna cover those three things one thing is",
    "start": "708390",
    "end": "714480"
  },
  {
    "text": "that we have actually pre provisioned a lot of resources in Azure and I'm gonna show mostly click off to the portal or",
    "start": "714480",
    "end": "720480"
  },
  {
    "text": "run some as your CLI scripts in a proper Enterprise world you probably will do a",
    "start": "720480",
    "end": "726450"
  },
  {
    "text": "proper scripting or arm temp result something in your DevOps pipeline to do it you do not probably use it like that",
    "start": "726450",
    "end": "731970"
  },
  {
    "text": "the security concepts are what we actually show you need here so the first thing that was there was this by",
    "start": "731970",
    "end": "738450"
  },
  {
    "text": "application and a function now so this is a very simple function is called to",
    "start": "738450",
    "end": "745440"
  },
  {
    "text": "do API and the function is HTTP triggered function it gets texted to be",
    "start": "745440",
    "end": "750750"
  },
  {
    "text": "request and it's connected its bind bind it there's a table binding with a as your table storage with the connection",
    "start": "750750",
    "end": "756480"
  },
  {
    "text": "string so that's that's our function I'm pretty much sure you have all done a function like that and it's got some",
    "start": "756480",
    "end": "761850"
  },
  {
    "text": "method like get to do get to do by ID delete to do things like that so this function has been deployed to as your",
    "start": "761850",
    "end": "769260"
  },
  {
    "text": "function which I'm going to show it now so I've deployed that function call it",
    "start": "769260",
    "end": "775530"
  },
  {
    "text": "to Roo API it's got a few ApS in the function up as you can see the other",
    "start": "775530",
    "end": "781170"
  },
  {
    "text": "thing that I have deployed is a single page application let's go to that one so single page application is a so this",
    "start": "781170",
    "end": "788190"
  },
  {
    "text": "is a really simple HTML application all it does is call that API using jQuery AJAX you can use like angular and there",
    "start": "788190",
    "end": "796410"
  },
  {
    "text": "are some libraries and that that that is available angular to do that one but we start kept with simple jQuery",
    "start": "796410",
    "end": "803740"
  },
  {
    "text": "and so it is configured to call that function is the function URL and",
    "start": "803740",
    "end": "808770"
  },
  {
    "text": "functions has a very rudimentary level of authentication called function key if I go to a function function code you can",
    "start": "808770",
    "end": "817660"
  },
  {
    "text": "see that there is a operation level dot function all it means is that a function key went in here of a static key that",
    "start": "817660",
    "end": "823090"
  },
  {
    "text": "needs to be passed to the function before the function will allow the call to proceed now think about it in a",
    "start": "823090",
    "end": "829480"
  },
  {
    "text": "single page application the the function key is actually a JavaScript code so",
    "start": "829480",
    "end": "834640"
  },
  {
    "text": "this doesn't provide us any security we have put that one here just to show that what is available is not good enough you",
    "start": "834640",
    "end": "840580"
  },
  {
    "text": "pass the function key either you can pass it is a query parameter called code like question mark or equal to that key",
    "start": "840580",
    "end": "847300"
  },
  {
    "text": "or a little bit more security because sometimes query parameters are part of the URL they can get logged and things like that it's a little bit better if",
    "start": "847300",
    "end": "853690"
  },
  {
    "text": "you pass it through a header called X function ski so that's what is there here only as your as your portal so I",
    "start": "853690",
    "end": "863260"
  },
  {
    "text": "have a storage account called NBC to do spa in a storage account if you create a V to storage account so this has to be a",
    "start": "863260",
    "end": "870580"
  },
  {
    "text": "V to storage I mean everybody should create a V to storage now on the v2 storage account is called a new feature",
    "start": "870580",
    "end": "876160"
  },
  {
    "text": "or is there for quite some time now cost static website if you enable that feature so that's been enabled what it",
    "start": "876160",
    "end": "882700"
  },
  {
    "text": "does is that it creates a special container in the blob called dollar web so if you put any files in there those",
    "start": "882700",
    "end": "888310"
  },
  {
    "text": "files get served in a serval des fashion there's no need to have any server in there so it creates a endpoint for you",
    "start": "888310",
    "end": "895090"
  },
  {
    "text": "now this endpoint is obviously like something dot code what windows not net as a storage endpoint if you want your",
    "start": "895090",
    "end": "901450"
  },
  {
    "text": "own custom domain you have to use a as your CDN to do that one because this comes with the the standard domain",
    "start": "901450",
    "end": "907960"
  },
  {
    "text": "that's available azure and you can what is the index index document so our case index dot HTML and you need to provide a",
    "start": "907960",
    "end": "913840"
  },
  {
    "text": "error documents of 404 HTML so what i've done is that in d in the app so there's",
    "start": "913840",
    "end": "920020"
  },
  {
    "text": "this for files 404 - tml Abdur CSS actually got nothing it's empty file AB dot J's index dot HTML and I've uploaded",
    "start": "920020",
    "end": "926350"
  },
  {
    "text": "it to the Dollar web container many ways that I can I could have done it but I just use the azure storage Explorer tool",
    "start": "926350",
    "end": "931990"
  },
  {
    "text": "in this case so in this container in the dollar web container of this story",
    "start": "931990",
    "end": "937780"
  },
  {
    "text": "I have uploaded this for files so that's my spa that is hosted in a survivalist fashion the function has already been",
    "start": "937780",
    "end": "944980"
  },
  {
    "text": "deployed as well so let's go to the function in the portal if the function",
    "start": "944980",
    "end": "952480"
  },
  {
    "text": "has been deployed now we all know a couple of things one for a browser to",
    "start": "952480",
    "end": "957610"
  },
  {
    "text": "call a javascript in a different domain the they appear that you are calling on the URL that you are calling needs to",
    "start": "957610",
    "end": "963940"
  },
  {
    "text": "whitelist the origin that's called course so we have to first define a",
    "start": "963940",
    "end": "969280"
  },
  {
    "text": "course rule to allow that single page application URL we have so that it so",
    "start": "969280",
    "end": "974560"
  },
  {
    "text": "that can it so they pick and actually be called from the browser with the browser will ask what is the course policy for",
    "start": "974560",
    "end": "979720"
  },
  {
    "text": "this URL so first thing you configure that one so that's the course policy cross-origin resource sharing so once",
    "start": "979720",
    "end": "984970"
  },
  {
    "text": "that's configured the other thing that I want to show you how we are connecting to the to the backend which is the table",
    "start": "984970",
    "end": "990310"
  },
  {
    "text": "stretch is really easy so there is a connection string there is a configuration environment variable",
    "start": "990310",
    "end": "997870"
  },
  {
    "text": "really called to do table storage and what I have got is the connection string including the primary account key to",
    "start": "997870",
    "end": "1003540"
  },
  {
    "text": "that table storage so that's configured as a config variable or environment variable but that's how this thing is",
    "start": "1003540",
    "end": "1009510"
  },
  {
    "text": "working very simple so let's actually try this try this one so one way that we",
    "start": "1009510",
    "end": "1015330"
  },
  {
    "text": "can try it is using a tool so I'll be using a couple of tools here so just",
    "start": "1015330",
    "end": "1020820"
  },
  {
    "text": "like very quick detour so I'm using Visual Studio code for the entire demo we just to do code has the extension",
    "start": "1020820",
    "end": "1027270"
  },
  {
    "text": "called rest command think of it as a very simple postman postman is very full feature but for just calling get poor",
    "start": "1027270",
    "end": "1033870"
  },
  {
    "text": "delete you can just use this extension right within Visual Studio I'll close that one is called rest client the other",
    "start": "1033870",
    "end": "1039750"
  },
  {
    "text": "ones that I'll be calling as your CLI and there's the extension for as your CLI where you it understands the azure",
    "start": "1039750",
    "end": "1045870"
  },
  {
    "text": "CLI commands and you can directly execute it from visual studio code so these are two sort of extension that I am using so I've got this this test",
    "start": "1045870",
    "end": "1054480"
  },
  {
    "text": "client so as you can see I'm pointing so the DS are like variables in this test tool so the URL is the actual permission",
    "start": "1054480",
    "end": "1060180"
  },
  {
    "text": "URL so I'm just calling this Ivar L with the function ski I already got some data in the to do table storage so if you see",
    "start": "1060180",
    "end": "1066930"
  },
  {
    "text": "the storage Explorer so there are some simple to-do items in here the got a primary key to access that so that's already been",
    "start": "1066930",
    "end": "1072850"
  },
  {
    "text": "configured and I kept them in notepad because I'm going to use them to tests test this thing so let's just test this",
    "start": "1072850",
    "end": "1080440"
  },
  {
    "text": "app so there's a warm-up happening",
    "start": "1080440",
    "end": "1094200"
  },
  {
    "text": "inclu user fashion just give it a couple of times yeah well first time you call the function it's got a cold startup",
    "start": "1098179",
    "end": "1103759"
  },
  {
    "text": "time so that's that's what happened but we got the result back and so that's that's about it so that's our first cut",
    "start": "1103759",
    "end": "1109970"
  },
  {
    "text": "of the function so at this point we can see that this pie is calling that one but this is really nothing nothing",
    "start": "1109970",
    "end": "1117169"
  },
  {
    "text": "securing that API D if you look at the sources which any competent developer or",
    "start": "1117169",
    "end": "1122480"
  },
  {
    "text": "hacker would look at it they can see what's the function key so that doesn't give any security and if I sorry if I",
    "start": "1122480",
    "end": "1128840"
  },
  {
    "text": "use a tool the tool should work as well so if I just call this one so two two",
    "start": "1128840",
    "end": "1137090"
  },
  {
    "text": "guess it at all so this now so this function is kind of working this app is working but obviously there are some issues with this yet so what are the",
    "start": "1137090",
    "end": "1143240"
  },
  {
    "text": "main issues here particularly summarize that again and the main issue is that this API is actually open to the world there's absolutely nothing guarding it",
    "start": "1143240",
    "end": "1149779"
  },
  {
    "text": "you don't know who is calling this API there's like anonymous access open to the whole world so so it's like",
    "start": "1149779",
    "end": "1156860"
  },
  {
    "text": "completely insecure at this point yeah to the slides the course policy only",
    "start": "1156860",
    "end": "1170600"
  },
  {
    "text": "secures the API getting called from your spy application but you can call an API using curl using postman using this tool",
    "start": "1170600",
    "end": "1177559"
  },
  {
    "text": "so that doesn't provide any security yeah you cannot create another sort of where we aspire plication to call that",
    "start": "1177559",
    "end": "1183919"
  },
  {
    "text": "API that's true but that doesn't mean that API is secure by itself so the course policy doesn't",
    "start": "1183919",
    "end": "1189590"
  },
  {
    "text": "guard what do you think yeah so the the the way to actually start securing the application the first thing is you want",
    "start": "1189590",
    "end": "1196159"
  },
  {
    "text": "to make sure you introduce some kind of authentication it's only an authenticated client can actually call",
    "start": "1196159",
    "end": "1201710"
  },
  {
    "text": "it right so let's let's go and talk a little bit about OAuth itself because that's that's what we're going to be",
    "start": "1201710",
    "end": "1207200"
  },
  {
    "text": "using do to secure the application in terms of authentication so so we all know that OAuth in this case obviously",
    "start": "1207200",
    "end": "1212539"
  },
  {
    "text": "or 2.0 it's the modern modern identity authentication authorization protocol that is used in web applications mobile",
    "start": "1212539",
    "end": "1219769"
  },
  {
    "text": "applications really so though what is basically a way where a client gets a",
    "start": "1219769",
    "end": "1229129"
  },
  {
    "text": "token from an authorization server that's we're a token which means a token contest all the claims that you need to",
    "start": "1229129",
    "end": "1235550"
  },
  {
    "text": "present to a resource server to get access to a resource so client gets this",
    "start": "1235550",
    "end": "1241070"
  },
  {
    "text": "token from authorization server so this is abstract term as per the RFC we'll see what this actually is in fact if you",
    "start": "1241070",
    "end": "1246440"
  },
  {
    "text": "look at the diagram the simplified owed diagram you can actually understand yeah so this shows that the client in this",
    "start": "1246440",
    "end": "1251960"
  },
  {
    "text": "case the spy operation is the client that's running in a browser it requests a token from an authorization server",
    "start": "1251960",
    "end": "1257030"
  },
  {
    "text": "we'll be using as you're ready in our example but this could be odd 0 octa any other entity provider once it gets the",
    "start": "1257030",
    "end": "1264440"
  },
  {
    "text": "token in goes the resource server resource server in this case is the API to gain access to a resource and",
    "start": "1264440",
    "end": "1270170"
  },
  {
    "text": "resource in our cases to do items that's our resource and obviously there is a person who's that with the wisdom zone",
    "start": "1270170",
    "end": "1277070"
  },
  {
    "text": "doing these things yeah so in this case what the resource server will actually do is it'll it'll",
    "start": "1277070",
    "end": "1282680"
  },
  {
    "text": "validate they talk and we'll look for it and make sure that the token is a valid one if it's a valid one it'll go grab the resource and then return it back",
    "start": "1282680",
    "end": "1288770"
  },
  {
    "text": "right and we have various or what flows as well that we that we actually use",
    "start": "1288770",
    "end": "1296840"
  },
  {
    "text": "based on circumstances self so the four most important ones is the authorization code flow this is a three-legged flow",
    "start": "1296840",
    "end": "1302870"
  },
  {
    "text": "where the client goes to the authorization server and gets a code and",
    "start": "1302870",
    "end": "1308780"
  },
  {
    "text": "any sense to the to web some sort of a back back-end application so think of a MVC application where the controller can",
    "start": "1308780",
    "end": "1314480"
  },
  {
    "text": "be that back-end and that again goes back to the or Thresher server the core and exchanges heat for a token so in that case a token",
    "start": "1314480",
    "end": "1320810"
  },
  {
    "text": "is not flowing between to the internet between the this publication or a JavaScript application or anything on",
    "start": "1320810",
    "end": "1326600"
  },
  {
    "text": "the publicly facing so that's a bit more secure but obviously you can't use it in a spa because this part doesn't have a",
    "start": "1326600",
    "end": "1331850"
  },
  {
    "text": "back-end everything is running in the browser the resource owner pass or credential is for legacy apps and work",
    "start": "1331850",
    "end": "1337370"
  },
  {
    "text": "very trusted application like your intern like desktop as running in an intranet where the client itself takes",
    "start": "1337370",
    "end": "1343940"
  },
  {
    "text": "the text the the credentials the username password and sends it to the authorization server it's not really",
    "start": "1343940",
    "end": "1350450"
  },
  {
    "text": "used and client financials is really for like service to service a machine to",
    "start": "1350450",
    "end": "1355580"
  },
  {
    "text": "machine communication very there is a static username password used to to get",
    "start": "1355580",
    "end": "1360950"
  },
  {
    "text": "a token what's in point is the implicit grant flow for spa application it's called implicit grand floor because",
    "start": "1360950",
    "end": "1366919"
  },
  {
    "text": "what happens is there's a diagram from the RFC six four seven nine which describes all very very simple there are",
    "start": "1366919",
    "end": "1374809"
  },
  {
    "text": "few few actors in there the resource owner is myself for the end user the user agent is the browser the client is",
    "start": "1374809",
    "end": "1380539"
  },
  {
    "text": "the spa application authorization server is Azure Active Directory and the the resource resource server is the Azure",
    "start": "1380539",
    "end": "1387679"
  },
  {
    "text": "function so all we do is that the client sort of directs to the authorization",
    "start": "1387679",
    "end": "1393440"
  },
  {
    "text": "server where the author server so hey I don't know you give your credentials you",
    "start": "1393440",
    "end": "1398539"
  },
  {
    "text": "can use username password or MFA or any other thing to pull your credential and you're asking access to a particular",
    "start": "1398539",
    "end": "1405070"
  },
  {
    "text": "resource or API at that point so the author server will ask the resource",
    "start": "1405070",
    "end": "1410330"
  },
  {
    "text": "owner like the end user head you grant this app constant permissions do grant consent to the permission that",
    "start": "1410330",
    "end": "1416629"
  },
  {
    "text": "this app is asking that might be asking like I want to read to do delete to do whatever so you grant the permission it",
    "start": "1416629",
    "end": "1422989"
  },
  {
    "text": "redirects you back to the browser and at that point you have obtained the token now that token is stored in session",
    "start": "1422989",
    "end": "1428899"
  },
  {
    "text": "storage or local storage in the browser and then when you use the JavaScript to call the API that token is attached to",
    "start": "1428899",
    "end": "1434779"
  },
  {
    "text": "the authorization header as a bearer token when we call the API and that's how the API receives the token and the",
    "start": "1434779",
    "end": "1440599"
  },
  {
    "text": "token in this case is a JWT or called jot which is a JSON web token so it's a token that is a basically a JSON but",
    "start": "1440599",
    "end": "1447499"
  },
  {
    "text": "it's best 64 encoded into three parts which we can show an example of a real job that we get from as you ready so so",
    "start": "1447499",
    "end": "1454039"
  },
  {
    "text": "this way when the client goes to the API we know that the the resource on or the",
    "start": "1454039",
    "end": "1459679"
  },
  {
    "text": "end user is authenticated yeah so let's do a demo of this it's also the",
    "start": "1459679",
    "end": "1464749"
  },
  {
    "text": "things that we're gonna show in the demo is will will add authentication using Azure ad and then we also need to",
    "start": "1464749",
    "end": "1471529"
  },
  {
    "text": "register client application on us already so that we and then we'll have",
    "start": "1471529",
    "end": "1477440"
  },
  {
    "text": "to make some changes in the spa application so now we'd start it starts to use the token that it's gotten from",
    "start": "1477440",
    "end": "1483019"
  },
  {
    "text": "the authorization server and we also want to on the azure function and so",
    "start": "1483019",
    "end": "1490099"
  },
  {
    "text": "there are a couple of things that we want to do we want to make sure that we get the token that's that's passed across to us and then we validate it to",
    "start": "1490099",
    "end": "1497239"
  },
  {
    "text": "make sure that it's a valid token and then we'll go and grab the resource and then we'll send it back and asking like you said you know we'll also",
    "start": "1497239",
    "end": "1503060"
  },
  {
    "text": "quickly show the jar token it's yeah okay thank you it's a couple of things",
    "start": "1503060",
    "end": "1519110"
  },
  {
    "text": "here the first thing we need to do is add the two applications involved one is the spy application the other is the",
    "start": "1519110",
    "end": "1525200"
  },
  {
    "text": "function so they need to be registered as applications in a G already so as you",
    "start": "1525200",
    "end": "1530540"
  },
  {
    "text": "hear is a concept of registration now I have already done this one but I'll show how you can do it for a function app the",
    "start": "1530540",
    "end": "1537200"
  },
  {
    "text": "easiest way that that you can do it is actually built into the portal so let's",
    "start": "1537200",
    "end": "1542240"
  },
  {
    "text": "go back so if you see this one authentication authorization there's a",
    "start": "1542240",
    "end": "1550250"
  },
  {
    "text": "thing called app service authentication we can turn it on and then choose Azure ad as our ization authentication",
    "start": "1550250",
    "end": "1556220"
  },
  {
    "text": "provider and when you go to this first time the Express thing will be sort of",
    "start": "1556220",
    "end": "1561440"
  },
  {
    "text": "highlighted so just choose this one and we just say okay so this will register this function as application energy",
    "start": "1561440",
    "end": "1569180"
  },
  {
    "text": "already and if you can see it we'll get a client ID from the actuary so this identifies this is a unique ID for the",
    "start": "1569180",
    "end": "1576110"
  },
  {
    "text": "client which is in this case is our spy application the issuer is the you know NIST authorization server which is a",
    "start": "1576110",
    "end": "1582770"
  },
  {
    "text": "this is my tenant ID naturally so this kind of says that it will be in a token so anyway they talk and you know that a",
    "start": "1582770",
    "end": "1588140"
  },
  {
    "text": "token is coming from your a GRE it's not coming from somewhere else so that's the things that you can check that not",
    "start": "1588140",
    "end": "1594170"
  },
  {
    "text": "somebody's got a token from somewhere else and just playing it back so that's what they're now client secret is not",
    "start": "1594170",
    "end": "1599270"
  },
  {
    "text": "useful in spy up so you know you know that one so and the other thing is that it also says what are the allowed token",
    "start": "1599270",
    "end": "1605180"
  },
  {
    "text": "audiences there who can get these tokens kind of thing so so that's once that is set up there's a different view that you",
    "start": "1605180",
    "end": "1611300"
  },
  {
    "text": "can see in the azure ad as well so going to Asia already go to a Paris tration",
    "start": "1611300",
    "end": "1617799"
  },
  {
    "text": "and we can see that the NBC to do API so that's registered here it will be the same client ID that we saw in that",
    "start": "1620480",
    "end": "1625730"
  },
  {
    "text": "portal in the function portal so that's so that's there the other thing is that when when there's a concept that when",
    "start": "1625730",
    "end": "1633020"
  },
  {
    "text": "you expose an API you need to give it some scopes or scopes is like the permissions that you want that client",
    "start": "1633020",
    "end": "1639740"
  },
  {
    "text": "app to be granted by the user so by default when you do it to the function",
    "start": "1639740",
    "end": "1645230"
  },
  {
    "text": "portal it creates excope called user impersonation but that's just a default you can create different scopes I'll",
    "start": "1645230",
    "end": "1650420"
  },
  {
    "text": "show an example so so you can you can add a scope and a scopes are like a very",
    "start": "1650420",
    "end": "1656210"
  },
  {
    "text": "common convention is a resource door action so you can say if your resource to do because the to do not read to do not write or delete or you can do",
    "start": "1656210",
    "end": "1663320"
  },
  {
    "text": "something a tool or user tool or admin depends on your naming convention it's just a name a scope and you can see who",
    "start": "1663320",
    "end": "1668960"
  },
  {
    "text": "can consent some is some very high value scope like D register a user you might say only admins can concept so they will",
    "start": "1668960",
    "end": "1674900"
  },
  {
    "text": "have to be admitting that you're a tributary or you can choose admins and users both can consent give it a name",
    "start": "1674900",
    "end": "1680090"
  },
  {
    "text": "give it a description same for the user give it a name description enable it and then add the scope so I've already got a few scopes",
    "start": "1680090",
    "end": "1686690"
  },
  {
    "text": "in there but I've got the to do not read and write disabled but this is how I just created to do not reach the can create some scopes in there the user",
    "start": "1686690",
    "end": "1693920"
  },
  {
    "text": "impersonation scope comes by default when you do it to the portal so that's just a name that's all or it means that",
    "start": "1693920",
    "end": "1700190"
  },
  {
    "text": "I've got a the client has got access to the API with this scope Kursaal it means so that's already done the other thing",
    "start": "1700190",
    "end": "1707420"
  },
  {
    "text": "we have to do it register this by application now there's no sort of a inbuilt way to do that one but what we can do is that you can just click this",
    "start": "1707420",
    "end": "1713450"
  },
  {
    "text": "new registration button for a forest fire application we can give it a name and we can say register but I've already",
    "start": "1713450",
    "end": "1723200"
  },
  {
    "text": "done that one I'll just show it so because this by application there are a few things that we need to be aware of",
    "start": "1723200",
    "end": "1728770"
  },
  {
    "text": "one once a racist by application it gets his own client ID as well so this identifies the client the other one",
    "start": "1728770",
    "end": "1735260"
  },
  {
    "text": "identifies the API these are NT fires the client B in the API permission you",
    "start": "1735260",
    "end": "1744410"
  },
  {
    "text": "need to give a kata permission so you can say add a permission go there choose choose your API and you can see the",
    "start": "1744410",
    "end": "1750920"
  },
  {
    "text": "Scopes that at the in this case there was only one scope I've chosen that scope and so I need this client needs this particular",
    "start": "1750920",
    "end": "1756429"
  },
  {
    "text": "permission so that's there and the other thing is that in the authentication you",
    "start": "1756429",
    "end": "1762340"
  },
  {
    "text": "need to give it a redirect URL so in our case a redirect URL is where the Suad",
    "start": "1762340",
    "end": "1768159"
  },
  {
    "text": "will redirect it back once it's authenticated so that's the origin of this power app and you need to take I",
    "start": "1768159",
    "end": "1773320"
  },
  {
    "text": "need access token I need a ID token so that's all configured now so let's change the code and see so I've got the",
    "start": "1773320",
    "end": "1796240"
  },
  {
    "text": "same application what what I've done is that I put this code in here so I'm burning it in the access token that I",
    "start": "1796240",
    "end": "1802330"
  },
  {
    "text": "get in the request r/a my the token comes in the head and there's nothing special about it is just a string and it gives a terrorist code I change this",
    "start": "1802330",
    "end": "1808480"
  },
  {
    "text": "code and if it's wrong i send it i send a status code result which will be like 4 billion or something that it was ok",
    "start": "1808480",
    "end": "1815470"
  },
  {
    "text": "then the functional part of the function works now you can use dependency injection in functions now to do some of",
    "start": "1815470",
    "end": "1820960"
  },
  {
    "text": "this thing little bit more centralized fashion but i've shown a very imperative way how can do this one and so so",
    "start": "1820960",
    "end": "1828520"
  },
  {
    "text": "because we're doing it in improve the way we call it for each and every one of the functions right yeah yeah and the",
    "start": "1828520",
    "end": "1833830"
  },
  {
    "text": "validity access token what it does is that they extracts the token from the request header which is the request",
    "start": "1833830",
    "end": "1839890"
  },
  {
    "text": "header now it will validate some of the things like audience the issue and the",
    "start": "1839890",
    "end": "1845110"
  },
  {
    "text": "app ID I have configured that already in the function of configuration string so it gets it from the environment variable",
    "start": "1845110",
    "end": "1850899"
  },
  {
    "text": "those values that will be there in the job talking because I want to make sure that a job has got these values that the audience is correct the issuer is Chi",
    "start": "1850899",
    "end": "1857080"
  },
  {
    "text": "the app ID is correct as is expected there are some there's some SDKs for",
    "start": "1857080",
    "end": "1863020"
  },
  {
    "text": "token validation in dotnet which you can use and you can set the parameters to validate like I need the tokens to be",
    "start": "1863020",
    "end": "1868360"
  },
  {
    "text": "signed I need the token to a valid lifetime I need to have audience which is this particular value and it er issue is this",
    "start": "1868360",
    "end": "1875289"
  },
  {
    "text": "particular value and then what I can do is that I can send it to this jw2",
    "start": "1875289",
    "end": "1880870"
  },
  {
    "text": "security token handler and say validate this token with these parameters and outcomes a principal out of rita claims",
    "start": "1880870",
    "end": "1887110"
  },
  {
    "text": "principal and then you can check what claims that that token has we will expect a token token has things called claims and one",
    "start": "1887110",
    "end": "1893289"
  },
  {
    "text": "of the claims that I want to check is that he's got the right app ID in there and the right scope in the school so",
    "start": "1893289",
    "end": "1899799"
  },
  {
    "text": "I've already this thing if everything is good is okay otherwise is forbidden so that's that's how it's working so if you",
    "start": "1899799",
    "end": "1905110"
  },
  {
    "text": "see the some of the values that I'm using is that I want to check this particular scope for example the other",
    "start": "1905110",
    "end": "1911049"
  },
  {
    "text": "things are coming from the from the",
    "start": "1911049",
    "end": "1918309"
  },
  {
    "text": "configuration here so these were I have configured the the audience the issuer and things that app so the audience is",
    "start": "1918309",
    "end": "1925600"
  },
  {
    "text": "here so so it gets hit and so it's kind of coming from the configuration so you validate these things so let me not",
    "start": "1925600",
    "end": "1931600"
  },
  {
    "text": "deploy this function app",
    "start": "1931600",
    "end": "1935460"
  },
  {
    "text": "so I'm building the function zipping it up me carrying a package and I will",
    "start": "1965880",
    "end": "1976020"
  },
  {
    "text": "deploy it",
    "start": "1976020",
    "end": "1978350"
  },
  {
    "text": "so what is deploying let me go back and let it rip our first actually where is",
    "start": "1994450",
    "end": "2000790"
  },
  {
    "text": "deploying let's go back to the spy application now this fire plication obviously has no way to it hasn't got",
    "start": "2000790",
    "end": "2007300"
  },
  {
    "text": "anything any code in there to get an optimum token so Microsoft has a library called Adele Adele that's accurate or",
    "start": "2007300",
    "end": "2014590"
  },
  {
    "text": "authentication library for JavaScript we sort of abstracts away this protocol for you through a simple SDK and I'll be",
    "start": "2014590",
    "end": "2021670"
  },
  {
    "text": "using that to get a token so go to that one",
    "start": "2021670",
    "end": "2027720"
  },
  {
    "text": "so that'll tour Jas is now you can read from a CDN but I have just added it to my application and what it does it you",
    "start": "2029460",
    "end": "2036190"
  },
  {
    "text": "configure configure the idol wit okay what is my tenancy so this is that as",
    "start": "2036190",
    "end": "2041380"
  },
  {
    "text": "your tenancy ID we saw before the client ID is the application ID of the client which came from the portal if we",
    "start": "2041380",
    "end": "2046690"
  },
  {
    "text": "remember it is it is the thing it will",
    "start": "2046690",
    "end": "2054100"
  },
  {
    "text": "be this particular client ID so that's the client ID of the application and the",
    "start": "2054100",
    "end": "2062620"
  },
  {
    "text": "app ID is the client ID of the API and we sort of and the redirect URI is the the origin that for the window so we",
    "start": "2062620",
    "end": "2069158"
  },
  {
    "text": "configure these things and what we do is that we create an authentication context so we create authentication context with",
    "start": "2069159",
    "end": "2075550"
  },
  {
    "text": "that config and the context is ready once we click click so once we click the",
    "start": "2075550",
    "end": "2080970"
  },
  {
    "text": "let's go to that thing so so once we click the search button what it does it uses the authentication",
    "start": "2080970",
    "end": "2087220"
  },
  {
    "text": "contest and first check if there's a cash token bus tokens are valid where it was a very for certain amount of time store in a cash heater can return it",
    "start": "2087220",
    "end": "2093520"
  },
  {
    "text": "straight from the cache if it's not in the cache then it will basically acquire the token and if and if and depends on",
    "start": "2093520",
    "end": "2101680"
  },
  {
    "text": "whether these the permission is already there or not you can also be a pop-up to get deeper consent for these things for",
    "start": "2101680",
    "end": "2107020"
  },
  {
    "text": "the API so once it gets a token it gets a callback and in call the Search API",
    "start": "2107020",
    "end": "2112090"
  },
  {
    "text": "now with the token and all it does is that it adds the token to the authorization header as a bearer token",
    "start": "2112090",
    "end": "2117760"
  },
  {
    "text": "so we had the function ski and now here added the authorization header that's what will be in the spa so let's deploy does inspires well while",
    "start": "2117760",
    "end": "2124120"
  },
  {
    "text": "we are talking so I'm going to upload the new files",
    "start": "2124120",
    "end": "2129900"
  },
  {
    "text": "which the Abdur Jas the Adel DOJ's and",
    "start": "2129900",
    "end": "2141620"
  },
  {
    "text": "Industry HTML file only because I had to add reference to adult ojs that's why",
    "start": "2141620",
    "end": "2148940"
  },
  {
    "text": "okay so the neaten so the update uploaded the change files to static we're wasting again let's actually try",
    "start": "2154850",
    "end": "2161850"
  },
  {
    "text": "one thing which is to check if this thing still works or not so I'm going to",
    "start": "2161850",
    "end": "2167340"
  },
  {
    "text": "call this one so it's sort of spinning",
    "start": "2167340",
    "end": "2173880"
  },
  {
    "text": "here silly didn't work now is 401 unauthorized why because I'm not passing",
    "start": "2173880",
    "end": "2180300"
  },
  {
    "text": "it any token so the function is now rejecting this call that's what's",
    "start": "2180300",
    "end": "2185340"
  },
  {
    "text": "happening let's go to the actual app by that by now the function now should have deployed yep the function is now",
    "start": "2185340",
    "end": "2192780"
  },
  {
    "text": "deployed",
    "start": "2192780",
    "end": "2195110"
  },
  {
    "text": "copy this one open a private window",
    "start": "2204630",
    "end": "2212269"
  },
  {
    "text": "I'm going to open a debugger as well I",
    "start": "2216720",
    "end": "2221000"
  },
  {
    "text": "take example from yeah search this and",
    "start": "2223369",
    "end": "2230309"
  },
  {
    "text": "this will not work because I haven't logged in so there's no there's no sort of cotton so the authentication context has no logged in user mean you can",
    "start": "2230309",
    "end": "2236910"
  },
  {
    "text": "redirect it back to a login page but I'll just do it manually I'll log in you so now it has gone to as your ID so this",
    "start": "2236910",
    "end": "2243809"
  },
  {
    "text": "is ID with my tenancy you can say this is my tendency in here what we login",
    "start": "2243809",
    "end": "2250160"
  },
  {
    "text": "so okay now now have loved him let me such",
    "start": "2262100",
    "end": "2277740"
  },
  {
    "text": "fingers crossed should work hey it",
    "start": "2277740",
    "end": "2284530"
  },
  {
    "text": "worked so the way it worked is that I have got the so Adel has obtained a token for me",
    "start": "2284530",
    "end": "2289690"
  },
  {
    "text": "now in this case you didn't see the consent screen because I have already done it once and that's recorded only once but I'll show you a screenshot of",
    "start": "2289690",
    "end": "2295690"
  },
  {
    "text": "how it looks like maybe maybe we can actually take a inspected Java to the",
    "start": "2295690",
    "end": "2301840"
  },
  {
    "text": "shortest yeah yeah so when you do initially it will show you the scope now I added some scope which I now removed",
    "start": "2301840",
    "end": "2307210"
  },
  {
    "text": "it but at that time I had this code so it says that this AK would like to get these permissions which are the scopes",
    "start": "2307210",
    "end": "2312370"
  },
  {
    "text": "and then you set the exit yes I give permission to disturb this is recorded in Asia ad and that's why I didn't come",
    "start": "2312370",
    "end": "2318820"
  },
  {
    "text": "again if I delete it using PowerShell this will come back again and yeah as",
    "start": "2318820",
    "end": "2324070"
  },
  {
    "text": "mine said how does a token looks like now I have the token I've actually put right written the token to the console",
    "start": "2324070",
    "end": "2329890"
  },
  {
    "text": "so this is how a token looks like and you might already know this but they say better tool than JA dot IO called Jordan",
    "start": "2329890",
    "end": "2337120"
  },
  {
    "text": "MS from Microsoft a lot of people with dot IO I like this one way better",
    "start": "2337120",
    "end": "2343680"
  },
  {
    "text": "because this decodes it in croucher you're talking is not sent back to a server and it shows in a much better way",
    "start": "2343680",
    "end": "2348970"
  },
  {
    "text": "that the decoded token so here you will see I got the audience that is the API",
    "start": "2348970",
    "end": "2354190"
  },
  {
    "text": "that I am calling the client ID of the API I got issuer who has issued the talk and my tenancy and I've got a few other",
    "start": "2354190",
    "end": "2359740"
  },
  {
    "text": "things that the app ID this is the client ID of the app and I've got the scope which was the user impersonation",
    "start": "2359740",
    "end": "2365620"
  },
  {
    "text": "scopes I've got all these things this tool actually explains to you what each thing means as well if you don't know jot in and out details so that's very",
    "start": "2365620",
    "end": "2372190"
  },
  {
    "text": "good in there any question",
    "start": "2372190",
    "end": "2377280"
  },
  {
    "text": "yep",
    "start": "2381329",
    "end": "2384329"
  },
  {
    "text": "you",
    "start": "2387940",
    "end": "2390000"
  },
  {
    "text": "yeah you can do that you can do that yeah I just did it very manually to show step by step deliberately but in a in a",
    "start": "2396750",
    "end": "2403810"
  },
  {
    "text": "real application yes you can just call you can straight away go to a login prompt that's probably what you will be doing yeah in a real or the other ways",
    "start": "2403810",
    "end": "2410230"
  },
  {
    "text": "that you you you you have the homepage and then somebody clicks the button it pretty much redirects you to the login",
    "start": "2410230",
    "end": "2415270"
  },
  {
    "text": "page and once you login you come back if you do angular these things are really easy because there is angular library on",
    "start": "2415270",
    "end": "2420400"
  },
  {
    "text": "top of Idul which makes this thing very simple yeah definitely so that's how a",
    "start": "2420400",
    "end": "2425500"
  },
  {
    "text": "JWT token looks like and at this point if you if anybody that has a token can",
    "start": "2425500",
    "end": "2430720"
  },
  {
    "text": "still call the API which I can actually show but you need to get a token and to get the token you need to authenticate",
    "start": "2430720",
    "end": "2436330"
  },
  {
    "text": "with Azure Active Directory so that's it that's a hurdle there already so let's do one more thing I go to a test tool",
    "start": "2436330",
    "end": "2446530"
  },
  {
    "text": "and what I can do is that I can paste this and say this tool is going to auto",
    "start": "2446530",
    "end": "2457420"
  },
  {
    "text": "completion yeah authorization BRR and this thing so",
    "start": "2457420",
    "end": "2463000"
  },
  {
    "text": "this because it's a bearer token whoever has that has the token can use it so in this case I have sort of stolen the token from the browser so this work",
    "start": "2463000",
    "end": "2472630"
  },
  {
    "text": "because the right token is provided to the permission the function is very rating that is caught the the checks in",
    "start": "2472630",
    "end": "2479500"
  },
  {
    "text": "their checks passed and I'm getting a response because because you've got a secure network connection no one else",
    "start": "2479500",
    "end": "2485710"
  },
  {
    "text": "can actually steal the token Midway and then and then use it so one of the you",
    "start": "2485710",
    "end": "2493690"
  },
  {
    "text": "know now that we actually implemented this you know we're probably halfway there right what are the other things what are the things that's still missing in terms of security for this one so one",
    "start": "2493690",
    "end": "2501040"
  },
  {
    "text": "of the most critical thing is that all the validation is getting done in the code in within the azure function which",
    "start": "2501040",
    "end": "2506890"
  },
  {
    "text": "means that if there is a adversary who can they can still get the D function key from this power the from the spa",
    "start": "2506890",
    "end": "2513339"
  },
  {
    "text": "JavaScript spar because that's still on the inside the spa so let's go back so you can still get it from the from from",
    "start": "2513339",
    "end": "2519640"
  },
  {
    "text": "here and then you can start calling the function now if you don't have a token yes the function we respond with forbidden or unauthorized but you're",
    "start": "2519640",
    "end": "2526510"
  },
  {
    "text": "still hammering the function you're paying the function will scale you'll be paying so you could have still",
    "start": "2526510",
    "end": "2531530"
  },
  {
    "text": "got a DOS kind of scenario in there the other thing is that this function key is M bred in a JavaScript if you want to",
    "start": "2531530",
    "end": "2537770"
  },
  {
    "text": "rotate the function key which is a good security practice you know how to redeploy your application and this thing can get cached another thing so it's",
    "start": "2537770",
    "end": "2544490"
  },
  {
    "text": "good to have your function key publicly available and everything's cream done through code so so it's not the is on",
    "start": "2544490",
    "end": "2551090"
  },
  {
    "text": "top it's not the best state at which it can be an azure weight is obviously better than how we started but we can definitely make it better yeah",
    "start": "2551090",
    "end": "2557120"
  },
  {
    "text": "so one of the ways we can actually do is we can actually start to stick and as your API management layer between our",
    "start": "2557120",
    "end": "2563270"
  },
  {
    "text": "single page app and our function itself so what this does is it kind of like acts as a gateway and it seals access to",
    "start": "2563270",
    "end": "2570770"
  },
  {
    "text": "the total as your function itself and the other thing is because now as your",
    "start": "2570770",
    "end": "2576020"
  },
  {
    "text": "API M is available in a consumption based plan you know you effectively end up paying for just what you use itself",
    "start": "2576020",
    "end": "2582500"
  },
  {
    "text": "and the other thing is like if you noticed in the function that particular",
    "start": "2582500",
    "end": "2587510"
  },
  {
    "text": "showing you know you had the validation of the token and each and every one of those functions itself right yes you could probably do some kind of injection",
    "start": "2587510",
    "end": "2594050"
  },
  {
    "text": "of it and then make sure that you know that's kind of like abstracted away but it would be really nice if the as your",
    "start": "2594050",
    "end": "2600770"
  },
  {
    "text": "APM can valid the token for you and that's what apium can can do and of",
    "start": "2600770",
    "end": "2606950"
  },
  {
    "text": "course you know as you mentioned we can actually do the the rate-limiting itself to see you know the number of calls that are actually being made we can start to",
    "start": "2606950",
    "end": "2614330"
  },
  {
    "text": "throttle that as well and of course you know one of the things that we'll have to do is we have to move",
    "start": "2614330",
    "end": "2619940"
  },
  {
    "text": "the the function key that you were talking about that can be more over from the spa and then be stored in a p.m. as",
    "start": "2619940",
    "end": "2626990"
  },
  {
    "text": "well yeah so that's what I'm gonna do in the demo so what we're going to do is going to publish the the APM on in APM",
    "start": "2626990",
    "end": "2634640"
  },
  {
    "text": "itself you're going to expose only the API endpoint from now on onwards and then we'll also configure the short",
    "start": "2634640",
    "end": "2640640"
  },
  {
    "text": "validation policy we'll set that up in a p.m. so that any function that actually calls it we can actually use this policy",
    "start": "2640640",
    "end": "2646730"
  },
  {
    "text": "to validate the token and the last one is we can actually make some changes to remove the function key from the spot",
    "start": "2646730",
    "end": "2652160"
  },
  {
    "text": "itself right and you know we can actually all go and value in a remove the validation in that your function but",
    "start": "2652160",
    "end": "2657680"
  },
  {
    "text": "you know we'll leave that out in for that for the demo itself yeah okay let's switch or yeah so as you can",
    "start": "2657680",
    "end": "2664510"
  },
  {
    "text": "see I've got a couple of API management resources provision there I'm gonna use the one called server les disques from",
    "start": "2664510",
    "end": "2670030"
  },
  {
    "text": "my previous talk that's it that's in a consumption here there's a new tier in API management where you don't have to",
    "start": "2670030",
    "end": "2676450"
  },
  {
    "text": "pre provision the resources for the like how many scale units and and that kind",
    "start": "2676450",
    "end": "2682420"
  },
  {
    "text": "of thing and this this will pretty much scale automatically as more calls are coming through he's got a few",
    "start": "2682420",
    "end": "2687730"
  },
  {
    "text": "limitations today but I'm gonna use that for the demo some of them more more more complex rate limiting features only",
    "start": "2687730",
    "end": "2693970"
  },
  {
    "text": "available in the more powerful SQLite the premium is Q or the standard rescue but but it's good enough for our purpose",
    "start": "2693970",
    "end": "2701130"
  },
  {
    "text": "how you publish a API an APM is really easy if you do it through the portal it's like one click effectively you can",
    "start": "2701130",
    "end": "2707619"
  },
  {
    "text": "do you can go to the function and you can publish it to API M or you can go go to the API m and bring in the formation",
    "start": "2707619",
    "end": "2713109"
  },
  {
    "text": "inside it I'll just show you how to do it because I've already done it so one of the things that I will actually say",
    "start": "2713109",
    "end": "2718869"
  },
  {
    "text": "that at this point in time right is although we are showing all of these things to the portal in in real life",
    "start": "2718869",
    "end": "2724270"
  },
  {
    "text": "when you're rolling things out you probably automate all of these things right so just keep in mind although we say it's so easy to do it in in reality",
    "start": "2724270",
    "end": "2732250"
  },
  {
    "text": "you'd probably automate all of these things through scripts actually realize that this APM this APM is brand new so",
    "start": "2732250",
    "end": "2738490"
  },
  {
    "text": "because it hasn't got this function so let's just import it it should be very quick so so what we do is that we go to",
    "start": "2738490",
    "end": "2743830"
  },
  {
    "text": "this function app is got it's got a workflow built in where you go and choose the function app in this case I'm",
    "start": "2743830",
    "end": "2749080"
  },
  {
    "text": "choosing NBC API select that point to show me all the appears inside that",
    "start": "2749080",
    "end": "2754630"
  },
  {
    "text": "function up I choose to bring all of them to select okay I can give it a URL",
    "start": "2754630",
    "end": "2761170"
  },
  {
    "text": "suffix like NBC to do APA if that's good enough and I say ok let's create this",
    "start": "2761170",
    "end": "2766530"
  },
  {
    "text": "create this API proxy inside as your API management you'll automatically do it",
    "start": "2766530",
    "end": "2771910"
  },
  {
    "text": "and what it does is that I'll show you what it does actually let's go to the function in the function if we go to any",
    "start": "2771910",
    "end": "2781150"
  },
  {
    "text": "any one of this API is you will manage",
    "start": "2781150",
    "end": "2785549"
  },
  {
    "text": "you see all the all the function keys are actually here so that action creates",
    "start": "2787880",
    "end": "2793349"
  },
  {
    "text": "automatically creates a new formation key and is called APM and easy save me so so this is this is the key that is",
    "start": "2793349",
    "end": "2798780"
  },
  {
    "text": "that the secret key that you need to call this function and what API M does is is it there's a thing in a PM con",
    "start": "2798780",
    "end": "2806040"
  },
  {
    "text": "named values where you can store some secrets in there and this is where you automatically brought that function key",
    "start": "2806040",
    "end": "2811080"
  },
  {
    "text": "and saved it there this kind of stores store securely within API management at this point and the API is here now as",
    "start": "2811080",
    "end": "2822450"
  },
  {
    "text": "Maya said we need to validate the this this as a policy within here now I have",
    "start": "2822450",
    "end": "2827849"
  },
  {
    "text": "pre provision each so let let me go back to the API that is already pre provision for the interest of time the policies",
    "start": "2827849",
    "end": "2838890"
  },
  {
    "text": "are pretty much XML files and this can be like at a GL we are doing it in a DevOps pipeline to arm templates so",
    "start": "2838890",
    "end": "2845640"
  },
  {
    "text": "that's what we are doing this thing but I'm just doing to the portal for here there's actually so we need two things",
    "start": "2845640",
    "end": "2856170"
  },
  {
    "text": "first now the JavaScript will not call as your web sites don't need to call as your API dotnet so I need to have a new",
    "start": "2856170",
    "end": "2863040"
  },
  {
    "text": "course policy in here because the course policy will now be returned by the API management not by the function so I put",
    "start": "2863040",
    "end": "2868859"
  },
  {
    "text": "a course policy here which says it ok allow this origin these are configured as named value pairs so these are the configuration so this will be that web",
    "start": "2868859",
    "end": "2875880"
  },
  {
    "text": "code dot windows.net in here and i cerci allow all these methods and with any header so that's course policy it's",
    "start": "2875880",
    "end": "2882150"
  },
  {
    "text": "important but this is the important this is the project I wanna showcase the validate JWT policy so the same thing",
    "start": "2882150",
    "end": "2887670"
  },
  {
    "text": "that we are doing it through code now you can do it for a policy and it says ok validate jadibooti header the name is authorization and I want to check they",
    "start": "2887670",
    "end": "2895560"
  },
  {
    "text": "should have expiration time each the token should be signed it should have an",
    "start": "2895560",
    "end": "2900900"
  },
  {
    "text": "audience the value is configured again is the name of the value in there but it should it checks that same audience it checks the issuer and it checks the app",
    "start": "2900900",
    "end": "2908190"
  },
  {
    "text": "ID so if all this thing is matched then only API management will let the call to",
    "start": "2908190",
    "end": "2915150"
  },
  {
    "text": "go to the backend which is the function otherwise it'll block the call and return from there so so this is where you get a very good",
    "start": "2915150",
    "end": "2920200"
  },
  {
    "text": "protection for your function anything will be called API management and these are very much more scalable and better",
    "start": "2920200",
    "end": "2925540"
  },
  {
    "text": "layer to guard your ApS at this point so so this is already configured all I need",
    "start": "2925540",
    "end": "2931180"
  },
  {
    "text": "to do is basically deploy that the spy again but now pointing to this URL",
    "start": "2931180",
    "end": "2939750"
  },
  {
    "text": "so the only thing that actually happened here is these two lines so one is the API URL now interesting they actually",
    "start": "2953700",
    "end": "2960299"
  },
  {
    "text": "appear dotnet yeah the one more thing I forgot is once you create a in API",
    "start": "2960299",
    "end": "2965309"
  },
  {
    "text": "imagine your concept of products or product is that a grouping of AP is and what you do is that once you create a product you create a subscriptions for",
    "start": "2965309",
    "end": "2972059"
  },
  {
    "text": "the product and that that gives a key now this key is not really meant for security it is more like if this key has",
    "start": "2972059",
    "end": "2978960"
  },
  {
    "text": "come from as you can remove or remove that key and anybody that has that key cannot call the API that's one thing but",
    "start": "2978960",
    "end": "2984690"
  },
  {
    "text": "more important is that you can actually rate limit by this particular key so you can say that okay I'll give this is this",
    "start": "2984690",
    "end": "2990299"
  },
  {
    "text": "is my premium product and I'll rate limit it array at a higher rate and you can create a like sort of a less premium",
    "start": "2990299",
    "end": "2996180"
  },
  {
    "text": "product and say give give give this key to applications which can call much more less frequently so you can do those kind",
    "start": "2996180",
    "end": "3002210"
  },
  {
    "text": "of things with with the key as well so so once I get the key and the key actually can be can be shown here as well we can we can show all right the",
    "start": "3002210",
    "end": "3011390"
  },
  {
    "text": "key so I got the key so that that's the key that is configured in the inspire",
    "start": "3011390",
    "end": "3016490"
  },
  {
    "text": "plication is going to the API URL now so let's just deploy this",
    "start": "3016490",
    "end": "3021730"
  },
  {
    "text": "yep Soula plot this changed application now",
    "start": "3035140",
    "end": "3041520"
  },
  {
    "text": "you",
    "start": "3080539",
    "end": "3082599"
  },
  {
    "text": "the network",
    "start": "3087450",
    "end": "3090839"
  },
  {
    "text": "see if we see that pop up now shows is calling and sure - API door network called through the edge European",
    "start": "3100290",
    "end": "3106260"
  },
  {
    "text": "management gateway and the function key is not anymore in this publication that's been guarded by API management and we were validating the jot inside",
    "start": "3106260",
    "end": "3113130"
  },
  {
    "text": "API management if you if you hijack a job from somewhere else or it's expired jot or anything like that they pay - to",
    "start": "3113130",
    "end": "3118680"
  },
  {
    "text": "reject that call and not get it passed to the function back-end yeah someone's got a question over there",
    "start": "3118680",
    "end": "3125270"
  },
  {
    "text": "the code for validating the token is still there I'd probably say that we can still keep that one and the reason is",
    "start": "3130780",
    "end": "3137800"
  },
  {
    "text": "that I'll go to and they said there's a there's a few more things that we can do with that particular token which I'm",
    "start": "3137800",
    "end": "3144340"
  },
  {
    "text": "going to show us it's better to keep that code for now in there within the function now obviously you can you can relax the validation to some extent",
    "start": "3144340",
    "end": "3150550"
  },
  {
    "text": "because you know that it is getting evaluated like you might not check the audience anymore some of those things",
    "start": "3150550",
    "end": "3155590"
  },
  {
    "text": "you may not check the sign sign you may even actually the signing because for the signing it actually goes to the as",
    "start": "3155590",
    "end": "3161050"
  },
  {
    "text": "you area to get the signing keys to check the signing is correct so that's a bit of a slow Apple slow thing in there it does change the signing key but it is",
    "start": "3161050",
    "end": "3168520"
  },
  {
    "text": "a bit slow so you might relax some of this validation it's good to keep that code in there for some other reason",
    "start": "3168520",
    "end": "3173860"
  },
  {
    "text": "which you want to show very very soon and I think we're kind of running out of",
    "start": "3173860",
    "end": "3179620"
  },
  {
    "text": "time there are two additional steps that we want to two additional steps that we probably need to do if you look at the",
    "start": "3179620",
    "end": "3185440"
  },
  {
    "text": "security of the application so far right I mean we kind of like made it more secure from where we actually started but there are two things still missing",
    "start": "3185440",
    "end": "3191500"
  },
  {
    "text": "one is you know authorization now we've added authentication but we haven't done",
    "start": "3191500",
    "end": "3197200"
  },
  {
    "text": "any authorization on it and the other one will probably combine six and seven together is is the fact that there are",
    "start": "3197200",
    "end": "3205600"
  },
  {
    "text": "there's still some credential sitting in it you know we have like a connection string that is sitting on it and we want",
    "start": "3205600",
    "end": "3211090"
  },
  {
    "text": "to secure that so first and foremost you know we want to do this in in the demo",
    "start": "3211090",
    "end": "3216130"
  },
  {
    "text": "itself we want to kind of like add roles in the in their ad manifest itself and we want to make sure that we grant user",
    "start": "3216130",
    "end": "3223750"
  },
  {
    "text": "to the role and check whether the value know the whether the validity of the",
    "start": "3223750",
    "end": "3228970"
  },
  {
    "text": "role itself so in code we want to make sure that this user can can execute the code I think in the interest of time we",
    "start": "3228970",
    "end": "3234790"
  },
  {
    "text": "might just show the code this time and not deploy and that's right it takes a bit time to do this part of the demo right but what we have done is we have",
    "start": "3234790",
    "end": "3241150"
  },
  {
    "text": "we have an authenticated user at this point so what I mean say anybody in your annuity or in your zero tenancy or",
    "start": "3241150",
    "end": "3246460"
  },
  {
    "text": "whatever can authenticate and it can grant these particular scopes but what we still missing is that okay I know who",
    "start": "3246460",
    "end": "3252430"
  },
  {
    "text": "you are the application knows IDs this this person that's been authenticated but what I don't know is",
    "start": "3252430",
    "end": "3257620"
  },
  {
    "text": "that what are you allowed to do so that's authorization because it might be that some users only allowed to like",
    "start": "3257620",
    "end": "3263810"
  },
  {
    "text": "least searched to ruse and maybe create a new to do but they're not allowed to delete or update it to do that request",
    "start": "3263810",
    "end": "3269450"
  },
  {
    "text": "an admin user so we don't have that concept yet and we can bring that concept in as well so very you know for",
    "start": "3269450",
    "end": "3275420"
  },
  {
    "text": "a long time we have been doing authorization through role based access control so you can increase the concept of roles for the application and we can",
    "start": "3275420",
    "end": "3281360"
  },
  {
    "text": "grant user certain roles and those roles will come back in that claim and in your code you can check check in that those",
    "start": "3281360",
    "end": "3288500"
  },
  {
    "text": "roles are present or not for certain actions because this is semantics that the API management doesn't know because",
    "start": "3288500",
    "end": "3294680"
  },
  {
    "text": "that's just a layer to validate the token is there but what it actually means that's for your application so I'm so",
    "start": "3294680",
    "end": "3301010"
  },
  {
    "text": "instead of actually deploying this I'm actually show you how that can be done so the first thing that we need to",
    "start": "3301010",
    "end": "3306260"
  },
  {
    "text": "create roles so in as you're ready we'll go back to Asia ready so if I go back to",
    "start": "3306260",
    "end": "3315470"
  },
  {
    "text": "Azure ad and let's go back to the API so as you mary has a configuration object",
    "start": "3315470",
    "end": "3322730"
  },
  {
    "text": "called a configuration jason called manifest some of these things you could do to the UI but other things you have",
    "start": "3322730",
    "end": "3328730"
  },
  {
    "text": "to do it straight away in the JSON so what I've created is that I've created they said it this will be empty so this",
    "start": "3328730",
    "end": "3333800"
  },
  {
    "text": "app pros property would be empty in adjacent when you start but you can create rows and they are defined like",
    "start": "3333800",
    "end": "3339230"
  },
  {
    "text": "this just on property the important thing is that you say you give it a name if you get a unique and sort of a key",
    "start": "3339230",
    "end": "3344390"
  },
  {
    "text": "called NBC to do API user and you need to create a new grid you can generate using PowerShell or any other way you",
    "start": "3344390",
    "end": "3350420"
  },
  {
    "text": "need to give it a grid and some description and you said that they allowed member type is user you can also",
    "start": "3350420",
    "end": "3355760"
  },
  {
    "text": "have application rows but therefore machine-to-machine communication we are talking about user roles here so create two roles NDC API to do user and NDC to",
    "start": "3355760",
    "end": "3363560"
  },
  {
    "text": "do APA admin so these two roles are created then what can I do let me go back to my enterprise",
    "start": "3363560",
    "end": "3370820"
  },
  {
    "text": "applications bed",
    "start": "3370820",
    "end": "3373660"
  },
  {
    "text": "I go to the API and here you've got users and groups and now I have added",
    "start": "3376950",
    "end": "3382730"
  },
  {
    "text": "two users inside were a user called to do and means I can do add user and I can select now if you've got a activity",
    "start": "3382730",
    "end": "3390239"
  },
  {
    "text": "premium you can actually use ad groups as well - the free ad doesn't come with the groups and some other things but you",
    "start": "3390239",
    "end": "3396390"
  },
  {
    "text": "can say that okay I select a user and in my tenancy their son who's just in there so I can again select like to do user in",
    "start": "3396390",
    "end": "3401940"
  },
  {
    "text": "this case and service this user will be in this role for the application and you can grant and Adam in can grant this",
    "start": "3401940",
    "end": "3408299"
  },
  {
    "text": "thing in the ad what happens is that when you get the token the next time this roles will be in the claim I'm",
    "start": "3408299",
    "end": "3416400"
  },
  {
    "text": "going to show that one but I think I had a I had a I had a jot with this row so",
    "start": "3416400",
    "end": "3421920"
  },
  {
    "text": "I'm just going to saved it I was gonna show it in the in the tool",
    "start": "3421920",
    "end": "3428900"
  },
  {
    "text": "so in this case you have you have this role here now because it a Toru user has",
    "start": "3437280",
    "end": "3442480"
  },
  {
    "text": "obtained a token the roles of the DJ in DC to do API user desta role and what I",
    "start": "3442480",
    "end": "3447490"
  },
  {
    "text": "can do is that in mind API code let's go to the final version of this team",
    "start": "3447490",
    "end": "3454680"
  },
  {
    "text": "so now I can check if the principal is in is enroll and I give the role now these roles are different for different",
    "start": "3463790",
    "end": "3469920"
  },
  {
    "text": "actions so if it is a if it is a like I get the role in the validate access",
    "start": "3469920",
    "end": "3475380"
  },
  {
    "text": "token now I read this parameter to this one now if this is a gate and like a delete action I am saying that I need",
    "start": "3475380",
    "end": "3481020"
  },
  {
    "text": "that mean role which is which is the string that is configured as a constant on the top or if it is to get to do I",
    "start": "3481020",
    "end": "3490470"
  },
  {
    "text": "only need the user role so you can validate what role you want for different actions as well so that gives",
    "start": "3490470",
    "end": "3495930"
  },
  {
    "text": "you the authorization at this point so I'm not going to apply this code but you can do this one the last thing that is",
    "start": "3495930",
    "end": "3501780"
  },
  {
    "text": "missing as much pointed out is that we got one more so we have secured the one and the connections very nicely between",
    "start": "3501780",
    "end": "3507630"
  },
  {
    "text": "the spy application and the API you can do a little bit more like you can because now that we got the API",
    "start": "3507630",
    "end": "3513329"
  },
  {
    "text": "management in the middle you can also secure the API management to the permission using a client certificate",
    "start": "3513329",
    "end": "3518550"
  },
  {
    "text": "and mutual TLS for added layer of network protection as well you can do that one what still there is the",
    "start": "3518550",
    "end": "3524640"
  },
  {
    "text": "connection string that is between the application and back-end let's look at the connection string again in the",
    "start": "3524640",
    "end": "3531089"
  },
  {
    "text": "portal yeah you can switch back",
    "start": "3531089",
    "end": "3535190"
  },
  {
    "text": "so as we saw before the connection string is actually stored in the environment here which is this one so",
    "start": "3542829",
    "end": "3548619"
  },
  {
    "text": "it's got the whole thing in here now we know that environment variable configuration sometimes they're not the",
    "start": "3548619",
    "end": "3554259"
  },
  {
    "text": "best place to store secrets there are many reasons for that one anybody who's got access to this particular as your",
    "start": "3554259",
    "end": "3561160"
  },
  {
    "text": "resources has got access to this one oftentimes you want to keep the secret in somewhere else on where only very few",
    "start": "3561160",
    "end": "3566259"
  },
  {
    "text": "people like a security operations team or very few people have got access for those things the other things that if",
    "start": "3566259",
    "end": "3572890"
  },
  {
    "text": "you want to change these keys these keys let's say you got many applications using the same table story to go to each application and change it",
    "start": "3572890",
    "end": "3579249"
  },
  {
    "text": "their key location can become important for certain security practices kiss girls compromise the other things are",
    "start": "3579249",
    "end": "3584859"
  },
  {
    "text": "done every time you use even key you have no idea who is actually using it because no logs of this thing so in a",
    "start": "3584859",
    "end": "3590799"
  },
  {
    "text": "sure there is a there is a special resource called as your key vault there is a recommended way to store keys and",
    "start": "3590799",
    "end": "3595900"
  },
  {
    "text": "secrets this is a secret so secret is a name value pair the name is this name and the value is this so we can store",
    "start": "3595900",
    "end": "3601719"
  },
  {
    "text": "the secret in a key value in as your key vault and there's a way that functions",
    "start": "3601719",
    "end": "3607989"
  },
  {
    "text": "has got first-class support for obtaining this from a key one and that's what I'm going to show now yeah so let's",
    "start": "3607989",
    "end": "3613390"
  },
  {
    "text": "go to let's go to a key vault we've run",
    "start": "3613390",
    "end": "3619089"
  },
  {
    "text": "out of times we'll be meaning to yeah we work very very quickly so we've got a key vault in which I've got a secret in",
    "start": "3619089",
    "end": "3625479"
  },
  {
    "text": "here so so the secret secret is that",
    "start": "3625479",
    "end": "3632979"
  },
  {
    "text": "connection string so that is the connection string and the name of the secrets to do table storage and every",
    "start": "3632979",
    "end": "3638739"
  },
  {
    "text": "secret has a has a full-on URL like a canonical URL to that whole thing and the other thing we do is that let's go",
    "start": "3638739",
    "end": "3645489"
  },
  {
    "text": "to a function back again in a function you can give a function a managed service identity in Azure this basically",
    "start": "3645489",
    "end": "3650890"
  },
  {
    "text": "creates a service principle for this function application instead as you're ready we're how the way it identifies",
    "start": "3650890",
    "end": "3657130"
  },
  {
    "text": "the function you've turned that on you create a service principal and a identities credit for the function what",
    "start": "3657130",
    "end": "3663279"
  },
  {
    "text": "I've gone and done is in the key vault so let's go back to the keyboard in the keyboard will go to access policy and we",
    "start": "3663279",
    "end": "3669339"
  },
  {
    "text": "add access policy if you add this one we can be very granular so you can say all I need is get secrets that's all",
    "start": "3669339",
    "end": "3676660"
  },
  {
    "text": "I don't need anything more than that just one permission enough and I select the service principle by searching it in my already so I'll not show that one no",
    "start": "3676660",
    "end": "3682780"
  },
  {
    "text": "no so we have done that one I say okay NDC to do ap application has got get",
    "start": "3682780",
    "end": "3688119"
  },
  {
    "text": "permission okay type get permission for secrets that's all then what we do is that they say",
    "start": "3688119",
    "end": "3693340"
  },
  {
    "text": "[Music]",
    "start": "3693340",
    "end": "3696469"
  },
  {
    "text": "so there's a special sort of a format in which you can store the connect because",
    "start": "3701640",
    "end": "3707290"
  },
  {
    "text": "the connection string is now in a secret what you can do is that you can set the key vault connection string which looks like this a Microsoft Word key for",
    "start": "3707290",
    "end": "3713410"
  },
  {
    "text": "security where is the whole path to whole URI to that particular secret and then you store that as the settings",
    "start": "3713410",
    "end": "3719890"
  },
  {
    "text": "which we had before the to do tables to our same settings but this time we're going to store it like this now because",
    "start": "3719890",
    "end": "3725349"
  },
  {
    "text": "we run out of time we probably not going to show this one and I find sometimes it's good to disturb deformation after that but now the connection string will",
    "start": "3725349",
    "end": "3732160"
  },
  {
    "text": "be this it will not be the actual connections thing it will be disconnection string and function API knows that I have to go to a key vault",
    "start": "3732160",
    "end": "3739030"
  },
  {
    "text": "and get the secret and because is allowed by the access control policy with is own identity it can do that in the background only that is you're the",
    "start": "3739030",
    "end": "3745540"
  },
  {
    "text": "only that function can actually write and this is called credential feed cork so it is a very good security practices",
    "start": "3745540",
    "end": "3750670"
  },
  {
    "text": "to not have any credentials in code in this case we have removed all the credentials and that's how it will work",
    "start": "3750670",
    "end": "3756099"
  },
  {
    "text": "yeah so we kind of like run out of time so one of the things is like we've got",
    "start": "3756099",
    "end": "3761290"
  },
  {
    "text": "an overview slide talks about all the things that we actually done we will actually publish the slides itself so you can actually have a look at it so we",
    "start": "3761290",
    "end": "3768609"
  },
  {
    "text": "are originally going to walk through the whole thing but we don't have time you know I'm happy to we both of us are",
    "start": "3768609",
    "end": "3774400"
  },
  {
    "text": "happy to stay back and take questions you can also reach out to us this slide actually has our email address and",
    "start": "3774400",
    "end": "3781000"
  },
  {
    "text": "Twitter handle so feel free to you know send us any questions that you may have and on the way out you know please fill",
    "start": "3781000",
    "end": "3788800"
  },
  {
    "text": "the feedback as well yeah all right so great thanks yeah all",
    "start": "3788800",
    "end": "3793990"
  },
  {
    "text": "right the people have come to the conference yeah yeah that's right and thanks to the organizers and everyone else all right thanks guys",
    "start": "3793990",
    "end": "3799210"
  },
  {
    "text": "right [Applause]",
    "start": "3799210",
    "end": "3803010"
  }
]