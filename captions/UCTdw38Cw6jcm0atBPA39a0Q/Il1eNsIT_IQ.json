[
  {
    "text": "so thanks uh thanks everybody for coming uh we're going to talk today about",
    "start": "5680",
    "end": "12559"
  },
  {
    "text": "finding a three zero day exploit chain in ianti epmm and ianti",
    "start": "12559",
    "end": "19640"
  },
  {
    "text": "Sentry uh and my name my name is to this is isand",
    "start": "19640",
    "end": "26760"
  },
  {
    "text": "uh it's great to be here so my story is I've always been messing around with",
    "start": "26760",
    "end": "32439"
  },
  {
    "text": "computers grew up with Unix at home got my first email account in preschool uh",
    "start": "32440",
    "end": "38640"
  },
  {
    "text": "the ball kind of just rolled from there so I've been working in secur with",
    "start": "38640",
    "end": "44000"
  },
  {
    "text": "security as a full-time job for the last 18 years time flies",
    "start": "44000",
    "end": "49920"
  },
  {
    "text": "um currently I'm I'm working in the monic I've been in the monic for last 11 years",
    "start": "49920",
    "end": "55879"
  },
  {
    "text": "and I guess you could say that in my current role I mainly try to build Bridges between security and development",
    "start": "55879",
    "end": "61960"
  },
  {
    "text": "between security and management between the red team and the blue team and so on",
    "start": "61960",
    "end": "67880"
  },
  {
    "text": "so today I'm here together with my good friend and colleague Alan would you say",
    "start": "67880",
    "end": "73479"
  },
  {
    "text": "a few words about yourself hello is the sound good great uh I'm AR uh my",
    "start": "73479",
    "end": "80720"
  },
  {
    "text": "background is from uh electrical engineering and I did a masters in",
    "start": "80720",
    "end": "85840"
  },
  {
    "text": "technical societal safety uh my the first steps in it",
    "start": "85840",
    "end": "91000"
  },
  {
    "text": "Security started from IRC and Lawn parties uh I remember my first security",
    "start": "91000",
    "end": "97399"
  },
  {
    "text": "related projects was writing code in Turbo Pascal and writing a screen saver",
    "start": "97399",
    "end": "103079"
  },
  {
    "text": "for OS on the home computer to keep my the siblings away that was not very popular but",
    "start": "103079",
    "end": "110520"
  },
  {
    "text": "um yeah uh my interest in it security just uh kept on going and never faded",
    "start": "110520",
    "end": "117840"
  },
  {
    "text": "and I kind of kept up to date with all the new stuff until eventually it",
    "start": "117840",
    "end": "124200"
  },
  {
    "text": "security became a full-time employment in pneumonic in 201",
    "start": "124200",
    "end": "129479"
  },
  {
    "text": "11 and in monic I do I'm a penetration tester I'm doing some red team",
    "start": "129479",
    "end": "134959"
  },
  {
    "text": "engagement and uh in between assignments I get time to do some",
    "start": "134959",
    "end": "141000"
  },
  {
    "text": "research so back to Tool yeah so since some of you might not",
    "start": "141000",
    "end": "148080"
  },
  {
    "text": "be familiar with neonic I'll quick say two words about the company we're both working for uh it's actually also quite",
    "start": "148080",
    "end": "153800"
  },
  {
    "text": "important context for this talk so we're a Norwegian cyber security",
    "start": "153800",
    "end": "159800"
  },
  {
    "text": "company that started up in back in 2000 we have Offices here in Norway but also in Sweden Denmark Netherlands UK and the",
    "start": "159800",
    "end": "165879"
  },
  {
    "text": "US uh we're headquartered here in Oslo about a 15 minute 15 minute walk from here and we do a lot of things within",
    "start": "165879",
    "end": "173440"
  },
  {
    "text": "cyber security but it's worth noting that we do a lot of instant response uh",
    "start": "173440",
    "end": "178879"
  },
  {
    "text": "we've been logging about 40,000 hour instant response hours yearly for the last few years and that's really quite a",
    "start": "178879",
    "end": "184879"
  },
  {
    "text": "lot by any measure of things uh we do also deliver managed",
    "start": "184879",
    "end": "190480"
  },
  {
    "text": "Services we do Consulting everything from basically ceso For Hire to pen testing and red teaming and we work with",
    "start": "190480",
    "end": "197400"
  },
  {
    "text": "quite a lot of security products and security vendors so our Flagship is our manag",
    "start": "197400",
    "end": "203879"
  },
  {
    "text": "detection response service which we deliver worldwide it's built inhouse and supported by quite a lot of cool Tech",
    "start": "203879",
    "end": "209480"
  },
  {
    "text": "and also so our own in-house threat intelligence team and of course we're also uh",
    "start": "209480",
    "end": "215239"
  },
  {
    "text": "collaborating with quite a lot of different partners in law enforcement Academia and the security community at",
    "start": "215239",
    "end": "220439"
  },
  {
    "text": "large uh now I could spend a lot of time talking about demonic but I'll stop there if you're interested check check",
    "start": "220439",
    "end": "226200"
  },
  {
    "text": "us out on online or look up our security podcast anyway back to the main topic",
    "start": "226200",
    "end": "231879"
  },
  {
    "text": "I'm going to start out to give some credits because there are a lot of people who aren't up on stage today and what we're",
    "start": "231879",
    "end": "239319"
  },
  {
    "text": "about to present is the result of a really major team effort that's both from theonics instant response team but",
    "start": "239319",
    "end": "245599"
  },
  {
    "text": "also several other parties so Ireland and I get to go on stage here but we",
    "start": "245599",
    "end": "250840"
  },
  {
    "text": "we're just a small part of this thing and I'd like to underline the following this has been teamwork and neonic has been spending a",
    "start": "250840",
    "end": "258600"
  },
  {
    "text": "lot of time on this but also there's a lot of other parties in the particularly",
    "start": "258600",
    "end": "264840"
  },
  {
    "text": "within the inet response Community uh the ncsc uh uh ivanti the",
    "start": "264840",
    "end": "270840"
  },
  {
    "text": "vendor and from the organizations that did get attacked as well",
    "start": "270840",
    "end": "276479"
  },
  {
    "text": "so just a huge rudos to everybody who's been part of this",
    "start": "276479",
    "end": "282160"
  },
  {
    "text": "thing so I'd like to continue to say just a little bit about what this talk is about um first of all a small",
    "start": "282160",
    "end": "290320"
  },
  {
    "text": "disclaimer for me this talk is based on things we've learned from several instant response",
    "start": "290320",
    "end": "296320"
  },
  {
    "text": "cases last year so you guys might have heard about one of them which was quite a bit in the news but there are",
    "start": "296320",
    "end": "304400"
  },
  {
    "text": "also several other cases that have given us information that goes into this talk",
    "start": "304400",
    "end": "309440"
  },
  {
    "text": "so I I just want to underline that up front uh",
    "start": "309440",
    "end": "314840"
  },
  {
    "text": "so basically what happened was that there were some instance and in the",
    "start": "314840",
    "end": "321319"
  },
  {
    "text": "process of trying to figure out what was going on",
    "start": "321319",
    "end": "326759"
  },
  {
    "text": "and and handle those instance neonic discovered that the threat actor was",
    "start": "326759",
    "end": "332039"
  },
  {
    "text": "using quite a lot of zero day vulnerabilities and we were involved in identifying and Reporting uh three of",
    "start": "332039",
    "end": "340400"
  },
  {
    "text": "them uh I'm also going going to say what this talk is not about",
    "start": "340400",
    "end": "346360"
  },
  {
    "text": "so this is not an instant report I think that that's that would also be a very",
    "start": "346360",
    "end": "351840"
  },
  {
    "text": "interesting story but that's the story that the organizations that got attacked",
    "start": "351840",
    "end": "357319"
  },
  {
    "text": "should be the ones telling and and they will have to decide how whether and how to do that on their own terms and I",
    "start": "357319",
    "end": "364919"
  },
  {
    "text": "think that would also be a very different talk uh secondly we're not here today to",
    "start": "364919",
    "end": "371919"
  },
  {
    "text": "kind of point fingers and say that haha this was bad and you somebody should have done this that instead uh I think",
    "start": "371919",
    "end": "377759"
  },
  {
    "text": "what's really important here is that vulnerabilities happen instance happen things get things get hacked and",
    "start": "377759",
    "end": "385080"
  },
  {
    "text": "the important thing is really let's try to learn from this let's try to do better next time",
    "start": "385080",
    "end": "391319"
  },
  {
    "text": "and finally I'd like to underline that this talk is based on open information so we're not going to reveal any huge",
    "start": "391319",
    "end": "398639"
  },
  {
    "text": "Secrets here today uh the difference is that a lot of the reporting on the on",
    "start": "398639",
    "end": "405199"
  },
  {
    "text": "these issues have been kind of secondhand and thirdhand information and Alan and I both have some firsthand",
    "start": "405199",
    "end": "411160"
  },
  {
    "text": "knowledge of what was going on and we can add some New Perspectives to to to that",
    "start": "411160",
    "end": "417479"
  },
  {
    "text": "story so to kind of finish off The Meta introduction I would like to sum up some of the main Lessons Learned in this talk",
    "start": "418520",
    "end": "424240"
  },
  {
    "text": "and we're we're going to come back to this towards the end of this talk I think also that we have quite a lot of",
    "start": "424240",
    "end": "429919"
  },
  {
    "text": "time today so there should be good room for some discussion at the end so hopefully we can have some Q&A and then",
    "start": "429919",
    "end": "436400"
  },
  {
    "text": "try to discuss a little bit at the end of the talk anyway some things we've",
    "start": "436400",
    "end": "441840"
  },
  {
    "text": "learned or some things that we've seen is that email is interesting to threat",
    "start": "441840",
    "end": "447520"
  },
  {
    "text": "actors it's been it's been like that for for a long time and it's still really very much the",
    "start": "447520",
    "end": "453680"
  },
  {
    "text": "case secondly this case illustrates that kind of blackbox appliances on your network",
    "start": "453680",
    "end": "461240"
  },
  {
    "text": "is something that really can complicate both your security operations and your instant response",
    "start": "461240",
    "end": "467560"
  },
  {
    "text": "activities thirdly we this is a very good illustration of the value of",
    "start": "467560",
    "end": "472680"
  },
  {
    "text": "centralized logging and monitoring both to kind of figure out what's going on and also to to be able to handle it when",
    "start": "472680",
    "end": "478960"
  },
  {
    "text": "something happens the fourth thing that's quite interesting here is that the threat",
    "start": "478960",
    "end": "484560"
  },
  {
    "text": "actor was in fact carrying out this attack from IP addresses within Norway",
    "start": "484560",
    "end": "490680"
  },
  {
    "text": "and so one thing that means is that they were really blending in with legitimate traffic and GE GE based IP blocking and",
    "start": "490680",
    "end": "499280"
  },
  {
    "text": "and geolocation Based Services would not really have helped in this",
    "start": "499280",
    "end": "504960"
  },
  {
    "text": "situation A fifth point is that none of these vulnerabilities are",
    "start": "504960",
    "end": "510400"
  },
  {
    "text": "really rocket scies these are kind of simple vulnerabilities that we can explain I think quite easily in this",
    "start": "510400",
    "end": "517360"
  },
  {
    "text": "talk uh the hard part is kind of looking in the right place to find them and to",
    "start": "517360",
    "end": "522599"
  },
  {
    "text": "to see that Oo we could this could this could be abused and finally I think that again",
    "start": "522599",
    "end": "530959"
  },
  {
    "text": "looking at what what's happened in these incidents allow us to observe and learn a little bit about what Advanced threat",
    "start": "530959",
    "end": "536920"
  },
  {
    "text": "actors are doing at the moment so yeah welcome come back to all this so for those who are not familiar",
    "start": "536920",
    "end": "546399"
  },
  {
    "text": "with kind of what happened before I we'll just briefly go through it",
    "start": "546399",
    "end": "551959"
  },
  {
    "text": "so on July 24th last summer news broke around the world about the Cyber attack",
    "start": "551959",
    "end": "557360"
  },
  {
    "text": "on Norwegian government",
    "start": "557360",
    "end": "561880"
  },
  {
    "text": "and and ponic instant response team was involved in several security instance at",
    "start": "563279",
    "end": "569079"
  },
  {
    "text": "this time time uh and working together with other instant response teams and the",
    "start": "569079",
    "end": "574240"
  },
  {
    "text": "community and what's known is that an an unknown threat actor was using multiple",
    "start": "574240",
    "end": "581360"
  },
  {
    "text": "zero day vulnerabilities in targeted attacks against multiple victims and our instance Response Team",
    "start": "581360",
    "end": "589360"
  },
  {
    "text": "quite quickly uncovered the first two vulnerabilities during the response but then there was in fact also",
    "start": "589360",
    "end": "596040"
  },
  {
    "text": "a third one that took a little bit more time to find",
    "start": "596040",
    "end": "601319"
  },
  {
    "text": "so what happened actually a week after this news first broke on August 1st the",
    "start": "605040",
    "end": "610920"
  },
  {
    "text": "US cyber security and infrastructure agency the security agency cisa and the Norwegian National cyber security Center",
    "start": "610920",
    "end": "618079"
  },
  {
    "text": "ncsc issued a joint advisory on on these attacks and the advisory is actually",
    "start": "618079",
    "end": "625200"
  },
  {
    "text": "quite interesting because it contains quite detailed information about the vulnerabilities and the AP Behavior",
    "start": "625200",
    "end": "631240"
  },
  {
    "text": "based on what was known on August 1st so I'm just going to quote a little",
    "start": "631240",
    "end": "636480"
  },
  {
    "text": "bit here the cisa and ncsc no are releasing this joint cyber security",
    "start": "636480",
    "end": "641839"
  },
  {
    "text": "advisory in response to active exploitation of CV 2023 35078 and CV 2023",
    "start": "641839",
    "end": "651240"
  },
  {
    "text": "35081 advanced persistent threat actors exploited these vulnerabilities as a survey from at least April 2023 through",
    "start": "651240",
    "end": "658560"
  },
  {
    "text": "July 202 23 to gather information from SE several Norwegian organizations as well as to",
    "start": "658560",
    "end": "665160"
  },
  {
    "text": "gain access to and compromise a Norwegian government agency",
    "start": "665160",
    "end": "670040"
  },
  {
    "text": "Network Ian released a patch for the first CBE on July 23rd they later",
    "start": "670600",
    "end": "676000"
  },
  {
    "text": "determined that that actors could use this in conjunction with another vulnerability and release a patch for",
    "start": "676000",
    "end": "681600"
  },
  {
    "text": "the second vulnerability on July 28th NCS ncsc now observed possible",
    "start": "681600",
    "end": "686800"
  },
  {
    "text": "vulnerability chaining so I'm I'm going to read all this but the point is that there's several",
    "start": "686800",
    "end": "694600"
  },
  {
    "text": "vulnerabilities in play and they were being used together and to understand what was",
    "start": "694600",
    "end": "699760"
  },
  {
    "text": "actually going on we need to take a few steps further back try to see what what",
    "start": "699760",
    "end": "705000"
  },
  {
    "text": "is actually evant the epmm what's it doing why would somebody attack this and",
    "start": "705000",
    "end": "710079"
  },
  {
    "text": "Alan is going to talk about that next uh yes um we can start by talking a",
    "start": "710079",
    "end": "719240"
  },
  {
    "text": "a little about uh ivanti and uh the company uh the ianti company was formed",
    "start": "719240",
    "end": "725360"
  },
  {
    "text": "by a merger of existing companies in 2017 and their product line is uh it",
    "start": "725360",
    "end": "733079"
  },
  {
    "text": "service management vulnerability management and security products it's a",
    "start": "733079",
    "end": "738440"
  },
  {
    "text": "private company which have uh acquired several other security companies and uh",
    "start": "738440",
    "end": "746120"
  },
  {
    "text": "in 2020 they acquired mobile iron and pull secure and risk sense in",
    "start": "746120",
    "end": "753760"
  },
  {
    "text": "2021 uh mobile iron is the product that we this talk is about after mobile Arin",
    "start": "753760",
    "end": "760720"
  },
  {
    "text": "was acquired it was renamed to ianti epmm formerly known as mobile iron",
    "start": "760720",
    "end": "768760"
  },
  {
    "text": "core this is the MDM solution that is used to manage and enroll end point and",
    "start": "768760",
    "end": "776000"
  },
  {
    "text": "end user devices and the mobile iron Sentry got renamed",
    "start": "776000",
    "end": "783279"
  },
  {
    "text": "to ivanti Sentry and is the excess solution that uh npoint devices used to",
    "start": "783279",
    "end": "790240"
  },
  {
    "text": "access internal company resources such as email via active",
    "start": "790240",
    "end": "796519"
  },
  {
    "text": "sync and also the epmm managed the entry so we have some internal apis both the",
    "start": "796959",
    "end": "805680"
  },
  {
    "text": "epmm and the Sentry is internet exposed since they are are dealing with endpoint devices and user devices that",
    "start": "805680",
    "end": "813199"
  },
  {
    "text": "are on the internet in people's homes and where whever people are working",
    "start": "813199",
    "end": "820120"
  },
  {
    "text": "from uh typical deployment of uh mobile iron architecture is that you have the",
    "start": "820120",
    "end": "827399"
  },
  {
    "text": "ianti fmm and the ianti Sentry exposed in the DM",
    "start": "827399",
    "end": "832639"
  },
  {
    "text": "set end users get their talks with the gets the deves enrolled and managed",
    "start": "832639",
    "end": "841360"
  },
  {
    "text": "by theant epmm and when they access their email and services they will go via theant",
    "start": "841360",
    "end": "849000"
  },
  {
    "text": "Sentry that acts as a gatekeeper and uh provide access to the resources they",
    "start": "849000",
    "end": "854399"
  },
  {
    "text": "need such as Microsoft",
    "start": "854399",
    "end": "858880"
  },
  {
    "text": "Exchange but next we will look at the",
    "start": "861399",
    "end": "866600"
  },
  {
    "text": "how the uh these products are deployed in",
    "start": "866600",
    "end": "873079"
  },
  {
    "text": "organizations those uh they are deployed as virtual",
    "start": "873120",
    "end": "881279"
  },
  {
    "text": "appliances and the underlying operating system is uh sent to us running apasi",
    "start": "881680",
    "end": "886959"
  },
  {
    "text": "web server and an apha tomcat and these applications are written in yava so they",
    "start": "886959",
    "end": "893639"
  },
  {
    "text": "will be running on the will be run by the apash tomet server",
    "start": "893639",
    "end": "900639"
  },
  {
    "text": "and for a from a vendor perspective we see that deploying products as",
    "start": "900639",
    "end": "905680"
  },
  {
    "text": "appliances have a huge benefit when it comes to being in full control over the runtime",
    "start": "905680",
    "end": "911360"
  },
  {
    "text": "environment there's a little variety and the vendor can easily support the",
    "start": "911360",
    "end": "917680"
  },
  {
    "text": "solution but it comes at the cost because the companies that have these appliances on their Network they lose",
    "start": "917680",
    "end": "925120"
  },
  {
    "text": "control in both visibility and uh control in these Appliance appliances are",
    "start": "925120",
    "end": "933560"
  },
  {
    "text": "patched so some examples are is are the logs the",
    "start": "933560",
    "end": "939800"
  },
  {
    "text": "devices produce are they accessible for the to integrate with the company's CM",
    "start": "939800",
    "end": "945279"
  },
  {
    "text": "Solutions is it possible to install EDR on the appliances to do monitoring of malicious behavor and",
    "start": "945279",
    "end": "955759"
  },
  {
    "text": "breaches and how is the OS services and application hardened and",
    "start": "955800",
    "end": "962160"
  },
  {
    "text": "patched and when it comes to incident response having an appliance makes it a",
    "start": "962160",
    "end": "969079"
  },
  {
    "text": "non-standard way to retrieve forensic evidence from these appliances in this case these are",
    "start": "969079",
    "end": "976279"
  },
  {
    "text": "virtual appliances so you have some leeway being able to pull me take memory",
    "start": "976279",
    "end": "981759"
  },
  {
    "text": "snapshots and dis snapshots in the virtual solution so I imagine Hardware",
    "start": "981759",
    "end": "987959"
  },
  {
    "text": "Appliances are even verse without being able to actually get a memory stepshot",
    "start": "987959",
    "end": "993920"
  },
  {
    "text": "without asking the vendor how to get access and installing the right forensic",
    "start": "993920",
    "end": "999240"
  },
  {
    "text": "tools on the devices in",
    "start": "999240",
    "end": "1006240"
  },
  {
    "text": "2020 a security researcher that is quite known a tanes uh guy called or I don't",
    "start": "1006240",
    "end": "1015399"
  },
  {
    "text": "think his name is orange s but everyone knows him at that he did a hatrick and found three",
    "start": "1015399",
    "end": "1021240"
  },
  {
    "text": "vulnerabilities in mobile iron it was a remote code execution V vulnerability",
    "start": "1021240",
    "end": "1027438"
  },
  {
    "text": "that uh worked through deserialization of hassian objects we",
    "start": "1027439",
    "end": "1032760"
  },
  {
    "text": "will come back to what hassian is as we we touched that in the",
    "start": "1032760",
    "end": "1039319"
  },
  {
    "text": "vulnerabilities that we looked at it was an authentication bypass vulnerability and an arbitrary file read vulnerability",
    "start": "1039319",
    "end": "1046839"
  },
  {
    "text": "and when these vulnerabilities were used in combination he was able to get a full",
    "start": "1046839",
    "end": "1053120"
  },
  {
    "text": "compromise over the target servers in his blog post he reported",
    "start": "1053120",
    "end": "1058960"
  },
  {
    "text": "these vulnerabilities to the vendor uh he wrote that U after he the",
    "start": "1058960",
    "end": "1064520"
  },
  {
    "text": "vendor had released patch Patches he waited for two weeks before he popped a",
    "start": "1064520",
    "end": "1070360"
  },
  {
    "text": "shell at Facebook and uh reported it through their bug Bounty",
    "start": "1070360",
    "end": "1076400"
  },
  {
    "text": "program and my guess is that the Facebook bug bug Bounty policy says",
    "start": "1076400",
    "end": "1082360"
  },
  {
    "text": "states that you need to give them two weeks",
    "start": "1082360",
    "end": "1088159"
  },
  {
    "text": "before uh zero day vulnerability is eligible for bug Bonte and also I think he specifically",
    "start": "1088159",
    "end": "1096200"
  },
  {
    "text": "Target Facebook because he found that they had a mobile iron",
    "start": "1096200",
    "end": "1101720"
  },
  {
    "text": "instance uh we will now look at the individual Rabil vulnerabilities but",
    "start": "1103520",
    "end": "1110880"
  },
  {
    "text": "first we will just summarize this quickly 3 years",
    "start": "1110880",
    "end": "1116640"
  },
  {
    "text": "later in uh summer late Early Autumn uh pneumonic",
    "start": "1116640",
    "end": "1123280"
  },
  {
    "text": "discovered through IRT cases three previously unknown serero day vulnerabilities that was used by a",
    "start": "1123280",
    "end": "1129799"
  },
  {
    "text": "threat actor the first one is an authentication bypass burnability and the epmm server",
    "start": "1129799",
    "end": "1137760"
  },
  {
    "text": "and exploitation of this allowed the attacker to call protected end points",
    "start": "1137760",
    "end": "1143520"
  },
  {
    "text": "that otherwise would require authentication it received the CVSs",
    "start": "1143520",
    "end": "1149440"
  },
  {
    "text": "score of 10 because it would give the attacker full administrative rights in",
    "start": "1149440",
    "end": "1155000"
  },
  {
    "text": "the rest apis the second vulnerability is a path",
    "start": "1155000",
    "end": "1161880"
  },
  {
    "text": "traversal VAB vulnerability and this one allowed the",
    "start": "1161880",
    "end": "1167640"
  },
  {
    "text": "attacker to write files to the disk at arbitrary locations",
    "start": "1167640",
    "end": "1172760"
  },
  {
    "text": "and this would uh lead to a remote code execution this was changed with chained",
    "start": "1172760",
    "end": "1179480"
  },
  {
    "text": "with the first vulnerability because the endpoint was also on the rest",
    "start": "1179480",
    "end": "1184760"
  },
  {
    "text": "API and the last vulnerability is the one that me and tul worked on",
    "start": "1185360",
    "end": "1190640"
  },
  {
    "text": "directly uh the one that took some time before actually was discovered the the advice",
    "start": "1190640",
    "end": "1198960"
  },
  {
    "text": "stated that they saw that the threat actor had been able to reach the ianti",
    "start": "1198960",
    "end": "1204960"
  },
  {
    "text": "Sentry but they couldn't tell how the two first vulner vulnerabilities was in",
    "start": "1204960",
    "end": "1212240"
  },
  {
    "text": "the epmm",
    "start": "1212240",
    "end": "1215000"
  },
  {
    "text": "instance so the full exploit chain where these individual vulnerabilities were",
    "start": "1217840",
    "end": "1224000"
  },
  {
    "text": "used the trctor would first compromise home rers in Norway",
    "start": "1224000",
    "end": "1229159"
  },
  {
    "text": "with the purpose of blending in with legitimate traffic towards the solution",
    "start": "1229159",
    "end": "1234960"
  },
  {
    "text": "and users that was using this solution were coming from Norwegian residential uh",
    "start": "1234960",
    "end": "1243000"
  },
  {
    "text": "rotors the first vul vulnerability was first used to do information gathering on the evant PM server and later they",
    "start": "1245000",
    "end": "1253760"
  },
  {
    "text": "would uh use the file path traval vulnerability to get remote code",
    "start": "1253760",
    "end": "1259080"
  },
  {
    "text": "execution and run their own code on the epmm and last they would pivot from the",
    "start": "1259080",
    "end": "1266600"
  },
  {
    "text": "epmm to the Avent Sentry using the third vulnerability and we think that the",
    "start": "1266600",
    "end": "1273919"
  },
  {
    "text": "entry server is a very high value Target for an for a threat actor because they",
    "start": "1273919",
    "end": "1279600"
  },
  {
    "text": "would gain access to the system that is protecting the resources they would like",
    "start": "1279600",
    "end": "1285360"
  },
  {
    "text": "to get access to so we will now look at these three",
    "start": "1285360",
    "end": "1291400"
  },
  {
    "text": "vulner vulnerabilities in a little bit more detail and uh I just want to note again",
    "start": "1291400",
    "end": "1297279"
  },
  {
    "text": "that me and to was not involved in discovery of the of the two first",
    "start": "1297279",
    "end": "1302640"
  },
  {
    "text": "vulnerabilities we just had the hands on on the last one the monic IRT found the",
    "start": "1302640",
    "end": "1309679"
  },
  {
    "text": "two first ones so the first one is authentication",
    "start": "1309679",
    "end": "1316159"
  },
  {
    "text": "bypass in the rest API normal use of this API require",
    "start": "1316159",
    "end": "1323400"
  },
  {
    "text": "authentication through basic authentication uh this API is well",
    "start": "1323400",
    "end": "1328880"
  },
  {
    "text": "documented and they state that all authenticated API functions",
    "start": "1328880",
    "end": "1335200"
  },
  {
    "text": "require basic authentication and uh the password is",
    "start": "1335200",
    "end": "1340960"
  },
  {
    "text": "not used by any other things than uh the the management of the",
    "start": "1340960",
    "end": "1347360"
  },
  {
    "text": "appliance but but there was a regression we think it was a regression that",
    "start": "1347360",
    "end": "1353520"
  },
  {
    "text": "happened with the past traversal uh pth validation in 2020 because Aid support",
    "start": "1353520",
    "end": "1361760"
  },
  {
    "text": "was uh added and then if an attacker would prefix the rest API rades with Ms",
    "start": "1361760",
    "end": "1370080"
  },
  {
    "text": "Aid they would bypass the authentication checks uh as we said we did not look at",
    "start": "1370080",
    "end": "1377080"
  },
  {
    "text": "the code for for this for vulnerability but we speculate that it was the path validation that regressed when aad",
    "start": "1377080",
    "end": "1384159"
  },
  {
    "text": "support was added exploitation of this vulner",
    "start": "1384159",
    "end": "1389760"
  },
  {
    "text": "vulnerability is as simple as just calling the endpoint with the with this",
    "start": "1389760",
    "end": "1397360"
  },
  {
    "text": "prefix and the cesa and the ncsc advisory state that the track dector used this vulnerability early in from",
    "start": "1397480",
    "end": "1405679"
  },
  {
    "text": "April to retrieve configur configuration such as Lup",
    "start": "1405679",
    "end": "1412000"
  },
  {
    "text": "endpoints doing Lup queres against the Windows domain server and list users",
    "start": "1412000",
    "end": "1419039"
  },
  {
    "text": "administrators of the epmm appliance and do configuration changes and check the audit logs to see if",
    "start": "1419039",
    "end": "1425880"
  },
  {
    "text": "they have been caught I suppose",
    "start": "1425880",
    "end": "1431159"
  },
  {
    "text": "and to we'll take the next vulnerability which is the part reversal one yeah so",
    "start": "1431159",
    "end": "1438480"
  },
  {
    "text": "so the first vulnerability is kind of bad by itself because it basically lets",
    "start": "1438480",
    "end": "1444760"
  },
  {
    "text": "anybody call the whole whole rest API without authentication",
    "start": "1444760",
    "end": "1450400"
  },
  {
    "text": "but it doesn't really get you any further at least not",
    "start": "1450400",
    "end": "1456919"
  },
  {
    "text": "directly so this second vulnerability is probably the most obscure of the three I",
    "start": "1456919",
    "end": "1463200"
  },
  {
    "text": "haven't seen any really good writeups about it and I actually haven't seen the working exploit for it myself",
    "start": "1463200",
    "end": "1469120"
  },
  {
    "text": "but based on what's public information it should be fairly straightforward to re recreate it if you have the time and",
    "start": "1469120",
    "end": "1476240"
  },
  {
    "text": "want to put in the effort to do it but hopefully everybody as patch know",
    "start": "1476240",
    "end": "1481279"
  },
  {
    "text": "right so the first vulnerability lets the threat actor bypass access controls on",
    "start": "1481279",
    "end": "1487440"
  },
  {
    "text": "the API and so from an offensive perspective what you want to do next is to actually get",
    "start": "1487440",
    "end": "1493840"
  },
  {
    "text": "into the DM and and establish presence there and this is the way the did",
    "start": "1493840",
    "end": "1499600"
  },
  {
    "text": "it so there is an API endpoint which was",
    "start": "1499600",
    "end": "1506520"
  },
  {
    "text": "supposed to be internal I think at least it's not very well documented but it's called import",
    "start": "1506520",
    "end": "1511679"
  },
  {
    "text": "configuration and so what that does is actually let you import a configuration file to the",
    "start": "1511679",
    "end": "1518360"
  },
  {
    "text": "device and so of course because of the first vulnerability the attackers were able to",
    "start": "1518360",
    "end": "1526080"
  },
  {
    "text": "um call this API so and then the second vulnerability was",
    "start": "1526080",
    "end": "1531880"
  },
  {
    "text": "that this API actually didn't correctly validate where you were putting the file",
    "start": "1531880",
    "end": "1537159"
  },
  {
    "text": "so you could put the path reversal into the file name to overwrite files on the",
    "start": "1537159",
    "end": "1544399"
  },
  {
    "text": "device and you are writing those files with uh",
    "start": "1544399",
    "end": "1550320"
  },
  {
    "text": "basically with the permissions of the Tomcat server but well uh the Tom server is happily",
    "start": "1550320",
    "end": "1559799"
  },
  {
    "text": "going to let you execute jsps and you are and it can of course",
    "start": "1559799",
    "end": "1566440"
  },
  {
    "text": "write or overwrite its own files so what actually happened was",
    "start": "1566440",
    "end": "1575360"
  },
  {
    "text": "that um the threat actor actually overwrote the HTTP 415 error Handler with the",
    "start": "1575399",
    "end": "1582159"
  },
  {
    "text": "custom loader and so everybody here knows what HTTP 415 is",
    "start": "1582159",
    "end": "1587240"
  },
  {
    "text": "right it's unsupported media type so what happened next is that they",
    "start": "1587240",
    "end": "1593840"
  },
  {
    "text": "would send requests with an invalid content type and the server would say that oh I",
    "start": "1593840",
    "end": "1601080"
  },
  {
    "text": "we didn't know how to handle this so we're going to return HTTP 415 and then that",
    "start": "1601080",
    "end": "1607360"
  },
  {
    "text": "calls the JSP which they uploaded using",
    "start": "1607360",
    "end": "1612520"
  },
  {
    "text": "the vulnerability and so at that point",
    "start": "1612520",
    "end": "1619000"
  },
  {
    "text": "they could send requests that would go straight into their loader and kind of ser T go bur they basically sent Java B",
    "start": "1619000",
    "end": "1627120"
  },
  {
    "text": "code in bootst uh webshell in memory so so that's kind of neat uh",
    "start": "1627120",
    "end": "1635279"
  },
  {
    "text": "shouldn't happen but that's how they did it",
    "start": "1635279",
    "end": "1641120"
  },
  {
    "text": "so that's vulnerability number two you basically have a webshell in memory on",
    "start": "1641120",
    "end": "1646520"
  },
  {
    "text": "the epmm device in the DM so it's a good start uh what you do next well what this threat actor did",
    "start": "1646520",
    "end": "1655480"
  },
  {
    "text": "next was to clean up their stuff so they replaced their initial loader again with",
    "start": "1655480",
    "end": "1660919"
  },
  {
    "text": "the correct error Handler and they deleted their logs because they were using a specific user agent they could",
    "start": "1660919",
    "end": "1668279"
  },
  {
    "text": "selectively delete those log entries and once this had happened they",
    "start": "1668279",
    "end": "1673840"
  },
  {
    "text": "were pivoting so you're in the DMZ but you're on the EPM and you want to get to",
    "start": "1673840",
    "end": "1679799"
  },
  {
    "text": "the good stuff so and these guys clearly came prepared so the next step was ready for",
    "start": "1679799",
    "end": "1687919"
  },
  {
    "text": "them and that brings us to the third vulnerability which was the one that we were involved in",
    "start": "1688480",
    "end": "1696279"
  },
  {
    "text": "finding and again I would just like to to underline the teamwork here",
    "start": "1696279",
    "end": "1702240"
  },
  {
    "text": "because what actually happened here is kind of funny um I was on a combination",
    "start": "1702240",
    "end": "1708320"
  },
  {
    "text": "of Parental leave and vacation last summer so I've been away from from work for several months mining my own",
    "start": "1708320",
    "end": "1714200"
  },
  {
    "text": "business and I've picked up from the news that there's an instant going on and O sounds interesting kind of",
    "start": "1714200",
    "end": "1721519"
  },
  {
    "text": "um know nothing about it and then my phone",
    "start": "1721519",
    "end": "1726880"
  },
  {
    "text": "rings and so there's a message um yeah so there's activity on the",
    "start": "1727240",
    "end": "1734559"
  },
  {
    "text": "Sentry Appliance following an HTTP called to an to an internal undocumented",
    "start": "1734559",
    "end": "1741440"
  },
  {
    "text": "service and basically the instant Response Team knows that there's a bug here or",
    "start": "1741440",
    "end": "1748919"
  },
  {
    "text": "approximately here can you help us find it okay challenge accepted so my",
    "start": "1748919",
    "end": "1755679"
  },
  {
    "text": "daughter takes an app and I find my work laptop and log in and start to figure out what's what's going",
    "start": "1755679",
    "end": "1763000"
  },
  {
    "text": "on and um so basically what happens is that the",
    "start": "1763159",
    "end": "1769399"
  },
  {
    "text": "Sentry Appliance exposes two interfaces there's the internet",
    "start": "1769399",
    "end": "1774720"
  },
  {
    "text": "facing interface in Port 443 which is used by approved devices to access their",
    "start": "1774720",
    "end": "1780200"
  },
  {
    "text": "email and calendars and other stuff right so Sentry is working as an access Gateway and policy enforcement point for",
    "start": "1780200",
    "end": "1786519"
  },
  {
    "text": "those Services then there's also an internal interface uh on Port 8443 which isn't or",
    "start": "1786519",
    "end": "1794679"
  },
  {
    "text": "at least shouldn't be internet exposed but it's used to communicate with the other parts of the mobile Ron",
    "start": "1794679",
    "end": "1801279"
  },
  {
    "text": "installation so in particular it's it's the epmm or mobile and core service",
    "start": "1801279",
    "end": "1807799"
  },
  {
    "text": "should be calling this to to give centry information on what traffic to allow and which users are defined and so",
    "start": "1807799",
    "end": "1814399"
  },
  {
    "text": "on and mics mobile R in configuration Service uh mics log service it it sounds",
    "start": "1814399",
    "end": "1821240"
  },
  {
    "text": "like something that handles logs right so it's not documented it's internal Plumbing for for these appliances",
    "start": "1821240",
    "end": "1828679"
  },
  {
    "text": "and it's kind of funny because the joint advisory from August 1st kind of confirms that something is going on here",
    "start": "1828679",
    "end": "1836799"
  },
  {
    "text": "the AP actors were tunneling traffic from the internet through evant Sentry and we don't know how they got",
    "start": "1836799",
    "end": "1842640"
  },
  {
    "text": "there and uh there's some files that have been appearing on this device but",
    "start": "1842640",
    "end": "1848559"
  },
  {
    "text": "we're not sure how they how how it got there either so okay something going",
    "start": "1848559",
    "end": "1854960"
  },
  {
    "text": "on so I'm kind of trying to recall my thought process uh I started by unpacking the war file for the uh ianti",
    "start": "1855159",
    "end": "1863919"
  },
  {
    "text": "software and just looking around the application structure uh specifically looking for",
    "start": "1863919",
    "end": "1869880"
  },
  {
    "text": "this mics log service and how it's mapped and and kind of which classes are implementing this",
    "start": "1869880",
    "end": "1875720"
  },
  {
    "text": "service and it turns out that the application Maps up two private endpoints both sounds kind of",
    "start": "1875720",
    "end": "1882519"
  },
  {
    "text": "interesting um it uses htin for RPC which is really weird I've never seen h",
    "start": "1882519",
    "end": "1888200"
  },
  {
    "text": "before it's it's a kind of old RPC framework and I sidetracked a bit to",
    "start": "1888200",
    "end": "1893360"
  },
  {
    "text": "read about hen and and and stumbled upon the blog post by Orange from 2020 about",
    "start": "1893360",
    "end": "1898919"
  },
  {
    "text": "the vulnerabilities that he found and it doesn't really get me anywhere but it increases my confidence that yeah this",
    "start": "1898919",
    "end": "1906360"
  },
  {
    "text": "looks dodgy there might be something here but I I have no idea how to make a syntactically correct hn RPC call but I",
    "start": "1906360",
    "end": "1913919"
  },
  {
    "text": "read enough about this to to be fairly confident that if somebody someone does",
    "start": "1913919",
    "end": "1919120"
  },
  {
    "text": "a post to this mics log service it's going to be be wired to a specific class",
    "start": "1919120",
    "end": "1924519"
  },
  {
    "text": "and it's possible to invoke arbitary methods on that class okay so let's decompile it and see what it",
    "start": "1924519",
    "end": "1931360"
  },
  {
    "text": "does so I unpack the jar file find the class decompile it open it in vim and it",
    "start": "1931360",
    "end": "1938919"
  },
  {
    "text": "looks kind of like this",
    "start": "1938919",
    "end": "1944559"
  },
  {
    "text": "um so there's anybody here a problem",
    "start": "1945760",
    "end": "1950360"
  },
  {
    "text": "here um yeah there's a there's a problem so uh this looks like the kind of likely",
    "start": "1950880",
    "end": "1958240"
  },
  {
    "text": "candidate for the uh command execution Vector that I was looking for right to",
    "start": "1958240",
    "end": "1963440"
  },
  {
    "text": "to spell it out basically the code takes a command string from the request and execute executes it without looking at",
    "start": "1963440",
    "end": "1970000"
  },
  {
    "text": "what it does and it turns out that the running process actually has sud pites",
    "start": "1970000",
    "end": "1975200"
  },
  {
    "text": "on the device so basically you can invoke this endpoint with Pudo and root",
    "start": "1975200",
    "end": "1980240"
  },
  {
    "text": "the Appliance on the spot so that's kind of",
    "start": "1980240",
    "end": "1985760"
  },
  {
    "text": "bad um but then I spent a little bit of time looking at this",
    "start": "1986320",
    "end": "1992360"
  },
  {
    "text": "and my time pretty soon runs out and my daughter starts sending prior priority interrupts and I end up writing kind of",
    "start": "1992360",
    "end": "1998960"
  },
  {
    "text": "this really short write up saying that yeah this is the problem um could somebody kind of make a bu for for this",
    "start": "1998960",
    "end": "2006320"
  },
  {
    "text": "and handle it with Devante and I kick the ball back over the fence and I'm pretty confident that things are being",
    "start": "2006320",
    "end": "2014159"
  },
  {
    "text": "handled yes so I was the lucky one to catch to Ling",
    "start": "2015760",
    "end": "2021760"
  },
  {
    "text": "ball with the notes which I didn't look at in the beginning so I started over",
    "start": "2021760",
    "end": "2026960"
  },
  {
    "text": "again decompiling the VAR file looking at the hium protocol we had some",
    "start": "2026960",
    "end": "2034159"
  },
  {
    "text": "information about which endpoint that was being called so I found same vulnerable class but also found orange",
    "start": "2034159",
    "end": "2041799"
  },
  {
    "text": "previous V vulnerability that was for the epmm server and it was a",
    "start": "2041799",
    "end": "2047159"
  },
  {
    "text": "distalization vulnerability so then I started wondering if they had the same issue on",
    "start": "2047159",
    "end": "2055720"
  },
  {
    "text": "the Sentry as they had on the epmm back in 2020 so looking at that all new to hin",
    "start": "2055720",
    "end": "2065320"
  },
  {
    "text": "myself as well and had never seen in this protocol before but from the configuration I could easily see that it",
    "start": "2065320",
    "end": "2073118"
  },
  {
    "text": "was configured securely and not to accept any other strange objects except",
    "start": "2073119",
    "end": "2078679"
  },
  {
    "text": "a few and some basic data types so I could conclude that it was not",
    "start": "2078679",
    "end": "2085040"
  },
  {
    "text": "vulnerable and I could pull myself out of this rabbit hole and actually read toling",
    "start": "2085040",
    "end": "2091720"
  },
  {
    "text": "note and when I read it I was a little bit baffled because it seemed",
    "start": "2091720",
    "end": "2098880"
  },
  {
    "text": "a little too good to be true could I just call this endpoint do I need to",
    "start": "2098880",
    "end": "2104079"
  },
  {
    "text": "actually do anything I had to do a little bit uh I",
    "start": "2104079",
    "end": "2109680"
  },
  {
    "text": "needed to have a appliance to test against U so I got some help to to set",
    "start": "2109680",
    "end": "2114880"
  },
  {
    "text": "that up and uh have a Target environment to actually make a proof of concept or",
    "start": "2114880",
    "end": "2121160"
  },
  {
    "text": "else I wouldn't be able to see if it if it would work luckily I also did not",
    "start": "2121160",
    "end": "2127400"
  },
  {
    "text": "have to write Anya because someone had made uh Hasen library in Python which",
    "start": "2127400",
    "end": "2133320"
  },
  {
    "text": "made my life much easier and the proof of concept was as",
    "start": "2133320",
    "end": "2138680"
  },
  {
    "text": "simple as just calling a method with the right set of",
    "start": "2138680",
    "end": "2144040"
  },
  {
    "text": "parameters and luckily since it's Java it support it supports null types so I",
    "start": "2144040",
    "end": "2149800"
  },
  {
    "text": "didn't actually have to fill in all the boiler plate for the dto I could just",
    "start": "2149800",
    "end": "2155200"
  },
  {
    "text": "fill in the I I used the the parameters that was used prior to the dangerous",
    "start": "2155200",
    "end": "2161880"
  },
  {
    "text": "system call and uh the proof of concept what I",
    "start": "2161880",
    "end": "2167760"
  },
  {
    "text": "chose was to point it at the Sentry server with the command touch Temp",
    "start": "2167760",
    "end": "2174280"
  },
  {
    "text": "rce and uh if it worked then it would create a",
    "start": "2174280",
    "end": "2180520"
  },
  {
    "text": "file named RC on the Sentry server and this was what happened uh",
    "start": "2180520",
    "end": "2188200"
  },
  {
    "text": "and then I could go back to to sleep as well because my I woke up from uh",
    "start": "2188200",
    "end": "2196040"
  },
  {
    "text": "putting my kids to sleep and I picked up this ball and then I fall asleep myself so the time stamp is a bit late and it",
    "start": "2196040",
    "end": "2203560"
  },
  {
    "text": "the time zone is wrong you should add a couple of hours",
    "start": "2203560",
    "end": "2209680"
  },
  {
    "text": "so back to tour yeah so um that was",
    "start": "2209680",
    "end": "2215040"
  },
  {
    "text": "basically the exploit chain for for for for evante uh mobile iron uh so",
    "start": "2215040",
    "end": "2222400"
  },
  {
    "text": "so basically accessing the API doing the path reversal and then pivoting to the",
    "start": "2222400",
    "end": "2228040"
  },
  {
    "text": "to the Sentry server uh I'm going to say a little bit about disclosure so so",
    "start": "2228040",
    "end": "2233200"
  },
  {
    "text": "actually all the dialogue with Ian was handled by the neonic instant response team because they were already in kind",
    "start": "2233200",
    "end": "2239280"
  },
  {
    "text": "of direct contact after the first vulnerabilities uh properly fixing this",
    "start": "2239280",
    "end": "2245560"
  },
  {
    "text": "last one took a c couple of weeks and I guess",
    "start": "2245560",
    "end": "2251040"
  },
  {
    "text": "um probably there were some kind of legit legitimate use cases for this API",
    "start": "2251040",
    "end": "2256960"
  },
  {
    "text": "that had to be properly fixed and not just uh they could they couldn't just",
    "start": "2256960",
    "end": "2262400"
  },
  {
    "text": "kind of block it uh but I I would say that things were",
    "start": "2262400",
    "end": "2268000"
  },
  {
    "text": "handled quickly and from from at least from my perspective smoothly and obviously that's a lot easier when",
    "start": "2268000",
    "end": "2274960"
  },
  {
    "text": "you have a line of communications and don't have to kind of dig up as Security contact that grinder as as uh Troy was talking",
    "start": "2274960",
    "end": "2282359"
  },
  {
    "text": "about in the previous talk so but my my impression was that once we got to this",
    "start": "2282359",
    "end": "2287480"
  },
  {
    "text": "stage that kind of the process worked and things got fixed so a fun thing here is that all these",
    "start": "2287480",
    "end": "2295119"
  },
  {
    "text": "three vulnerabilities were added to cesa known exploited vulnerabilities or Kev catalog and if you're not familiar with",
    "start": "2295119",
    "end": "2302240"
  },
  {
    "text": "the Kev cat log it's a it's an authorative source of vulnerabilities that are known to be exploited in the",
    "start": "2302240",
    "end": "2307880"
  },
  {
    "text": "wild that cesa maintains and as they put it you can use the Kev as an input your",
    "start": "2307880",
    "end": "2313240"
  },
  {
    "text": "vulnerability management priori prioritization treatment framework because it's the stuff that's",
    "start": "2313240",
    "end": "2320000"
  },
  {
    "text": "known to be exploited by threat actors in the wild so maybe you should prioritize it uh irland has a few a few",
    "start": "2320000",
    "end": "2325920"
  },
  {
    "text": "CVS here from before because he's he keeps up digging digging up crazy vulnerabilities but this was the first",
    "start": "2325920",
    "end": "2331520"
  },
  {
    "text": "for me at least so as we promised",
    "start": "2331520",
    "end": "2338400"
  },
  {
    "text": "in the beginning we're we're we're approaching the end of our script here but I'd like to just return to some of",
    "start": "2338400",
    "end": "2344359"
  },
  {
    "text": "our our subjective Lessons Learned and takeaways from this whole Affair um and",
    "start": "2344359",
    "end": "2350040"
  },
  {
    "text": "we're just going to talk about each of these in a little bit more detail so email remains a juicy Target blackbox",
    "start": "2350040",
    "end": "2356200"
  },
  {
    "text": "appliances are challenging centralized logging is wonderful geolocation doesn't really help against",
    "start": "2356200",
    "end": "2362640"
  },
  {
    "text": "targeted attacks vulnerabilities are often surprisingly simple if you look in the",
    "start": "2362640",
    "end": "2368000"
  },
  {
    "text": "right place and finally what does this incident tell us about what the threat actors are",
    "start": "2368000",
    "end": "2374160"
  },
  {
    "text": "doing so to the to the first point I think it's still a little bit",
    "start": "2374160",
    "end": "2379400"
  },
  {
    "text": "astonishing to me how much stuff runs over email which turned 50 years A couple of years ago it's old Tech and it",
    "start": "2379400",
    "end": "2386800"
  },
  {
    "text": "was it's technology that was really made in a different era with a different set of assumptions from kind of what we have",
    "start": "2386800",
    "end": "2393520"
  },
  {
    "text": "to deal with today and I think attacks on email and email",
    "start": "2393520",
    "end": "2399760"
  },
  {
    "text": "infrastructure are kind of 13 a dozen whether that's in the cloud or on Prem or let's not even start discussing",
    "start": "2399760",
    "end": "2407119"
  },
  {
    "text": "fishing and spare fishing and all of that but one of my personal Impressions over the last few months is that on-prem",
    "start": "2407119",
    "end": "2414480"
  },
  {
    "text": "securing on-prem exchange is really becoming really hard and it's old and it's large and it's complicated and",
    "start": "2414480",
    "end": "2420280"
  },
  {
    "text": "Microsoft atten Microsoft's attention is on the cloud services and at the same",
    "start": "2420280",
    "end": "2426119"
  },
  {
    "text": "time exchange is full of stuff that attackers want and I think the only real way forward to deal with that is to try to",
    "start": "2426119",
    "end": "2432520"
  },
  {
    "text": "reduce the value of email as a Target and try to try to fragment your services a",
    "start": "2432520",
    "end": "2438400"
  },
  {
    "text": "little bit more move start replacing email as a kind of one size fits all technology to with with stuff that's",
    "start": "2438400",
    "end": "2446079"
  },
  {
    "text": "modern and defensible and that can actually be used",
    "start": "2446079",
    "end": "2451720"
  },
  {
    "text": "securely I think as this talk also shows we also have to consider email adjacent",
    "start": "2451720",
    "end": "2458319"
  },
  {
    "text": "infrastructure such as MDM and I think that MDM is actually kind of interesting",
    "start": "2458319",
    "end": "2463560"
  },
  {
    "text": "as a Target in its own right because it's I mean it's used to manage devices right and depending on your setup there could",
    "start": "2463560",
    "end": "2470520"
  },
  {
    "text": "be quite a significant degree of control over those devices that are",
    "start": "2470520",
    "end": "2475720"
  },
  {
    "text": "enrolled so there's also that to consider when it comes to blackbox",
    "start": "2475720",
    "end": "2483119"
  },
  {
    "text": "appliances I think it's fair to say that this is a pretty popular way",
    "start": "2483119",
    "end": "2489280"
  },
  {
    "text": "to distribute software at least in cases where that haven't gone fully",
    "start": "2489280",
    "end": "2495200"
  },
  {
    "text": "containerized yet and I think most larger organizations have a number of these",
    "start": "2495200",
    "end": "2500400"
  },
  {
    "text": "black boxes on the network you don't really know what they're doing they're just sitting there doing doing stuff but you don't know how it works and this",
    "start": "2500400",
    "end": "2507720"
  },
  {
    "text": "creates certain problems for cyber defense because there is less visibility you might not even have",
    "start": "2507720",
    "end": "2514319"
  },
  {
    "text": "access to the Appliance without vendor cooporation uh the options for logging and monitoring and getting data off the",
    "start": "2514319",
    "end": "2520319"
  },
  {
    "text": "device might be limited to whatever the vendor is supporting uh stuff like EDR to kind of",
    "start": "2520319",
    "end": "2527079"
  },
  {
    "text": "inspect what's going on on on the machine at runtime might not be possible",
    "start": "2527079",
    "end": "2532960"
  },
  {
    "text": "and generally it makes instance response harder in this case",
    "start": "2532960",
    "end": "2539040"
  },
  {
    "text": "and there's clearly a supply chain component to this [Music]",
    "start": "2539040",
    "end": "2546000"
  },
  {
    "text": "so uh both because of all these practical issues of getting access and getting the data you need but also because I mean in",
    "start": "2546000",
    "end": "2553319"
  },
  {
    "text": "most cases it's hard to assess the appliance and the vendor security posture and I think a lot of places you",
    "start": "2553319",
    "end": "2558880"
  },
  {
    "text": "don't really think all that hard about that risk",
    "start": "2558880",
    "end": "2564119"
  },
  {
    "text": "but as security practitioners we really need to do we really need to ask tough questions of vendors and try to get the",
    "start": "2564119",
    "end": "2571000"
  },
  {
    "text": "visibility and tooling we need to defend uh",
    "start": "2571000",
    "end": "2576119"
  },
  {
    "text": "everything third Point logging and monitoring and",
    "start": "2576119",
    "end": "2582040"
  },
  {
    "text": "that's something that was really gold here uh we saw that the threat actor was",
    "start": "2582040",
    "end": "2587920"
  },
  {
    "text": "quite active actively deleting their logs and the only way the only real way to",
    "start": "2587920",
    "end": "2595200"
  },
  {
    "text": "deal with that is to make sure that you're getting the logs of device in real time and you're able to monitor",
    "start": "2595200",
    "end": "2602240"
  },
  {
    "text": "them in real time otherwise it's really tough to defend against something that",
    "start": "2602240",
    "end": "2607839"
  },
  {
    "text": "you're not able to detect um another point about instant response",
    "start": "2607839",
    "end": "2613400"
  },
  {
    "text": "is that um you do need to have enough",
    "start": "2613400",
    "end": "2618440"
  },
  {
    "text": "retention uh you know that the time between the time between initial attack",
    "start": "2618440",
    "end": "2624559"
  },
  {
    "text": "reactivity in April and kind of things being discovered in early July that's a",
    "start": "2624559",
    "end": "2629800"
  },
  {
    "text": "few months uh if you have three months of retention that might be a problem you",
    "start": "2629800",
    "end": "2634920"
  },
  {
    "text": "you might want to more uh you also need to make sure that the logs are in fact available to to search",
    "start": "2634920",
    "end": "2642720"
  },
  {
    "text": "and analyze in real time during inent response if it's if it takes you a week",
    "start": "2642720",
    "end": "2648440"
  },
  {
    "text": "to get kind of the logs up and running and for analysis then that's uh time",
    "start": "2648440",
    "end": "2653920"
  },
  {
    "text": "spent",
    "start": "2653920",
    "end": "2656280"
  },
  {
    "text": "waiting U we noted that the typical end user of",
    "start": "2661400",
    "end": "2666880"
  },
  {
    "text": "the solution was working from home and we find it peculiar how the trator would",
    "start": "2666880",
    "end": "2673800"
  },
  {
    "text": "hide themselves by pivoting traffic from the Norwegian residential",
    "start": "2673800",
    "end": "2680119"
  },
  {
    "text": "rotors this mean that limiting access using geolocation or or monitoring by",
    "start": "2681240",
    "end": "2687359"
  },
  {
    "text": "hper reputation would not be an effect effective control to to block or detect",
    "start": "2687359",
    "end": "2693240"
  },
  {
    "text": "this type of uh trctor but we don't want to pull the",
    "start": "2693240",
    "end": "2698880"
  },
  {
    "text": "rug completely away from geolocation and Hyper reputation because it's still possible to stop opportunistic and lefts",
    "start": "2698880",
    "end": "2707720"
  },
  {
    "text": "sophisticated threat dectors using",
    "start": "2707720",
    "end": "2711960"
  },
  {
    "text": "geolocation um when it comes to vulnerability hunting",
    "start": "2713319",
    "end": "2719680"
  },
  {
    "text": "uh we got good hints from the IRT team",
    "start": "2719680",
    "end": "2724880"
  },
  {
    "text": "about where to look we are forensic evidence and the vulnerabilities that we that was",
    "start": "2724880",
    "end": "2731119"
  },
  {
    "text": "discovered was quite simple and it was not exactly rocket surgery it was path validation flaws",
    "start": "2731119",
    "end": "2738559"
  },
  {
    "text": "unprotected privileged apis and dangerous system calls and once you see",
    "start": "2738559",
    "end": "2745359"
  },
  {
    "text": "this they are both easy to understand that these are vulnerabilities and it's",
    "start": "2745359",
    "end": "2750440"
  },
  {
    "text": "easy to weaponize this and with this in mind we believe it's easy to find new",
    "start": "2750440",
    "end": "2756640"
  },
  {
    "text": "bug as soon as you start looking at the right places uh I believe that this software",
    "start": "2756640",
    "end": "2764119"
  },
  {
    "text": "suit had some frictions that made it hard for other pen testers or researchers to actually look at these",
    "start": "2764119",
    "end": "2772960"
  },
  {
    "text": "vulnerable parts or else I would assume that they had been detected a long time",
    "start": "2772960",
    "end": "2781040"
  },
  {
    "text": "ago so obscure enterprise software and undocumented internals are a good place",
    "start": "2781040",
    "end": "2786960"
  },
  {
    "text": "to look if you want to find new vulnerabilities and in monic when we are",
    "start": "2786960",
    "end": "2792720"
  },
  {
    "text": "doing red teaming uh and have the need to find new vulnerabilities we have a",
    "start": "2792720",
    "end": "2799040"
  },
  {
    "text": "rather counterintuitive metric that we use so if we are a tech",
    "start": "2799040",
    "end": "2804559"
  },
  {
    "text": "organization want to see what software that is internet exposed or as some software we want to to attack we look",
    "start": "2804559",
    "end": "2812559"
  },
  {
    "text": "them up at cve details and the less vulner vulnerabilities that we can find the better so it's like uh we know that",
    "start": "2812559",
    "end": "2820440"
  },
  {
    "text": "this is a place uh no pent tester has gone before so we hope for a low hanging",
    "start": "2820440",
    "end": "2826440"
  },
  {
    "text": "fruits so yes yeah so wrapping wrapping up some",
    "start": "2826440",
    "end": "2833720"
  },
  {
    "text": "some final observations about the AP in this case and their behavior I was",
    "start": "2833720",
    "end": "2839920"
  },
  {
    "text": "really surprised by the number of different vulnerabilities used by this threat actor so what we've looked at in",
    "start": "2839920",
    "end": "2845760"
  },
  {
    "text": "this talk is the vulnerability in ivante but then beyond that they were also compromising home routers and attacking",
    "start": "2845760",
    "end": "2850920"
  },
  {
    "text": "exchange and doing kind of doing stuff and my personal belief is that they were",
    "start": "2850920",
    "end": "2859440"
  },
  {
    "text": "doing this because they did not think they would be detected or that at least the the risk of being detected and kind",
    "start": "2859440",
    "end": "2864800"
  },
  {
    "text": "of out outweigh the risk of burning their Zer days and but even so I mean they were",
    "start": "2864800",
    "end": "2872079"
  },
  {
    "text": "also attacking multiple victims within the same same time period so so trying",
    "start": "2872079",
    "end": "2878200"
  },
  {
    "text": "to get the most I guess buy for the book I think by by extrapolation for",
    "start": "2878200",
    "end": "2884640"
  },
  {
    "text": "from this looking at kind of what effort do you need to put in uh",
    "start": "2884640",
    "end": "2891000"
  },
  {
    "text": "in terms of vulnerability research to find all of this uh from first principles not kind",
    "start": "2891000",
    "end": "2896720"
  },
  {
    "text": "of being guided as we were by forensic evidence uh and and kind of if you",
    "start": "2896720",
    "end": "2903200"
  },
  {
    "text": "extrapolate from that I guess that there's significant vulnerability research going going into similar product types that are interet facing",
    "start": "2903200",
    "end": "2910359"
  },
  {
    "text": "and obscure and kind of can provide a way into interesting",
    "start": "2910359",
    "end": "2916640"
  },
  {
    "text": "networks another observation is that this threat actor spent quite some",
    "start": "2916640",
    "end": "2921680"
  },
  {
    "text": "effort not to touch dis and and particularly not to leave malware lying around the",
    "start": "2921680",
    "end": "2927000"
  },
  {
    "text": "dis and so that meant that trying to figure out what was going on memory",
    "start": "2927000",
    "end": "2934520"
  },
  {
    "text": "forensics became quite quickly the name of the game",
    "start": "2934520",
    "end": "2938720"
  },
  {
    "text": "um and and of course this entire exercise of going proing via home",
    "start": "2939559",
    "end": "2946480"
  },
  {
    "text": "routers and coming from the region IP addresses meant that they were doing what they could to blend into regular traffic and kind of not being obvious",
    "start": "2946480",
    "end": "2953799"
  },
  {
    "text": "about about it uh I think it's a safe bet that these",
    "start": "2953799",
    "end": "2958880"
  },
  {
    "text": "techniques are going to trickle down into more General use also by less Advanced threats as we move along um and",
    "start": "2958880",
    "end": "2965839"
  },
  {
    "text": "I think we could probably spend spend quite a lot of time speculating And discussing this further but I think it this is a good time to wrap up the main",
    "start": "2965839",
    "end": "2972040"
  },
  {
    "text": "portion of the talk and let's let's continue the discussion in the QA and",
    "start": "2972040",
    "end": "2977440"
  },
  {
    "text": "[Applause]",
    "start": "2979860",
    "end": "2989370"
  },
  {
    "text": "afterwards any questions uh apart from suspicion do we",
    "start": "2990240",
    "end": "2996480"
  },
  {
    "text": "have the indicators for attribution uh the question is if we",
    "start": "2996480",
    "end": "3001680"
  },
  {
    "text": "have any indicators for attribution uh there there's not been any public attribution of this threat actor I think",
    "start": "3001680",
    "end": "3009359"
  },
  {
    "text": "I'm not going to name any I'm I'm not going to speculate on that here I think if you kind",
    "start": "3009359",
    "end": "3015200"
  },
  {
    "text": "of if you if you kind of pick uh three likely candidates then possibly it would",
    "start": "3015200",
    "end": "3021599"
  },
  {
    "text": "be one of those but",
    "start": "3021599",
    "end": "3028640"
  },
  {
    "text": "anyone else Martin that if you get did you get any samples or on your traces you said",
    "start": "3029400",
    "end": "3036480"
  },
  {
    "text": "that they avoided it but did you get anything out",
    "start": "3036480",
    "end": "3042240"
  },
  {
    "text": "uh I'm not the right person to answer that uh I think the CA and CSC report",
    "start": "3042240",
    "end": "3051520"
  },
  {
    "text": "might have said something on it yeah the the one thing that was public was the the way they deleted logs and uh remove",
    "start": "3051520",
    "end": "3059680"
  },
  {
    "text": "their traces so that was like their way of hiding",
    "start": "3059680",
    "end": "3065440"
  },
  {
    "text": "up uh I I'm I'm I'm unable to to go to go into",
    "start": "3065440",
    "end": "3072280"
  },
  {
    "text": "detail that I'm sorry but also the also the uh webshell that they used it was",
    "start": "3072280",
    "end": "3078000"
  },
  {
    "text": "made to run arbitrary code so at the first stage attack was would be able to",
    "start": "3078000",
    "end": "3084480"
  },
  {
    "text": "run any yava bite code so so that's so so it could be",
    "start": "3084480",
    "end": "3091599"
  },
  {
    "text": "anything in the",
    "start": "3093280",
    "end": "3096640"
  },
  {
    "text": "back yeah yeah I can try to explain uh so the",
    "start": "3101319",
    "end": "3107559"
  },
  {
    "text": "question was the pre if I understand it correctly was the prefixing of the API",
    "start": "3107559",
    "end": "3112599"
  },
  {
    "text": "uh and so if we if you go all the way back if",
    "start": "3112599",
    "end": "3118119"
  },
  {
    "text": "you go all the way back here I guess so I think the point was that in 2020",
    "start": "3118119",
    "end": "3125480"
  },
  {
    "text": "they made a new API which was used for aser ad or I guess entro ID",
    "start": "3125480",
    "end": "3131280"
  },
  {
    "text": "integration which was prefixed by/ myth a and",
    "start": "3131280",
    "end": "3138920"
  },
  {
    "text": "uh apparently as part of doing this they",
    "start": "3138920",
    "end": "3144559"
  },
  {
    "text": "something happened with the path for validation uh expression or they manag",
    "start": "3144559",
    "end": "3149799"
  },
  {
    "text": "to map up the rest of the service API accidentally or something like that but so basically that was supposed",
    "start": "3149799",
    "end": "3155720"
  },
  {
    "text": "to be a separate API which was not",
    "start": "3155720",
    "end": "3160160"
  },
  {
    "text": "authenticated yeah you talk about an exchange server being",
    "start": "3164440",
    "end": "3170000"
  },
  {
    "text": "Target uh was it ever possible or attempted by the attacker to Target",
    "start": "3170000",
    "end": "3178440"
  },
  {
    "text": "Dev um I'm I'm not aware of any attacks",
    "start": "3179760",
    "end": "3185559"
  },
  {
    "text": "against mobile",
    "start": "3185559",
    "end": "3188160"
  },
  {
    "text": "devices in in Middle how long it take properly from when you",
    "start": "3191240",
    "end": "3198839"
  },
  {
    "text": "found first indication that something was wrong until the was",
    "start": "3198839",
    "end": "3205440"
  },
  {
    "text": "released [Applause] uh I don't have the dates in my head but",
    "start": "3205440",
    "end": "3211000"
  },
  {
    "text": "I would for the first vulnerabilities was about a week and a half I think yeah",
    "start": "3211000",
    "end": "3216920"
  },
  {
    "text": "I don't have the exact dates either uh we have the dates they were leased and uh I think were the r cases started in",
    "start": "3216920",
    "end": "3224000"
  },
  {
    "text": "the beginning of July or something like that yeah so so within a month at least",
    "start": "3224000",
    "end": "3230119"
  },
  {
    "text": "yeah I I I think kind of for the first vulnerabilities it was like a week and a half or two weeks or something but",
    "start": "3230119",
    "end": "3238440"
  },
  {
    "text": "yeah front so the way the attackers here they try to selectively delete their own",
    "start": "3239640",
    "end": "3245319"
  },
  {
    "text": "logs yeah was that a big mistake on their end because that would have let you just basically look for those logs",
    "start": "3245319",
    "end": "3251440"
  },
  {
    "text": "in other sources right uh they give away that anything",
    "start": "3251440",
    "end": "3256960"
  },
  {
    "text": "with this user agent is probably probably that yeah I mean you could you you could",
    "start": "3256960",
    "end": "3263160"
  },
  {
    "text": "say that I mean once you start once once you once you",
    "start": "3263160",
    "end": "3269280"
  },
  {
    "text": "realize uh once you realize this point here that uh the user agent contained this specific string then you could",
    "start": "3269280",
    "end": "3275760"
  },
  {
    "text": "start U looking for that right but until until you figure that out it's",
    "start": "3275760",
    "end": "3285079"
  },
  {
    "text": "uh it it's kind of allowed them to to selectively delete their log entries and",
    "start": "3285079",
    "end": "3291079"
  },
  {
    "text": "not kind of just delete everything which would be really obvious",
    "start": "3291079",
    "end": "3297960"
  },
  {
    "text": "yes you yeah I assume this is like selectively deleting Ro is kind of",
    "start": "3297960",
    "end": "3304000"
  },
  {
    "text": "advanced usually but would you say that going forward in cases where expect to",
    "start": "3304000",
    "end": "3310359"
  },
  {
    "text": "advance is that you could do if you have the local logs and device that's would",
    "start": "3310359",
    "end": "3318079"
  },
  {
    "text": "be step uh yeah whe whether you could diff the local logs on the and the offse logs",
    "start": "3318079",
    "end": "3325400"
  },
  {
    "text": "yeah I guess um I mean I guess that would that would kind of be suspicious at least but I",
    "start": "3325400",
    "end": "3332680"
  },
  {
    "text": "think the the moving forward it's uh obvious at this point that you should uh",
    "start": "3332680",
    "end": "3337839"
  },
  {
    "text": "stream the logs of the devices in real time and then you have one absolute truth of what happened on device instead",
    "start": "3337839",
    "end": "3344280"
  },
  {
    "text": "of being needing to compare to two different places yeah I was thinking",
    "start": "3344280",
    "end": "3349440"
  },
  {
    "text": "that if they delete it on the local you will immediately see the I I I would",
    "start": "3349440",
    "end": "3355520"
  },
  {
    "text": "expect the threat ctor to not do anything more noisy at that point if they see that the logs get off maybe try",
    "start": "3355520",
    "end": "3362680"
  },
  {
    "text": "to stop logging somehow I don't know it's a speculation at this point I mean",
    "start": "3362680",
    "end": "3368200"
  },
  {
    "text": "if if logging stops or if huge uh chunks of log just disappears that's kind of uh",
    "start": "3368200",
    "end": "3374000"
  },
  {
    "text": "that's kind of red flag right yeah but it would been interesting if they implemented if there was log screaming and they would Implement blocking of",
    "start": "3374000",
    "end": "3379680"
  },
  {
    "text": "specific logs only that would be an equivalent in such a scenario yeah it's",
    "start": "3379680",
    "end": "3385920"
  },
  {
    "text": "interesting yeah I guess the the hard part about",
    "start": "3385920",
    "end": "3391799"
  },
  {
    "text": "that is that you can't really go back in time so so I mean on once once you're in",
    "start": "3391799",
    "end": "3396960"
  },
  {
    "text": "control of the device you can kind of uh try to try to Tamper without making",
    "start": "3396960",
    "end": "3403720"
  },
  {
    "text": "it obvious but of course the the advantage of doing centralized logging is that then you at",
    "start": "3403720",
    "end": "3410119"
  },
  {
    "text": "least you have the traces going back in time so so I mean",
    "start": "3410119",
    "end": "3418240"
  },
  {
    "text": "when when we did go when we did go back in time we saw I mean we saw that this",
    "start": "3418400",
    "end": "3423920"
  },
  {
    "text": "the these strange SL myths ad paths were being invoked since yeah since April",
    "start": "3423920",
    "end": "3432799"
  },
  {
    "text": "so that was kind of that was kind of the that was kind of a clue that yeah",
    "start": "3432799",
    "end": "3438119"
  },
  {
    "text": "somebody is somebody started gathering",
    "start": "3438119",
    "end": "3442440"
  },
  {
    "text": "information",
    "start": "3445160",
    "end": "3448160"
  },
  {
    "text": "oh this one oh yeah no it was just notes from",
    "start": "3456039",
    "end": "3461400"
  },
  {
    "text": "his blog post the the oh yeah yeah I can find it there it is so yeah I found",
    "start": "3461400",
    "end": "3469160"
  },
  {
    "text": "vulnerabilities on the leading MDM product and bypass several limitations all the vulnerabilities have been report to",
    "start": "3469160",
    "end": "3474799"
  },
  {
    "text": "vendor Faceook didn't keep up with the patch for more than two months so we Dr two weeks so we dropped the shell on",
    "start": "3474799",
    "end": "3481880"
  },
  {
    "text": "Facebook that's that's his style really really cool guy he gives he's given some",
    "start": "3482000",
    "end": "3488079"
  },
  {
    "text": "great talks of black hat which I recommend looking up on",
    "start": "3488079",
    "end": "3492640"
  },
  {
    "text": "YouTube yeah I think we're at time yes on the spot thanks thanks everybody for",
    "start": "3493400",
    "end": "3498640"
  },
  {
    "text": "coming thank [Applause] you",
    "start": "3498640",
    "end": "3505400"
  }
]