[
  {
    "text": "welcome everyone thank you for coming I'm going to have two talks today they",
    "start": "269",
    "end": "6870"
  },
  {
    "text": "are going to be back-to-back so there it's going to be a break but they're not gonna be in the same room so right after",
    "start": "6870",
    "end": "13139"
  },
  {
    "text": "this talk I will go up to room number 4 to set up so there will probably be no questions if you want to ask questions",
    "start": "13139",
    "end": "20340"
  },
  {
    "text": "just follow me up to room 4 and then I can talk while I set up okay so the",
    "start": "20340",
    "end": "26849"
  },
  {
    "text": "first talk is isolating GPU access in its own process and my name is Patricia",
    "start": "26849",
    "end": "34920"
  },
  {
    "text": "Oz I'm now a consultant now for like three weeks uh I'm a C++ programmer I'm hoping to",
    "start": "34920",
    "end": "44399"
  },
  {
    "text": "make something in between C++ and application security I just recently",
    "start": "44399",
    "end": "50520"
  },
  {
    "text": "left Vivaldi where I worked on the Vivaldi browser before that I worked at",
    "start": "50520",
    "end": "55890"
  },
  {
    "text": "Cisco doing telepresence systems before that I was a Java consultant for a couple years I know it and before that I",
    "start": "55890",
    "end": "62579"
  },
  {
    "text": "worked on the upper browser I have a master's in computer science and while I",
    "start": "62579",
    "end": "68970"
  },
  {
    "text": "was studying I basically programmed in Java mostly in different other types of languages of my first C++ experience was",
    "start": "68970",
    "end": "75720"
  },
  {
    "text": "starting at opera which is now 13 years ago so ah there will be a little bit of",
    "start": "75720",
    "end": "84420"
  },
  {
    "text": "an introduction to the area and I've spread it over these two talks introducing the concepts that I think",
    "start": "84420",
    "end": "89909"
  },
  {
    "text": "are important for the talk so they kind of follow each other because they're both about chromium so to give an idea",
    "start": "89909",
    "end": "98430"
  },
  {
    "text": "of what chromium is so I will give you a little bit of browser history",
    "start": "98430",
    "end": "104600"
  },
  {
    "text": "so the major browsers today all have long lineage that goes back to the 90s",
    "start": "104600",
    "end": "111450"
  },
  {
    "text": "in general and all of these browsers that you probably know all originated",
    "start": "111450",
    "end": "118140"
  },
  {
    "text": "with their KHTML engine which was used in conquer and made by the KT project",
    "start": "118140",
    "end": "123180"
  },
  {
    "text": "and so in the early 2000s Apple forked it and called it WebKit and used it to",
    "start": "123180",
    "end": "129899"
  },
  {
    "text": "make Safari a little bit later Google chose to use it to make their Chrome",
    "start": "129899",
    "end": "136200"
  },
  {
    "text": "browsers in 2008 and they cooperated on",
    "start": "136200",
    "end": "141989"
  },
  {
    "text": "the WebKit project for quite a few years but after a while Google did found out",
    "start": "141989",
    "end": "147930"
  },
  {
    "text": "or decided that maintaining the compatibility was a lot of work and they were basically doing most of the work on",
    "start": "147930",
    "end": "154920"
  },
  {
    "text": "a WebKit and decided that it would be easy for them to do a fork and so they did a fork of WebKit and that is what is",
    "start": "154920",
    "end": "163799"
  },
  {
    "text": "called chromium blink now the chromium part is actually a round WebKit so",
    "start": "163799",
    "end": "172109"
  },
  {
    "text": "WebKit is a webview kind of thing and and chromium is the framework around so",
    "start": "172109",
    "end": "178560"
  },
  {
    "text": "I will I can't go back and so I will",
    "start": "178560",
    "end": "184560"
  },
  {
    "text": "look a little bit about how that works because it in impacts how composition",
    "start": "184560",
    "end": "189780"
  },
  {
    "text": "works and I will talk about it even more in the next talk when I talk about sound boxing so composition a lot of people",
    "start": "189780",
    "end": "198900"
  },
  {
    "text": "who haven't worked on low-level UI are not familiar with composition but",
    "start": "198900",
    "end": "204239"
  },
  {
    "text": "basically in in in a chromium based browser you have massive composition",
    "start": "204239",
    "end": "209760"
  },
  {
    "text": "because you have many many processes and you've probably seen this during PS or something on your machine and your",
    "start": "209760",
    "end": "216840"
  },
  {
    "text": "browser has started maybe dozens or hundreds of processes and all of these",
    "start": "216840",
    "end": "222690"
  },
  {
    "text": "processes or most of them are producing some some fragments that are used to",
    "start": "222690",
    "end": "227729"
  },
  {
    "text": "compose the browser window and so composition is trying to to stitch all",
    "start": "227729",
    "end": "233370"
  },
  {
    "text": "of this together to to one view one browser window with tabs and things right so I just quit a browser company",
    "start": "233370",
    "end": "245879"
  },
  {
    "text": "and I just might have made a small browser but it was basically a little",
    "start": "245879",
    "end": "252329"
  },
  {
    "text": "bit for for beginning for a project that I'm planning on doing which has to do with security but it was also a little",
    "start": "252329",
    "end": "258419"
  },
  {
    "text": "bit about this talk and I might have decided to do a demo last night",
    "start": "258419",
    "end": "264719"
  },
  {
    "text": "maybe at one o'clock in the morning so let's see how this works out",
    "start": "264719",
    "end": "270820"
  },
  {
    "text": "okay so well it'll pay for that okay so we'll start with this one and and one of",
    "start": "270820",
    "end": "275950"
  },
  {
    "text": "the things that I think is really this is let's sit you here okay no there we",
    "start": "275950",
    "end": "286690"
  },
  {
    "text": "go um so this is my browser in high resolution this is a CSS demo which I",
    "start": "286690",
    "end": "299350"
  },
  {
    "text": "find is very cool it has animations it does all sorts of",
    "start": "299350",
    "end": "305470"
  },
  {
    "text": "things and the reason why I want to show you this is because I'm going to show you how this is composed so let's see",
    "start": "305470",
    "end": "315070"
  },
  {
    "text": "here so let's instead look at this in the background so in this case I mean the",
    "start": "315070",
    "end": "321220"
  },
  {
    "text": "browser that I made is is cute based it uses the cute web engine which uses",
    "start": "321220",
    "end": "328570"
  },
  {
    "text": "chromium link but it also cute has this feature where you can show the composition layers in this overlay so",
    "start": "328570",
    "end": "337060"
  },
  {
    "text": "this three dimensional box here represents the browser and behind it so",
    "start": "337060",
    "end": "343660"
  },
  {
    "text": "if I do like this then you can see the",
    "start": "343660",
    "end": "349900"
  },
  {
    "text": "layers being moved around and you can rotate the box behind or the the sphere",
    "start": "349900",
    "end": "357160"
  },
  {
    "text": "behind and you can see that the layers move and the reason why I want to say",
    "start": "357160",
    "end": "364210"
  },
  {
    "text": "this is these are the different layers that are produced by the webview and they in this case there there might be",
    "start": "364210",
    "end": "370030"
  },
  {
    "text": "hundreds of them right and they have to be composed together to make just the",
    "start": "370030",
    "end": "375130"
  },
  {
    "text": "webpage and then this or this also participates in the full browser so the green stuff on top is my address bar and",
    "start": "375130",
    "end": "382540"
  },
  {
    "text": "my tab and things so green here is something that is opaque red is something that has some sort of alpha",
    "start": "382540",
    "end": "388660"
  },
  {
    "text": "and so so composition is is in modern",
    "start": "388660",
    "end": "393940"
  },
  {
    "text": "applications with is very complex much more complex than most people think",
    "start": "393940",
    "end": "400800"
  },
  {
    "text": "okay and let's see hmm so I'm going to",
    "start": "400800",
    "end": "405970"
  },
  {
    "text": "have here is the video that I'm showing there's nothing really on this page and here you can see that the video is is a",
    "start": "405970",
    "end": "414370"
  },
  {
    "text": "floating opaque layer on top of this background and this background is these checkered things now if you want to",
    "start": "414370",
    "end": "423010"
  },
  {
    "text": "research more into chromium composition you will see that that this is some of",
    "start": "423010",
    "end": "428230"
  },
  {
    "text": "the optimizations done there to to give good scrolling but let's go back to a",
    "start": "428230",
    "end": "436930"
  },
  {
    "text": "presentation okay so you have an idea on all of the layers and they are layers",
    "start": "436930",
    "end": "442210"
  },
  {
    "text": "upon layers and everything has to be stitched together and this is composition and in the original chromium",
    "start": "442210",
    "end": "450780"
  },
  {
    "text": "the architecture looked a little bit like this so they Google decided to put",
    "start": "450780",
    "end": "457420"
  },
  {
    "text": "WebKit in its own process and the reason for this is a little bit that they didn't have control over the stability",
    "start": "457420",
    "end": "464320"
  },
  {
    "text": "of WebKit WebKit could crash and putting in in its own process meant that if it crashed it could be restarted without",
    "start": "464320",
    "end": "470730"
  },
  {
    "text": "bringing down the whole browser and so in general you can think that there's",
    "start": "470730",
    "end": "475990"
  },
  {
    "text": "one rendering process per tab and each of them produces a web page which could",
    "start": "475990",
    "end": "481330"
  },
  {
    "text": "be very complicated and complex with many layers but then you have many web",
    "start": "481330",
    "end": "486910"
  },
  {
    "text": "pages and and again that has to be composed together with the UI and in the beginning they did this with software",
    "start": "486910",
    "end": "493990"
  },
  {
    "text": "composition which was done in the browser process which is like the the original the one that you start when you",
    "start": "493990",
    "end": "501730"
  },
  {
    "text": "start the browser later they moved all",
    "start": "501730",
    "end": "506860"
  },
  {
    "text": "over to a hardware composition architecture and now you had to submit",
    "start": "506860",
    "end": "512560"
  },
  {
    "text": "the layers to the hardware composition which was placed in its own process",
    "start": "512560",
    "end": "518310"
  },
  {
    "text": "which is called the GPU process now",
    "start": "518310",
    "end": "524250"
  },
  {
    "text": "given that you have so many applications you need some kind of communication and",
    "start": "524250",
    "end": "529570"
  },
  {
    "text": "you need a startup sequence to make all these things and the startup sequence I'll look a little bit more in the next talk but",
    "start": "529570",
    "end": "537180"
  },
  {
    "text": "you see the process relationships a little bit like this so you have a browser process which is the one you",
    "start": "537180",
    "end": "543459"
  },
  {
    "text": "start which could be Chrome Opera Ivaldi brave whatever and it will make two",
    "start": "543459",
    "end": "551110"
  },
  {
    "text": "children what I call sigh got in it and this is GPU process and those will again",
    "start": "551110",
    "end": "556540"
  },
  {
    "text": "make other child processes and at the bottom there you see the renders which are roughly equivalent to a tab and",
    "start": "556540",
    "end": "565470"
  },
  {
    "text": "those are so the solid lines are the process kind of relationships but the",
    "start": "565470",
    "end": "570579"
  },
  {
    "text": "that the dashed line shows that they are actually there should be dashed lines everywhere because there are massive amounts of communication that is done",
    "start": "570579",
    "end": "576939"
  },
  {
    "text": "but in this case you can see that that both the renders and the browsers need to communicate to the GPU process and to",
    "start": "576939",
    "end": "587769"
  },
  {
    "text": "do that they they use a bunch of different facilities now I'm the whole talk is Linux based and I'm pretty Linux",
    "start": "587769",
    "end": "595300"
  },
  {
    "text": "based so in this case they're using shared memory and in shared memory they",
    "start": "595300",
    "end": "600970"
  },
  {
    "text": "have something they called command buffers which is basically a sectional",
    "start": "600970",
    "end": "606910"
  },
  {
    "text": "shared memory that they they treat as a ring buffer and they put serialized GPU",
    "start": "606910",
    "end": "612370"
  },
  {
    "text": "commands will get a little bit into that and other types of memory objects can be placed also in shared memory and then",
    "start": "612370",
    "end": "619240"
  },
  {
    "text": "you have these IBT channel IPC channels to the GPU process which are basically pipes right so this is the the general",
    "start": "619240",
    "end": "629050"
  },
  {
    "text": "architecture to be able to do this because the thing is that the API for",
    "start": "629050",
    "end": "634949"
  },
  {
    "text": "for for dealing with with graphics inside of the renderer process and also",
    "start": "634949",
    "end": "641920"
  },
  {
    "text": "in the browser process is OpenGL es2 and this is generally the mobile kind of",
    "start": "641920",
    "end": "649800"
  },
  {
    "text": "API for graphics and many places you don't even have OpenGL but this is the",
    "start": "649800",
    "end": "655209"
  },
  {
    "text": "this is the interface that these applications program against and they do that by by having an OpenGL es2",
    "start": "655209",
    "end": "663069"
  },
  {
    "text": "interface that they program against and and they use roughly normal of",
    "start": "663069",
    "end": "668259"
  },
  {
    "text": "Elias to commands but this is really fake it's a very thin layer which goes",
    "start": "668259",
    "end": "675040"
  },
  {
    "text": "to this encoder which basically takes the commands of function calls",
    "start": "675040",
    "end": "680220"
  },
  {
    "text": "serializes it and places them in this this ring buffer this command buffer and",
    "start": "680220",
    "end": "687179"
  },
  {
    "text": "and and that buffer again is read by the GPU process which DC realizes these",
    "start": "687179",
    "end": "694029"
  },
  {
    "text": "commands validates and does may be transformations and then actually execute them now it could be that they",
    "start": "694029",
    "end": "701679"
  },
  {
    "text": "are executed on something that's not even OpenGL because these things are now",
    "start": "701679",
    "end": "707100"
  },
  {
    "text": "decoupled so this is this is the",
    "start": "707100",
    "end": "713289"
  },
  {
    "text": "architecture this is the idea and what you what you see here is that you have many possibilities of injecting your own",
    "start": "713289",
    "end": "721029"
  },
  {
    "text": "logic in this chain and and that is used a lot so basically you have a client",
    "start": "721029",
    "end": "729459"
  },
  {
    "text": "which could be the renderer or the browser for example and they will do they will do OpenGL es2",
    "start": "729459",
    "end": "735269"
  },
  {
    "text": "function calls which results in these command things that are serialized into the command buffer and then they they",
    "start": "735269",
    "end": "742689"
  },
  {
    "text": "signal the GPU process that they put something there and then on the GPU side",
    "start": "742689",
    "end": "748449"
  },
  {
    "text": "you have many of these command buffers that you're dealing with because you have many clients many renders and one",
    "start": "748449",
    "end": "753999"
  },
  {
    "text": "browser and so you will have to to pick",
    "start": "753999",
    "end": "759279"
  },
  {
    "text": "commands off of the queue validate the arguments maybe do some transformations do things and then make the actual",
    "start": "759279",
    "end": "768339"
  },
  {
    "text": "underlying call what you see clearly if we go back is that there is a decoupling",
    "start": "768339",
    "end": "775269"
  },
  {
    "text": "in in both time and space here so you make a local function call but that but",
    "start": "775269",
    "end": "780519"
  },
  {
    "text": "you don't know exactly when this will finish or when it is finished executing now this is this is true from any",
    "start": "780519",
    "end": "786970"
  },
  {
    "text": "graphics API so it's not it's not a strange concept and so the conceptual",
    "start": "786970",
    "end": "795220"
  },
  {
    "text": "model of this though it isn't how its implemented but this is the conceptual model of it you have a client on",
    "start": "795220",
    "end": "801640"
  },
  {
    "text": "inside the server on the other side and then you have things that they call like the IPC channel then the command buffer",
    "start": "801640",
    "end": "807220"
  },
  {
    "text": "that I talked about then they have something called a command stream an inside of a command stream you can have",
    "start": "807220",
    "end": "813010"
  },
  {
    "text": "several command buffers and you can have several command streams inside of an IPC",
    "start": "813010",
    "end": "818770"
  },
  {
    "text": "channel and so this can get kind of complex so when it gets complex you need",
    "start": "818770",
    "end": "827320"
  },
  {
    "text": "some kind of synchronization architecture and they use something they call a sink token now what you will see",
    "start": "827320",
    "end": "833620"
  },
  {
    "text": "often in chromium is that you have very high-level abstractions and that is",
    "start": "833620",
    "end": "840130"
  },
  {
    "text": "because you have a very diverse set of architectures that you're faced with and",
    "start": "840130",
    "end": "847150"
  },
  {
    "text": "so you have to to to implement many things specifically for each platform so",
    "start": "847150",
    "end": "854590"
  },
  {
    "text": "the idea of a sink token is that it is a synchronization fence that you put into the command stream and and then someone",
    "start": "854590",
    "end": "861640"
  },
  {
    "text": "can wait on that fence and I'll show you a little bit about that so sink token is",
    "start": "861640",
    "end": "869830"
  },
  {
    "text": "quite a simple thing it belongs to a command buffer and it belongs to a command buffer namespace it is a very",
    "start": "869830",
    "end": "876370"
  },
  {
    "text": "simple object really and so here you can see a more of a complicated version",
    "start": "876370",
    "end": "882430"
  },
  {
    "text": "where you have here the browser command stream on top then you have two renders",
    "start": "882430",
    "end": "888370"
  },
  {
    "text": "that have actually two command buffers each and here you have the different",
    "start": "888370",
    "end": "893800"
  },
  {
    "text": "types of synchronization primitives so the big blue box in the middle is an",
    "start": "893800",
    "end": "899860"
  },
  {
    "text": "ordering barrier it's a it's a simple one but it basically what what you clear they see is that within a command buffer",
    "start": "899860",
    "end": "906850"
  },
  {
    "text": "the order of the commands are sequential you put one in and then you put another",
    "start": "906850",
    "end": "912520"
  },
  {
    "text": "in and they will be handled FIFO right so you will take them as they go so they",
    "start": "912520",
    "end": "917530"
  },
  {
    "text": "have a sequentiality you know that when it's your turn what was before you has already been handled but when you have",
    "start": "917530",
    "end": "925540"
  },
  {
    "text": "multiple command buffers or or multiple streams you don't know so when you start",
    "start": "925540",
    "end": "932320"
  },
  {
    "text": "having dependencies that span these these streams then you start",
    "start": "932320",
    "end": "941149"
  },
  {
    "text": "having to introduce synchronization between them so ordering Berry is a",
    "start": "941149",
    "end": "946250"
  },
  {
    "text": "simple one that you can use if you are both in the same IPC channel or in the",
    "start": "946250",
    "end": "951500"
  },
  {
    "text": "same command stream but if you are spanning two command streams you can use",
    "start": "951500",
    "end": "958459"
  },
  {
    "text": "something they call an unverified synced okay and the idea here is that this",
    "start": "958459",
    "end": "965050"
  },
  {
    "text": "weight sync token will not be processed the weight sync token won't be processed",
    "start": "965050",
    "end": "972620"
  },
  {
    "text": "until the sync token has been signaled so the idea here is that you know that when you when the sync token has been",
    "start": "972620",
    "end": "979940"
  },
  {
    "text": "signaled everything before it has already been processed so this is a way of making sure that what is after the",
    "start": "979940",
    "end": "987470"
  },
  {
    "text": "weight sync token comes after the commands and and and the same idea here",
    "start": "987470",
    "end": "993529"
  },
  {
    "text": "with the verified same token which which is a little bit different needs to be signal the cross and things like that",
    "start": "993529",
    "end": "999259"
  },
  {
    "text": "but but it basically you can promote and unverified sync token to be a verified sing token and do the same thing and I",
    "start": "999259",
    "end": "1006720"
  },
  {
    "text": "will show you a an example of when that is necessary and that is in this example",
    "start": "1006720",
    "end": "1015819"
  },
  {
    "text": "here so you where here we are going to look at passing a video frame and",
    "start": "1015819",
    "end": "1021750"
  },
  {
    "text": "composing that so we're going to look at",
    "start": "1021750",
    "end": "1028240"
  },
  {
    "text": "software decoding now in chromium there are basically two ways of decoding video",
    "start": "1028240",
    "end": "1034870"
  },
  {
    "text": "you have software decoding which was the way it was the traditional way or the way it was done since the beginning and",
    "start": "1034870",
    "end": "1041980"
  },
  {
    "text": "then you have slowly but surely introduced some hardware decoding hardware decoding is done on the GPU in",
    "start": "1041980",
    "end": "1048820"
  },
  {
    "text": "the GPU process so we're not going to look at that because it doesn't really it's not as fun so so in this case",
    "start": "1048820",
    "end": "1057610"
  },
  {
    "text": "you're doing software decoding and software decoding in in chromium is done by ffmpeg and it's done inside of the",
    "start": "1057610",
    "end": "1063190"
  },
  {
    "text": "render process so now you have a decoded frame in memory inside of the render",
    "start": "1063190",
    "end": "1068680"
  },
  {
    "text": "process but you need it on the GPU and and so we're going to look at how you're",
    "start": "1068680",
    "end": "1074920"
  },
  {
    "text": "going to do that yeah now the first part",
    "start": "1074920",
    "end": "1081640"
  },
  {
    "text": "is fine it's very synchronous you decode the frame into render memory and you're good you know you have it in render",
    "start": "1081640",
    "end": "1086650"
  },
  {
    "text": "memory but now you need to copy the frame to the GPU and later on at some",
    "start": "1086650",
    "end": "1092590"
  },
  {
    "text": "point when you have to paint the frame you have to actually issue the draw commands to say okay I want to paint",
    "start": "1092590",
    "end": "1100240"
  },
  {
    "text": "that texture that you got earlier the thing is that the issuing of the draw",
    "start": "1100240",
    "end": "1105550"
  },
  {
    "text": "commands will generally come from the the browser process and the the copying of the frame is coming from the render",
    "start": "1105550",
    "end": "1111400"
  },
  {
    "text": "process and these things are D synchronized so you have to make sure",
    "start": "1111400",
    "end": "1117040"
  },
  {
    "text": "that by the time you ask you to draw this thing that it is actually there so",
    "start": "1117040",
    "end": "1124270"
  },
  {
    "text": "the so so in this case you will have this sink totaling you have to kind of carry around to make sure that you are",
    "start": "1124270",
    "end": "1131710"
  },
  {
    "text": "waiting for that waiting for the for the frame to be available on the GPU before",
    "start": "1131710",
    "end": "1137170"
  },
  {
    "text": "you issued to draw it I will show a lot of diagrams for this and don't you don't",
    "start": "1137170",
    "end": "1145570"
  },
  {
    "text": "really have to care unless you know you want to read the slides later about the details but it's basically to show this",
    "start": "1145570",
    "end": "1151900"
  },
  {
    "text": "kind of process and even this small little like line that I will show you on",
    "start": "1151900",
    "end": "1160750"
  },
  {
    "text": "tracking this video frame is it's just a very very tiny part of the chromium",
    "start": "1160750",
    "end": "1165850"
  },
  {
    "text": "architecture chromium is massive the whole thing is massive and much bigger",
    "start": "1165850",
    "end": "1171640"
  },
  {
    "text": "than you imagined so so this is very very small and the problem of course is",
    "start": "1171640",
    "end": "1179710"
  },
  {
    "text": "making diagrams is that this is a quote from mice I made it myself somebody should put it on Wikipedia at a high",
    "start": "1179710",
    "end": "1187930"
  },
  {
    "text": "enough level of abstraction everything looks the same so basically it's the law of PowerPoint architecture which",
    "start": "1187930",
    "end": "1193780"
  },
  {
    "text": "basically means if you just boil it down enough high enough there's one box in there's an arrow to another box you know",
    "start": "1193780",
    "end": "1202060"
  },
  {
    "text": "pick a name and put it on the boxes and you're finished and that's your system and so to try to get around this there",
    "start": "1202060",
    "end": "1211510"
  },
  {
    "text": "are boxes and there are arrows but there are it's it's difficult so first like I",
    "start": "1211510",
    "end": "1219130"
  },
  {
    "text": "said before you have the actual decoding now an interesting concept which I will talk a little bit about in the next",
    "start": "1219130",
    "end": "1225520"
  },
  {
    "text": "presentation is the fact that network access is not available inside of the",
    "start": "1225520",
    "end": "1230830"
  },
  {
    "text": "render now the render it actually runs the webview and the web generally comes from the internet right so so that makes",
    "start": "1230830",
    "end": "1238000"
  },
  {
    "text": "it interesting because the actual network traffic comes through the browser process and has to be piped over",
    "start": "1238000",
    "end": "1243790"
  },
  {
    "text": "to or transferred over to the render process and this is true also in this media stream right so the media stream",
    "start": "1243790",
    "end": "1250990"
  },
  {
    "text": "comes through the network stack in the browser process into the decoder which is in the renderer process and the",
    "start": "1250990",
    "end": "1256330"
  },
  {
    "text": "decoder produces this video frame with Y U and V plane and it's in memory so",
    "start": "1256330",
    "end": "1267570"
  },
  {
    "text": "chromium has this idea of a reference to this type of sink token or which is they",
    "start": "1267570",
    "end": "1273970"
  },
  {
    "text": "call a mailbox and then you have also something called a mailbox holder to hold the mailbox and a sync token and a",
    "start": "1273970",
    "end": "1280750"
  },
  {
    "text": "texture target I'm not gonna go into this you can look at it if you want to but you'll get a lot of boxes with those",
    "start": "1280750",
    "end": "1287830"
  },
  {
    "text": "names so I just mentioned it but basically on the left hand side here you",
    "start": "1287830",
    "end": "1292900"
  },
  {
    "text": "have our wonderful video frame with our buffer and that's great but we need it",
    "start": "1292900",
    "end": "1298540"
  },
  {
    "text": "over on the GPU process so we're going to copy it into shared memory then we're going to have a reference to that but",
    "start": "1298540",
    "end": "1305470"
  },
  {
    "text": "it's sort of like a vague idea and we'll look at it but it basically it references this thing that we have",
    "start": "1305470",
    "end": "1311800"
  },
  {
    "text": "copied into shared memory and then this thing that we've copied into shared memory will be uploaded to the GPU as an",
    "start": "1311800",
    "end": "1318880"
  },
  {
    "text": "a GL image and then later on we will say paint that here on this cliprect so in",
    "start": "1318880",
    "end": "1328750"
  },
  {
    "text": "the preparation is all about trying to make all of these types of resources and",
    "start": "1328750",
    "end": "1335180"
  },
  {
    "text": "and make sure that they're registered in this transferable resource thing which",
    "start": "1335180",
    "end": "1341120"
  },
  {
    "text": "is basically a little struct that you can carry around and it ends up here so",
    "start": "1341120",
    "end": "1349940"
  },
  {
    "text": "now we're going to try to paint we've gotten this y UV video draw quad so now",
    "start": "1349940",
    "end": "1355190"
  },
  {
    "text": "we are going to try to paint this thing but we're still referring to something that we don't know exactly the state",
    "start": "1355190",
    "end": "1361160"
  },
  {
    "text": "then we don't know if it's already uploaded on the GPU or whatever it is we're just referring to some conceptual",
    "start": "1361160",
    "end": "1368210"
  },
  {
    "text": "thing that might have happened or not and to make sure that our draw commence",
    "start": "1368210",
    "end": "1375350"
  },
  {
    "text": "because here we're going to actually make a shader we're going to have a GL program we're going to say we want you",
    "start": "1375350",
    "end": "1381860"
  },
  {
    "text": "to paint this this thing with this ID blah blah blah but we don't know if it's done so to make sure that our commands",
    "start": "1381860",
    "end": "1389060"
  },
  {
    "text": "come after the upload we have to connect to the sink token which was issue which",
    "start": "1389060",
    "end": "1394820"
  },
  {
    "text": "was issued when we copied it over and",
    "start": "1394820",
    "end": "1400910"
  },
  {
    "text": "then you have the renders since the clip for the region and it's like whoo-hoo and everything's good now this is a very",
    "start": "1400910",
    "end": "1408140"
  },
  {
    "text": "very simple thing I'm drawing an opaque square image I had in memory and now you",
    "start": "1408140",
    "end": "1414590"
  },
  {
    "text": "looked at the CSS earlier and there were like hundreds of them right so this is this is a massive architecture so this",
    "start": "1414590",
    "end": "1425900"
  },
  {
    "text": "is what we've tried to do we issued some commands then we put in a sync token then we are put in a waiting st. token",
    "start": "1425900",
    "end": "1434450"
  },
  {
    "text": "and then some more commands and then we're hoping that you know this will make sure that the little yellow one pushes the other one out oh sorry",
    "start": "1434450",
    "end": "1441340"
  },
  {
    "text": "before the top blue ones get processed",
    "start": "1441340",
    "end": "1446080"
  },
  {
    "text": "but the thing is this is not really done with like out-of-the-box OpenGL es2 of",
    "start": "1446530",
    "end": "1452810"
  },
  {
    "text": "course they added extensions to do their special things and they actually have a bunch and these are only three which are",
    "start": "1452810",
    "end": "1461330"
  },
  {
    "text": "used in this example so they make their own own OpenGL es2 extensions to be able",
    "start": "1461330",
    "end": "1467840"
  },
  {
    "text": "to handle the and even more about this and you can see that here so basically you have a",
    "start": "1467840",
    "end": "1473930"
  },
  {
    "text": "regular barn texture that you see on the right and and then you have this create image chromium in the middle where and",
    "start": "1473930",
    "end": "1482030"
  },
  {
    "text": "then you have this bind text image 2d chromium so the they are not using after",
    "start": "1482030",
    "end": "1489050"
  },
  {
    "text": "the box OpenGL es2 either they have their own extensions so",
    "start": "1489050",
    "end": "1496910"
  },
  {
    "text": "okay so I talked a lot about this in chromium and it's kind of interesting if you have a chromium based browser it's kind of like okay I know that now but",
    "start": "1496910",
    "end": "1503270"
  },
  {
    "text": "why would you even care about this because you know why aren't you just",
    "start": "1503270",
    "end": "1508580"
  },
  {
    "text": "doing why why wouldn't you make a separate GPU process to handle all your GPU commands why wouldn't you at least",
    "start": "1508580",
    "end": "1514160"
  },
  {
    "text": "have it in the browser process and volleyer actually on an android chromium",
    "start": "1514160",
    "end": "1521150"
  },
  {
    "text": "actually has it in the browser processes in a GPU thread and that is also the architecture they cute I chose for em",
    "start": "1521150",
    "end": "1528440"
  },
  {
    "text": "for cute web engine so they also run GPU axis and a GPU thread but they have",
    "start": "1528440",
    "end": "1536000"
  },
  {
    "text": "their reasons and we'll look at those and and those races might not be your reasons but let's see so first of all",
    "start": "1536000",
    "end": "1546100"
  },
  {
    "text": "security like I said before this this normal looking you've had access you've",
    "start": "1546100",
    "end": "1553850"
  },
  {
    "text": "had the issues and bugs in the past and I'll show you a couple of texture memory being leaked so either that that it's",
    "start": "1553850",
    "end": "1562520"
  },
  {
    "text": "being leaked across tab so another web page might be able to read texture memory that you wrote in your tab which",
    "start": "1562520",
    "end": "1568550"
  },
  {
    "text": "could leak personal information other programs might be able to read texture",
    "start": "1568550",
    "end": "1574580"
  },
  {
    "text": "memory that was written by Chrome which might AB or your browser which might have personal information like your",
    "start": "1574580",
    "end": "1579740"
  },
  {
    "text": "passwords or whatever because these are just pictures right then needs to be rendered and and all of these steps give",
    "start": "1579740",
    "end": "1588860"
  },
  {
    "text": "you fine-grained control where you can insert many things you can zero out memory whenever you want because you",
    "start": "1588860",
    "end": "1596179"
  },
  {
    "text": "have so many steps where you can insert your own code in this pipeline because there's no actual real",
    "start": "1596179",
    "end": "1602360"
  },
  {
    "text": "gl calls until you decide to do that so",
    "start": "1602360",
    "end": "1607370"
  },
  {
    "text": "this is one example where somebody took and just painted what was in a texture",
    "start": "1607370",
    "end": "1614030"
  },
  {
    "text": "memory on a cube in a webpage and you know that might not be something that",
    "start": "1614030",
    "end": "1619760"
  },
  {
    "text": "should like and here's the other way around where someone is taking a texture",
    "start": "1619760",
    "end": "1626210"
  },
  {
    "text": "memory that chrome had painted on and and then pulling it out in another application again something that you",
    "start": "1626210",
    "end": "1631610"
  },
  {
    "text": "might like so the fine grained control is is one aspect but then you also have",
    "start": "1631610",
    "end": "1641630"
  },
  {
    "text": "the fact that and that these chromium based browsers have to run on a very very different hardware they don't know",
    "start": "1641630",
    "end": "1647750"
  },
  {
    "text": "what hardware there are many different operating systems many different hardware many different GPU GPUs and",
    "start": "1647750",
    "end": "1653570"
  },
  {
    "text": "graphics drivers this is a very complex landscape where you have to deal with",
    "start": "1653570",
    "end": "1659210"
  },
  {
    "text": "other people's bugs other people's implementations and graphics drivers do",
    "start": "1659210",
    "end": "1664670"
  },
  {
    "text": "crash on occasion and especially now that you are running basically GL that",
    "start": "1664670",
    "end": "1671120"
  },
  {
    "text": "you are getting in WebGL you're getting GL commands from the internet right that you are executing on the on the user's",
    "start": "1671120",
    "end": "1677150"
  },
  {
    "text": "GPU and so vulnerabilities in the GPU or in the GPU drivers suddenly become your",
    "start": "1677150",
    "end": "1684500"
  },
  {
    "text": "problems right and so in this case you have you have many places where you can",
    "start": "1684500",
    "end": "1692180"
  },
  {
    "text": "choose to to bypass the GPU and there are many software fall backs and I will",
    "start": "1692180",
    "end": "1700630"
  },
  {
    "text": "let's see mm-hmm okay let's let's look",
    "start": "1700630",
    "end": "1707510"
  },
  {
    "text": "at that right now actually so if you go to to your browser in this case as let's",
    "start": "1707510",
    "end": "1715100"
  },
  {
    "text": "see let's Vivaldi and you can go to",
    "start": "1715100",
    "end": "1720980"
  },
  {
    "text": "Chrome colon slash slash GPU or you know whatever for whatever chromium based browser and you will see that you have",
    "start": "1720980",
    "end": "1728000"
  },
  {
    "text": "this page where you have driver bugs workarounds problems detected references",
    "start": "1728000",
    "end": "1735080"
  },
  {
    "text": "to bugs all of these places are places where chromium goes in and looks at stuff and",
    "start": "1735080",
    "end": "1740509"
  },
  {
    "text": "you will see up here that you have many different kinds of fall backs in this case you know I have hardware for many",
    "start": "1740509",
    "end": "1745700"
  },
  {
    "text": "things but here it's software only hardware acceleration disabled and my",
    "start": "1745700",
    "end": "1753559"
  },
  {
    "text": "point is this is quite complicated and they have but they have that opportunity",
    "start": "1753559",
    "end": "1759799"
  },
  {
    "text": "because of the pipeline being so exposed before you choose to do the call you can",
    "start": "1759799",
    "end": "1765019"
  },
  {
    "text": "reroute it to other things and then you have dependency separation you know you",
    "start": "1765019",
    "end": "1771860"
  },
  {
    "text": "might have a driver that is loading shared libraries into memory that you",
    "start": "1771860",
    "end": "1777049"
  },
  {
    "text": "don't want to have inside of your render process or inside of your browser process things that you don't trust you",
    "start": "1777049",
    "end": "1783049"
  },
  {
    "text": "are and so to put it out in its own process you are also putting it into its",
    "start": "1783049",
    "end": "1788870"
  },
  {
    "text": "own memory and it's not accessing your memory and you can make more isolation",
    "start": "1788870",
    "end": "1793940"
  },
  {
    "text": "possible also you the render sandbox would be completely broken if you loaded",
    "start": "1793940",
    "end": "1801139"
  },
  {
    "text": "a GPU driver or yeah a graphics driver in there because Jeffrey's graphics drivers sometimes need access to the",
    "start": "1801139",
    "end": "1807139"
  },
  {
    "text": "Internet there are like all sorts of things that this graphics driver would mean that means you basically had to",
    "start": "1807139",
    "end": "1813259"
  },
  {
    "text": "disable the whole sandboxing performance",
    "start": "1813259",
    "end": "1818480"
  },
  {
    "text": "I don't know um they say they say it has",
    "start": "1818480",
    "end": "1824659"
  },
  {
    "text": "a performance advantages basically because of what we saw before so you",
    "start": "1824659",
    "end": "1831080"
  },
  {
    "text": "could issue the commands to say you know I want you to upload this texture but you don't really have to care about it",
    "start": "1831080",
    "end": "1836240"
  },
  {
    "text": "and then later you could do it and then all sorts of different processes can do this at the same time and there they",
    "start": "1836240",
    "end": "1844850"
  },
  {
    "text": "feel they're in there introducing a form of parallelism that that gives you an",
    "start": "1844850",
    "end": "1851450"
  },
  {
    "text": "opportunity for better performance I don't know the thing is that a browser",
    "start": "1851450",
    "end": "1857419"
  },
  {
    "text": "is generally used to running on really good hardware so these things might not be true on your device",
    "start": "1857419",
    "end": "1866440"
  },
  {
    "text": "so this is another good quote we can solve any problem by introducing an",
    "start": "1867710",
    "end": "1873660"
  },
  {
    "text": "extra level of interaction except for the problem of too many levels of indirection and this is this is if you",
    "start": "1873660",
    "end": "1882300"
  },
  {
    "text": "are going to look inside of the chromium source code and this is something that you will feel deeply often because like",
    "start": "1882300",
    "end": "1890040"
  },
  {
    "text": "I said you have you have such a diverse set of hardware that you have to run on",
    "start": "1890040",
    "end": "1895920"
  },
  {
    "text": "there are so many layers of abstraction and it becomes really really hard to",
    "start": "1895920",
    "end": "1901290"
  },
  {
    "text": "follow and this is true for basically any any part of chromium so can I use I",
    "start": "1901290",
    "end": "1912440"
  },
  {
    "text": "don't know the thing it said this is not really it's not a prepackaged thing it's",
    "start": "1912440",
    "end": "1918000"
  },
  {
    "text": "not a library you can just take in this is this is something that has been specially engineered for the exact use",
    "start": "1918000",
    "end": "1924840"
  },
  {
    "text": "case that that chromium has but you might have a similar use case but probably your use case is a lot easier",
    "start": "1924840",
    "end": "1931530"
  },
  {
    "text": "you have known hardware you have known architecture you have a known operating",
    "start": "1931530",
    "end": "1938220"
  },
  {
    "text": "system you can actually if you're going to work around bugs in your driver you",
    "start": "1938220",
    "end": "1943290"
  },
  {
    "text": "have one driver all of these things makes makes your need for for complexity",
    "start": "1943290",
    "end": "1949380"
  },
  {
    "text": "a lot smaller so it's not exactly cut",
    "start": "1949380",
    "end": "1955110"
  },
  {
    "text": "and paste and like I said you can go and",
    "start": "1955110",
    "end": "1961350"
  },
  {
    "text": "check that your your browser and the GPU page and you will see exactly how much",
    "start": "1961350",
    "end": "1966890"
  },
  {
    "text": "control they have inserted in this the system and you might not need that at",
    "start": "1966890",
    "end": "1973620"
  },
  {
    "text": "all because they are using they're using OpenGL es2 and that's fine but they also",
    "start": "1973620",
    "end": "1981060"
  },
  {
    "text": "use their their chromium extensions and in addition to that they have their own",
    "start": "1981060",
    "end": "1986610"
  },
  {
    "text": "API is their own IP sees where they can they can also communicate right so all",
    "start": "1986610",
    "end": "1994620"
  },
  {
    "text": "non-trivial abstractions to some degree are leaky the they are trying to make",
    "start": "1994620",
    "end": "2000860"
  },
  {
    "text": "normal OpenGL es2 interface that you are programming against but it is normal in",
    "start": "2000860",
    "end": "2009240"
  },
  {
    "text": "quotation marks okay okay what can I use",
    "start": "2009240",
    "end": "2016550"
  },
  {
    "text": "I'm a consultant now so uh I'd probably advise against it but knowing that it",
    "start": "2017420",
    "end": "2028620"
  },
  {
    "text": "can be done has value because that is one of the things when you're trying to solve a problem that you don't know if",
    "start": "2028620",
    "end": "2034860"
  },
  {
    "text": "it's possible at all if you know that somebody has done it even though you don't know how they did it you know that",
    "start": "2034860",
    "end": "2042030"
  },
  {
    "text": "it can be done and that could have value when you choose you're going to try this thing you're going to dedicate a month",
    "start": "2042030",
    "end": "2048720"
  },
  {
    "text": "to try this architecture because it might solve a problem for you so knowing that it can be done might have value and",
    "start": "2048720",
    "end": "2056990"
  },
  {
    "text": "so maybe and that's my talk but I have a",
    "start": "2056990",
    "end": "2064500"
  },
  {
    "text": "little bit out in the end I have another talk it's on YouTube it's called deconstructing privilege I",
    "start": "2064500",
    "end": "2070679"
  },
  {
    "text": "made it ad and you see also in June and I I would really like you to watch it it",
    "start": "2070680",
    "end": "2078300"
  },
  {
    "text": "is a non-technical talk it's my pin it's fabulous",
    "start": "2078300",
    "end": "2084710"
  },
  {
    "text": "it's my is the link to it is on my pin tweet on Twitter and I would really",
    "start": "2084710",
    "end": "2092010"
  },
  {
    "text": "appreciate it if you took the time to watch it and that is my talk thank you",
    "start": "2092010",
    "end": "2101010"
  },
  {
    "text": "[Applause]",
    "start": "2101010",
    "end": "2104649"
  },
  {
    "text": "that way we do have a little time so if you want to ask me while I pack up we can go and do that okay I'll pack up now",
    "start": "2106060",
    "end": "2115750"
  }
]