[
  {
    "start": "0",
    "end": "91000"
  },
  {
    "text": "my name is uh Felix later I hope everybody had a nice coffee break now and you're all well awake maybe some",
    "start": "7020",
    "end": "13500"
  },
  {
    "text": "people just arrived after a longer sleep today I want to talk a little bit about",
    "start": "13500",
    "end": "19849"
  },
  {
    "text": "people about humans about mistakes and how you can actually use mistakes people",
    "start": "19849",
    "end": "26250"
  },
  {
    "text": "make to hack back do we have any pen testers here one it also counts if you",
    "start": "26250",
    "end": "33809"
  },
  {
    "text": "just hack your neighbors do we have any software developers here lots of them",
    "start": "33809",
    "end": "41460"
  },
  {
    "text": "amazing anybody like security architects working more on combining lots of systems into a",
    "start": "41460",
    "end": "48269"
  },
  {
    "text": "secure infrastructure 205 very good so",
    "start": "48269",
    "end": "53879"
  },
  {
    "text": "um we actually have the crowd that usually is in the disadvantages position you",
    "start": "53879",
    "end": "60929"
  },
  {
    "text": "know you guys always have to make sure that you don't have any mistakes in your software there are no mistakes in the",
    "start": "60929",
    "end": "66510"
  },
  {
    "text": "security architecture because if you forget something essential somewhere you make a mistake you're gonna get hacked",
    "start": "66510",
    "end": "72840"
  },
  {
    "text": "right and it happens eventually who has been hacked which company has been completely owned before I bet pretty",
    "start": "72840",
    "end": "83250"
  },
  {
    "text": "much everybody but nobody is allowed to admit it because that's what usually happens but let me give you some words",
    "start": "83250",
    "end": "90270"
  },
  {
    "text": "of confidence and that is everybody makes mistakes right it's not only the",
    "start": "90270",
    "end": "97020"
  },
  {
    "start": "91000",
    "end": "256000"
  },
  {
    "text": "defending side that makes mistakes but it's also the the attacking side for example malware authors and to give you",
    "start": "97020",
    "end": "104820"
  },
  {
    "text": "some of the similarities between a normal software developer and a meta we're author let's have a look at some",
    "start": "104820",
    "end": "111689"
  },
  {
    "text": "examples to illustrate what I mean everybody makes mistakes and you can see that actually everybody makes the same mistakes so here's a classic example I",
    "start": "111689",
    "end": "120359"
  },
  {
    "text": "love that because it's really like every software developer has made this mistake before this example is from best",
    "start": "120359",
    "end": "126479"
  },
  {
    "text": "antivirus 2011 so it's a few years old it's a fake antivirus that means it says",
    "start": "126479",
    "end": "133010"
  },
  {
    "text": "something's wrong on your system you know you've probably got a virus and in order to remove that virus you need to",
    "start": "133010",
    "end": "139110"
  },
  {
    "text": "buy the full version of our products so please enter your credit card number here and you will get the full version and then we will make everything",
    "start": "139110",
    "end": "145720"
  },
  {
    "text": "possible to remove that threat but actually there is no virus on your computer except of this best antivirus software",
    "start": "145720",
    "end": "152100"
  },
  {
    "text": "on your machine and because they know their business model is not a JIT they",
    "start": "152100",
    "end": "157540"
  },
  {
    "text": "want to avoid being analyzed by a real antivirus company or a malware analyst",
    "start": "157540",
    "end": "162880"
  },
  {
    "text": "or something similar and usually malware analysis happens inside virtual machines",
    "start": "162880",
    "end": "168450"
  },
  {
    "text": "well their target group the people they are targeting you reduce use real pcs you know like laptop or desktop or",
    "start": "168450",
    "end": "176050"
  },
  {
    "text": "whatever so they have implemented a check in there they basically used to get CPUID instruction from Intel CPUs",
    "start": "176050",
    "end": "183970"
  },
  {
    "text": "and use that to find out if the platform is hardware virtualized if the uppermost",
    "start": "183970",
    "end": "189670"
  },
  {
    "text": "bit is set they know they are running in a harbor virtualized environment and then they actually don't do the whole",
    "start": "189670",
    "end": "196060"
  },
  {
    "text": "crap that they are normally doing on the system they just pretend to be harmless let's say so um you see the disassembly",
    "start": "196060",
    "end": "205570"
  },
  {
    "text": "assembly on the top right while on the bottom you see like a recoded C version of what they have actually done do v-nec",
    "start": "205570",
    "end": "212560"
  },
  {
    "text": "coders in the room okay okay can you spot the problem here you can please can",
    "start": "212560",
    "end": "221380"
  },
  {
    "text": "you say it right so if you look at the",
    "start": "221380",
    "end": "227260"
  },
  {
    "text": "if statement over here its assigning this value of 8 and so on to the second",
    "start": "227260",
    "end": "233680"
  },
  {
    "text": "part of this area what they actually intended to do is to compare but they",
    "start": "233680",
    "end": "239680"
  },
  {
    "text": "were lacking an equal sign there classical mistake as a result actually",
    "start": "239680",
    "end": "245680"
  },
  {
    "text": "they always think they are running in a virtual environment and they never do the crap that they actually intended to",
    "start": "245680",
    "end": "250690"
  },
  {
    "text": "do another example also a mistake that",
    "start": "250690",
    "end": "258570"
  },
  {
    "start": "256000",
    "end": "403000"
  },
  {
    "text": "probably all of you have done not in the same sense but I'll get to the point",
    "start": "258570",
    "end": "263900"
  },
  {
    "text": "configure it's also a few years older anybody remember configure yeah old",
    "start": "263900",
    "end": "272340"
  },
  {
    "text": "timers configure was a very aggressive warm spreading it spread via an SMB",
    "start": "272340",
    "end": "278910"
  },
  {
    "text": "exploit similar to eternal blue which was pretty hip last year or what was the Linux one called again okay I also",
    "start": "278910",
    "end": "289440"
  },
  {
    "text": "forgot that anyways so almost ten million devices were infected including",
    "start": "289440",
    "end": "296130"
  },
  {
    "text": "military so for example the French Air Force they had their planes grounded for",
    "start": "296130",
    "end": "301560"
  },
  {
    "text": "two days because a flight plan database was infected all planes were grounded so",
    "start": "301560",
    "end": "308370"
  },
  {
    "text": "perfect situation for an attack from the outside forty that never happened the British Navy was also infected they",
    "start": "308370",
    "end": "315419"
  },
  {
    "text": "said we were a bit more lucky we only had two devices infected does anybody remember what those two devices were",
    "start": "315419",
    "end": "324320"
  },
  {
    "text": "aircraft carriers so they had two of",
    "start": "325760",
    "end": "330870"
  },
  {
    "text": "those infected not sure if they clean it up or head to reinstall everything and",
    "start": "330870",
    "end": "337950"
  },
  {
    "text": "the reason why configure was so successful is because it randomly chose the next target and the routine that",
    "start": "337950",
    "end": "344460"
  },
  {
    "text": "actually created the next target looked like this it was using the Windows rant function which creates a",
    "start": "344460",
    "end": "351120"
  },
  {
    "text": "random number and because the Windows ran function only returns a word you",
    "start": "351120",
    "end": "356490"
  },
  {
    "text": "basically need two of those one for the upper two numbers of an IP address and",
    "start": "356490",
    "end": "361919"
  },
  {
    "text": "one for the lower two numbers of an IP address and when you look at the",
    "start": "361919",
    "end": "367169"
  },
  {
    "text": "documentation for the rent function you see the rent function returns a pseudo-random integer in the range from",
    "start": "367169",
    "end": "372660"
  },
  {
    "text": "zero to rent max so the question here is what is rent Max and if you read the",
    "start": "372660",
    "end": "381300"
  },
  {
    "text": " manual you will actually find out that it's not using the full range of bits that are possible but it's only",
    "start": "381300",
    "end": "388289"
  },
  {
    "text": "using up to the value seven FFF because rent wants to avoid that somebody gets into trouble with signed numbers so they",
    "start": "388289",
    "end": "395699"
  },
  {
    "text": "don't use the full 16 bit so if you think about this basically two bits are",
    "start": "395699",
    "end": "401009"
  },
  {
    "text": "never used here so in the end configure only scan to less than 1/4 of the",
    "start": "401009",
    "end": "406349"
  },
  {
    "start": "403000",
    "end": "546000"
  },
  {
    "text": "internet and it was still so successful but they could have been up to 4 times they're successful just by reading the",
    "start": "406349",
    "end": "413039"
  },
  {
    "text": "manual and if you talk to some of the",
    "start": "413039",
    "end": "418919"
  },
  {
    "text": "people in your organization that maybe had to deal with configure at that time and they said we never had any problems",
    "start": "418919",
    "end": "425099"
  },
  {
    "text": "you know maybe it's not because of their security maybe it's because they are in this IP space that was never scanned ok",
    "start": "425099",
    "end": "433319"
  },
  {
    "text": "but since we are talking history who remembers Stuxnet ok that's a lot more people very good so Stuxnet it was",
    "start": "433319",
    "end": "440099"
  },
  {
    "text": "pretty interesting because it was really a sabotaging malware you know they used it to basically sabotage the uranium",
    "start": "440099",
    "end": "447689"
  },
  {
    "text": "enrichment in Iran pretty well planned pretty well developed and they wanted to",
    "start": "447689",
    "end": "453930"
  },
  {
    "text": "make sure that the whole campaign really only targets systems that they intend for so the installer of Stuxnet had this",
    "start": "453930",
    "end": "461189"
  },
  {
    "text": "checker of the Windows version numbers just to make sure we are not going for very old systems which we don't support",
    "start": "461189",
    "end": "468149"
  },
  {
    "text": "platform wise and so on we our software crashes and maybe also not newer versions so the idea was to use an",
    "start": "468149",
    "end": "475399"
  },
  {
    "text": "install only from Windows XP on which is Windows version 5 up to Windows 7 or 8",
    "start": "475399",
    "end": "481319"
  },
  {
    "text": "which is then Windows version 6 and you can see the statement on the top which",
    "start": "481319",
    "end": "486389"
  },
  {
    "text": "it should be it should be version is large or equal than 5 and smaller or",
    "start": "486389",
    "end": "491519"
  },
  {
    "text": "equal than 6 unfortunately when you program C you know you don't write and",
    "start": "491519",
    "end": "497969"
  },
  {
    "text": "or you don't write or but you use some strange characters like for example the",
    "start": "497969",
    "end": "503849"
  },
  {
    "text": "end sign or the pipe sign over here so",
    "start": "503849",
    "end": "509249"
  },
  {
    "text": "they mixed up these signs and instead of an end they actually end up with an or saying if the burden is larger equal",
    "start": "509249",
    "end": "515638"
  },
  {
    "text": "than 5 or smaller and equal than 6 so basically any version and the only thing",
    "start": "515639",
    "end": "521729"
  },
  {
    "text": "that say them is that they actually had another check in there that the platform needs to be NT otherwise they would have",
    "start": "521729",
    "end": "527550"
  },
  {
    "text": "crashed a lot of Windows XP 95 systems and fortunate Windows 10 was not out there because that would have also",
    "start": "527550",
    "end": "533730"
  },
  {
    "text": "created some problems so mistakes that a lot of people have done a lot of us have",
    "start": "533730",
    "end": "539819"
  },
  {
    "text": "done but if you have them in the context of malware they can screw up campaigns",
    "start": "539819",
    "end": "546199"
  },
  {
    "start": "546000",
    "end": "750000"
  },
  {
    "text": "let me give you some other information this is more from the information leakage side the Kiryas spam botnet one",
    "start": "546199",
    "end": "556290"
  },
  {
    "text": "of the biggest spam bot nets out there pre surfaced if sophisticated infrastructure using multi tiers similar",
    "start": "556290",
    "end": "563490"
  },
  {
    "text": "like a peer-to-peer botnet or a peer-to-peer network and it had a lot of",
    "start": "563490",
    "end": "569249"
  },
  {
    "text": "functionality which was pretty hard to analyze a lot of code in order to get",
    "start": "569249",
    "end": "574379"
  },
  {
    "text": "the details out you had to spend weeks if not months of reverse-engineering time but fortunately they included",
    "start": "574379",
    "end": "582179"
  },
  {
    "text": "actually a debug switch in there and with this debug switch you would",
    "start": "582179",
    "end": "587819"
  },
  {
    "text": "suddenly get a new console where it would print out in very nitty-gritty detail all the things that it would do",
    "start": "587819",
    "end": "593579"
  },
  {
    "text": "and I can tell you this is just heaven for reverse engineers because for every",
    "start": "593579",
    "end": "601319"
  },
  {
    "text": "function you step through it will output you all the data and everything it does it's fantastic here's another example of",
    "start": "601319",
    "end": "612299"
  },
  {
    "text": "information leakage energetic beer coming from Russia definitely used in",
    "start": "612299",
    "end": "618029"
  },
  {
    "text": "targeted tax mainly targeting the energy sector the idea here is to get all kinds",
    "start": "618029",
    "end": "623670"
  },
  {
    "text": "of information about the energy infrastructure control panels and so on",
    "start": "623670",
    "end": "631470"
  },
  {
    "text": "actually um I think two years ago there was an attack on the Ukraine and their",
    "start": "631470",
    "end": "636809"
  },
  {
    "text": "power infrastructure see some heads nodding was that two years ago two years",
    "start": "636809",
    "end": "642509"
  },
  {
    "text": "ago thank you for confirming so energetic beer is assumed that it was actually the malware for collecting the",
    "start": "642509",
    "end": "649379"
  },
  {
    "text": "data necessary in order to do that strike so um the idea was to exfiltrate",
    "start": "649379",
    "end": "654480"
  },
  {
    "text": "information and to not let anybody see what kind of data was exfiltrated they used RSA you know",
    "start": "654480",
    "end": "662510"
  },
  {
    "text": "military-grade encryption what kind of encryption algorithm is RSA asymmetric",
    "start": "662510",
    "end": "671310"
  },
  {
    "text": "thank you very much so a symmetric that means you have a public key and you have",
    "start": "671310",
    "end": "676950"
  },
  {
    "text": "a private key and you can only encrypt for example the public key and then only",
    "start": "676950",
    "end": "682830"
  },
  {
    "text": "decrypt with a private key and so what you can do is you can embed the public",
    "start": "682830",
    "end": "687840"
  },
  {
    "text": "key inside a malware encrypt the data and only the server on the other side which has the private key can decrypt",
    "start": "687840",
    "end": "693810"
  },
  {
    "text": "the data the beauty of RSA is you can actually also do it the other way around",
    "start": "693810",
    "end": "699630"
  },
  {
    "text": "you can use the private key embedded in a malware encrypt the data and then on",
    "start": "699630",
    "end": "705000"
  },
  {
    "text": "the server use the public key to decrypt the data so it works both ways around",
    "start": "705000",
    "end": "710900"
  },
  {
    "text": "that's also what the male authors knew that you can actually use it both ways",
    "start": "710900",
    "end": "715940"
  },
  {
    "text": "what they didn't know is that there are some libraries out there some crypto libraries and when you say I want to",
    "start": "715940",
    "end": "722340"
  },
  {
    "text": "export the private key they also include a copy of the public key and that's what",
    "start": "722340",
    "end": "728250"
  },
  {
    "text": "happened with energetic beer basically they were shipping the binaries with both keys and then in the end everybody",
    "start": "728250",
    "end": "735660"
  },
  {
    "text": "who wanted to investigate what data was actually exfiltrated could just go take the public key from the binary it was",
    "start": "735660",
    "end": "741780"
  },
  {
    "text": "actually possible in there and then see what data got stolen and even create like collections on the network okay so",
    "start": "741780",
    "end": "751860"
  },
  {
    "start": "750000",
    "end": "972000"
  },
  {
    "text": "information collection it's nice it helps on the defending side but it",
    "start": "751860",
    "end": "758250"
  },
  {
    "text": "doesn't really help defenders to hack back so let's have a look at some",
    "start": "758250",
    "end": "764580"
  },
  {
    "text": "mistakes that people have made that really ruin parts of your campaign who",
    "start": "764580",
    "end": "771990"
  },
  {
    "text": "has written on their CV I have been in the security industry for more than ten years one person very good then you're",
    "start": "771990",
    "end": "780180"
  },
  {
    "text": "probably the only one who knows this nice mare with the storm one from 2008",
    "start": "780180",
    "end": "785970"
  },
  {
    "text": "first version at least it was the first peer-to-peer button really sophisticated so think about this",
    "start": "785970",
    "end": "793110"
  },
  {
    "text": "they didn't really have an infrastructure like a server they would connect to to get new commands but they",
    "start": "793110",
    "end": "798240"
  },
  {
    "text": "were using a peer-to-peer network like BitTorrent for example actually there",
    "start": "798240",
    "end": "804290"
  },
  {
    "text": "there there p2p network was based on Kadeem dia so closer to emule and in order to get",
    "start": "804290",
    "end": "812520"
  },
  {
    "text": "commands they would just push out new files virtual files to the peer-to-peer infrastructure every infected machine",
    "start": "812520",
    "end": "818970"
  },
  {
    "text": "would get those and then execute the commands but because nobody knew who pushed these new commands into the",
    "start": "818970",
    "end": "825000"
  },
  {
    "text": "peer-to-peer network it was also not possible to find the origin so very",
    "start": "825000",
    "end": "830280"
  },
  {
    "text": "resilient infrastructure but they also had an HTTP component in there um it was",
    "start": "830280",
    "end": "836220"
  },
  {
    "text": "not using curl or any standard library or even windows components but they wrote their own custom HTTP client and",
    "start": "836220",
    "end": "844940"
  },
  {
    "text": "unfortunately somebody made a typo when they created the user agent can you spot",
    "start": "844940",
    "end": "851580"
  },
  {
    "text": "the typo windows yes so it didn't take",
    "start": "851580",
    "end": "859560"
  },
  {
    "text": "too long to create IDs signatures for that right and they were pretty good and",
    "start": "859560",
    "end": "865290"
  },
  {
    "text": "at one point the authors found out damn there's this signature on our user agent and it triggers all the time it seems",
    "start": "865290",
    "end": "872550"
  },
  {
    "text": "like our user agent is unique we need to fix that and they did they actually",
    "start": "872550",
    "end": "880500"
  },
  {
    "text": "fixed the user agent by removing the last three numbers you can imagine that",
    "start": "880500",
    "end": "886500"
  },
  {
    "text": "it didn't take very long until somebody updated the IDS signatures and they were tracked again let me give you an another",
    "start": "886500",
    "end": "896040"
  },
  {
    "text": "example how actually you can use problems in malware against it here's",
    "start": "896040",
    "end": "902400"
  },
  {
    "text": "sickie pot not really known where sickie pot is from you can find lots of Chinese",
    "start": "902400",
    "end": "908280"
  },
  {
    "text": "error messages in the binaries if you look closely one thing that's for sure it's it's a targeted attack the reason",
    "start": "908280",
    "end": "915000"
  },
  {
    "text": "for that is they burned all kinds of zero-days for internet explorer which are quite expensive in order to infect",
    "start": "915000",
    "end": "921870"
  },
  {
    "text": "their targets so definitely something that has a lot of",
    "start": "921870",
    "end": "927150"
  },
  {
    "text": "funding probably state sponsored again this piece has a some very nice",
    "start": "927150",
    "end": "932850"
  },
  {
    "text": "command-line arguments that you can use in this case it's removed Kay wires it was meant as a real as a clean up",
    "start": "932850",
    "end": "940710"
  },
  {
    "text": "tool for themselves so that they could remove and not to leave any traces on the system that they",
    "start": "940710",
    "end": "946770"
  },
  {
    "text": "ever was an infection the beauty of this is you as a defender if you get infected",
    "start": "946770",
    "end": "952110"
  },
  {
    "text": "and find out it's icky pot you can do the same thing you can also just run the same executable again and you're rid of",
    "start": "952110",
    "end": "959130"
  },
  {
    "text": "it forever okay no malware talk nowadays without",
    "start": "959130",
    "end": "968490"
  },
  {
    "text": "talking about ransomware right that's what scares people so let's also have a look at some ransomware",
    "start": "968490",
    "end": "975440"
  },
  {
    "start": "972000",
    "end": "1041000"
  },
  {
    "text": "here's one for Android it's called simple Locker it says you have child",
    "start": "975440",
    "end": "982740"
  },
  {
    "text": "pornography on your phone and you have to pay to the local authorities some fee",
    "start": "982740",
    "end": "988980"
  },
  {
    "text": "in order to let all charges go obviously you don't have that it also has a kimono",
    "start": "988980",
    "end": "995310"
  },
  {
    "text": "control I'm so over to get some more data what it does is it's basically",
    "start": "995310",
    "end": "1001660"
  },
  {
    "text": "encrypts all kinds of files that have some value for you like pictures for example documents text files and and my",
    "start": "1001660",
    "end": "1009590"
  },
  {
    "text": "private story to that is we had an analyst who accidentally got infected with that malware and he called me and",
    "start": "1009590",
    "end": "1015770"
  },
  {
    "text": "said Felix I have a problem I have basically more than one year of photos private photos that are only on my phone",
    "start": "1015770",
    "end": "1022250"
  },
  {
    "text": "I don't have any backups and these are really worth a lot because my wife is on there my kids is on there all this data",
    "start": "1022250",
    "end": "1028610"
  },
  {
    "text": "that's not worth a lot of stuff to me what was a lot of money actually more than money can buy what can we do and I",
    "start": "1028610",
    "end": "1035329"
  },
  {
    "text": "told him for now let's stay calm let's have a closer look at this and the first thing you do when you look at a ransomware is",
    "start": "1035330",
    "end": "1043610"
  },
  {
    "start": "1041000",
    "end": "1117000"
  },
  {
    "text": "you look at the file encryption function and there was a class called files encrypter and when we drilled down on it",
    "start": "1043610",
    "end": "1051320"
  },
  {
    "text": "we actually found out it's using AES and you know when you see a s the first",
    "start": "1051320",
    "end": "1056810"
  },
  {
    "text": "thought is  that's military-grade encryption and the algorithm is definitely not",
    "start": "1056810",
    "end": "1063710"
  },
  {
    "text": "breakable but then we looked and on the second look you actually see yeah it's",
    "start": "1063710",
    "end": "1070250"
  },
  {
    "text": "unbreakable unless you know the password which they hard-coded right in the function call so and then at that time",
    "start": "1070250",
    "end": "1078710"
  },
  {
    "text": "you can imagine the mood of our analyst went up and said hey you know what now I can code my own decrypted I told him",
    "start": "1078710",
    "end": "1085490"
  },
  {
    "text": "well that's wait a second let's also have a look at the decryption function and the decryption function was also",
    "start": "1085490",
    "end": "1091130"
  },
  {
    "text": "right in the binary and same thing AES encrypt and it all said the password hard-coded so the only thing our analyst",
    "start": "1091130",
    "end": "1097700"
  },
  {
    "text": "had to do is basically take that for take that class out put it into his own main routine and call it and all his",
    "start": "1097700",
    "end": "1105529"
  },
  {
    "text": "phone was clean again so he was very happy let's have a look at something for",
    "start": "1105529",
    "end": "1116120"
  },
  {
    "text": "PCs another ransomware and that's a pretty nasty one so a same same scheme",
    "start": "1116120",
    "end": "1122809"
  },
  {
    "start": "1117000",
    "end": "1275000"
  },
  {
    "text": "bayesian Crips all your files actually a lot more than the ones we have seen before all kinds of suffix also mp3s and",
    "start": "1122809",
    "end": "1130159"
  },
  {
    "text": "stuff that you might like in some way and it says you need to pay one Bitcoin in order to get your data back and",
    "start": "1130159",
    "end": "1136520"
  },
  {
    "text": "submit it to this wallet address or if you don't have that money if you're a",
    "start": "1136520",
    "end": "1142279"
  },
  {
    "text": "poor student we give you an alternative which is quite nasty just go and in fact three of your friends so which choice",
    "start": "1142279",
    "end": "1152360"
  },
  {
    "text": "would you have made that's pretty nasty",
    "start": "1152360",
    "end": "1158390"
  },
  {
    "text": "I tell you later why they did it that way so again same thing you first start",
    "start": "1158390",
    "end": "1164539"
  },
  {
    "text": "looking at the encryption function and this way this time you can see they have",
    "start": "1164539",
    "end": "1169909"
  },
  {
    "text": "not hard-coded the password where the function is called but basically you need to provide a password you need to",
    "start": "1169909",
    "end": "1176299"
  },
  {
    "text": "compute or they compute the hash of the password and then use that to again AES",
    "start": "1176299",
    "end": "1181570"
  },
  {
    "text": "encrypt the files so in this in this malware it's not as easy as before but",
    "start": "1181570",
    "end": "1189770"
  },
  {
    "text": "if you look like where does actually the past for encryption come from you find it",
    "start": "1189770",
    "end": "1194960"
  },
  {
    "text": "it's actually a static string inside the same binary so you just have to search a",
    "start": "1194960",
    "end": "1200900"
  },
  {
    "text": "bit like what strings do we have and maybe try out a few and yeah that works",
    "start": "1200900",
    "end": "1206570"
  },
  {
    "text": "like charm um if you don't like to reverse-engineer the whole thing and",
    "start": "1206570",
    "end": "1211880"
  },
  {
    "text": "find out if this real thing and really want to brute force it's actually having a countermeasure against that it tells",
    "start": "1211880",
    "end": "1218720"
  },
  {
    "text": "you hey enter the wrong code you have three attempts left now and then we will",
    "start": "1218720",
    "end": "1224240"
  },
  {
    "text": "do something nasty with your system however the state machine for these three attempts is stored in memory so",
    "start": "1224240",
    "end": "1231620"
  },
  {
    "text": "you just need to reboot your computer you get a new three attempts or even better you just need to restart the",
    "start": "1231620",
    "end": "1237260"
  },
  {
    "text": "executable and get three new attempts and to tell you the full story they count down to down to zero and at zero",
    "start": "1237260",
    "end": "1244159"
  },
  {
    "text": "they say in two hours something bad will happen but they have never implemented the logic for something bad state",
    "start": "1244159",
    "end": "1254150"
  },
  {
    "text": "machines they are wonderful also same malware popcorn time they basic give you",
    "start": "1254150",
    "end": "1260390"
  },
  {
    "text": "seven days to pay the ransom or something bad will happen this time they",
    "start": "1260390",
    "end": "1268010"
  },
  {
    "text": "said okay in seven days maybe this computer gets rebooted so we don't store that a memory but we store this information on disk the way they store",
    "start": "1268010",
    "end": "1276140"
  },
  {
    "text": "it on disk is a file called time file name which actually has the termination",
    "start": "1276140",
    "end": "1282559"
  },
  {
    "text": "date as a txt so if you want you can just go in there with you with notepad or any other edit or change the time and",
    "start": "1282559",
    "end": "1288559"
  },
  {
    "text": "sorry suddenly you have 40,000 days left for this ransomware I can tell you there's lots of things",
    "start": "1288559",
    "end": "1297500"
  },
  {
    "text": "wrong with this one so I've just too much stuff on that particular one so if",
    "start": "1297500",
    "end": "1302750"
  },
  {
    "text": "you don't like to break open executable or if brute-forcing is too scary for you and you might",
    "start": "1302750",
    "end": "1309159"
  },
  {
    "text": "eventually lose some data if you don't want to take that risk there's another approach here so what they are doing is",
    "start": "1309159",
    "end": "1316220"
  },
  {
    "text": "they are not over writing your data but they are taking a copy of your data they",
    "start": "1316220",
    "end": "1321290"
  },
  {
    "text": "encrypt that write that to disk and then delete the old file so the old file is gone but not completely",
    "start": "1321290",
    "end": "1327980"
  },
  {
    "text": "because usually the data is still on disk because the new file has been written to some free space and the",
    "start": "1327980",
    "end": "1334510"
  },
  {
    "text": "deleted file is not overwritten necessarily so what you can do easily is use a Windows system restore point or if",
    "start": "1334510",
    "end": "1341930"
  },
  {
    "text": "you have like an undelete software that's carving deep down on disk you can also get your files back so you don't",
    "start": "1341930",
    "end": "1347210"
  },
  {
    "text": "even have to pay if you want to avoid",
    "start": "1347210",
    "end": "1352970"
  },
  {
    "text": "infection completely for popcorntime it's also possible because they are also",
    "start": "1352970",
    "end": "1360860"
  },
  {
    "text": "writing a file called being here when you have cleaned up the system doesn't",
    "start": "1360860",
    "end": "1366650"
  },
  {
    "text": "need to be anything in the init file it doesn't have to be signed or anything just has to be there in your app data",
    "start": "1366650",
    "end": "1372830"
  },
  {
    "text": "roaming folder and if it's there well it will never infect you again so you can",
    "start": "1372830",
    "end": "1379760"
  },
  {
    "text": "see even with ransomware there lots of possibilities how you can actually use some problems they have against them so",
    "start": "1379760",
    "end": "1388450"
  },
  {
    "text": "now I'm feeling a bit bad because I have to tell you who actually wrote this ransomware because they say themselves",
    "start": "1388450",
    "end": "1397070"
  },
  {
    "start": "1394000",
    "end": "1457000"
  },
  {
    "text": "on a webpage that opens up when you get affected they say we are a group of",
    "start": "1397070",
    "end": "1402710"
  },
  {
    "text": "computer science students from Syria and we're just trying to do some fundraising basically in voluntary donations to",
    "start": "1402710",
    "end": "1411260"
  },
  {
    "text": "Syria so all the bitcoins that you give us will actually end up to be something good okay so I'm sorry for flaming",
    "start": "1411260",
    "end": "1419560"
  },
  {
    "text": "student project here actually those students were quite smart because they",
    "start": "1419560",
    "end": "1426290"
  },
  {
    "text": "were not the typical criminals so they don't didn't have access to the same infrastructure to get the malware out to",
    "start": "1426290",
    "end": "1431960"
  },
  {
    "text": "lots of computers and then I thought what can we do to actually make this malware spread if we don't know these",
    "start": "1431960",
    "end": "1438560"
  },
  {
    "text": "criminal Russians that put it on all kinds of computers well we just ask people themselves to spread to their",
    "start": "1438560",
    "end": "1444260"
  },
  {
    "text": "friends you know that's where the scheme came from in fact three of your friends and you will get your data so using a",
    "start": "1444260",
    "end": "1450470"
  },
  {
    "text": "snowball effect okay so I'm sorry for flaming a few students let's get back to",
    "start": "1450470",
    "end": "1456380"
  },
  {
    "text": "some professional malware somebody seen this domain name before",
    "start": "1456380",
    "end": "1461850"
  },
  {
    "text": "hey wow you've got experience man been around for more than ten years and still",
    "start": "1461850",
    "end": "1467289"
  },
  {
    "text": "no the reason awesome what is it yes this is a domain",
    "start": "1467289",
    "end": "1477250"
  },
  {
    "text": "that was found in wanna cry one cry was really big last year was again similar to configure",
    "start": "1477250",
    "end": "1484210"
  },
  {
    "text": "spreading via SMB using the eternal blue SMB exploit which was essentially leaked",
    "start": "1484210",
    "end": "1490000"
  },
  {
    "text": "from the NSA so thanks NSA for getting this big into it warm out there a lot of people say it",
    "start": "1490000",
    "end": "1498789"
  },
  {
    "text": "was North Korea actually putting this out it's definitely there's still definitely",
    "start": "1498789",
    "end": "1505330"
  },
  {
    "text": "something strange about it so let's assume it was North Korea it infected about 300,000 computers in 150 countries",
    "start": "1505330",
    "end": "1513159"
  },
  {
    "text": "and if you track the wallet you find out they made about a hundred and thirty",
    "start": "1513159",
    "end": "1518470"
  },
  {
    "text": "thousand US dollars not quite enough for a new rocket launch but at least some",
    "start": "1518470",
    "end": "1524529"
  },
  {
    "text": "money so the point of ransomware is or",
    "start": "1524529",
    "end": "1532600"
  },
  {
    "start": "1529000",
    "end": "1621000"
  },
  {
    "text": "if you want to sabotage stuff is you want to have it out as long as possible right so you want to avoid being",
    "start": "1532600",
    "end": "1538620"
  },
  {
    "text": "analyzed and you want to avoid that somebody hex back on you and in order",
    "start": "1538620",
    "end": "1544450"
  },
  {
    "text": "for somebody to analyze your malware they usually have analysis environments and they made a pretty strange",
    "start": "1544450",
    "end": "1554620"
  },
  {
    "text": "assumption here saying you know this domain is so random and so long that",
    "start": "1554620",
    "end": "1560860"
  },
  {
    "text": "nobody in the world has registered that domain now if we actually our resort'",
    "start": "1560860",
    "end": "1566380"
  },
  {
    "text": "are able to resolve this domain we are probably in the malware analysis laboratory where every domain is",
    "start": "1566380",
    "end": "1572140"
  },
  {
    "text": "resolved and you know what so if we can resolve this domain we think we are in a",
    "start": "1572140",
    "end": "1578230"
  },
  {
    "text": "malware analysis lab so we just stay put and don't do anything",
    "start": "1578230",
    "end": "1584970"
  },
  {
    "text": "so then this smart guy Marcus Hutchins came along and he thought well why don't we register this",
    "start": "1586880",
    "end": "1593760"
  },
  {
    "text": "domain then and that's the reason why they only made a hundred and thirty thousand US dollars because he registered that domain and suddenly all",
    "start": "1593760",
    "end": "1600150"
  },
  {
    "text": "instances all over the world thought wow we're running in a malware analysis lab that stopped working so he basically",
    "start": "1600150",
    "end": "1606780"
  },
  {
    "text": "made sure that this whole campaign stopped at once so I'm not sure if all",
    "start": "1606780",
    "end": "1616980"
  },
  {
    "text": "of you considered this hacking what we had so far so let's move more into their space of what people really consider",
    "start": "1616980",
    "end": "1624750"
  },
  {
    "start": "1621000",
    "end": "1663000"
  },
  {
    "text": "hacking starting slowly I have to admit here's an example from a Zeus drop zone",
    "start": "1624750",
    "end": "1631200"
  },
  {
    "text": "Zeus is a pretty famous banking Trojan and it uses MySQL usually as a back-end",
    "start": "1631200",
    "end": "1637280"
  },
  {
    "text": "and is called databases and for this particular one if you went to their",
    "start": "1637280",
    "end": "1642480"
  },
  {
    "text": "command control server and just appended slash PHP myadmin to the URL you would end up at this",
    "start": "1642480",
    "end": "1649230"
  },
  {
    "text": "screen so they use them that to set up the whole database but they forgot to",
    "start": "1649230",
    "end": "1655980"
  },
  {
    "text": "set the root password which means everybody gets access to that page and full access to their database including",
    "start": "1655980",
    "end": "1663179"
  },
  {
    "start": "1663000",
    "end": "1692000"
  },
  {
    "text": "all of the reports in all of the stolen banking data credit card data certificates anything that they have",
    "start": "1663179",
    "end": "1670260"
  },
  {
    "text": "stolen from somewhere accessible to anybody just knowing the URL when we",
    "start": "1670260",
    "end": "1677040"
  },
  {
    "text": "came across this we thought they probably going to fix that at one point because we also know that a lot of",
    "start": "1677040",
    "end": "1682860"
  },
  {
    "text": "researchers use try that out PHP myadmin suffix and we want to make sure that we",
    "start": "1682860",
    "end": "1689100"
  },
  {
    "text": "actually get access to that panel for a little bit longer fortunately there's a user table and if you look in the user",
    "start": "1689100",
    "end": "1697559"
  },
  {
    "start": "1692000",
    "end": "1713000"
  },
  {
    "text": "table there was just one entry and an md5 password and talking about good and",
    "start": "1697559",
    "end": "1704640"
  },
  {
    "text": "bad passwords we thought okay we probably have to get a rainbow table from somewhere and have a look maybe",
    "start": "1704640",
    "end": "1710940"
  },
  {
    "text": "after a few days we find something but actually we only had to Google because",
    "start": "1710940",
    "end": "1716040"
  },
  {
    "text": "the password was a strong Tony not sure if anybody speaks Italian please don't translate so with this",
    "start": "1716040",
    "end": "1727320"
  },
  {
    "text": "excess especially their MySQL access you can pretty much do whatever you want to on this server since we talked about",
    "start": "1727320",
    "end": "1736440"
  },
  {
    "start": "1735000",
    "end": "1801000"
  },
  {
    "text": "banking Trojans here's another example and that's a pretty cool example actually when you took a look at the technical sophistication it all is",
    "start": "1736440",
    "end": "1745050"
  },
  {
    "text": "normal banking Trojan which means it modifies your browser hooks into your browser and then as you go to a banking",
    "start": "1745050",
    "end": "1752700"
  },
  {
    "text": "website it transfers money to different accounts that you have entered does all",
    "start": "1752700",
    "end": "1758490"
  },
  {
    "text": "kinds of modification and maybe ask you to enter multiple tens or pins in order",
    "start": "1758490",
    "end": "1763560"
  },
  {
    "text": "to make a transaction and so on the cool thing about your luteal is it does not",
    "start": "1763560",
    "end": "1768570"
  },
  {
    "text": "show you that something was transferred from your bank account but it keeps a fake state machine of how your account",
    "start": "1768570",
    "end": "1775740"
  },
  {
    "text": "is supposed to look like so if it helped for example to transfer $1,000 to russia",
    "start": "1775740",
    "end": "1782240"
  },
  {
    "text": "you would still see the $1,000 in your bank account because it would modify the",
    "start": "1782240",
    "end": "1787800"
  },
  {
    "text": "output of your browser in a way that you always appeared like the transfer had never happened so that's that's",
    "start": "1787800",
    "end": "1794580"
  },
  {
    "text": "something you don't see in many of these of these tools and that's a neat feature of your little so the your little back",
    "start": "1794580",
    "end": "1803790"
  },
  {
    "start": "1801000",
    "end": "1847000"
  },
  {
    "text": "end is written in in PHP and you can see all the information on the left side",
    "start": "1803790",
    "end": "1809610"
  },
  {
    "text": "that is transmitted as part of a command and control request and you can see on",
    "start": "1809610",
    "end": "1815460"
  },
  {
    "text": "the right side that these guy actually knew their and they do some sanitization what I haven't told you yet",
    "start": "1815460",
    "end": "1824070"
  },
  {
    "text": "is on the left side you see all of the variables that are sent and on the right",
    "start": "1824070",
    "end": "1829350"
  },
  {
    "text": "side you also see all of the variables that are sanitized so have a close look",
    "start": "1829350",
    "end": "1835560"
  },
  {
    "text": "how many variables are actually sanitized and how many variables they get so why in the world would you only",
    "start": "1835560",
    "end": "1842160"
  },
  {
    "text": "Senate eyes two variables when you have 11 and total that you're sending over and with that you can basically craft",
    "start": "1842160",
    "end": "1850920"
  },
  {
    "text": "craft some really neat equal injections and own their whole infrastructure anybody ever been",
    "start": "1850920",
    "end": "1863369"
  },
  {
    "text": "infected with a mobile malware not that",
    "start": "1863369",
    "end": "1870570"
  },
  {
    "text": "you know very good point actually in mobile malware has been around for some",
    "start": "1870570",
    "end": "1876749"
  },
  {
    "start": "1871000",
    "end": "1981000"
  },
  {
    "text": "time but not construction kids construction kids like we have for zoos and other or plugging sore other PC",
    "start": "1876749",
    "end": "1885059"
  },
  {
    "text": "based Trojans we didn't have those for a long time for mobile phones but one of the first ones was add Android actually",
    "start": "1885059",
    "end": "1892769"
  },
  {
    "text": "was quite cheap it was developed people found out later by an intern from the security vendor",
    "start": "1892769",
    "end": "1900779"
  },
  {
    "text": "fireEye so this guy during his internship he learned a little bit about what",
    "start": "1900779",
    "end": "1906509"
  },
  {
    "text": "construction kits and he also learned about mobile and then he said okay why don't we craft something similar for for",
    "start": "1906509",
    "end": "1914159"
  },
  {
    "text": "mobile devices and it was actually had some pretty cool features like you could take any app that you thought was",
    "start": "1914159",
    "end": "1919710"
  },
  {
    "text": "popular put it into his tool and he would repackage all of his bad creation into that new app so you could for",
    "start": "1919710",
    "end": "1928019"
  },
  {
    "text": "example say I take Twitter and put all of my bad functionality into Twitter and then put this out somewhere on the",
    "start": "1928019",
    "end": "1934080"
  },
  {
    "text": "market again and it also had some pretty neat features like it could record phone",
    "start": "1934080",
    "end": "1939450"
  },
  {
    "text": "calls remotely activate microphone and camera spy on your SMS and calls and so",
    "start": "1939450",
    "end": "1945659"
  },
  {
    "text": "on and think about this that's a real threat I mean the mobile phones are always with us and you probably also",
    "start": "1945659",
    "end": "1953399"
  },
  {
    "text": "take your phones to most meetings very often probably also to confidential",
    "start": "1953399",
    "end": "1958710"
  },
  {
    "text": "meetings maybe where finance or company strategy or whatever is discussed and if somebody has the ability to at any point",
    "start": "1958710",
    "end": "1965729"
  },
  {
    "text": "in time activate the microphone in the camera you are basic bringing your own bugging device into those meetings but",
    "start": "1965729",
    "end": "1974239"
  },
  {
    "text": "I'm not here today to scare you I want to talk about what you can learn from an",
    "start": "1974239",
    "end": "1980369"
  },
  {
    "text": "intern actually this intern learned a lot he learned about prepared statements",
    "start": "1980369",
    "end": "1986040"
  },
  {
    "start": "1981000",
    "end": "2124000"
  },
  {
    "text": "has anybody heard about prepar'd sequel statements okay very good very good we",
    "start": "1986040",
    "end": "1992040"
  },
  {
    "text": "have some people but let me briefly explain how a sequel injection works not in detail but just roughly basically you",
    "start": "1992040",
    "end": "2000470"
  },
  {
    "text": "create a control string for the database craft that in some way and then hand it over to like here the query function and",
    "start": "2000470",
    "end": "2007970"
  },
  {
    "text": "then the database is executing this query and if you at the point where you",
    "start": "2007970",
    "end": "2015950"
  },
  {
    "text": "have external content like the UID include something that terminates for example some quotes that you had in",
    "start": "2015950",
    "end": "2022430"
  },
  {
    "text": "there before you end up in a situation where the database X actually runs a",
    "start": "2022430",
    "end": "2030020"
  },
  {
    "text": "differently controlled statement that something that does something completely different we don't have to go into the",
    "start": "2030020",
    "end": "2037520"
  },
  {
    "text": "very nitty-gritty details the difference from prepared statements here is in the",
    "start": "2037520",
    "end": "2044030"
  },
  {
    "text": "prepared statement you don't make this connection between data and control functions yourself but basically you're",
    "start": "2044030",
    "end": "2050929"
  },
  {
    "text": "just saying I put some placeholders in the control statement then you prepare",
    "start": "2050929",
    "end": "2055970"
  },
  {
    "text": "it and then you hand over the arguments to the database and the database is doing all the necessary steps to keep",
    "start": "2055970",
    "end": "2062690"
  },
  {
    "text": "you safe so in the end you cannot have sequel injections anymore because the",
    "start": "2062690",
    "end": "2068690"
  },
  {
    "text": "database is making sure that the data you enter is safe cool right",
    "start": "2068690",
    "end": "2074560"
  },
  {
    "text": "who's using that who's using prepared statements who's still using the top form",
    "start": "2074560",
    "end": "2080679"
  },
  {
    "text": "nobody's admitting everybody's doing it okay here's how the internet at fire I",
    "start": "2080679",
    "end": "2087200"
  },
  {
    "text": "did it he basically said okay um I'll create like the control string and also",
    "start": "2087200",
    "end": "2093649"
  },
  {
    "text": "include the data then give this to the prepare statement but because the database doesn't have to do anything",
    "start": "2093650",
    "end": "2099650"
  },
  {
    "text": "because I have already done all the work I don't need to add any arguments so he reintroduced the concept of sequel",
    "start": "2099650",
    "end": "2106370"
  },
  {
    "text": "injections into prepared statements",
    "start": "2106370",
    "end": "2111700"
  },
  {
    "text": "if you are doing a sequel work and maybe want to have a new intern who wants to",
    "start": "2112770",
    "end": "2118200"
  },
  {
    "text": "learn something then why don't you contact him okay let's move on to more",
    "start": "2118200",
    "end": "2126000"
  },
  {
    "start": "2124000",
    "end": "2189000"
  },
  {
    "text": "sophisticated infrastructures and away--but from just sequel injections here's another example the whale deck",
    "start": "2126000",
    "end": "2132750"
  },
  {
    "text": "bought that whale deck had a pretty sophisticated infrastructure it would",
    "start": "2132750",
    "end": "2138300"
  },
  {
    "text": "never tell you who is which is the real command control server it would always relay every request from an infected",
    "start": "2138300",
    "end": "2145920"
  },
  {
    "text": "system through other infected systems and a layer of proxies until you end up",
    "start": "2145920",
    "end": "2151020"
  },
  {
    "text": "at the real command control server the idea there is that nobody ever knows who",
    "start": "2151020",
    "end": "2156540"
  },
  {
    "text": "is the final server because you're going through multiple tiers and you're only talking to the next level of infected",
    "start": "2156540",
    "end": "2162750"
  },
  {
    "text": "machines so if you want to see what's going on in such a botnet there's a very",
    "start": "2162750",
    "end": "2169770"
  },
  {
    "text": "nice position and that is right in the middle because you get a lot of traffic",
    "start": "2169770",
    "end": "2175770"
  },
  {
    "text": "from all kinds of infected machines and then can maybe see what's happening",
    "start": "2175770",
    "end": "2180839"
  },
  {
    "text": "there so when we were researching this botnet we were actually thinking how do we become such a relay and we did some",
    "start": "2180839",
    "end": "2188280"
  },
  {
    "text": "experiments and we found out that for example if you provide full internet access like no firewall good bandwidth",
    "start": "2188280",
    "end": "2194849"
  },
  {
    "start": "2189000",
    "end": "2235000"
  },
  {
    "text": "and you have to wait about like 45 minutes sometimes an hour and then you would be promoted to such a relay I can",
    "start": "2194849",
    "end": "2204390"
  },
  {
    "text": "tell you when you reverse engineer stuff 45 minutes is a boring long time if you",
    "start": "2204390",
    "end": "2210060"
  },
  {
    "text": "have to wait for feedback it sucks and you do that maybe for half a day but",
    "start": "2210060",
    "end": "2215910"
  },
  {
    "text": "then you say no there has to be a different way and actually yes there was a different way they had a command-line",
    "start": "2215910",
    "end": "2221760"
  },
  {
    "text": "switch you could just say - are and suddenly you became a relay hey beautiful that simplifies things a bit",
    "start": "2221760",
    "end": "2231170"
  },
  {
    "text": "way like was actually also properly architectured there used our say for",
    "start": "2231170",
    "end": "2237089"
  },
  {
    "text": "encryption again military-grade right and they had a well planned command and",
    "start": "2237089",
    "end": "2242910"
  },
  {
    "text": "control stack you have to say so they used XML for formatting the",
    "start": "2242910",
    "end": "2249450"
  },
  {
    "text": "messages and what's the problem with XML it's big right XML gets huge and bloated",
    "start": "2249450",
    "end": "2259350"
  },
  {
    "text": "so how do you deal with data that's huge and bloated well you just compress it so they took",
    "start": "2259350",
    "end": "2265470"
  },
  {
    "text": "XML be zipped it but be zipped is still something that everybody can read so you",
    "start": "2265470",
    "end": "2271890"
  },
  {
    "text": "need to add some level of security and in that case that was aes and the keys were exchanged using RSA so best",
    "start": "2271890",
    "end": "2279150"
  },
  {
    "text": "practice military-grade again but they wanted to use HTTP connections because",
    "start": "2279150",
    "end": "2285390"
  },
  {
    "text": "HTTP traffic that's kind of not suspicious if you create your own custom binary protocol that's usually held up",
    "start": "2285390",
    "end": "2292200"
  },
  {
    "text": "by firewalls next-generation firewalls and so on so in order to get binary data",
    "start": "2292200",
    "end": "2297480"
  },
  {
    "text": "through HTTP connections they used base64 and because basics t4 by itself",
    "start": "2297480",
    "end": "2303060"
  },
  {
    "text": "is not supported by GP they also needed to URL encoded it in some form by",
    "start": "2303060",
    "end": "2308190"
  },
  {
    "text": "changing a few characters so then they had like a beautiful stack that fit all the requirements okay I'm looking a bit",
    "start": "2308190",
    "end": "2318660"
  },
  {
    "start": "2317000",
    "end": "2404000"
  },
  {
    "text": "at the encryption so they had pretty much three keys - were hard-coded for",
    "start": "2318660",
    "end": "2323670"
  },
  {
    "text": "exchanging relay nodes and for exchanging client RSA keys to the server",
    "start": "2323670",
    "end": "2329060"
  },
  {
    "text": "but the important one is actually the session key for command control traffic",
    "start": "2329060",
    "end": "2334290"
  },
  {
    "text": "between infected system through the whole chain to the command control server and we observed that key for some",
    "start": "2334290",
    "end": "2344580"
  },
  {
    "text": "time actually at the top down here you see the session key for January in the",
    "start": "2344580",
    "end": "2350370"
  },
  {
    "text": "second line you see the session key for February in the third line you see the session key for March than April then",
    "start": "2350370",
    "end": "2356310"
  },
  {
    "text": "may I you can see that actually the key never changed and stuff like this",
    "start": "2356310",
    "end": "2362010"
  },
  {
    "text": "happens when you create a threaded server and some threats like Windows",
    "start": "2362010",
    "end": "2368610"
  },
  {
    "text": "they don't see the random number generator so you always end up with the same beginning seed and if you create a",
    "start": "2368610",
    "end": "2374190"
  },
  {
    "text": "new random number and new keys like that you always end up with the same key and they didn't see it",
    "start": "2374190",
    "end": "2379860"
  },
  {
    "text": "so what we did we created a decrypter and told our friends we can break ours a because we can always extract the",
    "start": "2379860",
    "end": "2386160"
  },
  {
    "text": "session key they were pretty impressed until they found other we were just playing them ok",
    "start": "2386160",
    "end": "2396000"
  },
  {
    "text": "so now we are man in the middle we can crack open their crypto and we can actually encrypt as well because we know",
    "start": "2396000",
    "end": "2402330"
  },
  {
    "text": "the AES session key then we started investigating what is actually inside the command control protocol and we",
    "start": "2402330",
    "end": "2409680"
  },
  {
    "text": "found out that they are downloading pictures in there and I wanted to share",
    "start": "2409680",
    "end": "2414750"
  },
  {
    "text": "a little bit about the picture we found here but this is not really for",
    "start": "2414750",
    "end": "2421050"
  },
  {
    "start": "2415000",
    "end": "2459000"
  },
  {
    "text": "everybody so um if you were not if you have problems with this bad pictures",
    "start": "2421050",
    "end": "2426330"
  },
  {
    "text": "please um close your eyes now seriously this is not for everybody there was the",
    "start": "2426330",
    "end": "2436020"
  },
  {
    "text": "picture they were sending us politician in his best form when you reverse",
    "start": "2436020",
    "end": "2445080"
  },
  {
    "text": "engineer I tell you you were always interested in the naked truth so we",
    "start": "2445080",
    "end": "2452580"
  },
  {
    "text": "didn't see the whole naked truth yet we wanted to know what's actually under his pants and we did find something there",
    "start": "2452580",
    "end": "2459060"
  },
  {
    "start": "2459000",
    "end": "2519000"
  },
  {
    "text": "we found a signature and an X or encoded version of a binary which would then be",
    "start": "2459060",
    "end": "2464750"
  },
  {
    "text": "downloaded decode it and then execute it on the infected systems so there are",
    "start": "2464750",
    "end": "2474270"
  },
  {
    "text": "three problems here now you can easily become men in the middle they have screwed up the encryption even",
    "start": "2474270",
    "end": "2481590"
  },
  {
    "text": "though using RSA and AES because of not thinking about the random number generator that's creating in the keys",
    "start": "2481590",
    "end": "2486660"
  },
  {
    "text": "and third of all there's an easy way to create payloads just using some simple",
    "start": "2486660",
    "end": "2493740"
  },
  {
    "text": "XOR so putting this all together you can actually push your own cleanup utility",
    "start": "2493740",
    "end": "2498810"
  },
  {
    "text": "to all infected machines and do all kinds of other things you can also divert the infrastructure and then take",
    "start": "2498810",
    "end": "2505380"
  },
  {
    "text": "over the whole botnet and actually we did so and there are still some infected machines reporting stolen passwords to",
    "start": "2505380",
    "end": "2512250"
  },
  {
    "text": "some of our sinkholes",
    "start": "2512250",
    "end": "2515390"
  },
  {
    "start": "2519000",
    "end": "2647000"
  },
  {
    "text": "sometimes you don't even need to hack the infrastructure itself but you can do some tricks in order to divert some",
    "start": "2519290",
    "end": "2525540"
  },
  {
    "text": "traffic so we started with configure let's also end with configure configure",
    "start": "2525540",
    "end": "2531150"
  },
  {
    "text": "a had this random number generation as a",
    "start": "2531150",
    "end": "2537900"
  },
  {
    "text": "random IP generation that we talked about the very beginning there was one limitation to that it was using a GU IP",
    "start": "2537900",
    "end": "2544470"
  },
  {
    "text": "database and looked up the IP it randomly generated and if it found out this next IP address I want to attack is",
    "start": "2544470",
    "end": "2551370"
  },
  {
    "text": "in the Ukraine I'll skip it I'll move on to the next one what does that tell us",
    "start": "2551370",
    "end": "2559880"
  },
  {
    "text": "do we have any any analysts here like political analysts because they always",
    "start": "2561140",
    "end": "2567090"
  },
  {
    "text": "tell you it's not that easy my friend it's more likely that it's actually the",
    "start": "2567090",
    "end": "2572100"
  },
  {
    "text": "Russians trying the Ukrainians for creating something like that and if you look at the current political situation",
    "start": "2572100",
    "end": "2577380"
  },
  {
    "text": "between Russia and Ukraine it's highly likely or if you know how smart Trump is",
    "start": "2577380",
    "end": "2583220"
  },
  {
    "text": "and you can also say it's Trump blaming the Russians for blaming the Ukrainians for creating a conflict there could also",
    "start": "2583220",
    "end": "2592200"
  },
  {
    "text": "be that North Korea is trying to blame America for blaming Russia for blaming the Ukrainians but let's not go into",
    "start": "2592200",
    "end": "2598290"
  },
  {
    "text": "these details the database that they were using is from a company called Mex",
    "start": "2598290",
    "end": "2603300"
  },
  {
    "text": "mind anybody heard about max mind some people so max mind because they were",
    "start": "2603300",
    "end": "2609570"
  },
  {
    "text": "almost 10 million machines infected they were dust ddosed on voluntarily because",
    "start": "2609570",
    "end": "2616020"
  },
  {
    "text": "every instance of configure would download the full database extracted locally on disk and then run these",
    "start": "2616020",
    "end": "2622140"
  },
  {
    "text": "queries so max minds they had to take their database down and move it to a different location not the hard-coded",
    "start": "2622140",
    "end": "2628080"
  },
  {
    "text": "your l that configure was using and so they only serve to 404 and then we went",
    "start": "2628080",
    "end": "2634590"
  },
  {
    "text": "to max man and said you know what we've crafted this rather small variant of",
    "start": "2634590",
    "end": "2640080"
  },
  {
    "text": "your database just 36 bytes in size it tells that the whole internet",
    "start": "2640080",
    "end": "2647369"
  },
  {
    "start": "2647000",
    "end": "2663000"
  },
  {
    "text": "is in the Ukraine and you know what that",
    "start": "2647369",
    "end": "2652589"
  },
  {
    "text": "really worked suddenly all configure a infection stopped and by the curve you can see how",
    "start": "2652589",
    "end": "2658700"
  },
  {
    "text": "infections went down over time so to sum",
    "start": "2658700",
    "end": "2665099"
  },
  {
    "start": "2663000",
    "end": "2703000"
  },
  {
    "text": "to sum this up attackers they usually exploit bugs in our systems they exploit",
    "start": "2665099",
    "end": "2672180"
  },
  {
    "text": "bugs that you by excellent have in your software in your architecture but also",
    "start": "2672180",
    "end": "2679170"
  },
  {
    "text": "for contains bugs not only the ones that is used on the defending or productive side but also in malware and there's a",
    "start": "2679170",
    "end": "2688319"
  },
  {
    "text": "lot of stuff you can learn from the mistakes they make but the key message is don't be afraid there are always",
    "start": "2688319",
    "end": "2694589"
  },
  {
    "text": "things always ways you can hack back and it's a lot of fun thank you",
    "start": "2694589",
    "end": "2700110"
  },
  {
    "text": "[Applause]",
    "start": "2700110",
    "end": "2705830"
  }
]