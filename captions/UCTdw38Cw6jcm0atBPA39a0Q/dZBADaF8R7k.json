[
  {
    "text": "okay the lights go down and the microphone turns on this is good so far",
    "start": "60",
    "end": "5400"
  },
  {
    "text": "the Tech's working we'll see whether or not that continues into the rest of the talk",
    "start": "5400",
    "end": "10800"
  },
  {
    "text": "uh well good afternoon everybody uh I'm sure there's going to be people arriving but I'm going to be honest I have quite",
    "start": "10800",
    "end": "16800"
  },
  {
    "text": "a lot of demos to do so if people walk in their own are going to miss a little bit of the intro so I'm just going to",
    "start": "16800",
    "end": "22140"
  },
  {
    "text": "get started so is your static web apps for the last few years since I've been",
    "start": "22140",
    "end": "28920"
  },
  {
    "text": "in preview they have been I can only think of the Dutch word my lethaling's resource",
    "start": "28920",
    "end": "35399"
  },
  {
    "text": "inside of azure I really enjoy playing with them because they are basically",
    "start": "35399",
    "end": "40739"
  },
  {
    "text": "awesome if anybody that went to Melissa's talk this morning basically all the things she went through is why I",
    "start": "40739",
    "end": "48239"
  },
  {
    "text": "adore them we have that build and deploy pipeline that you get out of the box created for you by the Azure portal",
    "start": "48239",
    "end": "57719"
  },
  {
    "text": "so that if you're just getting started you still get CI CD out of the box",
    "start": "57719",
    "end": "63320"
  },
  {
    "text": "staging environments created for you and cleaned up for you when you finish your",
    "start": "63320",
    "end": "68760"
  },
  {
    "text": "PRS there is authentication built into the free tier it's all abstracted away",
    "start": "68760",
    "end": "74880"
  },
  {
    "text": "in such a way that you don't need to be an expert on authentication in order to",
    "start": "74880",
    "end": "80220"
  },
  {
    "text": "start using it and on top of all this it's just really",
    "start": "80220",
    "end": "85680"
  },
  {
    "text": "simplified and really cheap to get started",
    "start": "85680",
    "end": "91259"
  },
  {
    "text": "now this talk is taking it kind of a little bit further we're not going to be using that default pipeline we are going to be writing three pipelines today in",
    "start": "91259",
    "end": "98460"
  },
  {
    "text": "order to use this in a more professional enterprisey environment now there's a little bit of a story",
    "start": "98460",
    "end": "104820"
  },
  {
    "text": "about why I wrote this talk basically last year I was giving a talk",
    "start": "104820",
    "end": "110880"
  },
  {
    "text": "at Azure life and about an hour before I'm due to go and talk about what you can do with",
    "start": "110880",
    "end": "116939"
  },
  {
    "text": "authentication inside of azure static web apps someone just turned to me and goes yeah",
    "start": "116939",
    "end": "122460"
  },
  {
    "text": "but you know what study web apps they're just toys really aren't they you can't do anything with",
    "start": "122460",
    "end": "129179"
  },
  {
    "text": "them it's not like you could ever use them in any kind of professional setting I want control",
    "start": "129179",
    "end": "134700"
  },
  {
    "text": "unlike two things there one please don't ever do that to a speaker an hour before they're due to give a talk on that",
    "start": "134700",
    "end": "139920"
  },
  {
    "text": "particular subject and try not to fall down behind the hole behind you either and secondly",
    "start": "139920",
    "end": "146879"
  },
  {
    "text": "it kind of triggered me it's like no I'm going to prove you wrong you are not going to attack my favorite resource",
    "start": "146879",
    "end": "152220"
  },
  {
    "text": "like this so I said about Kim by the end of the year start of next year I'm going to do a talk that just deals with workflows",
    "start": "152220",
    "end": "160200"
  },
  {
    "text": "does everything in a pipeline exactly as we would want to do inside of our",
    "start": "160200",
    "end": "166260"
  },
  {
    "text": "professional environments the clicker doesn't work because of course it doesn't",
    "start": "166260",
    "end": "172080"
  },
  {
    "text": "never ever ever say hey look the tech Works before you get started there we go",
    "start": "172080",
    "end": "178440"
  },
  {
    "text": "so hi I'm Stacy Cashmore I am a tech exploit devops at omniplan a financial",
    "start": "178440",
    "end": "184739"
  },
  {
    "text": "software company based in Amsterdam in the Netherlands I have been developing",
    "start": "184739",
    "end": "190019"
  },
  {
    "text": "software since about the mid-1990s which the further one it goes the scarier that",
    "start": "190019",
    "end": "195959"
  },
  {
    "text": "sounds to me and for the last few years I am still super psyched and honored to",
    "start": "195959",
    "end": "201780"
  },
  {
    "text": "be able to say that I can call myself a Microsoft MVP in developer Technologies",
    "start": "201780",
    "end": "208620"
  },
  {
    "text": "now that's pretty much all that I have for the slides so everything now is going to be demo so please everybody",
    "start": "208620",
    "end": "214200"
  },
  {
    "text": "keep your fingers crossed that GitHub and Azure do everything that they're supposed to do",
    "start": "214200",
    "end": "219360"
  },
  {
    "text": "and that all of you know the demos actually work as they're supposed to",
    "start": "219360",
    "end": "224840"
  },
  {
    "text": "it's going to be fine it's not Wednesday morning and the first thing that I want to go",
    "start": "226019",
    "end": "231659"
  },
  {
    "text": "through with you today is that default pipeline uh that Melissa was showing in her session because I still believe",
    "start": "231659",
    "end": "238260"
  },
  {
    "text": "for an out of the box experience getting started this thing is spectacular",
    "start": "238260",
    "end": "244319"
  },
  {
    "text": "when you create a static web app in the portal the portal will go to your repo and it will create this workflow for you",
    "start": "244319",
    "end": "251580"
  },
  {
    "text": "we have a trigger so when you do a push to main or whatever Branch you say is",
    "start": "251580",
    "end": "256799"
  },
  {
    "text": "your trunk Branch or if you make a pull request against that Branch this workflow is going to trigger and it's",
    "start": "256799",
    "end": "262740"
  },
  {
    "text": "going to do some interesting stuffers if we do a push to mean or if we're",
    "start": "262740",
    "end": "268440"
  },
  {
    "text": "doing a pull request which is anything except for closed then we're going to use this as your static web app deploy",
    "start": "268440",
    "end": "275639"
  },
  {
    "text": "V1 action and we're going to pass into that a secret",
    "start": "275639",
    "end": "282479"
  },
  {
    "text": "that the Azure portal also puts into our repo when it sets it up we're going to",
    "start": "282479",
    "end": "287520"
  },
  {
    "text": "pass in a token for our GitHub repo so that we can update our pull request",
    "start": "287520",
    "end": "293160"
  },
  {
    "text": "and then we're going to say I always like this it's a GitHub action that has an action uh and we're gonna upload our new site",
    "start": "293160",
    "end": "301860"
  },
  {
    "text": "at the very basic level we pass in the app location the API location and the",
    "start": "301860",
    "end": "308580"
  },
  {
    "text": "output location and all sorts of wonderful magic happens inside of here that figures out what",
    "start": "308580",
    "end": "316620"
  },
  {
    "text": "language you are using how you need to build your application what language you're using for your Azure functions it",
    "start": "316620",
    "end": "323460"
  },
  {
    "text": "then updates your website for the configuration so that Azure knows what",
    "start": "323460",
    "end": "328979"
  },
  {
    "text": "type of azure functions to provision for your API if it needs to provision anything",
    "start": "328979",
    "end": "334680"
  },
  {
    "text": "then does all that up publishes up to Azure checks to make sure that",
    "start": "334680",
    "end": "339840"
  },
  {
    "text": "everything's working as it should be and then lets you run your new website in production with you not really knowing",
    "start": "339840",
    "end": "347280"
  },
  {
    "text": "how this is done and not needing to know how this is done",
    "start": "347280",
    "end": "352500"
  },
  {
    "text": "and at this point if you're in a pull request then it's going to spin up in your environment it's going to put a",
    "start": "352500",
    "end": "357900"
  },
  {
    "text": "link to that environment in your comments in your pull request so you can easily find where to test",
    "start": "357900",
    "end": "365100"
  },
  {
    "text": "when you close a pull request it's then going to clean that up for you because you only have a limited amount of",
    "start": "365100",
    "end": "370800"
  },
  {
    "text": "staging slots inside of a static web app it's either two or three for a free tier five for a standard tier so you want to",
    "start": "370800",
    "end": "378060"
  },
  {
    "text": "make sure that you clean up after yourself and this does all of that for you",
    "start": "378060",
    "end": "383819"
  },
  {
    "text": "but for that person that was speaking to me at the conference it does have some",
    "start": "383819",
    "end": "389039"
  },
  {
    "text": "issues first things first we're having to manually create that static web app",
    "start": "389039",
    "end": "394259"
  },
  {
    "text": "inside of the portal now obviously we don't want to do this every time we create something if we're using it",
    "start": "394259",
    "end": "399720"
  },
  {
    "text": "inside of a professional environment we want to be able to create this the same way over and over and know what's",
    "start": "399720",
    "end": "406020"
  },
  {
    "text": "happening also whilst I do think that this action is absolutely awesome it's also a little",
    "start": "406020",
    "end": "413880"
  },
  {
    "text": "bit opaque and maybe we want to have a little bit more knowledge and control about what's going on when we deploy our",
    "start": "413880",
    "end": "420780"
  },
  {
    "text": "code and lastly yeah this doesn't win any tests or",
    "start": "420780",
    "end": "426120"
  },
  {
    "text": "anything else and whilst you can put it into this workflow of course that was just the other comment that I had of yeah but you know I I want to write my",
    "start": "426120",
    "end": "433680"
  },
  {
    "text": "workflow I don't want this thing out of the box so today that's what we're going to be",
    "start": "433680",
    "end": "438960"
  },
  {
    "text": "doing now say we're going to write um three workflows the first one that",
    "start": "438960",
    "end": "444840"
  },
  {
    "text": "we're going to write is to create that as your resource so that we can get it working",
    "start": "444840",
    "end": "450780"
  },
  {
    "text": "so what we're going to do is inside of my",
    "start": "450780",
    "end": "456000"
  },
  {
    "text": "wow this is really interesting trying to go between two screens at such distance we're going to create a new folder",
    "start": "456000",
    "end": "463740"
  },
  {
    "text": "all right we want a new folder and we're going to call that dot GitHub workflow so for those that don't know GitHub",
    "start": "463740",
    "end": "470520"
  },
  {
    "text": "anything that you put in here which is a valid yaml um file conforming to the GitHub",
    "start": "470520",
    "end": "478199"
  },
  {
    "text": "needs it will create an it will give you access to an action inside of GitHub you",
    "start": "478199",
    "end": "484259"
  },
  {
    "text": "don't need to then go into GitHub and do your own thing inside of that we are going to create",
    "start": "484259",
    "end": "489720"
  },
  {
    "text": "our first file and that's going to be iac.yaml so get me a new file there",
    "start": "489720",
    "end": "497840"
  },
  {
    "text": "and we need to give it a little bit of a trigger",
    "start": "498000",
    "end": "504319"
  },
  {
    "text": "come on thank you so we're going to give it a name uh create and set up SWA infrastructure seems to make sense and I",
    "start": "505560",
    "end": "512820"
  },
  {
    "text": "am giving this a workflow dispatch trigger because I don't want to run this every time I change my code I only want",
    "start": "512820",
    "end": "518520"
  },
  {
    "text": "to run this when I change my infrastructure so I want to be in control of when this one gets triggered",
    "start": "518520",
    "end": "525839"
  },
  {
    "text": "then we need some variables that we're going to use inside of our pipeline to pass along to Azure we need",
    "start": "525839",
    "end": "534899"
  },
  {
    "text": "to pass in the resource Group because I want to tell it where to create things the name of the static web app itself and the region that I want to run it in",
    "start": "534899",
    "end": "542880"
  },
  {
    "text": "now a couple of weeks ago I saw a blog post on GitHub that as well as having",
    "start": "542880",
    "end": "548459"
  },
  {
    "text": "repository secrets you can now do repository variables and I'm going to be",
    "start": "548459",
    "end": "553680"
  },
  {
    "text": "honest when they're in GA I won't be using this anymore because that gives us a lot more flexibility and as we're",
    "start": "553680",
    "end": "559500"
  },
  {
    "text": "going to use these between pipelines it means we're not going to do typos quite so much and bang our heads against a",
    "start": "559500",
    "end": "564720"
  },
  {
    "text": "table when things don't work as we expect and then we can actually get on with our",
    "start": "564720",
    "end": "571680"
  },
  {
    "text": "actual jobs so we're going to have a job here I have um Snippets I'm bringing across by the way",
    "start": "571680",
    "end": "577860"
  },
  {
    "text": "because I know I'm going to do typos and I'd rather that this does actually work",
    "start": "577860",
    "end": "584720"
  },
  {
    "text": "so we're going to run a job uh just to chat that or just to create the SWA this workflow is only going to have one job",
    "start": "584820",
    "end": "591300"
  },
  {
    "text": "we're going to run that on Ubuntu latest and the very first thing that we need to do",
    "start": "591300",
    "end": "596459"
  },
  {
    "text": "is get access to our code so we are gonna do a checkout",
    "start": "596459",
    "end": "603200"
  },
  {
    "text": "of our code here next one that we need to do because we are going to be using the",
    "start": "604320",
    "end": "611360"
  },
  {
    "text": "azcli in order to create our study web apps we need to log into azure",
    "start": "611360",
    "end": "618800"
  },
  {
    "text": "inside of the pipeline now I'm logging in here with secret",
    "start": "619380",
    "end": "624779"
  },
  {
    "text": "credentials I probably wouldn't actually recommend doing this I would probably do",
    "start": "624779",
    "end": "629820"
  },
  {
    "text": "it using certificates which is a more secure way less chance of things leaking I'm going to link to a blog post",
    "start": "629820",
    "end": "637080"
  },
  {
    "text": "on that in Twitter when I'm done it was written by a friend of mine in the Netherlands he explains it really well",
    "start": "637080",
    "end": "644000"
  },
  {
    "text": "and then after we've logged in then we're just going to run a couple of",
    "start": "644220",
    "end": "649519"
  },
  {
    "text": "azcla commands where are we there so the first one that",
    "start": "649700",
    "end": "656640"
  },
  {
    "text": "we're going to do is just create the resource Group now I had a chat with somebody when I was writing",
    "start": "656640",
    "end": "663720"
  },
  {
    "text": "this and they went well isn't that going to die but no this is item potent you can run this many times",
    "start": "663720",
    "end": "669060"
  },
  {
    "text": "and it's not going to break anything so this is safe to put here and the second one that we're going to",
    "start": "669060",
    "end": "675420"
  },
  {
    "text": "do is run an AZ deploy create on the next line",
    "start": "675420",
    "end": "680880"
  },
  {
    "text": "and this is going to run against a bicep file so we're going to use bicep in order to control and create our static",
    "start": "680880",
    "end": "687779"
  },
  {
    "text": "web app in our pipeline now that doesn't exist in this repo at the moment so we're going to come back and do that one",
    "start": "687779",
    "end": "694980"
  },
  {
    "text": "in a minute last thing that I want to do because I am connecting to a cosmos DB for this",
    "start": "694980",
    "end": "702660"
  },
  {
    "text": "app you've not seen it running yet because I want to show you running after I've created it via the pipeline so",
    "start": "702660",
    "end": "707700"
  },
  {
    "text": "fingers crossed um I need to give it access to my Cosmos DB",
    "start": "707700",
    "end": "712740"
  },
  {
    "text": "tell it where the containers are tell it what the database is so just set a few environment settings",
    "start": "712740",
    "end": "717959"
  },
  {
    "text": "and we can do this if I get back to the start of the line come on little laptop you can do it",
    "start": "717959",
    "end": "725160"
  },
  {
    "text": "using an AZ static web app command line so there's two different cli's we're",
    "start": "725160",
    "end": "730320"
  },
  {
    "text": "going to be using today one is AZ mainly using this static web app command and",
    "start": "730320",
    "end": "736200"
  },
  {
    "text": "the other one is a static web app CLI itself I'm using both of them because at the moment they both kind of do",
    "start": "736200",
    "end": "742019"
  },
  {
    "text": "different things there's a little bit of an overlap but you're going to need to go backwards and forwards to get this",
    "start": "742019",
    "end": "747120"
  },
  {
    "text": "working I hope that kind of converges at some point and you can pick the technology that you want to use",
    "start": "747120",
    "end": "753720"
  },
  {
    "text": "so that is our entire pipeline that we need to not have to go into the portal",
    "start": "753720",
    "end": "760500"
  },
  {
    "text": "in order to create our application but we still need that bicep file so let's quickly set that up",
    "start": "760500",
    "end": "767220"
  },
  {
    "text": "I'm going to add a new file in the root whoops no I'm not going to add a new folder I'm going to add a new file don't",
    "start": "767220",
    "end": "773339"
  },
  {
    "text": "misclick main.bicep and I have the simplest",
    "start": "773339",
    "end": "779700"
  },
  {
    "text": "possible bicep here for creating a static web app I'm passing in three parameters so one",
    "start": "779700",
    "end": "785399"
  },
  {
    "text": "for the location but I'm just going to default that to the resource Group passing in a parameter for the name and",
    "start": "785399",
    "end": "793079"
  },
  {
    "text": "I'm passing in a parameter for the SKU which I'm defaulting to the free tier but we're going to do something",
    "start": "793079",
    "end": "798839"
  },
  {
    "text": "different in the pipeline the bicep itself in order to create it",
    "start": "798839",
    "end": "804420"
  },
  {
    "text": "just a standard vanilla static web app you only need the name the location the",
    "start": "804420",
    "end": "809760"
  },
  {
    "text": "SKU and an empty properties object depending on your needs there's a whole host of stuff that you can do here but",
    "start": "809760",
    "end": "816660"
  },
  {
    "text": "that's kind of half a talk on its own so I'm kind of ignoring that one for today that I'm going to share a link to all of",
    "start": "816660",
    "end": "824040"
  },
  {
    "text": "the resources so that you can see exactly what you can do in here at the end of The Talk",
    "start": "824040",
    "end": "830100"
  },
  {
    "text": "and that is it if we now push this up to GitHub",
    "start": "830100",
    "end": "835500"
  },
  {
    "text": "so we add IAC",
    "start": "835500",
    "end": "841139"
  },
  {
    "text": "and then if I can if that works come on push keep if we go to the right browser",
    "start": "843000",
    "end": "851579"
  },
  {
    "text": "this is my repo if I refresh this hopefully we have that workflow file",
    "start": "851579",
    "end": "857360"
  },
  {
    "text": "which we don't why don't we have that workflow file",
    "start": "857519",
    "end": "861980"
  },
  {
    "text": "oh that's a good start isn't it am I in the right place",
    "start": "862920",
    "end": "869839"
  },
  {
    "text": "excuse me a second",
    "start": "870720",
    "end": "873620"
  },
  {
    "text": "NCD London this should work that synced",
    "start": "878040",
    "end": "883759"
  },
  {
    "text": "is this a bit where GitHub dies on Me on the very first demo and I kind of like cry",
    "start": "883860",
    "end": "890060"
  },
  {
    "text": "no I'm on Main",
    "start": "894180",
    "end": "897680"
  },
  {
    "text": "that is interesting give me two seconds",
    "start": "905760",
    "end": "912500"
  },
  {
    "text": "come on no there's nothing left to push",
    "start": "918300",
    "end": "924740"
  },
  {
    "text": "everything's up to date",
    "start": "929880",
    "end": "932959"
  },
  {
    "text": "and I don't have any actions Wowzer",
    "start": "939420",
    "end": "944899"
  },
  {
    "text": "okay I'm gonna cheat here what I'm going to do is re-clone the",
    "start": "945060",
    "end": "950220"
  },
  {
    "text": "repo I'm going to copy this stuff across to that repo and I'm going to just push that one up instead",
    "start": "950220",
    "end": "956279"
  },
  {
    "text": "so get clone",
    "start": "956279",
    "end": "960800"
  },
  {
    "text": "where's my link",
    "start": "968160",
    "end": "971360"
  },
  {
    "text": "sorry about this in all of the run through is that I've done this is one issue that I've not encountered",
    "start": "974579",
    "end": "981139"
  },
  {
    "text": "was it there",
    "start": "984480",
    "end": "987380"
  },
  {
    "text": "sorry and you can see it and I can't",
    "start": "990180",
    "end": "997459"
  },
  {
    "text": "are you looking at Stacey class talks NCD NCD London",
    "start": "998940",
    "end": "1004300"
  },
  {
    "text": "oh wow",
    "start": "1007100",
    "end": "1010120"
  },
  {
    "text": "did I push it to the wrong place I pushed it to the wrong place haven't I",
    "start": "1012320",
    "end": "1017680"
  },
  {
    "text": "I put it in the wrong place",
    "start": "1022940",
    "end": "1026740"
  },
  {
    "text": "give me two seconds I'm gonna fix this one then we'll move it to the right place",
    "start": "1029299",
    "end": "1034839"
  },
  {
    "text": "that's fine this doesn't put me behind schedule at all uh",
    "start": "1035600",
    "end": "1041810"
  },
  {
    "text": "[Music]",
    "start": "1041810",
    "end": "1045030"
  },
  {
    "text": "I'm not seeing it where did I create that I've obviously",
    "start": "1048679",
    "end": "1054380"
  },
  {
    "text": "created it in the wrong folder I've misclicked somewhere",
    "start": "1054380",
    "end": "1058600"
  },
  {
    "text": "oh well that was stupid wasn't it I put it in the vs code folder",
    "start": "1061160",
    "end": "1069039"
  },
  {
    "text": "did I",
    "start": "1074299",
    "end": "1076899"
  },
  {
    "text": "am",
    "start": "1085160",
    "end": "1087400"
  },
  {
    "text": "thank you",
    "start": "1097880",
    "end": "1100840"
  },
  {
    "text": "idiot Stacy shall we try that one again",
    "start": "1103940",
    "end": "1109520"
  },
  {
    "text": "thank you for the help by the way really appreciated",
    "start": "1109520",
    "end": "1113799"
  },
  {
    "text": "and it's still what I know I put that in the right place this time",
    "start": "1118520",
    "end": "1125799"
  },
  {
    "text": "oh come on",
    "start": "1130640",
    "end": "1133840"
  },
  {
    "text": "okay let's try and work on this one so we have the GitHub we want to move that into GitHub move",
    "start": "1138679",
    "end": "1146360"
  },
  {
    "text": "right try again",
    "start": "1146360",
    "end": "1151720"
  },
  {
    "text": "oh yeah and if you're going to move them don't make these mistakes when you're doing the run through and the privacy of your own home do them when people are",
    "start": "1159080",
    "end": "1165200"
  },
  {
    "text": "watching you and you're kind of like stressing on stage it's way more fun",
    "start": "1165200",
    "end": "1171580"
  },
  {
    "text": "so we're going to kick this one and what this is now going to do is",
    "start": "1175820",
    "end": "1182780"
  },
  {
    "text": "create a static web app it's not going to deploy anything yet though because we've not got any of that in this pipeline it's just going to make the",
    "start": "1182780",
    "end": "1189740"
  },
  {
    "text": "resource for us hopefully the next ones I can do a little bit quicker",
    "start": "1189740",
    "end": "1195080"
  },
  {
    "text": "and get working now the next workflow that I want to do is the",
    "start": "1195080",
    "end": "1201620"
  },
  {
    "text": "um the custom domain I wanted to add a custom domain to my",
    "start": "1201620",
    "end": "1206720"
  },
  {
    "text": "application one because if I'm running it in production as much as the default names are really fun with yellow Beach",
    "start": "1206720",
    "end": "1213500"
  },
  {
    "text": "or whatever else they don't exactly roll off the tongue the other issue is we're now creating",
    "start": "1213500",
    "end": "1219380"
  },
  {
    "text": "this in a pipeline we have no idea what that name might be with an app service",
    "start": "1219380",
    "end": "1226700"
  },
  {
    "text": "the name or the URL is included in the name which makes the naming interesting because you've got to avoid clashes with",
    "start": "1226700",
    "end": "1232940"
  },
  {
    "text": "every other Azure user in the world with a static web app that name only has to be unique in your resource Group but the",
    "start": "1232940",
    "end": "1240320"
  },
  {
    "text": "downside is that you never know what the URL is going to be so we're going to add a custom domain",
    "start": "1240320",
    "end": "1246380"
  },
  {
    "text": "here just so that we know once it's been deployed we can go to this location and it's going to work",
    "start": "1246380",
    "end": "1253820"
  },
  {
    "text": "so we're going to add a new a new workflow and hopefully we're going to add this in the right place",
    "start": "1253820",
    "end": "1260679"
  },
  {
    "text": "we're going to call that custom domain and again we're going to have this on a",
    "start": "1261740",
    "end": "1267620"
  },
  {
    "text": "workflow dispatch and I'm not doing this in the same",
    "start": "1267620",
    "end": "1272720"
  },
  {
    "text": "location as the IAS IAC for two reasons one you're probably not going to need to run it every time you play with your",
    "start": "1272720",
    "end": "1279320"
  },
  {
    "text": "environment you're only going to need to run it when you set up a new environment and two DNS records are a pain in the",
    "start": "1279320",
    "end": "1285500"
  },
  {
    "text": "neck and I suspect this is going to fail at least once before our DNS records are propagated as we want them to",
    "start": "1285500",
    "end": "1293240"
  },
  {
    "text": "again we need some environment environment variables so that we can access our static web app",
    "start": "1293240",
    "end": "1300080"
  },
  {
    "text": "um and we're passing the subdomain in here only I'm going to rename it I don't want it to be ENT demo I want it to be",
    "start": "1300080",
    "end": "1306640"
  },
  {
    "text": "NDC London whoops",
    "start": "1306640",
    "end": "1313000"
  },
  {
    "text": "then we have some we have to set up the job this is going to look very similar to the other job so",
    "start": "1317240",
    "end": "1323500"
  },
  {
    "text": "we are going to get our code because I have some applications I need to run in",
    "start": "1323500",
    "end": "1328940"
  },
  {
    "text": "order for this to work we're going to log into Azure because we need to have access to Azure to change those custom",
    "start": "1328940",
    "end": "1336140"
  },
  {
    "text": "domains we need to find out what our current",
    "start": "1336140",
    "end": "1342260"
  },
  {
    "text": "host name is because we're going to do this on a subdomain you can also do this on the",
    "start": "1342260",
    "end": "1347360"
  },
  {
    "text": "Apex to name but it's slightly different but for a subdomain what you need to do is set up a DNS record a cname DNS",
    "start": "1347360",
    "end": "1355820"
  },
  {
    "text": "record that points to the resource that you're trying to access we don't know",
    "start": "1355820",
    "end": "1362299"
  },
  {
    "text": "what that is yet because we've just created it in a pipeline and we've not seen this",
    "start": "1362299",
    "end": "1368179"
  },
  {
    "text": "but by using the AZ static web app environment list we can actually see what environments we have available and",
    "start": "1368179",
    "end": "1374840"
  },
  {
    "text": "we can get that hostname out of the system now the important one here is when we do a query which is kind of a",
    "start": "1374840",
    "end": "1382100"
  },
  {
    "text": "little bit further along the line over here",
    "start": "1382100",
    "end": "1387919"
  },
  {
    "text": "every time you make a staging environment you make a new environment with a new hostname and you need to know",
    "start": "1387919",
    "end": "1393799"
  },
  {
    "text": "that you've got the right one the production hostname will always have",
    "start": "1393799",
    "end": "1399620"
  },
  {
    "text": "the name of default so this is the one that we want to access in order to do our um in order to put it into our DNS",
    "start": "1399620",
    "end": "1406280"
  },
  {
    "text": "record then we need to set our DNS record and I'm going to be honest I'm not going to",
    "start": "1406280",
    "end": "1411740"
  },
  {
    "text": "talk you through this just because all DNS providers are different",
    "start": "1411740",
    "end": "1417080"
  },
  {
    "text": "um I have written just a little application for my DNS provider just so that I can do this on the Fly I'm sure",
    "start": "1417080",
    "end": "1422840"
  },
  {
    "text": "that different ones have their own API that can be used but this is just going to create that",
    "start": "1422840",
    "end": "1428480"
  },
  {
    "text": "DNS record that we need and then last but not least we need to actually",
    "start": "1428480",
    "end": "1434600"
  },
  {
    "text": "um set the custom domain itself so we have another step to put in the end",
    "start": "1434600",
    "end": "1441280"
  },
  {
    "text": "and here we're going to do the static web app hostname set and we're going to use the hostname that",
    "start": "1441980",
    "end": "1449059"
  },
  {
    "text": "we set in the environment variable so this should be ndc-london.stacy.cloud keep your fingers",
    "start": "1449059",
    "end": "1455600"
  },
  {
    "text": "crossed this should be live in about five minutes and that is everything that we need for",
    "start": "1455600",
    "end": "1462320"
  },
  {
    "text": "this if I've not broken the yaml which is something I do do regularly if there's one thing I've had from",
    "start": "1462320",
    "end": "1467900"
  },
  {
    "text": "writing this talk is I hate Yama",
    "start": "1467900",
    "end": "1471640"
  },
  {
    "text": "stem domain domain let's commit and sync that let's hope that goes to the right place and",
    "start": "1473179",
    "end": "1479539"
  },
  {
    "text": "let's see if we have a resource created yet or if my pipeline failed it worked we have a resource that has",
    "start": "1479539",
    "end": "1486320"
  },
  {
    "text": "been created for us so this one has gone through created our",
    "start": "1486320",
    "end": "1491539"
  },
  {
    "text": "resource we'll look at that in the portal in a second just to prove that it's there and in the meantime what we're going to",
    "start": "1491539",
    "end": "1496580"
  },
  {
    "text": "do is kick off this custom domain I say I am expecting to need to run this one twice I'm currently at about a 75",
    "start": "1496580",
    "end": "1503539"
  },
  {
    "text": "hit rate of it working but bearing in mind how it's gone so far it's not going to work first from today",
    "start": "1503539",
    "end": "1509360"
  },
  {
    "text": "the DNS record's not going to propagate and we're going to have to kick it off a second time",
    "start": "1509360",
    "end": "1515059"
  },
  {
    "text": "when that's going let's just have a look at our static web app in the portal just to prove that it is actually there",
    "start": "1515059",
    "end": "1522620"
  },
  {
    "text": "so in my resource groups",
    "start": "1522620",
    "end": "1526059"
  },
  {
    "text": "we have this ENT demo we have demo SWA that's one that we just",
    "start": "1529340",
    "end": "1535039"
  },
  {
    "text": "created and if we go to the URL which I can't read from here Brave smoke see they're",
    "start": "1535039",
    "end": "1542000"
  },
  {
    "text": "awesome names they are quite funny they're just not necessarily useful in a production environment",
    "start": "1542000",
    "end": "1547880"
  },
  {
    "text": "uh so your Azure static web app is live and waiting for your content so we've got that first step now we've not been",
    "start": "1547880",
    "end": "1553460"
  },
  {
    "text": "into the portal but we have a static web app and in a minute it's even going to run on a custom domain",
    "start": "1553460",
    "end": "1559700"
  },
  {
    "text": "next step is actually getting something in there that does what we want",
    "start": "1559700",
    "end": "1565760"
  },
  {
    "text": "so for this one we're going to make I'm going to make a pipeline but first of all I want to deploy it from the CLI to",
    "start": "1565760",
    "end": "1571760"
  },
  {
    "text": "kind of show you the steps I'm doing and then we'll put it into the pipeline and run it again",
    "start": "1571760",
    "end": "1577480"
  },
  {
    "text": "now so that we can see the different ways that this runs I am going to make some subtle changes to the code for each",
    "start": "1578360",
    "end": "1585440"
  },
  {
    "text": "run unless I forget 50 50 chance of that too on my index page underneath the header",
    "start": "1585440",
    "end": "1594740"
  },
  {
    "text": "we're just going to have a div no",
    "start": "1594740",
    "end": "1601120"
  },
  {
    "text": "we're going to have a div that just says deploy by CLI now there's one other change that I need",
    "start": "1602539",
    "end": "1608900"
  },
  {
    "text": "to make to my application before I go to the CLI and that is to tell the static",
    "start": "1608900",
    "end": "1615919"
  },
  {
    "text": "web app what it's running on what technology it's using in my intro I said that that default",
    "start": "1615919",
    "end": "1622340"
  },
  {
    "text": "pipeline sets up something inside of your SWA that says whether or not you're running",
    "start": "1622340",
    "end": "1628279"
  },
  {
    "text": "on node or python or net isolated not isolated whatever",
    "start": "1628279",
    "end": "1635059"
  },
  {
    "text": "the deployment process we're going to be doing now doesn't do that because it has no idea we are in full control but that",
    "start": "1635059",
    "end": "1641720"
  },
  {
    "text": "also means that we have full responsibility so we're going to need to add just a little bit of something to our",
    "start": "1641720",
    "end": "1649640"
  },
  {
    "text": "config file which is in our www root",
    "start": "1649640",
    "end": "1656799"
  },
  {
    "text": "we have our static web app config file this is a superb resource again a talk on its",
    "start": "1658159",
    "end": "1664700"
  },
  {
    "text": "own you could control your static web app from here I have something here to protect my endpoints I've got a",
    "start": "1664700",
    "end": "1671179"
  },
  {
    "text": "navigation fallback so that if you hit F5 somewhere it knows how to serve your code and we've now added this platform",
    "start": "1671179",
    "end": "1678440"
  },
  {
    "text": "at the top that tells it always run in a.net isolated function",
    "start": "1678440",
    "end": "1684620"
  },
  {
    "text": "with this in place now we can actually start to do some building and some deploying",
    "start": "1684620",
    "end": "1689960"
  },
  {
    "text": "so my professional pipeline number one I want to check that everything works so let's run some tests",
    "start": "1689960",
    "end": "1695539"
  },
  {
    "text": "let's not run some testing let's run some tests now I only have two",
    "start": "1695539",
    "end": "1702679"
  },
  {
    "text": "tests in this project because I wanted just enough for the demo but um you get the idea",
    "start": "1702679",
    "end": "1707720"
  },
  {
    "text": "it builds it runs and we should hopefully have Test passing yay",
    "start": "1707720",
    "end": "1712940"
  },
  {
    "text": "after we've done that we are going to need to publish our client and our API because this is all things that was done",
    "start": "1712940",
    "end": "1719900"
  },
  {
    "text": "for is in the previous pipeline now this can take like 15-20 seconds or",
    "start": "1719900",
    "end": "1724940"
  },
  {
    "text": "so because we're optimizing the Blazer assemblies and of course it knows I'm slightly",
    "start": "1724940",
    "end": "1731179"
  },
  {
    "text": "behind so it's going to take just that little bit longer just to have a go at me",
    "start": "1731179",
    "end": "1736960"
  },
  {
    "text": "and then we want to publish our API and then once we have this",
    "start": "1738440",
    "end": "1745400"
  },
  {
    "text": "now we can deploy these publish files up to our static web app but we have another problem",
    "start": "1745400",
    "end": "1752179"
  },
  {
    "text": "the portal when you create your static web app puts the deploy token into your secrets for you",
    "start": "1752179",
    "end": "1758120"
  },
  {
    "text": "we've not done that yet we don't know what the secret is but there is a command that will give it to us",
    "start": "1758120",
    "end": "1764960"
  },
  {
    "text": "so we're going to call is that readable by the way at the back can you see that or do I need to",
    "start": "1764960",
    "end": "1770840"
  },
  {
    "text": "zoom in it's okay okay so we can use this AZ study web app and",
    "start": "1770840",
    "end": "1778279"
  },
  {
    "text": "get the list of our secrets and then we're going to query it through the API key Stick that in a variable",
    "start": "1778279",
    "end": "1786580"
  },
  {
    "text": "stick that in a variable thank you and once we have that available we can",
    "start": "1788840",
    "end": "1794659"
  },
  {
    "text": "now do a deploy and this deploy isn't using the AZ study web app at the moment at least at the",
    "start": "1794659",
    "end": "1801980"
  },
  {
    "text": "time of writing this last week um the swi deploy action it was only available in that SWA deploy which you",
    "start": "1801980",
    "end": "1809360"
  },
  {
    "text": "have to install via node you can do a whole lot with the SWA CLI",
    "start": "1809360",
    "end": "1814760"
  },
  {
    "text": "you can run it locally you can create initialize static web apps log into Azure do your deploys",
    "start": "1814760",
    "end": "1821779"
  },
  {
    "text": "it's quite an awesome little um CLI you can see at the end though we are",
    "start": "1821779",
    "end": "1827419"
  },
  {
    "text": "now deploying only into production you need to put that end of production otherwise it will just deploy by default",
    "start": "1827419",
    "end": "1833779"
  },
  {
    "text": "into a preview slot called preview so we're going to run this one now",
    "start": "1833779",
    "end": "1838940"
  },
  {
    "text": "and this is a point where I really hope that Azure plays ball with us",
    "start": "1838940",
    "end": "1845080"
  },
  {
    "text": "this should take about 30 seconds on Wednesday and on Tuesday night it was",
    "start": "1845480",
    "end": "1850640"
  },
  {
    "text": "taking three minutes and then crashing out on me because I don't know if you noticed but there were issues in Azure early on this week",
    "start": "1850640",
    "end": "1856760"
  },
  {
    "text": "uh we're going to let that one run and we're going to see whether or not our custom domain at least worked",
    "start": "1856760",
    "end": "1863740"
  },
  {
    "text": "do we green wow it ran first time whilst I was actually doing the talk that is awesome",
    "start": "1866480",
    "end": "1873799"
  },
  {
    "text": "so now if we go to NDC London",
    "start": "1873799",
    "end": "1879860"
  },
  {
    "text": "Dot Stacy Dot",
    "start": "1880480",
    "end": "1885340"
  },
  {
    "text": "cloud",
    "start": "1886159",
    "end": "1888880"
  },
  {
    "text": "that's interesting why did that not work NDC",
    "start": "1891440",
    "end": "1897980"
  },
  {
    "text": "London that is the one I used right",
    "start": "1897980",
    "end": "1901840"
  },
  {
    "text": "see why I use code Snippets because typing's hard",
    "start": "1904340",
    "end": "1910419"
  },
  {
    "text": "like really hard I apologize",
    "start": "1910640",
    "end": "1915640"
  },
  {
    "text": "oh come on",
    "start": "1920980",
    "end": "1924340"
  },
  {
    "text": "you know what I'm going to do this in a really cheating way if I refresh this page I should actually",
    "start": "1927620",
    "end": "1932840"
  },
  {
    "text": "get my link right here on the page so we'll just load it from here shall we",
    "start": "1932840",
    "end": "1938740"
  },
  {
    "text": "okay this one I have not had before apparently is yours just deciding to play ball trust me this does work",
    "start": "1942500",
    "end": "1949940"
  },
  {
    "text": "always a fun phrase to use in the middle of a demo nope okay fair enough that one's",
    "start": "1949940",
    "end": "1955820"
  },
  {
    "text": "crashing on us um how is our deploy going we'll come back and see whether or not that one",
    "start": "1955820",
    "end": "1961880"
  },
  {
    "text": "gets happier later 105 seconds",
    "start": "1961880",
    "end": "1967659"
  },
  {
    "text": "120 seconds I can tell you that this isn't going to work so I'm going to cancel this one now and",
    "start": "1967659",
    "end": "1974659"
  },
  {
    "text": "continue I really don't know what it is with Azure it really is this week it's just",
    "start": "1974659",
    "end": "1980720"
  },
  {
    "text": "been really playing you had it this morning as well didn't you not doing something wow it did work it just wanted to make",
    "start": "1980720",
    "end": "1987440"
  },
  {
    "text": "me a liar so",
    "start": "1987440",
    "end": "1993158"
  },
  {
    "text": "does that mean that my site is actually up now or nope",
    "start": "1994059",
    "end": "2000059"
  },
  {
    "text": "I get back to the original one",
    "start": "2001419",
    "end": "2005559"
  },
  {
    "text": "okay we have a deployed application we have my to-do list we can make stuff and we can save it",
    "start": "2008559",
    "end": "2015159"
  },
  {
    "text": "what we can't do yet though is log in now I'm not going to put any standard",
    "start": "2015159",
    "end": "2020440"
  },
  {
    "text": "authentication into here and just because if I'm using this in a",
    "start": "2020440",
    "end": "2025659"
  },
  {
    "text": "professional environment I wouldn't use the standard authentication it has some issues",
    "start": "2025659",
    "end": "2031179"
  },
  {
    "text": "number one is um you have to do it via invite links which means when you recreate your",
    "start": "2031179",
    "end": "2037299"
  },
  {
    "text": "environment you're also going to have to recreate all of those users send out all of those links and get your users to",
    "start": "2037299",
    "end": "2042820"
  },
  {
    "text": "click them in a certain amount of time it's not the best experience",
    "start": "2042820",
    "end": "2049139"
  },
  {
    "text": "right okay awesome but it worked okay so if you",
    "start": "2052899",
    "end": "2059200"
  },
  {
    "text": "check on your phone yeah okay so eventually it's going to work but if you look on your phone you",
    "start": "2059200",
    "end": "2064540"
  },
  {
    "text": "should be able to see it at least you'll also see that this is a responsive site which is quite cool",
    "start": "2064540",
    "end": "2069820"
  },
  {
    "text": "um so that's one reason why I wouldn't use standard authentication here the other",
    "start": "2069820",
    "end": "2075580"
  },
  {
    "text": "reason why I wouldn't use it is when you run standard authentication when you use standard authentication every user has a",
    "start": "2075580",
    "end": "2083980"
  },
  {
    "text": "unique ID and if you use your Twitter login between different static web apps you",
    "start": "2083980",
    "end": "2090280"
  },
  {
    "text": "have a different ID it's recreated for every Azure static web app which means",
    "start": "2090280",
    "end": "2095740"
  },
  {
    "text": "that if we have infrastructure as code and something happens and we recreate it all of the records associated with that",
    "start": "2095740",
    "end": "2102099"
  },
  {
    "text": "user ID are now orphaned records and we can't get to them so for the in a professional environment",
    "start": "2102099",
    "end": "2108580"
  },
  {
    "text": "I would use the custom authentication that gives you a fixed ID from the",
    "start": "2108580",
    "end": "2113619"
  },
  {
    "text": "authentication provider I was hoping to show you that today but I got a slight idea that we're not quite going to reach",
    "start": "2113619",
    "end": "2119740"
  },
  {
    "text": "that part so I will write a blog post about that one instead for you",
    "start": "2119740",
    "end": "2125700"
  },
  {
    "text": "um okay so what we've just done on the command line let's put that into a what we've just done on the CLI let's",
    "start": "2125980",
    "end": "2133540"
  },
  {
    "text": "put that into a pipeline and see what happens now number one I want to change my index",
    "start": "2133540",
    "end": "2139839"
  },
  {
    "text": "file because I want pipeline",
    "start": "2139839",
    "end": "2145660"
  },
  {
    "text": "and then I want to create my new pipeline at the top",
    "start": "2145660",
    "end": "2150599"
  },
  {
    "text": "so we're going to have our build and deploy pipeline that we're going to put into here",
    "start": "2153400",
    "end": "2159720"
  },
  {
    "text": "and the top of this pipeline is going to look a little bit similar to what we get out of the box because that is the",
    "start": "2162780",
    "end": "2169420"
  },
  {
    "text": "trigger that we want we want I need push to the main or we want a pull request which is open synchronized reopened or",
    "start": "2169420",
    "end": "2175480"
  },
  {
    "text": "closed you'll see that I've got a couple of paths signal in there and that's because if I make a change to the custom",
    "start": "2175480",
    "end": "2180880"
  },
  {
    "text": "domain pipeline or the IAC pipeline I don't need to redeploy my application I can change the infrastructure of my",
    "start": "2180880",
    "end": "2188200"
  },
  {
    "text": "static web app without needing to rerun this pipeline so we're going to ignore that one",
    "start": "2188200",
    "end": "2194760"
  },
  {
    "text": "then again we're going to use these environment variables see why I say once those environment variables are in",
    "start": "2196900",
    "end": "2201940"
  },
  {
    "text": "general availability I'm going to use them it's going to like stop me having to put so much into my Pipelines and for",
    "start": "2201940",
    "end": "2208480"
  },
  {
    "text": "the deployment we just need the resource Group and the SWA name",
    "start": "2208480",
    "end": "2214300"
  },
  {
    "text": "then we have a job and for the first run through I'm going to cheat for this job I'm going to use it for everything not",
    "start": "2214300",
    "end": "2220660"
  },
  {
    "text": "just for building and testing we won't run this one when we have a push to our main branch or when we have",
    "start": "2220660",
    "end": "2226599"
  },
  {
    "text": "a pull request which is anything but closed because this is going to be the deployment flow",
    "start": "2226599",
    "end": "2233640"
  },
  {
    "text": "um we're also checking out our code there obviously because otherwise we have nothing to deploy",
    "start": "2235240",
    "end": "2241500"
  },
  {
    "text": "we're going to be setting up.net and we're running.net 7 for this so we need to include that in our pipeline for our",
    "start": "2242079",
    "end": "2248740"
  },
  {
    "text": "build flow and once we have that we're going to run",
    "start": "2248740",
    "end": "2254640"
  },
  {
    "text": "everything that we just ran uh in the command line so we're going to run our tests and if they pass we're going to",
    "start": "2255160",
    "end": "2260200"
  },
  {
    "text": "publish both the client and the API get it ready for use then we need to do the SWA flow",
    "start": "2260200",
    "end": "2268540"
  },
  {
    "text": "and for that one first of all we need to log into azure",
    "start": "2268540",
    "end": "2274720"
  },
  {
    "text": "so same as we did in our IAC and then we need to get access to that secret the same way that we did in the um in the",
    "start": "2274720",
    "end": "2282520"
  },
  {
    "text": "command line extra steps though because we need to add this line underneath we need to add",
    "start": "2282520",
    "end": "2289240"
  },
  {
    "text": "a mask to that variable that we're getting out of the CLI otherwise if you went to have",
    "start": "2289240",
    "end": "2296140"
  },
  {
    "text": "this talk yesterday you're going to be exposing your secrets in your logs because GitHub isn't quite as secure as",
    "start": "2296140",
    "end": "2301780"
  },
  {
    "text": "it should be when looking at the log files it's good but it's not perfect",
    "start": "2301780",
    "end": "2307780"
  },
  {
    "text": "uh interesting one for this by the way if you use GitHub output then you can share your variables between your steps",
    "start": "2307780",
    "end": "2314920"
  },
  {
    "text": "you can also do an output from a job I could not get that to work with the",
    "start": "2314920",
    "end": "2319960"
  },
  {
    "text": "mask I've had this written like in four different ways and it works perfectly right up until the point where I add the",
    "start": "2319960",
    "end": "2325660"
  },
  {
    "text": "mask and as soon as I add the mask this is not available outside of the job that I put it in I don't know if that's my",
    "start": "2325660",
    "end": "2331780"
  },
  {
    "text": "design or not but it's something useful to know",
    "start": "2331780",
    "end": "2336000"
  },
  {
    "text": "and then once we have that now we can just do the deploy which is kind of the same as we did before",
    "start": "2337660",
    "end": "2343720"
  },
  {
    "text": "so we're going to install node because that static web app CLI that I was talking about you get from npm",
    "start": "2343720",
    "end": "2351460"
  },
  {
    "text": "so we're going to install it from npm",
    "start": "2351460",
    "end": "2355800"
  },
  {
    "text": "um and then we're going to deploy our client from the WWE root folder our API",
    "start": "2359740",
    "end": "2366300"
  },
  {
    "text": "using that deployment token and we're still pushing up to production here",
    "start": "2366300",
    "end": "2371920"
  },
  {
    "text": "we're going to deal with the staging 50 minutes we can do this staging we're going to do the staging environments in",
    "start": "2371920",
    "end": "2377920"
  },
  {
    "text": "a minute because there's a few extra steps that we need to take there but for now let's actually get our automated",
    "start": "2377920",
    "end": "2384820"
  },
  {
    "text": "build working and deploy from our pipeline rather than our own command line",
    "start": "2384820",
    "end": "2390838"
  },
  {
    "text": "with another typo in it because of course so hopefully that's going to push up and",
    "start": "2394780",
    "end": "2400420"
  },
  {
    "text": "hopefully I put everything in the right place this time and we should be able to go to here",
    "start": "2400420",
    "end": "2406720"
  },
  {
    "text": "go to our actions and we can see that it's already kicked off so we have our CI CD working we do a",
    "start": "2406720",
    "end": "2413740"
  },
  {
    "text": "push domain this gets built and deployed it's going to take a few minutes to deploy so why we're doing that let's",
    "start": "2413740",
    "end": "2419680"
  },
  {
    "text": "carry on with our staging environment and see what we need to do there",
    "start": "2419680",
    "end": "2425760"
  },
  {
    "text": "so the staging environment that's only available in a pull request so I'm not actually going to make these",
    "start": "2427900",
    "end": "2434140"
  },
  {
    "text": "changes inside of the main branch I'm going to make a feature Branch for this",
    "start": "2434140",
    "end": "2439660"
  },
  {
    "text": "push it up to a pull request and watch everything happen that way so let's add",
    "start": "2439660",
    "end": "2445000"
  },
  {
    "text": "a new branch over that add staging",
    "start": "2445000",
    "end": "2451380"
  },
  {
    "text": "now I want to change my index.razor again because now we're deployed via PR",
    "start": "2454839",
    "end": "2462359"
  },
  {
    "text": "and then we're going to change our pipeline just a little bit",
    "start": "2462579",
    "end": "2467520"
  },
  {
    "text": "now the first one that I want to do is I want to split up my workflow I want one job that does the testing in the",
    "start": "2468700",
    "end": "2475240"
  },
  {
    "text": "building and I want another job that actually pushes it up to Azure so that I can roll back easily in the future when",
    "start": "2475240",
    "end": "2481960"
  },
  {
    "text": "it fails I only have to do the push to Azure rather than run everything again",
    "start": "2481960",
    "end": "2487859"
  },
  {
    "text": "so in order to do that first thing that we need to do is after we've built our",
    "start": "2487859",
    "end": "2493420"
  },
  {
    "text": "API we're going to push our entire dist folder up to GitHub artifacts so that we",
    "start": "2493420",
    "end": "2500380"
  },
  {
    "text": "can use it in the next step and then we're going to separate this with a new job",
    "start": "2500380",
    "end": "2506820"
  },
  {
    "text": "now this is going to run exactly the same as the other one did",
    "start": "2506920",
    "end": "2511960"
  },
  {
    "text": "place yes so it's going to run on a push oh it's going to run on a pull request which",
    "start": "2511960",
    "end": "2518079"
  },
  {
    "text": "isn't closed but it's also only going to run after the build and test job finish",
    "start": "2518079",
    "end": "2523300"
  },
  {
    "text": "so if the build fails obviously we have nothing to push up so that's one's not going to run",
    "start": "2523300",
    "end": "2529119"
  },
  {
    "text": "and then the first step that we do is then download all of those artifacts that we just pushed up at the end of the",
    "start": "2529119",
    "end": "2534940"
  },
  {
    "text": "previous job now",
    "start": "2534940",
    "end": "2540520"
  },
  {
    "text": "in my original workflow we had this production flag here so we",
    "start": "2540520",
    "end": "2546820"
  },
  {
    "text": "actually need a step to figure out what environment we should be pushing up to",
    "start": "2546820",
    "end": "2552520"
  },
  {
    "text": "I'm just going to do that with a small script that just simply says you know if it's a push then I'm going to production",
    "start": "2552520",
    "end": "2558460"
  },
  {
    "text": "if it's not a push then I'm going to a staging environment so I want my environment to be staging",
    "start": "2558460",
    "end": "2565240"
  },
  {
    "text": "and then the pr number of my push",
    "start": "2565240",
    "end": "2571720"
  },
  {
    "text": "this has some rules to it this has to be alphanumeric",
    "start": "2572040",
    "end": "2577599"
  },
  {
    "text": "only so you can't do a dash or a DOT or anything else if you do do a dash or a DOT or anything else it would just",
    "start": "2577599",
    "end": "2583599"
  },
  {
    "text": "always push to preview which took me a little bit of time bashing my head against the table a couple of months ago getting my head",
    "start": "2583599",
    "end": "2589960"
  },
  {
    "text": "around now that we have that available we can change our",
    "start": "2589960",
    "end": "2598240"
  },
  {
    "text": "deployment step",
    "start": "2598240",
    "end": "2601380"
  },
  {
    "text": "so that we now deploy to that environment flag that we got from",
    "start": "2604119",
    "end": "2609339"
  },
  {
    "text": "the previous step so this will now the same as the default pipeline does",
    "start": "2609339",
    "end": "2616500"
  },
  {
    "text": "okay same as the default pipeline does this one will create you your",
    "start": "2617260",
    "end": "2623200"
  },
  {
    "text": "environment on the Fly and it means that if you run out of staging slots because you've got loads of pull requests open you can do some manual cleaning uh",
    "start": "2623200",
    "end": "2630819"
  },
  {
    "text": "inside of the portal or on the command line um and if you need to look at that PR again you can just kick off that",
    "start": "2630819",
    "end": "2637119"
  },
  {
    "text": "workflow a second time and it will just recreate it on the Fly for you every single time",
    "start": "2637119",
    "end": "2643740"
  },
  {
    "text": "that we need to do on this side of things is when we are",
    "start": "2644680",
    "end": "2650619"
  },
  {
    "text": "um making a pull request we want an easy way to find the location that out of the",
    "start": "2650619",
    "end": "2656920"
  },
  {
    "text": "box workflow it puts a comment on your pull request that you can just click on and go straight to your test environment",
    "start": "2656920",
    "end": "2663579"
  },
  {
    "text": "and I want to do the same thing here so after we've deployed",
    "start": "2663579",
    "end": "2670599"
  },
  {
    "text": "what we're going to do is get that staging hostname and we're going to use the same command that we used in order",
    "start": "2670599",
    "end": "2676720"
  },
  {
    "text": "to do our custom domain so the AZ static web app environment list only now rather than looking for that",
    "start": "2676720",
    "end": "2682960"
  },
  {
    "text": "default name we have a different query that says if the hostname contains our",
    "start": "2682960",
    "end": "2690880"
  },
  {
    "text": "environment because the URL for your staging environment always contains the staging environment name",
    "start": "2690880",
    "end": "2697599"
  },
  {
    "text": "then get me that hostname out and put it in a variable that I can use in a future",
    "start": "2697599",
    "end": "2702640"
  },
  {
    "text": "step and the last step for the pr is updating the GitHub",
    "start": "2702640",
    "end": "2708760"
  },
  {
    "text": "PR itself and here I'm using GitHub script I'm",
    "start": "2708760",
    "end": "2716140"
  },
  {
    "text": "just putting some markup in here which says staging of home it's been updated you can test it in this location and",
    "start": "2716140",
    "end": "2722859"
  },
  {
    "text": "this is a person that kicked it off and then we use a GitHub rest API in",
    "start": "2722859",
    "end": "2728260"
  },
  {
    "text": "order to push it up to GitHub and make it available for us so that's how we get",
    "start": "2728260",
    "end": "2735280"
  },
  {
    "text": "our staging environments now we need to clean the staging environments up when we finish our pull request so we have",
    "start": "2735280",
    "end": "2741760"
  },
  {
    "text": "one last job to add to this now that last job",
    "start": "2741760",
    "end": "2749280"
  },
  {
    "text": "this is only going to run on a pull request when it's closed uh again we are logging in to the AZ",
    "start": "2750400",
    "end": "2756400"
  },
  {
    "text": "command line and we're going to use our AZ static web app environment",
    "start": "2756400",
    "end": "2761920"
  },
  {
    "text": "command in order to delete the environment interesting one here if you want to",
    "start": "2761920",
    "end": "2767560"
  },
  {
    "text": "deploy you have to use the SWA CLI if you want to clean your environments up you have to use the AZ static web app",
    "start": "2767560",
    "end": "2773560"
  },
  {
    "text": "CLI okay it would be nice if they converge at some point but right now you just have to flick between the two of",
    "start": "2773560",
    "end": "2779319"
  },
  {
    "text": "them so that's now our completed workflow so checking that I am actually in a branch",
    "start": "2779319",
    "end": "2787599"
  },
  {
    "text": "and I am let's push that up",
    "start": "2787599",
    "end": "2792760"
  },
  {
    "text": "add staging let us commit and sync this we do want",
    "start": "2792760",
    "end": "2797920"
  },
  {
    "text": "to push that up and hopefully",
    "start": "2797920",
    "end": "2802960"
  },
  {
    "text": "she says",
    "start": "2802960",
    "end": "2805859"
  },
  {
    "text": "oh we need to make a pull request first of course we do let's make our pull request",
    "start": "2808240",
    "end": "2814680"
  },
  {
    "text": "and this should hopefully after a couple of seconds kick off that pipeline for us",
    "start": "2817660",
    "end": "2822819"
  },
  {
    "text": "there we go so that's now going to do the build and create those environments that's going",
    "start": "2822819",
    "end": "2828700"
  },
  {
    "text": "to take about five minutes to run so we'll come back and check on that in a second in the meantime",
    "start": "2828700",
    "end": "2835780"
  },
  {
    "text": "I did see that my Advil pipeline worked so if I come back to my I'm going to try",
    "start": "2835780",
    "end": "2841420"
  },
  {
    "text": "it here again there we go the wiffy cleared",
    "start": "2841420",
    "end": "2846819"
  },
  {
    "text": "uh we now have my deployed by pipeline so we can see that",
    "start": "2846819",
    "end": "2852760"
  },
  {
    "text": "the changes I've made it's come up from that pipeline it's not this CLI deploy so we now have our CI CD flow but we are",
    "start": "2852760",
    "end": "2859540"
  },
  {
    "text": "in full control of it on how we want to run that",
    "start": "2859540",
    "end": "2865680"
  },
  {
    "text": "uh while we're waiting for this I want to show you then how to run this locally",
    "start": "2865900",
    "end": "2871240"
  },
  {
    "text": "because it's all very well running it inside of azure inside of a staging environment that you should really be",
    "start": "2871240",
    "end": "2877240"
  },
  {
    "text": "checking your stuff locally as well before you push it up so for that one I have my application",
    "start": "2877240",
    "end": "2883660"
  },
  {
    "text": "here open inside of visual studio and in theory it should start everything and",
    "start": "2883660",
    "end": "2889480"
  },
  {
    "text": "it's not so I need to change my startup",
    "start": "2889480",
    "end": "2895660"
  },
  {
    "text": "for Jax so that I start my API",
    "start": "2895660",
    "end": "2903700"
  },
  {
    "text": "and I start my client my eyesight is getting old uh worse the older I get",
    "start": "2903700",
    "end": "2910800"
  },
  {
    "text": "so we're going to start these up and the problem that we have running a static web app locally is your client is going",
    "start": "2911800",
    "end": "2918339"
  },
  {
    "text": "to be running on one port number your API is going to be running on another part number and they don't know how to",
    "start": "2918339",
    "end": "2923560"
  },
  {
    "text": "talk to each other the static web app in production it has some awesome glue that puts all of this together so that we",
    "start": "2923560",
    "end": "2930400"
  },
  {
    "text": "don't need to worry about that when is your static web apps were in preview",
    "start": "2930400",
    "end": "2936280"
  },
  {
    "text": "there is no way to do this aside from adding a load of code that just basically figured out if you're running",
    "start": "2936280",
    "end": "2941980"
  },
  {
    "text": "it in development then get your API from a different location than if you're running in production",
    "start": "2941980",
    "end": "2948339"
  },
  {
    "text": "thankfully they brought out the static web app CLI same one that we used for the deployment",
    "start": "2948339",
    "end": "2955240"
  },
  {
    "text": "um and now if we go to our command line and we say SWA start so that what this",
    "start": "2955240",
    "end": "2964119"
  },
  {
    "text": "will do is spin up a node.js server which pretends to be an Azure static web app and they say themselves this is not",
    "start": "2964119",
    "end": "2970900"
  },
  {
    "text": "the same as a static web app but it's good enough for local testing but always testing azure and we need to point to http",
    "start": "2970900",
    "end": "2979980"
  },
  {
    "text": "localhost if I can type 5001 I think this one's on",
    "start": "2979980",
    "end": "2987660"
  },
  {
    "text": "so we now have this um localhost 4280 no why don't we need to do that",
    "start": "2990640",
    "end": "2998380"
  },
  {
    "text": "um where's this opening that's not in the right browser Phooey",
    "start": "2998380",
    "end": "3004339"
  },
  {
    "text": "that is the right browser so now if we go to localhost 40 to 80. we should have something that",
    "start": "3004920",
    "end": "3013619"
  },
  {
    "text": "takes just a little bit longer to run because it has to get all the files through the static web app and that does add a little bit of time to it",
    "start": "3013619",
    "end": "3021560"
  },
  {
    "text": "and we should now be able to access everything that we need to to do",
    "start": "3022020",
    "end": "3028140"
  },
  {
    "text": "now looking at the time I'm not going to go through this in the detail I wanted there's one thing that I really do want",
    "start": "3028140",
    "end": "3034079"
  },
  {
    "text": "to mention though if you're doing Blazer development you have to run your static web app version in the same browser that",
    "start": "3034079",
    "end": "3041280"
  },
  {
    "text": "you're running your visual studio version of your code because to debug a Blazer wasm",
    "start": "3041280",
    "end": "3047940"
  },
  {
    "text": "application Visual Studio does all sorts of wonderful tunneling but it only works for this browser so if you take this and",
    "start": "3047940",
    "end": "3055200"
  },
  {
    "text": "run it in a different browser you'll suddenly find none of your debug points get hit and you think what the beeps going on here and again start to pull",
    "start": "3055200",
    "end": "3061980"
  },
  {
    "text": "your hair out don't be me don't do that",
    "start": "3061980",
    "end": "3066140"
  },
  {
    "text": "um how are we doing for our deployment there's one more thing that I do want to",
    "start": "3067800",
    "end": "3073260"
  },
  {
    "text": "cover even if I can't do the uh in-depth thing I want to do so let's see if our pipeline ran and",
    "start": "3073260",
    "end": "3079619"
  },
  {
    "text": "it's not finished yet why are you not finished yet we're doing the deploy is this doing",
    "start": "3079619",
    "end": "3086099"
  },
  {
    "text": "what it did locally and just taking an age to finish it is doing what it did locally and taking an age to finish",
    "start": "3086099",
    "end": "3093680"
  },
  {
    "text": "um okay we will see what happens with that one hopefully we'll come back to this so the last bit that I wanted to do is",
    "start": "3095460",
    "end": "3103260"
  },
  {
    "text": "um briefly walk you through what you need to do in order to move from that standard authentication to the custom",
    "start": "3103260",
    "end": "3110040"
  },
  {
    "text": "authentication that I mentioned at the beginning right now this application uses standard",
    "start": "3110040",
    "end": "3115500"
  },
  {
    "text": "authentication you log in by Twitter everything is set up to read the client principle that the static weather app",
    "start": "3115500",
    "end": "3121800"
  },
  {
    "text": "supplies for you and use it inside of your application when you change to a",
    "start": "3121800",
    "end": "3131339"
  },
  {
    "text": "um standard tier you get access to I can do this inside",
    "start": "3131339",
    "end": "3136680"
  },
  {
    "text": "of a different one let's stop that one because I don't need that one anymore",
    "start": "3136680",
    "end": "3142920"
  },
  {
    "text": "when you want to do this inside are when you want to move to custom authentication there's two things that",
    "start": "3142920",
    "end": "3148440"
  },
  {
    "text": "you have to do one is you have to use a standard tier app you cannot do this in the free tier which is why my pipeline I",
    "start": "3148440",
    "end": "3155940"
  },
  {
    "text": "set it up to use the standard tier even though the template defaulted to free",
    "start": "3155940",
    "end": "3161819"
  },
  {
    "text": "second thing that you have to do is actually tell the static web app that you want to use this custom",
    "start": "3161819",
    "end": "3167040"
  },
  {
    "text": "Authentication so for that one we need to put just a little bit of code",
    "start": "3167040",
    "end": "3175140"
  },
  {
    "text": "again inside of our static web app config folder which is somewhere around here again",
    "start": "3175140",
    "end": "3184280"
  },
  {
    "text": "this has to go at the top and",
    "start": "3184319",
    "end": "3190260"
  },
  {
    "text": "you give it an auth object this will tell it to use a custom Authentication you can give it a Rolls source and this",
    "start": "3190260",
    "end": "3198240"
  },
  {
    "text": "means that you no longer use the portal or the static web app itself to invite your users and to give them whatever",
    "start": "3198240",
    "end": "3205680"
  },
  {
    "text": "roles they need we're now getting this from a special Azure function that we're going to create",
    "start": "3205680",
    "end": "3211559"
  },
  {
    "text": "and this function is only available to the static web app itself once you",
    "start": "3211559",
    "end": "3218040"
  },
  {
    "text": "deploy this if you try and access this directly you're just going to get a 404 error it doesn't even let you know that",
    "start": "3218040",
    "end": "3223380"
  },
  {
    "text": "it exists inside of this Azure function you can do everything that you need in order to",
    "start": "3223380",
    "end": "3230880"
  },
  {
    "text": "give the roles that you want to give to your users based on the information you get back from your authentication",
    "start": "3230880",
    "end": "3236280"
  },
  {
    "text": "provider I would do that one in a second where's",
    "start": "3236280",
    "end": "3242160"
  },
  {
    "text": "that one so we're going to add that I have a really really poor implementation of",
    "start": "3242160",
    "end": "3248579"
  },
  {
    "text": "this I have two commas I do indeed thank you",
    "start": "3248579",
    "end": "3256680"
  },
  {
    "text": "um where's our API gone so we're going to add a new file to our API",
    "start": "3256680",
    "end": "3263420"
  },
  {
    "text": "we're going to call that getwells.cs so that's the name that we included inside of that configuration file",
    "start": "3263460",
    "end": "3271079"
  },
  {
    "text": "and ignore how I am assigning roles here because that is not good",
    "start": "3271079",
    "end": "3278099"
  },
  {
    "text": "but you have an Azure function which is called on a post and out of that inside of the body you",
    "start": "3278099",
    "end": "3285000"
  },
  {
    "text": "get a client principle now a client principle is the way that we use we give",
    "start": "3285000",
    "end": "3291660"
  },
  {
    "text": "authentication information in all of our static web apps the difference in this particular case is there is no roles",
    "start": "3291660",
    "end": "3298319"
  },
  {
    "text": "assigned to the user this is the clean version that you get once a user is actually logged in",
    "start": "3298319",
    "end": "3305040"
  },
  {
    "text": "we can then use whatever data we have inside of there so here we have access to that user ID you can put special",
    "start": "3305040",
    "end": "3311579"
  },
  {
    "text": "information from your um",
    "start": "3311579",
    "end": "3316740"
  },
  {
    "text": "authentication provider with custom roles and things that you get on that side you can read all of that in you can",
    "start": "3316740",
    "end": "3322859"
  },
  {
    "text": "use a database whatever else in order to get the roles that you want for your user",
    "start": "3322859",
    "end": "3328260"
  },
  {
    "text": "you add them just to a list of string and you output them",
    "start": "3328260",
    "end": "3333540"
  },
  {
    "text": "it's a reasonably simple thing to do and it is a pain in the neck to create because there is no way to test this",
    "start": "3333540",
    "end": "3341700"
  },
  {
    "text": "um at least not easily the static web app that I showed you that runs locally it pretends to be the",
    "start": "3341700",
    "end": "3348119"
  },
  {
    "text": "Azure static web app in that CLI one of the things that it pretends to be is authentication so whether you're using",
    "start": "3348119",
    "end": "3355079"
  },
  {
    "text": "standard or custom authentication it just takes it over for you and this you have to test in Azure with application",
    "start": "3355079",
    "end": "3361020"
  },
  {
    "text": "insights and a lot of swearing um but when it does work it is quite cool",
    "start": "3361020",
    "end": "3367200"
  },
  {
    "text": "and that's it that is all that we need to do in order to take that",
    "start": "3367200",
    "end": "3373260"
  },
  {
    "text": "standard authentication and move it into custom authentication and that's because that level of that level of abstraction",
    "start": "3373260",
    "end": "3380220"
  },
  {
    "text": "that you get in the standard layer still exists in the custom layer my code does not need to change at all it still",
    "start": "3380220",
    "end": "3386040"
  },
  {
    "text": "accesses the auth info and the roles exactly the same way that it did before",
    "start": "3386040",
    "end": "3391200"
  },
  {
    "text": "and that includes the authorization on my API",
    "start": "3391200",
    "end": "3396540"
  },
  {
    "text": "so it's a little bit of extra work but the nice one is that your application itself doesn't have to change",
    "start": "3396540",
    "end": "3403700"
  },
  {
    "text": "did my deploy finish do we have yay look at that that finish so if we go",
    "start": "3404520",
    "end": "3412920"
  },
  {
    "text": "to our pull request we should now hopefully",
    "start": "3412920",
    "end": "3419058"
  },
  {
    "text": "have a staging environment which is deployed by PR out of the box and you can see that my environment is the bray",
    "start": "3419220",
    "end": "3426300"
  },
  {
    "text": "smoke blinded bloody blah staging1.west Europe and Dot",
    "start": "3426300",
    "end": "3431780"
  },
  {
    "text": "azurewebapps.net that West Europe is also important when you decide where you want to renew Azure static web app it is",
    "start": "3431780",
    "end": "3438839"
  },
  {
    "text": "not for your static files it's only for your API unless you're in a staging environment",
    "start": "3438839",
    "end": "3444900"
  },
  {
    "text": "and in which case it does deploy your static files to the region that is assigned to your Azure static web app",
    "start": "3444900",
    "end": "3452339"
  },
  {
    "text": "itself looking at the time I'm about out so I want to move back to my",
    "start": "3452339",
    "end": "3458579"
  },
  {
    "text": "presentation here and I want my clicker to work thank you",
    "start": "3458579",
    "end": "3465180"
  },
  {
    "text": "I really want to call out these three people because um I am not a GitHub workflow expert I set",
    "start": "3465180",
    "end": "3473040"
  },
  {
    "text": "this up and thanks to Max Oscar and Rick we managed to get this one working they",
    "start": "3473040",
    "end": "3479400"
  },
  {
    "text": "helped me for the bits and the workflow specific stuff that I was scratching my head at so I really want to call them",
    "start": "3479400",
    "end": "3485220"
  },
  {
    "text": "out and finally um I used a lot of resources to write",
    "start": "3485220",
    "end": "3491700"
  },
  {
    "text": "this we had the static web app CLI the AZ static web app static web apps themselves and if you go to that QR code",
    "start": "3491700",
    "end": "3498720"
  },
  {
    "text": "that is a page on my website that links to all of these different resources to",
    "start": "3498720",
    "end": "3504420"
  },
  {
    "text": "help you get started and Shameless plug time the top resource that I've got",
    "start": "3504420",
    "end": "3509640"
  },
  {
    "text": "inside of that QR code might be a link to my book that I wrote last year I'm beginning static web apps it doesn't",
    "start": "3509640",
    "end": "3516119"
  },
  {
    "text": "cover what we've done today but it does cover getting started uh with that I think I'm about out of",
    "start": "3516119",
    "end": "3523200"
  },
  {
    "text": "time but if anybody's got any questions please do come forward uh yeah thank you very much for your attention today",
    "start": "3523200",
    "end": "3531200"
  },
  {
    "text": "foreign",
    "start": "3531720",
    "end": "3534720"
  }
]