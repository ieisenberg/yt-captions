[
  {
    "text": "good morning everybody my name is Alex Mackey and this is essential xss or",
    "start": "5779",
    "end": "12179"
  },
  {
    "text": "cross-site scripting I'm a Staff engineer at a organization called Willow we specialize in their",
    "start": "12179",
    "end": "18240"
  },
  {
    "text": "development and implementation of digital twins I've recently moved into an app set role I've had various roles",
    "start": "18240",
    "end": "25439"
  },
  {
    "text": "in Consulting product in all sorts of different pieces but now I've got a bit",
    "start": "25439",
    "end": "30599"
  },
  {
    "text": "of a focus on security so what are we going to be talking about today well we're going to talk about a",
    "start": "30599",
    "end": "36719"
  },
  {
    "text": "number of different things I want to start off we're going to look at the history of xss where xss actually came",
    "start": "36719",
    "end": "42059"
  },
  {
    "text": "from xss is divided into a number of different types of approaches and",
    "start": "42059",
    "end": "47940"
  },
  {
    "text": "they've all got their distinct characteristics things to watch out for and think so where to be aware of and I",
    "start": "47940",
    "end": "53520"
  },
  {
    "text": "want to show you these sometimes there's a bit of a perception that xss is kind of it's a bit of an",
    "start": "53520",
    "end": "59399"
  },
  {
    "text": "annoying issue and an attacker might be able to use it to maybe throw up an alert box or maybe annoy the user I",
    "start": "59399",
    "end": "66479"
  },
  {
    "text": "don't think that's true and I think xss can be a very serious issue indeed and I'm going to show you several examples",
    "start": "66479",
    "end": "72540"
  },
  {
    "text": "of this during the presentation and we're going to go right up to actually running some code via xss on the machine",
    "start": "72540",
    "end": "78840"
  },
  {
    "text": "and getting an interactive terminal or remote code execution and at that point I guess it's kind of game over once you",
    "start": "78840",
    "end": "85500"
  },
  {
    "text": "can run code on a web server itself um xss is actually quite hard to",
    "start": "85500",
    "end": "92400"
  },
  {
    "text": "identify sometimes and I want to show you um how tricky it can be and some of the tricks that attackers will use to",
    "start": "92400",
    "end": "99180"
  },
  {
    "text": "circumvent detection and filters and then if we get time I might just touch",
    "start": "99180",
    "end": "104220"
  },
  {
    "text": "on a couple of examples with free apps and some some things to be aware of there",
    "start": "104220",
    "end": "110820"
  },
  {
    "text": "all the slides and codes everything I'm going to show you it's all available don't feel you need to take photos or",
    "start": "110820",
    "end": "117479"
  },
  {
    "text": "anything of it it's all up there for you to use head over to my GitHub and you'll",
    "start": "117479",
    "end": "124259"
  },
  {
    "text": "you'll find this stuff there shortly after the presentation",
    "start": "124259",
    "end": "129020"
  },
  {
    "text": "so before I start this um as it's a security talk and I'm going to be showing you some things which would be",
    "start": "129360",
    "end": "135720"
  },
  {
    "text": "illegal to do if you don't have permission to I kind of need to put this warning out here um we are all adults but if you do some",
    "start": "135720",
    "end": "143340"
  },
  {
    "text": "of these things on sites that you don't have permission to do so you could get in a lot of trouble you could",
    "start": "143340",
    "end": "149220"
  },
  {
    "text": "potentially even go to jail please don't do that if you do want to play with some of these things I'm going to show you",
    "start": "149220",
    "end": "154620"
  },
  {
    "text": "some examples and I've got an application you can download to flavorfit but don't go away try these on",
    "start": "154620",
    "end": "160440"
  },
  {
    "text": "some big sites or your employers if you do do this stuff you need permission from someone to do it and it also needs",
    "start": "160440",
    "end": "167099"
  },
  {
    "text": "to be permission from someone who is authorized to give you that permission if you turn to your mate to the next to",
    "start": "167099",
    "end": "172140"
  },
  {
    "text": "you and go what do you reckon they may not be the person that can say yep you can go and attack this million dollar",
    "start": "172140",
    "end": "178260"
  },
  {
    "text": "company's website and cause all sorts of damage so please do be careful with this there's a lot of options if you do want",
    "start": "178260",
    "end": "186060"
  },
  {
    "text": "to learn about this type of thing for me I think you can't really learn and",
    "start": "186060",
    "end": "191099"
  },
  {
    "text": "understand some of these Concepts without actually understanding how someone will attack an application so we",
    "start": "191099",
    "end": "197220"
  },
  {
    "text": "kind of want to learn that defense through also understanding the the offensive aspects of this two really",
    "start": "197220",
    "end": "203220"
  },
  {
    "text": "good sites and applications and forwardings um are try Hackney and hack the box so",
    "start": "203220",
    "end": "209220"
  },
  {
    "text": "if you um try hack me if you've never touched this stuff before they've got a heap of labs tutorials and workshops you",
    "start": "209220",
    "end": "216120"
  },
  {
    "text": "can go through it's quite good fun it's only about 10 bucks a month very good value and you'll learn a lot with this",
    "start": "216120",
    "end": "223019"
  },
  {
    "text": "site once you've got some of the basics down um hack the box is also a really good option again about ten dollars a month",
    "start": "223019",
    "end": "229560"
  },
  {
    "text": "but here you've got you'll be expected to have a certain level of knowledge you'll have various boxes and puzzles um",
    "start": "229560",
    "end": "236340"
  },
  {
    "text": "to work out um I had a lot of fun with these especially over the lockdown period when there wasn't a lot else to do and they",
    "start": "236340",
    "end": "243060"
  },
  {
    "text": "are a great way to learn this morning I'm going to be showing you an application which I developed this is",
    "start": "243060",
    "end": "250019"
  },
  {
    "text": "a small node MySQL application I wanted something small which had a heap of",
    "start": "250019",
    "end": "255900"
  },
  {
    "text": "vulnerabilities and issues that I could practice with that I could script with and I could play and understand some of",
    "start": "255900",
    "end": "262440"
  },
  {
    "text": "these things this is available to download please have a play with it it's got heaps of different issues that you",
    "start": "262440",
    "end": "269040"
  },
  {
    "text": "can play with SQL injection something called local file includes there's all sorts of different things here if you",
    "start": "269040",
    "end": "275340"
  },
  {
    "text": "want to go and learn about this type of stuff so this talk came about because I was",
    "start": "275340",
    "end": "281520"
  },
  {
    "text": "interviewing front-end development candidates and we'd asked various questions during the interviews and one",
    "start": "281520",
    "end": "287400"
  },
  {
    "text": "of the questions um I would ask is um tell me about xss or cross-site scripting now I wasn't",
    "start": "287400",
    "end": "293580"
  },
  {
    "text": "expecting a detailed level of knowledge but it came as a real surprise to me that when I went and asked people what",
    "start": "293580",
    "end": "299400"
  },
  {
    "text": "xss was um the vast majority of them actually just didn't know some people got",
    "start": "299400",
    "end": "304680"
  },
  {
    "text": "confused with various other types of issues but the majority of people didn't",
    "start": "304680",
    "end": "309840"
  },
  {
    "text": "know this was a bit of a surprise to me and also a bit of a concern",
    "start": "309840",
    "end": "315240"
  },
  {
    "text": "how big an issue is xxs well it turns out it's rather a big issue I estimated",
    "start": "315240",
    "end": "322380"
  },
  {
    "text": "that about 20 of all um security bulletins last three years were due to xss we have estimates of um over xss",
    "start": "322380",
    "end": "331320"
  },
  {
    "text": "issues existing in over 60 percent of uh applications who provide various um uh web app",
    "start": "331320",
    "end": "340500"
  },
  {
    "text": "firewalls and services and monitor traffic they found an enormous amount of traffic appeared to contain xss attacks",
    "start": "340500",
    "end": "348360"
  },
  {
    "text": "and interestingly it wasn't even targeted at some of the big sites it was just everyone so there's various folks",
    "start": "348360",
    "end": "355500"
  },
  {
    "text": "out there God knows what they have in mind for this but they're just literally hitting everything they can with some of",
    "start": "355500",
    "end": "361860"
  },
  {
    "text": "these issues even if you're a fairly small site or organization if you don't",
    "start": "361860",
    "end": "367500"
  },
  {
    "text": "protect against some of these things you may be hit by some of these attacks xss is consistently high in I suspect",
    "start": "367500",
    "end": "375360"
  },
  {
    "text": "we're all familiar with o wasp for top 10. um if you're not please take a look it covers the main security issues in a",
    "start": "375360",
    "end": "383880"
  },
  {
    "text": "prioritized order a lot of discussion um and I guess statistics go into",
    "start": "383880",
    "end": "389780"
  },
  {
    "text": "determining what's the the top issues at the moment and then it gets reviewed every few years xss is consistently near",
    "start": "389780",
    "end": "396780"
  },
  {
    "text": "the top of this they did a bit of a rearrangement of categories and it's currently in the injection category",
    "start": "396780",
    "end": "403440"
  },
  {
    "text": "along with things like SQL injection um but still very much a big issue",
    "start": "403440",
    "end": "409560"
  },
  {
    "text": "um for those of you familiar with bug Bounty programs um it's it's just so common that some of these will actually",
    "start": "409560",
    "end": "415139"
  },
  {
    "text": "exclude excesses from it entirely um it seems a bit of an issue but I",
    "start": "415139",
    "end": "420600"
  },
  {
    "text": "think we can conclude from some of this that um even though this has been around a very long time it's still very much a",
    "start": "420600",
    "end": "426780"
  },
  {
    "text": "big issue here so we find the term xss used first of",
    "start": "426780",
    "end": "431940"
  },
  {
    "text": "all in 2000 and in Microsoft published a report with an organization called set",
    "start": "431940",
    "end": "438720"
  },
  {
    "text": "and what they were getting was reports of people referencing malicious scripts",
    "start": "438720",
    "end": "444180"
  },
  {
    "text": "on another web server and that's where we kind of get that cross-site script in because that was a script that has been",
    "start": "444180",
    "end": "449699"
  },
  {
    "text": "run from another web server um there I'm going to show you some examples today it",
    "start": "449699",
    "end": "454979"
  },
  {
    "text": "is much more complicated than that and there's a lot of different ways of applying this but that's where we first",
    "start": "454979",
    "end": "462300"
  },
  {
    "text": "see this term so that's 22 years ago these these things started to appear and",
    "start": "462300",
    "end": "467520"
  },
  {
    "text": "it's still one of the main issues today I think part of the reason people don't",
    "start": "467520",
    "end": "473819"
  },
  {
    "text": "understand some of this is that xss isn't really a very good name um or cross-site scripting",
    "start": "473819",
    "end": "480180"
  },
  {
    "text": "um for me and I don't have a nice Snappy thing it's running code in other people's browsers from sites you don't",
    "start": "480180",
    "end": "485819"
  },
  {
    "text": "own um that kind of encapsulates what we're what we're going to do with this and what I'm going to show you this morning",
    "start": "485819",
    "end": "493139"
  },
  {
    "text": "but first of all let's take a web page and let's say that you could run JavaScript code it doesn't necessarily",
    "start": "493139",
    "end": "499800"
  },
  {
    "text": "need to be JavaScript it could be HTML even CSS there's various attacks via CSS",
    "start": "499800",
    "end": "505680"
  },
  {
    "text": "believe it or not what Mischief could you get up again up to if you have the ability",
    "start": "505680",
    "end": "511620"
  },
  {
    "text": "um to to do this on a web page well quite a lot of things and this only um",
    "start": "511620",
    "end": "517200"
  },
  {
    "text": "expands because I think now we can consider the the web browser is almost a",
    "start": "517200",
    "end": "522240"
  },
  {
    "text": "mini operating system in itself um there's a heap of different sort of apis",
    "start": "522240",
    "end": "527580"
  },
  {
    "text": "um that we can use here we've got location stuff we've got microphone we've got access to the web camera we've",
    "start": "527580",
    "end": "533040"
  },
  {
    "text": "got Bluetooth we've got we've got a vibration API we've got battery apis there's an enormous amount of power and",
    "start": "533040",
    "end": "539760"
  },
  {
    "text": "functionality um here now of course in order to use some of these apis the browser will pop up a permission dialog",
    "start": "539760",
    "end": "546480"
  },
  {
    "text": "and they'll say do you grant location permissions and the user will have to grant that but there's a lot of",
    "start": "546480",
    "end": "553140"
  },
  {
    "text": "different options here what can we do with some of this well",
    "start": "553140",
    "end": "558899"
  },
  {
    "text": "um quite a lot we could manipulate um or deface a web page that could be anything",
    "start": "558899",
    "end": "565560"
  },
  {
    "text": "from someone just posting something annoying to actually potentially manipulating markets and so on if",
    "start": "565560",
    "end": "572820"
  },
  {
    "text": "someone pays some fake news story they overwrite some content and change some",
    "start": "572820",
    "end": "578220"
  },
  {
    "text": "uh stuff there that could have a very real effect on things if you're able to manipulate the content of a popular site",
    "start": "578220",
    "end": "586620"
  },
  {
    "text": "we could use it to read sensitive information on a page if someone's logged into a banking application",
    "start": "586620",
    "end": "592680"
  },
  {
    "text": "um we could maybe read out their balances and so on we could read cookies local storage",
    "start": "592680",
    "end": "598860"
  },
  {
    "text": "um information that type of thing we could potentially reset the user's password to a known value",
    "start": "598860",
    "end": "605519"
  },
  {
    "text": "we can make requests to the services as that user we could redirect the user to a",
    "start": "605519",
    "end": "611100"
  },
  {
    "text": "malicious site Michael buble.com something terrible like that that could be sent to or maybe they're sent to",
    "start": "611100",
    "end": "617580"
  },
  {
    "text": "another site to go and download some malware that could be pretty serious and that's one line of JavaScript",
    "start": "617580",
    "end": "622940"
  },
  {
    "text": "window.location equals whatever it is we could potentially use modern apis",
    "start": "622940",
    "end": "628260"
  },
  {
    "text": "like the camera we could even take a picture of them now the user sometimes would have already given permission to",
    "start": "628260",
    "end": "634560"
  },
  {
    "text": "the site for some of these type of things already um and then there's also an issue called",
    "start": "634560",
    "end": "642779"
  },
  {
    "text": "um server-side request forgery which I'll talk about a little bit later now some of these things do depend on",
    "start": "642779",
    "end": "648779"
  },
  {
    "text": "other Protections in place and certain configuration as well which I'm going to talk about",
    "start": "648779",
    "end": "654660"
  },
  {
    "text": "one of the sort of fairly early examples of xssi like is the Sami worm now",
    "start": "654660",
    "end": "661200"
  },
  {
    "text": "um uh Samir Kamura semi Kumar sorry discovered an xss issue",
    "start": "661200",
    "end": "667519"
  },
  {
    "text": "in the site Myspace and what he did with this is he used it to post the text but",
    "start": "667519",
    "end": "674279"
  },
  {
    "text": "most of all Sammy is my hero and send himself a friend request so it wasn't",
    "start": "674279",
    "end": "679500"
  },
  {
    "text": "really particularly malicious but you can imagine what it must have felt like when he discovered this issue before",
    "start": "679500",
    "end": "685860"
  },
  {
    "text": "he'd have some fun with it goes to bed 20 hours later discovers he's got over a million different friends requests so I",
    "start": "685860",
    "end": "693899"
  },
  {
    "text": "suspect at that point his uh he probably had a bit of a sick feeling in his stomach because that's not the sort of",
    "start": "693899",
    "end": "700200"
  },
  {
    "text": "thing that's just going to go away on its own um I believe he did end up getting fined from this but I think he's he's doing",
    "start": "700200",
    "end": "707940"
  },
  {
    "text": "okay after that um let's get into some demos and the first thing I want to show you um is a",
    "start": "707940",
    "end": "714720"
  },
  {
    "text": "demo of the different types of xss now I'm going to use my test application as",
    "start": "714720",
    "end": "722519"
  },
  {
    "text": "I said it's a node application I'm going to use a templating framework called ejs it's very easy to understand I've tried",
    "start": "722519",
    "end": "729360"
  },
  {
    "text": "to make it as simple as possible whether it's for your dependencies and what we have here is an example of a online shop",
    "start": "729360",
    "end": "735420"
  },
  {
    "text": "cap bicycles so a shop specializing in bicycles for your cat and if anyone",
    "start": "735420",
    "end": "741420"
  },
  {
    "text": "wants to invest in this afterwards please go and see a psychologist",
    "start": "741420",
    "end": "746700"
  },
  {
    "text": "we will get into this now so we've got our bikes here and we're going to go into uh the detail of our blanks now I",
    "start": "746700",
    "end": "755100"
  },
  {
    "text": "guess this is kind of the canonical example of xss here we have the ability to review a product here and we've got a",
    "start": "755100",
    "end": "762959"
  },
  {
    "text": "text box here where we can go and add some details so one of the first things",
    "start": "762959",
    "end": "768000"
  },
  {
    "text": "that you could start doing is potentially using formatting tags so the",
    "start": "768000",
    "end": "773760"
  },
  {
    "text": "reason we might do that or an attacker might do that is because they're less noticeable than some of the other things so if we put a say a bold tag or even a",
    "start": "773760",
    "end": "783540"
  },
  {
    "text": "marquee or something and you find that that renders that we know that their output hasn't been encoded properly",
    "start": "783540",
    "end": "790440"
  },
  {
    "text": "what do I mean by that well let's put in kind of our hello world uh xss so I'm",
    "start": "790440",
    "end": "795839"
  },
  {
    "text": "going to open a script block and we'll type in hello world and we'll close that script block",
    "start": "795839",
    "end": "803639"
  },
  {
    "text": "off and we'll go and submit that and it's probably no surprise or hopefully have",
    "start": "803639",
    "end": "809880"
  },
  {
    "text": "no surprise that once that comment's been added we now have an annoying JavaScript alert box fired off there so",
    "start": "809880",
    "end": "818399"
  },
  {
    "text": "we've confirmed here we have the ability to run code on this page here now the",
    "start": "818399",
    "end": "824040"
  },
  {
    "text": "reason that that run is because it was not encoded properly when we output the",
    "start": "824040",
    "end": "829320"
  },
  {
    "text": "comments there so if I was to go into the view page source and we'll search",
    "start": "829320",
    "end": "835200"
  },
  {
    "text": "for hello and I don't know if that's a bit small there and we'll see if we can zoom in a",
    "start": "835200",
    "end": "841380"
  },
  {
    "text": "bit if we can we can see we've got our script block there rendered unencoded as",
    "start": "841380",
    "end": "846540"
  },
  {
    "text": "if we've written that ourselves now I've deliberately you know put this particular issue in there so I'm going",
    "start": "846540",
    "end": "853680"
  },
  {
    "text": "to go into uh my temporal 18 framework here I'm using a template team framework",
    "start": "853680",
    "end": "858720"
  },
  {
    "text": "called ejs here I wanted something pretty simple and in EGS when you go and output some content you have two ways of",
    "start": "858720",
    "end": "866100"
  },
  {
    "text": "doing it essentially this percent minus sign tells ejs don't encode anything put",
    "start": "866100",
    "end": "871980"
  },
  {
    "text": "it as is on the web page so we could fix that one up if we go and change that to",
    "start": "871980",
    "end": "877200"
  },
  {
    "text": "an equal sign we'll go and refresh the page there and",
    "start": "877200",
    "end": "883320"
  },
  {
    "text": "then we didn't get that block there and then we got this this code output as we'd expect there and then of course if",
    "start": "883320",
    "end": "891360"
  },
  {
    "text": "we go and have a look in the page Source we'll go search for hello again and",
    "start": "891360",
    "end": "896579"
  },
  {
    "text": "instead of that script tags we've got this uh this block here and it's HTML",
    "start": "896579",
    "end": "902820"
  },
  {
    "text": "encoded it as it should have done so that's good that would uh protect us",
    "start": "902820",
    "end": "907980"
  },
  {
    "text": "against um excess scissors there um by ensuring",
    "start": "907980",
    "end": "913019"
  },
  {
    "text": "we properly encode the output now I'm going to deliberately create",
    "start": "913019",
    "end": "919320"
  },
  {
    "text": "that issue again because it's going to be easier to show you some of these other things and it would be a short",
    "start": "919320",
    "end": "924420"
  },
  {
    "text": "presentation if we went and sorted everything out right from the start",
    "start": "924420",
    "end": "929639"
  },
  {
    "text": "so let's put that to issue back in again now what I've shown you there is an",
    "start": "929639",
    "end": "935100"
  },
  {
    "text": "example of stored xss and it stored xss because we've taken a value and it's been stored in a database somewhere in",
    "start": "935100",
    "end": "941760"
  },
  {
    "text": "this instance there's a mySQL database operating behind the scenes that it's going to put this in",
    "start": "941760",
    "end": "947339"
  },
  {
    "text": "stored xss I think is more serious than some of the other types I'm going to show you and the reason for that is is",
    "start": "947339",
    "end": "953100"
  },
  {
    "text": "because once you get it in a database anyone coming to this page is going to get served up this content so through no",
    "start": "953100",
    "end": "960480"
  },
  {
    "text": "bad actions of their own they're browsing around and they want to go and buy a bike for their cat and then they're hit with our annoying JavaScript",
    "start": "960480",
    "end": "967500"
  },
  {
    "text": "alert box um let's look at the next type the next type we have is reflected xss now I'm",
    "start": "967500",
    "end": "975240"
  },
  {
    "text": "just going to use this button here I've created for demo purposes just to go and remove everything so we don't have any",
    "start": "975240",
    "end": "980639"
  },
  {
    "text": "other issues kicking her out now the other type of issue we might have is",
    "start": "980639",
    "end": "987779"
  },
  {
    "text": "um called reflected exercise and what happens here is uh instead of actually getting",
    "start": "987779",
    "end": "993540"
  },
  {
    "text": "um the data stored in the database it's actually it's taken from something",
    "start": "993540",
    "end": "999180"
  },
  {
    "text": "like a query string parameter or header and then output on the page so I don't",
    "start": "999180",
    "end": "1004279"
  },
  {
    "text": "know if you can make it out there but in the query string it says greeting equals Alex and then we've got Hello Alex at",
    "start": "1004279",
    "end": "1009980"
  },
  {
    "text": "the top of the page and there's some code which is just looking for the query string parameter and putting it on the",
    "start": "1009980",
    "end": "1016639"
  },
  {
    "text": "page there and then as you might guess we could then go and change this and we",
    "start": "1016639",
    "end": "1023240"
  },
  {
    "text": "can go and give it a script block instead and then have that executed now",
    "start": "1023240",
    "end": "1028640"
  },
  {
    "text": "it is a different type of attack here because in order for this to occur it",
    "start": "1028640",
    "end": "1033860"
  },
  {
    "text": "would require the user to go to this particular URL so this could be the side of thing that you might get from a",
    "start": "1033860",
    "end": "1040579"
  },
  {
    "text": "malicious link an email that type of thing so there's a bit more to it in",
    "start": "1040579",
    "end": "1046640"
  },
  {
    "text": "order for this attack to actually occur so um I think it's less serious although",
    "start": "1046640",
    "end": "1052340"
  },
  {
    "text": "it can still be a pretty serious issue than stored xss now there's also a third type and the third type is called Dom",
    "start": "1052340",
    "end": "1060520"
  },
  {
    "text": "based xss so in Don based xss we make use of",
    "start": "1060520",
    "end": "1069520"
  },
  {
    "text": "we need to find a function which is manipulating the page Dom or document object model and interject something",
    "start": "1069919",
    "end": "1077360"
  },
  {
    "text": "into that now in this example I've got a query string parameter special offer equals 10 discount and we can see that",
    "start": "1077360",
    "end": "1084679"
  },
  {
    "text": "that's gone in output some horrendous big blue text there telling us about the",
    "start": "1084679",
    "end": "1090020"
  },
  {
    "text": "special offer if we go and have a look at what's actually going in on the code there",
    "start": "1090020",
    "end": "1095900"
  },
  {
    "text": "then we'll find some dodgy JavaScript that I wrote where we go and get the",
    "start": "1095900",
    "end": "1101179"
  },
  {
    "text": "query string parameter and then we've output it on the the page here so it is",
    "start": "1101179",
    "end": "1107179"
  },
  {
    "text": "kind of a different mechanism that this is going to get in there and um of course we could then go and",
    "start": "1107179",
    "end": "1114919"
  },
  {
    "text": "exploit that I'm going to use an iframe here with the source set to JavaScript",
    "start": "1114919",
    "end": "1121940"
  },
  {
    "text": "load in order to exploit this and there we have our Dom based excesses there so",
    "start": "1121940",
    "end": "1128360"
  },
  {
    "text": "that's the three main types of xss before we move on just as an example we",
    "start": "1128360",
    "end": "1136580"
  },
  {
    "text": "could also use this we're going to go and manipulate the page and as it's a",
    "start": "1136580",
    "end": "1142760"
  },
  {
    "text": "cat based website we'll we'll go and leave a nice message for those browsing bikes for their cats we'll go and",
    "start": "1142760",
    "end": "1148700"
  },
  {
    "text": "manipulate the page and put a gif there cool",
    "start": "1148700",
    "end": "1154220"
  },
  {
    "text": "um let's delete that and uh move on",
    "start": "1154220",
    "end": "1159159"
  },
  {
    "text": "so in order for xss to occur there needs to be a few different things um in place here now the first thing you",
    "start": "1159500",
    "end": "1166100"
  },
  {
    "text": "need is controllable input and this is kind of where you need to start with your applications and understanding",
    "start": "1166100",
    "end": "1171740"
  },
  {
    "text": "where are all the places that the user can control the input so in our examples the user had the ability to add a",
    "start": "1171740",
    "end": "1178340"
  },
  {
    "text": "comment they had the query string and they could change this to whatever they want if the user does not have an",
    "start": "1178340",
    "end": "1184280"
  },
  {
    "text": "ability to do this um then there's no way for them to get that sort of malicious code in there",
    "start": "1184280",
    "end": "1191240"
  },
  {
    "text": "now the other thing that needs to be in place is there needs to be either a complete lack of or flawed validation on",
    "start": "1191240",
    "end": "1198320"
  },
  {
    "text": "that input coming in because if we'd had input validation on that comments box that may have prevented those xss issues",
    "start": "1198320",
    "end": "1206840"
  },
  {
    "text": "we showed there the better sites will also sanitize some of the input coming in so it might look",
    "start": "1206840",
    "end": "1213020"
  },
  {
    "text": "for malicious code script tags and so on we need the input rendered unencoded so",
    "start": "1213020",
    "end": "1219620"
  },
  {
    "text": "it needs to be able to execute and it also needs some kind of browser to run it now there's a well I say some kind of",
    "start": "1219620",
    "end": "1226460"
  },
  {
    "text": "browser because it doesn't have to just be a web browser we have all sorts of devices",
    "start": "1226460",
    "end": "1232160"
  },
  {
    "text": "um Sometimes some of the PDF rendering utilities they're actually behind the scenes use a web browser in order to",
    "start": "1232160",
    "end": "1238039"
  },
  {
    "text": "render HTML content and potentially some of these things could work and execute",
    "start": "1238039",
    "end": "1243799"
  },
  {
    "text": "some of these code now the other thing that needs to be true is we need to make sure that",
    "start": "1243799",
    "end": "1249020"
  },
  {
    "text": "additional protection is not in place I'm going to talk about some of these in a minute so of course first of all please please",
    "start": "1249020",
    "end": "1255559"
  },
  {
    "text": "make sure you're encoding or user controllable output be very very careful if you start allowing things like",
    "start": "1255559",
    "end": "1262100"
  },
  {
    "text": "formatting tags and so on as I'll show you it is very very hard to sanitize and",
    "start": "1262100",
    "end": "1268039"
  },
  {
    "text": "um and ensure this input is safe well this brings us to the question of",
    "start": "1268039",
    "end": "1273799"
  },
  {
    "text": "okay if we go and do this encoding does this mean that we are safe from xss like",
    "start": "1273799",
    "end": "1278960"
  },
  {
    "text": "that looks a pretty easy fix in our example well maybe maybe not",
    "start": "1278960",
    "end": "1284960"
  },
  {
    "text": "um so there was an issue in Cranium in 2021 um which um around passing of um the",
    "start": "1284960",
    "end": "1293840"
  },
  {
    "text": "page Dom and that had a circumvention method so even the browser manufacturers make some mistakes in some of these",
    "start": "1293840",
    "end": "1300080"
  },
  {
    "text": "things so even if you're doing everything properly there is still that possibility that there could be an issue in it templating engines regularly have",
    "start": "1300080",
    "end": "1308419"
  },
  {
    "text": "issues there's a quite a well-known one in angular we see",
    "start": "1308419",
    "end": "1314120"
  },
  {
    "text": "um bugs in tools such as Adobe PDF reader and so on that will utilize read",
    "start": "1314120",
    "end": "1320600"
  },
  {
    "text": "web content that one's a bit older but just be aware that there's a lot of different other things consuming these",
    "start": "1320600",
    "end": "1326480"
  },
  {
    "text": "things the next one I want to talk about though is if we can get a malicious payload",
    "start": "1326480",
    "end": "1331580"
  },
  {
    "text": "into a database then it could potentially be rendered it could end up being rendered in a downstream system",
    "start": "1331580",
    "end": "1338480"
  },
  {
    "text": "what do I mean by that well let's take our um our cap bicycles example if we can get some malicious content into the",
    "start": "1338480",
    "end": "1345320"
  },
  {
    "text": "database behind that it's quite common in a non-trivial system for saying an",
    "start": "1345320",
    "end": "1351260"
  },
  {
    "text": "Enterprise for data to be taken from one database to another and potentially",
    "start": "1351260",
    "end": "1356900"
  },
  {
    "text": "consumed by older systems and maybe systems that aren't as well tested or",
    "start": "1356900",
    "end": "1362900"
  },
  {
    "text": "don't have the same Protections in place that could be anything from emails going",
    "start": "1362900",
    "end": "1367940"
  },
  {
    "text": "out sent to a user um it could be a mobile device maybe it gets passed on to another database which",
    "start": "1367940",
    "end": "1374360"
  },
  {
    "text": "then consumes it renders some PDFs emails out stuff so be careful with this",
    "start": "1374360",
    "end": "1380419"
  },
  {
    "text": "because it's pretty common for this type of data to be passed around so even though the system you're working with",
    "start": "1380419",
    "end": "1386000"
  },
  {
    "text": "might be safe you might not be aware of some of the other things consuming this here's an example of this happening",
    "start": "1386000",
    "end": "1392179"
  },
  {
    "text": "Tesla so if you're lucky enough to own a Tesla apparently it has a function where",
    "start": "1392179",
    "end": "1397340"
  },
  {
    "text": "you can name your vehicle so if I was to own a text Tesla I could put Alexis Tesla this actually had an xss ECU in it",
    "start": "1397340",
    "end": "1406880"
  },
  {
    "text": "and there was a guy called Sam Curry and what he did was in his name the vehicle",
    "start": "1406880",
    "end": "1413240"
  },
  {
    "text": "is he tried a xss payload now it didn't do anything at the time and this is the",
    "start": "1413240",
    "end": "1418880"
  },
  {
    "text": "interesting point um he probably had a jumble of code in on the screen when he looked at his",
    "start": "1418880",
    "end": "1424820"
  },
  {
    "text": "Tesla's name but he then took it in for a service to Tesla and sandwiches in um",
    "start": "1424820",
    "end": "1430700"
  },
  {
    "text": "a system called xss Hunter now this is a free application",
    "start": "1430700",
    "end": "1435860"
  },
  {
    "text": "um you can sign up for in beta I believe um off top of my head it was designed by the head of um Snapchat's red team and",
    "start": "1435860",
    "end": "1443539"
  },
  {
    "text": "what this does is this gives you a unique endpoint that you can call and a",
    "start": "1443539",
    "end": "1449059"
  },
  {
    "text": "script for you to attempt to xss attacks and if xss attack is possible it hits",
    "start": "1449059",
    "end": "1454760"
  },
  {
    "text": "this unique endpoint for you and what do you get well you get a nice interface like this where it dumps a screenshot of",
    "start": "1454760",
    "end": "1462500"
  },
  {
    "text": "what the user is currently looking at all the cookies any information that it",
    "start": "1462500",
    "end": "1467960"
  },
  {
    "text": "can get out of any apis on the page and",
    "start": "1467960",
    "end": "1473059"
  },
  {
    "text": "um to say I'm surprised um he'd set this up for his Tesla um and when his car went in for a service",
    "start": "1473059",
    "end": "1479299"
  },
  {
    "text": "um this was triggered and he's probably looking at a picture of Tesla's um internal systems there",
    "start": "1479299",
    "end": "1485900"
  },
  {
    "text": "um probably not what Tesla wanted there could be all sorts of things on that page",
    "start": "1485900",
    "end": "1491120"
  },
  {
    "text": "um with a bit more work we've now got some malicious code running in a secure",
    "start": "1491120",
    "end": "1496700"
  },
  {
    "text": "presumably secure network all sorts of horrible things could go on there so do",
    "start": "1496700",
    "end": "1503000"
  },
  {
    "text": "be very careful with this because systems are linked together they don't operate in isolation and it's quite easy",
    "start": "1503000",
    "end": "1509900"
  },
  {
    "text": "to to miss this with things like an admin application or something for controlling reference data Maybe",
    "start": "1509900",
    "end": "1516440"
  },
  {
    "text": "performing one-off functions and so on um what should you do about it well um",
    "start": "1516440",
    "end": "1521600"
  },
  {
    "text": "consider sanitizing user input I say consider because it would obviously be a heap of work to take every single value",
    "start": "1521600",
    "end": "1528799"
  },
  {
    "text": "um that the user will provide it will add some overhead but maybe it's worth doing if you've got a very high profile",
    "start": "1528799",
    "end": "1535760"
  },
  {
    "text": "sites with a lot of traffic it could well be worth doing um and don't write this stuff yourself",
    "start": "1535760",
    "end": "1540860"
  },
  {
    "text": "for reasons I'm going to show you about towards the end of the presentation so so far we've discussed stored and",
    "start": "1540860",
    "end": "1548059"
  },
  {
    "text": "persisted xss that's the one that was in the database reflected that's where it came from the query string but it was",
    "start": "1548059",
    "end": "1554960"
  },
  {
    "text": "actually then output on the the page itself we looked at Dom based where we had the we used the JavaScript function",
    "start": "1554960",
    "end": "1561919"
  },
  {
    "text": "in order to go and exploit that and then we looked at blind xss that's that Tesla example where you you put that payload",
    "start": "1561919",
    "end": "1568760"
  },
  {
    "text": "in you don't really know if it's going to run but then it was kicked off a couple other examples self xss why",
    "start": "1568760",
    "end": "1576380"
  },
  {
    "text": "would you want to exercise yourself um yep a bit of a weird thing to do um I don't know if anyone saw some time",
    "start": "1576380",
    "end": "1582620"
  },
  {
    "text": "ago um I saw it on Facebook there was this thing going around where it said hey if you run this block of code it will tell",
    "start": "1582620",
    "end": "1589460"
  },
  {
    "text": "you who has looked at your profile and human beings been the Curious facts we are who's been checking me out and um",
    "start": "1589460",
    "end": "1597740"
  },
  {
    "text": "you can imagine a lot of people probably run this code in the browser console Without Really knowing what they were",
    "start": "1597740",
    "end": "1603500"
  },
  {
    "text": "doing that code would have run in the context of that user maybe it changed their password maybe it installed some",
    "start": "1603500",
    "end": "1610820"
  },
  {
    "text": "horrendous app I I don't know um so that would require a bit of social engineering tricking people into it but",
    "start": "1610820",
    "end": "1618860"
  },
  {
    "text": "it is a real issue to be aware of mutated xss it turns out as developers",
    "start": "1618860",
    "end": "1625460"
  },
  {
    "text": "we're actually pretty bad at writing valid HTML and JavaScript and what",
    "start": "1625460",
    "end": "1631400"
  },
  {
    "text": "browsers will do when you do things like forget to close a tag or you Nest tags it shouldn't ever be nested is they'll",
    "start": "1631400",
    "end": "1638360"
  },
  {
    "text": "do some of the work for you and they'll go and manipulate some of these tags and try and have a good guess at what your",
    "start": "1638360",
    "end": "1644900"
  },
  {
    "text": "actual intentions were when you were putting this on a page sometimes this is possible to exploit in",
    "start": "1644900",
    "end": "1652220"
  },
  {
    "text": "order to run xss even the big guys had a problem with this the Google search bar",
    "start": "1652220",
    "end": "1657320"
  },
  {
    "text": "I think a number of years back had an issue with this where you could make use of mail form tags and it would correct",
    "start": "1657320",
    "end": "1665120"
  },
  {
    "text": "it into something evil okay um well we've kind of we've added a pug",
    "start": "1665120",
    "end": "1671419"
  },
  {
    "text": "GIF we've popped up some annoying um alert boxes what else can we do well um",
    "start": "1671419",
    "end": "1676460"
  },
  {
    "text": "I think the next thing we probably want to talk about um is uh cookies now cookies I still use",
    "start": "1676460",
    "end": "1681980"
  },
  {
    "text": "pretty extensively in order to manage sessions of the user",
    "start": "1681980",
    "end": "1687260"
  },
  {
    "text": "um what I'm going to do here um and I'm running um from Ubuntu here I'm going to run up an",
    "start": "1687260",
    "end": "1695000"
  },
  {
    "text": "application called netcat um netcat's really awesome it's this",
    "start": "1695000",
    "end": "1700880"
  },
  {
    "text": "little tool that can do all sorts of um listening on ports sending to Ports",
    "start": "1700880",
    "end": "1706100"
  },
  {
    "text": "you can send files um I think they describe it as the networks we saw me knife it's a pretty",
    "start": "1706100",
    "end": "1711380"
  },
  {
    "text": "cool tool and what I'm going to do is um because I lose the ability to type when I'm presenting I'm going to go and",
    "start": "1711380",
    "end": "1718460"
  },
  {
    "text": "copy some code here and this is my xss attack here and I",
    "start": "1718460",
    "end": "1726500"
  },
  {
    "text": "will show you what it is shortly I'm going to paste it in the box there and we've got an image there and we can see",
    "start": "1726500",
    "end": "1732799"
  },
  {
    "text": "on the uh on load attribute there that we're going to set the source in this",
    "start": "1732799",
    "end": "1738020"
  },
  {
    "text": "example the loopback address or my machine Port 9000 and we're going to",
    "start": "1738020",
    "end": "1743240"
  },
  {
    "text": "pass across the user's cookie but before we do that I'm just going to log into",
    "start": "1743240",
    "end": "1749080"
  },
  {
    "text": "the application and we'll go back and there and we'll",
    "start": "1749080",
    "end": "1756020"
  },
  {
    "text": "paste that in I'll go um have her on the wrong Port there I'll go",
    "start": "1756020",
    "end": "1762919"
  },
  {
    "text": "to 9000. um we'll hit that up and we've now got a listener um on that Port there we'll go",
    "start": "1762919",
    "end": "1769820"
  },
  {
    "text": "and save that image there um and we'll go back and we can see we had a connection there so when that",
    "start": "1769820",
    "end": "1776779"
  },
  {
    "text": "image loaded it set the source to my machine there and also send the cookie",
    "start": "1776779",
    "end": "1783440"
  },
  {
    "text": "there so we can see we've got that cookie in the string there so in a real",
    "start": "1783440",
    "end": "1788960"
  },
  {
    "text": "world example that might be an attacker's web server but what can we do with that well as far as the browser's",
    "start": "1788960",
    "end": "1795559"
  },
  {
    "text": "concerns that cookie is used to identify the user so if I open an incognito",
    "start": "1795559",
    "end": "1801500"
  },
  {
    "text": "window there I'm going to go into the applications and cookies we've got a new cookie there I'm in um",
    "start": "1801500",
    "end": "1808820"
  },
  {
    "text": "uh the uh because I've got a new session there because um in incognito mode I'm going",
    "start": "1808820",
    "end": "1815840"
  },
  {
    "text": "to go um and take that cookie value and we'll go and copy and paste that",
    "start": "1815840",
    "end": "1822860"
  },
  {
    "text": "um we'll go and paste over the top of that um and then if I've managed to copy and paste that properly when I refresh sure",
    "start": "1822860",
    "end": "1830059"
  },
  {
    "text": "enough the application thinks I'm logged in has that user because it was used to identify me",
    "start": "1830059",
    "end": "1836419"
  },
  {
    "text": "um what could we do about that um it's well that particular ECU of course",
    "start": "1836419",
    "end": "1842120"
  },
  {
    "text": "we want to make use of um some additional protections and flags on the cookie you will find most Frameworks now",
    "start": "1842120",
    "end": "1848360"
  },
  {
    "text": "will set these by default but do check their set so once the HTTP only flag is",
    "start": "1848360",
    "end": "1853460"
  },
  {
    "text": "set um then it stops JavaScript from going document.cookie it doesn't have the",
    "start": "1853460",
    "end": "1858860"
  },
  {
    "text": "ability to do that secure flag will ensure the cookie has to be sent over a",
    "start": "1858860",
    "end": "1864620"
  },
  {
    "text": "secure connection and then we have the newer one which you may not have come across same site now same site has",
    "start": "1864620",
    "end": "1871220"
  },
  {
    "text": "several different modes that it operates in I've set it to use the strict mode and what strict mode does",
    "start": "1871220",
    "end": "1877399"
  },
  {
    "text": "is it says I will only send cookies when the request originates from the same",
    "start": "1877399",
    "end": "1882740"
  },
  {
    "text": "site that set the cookie so if you don't have that say I was on some Forum somewhere and I had a link to",
    "start": "1882740",
    "end": "1890000"
  },
  {
    "text": "hack the cat on that first request it will also send any cookies that it knows",
    "start": "1890000",
    "end": "1895880"
  },
  {
    "text": "about for that application but same-site strip stops that and it says Oh no you're actually coming from another site",
    "start": "1895880",
    "end": "1901940"
  },
  {
    "text": "so I'm not going to send those cookies so that will help reduce or prevent some of these types of not cross-site",
    "start": "1901940",
    "end": "1909500"
  },
  {
    "text": "scripting it's maybe a different set of issues cross-site request forgery but it can add additional security to your site",
    "start": "1909500",
    "end": "1916279"
  },
  {
    "text": "do be careful with this because many sites would use this type of thing to load a profile up immediately and of",
    "start": "1916279",
    "end": "1921620"
  },
  {
    "text": "course you need to you know go and test um this type of thing here very easy to enable though I think a lot",
    "start": "1921620",
    "end": "1928520"
  },
  {
    "text": "of sites now will use things like local and session storage for managing these type of tokens",
    "start": "1928520",
    "end": "1934460"
  },
  {
    "text": "um I'm not sure whether it's necessarily a worse option but it does mean that you don't benefit from things like HTTP only",
    "start": "1934460",
    "end": "1941720"
  },
  {
    "text": "on the cookie and there's nothing stopping someone you know reading that out the storage directly",
    "start": "1941720",
    "end": "1948200"
  },
  {
    "text": "oh yeah okay now have we fixed up our site well no",
    "start": "1948200",
    "end": "1953539"
  },
  {
    "text": "um the issue with um we need to discuss around cookies is that by default um they're passed so as",
    "start": "1953539",
    "end": "1961460"
  },
  {
    "text": "far when I go and access this web page as far as the browser is concerned",
    "start": "1961460",
    "end": "1967399"
  },
  {
    "text": "um any code running on this page is also running as admin here it's using that",
    "start": "1967399",
    "end": "1974600"
  },
  {
    "text": "cookie to identify this so if I can trick this web page into running a request when that request fits the",
    "start": "1974600",
    "end": "1981380"
  },
  {
    "text": "endpoint it's going to send the cookie and the application is going to think I'm the currently logged in user or admin hackthecat.com so one thing we",
    "start": "1981380",
    "end": "1990380"
  },
  {
    "text": "might want to do with this is we could use this to change the user's password",
    "start": "1990380",
    "end": "1996200"
  },
  {
    "text": "so we'll add in our xss here I'm just changing the username password and I'm",
    "start": "1996200",
    "end": "2002140"
  },
  {
    "text": "going to change it to a known value and I'm going to go and hit this endpoint now this endpoint does require the user",
    "start": "2002140",
    "end": "2008500"
  },
  {
    "text": "to be authenticated but because I'm logged into this application as admin then it's going to go and hopefully",
    "start": "2008500",
    "end": "2015700"
  },
  {
    "text": "change my password so here I've just selected from what's",
    "start": "2015700",
    "end": "2021399"
  },
  {
    "text": "currently in the user table obviously in real life you'd hopefully hash this or use an identity system but for demo",
    "start": "2021399",
    "end": "2027519"
  },
  {
    "text": "purposes it's a lot easier to show you this in plain text um we're gonna um",
    "start": "2027519",
    "end": "2032980"
  },
  {
    "text": "we'll save this and send it um and when that ran",
    "start": "2032980",
    "end": "2039240"
  },
  {
    "text": "I need to select from users",
    "start": "2039720",
    "end": "2043919"
  },
  {
    "text": "we can see we've then gone and changed that user's password there via xss so",
    "start": "2047500",
    "end": "2052720"
  },
  {
    "text": "we're starting to get more and more serious with fire xss from defacing the page to potentially getting access to",
    "start": "2052720",
    "end": "2059679"
  },
  {
    "text": "the user's passwords because at this point we've got an account set to a known value maybe an attacker then",
    "start": "2059679",
    "end": "2066220"
  },
  {
    "text": "Cycles through many different email addresses maybe they even know that you'll be registered on this site if you",
    "start": "2066220",
    "end": "2073540"
  },
  {
    "text": "took a common site like say Amazon like how many of us in the room you know are using Amazon probably you know most of",
    "start": "2073540",
    "end": "2079780"
  },
  {
    "text": "us cool",
    "start": "2079780",
    "end": "2084940"
  },
  {
    "text": "so when you have these type of functions you need to authenticate that the user",
    "start": "2084940",
    "end": "2091118"
  },
  {
    "text": "actually wants to do it so something like a change password or maybe a make payment you want an additional",
    "start": "2091119",
    "end": "2096398"
  },
  {
    "text": "protection in place to stop that type of thing that I've just shown you because if the attacker had run that and we were",
    "start": "2096399",
    "end": "2102460"
  },
  {
    "text": "asking the user for their password again we wouldn't have been able to do that and change that password to a known",
    "start": "2102460",
    "end": "2109180"
  },
  {
    "text": "value some of you might wonder whether things like cross-site request forgery tokens",
    "start": "2109180",
    "end": "2114400"
  },
  {
    "text": "help with this type of thing well it's not really the issue that this was designed to protect against",
    "start": "2114400",
    "end": "2121960"
  },
  {
    "text": "yes they make it it's very very slightly more difficult they're generally implemented as a hidden value on a page",
    "start": "2121960",
    "end": "2128920"
  },
  {
    "text": "which is sent um with the request an attacker has access to your page model",
    "start": "2128920",
    "end": "2135820"
  },
  {
    "text": "they can go and query any inputs and just send them a lot so it's not really going to protect against that type of",
    "start": "2135820",
    "end": "2141160"
  },
  {
    "text": "thing what can we do to start making this our attacker's life harder CSP policies now",
    "start": "2141160",
    "end": "2149260"
  },
  {
    "text": "CSP policies allow us fine-grained control of what should and shouldn't run on a web page you can set them in meta",
    "start": "2149260",
    "end": "2156640"
  },
  {
    "text": "tags or on HTTP headers if I was to apply this particular policy as you",
    "start": "2156640",
    "end": "2163300"
  },
  {
    "text": "might expect scripts from anywhere but the website specified my website up",
    "start": "2163300",
    "end": "2168880"
  },
  {
    "text": "there will be blocked that means if an attacker tries to reference a script on attacker.com.edu it's not going to work",
    "start": "2168880",
    "end": "2176140"
  },
  {
    "text": "because we've told the browser you should only be able to run some scripts here from this particular website",
    "start": "2176140",
    "end": "2182560"
  },
  {
    "text": "now you also get a number of other things out the box um it will block inline scripts",
    "start": "2182560",
    "end": "2188320"
  },
  {
    "text": "um event handlers various execution methods that hackers like to use and it",
    "start": "2188320",
    "end": "2195040"
  },
  {
    "text": "makes their life a lot harder harder just with applying these simple protections",
    "start": "2195040",
    "end": "2200920"
  },
  {
    "text": "so in my example we can go and apply these",
    "start": "2200920",
    "end": "2208839"
  },
  {
    "text": "protections now there is various Frameworks and libraries which will set this I'm just going to use this to set a",
    "start": "2208839",
    "end": "2216099"
  },
  {
    "text": "header here in order to demonstrate what you'll see when you have these Protections in place so I'm going to set",
    "start": "2216099",
    "end": "2224020"
  },
  {
    "text": "a Content security policy header I do need to stop the application in order for it to get get it to pick up that",
    "start": "2224020",
    "end": "2231160"
  },
  {
    "text": "change I believe we've still got an xss issue on this page with changing the password I'm going to refresh that page",
    "start": "2231160",
    "end": "2238359"
  },
  {
    "text": "and then bring up the browser console and and we can see here",
    "start": "2238359",
    "end": "2244839"
  },
  {
    "text": "um so I can is it gonna we start getting some messages here",
    "start": "2244839",
    "end": "2250599"
  },
  {
    "text": "um about um CSP policies and so on um being violated and that will provide some additional protections uh to us there",
    "start": "2250599",
    "end": "2260400"
  },
  {
    "text": "so that tends to kick around um in the um in the case so I'm just going to stop",
    "start": "2260859",
    "end": "2268300"
  },
  {
    "text": "that and bring up the application and I'm going to clear the case because",
    "start": "2268300",
    "end": "2274359"
  },
  {
    "text": "otherwise it's going to stop other things working that I want to show you",
    "start": "2274359",
    "end": "2279060"
  },
  {
    "text": "and we'll bring that up um and I'm going to go and clean out",
    "start": "2284140",
    "end": "2290700"
  },
  {
    "text": "we didn't have anything in there anyway cool",
    "start": "2292780",
    "end": "2298859"
  },
  {
    "text": "so CSP when you first implement it like you're very likely break your site",
    "start": "2299859",
    "end": "2305980"
  },
  {
    "text": "um it's actually uh there's quite a lot goes into it in any non-trivial site you're probably referencing many",
    "start": "2305980",
    "end": "2311260"
  },
  {
    "text": "different libraries from different sources and you'll find some of these other things like",
    "start": "2311260",
    "end": "2316359"
  },
  {
    "text": "um stop eating things like eval by default they will break existing applications you'll find existing",
    "start": "2316359",
    "end": "2323800"
  },
  {
    "text": "libraries templating Frameworks doing all sorts of weird things you didn't know about and they'll probably break",
    "start": "2323800",
    "end": "2329020"
  },
  {
    "text": "your site so what I recommend you doing first of all is you use the content security policy report only that won't",
    "start": "2329020",
    "end": "2335920"
  },
  {
    "text": "block these things but it will output when they're blocked to the browser console allowing you to understand when",
    "start": "2335920",
    "end": "2342099"
  },
  {
    "text": "a policy is broken um if you do find items that you absolutely can't remove",
    "start": "2342099",
    "end": "2348460"
  },
  {
    "text": "um you also have the ability to use um non-self believe it's pronounced and hash in order to say this is the hash of",
    "start": "2348460",
    "end": "2355900"
  },
  {
    "text": "this block of code here in order for it to and that's safe to run so rather than",
    "start": "2355900",
    "end": "2361480"
  },
  {
    "text": "allowing any old code you need to have this specific hash in order to run and that's for those sort of items that",
    "start": "2361480",
    "end": "2367599"
  },
  {
    "text": "you can't remove easily um so we're using a CSP prevent um xss",
    "start": "2367599",
    "end": "2374079"
  },
  {
    "text": "well it's very likely going to make an attacker's life much harder",
    "start": "2374079",
    "end": "2380020"
  },
  {
    "text": "however there's different ways of circumventing some of these things some very creative minds behind some of these",
    "start": "2380020",
    "end": "2386380"
  },
  {
    "text": "things first of all it's very easy to badly configure your CSP policies and",
    "start": "2386380",
    "end": "2393099"
  },
  {
    "text": "get this wrong you do have to test this um if you it's obviously not going to",
    "start": "2393099",
    "end": "2398380"
  },
  {
    "text": "protect you if you if you screw up that configuration now some Frameworks have also had kind",
    "start": "2398380",
    "end": "2404560"
  },
  {
    "text": "of some trap tours via vulnerable methods angular particular version of angular had this so they may also",
    "start": "2404560",
    "end": "2412000"
  },
  {
    "text": "provide a way for an attacker to circumvent some of these things I think one to watch out for though is",
    "start": "2412000",
    "end": "2418300"
  },
  {
    "text": "um callbacks particularly in third-party libraries now I want you to imagine a scenario where you've allowed say",
    "start": "2418300",
    "end": "2424260"
  },
  {
    "text": "JavaScript from google.com maybe you're using their their Maps API or something",
    "start": "2424260",
    "end": "2429640"
  },
  {
    "text": "some of these libraries will allow you to specify a callback function in the",
    "start": "2429640",
    "end": "2435579"
  },
  {
    "text": "reference that um even though you've got a CSP policy saying only run scripts from google.com",
    "start": "2435579",
    "end": "2441940"
  },
  {
    "text": "if they provide a callback mechanism that's allowed and an attacker could then potentially use that callback",
    "start": "2441940",
    "end": "2447940"
  },
  {
    "text": "equals to go and run their horrible script so there may be ways around some of these things",
    "start": "2447940",
    "end": "2454720"
  },
  {
    "text": "um also be careful with leaving old versions of libraries it's quite common in a large application maybe it's not",
    "start": "2454720",
    "end": "2462099"
  },
  {
    "text": "maintained that well for several versions of libraries Frameworks and so on do exist these could also provide",
    "start": "2462099",
    "end": "2468040"
  },
  {
    "text": "mechanisms for getting around some of this type of thing okay",
    "start": "2468040",
    "end": "2473560"
  },
  {
    "text": "um well we've changed the user's password we've logged in as them we've manipulated the web page and we've",
    "start": "2473560",
    "end": "2480760"
  },
  {
    "text": "popped up annoying JavaScript alert box but let's talk about remote code execution or rce",
    "start": "2480760",
    "end": "2487720"
  },
  {
    "text": "now xss can act as a bit of a stepping stone it enables us to potentially run stuff",
    "start": "2487720",
    "end": "2494140"
  },
  {
    "text": "in a higher privileged context so if we can trick say an admin user into",
    "start": "2494140",
    "end": "2500320"
  },
  {
    "text": "um uh running some xss on a page then this might give us access to things we",
    "start": "2500320",
    "end": "2506020"
  },
  {
    "text": "might not normally have now it's quite common for admin and reference management interfaces to not be",
    "start": "2506020",
    "end": "2512560"
  },
  {
    "text": "protected quite as well as that public stuff maybe we've got various methods for manipulating some of the data",
    "start": "2512560",
    "end": "2519339"
  },
  {
    "text": "uploading files and so on so there might be a lot more Access Fire if we get an",
    "start": "2519339",
    "end": "2524680"
  },
  {
    "text": "admin user to run something I'm I'm going to train xss with another",
    "start": "2524680",
    "end": "2531160"
  },
  {
    "text": "issue so I'm going to use xss to trigger this particular issue in order to run code on this machine",
    "start": "2531160",
    "end": "2538000"
  },
  {
    "text": "now I'm going to use there's an issue in a library called node serialize um I'm not picking on this Library",
    "start": "2538000",
    "end": "2545020"
  },
  {
    "text": "um maybe a little bit it is 80 years old so this is a very old library it's no",
    "start": "2545020",
    "end": "2550660"
  },
  {
    "text": "longer maintained it has known issues if you try and install this your project",
    "start": "2550660",
    "end": "2555720"
  },
  {
    "text": "npm will warn you this has a critical vulnerability alert alert do not you",
    "start": "2555720",
    "end": "2560859"
  },
  {
    "text": "know use this in your application so you'd have to be a little bit silly to make use of this so no serialize as you",
    "start": "2560859",
    "end": "2569020"
  },
  {
    "text": "might imagine it serializes Json data there is better ways to do this now I",
    "start": "2569020",
    "end": "2575380"
  },
  {
    "text": "don't recommend you use this but interestingly it also provides the ability to serialize functions on an",
    "start": "2575380",
    "end": "2581440"
  },
  {
    "text": "object and even better than that if these properties begin with the string",
    "start": "2581440",
    "end": "2586540"
  },
  {
    "text": "ND Funk it runs them and that should be running alarm bells for people at this",
    "start": "2586540",
    "end": "2592540"
  },
  {
    "text": "point we have a serialization library that if you give it a blob of Json that has a string ND function it that Library",
    "start": "2592540",
    "end": "2599920"
  },
  {
    "text": "will take what's in that property and run it I'm not sure why you would ever want to do that if you want to go and",
    "start": "2599920",
    "end": "2606940"
  },
  {
    "text": "have a look at their code yourself that's that's where it is as I said it's no longer used but I took",
    "start": "2606940",
    "end": "2614980"
  },
  {
    "text": "this screenshot on Sunday I don't know if you can see from there the weekly downloads there there was over 1300",
    "start": "2614980",
    "end": "2620260"
  },
  {
    "text": "people that downloaded this last week and I'm pretty sure they're not downloading my learned Security",
    "start": "2620260",
    "end": "2625780"
  },
  {
    "text": "application and this is consistent across many weeks like how many",
    "start": "2625780",
    "end": "2631540"
  },
  {
    "text": "applications out there are using this library at the moment it's eight years old npm warns you you should not be",
    "start": "2631540",
    "end": "2638560"
  },
  {
    "text": "using this particular library and it provides the ability by providing malformed Json to run code as I will",
    "start": "2638560",
    "end": "2645400"
  },
  {
    "text": "show you I find that a little bit scary um what are we going to pause here well when you're playing with this type of",
    "start": "2645400",
    "end": "2651819"
  },
  {
    "text": "thing it's a good idea to do more simple things first because if we immediately jump to creating a connection from the",
    "start": "2651819",
    "end": "2658839"
  },
  {
    "text": "remote machine back to us um then there may be other things in place such as firewalls other",
    "start": "2658839",
    "end": "2664900"
  },
  {
    "text": "protections we don't know whether that necessarily works so what I'm going to start off by doing is just getting this",
    "start": "2664900",
    "end": "2671859"
  },
  {
    "text": "to go and create a file I'm going to use the touch command there in order to",
    "start": "2671859",
    "end": "2677220"
  },
  {
    "text": "create a file called hello ndc.txt",
    "start": "2677220",
    "end": "2682119"
  },
  {
    "text": "so we'll come out of that and I'm going to go into my command prompt here",
    "start": "2682240",
    "end": "2687880"
  },
  {
    "text": "um let's go and remove that um there and just to show you that doesn't",
    "start": "2687880",
    "end": "2694839"
  },
  {
    "text": "exist um we're back there",
    "start": "2694839",
    "end": "2699838"
  },
  {
    "text": "now what I'm going to do here is I have a block of JavaScript it creates a um a",
    "start": "2700420",
    "end": "2706900"
  },
  {
    "text": "bit of Json with that uh property of ND funk I'll show you that",
    "start": "2706900",
    "end": "2714520"
  },
  {
    "text": "again in a minute we know this has got an exercise issue there",
    "start": "2714520",
    "end": "2720460"
  },
  {
    "text": "um in our form data we have a property called rce we've got this string and",
    "start": "2720460",
    "end": "2727420"
  },
  {
    "text": "then it's going to run whenever we pass in the command there in this example hello NDC dot text we'll go and submit",
    "start": "2727420",
    "end": "2735160"
  },
  {
    "text": "that and then if I've done that right when we go and look at that out again oh",
    "start": "2735160",
    "end": "2740200"
  },
  {
    "text": "we didn't get it there oh did I miss a tag",
    "start": "2740200",
    "end": "2746280"
  },
  {
    "text": "ah thank you I'm glad that I got you guys",
    "start": "2748000",
    "end": "2753099"
  },
  {
    "text": "checking we are",
    "start": "2753099",
    "end": "2757740"
  },
  {
    "text": "which is good because I was curious as to why that didn't work so uh hopefully we've done that and then sure enough",
    "start": "2760180",
    "end": "2765940"
  },
  {
    "text": "we've got our file created there we've supplied it some bad Jason um and um we we've now have the ability",
    "start": "2765940",
    "end": "2772960"
  },
  {
    "text": "to create a file on the machine here that's a little bit scary now if it was certain types of applications such as a",
    "start": "2772960",
    "end": "2779319"
  },
  {
    "text": "PHP application we could create what's called a web shell or we could create a",
    "start": "2779319",
    "end": "2785800"
  },
  {
    "text": "single PHP file which will execute operating system commands and connect",
    "start": "2785800",
    "end": "2791020"
  },
  {
    "text": "back to our machine um we're going to do that now so we're going to go back to",
    "start": "2791020",
    "end": "2797680"
  },
  {
    "text": "um our application here and um let's uh stop uh netcat and let's go",
    "start": "2797680",
    "end": "2804880"
  },
  {
    "text": "and just get rid of all the comments there",
    "start": "2804880",
    "end": "2810760"
  },
  {
    "text": "um so we've reset and",
    "start": "2810760",
    "end": "2815460"
  },
  {
    "text": "we're going to do something called a reverse shell what's a reverse shell um well we're all familiar with the shell",
    "start": "2815980",
    "end": "2821260"
  },
  {
    "text": "command line interface that bit over on the left there that",
    "start": "2821260",
    "end": "2826540"
  },
  {
    "text": "server there that's our victim machine if if you will and what we're going to do is we're going to tell that victim",
    "start": "2826540",
    "end": "2832540"
  },
  {
    "text": "machine to connect back to a port on our machine now the reason we do it that way",
    "start": "2832540",
    "end": "2839140"
  },
  {
    "text": "is generally there's less Protections in place that way like you'd have to be a",
    "start": "2839140",
    "end": "2844599"
  },
  {
    "text": "bit of an idiot to leave a web server with all the different ports exposed directly to the internet it does happen",
    "start": "2844599",
    "end": "2851520"
  },
  {
    "text": "but generally there's less restrictions from the Wim server back to back to us",
    "start": "2851520",
    "end": "2857260"
  },
  {
    "text": "so we're going to initiate a we're going to tell it to connect back to our machine and bind that traffic to a shell",
    "start": "2857260",
    "end": "2865300"
  },
  {
    "text": "on that machine there um and I'm going to connect to netcast",
    "start": "2865300",
    "end": "2871119"
  },
  {
    "text": "again um we used that earlier when we stole the cookies",
    "start": "2871119",
    "end": "2876460"
  },
  {
    "text": "um and I'm gonna take my code and rather than just touching a file",
    "start": "2876460",
    "end": "2885780"
  },
  {
    "text": "we'll take this and let's just refresh that",
    "start": "2887680",
    "end": "2894400"
  },
  {
    "text": "and we'll paste that in what does our reverse shelf look like well look it",
    "start": "2894400",
    "end": "2899800"
  },
  {
    "text": "does involve a bit of node code and I'll be honest it took me a couple of hours to get the comments and another comments",
    "start": "2899800",
    "end": "2905800"
  },
  {
    "text": "there quotation marks correctly and so that it didn't screw up the encoding when it was received but you can see",
    "start": "2905800",
    "end": "2912520"
  },
  {
    "text": "here we're using the net library and child process and we spawn processes of",
    "start": "2912520",
    "end": "2917800"
  },
  {
    "text": "stockits and so on I'll put it up later you can go through it and then we're going to connect back to our own machine",
    "start": "2917800",
    "end": "2923980"
  },
  {
    "text": "on put 9000. so we'll set up our netcat listener there and we'll go and submit",
    "start": "2923980",
    "end": "2931780"
  },
  {
    "text": "that and run it and then if everything works well you can see we've got connection received there in this",
    "start": "2931780",
    "end": "2938980"
  },
  {
    "text": "instance I'm running everything on my own machine um yes I guess I've pulled into my own machine here but the principles are the",
    "start": "2938980",
    "end": "2946240"
  },
  {
    "text": "same as if it was a remote machine so this isn't just um a a connection back this is this is",
    "start": "2946240",
    "end": "2952900"
  },
  {
    "text": "interactive here so I can could enter any command that I'd normally be able to enter we could go and I don't know wget",
    "start": "2952900",
    "end": "2961780"
  },
  {
    "text": "put all sorts of malicious stuff on there and it's from here an attacker might look at elevating their",
    "start": "2961780",
    "end": "2967660"
  },
  {
    "text": "permissions so hopefully you're not running your web application as root or a privileged account because then you",
    "start": "2967660",
    "end": "2974200"
  },
  {
    "text": "can have full access to do whatever the hell you like on this machine here",
    "start": "2974200",
    "end": "2979839"
  },
  {
    "text": "um an attacker would probably then look for various ways to elevate their permissions there's been a lot of issues",
    "start": "2979839",
    "end": "2987240"
  },
  {
    "text": "particularly you know sort of Linux World various things you can run which",
    "start": "2987240",
    "end": "2992800"
  },
  {
    "text": "will take a low privileged account and turn it into a higher privileged account",
    "start": "2992800",
    "end": "2998099"
  },
  {
    "text": "so and then it's kind of game over for that web server and as an attacker we",
    "start": "2998099",
    "end": "3004440"
  },
  {
    "text": "could be connecting to the database potentially reading passwords stealing databases whatever it is that they feel",
    "start": "3004440",
    "end": "3012300"
  },
  {
    "text": "like I'm doing um so that wouldn't have been possible though without",
    "start": "3012300",
    "end": "3018060"
  },
  {
    "text": "um xss yes we did use it with another vulnerability there um but that endpoint might have only",
    "start": "3018060",
    "end": "3023460"
  },
  {
    "text": "been abled um to be used by an admin or a privileged user so",
    "start": "3023460",
    "end": "3028619"
  },
  {
    "text": "um hopefully um that's demonstrated that xss can be you know a really serious uh",
    "start": "3028619",
    "end": "3034020"
  },
  {
    "text": "issue detecting xss is really hard like you",
    "start": "3034020",
    "end": "3041819"
  },
  {
    "text": "might think oh I'll just look for some Chevrons or script blocks um something like that in order to go",
    "start": "3041819",
    "end": "3047819"
  },
  {
    "text": "and prevent this well um it's really hard because there's so many different contexts and different",
    "start": "3047819",
    "end": "3053460"
  },
  {
    "text": "ways that you can run at xss it almost becomes a bit of a um somebody looking",
    "start": "3053460",
    "end": "3059579"
  },
  {
    "text": "at some of these things is kind of a tour of the weird edges of JavaScript um and web apis and there's some very",
    "start": "3059579",
    "end": "3066599"
  },
  {
    "text": "creative ways of running some of these things um probably some of the better known stuff we can use things like um unload",
    "start": "3066599",
    "end": "3073380"
  },
  {
    "text": "attributes or we can use on error we can deliberately trigger an error and who",
    "start": "3073380",
    "end": "3078960"
  },
  {
    "text": "want to get this stuff to fire we can use the JavaScript sort of pseudo protocol to get stuff to run",
    "start": "3078960",
    "end": "3085280"
  },
  {
    "text": "we can trick a user into running something um you a lot of the other things tend to",
    "start": "3085280",
    "end": "3090420"
  },
  {
    "text": "be blocked people know about them but say something like access key design for keyboard accessibility and so on if we",
    "start": "3090420",
    "end": "3096480"
  },
  {
    "text": "can trick a user into running that we can get them to run this xss",
    "start": "3096480",
    "end": "3101819"
  },
  {
    "text": "filtering out this stuff is really really hard so this listed up here is all the",
    "start": "3101819",
    "end": "3107760"
  },
  {
    "text": "different ways that you could do that sort of left Chevron there I've encountered those but there's a heap of",
    "start": "3107760",
    "end": "3114540"
  },
  {
    "text": "different ways so if you're just looking for the character depending on how the content is rendered the framework the",
    "start": "3114540",
    "end": "3120960"
  },
  {
    "text": "web server some of these things could end up getting rendered if you're looking for particular strings",
    "start": "3120960",
    "end": "3127800"
  },
  {
    "text": "there's various different ways you can evade them you know if you're not careful with the casein to do case",
    "start": "3127800",
    "end": "3133200"
  },
  {
    "text": "insensitive comparison people will get around some of their stuff that way they could add Extra Spaces in Brackets",
    "start": "3133200",
    "end": "3140599"
  },
  {
    "text": "a null character web servers particularly Linux ones tend not to like this don't close tags sometimes they'll",
    "start": "3140599",
    "end": "3147839"
  },
  {
    "text": "be code in place reading through tags JavaScript from caracode and put a load",
    "start": "3147839",
    "end": "3153960"
  },
  {
    "text": "of stuff together in order to hit some of these issues and then of course there's a hundred different encoding",
    "start": "3153960",
    "end": "3160460"
  },
  {
    "text": "mechanisms decimal hexoctal utf-7 there's probably a thousand different",
    "start": "3160460",
    "end": "3165900"
  },
  {
    "text": "ways of doing this and we talked about malformed tags on browsers earlier",
    "start": "3165900",
    "end": "3171839"
  },
  {
    "text": "now one reason I think people don't or aren't so familiar with some of these issues is that modern Frameworks do a",
    "start": "3171839",
    "end": "3178079"
  },
  {
    "text": "pretty good job of protecting you from some of these issues most of them have",
    "start": "3178079",
    "end": "3183540"
  },
  {
    "text": "some pretty sensible defaults and you kind of have to go off the bead and track in order to shoot yourself in the",
    "start": "3183540",
    "end": "3190680"
  },
  {
    "text": "foot people do though and we'll talk about that in a minute um react has the just beautifully named",
    "start": "3190680",
    "end": "3198660"
  },
  {
    "text": "method dangerously set in our HTML now react warns you you're about to do",
    "start": "3198660",
    "end": "3204480"
  },
  {
    "text": "something dumb there if you don't get that message from that and go why is this dangerous then",
    "start": "3204480",
    "end": "3211818"
  },
  {
    "text": "um I love how that's names though it is well named and look there is reasonable um scenarios where you may need to use",
    "start": "3211920",
    "end": "3218640"
  },
  {
    "text": "this type of thing where you can in control of the input and where you've already sanitized it",
    "start": "3218640",
    "end": "3224520"
  },
  {
    "text": "if you do find yourself looking at these things there are probably better ways to",
    "start": "3224520",
    "end": "3229740"
  },
  {
    "text": "do it um let's talk about um this with uh react and I'm going to",
    "start": "3229740",
    "end": "3237180"
  },
  {
    "text": "close that one down I have a very simple react application",
    "start": "3237180",
    "end": "3242300"
  },
  {
    "text": "it uses uh some different ways uh as far as npm",
    "start": "3242300",
    "end": "3249440"
  },
  {
    "text": "get that to start very simple react application I have a text box here when I change this text uh",
    "start": "3250260",
    "end": "3259740"
  },
  {
    "text": "you can see those other items update",
    "start": "3259740",
    "end": "3265079"
  },
  {
    "text": "um as we'd expect Now using default binding this will be the output you see if we use dangerously",
    "start": "3265079",
    "end": "3273240"
  },
  {
    "text": "set in our HTML then this is the output and I've also got this stuff bound to a",
    "start": "3273240",
    "end": "3280440"
  },
  {
    "text": "hyperlink there so you can see in the high ref value I'm just binding and that there I'm not a react person but I do",
    "start": "3280440",
    "end": "3289020"
  },
  {
    "text": "want to show you some examples here so our first example um if we go and put",
    "start": "3289020",
    "end": "3295440"
  },
  {
    "text": "in an iframe there and in the source we set that to JavaScript alert as you can",
    "start": "3295440",
    "end": "3301680"
  },
  {
    "text": "see we've got this box popping up here now the reason for that is is because I've used that dangerously set in a HTML",
    "start": "3301680",
    "end": "3308099"
  },
  {
    "text": "there I've told react I know what I'm doing don't encode this run it as I give",
    "start": "3308099",
    "end": "3313619"
  },
  {
    "text": "you and sure enough that xss issue ran there",
    "start": "3313619",
    "end": "3319980"
  },
  {
    "text": "um I needed to use a iframe rather than a script block because the Page's already loaded and if I just add that then it's not going to trigger that",
    "start": "3319980",
    "end": "3326700"
  },
  {
    "text": "there now at an interesting one with react however is",
    "start": "3326700",
    "end": "3332700"
  },
  {
    "text": "this JavaScript protocol one so if we go and do JavaScript",
    "start": "3332700",
    "end": "3337800"
  },
  {
    "text": "um alerts there when that's bound to the hyperlink one",
    "start": "3337800",
    "end": "3342859"
  },
  {
    "text": "react doesn't actually filter that one out and I I think that's not what a few",
    "start": "3342859",
    "end": "3348059"
  },
  {
    "text": "people would expect and granted it's not as serious as you know running it on the page but I suspect there's probably a",
    "start": "3348059",
    "end": "3353940"
  },
  {
    "text": "few applications binding stuff directly to that so do be careful with that one",
    "start": "3353940",
    "end": "3359460"
  },
  {
    "text": "on the whole day um I think react does a really good job of keeping you safe you",
    "start": "3359460",
    "end": "3364800"
  },
  {
    "text": "kind of have to go off track in order to get yourself into trouble if you find yourself doing things like dot in your",
    "start": "3364800",
    "end": "3371579"
  },
  {
    "text": "HTML um refs and um react office a few different trap",
    "start": "3371579",
    "end": "3376859"
  },
  {
    "text": "doors um be very very careful because react is no longer giving you some of the",
    "start": "3376859",
    "end": "3382380"
  },
  {
    "text": "protections it has by default so if you do find you're using those type of methods there's probably a better way to",
    "start": "3382380",
    "end": "3388140"
  },
  {
    "text": "do it",
    "start": "3388140",
    "end": "3390500"
  },
  {
    "text": "so in summary xss um hopefully I've persuaded you you can be really serious it's not just popping",
    "start": "3393839",
    "end": "3400380"
  },
  {
    "text": "up annoying alert boxes it could potentially lead to full compromise of",
    "start": "3400380",
    "end": "3405660"
  },
  {
    "text": "an application or machine it's highly prevalent this is still very much out there",
    "start": "3405660",
    "end": "3412319"
  },
  {
    "text": "use defense in depth um I make sure you encode your output consider sanitizing input from the user",
    "start": "3412319",
    "end": "3419400"
  },
  {
    "text": "use those secure cookie options and CSP policies most Frameworks now have sensible",
    "start": "3419400",
    "end": "3425220"
  },
  {
    "text": "defaults I had to deliberately disable some of the options and some of the libraries and Frameworks I was using",
    "start": "3425220",
    "end": "3430920"
  },
  {
    "text": "there to show some of those issues so for example the session management system by default um hit HTTP only is",
    "start": "3430920",
    "end": "3437640"
  },
  {
    "text": "set to True asp.net cool will do this type of thing as well there's a lot of sensible",
    "start": "3437640",
    "end": "3443460"
  },
  {
    "text": "defaults out there and you have to go and circumvent them to get impacted by them when you're putting",
    "start": "3443460",
    "end": "3450540"
  },
  {
    "text": "together your applications design them with security in mind from the start it's not just the job of your app Tech",
    "start": "3450540",
    "end": "3456720"
  },
  {
    "text": "Team if you're lucky enough to even have one in your organization um work with the other developers get",
    "start": "3456720",
    "end": "3462599"
  },
  {
    "text": "everyone together and look at all the potential ways that people might want to exploit these issues get business people",
    "start": "3462599",
    "end": "3469020"
  },
  {
    "text": "get their input as well it doesn't have to be just technical people someone might say well hey what if you could do",
    "start": "3469020",
    "end": "3476520"
  },
  {
    "text": "this and you may have found another issue in your application you hadn't considered",
    "start": "3476520",
    "end": "3483599"
  },
  {
    "text": "um in order to find some of these things um I think it's best to use a combination of automated code quality",
    "start": "3483599",
    "end": "3489359"
  },
  {
    "text": "tooling um things like um men's sneak",
    "start": "3489359",
    "end": "3494640"
  },
  {
    "text": "um these will do things like flag vulnerable libraries sometimes vulnerable code constructs you're not",
    "start": "3494640",
    "end": "3501240"
  },
  {
    "text": "going to catch everything however and there's various scanners out there where you can point it at a URL and it will",
    "start": "3501240",
    "end": "3507780"
  },
  {
    "text": "fire various payloads in an attempt to discover issues these worked kind of well in the past but if you think the",
    "start": "3507780",
    "end": "3515160"
  },
  {
    "text": "modern day spa application it's really hard to kind of spoiler this application",
    "start": "3515160",
    "end": "3521099"
  },
  {
    "text": "find all the endpoints they don't work so well with these type of effects so by",
    "start": "3521099",
    "end": "3527099"
  },
  {
    "text": "all means make use of automated tooling but it is going to require some element of manual review do check you've got",
    "start": "3527099",
    "end": "3533819"
  },
  {
    "text": "permission to do it please don't go out there and do this on the stuff you don't have Vision to but put all these things together and",
    "start": "3533819",
    "end": "3541200"
  },
  {
    "text": "hopefully you'll have a pretty secure application if you do want to learn more about this",
    "start": "3541200",
    "end": "3547140"
  },
  {
    "text": "I suggest you head over to something called the portswiger labs ports we're",
    "start": "3547140",
    "end": "3552359"
  },
  {
    "text": "going to produce a tool called burp it's a proxy designed with security in mind",
    "start": "3552359",
    "end": "3557839"
  },
  {
    "text": "you don't have to use it for security but it has a lot of features to do with security they offer a free version it's",
    "start": "3557839",
    "end": "3564839"
  },
  {
    "text": "a really really good tool it looks a bit clunky at first I think it's been in Java and it looks a bit ugly but it's a",
    "start": "3564839",
    "end": "3571859"
  },
  {
    "text": "really good application and there is a free version available it enables you to manipulate requests very easy encode",
    "start": "3571859",
    "end": "3578280"
  },
  {
    "text": "repeat stuff they have a really great set of labs that you can run through and they're all",
    "start": "3578280",
    "end": "3584040"
  },
  {
    "text": "free and there's probably about 25 different topics they cover from xss SQL",
    "start": "3584040",
    "end": "3589799"
  },
  {
    "text": "injection template injection there's a hundred different things and there's a few things that you're looking at you're",
    "start": "3589799",
    "end": "3595980"
  },
  {
    "text": "like I've never heard of that what even is that really great Learning Resource there there's also a book it's written a",
    "start": "3595980",
    "end": "3603240"
  },
  {
    "text": "while ago now 2011 the web application Hacker's handbook this is a bit of an eye-opener this book is still really",
    "start": "3603240",
    "end": "3609720"
  },
  {
    "text": "really relevant and you'll go oh my God I never thought of that um there it's it's quite a thick book",
    "start": "3609720",
    "end": "3615059"
  },
  {
    "text": "but um there's like a thousand different sort of attacks and it tells you if this is blocked do this and um it's a really",
    "start": "3615059",
    "end": "3622020"
  },
  {
    "text": "extensive deep guide of some of these issues",
    "start": "3622020",
    "end": "3627180"
  },
  {
    "text": "accentual xss um hopefully that's been a great way to go",
    "start": "3627180",
    "end": "3634440"
  },
  {
    "text": "and show you the seriousness of some of these issues please go and learn about security learn what the attackers are",
    "start": "3634440",
    "end": "3640140"
  },
  {
    "text": "going to do to your applications by learning this we can better defend our applications",
    "start": "3640140",
    "end": "3645180"
  },
  {
    "text": "thank you very much [Laughter]",
    "start": "3645180",
    "end": "3652319"
  },
  {
    "text": "has anyone got any questions um or might keep you in thanks from lunch",
    "start": "3652319",
    "end": "3658220"
  },
  {
    "text": "yes yes yeah there's a if you go to",
    "start": "3665240",
    "end": "3670859"
  },
  {
    "text": "um I think it's Scott Helm he has an entire blog article on this where someone creates a key logger using CSS",
    "start": "3670859",
    "end": "3678980"
  },
  {
    "text": "and it's pretty creative but basically it uses there's some properties of CSS",
    "start": "3678980",
    "end": "3684780"
  },
  {
    "text": "before and after and then you can use it to request different images and then you",
    "start": "3684780",
    "end": "3690000"
  },
  {
    "text": "can work out from those requests because the rule triggers someone types in a and then it gets a",
    "start": "3690000",
    "end": "3696000"
  },
  {
    "text": "different thing and I'm like well you know who even comes up with for that that stuff but there's check out um",
    "start": "3696000",
    "end": "3701940"
  },
  {
    "text": "Scott Helm's blog he's got a he's got a great blog article um on there",
    "start": "3701940",
    "end": "3707540"
  },
  {
    "text": "well if you do have another question please come see me afterwards otherwise enjoy the rest of the conference thank",
    "start": "3708900",
    "end": "3714480"
  },
  {
    "text": "you",
    "start": "3714480",
    "end": "3716599"
  }
]