[
  {
    "text": "hello everyone is this working is this working can't retail for some",
    "start": "4180",
    "end": "10220"
  },
  {
    "text": "reason okay great so welcome to my talk thank you very much for coming along you're a bit far away because she kind",
    "start": "10220",
    "end": "17420"
  },
  {
    "text": "of bit closer but they at the camera mount be too pleased with me so my name is Adam and I come from",
    "start": "17420",
    "end": "23960"
  },
  {
    "text": "Switzerland I was I was actually born and raised in the UK I don't have there any football fans here but sweet-ass",
    "start": "23960",
    "end": "30890"
  },
  {
    "text": "witsand played Denmark earlier this week and with six minutes to go switz and",
    "start": "30890",
    "end": "36530"
  },
  {
    "text": "with three nil up and I was getting really I was getting really excited is going to come here and gloat about it",
    "start": "36530",
    "end": "41720"
  },
  {
    "text": "but you guys then scored three goals and it finished 3-3 in six minutes is",
    "start": "41720",
    "end": "46910"
  },
  {
    "text": "incredible you know very frustrating for me but you know well done I guess there's probably a few Swedish people",
    "start": "46910",
    "end": "52670"
  },
  {
    "text": "here as well when I Sweden's just across the bridge there I'm actually watching the bridge right now that TV series it's really",
    "start": "52670",
    "end": "58730"
  },
  {
    "text": "good a lot of people actually think that I am Swedish because I use Swiss and Swedish interchangeably as if they mean",
    "start": "58730",
    "end": "65180"
  },
  {
    "text": "the same things do you guys get that problem as well I mean Swedish Swedish people here yeah so that is a thing I",
    "start": "65180",
    "end": "72579"
  },
  {
    "text": "work for a company called particular software and we are the makers of a product called then service bus has",
    "start": "72579",
    "end": "77810"
  },
  {
    "text": "anyone heard of any service buses here that's quite a few of you that's great so if you're not if you're not familiar",
    "start": "77810",
    "end": "83209"
  },
  {
    "text": "with in service bus that doesn't matter I'm going to show examples and then service bus just because it makes it",
    "start": "83209",
    "end": "88999"
  },
  {
    "text": "easy but if you even if you're not I'm not not dotnet developer don't worry either you know if you don't know",
    "start": "88999",
    "end": "94340"
  },
  {
    "text": "c-sharp don't worry it's gonna be fairly simple but I think it at least give you an idea of some of the infrastructure",
    "start": "94340",
    "end": "100399"
  },
  {
    "text": "that you might have to write if you're to implement some of the concepts I'm going to talk about now I'm going to",
    "start": "100399",
    "end": "106670"
  },
  {
    "text": "talk about I'm going to kind of mess with your minds a little bit and talk about a class of problems which not many people talk about and it's to do with",
    "start": "106670",
    "end": "113840"
  },
  {
    "text": "the runtime behavior of our code and now that's a strange thing to say because obviously we do think about the runtime",
    "start": "113840",
    "end": "120709"
  },
  {
    "text": "behavior of our code and just like random code but there's a certain class of problems which only really become",
    "start": "120709",
    "end": "126049"
  },
  {
    "text": "apparent when code is in production and running under scale and running with multiple users touching on the same data",
    "start": "126049",
    "end": "131299"
  },
  {
    "text": "and I'm going to home in on this specific problem of so there is this thing called the arrow",
    "start": "131299",
    "end": "137890"
  },
  {
    "text": "of time it was a term coined by a guy called Arthur Stanley Eddington and it",
    "start": "137890",
    "end": "143140"
  },
  {
    "text": "basically says that you know time runs in one direction you can't look forward you can only look back and I'm not gonna",
    "start": "143140",
    "end": "148360"
  },
  {
    "text": "try and refute that right the arrow of times the thing I'm not gonna try and bend physics but I am gonna kind of turn",
    "start": "148360",
    "end": "154440"
  },
  {
    "text": "the way we look at time upside down and kind of inverter and give you a different view of it now that may raise",
    "start": "154440",
    "end": "161740"
  },
  {
    "text": "a few questions I don't know if we'll have time for a Q&A in this session I've got a lot of material to cover but I'm around for the rest of the day so you",
    "start": "161740",
    "end": "167920"
  },
  {
    "text": "know tap me on the shoulder throw your most difficult questions at me you know those those are great conversations to",
    "start": "167920",
    "end": "173230"
  },
  {
    "text": "have now to give you some detail to give you some background rather I'm gonna",
    "start": "173230",
    "end": "178540"
  },
  {
    "text": "talk about multi-user systems right so this is actually the the UBS trading floor in Connecticut in Stanford and",
    "start": "178540",
    "end": "185140"
  },
  {
    "text": "I've actually worked on this trading floor I spent about two weeks on this trading floor I've all said it was pretty loud it was actually the biggest",
    "start": "185140",
    "end": "192160"
  },
  {
    "text": "trading floor in the world at the time and UBS very proud of it and the thing",
    "start": "192160",
    "end": "198100"
  },
  {
    "text": "is with multi-user systems with lots of people using the systems and touching each other's data we can get consistency",
    "start": "198100",
    "end": "203380"
  },
  {
    "text": "problems now you might think well okay if we're doing something like CQRS anyone heard of CQRS here",
    "start": "203380",
    "end": "209200"
  },
  {
    "text": "okay that's almost all of you so you know about things like event sourcing eventual consistency and that kind of",
    "start": "209200",
    "end": "215170"
  },
  {
    "text": "stuff but it turns out that even if you use kind of the old traditional kind of",
    "start": "215170",
    "end": "220239"
  },
  {
    "text": "safe technologies like sequel server or Oracle and even if you're right if you write your system in a completely",
    "start": "220239",
    "end": "226180"
  },
  {
    "text": "synchronous manner consistency problems can still occur now we tend to reach for",
    "start": "226180",
    "end": "231250"
  },
  {
    "text": "things like I'm optimistic concurrency I have optimistic concurrency yeah that's quite a few of you so you believe that this first one wins and last one wins",
    "start": "231250",
    "end": "238209"
  },
  {
    "text": "thing and we think well songs we know that that's how it's working and the users know that's how it works and we're gonna be okay but things can get a bit",
    "start": "238209",
    "end": "245110"
  },
  {
    "text": "more complicated than that so I'm gonna take a slightly simpler domain well in",
    "start": "245110",
    "end": "251290"
  },
  {
    "text": "terms of users anyways so I want you to put yourself in the in the the main of online retail so we're working for an",
    "start": "251290",
    "end": "258130"
  },
  {
    "text": "e-commerce company were selling things online and our business come to us with a new requirement and they say well you",
    "start": "258130",
    "end": "263800"
  },
  {
    "text": "know I was out playing golf today and I this great idea I said if",
    "start": "263800",
    "end": "268930"
  },
  {
    "text": "give users who spent a certain amount in a week a discount on their next order we're going to get a better retention",
    "start": "268930",
    "end": "274930"
  },
  {
    "text": "ratio right people are going to be more likely to come back and keep buying stuff on our website so you think okay",
    "start": "274930",
    "end": "281680"
  },
  {
    "text": "I'm gonna do this properly I'm gonna use DDD I'm gonna use som weenies micro-services TD I'm gonna tick all the",
    "start": "281680",
    "end": "287350"
  },
  {
    "text": "boxes anyone read about DDD here like anything about Eric Evans and Birnbaum Verne that's most of you so you know all",
    "start": "287350",
    "end": "293050"
  },
  {
    "text": "about aggregate routes and entities and consistency boundaries and things like",
    "start": "293050",
    "end": "298270"
  },
  {
    "text": "that so you might write some code like this and it's nice clean code you've got an",
    "start": "298270",
    "end": "304419"
  },
  {
    "text": "order class which you might call your aggregate route and they've got a submit method to submit the order and in here",
    "start": "304419",
    "end": "309970"
  },
  {
    "text": "you look through all the orders for the same customer right you match the",
    "start": "309970",
    "end": "315039"
  },
  {
    "text": "customer ID and where the order is in the last week right so the order",
    "start": "315039",
    "end": "320590"
  },
  {
    "text": "timestamp is greater than or equal to the current timestamp for the current order less seven days you add up the",
    "start": "320590",
    "end": "328870"
  },
  {
    "text": "total of the orders and if it's greater than or equal 100 you give a discount of 10% otherwise equals zero at discount",
    "start": "328870",
    "end": "335530"
  },
  {
    "text": "it's a fairly straightforward as I said you can in unit test this integration test it all great and it's nice clean",
    "start": "335530",
    "end": "341260"
  },
  {
    "text": "code and it goes into production then it works so what's so bad about this what's",
    "start": "341260",
    "end": "347139"
  },
  {
    "text": "wrong with this code well first of all I mean you are putting a bit more pressure on the database right because you're",
    "start": "347139",
    "end": "352659"
  },
  {
    "text": "doing a historical look up through the orders here but you know you've read about it NEETs are gonna help with that",
    "start": "352659",
    "end": "357849"
  },
  {
    "text": "so maybe you maybe just throw some more CPU at the box or maybe you place some indexes or maybe you create some and",
    "start": "357849",
    "end": "363340"
  },
  {
    "text": "eventually confuse and things like that and that tends to work okay but it's",
    "start": "363340",
    "end": "369370"
  },
  {
    "text": "more interesting when you think about what this customer actually means right we've got a customer ID here now that's",
    "start": "369370",
    "end": "376300"
  },
  {
    "text": "not necessarily just one user right this could be a corporate account and you can",
    "start": "376300",
    "end": "381490"
  },
  {
    "text": "do that with Amazon right you can create a corporate accounting say well whenever someone orders something from Amazon please use our corporate account so we",
    "start": "381490",
    "end": "387820"
  },
  {
    "text": "get a discount so what that means is potentially two users can come along at",
    "start": "387820",
    "end": "393340"
  },
  {
    "text": "the same time and click the order button at the same time right so now you've got two threads talking to the database",
    "start": "393340",
    "end": "400990"
  },
  {
    "text": "now let's say our current weekly total is 90 right and each of these orders is",
    "start": "400990",
    "end": "406690"
  },
  {
    "text": "10 both of these threads are going to go to the database and see ah our weekly",
    "start": "406690",
    "end": "412060"
  },
  {
    "text": "totals 90 they're both gonna give a zero discount because that's not greater than or equal to 100",
    "start": "412060",
    "end": "418169"
  },
  {
    "text": "the problem is that the person looking after this corporate account who pays the bill is going to look at the bill at",
    "start": "418169",
    "end": "424360"
  },
  {
    "text": "the end of the week we're only the month or wherever and they're going to say that's interesting we actually sent in",
    "start": "424360",
    "end": "430060"
  },
  {
    "text": "11 orders in that week for $10 each we should have got a discount alert on the 11th order right now come to you and say",
    "start": "430060",
    "end": "436840"
  },
  {
    "text": "yeah why didn't they get a discount you said we'd get a discount you kind of look at this and you say yeah you kind",
    "start": "436840",
    "end": "443380"
  },
  {
    "text": "of ordered too quickly you know if you just waited a few seconds before that",
    "start": "443380",
    "end": "449410"
  },
  {
    "text": "second order you would have got the discount so what do you mean wait a few seconds how do you expect us to do that",
    "start": "449410",
    "end": "455320"
  },
  {
    "text": "and so uh I don't know let's say when someone's gonna submit an order they shout around the office and say well",
    "start": "455320",
    "end": "461020"
  },
  {
    "text": "hang on I'm gonna submit an order no one do anything I submit the order wait a few seconds all right all clear you can",
    "start": "461020",
    "end": "466870"
  },
  {
    "text": "order as well now customer kind of look at you and say are you mad that's this is completely ridiculous I'm off to",
    "start": "466870",
    "end": "473860"
  },
  {
    "text": "Amazon bye-bye and has anyone heard that term death by Amazon right this is what",
    "start": "473860",
    "end": "479409"
  },
  {
    "text": "Amazon do they kill phones which don't operate in the best way anything okay",
    "start": "479409",
    "end": "485050"
  },
  {
    "text": "well hang on a minute I I know have been solve this we've got this magic thing called transactions I",
    "start": "485050",
    "end": "490090"
  },
  {
    "text": "said well if we wrap each of these in the transaction that's gonna solve our problems for us yeah yeah but no the",
    "start": "490090",
    "end": "497349"
  },
  {
    "text": "problem is that all the major database platforms are secret server oracle postgrads no arrest them their default",
    "start": "497349",
    "end": "504490"
  },
  {
    "text": "level of transaction isolation is to say that you can read stuff from tables in",
    "start": "504490",
    "end": "510159"
  },
  {
    "text": "your transaction and when you write back to the database I'm not going to check that that stuff has changed in the",
    "start": "510159",
    "end": "516099"
  },
  {
    "text": "meantime right so that means these two threads can go in check that check those",
    "start": "516099",
    "end": "523240"
  },
  {
    "text": "rows they can write stuff to the database song as their song as they're not writing the same row though the",
    "start": "523240",
    "end": "529839"
  },
  {
    "text": "transactions will succeed but the thing is that the problem is that level of isolation",
    "start": "529839",
    "end": "534880"
  },
  {
    "text": "it's a perfectly reasonable thing for the for the database to allow you to read data and for that to data to change",
    "start": "534880",
    "end": "540460"
  },
  {
    "text": "in the meantime while that transactions happening now there are ways around that right so you can have serializable",
    "start": "540460",
    "end": "546430"
  },
  {
    "text": "levels serializable transactional isolation levels and there are things like n hibernate which allowed to switch",
    "start": "546430",
    "end": "551740"
  },
  {
    "text": "software that on which will actually check to see if the rows that you read at the being of the transaction have",
    "start": "551740",
    "end": "556960"
  },
  {
    "text": "changed in the meantime a problem is if you switch that stuff on first of all",
    "start": "556960",
    "end": "562300"
  },
  {
    "text": "your performance goes to crap right so you can forget about Black Friday you'll struggle to service a rec on a regular",
    "start": "562300",
    "end": "568090"
  },
  {
    "text": "Monday and the second thing is even if you manage to sort the performance out you'll suddenly start getting loads of",
    "start": "568090",
    "end": "573370"
  },
  {
    "text": "errors in the logs right we'll get transactions failing because of consistency problems and because of clashes now at that point is kind of",
    "start": "573370",
    "end": "580900"
  },
  {
    "text": "girl crap you know turn that back off again but the thing is when those errors are actually giving you a hell of a lot",
    "start": "580900",
    "end": "586060"
  },
  {
    "text": "of feedback they're actually telling you that there are consistency problems in your system so we need to look for other",
    "start": "586060",
    "end": "593260"
  },
  {
    "text": "ways to solve these things and we've got things like another magic gold in the hammer the batch job right so we're",
    "start": "593260",
    "end": "599860"
  },
  {
    "text": "going to get rid of this two threaded problem and we're gonna write a batch job which kicks in once a day on a",
    "start": "599860",
    "end": "605350"
  },
  {
    "text": "single threads and it's going to do something like this it's going to loop through the customers for each customer",
    "start": "605350",
    "end": "612940"
  },
  {
    "text": "is going to look through the orders for that customer and again it's going to look for all the orders which which was",
    "start": "612940",
    "end": "620140"
  },
  {
    "text": "submitted in the last seven days it's gonna sum them up if it's greater than a hundred I'm gonna give that customer a",
    "start": "620140",
    "end": "626410"
  },
  {
    "text": "discount level of ten and if it's less I'm going to give them a zero right the",
    "start": "626410",
    "end": "631450"
  },
  {
    "text": "consistency problem has gone however another problems arisen what's the",
    "start": "631450",
    "end": "637030"
  },
  {
    "text": "problem with this when no longer penalizing people for clicking the button at the same time we're penalizing",
    "start": "637030",
    "end": "643570"
  },
  {
    "text": "them for clicking the button on the same day right use of one user goes in or",
    "start": "643570",
    "end": "649210"
  },
  {
    "text": "does something in the morning another user goes in the afternoon or does something else they don't get the discount on the second order because the",
    "start": "649210",
    "end": "655540"
  },
  {
    "text": "batch job hasn't run right run yet all right doesn't even have to be two users it can be the same user so you're",
    "start": "655540",
    "end": "661150"
  },
  {
    "text": "effectively saying to the customer yeah yeah if you want the discount just wait until tomorrow right don't order too",
    "start": "661150",
    "end": "667060"
  },
  {
    "text": "much stuff today or whether the recipe of stuff tomorrow we'll give you this scam right that's ridiculous",
    "start": "667060",
    "end": "672100"
  },
  {
    "text": "you've effectively taken a two or three second race condition and turned into a 24-hour race condition right our most",
    "start": "672100",
    "end": "679689"
  },
  {
    "text": "Amazon all right death my Amazon so that might have worked at some point in the maybe the early days of e-commerce you",
    "start": "679689",
    "end": "686050"
  },
  {
    "text": "know kind of like a daily daily discounted method but you know things don't tend to work that way now",
    "start": "686050",
    "end": "691059"
  },
  {
    "text": "our business is operating a much more fluent than dynamic white so that's a",
    "start": "691059",
    "end": "696730"
  },
  {
    "text": "business problem and now even if you find a business scenario in a future",
    "start": "696730",
    "end": "701740"
  },
  {
    "text": "we're running something once a day does make sense they tend to come with other problems so if we look at how we",
    "start": "701740",
    "end": "707800"
  },
  {
    "text": "actually write these things as I said we might have this nice kind of DDD nice kind of tested code in the middle which",
    "start": "707800",
    "end": "714009"
  },
  {
    "text": "encapsulates a database and there's all nicely service-oriented and uses micro-services and all the rest of it",
    "start": "714009",
    "end": "719189"
  },
  {
    "text": "but this kind of stuff tends to live on the outside of that right it tends to",
    "start": "719189",
    "end": "724629"
  },
  {
    "text": "kind of you know we didn't really design the domain to capture that in the first place and now we've got to do this kind",
    "start": "724629",
    "end": "730990"
  },
  {
    "text": "of historical lookup and you kind of tack it on on the side and you might use",
    "start": "730990",
    "end": "736329"
  },
  {
    "text": "the domain objects to actually talk to the data or you might just go straight to the database is a lot more efficient",
    "start": "736329",
    "end": "741910"
  },
  {
    "text": "and you just throw entity framework at it or something and you just talk to the database now if you're lucky you get to",
    "start": "741910",
    "end": "747910"
  },
  {
    "text": "do this in c-sharp okay or whatever language you're using for your domain but whatever you do don't let your DBA",
    "start": "747910",
    "end": "754720"
  },
  {
    "text": "see it thanks if a DBA sees this or say ah that's that thing that's kicking in",
    "start": "754720",
    "end": "760629"
  },
  {
    "text": "at 11 o'clock every night and slowing down our housekeeping processes you've written it in c-sharp that's ridiculous",
    "start": "760629",
    "end": "767350"
  },
  {
    "text": "I can do this much better in sequel all right a DBA rewrites your your your",
    "start": "767350",
    "end": "773350"
  },
  {
    "text": "batch job in sequel I don't even know if this is correct sequel I kind of copied a sample and just altered it a bit haven't done sequel for a long time and",
    "start": "773350",
    "end": "780300"
  },
  {
    "text": "not to sad about that but the thing is this thing then really does live kind of",
    "start": "780300",
    "end": "785740"
  },
  {
    "text": "outside your domain right it's going straight to the data and this is where you get problems where you make changes",
    "start": "785740",
    "end": "791379"
  },
  {
    "text": "to your domain and you break batch jobs and you know that's that kind of thing has happened to me a lot in the past and",
    "start": "791379",
    "end": "796709"
  },
  {
    "text": "the thing is that businesses have this annoying habit of coming up new requirements so they'll say we know",
    "start": "796709",
    "end": "803270"
  },
  {
    "text": "I was out jogging this morning I this great new idea and you know that batch job thing you did a couple of weeks ago",
    "start": "803270",
    "end": "808730"
  },
  {
    "text": "yeah we need another one of those right so all of a sudden other batch job appears and this is just this is just",
    "start": "808730",
    "end": "814010"
  },
  {
    "text": "random sequel I just copied and pasted it from somewhere doesn't really matter it's all ugly whatever it is so um and",
    "start": "814010",
    "end": "820790"
  },
  {
    "text": "then you know then they say Bernie and I was on holiday and I had this great idea by the pool and you know then another bachelor appears and another bachelor",
    "start": "820790",
    "end": "826850"
  },
  {
    "text": "peers and this yeah this has got adventureworks in it this is really",
    "start": "826850",
    "end": "831920"
  },
  {
    "text": "random so the problem is that this stuff starts to decline in significance right",
    "start": "831920",
    "end": "837380"
  },
  {
    "text": "it starts to kind of take a backseat and it's kind of this stuff around the outside this starts to become the",
    "start": "837380",
    "end": "843620"
  },
  {
    "text": "application right I see some people smiling I think you've seen this happen right I've seen this happen a lot right",
    "start": "843620",
    "end": "849260"
  },
  {
    "text": "and as anyway then if anyone's familiar with a Strangler pattern so there's a",
    "start": "849260",
    "end": "855110"
  },
  {
    "text": "pattern whereby if you have a really ugly piece of code you kind of put a nice code around the edges and you gradually take slices out of the old",
    "start": "855110",
    "end": "861950"
  },
  {
    "text": "code until you kind of strangle out of existence and it disappears this is a kind of reverse strangler pattern right",
    "start": "861950",
    "end": "868490"
  },
  {
    "text": "use nice code in middle it's getting strangled out of existence by this stuff around the outside you know what",
    "start": "868490",
    "end": "874460"
  },
  {
    "text": "sometimes happens is the DBA will sometimes write the initial version and then give it to you for maintenance",
    "start": "874460",
    "end": "881350"
  },
  {
    "text": "right this has happened to me as well and you know I'll tell what this stuff starts to take over your life it just",
    "start": "881350",
    "end": "886970"
  },
  {
    "text": "grows and grows and grows and you know I'm telling you this because I've been",
    "start": "886970",
    "end": "892040"
  },
  {
    "text": "the situation you know I've lain awake at night thinking about how to debug this tool at Prague and at some point",
    "start": "892040",
    "end": "898520"
  },
  {
    "text": "you really when did I stop being a developer and become a DBA you know and so it's a to the point where I actually",
    "start": "898520",
    "end": "903890"
  },
  {
    "text": "consider it's specializing and sequel server at one point because it's got so bad I cherished the day that I made the",
    "start": "903890",
    "end": "910040"
  },
  {
    "text": "decision not to and you realize that what you've ended up here is is kind of like big ball of mud oops big ball of",
    "start": "910040",
    "end": "916910"
  },
  {
    "text": "mud covered in store procedures you've got thousands of loans opportunities everywhere and you've ended up in a",
    "start": "916910",
    "end": "922100"
  },
  {
    "text": "horrible place and I've gotta tell you it's a horrible place to be in so what we need to do to avoid this happening is",
    "start": "922100",
    "end": "927529"
  },
  {
    "text": "we need a new model of thinking about time we need to rethink the era of time for a new perspective on it so here it",
    "start": "927529",
    "end": "934010"
  },
  {
    "text": "is right here our of time and we've seen that as time progresses we get orders coming in into",
    "start": "934010",
    "end": "940130"
  },
  {
    "text": "our website when a given order arrives right let's just take this one here what",
    "start": "940130",
    "end": "946670"
  },
  {
    "text": "do we do we look back through a week of history we sum the totals up and we find",
    "start": "946670",
    "end": "953060"
  },
  {
    "text": "out how much that is in order to work out how much discount to give now the",
    "start": "953060",
    "end": "959149"
  },
  {
    "text": "thing is that users will often come to you and they will actually word the requirement in these terms they'll say",
    "start": "959149",
    "end": "966850"
  },
  {
    "text": "right I want you when an order comes in to look back through the history take",
    "start": "966850",
    "end": "972350"
  },
  {
    "text": "all the orders sum up their totals if it's greater or equal than 100 give the customer 10% this guy think okay well",
    "start": "972350",
    "end": "978560"
  },
  {
    "text": "that's exactly what I've done right there I've been given this requirement I've coded it I've done exactly what's",
    "start": "978560",
    "end": "984649"
  },
  {
    "text": "been asked of me the thing is that I want to share a kind of a revelation",
    "start": "984649",
    "end": "990199"
  },
  {
    "text": "I've had over the past couple years is that users don't actually give you",
    "start": "990199",
    "end": "995420"
  },
  {
    "text": "requirements what they do is they take their knowledge of the existing system",
    "start": "995420",
    "end": "1001269"
  },
  {
    "text": "and within those constraints they give you a solution as a workaround for the",
    "start": "1001269",
    "end": "1007269"
  },
  {
    "text": "thing they're trying to achieve so users don't give you requirements they give",
    "start": "1007269",
    "end": "1012279"
  },
  {
    "text": "you workarounds now one of the challenges that we face as developers is to see past that we need to see past",
    "start": "1012279",
    "end": "1018130"
  },
  {
    "text": "that requirements to see what the actual requirements are now the actual comment",
    "start": "1018130",
    "end": "1023440"
  },
  {
    "text": "here is not to look back through history and there were some bla bla bla it's - based on how many orders the customers",
    "start": "1023440",
    "end": "1031058"
  },
  {
    "text": "made this week give them a discount right now that might seem like a subtle difference it's just so kind of a",
    "start": "1031059",
    "end": "1037058"
  },
  {
    "text": "wording difference but it's important because it's when it's worded in that way we don't immediately think okay we look back in time instead of looking",
    "start": "1037059",
    "end": "1044890"
  },
  {
    "text": "backwards in time we can look forwards in time right and now I'm not gonna kind of Bend the dour of time here I'm not",
    "start": "1044890",
    "end": "1051040"
  },
  {
    "text": "going to say you can foresee the future but what you can do is you can kind of fold the future into your code right now",
    "start": "1051040",
    "end": "1057690"
  },
  {
    "text": "so let's take another look at the era of time when an order comes in what's the",
    "start": "1057690",
    "end": "1062919"
  },
  {
    "text": "current weekly total right it's zero okay that's easy so why",
    "start": "1062919",
    "end": "1068400"
  },
  {
    "text": "not capture that in a variable call it the week total and then we based on that",
    "start": "1068400",
    "end": "1074520"
  },
  {
    "text": "we process the order we give them a zero discount because they've got with no water so far and for the next order that",
    "start": "1074520",
    "end": "1081180"
  },
  {
    "text": "comes in we need to take this order into account okay so we increment the week total by the order total now here's a",
    "start": "1081180",
    "end": "1089700"
  },
  {
    "text": "trick we need to throw that information into the future one week to say that in",
    "start": "1089700",
    "end": "1095280"
  },
  {
    "text": "one week we need to decrement the week total by that amount right that kind of",
    "start": "1095280",
    "end": "1100560"
  },
  {
    "text": "makes sense because that order total should be part of the week total for one week so we know we know we need to do",
    "start": "1100560",
    "end": "1106140"
  },
  {
    "text": "that in a week's time and we actually actually do that we actually decrement that total then when the next total over",
    "start": "1106140",
    "end": "1113070"
  },
  {
    "text": "next order comes in we do exactly the same thing we are we add that orders total to the week total and we throw a",
    "start": "1113070",
    "end": "1119190"
  },
  {
    "text": "message into the future to say in a week's time decrement the week total by that water total and they do exactly the",
    "start": "1119190",
    "end": "1125700"
  },
  {
    "text": "same thing when the next message comes in and so forth and so forth and so forth now when a given order arrives",
    "start": "1125700",
    "end": "1134240"
  },
  {
    "text": "what do we do do we look back through the history we don't have to anymore",
    "start": "1134240",
    "end": "1139830"
  },
  {
    "text": "right we just look at the week total if it's more than 100 we give a discount if it's not we give no discount so instead",
    "start": "1139830",
    "end": "1147600"
  },
  {
    "text": "of kind of fudging the number instead of taking these domain objects which were originally designed for something else",
    "start": "1147600",
    "end": "1152820"
  },
  {
    "text": "and kind of looking back through their history and doing an aggregation and kind of fudging the number together we folded the concept of a weekly total",
    "start": "1152820",
    "end": "1160680"
  },
  {
    "text": "into the domain itself right instead of doing a lookup we've kind of folded the history into our current state and we've",
    "start": "1160680",
    "end": "1168420"
  },
  {
    "text": "done it in comes in a consistent way because think about what we're doing in our batch job we were updating one row",
    "start": "1168420",
    "end": "1174570"
  },
  {
    "text": "right we were updating the customers discount level here we're updating one",
    "start": "1174570",
    "end": "1180270"
  },
  {
    "text": "row okay we're updating the week total for a customer right and databases are",
    "start": "1180270",
    "end": "1185970"
  },
  {
    "text": "very good at guaranteeing transactionality around the single row I'll come to that bit more in a second",
    "start": "1185970",
    "end": "1192450"
  },
  {
    "text": "so it's a kind of upside-down inverted kind of anti batch job but the thing is",
    "start": "1192450",
    "end": "1199080"
  },
  {
    "text": "we need a good way to program this right when he's a good way to program the arrow of time and things like HTTP",
    "start": "1199080",
    "end": "1206190"
  },
  {
    "text": "really bad at this right I don't know a way of sending an HTTP request and having it arrive in a week's time right",
    "start": "1206190",
    "end": "1212759"
  },
  {
    "text": "you can kind of I guess you can kind of fudge it using a system threading timer or something that would work until the",
    "start": "1212759",
    "end": "1221249"
  },
  {
    "text": "approaches crashes right because you start your process up and you've forgotten that you need to do this thing so we need another way to do this so we",
    "start": "1221249",
    "end": "1229259"
  },
  {
    "text": "can think about this kind of this arrow of time in the context of this customers they're kind of long sorry a kind of",
    "start": "1229259",
    "end": "1236549"
  },
  {
    "text": "long-running process right a long-running process really is something that has multiple triggers so an immense",
    "start": "1236549",
    "end": "1243389"
  },
  {
    "text": "and hold some kind of state so a standard process you kind of a trigger comes in to do something you do your work and you're done",
    "start": "1243389",
    "end": "1249059"
  },
  {
    "text": "long-running process you get one message you do some work you save some states you get another message you restore your",
    "start": "1249059",
    "end": "1254639"
  },
  {
    "text": "state do some work save your state again and at some point you might be finished right so there now example that might be",
    "start": "1254639",
    "end": "1260249"
  },
  {
    "text": "the custom like delete their account right and that point the customers gone you don't need to do discounting anymore",
    "start": "1260249",
    "end": "1265559"
  },
  {
    "text": "the process is finished and the way we abstract that and then service buses through is through something we call a",
    "start": "1265559",
    "end": "1270840"
  },
  {
    "text": "saga so a saga the term saga in this context was coined in the late 80s and",
    "start": "1270840",
    "end": "1277559"
  },
  {
    "text": "it was a reaction to the problem of enormous transactions you know typically",
    "start": "1277559",
    "end": "1283470"
  },
  {
    "text": "in mainframes and things like that it was soon realized that we need to break things down with smaller transactions to",
    "start": "1283470",
    "end": "1289259"
  },
  {
    "text": "make them scale better and the saga was designed as a pattern for well if transaction one succeeds transaction two",
    "start": "1289259",
    "end": "1296609"
  },
  {
    "text": "succeeds but transaction three fails we need to roll back the previous two transactions there's a kind of",
    "start": "1296609",
    "end": "1301769"
  },
  {
    "text": "compensating pattern the thing is that in the real world things don't tend to",
    "start": "1301769",
    "end": "1308669"
  },
  {
    "text": "really undo themselves right I often see when people talk about the saga pattern they use this example of booking a",
    "start": "1308669",
    "end": "1316200"
  },
  {
    "text": "holiday and they say okay you know you booked your flight you book your hotel and you go to book your car with a no",
    "start": "1316200",
    "end": "1322590"
  },
  {
    "text": "hurts and they're out of cars so then you call the whole thing off right holidays off we're not going right",
    "start": "1322590",
    "end": "1328909"
  },
  {
    "text": "yeah that's the ridiculous way to handle things right and you know if you if you",
    "start": "1328909",
    "end": "1334590"
  },
  {
    "text": "see people using this example you know please ask them not to because it's a really it's a really really poor example you look for another hire car company if",
    "start": "1334590",
    "end": "1342150"
  },
  {
    "text": "they're fall you look for other ways of getting to hotel you know taxi bus will train it really doesn't matter but the",
    "start": "1342150",
    "end": "1347400"
  },
  {
    "text": "point is in the real world business workflows a much richer than simply undoing things so an n service bus saga",
    "start": "1347400",
    "end": "1354480"
  },
  {
    "text": "is not really a kind of by-the-book saga but saga is a fairly accurate represent",
    "start": "1354480",
    "end": "1359909"
  },
  {
    "text": "to try and do just that we allow richer workflows through it so I'm going to",
    "start": "1359909",
    "end": "1365399"
  },
  {
    "text": "show you a bit of code now and let's see how we can use this to actually try and solve the problem that we're trying to",
    "start": "1365399",
    "end": "1371279"
  },
  {
    "text": "that we're trying to look at right now so I have a I have a beard and I like",
    "start": "1371279",
    "end": "1377070"
  },
  {
    "text": "craft beer but I'm gonna get really hipster now and use vs code for this and I hope this is gonna work so let me just",
    "start": "1377070",
    "end": "1386010"
  },
  {
    "text": "let me just I'm actually gonna get rid of this and rewrite it right because it's I want to show you how I want to",
    "start": "1386010",
    "end": "1391409"
  },
  {
    "text": "show you how you actually write this stuff so what I've got here is a couple",
    "start": "1391409",
    "end": "1396899"
  },
  {
    "text": "of message classes right so we've got a submit order message with a customer ID and a total and you know it's gonna have",
    "start": "1396899",
    "end": "1403620"
  },
  {
    "text": "some other stuff I'm not gonna worry about that for now and then we've got a process order message and that has a",
    "start": "1403620",
    "end": "1409350"
  },
  {
    "text": "discount on it so 10% or 0% and it will have some other stuff on it as well which we don't worry about right now now",
    "start": "1409350",
    "end": "1417390"
  },
  {
    "text": "to create a saga to solve this problem all we need to actually do is create a class right so I'm going to create a",
    "start": "1417390",
    "end": "1422789"
  },
  {
    "text": "class called this down ting I'm just",
    "start": "1422789",
    "end": "1428909"
  },
  {
    "text": "scroll it up and this is gonna be our saga class but what we need is we need",
    "start": "1428909",
    "end": "1435390"
  },
  {
    "text": "some kind of type to store the data right maybe this or some kind of state in this saga because that's what this is",
    "start": "1435390",
    "end": "1440730"
  },
  {
    "text": "fundamentally all about so I'm gonna create a nested class I know some people hate nested classes but I think it's",
    "start": "1440730",
    "end": "1448140"
  },
  {
    "text": "actually quite a nice way to say that you know this this class belongs to this saga and no one else should be",
    "start": "1448140",
    "end": "1453270"
  },
  {
    "text": "interested right it is private data to the saga so I'm gonna call that discounting data",
    "start": "1453270",
    "end": "1460440"
  },
  {
    "text": "and what I do is I inherit from something called contained saga data so you don't have to worry too much about",
    "start": "1460440",
    "end": "1465840"
  },
  {
    "text": "that I mean all it actually does is give us a an ID for the saga and the",
    "start": "1465840",
    "end": "1471120"
  },
  {
    "text": "originator who sent the original message you can use that for other stuff but it's not relevant right now and we need",
    "start": "1471120",
    "end": "1478110"
  },
  {
    "text": "to actually create some properties of salt to store our business data so this counting is done per customer right we",
    "start": "1478110",
    "end": "1484410"
  },
  {
    "text": "want to give discounts per customer so we're going I'm gonna pin the customer ID customer ID and we want to store our",
    "start": "1484410",
    "end": "1493590"
  },
  {
    "text": "weekly total okay so again I'm just gonna create a weekly total amazing I'm using a double you know you probably",
    "start": "1493590",
    "end": "1499170"
  },
  {
    "text": "won't you probably want to use a money type or something with proper accuracy but just for simplicity I'm going to use",
    "start": "1499170",
    "end": "1504870"
  },
  {
    "text": "a double so week total",
    "start": "1504870",
    "end": "1510530"
  },
  {
    "text": "okay and now what I can say to thee to the infrastructure is that while",
    "start": "1511690",
    "end": "1517269"
  },
  {
    "text": "discounting is a saga and its state is",
    "start": "1517269",
    "end": "1522909"
  },
  {
    "text": "stored in a type called discounting or discounting data and that gives us a",
    "start": "1522909",
    "end": "1529659"
  },
  {
    "text": "method to over ops no I don't want that that gives us a method to implement an",
    "start": "1529659",
    "end": "1536230"
  },
  {
    "text": "abstract method which is configure how to find saga I'm going to come to that in a minute the next thing we need to do",
    "start": "1536230",
    "end": "1543460"
  },
  {
    "text": "is ready to tell the infrastructure what kind of message starts this saga so what kind of messages are we interested in",
    "start": "1543460",
    "end": "1549190"
  },
  {
    "text": "and that is the submit order right so sorry so we actually need to say I am",
    "start": "1549190",
    "end": "1555840"
  },
  {
    "text": "started by I am started by messages of type submit order and that gives us",
    "start": "1555840",
    "end": "1564429"
  },
  {
    "text": "another method to implement which is to actually handle that message so the first thing we need to do here is made",
    "start": "1564429",
    "end": "1570610"
  },
  {
    "text": "to work out for this order how much discount do we give right so we can look at the we can look at the week total and",
    "start": "1570610",
    "end": "1579490"
  },
  {
    "text": "say if the week total is larger than or",
    "start": "1579490",
    "end": "1585129"
  },
  {
    "text": "equal to a hundred give a discount of ten other wise give a discount of zero",
    "start": "1585129",
    "end": "1590759"
  },
  {
    "text": "okay now we might have to do some other stuff in real life but now not one wants to",
    "start": "1590759",
    "end": "1597720"
  },
  {
    "text": "fundamentally works out a discount we can we can note we know we can actually process this order without discount so",
    "start": "1597720",
    "end": "1602910"
  },
  {
    "text": "we can say we can take this context object which is also passed into the method and we can say send a process or",
    "start": "1602910",
    "end": "1610530"
  },
  {
    "text": "the message with the discount of the discount we've calculated okay so we're",
    "start": "1610530",
    "end": "1617280"
  },
  {
    "text": "not quite finished yet because we need to take this order into account when the next submit order comes in right so we",
    "start": "1617280",
    "end": "1622890"
  },
  {
    "text": "need to add to our week total the total",
    "start": "1622890",
    "end": "1628260"
  },
  {
    "text": "of this order right now here comes the real trick now we need to throw that",
    "start": "1628260",
    "end": "1634440"
  },
  {
    "text": "information into the future so they in one week we need to decrement the week total by this order total all right",
    "start": "1634440",
    "end": "1640890"
  },
  {
    "text": "because they should only be pile of that total for a week so what we can do now is request a time out and we pass this",
    "start": "1640890",
    "end": "1650370"
  },
  {
    "text": "context objects into it again and let me say something like time span from days",
    "start": "1650370",
    "end": "1655770"
  },
  {
    "text": "oops from days 7 7 and we can just send the",
    "start": "1655770",
    "end": "1665040"
  },
  {
    "text": "same message back to ourselves again right that's that's usually sufficient now this is complaining because that has",
    "start": "1665040",
    "end": "1671070"
  },
  {
    "text": "to be a sink and now we get told that these have to be awaited",
    "start": "1671070",
    "end": "1676910"
  },
  {
    "text": "ok and now we're good now we actually need to handle that myth we actually need to handle that message in a week",
    "start": "1677270",
    "end": "1683250"
  },
  {
    "text": "from now ok so what we can sell what we can say now is that I handle time outs",
    "start": "1683250",
    "end": "1689900"
  },
  {
    "text": "also of type submit order that gives us another method to implement and we know",
    "start": "1689900",
    "end": "1695790"
  },
  {
    "text": "now that when this method runs seven days has passed ok this message will be",
    "start": "1695790",
    "end": "1700800"
  },
  {
    "text": "delivered to us in 7 days that's what the infrastructure does for us so at that point we know that we need to take",
    "start": "1700800",
    "end": "1706860"
  },
  {
    "text": "away the week total we need to cut take away it's called stateless time for one",
    "start": "1706860",
    "end": "1712650"
  },
  {
    "text": "reason or another we need to take away that total from the week total and we need to do of course something like",
    "start": "1712650",
    "end": "1718650"
  },
  {
    "text": "return tasks completed tasks who likes async/await anyone like",
    "start": "1718650",
    "end": "1724900"
  },
  {
    "text": "async/await any fans no not really I mean the worst thing about it is I",
    "start": "1724900",
    "end": "1729910"
  },
  {
    "text": "think async awake is great but I hate what it does to my code right and n service bus 5 was actually completely",
    "start": "1729910",
    "end": "1736570"
  },
  {
    "text": "synchronous and we made n service bus sync six async so we made the big transformation and we kind of thought",
    "start": "1736570",
    "end": "1743350"
  },
  {
    "text": "well you know do we really need to do this and we've got a guy called Daniel Marber who works for us and he's a kind",
    "start": "1743350",
    "end": "1749440"
  },
  {
    "text": "of async/await expert and he said yeah yeah I know we really need to do that we do need to do it and he was right",
    "start": "1749440",
    "end": "1755940"
  },
  {
    "text": "because all the underlying api's are async now and we've actually seen enormous throughput so I think if you",
    "start": "1755940",
    "end": "1762850"
  },
  {
    "text": "compare an service bus five or then serve bus 6 I think it was as a service bus that had like a 30-fold increase in",
    "start": "1762850",
    "end": "1769299"
  },
  {
    "text": "maximum throughput and RabbitMQ it like a seven or eight fold increasing throughput so the advantages are huge",
    "start": "1769299",
    "end": "1776140"
  },
  {
    "text": "but and it's just a bit of a shame what it does to our code and the last thing we need to do now is remember that I",
    "start": "1776140",
    "end": "1782679"
  },
  {
    "text": "said a saga that a discounting saga applies to a specific customer so we",
    "start": "1782679",
    "end": "1787809"
  },
  {
    "text": "need to tell the infrastructure that when a message of type submit' order",
    "start": "1787809",
    "end": "1794080"
  },
  {
    "text": "arrives we want to map the customer ID of that message to the sagas customer ID",
    "start": "1794080",
    "end": "1806470"
  },
  {
    "text": "and then we just drop that down a line okay so this is basically telling the",
    "start": "1806470",
    "end": "1811720"
  },
  {
    "text": "infrastructure well when you receive a submit order message if you find a saga with that same customer ID spin that up",
    "start": "1811720",
    "end": "1819190"
  },
  {
    "text": "restore the state and operate on that if you don't find one create a new saga right basically tells the infrastructure",
    "start": "1819190",
    "end": "1824740"
  },
  {
    "text": "how to how to write a where clause effectively now these are also really",
    "start": "1824740",
    "end": "1830590"
  },
  {
    "text": "good things to test right so I've actually got some tests already written here somewhere if I can find them we've",
    "start": "1830590",
    "end": "1837220"
  },
  {
    "text": "actually got a we've got a package called n service bus testing and I'm just going to go through this really",
    "start": "1837220",
    "end": "1842980"
  },
  {
    "text": "quickly but this gives you a testable message handle a context and what you",
    "start": "1842980",
    "end": "1848380"
  },
  {
    "text": "can do then is you can take say four orders you know one for 61 another 60 another for 10 another for 20 and you",
    "start": "1848380",
    "end": "1854210"
  },
  {
    "text": "pass them through the saga and test if this thing works correctly so they're really really good TDD targets if anyone",
    "start": "1854210",
    "end": "1860090"
  },
  {
    "text": "here is a fan of TDD and you can say well I'm gonna pass the first order",
    "start": "1860090",
    "end": "1866660"
  },
  {
    "text": "through and I'm gonna expect a a discount of zero using this testable contest you can you can see what",
    "start": "1866660",
    "end": "1872630"
  },
  {
    "text": "messages was sent from the Saga you can actually look at the sent messages and all this long statement here is doing is",
    "start": "1872630",
    "end": "1878690"
  },
  {
    "text": "taking out the last message which is a process or a message and looking at its",
    "start": "1878690",
    "end": "1884120"
  },
  {
    "text": "discount and just asserting that that is zero second-order our week total should",
    "start": "1884120",
    "end": "1890240"
  },
  {
    "text": "now be 6e so again we should only get a we should get a zero discount when the third order comes in we've now got a",
    "start": "1890240",
    "end": "1895550"
  },
  {
    "text": "total of a hundred twenty so we should get a 10% discount now here's a trick we",
    "start": "1895550",
    "end": "1901430"
  },
  {
    "text": "can pretend that a week has passed right and we can actually send all the one",
    "start": "1901430",
    "end": "1906650"
  },
  {
    "text": "into a discounting saga as time now right we're actually simulating time passing and this is really really good",
    "start": "1906650",
    "end": "1912710"
  },
  {
    "text": "it's a really good thing to do because you wouldn't want to kind of like integration test this you know come in",
    "start": "1912710",
    "end": "1918410"
  },
  {
    "text": "and click the button wait a week and see if it works that's what a long-running test so you can simulate that here by",
    "start": "1918410",
    "end": "1925040"
  },
  {
    "text": "simply just invoking the timeout and then you can handle the fourth order and you should see that your discounts come",
    "start": "1925040",
    "end": "1931490"
  },
  {
    "text": "back to zero and I'm gonna really stick my neck out and actually try and run this in vs code if I've coded things",
    "start": "1931490",
    "end": "1938660"
  },
  {
    "text": "correctly it should pass hey okay alright so TDD for the win okay",
    "start": "1938660",
    "end": "1947870"
  },
  {
    "text": "so let's have a look at how this actually works in the background you know that as I said the trick the trick is up is up here in this and where is it",
    "start": "1947870",
    "end": "1956030"
  },
  {
    "text": "in this request timeout method right that's the trick that's the that's the thing that allowed",
    "start": "1956030",
    "end": "1961190"
  },
  {
    "text": "us to do this so how does that actually work in the background so what we have",
    "start": "1961190",
    "end": "1967250"
  },
  {
    "text": "is we have a bus abstraction which basically abstract over a message queue and we have a persist through",
    "start": "1967250",
    "end": "1972620"
  },
  {
    "text": "abstraction whispers abstracts over a database and what we do is when a message arrives in the bus we dispatch",
    "start": "1972620",
    "end": "1978440"
  },
  {
    "text": "that into the saga so either will do its work or work on its state and save that down and it will request a time map now",
    "start": "1978440",
    "end": "1984980"
  },
  {
    "text": "at this point the bus does one of two things for some queueing systems we can",
    "start": "1984980",
    "end": "1990110"
  },
  {
    "text": "just say to the queuing system send me that message back in a week's time right they just support it natively other",
    "start": "1990110",
    "end": "1996710"
  },
  {
    "text": "queuing systems unfortunately don't support it so what we do is we persist that timeout and the database at the",
    "start": "1996710",
    "end": "2002170"
  },
  {
    "text": "same time as we persist the saga but then we have to poll that database to see when the time it becomes due and",
    "start": "2002170",
    "end": "2007450"
  },
  {
    "text": "we'd rather not do that if we have if we can avoid it so we always favor the native queue mechanism when we when it's",
    "start": "2007450",
    "end": "2014860"
  },
  {
    "text": "available now at the currently the only one which actually does that all for us",
    "start": "2014860",
    "end": "2020320"
  },
  {
    "text": "is as a service bus right so as a service bus despites it despite its name is just a queuing system but it can",
    "start": "2020320",
    "end": "2027070"
  },
  {
    "text": "actually do this native time-out thing for us we can just say you know give this give me this message back in a week",
    "start": "2027070",
    "end": "2032460"
  },
  {
    "text": "other queuing systems kind of supports it so amazon sqs for instance it does",
    "start": "2032460",
    "end": "2039460"
  },
  {
    "text": "support it but only up to 900 seconds so you can send a timeout of up to 15 minutes for them as and SQS and that's",
    "start": "2039460",
    "end": "2046510"
  },
  {
    "text": "fine if you say you want a 600 second timeout you just say to me you know give me it back in 600 seconds if you want a",
    "start": "2046510",
    "end": "2051730"
  },
  {
    "text": "bigger timeout like 2,800 seconds for instance things don't quote what don't quite work so well because you can only",
    "start": "2051730",
    "end": "2058330"
  },
  {
    "text": "put it on the queue 400 seconds but what you can do is you can put a a header on",
    "start": "2058330",
    "end": "2065740"
  },
  {
    "text": "the message to say well when we get this back in 900 seconds we've still got a remaining delay of 1900 seconds right so",
    "start": "2065740",
    "end": "2072908"
  },
  {
    "text": "we can put it back on the queue another 900 seconds and so well there's a thousand seconds left now we get that",
    "start": "2072909",
    "end": "2077990"
  },
  {
    "text": "back we'll put it back on the key for nine hundred there's 100 left now and then we can just put it into the queue for hundred seconds right so using that",
    "start": "2077990",
    "end": "2084440"
  },
  {
    "text": "we can actually simulate arbitrary delays in that Amazon sqs that's pretty straight forward it gets more",
    "start": "2084440",
    "end": "2090919"
  },
  {
    "text": "interesting without rabbitmq now RabbitMQ has this notion of time to live",
    "start": "2090919",
    "end": "2096618"
  },
  {
    "text": "so you can say for a specific queue in rabbitmq you can say messages I sent to",
    "start": "2096619",
    "end": "2102020"
  },
  {
    "text": "this queue just stay there for this amount of time right and you don't",
    "start": "2102020",
    "end": "2108109"
  },
  {
    "text": "subscribe to that queue you put an exchange on the end of it which is another rabbit concept you say when messages die from this queue they go to",
    "start": "2108109",
    "end": "2114859"
  },
  {
    "text": "this exchange and that exchange put some in the actual queue right so you can do the same thing again you can actually simulate delayed delivery and RabbitMQ",
    "start": "2114859",
    "end": "2121970"
  },
  {
    "text": "using this trickery and that works fine so you create a queue for 600 seconds",
    "start": "2121970",
    "end": "2127250"
  },
  {
    "text": "you put your messages there let's say you want the time I have 900 seconds we create another queue with the time deliver 900 seconds and so forth and so",
    "start": "2127250",
    "end": "2133970"
  },
  {
    "text": "forth so for each timeout you just need to create another queue for that that length of time now you can see where",
    "start": "2133970",
    "end": "2140539"
  },
  {
    "text": "that's going right the API looks like this I can write any number I like in",
    "start": "2140539",
    "end": "2145910"
  },
  {
    "text": "there or I can write from days or from months or from years I can put any kind of or if I'm really evil I could put",
    "start": "2145910",
    "end": "2152690"
  },
  {
    "text": "math Rand in there all right just send arbitrary you know random timeouts so it",
    "start": "2152690",
    "end": "2158660"
  },
  {
    "text": "may not happen very often but the problem here is the number of queues that NSF and service bus might create",
    "start": "2158660",
    "end": "2165289"
  },
  {
    "text": "for a system is potentially unbounded and the last thing we want is a customer getting on the phone saying why the hell",
    "start": "2165289",
    "end": "2170990"
  },
  {
    "text": "is n so is bus creating 10,000 queues in my rabbit broker so we need another way of doing it so let's take an easier",
    "start": "2170990",
    "end": "2177559"
  },
  {
    "text": "example right 42 seconds a nice small number to make things easy now the interesting thing about the number 42 is",
    "start": "2177559",
    "end": "2184369"
  },
  {
    "text": "that not only is it the answer to the ultimate question it is only the number",
    "start": "2184369",
    "end": "2189799"
  },
  {
    "text": "42 in a certain method of counting right which we know is decimal right or base",
    "start": "2189799",
    "end": "2195170"
  },
  {
    "text": "10 so in base 10 we won a 42 second delay now where software developers and",
    "start": "2195170",
    "end": "2202190"
  },
  {
    "text": "we know there's other ways of writing numbers right and wellness binary so we know that we can write 42 in base 10 seconds",
    "start": "2202190",
    "end": "2209060"
  },
  {
    "text": "as 100 and 1010 base two seconds right",
    "start": "2209060",
    "end": "2214609"
  },
  {
    "text": "or in binary so what if in RabbitMQ we",
    "start": "2214609",
    "end": "2219710"
  },
  {
    "text": "create a queue for 32 seconds a queue for 16 seconds",
    "start": "2219710",
    "end": "2224780"
  },
  {
    "text": "thank you for eight seconds for two and one so forth we can take our 42 base ten",
    "start": "2224780",
    "end": "2231710"
  },
  {
    "text": "and write it in binary next to those queues and using again some header",
    "start": "2231710",
    "end": "2237859"
  },
  {
    "text": "trickery we can write this value into the headers this one hundred one thousand and ten and we can say we can",
    "start": "2237859",
    "end": "2245450"
  },
  {
    "text": "put an exchange in front of each queue and say if there's a one in this position in the header put it into your",
    "start": "2245450",
    "end": "2251119"
  },
  {
    "text": "queue if there's a zero give it to the next exchange and using that trickery we",
    "start": "2251119",
    "end": "2257960"
  },
  {
    "text": "can put it through that queue not through that queue through the eight second queue not the four second queue",
    "start": "2257960",
    "end": "2264349"
  },
  {
    "text": "it's truly a two second queue and not the 1 second queue now you can see it's formed through 32 plus 8 plus 2 which is",
    "start": "2264349",
    "end": "2271130"
  },
  {
    "text": "42 so we can arbitrary simulate we can simulate arbitrary delays in RabbitMQ",
    "start": "2271130",
    "end": "2277700"
  },
  {
    "text": "using this method and we think that's pretty cool right I don't think anyone else has actually done this kind of",
    "start": "2277700",
    "end": "2283700"
  },
  {
    "text": "thing RabbitMQ I think it's something we we generally kind of invented ourselves and it works really well I'll tell you",
    "start": "2283700",
    "end": "2289310"
  },
  {
    "text": "what this translates into solving actual business problems right and there's",
    "start": "2289310",
    "end": "2294470"
  },
  {
    "text": "nothing more satisfying than taking something like binary logic right binary",
    "start": "2294470",
    "end": "2299540"
  },
  {
    "text": "numbering fundamental computer science thing and actually solving business problems with it right so it's a really",
    "start": "2299540",
    "end": "2306020"
  },
  {
    "text": "nice feeling now we've only got six queues here which gives us a maximum",
    "start": "2306020",
    "end": "2311270"
  },
  {
    "text": "possible delay of 63 seconds which isn't that useful so we actually create 28 queues right and that gives us a maximum",
    "start": "2311270",
    "end": "2317900"
  },
  {
    "text": "possible delay of two to the power of 28 or 268 million 435,000 for 50 seconds or",
    "start": "2317900",
    "end": "2324109"
  },
  {
    "text": "about eight and a half years now you might think well where did 28 come from that's a bit random and arbitrary well",
    "start": "2324109",
    "end": "2331780"
  },
  {
    "text": "most businesses don't tend to think about things and more in about a year so we could have got away with 25 probably",
    "start": "2331780",
    "end": "2338150"
  },
  {
    "text": "which we've given you more than a year but then we don't like odd numbers so 26 was a candidate and we thought well 26",
    "start": "2338150",
    "end": "2344150"
  },
  {
    "text": "we think is safe but to be really safe that's going order of magnitude bigger and we don't want 27 that sort so when",
    "start": "2344150",
    "end": "2349579"
  },
  {
    "text": "the 28 we were really tempted to go for",
    "start": "2349579",
    "end": "2354589"
  },
  {
    "text": "32 and because we like the number 32 but that would have given us a maximum delay of 136 years so you know as I'd loved I",
    "start": "2354589",
    "end": "2362930"
  },
  {
    "text": "love to see people using an service bus 136 years but I think it's probably slightly overkill if anyone really wants",
    "start": "2362930",
    "end": "2369499"
  },
  {
    "text": "more than eight and a half years we'll release a new version which create twenty-ninth queue yeah whatever so we've seen that you know we saw the",
    "start": "2369499",
    "end": "2378440"
  },
  {
    "text": "consistency problem with this kind of original backwards lookup method we replace it with this nice shiny saga but",
    "start": "2378440",
    "end": "2385009"
  },
  {
    "text": "they're still potentially the same consistency problem here right because two people can still go in and click the",
    "start": "2385009",
    "end": "2390259"
  },
  {
    "text": "button at the same time and two sagas can look at the week total at the same time so have we actually really solve",
    "start": "2390259",
    "end": "2396289"
  },
  {
    "text": "any of our problems here well as I said we're touching a single row here right",
    "start": "2396289",
    "end": "2401299"
  },
  {
    "text": "we're reading a single row and read and writing back to it and databases are really really good at guaranteeing",
    "start": "2401299",
    "end": "2407210"
  },
  {
    "text": "transactionality around a single rope and we can take advantage of that now the important thing is that when we",
    "start": "2407210",
    "end": "2414349"
  },
  {
    "text": "actually send let me just make this big again when we actually send this message here we don't actually send it at that",
    "start": "2414349",
    "end": "2419839"
  },
  {
    "text": "moment okay and service bus will buffer it in the background and only when the",
    "start": "2419839",
    "end": "2424999"
  },
  {
    "text": "saga state is persisted would it then send the message okay so bear that in mind we could take advantage of all of",
    "start": "2424999",
    "end": "2431390"
  },
  {
    "text": "this and say when two threads come in at the same time start the same saga type",
    "start": "2431390",
    "end": "2437380"
  },
  {
    "text": "they will look at the same they'll look at the same weekly total they're both though both c90 right they're both give",
    "start": "2437380",
    "end": "2443480"
  },
  {
    "text": "us zero at this count of zero then they'll try and persist their saga data to the database and they're in",
    "start": "2443480",
    "end": "2449749"
  },
  {
    "text": "transactions because it's trying to write to the same row one of them fails right and its message won't be sent",
    "start": "2449749",
    "end": "2455499"
  },
  {
    "text": "because the state hasn't been persisted that message then goes back to the queue that gets dispatched into the saga again",
    "start": "2455499",
    "end": "2462739"
  },
  {
    "text": "and this time things work because that saga is now using the state that that first thread persisted right so this",
    "start": "2462739",
    "end": "2469220"
  },
  {
    "text": "second thread is now actually seeing a hundred it's giving the discount so that's how we've solved that now HTTP doesn't offer",
    "start": "2469220",
    "end": "2476730"
  },
  {
    "text": "this right so if if anyone anyone who is not using a kind of message of an",
    "start": "2476730",
    "end": "2482369"
  },
  {
    "text": "architecture something like that when something fails who retries do you",
    "start": "2482369",
    "end": "2487559"
  },
  {
    "text": "really one retry when something fails yeah that's a few of your sums half of you and that works fine if you're using",
    "start": "2487559",
    "end": "2494220"
  },
  {
    "text": "some of that HTTP again until your process dies right you start the process up again your retries gone unless you",
    "start": "2494220",
    "end": "2501569"
  },
  {
    "text": "write it to disk right you can write it this but whatever you do I don't want anyone to go back and start writing HTTP",
    "start": "2501569",
    "end": "2507420"
  },
  {
    "text": "requests to disk right and then polling them to see what's happened and to see what they need to send ones to start the",
    "start": "2507420",
    "end": "2513180"
  },
  {
    "text": "process again because what you're doing then is basically writing a queue right don't write a queue just use a queue",
    "start": "2513180",
    "end": "2519809"
  },
  {
    "text": "okay you'll be better off for it so I think okay we're getting somewhere now",
    "start": "2519809",
    "end": "2525059"
  },
  {
    "text": "we've sold that consistency problems have got rid of erase conditions or have we really and if you look at what we try",
    "start": "2525059",
    "end": "2530430"
  },
  {
    "text": "and do when we actually ship the order to get this thing out of the door to the customer we might call a courier so",
    "start": "2530430",
    "end": "2536609"
  },
  {
    "text": "someone like DHL and then we wait and we wait and we wait and they're then turn",
    "start": "2536609",
    "end": "2543450"
  },
  {
    "text": "up how long do we wait how long should we wait for the edge hall to turn up well you might say a day right a day is",
    "start": "2543450",
    "end": "2550650"
  },
  {
    "text": "kind of reasonable and the business might say well look if their child don't turn up in a day call ups instead right",
    "start": "2550650",
    "end": "2556170"
  },
  {
    "text": "and now we can see we can already see how we can use the mechanisms I've described to you to build this right we",
    "start": "2556170",
    "end": "2561329"
  },
  {
    "text": "can send the message to the HL send ourselves a timeout in 24 hours if we hadn't received a message to say that",
    "start": "2561329",
    "end": "2567540"
  },
  {
    "text": "DHL shipped at that time and we get the time on 24 hours we call ups problem is",
    "start": "2567540",
    "end": "2575040"
  },
  {
    "text": "what happens if just as you're sending the message to UPS DHL come along pick up the package anything to sell hot damn",
    "start": "2575040",
    "end": "2582359"
  },
  {
    "text": "you know we've got back to the same problem you know I thought we got rid of race conditions we've got a race",
    "start": "2582359",
    "end": "2588089"
  },
  {
    "text": "condition again right and as developers we often tire selves and not trying to",
    "start": "2588089",
    "end": "2593970"
  },
  {
    "text": "fix these things right and we kind of we do kind of crazy things like well we kind of we kind of reserved the",
    "start": "2593970",
    "end": "2599549"
  },
  {
    "text": "transaction over here and then we kind of get confirmation they're going to do it and then we say okay and I don't do but you can never actually emanate the",
    "start": "2599549",
    "end": "2605670"
  },
  {
    "text": "race condition right you can't actually have a distributed transaction between DHL and UPS right try as hard as you",
    "start": "2605670",
    "end": "2613260"
  },
  {
    "text": "like you will not get that to work but the thing is this isn't actually a technical problem this is a business",
    "start": "2613260",
    "end": "2619350"
  },
  {
    "text": "problem because if you weren't using a computer to automate this if you are",
    "start": "2619350",
    "end": "2624420"
  },
  {
    "text": "doing this by say you know people manning phones and just calling people to get things done this kind of thing",
    "start": "2624420",
    "end": "2629700"
  },
  {
    "text": "could still happen so because it's a business problem you should speak to your business",
    "start": "2629700",
    "end": "2635040"
  },
  {
    "text": "stakeholders about it describe this problem to them and very often they might just say yeah that's not a problem",
    "start": "2635040",
    "end": "2641730"
  },
  {
    "text": "well sort out we'll get the HL to sign an SLA all",
    "start": "2641730",
    "end": "2648600"
  },
  {
    "text": "right we'll get the HL to say here's the deal well use use our preferred supplier if you forget if there's some kind of",
    "start": "2648600",
    "end": "2654750"
  },
  {
    "text": "discount but you must ship within 24 hours if you don't ship in 24 hours you",
    "start": "2654750",
    "end": "2660210"
  },
  {
    "text": "must not ship at all and if you do if you turn up after 24 hours and take that package that's on you you gotta pay us",
    "start": "2660210",
    "end": "2667410"
  },
  {
    "text": "for the cost of that product or you got to get it back or whatever right the race condition has actually disappeared because it never was a technical race",
    "start": "2667410",
    "end": "2673680"
  },
  {
    "text": "condition in the first place and then is that race conditions don't actually exist in business right or to put it a",
    "start": "2673680",
    "end": "2680340"
  },
  {
    "text": "bit put it better race conditions don't exist in successful businesses right successful businesses are the ones that",
    "start": "2680340",
    "end": "2686580"
  },
  {
    "text": "remove race conditions right that I mentioned death why Amazon so you think",
    "start": "2686580",
    "end": "2693330"
  },
  {
    "text": "okay well now we've really got somewhere so we don't really need batch jobs anymore or do we well you know there",
    "start": "2693330",
    "end": "2698970"
  },
  {
    "text": "were some situations where you think well no actually we really do need a batch job for this so does anyone work",
    "start": "2698970",
    "end": "2704370"
  },
  {
    "text": "with systems which produce some kind of reports anything like that yeah for few a few of you so reports are",
    "start": "2704370",
    "end": "2709920"
  },
  {
    "text": "interesting because the initial implementation you might say Oh we'll just write this code to produce a report",
    "start": "2709920",
    "end": "2716130"
  },
  {
    "text": "and user can just generate it whenever they want and then you realize that you know when they come in the morning and everyone runs these reports the system",
    "start": "2716130",
    "end": "2721830"
  },
  {
    "text": "performance just goes to crap right so I think okay well this isn't really gonna work for us and then you say these",
    "start": "2721830",
    "end": "2727530"
  },
  {
    "text": "Suites and say well how do you actually use these reports and I say well you know I just look up in the morning and I kind of decide what I have to do for the",
    "start": "2727530",
    "end": "2733680"
  },
  {
    "text": "day saying okay right I've got the solution to this but job right overnight batch job as soon as",
    "start": "2733680",
    "end": "2741210"
  },
  {
    "text": "people start going to bed in Copenhagen we're gonna gonna switch on the batch job we're gonna crate those reports overnight and that kind of works fine",
    "start": "2741210",
    "end": "2747960"
  },
  {
    "text": "but then as business grows you can become a victim of your own success you know your customer base grows wildly",
    "start": "2747960",
    "end": "2754349"
  },
  {
    "text": "your order base grows wildly and all of a sudden your batch job starts leaking into the morning and then people are",
    "start": "2754349",
    "end": "2760380"
  },
  {
    "text": "coming in the batch stops still running and it starts to taken to lunchtime and I've seen this happen I've actually seen",
    "start": "2760380",
    "end": "2765660"
  },
  {
    "text": "this happen but you know we can throw more resources at that we can buy more CPU buy more RAM but can get a DBAs on",
    "start": "2765660",
    "end": "2772380"
  },
  {
    "text": "it and create more indexes and speed things up and we can get things down to you know finishing in time before people arrive in the morning then your company",
    "start": "2772380",
    "end": "2779700"
  },
  {
    "text": "opens an office in Singapore and all of a sudden the night becomes much shorter because when people are going to bed and",
    "start": "2779700",
    "end": "2786750"
  },
  {
    "text": "Copenhagen it's only a couple of hours before they're going to get up in Singapore right see you your window is tightened even more then you open an",
    "start": "2786750",
    "end": "2794130"
  },
  {
    "text": "office in New York and an office in San Francisco and basically you have no night left right in contents of your",
    "start": "2794130",
    "end": "2799470"
  },
  {
    "text": "company there is no night in order to write to run your nightly batch job but",
    "start": "2799470",
    "end": "2804510"
  },
  {
    "text": "the thing about reports is you know they look at these things in the morning every day and they decide to do some things with them but what's really",
    "start": "2804510",
    "end": "2811650"
  },
  {
    "text": "interesting is when you look at how these reports are actually used what do you actually do with these reports what is it you look for on these reports and",
    "start": "2811650",
    "end": "2819119"
  },
  {
    "text": "then let's say well you know we're a bank and we we look for large transactions in high-risk countries",
    "start": "2819119",
    "end": "2826020"
  },
  {
    "text": "right and if I see three of those within five days on a particular account I kind",
    "start": "2826020",
    "end": "2831150"
  },
  {
    "text": "of know that I really need to take some action I temporarily lock the account I inform the customer you know this whole process kicks off and I taught my",
    "start": "2831150",
    "end": "2837540"
  },
  {
    "text": "manager on all the rest of it and that's really interesting because when the other's conversations you start to get a",
    "start": "2837540",
    "end": "2843270"
  },
  {
    "text": "ubiquitous language coming out you find out those that there's such a thing as a large transaction you find out there's such thing as a high-risk country and",
    "start": "2843270",
    "end": "2849810"
  },
  {
    "text": "you kind of model those things as business events and you can create a saga which does some kind of level of",
    "start": "2849810",
    "end": "2855270"
  },
  {
    "text": "automated pattern matching so again using those mechanisms mechanisms I've",
    "start": "2855270",
    "end": "2861569"
  },
  {
    "text": "described already you could listen to these events and you could say a high",
    "start": "2861569",
    "end": "2867480"
  },
  {
    "text": "risk large transaction in high risk on this account okay and you add it to your collection you send yourself a",
    "start": "2867480",
    "end": "2874830"
  },
  {
    "text": "message into the future in five days time to say remove it from the collection right and they you can see",
    "start": "2874830",
    "end": "2881340"
  },
  {
    "text": "again how you've got this sliding window this sliding five-day window of large",
    "start": "2881340",
    "end": "2886530"
  },
  {
    "text": "transactions in high-risk countries and if in that five-day window you get three of them added to your collection you no",
    "start": "2886530",
    "end": "2892440"
  },
  {
    "text": "need to do something right you can actually go ahead and you know inform the user send them an email you can even",
    "start": "2892440",
    "end": "2898470"
  },
  {
    "text": "go further than that you can even go and lock the account automatically you can even send an email to the customer and",
    "start": "2898470",
    "end": "2904350"
  },
  {
    "text": "you know what when managers see this kind of thing it's kind of mind-blowing because they'll say oh it's half past",
    "start": "2904350",
    "end": "2910830"
  },
  {
    "text": "four in the afternoon and you've just found a high-risk transaction you usually look at that report at half past",
    "start": "2910830",
    "end": "2916050"
  },
  {
    "text": "9:00 in the morning right so what have you been doing all day and say well no this is one that's just happened what do you mean it's just",
    "start": "2916050",
    "end": "2922230"
  },
  {
    "text": "happened how can it plus it just happened well the system told me hey you know that saga thing that developers",
    "start": "2922230",
    "end": "2928230"
  },
  {
    "text": "were talking about a couple of weeks ago well they they deployed all of that and now this just tells me it's kind of you",
    "start": "2928230",
    "end": "2933720"
  },
  {
    "text": "know mind blowing no and what it actually told the customer already what they didn't actually lock the account",
    "start": "2933720",
    "end": "2938790"
  },
  {
    "text": "already it's like oh my god you know where do I sign up for more all right",
    "start": "2938790",
    "end": "2943800"
  },
  {
    "text": "that's saga stuff we want more of that and you know this the thing is that this",
    "start": "2943800",
    "end": "2949620"
  },
  {
    "text": "actually translate to real business value I manage one of my managers actually looks a bit like this guy",
    "start": "2949620",
    "end": "2955290"
  },
  {
    "text": "funnily enough now this actually translates to actual business value right this is we're talking about money",
    "start": "2955290",
    "end": "2961500"
  },
  {
    "text": "here and have I got this these are Danish kroner right it's the right kroner would be a bit embarrassing if it",
    "start": "2961500",
    "end": "2967980"
  },
  {
    "text": "wasn't but actually know money doesn't look like that here anymore it looks",
    "start": "2967980",
    "end": "2974040"
  },
  {
    "text": "like that and that's our Danish money looks these days I actually made him start when I first came to Denmark I",
    "start": "2974040",
    "end": "2980430"
  },
  {
    "text": "took out some money at the airport and the ATM and I've still got it right five or five years later but",
    "start": "2980430",
    "end": "2987540"
  },
  {
    "text": "you're actually adding genuine genuine business value for your business here this is this is actual you know this is",
    "start": "2987540",
    "end": "2993780"
  },
  {
    "text": "a kind of area where you can turn on the IT department from a cost sender to a profit Center right you're actually adding genuine business value and it's",
    "start": "2993780",
    "end": "3000680"
  },
  {
    "text": "really rewarding now I've only really kind of scratched the surface here right so if you want to",
    "start": "3000680",
    "end": "3007790"
  },
  {
    "text": "go into this in a lot more detail our CEO guy named EDD Han is a founder of n",
    "start": "3007790",
    "end": "3013670"
  },
  {
    "text": "service bus he runs a five-day course on advanced distributed system design I highly",
    "start": "3013670",
    "end": "3019130"
  },
  {
    "text": "recommend that in person if possible but it is available to videos and I've put together a selection of those videos",
    "start": "3019130",
    "end": "3025490"
  },
  {
    "text": "around long-running processes so if you follow this you're this rather long URL I hope you can not to get in the way but",
    "start": "3025490",
    "end": "3032500"
  },
  {
    "text": "take a picture of that follow that URL you'll get a free video package talking about this in more detail I'll leave",
    "start": "3032500",
    "end": "3039050"
  },
  {
    "text": "that up there for next couple of slides and I hope I've given you a different perspective of thinking about this",
    "start": "3039050",
    "end": "3045950"
  },
  {
    "text": "certain class of problems specifically about time and another way to do things and you know you it's often it often",
    "start": "3045950",
    "end": "3052339"
  },
  {
    "text": "feels like something like a batch job is the only way out but a particular",
    "start": "3052339",
    "end": "3057800"
  },
  {
    "text": "software one of our missions is cut is to kill the batch job right we actually release the brach a blog post a couple",
    "start": "3057800",
    "end": "3063740"
  },
  {
    "text": "of years ago a couple of years ago called s2 the batch job so you can find out on their website and you know it's",
    "start": "3063740",
    "end": "3069680"
  },
  {
    "text": "something that we believe can be removed using this techniques using this different perspective and looking at this tight look at the hour of time in",
    "start": "3069680",
    "end": "3076220"
  },
  {
    "text": "the kind of reverse to how we normally look at it so I hope that's been helpful",
    "start": "3076220",
    "end": "3081260"
  },
  {
    "text": "I guess I do have a little bit more time for questions anyone got any questions on a throw at me right now before I wrap",
    "start": "3081260",
    "end": "3087920"
  },
  {
    "text": "up yeah have I encountered any pitfalls",
    "start": "3087920",
    "end": "3093740"
  },
  {
    "text": "or drawbacks for the saga pan that's a good question so one of the one of the",
    "start": "3093740",
    "end": "3100670"
  },
  {
    "text": "things that users of often get themselves into is this trap of trying",
    "start": "3100670",
    "end": "3107300"
  },
  {
    "text": "to query the saga data okay so we get a lot of requests saying you know how do I actually create a saga data because I",
    "start": "3107300",
    "end": "3114020"
  },
  {
    "text": "want to know about the status of the process I want to know where we are in this process what the customers can't",
    "start": "3114020",
    "end": "3119900"
  },
  {
    "text": "totally is and you know what how many customers have you got with different little different levels of discounting",
    "start": "3119900",
    "end": "3125060"
  },
  {
    "text": "all the rest of it and we often find that people actually go and implement that I start actually reading the saga",
    "start": "3125060",
    "end": "3131420"
  },
  {
    "text": "data a problem with that is so that the",
    "start": "3131420",
    "end": "3137030"
  },
  {
    "text": "reason that sagas are such good test targets I destroy them in TDD terms is",
    "start": "3137030",
    "end": "3142220"
  },
  {
    "text": "that they're very very strong encapsulations right it is when when when as any one",
    "start": "3142220",
    "end": "3149660"
  },
  {
    "text": "written by Alan Kay who kind of wrote the initial initial stuff about object",
    "start": "3149660",
    "end": "3155480"
  },
  {
    "text": "orientation and he didn't really talk about things like polymorphism and inheritance he talked about messages",
    "start": "3155480",
    "end": "3161900"
  },
  {
    "text": "coming in private data and messages",
    "start": "3161900",
    "end": "3167119"
  },
  {
    "text": "coming out right so that's what really what an object was encapsulated private data and operations on that data now I",
    "start": "3167119",
    "end": "3174320"
  },
  {
    "text": "often say that sagas are kind of object orientation done rights okay and it's",
    "start": "3174320",
    "end": "3180380"
  },
  {
    "text": "because there's such strong encapsulations now the pitfall there is that when you start going behind the",
    "start": "3180380",
    "end": "3186260"
  },
  {
    "text": "sagas back and going into the database you break that encapsulation so it's a it's a very common problem",
    "start": "3186260",
    "end": "3192920"
  },
  {
    "text": "I've seen now the thing is that will you get you can you can you can get around this in other ways you can raise events",
    "start": "3192920",
    "end": "3198109"
  },
  {
    "text": "from your saga and then you can do normalize them into views right kind of like analysts see qrs's fashion right",
    "start": "3198109",
    "end": "3204020"
  },
  {
    "text": "you can do that but we get this we get this requirement so many times we get",
    "start": "3204020",
    "end": "3209150"
  },
  {
    "text": "customers asking for this so many times you know how do I curry the saga data that we're looking into some way to actually provide that as a first-class",
    "start": "3209150",
    "end": "3215990"
  },
  {
    "text": "part of the infrastructure but you know until that exists until we thought about how best to achieve that that's one very",
    "start": "3215990",
    "end": "3223880"
  },
  {
    "text": "common pitfall live scenes that people break the encapsulation and all of a sudden there when this bind where they can't change",
    "start": "3223880",
    "end": "3229619"
  },
  {
    "text": "anything anymore because it's almost like you've got batch jobs looking in from the outside",
    "start": "3229619",
    "end": "3234930"
  },
  {
    "text": "because you're breaking past the encapsulation it's that more let's answer your question okay so I'm going",
    "start": "3234930",
    "end": "3242789"
  },
  {
    "text": "to wrap up there and I hope you've enjoyed that I've hope that's gonna be useful I hope that gives you a nice different perspective and nice different",
    "start": "3242789",
    "end": "3248940"
  },
  {
    "text": "way to think about these classes of problems I've really enjoyed talking to you and I'll be around for the rest of",
    "start": "3248940",
    "end": "3255720"
  },
  {
    "text": "the day are safe you want more quick if you want to ask me some more nice tough questions and enjoy the rest of the day",
    "start": "3255720",
    "end": "3261839"
  },
  {
    "text": "and thank you very much [Applause]",
    "start": "3261839",
    "end": "3272020"
  }
]