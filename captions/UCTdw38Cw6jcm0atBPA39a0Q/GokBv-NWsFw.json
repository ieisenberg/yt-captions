[
  {
    "start": "0",
    "end": "37000"
  },
  {
    "text": "hi I'm Park risky",
    "start": "9889",
    "end": "12000"
  },
  {
    "text": "I'm coming for",
    "start": "12000",
    "end": "13850"
  },
  {
    "text": "in Poland I will tell you more about",
    "start": "13850",
    "end": "15380"
  },
  {
    "text": "myself on Friday slighting speech so",
    "start": "15380",
    "end": "18170"
  },
  {
    "text": "let's begin I will tell you about a web",
    "start": "18170",
    "end": "20870"
  },
  {
    "text": "service that we hosted on publicly",
    "start": "20870",
    "end": "23480"
  },
  {
    "text": "available cloud and one night it came",
    "start": "23480",
    "end": "27560"
  },
  {
    "text": "down and it did not restart in expected",
    "start": "27560",
    "end": "31280"
  },
  {
    "text": "time and then we launched an",
    "start": "31280",
    "end": "33770"
  },
  {
    "text": "investigation to learn what happened it",
    "start": "33770",
    "end": "37670"
  },
  {
    "start": "37000",
    "end": "91000"
  },
  {
    "text": "was pretty simple application it was",
    "start": "37670",
    "end": "39440"
  },
  {
    "text": "just a java application that was",
    "start": "39440",
    "end": "41629"
  },
  {
    "text": "exposing a couple of api's it was",
    "start": "41629",
    "end": "44510"
  },
  {
    "text": "sitting on the cloud behind the load",
    "start": "44510",
    "end": "46400"
  },
  {
    "text": "blaster what one answer was just",
    "start": "46400",
    "end": "48519"
  },
  {
    "text": "providing a way to spread the HTTP",
    "start": "48519",
    "end": "52430"
  },
  {
    "text": "requests that were coming to a couple of",
    "start": "52430",
    "end": "54530"
  },
  {
    "text": "instances of the same application and",
    "start": "54530",
    "end": "56300"
  },
  {
    "text": "totally simply could investigate were",
    "start": "56300",
    "end": "59269"
  },
  {
    "text": "two types of logs one was the",
    "start": "59269",
    "end": "61370"
  },
  {
    "text": "application level log it also included",
    "start": "61370",
    "end": "64850"
  },
  {
    "text": "some reports from jetty because that's",
    "start": "64850",
    "end": "68000"
  },
  {
    "text": "what our application was using and we",
    "start": "68000",
    "end": "70729"
  },
  {
    "text": "had also the access log from the load",
    "start": "70729",
    "end": "73250"
  },
  {
    "text": "blaster and that was all and what we",
    "start": "73250",
    "end": "77540"
  },
  {
    "text": "found is that our application logs were",
    "start": "77540",
    "end": "80060"
  },
  {
    "text": "crappy enough to give us no information",
    "start": "80060",
    "end": "82640"
  },
  {
    "text": "at all about what could happened so we",
    "start": "82640",
    "end": "87500"
  },
  {
    "text": "tried to find out what was happening in",
    "start": "87500",
    "end": "89539"
  },
  {
    "text": "access logs so what we could do let's",
    "start": "89539",
    "end": "93740"
  },
  {
    "start": "91000",
    "end": "519000"
  },
  {
    "text": "take a look at how these access logs",
    "start": "93740",
    "end": "95840"
  },
  {
    "text": "typically look like so here you can see",
    "start": "95840",
    "end": "99680"
  },
  {
    "text": "that every line represent a single HTTP",
    "start": "99680",
    "end": "102859"
  },
  {
    "text": "request that was coming to our service",
    "start": "102859",
    "end": "105939"
  },
  {
    "text": "and what we could do we could try to",
    "start": "105939",
    "end": "108979"
  },
  {
    "text": "write some reg expression we could try",
    "start": "108979",
    "end": "113179"
  },
  {
    "text": "to use some magic tricks on the command",
    "start": "113179",
    "end": "115399"
  },
  {
    "text": "line but we decided to give a try to our",
    "start": "115399",
    "end": "118490"
  },
  {
    "text": "beloved excel and a special feature",
    "start": "118490",
    "end": "120740"
  },
  {
    "text": "called pivot tables so I hope I have a",
    "start": "120740",
    "end": "124579"
  },
  {
    "text": "couple of she's here prepared but let's",
    "start": "124579",
    "end": "127969"
  },
  {
    "text": "hope the demo gods will be kind enough",
    "start": "127969",
    "end": "129649"
  },
  {
    "text": "that it will work live so what is a",
    "start": "129649",
    "end": "133130"
  },
  {
    "text": "pivot table let's just not talk about",
    "start": "133130",
    "end": "136130"
  },
  {
    "text": "this as just create one please keep your",
    "start": "136130",
    "end": "138620"
  },
  {
    "text": "fingers crossed",
    "start": "138620",
    "end": "139840"
  },
  {
    "text": "okay so what data will arise we'll just",
    "start": "139840",
    "end": "143960"
  },
  {
    "text": "use all the data that",
    "start": "143960",
    "end": "147050"
  },
  {
    "text": "brought from the logs fortunately",
    "start": "147050",
    "end": "149930"
  },
  {
    "text": "currently Excel can hold up to million",
    "start": "149930",
    "end": "152930"
  },
  {
    "text": "records so even the live data can fit in",
    "start": "152930",
    "end": "156070"
  },
  {
    "text": "ok and here is the result almost so what",
    "start": "156070",
    "end": "161060"
  },
  {
    "text": "kind of data we can analyze for example",
    "start": "161060",
    "end": "163880"
  },
  {
    "text": "we can take a look at what type of",
    "start": "163880",
    "end": "165710"
  },
  {
    "text": "requests hit our application so not",
    "start": "165710",
    "end": "168590"
  },
  {
    "text": "surprisingly we found that there are",
    "start": "168590",
    "end": "171260"
  },
  {
    "text": "HTTP and HTTPS requests we can also find",
    "start": "171260",
    "end": "174740"
  },
  {
    "text": "for example how many of them were there",
    "start": "174740",
    "end": "177160"
  },
  {
    "text": "and instead of clicking on the command",
    "start": "177160",
    "end": "179780"
  },
  {
    "text": "line or counting them manually we can",
    "start": "179780",
    "end": "182210"
  },
  {
    "text": "just do it with a click but that's just",
    "start": "182210",
    "end": "185630"
  },
  {
    "text": "the beginning investigation let's try to",
    "start": "185630",
    "end": "187910"
  },
  {
    "text": "find something more interesting so what",
    "start": "187910",
    "end": "191690"
  },
  {
    "text": "was the actual status codes that they",
    "start": "191690",
    "end": "194630"
  },
  {
    "text": "were being returned by our application",
    "start": "194630",
    "end": "198020"
  },
  {
    "text": "and we can see that we had a number of",
    "start": "198020",
    "end": "200780"
  },
  {
    "text": "200 response codes so that's ok but what",
    "start": "200780",
    "end": "205970"
  },
  {
    "text": "is most interesting is those other",
    "start": "205970",
    "end": "208910"
  },
  {
    "text": "numbers so for all 4 that's the response",
    "start": "208910",
    "end": "213200"
  },
  {
    "text": "code that means not found so that's",
    "start": "213200",
    "end": "215870"
  },
  {
    "text": "typically what would we expect if our",
    "start": "215870",
    "end": "218930"
  },
  {
    "text": "web services are being scanned by some",
    "start": "218930",
    "end": "222140"
  },
  {
    "text": "software which is trying to find known",
    "start": "222140",
    "end": "223940"
  },
  {
    "text": "vulnerabilities and if such a P is not",
    "start": "223940",
    "end": "227510"
  },
  {
    "text": "exposed then our application should",
    "start": "227510",
    "end": "230090"
  },
  {
    "text": "return 404 what most interesting is that",
    "start": "230090",
    "end": "233510"
  },
  {
    "text": "what happened in different places and",
    "start": "233510",
    "end": "236360"
  },
  {
    "text": "what caught our attention is this 408 so",
    "start": "236360",
    "end": "241190"
  },
  {
    "text": "let's try to filter it out and let's",
    "start": "241190",
    "end": "243680"
  },
  {
    "text": "focus our attention today on 408 and why",
    "start": "243680",
    "end": "247790"
  },
  {
    "text": "for a white yeah let's just read that's",
    "start": "247790",
    "end": "251959"
  },
  {
    "text": "it's the request timeout what does it",
    "start": "251959",
    "end": "254209"
  },
  {
    "text": "mean it means that the client requested",
    "start": "254209",
    "end": "256850"
  },
  {
    "text": "some information from the server but",
    "start": "256850",
    "end": "258980"
  },
  {
    "text": "servers spend so much time processing",
    "start": "258980",
    "end": "260989"
  },
  {
    "text": "that that the client did not get the",
    "start": "260989",
    "end": "264800"
  },
  {
    "text": "response in particular time so what it",
    "start": "264800",
    "end": "269000"
  },
  {
    "text": "means it means that we paid for our",
    "start": "269000",
    "end": "271640"
  },
  {
    "text": "cloud providers for processing data but",
    "start": "271640",
    "end": "273980"
  },
  {
    "text": "our client did not receive it so",
    "start": "273980",
    "end": "276020"
  },
  {
    "text": "probably some money are leaking and",
    "start": "276020",
    "end": "278300"
  },
  {
    "text": "probably something went wrong in the",
    "start": "278300",
    "end": "280580"
  },
  {
    "text": "optic",
    "start": "280580",
    "end": "280879"
  },
  {
    "text": "maybe that was the cause of the",
    "start": "280879",
    "end": "283419"
  },
  {
    "text": "application falling down okay but the",
    "start": "283419",
    "end": "288379"
  },
  {
    "text": "number of such errors is not enough for",
    "start": "288379",
    "end": "291020"
  },
  {
    "text": "us so let's try to find out what were",
    "start": "291020",
    "end": "294349"
  },
  {
    "text": "the actual requests that were sent there",
    "start": "294349",
    "end": "298479"
  },
  {
    "text": "we can see there is a treat types of",
    "start": "298479",
    "end": "303469"
  },
  {
    "text": "requests really one just some scanner",
    "start": "303469",
    "end": "307459"
  },
  {
    "text": "was looking for coordinator of port type",
    "start": "307459",
    "end": "309709"
  },
  {
    "text": "11 if we google that it means that",
    "start": "309709",
    "end": "312849"
  },
  {
    "text": "somebody was looking for a known for a",
    "start": "312849",
    "end": "315139"
  },
  {
    "text": "BT in in one of the web servers and this",
    "start": "315139",
    "end": "321139"
  },
  {
    "text": "is known for a BT but definitely",
    "start": "321139",
    "end": "323839"
  },
  {
    "text": "something not what we were trying to",
    "start": "323839",
    "end": "325819"
  },
  {
    "text": "exposed so the question is why",
    "start": "325819",
    "end": "328789"
  },
  {
    "text": "for such unknown endpoint we returned",
    "start": "328789",
    "end": "332059"
  },
  {
    "text": "408 but before we draw you into the",
    "start": "332059",
    "end": "335300"
  },
  {
    "text": "details we can also take a look what was",
    "start": "335300",
    "end": "339139"
  },
  {
    "text": "who was scanning us so if we add what",
    "start": "339139",
    "end": "344629"
  },
  {
    "text": "was the IP of the request coming we can",
    "start": "344629",
    "end": "346339"
  },
  {
    "text": "see that it's a single IP if it's a",
    "start": "346339",
    "end": "349309"
  },
  {
    "text": "single IP it's probably not the botnet",
    "start": "349309",
    "end": "351529"
  },
  {
    "text": "that was trying to find us but something",
    "start": "351529",
    "end": "355009"
  },
  {
    "text": "else so again we can switch to our",
    "start": "355009",
    "end": "358099"
  },
  {
    "text": "beloved Internet there are a couple of",
    "start": "358099",
    "end": "360379"
  },
  {
    "text": "tools that there are sites that provides",
    "start": "360379",
    "end": "363979"
  },
  {
    "text": "the reverse DNS so in such tool we can",
    "start": "363979",
    "end": "367039"
  },
  {
    "text": "put IP and you can find out that there",
    "start": "367039",
    "end": "370159"
  },
  {
    "text": "is a rapid7",
    "start": "370159",
    "end": "370999"
  },
  {
    "text": "who knows who is the rapid7 right who",
    "start": "370999",
    "end": "375499"
  },
  {
    "text": "knows what is Metasploit okay ok",
    "start": "375499",
    "end": "380449"
  },
  {
    "text": "Metasploit is a framework well-known for",
    "start": "380449",
    "end": "383959"
  },
  {
    "text": "people who try to hack because in this",
    "start": "383959",
    "end": "385759"
  },
  {
    "text": "framework all the vulnerabilities that",
    "start": "385759",
    "end": "387499"
  },
  {
    "text": "are pretty known and have publicly",
    "start": "387499",
    "end": "390469"
  },
  {
    "text": "available tools you can find them in",
    "start": "390469",
    "end": "392599"
  },
  {
    "text": "this framework but this company also",
    "start": "392599",
    "end": "395629"
  },
  {
    "text": "offers such services like scanning the",
    "start": "395629",
    "end": "398779"
  },
  {
    "text": "public networks and one of these",
    "start": "398779",
    "end": "401300"
  },
  {
    "text": "scanners were hitting us with",
    "start": "401300",
    "end": "402529"
  },
  {
    "text": "non-verbally but we instead of replying",
    "start": "402529",
    "end": "405529"
  },
  {
    "text": "them now",
    "start": "405529",
    "end": "406519"
  },
  {
    "text": "this endpoint is not found we started to",
    "start": "406519",
    "end": "409219"
  },
  {
    "text": "apply them 408 mm we are thinking to",
    "start": "409219",
    "end": "412279"
  },
  {
    "text": "process your request so",
    "start": "412279",
    "end": "414710"
  },
  {
    "text": "and we are really not we do not have",
    "start": "414710",
    "end": "417860"
  },
  {
    "text": "this type of end pointer so let's try to",
    "start": "417860",
    "end": "422150"
  },
  {
    "text": "find out what more information we can",
    "start": "422150",
    "end": "424610"
  },
  {
    "text": "find about such requests so again we can",
    "start": "424610",
    "end": "429710"
  },
  {
    "text": "use the inbuilt features of Excel and",
    "start": "429710",
    "end": "432770"
  },
  {
    "text": "let's try to find out what where other",
    "start": "432770",
    "end": "435740"
  },
  {
    "text": "requests so if we take a look here you",
    "start": "435740",
    "end": "442720"
  },
  {
    "text": "can see that there were a number of",
    "start": "445120",
    "end": "447139"
  },
  {
    "text": "requests for some of them we even",
    "start": "447139",
    "end": "450320"
  },
  {
    "text": "returned proper response code 404 but",
    "start": "450320",
    "end": "455150"
  },
  {
    "text": "for Sam we returned 408 and this column",
    "start": "455150",
    "end": "458360"
  },
  {
    "text": "represents the size of the requests that",
    "start": "458360",
    "end": "460370"
  },
  {
    "text": "were coming and we can see that for the",
    "start": "460370",
    "end": "462590"
  },
  {
    "text": "short one",
    "start": "462590",
    "end": "463310"
  },
  {
    "text": "we returned 408 but for the longer one",
    "start": "463310",
    "end": "467259"
  },
  {
    "text": "we returned 404 so you can see also a",
    "start": "467259",
    "end": "471590"
  },
  {
    "text": "couple of requests that are tagged with",
    "start": "471590",
    "end": "475900"
  },
  {
    "text": "special user agent and these were my",
    "start": "475900",
    "end": "479090"
  },
  {
    "text": "feeble requests to reproduce the error",
    "start": "479090",
    "end": "481090"
  },
  {
    "text": "but as you can see here they all",
    "start": "481090",
    "end": "484340"
  },
  {
    "text": "returned in resulted in 404 so not",
    "start": "484340",
    "end": "488270"
  },
  {
    "text": "something that rapid7 achieved with our",
    "start": "488270",
    "end": "491330"
  },
  {
    "text": "application so what we could do further",
    "start": "491330",
    "end": "497380"
  },
  {
    "text": "we could try to guess what is the actual",
    "start": "497380",
    "end": "501409"
  },
  {
    "text": "request coming because there is no more",
    "start": "501409",
    "end": "503060"
  },
  {
    "text": "in access log we couldn't see just a",
    "start": "503060",
    "end": "505159"
  },
  {
    "text": "couple of information about HTTP",
    "start": "505159",
    "end": "506659"
  },
  {
    "text": "requests but not about the actual full",
    "start": "506659",
    "end": "510259"
  },
  {
    "text": "request that was hitting us and",
    "start": "510259",
    "end": "511849"
  },
  {
    "text": "definitely it was something else that I",
    "start": "511849",
    "end": "514130"
  },
  {
    "text": "fought it so it could be so I couldn't",
    "start": "514130",
    "end": "516500"
  },
  {
    "text": "reproduce it so what we tried next we",
    "start": "516500",
    "end": "521209"
  },
  {
    "text": "tried next a couple of inbuilt features",
    "start": "521209",
    "end": "524029"
  },
  {
    "text": "of the cloud providers this is a couple",
    "start": "524029",
    "end": "526730"
  },
  {
    "text": "of AWS features but similar ones are",
    "start": "526730",
    "end": "529430"
  },
  {
    "text": "provided for on other cloud providers",
    "start": "529430",
    "end": "531310"
  },
  {
    "text": "and we tried vbc flow logs those",
    "start": "531310",
    "end": "534860"
  },
  {
    "text": "represented just network connection so",
    "start": "534860",
    "end": "537920"
  },
  {
    "text": "they did not provide us HTTP level of",
    "start": "537920",
    "end": "540170"
  },
  {
    "text": "details as you've seen we tried access",
    "start": "540170",
    "end": "542990"
  },
  {
    "text": "logs we also turn on AWS Web Application",
    "start": "542990",
    "end": "546920"
  },
  {
    "text": "Firewall",
    "start": "546920",
    "end": "548280"
  },
  {
    "text": "and they have samples request which did",
    "start": "548280",
    "end": "550530"
  },
  {
    "text": "not contain full request but we hope",
    "start": "550530",
    "end": "552810"
  },
  {
    "text": "this full logs should achieve something",
    "start": "552810",
    "end": "555840"
  },
  {
    "text": "for us and present us full information",
    "start": "555840",
    "end": "558150"
  },
  {
    "text": "what unfortunately we were fooled by",
    "start": "558150",
    "end": "560250"
  },
  {
    "text": "this advertisement and they present it",
    "start": "560250",
    "end": "562920"
  },
  {
    "text": "as the full request headers but not the",
    "start": "562920",
    "end": "566130"
  },
  {
    "text": "body and we also try to use AWS lamda",
    "start": "566130",
    "end": "570300"
  },
  {
    "text": "but unfortunately in such a simple",
    "start": "570300",
    "end": "572430"
  },
  {
    "text": "infrastructure that we had in cloud",
    "start": "572430",
    "end": "574260"
  },
  {
    "text": "there was no point where we could attach",
    "start": "574260",
    "end": "576960"
  },
  {
    "text": "this AWS lamda what we ended up with we",
    "start": "576960",
    "end": "581910"
  },
  {
    "text": "contacted to rapid7",
    "start": "581910",
    "end": "583080"
  },
  {
    "text": "we found out that one of the scanners",
    "start": "583080",
    "end": "585390"
  },
  {
    "text": "was broken and this way we fix their",
    "start": "585390",
    "end": "588690"
  },
  {
    "text": "scanners and we stopped getting for all",
    "start": "588690",
    "end": "591660"
  },
  {
    "text": "eight results on our application but",
    "start": "591660",
    "end": "594360"
  },
  {
    "text": "also what we find out that all of this",
    "start": "594360",
    "end": "597570"
  },
  {
    "text": "information was processed by our java",
    "start": "597570",
    "end": "599820"
  },
  {
    "text": "application not by load balancer it",
    "start": "599820",
    "end": "602130"
  },
  {
    "text": "meant that we as a company we paid for",
    "start": "602130",
    "end": "604710"
  },
  {
    "text": "this ec2 for processing those requests",
    "start": "604710",
    "end": "607290"
  },
  {
    "text": "which were not really needed so we",
    "start": "607290",
    "end": "609210"
  },
  {
    "text": "implemented whitelisting before the",
    "start": "609210",
    "end": "611850"
  },
  {
    "text": "request hits our application and this",
    "start": "611850",
    "end": "614460"
  },
  {
    "text": "way",
    "start": "614460",
    "end": "614910"
  },
  {
    "text": "we relied not on our own Java code to",
    "start": "614910",
    "end": "619290"
  },
  {
    "text": "filter out the required components but",
    "start": "619290",
    "end": "623160"
  },
  {
    "text": "we rely right now on cloud provider",
    "start": "623160",
    "end": "627230"
  },
  {
    "text": "parsing and whitelisting why it's better",
    "start": "627230",
    "end": "630210"
  },
  {
    "text": "because our code we develop it in very",
    "start": "630210",
    "end": "633930"
  },
  {
    "text": "good quality but not very often deployed",
    "start": "633930",
    "end": "636060"
  },
  {
    "text": "and AWS deploys them much more",
    "start": "636060",
    "end": "638820"
  },
  {
    "text": "efficiently because that's what the",
    "start": "638820",
    "end": "640710"
  },
  {
    "text": "business depends on so a couple of",
    "start": "640710",
    "end": "644670"
  },
  {
    "start": "643000",
    "end": "709000"
  },
  {
    "text": "takeaway points first log all the",
    "start": "644670",
    "end": "647790"
  },
  {
    "text": "information you need or you think you",
    "start": "647790",
    "end": "650310"
  },
  {
    "text": "can because it is not known when you're",
    "start": "650310",
    "end": "652950"
  },
  {
    "text": "really gonna need them if you write then",
    "start": "652950",
    "end": "656760"
  },
  {
    "text": "please allocate some time to actually",
    "start": "656760",
    "end": "658830"
  },
  {
    "text": "read what this logs say and don't be",
    "start": "658830",
    "end": "663150"
  },
  {
    "text": "scared of such funny features of Excel",
    "start": "663150",
    "end": "665460"
  },
  {
    "text": "like pivot tables they can really save a",
    "start": "665460",
    "end": "668520"
  },
  {
    "text": "lot of time and don't be scared about",
    "start": "668520",
    "end": "672480"
  },
  {
    "text": "all these malicious web scanners that",
    "start": "672480",
    "end": "674730"
  },
  {
    "text": "are hitting our servers with stupid",
    "start": "674730",
    "end": "676740"
  },
  {
    "text": "requests fine looking for stupid IPS",
    "start": "676740",
    "end": "679170"
  },
  {
    "text": "which we do not expose because sometimes",
    "start": "679170",
    "end": "681510"
  },
  {
    "text": "they can",
    "start": "681510",
    "end": "682030"
  },
  {
    "text": "give us some information about maybe",
    "start": "682030",
    "end": "684070"
  },
  {
    "text": "some tweaks to our code maybe some",
    "start": "684070",
    "end": "685870"
  },
  {
    "text": "tweaks to our infrastructure and please",
    "start": "685870",
    "end": "689770"
  },
  {
    "text": "do use whitelisting but not in the code",
    "start": "689770",
    "end": "692220"
  },
  {
    "text": "because you know that parsing is pretty",
    "start": "692220",
    "end": "695170"
  },
  {
    "text": "hard and it's prone to errors but let's",
    "start": "695170",
    "end": "698020"
  },
  {
    "text": "use the inbuilt features which at least",
    "start": "698020",
    "end": "700750"
  },
  {
    "text": "we hope they have better quality thanks",
    "start": "700750",
    "end": "705340"
  },
  {
    "text": "a lot",
    "start": "705340",
    "end": "706210"
  },
  {
    "text": "[Applause]",
    "start": "706210",
    "end": "710859"
  }
]