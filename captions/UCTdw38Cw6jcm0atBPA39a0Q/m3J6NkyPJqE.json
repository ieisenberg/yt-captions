[
  {
    "text": "well good afternoon everyone we're almost there right almost to the end uh",
    "start": "6919",
    "end": "11960"
  },
  {
    "text": "thank you for coming my name is Jimmy Bogard um by the way the description said donet 5 that is a lie this is donet",
    "start": "11960",
    "end": "17840"
  },
  {
    "text": "8 if you were here for donet five stuff like I'm sorry that was three years ago um so yeah we'll be we'll be focused on",
    "start": "17840",
    "end": "23439"
  },
  {
    "text": "donet 8 for all this stuff um you can find me on Twitter I guess atj Bogard",
    "start": "23439",
    "end": "28880"
  },
  {
    "text": "and uh I'll have some link the actual code and slides at the very end but they're all my GitHub there and uh you",
    "start": "28880",
    "end": "35040"
  },
  {
    "text": "can follow me on my blog at Jimmy bard.com um so my day job is uh a consultant I",
    "start": "35040",
    "end": "41800"
  },
  {
    "text": "mainly focus on like modernization application sort of stuff I am not a security consultant but I was asked to",
    "start": "41800",
    "end": "48480"
  },
  {
    "text": "be one and I like to get a paycheck so I was like sure I'm a security person too yes that sounds good um so this uh this",
    "start": "48480",
    "end": "56320"
  },
  {
    "text": "talk is about a project I was on in which they were introducing a lot of new technology moving to microservices all",
    "start": "56320",
    "end": "62840"
  },
  {
    "text": "the sort of stuff and this is a lot of stuff that I had to learn and Implement as part of that project um I like things",
    "start": "62840",
    "end": "69880"
  },
  {
    "text": "simple though and so if I kind of go back to like normal sort of web applications um we would just have like",
    "start": "69880",
    "end": "75680"
  },
  {
    "text": "something like this right like a monolith or module or monolith whatever",
    "start": "75680",
    "end": "80759"
  },
  {
    "text": "it would just be like there's a browser there's the server and then there's a database and that's it and uh you know",
    "start": "80759",
    "end": "88280"
  },
  {
    "text": "we had the internet which are like people we don't trust and then we had all of our stuff over here on the right this is stuff we want to keep protected",
    "start": "88280",
    "end": "94880"
  },
  {
    "text": "um and so we'd authenticate users so they could um only see the data they're supposed to uh they wouldn't see other",
    "start": "94880",
    "end": "101079"
  },
  {
    "text": "people's data that sort of thing so for a lot of this my career we would just choose cookie based authentication like",
    "start": "101079",
    "end": "108159"
  },
  {
    "text": "forms login cookies and then just be the secure cookie going back and forth I mean there's a little bit to do on the",
    "start": "108159",
    "end": "113719"
  },
  {
    "text": "server side in terms of like we'd have to have a data protection certificate thing and make sure that no one tampered",
    "start": "113719",
    "end": "119640"
  },
  {
    "text": "with the cookie uh but it was very simple like I I miss those days honestly",
    "start": "119640",
    "end": "125560"
  },
  {
    "text": "but this uh this customer um decided to simplify things uh with microservices um",
    "start": "125560",
    "end": "132760"
  },
  {
    "text": "which means that their picture was no longer simple of their applications in their systems it was way more",
    "start": "132760",
    "end": "138280"
  },
  {
    "text": "complicated way more things going on um and so it looked something like this in",
    "start": "138280",
    "end": "144160"
  },
  {
    "text": "which we had a client that that was a angular Spa single application that",
    "start": "144160",
    "end": "150640"
  },
  {
    "text": "would talk to a backend for frontend and a backend for front end is really just like a specialized API designed just for",
    "start": "150640",
    "end": "157000"
  },
  {
    "text": "that one single clients and then this back and for front end would talk to in number of other apis microservices",
    "start": "157000",
    "end": "164000"
  },
  {
    "text": "behind the scenes um that had their own individual databases and whatnot on top of this we also had on the right on",
    "start": "164000",
    "end": "171239"
  },
  {
    "text": "premise clients and so you know they were on the trusted network but those applications would also need to talk to",
    "start": "171239",
    "end": "177560"
  },
  {
    "text": "these very same apis uh and so this was the kind of this is the challenge that we were presented with of like okay",
    "start": "177560",
    "end": "184000"
  },
  {
    "text": "before it was just cookie everything was good now what's this how do we secure",
    "start": "184000",
    "end": "189120"
  },
  {
    "text": "all of these lines in this picture um so the first thing we needed",
    "start": "189120",
    "end": "194879"
  },
  {
    "text": "to do is just for external users so this is someone going to the public facing website logging in whatever uh so this",
    "start": "194879",
    "end": "202959"
  },
  {
    "text": "client um as part of this effort uh just pick not just um I'm sure there's like",
    "start": "202959",
    "end": "209000"
  },
  {
    "text": "stake and wine involved and like golf courses and whatnot to go with ozero",
    "start": "209000",
    "end": "214159"
  },
  {
    "text": "it's not a cheap option um but they decided to use ozero for their external identity provider and there's a whole",
    "start": "214159",
    "end": "220000"
  },
  {
    "text": "project involved and going to that uh so let okay that's great that",
    "start": "220000",
    "end": "225879"
  },
  {
    "text": "solves kind of like that first part of going into the websites authenticating authenticating authorizing and then at",
    "start": "225879",
    "end": "232599"
  },
  {
    "text": "most really just talking to the back and for front ends the other answer of questions were what do we do with the rest of",
    "start": "232599",
    "end": "238280"
  },
  {
    "text": "it so um we needed to figure out one how should we approach internal Azure",
    "start": "238280",
    "end": "244360"
  },
  {
    "text": "communication so this is inside of azure Azure things talking to Azure things so the backend for front end that was an",
    "start": "244360",
    "end": "251200"
  },
  {
    "text": "API uh app service oh no no it's kubernetes of course microservice um it",
    "start": "251200",
    "end": "256479"
  },
  {
    "text": "was a kubernetes uh Docker image something whatever um but the point is it was inside of azure something inside",
    "start": "256479",
    "end": "263120"
  },
  {
    "text": "of azure talking to another API that was deployed inside of azure the other thing we need to figure",
    "start": "263120",
    "end": "268400"
  },
  {
    "text": "out was on-prem communication so there were existing uh like Legacy monolith applications they would also call our",
    "start": "268400",
    "end": "275479"
  },
  {
    "text": "apis were now deployed inside of azure and so we needed to secure those calls as well um now if we were trying to cut",
    "start": "275479",
    "end": "283400"
  },
  {
    "text": "corners or we didn't know what we were doing like we could have just done nothing right we could have just relied",
    "start": "283400",
    "end": "288919"
  },
  {
    "text": "on network security to say you can't get to these resources unless you're inside this v-net or whatever uh so then don't",
    "start": "288919",
    "end": "296639"
  },
  {
    "text": "just don't like maybe just do Transport Security and nothing else just do SSL and just call it a day just assume that",
    "start": "296639",
    "end": "302680"
  },
  {
    "text": "if you can reach me you're probably not a bad bad actor right um well no so the",
    "start": "302680",
    "end": "309440"
  },
  {
    "text": "they had some security cons Consultants come in um who recommended something called a zero trust model and the idea",
    "start": "309440",
    "end": "315800"
  },
  {
    "text": "here is that you never trust always verify and there's not a lot of documentation in terms of like what this",
    "start": "315800",
    "end": "322160"
  },
  {
    "text": "actually means in real practice it's like a lot of buzzwordy sort of stuff of like yeah okay well don't do the thing",
    "start": "322160",
    "end": "328319"
  },
  {
    "text": "where you just assume because you made it this far you must be good to go right instead of saying well we should always",
    "start": "328319",
    "end": "334560"
  },
  {
    "text": "uh authenticate and authorize who know The Originators for these calls along each each step along",
    "start": "334560",
    "end": "341280"
  },
  {
    "text": "the way so um the Consultants like convinced management CTO like yes this",
    "start": "341280",
    "end": "347080"
  },
  {
    "text": "is what we want to do you want to do more security right no one ever really says less security do they it's always like yeah more um and so they said okay",
    "start": "347080",
    "end": "354520"
  },
  {
    "text": "yes it got approved we're going to do the zero trust model uh and then so I is the the archit and developer is like",
    "start": "354520",
    "end": "360759"
  },
  {
    "text": "okay great how do you do this uh but they were already walking out the door so I I was I was just given like here's",
    "start": "360759",
    "end": "366720"
  },
  {
    "text": "a here's kind of a a general direction of what we want to do but in terms of implementing this in real systems and",
    "start": "366720",
    "end": "372639"
  },
  {
    "text": "applications uh that was just left up to us to figure it out so he said okay uh",
    "start": "372639",
    "end": "378759"
  },
  {
    "text": "never trust always verify okay so what does that mean that means that we don't we we still want to authenticate and",
    "start": "378759",
    "end": "384479"
  },
  {
    "text": "authorize users for every single line that we saw in that picture so okay great",
    "start": "384479",
    "end": "390440"
  },
  {
    "text": "how should we authenticate and authorize those users uh well one option we could have we could have done is they were the",
    "start": "390440",
    "end": "397639"
  },
  {
    "text": "users were already authenticated over here on the left so they came into the browser through off zero they now have a",
    "start": "397639",
    "end": "404120"
  },
  {
    "text": "jot right using the oh gosh uh off code",
    "start": "404120",
    "end": "409840"
  },
  {
    "text": "flow with pkce whatever I don't know what any of that stands for but that's what they were doing um and so he said",
    "start": "409840",
    "end": "415639"
  },
  {
    "text": "okay could we quote just take that token and then flow it down like just forward",
    "start": "415639",
    "end": "421520"
  },
  {
    "text": "that token onto back and services um there's a number of reasons why you should not do that uh one of the",
    "start": "421520",
    "end": "428400"
  },
  {
    "text": "big things we we we noticed or we saw as part of like trying to do that was the Scopes that you are authorized for as",
    "start": "428400",
    "end": "435479"
  },
  {
    "text": "part of calling this API may not be the Scopes that you want to authorize for these backend apis you may not want to",
    "start": "435479",
    "end": "442240"
  },
  {
    "text": "allow users to byass you know somehow let's say like the network security screwed up whatever",
    "start": "442240",
    "end": "448039"
  },
  {
    "text": "we don't want users to buy pass this very important Brack and for front end layer to go through and directly call",
    "start": "448039",
    "end": "453639"
  },
  {
    "text": "microservices in the back end this particular project uh involved Health Data and there's a ton of laws like",
    "start": "453639",
    "end": "460919"
  },
  {
    "text": "probably in this country as well that govern like who can see what data and they need to have like specific",
    "start": "460919",
    "end": "466599"
  },
  {
    "text": "agreements so if it's you know if it's a spouse or dependent like you have to have explicit opt-in agreements to be",
    "start": "466599",
    "end": "472080"
  },
  {
    "text": "able to see that protected Health Data so like well the rules for all of that weren't like necessarily being applied",
    "start": "472080",
    "end": "478879"
  },
  {
    "text": "on every every single internal service we only applied those at the edges because it was so complex so if they",
    "start": "478879",
    "end": "485000"
  },
  {
    "text": "called from the client directly to our services they could bypass a lot of those protections we had in place for",
    "start": "485000",
    "end": "490440"
  },
  {
    "text": "the data so if I just quote just FL the token that would imply that the user if",
    "start": "490440",
    "end": "495560"
  },
  {
    "text": "they could access the API in the back end over here they could access like the microservice directly and I wouldn't",
    "start": "495560",
    "end": "501919"
  },
  {
    "text": "even know the token looked exactly the same I wouldn't know if they were coming I guess from like refur URL or like IP",
    "start": "501919",
    "end": "508440"
  },
  {
    "text": "addresses but this not something that we wanted to allow to happen the other problem is that on the right here these",
    "start": "508440",
    "end": "514640"
  },
  {
    "text": "on-prem systems those were like web forms apps from like 2006 or something",
    "start": "514640",
    "end": "519760"
  },
  {
    "text": "so they were still just using cookie off and so there was no token so like well do we like depending on where you're",
    "start": "519760",
    "end": "526120"
  },
  {
    "text": "coming from I'll allow you to use the token or oh wait you're coming from over here so I'll go look for the cookie",
    "start": "526120",
    "end": "531480"
  },
  {
    "text": "instead and would great greatly complicate the security picture of these microservices uh behind the scenes if I",
    "start": "531480",
    "end": "537760"
  },
  {
    "text": "would just be like I will support any uh like Edge authentication and authorization um strategies there so we",
    "start": "537760",
    "end": "545040"
  },
  {
    "text": "don't want to do that either so like just flowing like just flowing the user token uh was just not going to work on a",
    "start": "545040",
    "end": "550320"
  },
  {
    "text": "number of uh different reasons a number of different levels so we said great um",
    "start": "550320",
    "end": "555640"
  },
  {
    "text": "so we can't use the kind of edge authentication authorization but we're inside of azure why don't we use the",
    "start": "555640",
    "end": "562680"
  },
  {
    "text": "capabilities that Azure provides and so the solution for us to use now it's called intra ID it was called Azure ad",
    "start": "562680",
    "end": "571000"
  },
  {
    "text": "um I should have changed this so yeah the solution was use uh Microsoft's uh identity provider which is azure ad or",
    "start": "571000",
    "end": "577480"
  },
  {
    "text": "now intra ID um none of the packages or libraries have changed the name and they",
    "start": "577480",
    "end": "582720"
  },
  {
    "text": "won't change the name so you'll still see like ad identity that sort of thing in all the packages and libraries it's a",
    "start": "582720",
    "end": "589519"
  },
  {
    "text": "pure marketing term uh on this you know the CMS has got changed but nothing else behind the",
    "start": "589519",
    "end": "595320"
  },
  {
    "text": "scenes okay so yeah we're inside of azure Azure has his cap ities so let's",
    "start": "595320",
    "end": "600360"
  },
  {
    "text": "use that um but that still POS the question of like okay okay we're going to use this identity provider how how",
    "start": "600360",
    "end": "607640"
  },
  {
    "text": "specifically are we going to authenticate and authorize these calls between these different services and",
    "start": "607640",
    "end": "613120"
  },
  {
    "text": "on-prem applications so yeah that the next question is how do we authenticate these",
    "start": "613120",
    "end": "619079"
  },
  {
    "text": "callers I want to say users because they're not always users we didn't just have end people humans that were",
    "start": "619079",
    "end": "626560"
  },
  {
    "text": "originating these calls we also had things like um schedule tasks Crown jobs",
    "start": "626560",
    "end": "631959"
  },
  {
    "text": "messaging in points uh things that did not have any kind of user information whatsoever those still how to make those",
    "start": "631959",
    "end": "637760"
  },
  {
    "text": "calls as well luckily Microsoft does have like",
    "start": "637760",
    "end": "643320"
  },
  {
    "text": "pretty good documentation about the different kinds of flows for oo 2 so",
    "start": "643320",
    "end": "648399"
  },
  {
    "text": "that's the next thing was like we're going to use the standard right we're not going to make up our own authentication flow for some of these things I've seen that done sometimes",
    "start": "648399",
    "end": "654959"
  },
  {
    "text": "where like people will make up their own headers and do their own flows like well we want as much as possible stick to standards because that lets us use",
    "start": "654959",
    "end": "661959"
  },
  {
    "text": "packages and libraries out of the box without having to do a ton of customization so um the aure",
    "start": "661959",
    "end": "668959"
  },
  {
    "text": "documentation uh describes these different possible OA flows um these flows uh the will apply to different",
    "start": "668959",
    "end": "677320"
  },
  {
    "text": "scenarios and also different kinds of audiences and this is where it is kind of specific to the identity provider",
    "start": "677320",
    "end": "683760"
  },
  {
    "text": "like ozero of course does have its own way of doing all these different things",
    "start": "683760",
    "end": "689720"
  },
  {
    "text": "so we could have picked them if we wanted to but there were two problems with that one was uh the migration to",
    "start": "689720",
    "end": "695399"
  },
  {
    "text": "oero was running like a year behind and we weren't even sure if it's ever going to happen because identity migration is",
    "start": "695399",
    "end": "701440"
  },
  {
    "text": "not about identity it's more like an integration nightmare so like well we don't want to you know hitch our hitch",
    "start": "701440",
    "end": "707839"
  },
  {
    "text": "our wag no anyway we didn't want to pick something that we didn't think was actually going to go alive uh so we said",
    "start": "707839",
    "end": "713160"
  },
  {
    "text": "okay we'll we'll go with Azure um but these are all standard of these standard flows here so we just",
    "start": "713160",
    "end": "718680"
  },
  {
    "text": "went by one one by one which one of these is most appropriate for our uh scenarios at hand the first one a single",
    "start": "718680",
    "end": "724800"
  },
  {
    "text": "page app well there is a single page app right this angular Spa um however that",
    "start": "724800",
    "end": "731880"
  },
  {
    "text": "authentication is going to be using um azero using this flow the off code flow",
    "start": "731880",
    "end": "737920"
  },
  {
    "text": "with pkce um and so we weren't going to change that right they're already going to off zero um the the possibilities for",
    "start": "737920",
    "end": "745000"
  },
  {
    "text": "us to use intra ID um I think what's called Azure beta C or something like that uh I've not yet heard a good story",
    "start": "745000",
    "end": "752360"
  },
  {
    "text": "about that product and it wasn't out of it was out of scope anyway like this is just the kind of behind the scenes",
    "start": "752360",
    "end": "757639"
  },
  {
    "text": "communication so that was out web app same thing like this is not a web app these are apis to apis uh what do about",
    "start": "757639",
    "end": "764920"
  },
  {
    "text": "the next one web app that calls web apis that's kind of what it is right but it's an API that calls apis so it's it's",
    "start": "764920",
    "end": "771639"
  },
  {
    "text": "slightly different um desktop app that calls web apis no that's not us mobile app there was a mobile app but that",
    "start": "771639",
    "end": "778480"
  },
  {
    "text": "wasn't us either this one's interesting though uh web API that calls web apis that's what the",
    "start": "778480",
    "end": "785680"
  },
  {
    "text": "picture was right the back and for front in is an API that calls other apis so that one we could use the on behalf of",
    "start": "785680",
    "end": "793320"
  },
  {
    "text": "flow the final one is just kind of the catchall just like the last one that you could use is demon app that calls web",
    "start": "793320",
    "end": "799839"
  },
  {
    "text": "apis so ours weren't all demon apps but the general gist of it is I don't have a",
    "start": "799839",
    "end": "805959"
  },
  {
    "text": "passable flowable user identity token from the calling app to us and so that",
    "start": "805959",
    "end": "811000"
  },
  {
    "text": "kind of gets lumped into the bottom of demon app that calls web apis and now would use the client credentials",
    "start": "811000",
    "end": "817600"
  },
  {
    "text": "flow so ideally we could use the web API that calls web apis but the problem is",
    "start": "817600",
    "end": "823839"
  },
  {
    "text": "over on the right who the audience can be for this an on behalf token will basically I now that I have a valid",
    "start": "823839",
    "end": "830079"
  },
  {
    "text": "token I will acquire a new token on behalf of this user but this time I'm going to not necessarily just get all",
    "start": "830079",
    "end": "835920"
  },
  {
    "text": "the same Scopes that I had before I will say that okay based on this token and then who this caller is I can then get",
    "start": "835920",
    "end": "842959"
  },
  {
    "text": "authorized for these other Scopes to then make uh you know further backend calls but this only works for the uh",
    "start": "842959",
    "end": "850600"
  },
  {
    "text": "tokens incoming tokens if those tokens are also Azure ad in ID tokens but we're",
    "start": "850600",
    "end": "857079"
  },
  {
    "text": "not that right we're both off zero sometimes and then other times it's like cookie apps and other times it's these",
    "start": "857079",
    "end": "863240"
  },
  {
    "text": "client uh you know like just like headless applications and so really that just came down to this one like the only",
    "start": "863240",
    "end": "868720"
  },
  {
    "text": "one we had any kind of valid use case for was client credentials to be able to authenticate and authorize all these",
    "start": "868720",
    "end": "875800"
  },
  {
    "text": "different calls uh for the backend Services okay so we have a direction in",
    "start": "875800",
    "end": "882440"
  },
  {
    "text": "terms of the flow we want to use um the next thing we needed to figure out was how do we authorize those",
    "start": "882440",
    "end": "888920"
  },
  {
    "text": "callers so we don't have that initial token coming in so we don't necessarily who the original user was so what should",
    "start": "888920",
    "end": "895360"
  },
  {
    "text": "we use for authorization it's like just because you have a valid token I don't look at anything else like if you got a",
    "start": "895360",
    "end": "900560"
  },
  {
    "text": "valid token from this tenant then that's good enough well again because we were dealing with protected Health Data we",
    "start": "900560",
    "end": "907000"
  },
  {
    "text": "wanted to apply a little bit more scrutiny to authorize these incoming calls now this is again specific to our",
    "start": "907000",
    "end": "914440"
  },
  {
    "text": "needs there so you do have quite a few options in terms of how you decide your design your authorization schemes but",
    "start": "914440",
    "end": "920600"
  },
  {
    "text": "one of the kickers we have here is that even that's code o off the off is not authorization so it's not like okay I I",
    "start": "920600",
    "end": "927600"
  },
  {
    "text": "have these specific kind of permissions and rules for looking at specific set of data it's completely up to you and your",
    "start": "927600",
    "end": "932920"
  },
  {
    "text": "your application decide what makes sense in terms of authorizing uh you know authorizing incoming",
    "start": "932920",
    "end": "938920"
  },
  {
    "text": "calls so uh the intra ID product has two",
    "start": "938920",
    "end": "944440"
  },
  {
    "text": "main options of how you can authorize these kinds of calls the first one is known as Access Control list or",
    "start": "944440",
    "end": "950839"
  },
  {
    "text": "ACLS uh so the server application will check the claim so it'll check the issuer like is it coming from the right",
    "start": "950839",
    "end": "957120"
  },
  {
    "text": "place checks the audience that sort of thing and then just does custom logic so it's called Access Control list but it's",
    "start": "957120",
    "end": "962800"
  },
  {
    "text": "like there's nothing built into ENT ID to do access control list it's just like well we won't give you any additional",
    "start": "962800",
    "end": "968360"
  },
  {
    "text": "token or any additional claims it's completely up to your application to just enforce its own rules and how it",
    "start": "968360",
    "end": "974560"
  },
  {
    "text": "wants to authorized stuff the one that is built into in ID are the second one which is known as application",
    "start": "974560",
    "end": "981160"
  },
  {
    "text": "permissions this is where like every identity provider has its own kind of way of doing this so ozero has it is has",
    "start": "981160",
    "end": "988360"
  },
  {
    "text": "its way of doing kind of role-based authorization checks or arback um I mean they all do they all have some custom",
    "start": "988360",
    "end": "995000"
  },
  {
    "text": "way of doing so so this is now exiting the realm of ooth flows and it's more just like I'm configuring identities uh",
    "start": "995000",
    "end": "1002560"
  },
  {
    "text": "to issue claims that have this information in them uh but then it's really up to my my server then to like",
    "start": "1002560",
    "end": "1009440"
  },
  {
    "text": "to authorize against these different permissions or roles so in this one um",
    "start": "1009440",
    "end": "1014519"
  },
  {
    "text": "we uh Define custom roles inside of intra ID we assign those roles to the server",
    "start": "1014519",
    "end": "1021920"
  },
  {
    "text": "principles so these are like the um the server application that's making these uh calls and then the token when I say I",
    "start": "1021920",
    "end": "1030120"
  },
  {
    "text": "am client a uh wanting a token for Server B I ask inra ID for that token I",
    "start": "1030120",
    "end": "1037360"
  },
  {
    "text": "authenticate against this and then the the token I get back will include those roles as a claim inside the token so",
    "start": "1037360",
    "end": "1044720"
  },
  {
    "text": "it's similar to just kind of random claims but this time they're going to come over in a special roles claim that",
    "start": "1044720",
    "end": "1050720"
  },
  {
    "text": "will include all the roles assigned for that specific server resource then on the server side when I",
    "start": "1050720",
    "end": "1057840"
  },
  {
    "text": "receive those calls I will then authorize against those roles um so uh what I did was I built a",
    "start": "1057840",
    "end": "1065600"
  },
  {
    "text": "very simplified application so I know I had like microservices and all this sort of junk but I could basically boil down to a couple main scenarios um the server",
    "start": "1065600",
    "end": "1073960"
  },
  {
    "text": "here will represent my back end for front end no I'm sorry the server here",
    "start": "1073960",
    "end": "1079159"
  },
  {
    "text": "will uh be represented as my backend microservice so this is the API that is calling databases with if its own data",
    "start": "1079159",
    "end": "1085600"
  },
  {
    "text": "that sort of thing uh then I have a two clients one is a client that is completely inside of azure deployed to",
    "start": "1085600",
    "end": "1092919"
  },
  {
    "text": "Azure either kubernetes or Azure container app or Azure app service whatever it is a it is an completely",
    "start": "1092919",
    "end": "1100039"
  },
  {
    "text": "inside of azure client then I also have an external client this external clients",
    "start": "1100039",
    "end": "1105640"
  },
  {
    "text": "represents on Prem system or just anything else ises not inside the Azure",
    "start": "1105640",
    "end": "1111960"
  },
  {
    "text": "ecosystem okay so um the final piece of the puzzle was defining what these application permissions rolles should be",
    "start": "1113400",
    "end": "1121039"
  },
  {
    "text": "and this is something that you define inside of azure completely you just type in strings and you define the roles and",
    "start": "1121039",
    "end": "1127159"
  },
  {
    "text": "then your server will then authorize those roles but we still have to design design what those application",
    "start": "1127159",
    "end": "1132960"
  },
  {
    "text": "permissions should be now in some of my more complex like management",
    "start": "1132960",
    "end": "1138080"
  },
  {
    "text": "applications backend admin system sort of things we have like custom rolled system to do this right you might have a",
    "start": "1138080",
    "end": "1144480"
  },
  {
    "text": "system in your application that has like a table with uh like you have an enum that is all the permissions then you",
    "start": "1144480",
    "end": "1150679"
  },
  {
    "text": "have a table that is for the roles and permissions or groups and permissions so you sign permissions for actions and",
    "start": "1150679",
    "end": "1156159"
  },
  {
    "text": "activities you assign those to individual roles or groups and then you assign users to those groups a similar",
    "start": "1156159",
    "end": "1163039"
  },
  {
    "text": "kind of construct is inside of azure and so when I'm going through this I'm picturing like well if I was a build",
    "start": "1163039",
    "end": "1168679"
  },
  {
    "text": "build a completely bespoke permission system this is probably what I would come up with but we have to Define what are those permissions that my",
    "start": "1168679",
    "end": "1175720"
  },
  {
    "text": "application is going to authorized individual users or Services can",
    "start": "1175720",
    "end": "1180919"
  },
  {
    "text": "perform so in this dummy application uh of course like every API um and Spa sort",
    "start": "1180919",
    "end": "1188880"
  },
  {
    "text": "of uh demo here it's just a to-do uh API um and so this to-do API uh exposes just",
    "start": "1188880",
    "end": "1195400"
  },
  {
    "text": "the sort of normal crud operations for to-do items so can get all the Todo items get one to-do item you can update",
    "start": "1195400",
    "end": "1202640"
  },
  {
    "text": "a twoo item you can post and create a new Todo item or you can delete a to-do item so all the all the kind of things",
    "start": "1202640",
    "end": "1208799"
  },
  {
    "text": "you can do with these twoo items so a very naive implementation for",
    "start": "1208799",
    "end": "1214240"
  },
  {
    "text": "roles would be to map each of those kinds of activities to a specific action the user is performing so they can read",
    "start": "1214240",
    "end": "1221440"
  },
  {
    "text": "update create and delete now when I'm designing permissions for like real systems like a",
    "start": "1221440",
    "end": "1228400"
  },
  {
    "text": "US us manag systems of where users are assigning this is something that we often map to like pages in the application or like groups of actions",
    "start": "1228400",
    "end": "1234919"
  },
  {
    "text": "they can perform maybe men menu structures uh things like that to say how do I want to design the permission",
    "start": "1234919",
    "end": "1240720"
  },
  {
    "text": "structure for the different things the user can perform and there can be a um there's kind of a tug and balance",
    "start": "1240720",
    "end": "1246440"
  },
  {
    "text": "between making things super specific like I have here and then now I can be very super customized and exact about",
    "start": "1246440",
    "end": "1253320"
  },
  {
    "text": "exact or actions user user can perform or I can go the other direction and be very generic and do something like you",
    "start": "1253320",
    "end": "1259000"
  },
  {
    "text": "know role base authorization is user admin and that gets you to be all these sorts of things um so this when we",
    "start": "1259000",
    "end": "1265200"
  },
  {
    "text": "struck a bit of a balance and said basically there's read write operations we even went one further so we also",
    "start": "1265200",
    "end": "1272279"
  },
  {
    "text": "included any API inpoint that included protected health information we'd have like an additional permission that says",
    "start": "1272279",
    "end": "1278279"
  },
  {
    "text": "you know only the applications that we know can perform the extra checks will be able to get this permission to",
    "start": "1278279",
    "end": "1284520"
  },
  {
    "text": "perform like protected Health sort of things so this is something that is a design activity to figure out what is",
    "start": "1284520",
    "end": "1290159"
  },
  {
    "text": "you know what makes sense in terms of the permissions here as far as a are concerned though these are just strings",
    "start": "1290159",
    "end": "1296720"
  },
  {
    "text": "you know strings that get stored somewhere and get assigned to things there's no knowledge of any of these sort of things but it does use the exact",
    "start": "1296720",
    "end": "1303200"
  },
  {
    "text": "same mechanism that all the other uh arbat controls inside of azure do so if",
    "start": "1303200",
    "end": "1309000"
  },
  {
    "text": "you've ever had to like well I don't have access to key Vault someone needs to assign me to a group or sign a permission to me this is using the exact",
    "start": "1309000",
    "end": "1316440"
  },
  {
    "text": "same structures and capabilities underneath the covers except it's now customized and I can Define it for",
    "start": "1316440",
    "end": "1321520"
  },
  {
    "text": "myself what's nice about that is that that also means that all the libraries you're using for aure resources can also",
    "start": "1321520",
    "end": "1328120"
  },
  {
    "text": "be used to access your applications and your apis and your resources so we have to bring in a whole bunch of new junk to",
    "start": "1328120",
    "end": "1334240"
  },
  {
    "text": "be able to do this so the same Library I'm using to communicate with key Vault with um Azure SQL or whatever those same",
    "start": "1334240",
    "end": "1342039"
  },
  {
    "text": "libraries what I can use to now talk to my own apis because they're authenticated and authorized and protected with Azure inter ID as",
    "start": "1342039",
    "end": "1349840"
  },
  {
    "text": "well all right that's enough slides Let's uh switch over now to our",
    "start": "1349840",
    "end": "1356120"
  },
  {
    "text": "demo like I mentioned before let's see there was a hotkey for this let's see if it works it did not that's cool uh so we're",
    "start": "1356120",
    "end": "1363600"
  },
  {
    "text": "going to go to let me mirror my screen wait it is mirrored oh I'm Already There brilliant okay so uh this is my",
    "start": "1363600",
    "end": "1371840"
  },
  {
    "text": "simplified dummy application where I've got a client Azure client an external",
    "start": "1371840",
    "end": "1377600"
  },
  {
    "text": "client and the Azure server and then the one extra piece I've added here is",
    "start": "1377600",
    "end": "1382799"
  },
  {
    "text": "infrastructure um I to make my life a little bit easier I'm using uh this tool",
    "start": "1382799",
    "end": "1389039"
  },
  {
    "text": "called palumi um this is not a palumi talk I will be showing a lot of palumi just because clicking around the portal",
    "start": "1389039",
    "end": "1395240"
  },
  {
    "text": "for all this inid stuff is maddening like it does it's not obvious how these different pieces connect together uh",
    "start": "1395240",
    "end": "1401039"
  },
  {
    "text": "palumi though lets me Define uh Cloud Resources with like code and then in the",
    "start": "1401039",
    "end": "1406360"
  },
  {
    "text": "code you can much more easily see how the different components are connected together so that's the only reason I'm using this is",
    "start": "1406360",
    "end": "1412559"
  },
  {
    "text": "uh I also want to learn py so this was the forcing function for that that's not the important part um it's just a easier",
    "start": "1412559",
    "end": "1418840"
  },
  {
    "text": "way for me to uh get my resources up and running and to uh show how it's connected",
    "start": "1418840",
    "end": "1424919"
  },
  {
    "text": "together okay so the first thing we're going to need to do is uh build out our",
    "start": "1424919",
    "end": "1430919"
  },
  {
    "text": "server um so my Azure server this is just a ASP net core web",
    "start": "1430919",
    "end": "1438640"
  },
  {
    "text": "API application uh running 8 and it is I",
    "start": "1438640",
    "end": "1444039"
  },
  {
    "text": "have my two um two apis I'm exposing one is not secured this weather controller",
    "start": "1444039",
    "end": "1451120"
  },
  {
    "text": "there's no authorization here so anyone can call this and then the two two items is actually secured okay um so before I really go go",
    "start": "1451120",
    "end": "1459400"
  },
  {
    "text": "anywhere um I have to create some Azure resources uh that I can then configure",
    "start": "1459400",
    "end": "1464600"
  },
  {
    "text": "inside of this application so let's go over to my pumi stuff and walk through",
    "start": "1464600",
    "end": "1470120"
  },
  {
    "text": "that so um in my stack here uh the first",
    "start": "1470120",
    "end": "1476360"
  },
  {
    "text": "thing I'll be showing is my server so um again this is plumy so it's just an object that uh gets instantiated",
    "start": "1476360",
    "end": "1483840"
  },
  {
    "text": "and creates all the stuff so the first thing I need is my app service so this application is going to be deployed as",
    "start": "1483840",
    "end": "1489760"
  },
  {
    "text": "an oh that should be eight oops um there's an Azure app service there's nothing really interesting here there's",
    "start": "1489760",
    "end": "1495440"
  },
  {
    "text": "this this is just a a single Azure app service that is running over",
    "start": "1495440",
    "end": "1501279"
  },
  {
    "text": "here yes Let me refresh it because this is free and so it's probably like not",
    "start": "1501279",
    "end": "1508960"
  },
  {
    "text": "warmed up anymore yeah oh it is wow okay um yeah so this is this is my uh application",
    "start": "1508960",
    "end": "1515960"
  },
  {
    "text": "deployed into an Azure app Service uh in my um in my Azure registration so the",
    "start": "1515960",
    "end": "1521279"
  },
  {
    "text": "next thing I need to do is I need to create some Azure uh intra ID resources",
    "start": "1521279",
    "end": "1526480"
  },
  {
    "text": "that can then be used to secure this this application and this is the part that is different for every single identity provider um so like oer has its",
    "start": "1526480",
    "end": "1534600"
  },
  {
    "text": "way of doing things OCTA has its way of doing things but they're basically just means of setting up resources to enable",
    "start": "1534600",
    "end": "1541200"
  },
  {
    "text": "ooth two flows so inside of um inside of uh intra ID I create what's known as a",
    "start": "1541200",
    "end": "1548880"
  },
  {
    "text": "server application a server application is a way of identifying I am something",
    "start": "1548880",
    "end": "1554399"
  },
  {
    "text": "that can be secured with inra ID and it creates this I mean imagine there's somewhere in Azure there's a table",
    "start": "1554399",
    "end": "1560200"
  },
  {
    "text": "called TBL principles and then there's an off that that's TBL application and this is a thing that it can be used to",
    "start": "1560200",
    "end": "1566720"
  },
  {
    "text": "assign permissions and to authorize against all right so I create this",
    "start": "1566720",
    "end": "1572080"
  },
  {
    "text": "application um and so if I go over to entro ID what does this look like here is uh oh ENT ID is right here um this",
    "start": "1572080",
    "end": "1581399"
  },
  {
    "text": "results in an app registration this application and by the way this is called like three different things",
    "start": "1581399",
    "end": "1586840"
  },
  {
    "text": "inside of intro as well it's really annoying so the the",
    "start": "1586840",
    "end": "1591919"
  },
  {
    "text": "um the actual like Azure SDK resource is called an application but in the UI it's",
    "start": "1591919",
    "end": "1597640"
  },
  {
    "text": "also called an app registration whatever so um so what did",
    "start": "1597640",
    "end": "1603840"
  },
  {
    "text": "this create for me it creates this app registration object uh and the important bit here is that it it creates",
    "start": "1603840",
    "end": "1612360"
  },
  {
    "text": "a uh it gives me this application client ID um this will be uh important whenever",
    "start": "1612360",
    "end": "1619279"
  },
  {
    "text": "we're doing ooth flow when I say I want to acquire a token for this thing this thing is represented by that ID so I",
    "start": "1619279",
    "end": "1625960"
  },
  {
    "text": "don't just acquire a token in a generic term or generic sense if I'm resource a wanting to acquire token for resource B",
    "start": "1625960",
    "end": "1632640"
  },
  {
    "text": "I ask Azure to say give me a token for that specific resource because I may have permissions that are different",
    "start": "1632640",
    "end": "1639279"
  },
  {
    "text": "between different resources okay so uh this is important",
    "start": "1639279",
    "end": "1645640"
  },
  {
    "text": "here so we need to um in our Azure server if I am a web API that needs to",
    "start": "1645640",
    "end": "1652159"
  },
  {
    "text": "authenticate and authorize against Azure ad what we need to do is bring in the Microsoft identity web package so this",
    "start": "1652159",
    "end": "1659520"
  },
  {
    "text": "is the package you use if you're are a server API that needs to authenticate and authorize against aure adid this",
    "start": "1659520",
    "end": "1665120"
  },
  {
    "text": "makes a lot easier you don't have to use this right there are libraries inside of",
    "start": "1665120",
    "end": "1670399"
  },
  {
    "text": "uh net or ASP net cord to do just generic ooth flows but this one makes it like 8,000 times easier so we're going",
    "start": "1670399",
    "end": "1676200"
  },
  {
    "text": "to use that how does it make it easier well let's go to our setup here in the program",
    "start": "1676200",
    "end": "1682039"
  },
  {
    "text": "CS I get to Swagger in a bit here um so here we are going to call builder.",
    "start": "1682039",
    "end": "1687640"
  },
  {
    "text": "services. add the longest extension method name I've seen so far add Microsoft identity web API",
    "start": "1687640",
    "end": "1694200"
  },
  {
    "text": "authentication passing in the configuration there we'll get to this other weird junk here in a little bit",
    "start": "1694200",
    "end": "1699640"
  },
  {
    "text": "when we talk about roles but this is the important bit this will do the authentication and authorization or all",
    "start": "1699640",
    "end": "1704960"
  },
  {
    "text": "the services to do so and then down here when I do use authentication and use authorization like that'll do then the",
    "start": "1704960",
    "end": "1711200"
  },
  {
    "text": "real like me you know get the authorization provider uh check the token against the claims and all that",
    "start": "1711200",
    "end": "1717159"
  },
  {
    "text": "sort of stuff uh the configuration I need though as part of this is in my app settings um",
    "start": "1717159",
    "end": "1723000"
  },
  {
    "text": "and so I need to give it the Azure ID uh configuration here so this includes the instance it's probably not this one for",
    "start": "1723000",
    "end": "1728320"
  },
  {
    "text": "you it's probably like a real tenant you know in Azure that this is my personal like Azure credit so it's just going to",
    "start": "1728320",
    "end": "1734720"
  },
  {
    "text": "be that one uh the tenant ID which is going to be constant for the entire tenant of uh",
    "start": "1734720",
    "end": "1740720"
  },
  {
    "text": "Azure ID or inra ID and this client ID is important because this client is this",
    "start": "1740720",
    "end": "1747000"
  },
  {
    "text": "good right here so f2bb blah blah blah blah this little guy here is what I",
    "start": "1747000",
    "end": "1752480"
  },
  {
    "text": "stick in right here it's a little confusing because you're like what is it is the application ID or is the client",
    "start": "1752480",
    "end": "1758760"
  },
  {
    "text": "ID or is it both well it's the application ID but like it hasn't quite caught up to renaming all these things",
    "start": "1758760",
    "end": "1764360"
  },
  {
    "text": "here um renaming client applications so it's going to be a little confusing sometimes the naming but this is where",
    "start": "1764360",
    "end": "1769519"
  },
  {
    "text": "we are okay so um when I run",
    "start": "1769519",
    "end": "1775200"
  },
  {
    "text": "this",
    "start": "1775200",
    "end": "1778200"
  },
  {
    "text": "run I also have uh Swagger configured so over here in my my uh Swagger",
    "start": "1782000",
    "end": "1790240"
  },
  {
    "text": "configuration over here um we will also include the ooth information so we'll say oh yeah we're",
    "start": "1790320",
    "end": "1796720"
  },
  {
    "text": "doing the oo o code flow um and this is the information and whatever uh and",
    "start": "1796720",
    "end": "1803399"
  },
  {
    "text": "Swagger UI the same kind of thing of like uh we want to enable the ooth in the in the testing uh or in the Swagger",
    "start": "1803399",
    "end": "1810919"
  },
  {
    "text": "um UI so that I as a developer that wants to test this I can so here right",
    "start": "1810919",
    "end": "1816960"
  },
  {
    "text": "we want this little green button to show up over here there we go um and I want that to do something okay but there's a",
    "start": "1816960",
    "end": "1823720"
  },
  {
    "text": "problem though because like when I click authorize and I say I am a you know my I am an ID tenants well now it's me as a",
    "start": "1823720",
    "end": "1830399"
  },
  {
    "text": "human being trying to get a token I'm now I'm now I'm now back to like well I'm a user acquiring a token I'm not",
    "start": "1830399",
    "end": "1837120"
  },
  {
    "text": "like a a demon application using client credentials technically you can configure um you can configure a Swagger",
    "start": "1837120",
    "end": "1845120"
  },
  {
    "text": "to use client credentials but like that means the the client secret needs to be",
    "start": "1845120",
    "end": "1850600"
  },
  {
    "text": "in the browser somehow so if you try that if you try to authorize and get and",
    "start": "1850600",
    "end": "1856559"
  },
  {
    "text": "get a token from ID from a browser losing using client credentials it will",
    "start": "1856559",
    "end": "1862320"
  },
  {
    "text": "not let you because it says wait a second you shouldn't be using a secret in a browser like that that's absolutely",
    "start": "1862320",
    "end": "1868360"
  },
  {
    "text": "not what you like browsers are not secure secure pieces of code you you should not be doing that so actually",
    "start": "1868360",
    "end": "1873760"
  },
  {
    "text": "refu we we actually tried that first we said we'll have a Dev client ID in secret and we'll put that in there and",
    "start": "1873760",
    "end": "1879360"
  },
  {
    "text": "then entra is like uhuh you can't do that so that means that I actually need to enable the off code flow off code",
    "start": "1879360",
    "end": "1887039"
  },
  {
    "text": "flow for for this API so that I can test it with the browser now in Upper",
    "start": "1887039",
    "end": "1892760"
  },
  {
    "text": "environments we do turn this off but for local development I do want this turned on",
    "start": "1892760",
    "end": "1898120"
  },
  {
    "text": "so back over in my server we have to do some additional junk to be able to turn",
    "start": "1898120",
    "end": "1905200"
  },
  {
    "text": "those different pieces on actually before that let's go into roles because we also want to authorize again specific",
    "start": "1905200",
    "end": "1910480"
  },
  {
    "text": "roles so um in order to uh authorize roles I have to define those roles as",
    "start": "1910480",
    "end": "1917440"
  },
  {
    "text": "part of my server application because I'll be using intro ID to assign roles to principles so here I create some",
    "start": "1917440",
    "end": "1925000"
  },
  {
    "text": "well-known role ID and this is just a way for you to reference those Ro IDs in other places and then here as part of my",
    "start": "1925000",
    "end": "1931480"
  },
  {
    "text": "definition of the application I say okay your app roles are two you've got one for too.",
    "start": "1931480",
    "end": "1937760"
  },
  {
    "text": "read and one for too. write I also tell",
    "start": "1937760",
    "end": "1942799"
  },
  {
    "text": "it who can get who can be assigned these kinds of uh roles I I say users can be assigned these roles and applications",
    "start": "1942799",
    "end": "1949679"
  },
  {
    "text": "can be assigned these roles as well now once I have those roles defined if I go over to",
    "start": "1949679",
    "end": "1956919"
  },
  {
    "text": "my this is the app registration if I go over to app roles there we have to- do.",
    "start": "1956919",
    "end": "1963000"
  },
  {
    "text": "read and to-do wres showing up there I could create it here but we should be",
    "start": "1963000",
    "end": "1968279"
  },
  {
    "text": "using infrastructure as code right so we should be like actually using you know like terraform or what bicep or whatever",
    "start": "1968279",
    "end": "1974000"
  },
  {
    "text": "um I could do it through the UI but um then it's not very repeatable and I'll definitely forget something as I going through all",
    "start": "1974000",
    "end": "1979880"
  },
  {
    "text": "this okay so I've defined the roles as part of my uh application um in my",
    "start": "1979880",
    "end": "1988679"
  },
  {
    "text": "actual code itself if I go look at the to-do items controller the first thing you'll see is that I'm authorizing here",
    "start": "1988679",
    "end": "1994639"
  },
  {
    "text": "right so you have to be an authorized user you have to have a valid token and in each of my API endpoints I expose",
    "start": "1994639",
    "end": "2002039"
  },
  {
    "text": "these controller actions I will say authorize roles equals the role I want to authorize against so this authorized",
    "start": "2002039",
    "end": "2011000"
  },
  {
    "text": "attribute is not aware of enter ID he",
    "start": "2011000",
    "end": "2016639"
  },
  {
    "text": "doesn't know about this it just knows you have a principle and there's a principal or user that has user that is",
    "start": "2016639",
    "end": "2022240"
  },
  {
    "text": "in rooll and it calls that thing to say is the user in this role and if the user is in this role then it returns true if",
    "start": "2022240",
    "end": "2027559"
  },
  {
    "text": "not it returns false but something needs to populate those roles from the incoming token so that piece is back",
    "start": "2027559",
    "end": "2034440"
  },
  {
    "text": "over here this this janky looking thing that says uh here we go where I say um clear",
    "start": "2034440",
    "end": "2042600"
  },
  {
    "text": "the default inbound claim map and the reason why it's doing this is like there's two versions of inra ID tokens",
    "start": "2042600",
    "end": "2050200"
  },
  {
    "text": "and one has this like really weird like soap looking urin that defines the different to the different um the",
    "start": "2050200",
    "end": "2056960"
  },
  {
    "text": "different claims uh and so this these two pieces just say hey don't like try to map to what you think it should be",
    "start": "2056960",
    "end": "2062720"
  },
  {
    "text": "mapped to in these weird Like Ur NS for for claim types just don't do anything like as the claims come in just leave",
    "start": "2062720",
    "end": "2069280"
  },
  {
    "text": "them alone don't touch them please if you don't do this it won't properly map the R's claim to a roles claim in the",
    "start": "2069280",
    "end": "2077240"
  },
  {
    "text": "identity and then is in roll won't work and this took me like a week to figure",
    "start": "2077240",
    "end": "2082638"
  },
  {
    "text": "out that this was very important set a code to make this role-based authorization work once this is hooked",
    "start": "2082639",
    "end": "2088158"
  },
  {
    "text": "up though then my application code has no knowledge or understanding of in ID",
    "start": "2088159",
    "end": "2094200"
  },
  {
    "text": "at all this is just standard role-based authorization in my application that's what I want as a developer I don't want",
    "start": "2094200",
    "end": "2099640"
  },
  {
    "text": "to have to be calling into specific sdks or apis just you know just authorize a",
    "start": "2099640",
    "end": "2105760"
  },
  {
    "text": "specific rle so there's two do. read and to do. write okay so um I've got the incoming",
    "start": "2105760",
    "end": "2113560"
  },
  {
    "text": "roles mapped I've got them authorized but when I F5 I need to I need to do this last piece of um I as a user need",
    "start": "2113560",
    "end": "2120880"
  },
  {
    "text": "to be uh need to one have the ability to do this flow of off code with pkce and",
    "start": "2120880",
    "end": "2126720"
  },
  {
    "text": "the second thing is I need to make sure that when I ask for a um when I ask for a token for this resource I want my user",
    "start": "2126720",
    "end": "2133040"
  },
  {
    "text": "to also be assigned those roles as well so that I as a developer of developing locally the token contains those roles",
    "start": "2133040",
    "end": "2139240"
  },
  {
    "text": "and they can pass them through uh without any problems so those pieces over here um I exposed out the RO",
    "start": "2139240",
    "end": "2147880"
  },
  {
    "text": "IDs um then the next thing I need to do is uh create an API definition and the",
    "start": "2147880",
    "end": "2153440"
  },
  {
    "text": "API definition is how you tell uh inro ID that like I now I'm going going to support these kinds of ooth flows so I",
    "start": "2153440",
    "end": "2161000"
  },
  {
    "text": "do a couple things one is uh say that you will you give the 2.0 version of the token because tokens uh the jots are",
    "start": "2161000",
    "end": "2168480"
  },
  {
    "text": "contracts right those can change um and so this is just saying I want the specific version of the token coming through and then I'm going to say I'm",
    "start": "2168480",
    "end": "2175520"
  },
  {
    "text": "going to expose an oo permission scope uh which is yes so I'm going to expose",
    "start": "2175520",
    "end": "2182560"
  },
  {
    "text": "an O permission scope um so that when I ask for a token um it will allow that",
    "start": "2182560",
    "end": "2188640"
  },
  {
    "text": "scope to go through and down here this is where I",
    "start": "2188640",
    "end": "2193960"
  },
  {
    "text": "can Expose and the oo o code flow so I will say that you are a single page",
    "start": "2193960",
    "end": "2199800"
  },
  {
    "text": "application and your redirect URI is going to be like the Local Host one and",
    "start": "2199800",
    "end": "2205640"
  },
  {
    "text": "you've probably had to do this with if anyone here's use like um even using uh oo or um OCTA like you have to set these",
    "start": "2205640",
    "end": "2212920"
  },
  {
    "text": "kinds of things up in order to enable local development to authenticate against some other ident provider over",
    "start": "2212920",
    "end": "2218359"
  },
  {
    "text": "there I have to enable these are the these are the allowable redirect uis for this",
    "start": "2218359",
    "end": "2224280"
  },
  {
    "text": "resource this one is the actual um the real application out there when it's",
    "start": "2224280",
    "end": "2229640"
  },
  {
    "text": "deployed and this one is the like Local Host this is my local uh debugging",
    "start": "2229640",
    "end": "2236119"
  },
  {
    "text": "one okay so um now that I've got the OA floats oath flow setup uh in order for",
    "start": "2236280",
    "end": "2244960"
  },
  {
    "text": "me to assign permissions to this and have permissions assign to it I need to graduate my registration to what's known",
    "start": "2244960",
    "end": "2252240"
  },
  {
    "text": "as a principal or a service principal so I'm going to create a server service",
    "start": "2252240",
    "end": "2259319"
  },
  {
    "text": "principle so that my application can both run as that service principal and there's something I can be assigned",
    "start": "2259319",
    "end": "2264680"
  },
  {
    "text": "against and I tell you are now a service principal with this application ID and what this does is over in",
    "start": "2264680",
    "end": "2271599"
  },
  {
    "text": "my yes right here this will light up the managed application and",
    "start": "2271599",
    "end": "2278960"
  },
  {
    "text": "application ID over here so having these things lit up means now I can assign this thing is now a resource that can be",
    "start": "2278960",
    "end": "2286119"
  },
  {
    "text": "uh that you can now assign permissions to and be authorized against",
    "start": "2286119",
    "end": "2292920"
  },
  {
    "text": "yes okay so um this last piece is saying okay um",
    "start": "2292920",
    "end": "2300319"
  },
  {
    "text": "when I am running this application uh using o code with pkc those those",
    "start": "2300319",
    "end": "2305920"
  },
  {
    "text": "application clients will be something different and so there are some very magical client IDs that you need to add",
    "start": "2305920",
    "end": "2312240"
  },
  {
    "text": "and so this is what I'm adding here is like there's a quote welln so if you Google that goid you'll have like a ton",
    "start": "2312240",
    "end": "2317800"
  },
  {
    "text": "of stack Overflow results and say hey you need to put this in here because when Visual Studio asks for a token it's",
    "start": "2317800",
    "end": "2323800"
  },
  {
    "text": "different than like something else asking for a token so I need to make sure that this like well-known Visual Studio One",
    "start": "2323800",
    "end": "2331800"
  },
  {
    "text": "or there's like several of these um like there's one for visual studio code",
    "start": "2332040",
    "end": "2337720"
  },
  {
    "text": "there's one for visual studio with uh this MSA stuff there's also one for the um for the Azure CLI and Powershell so",
    "start": "2337720",
    "end": "2345319"
  },
  {
    "text": "like you'll just need to if you're trying to call your AP and authenticate against your resource you'll have to",
    "start": "2345319",
    "end": "2350760"
  },
  {
    "text": "then add those as pre-authorized well-known clients that can call for",
    "start": "2350760",
    "end": "2355839"
  },
  {
    "text": "that okay so the last thing I want to do is I as my in ID user Jimmy uh myself I",
    "start": "2355839",
    "end": "2363280"
  },
  {
    "text": "want to be granted those roles whenever I ask for uh token for this resource so",
    "start": "2363280",
    "end": "2369160"
  },
  {
    "text": "this is something that is explicit you have to opt in for so back over on my stack here um when I create my Azure",
    "start": "2369160",
    "end": "2378560"
  },
  {
    "text": "resources oh no not that not that one oh yes not that",
    "start": "2378560",
    "end": "2384880"
  },
  {
    "text": "one my Azure ID resources that's the",
    "start": "2384880",
    "end": "2390318"
  },
  {
    "text": "one I get my user principal name from configuration which is just my like the",
    "start": "2391119",
    "end": "2396359"
  },
  {
    "text": "weird on Microsoft email thing uh and then I'm going to create an Azure ad",
    "start": "2396359",
    "end": "2402440"
  },
  {
    "text": "group it'll be enter ID eventually but like I said it has not filtered down to all these apis and then I'm going to",
    "start": "2402440",
    "end": "2409119"
  },
  {
    "text": "assign my group assign my user to that group the",
    "start": "2409119",
    "end": "2414599"
  },
  {
    "text": "reason why I'm doing this is uh application permissions inside intro ID can be assigned to",
    "start": "2414599",
    "end": "2420200"
  },
  {
    "text": "users groups of users service principles and manage identities so those those",
    "start": "2420200",
    "end": "2426119"
  },
  {
    "text": "like those four things like other applications and Service uh manage identities as well I don't want to have",
    "start": "2426119",
    "end": "2431359"
  },
  {
    "text": "to like every time a new team member comes on board they' have to go like explicitly give them their permissions",
    "start": "2431359",
    "end": "2437280"
  },
  {
    "text": "and so we'll do is like we already have like well-known 80 groups for developers so I want to assign the permissions to",
    "start": "2437280",
    "end": "2442680"
  },
  {
    "text": "that group and then anyone gets that joins that group then gets these permissions so back over here we can see",
    "start": "2442680",
    "end": "2448880"
  },
  {
    "text": "that if I go over to uh app rolls well let me get to no not through",
    "start": "2448880",
    "end": "2455760"
  },
  {
    "text": "here I have to go back up to the manage",
    "start": "2455760",
    "end": "2461359"
  },
  {
    "text": "application Enterprise application and then when we see the roles now users and",
    "start": "2461359",
    "end": "2468280"
  },
  {
    "text": "groups this is one I I know oh here we go so that tells me that these are the different uh principles that have been",
    "start": "2468280",
    "end": "2475319"
  },
  {
    "text": "assigned different roles so here I have a Azure ad group that has been assigned the to- do. read and to- do. right and",
    "start": "2475319",
    "end": "2481720"
  },
  {
    "text": "how do those get assigned well because palumi is an object oriented language over in my server object",
    "start": "2481720",
    "end": "2488240"
  },
  {
    "text": "I will have a method that says you know you can assign read which gives the ID",
    "start": "2488240",
    "end": "2496520"
  },
  {
    "text": "of the role the ID of the principal and the ID of the server R so there's like",
    "start": "2496520",
    "end": "2502520"
  },
  {
    "text": "some table somewhere that's like there's a permission there's a uh the thing that's being assigned and then the",
    "start": "2502520",
    "end": "2508280"
  },
  {
    "text": "assign e the sign ER yes so I need those three pieces of information to connect the role the uh application and the",
    "start": "2508280",
    "end": "2516079"
  },
  {
    "text": "principal resource that is getting assign that permission so I created two methods assign read and side right and for local Dev I have a method called",
    "start": "2516079",
    "end": "2523240"
  },
  {
    "text": "assign roles that is going to assign the read and write roles for this based on",
    "start": "2523240",
    "end": "2531359"
  },
  {
    "text": "the local Dev group name and the local Dev group object ID which is again a",
    "start": "2531359",
    "end": "2536880"
  },
  {
    "text": "very important thing you have to keep track of here but because I'm in pumi I can connect these pieces much more easily than copying and pasting Goods",
    "start": "2536880",
    "end": "2543640"
  },
  {
    "text": "everywhere so back over here in my stack I will say server. assign roles to",
    "start": "2543640",
    "end": "2551200"
  },
  {
    "text": "the Azure adid resources and that's going to perform that operation to connect those pieces that eventually results in this table",
    "start": "2551200",
    "end": "2559680"
  },
  {
    "text": "here okay so let's go back over here to our server now with all this in place um I",
    "start": "2560280",
    "end": "2568440"
  },
  {
    "text": "should be able to authorize click this button get the special scope which is",
    "start": "2568440",
    "end": "2574040"
  },
  {
    "text": "only there to support the specific flow I've already authenticated uh so it's already done this I close and now I can",
    "start": "2574040",
    "end": "2581960"
  },
  {
    "text": "call this API with that authorization so I say tried out",
    "start": "2581960",
    "end": "2587520"
  },
  {
    "text": "executes and it will work right",
    "start": "2591160",
    "end": "2598359"
  },
  {
    "text": "now oh I had a breakpoint set yes so I made it inside there and if I go look at the user claims",
    "start": "2599119",
    "end": "2608599"
  },
  {
    "text": "view let me zoom in here yes so here we have the audience the",
    "start": "2610960",
    "end": "2621520"
  },
  {
    "text": "ah audience issuer exp a iio as as acre",
    "start": "2621800",
    "end": "2628520"
  },
  {
    "text": "um and then down here you can see roles to- do. read and to- do. write if I look",
    "start": "2628520",
    "end": "2633800"
  },
  {
    "text": "at the jots let's go hit",
    "start": "2633800",
    "end": "2640680"
  },
  {
    "text": "go it did return the things right here so we got the API stuff back and then",
    "start": "2643440",
    "end": "2648559"
  },
  {
    "text": "let's go look at this token oh go away no if I get this token I'll go load it",
    "start": "2648559",
    "end": "2655960"
  },
  {
    "text": "up in a jot uh viewer",
    "start": "2655960",
    "end": "2662240"
  },
  {
    "text": "jotm yes and let me get rid of the other",
    "start": "2662240",
    "end": "2668000"
  },
  {
    "text": "junk ah",
    "start": "2668000",
    "end": "2673290"
  },
  {
    "text": "[Music] and do I need more stuff REM moves there",
    "start": "2673290",
    "end": "2679079"
  },
  {
    "text": "we go and sure enough there's my rolls claim now if",
    "start": "2679079",
    "end": "2685960"
  },
  {
    "text": "you're if you use like other ooth flows you'll see like uh just different claims coming in um with different Scopes uh so",
    "start": "2685960",
    "end": "2693000"
  },
  {
    "text": "we're not using those scope things we're using the rolls claim so it comes in as array of these are the roles that my",
    "start": "2693000",
    "end": "2699319"
  },
  {
    "text": "user has been assigned to that server resource these two individual roles",
    "start": "2699319",
    "end": "2705440"
  },
  {
    "text": "there's a question in the back yes",
    "start": "2705440",
    "end": "2709400"
  },
  {
    "text": "so the question is like it basically comes down to the design of your permissions that is 100% a like design",
    "start": "2728119",
    "end": "2735400"
  },
  {
    "text": "exercise about what they should be for your system and I can't answer that it is entirely dependent upon what things",
    "start": "2735400",
    "end": "2742599"
  },
  {
    "text": "you're doing and what how much granularity do you want between the different operations in your application you may just say like all like if you",
    "start": "2742599",
    "end": "2750599"
  },
  {
    "text": "can acquire my token then I don't care just everything for this one we did have at least like three or four levels of",
    "start": "2750599",
    "end": "2755960"
  },
  {
    "text": "different um kinds of data we wanted to protect and so we we had like those different levels in our permissions as",
    "start": "2755960",
    "end": "2762400"
  },
  {
    "text": "well so these are again very different than like application permissions that it would assign to like an application",
    "start": "2762400",
    "end": "2768559"
  },
  {
    "text": "these are things are service to service communication inside of azure all right so um great so I can",
    "start": "2768559",
    "end": "2776359"
  },
  {
    "text": "actually run and test my application huzzah uh the next thing we want to look at is the other actual calling client",
    "start": "2776359",
    "end": "2782559"
  },
  {
    "text": "applications so let me go and stop this",
    "start": "2782559",
    "end": "2787760"
  },
  {
    "text": "and then that's all we needed to do for the server the server's done it's it's now authorizing calls against uh enter",
    "start": "2787920",
    "end": "2793720"
  },
  {
    "text": "ID authorizing against that uh that client ID so let's next next look at the",
    "start": "2793720",
    "end": "2800040"
  },
  {
    "text": "external client so the external client is just represented as a console application so this is just a console",
    "start": "2800040",
    "end": "2807559"
  },
  {
    "text": "worker application so it's like imagine a demon application or on-prem whatever but it's outside of",
    "start": "2807559",
    "end": "2813319"
  },
  {
    "text": "azure so uh if I'm out side of azure and I'm and I'm um you know trying to",
    "start": "2813319",
    "end": "2820920"
  },
  {
    "text": "acquire token for something uh using Azure intra ID um then I'm going to be",
    "start": "2820920",
    "end": "2826280"
  },
  {
    "text": "using this package the microsoft. identity. client uh Library um if you're",
    "start": "2826280",
    "end": "2831880"
  },
  {
    "text": "you know also trying to get uh tokens for any kind of a Azure resource outside of azure that's the package you're going",
    "start": "2831880",
    "end": "2837680"
  },
  {
    "text": "to be using as well um the the next package I'll show uh just uses this underneath the covers but this lets me",
    "start": "2837680",
    "end": "2844119"
  },
  {
    "text": "easily acquire tokens for Azure resources so the first thing I have to do is um",
    "start": "2844119",
    "end": "2850800"
  },
  {
    "text": "configure my Azure uh resources to uh identify this individual external",
    "start": "2850800",
    "end": "2857000"
  },
  {
    "text": "clients so over here in my infrastructure if I go to my external clients again I'm creating an app",
    "start": "2857000",
    "end": "2864839"
  },
  {
    "text": "registration so this is like identifiable principle that wants to acquire a",
    "start": "2864839",
    "end": "2870720"
  },
  {
    "text": "token and this time instead of me doing a like oo flow with o code pkc instead",
    "start": "2870800",
    "end": "2877200"
  },
  {
    "text": "I'm going to be using uh secrets so in this case I'm going to be creating an application",
    "start": "2877200",
    "end": "2884160"
  },
  {
    "text": "password to use for uh client credentials flows so you need a client",
    "start": "2884280",
    "end": "2889359"
  },
  {
    "text": "ID and a client secret this is going to be my client secret and then finally I hook this up",
    "start": "2889359",
    "end": "2896079"
  },
  {
    "text": "to a managed service principle here we go um that says now I'm a thing that can be uh they can both assign permissions",
    "start": "2896079",
    "end": "2902359"
  },
  {
    "text": "to and permissions for that's this piece so over in",
    "start": "2902359",
    "end": "2909599"
  },
  {
    "text": "my um here so you won't see here we go this is my external Client app registration so this app registration",
    "start": "2910440",
    "end": "2917240"
  },
  {
    "text": "includes a secret now you don't have to use secrets you can use certificates as well uh I think we wind up using",
    "start": "2917240",
    "end": "2923400"
  },
  {
    "text": "certificates in some cases and secrets in others just going to depend on who you were but this now creates this this",
    "start": "2923400",
    "end": "2928960"
  },
  {
    "text": "client secret with this value uh whatever so when I want to acquire a token I need to include that secret so",
    "start": "2928960",
    "end": "2936000"
  },
  {
    "text": "how do I acquire that token um so this application again it's a demon application the client",
    "start": "2936000",
    "end": "2941319"
  },
  {
    "text": "application uh oh we need to assign the roles so in this external client what I've done is my server object assigns",
    "start": "2941319",
    "end": "2949359"
  },
  {
    "text": "client group roles but I'm going to only allow read just to highlight like",
    "start": "2949359",
    "end": "2956000"
  },
  {
    "text": "there's some clients that have different permissions so its token it gets back will only include the to-do do read uh",
    "start": "2956000",
    "end": "2962559"
  },
  {
    "text": "the rooll value all right so over here in my external",
    "start": "2962559",
    "end": "2968559"
  },
  {
    "text": "clients um so I'm going to be using an HTTP client to uh make these API calls",
    "start": "2968559",
    "end": "2973760"
  },
  {
    "text": "to my server um so my client secret I'm going to be using user Secrets like",
    "start": "2973760",
    "end": "2979839"
  },
  {
    "text": "you'd probably using some I don't know what you'd be using but um so we want to make sure that secret is secret so that's where it's going to be getting",
    "start": "2979839",
    "end": "2985440"
  },
  {
    "text": "the secret from so that takes the secret from user secrets and adds it to configuration uh and then I've got a",
    "start": "2985440",
    "end": "2991680"
  },
  {
    "text": "worker so a worker that will be calling the API it will be saying okay I want to get a",
    "start": "2991680",
    "end": "2997160"
  },
  {
    "text": "to-do items clients this is using the typed HTP clients um pattern here and",
    "start": "2997160",
    "end": "3002839"
  },
  {
    "text": "then I'll be calling get async just to get a single to-do item and then if it uh then it'll try to put it so it try to",
    "start": "3002839",
    "end": "3009200"
  },
  {
    "text": "make a right it does not have authorization to make that right so we want to make sure that we get a 403 here",
    "start": "3009200",
    "end": "3016078"
  },
  {
    "text": "unauthorized so how does this HP client get set up I wanted to make sure that my",
    "start": "3016559",
    "end": "3022119"
  },
  {
    "text": "users my developers didn't have to like manually add Bearer tokens everywhere and acquire the whatever so what I've",
    "start": "3022119",
    "end": "3027160"
  },
  {
    "text": "done is uh configured an htb client to add",
    "start": "3027160",
    "end": "3033000"
  },
  {
    "text": "some middleware to automatically acquire that token so I'm going to create first",
    "start": "3033000",
    "end": "3038040"
  },
  {
    "text": "This Confidential client application so this is a this is from the Microsoft identity client Library this is the",
    "start": "3038040",
    "end": "3044960"
  },
  {
    "text": "piece of code that will allow me to acquire a token for resources so it says I'm going to acquire a token for this",
    "start": "3044960",
    "end": "3050680"
  },
  {
    "text": "client ID this client ID is this now and then I'm going to be acquiring a token",
    "start": "3050680",
    "end": "3056480"
  },
  {
    "text": "for for this other server application so that is the ID of the server that I'm going to be",
    "start": "3056480",
    "end": "3063838"
  },
  {
    "text": "calling uh so we set up some configuration options so I say um these",
    "start": "3065280",
    "end": "3070359"
  },
  {
    "text": "different op options objects that are going to be uh the uh client ID client",
    "start": "3070359",
    "end": "3075640"
  },
  {
    "text": "secret as well as the URLs those are coming from there um and then we're going to be setting up our middleware so",
    "start": "3075640",
    "end": "3081280"
  },
  {
    "text": "I'm going to be adding these off handlers and these off handlers are the things actually going",
    "start": "3081280",
    "end": "3087280"
  },
  {
    "text": "to get the token so this is now HTTP client middleware these delegating handlers and then it depends on an i",
    "start": "3087280",
    "end": "3094400"
  },
  {
    "text": "confidential client application that comes from Microsoft identity clients and that is the that is the object I can",
    "start": "3094400",
    "end": "3100200"
  },
  {
    "text": "use to acquire tokens in my uh server code so here I'm going to say I want to",
    "start": "3100200",
    "end": "3106240"
  },
  {
    "text": "get this magical scope of the application ID so that's the thing the resource on the other side I want to acquire the token for it's going to",
    "start": "3106240",
    "end": "3113240"
  },
  {
    "text": "acquire token for the clients and then add that value as a bear token out the",
    "start": "3113240",
    "end": "3120440"
  },
  {
    "text": "door so let me run the server and I'll run the",
    "start": "3120440",
    "end": "3126839"
  },
  {
    "text": "client okay server up and running now let's go ahead and start up the",
    "start": "3126960",
    "end": "3133599"
  },
  {
    "text": "client okay so looks like it succeeded the first time and then the second time",
    "start": "3138480",
    "end": "3144760"
  },
  {
    "text": "it failed because 403 right so when it tried to do the right it failed because",
    "start": "3144760",
    "end": "3150319"
  },
  {
    "text": "I don't have access and I just log the token out here so let's go ahead and go to jot Ms",
    "start": "3150319",
    "end": "3158280"
  },
  {
    "text": "again jot Ms",
    "start": "3158280",
    "end": "3165319"
  },
  {
    "text": "and we can see here that my roles now only include read because I've only assigned that role to this external",
    "start": "3165319",
    "end": "3172400"
  },
  {
    "text": "client resource I like the other uh person asked like this is this is the part is",
    "start": "3172400",
    "end": "3178520"
  },
  {
    "text": "like really up to you about how you like to Define these different ones uh oer and OCTA have a similar kind of",
    "start": "3178520",
    "end": "3183720"
  },
  {
    "text": "definition where you can do your own role-based authorization controls and so that's what I'm doing here is I am defining my own arbac for my",
    "start": "3183720",
    "end": "3190839"
  },
  {
    "text": "applications and so it's really up to you what you decide Mak sense for those",
    "start": "3190839",
    "end": "3197040"
  },
  {
    "text": "roles the audience this is the server it's calling and then the I don't remember what all these the",
    "start": "3197440",
    "end": "3203559"
  },
  {
    "text": "subject which is me is that other ID there the other IDs mean stuff as well but I",
    "start": "3203559",
    "end": "3210440"
  },
  {
    "text": "forget all right so that is client ID uh client secret the client",
    "start": "3210599",
    "end": "3218040"
  },
  {
    "text": "credentials flow for an external client outside of aure but it turns out if I'm inside of Aer acquiring these tokens",
    "start": "3218040",
    "end": "3224480"
  },
  {
    "text": "there's a much easier way of doing so where you don't have to manage all these different secrets of course we can use",
    "start": "3224480",
    "end": "3230720"
  },
  {
    "text": "certificates but those also expire as well um what uh we can do in Azure is use a tool or a um a resource available",
    "start": "3230720",
    "end": "3239040"
  },
  {
    "text": "to us known as managed identities so managed identities are something that I've used for quite a long time in order",
    "start": "3239040",
    "end": "3245520"
  },
  {
    "text": "to make sure that like not anyone can access my database and keyal I create this managed identity thing and then my",
    "start": "3245520",
    "end": "3251760"
  },
  {
    "text": "app service Azure container app whatever will then use those managed identities to to authorize against you know SQL key",
    "start": "3251760",
    "end": "3259839"
  },
  {
    "text": "Vault whatever but I can also use those same managed identities to assign roles or um for the INRI ID like these custom",
    "start": "3259839",
    "end": "3268640"
  },
  {
    "text": "uh role-based authorizations so what does that look like well first we need to set up all the Azure resources that's going to be",
    "start": "3268640",
    "end": "3275240"
  },
  {
    "text": "in this client here so this client is going to be running inside of azure so it's going to",
    "start": "3275240",
    "end": "3281839"
  },
  {
    "text": "be running as an Azure app service I just picked one that was easy but it's going to be using an app service most of",
    "start": "3281839",
    "end": "3287280"
  },
  {
    "text": "it is pretty normal sort of setup like okay it's HPS only enabled uh net Azure",
    "start": "3287280",
    "end": "3293079"
  },
  {
    "text": "clients uh but the important thing is I need to say okay asure web app you're going to be running under a specific",
    "start": "3293079",
    "end": "3299720"
  },
  {
    "text": "managed identity uh in this case I'm creating a user assigned identity which is like identity I make up but you don't",
    "start": "3299720",
    "end": "3305119"
  },
  {
    "text": "have to do that it could be any managed identity so I say I want to create a user assigned identity uh that is now",
    "start": "3305119",
    "end": "3312319"
  },
  {
    "text": "you know defined inside of in ID and I'm going to assign this managed identity to",
    "start": "3312319",
    "end": "3318000"
  },
  {
    "text": "this Azure app service so down here I say okay your you",
    "start": "3318000",
    "end": "3324119"
  },
  {
    "text": "web app are going to have this identity it's going to be a user assigned the other one is like a system assigned",
    "start": "3324119",
    "end": "3331079"
  },
  {
    "text": "system assigned uncore user assigned I guess you could do both or none um default is none of course you don't",
    "start": "3331079",
    "end": "3336599"
  },
  {
    "text": "always run under a managed identity but I'm gonna say I'm gonna I'm going to tell you're going to run as this managed",
    "start": "3336599",
    "end": "3342280"
  },
  {
    "text": "identity so when I look at my app service and Azure",
    "start": "3342280",
    "end": "3347640"
  },
  {
    "text": "Azure I can look at this client",
    "start": "3347640",
    "end": "3352760"
  },
  {
    "text": "here and I go over and look at the",
    "start": "3353880",
    "end": "3359000"
  },
  {
    "text": "identity oh we can see that it oh God go away no",
    "start": "3359000",
    "end": "3366319"
  },
  {
    "text": "we can see that it's running under a user assigned identity and this is the name of that user assigned identity I can go click this and now I'm an ENT ID",
    "start": "3366319",
    "end": "3373200"
  },
  {
    "text": "Lan this is this manage identity and this manage identity is going to have this very important client ID uh so I",
    "start": "3373200",
    "end": "3379760"
  },
  {
    "text": "need to assign that client ID those permissions for that server resource I'll do that again here in my",
    "start": "3379760",
    "end": "3387000"
  },
  {
    "text": "palumi code so over in my server I Define a method for",
    "start": "3387000",
    "end": "3394960"
  },
  {
    "text": "assign roles to the client now the client is going to be assigned read and",
    "start": "3394960",
    "end": "3400280"
  },
  {
    "text": "write both of those so my client running a site of azure wants to acquire these",
    "start": "3400280",
    "end": "3405559"
  },
  {
    "text": "tokens it will acquire these tokens as this managed identity and will be assigned those two individual",
    "start": "3405559",
    "end": "3413520"
  },
  {
    "text": "roles so the client now needs to be configured to set this up and the way I decided to set this up is this Azure",
    "start": "3413520",
    "end": "3418680"
  },
  {
    "text": "client is still done at eight8 but it's also a web application this is my BFF so pretend like this is using a real",
    "start": "3418680",
    "end": "3425000"
  },
  {
    "text": "authentication and authorization for the its incoming calls but I didn't do that I just turned it all off so I just",
    "start": "3425000",
    "end": "3430839"
  },
  {
    "text": "merely exposed out apis that don't do any kind of authentication or authorization and just calls the",
    "start": "3430839",
    "end": "3437440"
  },
  {
    "text": "underlying clients directly so my twoo items no authentication authorization",
    "start": "3437440",
    "end": "3443319"
  },
  {
    "text": "this is just to say I can acquire token as a manage identity so you know really I would have something but I don't in this one so yeah it's no authentication",
    "start": "3443319",
    "end": "3450920"
  },
  {
    "text": "authorization but again I want to configure my uh HTTP clients to",
    "start": "3450920",
    "end": "3456359"
  },
  {
    "text": "automatically acquire those tokens this is going to be another library for Microsoft because if you are",
    "start": "3456359",
    "end": "3462680"
  },
  {
    "text": "now using managed identities to acquire tokens now you graduate up from Microsoft identity client to now Azure",
    "start": "3462680",
    "end": "3469200"
  },
  {
    "text": "do identity this one right here you probably have already used this if you're using manage identities to talk",
    "start": "3469200",
    "end": "3474520"
  },
  {
    "text": "to Azure SQL key Vault whatever um these all used as your identity underneath the",
    "start": "3474520",
    "end": "3480960"
  },
  {
    "text": "covers so um I'm going to do a very similar kind of setup uh here in my HTP clients where",
    "start": "3480960",
    "end": "3487960"
  },
  {
    "text": "I'm going to configure a token acquirer oh wait one do I nope nothing",
    "start": "3487960",
    "end": "3494480"
  },
  {
    "text": "there in which I'm going to now create uh something that needs something that",
    "start": "3494480",
    "end": "3499640"
  },
  {
    "text": "can acquire a a token well this token acquire is known as a token credential",
    "start": "3499640",
    "end": "3505599"
  },
  {
    "text": "so this is is a uh this is one where I use this default AIA credential which is actually a a chain of responsibility so",
    "start": "3505599",
    "end": "3511839"
  },
  {
    "text": "it's a composite of multiple different credential providers it will look at your Visual Studio subscription it will",
    "start": "3511839",
    "end": "3518039"
  },
  {
    "text": "look at your um it will look at your Azure CLI if your C and Azure CLI or it",
    "start": "3518039",
    "end": "3523319"
  },
  {
    "text": "can look at vs code credential um or if you're running in manage identity it'll use that credential instead so it's like",
    "start": "3523319",
    "end": "3530000"
  },
  {
    "text": "I can use all these different kind of credential providers here uh we'll get to this Au yeah let's",
    "start": "3530000",
    "end": "3535640"
  },
  {
    "text": "look at this Handler so this off Handler is another middleware but this time instead of using the uh client",
    "start": "3535640",
    "end": "3542079"
  },
  {
    "text": "application thingy it's using a token credential so I inject a token credential in here and then I do a very",
    "start": "3542079",
    "end": "3548680"
  },
  {
    "text": "similar kind of like setting up the scope I'm looking for so I'm looking for the application ID of the server object",
    "start": "3548680",
    "end": "3555359"
  },
  {
    "text": "so that when I get this token it's now going to be getting uh the token for that specific server application against",
    "start": "3555359",
    "end": "3561640"
  },
  {
    "text": "my manage Identity or my user if I'm running inside Visual Studio",
    "start": "3561640",
    "end": "3566760"
  },
  {
    "text": "so with this in place now in my uh configuration here I",
    "start": "3566760",
    "end": "3573280"
  },
  {
    "text": "will tell uh I will give my HP clients strongly type HP clients uh this",
    "start": "3573280",
    "end": "3581160"
  },
  {
    "text": "middleware to execute as part of every single request so now my application code itself has no knowledge of",
    "start": "3581160",
    "end": "3586920"
  },
  {
    "text": "authentication authorization it will just automatically acquire token for me underneath the covers so now let's run",
    "start": "3586920",
    "end": "3593440"
  },
  {
    "text": "the server actually let's go to",
    "start": "3593440",
    "end": "3599440"
  },
  {
    "text": "Azure this is the client here",
    "start": "3599440",
    "end": "3604119"
  },
  {
    "text": "yes and I can execute this try it out this one doesn't have any authentication",
    "start": "3605880",
    "end": "3611359"
  },
  {
    "text": "as part of it like I would be using AO or something but the important part here is it's using its own manage identity to",
    "start": "3611359",
    "end": "3617280"
  },
  {
    "text": "then make those requests and acquire the tokens and we can see that it all works successfully like it was able to call",
    "start": "3617280",
    "end": "3622599"
  },
  {
    "text": "that server and acquire the token appropriately based on it being a manag identity the nice thing about manag",
    "start": "3622599",
    "end": "3627680"
  },
  {
    "text": "identities is it's still oo client credentials underneath the covers like there's no magic there except that",
    "start": "3627680",
    "end": "3633200"
  },
  {
    "text": "client secret you don't have to worry never have to worry about ever again I don't have to worry about managing that secret keeping it safe blah blah blah",
    "start": "3633200",
    "end": "3639839"
  },
  {
    "text": "it's just like it's all managed for me behind the scenes with uh Azure manage identities and so we don't have to worry",
    "start": "3639839",
    "end": "3645760"
  },
  {
    "text": "about all that extra configuration and whatnot as part of our system so I know like a there's a lot of",
    "start": "3645760",
    "end": "3653880"
  },
  {
    "text": "stuff we had to consider as part of this like all the different o off flows and we just we've we managed basically just",
    "start": "3653880",
    "end": "3659319"
  },
  {
    "text": "to do client credentials for our specific scenario but it is one of those things that every time I presented with",
    "start": "3659319",
    "end": "3664960"
  },
  {
    "text": "uh authentication and authorization I have to go back to sort of first principles and say here are my different options what are the ones that are",
    "start": "3664960",
    "end": "3670520"
  },
  {
    "text": "appropriate for my specific application and system so you will like in your own systems you will need uh to do those",
    "start": "3670520",
    "end": "3677039"
  },
  {
    "text": "sort of things like figure out what makes the most sense for your specific application so um I made no guarantees",
    "start": "3677039",
    "end": "3685559"
  },
  {
    "text": "about the demystification so if you have questions afterwards I'll be happy to answer those after this otherwise this",
    "start": "3685559",
    "end": "3691440"
  },
  {
    "text": "specific code you can download you'll have to change like your palumi stuff to run against your specific junk but you",
    "start": "3691440",
    "end": "3697440"
  },
  {
    "text": "can go download that code here at the Azure ad example and this presentation the slides can be found on my presentations repo up there and I",
    "start": "3697440",
    "end": "3704359"
  },
  {
    "text": "blogged exhaustively about this topic as well so you can go check out the blog for all the details too um otherwise uh",
    "start": "3704359",
    "end": "3710880"
  },
  {
    "text": "thank you all very much for coming um I appreciate everyone's time here and uh yeah youall have a great uh weekend",
    "start": "3710880",
    "end": "3716119"
  },
  {
    "text": "because we're done right all right thanks everyone",
    "start": "3716119",
    "end": "3721799"
  }
]