[
  {
    "text": "so welcome to uh surprising ways to escalate privileges in entro ID to those",
    "start": "5200",
    "end": "13040"
  },
  {
    "text": "of you that didn't know entro ID is the new name of aactive directory I don't",
    "start": "13040",
    "end": "18119"
  },
  {
    "text": "know how long we will say that but uh it was renamed in in the last summer so I",
    "start": "18119",
    "end": "25039"
  },
  {
    "text": "guess most of you knew that already uh my name is Marin me",
    "start": "25039",
    "end": "30720"
  },
  {
    "text": "uh I'm a CO co-founder in of 42 and a principal Cloud engineer there I'm also",
    "start": "30720",
    "end": "36200"
  },
  {
    "text": "a Microsoft MVP in security um been working in Microsoft identity for 15",
    "start": "36200",
    "end": "43840"
  },
  {
    "text": "years or something and I do some tech blogging on goodwork ground.com",
    "start": "43840",
    "end": "50600"
  },
  {
    "text": "so what we will talk about today is um essentially misconfigurations and",
    "start": "50600",
    "end": "58280"
  },
  {
    "text": "different patterns leading to um unintentional ways that your users",
    "start": "58280",
    "end": "64799"
  },
  {
    "text": "or someone that um essentially takes over one of the user accounts in your",
    "start": "64799",
    "end": "70880"
  },
  {
    "text": "tenant May gain access to more stuff than they really should so we will not",
    "start": "70880",
    "end": "77840"
  },
  {
    "text": "be or I actually have a separate slide on what we will not be talking about but um uh we're also going to do um quite a",
    "start": "77840",
    "end": "84600"
  },
  {
    "text": "lot of talk about what to avoid as a developer to either have have",
    "start": "84600",
    "end": "90240"
  },
  {
    "text": "configurations in your customer tenants um if you have that or in your own",
    "start": "90240",
    "end": "95479"
  },
  {
    "text": "tenant um that will lead to these kind of privilege escalation",
    "start": "95479",
    "end": "102000"
  },
  {
    "text": "issues so what we will not talk about is things like fishing and Brute Force attacks and yeah abusing the different",
    "start": "102000",
    "end": "110000"
  },
  {
    "text": "SSO features and social engineering etc etc those kind of more hacking topics um",
    "start": "110000",
    "end": "118840"
  },
  {
    "text": "we will essentially always here I have a lot of demos um but",
    "start": "118840",
    "end": "125119"
  },
  {
    "text": "we will essentially just use buil-in functionality and think that is",
    "start": "125119",
    "end": "131400"
  },
  {
    "text": "intentional by Microsoft but when combined can cause",
    "start": "131400",
    "end": "137840"
  },
  {
    "text": "issues so what is an attack path cuz that is sort of uh crucial in uh in what",
    "start": "137840",
    "end": "144640"
  },
  {
    "text": "we're going to talk about so if we as a uh a hacker of something sort um get",
    "start": "144640",
    "end": "152800"
  },
  {
    "text": "access to a user account and that can be through capturing a temporary session",
    "start": "152800",
    "end": "158160"
  },
  {
    "text": "that you have for 10 minutes that need to find a way to plant a back door or",
    "start": "158160",
    "end": "163519"
  },
  {
    "text": "something like that but you have access to a user then if you could for example find",
    "start": "163519",
    "end": "171800"
  },
  {
    "text": "out that this user is a owner of of an app registration or an app in in entra",
    "start": "171800",
    "end": "179239"
  },
  {
    "text": "uh then you have have some more accesses because the owner role um is way more",
    "start": "179239",
    "end": "185480"
  },
  {
    "text": "privileged than at least many people that I've talked to um thought before I",
    "start": "185480",
    "end": "190959"
  },
  {
    "text": "talked to them um and um if that app registration is also linked to an",
    "start": "190959",
    "end": "197840"
  },
  {
    "text": "Enterprise app with some uh privileged um roles the hacker can",
    "start": "197840",
    "end": "203560"
  },
  {
    "text": "essentially uh add a secret he can become that app and and um um with with",
    "start": "203560",
    "end": "212360"
  },
  {
    "text": "this listed um um with this listed scope here this privilege role read write",
    "start": "212360",
    "end": "218720"
  },
  {
    "text": "directory he can assign himself Global admin uh that's not",
    "start": "218720",
    "end": "225599"
  },
  {
    "text": "good uh and uh of course sometimes there are way more advanced attack paths so he",
    "start": "225599",
    "end": "232680"
  },
  {
    "text": "might have access to a uh device um could also be temporarily through some",
    "start": "232680",
    "end": "239079"
  },
  {
    "text": "kind of fishing or some kind of way that he can run stuff as a user and he can",
    "start": "239079",
    "end": "245760"
  },
  {
    "text": "use the same uh the same way as an owner then he finds another um axis organization read write",
    "start": "245760",
    "end": "253560"
  },
  {
    "text": "all so that axis has a uh the ability to add a trusted root certificate to your",
    "start": "253560",
    "end": "260120"
  },
  {
    "text": "tenant and if as you can see there's two arrows from the attacker um certificate based",
    "start": "260120",
    "end": "266720"
  },
  {
    "text": "authentication is actually enabled in our tenant he can essentially impersonate that",
    "start": "266720",
    "end": "272840"
  },
  {
    "text": "user um or some other user that has access to something else so there's many",
    "start": "272840",
    "end": "278520"
  },
  {
    "text": "ways to um climb in Privileges and we're",
    "start": "278520",
    "end": "284120"
  },
  {
    "text": "talking a lot about uh entra ID roles here for example Global admin um but",
    "start": "284120",
    "end": "290000"
  },
  {
    "text": "there are many other things as well but the focus here will be on uh on uh",
    "start": "290000",
    "end": "296160"
  },
  {
    "text": "gaining Global admin but just think that but this also be access to your more",
    "start": "296160",
    "end": "303000"
  },
  {
    "text": "like business data or content in a 365 group team",
    "start": "303000",
    "end": "309800"
  },
  {
    "text": "Etc so in enter ID we have uh 105 different roles so now we're going to go",
    "start": "309960",
    "end": "315520"
  },
  {
    "text": "through each and every one of them no we're not going to do that but",
    "start": "315520",
    "end": "321199"
  },
  {
    "text": "um there are a few or there are three of these that are sort of the most uh",
    "start": "321199",
    "end": "326560"
  },
  {
    "text": "critical ones um everyone's heard of global administrator",
    "start": "326560",
    "end": "333319"
  },
  {
    "text": "but you also have this privileged role administrator and privileged authentication administrator that are",
    "start": "333319",
    "end": "338720"
  },
  {
    "text": "essentially the same thing they they don't have the global administrator permissions but they can just reset a",
    "start": "338720",
    "end": "345039"
  },
  {
    "text": "password of a global admin or assign themselves Global admin and um they",
    "start": "345039",
    "end": "350280"
  },
  {
    "text": "should be treated the same exact way and then you have roles like user",
    "start": "350280",
    "end": "355560"
  },
  {
    "text": "administrator so the user admin can uh he can create users and update and",
    "start": "355560",
    "end": "362360"
  },
  {
    "text": "delete them reset passwords uh he um cannot do that for",
    "start": "362360",
    "end": "368720"
  },
  {
    "text": "for example a global admin so there are some protection in place meaning that if",
    "start": "368720",
    "end": "374479"
  },
  {
    "text": "I have Global administrator and I give one of you guys user administrator you",
    "start": "374479",
    "end": "379560"
  },
  {
    "text": "cannot reset my password that's a good thing um for those who didn't didn't",
    "start": "379560",
    "end": "387199"
  },
  {
    "text": "know a user administrator can also manage group and by managing groups he can um add",
    "start": "387199",
    "end": "394000"
  },
  {
    "text": "himself to groups and get access to a lot of stuff so um U we're going to talk a bit about how",
    "start": "394000",
    "end": "401440"
  },
  {
    "text": "we can limit our uh administrators inside our tenant for",
    "start": "401440",
    "end": "408400"
  },
  {
    "text": "example through something called administrative units uh and um uh we have",
    "start": "408400",
    "end": "415800"
  },
  {
    "text": "authentication administrator also scary rooll can reset the fa details and create temporary access passes which is",
    "start": "415800",
    "end": "423400"
  },
  {
    "text": "essentially a one-time password that the user will never see but I will be able to sign in as all",
    "start": "423400",
    "end": "429599"
  },
  {
    "text": "users and groups administrator an application administrator and a lot",
    "start": "429599",
    "end": "436319"
  },
  {
    "text": "more uh and all of these are very interesting uh targets for an",
    "start": "436319",
    "end": "444520"
  },
  {
    "text": "attacker uh who uses privileged identity management",
    "start": "444520",
    "end": "450280"
  },
  {
    "text": "yeah about tough I would say that's good uh who doesn't know what it is",
    "start": "450280",
    "end": "459080"
  },
  {
    "text": "it's yeah so the point of uh a few uh so the point of Pim privilege identity",
    "start": "459080",
    "end": "467199"
  },
  {
    "text": "management is for uh for you to be able to say that a certain user can activate",
    "start": "467199",
    "end": "474599"
  },
  {
    "text": "their permissions so they have the permissions um or the ability to activate at at will",
    "start": "474599",
    "end": "481840"
  },
  {
    "text": "uh but you can set some policies you can say well in order to activate Global administrator in our tenant um one of",
    "start": "481840",
    "end": "489680"
  },
  {
    "text": "the other people that can activate Global admin must approve which is a",
    "start": "489680",
    "end": "495479"
  },
  {
    "text": "many people think that is a bit of a hassle um but it helps greatly so uh through through through",
    "start": "495479",
    "end": "504759"
  },
  {
    "text": "this um um way of pming things we have a few",
    "start": "504759",
    "end": "510319"
  },
  {
    "text": "interesting things that I will show you so protected roles let's find which user",
    "start": "510319",
    "end": "517080"
  },
  {
    "text": "we are going to have we're going to do a user admin so it's a bit small let's do",
    "start": "517080",
    "end": "524320"
  },
  {
    "text": "something like this so we have a user and um um I gone into Pim my",
    "start": "524320",
    "end": "531959"
  },
  {
    "text": "roles uh and um this user has no eligible assignments meaning that",
    "start": "531959",
    "end": "537720"
  },
  {
    "text": "there's no nothing that the use user can go and activate at this time but instead",
    "start": "537720",
    "end": "543040"
  },
  {
    "text": "we have an active assignment of user administrator so let's see what we can",
    "start": "543040",
    "end": "549519"
  },
  {
    "text": "do with this account so I have a few users in my",
    "start": "549519",
    "end": "554720"
  },
  {
    "text": "tenant called [Laughter]",
    "start": "554720",
    "end": "560360"
  },
  {
    "text": "Target so we're going to start at number one um let's have a look at this user so",
    "start": "560360",
    "end": "567240"
  },
  {
    "text": "he has an active assignment a global administrator so on the user directly",
    "start": "567240",
    "end": "573680"
  },
  {
    "text": "assigned active all the time um super nice to get a hold of one of these",
    "start": "573680",
    "end": "581399"
  },
  {
    "text": "accounts so as a user admin let's try to click reset password no I cannot do that",
    "start": "581399",
    "end": "588519"
  },
  {
    "text": "luckily okay so let's try Target number two",
    "start": "588519",
    "end": "593800"
  },
  {
    "text": "because there's many ways of assigning these roles in uh in entro ID so as you can see here he has no active",
    "start": "593800",
    "end": "600880"
  },
  {
    "text": "assignments so um right now this account is sort of useless until he activates",
    "start": "600880",
    "end": "607440"
  },
  {
    "text": "the role um but still if we TR go and try and reset the password doesn't work so",
    "start": "607440",
    "end": "614440"
  },
  {
    "text": "the pro protection uh also goes through these um uh eligible",
    "start": "614440",
    "end": "620560"
  },
  {
    "text": "assignments so that's also good uh let's try number",
    "start": "620560",
    "end": "625640"
  },
  {
    "text": "three so this person has an elgible assignment um but through a group so",
    "start": "625640",
    "end": "633920"
  },
  {
    "text": "meaning that we actually now have a group membership so you have something called role assignable groups in anra",
    "start": "633920",
    "end": "640399"
  },
  {
    "text": "and this person is a member of that group um and uh and can activate the",
    "start": "640399",
    "end": "646720"
  },
  {
    "text": "rooll let's try to reset the password also doesn't work",
    "start": "646720",
    "end": "652680"
  },
  {
    "text": "great have anyone heard of Pim for",
    "start": "652680",
    "end": "657760"
  },
  {
    "text": "groups yeah 10% or something so in entra",
    "start": "657760",
    "end": "663680"
  },
  {
    "text": "you have or in entra ID you have the option of enabling groups",
    "start": "663680",
    "end": "670120"
  },
  {
    "text": "for um or essentially making your group membership also an elegible assignment",
    "start": "670120",
    "end": "677680"
  },
  {
    "text": "so that means that you can for example become a member of this Design Group if",
    "start": "677680",
    "end": "683200"
  },
  {
    "text": "or activate that group membership for two hours and do something sign into an application that",
    "start": "683200",
    "end": "690040"
  },
  {
    "text": "um does something with this group or something like that this can be combined",
    "start": "690040",
    "end": "696320"
  },
  {
    "text": "with um these um privileged uh role",
    "start": "696320",
    "end": "701800"
  },
  {
    "text": "assigned groups so I have two groups here priv vendor one and prve wendor",
    "start": "701800",
    "end": "708800"
  },
  {
    "text": "two um so if we look at this uh this group uh it's if you go to",
    "start": "708800",
    "end": "715959"
  },
  {
    "text": "assignments it's eligible to become global administrator and if we look at members",
    "start": "715959",
    "end": "723120"
  },
  {
    "text": "we see Target 3 is a member so that was our first group that we talked about now let's look at this vendor two which is",
    "start": "723120",
    "end": "731320"
  },
  {
    "text": "uh the one that was many numbers here now but this target for our last Global",
    "start": "731320",
    "end": "737199"
  },
  {
    "text": "admin that we want to try to breach if we go",
    "start": "737199",
    "end": "743240"
  },
  {
    "text": "to privilege identity management on this vendor two group it has no active",
    "start": "743240",
    "end": "751160"
  },
  {
    "text": "assignments but uh yeah I I don't have access to that this as this user let's",
    "start": "751160",
    "end": "756800"
  },
  {
    "text": "skip over to the admin let say this one same group just as a global",
    "start": "756800",
    "end": "764480"
  },
  {
    "text": "admin to read it so instead this target four has an legible assignment to become",
    "start": "764480",
    "end": "772240"
  },
  {
    "text": "member of the group ah awesome CU now we can actually take let's say uh a couple",
    "start": "772240",
    "end": "779519"
  },
  {
    "text": "of roles um for assigned roles for that group and uh uh for example assigned",
    "start": "779519",
    "end": "788040"
  },
  {
    "text": "Global admin or a set of roles let's say I want to um have uh my support staff being",
    "start": "788040",
    "end": "796000"
  },
  {
    "text": "able to to essentially just activate this group membership and become user",
    "start": "796000",
    "end": "801240"
  },
  {
    "text": "admin help desk admin something other something else admin exchange admin at",
    "start": "801240",
    "end": "806760"
  },
  {
    "text": "the same time activate once because people are not so happy about activating",
    "start": "806760",
    "end": "813079"
  },
  {
    "text": "five rolls every morning for example but the thing is that this is not a good idea it's actually a very bad",
    "start": "813079",
    "end": "820160"
  },
  {
    "text": "idea it's very user friendly but still a bad idea because what will happen now is",
    "start": "820160",
    "end": "825519"
  },
  {
    "text": "that when I switch back to my user admin and let's find this target for he",
    "start": "825519",
    "end": "834279"
  },
  {
    "text": "is an elgible member of uh of the group and um let's go to",
    "start": "834279",
    "end": "841680"
  },
  {
    "text": "users and um if we try to",
    "start": "841680",
    "end": "847040"
  },
  {
    "text": "reset the password here that works",
    "start": "847040",
    "end": "853000"
  },
  {
    "text": "fine so there's no protection for those",
    "start": "853000",
    "end": "858040"
  },
  {
    "text": "elegible group memberships that again give you some role so that's worth",
    "start": "858040",
    "end": "864759"
  },
  {
    "text": "noting and meaning that if you for example have well you have a vender that you want to assign a lot of",
    "start": "864759",
    "end": "872440"
  },
  {
    "text": "roles don't do it this way uh what you can do which is at least",
    "start": "872440",
    "end": "878079"
  },
  {
    "text": "better is that you first activate the group membership and then the group is",
    "start": "878079",
    "end": "883240"
  },
  {
    "text": "assign eligible roles so you need to sort of do a two-step thing but then it doesn't make sense to do it with a group",
    "start": "883240",
    "end": "889360"
  },
  {
    "text": "anyway so um yeah who why am I opening my",
    "start": "889360",
    "end": "897399"
  },
  {
    "text": "email let's do it like this back here so in",
    "start": "897399",
    "end": "904519"
  },
  {
    "text": "summary um user admin cannot reset passwords for uh for these protected uh",
    "start": "904519",
    "end": "910920"
  },
  {
    "text": "uh roles except through this last method of elegible member",
    "start": "910920",
    "end": "919440"
  },
  {
    "text": "of who here has heard of administrative",
    "start": "922639",
    "end": "927759"
  },
  {
    "text": "units yeah quite a few it's like 30% who here uses administrative",
    "start": "927759",
    "end": "935639"
  },
  {
    "text": "units zero that's what I thought uh so essentially a um",
    "start": "935639",
    "end": "944399"
  },
  {
    "text": "administrative unit is a way to divide your tenant",
    "start": "944399",
    "end": "949639"
  },
  {
    "text": "into essentially not not separate tenants they can see each other and everything but there's new ways of",
    "start": "949639",
    "end": "956000"
  },
  {
    "text": "delegating access so you can for example say that um all of my uh um users of in",
    "start": "956000",
    "end": "964240"
  },
  {
    "text": "HR belong to an administrative unit that I call HR and uh essentially then I can say",
    "start": "964240",
    "end": "972839"
  },
  {
    "text": "that uh the some HR person can get user admin or heal desk admin on that",
    "start": "972839",
    "end": "979560"
  },
  {
    "text": "administrative unit so I can say that these 10 users you can reset the password for but not all of the",
    "start": "979560",
    "end": "986920"
  },
  {
    "text": "others and we have another uh or we have a newer type which is still in preview",
    "start": "986920",
    "end": "992079"
  },
  {
    "text": "called restricted management administrative unit which um um which is",
    "start": "992079",
    "end": "998000"
  },
  {
    "text": "a great new new Option here uh and it essentially uh is a way for you to say",
    "start": "998000",
    "end": "1004360"
  },
  {
    "text": "that everything that belongs to this administrative unit you need need to be explicitly delegated per permissions on",
    "start": "1004360",
    "end": "1012319"
  },
  {
    "text": "that administrative unit in order to modify the objects not even Global admins can go",
    "start": "1012319",
    "end": "1019440"
  },
  {
    "text": "through that they can assign and de assign or unassign groups from the",
    "start": "1019440",
    "end": "1025678"
  },
  {
    "text": "restricted management administrative unit but there's there's a few new new things and why is this",
    "start": "1025679",
    "end": "1031918"
  },
  {
    "text": "important well the thing is that when you start um to to when you need access",
    "start": "1031919",
    "end": "1038880"
  },
  {
    "text": "to something in a tenant you should always try to focus on uh least",
    "start": "1038880",
    "end": "1044600"
  },
  {
    "text": "privilege and um both from a pure like",
    "start": "1044600",
    "end": "1049760"
  },
  {
    "text": "it security point of view but from your own point of view you cannot be blamed",
    "start": "1049760",
    "end": "1055000"
  },
  {
    "text": "for something that you didn't have access to do um that's always nice so",
    "start": "1055000",
    "end": "1060200"
  },
  {
    "text": "let's create some administrative units in our tenant um let's take this account",
    "start": "1060200",
    "end": "1067120"
  },
  {
    "text": "called which is a global admin so under enter ID we have administrative units so",
    "start": "1067120",
    "end": "1073880"
  },
  {
    "text": "I already created two I have an examp this was very small again again example regular Au um which",
    "start": "1073880",
    "end": "1083320"
  },
  {
    "text": "is not of the type restricted restricted management and I have one called the",
    "start": "1083320",
    "end": "1089280"
  },
  {
    "text": "example restricted management Au pretty easy to understand what they do so if we",
    "start": "1089280",
    "end": "1095280"
  },
  {
    "text": "go into this restricted management one which I believe is sort of the most",
    "start": "1095280",
    "end": "1100600"
  },
  {
    "text": "useful type then you see here users groups devices and roles and administrators",
    "start": "1100600",
    "end": "1107360"
  },
  {
    "text": "okay so it's sort of a sub uh so here I can actually add member so",
    "start": "1107360",
    "end": "1112600"
  },
  {
    "text": "I can go in and take any any user for example this this person and add it to",
    "start": "1112600",
    "end": "1120880"
  },
  {
    "text": "this restricted Management Group uh and I can um it will still be sort of on the",
    "start": "1120880",
    "end": "1126679"
  },
  {
    "text": "tenant level as well um and I can also add add groups existing groups so let's",
    "start": "1126679",
    "end": "1133640"
  },
  {
    "text": "take this SG executive that sounds uh important",
    "start": "1133640",
    "end": "1140000"
  },
  {
    "text": "so I'm signed in as a global admin and uh with replication in entro ID this",
    "start": "1140000",
    "end": "1145360"
  },
  {
    "text": "takes a little while sometimes we probably never seen that if you work actively in in entro ID it's coming uh",
    "start": "1145360",
    "end": "1154039"
  },
  {
    "text": "so now we are assigning this uh this group to this restricted management um",
    "start": "1154039",
    "end": "1159440"
  },
  {
    "text": "Au and the point is that what you need to do now is in order to modify this",
    "start": "1159440",
    "end": "1166360"
  },
  {
    "text": "user and this uh this group you must actually have a uh role assigned on the",
    "start": "1166360",
    "end": "1174080"
  },
  {
    "text": "administrative unit so for example here I can see groups administrator there's zero people",
    "start": "1174080",
    "end": "1182000"
  },
  {
    "text": "assigned and if I if I'm not assign groups administrator here I will not be able to modify the groups linked so",
    "start": "1182000",
    "end": "1190400"
  },
  {
    "text": "let's go into this SG executive now and as you can see I'm a global",
    "start": "1190400",
    "end": "1196720"
  },
  {
    "text": "admin doesn't work I don't have a delete option I cannot go in and remove",
    "start": "1196720",
    "end": "1204000"
  },
  {
    "text": "members so as a as a global so this is not a tool to avoid your or to to deny",
    "start": "1204000",
    "end": "1210960"
  },
  {
    "text": "your Global admin access to stuff because as a global admin I can go in and click remove meaning that I just",
    "start": "1210960",
    "end": "1216760"
  },
  {
    "text": "remove the protection but uh it's very useful to be able to uh Delegate for example user",
    "start": "1216760",
    "end": "1223360"
  },
  {
    "text": "administrator on tenant level while still not allowing them to to um uh add",
    "start": "1223360",
    "end": "1229640"
  },
  {
    "text": "themselves to certain groups in your tenant that is um well has some content",
    "start": "1229640",
    "end": "1236960"
  },
  {
    "text": "that you don't want shared with anyone but now how about",
    "start": "1236960",
    "end": "1242960"
  },
  {
    "text": "applications so we we talked about this protection and everything so we have a lot of uh uh permissions assigned to our",
    "start": "1242960",
    "end": "1249760"
  },
  {
    "text": "users but I think uh I think people are sort of good at maintaining user",
    "start": "1249760",
    "end": "1256799"
  },
  {
    "text": "accounts and uh handling credentials and conditional access and all of that sort",
    "start": "1256799",
    "end": "1264440"
  },
  {
    "text": "of but but um uh apps is a whole other",
    "start": "1264440",
    "end": "1271840"
  },
  {
    "text": "story who knows how the difference between app registrations and Enterprise",
    "start": "1271840",
    "end": "1279520"
  },
  {
    "text": "apps yeah 40% that's nice uh so",
    "start": "1280240",
    "end": "1286360"
  },
  {
    "text": "essentially um a Enterprise application is an instance of an app registration",
    "start": "1286360",
    "end": "1293840"
  },
  {
    "text": "that is sort of the purely easiest way to explain it so in my app registration",
    "start": "1293840",
    "end": "1299159"
  },
  {
    "text": "I Define my redirect Uris I Define my credentials I Define my um different",
    "start": "1299159",
    "end": "1305919"
  },
  {
    "text": "different more like technical things and the Enterprise application which is the",
    "start": "1305919",
    "end": "1311120"
  },
  {
    "text": "instance uh is uh what I actually for example assign permissions uh a service",
    "start": "1311120",
    "end": "1317960"
  },
  {
    "text": "principle is an an Enterprise application equals equals sort of um",
    "start": "1317960",
    "end": "1325159"
  },
  {
    "text": "that's a few things but it's the same um and on app registrations we have",
    "start": "1325159",
    "end": "1332480"
  },
  {
    "text": "uh three types of credentials we have secrets and certificates and we have",
    "start": "1332480",
    "end": "1338000"
  },
  {
    "text": "Federated credentials so uh Secrets is when you um",
    "start": "1338000",
    "end": "1344240"
  },
  {
    "text": "sign in with something called or all of these are when you you sign in with something called U client credential uh",
    "start": "1344240",
    "end": "1351440"
  },
  {
    "text": "Grant uh in open ID connect uh where essentially you provide",
    "start": "1351440",
    "end": "1357400"
  },
  {
    "text": "one of these as a proof that you you have access as this application secret",
    "start": "1357400",
    "end": "1362880"
  },
  {
    "text": "is the same as the password essentially but you can you can have multiple Secrets which is um uh which we'll use",
    "start": "1362880",
    "end": "1371320"
  },
  {
    "text": "later uh certificates is just a essentially more secure way to do the same thing and Federated is completely",
    "start": "1371320",
    "end": "1378799"
  },
  {
    "text": "different in that it doesn't store anything anywhere it's just a uh I'm",
    "start": "1378799",
    "end": "1384880"
  },
  {
    "text": "allowed to authenticate as this app from GitHub actions running from a certain",
    "start": "1384880",
    "end": "1391159"
  },
  {
    "text": "branch in a certain repository in GitHub for example very useful where you don't",
    "start": "1391159",
    "end": "1396520"
  },
  {
    "text": "need to handle for example rollover of a secret and",
    "start": "1396520",
    "end": "1402559"
  },
  {
    "text": "similar um then we have managed service identities so if you use Azure um and",
    "start": "1402919",
    "end": "1412400"
  },
  {
    "text": "create different kinds of azure resources you have probably created a managed service identity I would assume",
    "start": "1412400",
    "end": "1420159"
  },
  {
    "text": "and the point of managed service identities is that I can for example have a uh logic app in um uh in Azure or",
    "start": "1420159",
    "end": "1430000"
  },
  {
    "text": "a Azure function or whatever many many many different resources in Asher",
    "start": "1430000",
    "end": "1435159"
  },
  {
    "text": "support these and it essentially eliminate for you this app registration",
    "start": "1435159",
    "end": "1440640"
  },
  {
    "text": "part so Microsoft handles the app registration part essentially uh rolls",
    "start": "1440640",
    "end": "1446279"
  },
  {
    "text": "over a certificate uh does these things for you and you just consume the the",
    "start": "1446279",
    "end": "1452520"
  },
  {
    "text": "service principle essentially uh and I'm going to show how we can utilize that later in a attack",
    "start": "1452520",
    "end": "1460880"
  },
  {
    "text": "path uh so to handle these app registrations you have a few the",
    "start": "1460880",
    "end": "1467000"
  },
  {
    "text": "different roles of course you have Global admin which can do anything you have application admin uh that can do",
    "start": "1467000",
    "end": "1472480"
  },
  {
    "text": "anything with with apps uh and you have uh an application owner so on both both",
    "start": "1472480",
    "end": "1479960"
  },
  {
    "text": "of these objects both the Enterprise app and the app registration uh you can be",
    "start": "1479960",
    "end": "1485520"
  },
  {
    "text": "an owner so and and that is nice because then I can say that well this is my app doing",
    "start": "1485520",
    "end": "1493840"
  },
  {
    "text": "something uh this person bought it so I'm going to set him as an owner of that uh app um and then I sort of have a poor",
    "start": "1493840",
    "end": "1503720"
  },
  {
    "text": "man's governance solution over my applications because these are tagged with",
    "start": "1503720",
    "end": "1509559"
  },
  {
    "text": "owners bad idea don't do that because the thing is that an application owner",
    "start": "1509559",
    "end": "1515559"
  },
  {
    "text": "actually has permissions um and most of all he has permissions to add credentials to these",
    "start": "1515559",
    "end": "1524080"
  },
  {
    "text": "apps and that was what what we did in this earlier uh attack path where we essentially had a unprivileged",
    "start": "1524080",
    "end": "1532159"
  },
  {
    "text": "user but he had access as owner on a single app registration uh so we were able to add a",
    "start": "1532159",
    "end": "1540520"
  },
  {
    "text": "credential and who here monitors credentials on app registrations",
    "start": "1540520",
    "end": "1545600"
  },
  {
    "text": "and ah there three of you awesome um and uh that is very",
    "start": "1545600",
    "end": "1553760"
  },
  {
    "text": "consistent with what I see at customers as well they create them and and they",
    "start": "1553760",
    "end": "1558840"
  },
  {
    "text": "forget about them until they stop working because their secret expired and",
    "start": "1558840",
    "end": "1564559"
  },
  {
    "text": "then they uh create a new secret so uh a better way of uh of um",
    "start": "1564559",
    "end": "1573039"
  },
  {
    "text": "doing this uh our owner thing is an app scop directory role so on apps rather",
    "start": "1573039",
    "end": "1580760"
  },
  {
    "text": "than um um on sort of the talent scope same as with administrative unit you",
    "start": "1580760",
    "end": "1586720"
  },
  {
    "text": "also have uh roles however there are currently no",
    "start": "1586720",
    "end": "1592120"
  },
  {
    "text": "protection mechanisms for for most of",
    "start": "1592120",
    "end": "1597559"
  },
  {
    "text": "most of what we do here uh so if you use app scope directory roles you actually do have some some of these protection",
    "start": "1597559",
    "end": "1604440"
  },
  {
    "text": "mechanisms that we that we talked about but the owner role and um depending on the there's no",
    "start": "1604440",
    "end": "1613600"
  },
  {
    "text": "dependence on how much this Enterprise application has access to so in",
    "start": "1613600",
    "end": "1618880"
  },
  {
    "text": "Microsoft graph you have a gazillion different Scopes that you can uh can assign or you can you can essentially",
    "start": "1618880",
    "end": "1625240"
  },
  {
    "text": "request them then admin uh consents that yes you can you can access this uh and",
    "start": "1625240",
    "end": "1631240"
  },
  {
    "text": "that can be user read write all or other kinds of",
    "start": "1631240",
    "end": "1636600"
  },
  {
    "text": "permissions and uh none of these do any",
    "start": "1636600",
    "end": "1642919"
  },
  {
    "text": "um or there is no so you have this permission let me make this more secure",
    "start": "1642919",
    "end": "1650360"
  },
  {
    "text": "uh by requiring Global admin or or something as soon as you have consented",
    "start": "1650360",
    "end": "1656440"
  },
  {
    "text": "that this Enterprise app has a certain access then it has that that access you can definitely remove it but um any",
    "start": "1656440",
    "end": "1664640"
  },
  {
    "text": "owner or anything it's not affected so let's have a look at that protection as",
    "start": "1664640",
    "end": "1673240"
  },
  {
    "text": "well let's go in as our app owner",
    "start": "1673240",
    "end": "1678799"
  },
  {
    "text": "so here I am Allan and uh let's go into entra ID and",
    "start": "1678799",
    "end": "1686559"
  },
  {
    "text": "uh our uh uh roles just to um see we can",
    "start": "1686559",
    "end": "1692480"
  },
  {
    "text": "go to pin and my roles and we can see that there are no active assignments or roles this user doesn't have any",
    "start": "1692480",
    "end": "1700519"
  },
  {
    "text": "permissions cool so going to app registrations I have one one app",
    "start": "1700519",
    "end": "1709159"
  },
  {
    "text": "it's called high privileged app should set up some alarm Bells uh but this is owned by by",
    "start": "1709159",
    "end": "1716440"
  },
  {
    "text": "me and that means that I can go into this application uh and do stuff I can delete",
    "start": "1716440",
    "end": "1723720"
  },
  {
    "text": "it I can uh I can uh update properties but under certificates and secrets I can",
    "start": "1723720",
    "end": "1730480"
  },
  {
    "text": "also go to new client secret click add and I get a new client Secret",
    "start": "1730480",
    "end": "1738640"
  },
  {
    "text": "okay that's great but the problem is that when we now also look at um API",
    "start": "1738640",
    "end": "1745080"
  },
  {
    "text": "permissions so we have actually granted this app quite a lot of uh permissions",
    "start": "1745080",
    "end": "1750799"
  },
  {
    "text": "so for example this one role management read write directory that can assign Global",
    "start": "1750799",
    "end": "1759679"
  },
  {
    "text": "admin so that means that this user just by being himself can add a permission",
    "start": "1759679",
    "end": "1767519"
  },
  {
    "text": "and no add add a credential to an app that has access to Grant himself Global",
    "start": "1767519",
    "end": "1774000"
  },
  {
    "text": "admin that's not good and uh there is no other no",
    "start": "1774000",
    "end": "1779960"
  },
  {
    "text": "protection saying that well but this um this app has this role management",
    "start": "1779960",
    "end": "1786519"
  },
  {
    "text": "directory uh rewrite directory so it um",
    "start": "1786519",
    "end": "1792519"
  },
  {
    "text": "uh should have required some additional permissions perhaps but no own owner can",
    "start": "1792519",
    "end": "1797679"
  },
  {
    "text": "still add these um uh secrets and this app has actually not",
    "start": "1797679",
    "end": "1804679"
  },
  {
    "text": "only this scope but if we go to Pim entra roles and find uh global global",
    "start": "1804679",
    "end": "1814200"
  },
  {
    "text": "global administrator and under active assignments I actually assigned this",
    "start": "1814200",
    "end": "1819440"
  },
  {
    "text": "service principle the global admin role as well just to sort of really demonstrate that no no there there is no",
    "start": "1819440",
    "end": "1826840"
  },
  {
    "text": "protection of it so make sure that um you both monitor",
    "start": "1826840",
    "end": "1832320"
  },
  {
    "text": "the credentials and don't use uh the owner in you know in that way",
    "start": "1832320",
    "end": "1839720"
  },
  {
    "text": "as sort of a governance thing uh because owner has permissions that is all of the",
    "start": "1839720",
    "end": "1845679"
  },
  {
    "text": "takeway from that um",
    "start": "1845679",
    "end": "1851720"
  },
  {
    "text": "yeah so one more thing uh we're adding a secret to an app",
    "start": "1851720",
    "end": "1857360"
  },
  {
    "text": "registration who knew that you can also add secrets to service",
    "start": "1857360",
    "end": "1863158"
  },
  {
    "text": "principles yeah a few five of you or something um",
    "start": "1863200",
    "end": "1869760"
  },
  {
    "text": "so let's say that you uh don't have you don't want owner on app registration uh",
    "start": "1869760",
    "end": "1877039"
  },
  {
    "text": "or so so we remove that but we want this user to be able to assign the",
    "start": "1877039",
    "end": "1882240"
  },
  {
    "text": "application uh as um um or as I knew",
    "start": "1882240",
    "end": "1887399"
  },
  {
    "text": "knew High s to an app or something like that so we instead give him owner on Enterprise application Level not on app",
    "start": "1887399",
    "end": "1894840"
  },
  {
    "text": "registration level so let's have a look at that as well this is a bit more sort of tricky",
    "start": "1894840",
    "end": "1901799"
  },
  {
    "text": "to demo but we can try it anyway uh let's find the correct person this app",
    "start": "1901799",
    "end": "1909240"
  },
  {
    "text": "owner so this Allen guy I used the same",
    "start": "1909240",
    "end": "1914519"
  },
  {
    "text": "uh same uh app um but uh he has let's go",
    "start": "1914519",
    "end": "1920480"
  },
  {
    "text": "to app registrations and owned apps and go to the instance of that",
    "start": "1920480",
    "end": "1925799"
  },
  {
    "text": "app this one so here we we are on the uh",
    "start": "1925799",
    "end": "1932559"
  },
  {
    "text": "Enterprise application uh instead of the app registration and we have assigned role",
    "start": "1932559",
    "end": "1938880"
  },
  {
    "text": "there as well so that's two different owners",
    "start": "1938880",
    "end": "1944120"
  },
  {
    "text": "essentially uh and uh what I can do now is that in in the portal here I don't",
    "start": "1944120",
    "end": "1951519"
  },
  {
    "text": "have any way of doing this but uh we have this F12 button so let's have a",
    "start": "1951519",
    "end": "1958360"
  },
  {
    "text": "look at what happens behind the scenes here okay so we have some stuff let's just grab our",
    "start": "1958360",
    "end": "1965600"
  },
  {
    "text": "authorization header uh like this okay",
    "start": "1965600",
    "end": "1972000"
  },
  {
    "text": "cool so let's open Powershell um and the set essentially do",
    "start": "1972000",
    "end": "1981159"
  },
  {
    "text": "a something like that access token read a string okay so uh now we have our our",
    "start": "1981159",
    "end": "1989720"
  },
  {
    "text": "access token uh we can do connect mg graph using the graph module and just provide",
    "start": "1989720",
    "end": "1996799"
  },
  {
    "text": "the AIS token fun so yeah I added the",
    "start": "1996799",
    "end": "2003080"
  },
  {
    "text": "bearer on in front didn't I like this",
    "start": "2003080",
    "end": "2009760"
  },
  {
    "text": "there we go so now we're connected to the to the Microsoft graph and by um looking at invoke mg I",
    "start": "2012480",
    "end": "2024080"
  },
  {
    "text": "think we can do something no not that one mg graph request URI htps we're",
    "start": "2024080",
    "end": "2030960"
  },
  {
    "text": "going to access the Microsoft graph we are going to access service princip FAL slash this",
    "start": "2030960",
    "end": "2039559"
  },
  {
    "text": "one we we find it and if we type add",
    "start": "2039559",
    "end": "2045519"
  },
  {
    "text": "password and do a post we've added a credential to the service principal",
    "start": "2045519",
    "end": "2051280"
  },
  {
    "text": "level and this can be used as the same same I can use this to authenticate as",
    "start": "2051280",
    "end": "2057280"
  },
  {
    "text": "the service principle and uh that means that I can essentially hide as an attacker just by",
    "start": "2057280",
    "end": "2064800"
  },
  {
    "text": "getting this access token temporary um cuz cuz there's no way of going back",
    "start": "2064800",
    "end": "2072079"
  },
  {
    "text": "to the app registration level and finding this secret there still only these four secrets so this new secret",
    "start": "2072079",
    "end": "2079398"
  },
  {
    "text": "was pjt that's not here so that means that I can uh as an owner on the",
    "start": "2079399",
    "end": "2086158"
  },
  {
    "text": "Enterprise app I can authenticate as that service",
    "start": "2086159",
    "end": "2091638"
  },
  {
    "text": "principal uh and um most people doesn't know about this",
    "start": "2091639",
    "end": "2098720"
  },
  {
    "text": "at all and they definitely don't monitor these kinds of credentials so that's",
    "start": "2098720",
    "end": "2104920"
  },
  {
    "text": "also something to be uh aware of that it",
    "start": "2104920",
    "end": "2110838"
  },
  {
    "text": "exists and this also works from M to tenant applications so if I am a service",
    "start": "2111160",
    "end": "2118720"
  },
  {
    "text": "provider and I have some permissions into a customer tenant then someone can",
    "start": "2118720",
    "end": "2126119"
  },
  {
    "text": "add additional credentials they are scoped to that tenant though so CU in a multi-tenant application uh world the",
    "start": "2126119",
    "end": "2134000"
  },
  {
    "text": "app registration is in the service providers tenant while the Enterprise or the instance or instances because you",
    "start": "2134000",
    "end": "2140920"
  },
  {
    "text": "can have multiple instances uh at different customers um these credentials can be",
    "start": "2140920",
    "end": "2147400"
  },
  {
    "text": "added um and meaning that it will look like you are doing stuff with",
    "start": "2147400",
    "end": "2153599"
  },
  {
    "text": "your uh with your sort of multitenant app into the customer environment even",
    "start": "2153599",
    "end": "2158960"
  },
  {
    "text": "though the secret is actually um in the customer environment so it will say in",
    "start": "2158960",
    "end": "2165200"
  },
  {
    "text": "the log that which key is actually um actually used so if they add a add a",
    "start": "2165200",
    "end": "2171400"
  },
  {
    "text": "client secret and um uh you you you will see in the signin logs uh that that was",
    "start": "2171400",
    "end": "2179800"
  },
  {
    "text": "the secret used but um yeah there are ways to avoid",
    "start": "2179800",
    "end": "2185480"
  },
  {
    "text": "it and that's this one and this is the only place where Microsoft refers to uh an Enterprise app",
    "start": "2185480",
    "end": "2192599"
  },
  {
    "text": "as an app instance I think but um uh through this app instance property lock",
    "start": "2192599",
    "end": "2200200"
  },
  {
    "text": "you can actually say that no no we're we don't need any credentials",
    "start": "2200200",
    "end": "2205240"
  },
  {
    "text": "on service principles or on the service principles belonging to this this one or",
    "start": "2205240",
    "end": "2211720"
  },
  {
    "text": "this app registration so if you don't need credentials on Enterprise apps and",
    "start": "2211720",
    "end": "2218359"
  },
  {
    "text": "service principles use this and um",
    "start": "2218359",
    "end": "2225960"
  },
  {
    "text": "yeah so we talked talked already already about M Microsoft graph",
    "start": "2227560",
    "end": "2234400"
  },
  {
    "text": "Scopes and uh there are many it's sort of a similar list of Scopes here as well",
    "start": "2234400",
    "end": "2242319"
  },
  {
    "text": "where um um they're sort of the same thing as or they relate to uh different",
    "start": "2242319",
    "end": "2249440"
  },
  {
    "text": "ENT ID roles meaning that for example this role management read write",
    "start": "2249440",
    "end": "2254839"
  },
  {
    "text": "directory um it's not the same as Global admin but it can assign it so it's more",
    "start": "2254839",
    "end": "2259920"
  },
  {
    "text": "of a privileged um role administrator just",
    "start": "2259920",
    "end": "2267520"
  },
  {
    "text": "for uh just for Enterprise apps essentially application read write all",
    "start": "2267520",
    "end": "2273839"
  },
  {
    "text": "is essentially the application administrator just for uh um these these kinds of",
    "start": "2273839",
    "end": "2282240"
  },
  {
    "text": "Scopes instead uh and both of these are very um",
    "start": "2282240",
    "end": "2289440"
  },
  {
    "text": "nice to avoid if you if you can so for example application read write all can",
    "start": "2289440",
    "end": "2294800"
  },
  {
    "text": "add credentials to any app in the tenant uh and of course then you can",
    "start": "2294800",
    "end": "2300920"
  },
  {
    "text": "hear that well if they have another app so I I need application read write all",
    "start": "2300920",
    "end": "2306640"
  },
  {
    "text": "because I'm Terri performing all the app registrations in a tenant yeah nice",
    "start": "2306640",
    "end": "2312920"
  },
  {
    "text": "um do that but make sure that you secure um or securely handle uh your app",
    "start": "2312920",
    "end": "2320040"
  },
  {
    "text": "registration and credentials CU um um if",
    "start": "2320040",
    "end": "2325800"
  },
  {
    "text": "you temporarily has access to application read write all then they have access to all all apps",
    "start": "2325800",
    "end": "2334839"
  },
  {
    "text": "you have user read write all um that actually cannot um modify Global",
    "start": "2334839",
    "end": "2341280"
  },
  {
    "text": "admins but it can update users to match Dynamic group criteria for example that is sort of a common attack Vector where",
    "start": "2341280",
    "end": "2348960"
  },
  {
    "text": "uh if you can modify users or perhaps your own user uh to to suddenly start",
    "start": "2348960",
    "end": "2355640"
  },
  {
    "text": "matching different Dynamic groups and then um being added to teams and",
    "start": "2355640",
    "end": "2361599"
  },
  {
    "text": "accessing data and everything um but these cannot update user passwords which is a good thing uh",
    "start": "2361599",
    "end": "2369240"
  },
  {
    "text": "there's actually no way of resetting user passwords as an app so",
    "start": "2369240",
    "end": "2375440"
  },
  {
    "text": "um it is a bit of a hassle then we have some some some Scopes that comes with",
    "start": "2375440",
    "end": "2383359"
  },
  {
    "text": "surprises so we have organization read write all it's something you should really should uh um avoid using if you",
    "start": "2383359",
    "end": "2392839"
  },
  {
    "text": "really yeah avoid using it uh so the description say that it's allowed allow",
    "start": "2392839",
    "end": "2399000"
  },
  {
    "text": "the app to read and write organization related uh resources so organization is like on the tenant level with the name",
    "start": "2399000",
    "end": "2405800"
  },
  {
    "text": "and everything um and some something to do with subscribed skews and tenant",
    "start": "2405800",
    "end": "2411240"
  },
  {
    "text": "branding awesome so we want to deploy tenant branding from our infrastructure as code",
    "start": "2411240",
    "end": "2417760"
  },
  {
    "text": "repository that's what we're that's what we want uh the problem is that that",
    "start": "2417760",
    "end": "2424200"
  },
  {
    "text": "permission also gives you the ability to add a trusted root certificate to to",
    "start": "2424200",
    "end": "2429520"
  },
  {
    "text": "entra and if certificate based authentication is enabled uh you can impersonate any user",
    "start": "2429520",
    "end": "2437119"
  },
  {
    "text": "in the tenant so comes with a few few surprises that um uh can be worth uh noting I have",
    "start": "2437119",
    "end": "2446480"
  },
  {
    "text": "a few of this uh so app assignment read write all uh does anyone know why you",
    "start": "2446480",
    "end": "2454400"
  },
  {
    "text": "shouldn't allow most applications to to have this",
    "start": "2454400",
    "end": "2461640"
  },
  {
    "text": "permission not everyone at once so um yeah it's a useful scope that",
    "start": "2463079",
    "end": "2469960"
  },
  {
    "text": "lets my service uh principle assign app rol I can essentially Implement my own",
    "start": "2469960",
    "end": "2475680"
  },
  {
    "text": "uh identity governance solution awesome but it also um gives you the",
    "start": "2475680",
    "end": "2482200"
  },
  {
    "text": "ability to Grant any application any Microsoft graph permission this is",
    "start": "2482200",
    "end": "2487599"
  },
  {
    "text": "properly documented by by Microsoft but it's sort of a by by just the name app roll",
    "start": "2487599",
    "end": "2495000"
  },
  {
    "text": "assignment you're assigning app rols the problem is that the Microsoft graph is an app and app rols is the way you",
    "start": "2495000",
    "end": "2503599"
  },
  {
    "text": "assign or when you do an admin consent that's essentially adding an app roll so",
    "start": "2503599",
    "end": "2509440"
  },
  {
    "text": "it gives you a lot of permissions that means you can just have by one graph",
    "start": "2509440",
    "end": "2515720"
  },
  {
    "text": "query you can add your you the the same app can add itself to role management",
    "start": "2515720",
    "end": "2521040"
  },
  {
    "text": "read write directory meaning it's it can assign Global",
    "start": "2521040",
    "end": "2526400"
  },
  {
    "text": "admin uh group read write all um useful permission for automating",
    "start": "2526400",
    "end": "2532040"
  },
  {
    "text": "creation of enter ID groups but it also gives you access to all the contents of all teams and",
    "start": "2532040",
    "end": "2538160"
  },
  {
    "text": "Microsoft 365 groups so um there are way there are better Scopes than this and uh",
    "start": "2538160",
    "end": "2546880"
  },
  {
    "text": "really really checking cuz the the thing is that all all of these are called",
    "start": "2546880",
    "end": "2552000"
  },
  {
    "text": "group rewrite all but there's also one called group. create and there's one",
    "start": "2552000",
    "end": "2557280"
  },
  {
    "text": "called group member read write all um so they're quite easy to discover",
    "start": "2557280",
    "end": "2564800"
  },
  {
    "text": "when you know what kind of um um what kind of object you want to modify",
    "start": "2564800",
    "end": "2573960"
  },
  {
    "text": "essentially so what are we supposed to do then well first of all use utilize the least",
    "start": "2573960",
    "end": "2579800"
  },
  {
    "text": "privileged Scopes so as I said group uh group. create application read write owned by",
    "start": "2579800",
    "end": "2587240"
  },
  {
    "text": "rather than application read write all um so there are scopes",
    "start": "2587240",
    "end": "2593440"
  },
  {
    "text": "available but um I would really like for Microsoft to start adding more of these",
    "start": "2593440",
    "end": "2600960"
  },
  {
    "text": "uh uh group read write do assigned or",
    "start": "2600960",
    "end": "2606640"
  },
  {
    "text": "group read write own by and all of these for many more uh objects because right",
    "start": "2606640",
    "end": "2613559"
  },
  {
    "text": "right now it's it's a hassle to to really get this",
    "start": "2613559",
    "end": "2620240"
  },
  {
    "text": "privilege you should really monitor application credentials uh both on app",
    "start": "2620240",
    "end": "2625760"
  },
  {
    "text": "registrations and on um on uh service principle uh",
    "start": "2625760",
    "end": "2633040"
  },
  {
    "text": "level and as an enter ID admin question whether permissions are really needed so",
    "start": "2633040",
    "end": "2640839"
  },
  {
    "text": "I I see so many applications that request way more than they need way way",
    "start": "2640839",
    "end": "2649200"
  },
  {
    "text": "more and uh regularly review the granted permissions so maybe the app has changed",
    "start": "2649200",
    "end": "2656520"
  },
  {
    "text": "or the usage of some kind of application has changed and they no longer need",
    "start": "2656520",
    "end": "2663520"
  },
  {
    "text": "something so let's skip over to manage service identities CU this open a whole new kind",
    "start": "2663559",
    "end": "2670640"
  },
  {
    "text": "of worms so service principle linked to an asure resource with no credentials to",
    "start": "2670640",
    "end": "2676800"
  },
  {
    "text": "handle awesome so I can have a a um",
    "start": "2676800",
    "end": "2681920"
  },
  {
    "text": "logic app that can authenticate without me handling any Secret at",
    "start": "2681920",
    "end": "2688520"
  },
  {
    "text": "all uh and this is where you sort of transition from things being assigned in",
    "start": "2688520",
    "end": "2695520"
  },
  {
    "text": "entra and used in sort of improper fashion um and that is the attack Vector",
    "start": "2695520",
    "end": "2703000"
  },
  {
    "text": "but now it's Suddenly at your our back instead so that means that uh does",
    "start": "2703000",
    "end": "2708800"
  },
  {
    "text": "anyone or does everyone know how Microsoft has sort of subscriptions and management groups and resource groups",
    "start": "2708800",
    "end": "2715440"
  },
  {
    "text": "and everything it's just yeah think of it as folders and they are have parents",
    "start": "2715440",
    "end": "2721000"
  },
  {
    "text": "and they get permissions uh uh through that um",
    "start": "2721000",
    "end": "2727800"
  },
  {
    "text": "so that means that we have new attack paths so for example we can have a user",
    "start": "2727800",
    "end": "2733480"
  },
  {
    "text": "that is granted contributor on a management group that contains a subscription that contains an a logic",
    "start": "2733480",
    "end": "2739480"
  },
  {
    "text": "app that means that this user has contributor access to the logic app and the logic app uh has a managed identity",
    "start": "2739480",
    "end": "2748319"
  },
  {
    "text": "linked to it which is and always just assign Global admin but it could be",
    "start": "2748319",
    "end": "2753559"
  },
  {
    "text": "anything right it could be any permission it could also be just use to read write all or something because you",
    "start": "2753559",
    "end": "2760280"
  },
  {
    "text": "are utilizing a tiny logic app to to do some kind of uh uh",
    "start": "2760280",
    "end": "2766559"
  },
  {
    "text": "automation uh and then um uh through this contributor um",
    "start": "2766559",
    "end": "2773520"
  },
  {
    "text": "role this user can actually modify the um the logic app to do something in as",
    "start": "2773520",
    "end": "2781720"
  },
  {
    "text": "we've seen in other talks here where that if you send certain headers then",
    "start": "2781720",
    "end": "2787119"
  },
  {
    "text": "you Branch out to a new code that only that that hacker knows about for",
    "start": "2787119",
    "end": "2794160"
  },
  {
    "text": "example um but and it also uh uh opens the more of a um infrastructure as code",
    "start": "2794160",
    "end": "2802240"
  },
  {
    "text": "or more deployment side of things attack where U perhaps you have a user that has",
    "start": "2802240",
    "end": "2808640"
  },
  {
    "text": "access to code and can do deployment into the logic app or some other service",
    "start": "2808640",
    "end": "2814040"
  },
  {
    "text": "then that is that also becomes a um new attack Vector so let's just do some do a quick",
    "start": "2814040",
    "end": "2821240"
  },
  {
    "text": "demo asual contributor to enter ID permissions which is very simple if I can remember which tenant I did it in",
    "start": "2821240",
    "end": "2827839"
  },
  {
    "text": "because I have a lot of them I think I have this one so in this tenant I have a logic app",
    "start": "2827839",
    "end": "2836359"
  },
  {
    "text": "that I call break glass and um uh logic app is just the",
    "start": "2836359",
    "end": "2842599"
  },
  {
    "text": "sort of simplest way to to uh uh demo this so this break class uh has an",
    "start": "2842599",
    "end": "2850720"
  },
  {
    "text": "identity so that means that I have just clicked on and save and that's",
    "start": "2850720",
    "end": "2856640"
  },
  {
    "text": "everything that I do in order to enable a uh in this uh system assigned uh",
    "start": "2856640",
    "end": "2864040"
  },
  {
    "text": "managed identity um so so now this logic app can",
    "start": "2864040",
    "end": "2871359"
  },
  {
    "text": "authenticate as this um principle and I have also added some permissions to to",
    "start": "2871359",
    "end": "2878359"
  },
  {
    "text": "that so we can have a look at that as well cuz this will now just uh in entra",
    "start": "2878359",
    "end": "2883480"
  },
  {
    "text": "if we go to Enterprise applications what I call it break class",
    "start": "2883480",
    "end": "2889280"
  },
  {
    "text": "and I say not this one like this so I just search for break class under",
    "start": "2889280",
    "end": "2894559"
  },
  {
    "text": "Enterprise apps and I will find uh that this is a um managed identity it will",
    "start": "2894559",
    "end": "2901000"
  },
  {
    "text": "I've seen that on right here managed by Microsoft when it comes to certificate expiry status for example",
    "start": "2901000",
    "end": "2907880"
  },
  {
    "text": "so Microsoft fixes everything for us and we have no app registration at",
    "start": "2907880",
    "end": "2913000"
  },
  {
    "text": "all um but I have granted it some permissions like policy read write",
    "start": "2913000",
    "end": "2918760"
  },
  {
    "text": "conditional access uh user read all and policy read all so not a lot it's just",
    "start": "2918760",
    "end": "2924000"
  },
  {
    "text": "sort of to have something to demo here um but then with my contributor access I",
    "start": "2924000",
    "end": "2931799"
  },
  {
    "text": "can simply edit this in a nice gooey so um",
    "start": "2931799",
    "end": "2937319"
  },
  {
    "text": "I can just add a parallel Branch for example so I don't want to affect the code here at all I just want to add some",
    "start": "2937319",
    "end": "2945040"
  },
  {
    "text": "uh some code I see that we starting to get the short on time so I'm not going to do everything here but I can I can",
    "start": "2945040",
    "end": "2951160"
  },
  {
    "text": "add a HTTP call that all already has all the authentication um present so here I can",
    "start": "2951160",
    "end": "2959079"
  },
  {
    "text": "just type for example uh graph microsoft.com slv1",
    "start": "2959079",
    "end": "2966040"
  },
  {
    "text": "users I can uh I can add authentication saying that just use the managed",
    "start": "2966040",
    "end": "2972920"
  },
  {
    "text": "identity and um uh click save of course this will be or at least can be uh",
    "start": "2972920",
    "end": "2980839"
  },
  {
    "text": "visible to anyone but uh then you have a nice feature in logic apps so you can just go back to the previous version and",
    "start": "2980839",
    "end": "2988359"
  },
  {
    "text": "just um promote that to the current version so it goes back to being the um",
    "start": "2988359",
    "end": "2994440"
  },
  {
    "text": "the active code so by by doing this promote uh and clicking save now if I",
    "start": "2994440",
    "end": "3002240"
  },
  {
    "text": "made some changes all my changes will be gone there are definitely traces here",
    "start": "3002240",
    "end": "3007880"
  },
  {
    "text": "but um I might already have uh have um more permissions to your tenant than",
    "start": "3007880",
    "end": "3014839"
  },
  {
    "text": "than you you want me to have so",
    "start": "3014839",
    "end": "3019920"
  },
  {
    "text": "um uh yeah when so so when using different privileged um uh roles in uh",
    "start": "3019920",
    "end": "3026839"
  },
  {
    "text": "um in these managed identities make sure that you properly handle permissions in",
    "start": "3026839",
    "end": "3033200"
  },
  {
    "text": "in Asher let's do some key takeaways first of all do not combine",
    "start": "3033200",
    "end": "3039480"
  },
  {
    "text": "pin for groups with ro assignable groups um as we showed where there's no",
    "start": "3039480",
    "end": "3045119"
  },
  {
    "text": "protection of users make sure that you enable property lock on your app",
    "start": "3045119",
    "end": "3050839"
  },
  {
    "text": "registrations so that um uh so that you cannot add additional credential",
    "start": "3050839",
    "end": "3058640"
  },
  {
    "text": "uh you should monitor app credentials both on app registration level and service principle level you should audit",
    "start": "3058680",
    "end": "3065799"
  },
  {
    "text": "Microsoft graph application consents so when there's new applications granted",
    "start": "3065799",
    "end": "3071040"
  },
  {
    "text": "access um yeah audit them uh but but this can also be true for your like",
    "start": "3071040",
    "end": "3077119"
  },
  {
    "text": "custom built apis or whatever and so most definitely but it's a bit simpler",
    "start": "3077119",
    "end": "3083319"
  },
  {
    "text": "to show uh how to Elevate per permissions in in entro ID but um same thing for all",
    "start": "3083319",
    "end": "3091520"
  },
  {
    "text": "of your custom apps and apis uh application owner can add",
    "start": "3091520",
    "end": "3096640"
  },
  {
    "text": "credentials so don't use it as sort of a poorman's governance uh",
    "start": "3096640",
    "end": "3102760"
  },
  {
    "text": "solution um yeah list privilege as always um it's",
    "start": "3102760",
    "end": "3109280"
  },
  {
    "text": "not always that that it's possible to be honest so if you have some need needs",
    "start": "3109280",
    "end": "3117000"
  },
  {
    "text": "that um that um cannot be met by the current graph Scopes um then you might",
    "start": "3117000",
    "end": "3123760"
  },
  {
    "text": "need this user read WR all or group read write all so um but then you can secure",
    "start": "3123760",
    "end": "3128799"
  },
  {
    "text": "things a bit more with this administrative",
    "start": "3128799",
    "end": "3133480"
  },
  {
    "text": "units um yeah so and every everyone of course knows",
    "start": "3134240",
    "end": "3139920"
  },
  {
    "text": "all the 400 plus as rback rolles so by heart so um um yeah make make sure that you at",
    "start": "3139920",
    "end": "3148119"
  },
  {
    "text": "least put some effort into um into least privilege",
    "start": "3148119",
    "end": "3153318"
  },
  {
    "text": "here and uh well yeah something not read write all may give you more per",
    "start": "3153400",
    "end": "3159400"
  },
  {
    "text": "permissions than you really asked for and uh yeah so um definitely use",
    "start": "3159400",
    "end": "3168599"
  },
  {
    "text": "manage service identities um they're not scary at all they are pro one of the best things in aure I",
    "start": "3168599",
    "end": "3175960"
  },
  {
    "text": "would say um but watch out for rback based attack",
    "start": "3175960",
    "end": "3182318"
  },
  {
    "text": "paths yeah thank you [Music]",
    "start": "3182720",
    "end": "3189439"
  },
  {
    "text": "um",
    "start": "3193200",
    "end": "3196200"
  }
]