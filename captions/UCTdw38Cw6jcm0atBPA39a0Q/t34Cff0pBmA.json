[
  {
    "start": "0",
    "end": "257000"
  },
  {
    "text": "you wouldn't believe actually how how satisfying it is to have people come to security talks when I did my first",
    "start": "4220",
    "end": "10769"
  },
  {
    "text": "security talk 15 years ago there were literally two people in the room and one left early so thanks for coming welcome",
    "start": "10769",
    "end": "19470"
  },
  {
    "text": "hi that's not the spirit hi thank you",
    "start": "19470",
    "end": "27890"
  },
  {
    "text": "exactly one year ago it was broken me I think even in the same room giving the",
    "start": "28820",
    "end": "34110"
  },
  {
    "text": "same talk or at least the same title has anyone been to this talk one year ago a couple of people so we were toying",
    "start": "34110",
    "end": "41010"
  },
  {
    "text": "around with some ideas and we should be showed some early prototypes and people",
    "start": "41010",
    "end": "46950"
  },
  {
    "text": "said like where we asked the code we asked the code can you can we have the code and we didn't real we didn't really",
    "start": "46950",
    "end": "53430"
  },
  {
    "text": "feel comfortable by the time to handing out the code so we said no there's no code so kind of this talk is the story",
    "start": "53430",
    "end": "61110"
  },
  {
    "text": "kind of what happened after okay so for the last 12 months so to speak and the",
    "start": "61110",
    "end": "68280"
  },
  {
    "text": "whole problem space is this broken I have been working for many many years on",
    "start": "68280",
    "end": "74340"
  },
  {
    "text": "this thing called identity server which is an open-source implementation for MIDI connect and off and it basically",
    "start": "74340",
    "end": "81240"
  },
  {
    "text": "solves the authentication problem so whenever you need to authenticate users and you have a you know a reasonably",
    "start": "81240",
    "end": "87570"
  },
  {
    "text": "complex system then identity server is kind of like a Swiss Army knife for implementing authentication and single",
    "start": "87570",
    "end": "94020"
  },
  {
    "text": "sign-on and all these things and even if you know even if that sounds",
    "start": "94020",
    "end": "100530"
  },
  {
    "text": "intimidating authentication is easy yeah because because once you know all the",
    "start": "100530",
    "end": "106319"
  },
  {
    "text": "facts and all the requirements it's pretty much like there's only one right solution to solve the problem whereas",
    "start": "106319",
    "end": "112530"
  },
  {
    "text": "authorization there are so many opinions and styles and different approaches that",
    "start": "112530",
    "end": "117780"
  },
  {
    "text": "might bring you to the same solution yeah so basically ultimately after the",
    "start": "117780",
    "end": "123659"
  },
  {
    "text": "customers were done with authentication it's like okay so now where is your open source library for just doing you know",
    "start": "123659",
    "end": "130350"
  },
  {
    "text": "apt or user authorization and I'm done and that didn't exist okay so and the main",
    "start": "130350",
    "end": "138750"
  },
  {
    "text": "reason why this probably will never exist in in one line of code thing right",
    "start": "138750",
    "end": "144810"
  },
  {
    "text": "is because it's it's very very application specific various authentication is something more universal",
    "start": "144810",
    "end": "150599"
  },
  {
    "text": "so our tip you know our kind of answer",
    "start": "150599",
    "end": "157019"
  },
  {
    "text": "was always yeah that's application specific you have to write something that is exactly working with your application and we never really had the",
    "start": "157019",
    "end": "165690"
  },
  {
    "text": "time to say like okay so is there something is there a common ground that would be worthwhile abstracting into a",
    "start": "165690",
    "end": "173310"
  },
  {
    "text": "more general-purpose library or even pattern or approach and that's what we",
    "start": "173310",
    "end": "181139"
  },
  {
    "text": "basically were thinking about to start with on a background thread kind of and then for the last 12 months more more",
    "start": "181139",
    "end": "189829"
  },
  {
    "text": "more full-time and that's what this thing is called called policy server so",
    "start": "189829",
    "end": "196889"
  },
  {
    "text": "what what this talk is not did this talk is not really about policy server I I don't want to sell you anything it's",
    "start": "196889",
    "end": "203040"
  },
  {
    "text": "more like why we made the decisions that we made while implementing a reusable",
    "start": "203040",
    "end": "208340"
  },
  {
    "text": "authorization library yeah and maybe",
    "start": "208340",
    "end": "215730"
  },
  {
    "text": "that's some inspiration for you guys as well so the slide deck you can find on",
    "start": "215730",
    "end": "222599"
  },
  {
    "text": "speaker tech comm slash least privilege and it has all the links in there so that's what you should download if you",
    "start": "222599",
    "end": "229829"
  },
  {
    "text": "want to know more details so yeah so a policy server we started building this",
    "start": "229829",
    "end": "236690"
  },
  {
    "text": "open source library and then it became more complicated and more complicated",
    "start": "236690",
    "end": "242010"
  },
  {
    "text": "and more complicated and we made a split basically between there's an open source",
    "start": "242010",
    "end": "247139"
  },
  {
    "text": "version of policy server which you can get from from github and we also have a commercial version now which has you",
    "start": "247139",
    "end": "253079"
  },
  {
    "text": "know the enterprise-e stuff so the way",
    "start": "253079",
    "end": "258900"
  },
  {
    "start": "257000",
    "end": "632000"
  },
  {
    "text": "we approach the problem is since we have the luxury of talking to many different companies right so we started asking",
    "start": "258900",
    "end": "266400"
  },
  {
    "text": "them all you're like how do you do authorization how would you do authorization if you had the",
    "start": "266400",
    "end": "271620"
  },
  {
    "text": "chance to do it again how are you planning to do it for the next application you're you're writing and",
    "start": "271620",
    "end": "276920"
  },
  {
    "text": "the funny thing is when you ask 10 people you get like 15 different opinions because no one was really ever",
    "start": "276920",
    "end": "283650"
  },
  {
    "text": "happy with what he did kind of like yeah we did like that it worked out well in the beginning and then we started",
    "start": "283650",
    "end": "289830"
  },
  {
    "text": "hacking around this and hacking around that and eda we had not enough or we were too ambitious",
    "start": "289830",
    "end": "296810"
  },
  {
    "text": "regardless typically our observation was that people read reinvent the wheel from many times for",
    "start": "296900",
    "end": "306420"
  },
  {
    "text": "the next application in the next application and you know like and not a",
    "start": "306420",
    "end": "311940"
  },
  {
    "text": "lot of people went for the last mile so to speak once the library was done kind of it was working they never took that",
    "start": "311940",
    "end": "318000"
  },
  {
    "text": "took the time to build the UI over that or maybe an API or maybe something to manage their authorization rules and you",
    "start": "318000",
    "end": "324660"
  },
  {
    "text": "know many many times they are you I was sequel server management studio so so we",
    "start": "324660",
    "end": "330120"
  },
  {
    "text": "asked them and there are there are many approaches right but the free the free",
    "start": "330120",
    "end": "338790"
  },
  {
    "text": "most common things we saw and that are working is basically role based",
    "start": "338790",
    "end": "344700"
  },
  {
    "text": "authorization right I mean that's a no-brainer if you are in the marketing role you can launch the marketing",
    "start": "344700",
    "end": "350520"
  },
  {
    "text": "application which is pretty coarse-grained the next typical",
    "start": "350520",
    "end": "355890"
  },
  {
    "text": "abstraction we are seeing is permissions right so you may be you know can do this",
    "start": "355890",
    "end": "360900"
  },
  {
    "text": "or can do that or you know it's allowed to do this sometimes permissions exist",
    "start": "360900",
    "end": "366810"
  },
  {
    "text": "independently of roles sometimes using roles to group permissions together like",
    "start": "366810",
    "end": "372030"
  },
  {
    "text": "if you are in that role that gives you automatically these dismiss permissions for example and then in your code you",
    "start": "372030",
    "end": "378300"
  },
  {
    "text": "can you know do more fine-grained checks for example the other style is more like",
    "start": "378300",
    "end": "385350"
  },
  {
    "text": "a resource-based style right where you have resources in your system like a",
    "start": "385350",
    "end": "390360"
  },
  {
    "text": "document or a contract or a customer and you attach like you know like access control entries to it yeah pretty much",
    "start": "390360",
    "end": "397200"
  },
  {
    "text": "like a NTFS does that in in Windows you are like where you have an echo that hangs off a file or a",
    "start": "397200",
    "end": "403770"
  },
  {
    "text": "directory and there are some challenges with that for example inheritance they're like what if the folder has",
    "start": "403770",
    "end": "410070"
  },
  {
    "text": "these actors were what you know should that or you know go down to all the containing objects and so on what you do",
    "start": "410070",
    "end": "417330"
  },
  {
    "text": "with orphaned echoes right so what if the guy leaves the company but he still isn't the actual it will be an orphaned",
    "start": "417330",
    "end": "424410"
  },
  {
    "text": "entry and you often see that in Windows as well right when you're opening like in NTFS like look at the echo dialog and",
    "start": "424410",
    "end": "431460"
  },
  {
    "text": "there are numbers there but not a name that means that guy has left the company in between and all we have is TTS ID in",
    "start": "431460",
    "end": "438420"
  },
  {
    "text": "there but the account is gone for example um and permutations of that style",
    "start": "438420",
    "end": "444410"
  },
  {
    "text": "kuvira's verses commands it's another interesting challenge right most",
    "start": "444410",
    "end": "450560"
  },
  {
    "text": "authorization frameworks we've seen they deal only with commands yeah like am i allowed to do this yes",
    "start": "450560",
    "end": "457200"
  },
  {
    "text": "then do that but what if you like you know like um give me all the contracts",
    "start": "457200",
    "end": "462360"
  },
  {
    "text": "that I'm allowed to see ma'am it's very very specific to the data store you are",
    "start": "462360",
    "end": "468930"
  },
  {
    "text": "using yeah some people in checked where clauses in sequel statements you know things like that I've even seen a",
    "start": "468930",
    "end": "476040"
  },
  {
    "text": "product which I think was an interesting idea but I think it's crazy it's a it",
    "start": "476040",
    "end": "481590"
  },
  {
    "text": "was a TDS reverse proxy so basically something that sits between your application and sequel server and you do",
    "start": "481590",
    "end": "487200"
  },
  {
    "text": "your queries and this guy basically adds the way of statements dynamically so",
    "start": "487200",
    "end": "496220"
  },
  {
    "text": "these are the things I've seen pretty commonly and I think that's what you can say is how typically you approach",
    "start": "496220",
    "end": "505370"
  },
  {
    "text": "authorization - the very very specific things that are really really specific",
    "start": "505370",
    "end": "511620"
  },
  {
    "text": "to your company what I've also seen is that it's very very easy to blur the",
    "start": "511620",
    "end": "520500"
  },
  {
    "text": "lines between authorization and business rules like where does authorization end",
    "start": "520500",
    "end": "525870"
  },
  {
    "text": "where do business rules start where where does some you know like core",
    "start": "525870",
    "end": "531200"
  },
  {
    "text": "business logic kick in and putting business logic into",
    "start": "531200",
    "end": "536490"
  },
  {
    "text": "authorization rules I think is it's not going to work and the best example I have for that is this thing called XML",
    "start": "536490",
    "end": "544080"
  },
  {
    "text": "the even the name is hard extensible applic access control markup language",
    "start": "544080",
    "end": "550350"
  },
  {
    "text": "has it has anyone ever used that exact mo I don't see anyone one guys waving",
    "start": "550350",
    "end": "556500"
  },
  {
    "text": "okay so XML try basically to externalize all kinds of business rules and",
    "start": "556500",
    "end": "562980"
  },
  {
    "text": "authorization rules to an external system so whenever basically you wanted to",
    "start": "562980",
    "end": "568170"
  },
  {
    "text": "check a rule or something you had to export context from your system to the external system now the expensive had to",
    "start": "568170",
    "end": "574769"
  },
  {
    "text": "pass the context and then they had to write rules and return you an answer and",
    "start": "574769",
    "end": "580850"
  },
  {
    "text": "that feels overly complicated yeah you are basically it feels like you're spending more time making accessible",
    "start": "581120",
    "end": "587820"
  },
  {
    "text": "happy then yourself yeah so that is that",
    "start": "587820",
    "end": "593519"
  },
  {
    "text": "is the first example from the exact remote documentation that's the simplest rule you can write okay and it only",
    "start": "593519",
    "end": "601130"
  },
  {
    "text": "specifies if you can log into an application between 9 a.m. and 5 p.m.",
    "start": "601130",
    "end": "606980"
  },
  {
    "text": "okay so one person reasons that the yeah but in our support Jason as well yeah I",
    "start": "606980",
    "end": "615180"
  },
  {
    "text": "don't think that makes it any better okay so I don't think and given that only one guy was waving it wasn't a huge",
    "start": "615180",
    "end": "623160"
  },
  {
    "text": "success in the long run many people try to use it in the first place I don't think I",
    "start": "623160",
    "end": "629329"
  },
  {
    "text": "think we need mean bean even better separation of concerns so our",
    "start": "629329",
    "end": "635730"
  },
  {
    "start": "632000",
    "end": "728000"
  },
  {
    "text": "observation basically ended up saying we have three different types of",
    "start": "635730",
    "end": "642380"
  },
  {
    "text": "authorization one is more like you know like am I allowed to use an application or am I allowed to use an API for",
    "start": "642380",
    "end": "649350"
  },
  {
    "text": "example yeah that often can be handled at a at a global policy style level",
    "start": "649350",
    "end": "655620"
  },
  {
    "text": "where you in your application of a global a global authorization rule that",
    "start": "655620",
    "end": "661320"
  },
  {
    "text": "you know make sure that only the users are coming in is allowed to do it is allowed to come in actually",
    "start": "661320",
    "end": "668040"
  },
  {
    "text": "at the API level you can often manage that with the tokens I mean if you know",
    "start": "668040",
    "end": "675389"
  },
  {
    "text": "if you don't have a token for an API you can't call it right that's one thing once you are in the application and",
    "start": "675389",
    "end": "683190"
  },
  {
    "text": "you're trying to access a specific feature then I think the role permission resource style works pretty well but",
    "start": "683190",
    "end": "691759"
  },
  {
    "text": "once you are inside the feature right and now it really is all dependent on",
    "start": "691759",
    "end": "699029"
  },
  {
    "text": "the parameters you pass in or the payload or you know like properties of",
    "start": "699029",
    "end": "707699"
  },
  {
    "text": "the things you want to modify I think that is business logic and not",
    "start": "707699",
    "end": "713069"
  },
  {
    "text": "authorization logic anymore and I think there's nothing wrong with writing apps",
    "start": "713069",
    "end": "718290"
  },
  {
    "text": "specific Authenticator ization frameworks but I don't think you can generalize that because it's so",
    "start": "718290",
    "end": "725060"
  },
  {
    "text": "application specific so that's one thing do you remember this guy windows se men",
    "start": "725060",
    "end": "731730"
  },
  {
    "start": "728000",
    "end": "891000"
  },
  {
    "text": "not s men windows se man shipped with",
    "start": "731730",
    "end": "739170"
  },
  {
    "text": "Windows Server 2003 and it took four years for someone that might have to",
    "start": "739170",
    "end": "744269"
  },
  {
    "text": "write an article about it as you can see and it was the best kept secret yeah and the idea we i liked windows SE meant a",
    "start": "744269",
    "end": "752459"
  },
  {
    "text": "lot if you go back on my block to 2004 or something I wrote crazy",
    "start": "752459",
    "end": "758160"
  },
  {
    "text": "integration stuff for asp.net webforms at a time so what I liked about se man",
    "start": "758160",
    "end": "764880"
  },
  {
    "text": "is is that basically it gave you an additional layer over your identity",
    "start": "764880",
    "end": "771899"
  },
  {
    "text": "system so the identity system is Active Directory because you know it was 80 times and Active Directory I hope I",
    "start": "771899",
    "end": "782250"
  },
  {
    "text": "don't tell you anything new was never designed to be an application authorization mechanism right when they",
    "start": "782250",
    "end": "788339"
  },
  {
    "text": "designed Active Directory they had users and groups and you can basically control access to printers and file shares and",
    "start": "788339",
    "end": "794730"
  },
  {
    "text": "these kind of things but it was never designed to be you know like that at eight",
    "start": "794730",
    "end": "800230"
  },
  {
    "text": "groups become authorization mechanisms for applications okay that's why they",
    "start": "800230",
    "end": "806500"
  },
  {
    "text": "created a seaman ma'am an SE man basically sources they use us from",
    "start": "806500",
    "end": "812620"
  },
  {
    "text": "Active Directory so basically you can create groups or well first of all you didn't create applications okay so an",
    "start": "812620",
    "end": "818590"
  },
  {
    "text": "applications can have application groups and they can roles as they call it then you can have roles can be assigned to",
    "start": "818590",
    "end": "825370"
  },
  {
    "text": "tasks and tasks can even you know go down to operations and then you can add",
    "start": "825370",
    "end": "831730"
  },
  {
    "text": "a ad users to those roles okay so it was",
    "start": "831730",
    "end": "837340"
  },
  {
    "text": "a separation of concern between the identity system and the authorization policy which i think is the right way to",
    "start": "837340",
    "end": "844780"
  },
  {
    "text": "do it yeah and the other reason why many people liked it was because it had a UI",
    "start": "844780",
    "end": "850440"
  },
  {
    "text": "now it was built in into Windows and actually I was surprised it still exists",
    "start": "850440",
    "end": "859140"
  },
  {
    "text": "it seems like they removed the ability to create authorization stores because",
    "start": "859140",
    "end": "866290"
  },
  {
    "text": "it's deprecated but you can still open them so if you have old ones lying around but yeah you know nothing ever",
    "start": "866290",
    "end": "873220"
  },
  {
    "text": "goes away in Windows so I guess a seaman is one of those things as well so when",
    "start": "873220",
    "end": "880000"
  },
  {
    "text": "we thought about how policy server should work we my idea was I want",
    "start": "880000",
    "end": "886210"
  },
  {
    "text": "something like this but you know like teleported to modern application design",
    "start": "886210",
    "end": "892180"
  },
  {
    "start": "891000",
    "end": "965000"
  },
  {
    "text": "yeah so where it's not dependent on Active Directory where you you know have",
    "start": "892180",
    "end": "897960"
  },
  {
    "text": "modern protocols like openly connect you know of where you have a claims-based",
    "start": "897960",
    "end": "903070"
  },
  {
    "text": "identity and where you can basically use an arbitrary identity system not not",
    "start": "903070",
    "end": "912130"
  },
  {
    "text": "idea or whatever just whatever you want and have something that sits on top of",
    "start": "912130",
    "end": "917470"
  },
  {
    "text": "that and doesn't you know many vendors try to sell you like identity and access control software where you lock into the",
    "start": "917470",
    "end": "925180"
  },
  {
    "text": "whole stack your users must be managed by them your pull the permissions must be managed by them it's all being buried",
    "start": "925180",
    "end": "931120"
  },
  {
    "text": "in one system I don't like this what I want is that you can choose an",
    "start": "931120",
    "end": "936259"
  },
  {
    "text": "arbitrary identity system and can layer your authorization on top of that so now",
    "start": "936259",
    "end": "943850"
  },
  {
    "text": "given that this architecture is really common these days your people have identity providers there is some",
    "start": "943850",
    "end": "949309"
  },
  {
    "text": "discussion going on now what do next may also how do we distribute how do we make",
    "start": "949309",
    "end": "955429"
  },
  {
    "text": "authorization rules like roles application roles and permissions and these things available to applications",
    "start": "955429",
    "end": "962239"
  },
  {
    "text": "and one one opinion is a very common one",
    "start": "962239",
    "end": "967759"
  },
  {
    "start": "965000",
    "end": "1397000"
  },
  {
    "text": "it should go into the security token right so we already have this thing that",
    "start": "967759",
    "end": "973970"
  },
  {
    "text": "issues tokens to our application so why not just piggyback on that mechanism and",
    "start": "973970",
    "end": "979970"
  },
  {
    "text": "stuff in our authorization policies in there as well a couple of products out",
    "start": "979970",
    "end": "988339"
  },
  {
    "text": "there do that and and that that's their their style of doing it I don't to be",
    "start": "988339",
    "end": "994339"
  },
  {
    "text": "honest I I don't like this approach because I've seen it go wrong so many",
    "start": "994339",
    "end": "999589"
  },
  {
    "text": "times so let's have a look at this token here yeah so the token a security token",
    "start": "999589",
    "end": "1006910"
  },
  {
    "text": "typically contains information about the authentication yeah like who issued the",
    "start": "1006910",
    "end": "1013989"
  },
  {
    "text": "token how was the user authenticated when was he authenticated and where can",
    "start": "1013989",
    "end": "1020499"
  },
  {
    "text": "you use that token that data that I would say is authentication metadata it contains identity yeah for example",
    "start": "1020499",
    "end": "1029529"
  },
  {
    "text": "what's the user ID of the user and maybe you have some other data you want to ship around like a display name for",
    "start": "1029529",
    "end": "1036188"
  },
  {
    "text": "example and then this and that's something I don't like",
    "start": "1036189",
    "end": "1042010"
  },
  {
    "text": "okay so tokens should represent the",
    "start": "1042010",
    "end": "1048339"
  },
  {
    "text": "caller and the user and where they can be used and identity information that",
    "start": "1048339",
    "end": "1055360"
  },
  {
    "text": "describes those three parts okay that that's my mindset at least now",
    "start": "1055360",
    "end": "1061440"
  },
  {
    "text": "permissions clearly don't fall into this bucket okay",
    "start": "1061440",
    "end": "1066669"
  },
  {
    "text": "delete data okay manage customers right change treatment plan they are all pretty",
    "start": "1066669",
    "end": "1073110"
  },
  {
    "text": "pretty generic things and one one fact",
    "start": "1073110",
    "end": "1078490"
  },
  {
    "text": "is that in ooo for example you see that the audience here a token can be used at",
    "start": "1078490",
    "end": "1084730"
  },
  {
    "text": "more than one API yeah so you have maybe you know like a pet pack in W s star you",
    "start": "1084730",
    "end": "1091480"
  },
  {
    "text": "were used to getting one token for API one getting a token for API to getting a token for API free the style he stays is",
    "start": "1091480",
    "end": "1098500"
  },
  {
    "text": "more like you get one token and it inside the token you define where it can be used so you have one token for",
    "start": "1098500",
    "end": "1103899"
  },
  {
    "text": "multiple api's huh but what if now this guy has the delete",
    "start": "1103899",
    "end": "1109149"
  },
  {
    "text": "data permission in API one but not an API - for example yeah so maybe when you",
    "start": "1109149",
    "end": "1115450"
  },
  {
    "text": "start assigning that this makes total sense to you and then you start adding api's to it and then these permissions become ambiguous yeah and you start",
    "start": "1115450",
    "end": "1123580"
  },
  {
    "text": "shipping them around and one thing I learned from experience is adding claims",
    "start": "1123580",
    "end": "1131230"
  },
  {
    "text": "to a token is super easy right you just write a one line of code or a new claim job done but removing a claim from a",
    "start": "1131230",
    "end": "1138789"
  },
  {
    "text": "token because you realize it was the wrong claim or the semantics are wrong is super hard because you don't well",
    "start": "1138789",
    "end": "1145450"
  },
  {
    "text": "often you don't know who started taking dependencies on the existence of the claim or even the semantics yeah so I",
    "start": "1145450",
    "end": "1153210"
  },
  {
    "text": "don't like this the other problem is with tokens is that typically tokens get created at",
    "start": "1153210",
    "end": "1159220"
  },
  {
    "text": "authentication time ok so when I log on",
    "start": "1159220",
    "end": "1164440"
  },
  {
    "text": "to a system I'm doing my orphans getting my tokens what happens if two hours",
    "start": "1164440",
    "end": "1171100"
  },
  {
    "text": "later for example or even shortly later my permissions change right the only way",
    "start": "1171100",
    "end": "1176590"
  },
  {
    "text": "to update this is getting new tokens yeah for example in Windows Windows has",
    "start": "1176590",
    "end": "1184299"
  },
  {
    "text": "the exact same problem yeah so when you log on to your Windows machine in the morning and then an admin adds you to a",
    "start": "1184299",
    "end": "1190960"
  },
  {
    "text": "group the only way to make this group membership effective for you is to log off and log on again because they",
    "start": "1190960",
    "end": "1196600"
  },
  {
    "text": "collect your group memberships at login time okay so if you have things that often",
    "start": "1196600",
    "end": "1202900"
  },
  {
    "text": "change tokens are definitely not the right vehicle to ship them yeah",
    "start": "1202900",
    "end": "1209590"
  },
  {
    "text": "and the last one is this this section your rolls rolls is a an often discussed",
    "start": "1209590",
    "end": "1218140"
  },
  {
    "text": "thing yeah so should you put roles in the token or not so in my mind there are",
    "start": "1218140",
    "end": "1223870"
  },
  {
    "text": "two types of roles one I call identity rolls yeah so basically in this case to",
    "start": "1223870",
    "end": "1231310"
  },
  {
    "text": "talk to roll for example yeah so when you when you log on to the system you are a doctor well you are a doctor it's",
    "start": "1231310",
    "end": "1237760"
  },
  {
    "text": "part of your identity okay but approver what does it prove I mean yeah I mean",
    "start": "1237760",
    "end": "1244350"
  },
  {
    "text": "what does he approve and depending on to which API I'm connecting I might be able",
    "start": "1244350",
    "end": "1249610"
  },
  {
    "text": "to approve different things so that the approval roll my in my mind falls more",
    "start": "1249610",
    "end": "1254890"
  },
  {
    "text": "into the authorization pocket and into the identity pocket yeah this is kind of",
    "start": "1254890",
    "end": "1262900"
  },
  {
    "text": "like a hospital scenario because one of my customers that inspired the whole thing did Hospital software and when a",
    "start": "1262900",
    "end": "1269800"
  },
  {
    "text": "user locked in to the system they always got one role doctor nurse or patient yeah and there was never a situation",
    "start": "1269800",
    "end": "1276190"
  },
  {
    "text": "where the doctor was a nurse or the nurse was a doctor so for them it made",
    "start": "1276190",
    "end": "1283750"
  },
  {
    "text": "total sense and that I think is part of the identity of the user ma'am same as",
    "start": "1283750",
    "end": "1289810"
  },
  {
    "text": "like with your your your passport right so on your on your ID card you have a date of birth claim on a drive it",
    "start": "1289810",
    "end": "1298390"
  },
  {
    "text": "doesn't have a claim on it says allow to drink alcohol because the rules change",
    "start": "1298390",
    "end": "1305050"
  },
  {
    "text": "depending on which end point you're talking to right so in Germany it's 16 depending on what you're drinking in in",
    "start": "1305050",
    "end": "1311650"
  },
  {
    "text": "the state is 21 someone recently said in in Ireland it's 8 so so the DLT allowed",
    "start": "1311650",
    "end": "1321790"
  },
  {
    "text": "to drink permission is something that is handled at the bar right or the API",
    "start": "1321790",
    "end": "1327040"
  },
  {
    "text": "endpoint if you like where is the date of birth is something universal and that's where I in my mind make it make",
    "start": "1327040",
    "end": "1333100"
  },
  {
    "text": "the distinction right identity is something Universal authorization is something application-specific",
    "start": "1333100",
    "end": "1338720"
  },
  {
    "text": "okay that's at least my mindset I know that there are many products out there",
    "start": "1338720",
    "end": "1344270"
  },
  {
    "text": "which which do it exactly like this you know that's just my opinion",
    "start": "1344270",
    "end": "1349820"
  },
  {
    "text": "oh yeah and to be honest I've seen many companies that started out with that and then it got completely out of hand right",
    "start": "1349820",
    "end": "1356390"
  },
  {
    "text": "because you started to putting permissions in the token now we add more API is more API is more API is more",
    "start": "1356390",
    "end": "1361429"
  },
  {
    "text": "applications the tokens get bigger bigger and bigger and that wasn't the intention of an access token right an",
    "start": "1361429",
    "end": "1366830"
  },
  {
    "text": "exit or should be a compact data structure that you ship around so that you can get access to to api's so yeah",
    "start": "1366830",
    "end": "1375770"
  },
  {
    "text": "so what what if I would use this token that I just showed you in my Hospital scenario with the patient a PID oncology",
    "start": "1375770",
    "end": "1382970"
  },
  {
    "text": "API and the cardiac API I'm really hoping that the same doctor who has the change treatment plan permission in",
    "start": "1382970",
    "end": "1389570"
  },
  {
    "text": "oncology doesn't have the same permission in cardiac because he's probably not not qualified for that okay",
    "start": "1389570",
    "end": "1395750"
  },
  {
    "text": "so yeah so that is you know what I in my",
    "start": "1395750",
    "end": "1402200"
  },
  {
    "start": "1397000",
    "end": "1414000"
  },
  {
    "text": "mind is identity is not permissions and I think you shouldn't mix them together it might look sensible to start with it",
    "start": "1402200",
    "end": "1410630"
  },
  {
    "text": "will get out of hand once your system is growing what I think is the case is that",
    "start": "1410630",
    "end": "1416600"
  },
  {
    "start": "1414000",
    "end": "1425000"
  },
  {
    "text": "identity plus a permission system that becomes the actual authorization data",
    "start": "1416600",
    "end": "1422720"
  },
  {
    "text": "and so that's let us to basically",
    "start": "1422720",
    "end": "1428299"
  },
  {
    "start": "1425000",
    "end": "1589000"
  },
  {
    "text": "basically designing the architecture in a way that you have you should have two",
    "start": "1428299",
    "end": "1434030"
  },
  {
    "text": "distinct providers the identity provider and the authorization policy provider",
    "start": "1434030",
    "end": "1440450"
  },
  {
    "text": "and I'm not saying this must be a server or an API whatever just think of that as logical functions in your in your",
    "start": "1440450",
    "end": "1447530"
  },
  {
    "text": "architecture so the way I think we think",
    "start": "1447530",
    "end": "1453140"
  },
  {
    "text": "it works really well is you know the first step is the user logs on to the",
    "start": "1453140",
    "end": "1459140"
  },
  {
    "text": "application you authenticate with the identity provider he gets his tokens the identity token for the client the",
    "start": "1459140",
    "end": "1465110"
  },
  {
    "text": "the access tokens for the api's then then obviously the client the UI has",
    "start": "1465110",
    "end": "1470780"
  },
  {
    "text": "certain authorization requirements like you know showing this button or you know removing this menu item whatever so the",
    "start": "1470780",
    "end": "1477049"
  },
  {
    "text": "UI would connect to the policy provider send in the user's identity get back the",
    "start": "1477049",
    "end": "1482690"
  },
  {
    "text": "UI specific permissions and when the UI talks to the api's each api will have",
    "start": "1482690",
    "end": "1488690"
  },
  {
    "text": "based on the identity of the user probably different authorization requirements so they also connect to the",
    "start": "1488690",
    "end": "1495049"
  },
  {
    "text": "policy provider and they and they're where you get your authorization data from ok and then if you put a nice UI on",
    "start": "1495049",
    "end": "1506179"
  },
  {
    "text": "top of that you make many many people happy right because suddenly a non-technical person or a non developer",
    "start": "1506179",
    "end": "1513980"
  },
  {
    "text": "can change those rules without you having to recompile your code now or think of software that you're shipping",
    "start": "1513980",
    "end": "1520490"
  },
  {
    "text": "to customers right that the end customer should have a nice way to you know to",
    "start": "1520490",
    "end": "1525860"
  },
  {
    "text": "configure who is allowed to change the treatment plan and who's not ok so so basically how policy server",
    "start": "1525860",
    "end": "1533210"
  },
  {
    "text": "works is and that that regardless of the open-source order or the commercial",
    "start": "1533210",
    "end": "1539390"
  },
  {
    "text": "bonus that we have a runtime a client library so to speak yeah and the idea is",
    "start": "1539390",
    "end": "1545179"
  },
  {
    "text": "that the client library takes the identity of the user which is the thing",
    "start": "1545179",
    "end": "1550669"
  },
  {
    "text": "that falls out of the authentication process and sends it to a rule store or",
    "start": "1550669",
    "end": "1558470"
  },
  {
    "text": "a policy store whatever you might want to call it the important part here is the application context right so",
    "start": "1558470",
    "end": "1565720"
  },
  {
    "text": "different applications might have the same user but depending on the context",
    "start": "1565720",
    "end": "1570740"
  },
  {
    "text": "of the application you might get back different permissions mam and you know",
    "start": "1570740",
    "end": "1575750"
  },
  {
    "text": "and we didn't try to do any rocket science here yeah like it's a simple API call you send a list of claims to the",
    "start": "1575750",
    "end": "1582830"
  },
  {
    "text": "server you get back roles and permissions chopped down ok so that was",
    "start": "1582830",
    "end": "1590929"
  },
  {
    "start": "1589000",
    "end": "1657000"
  },
  {
    "text": "the first part about how how we designed that now the second part which is",
    "start": "1590929",
    "end": "1597350"
  },
  {
    "text": "completely independent of if you're using poll server or whatever or building your own whatever is some strategies how to",
    "start": "1597350",
    "end": "1603500"
  },
  {
    "text": "integrate that into client applications so obviously the the at the very most",
    "start": "1603500",
    "end": "1610820"
  },
  {
    "text": "basic level you won't have some sort of client library right so something that",
    "start": "1610820",
    "end": "1617149"
  },
  {
    "text": "the client application or the api's can call obviously you can be as smart as",
    "start": "1617149",
    "end": "1622909"
  },
  {
    "text": "you want in that client library maybe you don't want it to a network round-trip every time maybe you have some caching maybe there are freshness",
    "start": "1622909",
    "end": "1630429"
  },
  {
    "text": "requirements depending on the application right so one application might say my staff changes infrequently",
    "start": "1630429",
    "end": "1636830"
  },
  {
    "text": "so give me a fresh policy every hour whereas maybe you know like in the emergency room the the permission to cut",
    "start": "1636830",
    "end": "1644690"
  },
  {
    "text": "open a patient is something you should check right now and don't wait for an hour for - here so that's one thing let",
    "start": "1644690",
    "end": "1655250"
  },
  {
    "text": "me show you that first so what we have",
    "start": "1655250",
    "end": "1661070"
  },
  {
    "text": "here is a really really simple and and that that's all on github I have a really simple application where you can",
    "start": "1661070",
    "end": "1667009"
  },
  {
    "text": "log in that simulates your identity system ok it could be anything it could be Active Directory it could be identity",
    "start": "1667009",
    "end": "1672889"
  },
  {
    "text": "server it could be whatever you name it ok but the outcome of authentication will always be claims ma'am so we have",
    "start": "1672889",
    "end": "1681200"
  },
  {
    "text": "two users here Alice and Bob obviously and all the other users are patients as",
    "start": "1681200",
    "end": "1688460"
  },
  {
    "text": "you can see because they are very sick okay so when we log in here",
    "start": "1688460",
    "end": "1696639"
  },
  {
    "text": "let's Ellis then all these pages is showing basically is the identity of the",
    "start": "1706090",
    "end": "1713540"
  },
  {
    "text": "user right so in a CHP core you have these so-called schemes that's the password scheme because I came in wire a",
    "start": "1713540",
    "end": "1720049"
  },
  {
    "text": "password and I have two claims one is the subject ID of Ellis which is number one and her display name okay so in this",
    "start": "1720049",
    "end": "1728600"
  },
  {
    "text": "case I'm having my authorization policies in a JSON file could be anything right it could be an API it",
    "start": "1728600",
    "end": "1734330"
  },
  {
    "text": "could be a database whatever but basically that's where we map the identity to application data yeah so in",
    "start": "1734330",
    "end": "1741799"
  },
  {
    "text": "this case you see we have two roles here or free doctor and nurse and patient ma'am there are there are a couple of",
    "start": "1741799",
    "end": "1752000"
  },
  {
    "text": "ways how you can map use us to application roles one is static mappings obviously right if you have all the user",
    "start": "1752000",
    "end": "1758150"
  },
  {
    "text": "names or the subject that is you can just put them into application roles and another thing is it's dynamic mapping so",
    "start": "1758150",
    "end": "1766370"
  },
  {
    "text": "when the identity system emits a certain claim for example we can automatically",
    "start": "1766370",
    "end": "1772460"
  },
  {
    "text": "map him to the to the doctor application role yeah or you could come up with arbitrary expressions that's what we do",
    "start": "1772460",
    "end": "1780080"
  },
  {
    "text": "in our commercial product where you can just write c-sharp code yeah and it then basically based on the incoming claims",
    "start": "1780080",
    "end": "1786230"
  },
  {
    "text": "you map them to two arbitrary application roles you see here the patients the patients don't have any",
    "start": "1786230",
    "end": "1792470"
  },
  {
    "text": "status static mapping at all so anybody who has an identity role of customer is",
    "start": "1792470",
    "end": "1797570"
  },
  {
    "text": "a patient from our point of view okay and then here in this section you have",
    "start": "1797570",
    "end": "1803660"
  },
  {
    "text": "two permissions so we have a C patient and a perform 30 permission and we can basically specify who is allowed to do",
    "start": "1803660",
    "end": "1810770"
  },
  {
    "text": "that perform surgery is done by the doctor request pain medication should",
    "start": "1810770",
    "end": "1816410"
  },
  {
    "text": "only be done by patients okay so and then in my in my few here oh that's what",
    "start": "1816410",
    "end": "1827929"
  },
  {
    "text": "I wanted we have basically a service",
    "start": "1827929",
    "end": "1833690"
  },
  {
    "text": "living in the DI container the policies of our client we are read",
    "start": "1833690",
    "end": "1839570"
  },
  {
    "text": "the policy from the Chasen file in this case and that makes available a policy server runtime client object that you",
    "start": "1839570",
    "end": "1847100"
  },
  {
    "text": "can now inject into the constructor and then you can just call that by saying evaluate async and you pass in the",
    "start": "1847100",
    "end": "1855200"
  },
  {
    "text": "claims that you want to run the evaluation on and that might be your current user which is in this case it's",
    "start": "1855200",
    "end": "1861590"
  },
  {
    "text": "the current user right but we you can pass in an arbitrary claims principle so if you want to construct an identity on",
    "start": "1861590",
    "end": "1867170"
  },
  {
    "text": "the fly and say okay what would this user or this identity be allowed to do you could do that or if you want to",
    "start": "1867170",
    "end": "1873080"
  },
  {
    "text": "figure out what other users are allowed to do you know same idea so when we run it again",
    "start": "1873080",
    "end": "1880240"
  },
  {
    "text": "okay so now we are seeing the results of that policy so it's a el√≠as it's a",
    "start": "1887580",
    "end": "1893230"
  },
  {
    "text": "doctor so he has two doctor role and we have to free the free permissions that",
    "start": "1893230",
    "end": "1899020"
  },
  {
    "text": "she has and if I would remove Alice you know just say it's not one and two it's",
    "start": "1899020",
    "end": "1905250"
  },
  {
    "text": "free and two then obviously Elias wouldn't have those permissions that",
    "start": "1905250",
    "end": "1910990"
  },
  {
    "text": "make sense okay so you know if you're",
    "start": "1910990",
    "end": "1917560"
  },
  {
    "text": "writing a brand new application this might be all you need right you're having this client library you're",
    "start": "1917560",
    "end": "1922690"
  },
  {
    "text": "calling into it and based on that you're building your your logic another",
    "start": "1922690",
    "end": "1928360"
  },
  {
    "text": "approach you can take and I'm not to be honest I'm I'm not a",
    "start": "1928360",
    "end": "1934390"
  },
  {
    "text": "fan at all of the authorized attribute with the roles equals something because I think this leads to really hard to",
    "start": "1934390",
    "end": "1940480"
  },
  {
    "text": "maintain code because you know that might work well if some person on stage",
    "start": "1940480",
    "end": "1947740"
  },
  {
    "text": "demos that with with one controller like like like I'm doing right now yeah but once you have more controllers you're",
    "start": "1947740",
    "end": "1954010"
  },
  {
    "text": "many controllers and you have these roles sprinkled everywhere it's really",
    "start": "1954010",
    "end": "1959680"
  },
  {
    "text": "hard to remain maintain that code but I and that's the other thing I learned",
    "start": "1959680",
    "end": "1966310"
  },
  {
    "text": "while talking to customers many different people have different styles okay and I guess I have to accept that",
    "start": "1966310",
    "end": "1971950"
  },
  {
    "text": "not always my style is the best I guess anyways so let's say you have an",
    "start": "1971950",
    "end": "1980020"
  },
  {
    "text": "existing investment into into the authorized attribute okay or you just like that or maybe you want to use you",
    "start": "1980020",
    "end": "1986410"
  },
  {
    "text": "know the built-in dotnet API is that work with claims like you know fine",
    "start": "1986410",
    "end": "1992920"
  },
  {
    "text": "first and find all and has claim and all these things another possible way to",
    "start": "1992920",
    "end": "1998290"
  },
  {
    "text": "approach that would be to automatically call the policy system so one other",
    "start": "1998290",
    "end": "2005130"
  },
  {
    "text": "thing we have here is a middleware yeah and all this middleware really does is",
    "start": "2005130",
    "end": "2010410"
  },
  {
    "text": "it runs after the user has been authenticated and it takes the current user calls the policy system gets back",
    "start": "2010410",
    "end": "2017870"
  },
  {
    "text": "gets back to permission rolls and turns them into planes okay so",
    "start": "2017870",
    "end": "2023610"
  },
  {
    "text": "when I run that again now with the Edit with the Edit middleware I should see an",
    "start": "2023610",
    "end": "2033720"
  },
  {
    "text": "another authentication scheme in my application one is the identity the password that's how we authenticate it",
    "start": "2033720",
    "end": "2039870"
  },
  {
    "text": "and the other one is called you know policy or middleware whatever so in other words that's a low-level feature",
    "start": "2039870",
    "end": "2046769"
  },
  {
    "text": "of claims principle if you if you have ever seen that claims principle can act as a container for multiple claims",
    "start": "2046769",
    "end": "2053220"
  },
  {
    "text": "identities so you don't need to have only one identity in your principle you",
    "start": "2053220",
    "end": "2058530"
  },
  {
    "text": "can have more than one so and in this case this one here represents the authentication data in this case here it",
    "start": "2058530",
    "end": "2065040"
  },
  {
    "text": "represents the permissions and the roads okay and now since they are now claims",
    "start": "2065040",
    "end": "2070679"
  },
  {
    "text": "in the principle you can use you know your your beloved authorize attribute",
    "start": "2070679",
    "end": "2078648"
  },
  {
    "text": "with the roles equal something or you can just say you know use our thought has claimed this or user dot you know",
    "start": "2078649",
    "end": "2085440"
  },
  {
    "text": "whatever now so that's the nurses only action whatever nurses only means so if",
    "start": "2085440",
    "end": "2093060"
  },
  {
    "text": "I would execute that I'm a doctor I shouldn't get access okay but if I'm a",
    "start": "2093060",
    "end": "2099140"
  },
  {
    "text": "nurse no no I'm a nurse I should be able",
    "start": "2099140",
    "end": "2105359"
  },
  {
    "text": "to do whatever nurses do okay so that's",
    "start": "2105359",
    "end": "2112140"
  },
  {
    "start": "2111000",
    "end": "2298000"
  },
  {
    "text": "another approach ma'am",
    "start": "2112140",
    "end": "2116210"
  },
  {
    "text": "or you come up you know if you have the",
    "start": "2120630",
    "end": "2125650"
  },
  {
    "text": "luxury of using HP nerdcore they have a new built-in authorization api which is",
    "start": "2125650",
    "end": "2131050"
  },
  {
    "text": "actually far superior than what we had before it's called policy based authorization",
    "start": "2131050",
    "end": "2136300"
  },
  {
    "text": "and now the word policy gets completely overloaded but the point is you know my main points of criticism the 50:50",
    "start": "2136300",
    "end": "2142750"
  },
  {
    "text": "authorized attribute were that you are coupling together authorization logic and controller logic in in one place",
    "start": "2142750",
    "end": "2148840"
  },
  {
    "text": "that that developer at development time already needs to know who will be allowed to call this code which might",
    "start": "2148840",
    "end": "2155560"
  },
  {
    "text": "not be the case so separation of concerns and",
    "start": "2155560",
    "end": "2160980"
  },
  {
    "text": "testability right I mean have you ever tried to write an automatic test that makes sure you have the right authorized",
    "start": "2160980",
    "end": "2166870"
  },
  {
    "text": "attributes in the right place it's it's messy okay so we were talking to",
    "start": "2166870",
    "end": "2172570"
  },
  {
    "text": "Microsoft for many many years and said like listen we need something better than this yeah but they didn't have the",
    "start": "2172570",
    "end": "2178510"
  },
  {
    "text": "luxury of doing breaking changes so much until a spinet core came by where they",
    "start": "2178510",
    "end": "2184680"
  },
  {
    "text": "exercise that luxury quite a bit and we gave them a prototype and okay here's",
    "start": "2184680",
    "end": "2191740"
  },
  {
    "text": "our prototype can you make it pretty and the main blocker back then to make it",
    "start": "2191740",
    "end": "2196960"
  },
  {
    "text": "pretty was that the lack of dependency injection in in in in asp.net so when",
    "start": "2196960",
    "end": "2202180"
  },
  {
    "text": "they released a speed core they also had a new security guy on the team which",
    "start": "2202180",
    "end": "2208090"
  },
  {
    "text": "happens to be a friend of mine maybe Ted has helped and he basically took that and and put it into the product and it's",
    "start": "2208090",
    "end": "2214870"
  },
  {
    "text": "called policy based authorization and the idea is it tries to solve all the the pain points mainly the decoupling of",
    "start": "2214870",
    "end": "2223020"
  },
  {
    "text": "authorization logic from your actual code and the testability ma'am oh and by",
    "start": "2223020",
    "end": "2229270"
  },
  {
    "text": "the way that the most common question I get when I show that it's like does that also work with nbc5 and with the API and",
    "start": "2229270",
    "end": "2236020"
  },
  {
    "text": "he answers yes there's a guy David parks eight who begged ported the whole thing",
    "start": "2236020",
    "end": "2242230"
  },
  {
    "text": "to to katana so you're now you can use that now in in pre-aids peanut core code so how does it",
    "start": "2242230",
    "end": "2251590"
  },
  {
    "text": "work the idea of the policy system is that you can as I said separate the policy",
    "start": "2251590",
    "end": "2259060"
  },
  {
    "text": "logic from the actual controller logic so the idea is you're putting the so-called authorization policies into",
    "start": "2259060",
    "end": "2265750"
  },
  {
    "text": "the DI container you give them a name and policies are basically a list of named requirements ma'am",
    "start": "2265750",
    "end": "2273040"
  },
  {
    "text": "so you can basically say okay to be able to prescribe medication the user must be authenticated you must have a permission",
    "start": "2273040",
    "end": "2278950"
  },
  {
    "text": "of prescribe medication but you can make these policies arbitrarily complex may",
    "start": "2278950",
    "end": "2284170"
  },
  {
    "text": "also you can you know could call the database or whatever you want to do okay",
    "start": "2284170",
    "end": "2289900"
  },
  {
    "text": "so let's just copy this guy over to my",
    "start": "2289900",
    "end": "2298030"
  },
  {
    "start": "2298000",
    "end": "2382000"
  },
  {
    "text": "code here okay so now I have a policy",
    "start": "2298030",
    "end": "2309370"
  },
  {
    "text": "called prescribe medication I think in my code I call it differently let's have a look oh it's called performed surgery",
    "start": "2309370",
    "end": "2316630"
  },
  {
    "text": "okay whatever prescribe medication prescribed medication okay so what",
    "start": "2316630",
    "end": "2326440"
  },
  {
    "text": "happens now is this when I hit the the prescribed medication function it basically looks in after the I container",
    "start": "2326440",
    "end": "2333100"
  },
  {
    "text": "finds that policy execute it right and if the policy is succeeds you are",
    "start": "2333100",
    "end": "2339220"
  },
  {
    "text": "allowed access the nice thing about that is now that that when your requirements",
    "start": "2339220",
    "end": "2345160"
  },
  {
    "text": "change you only have to change them in one place and all the controllers where you think the policy gets gets the",
    "start": "2345160",
    "end": "2350920"
  },
  {
    "text": "update for free so to speak so we've said in place so have a look you must",
    "start": "2350920",
    "end": "2357100"
  },
  {
    "text": "have the permission of prescribe medication to call this thing let's have a look if I log in as a as a doctor I",
    "start": "2357100",
    "end": "2365340"
  },
  {
    "text": "should have this permission and that's working okay whereas if I'm a patient",
    "start": "2365340",
    "end": "2373770"
  },
  {
    "text": "then who is a patient you know he shouldn't be allowed to do that that",
    "start": "2373770",
    "end": "2379240"
  },
  {
    "text": "makes sense okay so that's a nice system and as I",
    "start": "2379240",
    "end": "2385750"
  },
  {
    "start": "2382000",
    "end": "2498000"
  },
  {
    "text": "said it's a it's extensible I'm gonna show you an example of that in a second",
    "start": "2385750",
    "end": "2390999"
  },
  {
    "text": "oh yeah the other nice thing I like I like about a new policy API is that you can use it programmatically so I",
    "start": "2390999",
    "end": "2396220"
  },
  {
    "text": "personally am NOT a huge fan of attributes I never understood why dotnet developers so much laughs their",
    "start": "2396220",
    "end": "2403119"
  },
  {
    "text": "attributes I mean it's code a path the method name as opposed to code below the method name it's but it's code right so the nice",
    "start": "2403119",
    "end": "2412059"
  },
  {
    "text": "thing about the new policy API in a spirit koi is that it's just a service in the DI container you can get a",
    "start": "2412059",
    "end": "2417759"
  },
  {
    "text": "dependency on your I authorization service here and then you can call these policies imperatively now and again",
    "start": "2417759",
    "end": "2425109"
  },
  {
    "text": "what's nice is you can pass in the user you want to test against okay so it can",
    "start": "2425109",
    "end": "2430960"
  },
  {
    "text": "be the current user it can be a different user and you're getting back a true or false basically and can act on",
    "start": "2430960",
    "end": "2437740"
  },
  {
    "text": "that okay and that is basically a you",
    "start": "2437740",
    "end": "2442839"
  },
  {
    "text": "know DTD or the authorized attribute has a pretty static behavior right yes or no more or less yeah but what if let's say",
    "start": "2442839",
    "end": "2449710"
  },
  {
    "text": "you wanna if he's not allowed to prescribe the medication maybe the user",
    "start": "2449710",
    "end": "2455259"
  },
  {
    "text": "should be able to see the list of medication that has been prescribed but not be able to add something to it right",
    "start": "2455259",
    "end": "2461319"
  },
  {
    "text": "then the authorized attribute wouldn't work here so here with code you have all the flexibility you need the other nice",
    "start": "2461319",
    "end": "2468489"
  },
  {
    "text": "thing about that is that now you can test your policies automatically right so you can now write automated tests you",
    "start": "2468489",
    "end": "2474279"
  },
  {
    "text": "create users with certain claims your shapes and forms you feed them into the policy and you can make sure that you",
    "start": "2474279",
    "end": "2480759"
  },
  {
    "text": "get back expected results yeah and when some other person six months down the",
    "start": "2480759",
    "end": "2487239"
  },
  {
    "text": "line has the task to extend the system and it changes the policies your tests will show him immediately if he broke",
    "start": "2487239",
    "end": "2493779"
  },
  {
    "text": "the policies or or not right so that's I think very nice the other thing you can",
    "start": "2493779",
    "end": "2500380"
  },
  {
    "start": "2498000",
    "end": "2543000"
  },
  {
    "text": "do which I think you shouldn't do but I'm showing you nevertheless is you can now do dependency injection in fuse so",
    "start": "2500380",
    "end": "2507579"
  },
  {
    "text": "you can get get your I offer ization service infuse and conditionally render",
    "start": "2507579",
    "end": "2514299"
  },
  {
    "text": "UI is based on the permissions of the user ma'am I don't like this approach too much because it you know",
    "start": "2514299",
    "end": "2520530"
  },
  {
    "text": "more code on views which i think is a not necessarily the best idea but I've",
    "start": "2520530",
    "end": "2526200"
  },
  {
    "text": "seen that being used quite for a good cause in my in layout pages right but",
    "start": "2526200",
    "end": "2532680"
  },
  {
    "text": "you have like your master a navigation system and maybe based on on the user",
    "start": "2532680",
    "end": "2538070"
  },
  {
    "text": "properties you are showing different things ma'am the only thing that's weird",
    "start": "2538070",
    "end": "2545730"
  },
  {
    "start": "2543000",
    "end": "2580000"
  },
  {
    "text": "now yeah with this approach is when we look back on our on our policy",
    "start": "2545730",
    "end": "2553950"
  },
  {
    "text": "definition here is now now that you have to create a policy for each permission you have in the system which I don't",
    "start": "2553950",
    "end": "2560310"
  },
  {
    "text": "think is the right thing if you want to create a policy which is more complex and as a part of that checks a",
    "start": "2560310",
    "end": "2568230"
  },
  {
    "text": "permission that's fine but if you have like a one-to-one mapping from policy names to permission names that doesn't",
    "start": "2568230",
    "end": "2574410"
  },
  {
    "text": "sound like the right thing to do or at least it's it's a bit tedious right so",
    "start": "2574410",
    "end": "2579570"
  },
  {
    "text": "there's a nice feature in ASP nerdcore which is called an authorization policy provider just to make it even more",
    "start": "2579570",
    "end": "2586850"
  },
  {
    "start": "2580000",
    "end": "2661000"
  },
  {
    "text": "complicating yeah and the idea is that you did there's an API that you can",
    "start": "2586850",
    "end": "2593310"
  },
  {
    "text": "implement that creates authorization policies on the fly for you so you don't have to statically define them but",
    "start": "2593310",
    "end": "2600090"
  },
  {
    "text": "basically you get to see the name the string and then you can create them or fabricate them on the fly so what we did",
    "start": "2600090",
    "end": "2607380"
  },
  {
    "text": "with with that feature is when I add that here it wires up a so called policy",
    "start": "2607380",
    "end": "2613920"
  },
  {
    "text": "provider and now whenever the policy system sees something like this it first",
    "start": "2613920",
    "end": "2619440"
  },
  {
    "text": "checks is there a statically defined policy in my application and if not I'm just going",
    "start": "2619440",
    "end": "2625110"
  },
  {
    "text": "to create one that just checks for the permission with the same name okay that's quite nice so even if this policy",
    "start": "2625110",
    "end": "2632010"
  },
  {
    "text": "is now not statically defined it should",
    "start": "2632010",
    "end": "2639240"
  },
  {
    "text": "still work and you can see that it works because I don't get an exception because otherwise I would get an exception here",
    "start": "2639240",
    "end": "2644490"
  },
  {
    "text": "okay so it it still works as as expected so that's quite nice as well and the",
    "start": "2644490",
    "end": "2651240"
  },
  {
    "text": "last thing I think I want to talk about is a cost requirements so the one thing I don't",
    "start": "2651240",
    "end": "2659550"
  },
  {
    "text": "like about the policy system is not the pole system itself but the way it's",
    "start": "2659550",
    "end": "2665250"
  },
  {
    "start": "2661000",
    "end": "2917000"
  },
  {
    "text": "mostly presented and it gives you the impression that to check something with",
    "start": "2665250",
    "end": "2670980"
  },
  {
    "text": "this API you need claims for that right so you want to check that whatever",
    "start": "2670980",
    "end": "2677040"
  },
  {
    "text": "create a claim for it put it on the claim principle that's how it works that's not how it works yeah it's just",
    "start": "2677040",
    "end": "2682920"
  },
  {
    "text": "what Microsoft gives you out-of-the-box yeah this require claim method is",
    "start": "2682920",
    "end": "2687960"
  },
  {
    "text": "actually an extension method and you can write your own extension methods which wire up your own custom requirements so",
    "start": "2687960",
    "end": "2695970"
  },
  {
    "text": "that would be a custom requirement yeah so let's say yeah in addition to the",
    "start": "2695970",
    "end": "2701310"
  },
  {
    "text": "prescribed medication thing you you you need more input data yeah like what kind",
    "start": "2701310",
    "end": "2706710"
  },
  {
    "text": "of medication do you want to prescribe and how much of it okay and to do that you just derived from I",
    "start": "2706710",
    "end": "2714300"
  },
  {
    "text": "offer a sation requirement which is just a marker interface it's it's for di purposes and you model your domain data",
    "start": "2714300",
    "end": "2720390"
  },
  {
    "text": "and then basically the trick here is is that you're writing a class that checks",
    "start": "2720390",
    "end": "2727020"
  },
  {
    "text": "the requirement at runtime so you see basically here it's an authorization",
    "start": "2727020",
    "end": "2732720"
  },
  {
    "text": "Handler of tea and the tea is your custom requirement and what we are doing now we are inside the custom requirement",
    "start": "2732720",
    "end": "2740160"
  },
  {
    "text": "handler we are using our client library to now check permissions right which makes total sense because you're having",
    "start": "2740160",
    "end": "2745350"
  },
  {
    "text": "this client library and you can use it wherever it makes sense so you can see that the logic is a bit contrived here",
    "start": "2745350",
    "end": "2751110"
  },
  {
    "text": "but you know if you have the permission of prescribing medication that's good if there if the amount is less than 10 you",
    "start": "2751110",
    "end": "2756660"
  },
  {
    "text": "are allowed otherwise you need to be a doctor and if it's a placebo well the nurse can do it as well regardless of",
    "start": "2756660",
    "end": "2763050"
  },
  {
    "text": "the amount right and when when you have this guy you put it into the DI",
    "start": "2763050",
    "end": "2768840"
  },
  {
    "text": "container here yeah that's a medication requirement handler and then whenever you are invoking a policy that has this",
    "start": "2768840",
    "end": "2779310"
  },
  {
    "text": "requirement your handler will be called and you are allowed to run whatever code you need to run to come to an",
    "start": "2779310",
    "end": "2784920"
  },
  {
    "text": "authorization decision so let's see",
    "start": "2784920",
    "end": "2790380"
  },
  {
    "text": "here's the prescribed medication action right it has a name in the mound you are newing up this medication",
    "start": "2790380",
    "end": "2796140"
  },
  {
    "text": "requirement object and then you're passing it in in the authorized async method here's the user here's the",
    "start": "2796140",
    "end": "2801990"
  },
  {
    "text": "requirement and again it will tell you is this allowed or is it not allowed no so I guess when I run it again Here I am",
    "start": "2801990",
    "end": "2811190"
  },
  {
    "text": "I am a patient so I can't I can't do anything here let's go back and be a",
    "start": "2811190",
    "end": "2818160"
  },
  {
    "text": "nurse okay so prescribe 10 milligrams",
    "start": "2818160",
    "end": "2824280"
  },
  {
    "text": "aspirin that works 20 shouldn't work okay a ton of placebo yes works okay so",
    "start": "2824280",
    "end": "2834240"
  },
  {
    "text": "that's how you can encapsulate more complicated authorization rules into these requirement handlers and then you",
    "start": "2834240",
    "end": "2841170"
  },
  {
    "text": "give you our developers pretty you know simple to use API authorized acing user",
    "start": "2841170",
    "end": "2848840"
  },
  {
    "text": "requirement and then you know magic happens okay so that's the other thing",
    "start": "2848840",
    "end": "2858560"
  },
  {
    "text": "yeah we've seen that the last thing I want to mention here with regards to a spirit core is thereby also global a",
    "start": "2858560",
    "end": "2865740"
  },
  {
    "text": "spinet cauterization policy so the same policy system that you've just seen that",
    "start": "2865740",
    "end": "2871410"
  },
  {
    "text": "you can put into di you can also hardwire to MVC it's an MVC feature really yeah",
    "start": "2871410",
    "end": "2877380"
  },
  {
    "text": "so basically inside when you spend when you call add and we see you have this options action and then you can create a",
    "start": "2877380",
    "end": "2883110"
  },
  {
    "text": "policy and this policy can be arbitrarily complex but it can be easy like only authenticate users it can be a",
    "start": "2883110",
    "end": "2889020"
  },
  {
    "text": "little bit more not so easy or I can again include custom requirements which",
    "start": "2889020",
    "end": "2895170"
  },
  {
    "text": "makes custom code run and so on so you can make it as sophisticated as you want I guess and then you're just putting",
    "start": "2895170",
    "end": "2901770"
  },
  {
    "text": "that policy on an authorization filter and attach that to the filters pipeline and then it will run for every incoming",
    "start": "2901770",
    "end": "2908640"
  },
  {
    "text": "requests into the application and that's you know also quite useful to have okay",
    "start": "2908640",
    "end": "2917690"
  },
  {
    "start": "2917000",
    "end": "2984000"
  },
  {
    "text": "so coming back to my slide yeah that's my",
    "start": "2917690",
    "end": "2924170"
  },
  {
    "text": "summary again you might come to different conclusions that that's just how we think it works for us and we have",
    "start": "2924170",
    "end": "2929900"
  },
  {
    "text": "implemented it a couple of times successfully in in different projects but you know if it's all about global",
    "start": "2929900",
    "end": "2936859"
  },
  {
    "text": "application access use the global policy yeah use access tokens if it's about feature access I think roles permissions",
    "start": "2936859",
    "end": "2943519"
  },
  {
    "text": "work really well once you are inside the feature yeah I don't think it's",
    "start": "2943519",
    "end": "2950390"
  },
  {
    "text": "authorization anymore I think it's business logic and to be honest that the medication example I gave you with the",
    "start": "2950390",
    "end": "2955700"
  },
  {
    "text": "amount and the type of medication that is already pretty crossing the line I",
    "start": "2955700",
    "end": "2961640"
  },
  {
    "text": "think to to business logic right because you probably if you're building hospitals of you probably have as a core",
    "start": "2961640",
    "end": "2968269"
  },
  {
    "text": "business feature an understanding of how much a patient can take from which",
    "start": "2968269",
    "end": "2973579"
  },
  {
    "text": "whatever so it's you know it's already already might violate this right which",
    "start": "2973579",
    "end": "2978769"
  },
  {
    "text": "what I'm saying is it's pretty easy to get that wrong ma'am how much time do we",
    "start": "2978769",
    "end": "2984140"
  },
  {
    "start": "2984000",
    "end": "2993000"
  },
  {
    "text": "have ten more minutes so whatever I can quickly show you is this their UI week we created for that which is not part of",
    "start": "2984140",
    "end": "2990589"
  },
  {
    "text": "the open source version but you know you need you guys to make managers happy no",
    "start": "2990589",
    "end": "3002579"
  },
  {
    "start": "2993000",
    "end": "3184000"
  },
  {
    "text": "okay so same idea just that you now can graphically manage these things so this",
    "start": "3002579",
    "end": "3008079"
  },
  {
    "text": "would be our same example as we've seen and in the code right it's the emergency room application where we have talked us",
    "start": "3008079",
    "end": "3014079"
  },
  {
    "text": "nurses and patients and you can see that you see that you can assign users to",
    "start": "3014079",
    "end": "3020230"
  },
  {
    "text": "application roles either aesthetically by user IDs or by virtue of mapping",
    "start": "3020230",
    "end": "3025859"
  },
  {
    "text": "incoming roles into it or here's an example of often of a c-sharp expression",
    "start": "3025859",
    "end": "3031569"
  },
  {
    "text": "so if the if the person is very sick he must be a patient okay and then you can",
    "start": "3031569",
    "end": "3037720"
  },
  {
    "text": "go to the permissions and assign that here another example would be a more",
    "start": "3037720",
    "end": "3044559"
  },
  {
    "text": "complicated one again this was inspired by my customer that builds hospital software so they start",
    "start": "3044559",
    "end": "3050319"
  },
  {
    "text": "with a single application right and build their own authorization system build their own authentication system and nowaday they",
    "start": "3050319",
    "end": "3056560"
  },
  {
    "text": "created the second one and the third one and now they needed to share users between those and give them single sign-on so that's where identity came in",
    "start": "3056560",
    "end": "3062680"
  },
  {
    "text": "but now they realized even the the same doctor has access to free systems but has different permissions also they",
    "start": "3062680",
    "end": "3068770"
  },
  {
    "text": "built three times a permission system for each application so the way we can solve that for example is with you know",
    "start": "3068770",
    "end": "3081420"
  },
  {
    "text": "with child policies okay so we have a top-level policy called hospital system",
    "start": "3081480",
    "end": "3086500"
  },
  {
    "text": "right and you can have your user mappings on top like whose admin whose back office employees problem but you",
    "start": "3086500",
    "end": "3093820"
  },
  {
    "text": "see no permissions here now this is just the container and then we have sub policies which are the actual",
    "start": "3093820",
    "end": "3099610"
  },
  {
    "text": "applications here so in medical records you know you have things like create delete update in accounting you have pay",
    "start": "3099610",
    "end": "3108730"
  },
  {
    "text": "invoice whatever and now you can use the roles and use us you had at the top",
    "start": "3108730",
    "end": "3114250"
  },
  {
    "text": "level to map them to permissions in choice level for example um and I",
    "start": "3114250",
    "end": "3119500"
  },
  {
    "text": "mentioned earlier that some people like the resource-based view of the world so that's something you can do as well so",
    "start": "3119500",
    "end": "3126490"
  },
  {
    "text": "in this case I'll let's say github yeah would use our software they probably will never do that but anyways so github",
    "start": "3126490",
    "end": "3134650"
  },
  {
    "text": "defines a couple of you know roles and permissions like you know owner and contributor and you know you create repo",
    "start": "3134650",
    "end": "3141310"
  },
  {
    "text": "and merge PR and these things right and then when Dominic creates an account",
    "start": "3141310",
    "end": "3147070"
  },
  {
    "text": "with github you could create a child policy called Dominic yeah and then when Toni creates a repo that could have a",
    "start": "3147070",
    "end": "3152620"
  },
  {
    "text": "child policy called repo one and now Dominic could you know in the UI allow I",
    "start": "3152620",
    "end": "3158290"
  },
  {
    "text": "don't know Philip to merge appear okay and that's more like a resource based",
    "start": "3158290",
    "end": "3163450"
  },
  {
    "text": "thing where you attach permissions to a resource tree in your system and you can do inheritance on that as well yeah so",
    "start": "3163450",
    "end": "3172080"
  },
  {
    "text": "that's our current thinking as I said it's a it's a bit of a brain dump of of",
    "start": "3172080",
    "end": "3177520"
  },
  {
    "text": "the things we we did for the last year it works so far I must say it works really well",
    "start": "3177520",
    "end": "3183850"
  },
  {
    "text": "as I said the all the code you've seen is on github so if you like that pattern",
    "start": "3183850",
    "end": "3189910"
  },
  {
    "start": "3184000",
    "end": "3240000"
  },
  {
    "text": "yeah just take it change it to whatever you want here you can also see the the",
    "start": "3189910",
    "end": "3199950"
  },
  {
    "text": "documentation for the A's peanut co-op policy system which is quite good and",
    "start": "3199950",
    "end": "3206230"
  },
  {
    "text": "the first one was a blog post I wrote two years ago that kick-started the",
    "start": "3206230",
    "end": "3212440"
  },
  {
    "text": "whole the whole thing that's all I have thank you very much and because I always",
    "start": "3212440",
    "end": "3219100"
  },
  {
    "text": "forget there are stickers thank you",
    "start": "3219100",
    "end": "3222750"
  }
]