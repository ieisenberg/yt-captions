[
  {
    "text": "okay welcome back I guess who was in our talk before okay good",
    "start": "5029",
    "end": "13110"
  },
  {
    "text": "so the first talk was all about identity server right an identity server is all about authentication so you know you",
    "start": "13110",
    "end": "20609"
  },
  {
    "text": "want to know who the user is and you have probably simple to complex requirements how that happens right from",
    "start": "20609",
    "end": "28050"
  },
  {
    "text": "names and passwords over Federation of a business partner p2p b2c or all kinds of",
    "start": "28050",
    "end": "34070"
  },
  {
    "text": "requirements so that's what identity server is really really good at right",
    "start": "34070",
    "end": "39809"
  },
  {
    "text": "it's it's small as a turnkey solution that that implements the most common things out of the box and if you want to",
    "start": "39809",
    "end": "46430"
  },
  {
    "text": "implement something which is not so common you have to the extensibility points to do that but once you are done",
    "start": "46430",
    "end": "54690"
  },
  {
    "text": "with authentication you inevitably will hit the problem okay so now I know who",
    "start": "54690",
    "end": "59699"
  },
  {
    "text": "the user is what is he allowed to do okay and you know our customers were asking us like",
    "start": "59699",
    "end": "66330"
  },
  {
    "text": "so can't you just build something else like that you know we just put it in our",
    "start": "66330",
    "end": "72840"
  },
  {
    "text": "pipeline and and and chop is done and it turns out that this is not so easy right so since we had these questions over and",
    "start": "72840",
    "end": "81570"
  },
  {
    "text": "over again for the last couple of years so for the last 12 months so we did an interview a year ago here in London and",
    "start": "81570",
    "end": "88829"
  },
  {
    "text": "said 2017 will be the year we we think about authorization like dedicated ma'am",
    "start": "88829",
    "end": "94500"
  },
  {
    "text": "and yet what we did and we basically started by am observing how our",
    "start": "94500",
    "end": "100619"
  },
  {
    "text": "customers want to implement authorization and and how they do it and how they have done in the past and how",
    "start": "100619",
    "end": "106320"
  },
  {
    "text": "they would like to do it and so on and to just get a better understanding how",
    "start": "106320",
    "end": "111500"
  },
  {
    "text": "that would work right and always keep in mind there's there's this problem",
    "start": "111500",
    "end": "117840"
  },
  {
    "text": "between what can you generalize and what is so application specific that it doesn't make sense to generalize it okay",
    "start": "117840",
    "end": "124740"
  },
  {
    "text": "so it turns out all four as a she's hard did you know that",
    "start": "124740",
    "end": "131420"
  },
  {
    "text": "so all the systems we looked at yeah we saw things like you know roles and",
    "start": "132510",
    "end": "140530"
  },
  {
    "text": "permissions and maybe actors you know access control list some some some you know inspired by by what Windows is",
    "start": "140530",
    "end": "147700"
  },
  {
    "text": "doing yeah where you attach permissions or rights to objects in your database things like that with all the problems",
    "start": "147700",
    "end": "154000"
  },
  {
    "text": "like orphanage and and inheritance and so on x a como has anyone ever used X a",
    "start": "154000",
    "end": "161050"
  },
  {
    "text": "camel he extends a extensible applicant",
    "start": "161050",
    "end": "167140"
  },
  {
    "text": "role markup language right I recently complained about that I I",
    "start": "167140",
    "end": "172810"
  },
  {
    "text": "don't want to formulate my business problems in XML and someone said oh they support Jason now as well anyway so you",
    "start": "172810",
    "end": "183550"
  },
  {
    "text": "know whenever I asked people is anyone using XML I see one or two hands in in a",
    "start": "183550",
    "end": "188590"
  },
  {
    "text": "comparable crowd so that tells me not many people are using it and I think they exactly had their problem they",
    "start": "188590",
    "end": "194950"
  },
  {
    "text": "wanted to do too much right they wanted you to model business rules in XML or or",
    "start": "194950",
    "end": "200890"
  },
  {
    "text": "Jason yeah but the problem is you ended up with like sidelong XML stuff for a",
    "start": "200890",
    "end": "208750"
  },
  {
    "text": "problem that you could solve in two lines of c-sharp code right so again",
    "start": "208750",
    "end": "214030"
  },
  {
    "text": "there's a blurry line I think between authorization and and business rules yeah and I think business rules are",
    "start": "214030",
    "end": "221260"
  },
  {
    "text": "better implemented in the language and in the system where the business is actually being implemented as well there",
    "start": "221260",
    "end": "226810"
  },
  {
    "text": "are other things can be externalized and I think we did the only two things that we identified across the board of all",
    "start": "226810",
    "end": "233830"
  },
  {
    "text": "the people we asked is roles and permissions right role based authorization for more coarse-grained",
    "start": "233830",
    "end": "240840"
  },
  {
    "text": "questions and permission based authorization for more finer grained",
    "start": "240840",
    "end": "245890"
  },
  {
    "text": "authorization decisions you know where you basically have users users are in application roles and you map",
    "start": "245890",
    "end": "251110"
  },
  {
    "text": "permissions to roles right and so you get like you know a multi-leveled",
    "start": "251110",
    "end": "258150"
  },
  {
    "text": "abstraction okay now the the architectures we typically work with",
    "start": "258150",
    "end": "264760"
  },
  {
    "text": "look like this right you have multiple client applications you have back-end services spec and replications and",
    "start": "264760",
    "end": "270250"
  },
  {
    "text": "typically when we are done you will have an identity provider okay and this",
    "start": "270250",
    "end": "275950"
  },
  {
    "text": "identity provider as the name implies is for providing identity right identity is something Universal yeah so I am the",
    "start": "275950",
    "end": "284230"
  },
  {
    "text": "same Dominic wherever I log into in this application ecosystem so it's a very",
    "start": "284230",
    "end": "289360"
  },
  {
    "text": "tempting a very tempting idea to now put all of your authorization logic into the",
    "start": "289360",
    "end": "295720"
  },
  {
    "text": "identity provider right so we have we now have this central thing right and we have this new Hemmer called claims now",
    "start": "295720",
    "end": "304360"
  },
  {
    "text": "everything will become an ale yeah and and the problem I see with that",
    "start": "304360",
    "end": "310600"
  },
  {
    "text": "as I just said identity is universal I am the same Dominic wherever I log in but permissions of something very very",
    "start": "310600",
    "end": "317530"
  },
  {
    "text": "application specific right so you know I might have different permissions in application 8 and an application P but",
    "start": "317530",
    "end": "324220"
  },
  {
    "text": "they all share the same identity provider so mixing the two concepts together of identity and permission will",
    "start": "324220",
    "end": "332560"
  },
  {
    "text": "lead to problems yeah I wrote a blog post two years ago I think which was",
    "start": "332560",
    "end": "338380"
  },
  {
    "text": "called like this identity is not permissions and I got lots of feedback from people agreeing and disagreeing",
    "start": "338380",
    "end": "343630"
  },
  {
    "text": "with me okay but to give you really simple example that's how I remember it right on my on my national ID card there",
    "start": "343630",
    "end": "351100"
  },
  {
    "text": "is my date of birth right there is no field saying he's allowed to drink",
    "start": "351100",
    "end": "357610"
  },
  {
    "text": "alcohol because this rule is very application specific right depending on",
    "start": "357610",
    "end": "363310"
  },
  {
    "text": "which country I go to to which bar I go to the end point the barkeeper yeah",
    "start": "363310",
    "end": "368320"
  },
  {
    "text": "we'll have a different interpretation of the date of birth claim yeah so putting",
    "start": "368320",
    "end": "373600"
  },
  {
    "text": "that on my ID wouldn't make sense and that's the same exact problem with this right",
    "start": "373600",
    "end": "378940"
  },
  {
    "text": "if you mixing up permissions and identity it will get you in trouble especially if your system is crowing",
    "start": "378940",
    "end": "386340"
  },
  {
    "text": "beyond what you initially planned for okay so this is something I often see",
    "start": "386340",
    "end": "393730"
  },
  {
    "text": "that that's an example of how an identity token would not look like okay so we are on",
    "start": "393730",
    "end": "403150"
  },
  {
    "text": "the top we have the usual stuff right it's an authentication metadata like who's the issuer when it when did the",
    "start": "403150",
    "end": "409510"
  },
  {
    "text": "use authentic a how did he authenticate and the audience meaning at which",
    "start": "409510",
    "end": "415300"
  },
  {
    "text": "endpoints can this token be used okay keep that in mind because that's the problem and then we have clearly identity",
    "start": "415300",
    "end": "423130"
  },
  {
    "text": "information here like the subject that he added a unique ID of their user maybe some you know name email address",
    "start": "423130",
    "end": "430330"
  },
  {
    "text": "whatever you want to you know couple with the identity then we have stuff",
    "start": "430330",
    "end": "435490"
  },
  {
    "text": "that is clearly authorization data right like delete data manage customer that",
    "start": "435490",
    "end": "441430"
  },
  {
    "text": "that's all you know around a little Hospital scenario we have from one of our customers can change the treatment",
    "start": "441430",
    "end": "448630"
  },
  {
    "text": "plan okay and that is clearly violating",
    "start": "448630",
    "end": "453790"
  },
  {
    "text": "what I think is identity information should be separate for example right and then there's some some crear eeeh in the",
    "start": "453790",
    "end": "460990"
  },
  {
    "text": "middle which are roles okay so many people use roles in my mind there are two types of roles identity roles which",
    "start": "460990",
    "end": "468580"
  },
  {
    "text": "come from the identity system yeah so again my customer from the hospital they have exactly free roles doctor nurse and",
    "start": "468580",
    "end": "476830"
  },
  {
    "text": "patient and there is no situation very user is in more than one role okay and",
    "start": "476830",
    "end": "484120"
  },
  {
    "text": "there is no situation where a doctor will be a nurse depending on where he's logging in right they wouldn't like that",
    "start": "484120",
    "end": "491850"
  },
  {
    "text": "so roles can be okay if they are identity roles but if you're using the",
    "start": "491850",
    "end": "498160"
  },
  {
    "text": "roles purely for authorization then again you're crossing that line of the",
    "start": "498160",
    "end": "503650"
  },
  {
    "text": "separation between identity and permissions now if you're coming from a ws star background W is security and so",
    "start": "503650",
    "end": "511630"
  },
  {
    "text": "on the architecture was typically that you get one token for each physical service you're talking to okay",
    "start": "511630",
    "end": "519070"
  },
  {
    "text": "in the overworld that's different you can see the audience claim up to on top",
    "start": "519070",
    "end": "524320"
  },
  {
    "text": "here you typically want to avoid having to make one round trip for each service you're talking to you you are saying hey",
    "start": "524320",
    "end": "530500"
  },
  {
    "text": "give me a token for API one - okay so what now if the user is",
    "start": "530500",
    "end": "536920"
  },
  {
    "text": "allowed to change the treatment plan in API one but not an API to see a problem",
    "start": "536920",
    "end": "544120"
  },
  {
    "text": "here how do you want to distinguish between the two use cases okay so I",
    "start": "544120",
    "end": "552010"
  },
  {
    "text": "think that'll lead you to two trouble okay what about how many permissions API one",
    "start": "552010",
    "end": "559270"
  },
  {
    "text": "has an API - that's the other thing right you want you might want to reuse the permissions between the different",
    "start": "559270",
    "end": "564940"
  },
  {
    "text": "applications but different users have the same user might have different permissions also do you want to extend",
    "start": "564940",
    "end": "570670"
  },
  {
    "text": "this token endlessly for your 500 permissions and then send it on every single request to the to the API the",
    "start": "570670",
    "end": "579399"
  },
  {
    "text": "next thing I guess I have an issue with this I'll just go one back is how do you",
    "start": "579399",
    "end": "587589"
  },
  {
    "text": "update the permissions now right so let's say you know your admin changes",
    "start": "587589",
    "end": "592630"
  },
  {
    "text": "the permission to your you're not allowed to change the treatment plan anymore when will this change of permission be",
    "start": "592630",
    "end": "598120"
  },
  {
    "text": "effective well the next time you log on to the system right because these tokens get created at log on time now Windows",
    "start": "598120",
    "end": "605589"
  },
  {
    "text": "has the same issue where you know you log on in the morning and admin puts you into into some group yeah and to make",
    "start": "605589",
    "end": "612190"
  },
  {
    "text": "this group membership effect if you have to log off from Windows and log back in again because these tokens get created",
    "start": "612190",
    "end": "618190"
  },
  {
    "text": "at log on time okay again I don't think a security token is a good place to put",
    "start": "618190",
    "end": "625930"
  },
  {
    "text": "permissions yeah it's it's it's clunky okay yeah and then you know with this",
    "start": "625930",
    "end": "632200"
  },
  {
    "text": "token you go to different API s now and as I said already there's a chance that the same user might have different",
    "start": "632200",
    "end": "638260"
  },
  {
    "text": "permissions and different api's so I don't think this is going to work I actually we had to fix a couple of",
    "start": "638260",
    "end": "645670"
  },
  {
    "text": "systems like brand new systems right brand new identity server all new modern applications but they made this mistake",
    "start": "645670",
    "end": "652270"
  },
  {
    "text": "in half a year later they realized and well you know it's very easy to add a claim to a token it's really hard to get",
    "start": "652270",
    "end": "658959"
  },
  {
    "text": "rid of it again because now you know a claim is a contract between the issuer and the consumer and if you change this",
    "start": "658959",
    "end": "665529"
  },
  {
    "text": "amend six or the existence of that you're gonna break stuff okay so you know just don't do it okay",
    "start": "665529",
    "end": "673310"
  },
  {
    "text": "that's that's what I said I think cool so what we think you know thinking",
    "start": "673310",
    "end": "678920"
  },
  {
    "text": "deeply heard about the problem is that identity a.k authentication and",
    "start": "678920",
    "end": "684710"
  },
  {
    "text": "permissions aka authorization should be separated okay separation of concerns we think the",
    "start": "684710",
    "end": "691420"
  },
  {
    "text": "identity should be the input to your authorization system and what comes out",
    "start": "691420",
    "end": "698120"
  },
  {
    "text": "of that will be the authorization data okay so basically what we prototyped so",
    "start": "698120",
    "end": "708650"
  },
  {
    "text": "to speak is a separate logical role right there's the identity provider",
    "start": "708650",
    "end": "716270"
  },
  {
    "text": "which will provide the identity of the user and again this is universal right regardless where you go to you are the",
    "start": "716270",
    "end": "722660"
  },
  {
    "text": "same user but depending on where you go to you will have different permissions right and that is an authorization",
    "start": "722660",
    "end": "729860"
  },
  {
    "text": "policy if you like and there in our mind we think it's right to have a separate",
    "start": "729860",
    "end": "735770"
  },
  {
    "text": "service on your network that takes the identity as an input and remover and",
    "start": "735770",
    "end": "742040"
  },
  {
    "text": "returns the application specific permissions for a user okay so that's what what you put a typed",
    "start": "742040",
    "end": "750470"
  },
  {
    "text": "basically the idea is you know the user first goes to the identity provider",
    "start": "750470",
    "end": "756070"
  },
  {
    "text": "doesn't authentication request gets back to tokens and then the application for",
    "start": "756070",
    "end": "762230"
  },
  {
    "text": "example can go to the policy provider send that identity and can back get back",
    "start": "762230",
    "end": "767810"
  },
  {
    "text": "the permissions for the UI right a uie has different different authorization",
    "start": "767810",
    "end": "774430"
  },
  {
    "text": "requirements or needs than an API in the UI it's all about you know enable this and disable that and so on so yeah this",
    "start": "774430",
    "end": "782660"
  },
  {
    "text": "will have different permissions than a back-end service so when you now call the API is with this token what the",
    "start": "782660",
    "end": "789320"
  },
  {
    "text": "backend services will do in turn is they get to the book go to the policy provider and get their API specific",
    "start": "789320",
    "end": "795590"
  },
  {
    "text": "permissions okay and the nice thing on top of that is",
    "start": "795590",
    "end": "800730"
  },
  {
    "text": "that you want to have a nice management story around that right so maybe you",
    "start": "800730",
    "end": "805980"
  },
  {
    "text": "have a management API right where you can dynamically create roles permissions",
    "start": "805980",
    "end": "811560"
  },
  {
    "text": "put users into roles assign permissions to roles or a management UI where maybe",
    "start": "811560",
    "end": "818100"
  },
  {
    "text": "a non-technical person or you know like at least not the developer maybe can go and assign users to permissions and so",
    "start": "818100",
    "end": "824820"
  },
  {
    "text": "on and that should be completely separated from your actual you know business logic so a program I sat down",
    "start": "824820",
    "end": "833310"
  },
  {
    "text": "after we before that this is the right way to go from our point of view at least yeah and and wrote the code okay",
    "start": "833310",
    "end": "841620"
  },
  {
    "text": "so what in essence fell out of that are a couple of of of pieces here first of",
    "start": "841620",
    "end": "849930"
  },
  {
    "text": "all a client library something that you can plug into your applications to make",
    "start": "849930",
    "end": "855000"
  },
  {
    "text": "it as easy as possible to talk to this abstraction okay and then the client",
    "start": "855000",
    "end": "860970"
  },
  {
    "text": "library talks to a client API and the input to that client API is the identity",
    "start": "860970",
    "end": "867660"
  },
  {
    "text": "of the user okay and now in inside of this client API there's an engine that can now map the",
    "start": "867660",
    "end": "876180"
  },
  {
    "text": "incoming claims to roles and map the roles to permissions okay and there were",
    "start": "876180",
    "end": "882450"
  },
  {
    "text": "a couple of things here you can do a static mapping for example from the subject ID to a role or maybe you have a",
    "start": "882450",
    "end": "888450"
  },
  {
    "text": "rule saying you know if he is a contractor he is I don't know",
    "start": "888450",
    "end": "893760"
  },
  {
    "text": "goes to the to the role external for example so you know an external has different permissions you know things",
    "start": "893760",
    "end": "899010"
  },
  {
    "text": "like that so that's one thing and on the other hand as a management API that",
    "start": "899010",
    "end": "905160"
  },
  {
    "text": "allows you to do everything pramatta CLE you know the whole management maybe you want to create resources on the fly",
    "start": "905160",
    "end": "911610"
  },
  {
    "text": "there are things like that so that's that and obviously in front of that",
    "start": "911610",
    "end": "916770"
  },
  {
    "text": "Jesty admin UI okay so while writing",
    "start": "916770",
    "end": "923520"
  },
  {
    "text": "that code yeah we we went pretty quickly I think from the idea to something we can show",
    "start": "923520",
    "end": "929430"
  },
  {
    "text": "okay so if anyone has seen our nd see Oslo talk from last year we",
    "start": "929430",
    "end": "935190"
  },
  {
    "text": "showed a very first prototype we didn't ever UI it was all basically you know chasing files by the time we didn't have",
    "start": "935190",
    "end": "943079"
  },
  {
    "text": "you know doctor full thing and we liked it and we showed it to people and they",
    "start": "943079",
    "end": "949139"
  },
  {
    "text": "liked it too so we realized to actually implement it like really really",
    "start": "949139",
    "end": "955350"
  },
  {
    "text": "production-ready male like with all the bells and whistles and install us and documentation and client libraries for",
    "start": "955350",
    "end": "962130"
  },
  {
    "text": "multiple platforms and caching and all the things you would expect that's a lot",
    "start": "962130",
    "end": "967290"
  },
  {
    "text": "of work so I had to ask where a profit question do you think we can afford",
    "start": "967290",
    "end": "974190"
  },
  {
    "text": "another open source project it's tricky the answer is yes and no so what we did",
    "start": "974190",
    "end": "985319"
  },
  {
    "text": "is basically we took everything that you need to implement the pattern right the",
    "start": "985319",
    "end": "991860"
  },
  {
    "text": "separation of concerns the the separation of identity from permissions you know like sending identity somewhere",
    "start": "991860",
    "end": "998699"
  },
  {
    "text": "getting permission Specht client library and so on so forth that is going live",
    "start": "998699",
    "end": "1005779"
  },
  {
    "text": "well it went live ten minutes ago or 15 or 20 maybe yeah so that's on get up now",
    "start": "1005779",
    "end": "1011930"
  },
  {
    "text": "get up complex policy server and that gives you everything you need to implement the pattern okay so if you",
    "start": "1011930",
    "end": "1018740"
  },
  {
    "text": "think this pattern is useful for your applications having that separation which makes it easier for you to grow in",
    "start": "1018740",
    "end": "1025250"
  },
  {
    "text": "the future just take that and there it is if you want the advanced features like",
    "start": "1025250",
    "end": "1030530"
  },
  {
    "text": "banishment server management UI client libraries for the platforms you know support for Redis and blah blah blah",
    "start": "1030530",
    "end": "1037788"
  },
  {
    "text": "blah blah you know whatever the real product needs yes as a commercial product now launched 20 minutes ago okay",
    "start": "1037789",
    "end": "1046970"
  },
  {
    "text": "so for for this for this talk we will only use the open source version so you",
    "start": "1046970",
    "end": "1054169"
  },
  {
    "text": "see basically what what you get and you can have a look and you know pull requests and and all you know all the",
    "start": "1054169",
    "end": "1060260"
  },
  {
    "text": "things issue tracker and so on is all there and then at the end I think we'll have five or ten minutes just to show",
    "start": "1060260",
    "end": "1065390"
  },
  {
    "text": "you the more advanced features that that you get with them you know lift product good so",
    "start": "1065390",
    "end": "1073710"
  },
  {
    "text": "what we're gonna do is look at and by the way we're calling this policy server local so the the open-source version so",
    "start": "1073710",
    "end": "1080400"
  },
  {
    "text": "what we're gonna do is look at that so the the thinking is ok how can we now use this abstraction this decoupling of",
    "start": "1080400",
    "end": "1087990"
  },
  {
    "text": "mapping into your application so as Dominic mentioned the first approach for doing that is basically giving you a",
    "start": "1087990",
    "end": "1094050"
  },
  {
    "text": "library in your application that you can call to this mapping layer to establish",
    "start": "1094050",
    "end": "1100740"
  },
  {
    "text": "what the application roles and application permissions are so you'll often get the user somehow take that",
    "start": "1100740",
    "end": "1106230"
  },
  {
    "text": "user call into this engine that will map this and give you the results and it really results in a list of roles in a",
    "start": "1106230",
    "end": "1113190"
  },
  {
    "text": "list of permissions and again these are application specific roles and application specific permissions so part",
    "start": "1113190",
    "end": "1118560"
  },
  {
    "text": "of the design of this actually there will be some upfront time in your application thinking about what are the",
    "start": "1118560",
    "end": "1124350"
  },
  {
    "text": "roles of the users in my app and what are the types of permissions that I do want to assign to them ok so that's the",
    "start": "1124350",
    "end": "1129990"
  },
  {
    "text": "first thing is a client library and that's just straight up using this this this new library that we've developed",
    "start": "1129990",
    "end": "1135560"
  },
  {
    "text": "then the next thing is then some other techniques for incorporating that information throughout your application",
    "start": "1135560",
    "end": "1141060"
  },
  {
    "text": "and we'll see an asp.net core that there are a few different ways to do that we",
    "start": "1141060",
    "end": "1146430"
  },
  {
    "text": "can do your traditional authorized attribute or utilize the new policy system from asp.net core ok so this word",
    "start": "1146430",
    "end": "1153780"
  },
  {
    "text": "policy does get a little overloaded right we have this policy server that's about the mapping and then asp.net core",
    "start": "1153780",
    "end": "1160260"
  },
  {
    "text": "has policies as well and you can use those together ok so the first thing is",
    "start": "1160260",
    "end": "1166740"
  },
  {
    "text": "what we have is a project this is actually the code that's right up on github and we have the library here for",
    "start": "1166740",
    "end": "1173700"
  },
  {
    "text": "policy server local this is added in then to a sample application and",
    "start": "1173700",
    "end": "1179820"
  },
  {
    "text": "actually the first thing I suppose to show is just logging into the sample application we have a very simple",
    "start": "1179820",
    "end": "1185390"
  },
  {
    "text": "account controller where you can log in and we're decoupled from what the",
    "start": "1185390",
    "end": "1190590"
  },
  {
    "text": "identity system is so this approach and this technique that we're showing you you can use with any identity provider",
    "start": "1190590",
    "end": "1196350"
  },
  {
    "text": "it does not have to be identity server it could be you know Active Directory or Azure ad or something else so right now we're just",
    "start": "1196350",
    "end": "1202989"
  },
  {
    "text": "hard coding some users and in our example I think Alice is ultimately going to end up with dr. sort of",
    "start": "1202989",
    "end": "1209379"
  },
  {
    "text": "permissions and Bob is going to end up with nurse permissions and this last user whoever else unfortunately falls",
    "start": "1209379",
    "end": "1216759"
  },
  {
    "text": "under the patient role so we're gonna have this this application where the user logs in obviously to enable",
    "start": "1216759",
    "end": "1223539"
  },
  {
    "text": "authentication what we have are the cookie handler in asp.net core 2 so then",
    "start": "1223539",
    "end": "1230139"
  },
  {
    "text": "to pull in this policy mapping that we're talking about we have to define these policies somewhere and so actually",
    "start": "1230139",
    "end": "1237940"
  },
  {
    "text": "I think in Oslo what we showed is the hard coded version we didn't even have Jason's support at that time but now we",
    "start": "1237940",
    "end": "1243489"
  },
  {
    "text": "have this ability to express these what we call policies in in JSON file and for",
    "start": "1243489",
    "end": "1250090"
  },
  {
    "text": "this version we only have you know one policy and the idea is that the policy allows us to define roles all right",
    "start": "1250090",
    "end": "1256779"
  },
  {
    "text": "these are the application specific roles and we're gonna have a doctor and a nurse and patient and we have ways to",
    "start": "1256779",
    "end": "1264340"
  },
  {
    "text": "map the user from the identity system to these application specific roles so you",
    "start": "1264340",
    "end": "1269710"
  },
  {
    "text": "could simply list the users identifier their subject identifier right that's the users unique ID and user ID one and",
    "start": "1269710",
    "end": "1277149"
  },
  {
    "text": "two well those are both doctors in this application we also can map from the",
    "start": "1277149",
    "end": "1282249"
  },
  {
    "text": "identity system the role of the user so there's the centralized identity system maybe you're you know a doctor in the",
    "start": "1282249",
    "end": "1289509"
  },
  {
    "text": "the centralized Active Directory they put you in the doctor group when you get",
    "start": "1289509",
    "end": "1294580"
  },
  {
    "text": "into the application though the application may have slightly different names for what these application roles",
    "start": "1294580",
    "end": "1299889"
  },
  {
    "text": "are so there's the identity role that gets mapped to an application role so that's a different way to do mapping so",
    "start": "1299889",
    "end": "1306279"
  },
  {
    "text": "in this case it looks like our identity system centralized make all the user a surgeon but this application just has",
    "start": "1306279",
    "end": "1312489"
  },
  {
    "text": "the notion of a doctor okay so we also have nurses so these users and I guess",
    "start": "1312489",
    "end": "1318730"
  },
  {
    "text": "RN is not well known over here that's a registered nurse that's the abbreviation in the u.s. frequently for a erse and",
    "start": "1318730",
    "end": "1327220"
  },
  {
    "text": "then we have patients as well so that's one way to do some mapping we're going to take the identity",
    "start": "1327220",
    "end": "1332540"
  },
  {
    "text": "map it to these application-specific rolls we also have the notion of permissions and so then the application",
    "start": "1332540",
    "end": "1338570"
  },
  {
    "text": "decides what are the the functions that we need to protect all right certain",
    "start": "1338570",
    "end": "1344240"
  },
  {
    "text": "users can do certain functions and that's where the permissions come from so based on your application role you",
    "start": "1344240",
    "end": "1350300"
  },
  {
    "text": "can utilize application specific features expressed with by these permissions so some users can see",
    "start": "1350300",
    "end": "1357320"
  },
  {
    "text": "patients some people's users can perform surgery and so on and so forth okay so",
    "start": "1357320",
    "end": "1363320"
  },
  {
    "text": "this configuration system then gets loaded in to our application at runtime",
    "start": "1363320",
    "end": "1368380"
  },
  {
    "text": "so we're gonna start up our application we will load our Jason configuration and",
    "start": "1368380",
    "end": "1374570"
  },
  {
    "text": "load it in memory and use our extension method to put the services that we need into di and the main service that we're",
    "start": "1374570",
    "end": "1382610"
  },
  {
    "text": "putting into di then is a client library that your application can use to query",
    "start": "1382610",
    "end": "1388610"
  },
  {
    "text": "for the current user which application roles and permissions they're allowed",
    "start": "1388610",
    "end": "1395000"
  },
  {
    "text": "access to so to access that C server",
    "start": "1395000",
    "end": "1401780"
  },
  {
    "text": "client the API then that we surface to",
    "start": "1401780",
    "end": "1407120"
  },
  {
    "text": "communicate to the mapping engine is this thing called the policy server client and it has a couple of api's",
    "start": "1407120",
    "end": "1414700"
  },
  {
    "text": "right you can see for the current user are they in a role do they have a",
    "start": "1414700",
    "end": "1420320"
  },
  {
    "text": "permission and here's actually the main engine pieces where you feed the user in this is the currently logged in user and",
    "start": "1420320",
    "end": "1426620"
  },
  {
    "text": "you get back their results which again conceptually very simple it's just the list of roles and permissions that",
    "start": "1426620",
    "end": "1433070"
  },
  {
    "text": "they've been mapped to it actually can also be another user if you want to it doesn't need to be the currently logged in user you can evaluate for another",
    "start": "1433070",
    "end": "1440120"
  },
  {
    "text": "given user in the system which is also useful so what we have is then the",
    "start": "1440120",
    "end": "1446540"
  },
  {
    "text": "client we can evaluate for the current",
    "start": "1446540",
    "end": "1453140"
  },
  {
    "text": "user and we get back this result",
    "start": "1453140",
    "end": "1457240"
  },
  {
    "text": "the result has the roles and the permissions like this so what we'll do is we'll just pass this to our view and",
    "start": "1459630",
    "end": "1465690"
  },
  {
    "text": "we have some code in the view that will show that okay so I'll go to my secure",
    "start": "1465690",
    "end": "1476370"
  },
  {
    "text": "page I'll log in as Alice okay again remember Alice from the identity system is just user ID 1 and name Alice",
    "start": "1476370",
    "end": "1484950"
  },
  {
    "text": "okay but that goes as input to the policy system and the policy system is simply map the user to these application",
    "start": "1484950",
    "end": "1491580"
  },
  {
    "text": "roles and permissions okay so now you have that data for that user right",
    "start": "1491580",
    "end": "1497309"
  },
  {
    "text": "specific for your application what do you do now to do your authorization well you have some information right here so",
    "start": "1497309",
    "end": "1503760"
  },
  {
    "text": "you could do whatever check you wanted to programmatically right you've called the system you have some of that those",
    "start": "1503760",
    "end": "1509220"
  },
  {
    "text": "results okay so that's calling the client library and getting that",
    "start": "1509220",
    "end": "1515220"
  },
  {
    "text": "information back ok now again you could always write your own authorization code at that point check for this operations",
    "start": "1515220",
    "end": "1521309"
  },
  {
    "text": "being performed does the user have the particular role or permission but we're in asp net core right and in ASP not",
    "start": "1521309",
    "end": "1527730"
  },
  {
    "text": "core you know we have the good old authorized attribute so what we can start to do is figure out how to take",
    "start": "1527730",
    "end": "1534900"
  },
  {
    "text": "the policy system that does the user mapping and start to then use the",
    "start": "1534900",
    "end": "1539970"
  },
  {
    "text": "built-in authorization features provided by asp.net ok so how many guys use the",
    "start": "1539970",
    "end": "1545250"
  },
  {
    "text": "authorized attribute with the roles yeah people love that right so what we're",
    "start": "1545250",
    "end": "1550440"
  },
  {
    "text": "gonna do is go have a method where only nurses are allowed to you know use",
    "start": "1550440",
    "end": "1557780"
  },
  {
    "text": "perform this action ok and so we can use the good the good old authorized attribute to do this now right now the",
    "start": "1557780",
    "end": "1565320"
  },
  {
    "text": "current user that's logged into my system does not have that information ok in the users claims list right right now",
    "start": "1565320",
    "end": "1572100"
  },
  {
    "text": "the logged in user just has a name and we're just printing out the fact that they're mapped to this role so to",
    "start": "1572100",
    "end": "1578220"
  },
  {
    "text": "actually leverage this style of authorization that user has to have the",
    "start": "1578220",
    "end": "1583320"
  },
  {
    "text": "role claimed in their their current list ok so there is a technique for taking",
    "start": "1583320",
    "end": "1588929"
  },
  {
    "text": "the the claims that are in the cookie right for the current authenticated user and when the request comes in to the web",
    "start": "1588929",
    "end": "1595230"
  },
  {
    "text": "server add additional claims or augment the list of claims so that the",
    "start": "1595230",
    "end": "1600600"
  },
  {
    "text": "application can look there for them rather than calling this this custom library okay and so that's called claims",
    "start": "1600600",
    "end": "1606720"
  },
  {
    "text": "transformation and we have a mechanism where the claims transformation can use",
    "start": "1606720",
    "end": "1612450"
  },
  {
    "text": "as the source of the additional claims all right our client library to map",
    "start": "1612450",
    "end": "1620340"
  },
  {
    "text": "those so what we can do is put into the",
    "start": "1620340",
    "end": "1626460"
  },
  {
    "text": "middleware pipeline right after authentication has been performed right the request comes in the cookies read",
    "start": "1626460",
    "end": "1632790"
  },
  {
    "text": "turned into the claims principal with just the subject claim write our policy server claims transformation will then",
    "start": "1632790",
    "end": "1639240"
  },
  {
    "text": "add those claims to the user so you can take advantage of the built in role checking that's provided also if you",
    "start": "1639240",
    "end": "1646470"
  },
  {
    "text": "already have existing investments into the built-in API so you know like a claims principal don't find first find",
    "start": "1646470",
    "end": "1652800"
  },
  {
    "text": "all has claimed you know all the the built in claims API is from from dotnet and you want to keep them that's how you",
    "start": "1652800",
    "end": "1659460"
  },
  {
    "text": "would do that yeah so actually what this is now showing is that the user coming in from the HTTP context now has some",
    "start": "1659460",
    "end": "1668220"
  },
  {
    "text": "claims coming from the cookie and now these claims that have been mapped from the policy system okay so now the",
    "start": "1668220",
    "end": "1674970"
  },
  {
    "text": "current user does have the role doctor on the user object and now if I go to",
    "start": "1674970",
    "end": "1680850"
  },
  {
    "text": "the nurse's action we oh we're actually nowhere a doctor exactly right so that worked so yeah",
    "start": "1680850",
    "end": "1689309"
  },
  {
    "text": "nurses only right shouldn't be allowed so if I log out can I am can I into so",
    "start": "1689309",
    "end": "1696750"
  },
  {
    "text": "Trina can you do surgery you should be able to us nurses only right we can get",
    "start": "1696750",
    "end": "1702840"
  },
  {
    "text": "in there okay all right good evening",
    "start": "1702840",
    "end": "1709250"
  },
  {
    "text": "again well the usual a small rent at",
    "start": "1709250",
    "end": "1716880"
  },
  {
    "text": "least about the authorized attribute iam not not about the authorized attribute in particular but about using it with",
    "start": "1716880",
    "end": "1722820"
  },
  {
    "text": "this in this style right I have seen a lot of customer projects",
    "start": "1722820",
    "end": "1730080"
  },
  {
    "text": "where this was extensively used there and then you have like 10 controllers and 20 controllers and 50 controllers and suddenly you have authorized",
    "start": "1730080",
    "end": "1736950"
  },
  {
    "text": "attributes everywhere right role equal tees role equal their role equal something else now I think this leads to",
    "start": "1736950",
    "end": "1744869"
  },
  {
    "text": "very hard to maintain code right especially if you're your boss walks in says hey by the way can you give this",
    "start": "1744869",
    "end": "1753509"
  },
  {
    "text": "random guy from the marketing department access to whatever you have to you know to them calculate a mess in your head",
    "start": "1753509",
    "end": "1759869"
  },
  {
    "text": "like what's the intersection of dead and dead and you have to go to every single authorize that you could update it",
    "start": "1759869",
    "end": "1764909"
  },
  {
    "text": "correctly don't make a mistake right and so on so forth so I personally don't",
    "start": "1764909",
    "end": "1771720"
  },
  {
    "text": "like the approach I totally acknowledge that many people like the approach that that's why we added support for it right",
    "start": "1771720",
    "end": "1777059"
  },
  {
    "text": "but I think it's hard to maintain I actually have one customer who wrote a command-line tool to scan all",
    "start": "1777059",
    "end": "1783149"
  },
  {
    "text": "controllers if they have the right combination of matching strings over that and I don't think you want to be in",
    "start": "1783149",
    "end": "1788999"
  },
  {
    "text": "that situation to be honest ma'am so the main complaints are it's just hard to",
    "start": "1788999",
    "end": "1795629"
  },
  {
    "text": "maintain you have this code maybe sprinkled in multiple locations for the same logic right because you might need",
    "start": "1795629",
    "end": "1801869"
  },
  {
    "text": "to have some code in the UI that hides or shows the button and then the actual action method has to have the exact same",
    "start": "1801869",
    "end": "1807599"
  },
  {
    "text": "logic to actually enforce the logic so duplicated it's also the big complaint",
    "start": "1807599",
    "end": "1813690"
  },
  {
    "text": "is it's hard to unit test yes right if you actually need to unit test this you have to run a real server and make real",
    "start": "1813690",
    "end": "1819840"
  },
  {
    "text": "HTTP requests I mean how would you automate a test that makes sure you have to write rolls over each controller yeah",
    "start": "1819840",
    "end": "1827849"
  },
  {
    "text": "it's it's it's not trivial that's why actually you know we've been talking to",
    "start": "1827849",
    "end": "1832979"
  },
  {
    "text": "the 8-minute core team for many many years or the asp.net team I should say before they were even core and show them",
    "start": "1832979",
    "end": "1839190"
  },
  {
    "text": "an alternative way of doing authorization and you know they didn't",
    "start": "1839190",
    "end": "1844950"
  },
  {
    "text": "really feel like adding that to the old days Peter net but now with the new a speed core where they have the chance of",
    "start": "1844950",
    "end": "1850320"
  },
  {
    "text": "doing breaking changes and stuff they added this new authorization API and",
    "start": "1850320",
    "end": "1856979"
  },
  {
    "text": "it's called policy based authorization and you know kind that's what inspired us right because",
    "start": "1856979",
    "end": "1862070"
  },
  {
    "text": "think of the HP policy API a nice client-side API against our policy",
    "start": "1862070",
    "end": "1868009"
  },
  {
    "text": "server back-end so to speak and the nice thing about basically that the policy",
    "start": "1868009",
    "end": "1873049"
  },
  {
    "text": "API in a build core solves my biggest complaints it's better it's easier to",
    "start": "1873049",
    "end": "1879919"
  },
  {
    "text": "maintain because you can centralize your policies it is you can have a separation",
    "start": "1879919",
    "end": "1886279"
  },
  {
    "text": "of concerns between business logic and authorization logic and it's testable and that was my biggest you know wish",
    "start": "1886279",
    "end": "1893539"
  },
  {
    "text": "that I can somehow ride automated code that it runs on a check-in that makes",
    "start": "1893539",
    "end": "1898609"
  },
  {
    "text": "sure I haven't messed up my authorization policies okay so there are",
    "start": "1898609",
    "end": "1903950"
  },
  {
    "text": "a couple of different ways to use the policy system the first way we're going to show you is kind of a the simpler way",
    "start": "1903950",
    "end": "1909769"
  },
  {
    "text": "and it works okay for demos I suppose so the idea is that you have this idea of a",
    "start": "1909769",
    "end": "1916700"
  },
  {
    "text": "policy and there are certain requirements from your user that the",
    "start": "1916700",
    "end": "1921739"
  },
  {
    "text": "user must satisfy to be allowed to do whatever your operation is so in the the",
    "start": "1921739",
    "end": "1927349"
  },
  {
    "text": "DI system you will add the authorization services and then you can define these policies so a policy has a name in this",
    "start": "1927349",
    "end": "1934820"
  },
  {
    "text": "case prescribe medication and then on the policy you go and express what you",
    "start": "1934820",
    "end": "1940429"
  },
  {
    "text": "expect the user to have and if the user has this then they will be satisfying the policy so I require that the user is",
    "start": "1940429",
    "end": "1947659"
  },
  {
    "text": "authenticated and that they have a permission called prescribed medication for example ok the nice thing about it",
    "start": "1947659",
    "end": "1954440"
  },
  {
    "text": "is that you define the policy only in one place and if you change the policy all the controllers will just get",
    "start": "1954440",
    "end": "1960919"
  },
  {
    "text": "automatically get this new policy right you can even think of putting the policies into a separate assembly and",
    "start": "1960919",
    "end": "1966829"
  },
  {
    "text": "then being able to version the policy independently of the application for example so there are some benefits in so",
    "start": "1966829",
    "end": "1973849"
  },
  {
    "text": "in this particular example it actually works well with our user mapping our policy server mapping in the JSON file",
    "start": "1973849",
    "end": "1980389"
  },
  {
    "text": "because what I'm requiring from the user in this cases of permission so what we're going to leverage is our claims",
    "start": "1980389",
    "end": "1987309"
  },
  {
    "text": "transformation from our mapping from policy server to produce the permission",
    "start": "1987309",
    "end": "1992860"
  },
  {
    "text": "and then we can leverage down on the right the actual authorized attribute and the version of the authorized",
    "start": "1992860",
    "end": "1998530"
  },
  {
    "text": "attribute that you accept a string to the constructor that's not a role that's now the name of the policy that you",
    "start": "1998530",
    "end": "2005870"
  },
  {
    "text": "expect the user to satisfy to be able to access this action method you know the",
    "start": "2005870",
    "end": "2011880"
  },
  {
    "text": "other thing is that there's a layer of indirection here so maybe being able to",
    "start": "2011880",
    "end": "2016890"
  },
  {
    "text": "prescribe medication means you have to have the permission and something else right and you can bundle it up basically",
    "start": "2016890",
    "end": "2022770"
  },
  {
    "text": "into a reusable thing called policy and as you'll see in a minute this all is",
    "start": "2022770",
    "end": "2027809"
  },
  {
    "text": "also extensible so you can plug in your own custom requirements that can go to custom data stores and so on so let's",
    "start": "2027809",
    "end": "2034440"
  },
  {
    "text": "actually go back to our secure page and I don't think patients were allowed to",
    "start": "2034440",
    "end": "2041750"
  },
  {
    "text": "to prescribe medication but doctors and nurses I think were actually we could take a look here would be we added",
    "start": "2041750",
    "end": "2049980"
  },
  {
    "text": "patients could do that yeah so there we go well they can request pain but yeah okay so yeah our doctor and our nurse",
    "start": "2049980",
    "end": "2056220"
  },
  {
    "text": "should be able to now access the secure method whereas anyone else should not so",
    "start": "2056220",
    "end": "2062490"
  },
  {
    "text": "if I run this I don't think I'm logged in as anyone right now so we'll go to",
    "start": "2062490",
    "end": "2067830"
  },
  {
    "text": "secure I'll log in as Alice okay and again we get here that worked great because Alice does in fact have",
    "start": "2067830",
    "end": "2074429"
  },
  {
    "text": "performed surgery if we log out sorry yes prescribed medication sorry log out",
    "start": "2074429",
    "end": "2080398"
  },
  {
    "text": "and go now and login us Joe and yeah Joe's not gonna be allowed to do that okay so that's nice okay because we've",
    "start": "2080399",
    "end": "2089490"
  },
  {
    "text": "now decoupled the two right and we are now in a little bit better position to maintain that code what are the other oh",
    "start": "2089490",
    "end": "2098369"
  },
  {
    "text": "yeah this is actually really nice thing about this is that you can also use the",
    "start": "2098369",
    "end": "2103760"
  },
  {
    "text": "asp.net core authorization system programmatically instead of just",
    "start": "2103760",
    "end": "2109050"
  },
  {
    "text": "declaratively you can invoke it imperative lis so maybe somewhere in your code based on logic that's",
    "start": "2109050",
    "end": "2114420"
  },
  {
    "text": "dynamically occurring you need to execute one policy over over another and that's the key to testing right so now",
    "start": "2114420",
    "end": "2120150"
  },
  {
    "text": "you can just write unit tests your paw you create a claims principle that has to shape and form that you",
    "start": "2120150",
    "end": "2126700"
  },
  {
    "text": "that you want you pass it into a policy and you make sure that the expected result comes back right and then if",
    "start": "2126700",
    "end": "2132970"
  },
  {
    "text": "somebody changes to policies down the line that the test will succeed or break right and you will get immediate",
    "start": "2132970",
    "end": "2138460"
  },
  {
    "text": "feedback if something has been broken daddy you know change the behavior so instead of doing it declaratively like",
    "start": "2138460",
    "end": "2144160"
  },
  {
    "text": "that what we could do is authorize we",
    "start": "2144160",
    "end": "2152320"
  },
  {
    "text": "pass in the user and we indicate here our prescribe medication name the most",
    "start": "2152320",
    "end": "2162310"
  },
  {
    "text": "common question we get when we showed a new HP no authorization API is oh it's the reversion available for older",
    "start": "2162310",
    "end": "2168310"
  },
  {
    "text": "versions of asp.net because you know I like it but we don't do a spirit core",
    "start": "2168310",
    "end": "2173740"
  },
  {
    "text": "and indeed there is yeah the the links on the slide and you have to send the",
    "start": "2173740",
    "end": "2178960"
  },
  {
    "text": "slides on speaker deck there's a guy called David parks 8 on github that back",
    "start": "2178960",
    "end": "2184839"
  },
  {
    "text": "ported the whole thing to a speed of net 4.5 and the API good so now we have a",
    "start": "2184839",
    "end": "2194890"
  },
  {
    "text": "programmatic API to tap into the asp net policy system which you know in this",
    "start": "2194890",
    "end": "2199900"
  },
  {
    "text": "case is good to be able to achieve your unit testing the other nice thing then",
    "start": "2199900",
    "end": "2206589"
  },
  {
    "text": "is that you could also use this when you're building your UI right you have a view model that has a flag for whether",
    "start": "2206589",
    "end": "2214119"
  },
  {
    "text": "or not a button should be enabled something like that you populate your view model and now you can you change",
    "start": "2214119",
    "end": "2219819"
  },
  {
    "text": "the code centrally and both the where you enforce it and where you display it well both well both pick up the change",
    "start": "2219819",
    "end": "2226680"
  },
  {
    "text": "actually even this am way where you can now use dependency injection directly on",
    "start": "2226680",
    "end": "2232869"
  },
  {
    "text": "fuse so you could in theory get the authorization service directly on to your view and then execute policies and",
    "start": "2232869",
    "end": "2240460"
  },
  {
    "text": "depending on that render your UI I'm not sure if I should recommend that yeah the the DD approach that proc describe",
    "start": "2240460",
    "end": "2247540"
  },
  {
    "text": "is much better to have a view model right but let's say you want to do stuff on the layout page then this is maybe a",
    "start": "2247540",
    "end": "2253930"
  },
  {
    "text": "handy thing if you want to you know change the global the global navigation whatever based on who do",
    "start": "2253930",
    "end": "2260110"
  },
  {
    "text": "um okay all right so what we've shown",
    "start": "2260110",
    "end": "2265240"
  },
  {
    "text": "here is in our sample code is defining a policy okay and then having the benefits",
    "start": "2265240",
    "end": "2271480"
  },
  {
    "text": "of that centralization and in this particular example like I said we are matching it well with our user mapping",
    "start": "2271480",
    "end": "2277870"
  },
  {
    "text": "coming from our policy server except one problem with this is that notice you are",
    "start": "2277870",
    "end": "2283990"
  },
  {
    "text": "now basically doing a one-to-one mapping of the permission from our jason mapping",
    "start": "2283990",
    "end": "2290350"
  },
  {
    "text": "to a permissioned a name in the asp.net core policy system okay and if you have",
    "start": "2290350",
    "end": "2296620"
  },
  {
    "text": "ten policies this can start to become tedious or twenty or even more or ten",
    "start": "2296620",
    "end": "2301930"
  },
  {
    "text": "permissions rather so this becomes a bit tedious so it turns out that the policy",
    "start": "2301930",
    "end": "2308500"
  },
  {
    "text": "system is extensible the authorization",
    "start": "2308500",
    "end": "2313750"
  },
  {
    "text": "system back on the home controller when you're invoking authorize they think and",
    "start": "2313750",
    "end": "2319240"
  },
  {
    "text": "you pass in the name of a policy internally they have a lookup mechanism",
    "start": "2319240",
    "end": "2324310"
  },
  {
    "text": "to go find that policy and that lookup mechanism is itself extensible so you",
    "start": "2324310",
    "end": "2330190"
  },
  {
    "text": "can just register an interface in the authorization system that receives this string dynamically and then you can",
    "start": "2330190",
    "end": "2337060"
  },
  {
    "text": "dynamically create a policy so it turns out that we have that support as well",
    "start": "2337060",
    "end": "2342460"
  },
  {
    "text": "here we've added that into our local local system so I can get rid of the",
    "start": "2342460",
    "end": "2348790"
  },
  {
    "text": "manual one-to-one mapping of this which makes sense if all you want to do is just one-to-one mapping right if you",
    "start": "2348790",
    "end": "2354880"
  },
  {
    "text": "want to have higher level policies then you can still map them you know statically but for one timon that's just",
    "start": "2354880",
    "end": "2362380"
  },
  {
    "text": "done automatically now so we have this extension method which will register this authorization of policy provider",
    "start": "2362380",
    "end": "2369610"
  },
  {
    "text": "and so we are implementing the microfiche defined by Microsoft we can",
    "start": "2369610",
    "end": "2375400"
  },
  {
    "text": "come in here and look at this implementation it's it's pretty straightforward when the request comes in for a policy we go look to see if an",
    "start": "2375400",
    "end": "2382150"
  },
  {
    "text": "existing policy is is already registered maybe you've already done a hard-coded policy great we'll leave that one alone",
    "start": "2382150",
    "end": "2389250"
  },
  {
    "text": "but if the policy is not there we will look it up from our our",
    "start": "2389250",
    "end": "2396420"
  },
  {
    "text": "authorization system based on the the permissions for the user so we're",
    "start": "2396420",
    "end": "2401839"
  },
  {
    "text": "dynamically then creating a policy requiring the the permission that that",
    "start": "2401839",
    "end": "2410099"
  },
  {
    "text": "you indicate in the string okay and actually we use our client library directly so we're not even looking at",
    "start": "2410099",
    "end": "2415619"
  },
  {
    "text": "the current user object we actually call into the client library to go to go look that up so to use this actually we could",
    "start": "2415619",
    "end": "2423690"
  },
  {
    "text": "do a couple of things now that we have this and it's going directly to the client library we no longer need to map",
    "start": "2423690",
    "end": "2429089"
  },
  {
    "text": "these policies directly and then actually you know fact we don't even need to do the claims transformation",
    "start": "2429089",
    "end": "2434880"
  },
  {
    "text": "anymore okay wait it's about style I guess yeah some ppl you know that's the",
    "start": "2434880",
    "end": "2441180"
  },
  {
    "text": "other thing I learned when talking to our customers is that everybody prefers a different style so that's why we",
    "start": "2441180",
    "end": "2446490"
  },
  {
    "text": "basically give you the choice you have options so if I run this it should still basically work the way it was I'm",
    "start": "2446490",
    "end": "2453119"
  },
  {
    "text": "currently logged in I don't think I'm not logged in as anyone here secure oh I",
    "start": "2453119",
    "end": "2463589"
  },
  {
    "text": "need to have a basic authorized attribute it's actually an interesting",
    "start": "2463589",
    "end": "2471900"
  },
  {
    "text": "difference here so the very first time I came in I wanted to be denied but logged",
    "start": "2471900",
    "end": "2478770"
  },
  {
    "text": "in so the first time I want the redirect to the login page once I'm authenticated then if I don't",
    "start": "2478770",
    "end": "2485040"
  },
  {
    "text": "satisfy the policy I want to be taken to the forbidden page so that's what I was missing here okay secure Alice should be",
    "start": "2485040",
    "end": "2496589"
  },
  {
    "text": "allowed great we're in and of course our other user Joe should not be good so I",
    "start": "2496589",
    "end": "2506270"
  },
  {
    "text": "mentioned earlier that the policies team is also extensible so you just you don't",
    "start": "2506270",
    "end": "2511650"
  },
  {
    "text": "have to just go for claims right so you can also have your own custom",
    "start": "2511650",
    "end": "2518099"
  },
  {
    "text": "requirement so basically what a policy is it's really just a list of requirements and some of these requirements are built in like you know",
    "start": "2518099",
    "end": "2524369"
  },
  {
    "text": "require indicated user require a claim whatever but you can model whatever you want right so let's say for example we",
    "start": "2524369",
    "end": "2530520"
  },
  {
    "text": "have a custom requirement where we want to authorize on what kind of medication the nurse or the doctor wants to",
    "start": "2530520",
    "end": "2536310"
  },
  {
    "text": "prescribe and how much of it right could imagine that this is something that could be real yeah so you know the code",
    "start": "2536310",
    "end": "2546450"
  },
  {
    "text": "is not really necessary maybe just switch directly to the implementation or how to use it but the point is now that",
    "start": "2546450",
    "end": "2552540"
  },
  {
    "text": "you can create these higher-level requirements you could implement the so called requirement Handler and this",
    "start": "2552540",
    "end": "2559140"
  },
  {
    "text": "handler is invoked at runtime by the a spirit core system and then inside of",
    "start": "2559140",
    "end": "2565170"
  },
  {
    "text": "that handler there's a handle method or yeah that allows you to write arbitrary code yeah so on one hand you could call",
    "start": "2565170",
    "end": "2572610"
  },
  {
    "text": "the policy system curing permissions and roles but on the other hand maybe you need to look up some web service",
    "start": "2572610",
    "end": "2578310"
  },
  {
    "text": "whatever to you know and both things to get up will become your ultimate authorization decision yeah yeah so this",
    "start": "2578310",
    "end": "2585090"
  },
  {
    "text": "particular example if you want to be able to prescribe medication will first",
    "start": "2585090",
    "end": "2591840"
  },
  {
    "text": "see if you have the permission from the policy system and then based on the amount we'll do additional role checking",
    "start": "2591840",
    "end": "2598860"
  },
  {
    "text": "for example okay so it allows you to write arbitrary code and again you're mixing a little bit of our policy server",
    "start": "2598860",
    "end": "2605880"
  },
  {
    "text": "logic with a little bit of your own custom application logic this class does",
    "start": "2605880",
    "end": "2610950"
  },
  {
    "text": "need to go into the DI system so that's one last thing I need to do is go in and",
    "start": "2610950",
    "end": "2617450"
  },
  {
    "text": "the code then when you are trying to",
    "start": "2617450",
    "end": "2623970"
  },
  {
    "text": "actually enforce this we have now a prescribed medication action method we build up our requirement and based",
    "start": "2623970",
    "end": "2631560"
  },
  {
    "text": "passing the user and based on the type of the requirement that's what triggers",
    "start": "2631560",
    "end": "2637400"
  },
  {
    "text": "this method to be or this correct handler to be invoked because of the the",
    "start": "2637400",
    "end": "2642840"
  },
  {
    "text": "generic argument there and that generic argument is again back in the handler passed in to you that's where you you",
    "start": "2642840",
    "end": "2648690"
  },
  {
    "text": "get the additional data so I broke",
    "start": "2648690",
    "end": "2654450"
  },
  {
    "text": "something now oh did I comment that out what it a very",
    "start": "2654450",
    "end": "2667910"
  },
  {
    "text": "equal to break ah too much commenting out so I think I'm logged in as Joe and",
    "start": "2667910",
    "end": "2690160"
  },
  {
    "text": "Alice good and so there's a link of",
    "start": "2690160",
    "end": "2696170"
  },
  {
    "text": "course ah here we go good it's much better than me typing it so we have one where you can prescribe 1020 or placebo",
    "start": "2696170",
    "end": "2703810"
  },
  {
    "text": "so I think a nurse can can prescribe up to 10 a doctor should be able to",
    "start": "2703810",
    "end": "2709430"
  },
  {
    "text": "prescribe up to 20 great that works but if we come in now as Bob the nurse right",
    "start": "2709430",
    "end": "2716360"
  },
  {
    "text": "Bob can do ten that's great but now twenty tonight so again did you mention",
    "start": "2716360",
    "end": "2727400"
  },
  {
    "text": "this is now since it's in the DI system it's now testable and and and your",
    "start": "2727400",
    "end": "2732970"
  },
  {
    "text": "handler class and can take any other dependencies it needs so one of the things that's commonly you know need to",
    "start": "2732970",
    "end": "2739730"
  },
  {
    "text": "be done as you might need to look up stuff out of a database for example yeah",
    "start": "2739730",
    "end": "2747290"
  },
  {
    "text": "the very last thing is that authorization for can also work globally right so it's it's basically you're not",
    "start": "2747290",
    "end": "2753650"
  },
  {
    "text": "forced to opt in to authorization what you can also do is have a global authorization policy and then opt out",
    "start": "2753650",
    "end": "2759200"
  },
  {
    "text": "wherever you need and so let's say for example you know like a very common thing is that you only allow",
    "start": "2759200",
    "end": "2764990"
  },
  {
    "text": "authenticated users but there could be arbitrary complex you have the full power of the a spirit core policy system",
    "start": "2764990",
    "end": "2771470"
  },
  {
    "text": "here and you can create our jury complex policies which you know define the shape",
    "start": "2771470",
    "end": "2777260"
  },
  {
    "text": "of the user before he can even use the application and then you can use local policies as well on top of that okay I",
    "start": "2777260",
    "end": "2784850"
  },
  {
    "text": "don't think we have to show that okay good let's go back so yeah",
    "start": "2784850",
    "end": "2791099"
  },
  {
    "text": "so we showed this to a couple of people",
    "start": "2791099",
    "end": "2796739"
  },
  {
    "text": "yeah and to get some feedback and so on and and again keep in mind yeah that the",
    "start": "2796739",
    "end": "2803009"
  },
  {
    "text": "ultimate a question was can we create a turnkey solution so to speak for",
    "start": "2803009",
    "end": "2809160"
  },
  {
    "text": "authorization I think the ultimate answer is you can't yeah no one can because at a certain",
    "start": "2809160",
    "end": "2816509"
  },
  {
    "text": "point authorization becomes business logic okay so what you can do is you can",
    "start": "2816509",
    "end": "2823049"
  },
  {
    "text": "definitely use a standardized or a general authorization component to",
    "start": "2823049",
    "end": "2828420"
  },
  {
    "text": "define who is allowed to access my application that's easy yeah that's a global policy you can",
    "start": "2828420",
    "end": "2834709"
  },
  {
    "text": "authorize on who has access to certain features of your application and I think",
    "start": "2834709",
    "end": "2839819"
  },
  {
    "text": "again you have the choice of being you know role-based more coarse-grained right and if you drill into the feature",
    "start": "2839819",
    "end": "2847019"
  },
  {
    "text": "like you know maybe you know ten ten milligram versus 20 milligram whatever that could be a permission thing yeah",
    "start": "2847019",
    "end": "2854400"
  },
  {
    "text": "but once you drill even deeper yeah like I don't know now is this patient",
    "start": "2854400",
    "end": "2860099"
  },
  {
    "text": "actually allergic to anything inside the aspirin yeah is that really authorization logic I really think that",
    "start": "2860099",
    "end": "2867119"
  },
  {
    "text": "that's business rules at this point yeah that's why we stopped here some people asked us can you go one step further and",
    "start": "2867119",
    "end": "2872640"
  },
  {
    "text": "then we were suddenly in the exact amol dilemma right where we started to have",
    "start": "2872640",
    "end": "2878369"
  },
  {
    "text": "the need of expressing business logic inside our code where I think you are much more effective expressing it in",
    "start": "2878369",
    "end": "2885180"
  },
  {
    "text": "your own code okay but that's I think where we ended up with we have ten more",
    "start": "2885180",
    "end": "2893039"
  },
  {
    "text": "minutes so maybe you want to just show quickly a couple of the advanced things which are not in the you know on github",
    "start": "2893039",
    "end": "2898829"
  },
  {
    "text": "button right in the UI right so what we have here is also then running locally I",
    "start": "2898829",
    "end": "2906630"
  },
  {
    "text": "have our management UI for policy server so now this is the centralized version",
    "start": "2906630",
    "end": "2913559"
  },
  {
    "text": "if you will of what we just demoed so the idea is that the centralization of this allows you to put your policy",
    "start": "2913559",
    "end": "2920640"
  },
  {
    "text": "definitions you know in a database you can have an traitor come and you know if you're",
    "start": "2920640",
    "end": "2926910"
  },
  {
    "text": "onboarding a new user you can start to go to the different policies for the applications that the users allowed or",
    "start": "2926910",
    "end": "2933180"
  },
  {
    "text": "should be allowed to and start to map them to these roles and permissions but again it's done through this UI so yeah",
    "start": "2933180",
    "end": "2939360"
  },
  {
    "text": "we have our this is our first version if you will of our UI hey we have a few",
    "start": "2939360",
    "end": "2945900"
  },
  {
    "text": "policies already here that we're gonna map again these are stored centrally so what will happen is then the client",
    "start": "2945900",
    "end": "2952650"
  },
  {
    "text": "library the one that we just showed you that you can call directly in your MVC code there's a different version you can",
    "start": "2952650",
    "end": "2958530"
  },
  {
    "text": "swap in and this different version will then connect to the centralized policy server instead your code really",
    "start": "2958530",
    "end": "2965520"
  },
  {
    "text": "shouldn't have to change in your application now that you're centralizing this so we have one one simple policy",
    "start": "2965520",
    "end": "2971760"
  },
  {
    "text": "here modeling our emergency room scenario this is kind of our doctor",
    "start": "2971760",
    "end": "2976980"
  },
  {
    "text": "nurse and patient scenario and so our management tool allows you to define",
    "start": "2976980",
    "end": "2982440"
  },
  {
    "text": "roles for this application so the idea is that you'd create different policies for each of your applications and do",
    "start": "2982440",
    "end": "2988890"
  },
  {
    "text": "your mapping to your users from your identity system so in this case we have our doctor and notice our doctor can be",
    "start": "2988890",
    "end": "2996000"
  },
  {
    "text": "assigned from some identity data so just like we had before the users unique ID maybe in this case it's Alice if you",
    "start": "2996000",
    "end": "3002870"
  },
  {
    "text": "want to do the identity role assignments maybe right surgeons are allowed to come in here and",
    "start": "3002870",
    "end": "3009290"
  },
  {
    "text": "do this okay so now surgeons are mapped to the doctor role in the emergency room",
    "start": "3009290",
    "end": "3016390"
  },
  {
    "text": "another thing we have is again the user ID or identity roles that's a good for",
    "start": "3016390",
    "end": "3022550"
  },
  {
    "text": "start and that's useful but you know you might want to have your own custom logic based on their identity information to",
    "start": "3022550",
    "end": "3029030"
  },
  {
    "text": "decide how to do this mapping so we even allow you to to put in an expression",
    "start": "3029030",
    "end": "3034190"
  },
  {
    "text": "here so this is actually accepting a lambda expression right and you can",
    "start": "3034190",
    "end": "3040400"
  },
  {
    "text": "actually put in a c-sharp lambda here and we actually will evaluate this at run time based on the claims coming in",
    "start": "3040400",
    "end": "3048080"
  },
  {
    "text": "while you're executing this policy okay so you don't have to do one-to-one mappings right if you know that certain",
    "start": "3048080",
    "end": "3055490"
  },
  {
    "text": "users will always come in with a certain identity you can automatically assign them to roles and permissions without having to",
    "start": "3055490",
    "end": "3061010"
  },
  {
    "text": "change it all the time so if not that I'd want my sick users to fall into the doctor role but you see that that is now",
    "start": "3061010",
    "end": "3068540"
  },
  {
    "text": "in there okay good so it's same same mapping logic just a",
    "start": "3068540",
    "end": "3074030"
  },
  {
    "text": "couple more features so then down below we have the notion of our permissions and same thing you'd model the the",
    "start": "3074030",
    "end": "3080450"
  },
  {
    "text": "actions that a user may or may not be allowed to perform and then based on what your roles are you can simply",
    "start": "3080450",
    "end": "3086360"
  },
  {
    "text": "indicate right if the user should be allowed to do that okay so that's the",
    "start": "3086360",
    "end": "3091610"
  },
  {
    "text": "this is a simple version if you will very much like our JSON file again what's maybe different about this is",
    "start": "3091610",
    "end": "3097340"
  },
  {
    "text": "then it is in fact centralized and we have our management tools as part of the commercial product there's more though",
    "start": "3097340",
    "end": "3105290"
  },
  {
    "text": "than this because you know you might have this notion where well I might be building multiple applications and the",
    "start": "3105290",
    "end": "3111770"
  },
  {
    "text": "design here is to have a different policy for each application it's supposed to be you know application",
    "start": "3111770",
    "end": "3117250"
  },
  {
    "text": "contextual so the problem with this then is that of course well if all of your",
    "start": "3117250",
    "end": "3123560"
  },
  {
    "text": "identity mappings are the same but maybe each app has different permissions it's tedious to redefine all those mappings",
    "start": "3123560",
    "end": "3130670"
  },
  {
    "text": "so we realized that if we're gonna be build something here that's actually you know production-ready",
    "start": "3130670",
    "end": "3135800"
  },
  {
    "text": "we're gonna have to have the notion of a policy hierarchy okay so the idea where you can actually define a parent policy",
    "start": "3135800",
    "end": "3142940"
  },
  {
    "text": "and then have a child policy that inherits configuration that you've done upstream so this particular example",
    "start": "3142940",
    "end": "3149930"
  },
  {
    "text": "actually is attempting to model that where we have maybe some hospital system that you're building and then there are",
    "start": "3149930",
    "end": "3156770"
  },
  {
    "text": "child policies beneath that and in this particular example the child policies represent the application so we have a",
    "start": "3156770",
    "end": "3163880"
  },
  {
    "text": "medical records application and an accounting application okay they share the notion of roles and who is in the",
    "start": "3163880",
    "end": "3171140"
  },
  {
    "text": "roles so if you're a doctor in one you're going to be a doctor in another but you need a separate configuration",
    "start": "3171140",
    "end": "3177320"
  },
  {
    "text": "because they have different concepts of permissions so what we've done here is we've modeled our role mapping at the",
    "start": "3177320",
    "end": "3184400"
  },
  {
    "text": "root of this policy hierarchy at the hospital level and so again our doctor we have users mapped to the",
    "start": "3184400",
    "end": "3190960"
  },
  {
    "text": "to roll and then as you navigate to one of these child policies right you are",
    "start": "3190960",
    "end": "3197290"
  },
  {
    "text": "inheriting the notion of these roles but this particular policy has permissions",
    "start": "3197290",
    "end": "3202510"
  },
  {
    "text": "so this is an example of the application specific permissions and certain users",
    "start": "3202510",
    "end": "3207520"
  },
  {
    "text": "are allowed to do create of medical records or whatever this represents okay",
    "start": "3207520",
    "end": "3213480"
  },
  {
    "text": "all right so that's another example of a",
    "start": "3213480",
    "end": "3219010"
  },
  {
    "text": "feature that's in the commercial product is this notion of hierarchy in the policies so it turns out there's another",
    "start": "3219010",
    "end": "3225490"
  },
  {
    "text": "use case as well I had a customer that I built some authorization engine for",
    "start": "3225490",
    "end": "3230920"
  },
  {
    "text": "several years ago and they basically wanted to model a scenario it was actually a fire marshal submit scenario",
    "start": "3230920",
    "end": "3239050"
  },
  {
    "text": "where like a fireman would come into a building to inspect all of the the",
    "start": "3239050",
    "end": "3244420"
  },
  {
    "text": "safety equipment in the building and so they had very strict rules about which fire marshals were allowed to inspect",
    "start": "3244420",
    "end": "3252070"
  },
  {
    "text": "which floors of the building or which rooms in the building okay so they",
    "start": "3252070",
    "end": "3257200"
  },
  {
    "text": "needed to have a hierarchy to model the building and who could be assigned to",
    "start": "3257200",
    "end": "3262270"
  },
  {
    "text": "the various floors and rooms and devices in that room for this inspection purpose so that was another scenario that we",
    "start": "3262270",
    "end": "3269530"
  },
  {
    "text": "wanted to be able to accommodate in our policy server so this other example is an example of the hierarchy and it's",
    "start": "3269530",
    "end": "3276460"
  },
  {
    "text": "actually sort of the inverse of the prior hierarchy so the first hierarchy we defined the roles at the top that",
    "start": "3276460",
    "end": "3281500"
  },
  {
    "text": "were the same mapping across all applications but different apps had different permissions in this particular example we have the notion of roles in",
    "start": "3281500",
    "end": "3290140"
  },
  {
    "text": "an application okay that are defined at the top but what we're doing is we're doing the permission mapping at the top",
    "start": "3290140",
    "end": "3296170"
  },
  {
    "text": "and then down the hierarchy the hierarchy now represents resources in",
    "start": "3296170",
    "end": "3301480"
  },
  {
    "text": "this particular case the hospital so maybe a particular emergency room you",
    "start": "3301480",
    "end": "3306880"
  },
  {
    "text": "know a particular nurse could be assigned to that emergency room but not some other room maybe not the operating",
    "start": "3306880",
    "end": "3312640"
  },
  {
    "text": "room in the hospital so our hierarchy in this particular example is actually modeling physical things so there are a",
    "start": "3312640",
    "end": "3321310"
  },
  {
    "text": "doctor or a nurse they have the permission to work in a particular room in the hospital so",
    "start": "3321310",
    "end": "3328510"
  },
  {
    "text": "the permission mapping is at the root of the hierarchy but notice at the root of the hierarchy okay we don't have anybody",
    "start": "3328510",
    "end": "3334930"
  },
  {
    "text": "assigned yet where did these are just placeholders to model the the roles and then if you actually go to the emergency",
    "start": "3334930",
    "end": "3341380"
  },
  {
    "text": "room right what we've done is at the emergency room done the role mapping so",
    "start": "3341380",
    "end": "3346420"
  },
  {
    "text": "maybe right now this nurse named Alice is assigned to that particular level in",
    "start": "3346420",
    "end": "3353350"
  },
  {
    "text": "the hierarchy so again for this particular emergency room this person can be the nurse maybe there's an",
    "start": "3353350",
    "end": "3360880"
  },
  {
    "text": "operating room maybe there's actually even nested you know further hierarchy so room operating room one we have Bob",
    "start": "3360880",
    "end": "3368950"
  },
  {
    "text": "is assigned to operating room one but maybe for a different operating room we have a different assignment so the point",
    "start": "3368950",
    "end": "3375940"
  },
  {
    "text": "is basically what you can do with this system is also to outsource you know like when you're building an application",
    "start": "3375940",
    "end": "3381310"
  },
  {
    "text": "where your users can create resources dynamically you can outsource that permission management to this here and",
    "start": "3381310",
    "end": "3387760"
  },
  {
    "text": "don't have to build it into your own code yeah think of things that get happier where I can create a repo right",
    "start": "3387760",
    "end": "3392920"
  },
  {
    "text": "and then in my repo I can assign proc push access to it right so that that could be also done with the system and",
    "start": "3392920",
    "end": "3399880"
  },
  {
    "text": "that's what we had in mind here right so backing the management UI here is we have an API so the management tool is",
    "start": "3399880",
    "end": "3406990"
  },
  {
    "text": "using the the Web API this is an API that you could be tapping into as well from your application if your",
    "start": "3406990",
    "end": "3413140"
  },
  {
    "text": "application was dynamically modeling these resources and doing assignments okay cool that's it so if you are",
    "start": "3413140",
    "end": "3424150"
  },
  {
    "text": "interested in that well okay can you can you bring up the slide with the URLs again so you can goat with the URLs of",
    "start": "3424150",
    "end": "3432700"
  },
  {
    "text": "policy server oh we have not yeah we're just go on up in the middle yes yeah",
    "start": "3432700",
    "end": "3442060"
  },
  {
    "text": "okay so if you're interested in that play around with the open source version if you're interested in using that",
    "start": "3442060",
    "end": "3448030"
  },
  {
    "text": "commercially let us know there's a different website with a link to a contact form and so on so forth and and",
    "start": "3448030",
    "end": "3456040"
  },
  {
    "text": "give it a try okay thank you thanks [Applause]",
    "start": "3456040",
    "end": "3463550"
  }
]