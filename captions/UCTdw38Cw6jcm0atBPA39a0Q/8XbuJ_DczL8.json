[
  {
    "start": "0",
    "end": "56000"
  },
  {
    "text": "right welcome um I hope everybody enjoyed their lunch and that the last people are finding",
    "start": "4140",
    "end": "10380"
  },
  {
    "text": "Siege otherwise otherwise fill in the gaps so everybody can can be here there's more people than expected",
    "start": "10380",
    "end": "17820"
  },
  {
    "text": "um that's good I guess um well the title of the talk is uh effective testing in microservice",
    "start": "17820",
    "end": "24119"
  },
  {
    "text": "systems but I guess you already know that because you're here and you can read and everything um but anyway that is the title of the",
    "start": "24119",
    "end": "30779"
  },
  {
    "text": "title of talk um my name is Christian um I wrote this microservices book and",
    "start": "30779",
    "end": "38880"
  },
  {
    "text": "much of what I'll talk about today is in here not all of it but that is and there's a lot of content surrounding the",
    "start": "38880",
    "end": "45840"
  },
  {
    "text": "topic that I'm talking about today in here as well I brought two copies so the first people who asked for them after",
    "start": "45840",
    "end": "51300"
  },
  {
    "text": "the talk will get those if you want them um that's not the point the point is the",
    "start": "51300",
    "end": "57180"
  },
  {
    "start": "56000",
    "end": "409000"
  },
  {
    "text": "talk so um it was effective testing in microservice",
    "start": "57180",
    "end": "63059"
  },
  {
    "text": "systems so the first question here that pops up is what should we test and well",
    "start": "63059",
    "end": "69540"
  },
  {
    "text": "it sounds like a very concrete question I guess it is but the answer might not",
    "start": "69540",
    "end": "74580"
  },
  {
    "text": "be quite as concrete but we'll slowly get there get into that as we move through this Hawk",
    "start": "74580",
    "end": "81180"
  },
  {
    "text": "um but really I think it's very much about testing enough to have confidence to deploy to production and that means",
    "start": "81180",
    "end": "88799"
  },
  {
    "text": "different things for different systems there are different consequences to different systems",
    "start": "88799",
    "end": "94640"
  },
  {
    "text": "getting it wrong in production so there's different tolerance of risk but you need at least but overall no matter",
    "start": "94640",
    "end": "102360"
  },
  {
    "text": "what the tolerance or risk is you need the confidence to actually deploy to production otherwise you're just stuck in in your test environment that's",
    "start": "102360",
    "end": "108540"
  },
  {
    "text": "that's no good so that's something we want we also want a",
    "start": "108540",
    "end": "114000"
  },
  {
    "text": "a the maintenance effort to be sensical so you can't you can't spend all your",
    "start": "114000",
    "end": "120060"
  },
  {
    "text": "time uh writing tests or doing manual tests for that that matter we probably can't spend zero time either that",
    "start": "120060",
    "end": "126600"
  },
  {
    "text": "probably wouldn't give you the confidence to to deploy um and then well there's not really a",
    "start": "126600",
    "end": "134280"
  },
  {
    "text": "what to test but it's a why is testing a a separate topic when we talk about",
    "start": "134280",
    "end": "140520"
  },
  {
    "text": "microservices is that that you quickly when you move into microservice get hundreds of of services well maybe not",
    "start": "140520",
    "end": "148200"
  },
  {
    "text": "quickly actually I think in my experience looks like people spend like the six months building the first",
    "start": "148200",
    "end": "154620"
  },
  {
    "text": "microservice and then they built six months building five more and then it accelerates then six months after that",
    "start": "154620",
    "end": "159840"
  },
  {
    "text": "they have a hundred and then they have then it just goes up from there so they really accelerate and and you probably",
    "start": "159840",
    "end": "166440"
  },
  {
    "text": "need to get on top of your testing strategy before you have 300 services in in production right",
    "start": "166440",
    "end": "172860"
  },
  {
    "text": "um because if you have that many you you sort of can't really just sort of bring",
    "start": "172860",
    "end": "178440"
  },
  {
    "text": "it up all locally and just uh test out everything in all combinations of of everything that's not really an option",
    "start": "178440",
    "end": "184500"
  },
  {
    "text": "uh um with that many moving parts and that many services so we we sort of have to",
    "start": "184500",
    "end": "190620"
  },
  {
    "text": "attack it slightly differently than that and that's what we will get into but first",
    "start": "190620",
    "end": "196019"
  },
  {
    "text": "um we need to detour a little bit and just very quickly talk a little bit about what a microservice is in my world",
    "start": "196019",
    "end": "204000"
  },
  {
    "text": "at least I think you can find lots of different definitions so what I'm going by is that the microservice is something",
    "start": "204000",
    "end": "209879"
  },
  {
    "text": "that is responsible for a single capability it's individually Deployable",
    "start": "209879",
    "end": "215159"
  },
  {
    "text": "so you can deploy one without deploying the whole world and all of it so that",
    "start": "215159",
    "end": "221040"
  },
  {
    "text": "testing enough to have confidence to deploy that's about well you deploy one at a time so I have to have the",
    "start": "221040",
    "end": "227220"
  },
  {
    "text": "confidence that you can actually do that that you don't have to orchestrate all of it all at once",
    "start": "227220",
    "end": "233819"
  },
  {
    "text": "um yeah so there can be more than one Deployable unit that's not really that employer that uh",
    "start": "233819",
    "end": "240500"
  },
  {
    "text": "important in this context um there's a data store associated with",
    "start": "240500",
    "end": "246060"
  },
  {
    "text": "each and every one of them um that has some impact on the testing strategy",
    "start": "246060",
    "end": "251220"
  },
  {
    "text": "and well in terms of size um a small team can handle",
    "start": "251220",
    "end": "257160"
  },
  {
    "text": "well actually a few handfuls of of services and this is like really gray",
    "start": "257160",
    "end": "262979"
  },
  {
    "text": "area um what that actually means but I think it it gives a feel for the kind of size",
    "start": "262979",
    "end": "269220"
  },
  {
    "text": "that we're that we're looking at and the kind of of things that we're looking at",
    "start": "269220",
    "end": "274680"
  },
  {
    "text": "um and they are replaceable in the sense that since they are so focused it's actually possible to to say oh that was",
    "start": "274680",
    "end": "282419"
  },
  {
    "text": "the wrong technology we're going to implement it in some something else and do that in the normal pace of work without spending the big replacement",
    "start": "282419",
    "end": "291120"
  },
  {
    "text": "um a project that never ends so that's also something that you sort of have to",
    "start": "291120",
    "end": "296220"
  },
  {
    "text": "probably take into consideration with testing that that you need to support this tenant as well",
    "start": "296220",
    "end": "302220"
  },
  {
    "text": "okay so making it a bit more concrete and and having a bit uh of example of of",
    "start": "302220",
    "end": "307919"
  },
  {
    "text": "what a microservice might do um because I think that impacts the testing effort quite a lot",
    "start": "307919",
    "end": "314460"
  },
  {
    "text": "um we can think about a loyalty program so uh whatever chain of stores you might be",
    "start": "314460",
    "end": "323280"
  },
  {
    "text": "able to think about you can have like an app or plastic card and then every time you buy something you get loyalty points",
    "start": "323280",
    "end": "329520"
  },
  {
    "text": "and then they try to make you buy even more or stuff like that um many companies have these you probably",
    "start": "329520",
    "end": "336600"
  },
  {
    "text": "know about them right so you could have this loyalty program the green one in",
    "start": "336600",
    "end": "341639"
  },
  {
    "text": "the middle and it has some connections to to some other microservices and the",
    "start": "341639",
    "end": "346919"
  },
  {
    "text": "exact connections here are not that important um the ones that we're concentrating on today is in the upper left hand corner",
    "start": "346919",
    "end": "354479"
  },
  {
    "text": "there's the uh left up there sorry there",
    "start": "354479",
    "end": "360240"
  },
  {
    "text": "um that's the special offers microservice so you could imagine that as a back office UI something where",
    "start": "360240",
    "end": "368880"
  },
  {
    "text": "and somebody can put in a special offer and say on Saturday you can get three",
    "start": "368880",
    "end": "374639"
  },
  {
    "text": "for the price of two then the Loyalty program picks that up as an event says",
    "start": "374639",
    "end": "380039"
  },
  {
    "text": "okay who's interested in that and everybody in the Loyalty program who we think are interested in that we give",
    "start": "380039",
    "end": "385680"
  },
  {
    "text": "them a notification email text whatever and say okay go buy our fabulous stuff",
    "start": "385680",
    "end": "391860"
  },
  {
    "text": "because this is something you usually uh usually buy so this is sort of an approximation that loyalty program",
    "start": "391860",
    "end": "398039"
  },
  {
    "text": "that's the first approximation of how we might break a part a small part of this",
    "start": "398039",
    "end": "403560"
  },
  {
    "text": "system into some some microservices so this is trying to make it a bit more concrete what we're talking about",
    "start": "403560",
    "end": "410479"
  },
  {
    "start": "409000",
    "end": "683000"
  },
  {
    "text": "and why exactly that well because the scope of a microservice should really be",
    "start": "410479",
    "end": "416940"
  },
  {
    "text": "driven by business capabilities so a microservice should be responsible for a",
    "start": "416940",
    "end": "423180"
  },
  {
    "text": "single business capability and this is important in terms of testing because that means that that now we're talking",
    "start": "423180",
    "end": "429060"
  },
  {
    "text": "about something that we can talk about how should work with that isn't",
    "start": "429060",
    "end": "434160"
  },
  {
    "text": "technical is actually business and that's what we want to test um that we want to test that capability",
    "start": "434160",
    "end": "442199"
  },
  {
    "text": "um now what does the capability mean that's a little bit difficult and that's why I said that the Loyalty program is",
    "start": "442199",
    "end": "447539"
  },
  {
    "text": "kind of the first approximation because if you drive into it it tends to be that that there's more things inside of what",
    "start": "447539",
    "end": "456180"
  },
  {
    "text": "you might at first think is a good uh capability so if you do some I don't",
    "start": "456180",
    "end": "461639"
  },
  {
    "text": "know brainstorming event storming you do do some of these different",
    "start": "461639",
    "end": "467340"
  },
  {
    "text": "um ideation techniques um or just really go talk to the",
    "start": "467340",
    "end": "472620"
  },
  {
    "text": "business or your well the business Tech is hopefully part of the business go talk to other parts of the business and",
    "start": "472620",
    "end": "480840"
  },
  {
    "text": "probably usually find out that there there are more details to things so off the top of my head a loyalty program",
    "start": "480840",
    "end": "487560"
  },
  {
    "text": "there's something about issuing and canceling these plastic cards there's something about awarding these loyalty",
    "start": "487560",
    "end": "495000"
  },
  {
    "text": "points you might decide that everybody with a lots of points we organize a",
    "start": "495000",
    "end": "500940"
  },
  {
    "text": "monthly raffle and they can win some something something or they might be eligible to these",
    "start": "500940",
    "end": "508620"
  },
  {
    "text": "special offers based on their points and their interests and stuff like that or you might even organize special events",
    "start": "508620",
    "end": "515459"
  },
  {
    "text": "like the car dealership that loves you will invite you for a golf because then they",
    "start": "515459",
    "end": "521880"
  },
  {
    "text": "hope you buy an extra car or something it could be smaller things as well but that could be different things right",
    "start": "521880",
    "end": "528480"
  },
  {
    "text": "so it could probably turn out that loyalty program might over time not actually be a service but it's a",
    "start": "528480",
    "end": "536580"
  },
  {
    "text": "boundary context which is I'm taking from a domain driven design",
    "start": "536580",
    "end": "541640"
  },
  {
    "text": "onto sort of a grouping of of these services that kind of belong together",
    "start": "541640",
    "end": "547200"
  },
  {
    "text": "and form a cohesive all and then some of these that we haven't had on the",
    "start": "547200",
    "end": "553440"
  },
  {
    "text": "previous slide might actually be the capabilities that we have in different services so my point in showing this",
    "start": "553440",
    "end": "560459"
  },
  {
    "text": "even though we're actually talking about testing is that it sort of turns out that that that a microservice system",
    "start": "560459",
    "end": "567779"
  },
  {
    "text": "evolves over time as does any system and what you'll see is that you'll have",
    "start": "567779",
    "end": "574440"
  },
  {
    "text": "different areas of the system that look at different in terms of the breakdown",
    "start": "574440",
    "end": "580800"
  },
  {
    "text": "and the size and we can use that to guide some of our testing efforts as well",
    "start": "580800",
    "end": "586620"
  },
  {
    "text": "so when we drive into what something really means and how it should really work and",
    "start": "586620",
    "end": "592500"
  },
  {
    "text": "we want to experiment with it and we want to develop it and it's important for the business it tends to get broken",
    "start": "592500",
    "end": "599220"
  },
  {
    "text": "more down so that might be the the green one over there",
    "start": "599220",
    "end": "604519"
  },
  {
    "text": "that has smaller Services inside of it because we've worked in more detail with",
    "start": "604519",
    "end": "610500"
  },
  {
    "text": "it than the red one at the bottom well there might be something more emergent that we're we're not that certain about",
    "start": "610500",
    "end": "616860"
  },
  {
    "text": "yet so we have a slightly bigger service and then sort of some someone some some smaller ones beside it because we're not",
    "start": "616860",
    "end": "623760"
  },
  {
    "text": "quite sure yet how to chop this up in a really good way um and we're not maybe sure of the",
    "start": "623760",
    "end": "630420"
  },
  {
    "text": "importance yet either and then the blue one might be just something that we just buy from a third party because it's just",
    "start": "630420",
    "end": "637320"
  },
  {
    "text": "generic for us so again and DDD trims this might be the",
    "start": "637320",
    "end": "642540"
  },
  {
    "text": "core domain and this might be a supporting subdomain and this might be like a generic third-party thing a",
    "start": "642540",
    "end": "648899"
  },
  {
    "text": "generic subdomain and already here we can sort of think about",
    "start": "648899",
    "end": "654420"
  },
  {
    "text": "okay where do we really want to concentrate the test efforts we probably want it around the the core",
    "start": "654420",
    "end": "662279"
  },
  {
    "text": "and secondarily around the the supporting subdomain of course we want to test everything and want to be really",
    "start": "662279",
    "end": "668220"
  },
  {
    "text": "good around everything but we don't live in a perfect world um so so maybe sometimes we actually do",
    "start": "668220",
    "end": "674160"
  },
  {
    "text": "have to prioritize just a little bit and I think concentrating on the core is",
    "start": "674160",
    "end": "679860"
  },
  {
    "text": "probably a good idea when it comes to testing as well so",
    "start": "679860",
    "end": "685800"
  },
  {
    "text": "okay so now let's get into two two tests and we'll just start off with the uh",
    "start": "685800",
    "end": "691500"
  },
  {
    "text": "with with this the test pyramid I'm sure you've seen it before it's been around for a long time quite classic we have uh",
    "start": "691500",
    "end": "699959"
  },
  {
    "text": "unit test at the bottom um then we have a middle layer and on top we have and then the top layer we",
    "start": "699959",
    "end": "706019"
  },
  {
    "text": "have system tests and in the middle one on these slides I've written service tests and that's not usually what it",
    "start": "706019",
    "end": "712920"
  },
  {
    "text": "says there it usually says something like integration tests that's probably often what you would have seen but when",
    "start": "712920",
    "end": "719339"
  },
  {
    "text": "it comes to testing microservices I think it's",
    "start": "719339",
    "end": "724560"
  },
  {
    "text": "I think it makes more sense uh at least when you sort of get over the the hump of seeing it a little bit differently to",
    "start": "724560",
    "end": "731339"
  },
  {
    "text": "talk about service tests because a service test uh is well something that tests a",
    "start": "731339",
    "end": "737640"
  },
  {
    "text": "microservice and and if we look at this picture again we can see at least in the",
    "start": "737640",
    "end": "744480"
  },
  {
    "text": "core those are some quite small ones and yeah there might be some integration anyway going on but it's it's kind of a",
    "start": "744480",
    "end": "751260"
  },
  {
    "text": "nice testable unit so I think I've already said that's the one thing you should remember from the talk that one",
    "start": "751260",
    "end": "756779"
  },
  {
    "text": "microservice is actually a quite nice testable unit",
    "start": "756779",
    "end": "761420"
  },
  {
    "text": "um system level tests those are I don't think they are that different",
    "start": "762360",
    "end": "768300"
  },
  {
    "text": "when we talk about a microservice system compared to a monolithic system or a",
    "start": "768300",
    "end": "774899"
  },
  {
    "text": "more traditional solar system where we have bigger Services they are black bugs",
    "start": "774899",
    "end": "780660"
  },
  {
    "text": "so they don't know how things are implemented so it really shouldn't be that different based on what the area",
    "start": "780660",
    "end": "786560"
  },
  {
    "text": "how it's it's implemented they test the complete system and",
    "start": "786560",
    "end": "792720"
  },
  {
    "text": "I am my recommendation is usually that those could cover the most important",
    "start": "792720",
    "end": "798360"
  },
  {
    "text": "happy path use cases not all use cases because it tends to be too much",
    "start": "798360",
    "end": "803700"
  },
  {
    "text": "maintenance effort but again what are the most important that that depends on the how risk averse we are in a com in a",
    "start": "803700",
    "end": "813300"
  },
  {
    "text": "given situation um compared to well the consequences and so on",
    "start": "813300",
    "end": "818940"
  },
  {
    "text": "um but as I said I don't think the effort putting into to system level",
    "start": "818940",
    "end": "824100"
  },
  {
    "text": "tests is so different because it's uh it's microservices so I'm not going to talk more about those that doesn't mean",
    "start": "824100",
    "end": "831420"
  },
  {
    "text": "I don't think they have a role to play I do it's just not different where based on whether it's uh it's a monolith or",
    "start": "831420",
    "end": "837839"
  },
  {
    "text": "it's microservices these the service levels that's the middle middle level I think are very",
    "start": "837839",
    "end": "843360"
  },
  {
    "text": "different when it comes to a a microservice system so we can test a",
    "start": "843360",
    "end": "850680"
  },
  {
    "text": "complete microservice and I think that's what we should do at this level um we can have the other services be",
    "start": "850680",
    "end": "858360"
  },
  {
    "text": "stopped or marked depending on which word you you prefer just meaning that",
    "start": "858360",
    "end": "864720"
  },
  {
    "text": "we'll have fake versions of the of the other microservices um",
    "start": "864720",
    "end": "871019"
  },
  {
    "text": "and I sometimes think about these as sort of a gray box so we have the Black",
    "start": "871019",
    "end": "877139"
  },
  {
    "text": "Box white box uh terminology and this is sort of gray and in between because",
    "start": "877139",
    "end": "883320"
  },
  {
    "text": "um it's from the outside of the of the microservice we test the whole microservice so if the microservice were",
    "start": "883320",
    "end": "890639"
  },
  {
    "text": "a system it was an end-to-end complete Survey System test but it's not we",
    "start": "890639",
    "end": "896760"
  },
  {
    "text": "there's there's dependencies and collaboration between these different microservices and since we are mocking",
    "start": "896760",
    "end": "903000"
  },
  {
    "text": "the other microservices we do know something about the implementation not inside of the microservice but inside",
    "start": "903000",
    "end": "908699"
  },
  {
    "text": "but in in part of the system so it's kind of a gray in between thing here",
    "start": "908699",
    "end": "915839"
  },
  {
    "text": "um and I think with this level um we can cover",
    "start": "915839",
    "end": "921720"
  },
  {
    "text": "all the important scenarios for that service meaning all the important",
    "start": "921720",
    "end": "926820"
  },
  {
    "text": "scenarios for that business capability so that comes back to why I wanted to point out that the scope and",
    "start": "926820",
    "end": "934019"
  },
  {
    "text": "responsibility of a microservice should really be a business capability because this is something that we can that we",
    "start": "934019",
    "end": "940199"
  },
  {
    "text": "can put on a slightly higher level of abstraction than than the technology and the implementation but I actually talk",
    "start": "940199",
    "end": "946680"
  },
  {
    "text": "about what's important in terms of say a loyalty program which scenarios should",
    "start": "946680",
    "end": "952800"
  },
  {
    "text": "it really really always support and as opposed to system where I tend to",
    "start": "952800",
    "end": "961740"
  },
  {
    "text": "mostly go for the positive heavy path uh things this can easily be this also can",
    "start": "961740",
    "end": "967620"
  },
  {
    "text": "can include uh negative things failures of of different kinds",
    "start": "967620",
    "end": "974519"
  },
  {
    "text": "um right so another thing that we could notice from",
    "start": "974519",
    "end": "979740"
  },
  {
    "text": "that I'll just jump back to it from",
    "start": "979740",
    "end": "984839"
  },
  {
    "text": "oh there we go from uh this picture is that",
    "start": "984839",
    "end": "993180"
  },
  {
    "text": "there's a lot of arrows between these things now depending on what those arrows mean we can have a higher or",
    "start": "993180",
    "end": "999600"
  },
  {
    "text": "lower coupling so even though there are a lot of arrows we can have nice low coupling but it does mean that there is",
    "start": "999600",
    "end": "1006320"
  },
  {
    "text": "collaboration going on between these uh the these microservices and it does mean that if we just take one of the white",
    "start": "1006320",
    "end": "1013100"
  },
  {
    "text": "boxes and isolate then we can know a lot about how well that one works but what",
    "start": "1013100",
    "end": "1021019"
  },
  {
    "text": "does it tell about the system well it tells us something but we don't really know about",
    "start": "1021019",
    "end": "1027079"
  },
  {
    "text": "the arrows so I think that's another thing that happens when we move from either traditional zoa or monolith and",
    "start": "1027079",
    "end": "1035120"
  },
  {
    "text": "to watch microservices is that we take some of the complexity that we already have in our code bases and then we move",
    "start": "1035120",
    "end": "1040640"
  },
  {
    "text": "it sort of outside of the code base it says into the collaboration so we move it from the code base and onto the network",
    "start": "1040640",
    "end": "1046480"
  },
  {
    "text": "be it cues or trpc or HTTP apis no",
    "start": "1046480",
    "end": "1052580"
  },
  {
    "text": "matter what I mean we're we're moving it from how the code works and how to how the code communicates but that doesn't",
    "start": "1052580",
    "end": "1059299"
  },
  {
    "text": "mean the complexity is gone we've just moved it so we want to look at covering",
    "start": "1059299",
    "end": "1065179"
  },
  {
    "text": "that as well uh let's just jump um",
    "start": "1065179",
    "end": "1070580"
  },
  {
    "text": "so once we're here where we were before we we've covered the service but we haven't covered the arrows and that's",
    "start": "1070580",
    "end": "1077900"
  },
  {
    "text": "why we want to supplement this with the with contract tests with exactly cover",
    "start": "1077900",
    "end": "1083440"
  },
  {
    "text": "the the the the arrows so I think this what we've summarized on this slide I",
    "start": "1083440",
    "end": "1089780"
  },
  {
    "text": "think is really uh the new thing when it comes to having good test automation",
    "start": "1089780",
    "end": "1096140"
  },
  {
    "text": "around microservices compared to uh um to other architectures",
    "start": "1096140",
    "end": "1101900"
  },
  {
    "text": "unit testing um is the last part of the pyramid",
    "start": "1101900",
    "end": "1107679"
  },
  {
    "text": "still important but just like the system tests not that much changes just because",
    "start": "1107679",
    "end": "1116419"
  },
  {
    "text": "you move to to microservices usually test a unit of behavior",
    "start": "1116419",
    "end": "1124000"
  },
  {
    "text": "I'm pausing here because I think that's important and it continues to be misunderstood so we're not testing a",
    "start": "1124640",
    "end": "1132020"
  },
  {
    "text": "class we're not testing a function we're testing a unit of behavior and it doesn't really matter if it takes two",
    "start": "1132020",
    "end": "1138380"
  },
  {
    "text": "classes to implement that behavior so you don't have to like have the exact same structure in like the production",
    "start": "1138380",
    "end": "1145220"
  },
  {
    "text": "code and the test code doesn't have to be one to one that's the same files all",
    "start": "1145220",
    "end": "1150320"
  },
  {
    "text": "over because then you'll really hamper your ability to refactor so don't do",
    "start": "1150320",
    "end": "1155780"
  },
  {
    "text": "that focus on Behavior please um and try to avoid mocks don't Mark too much",
    "start": "1155780",
    "end": "1162559"
  },
  {
    "text": "you just end up fighting the mocking Frameworks instead of delivering actual code",
    "start": "1162559",
    "end": "1168860"
  },
  {
    "text": "this might be the last thing I'm going to say about you and says there might be one most lighter candidate I can remember but that's about it because",
    "start": "1168860",
    "end": "1174380"
  },
  {
    "text": "again this isn't that different um so on to these service level tests again",
    "start": "1174380",
    "end": "1182120"
  },
  {
    "start": "1178000",
    "end": "1207000"
  },
  {
    "text": "and let's look a little bit more at it so back to the example as well with the",
    "start": "1182120",
    "end": "1187900"
  },
  {
    "text": "Loyalty program and we're now back to the state where we haven't done the",
    "start": "1187900",
    "end": "1193820"
  },
  {
    "text": "further breakdown of the Loyalty program we just see it as one large program the company has decided we need a loyalty",
    "start": "1193820",
    "end": "1200120"
  },
  {
    "text": "program so for now it's one thing and then we might discover that it's more than one thing as we as we go",
    "start": "1200120",
    "end": "1207620"
  },
  {
    "start": "1207000",
    "end": "1370000"
  },
  {
    "text": "so well demo is maybe overstating it but I'm going to show you a little bit outside of the slides",
    "start": "1207620",
    "end": "1214940"
  },
  {
    "text": "um so we have a loyalty program running it has some some HTTP endpoints it's not",
    "start": "1214940",
    "end": "1222559"
  },
  {
    "text": "that it's not that advanced really there's a post endpoint to register users and",
    "start": "1222559",
    "end": "1230179"
  },
  {
    "text": "that's my mouse which we can open there and then",
    "start": "1230179",
    "end": "1237559"
  },
  {
    "text": "when we register somebody we can sort of register a few interests so",
    "start": "1237559",
    "end": "1243020"
  },
  {
    "text": "they might be interested in basketball and",
    "start": "1243020",
    "end": "1249440"
  },
  {
    "text": "I don't know children's books or something like that for some reason",
    "start": "1249440",
    "end": "1254900"
  },
  {
    "text": "then we have another service running we have the special offers one it's really not",
    "start": "1254900",
    "end": "1261860"
  },
  {
    "text": "doesn't do that much and it has this fantastic UI that I know every business person would love",
    "start": "1261860",
    "end": "1269539"
  },
  {
    "text": "um that allows them to create a special offer and they can't really do that much",
    "start": "1269539",
    "end": "1274640"
  },
  {
    "text": "they can describe the special offer and then they can put some tags on and those tags will match against the the",
    "start": "1274640",
    "end": "1280700"
  },
  {
    "text": "interests of people in the Loyalty program so if they make a special offer",
    "start": "1280700",
    "end": "1285860"
  },
  {
    "text": "for children's books then the person talked about before might get a notification saying hey we have a good",
    "start": "1285860",
    "end": "1291380"
  },
  {
    "text": "offer for uh for children's books when something is posted into this endpoint",
    "start": "1291380",
    "end": "1297380"
  },
  {
    "text": "um what the special offers service does is that it places something onto AQ I've",
    "start": "1297380",
    "end": "1303980"
  },
  {
    "text": "just used rapid mq here it's not about which technology it's just some queuing system",
    "start": "1303980",
    "end": "1310520"
  },
  {
    "text": "um that says hey there's a new special offer so special offer created and then",
    "start": "1310520",
    "end": "1316880"
  },
  {
    "text": "we have more back back actually oh there we go the larger program sorry",
    "start": "1316880",
    "end": "1324020"
  },
  {
    "text": "for all the switching uh back to the Loyalty program so this one will listen on that revlim q q and get the special",
    "start": "1324020",
    "end": "1333140"
  },
  {
    "text": "offer match it against the interests of whoever's registered and then lastly the",
    "start": "1333140",
    "end": "1339200"
  },
  {
    "text": "lodge program will call this post endpoint on the notification service and",
    "start": "1339200",
    "end": "1344720"
  },
  {
    "text": "then the responsibility of this service to actually notify people via however they want to be notified",
    "start": "1344720",
    "end": "1351400"
  },
  {
    "text": "whether they prefer email or text message or whatever okay so",
    "start": "1351400",
    "end": "1357320"
  },
  {
    "text": "um I'm not going to go through posting into these because that's not really that interesting",
    "start": "1357320",
    "end": "1363740"
  },
  {
    "text": "um and well it works",
    "start": "1363740",
    "end": "1367720"
  },
  {
    "text": "um so back to the slide so let's talk about if we had that system so right now",
    "start": "1369260",
    "end": "1374299"
  },
  {
    "start": "1370000",
    "end": "1555000"
  },
  {
    "text": "we sort of just have that system we've thrown it into production no test at all",
    "start": "1374299",
    "end": "1379760"
  },
  {
    "text": "um so that's not that good that doesn't give us confidence the next time",
    "start": "1379760",
    "end": "1385220"
  },
  {
    "text": "so we want to get started writing these um service level tests and we should",
    "start": "1385220",
    "end": "1392299"
  },
  {
    "text": "test the complete microservice and mark the other ones so what we have is that",
    "start": "1392299",
    "end": "1397760"
  },
  {
    "text": "we have the Loyalty program and that's the real code running like it really does using the real database and real",
    "start": "1397760",
    "end": "1407120"
  },
  {
    "text": "HTTP and real rapid mq and so on and then we have a marked special offers",
    "start": "1407120",
    "end": "1413299"
  },
  {
    "text": "microservice and we'll get a little bit back to what marked even means it's maybe",
    "start": "1413299",
    "end": "1418700"
  },
  {
    "text": "it sounds bigger than it is it's really small you'll see but what we need is something that sends an event over",
    "start": "1418700",
    "end": "1425900"
  },
  {
    "text": "rabbit and we just send a canned event just something hard-coded because then we know how the Loyalty program is",
    "start": "1425900",
    "end": "1432260"
  },
  {
    "text": "supposed to react right and then the loyalty programs and a the",
    "start": "1432260",
    "end": "1439280"
  },
  {
    "text": "Loyalty program sends a command over to a mocked version of the notifications microservice and a command here really",
    "start": "1439280",
    "end": "1446000"
  },
  {
    "text": "means it calls that post endpoint that the notifications service had and then",
    "start": "1446000",
    "end": "1451940"
  },
  {
    "text": "the mark that we have will just give a canned response back he'll just say okay",
    "start": "1451940",
    "end": "1456980"
  },
  {
    "text": "that's fine and that's what we'll do for now and of course you can do lots more you could have error scenarios maybe",
    "start": "1456980",
    "end": "1463520"
  },
  {
    "text": "it's down or maybe it can't find the user it's supposed to notify and so on you can test these",
    "start": "1463520",
    "end": "1469940"
  },
  {
    "text": "scenarios out as well and the way we can set it up that I find",
    "start": "1469940",
    "end": "1475820"
  },
  {
    "text": "is quite nice is again run the other side run the Loyalty",
    "start": "1475820",
    "end": "1482539"
  },
  {
    "text": "program for real the real code the real everything and then we have beside that",
    "start": "1482539",
    "end": "1487700"
  },
  {
    "text": "we have the our well assessed integration test I'm sorry about that it should say a service level test process",
    "start": "1487700",
    "end": "1495500"
  },
  {
    "text": "so I can't even switch from integration to that so we have a service level test scenario",
    "start": "1495500",
    "end": "1502159"
  },
  {
    "text": "running in there and what that does and that's kind of the mark of the special offers is it just puts a message onto",
    "start": "1502159",
    "end": "1508520"
  },
  {
    "text": "that rapidmq um which is kind of nothing special that's",
    "start": "1508520",
    "end": "1513919"
  },
  {
    "text": "also what we do in our real code so just do the things that we already know how to do over in the tests",
    "start": "1513919",
    "end": "1520400"
  },
  {
    "text": "the real code turns around and makes a request",
    "start": "1520400",
    "end": "1525799"
  },
  {
    "text": "to the mocked notifications microservice which we are actually running inside of the same",
    "start": "1525799",
    "end": "1532039"
  },
  {
    "text": "process because it turns out that we know how to take processes and host and GDP endpoints because that's what we do",
    "start": "1532039",
    "end": "1538580"
  },
  {
    "text": "in our real code so we can also do it in our test code so we're just doing the things we already know how to do",
    "start": "1538580",
    "end": "1545600"
  },
  {
    "text": "um and then this is a really really simple endpoint he'll just say OK and record the fact that it was called and",
    "start": "1545600",
    "end": "1553100"
  },
  {
    "text": "how it was called yeah so",
    "start": "1553100",
    "end": "1558919"
  },
  {
    "start": "1555000",
    "end": "1881000"
  },
  {
    "text": "a little bit of demo time and that looks horrible",
    "start": "1558919",
    "end": "1566419"
  },
  {
    "text": "let's see if that looks better if we just go out of presentation mode and back into it",
    "start": "1566419",
    "end": "1572320"
  },
  {
    "text": "into presentation mode okay so that's a little bit better so we have a test here and that's our",
    "start": "1574880",
    "end": "1584900"
  },
  {
    "text": "um scenario and the scenario is that we want to notify an eligible user that's",
    "start": "1584900",
    "end": "1590179"
  },
  {
    "text": "been the thing all along and we just I mean we can refactor code again that's",
    "start": "1590179",
    "end": "1595580"
  },
  {
    "text": "exactly like we do it in the production code anyway so we can of course split things out into methods so we get",
    "start": "1595580",
    "end": "1601940"
  },
  {
    "text": "something that looks like the capability like talking about the capability the business",
    "start": "1601940",
    "end": "1608240"
  },
  {
    "text": "capability of the service which if we register a new user and create a special",
    "start": "1608240",
    "end": "1613520"
  },
  {
    "text": "offer we want to assert that the notification was sent okay so that's a",
    "start": "1613520",
    "end": "1621500"
  },
  {
    "text": "capability that we want the Loyalty program to have that's one of the things that you do so I mean again without",
    "start": "1621500",
    "end": "1628460"
  },
  {
    "text": "using a lot of special Frameworks or anything we are able to write a test that that that kind of talks in that",
    "start": "1628460",
    "end": "1635299"
  },
  {
    "text": "language I'm not saying you can just turn around and show this to your business people have them write it but at least you can have a conversation",
    "start": "1635299",
    "end": "1641059"
  },
  {
    "text": "about what this actually really means um because if they can just ignore like",
    "start": "1641059",
    "end": "1646279"
  },
  {
    "text": "the parenthesis and the await and stuff and register a new user create a special",
    "start": "1646279",
    "end": "1651380"
  },
  {
    "text": "offer and a notification was sent okay we can talk about that so how are these implemented we have the",
    "start": "1651380",
    "end": "1658760"
  },
  {
    "text": "register U so just above here if I remember correctly there we have it and",
    "start": "1658760",
    "end": "1665120"
  },
  {
    "text": "this is of course more more Technical and and not very business friendly but",
    "start": "1665120",
    "end": "1671360"
  },
  {
    "text": "but and this gets a little bit closer to the implementation and this is where sort of we get gets gray box because we",
    "start": "1671360",
    "end": "1676940"
  },
  {
    "text": "don't know exactly what's going on inside the uh um the Loyalty program but we do know",
    "start": "1676940",
    "end": "1682400"
  },
  {
    "text": "how to talk to the Loyalty program sort of technically and what we do is that we take an HTTP client",
    "start": "1682400",
    "end": "1688279"
  },
  {
    "text": "um there's an HTTP client and we post something to it and we post to the slash",
    "start": "1688279",
    "end": "1693700"
  },
  {
    "text": "users with whatever body we need in order to actually uh create a user so",
    "start": "1693700",
    "end": "1700520"
  },
  {
    "text": "blah blah blah this calls an endpoint and registers a user we do the similar kind of thing for this create special",
    "start": "1700520",
    "end": "1707419"
  },
  {
    "text": "offer we have this below down here and there we go so we create an event",
    "start": "1707419",
    "end": "1715039"
  },
  {
    "text": "and we probably already have this type that defines the event because we need it over in the special offers so this is",
    "start": "1715039",
    "end": "1722779"
  },
  {
    "text": "not something that we're making up for the test it's something we already have and we probably already know how to talk",
    "start": "1722779",
    "end": "1728059"
  },
  {
    "text": "to rabbitmq because the special offers microservice does that and that's what we're doing here so again we're",
    "start": "1728059",
    "end": "1734120"
  },
  {
    "text": "publishing something onto rapidmq and then we wait for a while",
    "start": "1734120",
    "end": "1740900"
  },
  {
    "text": "because now we've registered the user created a special offer and then the",
    "start": "1740900",
    "end": "1746659"
  },
  {
    "text": "assertion comes and then there's this exponential retry",
    "start": "1746659",
    "end": "1752260"
  },
  {
    "text": "policy here where it's in order to make these kinds of tests run is is necessary",
    "start": "1752260",
    "end": "1758240"
  },
  {
    "text": "I'm using the poly framework here sort of show of hands does people know what does people know poly okay so I'll not",
    "start": "1758240",
    "end": "1765740"
  },
  {
    "text": "talk a lot about poly because I think 80 put their hand up um so we're using poly in order to to do",
    "start": "1765740",
    "end": "1771860"
  },
  {
    "text": "some retries and and and wait which is sort of a fast way of waiting and when it works this will just run through",
    "start": "1771860",
    "end": "1777919"
  },
  {
    "text": "really really fast and then when it fails it's slower because we have to wait for the retries and the timeouts",
    "start": "1777919",
    "end": "1783080"
  },
  {
    "text": "and stuff but um I don't know I'm an optimistic person so I I tend to like that it's fast when it",
    "start": "1783080",
    "end": "1789860"
  },
  {
    "text": "works because it probably does most of the time um so there we go so so that's one of these",
    "start": "1789860",
    "end": "1798140"
  },
  {
    "text": "um service level tests and okay just to go on on a limb let's try to actually",
    "start": "1798140",
    "end": "1805700"
  },
  {
    "text": "run it and see what happens and and an end running running right",
    "start": "1805700",
    "end": "1813080"
  },
  {
    "text": "oh I know why yeah this is going to fail uh yeah there we go so",
    "start": "1813080",
    "end": "1818720"
  },
  {
    "text": "[Music] um yeah and it fails slowly as you noticed because it had to uh to time out and",
    "start": "1818720",
    "end": "1825860"
  },
  {
    "text": "everything the re Ese and is that",
    "start": "1825860",
    "end": "1831260"
  },
  {
    "text": "uh okay you can't really see what this is but uh you'll have to believe me when",
    "start": "1831260",
    "end": "1836840"
  },
  {
    "text": "I say that what we have running here in this uh in this terminal window is a",
    "start": "1836840",
    "end": "1842659"
  },
  {
    "text": "sorry copy of that loyalty program so we actually have like we sort of had I",
    "start": "1842659",
    "end": "1849440"
  },
  {
    "text": "started one up in the test but then I had a competing one already running and that grabbed the message of a",
    "start": "1849440",
    "end": "1856779"
  },
  {
    "text": "rabbit mq so it failed so we saw a failure now I'll just uh stop that",
    "start": "1856779",
    "end": "1863000"
  },
  {
    "text": "and take it off screen again back to the IDE",
    "start": "1863000",
    "end": "1870200"
  },
  {
    "text": "and rerun and then hope that all right yeah you saw it run through",
    "start": "1870200",
    "end": "1875840"
  },
  {
    "text": "and it's much quicker when it actually uh actually worked yeah okay so",
    "start": "1875840",
    "end": "1883820"
  },
  {
    "start": "1881000",
    "end": "2097000"
  },
  {
    "text": "now we've established a test that tests the behavior of a full microservice and",
    "start": "1883820",
    "end": "1892760"
  },
  {
    "text": "of course this was just a small one but I mean we can just keep going with these and actually cover scenarios that are",
    "start": "1892760",
    "end": "1900440"
  },
  {
    "text": "important for that business capability now the other part that I also wanted to",
    "start": "1900440",
    "end": "1906380"
  },
  {
    "text": "test on this service level were the contracts so the contracts between these",
    "start": "1906380",
    "end": "1911720"
  },
  {
    "text": "different microservices so here we were asserting that a",
    "start": "1911720",
    "end": "1918320"
  },
  {
    "text": "notification was sent but at least that's what we claimed we were asserting",
    "start": "1918320",
    "end": "1924200"
  },
  {
    "text": "but since we're only looking at the um the Loyalty program what we're actually",
    "start": "1924200",
    "end": "1929899"
  },
  {
    "text": "asserting is that it made a request towards the notification service that",
    "start": "1929899",
    "end": "1936260"
  },
  {
    "text": "according to the Loyalty program is supposed to make the notifications send",
    "start": "1936260",
    "end": "1941480"
  },
  {
    "text": "a notification but there's some assumptions here and that's well there's something that the",
    "start": "1941480",
    "end": "1948260"
  },
  {
    "text": "notification service works and can actually send notifications I'm okay with that at this level because I'm",
    "start": "1948260",
    "end": "1954320"
  },
  {
    "text": "assuming that service also has tests so I'm just looking at the Loyalty",
    "start": "1954320",
    "end": "1959600"
  },
  {
    "text": "program but there's still the assumption that the way we're calling the notification service is correct and",
    "start": "1959600",
    "end": "1965480"
  },
  {
    "text": "that's the contract we're using um we also want to test that to have a",
    "start": "1965480",
    "end": "1972020"
  },
  {
    "text": "good confidence this is by no means a new idea as always Martin Fowler has",
    "start": "1972020",
    "end": "1978320"
  },
  {
    "text": "written a really good explanation what is what this is more than 10 years ago",
    "start": "1978320",
    "end": "1983659"
  },
  {
    "text": "um that's how it is with both things um I will talk a little bit about what it",
    "start": "1983659",
    "end": "1989299"
  },
  {
    "text": "is anyway so in the test that we just saw",
    "start": "1989299",
    "end": "1995539"
  },
  {
    "text": "we had the Loyalty program send a command to the mock the command",
    "start": "1995539",
    "end": "2001840"
  },
  {
    "text": "is the post request we did that in in this manner where it",
    "start": "2001840",
    "end": "2008740"
  },
  {
    "text": "sends a real HTTP request into the mock okay",
    "start": "2008740",
    "end": "2014860"
  },
  {
    "text": "so [Music] um if we want to test the",
    "start": "2014860",
    "end": "2020799"
  },
  {
    "text": "um if we want to test whether that contract is the right one we can sort of turn",
    "start": "2020799",
    "end": "2026799"
  },
  {
    "text": "around and go from the mock",
    "start": "2026799",
    "end": "2033460"
  },
  {
    "text": "whatever the mark got into it is kind of the contract or that's the expectation of the Loyalty",
    "start": "2033460",
    "end": "2039519"
  },
  {
    "text": "program we can send that into the notification service get a real response back and then we can",
    "start": "2039519",
    "end": "2047500"
  },
  {
    "text": "assert whether that meets the whether that looks the same as the thing that",
    "start": "2047500",
    "end": "2052658"
  },
  {
    "text": "the mock responds with and if there's a discrepancy there then the Mark is wrong",
    "start": "2052659",
    "end": "2057700"
  },
  {
    "text": "and then we have to change the mark and see if the Loyalty program now fails and",
    "start": "2057700",
    "end": "2063040"
  },
  {
    "text": "it might of course um so that's really the basic idea of",
    "start": "2063040",
    "end": "2068740"
  },
  {
    "text": "the contract trust record what we based on the mark what we what the",
    "start": "2068740",
    "end": "2075158"
  },
  {
    "text": "expectations are turn around and use that on the real service at the other end",
    "start": "2075159",
    "end": "2080320"
  },
  {
    "text": "um yeah so look putting that on a drawing we still have the real HTTP",
    "start": "2080320",
    "end": "2085839"
  },
  {
    "text": "request and then once it gets into the the mock we can just record uh what",
    "start": "2085839",
    "end": "2091658"
  },
  {
    "text": "happened and recording what does that mean that means just dumping it into a file really",
    "start": "2091659",
    "end": "2097359"
  },
  {
    "start": "2097000",
    "end": "2431000"
  },
  {
    "text": "so last look at code",
    "start": "2097359",
    "end": "2103420"
  },
  {
    "text": "and maybe we'll just actually close this and we'll be able to see something yes",
    "start": "2103420",
    "end": "2110200"
  },
  {
    "text": "and we will switch to another file and we'll switch",
    "start": "2110200",
    "end": "2115420"
  },
  {
    "text": "switch to the notifications mock so that's to No Surprise the implementation of the",
    "start": "2115420",
    "end": "2122619"
  },
  {
    "text": "marked version of this notification service and it's really not that advanced it",
    "start": "2122619",
    "end": "2130119"
  },
  {
    "text": "and as I said I mean we're able to create endpoints in our in our services",
    "start": "2130119",
    "end": "2136480"
  },
  {
    "text": "so we probably also able to do it here let's again sort of show of hands who has worked with the with the asp.net",
    "start": "2136480",
    "end": "2146020"
  },
  {
    "text": "so this is familiar code I think a controller that can react to an HTTP",
    "start": "2146020",
    "end": "2153579"
  },
  {
    "text": "post on some path notifications and it does something it just says yay I",
    "start": "2153579",
    "end": "2160300"
  },
  {
    "text": "got a a a notification request and then it returns okay so it says 200 okay and",
    "start": "2160300",
    "end": "2168220"
  },
  {
    "text": "that's the that's the mocking part and then the recording part is in here and the details aren't that important",
    "start": "2168220",
    "end": "2174400"
  },
  {
    "text": "the important bit is write all text to a file and the text that we write is",
    "start": "2174400",
    "end": "2181660"
  },
  {
    "text": "the body of of the incoming request so whatever the Loyalty program sends in we",
    "start": "2181660",
    "end": "2188500"
  },
  {
    "text": "write that down um and",
    "start": "2188500",
    "end": "2193540"
  },
  {
    "text": "it just does it to somewhere called recorded contracts post Dash notifications.json so there's maybe",
    "start": "2193540",
    "end": "2202780"
  },
  {
    "text": "also encoded a couple of of assumptions here as well that based on the name of",
    "start": "2202780",
    "end": "2208540"
  },
  {
    "text": "the of the file this is because it was a post request and I'm expecting the body to be be Json here okay so",
    "start": "2208540",
    "end": "2217660"
  },
  {
    "text": "um let's take a look at how that looks in",
    "start": "2217660",
    "end": "2223599"
  },
  {
    "text": "so we have those here and just that's what on the last test run that we did",
    "start": "2223599",
    "end": "2229060"
  },
  {
    "text": "before this is the body that we sent and this is a body that we wrote then we can",
    "start": "2229060",
    "end": "2234880"
  },
  {
    "text": "turn around and create a notifications contract test here and we'll have one",
    "start": "2234880",
    "end": "2240520"
  },
  {
    "text": "say that says verify loyalty program contract and what it does is that",
    "start": "2240520",
    "end": "2248680"
  },
  {
    "text": "well it has kind of an ugly path here but it's it's a path to the Json file we just looked at",
    "start": "2248680",
    "end": "2254140"
  },
  {
    "text": "and then it creates an HTTP client sorry",
    "start": "2254140",
    "end": "2261160"
  },
  {
    "text": "just do it like this create an HTTP client reads from that file because that's the body of the request we want",
    "start": "2261160",
    "end": "2268480"
  },
  {
    "text": "um it does the actual request towards the actual um notifications you can see localhost",
    "start": "2268480",
    "end": "2274180"
  },
  {
    "text": "here depending on where and how you want to run your test that can be localhost or you could run it against the test",
    "start": "2274180",
    "end": "2279460"
  },
  {
    "text": "environment and sort of also a consideration but that depends a little bit on how your whole environment is set",
    "start": "2279460",
    "end": "2285280"
  },
  {
    "text": "up and then lastly we have an assertion here that we have something to be some",
    "start": "2285280",
    "end": "2291460"
  },
  {
    "text": "some expected status code that we want to get rack from the actual um notification service here and that's",
    "start": "2291460",
    "end": "2298540"
  },
  {
    "text": "the that's the second document that we have in this uh this one so we get that in as",
    "start": "2298540",
    "end": "2303880"
  },
  {
    "text": "an argument and what we it was okay in this case and what we have above here",
    "start": "2303880",
    "end": "2310420"
  },
  {
    "text": "um so this is X unit I'm I'm using an assuming again that's probably",
    "start": "2310420",
    "end": "2317560"
  },
  {
    "text": "so again show of hands have you worked with X unit",
    "start": "2317560",
    "end": "2323380"
  },
  {
    "text": "yeah have you worked with theories next unit okay so that that was less than half so",
    "start": "2323380",
    "end": "2330040"
  },
  {
    "text": "I'm going to explain what that is um so index unit a test is called a fact",
    "start": "2330040",
    "end": "2335680"
  },
  {
    "text": "so we decorate it with fact up here and that's one example that you run as a",
    "start": "2335680",
    "end": "2341440"
  },
  {
    "text": "unit test then the theory is kind of a collection of facts and the way that you",
    "start": "2341440",
    "end": "2346540"
  },
  {
    "text": "do that is that you take the test method that you already have and then you parameterize that in this case with a",
    "start": "2346540",
    "end": "2353800"
  },
  {
    "text": "path to somewhere where we want to read that body from and unexpected HTTP status code that we want to get back and",
    "start": "2353800",
    "end": "2360220"
  },
  {
    "text": "then you could put in these uh inline data that says Okay so the first",
    "start": "2360220",
    "end": "2366520"
  },
  {
    "text": "argument I want to be this long string that's the path and the second document I want to be HTTP status code okay",
    "start": "2366520",
    "end": "2374320"
  },
  {
    "text": "then I could just have more of these um so if I had more contracts I would just",
    "start": "2374320",
    "end": "2380040"
  },
  {
    "text": "put them down here I have and now my ID is telling me that I'm copying code",
    "start": "2380040",
    "end": "2387359"
  },
  {
    "text": "um but if I did have more recordings I",
    "start": "2387700",
    "end": "2393040"
  },
  {
    "text": "could have those be one of these because it's just exactly the same thing and that's kind of a point that's why even",
    "start": "2393040",
    "end": "2399099"
  },
  {
    "text": "though I just have one X angle I I used a parameterized test in in the shape of a theory here because it's really I",
    "start": "2399099",
    "end": "2407200"
  },
  {
    "text": "think you should really strive for making this test generic and then just fill in all those contracts and that's",
    "start": "2407200",
    "end": "2414640"
  },
  {
    "text": "in contrast to the other test we saw that I don't want to be generic I want that to be specific to the business",
    "start": "2414640",
    "end": "2420520"
  },
  {
    "text": "capability and talk in in business terms this is much more technical just make it generic and test the contracts that you",
    "start": "2420520",
    "end": "2427359"
  },
  {
    "text": "get out because that's going to be the easiest way for you right [Music]",
    "start": "2427359",
    "end": "2432940"
  },
  {
    "start": "2431000",
    "end": "2743000"
  },
  {
    "text": "um this was hand-holding the um the the contract tests which I think you can get",
    "start": "2432940",
    "end": "2440260"
  },
  {
    "text": "far with you can also look at some helpful tools uh mounder bank is one",
    "start": "2440260",
    "end": "2445660"
  },
  {
    "text": "pack there's another packed specifically for um um contract tests amount of bank has a",
    "start": "2445660",
    "end": "2452380"
  },
  {
    "text": "slightly different uh Focus why didn't I just use pack then",
    "start": "2452380",
    "end": "2457960"
  },
  {
    "text": "well because it doesn't do exactly what I've showed you here but it does something useful as well it's just more",
    "start": "2457960",
    "end": "2463720"
  },
  {
    "text": "of a unit test style it does for the recording so it doesn't quite fit in with recording from these service level",
    "start": "2463720",
    "end": "2470800"
  },
  {
    "text": "tests um but I mean",
    "start": "2470800",
    "end": "2476079"
  },
  {
    "text": "that might be me being a little bit not invented by me kind of that I wanted to be exactly my",
    "start": "2476079",
    "end": "2482980"
  },
  {
    "text": "way so do take a look at these as as well it might just be exactly what what",
    "start": "2482980",
    "end": "2488440"
  },
  {
    "text": "you need in your context right so that's the whole thing for service level testers behavioral part",
    "start": "2488440",
    "end": "2495040"
  },
  {
    "text": "and there's a contract part below where the unit tests and well as I already said it's special business as",
    "start": "2495040",
    "end": "2502300"
  },
  {
    "text": "usual then we need to prioritize what to test and we've talked some about this do the",
    "start": "2502300",
    "end": "2509320"
  },
  {
    "text": "happy path scenarios important happy path scenarios at the the system level goes across everything",
    "start": "2509320",
    "end": "2516460"
  },
  {
    "text": "take a lot more scenarios both positive and negatives once on the level of the",
    "start": "2516460",
    "end": "2523839"
  },
  {
    "text": "services and then the the whatever details you have left do that with with unit testing that's sort of my rules of",
    "start": "2523839",
    "end": "2530560"
  },
  {
    "text": "thumb and the way to make that actually happen to me at least is using outside",
    "start": "2530560",
    "end": "2536560"
  },
  {
    "text": "in tdd so there's two parts to this the first is tdd which I am sure you also",
    "start": "2536560",
    "end": "2545140"
  },
  {
    "text": "heard other people talk about from stages like this one um but it's going around in the circle",
    "start": "2545140",
    "end": "2551079"
  },
  {
    "text": "of writing a test that fails write the production code you need to make it",
    "start": "2551079",
    "end": "2556140"
  },
  {
    "text": "succeed and then refactor your code into something you can actually maintain going around that circle around that",
    "start": "2556140",
    "end": "2561579"
  },
  {
    "text": "Circle that's often talked about in the context of unit test but it works on",
    "start": "2561579",
    "end": "2567940"
  },
  {
    "text": "other levels as well there's no reason it only has to be unit tests um so",
    "start": "2567940",
    "end": "2574300"
  },
  {
    "text": "with the outside in approach to this we want to write the high level ones first",
    "start": "2574300",
    "end": "2579640"
  },
  {
    "text": "and I find that the really effective way to do this with well microservices is to do",
    "start": "2579640",
    "end": "2586599"
  },
  {
    "text": "it exactly at that service level level it's difficult to start at the system level but if we do it at the service",
    "start": "2586599",
    "end": "2592780"
  },
  {
    "text": "level that's doable and we can get some tests that we can get working we can drive until that hurts and again there's",
    "start": "2592780",
    "end": "2600640"
  },
  {
    "text": "gray area here what exactly does that mean um it's one of those things that takes",
    "start": "2600640",
    "end": "2605980"
  },
  {
    "text": "some experience and we kind of know it when we get there um there's usually some setup before we can",
    "start": "2605980",
    "end": "2613540"
  },
  {
    "text": "have those nice scenarios that says register a new user um create special offer so that the",
    "start": "2613540",
    "end": "2620319"
  },
  {
    "text": "right thing happened and it kind of then then sort of that that's okay but if you need to get into something very very",
    "start": "2620319",
    "end": "2626020"
  },
  {
    "text": "specialized there might be more sort of okay you have to if you've registered exactly 101 users with exactly these",
    "start": "2626020",
    "end": "2633579"
  },
  {
    "text": "permutations of interests or whatever and then you post this special offer then something something",
    "start": "2633579",
    "end": "2642180"
  },
  {
    "text": "and that that becomes more difficult and then sometimes it kind of feels like I mean if there's a light switch on the",
    "start": "2642180",
    "end": "2647980"
  },
  {
    "text": "other side of the stage and you're just standing over here and then you have a little stick and you're trying to there's the lights thing light switch",
    "start": "2647980",
    "end": "2655119"
  },
  {
    "text": "then that's that's kind of hurtful and just uh then then don't write at the high level",
    "start": "2655119",
    "end": "2661060"
  },
  {
    "text": "switch gears and write a unit test that you can actually uh put to push the the light switch so you shift down when it",
    "start": "2661060",
    "end": "2669400"
  },
  {
    "text": "becomes too difficult and yes that that that's gray area and yes that takes so",
    "start": "2669400",
    "end": "2674980"
  },
  {
    "text": "many experience to do um and then you just repeat and again everything has been written a",
    "start": "2674980",
    "end": "2682720"
  },
  {
    "text": "long time ago well a long time long in Tech terms so this this book uh growing",
    "start": "2682720",
    "end": "2688359"
  },
  {
    "text": "object-oriented software Guided by tests that's probably more than 10 years old I",
    "start": "2688359",
    "end": "2694780"
  },
  {
    "text": "guess I'm not I should have looked that up beforehand I didn't really good book and describes this in in detail and it",
    "start": "2694780",
    "end": "2703119"
  },
  {
    "text": "says object oriented I think if you want to be more functional because that's more hip today",
    "start": "2703119",
    "end": "2708520"
  },
  {
    "text": "the ideas still apply perfectly and then you can start from that so obviously a",
    "start": "2708520",
    "end": "2714700"
  },
  {
    "text": "service level of tests and drive your way into a good test coverage and get",
    "start": "2714700",
    "end": "2719859"
  },
  {
    "text": "the unit test that you need and then you might not get exactly the",
    "start": "2719859",
    "end": "2725020"
  },
  {
    "text": "pyramid shape you might sort of get going out and then just a fewer unit",
    "start": "2725020",
    "end": "2731200"
  },
  {
    "text": "tests than the pyramid sort of indicates but that's okay as long as you actually get the confidence to deploy as often as",
    "start": "2731200",
    "end": "2738460"
  },
  {
    "text": "you need which is often with with microservices",
    "start": "2738460",
    "end": "2743640"
  },
  {
    "text": "all right so another level of prioritization was around",
    "start": "2743800",
    "end": "2750040"
  },
  {
    "text": "um which areas of the whole thing should we concentrate on and I think",
    "start": "2750040",
    "end": "2755740"
  },
  {
    "text": "we can use some of the the things that we can grab from from domain driven",
    "start": "2755740",
    "end": "2760839"
  },
  {
    "text": "design again where we prioritize where to put in the engineering effort and the well the whole effort in in general",
    "start": "2760839",
    "end": "2768760"
  },
  {
    "text": "um not just engineering and also let that apply to our testing effort so there's this thing called a core domain",
    "start": "2768760",
    "end": "2776020"
  },
  {
    "text": "chart and if you are in this room before lunch you saw Nick June talk about the",
    "start": "2776020",
    "end": "2782079"
  },
  {
    "text": "um this as well and well he has lots of brilliant explanations of really good ways to use this mine is going to be",
    "start": "2782079",
    "end": "2788500"
  },
  {
    "text": "shorter and quicker and less brilliant but it does allow us to do some",
    "start": "2788500",
    "end": "2794200"
  },
  {
    "text": "prioritization because we have how much something differentiates our",
    "start": "2794200",
    "end": "2799599"
  },
  {
    "text": "business at one axis and we have the complexity of that thing in the other axis and then we can place things like",
    "start": "2799599",
    "end": "2806319"
  },
  {
    "text": "say we have authentication is",
    "start": "2806319",
    "end": "2811359"
  },
  {
    "text": "quite complex if we try to build it from the bottom up um",
    "start": "2811359",
    "end": "2816700"
  },
  {
    "text": "but everybody does it it doesn't make my business different from your business",
    "start": "2816700",
    "end": "2821859"
  },
  {
    "text": "that you're able to log in we can do notifications",
    "start": "2821859",
    "end": "2828400"
  },
  {
    "text": "um so again not very differentiating but if we do if we're maybe we're good at it so",
    "start": "2828400",
    "end": "2835660"
  },
  {
    "text": "we send them right at the right time or we send it in the right channel so people don't get annoyed",
    "start": "2835660",
    "end": "2841480"
  },
  {
    "text": "um then we can maybe be better than the competitor that just spams away um but maybe not that differentiating",
    "start": "2841480",
    "end": "2848200"
  },
  {
    "text": "and maybe not as complex as authentication we have the Loyalty program okay it's also something that",
    "start": "2848200",
    "end": "2855940"
  },
  {
    "text": "many companies do so it's not selling us vastly apart but maybe a bit more",
    "start": "2855940",
    "end": "2861160"
  },
  {
    "text": "especially if we do it well um and then we might come up with this",
    "start": "2861160",
    "end": "2866619"
  },
  {
    "text": "very special personal shopper AI machine learning whatever",
    "start": "2866619",
    "end": "2873160"
  },
  {
    "text": "[Music] um passwords put together and that might um also differentiators and might be",
    "start": "2873160",
    "end": "2880480"
  },
  {
    "text": "sort of complex so we can group these things into what the core is what what's supporting the core and what's generic",
    "start": "2880480",
    "end": "2887740"
  },
  {
    "text": "that we should probably just sort of either download or buy and well it doesn't have to only guide",
    "start": "2887740",
    "end": "2894460"
  },
  {
    "text": "but we download or buy you can also guide where we put in the testing effort",
    "start": "2894460",
    "end": "2899980"
  },
  {
    "text": "and I think it all sort of works together because it does I had the drawing with the bubbles the",
    "start": "2899980",
    "end": "2906640"
  },
  {
    "text": "different color Bubbles and it was more broken down than the green one and well that was probably the core and",
    "start": "2906640",
    "end": "2913060"
  },
  {
    "text": "that's where we want to put in the effort and that's where we also probably want to put in the the the the the the",
    "start": "2913060",
    "end": "2918280"
  },
  {
    "text": "testing efforts so these things actually line up quite nicely",
    "start": "2918280",
    "end": "2923319"
  },
  {
    "text": "um then this is not a static view really um what tends to happen is that",
    "start": "2923319",
    "end": "2928599"
  },
  {
    "text": "everything moves back towards a zero differentiation",
    "start": "2928599",
    "end": "2934359"
  },
  {
    "text": "because markets move forward so everything gets commoditized over time your competitors",
    "start": "2934359",
    "end": "2940180"
  },
  {
    "text": "start doing start copying your things and you can you copy your competitor and then",
    "start": "2940180",
    "end": "2945460"
  },
  {
    "text": "it becomes more and more like so if you actually want to keep differentiating you can't leave something alone you have",
    "start": "2945460",
    "end": "2951339"
  },
  {
    "text": "to actually work with it and that means that you can with the wide areas you can you can concentrate something and move",
    "start": "2951339",
    "end": "2956380"
  },
  {
    "text": "it so it's not just static it's also a question of okay we might be okay with notifications",
    "start": "2956380",
    "end": "2963160"
  },
  {
    "text": "slipping completely into it just being generic because at that point we can just retire our own service and buy it",
    "start": "2963160",
    "end": "2970240"
  },
  {
    "text": "from a third party and that's probably cheaper than maintaining it ourselves but the Loyalty program we have lots of",
    "start": "2970240",
    "end": "2976359"
  },
  {
    "text": "good ideas so we actually want to move that the other way we want to be better than our competitors we don't want to",
    "start": "2976359",
    "end": "2981760"
  },
  {
    "text": "just copy them we want to get ahead with that one so that's also an input okay so that means that loyalty program is",
    "start": "2981760",
    "end": "2987760"
  },
  {
    "text": "probably a good place to get a really good service level test coverage so we can experiment we can move fast and we",
    "start": "2987760",
    "end": "2994839"
  },
  {
    "text": "can really be continuous about it so back to this one that the more broken down areas that",
    "start": "2994839",
    "end": "3002940"
  },
  {
    "start": "2996000",
    "end": "3021000"
  },
  {
    "text": "suits really well with the types of tests that I've talked about and luckily that also tends to go hand in hand with",
    "start": "3002940",
    "end": "3010200"
  },
  {
    "text": "the areas that we as a business want to work with and want to do experimentation with and want to work quickly with so",
    "start": "3010200",
    "end": "3017460"
  },
  {
    "text": "that's that's pretty good that actually works together so last real Slide the uh too long",
    "start": "3017460",
    "end": "3024900"
  },
  {
    "start": "3021000",
    "end": "3069000"
  },
  {
    "text": "didn't read slide focus on service level tests",
    "start": "3024900",
    "end": "3030680"
  },
  {
    "text": "that's the thing you should remember that's the gist of it focus on service level tests and service",
    "start": "3030720",
    "end": "3036180"
  },
  {
    "text": "level tests are things that functionally test one complete service with the other",
    "start": "3036180",
    "end": "3041700"
  },
  {
    "text": "microservices stopped out it tests all the important scenarios both positive",
    "start": "3041700",
    "end": "3047460"
  },
  {
    "text": "and negative and it focuses on testing the business capability that this",
    "start": "3047460",
    "end": "3052619"
  },
  {
    "text": "service has then we have the other kind of service level tests the contract tests that you",
    "start": "3052619",
    "end": "3059579"
  },
  {
    "text": "also want so you also get the complexity of what's going on between the services",
    "start": "3059579",
    "end": "3066480"
  },
  {
    "text": "and we're actually a bit early so I guess we have time for questions if",
    "start": "3066480",
    "end": "3073559"
  },
  {
    "start": "3069000",
    "end": "3110000"
  },
  {
    "text": "there are some I can't really see anything so you should just shout if we have some questions there's a hand over there",
    "start": "3073559",
    "end": "3080480"
  },
  {
    "text": "sorry",
    "start": "3084420",
    "end": "3086780"
  },
  {
    "text": "didn't I write tests that were dependent on each other so the contract tests were dependent on",
    "start": "3093059",
    "end": "3098520"
  },
  {
    "text": "the other ones yes that's true well that yeah that's a",
    "start": "3098520",
    "end": "3106740"
  },
  {
    "text": "nice point that that the two styles of service level tests here are dependent",
    "start": "3106740",
    "end": "3112920"
  },
  {
    "text": "on the on on each other that the functional one feeds the test scenarios",
    "start": "3112920",
    "end": "3118559"
  },
  {
    "text": "into the the second one and usually we want to have independent tests that's",
    "start": "3118559",
    "end": "3124079"
  },
  {
    "text": "true I would I'm I handle this by grouping them so we have the uh the the",
    "start": "3124079",
    "end": "3130980"
  },
  {
    "text": "behavioral ones that are run with my uh loyalty program and then at a second",
    "start": "3130980",
    "end": "3137579"
  },
  {
    "text": "stage in my CI I would take the output of that and run the the contract once",
    "start": "3137579",
    "end": "3142980"
  },
  {
    "text": "and and yes that's a a dependency um and it's a trade-off that I'm willing",
    "start": "3142980",
    "end": "3148500"
  },
  {
    "text": "to make to get the coverage of both the behavior and the contracts",
    "start": "3148500",
    "end": "3153740"
  },
  {
    "text": "no it shouldn't be flaky because because they they there's a sequence to how we",
    "start": "3157740",
    "end": "3162900"
  },
  {
    "text": "run it in CI",
    "start": "3162900",
    "end": "3165680"
  },
  {
    "text": "which kind of is testing the internal to compatible testing for actions yes",
    "start": "3191579",
    "end": "3197700"
  },
  {
    "text": "um so the question over here is that I talk about testing the behavior and I think I even mentioned not to Mark too",
    "start": "3197700",
    "end": "3204300"
  },
  {
    "text": "much and you're saying in the uh growing up your gory and the software book they actually do use a lot of mocks",
    "start": "3204300",
    "end": "3211440"
  },
  {
    "text": "um so somebody's done their homework very well and you're right",
    "start": "3211440",
    "end": "3216900"
  },
  {
    "text": "and I don't really agree with that part of the book I very much agree with the driving things from the from the outside",
    "start": "3216900",
    "end": "3223020"
  },
  {
    "text": "in but I think it can be done with a lot less mocking that than what they do in in the book so I agree with you that is",
    "start": "3223020",
    "end": "3230880"
  },
  {
    "text": "a caveat and maybe that's part of what's just happened in the past 10 years that we've",
    "start": "3230880",
    "end": "3237059"
  },
  {
    "text": "realized that we don't need as many monks you don't want my hand",
    "start": "3237059",
    "end": "3243980"
  },
  {
    "text": "yeah so the question is what about side effects if we run the whole uh service we're doing something to its database",
    "start": "3252960",
    "end": "3260160"
  },
  {
    "text": "and stuff like that and that's persistent so that's side effects I guess that's the kind of thing we're talking about yes that's nodding",
    "start": "3260160",
    "end": "3266220"
  },
  {
    "text": "um and yes that's true the way I handle this is is leaning on things like",
    "start": "3266220",
    "end": "3273119"
  },
  {
    "text": "containers and bringing up my service in a container in my continuous integration",
    "start": "3273119",
    "end": "3278400"
  },
  {
    "text": "in environment so for each run it will be a new one um then I mean there's a trade-off do",
    "start": "3278400",
    "end": "3285599"
  },
  {
    "text": "you want to bring the container down and back up again between each test do you",
    "start": "3285599",
    "end": "3291059"
  },
  {
    "text": "want to wipe the database between every every test or are you able to run the",
    "start": "3291059",
    "end": "3296160"
  },
  {
    "text": "whole test Suite with the uh with all this that's less pure but usually faster",
    "start": "3296160",
    "end": "3301579"
  },
  {
    "text": "I sort of tend to watch that in practice that actually good enough that on each",
    "start": "3301579",
    "end": "3307260"
  },
  {
    "text": "the run of the the test Suite you get a fresh start but but of course that's",
    "start": "3307260",
    "end": "3313020"
  },
  {
    "text": "that I mean that's not as pure so I get that that can be a caveat as well so yeah it depends kind of answer is",
    "start": "3313020",
    "end": "3320700"
  },
  {
    "text": "that okay yeah I yeah we do have time still",
    "start": "3320700",
    "end": "3327720"
  },
  {
    "text": "there right there",
    "start": "3327720",
    "end": "3330619"
  },
  {
    "text": "yes good point yeah so you're saying this was a right style of contract that",
    "start": "3339780",
    "end": "3345960"
  },
  {
    "text": "I was looking at so what about read style where you mostly query data get something back from a get endpoint",
    "start": "3345960",
    "end": "3351300"
  },
  {
    "text": "instead of posting something to a a post endpoint well in I think in a sense",
    "start": "3351300",
    "end": "3356579"
  },
  {
    "text": "those are those are almost easier maybe not as",
    "start": "3356579",
    "end": "3362220"
  },
  {
    "text": "automated but they're more stable in the sense that that that that now the mock",
    "start": "3362220",
    "end": "3367920"
  },
  {
    "text": "is very much in charge of what the what the answer is so it's a question of of",
    "start": "3367920",
    "end": "3373380"
  },
  {
    "text": "checking the answer that the mock has against the the real thing as well and",
    "start": "3373380",
    "end": "3379079"
  },
  {
    "text": "doing it when rolling your own and not writing too much of a framework like we",
    "start": "3379079",
    "end": "3384780"
  },
  {
    "text": "just did here I think you'll have a bit of manual you'll have to sort of keep on",
    "start": "3384780",
    "end": "3390599"
  },
  {
    "text": "top of keeping that uh up to date and that's the downside of doing it yourself I think that's actually one of the",
    "start": "3390599",
    "end": "3396059"
  },
  {
    "text": "things that pact will do better for you than than what I'm sort of a leaning driving towards here so so that could be",
    "start": "3396059",
    "end": "3403619"
  },
  {
    "text": "one of the reasons for for using that tool which is a good tool I don't wanna",
    "start": "3403619",
    "end": "3409940"
  },
  {
    "text": "foreign yeah so okay the question is that with the contract says we actually go out and",
    "start": "3426900",
    "end": "3432900"
  },
  {
    "text": "call another uh service so so is it so is the isolation level really a service",
    "start": "3432900",
    "end": "3439520"
  },
  {
    "text": "here and and I I see your argument that it's that it",
    "start": "3439520",
    "end": "3446460"
  },
  {
    "text": "that it that it's not so we could put in a third level and level more and say that we have the service of its own and",
    "start": "3446460",
    "end": "3453839"
  },
  {
    "text": "then we have the arrows between them the uh the contracts that we're that we're testing and see that as a different",
    "start": "3453839",
    "end": "3459480"
  },
  {
    "text": "level and I think that supports a little bit the other question which was aren't these dependent and and yes so I would",
    "start": "3459480",
    "end": "3466380"
  },
  {
    "text": "run them actually sequentially doing the top level ones in one step and the contract ones in another step in in CI",
    "start": "3466380",
    "end": "3474180"
  },
  {
    "text": "and that does sort of depend that you can you could definitely see it as different levels as well",
    "start": "3474180",
    "end": "3480200"
  },
  {
    "text": "last question I think if we have one there's one up there",
    "start": "3481020",
    "end": "3488180"
  },
  {
    "text": "yes the question is that that with the contract test we can actually we can also Express the contracts more formally",
    "start": "3519059",
    "end": "3525780"
  },
  {
    "text": "with the open API uh we could do it with the Proto files for grpc there's",
    "start": "3525780",
    "end": "3532140"
  },
  {
    "text": "different ways of graphql so when we can specify contracts in different kinds of ways and then we can base the mark on",
    "start": "3532140",
    "end": "3538740"
  },
  {
    "text": "that I think all of those are also good ideas to base your mark on I don't think",
    "start": "3538740",
    "end": "3544079"
  },
  {
    "text": "it covers everything that you actually have in the contract because you can that the contract defines the shape of",
    "start": "3544079",
    "end": "3551460"
  },
  {
    "text": "the messages that you can send back and forth but but there's also assumptions",
    "start": "3551460",
    "end": "3556740"
  },
  {
    "text": "about when I send this message I get this back and those I think we still",
    "start": "3556740",
    "end": "3561900"
  },
  {
    "text": "need to to to verify at acquire slightly more detail level but if we have formal",
    "start": "3561900",
    "end": "3567780"
  },
  {
    "text": "contracts I think you can get part of the way there and then you have less left to do with the the contract test so",
    "start": "3567780",
    "end": "3574799"
  },
  {
    "text": "so yes that's that that that's also good to be formal about your contract so I",
    "start": "3574799",
    "end": "3580020"
  },
  {
    "text": "hope that kind of answered that I think that's the uh time we had there were still some hints you could just grab me afterwards and we can have a",
    "start": "3580020",
    "end": "3585780"
  },
  {
    "text": "conversation thank you for listening [Applause]",
    "start": "3585780",
    "end": "3594280"
  }
]