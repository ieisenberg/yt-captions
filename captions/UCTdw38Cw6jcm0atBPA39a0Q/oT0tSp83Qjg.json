[
  {
    "text": "welcome everyone uh to this session where we're gonna see how we can emulate a Game Boy",
    "start": "420",
    "end": "6740"
  },
  {
    "text": "using.net6 in c-sharp in this case um it's gonna be a wild ride because I'm",
    "start": "6740",
    "end": "12540"
  },
  {
    "text": "gonna take you all back first into the dusty Hardware manual and explain how the thing works because you need to know",
    "start": "12540",
    "end": "18060"
  },
  {
    "text": "how the hardware Works before you can emulate it in software but before I start you can't talk about",
    "start": "18060",
    "end": "25680"
  },
  {
    "text": "a Game Boy without doing this one",
    "start": "25680",
    "end": "30859"
  },
  {
    "text": "um and a little bit about myself so my name is Wesley I'm a coding architect at",
    "start": "32340",
    "end": "37500"
  },
  {
    "text": "experience in Belgium um try not to spend too much of my hard-earned money on retro gaming",
    "start": "37500",
    "end": "43920"
  },
  {
    "text": "consoles but I fail because I recently just also bought a Nintendo a classic",
    "start": "43920",
    "end": "50760"
  },
  {
    "text": "one not a small one but the actual units I also love to play around with technology soldering stuff and finding",
    "start": "50760",
    "end": "58440"
  },
  {
    "text": "out how things work um that's sort of when I was very young much to the",
    "start": "58440",
    "end": "64860"
  },
  {
    "text": "yeah my parents didn't like this because I basically took apart every radio that I could find and then try to put it back",
    "start": "64860",
    "end": "70560"
  },
  {
    "text": "together and sometimes it worked mostly it doesn't so we have to buy a lot of radios when I",
    "start": "70560",
    "end": "76080"
  },
  {
    "text": "was young now I have to give some credits first",
    "start": "76080",
    "end": "81360"
  },
  {
    "text": "because some of the people here that visit NEC London might have seen the talk similar like this one because when",
    "start": "81360",
    "end": "88979"
  },
  {
    "text": "I saw David Whitney's session on the same topic I got inspired to do this as well to",
    "start": "88979",
    "end": "95040"
  },
  {
    "text": "give give this a stab of my own but I also saw on YouTube another session by Michael Style",
    "start": "95040",
    "end": "102119"
  },
  {
    "text": "who really goes in depth about the hardware of the Game Boy and these sessions are amazing to see",
    "start": "102119",
    "end": "108659"
  },
  {
    "text": "um if you if you get the slides afterwards all the links are in there as well but this there's like a whole series of",
    "start": "108659",
    "end": "116340"
  },
  {
    "text": "the ultimates something something talk so I do recommend this one if you're into Game Boy",
    "start": "116340",
    "end": "122700"
  },
  {
    "text": "um there's also one about the Atari I think about the Commodore 64. great talks you must see them if you're into",
    "start": "122700",
    "end": "128520"
  },
  {
    "text": "the rich people stuff now as I mentioned I saw these sessions",
    "start": "128520",
    "end": "133760"
  },
  {
    "text": "especially the one from David and I thought now this sounds like a very fun project",
    "start": "133760",
    "end": "139080"
  },
  {
    "text": "to spend my time on so um I got into the Google",
    "start": "139080",
    "end": "145980"
  },
  {
    "text": "I searched for some Hardware material and I found the original documents from",
    "start": "145980",
    "end": "152160"
  },
  {
    "text": "I think it was for Nintendo in America to have them create games as well",
    "start": "152160",
    "end": "157260"
  },
  {
    "text": "so let's first dive in into the hardware specifications of the dmg01 or the dot",
    "start": "157260",
    "end": "164160"
  },
  {
    "text": "matrix Game Boy if you've never seen one",
    "start": "164160",
    "end": "170160"
  },
  {
    "text": "then this is the unit what it looks like um this is what it looks like in real life",
    "start": "170160",
    "end": "176540"
  },
  {
    "text": "still a good decent thing still works after all these years amazing stuff",
    "start": "176540",
    "end": "183239"
  },
  {
    "text": "and it has a very very powerful 8-bit sharp sm83 CPU that runs at 4.19",
    "start": "183239",
    "end": "190920"
  },
  {
    "text": "megahertz not gigahertz not even close but not really and I'll tell you later",
    "start": "190920",
    "end": "197819"
  },
  {
    "text": "why it has a whopping eight kilobytes of work memory and also eight kilobytes of",
    "start": "197819",
    "end": "203580"
  },
  {
    "text": "video memory it has also a boot ROM to start up the Game Boy which is 256 bytes",
    "start": "203580",
    "end": "211080"
  },
  {
    "text": "a nice tall 2.6 inch LCD screen with four colors and a resolution of 160 by",
    "start": "211080",
    "end": "218640"
  },
  {
    "text": "144. um yeah that's not even",
    "start": "218640",
    "end": "224760"
  },
  {
    "text": "one fourth of HD but it worked at that time and for audio we have four channels two",
    "start": "224760",
    "end": "232860"
  },
  {
    "text": "pulse waves one noise and one wave sample if you open it up",
    "start": "232860",
    "end": "238799"
  },
  {
    "text": "I don't recommend it but if you do this is what it looks like inside",
    "start": "238799",
    "end": "243900"
  },
  {
    "text": "so we have let me try to I have to wake this thing up",
    "start": "243900",
    "end": "251459"
  },
  {
    "text": "hello yes that's the CPU and then we have the memory chip here",
    "start": "251459",
    "end": "257400"
  },
  {
    "text": "and then the video RAM over there and if we look inside the CPU",
    "start": "257400",
    "end": "263639"
  },
  {
    "text": "it's actually a system on the chip so the CPU the the DMG CPUs actually is",
    "start": "263639",
    "end": "270419"
  },
  {
    "text": "sharp and I'm going to read this because I can't remember that one lr35902",
    "start": "270419",
    "end": "276600"
  },
  {
    "text": "um that's why we refer to it as a DMG CPU but it is a system on a chip and it has",
    "start": "278520",
    "end": "284460"
  },
  {
    "text": "multiple items it has the actual CPU which is the sharp sm83",
    "start": "284460",
    "end": "289680"
  },
  {
    "text": "it has the ROM the boot ROM an audio processing unit and a picture processing",
    "start": "289680",
    "end": "295860"
  },
  {
    "text": "unit now the system alone if you would power",
    "start": "295860",
    "end": "301919"
  },
  {
    "text": "it on without one of these it's not going to do a lot it's just going to show you a blank line a blank block",
    "start": "301919",
    "end": "310979"
  },
  {
    "text": "so you have to put in a cartridge which looks if you open it up again like this",
    "start": "310979",
    "end": "317300"
  },
  {
    "text": "somewhat like this there are multiple variants of these um why because the earliest cost",
    "start": "317300",
    "end": "324720"
  },
  {
    "text": "cartridges only had the ROM inside so the ROM contains your game the game boots and",
    "start": "324720",
    "end": "331680"
  },
  {
    "text": "then you you start playing it but that only works with games that are",
    "start": "331680",
    "end": "337620"
  },
  {
    "text": "maximum have a maximum size of 32 kilobytes which is not a lot",
    "start": "337620",
    "end": "343979"
  },
  {
    "text": "if you want to have more enhanced games like the Pokemon series",
    "start": "343979",
    "end": "349020"
  },
  {
    "text": "you need bigger cartridges but the problem is that the Game Boy can only address 32 kilobytes of ROM in this",
    "start": "349020",
    "end": "355919"
  },
  {
    "text": "cartridge so clever trick that they used to do in the in the days they swap out",
    "start": "355919",
    "end": "360960"
  },
  {
    "text": "memory banks with something called a memory uh",
    "start": "360960",
    "end": "366419"
  },
  {
    "text": "Bank controller chip which is oop that tiny one over there",
    "start": "366419",
    "end": "373560"
  },
  {
    "text": "and then in this case you can also see that it has a battery inside which allowed you to save your games so",
    "start": "373560",
    "end": "380460"
  },
  {
    "text": "it had a ram chip inside as well and then the battery is used to give it a low power state so that if you turn up",
    "start": "380460",
    "end": "386940"
  },
  {
    "text": "the Game Boy it still holds that memory for you so that years later even you can still continue playing your games",
    "start": "386940",
    "end": "393660"
  },
  {
    "text": "some of the most advanced cartridges even had a real-time clock inside which",
    "start": "393660",
    "end": "398699"
  },
  {
    "text": "used the battery as well so that your Pokemon could evolve even if the Game Boy was offline well shut down",
    "start": "398699",
    "end": "407539"
  },
  {
    "text": "now this is about the hardware so the games if you're going to emulate those we're",
    "start": "408419",
    "end": "414660"
  },
  {
    "text": "just gonna download a ROM you're not supposed to do",
    "start": "414660",
    "end": "419940"
  },
  {
    "text": "that so what you can do instead because I want to make sure that",
    "start": "419940",
    "end": "425220"
  },
  {
    "text": "Nintendo is happy with me you get the cartridge",
    "start": "425220",
    "end": "430979"
  },
  {
    "text": "like this and you get magic do that",
    "start": "430979",
    "end": "436919"
  },
  {
    "text": "like this and then you can plug this device in this even has a USBC",
    "start": "436919",
    "end": "443819"
  },
  {
    "text": "connection and then you can dump this cartridge onto your system that's the legal way of emulating games",
    "start": "443819",
    "end": "451620"
  },
  {
    "text": "but I'm sure you can find other ways as well",
    "start": "451620",
    "end": "455840"
  },
  {
    "text": "um so we have our games now we have to build our system",
    "start": "458039",
    "end": "464160"
  },
  {
    "text": "and let's start by building the most important part of our system which is the CPU",
    "start": "464160",
    "end": "470039"
  },
  {
    "text": "and the CPU is the sm83 and it's heavily based on a chip from 1974. which was way",
    "start": "470039",
    "end": "478560"
  },
  {
    "text": "back before the game boy also released because the Game Boy only came out in 1989",
    "start": "478560",
    "end": "484199"
  },
  {
    "text": "and it was based heavily on the Intel 8080 CPU which was well known at the",
    "start": "484199",
    "end": "490560"
  },
  {
    "text": "time everyone every developer knew this CPU could program against it mostly in",
    "start": "490560",
    "end": "496259"
  },
  {
    "text": "assembly but they knew how it works and then a little bit later in 1976.",
    "start": "496259",
    "end": "505979"
  },
  {
    "text": "the xylog z80 was released and if you remember if you were there at the time I",
    "start": "506460",
    "end": "511680"
  },
  {
    "text": "wasn't um I'm not that old um then",
    "start": "511680",
    "end": "516959"
  },
  {
    "text": "um that chip was really really popular because it actually took the Intel 8080",
    "start": "516959",
    "end": "522360"
  },
  {
    "text": "and it added another set of CPU registers basically doubling the power of this of",
    "start": "522360",
    "end": "528420"
  },
  {
    "text": "the thing while being completely backwards compatible with the Intel 8080 so every",
    "start": "528420",
    "end": "534360"
  },
  {
    "text": "developer back then could program immediately for this CPU as well and",
    "start": "534360",
    "end": "539519"
  },
  {
    "text": "then learn how to improve their knowledge at the same time the CPU was so so popular that it was",
    "start": "539519",
    "end": "547560"
  },
  {
    "text": "actually used in things like Roland Jupiter 8 synthesizers and also the",
    "start": "547560",
    "end": "553080"
  },
  {
    "text": "Pac-Man arcade cabinets so really really popular CPU at the time and very",
    "start": "553080",
    "end": "558720"
  },
  {
    "text": "powerful so this should have been a perfect candidate for our Game Boy",
    "start": "558720",
    "end": "566240"
  },
  {
    "text": "so Nintendo decided to contact sharp to make something else again",
    "start": "566279",
    "end": "572339"
  },
  {
    "text": "heavily based on both the Intel 8080 and the xylock set 80. but also a little bit",
    "start": "572339",
    "end": "578459"
  },
  {
    "text": "different why is it different because this one has only the registers",
    "start": "578459",
    "end": "585480"
  },
  {
    "text": "from the Intel 8080 it doesn't have the double set of registers to keep the costs down",
    "start": "585480",
    "end": "591540"
  },
  {
    "text": "but Nintendo and sharp said there are some really really good instructions",
    "start": "591540",
    "end": "597120"
  },
  {
    "text": "available in the z80 that the Intel 8080 just doesn't have so let's borrow these",
    "start": "597120",
    "end": "602220"
  },
  {
    "text": "instructions as well and then they added some extra instructions that doesn't exist in the",
    "start": "602220",
    "end": "608220"
  },
  {
    "text": "original CPUs mostly for looping inside High memory",
    "start": "608220",
    "end": "614700"
  },
  {
    "text": "now when I talk about these registers these are the ones that we have so it's",
    "start": "614700",
    "end": "620399"
  },
  {
    "text": "not a lot to work with and these days we have a lot more registers these are all only 8 bit wide so you can store numbers",
    "start": "620399",
    "end": "628680"
  },
  {
    "text": "in these ranging from zero to 255 or -128 to 127",
    "start": "628680",
    "end": "634980"
  },
  {
    "text": "and you have the a register the accumulator one the F for flags and then",
    "start": "634980",
    "end": "641100"
  },
  {
    "text": "we have b c d e for General data or addresses HL mostly used for addresses",
    "start": "641100",
    "end": "648600"
  },
  {
    "text": "and of course a program counter which points to the next instruction that the CPU is going to execute and a",
    "start": "648600",
    "end": "656459"
  },
  {
    "text": "stack pointer to point to the stack space in memory and for Flags",
    "start": "656459",
    "end": "662640"
  },
  {
    "text": "those are typically used if you don't know to keep track of State in the CPU",
    "start": "662640",
    "end": "667800"
  },
  {
    "text": "while performing instructions and in this case we only have actually Four Flags which is also not a lot",
    "start": "667800",
    "end": "673440"
  },
  {
    "text": "compared to other CPUs but the most important ones are there called the the",
    "start": "673440",
    "end": "679740"
  },
  {
    "text": "Z the zero flag which is set to one whenever an operation results in a zero result",
    "start": "679740",
    "end": "687660"
  },
  {
    "text": "typically used as a precondition to jump after comparison comparison",
    "start": "687660",
    "end": "693600"
  },
  {
    "text": "we have the N flag which is the called the negative flag",
    "start": "693600",
    "end": "698760"
  },
  {
    "text": "but you might think it's going to be set when something becomes negative but in this case it's actually being set if you",
    "start": "698760",
    "end": "705420"
  },
  {
    "text": "perform a negative instruction like a decrement or a subtraction so it's a bit different",
    "start": "705420",
    "end": "710880"
  },
  {
    "text": "and then we also have H and which is a half carry flag used for a decimal",
    "start": "710880",
    "end": "717600"
  },
  {
    "text": "addition which is a pain to emulate and then the carry flag if you go over your",
    "start": "717600",
    "end": "723899"
  },
  {
    "text": "8-bit values then you have to set the carrier flag as well because your result became larger than 255.",
    "start": "723899",
    "end": "730860"
  },
  {
    "text": "okay these are the basics for our CPU then let's see how can we get something",
    "start": "730860",
    "end": "738060"
  },
  {
    "text": "on the screen so the picture processing units is",
    "start": "738060",
    "end": "743279"
  },
  {
    "text": "heavily based on the one that they used in this device the Nintendo Entertainment System",
    "start": "743279",
    "end": "748920"
  },
  {
    "text": "because huge popular console in both Japan America and Europe so they know",
    "start": "748920",
    "end": "755640"
  },
  {
    "text": "how this works and said let's use that one as well that system in the Game Boy",
    "start": "755640",
    "end": "760860"
  },
  {
    "text": "as well and when they put it in the game boy because they don't have that much power",
    "start": "760860",
    "end": "767519"
  },
  {
    "text": "to work with and it also needs to run on four batteries instead of on AC power",
    "start": "767519",
    "end": "772800"
  },
  {
    "text": "they only they had to limit the capabilities of the picture processing units which results in only having four",
    "start": "772800",
    "end": "779220"
  },
  {
    "text": "Shades of Gray but because the screen is a green original originally a greenish LCD you",
    "start": "779220",
    "end": "787500"
  },
  {
    "text": "get these lovely shades of green instead and then whenever you want to put",
    "start": "787500",
    "end": "793019"
  },
  {
    "text": "something on the screen everything that you want to show has to be organized in little tiles that are",
    "start": "793019",
    "end": "800040"
  },
  {
    "text": "eight by eight pixels in size and everything also needs to fit in the memory in that eight kilobytes of memory",
    "start": "800040",
    "end": "806040"
  },
  {
    "text": "if you go over it won't show up on the screen and here you can see an example",
    "start": "806040",
    "end": "812579"
  },
  {
    "text": "of the tile set for a particular game and anyone has a",
    "start": "812579",
    "end": "817920"
  },
  {
    "text": "clue which game this is",
    "start": "817920",
    "end": "821300"
  },
  {
    "text": "three yeah it is Tetris you can",
    "start": "823440",
    "end": "828540"
  },
  {
    "text": "kind of make out the the parts of those dancing people at the end",
    "start": "828540",
    "end": "833579"
  },
  {
    "text": "if you've never seen the dancing people you ended up a Finnish Tetris",
    "start": "833579",
    "end": "838519"
  },
  {
    "text": "um and you can see here as well if you want to show if you want to display text",
    "start": "838680",
    "end": "844320"
  },
  {
    "text": "on the Game Boy you have to include your own fonts so there's no funds inside you have to do everything yourself",
    "start": "844320",
    "end": "851339"
  },
  {
    "text": "so that's one our tiles but then how do we get something on the screen and that happens in different",
    "start": "851339",
    "end": "857760"
  },
  {
    "text": "layers so we have a background layer where which is 256 pixels large in in",
    "start": "857760",
    "end": "866639"
  },
  {
    "text": "square which is 32 tiles and we can only show",
    "start": "866639",
    "end": "872760"
  },
  {
    "text": "on our LCD 166 by 144 so our background is larger than we can display",
    "start": "872760",
    "end": "878880"
  },
  {
    "text": "so what we do we set a viewport using two registers the screen registers",
    "start": "878880",
    "end": "885540"
  },
  {
    "text": "we can say we want to only display a part of that big background map",
    "start": "885540",
    "end": "891600"
  },
  {
    "text": "and that results then in the screen that we see on the right",
    "start": "891600",
    "end": "896720"
  },
  {
    "text": "and then you can see there's a a white area at the bottom and in this case in",
    "start": "896720",
    "end": "902940"
  },
  {
    "text": "this game Super Mario Land 2 that's used to fill in with status effects so",
    "start": "902940",
    "end": "909899"
  },
  {
    "text": "this is called the window layer typically used to get status on the screen like number of",
    "start": "909899",
    "end": "916680"
  },
  {
    "text": "lives remaining in this case you can also see the amount of coins that you gathered amount of enemies that you've",
    "start": "916680",
    "end": "923579"
  },
  {
    "text": "vanquished and then the amount of time left in the level in some games like tennis the windows",
    "start": "923579",
    "end": "929100"
  },
  {
    "text": "layer was used window layer was used to pop up Mario in the top of the screen",
    "start": "929100",
    "end": "935339"
  },
  {
    "text": "saying that you went out of bounds or when it's dues then Mario popped up inside juice",
    "start": "935339",
    "end": "942800"
  },
  {
    "text": "but with these two layers alone it's not going to be a very fun game because nothing's moving",
    "start": "943339",
    "end": "949440"
  },
  {
    "text": "in the next slide nothing's moving as well because I didn't include a video but we'll get to that later",
    "start": "949440",
    "end": "955199"
  },
  {
    "text": "but we have to add some Sprites as well because Sprites are the thing things that move around on the screen",
    "start": "955199",
    "end": "962399"
  },
  {
    "text": "um and these can only have three colors",
    "start": "962399",
    "end": "968279"
  },
  {
    "text": "instead of four because the fourth one is transparent and you can only display up to 40",
    "start": "968279",
    "end": "974339"
  },
  {
    "text": "Sprites in the entire screen at the same time and of those 40 you can only have 10 on",
    "start": "974339",
    "end": "980760"
  },
  {
    "text": "One scan line and a scan line is one pixel in Heights so it could happen if",
    "start": "980760",
    "end": "985920"
  },
  {
    "text": "you have a very busy game that you get some flickering effects because there's too many going on too many things going",
    "start": "985920",
    "end": "991680"
  },
  {
    "text": "on with the same line um so a lot of times they just decided if there's nine",
    "start": "991680",
    "end": "997440"
  },
  {
    "text": "items on a certain area then they don't draw the 10th one",
    "start": "997440",
    "end": "1003880"
  },
  {
    "text": "what also happens typically is if you see in this game for example the coins",
    "start": "1004040",
    "end": "1009980"
  },
  {
    "text": "that you can pick up as Mario are not Sprites because if you have a lot of coins to to",
    "start": "1009980",
    "end": "1016519"
  },
  {
    "text": "pick up it would have a heavy impact on the number of enemies that you can also display at the same time so coins in",
    "start": "1016519",
    "end": "1022940"
  },
  {
    "text": "this case are typically part of the background layer and then once you hit them the background layer gets updated",
    "start": "1022940",
    "end": "1029000"
  },
  {
    "text": "so that that coin is removed it's a neat little trick that you had to",
    "start": "1029000",
    "end": "1034100"
  },
  {
    "text": "do as a developer to get stuff working on this thing that's our picture processing unit",
    "start": "1034100",
    "end": "1041360"
  },
  {
    "text": "let's now see what we can do audio wise",
    "start": "1041360",
    "end": "1047319"
  },
  {
    "text": "so as I mentioned we have four channels the first two are similar so the first",
    "start": "1047720",
    "end": "1054260"
  },
  {
    "text": "two are pulse wave channels and they do the typical old computer sounds",
    "start": "1054260",
    "end": "1060799"
  },
  {
    "text": "um and the first channel of these is typically used for special effects so if you pick up a coin or something that one",
    "start": "1060799",
    "end": "1067640"
  },
  {
    "text": "gets used to play that coin sound which also means that your music is going to be a little bit different",
    "start": "1067640",
    "end": "1072860"
  },
  {
    "text": "because you're missing one of the channels um the reason why the first one is used",
    "start": "1072860",
    "end": "1078440"
  },
  {
    "text": "for sound effects is because it also is the only Channel that's capable of producing more sweep like effects to get",
    "start": "1078440",
    "end": "1087140"
  },
  {
    "text": "like phaser shots or space sound effects things",
    "start": "1087140",
    "end": "1092260"
  },
  {
    "text": "um now if we have a listen to one of these",
    "start": "1092480",
    "end": "1097960"
  },
  {
    "text": "if it wants [Music] this is what it sounds like",
    "start": "1099440",
    "end": "1106740"
  },
  {
    "text": "[Music] the next channel is the noise Channel",
    "start": "1106740",
    "end": "1115360"
  },
  {
    "text": "and noise channel is if you have a very old television set and you have no cable",
    "start": "1115760",
    "end": "1121940"
  },
  {
    "text": "connection to it or the antenna failed or something you get like this nice snowy screen and then it was like a",
    "start": "1121940",
    "end": "1129260"
  },
  {
    "text": "oh effect for people on YouTube that was me not your connection failing and this",
    "start": "1129260",
    "end": "1138260"
  },
  {
    "text": "channel this noise effect channel is typically used for percussion or",
    "start": "1138260",
    "end": "1143600"
  },
  {
    "text": "explosion effects in this case we get a nice March drum",
    "start": "1143600",
    "end": "1149120"
  },
  {
    "text": "well knife we have to do we had to use whatever we could use to",
    "start": "1149120",
    "end": "1155720"
  },
  {
    "text": "make some sound out of this and then the fourth channel is a wave Channel and this one is a bit special",
    "start": "1155720",
    "end": "1162500"
  },
  {
    "text": "because if I talk about waveforms as a from a music producer point of view",
    "start": "1162500",
    "end": "1169580"
  },
  {
    "text": "think of this as the Sawtooth the square wave triangle wave things you can also",
    "start": "1169580",
    "end": "1175460"
  },
  {
    "text": "just draw yourself and then reuse to form some music",
    "start": "1175460",
    "end": "1180919"
  },
  {
    "text": "some people went really far with this and actually created voice samples which is on the Game Boy as well I think you",
    "start": "1180919",
    "end": "1186919"
  },
  {
    "text": "can again heavily used in Pokemon for Pikachu for example in this case it's",
    "start": "1186919",
    "end": "1193460"
  },
  {
    "text": "more like a buzzy sound that you're getting",
    "start": "1193460",
    "end": "1197860"
  },
  {
    "text": "and then if you combine the four channels together you get a lovely sound",
    "start": "1200500",
    "end": "1208659"
  },
  {
    "text": "[Music]",
    "start": "1209560",
    "end": "1215179"
  },
  {
    "text": "and some of you might know this music as well from Pokemon",
    "start": "1215179",
    "end": "1220600"
  },
  {
    "text": "okay so we have our CPU we have our picture processing unit and our audio",
    "start": "1221179",
    "end": "1226460"
  },
  {
    "text": "processing unit but these things need to work together and in modern CPUs we have like",
    "start": "1226460",
    "end": "1234860"
  },
  {
    "text": "interrupts and I O ports so you can easily say to your video card hey you",
    "start": "1234860",
    "end": "1240860"
  },
  {
    "text": "need to do this or to your send card you have to play this but the game mode is a very simple system",
    "start": "1240860",
    "end": "1247100"
  },
  {
    "text": "which uses memory mapped i o which means that in that address space of 64",
    "start": "1247100",
    "end": "1253940"
  },
  {
    "text": "kilobytes because it has a 16 bit address bus it has to be able to address everything",
    "start": "1253940",
    "end": "1260120"
  },
  {
    "text": "which means in this case our first 16 kilobytes typically points to the ROM",
    "start": "1260120",
    "end": "1266179"
  },
  {
    "text": "Bank zero of your game cartridge and the next Bank next 16 kilobytes goes to bank",
    "start": "1266179",
    "end": "1273200"
  },
  {
    "text": "one up to FF or 255 using that controller switch",
    "start": "1273200",
    "end": "1279140"
  },
  {
    "text": "then we get the address space for our video ramp external RAM which lives on the",
    "start": "1279140",
    "end": "1285980"
  },
  {
    "text": "cartridge so that's holding your saves and then the work memory as well then there's a section called Echo Ram",
    "start": "1285980",
    "end": "1292760"
  },
  {
    "text": "which is a bit special it was actually not used but because how the hardware is created it maps to other spaces of the",
    "start": "1292760",
    "end": "1300620"
  },
  {
    "text": "Game Boy hardware and it copies well it doesn't copy but it if you address that memory space you actually get data from",
    "start": "1300620",
    "end": "1306740"
  },
  {
    "text": "another address space it's not supposed to be used but people",
    "start": "1306740",
    "end": "1312679"
  },
  {
    "text": "actually use it anyway and sometimes it results in a crash and and the final green bar",
    "start": "1312679",
    "end": "1321140"
  },
  {
    "text": "if we zoom in what's in there that holds our Sprite table or object attribute map",
    "start": "1321140",
    "end": "1329299"
  },
  {
    "text": "the i o registers to interact with the serial port to interact with the joystick on the device and to interact",
    "start": "1329299",
    "end": "1335720"
  },
  {
    "text": "with the video and the APU and then we also have something called",
    "start": "1335720",
    "end": "1342559"
  },
  {
    "text": "hyram which I will talk about later as well and finally but not least the",
    "start": "1342559",
    "end": "1348500"
  },
  {
    "text": "interrupt enable register because if you don't enable your interrupts nothing will happen",
    "start": "1348500",
    "end": "1354640"
  },
  {
    "text": "okay we also know how to interact with this thing now if you fire up the Game Boy the",
    "start": "1354860",
    "end": "1361580"
  },
  {
    "text": "first thing that will run is that boot run and the boot ROM looks like this",
    "start": "1361580",
    "end": "1367940"
  },
  {
    "text": "it's a bit small but don't worry I'll guide you through what happens here and this is the actual original sorry",
    "start": "1367940",
    "end": "1374840"
  },
  {
    "text": "Nintendo source code for the assembly in the boot ROM it still amazes me how the community was",
    "start": "1374840",
    "end": "1383000"
  },
  {
    "text": "able to get this source code it's a story that I've been uh told I",
    "start": "1383000",
    "end": "1388940"
  },
  {
    "text": "would like to believe it because it's so awesome someone opened up their Game Boy it didn't work anymore I hope",
    "start": "1388940",
    "end": "1396140"
  },
  {
    "text": "and they desoldered the DMG CPU took off the plastic cover until they",
    "start": "1396140",
    "end": "1402740"
  },
  {
    "text": "saw the actual die of the CPU zoomed in with a microscope and then somehow",
    "start": "1402740",
    "end": "1408760"
  },
  {
    "text": "decided that must be the boot room and that must be a one and that must be",
    "start": "1408760",
    "end": "1414140"
  },
  {
    "text": "a zero and 256 times later this came out",
    "start": "1414140",
    "end": "1421240"
  },
  {
    "text": "some people do have way too much time on their hands but here we are we have the source code which is nice",
    "start": "1422059",
    "end": "1429140"
  },
  {
    "text": "now what happens is whenever you turn on the Game Boy the first thing that we'll run is a little loop at the top to empty",
    "start": "1429140",
    "end": "1437600"
  },
  {
    "text": "your memory address space it will also set the stack pointer to the first position",
    "start": "1437600",
    "end": "1444140"
  },
  {
    "text": "and then we have to initialize the sound registers because at some point what we're going",
    "start": "1444140",
    "end": "1450740"
  },
  {
    "text": "to do actually is we're going to scroll down the Nintendo logo and then when it's at the middle of the screen you get",
    "start": "1450740",
    "end": "1457700"
  },
  {
    "text": "that two times the bidding sound",
    "start": "1457700",
    "end": "1462940"
  },
  {
    "text": "so we also have to set up that Nintendo logo and that's actually stored here",
    "start": "1463460",
    "end": "1472960"
  },
  {
    "text": "the Nintendo logo so we also have to decode it first because",
    "start": "1473659",
    "end": "1480940"
  },
  {
    "text": "while it's stored over there it's also stored in your cartridge",
    "start": "1480980",
    "end": "1487419"
  },
  {
    "text": "more about that in a second so we're scrolling down that logo all",
    "start": "1488120",
    "end": "1494240"
  },
  {
    "text": "the way to the middle of the screen and then you'll see that there's a gap between the scrolling because right",
    "start": "1494240",
    "end": "1500240"
  },
  {
    "text": "before we hit that end of the screen we're playing those two sounds",
    "start": "1500240",
    "end": "1506799"
  },
  {
    "text": "and then again here's the Nintendo logo and we have to compare it with the logo",
    "start": "1506960",
    "end": "1512960"
  },
  {
    "text": "that's stored on your cartridge because what happens if you decide to",
    "start": "1512960",
    "end": "1518299"
  },
  {
    "text": "not pay Nintendo a license and you want to build games you're legally not allowed then in that",
    "start": "1518299",
    "end": "1525020"
  },
  {
    "text": "case to use their logo and if you don't use their logo your game will stop",
    "start": "1525020",
    "end": "1531980"
  },
  {
    "text": "it will not work your Nintendo logo will actually stop running here and will end",
    "start": "1531980",
    "end": "1539419"
  },
  {
    "text": "up in a loop so that your game never starts",
    "start": "1539419",
    "end": "1544000"
  },
  {
    "text": "so you have to pay Nintendo license include the logo on your cartridge and if it matches exactly that the bootstrom",
    "start": "1544700",
    "end": "1552260"
  },
  {
    "text": "has stored as well then it will continue it does also a little",
    "start": "1552260",
    "end": "1558380"
  },
  {
    "text": "checksum calculation at the end just to make sure that the cartridge is fully inserted so that you don't get cardboard",
    "start": "1558380",
    "end": "1563779"
  },
  {
    "text": "data later and a very bad game experience and then the final step here is to disable the boot room and then it",
    "start": "1563779",
    "end": "1571580"
  },
  {
    "text": "will switch that first 256 bytes with the actual cartridge contents and start up your game",
    "start": "1571580",
    "end": "1578960"
  },
  {
    "text": "all right we know enough of the hardware let's start actually okay",
    "start": "1578960",
    "end": "1586580"
  },
  {
    "text": "some things decided to pop up my screen fine let's start emulating the game boy",
    "start": "1586580",
    "end": "1593419"
  },
  {
    "text": "and when you emulate a system any system you typically start with the CPU",
    "start": "1593419",
    "end": "1599360"
  },
  {
    "text": "which means that we have to look for some information about the CPU and the instruction set of that CPU",
    "start": "1599360",
    "end": "1605600"
  },
  {
    "text": "and there's a nice person who put a nice graphical table on the internet containing all of the different",
    "start": "1605600",
    "end": "1612640"
  },
  {
    "text": "instructions and what they mean and what they need um but I noticed something on that web",
    "start": "1612640",
    "end": "1618860"
  },
  {
    "text": "page it has Json",
    "start": "1618860",
    "end": "1624260"
  },
  {
    "text": "so what's inside of the Json file well it has a list of op codes in this",
    "start": "1624260",
    "end": "1630799"
  },
  {
    "text": "case we have the zero X10 opcode and it also has the the name of that opcode in",
    "start": "1630799",
    "end": "1638659"
  },
  {
    "text": "this case it's the stop instruction It also says it's two bytes long which",
    "start": "1638659",
    "end": "1644059"
  },
  {
    "text": "takes four Cycles it has one upper end it's an immediate instruction and so on and so forth",
    "start": "1644059",
    "end": "1650179"
  },
  {
    "text": "now with all these instructions we can then build a system that reads",
    "start": "1650179",
    "end": "1655340"
  },
  {
    "text": "this Json file translates it into runnable code and then use that to",
    "start": "1655340",
    "end": "1661279"
  },
  {
    "text": "emulate our CPU oh and by the way the stop instruction is a bit special it actually halts your",
    "start": "1661279",
    "end": "1668659"
  },
  {
    "text": "program completely doesn't run anything it's used to preserve power and then it",
    "start": "1668659",
    "end": "1674779"
  },
  {
    "text": "starts again your CPU whenever it receives input so you can basically use",
    "start": "1674779",
    "end": "1679880"
  },
  {
    "text": "this whenever you're pausing the game and then if you press start again then it will continue and then start running",
    "start": "1679880",
    "end": "1685700"
  },
  {
    "text": "your CPU and Meanwhile your battery is not used that heavily in the system",
    "start": "1685700",
    "end": "1692240"
  },
  {
    "text": "all right we have our op codes we have our Json file let's start writing some code",
    "start": "1692240",
    "end": "1699260"
  },
  {
    "text": "and what is a CPU basically it's a endless loop that runs the instructions",
    "start": "1699260",
    "end": "1705260"
  },
  {
    "text": "until they are no more instructions to run or until you switch off the Game Boy",
    "start": "1705260",
    "end": "1710840"
  },
  {
    "text": "in this case our Game Boy power toggle is a cancellation token so we can just",
    "start": "1710840",
    "end": "1716779"
  },
  {
    "text": "cancel the token and then that will stop our CPU from running",
    "start": "1716779",
    "end": "1722140"
  },
  {
    "text": "um and again a CPU has a program counter which is in the beginning set to zero",
    "start": "1722960",
    "end": "1728659"
  },
  {
    "text": "first instruction and it will every time fetch the next instruction execute it",
    "start": "1728659",
    "end": "1733760"
  },
  {
    "text": "until we end somewhere",
    "start": "1733760",
    "end": "1738580"
  },
  {
    "text": "and what else is this execution thing doing well it's basically a gigantic list of",
    "start": "1740299",
    "end": "1748580"
  },
  {
    "text": "switch statements at least in my first version of the code",
    "start": "1748580",
    "end": "1753740"
  },
  {
    "text": "where you look at that name of the instruction for example the no operation",
    "start": "1753740",
    "end": "1759260"
  },
  {
    "text": "the stop halts disable interrupt enable interrupt in this case you can see not a lot was",
    "start": "1759260",
    "end": "1766159"
  },
  {
    "text": "implemented yet these are placeholders but let's dive into some of the",
    "start": "1766159",
    "end": "1772640"
  },
  {
    "text": "instructions that I did implement but before I do so note one thing here",
    "start": "1772640",
    "end": "1777799"
  },
  {
    "text": "um the nice if debug Intrigue because I still had no video output I still had",
    "start": "1777799",
    "end": "1785120"
  },
  {
    "text": "no sound output I just set the CPU and I needed to be able to see how it went so",
    "start": "1785120",
    "end": "1791539"
  },
  {
    "text": "I I'll put it every instruction that I was about to run not the best thing to do if you're",
    "start": "1791539",
    "end": "1797480"
  },
  {
    "text": "emulating a system because this slows down the system to a crawl but for debugging purposes that works just fine",
    "start": "1797480",
    "end": "1805960"
  },
  {
    "text": "so these are the ones that I did Implement at that stage mainly the load",
    "start": "1806000",
    "end": "1811460"
  },
  {
    "text": "instructions because you have to get data from the cartridge in memory or data from memory into another register",
    "start": "1811460",
    "end": "1818960"
  },
  {
    "text": "you have to be able to add data together to subtract data to compare and some",
    "start": "1818960",
    "end": "1826940"
  },
  {
    "text": "stuff like that and then if you look for example at the load instruction",
    "start": "1826940",
    "end": "1832100"
  },
  {
    "text": "I was very very happy with my comments back then and then I have a load instruction does",
    "start": "1832100",
    "end": "1839360"
  },
  {
    "text": "nothing more than decide which is the source of data which is the target of",
    "start": "1839360",
    "end": "1844399"
  },
  {
    "text": "the data and then move source to Target that's it because we're really working on the",
    "start": "1844399",
    "end": "1850159"
  },
  {
    "text": "hardware level here it's typically very basic stuff that we're doing and then in some cases you also have to",
    "start": "1850159",
    "end": "1856820"
  },
  {
    "text": "update your flags so this was already quite an effort to",
    "start": "1856820",
    "end": "1863899"
  },
  {
    "text": "make that work to also get to this stage um did it actually work uh",
    "start": "1863899",
    "end": "1871820"
  },
  {
    "text": "so I pressed F5 in Visual Studio and I did find the boot ROM code so I",
    "start": "1871820",
    "end": "1879559"
  },
  {
    "text": "just said look try to run this and this was my console output",
    "start": "1879559",
    "end": "1887080"
  },
  {
    "text": "it started doing something but was it doing the right thing",
    "start": "1887299",
    "end": "1892820"
  },
  {
    "text": "so if we look at the original code from the boot ROM remember the first step was",
    "start": "1892820",
    "end": "1899120"
  },
  {
    "text": "initializing the ram what we are doing here is you can see on",
    "start": "1899120",
    "end": "1904640"
  },
  {
    "text": "the left is the console output so we're actually doing exactly the same instruction loading the stack pointer with the",
    "start": "1904640",
    "end": "1912140"
  },
  {
    "text": "highest address so we initial initialize our stack pointer then we xor The Edge register which",
    "start": "1912140",
    "end": "1918140"
  },
  {
    "text": "means it gets a zero inside and then we load the HL register with",
    "start": "1918140",
    "end": "1924260"
  },
  {
    "text": "the top address of the memory chip here in the assembly you get a jump",
    "start": "1924260",
    "end": "1930640"
  },
  {
    "text": "label address zero zero zero seven on the left side we don't see that",
    "start": "1930640",
    "end": "1936020"
  },
  {
    "text": "because it's just executing code and you'll see you're loading that zero value in the",
    "start": "1936020",
    "end": "1943760"
  },
  {
    "text": "memory address HL which is 9ff at this moment and then it",
    "start": "1943760",
    "end": "1949640"
  },
  {
    "text": "immediately decrements HL to 9ffe that's one of those sm83 special",
    "start": "1949640",
    "end": "1956240"
  },
  {
    "text": "instructions to quickly Loop over another space it then Compares in the left part of the",
    "start": "1956240",
    "end": "1964460"
  },
  {
    "text": "HL register a certain bit to see did we reach the end of the address space that",
    "start": "1964460",
    "end": "1970039"
  },
  {
    "text": "we want to clear if not then it jumps back to the top and it keeps on",
    "start": "1970039",
    "end": "1975559"
  },
  {
    "text": "decrementing until it reaches that bottom of the memory chip",
    "start": "1975559",
    "end": "1981140"
  },
  {
    "text": "and as you can see the loop was working so it's actually doing the thing that",
    "start": "1981140",
    "end": "1987020"
  },
  {
    "text": "it's intended to do so okay we have a first success",
    "start": "1987020",
    "end": "1992059"
  },
  {
    "text": "let's move on to the graphics and",
    "start": "1992059",
    "end": "1997360"
  },
  {
    "text": "filled with enthusiasm after a few nights of work seeing that first console output as up",
    "start": "1998659",
    "end": "2005320"
  },
  {
    "text": "all right back to the hardcore manual I start reading about the picture processing unit and everything that's",
    "start": "2005320",
    "end": "2011620"
  },
  {
    "text": "related to it and then I found out that I made a very very big mistake",
    "start": "2011620",
    "end": "2017620"
  },
  {
    "text": "uh well you see I forgot about one special thing called timing",
    "start": "2017620",
    "end": "2024820"
  },
  {
    "text": "uh yeah there's timing registers there's timing interrupts there's the actual",
    "start": "2024820",
    "end": "2031779"
  },
  {
    "text": "Hardware timing that you need to emulate if you want to actually accurately emulate the device",
    "start": "2031779",
    "end": "2040360"
  },
  {
    "text": "um I'll go over this slide in a second because I forgot to mention this in the beginning I did say that the CPU runs officially",
    "start": "2040360",
    "end": "2048638"
  },
  {
    "text": "at 4.90 megahertz but these chips have special timings",
    "start": "2048639",
    "end": "2056020"
  },
  {
    "text": "and the memory chip cannot work at 4.19 megahertz it actually works four times as slow",
    "start": "2056020",
    "end": "2063580"
  },
  {
    "text": "so your CPU is banned to the speed of your memory there's a tiny crystal inside this",
    "start": "2063580",
    "end": "2070118"
  },
  {
    "text": "machine which generates pulse every one megahertz and when that pulse goes High",
    "start": "2070119",
    "end": "2076960"
  },
  {
    "text": "then some things can happen and then that pulse goes low again then it's safe to read data so this is",
    "start": "2076960",
    "end": "2084220"
  },
  {
    "text": "really on the hardware electronic level that you need to work with a Game Boy",
    "start": "2084220",
    "end": "2089260"
  },
  {
    "text": "but also need to emulate the game boy because your CPU is not going to wait on your",
    "start": "2089260",
    "end": "2096099"
  },
  {
    "text": "graphics cards in this case to say hey I've done painting continue",
    "start": "2096099",
    "end": "2101320"
  },
  {
    "text": "please in this case that pulse sends a really",
    "start": "2101320",
    "end": "2107080"
  },
  {
    "text": "opposed to all the systems and they react at this almost the same time",
    "start": "2107080",
    "end": "2112660"
  },
  {
    "text": "so when we are emulating we also need to give every system part a chance to react",
    "start": "2112660",
    "end": "2119859"
  },
  {
    "text": "and I was just thinking okay I have my CPU and at some point my screen buffer",
    "start": "2119859",
    "end": "2124960"
  },
  {
    "text": "is filled dump on the screen and go time but that's not how this thing works",
    "start": "2124960",
    "end": "2131980"
  },
  {
    "text": "because the Nintendo uh sorry the Game Boy was based on the",
    "start": "2131980",
    "end": "2138280"
  },
  {
    "text": "Nintendo the the picture processing unit which also means it was intended to work",
    "start": "2138280",
    "end": "2144220"
  },
  {
    "text": "on a crtc device an old television and how does a CRT device work",
    "start": "2144220",
    "end": "2149980"
  },
  {
    "text": "it has an electron gun that shoots electrodes electrons on the screen of",
    "start": "2149980",
    "end": "2155380"
  },
  {
    "text": "phosphorus screen which lights up the right colors and it does that by really",
    "start": "2155380",
    "end": "2160960"
  },
  {
    "text": "going line per line all the way from top to the bottom and then it goes all the way back up to the top but it is not",
    "start": "2160960",
    "end": "2168220"
  },
  {
    "text": "perfect and it will not hit your screen dimensions it will actually overshoot a",
    "start": "2168220",
    "end": "2174400"
  },
  {
    "text": "little bit first at the top then also at the left and the right sides it will not be perfect and",
    "start": "2174400",
    "end": "2181900"
  },
  {
    "text": "then at the bottom also you have like a blank area where you don't have a picture but you do have some time that",
    "start": "2181900",
    "end": "2188619"
  },
  {
    "text": "you're spending in there and these areas are called horizontal blank and vertical blank",
    "start": "2188619",
    "end": "2195160"
  },
  {
    "text": "and the game boy uses that same information to also have phases where",
    "start": "2195160",
    "end": "2202000"
  },
  {
    "text": "you do something in your GPU for example before you paint the screen",
    "start": "2202000",
    "end": "2209140"
  },
  {
    "text": "there's a face called object attribute memory search which means before I'm going to draw",
    "start": "2209140",
    "end": "2216339"
  },
  {
    "text": "this line you need to make sure that all the Sprites of that line are in the correct",
    "start": "2216339",
    "end": "2221980"
  },
  {
    "text": "place in memory and that's your face oim search then when we hit our first pixel line",
    "start": "2221980",
    "end": "2228640"
  },
  {
    "text": "actual pixel that is going to be displayed we're entering pixel transfer mode where we transfer the pixels",
    "start": "2228640",
    "end": "2234820"
  },
  {
    "text": "prepared to the screen and during this time nothing can change so you can't jump at that moment as a",
    "start": "2234820",
    "end": "2243700"
  },
  {
    "text": "character enemies can't move because they're fixed in that location and then at the end when we're done",
    "start": "2243700",
    "end": "2250540"
  },
  {
    "text": "drawing we have a face age blank called and then that can be used to update the time in",
    "start": "2250540",
    "end": "2257440"
  },
  {
    "text": "the level update the score update the sound and something else",
    "start": "2257440",
    "end": "2262859"
  },
  {
    "text": "um during these times a lot of the data and registers are locked so that you can't",
    "start": "2263560",
    "end": "2269320"
  },
  {
    "text": "change them which is why we have that high Ram the small area in the memory",
    "start": "2269320",
    "end": "2274900"
  },
  {
    "text": "map register because this is the time where you can only use high ramp to Loop over stuff",
    "start": "2274900",
    "end": "2282119"
  },
  {
    "text": "now after reading all of this information in the manual it's quite a heavy manual I",
    "start": "2282579",
    "end": "2289359"
  },
  {
    "text": "was thinking my God that's a lot of process this is really not the place where I",
    "start": "2289359",
    "end": "2296500"
  },
  {
    "text": "want to be in because I was thinking this is a fun hobby project not a one",
    "start": "2296500",
    "end": "2302079"
  },
  {
    "text": "that's going to consume months and months of my time so it's time to look for a solution",
    "start": "2302079",
    "end": "2308619"
  },
  {
    "text": "um and yeah there's not really a market for emulating a Game Boy so there's not to be not a lot to be found on stack",
    "start": "2308619",
    "end": "2314800"
  },
  {
    "text": "overflow but luckily there was this person that did the same",
    "start": "2314800",
    "end": "2320440"
  },
  {
    "text": "session David Whitney and he published his Source codes on GitHub",
    "start": "2320440",
    "end": "2326560"
  },
  {
    "text": "so I looked at the source code I found out it also mentions it's also mentioned",
    "start": "2326560",
    "end": "2332800"
  },
  {
    "text": "during his session it was based on a Java emulator basically he ported it",
    "start": "2332800",
    "end": "2338980"
  },
  {
    "text": "to.net core 3.1 so I said in that moment let's go over to.net6",
    "start": "2338980",
    "end": "2345460"
  },
  {
    "text": "because it's new and fancy and also added Sun support because David",
    "start": "2345460",
    "end": "2351700"
  },
  {
    "text": "tried some stuff didn't get it to work I took another stab at it",
    "start": "2351700",
    "end": "2357760"
  },
  {
    "text": "and somehow managed to make it work in the end a lot of things were already there but",
    "start": "2357760",
    "end": "2364900"
  },
  {
    "text": "the actual sound driver for Windows was missing and also found a little bug in one of",
    "start": "2364900",
    "end": "2370240"
  },
  {
    "text": "the channels that was already existing in the Java version and also fixed that one at the same time",
    "start": "2370240",
    "end": "2377020"
  },
  {
    "text": "and also the version that David made with Windows forms",
    "start": "2377020",
    "end": "2382720"
  },
  {
    "text": "had a little bit of a timing issue especially when you start adding sound it really slowed down the game so I",
    "start": "2382720",
    "end": "2388480"
  },
  {
    "text": "redid how the how the picture Processing Unit works on the screen in Windows forms so that it",
    "start": "2388480",
    "end": "2394720"
  },
  {
    "text": "could run a bit faster so okay",
    "start": "2394720",
    "end": "2400420"
  },
  {
    "text": "let's try to run a game and okay we get the title screen we get",
    "start": "2400420",
    "end": "2406660"
  },
  {
    "text": "sound in this case you can't hear the sound because it's a image but we got something resulting in here and",
    "start": "2406660",
    "end": "2413680"
  },
  {
    "text": "then I wanted to play Tetris I pressed start and nothing happened",
    "start": "2413680",
    "end": "2420040"
  },
  {
    "text": "so that was really strange I couldn't even move the cursor to two player nothing did anything up the sound was",
    "start": "2420040",
    "end": "2427240"
  },
  {
    "text": "playing the demo of the three started playing so the game was running fine it just didn't accept any inputs",
    "start": "2427240",
    "end": "2434760"
  },
  {
    "text": "huh that's weird how can we debug this well the first thing that you can try is",
    "start": "2434800",
    "end": "2442240"
  },
  {
    "text": "just load another game so I loaded up Super Mario Land",
    "start": "2442240",
    "end": "2447579"
  },
  {
    "text": "um again title screen I press start it started working I could play Super Mario",
    "start": "2447579",
    "end": "2452800"
  },
  {
    "text": "Land just fine so why did Tetris not work",
    "start": "2452800",
    "end": "2458500"
  },
  {
    "text": "no that means that we have to somehow set the breakpoint in our CPU to find out why it's not",
    "start": "2458500",
    "end": "2466900"
  },
  {
    "text": "really reacting the way it should but yeah this is assembly land so",
    "start": "2466900",
    "end": "2473619"
  },
  {
    "text": "that means that we're gonna have to step through a lot of up codes for example",
    "start": "2473619",
    "end": "2481060"
  },
  {
    "text": "if you look at that same simple Loop in the beginning this is clearing eight kilobytes of",
    "start": "2481060",
    "end": "2488320"
  },
  {
    "text": "memory which is 8192 memory addresses",
    "start": "2488320",
    "end": "2494200"
  },
  {
    "text": "this tiny little Loop of six instructions would already take you",
    "start": "2494200",
    "end": "2500560"
  },
  {
    "text": "um about 24 000 steps to debug yeah",
    "start": "2500560",
    "end": "2507960"
  },
  {
    "text": "that's not gonna work I'm gonna wait around for that one I'll grow a beard and trust me when I say",
    "start": "2508000",
    "end": "2514540"
  },
  {
    "text": "that I don't easily grow a beard so that's not really",
    "start": "2514540",
    "end": "2519760"
  },
  {
    "text": "how we're gonna wait how we're gonna be able to debug this game in this case you",
    "start": "2519760",
    "end": "2524920"
  },
  {
    "text": "have to rely on your knowledge really and I happen to know Tetris I used to play",
    "start": "2524920",
    "end": "2531220"
  },
  {
    "text": "that game a lot when I was a kid and I remembered if you had two game boys or a friend",
    "start": "2531220",
    "end": "2538180"
  },
  {
    "text": "with the Game Boy and if you had a friend and a Link cable and both of you had the",
    "start": "2538180",
    "end": "2544240"
  },
  {
    "text": "same game you could fire up those game boys and play Tetris against each other using",
    "start": "2544240",
    "end": "2549579"
  },
  {
    "text": "that Link cable so to know that there are two players",
    "start": "2549579",
    "end": "2554740"
  },
  {
    "text": "there must be some form of communication already happening when you start the game",
    "start": "2554740",
    "end": "2559900"
  },
  {
    "text": "to know that you can play against someone else or only can play alone",
    "start": "2559900",
    "end": "2565920"
  },
  {
    "text": "so maybe that's why Tetris doesn't work aha that's it",
    "start": "2566680",
    "end": "2573839"
  },
  {
    "text": "so again I went back to the manual and the manual has a nice flowchart",
    "start": "2574240",
    "end": "2581200"
  },
  {
    "text": "about the serial communication part oh wait that doesn't work I have to edit",
    "start": "2581200",
    "end": "2587619"
  },
  {
    "text": "this one so it actually says what happens when",
    "start": "2587619",
    "end": "2595780"
  },
  {
    "text": "you communicate with a Serial device I had another look at the code and saw that one of the registers were not being",
    "start": "2595780",
    "end": "2602560"
  },
  {
    "text": "said correctly swap some bits around and then complete address",
    "start": "2602560",
    "end": "2607960"
  },
  {
    "text": "all right cool we made it work so what's next because you never end",
    "start": "2607960",
    "end": "2613660"
  },
  {
    "text": "right well a few years after the game boy was released",
    "start": "2613660",
    "end": "2619540"
  },
  {
    "text": "the next version came out with a little bit more colors than only four so we I want to really add the Game Boy",
    "start": "2619540",
    "end": "2627160"
  },
  {
    "text": "Color support it's already partially in there but it's most of the games Crash",
    "start": "2627160",
    "end": "2632440"
  },
  {
    "text": "and you're also supposed to be able to play normal games old games in color",
    "start": "2632440",
    "end": "2637839"
  },
  {
    "text": "mode that also really doesn't work so I want to make sure that that works",
    "start": "2637839",
    "end": "2643060"
  },
  {
    "text": "and there's also there's two GitHub repositories at the",
    "start": "2643060",
    "end": "2648700"
  },
  {
    "text": "time that I made the slides one of them might be done now but some people made unit tests for the Game Boy",
    "start": "2648700",
    "end": "2655000"
  },
  {
    "text": "so there are people that made custom roms to test specific aspects of the hardware of the Game Boy to see if your",
    "start": "2655000",
    "end": "2661240"
  },
  {
    "text": "emulator emulates them well really cool and I want to make sure that all of them",
    "start": "2661240",
    "end": "2667359"
  },
  {
    "text": "run as well what I also want to do and I also already tried to but didn't get a",
    "start": "2667359",
    "end": "2674740"
  },
  {
    "text": "success yet is to make a Blazer version of this because why not make a wasm that you can",
    "start": "2674740",
    "end": "2682180"
  },
  {
    "text": "integrate your Gameboy emulator and run it everywhere would be cool um it's not there yet because I can't",
    "start": "2682180",
    "end": "2689380"
  },
  {
    "text": "make it work without threading support and in Blazer in.net6 Blazers trading",
    "start": "2689380",
    "end": "2695079"
  },
  {
    "text": "support was not a thing it's supposed to be added in.net7 I didn't have a look at might take a stab",
    "start": "2695079",
    "end": "2701980"
  },
  {
    "text": "later today who knows but um I have 15 minutes left and I didn't",
    "start": "2701980",
    "end": "2709119"
  },
  {
    "text": "show you the emulator which is a shame so it's time to actually look at the damn thing",
    "start": "2709119",
    "end": "2715300"
  },
  {
    "text": "and show you that it works and we have",
    "start": "2715300",
    "end": "2720460"
  },
  {
    "text": "Visual Studio I press Ctrl F5 and let's open up a",
    "start": "2720460",
    "end": "2727060"
  },
  {
    "text": "classic this is also something you're not supposed to do",
    "start": "2727060",
    "end": "2733780"
  },
  {
    "text": "you're not supposed to show the Nintendo logo but because that means you're emulating Nintendo's copyrighted",
    "start": "2733780",
    "end": "2740260"
  },
  {
    "text": "software could be a little bit late to ask but is there someone from Nintendo in the room",
    "start": "2740260",
    "end": "2748140"
  },
  {
    "text": "okay cool and you see your video might be pulled from YouTube after this one uh",
    "start": "2748359",
    "end": "2754119"
  },
  {
    "text": "we'll see how that happens but you can just play the game",
    "start": "2754119",
    "end": "2760260"
  },
  {
    "text": "and you can watch me play Super Mario foreign",
    "start": "2763859",
    "end": "2770400"
  },
  {
    "text": "because it's an emulator you can play around with the sound as well let me actually first",
    "start": "2770400",
    "end": "2776079"
  },
  {
    "text": "go back to the Overworld so that's a bit more fun you can",
    "start": "2776079",
    "end": "2783000"
  },
  {
    "text": "disable some of the channels so that it sounds",
    "start": "2783000",
    "end": "2788800"
  },
  {
    "text": "you can now find out how the Sound Works and then you know you have the drum sample and the bass is away from it",
    "start": "2788800",
    "end": "2797200"
  },
  {
    "text": "and then you can turn them back on all right come on",
    "start": "2797200",
    "end": "2803020"
  },
  {
    "text": "[Music] voila there we go we have our film music",
    "start": "2803020",
    "end": "2810040"
  },
  {
    "text": "I am going to disable that boost one for now because I want to run one more game",
    "start": "2810040",
    "end": "2816000"
  },
  {
    "text": "which is a very special game it's the NDC London game not not really a game it's just big Ben",
    "start": "2816160",
    "end": "2824140"
  },
  {
    "text": "and The Clash playing long and calling",
    "start": "2824140",
    "end": "2828779"
  },
  {
    "text": "if there depends from The Clash I do apologize it's only an 8-bit version of the song",
    "start": "2829680",
    "end": "2836020"
  },
  {
    "text": "I have to do I can only do so much with 8-bits uh but I just wanted to show there's",
    "start": "2836020",
    "end": "2842740"
  },
  {
    "text": "there's still a very active Community around the Game Boy um playing well playing around with",
    "start": "2842740",
    "end": "2849520"
  },
  {
    "text": "making their own games there's even someone who created a Unity like Studio",
    "start": "2849520",
    "end": "2855040"
  },
  {
    "text": "where you can build games with uh code elements like in scratch if you know",
    "start": "2855040",
    "end": "2861099"
  },
  {
    "text": "scratch you can easily script your game very cool it also outputs the original well",
    "start": "2861099",
    "end": "2867160"
  },
  {
    "text": "original it outputs a c version so you can go further and see if you want to and there's also like a Tracker music",
    "start": "2867160",
    "end": "2875140"
  },
  {
    "text": "software which you can use to make music for the Game Boy which is what I used to make this uh music as well",
    "start": "2875140",
    "end": "2883540"
  },
  {
    "text": "this is actually also Community using the Gameboy itself with something called little sound DJ a game for the Game Boy",
    "start": "2883540",
    "end": "2890680"
  },
  {
    "text": "and then going live on stage DJing and playing music from The Game Boy which is",
    "start": "2890680",
    "end": "2896560"
  },
  {
    "text": "awesome um but I also still have some time so I",
    "start": "2896560",
    "end": "2901839"
  },
  {
    "text": "can dive into the code a little bit let me zoom in just a pad here",
    "start": "2901839",
    "end": "2909099"
  },
  {
    "text": "so this is the main Loop of the Game Boy when you fire it up you still have that",
    "start": "2909099",
    "end": "2914500"
  },
  {
    "text": "cancellation token which is going to keep on running until you switch off the game or start a new ROM",
    "start": "2914500",
    "end": "2920859"
  },
  {
    "text": "and then every time you go through the loop you do a",
    "start": "2920859",
    "end": "2927520"
  },
  {
    "text": "tick which is that Crystal generating a pulse to all the systems inside the hardware",
    "start": "2927520",
    "end": "2934839"
  },
  {
    "text": "and then after a tick happens you might need to enable or disable the screen and in oh sorry that was a bit too much",
    "start": "2934839",
    "end": "2942160"
  },
  {
    "text": "and inside that tick what what happens is well no it's a bit small",
    "start": "2942160",
    "end": "2949480"
  },
  {
    "text": "there we go you either do high dma transfer or you do a CPU event",
    "start": "2949480",
    "end": "2957160"
  },
  {
    "text": "then you update your timer you update your other direct memory access you",
    "start": "2957160",
    "end": "2962859"
  },
  {
    "text": "update your sound you update your zero port and you update your screen so everything gets a chance to run",
    "start": "2962859",
    "end": "2968740"
  },
  {
    "text": "that's really important what's also important which is also a big mistake that I made in the first time",
    "start": "2968740",
    "end": "2975040"
  },
  {
    "text": "if your CPU gets the chance to perform something which is What's Happening Here",
    "start": "2975040",
    "end": "2982300"
  },
  {
    "text": "that doesn't necessarily mean that it will my first version did this",
    "start": "2982300",
    "end": "2989020"
  },
  {
    "text": "I read an instruction that instruction might need other data and even more data so I read this this",
    "start": "2989020",
    "end": "2996160"
  },
  {
    "text": "this and this execute the instruction and then my CPU tick was done",
    "start": "2996160",
    "end": "3002160"
  },
  {
    "text": "wrong completely wrong what you need to do is if you access memory",
    "start": "3002160",
    "end": "3009240"
  },
  {
    "text": "that means that you had to wait on the clock or the tick rather to go up or down",
    "start": "3009240",
    "end": "3015859"
  },
  {
    "text": "because you need to wait until it's safe to read that actual memory which means then you need to give the",
    "start": "3015859",
    "end": "3022140"
  },
  {
    "text": "rest of the system a chance to run before you can do the next step which might be fetching another piece of",
    "start": "3022140",
    "end": "3027240"
  },
  {
    "text": "memory waiting again and then you can execute the actual instruction so it's a bit more elaborate to make it",
    "start": "3027240",
    "end": "3034560"
  },
  {
    "text": "really really work but uh in this case it is keeping track of all",
    "start": "3034560",
    "end": "3041640"
  },
  {
    "text": "of this also a little experiment to see which one is faster is it the for Loop",
    "start": "3041640",
    "end": "3047339"
  },
  {
    "text": "or is it the while true doesn't really matter because it's compiled down to the same thing",
    "start": "3047339",
    "end": "3055040"
  },
  {
    "text": "but here you can see it's fetching the up codes and then fetching in some cases two up",
    "start": "3055200",
    "end": "3062099"
  },
  {
    "text": "codes fetching the operands and then only then it's running the actual instruction",
    "start": "3062099",
    "end": "3068579"
  },
  {
    "text": "and I must say the original source code from the Java version",
    "start": "3068579",
    "end": "3074099"
  },
  {
    "text": "was pretty well structured because it basically adds all of the instructions",
    "start": "3074099",
    "end": "3081420"
  },
  {
    "text": "for example you get here register a load command which is a one of the LD instructions and then you get two",
    "start": "3081420",
    "end": "3087839"
  },
  {
    "text": "operands or you get a jump or you get an ad and then",
    "start": "3087839",
    "end": "3093960"
  },
  {
    "text": "it's really really nicely structured so that it all ties in together and you get",
    "start": "3093960",
    "end": "3099480"
  },
  {
    "text": "small pieces that you can understand how they work together which is really cool",
    "start": "3099480",
    "end": "3105200"
  },
  {
    "text": "and then your GPU again has those state where you go",
    "start": "3106500",
    "end": "3111660"
  },
  {
    "text": "OEM search pixel trans wait I have to do this you push all the way around OEM search pixel",
    "start": "3111660",
    "end": "3117839"
  },
  {
    "text": "transfer and then age blank and then at the bottom get V blank so you have those modes here as well",
    "start": "3117839",
    "end": "3125760"
  },
  {
    "text": "and then you start executing where is it here",
    "start": "3125760",
    "end": "3131700"
  },
  {
    "text": "so if you're inside a specific phase OEM search and so forth and so on you",
    "start": "3131700",
    "end": "3137700"
  },
  {
    "text": "execute that face until you hit a switch in state and then you swap your modes",
    "start": "3137700",
    "end": "3143819"
  },
  {
    "text": "and phases around so that every phase gets to work and then for example the pixel transfer really is nothing more",
    "start": "3143819",
    "end": "3150300"
  },
  {
    "text": "than filling a buffer with the pixels from the correct memory spaces so that your",
    "start": "3150300",
    "end": "3155700"
  },
  {
    "text": "windows horns gets a chance to Output the video on screen",
    "start": "3155700",
    "end": "3161059"
  },
  {
    "text": "um yeah I could go probably another four hours talking",
    "start": "3161220",
    "end": "3167760"
  },
  {
    "text": "about the code but uh I only have eight minutes no seven minutes left so I'm gonna give you",
    "start": "3167760",
    "end": "3175079"
  },
  {
    "text": "a chance to ask me some questions if you have any",
    "start": "3175079",
    "end": "3180558"
  },
  {
    "text": "how many hours have I spent working on this way too much I can try to look in the git repository",
    "start": "3182280",
    "end": "3190760"
  },
  {
    "text": "I started with the best step get ignore um",
    "start": "3190760",
    "end": "3196800"
  },
  {
    "text": "and then to get somewhere workable is live in July",
    "start": "3196800",
    "end": "3206520"
  },
  {
    "text": "no sorry 13 October so that was a good month and a half",
    "start": "3206520",
    "end": "3213720"
  },
  {
    "text": "but also a lot of restless nights because at some point",
    "start": "3213720",
    "end": "3219059"
  },
  {
    "text": "um I actually think it's in here 1 25 am",
    "start": "3219059",
    "end": "3226640"
  },
  {
    "text": "that might be my yeah it was still manageable 1 25 am was the last latest",
    "start": "3228420",
    "end": "3234420"
  },
  {
    "text": "at night that I was working on this before I realized maybe it's time to go to bed now",
    "start": "3234420",
    "end": "3239760"
  },
  {
    "text": "um but yeah I've spent several several hours in this if I would",
    "start": "3239760",
    "end": "3245579"
  },
  {
    "text": "total it up it's going to be easily uh four or five full-time weeks",
    "start": "3245579",
    "end": "3252059"
  },
  {
    "text": "and that's with a working example because what I did forget to mention is I did not just clone David's repository",
    "start": "3252059",
    "end": "3259800"
  },
  {
    "text": "but I put it next to mine and then compared what I was missing and doing",
    "start": "3259800",
    "end": "3265319"
  },
  {
    "text": "wrong and then I did copy it over manually but also manually because then I forced myself to",
    "start": "3265319",
    "end": "3272460"
  },
  {
    "text": "understand what was happening in the code base rather than just saying Fork it and improve it",
    "start": "3272460",
    "end": "3278099"
  },
  {
    "text": "because it's a bit different than what David is doing I did send him a pull request for adding sound in this version",
    "start": "3278099",
    "end": "3283380"
  },
  {
    "text": "as well um so to help him his improve his version as well",
    "start": "3283380",
    "end": "3290779"
  },
  {
    "text": "no other questions that's a bit of a niche topic not everyone is probably waiting to jump in",
    "start": "3292740",
    "end": "3299700"
  },
  {
    "text": "and writing an emulator themselves but I must say I had a lot of fun trying to do",
    "start": "3299700",
    "end": "3305520"
  },
  {
    "text": "something like this I sometimes get crazy ideas to to do stuff one of the other ideas is",
    "start": "3305520",
    "end": "3312960"
  },
  {
    "text": "I started porting Doom to c-sharp also got that running it also runs on",
    "start": "3312960",
    "end": "3320040"
  },
  {
    "text": "Maui Doom so we have Doom running on a Android phone using c-sharp which is",
    "start": "3320040",
    "end": "3326339"
  },
  {
    "text": "cool okay so if there's no other questions then I have one more slide",
    "start": "3326339",
    "end": "3335670"
  },
  {
    "text": "[Music]",
    "start": "3335670",
    "end": "3338819"
  },
  {
    "text": "thank you and if you want to grab the presentation which includes all of the links to",
    "start": "3340859",
    "end": "3346800"
  },
  {
    "text": "materials also includes links to how to make your own Game Boy games and stuff then you can find this QR code but I'm",
    "start": "3346800",
    "end": "3354300"
  },
  {
    "text": "sure we'll also get the slides at Via indices back to you later as well all",
    "start": "3354300",
    "end": "3359880"
  },
  {
    "text": "right thank you and have a great rest of the conference",
    "start": "3359880",
    "end": "3364338"
  }
]