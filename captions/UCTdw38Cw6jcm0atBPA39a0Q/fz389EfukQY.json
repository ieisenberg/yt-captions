[
  {
    "text": "okay someone Marcus up okay great so hi there",
    "start": "0",
    "end": "7020"
  },
  {
    "text": "good morning um my name is Santa Monica I'm a principal Cloud architect working for uh",
    "start": "7020",
    "end": "13380"
  },
  {
    "text": "info Sport with an article cell C company in the Netherlands um really glad to be here it is actually",
    "start": "13380",
    "end": "18900"
  },
  {
    "text": "my first time here at NDC London so um yeah really excited so the topic of",
    "start": "18900",
    "end": "24779"
  },
  {
    "text": "today is actually going to be two topics we're going to talk about Dapper we're going to talk about Azure container apps",
    "start": "24779",
    "end": "30000"
  },
  {
    "text": "and especially how we can combine these two technologies into this really powerful flexible surface platform for",
    "start": "30000",
    "end": "37140"
  },
  {
    "text": "our New York 10 wise applications now I've been working with a customer in",
    "start": "37140",
    "end": "43079"
  },
  {
    "text": "Netherlands for quite some time now they're a company in the energy utility sector and they have a growing number of",
    "start": "43079",
    "end": "49260"
  },
  {
    "text": "Nets microservices which they run most of them anyway in",
    "start": "49260",
    "end": "55079"
  },
  {
    "text": "Azure app services and generally speaking they are actually quite happy with that app Services really easy to",
    "start": "55079",
    "end": "63180"
  },
  {
    "text": "get to learn is easy to deployer.net applications to write now over the last",
    "start": "63180",
    "end": "68520"
  },
  {
    "text": "couple of years they've been starting using containers more and more they really like the uh the portability and",
    "start": "68520",
    "end": "75180"
  },
  {
    "text": "the isolation it gives them but it's still deployed those containers to a sharp services and you can do that with",
    "start": "75180",
    "end": "81060"
  },
  {
    "text": "this web app for containers feature so even though they are quite happy with",
    "start": "81060",
    "end": "87479"
  },
  {
    "text": "this um there are some downsides because as you have Services it's really optimized",
    "start": "87479",
    "end": "93659"
  },
  {
    "text": "for running web applications right um so it's optimized for running one or",
    "start": "93659",
    "end": "100079"
  },
  {
    "text": "maybe a couple of containers really well and they're not just building web applications they are building these",
    "start": "100079",
    "end": "106740"
  },
  {
    "text": "large Microsoft Solutions consisting of many moving parts and so ideally they'd",
    "start": "106740",
    "end": "111780"
  },
  {
    "text": "like to have access to some more advanced features more geared towards microservices things like",
    "start": "111780",
    "end": "118460"
  },
  {
    "text": "traffic routing and service Discovery things you really want when you need",
    "start": "118460",
    "end": "124040"
  },
  {
    "text": "where you get a lot of more different microservices they also like to have some better skill",
    "start": "124040",
    "end": "129720"
  },
  {
    "text": "out capabilities you can scale out of course with Azure app servers but if you do you scale out the entire app service",
    "start": "129720",
    "end": "135360"
  },
  {
    "text": "plan and I like to have some more fine more granular control over that",
    "start": "135360",
    "end": "140640"
  },
  {
    "text": "so if they were building microservices and if they want all of these nice features then why not just go to",
    "start": "140640",
    "end": "146220"
  },
  {
    "text": "kubernetes right because it will do all of that for you well there are very hesitant to go to kubernetes because",
    "start": "146220",
    "end": "153140"
  },
  {
    "text": "frankly they don't need all the flexibility that kubernetes will offer them and they basically don't want any",
    "start": "153140",
    "end": "159660"
  },
  {
    "text": "of the complexity that's give me this will give them because let's face it kubernetes even on a servers like Azure",
    "start": "159660",
    "end": "166140"
  },
  {
    "text": "kubernetes servers where a lot of it is meant is for you is still a way more complex service to use than Azure app",
    "start": "166140",
    "end": "172140"
  },
  {
    "text": "servers and that's simply because it does a lot more um so you get this higher complexity so",
    "start": "172140",
    "end": "179580"
  },
  {
    "text": "they are a bit Stuck in the Middle Here app Services doesn't offer them enough",
    "start": "179580",
    "end": "185000"
  },
  {
    "text": "kubernetes gives them basically too much and as you might have guessed this is where I should container apps comes into",
    "start": "185000",
    "end": "191040"
  },
  {
    "text": "the picture so with container apps we get basically the Surplus platform that",
    "start": "191040",
    "end": "196260"
  },
  {
    "text": "we can use to run our continuous workloads um it still uses kubernetes under the",
    "start": "196260",
    "end": "201540"
  },
  {
    "text": "hood but you don't have to deal with all of the lower level implementation details so you don't have to deal with",
    "start": "201540",
    "end": "207000"
  },
  {
    "text": "that kubernetes API directly instead you work with this opinionated highly high",
    "start": "207000",
    "end": "213480"
  },
  {
    "text": "level of abstraction that still gives you Advanced features like a traffic",
    "start": "213480",
    "end": "220080"
  },
  {
    "text": "routing and HTTP increase and search Discovery without having you go to that",
    "start": "220080",
    "end": "226280"
  },
  {
    "text": "kubernetes layer directly so basically you are trading some of the",
    "start": "226280",
    "end": "232260"
  },
  {
    "text": "flexibility that you get with kubernetes for a lot more Simplicity and ease of use so this is basically perfect fit for",
    "start": "232260",
    "end": "239459"
  },
  {
    "text": "them because now they can simply focus on building those microservice applications they still get some of",
    "start": "239459",
    "end": "245340"
  },
  {
    "text": "those Advanced features they want without having to worry about many of those implementation details",
    "start": "245340",
    "end": "250920"
  },
  {
    "text": "so there currently evaluating whether or not this is really a good fit for them um it's still fairly new Azure container",
    "start": "250920",
    "end": "257579"
  },
  {
    "text": "apps and they're doing some proof of Concepts now unfortunately I cannot show",
    "start": "257579",
    "end": "262740"
  },
  {
    "text": "those to you today but I do have this other sample which we can use to further",
    "start": "262740",
    "end": "268440"
  },
  {
    "text": "explore Azure container apps and also look into Dapper and this is my perfect control sample so you've probably got",
    "start": "268440",
    "end": "274440"
  },
  {
    "text": "this also here in the UK in the Netherlands we have a lot of these speed control trajectories where you use",
    "start": "274440",
    "end": "280680"
  },
  {
    "text": "cameras above the roads to snap pictures of your car at least of your license plate and then at the start with the",
    "start": "280680",
    "end": "287759"
  },
  {
    "text": "trajectory they take a picture and then at the end they take a picture they can calculate your average speed and then of",
    "start": "287759",
    "end": "293639"
  },
  {
    "text": "course if you've driven too fast you'll get a fine a hefty fine I should say",
    "start": "293639",
    "end": "299340"
  },
  {
    "text": "um so if we want to automate it I have this solution which consists of",
    "start": "299340",
    "end": "304860"
  },
  {
    "text": "three main services so first of all we have the charge control servers this is the surface that",
    "start": "304860",
    "end": "311040"
  },
  {
    "text": "will receive the events from the camera and it is responsible for",
    "start": "311040",
    "end": "317460"
  },
  {
    "text": "um calculating that average speed and then determining whether or not there was a speeding violation",
    "start": "317460",
    "end": "323340"
  },
  {
    "text": "so if it detects a speeding violation it will write you out and it will tell it's to the Fine Collection servers Define",
    "start": "323340",
    "end": "330600"
  },
  {
    "text": "collection surface then responsible for calculating the exact fine amount and sending you an email with the speeding",
    "start": "330600",
    "end": "337440"
  },
  {
    "text": "ticket now in order to be able to do that it needs some more information which it can get from the vehicle",
    "start": "337440",
    "end": "342720"
  },
  {
    "text": "registration servers so these three services are the main Services there are a couple of more but",
    "start": "342720",
    "end": "348600"
  },
  {
    "text": "we'll cut into that later now if I want to deploy this solution to Azure container apps the first thing",
    "start": "348600",
    "end": "355860"
  },
  {
    "text": "that I have to do is create an Azure container apps environment and then inside this environment these",
    "start": "355860",
    "end": "361740"
  },
  {
    "text": "microservice will run inside its own Azure container app so for those of you know kubernetes",
    "start": "361740",
    "end": "367979"
  },
  {
    "text": "Azure container apps basically just I could need this ball right so it can run one or more containers and it's the unit",
    "start": "367979",
    "end": "374280"
  },
  {
    "text": "of scale so each of these container apps you can scale and deploy individually",
    "start": "374280",
    "end": "380580"
  },
  {
    "text": "now if I want to do a demo for this we obviously need some data right because otherwise it would be a boring demo",
    "start": "380580",
    "end": "387360"
  },
  {
    "text": "um I don't have any access to traffic cameras at least not at the moment so I've got the next best thing which is",
    "start": "387360",
    "end": "393840"
  },
  {
    "text": "the simulator it will simulate some cars driving by on a road it will generate those entry and exit events and it will",
    "start": "393840",
    "end": "400740"
  },
  {
    "text": "push them to need to have control servers and I will be using mqtt for",
    "start": "400740",
    "end": "405900"
  },
  {
    "text": "that that's a really lightweight measuring protocol which is pretty often used in iot scenarios",
    "start": "405900",
    "end": "413180"
  },
  {
    "text": "so where does Debra fit into all of this because up to now we've only talked about ACA I'm going to call it ACA by",
    "start": "413220",
    "end": "419880"
  },
  {
    "text": "the way because ash container actual Cuts it's a bit long-winded so Deborah",
    "start": "419880",
    "end": "425639"
  },
  {
    "text": "can make it a lot easier for us to implement this Microsoft solution Dapper originated within Microsoft as an",
    "start": "425639",
    "end": "433500"
  },
  {
    "text": "open source project it's a couple of years old now I think it's about three years old something like that it's also",
    "start": "433500",
    "end": "439680"
  },
  {
    "text": "been adapted by the senior CF what it basically is it's this set of",
    "start": "439680",
    "end": "445139"
  },
  {
    "text": "micro server of building blocks that makes it easier for you to create microservice Solutions or distributed",
    "start": "445139",
    "end": "451800"
  },
  {
    "text": "systems so there's a lot of different building blocks in here and what's nice about these building blocks is that",
    "start": "451800",
    "end": "457860"
  },
  {
    "text": "almost all of them are pluggable so you can use different types of components with them so as an example let's take",
    "start": "457860",
    "end": "464639"
  },
  {
    "text": "the State Management building block so State Management allows you to create these stateful Services by allowing you",
    "start": "464639",
    "end": "471840"
  },
  {
    "text": "to store key value pairs in some underlying data store and there are many different components that you can choose",
    "start": "471840",
    "end": "478080"
  },
  {
    "text": "from so I could choose a component that stores my data let's say in Azure table storage and then later if I change my",
    "start": "478080",
    "end": "484860"
  },
  {
    "text": "mind maybe I want to switch to mongodb I can use a mongodb component and I don't",
    "start": "484860",
    "end": "490500"
  },
  {
    "text": "need to change my code it's only the component configuration that I need to change",
    "start": "490500",
    "end": "496340"
  },
  {
    "text": "so that means that the price application of a reportable very easy to move",
    "start": "496340",
    "end": "501900"
  },
  {
    "text": "between different environments what's also very interesting about Dapper is the way that you use these",
    "start": "501900",
    "end": "509220"
  },
  {
    "text": "from your application so Dapper is not a library or a framework that you have to",
    "start": "509220",
    "end": "515279"
  },
  {
    "text": "link inside your application as compile time stuff like that instead you talk to",
    "start": "515279",
    "end": "520979"
  },
  {
    "text": "it using the Dapper API which has two flavors HTTP and grpc",
    "start": "520979",
    "end": "527220"
  },
  {
    "text": "um and then your application runs in its own process so if I'm running this on my",
    "start": "527220",
    "end": "532560"
  },
  {
    "text": "local development machine there's two processes running side by side my application and the Dapper runtime and I",
    "start": "532560",
    "end": "539339"
  },
  {
    "text": "talk of this API now if you are running this in",
    "start": "539339",
    "end": "544740"
  },
  {
    "text": "production the deputy actually recommends that you run it in kubernetes so that would mean that I have a",
    "start": "544740",
    "end": "551160"
  },
  {
    "text": "container with my application code and I have a container I did a preside car container running adapter runtime and",
    "start": "551160",
    "end": "557220"
  },
  {
    "text": "those would run together in a single part um so this site for architecture is really",
    "start": "557220",
    "end": "563220"
  },
  {
    "text": "interesting because this means that you basically can use any language right",
    "start": "563220",
    "end": "568320"
  },
  {
    "text": "because any language that can make an HTTP or a grpc call can work with those",
    "start": "568320",
    "end": "573660"
  },
  {
    "text": "Dapper building blocks so that makes it really flexible especially in larger Microsoft scenarios where you maybe have",
    "start": "573660",
    "end": "580560"
  },
  {
    "text": "different teams working with different languages and Technologies",
    "start": "580560",
    "end": "586160"
  },
  {
    "text": "all right so normally if I want to use Debra I would spin a micro Mini's",
    "start": "586260",
    "end": "591480"
  },
  {
    "text": "cluster for production and I need to deploy deeper into it but with Azure container apps Dapper is basically built",
    "start": "591480",
    "end": "598500"
  },
  {
    "text": "in out of the box so the only thing we need to do is to specify on a container",
    "start": "598500",
    "end": "603720"
  },
  {
    "text": "app that we want to use Dapper enable it and then Azure container apps will",
    "start": "603720",
    "end": "609060"
  },
  {
    "text": "inject the depot sidecar for us now this is not a nothing all thing I've enabled",
    "start": "609060",
    "end": "615420"
  },
  {
    "text": "it here for all three services because I want to use Dapper in all three of my services but you can also enable it for",
    "start": "615420",
    "end": "621839"
  },
  {
    "text": "a single surface or two out of three all right so",
    "start": "621839",
    "end": "626940"
  },
  {
    "text": "let's switch gears for a moment and see what that actually looks like in",
    "start": "626940",
    "end": "632339"
  },
  {
    "text": "the Azure portal if it's still running because um great timing but more uh this morning",
    "start": "632339",
    "end": "639180"
  },
  {
    "text": "there were some issues in azure um I tried it all out it still worked this morning so I I hope it's still",
    "start": "639180",
    "end": "645839"
  },
  {
    "text": "working now um yeah so let's start in visual studio so",
    "start": "645839",
    "end": "650880"
  },
  {
    "text": "um this fee is code with my solution it says um fist ball in the back just okay yeah awesome",
    "start": "650880",
    "end": "657320"
  },
  {
    "text": "so I deploy this solution to Azure using bicep so here my deploy folder let's see",
    "start": "657320",
    "end": "664560"
  },
  {
    "text": "where's my cursor um there's a lot of bicep modules and if we dig here in here into some folders",
    "start": "664560",
    "end": "671720"
  },
  {
    "text": "then for example here is the bicep module for the turf control surface",
    "start": "671720",
    "end": "677519"
  },
  {
    "text": "which that service that will receive the camera events so this takes in some parameters we have the locations of the",
    "start": "677519",
    "end": "683760"
  },
  {
    "text": "region where we want to deploy this we have the um this is deploying a single edge container app right so we need to know",
    "start": "683760",
    "end": "690300"
  },
  {
    "text": "the ID of their environment where we want to deploy that app into then I also have this Menace identity ID",
    "start": "690300",
    "end": "696540"
  },
  {
    "text": "so this is the name of a user assigned minus identity that I created to let my app integrate with some other Azure",
    "start": "696540",
    "end": "702779"
  },
  {
    "text": "resources and then down here on line 9 we can see the actual resource definition of the",
    "start": "702779",
    "end": "708720"
  },
  {
    "text": "container app now we need to give the name we need to give you that location I assigned that minus identity and then we get to the",
    "start": "708720",
    "end": "716519"
  },
  {
    "text": "properties where I'll set the environment ID and then finally here in the template section we can specify which container",
    "start": "716519",
    "end": "723300"
  },
  {
    "text": "we actually want to run inside this app which is a container that I pull for my",
    "start": "723300",
    "end": "729480"
  },
  {
    "text": "public Docker Hub repo thingy now notice this is an array",
    "start": "729480",
    "end": "734880"
  },
  {
    "text": "So within a container app you can run multiple containers and that's the skill",
    "start": "734880",
    "end": "741300"
  },
  {
    "text": "unit so they will scale together but as far as scaling goes I'm keeping it simple for now so here I specify that",
    "start": "741300",
    "end": "748200"
  },
  {
    "text": "I want to have basically exactly one replica and we will not do any odd",
    "start": "748200",
    "end": "753540"
  },
  {
    "text": "scaling yet but we'll get to that and then finally in configuration I need to study active Refrigeration",
    "start": "753540",
    "end": "760140"
  },
  {
    "text": "smart so what's a revision well a revision is basically",
    "start": "760140",
    "end": "765480"
  },
  {
    "text": "um immutable snapshot of a version of your application so let's say that I've",
    "start": "765480",
    "end": "771360"
  },
  {
    "text": "got this great new feature in my application but I only want 20 of the requests coming in to use that new",
    "start": "771360",
    "end": "777959"
  },
  {
    "text": "feature just to try it out like doing a little Canary testing then I can set the",
    "start": "777959",
    "end": "783360"
  },
  {
    "text": "active refusions mode to multiple and then I can add traffic rules so that 20 of the traffic will go to the latest",
    "start": "783360",
    "end": "789899"
  },
  {
    "text": "revision and 80 of the traffic will go to the older refusion now in this case",
    "start": "789899",
    "end": "796019"
  },
  {
    "text": "I'm simply using a single revisions mode which means that 100 of the incoming",
    "start": "796019",
    "end": "801779"
  },
  {
    "text": "traffic will always go to the very latest version of my app that I've deployed",
    "start": "801779",
    "end": "807899"
  },
  {
    "text": "and then finally on online 34 we get to the depth apart so here I enable the",
    "start": "807899",
    "end": "814620"
  },
  {
    "text": "upper to inject that sidecar each Dapper app also needs to have a unique ID",
    "start": "814620",
    "end": "820320"
  },
  {
    "text": "that's the debr application ID so I set the two turf control servers and then this Dapper sidecar needs to know on",
    "start": "820320",
    "end": "827700"
  },
  {
    "text": "which Port my application is listening because most of the time I'm calling the preside car but sometimes the Dapper",
    "start": "827700",
    "end": "834540"
  },
  {
    "text": "software needs to call into my application for example to get some configuration or to trigger my",
    "start": "834540",
    "end": "840839"
  },
  {
    "text": "application to start doing something so my app is simply running on Port 80.",
    "start": "840839",
    "end": "846839"
  },
  {
    "text": "now I've already deployed this um so we don't have to wait so here I am in the Azure portal in the",
    "start": "846839",
    "end": "855420"
  },
  {
    "text": "dev turf control ACI Resource Group so here we can see the container apps environment you can see some container",
    "start": "855420",
    "end": "862260"
  },
  {
    "text": "apps here like defined collection servers and you can actually see a lot of more stuff",
    "start": "862260",
    "end": "867360"
  },
  {
    "text": "um which is all stuff I need and we'll catch you but let me first jump into this turf control surface",
    "start": "867360",
    "end": "875420"
  },
  {
    "text": "and you can see that if I go to Deborah you can see that it is enabled and there's all those settings we just saw",
    "start": "876240",
    "end": "882480"
  },
  {
    "text": "in the bicep module and if I scroll down you can even see all the Dapper components that are configured for this",
    "start": "882480",
    "end": "888600"
  },
  {
    "text": "app and what's really nice and useful for debugging and for these kinds of demos is that you could go to the lock stream",
    "start": "888600",
    "end": "895380"
  },
  {
    "text": "it's always a weird alert because I didn't change anything it still wants me to I guess discard nothing",
    "start": "895380",
    "end": "902579"
  },
  {
    "text": "um so here you can see the direct output coming from the containers in your app",
    "start": "902579",
    "end": "908220"
  },
  {
    "text": "so as you'll see the latest lock line is from like uh nine o'clock this morning",
    "start": "908220",
    "end": "913860"
  },
  {
    "text": "at nine o'clock this still works at least so this shows all of the Locking of all",
    "start": "913860",
    "end": "919500"
  },
  {
    "text": "of the containers in your app right so this is my application container but because there's also a sidecar",
    "start": "919500",
    "end": "924540"
  },
  {
    "text": "containing running there I can also select oh select that Sidecar",
    "start": "924540",
    "end": "930300"
  },
  {
    "text": "and we will see the Dapper logs so this is really um useful to get a nice live view of",
    "start": "930300",
    "end": "937440"
  },
  {
    "text": "what is happening inside your application all of that blocking is also dumped into a lock analytics workspace",
    "start": "937440",
    "end": "943320"
  },
  {
    "text": "so if you want to do some uh longer term query stuff like that you can use log",
    "start": "943320",
    "end": "948360"
  },
  {
    "text": "analytics for that all right for now let's",
    "start": "948360",
    "end": "953519"
  },
  {
    "text": "go back to the slides and let's dive a little deeper into our",
    "start": "953519",
    "end": "959279"
  },
  {
    "text": "first surface of traffic control servers so this needs to get some data from the",
    "start": "959279",
    "end": "966000"
  },
  {
    "text": "traffic simulator right and to keep the service itself nicely decoupled from the cameras and or my simulator I'm going to",
    "start": "966000",
    "end": "973380"
  },
  {
    "text": "use a mqtt message progress in middleman here so I'm going to use mosquito which",
    "start": "973380",
    "end": "979380"
  },
  {
    "text": "is this very lightweight mqtt open source message broker and what we'll do is the traffic",
    "start": "979380",
    "end": "985560"
  },
  {
    "text": "simulator can push messages to Mosquito and then other clients like the traffic control servers can subscribe to process",
    "start": "985560",
    "end": "992339"
  },
  {
    "text": "those messages right so it works just like any message broker um but of course mosquito is running",
    "start": "992339",
    "end": "999120"
  },
  {
    "text": "inside of azure somewhere up there and my traffic simulator is going to run",
    "start": "999120",
    "end": "1005240"
  },
  {
    "text": "on my local laptop so we need to make sure those two can connect and the way to do that is to set up increase on that",
    "start": "1005240",
    "end": "1013759"
  },
  {
    "text": "container app so we're setting up increase you're basically exposing a port to make it available to to the",
    "start": "1013759",
    "end": "1019940"
  },
  {
    "text": "clients now in this case I'm talking mqtt and mqtt is a DSP based protocol so",
    "start": "1019940",
    "end": "1026780"
  },
  {
    "text": "I need to open up a TCP port and usually with mqtt that's 1883 that's usual",
    "start": "1026780",
    "end": "1032540"
  },
  {
    "text": "report that's used for that so I can do that using this piece of",
    "start": "1032540",
    "end": "1038418"
  },
  {
    "text": "bicep here you can see I've added a Ingress part to My configuration section",
    "start": "1038419",
    "end": "1044020"
  },
  {
    "text": "setting external to True means that I want that port to be available outside",
    "start": "1044020",
    "end": "1049040"
  },
  {
    "text": "of my environment if I leave it at False only the other services within these",
    "start": "1049040",
    "end": "1054760"
  },
  {
    "text": "environments can access the port uh so the target ports deported and want to expose are my mosquito container the",
    "start": "1054760",
    "end": "1061700"
  },
  {
    "text": "exposed Port is supported the clients going to connect to uh that is optional by default it's to the Target Port but",
    "start": "1061700",
    "end": "1068600"
  },
  {
    "text": "you can do some Port mapping there if you like um and then I need to specify the transport tab now originally ACA only",
    "start": "1068600",
    "end": "1075559"
  },
  {
    "text": "supported HTTP and HTTP 2 and now TCP increase is in public preview so I'm",
    "start": "1075559",
    "end": "1082220"
  },
  {
    "text": "using the preview feature there is one kefir dial you have to deploy your Azure",
    "start": "1082220",
    "end": "1087740"
  },
  {
    "text": "container environment inside a custom v-net for this to work so what I did for my bicep modules I first created that",
    "start": "1087740",
    "end": "1093860"
  },
  {
    "text": "custom v-net and then I deployed that environment into that v-net and now I can use tsp so this works great so now I",
    "start": "1093860",
    "end": "1101600"
  },
  {
    "text": "have my events generated going up to Mosquito and now the traffic control service needs to process those events",
    "start": "1101600",
    "end": "1108440"
  },
  {
    "text": "but house is going to do that so we're talking mqtt here so I'm I",
    "start": "1108440",
    "end": "1114020"
  },
  {
    "text": "could go hunt for mqtt nuket Library injected into my application deal with",
    "start": "1114020",
    "end": "1119720"
  },
  {
    "text": "it directly from my code or I could simply not worry about mqtt at all and",
    "start": "1119720",
    "end": "1125299"
  },
  {
    "text": "just let Dapper handle that and we can do that by using a building block called Dapper bindings or in this",
    "start": "1125299",
    "end": "1132380"
  },
  {
    "text": "case specifically the input bindings so with deeper bindings",
    "start": "1132380",
    "end": "1137720"
  },
  {
    "text": "um you can basically interface with external systems without having to worry",
    "start": "1137720",
    "end": "1142940"
  },
  {
    "text": "about all of the lower nitty-gritty details so what we can do is we can",
    "start": "1142940",
    "end": "1148220"
  },
  {
    "text": "create a component configuration for a mqtt Dapper input binding then the",
    "start": "1148220",
    "end": "1155000"
  },
  {
    "text": "sidecar will see that component it will subscribe to Mosquito for us and it will",
    "start": "1155000",
    "end": "1161480"
  },
  {
    "text": "start to receive those messages and then when a message comes in it will trigger the application",
    "start": "1161480",
    "end": "1167900"
  },
  {
    "text": "by calling a HTTP endpoint on the application now notice it's an HTTP now",
    "start": "1167900",
    "end": "1173660"
  },
  {
    "text": "the mqtt endpoint and we can create very simply an HTTP endpoint because well",
    "start": "1173660",
    "end": "1178700"
  },
  {
    "text": "basically we're doing that all of the time so now my application doesn't need to deal it doesn't even need to know",
    "start": "1178700",
    "end": "1185000"
  },
  {
    "text": "that it's using mqtt under the hood it only needs to expose that HTTP endpoint and that's also really nice for um",
    "start": "1185000",
    "end": "1192500"
  },
  {
    "text": "testing by the way so let's see that in code let's first look",
    "start": "1192500",
    "end": "1199520"
  },
  {
    "text": "at that component configuration file so let me open up",
    "start": "1199520",
    "end": "1205460"
  },
  {
    "text": "this again uh where did I put this inside my depth folder so there are two",
    "start": "1205460",
    "end": "1210679"
  },
  {
    "text": "input bindings here actually so the entry cam is for the first set of cameras that your car will drive under",
    "start": "1210679",
    "end": "1216860"
  },
  {
    "text": "um so what we see here on line eight is the the deeper components for this so each stepper component needs to have a",
    "start": "1216860",
    "end": "1223340"
  },
  {
    "text": "name so I'm going to call this entry cam and then you need to specify the component type so this is a binding for",
    "start": "1223340",
    "end": "1230179"
  },
  {
    "text": "mqtt so buy mixer time qtt by the way there are a lot of components there are",
    "start": "1230179",
    "end": "1235280"
  },
  {
    "text": "I think they've they're up to like a 124 components something like that over all",
    "start": "1235280",
    "end": "1241400"
  },
  {
    "text": "of the building blocks so and you can contribute your own if you're missing something because it's",
    "start": "1241400",
    "end": "1247340"
  },
  {
    "text": "all open source um and then in this metadata part here you need to specify the metadata for the",
    "start": "1247340",
    "end": "1254000"
  },
  {
    "text": "component and the the exact stuff that you need to specify of course differs per component type so in this case for",
    "start": "1254000",
    "end": "1260840"
  },
  {
    "text": "mqtt we need to tell it um where the mqtt host is by specifying this URL parameter we need to tell it",
    "start": "1260840",
    "end": "1268340"
  },
  {
    "text": "what topic we want to subscribe to so for the entry can we want to listen to the entry cam messages and then each",
    "start": "1268340",
    "end": "1275660"
  },
  {
    "text": "client that connects to Mosquito needs to have a unique ID we don't know exactly how many clients are coming to",
    "start": "1275660",
    "end": "1282140"
  },
  {
    "text": "be because if I scale out I will get multiple clients right so instead of",
    "start": "1282140",
    "end": "1287179"
  },
  {
    "text": "having a static value here I just use this nice template syntax",
    "start": "1287179",
    "end": "1292360"
  },
  {
    "text": "which means hey Debra you figure it out just generate a unique ID for me a free",
    "start": "1292360",
    "end": "1297380"
  },
  {
    "text": "time you create an instance of this component and then finally we get to discuss parts",
    "start": "1297380",
    "end": "1303380"
  },
  {
    "text": "so by default every Dapper component that I Define is available to every",
    "start": "1303380",
    "end": "1308480"
  },
  {
    "text": "Azure container app running in that environment you may not want that you",
    "start": "1308480",
    "end": "1313700"
  },
  {
    "text": "may want to scope it further to a single serve so to a set of services so you can do that using this using these scopes",
    "start": "1313700",
    "end": "1321919"
  },
  {
    "text": "so with this set up Deborah will start listening to using this URL to this",
    "start": "1321919",
    "end": "1327260"
  },
  {
    "text": "topic and then it will alert my application whenever there is a message available so if I",
    "start": "1327260",
    "end": "1334100"
  },
  {
    "text": "look at each control servers I have these nice minimal API endpoints",
    "start": "1334100",
    "end": "1340220"
  },
  {
    "text": "I really like minimal API for doing demos like this because everything is nice in a single file so I've got two of",
    "start": "1340220",
    "end": "1347059"
  },
  {
    "text": "them entry Cam and exit Cam and these are the end points that we'll get calls",
    "start": "1347059",
    "end": "1352340"
  },
  {
    "text": "whenever a message comes in so how does stepper know that I've named these",
    "start": "1352340",
    "end": "1358220"
  },
  {
    "text": "endpoints entry Cam and exit cam well that's pretty simple if you just go back to the um findings it's the name of the",
    "start": "1358220",
    "end": "1366620"
  },
  {
    "text": "binding so if I change this name here I also need to change the name of that after the endpoint and I also have exit",
    "start": "1366620",
    "end": "1373700"
  },
  {
    "text": "Game binding which is exactly the same the only difference is it's called access game and it listens to a",
    "start": "1373700",
    "end": "1379820"
  },
  {
    "text": "different topic",
    "start": "1379820",
    "end": "1382720"
  },
  {
    "text": "um let's see what we'll do yeah we'll go back to the slides for a bit",
    "start": "1384980",
    "end": "1391899"
  },
  {
    "text": "um and talk about uh Auto scaling just a bit because now that we've decoupled stuff with that mosquito broker it's",
    "start": "1392900",
    "end": "1399440"
  },
  {
    "text": "very easy to scale out the trash control servers to start processing more messages in in parallel and Azure",
    "start": "1399440",
    "end": "1407539"
  },
  {
    "text": "container actually uses Keda for that so Keda is a kubernetes event Driven Auto scaler it's a different open source",
    "start": "1407539",
    "end": "1413840"
  },
  {
    "text": "project which they've incorporated into Azure container apps and we can use skida to create rules like this one so",
    "start": "1413840",
    "end": "1420919"
  },
  {
    "text": "this is a really simple rule it's based on CPU utilization it just says a",
    "start": "1420919",
    "end": "1426260"
  },
  {
    "text": "minimum replicas one maximum three and if you're really busy go spin up another replica right so this is a pretty boring",
    "start": "1426260",
    "end": "1432980"
  },
  {
    "text": "one but keeda has a lot of different scalers that you can use so for example if I were pulling in messages from a",
    "start": "1432980",
    "end": "1440780"
  },
  {
    "text": "service bus queue then there's a service bus scaler for",
    "start": "1440780",
    "end": "1446059"
  },
  {
    "text": "key data that I could use and then I can scale my app based on the number of messages in the queue now unfortunately",
    "start": "1446059",
    "end": "1453159"
  },
  {
    "text": "there isn't a mqtt scaler yet for uh kedia otherwise I would be able to use",
    "start": "1453159",
    "end": "1458780"
  },
  {
    "text": "that and we could Scale based on the number of messages available in mosquito so I'm just sticking with this CPU rule",
    "start": "1458780",
    "end": "1465559"
  },
  {
    "text": "for now so if the CPU load is high enough eventually we will get two three",
    "start": "1465559",
    "end": "1471740"
  },
  {
    "text": "replicas right notice here that I'm still only have a single app and within that app I have three replicas all",
    "start": "1471740",
    "end": "1478520"
  },
  {
    "text": "processing messages in parallel now the very nice thing about ACA is that you",
    "start": "1478520",
    "end": "1485360"
  },
  {
    "text": "can also scale down all the way down to zero and zero is great because if there is no work to do I don't want to pay for",
    "start": "1485360",
    "end": "1491120"
  },
  {
    "text": "it and I can just shut it all off but while that's really nice be really",
    "start": "1491120",
    "end": "1497299"
  },
  {
    "text": "careful with this if you are using Dapper to trickle your application as I'm doing here because if your scaled",
    "start": "1497299",
    "end": "1503480"
  },
  {
    "text": "down to zero of course your application container is gone but your sidecar container is also gone",
    "start": "1503480",
    "end": "1509419"
  },
  {
    "text": "and the sidecar container was the only component in my diagram that actually triggers my application to do some work",
    "start": "1509419",
    "end": "1515539"
  },
  {
    "text": "so we decided for container gun nobody subscribed to that mosquito topic anymore and nothing will ever happen",
    "start": "1515539",
    "end": "1522200"
  },
  {
    "text": "again this will always stay at zero now if we did have access to a keeda",
    "start": "1522200",
    "end": "1529400"
  },
  {
    "text": "scaler for mqtt we could have used that then the scalar would detect hey there",
    "start": "1529400",
    "end": "1535340"
  },
  {
    "text": "is some work to be done because I see a q count higher than one and it will scale my application back up so that",
    "start": "1535340",
    "end": "1540799"
  },
  {
    "text": "would get us out of this problem but because here Dapper is the only one triggering and I don't have a scalar",
    "start": "1540799",
    "end": "1546380"
  },
  {
    "text": "based on the infrastructure I shoot nuts definitely not scale down this solution",
    "start": "1546380",
    "end": "1552200"
  },
  {
    "text": "to zero um yeah okay so now we get in those camera",
    "start": "1552200",
    "end": "1558500"
  },
  {
    "text": "events so just to reiterate we get an entry message that has a timestamp when a car reaches the first set of cameras",
    "start": "1558500",
    "end": "1565340"
  },
  {
    "text": "then after a while unless something horribly happens the car will reach the",
    "start": "1565340",
    "end": "1570740"
  },
  {
    "text": "exit and we get a different time step and then we can calculate the effort speech right so the time step that we",
    "start": "1570740",
    "end": "1578000"
  },
  {
    "text": "get at the point of entry we need to at least keep somewhere safe on until at",
    "start": "1578000",
    "end": "1583700"
  },
  {
    "text": "least we get to the to the end of the trajectory so this needs to be a stateful server",
    "start": "1583700",
    "end": "1588740"
  },
  {
    "text": "and to do that I can use another adapter building block called State Management so it's State Management I can simply",
    "start": "1588740",
    "end": "1595760"
  },
  {
    "text": "store key value pairs inside some data store to be determined configured now",
    "start": "1595760",
    "end": "1602000"
  },
  {
    "text": "this really meant for like hot state or transactional state small things like this don't replace your huge relational",
    "start": "1602000",
    "end": "1610039"
  },
  {
    "text": "SQL database with States management that's not what it's meant for so I'm going to use this to store my",
    "start": "1610039",
    "end": "1617539"
  },
  {
    "text": "state in Azure Cosmos DB so to set it up I create another component configuration",
    "start": "1617539",
    "end": "1623299"
  },
  {
    "text": "file for that customer sdb and then when I want to either save some state or get",
    "start": "1623299",
    "end": "1628340"
  },
  {
    "text": "some State I make a call to my deposite car tell it what I want then the depth",
    "start": "1628340",
    "end": "1633380"
  },
  {
    "text": "sidecar will look at the configuration and it will talk to Azure customers to be for me right",
    "start": "1633380",
    "end": "1639440"
  },
  {
    "text": "now the nice thing about this being all blockable and portable is that if I run",
    "start": "1639440",
    "end": "1645020"
  },
  {
    "text": "this Solution on my laptop maybe I don't want to be tied to Azure maybe Azure is down like this morning",
    "start": "1645020",
    "end": "1651400"
  },
  {
    "text": "and then maybe I want to use redis for a state store because I can run redis in a",
    "start": "1651400",
    "end": "1658159"
  },
  {
    "text": "container on my laptop in that case I only need to change that components configuration file Deborah",
    "start": "1658159",
    "end": "1665000"
  },
  {
    "text": "will use red as Mi application code can stay exactly the same I don't need to change anything",
    "start": "1665000",
    "end": "1670940"
  },
  {
    "text": "so again that's really flexible I'm going to stick with Azure Cosmos DB for now while it's whilst working",
    "start": "1670940",
    "end": "1676940"
  },
  {
    "text": "so after we've done that we now have the speeding violation and we need to tell",
    "start": "1676940",
    "end": "1682640"
  },
  {
    "text": "the fan collection service about it and I'm going to do that asynchronously by publishing an event and of course",
    "start": "1682640",
    "end": "1688220"
  },
  {
    "text": "there's another building block to help me with that called the publisher subscribe or Pub sub building block and",
    "start": "1688220",
    "end": "1694100"
  },
  {
    "text": "that allows me to integrate with message brokers so in this case I'm going to use another",
    "start": "1694100",
    "end": "1700340"
  },
  {
    "text": "component configuration to set up a connection to an Azure service bus and then when I want to publish that event I",
    "start": "1700340",
    "end": "1706279"
  },
  {
    "text": "simply go into my debit Sidecar so let me show you what that all looks like",
    "start": "1706279",
    "end": "1712159"
  },
  {
    "text": "in code so let's go back to official Studio code and basically",
    "start": "1712159",
    "end": "1717340"
  },
  {
    "text": "continue where we left off we were in the traffic control servers with these",
    "start": "1717340",
    "end": "1723140"
  },
  {
    "text": "two endpoints right so um this is the first one the entry camp",
    "start": "1723140",
    "end": "1730039"
  },
  {
    "text": "so the only thing that we actually have to do here is store that entry State until some later time when we reach the",
    "start": "1730039",
    "end": "1736940"
  },
  {
    "text": "end of the trajectory so I'm going to create a new vehicle set object with just a simple container object or I",
    "start": "1736940",
    "end": "1743539"
  },
  {
    "text": "think it's a record actually with a couple of properties so I'm going to new that up and then I need to use Dapper to",
    "start": "1743539",
    "end": "1750620"
  },
  {
    "text": "save that state now there are a couple of ways to do that I could simply use an",
    "start": "1750620",
    "end": "1756679"
  },
  {
    "text": "HTTP client and make a direct HTTP call to that sidecar because it's an HTTP API",
    "start": "1756679",
    "end": "1761720"
  },
  {
    "text": "but it's much nicer to use one of the language specific sdks and there are a",
    "start": "1761720",
    "end": "1767419"
  },
  {
    "text": "lot of them of course there's C sharp so I'm using the net SDK but there are sdks for python Java rusts go I think PHP",
    "start": "1767419",
    "end": "1776659"
  },
  {
    "text": "even JavaScript a lot of languages so to use this SDK I've added a new cat",
    "start": "1776659",
    "end": "1783080"
  },
  {
    "text": "package to this project and then up here at line number four you can see me calling a Dapper",
    "start": "1783080",
    "end": "1789860"
  },
  {
    "text": "client so that register some Client Services into the services collection which in turn allows me to in this",
    "start": "1789860",
    "end": "1797120"
  },
  {
    "text": "Handler here inject aw client and I can use that type of client object to",
    "start": "1797120",
    "end": "1802520"
  },
  {
    "text": "interact with my sidecar so it exposes stuff like Save State and then in Save",
    "start": "1802520",
    "end": "1808460"
  },
  {
    "text": "State I can pass in the name of the component that I want to use which is",
    "start": "1808460",
    "end": "1813679"
  },
  {
    "text": "state store so if we go back to device and modules and we look at state store",
    "start": "1813679",
    "end": "1819500"
  },
  {
    "text": "here is my state store component you can see it has the right name it's of type",
    "start": "1819500",
    "end": "1824659"
  },
  {
    "text": "Cosmos DB and then I have some metadata to tell there how to connect to the",
    "start": "1824659",
    "end": "1830840"
  },
  {
    "text": "actual customers to be now notice that for the master key I have it put it in",
    "start": "1830840",
    "end": "1836299"
  },
  {
    "text": "here in plain text because this will get pushed up to GitHub and it's no fun pushing your secrets up to GitHub so",
    "start": "1836299",
    "end": "1843080"
  },
  {
    "text": "instead I'm using a secret reference which references this Secret store here which is not a Dapper building block",
    "start": "1843080",
    "end": "1849620"
  },
  {
    "text": "which will get into later so the other parameters here uh are the",
    "start": "1849620",
    "end": "1856340"
  },
  {
    "text": "key that I won't store any value that I want store and then I'm done Dapper does all of the hard work for me I didn't",
    "start": "1856340",
    "end": "1862220"
  },
  {
    "text": "need to use any customers DB specific code or sdks here that's all being done",
    "start": "1862220",
    "end": "1867440"
  },
  {
    "text": "by dapper now as soon as we reach the end of the trajectory we get an exit message",
    "start": "1867440",
    "end": "1874039"
  },
  {
    "text": "the first thing I need to do is to retrieve that entry state from the state store so I can use the Dapper client",
    "start": "1874039",
    "end": "1880760"
  },
  {
    "text": "again call Cat State entry um we should have that state right because",
    "start": "1880760",
    "end": "1886460"
  },
  {
    "text": "Africa should have come through the entry camera before reaching the exit but this is all still software so I'm",
    "start": "1886460",
    "end": "1892340"
  },
  {
    "text": "checking anyway so if I don't have it I just return and not found if I have",
    "start": "1892340",
    "end": "1897860"
  },
  {
    "text": "found it I'll update that state with the exit timestamp and just save feedback for good measure and then we can do the",
    "start": "1897860",
    "end": "1903980"
  },
  {
    "text": "useful businessy stuff we can use the calculator to determine whether or not we have a traffic violation on our hands",
    "start": "1903980",
    "end": "1910940"
  },
  {
    "text": "and so we get back the speeding violation kilometers per hour so if that's a positive number then we'll just",
    "start": "1910940",
    "end": "1918200"
  },
  {
    "text": "go ahead and create that event that we want to publish our speeding file is detected which contains a bunch of",
    "start": "1918200",
    "end": "1924500"
  },
  {
    "text": "information like the license number the road and the actual violation and we can",
    "start": "1924500",
    "end": "1930020"
  },
  {
    "text": "publish that again simply by using that the client",
    "start": "1930020",
    "end": "1935120"
  },
  {
    "text": "so sorry",
    "start": "1935120",
    "end": "1939380"
  },
  {
    "text": "at this point it would be nice to see something running",
    "start": "1941720",
    "end": "1947059"
  },
  {
    "text": "um but unfortunately we need to have a little talk about this because here I'm running into",
    "start": "1947059",
    "end": "1954200"
  },
  {
    "text": "um what I think is it's a pretty big limitation of container apps at the moment so I have this what I think is a",
    "start": "1954200",
    "end": "1961820"
  },
  {
    "text": "very nice visual simulator that I've spent way too much time on and it can generate that traffic and it creates",
    "start": "1961820",
    "end": "1968480"
  },
  {
    "text": "those events and it wants to send those events to Mosquito of mqtt right",
    "start": "1968480",
    "end": "1973760"
  },
  {
    "text": "unfortunately my official simulator is running inside",
    "start": "1973760",
    "end": "1979100"
  },
  {
    "text": "a browser so I'm in a browser sandbox and I want to create a direct TCP connection to some mqtt port on the",
    "start": "1979100",
    "end": "1985880"
  },
  {
    "text": "internet and that's the point where the browser says no you are not allowed to do that now fortunately mosquito has a",
    "start": "1985880",
    "end": "1993919"
  },
  {
    "text": "solution for that we can use mqtt of a websocket",
    "start": "1993919",
    "end": "1999860"
  },
  {
    "text": "and the way to set it up is you create a second listener in mosquito it that usually use the sport 901",
    "start": "1999860",
    "end": "2006940"
  },
  {
    "text": "and then from my browser I am allowed to create a websockets connection of 901 so",
    "start": "2006940",
    "end": "2012640"
  },
  {
    "text": "I can stream nqtt over websockets to Mosquito that will work and then the double sidecar can still use the direct",
    "start": "2012640",
    "end": "2019120"
  },
  {
    "text": "mqtt connection so everything works out fine unless",
    "start": "2019120",
    "end": "2025240"
  },
  {
    "text": "we're only allowed to open up a single port out of ACA",
    "start": "2025240",
    "end": "2030640"
  },
  {
    "text": "so this is a real bummer and it doesn't even matter if you're uh if you want to expose a port to other internal services",
    "start": "2030640",
    "end": "2038019"
  },
  {
    "text": "or to the outside world it's just you get one port one Ingress so that that's",
    "start": "2038019",
    "end": "2043480"
  },
  {
    "text": "little uh snippet of bicep code I've shown you with the inquest I would really like that to be an array but but",
    "start": "2043480",
    "end": "2050080"
  },
  {
    "text": "it's not so I can only choose between one of these Sports and that's simply not good enough",
    "start": "2050080",
    "end": "2055839"
  },
  {
    "text": "um so what to do here um well I do have this other simulator which is a console application so it",
    "start": "2055839",
    "end": "2063580"
  },
  {
    "text": "doesn't have any um any sandbox it's running in it can't just talk mqtt to that endpoint so that",
    "start": "2063580",
    "end": "2070898"
  },
  {
    "text": "will work but it's just not as nice as the official ones I really like that that",
    "start": "2070899",
    "end": "2076658"
  },
  {
    "text": "upper one so I'm going to over engineer a solution out of this I'm going to just add a whole different application which",
    "start": "2076659",
    "end": "2083919"
  },
  {
    "text": "will act as a bridge all right so I can create an HTTP endpoint that's my visual",
    "start": "2083919",
    "end": "2090398"
  },
  {
    "text": "simulator you can talk to and then my simulation Gateway can talk to that",
    "start": "2090399",
    "end": "2096339"
  },
  {
    "text": "same mqtt endpoint I can use adapter output binding for that so I still don't need to program mqtt stuff myself but",
    "start": "2096339",
    "end": "2103720"
  },
  {
    "text": "this is just a way around that limitation for now notice by the way that my simulation",
    "start": "2103720",
    "end": "2109599"
  },
  {
    "text": "Gateway is simply running on Port 80. and that I'm exposing an https ports to",
    "start": "2109599",
    "end": "2115300"
  },
  {
    "text": "the outside world that's because of this very nice feature that ACA has it can do TLS termination for me so application",
    "start": "2115300",
    "end": "2121960"
  },
  {
    "text": "can actually actually the application tries to connect to the ictp port by default SEO will redirect it to the",
    "start": "2121960",
    "end": "2128440"
  },
  {
    "text": "https Port then do TLS termination and then call my container",
    "start": "2128440",
    "end": "2134260"
  },
  {
    "text": "so this should work emphasis on Shield so",
    "start": "2134260",
    "end": "2141579"
  },
  {
    "text": "let's um let's see so somewhere in this solution is my",
    "start": "2141579",
    "end": "2148660"
  },
  {
    "text": "visual simulation yeah I actually don't need to code or I can show you the code really quick actually",
    "start": "2148660",
    "end": "2156099"
  },
  {
    "text": "um no not this one I meant to show you the",
    "start": "2156099",
    "end": "2161500"
  },
  {
    "text": "code for the simulation Gateway which is this",
    "start": "2161500",
    "end": "2166960"
  },
  {
    "text": "so this just consists of these two endpoints these are called by the official",
    "start": "2166960",
    "end": "2172359"
  },
  {
    "text": "simulation and the only thing I need to do is invoke that Dapper binding to just push everything through to Mosquito and",
    "start": "2172359",
    "end": "2179140"
  },
  {
    "text": "I can simply reuse those existing entry game and exit Game components that I've already cut set up",
    "start": "2179140",
    "end": "2186720"
  },
  {
    "text": "now I'm going to start this visual simulation with just a",
    "start": "2187359",
    "end": "2192760"
  },
  {
    "text": "net application hosting a website for me and then should be able to go to Port",
    "start": "2192760",
    "end": "2199480"
  },
  {
    "text": "5000 and we have these nice cars driving around on the road",
    "start": "2199480",
    "end": "2206260"
  },
  {
    "text": "um so we can follow them a bit see if they reach the exit maybe two",
    "start": "2206260",
    "end": "2211900"
  },
  {
    "text": "miles so we can see your trajectory so while they are driving underneath these cameras events will be generated and",
    "start": "2211900",
    "end": "2218020"
  },
  {
    "text": "pushed up to that surface um and actually what I'm going to do because as soon as I do this the",
    "start": "2218020",
    "end": "2225640"
  },
  {
    "text": "animation stops and it stops generating events so just to keep the flow going",
    "start": "2225640",
    "end": "2232420"
  },
  {
    "text": "I need to keep that window at least somewhat visible so I'm just going to put it slightly behind",
    "start": "2232420",
    "end": "2238960"
  },
  {
    "text": "here and this will work so now if we start out because this is timed out but",
    "start": "2238960",
    "end": "2244300"
  },
  {
    "text": "if we connect back to the logs oh and I want to connect to the turf control servers",
    "start": "2244300",
    "end": "2250119"
  },
  {
    "text": "you can see the entry and the exit events going by and if you have really sharp eyesights you can also see some",
    "start": "2250119",
    "end": "2256060"
  },
  {
    "text": "speeding violations in there but they tend to scroll by pretty quickly so this",
    "start": "2256060",
    "end": "2261339"
  },
  {
    "text": "is working great the simulation is going through that simulation Gateway it's going through mosquito and is pushing it",
    "start": "2261339",
    "end": "2266440"
  },
  {
    "text": "up into this traffic control surface all right",
    "start": "2266440",
    "end": "2271960"
  },
  {
    "text": "um let's pause this for a minute here",
    "start": "2271960",
    "end": "2277079"
  },
  {
    "text": "and let's talk about the next surface on our list",
    "start": "2277240",
    "end": "2283540"
  },
  {
    "text": "which is the Fine Collection servers so the traffic control service has done its",
    "start": "2283540",
    "end": "2289180"
  },
  {
    "text": "thing it can detect spinning violation and it publishes a speeding file as an event whenever it encounters one and",
    "start": "2289180",
    "end": "2295060"
  },
  {
    "text": "then the Fine Collection Service needs to subscribe to those events and do something with it",
    "start": "2295060",
    "end": "2301180"
  },
  {
    "text": "um so this works in the same way as the input binding did so you may say hey",
    "start": "2301180",
    "end": "2306220"
  },
  {
    "text": "isn't there some kind of Outlet why aren't you using the pub sub building block for the mqtt Gateway that would be",
    "start": "2306220",
    "end": "2312640"
  },
  {
    "text": "a fair question so there is some overlap between Bunnings and Pub sub the main",
    "start": "2312640",
    "end": "2318339"
  },
  {
    "text": "difference is that uh bindings don't care about message Brokers so you may",
    "start": "2318339",
    "end": "2324460"
  },
  {
    "text": "create a binding for message broker but it doesn't have to be a message broker so bindings can",
    "start": "2324460",
    "end": "2329740"
  },
  {
    "text": "integrate with all kinds of things whereas the pub sub message block really",
    "start": "2329740",
    "end": "2334960"
  },
  {
    "text": "has to work with message Brokers and because of that higher level of abstraction it provides a little bit",
    "start": "2334960",
    "end": "2341260"
  },
  {
    "text": "more features like message duplication and routing and tracing and to provide those",
    "start": "2341260",
    "end": "2348579"
  },
  {
    "text": "features it needs to wrap those messages inside a cloud events envelope",
    "start": "2348579",
    "end": "2353740"
  },
  {
    "text": "now I don't care about Cloud events at the side of the cameras the cameras",
    "start": "2353740",
    "end": "2359320"
  },
  {
    "text": "don't know about the cloud defense formats I just want to work with raw basic payloads so that's why I'm using bindings on that side and the pops up",
    "start": "2359320",
    "end": "2367480"
  },
  {
    "text": "building block here to integrate between services but it works basically the same way if",
    "start": "2367480",
    "end": "2373540"
  },
  {
    "text": "you set this up so you subscribe to some topic on the edge service bus and then whenever a message comes in the deposit",
    "start": "2373540",
    "end": "2380920"
  },
  {
    "text": "code will trick my application to do the actual processing of that message um",
    "start": "2380920",
    "end": "2386740"
  },
  {
    "text": "let's look at that processing so we need to calculate an exact file amount so let's say that we use some common of the",
    "start": "2386740",
    "end": "2393520"
  },
  {
    "text": "Shelf products called find kelp to do that for us and in order to use fine calc we need to have a license key to",
    "start": "2393520",
    "end": "2400599"
  },
  {
    "text": "bank help because it's a commercial product so I need to store that license key somewhere safe it's basically a",
    "start": "2400599",
    "end": "2407020"
  },
  {
    "text": "secret right that I need to store somewhere now there are two ways I can store this so first of all",
    "start": "2407020",
    "end": "2413339"
  },
  {
    "text": "ACA itself has a secret store which simply uses the underlying kubernetes",
    "start": "2413339",
    "end": "2418720"
  },
  {
    "text": "Secret store and this is really great if you want to like reference those secrets from scaling rules so you have a service",
    "start": "2418720",
    "end": "2426220"
  },
  {
    "text": "bus scaling rule which needs a connection string to the service bus you can put that inside of ACI Secrets but",
    "start": "2426220",
    "end": "2432700"
  },
  {
    "text": "it's not so great if you want your Dapper applications to be portable because I'm I also want to be able to",
    "start": "2432700",
    "end": "2439420"
  },
  {
    "text": "run this Solution on my laptop right and then I'm not running inside of ACA so I",
    "start": "2439420",
    "end": "2444760"
  },
  {
    "text": "don't have access to any building Secret store of ACA so I want to have something else and that's something else that's of",
    "start": "2444760",
    "end": "2451420"
  },
  {
    "text": "course a building block in this case there are secrets management so I can set up a component",
    "start": "2451420",
    "end": "2457900"
  },
  {
    "text": "to talk to a Secret store which in this case is going to be Azure key fault and then whenever my app needs access to",
    "start": "2457900",
    "end": "2465400"
  },
  {
    "text": "a secret it can just again just like with only build other building blocks it can make a request to the sidecar and it",
    "start": "2465400",
    "end": "2471640"
  },
  {
    "text": "will cut the secret from the key fold and then if I run it locally on my",
    "start": "2471640",
    "end": "2476680"
  },
  {
    "text": "application most of the time I simply use a Dapper or a Secret store component that stores secrets in like environment",
    "start": "2476680",
    "end": "2483280"
  },
  {
    "text": "variables or a Json files stuff that's easy to test with",
    "start": "2483280",
    "end": "2489579"
  },
  {
    "text": "okay so now we can get the license key we can call fine calc so we get the fine amounts then we're just about ready to",
    "start": "2489579",
    "end": "2497260"
  },
  {
    "text": "send the email but in order to do that we need some more information on the vehicle and on the vehicle owner specifically we need to know the email",
    "start": "2497260",
    "end": "2503859"
  },
  {
    "text": "address of the vehicles owner and we can get that information from the vehicle",
    "start": "2503859",
    "end": "2509260"
  },
  {
    "text": "registration service um and that's a really simple service it just exposes an HTTP API that we can",
    "start": "2509260",
    "end": "2515859"
  },
  {
    "text": "query so we could do that directly right just new up ACP client make the call not",
    "start": "2515859",
    "end": "2522579"
  },
  {
    "text": "too much work or we could use Dapper service invocation",
    "start": "2522579",
    "end": "2527619"
  },
  {
    "text": "um which will offer us some benefits so if I use Dapper for this I'm not making",
    "start": "2527619",
    "end": "2533200"
  },
  {
    "text": "a direct call instead of course I'm calling my local Sidecar then the sidebar can do surface Discovery so it",
    "start": "2533200",
    "end": "2540160"
  },
  {
    "text": "can discover where the vehicle registration service actually runs it forwards that request for me and then",
    "start": "2540160",
    "end": "2546520"
  },
  {
    "text": "the remote sidebar will call into the actual servers and then any response will flow back the same way",
    "start": "2546520",
    "end": "2552760"
  },
  {
    "text": "so why codes for all of this trouble well there are a couple of features that you get from Deborah",
    "start": "2552760",
    "end": "2559060"
  },
  {
    "text": "so first of all Dapper can automatically secure the channel between the sidecar so it's a little bit added security by",
    "start": "2559060",
    "end": "2565780"
  },
  {
    "text": "using Mutual TLS um you also get automatic retries so",
    "start": "2565780",
    "end": "2571320"
  },
  {
    "text": "whoever is using poly in their.net services yeah quote quite a couple of you",
    "start": "2571320",
    "end": "2577300"
  },
  {
    "text": "um so with Deborah you don't need to code that yourself you can just create a retry policy in configuration and your",
    "start": "2577300",
    "end": "2583420"
  },
  {
    "text": "Dapper sidecars basically do that retry for you so that's very nice to have",
    "start": "2583420",
    "end": "2588760"
  },
  {
    "text": "um and then finally because all of that traffic flows through the sidecar the sidecars can really help you with observability and things like",
    "start": "2588760",
    "end": "2594700"
  },
  {
    "text": "distributor tracing and writing stuff down to application insights like analytics so there's some nice benefits",
    "start": "2594700",
    "end": "2600880"
  },
  {
    "text": "that you uh that you get so now that we have that information we",
    "start": "2600880",
    "end": "2605920"
  },
  {
    "text": "can really start sending that email so for that I'm using a nice application",
    "start": "2605920",
    "end": "2611260"
  },
  {
    "text": "called Mill Dev who is familiar with Milda up to two people um it's really great if you want to test",
    "start": "2611260",
    "end": "2618579"
  },
  {
    "text": "sending emails because it's basically it explodes an SMTP server and if you send some mail to it you can view it in this",
    "start": "2618579",
    "end": "2625060"
  },
  {
    "text": "really nice UI and you can check if it works and if the email looks like you intended to so it's really nice for",
    "start": "2625060",
    "end": "2630880"
  },
  {
    "text": "debugging and for demos like this um so I've set up increase for Port 25 for that SMTP so that I can use a SMTP",
    "start": "2630880",
    "end": "2638920"
  },
  {
    "text": "output binding to send that email now this binding was actually created by buddy of mine Android phone back who",
    "start": "2638920",
    "end": "2645579"
  },
  {
    "text": "wants to try creating a new component for Dapper it's all open source so if",
    "start": "2645579",
    "end": "2650680"
  },
  {
    "text": "you know any go or if you don't know any go because Edwin also didn't know any girl but if you look at some of the",
    "start": "2650680",
    "end": "2655900"
  },
  {
    "text": "other components it's not that difficult to to pick up you can create your own components and then contribute it back",
    "start": "2655900",
    "end": "2662020"
  },
  {
    "text": "to the project so my code again doesn't need to know anything about SMTP simply going through",
    "start": "2662020",
    "end": "2667599"
  },
  {
    "text": "that binding all right so let me",
    "start": "2667599",
    "end": "2673000"
  },
  {
    "text": "show you some code for design collection servers let's make some room here let's close",
    "start": "2673000",
    "end": "2679599"
  },
  {
    "text": "this one close close",
    "start": "2679599",
    "end": "2682920"
  },
  {
    "text": "don't need this Fine Collection servers program [Music]",
    "start": "2687339",
    "end": "2693520"
  },
  {
    "text": "same thing um I'm using minimal apis here so to",
    "start": "2693520",
    "end": "2698680"
  },
  {
    "text": "subscribe to those speeding violation events I have this event handler and 40",
    "start": "2698680",
    "end": "2703900"
  },
  {
    "text": "pops up middle 40 pops a building block I'm using this with topic methods to do",
    "start": "2703900",
    "end": "2709540"
  },
  {
    "text": "the actual subscription so here I'm telling Deborah I want to use the pops up component named pops up",
    "start": "2709540",
    "end": "2718359"
  },
  {
    "text": "a pretty good name and I want to subscribe to the spinning violations topic and then whenever a message comes",
    "start": "2718359",
    "end": "2724660"
  },
  {
    "text": "in please call this endpoint for me so in this endpoint",
    "start": "2724660",
    "end": "2730540"
  },
  {
    "text": "the first thing I do is I get that license key from uh from configuration",
    "start": "2730540",
    "end": "2737760"
  },
  {
    "text": "so you may wonder how did that license key end up in configuration because I",
    "start": "2737760",
    "end": "2743079"
  },
  {
    "text": "had it stored in the Azure key fold remember so we scroll up a bit",
    "start": "2743079",
    "end": "2748180"
  },
  {
    "text": "then all that magic is being done through the add Dapper Secret store extension method here on the",
    "start": "2748180",
    "end": "2753819"
  },
  {
    "text": "configuration manager so what this does is I tell it which Secret store I'm",
    "start": "2753819",
    "end": "2759099"
  },
  {
    "text": "using and then it will get all the secrets from that store it doesn't have to be all the secrets by the way if you",
    "start": "2759099",
    "end": "2765700"
  },
  {
    "text": "just want to get a couple of keys you can also specify this in an offload the mic is just getting all these secrets",
    "start": "2765700",
    "end": "2771839"
  },
  {
    "text": "and it's putting them inside of the net configuration framework so it's available as you would normally access",
    "start": "2771839",
    "end": "2779400"
  },
  {
    "text": "configuration stuff now this parameter here is a delimiter",
    "start": "2779400",
    "end": "2785680"
  },
  {
    "text": "that I want to use to create hierarchies because in.net configuration",
    "start": "2785680",
    "end": "2791920"
  },
  {
    "text": "has hierarchies so this means that if I have something like this in my key fault my connection strings database",
    "start": "2791920",
    "end": "2800200"
  },
  {
    "text": "oh double hyphen um this will get parsed into a",
    "start": "2800200",
    "end": "2806440"
  },
  {
    "text": "connection string section with the database key under it and the reason I'm using double hyphens here is as that",
    "start": "2806440",
    "end": "2812920"
  },
  {
    "text": "separators because Azure default actually only supports Alpha numerical characters and hyphen characters inside",
    "start": "2812920",
    "end": "2819700"
  },
  {
    "text": "the key names so that will load everything into.net configuration and then for my actual code I can just",
    "start": "2819700",
    "end": "2825540"
  },
  {
    "text": "reference it like this um all right so now I have the license",
    "start": "2825540",
    "end": "2830680"
  },
  {
    "text": "key I can use the find calculator to calculate that find amount passing in a license key and the",
    "start": "2830680",
    "end": "2837460"
  },
  {
    "text": "violation I cut back the amount of euros and now I need to make that call to the",
    "start": "2837460",
    "end": "2842560"
  },
  {
    "text": "vehicle registration servers with Dapper service invocation and there are a couple of ways to do that the way I'm",
    "start": "2842560",
    "end": "2848740"
  },
  {
    "text": "doing it here is what they recommend and that's by using a special type of",
    "start": "2848740",
    "end": "2855099"
  },
  {
    "text": "HTTP client so I've created ACP client by calling",
    "start": "2855099",
    "end": "2860500"
  },
  {
    "text": "this debit client create info kcp client and that will new up an HTTP client for me but with a very special message",
    "start": "2860500",
    "end": "2866740"
  },
  {
    "text": "Handler and then message Handler allows me to use URLs like this",
    "start": "2866740",
    "end": "2872560"
  },
  {
    "text": "which are really Compact and and functional so the hostname here in this",
    "start": "2872560",
    "end": "2877720"
  },
  {
    "text": "URL is the Debra application ID of the application that I like to call and then",
    "start": "2877720",
    "end": "2884079"
  },
  {
    "text": "Depot will do the search Discovery and discover where that application actually is and then all the other stuff in the",
    "start": "2884079",
    "end": "2890560"
  },
  {
    "text": "URL is simply the route that I want to call on that application so what that message Handler actually does under the",
    "start": "2890560",
    "end": "2897099"
  },
  {
    "text": "hood is it will take this URL and it will rewrite it to something like this",
    "start": "2897099",
    "end": "2904020"
  },
  {
    "text": "to a call on my local sidecar which is running on 3500 upgrade it's out",
    "start": "2904180",
    "end": "2909520"
  },
  {
    "text": "completing saved me from making a lot of typing errors so it will rewrite it to this way",
    "start": "2909520",
    "end": "2916180"
  },
  {
    "text": "longer URL which is a call to my local sidecar and that will perform the actual request so being able to use just HTTP",
    "start": "2916180",
    "end": "2924579"
  },
  {
    "text": "client with a shorter URLs is really nice if you have an existing application that you want to depth rise because then",
    "start": "2924579",
    "end": "2930940"
  },
  {
    "text": "most probably only need to chase some host names here and there and and you're done",
    "start": "2930940",
    "end": "2937240"
  },
  {
    "text": "so now that we get back the vehicle info I can put everything together and inform",
    "start": "2937240",
    "end": "2943839"
  },
  {
    "text": "a couple of other components that I've now calculated Define there are more than one component that wants to know",
    "start": "2943839",
    "end": "2949839"
  },
  {
    "text": "about this so again I'm going to do this using events I'm going to create a fine calculated event which contains that",
    "start": "2949839",
    "end": "2956319"
  },
  {
    "text": "fine amount and also the email address and some other stuff like the vehicle brand and model don't know why that's a",
    "start": "2956319",
    "end": "2963040"
  },
  {
    "text": "thing but it's in there and then I'm going to publish that event back to the surface bus so anyone interested can now",
    "start": "2963040",
    "end": "2970839"
  },
  {
    "text": "handle that defense and do some cool stuff with it any first component that's interested in",
    "start": "2970839",
    "end": "2977440"
  },
  {
    "text": "this is actually the fan collection service itself um because this is listening on that fines",
    "start": "2977440",
    "end": "2984220"
  },
  {
    "text": "topic and it's forwarding calls to Define calculated endpoint in order to",
    "start": "2984220",
    "end": "2989619"
  },
  {
    "text": "send that email but now it's nicely decoupled from each other",
    "start": "2989619",
    "end": "2994900"
  },
  {
    "text": "so um here we first create the email body then we set up some metadata like the",
    "start": "2994900",
    "end": "3001680"
  },
  {
    "text": "from anniversary to address and subjects and then I can call the invoke binding",
    "start": "3001680",
    "end": "3007980"
  },
  {
    "text": "to executed SMTP binding and that will send the email",
    "start": "3007980",
    "end": "3013880"
  },
  {
    "text": "so let me see where we are this would probably be a good time to show you",
    "start": "3015020",
    "end": "3020160"
  },
  {
    "text": "those emails and that it actually works but unfortunately surprise surprise",
    "start": "3020160",
    "end": "3026400"
  },
  {
    "text": "we're running into that same annoying issue because this is the nice UI that Mill deaf gets gives me it's running",
    "start": "3026400",
    "end": "3033900"
  },
  {
    "text": "somewhere in the environment I've already cut Port 25 setup for SMTP",
    "start": "3033900",
    "end": "3039060"
  },
  {
    "text": "increase so I cannot set up a different port to access my UI",
    "start": "3039060",
    "end": "3044220"
  },
  {
    "text": "so now I have this UI but again because only one port can be used for Ingress I",
    "start": "3044220",
    "end": "3050160"
  },
  {
    "text": "cannot reach it which is pretty annoying and we'll have to offer engineer another",
    "start": "3050160",
    "end": "3056339"
  },
  {
    "text": "solution for this so this is another container map I've created just to create an alternative dashboard to view",
    "start": "3056339",
    "end": "3062880"
  },
  {
    "text": "the fines so it will need to have access to the fines data as well so the way it's going",
    "start": "3062880",
    "end": "3068520"
  },
  {
    "text": "to do that it's going to subscribe again through Dapper Pub sub do the same find calculated events and then I'll create a",
    "start": "3068520",
    "end": "3074940"
  },
  {
    "text": "materialized view put it in a Azure SQL database and I'm just using normal",
    "start": "3074940",
    "end": "3080400"
  },
  {
    "text": "Entity framework for that so I'm don't use any Dapper for this we may want to",
    "start": "3080400",
    "end": "3085920"
  },
  {
    "text": "do some more complex queries in the future on that data so Azure SQL seems to be a better fit for that than that",
    "start": "3085920",
    "end": "3092460"
  },
  {
    "text": "per state management um basically then the only thing I have to do that's left to do is set up increase",
    "start": "3092460",
    "end": "3098880"
  },
  {
    "text": "for this and then anybody who knows the URL can see that find data so that's great",
    "start": "3098880",
    "end": "3104520"
  },
  {
    "text": "um that's also horrible even for government agencies this is really bad security if everybody who knows the URL",
    "start": "3104520",
    "end": "3110700"
  },
  {
    "text": "can see the fines data so we need to set up some authorization now fortunately ACA has this really nice",
    "start": "3110700",
    "end": "3119119"
  },
  {
    "text": "built-in TurnKey authentication feature it's sometimes also called easy author",
    "start": "3119119",
    "end": "3124440"
  },
  {
    "text": "you may recognize this this from Azure app Services it's basically this the same feature that I've also offered here",
    "start": "3124440",
    "end": "3132000"
  },
  {
    "text": "so how this works is when I set this up I cut some authentication middleware",
    "start": "3132000",
    "end": "3138480"
  },
  {
    "text": "injected into the request Pipeline and so that's just another container already request goes to so if the perhaps makes",
    "start": "3138480",
    "end": "3145500"
  },
  {
    "text": "a request it first hits that authentication middleware that will take care of any of authenticating the",
    "start": "3145500",
    "end": "3151980"
  },
  {
    "text": "clients and of managing the authentication sessions and then it will forward the request to my Thrift control",
    "start": "3151980",
    "end": "3157079"
  },
  {
    "text": "UI and you can use all kinds of identity providers with this so I'm",
    "start": "3157079",
    "end": "3163140"
  },
  {
    "text": "using Azure active directory you can also use other social logins like Google Facebook Twitter if that's still a thing",
    "start": "3163140",
    "end": "3170960"
  },
  {
    "text": "you can basically use any open ID connects profile here and then there are two flavors you can",
    "start": "3170960",
    "end": "3178680"
  },
  {
    "text": "use you can tell the authentication middleware to only let authenticated requests true so as long as the user is",
    "start": "3178680",
    "end": "3186599"
  },
  {
    "text": "authenticated they will never be able to reach your application or and that's what I'm doing you can set it to",
    "start": "3186599",
    "end": "3192540"
  },
  {
    "text": "Anonymous and that means that unauthentic cage users will also get through and you can show like a home",
    "start": "3192540",
    "end": "3198900"
  },
  {
    "text": "page with the login button and stuff like that so let me show you what that looks like",
    "start": "3198900",
    "end": "3207440"
  },
  {
    "text": "um let me first go to the Irish portal",
    "start": "3207839",
    "end": "3213839"
  },
  {
    "text": "and then I'm going back to the resource Group and here is my 12 control UI so this is the app",
    "start": "3213839",
    "end": "3220920"
  },
  {
    "text": "and here up in the essentials section you can see the application URL",
    "start": "3220920",
    "end": "3226319"
  },
  {
    "text": "so if I go there this is my nice dashboard let me see let's go in a little bit",
    "start": "3226319",
    "end": "3232859"
  },
  {
    "text": "all right so um there's not much to this dashboard yet I do have one option here to go to",
    "start": "3232859",
    "end": "3238980"
  },
  {
    "text": "the fines and as you might expect if I go to the files I'm not authorized which is exactly what I want so that's great",
    "start": "3238980",
    "end": "3246540"
  },
  {
    "text": "so let me show you how this works in the code now the reason I get that unauthorized",
    "start": "3246540",
    "end": "3252480"
  },
  {
    "text": "is because in the app and by the way this is a Blazer server app so on this page",
    "start": "3252480",
    "end": "3259800"
  },
  {
    "text": "I've decorated I've added the attributes for authorize so this will check",
    "start": "3259800",
    "end": "3265500"
  },
  {
    "text": "do we have an authentication token no we don't so you're not allowed to see this page right",
    "start": "3265500",
    "end": "3271319"
  },
  {
    "text": "um so now we need to create that login code so it's just going to be difficult nope",
    "start": "3271319",
    "end": "3278579"
  },
  {
    "text": "um this is really easy so in our main layout I've just created if you're not",
    "start": "3278579",
    "end": "3284040"
  },
  {
    "text": "authorized of creating a link going to dot all slash login slash aad and I added the aid part because I'm using",
    "start": "3284040",
    "end": "3290880"
  },
  {
    "text": "Azure active directory so what this means is all the requests with DOT auth will get",
    "start": "3290880",
    "end": "3297119"
  },
  {
    "text": "intercepted by that authentication middleware and it will take care of all the oauth",
    "start": "3297119",
    "end": "3302280"
  },
  {
    "text": "stuff that needs to be done and then after that's done it will redirect back to my application",
    "start": "3302280",
    "end": "3309300"
  },
  {
    "text": "um so yeah let's let's see if that works so it's going to be quick because probably",
    "start": "3309300",
    "end": "3315420"
  },
  {
    "text": "I'm already locked into Azure ID so it will just bounce back directly or it may",
    "start": "3315420",
    "end": "3321059"
  },
  {
    "text": "show me a login page let's see what happens no it's uh it's already detected it I'm already logged into Azure so now",
    "start": "3321059",
    "end": "3329579"
  },
  {
    "text": "I'm logged in you can see it knows my email address that's from a claim in the in the token so",
    "start": "3329579",
    "end": "3336420"
  },
  {
    "text": "how does Blazer know what my claims are right because the",
    "start": "3336420",
    "end": "3342180"
  },
  {
    "text": "authentication was done by that other container so how does it get access to the claims data well that works with a",
    "start": "3342180",
    "end": "3350940"
  },
  {
    "text": "HTTP request header so if we go to the very start of my",
    "start": "3350940",
    "end": "3357480"
  },
  {
    "text": "application then you can see that I here I try to get this this XMS client principle",
    "start": "3357480",
    "end": "3364800"
  },
  {
    "text": "request header from the incoming request now this is only set if I'm authenticated",
    "start": "3364800",
    "end": "3371940"
  },
  {
    "text": "and it's basically a basic C4 encode adjson documents which contains my token",
    "start": "3371940",
    "end": "3379200"
  },
  {
    "text": "and all of the claims that are set um now due to the way that Blazer server",
    "start": "3379200",
    "end": "3384660"
  },
  {
    "text": "works you cannot simply access the acdp context from anywhere your application so they recommend that you do it in the",
    "start": "3384660",
    "end": "3391740"
  },
  {
    "text": "OCS HTML so here I try to detect if we've got that principle and if we do I",
    "start": "3391740",
    "end": "3398940"
  },
  {
    "text": "deserialize it I parsed into this Ms client principal object and I pass it into my application using this parameter",
    "start": "3398940",
    "end": "3405660"
  },
  {
    "text": "syntax here and that will inject it into this app.racer",
    "start": "3405660",
    "end": "3410720"
  },
  {
    "text": "and here when my application initializes I use my own authentication State",
    "start": "3410720",
    "end": "3417240"
  },
  {
    "text": "provider so this is an object that well does as it says on the tin it provides",
    "start": "3417240",
    "end": "3423180"
  },
  {
    "text": "authentication states to to Blazer and I've created my own called easy all",
    "start": "3423180",
    "end": "3428880"
  },
  {
    "text": "state provider so what this does I said we'll check if that client",
    "start": "3428880",
    "end": "3434040"
  },
  {
    "text": "principle was set if it is we can create a new claims identity using all those claims and all",
    "start": "3434040",
    "end": "3439619"
  },
  {
    "text": "that information coming originally from that header if it wasn't set we're unauthorized we",
    "start": "3439619",
    "end": "3445380"
  },
  {
    "text": "just create an empty claims identity and Blaze will recognize that as unauthorized and then we wrap this and identity sorry",
    "start": "3445380",
    "end": "3453119"
  },
  {
    "text": "into a principle and then we wrap authentication State around that principle and that we return to Blazer",
    "start": "3453119",
    "end": "3459420"
  },
  {
    "text": "and now Blazer knows about our claims and it knows if we're authorized or not",
    "start": "3459420",
    "end": "3464760"
  },
  {
    "text": "so coming back we can now go to Defiance page and this",
    "start": "3464760",
    "end": "3470099"
  },
  {
    "text": "will work now let me just add some load on this so I'm going back",
    "start": "3470099",
    "end": "3475980"
  },
  {
    "text": "here we should see mostly most of time it takes a couple of",
    "start": "3475980",
    "end": "3481380"
  },
  {
    "text": "seconds for somebody to drive too fast but if August will then yeah there is a",
    "start": "3481380",
    "end": "3486960"
  },
  {
    "text": "new one and it's going pretty good actually I think we are almost at two grand right",
    "start": "3486960",
    "end": "3492780"
  },
  {
    "text": "now since I've started uh testing these demo so yeah it's a lucrative business",
    "start": "3492780",
    "end": "3498119"
  },
  {
    "text": "um all right I think um just about a time so let me quickly wrap this",
    "start": "3498119",
    "end": "3505920"
  },
  {
    "text": "up so all in all I'm um I really like Azure container apps I also really like",
    "start": "3505920",
    "end": "3511740"
  },
  {
    "text": "uh Debra but there are some definite limitations with the combination of",
    "start": "3511740",
    "end": "3517079"
  },
  {
    "text": "those two um so first of all and actually the most annoying of all is that single board",
    "start": "3517079",
    "end": "3522540"
  },
  {
    "text": "inquest that really took me by surprise if I'm hitting it two times in a what is",
    "start": "3522540",
    "end": "3528059"
  },
  {
    "text": "a pretty simple demo scenario and if I think through some of the production scenarios and my clients I can think of",
    "start": "3528059",
    "end": "3534900"
  },
  {
    "text": "a lot of uh examples where single port simply isn't good enough",
    "start": "3534900",
    "end": "3540000"
  },
  {
    "text": "um there is some discussion in the GitHub issues about this more people wanting this but as far as I know it's",
    "start": "3540000",
    "end": "3546660"
  },
  {
    "text": "not on the official world map yet but keep fingers crossed um then the other pretty big limitation",
    "start": "3546660",
    "end": "3553920"
  },
  {
    "text": "is around configuration so all of the configuration I've shown you is at the",
    "start": "3553920",
    "end": "3559799"
  },
  {
    "text": "component level it's for configuring components but there's an entirely other level of configuration in Dapper which",
    "start": "3559799",
    "end": "3566280"
  },
  {
    "text": "is called the application configuration and you use that to set some Advanced features like you you want to use some",
    "start": "3566280",
    "end": "3573480"
  },
  {
    "text": "preview features or you want to specify which sources allowed to call which other services we want to inject your",
    "start": "3573480",
    "end": "3579599"
  },
  {
    "text": "own custom middleware in between your application and your sidecar and those",
    "start": "3579599",
    "end": "3584940"
  },
  {
    "text": "are nice and useful features but I can't use those because ACA doesn't allow me",
    "start": "3584940",
    "end": "3590339"
  },
  {
    "text": "to specify my own configuration file now they may servers these features in different kind",
    "start": "3590339",
    "end": "3597480"
  },
  {
    "text": "of way make make it accessible without you having to specify a complete configuration file but most of these",
    "start": "3597480",
    "end": "3603359"
  },
  {
    "text": "things here aren't available yet to use in in Asia yet and very quickly the final thing is I",
    "start": "3603359",
    "end": "3610500"
  },
  {
    "text": "cannot specify which version of Deborah I want to run um which may or may not be a big problem",
    "start": "3610500",
    "end": "3616440"
  },
  {
    "text": "for you um so right now they are running I think what's this uh 195 or 196 the latest",
    "start": "3616440",
    "end": "3623819"
  },
  {
    "text": "version and I believe I've read somewhere in GitHub issues that they aim to go to the new version like three to",
    "start": "3623819",
    "end": "3631319"
  },
  {
    "text": "four weeks after the latest deprivation has been released but in the past there",
    "start": "3631319",
    "end": "3636540"
  },
  {
    "text": "definitely has been some breaking changes in Dapper so I start to wonder what if I'm running my",
    "start": "3636540",
    "end": "3643079"
  },
  {
    "text": "production system and then they decide to upgrade from debra1. whatever to Dapper 2 is my system still going to",
    "start": "3643079",
    "end": "3650040"
  },
  {
    "text": "work or am I going to have to deal with breaking changes so ideally I do not",
    "start": "3650040",
    "end": "3655380"
  },
  {
    "text": "only want to have a deeper enabled or disabled Taco but ideally I want to specify which version I can I'm using in",
    "start": "3655380",
    "end": "3662700"
  },
  {
    "text": "my Azure container environment um all of that said this is basically still",
    "start": "3662700",
    "end": "3669839"
  },
  {
    "text": "pretty early days uh the team is iterating pretty fast with new features uh so yeah it's going to be an",
    "start": "3669839",
    "end": "3675900"
  },
  {
    "text": "interesting year to see if some of this will get on the roadmap um so now I'm definitely at time and I",
    "start": "3675900",
    "end": "3681299"
  },
  {
    "text": "don't want to keep you from lunch uh so thank you so much for joining uh me today all of the source code is",
    "start": "3681299",
    "end": "3687119"
  },
  {
    "text": "available on my GitHub if you want to know more about Dapper I've written a free ebook which is available on the",
    "start": "3687119",
    "end": "3693680"
  },
  {
    "text": "Microsoft site I'm a co-author along with two other guys and I also have this.net video webcast thingy which you",
    "start": "3693680",
    "end": "3701460"
  },
  {
    "text": "may also like so thank you very much and if I create rest of the conference",
    "start": "3701460",
    "end": "3707540"
  },
  {
    "text": "oh and by the way if there are any questions I'll be here for the um well",
    "start": "3711059",
    "end": "3716819"
  },
  {
    "text": "coming minutes uh and I'm here all week so just find me at a conference if you",
    "start": "3716819",
    "end": "3722880"
  },
  {
    "text": "if you want to chat",
    "start": "3722880",
    "end": "3725660"
  }
]