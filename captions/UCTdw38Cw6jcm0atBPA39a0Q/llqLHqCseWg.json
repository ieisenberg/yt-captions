[
  {
    "start": "0",
    "end": "308000"
  },
  {
    "text": "welcome everyone Welcome to our talk this is the first time that we're presenting this talk and presenting",
    "start": "0",
    "end": "5220"
  },
  {
    "text": "together uh these two topics and we're going to talk about abusing GitHub for Fun and Profit talking about actions and",
    "start": "5220",
    "end": "12719"
  },
  {
    "text": "code spaces security so I did the research around GitHub actions and he did the research on code spaces and",
    "start": "12719",
    "end": "19440"
  },
  {
    "text": "we're gonna talk together here about these two topics related to GitHub my name is Magna Logan and this is nitash",
    "start": "19440",
    "end": "26640"
  },
  {
    "text": "we work for Trend Micro so just a little bit of introduction",
    "start": "26640",
    "end": "31920"
  },
  {
    "text": "about myself I'm originally from Brazil I've been in Canada for five years now",
    "start": "31920",
    "end": "37200"
  },
  {
    "text": "um I practiced martial arts and I'm part of the nebula team this is our threat research team inside Trend Micro we",
    "start": "37200",
    "end": "44100"
  },
  {
    "text": "focus on cloud and container security I also have a Blog called Katana security",
    "start": "44100",
    "end": "50039"
  },
  {
    "text": "I'm an instructor for go hacking cyber security company back in Brazil the best",
    "start": "50039",
    "end": "55980"
  },
  {
    "text": "way to reach out to me is through Linkedin so this is the QR code I promise there is no malware there and",
    "start": "55980",
    "end": "62100"
  },
  {
    "text": "yeah I'll hand it over to nitash to introduce himself so my name is nitesh and I work in Trend",
    "start": "62100",
    "end": "69000"
  },
  {
    "text": "Micro we're in the same team we are called nebula and I'm a senior threat researcher with two years of experience",
    "start": "69000",
    "end": "74939"
  },
  {
    "text": "and professionally I've been working for three years now and so previously I have worked in a security operations uh",
    "start": "74939",
    "end": "82320"
  },
  {
    "text": "Center where I have performed a threatened threat intelligence threat hunting so working on ransomware cases",
    "start": "82320",
    "end": "89100"
  },
  {
    "text": "and previously uh I have started liking to break things so I've reported uh bugs",
    "start": "89100",
    "end": "96360"
  },
  {
    "text": "in Android apps with over 21 million plus downloads I've reported security issues to the US Department of Defense",
    "start": "96360",
    "end": "103500"
  },
  {
    "text": "and I've broken my own home router and found some bugs there as well so I had",
    "start": "103500",
    "end": "108720"
  },
  {
    "text": "this Knack of things and then I joined Trend Micro so uh in Trend Micro uh we",
    "start": "108720",
    "end": "115920"
  },
  {
    "text": "work on specifically Cloud native security so like we try to find out vulnerabilities threat models issues",
    "start": "115920",
    "end": "122460"
  },
  {
    "text": "with the tech that you guys are using and we do that before the bad guys do so",
    "start": "122460",
    "end": "128220"
  },
  {
    "text": "that's how we build detections we find novel ways of exploiting some sort of vulnerability and yeah",
    "start": "128220",
    "end": "135660"
  },
  {
    "text": "so I'm also a member of the null open security community so it's uh it's a",
    "start": "135660",
    "end": "141239"
  },
  {
    "text": "community like oasp where we generally discuss about how to break and how to",
    "start": "141239",
    "end": "146940"
  },
  {
    "text": "fix things so we do that for free and like it's all over the world you can take a look I'm also a beginner vocalist",
    "start": "146940",
    "end": "153540"
  },
  {
    "text": "and guitarist so I know that there is a good music scene in Oslo so like maybe we can hang out sometime soon and that's",
    "start": "153540",
    "end": "159900"
  },
  {
    "text": "my link tree and the QR so we can connect there yep sounds good awesome",
    "start": "159900",
    "end": "166080"
  },
  {
    "text": "so this is the agenda for today we're gonna start with code spaces we're going to talk about some some of the features",
    "start": "166080",
    "end": "172260"
  },
  {
    "text": "there how it works if you haven't used it uh uh and then a real world abuse",
    "start": "172260",
    "end": "177720"
  },
  {
    "text": "something that we published earlier this year and now attackers are also",
    "start": "177720",
    "end": "182819"
  },
  {
    "text": "exploiting that already and of course at the end we have some recommendations if you're just like if you're a developer",
    "start": "182819",
    "end": "189120"
  },
  {
    "text": "if you're working for a company that it's using Code spaces then you're gonna learn more about how to protect yourself",
    "start": "189120",
    "end": "194280"
  },
  {
    "text": "and your environments and then we're gonna cover GitHub actions uh abusing",
    "start": "194280",
    "end": "200099"
  },
  {
    "text": "Runners so how attackers are exploiting those VMS that basically run on Azure to",
    "start": "200099",
    "end": "205379"
  },
  {
    "text": "mine cryptocurrencies uh also understand the idea of third-party GitHub actions",
    "start": "205379",
    "end": "212220"
  },
  {
    "text": "malicious anyone can publish actions to the marketplace and some malicious actions can be there as well and of",
    "start": "212220",
    "end": "219480"
  },
  {
    "text": "course again some protections some countermeasures uh to prevent yourself from any attacks so all start with his",
    "start": "219480",
    "end": "227640"
  },
  {
    "text": "sport thank you",
    "start": "227640",
    "end": "232879"
  },
  {
    "text": "so let me tell you a story to begin with back in 2021 on one of our honey pots",
    "start": "233040",
    "end": "239280"
  },
  {
    "text": "that we had exposed publicly we got an exploitation attempt where there was an attempt to exploit various",
    "start": "239280",
    "end": "246360"
  },
  {
    "text": "vulnerabilities and well-known applications like Apache HTTP server or actual web logic server where the",
    "start": "246360",
    "end": "253019"
  },
  {
    "text": "attackers were abusing GitHub and netlify to host their crypto miners so they would just download the crypto",
    "start": "253019",
    "end": "259199"
  },
  {
    "text": "miners from GitHub or netlify and they would execute that in the victim environment uh so in this blog mentioned",
    "start": "259199",
    "end": "266699"
  },
  {
    "text": "uh we discuss about the details so the crypto miners actually Target windows and Linux environments both",
    "start": "266699",
    "end": "274139"
  },
  {
    "text": "since uh we all believe in like P Caps or it did not happen so here we see an",
    "start": "274139",
    "end": "280020"
  },
  {
    "text": "attempt to exploit a vulnerability which is known as Apache HTTP server remote code execution vulnerability and in the",
    "start": "280020",
    "end": "287460"
  },
  {
    "text": "uh in the body of this post request we see the header set to Raw dot",
    "start": "287460",
    "end": "294680"
  },
  {
    "text": "githubusercontent.com so basically this downloads a shell script from the GitHub CDN and executes this on the victim's",
    "start": "294680",
    "end": "302820"
  },
  {
    "text": "environment which in turn downloads a crypto Miner and mine's cryptocurrency",
    "start": "302820",
    "end": "308100"
  },
  {
    "start": "308000",
    "end": "308000"
  },
  {
    "text": "so the infection chain of this entire thing was as follows",
    "start": "308100",
    "end": "315180"
  },
  {
    "text": "yeah so was as follows so the attacker exploits a vulnerability on a vulnerable service and then there is a",
    "start": "315180",
    "end": "322259"
  },
  {
    "text": "communication with GitHub on amplify via https and since these are generally",
    "start": "322259",
    "end": "327479"
  },
  {
    "text": "trusted uh domains for it organizations this would not trigger a generic tools",
    "start": "327479",
    "end": "334979"
  },
  {
    "text": "to detect all of this abuse and once it downloads the malware from GitHub it",
    "start": "334979",
    "end": "340320"
  },
  {
    "text": "executes on the vulnerable host and it hijacks compute resources to mine cryptocurrency so this was the General",
    "start": "340320",
    "end": "346440"
  },
  {
    "text": "flow of the entire thing so the reason behind showing uh this is this is a very",
    "start": "346440",
    "end": "352199"
  },
  {
    "text": "straightforward story that has been observed time and again where GitHub is",
    "start": "352199",
    "end": "357419"
  },
  {
    "text": "being used to host malware and attackers downloaded from there and it does not get flagged by",
    "start": "357419",
    "end": "362600"
  },
  {
    "text": "antivirus vendors so with this story in mind when attackers are actually using",
    "start": "362600",
    "end": "368520"
  },
  {
    "text": "the platform I mean abusing the platform we take a look into code spaces",
    "start": "368520",
    "end": "373979"
  },
  {
    "text": "so how many of us have used code spaces before or have heard of it just a show",
    "start": "373979",
    "end": "381000"
  },
  {
    "text": "offense okay thank you so uh code spaces are basically fully featured uh cloud-based",
    "start": "381000",
    "end": "389039"
  },
  {
    "text": "development environments which comes with a lot of tools libraries uh bundled within the environment it is uh",
    "start": "389039",
    "end": "396660"
  },
  {
    "text": "basically a development environment is a Docker container in which you find all your tools existing so you can create",
    "start": "396660",
    "end": "404840"
  },
  {
    "text": "virtual Machines of like different uh different configurations like the ram",
    "start": "404840",
    "end": "410639"
  },
  {
    "text": "the CPU the storage can be different for all of the virtual machines so these are isolated virtual machines hosted on",
    "start": "410639",
    "end": "416940"
  },
  {
    "text": "Azure cloud and these were like made available for the users for all GitHub",
    "start": "416940",
    "end": "421979"
  },
  {
    "text": "free users on 9th of November 2022 so it enables coding from anywhere you",
    "start": "421979",
    "end": "428220"
  },
  {
    "text": "just need a browser or the vs code IDE or the GitHub CLI to access the",
    "start": "428220",
    "end": "433919"
  },
  {
    "text": "codespace environment and it also lowers the barrier for folks",
    "start": "433919",
    "end": "439139"
  },
  {
    "text": "to get into software development because it is free and you can create up to two",
    "start": "439139",
    "end": "444780"
  },
  {
    "text": "running code space instances at the same time you get 60 hours of I mean 120 core",
    "start": "444780",
    "end": "450300"
  },
  {
    "text": "hours but with the minimum code is like two so you have 60 hours per month that you can use in code spaces for free",
    "start": "450300",
    "end": "457440"
  },
  {
    "text": "and yeah so additionally any user with a valid GitHub account can create two virtual machines on Azure Cloud for free",
    "start": "457440",
    "end": "465060"
  },
  {
    "text": "so uh the maximum duration for that virtual",
    "start": "465060",
    "end": "471720"
  },
  {
    "text": "machine uh like the default idle timeout the maximum time can be set to 40",
    "start": "471720",
    "end": "477060"
  },
  {
    "text": "minutes so that means when you create a code space instance and if you just leave it running you can have the code",
    "start": "477060",
    "end": "483180"
  },
  {
    "text": "space up for four hours if you have like modified the default from 30 minutes to to 40 minutes and the retention period",
    "start": "483180",
    "end": "490319"
  },
  {
    "text": "for code spaces is uh 30 days like the default and the maximum value so what that means is if you stop a code space",
    "start": "490319",
    "end": "497900"
  },
  {
    "text": "uh it is it will be deleted after 30 after 30 days of inactivity so with",
    "start": "497900",
    "end": "503819"
  },
  {
    "text": "these uh pointers in mind let's think like this uh since any user",
    "start": "503819",
    "end": "509940"
  },
  {
    "text": "with a valid GitHub account they can create a code space instance what could a user with malicious intends",
    "start": "509940",
    "end": "516839"
  },
  {
    "text": "to so previous instances of abuse of GitHub have been observed like we just we saw",
    "start": "516839",
    "end": "523140"
  },
  {
    "text": "the abuse where cryptocurrency miners are downloaded from GitHub GitHub",
    "start": "523140",
    "end": "528600"
  },
  {
    "text": "actions like the stuff that Magnum has done before the idea was how long would it take for",
    "start": "528600",
    "end": "533940"
  },
  {
    "text": "attackers to actually abuse code spaces so we started to look into it before them probably and so we put on our hats",
    "start": "533940",
    "end": "541500"
  },
  {
    "text": "and started looking into this code spaces feature from an attacker's point of view",
    "start": "541500",
    "end": "547279"
  },
  {
    "text": "uh yeah so code spaces has a feature in which you can expose a port on the",
    "start": "547920",
    "end": "554820"
  },
  {
    "text": "virtual machine I mean on the container and then the virtual machine and then to the Internet so this is a very helpful",
    "start": "554820",
    "end": "560760"
  },
  {
    "text": "feature for developers because you are working on your code you want to test or debug how does your application look you",
    "start": "560760",
    "end": "566339"
  },
  {
    "text": "can just expose the port and you can access it so the ports on a code space they can be",
    "start": "566339",
    "end": "572899"
  },
  {
    "text": "forwarded in three ways private private to the organization and public so",
    "start": "572899",
    "end": "578399"
  },
  {
    "text": "private uh so when you forward a port privately so you can access the port all by yourself private to the organization",
    "start": "578399",
    "end": "585120"
  },
  {
    "text": "anybody in your GitHub organization can access the port on the code space provided they have the full URL and",
    "start": "585120",
    "end": "592500"
  },
  {
    "text": "public is accessible to anyone without any authentication they just need to",
    "start": "592500",
    "end": "597779"
  },
  {
    "text": "know the entire URL so we created a code space based on the",
    "start": "597779",
    "end": "604800"
  },
  {
    "text": "blank template and we start a python based HTTP server so once we start the",
    "start": "604800",
    "end": "610260"
  },
  {
    "text": "python-based HTTP server we get this prompt like your application is running on port 8080 and uh what do you want to",
    "start": "610260",
    "end": "617100"
  },
  {
    "text": "do with it something like that so when you forward a port on a code space",
    "start": "617100",
    "end": "622440"
  },
  {
    "text": "by default uh the visibility of the port is set to private which is a good thing",
    "start": "622440",
    "end": "627779"
  },
  {
    "text": "like only you should be able to access the port that you are trying to expose right and unless and until one",
    "start": "627779",
    "end": "634339"
  },
  {
    "text": "deliberately changes the ports visibility from private to public they cannot access the code space like the",
    "start": "634339",
    "end": "642540"
  },
  {
    "text": "port so if you notice the URL the URL looks like we have the username of the",
    "start": "642540",
    "end": "649079"
  },
  {
    "text": "GitHub user like that's idea engine 007 that is followed by the name of the code space that is Turbo space orbit and this",
    "start": "649079",
    "end": "657360"
  },
  {
    "text": "is followed by a random ID and then you have the port followed by Dot preview.app.github.dev",
    "start": "657360",
    "end": "663959"
  },
  {
    "text": "so let's access this URL from our browser and a terminal as well so we",
    "start": "663959",
    "end": "669060"
  },
  {
    "text": "have modified the visibility to public so we see that there are no cookies",
    "start": "669060",
    "end": "677220"
  },
  {
    "text": "being used and there are no redirects being observed and we can access the",
    "start": "677220",
    "end": "683579"
  },
  {
    "text": "port on the code Space by knowing the URL so this bit is important we'll uh like I'll explain why this bit is",
    "start": "683579",
    "end": "690000"
  },
  {
    "text": "important a bit later on and yeah so if you see uh when you have just created a python",
    "start": "690000",
    "end": "697800"
  },
  {
    "text": "based HTTP server on the browser it looks like directory listing for the directory and then you have a bunch of",
    "start": "697800",
    "end": "704220"
  },
  {
    "text": "files there and I'm doing the same thing using curl so that uh like how does it look on the CLI as well",
    "start": "704220",
    "end": "711180"
  },
  {
    "text": "so uh so far do you have any questions we're just exposing a port publicly on a",
    "start": "711180",
    "end": "717779"
  },
  {
    "text": "GitHub Port space that you have just created and setting the visibility of the port to public",
    "start": "717779",
    "end": "723959"
  },
  {
    "text": "okay I see none so I'll just proceed so before moving on uh have you heard of",
    "start": "723959",
    "end": "729240"
  },
  {
    "text": "open directories anybody from the audience okay so I'll just explain",
    "start": "729240",
    "end": "735839"
  },
  {
    "text": "uh so open directories are basically uh publicly accessible web servers and they",
    "start": "735839",
    "end": "742140"
  },
  {
    "text": "have content that can be downloaded by anyone and this is one of the most popular ways used by attackers to host",
    "start": "742140",
    "end": "748260"
  },
  {
    "text": "their malware they just take an IP address they will create a Apache HTTP",
    "start": "748260",
    "end": "754079"
  },
  {
    "text": "server or something and they will just list down the stuff that they want to use later on and this is widely used to",
    "start": "754079",
    "end": "760860"
  },
  {
    "text": "perform malware delivery so the malware can range from like ransomware to uh",
    "start": "760860",
    "end": "766260"
  },
  {
    "text": "like you can have exploits and you can also disclose data in the form of open directories so",
    "start": "766260",
    "end": "771899"
  },
  {
    "text": "uh yeah so you can uh I mean the attackers have been observed to do all of this and previously we just exposed a",
    "start": "771899",
    "end": "780240"
  },
  {
    "text": "port on a code space manually by setting the ports visibility to public right",
    "start": "780240",
    "end": "785279"
  },
  {
    "text": "so let's uh take a look at this how would attackers be able to automate",
    "start": "785279",
    "end": "790980"
  },
  {
    "text": "creation of file servers or let's say malicious file servers using GitHub code",
    "start": "790980",
    "end": "796440"
  },
  {
    "text": "spaces so uh yesterday there was a very nice talk on dev containers so uh have you guys",
    "start": "796440",
    "end": "804360"
  },
  {
    "text": "attended it okay have you heard of Dev containers Okay cool so uh",
    "start": "804360",
    "end": "811860"
  },
  {
    "text": "now the thing is okay so Dev containers so you can say that you want to create",
    "start": "811860",
    "end": "818820"
  },
  {
    "start": "814000",
    "end": "814000"
  },
  {
    "text": "your environment so it's basically configuration as code so you can specify uh the various components of your",
    "start": "818820",
    "end": "825779"
  },
  {
    "text": "environments like the features the ports you want to expose uh the name of I mean",
    "start": "825779",
    "end": "831360"
  },
  {
    "text": "the container image that you want to use in your Dev container and then uh it's all specified in a Json C file so Json C",
    "start": "831360",
    "end": "838860"
  },
  {
    "text": "is basically Json with comments and yeah so the environment is as a Json C file",
    "start": "838860",
    "end": "846120"
  },
  {
    "text": "and the developers environment can be local or remote so local is like your laptop and remote is like your code",
    "start": "846120",
    "end": "852000"
  },
  {
    "text": "spaces so it has also some powerful Primitives of command execution so",
    "start": "852000",
    "end": "858120"
  },
  {
    "text": "here's one example which is called post start command so when you specify something in the post start command in",
    "start": "858120",
    "end": "865380"
  },
  {
    "text": "that Dev container configuration uh the command is run whenever the container is started so this is the link for the",
    "start": "865380",
    "end": "872839"
  },
  {
    "text": "specification of the containers.dev so basically they have this entire Json reference of how you",
    "start": "872839",
    "end": "879540"
  },
  {
    "text": "can create your Dev containers and while just doing a quick search on",
    "start": "879540",
    "end": "886680"
  },
  {
    "text": "GitHub like how many folks actually use Dev containers so we have a search query",
    "start": "886680",
    "end": "891839"
  },
  {
    "text": "here where we are looking for all the parts that contain this file devcontainer.json and we have like 33.4k",
    "start": "891839",
    "end": "898320"
  },
  {
    "text": "hits and there is a vs code extension uh that is just made for uh Dev containers",
    "start": "898320",
    "end": "903660"
  },
  {
    "text": "it was previously called remote containers and it has over like 14 million downloads 1.4 million nodes okay",
    "start": "903660",
    "end": "910740"
  },
  {
    "text": "so in this case uh we the idea is that how can the uh",
    "start": "910740",
    "end": "916800"
  },
  {
    "start": "911000",
    "end": "911000"
  },
  {
    "text": "attacker create malicious file servers with automation so in this case we see the dev container",
    "start": "916800",
    "end": "923760"
  },
  {
    "text": "configuration that is uh described in this hidden directory dot Dev container and then this file where the dev",
    "start": "923760",
    "end": "930600"
  },
  {
    "text": "container is named Ubuntu it is created based on an image like the container",
    "start": "930600",
    "end": "935820"
  },
  {
    "text": "image the docker image for this is maintained by Microsoft and the port 8000 is exposed on the code space if you",
    "start": "935820",
    "end": "943620"
  },
  {
    "text": "create from this Dev container and once the container is created I mean when the",
    "start": "943620",
    "end": "949019"
  },
  {
    "text": "container is started we have this post start command directive which basically creates a python based HTTP server on",
    "start": "949019",
    "end": "956639"
  },
  {
    "text": "listening on Port 8000. uh I'm not sure if this is uh visible at",
    "start": "956639",
    "end": "961860"
  },
  {
    "text": "the back but okay",
    "start": "961860",
    "end": "965600"
  },
  {
    "text": "so yeah so here we have the attackers Dev container configuration and let's",
    "start": "967320",
    "end": "973199"
  },
  {
    "text": "imagine a scenario where the attacker is already there in the victim's environment and they want to download uh",
    "start": "973199",
    "end": "980040"
  },
  {
    "text": "some sort of malicious file on the victim's environment by uh like they are",
    "start": "980040",
    "end": "985620"
  },
  {
    "text": "they are basically trying to bypass the standard detections that are there okay so from the attacker controlled code",
    "start": "985620",
    "end": "991860"
  },
  {
    "text": "space based on this configuration the attacker can request some malware from",
    "start": "991860",
    "end": "996899"
  },
  {
    "text": "some other website and then they can just publicly expose the port the the",
    "start": "996899",
    "end": "1003500"
  },
  {
    "text": "domain I mean the URL will have this format like preview.app.github.dev and this will be",
    "start": "1003500",
    "end": "1008600"
  },
  {
    "text": "delivered over https into the victims environment",
    "start": "1008600",
    "end": "1013660"
  },
  {
    "text": "so this is a simple script to create GitHub code spaces based open directories which will be live for 100",
    "start": "1014720",
    "end": "1021019"
  },
  {
    "text": "seconds so this assumes that the attacker is already authenticated into their account using the GitHub CLI so",
    "start": "1021019",
    "end": "1027860"
  },
  {
    "text": "first we create a code space based on this remote repository which is uh the",
    "start": "1027860",
    "end": "1033319"
  },
  {
    "text": "username is adity and the name of the repositories based on a basic Linux 32GB",
    "start": "1033319",
    "end": "1039020"
  },
  {
    "text": "code space VM so once this VM is created I mean can I",
    "start": "1039020",
    "end": "1045020"
  },
  {
    "text": "call it a VM so it's a container which is inside of a VM but the port is exposed on the VM as well so yeah so the",
    "start": "1045020",
    "end": "1053900"
  },
  {
    "text": "First Command that you specify uh to this script downloads I mean executes the command in that code space that is",
    "start": "1053900",
    "end": "1061100"
  },
  {
    "text": "just created and later on we just expose the uh forward the port to public",
    "start": "1061100",
    "end": "1068600"
  },
  {
    "text": "and then you have the entire URL where you can access the code space like the",
    "start": "1068600",
    "end": "1074600"
  },
  {
    "text": "port that you have just exposed and then it just sleeps for 100 seconds and deletes all the codes because this was just a simple uh POC to show how trivial",
    "start": "1074600",
    "end": "1082760"
  },
  {
    "text": "it is to automate",
    "start": "1082760",
    "end": "1085720"
  },
  {
    "text": "okay so this was something that I mean not this yeah this was something that we did back in January this year where we",
    "start": "1095900",
    "end": "1102620"
  },
  {
    "text": "were talking about how these cloud-based IDs can be abused since you can create",
    "start": "1102620",
    "end": "1107720"
  },
  {
    "text": "code spaces for free uh in uh later on based on threat hunting and some",
    "start": "1107720",
    "end": "1113720"
  },
  {
    "start": "1112000",
    "end": "1112000"
  },
  {
    "text": "information from security researchers on Twitter there was a like code spaces have been observed to",
    "start": "1113720",
    "end": "1121100"
  },
  {
    "text": "be abused by infostiler malware so uh do you know do you do you know about infos",
    "start": "1121100",
    "end": "1126559"
  },
  {
    "text": "dealers okay let me tell you so infos dealers are basically malicious programs that uh",
    "start": "1126559",
    "end": "1133340"
  },
  {
    "text": "can exfiltrate uh browser cookies passwords credit card information steam",
    "start": "1133340",
    "end": "1138500"
  },
  {
    "text": "uh stream data Discord tokens the cold wallet cryptocurrency wallet keys and",
    "start": "1138500",
    "end": "1144559"
  },
  {
    "text": "some user information once all of this executes I mean the info stick that executes on your environment okay so all",
    "start": "1144559",
    "end": "1150799"
  },
  {
    "text": "of this is packed and sent to some sort of webbook that the that belongs to the",
    "start": "1150799",
    "end": "1155960"
  },
  {
    "text": "attacker so in this case the web Hook was code space and this is something that we found over threat hunting as",
    "start": "1155960",
    "end": "1163520"
  },
  {
    "text": "well and in this case the information is being sent and we had already predicted",
    "start": "1163520",
    "end": "1169340"
  },
  {
    "text": "that this abuse can happen and this sample that we looked into it was written in Rust Lang so that would have",
    "start": "1169340",
    "end": "1175820"
  },
  {
    "text": "actually evaded a lot of it had entity book capabilities as well so if you want to figure out how does this sample work",
    "start": "1175820",
    "end": "1182480"
  },
  {
    "text": "your normal tools would not work like if you want to reverse it via Ida they won't work in the same way so it didn't",
    "start": "1182480",
    "end": "1191120"
  },
  {
    "text": "take attackers a long time to begin abusing this very cool service",
    "start": "1191120",
    "end": "1196340"
  },
  {
    "text": "and this is one sample which was detected on I mean which was not detected on virus total but this is an",
    "start": "1196340",
    "end": "1202400"
  },
  {
    "text": "infos dealer which is exfiltrating all of that stuff that I just showed you to a code space to an exposed port on a",
    "start": "1202400",
    "end": "1209000"
  },
  {
    "text": "code space so it has zero detections so that means it was not detected by the AV vendors",
    "start": "1209000",
    "end": "1216559"
  },
  {
    "text": "and this is the URL where the",
    "start": "1216559",
    "end": "1221240"
  },
  {
    "text": "yeah so this is the URL where uh the information was being exfiltrated to",
    "start": "1222799",
    "end": "1230419"
  },
  {
    "text": "this is our article if you want to learn more about how like what are the",
    "start": "1230419",
    "end": "1235580"
  },
  {
    "text": "nitty-gritty details of the code space abuse that we found in January this is",
    "start": "1235580",
    "end": "1241280"
  },
  {
    "text": "the one and these and this is the first part of the rust based infos dealers",
    "start": "1241280",
    "end": "1246320"
  },
  {
    "text": "that were abusing GitHub code spaces and this is the second part where the info",
    "start": "1246320",
    "end": "1252080"
  },
  {
    "text": "steer also modifies the victim's Discord client itself I mean it modifies uh in",
    "start": "1252080",
    "end": "1259520"
  },
  {
    "text": "it in such a way that the user's credentials are logged and sent to the code space instance that is owned by the",
    "start": "1259520",
    "end": "1266419"
  },
  {
    "text": "attacker so with this if you have any questions I can take it now or I'll just hand it",
    "start": "1266419",
    "end": "1272720"
  },
  {
    "text": "over to Magno sounds good thank you okay",
    "start": "1272720",
    "end": "1277820"
  },
  {
    "text": "okay let's move on um so now let's talk about GitHub actions um we also have some blog posts",
    "start": "1277820",
    "end": "1285500"
  },
  {
    "text": "there of course there is not enough time for us to cover all the details here but talking about exactly what are the",
    "start": "1285500",
    "end": "1293000"
  },
  {
    "text": "runners the VMS that you run your actions and exactly what attackers are",
    "start": "1293000",
    "end": "1298100"
  },
  {
    "text": "doing in a similar way using GitHub actions to mine cryptocurrencies so",
    "start": "1298100",
    "end": "1303679"
  },
  {
    "text": "there's stuff there but let's understand first how actions work so uh who here",
    "start": "1303679",
    "end": "1310100"
  },
  {
    "start": "1306000",
    "end": "1306000"
  },
  {
    "text": "uses GitHub actions okay good nice okay so basically uh it's a CI cd2 right so",
    "start": "1310100",
    "end": "1318799"
  },
  {
    "text": "you have it as a better uh way to maybe not run Jenkins",
    "start": "1318799",
    "end": "1325280"
  },
  {
    "text": "um but in a way that you can run your automation can create your automation as code and you have that code inside your",
    "start": "1325280",
    "end": "1332600"
  },
  {
    "text": "repository inside your application and anytime uh there is an event and that",
    "start": "1332600",
    "end": "1339080"
  },
  {
    "text": "happens inside your repository it triggers your workflow it triggers your action so this action will run uh by",
    "start": "1339080",
    "end": "1348559"
  },
  {
    "text": "default inside a runner and Runners are basically VMS that are uh provided for",
    "start": "1348559",
    "end": "1355700"
  },
  {
    "text": "you inside Azure right since GitHub is owned by Microsoft everything here runs",
    "start": "1355700",
    "end": "1361460"
  },
  {
    "text": "on azure and those VMS they are",
    "start": "1361460",
    "end": "1366500"
  },
  {
    "text": "they're not spun up at this time the VMS are like idle and waiting for an action",
    "start": "1366500",
    "end": "1374840"
  },
  {
    "text": "to start for them to be assigned so they they start really fast so one thing that",
    "start": "1374840",
    "end": "1380179"
  },
  {
    "text": "I started when I was doing this research like okay I thought these were containers because they were starting",
    "start": "1380179",
    "end": "1385940"
  },
  {
    "text": "really fast but no they are there they're just waiting for for anyone to assign them a job and the job is",
    "start": "1385940",
    "end": "1393620"
  },
  {
    "text": "basically this set of actions actions are can be either other actions right so",
    "start": "1393620",
    "end": "1400340"
  },
  {
    "text": "you have your workflow and your workflow can call other workflows like could be",
    "start": "1400340",
    "end": "1405620"
  },
  {
    "text": "like a plugin let's let's call it this way right now but it can also run scripts and scripts it's going to be uh",
    "start": "1405620",
    "end": "1413179"
  },
  {
    "text": "either like shell script if you're running on a Linux environment or a Powershell whatever right so uh here the",
    "start": "1413179",
    "end": "1421340"
  },
  {
    "text": "runners can have three different flavors by default the ones that are provided by guitar Hub are windows Linux which is",
    "start": "1421340",
    "end": "1429860"
  },
  {
    "text": "Ubuntu and Mac OS so you have all these uh VMS Runners provided for you to run",
    "start": "1429860",
    "end": "1436340"
  },
  {
    "text": "your Automation and same way uh with code spaces it's free by default of",
    "start": "1436340",
    "end": "1442700"
  },
  {
    "text": "course there are some limits but you can start right away with a free GitHub account you can deploy this and and run",
    "start": "1442700",
    "end": "1449840"
  },
  {
    "text": "your automation uh same thing with Runner 2 they're just a representation uh the way that it",
    "start": "1449840",
    "end": "1456559"
  },
  {
    "text": "works it's gonna be another VM and then you have another job and the way that they're connected uh it it means",
    "start": "1456559",
    "end": "1464240"
  },
  {
    "text": "something right so you see that Runner one is connected directly to Runner 2 it",
    "start": "1464240",
    "end": "1469340"
  },
  {
    "text": "means that there is a dependency there so Runner 2 is only going to start after",
    "start": "1469340",
    "end": "1475039"
  },
  {
    "text": "Runner one completes in this way in this diagram so it means that",
    "start": "1475039",
    "end": "1480500"
  },
  {
    "text": "the output of Runner one probably is the input of Runner two so it needs to wait",
    "start": "1480500",
    "end": "1486799"
  },
  {
    "text": "for this job yes you can have them running in parallel if you want uh that's not a problem it's just the way",
    "start": "1486799",
    "end": "1492980"
  },
  {
    "text": "that it's represented here okay but where is this like how do I do my",
    "start": "1492980",
    "end": "1499039"
  },
  {
    "text": "automation where is this file right so GitHub actions works as a yaml file you",
    "start": "1499039",
    "end": "1506240"
  },
  {
    "text": "have you create your workflow your as a yaml file and you store that file inside",
    "start": "1506240",
    "end": "1511700"
  },
  {
    "text": "your repository inside a specific directory called dot GitHub slash",
    "start": "1511700",
    "end": "1517240"
  },
  {
    "text": "workflows with an S otherwise it won't work so once you store there if you're using",
    "start": "1517240",
    "end": "1524299"
  },
  {
    "text": "the proper syntax a and the event is trigger and an event can be like a pull",
    "start": "1524299",
    "end": "1530419"
  },
  {
    "text": "request any changes to the repository a push or you can manually trigger that event so once that happens GitHub will",
    "start": "1530419",
    "end": "1539120"
  },
  {
    "text": "start your automation so we'll deploy the VM you run your actions and then when uh your action is completed the VM",
    "start": "1539120",
    "end": "1547400"
  },
  {
    "text": "is completely deleted you don't have access to that VM anymore and anything",
    "start": "1547400",
    "end": "1552620"
  },
  {
    "text": "that was generated let's say you build a binary or you ran a scan uh you need to",
    "start": "1552620",
    "end": "1558620"
  },
  {
    "text": "upload that back to GitHub otherwise you won't have access to that VM anymore",
    "start": "1558620",
    "end": "1564140"
  },
  {
    "text": "so this service was launched in 2019 so",
    "start": "1564140",
    "end": "1569299"
  },
  {
    "text": "approximately four years ago and one of the reasons for the high adoption of",
    "start": "1569299",
    "end": "1575960"
  },
  {
    "text": "GitHub actions is the marketplace so the GitHub actions Marketplace you have apps",
    "start": "1575960",
    "end": "1582799"
  },
  {
    "start": "1579000",
    "end": "1579000"
  },
  {
    "text": "and actions inside GitHub the marketplace is means that anyone here",
    "start": "1582799",
    "end": "1588380"
  },
  {
    "text": "even with a free GitHub account can publish your own actions so you can",
    "start": "1588380",
    "end": "1593659"
  },
  {
    "text": "write your Automation and you can publish there to the marketplace so that other people could use",
    "start": "1593659",
    "end": "1599179"
  },
  {
    "text": "uh you can see that this number 18 000 is probably higher today keeps changing every day so I I just gave up updating",
    "start": "1599179",
    "end": "1606679"
  },
  {
    "text": "this slide uh but basically um trades no verification there is no",
    "start": "1606679",
    "end": "1612980"
  },
  {
    "text": "security verification of uh the actions that are uploaded that are offered",
    "start": "1612980",
    "end": "1618200"
  },
  {
    "text": "inside the marketplace right so yes there are a lot of interesting things so you don't reinvent",
    "start": "1618200",
    "end": "1624200"
  },
  {
    "text": "the wheel so if you need to uh you know build a a JavaScript application if you",
    "start": "1624200",
    "end": "1630080"
  },
  {
    "text": "need to generate a container it's already probably already there and it's beneficial for you for developers but",
    "start": "1630080",
    "end": "1638299"
  },
  {
    "text": "what happens if a malicious user an attacker uploads something and tries to",
    "start": "1638299",
    "end": "1644240"
  },
  {
    "text": "label okay this is legitimate right what happens there and that's basically one of the main goals of my research that",
    "start": "1644240",
    "end": "1651440"
  },
  {
    "text": "we're gonna talk about today but before we do that",
    "start": "1651440",
    "end": "1657919"
  },
  {
    "text": "how can you abuse GitHub actions let's say you have free Computing you're not",
    "start": "1657919",
    "end": "1664279"
  },
  {
    "text": "paying for that cloud service you're not paying for that VM those Runners there they are run by Azure by Microsoft so",
    "start": "1664279",
    "end": "1672679"
  },
  {
    "text": "you're not paying it's free of course on a limited time basis but it's free",
    "start": "1672679",
    "end": "1677720"
  },
  {
    "text": "so the first thing that comes to mind easy money for attackers is mine",
    "start": "1677720",
    "end": "1683720"
  },
  {
    "text": "cryptocurrency why can I not uh can I not upload or deploy this action that",
    "start": "1683720",
    "end": "1689720"
  },
  {
    "text": "would mine cryptocurrency for whatever hours I have available for free right so this is an example of a yaml",
    "start": "1689720",
    "end": "1697159"
  },
  {
    "text": "file abusing Windows Runners so you can see here on line six uh deploying",
    "start": "1697159",
    "end": "1703640"
  },
  {
    "text": "Windows latest it means that this is the latest version of the GitHub action on Windows",
    "start": "1703640",
    "end": "1708919"
  },
  {
    "text": "and at the end here at the bottom you see the node.exe file where it's",
    "start": "1708919",
    "end": "1715580"
  },
  {
    "text": "actually was inside the repo to mine the cryptocurrency and they label no.exe try",
    "start": "1715580",
    "end": "1721340"
  },
  {
    "text": "to maybe uh mask that it's not a Monero crypto Miner but you can see that there",
    "start": "1721340",
    "end": "1727120"
  },
  {
    "text": "and uh some other things are happening and I'll explain that on the other examples as well but one thing here is",
    "start": "1727120",
    "end": "1734360"
  },
  {
    "text": "really interesting on this specific one line 18 here you see the uses and this",
    "start": "1734360",
    "end": "1741860"
  },
  {
    "text": "syntax syntax uses means I'm calling a third-party action right so my action is",
    "start": "1741860",
    "end": "1747440"
  },
  {
    "text": "calling it another action and it says Nick Dash Envision slash retry at V2 is",
    "start": "1747440",
    "end": "1755360"
  },
  {
    "text": "is Nick here please hazor and hick Nick no okay so the the problem is this is a",
    "start": "1755360",
    "end": "1763100"
  },
  {
    "text": "legitimate action this is an action that is used to retry your action if it fails",
    "start": "1763100",
    "end": "1768380"
  },
  {
    "text": "but attackers are already using third-party actions to automate their",
    "start": "1768380",
    "end": "1773539"
  },
  {
    "text": "stuff so they're using for malicious purposes but it's a legitimate one I have analyzed the code there I I checked",
    "start": "1773539",
    "end": "1780919"
  },
  {
    "text": "for the uh retry action and it says okay yeah retries and action if it fails it",
    "start": "1780919",
    "end": "1787760"
  },
  {
    "text": "there is nothing malicious there but they're using that for their own gains",
    "start": "1787760",
    "end": "1793520"
  },
  {
    "text": "uh and of course the node.exe file it's not actually a node.exe it's a crypto",
    "start": "1793520",
    "end": "1800179"
  },
  {
    "text": "Miner and that was flagged by uh virus order it's probably more detections now but okay this is a problem",
    "start": "1800179",
    "end": "1807679"
  },
  {
    "text": "and what happens this is a cat and mouse Chase basically with Excuse me with",
    "start": "1807679",
    "end": "1814279"
  },
  {
    "text": "GitHub and Microsoft right because attackers they they keep uh creating",
    "start": "1814279",
    "end": "1819679"
  },
  {
    "text": "other users and new repos and Mining so they're scaling their their attacks",
    "start": "1819679",
    "end": "1825440"
  },
  {
    "text": "because Microsoft it's like a whack-a-mole right so okay you block a user you block one repo they just create",
    "start": "1825440",
    "end": "1831980"
  },
  {
    "text": "another user they just create another Reaper and start mining again right so this is very a tough problem for them to",
    "start": "1831980",
    "end": "1838220"
  },
  {
    "text": "solve and I think they're still struggling with that and we're gonna see that uh why in a second",
    "start": "1838220",
    "end": "1844640"
  },
  {
    "start": "1844000",
    "end": "1844000"
  },
  {
    "text": "another example here this is also abusing Windows Runner it's running Powershell you can see if you know",
    "start": "1844640",
    "end": "1850640"
  },
  {
    "text": "Powershell there are a few commands here on line 18 uh 20 and and yeah basically",
    "start": "1850640",
    "end": "1856460"
  },
  {
    "text": "and then running the crypto Miner again uh what's interesting about this one and and is this Matrix here that's similar",
    "start": "1856460",
    "end": "1864740"
  },
  {
    "text": "to what we saw on the previous one this Matrix means that I'm going to deploy different versions like if I have uh",
    "start": "1864740",
    "end": "1872240"
  },
  {
    "text": "different versions of my application and I want to try test it on different environment versions and I want to scale",
    "start": "1872240",
    "end": "1877820"
  },
  {
    "text": "that right so I want to run those in parallel but the idea here is to run different runners in parallel right",
    "start": "1877820",
    "end": "1885020"
  },
  {
    "text": "because okay I have more VMS running I have more money right I get more money faster it because if it if it gets",
    "start": "1885020",
    "end": "1892220"
  },
  {
    "text": "flagged by Microsoft by GitHub then at least I made I don't know a few bucks",
    "start": "1892220",
    "end": "1897559"
  },
  {
    "text": "um but yeah same thing downloading the the crypto Miner the Monero there on",
    "start": "1897559",
    "end": "1902659"
  },
  {
    "text": "line 18 it's uh expanding and then running it again and for whatever time",
    "start": "1902659",
    "end": "1908659"
  },
  {
    "text": "it's available uh if I'm not mistaken each job has a limit of six hours and",
    "start": "1908659",
    "end": "1915320"
  },
  {
    "text": "each Runner can run up to 72 hours so that's like three days that they have",
    "start": "1915320",
    "end": "1921080"
  },
  {
    "text": "this machine and there is a specific configuration for the each VMS that that",
    "start": "1921080",
    "end": "1926539"
  },
  {
    "text": "can run and mine cryptocurrency for them okay but",
    "start": "1926539",
    "end": "1932960"
  },
  {
    "text": "like why is it is this just one example is this just one user no we found more",
    "start": "1932960",
    "end": "1942799"
  },
  {
    "start": "1942000",
    "end": "1942000"
  },
  {
    "text": "than a hundred repos with the exact same code as this previous one the exact same",
    "start": "1942799",
    "end": "1949580"
  },
  {
    "text": "code just a few examples here but there were a hundred more with the exact same code abusing crypto mining on on GitHub",
    "start": "1949580",
    "end": "1957740"
  },
  {
    "text": "actions we of course we reported this to GitHub it took them a few months to reply back to us and I believe some of",
    "start": "1957740",
    "end": "1965779"
  },
  {
    "text": "the repos are still uh uh up but most of them have been taken down or at least",
    "start": "1965779",
    "end": "1971600"
  },
  {
    "text": "they have the action disabled so what means is if you have the actions",
    "start": "1971600",
    "end": "1977179"
  },
  {
    "text": "disabled you can't re run GitHub actions you can't deploy VMS on uh Azure anymore",
    "start": "1977179",
    "end": "1983840"
  },
  {
    "text": "but that's specific to that repo that's not as specific to the user so if",
    "start": "1983840",
    "end": "1989120"
  },
  {
    "text": "the user creates another repo they can run GitHub actions again so it's like okay what is what is going on here",
    "start": "1989120",
    "end": "1997299"
  },
  {
    "text": "yeah yeah sometimes they don't they don't even try to hide right sometimes they name it CI CI CD but sometimes yeah",
    "start": "1998480",
    "end": "2006279"
  },
  {
    "text": "crypto stuff so like okay and you can see a few of them have the same username right so it's like is the same user",
    "start": "2006279",
    "end": "2014019"
  },
  {
    "text": "creating and just creating different repos and and trying to automate this stuff and scale",
    "start": "2014019",
    "end": "2020940"
  },
  {
    "start": "2022000",
    "end": "2022000"
  },
  {
    "text": "so similar example here this is not specific to Windows though the ones that I provided earlier same thing uh here",
    "start": "2022000",
    "end": "2029320"
  },
  {
    "text": "with uh with Linux and now I raise you the question like if you're if you're",
    "start": "2029320",
    "end": "2035260"
  },
  {
    "text": "big into crypto which is not my area of expertise which one would be better to mine crypto",
    "start": "2035260",
    "end": "2043740"
  },
  {
    "text": "windows or Linux using CPU not GPU anyone",
    "start": "2043740",
    "end": "2051419"
  },
  {
    "text": "why exactly right there is less bloatware less stuff installed less stuff running",
    "start": "2054399",
    "end": "2060878"
  },
  {
    "text": "so I asked a few friends about it like okay why what would be because they have the same exact configuration memory and",
    "start": "2060879",
    "end": "2068378"
  },
  {
    "text": "CPU but why would you run it on Linux then Windows like okay yeah that might be a reason I'm not sure if that's the",
    "start": "2068379",
    "end": "2074679"
  },
  {
    "text": "goal but that's okay that's what I thought okay that makes sense but here the same thing they download from like",
    "start": "2074679",
    "end": "2081398"
  },
  {
    "text": "the crypto Miner is on even on GitHub and it's like the legitimate crypto mining file the crypto mining binary for",
    "start": "2081399",
    "end": "2088300"
  },
  {
    "text": "Max and rig but they're just pointing for their username here the pool and start mining as long as they can",
    "start": "2088300",
    "end": "2096700"
  },
  {
    "text": "and if you if you're familiar like if you use Mac OS and you think Mac OS is a",
    "start": "2096700",
    "end": "2105400"
  },
  {
    "text": "probably um how can I say it's protected from malware no that's",
    "start": "2105400",
    "end": "2111820"
  },
  {
    "text": "not the case they're even leveraging Mac OS here and this is a new thing I",
    "start": "2111820",
    "end": "2118180"
  },
  {
    "start": "2113000",
    "end": "2113000"
  },
  {
    "text": "presented this talk back at NDC Security in January I don't know if someone was here but this is a new thing so we found",
    "start": "2118180",
    "end": "2124599"
  },
  {
    "text": "this someone now abusing Mac OS Runner so it's not it's not specific to Windows",
    "start": "2124599",
    "end": "2129940"
  },
  {
    "text": "not specific to Linux and they're trying to name it core book hacking Tosh whatever and",
    "start": "2129940",
    "end": "2136960"
  },
  {
    "text": "um yes I can't understand that that's fine but I can't understand the yaml file",
    "start": "2136960",
    "end": "2142480"
  },
  {
    "text": "and if you look here Mac OS latest and basically what they're doing there giving execute permissions and running",
    "start": "2142480",
    "end": "2149680"
  },
  {
    "text": "XM rig right and the same file the same XM rig no fee there the binary",
    "start": "2149680",
    "end": "2156160"
  },
  {
    "text": "yeah it's also malicious detected by virustoto as a crypto Miner",
    "start": "2156160",
    "end": "2164020"
  },
  {
    "text": "so this is happening and this is what's going on so if you ever go to a GitHub",
    "start": "2164020",
    "end": "2170140"
  },
  {
    "text": "repo and you see this sign this red sign GitHub actions is currently disabled for",
    "start": "2170140",
    "end": "2176680"
  },
  {
    "text": "this repo they probably did something wrong right so take a look at the yaml file it's probably you can see the",
    "start": "2176680",
    "end": "2182920"
  },
  {
    "text": "history there so be aware of that if you're using if you're going to maybe leverage some code from that repo just",
    "start": "2182920",
    "end": "2190480"
  },
  {
    "text": "be very careful but as I said this means that the GitHub",
    "start": "2190480",
    "end": "2197980"
  },
  {
    "text": "actions was blocked on that repo only not the user so if they if they create",
    "start": "2197980",
    "end": "2204400"
  },
  {
    "text": "another repo they can still use GitHub actions I'm not sure why but that's how how it is today",
    "start": "2204400",
    "end": "2211180"
  },
  {
    "text": "okay okay good so one of the goals of my",
    "start": "2211180",
    "end": "2218200"
  },
  {
    "text": "research as I mentioned earlier was Marketplace anyone can post a GitHub",
    "start": "2218200",
    "end": "2224859"
  },
  {
    "text": "actions to the marketplace there is no security verification there is no validation by GitHub no scanning",
    "start": "2224859",
    "end": "2233680"
  },
  {
    "text": "nothing on the security side so what happens if someone uploads a",
    "start": "2233680",
    "end": "2240099"
  },
  {
    "text": "malicious action to the marketplace and offer they're okay yeah this action will will help you build your applications",
    "start": "2240099",
    "end": "2246700"
  },
  {
    "text": "and you know generate a Docker container whatever doesn't matter right uh so what",
    "start": "2246700",
    "end": "2253300"
  },
  {
    "text": "happens there one thing that I forgot to mention is that every GitHub action is a public",
    "start": "2253300",
    "end": "2260800"
  },
  {
    "text": "repo so it's a public repository so you can read the code inside those actions",
    "start": "2260800",
    "end": "2266859"
  },
  {
    "text": "so if you see there on on the right side basically the two directives uses",
    "start": "2266859",
    "end": "2273359"
  },
  {
    "text": "actions slash checkout and action slash setup Dash node it means that if I go to",
    "start": "2273359",
    "end": "2280000"
  },
  {
    "text": "the github.com slash actions slash checkout I can see the exact code that",
    "start": "2280000",
    "end": "2286420"
  },
  {
    "text": "it's being downloaded inside my VM and being ran there so I can read the code",
    "start": "2286420",
    "end": "2291820"
  },
  {
    "text": "as well if I understand it if I can analyze it as well so one of the things that GitHub does to",
    "start": "2291820",
    "end": "2300520"
  },
  {
    "text": "maybe do some validation there and it's not great uh it's the blue check mark so",
    "start": "2300520",
    "end": "2307359"
  },
  {
    "text": "this is not like the Twitter blue check mark you don't pay to get it but it uh there is a Creator verified by GitHub",
    "start": "2307359",
    "end": "2314800"
  },
  {
    "text": "it's basically a domain validation of the user or the company that is",
    "start": "2314800",
    "end": "2319839"
  },
  {
    "text": "providing you see that more frequently with companies that are offering their actions on the marketplace",
    "start": "2319839",
    "end": "2326500"
  },
  {
    "text": "um but this one actions this I know that this one is a organization or username",
    "start": "2326500",
    "end": "2332400"
  },
  {
    "text": "provided by GitHub themselves so GitHub security team or developer team they",
    "start": "2332400",
    "end": "2338380"
  },
  {
    "text": "work on these actions and everything that is inside the actions user or",
    "start": "2338380",
    "end": "2343480"
  },
  {
    "text": "organization is provided by them so look for this check mark it doesn't",
    "start": "2343480",
    "end": "2349180"
  },
  {
    "text": "mean that it's being scanned by for security being validated just the",
    "start": "2349180",
    "end": "2354579"
  },
  {
    "text": "creator has been verified so it's not a great uh validation but at least that's what we",
    "start": "2354579",
    "end": "2361000"
  },
  {
    "text": "have right now so once I was uh deploying these",
    "start": "2361000",
    "end": "2369760"
  },
  {
    "text": "malicious actions it's like okay I I'm scanning the environment right I'm running a VM inside Azure what can I do",
    "start": "2369760",
    "end": "2377500"
  },
  {
    "text": "there why I'm exploring so I was scanning the network I was very fine tokens and things like that so these are",
    "start": "2377500",
    "end": "2384640"
  },
  {
    "text": "kind of the things that I did during the research I was able to run an nmap nmap",
    "start": "2384640",
    "end": "2390160"
  },
  {
    "text": "means Network mapping to map the ports and the services inside the network inside the Azure internal Network so",
    "start": "2390160",
    "end": "2397599"
  },
  {
    "text": "because the VM gets assigned to Azure it's under a Microsoft owned account or",
    "start": "2397599",
    "end": "2405040"
  },
  {
    "text": "tenant right so okay maybe that can be a problem",
    "start": "2405040",
    "end": "2410140"
  },
  {
    "text": "um one of the things that you can't do by default with your actions is run interactive commands so if we're doing",
    "start": "2410140",
    "end": "2417520"
  },
  {
    "text": "the pipeline as code approach right all the stuff that I want to do with my action has to be inside that yemo file",
    "start": "2417520",
    "end": "2424180"
  },
  {
    "text": "that automation but what happens if I wanna like a shell script a shell a prompt and I want to",
    "start": "2424180",
    "end": "2431380"
  },
  {
    "text": "interact with my action technically you can't but if you make your uh runner your VM",
    "start": "2431380",
    "end": "2439000"
  },
  {
    "text": "connect back to a reverse shell to another machine that you control then",
    "start": "2439000",
    "end": "2444579"
  },
  {
    "text": "you can run interactive commands and of course",
    "start": "2444579",
    "end": "2449980"
  },
  {
    "text": "if I'm deploying this VM and I have like pseudo access to the the pseudo",
    "start": "2449980",
    "end": "2455140"
  },
  {
    "text": "permissions to this VM maybe can I do something like would I be able to do something malicious and use",
    "start": "2455140",
    "end": "2461740"
  },
  {
    "text": "this VM to attack other targets attack other victims even inside Azure or",
    "start": "2461740",
    "end": "2467560"
  },
  {
    "text": "outside yes that's possible too right so like I would be",
    "start": "2467560",
    "end": "2473460"
  },
  {
    "text": "proxying my attacks to this VM and trying to hide the origin of the attack",
    "start": "2473460",
    "end": "2479560"
  },
  {
    "text": "of course there is ways for Microsoft to track you down but that would be a way",
    "start": "2479560",
    "end": "2484900"
  },
  {
    "text": "to avoid some of the detection",
    "start": "2484900",
    "end": "2488640"
  },
  {
    "start": "2490000",
    "end": "2490000"
  },
  {
    "text": "uh so here's just in map scan uh the kind of the four ports 22 84 for free",
    "start": "2490300",
    "end": "2496839"
  },
  {
    "text": "free 89 but there is one that's interesting here the 8084",
    "start": "2496839",
    "end": "2503200"
  },
  {
    "text": "so this is a web service called monoxx SP has anyone heard of mono X XP",
    "start": "2503200",
    "end": "2511720"
  },
  {
    "text": "okay no see it's a very old web server that was uh this is when I was running",
    "start": "2511720",
    "end": "2518380"
  },
  {
    "text": "on Linux but it was uh developed in uh aspure.net and was ported to Linux",
    "start": "2518380",
    "end": "2524920"
  },
  {
    "text": "and this web server caught my attention because it was enabled by default",
    "start": "2524920",
    "end": "2532060"
  },
  {
    "text": "on different from Apache or nginx it was already enabled by default so why do you",
    "start": "2532060",
    "end": "2538839"
  },
  {
    "text": "have this web server on my uh on my Runner that it's enabled by default",
    "start": "2538839",
    "end": "2545940"
  },
  {
    "text": "um that's uh basically and it got removed now but basically it was I I",
    "start": "2546339",
    "end": "2552579"
  },
  {
    "text": "couldn't figure out the idea behind this mono the XXV we did some research we",
    "start": "2552579",
    "end": "2558520"
  },
  {
    "text": "analyzed the code as well but it seems there was some um health or Administration features",
    "start": "2558520",
    "end": "2565839"
  },
  {
    "text": "used by Azure themselves but they removed in the latest version of the",
    "start": "2565839",
    "end": "2570940"
  },
  {
    "text": "Ubuntu VM the actions uh it's not there anymore so maybe they they found",
    "start": "2570940",
    "end": "2577240"
  },
  {
    "text": "something that it wasn't uh it wasn't good",
    "start": "2577240",
    "end": "2581819"
  },
  {
    "start": "2582000",
    "end": "2582000"
  },
  {
    "text": "okay so on the top here this is the reverse shell from the runner so on the",
    "start": "2582819",
    "end": "2588579"
  },
  {
    "text": "top here I'm basically uh downloading uh netcat it's a tool for for can have can",
    "start": "2588579",
    "end": "2597339"
  },
  {
    "text": "use it for Network assessment validations but I can also use as a as a",
    "start": "2597339",
    "end": "2602440"
  },
  {
    "text": "back door and I deployed an instance on AWS an ec2",
    "start": "2602440",
    "end": "2608920"
  },
  {
    "text": "instance you can see by the username here and I made my Runner connect back",
    "start": "2608920",
    "end": "2614500"
  },
  {
    "text": "to this uh to this uh machine so",
    "start": "2614500",
    "end": "2619680"
  },
  {
    "text": "installing netcast inside the yaml this is the yaml file configure and then the",
    "start": "2619680",
    "end": "2624700"
  },
  {
    "text": "IP address I was able to get access to my Linux Azure VM here",
    "start": "2624700",
    "end": "2632680"
  },
  {
    "text": "so now I can send interactive commands there is the username it's running as a",
    "start": "2632680",
    "end": "2638020"
  },
  {
    "text": "runner so I can play around with it so I don't need to keep changing the yaml files all the time and then waiting for",
    "start": "2638020",
    "end": "2645819"
  },
  {
    "text": "it to you know assign another Runner so I can play more with it",
    "start": "2645819",
    "end": "2651480"
  },
  {
    "start": "2653000",
    "end": "2653000"
  },
  {
    "text": "things I can do reverse shells from the runners right I can also issue malicious commands I can tell it to attack someone",
    "start": "2653800",
    "end": "2660640"
  },
  {
    "text": "else either even in their either inside Azure or outside of azure so that's",
    "start": "2660640",
    "end": "2666760"
  },
  {
    "text": "interesting but we haven't we haven't done the malicious GitHub",
    "start": "2666760",
    "end": "2673359"
  },
  {
    "text": "actions yet where is that okay what happens if",
    "start": "2673359",
    "end": "2679720"
  },
  {
    "text": "I pack this yaml file as a action and",
    "start": "2679720",
    "end": "2686740"
  },
  {
    "text": "publish that to the marketplace and then anybody that runs it it would",
    "start": "2686740",
    "end": "2692200"
  },
  {
    "text": "connect back to my my command and control server my machine here that's running on azure okay let's try that",
    "start": "2692200",
    "end": "2700180"
  },
  {
    "text": "and that's what I did basically of course I didn't publish on",
    "start": "2700180",
    "end": "2706060"
  },
  {
    "start": "2702000",
    "end": "2702000"
  },
  {
    "text": "the marketplace for legal reasons otherwise I wouldn't be here today but but yeah the idea was basically a",
    "start": "2706060",
    "end": "2713859"
  },
  {
    "text": "shell script that would call that command so just same thing downloading netcat installing and calling my my situ",
    "start": "2713859",
    "end": "2721420"
  },
  {
    "text": "uh environment so what happens what I did was",
    "start": "2721420",
    "end": "2727359"
  },
  {
    "text": "from one repo separate repo calling this",
    "start": "2727359",
    "end": "2732760"
  },
  {
    "text": "action so how do you call third-party actions they use this directive right so",
    "start": "2732760",
    "end": "2738760"
  },
  {
    "text": "that's what I did okay so you can see here",
    "start": "2738760",
    "end": "2744819"
  },
  {
    "text": "that this is another repo another place and I'm calling the third party action",
    "start": "2744819",
    "end": "2751240"
  },
  {
    "text": "Magna Logan fake gaj so this is another one so this would be",
    "start": "2751240",
    "end": "2756339"
  },
  {
    "text": "like okay if I posted this on the marketplace this is what you call right of course I made it in a way that it's",
    "start": "2756339",
    "end": "2762339"
  },
  {
    "text": "okay you can see that it's it's not legitimate it's not like I'm not trying",
    "start": "2762339",
    "end": "2767500"
  },
  {
    "text": "to mask it or or anything but I got the same thing I got the shell",
    "start": "2767500",
    "end": "2772660"
  },
  {
    "text": "back to uh from the runner so now what means that means is if I",
    "start": "2772660",
    "end": "2779079"
  },
  {
    "text": "publish this to the marketplace anyone that uses and of course I would mask it",
    "start": "2779079",
    "end": "2784119"
  },
  {
    "text": "as something legitimate but anyone that uses my action they add this to the yemo",
    "start": "2784119",
    "end": "2790300"
  },
  {
    "text": "file it would create a back door to their environment so I would be able to",
    "start": "2790300",
    "end": "2796000"
  },
  {
    "text": "compromise their environment get tokens do whatever you can run interactive commands if I wanted to so I would be",
    "start": "2796000",
    "end": "2803020"
  },
  {
    "text": "able to do that of course I didn't do it but yeah that's a possibility I validated that",
    "start": "2803020",
    "end": "2810220"
  },
  {
    "text": "okay so uh to wrap up before we move on let's understand some counter measures",
    "start": "2810220",
    "end": "2816520"
  },
  {
    "text": "how can I protect myself if I'm just using GitHub actions in my CI CD",
    "start": "2816520",
    "end": "2822640"
  },
  {
    "text": "pipeline I have my automation there what are some things that I need to consider",
    "start": "2822640",
    "end": "2828040"
  },
  {
    "text": "and be aware of um so I know this is not a great advice",
    "start": "2828040",
    "end": "2835420"
  },
  {
    "start": "2830000",
    "end": "2830000"
  },
  {
    "text": "but this is what we have right now only use actions from trusted creators",
    "start": "2835420",
    "end": "2840480"
  },
  {
    "text": "if you're if you're using actions from non-trusted creators try to at least",
    "start": "2840480",
    "end": "2847480"
  },
  {
    "text": "review the code understand what you're doing don't consider that uh because",
    "start": "2847480",
    "end": "2852700"
  },
  {
    "text": "they're gonna have access to your repo there are some tokens involved some credentials as well which I couldn't",
    "start": "2852700",
    "end": "2859180"
  },
  {
    "text": "cover everything here but be aware of that look for if there is usually you",
    "start": "2859180",
    "end": "2864280"
  },
  {
    "text": "might find two similar actions one from trusted and one from untrusted so pick",
    "start": "2864280",
    "end": "2870099"
  },
  {
    "text": "the The Trusted one that's my recommendation make sure you set the right permissions",
    "start": "2870099",
    "end": "2875260"
  },
  {
    "text": "for your tokens for your actions so technically by default actions had uh",
    "start": "2875260",
    "end": "2881500"
  },
  {
    "text": "have a token GitHub token which before had read and write permissions to your",
    "start": "2881500",
    "end": "2888880"
  },
  {
    "text": "repo so one action your action your VM was running here and it was able to",
    "start": "2888880",
    "end": "2894160"
  },
  {
    "text": "modify stuff on your repository now I think GitHub changed that to read only",
    "start": "2894160",
    "end": "2899980"
  },
  {
    "text": "which is better but but yeah so assume the least privileged principle where you",
    "start": "2899980",
    "end": "2905859"
  },
  {
    "text": "only apply the necessary privileges to this token to this credential",
    "start": "2905859",
    "end": "2911680"
  },
  {
    "text": "another thing is don't run actions from 4kid repos so this was a problem that",
    "start": "2911680",
    "end": "2917740"
  },
  {
    "text": "was uh before when GitHub actions was launched now technically it's fixed but",
    "start": "2917740",
    "end": "2923740"
  },
  {
    "text": "the problem was that when you forget a repo and you modify the action file the",
    "start": "2923740",
    "end": "2930520"
  },
  {
    "text": "yemo file when you send the pull requests back to the original one your action would run so people were mining",
    "start": "2930520",
    "end": "2938440"
  },
  {
    "text": "cryptocurrencies on the name of the other users so people were forking a bunch of repos and and changing the yaml",
    "start": "2938440",
    "end": "2945520"
  },
  {
    "text": "file exactly what we saw to mine cryptocurrencies in the name of other users and of course uh protect your secrets",
    "start": "2945520",
    "end": "2953380"
  },
  {
    "text": "and verify untrusted inputs so there is some fields on the GitHub actions that can be considered interested and so you",
    "start": "2953380",
    "end": "2960640"
  },
  {
    "text": "need to validate those as well so the last two things here on the GitHub actions if you're not using",
    "start": "2960640",
    "end": "2967780"
  },
  {
    "text": "actions disable it right so you can go to either by a repository or for the",
    "start": "2967780",
    "end": "2974319"
  },
  {
    "text": "entire organization you disable actions but if you are using you can specify you",
    "start": "2974319",
    "end": "2979900"
  },
  {
    "text": "can reduce the blast radius of the impact of someone compromising your",
    "start": "2979900",
    "end": "2984940"
  },
  {
    "text": "actions and this is the setting that's enabled by default now the GitHub change to",
    "start": "2984940",
    "end": "2991960"
  },
  {
    "text": "avoid anyone from forking your repo and then send the Apple request back to modify your actions as well",
    "start": "2991960",
    "end": "2999220"
  },
  {
    "text": "and just uh just to wrap up I'll give the floor to nitash to give his recommendations around code spaces",
    "start": "2999220",
    "end": "3007319"
  },
  {
    "start": "3006000",
    "end": "3006000"
  },
  {
    "text": "thank you Magno uh so for uh code spaces uh the abuse is very straightforward",
    "start": "3007319",
    "end": "3013500"
  },
  {
    "text": "because you get a virtual machine for free on Azure and you can create automations using Dev containers so one",
    "start": "3013500",
    "end": "3020880"
  },
  {
    "text": "of the cool things that uh infosec people talk about is trust but verify",
    "start": "3020880",
    "end": "3026460"
  },
  {
    "text": "like trusting is fine but you need to verify the extensions the container images the command directives like post",
    "start": "3026460",
    "end": "3034260"
  },
  {
    "text": "start command post create command initialize command and the different features that are being used in your Dev",
    "start": "3034260",
    "end": "3040680"
  },
  {
    "text": "container configurations because let's say if we talk about the container images threat actors have been",
    "start": "3040680",
    "end": "3047880"
  },
  {
    "text": "observed to create a similar sounding container images on Docker Hub and then",
    "start": "3047880",
    "end": "3053460"
  },
  {
    "text": "when you just do a typo or something you download the wrong image instead of the legitimate one you need to have",
    "start": "3053460",
    "end": "3058859"
  },
  {
    "text": "container scanning Solutions or secret scanning Solutions in your like workflow to avoid committing credentials maybe",
    "start": "3058859",
    "end": "3065579"
  },
  {
    "text": "publicly because it's very trivial to uh like like you saw in the POC for code",
    "start": "3065579",
    "end": "3070680"
  },
  {
    "text": "spaces it's it is very trivial to create code spaces just by a valid token that you may have that belongs to some other",
    "start": "3070680",
    "end": "3077099"
  },
  {
    "text": "user if you're using authentication tokens in your workflows make sure that",
    "start": "3077099",
    "end": "3082920"
  },
  {
    "text": "uh the scope and the permissions that you assign to the Token are very limited",
    "start": "3082920",
    "end": "3089040"
  },
  {
    "text": "because there was a case that was reported to hacker one this was found on GitHub code spaces and uh there it was",
    "start": "3089040",
    "end": "3097319"
  },
  {
    "text": "found that on every code space that you create there was a personal access token the docker a personal access token or",
    "start": "3097319",
    "end": "3104160"
  },
  {
    "text": "for GitHub developer on every code space so while looking for the permissions that were assigned to the personal",
    "start": "3104160",
    "end": "3110520"
  },
  {
    "text": "access token it the permissions were like just public read so it was not very dangerous at all but that was a good",
    "start": "3110520",
    "end": "3117240"
  },
  {
    "text": "story if you even if you leak your tokens uh it does not do a lot of damage",
    "start": "3117240",
    "end": "3123079"
  },
  {
    "text": "auditing code space and access token usage so for the code spaces that you",
    "start": "3123079",
    "end": "3128819"
  },
  {
    "text": "create delete suspend assign permissions I mean the tokens that are generated for",
    "start": "3128819",
    "end": "3134280"
  },
  {
    "text": "your code space there are logs generated on the GitHub settings so you can take a",
    "start": "3134280",
    "end": "3139740"
  },
  {
    "text": "look into those and if you are on GitHub Enterprise then you can acquire them using the API as well and yeah so like",
    "start": "3139740",
    "end": "3146819"
  },
  {
    "text": "we saw any code space port URL it cannot be trusted at the first shot because",
    "start": "3146819",
    "end": "3153900"
  },
  {
    "text": "let's say if a friend of yours is saying hey I just made this cool website why didn't you just take a look at it here's the code space URL if you just open it",
    "start": "3153900",
    "end": "3160680"
  },
  {
    "text": "there may be a chance chances that your browser is outdated there is a zero day",
    "start": "3160680",
    "end": "3165839"
  },
  {
    "text": "in the uh in the published Port itself you may get compromised like that's a",
    "start": "3165839",
    "end": "3171480"
  },
  {
    "text": "very extreme level of compromise but that is still possible so you need to segregate your uh developer and",
    "start": "3171480",
    "end": "3178020"
  },
  {
    "text": "production environments so for example if your Linux server that is it's an ec2",
    "start": "3178020",
    "end": "3183059"
  },
  {
    "text": "instance it's a production server it should not be accessing code spaces URL because code spaces is a development",
    "start": "3183059",
    "end": "3189839"
  },
  {
    "text": "environment so you need to segregate between these two and like it it depends on the context as well but yeah",
    "start": "3189839",
    "end": "3198260"
  },
  {
    "text": "so that's it for code spaces and GitHub actions we are happy to take any questions if you may have yep thanks",
    "start": "3198359",
    "end": "3205740"
  },
  {
    "text": "everyone thank you [Applause]",
    "start": "3205740",
    "end": "3211738"
  }
]