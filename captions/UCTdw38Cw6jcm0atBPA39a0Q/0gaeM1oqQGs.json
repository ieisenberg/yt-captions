[
  {
    "text": "all right I think we're good to go so welcome welcome welcome this talk is a",
    "start": "4520",
    "end": "12000"
  },
  {
    "text": "demo based talk so it's going to be a lot of hacking it's going to be a lot of keyboard activity there going to be",
    "start": "12000",
    "end": "18320"
  },
  {
    "text": "demos all right so things might break don't worry usually we fix it okay don't",
    "start": "18320",
    "end": "25599"
  },
  {
    "text": "feel bad for me if something breaks if something doesn't work don't worry about it I don't this is hacking things tend",
    "start": "25599",
    "end": "33520"
  },
  {
    "text": "to break okay normally things run okay but still we're going to mess around",
    "start": "33520",
    "end": "39520"
  },
  {
    "text": "with some memory stuff we're going to mess around with back doors things can crash and so on so I am Chris Dale I'm",
    "start": "39520",
    "end": "48120"
  },
  {
    "text": "not Mor arti Mor arti is a super villain from the Sherlock Holmes books and videos right he's in this case the super",
    "start": "48120",
    "end": "56079"
  },
  {
    "text": "hacker because how can Mor arti always day one step ahead of the good guys how",
    "start": "56079",
    "end": "62840"
  },
  {
    "text": "is he always one step ahead of the detective Sherlock Holmes I in my",
    "start": "62840",
    "end": "68159"
  },
  {
    "text": "opinion is quite obvious he is a super hacker and he has access to all the systems all the back GS so he knows",
    "start": "68159",
    "end": "74720"
  },
  {
    "text": "their plans he knows what they're going to do when they're going to do it that way he can stay one step ahead so",
    "start": "74720",
    "end": "80479"
  },
  {
    "text": "hacking is awesome it's the way of the future for terrorists for criminals and",
    "start": "80479",
    "end": "86799"
  },
  {
    "text": "that's why we also needed to educate ourselves within cyber security only because it's so tremendously big",
    "start": "86799",
    "end": "92720"
  },
  {
    "text": "and important my daily job is penetration testing instant response",
    "start": "92720",
    "end": "98119"
  },
  {
    "text": "normally some people laugh when I say penetration testing because it sounds kind of funny but it's basically just",
    "start": "98119",
    "end": "104200"
  },
  {
    "text": "ethical hacking professional hacking right so I try to break into customer systems in order to determine the",
    "start": "104200",
    "end": "109240"
  },
  {
    "text": "business risk involved with those systems I am I'm also a teacher for science so travel around the world",
    "start": "109240",
    "end": "115200"
  },
  {
    "text": "teaching hacking techniques and instant response and exploits and stuff like like that so I have a good time teaching",
    "start": "115200",
    "end": "122320"
  },
  {
    "text": "all around the world like Saudi Arabia was my last destination it's like crazy everywhere they sent me so it's pretty",
    "start": "122320",
    "end": "128399"
  },
  {
    "text": "cool on my spare time I also do a lot of hacking so I'm actually lucky enough to",
    "start": "128399",
    "end": "133400"
  },
  {
    "text": "have my hobby as my day job because all it's like to hack and some of the",
    "start": "133400",
    "end": "139599"
  },
  {
    "text": "results from hacking has been medals and prices from different competitions for",
    "start": "139599",
    "end": "145680"
  },
  {
    "text": "example I went to Washington DC to play in what we call a tournament of Champions previous winners have captured",
    "start": "145680",
    "end": "152160"
  },
  {
    "text": "the flag events like competitions for hacking the most servers within a certain time limit I went there in a",
    "start": "152160",
    "end": "158400"
  },
  {
    "text": "place 20th out of 164 that's not too shabby but still you do there is a lot",
    "start": "158400",
    "end": "164400"
  },
  {
    "text": "of community within information security and if you want to get involved please do so because we need people we need",
    "start": "164400",
    "end": "170680"
  },
  {
    "text": "bright people and especially people who have developer backgrounds to help us",
    "start": "170680",
    "end": "175959"
  },
  {
    "text": "actually combat the the techniques and tools that the bad guys are using so this talk basically we're going to be",
    "start": "175959",
    "end": "183519"
  },
  {
    "text": "hacking right as I said we're going to be hacking servers and moror is going to",
    "start": "183519",
    "end": "189319"
  },
  {
    "text": "start out at a web server so we're targeting an organization called lead",
    "start": "189319",
    "end": "194799"
  },
  {
    "text": "host it's a hosting provider and this organization is actually quite secure when it comes to their external network",
    "start": "194799",
    "end": "201760"
  },
  {
    "text": "so they've had a lot of penetration tests happening however we're still going to look at how we can break in so",
    "start": "201760",
    "end": "207760"
  },
  {
    "text": "we're going to find a vulnerability we're going to hack the VB server we're going to upload back doors and then",
    "start": "207760",
    "end": "213239"
  },
  {
    "text": "we're going to make our way into the domain and eventually we're going to try to get keys to the kingdom which is the",
    "start": "213239",
    "end": "219280"
  },
  {
    "text": "domain administrator right so domain admin is like when you have that you can control the entire",
    "start": "219280",
    "end": "225840"
  },
  {
    "text": "business so my demo environment is quite simple on my laptop I have everything",
    "start": "225840",
    "end": "231959"
  },
  {
    "text": "virtualized I have my attacker a Linux box which is basically just kalii Linux",
    "start": "231959",
    "end": "237879"
  },
  {
    "text": "virtualized it's on the same host only Network as a server 2012 which has a web",
    "start": "237879",
    "end": "243480"
  },
  {
    "text": "server and a database on it kind of standard setup right and behind that so",
    "start": "243480",
    "end": "248519"
  },
  {
    "text": "this is the DMZ behind that I have my domain controller which will serve the users will serve policies and such on so",
    "start": "248519",
    "end": "257519"
  },
  {
    "text": "as I said it's a demo based presentation so why don't we just get on hacking huh",
    "start": "257519",
    "end": "264240"
  },
  {
    "text": "so let's start with looking at the website",
    "start": "264240",
    "end": "271240"
  },
  {
    "text": "like that just let me fix my presentation mode a sec let me duplicate the screen looks good so this is it",
    "start": "271240",
    "end": "277800"
  },
  {
    "text": "right this is everything that is exposed and let me challenge the audience what would be your initial",
    "start": "277800",
    "end": "284800"
  },
  {
    "text": "thought on how to hack this form anyone like seq injection yes so we're not",
    "start": "284800",
    "end": "292520"
  },
  {
    "text": "going to do that nope because that would be easy okay so not too many custom",
    "start": "292520",
    "end": "299520"
  },
  {
    "text": "customers today have SQL injection in their login form still because customers they tend to get audited and pent tested",
    "start": "299520",
    "end": "306919"
  },
  {
    "text": "on their external networks so a lot of people have been slamming these services and login forms already auditing for",
    "start": "306919",
    "end": "313280"
  },
  {
    "text": "known vulnerabilities right so instead we're going to look at something called",
    "start": "313280",
    "end": "318680"
  },
  {
    "text": "username enumeration and password spraying because what does most every",
    "start": "318680",
    "end": "325039"
  },
  {
    "text": "single system have on the internet they have login forms if you can have a list",
    "start": "325039",
    "end": "330639"
  },
  {
    "text": "of usernames and if you can find just one user with a bad password you will",
    "start": "330639",
    "end": "337000"
  },
  {
    "text": "extend your attack surface of that system and a lot of customers today they will only have their external side pen",
    "start": "337000",
    "end": "343360"
  },
  {
    "text": "tested because everyone already authenticated is trusted We Trust our",
    "start": "343360",
    "end": "348840"
  },
  {
    "text": "users right that's a big mistake all right so let's try to log on",
    "start": "348840",
    "end": "355240"
  },
  {
    "text": "with something like admin admin right I always try to figure out the system before I try to hack something you will",
    "start": "355240",
    "end": "362160"
  },
  {
    "text": "always see some newb hacker immediately trying to hack something before he even understands what the system is doing so",
    "start": "362160",
    "end": "368639"
  },
  {
    "text": "first of all we try to see what this system is doing and it says look the",
    "start": "368639",
    "end": "374120"
  },
  {
    "text": "login failed check your password right that's interesting not too subtle but",
    "start": "374120",
    "end": "381479"
  },
  {
    "text": "that's interesting that it says check your password so what if I type in a random string blah blah and they see",
    "start": "381479",
    "end": "388400"
  },
  {
    "text": "test it says login fail check your login name parenthesis username so that's",
    "start": "388400",
    "end": "395479"
  },
  {
    "text": "interesting right it's very explicit in this example but by actually testing",
    "start": "395479",
    "end": "401560"
  },
  {
    "text": "admin and a username that we don't we know don't exist we could immediately",
    "start": "401560",
    "end": "406960"
  },
  {
    "text": "see that look we know that admin exists so now we can use our word list to check",
    "start": "406960",
    "end": "412120"
  },
  {
    "text": "which other users exist for example I could scrape the LinkedIn page of all the employees of the business and try",
    "start": "412120",
    "end": "419120"
  },
  {
    "text": "first first names against last names and so on to see is there any usernames that exist in this system if there are they",
    "start": "419120",
    "end": "426759"
  },
  {
    "text": "might have a weak password that we can attack so we're going to default back to attacking users it's always the easiest",
    "start": "426759",
    "end": "433680"
  },
  {
    "text": "way in somewhere so how do we go about attacking this well first of all I need",
    "start": "433680",
    "end": "439280"
  },
  {
    "text": "to have a proxy set up a proxy just a tool which will capture all the requests",
    "start": "439280",
    "end": "444560"
  },
  {
    "text": "from my web browser before they are being sent to the web server let me demonst",
    "start": "444560",
    "end": "449840"
  },
  {
    "text": "St I'll try log on again with like admin admin and right away we can see that",
    "start": "449840",
    "end": "455800"
  },
  {
    "text": "look it has captured my requested web server I'm posting some data I'm posting",
    "start": "455800",
    "end": "461080"
  },
  {
    "text": "username admin password admin let's go so this request when I press forward",
    "start": "461080",
    "end": "467159"
  },
  {
    "text": "this is what will be Senter web server and I now I can edit it and I can do whatever I want but the interesting",
    "start": "467159",
    "end": "473120"
  },
  {
    "text": "thing to do when doing a username enumeration is using what we call a fuzzer a fuzzer is just a a tool that",
    "start": "473120",
    "end": "479840"
  },
  {
    "text": "will try multiple different types of values within a short time span or whatever time span we set so I just sent",
    "start": "479840",
    "end": "487560"
  },
  {
    "text": "my request my login request to a fusser and let me edit my little request first",
    "start": "487560",
    "end": "493800"
  },
  {
    "text": "of all let me remove the cookie because the cookie is",
    "start": "493800",
    "end": "499080"
  },
  {
    "text": "going to make the web server have some kind of State on me I don't want that I want every request to be a fresh request",
    "start": "499080",
    "end": "505599"
  },
  {
    "text": "and then I'll Define that look this little here",
    "start": "505599",
    "end": "511959"
  },
  {
    "text": "admin I replace it with some special characters meaning that this value should be replaced whatever payload I",
    "start": "511959",
    "end": "518959"
  },
  {
    "text": "set what whatever value I want it to be replaced with it will be replaced and let's look at some values",
    "start": "518959",
    "end": "525320"
  },
  {
    "text": "to replace so I have a little text file with different usernames known usernames",
    "start": "525320",
    "end": "531320"
  },
  {
    "text": "from like Linux systems like phpbb and so on just a list of typical usernames",
    "start": "531320",
    "end": "537600"
  },
  {
    "text": "okay so I've just loaded this in here and every single one of these text strings will be replaced",
    "start": "537600",
    "end": "544959"
  },
  {
    "text": "within here right quite simple so these values down here it's going to be the",
    "start": "544959",
    "end": "550800"
  },
  {
    "text": "the our testing and then I need to do some quick options because this login field is kind of special so it has some",
    "start": "550800",
    "end": "557600"
  },
  {
    "text": "funky funky settings so I need to process redirections and I need to process",
    "start": "557600",
    "end": "562760"
  },
  {
    "text": "cookies and basically that's it let's see what happens when we press attack",
    "start": "562760",
    "end": "568120"
  },
  {
    "text": "oops it's not going to take 10 minutes don't worry so immediately you will see",
    "start": "568120",
    "end": "573279"
  },
  {
    "text": "that my system is now trying to log in with different usernames boom boom boom boom boom boom just different usernames",
    "start": "573279",
    "end": "579120"
  },
  {
    "text": "go go go go go all with the same password admin right so we're not really trying to log on with any users we're",
    "start": "579120",
    "end": "584839"
  },
  {
    "text": "just trying to see what the error message is let me demonstrate the error",
    "start": "584839",
    "end": "591120"
  },
  {
    "text": "message in my",
    "start": "591120",
    "end": "594959"
  },
  {
    "text": "tool login fail check your password right that means that this username of admin",
    "start": "596200",
    "end": "602800"
  },
  {
    "text": "exists and also notice that the content length of this request the request the",
    "start": "602800",
    "end": "608120"
  },
  {
    "text": "response sorry coming back from the web server is 1472 while all the other ones are 1485",
    "start": "608120",
    "end": "616079"
  },
  {
    "text": "right so we have an outlier so let's sort by those and see look suddenly we",
    "start": "616079",
    "end": "621519"
  },
  {
    "text": "have a pattern of what we can assume is known usernames within application that",
    "start": "621519",
    "end": "627279"
  },
  {
    "text": "is an really interesting thing to find however most pentesters today they would",
    "start": "627279",
    "end": "633560"
  },
  {
    "text": "classify this finding as a low maybe medium risk finding in your application",
    "start": "633560",
    "end": "639120"
  },
  {
    "text": "and it probably won't recommend you to patch it immediately well it perhaps it should we'll we'll see in a minute right",
    "start": "639120",
    "end": "647079"
  },
  {
    "text": "so now that we have a list of users let's take those",
    "start": "647079",
    "end": "652480"
  },
  {
    "text": "users and add them to the list again in our Fuster let's define another value",
    "start": "652480",
    "end": "658760"
  },
  {
    "text": "that password field now we want to try all the known usernames against weak",
    "start": "658760",
    "end": "664120"
  },
  {
    "text": "passwords and typical weak passwords will be like for this case it would be lead hosts",
    "start": "664120",
    "end": "670320"
  },
  {
    "text": "2016 Summer 16 uh leost sucks 16 for those that",
    "start": "670320",
    "end": "676000"
  },
  {
    "text": "don't like their company and their their employer and so on so let me show you how I can change my attack that for",
    "start": "676000",
    "end": "683079"
  },
  {
    "text": "every username I will try a full list of passwords okay so I'll change my attack",
    "start": "683079",
    "end": "688600"
  },
  {
    "text": "to what they've dubbed cluster bomb attack sounds fancy right and I'll give",
    "start": "688600",
    "end": "693959"
  },
  {
    "text": "it some a list of passwords so these passwords in here those are just like",
    "start": "693959",
    "end": "699480"
  },
  {
    "text": "abc1 123 axis admin admin 123 change me change me is actually a lot of places",
    "start": "699480",
    "end": "705920"
  },
  {
    "text": "for default configuration on switches and routers and stuff it's quite quite nasty so just just a series of passwords",
    "start": "705920",
    "end": "713480"
  },
  {
    "text": "right let's try again so you'll see",
    "start": "713480",
    "end": "719800"
  },
  {
    "text": "it's trying for every username now it's trying the password AA and then it starts doing ABC for every username oh",
    "start": "719800",
    "end": "727079"
  },
  {
    "text": "sorry so he's just trying to log on right and how do we determine who is logged on well again we",
    "start": "727079",
    "end": "734639"
  },
  {
    "text": "just s by the length to see what is the difference who is the outlier here and immediately we see that the payload on",
    "start": "734639",
    "end": "741800"
  },
  {
    "text": "the left side Gordon B username Gordon B seems to have the password ABC one 2",
    "start": "741800",
    "end": "748120"
  },
  {
    "text": "three and let's check let's check what",
    "start": "748120",
    "end": "753920"
  },
  {
    "text": "responses have come back from web server let's do the",
    "start": "753920",
    "end": "758880"
  },
  {
    "text": "render ah it says greetings Gordon B so",
    "start": "759360",
    "end": "764399"
  },
  {
    "text": "a very simple attack showing how we could actually find a user to gain a login with let's see Gordon B actually",
    "start": "764399",
    "end": "771920"
  },
  {
    "text": "this is still hanging in my proxy so let's go back here let's try to log on with Gordon B",
    "start": "771920",
    "end": "779040"
  },
  {
    "text": "Gordon B abc1 123 and it works right so suddenly we",
    "start": "779040",
    "end": "785320"
  },
  {
    "text": "now have an increased attack surface and this is important because this is the place most businesses forget to test so",
    "start": "785320",
    "end": "793680"
  },
  {
    "text": "in my pen testing Endeavors I always ask to have credentials from a user like give me a test users user so I can test",
    "start": "793680",
    "end": "802320"
  },
  {
    "text": "within the application itself because we need to assume that bad guys already have access to our internal Network and",
    "start": "802320",
    "end": "808959"
  },
  {
    "text": "our uh external applications as a logged in user we have to assume that we have",
    "start": "808959",
    "end": "814079"
  },
  {
    "text": "to assume the worst and most likely they do have some kind of access if they want access so we got some functionality here",
    "start": "814079",
    "end": "821519"
  },
  {
    "text": "we'll look at that in a second but just a couple of quick poweron slides so how",
    "start": "821519",
    "end": "827079"
  },
  {
    "text": "do we protect against this well we could simply shun users or IP addresses that",
    "start": "827079",
    "end": "833360"
  },
  {
    "text": "make multiple fail logins right that could be really problematic especially when you have big customers that are all",
    "start": "833360",
    "end": "840199"
  },
  {
    "text": "coming from one IP and they're using your system and they would they they might have like 200 300 um fail login",
    "start": "840199",
    "end": "847199"
  },
  {
    "text": "attempts per day for example so you can't just block someone per an IP uh you can Implement capture you know these",
    "start": "847199",
    "end": "853519"
  },
  {
    "text": "little text forms that will ask you questions like find a cat whoa oh nice so so we got one guy",
    "start": "853519",
    "end": "860759"
  },
  {
    "text": "giving me a heads up look look at this stuff and all the rest of you are like hahaa this guy is making a fool of",
    "start": "860759",
    "end": "866639"
  },
  {
    "text": "himself but let me try to uh duplicate it and do an F5 and we need to go",
    "start": "866639",
    "end": "872160"
  },
  {
    "text": "actually shouldn't do F5 I should actually do the the button so where you have to figure out",
    "start": "872160",
    "end": "880320"
  },
  {
    "text": "the pictures of the cats and you click the cats and you you can log in once you have done those things right so that",
    "start": "880320",
    "end": "885880"
  },
  {
    "text": "works somewhat but we can break those as well so it helps adding a extra layer of",
    "start": "885880",
    "end": "892000"
  },
  {
    "text": "security you could make the attack really slow so the so the login form",
    "start": "892000",
    "end": "897680"
  },
  {
    "text": "could take a really long long time to process that is actually good practice as developers you guys should make the",
    "start": "897680",
    "end": "905120"
  },
  {
    "text": "login forms take a long time because the password algorithm that you're using to",
    "start": "905120",
    "end": "911000"
  },
  {
    "text": "Hash the passwords hopefully you are doing that should be slow it should be slow it should take like a second or two",
    "start": "911000",
    "end": "918399"
  },
  {
    "text": "or three to create the password hash of the user's H uh password so that compare",
    "start": "918399",
    "end": "924639"
  },
  {
    "text": "should also take time and of course two Factor authentication would definitely break this ATT most likely right if I",
    "start": "924639",
    "end": "930480"
  },
  {
    "text": "had to steal someone's phone it would be harder so with that we can now see what else exists on",
    "start": "930480",
    "end": "938440"
  },
  {
    "text": "this web server and I like to remind you though this could be game over from here",
    "start": "938440",
    "end": "944279"
  },
  {
    "text": "we have Gordon B's username and his password right what is the chances that Gordon B is using a different password",
    "start": "944279",
    "end": "951240"
  },
  {
    "text": "for every single service he is using it's quite low right I actually do it I",
    "start": "951240",
    "end": "957199"
  },
  {
    "text": "have a password manager and I have like unique passwords for everything so actually I I could actually show you my",
    "start": "957199",
    "end": "962600"
  },
  {
    "text": "Facebook password and it wouldn't really hurt anyone because it's like this long and if you could remember that I would love to have you hack me like that that",
    "start": "962600",
    "end": "968959"
  },
  {
    "text": "would be cool but think of like VPN endpoints a lot of businesses have some",
    "start": "968959",
    "end": "975040"
  },
  {
    "text": "kind of VPN login somewhere could you just log on with Gordon B abc123 on",
    "start": "975040",
    "end": "980560"
  },
  {
    "text": "their VPN and have ex internal access to the network I think you could most likely",
    "start": "980560",
    "end": "987160"
  },
  {
    "text": "you could just scan their Network find their VPN endpoint authenticate and it's",
    "start": "987160",
    "end": "992560"
  },
  {
    "text": "game over could be that easy right but no we're going to look at this web",
    "start": "992560",
    "end": "998319"
  },
  {
    "text": "application we're going to find some exploits and we're going to see how we can use it to gain uh a back door on the system so let's see back to the VB",
    "start": "998319",
    "end": "1006560"
  },
  {
    "text": "application let me do this like that",
    "start": "1006560",
    "end": "1014319"
  },
  {
    "text": "so we got we seem to have some kind of functionality here right it looks like a control panel of some sort uh we can",
    "start": "1014319",
    "end": "1020959"
  },
  {
    "text": "ping a server we can do a user search and we have an about us page this about",
    "start": "1020959",
    "end": "1027400"
  },
  {
    "text": "us page is interesting because it says that if you're worried about security you shouldn't be because they have",
    "start": "1027400",
    "end": "1032880"
  },
  {
    "text": "everything in order really you're laughing but if you think about it what is most vendors",
    "start": "1032880",
    "end": "1038720"
  },
  {
    "text": "saying to you today oh he look security worried about it don't worry we have like the best teams in the world they're all on top of everything all right so",
    "start": "1038720",
    "end": "1047360"
  },
  {
    "text": "there's some interesting vulnerabilities in Every Single Payer that's all right so so I know the developer who made",
    "start": "1047360",
    "end": "1055240"
  },
  {
    "text": "this it might be me but but there's some interesting parameters up here that's interesting uh the user search might be",
    "start": "1055240",
    "end": "1062520"
  },
  {
    "text": "connected to a database so there might be some SQL injection going on however",
    "start": "1062520",
    "end": "1067799"
  },
  {
    "text": "for this audience because most of you aren't security people I'll be demonstrating the Ping a",
    "start": "1067799",
    "end": "1073880"
  },
  {
    "text": "server hack so in this example it says enter the IP address you want ping and",
    "start": "1073880",
    "end": "1079720"
  },
  {
    "text": "there's a list of the IP addresses that most likely those are mine right those are Gordon be's IP addresses so always",
    "start": "1079720",
    "end": "1086559"
  },
  {
    "text": "the first thing we do try try the functionality and see how it works so we click ping ping that IP address one of",
    "start": "1086559",
    "end": "1093520"
  },
  {
    "text": "the lists and it gives us the reply and this reply is kind of familiar isn't it",
    "start": "1093520",
    "end": "1100000"
  },
  {
    "text": "what does it look like looks like Ping yeah but it looks",
    "start": "1100000",
    "end": "1105559"
  },
  {
    "text": "like Ping from Windows like from the Windows command line so immediately we're thinking aha the",
    "start": "1105559",
    "end": "1112520"
  },
  {
    "text": "developer probably didn't want to write his own ping in PHP or.net right so he",
    "start": "1112520",
    "end": "1118120"
  },
  {
    "text": "just made a system call down to the OS and made OS ping for him and just read the response from that really good idea",
    "start": "1118120",
    "end": "1124159"
  },
  {
    "text": "because then you don't have to rewrite functionality you can basically just reuse it and should be good right so",
    "start": "1124159",
    "end": "1130880"
  },
  {
    "text": "let's try something else like an interesting IP address to Ping would maybe be like Local Host can I ping",
    "start": "1130880",
    "end": "1136679"
  },
  {
    "text": "something else that isn't in the list just to just to learn right I'm interested I'm curious ahuh I get four",
    "start": "1136679",
    "end": "1143679"
  },
  {
    "text": "replies from Local Host so looks like I can ping anything so I could perhaps try to Ping Google if I was online or I",
    "start": "1143679",
    "end": "1149799"
  },
  {
    "text": "could ping anyone I could TI you with a ping if I wanted to but do I really want to do that no let's try something else",
    "start": "1149799",
    "end": "1156440"
  },
  {
    "text": "let's let's try to like add parameters like only ping one time does this",
    "start": "1156440",
    "end": "1163200"
  },
  {
    "text": "work and immediately I got a response much quicker right aha so I can actually add attributes to the pin command H what",
    "start": "1163840",
    "end": "1172159"
  },
  {
    "text": "about like Windows and Linux Solaris and most likely all OES they have a way to",
    "start": "1172159",
    "end": "1178080"
  },
  {
    "text": "concate commands so if you have one command on the left side if that runs okay run this command let's try that",
    "start": "1178080",
    "end": "1185640"
  },
  {
    "text": "let's let's see let's see let's see the Amper sand will concat concatenate another command let's try like di like",
    "start": "1185640",
    "end": "1191840"
  },
  {
    "text": "show show the directory contents ah suddenly we have have like",
    "start": "1191840",
    "end": "1198880"
  },
  {
    "text": "some kind of code execution right but we're limited to the commands in",
    "start": "1198880",
    "end": "1204640"
  },
  {
    "text": "OS so what would be like from here how would you hack This Server you can run any command and windows that you want",
    "start": "1204640",
    "end": "1211000"
  },
  {
    "text": "how would you do it say what python yeah definitely try python uh but we're on a",
    "start": "1211000",
    "end": "1218919"
  },
  {
    "text": "Windows box and so let's try let's try Powershell right yes let's try Powershell by the",
    "start": "1218919",
    "end": "1227880"
  },
  {
    "text": "way if this was Linux this would be game over from here okay we would do like a netcat back door and we would have a",
    "start": "1227880",
    "end": "1234200"
  },
  {
    "text": "fully functional functionality back door in within two minutes right from here from here but we still have like 40",
    "start": "1234200",
    "end": "1240679"
  },
  {
    "text": "minutes to go so so I'll do par shell command and I'll",
    "start": "1240679",
    "end": "1248440"
  },
  {
    "text": "do the ls command which is basically the same thing as dir partial Dash command",
    "start": "1248440",
    "end": "1254440"
  },
  {
    "text": "LS and suddenly we have the same type of input so now we have a programming environment at our hands",
    "start": "1254440",
    "end": "1262120"
  },
  {
    "text": "the attacker can now basically run any programming paral programming command",
    "start": "1262120",
    "end": "1267600"
  },
  {
    "text": "command light that he wants to and that gives us flexibility right that gives us a heap of",
    "start": "1267600",
    "end": "1274480"
  },
  {
    "text": "flexibility so let's see if we can find something interesting for example which user are we running like can I do like",
    "start": "1274480",
    "end": "1280240"
  },
  {
    "text": "uh LS perc user profile can I expand variables it looks like it can looks",
    "start": "1280240",
    "end": "1286000"
  },
  {
    "text": "like we're running as a user lead web leite hosts so Le hosts like missing uh",
    "start": "1286000",
    "end": "1292480"
  },
  {
    "text": "seven in there I wonder why it was a typo when I set up the server I noticed it like when I started",
    "start": "1292480",
    "end": "1299559"
  },
  {
    "text": "my demo and I'm like what why is there a missing a seven I'm so so stupid I was",
    "start": "1299559",
    "end": "1306480"
  },
  {
    "text": "thinking but right so we can now agree that this is quite dangerous right we",
    "start": "1306480",
    "end": "1313880"
  },
  {
    "text": "can run anything and we can get responses back with power shell so let's do a a quick",
    "start": "1313880",
    "end": "1321720"
  },
  {
    "text": "recap of what what actually went wrong here and how we can defend against this type of uh type of",
    "start": "1321720",
    "end": "1326760"
  },
  {
    "text": "attack so first of all developers made a mistake they didn't properly sanitize",
    "start": "1326760",
    "end": "1332720"
  },
  {
    "text": "the input coming from the user they didn't think that you could actually break out of the command and and actually do different stuff so there",
    "start": "1332720",
    "end": "1340200"
  },
  {
    "text": "should definitely be some wh listing and filtering going on for sure a web application F will could have rules",
    "start": "1340200",
    "end": "1348159"
  },
  {
    "text": "preventing this type of attack however in most cases we're able to bypass those okay it just takes a little bit more",
    "start": "1348159",
    "end": "1354360"
  },
  {
    "text": "trying and failing and we can most likely bypass web application firewalls but they're still nice to have don't get",
    "start": "1354360",
    "end": "1360120"
  },
  {
    "text": "me wrong um also web application firewalls support Whit listing so you could set up a regex saying that look an",
    "start": "1360120",
    "end": "1366080"
  },
  {
    "text": "IP address should only have like three numbers and a DOT one to three numbers and a DOT and so on that would be really",
    "start": "1366080",
    "end": "1372640"
  },
  {
    "text": "hard to hack wouldn't it if the only characters that you can input into that field was numbers and dots I don't know",
    "start": "1372640",
    "end": "1380320"
  },
  {
    "text": "how to hack that so that's definitely something good uh what about source code analysis",
    "start": "1380320",
    "end": "1386720"
  },
  {
    "text": "you could have tools there are lots of tools out there free and commercial that will automatically scan your source code",
    "start": "1386720",
    "end": "1392400"
  },
  {
    "text": "source code looking for known weaknesses like oh here's a blunder this is most likely a blunder because you're using",
    "start": "1392400",
    "end": "1398720"
  },
  {
    "text": "the xac command for example it's very dangerous oh you have a cross- siiz scripting vulnerability because you're",
    "start": "1398720",
    "end": "1404360"
  },
  {
    "text": "not filtering so there are tools to do that for you and of course ation testing would definitely find this I mean if if",
    "start": "1404360",
    "end": "1410480"
  },
  {
    "text": "your pentest team doesn't find something as open as this yeah you should re you",
    "start": "1410480",
    "end": "1416159"
  },
  {
    "text": "should have a refund to be honest and then there's the vulnerability scanning Parts which is basically a tool that",
    "start": "1416159",
    "end": "1422200"
  },
  {
    "text": "will try to simulate an attacker and see what's going on but still we're not done",
    "start": "1422200",
    "end": "1428000"
  },
  {
    "text": "yet right we need more access we Mor arti he's he's quite crazy so he's not",
    "start": "1428000",
    "end": "1433720"
  },
  {
    "text": "going to give up from just having some kind of remote command execution he wants full access so",
    "start": "1433720",
    "end": "1441080"
  },
  {
    "text": "preferably we want to have RDP okay some kind of gooey just so we can show that",
    "start": "1441080",
    "end": "1447520"
  },
  {
    "text": "the mouse is moving around and things are happening okay so let's let's see how that",
    "start": "1447520",
    "end": "1453799"
  },
  {
    "text": "works so bring up my Firefox so how would we go",
    "start": "1455159",
    "end": "1461400"
  },
  {
    "text": "about like uploading a back door like what's that all about well first we need",
    "start": "1461400",
    "end": "1466600"
  },
  {
    "text": "to create the back door we need to create some kind of Mal SL virus to actually help us out and that's quite",
    "start": "1466600",
    "end": "1473440"
  },
  {
    "text": "simple so it's actually super simple today because as they do in the developer",
    "start": "1473440",
    "end": "1479600"
  },
  {
    "text": "World they also do it in the security industry they try to make things as simple as possible to like show the",
    "start": "1479600",
    "end": "1485039"
  },
  {
    "text": "impact of something right so right here is my server I'm not going to touch that because that would be sheating but here",
    "start": "1485039",
    "end": "1491520"
  },
  {
    "text": "is my Linux hopefully things are working you never know but let's let's",
    "start": "1491520",
    "end": "1498600"
  },
  {
    "text": "see actually did some debugging from before let me check my IP address looks",
    "start": "1498600",
    "end": "1505360"
  },
  {
    "text": "like I'm on the same network you can all see that right in the back is it okay size good stuff so I'm on the same",
    "start": "1505360",
    "end": "1511960"
  },
  {
    "text": "network so I should be able to ping one at two 68 looks good right so in C",
    "start": "1511960",
    "end": "1520240"
  },
  {
    "text": "Linux there is a tool called msf Venom it's packaged",
    "start": "1520240",
    "end": "1526240"
  },
  {
    "text": "within a framework called Metasploit msf Venom allows us to create",
    "start": "1526240",
    "end": "1532799"
  },
  {
    "text": "viruses we can create power shell viruses Visual Basic viruses Linux",
    "start": "1532799",
    "end": "1537840"
  },
  {
    "text": "viruses and executable files so let's create an executable file let's see if I",
    "start": "1537840",
    "end": "1544760"
  },
  {
    "text": "have um nope so I have a little cheat cheet I'm going to copy paste some things just because it makes things",
    "start": "1544760",
    "end": "1551080"
  },
  {
    "text": "easier and you guys don't want to show uh you you don't really want to see my typos going on everywhere so let's paste that in here",
    "start": "1551080",
    "end": "1559440"
  },
  {
    "text": "so I'm telling my little msf Venom tool that I want to create an executable with",
    "start": "1559440",
    "end": "1566600"
  },
  {
    "text": "the payload meterpreter meterpreter is an inmemory rootkit for Windows it will",
    "start": "1566600",
    "end": "1572159"
  },
  {
    "text": "allow me full access to the system with the with the permissions the user is running us so that's the first part here",
    "start": "1572159",
    "end": "1579200"
  },
  {
    "text": "and then we have a remote connection coming back to us so we're telling anyone who is clicking our file that we",
    "start": "1579200",
    "end": "1584880"
  },
  {
    "text": "will creating now they should be connecting back to our IP address so normally this would be an online IP",
    "start": "1584880",
    "end": "1591000"
  },
  {
    "text": "address right I would have my domain name in there I have a special pentesting domain name which I use for",
    "start": "1591000",
    "end": "1596320"
  },
  {
    "text": "this stuff and which Port they should connect on so this will bypass every single firewall rule in the world most",
    "start": "1596320",
    "end": "1601600"
  },
  {
    "text": "likely because people are not filtering where they allowed to go on the internet most of people aren't and we'll put this",
    "start": "1601600",
    "end": "1610200"
  },
  {
    "text": "inside our web server so let's see can I actually visit this my own attacking",
    "start": "1610200",
    "end": "1616799"
  },
  {
    "text": "machine now and and see if there's a back door.",
    "start": "1616799",
    "end": "1620919"
  },
  {
    "text": "exe yes so when I visit my little URL from the attacker machine up here this is my Linux box we have our payload",
    "start": "1622159",
    "end": "1629559"
  },
  {
    "text": "ready the executable is ready to to be sent somewhere right how do we get this",
    "start": "1629559",
    "end": "1634840"
  },
  {
    "text": "file on board well it with Powershell maybe some of you guys know",
    "start": "1634840",
    "end": "1641760"
  },
  {
    "text": "this already but you can actually do just about everything with Powershell okay so we can actually do a simp",
    "start": "1641760",
    "end": "1647760"
  },
  {
    "text": "command called invoke web request and it will actually pretend to be a little browser and will go out online pulling",
    "start": "1647760",
    "end": "1655279"
  },
  {
    "text": "down whatever file you want so that's interesting let me copy that little command as well from chit just to make",
    "start": "1655279",
    "end": "1661480"
  },
  {
    "text": "sure we don't have typos so I'll show you so we do the",
    "start": "1661480",
    "end": "1669679"
  },
  {
    "text": "Powershell this is our Command injection right we have Powershell Dash command invoke web request really nice",
    "start": "1669679",
    "end": "1676480"
  },
  {
    "text": "commandlet and and we point it to our attacker IP address we point it to the back. exe I'm sorry if it's a little bit",
    "start": "1676480",
    "end": "1682480"
  },
  {
    "text": "small and we said look this file should be written to the user profile which is",
    "start": "1682480",
    "end": "1687720"
  },
  {
    "text": "people's home directory right SL user lead host and so on and we'll name the",
    "start": "1687720",
    "end": "1693080"
  },
  {
    "text": "file back door. exe let's see what happens did I",
    "start": "1693080",
    "end": "1700039"
  },
  {
    "text": "click oh yeah I did click looks like it clicked uh let's see if we can",
    "start": "1700039",
    "end": "1705440"
  },
  {
    "text": "um see if the file has been written so we'll do LS user",
    "start": "1705440",
    "end": "1712000"
  },
  {
    "text": "profile and VOA we now suddenly have a file on the system we told Parell",
    "start": "1713120",
    "end": "1719960"
  },
  {
    "text": "through the web server to hey go out to the internet pull down a file pull our malare and store it on the system but we",
    "start": "1719960",
    "end": "1727159"
  },
  {
    "text": "haven't executed anything have we no we just we just downloaded it before we run it though we need to",
    "start": "1727159",
    "end": "1734399"
  },
  {
    "text": "set up a server we need to have some kind of way to process a back door coming back to us so for that I'm going",
    "start": "1734399",
    "end": "1741480"
  },
  {
    "text": "to be I'm going to be using uh the metas spit framework basically it's a framework for hacking makes things",
    "start": "1741480",
    "end": "1747760"
  },
  {
    "text": "simple let's see if we can find it should have it up in the background",
    "start": "1747760",
    "end": "1754320"
  },
  {
    "text": "here we have some options just verifying that everything is looking good",
    "start": "1755000",
    "end": "1762320"
  },
  {
    "text": "and I'll set up my little server So This Server will just wait for anyone who's",
    "start": "1762320",
    "end": "1769200"
  },
  {
    "text": "trying to connect back to me with the uh with the virus I've created and if they",
    "start": "1769200",
    "end": "1774679"
  },
  {
    "text": "are clicking on a virus connecting back to me we should interact with it and have some kind of remote control so",
    "start": "1774679",
    "end": "1781600"
  },
  {
    "text": "let's see what happens if we click the file huh you click the file well you",
    "start": "1781600",
    "end": "1787200"
  },
  {
    "text": "don't really click the file but you run the file right you use partial don't even need to use poell let's just do %",
    "start": "1787200",
    "end": "1794799"
  },
  {
    "text": "user profile slash back back door. exe this should run the command",
    "start": "1794799",
    "end": "1800720"
  },
  {
    "text": "shouldn't it just like you would run ping from like system 32 or the windows folder this should run this executable",
    "start": "1800720",
    "end": "1807640"
  },
  {
    "text": "so let's see",
    "start": "1807640",
    "end": "1812799"
  },
  {
    "text": "H it's just hanging oh it doesn't return anything right that's interesting",
    "start": "1812799",
    "end": "1819159"
  },
  {
    "text": "because it's waiting for this executable to complete just like it was waiting for Ping to complete it's waiting for back",
    "start": "1819159",
    "end": "1825279"
  },
  {
    "text": "door to complete and back door is connecting back to me so let's look at our Linux and see if we have anything",
    "start": "1825279",
    "end": "1831360"
  },
  {
    "text": "going on oh we do it says look M meterpreter session two has been opened",
    "start": "1831360",
    "end": "1836640"
  },
  {
    "text": "you have an incoming connection from this web server interesting let's try to interact with",
    "start": "1836640",
    "end": "1843640"
  },
  {
    "text": "it suddenly we have command execution from a shell so we can run di oh sorry",
    "start": "1843640",
    "end": "1849919"
  },
  {
    "text": "LS we can type uh get U ID for example or let's do help let's look at the",
    "start": "1849919",
    "end": "1854960"
  },
  {
    "text": "commands we can actually run from this so I can kill any process process that I",
    "start": "1854960",
    "end": "1860039"
  },
  {
    "text": "want to I can migrate my process so instead of being inside the Apachi web",
    "start": "1860039",
    "end": "1865679"
  },
  {
    "text": "server I can migrate the the full rootkit the code of it through memory",
    "start": "1865679",
    "end": "1871279"
  },
  {
    "text": "into for example explorer.exe because explore that exe is never closed right",
    "start": "1871279",
    "end": "1876559"
  },
  {
    "text": "it's going to persist my malare ensuring that it won't get closed when someone reboots the web server or a thread or a",
    "start": "1876559",
    "end": "1883720"
  },
  {
    "text": "or application pulled eyes for example so very nice functionality I can cat",
    "start": "1883720",
    "end": "1889320"
  },
  {
    "text": "files I can remove files I can upload files I can typical networking commands",
    "start": "1889320",
    "end": "1895039"
  },
  {
    "text": "here and some interesting ones are I can do a key scan start this is a key logger",
    "start": "1895039",
    "end": "1902240"
  },
  {
    "text": "so I can just start the key logger have it running for 24 hours dump the output tomorrow and I'll have whatever is typed",
    "start": "1902240",
    "end": "1909360"
  },
  {
    "text": "on a keyboard on this from the server on my system that's really really nice I",
    "start": "1909360",
    "end": "1914639"
  },
  {
    "text": "could even if this was a client PC right if this wasn't a server I could activate",
    "start": "1914639",
    "end": "1919919"
  },
  {
    "text": "the VB camera and take a little snapshot of whoever sitting behind the screen I",
    "start": "1919919",
    "end": "1925279"
  },
  {
    "text": "could even have it stream data from me and I've done this a couple of times specifically for TV2 a big news channel",
    "start": "1925279",
    "end": "1931240"
  },
  {
    "text": "in Norway and I've done it against stov a news Anor he asked me like the day",
    "start": "1931240",
    "end": "1936600"
  },
  {
    "text": "before my interview he asked me hey is it like can you hack my Facebook is it simple it's not really simple to hack",
    "start": "1936600",
    "end": "1943320"
  },
  {
    "text": "Facebook but it could be simple to hack you uh are you giving me permissions and he's like yeah well yeah why not and",
    "start": "1943320",
    "end": "1951039"
  },
  {
    "text": "yeah for sure I I got a screenshot of him his face is kind of uh ah and I also did it to another reporter in TV2 and",
    "start": "1951039",
    "end": "1957720"
  },
  {
    "text": "they're using this material actually for for internal training right now to try educate people better to don't click",
    "start": "1957720",
    "end": "1963840"
  },
  {
    "text": "viruses basically so lots of different cool commands we can do from here um so this",
    "start": "1963840",
    "end": "1972200"
  },
  {
    "text": "is our back door running right and that's all nice and good but let's look",
    "start": "1972200",
    "end": "1978000"
  },
  {
    "text": "at some defenses from this no wait we were we told you that we're going to gain RDP sorry this is not RDP this is",
    "start": "1978000",
    "end": "1984720"
  },
  {
    "text": "only like a command axis so let's look at how we can get some RDP action here",
    "start": "1984720",
    "end": "1991240"
  },
  {
    "text": "so on a system the first thing an attacker will do if it's remotely good",
    "start": "1991240",
    "end": "1997919"
  },
  {
    "text": "okay he's going to try dump the password hashes from the system that means it's",
    "start": "1997919",
    "end": "2003559"
  },
  {
    "text": "going to try to gain the passwords but they're not in clear text most of the time they're hashed so he wants those so",
    "start": "2003559",
    "end": "2010519"
  },
  {
    "text": "he can start cracking them to try to gain passwords because they can be used elsewhere as well so for that I want to",
    "start": "2010519",
    "end": "2017519"
  },
  {
    "text": "upload some file some files so my little tool",
    "start": "2017519",
    "end": "2023960"
  },
  {
    "text": "here my interpreter my little back door supports uploading files as we saw in",
    "start": "2023960",
    "end": "2029760"
  },
  {
    "text": "the help list I could simply say I want to did you see",
    "start": "2029760",
    "end": "2035960"
  },
  {
    "text": "that I I should be offline so I don't want any like emails popping up like hey Chris it was really fun last night I",
    "start": "2035960",
    "end": "2043519"
  },
  {
    "text": "don't want that stuff to happen so I'm going to be uploading my kit my files my",
    "start": "2043519",
    "end": "2050118"
  },
  {
    "text": "I have a little zip file right with all my like hacker tools that I want onto the system most attackers or hackers",
    "start": "2050119",
    "end": "2057200"
  },
  {
    "text": "they have their own kit and we'll upload a kit because it it has some interesting uh",
    "start": "2057200",
    "end": "2063358"
  },
  {
    "text": "features let's see it's 18 megabytes it's fine and it",
    "start": "2063359",
    "end": "2069480"
  },
  {
    "text": "looks like it uploaded so from here I kind of like going back to the Windows command line so I'll type shell and look",
    "start": "2069480",
    "end": "2076320"
  },
  {
    "text": "at that we have like the Windows command line at our service so from here I could do like cd- CD do do CD do whatever I",
    "start": "2076320",
    "end": "2084480"
  },
  {
    "text": "could do dare I could do CD users I could do CD Elite web do leite host I",
    "start": "2084480",
    "end": "2091839"
  },
  {
    "text": "typ I can see that look I have my files uploaded so here's my back door that we're current ly running right we're",
    "start": "2091839",
    "end": "2097880"
  },
  {
    "text": "we're inside this back door. exe but just uploaded these files from",
    "start": "2097880",
    "end": "2103079"
  },
  {
    "text": "meter so it's a sip file right how do you unip from the command line in",
    "start": "2103079",
    "end": "2109839"
  },
  {
    "text": "Windows what you wish you wish it was just like unzip like it would be in any other",
    "start": "2109839",
    "end": "2117000"
  },
  {
    "text": "operating system like Linux for example let's try unzip no there's like nothing",
    "start": "2117000",
    "end": "2122640"
  },
  {
    "text": "that will help you unzip on Windows from the command line except power and I'll be",
    "start": "2122640",
    "end": "2129000"
  },
  {
    "text": "honest I'll be honest though I'm not going to try type this command because it's hilariously",
    "start": "2129000",
    "end": "2136800"
  },
  {
    "text": "long look at this stuff this is unzipping from the command line in Windows if anyone ever has a better way",
    "start": "2136800",
    "end": "2144200"
  },
  {
    "text": "of doing this than this way let me know after my talk okay but this should",
    "start": "2144200",
    "end": "2149839"
  },
  {
    "text": "hopefully extract my false and look at that we have our fals extracted that's good stuff so inside here I have a a",
    "start": "2149839",
    "end": "2156920"
  },
  {
    "text": "tool called mimic ads it's from GitHub that's fine it's an it's a really nice tool that will try to look through it",
    "start": "2156920",
    "end": "2163800"
  },
  {
    "text": "will scrape through memory looking for passwords in clear text and H in in a",
    "start": "2163800",
    "end": "2171000"
  },
  {
    "text": "hashed form this tool is is actually very very nice for attackers to use",
    "start": "2171000",
    "end": "2177359"
  },
  {
    "text": "let's run it uh I believe we need to have",
    "start": "2177359",
    "end": "2184319"
  },
  {
    "text": "uh the debug privileges open that's the typo that's why we do the copy pasting",
    "start": "2184319",
    "end": "2190640"
  },
  {
    "text": "right privilege debug so that means I'm granting this tool to have debug",
    "start": "2190640",
    "end": "2198040"
  },
  {
    "text": "privileges inside windows and I know there's a lot ofet developers here here",
    "start": "2198040",
    "end": "2203400"
  },
  {
    "text": "so you might know what the debug privilege means for a user in Windows",
    "start": "2203400",
    "end": "2208800"
  },
  {
    "text": "local administrators normally have debug privileges it means that a process can",
    "start": "2208800",
    "end": "2215200"
  },
  {
    "text": "interact with another process process debugging it and also having its code",
    "start": "2215200",
    "end": "2220560"
  },
  {
    "text": "run inside other processes code and even access the memory space of those",
    "start": "2220560",
    "end": "2226200"
  },
  {
    "text": "processes so that's what we're doing here if we didn't have local admin in this case it wouldn't happen so let's",
    "start": "2226200",
    "end": "2232319"
  },
  {
    "text": "cover that in a bit okay then we'll do secure LSA log on",
    "start": "2232319",
    "end": "2238200"
  },
  {
    "text": "password again typo let's just do the copy pasting phrase it's no problem much",
    "start": "2238200",
    "end": "2243560"
  },
  {
    "text": "easier to just do copy paste we tell mimicat to look for log on",
    "start": "2243560",
    "end": "2249359"
  },
  {
    "text": "passwords and we have a long list of outputs let's look at these things the",
    "start": "2249359",
    "end": "2254920"
  },
  {
    "text": "first thing we have is an interactive log on to the computer from the",
    "start": "2254920",
    "end": "2260560"
  },
  {
    "text": "administrator and this user has no password interesting there is a hash",
    "start": "2260560",
    "end": "2266400"
  },
  {
    "text": "here that we could crack or we could use as a notification mechanism but still",
    "start": "2266400",
    "end": "2271880"
  },
  {
    "text": "there's no password in clear text that's because Windows Server 2012 R2 ha actually has something called protected",
    "start": "2271880",
    "end": "2278280"
  },
  {
    "text": "admin so they try not to store the user's clear text password in memory so",
    "start": "2278280",
    "end": "2283920"
  },
  {
    "text": "it's a really good security feature added by windows and let's look for uh different things here oh look at",
    "start": "2283920",
    "end": "2291359"
  },
  {
    "text": "this suddenly we have the web user the",
    "start": "2291359",
    "end": "2296520"
  },
  {
    "text": "password in clear text because that user wasn't covered by the protected admin",
    "start": "2296520",
    "end": "2302760"
  },
  {
    "text": "module so mimicas simply took the password straight St out of memory and",
    "start": "2302760",
    "end": "2307920"
  },
  {
    "text": "we could use this for remote authentication that's no fun is it it's just having the password and clear text",
    "start": "2307920",
    "end": "2315200"
  },
  {
    "text": "nah so this ntlm hash that I've highlighted is the password",
    "start": "2315200",
    "end": "2320480"
  },
  {
    "text": "representation right so let's just pretend we don't have any clar text password okay let's crack this little",
    "start": "2320480",
    "end": "2330480"
  },
  {
    "text": "sucker so for cracking I will be using a tool called hashcat hashcat will",
    "start": "2330480",
    "end": "2336839"
  },
  {
    "text": "interact with my GPU and it will try super many it will actually try to",
    "start": "2336839",
    "end": "2344119"
  },
  {
    "text": "crack it will try to crack",
    "start": "2344160",
    "end": "2349119"
  },
  {
    "text": "66,000 plus three zeros like like 66 Millions 6.6 million passwords a second",
    "start": "2349920",
    "end": "2358240"
  },
  {
    "text": "is going to try cracking the hash so I have a word list right with 58 million",
    "start": "2358240",
    "end": "2364000"
  },
  {
    "text": "words in it my word list will be what we call mangled so I'm going to try lead",
    "start": "2364000",
    "end": "2370560"
  },
  {
    "text": "speak replacement so every I will be replaced with an one every uh I'll will",
    "start": "2370560",
    "end": "2376040"
  },
  {
    "text": "add exclamation marks I'll automatically add like 2016 behind every word and I'll crack it and running this GPU cracking",
    "start": "2376040",
    "end": "2384920"
  },
  {
    "text": "tool it's super quick and we can see that the password crack almost instantly",
    "start": "2384920",
    "end": "2390599"
  },
  {
    "text": "this hash which I copy pasted represented the password manager7 so really from here all we have",
    "start": "2390599",
    "end": "2399040"
  },
  {
    "text": "to do hopefully is try to authenticate oh that's the domain",
    "start": "2399040",
    "end": "2405720"
  },
  {
    "text": "controller let's see username is correct so let's do",
    "start": "2405920",
    "end": "2412319"
  },
  {
    "text": "manager7 ahuh so we could suddenly log on to the web server that's cool and as any good",
    "start": "2412880",
    "end": "2420520"
  },
  {
    "text": "attacker does the first thing you do when you hack something is you bring up the terminal window because you really",
    "start": "2420520",
    "end": "2426680"
  },
  {
    "text": "need a guy right you really don't need a guey let's see yeah so we are running as",
    "start": "2426680",
    "end": "2432800"
  },
  {
    "text": "this user um let's see uh Elite web so that's interesting we can now browse",
    "start": "2432800",
    "end": "2438640"
  },
  {
    "text": "through the system we could like look for uh Network machines if there's anything on here look through your local dis look",
    "start": "2438640",
    "end": "2446119"
  },
  {
    "text": "through the scripts that is hosted from for example aphi so we can basically do whatever",
    "start": "2446119",
    "end": "2452760"
  },
  {
    "text": "access this user have from the guy a lot of people appreciate the GUI but we don't really need it as you've",
    "start": "2452760",
    "end": "2458599"
  },
  {
    "text": "seen so let's cover some defenses for this because it's kind of important kind",
    "start": "2458599",
    "end": "2463920"
  },
  {
    "text": "of important not to have this happen to your",
    "start": "2463920",
    "end": "2467680"
  },
  {
    "text": "environment first of all Believe It or Not antivirus could help all right it",
    "start": "2469760",
    "end": "2475240"
  },
  {
    "text": "could help so we'll bypass antivirus no problem okay any time of the week we'll",
    "start": "2475240",
    "end": "2480319"
  },
  {
    "text": "bypass antivirus however we're lazy attackers are very often lazy so they'll",
    "start": "2480319",
    "end": "2486520"
  },
  {
    "text": "get caught a couple of times by the antivirus while they're trying and failing and that will create alarms in",
    "start": "2486520",
    "end": "2493400"
  },
  {
    "text": "your environment so hopefully your it operations will actually react to those alarms and check out why this web server",
    "start": "2493400",
    "end": "2500119"
  },
  {
    "text": "is acting strangely right also your firewell rules should never allow a",
    "start": "2500119",
    "end": "2506720"
  },
  {
    "text": "server to talk to the internet why would your servers be allowed to talk to",
    "start": "2506720",
    "end": "2511839"
  },
  {
    "text": "anyone on Internet it's quite stupid you should allow connection coming in and",
    "start": "2511839",
    "end": "2517440"
  },
  {
    "text": "you should allow your server to reply to those connections that's a stateful firewall right but should you should not",
    "start": "2517440",
    "end": "2523319"
  },
  {
    "text": "allow this web server to initiate connections to anyone on the internet that's just bad",
    "start": "2523319",
    "end": "2529000"
  },
  {
    "text": "practice and again our user the VB user was the a local admin and that's",
    "start": "2529000",
    "end": "2535680"
  },
  {
    "text": "interesting why was it local admin Well turns out that it2 operations had big problems with",
    "start": "2535680",
    "end": "2542720"
  },
  {
    "text": "permissions Windows permissions is hell and and basically to fix the problem",
    "start": "2542720",
    "end": "2547760"
  },
  {
    "text": "they just gave the user all the permissions and it worked and they're like hauh that's convenient and they",
    "start": "2547760",
    "end": "2553119"
  },
  {
    "text": "left it like that but this user is not domain admin okay so he doesn't have any",
    "start": "2553119",
    "end": "2560440"
  },
  {
    "text": "access except access to the web server while domain admin access means access",
    "start": "2560440",
    "end": "2566440"
  },
  {
    "text": "to the entire Kingdom keys to the kingdom okay so we're going to go back",
    "start": "2566440",
    "end": "2572680"
  },
  {
    "text": "to the demo and look at how can we use our access to elevate our privileges to",
    "start": "2572680",
    "end": "2579079"
  },
  {
    "text": "become domain admin that's our next goal so let's look at this server again then",
    "start": "2579079",
    "end": "2585599"
  },
  {
    "text": "we'll be using we can use uh let's see close this",
    "start": "2585599",
    "end": "2590200"
  },
  {
    "text": "one I think we can just use the RDP that should work because I mean it's a legitimate connection right we are the",
    "start": "2593040",
    "end": "2599440"
  },
  {
    "text": "hacker we're on top of the server so let's see um let's go back to our files",
    "start": "2599440",
    "end": "2605480"
  },
  {
    "text": "and see which files we have on our system so while when I uploaded files my",
    "start": "2605480",
    "end": "2611640"
  },
  {
    "text": "little toolkit my kit we also uploaded something called a pyak does anyone know",
    "start": "2611640",
    "end": "2617359"
  },
  {
    "text": "what the Pak is it's a python keros exploit",
    "start": "2617359",
    "end": "2623160"
  },
  {
    "text": "kit H and Cur is Authentication Protocol for Microsoft and windows machines right",
    "start": "2623160",
    "end": "2630119"
  },
  {
    "text": "Microsoft Windows machines those are those are most likely all using Cerros for authentication it's it's quite good",
    "start": "2630119",
    "end": "2636079"
  },
  {
    "text": "good protocol however in 2014 late 2014",
    "start": "2636079",
    "end": "2641200"
  },
  {
    "text": "there was a Windows update patch you guys know those right Windows updates they're kind of important",
    "start": "2641200",
    "end": "2648079"
  },
  {
    "text": "actually there was one patch ms14 D68 so 14 means that is it it was",
    "start": "2648079",
    "end": "2655800"
  },
  {
    "text": "released in 2014 and 68 is the number they've given it it was a vulnerability",
    "start": "2655800",
    "end": "2661720"
  },
  {
    "text": "that allowed anyone to create a fake Cur Ros Authentication ticket pretending to",
    "start": "2661720",
    "end": "2667760"
  },
  {
    "text": "be domain admin huh that is bad any",
    "start": "2667760",
    "end": "2674160"
  },
  {
    "text": "domain user can suddenly become king in your environment can you imagine that if",
    "start": "2674160",
    "end": "2680000"
  },
  {
    "text": "you don't patch that immediately any willy-nilly script Kitty or or anyone who wants to take full access to your",
    "start": "2680000",
    "end": "2687680"
  },
  {
    "text": "kingdom could do it just like that and I'll show you just like that it would be",
    "start": "2687680",
    "end": "2692760"
  },
  {
    "text": "kind of embarrassing if this demo fail right now as I it's just going to be like that and I can't do it right so",
    "start": "2692760",
    "end": "2699559"
  },
  {
    "text": "let's run up pek and let's see what it's all about so I've downloaded the the the",
    "start": "2699559",
    "end": "2706400"
  },
  {
    "text": "proof of concept code that will allow me to run this uh this code this this",
    "start": "2706400",
    "end": "2712119"
  },
  {
    "text": "little file I'll run it first let's see let's see how it behaves I think we have time looks",
    "start": "2712119",
    "end": "2718400"
  },
  {
    "text": "good whoa sorry",
    "start": "2718400",
    "end": "2724880"
  },
  {
    "text": "python so this script requires some parameters",
    "start": "2724880",
    "end": "2730520"
  },
  {
    "text": "first of all it requires the Sid the users's Sid then it needs to have the",
    "start": "2730520",
    "end": "2735640"
  },
  {
    "text": "domain controller's IP address and the the domain we're talking to so the Sid",
    "start": "2735640",
    "end": "2741520"
  },
  {
    "text": "is basically this long string up here so it's no it's no secrets it's just your unique identifier to The Domain so it's",
    "start": "2741520",
    "end": "2748880"
  },
  {
    "text": "not really a lot of advanced stuff going on here so I'm going to give these parameters to the",
    "start": "2748880",
    "end": "2754880"
  },
  {
    "text": "tool and let's see if we can create a",
    "start": "2754880",
    "end": "2760880"
  },
  {
    "text": "ticket and it requires a password so that's interesting thing right we need to have some kind of password in clear",
    "start": "2760880",
    "end": "2767280"
  },
  {
    "text": "text and our password was yes manager 007 I had my demo fail",
    "start": "2767280",
    "end": "2774559"
  },
  {
    "text": "once because I typed in master7 multiple times manager 007 I will never do that",
    "start": "2774559",
    "end": "2782000"
  },
  {
    "text": "mistake again so it it gives us a lot of done messages looks good right we type",
    "start": "2782000",
    "end": "2787119"
  },
  {
    "text": "Di and we have a little file here this file is basically a ticket granting",
    "start": "2787119",
    "end": "2792720"
  },
  {
    "text": "ticket it's basically a ticket giving us authentication but it's just as a file",
    "start": "2792720",
    "end": "2798440"
  },
  {
    "text": "right we need some way to load it into the system actually we'll be loading it into memory and we'll be doing that",
    "start": "2798440",
    "end": "2805680"
  },
  {
    "text": "using a different tool called mimic ads which has a lot of ceros interaction modules as well so mimicat support",
    "start": "2805680",
    "end": "2812800"
  },
  {
    "text": "interacting with keros tickets and we'll use mimicat to push this ticket inside",
    "start": "2812800",
    "end": "2820280"
  },
  {
    "text": "our memory so let's uh CD into the correct",
    "start": "2820280",
    "end": "2827720"
  },
  {
    "text": "directory oh well iMat",
    "start": "2827880",
    "end": "2833279"
  },
  {
    "text": "drunk so mimic ads can be run interactively or it can be run from the command line right now I'll run it",
    "start": "2834800",
    "end": "2841160"
  },
  {
    "text": "strictly from the command line giving it the parameters to pass this ticket into memory and I'll point it to c/ users and",
    "start": "2841160",
    "end": "2850440"
  },
  {
    "text": "our user that the user file I just created the ticket file and I'll exit immediately let's try",
    "start": "2850440",
    "end": "2856000"
  },
  {
    "text": "this actually wait before I do I I promised you I wasn't domain admin right",
    "start": "2856000",
    "end": "2863359"
  },
  {
    "text": "challenge me like ah he's lying he's probably domain admin all right ad yes I'm not a domain admin so",
    "start": "2863359",
    "end": "2872440"
  },
  {
    "text": "let's check okay let's do check net User Group domain admins and see the users in the domain",
    "start": "2872440",
    "end": "2879920"
  },
  {
    "text": "admin group is the administrator only one user right let me try also net",
    "start": "2879920",
    "end": "2885559"
  },
  {
    "text": "use let me copy that command because my host name for the domain controller is hilariously bad let me try to mount the",
    "start": "2885559",
    "end": "2894040"
  },
  {
    "text": "C drive okay the C drive of the domain controller you shouldn't be able to to",
    "start": "2894040",
    "end": "2899119"
  },
  {
    "text": "interact with that drive and browser files unless you have permissions and as",
    "start": "2899119",
    "end": "2904359"
  },
  {
    "text": "you can see that it giving me the prompt to enter your username and password that means it already tried your credentials",
    "start": "2904359",
    "end": "2910640"
  },
  {
    "text": "as the elad web user and it didn't work so please give me the permissions we'll",
    "start": "2910640",
    "end": "2915680"
  },
  {
    "text": "cancel out that and that's a proof of concept I just showed you we don't have access",
    "start": "2915680",
    "end": "2921200"
  },
  {
    "text": "right and let's now load this little uh ticket into memory let's [Music]",
    "start": "2921200",
    "end": "2926800"
  },
  {
    "text": "see there is looks",
    "start": "2926800",
    "end": "2934599"
  },
  {
    "text": "good did you see that you never know what kind of",
    "start": "2934599",
    "end": "2939880"
  },
  {
    "text": "information you will be showing people so I just listed up my tickets and to be honest it looks good let's try the net",
    "start": "2939880",
    "end": "2947119"
  },
  {
    "text": "use again basically I'm mapping a network drive nope let's see",
    "start": "2947119",
    "end": "2954920"
  },
  {
    "text": "wi okay let's P let's do this again I just removed all the tickets oh",
    "start": "2954920",
    "end": "2962119"
  },
  {
    "text": "and it doesn't work so I said it would be embarrassing if it didn't work and it's actually quite embarrassing right",
    "start": "2962119",
    "end": "2967640"
  },
  {
    "text": "now but just give me a second to debug let's see let's see uh we have let's see I think we need to look at our ticket",
    "start": "2967640",
    "end": "2973839"
  },
  {
    "text": "let's see how our Command ran let's see this one let's see we're giving it this python",
    "start": "2973839",
    "end": "2980720"
  },
  {
    "text": "script we we're giving it a username a domain we're giving the Sid and I",
    "start": "2980720",
    "end": "2986480"
  },
  {
    "text": "verified the Sid ear today it should work and the domain Elite host so that should work let's actually create",
    "start": "2986480",
    "end": "2993240"
  },
  {
    "text": "another ticket because I think something went wrong wrong you never know and the these things they've been written to be",
    "start": "2993240",
    "end": "2999640"
  },
  {
    "text": "easy but they're not like super robust you never know right uh let's",
    "start": "2999640",
    "end": "3007640"
  },
  {
    "text": "see let run it one more time nope wrong command Let's see we",
    "start": "3008160",
    "end": "3014040"
  },
  {
    "text": "have our Command up here this one",
    "start": "3014040",
    "end": "3020319"
  },
  {
    "text": "and to be honest it looks good to me manager",
    "start": "3020319",
    "end": "3025960"
  },
  {
    "text": "7 that's my password by the way so check it out try my LinkedIn and so",
    "start": "3025960",
    "end": "3031200"
  },
  {
    "text": "on I'm just kidding and yeah it did say done on everything so let's go back to",
    "start": "3031200",
    "end": "3036839"
  },
  {
    "text": "mimic apps let's just try it one more time if it doesn't work I'll show you guys still so don't worry about",
    "start": "3036839",
    "end": "3044480"
  },
  {
    "text": "it so no I want to purge my tickets first first just remove all the tickets",
    "start": "3047559",
    "end": "3052880"
  },
  {
    "text": "all the authentication tickets you already have on the system just remove move those so you have a clear Clean Slate",
    "start": "3052880",
    "end": "3058400"
  },
  {
    "text": "right looks good Elite web Elite host would be cool if it actually worked",
    "start": "3058400",
    "end": "3065240"
  },
  {
    "text": "but the honest truth though is I I tested this like 30 minutes before I came down here for the demo and and I",
    "start": "3065240",
    "end": "3071240"
  },
  {
    "text": "reboot it just to make sure that there wasn't any caching going on ah and it",
    "start": "3071240",
    "end": "3076400"
  },
  {
    "text": "worked right nice thank you thank you",
    "start": "3076400",
    "end": "3082680"
  },
  {
    "text": "nice nice so let's brow the domain controller let's look in the",
    "start": "3082680",
    "end": "3088280"
  },
  {
    "text": "windows directory let's look in system 32 let's look for a very specific",
    "start": "3088280",
    "end": "3094079"
  },
  {
    "text": "file that is called ntds.dit this file 8.4 gigabytes what file is",
    "start": "3094079",
    "end": "3101559"
  },
  {
    "text": "this ad ad this is active directory okay copy this file back to your own system",
    "start": "3101559",
    "end": "3108760"
  },
  {
    "text": "you have all the user hashes of all the users in the domain all right",
    "start": "3108760",
    "end": "3116359"
  },
  {
    "text": "let's just look at a couple of things here so what went wrong we forgot Windows",
    "start": "3116359",
    "end": "3122760"
  },
  {
    "text": "update I have clients that refuses to patch domain controllers because they",
    "start": "3122760",
    "end": "3129079"
  },
  {
    "text": "are afraid they will crash while they're doing so if the domain controls go down everything goes down so their most vable",
    "start": "3129079",
    "end": "3136680"
  },
  {
    "text": "services in the entire organization multinational companies is the domain",
    "start": "3136680",
    "end": "3142640"
  },
  {
    "text": "controller so I had them pass this specifically this I forced them to patch",
    "start": "3142640",
    "end": "3147839"
  },
  {
    "text": "this so definitely Windows updates matter but I want to bring up a scenario",
    "start": "3147839",
    "end": "3153680"
  },
  {
    "text": "which I'm not going to demo because it takes a little while but with this ad",
    "start": "3153680",
    "end": "3158799"
  },
  {
    "text": "dumped I have a very specific of special users password hash the krbtgt user this",
    "start": "3158799",
    "end": "3167680"
  },
  {
    "text": "user is a user that creates tickets if I have that user hash I can basically",
    "start": "3167680",
    "end": "3174559"
  },
  {
    "text": "create tickets to my own on demand whenever I want to and I can create",
    "start": "3174559",
    "end": "3179640"
  },
  {
    "text": "tickets that will grant me 10 years for example of domain admin to your",
    "start": "3179640",
    "end": "3186720"
  },
  {
    "text": "environment oo and how do you fix that well it turns out that if you change",
    "start": "3186720",
    "end": "3192200"
  },
  {
    "text": "your krbtgt hash the password if you change the password two times my ticket",
    "start": "3192200",
    "end": "3198319"
  },
  {
    "text": "will be invalidated and I would have to hack them again and dump the hash but two times it goes two times because a",
    "start": "3198319",
    "end": "3205440"
  },
  {
    "text": "password rotation and a history it has to rotate so it doesn't remember the hash I had when I dumped it and just if",
    "start": "3205440",
    "end": "3213440"
  },
  {
    "text": "you try to reset that user two times you're going to have hell it's not going",
    "start": "3213440",
    "end": "3218760"
  },
  {
    "text": "to be pretty your link is going to die exchange is probably going to die you're going to have stuff happening that you",
    "start": "3218760",
    "end": "3224440"
  },
  {
    "text": "can't explain because so many things is relying on having week-long tickets in",
    "start": "3224440",
    "end": "3229480"
  },
  {
    "text": "their systems so when suddenly all the tickets are invalidated things stop working so normally you would have to",
    "start": "3229480",
    "end": "3236040"
  },
  {
    "text": "like wait a week and then reset the second time giving the attacker a lot of",
    "start": "3236040",
    "end": "3241680"
  },
  {
    "text": "time to regain his foot do dump the hashes again try to compromise different",
    "start": "3241680",
    "end": "3247040"
  },
  {
    "text": "users compromise domain admins that that didn't reset their password and so on it's really really hard to recover from",
    "start": "3247040",
    "end": "3254720"
  },
  {
    "text": "all right so I think we're on time is there any questions because we have five",
    "start": "3254720",
    "end": "3259880"
  },
  {
    "text": "minutes don't we five minutes yeah so is there any questions on this hacking activities",
    "start": "3259880",
    "end": "3266079"
  },
  {
    "text": "I expect there to be questions because I'm Norwegian and you're Norwegians and everyone is saying that Norwegians they don't ask questions so bring it on come",
    "start": "3266079",
    "end": "3273359"
  },
  {
    "text": "on go you had local admin access could you uninstall the Windows update p o",
    "start": "3273359",
    "end": "3279200"
  },
  {
    "text": "definitely you could but not on a domain controller so this patch is for the",
    "start": "3279200",
    "end": "3284720"
  },
  {
    "text": "domain control but I love the idea though to uninstall the protective mechanisms we do that for AV sometimes",
    "start": "3284720",
    "end": "3290359"
  },
  {
    "text": "when we have local admin good question right are are you a Norwegian ah",
    "start": "3290359",
    "end": "3297200"
  },
  {
    "text": "[Laughter] represent nice all right anyone else before we finish okay go how can sure",
    "start": "3297200",
    "end": "3304440"
  },
  {
    "text": "your tools are not infected by something made by someone so very valid question",
    "start": "3304440",
    "end": "3309760"
  },
  {
    "text": "so this tool is open source so you can go manually and review the source code for many of my tools and my team we",
    "start": "3309760",
    "end": "3316400"
  },
  {
    "text": "actually do source code review before we use tools especially new tools that have just been released there are multiple",
    "start": "3316400",
    "end": "3322680"
  },
  {
    "text": "cases online where we're seen people releasing some kind of tool and it's",
    "start": "3322680",
    "end": "3327799"
  },
  {
    "text": "actually infected right so you certainly have access to a security researcher PC because they were dumb enough to run",
    "start": "3327799",
    "end": "3333880"
  },
  {
    "text": "your tool without checking it but tools such as like metal split meter msf Venom",
    "start": "3333880",
    "end": "3340319"
  },
  {
    "text": "those have been scrutinized by the security industry for many many many years is a very highly renowned company",
    "start": "3340319",
    "end": "3346440"
  },
  {
    "text": "called rapid 7 which is developing it and they have a quite good reputation s",
    "start": "3346440",
    "end": "3352359"
  },
  {
    "text": "so to speak right so that's nice at least that gives you you some Assurance anyone",
    "start": "3352359",
    "end": "3358000"
  },
  {
    "text": "else all right so thank you very much everyone I'm glad we got a full pack of",
    "start": "3358000",
    "end": "3363640"
  },
  {
    "text": "people in here thank you very [Applause] [Music]",
    "start": "3363640",
    "end": "3369709"
  },
  {
    "text": "much",
    "start": "3383920",
    "end": "3386920"
  },
  {
    "text": "e",
    "start": "3413880",
    "end": "3416880"
  },
  {
    "text": "e",
    "start": "3443799",
    "end": "3446799"
  }
]