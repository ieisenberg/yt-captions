[
  {
    "text": "good afternoon everyone I'm Kyle thank you for coming I know there's a bit of a storm out there in this area so a lot of",
    "start": "4240",
    "end": "9760"
  },
  {
    "text": "people are wanting to go home early but I appreciate you being able to make it to the talk so uh we're talking of",
    "start": "9760",
    "end": "15599"
  },
  {
    "text": "course about supply chain attacks particularly in terraform if you're devops infrastructure platform engineer",
    "start": "15599",
    "end": "21279"
  },
  {
    "text": "whatever you want to call it these days uh you've probably worked with terraform or at least familiar with it in some regard uh as well as the terraform",
    "start": "21279",
    "end": "27439"
  },
  {
    "text": "registry which is used to store a lot of the uh open-source Community content",
    "start": "27439",
    "end": "32758"
  },
  {
    "text": "that is used with terraform frequently and today we're going to talk a bit about supply chain attacks in general uh",
    "start": "32759",
    "end": "38840"
  },
  {
    "text": "and then do a live demo of how we can actually apply that uh to steal a bunch of credentials uh from terraform",
    "start": "38840",
    "end": "45600"
  },
  {
    "text": "users a bit about my background I studied at the Massachusetts Institute of Technology where I completed my PhD",
    "start": "45600",
    "end": "52280"
  },
  {
    "text": "in the computer science and artificial intelligence lab which looks like a Dr Seuss building but actually has some interesting stuff going on inside and",
    "start": "52280",
    "end": "59559"
  },
  {
    "text": "now I own and operate my own company called invitin labs in Ottawa Canada uh beautiful place if you ever want to come",
    "start": "59559",
    "end": "66280"
  },
  {
    "text": "visit so looking into what a supply chain attack actually is really what it comes down to is when",
    "start": "66280",
    "end": "73159"
  },
  {
    "text": "an attacker uh injects malicious code into a trusted thirdparty source and the",
    "start": "73159",
    "end": "78720"
  },
  {
    "text": "victim uses that thirdparty Source without first verifying it so that malicious code gets into their code or",
    "start": "78720",
    "end": "85240"
  },
  {
    "text": "their system somehow and this allows the attacker to have access ACC to either the victim",
    "start": "85240",
    "end": "91119"
  },
  {
    "text": "systems or the victim's users in the case of something that gets redistributed out to end",
    "start": "91119",
    "end": "97520"
  },
  {
    "text": "users and this can occur in both open and closed Source projects of course and we're going to go over a couple examples",
    "start": "97520",
    "end": "103360"
  },
  {
    "text": "of these to to demonstrate the scale and impact that they've had in recent years",
    "start": "103360",
    "end": "108799"
  },
  {
    "text": "so one that you may have heard of is called the solar winds attack uh it was pretty large it was 18,000 customers",
    "start": "108799",
    "end": "115640"
  },
  {
    "text": "affected um estimated number which included a number of departments in the US government",
    "start": "115640",
    "end": "120719"
  },
  {
    "text": "and it was a very sophisticated attack that went on for several months before it was detected uh which was one of the",
    "start": "120719",
    "end": "126680"
  },
  {
    "text": "leading factors in how big of an impact it had it was attributed to um the",
    "start": "126680",
    "end": "131840"
  },
  {
    "text": "russian-backed a advanced persistent threat 29 group um and it really was one",
    "start": "131840",
    "end": "138200"
  },
  {
    "text": "of the first things that highlighted just how vulnerable our Global Supply chains are in terms of software to these",
    "start": "138200",
    "end": "143879"
  },
  {
    "text": "kinds of cyber threats so let's look at what actually happened in this attack to get an idea of how they work so",
    "start": "143879",
    "end": "149200"
  },
  {
    "text": "September 4th of 2019 uh the attackers were able to get access to the build",
    "start": "149200",
    "end": "154760"
  },
  {
    "text": "system uh which they called Orion and they think they may have done that through a compromised Office 365",
    "start": "154760",
    "end": "161640"
  },
  {
    "text": "account and over the next couple months they managed to inject a tiny strip of code uh into the the build just as a",
    "start": "161640",
    "end": "168599"
  },
  {
    "text": "proof of concept so that then as an end user when they received a copy of that build they could verify that their injected code was actually present and",
    "start": "168599",
    "end": "175400"
  },
  {
    "text": "this was just to prove that this would work in preparation for the primary attack",
    "start": "175400",
    "end": "180920"
  },
  {
    "text": "a couple months later they uh injected the malicious code which they is termed",
    "start": "180920",
    "end": "186319"
  },
  {
    "text": "Sunburst um and they injected it into the build through the Orion build system",
    "start": "186319",
    "end": "192519"
  },
  {
    "text": "and That Was Then distributed by solar winds to the end users and that was roughly 18,000",
    "start": "192519",
    "end": "198840"
  },
  {
    "text": "different uh organizations and government departments that received that malicious code and it wasn't until",
    "start": "198840",
    "end": "204840"
  },
  {
    "text": "almost a year later that fire eye which is now known as mandiant uh",
    "start": "204840",
    "end": "210760"
  },
  {
    "text": "announced that the software had or sorry that they had been hacked because they were using this software so that was",
    "start": "210760",
    "end": "216439"
  },
  {
    "text": "then traced back into the solar wind software as the source of that malicious code uh and that was when it was",
    "start": "216439",
    "end": "223080"
  },
  {
    "text": "revealed that this had been going on for almost a year at that point and the way they did it was quite Insidious they",
    "start": "223080",
    "end": "229400"
  },
  {
    "text": "managed to gain access to that build system as I mentioned and what they did is because it was a multistage build pipeline they'd let the first stage",
    "start": "229400",
    "end": "235799"
  },
  {
    "text": "build uh a bunch of dlls and compile them and then in a in a later stage it",
    "start": "235799",
    "end": "242079"
  },
  {
    "text": "would rename that dll to something temporary they would write a new dll",
    "start": "242079",
    "end": "247439"
  },
  {
    "text": "with the same name that had all of that same code plus some extra malicious",
    "start": "247439",
    "end": "252480"
  },
  {
    "text": "code they would wait for the build system to bundle all that together into the distribut uh distributed package and",
    "start": "252480",
    "end": "258880"
  },
  {
    "text": "then they would delete their malicious dll and rename the original one back to its original name so that anyone looking",
    "start": "258880",
    "end": "265040"
  },
  {
    "text": "at the output artifacts would see the original dll with no malicious code in it",
    "start": "265040",
    "end": "270199"
  },
  {
    "text": "and then that all got uh distributed into a package that was signed by solar winds so the malicious code was signed",
    "start": "270199",
    "end": "276680"
  },
  {
    "text": "by The Trusted distributor a company called crowd",
    "start": "276680",
    "end": "282160"
  },
  {
    "text": "strike which you may have heard of recently uh at the time was doing a lot of Consulting and investigation at Cyber",
    "start": "282160",
    "end": "288560"
  },
  {
    "text": "incidents and uh in the words of a a pretty well-known um security researcher",
    "start": "288560",
    "end": "294479"
  },
  {
    "text": "was the craziest thing he'd ever seen and the results were pretty significant so settlement of $26 million against",
    "start": "294479",
    "end": "301880"
  },
  {
    "text": "solar winds uh there were tens of millions of dollars on top of that in terms of cost to investigate and deal",
    "start": "301880",
    "end": "307280"
  },
  {
    "text": "with the problem the US Treasury State energy Homeland Security bunch of departments were all compromised so the",
    "start": "307280",
    "end": "313560"
  },
  {
    "text": "the value of that information that was leaked is immeasurable and then hundreds of private companies including some very",
    "start": "313560",
    "end": "319400"
  },
  {
    "text": "big names that you've heard of right Microsoft Intel Cisco all affected by this so even companies that in theory",
    "start": "319400",
    "end": "325520"
  },
  {
    "text": "have a lot of Engineers working on security manage to get breached by this and of course the Kremlin denies any",
    "start": "325520",
    "end": "332759"
  },
  {
    "text": "involvement in this which is a big shocker how about another one uh not Peta this was another possibly",
    "start": "332759",
    "end": "340400"
  },
  {
    "text": "supposedly Russian attack that was targeting Ukraine in 2017 uh which may be the most",
    "start": "340400",
    "end": "346039"
  },
  {
    "text": "destructive and costly attack in cyber uh in history so",
    "start": "346039",
    "end": "351160"
  },
  {
    "text": "far over10 billion in total damage is estimated around the globe and this one",
    "start": "351160",
    "end": "358120"
  },
  {
    "text": "was a bit more traditional in how it worked so they there was a piece of accounting software uh that was widely",
    "start": "358120",
    "end": "364360"
  },
  {
    "text": "used in Ukraine and the update server for the software was compromised so the",
    "start": "364360",
    "end": "370840"
  },
  {
    "text": "software regularly reaches out to unnown update server and checks if there's an update and pulls it and installs it if",
    "start": "370840",
    "end": "377599"
  },
  {
    "text": "so but the attackers managed to get access to this update server and inject",
    "start": "377599",
    "end": "383360"
  },
  {
    "text": "malware into that update instead of the actual update and then there were a couple known exploits at the time so the first",
    "start": "383360",
    "end": "390160"
  },
  {
    "text": "one was called Eternal blue and it allowed uh machines that were running that were not patched yet to um for for",
    "start": "390160",
    "end": "398639"
  },
  {
    "text": "scripts to be run on them remotely and then there was another exploit called mimicat uh which allowed extracting",
    "start": "398639",
    "end": "404560"
  },
  {
    "text": "passwords from memory on the machine and when you combine these two plus the malicious update uh essentially they",
    "start": "404560",
    "end": "410639"
  },
  {
    "text": "were able to remotely execute code on these machines that would get the passwords and then they would use those",
    "start": "410639",
    "end": "415800"
  },
  {
    "text": "passwords to access other machines that use the same password cuz they were like active directory accounts and that um",
    "start": "415800",
    "end": "423720"
  },
  {
    "text": "meant that any machine in the in the system that was unpatched they were able to get passwords from it and then use it",
    "start": "423720",
    "end": "429319"
  },
  {
    "text": "on all the patched machines so anywhere there was like an old machine that was out of date uh but someone could still",
    "start": "429319",
    "end": "434520"
  },
  {
    "text": "log into and the password was still there was vulnerable and that is how it exploded in terms of impact uh because",
    "start": "434520",
    "end": "441280"
  },
  {
    "text": "after they did that and they had access to that machine they would encrypt the master boot record and now you have all",
    "start": "441280",
    "end": "447280"
  },
  {
    "text": "of your data locked up and they weren't even asking for ransom on this it wasn't ransomware in the traditional sense uh",
    "start": "447280",
    "end": "453319"
  },
  {
    "text": "encrypting your MBR is a great way to do ransomware but the attackers here didn't care about money they just cared about",
    "start": "453319",
    "end": "460039"
  },
  {
    "text": "damage and the cost of this was estimated at like I said about 10 billion US um but possibly more",
    "start": "460039",
    "end": "467280"
  },
  {
    "text": "importantly it was used to cover up a bunch of other things that may have happened on those systems before they were encrypted uh so that none of that",
    "start": "467280",
    "end": "474639"
  },
  {
    "text": "activity could be traced now the the people who did this were quite aware of the impact that this",
    "start": "474639",
    "end": "481039"
  },
  {
    "text": "would have in the global scale of it uh but simply did not care which gives you a bit of an idea of the people um who",
    "start": "481039",
    "end": "487440"
  },
  {
    "text": "are doing these things another one this is my favorite um just the way the social engineering that went into it so",
    "start": "487440",
    "end": "493759"
  },
  {
    "text": "the first two were closed Source systems right uh no one can really inspect that source code before it gets distributed",
    "start": "493759",
    "end": "499360"
  },
  {
    "text": "out to the end user because it's not visible to the end user this one was a bit different because this was a big",
    "start": "499360",
    "end": "504840"
  },
  {
    "text": "open source project so this is a a compression library that is included in almost every Linux",
    "start": "504840",
    "end": "511279"
  },
  {
    "text": "distribution and it took about 3 years for this attack to take place because there was a um the the malicious version",
    "start": "511279",
    "end": "519080"
  },
  {
    "text": "was eventually uh almost distributed so it was it was built into development releases and then this was detected",
    "start": "519080",
    "end": "525480"
  },
  {
    "text": "before it actually went out into an official release uh but it became very close and if that had actually happened",
    "start": "525480",
    "end": "531240"
  },
  {
    "text": "the the impact would be immeasurable uh and the way it worked is it used the SSH demon to uh Grant system access to some",
    "start": "531240",
    "end": "538920"
  },
  {
    "text": "external user because uh there's this commonly used patch that links uh sshd",
    "start": "538920",
    "end": "546959"
  },
  {
    "text": "with systemd and then systemd includes lib um zma which is the XC utils Library",
    "start": "546959",
    "end": "553440"
  },
  {
    "text": "so it was kind of this multi-stage thing that made it hard to trace how these packages were connected uh but it was very close to",
    "start": "553440",
    "end": "560320"
  },
  {
    "text": "being released in both Debian and red hat uh and it was discovered only by chance when someone was uh using a",
    "start": "560320",
    "end": "568079"
  },
  {
    "text": "development release of of Linux and they like why is why are there performance issues and they started investigating",
    "start": "568079",
    "end": "573360"
  },
  {
    "text": "what was consuming these resources and found this malicious code in there and um sounded the alarm on it and then",
    "start": "573360",
    "end": "579839"
  },
  {
    "text": "prevented it from being released out into a production build so the way it occurred was more",
    "start": "579839",
    "end": "585640"
  },
  {
    "text": "through social engineering than anything else plus some very clever programming so there was a user",
    "start": "585640",
    "end": "591240"
  },
  {
    "text": "g75 um AUD inm for someone again assumed possibly con uh connected to app",
    "start": "591240",
    "end": "597680"
  },
  {
    "text": "29 they contributed meaningfully so they did like real code updates real poll requests comments reviews like very",
    "start": "597680",
    "end": "605680"
  },
  {
    "text": "useful work uh on this repository for about two years and this allowed them to",
    "start": "605680",
    "end": "612120"
  },
  {
    "text": "to get the trust of the maintainers of that repository because they seem to be doing real work and then over time there",
    "start": "612120",
    "end": "618200"
  },
  {
    "text": "were a bunch of new users who popped up on the email list who started pressuring the maintainers saying hey you're not",
    "start": "618200",
    "end": "623959"
  },
  {
    "text": "contributing enough time anymore like it's time for someone else to take the Reign what about this person who's been doing all this great work in the last",
    "start": "623959",
    "end": "630360"
  },
  {
    "text": "few years of course these users were likely just alternative accounts of that same person so the maintainers eventually",
    "start": "630360",
    "end": "637839"
  },
  {
    "text": "granted this person maintainer status uh which allowed them to change the build system and in the build system what they",
    "start": "637839",
    "end": "644800"
  },
  {
    "text": "did is they they because it's a compression Library there are these binary files with different",
    "start": "644800",
    "end": "650120"
  },
  {
    "text": "characteristics that are used to test the compression and make sure it's compressing and decompressing properly and what they did is while that's",
    "start": "650120",
    "end": "656440"
  },
  {
    "text": "usually just random binary data they created a binary test file that actually included malicious code in",
    "start": "656440",
    "end": "663480"
  },
  {
    "text": "it and when it was built and then released into the Linux systems uh it",
    "start": "663480",
    "end": "669360"
  },
  {
    "text": "would get the malicious code out of those testing binaries and build it into the library that is actually",
    "start": "669360",
    "end": "675800"
  },
  {
    "text": "executed this didn't have that much of an impact because it never really got released out into the world other than in development builds um but it made it",
    "start": "675800",
    "end": "683120"
  },
  {
    "text": "through quite a few people looking at this code and no one noticing any of these in an open source project",
    "start": "683120",
    "end": "690240"
  },
  {
    "text": "so this supply chain attack issue is an increasing threat it's not new but it is getting worse over time uh quite a about",
    "start": "690240",
    "end": "699320"
  },
  {
    "text": "203 dependencies on average for most projects According to some surveys uh",
    "start": "699320",
    "end": "704760"
  },
  {
    "text": "and about 45% of the respondents uh of the survey who had uh 45% of them had experienced a",
    "start": "704760",
    "end": "711839"
  },
  {
    "text": "supply chain attack in the year the survey was done and almost 60% of them had no way to respond to it they had no",
    "start": "711839",
    "end": "717560"
  },
  {
    "text": "plan for what to do when this happened so it impacts a lot of people and no one",
    "start": "717560",
    "end": "723440"
  },
  {
    "text": "knows what to do about it and that's kind of the problem but I want to give you an example to really illustrate how big of",
    "start": "723440",
    "end": "729440"
  },
  {
    "text": "an issue it is so I went on piie um at the python package manager repository",
    "start": "729440",
    "end": "736240"
  },
  {
    "text": "place to look at what is the large or most commonly downloaded package in the",
    "start": "736240",
    "end": "741880"
  },
  {
    "text": "system and it's Bodo 3 if you've worked with AWS you probably recognize that that's Amazon's um SDK for python",
    "start": "741880",
    "end": "749880"
  },
  {
    "text": "and it has 142 contributors 757 closed PRS and 1.3 billion downloads in the",
    "start": "749880",
    "end": "756160"
  },
  {
    "text": "past month alone and it has a bunch of dependencies each of those has 100 50 to",
    "start": "756160",
    "end": "763240"
  },
  {
    "text": "100 contributors each of those have dependencies and and just one of",
    "start": "763240",
    "end": "768720"
  },
  {
    "text": "those has all these dependencies and so you can see how this tree starts to grow very quickly and across this you have",
    "start": "768720",
    "end": "776720"
  },
  {
    "text": "about 2700 contributors almost 15 ,000 poll requests that have been closed and",
    "start": "776720",
    "end": "782680"
  },
  {
    "text": "merged in and then you have some really interesting information here this package I could not find who the author",
    "start": "782680",
    "end": "789560"
  },
  {
    "text": "of this was this package has one person who did it we have no idea who that is",
    "start": "789560",
    "end": "796160"
  },
  {
    "text": "um certainly not vetted code that's going in there and yet this is somehow making it into the most popular package",
    "start": "796160",
    "end": "803040"
  },
  {
    "text": "on all of pipie that is used for Amazon web services deployments around the",
    "start": "803040",
    "end": "808959"
  },
  {
    "text": "world world so when you think of the sensitive information that this has access to and that this one person can",
    "start": "808959",
    "end": "814600"
  },
  {
    "text": "inject some code into their um package for you get an idea of the scale and just how difficult it is to be able to",
    "start": "814600",
    "end": "820760"
  },
  {
    "text": "catch this we have the question of okay is it",
    "start": "820760",
    "end": "827720"
  },
  {
    "text": "better to use open source or Clos source to be able to deal with these things it's a mix there is no clear answer on",
    "start": "827720",
    "end": "833560"
  },
  {
    "text": "one hand in an open source project anyone can contribute to it and there's very rar any vetting of the people who",
    "start": "833560",
    "end": "840480"
  },
  {
    "text": "have control over the build systems and such whereas in a closed Source system in theory the company that's doing that",
    "start": "840480",
    "end": "847079"
  },
  {
    "text": "has better control over that but in a closed source project the users can't review the end user cannot review the",
    "start": "847079",
    "end": "853040"
  },
  {
    "text": "code if they want to in most cases and there are fewer people looking at it to catch if that kind of malicious ATT",
    "start": "853040",
    "end": "860040"
  },
  {
    "text": "attack happens in both cases you can have inexperienced developers who are doing things that are not secure um but",
    "start": "860040",
    "end": "866839"
  },
  {
    "text": "one of the larger issues with open source is that you don't really have much control over your dependencies",
    "start": "866839",
    "end": "872160"
  },
  {
    "text": "because all the projects you're using even if you're forking them and locking down the versions yourself internally",
    "start": "872160",
    "end": "878680"
  },
  {
    "text": "they're probably using other dependencies and you'd have to have this nested recursive forking of everything and in the end you'd end up with like",
    "start": "878680",
    "end": "884880"
  },
  {
    "text": "that B3 thing I showed you hundreds of packages that you were trying to maintain yourself so with that now I will show",
    "start": "884880",
    "end": "893199"
  },
  {
    "text": "you what actually happens here",
    "start": "893199",
    "end": "898040"
  },
  {
    "text": "now can I just get a show of hands in the room here who uses terraform on a regular basis if you're in this talk I",
    "start": "899720",
    "end": "905320"
  },
  {
    "text": "assume it's probably many of you",
    "start": "905320",
    "end": "908959"
  },
  {
    "text": "okay okay so I'm going to start by cloning uh sample",
    "start": "925839",
    "end": "932880"
  },
  {
    "text": "repository Oh I thought I changed",
    "start": "933319",
    "end": "937279"
  },
  {
    "text": "it yes okay so I just clone this repository it's just it's public um",
    "start": "939959",
    "end": "946279"
  },
  {
    "text": "demo and if we look at what's in",
    "start": "946279",
    "end": "950480"
  },
  {
    "text": "here sorry make the text larger possibly",
    "start": "951600",
    "end": "959319"
  },
  {
    "text": "better okay why is that happen something's going on here",
    "start": "979040",
    "end": "987680"
  },
  {
    "text": "there we go okay so in here I have two uh subdirectories one is the attacker one's",
    "start": "995079",
    "end": "1002040"
  },
  {
    "text": "the victim we are the victim today so let's look at what's going on in here a very simple configuration NDC often has",
    "start": "1002040",
    "end": "1009519"
  },
  {
    "text": "a Microsoft Focus so we're playing with azour today U all this is doing very simple configuration we're using the",
    "start": "1009519",
    "end": "1017600"
  },
  {
    "text": "Azure ad um provider official Microsoft",
    "start": "1017600",
    "end": "1023199"
  },
  {
    "text": "provider we are setting up a provider for it with a tenant that I've created for this demo and all we're doing is we're",
    "start": "1023199",
    "end": "1030199"
  },
  {
    "text": "reading the config and we are doing a check here that is comparing the tenant",
    "start": "1030199",
    "end": "1037600"
  },
  {
    "text": "ID in that the data source is getting with the one we expect and saying hey",
    "start": "1037600",
    "end": "1043918"
  },
  {
    "text": "yes we are applying this to the correct tenant and if not it throws this error message now this module here this is the",
    "start": "1043919",
    "end": "1051360"
  },
  {
    "text": "assertion module is one that I published uh myself a couple years",
    "start": "1051360",
    "end": "1058000"
  },
  {
    "text": "ago and if we look at it this has 51,000",
    "start": "1059600",
    "end": "1066200"
  },
  {
    "text": "downloads this week almost 5 million in all overall time and this is something that I as an individual published nobody",
    "start": "1066200",
    "end": "1072559"
  },
  {
    "text": "knew my name nobody knows who I am 5 million people have downloaded it or it's been downloaded 5 million times by",
    "start": "1072559",
    "end": "1079480"
  },
  {
    "text": "probably thousand I would I would estimate with this number that there's probably a thousand 500 to a thousand",
    "start": "1079480",
    "end": "1085679"
  },
  {
    "text": "decent sized companies using this module and what I've done is I have",
    "start": "1085679",
    "end": "1091120"
  },
  {
    "text": "forked it and republished it under a different user so there's it's not linked to my account called please don't",
    "start": "1091120",
    "end": "1096559"
  },
  {
    "text": "ban me and um oh sorry not that one this",
    "start": "1096559",
    "end": "1104400"
  },
  {
    "text": "one okay now what I'm going to do is show you this module it's very simple",
    "start": "1104400",
    "end": "1110000"
  },
  {
    "text": "all it does is asserts that a condition is true and if it's not true it kills terraform and fails with an error",
    "start": "1110000",
    "end": "1115200"
  },
  {
    "text": "message which is something that for some reason is still not built into terraform um so I built a module to do it it's",
    "start": "1115200",
    "end": "1121760"
  },
  {
    "text": "much simpler now than it was when I first released it because they've since added these validations with the ability",
    "start": "1121760",
    "end": "1127360"
  },
  {
    "text": "to reference other variables but essentially it's just making sure that the condition is true and if not it",
    "start": "1127360",
    "end": "1132640"
  },
  {
    "text": "throws that error message very simple module nothing crazy going on here nothing external Etc so what I'm going",
    "start": "1132640",
    "end": "1139600"
  },
  {
    "text": "to do is I'm going to publish this on the terraform",
    "start": "1139600",
    "end": "1147159"
  },
  {
    "text": "registry as version",
    "start": "1147159",
    "end": "1151840"
  },
  {
    "text": "0.1.4 and on the registry when we refresh we'll see okay that's our current latest version now as I'm doing",
    "start": "1156080",
    "end": "1162919"
  },
  {
    "text": "this um as the victim side of things if anyone says thinks hey that's crazy that would never actually happen in real life",
    "start": "1162919",
    "end": "1169559"
  },
  {
    "text": "please call me out on it so we can talk about it because my assertion here is",
    "start": "1169559",
    "end": "1175360"
  },
  {
    "text": "that this is very realistic so we're going to move into",
    "start": "1175360",
    "end": "1180559"
  },
  {
    "text": "this directory we're going to start with a",
    "start": "1180559",
    "end": "1186400"
  },
  {
    "text": "terraform in it",
    "start": "1186400",
    "end": "1190679"
  },
  {
    "text": "over the hotel Wi-Fi and a terraform",
    "start": "1200480",
    "end": "1205799"
  },
  {
    "text": "plan okay no problems here the assertion passes because I am connected to the right tenant and everyone's",
    "start": "1209320",
    "end": "1215600"
  },
  {
    "text": "happy so now what I'm going to do is as the attacker I'm going to go in",
    "start": "1215600",
    "end": "1223159"
  },
  {
    "text": "here I'm going to delete this version",
    "start": "1223159",
    "end": "1229640"
  },
  {
    "text": "remember the attacker has full control over the publication of this",
    "start": "1229640",
    "end": "1235360"
  },
  {
    "text": "module I'm going to delete the release delete the",
    "start": "1235360",
    "end": "1242080"
  },
  {
    "text": "tag and we're going to publish a new release with the same version",
    "start": "1244760",
    "end": "1249960"
  },
  {
    "text": "number but this time instead of targeting the main branch I'm going to Target the malicious",
    "start": "1250840",
    "end": "1256039"
  },
  {
    "text": "Branch publish that refresh",
    "start": "1256039",
    "end": "1262799"
  },
  {
    "text": "this note that this showed up that's interesting but anyway we're going to go back here now okay for this attack to",
    "start": "1262799",
    "end": "1269760"
  },
  {
    "text": "work two conditions have to be true one the terraform uh the terraform directory",
    "start": "1269760",
    "end": "1277400"
  },
  {
    "text": "or wherever it's being run has to be clean so that could be usually that's going to be because a engineer is",
    "start": "1277400",
    "end": "1283520"
  },
  {
    "text": "installing it or cloning it onto a new machine or a new engineer is doing it it",
    "start": "1283520",
    "end": "1288960"
  },
  {
    "text": "or um if you're using a pipeline that's going to be a clean directory every time you run it right if you're using",
    "start": "1288960",
    "end": "1294880"
  },
  {
    "text": "terraform Cloud that's going to be a clean directory every time so that condition I think is very realistic that",
    "start": "1294880",
    "end": "1300240"
  },
  {
    "text": "that would happen here in this case we're going to be simulating that just by deleting it reconing",
    "start": "1300240",
    "end": "1305600"
  },
  {
    "text": "it the other condition is that you either have to wait one week or you have",
    "start": "1305600",
    "end": "1311679"
  },
  {
    "text": "to do a terraform version bump anyone guess why that might",
    "start": "1311679",
    "end": "1317159"
  },
  {
    "text": "be no CL whatever individuals out there",
    "start": "1317159",
    "end": "1322360"
  },
  {
    "text": "no okay it's all right the reason for that is because the",
    "start": "1322360",
    "end": "1328799"
  },
  {
    "text": "terraform registry uses Amazon AWS cloudfront which has a onewe cach timer",
    "start": "1328799",
    "end": "1334480"
  },
  {
    "text": "on it if we look at I'm going to okay so I deleted that repository I'm going to",
    "start": "1334480",
    "end": "1340600"
  },
  {
    "text": "reclone it here great if we look at the",
    "start": "1340600",
    "end": "1347159"
  },
  {
    "text": "code here so this is the terraform source code and",
    "start": "1347159",
    "end": "1353200"
  },
  {
    "text": "this is where it gets uh finds modules so Module location function and this",
    "start": "1353200",
    "end": "1360559"
  },
  {
    "text": "is basically doing an HTTP request to try to download the module and the reason that we can get",
    "start": "1360559",
    "end": "1367000"
  },
  {
    "text": "around this onee cach timer uh with a version bump is because there's a header here for X terraform version so if we",
    "start": "1367000",
    "end": "1373799"
  },
  {
    "text": "change the value of that Header by upgrading from 1.10.4 to 1.0.5 in this",
    "start": "1373799",
    "end": "1379159"
  },
  {
    "text": "case then all of a sudden it has a new Hammer header and it bypasses the cach",
    "start": "1379159",
    "end": "1384279"
  },
  {
    "text": "alternatively we just wait for the cach to expire and we don't need to do the version",
    "start": "1384279",
    "end": "1389559"
  },
  {
    "text": "bump so we're going to upgrade from 14 to",
    "start": "1389559",
    "end": "1394799"
  },
  {
    "text": "15 sorry 104 to",
    "start": "1394799",
    "end": "1398519"
  },
  {
    "text": "105 go back to our",
    "start": "1400039",
    "end": "1403600"
  },
  {
    "text": "directory and we're going to do our terraform init again",
    "start": "1405120",
    "end": "1410440"
  },
  {
    "text": "no one stopped me so far so I assume no one has any red flags here so we've done our ter from anet",
    "start": "1421919",
    "end": "1428440"
  },
  {
    "text": "we'll do a plan we're not going to do an apply just a plan just to see if there's any",
    "start": "1428440",
    "end": "1435200"
  },
  {
    "text": "changes no changes everyone's happy and with that the attack is",
    "start": "1436640",
    "end": "1443159"
  },
  {
    "text": "complete if we go into our victims terraform configuration here we open up terraform we open up modules we open up",
    "start": "1443159",
    "end": "1450720"
  },
  {
    "text": "assertion and we look through here we see that all of a sudden we have all these extra files assertion assertion these are",
    "start": "1450720",
    "end": "1457840"
  },
  {
    "text": "shell scripts power shell scripts interesting",
    "start": "1457840",
    "end": "1462440"
  },
  {
    "text": "stuff because I'm running on a Windows machine it's running the Powershell script so let's look at this and this is",
    "start": "1464720",
    "end": "1470080"
  },
  {
    "text": "doing some interesting things so one first it's starting this whole process is like a separate process so it's",
    "start": "1470080",
    "end": "1475760"
  },
  {
    "text": "starting a new process and running this and then immediately returning to terraform and that way terraform thinks",
    "start": "1475760",
    "end": "1481480"
  },
  {
    "text": "it's done even though now there's a new process running in the background and what we're doing here is",
    "start": "1481480",
    "end": "1487480"
  },
  {
    "text": "we're getting",
    "start": "1487480",
    "end": "1491440"
  },
  {
    "text": "the we're getting all of our environment variables first because often terraform",
    "start": "1492919",
    "end": "1498080"
  },
  {
    "text": "is wrong with you know the client secret as an invar if especially if you're doing it in a",
    "start": "1498080",
    "end": "1504000"
  },
  {
    "text": "pipeline and we're putting all those in the payload and then we're getting all of our",
    "start": "1504000",
    "end": "1510200"
  },
  {
    "text": "files oh here sorry here're saying is the Azure command line interface",
    "start": "1510200",
    "end": "1515360"
  },
  {
    "text": "installed if so get the currently logged in or the token for the currently logged in user if the AWS CLI is installed do",
    "start": "1515360",
    "end": "1523640"
  },
  {
    "text": "the same thing get tokens for any profile that's currently logged in and sorry the one thing I missed",
    "start": "1523640",
    "end": "1530559"
  },
  {
    "text": "here this is too small for me is we're getting files there we go",
    "start": "1530559",
    "end": "1538399"
  },
  {
    "text": "we're getting all of our files from the SSH directory which is obviously going to",
    "start": "1538399",
    "end": "1544080"
  },
  {
    "text": "include some sensitive stuff private Keys perhaps we put all this in a payload and now there's a couple ways",
    "start": "1544080",
    "end": "1550039"
  },
  {
    "text": "that companies can try to stop and attack like this and one of the most common ones is you lock down your network access right you ensure that",
    "start": "1550039",
    "end": "1557039"
  },
  {
    "text": "even if an attacker can get into your system you prevent someone from remotely",
    "start": "1557039",
    "end": "1562120"
  },
  {
    "text": "accessing it to actively do things or you prevent data from being egressed out of your environment into the real world",
    "start": "1562120",
    "end": "1569559"
  },
  {
    "text": "usually through white listing of domains of of where things are allowed to connect to and so I thought to myself if",
    "start": "1569559",
    "end": "1574760"
  },
  {
    "text": "everything is if it's a whit listed system and we're trying to do an azour",
    "start": "1574760",
    "end": "1580840"
  },
  {
    "text": "in uh configuration here what would be whitelisted and what I realized is that",
    "start": "1580840",
    "end": "1587320"
  },
  {
    "text": "the uh um that azour uses the same domain for",
    "start": "1587320",
    "end": "1593200"
  },
  {
    "text": "everything to log into any tenant so when you try to log in I try to log in we use the same domain which means that",
    "start": "1593200",
    "end": "1599240"
  },
  {
    "text": "domain is almost guaranteed to be Whit listed because without it the acli doesn't work terraform doesn't work nothing works with the azer provider so",
    "start": "1599240",
    "end": "1605640"
  },
  {
    "text": "that is pretty much guaranteed to be Whit listed so what I did is I created my own Azor",
    "start": "1605640",
    "end": "1610760"
  },
  {
    "text": "tenant and I make and a client for it in entra and a user in entra and then I",
    "start": "1610760",
    "end": "1616159"
  },
  {
    "text": "make login requests against that and what you can do it turns out is you",
    "start": "1616159",
    "end": "1622080"
  },
  {
    "text": "can change you can't really modify any of those and have it still work but you can",
    "start": "1622080",
    "end": "1627520"
  },
  {
    "text": "change sorry for flipping around here so much the user agent header and you can",
    "start": "1627520",
    "end": "1632559"
  },
  {
    "text": "put your nice little payload in there and okay maybe another way to stop",
    "start": "1632559",
    "end": "1637840"
  },
  {
    "text": "this issue is deep packet inspection well and look for anything that might be sensitive well I can encrypt my payload",
    "start": "1637840",
    "end": "1645039"
  },
  {
    "text": "using a public private key pair and now even if you can see that you know what",
    "start": "1645039",
    "end": "1650360"
  },
  {
    "text": "is that user agent field you have no idea what I'm trying to egress you know you just know that I'm trying to egress",
    "start": "1650360",
    "end": "1656200"
  },
  {
    "text": "something anyway I do a bunch of these I split it into packets the right size do a couple attempts for each because aour",
    "start": "1656200",
    "end": "1662600"
  },
  {
    "text": "is unreliable with it logging and then exit silently out of this script this is public if you want to take a look at",
    "start": "1662600",
    "end": "1668399"
  },
  {
    "text": "this and how it works so now if we go into Zur this is the attacker's tenant and we can see we",
    "start": "1668399",
    "end": "1675880"
  },
  {
    "text": "have monitoring down here and we have the sign in logs",
    "start": "1675880",
    "end": "1681200"
  },
  {
    "text": "feature and that time stamp seems to match up does it no",
    "start": "1681600",
    "end": "1689600"
  },
  {
    "text": "doesn't this is where things get annoying because this is a very unreliable feature of azures",
    "start": "1691200",
    "end": "1698919"
  },
  {
    "text": "anyone here from azra you you can't actually do that you",
    "start": "1714039",
    "end": "1720120"
  },
  {
    "text": "have to start over and you have to put the end time in",
    "start": "1720120",
    "end": "1724360"
  },
  {
    "text": "first yeah no someone's not a very good UI",
    "start": "1727480",
    "end": "1732398"
  },
  {
    "text": "engineer you also can't just leave this one blank and say until current date you",
    "start": "1735960",
    "end": "1741000"
  },
  {
    "text": "have to put a time in there okay",
    "start": "1741000",
    "end": "1747679"
  },
  {
    "text": "go nothing",
    "start": "1747679",
    "end": "1751518"
  },
  {
    "text": "refresh refresh I don't know why it's doing that",
    "start": "1753640",
    "end": "1761159"
  },
  {
    "text": "refresh I'm always nervous when I do this demo because I'm relying on eure to log things properly there it is okay so",
    "start": "1766000",
    "end": "1772240"
  },
  {
    "text": "I have three failed attempts here and now I'm going to download these",
    "start": "1772240",
    "end": "1779559"
  },
  {
    "text": "download and here things get interesting again because one kilobyte file that's not",
    "start": "1780320",
    "end": "1787480"
  },
  {
    "text": "right okay let's",
    "start": "1787480",
    "end": "1790518"
  },
  {
    "text": "refresh because even though the logs propagate and show up here when you download they still haven't propagated",
    "start": "1795480",
    "end": "1800880"
  },
  {
    "text": "yet there nope",
    "start": "1800880",
    "end": "1807200"
  },
  {
    "text": "okay oh our logs disappeared not very good for audit",
    "start": "1809720",
    "end": "1817480"
  },
  {
    "text": "logs I prefer to do this demo with AWS by the way",
    "start": "1819640",
    "end": "1825559"
  },
  {
    "text": "uh 41 kilobytes okay good there we go so now we're going to go into",
    "start": "1831320",
    "end": "1838640"
  },
  {
    "text": "our attacker repository here",
    "start": "1838640",
    "end": "1845559"
  },
  {
    "text": "and on our little python",
    "start": "1846039",
    "end": "1850039"
  },
  {
    "text": "script so if we look at what I'm doing now so this is from the attacker perspective essentially I am getting",
    "start": "1853120",
    "end": "1859159"
  },
  {
    "text": "that log file that I just downloaded and I am reassembling the packets and then I",
    "start": "1859159",
    "end": "1864840"
  },
  {
    "text": "am decrypting it and then I'm de decoding it and basically getting all the raw data that I had and I'm stashing",
    "start": "1864840",
    "end": "1871559"
  },
  {
    "text": "it all in this retrieved directory here and now we can see all the environment",
    "start": "1871559",
    "end": "1877360"
  },
  {
    "text": "variables that were set for that user and we've reproduced all the files that were in",
    "start": "1877360",
    "end": "1883720"
  },
  {
    "text": "SSH just kidding it's not a real private key but uh that file was in the victims.",
    "start": "1883720",
    "end": "1890880"
  },
  {
    "text": "SSH directory and had the proper permission set on it so now my attacker has all this information and what I find",
    "start": "1890880",
    "end": "1897519"
  },
  {
    "text": "even more fun is what I've done at the end here remember how I said I Ed that",
    "start": "1897519",
    "end": "1902600"
  },
  {
    "text": "Azure command line uh to get the currently logged in token well what I've",
    "start": "1902600",
    "end": "1908120"
  },
  {
    "text": "done is I've gotten that token out of the payload and then I've made an API request using that token to validate it",
    "start": "1908120",
    "end": "1913960"
  },
  {
    "text": "and it has succeeded and what we see here is the output of that command so using that token I",
    "start": "1913960",
    "end": "1921840"
  },
  {
    "text": "was able to get this response that shows the tenant ID the domains that are associated with it a bunch of other",
    "start": "1921840",
    "end": "1927039"
  },
  {
    "text": "stuff now that token could theoretically do anything right now that I have it I",
    "start": "1927039",
    "end": "1933159"
  },
  {
    "text": "can do anything I want because usually when someone's running terraform they're using an admin level credential because",
    "start": "1933159",
    "end": "1939159"
  },
  {
    "text": "you need an admin level credential to do a lot of things with terraform like deploying your core networks and infrastructure and this token will have",
    "start": "1939159",
    "end": "1945360"
  },
  {
    "text": "all those permissions so this concludes the demo and shows just how easy it is to conduct",
    "start": "1945360",
    "end": "1951080"
  },
  {
    "text": "a supply chain attack so now I ask you I showed you that I have that module published with 51,000 downloads per week",
    "start": "1951080",
    "end": "1958519"
  },
  {
    "text": "if I actually did this not on my demo repository but on the real one how many",
    "start": "1958519",
    "end": "1964039"
  },
  {
    "text": "of your companies might have their credentials exposed because even if you're not using that module directly you might be using",
    "start": "1964039",
    "end": "1970360"
  },
  {
    "text": "one of my 50 other modules that use that module internally or someone else's module that uses that module internally",
    "start": "1970360",
    "end": "1977440"
  },
  {
    "text": "so I enage you to take a look into this and figure out if it's actually an issue for",
    "start": "1977440",
    "end": "1983200"
  },
  {
    "text": "you now something else that's interesting here that I was actually",
    "start": "1983200",
    "end": "1988679"
  },
  {
    "text": "fairly impressed with because someone yesterday said well what about using a security tool like",
    "start": "1988679",
    "end": "1994519"
  },
  {
    "text": "check off to see uh if there are any vulnerabilities before you do your apply so let's actually do",
    "start": "1994519",
    "end": "2003158"
  },
  {
    "text": "that going back to our file our victims configuration",
    "start": "2006760",
    "end": "2012919"
  },
  {
    "text": "here it's only four files I don't know why it takes so long",
    "start": "2029039",
    "end": "2034760"
  },
  {
    "text": "so while that's thinking I'm going to show you so the problem here is that the rep the terraform registry allows the",
    "start": "2045279",
    "end": "2052200"
  },
  {
    "text": "underlying commit hash associated with a version tag to change and that has been",
    "start": "2052200",
    "end": "2058320"
  },
  {
    "text": "raised quite a few times it was first raised um",
    "start": "2058320",
    "end": "2065158"
  },
  {
    "text": "here well this particular issue was raised 2021 one that references it and first talks about this problem was from",
    "start": "2065159",
    "end": "2072398"
  },
  {
    "text": "2018 um I've raised it on the forums I've raised it all over the place and um",
    "start": "2072399",
    "end": "2078280"
  },
  {
    "text": "they just don't want to deal with it I don't know why but if you read through these conversations it's quite funny",
    "start": "2078280",
    "end": "2083358"
  },
  {
    "text": "because it's like the head in the sand completely ignore that this is a",
    "start": "2083359",
    "end": "2087960"
  },
  {
    "text": "problem there we go so this failed with check off because it",
    "start": "2090679",
    "end": "2097118"
  },
  {
    "text": "says ins terraform modules use a commit hash and if you open this link which is",
    "start": "2097119",
    "end": "2102440"
  },
  {
    "text": "here this is a known problem uh interestingly this was came up shortly after I first presented this demo so",
    "start": "2102440",
    "end": "2109119"
  },
  {
    "text": "maybe someone was in the room and then made this a policy check uh but it does detect that there's a security",
    "start": "2109119",
    "end": "2114680"
  },
  {
    "text": "vulnerability here but then I thought well how is that actually happening and",
    "start": "2114680",
    "end": "2120560"
  },
  {
    "text": "how can I get around it and what I realized is that if you have",
    "start": "2120560",
    "end": "2126560"
  },
  {
    "text": "a module such as this one here so this is a module I wrote just this morning to",
    "start": "2126560",
    "end": "2132800"
  },
  {
    "text": "basically do what we were trying to do in that configuration it validates is the tenant that we are currently deploying to a tenant we expect simple",
    "start": "2132800",
    "end": "2140400"
  },
  {
    "text": "unrealistic you'd actually use it but basically it's doing what we just did except it's wrapped it in a module so it",
    "start": "2140400",
    "end": "2145880"
  },
  {
    "text": "gets your current tenant it Compares it with an input tenant ID and does",
    "start": "2145880",
    "end": "2150960"
  },
  {
    "text": "this and to please check off I am going to use this module using",
    "start": "2150960",
    "end": "2158160"
  },
  {
    "text": "uh a hash so you don't have to use the terraform register you can use uh GitHub directly and you can specify the commit",
    "start": "2158160",
    "end": "2165079"
  },
  {
    "text": "hash that you want to use here comment that one out",
    "start": "2165079",
    "end": "2172480"
  },
  {
    "text": "initialize and we'll run check off again",
    "start": "2178319",
    "end": "2184839"
  },
  {
    "text": "and this time it passes right it's happy because now I have pinned it to a commit specific hash but as I just showed you",
    "start": "2188160",
    "end": "2194520"
  },
  {
    "text": "if you go to this and you look at the code that is associated with that hash well it's using a module that's",
    "start": "2194520",
    "end": "2201480"
  },
  {
    "text": "just using the terraform registry and the same attack would occur here because",
    "start": "2201480",
    "end": "2206800"
  },
  {
    "text": "this underlying code would change even though the commit hash of the parent module hasn't",
    "start": "2206800",
    "end": "2212400"
  },
  {
    "text": "changed so check off isn't going to save you in this case unless they modify it to rec curs L go through all modules and",
    "start": "2212400",
    "end": "2218960"
  },
  {
    "text": "make sure that everything has a pinned uh commit but realistically then you're not going to be able to use most of the",
    "start": "2218960",
    "end": "2225040"
  },
  {
    "text": "open source",
    "start": "2225040",
    "end": "2227520"
  },
  {
    "text": "modules so there were a couple key objectives here one that U the user was never",
    "start": "2233480",
    "end": "2240920"
  },
  {
    "text": "alerted to this attack they had no idea that this happened uh it did not require admin access admin consent or pseudo",
    "start": "2240920",
    "end": "2248480"
  },
  {
    "text": "the user didn't need to provide any kind of consent at all right they just did normal actions like terraform a knit and terraform plan and I took all of their",
    "start": "2248480",
    "end": "2255720"
  },
  {
    "text": "credentials we talked about how check off isn't going to save you and this so",
    "start": "2255720",
    "end": "2260920"
  },
  {
    "text": "I was rather concerned about this because I work with a lot of companies that I build terraform configurations for so I was like there should probably",
    "start": "2260920",
    "end": "2267200"
  },
  {
    "text": "be a cve for this so I wrote to Hashi Corp and I said here are all the steps for reproduce here's the risk here's the",
    "start": "2267200",
    "end": "2272359"
  },
  {
    "text": "issue D and they responded saying thanks we'll look back into it we'll look into it and get back to you that was six",
    "start": "2272359",
    "end": "2278400"
  },
  {
    "text": "months seven eight month seven months ago they have not gotten back to me and they refused to issue a",
    "start": "2278400",
    "end": "2285280"
  },
  {
    "text": "cve and if you look at the cve process if you've done it before if the program",
    "start": "2285760",
    "end": "2291280"
  },
  {
    "text": "partner which is hashicorp in this case refuses to issue one there will never be one there is no way to get around that",
    "start": "2291280",
    "end": "2297880"
  },
  {
    "text": "at least as far as I'm aware because that step two right there report it to the partner and the partner assigns the",
    "start": "2297880",
    "end": "2303160"
  },
  {
    "text": "cve identifier they said no so there is no cve",
    "start": "2303160",
    "end": "2309000"
  },
  {
    "text": "it's a problem really you just need to write to hashicorp and say this is insane please fix this but let's talk more about supply",
    "start": "2309880",
    "end": "2316760"
  },
  {
    "text": "chain attacks in general again because it's a problem well beyond just terraform so when we talk about reducing",
    "start": "2316760",
    "end": "2323880"
  },
  {
    "text": "the risk of something risk is the factor of probability and",
    "start": "2323880",
    "end": "2329680"
  },
  {
    "text": "impact and so we can reduce the risk by reducing the probability or reducing the impact we can reduce the probability by",
    "start": "2329680",
    "end": "2337079"
  },
  {
    "text": "a number number of ways uh the first one is if you have important dependencies you can Fork them keep your own copy of",
    "start": "2337079",
    "end": "2343480"
  },
  {
    "text": "them so they'll never change and use those obviously that gets extremely difficult when you have these nested",
    "start": "2343480",
    "end": "2349520"
  },
  {
    "text": "dependencies and you'd have to Fork each one and then change the references and it's a whole thing you can avoid",
    "start": "2349520",
    "end": "2355160"
  },
  {
    "text": "dependencies altogether if you don't need them in many cases there's a lot of old code that has old dependencies in",
    "start": "2355160",
    "end": "2360359"
  },
  {
    "text": "there that is no longer used and strong dependency locking is",
    "start": "2360359",
    "end": "2365720"
  },
  {
    "text": "key uh some languages have this built in for everything which is great terraform",
    "start": "2365720",
    "end": "2371040"
  },
  {
    "text": "has it for providers but does not have a locking file for modules and that is actually published on their website we will lock providers but not modules no",
    "start": "2371040",
    "end": "2378119"
  },
  {
    "text": "explanation why and then you can prefer trusted vendors but as we showed Clos Source",
    "start": "2378119",
    "end": "2384880"
  },
  {
    "text": "Products are just as vulnerable to supply chain attacks so that's not really going to save you that one's",
    "start": "2384880",
    "end": "2390359"
  },
  {
    "text": "questionable on the side of reducing the impact well we try to minimize the blast",
    "start": "2390359",
    "end": "2395560"
  },
  {
    "text": "radius and try to minimize the impact that they can have so we always want to use the principle of least privilege",
    "start": "2395560",
    "end": "2401960"
  },
  {
    "text": "right giving uh as the minimal permissions needed to a given credential uh to do what it needs to do in this",
    "start": "2401960",
    "end": "2408599"
  },
  {
    "text": "case if I'm able to steal your as your token you'll want it to be as locked down as possible",
    "start": "2408599",
    "end": "2414480"
  },
  {
    "text": "right so when your software is installed you want to run it as a dedicated user with strictly limited permissions not as",
    "start": "2414480",
    "end": "2420240"
  },
  {
    "text": "root okay and yeah uh for cloud tools we",
    "start": "2420240",
    "end": "2426440"
  },
  {
    "text": "want to go with ro based authentication as much as we can so that it is limited to a specific role with very specific",
    "start": "2426440",
    "end": "2433040"
  },
  {
    "text": "tasks and very strict policies for being able to assume those",
    "start": "2433040",
    "end": "2438160"
  },
  {
    "text": "roles wherever possible keep it all readon and not write access now this",
    "start": "2438160",
    "end": "2443920"
  },
  {
    "text": "used to be quite difficult with these Cloud providers particularly with AWS with their thousands of different permissions but this has gotten a lot",
    "start": "2443920",
    "end": "2450760"
  },
  {
    "text": "easier now with modern tools that will allow you to see hey your user or role",
    "start": "2450760",
    "end": "2456359"
  },
  {
    "text": "has only used these permissions in the last few months check these ones and see are they actually necessary and AWS will",
    "start": "2456359",
    "end": "2462599"
  },
  {
    "text": "do that now I'm not as familiar with aour but those tools are present and easier to use Network segmentation is fairly",
    "start": "2462599",
    "end": "2469440"
  },
  {
    "text": "important um when you think about that uh XZ utils Library attack that g",
    "start": "2469440",
    "end": "2477240"
  },
  {
    "text": "allowed someone remote access into your system if you can keep that Network",
    "start": "2477240",
    "end": "2482440"
  },
  {
    "text": "segmented as tightly as possible so even if they can get into that machine they can't Branch out from there and then expand the blast radius that's pretty",
    "start": "2482440",
    "end": "2489440"
  },
  {
    "text": "important so using multiple different subnets particularly when it comes to Cloud providers or different vpcs using",
    "start": "2489440",
    "end": "2494839"
  },
  {
    "text": "your security groups properly Access Control lists making sure everything's on the right ports um and restricting",
    "start": "2494839",
    "end": "2501200"
  },
  {
    "text": "your outbound public access to make it harder to egress data as I showed you're never really going to be able to truly",
    "start": "2501200",
    "end": "2506720"
  },
  {
    "text": "lock that down um because there are ways to egress data through endpoints that I don't control like azure's login",
    "start": "2506720",
    "end": "2512720"
  },
  {
    "text": "endpoint uh but it certainly helps and then we come with come to the",
    "start": "2512720",
    "end": "2518000"
  },
  {
    "text": "monitoring side of things lots of tools a bunch of companies out there and all around that are advertising the",
    "start": "2518000",
    "end": "2524240"
  },
  {
    "text": "capabilities to do this uh monitoring your network traffic particularly your logins um why is Joe logging in at",
    "start": "2524240",
    "end": "2532880"
  },
  {
    "text": "midnight when we know he's sleeping right like and you can flag some things and and catch them pretty easily that",
    "start": "2532880",
    "end": "2538480"
  },
  {
    "text": "way auto updates huge risk here as we talked about when the update server can get compromised like that not pet you",
    "start": "2538480",
    "end": "2545480"
  },
  {
    "text": "attack so things automatically installing software without anyone's consent are pretty",
    "start": "2545480",
    "end": "2551079"
  },
  {
    "text": "risky when you do see weird Behavior actually digging into it the only way",
    "start": "2551079",
    "end": "2556359"
  },
  {
    "text": "that X utils um Li hack sorry attack was caught was because one very keen user",
    "start": "2556359",
    "end": "2562440"
  },
  {
    "text": "was like that doesn't seem right and started digging deeply into it and that is when they found hey yeah there's some",
    "start": "2562440",
    "end": "2570000"
  },
  {
    "text": "weird code here that's using a lot of resources that it shouldn't be so we can do that with performance uh",
    "start": "2570000",
    "end": "2576920"
  },
  {
    "text": "if you're looking at your uh Network logs and you're seeing DNS requests for",
    "start": "2576920",
    "end": "2583240"
  },
  {
    "text": "things that aren't recognized or new or abnormal lots of uh machine learning tools able to monitor that now H or",
    "start": "2583240",
    "end": "2590480"
  },
  {
    "text": "different software that's been installed that you don't recognize multiactor authentication has been harped on for",
    "start": "2590480",
    "end": "2595920"
  },
  {
    "text": "like the last 10 years still just as important still so few people are using it uh because if malware can get on your",
    "start": "2595920",
    "end": "2603160"
  },
  {
    "text": "system they can steal your passwords they can steal that out of memory but they can't steal your Hardware Keys",
    "start": "2603160",
    "end": "2608599"
  },
  {
    "text": "unless they are actually physically present to take your Hardware keys so hardware for multiactor authentication",
    "start": "2608599",
    "end": "2615119"
  },
  {
    "text": "very useful for uh very high security systems when we're talking about terraform specifically the terraform",
    "start": "2615119",
    "end": "2622599"
  },
  {
    "text": "registry we're still going to want to use all those third party Community modules um you can Fork the ones that",
    "start": "2622599",
    "end": "2628400"
  },
  {
    "text": "are very important like you can do with any dependency or you can pin it to a hash and this is kind of what I showed",
    "start": "2628400",
    "end": "2634599"
  },
  {
    "text": "you there to get around to make checkov happy right so when we have the source uh I",
    "start": "2634599",
    "end": "2641400"
  },
  {
    "text": "think GitHub bitbucket Mercurial a bunch of them any get based system those will",
    "start": "2641400",
    "end": "2647000"
  },
  {
    "text": "all support this ref with a hash and when you do that it's impossible because it's impossible to change the hash of a",
    "start": "2647000",
    "end": "2652640"
  },
  {
    "text": "commit without changing or to change the code without changing the hash the problem here is that whatever",
    "start": "2652640",
    "end": "2659839"
  },
  {
    "text": "you're locking to or pinning to might internally use modules that do not use",
    "start": "2659839",
    "end": "2666640"
  },
  {
    "text": "this system right like I demonstrated with that wrapper module alternatively you can use",
    "start": "2666640",
    "end": "2672480"
  },
  {
    "text": "something I built specifically for this it is a module that does a module lock file so this is open source feel free to",
    "start": "2672480",
    "end": "2678920"
  },
  {
    "text": "take a look at it but essentially this the first time a terraform plan is done",
    "start": "2678920",
    "end": "2684200"
  },
  {
    "text": "it looks for any new modules it um puts their H it calculates a hash of all the",
    "start": "2684200",
    "end": "2689359"
  },
  {
    "text": "files puts that into a lock file and then the next time it's run it checks is this already in the lock file has it",
    "start": "2689359",
    "end": "2694960"
  },
  {
    "text": "changed uh then throw Pro and alert and it's it's fairly robust from my testing",
    "start": "2694960",
    "end": "2700440"
  },
  {
    "text": "but I'd love to see some more eyes on it if you're",
    "start": "2700440",
    "end": "2704160"
  },
  {
    "text": "interested",
    "start": "2708240",
    "end": "2711240"
  },
  {
    "text": "and yeah that's everything cool all right thank you very much for your time",
    "start": "2713400",
    "end": "2718720"
  },
  {
    "text": "um happy to take questions on this and talk about what we can do to deal with it",
    "start": "2718720",
    "end": "2725470"
  },
  {
    "text": "[Applause]",
    "start": "2725470",
    "end": "2730710"
  },
  {
    "text": "uh okay question was why did I um replace an existing version instead of changing the version so if I change the",
    "start": "2745680",
    "end": "2753280"
  },
  {
    "text": "version if we look at how this was before I messed with it",
    "start": "2753280",
    "end": "2758680"
  },
  {
    "text": "if I change if I do a new Point 1.5 version then so a lot of uh modules",
    "start": "2758680",
    "end": "2765440"
  },
  {
    "text": "would do something like this right and in hash Corps language this means that",
    "start": "2765440",
    "end": "2770520"
  },
  {
    "text": "um it's pinning the first two and then the least significant version is allowed to change right so this would allow",
    "start": "2770520",
    "end": "2776520"
  },
  {
    "text": "0.1.5 1.6 Etc if it's written this way and I CH and I release it as a new",
    "start": "2776520",
    "end": "2782240"
  },
  {
    "text": "version then yes the next time they do an terraform up in it upgrade or or a fresh",
    "start": "2782240",
    "end": "2787640"
  },
  {
    "text": "in it then the malicious code will come in but if they have it like this then if",
    "start": "2787640",
    "end": "2794319"
  },
  {
    "text": "I release it as a new version then they're not going to get it until they bump the version in the config and one",
    "start": "2794319",
    "end": "2799480"
  },
  {
    "text": "of my objectives with the demo was to say the user doesn't have to do anything to be attacked so that is why I released",
    "start": "2799480",
    "end": "2806280"
  },
  {
    "text": "it as a new version instead of or sorry as an existing version instead of a new one",
    "start": "2806280",
    "end": "2812119"
  },
  {
    "text": "yeah any other questions okay thank you",
    "start": "2812119",
    "end": "2818839"
  },
  {
    "text": "[Applause]",
    "start": "2818850",
    "end": "2821830"
  }
]