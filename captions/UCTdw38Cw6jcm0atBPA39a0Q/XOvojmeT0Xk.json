[
  {
    "start": "0",
    "end": "200000"
  },
  {
    "text": "hi everyone hear me all right yeah sounds like it so thank you very much for coming to my",
    "start": "9120",
    "end": "15970"
  },
  {
    "text": "talk thank you for spending the next hour with me my name's Adam and I come",
    "start": "15970",
    "end": "23710"
  },
  {
    "text": "from the UK originally I lived in Switzerland for last 20 years and I work",
    "start": "23710",
    "end": "28780"
  },
  {
    "text": "for a company called particular software where the makers have a product called end service Buster's anyone here heard of an service bus",
    "start": "28780",
    "end": "34809"
  },
  {
    "text": "oh that's most of you that's that's good to hear now it's great to be back in Oslo I always love coming back here to",
    "start": "34809",
    "end": "40510"
  },
  {
    "text": "this lovely expensive city I've been saving up for this trip all year and",
    "start": "40510",
    "end": "45909"
  },
  {
    "text": "when I get home I'll start saving for next year I'm gonna talk about this is",
    "start": "45909",
    "end": "50920"
  },
  {
    "text": "not a talk about in service bus but I am going to be showing some examples and then service bus I'm going to be talking about an approach and the methodology to",
    "start": "50920",
    "end": "57729"
  },
  {
    "text": "a certain class of problems and service bus happens to make it really easy to implement some of those methodologies so",
    "start": "57729",
    "end": "64059"
  },
  {
    "text": "I'll be using it for examples now I'm gonna be talking about a class of problems which not many people talk",
    "start": "64059",
    "end": "70900"
  },
  {
    "text": "about explicitly and actually don't often explicitly think about when they're writing their code to do with a",
    "start": "70900",
    "end": "78009"
  },
  {
    "text": "runtime behavior of that code now you might think that's a strange thing to say because you you do think about the",
    "start": "78009",
    "end": "83380"
  },
  {
    "text": "runtime behavior with your code when you're writing it I hope you do but",
    "start": "83380",
    "end": "89020"
  },
  {
    "text": "there's a certain class of problems which really only manifest themselves when you're in production and",
    "start": "89020",
    "end": "94859"
  },
  {
    "text": "specifically when we think about the arrow of time when we think about the dimension of time in our code",
    "start": "94859",
    "end": "100409"
  },
  {
    "text": "historically we haven't had a really good set of tools and approaches to this and especially when we get into things",
    "start": "100409",
    "end": "107439"
  },
  {
    "text": "about around concurrency in time as well now a little bit of background I'm gonna",
    "start": "107439",
    "end": "112509"
  },
  {
    "text": "talk about multi-user systems so you can imagine that in this picture there's people are using system and they're",
    "start": "112509",
    "end": "118840"
  },
  {
    "text": "touching the same piece of data at the same time this is actually the UBS trading floor in Stanford in Connecticut",
    "start": "118840",
    "end": "126429"
  },
  {
    "text": "in the US I actually worked on this trading floor for a couple of weeks it's not a very good place to write software",
    "start": "126429",
    "end": "132160"
  },
  {
    "text": "it's very very noisy but it was a lot of fun but let's look at a more so familiar",
    "start": "132160",
    "end": "137350"
  },
  {
    "text": "domain and think about online retail so this is Amazon I don't think you actually have Amazon in doorway right there's no",
    "start": "137350",
    "end": "144590"
  },
  {
    "text": "Amazon no I don't think that it is we don't have it in Switzerland either but I still use a German site sometimes in",
    "start": "144590",
    "end": "150200"
  },
  {
    "text": "the UK site because they ship to Switzerland anyway now there's a lot of",
    "start": "150200",
    "end": "155810"
  },
  {
    "text": "competition in this space if you're trying to become an online retailer you know first of all you're competing with the giant with Amazon and you're",
    "start": "155810",
    "end": "161959"
  },
  {
    "text": "competing with a whole lot of others and you can imagine that the business come up with kind of requirements which try",
    "start": "161959",
    "end": "168170"
  },
  {
    "text": "and differentiate you a bit so think about something really simple like when",
    "start": "168170",
    "end": "173420"
  },
  {
    "text": "a customer orders something I want you to look back through the history of their orders and if they've spent $100",
    "start": "173420",
    "end": "180560"
  },
  {
    "text": "or more this week I want you to give him a discount of 10% so you think okay right I'm gonna do this we can do this",
    "start": "180560",
    "end": "187040"
  },
  {
    "text": "I'm gonna use DDD I'm gonna use TDD I'm gonna use all the various things I've learnt about I'm gonna do this property",
    "start": "187040",
    "end": "192380"
  },
  {
    "text": "I'm gonna tick all the boxes I'm gonna use all the methods that I know about just like I try to use all the different",
    "start": "192380",
    "end": "197570"
  },
  {
    "text": "animations and PowerPoint for this slide and eventually you might come up with some code which looks a little bit like",
    "start": "197570",
    "end": "203930"
  },
  {
    "start": "200000",
    "end": "708000"
  },
  {
    "text": "this and you can see that this is basically doing exactly what the cust what the business user asked for we're",
    "start": "203930",
    "end": "210860"
  },
  {
    "text": "looking back when this order is submitted we're looking back through the history we're matching the customer ID",
    "start": "210860",
    "end": "216280"
  },
  {
    "text": "we're looking at all the orders which were delivered in there which was sent in the last week and if it's greater",
    "start": "216280",
    "end": "222680"
  },
  {
    "text": "than a hundred we give a discount of ten if it's less we give a discount of zero so what's wrong with this code why is",
    "start": "222680",
    "end": "230480"
  },
  {
    "text": "this Co so bad you're all aunt abruption and things are fine and you've TDD des in dddd and you've ticked all the DS and",
    "start": "230480",
    "end": "236030"
  },
  {
    "text": "all the rest of it the thing is that first of all you might get some problems with database load right so we're doing",
    "start": "236030",
    "end": "242420"
  },
  {
    "text": "a lookup across a history of orders here and we're gonna sum things up and even if you get all that sorted so you might",
    "start": "242420",
    "end": "248900"
  },
  {
    "text": "have a good DB II's and you put indexes on their tables and you optimize and do some other work you get it all working fast enough there's another fundamental",
    "start": "248900",
    "end": "256430"
  },
  {
    "text": "problem here what does it mean to be a customer we've got this thing up here",
    "start": "256430",
    "end": "262610"
  },
  {
    "text": "called customer ID does that mean a physical person right so is a customer ID a physical person and a machine",
    "start": "262610",
    "end": "269830"
  },
  {
    "text": "sending orders into your website or is it something more than that could it be something more than that",
    "start": "269830",
    "end": "275360"
  },
  {
    "text": "think about a call account so some companies do that they say well if you're going to order stuff on this website please use a corporate",
    "start": "275360",
    "end": "281780"
  },
  {
    "text": "account could have negotiated this deal where we get discounts so a single",
    "start": "281780",
    "end": "286940"
  },
  {
    "text": "customer ID could be two physical people at two computers and they could be clicking this button more or less at the",
    "start": "286940",
    "end": "293150"
  },
  {
    "text": "same time so what you've got then effectively is two threads right you've",
    "start": "293150",
    "end": "298220"
  },
  {
    "text": "got two threads of execution processing orders let's assume for a moment that our order total is ninety right so it's",
    "start": "298220",
    "end": "305270"
  },
  {
    "text": "below our hump our threshold of 100 and each of these towards this two orders is for ten now one of these ought to get",
    "start": "305270",
    "end": "312380"
  },
  {
    "text": "discounted right the first one that gets processed should that get not discounted",
    "start": "312380",
    "end": "317540"
  },
  {
    "text": "that should take the total to a hundred the second one should get discounted the problem is they're executing in parallel",
    "start": "317540",
    "end": "323870"
  },
  {
    "text": "and they both look at a database and they both see a sum of 90 so what they're going to do they're both going",
    "start": "323870",
    "end": "329840"
  },
  {
    "text": "to send out the order with zero discount because they're both saying it's not above a hundred now that's problematic",
    "start": "329840",
    "end": "336740"
  },
  {
    "text": "because the person that comes around to paying the bill at the end of the month is going to have a look and say hang on a minute",
    "start": "336740",
    "end": "341830"
  },
  {
    "text": "we sent in eleven orders that week and they all got charged a full price you told us you can do it gives a discount",
    "start": "341830",
    "end": "348890"
  },
  {
    "text": "right one of those should be didn't should have been discounted at 10 percent you know you you you're not you",
    "start": "348890",
    "end": "353990"
  },
  {
    "text": "know that's actually breach a contract so you say oh well you know we're terribly sorry we'll give you a discount or a free refund or something and then",
    "start": "353990",
    "end": "361640"
  },
  {
    "text": "you think well we must have a bug in the system that must must must be something wrong so then you look at it and you realize that well they pretty much press",
    "start": "361640",
    "end": "368150"
  },
  {
    "text": "the button at the same time or within a couple of seconds of each other so you get back to the customer say that I'm terribly sorry but you order too quickly",
    "start": "368150",
    "end": "375820"
  },
  {
    "text": "in order to quickly well if you just waited a few seconds before the second order we were they giving you a discount",
    "start": "376600",
    "end": "382370"
  },
  {
    "text": "kind of look at you funny and say what you know how do you expect me to do that we have 10 people using this website now",
    "start": "382370",
    "end": "388880"
  },
  {
    "text": "how do I coordinate that and then you say why don't those shout around the office or something and then at that point they're Sarah I thank for you to",
    "start": "388880",
    "end": "394460"
  },
  {
    "text": "business you know I'm going to Amazon instead every owner at the the term death by Amazon all right that's what",
    "start": "394460",
    "end": "400550"
  },
  {
    "text": "Amazon does if you don't run your business efficiently enough Amazon will eat you so that's not good enough",
    "start": "400550",
    "end": "406700"
  },
  {
    "text": "now you think well we've got the problem we've got to solve this problem on outside somehow sunny you think well",
    "start": "406700",
    "end": "413000"
  },
  {
    "text": "what about transactions why don't we just wrap each of these things in the transaction that'll sort out right the",
    "start": "413000",
    "end": "420620"
  },
  {
    "text": "problem is that most of the most major database platforms are sequel server oracle etc use an isolation level for",
    "start": "420620",
    "end": "427370"
  },
  {
    "text": "transactions by default which is called at least in sequel server reads committed so what that means is the",
    "start": "427370",
    "end": "434270"
  },
  {
    "text": "transaction isolation level will allow both of these threads to read this 90 write if I try and write to the same row",
    "start": "434270",
    "end": "441260"
  },
  {
    "text": "or something afterwards it will sense it will actually not allow one of the transactions to commit but it allowed",
    "start": "441260",
    "end": "447650"
  },
  {
    "text": "them to read this figure of 90 so that's not really going to fix it out the Box either but then you read about",
    "start": "447650",
    "end": "453520"
  },
  {
    "text": "serializable transactions and sequel server and what that means is that each",
    "start": "453520",
    "end": "458570"
  },
  {
    "text": "transaction takes out read locks on all the stuff it's read and when they try and write back then they'll actually not",
    "start": "458570",
    "end": "464480"
  },
  {
    "text": "allow the transaction to commit if the other thing hasn't released its read lock and that'll solve the problem the",
    "start": "464480",
    "end": "470420"
  },
  {
    "text": "problem is you switch that on and all of a sudden your error logs just fill up right so you quickly panic and go oh no",
    "start": "470420",
    "end": "476480"
  },
  {
    "text": "your switch thing off again but the thing is what you've got to realize is that those errors are feedback those",
    "start": "476480",
    "end": "482540"
  },
  {
    "text": "error logs are telling you you've got concurrency problems in your system they're telling you that people are",
    "start": "482540",
    "end": "487820"
  },
  {
    "text": "clicking the button at the same time it's only kind of scratching your head you're kind of running out of ideas but",
    "start": "487820",
    "end": "493430"
  },
  {
    "text": "then you think well I've solved this before I've sold this another way before we had concurrency problems in another",
    "start": "493430",
    "end": "498470"
  },
  {
    "text": "system and to do that I wrote a batch job now you might end up with code which",
    "start": "498470",
    "end": "507470"
  },
  {
    "text": "does something like this in some kind of batch job instead say instead of doing this on the fly when people are",
    "start": "507470",
    "end": "513469"
  },
  {
    "text": "submitting orders we're going to loop through all the customers one by one and look back through the history and we're going to set their discount level to ten",
    "start": "513470",
    "end": "520190"
  },
  {
    "text": "or zero according to how much how much stuff they've ordered now there is a",
    "start": "520190",
    "end": "526880"
  },
  {
    "text": "kind of behavior problem with that as well but before I go into that think about the technical side of this as well now this is in c-sharp okay or whatever",
    "start": "526880",
    "end": "536240"
  },
  {
    "text": "your favorite programming language is whatever you've written your best of your system in now that's a good",
    "start": "536240",
    "end": "541580"
  },
  {
    "text": "situation if you're lucky you get to writing in c-sharp and if you're really lucky if you're really",
    "start": "541580",
    "end": "547399"
  },
  {
    "text": "disciplined you might even put it inside this nice encapsulation you've got here a nice ddd and micro service and SOA",
    "start": "547399",
    "end": "554620"
  },
  {
    "text": "developed solution which nicely encapsulated encapsulation of database but what often happens is this stuff",
    "start": "554620",
    "end": "561649"
  },
  {
    "text": "tends to live outside it comes to kind of get bolted on the side and go directly goes directly to the database",
    "start": "561649",
    "end": "567970"
  },
  {
    "text": "now if you are lucky enough to be writing this in c-sharp or your favorite language whatever you do don't let your",
    "start": "567970",
    "end": "574699"
  },
  {
    "text": "DBAs see it because when your DBA sees it will say that should be written in",
    "start": "574699",
    "end": "579740"
  },
  {
    "text": "sequel and they'll and it's a bit to be fair they might be right and they're",
    "start": "579740",
    "end": "585110"
  },
  {
    "text": "good at this right DBAs are good at this right they know how to make super server perform well then how to tune and",
    "start": "585110",
    "end": "590779"
  },
  {
    "text": "optimize it and I just put indexes and tables and indeed it turns out is running faster so they give you this",
    "start": "590779",
    "end": "597470"
  },
  {
    "text": "stored procedure and very often what I've seen before is they write the initial version of the stored procedure",
    "start": "597470",
    "end": "603230"
  },
  {
    "text": "and then kind of give it to you for maintenance and because this thing is working well and efficiently soon all",
    "start": "603230",
    "end": "609290"
  },
  {
    "text": "right the business come along and they say well you know that batch jobs things that we did a few a couple of weeks ago",
    "start": "609290",
    "end": "615199"
  },
  {
    "text": "to do that this counting thing yeah we need another one of those too this other thing and then another one appears and",
    "start": "615199",
    "end": "621949"
  },
  {
    "text": "then another one appears and another one appears now what starts and this is just random sequel by the way that I just",
    "start": "621949",
    "end": "627889"
  },
  {
    "text": "copied and pasted it from somewhere I don't even know what it is but the point it kind of all looks the same anyway",
    "start": "627889",
    "end": "633800"
  },
  {
    "text": "right but the the the problem here is that the interesting stuff is actually",
    "start": "633800",
    "end": "639560"
  },
  {
    "text": "all going on on the outside here right this stuff in the middle is kind of shrinking in importance",
    "start": "639560",
    "end": "644949"
  },
  {
    "text": "all right all the new funky business requirements all the all the",
    "start": "644949",
    "end": "650300"
  },
  {
    "text": "differentiators all those things that are giving you competitive advantage are starting to be coded on the outside here this is becoming the system right it's",
    "start": "650300",
    "end": "658939"
  },
  {
    "text": "kind of is anyone here familiar with a Strangler pattern anyone heard that so Strangler pattern as a few of you the",
    "start": "658939",
    "end": "664759"
  },
  {
    "text": "Strang of the pattern very briefly is when you have a nasty piece of cut piece of code you'd gradually carve out bits",
    "start": "664759",
    "end": "670639"
  },
  {
    "text": "of that code with and replace it with nice pieces of code until you strangle the bad code out of existence there's",
    "start": "670639",
    "end": "676670"
  },
  {
    "text": "almost some kind of like reverse strangle a pattern right the nice code is being strangled out of existence and this stuff kind of starts",
    "start": "676670",
    "end": "683600"
  },
  {
    "text": "to take over your life and I've been in a situation before I've laid a bed I've laid in bed awake at night thinking",
    "start": "683600",
    "end": "690620"
  },
  {
    "text": "about how to debug stored procs all of a sudden you realize you become a sort of stored proc specialist or something and",
    "start": "690620",
    "end": "697880"
  },
  {
    "text": "it's not a nice situation to be in because ultimately you've got this kind of big ball of mud written install",
    "start": "697880",
    "end": "703520"
  },
  {
    "text": "procedures and it I've been in the situation and it's really quite unpleasant but even taking all that",
    "start": "703520",
    "end": "711110"
  },
  {
    "start": "708000",
    "end": "768000"
  },
  {
    "text": "aside even if you manage to avoid that situation even man if you manage to keep it in c-sharp you manage to keep it in",
    "start": "711110",
    "end": "717080"
  },
  {
    "text": "your domain modern you keep it nice there's another fundamental problem here previously we were basically penalizing",
    "start": "717080",
    "end": "724610"
  },
  {
    "text": "users for clicking the button at the same time or within a few seconds of each other we are now penalizing them",
    "start": "724610",
    "end": "731240"
  },
  {
    "text": "for clicking on the same day because what you're effectively saying is if",
    "start": "731240",
    "end": "736730"
  },
  {
    "text": "you're gonna order a load of stuff don't or what am more than $100 worth on Monday order $100 worth of Monday wait",
    "start": "736730",
    "end": "743960"
  },
  {
    "text": "till Tuesday so the overnight batch can run and then send in the rest of the orders and customs gonna say right",
    "start": "743960",
    "end": "750050"
  },
  {
    "text": "bye-bye I'm off to Amazon it's just not gonna work that might have been good enough in the early days of e-commerce I",
    "start": "750050",
    "end": "755240"
  },
  {
    "text": "don't know but these days people expect more so we can't just take this to two or three second race condition and",
    "start": "755240",
    "end": "761180"
  },
  {
    "text": "expand it to a 24 hour race condition right this is one of the reasons that businesses are trying to get away from things like batch jobs so we need",
    "start": "761180",
    "end": "770600"
  },
  {
    "start": "768000",
    "end": "1008000"
  },
  {
    "text": "another way to think about this arrow of time with another we need another approach another model to think about",
    "start": "770600",
    "end": "776180"
  },
  {
    "text": "how we're gonna program the arrow of time so here it is here's our arrow of time and if business is going smoothly",
    "start": "776180",
    "end": "783290"
  },
  {
    "text": "we're gonna be get orders flowing through the website now the requirement we've been given again is when an order",
    "start": "783290",
    "end": "790400"
  },
  {
    "text": "comes in I want you to look back through the history of the orders sum them up",
    "start": "790400",
    "end": "796850"
  },
  {
    "text": "and if the week total is more than 100 give a discount right now that is not",
    "start": "796850",
    "end": "803780"
  },
  {
    "text": "the requirement one of the things I've come to realize over the past few years users and business people don't",
    "start": "803780",
    "end": "811130"
  },
  {
    "text": "often give you requirements what they tend to do is give you workarounds",
    "start": "811130",
    "end": "816260"
  },
  {
    "text": "within the constraints of the current system they know that we're recording",
    "start": "816260",
    "end": "822440"
  },
  {
    "text": "orders they know we've got this order history of customer IDs and totals and things and they know that if we go back",
    "start": "822440",
    "end": "828800"
  },
  {
    "text": "through that history and sum all those orders up we can work out whether it's a discount or not so they've given you",
    "start": "828800",
    "end": "835160"
  },
  {
    "text": "that workaround the actual requirement is when a customer has has a spent over",
    "start": "835160",
    "end": "840800"
  },
  {
    "text": "$100 in a week give him a discount now that might seem like just a subtle",
    "start": "840800",
    "end": "845930"
  },
  {
    "text": "change in wording but the problem is because we've getting away from that go back through history and look up we're",
    "start": "845930",
    "end": "852770"
  },
  {
    "text": "already not tied that as a solution I can start to think about other ways of doing things we don't necessarily have",
    "start": "852770",
    "end": "859130"
  },
  {
    "text": "to look back in time we can actually kind of look forward in time now I'm not saying we can predict the future but",
    "start": "859130",
    "end": "865160"
  },
  {
    "text": "there are methods where it can kind of fold the history and the future into our current code so let's have another look",
    "start": "865160",
    "end": "872270"
  },
  {
    "text": "at the arrow of time now when the first",
    "start": "872270",
    "end": "879080"
  },
  {
    "text": "order comes in what's the current what's the customer's current week total it's",
    "start": "879080",
    "end": "885470"
  },
  {
    "text": "zero exactly right so what are we going to give when the first order comes in when they give no discount right that's",
    "start": "885470",
    "end": "890930"
  },
  {
    "text": "simple now we've introduced this concept of a week total huh or a weekly total so",
    "start": "890930",
    "end": "897020"
  },
  {
    "text": "we can say well the weekly total right now is zero but importantly we add the",
    "start": "897020",
    "end": "902210"
  },
  {
    "text": "current order into the weekly total okay because this is now going to count our",
    "start": "902210",
    "end": "907460"
  },
  {
    "text": "weekly total but even more importantly in one week from now we need to remove",
    "start": "907460",
    "end": "913580"
  },
  {
    "text": "that order total prior week total when the second order comes in with you the",
    "start": "913580",
    "end": "918680"
  },
  {
    "text": "same thing again we add the order total to the week total and importantly in one week from that moment we need to remove",
    "start": "918680",
    "end": "925700"
  },
  {
    "text": "that order from the week total and you can see as we do this for every order that comes in we're gonna have this kind",
    "start": "925700",
    "end": "932120"
  },
  {
    "text": "of sliding window of the week total and what orders are going to be added to it",
    "start": "932120",
    "end": "938420"
  },
  {
    "text": "at one point they're going to be taken away exactly a week later so you can see that's gonna kind of slide through time and give us that weekly total and",
    "start": "938420",
    "end": "944850"
  },
  {
    "text": "one point in time and we do it for every other the order that comes into the website and when a specific order comes",
    "start": "944850",
    "end": "951690"
  },
  {
    "text": "in what do we do that we look back through the history or we don't have to do that anymore right we just look at",
    "start": "951690",
    "end": "958139"
  },
  {
    "text": "the week total so what we're doing here is we're basically updating a single",
    "start": "958139",
    "end": "964019"
  },
  {
    "text": "number so it's consistent in the same way that the batch job was consistent where we're updating a single discount",
    "start": "964019",
    "end": "969750"
  },
  {
    "text": "level for a customer we're now updating a single row in the database to hold this week total and databases are really",
    "start": "969750",
    "end": "976920"
  },
  {
    "text": "good a guarantee and transactionality around the single row in a database I'll come to that a bit more in a minute but",
    "start": "976920",
    "end": "984180"
  },
  {
    "text": "what we've done here is instead of fudging the number by performing calculations over the existing domain",
    "start": "984180",
    "end": "989220"
  },
  {
    "text": "objects we've introduced this concept into our domain itself I've got this week total which has become part of our",
    "start": "989220",
    "end": "995160"
  },
  {
    "text": "ubiquitous language and it's a kind of it's a kind of inverted kind of inverse",
    "start": "995160",
    "end": "1000920"
  },
  {
    "text": "anti batch job if you like but the thing is we need a good way to program this so how we're gonna program this element of",
    "start": "1000920",
    "end": "1007790"
  },
  {
    "text": "time how are we gonna program this taking away the order in a week's time how we're gonna make sure that happens",
    "start": "1007790",
    "end": "1013029"
  },
  {
    "start": "1008000",
    "end": "1168000"
  },
  {
    "text": "you can't really do it with HTTP well I don't know any way of sending an HTTP request and having it arrive at the",
    "start": "1013029",
    "end": "1019279"
  },
  {
    "text": "consumer you know a week later doesn't really cut it for that you can kind of",
    "start": "1019279",
    "end": "1024319"
  },
  {
    "text": "fudge it with system threading timer or something like that but the problem is that's fine until the process crashes",
    "start": "1024319",
    "end": "1030199"
  },
  {
    "text": "okay the process starts up again it's forgotten because that's all in memory so we need another approach now what I'm",
    "start": "1030199",
    "end": "1036079"
  },
  {
    "text": "going to do do now is introduce a notion of a saga has anyone heard of the saga pattern that's all that's probably at",
    "start": "1036079",
    "end": "1041839"
  },
  {
    "text": "least half of you okay so very briefly saga it was a term coined in the late 80s I think it was 1987 it was",
    "start": "1041839",
    "end": "1049730"
  },
  {
    "text": "effectively about rolling back transactions and breaking transactions into smaller transactions so take a big",
    "start": "1049730",
    "end": "1056330"
  },
  {
    "text": "transaction it was you have you have a series of smaller transactions if one succeeds with another succeeds unless",
    "start": "1056330",
    "end": "1061970"
  },
  {
    "text": "exceeds another fails you kind of roll back the previous steps and that's kind of what the original saga pattern",
    "start": "1061970",
    "end": "1068000"
  },
  {
    "text": "described we've abstracted that a little more generally because the thing is that",
    "start": "1068000",
    "end": "1075010"
  },
  {
    "text": "saga that the real world doesn't really roll itself back doesn't really undo itself in our saga",
    "start": "1075010",
    "end": "1082490"
  },
  {
    "text": "abstraction effectively all it abstracts is a message coming in another message",
    "start": "1082490",
    "end": "1087680"
  },
  {
    "text": "coming in later and then what you do when that second message arrives depends on what happened in the first message",
    "start": "1087680",
    "end": "1093860"
  },
  {
    "text": "right in order to do that when the first message arrives we've saw state when the",
    "start": "1093860",
    "end": "1099110"
  },
  {
    "text": "second message is arrived Mesut message arrives we retrieve that state and we make decisions based on the second",
    "start": "1099110",
    "end": "1104660"
  },
  {
    "text": "message and the state from the first message that's basically what a saga is and this this kind of undoing I often",
    "start": "1104660",
    "end": "1111980"
  },
  {
    "text": "see this example so when people talk about sagas they talk about booking a holiday so you need to book a flight new",
    "start": "1111980",
    "end": "1118010"
  },
  {
    "text": "typical hotel room and you took book a hire car I tried to use sort of typical",
    "start": "1118010",
    "end": "1123470"
  },
  {
    "text": "images from a Norwegian family holiday here I've got this right and when you",
    "start": "1123470",
    "end": "1128660"
  },
  {
    "text": "book your flight that succeeds we meant to be Otel then you try and pick your hire car and they're all sold out so",
    "start": "1128660",
    "end": "1135020"
  },
  {
    "text": "what do you do right holidays off we're not going we're going to roll the whole thing back when the councilor town cancel the flight it's a really bad",
    "start": "1135020",
    "end": "1141680"
  },
  {
    "text": "example so if you see people using this example when they talk about sagas you know call them out on X it's a really",
    "start": "1141680",
    "end": "1147530"
  },
  {
    "text": "bad example the real word this real world is rich than that so when we when",
    "start": "1147530",
    "end": "1152840"
  },
  {
    "text": "we fail to rent the hire car we go to another company if they're all sold out",
    "start": "1152840",
    "end": "1157970"
  },
  {
    "text": "we look at other forms of transport stretch limo or something so we need a",
    "start": "1157970",
    "end": "1164420"
  },
  {
    "text": "more general pattern which is not just tied to this kind of rolling back which is a bit unrealistic so that's a lot of talking let me show you a little bit of",
    "start": "1164420",
    "end": "1170750"
  },
  {
    "start": "1168000",
    "end": "1418000"
  },
  {
    "text": "code now I'm just going to show you generally what a saga looks like I'm not",
    "start": "1170750",
    "end": "1175820"
  },
  {
    "text": "going to do anything exciting here I just want to kind of show you the API just before we go back to our use case",
    "start": "1175820",
    "end": "1181900"
  },
  {
    "text": "so what we've got here is we've got a flight booked class which we're going to",
    "start": "1181900",
    "end": "1187460"
  },
  {
    "text": "which we're going to use as a message and that just has a holiday ID on it we've got a hotel booked message with a",
    "start": "1187460",
    "end": "1194810"
  },
  {
    "text": "holiday ID and a card books message with a holiday ID now our requirement is for",
    "start": "1194810",
    "end": "1200930"
  },
  {
    "text": "this saga when the flights been booked when the hotel's been built when the car's been booked",
    "start": "1200930",
    "end": "1206240"
  },
  {
    "text": "I want to spa Bechet holiday booked message",
    "start": "1206240",
    "end": "1211299"
  },
  {
    "text": "and then something else in the system can go and do something else now these only contain IDs because I'm assuming",
    "start": "1211299",
    "end": "1217419"
  },
  {
    "text": "that other parts of the system know about the details right so all we actually need for this use case is just",
    "start": "1217419",
    "end": "1223299"
  },
  {
    "text": "the idea of the holiday okay so we published this holiday book message and then something else in the system can",
    "start": "1223299",
    "end": "1229029"
  },
  {
    "text": "then say okay I'm going to email the customer turn their holidays being built or I'm gonna build them for the holiday",
    "start": "1229029",
    "end": "1234460"
  },
  {
    "text": "or do whatever so a saga is as simple as a class right that's all the saga is",
    "start": "1234460",
    "end": "1240940"
  },
  {
    "text": "it's just a class so I've called it holiday booking and the first thing we",
    "start": "1240940",
    "end": "1245950"
  },
  {
    "text": "need to do is we needed to find some kind of class to hold the state in between these different message that in",
    "start": "1245950",
    "end": "1251679"
  },
  {
    "text": "between receiving these different messages so I'm gonna use a nested class for that and I know some people hate",
    "start": "1251679",
    "end": "1258309"
  },
  {
    "text": "nested classes but I think they're quite nice in this specific use case because",
    "start": "1258309",
    "end": "1263590"
  },
  {
    "text": "they demonstrate that this data is for this saga and nothing else now I'm I'm",
    "start": "1263590",
    "end": "1268929"
  },
  {
    "text": "inheriting from a base class called contains saga data that just has some infrastructure stuff on it like a kind",
    "start": "1268929",
    "end": "1274840"
  },
  {
    "text": "of internal ID for the saga who sent the original message what was the original message we don't care about that in this",
    "start": "1274840",
    "end": "1281440"
  },
  {
    "text": "use case that's useful for other things but just to show you what that class is",
    "start": "1281440",
    "end": "1286710"
  },
  {
    "text": "so in our class we're defining the whole holiday ID because ultimately that's the thing we have to raise the event for at",
    "start": "1286830",
    "end": "1292929"
  },
  {
    "text": "the end we're recording the fact that the flight is booked that the hotel is booked and that the car is booked now",
    "start": "1292929",
    "end": "1299369"
  },
  {
    "text": "what we can do is we can Herot from a saga based class and we tell it that the",
    "start": "1299369",
    "end": "1306840"
  },
  {
    "text": "state is going to be stored in this nested data class that we just defined",
    "start": "1306840",
    "end": "1313529"
  },
  {
    "text": "now we need to handle the three messages so we need to handle flight booked hotel",
    "start": "1313950",
    "end": "1318999"
  },
  {
    "text": "booked hopes her hotel booked and car booked and what that does it gives us a",
    "start": "1318999",
    "end": "1324009"
  },
  {
    "text": "bunch of methods to implement called handle and in each of those we get the",
    "start": "1324009",
    "end": "1329169"
  },
  {
    "text": "message itself and we get a context object which is just a thing that we can use to send other messages within the",
    "start": "1329169",
    "end": "1335350"
  },
  {
    "text": "method so when we receive flight book we say is flight booked true hotel books",
    "start": "1335350",
    "end": "1342279"
  },
  {
    "text": "hotel books is true kharbut car box is true and in each case we call this checkbook",
    "start": "1342279",
    "end": "1347350"
  },
  {
    "text": "to method and that's down here and all that's doing is it's saying when the",
    "start": "1347350",
    "end": "1353770"
  },
  {
    "text": "flights booked when the hotel's booked and the cars booked we publish using this context object that's been passed",
    "start": "1353770",
    "end": "1359560"
  },
  {
    "text": "in a holiday booked event with the holiday ID okay now at that point we're",
    "start": "1359560",
    "end": "1366370"
  },
  {
    "text": "done right the saga has served its purpose because that's all its purposes it's when the three things have been",
    "start": "1366370",
    "end": "1371440"
  },
  {
    "text": "booked raised an event to say that's been done so the rest of the system can do something so what we can do now is we",
    "start": "1371440",
    "end": "1378430"
  },
  {
    "text": "can mark as complete and that's the method on the base class which just says this sagas done right it doesn't need to",
    "start": "1378430",
    "end": "1384130"
  },
  {
    "text": "exist anymore there's just one thing left to do and that is to configure how",
    "start": "1384130",
    "end": "1389410"
  },
  {
    "text": "to find the saga in the database so all this does it says for each of these message types so flight hotel and car",
    "start": "1389410",
    "end": "1396130"
  },
  {
    "text": "take the holiday ID from the message and map it to the holiday ideas a saga that",
    "start": "1396130",
    "end": "1401410"
  },
  {
    "text": "effectively tells the infrastructure how to form a select statement in the database so when a message comes in try",
    "start": "1401410",
    "end": "1407830"
  },
  {
    "text": "and select an existing saga if it doesn't exist create one now I know I've gone through that pretty quickly but",
    "start": "1407830",
    "end": "1414580"
  },
  {
    "text": "I'll show you sort of diagrammatic explanation of what's actually happening there so we have kind of two important",
    "start": "1414580",
    "end": "1422020"
  },
  {
    "start": "1418000",
    "end": "1533000"
  },
  {
    "text": "abstractions here we have the bus and the persister the bus is kind of an abstraction over a message queue so that",
    "start": "1422020",
    "end": "1427240"
  },
  {
    "text": "might be as a service bus or rabbitmq or MSM queue or any other queueing system the persister is effect is essentially",
    "start": "1427240",
    "end": "1434980"
  },
  {
    "text": "an abstraction over a database and that could be sequel server or a call or rave and DB or MongoDB as any matter now when",
    "start": "1434980",
    "end": "1442540"
  },
  {
    "text": "we receive the first message the bus tries to retrieve the saga from the database and because it's the first",
    "start": "1442540",
    "end": "1448300"
  },
  {
    "text": "message with that Holliday ID it doesn't find it - that but that gets that goes",
    "start": "1448300",
    "end": "1454870"
  },
  {
    "text": "all the way back to the bus the bus knows that it has to create a new saga object it dispatches the method into it",
    "start": "1454870",
    "end": "1460990"
  },
  {
    "text": "the message into it which is basically calling the handle method that handle method will alter the internal state it",
    "start": "1460990",
    "end": "1467530"
  },
  {
    "text": "may or may not send messages out and at that point we persist the saga excuse me",
    "start": "1467530",
    "end": "1472720"
  },
  {
    "text": "in the database which is basically an insert statement if you're using sequel server or something like that",
    "start": "1472720",
    "end": "1478490"
  },
  {
    "text": "when the second message comes in we do the same thing again we try and retrieve the stock from the database this time it",
    "start": "1478490",
    "end": "1484170"
  },
  {
    "text": "does find it because we saved it after the first message it then creates a new sagar object fills it with the data from",
    "start": "1484170",
    "end": "1490080"
  },
  {
    "text": "last time and gives it back to the bus then we do the same thing again with dispatch the new message into it that in",
    "start": "1490080",
    "end": "1496740"
  },
  {
    "text": "alters the internal state somehow might send more messages out and we persist the saga again which is basic than an",
    "start": "1496740",
    "end": "1503310"
  },
  {
    "text": "update statement or we might decide we're done right in this case we mark",
    "start": "1503310",
    "end": "1508860"
  },
  {
    "text": "ourselves as complete and the persister basically deletes it from the database the saga is basically done so I hope",
    "start": "1508860",
    "end": "1515760"
  },
  {
    "text": "most of that makes sense so now that we know kind of more or less how a saga works if we go back to our use case how",
    "start": "1515760",
    "end": "1523140"
  },
  {
    "text": "can we use the saga for our business use case how can we actually achieve this and importantly how can we do this magic",
    "start": "1523140",
    "end": "1530760"
  },
  {
    "text": "do something in a week from now so again I think the best thing is for me to show you the code so what I've got here is a",
    "start": "1530760",
    "end": "1540270"
  },
  {
    "start": "1533000",
    "end": "1733000"
  },
  {
    "text": "couple of other messages so we have a submit order message with a customer ID and a order total so just how much the",
    "start": "1540270",
    "end": "1548790"
  },
  {
    "text": "orders for and it will have some other stuff which I'll just left out for brevity then we have a process order",
    "start": "1548790",
    "end": "1555750"
  },
  {
    "text": "message with a discount level okay and whatever other properties it needs to for something else to process the order",
    "start": "1555750",
    "end": "1562640"
  },
  {
    "text": "so the requirement here is when we receive a submit order message work out",
    "start": "1562640",
    "end": "1569310"
  },
  {
    "text": "the discount and send the message to process the order with at this gun right that's that's the requirement for this saga that's it's single responsibility",
    "start": "1569310",
    "end": "1576380"
  },
  {
    "text": "so again we've got a discounting class I've called a discounting this time this is gonna be our saga for the saga data",
    "start": "1576380",
    "end": "1584670"
  },
  {
    "text": "I'm going to store the customer ID",
    "start": "1584670",
    "end": "1589950"
  },
  {
    "text": "because we do discounting for cut at the customer level for each customer and I'm",
    "start": "1589950",
    "end": "1595200"
  },
  {
    "text": "storing the week total okay I'm using a double here you probably won't do that in real life might use kind of money type or something that's appropriate",
    "start": "1595200",
    "end": "1601560"
  },
  {
    "text": "accuracy but just using a double for simplicity now what we can do is we can",
    "start": "1601560",
    "end": "1607620"
  },
  {
    "text": "say that our saga is going to permantly is going to inherit from the base class discounting data is going to",
    "start": "1607620",
    "end": "1615160"
  },
  {
    "text": "be our state storage and we can handle the submit order message right so we can",
    "start": "1615160",
    "end": "1620560"
  },
  {
    "text": "say I am started by messages type submit' order that gives us again a",
    "start": "1620560",
    "end": "1626920"
  },
  {
    "text": "handle method to implement and in here we're doing what we're asked to do so",
    "start": "1626920",
    "end": "1632890"
  },
  {
    "text": "we're saying if the if the week total is greater or equal to a hundred the discount level is ten otherwise it's",
    "start": "1632890",
    "end": "1638620"
  },
  {
    "text": "zero we then send our process order message with that discount level and",
    "start": "1638620",
    "end": "1644250"
  },
  {
    "text": "here we need to add the current order to the week total for when the next message",
    "start": "1644250",
    "end": "1649870"
  },
  {
    "text": "comes in when the next order is submitted and here's a really important bit right here's the bit of magic we're",
    "start": "1649870",
    "end": "1656050"
  },
  {
    "text": "going to request a time out seven days from now with the same message right",
    "start": "1656050",
    "end": "1663940"
  },
  {
    "text": "this is say is again this request time it has a method on the saga base class",
    "start": "1663940",
    "end": "1669570"
  },
  {
    "text": "and what we do then is we hand we implement this interface called I handle",
    "start": "1669570",
    "end": "1674950"
  },
  {
    "text": "timeouts of submit order so not only am i now started by submit order I handled timeouts of submit order and we",
    "start": "1674950",
    "end": "1682660"
  },
  {
    "text": "implement a timeout method and then that",
    "start": "1682660",
    "end": "1688090"
  },
  {
    "text": "timeout method we know that when this method is called seven days have passed right so all we do here is we take away",
    "start": "1688090",
    "end": "1696420"
  },
  {
    "text": "all the total from the week total right and effectively we're done there's that",
    "start": "1696420",
    "end": "1701590"
  },
  {
    "text": "one last thing to do we need to configure how to find the saga so we need to say when a submit order message",
    "start": "1701590",
    "end": "1707740"
  },
  {
    "text": "comes in map the customer ID of the message the customer ID of the saga so we can correlate alright and now we're",
    "start": "1707740",
    "end": "1713860"
  },
  {
    "text": "basically done now this code is pretty easy to read right all we're doing a series saying well what's the discount",
    "start": "1713860",
    "end": "1719500"
  },
  {
    "text": "level send the process order message adds the total right a week later take",
    "start": "1719500",
    "end": "1725080"
  },
  {
    "text": "it away from the total it's exactly what I showed you in the diagram so how does",
    "start": "1725080",
    "end": "1730180"
  },
  {
    "text": "this actually work what does what does the infrastructure actually do when this happens so again when we get the first",
    "start": "1730180",
    "end": "1736870"
  },
  {
    "start": "1733000",
    "end": "2095000"
  },
  {
    "text": "message in we retrieve a saga I've left that bit out because you've already seen it but once we've got the saga object we",
    "start": "1736870",
    "end": "1742600"
  },
  {
    "text": "dispatch the method into the mess into it by calling the method the handle method the saga does some internal state",
    "start": "1742600",
    "end": "1749440"
  },
  {
    "text": "manipulation and then it requests a timeout right that's a method you've just seen at this point the bus does one",
    "start": "1749440",
    "end": "1756309"
  },
  {
    "text": "of two things either it puts the message directly in the message coud and says deliver me this message in a week and",
    "start": "1756309",
    "end": "1762870"
  },
  {
    "text": "some queueing system support that so I think the only one does it fully out of the box is either service bus which",
    "start": "1762870",
    "end": "1769809"
  },
  {
    "text": "despite its name is just a queueing system but it does support that out-of-the-box rabbitmq and amazon sqs",
    "start": "1769809",
    "end": "1776529"
  },
  {
    "text": "kind of do it I'll come to that in a minute and other two other queueing systems don't do it at all so MSM queue",
    "start": "1776529",
    "end": "1782890"
  },
  {
    "text": "has no facility for this so in those cases we actually persist the timeout in the database at the same time as we",
    "start": "1782890",
    "end": "1788649"
  },
  {
    "text": "persists our data and then we pull the database to see when the timeouts become due",
    "start": "1788649",
    "end": "1793899"
  },
  {
    "text": "that's not ideal we don't really want to be pulling the database if we can avoid it so we always prefer allowing the",
    "start": "1793899",
    "end": "1800320"
  },
  {
    "text": "queue itself to do the work over here now I'm gonna take a quick dive under the covers and sort of peek behind the",
    "start": "1800320",
    "end": "1806890"
  },
  {
    "text": "curtain and I'll show you what any service bus does behind the scenes a little bit here because it's quite interesting in the context of Amazon sqs",
    "start": "1806890",
    "end": "1813309"
  },
  {
    "text": "I've said that it kind of supports this and it does because it only allows you",
    "start": "1813309",
    "end": "1819100"
  },
  {
    "text": "to to delay a message by 900 seconds so 15 minutes is the maximum so if you want",
    "start": "1819100",
    "end": "1824440"
  },
  {
    "text": "to delay a message by 600 seconds that's fine you just tell Amazon sqs to say to deliver this message in 600 seconds if",
    "start": "1824440",
    "end": "1831399"
  },
  {
    "text": "you want to do something like 2,800 seconds it's a bit more complicated we",
    "start": "1831399",
    "end": "1837970"
  },
  {
    "text": "can only put this message in the queue for 900 seconds right that's the limit but what we can also do is we can write",
    "start": "1837970",
    "end": "1844450"
  },
  {
    "text": "a custom header on the message like a message for ourselves to say when we receive this back there still a delay of",
    "start": "1844450",
    "end": "1850720"
  },
  {
    "text": "1900 remaining so we know we can put it back on the queue for another 900 and",
    "start": "1850720",
    "end": "1855970"
  },
  {
    "text": "when we get that back we know there's a thousand remaining by looking at that header put that in the queue for another",
    "start": "1855970",
    "end": "1861669"
  },
  {
    "text": "900 seconds so we know there's only 100 remaining and we just put it in this queue for a hundred seconds so using",
    "start": "1861669",
    "end": "1866950"
  },
  {
    "text": "that by flowing the message through these queues four times we can actually simulate a delay of 2,800 seconds right",
    "start": "1866950",
    "end": "1873520"
  },
  {
    "text": "I'm good either arbitrarily for any kind of delay that works pretty well I bet MQ is a bit more interesting",
    "start": "1873520",
    "end": "1879820"
  },
  {
    "text": "rabbitmq has a Singh called time to live and what that means is for a specific queue in the rabbit MQ you can say",
    "start": "1879820",
    "end": "1887120"
  },
  {
    "text": "messages live in this queue for this amount of time so what we do is we say",
    "start": "1887120",
    "end": "1892670"
  },
  {
    "text": "we send the message into that queue let's say at 600 seconds we've set the 600 a second time to live we put a",
    "start": "1892670",
    "end": "1898730"
  },
  {
    "text": "message in that queue we don't we don't subscribe to that queue at all but what we do is we tell rabbits that when when",
    "start": "1898730",
    "end": "1905720"
  },
  {
    "text": "a message falls out of this queue when it when it's exceeded it's time to live put it in this other queue right and we",
    "start": "1905720",
    "end": "1911720"
  },
  {
    "text": "subscribe to that queue instead so using that we can actually simulate delayed delivery and naba MQ right and that",
    "start": "1911720",
    "end": "1918350"
  },
  {
    "text": "works pretty well because then you can create a queue with 900 second time to live one with 1500 seconds one with 2800",
    "start": "1918350",
    "end": "1924680"
  },
  {
    "text": "seconds but you might be starting to spot the problem here you're gonna have",
    "start": "1924680",
    "end": "1929720"
  },
  {
    "text": "to have a separate queue for every delay level you want in your system now the API looks like this right and I can",
    "start": "1929720",
    "end": "1936410"
  },
  {
    "text": "write any number I like in there okay if I want to be really evil I can write random dot next right and I don't think",
    "start": "1936410",
    "end": "1943820"
  },
  {
    "text": "any there might be some business where there might be use case flow I don't I might want to randomize their delays for",
    "start": "1943820",
    "end": "1949400"
  },
  {
    "text": "some reason but the problem is that at the number of queues could kind of grow and kind of grow infinitely right we",
    "start": "1949400",
    "end": "1955550"
  },
  {
    "text": "don't want customers asking us why and service buses Krang 50,000 queues in their rabbit MQ broker so we need",
    "start": "1955550",
    "end": "1962570"
  },
  {
    "text": "another approach now let's take a more simple example 42 seconds right we all",
    "start": "1962570",
    "end": "1967820"
  },
  {
    "text": "love that number but it's only written with the digits 4 and 2 in base 10 right",
    "start": "1967820",
    "end": "1973970"
  },
  {
    "text": "so this is 42 in base 10 or decimal but us clever computer program programmers",
    "start": "1973970",
    "end": "1979730"
  },
  {
    "text": "we know there are other counting systems like binary and we can write this as one hundred and one thousand and ten seconds",
    "start": "1979730",
    "end": "1987320"
  },
  {
    "text": "in base two or binary now what if we create a queue with a 32 second time to",
    "start": "1987320",
    "end": "1993320"
  },
  {
    "text": "live one with 16 second time to live one with eight on the four two and one we",
    "start": "1993320",
    "end": "1999170"
  },
  {
    "text": "can take on number 42 and write it in binary alongside these queues we can",
    "start": "1999170",
    "end": "2005200"
  },
  {
    "text": "send this message through the 32 second queue skip the sixteen through the eight",
    "start": "2005200",
    "end": "2011740"
  },
  {
    "text": "skip the four through the set through the two skip the one and by sending the message through the 32 plus the 8 plus",
    "start": "2011740",
    "end": "2018460"
  },
  {
    "text": "or two which is 42 we've simulated a 42 second delay and rabbitmq right and now",
    "start": "2018460",
    "end": "2024070"
  },
  {
    "text": "though I don't I haven't seen anyone else do that in the in the community I think it's quite a kind of original",
    "start": "2024070",
    "end": "2029110"
  },
  {
    "text": "invention so you know I think it's we can we can we can simulate a delay of up",
    "start": "2029110",
    "end": "2034480"
  },
  {
    "text": "to 63 seconds right with these with these six cues which isn't a lot so we actually create 28 cues which means you",
    "start": "2034480",
    "end": "2041800"
  },
  {
    "text": "can have a maximum delay of two to the 28 seconds or this big number here or about eight and a half years now you",
    "start": "2041800",
    "end": "2048730"
  },
  {
    "text": "might think well why eight and a half years it's bit why 28 cues is a bit arbitrary well we consider 25 which",
    "start": "2048730",
    "end": "2055780"
  },
  {
    "text": "would give you just over a year but then we didn't like backs it was odd so we thought 26 and then we thought well 26",
    "start": "2055780",
    "end": "2063100"
  },
  {
    "text": "we think that's safe but let's just go one order of magnitude higher just to be safe so 27 was a candidate but of course",
    "start": "2063100",
    "end": "2069669"
  },
  {
    "text": "that was odd so it ended up being 28 we're really tempted to go for 32 but",
    "start": "2069670",
    "end": "2075639"
  },
  {
    "text": "that would have given us a maximum that I have 136 years and it's nice to think",
    "start": "2075640",
    "end": "2080740"
  },
  {
    "text": "that someone's using an service bus 136 years from now but it's probably bit over the top so 28 years if someone",
    "start": "2080740",
    "end": "2087879"
  },
  {
    "text": "really needs more than 8 and a half years we'll add at 20 nights whatever I would probably add a 30 at the same time",
    "start": "2087880",
    "end": "2094260"
  },
  {
    "text": "so have we solved our problem here right we've got this nice sauger now it's only touching one row but thing is the users",
    "start": "2094260",
    "end": "2102220"
  },
  {
    "text": "don't care don't care we're using a song they're still going to start pressing the button at the same time so we're",
    "start": "2102220",
    "end": "2107680"
  },
  {
    "text": "still going to get two of these saga things executing concurrently you know maybe on different processes or maybe if you're using two threads in your process",
    "start": "2107680",
    "end": "2114730"
  },
  {
    "text": "and they're still gonna see the saga state of 90 right they're both gonna see",
    "start": "2114730",
    "end": "2120670"
  },
  {
    "text": "in 90 and this weekly total so we haven't actually solved a problem at all right but the thing is remember that",
    "start": "2120670",
    "end": "2126730"
  },
  {
    "text": "we're writing the saga state to a single row in the database now now we can actually take advantage of regular",
    "start": "2126730",
    "end": "2133420"
  },
  {
    "text": "optimistic concurrency so we've seen how these things get invoked we've seen that this this this same process is going to",
    "start": "2133420",
    "end": "2139840"
  },
  {
    "text": "happen in two different threads now what's going to happen here is that the sagas are going to",
    "start": "2139840",
    "end": "2146009"
  },
  {
    "text": "c19 the database they're gonna set the discount of zero they're gonna send the",
    "start": "2146009",
    "end": "2151210"
  },
  {
    "text": "process order message with a discount of zero which is wrong both of them are going to do that but because they're",
    "start": "2151210",
    "end": "2157509"
  },
  {
    "text": "trying to write the saga state to the same row in the database one of them is going to succeed right and importantly",
    "start": "2157509",
    "end": "2165180"
  },
  {
    "text": "it's messages will be sent because n service bus guarantees that the messages",
    "start": "2165180",
    "end": "2170619"
  },
  {
    "text": "are only sent from the handle method if the saga state is persisted all right so",
    "start": "2170619",
    "end": "2175930"
  },
  {
    "text": "that line of code which says context got published a context dot send we don't actually send the message at that point",
    "start": "2175930",
    "end": "2181599"
  },
  {
    "text": "we send the message as we save the saga as we save the saga state so those",
    "start": "2181599",
    "end": "2186789"
  },
  {
    "text": "message those messages get sent this transaction gets refused because it's",
    "start": "2186789",
    "end": "2192730"
  },
  {
    "text": "trying to write to the same row so these messages are not sent at that point that",
    "start": "2192730",
    "end": "2198279"
  },
  {
    "text": "message gets rolled back to the queue it gets invoked into the saga instance again now the saga is going to read the",
    "start": "2198279",
    "end": "2205569"
  },
  {
    "text": "updated state from that other thread right it will now be a hundred so it will give a discount of 10% and",
    "start": "2205569",
    "end": "2211539"
  },
  {
    "text": "importantly it will be able to save its targeted saga state the messages will go",
    "start": "2211539",
    "end": "2217029"
  },
  {
    "text": "out and we have achieved our objective okay so you know we're getting on the way to killing the batch job and I'll",
    "start": "2217029",
    "end": "2223089"
  },
  {
    "text": "tell you what a particular software this is one of our missions right we want to kill the batch job we want to rid the",
    "start": "2223089",
    "end": "2228759"
  },
  {
    "text": "world of that jobs we even published a blog post a couple years ago called",
    "start": "2228759",
    "end": "2235029"
  },
  {
    "text": "deaths of the batch job I was just on that on our website and one of the reasons for that is because when you",
    "start": "2235029",
    "end": "2240400"
  },
  {
    "text": "start to use this alternate programming model this becomes part of your domain right this saga lives in the little",
    "start": "2240400",
    "end": "2246609"
  },
  {
    "text": "lives in the rest of your code it lives it uses you what the main objects it's all nicely DD deed and TD deed and it's",
    "start": "2246609",
    "end": "2253839"
  },
  {
    "text": "not this kind of separate thing on the outside now the problem is that we speak to people about this and no matter how",
    "start": "2253839",
    "end": "2260380"
  },
  {
    "text": "hard we try well you always get to the point where the customers still talk about they still say well ok that's all",
    "start": "2260380",
    "end": "2267220"
  },
  {
    "text": "really well and good but in this specific case I still really need batch",
    "start": "2267220",
    "end": "2272680"
  },
  {
    "text": "jobs I still really need them that something else this isn't gonna work for me one of the really common",
    "start": "2272680",
    "end": "2279150"
  },
  {
    "text": "the things is reports so anyone here work with a system which produces reports it's quite a common thing yeah",
    "start": "2279150",
    "end": "2284609"
  },
  {
    "text": "that's about half of you so I worked with a system in my previous job and the",
    "start": "2284609",
    "end": "2292049"
  },
  {
    "text": "overnight batch job started to finish around lunchtime right we actually became victims our own success that",
    "start": "2292049",
    "end": "2298259"
  },
  {
    "text": "business was going well and this thing because we're getting more and more things in database you know more customers ordering things the batch job",
    "start": "2298259",
    "end": "2305039"
  },
  {
    "text": "was growing and growing and growing to the point where I mean I don't know where it is now and I left a couple of",
    "start": "2305039",
    "end": "2310440"
  },
  {
    "text": "years ago but you know is we was threatening to start finishing towards the end of the working day which really",
    "start": "2310440",
    "end": "2315509"
  },
  {
    "text": "isn't very practical at all you know getting close to when you actually have to kick off the next one that night and",
    "start": "2315509",
    "end": "2320880"
  },
  {
    "text": "then of course if you open an office in Singapore or in New York or in San Francisco you actually don't have any",
    "start": "2320880",
    "end": "2326849"
  },
  {
    "text": "night anymore so you know the whole concept of well I mean like bash up kind of falls away but the thing about",
    "start": "2326849",
    "end": "2334109"
  },
  {
    "start": "2333000",
    "end": "2591000"
  },
  {
    "text": "reports is that if you look at what the users are doing with reports if you",
    "start": "2334109",
    "end": "2339329"
  },
  {
    "text": "start to ask why right and this is a really important thing you need to start asking why there's this thing called",
    "start": "2339329",
    "end": "2344369"
  },
  {
    "text": "five why's where you kind of go through this process of asking why kind of around five times until you get to the",
    "start": "2344369",
    "end": "2350549"
  },
  {
    "text": "actual requirement and they tell you that they run this report at some time in the morning every day and let's say",
    "start": "2350549",
    "end": "2356880"
  },
  {
    "text": "this is some kind of banking domain or something there looks at a report and they and they say well I look for large",
    "start": "2356880",
    "end": "2363950"
  },
  {
    "text": "transactions in high-risk countries and if there's three of those within a week",
    "start": "2363950",
    "end": "2370369"
  },
  {
    "text": "then I kick off some kind of process I go and talk to my manager or I call the",
    "start": "2370369",
    "end": "2375779"
  },
  {
    "text": "customer or I temporarily lock the account or do something now you're already starting to learn things by",
    "start": "2375779",
    "end": "2382230"
  },
  {
    "text": "asking those questions you've learned that there is a concept of a large transaction and there's a concept of a",
    "start": "2382230",
    "end": "2387269"
  },
  {
    "text": "high-risk country I risk country and then once a year large transactions over",
    "start": "2387269",
    "end": "2392460"
  },
  {
    "text": "ten thousand dollars are high-risk countries any one of these six something like that so your again your bit your",
    "start": "2392460",
    "end": "2397920"
  },
  {
    "text": "ubiquitous language and Dedede terms is starting to get enriched now the thing",
    "start": "2397920",
    "end": "2404009"
  },
  {
    "text": "is again the report was never a requirement my it was status as a",
    "start": "2404009",
    "end": "2409710"
  },
  {
    "text": "requirement but it is actually a workaround within the constraints of the current system they knew that these transactions",
    "start": "2409710",
    "end": "2416180"
  },
  {
    "text": "are being held they knew that if they put them into a report each day they could look through them find the highest",
    "start": "2416180",
    "end": "2421370"
  },
  {
    "text": "transactions the possible fraudulent transactions and take some action the",
    "start": "2421370",
    "end": "2426680"
  },
  {
    "text": "actual requirement was when there are three possible fraudulent transactions",
    "start": "2426680",
    "end": "2432050"
  },
  {
    "text": "within a week I want to know about it so why not use something like a saga and do",
    "start": "2432050",
    "end": "2439220"
  },
  {
    "text": "some kind of automated pattern matching so we can subscribe to events we can say let's say there's a transaction occurred",
    "start": "2439220",
    "end": "2445760"
  },
  {
    "text": "event or something like that we can look at those events we can examine them we can say it's this a large is this a",
    "start": "2445760",
    "end": "2453440"
  },
  {
    "text": "large transaction you know is it over $10,000 is it a high-risk country yes",
    "start": "2453440",
    "end": "2458720"
  },
  {
    "text": "it's in one of these six if so we add that transaction to our saga state to",
    "start": "2458720",
    "end": "2465950"
  },
  {
    "text": "say possible fraud in transaction while you put it into a collection in our saga state then we send the message to",
    "start": "2465950",
    "end": "2473000"
  },
  {
    "text": "ourselves one week from now to remove that transaction from our possible fraud in transactions and again what we've",
    "start": "2473000",
    "end": "2480620"
  },
  {
    "text": "built for ourselves is the same sliding-window right we've got a sliding window of one week which is recording",
    "start": "2480620",
    "end": "2486140"
  },
  {
    "text": "all the possible fraudulent transactions within that week and we know that any time when that collection count hits",
    "start": "2486140",
    "end": "2493010"
  },
  {
    "text": "three we need to inform the user so we might send them an email or something",
    "start": "2493010",
    "end": "2498110"
  },
  {
    "text": "and they might then go and tell their manager and the thing is that this might",
    "start": "2498110",
    "end": "2504380"
  },
  {
    "text": "happen that's a half past four in the afternoon right and you usually check that report at 9:30 in the morning so",
    "start": "2504380",
    "end": "2510470"
  },
  {
    "text": "the manager says to you well hang on it's half past four in the afternoon you normally check that report at 9:30 why",
    "start": "2510470",
    "end": "2516410"
  },
  {
    "text": "is it taking you seven hours to tell me right you should be telling in this straightaway you know this is urgent we",
    "start": "2516410",
    "end": "2521570"
  },
  {
    "text": "need to do something they say oh no system told me what do you mean the system told you oh yeah you know that",
    "start": "2521570",
    "end": "2528020"
  },
  {
    "text": "saga thing the developers are talking about a couple of weeks ago yeah they they implemented that they rolled it all",
    "start": "2528020",
    "end": "2533870"
  },
  {
    "text": "out and then a system just tells me they say well what you mean you don't you don't look at that report anymore sir I",
    "start": "2533870",
    "end": "2540320"
  },
  {
    "text": "haven't looked at the report for two weeks right the system now tells us and we know exactly when it",
    "start": "2540320",
    "end": "2545540"
  },
  {
    "text": "we can take action straight away we don't have to wait to the next day and this is kind of mind-blowing",
    "start": "2545540",
    "end": "2550880"
  },
  {
    "text": "right this is when managers hear this kind of thing this is like real time business intelligence all right this is",
    "start": "2550880",
    "end": "2556640"
  },
  {
    "text": "where they say well I want more of that stuff yeah that saga stuff I want more of that okay well how do i how do i how",
    "start": "2556640",
    "end": "2562850"
  },
  {
    "text": "do I get more of that where do I sign because ultimately this translates to actual business value right this is",
    "start": "2562850",
    "end": "2568340"
  },
  {
    "text": "actual money i these are these are Norwegian kroner right is it is that the",
    "start": "2568340",
    "end": "2574460"
  },
  {
    "text": "right money I actually don't really see this very often nowadays do you it's kind of all plastic but this does",
    "start": "2574460",
    "end": "2580040"
  },
  {
    "text": "translate into actual business value right so this is actual money this is when a software development team can",
    "start": "2580040",
    "end": "2585620"
  },
  {
    "text": "start to transition from being a cost center to being a profit Center so",
    "start": "2585620",
    "end": "2592730"
  },
  {
    "start": "2591000",
    "end": "2861000"
  },
  {
    "text": "before I wrap up I've shown you a little bit about an service bus here if you want to know a little bit more about",
    "start": "2592730",
    "end": "2598730"
  },
  {
    "text": "that we've got this game going on it's it's this kind of space exploration game",
    "start": "2598730",
    "end": "2603920"
  },
  {
    "text": "where it kind of takes you through the API and shows you that so you can follow that URL and see that their details",
    "start": "2603920",
    "end": "2609680"
  },
  {
    "text": "about that down in our booths on the exhibition hall as well and I hope that",
    "start": "2609680",
    "end": "2615350"
  },
  {
    "text": "this has given you a kind of different perspective on this arrow of time there's a couple of key takeaways that",
    "start": "2615350",
    "end": "2620930"
  },
  {
    "text": "we take with you so the first thing is that you want to be using a programming model which embraces the aspect of time",
    "start": "2620930",
    "end": "2628310"
  },
  {
    "text": "okay you don't want to be fudging this by doing historical lookups or batch jobs and that kind of thing you want a",
    "start": "2628310",
    "end": "2634670"
  },
  {
    "text": "programming model which embraces the aspects of time and actually allows you to put that into your code right using",
    "start": "2634670",
    "end": "2641000"
  },
  {
    "text": "something like durable messaging allows you to do that and they're in a reliable and and to guarantee that's going to",
    "start": "2641000",
    "end": "2649700"
  },
  {
    "text": "happen rather than trying to fudge that with some kind of database polling of your own because then you end up you end",
    "start": "2649700",
    "end": "2655460"
  },
  {
    "text": "up just building your own cue anyway so we'll use some kind of programming model which actually embraces this aspect and",
    "start": "2655460",
    "end": "2661060"
  },
  {
    "text": "you can then fold it into your DDD aggregate roots so sagas has anyone read",
    "start": "2661060",
    "end": "2667070"
  },
  {
    "text": "Eric Evans Dedede book that's a few of you so in there he talks about aggregate roots sagas are actually very good",
    "start": "2667070",
    "end": "2673820"
  },
  {
    "text": "accurate aggregate roots so if you think about it what they do is they encapsulate private data",
    "start": "2673820",
    "end": "2679070"
  },
  {
    "text": "and moreover they're actually just very good objects so if you've ever read anything by Alan Kay who wrote about",
    "start": "2679070",
    "end": "2685010"
  },
  {
    "text": "object orientation a long time ago he never really talked about polymorphism",
    "start": "2685010",
    "end": "2690500"
  },
  {
    "text": "and inheritance and that kind of thing he talked about objects receiving messages encapsulating data and business",
    "start": "2690500",
    "end": "2697940"
  },
  {
    "text": "logic and sending other messages out right sounds very much like a saga so I",
    "start": "2697940",
    "end": "2703100"
  },
  {
    "text": "often say that sagas are a just object orientation done right with a difference",
    "start": "2703100",
    "end": "2708200"
  },
  {
    "text": "that they are persisted right they survive process restarts so it's like a persistent state object that's alive",
    "start": "2708200",
    "end": "2714860"
  },
  {
    "text": "process restarts and it wraps up this kind of messages in a messages out thing",
    "start": "2714860",
    "end": "2719900"
  },
  {
    "text": "for you there are very very good test targets so any fans of any fans of TDD here so half",
    "start": "2719900",
    "end": "2727250"
  },
  {
    "text": "I bet the people who didn't put their hands up absolutely hate it it's a kind of love-hate thing with TDD I think part",
    "start": "2727250",
    "end": "2732860"
  },
  {
    "text": "of the problem there is that we've never had really good units to TDD so because",
    "start": "2732860",
    "end": "2741140"
  },
  {
    "text": "and because a saga completely encapsulates its data and it's just messages coming in messages going out",
    "start": "2741140",
    "end": "2746180"
  },
  {
    "text": "it's a very very good TDD target you can kind of get around the whiteboard with your domain experts and say well you",
    "start": "2746180",
    "end": "2752600"
  },
  {
    "text": "know when this happens and this happens and this happens when we get these messages in we want these messages out",
    "start": "2752600",
    "end": "2757790"
  },
  {
    "text": "and we have a testing package friend service bus which allows you to put a testable context into those methods that",
    "start": "2757790",
    "end": "2764480"
  },
  {
    "text": "context object and you can call a few handle methods and then look at the context objects to see which messages",
    "start": "2764480",
    "end": "2770480"
  },
  {
    "text": "messages were sent out so they're very very good TDD targets and I do recommend that you do that right I do recommend",
    "start": "2770480",
    "end": "2777050"
  },
  {
    "text": "that you test sagas especially if you're looking at the aspect of time because",
    "start": "2777050",
    "end": "2782690"
  },
  {
    "text": "you you don't want to be kind of sending something into the system waiting a week",
    "start": "2782690",
    "end": "2787940"
  },
  {
    "text": "and then waiting to see if it happens correctly you can actually just call the request timeout method and do that and",
    "start": "2787940",
    "end": "2792950"
  },
  {
    "text": "do that in your code the other thing that I really wanted to take away again is that thing about workarounds versus",
    "start": "2792950",
    "end": "2800240"
  },
  {
    "text": "requirements okay and that's that this involves talking to your business which is often a tough thing to do but I",
    "start": "2800240",
    "end": "2806510"
  },
  {
    "text": "actually do think it's one of the biggest challenges that we have as developers is to actually get to the real requirements",
    "start": "2806510",
    "end": "2811869"
  },
  {
    "text": "because I think more often lot in my career I've been given workarounds within the within the constraints of the",
    "start": "2811869",
    "end": "2818170"
  },
  {
    "text": "current system and it's it's part of that asking why and actually getting back to the actual requirement itself",
    "start": "2818170",
    "end": "2824230"
  },
  {
    "text": "that's a bit of an art form and ultimately it's okay it can be an organizational problem sometimes it can",
    "start": "2824230",
    "end": "2830410"
  },
  {
    "text": "be difficult just to talk to the people that have that information you know sometimes you might have a business",
    "start": "2830410",
    "end": "2836289"
  },
  {
    "text": "analyst sitting between you and the actual business users or kind of proxy domain expert kind of person so actually",
    "start": "2836289",
    "end": "2842470"
  },
  {
    "text": "getting in the same room with the actual people that can give you the real quirements is sometimes a challenge as well and that's just an example of kind",
    "start": "2842470",
    "end": "2849279"
  },
  {
    "text": "of an organizational problem which is ultimately a lot of problem that we face as developers now we don't face as many",
    "start": "2849279",
    "end": "2855519"
  },
  {
    "text": "technical problems as we think it's actually a lot of organizational problem where things come from so I hope that's",
    "start": "2855519",
    "end": "2862749"
  },
  {
    "start": "2861000",
    "end": "2891000"
  },
  {
    "text": "given you a good sort of different quite a different method and different methodology of thinking about this era",
    "start": "2862749",
    "end": "2868690"
  },
  {
    "text": "of time and they're taking kind of toolkit in your a different thing in your toolkit to actually think about how to actually get that into your systems",
    "start": "2868690",
    "end": "2875140"
  },
  {
    "text": "and how to model it so I've actually raced through that content I think I've got over ten minutes left so if anyone's",
    "start": "2875140",
    "end": "2881980"
  },
  {
    "text": "got any questions right now I'll be more than happy to take them yeah do I have",
    "start": "2881980",
    "end": "2892299"
  },
  {
    "start": "2891000",
    "end": "3021000"
  },
  {
    "text": "experience with overusing sagas the answer to that is an unqualified yes",
    "start": "2892299",
    "end": "2897359"
  },
  {
    "text": "because what I've seen sometimes is once you learn about sagas you start seeing",
    "start": "2897359",
    "end": "2903190"
  },
  {
    "text": "sagas everywhere right and so they're not that like anything they're not that",
    "start": "2903190",
    "end": "2908410"
  },
  {
    "text": "golden hammer they're not that Silver Bullet which would solve all your problems they are something to be chosen to be used and yes I've seen people",
    "start": "2908410",
    "end": "2914920"
  },
  {
    "text": "overuse them definitely yeah I mean one of the things is that one of the",
    "start": "2914920",
    "end": "2919930"
  },
  {
    "text": "specific examples is that people sometimes think that a saga is an Orchestrator for a much wider business",
    "start": "2919930",
    "end": "2925239"
  },
  {
    "text": "process so say well we've got a service over here and a service over here and a",
    "start": "2925239",
    "end": "2930759"
  },
  {
    "text": "service over here let's say it's flights and hotels and booking and the saga needs to orchestrate all of that the",
    "start": "2930759",
    "end": "2936519"
  },
  {
    "text": "problem is that when you so I give another talk called finding your service boundaries and that's also online I gave",
    "start": "2936519",
    "end": "2942640"
  },
  {
    "text": "it last year in there I talked about how to actually find their service boundaries and how you must not cross service",
    "start": "2942640",
    "end": "2949460"
  },
  {
    "text": "boundaries within us within a saga or anything else so it's important to say that a saga is within a service boundary",
    "start": "2949460",
    "end": "2956750"
  },
  {
    "text": "or a bounded context if you like in son of DDD terms use a saga within a bounded",
    "start": "2956750",
    "end": "2962210"
  },
  {
    "text": "context if something else needs to happen some other bounded context raising the vent from that saga start a",
    "start": "2962210",
    "end": "2968690"
  },
  {
    "text": "new saga new bounded context so don't have this kind of God saga encompassing everything still respect your bounded",
    "start": "2968690",
    "end": "2975350"
  },
  {
    "text": "context in your service boundaries by splitting those splitting a larger workflow up into smaller sagas is that",
    "start": "2975350",
    "end": "2981920"
  },
  {
    "text": "more or less answer the question hey any more questions yeah",
    "start": "2981920",
    "end": "2988119"
  },
  {
    "text": "so is it sorry but is a bit difficult to hear you but you're saying when you have a service layer yeah right",
    "start": "3001590",
    "end": "3014720"
  },
  {
    "text": "right so when he ever alright so when you have a service layer we've got this",
    "start": "3020269",
    "end": "3025309"
  },
  {
    "start": "3021000",
    "end": "3221000"
  },
  {
    "text": "with this delayed messages thing and I'm trying to use it for part of the business logic and you're saying that",
    "start": "3025309",
    "end": "3032439"
  },
  {
    "text": "you're saying it's dangerous okay so is",
    "start": "3032439",
    "end": "3038179"
  },
  {
    "text": "it dangerous is your question is it dangerous okay so you're saying right so",
    "start": "3038179",
    "end": "3046189"
  },
  {
    "text": "you're saying I'm scattering the logic well yes yes I am I'm spreading the logic over time but what I'm doing there",
    "start": "3046189",
    "end": "3053479"
  },
  {
    "text": "is I'm actually embracing the business requirement so that is actually the business requirement is that we want to",
    "start": "3053479",
    "end": "3058579"
  },
  {
    "text": "keep we want to keep a window of the current week total for a customer and we",
    "start": "3058579",
    "end": "3064189"
  },
  {
    "text": "want to take action based on that right so what I'm actually doing is I'm actually embracing that business logic",
    "start": "3064189",
    "end": "3070039"
  },
  {
    "text": "in my code and I can see I can see that you know I can read that code and say well I see what happens now I see what",
    "start": "3070039",
    "end": "3077029"
  },
  {
    "text": "happens in a week's time so you know that actually expresses that requirement",
    "start": "3077029",
    "end": "3082489"
  },
  {
    "text": "so I can see maybe you're nervous about the fact that this stuff is in timeouts any kind of and it's kind of hidden from",
    "start": "3082489",
    "end": "3088999"
  },
  {
    "text": "view right so what you can do then is you can kind of use a CQ RSS kind of",
    "start": "3088999",
    "end": "3096139"
  },
  {
    "text": "approach to say well you can raise an event and and written and write that out into a read model so that any one time",
    "start": "3096139",
    "end": "3103249"
  },
  {
    "text": "you can say well I've got these things which are pending right I've got these uncompleted sagas effectively and",
    "start": "3103249",
    "end": "3109249"
  },
  {
    "text": "actually that is one of the other pitfalls of using sagas is we often have a lot of customers who ask how do I see",
    "start": "3109249",
    "end": "3114979"
  },
  {
    "text": "what's inside the saga you know how do I see inside the saga data and the problem",
    "start": "3114979",
    "end": "3120499"
  },
  {
    "text": "with that is you don't want to be doing that because then you're punching through the abstraction and all of a sudden you can't actually change your",
    "start": "3120499",
    "end": "3126439"
  },
  {
    "text": "saga in isolation because you've got all these other things looking into the database so that's why it's really good",
    "start": "3126439",
    "end": "3132229"
  },
  {
    "text": "to raise events and actually capture that as a first-class read model to say",
    "start": "3132229",
    "end": "3137299"
  },
  {
    "text": "well you know this is the state of this process right now and I'm going to write that onto an explicit read model does",
    "start": "3137299",
    "end": "3143659"
  },
  {
    "text": "that lay some of your fears around the kind of",
    "start": "3143659",
    "end": "3149270"
  },
  {
    "text": "yeah",
    "start": "3149270",
    "end": "3152270"
  },
  {
    "text": "so so Azure storage cues is another transport is another cue that we do",
    "start": "3156250",
    "end": "3162520"
  },
  {
    "text": "support that does not have any kind of delayed delayed message mechanism",
    "start": "3162520",
    "end": "3168520"
  },
  {
    "text": "built-in so we do use the database method for as a service bus either service bus as a different queueing",
    "start": "3168520",
    "end": "3174760"
  },
  {
    "text": "technology that has the native delays built-in I'm finding a little bit",
    "start": "3174760",
    "end": "3184210"
  },
  {
    "text": "difficult to hear you now so come and come and grab me afterwards and welcome to the conversation okay any other questions before we wrap up yeah",
    "start": "3184210",
    "end": "3194910"
  },
  {
    "text": "mm-hm",
    "start": "3206610",
    "end": "3209610"
  },
  {
    "text": "right okay okay so your question is you",
    "start": "3216640",
    "end": "3224299"
  },
  {
    "start": "3221000",
    "end": "3305000"
  },
  {
    "text": "you do this transactional thing at the beginning you do a similar transactional thing at the end when the message becomes due in a week's time and do you",
    "start": "3224299",
    "end": "3231410"
  },
  {
    "text": "have the same transactional guarantees around it so the answer is yes because when you receive it when you receive",
    "start": "3231410",
    "end": "3237079"
  },
  {
    "text": "that time out in a week's time you can do that it's it's exactly like a regular message handling so you handle the",
    "start": "3237079",
    "end": "3244220"
  },
  {
    "text": "message the the sagas internal state will get mutated somehow you'll persist",
    "start": "3244220",
    "end": "3249710"
  },
  {
    "text": "that state and actually you're persistent regardless even if it's not mutated and again if you're sending",
    "start": "3249710",
    "end": "3254900"
  },
  {
    "text": "messages out from that time out method if you can't persist the state because there's another concurrent operation",
    "start": "3254900",
    "end": "3261170"
  },
  {
    "text": "that transaction will get rolled back and the message won't go out so handling the time out has exactly the same",
    "start": "3261170",
    "end": "3267349"
  },
  {
    "text": "transactional guarantees around it as handling the initial message",
    "start": "3267349",
    "end": "3272020"
  },
  {
    "text": "okay so I'll let you go about a few minutes early I've hope you enjoyed that I hope you enjoyed the rest of the",
    "start": "3273549",
    "end": "3279589"
  },
  {
    "text": "conference I am I am gonna be at the particular software booth for most of the rest of",
    "start": "3279589",
    "end": "3285920"
  },
  {
    "text": "today and probably tomorrow so we've got more questions please do come and grab me and more than more than interested to",
    "start": "3285920",
    "end": "3291230"
  },
  {
    "text": "answer them for you I hope you enjoy the rest of the conference I've enjoyed talking to you and thank you very much",
    "start": "3291230",
    "end": "3298240"
  },
  {
    "text": "[Applause]",
    "start": "3299400",
    "end": "3302609"
  }
]