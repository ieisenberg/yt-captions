[
  {
    "text": "okay are we on nice hello everyone so I want to share with you a story if I",
    "start": "120",
    "end": "8639"
  },
  {
    "text": "can of how how I found and investigated something that could have been a very genuine",
    "start": "8639",
    "end": "15299"
  },
  {
    "text": "cyber security disaster so as it says in the title of my talk crypto Heist we're going to look into",
    "start": "15299",
    "end": "22020"
  },
  {
    "text": "the source and then the remediation of one of the largest cryptojacking attacks",
    "start": "22020",
    "end": "27119"
  },
  {
    "text": "that we've actually ever seen so to set the scene imagine if you will for me",
    "start": "27119",
    "end": "32520"
  },
  {
    "text": "it is a Sunday morning and I haven't long had my first sip of coffee so I'm not fully functional just yet and a good",
    "start": "32520",
    "end": "39899"
  },
  {
    "text": "friend of mine sends me a DM now I've known Ian for a very long time and he sends me a DM and he's like hey Scott",
    "start": "39899",
    "end": "46680"
  },
  {
    "text": "you know can I just ask you something and when a friend reaches out and I ask something like this it's usually like",
    "start": "46680",
    "end": "53039"
  },
  {
    "text": "oh boy here we go so what's coming he sends me a screenshot and he says I've just been onto the government website",
    "start": "53039",
    "end": "59280"
  },
  {
    "text": "here and this is the information commissioner's office website in the UK so there are data privacy Watchdog if",
    "start": "59280",
    "end": "65518"
  },
  {
    "text": "you do bad things with people's data they will send you a fine or tell you off",
    "start": "65519",
    "end": "70560"
  },
  {
    "text": "so he says any chance you could take a look at this site my antivirus program has thrown up this warning when I",
    "start": "70560",
    "end": "77520"
  },
  {
    "text": "visited the page and I'm like okay you know this is a bit strange so I go to the site myself and I take a look around",
    "start": "77520",
    "end": "84479"
  },
  {
    "text": "and I'm like yeah you know there's something fishy going on here there's something dangerous going on here",
    "start": "84479",
    "end": "90180"
  },
  {
    "text": "now he was you know he was sent me the screenshot I responded and said uh golly",
    "start": "90180",
    "end": "95220"
  },
  {
    "text": "gosh this looks bad um that's uh maybe I should have blanked",
    "start": "95220",
    "end": "101340"
  },
  {
    "text": "that part out but I was like yeah I see the same thing like I see this too now the warning from his antivirus program",
    "start": "101340",
    "end": "107820"
  },
  {
    "text": "if I just kind of zoom in on that for you a little bit was that there was a JavaScript Miner a",
    "start": "107820",
    "end": "112860"
  },
  {
    "text": "crypto Miner on the page so I double check the URL and I'm like am I am I on",
    "start": "112860",
    "end": "119280"
  },
  {
    "text": "the government site like is this you know is this actually the government saying I'm like yeah ico.org dot UK the",
    "start": "119280",
    "end": "125579"
  },
  {
    "text": "information commissioner's office I double checked with some other government sites to see like you know if they can say what is the correct site",
    "start": "125579",
    "end": "131520"
  },
  {
    "text": "for for this department and I'm like yeah this is definitely the right site this is a government site and I am also",
    "start": "131520",
    "end": "138300"
  },
  {
    "text": "seeing that there is some JavaScript on this page that is mining cryptocurrency so this is something that is possible",
    "start": "138300",
    "end": "144360"
  },
  {
    "text": "for those of you that don't know you can do almost anything with JavaScript including mind crypto and at the time I was thinking well I",
    "start": "144360",
    "end": "152099"
  },
  {
    "text": "know government budgets are a little bit tight but I'm not entirely sure",
    "start": "152099",
    "end": "157760"
  },
  {
    "text": "I'm not entirely sure that this is going to be their decision So within the security realm we have",
    "start": "157760",
    "end": "164040"
  },
  {
    "text": "this phrase called cross-site scripting and it refers to a whole variety of attacks where somehow an attacker finds",
    "start": "164040",
    "end": "171360"
  },
  {
    "text": "a way to get their malicious JavaScript into your website and there's a whole bunch of different ways but the most",
    "start": "171360",
    "end": "176760"
  },
  {
    "text": "common way that we see is via a third party dependency being compromised and I",
    "start": "176760",
    "end": "182040"
  },
  {
    "text": "thought to myself well I'm pretty sure that this is not going to be the British government trying to top up their budget",
    "start": "182040",
    "end": "188160"
  },
  {
    "text": "I'm pretty sure that we're going to be looking at some kind of serious compromise here so I set off with my",
    "start": "188160",
    "end": "195000"
  },
  {
    "text": "investigation it was a Sunday morning I threw down my second coffee I confirmed",
    "start": "195000",
    "end": "200580"
  },
  {
    "text": "what I found and then Ian says yeah like what do we do I was like I've confirmed",
    "start": "200580",
    "end": "205800"
  },
  {
    "text": "this they actually have it's a library called coin Hive as you can see I mentioned there it's a dedicated library",
    "start": "205800",
    "end": "211319"
  },
  {
    "text": "for Mining cryptocurrency and JavaScript and I was like they definitely have coin coin Hive on their site",
    "start": "211319",
    "end": "218159"
  },
  {
    "text": "and Ian said yes this is what I'm seeing too and then he asked me so now what do we do right like what",
    "start": "218159",
    "end": "223980"
  },
  {
    "text": "what do we do with this information what do we do with this knowledge that we now have now if you've ever kind of heard maybe",
    "start": "223980",
    "end": "230640"
  },
  {
    "text": "one of my security talks or one of the other many security talks we have this process called responsible",
    "start": "230640",
    "end": "235739"
  },
  {
    "text": "disclosure within the security industry and the idea is if you find somebody's website is doing something that it's not",
    "start": "235739",
    "end": "242220"
  },
  {
    "text": "supposed to maybe it's leaking data or they've had some kind of breach or you found a way to you know access somebody",
    "start": "242220",
    "end": "247980"
  },
  {
    "text": "else's account information by doing something on the site you would typically do a responsible disclosure so",
    "start": "247980",
    "end": "253620"
  },
  {
    "text": "you would reach out to the organization privately typically you know you would have to go through support or you know",
    "start": "253620",
    "end": "258720"
  },
  {
    "text": "some some non-security-based Channel and be like hey I found this thing on your site and you know I can steal data or I",
    "start": "258720",
    "end": "265800"
  },
  {
    "text": "can break something I can do something that I can't and you would tell them this privately and hopefully the",
    "start": "265800",
    "end": "271380"
  },
  {
    "text": "organization would take you seriously and they would say oh wow you know like thanks for telling me we're going to go and investigate this and we'll fix this",
    "start": "271380",
    "end": "277979"
  },
  {
    "text": "and this is a general process within the industry now I looked at this and I thought okay",
    "start": "277979",
    "end": "284280"
  },
  {
    "text": "great yeah the ico's website has a problem I'll get in contact with them I mean it was Sunday so the government's",
    "start": "284280",
    "end": "289620"
  },
  {
    "text": "closed so if that was the first problem that I had but the other problem was as I was going through the investigation",
    "start": "289620",
    "end": "295320"
  },
  {
    "text": "I kind of thought but contacting them and telling them if it's a third party dependency of theirs",
    "start": "295320",
    "end": "301020"
  },
  {
    "text": "isn't going to help them it's actually the third party that's had the breach they need to fix the thing so I took a",
    "start": "301020",
    "end": "307560"
  },
  {
    "text": "slightly different approach and I went public quite early on with this so this is not like a typical process but I sent",
    "start": "307560",
    "end": "313199"
  },
  {
    "text": "out this tweet you can see just a couple of hours later on that same Sunday morning and I was like wow yeah you know",
    "start": "313199",
    "end": "318360"
  },
  {
    "text": "like Ian has brought this to my attention I've verified this and confirmed this we are actually seeing",
    "start": "318360",
    "end": "323759"
  },
  {
    "text": "government websites running hostile JavaScript now at the time you know it's like it's not too bad if you think if",
    "start": "323759",
    "end": "330660"
  },
  {
    "text": "you were an attacker and you could put Javascript into a government website what would you do and I was like well I sure wouldn't be",
    "start": "330660",
    "end": "337500"
  },
  {
    "text": "minding cryptocurrency there's a lot of things that I could think of that I would do here so this was a slightly unusual process to go public so soon but",
    "start": "337500",
    "end": "345000"
  },
  {
    "text": "I felt like the more attention that we can bring to this the more quickly then the faster it will be resolved so",
    "start": "345000",
    "end": "352080"
  },
  {
    "text": "the typical process of doing this privacy of privately was not beneficial but I still continued my investigation",
    "start": "352080",
    "end": "358199"
  },
  {
    "text": "can we track down the actual point in the application like where is this actually coming from so I used a few",
    "start": "358199",
    "end": "364919"
  },
  {
    "text": "different tools and scanners online I checked the entire Ico website first of all to see how many pages could I find",
    "start": "364919",
    "end": "370440"
  },
  {
    "text": "with this and it was all of them every single page that I scanned had this cryptocurrency Miner on it and I also",
    "start": "370440",
    "end": "377220"
  },
  {
    "text": "used other independent tools to conduct scans from different locations so maybe you know somebody in a different country",
    "start": "377220",
    "end": "383160"
  },
  {
    "text": "would see something different than I see and I was like no again it doesn't matter where you look at this from",
    "start": "383160",
    "end": "388220"
  },
  {
    "text": "everybody's seeing every single page running the cryptocurrency miner and I",
    "start": "388220",
    "end": "394020"
  },
  {
    "text": "was like so this is pretty bad like this is a pretty deep compromise and finally after pulling all of their dependencies",
    "start": "394020",
    "end": "399539"
  },
  {
    "text": "apart I found the individual dependency that had been compromised and it was a",
    "start": "399539",
    "end": "405479"
  },
  {
    "text": "third-party JavaScript plugin that they were using for text to speech translation for visually impaired users",
    "start": "405479",
    "end": "411000"
  },
  {
    "text": "of the site so as a government site they obviously have a high accessibility demand and",
    "start": "411000",
    "end": "417419"
  },
  {
    "text": "they were meeting part of this with this particular product now even the company that provides this",
    "start": "417419",
    "end": "424440"
  },
  {
    "text": "Library even their site was of course using their own product so even their own site was also running the",
    "start": "424440",
    "end": "431699"
  },
  {
    "text": "cryptocurrency miner so if we pull the script up here that we",
    "start": "431699",
    "end": "437280"
  },
  {
    "text": "were looking at this is the URL that the script tag was loading from so this was the source attribute and at the time I",
    "start": "437280",
    "end": "442919"
  },
  {
    "text": "captured a copy of the script tag and it looked like this so the comment that we have there at the",
    "start": "442919",
    "end": "448319"
  },
  {
    "text": "top is the the legitimate comment from the organization that they had placed there and the few lines of JavaScript we",
    "start": "448319",
    "end": "454500"
  },
  {
    "text": "see at the bottom are actually the minified library like the legitimate genuine JavaScript and as soon as I",
    "start": "454500",
    "end": "460680"
  },
  {
    "text": "opened this particular dependency and took a look inside it I knew almost immediately with this kind of obfuscated",
    "start": "460680",
    "end": "467039"
  },
  {
    "text": "JavaScript in the middle I was like this is the point like this is where they got in so attackers had",
    "start": "467039",
    "end": "473280"
  },
  {
    "text": "managed to compromise the servers of this organization and they had managed to modify this file to inject this",
    "start": "473280",
    "end": "480000"
  },
  {
    "text": "hostile bit of JavaScript in the middle and as you can see it looks it looks malicious almost immediately like who",
    "start": "480000",
    "end": "485639"
  },
  {
    "text": "does anyone hear hex encode their JavaScript just you know for easy reading for fun yeah I've not yet come",
    "start": "485639",
    "end": "493500"
  },
  {
    "text": "across a legitimate use case for this so if you know one drop by later and tell me but basically as soon as you see a",
    "start": "493500",
    "end": "499500"
  },
  {
    "text": "third-party dependency that's doing this with their JavaScript I'm like yeah they don't want me to see what they're doing",
    "start": "499500",
    "end": "504720"
  },
  {
    "text": "so I took this and of course it's fairly simple to kind of hex the code the string and understand what is actually",
    "start": "504720",
    "end": "510479"
  },
  {
    "text": "going on and it's a relatively simple injection all they're doing is using",
    "start": "510479",
    "end": "515760"
  },
  {
    "text": "this first a couple of lines here they're injecting the actual coin Hive Library so they're not actually",
    "start": "515760",
    "end": "520800"
  },
  {
    "text": "injecting their minor code in the dependency they're just using it to bootstrap their other assets in and then",
    "start": "520800",
    "end": "526440"
  },
  {
    "text": "in the next window document.write we can see that they're essentially configuring The Miner so with these libraries you",
    "start": "526440",
    "end": "533700"
  },
  {
    "text": "know they're fully featured and you can do whatever you want and they're like okay so we're going to configure our Miner we're going to consume at most",
    "start": "533700",
    "end": "539820"
  },
  {
    "text": "sixty percent of the CPU on the client device that is running this and then just down towards the bottom you can see",
    "start": "539820",
    "end": "545339"
  },
  {
    "text": "where they are setting the key for their wallet where do we want all of our stolen crypto to be sent",
    "start": "545339",
    "end": "551160"
  },
  {
    "text": "now because this is loaded into the third-party dependency and the government site has a script tag loading",
    "start": "551160",
    "end": "556920"
  },
  {
    "text": "that dependency it will just load into the site and it will just run and it looks like this",
    "start": "556920",
    "end": "562680"
  },
  {
    "text": "this was the cause of the problem the one line on the Ico website that was",
    "start": "562680",
    "end": "568260"
  },
  {
    "text": "loading the dependency and causing this we refer to it as a supply chain attack so they haven't these attackers haven't",
    "start": "568260",
    "end": "574740"
  },
  {
    "text": "gone after the government they maybe thought you know maybe the government cyber security is pretty good maybe we can't breach their application maybe we",
    "start": "574740",
    "end": "581279"
  },
  {
    "text": "won't be able to find a way in to the government site but if we can go after this third party and let's say they have",
    "start": "581279",
    "end": "587100"
  },
  {
    "text": "like slightly less security then it might be easier to breach them and we still breach the government so of course",
    "start": "587100",
    "end": "592800"
  },
  {
    "text": "attackers are always going to go for the easiest way in they're kind of lazy like we all are if we have a task we will do",
    "start": "592800",
    "end": "598800"
  },
  {
    "text": "it the easiest way that we can and this was the problem now in terms of trying to then",
    "start": "598800",
    "end": "606120"
  },
  {
    "text": "understand this I was like well if they have the script tag on their site who else has that same script tag on their",
    "start": "606120",
    "end": "611700"
  },
  {
    "text": "site like now I know what I'm actually looking for I'm looking for any site that contains this particular script tag",
    "start": "611700",
    "end": "617700"
  },
  {
    "text": "and I would can very easily then go and crawl the web and look for sites that have the exact same script tag because",
    "start": "617700",
    "end": "623160"
  },
  {
    "text": "if they have the exact same script tag they have the exact same problem so we can see here all a whole selection of",
    "start": "623160",
    "end": "629640"
  },
  {
    "text": "American government sites including the US courts in the UK we had the student loan company that deals with all of our",
    "start": "629640",
    "end": "635220"
  },
  {
    "text": "loans for students so like huge amounts of money get handled and dealt with through this",
    "start": "635220",
    "end": "641100"
  },
  {
    "text": "site we have things like the General Medical Council where in the UK like you have doctors and nurses with all of that",
    "start": "641100",
    "end": "646680"
  },
  {
    "text": "information registered we then go on to take a look at the NHS our National Health Service where all of my medical",
    "start": "646680",
    "end": "653459"
  },
  {
    "text": "information is available if I log on through various portals now an attacker",
    "start": "653459",
    "end": "659279"
  },
  {
    "text": "within with the ability to inject script into any of these Pages potentially has",
    "start": "659279",
    "end": "664380"
  },
  {
    "text": "access to the data in those pages if I have my malicious script in that page and I'm maybe typing in some personal",
    "start": "664380",
    "end": "669839"
  },
  {
    "text": "data or reading some personal data then if I have access to this the attackers have access to this too",
    "start": "669839",
    "end": "676440"
  },
  {
    "text": "so this becomes even more serious now and I found thousands and thousands of",
    "start": "676440",
    "end": "682019"
  },
  {
    "text": "just government sites because that's what I was kind of focusing on at the time but I found a little over 5 000",
    "start": "682019",
    "end": "687360"
  },
  {
    "text": "individual government sites all around the world that were loading this script tag and for every single one of them",
    "start": "687360",
    "end": "692459"
  },
  {
    "text": "that I went to you can see here I have the console open in all of those screenshots and you can see the",
    "start": "692459",
    "end": "697800"
  },
  {
    "text": "configuration and then the initiation of the crypto Miner so they were all running it and this is the benefit for",
    "start": "697800",
    "end": "705120"
  },
  {
    "text": "the attackers Not only was that third party probably easier to compromise than the government site if you compromise",
    "start": "705120",
    "end": "711839"
  },
  {
    "text": "the third party dependency you get more than one target you get every Target using that dependency so now it makes",
    "start": "711839",
    "end": "718680"
  },
  {
    "text": "even more sense for the attackers to go after your dependencies and not necessarily go directly after you",
    "start": "718680",
    "end": "725519"
  },
  {
    "text": "now this was all historic from today this is in the past but if you are curious of just how many sites out there",
    "start": "725519",
    "end": "732360"
  },
  {
    "text": "are still trying to use a crypto Miner in the page you can actually take out your phone now",
    "start": "732360",
    "end": "738480"
  },
  {
    "text": "and visit this link and it will redirect you to a Google search so we have a process called Google Docs and it's a",
    "start": "738480",
    "end": "744420"
  },
  {
    "text": "it's kind of like a trick where you use Google to find websites that you can use for cyber attacks so if I wanted to find",
    "start": "744420",
    "end": "750420"
  },
  {
    "text": "websites that had particular problems I might search for certain error message strings and I'm like well if this page",
    "start": "750420",
    "end": "756120"
  },
  {
    "text": "has this error maybe I can go there and do something so you can use Google to find potential targets and that's the",
    "start": "756120",
    "end": "761940"
  },
  {
    "text": "process of Google Docs so this particular dock is finding websites and if you run this now it will obviously go",
    "start": "761940",
    "end": "768360"
  },
  {
    "text": "and do the query live it will find sites right now that have the initiation of a",
    "start": "768360",
    "end": "774720"
  },
  {
    "text": "coin Hive Miner on the page it is looking for the trigger that fires The Miner so any page on there",
    "start": "774720",
    "end": "781200"
  },
  {
    "text": "will be you know as it is right now configured to crypto mind when you visit it and this particular search that I've",
    "start": "781200",
    "end": "787620"
  },
  {
    "text": "got there is only looking for sites that contain dot gov so these are still government sites to this day you can run",
    "start": "787620",
    "end": "793560"
  },
  {
    "text": "the query now that are configured and prepared to run a cryptocurrency miner",
    "start": "793560",
    "end": "798600"
  },
  {
    "text": "in your browser when you visit them so it's a tad worrying that even though this is a story from Days Gone By you",
    "start": "798600",
    "end": "805620"
  },
  {
    "text": "can run that live right now and see that it's actually still happening but",
    "start": "805620",
    "end": "811079"
  },
  {
    "text": "we still need to solve the original problem right like the original problem was still there and I was tweeting about this I was trying to speak to the media",
    "start": "811079",
    "end": "817260"
  },
  {
    "text": "and I'm like how do we get this to end quickly now eventually we went past Sunday and into the week and then the",
    "start": "817260",
    "end": "823920"
  },
  {
    "text": "British government you know go to work and the national cyber security Center in the UK reached out to me now they're",
    "start": "823920",
    "end": "829620"
  },
  {
    "text": "a part of uh they're a part of gchq which is our spy",
    "start": "829620",
    "end": "835920"
  },
  {
    "text": "agency in the UK and they they reach out to me and they're",
    "start": "835920",
    "end": "841380"
  },
  {
    "text": "responsible for all of the cyber security of all of the British infrastructure government infrastructure you know they look after the country on",
    "start": "841380",
    "end": "847920"
  },
  {
    "text": "a cyber security level and they're like you know they reach out to me and they obviously want some more information and",
    "start": "847920",
    "end": "853920"
  },
  {
    "text": "I just love this and you know it's like hey Scott could I grab your email I'm like um you you're like they're like the",
    "start": "853920",
    "end": "861300"
  },
  {
    "text": "British version of the NSA I'm like I'm pretty sure you already have my email so I actually did respond and I did give",
    "start": "861300",
    "end": "867899"
  },
  {
    "text": "them my email I was like maybe this is a test and I've just failed but they were like look you know we're kind of",
    "start": "867899",
    "end": "873899"
  },
  {
    "text": "catching up with this we've seen what's happened you've obviously been looking at this and you know what information",
    "start": "873899",
    "end": "879660"
  },
  {
    "text": "can you give us like how can we solve this quickly because still remember this attacker still has ongoing ability",
    "start": "879660",
    "end": "886680"
  },
  {
    "text": "to inject their JavaScript into all of the British government sites and all of the other governments around the world",
    "start": "886680",
    "end": "892199"
  },
  {
    "text": "as well but the ncsc is interested in the British ones and we have to remember at this point",
    "start": "892199",
    "end": "897899"
  },
  {
    "text": "they're still injecting the coin Miner the crypto Miner but if they decide in",
    "start": "897899",
    "end": "903300"
  },
  {
    "text": "you know five minutes from now and they're like oh actually we want to change the JavaScript they've obviously still got access to that third-party",
    "start": "903300",
    "end": "908760"
  },
  {
    "text": "dependency they could go at any point and change the JavaScript to do something else something worse they",
    "start": "908760",
    "end": "913980"
  },
  {
    "text": "might steal data or or whatever it was so whilst it's not too bad right now",
    "start": "913980",
    "end": "919139"
  },
  {
    "text": "because there's no visual impact it doesn't appear like they're trying to steal data or download malware whatever",
    "start": "919139",
    "end": "924240"
  },
  {
    "text": "they might do there is an ongoing impact and the risk that this could get a lot worse remains now eventually I had some",
    "start": "924240",
    "end": "932279"
  },
  {
    "text": "extensive conversations with the ncsc and after this was all kind of cleared up they even invited me down to London",
    "start": "932279",
    "end": "938220"
  },
  {
    "text": "so I could go spend some time with them and the quickest way to get this resolved I said to them was we need to get hold of",
    "start": "938220",
    "end": "945420"
  },
  {
    "text": "the third party right like you know you can remove the script tag from the government site yes and then we will",
    "start": "945420",
    "end": "950820"
  },
  {
    "text": "stop loading it and they're like ah right okay but that's uh you know like we've got to do a change request and",
    "start": "950820",
    "end": "956459"
  },
  {
    "text": "then we have to review it and it has to be approved and you know then by the time we actually deploy this change to remove the tag they're like you know",
    "start": "956459",
    "end": "962820"
  },
  {
    "text": "sometimes gonna pass by and it's not going to be a matter of hours we have a fairly uh lengthy process here and I was",
    "start": "962820",
    "end": "969480"
  },
  {
    "text": "like you know okay the only way to do this is to just go out the third party try and get in touch with them and say please delete the file turn the server",
    "start": "969480",
    "end": "975480"
  },
  {
    "text": "off whatever you need to do but just make the file be gone because the problem that we have is",
    "start": "975480",
    "end": "981000"
  },
  {
    "text": "still that this script tag is in all those government sites and I'm like but can you not just rip this thing out like this should be really fast this should",
    "start": "981000",
    "end": "987300"
  },
  {
    "text": "be really really easy to do but this is the introduction of the risk therefore if we take it away it should solve the",
    "start": "987300",
    "end": "993899"
  },
  {
    "text": "problem and they're like yeah but you know we've already found like 400 and something different applications with this and by the time we try and find you",
    "start": "993899",
    "end": "1000560"
  },
  {
    "text": "know the application owners and the relevant teams and push the change through this could take us days or even weeks if we try to do this so we kept",
    "start": "1000560",
    "end": "1007880"
  },
  {
    "text": "leaning on the third party trying to contact them trying to go through you know like customer support they're like",
    "start": "1007880",
    "end": "1013459"
  },
  {
    "text": "hey how can we help you today I'm like well so we're calling from the government um we need you to go fix something for",
    "start": "1013459",
    "end": "1019579"
  },
  {
    "text": "us but this script is the problem like this is the actual issue itself and for me to",
    "start": "1019579",
    "end": "1026178"
  },
  {
    "text": "explain this I kind of think of one of these when I look at the script tag I look at this this is a check so for all",
    "start": "1026179",
    "end": "1034160"
  },
  {
    "text": "of you forward thinking countries like Norway and the rest of Scandinavia you probably have never seen one of these we're a bit old school in the UK and we",
    "start": "1034160",
    "end": "1040459"
  },
  {
    "text": "used to have these little bits of paper that you could write a promise to pay someone some money on and then they could go to the bank and cash the check",
    "start": "1040459",
    "end": "1046699"
  },
  {
    "text": "now normally you write the amount you write what you want to give them and then you put your signature on the check",
    "start": "1046699",
    "end": "1052340"
  },
  {
    "text": "just like this however the phrase a blank check usually means the freedom to do whatever you",
    "start": "1052340",
    "end": "1058340"
  },
  {
    "text": "want if I gave you a blank check and I had signed it you could go and be like Oh I'm gonna do you know like 100 000",
    "start": "1058340",
    "end": "1064760"
  },
  {
    "text": "krona all right you could write whatever amount you want on that to take I'm giving you the freedom to do anything that you want including you know take a",
    "start": "1064760",
    "end": "1072860"
  },
  {
    "text": "lot more than maybe you are entitled to and I would never ever give anybody a",
    "start": "1072860",
    "end": "1078140"
  },
  {
    "text": "blank check but now if we go back to this script tag I kind of look at this and I think",
    "start": "1078140",
    "end": "1084380"
  },
  {
    "text": "this is a blank check because what this is saying is you know I want you to go over here and load some stuff load some",
    "start": "1084380",
    "end": "1092179"
  },
  {
    "text": "JavaScript but we don't know what the JavaScript is and we don't know how much of the JavaScript there is but you're",
    "start": "1092179",
    "end": "1097340"
  },
  {
    "text": "going to go over here and you're going to get some of the javascripts and then you're going to bring them back and you're going to run them",
    "start": "1097340",
    "end": "1102380"
  },
  {
    "text": "there's there's no control over what it is or what it does or how much there is it's just you know go here find the",
    "start": "1102380",
    "end": "1109039"
  },
  {
    "text": "JavaScript run the javascripts and this to me became really kind of the point that stuck with me is",
    "start": "1109039",
    "end": "1114980"
  },
  {
    "text": "we are just blindly trusting The Source attribute there this third-party URL we",
    "start": "1114980",
    "end": "1120380"
  },
  {
    "text": "are just blindly trusting them and saying yeah you're good like whatever you want take whatever you want give us whatever you want just you know send",
    "start": "1120380",
    "end": "1126140"
  },
  {
    "text": "back some javascripts now this gathered really large interest at the time and one of the other things",
    "start": "1126140",
    "end": "1132260"
  },
  {
    "text": "that happened at the time was we did a bit of a TV program in the UK",
    "start": "1132260",
    "end": "1138020"
  },
  {
    "text": "now this is a really big news story and they were thinking like oh my gosh you know the government is hacked they like",
    "start": "1138020",
    "end": "1143840"
  },
  {
    "text": "to Jazz it up a little bit and they made this like really cool intro they're doing a voice over we",
    "start": "1143840",
    "end": "1149900"
  },
  {
    "text": "found like this abandoned warehouse one of the questions that they asked me was like okay you're saying",
    "start": "1149900",
    "end": "1156020"
  },
  {
    "text": "you know they're Mining cryptocurrency and it's not so bad right and they said like what could they do",
    "start": "1156020",
    "end": "1161720"
  },
  {
    "text": "this is one of the questions that kept coming back from the producers like what could they do you keep saying like this",
    "start": "1161720",
    "end": "1166880"
  },
  {
    "text": "could have been really bad show us and it's like okay I'll show you so I set up a demo where I could modify",
    "start": "1166880",
    "end": "1173960"
  },
  {
    "text": "the script I was using a proxy to change the Javascript file and this is me like super nervous on",
    "start": "1173960",
    "end": "1181520"
  },
  {
    "text": "camera uh for this program and they asked me to create a series of demos of like show us the kind of things that",
    "start": "1181520",
    "end": "1186980"
  },
  {
    "text": "they could do and there was only one demo that they could actually put on television and the demo that they could",
    "start": "1186980",
    "end": "1192200"
  },
  {
    "text": "put on television was I mocked up our kind of like gov ID you log in with the government to do stuff the Ico website",
    "start": "1192200",
    "end": "1198260"
  },
  {
    "text": "did not have the gov ID login because they don't have any services that we can use but if I mocked up the login because",
    "start": "1198260",
    "end": "1205220"
  },
  {
    "text": "I can I have JavaScript on the page I can do this I created a demo where it would mock up a login and if anybody",
    "start": "1205220",
    "end": "1211760"
  },
  {
    "text": "went to the site and used it it would skim the data out of the page and I could steal people's emails and",
    "start": "1211760",
    "end": "1217160"
  },
  {
    "text": "passwords for that gov ID logins now the other things that I did you'll see me",
    "start": "1217160",
    "end": "1222380"
  },
  {
    "text": "doing that in just a moment with the reporter the other things that I did because I was like okay you know I've got free reign you can put any JavaScript you",
    "start": "1222380",
    "end": "1228919"
  },
  {
    "text": "want into the government website one of the demos was you know understandably inappropriate and I could see why they",
    "start": "1228919",
    "end": "1235760"
  },
  {
    "text": "couldn't put it on TV we just put as soon as the page loaded the JavaScript one ran we just put full screen pornography on the site and I was like",
    "start": "1235760",
    "end": "1243500"
  },
  {
    "text": "well you know but why why can't you do this right if I've got the ability to inject arbitrary JavaScript the only",
    "start": "1243500",
    "end": "1249020"
  },
  {
    "text": "question now is how evil are you and what are you going to do so I put the full screen you know",
    "start": "1249020",
    "end": "1254840"
  },
  {
    "text": "pornography demo on and they load the page and they're like wow okay but you know that's great but we can't put that on the television like what else have",
    "start": "1254840",
    "end": "1260900"
  },
  {
    "text": "you got so so I went to the next one and I put like a big kind of like you know alert",
    "start": "1260900",
    "end": "1266539"
  },
  {
    "text": "Banner like red and yellow you know ticker tape and it said prime minister assassinated",
    "start": "1266539",
    "end": "1272720"
  },
  {
    "text": "and they're like okay great but we also can't put that on the TV because if somebody's walking past like the TV",
    "start": "1272720",
    "end": "1278000"
  },
  {
    "text": "store and they're like oh my gosh you know like the our prime minister's been assassinated that might be misinterpreted it's really really bad so",
    "start": "1278000",
    "end": "1285500"
  },
  {
    "text": "this is the the key logger one that I did so you can see we've just got JavaScript on the page mock up some username and password forms and of",
    "start": "1285500",
    "end": "1292580"
  },
  {
    "text": "course it's just you know ajaxing the data straight out the back any key press um I did a couple more one of them they",
    "start": "1292580",
    "end": "1299360"
  },
  {
    "text": "were a bit worried about on copyright ground so I did like um the Star Wars theme and I made the page scroll up into",
    "start": "1299360",
    "end": "1304400"
  },
  {
    "text": "the distance um and they're like no we can't do that either so they went with the data",
    "start": "1304400",
    "end": "1309620"
  },
  {
    "text": "stealing one uh which I was a bit disappointed at because I don't think it really",
    "start": "1309620",
    "end": "1315020"
  },
  {
    "text": "um kind of shows just how bad this could have been and just think about it for a moment if I gave you the ability to",
    "start": "1315020",
    "end": "1321260"
  },
  {
    "text": "inject any arbitrary JavaScript that you want into thousands of government sites",
    "start": "1321260",
    "end": "1327559"
  },
  {
    "text": "what would you do what do you just mine you know like fifty dollars worth of crypto a day",
    "start": "1327559",
    "end": "1334340"
  },
  {
    "text": "depends how many people are on the site I can see the attraction from the attacker's",
    "start": "1334340",
    "end": "1339740"
  },
  {
    "text": "perspective because it's like quick easy money we drop the coin Miner we man the currency and you know we just go on",
    "start": "1339740",
    "end": "1345320"
  },
  {
    "text": "vacation and the money arrives in the crypto wallet but I really felt like",
    "start": "1345320",
    "end": "1350480"
  },
  {
    "text": "given that they had the ability to inject almost any arbitrary JavaScript that they wanted I feel like they really",
    "start": "1350480",
    "end": "1357679"
  },
  {
    "text": "didn't exercise that capability very well and I think that's why the response and the remediation was so poor because",
    "start": "1357679",
    "end": "1364640"
  },
  {
    "text": "there wasn't like a big wow factor there wasn't an enormous data breach you know we didn't end up with inappropriate",
    "start": "1364640",
    "end": "1370760"
  },
  {
    "text": "videos on government websites I think any one of those things would have probably made much more of an impact in",
    "start": "1370760",
    "end": "1376820"
  },
  {
    "text": "terms of the headlines and then the response but the attackers were just looking for a way to quietly make some",
    "start": "1376820",
    "end": "1381980"
  },
  {
    "text": "money what they probably wanted to do was sit in the background and not be noticed or detected for days or weeks or",
    "start": "1381980",
    "end": "1389539"
  },
  {
    "text": "months and then they could really start to rake in some of their Monero which was the coin that they were mining at",
    "start": "1389539",
    "end": "1394700"
  },
  {
    "text": "the time now because we found this so quickly Ian found this and I brought some attention to it",
    "start": "1394700",
    "end": "1400880"
  },
  {
    "text": "they actually only manage if we go look at the the transactions that they made they only managed to make about 41",
    "start": "1400880",
    "end": "1406780"
  },
  {
    "text": "because it turns out the day before Ian noticed this was the day the attack",
    "start": "1406780",
    "end": "1413000"
  },
  {
    "text": "started so we went back through the archives and we looked at the history of the file the internet archive the way back machine is so cool for this if",
    "start": "1413000",
    "end": "1419299"
  },
  {
    "text": "you've never used it you can just go on the web and go back through time and it's like okay cool let's go back in",
    "start": "1419299",
    "end": "1424700"
  },
  {
    "text": "time and see when did the oh yesterday I guess so we literally caught this within its first 24 hours of having been",
    "start": "1424700",
    "end": "1431059"
  },
  {
    "text": "changed so you know maybe they would have run the crypto Miner and thought we're not making enough money let's do",
    "start": "1431059",
    "end": "1436820"
  },
  {
    "text": "something more right like you know the Prime Minister assassinated thing it's like let's go short the ftse 100 you",
    "start": "1436820",
    "end": "1443000"
  },
  {
    "text": "know tell everyone in the UK that their prime minister is gone and you know reap the rewards but",
    "start": "1443000",
    "end": "1448940"
  },
  {
    "text": "coming back to the conversation we're having at the government they were like okay you know we finally got in touch with the vendor the vendor dropped the",
    "start": "1448940",
    "end": "1455000"
  },
  {
    "text": "file so it was 404 in for a period there they fixed up the issue with their server with their services and the file",
    "start": "1455000",
    "end": "1462200"
  },
  {
    "text": "eventually comes back in its original state turns out they were storing it in an S3 bucket without appropriate",
    "start": "1462200",
    "end": "1467539"
  },
  {
    "text": "credentials on there so we never actually found out if they were weak credentials that were guessed or whether they got fished or whatever it was but",
    "start": "1467539",
    "end": "1474080"
  },
  {
    "text": "it was poor credentials on an S3 bucket hosting this file now after this is resolved we have to do",
    "start": "1474080",
    "end": "1481159"
  },
  {
    "text": "the kind of response from the government from all of these organizations what are we going to tell people like how do we",
    "start": "1481159",
    "end": "1487760"
  },
  {
    "text": "explain this and part of that as well is how do we give the assurance that we've you know suitably resolved this so it",
    "start": "1487760",
    "end": "1493700"
  },
  {
    "text": "won't happen again because they're like it's bad enough it happened the first time we really can't let this happen again",
    "start": "1493700",
    "end": "1499520"
  },
  {
    "text": "and it's like well how do you resolve this what is the solution to this",
    "start": "1499520",
    "end": "1504740"
  },
  {
    "text": "problem now the first solution to the problem is something called sub resource Integrity or SRI as we call it and with",
    "start": "1504740",
    "end": "1513200"
  },
  {
    "text": "SRI all you do is you take that original script tag that you had and you just give the browser a little bit more",
    "start": "1513200",
    "end": "1520280"
  },
  {
    "text": "information and as you can see here now we've added an Integrity attribute onto the script",
    "start": "1520280",
    "end": "1525620"
  },
  {
    "text": "tag and inside the Integrity attribute is a char-256 hash value",
    "start": "1525620",
    "end": "1530720"
  },
  {
    "text": "so what this is telling the browser is kind of like before I want you to go to this URL I want you",
    "start": "1530720",
    "end": "1536360"
  },
  {
    "text": "to fetch all of the javascripts that are there but now when you download the JavaScript I want you to Hash it and I",
    "start": "1536360",
    "end": "1543200"
  },
  {
    "text": "want you to compare the hash of the JavaScript that you download to the hash that I have provided here",
    "start": "1543200",
    "end": "1549080"
  },
  {
    "text": "so now we can Integrity check that file every single time the browser goes to that file and downloads it we can check",
    "start": "1549080",
    "end": "1555140"
  },
  {
    "text": "that it is the file that we were expecting so now in the same attack scenario the attacker would break into",
    "start": "1555140",
    "end": "1561080"
  },
  {
    "text": "this server off browse allowed they would change that ba.js file",
    "start": "1561080",
    "end": "1566179"
  },
  {
    "text": "they would make their alterations and that would change the hash of the file so the next time the very first time the",
    "start": "1566179",
    "end": "1572299"
  },
  {
    "text": "browser downloads that different file the browser can look at it and say well this doesn't match it's changed",
    "start": "1572299",
    "end": "1578120"
  },
  {
    "text": "now to be clear we can't say how it changed so we can't say what changed but the browser can say this is not the",
    "start": "1578120",
    "end": "1584659"
  },
  {
    "text": "JavaScript I was expecting I got something different and that means I am not going to run it",
    "start": "1584659",
    "end": "1591380"
  },
  {
    "text": "now you will lose the functionality of that file so in this case it's a text-to-speech plugin so because the",
    "start": "1591380",
    "end": "1597200"
  },
  {
    "text": "browser is going to refuse to load it you will lose you know the functionality of whatever is provided here however",
    "start": "1597200",
    "end": "1603440"
  },
  {
    "text": "versus the you know the risk of like we might end up with malware or inappropriate videos or a data breach or",
    "start": "1603440",
    "end": "1608960"
  },
  {
    "text": "something like that it's a pretty reasonable kind of position to take right like you are going to lose the file but it is going to stop something",
    "start": "1608960",
    "end": "1615020"
  },
  {
    "text": "much more serious so this seems like the obvious solution right we're like oh you know I'm speaking to the the ncsc and it's like",
    "start": "1615020",
    "end": "1622279"
  },
  {
    "text": "how do we how do we avoid this like how do we stop it and I'm like we already have the solution to this SRI has been standardized on the web for years and it",
    "start": "1622279",
    "end": "1629360"
  },
  {
    "text": "was standardized years prior to when this happened I was like hey you know we already thought about this it already happened we already have the solution",
    "start": "1629360",
    "end": "1635720"
  },
  {
    "text": "it's widely supported by all of the mainstream browsers and you can take any script tag that you have and simply add",
    "start": "1635720",
    "end": "1641720"
  },
  {
    "text": "the Integrity attribute if you want to protect yourself from your third-party dependencies because I'm sure you know",
    "start": "1641720",
    "end": "1647900"
  },
  {
    "text": "probably most of us is anybody here going to tell me you don't load third-party JavaScript is anyone brave enough right like we all pretty much",
    "start": "1647900",
    "end": "1654260"
  },
  {
    "text": "load some third-party JavaScript there are you know some people that can get away without doing it but as a general rule I think if you look at most sites",
    "start": "1654260",
    "end": "1660919"
  },
  {
    "text": "we do load it SRI is a solution you can still load it from the third party maybe",
    "start": "1660919",
    "end": "1665960"
  },
  {
    "text": "you're loading it from a CDN provider they provide the hosting and the bandwidth and everything else there are benefits to doing this so as",
    "start": "1665960",
    "end": "1673220"
  },
  {
    "text": "security people I don't want to come in and be like hey you can't host you know you can't use any third-party JavaScript host it all yourself you know there are",
    "start": "1673220",
    "end": "1679520"
  },
  {
    "text": "reasons that we do this and we recognize that SRI is a solution you can still trust that third party to load",
    "start": "1679520",
    "end": "1685580"
  },
  {
    "text": "JavaScript in your page but now we're going to verify trust but verify",
    "start": "1685580",
    "end": "1691100"
  },
  {
    "text": "but there was one more problem with the browse allowed story and it came from the file itself so if we look at this",
    "start": "1691100",
    "end": "1698539"
  },
  {
    "text": "file the the file that I captured that I showed earlier as I said the comment at the top was the original file the",
    "start": "1698539",
    "end": "1704539"
  },
  {
    "text": "minified JavaScript at the bottom was the original file now if we just kind of zoom in and take",
    "start": "1704539",
    "end": "1709640"
  },
  {
    "text": "a look at the comment up at the top here they had this comment they said warning do not copy or self-host this file you",
    "start": "1709640",
    "end": "1716659"
  },
  {
    "text": "will not be supported and then in the file they have the version number and presumably the date",
    "start": "1716659",
    "end": "1722120"
  },
  {
    "text": "that it was published so this presents a bit of a problem because now if we bear this in mind the",
    "start": "1722120",
    "end": "1729200"
  },
  {
    "text": "version number is in there if we go back and take a look at the URL I've changed the file name to essentially represent",
    "start": "1729200",
    "end": "1736220"
  },
  {
    "text": "what they're doing here what they're kind of saying is forward slash latest dot JS like latest version that file is",
    "start": "1736220",
    "end": "1744200"
  },
  {
    "text": "not a particular version of you know whatever the software is they're saying",
    "start": "1744200",
    "end": "1749360"
  },
  {
    "text": "you know you can check the path there's no versioning check the file name there's no versioning what they're saying is you come here and you get",
    "start": "1749360",
    "end": "1755720"
  },
  {
    "text": "whatever the latest file is right bar you know CDN caching or browser caching essentially as soon as the file changes",
    "start": "1755720",
    "end": "1761840"
  },
  {
    "text": "you get the new version and this represents a problem especially for something like SRI because SRI is",
    "start": "1761840",
    "end": "1768080"
  },
  {
    "text": "trying to pin you against a known hash of a known file but if this file can",
    "start": "1768080",
    "end": "1773419"
  },
  {
    "text": "just change in the future then we can't predict that change we don't know what it will be so SRI would",
    "start": "1773419",
    "end": "1779539"
  },
  {
    "text": "break in this scenario now there's some really good back and forth between the government and the",
    "start": "1779539",
    "end": "1784760"
  },
  {
    "text": "vendor on this one and the vendor's position was basically this and they're like hey don't worry",
    "start": "1784760",
    "end": "1789919"
  },
  {
    "text": "about it look like you go here you get the latest version right if we patch a bug you get the new version if we fix a",
    "start": "1789919",
    "end": "1796880"
  },
  {
    "text": "security issue you get the new version if we add a new feature as soon as we deploy it to that file you barring the",
    "start": "1796880",
    "end": "1804440"
  },
  {
    "text": "cache you get it straight away I'm like okay I can you know like I can",
    "start": "1804440",
    "end": "1809779"
  },
  {
    "text": "kind of get on board with this I see I see where they're going with this and they are correct one of the other vendors kind of",
    "start": "1809779",
    "end": "1816260"
  },
  {
    "text": "concerns was if we deprecate a feature we don't need to do you know kind of deprecation schedules we just change the",
    "start": "1816260",
    "end": "1823159"
  },
  {
    "text": "library bam the feature is gone and we can tear away anything related to that old feature so it's very convenient for",
    "start": "1823159",
    "end": "1829340"
  },
  {
    "text": "them now the government people we're kind of like okay yeah like I see you know like we see the benefit to this",
    "start": "1829340",
    "end": "1835700"
  },
  {
    "text": "if there's a new version and we need to update we'd have to do some kind of like change requests and you know we'd like change the version number in the script",
    "start": "1835700",
    "end": "1841640"
  },
  {
    "text": "tag and all of this process but if we do it this way the way that we do now they're like we",
    "start": "1841640",
    "end": "1846799"
  },
  {
    "text": "don't have that process we don't have that burden so this sounds quite good and I was like okay I can acknowledge",
    "start": "1846799",
    "end": "1852080"
  },
  {
    "text": "that and and to some extent I can agree with that but I'm going to say exactly the same thing",
    "start": "1852080",
    "end": "1857779"
  },
  {
    "text": "with slightly different words you have a third party that can deploy",
    "start": "1857779",
    "end": "1863240"
  },
  {
    "text": "arbitrary code changes into your production site with no prior warning testing approval or anything right it's",
    "start": "1863240",
    "end": "1870679"
  },
  {
    "text": "just like bam change the file straight into the site and then they were like",
    "start": "1870679",
    "end": "1876140"
  },
  {
    "text": "yeah that kind of sounds like actually what's happening because it is what's happening if they change that file",
    "start": "1876140",
    "end": "1883580"
  },
  {
    "text": "the file that you're loading just changes and I was like just a moment ago we were talking about how it was going to take the government days or even",
    "start": "1883580",
    "end": "1889520"
  },
  {
    "text": "weeks to approve a change and push the change to and I'm like but this arbitrary third-party vendor can just you know put that straight into the",
    "start": "1889520",
    "end": "1896720"
  },
  {
    "text": "production site it seems like there's a bit of an imbalance here and the problem is that is what brings us to the attack",
    "start": "1896720",
    "end": "1901760"
  },
  {
    "text": "if we look at this the other way around all I've changed here is the attribution for under the comment the attacker can",
    "start": "1901760",
    "end": "1909740"
  },
  {
    "text": "patch the JavaScript for you anytime no problem so the vendor's like yeah we can patch a JavaScript no time any problem",
    "start": "1909740",
    "end": "1915320"
  },
  {
    "text": "I'm like right but the attacker gets to say the same thing if this is what we do if this is how we do it the attacker",
    "start": "1915320",
    "end": "1920779"
  },
  {
    "text": "gets to say the same thing so inevitably we kind of came to the point where you",
    "start": "1920779",
    "end": "1927559"
  },
  {
    "text": "know the government put the vendor in the position and they were like unless you give us a version path that we can lock to with SRI then we're going to",
    "start": "1927559",
    "end": "1934100"
  },
  {
    "text": "have to drop the tool because we can't in good conditions go forwards you know",
    "start": "1934100",
    "end": "1939320"
  },
  {
    "text": "if this happens again and people say why did you not resolve this like why did you not put a strategy",
    "start": "1939320",
    "end": "1944720"
  },
  {
    "text": "in place to stop the same thing from happening again and inevitably they had no choice the vendor had to kind of cave",
    "start": "1944720",
    "end": "1950539"
  },
  {
    "text": "on this and say right it will give you a version path so that you can use SRI and",
    "start": "1950539",
    "end": "1955760"
  },
  {
    "text": "you can lock to that particular version so that should the same thing happen again you will know that the Javascript file",
    "start": "1955760",
    "end": "1961580"
  },
  {
    "text": "will not load if it is compromised but there are still some scenarios there are still some cases where you know let's",
    "start": "1961580",
    "end": "1967580"
  },
  {
    "text": "say the vendor didn't offer a version path or the vendor can't offer a version path or a version file name",
    "start": "1967580",
    "end": "1973820"
  },
  {
    "text": "we do still have other strategies and other mechanisms that we can use like content security policy",
    "start": "1973820",
    "end": "1980360"
  },
  {
    "text": "so consent security policy I view is kind of like a second line of defense and in security we like to practice",
    "start": "1980360",
    "end": "1985760"
  },
  {
    "text": "something called defense in depth which is where you have more than one thing to save you from a problem so if one thing",
    "start": "1985760",
    "end": "1991880"
  },
  {
    "text": "lets you down you still have something to act as a second line of defense and I see content security policy as a really",
    "start": "1991880",
    "end": "1997760"
  },
  {
    "text": "nice fixture in that defense mechanism now for those unfamiliar content",
    "start": "1997760",
    "end": "2002860"
  },
  {
    "text": "security policy is a HTTP response header and it is something that you can use to control a security protect",
    "start": "2002860",
    "end": "2010179"
  },
  {
    "text": "protection built into the browser so there's no code or agent to deploy or",
    "start": "2010179",
    "end": "2015519"
  },
  {
    "text": "anything like that here you simply say I'm going to issue this header and inside this header here you can see I've",
    "start": "2015519",
    "end": "2021220"
  },
  {
    "text": "written a very basic policy so this is a security policy that you're asking the browser to enforce on your page",
    "start": "2021220",
    "end": "2029140"
  },
  {
    "text": "so if we take a look at a slightly more expanded header here you can see I've declared a Content",
    "start": "2029140",
    "end": "2034360"
  },
  {
    "text": "security policy and I will return that response header with the page to the client and I'm like okay I'm pretty",
    "start": "2034360",
    "end": "2039519"
  },
  {
    "text": "relaxed by default I trust myself so default Source means you know by default I'm going to load things from my own",
    "start": "2039519",
    "end": "2045640"
  },
  {
    "text": "domain I'm going to load images or scripts or stats like this is where things can be loaded from but like I",
    "start": "2045640",
    "end": "2051280"
  },
  {
    "text": "said you might load things from a third party so with the script Source here we've got a little bit more specific and said right we're going to load script",
    "start": "2051280",
    "end": "2057158"
  },
  {
    "text": "from myself yes but we're also going to load script from this third party now the connect Source controls where",
    "start": "2057159",
    "end": "2063820"
  },
  {
    "text": "can we do things like fetch calls too it's like okay well again they're going to come back to me and maybe we need to",
    "start": "2063820",
    "end": "2069158"
  },
  {
    "text": "do some translation and we will speak back to the the parent service or browse loud as well",
    "start": "2069159",
    "end": "2074618"
  },
  {
    "text": "so now with this policy defined we are telling the browser what should happen on our page and we have our",
    "start": "2074619",
    "end": "2080740"
  },
  {
    "text": "second ability to stop this particular attack here because this attack if we recall back on the script tag just a few",
    "start": "2080740",
    "end": "2087099"
  },
  {
    "text": "slides ago they were using it as a bootstrap to load their own additional assets they were adding their own script",
    "start": "2087099",
    "end": "2093760"
  },
  {
    "text": "files into the page and then inevitably even if the co-miner is running they're still going to have to do some external",
    "start": "2093760",
    "end": "2100900"
  },
  {
    "text": "Communications so we now have another two opportunities here to stop this from happening we know what the script",
    "start": "2100900",
    "end": "2107440"
  },
  {
    "text": "dependencies are supposed to be on our site and if the page tries to load additional script dependencies that fall",
    "start": "2107440",
    "end": "2113260"
  },
  {
    "text": "outside of that allowed list the browser will simply block them they will not be loaded and that is native browser",
    "start": "2113260",
    "end": "2120160"
  },
  {
    "text": "functionality that you can hook into now if you want some feedback from the",
    "start": "2120160",
    "end": "2125560"
  },
  {
    "text": "browser because remember this is a policy on the page it's sent to the browser everything that I just explained is happening client side in the browser",
    "start": "2125560",
    "end": "2131740"
  },
  {
    "text": "so we wouldn't actually know that that was happening until you enable the reporting mechanism so in that scenario",
    "start": "2131740",
    "end": "2137800"
  },
  {
    "text": "you can say to the browser look here's my security policy I want you to block the current Hive JavaScript and after",
    "start": "2137800",
    "end": "2143920"
  },
  {
    "text": "you've blocked it I want you to call back and say hey Scott you're running the coin Hive JavaScript on this page",
    "start": "2143920",
    "end": "2149320"
  },
  {
    "text": "but I blocked it for you and the browser will actually send that information back to me now this is super",
    "start": "2149320",
    "end": "2155320"
  },
  {
    "text": "powerful because really like the actual solution to the problem is for me to go look why do I have the coin Hive JavaScript on my page so I actually need",
    "start": "2155320",
    "end": "2162400"
  },
  {
    "text": "to know that the problem exists to then go remediate the underlying cause so this is a great kind of interim measure",
    "start": "2162400",
    "end": "2168820"
  },
  {
    "text": "right they will block it in the browser in between you becoming aware of it and you actually resolving it please don't",
    "start": "2168820",
    "end": "2174579"
  },
  {
    "text": "view this as the final solution I don't think that it should be viewed that way now if you're worried about the",
    "start": "2174579",
    "end": "2181599"
  },
  {
    "text": "potential negative impacts on your site let's say you make a slight misconfiguration in this policy or you don't allow a dependency that you",
    "start": "2181599",
    "end": "2187900"
  },
  {
    "text": "actually need there is a safe way to test this with a slightly different header you just add content security",
    "start": "2187900",
    "end": "2193060"
  },
  {
    "text": "policy report only on the header and it kind of does what the name implies you're saying to the browser look don't",
    "start": "2193060",
    "end": "2199000"
  },
  {
    "text": "block anything but if you would block something would you just send me a report and tell me and this is a really",
    "start": "2199000",
    "end": "2204460"
  },
  {
    "text": "safe way of testing the policy so if these reports come through and you're like oh yeah we have this dependency we",
    "start": "2204460",
    "end": "2210460"
  },
  {
    "text": "forgot to allow it we'll add it to the list and we'll go through the process again so there is a perfectly safe way",
    "start": "2210460",
    "end": "2215500"
  },
  {
    "text": "of doing this and in either of those scenarios the report that you will get will look like this",
    "start": "2215500",
    "end": "2221079"
  },
  {
    "text": "so if the Ico or any of those other government departments actually had this particular",
    "start": "2221079",
    "end": "2226480"
  },
  {
    "text": "content security policy enabled they would receive a Json payload like this as a post request from the browser so",
    "start": "2226480",
    "end": "2233560"
  },
  {
    "text": "the browser would load the page it would observe the coin hype JavaScript it would block it and then it would send this",
    "start": "2233560",
    "end": "2239380"
  },
  {
    "text": "now the CSP reports are really easy to ingest and when you get a CSP report that looks like this",
    "start": "2239380",
    "end": "2245619"
  },
  {
    "text": "you should be jumping into action almost immediately this would be very very concerning to receive we were on your",
    "start": "2245619",
    "end": "2252099"
  },
  {
    "text": "home page we have blocked something loading from coinhive.com and the effective directive that was being",
    "start": "2252099",
    "end": "2257200"
  },
  {
    "text": "enforced was the script source so this thing that we see was in the script Source attribute",
    "start": "2257200",
    "end": "2262839"
  },
  {
    "text": "so at this point you are you know if you have Pages you're texting people maybe",
    "start": "2262839",
    "end": "2267880"
  },
  {
    "text": "you're jumping on slack and firing some notifications but you need to go figure out how this JavaScript got there and how do we stop it",
    "start": "2267880",
    "end": "2274540"
  },
  {
    "text": "so for all of these kinds of problems the JavaScript will also have to",
    "start": "2274540",
    "end": "2280300"
  },
  {
    "text": "communicate externally so if somehow the script does get in the page if we think about this scenario what if the attacker",
    "start": "2280300",
    "end": "2286540"
  },
  {
    "text": "had injected the coin Hive minor code into the browser loud JavaScript instead of bootstrapping it and loading it in",
    "start": "2286540",
    "end": "2292540"
  },
  {
    "text": "from another domain what if they just injected like the whole library in there browserloud.com was allowed in the",
    "start": "2292540",
    "end": "2298960"
  },
  {
    "text": "policy so you would load JavaScript from them and they would simply put their entire payload in the browser JavaScript",
    "start": "2298960",
    "end": "2305800"
  },
  {
    "text": "but the JavaScript would still have to communicate externally from the page and then you would receive a connect Source",
    "start": "2305800",
    "end": "2311800"
  },
  {
    "text": "violation like this so now yes the malicious JavaScript has loaded and it is run but if it's skimming data from",
    "start": "2311800",
    "end": "2318040"
  },
  {
    "text": "the page it could no longer skim it if it's Mining cryptocurrency and sending it somewhere it can no longer send it so",
    "start": "2318040",
    "end": "2324040"
  },
  {
    "text": "if it's a data breach or they're trying to make money if they're stealing customer data from within the page you can stop it from being sent",
    "start": "2324040",
    "end": "2330820"
  },
  {
    "text": "so you can seriously reduce the effectiveness of this attack",
    "start": "2330820",
    "end": "2335980"
  },
  {
    "text": "now whilst coin Hive has now shut down if you actually go to coinhive.com I won't spoil the surprise for you and",
    "start": "2335980",
    "end": "2342339"
  },
  {
    "text": "it's safe okay you can go to coinhab.com in the browser now they're not actually running their crypto mining Library as a",
    "start": "2342339",
    "end": "2349300"
  },
  {
    "text": "service anymore and the attackers have moved on to more profitable things because ultimately they're just here to",
    "start": "2349300",
    "end": "2355180"
  },
  {
    "text": "make money and the one thing that we're now seeing if you can inject JavaScript",
    "start": "2355180",
    "end": "2360460"
  },
  {
    "text": "into sites is they're becoming very effective at stealing data from the page now the most common thing that they're",
    "start": "2360460",
    "end": "2366940"
  },
  {
    "text": "targeting these days is actually just going straight after the money if you have a payment form on your site",
    "start": "2366940",
    "end": "2372220"
  },
  {
    "text": "somewhere users are going to be inevitably typing in card data and there's a group of attackers out there",
    "start": "2372220",
    "end": "2378400"
  },
  {
    "text": "we really don't know who they are but they're super effective at this and we refer to them as Mage carts they started",
    "start": "2378400",
    "end": "2383560"
  },
  {
    "text": "on like Magento checkout cart back in the day and and it kind of got abbreviated and we now use it to refer",
    "start": "2383560",
    "end": "2388900"
  },
  {
    "text": "to their Collective and they focus on just getting there a couple of lines of JavaScript into the",
    "start": "2388900",
    "end": "2394420"
  },
  {
    "text": "page and it listens to key presses and all they're listening for is that one time you're on a payment page and",
    "start": "2394420",
    "end": "2400300"
  },
  {
    "text": "you start typing in that 16 digit long card number and they skim that data off the page now they don't interfere with",
    "start": "2400300",
    "end": "2406780"
  },
  {
    "text": "the actual form they don't interfere with the submission if you go to an e-commerce site and you buy something",
    "start": "2406780",
    "end": "2411880"
  },
  {
    "text": "you know you will type in your card data you'll submit the form you'll pay for the thing and then the thing will arrive",
    "start": "2411880",
    "end": "2416980"
  },
  {
    "text": "and you're like cool that'll you know that'll work great nothing went wrong but the problem is the attackers will",
    "start": "2416980",
    "end": "2422200"
  },
  {
    "text": "have taken a copy of your car data silently and quietly in the background and they will do this again just like the coin Hive minder before they'll do",
    "start": "2422200",
    "end": "2428859"
  },
  {
    "text": "this quietly discreetly and they'll try to go undetected for as long as they can and inevitably at some point in the",
    "start": "2428859",
    "end": "2434320"
  },
  {
    "text": "future you'll wind up with like a you know 500 fraudulent card transaction",
    "start": "2434320",
    "end": "2440079"
  },
  {
    "text": "so whilst the focus has kind of shift from mining cryptocurrency into just",
    "start": "2440079",
    "end": "2445839"
  },
  {
    "text": "straight up stealing your car data if you don't have an e-commerce component they'll go after the user's credentials",
    "start": "2445839",
    "end": "2451119"
  },
  {
    "text": "you're going to have some kind of registration login if the user provides an email and a password they skim those",
    "start": "2451119",
    "end": "2456400"
  },
  {
    "text": "off and they'll simply take those credentials and go try and log into Financial Services to then get access to",
    "start": "2456400",
    "end": "2461560"
  },
  {
    "text": "the money so it's always about money they're always trying to look how do we make some profit from this maybe that's why",
    "start": "2461560",
    "end": "2467500"
  },
  {
    "text": "they didn't do you know full screen inappropriate videos on the government websites because you can't really make any money from that but with a coin Hive",
    "start": "2467500",
    "end": "2473980"
  },
  {
    "text": "Miner they saw the opportunity we could drop this on there maybe we make you know fifty dollars a day but if it stays",
    "start": "2473980",
    "end": "2480400"
  },
  {
    "text": "there for six months I'm happy with this now unfortunately magecar is becoming",
    "start": "2480400",
    "end": "2487480"
  },
  {
    "text": "more and more of a problem coin Hive and the other crypto jacking libraries they really hit their Peak through like",
    "start": "2487480",
    "end": "2492839"
  },
  {
    "text": "2018-19 and that was when they were at their absolute Peak they have since started to tail off as the magecar",
    "start": "2492839",
    "end": "2500020"
  },
  {
    "text": "attacks have ramped up so if we look at this the few brief attacks here the most notable one on there British Airways was",
    "start": "2500020",
    "end": "2506740"
  },
  {
    "text": "fined tens of millions of pounds by the British government for losing people's name address and card data because that",
    "start": "2506740",
    "end": "2512859"
  },
  {
    "text": "is pii and Ticketmaster again another huge organization they had three lines of",
    "start": "2512859",
    "end": "2518500"
  },
  {
    "text": "JavaScript injected into their site and that is enough to steal the name the address the card data as it's typed into",
    "start": "2518500",
    "end": "2525280"
  },
  {
    "text": "the payment form again they will find millions and millions by the British regulator alone for all the British",
    "start": "2525280",
    "end": "2531400"
  },
  {
    "text": "people's day-to-day lost they were also found by other Regulators around the world for the countries of the",
    "start": "2531400",
    "end": "2536440"
  },
  {
    "text": "appropriate people of whose data they lost so nowadays magecar has become the more",
    "start": "2536440",
    "end": "2542079"
  },
  {
    "text": "prominent threat out of the two but all of these attacks follow the same pattern all these attackers want to do",
    "start": "2542079",
    "end": "2548440"
  },
  {
    "text": "the same thing if they're going to try and breach your organization or your service maybe they can't maybe you have good security you",
    "start": "2548440",
    "end": "2555220"
  },
  {
    "text": "have some good processes in place so they'll turn to your third party dependencies and now most of the time",
    "start": "2555220",
    "end": "2560320"
  },
  {
    "text": "what we see is they won't even actually come after you in the first place because what they've realized is the",
    "start": "2560320",
    "end": "2565420"
  },
  {
    "text": "value that I mentioned earlier if we compromise the third party dependency and thousands of websites use it our",
    "start": "2565420",
    "end": "2571420"
  },
  {
    "text": "reward is much higher so perhaps you're the target perhaps you're not if it's your third party",
    "start": "2571420",
    "end": "2577420"
  },
  {
    "text": "dependency there's not much that we can do to defend ourselves against that attack because we're not the victim of",
    "start": "2577420",
    "end": "2582880"
  },
  {
    "text": "the attack so we have to move further down the injection point they're going to try and get their hostile JavaScript into",
    "start": "2582880",
    "end": "2589359"
  },
  {
    "text": "your site via your third-party dependency so we can stop that injection with something like SRI once our",
    "start": "2589359",
    "end": "2596560"
  },
  {
    "text": "visitors once our valued customers start loading their third-party JavaScript we can ask their browser to detect that and",
    "start": "2596560",
    "end": "2602980"
  },
  {
    "text": "then to block it using sub resource integrity and the final step if we can't do that is we can try and stop the",
    "start": "2602980",
    "end": "2609520"
  },
  {
    "text": "exfiltration of the data be that our customers you know email them password might be their address you know if",
    "start": "2609520",
    "end": "2616359"
  },
  {
    "text": "you're the tax Authority you're accepting tax data if you're the health authority you're accepting health data whatever it is the final kind of option",
    "start": "2616359",
    "end": "2624819"
  },
  {
    "text": "that we have to mitigate this is to stop the exfiltration of that data so yes you will have hostile scripts in your page",
    "start": "2624819",
    "end": "2631060"
  },
  {
    "text": "and yes it will be running but at least we can say look you know what like this is really not good but they don't have",
    "start": "2631060",
    "end": "2636819"
  },
  {
    "text": "all of your personal data we've managed to stop it at this final hurdle",
    "start": "2636819",
    "end": "2642040"
  },
  {
    "text": "so that was the story of how this attack unfolded how the remediation was quite",
    "start": "2642040",
    "end": "2647319"
  },
  {
    "text": "poor at the time and how unfortunately not much has changed so I want to wrap",
    "start": "2647319",
    "end": "2652480"
  },
  {
    "text": "it up there and I have left intentionally quite some time here for questions and I do welcome them I know",
    "start": "2652480",
    "end": "2657940"
  },
  {
    "text": "we're in Norway but I know you're all here but I do welcome questions from the audience at this point if we could also",
    "start": "2657940",
    "end": "2663819"
  },
  {
    "text": "bring the house lights up so I can see everyone I actually can't see anything right now that would be great but if",
    "start": "2663819",
    "end": "2669640"
  },
  {
    "text": "there are any questions let's just go ahead and Shout them out and then we'll maybe start adding some order to this",
    "start": "2669640",
    "end": "2675220"
  },
  {
    "text": "somebody out there has to be the brave person that goes first if you're there just shout I actually",
    "start": "2675220",
    "end": "2681400"
  },
  {
    "text": "can't see",
    "start": "2681400",
    "end": "2683940"
  },
  {
    "text": "very good question so did we contact any of the other non-uk governments and did",
    "start": "2689500",
    "end": "2694960"
  },
  {
    "text": "they respond at all so I wasn't involved in that process that was something that was far more suited to the ncsc so our",
    "start": "2694960",
    "end": "2702160"
  },
  {
    "text": "national cyber security Center in the UK they have the connections in the contacts within other government",
    "start": "2702160",
    "end": "2707740"
  },
  {
    "text": "departments of their equivalent kind of purpose around the world so yes after we kind of got through the initial",
    "start": "2707740",
    "end": "2714760"
  },
  {
    "text": "um like busy period of Rush should we say we did then because we just went straight to the vendor and we're like",
    "start": "2714760",
    "end": "2720099"
  },
  {
    "text": "kill the kill the file as fast as we can it will fix it for everybody but then after that there was a lot of backwards",
    "start": "2720099",
    "end": "2725260"
  },
  {
    "text": "and forwards mainly between really it was just kind of like America Australia in New Zealand I wasn't really aware of",
    "start": "2725260",
    "end": "2730359"
  },
  {
    "text": "any other I mean maybe I just don't know about it they don't have to tell me but I wasn't really aware of any other kind of",
    "start": "2730359",
    "end": "2736240"
  },
  {
    "text": "communication in that regard but yeah there was some collaboration afterwards to try and resolve this",
    "start": "2736240",
    "end": "2741880"
  },
  {
    "text": "excellent question anymore",
    "start": "2741880",
    "end": "2746040"
  },
  {
    "text": "oh he's expecting some [Laughter] well look so I'm here for the remainder",
    "start": "2748359",
    "end": "2754240"
  },
  {
    "text": "of the week I'll also be here at the party this evening for those of you that haven't seen me already if you do want to come and ask a question in a more",
    "start": "2754240",
    "end": "2760300"
  },
  {
    "text": "private setting perhaps that's what everybody's waiting for we do actually have a booth down on the main floor where I can demo this attack and what",
    "start": "2760300",
    "end": "2766960"
  },
  {
    "text": "happened to you as well but if there are no more questions um then I guess I'll go ahead and wrap",
    "start": "2766960",
    "end": "2773260"
  },
  {
    "text": "it up there then thank you very much for coming [Applause]",
    "start": "2773260",
    "end": "2778429"
  }
]