[
  {
    "text": "okay hi welcome hi",
    "start": "3120",
    "end": "8400"
  },
  {
    "text": "thank you you are alive so",
    "start": "8400",
    "end": "15120"
  },
  {
    "text": "how many of you are writing front-end applications using javascript or typescript",
    "start": "15120",
    "end": "21039"
  },
  {
    "text": "okay and how many of you are using the new fancy stuff uh webassembly binary javascript",
    "start": "21039",
    "end": "26720"
  },
  {
    "text": "okay couple of you so i i have to tell you enough to be perfectly honest with you for all of my",
    "start": "26720",
    "end": "32398"
  },
  {
    "text": "life i was a server guy i don't care at all about uis",
    "start": "32399",
    "end": "37920"
  },
  {
    "text": "okay especially if they have to run in the browser yeah um but",
    "start": "37920",
    "end": "44559"
  },
  {
    "text": "we have many customers that that do care okay so uh you know and um i'm helping them",
    "start": "44559",
    "end": "51520"
  },
  {
    "text": "writing them in a secure way and and uh you know",
    "start": "51520",
    "end": "56840"
  },
  {
    "text": "javascript browser-based applications just in general are a security nightmare",
    "start": "56840",
    "end": "62640"
  },
  {
    "text": "they are yeah it's not the fault of javascript it's not the fault of whatever it's it's just the",
    "start": "62640",
    "end": "68159"
  },
  {
    "text": "the the facts that they are running in a very hostile environment yeah that is called the internet and the world wide",
    "start": "68159",
    "end": "74560"
  },
  {
    "text": "web and so on so i felt really bad for my customers right because",
    "start": "74560",
    "end": "80960"
  },
  {
    "text": "even more than in the back end it seemed like that the guidance how to protect and write applications on the front end",
    "start": "80960",
    "end": "87200"
  },
  {
    "text": "has changed even more often right it it went from you know like a pendulum going",
    "start": "87200",
    "end": "92479"
  },
  {
    "text": "this direction you have to do it like this oh no that's all wrong now it's swinging in this direction you have to do it like this to fix your stuff before",
    "start": "92479",
    "end": "98799"
  },
  {
    "text": "oh that's wrong too now so the way i see it and that's kind of like the",
    "start": "98799",
    "end": "103920"
  },
  {
    "text": "the idea or that the goal of the talk is i think now that we've seen both extremes i think that the truth as very",
    "start": "103920",
    "end": "111200"
  },
  {
    "text": "often is somewhere in the middle and that's all that is and that is what this pattern is about it's called bff the",
    "start": "111200",
    "end": "116479"
  },
  {
    "text": "back end for front-end pattern which is all about using the best of both worlds using the",
    "start": "116479",
    "end": "122079"
  },
  {
    "text": "ui technologies you have on the front end and using the security features you have on the back end and combine them",
    "start": "122079",
    "end": "128239"
  },
  {
    "text": "together to make something meaningful yeah so that's the whole idea of that talk",
    "start": "128239",
    "end": "134800"
  },
  {
    "text": "my name is dominic and i've been whoops",
    "start": "134800",
    "end": "140319"
  },
  {
    "text": "working for many many years in in that space helping customers building authentication and authorization uh",
    "start": "140319",
    "end": "147200"
  },
  {
    "text": "systems and helping them secure their applications and uh one one central piece of that work",
    "start": "147200",
    "end": "154239"
  },
  {
    "text": "is uh two protocols that i mostly care about which is open id connect and oauth that",
    "start": "154239",
    "end": "160400"
  },
  {
    "text": "is how i spend the better half of my career by implementing them in this thing called identity server which is um",
    "start": "160400",
    "end": "167040"
  },
  {
    "text": "um an asp.net core add-on if you like to build uh",
    "start": "167040",
    "end": "173200"
  },
  {
    "text": "oauth and openly connect uh server capabilities into into your software so",
    "start": "173200",
    "end": "179120"
  },
  {
    "text": "that's my background basically um and you know as part of that of course i",
    "start": "179120",
    "end": "184800"
  },
  {
    "text": "needed to help you know because at the end of the day the back end guys have to realize the only reason the back end exists is because there are front ends",
    "start": "184800",
    "end": "190879"
  },
  {
    "text": "to connect to it right so that's kind of like the way it works so um",
    "start": "190879",
    "end": "197360"
  },
  {
    "text": "i basically want to explore a little bit of the history how people were writing",
    "start": "197360",
    "end": "203200"
  },
  {
    "text": "browser-based applications in the past yeah and what is wrong with one approach and what is wrong with the other",
    "start": "203200",
    "end": "208720"
  },
  {
    "text": "approach and i think where is the sweet spot where we're going to end with okay",
    "start": "208720",
    "end": "214319"
  },
  {
    "text": "so i want to first have um a look at what i call",
    "start": "214319",
    "end": "219440"
  },
  {
    "text": "the cookie era but before i even start i should set the scene a little bit yeah because um i",
    "start": "219440",
    "end": "226319"
  },
  {
    "text": "wrote a blog post a long time ago in 2020 it was called spars are dead",
    "start": "226319",
    "end": "231519"
  },
  {
    "text": "and this got picked up by hacker news right and people on hacker news have a very short attention span all they read",
    "start": "231519",
    "end": "238239"
  },
  {
    "text": "was the headline they didn't even bother to read maybe the first line after that which said yeah it's a joke right but",
    "start": "238239",
    "end": "243920"
  },
  {
    "text": "they were like going completely crazy on me like this guy does nothing that knows nothing about sparse they are not dead",
    "start": "243920",
    "end": "249920"
  },
  {
    "text": "blah blah blah blah blah if they would have taken the time to read",
    "start": "249920",
    "end": "255200"
  },
  {
    "text": "what i was talking about is i was proposing an alternative approach to secure spas",
    "start": "255200",
    "end": "261440"
  },
  {
    "text": "okay which was a blog post i wrote earlier and which was like my very first",
    "start": "261440",
    "end": "266560"
  },
  {
    "text": "ideas around how to use the back end for front-end pattern to to secure those applications right um",
    "start": "266560",
    "end": "273840"
  },
  {
    "text": "but one thing they had a point with one thing is you know that sparse are many",
    "start": "273840",
    "end": "278960"
  },
  {
    "text": "things to many people right and when i mean sparse you know the world i'm living in i'm not a game developer i'm",
    "start": "278960",
    "end": "285199"
  },
  {
    "text": "you know like i'm living in in this boring business world right my customers are writing business applications right",
    "start": "285199",
    "end": "291680"
  },
  {
    "text": "uh forms over data you know corporate stuff you know things like that yeah",
    "start": "291680",
    "end": "297120"
  },
  {
    "text": "um and in that in that um world you know we",
    "start": "297120",
    "end": "304000"
  },
  {
    "text": "typically do stuff like we do authentication via open id connect we do a single sign-on we do federation with",
    "start": "304000",
    "end": "310240"
  },
  {
    "text": "external providers yeah software as a service style um applications and so on and we are",
    "start": "310240",
    "end": "315680"
  },
  {
    "text": "also calling apis okay so if you are living in that world then that's what i",
    "start": "315680",
    "end": "320880"
  },
  {
    "text": "meant with the current way how we do spas is wrong if you're not living in that world then you might have different",
    "start": "320880",
    "end": "326479"
  },
  {
    "text": "approaches that i don't know about but that's just not what i want to talk about today or my focus is on how to to",
    "start": "326479",
    "end": "333280"
  },
  {
    "text": "secure business applications okay and you know business applications can be a whole lot of things right i mean",
    "start": "333280",
    "end": "339919"
  },
  {
    "text": "the azure portal is a spa yeah that needs security would you agree",
    "start": "339919",
    "end": "345600"
  },
  {
    "text": "um the banks are sparse these days the health you know the health care systems",
    "start": "345600",
    "end": "350720"
  },
  {
    "text": "are written in javascript right i mean they need security and they all fall under this category that i want to talk",
    "start": "350720",
    "end": "356720"
  },
  {
    "text": "about so as i said the first thing i want to talk about is like how you did sparse and they weren't even called spas",
    "start": "356720",
    "end": "364080"
  },
  {
    "text": "by the time like back in the days okay so many many customers we have you know they started like",
    "start": "364080",
    "end": "371280"
  },
  {
    "text": "in the early 2000s with web forms or mvc right",
    "start": "371280",
    "end": "376479"
  },
  {
    "text": "classical server side web rendering style right where you render the page and you",
    "start": "376479",
    "end": "382720"
  },
  {
    "text": "did a post back back to the server and and then suddenly this hx thing became fashionable right",
    "start": "382720",
    "end": "390080"
  },
  {
    "text": "um for those who are old enough you maybe remember when microsoft showed the hx control toolkit like an add-on for",
    "start": "390080",
    "end": "397759"
  },
  {
    "text": "asp.net like look at that no flickering no more browser postbacks it's also",
    "start": "397759",
    "end": "403360"
  },
  {
    "text": "responsive isn't that cool right and they started shipping jquery with",
    "start": "403360",
    "end": "408479"
  },
  {
    "text": "asp.net for example right to enable people to build these more interactive",
    "start": "408479",
    "end": "413680"
  },
  {
    "text": "experiences right but what these applications basically were they were classic server-side rendered apps spiced",
    "start": "413680",
    "end": "421280"
  },
  {
    "text": "up with ajax right to make it nicer yeah and because the classic server side",
    "start": "421280",
    "end": "427840"
  },
  {
    "text": "um security mechanism was cookies they also used ajax",
    "start": "427840",
    "end": "433759"
  },
  {
    "text": "to do the cookie sorry they also use cookies to do the hx calls the nice thing is it just worked",
    "start": "433759",
    "end": "440240"
  },
  {
    "text": "there was no extra code necessary you know it the browser didn't care if it was a post back or if it was an ajax",
    "start": "440240",
    "end": "446319"
  },
  {
    "text": "call as long as you had a cookie that would could flow to the back end it all just worked right",
    "start": "446319",
    "end": "452800"
  },
  {
    "text": "all was good and happy until someone discovered cross-site request forgery",
    "start": "452800",
    "end": "458080"
  },
  {
    "text": "yeah which is um you know you you'll see that theme here that many attacks in the",
    "start": "458080",
    "end": "463440"
  },
  {
    "text": "browser have the word cross at the beginning right because the way i like to see a browser these days it's like a",
    "start": "463440",
    "end": "468960"
  },
  {
    "text": "little operating system right where every tab is a process that you need to protect from other tabs right um but",
    "start": "468960",
    "end": "475360"
  },
  {
    "text": "there were some shared resources like cookies for example and the whole idea in browser-based",
    "start": "475360",
    "end": "481280"
  },
  {
    "text": "attacks typically is how can one app attack another app and that's where the cross-site comes from where site",
    "start": "481280",
    "end": "488319"
  },
  {
    "text": "typically is the assumption it's coming from a different site right and they want to attack you so what's cross-site request forgery",
    "start": "488319",
    "end": "494800"
  },
  {
    "text": "um you know it is just the way how the browsers worked by the time is that you have a browser",
    "start": "494800",
    "end": "501520"
  },
  {
    "text": "you have a tab you go to that to your application you log into the application you get your authentication cookie and",
    "start": "501520",
    "end": "508160"
  },
  {
    "text": "all is good right now you're opening another tab in the same browser and you're going to an evil application",
    "start": "508160",
    "end": "514399"
  },
  {
    "text": "yeah that evil application starts making calls to this to the back end of app",
    "start": "514399",
    "end": "519839"
  },
  {
    "text": "app.com and by virtue of having a cookie from app.com the browser will happily",
    "start": "519839",
    "end": "525360"
  },
  {
    "text": "send that authentication cookie back to app.com right so in other words in that",
    "start": "525360",
    "end": "530800"
  },
  {
    "text": "tab now the evil application can make back-end calls impersonating the lockdown user in this tab",
    "start": "530800",
    "end": "537360"
  },
  {
    "text": "that's cross-site request forgery yeah so let me show you that",
    "start": "537360",
    "end": "543360"
  },
  {
    "text": "example because every now and then i have people in the room saying this can't be true if that would be true",
    "start": "543360",
    "end": "549360"
  },
  {
    "text": "the web would be broken right and they are right it is",
    "start": "549360",
    "end": "556640"
  },
  {
    "text": "okay but let's let's do this i have two applications here my app and evil app",
    "start": "557200",
    "end": "562959"
  },
  {
    "text": "okay so let's run my app first",
    "start": "562959",
    "end": "567200"
  },
  {
    "text": "just to illustrate the problem and the solution as well okay so here's my app imagine this is a",
    "start": "569920",
    "end": "577360"
  },
  {
    "text": "an app i'm logging in right imagine that this is now something that makes an ajax call to the back end that that is that",
    "start": "577360",
    "end": "584320"
  },
  {
    "text": "that is doing some work under the currently logged on user doing work as alice good okay so now",
    "start": "584320",
    "end": "591519"
  },
  {
    "text": "let's run evil app i mean who could resist",
    "start": "591519",
    "end": "598800"
  },
  {
    "text": "right of course i will click this but before we click it let's just have a",
    "start": "598800",
    "end": "605519"
  },
  {
    "text": "look what it does so let's go to the page source and you see that i don't even need to do",
    "start": "605519",
    "end": "611120"
  },
  {
    "text": "any javascript here all this is doing is basically doing a cross site post to the",
    "start": "611120",
    "end": "618000"
  },
  {
    "text": "other application okay",
    "start": "618000",
    "end": "623040"
  },
  {
    "text": "so what do you expect to see when i click this",
    "start": "623519",
    "end": "627360"
  },
  {
    "text": "i'm doing work as alice right because i did a post the browser sent the cookie",
    "start": "631120",
    "end": "638240"
  },
  {
    "text": "along i'm authenticated in the other pa in the other tab so to speak yeah that is cross site request buttery",
    "start": "638240",
    "end": "647279"
  },
  {
    "text": "okay and of course you know um i don't i can make this much smarter",
    "start": "647279",
    "end": "652880"
  },
  {
    "text": "right i don't need a user to click on something i can have a javascript thing saying submit the form automatically",
    "start": "652880",
    "end": "657920"
  },
  {
    "text": "right i can make this in a hidden iframe so they won't even see the kittens never yeah",
    "start": "657920",
    "end": "663440"
  },
  {
    "text": "so but yeah that is um that is cross-eyed request forgery right and if you um we're building apis and servers",
    "start": "663440",
    "end": "670079"
  },
  {
    "text": "and endpoints using cookies as the security mechanism you were vulnerable to this attack unless you protected",
    "start": "670079",
    "end": "677040"
  },
  {
    "text": "yourself against this okay so what is the protection mechanism",
    "start": "677040",
    "end": "683680"
  },
  {
    "text": "well it is adequately called anti-forgery",
    "start": "683680",
    "end": "689680"
  },
  {
    "text": "okay so the whole idea is this yeah and and probably probably everyone knows this or",
    "start": "689680",
    "end": "696720"
  },
  {
    "text": "should notice because this was part of mvc right from the start right there was this attribute",
    "start": "696720",
    "end": "702560"
  },
  {
    "text": "on your controller's validate and defaultery token right and what this basically did is when you were rendering",
    "start": "702560",
    "end": "709040"
  },
  {
    "text": "down a form it was basically issuing a cookie the so-called anti-forgery cookie",
    "start": "709040",
    "end": "714079"
  },
  {
    "text": "um and it was basically that had a value and they put the same value in a hidden form field called the request",
    "start": "714079",
    "end": "720160"
  },
  {
    "text": "verification token so now when you post that form back right uh both the cookie",
    "start": "720160",
    "end": "726800"
  },
  {
    "text": "and the hidden field post back to the server this attribute kicks in and make sure that both values are the same",
    "start": "726800",
    "end": "734720"
  },
  {
    "text": "right so now if you imagine now my attack scenario i just showed you if i'm doing this cross side form post i don't",
    "start": "734720",
    "end": "741839"
  },
  {
    "text": "know the value of this okay so it's missing and then the server will reject",
    "start": "741839",
    "end": "748320"
  },
  {
    "text": "the post yeah so we can we can do that it's easy um",
    "start": "748320",
    "end": "753440"
  },
  {
    "text": "let's go here and on my on my app",
    "start": "753440",
    "end": "758880"
  },
  {
    "text": "uh sorry on my app oops",
    "start": "758880",
    "end": "764639"
  },
  {
    "text": "on my app here is my do work right i would do a validate",
    "start": "764800",
    "end": "771040"
  },
  {
    "text": "and defaultry token okay so run this again my app",
    "start": "771040",
    "end": "776880"
  },
  {
    "text": "okay i'm logged in as alice run the evil app again",
    "start": "779120",
    "end": "784639"
  },
  {
    "text": "click here to see kittens doesn't work anymore right because that request verification",
    "start": "785360",
    "end": "791760"
  },
  {
    "text": "token is missing the the the filter said no you're not allowed in",
    "start": "791760",
    "end": "796800"
  },
  {
    "text": "you get basically an exception on the server okay so why why is this important well",
    "start": "796800",
    "end": "803760"
  },
  {
    "text": "while this attribute was part of every single mvc template you can imagine that",
    "start": "803760",
    "end": "811040"
  },
  {
    "text": "microsoft put out it was not part of any of the web api related templates",
    "start": "811040",
    "end": "816639"
  },
  {
    "text": "right so many people didn't know about this attack um because it was not on in",
    "start": "816639",
    "end": "821760"
  },
  {
    "text": "the template right also for web apis you need to write over for hx calls you need",
    "start": "821760",
    "end": "826880"
  },
  {
    "text": "to write some extra code right because you you don't just do a form post and this thing flows you would have to write",
    "start": "826880",
    "end": "832480"
  },
  {
    "text": "some javascript code to fetch the token from the form put it on a header then send the header along with the cookie",
    "start": "832480",
    "end": "838560"
  },
  {
    "text": "and then have some code comparing the header value with the cookie value and that all of that was never part of mvc",
    "start": "838560",
    "end": "844160"
  },
  {
    "text": "that's why believe me i have done many code reviews in my life where people",
    "start": "844160",
    "end": "849279"
  },
  {
    "text": "knew about this for a ui but did not even know that this was an issue for apis",
    "start": "849279",
    "end": "854880"
  },
  {
    "text": "right and they were using cookies and they were vulnerable to across that request forgery",
    "start": "854880",
    "end": "861199"
  },
  {
    "text": "okay that's just the way it is um and again you met this is like 15 years",
    "start": "861199",
    "end": "867199"
  },
  {
    "text": "ago right we're basically trying to work our way up to today um",
    "start": "867199",
    "end": "872320"
  },
  {
    "text": "so what happened next yeah um the ietf which is this",
    "start": "872320",
    "end": "877920"
  },
  {
    "text": "standard body right the internet engineering task force they became aware of this problem and they were working on",
    "start": "877920",
    "end": "884240"
  },
  {
    "text": "this thing called oauth and they felt like huh what if we could extend o of in a way that you could",
    "start": "884240",
    "end": "890079"
  },
  {
    "text": "get rid of your cookies all together in the browser and use access tokens instead right access tokens don't have this",
    "start": "890079",
    "end": "896000"
  },
  {
    "text": "issue because they're not sent automatically so we could solve this problem right um but",
    "start": "896000",
    "end": "902160"
  },
  {
    "text": "to get access tokens basically by the time you had to do like cross cross side calls to the token server to",
    "start": "902160",
    "end": "908959"
  },
  {
    "text": "ask for a token get a token back and so on and this wasn't easily possible because",
    "start": "908959",
    "end": "914160"
  },
  {
    "text": "cross-origin resource sharing didn't exist by the time right there was no easy way to make cross-site ajax calls",
    "start": "914160",
    "end": "921279"
  },
  {
    "text": "by the time yeah that the same origin policy prohibited that yeah so they came up with uh a simplified version of doing",
    "start": "921279",
    "end": "928959"
  },
  {
    "text": "that which is called the implicit flow okay um they knew they're making a lot of",
    "start": "928959",
    "end": "934639"
  },
  {
    "text": "security compromises there but they wanted to make it work for browser-based applications the implicit",
    "start": "934639",
    "end": "940639"
  },
  {
    "text": "folder worked like this basically here's your javascript it makes a get request to the token server and it gets back",
    "start": "940639",
    "end": "947600"
  },
  {
    "text": "again a get request back and the access token was on the url right and then you would store that url",
    "start": "947600",
    "end": "954480"
  },
  {
    "text": "that that token and would start calling apis no cookies involved",
    "start": "954480",
    "end": "959600"
  },
  {
    "text": "yeah so that looked good this actually made it into a real standard in oauth 2.0",
    "start": "959600",
    "end": "966839"
  },
  {
    "text": "yeah yeah until they realize that there's a different problem here it's called uh",
    "start": "966839",
    "end": "973040"
  },
  {
    "text": "cross-site scripting right um so the first problem we had is is that",
    "start": "973040",
    "end": "980000"
  },
  {
    "text": "token transmission over over urls is extremely leaky right urls end up in log",
    "start": "980000",
    "end": "985600"
  },
  {
    "text": "files in the browser history in headers in reverse proxies wherever you can imagine these headers are getting stored",
    "start": "985600",
    "end": "991519"
  },
  {
    "text": "because typically the assumption is there is no sensitive data on a url",
    "start": "991519",
    "end": "997440"
  },
  {
    "text": "right it shouldn't be um so this became a security nightmare",
    "start": "997440",
    "end": "1002880"
  },
  {
    "text": "actually because now these tokens were spread all over the place right and you had to write some complicated",
    "start": "1002880",
    "end": "1008959"
  },
  {
    "text": "javascript code for example to delete the browser history after you got the token and",
    "start": "1008959",
    "end": "1014880"
  },
  {
    "text": "whatever right so that was the first big problem here that the transmission",
    "start": "1014880",
    "end": "1020720"
  },
  {
    "text": "wire this redirect mechanism was not very secure um",
    "start": "1020720",
    "end": "1026480"
  },
  {
    "text": "so they basically said okay we should use a different flow now yeah don't use implicit flow anymore if you have",
    "start": "1026480",
    "end": "1032558"
  },
  {
    "text": "written your application using bluetooth flow you're doing it wrong now yeah it was okay yesterday but today it's",
    "start": "1032559",
    "end": "1037678"
  },
  {
    "text": "wrong yeah so dave basically said okay there's another flow in oauth that is better basically you start a front channel",
    "start": "1037679",
    "end": "1045038"
  },
  {
    "text": "approach you know like you you go to the token server um and",
    "start": "1045039",
    "end": "1050320"
  },
  {
    "text": "collect some artifacts but the actual token is not coming back on the browser you're now making an hx call to the back",
    "start": "1050320",
    "end": "1056880"
  },
  {
    "text": "end and retrieve the token outside of the url so to speak you have to solve the url problem okay and then",
    "start": "1056880",
    "end": "1064160"
  },
  {
    "text": "in the end you have to store and manage that token next problem is is storage mechanisms in browsers",
    "start": "1064160",
    "end": "1071039"
  },
  {
    "text": "secure well the answer is no",
    "start": "1071039",
    "end": "1076720"
  },
  {
    "text": "i mean secure is the wrong word maybe yeah if the browser has several ways to store data right it could be in memory",
    "start": "1076720",
    "end": "1082320"
  },
  {
    "text": "it could be in session storage could be in local storage could be in web indexeddb all kinds of things right but",
    "start": "1082320",
    "end": "1089120"
  },
  {
    "text": "all of these mechanisms are by design accessible by javascript",
    "start": "1089120",
    "end": "1095120"
  },
  {
    "text": "right and now with the upcoming thread of cross-site scripting yeah what cross-site scripting really means is is",
    "start": "1095120",
    "end": "1101600"
  },
  {
    "text": "that somebody else can execute javascript code in your application",
    "start": "1101600",
    "end": "1106880"
  },
  {
    "text": "right you're getting some string you're not properly sanitizing that you're outputting it it happens to be",
    "start": "1106880",
    "end": "1111919"
  },
  {
    "text": "javascript bang the attacker runs code in your process yeah",
    "start": "1111919",
    "end": "1117280"
  },
  {
    "text": "um up till today this is not a solved problem if you look at the over top 10",
    "start": "1117280",
    "end": "1122320"
  },
  {
    "text": "for the last 10 years it was always between number one and number three it's kind of",
    "start": "1122320",
    "end": "1127520"
  },
  {
    "text": "like going up and down but it's not a solved problem yeah um cross-site cross-site scripting is a real",
    "start": "1127520",
    "end": "1134720"
  },
  {
    "text": "uh a real problem that still happens today um and in other words if now somebody",
    "start": "1134720",
    "end": "1140960"
  },
  {
    "text": "can execute javascript code in your application they can reach to whatever storage mechanism you're using and",
    "start": "1140960",
    "end": "1147360"
  },
  {
    "text": "exfiltrate those tokens and send them away okay this is not not an exotic",
    "start": "1147360",
    "end": "1152640"
  },
  {
    "text": "uh i don't know dystopian thing it's it's happening actually",
    "start": "1152640",
    "end": "1157760"
  },
  {
    "text": "okay um oh yeah and there's more really scary stuff going on you remember the spectre",
    "start": "1157760",
    "end": "1164960"
  },
  {
    "text": "attacks you know like um we're basically exploiting",
    "start": "1164960",
    "end": "1170080"
  },
  {
    "text": "exploiting um intel cpus that when you send some weird stuff you could you're now starting to read memory",
    "start": "1170080",
    "end": "1176320"
  },
  {
    "text": "right that was a main thing for servers but google found out with with valid",
    "start": "1176320",
    "end": "1181600"
  },
  {
    "text": "javascript you can provoke specter attacks in the memory of the browser",
    "start": "1181600",
    "end": "1188400"
  },
  {
    "text": "okay so i don't think a browser is a good place to store sensitive data",
    "start": "1188400",
    "end": "1194960"
  },
  {
    "text": "it's just the way it is okay so the or folks",
    "start": "1194960",
    "end": "1200320"
  },
  {
    "text": "kind of said like yeah it's not perfect from a security point of view you should reduce the exposure of these tokens",
    "start": "1200320",
    "end": "1207679"
  },
  {
    "text": "there's this thing called refresh tokens for example in oauth that gives you long-lived access to an api they are",
    "start": "1207679",
    "end": "1213440"
  },
  {
    "text": "forbidden in implicit flow because it was just too dangerous right i mean getting an access token is bad getting a",
    "start": "1213440",
    "end": "1219679"
  },
  {
    "text": "refresh token gives you a way to get new access tokens yeah and since um javascript applications are public",
    "start": "1219679",
    "end": "1225360"
  },
  {
    "text": "clients by design there's no client secret if i steal your refresh token i can happily get new access tokens as",
    "start": "1225360",
    "end": "1231120"
  },
  {
    "text": "long as i want probably yeah so they didn't allow that and came up with other",
    "start": "1231120",
    "end": "1236159"
  },
  {
    "text": "mechanisms or workarounds to um to do this right um [Music]",
    "start": "1236159",
    "end": "1243769"
  },
  {
    "text": "let me show you just so that we are all on the same page here let me show you",
    "start": "1244000",
    "end": "1250320"
  },
  {
    "text": "uh an example of a of an app that does everything",
    "start": "1250320",
    "end": "1255760"
  },
  {
    "text": "from within javascript right there there's no back end involved",
    "start": "1255760",
    "end": "1262320"
  },
  {
    "text": "here it's basically as you can see all i'm doing here on the back end is really just serving static files everything",
    "start": "1262320",
    "end": "1267440"
  },
  {
    "text": "else is happening in javascript yeah so when i run this um",
    "start": "1267440",
    "end": "1273840"
  },
  {
    "text": "app you see now you know that's how far my",
    "start": "1273840",
    "end": "1279520"
  },
  {
    "text": "ui skills go um i can basically log in i can call apis and so on right so let's try this let's",
    "start": "1279520",
    "end": "1286559"
  },
  {
    "text": "log in okay i'm logging in",
    "start": "1286559",
    "end": "1291760"
  },
  {
    "text": "and yeah um mission mission accomplished right i now have an access token",
    "start": "1291760",
    "end": "1297280"
  },
  {
    "text": "in the browser so i can call my apis right um so i think i can even call the api",
    "start": "1297280",
    "end": "1302960"
  },
  {
    "text": "yeah it works okay but if i now look",
    "start": "1302960",
    "end": "1308240"
  },
  {
    "text": "um if i now look at my session storage in the browser of",
    "start": "1308240",
    "end": "1313280"
  },
  {
    "text": "course this must be stored somewhere right and here it is and of course if i",
    "start": "1313280",
    "end": "1318960"
  },
  {
    "text": "can now inject javascript into this application i can exfiltrate the token and steal them",
    "start": "1318960",
    "end": "1324559"
  },
  {
    "text": "yeah okay next challenge",
    "start": "1324559",
    "end": "1331360"
  },
  {
    "text": "token and session management so let's say we're going down the javascript route there are no refresh tokens so we",
    "start": "1331360",
    "end": "1337440"
  },
  {
    "text": "can't re you know we can't get new access or we should not do that right um",
    "start": "1337440",
    "end": "1343120"
  },
  {
    "text": "so they came up with a different technique called silent renew and the idea was that you're opening an invisible iframe that does another token",
    "start": "1343120",
    "end": "1350240"
  },
  {
    "text": "request under the covers and the cookie is flowing to the server and while while the user is still locked in you will get",
    "start": "1350240",
    "end": "1356000"
  },
  {
    "text": "new access tokens without having to have a refresh token and when the user signs out it won't work anymore which was kind",
    "start": "1356000",
    "end": "1361039"
  },
  {
    "text": "of like not a bad idea yeah so that utilized an iframe",
    "start": "1361039",
    "end": "1368240"
  },
  {
    "text": "the next challenge you have when you're writing a read application is session change notifications right so",
    "start": "1368240",
    "end": "1374720"
  },
  {
    "text": "when the user logs out from the server maybe your javascript application wants to know that there's a log out going on to clean up data and and block him out",
    "start": "1374720",
    "end": "1381919"
  },
  {
    "text": "right so how do you do that well again another iframe technique was",
    "start": "1381919",
    "end": "1387360"
  },
  {
    "text": "invented that basically i'll show you in a second how that works here long story short they found some",
    "start": "1387360",
    "end": "1393440"
  },
  {
    "text": "workarounds to make this a little bit better using iframes",
    "start": "1393440",
    "end": "1399200"
  },
  {
    "text": "so let me show you that um let's just do this again log in here",
    "start": "1399200",
    "end": "1406080"
  },
  {
    "text": "you see now um there is a renew token",
    "start": "1406080",
    "end": "1411679"
  },
  {
    "text": "okay so when i when i click the renew token button don't click it",
    "start": "1411679",
    "end": "1417679"
  },
  {
    "text": "yeah you see that i'm getting new tokens no flickering in the browser mission accomplished",
    "start": "1417679",
    "end": "1423600"
  },
  {
    "text": "right so that is and i'll show you how it works um",
    "start": "1423600",
    "end": "1429360"
  },
  {
    "text": "that is uh let's do inspect you see here um here's my application so when i renew the token you will see for",
    "start": "1429360",
    "end": "1436559"
  },
  {
    "text": "us for a split second or so a new iframe coming going up that this does just do the token request and give me back a new",
    "start": "1436559",
    "end": "1443200"
  },
  {
    "text": "token see that okay that is the replacement for refresh",
    "start": "1443200",
    "end": "1449440"
  },
  {
    "text": "tokens in the browser so a workaround to make that security story a little bit better",
    "start": "1449440",
    "end": "1454799"
  },
  {
    "text": "here is the other thing i talked about that is an iframe that points to an endpoint on the identity server right",
    "start": "1454799",
    "end": "1463120"
  },
  {
    "text": "and it's called check session and basically how that works is you open the iframe and just leave it there and then a server-side event is coming from the",
    "start": "1463120",
    "end": "1469600"
  },
  {
    "text": "server back to your client telling you the user is locked out you should now clean up your stuff okay",
    "start": "1469600",
    "end": "1475279"
  },
  {
    "text": "so i can show you that too so if i go to the actual token server",
    "start": "1475279",
    "end": "1480960"
  },
  {
    "text": "you see here i'm logged in so when i click the log out button here",
    "start": "1480960",
    "end": "1486400"
  },
  {
    "text": "magic happens okay and that basically is a server side",
    "start": "1486400",
    "end": "1492799"
  },
  {
    "text": "event coming from the token server down to my javascript client and that are basically the two things you need to",
    "start": "1492799",
    "end": "1499039"
  },
  {
    "text": "write a real application you need token lifetime management and you need session lifetime management okay",
    "start": "1499039",
    "end": "1505760"
  },
  {
    "text": "cool so that was kind of working and to be honest we wrote a client library like seven years ago that is",
    "start": "1506720",
    "end": "1513200"
  },
  {
    "text": "pretty popular it's called oidc client.js and we decided to",
    "start": "1513200",
    "end": "1519760"
  },
  {
    "text": "archive the repo one and a half years ago because it was just",
    "start": "1519760",
    "end": "1526720"
  },
  {
    "text": "i shouldn't swear here so i won't it was very bad and that was not the library what was",
    "start": "1526720",
    "end": "1532320"
  },
  {
    "text": "really bad is is that the javascript landscape and the browser landscape is changing so rapidly yeah having to",
    "start": "1532320",
    "end": "1538320"
  },
  {
    "text": "maintain a library that is supposed to work in all browsers is just a nightmare",
    "start": "1538320",
    "end": "1543520"
  },
  {
    "text": "right that combined with you know new techniques in javascript webpack and all",
    "start": "1543520",
    "end": "1549679"
  },
  {
    "text": "of that stuff i mean you know did you know that even opening a pop-up window in a browser is",
    "start": "1549679",
    "end": "1555840"
  },
  {
    "text": "not standardized chrome does it differently than firefox firefox does it differently than",
    "start": "1555840",
    "end": "1560960"
  },
  {
    "text": "uh what else safari i guess yeah but people want to have login pages as",
    "start": "1560960",
    "end": "1566000"
  },
  {
    "text": "pop-up windows yeah whatever yeah so we decided now we are we are too old for that",
    "start": "1566000",
    "end": "1572000"
  },
  {
    "text": "um if somebody wants to take it over they can there there are actually some guys who take took it over they now have",
    "start": "1572000",
    "end": "1577919"
  },
  {
    "text": "a typescript version of that which was another thing that people asked for you know i don't care about typescript",
    "start": "1577919",
    "end": "1584320"
  },
  {
    "text": "anyways so this library this this spa app i just showed you is using our library which",
    "start": "1584320",
    "end": "1590799"
  },
  {
    "text": "automated all of these things um now",
    "start": "1590799",
    "end": "1598400"
  },
  {
    "text": "going back to last year uh is it last year i think",
    "start": "1598400",
    "end": "1603520"
  },
  {
    "text": "it is last 2021 late 2020 um the browser vendors decided they now",
    "start": "1603520",
    "end": "1610480"
  },
  {
    "text": "need to fight back on tracking mechanisms in browsers right like uh ads",
    "start": "1610480",
    "end": "1616240"
  },
  {
    "text": "networks and and this all that stuff that people use to track you across websites to give you better",
    "start": "1616240",
    "end": "1623600"
  },
  {
    "text": "better ads basically yeah and they i identified that one of the techniques",
    "start": "1623600",
    "end": "1629440"
  },
  {
    "text": "that people are using to do this secret tracking across sites guess what is iframes with",
    "start": "1629440",
    "end": "1635600"
  },
  {
    "text": "cookies so now they are deciding we're going to turn this off we don't we won't allow",
    "start": "1635600",
    "end": "1641200"
  },
  {
    "text": "any more iframes going to to cross side in sorry we won't allow cookies anymore",
    "start": "1641200",
    "end": "1647440"
  },
  {
    "text": "going cross-side in iframes do you see a problem here i just showed you some two brand new specifications from the o of",
    "start": "1647440",
    "end": "1653600"
  },
  {
    "text": "working group that solved the problem with iframes and cookies well not anymore",
    "start": "1653600",
    "end": "1660159"
  },
  {
    "text": "so today there is one company that did that so",
    "start": "1660159",
    "end": "1665679"
  },
  {
    "text": "far which is apple right and safari has a reasonable market share right so if it only would be",
    "start": "1665679",
    "end": "1671120"
  },
  {
    "text": "firefox or something people would say like yeah that's a hippie browser right who who uses that but it's safari right it's",
    "start": "1671120",
    "end": "1678159"
  },
  {
    "text": "safari on mac os and on ios which has a 15 market share that is enough to ask yourself huh",
    "start": "1678159",
    "end": "1686399"
  },
  {
    "text": "do i have customers that use safari you probably have right um",
    "start": "1686399",
    "end": "1691679"
  },
  {
    "text": "of course other browsers like brave and firefox they do the same thing now but no one cares about them but guess who's",
    "start": "1691679",
    "end": "1696720"
  },
  {
    "text": "coming next year chrome okay and with chrome",
    "start": "1696720",
    "end": "1702640"
  },
  {
    "text": "they turn this off i can tell you it's going to be the same disaster as two years ago when they",
    "start": "1702640",
    "end": "1709039"
  },
  {
    "text": "turned on same side cookies right where they actually had to realize oh beginning of 2020 we just broke half",
    "start": "1709039",
    "end": "1715360"
  },
  {
    "text": "of the internet maybe that was bad timing yeah because all of the websites stopped working including things like you know",
    "start": "1715360",
    "end": "1722559"
  },
  {
    "text": "healthcare systems red cross first responders so they had to they had to remove that",
    "start": "1722559",
    "end": "1727679"
  },
  {
    "text": "feature again and then it came back again end of 2020. yeah so",
    "start": "1727679",
    "end": "1733520"
  },
  {
    "text": "let me show you that um actually let's let's take the app i just ran",
    "start": "1733520",
    "end": "1738799"
  },
  {
    "text": "which is not running anymore [Music] and just run the same",
    "start": "1738799",
    "end": "1744399"
  },
  {
    "text": "spa in safari",
    "start": "1744399",
    "end": "1748360"
  },
  {
    "text": "great it looks almost the same um now just to show you what's happening now is",
    "start": "1752960",
    "end": "1758399"
  },
  {
    "text": "this i'm doing login right i'm going to the server i log in",
    "start": "1758399",
    "end": "1764640"
  },
  {
    "text": "and then i will get back my tokens and so on and then the client will open this iframe to wait for session change",
    "start": "1764640",
    "end": "1771039"
  },
  {
    "text": "notifications right now this iframe does not contain my session cookie anymore so the server",
    "start": "1771039",
    "end": "1776720"
  },
  {
    "text": "will immediately say you are anonymous you're not even locked in okay and that's exactly what we're",
    "start": "1776720",
    "end": "1782399"
  },
  {
    "text": "seeing now when i log in here so i'm logging in all is good so far",
    "start": "1782399",
    "end": "1788480"
  },
  {
    "text": "i'm coming back out okay",
    "start": "1788480",
    "end": "1793760"
  },
  {
    "text": "because the iframe does not contain the session anymore which is the cookie",
    "start": "1793760",
    "end": "1798880"
  },
  {
    "text": "um and of course the the renew thing doesn't work either of course because that is using the same technique",
    "start": "1798880",
    "end": "1805360"
  },
  {
    "text": "so yeah this is not working anymore",
    "start": "1805360",
    "end": "1809840"
  },
  {
    "text": "yeah this this even has a name now it's called the google chrome cookie pocalypse",
    "start": "1812320",
    "end": "1819278"
  },
  {
    "text": "and it's it's it's right now it's planned to happen in 2023 there is",
    "start": "1819919",
    "end": "1825200"
  },
  {
    "text": "actually the eu trying to prohibit that yeah because they know that all of the",
    "start": "1825200",
    "end": "1830720"
  },
  {
    "text": "government stuff isn't working anymore so yeah not a good situation to be in",
    "start": "1830720",
    "end": "1838480"
  },
  {
    "text": "um yeah so that's what i just said yeah these things don't work anymore now",
    "start": "1838480",
    "end": "1844159"
  },
  {
    "text": "for something good now there are also good browser changes okay so and you",
    "start": "1844159",
    "end": "1849200"
  },
  {
    "text": "know um one of the the good browser changes is that all major browsers",
    "start": "1849200",
    "end": "1855760"
  },
  {
    "text": "are basically trying to solve now the cross-site request forgery problem okay so remember remember what was the",
    "start": "1855760",
    "end": "1862000"
  },
  {
    "text": "problem of crosshat request forgery basically the browser got a cookie from server one",
    "start": "1862000",
    "end": "1867279"
  },
  {
    "text": "um and then somebody else who who was not server one posted back to server one",
    "start": "1867279",
    "end": "1872559"
  },
  {
    "text": "and the browser was sending the cookie along because it belonged to server one right that that's the",
    "start": "1872559",
    "end": "1877679"
  },
  {
    "text": "the essence of it yeah now guess what they have this thing called same side cookies and what that expresses is is",
    "start": "1877679",
    "end": "1884399"
  },
  {
    "text": "that if you have a cookie for server one you should only post it back if the postback comes from a page originating",
    "start": "1884399",
    "end": "1890080"
  },
  {
    "text": "from server one right and if the page is coming from server two you don't post that cookie back and now you have to",
    "start": "1890080",
    "end": "1896320"
  },
  {
    "text": "wonder why wasn't it like that all from the start wouldn't that you know that would have saved us a lot of pain ma'am so yeah",
    "start": "1896320",
    "end": "1903200"
  },
  {
    "text": "same side cookies as i said this caused a massive problem when chrome turned",
    "start": "1903200",
    "end": "1908240"
  },
  {
    "text": "them on beginning of 2020 but now they all turned it on",
    "start": "1908240",
    "end": "1913279"
  },
  {
    "text": "and arguably it makes the internet a safer place it was just breaking everyone and",
    "start": "1913279",
    "end": "1918640"
  },
  {
    "text": "they all had to learn that in really hard lessons yeah um",
    "start": "1918640",
    "end": "1924480"
  },
  {
    "text": "what does that mean that means that now suddenly in 2022",
    "start": "1924480",
    "end": "1930000"
  },
  {
    "text": "there is maybe you should give cookies a second look right because they are much better",
    "start": "1930000",
    "end": "1935360"
  },
  {
    "text": "as they used to be 15 years ago okay",
    "start": "1935360",
    "end": "1940480"
  },
  {
    "text": "and just to you know as a side note",
    "start": "1941919",
    "end": "1946960"
  },
  {
    "text": "same side cookies but basically means um that cookies can flow freely within the",
    "start": "1946960",
    "end": "1952000"
  },
  {
    "text": "same site now some people are confused what's the site and what's an origin and origin is very strict right an origin",
    "start": "1952000",
    "end": "1958080"
  },
  {
    "text": "basically is the combination of protocol server name port that's an origin right and the",
    "start": "1958080",
    "end": "1965279"
  },
  {
    "text": "browser prevents cross-origin requests now what's the site the site is much broader basically if you have a",
    "start": "1965279",
    "end": "1971200"
  },
  {
    "text": "top-level domain like myapp.com then all of the sub-domains are on the same site meaning if you have app one myapp.com it",
    "start": "1971200",
    "end": "1978960"
  },
  {
    "text": "can post cookies to app too myapp.com okay that is kind of like the boundary here um which of of course makes total",
    "start": "1978960",
    "end": "1987039"
  },
  {
    "text": "sense if you trust all your sub domains right",
    "start": "1987039",
    "end": "1992399"
  },
  {
    "text": "and in big companies right many teams own different sub domains do you know that every team is writing",
    "start": "1993679",
    "end": "1999519"
  },
  {
    "text": "secure code or is there something that could happen if you know",
    "start": "1999519",
    "end": "2005320"
  },
  {
    "text": "crm.mycompany.com posts to my secureapi.mycompany.com right um so yeah just be aware of that same",
    "start": "2005320",
    "end": "2012240"
  },
  {
    "text": "site is not like the the silver bullet but it by default built into the browser",
    "start": "2012240",
    "end": "2018240"
  },
  {
    "text": "without you having to do anything it will shield you from attacks from other sites",
    "start": "2018240",
    "end": "2024720"
  },
  {
    "text": "which is not bad to start with at least good",
    "start": "2024720",
    "end": "2030159"
  },
  {
    "text": "so now with all of that said now we are here today there is now new",
    "start": "2030159",
    "end": "2036000"
  },
  {
    "text": "recommendation from the ietf they removed implicit flow from oauth because they realized it's a bad idea it's gone",
    "start": "2036000",
    "end": "2042880"
  },
  {
    "text": "it's deprecated you shouldn't use it they even removed it completely from the rfc",
    "start": "2042880",
    "end": "2048560"
  },
  {
    "text": "because they are now doing a revision of oauth yeah so now what do we do",
    "start": "2048560",
    "end": "2055520"
  },
  {
    "text": "do we do cookies again do we stay with tokens",
    "start": "2055520",
    "end": "2060638"
  },
  {
    "text": "what's the best way to do it right and how often have we already rewritten our application so far yeah",
    "start": "2060639",
    "end": "2066560"
  },
  {
    "text": "so um there is some good good documents coming out of that",
    "start": "2066560",
    "end": "2071679"
  },
  {
    "text": "especially the one here it's called oauth for browser-based applications best current practices which is not a",
    "start": "2071679",
    "end": "2078000"
  },
  {
    "text": "spec it's more like a guidance document and the way they phrase it and that is",
    "start": "2078000",
    "end": "2083280"
  },
  {
    "text": "basically what i totally agree with there are two types of javascript applications",
    "start": "2083280",
    "end": "2088480"
  },
  {
    "text": "the ones with the back end and the ones without a back end so",
    "start": "2088480",
    "end": "2094398"
  },
  {
    "text": "the ones without a back end you know like this this this stream from the all of these javascript hipsters right all",
    "start": "2094399",
    "end": "2100720"
  },
  {
    "text": "we need is a cdn that deploys our html css and javascript that's all we need because from that point on it's a",
    "start": "2100720",
    "end": "2106640"
  },
  {
    "text": "standalone application running in the browser yeah don't think so um",
    "start": "2106640",
    "end": "2112480"
  },
  {
    "text": "if you're staying with this architecture then you're pretty pretty much in in the boat of doing everything from javascript",
    "start": "2112480",
    "end": "2118079"
  },
  {
    "text": "and just what i showed you right with storing stuff in the browser fighting with browser changes and all of that",
    "start": "2118079",
    "end": "2124400"
  },
  {
    "text": "so that the spec says very clearly if you are not dealing with sensitive data stay on this architecture",
    "start": "2124400",
    "end": "2131680"
  },
  {
    "text": "but if you're dealing with sensitive data and that's what most of my customers are doing actually probably all then you should",
    "start": "2131680",
    "end": "2138400"
  },
  {
    "text": "consider this approach here where you are using the browser and your favorite browser framework angular react",
    "start": "2138400",
    "end": "2145119"
  },
  {
    "text": "whatsoever to show the nice uis right but all of the security all of the",
    "start": "2145119",
    "end": "2150720"
  },
  {
    "text": "token management all of the interaction with your authentication system and so on and so",
    "start": "2150720",
    "end": "2156240"
  },
  {
    "text": "forth it should be on the server okay",
    "start": "2156240",
    "end": "2162320"
  },
  {
    "text": "yes and that is as i said the one thing that i totally agree with",
    "start": "2162320",
    "end": "2167760"
  },
  {
    "text": "now um there's a second spec now there um that",
    "start": "2167760",
    "end": "2173440"
  },
  {
    "text": "you know this is such a young pattern but still starts people start to now make variations of it already",
    "start": "2173440",
    "end": "2179599"
  },
  {
    "text": "um and that there's one pattern called so if if you come across that they call it tmi bff uh something with it it's",
    "start": "2179599",
    "end": "2187680"
  },
  {
    "text": "supposed to be like a funny wordplay something with mediate uh something something but it's also too much",
    "start": "2187680",
    "end": "2193200"
  },
  {
    "text": "information and the idea is that you're basically moving",
    "start": "2193200",
    "end": "2198400"
  },
  {
    "text": "parts of your security stuff on the server and parts stay on the browser i don't agree with that",
    "start": "2198400",
    "end": "2205040"
  },
  {
    "text": "and i have i argued with them until they added this wording here uh into the spec",
    "start": "2205040",
    "end": "2211599"
  },
  {
    "text": "which is called a full bff where everything is happening on the server offers better",
    "start": "2211599",
    "end": "2217760"
  },
  {
    "text": "security right that was just getting this sentence in was an interesting",
    "start": "2217760",
    "end": "2223200"
  },
  {
    "text": "experience um okay let me quickly show you the tmi approach and then forget it again i mean",
    "start": "2223200",
    "end": "2229680"
  },
  {
    "text": "no but just you know that you've seen it before so so the idea with the tmi approach is basically",
    "start": "2229680",
    "end": "2235920"
  },
  {
    "text": "here's your front end then if you need a token you go to the back end the back end does all the interaction with the token server right",
    "start": "2235920",
    "end": "2243040"
  },
  {
    "text": "and then stores the token response on the back end but then when the front end wants to call the api it can get the",
    "start": "2243040",
    "end": "2248960"
  },
  {
    "text": "token to the front end and call the api which in my opinion is not really the solution because you're still ending up",
    "start": "2248960",
    "end": "2254960"
  },
  {
    "text": "with tokens in the browser yeah they might have a shorter lifetime and all of the refresh handling is done",
    "start": "2254960",
    "end": "2261760"
  },
  {
    "text": "on the server but ultimately you end up with access tokens in the browser that's why i don't like this",
    "start": "2261760",
    "end": "2267760"
  },
  {
    "text": "approach yeah again my preferred approach is what they call the full bff now where basically everything",
    "start": "2267760",
    "end": "2274880"
  },
  {
    "text": "is happening on the application server and whenever the browser wants to do something it calls the application",
    "start": "2274880",
    "end": "2280720"
  },
  {
    "text": "server and the application server calls whatever they need to do okay and the browser is purely for a ui",
    "start": "2280720",
    "end": "2289119"
  },
  {
    "text": "okay so that is a bff it's called back-end for front-end and the idea is as i just",
    "start": "2289280",
    "end": "2294960"
  },
  {
    "text": "said you get the best of both worlds you get the responsiveness the javascript stuff the the ui stuff in the browser",
    "start": "2294960",
    "end": "2302640"
  },
  {
    "text": "but the security stuff is on the server and i think that is a good compromise okay",
    "start": "2302640",
    "end": "2309760"
  },
  {
    "text": "so let's let's let's do this um so um",
    "start": "2310839",
    "end": "2316240"
  },
  {
    "text": "i i should mention um i've been working on a product for that um that that",
    "start": "2316240",
    "end": "2321680"
  },
  {
    "text": "puts these things all together um it's free um if you are if you you or your company",
    "start": "2321680",
    "end": "2327680"
  },
  {
    "text": "is making less than one million usd a year which is a pretty fair deal i think otherwise if you're making more than one",
    "start": "2327680",
    "end": "2332800"
  },
  {
    "text": "million i guess you can afford it um but the idea is this most of the sixty percent of the plumbing you need to",
    "start": "2332800",
    "end": "2339359"
  },
  {
    "text": "build the bff is already in asp.net core okay and what is this it basically is",
    "start": "2339359",
    "end": "2344640"
  },
  {
    "text": "your open id connect an oauth client library it is part of asp.net core this is the thing that goes to the open id",
    "start": "2344640",
    "end": "2350079"
  },
  {
    "text": "connect server that sends the right parameters that handles the response back from the server that gets the tokens and so on",
    "start": "2350079",
    "end": "2357440"
  },
  {
    "text": "session management is part of asp.net core it's it's it's basically the cookie handler right the thing that sets a",
    "start": "2357440",
    "end": "2363119"
  },
  {
    "text": "cookie that keeps the session alive that maybe does ex sliding exploration or absolute exploration basically the thing",
    "start": "2363119",
    "end": "2370079"
  },
  {
    "text": "that lets your front end call the back end under your control",
    "start": "2370079",
    "end": "2376560"
  },
  {
    "text": "the thing that is not part of asp.net is token management so basically once you have the need of calling apis that are",
    "start": "2376560",
    "end": "2383520"
  },
  {
    "text": "cross-site you need an access token access tokens means you need refresh tokens someone must need to manage them right get a new refresh token when the",
    "start": "2383520",
    "end": "2390000"
  },
  {
    "text": "other expired that is an open source library i wrote which is available on the internet",
    "start": "2390000",
    "end": "2397200"
  },
  {
    "text": "and then the last interesting point is now your front-end wants to call apis right um and there are two",
    "start": "2397200",
    "end": "2405680"
  },
  {
    "text": "types of apis in my mind so when you know when you start refactoring your application to use this pattern you",
    "start": "2405680",
    "end": "2411680"
  },
  {
    "text": "realize there's a whole bunch of apis i'm calling which are exclusive for my front and no one else calls them right",
    "start": "2411680",
    "end": "2418480"
  },
  {
    "text": "so what's the point of putting them onto a shared server i can just put them in the back end and i i don't even have to",
    "start": "2418480",
    "end": "2424000"
  },
  {
    "text": "go cross-site for that right um and there is probably and there's also the",
    "start": "2424000",
    "end": "2429680"
  },
  {
    "text": "the case of remote apis where an api is shared between multiple front-ends so it",
    "start": "2429680",
    "end": "2436000"
  },
  {
    "text": "must be on a shared server and in that case then the back end will help you to proxy those requests over and send the",
    "start": "2436000",
    "end": "2442480"
  },
  {
    "text": "response back to the to the front end and the very last thing is the ui",
    "start": "2442480",
    "end": "2448880"
  },
  {
    "text": "okay so choose whatever ui you like you know could be razer could be mvc could be react",
    "start": "2448880",
    "end": "2454800"
  },
  {
    "text": "could be angular could be blazer doesn't matter right it's just something in the browser that shows",
    "start": "2454800",
    "end": "2460640"
  },
  {
    "text": "colored pictures yeah good",
    "start": "2460640",
    "end": "2466800"
  },
  {
    "text": "so yeah i just mentioned that um so what are the building blocks if you",
    "start": "2466800",
    "end": "2472480"
  },
  {
    "text": "want to build a bff back end yourself um first of all you would need eight minute course help static files right to",
    "start": "2472480",
    "end": "2479760"
  },
  {
    "text": "serve your static assets down to the browser html javascript css all these things",
    "start": "2479760",
    "end": "2484960"
  },
  {
    "text": "you would need the asp.net core open the connect authentication handler to do the coordination to the authentication",
    "start": "2484960",
    "end": "2490800"
  },
  {
    "text": "system and token system and you would need the cookie handler to do all of the same side cookies and default",
    "start": "2490800",
    "end": "2497359"
  },
  {
    "text": "reprotection and so on okay so that's all there if you've done this before you",
    "start": "2497359",
    "end": "2504400"
  },
  {
    "text": "know what what i'm showing here that's the openid connect handler you just connect it to your to your company authentication system",
    "start": "2504400",
    "end": "2511440"
  },
  {
    "text": "okay once the authentication is done with that system you need to start managing",
    "start": "2511440",
    "end": "2518160"
  },
  {
    "text": "the session as i said the session is a part of asp.net all you basically need to give the front end",
    "start": "2518160",
    "end": "2524880"
  },
  {
    "text": "is a way to trigger the login process right and that's how you do that",
    "start": "2524880",
    "end": "2530079"
  },
  {
    "text": "basically by providing um an end point in your back end",
    "start": "2530079",
    "end": "2535839"
  },
  {
    "text": "and if javascript or whatever goes to that end point you trigger the login server side",
    "start": "2535839",
    "end": "2540960"
  },
  {
    "text": "and you you do the same for the logout okay and after the login you then just use the standard cookie handling asp.net",
    "start": "2540960",
    "end": "2547440"
  },
  {
    "text": "core to set the cookie you see they have support for same side cookies and all of that so you can make this really secure",
    "start": "2547440",
    "end": "2555119"
  },
  {
    "text": "let me show you then",
    "start": "2555119",
    "end": "2557920"
  },
  {
    "text": "so we're here",
    "start": "2562000",
    "end": "2565800"
  },
  {
    "text": "so you see this is basically just a just a normal asp.net core web web application okay",
    "start": "2570400",
    "end": "2577599"
  },
  {
    "text": "the only difference is that we don't have server side ui the ui is all javascript yeah",
    "start": "2577599",
    "end": "2584160"
  },
  {
    "text": "so um and you see all the configuration going on here here's my open id connect plumbing here's my",
    "start": "2584160",
    "end": "2591119"
  },
  {
    "text": "cookie plumbing with the same side settings and so on so when i when i run this",
    "start": "2591119",
    "end": "2597839"
  },
  {
    "text": "it's the front end host",
    "start": "2597839",
    "end": "2601960"
  },
  {
    "text": "you see that is everyone needs a to-do list right so um now if if i want to start the",
    "start": "2606880",
    "end": "2613440"
  },
  {
    "text": "application and log in the user you can see when i hover over here all this login button really does is it does it does a redirect to a local endpoint",
    "start": "2613440",
    "end": "2620000"
  },
  {
    "text": "called login okay and then this local endpoint on the server side will trigger",
    "start": "2620000",
    "end": "2627040"
  },
  {
    "text": "the login to the authentication system just like before okay",
    "start": "2627040",
    "end": "2633280"
  },
  {
    "text": "um login and now i'm logged in",
    "start": "2633280",
    "end": "2639040"
  },
  {
    "text": "um what do i have in my in my browser now nonsense",
    "start": "2639040",
    "end": "2644960"
  },
  {
    "text": "um no cookies in session store right all i",
    "start": "2644960",
    "end": "2650160"
  },
  {
    "text": "sorry no no data in session store but i have this bff cookie right and you can",
    "start": "2650160",
    "end": "2655440"
  },
  {
    "text": "see it has it is secure it's http only meaning no javascript that has access to it and the same side mode is strict",
    "start": "2655440",
    "end": "2661920"
  },
  {
    "text": "which is the highest mode you can get for cross-site request forgery protection",
    "start": "2661920",
    "end": "2667920"
  },
  {
    "text": "right so in other words what this is now doing is it it just allows you to call back to your back end and nothing else",
    "start": "2667920",
    "end": "2674960"
  },
  {
    "text": "okay you're basically sandboxing the front end to be only able to call the back end",
    "start": "2674960",
    "end": "2680160"
  },
  {
    "text": "right um so if i want to log out again you see same same thing i just invoke a local",
    "start": "2680160",
    "end": "2687520"
  },
  {
    "text": "logout endpoint so if i do that i'm back here",
    "start": "2687520",
    "end": "2693520"
  },
  {
    "text": "and i'm locked out let's look log back in",
    "start": "2693520",
    "end": "2697599"
  },
  {
    "text": "and if the front end needs to know who the user is right for personalization",
    "start": "2700400",
    "end": "2706000"
  },
  {
    "text": "reasons like here like logged in as bob smith things like that right there is a local endpoint on the server that",
    "start": "2706000",
    "end": "2712240"
  },
  {
    "text": "basically returns whatever session information you want to return back to the client and you see my ui skills are really not",
    "start": "2712240",
    "end": "2719920"
  },
  {
    "text": "so good um but you see basically it gives you back things like what's the name of the user you know and you can",
    "start": "2719920",
    "end": "2725599"
  },
  {
    "text": "put in arbitrary stuff here but it's only accessible it's protected by the same side cookie and only the front end",
    "start": "2725599",
    "end": "2732319"
  },
  {
    "text": "can retrieve that information and no one else cool so that's working it's great",
    "start": "2732319",
    "end": "2738880"
  },
  {
    "text": "um [Music] let's go back what else do we need",
    "start": "2738880",
    "end": "2744800"
  },
  {
    "text": "yeah we've just seen that oh by the way there's a great trick you know like one of the challenges we have",
    "start": "2744800",
    "end": "2751280"
  },
  {
    "text": "was uh session change notifications right so how does the front end know if",
    "start": "2751280",
    "end": "2757280"
  },
  {
    "text": "the user has signed out on the server maybe in a different application yeah and since this iframe trick is not",
    "start": "2757280",
    "end": "2763440"
  },
  {
    "text": "working anymore you can you know you can come up with something really fancy like some sort of signalr thing right that",
    "start": "2763440",
    "end": "2769760"
  },
  {
    "text": "gives you a notification from the server back down um very nice starting with dot net 6.0",
    "start": "2769760",
    "end": "2776560"
  },
  {
    "text": "there is a way now that you can make requests to the server without",
    "start": "2776560",
    "end": "2782800"
  },
  {
    "text": "triggering [Music] sliding exploration cookies so let's say for example you want to have like a uh",
    "start": "2782800",
    "end": "2789440"
  },
  {
    "text": "every minute you want to go to the server so like is the user still logged in is user still logged in right if you would do that then you would if the",
    "start": "2789440",
    "end": "2795680"
  },
  {
    "text": "cookie is sliding you would prolong the session every time you're doing that right starting with dotnet 8.",
    "start": "2795680",
    "end": "2802480"
  },
  {
    "text": "core 6 there's now a way how you can suppress this so you really can check is the user",
    "start": "2802480",
    "end": "2808560"
  },
  {
    "text": "still logged in without touching the server side session which is quite nice um",
    "start": "2808560",
    "end": "2815640"
  },
  {
    "text": "right now now who does um how what what's the",
    "start": "2816000",
    "end": "2822079"
  },
  {
    "text": "modern solution for fashion lockout notifications to the",
    "start": "2822079",
    "end": "2827200"
  },
  {
    "text": "back end well there was a spec that is around for quite a while but nobody implemented it",
    "start": "2827200",
    "end": "2833200"
  },
  {
    "text": "um because people were relying on another iframe based approach that doesn't work anymore which was called",
    "start": "2833200",
    "end": "2839200"
  },
  {
    "text": "front channel notifications there's now a um another stack which is called back channel notifications that if you have a",
    "start": "2839200",
    "end": "2845280"
  },
  {
    "text": "good token server they can just basically not notify the back end hey the user session has ended which means",
    "start": "2845280",
    "end": "2851040"
  },
  {
    "text": "the back end ends the session of the user the next time you ask for the session it will say it's gone that's how",
    "start": "2851040",
    "end": "2856240"
  },
  {
    "text": "you can trickle down um session change notifications from the token system down to",
    "start": "2856240",
    "end": "2862000"
  },
  {
    "text": "the ui now asp.net core does not implement this",
    "start": "2862000",
    "end": "2867280"
  },
  {
    "text": "right now because they would you know they didn't see a need but you know what",
    "start": "2867280",
    "end": "2873359"
  },
  {
    "text": "microsoft's big authentication product called azure ad is always by design cross site to",
    "start": "2873359",
    "end": "2882319"
  },
  {
    "text": "your applications right because your application runs on mycompany.com and azure red runs on",
    "start": "2882319",
    "end": "2887960"
  },
  {
    "text": "login.microsoft.com right all of the things i just mentioned to you cross-site iframes notifications will",
    "start": "2887960",
    "end": "2894000"
  },
  {
    "text": "not work anymore when google pulls the trigger so you can be sure that pretty soon this",
    "start": "2894000",
    "end": "2899200"
  },
  {
    "text": "will be part of asp.net core built in or you just use our implementation",
    "start": "2899200",
    "end": "2904480"
  },
  {
    "text": "good um let's talk about the last thing calling apis and and i already did that",
    "start": "2904480",
    "end": "2909920"
  },
  {
    "text": "right so my my to-do list thing over actually i didn't i think yeah i did not call an api yet",
    "start": "2909920",
    "end": "2915839"
  },
  {
    "text": "right so here is uh you know uh have a beer soon",
    "start": "2915839",
    "end": "2921839"
  },
  {
    "text": "okay that is calling a local to-do list controller right so i can now add my",
    "start": "2921839",
    "end": "2926960"
  },
  {
    "text": "to-do's and delete them and so on um but this to-do controller as you can see",
    "start": "2926960",
    "end": "2932960"
  },
  {
    "text": "is local to my application okay so i'm not even crossing a side boundary which means i",
    "start": "2932960",
    "end": "2939359"
  },
  {
    "text": "don't even need oauth access tokens because i'm just doing a call to the same side which is protected by the cookie which is all good okay",
    "start": "2939359",
    "end": "2948000"
  },
  {
    "text": "and you can even make that even stronger by by a nice little trick let me show",
    "start": "2948240",
    "end": "2953359"
  },
  {
    "text": "you that um it it sounds silly and i didn't believe",
    "start": "2953359",
    "end": "2960079"
  },
  {
    "text": "it to start with but basically when you're doing the the back end call to your local api endpoint yeah you are all",
    "start": "2960079",
    "end": "2966480"
  },
  {
    "text": "automatically protected by same side cookies okay that is what we get from from the browser for free",
    "start": "2966480",
    "end": "2972960"
  },
  {
    "text": "but what if you even want to protect yourself against other sub domains in your on your top level domain",
    "start": "2972960",
    "end": "2978800"
  },
  {
    "text": "right um and the reasons might be manifold yeah um you can just add a header and you can",
    "start": "2978800",
    "end": "2986400"
  },
  {
    "text": "call this header whatever you want and you can set the value to whatever you want yeah but basically what that means",
    "start": "2986400",
    "end": "2991839"
  },
  {
    "text": "is by virtue of doing an ajax call from the browser that contains a cookie and a custom",
    "start": "2991839",
    "end": "2999119"
  },
  {
    "text": "header the browser will always trigger course preflight requests",
    "start": "2999119",
    "end": "3006160"
  },
  {
    "text": "okay the course is the thing that would allow you to do cross-site api calls right we don't want that we don't want",
    "start": "3006960",
    "end": "3013280"
  },
  {
    "text": "cross-site api because we want to prohibit them okay so so when you're doing a cross-site api call the browser uses",
    "start": "3013280",
    "end": "3019839"
  },
  {
    "text": "this thing called course cross-origin resource sharing there are two modes in course um one mode is for get requests",
    "start": "3019839",
    "end": "3026720"
  },
  {
    "text": "where they basically just do the get request and then expect a certain header to come back from the server and only if",
    "start": "3026720",
    "end": "3032160"
  },
  {
    "text": "the headers match they pass the response down to javascript that is the the easiest one but for more complicated",
    "start": "3032160",
    "end": "3039760"
  },
  {
    "text": "calls and that's exactly that thing makes it more complicated from a browser point of view",
    "start": "3039760",
    "end": "3045119"
  },
  {
    "text": "they first asked the server are you okay with me making this call and only if you",
    "start": "3045119",
    "end": "3050240"
  },
  {
    "text": "say yes i will actually do the call why is this better now remember specter attacks",
    "start": "3050240",
    "end": "3057200"
  },
  {
    "text": "right specter attacks means you probably can read the ram of the browser process",
    "start": "3057200",
    "end": "3062720"
  },
  {
    "text": "so it would be better if the data wouldn't even ever come to the browser in the first place right so that is",
    "start": "3062720",
    "end": "3069440"
  },
  {
    "text": "you know it's beauty so yeah so just by adding this static",
    "start": "3069440",
    "end": "3074880"
  },
  {
    "text": "header here you have protected yourself against even same side attacks",
    "start": "3074880",
    "end": "3080880"
  },
  {
    "text": "right where uh subdomain one in your company has some dodgy code running that attacks",
    "start": "3080880",
    "end": "3087520"
  },
  {
    "text": "subdomain two on the same company yeah or maybe your sub domain was stolen right have you ever heard of sub sub",
    "start": "3087520",
    "end": "3093119"
  },
  {
    "text": "domain takeover attacks that's how attackers can basically steal a subdomain from you because you have a",
    "start": "3093119",
    "end": "3098800"
  },
  {
    "text": "dangling dns pointer pointing to azure and they just have to register the azure website with the same name and suddenly",
    "start": "3098800",
    "end": "3104240"
  },
  {
    "text": "they run code on your domain these things exist i told you the web is not a peaceful",
    "start": "3104240",
    "end": "3111119"
  },
  {
    "text": "place okay so that's how you call local apis no need for access tokens it's just",
    "start": "3111119",
    "end": "3117760"
  },
  {
    "text": "protected by cookie and anti-forge reprotection so what if you want to call external apis or remote",
    "start": "3117760",
    "end": "3125040"
  },
  {
    "text": "apis well you know essentially what you need to do is you need to do reverse proxying",
    "start": "3125040",
    "end": "3130160"
  },
  {
    "text": "okay that doesn't sound sexy but it works yeah and how you do the reverse boxing",
    "start": "3130160",
    "end": "3135680"
  },
  {
    "text": "totally up to you there are many many ways of doing that i like this new thing here have you heard of yap",
    "start": "3135680",
    "end": "3142400"
  },
  {
    "text": "which is a really stupid name it's called yet another reverse proxy",
    "start": "3142400",
    "end": "3148078"
  },
  {
    "text": "but it's easy to google believe me yap will be the first hit when you google for yap right because i guess the app is",
    "start": "3148400",
    "end": "3154000"
  },
  {
    "text": "just you know whatever anyways it's a microsoft product and the idea is that the reverse proxy is just a middleware",
    "start": "3154000",
    "end": "3161599"
  },
  {
    "text": "in your host meaning you have an in-app reverse proxy that you can configure in a way saying like hey when a request",
    "start": "3161599",
    "end": "3168240"
  },
  {
    "text": "comes in on slash api forward that to another server get the response back and",
    "start": "3168240",
    "end": "3173280"
  },
  {
    "text": "send the response back to the front end and the front end doesn't doesn't does never know even that this",
    "start": "3173280",
    "end": "3179760"
  },
  {
    "text": "was a remote call it all looks like a local api endpoint it's great right",
    "start": "3179760",
    "end": "3185760"
  },
  {
    "text": "yeah so that's exactly what we did as well so you see let's say",
    "start": "3185760",
    "end": "3191040"
  },
  {
    "text": "let's say we remove the to-do controller from our front end here and i go to my program cs you see here",
    "start": "3191040",
    "end": "3198400"
  },
  {
    "text": "sorry startup it's now called or it was called um you see here at the end um i just",
    "start": "3198400",
    "end": "3204720"
  },
  {
    "text": "removed the local api endpoint altogether and then i replace that with what we",
    "start": "3204720",
    "end": "3210640"
  },
  {
    "text": "call a remote api endpoint and that is utilizing yap under the cover so yap is not like a",
    "start": "3210640",
    "end": "3216640"
  },
  {
    "text": "server thing it's it's it's an api right that you can use yourself and what this basically says is whenever a call",
    "start": "3216640",
    "end": "3223440"
  },
  {
    "text": "comes in on slash to do's on the local host forward that call to this server",
    "start": "3223440",
    "end": "3228800"
  },
  {
    "text": "here oh and by the way because now we are on a cross-site scenario please attach the current access token of the",
    "start": "3228800",
    "end": "3234559"
  },
  {
    "text": "user so it all just works protected by oauth",
    "start": "3234559",
    "end": "3239599"
  },
  {
    "text": "right so if i run this again now sorry run the back end first which now has the to-do",
    "start": "3239599",
    "end": "3244880"
  },
  {
    "text": "controller yeah and run the front end",
    "start": "3244880",
    "end": "3250119"
  },
  {
    "text": "run the front end again",
    "start": "3250640",
    "end": "3253680"
  },
  {
    "text": "okay and as you can see i can still use my to do api the front end is unchanged it",
    "start": "3257200",
    "end": "3263920"
  },
  {
    "text": "doesn't know anything about this but our api has moved to a completely different server and is now protected by oauth so that",
    "start": "3263920",
    "end": "3270240"
  },
  {
    "text": "other clients can call it as well using oauth maybe server to server maybe from another application maybe maybe maybe",
    "start": "3270240",
    "end": "3276240"
  },
  {
    "text": "from a mobile app whatever right but the first hop front end to bff is",
    "start": "3276240",
    "end": "3282079"
  },
  {
    "text": "protected very strongly with same side cookies and anti-forgery and then on the server side we make a transition to a",
    "start": "3282079",
    "end": "3287920"
  },
  {
    "text": "server to server call attach the access token get back to result and show that back to the ui",
    "start": "3287920",
    "end": "3293760"
  },
  {
    "text": "okay",
    "start": "3293760",
    "end": "3296000"
  },
  {
    "text": "um yeah that was it so yeah that that was the thing i was",
    "start": "3301520",
    "end": "3307040"
  },
  {
    "text": "working on for the last year basically triggered by various customer problems and once we solved it",
    "start": "3307040",
    "end": "3314240"
  },
  {
    "text": "the first time i started to see the pattern here and that's where we turned it into a framework",
    "start": "3314240",
    "end": "3319359"
  },
  {
    "text": "but that's that's my conclusion okay so i've i'm i'm old enough and i have enough gray hair to to remember the",
    "start": "3319359",
    "end": "3326079"
  },
  {
    "text": "cookie era and the token era and they both were problematic okay",
    "start": "3326079",
    "end": "3332160"
  },
  {
    "text": "and this here i think the first time i think this makes sense yeah do a clean",
    "start": "3332160",
    "end": "3337920"
  },
  {
    "text": "separation of concerns do your ui in the browser do your security on the server",
    "start": "3337920",
    "end": "3345838"
  },
  {
    "text": "any questions yep",
    "start": "3346240",
    "end": "3352160"
  },
  {
    "text": "you mean like if somebody steals the cookie well that was always a concern right",
    "start": "3361280",
    "end": "3366720"
  },
  {
    "text": "that would mean that they have some some sort of um local access to your hard disk maybe",
    "start": "3366720",
    "end": "3372720"
  },
  {
    "text": "yeah this this this doesn't solve that problem yeah",
    "start": "3372720",
    "end": "3378160"
  },
  {
    "text": "the yap actually does support web sockets and grcp",
    "start": "3388319",
    "end": "3395200"
  },
  {
    "text": "yeah any other questions good then",
    "start": "3395200",
    "end": "3401839"
  },
  {
    "text": "almost on time thank you and have a great conference",
    "start": "3401839",
    "end": "3407400"
  }
]