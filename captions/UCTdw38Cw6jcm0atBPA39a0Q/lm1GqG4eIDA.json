[
  {
    "text": "hey everybody thank you so much for coming to my talk i'm i'm very excited to be here um and i",
    "start": "4240",
    "end": "12000"
  },
  {
    "text": "am here today to talk to you about this thing which is a wearable live",
    "start": "12000",
    "end": "19359"
  },
  {
    "text": "captioning mask that hopefully as you can see is live captioning what i'm saying",
    "start": "19359",
    "end": "27599"
  },
  {
    "text": "it's got a flexible led array inside it which is mounted actually inside the",
    "start": "27680",
    "end": "33600"
  },
  {
    "text": "mask but you could perhaps put it on a t-shirt or on a bag or some other",
    "start": "33600",
    "end": "39760"
  },
  {
    "text": "some other wearable item but before we delve into the tech let me introduce myself",
    "start": "39760",
    "end": "46239"
  },
  {
    "text": "my name is joe franchetti and i am a developer advocate at abele",
    "start": "46239",
    "end": "51440"
  },
  {
    "text": "enably is an edge messaging platform which helps developers like yourselves",
    "start": "51440",
    "end": "56480"
  },
  {
    "text": "to build live and collaborative experiences we have a whole suite of sdks and apis",
    "start": "56480",
    "end": "62960"
  },
  {
    "text": "that give you the freedom and flexibility to power apps like chat or delivery tracking or multiplayer games",
    "start": "62960",
    "end": "70799"
  },
  {
    "text": "or collaborative document editing for millions of connected devices at the same time",
    "start": "70799",
    "end": "77040"
  },
  {
    "text": "and i'm primarily a web developer but i do also occasionally dabble in iot",
    "start": "77040",
    "end": "83600"
  },
  {
    "text": "i put leds in my wedding dress and i made a christmas jumper that displays a",
    "start": "83600",
    "end": "89759"
  },
  {
    "text": "different graphic depending on what christmas tune is playing at the time",
    "start": "89759",
    "end": "94880"
  },
  {
    "text": "and i have to admit to a personal desire to see more",
    "start": "94880",
    "end": "100640"
  },
  {
    "text": "products like this on the market and that personal reason is because of my mother",
    "start": "100640",
    "end": "106159"
  },
  {
    "text": "so this is my mum mama franchetti and she's a smiley sociable quick-witted",
    "start": "106159",
    "end": "113280"
  },
  {
    "text": "woman who loves a good natter with her mates but she's also been steadily losing her",
    "start": "113280",
    "end": "118399"
  },
  {
    "text": "hearing over the last few years she went to too many rock concerts when she was younger",
    "start": "118399",
    "end": "124000"
  },
  {
    "text": "and losing her hearing has been an incredibly isolating experience for her as i'm sure it is for many people",
    "start": "124000",
    "end": "131200"
  },
  {
    "text": "she relies heavily on lip reading and clear enunciation and you know what makes lip reading and speaking clearly",
    "start": "131200",
    "end": "138640"
  },
  {
    "text": "impossible wearing a mask so if she was struggling before",
    "start": "138640",
    "end": "144239"
  },
  {
    "text": "corona hit everybody wearing a mask has made it almost impossible for her to go about",
    "start": "144239",
    "end": "150000"
  },
  {
    "text": "daily life she can't socialize safely with her friends and hear them at the same time",
    "start": "150000",
    "end": "155599"
  },
  {
    "text": "she can't understand people in shops and people have a tendency to become rude or brush her off when she asks them to",
    "start": "155599",
    "end": "161840"
  },
  {
    "text": "repeat themselves she gets quite self-conscious about it and occasionally she'll just try and",
    "start": "161840",
    "end": "167440"
  },
  {
    "text": "style out having not heard you at all and you'll be like mom you didn't hear me did you and she'll be like",
    "start": "167440",
    "end": "174319"
  },
  {
    "text": "so i have a couple of asks for you during this talk and the first one is this if anyone ever asks you to repeat",
    "start": "174560",
    "end": "181440"
  },
  {
    "text": "yourself please don't say oh never mind or it doesn't matter it's really frustrating being able to hear only half",
    "start": "181440",
    "end": "188560"
  },
  {
    "text": "of the conversation and as we've traversed her hearing loss one thing's really struck me and that's",
    "start": "188560",
    "end": "195200"
  },
  {
    "text": "that as developers as a whole we're really not doing the best job we possibly could at making assistive",
    "start": "195200",
    "end": "202080"
  },
  {
    "text": "technologies and making what we call aging technologies",
    "start": "202080",
    "end": "207280"
  },
  {
    "text": "uh my mom has a cochlear implant which is a really cool device it's inserted",
    "start": "207280",
    "end": "212640"
  },
  {
    "text": "it's a processor inserted directly into her head and it has a little battery that clips over the top",
    "start": "212640",
    "end": "218159"
  },
  {
    "text": "and she can stream audio directly from her devices into her head she doesn't",
    "start": "218159",
    "end": "223680"
  },
  {
    "text": "have to wear headphones anymore like super cool like my mom is a cyborg",
    "start": "223680",
    "end": "229040"
  },
  {
    "text": "but do you know what happened so first of all the app only runs on ios",
    "start": "229040",
    "end": "236879"
  },
  {
    "text": "don't know why why why is their development team not able to make it run on android as well so she",
    "start": "236879",
    "end": "242000"
  },
  {
    "text": "had to swap phones and a year ago ios released an update",
    "start": "242000",
    "end": "247920"
  },
  {
    "text": "that did something incompatible with the app and everybody who had this particular cochlear implant had a",
    "start": "247920",
    "end": "253519"
  },
  {
    "text": "screaming noise streamed directly into their head for a whole day",
    "start": "253519",
    "end": "259040"
  },
  {
    "text": "until an update was released and we just really need to do better than",
    "start": "259040",
    "end": "265520"
  },
  {
    "text": "this generally uh i know assistive technologies aren't very sexy so they",
    "start": "265520",
    "end": "271199"
  },
  {
    "text": "don't get the attention that the more glamorous engineering jobs get but goodness we",
    "start": "271199",
    "end": "276479"
  },
  {
    "text": "can't be streaming screaming into people's heads for a whole day so my second ask of the talk is this",
    "start": "276479",
    "end": "284240"
  },
  {
    "text": "let's put a little bit of effort into accessibility and think about our fellow humans um",
    "start": "284240",
    "end": "289360"
  },
  {
    "text": "and let's make some really cool assistive tech so story time is almost over i promise",
    "start": "289360",
    "end": "296400"
  },
  {
    "text": "but i was really worried for my mum she felt even more isolated than the rest of us did during lockdown",
    "start": "296400",
    "end": "302320"
  },
  {
    "text": "and assistive technologies that run on her phone meant that she had to be looking down at her phone as she was speaking to people and people often",
    "start": "302320",
    "end": "308560"
  },
  {
    "text": "thought that meant she'd clocked out of the conversation or was busy so then they'd turn and start talking to",
    "start": "308560",
    "end": "313840"
  },
  {
    "text": "somebody else so i wanted to build something that she could wear or that we could all wear",
    "start": "313840",
    "end": "320720"
  },
  {
    "text": "on our faces so that she'd be able to read what i was saying and look me in the eye while she was speaking to me",
    "start": "320720",
    "end": "327280"
  },
  {
    "text": "and you know we're all developers we like to solve problems i wanted to be able to fix this problem",
    "start": "327280",
    "end": "333919"
  },
  {
    "text": "for her and inspiration struck me at the weirdest of places i was in cyberdog in",
    "start": "333919",
    "end": "340320"
  },
  {
    "text": "camden if you're visiting london for ndc it's well worth giving camden market a visit",
    "start": "340320",
    "end": "346639"
  },
  {
    "text": "and there you will find this shop which is called cyberdog which sells primarily rave gear",
    "start": "346639",
    "end": "353120"
  },
  {
    "text": "so stuff you can wear to raves and they were selling this thing which is a mask with leds in it",
    "start": "353120",
    "end": "360240"
  },
  {
    "text": "and the next slide has some animations and some flashing i realize this content warning is a bit redundant when this is",
    "start": "360240",
    "end": "366479"
  },
  {
    "text": "right here um so it had a high enough resolution",
    "start": "366479",
    "end": "371759"
  },
  {
    "text": "that it could do these really cool animations and i bought one immediately thinking",
    "start": "371759",
    "end": "377199"
  },
  {
    "text": "what if i could put text on there i could signal to my mum what i was saying so that she could look me in the face as",
    "start": "377199",
    "end": "383199"
  },
  {
    "text": "she was talking to me but the display in the mask came with a built-in processor it came with its own",
    "start": "383199",
    "end": "390560"
  },
  {
    "text": "bluetooth app that was written in chinese i",
    "start": "390560",
    "end": "395759"
  },
  {
    "text": "absolutely could not backwards engineer um trying to sniff the bluetooth it was a nightmare i checked how the mask was",
    "start": "395759",
    "end": "402560"
  },
  {
    "text": "wired up it was very clever but very unintelligible to",
    "start": "402560",
    "end": "408479"
  },
  {
    "text": "me so not wanting to be beaten i thought i can make this myself",
    "start": "408479",
    "end": "414720"
  },
  {
    "text": "so if we break the mask down into its component pieces then what we really need is a flexible led array of some",
    "start": "414720",
    "end": "422160"
  },
  {
    "text": "kind made up of addressable leds and when we talk about addressable leds",
    "start": "422160",
    "end": "427520"
  },
  {
    "text": "what we mean is that each led in the array has its own numeric address so",
    "start": "427520",
    "end": "432639"
  },
  {
    "text": "that we can send data to each led individually we need a way to control these leds so a",
    "start": "432639",
    "end": "440639"
  },
  {
    "text": "small microprocessor processor board of some kind and we will need a small",
    "start": "440639",
    "end": "446560"
  },
  {
    "text": "battery that we can hide somewhere on our person which is going to power the board and the display",
    "start": "446560",
    "end": "453759"
  },
  {
    "text": "all of these things need to be small enough to fit in a wearable and then we'll also need a microphone that can",
    "start": "453759",
    "end": "459840"
  },
  {
    "text": "pick up the speech and we'll need some software that's going to do the speech to text",
    "start": "459840",
    "end": "465759"
  },
  {
    "text": "so the led array that i have in here is one i soldered up myself from led strip",
    "start": "465759",
    "end": "472400"
  },
  {
    "text": "it's 28 by 8 array of neopixels neopixels are just very very small rgb",
    "start": "472400",
    "end": "478560"
  },
  {
    "text": "leds they have their own little tiny processor on them which makes them addressable and makes it possible for",
    "start": "478560",
    "end": "483919"
  },
  {
    "text": "them to show any color you could possibly imagine sent with an rgb value very similar to",
    "start": "483919",
    "end": "489759"
  },
  {
    "text": "what we see in css all the time and it's flexible to a certain degree",
    "start": "489759",
    "end": "495280"
  },
  {
    "text": "and it can have small holes put in it for breathability and it can be powered by a really small microprocessor which",
    "start": "495280",
    "end": "501680"
  },
  {
    "text": "is this thing here this is the esp8266 and it's very small",
    "start": "501680",
    "end": "509599"
  },
  {
    "text": "so it can just about fit in a mask it can be powered by a usb battery so i'm using this thing here which is a",
    "start": "509599",
    "end": "516640"
  },
  {
    "text": "lipstick battery can easily fit in a pocket and that will charge that will power the mask for",
    "start": "516640",
    "end": "522959"
  },
  {
    "text": "about an hour uh it has wi-fi on the board you can see",
    "start": "522959",
    "end": "528880"
  },
  {
    "text": "that windy bit down the bottom is the wi-fi antenna and i could",
    "start": "528880",
    "end": "534480"
  },
  {
    "text": "have got a tiny little microphone and soldered that onto the board but honestly doing audio streaming plus",
    "start": "534480",
    "end": "540880"
  },
  {
    "text": "controlling the led array is perhaps a little bit too much for this tiny board but as i said it does have wi-fi and we",
    "start": "540880",
    "end": "548399"
  },
  {
    "text": "all carry phones around with us all day every day so why not outsource the microphone to the phone instead",
    "start": "548399",
    "end": "555440"
  },
  {
    "text": "i can make a web app which runs on the phone which will take the audio do the processing and then send the returned",
    "start": "555440",
    "end": "562560"
  },
  {
    "text": "text back to the microprocessor which will then display it on the array",
    "start": "562560",
    "end": "569920"
  },
  {
    "text": "so i used azure cognitive services to do my speech to text",
    "start": "569920",
    "end": "576399"
  },
  {
    "text": "i um made a web app which is using azure",
    "start": "576399",
    "end": "582320"
  },
  {
    "text": "cognitive services under the hood azure cognitive services is using the",
    "start": "582320",
    "end": "588320"
  },
  {
    "text": "get media api and if you've not used cognitive services before it's just it's",
    "start": "588320",
    "end": "593760"
  },
  {
    "text": "a suite of apis which allow us to do",
    "start": "593760",
    "end": "598800"
  },
  {
    "text": "to add ai capabilities to our apps and one of those capabilities obviously is speech to text",
    "start": "598800",
    "end": "605360"
  },
  {
    "text": "so the web app that i built is a very simple node app it uses a few different",
    "start": "605360",
    "end": "610399"
  },
  {
    "text": "node packages so we have the azure cognitive services speech sdk we have a driver that i had written for",
    "start": "610399",
    "end": "617279"
  },
  {
    "text": "a previous project which i extended a little bit for this particular project which is the driver",
    "start": "617279",
    "end": "623279"
  },
  {
    "text": "for the led array and then we're going to need some sort of transfer protocol to get the messages from the app to the",
    "start": "623279",
    "end": "629200"
  },
  {
    "text": "board the app itself is really basic the ui is quite boring here's what it looks like",
    "start": "629200",
    "end": "635839"
  },
  {
    "text": "we have a button to turn on the mic and start streaming the audio we have a box which shows the returned text as text",
    "start": "635839",
    "end": "642880"
  },
  {
    "text": "and then i have a visual representation of my led array for debugging because",
    "start": "642880",
    "end": "649120"
  },
  {
    "text": "it's a pain in the ass when you have to re-upload your code to your microprocessor and that takes five",
    "start": "649120",
    "end": "654720"
  },
  {
    "text": "minutes and then plug in a battery and all the rest of it so this visual version of the board really",
    "start": "654720",
    "end": "661440"
  },
  {
    "text": "useful for debugging and then i also have some settings for color and for scroll speed",
    "start": "661440",
    "end": "666880"
  },
  {
    "text": "so let's start by hooking up the start listening button and sending some data",
    "start": "666880",
    "end": "672959"
  },
  {
    "text": "so i wrapped the azure cognitive services sdk with this code here so as i",
    "start": "672959",
    "end": "678160"
  },
  {
    "text": "mentioned under the hood the acs speech to text api is using get user",
    "start": "678160",
    "end": "683920"
  },
  {
    "text": "media getusermedia has been in browsers for years now what it does is it prompts",
    "start": "683920",
    "end": "689440"
  },
  {
    "text": "the user for permission to use their microphone their camera",
    "start": "689440",
    "end": "694880"
  },
  {
    "text": "and once allowed it will start to collect a stream of data from their media devices obviously we're only using",
    "start": "694880",
    "end": "701920"
  },
  {
    "text": "the microphone here so when i open the app on my phone it will prompt me for microphone usage",
    "start": "701920",
    "end": "709680"
  },
  {
    "text": "and so once we've started once we've hit that start listening button",
    "start": "709680",
    "end": "715279"
  },
  {
    "text": "a function called stream speech from browser is called and this uses azure's uh from the from",
    "start": "715279",
    "end": "722399"
  },
  {
    "text": "default microphone input along with an authorization token function which will authenticate with azure and initialize",
    "start": "722399",
    "end": "730160"
  },
  {
    "text": "this speech recognizer and the speech recognizer is what is going to perform the speech recognition",
    "start": "730160",
    "end": "737760"
  },
  {
    "text": "and this will return an object which contains the text of what it is that's been said so what's been picked up by",
    "start": "737760",
    "end": "744399"
  },
  {
    "text": "the microphone and then i wrapped the azure cognitive",
    "start": "744399",
    "end": "749440"
  },
  {
    "text": "services speech sdk again with a class to provide it",
    "start": "749440",
    "end": "754800"
  },
  {
    "text": "with an api key then i register a call back on on text recognized and we will",
    "start": "754800",
    "end": "760800"
  },
  {
    "text": "talk about this a bit later the callback calls the matrix led driver",
    "start": "760800",
    "end": "768880"
  },
  {
    "text": "but for now let's talk a little bit about communicating with the hardware itself so how do we get the",
    "start": "768880",
    "end": "774639"
  },
  {
    "text": "transcription once we've got it back from azure cognitive services how do we get it from the app",
    "start": "774639",
    "end": "780639"
  },
  {
    "text": "to the microprocessor we need some kind of messaging protocol",
    "start": "780639",
    "end": "786480"
  },
  {
    "text": "and there is one that is used for iot devices which is called mqtt",
    "start": "786480",
    "end": "792959"
  },
  {
    "text": "it's a lightweight publish and subscribe protocol designed specifically for iot",
    "start": "792959",
    "end": "798160"
  },
  {
    "text": "devices it's very high latency it works really well with unreliable networks which is great because",
    "start": "798160",
    "end": "805040"
  },
  {
    "text": "who knows we might be on a 3g connection and in order to use mqtt we will need",
    "start": "805040",
    "end": "810240"
  },
  {
    "text": "some kind of broker and this is the service that is responsible for dispatching messages and",
    "start": "810240",
    "end": "815839"
  },
  {
    "text": "making sure they are received by the correct recipient so in this case the web app is the",
    "start": "815839",
    "end": "822320"
  },
  {
    "text": "sender or the client and the microcontroller is the receiver",
    "start": "822320",
    "end": "827519"
  },
  {
    "text": "and i work at abele so i use the ably mqtt broker",
    "start": "827519",
    "end": "832800"
  },
  {
    "text": "the great thing about the abele sdk is that we can use the javascript sdk in our web",
    "start": "832800",
    "end": "839440"
  },
  {
    "text": "app and it automatically sends out messages over mqtt as well so all of this work is already done for us for",
    "start": "839440",
    "end": "845279"
  },
  {
    "text": "free as i mentioned before the microprocessor is really small which means",
    "start": "845279",
    "end": "852560"
  },
  {
    "text": "unsurprisingly it has quite limited processing power and very limited memory",
    "start": "852560",
    "end": "857680"
  },
  {
    "text": "as well as well so that means that the code that we run on it we want it to be as efficient as possible",
    "start": "857680",
    "end": "863680"
  },
  {
    "text": "so we want to avoid doing complicated things like text passing or",
    "start": "863680",
    "end": "869279"
  },
  {
    "text": "other similarly memory intensive tasks so parsing and splitting strings is",
    "start": "869279",
    "end": "875199"
  },
  {
    "text": "going to be quite costly uh it involves larger buffers than would really be ideal to run on a",
    "start": "875199",
    "end": "881040"
  },
  {
    "text": "microprocessor and you might be thinking",
    "start": "881040",
    "end": "886560"
  },
  {
    "text": "this sounds like premature performance optimization but if all of the memory on the board is",
    "start": "886560",
    "end": "892079"
  },
  {
    "text": "used for passing the messages it decreases the amount of memory that we have available to buffer incoming",
    "start": "892079",
    "end": "898320"
  },
  {
    "text": "messages so to solve this problem i used a binary messaging format which",
    "start": "898320",
    "end": "904240"
  },
  {
    "text": "will talk to the hardware and the browser app is going to create a specifically encoded message to send",
    "start": "904240",
    "end": "911279"
  },
  {
    "text": "strings to the device so let's have a look at that here most systems that you would write would",
    "start": "911279",
    "end": "917600"
  },
  {
    "text": "probably use json to serialize messages so",
    "start": "917600",
    "end": "923680"
  },
  {
    "text": "instead this app uses a binary format so",
    "start": "924000",
    "end": "929360"
  },
  {
    "text": "the order of the messages and the content of the bytes as they are received is",
    "start": "929360",
    "end": "934480"
  },
  {
    "text": "relevant to how the hardware is going to process the text so let's say for",
    "start": "934480",
    "end": "940880"
  },
  {
    "text": "for example if we wanted to scroll text on the display we might send a message from the browser that looks like this",
    "start": "940880",
    "end": "948560"
  },
  {
    "text": "but rather than sending it as json and then transmitting that as text we",
    "start": "948560",
    "end": "954560"
  },
  {
    "text": "need to encode the data to pack it down into the smallest message that we possibly can",
    "start": "954560",
    "end": "960720"
  },
  {
    "text": "and we want to be able to send those messages as raw bytes so i'm using here some control codes",
    "start": "960720",
    "end": "966959"
  },
  {
    "text": "from the ascii standard to provide header information in the messages that i'm sending",
    "start": "966959",
    "end": "972240"
  },
  {
    "text": "and because the message is a raw byte stream we don't need to then do extra passing of the messages on the hardware",
    "start": "972240",
    "end": "978000"
  },
  {
    "text": "it can just loop over the message bytes and run different processes depending on the byte that's being looped over at the",
    "start": "978000",
    "end": "984639"
  },
  {
    "text": "time and this is awesome because it takes the complexity of parsing text away from the",
    "start": "984639",
    "end": "990399"
  },
  {
    "text": "microprocessor completely all of that is done in the javascript",
    "start": "990399",
    "end": "995519"
  },
  {
    "text": "code in the web app which is much more capable of doing that work and it's also much easier to debug and",
    "start": "995519",
    "end": "1001759"
  },
  {
    "text": "to test so if we have a look at the table above we have",
    "start": "1001759",
    "end": "1008240"
  },
  {
    "text": "for example a byte offset number eight would represent a single character but the passer on the hardware is looking",
    "start": "1008480",
    "end": "1014720"
  },
  {
    "text": "out for the stx and the etx the the start and end uh markers",
    "start": "1014720",
    "end": "1020240"
  },
  {
    "text": "so what this means is that we can send any number of ascii characters in the space between those two to form a full",
    "start": "1020240",
    "end": "1026558"
  },
  {
    "text": "sentence or a message i don't know how many of you have worked",
    "start": "1026559",
    "end": "1032480"
  },
  {
    "text": "with hardware before but it is notoriously slow and difficult and frustrating",
    "start": "1032480",
    "end": "1040400"
  },
  {
    "text": "especially when you have to flash the rom of a physical device power it up look at it to test your code and",
    "start": "1040400",
    "end": "1046079"
  },
  {
    "text": "sometimes running in the arduino software is just quite frustrating although i'm told vs",
    "start": "1046079",
    "end": "1051840"
  },
  {
    "text": "code now can run a whole load of arduino stuff so that's cool",
    "start": "1051840",
    "end": "1057039"
  },
  {
    "text": "so to combat this in previous projects i'd already written a separate npm package which is the matrix driver to",
    "start": "1057039",
    "end": "1064160"
  },
  {
    "text": "try and solve the various quirks of the hardware",
    "start": "1064160",
    "end": "1069200"
  },
  {
    "text": "and it's this same code base that i'm using to scroll text this time but in previous iterations for example i made a",
    "start": "1069200",
    "end": "1076880"
  },
  {
    "text": "t-shirt that you could that you could basically do ms paint on so i needed to be able to send individual pixels worth",
    "start": "1076880",
    "end": "1082799"
  },
  {
    "text": "of data and then for the christmas jumper it was sending entire images",
    "start": "1082799",
    "end": "1088799"
  },
  {
    "text": "so this driver can do a whole load of different things but i needed to extend it to scroll text",
    "start": "1088799",
    "end": "1095360"
  },
  {
    "text": "which i will talk about in a little bit but for now let's take a look at actually hooking up the speech",
    "start": "1095360",
    "end": "1100799"
  },
  {
    "text": "recognition first so earlier on we registered a call back to on text recognize that called the",
    "start": "1100799",
    "end": "1107840"
  },
  {
    "text": "matrix driver what we didn't look at is how we then connect the browser to the led driver",
    "start": "1107840",
    "end": "1114880"
  },
  {
    "text": "using ably as the mqtt broker so there's a few things going on in this code",
    "start": "1114880",
    "end": "1120160"
  },
  {
    "text": "first of all we are making an instance of the able javascript sdk",
    "start": "1120160",
    "end": "1125360"
  },
  {
    "text": "we knew up an instance of the remote matrix led driver class",
    "start": "1125360",
    "end": "1130799"
  },
  {
    "text": "and that's just part of our display driver package it takes a display config which tells",
    "start": "1130799",
    "end": "1136640"
  },
  {
    "text": "the driver how big our display is and it also needs to know what transport",
    "start": "1136640",
    "end": "1142960"
  },
  {
    "text": "we're using so the implementation of the encoding protocol that i just mentioned earlier",
    "start": "1142960",
    "end": "1151120"
  },
  {
    "text": "so this feels like a lot of stuff but what it means is that",
    "start": "1151120",
    "end": "1158559"
  },
  {
    "text": "when we call the functions available in the matrix driver sdk it knows how to convert pixel locations",
    "start": "1158559",
    "end": "1165440"
  },
  {
    "text": "into absolute numbers that the neopixel hardware understands so if you think about an array",
    "start": "1165440",
    "end": "1172799"
  },
  {
    "text": "of leds which each have a number on it it's able to convert between a matrix",
    "start": "1172799",
    "end": "1178880"
  },
  {
    "text": "into what is basically a straight line that snakes through the hardware and it knows how to transmit the data",
    "start": "1178880",
    "end": "1185600"
  },
  {
    "text": "over mqtt so finally we need some code for the microprocessor that understands this",
    "start": "1185600",
    "end": "1192559"
  },
  {
    "text": "protocol and converts the packed binary data into calls to set those individual",
    "start": "1192559",
    "end": "1198080"
  },
  {
    "text": "neopixels and just if we were to visualize the entire",
    "start": "1198080",
    "end": "1204240"
  },
  {
    "text": "system this is kind of how it would look so let's talk about how we send those",
    "start": "1204240",
    "end": "1210559"
  },
  {
    "text": "compact messages and take a look at the display driver and talk about how it reads those messages",
    "start": "1210559",
    "end": "1217360"
  },
  {
    "text": "the led array driver as i mentioned was written for a previous project so it already has",
    "start": "1217440",
    "end": "1223840"
  },
  {
    "text": "some cool api calls so it can set an individual pixel with a single color and you can set the color",
    "start": "1223840",
    "end": "1230799"
  },
  {
    "text": "in hex or rgb we can also set it using just the x value so imagine",
    "start": "1230799",
    "end": "1238720"
  },
  {
    "text": "if we had a string of light snaking through it'll assume that the y is zero and we",
    "start": "1238720",
    "end": "1244240"
  },
  {
    "text": "can just set a single number or we can also set the entire display at",
    "start": "1244240",
    "end": "1250000"
  },
  {
    "text": "once using this sort of visual coordinate array which is super cool",
    "start": "1250000",
    "end": "1257520"
  },
  {
    "text": "we can even send entire images to the display as long as they're",
    "start": "1257520",
    "end": "1264080"
  },
  {
    "text": "small enough in pixel size to send um the christmas jumper that i made was 16 by 16 trying to make little christmas",
    "start": "1264080",
    "end": "1271760"
  },
  {
    "text": "emojis at 16 by 16 is a fun little task but we want the",
    "start": "1271760",
    "end": "1278320"
  },
  {
    "text": "driver to display scrolling text so we extended it to include a new api",
    "start": "1278320",
    "end": "1283840"
  },
  {
    "text": "text.scroll and we also want to potentially give it a color and a speed setting",
    "start": "1283840",
    "end": "1292480"
  },
  {
    "text": "so let's talk about how these new apis work the first thing that i had to do in",
    "start": "1292480",
    "end": "1299039"
  },
  {
    "text": "order to show text on the board was designed some kind of pixel font",
    "start": "1299039",
    "end": "1306799"
  },
  {
    "text": "this was a vague guesstimate at the characters that i would need to use most regularly",
    "start": "1306799",
    "end": "1312240"
  },
  {
    "text": "although i am now sad after having talked to some people here that i didn't put little emoji smiley faces in",
    "start": "1312240",
    "end": "1319039"
  },
  {
    "text": "that's a future upgrade um and then i converted each of the letters",
    "start": "1319039",
    "end": "1325440"
  },
  {
    "text": "in the array each of the letters in the font to an array of pixels so let's take the letter",
    "start": "1325440",
    "end": "1332320"
  },
  {
    "text": "n as an example if we convert this into",
    "start": "1332320",
    "end": "1338159"
  },
  {
    "text": "binary it's going to look like this where each of the off pixels is zero and each of the on pixels is one and",
    "start": "1338159",
    "end": "1346640"
  },
  {
    "text": "the final array for the character n will look like this",
    "start": "1346640",
    "end": "1352480"
  },
  {
    "text": "and here again is that array and what we've done is we've now got the four by",
    "start": "1354080",
    "end": "1360159"
  },
  {
    "text": "eight block as a single array but instead of encoding the entire",
    "start": "1360159",
    "end": "1366080"
  },
  {
    "text": "alphabet by hand because that would have taken a very long time um there's a javascript image",
    "start": "1366080",
    "end": "1373120"
  },
  {
    "text": "manipulation library called jimp which will actually do this for you it converted the",
    "start": "1373120",
    "end": "1378640"
  },
  {
    "text": "png of the font sheet into a long array containing each supported character",
    "start": "1378640",
    "end": "1383760"
  },
  {
    "text": "thank you very much chimp and if you look at the font image and",
    "start": "1383760",
    "end": "1389200"
  },
  {
    "text": "please imagine this is a long line of letters um i've taken liberties with",
    "start": "1389200",
    "end": "1394320"
  },
  {
    "text": "slide designs here you may have noticed that the characters aren't all the same width",
    "start": "1394320",
    "end": "1400320"
  },
  {
    "text": "and i did this because i think it looks nicer um slightly more legible slightly nicer",
    "start": "1400320",
    "end": "1406240"
  },
  {
    "text": "curling which is important but it means that the array of bits for",
    "start": "1406240",
    "end": "1412480"
  },
  {
    "text": "each letter also needs to have a width so that the",
    "start": "1412480",
    "end": "1418000"
  },
  {
    "text": "board will know where the starting position of each character is",
    "start": "1418000",
    "end": "1422799"
  },
  {
    "text": "but that's just an you know a little bit of extra data so we have an array now of starting",
    "start": "1423360",
    "end": "1429279"
  },
  {
    "text": "positions for each letter and we have an array of each of the letters and these two byte arrays are small enough to",
    "start": "1429279",
    "end": "1435679"
  },
  {
    "text": "actually be stored on the board itself and with this font array embedded on the device it's possible to write code that",
    "start": "1435679",
    "end": "1443279"
  },
  {
    "text": "then shows the letters as they are sent this means that instead of computing all",
    "start": "1443279",
    "end": "1448720"
  },
  {
    "text": "the individual pixel positions in the browser app and sending them one by one the micro",
    "start": "1448720",
    "end": "1453919"
  },
  {
    "text": "controller can actually handle that translation which means that we don't have to send the extra data over mqtt which is great",
    "start": "1453919",
    "end": "1461200"
  },
  {
    "text": "because we want to keep our messages as lightweight as we possibly can so cool now we have a font",
    "start": "1461200",
    "end": "1467279"
  },
  {
    "text": "we need a way to work out how to display that font on the array and as always",
    "start": "1467279",
    "end": "1472559"
  },
  {
    "text": "with hardware projects nothing is ever as simple as you want it to be because there are multiple different",
    "start": "1472559",
    "end": "1478880"
  },
  {
    "text": "ways the led arrays can be connected together so",
    "start": "1478880",
    "end": "1484159"
  },
  {
    "text": "because i sold it up this one myself in the mask um i know that that is created in a snake",
    "start": "1484159",
    "end": "1491200"
  },
  {
    "text": "that goes horizontally however this one that i bought here uh",
    "start": "1491200",
    "end": "1496720"
  },
  {
    "text": "is connected in a snake that goes vertically of course and we can also get",
    "start": "1496720",
    "end": "1502480"
  },
  {
    "text": "um displays like the one shown in uh graphic one there where the wire snakes",
    "start": "1502480",
    "end": "1509279"
  },
  {
    "text": "right the way back so it's sort of in reading order not only that but displays also",
    "start": "1509279",
    "end": "1516880"
  },
  {
    "text": "usually have connectors at both ends which means that the numbering could go from left to right or from right to left",
    "start": "1516880",
    "end": "1523520"
  },
  {
    "text": "top to bottom bottom to top it depends entirely on what display has been bought and i",
    "start": "1523520",
    "end": "1530480"
  },
  {
    "text": "would like other people to be able to take this and run with it themselves so i needed to encode a whole load of",
    "start": "1530480",
    "end": "1537039"
  },
  {
    "text": "variety of wiring patterns we need the board to be able to",
    "start": "1537039",
    "end": "1542559"
  },
  {
    "text": "translate from x y coordinates to the appropriate pixel id so that any",
    "start": "1542559",
    "end": "1547600"
  },
  {
    "text": "developers who want to make one of these themselves can do so um so once the coordinates are sent to",
    "start": "1547600",
    "end": "1554000"
  },
  {
    "text": "the hardware it can translate the coordinates into the correct pixel id based on the configuration that we sent",
    "start": "1554000",
    "end": "1561360"
  },
  {
    "text": "earlier when we told it how big it was so we set up some configuration on the",
    "start": "1561360",
    "end": "1566880"
  },
  {
    "text": "board like this",
    "start": "1566880",
    "end": "1571080"
  },
  {
    "text": "this is our configuration file which contains",
    "start": "1571919",
    "end": "1577120"
  },
  {
    "text": "which pin on the board we are sending the data out on it contains the width and the display",
    "start": "1577120",
    "end": "1583919"
  },
  {
    "text": "height of the board and then where we've connected in the first led",
    "start": "1583919",
    "end": "1589520"
  },
  {
    "text": "what kind of snake mode we're using and what kind of neopixel it is now this",
    "start": "1589520",
    "end": "1595279"
  },
  {
    "text": "has caught me out on previous projects before there's two main types of neopixel rgb and rgbw",
    "start": "1595279",
    "end": "1603039"
  },
  {
    "text": "rgb takes three colors rgbw takes four colors if you mix up the type that you",
    "start": "1603039",
    "end": "1608480"
  },
  {
    "text": "got you get some very odd things happening on the display don't let that one catch you out if",
    "start": "1608480",
    "end": "1613840"
  },
  {
    "text": "you're doing neopixel projects so when the message arrives at our",
    "start": "1613840",
    "end": "1619679"
  },
  {
    "text": "device it runs through an initial parsing block that interprets the message that the led driver sent it",
    "start": "1619679",
    "end": "1627039"
  },
  {
    "text": "checks the first byte for the control code and the second byte for the control mode",
    "start": "1627039",
    "end": "1633440"
  },
  {
    "text": "so are we sending text are we sending a picture are we sending individual",
    "start": "1633440",
    "end": "1638840"
  },
  {
    "text": "pixels and then we so if we get a t then we know that we are sending text to our",
    "start": "1638840",
    "end": "1645440"
  },
  {
    "text": "hardware and the microcontroller software is then able to set the individual pixels",
    "start": "1645440",
    "end": "1653520"
  },
  {
    "text": "and display this the font that is stored as variables in the arduino code",
    "start": "1653520",
    "end": "1661360"
  },
  {
    "text": "the missing piece that we haven't got yet is message handlers so the handlers are going to have to process the",
    "start": "1661360",
    "end": "1667200"
  },
  {
    "text": "incoming binary messages look up the font data that's stored on the board and then push the appropriate pixels to",
    "start": "1667200",
    "end": "1674240"
  },
  {
    "text": "the display and you can see on this slide that the text display code parses the bytes in",
    "start": "1674240",
    "end": "1681120"
  },
  {
    "text": "the order of the table that we talked about earlier so if you remember this little table here",
    "start": "1681120",
    "end": "1688480"
  },
  {
    "text": "so when a message to display text is received the code loops through each text character in the message and looks",
    "start": "1690320",
    "end": "1696480"
  },
  {
    "text": "up that character in the embedded font which is on the board the font data then gets returned",
    "start": "1696480",
    "end": "1703520"
  },
  {
    "text": "the font data that is returned from the font is the array that we saw earlier so like the letter n for example",
    "start": "1703520",
    "end": "1710720"
  },
  {
    "text": "prefixed by the width of the character in pixels and we will also add in a little space in",
    "start": "1710720",
    "end": "1716880"
  },
  {
    "text": "between each letter which is just a bunch of zeros",
    "start": "1716880",
    "end": "1722159"
  },
  {
    "text": "because the font data includes the width when the code iterates over subsequent characters it can then calculate where",
    "start": "1722159",
    "end": "1728640"
  },
  {
    "text": "it needs to start drawing at when we're showing a word on the screen so if we call the location of the",
    "start": "1728640",
    "end": "1736159"
  },
  {
    "text": "left edge of the letter the x position in the code each time a",
    "start": "1736159",
    "end": "1741279"
  },
  {
    "text": "character is drawn on the display we increment the x position till we know",
    "start": "1741279",
    "end": "1746720"
  },
  {
    "text": "when to draw the next letter and as the code loops all of the x y coordinates are returned from the font",
    "start": "1746720",
    "end": "1753919"
  },
  {
    "text": "we'll all have this x position making sure that the characters are drawn in the correct sequence",
    "start": "1753919",
    "end": "1760080"
  },
  {
    "text": "this will continue until we hit until x position hits the width of the display",
    "start": "1760080",
    "end": "1766720"
  },
  {
    "text": "and then we stop because there's no point in rendering characters that we can't see",
    "start": "1766720",
    "end": "1772000"
  },
  {
    "text": "um so that will write text to the display but we also need to scroll it",
    "start": "1772000",
    "end": "1777679"
  },
  {
    "text": "and scrolling the text is pretty much exactly the same but the x position is",
    "start": "1777679",
    "end": "1782960"
  },
  {
    "text": "going to start out at the right hand side of the display and move across to",
    "start": "1782960",
    "end": "1789360"
  },
  {
    "text": "the left so when a message is first received the x position is going to be equal to the",
    "start": "1789360",
    "end": "1795039"
  },
  {
    "text": "full display width so no pixels would be drawn as you can see in this top graphic here",
    "start": "1795039",
    "end": "1800480"
  },
  {
    "text": "then we increment the loop and decrement the x position by one",
    "start": "1800480",
    "end": "1805840"
  },
  {
    "text": "and we keep going through that loop decrementing until the exposition becomes",
    "start": "1805840",
    "end": "1811279"
  },
  {
    "text": "minus the width of the board so say we had a board that was 100 wide it'd be minus 100 which will scroll the text all",
    "start": "1811279",
    "end": "1817520"
  },
  {
    "text": "the way across the screen and you can see the code for that here",
    "start": "1817520",
    "end": "1822799"
  },
  {
    "text": "so if the message mode indicates scrolling text we start a while loop that updates the",
    "start": "1822799",
    "end": "1829360"
  },
  {
    "text": "scrolling position in the byte array and that represents our entire fonted",
    "start": "1829360",
    "end": "1834559"
  },
  {
    "text": "string so whatever it is that needs to be displayed and then starts looping",
    "start": "1834559",
    "end": "1839919"
  },
  {
    "text": "and it'll display a subset of the total data of the string until the final pixels are scrolled off the screen and",
    "start": "1839919",
    "end": "1845840"
  },
  {
    "text": "we see all of the text the cool thing is that as the animation is played the code pauses execution",
    "start": "1845840",
    "end": "1853520"
  },
  {
    "text": "every time it scrolls and this loop prevents control from being returned to the main arduino app",
    "start": "1853520",
    "end": "1859919"
  },
  {
    "text": "which would then trigger receiving mqtt messages which means that the code on the",
    "start": "1859919",
    "end": "1865840"
  },
  {
    "text": "hardware only ever draws pixels for the characters that will be visible on the display memory is saved by not converting every",
    "start": "1865840",
    "end": "1872720"
  },
  {
    "text": "character into pixels ahead of time and we can use mqtt itself as a buffer",
    "start": "1872720",
    "end": "1879200"
  },
  {
    "text": "without having to use up memory on the device so once we finish scrolling we can then receive sub subsequent messages",
    "start": "1879200",
    "end": "1886399"
  },
  {
    "text": "from mqtt itself and start scrolling the next piece of text",
    "start": "1886399",
    "end": "1893240"
  },
  {
    "text": "okay that was a lot um so i see my mask has stopped listening to",
    "start": "1893440",
    "end": "1900559"
  },
  {
    "text": "me i wonder if that's because my phone has gone to sleep so",
    "start": "1900559",
    "end": "1905679"
  },
  {
    "text": "that is how the mask was built um this is me and my mother",
    "start": "1905679",
    "end": "1913279"
  },
  {
    "text": "attempting to communicate um she's she was a little foxed by the",
    "start": "1913279",
    "end": "1919519"
  },
  {
    "text": "entire process but i seem to be impressed but there is more there's more stuff",
    "start": "1919519",
    "end": "1926240"
  },
  {
    "text": "that i haven't spoken about yet so",
    "start": "1926240",
    "end": "1931760"
  },
  {
    "text": "we would be here all day if i told you every single part of the app but the one of the things i haven't mentioned is if",
    "start": "1931760",
    "end": "1938720"
  },
  {
    "text": "you don't have an led display which you know i understand most people maybe don't",
    "start": "1938720",
    "end": "1944720"
  },
  {
    "text": "we also have the text displayed in the app so if you just want to be able to",
    "start": "1944720",
    "end": "1949840"
  },
  {
    "text": "share your text with somebody else you can actually press that little share captions button",
    "start": "1949840",
    "end": "1955760"
  },
  {
    "text": "and it'll just send them a screen with the text on it so we're back in that place where someone is having to look at",
    "start": "1955760",
    "end": "1960880"
  },
  {
    "text": "the phone to hear what you're saying but not the worst better than nothing",
    "start": "1960880",
    "end": "1966960"
  },
  {
    "text": "this is possible because again because we're using ably the messages that we're sending out are sent out over websockets",
    "start": "1967840",
    "end": "1974159"
  },
  {
    "text": "as well as mqtt so we can have as many people as we want sharing",
    "start": "1974159",
    "end": "1980080"
  },
  {
    "text": "our subtitles the other thing that i've not mentioned is",
    "start": "1980080",
    "end": "1985600"
  },
  {
    "text": "the visual representation of the display in the app",
    "start": "1985600",
    "end": "1990720"
  },
  {
    "text": "behind this is an entire basically an emulator of what is happening on the",
    "start": "1990720",
    "end": "1995760"
  },
  {
    "text": "arduino that is built in javascript that's running the same code that we're running on the board but outputs in divs",
    "start": "1995760",
    "end": "2002399"
  },
  {
    "text": "instead of in rgb leds which is so awesome because as i",
    "start": "2002399",
    "end": "2009600"
  },
  {
    "text": "mentioned debugging hardware is long ting",
    "start": "2009600",
    "end": "2016640"
  },
  {
    "text": "but i won't cover it today because i'm sure you've already heard enough of my voice but the good news is that all of the",
    "start": "2016880",
    "end": "2023519"
  },
  {
    "text": "code for this project is available on github and it's all open source i would love to see you make something",
    "start": "2023519",
    "end": "2030640"
  },
  {
    "text": "with it i would love to see more people make this kind of thing um if you go to github.com ably labs",
    "start": "2030640",
    "end": "2037360"
  },
  {
    "text": "there's also a whole load of other useful demos so if you want to build iot projects you",
    "start": "2037360",
    "end": "2043919"
  },
  {
    "text": "can take a look at my led wedding dress that's there the christmas jumper is",
    "start": "2043919",
    "end": "2048960"
  },
  {
    "text": "there if you want microsoft paint on your t-shirt that's in there if you're building a chat app or if",
    "start": "2048960",
    "end": "2055200"
  },
  {
    "text": "you're building multiplayer games or collaborative whiteboards anything that",
    "start": "2055200",
    "end": "2060638"
  },
  {
    "text": "requires data to be sent in real time there's a whole load of open source demos that i've written which are",
    "start": "2060639",
    "end": "2065919"
  },
  {
    "text": "available for you to take away and turn into your own thing",
    "start": "2065919",
    "end": "2071040"
  },
  {
    "text": "and if you do decide to try out this project or any of our other demos please do tell me about it i would love to see",
    "start": "2071040",
    "end": "2077440"
  },
  {
    "text": "what you make and if you're working in assistive technologies i would love to hear about",
    "start": "2077440",
    "end": "2083040"
  },
  {
    "text": "what it is that you're doing you can get me on twitter at this is joe frank",
    "start": "2083040",
    "end": "2088800"
  },
  {
    "text": "we also have an ably discord which i've just realized i've forgotten the link but if you would like to chat with me",
    "start": "2088800",
    "end": "2094878"
  },
  {
    "text": "on the regular you can come and find me and get the link to the discord",
    "start": "2094879",
    "end": "2100320"
  },
  {
    "text": "i'm always happy to talk about real-time projects and i would love to see what you're building so give me a shout",
    "start": "2100320",
    "end": "2107040"
  },
  {
    "text": "i have some stickers over here they're really cool come get a sticker and uh",
    "start": "2107040",
    "end": "2112640"
  },
  {
    "text": "thank you for listening ndc [Applause]",
    "start": "2112640",
    "end": "2123280"
  },
  {
    "text": "and if you want to come try out the mask",
    "start": "2123280",
    "end": "2127560"
  },
  {
    "text": "you",
    "start": "2131520",
    "end": "2133599"
  }
]