[
  {
    "text": "okay good afternoon and thank you for coming to my talk uh it's the last day of conference",
    "start": "10120",
    "end": "16680"
  },
  {
    "text": "do you enjoy it so far who uh who's first time at NDC",
    "start": "16680",
    "end": "23519"
  },
  {
    "text": "London okay approximately half mhm very good um so my name name is fif abilov",
    "start": "23519",
    "end": "31160"
  },
  {
    "text": "and I will be talking this hour about how to survive long event history I work as engineer at nrk",
    "start": "31160",
    "end": "41360"
  },
  {
    "text": "uh it's a Norwegian Broadcasting Corporation you can compare it with u",
    "start": "41360",
    "end": "46399"
  },
  {
    "text": "this BBC like BBC but just in Norway I also play keyboard um the band line",
    "start": "46399",
    "end": "53399"
  },
  {
    "text": "Breakers who played yesterday geek so if you happen to be on the concert I was there thank you for coming that",
    "start": "53399",
    "end": "61120"
  },
  {
    "text": "uh that case uh and and my day job I work with u f and c primarily FP last",
    "start": "61120",
    "end": "68960"
  },
  {
    "text": "years but our um topic uh has nothing to do with",
    "start": "68960",
    "end": "75439"
  },
  {
    "text": "choice of programming language uh or platform it's it's absolute agnostic so",
    "start": "75439",
    "end": "80640"
  },
  {
    "text": "whether using Java or net or some other platform who is mainly using net in",
    "start": "80640",
    "end": "86360"
  },
  {
    "text": "development or majority Java one hand yeah anybody using F by",
    "start": "86360",
    "end": "94520"
  },
  {
    "text": "chance no but don't be threatened don't be scared um this talk is a platform and",
    "start": "94520",
    "end": "101479"
  },
  {
    "text": "language U agnostic so uh it's also domain agnostic uh more or less we'll",
    "start": "101479",
    "end": "108159"
  },
  {
    "text": "talk little bit about some domain specific things but uh just to present",
    "start": "108159",
    "end": "113840"
  },
  {
    "text": "uh what is our domain and actually what is a like Foundation of learnings of",
    "start": "113840",
    "end": "119360"
  },
  {
    "text": "experience which uh I built uh for my talk uh it's publishing uh media files",
    "start": "119360",
    "end": "126880"
  },
  {
    "text": "um so our subdomain where we uh work it's publishing media content it can be",
    "start": "126880",
    "end": "132319"
  },
  {
    "text": "TV programs uh anything that nrk produces themselves or license uh audio",
    "start": "132319",
    "end": "139599"
  },
  {
    "text": "video file subtitles radio programs of course just audio maor supplement uh uh",
    "start": "139599",
    "end": "146040"
  },
  {
    "text": "for news fees because today's uh news you you can't uh manage them without uh",
    "start": "146040",
    "end": "154920"
  },
  {
    "text": "multimedia without without video audio files and of course we publish them and of course Associated metadata we also",
    "start": "154920",
    "end": "161159"
  },
  {
    "text": "publish them so you can see that this is system that has quite strong um",
    "start": "161159",
    "end": "166720"
  },
  {
    "text": "requirements when it comes to U scalability and uh uh security",
    "start": "166720",
    "end": "173080"
  },
  {
    "text": "also uh and of course it should be uh up and running 24/7 so it's um if if there",
    "start": "173080",
    "end": "180879"
  },
  {
    "text": "are some news breaking news and we haven't published within a second news clip it's a it's a little crisis for us",
    "start": "180879",
    "end": "188120"
  },
  {
    "text": "and uh but it it happens uh less and less of these incidents uh so I don't",
    "start": "188120",
    "end": "194799"
  },
  {
    "text": "remember last time when I had to be W awakened during the night to to to do",
    "start": "194799",
    "end": "199959"
  },
  {
    "text": "something and and partially that was because of our approach to how do we handle incoming data incoming events how",
    "start": "199959",
    "end": "207920"
  },
  {
    "text": "how how we build state of our system uh so our domain command and",
    "start": "207920",
    "end": "214799"
  },
  {
    "text": "events uh I guess uh even if you not working with multimedia domain but this",
    "start": "214799",
    "end": "220920"
  },
  {
    "text": "is something that everybody uh experienced so you you know pretty much",
    "start": "220920",
    "end": "227239"
  },
  {
    "text": "what happens in this domain so we we publish some major content which means that we can maybe add remove files files",
    "start": "227239",
    "end": "234519"
  },
  {
    "text": "can be retr transcoded can be some errors with the file of course subtitles um in",
    "start": "234519",
    "end": "240560"
  },
  {
    "text": "Norway uh everything which are in foreign languages uh comes with subtitles so it's um there is no",
    "start": "240560",
    "end": "246920"
  },
  {
    "text": "tradition of uh dubbing um content of course broadcasting rights we must",
    "start": "246920",
    "end": "253239"
  },
  {
    "text": "respect them um they may they can be multiple media resource versions uh also",
    "start": "253239",
    "end": "258519"
  },
  {
    "text": "some content can be geob blocked so while I'm here in London I can't uh",
    "start": "258519",
    "end": "263880"
  },
  {
    "text": "watch some of the videos published by nrk by our team because because I'm in",
    "start": "263880",
    "end": "269160"
  },
  {
    "text": "London it's only available for for Norway and so on so uh before we jump into",
    "start": "269160",
    "end": "280720"
  },
  {
    "text": "uh how to uh the topic of survival we have to probably Define we make I have",
    "start": "280720",
    "end": "286320"
  },
  {
    "text": "to make some definitions so definition of long longevity so when we say that we",
    "start": "286320",
    "end": "292240"
  },
  {
    "text": "want to survive long EV event history so how long event history we're talking",
    "start": "292240",
    "end": "297600"
  },
  {
    "text": "about and um the answer is indefinitely long so what what we want to survive",
    "start": "297600",
    "end": "305120"
  },
  {
    "text": "that even if we uh rewrite our system from you know C Shar and FP or maybe",
    "start": "305120",
    "end": "311960"
  },
  {
    "text": "then uh in Rust uh and if we change our data",
    "start": "311960",
    "end": "317520"
  },
  {
    "text": "sources if we change our message cues which we did several times uh we W uh",
    "start": "317520",
    "end": "324520"
  },
  {
    "text": "our events to survive so we can uh still be uh be uh we should we should still be",
    "start": "324520",
    "end": "330880"
  },
  {
    "text": "able to play back the state of our entities from from those",
    "start": "330880",
    "end": "337319"
  },
  {
    "text": "events uh and the scope of the talk also surviving what event history because we",
    "start": "337319",
    "end": "344720"
  },
  {
    "text": "uh we need to uh talk a little bit about what do we mean by by events and uh and",
    "start": "344720",
    "end": "352199"
  },
  {
    "text": "uh uh what happens to event history and uh of course you might um guess that I",
    "start": "352199",
    "end": "359280"
  },
  {
    "text": "will be talking about EV history in system based on event sourcing who is",
    "start": "359280",
    "end": "365039"
  },
  {
    "text": "working with Event Source system on a daily basis yeah majority who is",
    "start": "365039",
    "end": "371840"
  },
  {
    "text": "interested like considers mhm three hands four four hands yeah so and I",
    "start": "371840",
    "end": "378120"
  },
  {
    "text": "guess that's the reason we are here because if you if you didn't work with the EV uh uh Source system or had no",
    "start": "378120",
    "end": "384560"
  },
  {
    "text": "interest in that you you you wouldn't come here and uh so in in that case uh I",
    "start": "384560",
    "end": "392039"
  },
  {
    "text": "don't need to spend very much time on uh explaining uh reason to choose",
    "start": "392039",
    "end": "399240"
  },
  {
    "text": "event or system because uh s of Devil's Advocate question could be okay so since",
    "start": "399240",
    "end": "407479"
  },
  {
    "text": "you came with this uh topic for your talk it means that uh you know there are",
    "start": "407479",
    "end": "412680"
  },
  {
    "text": "some obstacles and some potential problems so if you have a system that only persists current state snapshot",
    "start": "412680",
    "end": "420199"
  },
  {
    "text": "doesn't have advantage that you don't need to deal with uh with with history so you have",
    "start": "420199",
    "end": "426400"
  },
  {
    "text": "typical um uh state-based system where you have a database where you store this is a",
    "start": "426400",
    "end": "433039"
  },
  {
    "text": "user record this is a customer record this is a company record and just latest State uh is persisted then you don't",
    "start": "433039",
    "end": "440840"
  },
  {
    "text": "have a problem of uh uh dealing with",
    "start": "440840",
    "end": "445879"
  },
  {
    "text": "event history but of course since you are more uh either working with the systems or interested in that you know",
    "start": "445879",
    "end": "452560"
  },
  {
    "text": "that uh that's uh that's actually poor",
    "start": "452560",
    "end": "457800"
  },
  {
    "text": "argument like no old events no survival change because the reasons why people choose uh events sourcing uh there are",
    "start": "457800",
    "end": "465159"
  },
  {
    "text": "there are many reasons and uh uh there was a great talk just before uh launch",
    "start": "465159",
    "end": "471240"
  },
  {
    "text": "by uh by David bo uh about event driven architecture who went to this talk mhm",
    "start": "471240",
    "end": "477440"
  },
  {
    "text": "yeah uh I like it uh very much and then uh so he was talking about complexity of",
    "start": "477440",
    "end": "484000"
  },
  {
    "text": "uh of architecture and and he was uh actually telling us that you can't avoid",
    "start": "484000",
    "end": "490639"
  },
  {
    "text": "complexity so you can't design your system that uh uh to prevent it become",
    "start": "490639",
    "end": "497400"
  },
  {
    "text": "uh becoming complicated then uh but you uh you should be able to learn managing",
    "start": "497400",
    "end": "503560"
  },
  {
    "text": "complexity and to me like state-based system where you just stored a recent State it's",
    "start": "503560",
    "end": "510440"
  },
  {
    "text": "um uh it's an attempt to avoid complexity so we we don't store events",
    "start": "510440",
    "end": "516839"
  },
  {
    "text": "we just store recent State and we hope that we will Design the system it's a",
    "start": "516839",
    "end": "521919"
  },
  {
    "text": "bit like waterfall based design like this is how we design and understand we hope that we will not be dealing very",
    "start": "521919",
    "end": "528399"
  },
  {
    "text": "much with schema changes of course we will so uh I think that event sourcing",
    "start": "528399",
    "end": "533600"
  },
  {
    "text": "leads to proper uh event versioning uh so system evolves contract evolves and",
    "start": "533600",
    "end": "540680"
  },
  {
    "text": "domain mod model evolves so uh it's inevitable so you'll be dealing with",
    "start": "540680",
    "end": "546040"
  },
  {
    "text": "that so it's better to be serious about that you will have uh events that change",
    "start": "546040",
    "end": "554600"
  },
  {
    "text": "over time and then you just store them you deal with that uh and you",
    "start": "554600",
    "end": "560640"
  },
  {
    "text": "uh you encounter it at early stage of your development uh so if you build your",
    "start": "560640",
    "end": "568160"
  },
  {
    "text": "state of your entities from events then um you know regular playback of all",
    "start": "568160",
    "end": "573279"
  },
  {
    "text": "events it will lead to early discovery of inconsistency and breaking changes",
    "start": "573279",
    "end": "578600"
  },
  {
    "text": "because if you uh uh don't build your state from from from event then uh like",
    "start": "578600",
    "end": "584640"
  },
  {
    "text": "you have snapshot and then uh then it uh system will be more vulnerable to uh",
    "start": "584640",
    "end": "591240"
  },
  {
    "text": "like aha uh situation when something has changed uh and system no longer works",
    "start": "591240",
    "end": "597040"
  },
  {
    "text": "but if you uh uh if you gradually uh change your system and rebuild uh",
    "start": "597040",
    "end": "603839"
  },
  {
    "text": "regular your state from from uh from your events uh you will learn you will you will make systematic choices uh",
    "start": "603839",
    "end": "610680"
  },
  {
    "text": "about uh about your system development uh also system that are",
    "start": "610680",
    "end": "615880"
  },
  {
    "text": "built with Assumption of a single set of events are harder to adapt to softare",
    "start": "615880",
    "end": "620959"
  },
  {
    "text": "contract provisions and U I watched some talk where speaker told about uh some",
    "start": "620959",
    "end": "628399"
  },
  {
    "text": "companies who have to backport new versions of of the of some",
    "start": "628399",
    "end": "634480"
  },
  {
    "text": "uh components because they couldn't version their events so it wasn't",
    "start": "634480",
    "end": "639839"
  },
  {
    "text": "compatible with uh like new version come with expect new new events and then the",
    "start": "639839",
    "end": "645079"
  },
  {
    "text": "system was not capable of that so they had to backboard so that's also consequences of not trying to deal with",
    "start": "645079",
    "end": "652160"
  },
  {
    "text": "event versioning so uh should a system based",
    "start": "652160",
    "end": "657200"
  },
  {
    "text": "on event sourcing be able to handle events of any age and if you if you",
    "start": "657200",
    "end": "664200"
  },
  {
    "text": "Google if you find uh talks about that presentations articles then uh the",
    "start": "664200",
    "end": "671680"
  },
  {
    "text": "popular opinion actually is contrary to what I'm going to talk about today keep",
    "start": "671680",
    "end": "678040"
  },
  {
    "text": "your event streams short uh so there are many arguments from uh recognized expert in the system",
    "start": "678040",
    "end": "686040"
  },
  {
    "text": "that you should not strive to uh have uh a system with long event versioning and",
    "start": "686040",
    "end": "693480"
  },
  {
    "text": "there are some reasons for that uh so first of course performance",
    "start": "693480",
    "end": "699200"
  },
  {
    "text": "considerations so if you have a very large number of events per entity aggregate route and then replaying",
    "start": "699200",
    "end": "705760"
  },
  {
    "text": "entity event is slow like example you have a bank account uh and of course you",
    "start": "705760",
    "end": "712079"
  },
  {
    "text": "can't just um replay bank account State uh from from the day one",
    "start": "712079",
    "end": "719839"
  },
  {
    "text": "you have to do some snapshotting and then uh that's kind of an argument that",
    "start": "719839",
    "end": "725240"
  },
  {
    "text": "uh you will get better performance uh the answer to that is that uh uh in such",
    "start": "725240",
    "end": "732600"
  },
  {
    "text": "systems you will still need to deal with snapshotting because uh even if you keep uh event stream relatively short it will",
    "start": "732600",
    "end": "739519"
  },
  {
    "text": "still be not good enough if you have a very large number of events so then you will you will still need to have a uh",
    "start": "739519",
    "end": "747279"
  },
  {
    "text": "system that manages that and then there is not really big difference of having all uh uh full history or just short",
    "start": "747279",
    "end": "755000"
  },
  {
    "text": "history but then storage costs of course operational storage versus archive storage um working at a media publishing",
    "start": "755000",
    "end": "763720"
  },
  {
    "text": "house we experience uh quite significant growth of storage cost we we dealing",
    "start": "763720",
    "end": "771120"
  },
  {
    "text": "with video it's it's very large files and especially last couple of years we",
    "start": "771120",
    "end": "776560"
  },
  {
    "text": "we see that we really need to to optim our storage cost um and of course uh if",
    "start": "776560",
    "end": "782399"
  },
  {
    "text": "you collecting like billions of events that that can be uh important",
    "start": "782399",
    "end": "788839"
  },
  {
    "text": "argument uh then anti may have business life cycles there is a pattern which is calling closing the books um example of",
    "start": "788839",
    "end": "797279"
  },
  {
    "text": "this um you have a workers which working in a shift uh there is a new worker",
    "start": "797279",
    "end": "803560"
  },
  {
    "text": "coming to the restaurant and then has his own register cash register and then",
    "start": "803560",
    "end": "809160"
  },
  {
    "text": "then so he starts the shift and then he he closes the previous worker closes the",
    "start": "809160",
    "end": "814519"
  },
  {
    "text": "book uh so the new one starts from from zero so so to say if uh uh mostly your",
    "start": "814519",
    "end": "823360"
  },
  {
    "text": "entities have business life cycles then maybe there won't be significant advantage of uh keeping full history and",
    "start": "823360",
    "end": "831000"
  },
  {
    "text": "then uh you can actually uh have your event stream short and last but not",
    "start": "831000",
    "end": "836160"
  },
  {
    "text": "least gdpr requirements um and this is quite important factor and everyone",
    "start": "836160",
    "end": "842480"
  },
  {
    "text": "needs to adopt to that most of uh uh at least at least everyone working with uh",
    "start": "842480",
    "end": "848440"
  },
  {
    "text": "like end users with with people it can also put uh requirements on your system",
    "start": "848440",
    "end": "854199"
  },
  {
    "text": "not to deal with uh uh old the events because of gdpr uh",
    "start": "854199",
    "end": "860399"
  },
  {
    "text": "requirements however let me present unpopular opinion keep your event",
    "start": "860399",
    "end": "865519"
  },
  {
    "text": "streams as long as you can which of of course requires certain assumptions to be in",
    "start": "865519",
    "end": "873000"
  },
  {
    "text": "place um so what are the reasons to keep stream as long as you can well first of",
    "start": "873000",
    "end": "879120"
  },
  {
    "text": "all we don't intervene with a natural sequence of events because if your state",
    "start": "879120",
    "end": "885759"
  },
  {
    "text": "is naturally built in the Event Source system from from events then uh all this",
    "start": "885759",
    "end": "891800"
  },
  {
    "text": "thing about snapshotting this is mainly for for optimization I but but naturally it's built from from events this is",
    "start": "891800",
    "end": "898360"
  },
  {
    "text": "event audits so uh unless you had reasons which I listed uh in the",
    "start": "898360",
    "end": "904000"
  },
  {
    "text": "previous slides then you know why should you start by keeping event stream",
    "start": "904000",
    "end": "909360"
  },
  {
    "text": "short entity business life cycle is Perpetual the books are never closed and",
    "start": "909360",
    "end": "915000"
  },
  {
    "text": "this is uh what we uh experience in our our domain uh so our media sets like TV",
    "start": "915000",
    "end": "923600"
  },
  {
    "text": "programs radio program they have history history of broadcasting rights of uh files we we all even had situation where",
    "start": "923600",
    "end": "931199"
  },
  {
    "text": "we need to uh roll back to the previous version of the files if new files contain some some errors uh or some",
    "start": "931199",
    "end": "939759"
  },
  {
    "text": "incorrect uh content uh keeping the whole event history",
    "start": "939759",
    "end": "946040"
  },
  {
    "text": "accessible makes all events available for continuous domain modeling and then I think this is um argument which",
    "start": "946040",
    "end": "952519"
  },
  {
    "text": "becomes particularly important uh in the year 2025 where every second talk is",
    "start": "952519",
    "end": "959000"
  },
  {
    "text": "about using of AI uh if you uh look at how vendors build",
    "start": "959000",
    "end": "968360"
  },
  {
    "text": "electron uh electric cars um then you will uh if you look at",
    "start": "968360",
    "end": "975600"
  },
  {
    "text": "in internals of what they collect often they collect a lot of data they have a",
    "start": "975600",
    "end": "981240"
  },
  {
    "text": "lot of sensors sometimes without clear understanding of how they're going to",
    "start": "981240",
    "end": "987319"
  },
  {
    "text": "going to use it for examp example how to build self-driving vehicle you know it's",
    "start": "987319",
    "end": "992880"
  },
  {
    "text": "uh inter it's a process which containing of multiple steps so you you build a",
    "start": "992880",
    "end": "999920"
  },
  {
    "text": "version and then you uh found out that you know it incorrectly uh recognize traffic lights",
    "start": "999920",
    "end": "1007160"
  },
  {
    "text": "in some um cases uh who was at uh Jennifer's talk uh about wle uh",
    "start": "1007160",
    "end": "1016480"
  },
  {
    "text": "yesterday nobody she's from Microsoft and she said that she tried to uh solve",
    "start": "1016480",
    "end": "1022639"
  },
  {
    "text": "the veral puzzle using AI where the Ral is a game where you try to guess word",
    "start": "1022639",
    "end": "1028480"
  },
  {
    "text": "and then if you have a letter in the right place it displayed in a green if",
    "start": "1028480",
    "end": "1034319"
  },
  {
    "text": "it's a word is uh it's in letter in the word but not in the right place it's in yellow otherwise it's gray so she found",
    "start": "1034319",
    "end": "1042880"
  },
  {
    "text": "that even though um uh AI is usually good in recognizing colors but if if the",
    "start": "1042880",
    "end": "1049480"
  },
  {
    "text": "task is complex which consists of many requirements where color is just one of",
    "start": "1049480",
    "end": "1055640"
  },
  {
    "text": "them often it doesn't correctly identify color and this is something which may",
    "start": "1055640",
    "end": "1061160"
  },
  {
    "text": "happen with self-driving car and of course if car doesn't correctly identify traffic light that's a disaster and this",
    "start": "1061160",
    "end": "1066400"
  },
  {
    "text": "is why uh sensor data becomes very",
    "start": "1066400",
    "end": "1072400"
  },
  {
    "text": "important uh for future releases so if you work in a domain where you may find",
    "start": "1072400",
    "end": "1078960"
  },
  {
    "text": "useful in the future using some of your data then it very sad if you just cut your event stream short uh remove all",
    "start": "1078960",
    "end": "1086360"
  },
  {
    "text": "events replace with some some snapshots because you won't be able to use them in",
    "start": "1086360",
    "end": "1091919"
  },
  {
    "text": "the future and that's quite important U argument and for us actually it worked several times that we suddenly found",
    "start": "1091919",
    "end": "1098919"
  },
  {
    "text": "some of old data that we could use so and of course that leads us to this",
    "start": "1098919",
    "end": "1104600"
  },
  {
    "text": "hybrid approach event sourcing with snapshotting uh something which doing",
    "start": "1104600",
    "end": "1110400"
  },
  {
    "text": "um partly uh so use use snapshot for performance optimization and uh also it",
    "start": "1110400",
    "end": "1118080"
  },
  {
    "text": "has built in support in some actor model Frameworks uh but",
    "start": "1118080",
    "end": "1123760"
  },
  {
    "text": "uh sometimes you you must use snapshotting if you have a history of like thousands or maybe Millions events",
    "start": "1123760",
    "end": "1129840"
  },
  {
    "text": "per uh aggregate route uh but be and bear in mind that snapshots they introduce additional versioning complex",
    "start": "1129840",
    "end": "1136360"
  },
  {
    "text": "you should version events and you should also version snapshot shots so and event payloads they should be small but State",
    "start": "1136360",
    "end": "1143240"
  },
  {
    "text": "snapshot might be very might be huge and we will talk late about uh importance of keeping event payload",
    "start": "1143240",
    "end": "1150159"
  },
  {
    "text": "small so unless you really need snapshots like you can introduce them always at the later",
    "start": "1150159",
    "end": "1155880"
  },
  {
    "text": "stage so let me uh go through my opinionated long",
    "start": "1155880",
    "end": "1161400"
  },
  {
    "text": "event history Survival Guide which is built on um our experience uh uh dealing",
    "start": "1161400",
    "end": "1169360"
  },
  {
    "text": "with old events and when I say old events I think in our system the oldest events were registered around",
    "start": "1169360",
    "end": "1177240"
  },
  {
    "text": "2011 where we uh released one of the earlier versions of uh uh our media",
    "start": "1177240",
    "end": "1186400"
  },
  {
    "text": "player uh so it's like 14 years old which is like old enough because we",
    "start": "1186400",
    "end": "1192360"
  },
  {
    "text": "changed uh technical uh tools and programming languages uh databases uh",
    "start": "1192360",
    "end": "1198360"
  },
  {
    "text": "mess Q several times after that so uh we will go through",
    "start": "1198360",
    "end": "1204840"
  },
  {
    "text": "every step which listed here uh but in brief so it's about first have a clear",
    "start": "1204840",
    "end": "1211760"
  },
  {
    "text": "separation between commands persistent and Transit events of course uh have a",
    "start": "1211760",
    "end": "1217200"
  },
  {
    "text": "clear separation about domain and D types and uh also uh Define events for",
    "start": "1217200",
    "end": "1223360"
  },
  {
    "text": "specific scenarios so uh some of earlier mistakes we made we tried to make",
    "start": "1223360",
    "end": "1229919"
  },
  {
    "text": "generic general purpose events developers are usually bad in generalizing thing too early and events",
    "start": "1229919",
    "end": "1236640"
  },
  {
    "text": "is uh something that probably you you don't need to generalize even at a later",
    "start": "1236640",
    "end": "1241960"
  },
  {
    "text": "stage uh even if you see that there are some several candidates of like General",
    "start": "1241960",
    "end": "1248520"
  },
  {
    "text": "event uh avoiding large objects in event payload and we'll uh look at why uh",
    "start": "1248520",
    "end": "1256440"
  },
  {
    "text": "using version tolerance schema based realization U avoiding polymorphic event realization",
    "start": "1256440",
    "end": "1262320"
  },
  {
    "text": "and uh a few words about uh event migration because uh once in a while you",
    "start": "1262320",
    "end": "1267720"
  },
  {
    "text": "need to M migrate uh your events so what are recommended uh approaches to that so",
    "start": "1267720",
    "end": "1276360"
  },
  {
    "text": "first uh it's have a clear separation between commands persistent and Transit",
    "start": "1276360",
    "end": "1282400"
  },
  {
    "text": "events so commands uh commands uh it's something",
    "start": "1282400",
    "end": "1288400"
  },
  {
    "text": "that uh usually specify it in your uh contracts uh it can be verbal contract",
    "start": "1288400",
    "end": "1295600"
  },
  {
    "text": "with with between different but usually it's good to uh document your uh commands in contract using like open API",
    "start": "1295600",
    "end": "1302880"
  },
  {
    "text": "or Sync API specification and uh you need to be uh certain about like ownership who",
    "start": "1302880",
    "end": "1310559"
  },
  {
    "text": "who owns uh contract who who is um",
    "start": "1310559",
    "end": "1315960"
  },
  {
    "text": "entitled to to change to change commands they expressed in imperative mood uh if",
    "start": "1315960",
    "end": "1321120"
  },
  {
    "text": "this is how you call your commands in your programming language and they may be accepted or rejected so when you get",
    "start": "1321120",
    "end": "1329320"
  },
  {
    "text": "certain commands it's not um it's not obligation for you to accept it but once",
    "start": "1329320",
    "end": "1334360"
  },
  {
    "text": "accepted they trigger uh event that that is persistent and that that is a rule that is",
    "start": "1334360",
    "end": "1340600"
  },
  {
    "text": "something that is serialized uh and in our uh case we're using AKA uh so",
    "start": "1340600",
    "end": "1348840"
  },
  {
    "text": "we use So-Cal persistent actors and then uh they use persistent uh uh event",
    "start": "1348840",
    "end": "1354799"
  },
  {
    "text": "Journal so we have a lot of support from from AKA framework for that uh and uh uh",
    "start": "1354799",
    "end": "1361480"
  },
  {
    "text": "commands of course can be persistent in audit log this is what we do as",
    "start": "1361480",
    "end": "1367080"
  },
  {
    "text": "well so uh persistent Journal events this is something this owned by the team",
    "start": "1367080",
    "end": "1373600"
  },
  {
    "text": "so we can change those uh events at uh any time time uh so this is something",
    "start": "1373600",
    "end": "1380880"
  },
  {
    "text": "which we verion uh they expressed in in past sense they may not be rejected so",
    "start": "1380880",
    "end": "1387679"
  },
  {
    "text": "they notify about the past so typically published media file and then arguments",
    "start": "1387679",
    "end": "1394919"
  },
  {
    "text": "with media file uh qualities and they provide foundation for for event",
    "start": "1394919",
    "end": "1401200"
  },
  {
    "text": "sourcing so we own those commands and this is what we will be talk uh talking",
    "start": "1401200",
    "end": "1407080"
  },
  {
    "text": "about versioning and then you have Transit events uh it's typically it's notifications so uh they",
    "start": "1407080",
    "end": "1415080"
  },
  {
    "text": "can be published internally or to external consumers so we also call it",
    "start": "1415080",
    "end": "1420120"
  },
  {
    "text": "outgoing events and um they may use so-called outbox pattern so we can",
    "start": "1420120",
    "end": "1426279"
  },
  {
    "text": "temporarily persist them because it's it's a part of the contract once the command is executed we need to",
    "start": "1426279",
    "end": "1433159"
  },
  {
    "text": "notify uh our subscribers and then if if it didn't notify like let's say the system crushed then when the system",
    "start": "1433159",
    "end": "1440000"
  },
  {
    "text": "restart we must find out that we need to notify the consumer so uh and because of",
    "start": "1440000",
    "end": "1446400"
  },
  {
    "text": "that we use so called outbox pattern which basically means persisting outgoing uh events but once published uh",
    "start": "1446400",
    "end": "1453799"
  },
  {
    "text": "they don't need to be replayed in its original shape so they not part of uh",
    "start": "1453799",
    "end": "1459440"
  },
  {
    "text": "this um core event versioning so",
    "start": "1459440",
    "end": "1466120"
  },
  {
    "text": "uh as like simplify a view of what we're dealing with is",
    "start": "1466120",
    "end": "1473320"
  },
  {
    "text": "commands and once commands is accepted it's persistent in event",
    "start": "1473320",
    "end": "1479039"
  },
  {
    "text": "journal and we have outgoing events and desire State events and current state",
    "start": "1479039",
    "end": "1485039"
  },
  {
    "text": "events it's not uh something that you have to uh use in your system but this",
    "start": "1485039",
    "end": "1493000"
  },
  {
    "text": "is was uh our choice that uh uh for for",
    "start": "1493000",
    "end": "1499120"
  },
  {
    "text": "us we have chosen that the easiest way to deal with command execution is that",
    "start": "1499120",
    "end": "1506279"
  },
  {
    "text": "uh we receive commands usually from the message Q like rabbit mq or Azure",
    "start": "1506279",
    "end": "1511320"
  },
  {
    "text": "service bus then we we register desired State like what what we are asked to do",
    "start": "1511320",
    "end": "1519720"
  },
  {
    "text": "and then desired State uh of the system is built from desire State events so",
    "start": "1519720",
    "end": "1525080"
  },
  {
    "text": "this is what we supposed to do and and then we acknowledge the",
    "start": "1525080",
    "end": "1530679"
  },
  {
    "text": "command acknowledge rabbit mq message or ar service bus message and then we start",
    "start": "1530679",
    "end": "1536080"
  },
  {
    "text": "executing uh uh this command based on desired State events and then once uh",
    "start": "1536080",
    "end": "1542720"
  },
  {
    "text": "all current state events are received so basically it's a math we have desired State we have current state and then",
    "start": "1542720",
    "end": "1548840"
  },
  {
    "text": "difference is a workload which we need to do so once we're done we uh we can",
    "start": "1548840",
    "end": "1556600"
  },
  {
    "text": "send outgoing events so uh this example of uh what's going on",
    "start": "1556600",
    "end": "1563080"
  },
  {
    "text": "in our system so we have a command published media set and this command cons uh consists of multiple files",
    "start": "1563080",
    "end": "1569679"
  },
  {
    "text": "multiple media files uh which can be um video file audio file subtitles so we",
    "start": "1569679",
    "end": "1580000"
  },
  {
    "text": "store Journal events like assign desired state which describes what needs to be",
    "start": "1580000",
    "end": "1585120"
  },
  {
    "text": "done uh then we start uh uploading files like assigned remote files so we uh",
    "start": "1585120",
    "end": "1591640"
  },
  {
    "text": "received the first file as uh sorry it is just assign we need to upload two",
    "start": "1591640",
    "end": "1598120"
  },
  {
    "text": "files and then we received from our soal origin which is a remote",
    "start": "1598120",
    "end": "1604679"
  },
  {
    "text": "storage it's Amazon 3 uh S3 compatible storage we receive remote file state",
    "start": "1604679",
    "end": "1610600"
  },
  {
    "text": "okay we publish outo event we received remote file say to uh publish second um event and also",
    "start": "1610600",
    "end": "1618960"
  },
  {
    "text": "the whole media set is published so these are Journal events and this is something which we try to verion",
    "start": "1618960",
    "end": "1627919"
  },
  {
    "text": "periodically so uh in addition to separating",
    "start": "1631440",
    "end": "1637480"
  },
  {
    "text": "commands Journal uh events or persistent events and Transit events uh it's also",
    "start": "1637480",
    "end": "1643480"
  },
  {
    "text": "important to separate domain and dto types and unfortunately ly in",
    "start": "1643480",
    "end": "1649799"
  },
  {
    "text": "2025 uh we maybe not very often not as often as before but we can uh come",
    "start": "1649799",
    "end": "1657000"
  },
  {
    "text": "across systems built like that you have just uh core types which are domain",
    "start": "1657000",
    "end": "1664519"
  },
  {
    "text": "types based on an framework for example and both UI and business logic and even",
    "start": "1664519",
    "end": "1671640"
  },
  {
    "text": "database uh use uh um this these types",
    "start": "1671640",
    "end": "1676960"
  },
  {
    "text": "and then um what can I say about that just just don't I mean uh don't do that",
    "start": "1676960",
    "end": "1683399"
  },
  {
    "text": "because you you asking for troubles you have to have clear",
    "start": "1683399",
    "end": "1688960"
  },
  {
    "text": "separation between domain and dto types because they are actually they exist for",
    "start": "1688960",
    "end": "1696360"
  },
  {
    "text": "different reasons uh domain types they they represent current understanding of",
    "start": "1696360",
    "end": "1701799"
  },
  {
    "text": "the business domain and your dto types they tailor it for specific version",
    "start": "1701799",
    "end": "1707440"
  },
  {
    "text": "specific versions of specific contracts um and uh your domain types",
    "start": "1707440",
    "end": "1714320"
  },
  {
    "text": "they they reflect relationship between business entities but the types don't need to bear this information about",
    "start": "1714320",
    "end": "1721640"
  },
  {
    "text": "relationships uh between different entities they they must be lightweight and independent from from each other and",
    "start": "1721640",
    "end": "1728480"
  },
  {
    "text": "also domain types they they usually full use full expressiveness of programming",
    "start": "1728480",
    "end": "1734399"
  },
  {
    "text": "language that you choose and our programming languages are sharp and sharp is one of the languages that",
    "start": "1734399",
    "end": "1739840"
  },
  {
    "text": "supports are called algebraic data types which means that we have uh sum types and product types and discriminated",
    "start": "1739840",
    "end": "1746000"
  },
  {
    "text": "unions and record types so and we take of course full advantage of that and we",
    "start": "1746000",
    "end": "1752840"
  },
  {
    "text": "can't design our dto object based on like beauty of our programming languages",
    "start": "1752840",
    "end": "1758200"
  },
  {
    "text": "they must be based uh on primitive well they should be based on primitive data",
    "start": "1758200",
    "end": "1763559"
  },
  {
    "text": "types otherwise you again you're asking for troubles so it's quite important",
    "start": "1763559",
    "end": "1768720"
  },
  {
    "text": "once you have clear separation between domain types and dto types you make your life easier also when it comes to event",
    "start": "1768720",
    "end": "1775080"
  },
  {
    "text": "version um who is using",
    "start": "1775080",
    "end": "1779720"
  },
  {
    "text": "automapper good uh well unfortunately",
    "start": "1781080",
    "end": "1787919"
  },
  {
    "text": "uh the Jimmy Boger who wrote AER is here and he's a great developer and actually",
    "start": "1787919",
    "end": "1794559"
  },
  {
    "text": "he's uh very uh how skilled in into building great",
    "start": "1794559",
    "end": "1802679"
  },
  {
    "text": "architectures and he wrote this document U about automar assumptions after",
    "start": "1802679",
    "end": "1810760"
  },
  {
    "text": "numerous complaints that know somebody used automar and then uh you know code",
    "start": "1810760",
    "end": "1817000"
  },
  {
    "text": "is bad and then why uh we're using after M just to to connect database to UI and",
    "start": "1817000",
    "end": "1823399"
  },
  {
    "text": "that's that's not how it should be done why did you publish this Library basically so and then WR this document",
    "start": "1823399",
    "end": "1828880"
  },
  {
    "text": "automapper assumption so if and only if uh your use of automapper falls into",
    "start": "1828880",
    "end": "1835760"
  },
  {
    "text": "this uh list of assumption then it's okay to use to use it but",
    "start": "1835760",
    "end": "1841679"
  },
  {
    "text": "unfortunately uh I checked today aara has 750 million downloads so 3/4 of a",
    "start": "1841679",
    "end": "1849559"
  },
  {
    "text": "billion so unfortunately a lot of teams use it just uh to bind uh every",
    "start": "1849559",
    "end": "1858440"
  },
  {
    "text": "everything together and that that's really hard uh for maintaining the",
    "start": "1858440",
    "end": "1863720"
  },
  {
    "text": "system so Define events for specific scenarios and avoid general purpose",
    "start": "1863720",
    "end": "1869960"
  },
  {
    "text": "events and that's uh one of the mistakes which we did uh in the in early stage uh",
    "start": "1869960",
    "end": "1878399"
  },
  {
    "text": "that's actually from our code based from different times um so uh we",
    "start": "1878399",
    "end": "1887440"
  },
  {
    "text": "publish files upload to so-called Origins uh it's like storage provider and it used",
    "start": "1887440",
    "end": "1894000"
  },
  {
    "text": "to be akami now it's S3 compatible storage and then uh we had a received",
    "start": "1894000",
    "end": "1900799"
  },
  {
    "text": "remote file state which was generic event uh which uh contained some common",
    "start": "1900799",
    "end": "1906960"
  },
  {
    "text": "information and then uh uh origin uh type and then uh uh what we found that",
    "start": "1906960",
    "end": "1915000"
  },
  {
    "text": "it's uh uh in a Event Source uh system it's much",
    "start": "1915000",
    "end": "1921600"
  },
  {
    "text": "easier to manage uh events when there are specific to uh to the to the context for example",
    "start": "1921600",
    "end": "1930360"
  },
  {
    "text": "like what what could be uh difficult with with that definition uh we",
    "start": "1930360",
    "end": "1935919"
  },
  {
    "text": "actually uh phed out like uh Akamai storage so",
    "start": "1935919",
    "end": "1943360"
  },
  {
    "text": "and we had millions of uh old events which just uh",
    "start": "1943360",
    "end": "1948559"
  },
  {
    "text": "lies in the database without without on a purpose and U I'll be talking later",
    "start": "1948559",
    "end": "1954039"
  },
  {
    "text": "about event migration but uh in even though event Journal is usually",
    "start": "1954039",
    "end": "1959799"
  },
  {
    "text": "immutable but sometimes you have uh some",
    "start": "1959799",
    "end": "1964880"
  },
  {
    "text": "events that just you know that will never be used for for anything practical",
    "start": "1964880",
    "end": "1970960"
  },
  {
    "text": "and then then you know then they're just uh uh collecting dust so you can you can",
    "start": "1970960",
    "end": "1976240"
  },
  {
    "text": "remove anything that had to do with akami and in in in case event was",
    "start": "1976240",
    "end": "1981840"
  },
  {
    "text": "registered like that you can't just if you like event is stored in a SQL database you can't just uh store uh find",
    "start": "1981840",
    "end": "1990639"
  },
  {
    "text": "them uh uh easier but just by quering because",
    "start": "1990639",
    "end": "1996559"
  },
  {
    "text": "it's not stored as a uh column like origin column file set colum column and",
    "start": "1996559",
    "end": "2003200"
  },
  {
    "text": "and so on it's just a payload it's just a blob so actually have to go through event journal and",
    "start": "2003200",
    "end": "2008559"
  },
  {
    "text": "manually pick up these events so another reason is that of course uh the more you",
    "start": "2008559",
    "end": "2015000"
  },
  {
    "text": "work with spe specific origin the more you find uh things that uh are related to",
    "start": "2015000",
    "end": "2021960"
  },
  {
    "text": "the specific origin which may not be used when you uh introduce a new origin",
    "start": "2021960",
    "end": "2027760"
  },
  {
    "text": "so uh that's another reason why you shouldn't uh have this General U use",
    "start": "2027760",
    "end": "2033080"
  },
  {
    "text": "event so event should be bound to specific uh scenario to specific context then it will be easy to version them it",
    "start": "2033080",
    "end": "2038720"
  },
  {
    "text": "will be easier to get rid of them and uh enrich them uh and downsides of generic purpose",
    "start": "2038720",
    "end": "2047560"
  },
  {
    "text": "events uh as I already mentioned that versioning must be applied to all",
    "start": "2047560",
    "end": "2053800"
  },
  {
    "text": "scenarios and it's hard to perform Cleanup in case some scenario becomes obsolete uh I also originally had this",
    "start": "2053800",
    "end": "2062000"
  },
  {
    "text": "like hard hard to query for Ev from specific subset but uh in a well",
    "start": "2062000",
    "end": "2068440"
  },
  {
    "text": "design system you should be using cqs like query and command U separation so",
    "start": "2068440",
    "end": "2076240"
  },
  {
    "text": "then you shouldn't really be doing query on your uh event you should be doing query on on the on a read side so",
    "start": "2076240",
    "end": "2083280"
  },
  {
    "text": "probably it should be applied in that case so uh another uh point that can",
    "start": "2083280",
    "end": "2090679"
  },
  {
    "text": "become important avoiding large objects in event payload so there is a temptation that",
    "start": "2090679",
    "end": "2098599"
  },
  {
    "text": "you can make a event that contain everything and then I I had example with u electric vehicles and then if you want",
    "start": "2098599",
    "end": "2105800"
  },
  {
    "text": "to build self-driving car you have a Temptation Of course to register um data",
    "start": "2105800",
    "end": "2110839"
  },
  {
    "text": "from all your sensors and then can uh make your events quite",
    "start": "2110839",
    "end": "2117440"
  },
  {
    "text": "large uh so uh and of course the motivation to have events large uh is",
    "start": "2117440",
    "end": "2124920"
  },
  {
    "text": "that the content of events should be sufficient to fully rebuild the state of the system and also the context uh of the",
    "start": "2124920",
    "end": "2133040"
  },
  {
    "text": "events May contain information then uh can be used in the future so just just",
    "start": "2133040",
    "end": "2138160"
  },
  {
    "text": "register everything maybe we will use for that but there are some important downsides of larg event",
    "start": "2138160",
    "end": "2144680"
  },
  {
    "text": "objects first of all they have very significant impact on performance and scalability if you have a one sourced uh",
    "start": "2144680",
    "end": "2151079"
  },
  {
    "text": "system and then building state from large events it it really uh can bring",
    "start": "2151079",
    "end": "2156720"
  },
  {
    "text": "your system down then there is a transport and storage size limitations again if we're talking",
    "start": "2156720",
    "end": "2162599"
  },
  {
    "text": "about uh events that will leave long then most likely you will change",
    "start": "2162599",
    "end": "2168640"
  },
  {
    "text": "transport you will change databases and you you can experience that something which which was okay today will not be",
    "start": "2168640",
    "end": "2174599"
  },
  {
    "text": "okay in the in the future so uh here's example of",
    "start": "2174599",
    "end": "2181240"
  },
  {
    "text": "uh uh yeah of our event on on the left hand side is",
    "start": "2181240",
    "end": "2188599"
  },
  {
    "text": "this is uh how we uh implemented it and",
    "start": "2188599",
    "end": "2196000"
  },
  {
    "text": "uh yeah so you have you have this uh information about completed file transcoding which is version bit R",
    "start": "2197000",
    "end": "2203880"
  },
  {
    "text": "duration and so on and of course you have uh string file path because it was obvious when we designed this event that",
    "start": "2203880",
    "end": "2211359"
  },
  {
    "text": "we can't just put uh bite payload because file video file content can be",
    "start": "2211359",
    "end": "2217280"
  },
  {
    "text": "up to 10 uh gigaby so in that case we made right decision right from from the",
    "start": "2217280",
    "end": "2223240"
  },
  {
    "text": "beginning because it was too obvious that we shouldn't put the whole uh file here but we didn't mistake with",
    "start": "2223240",
    "end": "2230640"
  },
  {
    "text": "subtitles because subtitles are usually small so uh uh instead of having just",
    "start": "2230640",
    "end": "2237960"
  },
  {
    "text": "file path and that in that case we would be treating subtitles in the same way like um video files we put the whole",
    "start": "2237960",
    "end": "2245560"
  },
  {
    "text": "file content because with talking about maximum maybe 1 Megabyte for uh for",
    "start": "2245560",
    "end": "2251480"
  },
  {
    "text": "subtitle so uh yeah subtitles file contain up to 1 Megabyte and then",
    "start": "2251480",
    "end": "2256839"
  },
  {
    "text": "actually there are some consequences of that choice which we experienc because",
    "start": "2256839",
    "end": "2262640"
  },
  {
    "text": "uh we were using uh at that time most the rabbitmq and",
    "start": "2262640",
    "end": "2268400"
  },
  {
    "text": "then uh it was uh message size 2 gab actually up to version 3.7 and on later",
    "start": "2268400",
    "end": "2276119"
  },
  {
    "text": "versions they reduces size to 512 but anyway it was no problem to use that but",
    "start": "2276119",
    "end": "2282880"
  },
  {
    "text": "in case uh some of the rabbit mqs were uh later migrated to other storage cues",
    "start": "2282880",
    "end": "2289079"
  },
  {
    "text": "like uh storage uh other storage a storage cues and a service bus and if",
    "start": "2289079",
    "end": "2294520"
  },
  {
    "text": "you work with uh aure storage cues and it's just 64k so of course subtitle file",
    "start": "2294520",
    "end": "2300760"
  },
  {
    "text": "will no longer fit with service bus you have up to one megabyte for premium subscription but still it is it's kind",
    "start": "2300760",
    "end": "2307960"
  },
  {
    "text": "of on on the edge uh so uh uh you have",
    "start": "2307960",
    "end": "2313400"
  },
  {
    "text": "to uh look you have to at least be aware if you want to uh have uh quite large",
    "start": "2313400",
    "end": "2319920"
  },
  {
    "text": "payload of events why why do do you really need that because uh you can",
    "start": "2319920",
    "end": "2325280"
  },
  {
    "text": "migrate your transport and then suddenly you uh start having these problems so",
    "start": "2325280",
    "end": "2333359"
  },
  {
    "text": "uh what if when payload grows large what uh other consequences so TCP packet size",
    "start": "2333359",
    "end": "2340160"
  },
  {
    "text": "is 64k so large messages require paging them into buffers and U so you will have",
    "start": "2340160",
    "end": "2348119"
  },
  {
    "text": "like blocked buffers sorry block sockets uh so real large events as I uh",
    "start": "2348119",
    "end": "2355319"
  },
  {
    "text": "showed on previous slide fit into cues and storage fields and also you have to ask maybe",
    "start": "2355319",
    "end": "2362720"
  },
  {
    "text": "your events include the whole state because this is um it can be no",
    "start": "2362720",
    "end": "2368599"
  },
  {
    "text": "antipattern uh not necessarily in case you really uh know like what you're",
    "start": "2368599",
    "end": "2374240"
  },
  {
    "text": "doing that you need the the whole state but in if you have dealing with events Source system then you you build state",
    "start": "2374240",
    "end": "2381560"
  },
  {
    "text": "from events you you don't just send State uh in your Events maybe you can",
    "start": "2381560",
    "end": "2386880"
  },
  {
    "text": "split your events into several smaller events uh again it's not always possible",
    "start": "2386880",
    "end": "2392560"
  },
  {
    "text": "maybe you you need to have Atomic events but if you can split that's that's a possibility",
    "start": "2392560",
    "end": "2398119"
  },
  {
    "text": "so with payload size there is no strict rule telling you that you know you you",
    "start": "2398119",
    "end": "2403400"
  },
  {
    "text": "can't have uh uh events with large payload but there are many obstacles if",
    "start": "2403400",
    "end": "2411079"
  },
  {
    "text": "you have a large payload in your events so just be aware of uh of consequences",
    "start": "2411079",
    "end": "2418319"
  },
  {
    "text": "when you design your events then another topic is uh uh use",
    "start": "2418319",
    "end": "2424960"
  },
  {
    "text": "version tolerance serialization and to avoid uh So-Cal polymorphic EV",
    "start": "2424960",
    "end": "2430200"
  },
  {
    "text": "calization so uh what is polymorphic calization so typically you uh deal with",
    "start": "2430200",
    "end": "2436960"
  },
  {
    "text": "that if you in languages like like C or Java when you have types and subtypes",
    "start": "2436960",
    "end": "2442720"
  },
  {
    "text": "when you have uh serialize or deserialize your objects uh with",
    "start": "2442720",
    "end": "2448680"
  },
  {
    "text": "preserving run type information uh and uh it's essential when dealing with inheritance so you have uh like user and",
    "start": "2448680",
    "end": "2456119"
  },
  {
    "text": "then you have like comp user corporate user private user they derive from the same type and then",
    "start": "2456119",
    "end": "2463839"
  },
  {
    "text": "uh uh you use poly polymorphic calization to uh and then you need to store some write up information this is",
    "start": "2463839",
    "end": "2470280"
  },
  {
    "text": "a corporate user this is this is a private user and uh this quickly becomes",
    "start": "2470280",
    "end": "2478240"
  },
  {
    "text": "too much platform specific or L language specific so if you uh then change your",
    "start": "2478240",
    "end": "2484880"
  },
  {
    "text": "platform or language it will be hard to deal with this so uh yeah the key",
    "start": "2484880",
    "end": "2491079"
  },
  {
    "text": "component of polymerization you have Base Class and derived classes and uh C formats can be anything like Json XML",
    "start": "2491079",
    "end": "2499480"
  },
  {
    "text": "binary and uh uh your type information must also be present when uh serializing",
    "start": "2499480",
    "end": "2505960"
  },
  {
    "text": "your and distalizing your your types so problems are serialize and runtime upgrades so sometimes uh if uh there is",
    "start": "2505960",
    "end": "2514720"
  },
  {
    "text": "a u net uh core or like net upgrade it it can",
    "start": "2514720",
    "end": "2521880"
  },
  {
    "text": "come uh with problems with uh uh sterilization actually happened in in the past uh namespace changes that's",
    "start": "2521880",
    "end": "2529200"
  },
  {
    "text": "actually one of the things that we suffered uh from because uh we had to",
    "start": "2529200",
    "end": "2536319"
  },
  {
    "text": "this polymerization usually it has runtime information that includes namespace so if we just uh move uh class",
    "start": "2536319",
    "end": "2545680"
  },
  {
    "text": "into different namespace and suddenly it no longer works um and but basically there is no",
    "start": "2545680",
    "end": "2552280"
  },
  {
    "text": "place for class hierarchies in dto types so D types uh must be primitive types so",
    "start": "2552280",
    "end": "2558000"
  },
  {
    "text": "just just avoid making D types uh part of class hierarchies so instead um I",
    "start": "2558000",
    "end": "2566319"
  },
  {
    "text": "suggest that uh we use schema based calization so uh in that in that case",
    "start": "2566319",
    "end": "2572880"
  },
  {
    "text": "structure of the data it's it schema is explicit defined and used to guide calization interation process so know",
    "start": "2572880",
    "end": "2581319"
  },
  {
    "text": "this uh run type information and there are several choices uh one of the most",
    "start": "2581319",
    "end": "2588280"
  },
  {
    "text": "uh popular of course is Google uh protocol buffers protuff uh uh there is also apase AA CH",
    "start": "2588280",
    "end": "2596319"
  },
  {
    "text": "Json apha Thrift and of course you can use XML with X xsd so this is example of a schema so",
    "start": "2596319",
    "end": "2605920"
  },
  {
    "text": "you define your uh realization format your your",
    "start": "2605920",
    "end": "2611480"
  },
  {
    "text": "type is pretty self-explanatory and this example of protab schema something which",
    "start": "2611480",
    "end": "2617800"
  },
  {
    "text": "we are using so you see no class hierarchies no complex types everything",
    "start": "2617800",
    "end": "2624240"
  },
  {
    "text": "uses just primitive",
    "start": "2624240",
    "end": "2627280"
  },
  {
    "text": "types uh we choose uh Google protuff because of its performance and compactness uh it has very small message",
    "start": "2631200",
    "end": "2638800"
  },
  {
    "text": "payload size and it's very fast extremely fast when it's serializing and distalizing data uh also it's based on",
    "start": "2638800",
    "end": "2647559"
  },
  {
    "text": "static static typing it's a bit opinionated but we we go for that and of",
    "start": "2647559",
    "end": "2652599"
  },
  {
    "text": "course it's crossplatform compatibility so it's supported by all major programming languages platform so if you",
    "start": "2652599",
    "end": "2658599"
  },
  {
    "text": "choose protuff then you don't need to think about uh changing of platform",
    "start": "2658599",
    "end": "2663720"
  },
  {
    "text": "who's using protu uh what other are using any anyone",
    "start": "2663720",
    "end": "2669800"
  },
  {
    "text": "using AA AP Rift just polymorphic",
    "start": "2669800",
    "end": "2676280"
  },
  {
    "text": "calization anything else sorry you uhuh you happy with the",
    "start": "2676280",
    "end": "2684240"
  },
  {
    "text": "choice no you have to we we still have uh Newton of Jason it's part of our",
    "start": "2684240",
    "end": "2690599"
  },
  {
    "text": "system but in everything which has to to do with um uh persistent events we",
    "start": "2690599",
    "end": "2696680"
  },
  {
    "text": "replace with prabu uh after certain problems with boss",
    "start": "2696680",
    "end": "2702520"
  },
  {
    "text": "versioning and Nam spaces actually uh but yes it's still uh we're slowly",
    "start": "2702520",
    "end": "2710280"
  },
  {
    "text": "replacing newon soft with uh system uh text Json which is uh much faster by the",
    "start": "2710280",
    "end": "2717440"
  },
  {
    "text": "way so uh this is also a little bit opinionated but protab doesn't care",
    "start": "2717440",
    "end": "2723920"
  },
  {
    "text": "about naming which I find uh personally quite good because developers are",
    "start": "2723920",
    "end": "2730160"
  },
  {
    "text": "religious about naming and then um can be religious about naming and then uh if you're talking about system that lives",
    "start": "2730160",
    "end": "2736440"
  },
  {
    "text": "for years uh like system outgrows its members and then you have a team with a",
    "start": "2736440",
    "end": "2744319"
  },
  {
    "text": "uh strong opinions about how uh things should be named then",
    "start": "2744319",
    "end": "2751680"
  },
  {
    "text": "uh main like lead architect goes and then the is another",
    "start": "2751680",
    "end": "2757599"
  },
  {
    "text": "guy he think no no no no more Pascal uh convention everything should should",
    "start": "2757599",
    "end": "2762760"
  },
  {
    "text": "should be using like this good old C uh and then suddenly uh you have you have",
    "start": "2762760",
    "end": "2770480"
  },
  {
    "text": "different names and um and probably you experience some",
    "start": "2770480",
    "end": "2776839"
  },
  {
    "text": "naming Wars between developers and then uh if you have project that supposed to",
    "start": "2776839",
    "end": "2782720"
  },
  {
    "text": "leave decades uh it should be also named agnostic which prod does so all those",
    "start": "2782720",
    "end": "2789280"
  },
  {
    "text": "names actually they have no meaning uh in like inside the prod of protocol you",
    "start": "2789280",
    "end": "2795960"
  },
  {
    "text": "it's just for your convenience basically so these are uh indexes which order of",
    "start": "2795960",
    "end": "2803040"
  },
  {
    "text": "the field which is important so so you used to have uh record ID which was",
    "start": "2803040",
    "end": "2809160"
  },
  {
    "text": "string and now you replac it with uh user ID in later version so what you do",
    "start": "2809160",
    "end": "2815680"
  },
  {
    "text": "you uh Market as reserved because what is immutable is uh uh field um",
    "start": "2815680",
    "end": "2824359"
  },
  {
    "text": "order order ID so that will no never be used but instead you introduce user ID",
    "start": "2824359",
    "end": "2831359"
  },
  {
    "text": "it must have uh number eight because up to from one to seven",
    "start": "2831359",
    "end": "2836839"
  },
  {
    "text": "already um occupied and then you change creation time to time stamp you change",
    "start": "2836839",
    "end": "2842720"
  },
  {
    "text": "uh last name to surname uh and so on and birthday to R of birth and then you can",
    "start": "2842720",
    "end": "2848359"
  },
  {
    "text": "do that and then actually we we did that uh even though it's the same mostly the",
    "start": "2848359",
    "end": "2853400"
  },
  {
    "text": "same team uh but we have over years different uh uh meaning about how things",
    "start": "2853400",
    "end": "2860319"
  },
  {
    "text": "should be named so uh so about uh event",
    "start": "2860319",
    "end": "2865680"
  },
  {
    "text": "migration so when we're talking about um surviving longent history uh we try of",
    "start": "2865680",
    "end": "2874119"
  },
  {
    "text": "course to leave with uh existing events there can be situations when we want to",
    "start": "2874119",
    "end": "2880559"
  },
  {
    "text": "migrate uh our uh events and uh in that",
    "start": "2880559",
    "end": "2885800"
  },
  {
    "text": "case of course we should prefer out of the store migration what means out of the store it's that like M migration",
    "start": "2885800",
    "end": "2892119"
  },
  {
    "text": "like in place in in in memory sort of you read the event and then uh but your",
    "start": "2892119",
    "end": "2898720"
  },
  {
    "text": "current understanding of uh its place in the states is different uh so you you",
    "start": "2898720",
    "end": "2906839"
  },
  {
    "text": "you you add some transformation of uh of its fields and this this H this happens",
    "start": "2906839",
    "end": "2912599"
  },
  {
    "text": "uh in memory so event is a mutable so uh the preference should be for for event",
    "start": "2912599",
    "end": "2919640"
  },
  {
    "text": "being immutable but uh it's good to at least to plan support for instore event migration",
    "start": "2919640",
    "end": "2927839"
  },
  {
    "text": "if you will need that so uh what can be reasons to my great event history in",
    "start": "2927839",
    "end": "2934400"
  },
  {
    "text": "store one of the reasons is performance you have uh like billions of events and",
    "start": "2934400",
    "end": "2940240"
  },
  {
    "text": "some of the events no longer valid if you're dealing with financial system probably that won't be the case because",
    "start": "2940240",
    "end": "2946839"
  },
  {
    "text": "uh everything which you ever registered will still need to be in in place but uh",
    "start": "2946839",
    "end": "2954240"
  },
  {
    "text": "in in our domain as I I was talking about uh replacing the origin like file",
    "start": "2954240",
    "end": "2961119"
  },
  {
    "text": "storage provider and then we we done with the previous file storage provider so any anything that we registered about",
    "start": "2961119",
    "end": "2969480"
  },
  {
    "text": "files placed there is no longer valid there is no such storage so and there are and we have millions of events like",
    "start": "2969480",
    "end": "2975720"
  },
  {
    "text": "that so uh we could just uh remove them uh so that's uh one of uh one example",
    "start": "2975720",
    "end": "2983760"
  },
  {
    "text": "yeah storage cleanup uh data error correction of course there can be some uh data that",
    "start": "2983760",
    "end": "2990480"
  },
  {
    "text": "were uh incorrectly registered and uh we want to to correct them um probably if",
    "start": "2990480",
    "end": "2997400"
  },
  {
    "text": "you know how to correct them they can be done uh out of storage like in memory in some situations it may require",
    "start": "2997400",
    "end": "3005440"
  },
  {
    "text": "uh um out of storage uh migration and then uh uh broken backward compatibility",
    "start": "3005440",
    "end": "3014200"
  },
  {
    "text": "which which is actually a bad sign uh usually it it shouldn't happen but uh",
    "start": "3014200",
    "end": "3021680"
  },
  {
    "text": "let's say you need to back Port changes due to new requirement uh and uh elimination of",
    "start": "3021680",
    "end": "3029119"
  },
  {
    "text": "code complexity or technical depth well uh it's good first to consider event",
    "start": "3029119",
    "end": "3034720"
  },
  {
    "text": "deprecation deletion instead of migration so again if you need to migrate event it's um probably you you",
    "start": "3034720",
    "end": "3042079"
  },
  {
    "text": "haven't designed event correctly in in the first place uh so if it's uh some",
    "start": "3042079",
    "end": "3048359"
  },
  {
    "text": "old event then you should just deprecate it and Skip when when you read your State uh your event to build a state and",
    "start": "3048359",
    "end": "3054880"
  },
  {
    "text": "there is very important event migration rules um so a new version of an event",
    "start": "3054880",
    "end": "3060559"
  },
  {
    "text": "must be convertible from the old version of the event if not it is not a new version of the event but rather a new",
    "start": "3060559",
    "end": "3066799"
  },
  {
    "text": "event and that's probably the sort of cleanest way of uh like uh migrating",
    "start": "3066799",
    "end": "3072480"
  },
  {
    "text": "your event Journal if you uh not happy with the content event Journal just some",
    "start": "3072480",
    "end": "3077920"
  },
  {
    "text": "create some new events so uh you can deprecate old events you just skip them",
    "start": "3077920",
    "end": "3084720"
  },
  {
    "text": "on reading just create new event that that will proper represent your uh what",
    "start": "3084720",
    "end": "3091240"
  },
  {
    "text": "what happened to your system so",
    "start": "3091240",
    "end": "3097760"
  },
  {
    "text": "uh with that uh I went through this uh",
    "start": "3097760",
    "end": "3104440"
  },
  {
    "text": "opinionated uh long event history Survival Guide uh this is um again something that",
    "start": "3104440",
    "end": "3111960"
  },
  {
    "text": "we practice with our domain uh in case uh you dealing with",
    "start": "3111960",
    "end": "3117640"
  },
  {
    "text": "very large number of events who dealing with billions of events nobody uh with millions of",
    "start": "3117640",
    "end": "3126319"
  },
  {
    "text": "events yeah so we are uh yeah we are dealing with millions of events so um I",
    "start": "3126319",
    "end": "3132920"
  },
  {
    "text": "guess if you uh if some of you work with online trading then uh some of",
    "start": "3132920",
    "end": "3141079"
  },
  {
    "text": "the uh advises for example event migration it's harder to deal with that",
    "start": "3141079",
    "end": "3147799"
  },
  {
    "text": "because uh typically in such system they just don't have a chance to to migrate anything they have to have to live with",
    "start": "3147799",
    "end": "3153440"
  },
  {
    "text": "that uh but uh for event journals like",
    "start": "3153440",
    "end": "3159000"
  },
  {
    "text": "with Millions events we found that by using this uh um these recommendations",
    "start": "3159000",
    "end": "3166280"
  },
  {
    "text": "we can actually uh maintain our system and keep events in place and uh after like more",
    "start": "3166280",
    "end": "3174079"
  },
  {
    "text": "than 10 years of uh um using a system still uh all events are played back and",
    "start": "3174079",
    "end": "3181440"
  },
  {
    "text": "they build state of our uh entities of our uh aggregate roots of as they say in",
    "start": "3181440",
    "end": "3190040"
  },
  {
    "text": "DDD so uh we still have some minutes and",
    "start": "3190040",
    "end": "3195400"
  },
  {
    "text": "uh do you have any questions or maybe something you want to share or disagree",
    "start": "3195400",
    "end": "3202760"
  },
  {
    "text": "with yeah please how do you how do you take SN the",
    "start": "3202760",
    "end": "3210520"
  },
  {
    "text": "EVP",
    "start": "3212760",
    "end": "3215760"
  },
  {
    "text": "sear there are different uh strategies and we using as I said we're using AKA",
    "start": "3219880",
    "end": "3225400"
  },
  {
    "text": "with u actor model framework and some of actor model framework they actually have",
    "start": "3225400",
    "end": "3231520"
  },
  {
    "text": "built on support for that which was not um efficient uh author of good",
    "start": "3231520",
    "end": "3238200"
  },
  {
    "text": "enough for us because uh uh we uh we won't have full control of dealing with",
    "start": "3238200",
    "end": "3245240"
  },
  {
    "text": "snapshots so what what happens that when uh first of all we don't take snapshots",
    "start": "3245240",
    "end": "3250880"
  },
  {
    "text": "uh uh for entities that we know won't grow in in its event history by more",
    "start": "3250880",
    "end": "3258240"
  },
  {
    "text": "than few hundred records because it's cheaper it's faster actually to read hundreds uh of events build a state then",
    "start": "3258240",
    "end": "3266720"
  },
  {
    "text": "to do snapshotting and play back events on top of it um but uh we have U uh some",
    "start": "3266720",
    "end": "3273760"
  },
  {
    "text": "entities which had thousands of uh events in history in particular those which we used in system testing what we",
    "start": "3273760",
    "end": "3280319"
  },
  {
    "text": "use in system testing uh we have some example some Test TV programs which we",
    "start": "3280319",
    "end": "3285880"
  },
  {
    "text": "every night we go through full uh process of uploading them to storage",
    "start": "3285880",
    "end": "3290960"
  },
  {
    "text": "deleting them so so it's like a few hundred events uh a night so after",
    "start": "3290960",
    "end": "3296960"
  },
  {
    "text": "several years it's the same TV program same ID so they have like hundred thousand of events and then if you try",
    "start": "3296960",
    "end": "3302920"
  },
  {
    "text": "to build it state from from EV event Journal like every time you read it no it it just it's many seconds uh it takes",
    "start": "3302920",
    "end": "3309799"
  },
  {
    "text": "many second can be actually take more than a minute sometimes and uh uh so we",
    "start": "3309799",
    "end": "3315200"
  },
  {
    "text": "have a a rule that we take snapshot every 100 rows so uh and this is uh what",
    "start": "3315200",
    "end": "3323039"
  },
  {
    "text": "happens that uh if uh event is written every event uh stored is event journal",
    "start": "3323039",
    "end": "3329640"
  },
  {
    "text": "with uh uh persistent ID which is ID of its entity uh sequence number and blobe",
    "start": "3329640",
    "end": "3338480"
  },
  {
    "text": "payload so it's very simple structure oh and event name of course so if uh",
    "start": "3338480",
    "end": "3345160"
  },
  {
    "text": "sequence number uh divided by zero division uh by 100 is zero uh so yeah",
    "start": "3345160",
    "end": "3352880"
  },
  {
    "text": "just take snapshot and then with it's it's asynchronous operation just send the command okay take snapshot so the",
    "start": "3352880",
    "end": "3359280"
  },
  {
    "text": "actually execution uh business execution goes its way but at the same time",
    "start": "3359280",
    "end": "3364559"
  },
  {
    "text": "snapshot is taken so when next time we want to read that entity uh uh and this",
    "start": "3364559",
    "end": "3371680"
  },
  {
    "text": "is actually by AKA it it sends event uh internal event like snapshot offer okay",
    "start": "3371680",
    "end": "3378480"
  },
  {
    "text": "you want to read your state but there is a snapshot offer because current sequence uh number is 3,00",
    "start": "3378480",
    "end": "3386599"
  },
  {
    "text": "120 but there is snapshot with 3,100 okay you take the snapshot and then you",
    "start": "3386599",
    "end": "3391640"
  },
  {
    "text": "play back all events after that and this is actually managed by uh this uh",
    "start": "3391640",
    "end": "3397520"
  },
  {
    "text": "offering snapshots and play back after that managed by AA but it's very easy to implement if you don't use act actor",
    "start": "3397520",
    "end": "3404000"
  },
  {
    "text": "model you can just Implement yourself so this is standard uh",
    "start": "3404000",
    "end": "3409280"
  },
  {
    "text": "procedure does it answer the",
    "start": "3409280",
    "end": "3413319"
  },
  {
    "text": "question mhm delete say thousand of you want to Del",
    "start": "3414799",
    "end": "3422880"
  },
  {
    "text": "some of years old do do do you go and delete",
    "start": "3422880",
    "end": "3430680"
  },
  {
    "text": "or do you T obviously it's another operation",
    "start": "3430680",
    "end": "3439079"
  },
  {
    "text": "database performance yeah how you do yeah first of all I must say that this was last point that support instor be",
    "start": "3439079",
    "end": "3446000"
  },
  {
    "text": "great uh I presented this talk in another conference and then it got some attention",
    "start": "3446000",
    "end": "3452760"
  },
  {
    "text": "from people okay so should we be doing it regularly and then uh I so I'm afraid",
    "start": "3452760",
    "end": "3458599"
  },
  {
    "text": "maybe I like put uh too much attention to that because in general unless you",
    "start": "3458599",
    "end": "3465280"
  },
  {
    "text": "need to uh deal with older events or migration basically the like immutable",
    "start": "3465280",
    "end": "3472079"
  },
  {
    "text": "event Journal is where you want to start with but like in our example we have",
    "start": "3472079",
    "end": "3477720"
  },
  {
    "text": "millions of events registered for like sto uh old origin which will no longer",
    "start": "3477720",
    "end": "3482960"
  },
  {
    "text": "be used and that doesn't have any s of commercial obligations uh so just uh um",
    "start": "3482960",
    "end": "3489240"
  },
  {
    "text": "since uh using event Journal uh uh which is U stored in a SQL base and then it",
    "start": "3489240",
    "end": "3496319"
  },
  {
    "text": "has a uh unique uh primary key which is a uh persistent ID and sequence number",
    "start": "3496319",
    "end": "3503400"
  },
  {
    "text": "and also there is a uh EV name uh so it's a this can be done just aside you",
    "start": "3503400",
    "end": "3511480"
  },
  {
    "text": "uh uh just run basically SQL script by uh going through the journal and",
    "start": "3511480",
    "end": "3517440"
  },
  {
    "text": "deleting those those events or or another thing which we implemented is",
    "start": "3517440",
    "end": "3522599"
  },
  {
    "text": "that the actor itself basically actor is a uh is a little demon that uh leaves in",
    "start": "3522599",
    "end": "3531000"
  },
  {
    "text": "uh Associated like entity like actor is TV program actor is radio program me",
    "start": "3531000",
    "end": "3536280"
  },
  {
    "text": "actor model it works like that so when when the actor starts which mean that particular TV program uh is being",
    "start": "3536280",
    "end": "3542799"
  },
  {
    "text": "executed we want to do something with that it can uh analyze it say okay by the way I have some old events uh and",
    "start": "3542799",
    "end": "3549640"
  },
  {
    "text": "then okay let me clean it up so depending on how you want to implement it just by uh doing it at once running a",
    "start": "3549640",
    "end": "3558960"
  },
  {
    "text": "script you can do that or but we like have U self uh maintaining actors",
    "start": "3558960",
    "end": "3567280"
  },
  {
    "text": "because we're using actor models so typically when actor awakes it cleans up",
    "start": "3567280",
    "end": "3572559"
  },
  {
    "text": "like it it looks at okay do I have something I need to do better okay I have some old events let let me sort of",
    "start": "3572559",
    "end": "3579079"
  },
  {
    "text": "clean it up I have uh something that spend some painting work let me do some upload some files something like so it's",
    "start": "3579079",
    "end": "3586039"
  },
  {
    "text": "a like both will work any more",
    "start": "3586039",
    "end": "3592880"
  },
  {
    "text": "questions okay",
    "start": "3594359",
    "end": "3598038"
  },
  {
    "text": "few something like like an oracle for example",
    "start": "3609920",
    "end": "3614680"
  },
  {
    "text": "MH uh I think that uh for logically probably it uh like usage of it will be",
    "start": "3630760",
    "end": "3638400"
  },
  {
    "text": "uh it will the same purpose it's just that materials use something that is offered by your your database typically",
    "start": "3638400",
    "end": "3646559"
  },
  {
    "text": "uh snapshot is uh when we uh we have sort of minimal focus on",
    "start": "3646559",
    "end": "3653640"
  },
  {
    "text": "the database uh and uh uh if you if you look",
    "start": "3653640",
    "end": "3658960"
  },
  {
    "text": "at our uh event Journal it has uh two tables one is like event Journal table",
    "start": "3658960",
    "end": "3666880"
  },
  {
    "text": "which is very simple consists of persistance ID sequence number payload and like event name and another table",
    "start": "3666880",
    "end": "3674599"
  },
  {
    "text": "snapshot so uh and we decide that okay every once in a while we take this snapshot so if you uh if if if your",
    "start": "3674599",
    "end": "3682000"
  },
  {
    "text": "database offers you materialized view which will be automatically managed so you will get get like latest uh dat then",
    "start": "3682000",
    "end": "3688240"
  },
  {
    "text": "uh you can do that but um uh we try to not to delegate to",
    "start": "3688240",
    "end": "3696240"
  },
  {
    "text": "database um uh like",
    "start": "3696240",
    "end": "3702200"
  },
  {
    "text": "business tasks and like building snapshot because snapshot is a is your",
    "start": "3702200",
    "end": "3708160"
  },
  {
    "text": "state so it's it's kind of business logic so you you apply your business logic to uh to your events and you bu",
    "start": "3708160",
    "end": "3715960"
  },
  {
    "text": "build your state so we we want have sort of to have full control of it and then don't don't let sort of database to to",
    "start": "3715960",
    "end": "3723240"
  },
  {
    "text": "be responsible for for for building uh state from event so I think it's a it's",
    "start": "3723240",
    "end": "3730839"
  },
  {
    "text": "more like implementation choice where what you prefer so if uh if it gives you exactly what what you want like the",
    "start": "3730839",
    "end": "3737119"
  },
  {
    "text": "state of your uh entity then then it should be good enough but we just",
    "start": "3737119",
    "end": "3742520"
  },
  {
    "text": "periodically take snapshot and this is this is also transition in actor based model because you have an actor which",
    "start": "3742520",
    "end": "3749279"
  },
  {
    "text": "build from events and then for optimization reason you you take snapshots which goes in different",
    "start": "3749279",
    "end": "3757359"
  },
  {
    "text": "table okay um if there are no more questions then thank you very much for",
    "start": "3758359",
    "end": "3764279"
  },
  {
    "text": "coming to my talk and there are couple of other talks still on Friday so enjoy",
    "start": "3764279",
    "end": "3770039"
  },
  {
    "text": "the rest of the conference thank you very much",
    "start": "3770039",
    "end": "3774558"
  }
]