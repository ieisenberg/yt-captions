[
  {
    "text": "all right uh welcome everybody um today we're going to be talking about security deploying infrastructures code",
    "start": "1079",
    "end": "9080"
  },
  {
    "text": "my name is Chris Ayers I'm a senior customer engineer at Microsoft I'm",
    "start": "9080",
    "end": "14280"
  },
  {
    "text": "actually part of the Azure engineering teams I'm on a team called the fast",
    "start": "14280",
    "end": "19320"
  },
  {
    "text": "track for Azure one of the things we do is we help customers deploy their",
    "start": "19320",
    "end": "26160"
  },
  {
    "text": "solutions to Azure we help them do it more securely more quickly kind of accelerate their adoption of azure and",
    "start": "26160",
    "end": "33000"
  },
  {
    "text": "that's one of the things I do and I'm actually one of the category leads for",
    "start": "33000",
    "end": "38040"
  },
  {
    "text": "devops on Fast Track so we I talk with service leads from across Microsoft",
    "start": "38040",
    "end": "44840"
  },
  {
    "text": "leveraging different Technologies through devops practices you can find me on Twitter Mastodon LinkedIn and there's",
    "start": "44840",
    "end": "54180"
  },
  {
    "text": "some blog posts about this topic on my blog and all this code and all my",
    "start": "54180",
    "end": "59280"
  },
  {
    "text": "samples will be out on my GitHub so I want to start with what is",
    "start": "59280",
    "end": "64320"
  },
  {
    "text": "infrastructure's code just at a kind of a high level what we're talking about uh security tooling some of the choices out",
    "start": "64320",
    "end": "69900"
  },
  {
    "text": "there and why we might want to use them how we can deal with you know rules and customizations some of the workflows we",
    "start": "69900",
    "end": "76260"
  },
  {
    "text": "can leverage for leveraging security in terraform and then we're going to look",
    "start": "76260",
    "end": "81960"
  },
  {
    "text": "at a bunch of the integration points um like pre-commit hooks if you guys aren't aware of those they're awesome",
    "start": "81960",
    "end": "87659"
  },
  {
    "text": "some of the extensions for vs code and how we can integrate them into our pipeline through actions",
    "start": "87659",
    "end": "94140"
  },
  {
    "text": "so you know infrastructure is code I think a lot of us might be familiar",
    "start": "94140",
    "end": "99360"
  },
  {
    "text": "with it but this is a way that we can manage and provision our infrastructure we have it checked in we can use config",
    "start": "99360",
    "end": "105119"
  },
  {
    "text": "files we can do pull requests we can review it and because we can do infrastructure allocation through code",
    "start": "105119",
    "end": "112200"
  },
  {
    "text": "we can also analyze it and use security tooling to try to look for some of our",
    "start": "112200",
    "end": "119040"
  },
  {
    "text": "biggest problems like misconfiguration a lot of the tools I'm going to be",
    "start": "119040",
    "end": "124320"
  },
  {
    "text": "covering today are SAS tools so they're static analysis tools these are going to",
    "start": "124320",
    "end": "129360"
  },
  {
    "text": "be analyzing your HCL files that the hashicorp language terraform files and",
    "start": "129360",
    "end": "136020"
  },
  {
    "text": "that's how they operate so it can look for properties that should be set that aren't set or maybe properties that have",
    "start": "136020",
    "end": "142860"
  },
  {
    "text": "been set incorrectly um and I don't think I'm really speaking",
    "start": "142860",
    "end": "149340"
  },
  {
    "text": "new information anybody here but why would we want to use security tooling on our infrastructure as code I know that",
    "start": "149340",
    "end": "155819"
  },
  {
    "text": "we want to do it when we're monitoring we want to run it on our our software that we're building but the",
    "start": "155819",
    "end": "161340"
  },
  {
    "text": "infrastructure we build is as fragile sometimes as the software we build we need to catch these issues early and in",
    "start": "161340",
    "end": "168360"
  },
  {
    "text": "a lot of cases in a lot of Industries we have to do compliance we have to make sure things meet all the regulatory",
    "start": "168360",
    "end": "174300"
  },
  {
    "text": "needs that we have this will let us improve that security over time and Save",
    "start": "174300",
    "end": "180959"
  },
  {
    "text": "a lot of uh not only bad press but but issues to our organizations",
    "start": "180959",
    "end": "189200"
  },
  {
    "text": "um as far as compliance goes there's been a lot of breaches due to misconfiguration",
    "start": "189420",
    "end": "196220"
  },
  {
    "text": "there's multiple reports out there of storage accounts being left publicly",
    "start": "196220",
    "end": "201720"
  },
  {
    "text": "accessible databases that have public IPS associated with them rules that",
    "start": "201720",
    "end": "207060"
  },
  {
    "text": "aren't being set in firewalls identities that you know have full access to things and",
    "start": "207060",
    "end": "213900"
  },
  {
    "text": "a lot of times you can look right over them and not even notice the",
    "start": "213900",
    "end": "219060"
  },
  {
    "text": "misconfiguration so this is where the tooling and the rules can come into play and help us identify these very quickly",
    "start": "219060",
    "end": "227180"
  },
  {
    "text": "um the OS top 10 that's been talked about a lot so we've seen from from 2017 to 2021",
    "start": "227640",
    "end": "236879"
  },
  {
    "text": "security misconfiguration is number five on that list you know we're misconfiguring our our",
    "start": "236879",
    "end": "243299"
  },
  {
    "text": "stuff kubernetes number one is like insecure workload configuration so",
    "start": "243299",
    "end": "248580"
  },
  {
    "text": "configurations are things that are so easy to mess up",
    "start": "248580",
    "end": "253799"
  },
  {
    "text": "um if we go out here to this",
    "start": "253799",
    "end": "257180"
  },
  {
    "text": "like 20 percent um incident rate it's moved up",
    "start": "262380",
    "end": "270918"
  },
  {
    "text": "I've saw a number of reports that like 99 of businesses are going to face some",
    "start": "271380",
    "end": "276479"
  },
  {
    "text": "sort of security issue and most of them were like users fault through misconfiguration through",
    "start": "276479",
    "end": "283380"
  },
  {
    "text": "um inappropriate you know not scanned properly 60 of businesses that have breaches most",
    "start": "283380",
    "end": "290520"
  },
  {
    "text": "of them are going to be coming from some misconfiguration as well as through hacking attempts because of that so it's",
    "start": "290520",
    "end": "296220"
  },
  {
    "text": "definitely something that we need to be aware of and keep in mind",
    "start": "296220",
    "end": "301380"
  },
  {
    "text": "so we can't just wait till it's running out there in production we can't I've worked",
    "start": "301380",
    "end": "308220"
  },
  {
    "text": "at organizations where you know we've built the app we've got it ready",
    "start": "308220",
    "end": "313380"
  },
  {
    "text": "and then right before we go to production hey let's do our security audit let's do our Security review those",
    "start": "313380",
    "end": "319380"
  },
  {
    "text": "days are long gone we we can't operate like that even going through a pull",
    "start": "319380",
    "end": "324900"
  },
  {
    "text": "request sometimes when you get to that pull request point it's too late you've already started committing to an",
    "start": "324900",
    "end": "330660"
  },
  {
    "text": "architecture and you need to start catching those things earlier than a pull request so I'm going to show some tooling that helps from the developer",
    "start": "330660",
    "end": "337620"
  },
  {
    "text": "standpoint now all of these things are specific to terraform but they do more than just",
    "start": "337620",
    "end": "343560"
  },
  {
    "text": "terraform many of these tools will also look at Docker files they'll look at kubernetes configuration files or Helm",
    "start": "343560",
    "end": "350639"
  },
  {
    "text": "charts they'll look at at pipeline so you can leverage these as part of your",
    "start": "350639",
    "end": "355860"
  },
  {
    "text": "bigger ecosystem of tooling but these are really great for looking at",
    "start": "355860",
    "end": "361259"
  },
  {
    "text": "terraform in its own way um a lot of them will start with just the",
    "start": "361259",
    "end": "367020"
  },
  {
    "text": "HCL file so terraform files are all written in hashicorp language it's a domain-specific language designed for",
    "start": "367020",
    "end": "373440"
  },
  {
    "text": "infrastructure as code this can look at the raw files of the terraform uh you know modules and and",
    "start": "373440",
    "end": "381060"
  },
  {
    "text": "can find those misconfigurations but a lot of the tooling can also look at your terraform plan terraform plan happens",
    "start": "381060",
    "end": "388199"
  },
  {
    "text": "after it takes all of your variables and your inputs and figures out what it wants to actually build like with real",
    "start": "388199",
    "end": "394680"
  },
  {
    "text": "names and security so you can analyze things from both your raw files as well",
    "start": "394680",
    "end": "400020"
  },
  {
    "text": "as your interpolated you know strings and resources so that you can look at",
    "start": "400020",
    "end": "405360"
  },
  {
    "text": "the actual plan to do the analysis so we can leverage both of these to kind of",
    "start": "405360",
    "end": "410400"
  },
  {
    "text": "give us a better picture into what's going to be happening I've looked at three I've already talked",
    "start": "410400",
    "end": "416340"
  },
  {
    "text": "with some people they're they're more and they all have varying degrees of",
    "start": "416340",
    "end": "421620"
  },
  {
    "text": "support um the three I'm talking about today are tfsec Terror scan and check off now all",
    "start": "421620",
    "end": "430020"
  },
  {
    "text": "these you can integrate with your CI CD multiple ones of the multiple rules for each service you can write your own",
    "start": "430020",
    "end": "437280"
  },
  {
    "text": "custom rules some of them use Rego like right out of oppa so we we can use Rego",
    "start": "437280",
    "end": "444120"
  },
  {
    "text": "to write some rules for some of these you can whitelist things you can also ignore things so there are capabilities",
    "start": "444120",
    "end": "452060"
  },
  {
    "text": "to set like an expiration time like I want to ignore this rule for a week you",
    "start": "452060",
    "end": "458280"
  },
  {
    "text": "can do that you can have your own custom ruling now tfsec",
    "start": "458280",
    "end": "465300"
  },
  {
    "text": "uh tfsec that one is supported by Aqua security you might know the them from",
    "start": "465300",
    "end": "470639"
  },
  {
    "text": "some of the stuff they do with trivia scan is I think through Bridge crew and",
    "start": "470639",
    "end": "478680"
  },
  {
    "text": "um checkup iPad brain skipping me but I think that might just be my check off but",
    "start": "478680",
    "end": "485340"
  },
  {
    "text": "um all of these are out on GitHub all these have you can go in and look at the rules",
    "start": "485340",
    "end": "490800"
  },
  {
    "text": "that they've they've written and developed um I'm going to show some examples of",
    "start": "490800",
    "end": "495840"
  },
  {
    "text": "how to ignore rules how to override rules and when I say override that might mean",
    "start": "495840",
    "end": "501180"
  },
  {
    "text": "there's a vulnerability that it says is low and in your organization in your industry that might be something that's",
    "start": "501180",
    "end": "508199"
  },
  {
    "text": "required so you might make it a high or a critical so that it is acted upon",
    "start": "508199",
    "end": "513419"
  },
  {
    "text": "breaks things um and then you can add your own additional custom rules and there are some of those out there on GitHub that",
    "start": "513419",
    "end": "519779"
  },
  {
    "text": "you can find and consume and share with others so starting with tfsec",
    "start": "519779",
    "end": "526680"
  },
  {
    "text": "um like I said it's a stack analysis tool it does support kind of like Opa Rego",
    "start": "526680",
    "end": "533220"
  },
  {
    "text": "style policies they provide a vs code extension which I'm going to show you so that you can integrate it into your",
    "start": "533220",
    "end": "539220"
  },
  {
    "text": "editor as your writing infrastructure as code it also supports uh like pre-commit",
    "start": "539220",
    "end": "544680"
  },
  {
    "text": "hooks so we can actually stop insecure terraform being checked in it also",
    "start": "544680",
    "end": "551100"
  },
  {
    "text": "integrates with GitHub actions and then we can use the pr commenter to add any",
    "start": "551100",
    "end": "557399"
  },
  {
    "text": "passing or failing test information onto the pr so you can see it right during",
    "start": "557399",
    "end": "562580"
  },
  {
    "text": "the pr discussion you can see here some of the failing results of the TF sex",
    "start": "562580",
    "end": "571019"
  },
  {
    "text": "scan um we're also going to talk about Terror skin this one like I said is one of",
    "start": "571019",
    "end": "576899"
  },
  {
    "text": "those tools that supports multiple clouds so pure terraform but it also supports like Azure arm templates it",
    "start": "576899",
    "end": "583860"
  },
  {
    "text": "supports gcp and AWS uh like kubernetes support docker",
    "start": "583860",
    "end": "589260"
  },
  {
    "text": "Docker file support and it will actually check your GitHub workflows like if you maybe have too much permission on your",
    "start": "589260",
    "end": "595260"
  },
  {
    "text": "your workflows they'll be like yeah somebody malicious might be able to modify your code you might not want that",
    "start": "595260",
    "end": "602580"
  },
  {
    "text": "um this also supports Rego policies so you can see uh some of the skipped",
    "start": "602580",
    "end": "608339"
  },
  {
    "text": "validations some of the summaries occasionally some of these tools can also offer fixes as well as links to",
    "start": "608339",
    "end": "614880"
  },
  {
    "text": "documentation on how to resolve the failed policies and finally check off okay checkout was",
    "start": "614880",
    "end": "620820"
  },
  {
    "text": "Bridge queue okay attainable is Terror scan my mistake",
    "start": "620820",
    "end": "626220"
  },
  {
    "text": "sorry about that um this also this is python based so this is not",
    "start": "626220",
    "end": "632760"
  },
  {
    "text": "um go or Rego inspired like some of the others this is more python based but it",
    "start": "632760",
    "end": "637920"
  },
  {
    "text": "does support multiple languages and kubernetes and Docker scanning so like I said you can layer multiple of these",
    "start": "637920",
    "end": "644880"
  },
  {
    "text": "tools together um there's another tool that I just wanted to throw in here because I",
    "start": "644880",
    "end": "650279"
  },
  {
    "text": "thought it was interesting for those that are very developer focused you can do bdd like compliance testing with this",
    "start": "650279",
    "end": "656640"
  },
  {
    "text": "project which is really interesting because um you can write like cucumber",
    "start": "656640",
    "end": "662519"
  },
  {
    "text": "like gherkin type syntax and that can actually generate the appropriate",
    "start": "662519",
    "end": "669740"
  },
  {
    "text": "tests for you for your infrastructure so I just I came across this I thought it was really cool and I wanted to share it",
    "start": "669740",
    "end": "676019"
  },
  {
    "text": "um I just like sharing interesting things so um I'm a big fan of kind of layering",
    "start": "676019",
    "end": "682500"
  },
  {
    "text": "these each of these kind of looks at a different aspect their rules are not 100 Venn diagram like one Circle each tool",
    "start": "682500",
    "end": "690300"
  },
  {
    "text": "has some policies and rules that",
    "start": "690300",
    "end": "696060"
  },
  {
    "text": "cover some and ignore others and by leveraging multiple of these tools you",
    "start": "696060",
    "end": "701220"
  },
  {
    "text": "can kind of get better coverage now you can also face the small problem of maybe a little bit too much noise to the the",
    "start": "701220",
    "end": "707459"
  },
  {
    "text": "real signal that's where looking at how to ignore or white list certain rules can be very important",
    "start": "707459",
    "end": "714540"
  },
  {
    "text": "um yeah um so let's look at the workflow and",
    "start": "714540",
    "end": "721019"
  },
  {
    "text": "then we're going to get to into a lot of demos so are you guys familiar with pre-commit hooks and I'm sure some of",
    "start": "721019",
    "end": "726600"
  },
  {
    "text": "you are but everybody a big fan of them like yeah I love pre-commit hooks I",
    "start": "726600",
    "end": "732420"
  },
  {
    "text": "think they're really interesting um there's a pre-commit framework so and I'm going to show you that and then",
    "start": "732420",
    "end": "737700"
  },
  {
    "text": "we're going to dive into the extensions for some of the available tooling and the CI CD Integrations",
    "start": "737700",
    "end": "743399"
  },
  {
    "text": "so pre-commit hooks so when you're dealing with Git there's a couple of things happen a lot",
    "start": "743399",
    "end": "750180"
  },
  {
    "text": "of times when we're done talking about CI CD pipelines and we're talking about running things for validation in our",
    "start": "750180",
    "end": "756480"
  },
  {
    "text": "pipelines it's already been committed and it's already been um pushed to the cloud so if you've",
    "start": "756480",
    "end": "764820"
  },
  {
    "text": "checked in a secret if you've checked in the wrong stuff and maybe like started to build it it's already committed it's",
    "start": "764820",
    "end": "771180"
  },
  {
    "text": "already in the history and it's already up there so the way we stop that is during the commit process when you start",
    "start": "771180",
    "end": "777660"
  },
  {
    "text": "a commit you then there's a pre-commit hook so that you can run tests before it actually gets written to the disk and",
    "start": "777660",
    "end": "784440"
  },
  {
    "text": "actually get saved or even gets committed um you know you you make the committed",
    "start": "784440",
    "end": "790380"
  },
  {
    "text": "object you get your message and then you save it to the file system there's another hook that is for when you're",
    "start": "790380",
    "end": "796139"
  },
  {
    "text": "pushing stuff to your your origin The pre-receive Hook and the post receive",
    "start": "796139",
    "end": "801300"
  },
  {
    "text": "hook so like GitHub secret scanning that that kind of happens on the pre-receive hook so maybe you've committed it",
    "start": "801300",
    "end": "808260"
  },
  {
    "text": "locally but they won't let you push it to the cloud and the pre-commit framework is",
    "start": "808260",
    "end": "815100"
  },
  {
    "text": "something that is phenomenal so this is the pre-commit framework when you add it it's python",
    "start": "815100",
    "end": "822360"
  },
  {
    "text": "based and it runs off of a yaml file so",
    "start": "822360",
    "end": "828060"
  },
  {
    "text": "like this is our yaml file for pre-commit and",
    "start": "828060",
    "end": "834420"
  },
  {
    "text": "it will pull from different repositories um options like executables or scripts",
    "start": "834420",
    "end": "841440"
  },
  {
    "text": "that you might want to run every time you try to check in a file so for this example every time I try to check",
    "start": "841440",
    "end": "847920"
  },
  {
    "text": "something in it'll make sure it's valid Gamel that there's no end of file new lines there's no ending white space it",
    "start": "847920",
    "end": "854639"
  },
  {
    "text": "you know you can do different scripts automatically and tfsac Terry",
    "start": "854639",
    "end": "860700"
  },
  {
    "text": "scan and Chekhov all have through their own support or third-party",
    "start": "860700",
    "end": "865760"
  },
  {
    "text": "pre-commit hooks to run those tools the other amazing thing about the pre-commit",
    "start": "865760",
    "end": "871260"
  },
  {
    "text": "framework is it will let you download the required executables or like",
    "start": "871260",
    "end": "876839"
  },
  {
    "text": "download the dependencies before it needs to run them so it's really nice so let us",
    "start": "876839",
    "end": "884820"
  },
  {
    "text": "come over here to vs code and let me switch to a pre-commit",
    "start": "884820",
    "end": "891079"
  },
  {
    "text": "stash that all right",
    "start": "893639",
    "end": "899240"
  },
  {
    "text": "so I've added a pre-commit hook here so I've got some of the normal like white space yaml",
    "start": "900000",
    "end": "908699"
  },
  {
    "text": "I've got one from bridge crew for Chekhov and then",
    "start": "908699",
    "end": "914220"
  },
  {
    "text": "um from grunt work I've got TF lint and terraform format and validate so every",
    "start": "914220",
    "end": "919260"
  },
  {
    "text": "time I try to commit something it can run a format it can run a validate I can run check off and one way you can do",
    "start": "919260",
    "end": "926279"
  },
  {
    "text": "this is you can run pre-commit run on like all your files",
    "start": "926279",
    "end": "932399"
  },
  {
    "text": "and that happened really fast but you can see",
    "start": "932399",
    "end": "938220"
  },
  {
    "text": "oh it found a trailing white space some files were modified it noticed uh there was an end",
    "start": "938220",
    "end": "944519"
  },
  {
    "text": "of file thing and if I check over here some of these files were all changed if I try you know I'm manually running it",
    "start": "944519",
    "end": "951420"
  },
  {
    "text": "right here so that's just me manually running it let's say I want to bring in",
    "start": "951420",
    "end": "958760"
  },
  {
    "text": "some files from a demo and I want to try to commit those so I want to commit",
    "start": "966120",
    "end": "971760"
  },
  {
    "text": "these couple of files",
    "start": "971760",
    "end": "974720"
  },
  {
    "text": "so there it's taking a little bit because it's getting",
    "start": "979980",
    "end": "985440"
  },
  {
    "text": "it's running the check off which the first time you run it on a branch it might take it a sec to pull down some of",
    "start": "985440",
    "end": "991380"
  },
  {
    "text": "the the policies but what I'm expecting to see is this commit to fail to not let me check",
    "start": "991380",
    "end": "998339"
  },
  {
    "text": "in this terraform that I brought in and I can manually run it by hand but",
    "start": "998339",
    "end": "1003920"
  },
  {
    "text": "I'm kind of wait kind of for the the commit to to go through",
    "start": "1003920",
    "end": "1010360"
  },
  {
    "text": "let me see if I can bring up my console get the output",
    "start": "1011600",
    "end": "1019180"
  },
  {
    "text": "all right I'll just run by hand",
    "start": "1021620",
    "end": "1024939"
  },
  {
    "text": "yeah so it's it's like I said it's the check off that's taking it a sec",
    "start": "1029000",
    "end": "1034280"
  },
  {
    "text": "um once you've run it once or twice yeah so it's not even going to let me check",
    "start": "1034280",
    "end": "1040160"
  },
  {
    "text": "it in but it's already run a bunch of yep there it is show command output",
    "start": "1040160",
    "end": "1045798"
  },
  {
    "text": "so this was the output of the check-in and it's passed you can see it's running",
    "start": "1045799",
    "end": "1052220"
  },
  {
    "text": "various various checks and we'll dive into what",
    "start": "1052220",
    "end": "1058160"
  },
  {
    "text": "those checks are but you know I have a storage account ensure that they use replication ensure",
    "start": "1058160",
    "end": "1064160"
  },
  {
    "text": "they have strong naming accounts ensure um I have trusted services or only https so",
    "start": "1064160",
    "end": "1071480"
  },
  {
    "text": "right now I've got this storage account exposed to http I mean let me let me go take a look at",
    "start": "1071480",
    "end": "1077720"
  },
  {
    "text": "this terrible insecure thing see what we're talking about",
    "start": "1077720",
    "end": "1083299"
  },
  {
    "text": "it really is one of the samples right out of",
    "start": "1083299",
    "end": "1088400"
  },
  {
    "text": "the documentation like this is",
    "start": "1088400",
    "end": "1093559"
  },
  {
    "text": "right out of the terraform docks so if I went out to you know I know it's shocking right",
    "start": "1093559",
    "end": "1099740"
  },
  {
    "text": "so if I go out to the terraform docks this is what we've got we've got standard GRS",
    "start": "1099740",
    "end": "1106520"
  },
  {
    "text": "and a tag that's all we've got there but if we look at the output of checkoff",
    "start": "1106520",
    "end": "1113840"
  },
  {
    "text": "for instance and we dive into what this is saying",
    "start": "1113840",
    "end": "1121600"
  },
  {
    "text": "you know ensure critical or replicated with maybe a customer managed keys",
    "start": "1128120",
    "end": "1133760"
  },
  {
    "text": "um you know and there was the one I was looking for it",
    "start": "1133760",
    "end": "1140720"
  },
  {
    "text": "was the https one yeah it's found stuff in a number of these samples",
    "start": "1140720",
    "end": "1147380"
  },
  {
    "text": "you know app Services looking at error messages like that's not important right",
    "start": "1147380",
    "end": "1153919"
  },
  {
    "text": "disable HTTP yeah who cares those aren't very important",
    "start": "1153919",
    "end": "1160659"
  },
  {
    "text": "so how do we control these a little bit and learn more about them well one there's a guide",
    "start": "1161539",
    "end": "1168380"
  },
  {
    "text": "here there's documentation and this is pretty much the same on any of the",
    "start": "1168380",
    "end": "1173679"
  },
  {
    "text": "services that we have so if we go out here to like the bridge group docs for checkoff",
    "start": "1173679",
    "end": "1180200"
  },
  {
    "text": "they've documented each and every one of their checks now this applies to AWS you",
    "start": "1180200",
    "end": "1185780"
  },
  {
    "text": "can see there's a bunch of AWS policies there's kubernetes policies here is our Azure policies and they have an index of",
    "start": "1185780",
    "end": "1193280"
  },
  {
    "text": "all of the various um you know let's look at the general ones",
    "start": "1193280",
    "end": "1198860"
  },
  {
    "text": "you know doing make sure that we have alert set or threat",
    "start": "1198860",
    "end": "1204320"
  },
  {
    "text": "detection so just out of the box we can leverage some of these to improve the security of our individual applications",
    "start": "1204320",
    "end": "1210200"
  },
  {
    "text": "now we can learn from these and go oh this is way too much noise you know for",
    "start": "1210200",
    "end": "1216200"
  },
  {
    "text": "some you know so we want to make sure TLS is",
    "start": "1216200",
    "end": "1222020"
  },
  {
    "text": "set well looking at this it's telling us how to fix it in the CLI it's also saying",
    "start": "1222020",
    "end": "1228140"
  },
  {
    "text": "hey in terraform we really should add Min TLS version one two",
    "start": "1228140",
    "end": "1234620"
  },
  {
    "text": "you know if I'm looking at my code here um",
    "start": "1234620",
    "end": "1239200"
  },
  {
    "text": "close my terminal",
    "start": "1241220",
    "end": "1243940"
  },
  {
    "text": "because I've added the extensions and I'm going to dive into them in a sec I'm also seeing the alerts right in my",
    "start": "1246440",
    "end": "1252740"
  },
  {
    "text": "interface in in vs code and I can get the links to these",
    "start": "1252740",
    "end": "1258320"
  },
  {
    "text": "specific things so if I add my mint TLS version that should get rid of one of them",
    "start": "1258320",
    "end": "1265280"
  },
  {
    "text": "now you don't have to have the pre-commit hooks like it",
    "start": "1265280",
    "end": "1270799"
  },
  {
    "text": "it can't slow you down every time you commit but it's also a good thing it's a",
    "start": "1270799",
    "end": "1275900"
  },
  {
    "text": "reality check that you need and and looking at these we can you know going",
    "start": "1275900",
    "end": "1281299"
  },
  {
    "text": "back to the documentation here it's very easy to white list",
    "start": "1281299",
    "end": "1287380"
  },
  {
    "text": "tweak them in some way um they offer some additional dashboarding",
    "start": "1287380",
    "end": "1294260"
  },
  {
    "text": "and tooling for their stuff but most every time you want to ignore or white",
    "start": "1294260",
    "end": "1299960"
  },
  {
    "text": "list or enforce a rule it's usually some sort of comment right in your terraform",
    "start": "1299960",
    "end": "1306140"
  },
  {
    "text": "and it's documented right there like check off ignore and you put the",
    "start": "1306140",
    "end": "1311179"
  },
  {
    "text": "specific rule a lot of times they have an option to let you have an ex a time period with an",
    "start": "1311179",
    "end": "1317960"
  },
  {
    "text": "expiration so it's good for 24 hours it's good for 48 hours there's also a like configuration files",
    "start": "1317960",
    "end": "1325940"
  },
  {
    "text": "like we can on on some of these we can specify like",
    "start": "1325940",
    "end": "1331580"
  },
  {
    "text": "overrides so TF SEC for instance the https is a low warning for TF sec I",
    "start": "1331580",
    "end": "1339919"
  },
  {
    "text": "might want to make it a critical warning so that this stuff is very easy to to",
    "start": "1339919",
    "end": "1345500"
  },
  {
    "text": "tweak and customize let me",
    "start": "1345500",
    "end": "1351039"
  },
  {
    "text": "go back to",
    "start": "1351500",
    "end": "1355400"
  },
  {
    "text": "the slides so that's how we can do the pre-commit hook um and and like I said uh let me just",
    "start": "1358760",
    "end": "1366380"
  },
  {
    "text": "finish that thought so TF SEC for instance oh you'll find that out at tfsec.dev they have a lot of",
    "start": "1366380",
    "end": "1373539"
  },
  {
    "text": "documentation there they have the guides that you can",
    "start": "1373539",
    "end": "1380019"
  },
  {
    "text": "um easily add it they have installation for um installing it through go installing",
    "start": "1380059",
    "end": "1387380"
  },
  {
    "text": "it locally on the machine and then out in their code repo this is where they have their like pre-commit hook TF SEC",
    "start": "1387380",
    "end": "1396020"
  },
  {
    "text": "right here so they have I want to run use go Lang I want to run TF sec",
    "start": "1396020",
    "end": "1401299"
  },
  {
    "text": "you know I want to scan for Docker that one has one",
    "start": "1401299",
    "end": "1406480"
  },
  {
    "text": "you already saw the check off one and then uh Terror scan you can install through the pre-commit hook",
    "start": "1406700",
    "end": "1413980"
  },
  {
    "text": "so IDE wise Terra scan doesn't really have a plug-in but check off and tfsec do so this is a",
    "start": "1414860",
    "end": "1424039"
  },
  {
    "text": "visual studio code plug-in where it actually adds into the editor over here on the side",
    "start": "1424039",
    "end": "1431740"
  },
  {
    "text": "tfsac and you can uh hit this to download the latest version of TF SEC if you don't already",
    "start": "1431740",
    "end": "1438200"
  },
  {
    "text": "have it and then you can run tfsec against your current",
    "start": "1438200",
    "end": "1443320"
  },
  {
    "text": "environment and it'll give you the output you'll see all the rules that it's run scan all the the files and then",
    "start": "1443320",
    "end": "1450500"
  },
  {
    "text": "it will update the findings Explorer over here on the side so I can look at oh I have a key Vault",
    "start": "1450500",
    "end": "1456260"
  },
  {
    "text": "issue in this demo I can see down here",
    "start": "1456260",
    "end": "1461360"
  },
  {
    "text": "the specific ID so if I need to White list or ignore this rule I can take this specific ID of the rule",
    "start": "1461360",
    "end": "1469659"
  },
  {
    "text": "impact so it'll try to explain why the rule is triggering why it's important",
    "start": "1469659",
    "end": "1474919"
  },
  {
    "text": "and why you need to resolve it and the specific file that was affected and aqua",
    "start": "1474919",
    "end": "1480380"
  },
  {
    "text": "is usually really good about stuff so they have links right to the specific right up on that rule",
    "start": "1480380",
    "end": "1488679"
  },
  {
    "text": "so and with a lot of stuff it's just a little bit",
    "start": "1490159",
    "end": "1495559"
  },
  {
    "text": "of terraform that is the difference between something that's secure and something that is wide open",
    "start": "1495559",
    "end": "1502159"
  },
  {
    "text": "and it's so easy to miss like I know there are some previous talks about code reviews",
    "start": "1502159",
    "end": "1509000"
  },
  {
    "text": "and PRS laughs uh we were joking if it's a 500 line PR",
    "start": "1509000",
    "end": "1515840"
  },
  {
    "text": "hey it looks good if it's a one file PR you missed a semicolon spacing like",
    "start": "1515840",
    "end": "1521299"
  },
  {
    "text": "indentation like this stuff slips through so easily so the tooling can",
    "start": "1521299",
    "end": "1526940"
  },
  {
    "text": "help you do that so that that's the um TF SEC extension the checkoff",
    "start": "1526940",
    "end": "1534140"
  },
  {
    "text": "extension is a little different I it doesn't actually add on the left hand side of your bar you got to kind of",
    "start": "1534140",
    "end": "1539600"
  },
  {
    "text": "bring up the command palette and it provides a couple of things you can install or update check off they",
    "start": "1539600",
    "end": "1546380"
  },
  {
    "text": "have specific settings you can get into and you can see down at the bottom of my screen the version of check off I'm",
    "start": "1546380",
    "end": "1551779"
  },
  {
    "text": "running which is 2.2 so I can run a check off scan and it adds its output to the problems",
    "start": "1551779",
    "end": "1560900"
  },
  {
    "text": "so it's showing me for every single file the security issues the checkoff is",
    "start": "1560900",
    "end": "1566480"
  },
  {
    "text": "found with links to the specific checkoff rules",
    "start": "1566480",
    "end": "1572559"
  },
  {
    "text": "so both of these are phenomenal for improving infrastructure and development",
    "start": "1576919",
    "end": "1583100"
  },
  {
    "text": "um awareness during that that inner loop",
    "start": "1583100",
    "end": "1589480"
  },
  {
    "text": "all right well let's say you know people aren't using pre-commit hooks let's say they didn't install",
    "start": "1592640",
    "end": "1599720"
  },
  {
    "text": "these extensions how do we integrate these with a pipeline how do we kind of",
    "start": "1599720",
    "end": "1605840"
  },
  {
    "text": "get this stuff running in our PRS well",
    "start": "1605840",
    "end": "1612679"
  },
  {
    "text": "for that well um one other small thing if you are",
    "start": "1612679",
    "end": "1618559"
  },
  {
    "text": "using Dev containers like if you're using containers to develop your stuff locally like you want to have python",
    "start": "1618559",
    "end": "1624380"
  },
  {
    "text": "installed in your your Docker container there are features available to add to",
    "start": "1624380",
    "end": "1630500"
  },
  {
    "text": "your Dev container so that even if you don't have tfsat and Terra scan and check off installed locally",
    "start": "1630500",
    "end": "1636320"
  },
  {
    "text": "you can add in your your Docker file",
    "start": "1636320",
    "end": "1642980"
  },
  {
    "text": "features for TF sac and teroscan and so in my repo that I'm using for all the samples and all the demos I'm using a",
    "start": "1642980",
    "end": "1649820"
  },
  {
    "text": "Dev container and I've added like all the tools I want to have available when",
    "start": "1649820",
    "end": "1655159"
  },
  {
    "text": "I'm playing around so I've got AC terrify I've got tfsac I've got trivi",
    "start": "1655159",
    "end": "1660380"
  },
  {
    "text": "I've got check off and Terror skin all added you know and I'm doing the terrible thing of using a Jammy bass",
    "start": "1660380",
    "end": "1667580"
  },
  {
    "text": "image because I'm I'm playing around locally it's not like I'm running it in production or on kubernetes but I don't",
    "start": "1667580",
    "end": "1675440"
  },
  {
    "text": "have to worry about collisions with my local Os or WSL and my Windows command",
    "start": "1675440",
    "end": "1681740"
  },
  {
    "text": "line and whatever like I know if I fire this up I have all the tools I need um",
    "start": "1681740",
    "end": "1688720"
  },
  {
    "text": "all right and I think I just closed my browser",
    "start": "1689360",
    "end": "1695539"
  },
  {
    "text": "window there we go all right so pipeline Integrations so there are most of these",
    "start": "1695539",
    "end": "1703220"
  },
  {
    "text": "are official actions some of them have some limitations and I want to talk about those and I've added some",
    "start": "1703220",
    "end": "1708320"
  },
  {
    "text": "additional ones so tfsecure actually provides two extensions one is the tfsec action right",
    "start": "1708320",
    "end": "1717380"
  },
  {
    "text": "there where you can just pretty much you clone your repo and you run tfsack and it'll run it against its predefined",
    "start": "1717380",
    "end": "1723679"
  },
  {
    "text": "tools and if it fails like like you don't have a lot of",
    "start": "1723679",
    "end": "1729460"
  },
  {
    "text": "official options but you can do all the command line stuff with additional arcs like you you can have it",
    "start": "1729460",
    "end": "1736580"
  },
  {
    "text": "soft fail so it just adds to the pr you can um what I've had to do is I change the",
    "start": "1736580",
    "end": "1742220"
  },
  {
    "text": "format to junit I actually changed the format to junit for all of the tools so that I",
    "start": "1742220",
    "end": "1748400"
  },
  {
    "text": "can use a test results uploader to have them comment on the pr so it shows up",
    "start": "1748400",
    "end": "1753559"
  },
  {
    "text": "really easy and clear I wasn't seeing the results in the pr without that but yeah it's it's pretty much just add",
    "start": "1753559",
    "end": "1761779"
  },
  {
    "text": "that Json file and I'm going to dive through mine and then like this was not",
    "start": "1761779",
    "end": "1766820"
  },
  {
    "text": "working so there's multiple issues there's a lot of open issues out on this one this is supposed to take the output",
    "start": "1766820",
    "end": "1772820"
  },
  {
    "text": "of TF stack and add it to your PR it wasn't working for me and like I said there's a number of open issues where",
    "start": "1772820",
    "end": "1779179"
  },
  {
    "text": "other people are having that problem Tara scan and Chekhov are very similar",
    "start": "1779179",
    "end": "1784460"
  },
  {
    "text": "as far as you can",
    "start": "1784460",
    "end": "1789220"
  },
  {
    "text": "just run it on your job check out the code run Terror scan the problem with",
    "start": "1791480",
    "end": "1796880"
  },
  {
    "text": "this one is I couldn't control the output very easily like I was having issues trying to get it to add to the pr like",
    "start": "1796880",
    "end": "1804200"
  },
  {
    "text": "it wasn't outputting the the file right but it still is is working and then",
    "start": "1804200",
    "end": "1810679"
  },
  {
    "text": "check off you got a ton of options if you have GitHub Advanced security and",
    "start": "1810679",
    "end": "1815960"
  },
  {
    "text": "you have code ql you can outport via a serif and you can add that into your",
    "start": "1815960",
    "end": "1822320"
  },
  {
    "text": "um code ql and security tab so let's take a look at that",
    "start": "1822320",
    "end": "1830559"
  },
  {
    "text": "so all this is out here on my security reform for Azure Tab and I've got all of",
    "start": "1830659",
    "end": "1835820"
  },
  {
    "text": "these workflows in here so I've tweaked them a little bit so starting with tfsec",
    "start": "1835820",
    "end": "1843820"
  },
  {
    "text": "I have it running on every pull request and when it gets merged into Main",
    "start": "1844720",
    "end": "1850340"
  },
  {
    "text": "so that's how I've got it running uh check off was complaining I was giving it too",
    "start": "1850340",
    "end": "1856340"
  },
  {
    "text": "many permissions so I did limit my permissions of my workflows so it helped",
    "start": "1856340",
    "end": "1861380"
  },
  {
    "text": "me while I was writing this but you can see I'm",
    "start": "1861380",
    "end": "1867080"
  },
  {
    "text": "I'm outputting in junit format with all of my results and then I'm using this publish unit test result action",
    "start": "1867080",
    "end": "1875419"
  },
  {
    "text": "to upload that into my PR and what that looks like on a PR let me",
    "start": "1875419",
    "end": "1881179"
  },
  {
    "text": "go get one of my close ones",
    "start": "1881179",
    "end": "1884500"
  },
  {
    "text": "I've got it commenting right in my PR all of the results of my tests",
    "start": "1888320",
    "end": "1894980"
  },
  {
    "text": "and I can actually see how it's changed over time you know it's showing me what I what I",
    "start": "1894980",
    "end": "1901460"
  },
  {
    "text": "tweaked but",
    "start": "1901460",
    "end": "1904419"
  },
  {
    "text": "nope none of this needs this needs GitHub Advanced security this is all base GitHub these are just normal public",
    "start": "1907399",
    "end": "1915679"
  },
  {
    "text": "private repos um yeah so I've got",
    "start": "1915679",
    "end": "1921919"
  },
  {
    "text": "all those checks running on that and you can see the results of the checks under the the checks API here you can dive",
    "start": "1921919",
    "end": "1929000"
  },
  {
    "text": "into like tfsec",
    "start": "1929000",
    "end": "1933278"
  },
  {
    "text": "if we come down into this like it does output the what it's trying to do and",
    "start": "1935480",
    "end": "1943940"
  },
  {
    "text": "you can get the specific version that was running and all of those outputs",
    "start": "1943940",
    "end": "1950200"
  },
  {
    "text": "and then check off we'll also output all of that the one that I said was a",
    "start": "1950480",
    "end": "1956600"
  },
  {
    "text": "problem is teraskan every time I was trying to get Terra scan to Output effectively it would not add to the pr I",
    "start": "1956600",
    "end": "1963740"
  },
  {
    "text": "couldn't I'm going to submit a PR to the terror scan action because it doesn't expose the output options that are",
    "start": "1963740",
    "end": "1970039"
  },
  {
    "text": "available on command line so it it spits it out here",
    "start": "1970039",
    "end": "1975620"
  },
  {
    "text": "and isn't um yeah see it's spitting out here",
    "start": "1975620",
    "end": "1981140"
  },
  {
    "text": "and it's not letting me add it to the pr but I'm getting the same information",
    "start": "1981140",
    "end": "1986960"
  },
  {
    "text": "it's just it's not failing when it should be failing when I like that's a failure specifically because it it",
    "start": "1986960",
    "end": "1993740"
  },
  {
    "text": "should be alerting I don't have a resource lock on my Resource Group that I was leveraging",
    "start": "1993740",
    "end": "2001200"
  },
  {
    "text": "but yeah it'll do serif I just I'm not using serif",
    "start": "2001779",
    "end": "2007620"
  },
  {
    "text": "now all of these uh the way and I don't know how familiar everyone is with GitHub actions the way GitHub actions",
    "start": "2010419",
    "end": "2016299"
  },
  {
    "text": "work you if you have a yaml file in the GitHub",
    "start": "2016299",
    "end": "2023740"
  },
  {
    "text": "workflow folder it's a valid workflow it'll run these on",
    "start": "2023740",
    "end": "2029260"
  },
  {
    "text": "any event that happens so if the event is on push it'll run this if the event is on",
    "start": "2029260",
    "end": "2036399"
  },
  {
    "text": "um on push or on pull requests it'll run these every time you just create the",
    "start": "2036399",
    "end": "2041980"
  },
  {
    "text": "file it'll run them so when I try to run this stuff it'll run all four pipelines",
    "start": "2041980",
    "end": "2047500"
  },
  {
    "text": "at the same time it'll it'll run all of them so I can have all of them as an indicator of whether I want to continue",
    "start": "2047500",
    "end": "2053679"
  },
  {
    "text": "with the pr or stop the pr ask questions about it so let's let's try to merge",
    "start": "2053679",
    "end": "2061599"
  },
  {
    "text": "this one in I think I accidentally went forward one",
    "start": "2061599",
    "end": "2067260"
  },
  {
    "text": "so let's create a pull request",
    "start": "2067839",
    "end": "2071760"
  },
  {
    "text": "so I want to bring in all of that uh stuff that I've got and we've already",
    "start": "2078760",
    "end": "2085480"
  },
  {
    "text": "got some checks kicking off so it's a terror scan and Chekhov and TF",
    "start": "2085480",
    "end": "2091540"
  },
  {
    "text": "set so these are starting to run",
    "start": "2091540",
    "end": "2097799"
  },
  {
    "text": "yep and check off failed let's see why",
    "start": "2102339",
    "end": "2108599"
  },
  {
    "text": "oh it's a looks like a pathing issue or",
    "start": "2108640",
    "end": "2113640"
  },
  {
    "text": "yeah I limited the checks this was an older uh workflow file so I had limited",
    "start": "2113859",
    "end": "2119980"
  },
  {
    "text": "my permissions a little bit too much but we should start seeing some of the errors in the actual TF SEC logs yep",
    "start": "2119980",
    "end": "2130000"
  },
  {
    "text": "yeah it had some failures there so",
    "start": "2130000",
    "end": "2136000"
  },
  {
    "text": "yep there's their comment and we had some failures so I can go into the check",
    "start": "2136000",
    "end": "2142420"
  },
  {
    "text": "and I can see the specific outputs of that I don't have a network ACL",
    "start": "2142420",
    "end": "2148839"
  },
  {
    "text": "and my app service doesn't have the right authentication enabled so now we can start getting some",
    "start": "2148839",
    "end": "2155320"
  },
  {
    "text": "information about our specific infrastructure every time someone tries",
    "start": "2155320",
    "end": "2161079"
  },
  {
    "text": "to submit a PR these are all using open source tools using just regular GitHub actions",
    "start": "2161079",
    "end": "2169420"
  },
  {
    "text": "now any questions on this stuff so far",
    "start": "2169420",
    "end": "2174880"
  },
  {
    "text": "yeah you",
    "start": "2174880",
    "end": "2179500"
  },
  {
    "text": "if you're on Azure devops you can install and run these tools yourself and you could still just like I was you can",
    "start": "2181060",
    "end": "2188740"
  },
  {
    "text": "generate you know I want a minus f for J unit and I want to Output in Excel and you could",
    "start": "2188740",
    "end": "2195460"
  },
  {
    "text": "do it you know like a junit upload there's ways to install all these tools a lot of times there's ways to run them",
    "start": "2195460",
    "end": "2201880"
  },
  {
    "text": "as Docker commands so if you want to run them as a Docker command from inside your pipeline this specific one example",
    "start": "2201880",
    "end": "2209440"
  },
  {
    "text": "is using GitHub but because they're open source tools written in go or python you",
    "start": "2209440",
    "end": "2215320"
  },
  {
    "text": "can pretty much run them wherever you want you you can invoke them on your code base so like I said I have this",
    "start": "2215320",
    "end": "2221859"
  },
  {
    "text": "running locally so if I do check out my SD",
    "start": "2221859",
    "end": "2228700"
  },
  {
    "text": "it's going to run check off against my current stuff so if you can run that in your pipeline",
    "start": "2228700",
    "end": "2234400"
  },
  {
    "text": "you're good you know if I want to do TF sec I can run it locally and I can get",
    "start": "2234400",
    "end": "2241060"
  },
  {
    "text": "information about my stuff and same with Terror scan",
    "start": "2241060",
    "end": "2246299"
  },
  {
    "text": "so this is just I've automated it and put it together with actions but you can",
    "start": "2248140",
    "end": "2253540"
  },
  {
    "text": "do this with other CI CD platforms they do have how to install it on a Mac",
    "start": "2253540",
    "end": "2259119"
  },
  {
    "text": "in on Windows for pretty much each and every tool does that answer your question",
    "start": "2259119",
    "end": "2265180"
  },
  {
    "text": "yeah",
    "start": "2265180",
    "end": "2267599"
  },
  {
    "text": "um I would have to check yeah I would check on each specific tool but from what I've seen they support native AWS",
    "start": "2274420",
    "end": "2280720"
  },
  {
    "text": "cloud formation they support gcp what whatever their thing is and then Azure",
    "start": "2280720",
    "end": "2286420"
  },
  {
    "text": "arm templates and bicep so your mileage may vary if you go",
    "start": "2286420",
    "end": "2293079"
  },
  {
    "text": "outside of those so any other questions",
    "start": "2293079",
    "end": "2299619"
  },
  {
    "text": "okay so the next kind of thing I think that is important",
    "start": "2299619",
    "end": "2305320"
  },
  {
    "text": "when we're talking about infrastructure as code is our back ends so I",
    "start": "2305320",
    "end": "2312220"
  },
  {
    "text": "so I know that when we're writing at terraform locally a lot of times we don't think about it but you know that",
    "start": "2312220",
    "end": "2317619"
  },
  {
    "text": "that local state file it has all of your secrets it has access Keys certificates",
    "start": "2317619",
    "end": "2323980"
  },
  {
    "text": "like it it if you have access to your TF State file it has everything",
    "start": "2323980",
    "end": "2329619"
  },
  {
    "text": "so there were a lot of times a recommendation is to host it in the cloud provider or use something like",
    "start": "2329619",
    "end": "2334960"
  },
  {
    "text": "terraform Enterprise workspaces um now in my examples I'm going to be",
    "start": "2334960",
    "end": "2340900"
  },
  {
    "text": "using Azure RM as the back end and you can see down here and let me just zoom",
    "start": "2340900",
    "end": "2346900"
  },
  {
    "text": "this in a little bit there are a number of available back ends Azure console kubernetes S3 buckets",
    "start": "2346900",
    "end": "2355619"
  },
  {
    "text": "one thing that I've been doing and let me switch back to my",
    "start": "2355619",
    "end": "2361960"
  },
  {
    "text": "main code base",
    "start": "2361960",
    "end": "2365280"
  },
  {
    "text": "and I will show you there are a lot of things that you can",
    "start": "2369579",
    "end": "2375280"
  },
  {
    "text": "override from your uh terraform so there's a lot there's a",
    "start": "2375280",
    "end": "2383200"
  },
  {
    "text": "number of different patterns for doing multiple environments in terraform you can have you know one big folder with",
    "start": "2383200",
    "end": "2389800"
  },
  {
    "text": "multiple tfrs you can have different folders for each environment you can use a common module directory with",
    "start": "2389800",
    "end": "2397839"
  },
  {
    "text": "you know a folder for each environment in this particular case you know I'm just doing some basic terraform I'm not",
    "start": "2397839",
    "end": "2404260"
  },
  {
    "text": "doing a lot but notice um I'm using Azure RM for my back end",
    "start": "2404260",
    "end": "2410200"
  },
  {
    "text": "and I have no configuration checked in like there's nothing that shows where it's going I'm going to overwrite it all",
    "start": "2410200",
    "end": "2415420"
  },
  {
    "text": "in the pipeline and I'm going to Define where that state file gets stored if you're using workspaces I think it uses",
    "start": "2415420",
    "end": "2423040"
  },
  {
    "text": "one common state store for all of your workspaces so you could have non-prod and prod State mixed together if you're",
    "start": "2423040",
    "end": "2430960"
  },
  {
    "text": "not careful the other thing to be aware of is if you go out with the samples so",
    "start": "2430960",
    "end": "2436660"
  },
  {
    "text": "if you start with like that wonderful sample we did on",
    "start": "2436660",
    "end": "2442140"
  },
  {
    "text": "like a storage account or you just come up here to the Azure RM provider",
    "start": "2446560",
    "end": "2452020"
  },
  {
    "text": "this says Hey I want to you know 3-0 like out of the box you might just go",
    "start": "2452020",
    "end": "2457300"
  },
  {
    "text": "okay yeah that looks reasonable yeah let's do that let's just do 3-0 the problem is when you start using the back",
    "start": "2457300",
    "end": "2464440"
  },
  {
    "text": "end provider um I want to not use passwords I don't want",
    "start": "2464440",
    "end": "2471880"
  },
  {
    "text": "to store a service principle I I kind of want to use open ID connect Google or",
    "start": "2471880",
    "end": "2476980"
  },
  {
    "text": "GitHub has this awesome openid connect relationship with Azure and I want to use openid connect from GitHub to Azure",
    "start": "2476980",
    "end": "2484359"
  },
  {
    "text": "and I want to do it with my backend for terraform so I don't want to have a password I don't want to store a service",
    "start": "2484359",
    "end": "2490359"
  },
  {
    "text": "principle I don't want to store Secrets I really just what you need is usually a client ID a tenant ID and a subscription",
    "start": "2490359",
    "end": "2498160"
  },
  {
    "text": "ID those three things well the thing that you might not catch",
    "start": "2498160",
    "end": "2505180"
  },
  {
    "text": "that will annoy you no end if you haven't caught it before is",
    "start": "2505180",
    "end": "2511060"
  },
  {
    "text": "open ID connect is only available at 3.7 and above so if you're",
    "start": "2511060",
    "end": "2518800"
  },
  {
    "text": "using 3-0 like you'll have it configured you'll try to make it work and it'll just blow up in your face every time and",
    "start": "2518800",
    "end": "2524079"
  },
  {
    "text": "you'll pound your head against the wall for a while like you need at least a certain version of the Azure RM provider",
    "start": "2524079",
    "end": "2530320"
  },
  {
    "text": "to support openid connect from GitHub to Azure so if that one",
    "start": "2530320",
    "end": "2537400"
  },
  {
    "text": "twice now I've forgotten that and it has bit me in the butt so I'm talking about",
    "start": "2537400",
    "end": "2543940"
  },
  {
    "text": "open ID connect from GitHub um what does that look like and and like",
    "start": "2543940",
    "end": "2549280"
  },
  {
    "text": "I said there's other uh back-end providers there's even on learn.microsoft.com",
    "start": "2549280",
    "end": "2556119"
  },
  {
    "text": "terraform on Azure documentation and how to store your state file in a storage account",
    "start": "2556119",
    "end": "2561160"
  },
  {
    "text": "so it's well documented how to do it um and we're going to override it all",
    "start": "2561160",
    "end": "2566380"
  },
  {
    "text": "but open ID connect so GitHub has implemented openid connect",
    "start": "2566380",
    "end": "2572619"
  },
  {
    "text": "for pretty much all of it's off to the major clouds they really want you to",
    "start": "2572619",
    "end": "2579160"
  },
  {
    "text": "um leverage this and so they have this trust between",
    "start": "2579160",
    "end": "2585400"
  },
  {
    "text": "um GitHub Azure AWS gcp uh hashicorp vault",
    "start": "2585400",
    "end": "2593560"
  },
  {
    "text": "and essentially because these two organizations trust",
    "start": "2593560",
    "end": "2599680"
  },
  {
    "text": "each other when your action in GitHub runs it'll provide a claim to the cloud",
    "start": "2599680",
    "end": "2604720"
  },
  {
    "text": "say hey I am so and so and you can identify me via I'm coming",
    "start": "2604720",
    "end": "2611500"
  },
  {
    "text": "from this org I'm coming from this repository I'm on this Branch I'm in",
    "start": "2611500",
    "end": "2617079"
  },
  {
    "text": "this environment so you can be very explicit like what piece of code is",
    "start": "2617079",
    "end": "2622300"
  },
  {
    "text": "running and asking for permission or you know asking to identify itself to Azure or to Google or to whatever",
    "start": "2622300",
    "end": "2629500"
  },
  {
    "text": "and it used to be that you would have to go out to the portal and manually kind of",
    "start": "2629500",
    "end": "2636819"
  },
  {
    "text": "do this in Azure ad you would have to create a service principle create a you know an app registration and then add",
    "start": "2636819",
    "end": "2643240"
  },
  {
    "text": "what they call a Federated credential um let me go down here",
    "start": "2643240",
    "end": "2650160"
  },
  {
    "text": "so I would create a registration and then if you look here these are my",
    "start": "2655540",
    "end": "2663220"
  },
  {
    "text": "Federated credentials and the subject identifier",
    "start": "2663220",
    "end": "2669180"
  },
  {
    "text": "so from my repo like my org my repo it's a pull request my org environment prod",
    "start": "2670180",
    "end": "2677140"
  },
  {
    "text": "my or like and you can have multiple um you know identifiers it's an ore not an",
    "start": "2677140",
    "end": "2685420"
  },
  {
    "text": "and this this is a limited example so I have both Dev and prod listed here but",
    "start": "2685420",
    "end": "2691300"
  },
  {
    "text": "you would probably have a separate identity for non-prod and a different identity for prod and then now that I've",
    "start": "2691300",
    "end": "2696880"
  },
  {
    "text": "identified from GitHub to Azure I want to deploy I would assign the relevant",
    "start": "2696880",
    "end": "2701980"
  },
  {
    "text": "permissions to that identity now it's all documented",
    "start": "2701980",
    "end": "2707500"
  },
  {
    "text": "on the GitHub site for all the different clouds so if you use them they provide you information on how to",
    "start": "2707500",
    "end": "2714280"
  },
  {
    "text": "do it you need to have like permissions for your token in the the",
    "start": "2714280",
    "end": "2720040"
  },
  {
    "text": "workflow and then they log in this way and the reason I",
    "start": "2720040",
    "end": "2725619"
  },
  {
    "text": "bring up openid connect as a very part of securing deploying is",
    "start": "2725619",
    "end": "2732280"
  },
  {
    "text": "for years the way Azure login was recommended to work and you can still kind of see it here",
    "start": "2732280",
    "end": "2739359"
  },
  {
    "text": "you know they said they have two different ways service principle with Secrets or oidc",
    "start": "2739359",
    "end": "2746020"
  },
  {
    "text": "and they recommend oidc the old way and this is the way it's always been done Ada Azad SP create",
    "start": "2746020",
    "end": "2755380"
  },
  {
    "text": "like who's done that one yep and then you just take this big block you know ignore the secret who cares",
    "start": "2755380",
    "end": "2762460"
  },
  {
    "text": "just you take that you paste it somewhere you know you probably keep it around",
    "start": "2762460",
    "end": "2768040"
  },
  {
    "text": "whatever you don't have to do that anymore in fact one of the things I want to provide",
    "start": "2768040",
    "end": "2773500"
  },
  {
    "text": "is an example in my repo if I can find my my tab again",
    "start": "2773500",
    "end": "2780000"
  },
  {
    "text": "is um I wrote a with some co-workers we've got a script",
    "start": "2781780",
    "end": "2787540"
  },
  {
    "text": "so I actually have a little bash script that will pull your",
    "start": "2787540",
    "end": "2794079"
  },
  {
    "text": "your org name out of your current git repo it'll pull your repo name out of your current git repo based on your",
    "start": "2794079",
    "end": "2800200"
  },
  {
    "text": "remote URL it'll do an ad registration in azure",
    "start": "2800200",
    "end": "2805960"
  },
  {
    "text": "it'll then pull the object ID and app registration and create",
    "start": "2805960",
    "end": "2811060"
  },
  {
    "text": "the Federated credential for you in azure based on",
    "start": "2811060",
    "end": "2818500"
  },
  {
    "text": "what what do you want you want a pull request do you want an environment",
    "start": "2818500",
    "end": "2823660"
  },
  {
    "text": "do you want your main branch only only your main branch with your prod environment can authenticate to Azure we",
    "start": "2823660",
    "end": "2829720"
  },
  {
    "text": "can do that and then it links it all together extracts out the three pieces it needs",
    "start": "2829720",
    "end": "2836319"
  },
  {
    "text": "and sets them in your GitHub secrets so using the GitHub CLI you can create",
    "start": "2836319",
    "end": "2842880"
  },
  {
    "text": "GitHub secrets from your command line for your repo so you can just take this script drop it",
    "start": "2842880",
    "end": "2849339"
  },
  {
    "text": "in your repo run it and if you've authenticated to Azure and you've authenticated to get the GitHub CLI it",
    "start": "2849339",
    "end": "2856780"
  },
  {
    "text": "will wire up oidc for you which is fun",
    "start": "2856780",
    "end": "2862240"
  },
  {
    "text": "because otherwise it's annoying that's fun and then once we've done that instead of",
    "start": "2862240",
    "end": "2869319"
  },
  {
    "text": "passing this thing with creds and some secrets",
    "start": "2869319",
    "end": "2875200"
  },
  {
    "text": "you can pass the three elements that you need so I've",
    "start": "2875200",
    "end": "2880540"
  },
  {
    "text": "done that and let's take a look at some examples so",
    "start": "2880540",
    "end": "2886180"
  },
  {
    "text": "I wanted to have a back-end store my terraform state",
    "start": "2886180",
    "end": "2891400"
  },
  {
    "text": "in Azure and I wanted to do it securely so in my workflow here what I've got is",
    "start": "2891400",
    "end": "2899200"
  },
  {
    "text": "for Dev I actually have two um",
    "start": "2899200",
    "end": "2904599"
  },
  {
    "text": "two jobs one is and and your mileage may vary on this I'm doing this because I delete all",
    "start": "2904599",
    "end": "2911079"
  },
  {
    "text": "of my Demos in between talks so I need to recreate things every time um I'm pulling out the couple of things",
    "start": "2911079",
    "end": "2917079"
  },
  {
    "text": "I want but then I'm setting some other variables notice I'm setting an environment variable based on",
    "start": "2917079",
    "end": "2924300"
  },
  {
    "text": "a secret storage account name a container name and a resource Group name",
    "start": "2924300",
    "end": "2929740"
  },
  {
    "text": "and the reason I'm doing that is I'm I'm creating the resource Group from scratch I'm",
    "start": "2929740",
    "end": "2935560"
  },
  {
    "text": "creating the storage account from scratch and I'm creating a storage container",
    "start": "2935560",
    "end": "2941260"
  },
  {
    "text": "like TF State like every if I've completely deleted my terraform State this will recreate it every time the",
    "start": "2941260",
    "end": "2947200"
  },
  {
    "text": "storage account terraform State and all that so it creates it how do I wire that into",
    "start": "2947200",
    "end": "2952720"
  },
  {
    "text": "terraform if you remember my terraform config is empty",
    "start": "2952720",
    "end": "2958240"
  },
  {
    "text": "so how do I tell it I want to use oidc connect and I want to use Azure storage",
    "start": "2958240",
    "end": "2963540"
  },
  {
    "text": "to store my state well",
    "start": "2963540",
    "end": "2969960"
  },
  {
    "text": "notice in add so if you do an AZ login before you do a terraforma knit it'll",
    "start": "2970180",
    "end": "2976540"
  },
  {
    "text": "complain it'll say you need to log on as a human don't like don't do that so I",
    "start": "2976540",
    "end": "2982960"
  },
  {
    "text": "that's why it's a separate job I just check out my code set up terraform and I",
    "start": "2982960",
    "end": "2988119"
  },
  {
    "text": "don't log into azure I'm just passing these couple of values here",
    "start": "2988119",
    "end": "2995079"
  },
  {
    "text": "and I got those values shockingly from the docs",
    "start": "2995079",
    "end": "3001740"
  },
  {
    "text": "the the docs are where everything is so Azure RM back in and it's something you",
    "start": "3001740",
    "end": "3007740"
  },
  {
    "text": "really need to pay attention to as you look at different clouds so if we look at different clouds and we come down all",
    "start": "3007740",
    "end": "3014819"
  },
  {
    "text": "the way to the bottom configuration variables now notice there's required ones",
    "start": "3014819",
    "end": "3021119"
  },
  {
    "text": "but then notice this they sometimes said instead of just a",
    "start": "3021119",
    "end": "3026579"
  },
  {
    "text": "command line option you can give it an environment variable so for some things you can specify",
    "start": "3026579",
    "end": "3032579"
  },
  {
    "text": "an environment variable but I can't for the resource Group it won't let me pass that in as environment",
    "start": "3032579",
    "end": "3038520"
  },
  {
    "text": "variable it won't let but it will let me pass in the subscription ID and the Tenant ID",
    "start": "3038520",
    "end": "3045540"
  },
  {
    "text": "so I have to do a combination of I'm going to use oidc I'm going to use these",
    "start": "3045540",
    "end": "3051480"
  },
  {
    "text": "things and then I'm going to override my backend provider and so that's what I've had to do here where these are going to",
    "start": "3051480",
    "end": "3058920"
  },
  {
    "text": "be picked up automatically by terraform and knit because I use the right environment variable that it responds to",
    "start": "3058920",
    "end": "3065280"
  },
  {
    "text": "it it doesn't respond to these though these were not environment variables I could pass to it so I have to pass",
    "start": "3065280",
    "end": "3073920"
  },
  {
    "text": "whoops sorry about that I have to pass Dash back in config the",
    "start": "3073920",
    "end": "3079980"
  },
  {
    "text": "name of the variable it wants and then I can use GitHub to do the interpolation",
    "start": "3079980",
    "end": "3086280"
  },
  {
    "text": "to reference the environment variable so you have to kind of use a combination of the two to get it to dynamically",
    "start": "3086280",
    "end": "3093480"
  },
  {
    "text": "override the back end with oidc and I just got it doing a plan and this",
    "start": "3093480",
    "end": "3101040"
  },
  {
    "text": "is after the merge so the PR's already run tearskins already run TF SEC and check off I've already run and then when",
    "start": "3101040",
    "end": "3107339"
  },
  {
    "text": "I approve it this will then deploy it out and I can do it completely different notice this is exactly the same as prod",
    "start": "3107339",
    "end": "3114180"
  },
  {
    "text": "the only difference is I'm using secrets from",
    "start": "3114180",
    "end": "3120800"
  },
  {
    "text": "a different environment so in GitHub you can have environments",
    "start": "3120900",
    "end": "3127140"
  },
  {
    "text": "each environment can have secrets you can name them the same thing so you",
    "start": "3127140",
    "end": "3132839"
  },
  {
    "text": "just say uses environment and all your stuff works the same and then you can have approvals so if I go look at my",
    "start": "3132839",
    "end": "3141680"
  },
  {
    "text": "um my action run you'll see hey when terraform ran",
    "start": "3142980",
    "end": "3149599"
  },
  {
    "text": "first thing it does is I've got four states down there at the bottom it does my Dev state",
    "start": "3151020",
    "end": "3156839"
  },
  {
    "text": "creates the relevant resources you know and then initializes terraform",
    "start": "3156839",
    "end": "3165859"
  },
  {
    "text": "with the right values and you can see it it starts them so it doesn't output them on the screen github's usually really",
    "start": "3166859",
    "end": "3172140"
  },
  {
    "text": "good about knowing that you had a secret that has some value and it's not going to print it out if you do a lot of",
    "start": "3172140",
    "end": "3177180"
  },
  {
    "text": "manipulation though you can shoot yourself in the foot",
    "start": "3177180",
    "end": "3180859"
  },
  {
    "text": "so any questions on the oidc and and backing override like it if you if",
    "start": "3182220",
    "end": "3188040"
  },
  {
    "text": "you're used to checking in your full backing config like the name of a a",
    "start": "3188040",
    "end": "3193680"
  },
  {
    "text": "state file and the name of a storage account and like you could also not check one in at all",
    "start": "3193680",
    "end": "3199680"
  },
  {
    "text": "and then if you want to play around locally you can add something like an override",
    "start": "3199680",
    "end": "3205440"
  },
  {
    "text": "TF so that instead of trying to do a remote Azure this will locally let me",
    "start": "3205440",
    "end": "3210660"
  },
  {
    "text": "play locally and I can deploy it somewhere else and that'll just keep my state locally while I'm playing and then",
    "start": "3210660",
    "end": "3215760"
  },
  {
    "text": "when I check it in it'll go back to using Azure for everything",
    "start": "3215760",
    "end": "3220760"
  },
  {
    "text": "questions yes",
    "start": "3223500",
    "end": "3226520"
  },
  {
    "text": "it it so the question was sometimes you have a",
    "start": "3236900",
    "end": "3243540"
  },
  {
    "text": "great terraform file you make one small change it starts deleting things and rebuilding them so that is a inherent problem of every",
    "start": "3243540",
    "end": "3251940"
  },
  {
    "text": "provider it usually varies by resource so some resources like in Azure there",
    "start": "3251940",
    "end": "3257520"
  },
  {
    "text": "are some specific resources where you can't change them and so if you have it and you make a change the only way to",
    "start": "3257520",
    "end": "3264059"
  },
  {
    "text": "fix it is to delete it and recreate it just like with arm or bicep sometimes if",
    "start": "3264059",
    "end": "3270540"
  },
  {
    "text": "you create a resource with like an empty array of subnets and then later on you",
    "start": "3270540",
    "end": "3276780"
  },
  {
    "text": "do a child resource that's a subnet and you link it to it every time you deploy that it'll delete the subnets and then",
    "start": "3276780",
    "end": "3282780"
  },
  {
    "text": "recreate them because the parent was empty and so every time it's like well nope there aren't any oh wait oh you",
    "start": "3282780",
    "end": "3287819"
  },
  {
    "text": "wanted me to add one I think that varies AWS and gcp do the same thing depending",
    "start": "3287819",
    "end": "3292859"
  },
  {
    "text": "upon the resource that's why you can do a plan and you can have it pause and have someone like",
    "start": "3292859",
    "end": "3299460"
  },
  {
    "text": "review the plan like you could do a terraform plan and have it output out as a like a PR comment or even just as an",
    "start": "3299460",
    "end": "3307079"
  },
  {
    "text": "output from a step in GitHub so that you could then review it and do the approval",
    "start": "3307079",
    "end": "3313040"
  },
  {
    "text": "like I can do approvals in GitHub like it'll pause and say hey there's a deployment to prod waiting on your",
    "start": "3313040",
    "end": "3319380"
  },
  {
    "text": "approval do you want that yes",
    "start": "3319380",
    "end": "3323359"
  },
  {
    "text": "yeah yeah you can run them on the plan um I did not specifically but like",
    "start": "3326660",
    "end": "3333000"
  },
  {
    "text": "um so TF SEC for instance yeah let me close that",
    "start": "3333000",
    "end": "3338880"
  },
  {
    "text": "let me go back a few slides",
    "start": "3338880",
    "end": "3342680"
  },
  {
    "text": "yep yep yep",
    "start": "3343920",
    "end": "3348960"
  },
  {
    "text": "so some of these you can um TF SEC you can give the working directory and then you can get to the",
    "start": "3348960",
    "end": "3355200"
  },
  {
    "text": "rest of the arguments and so the rest of the arguments like I said",
    "start": "3355200",
    "end": "3360359"
  },
  {
    "text": "um you could do the filtering and and pass it specific tfrs or workspaces uh",
    "start": "3360359",
    "end": "3365819"
  },
  {
    "text": "Terror scan um there's a number of different specific",
    "start": "3365819",
    "end": "3371599"
  },
  {
    "text": "formats and I think Chekov is the one that definitely has",
    "start": "3371599",
    "end": "3377400"
  },
  {
    "text": "um on the plan I just looked right over it there it is",
    "start": "3377400",
    "end": "3383220"
  },
  {
    "text": "yeah see like an optional path to the the TF plan",
    "start": "3383220",
    "end": "3388800"
  },
  {
    "text": "so yeah you you can other questions",
    "start": "3388800",
    "end": "3395520"
  },
  {
    "text": "yes",
    "start": "3395520",
    "end": "3398180"
  },
  {
    "text": "yep there are resource flag our resource locks in Azure um they require slightly different",
    "start": "3403339",
    "end": "3409559"
  },
  {
    "text": "permissions out of the box than contributor because it is a a user authentic like you need a",
    "start": "3409559",
    "end": "3415980"
  },
  {
    "text": "like either owner or user user administrator permissions I think",
    "start": "3415980",
    "end": "3422520"
  },
  {
    "text": "to set the resource lock flag so if you just have a contributor for your identity that you're deploying to Azure",
    "start": "3422520",
    "end": "3428339"
  },
  {
    "text": "a lot of times that'll fail if you don't give it those explicit permissions it",
    "start": "3428339",
    "end": "3433800"
  },
  {
    "text": "needs but you can do resource locks with terraform you can say I want a resource lock this Resource Group that it can't",
    "start": "3433800",
    "end": "3440339"
  },
  {
    "text": "be deleted or it can't be changed that that is something that terraform supports",
    "start": "3440339",
    "end": "3447380"
  },
  {
    "text": "oh it would fail when it when it tried yeah other questions",
    "start": "3448619",
    "end": "3456079"
  },
  {
    "text": "about yeah",
    "start": "3457619",
    "end": "3460940"
  },
  {
    "text": "um the reason I chose those three scanners tfsec um is by awkward or supported by Aqua security I really like",
    "start": "3464099",
    "end": "3470700"
  },
  {
    "text": "trivia and a lot of the work they do so um that was one that popped up a lot uh",
    "start": "3470700",
    "end": "3476460"
  },
  {
    "text": "like I said with TF SEC and uh tereskin they both support like and I didn't have",
    "start": "3476460",
    "end": "3483300"
  },
  {
    "text": "time to dive into it uh and I apologize for that but it supports like",
    "start": "3483300",
    "end": "3489000"
  },
  {
    "text": "Rego policies so you can define those as custom policies like I'd accidentally deleted it off of a branch but you can",
    "start": "3489000",
    "end": "3496079"
  },
  {
    "text": "have regular policies against your um your infrastructure which is awesome",
    "start": "3496079",
    "end": "3502200"
  },
  {
    "text": "Terra scan is another one that that's huge they have integrated that into like",
    "start": "3502200",
    "end": "3508740"
  },
  {
    "text": "nessus they also support regular policies and then check off is one I've",
    "start": "3508740",
    "end": "3515400"
  },
  {
    "text": "that I've been aware of for a while both on the container space and on infrastructure so those were that was the reason I picked those three there",
    "start": "3515400",
    "end": "3522599"
  },
  {
    "text": "are more but leveraging it with GitHub where you can run multiple simultaneously you can have it through a",
    "start": "3522599",
    "end": "3528299"
  },
  {
    "text": "pre-commit hook or in your IDE it just adds layers of automation to help you catch",
    "start": "3528299",
    "end": "3535619"
  },
  {
    "text": "hey I'm gonna go make a storage account that's perfectly safe right maybe not so",
    "start": "3535619",
    "end": "3544680"
  },
  {
    "text": "any other questions yeah",
    "start": "3544680",
    "end": "3550819"
  },
  {
    "text": "I have not used Atlantis yet uh I I definitely came across it I didn't have",
    "start": "3551299",
    "end": "3556559"
  },
  {
    "text": "time to fully integrate it into this but um",
    "start": "3556559",
    "end": "3560900"
  },
  {
    "text": "powerful yeah",
    "start": "3572880",
    "end": "3576440"
  },
  {
    "text": "awesome yeah I definitely need to look into Atlantis more",
    "start": "3584640",
    "end": "3589579"
  },
  {
    "text": "anything else before we're done for today well",
    "start": "3590700",
    "end": "3596339"
  },
  {
    "text": "um I think we are at time then thank you everyone for coming today it's my first time here at NDC in my first time in",
    "start": "3596339",
    "end": "3602099"
  },
  {
    "text": "Norway and it's been amazing and some awesome conversations and I hope to",
    "start": "3602099",
    "end": "3607319"
  },
  {
    "text": "continue it so Reach Out thank you",
    "start": "3607319",
    "end": "3612500"
  }
]