[
  {
    "start": "0",
    "end": "166000"
  },
  {
    "text": "okay I've been given the signal to start so so what I'm going to talk to you",
    "start": "9270",
    "end": "17890"
  },
  {
    "text": "today is about different ways of controlling what users can access both",
    "start": "17890",
    "end": "25990"
  },
  {
    "text": "inside of a web application asp.net core and also in the database but this really",
    "start": "25990",
    "end": "34930"
  },
  {
    "text": "came from a some work I did for a client",
    "start": "34930",
    "end": "40360"
  },
  {
    "text": "they they came to me because they had lots of databases and lots of",
    "start": "40360",
    "end": "46690"
  },
  {
    "text": "performance and lots of things they wanted to do and I've written this book and a framework core in action",
    "start": "46690",
    "end": "54190"
  },
  {
    "text": "and so we had a really nice discussion about that and I felt very happy with",
    "start": "54190",
    "end": "60070"
  },
  {
    "text": "those bits and then they said we have",
    "start": "60070",
    "end": "67090"
  },
  {
    "text": "this quite complex set of rules on what our users do and she's where we went",
    "start": "67090",
    "end": "75220"
  },
  {
    "text": "down a hole right so so I said we were",
    "start": "75220",
    "end": "80229"
  },
  {
    "text": "talking through what they need you to do and this is really important to them so I said well and what if what have you",
    "start": "80229",
    "end": "87460"
  },
  {
    "text": "done so far and I said oh we had two developers working on it for about a month and a half two months but we fired",
    "start": "87460",
    "end": "94000"
  },
  {
    "text": "them because I couldn't do it so so that was a start and then okay so",
    "start": "94000",
    "end": "104460"
  },
  {
    "text": "did they do anything I could look at no there's no code you got to start again and okay so what who's what other",
    "start": "104790",
    "end": "115180"
  },
  {
    "text": "developers he got ok well um it's you and a guy in the company that learn",
    "start": "115180",
    "end": "121799"
  },
  {
    "text": "angularjs in his spare time is gonna do the front-end they did have a good",
    "start": "121799",
    "end": "127479"
  },
  {
    "text": "project manager and they were gonna hire people but it was a you know on the",
    "start": "127479",
    "end": "133030"
  },
  {
    "text": "first talking about databases that was very happy but now I'm not so confident so this is a story about how I solved",
    "start": "133030",
    "end": "141459"
  },
  {
    "text": "this and some of the good things that came out of it and what I said to them that I",
    "start": "141459",
    "end": "147829"
  },
  {
    "text": "can help you on on the database I'll give me three or four weeks and I'll look into this problem and see whether I",
    "start": "147829",
    "end": "155780"
  },
  {
    "text": "feel I can solve it or not so we're gonna talk about that and some of the",
    "start": "155780",
    "end": "160849"
  },
  {
    "text": "things that you might find useful out of it but first we're gonna do a super",
    "start": "160849",
    "end": "166189"
  },
  {
    "start": "166000",
    "end": "166000"
  },
  {
    "text": "quick look at asp.net core identity because this is you'll get the",
    "start": "166189",
    "end": "173090"
  },
  {
    "text": "terminologies right and you know make sure everybody's on the same page so",
    "start": "173090",
    "end": "179389"
  },
  {
    "text": "this identity feature has two parts authentication which is logging in",
    "start": "179389",
    "end": "186409"
  },
  {
    "text": "I've lost my password all those sort of things and then authorization which is",
    "start": "186409",
    "end": "193220"
  },
  {
    "text": "once you're logged in what can you do okay and those two parts are gonna turn",
    "start": "193220",
    "end": "201079"
  },
  {
    "text": "up a lot the other thing is it in in authentication with asp.net core you can",
    "start": "201079",
    "end": "209239"
  },
  {
    "text": "use their own system which is really good and but you can use lots of other",
    "start": "209239",
    "end": "214519"
  },
  {
    "text": "things social logins and you have api's to allow external authentication people",
    "start": "214519",
    "end": "222409"
  },
  {
    "text": "take over that part when it comes to authorization what people can do there",
    "start": "222409",
    "end": "229579"
  },
  {
    "text": "are two ways you can do it in asp.net core one is the role-based so each user",
    "start": "229579",
    "end": "237919"
  },
  {
    "text": "is given a set of roles and this authorize that you can see they're authorized roles staff manager will you",
    "start": "237919",
    "end": "245989"
  },
  {
    "text": "put that on a on a action inside the",
    "start": "245989",
    "end": "251750"
  },
  {
    "text": "website and you the user will only be able to access it if they've got the",
    "start": "251750",
    "end": "258620"
  },
  {
    "text": "role startled or manager and new in asp.net core is policy based where you",
    "start": "258620",
    "end": "267349"
  },
  {
    "text": "could write your own own rules and they had an example around",
    "start": "267349",
    "end": "272500"
  },
  {
    "text": "checking with their a each and things like that I didn't quite get that at the beginning but it turns out policy based",
    "start": "272500",
    "end": "280570"
  },
  {
    "text": "rules authorization is very helpful so",
    "start": "280570",
    "end": "285970"
  },
  {
    "text": "so that's the super quick intro I want to talk about the limitations of role",
    "start": "286000",
    "end": "294020"
  },
  {
    "start": "291000",
    "end": "291000"
  },
  {
    "text": "based systems role based systems have been around for a while it was in",
    "start": "294020",
    "end": "300020"
  },
  {
    "text": "asp.net MVC and I used it and I'm sure you've used it and here are my issues",
    "start": "300020",
    "end": "310750"
  },
  {
    "text": "the with a big application you end up with quite complicated role lists and",
    "start": "310750",
    "end": "318860"
  },
  {
    "text": "they spread all over all over the place and they're really hard to manage all",
    "start": "318860",
    "end": "325280"
  },
  {
    "text": "right there is another thing which okay if you",
    "start": "325280",
    "end": "332690"
  },
  {
    "text": "want to change a role take that exam example at the top say I wanted to have",
    "start": "332690",
    "end": "339680"
  },
  {
    "text": "a role director added to that thing so I'd have to edit the code go comma",
    "start": "339680",
    "end": "344870"
  },
  {
    "text": "director in the roles so you've got to redeploy your system to get that out in",
    "start": "344870",
    "end": "353260"
  },
  {
    "text": "in the wild and that's okay now because we're used to deploying a lot but",
    "start": "353260",
    "end": "360490"
  },
  {
    "text": "philosophically it feels wrong it feels like a use an admin person should be sitting at a table and and changing the",
    "start": "360490",
    "end": "368720"
  },
  {
    "text": "way your system works and this is a personal one but I hate strings because",
    "start": "368720",
    "end": "376130"
  },
  {
    "text": "I'm Dyslexic because so business manager could turn to bismillah and I wouldn't",
    "start": "376130",
    "end": "381950"
  },
  {
    "text": "notice it so this is the personal thing but so I really love intellisense",
    "start": "381950",
    "end": "388280"
  },
  {
    "text": "anything that's going to kind of sort it out for me you may wonder how I wrote a",
    "start": "388280",
    "end": "394310"
  },
  {
    "text": "500 page book with dyslexia but you've got good spell checkers and in tennis",
    "start": "394310",
    "end": "401550"
  },
  {
    "text": "no he didn't over to code okay so let's",
    "start": "401550",
    "end": "408210"
  },
  {
    "text": "go back to the to the client and I'll list you some of the things that they",
    "start": "408210",
    "end": "413940"
  },
  {
    "text": "needed that the current out the box system wouldn't do the first one was",
    "start": "413940",
    "end": "421860"
  },
  {
    "text": "this is retail and people work in lots of different places they don't love you",
    "start": "421860",
    "end": "428010"
  },
  {
    "text": "know they're working one shop as a manager for the week and then their work in the weekend as just a sales assistant",
    "start": "428010",
    "end": "435000"
  },
  {
    "text": "and they'll move around and this and this company had been running for many",
    "start": "435000",
    "end": "441840"
  },
  {
    "text": "years and people use they email to log in so you could have someone who would",
    "start": "441840",
    "end": "449000"
  },
  {
    "text": "use their email but they may work in multiple places that real look really",
    "start": "449000",
    "end": "455850"
  },
  {
    "text": "won't work with asp.net core because everything is joint you know glued",
    "start": "455850",
    "end": "461910"
  },
  {
    "text": "together once you log in with an email you get this so I had to break that",
    "start": "461910",
    "end": "467400"
  },
  {
    "text": "apart the other thing you're talking to you customer and you get these",
    "start": "467400",
    "end": "473820"
  },
  {
    "text": "interesting things that they say obvious um major customer runs their system very",
    "start": "473820",
    "end": "480090"
  },
  {
    "text": "differently to other people and what a manager does for in in there is a very",
    "start": "480090",
    "end": "486990"
  },
  {
    "text": "stiffen set of capabilities to what the other people do and after adjust to that",
    "start": "486990",
    "end": "492270"
  },
  {
    "text": "so that tells me that the role manager changes depending on what the company is",
    "start": "492270",
    "end": "501650"
  },
  {
    "text": "this is a multi-tenant system so they've got you know company a and all its",
    "start": "501650",
    "end": "507620"
  },
  {
    "text": "retail outlets and Company B and there will be it could be different and you",
    "start": "507620",
    "end": "512940"
  },
  {
    "text": "can't do that with asp.net core out of the box and the other thing like most",
    "start": "512940",
    "end": "520340"
  },
  {
    "text": "services like this you can buy the base system and then you have add-ons that",
    "start": "520340",
    "end": "527280"
  },
  {
    "text": "you pay for so they want to filter that out and I wanted to make that part of the authorized",
    "start": "527280",
    "end": "534730"
  },
  {
    "text": "I'm not gonna I'm gonna spend a little bit at a time at the end looking at the",
    "start": "534730",
    "end": "540470"
  },
  {
    "text": "database not very long because I think it's on the bit that people find useful",
    "start": "540470",
    "end": "545690"
  },
  {
    "text": "is this authorization in the web app but this was heavily multi-tenant if you",
    "start": "545690",
    "end": "552380"
  },
  {
    "text": "don't know the term it's just exactly what I said you've got one database and you've got multiple separate tenants or",
    "start": "552380",
    "end": "561110"
  },
  {
    "text": "in this case I'm calling them companies and you have to keep the data completely",
    "start": "561110",
    "end": "566390"
  },
  {
    "text": "separate you know security nightmare there you need to make that very",
    "start": "566390",
    "end": "572720"
  },
  {
    "text": "different and this system had divisions",
    "start": "572720",
    "end": "579860"
  },
  {
    "text": "upon division so that you know you had a company that carries was across the whole of the US that a West Coast",
    "start": "579860",
    "end": "587120"
  },
  {
    "text": "division and central in a East Division and the West Cota got a la it cetera and",
    "start": "587120",
    "end": "593720"
  },
  {
    "text": "we'll see that at the end how do we do that so where do you start well I'm a",
    "start": "593720",
    "end": "601390"
  },
  {
    "text": "independent contractor I don't work with other people but you need techie friends",
    "start": "601390",
    "end": "606920"
  },
  {
    "text": "all right so I talked to Jerry pedlar",
    "start": "606920",
    "end": "612940"
  },
  {
    "text": "who's become a friend sheriff out on his weekly newsletter that is a very good",
    "start": "612940",
    "end": "619870"
  },
  {
    "text": "newsletter and he put me on to Dominick Bayer and policy server and that was",
    "start": "619870",
    "end": "629150"
  },
  {
    "text": "useful and I looked at that and I was",
    "start": "629150",
    "end": "634610"
  },
  {
    "text": "under I'm on a time constraint so I sent the email off to than saying you know cuz they sold it so you know oh what",
    "start": "634610",
    "end": "642680"
  },
  {
    "text": "could you do and I got out of office saying oh I'm traveling so had to get on",
    "start": "642680",
    "end": "648800"
  },
  {
    "text": "couldn't wait for that and I'm glad I did because when they came back it wasn't totally clear that it would do",
    "start": "648800",
    "end": "657050"
  },
  {
    "text": "what we needed and for a multi-tenant version it's $25,000 and I can tell you",
    "start": "657050",
    "end": "662950"
  },
  {
    "text": "what we built was a lot less than that but it was very helpful it was very",
    "start": "662950",
    "end": "669270"
  },
  {
    "text": "helpful and the thing that they did was",
    "start": "669270",
    "end": "674880"
  },
  {
    "text": "they split authentication from authorization and once you once you've heard that and once you've thought about",
    "start": "674880",
    "end": "681420"
  },
  {
    "text": "that it's obvious but it wasn't obvious until I read their stuff so thank you to",
    "start": "681420",
    "end": "686670"
  },
  {
    "text": "them and the idea is you get someone logs in and you get a user ID right and",
    "start": "686670",
    "end": "694830"
  },
  {
    "text": "then you use that with other information to decide what the user can do so that",
    "start": "694830",
    "end": "704790"
  },
  {
    "text": "that was really useful I also philosophical idea but roles I",
    "start": "704790",
    "end": "714210"
  },
  {
    "text": "think work well for humans but for the",
    "start": "714210",
    "end": "719570"
  },
  {
    "text": "so you know you sell system manager you can imagine that you have these roles",
    "start": "719570",
    "end": "725040"
  },
  {
    "text": "and they kind of fit people but when it comes to the web application you're",
    "start": "725040",
    "end": "730860"
  },
  {
    "text": "really using use cases so can process sale there's most likely you know four",
    "start": "730860",
    "end": "737730"
  },
  {
    "text": "or five Web API is that you hit to do that so that's that's a use case and I",
    "start": "737730",
    "end": "744210"
  },
  {
    "text": "called those permissions and I split those those apart it turns out that",
    "start": "744210",
    "end": "751230"
  },
  {
    "text": "policy based authentication is really helpful if you want to do something",
    "start": "751230",
    "end": "756780"
  },
  {
    "text": "different this is the way you do it because you can set your own rules and",
    "start": "756780",
    "end": "763130"
  },
  {
    "text": "finally I I used enums for my permissions because if I get",
    "start": "763130",
    "end": "769440"
  },
  {
    "text": "intellisense but it turned out that and that's why I chose it but it turned out",
    "start": "769440",
    "end": "775170"
  },
  {
    "text": "to be a really good decision and I'll you'll see why so when I finished with",
    "start": "775170",
    "end": "784980"
  },
  {
    "text": "the client and I felt there was some really I'd found some really useful",
    "start": "784980",
    "end": "791610"
  },
  {
    "text": "things so I wrote some other way with it my class permission and and it helped",
    "start": "791610",
    "end": "797010"
  },
  {
    "text": "them because I wrote in the second art cause some of the things they need you to do later and it you can go to it now",
    "start": "797010",
    "end": "807149"
  },
  {
    "text": "if you want but it's it shot up my my on",
    "start": "807149",
    "end": "814889"
  },
  {
    "text": "my tech blog and it's now number one taking about 5,000 pages a month and",
    "start": "814889",
    "end": "822079"
  },
  {
    "text": "there was lots and lots of comments and more worryingly people would i'd had a",
    "start": "822079",
    "end": "831239"
  },
  {
    "text": "built a simple application that people could run again so that I knew that code",
    "start": "831239",
    "end": "839669"
  },
  {
    "text": "was right that I was putting in the article but people were now trying to take this slightly crappy application",
    "start": "839669",
    "end": "846989"
  },
  {
    "text": "and use it in their situation so I'm",
    "start": "846989",
    "end": "852029"
  },
  {
    "text": "currently in the process of building a much better version and updating things",
    "start": "852029",
    "end": "859410"
  },
  {
    "text": "and you're seeing some of this in this talk so let me take you through what",
    "start": "859410",
    "end": "867480"
  },
  {
    "start": "864000",
    "end": "864000"
  },
  {
    "text": "happens this gives you an overview of what I'm gonna do and then I'll show you",
    "start": "867480",
    "end": "873569"
  },
  {
    "text": "the bits inside so someone logs in I don't care how but I want a user ID and",
    "start": "873569",
    "end": "881009"
  },
  {
    "text": "then I have something which it's a very simple you know user to user to role so",
    "start": "881009",
    "end": "890009"
  },
  {
    "text": "it's just a very simple look up and it says oh this user ID has these roles and",
    "start": "890009",
    "end": "895259"
  },
  {
    "text": "it I've said it's sales and first day just to make it interesting and then I",
    "start": "895259",
    "end": "901470"
  },
  {
    "text": "turn those into permissions so we",
    "start": "901470",
    "end": "906959"
  },
  {
    "text": "started with roles but we don't need those when we're going to the actual application we're going to use these",
    "start": "906959",
    "end": "913679"
  },
  {
    "text": "permissions and you can see here has got I've got three sales has got three",
    "start": "913679",
    "end": "918859"
  },
  {
    "text": "permissions and the first aid has call ambulance and then what I need to do is",
    "start": "918859",
    "end": "925289"
  },
  {
    "text": "I need to get those permissions into what's called the users claims so when",
    "start": "925289",
    "end": "932220"
  },
  {
    "text": "someone is logged into asp.net core there they",
    "start": "932220",
    "end": "937270"
  },
  {
    "text": "have some claims which go around and they're stored in a cookie or a token",
    "start": "937270",
    "end": "942430"
  },
  {
    "text": "and but they are what will determine what who that user is when they come to",
    "start": "942430",
    "end": "949780"
  },
  {
    "text": "the side so I need to get these permissions and you'll notice that the",
    "start": "949780",
    "end": "956950"
  },
  {
    "text": "permissions are shown as numbers rather the names because it makes them smaller and that's useful because if you use",
    "start": "956950",
    "end": "963910"
  },
  {
    "text": "cookies is the limit so that was very useful so that's so this authentications",
    "start": "963910",
    "end": "971620"
  },
  {
    "text": "setup stage now is something that I've written I've used asp.net core at the",
    "start": "971620",
    "end": "979600"
  },
  {
    "text": "login stage but I've written that and then per HTT HTTP request these claims",
    "start": "979600",
    "end": "991120"
  },
  {
    "text": "get put into the system and I can use the policy based approach to check that",
    "start": "991120",
    "end": "999160"
  },
  {
    "text": "they've got the permission so in this case Joe wants to go to an in action",
    "start": "999160",
    "end": "1006450"
  },
  {
    "text": "result bottom right no yep right and yes",
    "start": "1006450",
    "end": "1014880"
  },
  {
    "text": "he has the permission read stock so he can access it okay so that's that's the",
    "start": "1014880",
    "end": "1020160"
  },
  {
    "text": "overview let's go and see some parts in it so oh yes no before I go on once you",
    "start": "1020160",
    "end": "1030540"
  },
  {
    "text": "split this you start to see something you see that the scary bit is the",
    "start": "1030540",
    "end": "1037040"
  },
  {
    "text": "authentication part it's the bit that I think we all worry about is like have I",
    "start": "1037040",
    "end": "1043020"
  },
  {
    "text": "hashed the passwords right have I you know should I have the is this cookie",
    "start": "1043020",
    "end": "1049710"
  },
  {
    "text": "it's secured enough so that's a scary part and if you separate that off and",
    "start": "1049710",
    "end": "1055680"
  },
  {
    "text": "you realize that the rest is not scary right all of this you can unit test all",
    "start": "1055680",
    "end": "1062340"
  },
  {
    "text": "the rest of the stuff and I have unit tests that goes and looks all the actions in all the controllers",
    "start": "1062340",
    "end": "1068919"
  },
  {
    "text": "and make sure it's got the right it's either got to have an actuary called",
    "start": "1068919",
    "end": "1074470"
  },
  {
    "text": "allowing anonymous or you've just have",
    "start": "1074470",
    "end": "1079540"
  },
  {
    "text": "the authorized one which means you just logged in or it has to have has",
    "start": "1079540",
    "end": "1086830"
  },
  {
    "text": "permission which is my attribute and so",
    "start": "1086830",
    "end": "1092140"
  },
  {
    "text": "you can check everything and and if I feel very comfortable with that it's just the front end and in discussions",
    "start": "1092140",
    "end": "1098740"
  },
  {
    "text": "with my client I'd done something with asp.net cause own system but in the end",
    "start": "1098740",
    "end": "1105790"
  },
  {
    "text": "they just felt a little bit worried and so we we use an external authentication",
    "start": "1105790",
    "end": "1114460"
  },
  {
    "text": "system called or zero and that meant that someone else was worrying about all",
    "start": "1114460",
    "end": "1122470"
  },
  {
    "text": "that scary stuff all right it made it a little bit harder to set up users because you have to use a web api",
    "start": "1122470",
    "end": "1129340"
  },
  {
    "text": "that talks to or Siro and all that sort of stuff but it was it was you've taken",
    "start": "1129340",
    "end": "1135669"
  },
  {
    "text": "that away and my client could say oh you know if the passwords have been hacked",
    "start": "1135669",
    "end": "1142360"
  },
  {
    "text": "or something it's not me right so that's good okay so um let's go and",
    "start": "1142360",
    "end": "1150160"
  },
  {
    "text": "look at the permissions as I said I used a thumbs and it turns out to be a really",
    "start": "1150160",
    "end": "1158770"
  },
  {
    "text": "good idea because you can put attributes on enums and you're gonna have hundreds",
    "start": "1158770",
    "end": "1166179"
  },
  {
    "text": "of ease all right so I can put on the display attribute and I can give it in a",
    "start": "1166179",
    "end": "1172780"
  },
  {
    "text": "group name a name a description all sorts of stuff so that's some poor admin",
    "start": "1172780",
    "end": "1179679"
  },
  {
    "text": "person that's got set up all these rules can look at it and you'll see that in a minute and the you you can decide how",
    "start": "1179679",
    "end": "1189600"
  },
  {
    "text": "finer detail you want I've in this the",
    "start": "1189600",
    "end": "1195159"
  },
  {
    "text": "product read I've got a separate one for the read the create the update and the",
    "start": "1195159",
    "end": "1200409"
  },
  {
    "text": "so you can go very fine if you want but for the rolls I've got one that says you",
    "start": "1200409",
    "end": "1205809"
  },
  {
    "text": "can see the rolls and another one that says you can change the rolls you can",
    "start": "1205809",
    "end": "1211210"
  },
  {
    "text": "add them update them or delete them so it's up to you how fine and details you",
    "start": "1211210",
    "end": "1216580"
  },
  {
    "text": "want to go see the obsolete at the bottom that's nice too because you do",
    "start": "1216580",
    "end": "1222820"
  },
  {
    "text": "not want to reuse numbers if you've now not using that permission you don't want",
    "start": "1222820",
    "end": "1229659"
  },
  {
    "text": "to use it there's lots of scary stories about reusing numbers and having chaos",
    "start": "1229659",
    "end": "1235510"
  },
  {
    "text": "so you market with an obsolete that means that in the code you'll get",
    "start": "1235510",
    "end": "1240940"
  },
  {
    "text": "warning if you're using it and also in my listing anything it's got obsolete it",
    "start": "1240940",
    "end": "1247029"
  },
  {
    "text": "won't show it okay so that that was really good and in my little demo",
    "start": "1247029",
    "end": "1253230"
  },
  {
    "text": "application you see you can list it all and you've got the descriptions you could imagine you can filter it down to",
    "start": "1253230",
    "end": "1260519"
  },
  {
    "text": "the the user admin and pick out the things it makes it much easier for the user so that's the permissions now we've",
    "start": "1260519",
    "end": "1269529"
  },
  {
    "text": "got how do we get them into the claims oh yeah quick look at a class done with",
    "start": "1269529",
    "end": "1282279"
  },
  {
    "start": "1274000",
    "end": "1274000"
  },
  {
    "text": "NC framework or and this is just showing",
    "start": "1282279",
    "end": "1287679"
  },
  {
    "text": "you that I can the permissions look at the bottom line permissions in rolls I",
    "start": "1287679",
    "end": "1295659"
  },
  {
    "text": "can pack those up and store them as a string in the database and then I can",
    "start": "1295659",
    "end": "1302080"
  },
  {
    "text": "unpack them when someone reads them and so that makes it it's not so important",
    "start": "1302080",
    "end": "1310659"
  },
  {
    "text": "in the database but it is for the cookie but it also it means that from the anybody using this class you're only",
    "start": "1310659",
    "end": "1318850"
  },
  {
    "text": "using enums but inside some magics going on and I use third line down at the top",
    "start": "1318850",
    "end": "1326110"
  },
  {
    "text": "I in EF core you can have private fields",
    "start": "1326110",
    "end": "1331779"
  },
  {
    "text": "are map to the database and that's what I do there and the pack and unpack pack just",
    "start": "1331779",
    "end": "1339270"
  },
  {
    "text": "takes the number which is a 16-bit and makes it into a Unicode char so it's",
    "start": "1339270",
    "end": "1345780"
  },
  {
    "text": "very efficient so let's now look at how",
    "start": "1345780",
    "end": "1351740"
  },
  {
    "text": "we get these permissions into the claims so if you log in just standard login you",
    "start": "1351740",
    "end": "1362160"
  },
  {
    "text": "will get a claim called name which is normally your email you'll get a user ID",
    "start": "1362160",
    "end": "1370950"
  },
  {
    "text": "which by default is a string containing a grid and you get another security",
    "start": "1370950",
    "end": "1378000"
  },
  {
    "text": "thing that asp.net call uses itself I want to add the permission so how do I",
    "start": "1378000",
    "end": "1384870"
  },
  {
    "text": "do that well I found this this really nice thing called user claims principle",
    "start": "1384870",
    "end": "1392850"
  },
  {
    "text": "Factory and what you can do is every time that someone logs in you can",
    "start": "1392850",
    "end": "1398490"
  },
  {
    "text": "capture by putting this in it will instead of just putting the claims in it",
    "start": "1398490",
    "end": "1403920"
  },
  {
    "text": "will come to you and then you can add your own claim so here is the code thank",
    "start": "1403920",
    "end": "1410940"
  },
  {
    "text": "you to Corazon see the link at the bottom that's where I found it thank you",
    "start": "1410940",
    "end": "1417360"
  },
  {
    "text": "very much and you can see the generate",
    "start": "1417360",
    "end": "1422820"
  },
  {
    "text": "claims async which I override you get the the claims that it would normally",
    "start": "1422820",
    "end": "1428580"
  },
  {
    "text": "have from the base then I have this method called calc allowed permissions which does that and then adds it as a",
    "start": "1428580",
    "end": "1436410"
  },
  {
    "text": "claim okay so that's that's a really simple way to add anything to the claims",
    "start": "1436410",
    "end": "1443700"
  },
  {
    "text": "that you need going forward right and that will happen once when you log in",
    "start": "1443700",
    "end": "1449450"
  },
  {
    "text": "I'm now going to show you a much more complicated system I had to use this for",
    "start": "1449450",
    "end": "1457470"
  },
  {
    "text": "various reasons for my client but when I first put the article out people say ah",
    "start": "1457470",
    "end": "1465210"
  },
  {
    "text": "but what happens if the if the permissions and that all the roles for a",
    "start": "1465210",
    "end": "1471669"
  },
  {
    "text": "user I changed and they're already login it won't it won't change until the person logs out and back in again so yep",
    "start": "1471669",
    "end": "1481539"
  },
  {
    "text": "that's that's valid we we had discussed that with the client and we were happy it didn't really matter for them but in",
    "start": "1481539",
    "end": "1488860"
  },
  {
    "text": "the new version I've solved this so there is an event that happens every",
    "start": "1488860",
    "end": "1497010"
  },
  {
    "text": "HTTP request and for if you are using cookies it's called on validate",
    "start": "1497010",
    "end": "1503289"
  },
  {
    "text": "principle and you can get into this and do things and you'll see that and so",
    "start": "1503289",
    "end": "1509679"
  },
  {
    "text": "what I do is I put something in there that can recalculate things",
    "start": "1509679",
    "end": "1515620"
  },
  {
    "text": "this is runs in every HTTP request that you don't want to spend looking at the",
    "start": "1515620",
    "end": "1523179"
  },
  {
    "text": "database every time do you you really don't so you have to be a bit more clever and",
    "start": "1523179",
    "end": "1528280"
  },
  {
    "text": "here is it's a bit complicated but I'll",
    "start": "1528280",
    "end": "1533530"
  },
  {
    "text": "explain so what I want to do is if I can I want to get out straight away so I use",
    "start": "1533530",
    "end": "1541659"
  },
  {
    "text": "tix I had the store the time when the",
    "start": "1541659",
    "end": "1546760"
  },
  {
    "text": "users permissions were calculated and that I compare that with it something",
    "start": "1546760",
    "end": "1553059"
  },
  {
    "text": "that is cached so that's so so when that something is updated the cache changes",
    "start": "1553059",
    "end": "1560799"
  },
  {
    "text": "and I've got this lovely I like long names given tix is higher than cache",
    "start": "1560799",
    "end": "1567100"
  },
  {
    "text": "ticks right and if that if that's true that's fine there's not no problem and",
    "start": "1567100",
    "end": "1573400"
  },
  {
    "text": "it will return quickly but if it isn't I",
    "start": "1573400",
    "end": "1579419"
  },
  {
    "text": "haven't put that seethen line now calculate the permission claim value and",
    "start": "1579419",
    "end": "1584470"
  },
  {
    "text": "last updated tix I haven't put the code in there just for two it's similar to",
    "start": "1584470",
    "end": "1590799"
  },
  {
    "text": "that what you saw in the last version the simple version but once",
    "start": "1590799",
    "end": "1596509"
  },
  {
    "text": "you've done that this bit at the bottom is really nice of what you can do is you",
    "start": "1596509",
    "end": "1602029"
  },
  {
    "text": "can create a new claims principle and you can see that the lot line third line",
    "start": "1602029",
    "end": "1607460"
  },
  {
    "text": "from the bottom replaced principal so what I've done is I've recalculated",
    "start": "1607460",
    "end": "1613100"
  },
  {
    "text": "everything and updated all the",
    "start": "1613100",
    "end": "1618169"
  },
  {
    "text": "permissions in the claim and the last line should renew equals true is very",
    "start": "1618169",
    "end": "1626210"
  },
  {
    "text": "important because that will tell the cookie to update so that it it won't do",
    "start": "1626210",
    "end": "1633110"
  },
  {
    "text": "it next time so it's gonna be if you change something it's going to take time but after that it's gonna be quick",
    "start": "1633110",
    "end": "1640009"
  },
  {
    "text": "that's what you want oh yes if you used um I I looked at Oh was open web",
    "start": "1640009",
    "end": "1652129"
  },
  {
    "text": "application security to look at but what you know sure I use a cookie or should I",
    "start": "1652129",
    "end": "1658970"
  },
  {
    "text": "use a token and all that sort of stuff and it's very deep in there but I",
    "start": "1658970",
    "end": "1665899"
  },
  {
    "text": "thought you get you get a thing which tells you all the problems you have with tokens and all the problems with goodies",
    "start": "1665899",
    "end": "1673669"
  },
  {
    "text": "and then you have to go through it and work out what when it turned what you can do and I decided that it said that a",
    "start": "1673669",
    "end": "1681860"
  },
  {
    "text": "token on its own was not enough you had to have something else and the cookies",
    "start": "1681860",
    "end": "1687529"
  },
  {
    "text": "had some problems but asp.net pretty much knows all those and has things to",
    "start": "1687529",
    "end": "1694159"
  },
  {
    "text": "deal with them right this is my opinion but we went with with cookies for that",
    "start": "1694159",
    "end": "1701480"
  },
  {
    "text": "reason but if you want to look at tokens look at blinking caret at the bottom",
    "start": "1701480",
    "end": "1707980"
  },
  {
    "text": "it's a really good site detailed stuff and he's got lots on web api's with",
    "start": "1707980",
    "end": "1713960"
  },
  {
    "text": "tokens so if that's your bag then have a look at that so um I'm going to show you",
    "start": "1713960",
    "end": "1721519"
  },
  {
    "text": "a complicated piece of code but don't worry about it so what I've done",
    "start": "1721519",
    "end": "1729270"
  },
  {
    "text": "in the I have a what's called a dbcontext which is handling all of my",
    "start": "1729270",
    "end": "1735960"
  },
  {
    "text": "authorization stuff and I I override to",
    "start": "1735960",
    "end": "1741900"
  },
  {
    "text": "save changes save changes with the bull and save changes",
    "start": "1741900",
    "end": "1746970"
  },
  {
    "text": "a sync with a ball and I put this code in there and it's complicated but what",
    "start": "1746970",
    "end": "1752220"
  },
  {
    "text": "is looking for as has anybody changed things which will affect the user's",
    "start": "1752220",
    "end": "1761370"
  },
  {
    "text": "permissions and if it if it has it sets that to true does the save and then",
    "start": "1761370",
    "end": "1768870"
  },
  {
    "text": "update this cache so that the next time that it comes around that cache will be",
    "start": "1768870",
    "end": "1776280"
  },
  {
    "text": "higher than what the ticks in the tote in the cookie and it will have to",
    "start": "1776280",
    "end": "1782700"
  },
  {
    "text": "recreate so that that works the only",
    "start": "1782700",
    "end": "1787860"
  },
  {
    "text": "thing I would say is caching across multiple web applications is not trivial",
    "start": "1787860",
    "end": "1797210"
  },
  {
    "text": "getting that right and secure well not secure but reliable is",
    "start": "1797210",
    "end": "1804180"
  },
  {
    "text": "difficult so you got to decide right do you want if you want this thing which",
    "start": "1804180",
    "end": "1810810"
  },
  {
    "text": "will update as soon as you change something fine implement that but if you",
    "start": "1810810",
    "end": "1816510"
  },
  {
    "text": "can get away with the simple one do that because it's going to be much easier to maintain okay",
    "start": "1816510",
    "end": "1825120"
  },
  {
    "text": "we're nearly there on putting this all together so I've got to the pay the",
    "start": "1825120",
    "end": "1833430"
  },
  {
    "text": "point where I've got the policy stuff and what what I've got is I've got Joe",
    "start": "1833430",
    "end": "1841530"
  },
  {
    "text": "he's got his permissions claim and I have some I have some I add a policy",
    "start": "1841530",
    "end": "1851370"
  },
  {
    "text": "which will check that and you see I have this attribute that this attribute",
    "start": "1851370",
    "end": "1857700"
  },
  {
    "text": "called has permission bottom middle and so it's going to check",
    "start": "1857700",
    "end": "1866109"
  },
  {
    "text": "that Joe has got that here the the policy based permissions that policy",
    "start": "1866109",
    "end": "1872859"
  },
  {
    "text": "based authorization is a bit complex and I'm just showing you like the core bit",
    "start": "1872859",
    "end": "1880470"
  },
  {
    "text": "it's got all bits around it that a bit fiddly but you can see here it comes in",
    "start": "1880470",
    "end": "1888159"
  },
  {
    "text": "with the context so I can get the claims if it has if the user hasn't got these",
    "start": "1888159",
    "end": "1894729"
  },
  {
    "text": "pack permissions then there's no way it's going to pass but then it comes",
    "start": "1894729",
    "end": "1901149"
  },
  {
    "text": "down to this and I've highlighted this method of mine called this permission is",
    "start": "1901149",
    "end": "1907269"
  },
  {
    "text": "allowed it's an extension which takes the permissions unpacks",
    "start": "1907269",
    "end": "1912460"
  },
  {
    "text": "amp assam and checks in those permissions that it's got their permission a name that is being applied",
    "start": "1912460",
    "end": "1922029"
  },
  {
    "text": "and that and that does it if you want to look at policy based rules and doing",
    "start": "1922029",
    "end": "1930809"
  },
  {
    "text": "dynamic authorization then Gerry peso has got a very good set of articles on",
    "start": "1930809",
    "end": "1939849"
  },
  {
    "text": "that it's I mean my code is full of thanks to or see other people are we're",
    "start": "1939849",
    "end": "1948489"
  },
  {
    "text": "all building on each other which is great in it so I write articles and I",
    "start": "1948489",
    "end": "1954249"
  },
  {
    "text": "I've read articles and that's how we're going to get forward so we've come to",
    "start": "1954249",
    "end": "1962019"
  },
  {
    "text": "the end of that part and there's the",
    "start": "1962019",
    "end": "1967809"
  },
  {
    "text": "same diagram again and you can see I've been through all of those steps and",
    "start": "1967809",
    "end": "1975820"
  },
  {
    "text": "you've seen the code about the only thing you haven't seen is the is the find user roles which is very simple",
    "start": "1975820",
    "end": "1982389"
  },
  {
    "text": "it's a user ID role name user ID rope name okay so let's have",
    "start": "1982389",
    "end": "1990470"
  },
  {
    "text": "have a look at database I have written the book so you've got to have a look at",
    "start": "1990470",
    "end": "1995750"
  },
  {
    "start": "1992000",
    "end": "1992000"
  },
  {
    "text": "the database and this is if you don't do",
    "start": "1995750",
    "end": "2001059"
  },
  {
    "text": "any filtering then you unless your code manually does it you're going to get",
    "start": "2001059",
    "end": "2007900"
  },
  {
    "text": "everything so that's the thing on the left all or nothing protection so you're",
    "start": "2007900",
    "end": "2013030"
  },
  {
    "text": "just going to get all that data and it's up to you and what you do with it but if we put a purl row protection in we can",
    "start": "2013030",
    "end": "2020669"
  },
  {
    "text": "we can lock that down and make that better and EF core is great for this is",
    "start": "2020669",
    "end": "2028740"
  },
  {
    "text": "just great lovely the example I have is the and",
    "start": "2028740",
    "end": "2036760"
  },
  {
    "start": "2034000",
    "end": "2034000"
  },
  {
    "text": "this comes from my second article is I'm gonna give you a blow-by-blow of",
    "start": "2036760",
    "end": "2042929"
  },
  {
    "text": "personal data using the user ID as a key right and I'm gonna show you how I do",
    "start": "2042929",
    "end": "2050138"
  },
  {
    "text": "that and once you've seen that you'll there's",
    "start": "2050139",
    "end": "2055540"
  },
  {
    "text": "loads of other things you can do but this is gives you the the base stuff so in this case I've got some user",
    "start": "2055540",
    "end": "2063638"
  },
  {
    "text": "addresses and you can only address get to the address or addresses that have",
    "start": "2063639",
    "end": "2068830"
  },
  {
    "text": "got your key in it so how do you do this that you feel very sure that it's gonna",
    "start": "2068830",
    "end": "2077800"
  },
  {
    "text": "work right you could put it in your code forget you could could forget so let's",
    "start": "2077800",
    "end": "2084220"
  },
  {
    "text": "see how we do it so I'm down in the I've",
    "start": "2084220",
    "end": "2091300"
  },
  {
    "start": "2085000",
    "end": "2085000"
  },
  {
    "text": "got a DB car I've got insights in F core",
    "start": "2091300",
    "end": "2097030"
  },
  {
    "text": "you have a context which a class which",
    "start": "2097030",
    "end": "2102490"
  },
  {
    "text": "is which inherits DB context and it holds all the information about the",
    "start": "2102490",
    "end": "2108250"
  },
  {
    "text": "links to your database and all the configuration about your database right and that's that's what we've got here",
    "start": "2108250",
    "end": "2116560"
  },
  {
    "text": "and I've strips and things off so that I can get it on this Paige so the first thing you need to do",
    "start": "2116560",
    "end": "2123170"
  },
  {
    "text": "you need to get the user ID in which is very easy because you you are going to",
    "start": "2123170",
    "end": "2128810"
  },
  {
    "text": "use dependency injection and I've got this thing I get claims provider and",
    "start": "2128810",
    "end": "2134119"
  },
  {
    "text": "we'll see that later so all you need to know is that I've got this user ID inside the dbcontext the other thing I",
    "start": "2134119",
    "end": "2142880"
  },
  {
    "text": "do is I override Save Changes you've seen this before I've shown just one of",
    "start": "2142880",
    "end": "2149839"
  },
  {
    "text": "them but what I'm doing is every time you add something which has got the I",
    "start": "2149839",
    "end": "2157849"
  },
  {
    "text": "owned by interface which is this is the thing that's gonna do it it's going to",
    "start": "2157849",
    "end": "2164119"
  },
  {
    "text": "put the user ID in that is going to call that method called set owned by which is",
    "start": "2164119",
    "end": "2170660"
  },
  {
    "text": "in that interface and it's going to put that user ID in that field and there's",
    "start": "2170660",
    "end": "2176150"
  },
  {
    "text": "no way around that right it's gonna happen so therefore",
    "start": "2176150",
    "end": "2181310"
  },
  {
    "text": "that is going to be marked automatically",
    "start": "2181310",
    "end": "2186849"
  },
  {
    "text": "right and if you use Save Changes or if",
    "start": "2186849",
    "end": "2191930"
  },
  {
    "text": "you use AF call that's going to happen and then the magic bit is that came in",
    "start": "2191930",
    "end": "2200300"
  },
  {
    "text": "with EF core is this query filter you can put query filters on your classes",
    "start": "2200300",
    "end": "2209359"
  },
  {
    "text": "and it will filter out automatically",
    "start": "2209359",
    "end": "2215500"
  },
  {
    "text": "deeps are in inside the DB context before it comes to you so if you do any",
    "start": "2215500",
    "end": "2221990"
  },
  {
    "text": "query if you do any fine and I found that even if you use is it to secret and",
    "start": "2221990",
    "end": "2227569"
  },
  {
    "text": "a from sequel if you use that it adds a bit of sequel on the end doesn't always",
    "start": "2227569",
    "end": "2232700"
  },
  {
    "text": "work but it it's going to lock it down so you you can get round it by putting",
    "start": "2232700",
    "end": "2238730"
  },
  {
    "text": "in the method ignore query filter right but it's pretty obvious what you've done",
    "start": "2238730",
    "end": "2244790"
  },
  {
    "text": "right so by default it will filter that so I like this because it's",
    "start": "2244790",
    "end": "2252869"
  },
  {
    "text": "it's it's gonna happen it can't be easily bypassed and again I have some",
    "start": "2252869",
    "end": "2260700"
  },
  {
    "text": "unit tests just to make sure that I've put query filters on the the appropriate",
    "start": "2260700",
    "end": "2265799"
  },
  {
    "text": "classes and that yeah the only other",
    "start": "2265799",
    "end": "2272009"
  },
  {
    "text": "thing you need is a way to get the user ID in and there is a this is my I could",
    "start": "2272009",
    "end": "2279269"
  },
  {
    "text": "get claims provider and there's a useful thing called ihdt kong context accessor",
    "start": "2279269",
    "end": "2287880"
  },
  {
    "text": "and you can get the claims it might be now so yeah so you have to handle that",
    "start": "2287880",
    "end": "2294480"
  },
  {
    "text": "but it will get the claims and pull that out on every HTTP request that you where",
    "start": "2294480",
    "end": "2301559"
  },
  {
    "text": "you call that and then that and that's it that's that's a really secure way to",
    "start": "2301559",
    "end": "2310940"
  },
  {
    "text": "keep your data segregated I'm gonna show",
    "start": "2310940",
    "end": "2317369"
  },
  {
    "text": "you what I had to do for the client for this multi-tenant thing it's you won't",
    "start": "2317369",
    "end": "2324239"
  },
  {
    "text": "need this but it will show you some of the things that you might find useful oh",
    "start": "2324239",
    "end": "2332420"
  },
  {
    "text": "no it shows you what you could do and I don't think you will need to do it but",
    "start": "2332420",
    "end": "2339180"
  },
  {
    "text": "it there's so many things get o get opened up so I've got I've got two",
    "start": "2339180",
    "end": "2345839"
  },
  {
    "text": "tenants made up for you Inc which has got a dress for you and a shirt for you",
    "start": "2345839",
    "end": "2352289"
  },
  {
    "text": "and a tie for you and I have Joe is the",
    "start": "2352289",
    "end": "2359039"
  },
  {
    "text": "LA district manager right so he wants to just see the the data around there and",
    "start": "2359039",
    "end": "2367920"
  },
  {
    "text": "also I want to keep these these two for ring and this pets too limited in the UK",
    "start": "2367920",
    "end": "2374910"
  },
  {
    "text": "I want to keep them separate so what I did is I built a a data key using that",
    "start": "2374910",
    "end": "2382950"
  },
  {
    "text": "follows the hierarchy and I use the primary key to build it so when you come down here",
    "start": "2382950",
    "end": "2388580"
  },
  {
    "text": "the the the company up here is has got one then it goes to the west coast we",
    "start": "2388580",
    "end": "2393620"
  },
  {
    "text": "want to then it goes down to LA which is one to five etc so by giving the Joe",
    "start": "2393620",
    "end": "2403580"
  },
  {
    "text": "there the code one to five he cans and",
    "start": "2403580",
    "end": "2408950"
  },
  {
    "text": "then I had this Square query string where it so starts with you can just see",
    "start": "2408950",
    "end": "2416270"
  },
  {
    "text": "that little bit of the data and so that",
    "start": "2416270",
    "end": "2422750"
  },
  {
    "text": "that again is is more than you most likely need but it's a useful example of",
    "start": "2422750",
    "end": "2431330"
  },
  {
    "text": "what you can do so yeah that's just",
    "start": "2431330",
    "end": "2436490"
  },
  {
    "text": "looking at the same sort of things count the in this case you have to link the",
    "start": "2436490",
    "end": "2446830"
  },
  {
    "text": "user to you have to link the user to",
    "start": "2446830",
    "end": "2453080"
  },
  {
    "text": "this as L a subgroup entity because someone might come along and change the",
    "start": "2453080",
    "end": "2460460"
  },
  {
    "text": "the layout and change the hierarchy so he needs to be able to link to that and",
    "start": "2460460",
    "end": "2467180"
  },
  {
    "text": "get the latest and this is a case where if you're going to change the hierarchy it's gonna be you you're going to have",
    "start": "2467180",
    "end": "2474620"
  },
  {
    "text": "to look at the same thing that I showed",
    "start": "2474620",
    "end": "2479960"
  },
  {
    "text": "you where it will update the the data key so let's we nearly really there this",
    "start": "2479960",
    "end": "2493130"
  },
  {
    "text": "is a look at what I did for the client with extra orange boxes that added",
    "start": "2493130",
    "end": "2499490"
  },
  {
    "text": "things that I haven't put in the the thing that I've made open source and",
    "start": "2499490",
    "end": "2505430"
  },
  {
    "text": "written the articles about because I don't think people need this but you can",
    "start": "2505430",
    "end": "2510500"
  },
  {
    "text": "see here that the login is more complicated because Joe could work in two different places and",
    "start": "2510500",
    "end": "2517750"
  },
  {
    "text": "yes if that's true yes it click which one and you'll have a different ID",
    "start": "2517750",
    "end": "2524160"
  },
  {
    "text": "passed on so I use a local user ID then and the other thing is when you're",
    "start": "2524160",
    "end": "2532120"
  },
  {
    "text": "finding a role it might be there'll be a",
    "start": "2532120",
    "end": "2538030"
  },
  {
    "text": "role manager with a tenant idea at zero",
    "start": "2538030",
    "end": "2543400"
  },
  {
    "text": "means every can every body can use that for default but if it finds a manager",
    "start": "2543400",
    "end": "2550810"
  },
  {
    "text": "with the with the ID of the company like",
    "start": "2550810",
    "end": "2558910"
  },
  {
    "text": "this one two three four so you down there the roles there then it would override that and so you could have a role which",
    "start": "2558910",
    "end": "2566920"
  },
  {
    "text": "is different for these for the people for each company if you need it",
    "start": "2566920",
    "end": "2574060"
  },
  {
    "text": "and again the removing the paid for",
    "start": "2574060",
    "end": "2579370"
  },
  {
    "text": "permissions is very simple all it does is it it knows which permissions are in",
    "start": "2579370",
    "end": "2585370"
  },
  {
    "text": "a module and if you haven't got that module it'll strip it out so in this case it strips out sell online because",
    "start": "2585370",
    "end": "2593770"
  },
  {
    "text": "they haven't bought that feature so yeah",
    "start": "2593770",
    "end": "2601720"
  },
  {
    "text": "that's so last thing is just to look at",
    "start": "2601720",
    "end": "2608230"
  },
  {
    "text": "the application that I actually built for the client and what we ended up with",
    "start": "2608230",
    "end": "2615460"
  },
  {
    "text": "we ended up with two asp.net web apps",
    "start": "2615460",
    "end": "2623500"
  },
  {
    "text": "running with Weber api's one was doing",
    "start": "2623500",
    "end": "2632140"
  },
  {
    "text": "handle or all the admin and mainly the login and then it passed it passed most",
    "start": "2632140",
    "end": "2641710"
  },
  {
    "text": "of the information went into the cookies about where the person was and what they could do there was if you had added a",
    "start": "2641710",
    "end": "2649060"
  },
  {
    "text": "new company some stuff that went needed to go on there and you can see there's a link",
    "start": "2649060",
    "end": "2654200"
  },
  {
    "text": "from the brown master into the blue web",
    "start": "2654200",
    "end": "2659780"
  },
  {
    "text": "application that was a another web application which did all the grunt work but it did all the stock control selling",
    "start": "2659780",
    "end": "2667100"
  },
  {
    "text": "etc etc and there they had we had a",
    "start": "2667100",
    "end": "2674240"
  },
  {
    "text": "multi-tenant database for that and with",
    "start": "2674240",
    "end": "2680420"
  },
  {
    "text": "an angular on the top and yeah so it was",
    "start": "2680420",
    "end": "2686150"
  },
  {
    "text": "it works they've got the ability to extend it if they want in different ways",
    "start": "2686150",
    "end": "2694570"
  },
  {
    "text": "and Julian would be happy with this it's all this is all using domain driven",
    "start": "2694570",
    "end": "2701330"
  },
  {
    "text": "design all the entities are and the I'm using what's called packaged by feature",
    "start": "2701330",
    "end": "2707030"
  },
  {
    "text": "or what Jimmy Bogart calls vertical slicing so I've tried to make the each",
    "start": "2707030",
    "end": "2715150"
  },
  {
    "text": "part of the system say what's on their authentication and authorization that is",
    "start": "2715150",
    "end": "2722920"
  },
  {
    "text": "very is it is in one kind of set so that",
    "start": "2722920",
    "end": "2730040"
  },
  {
    "text": "if you wanted to move it somewhere it's much easier to move it around and use",
    "start": "2730040",
    "end": "2737450"
  },
  {
    "text": "the got user madam management so that isn't so important in the in the master",
    "start": "2737450",
    "end": "2744050"
  },
  {
    "text": "here but when it comes on to the web application they're going to add more",
    "start": "2744050",
    "end": "2749150"
  },
  {
    "text": "things and they may want to run another web a web app to take the load and so",
    "start": "2749150",
    "end": "2759500"
  },
  {
    "text": "they can move things around and that is the end of what I'm going to talk about",
    "start": "2759500",
    "end": "2767930"
  },
  {
    "start": "2767000",
    "end": "2767000"
  },
  {
    "text": "which gives you some time for talking asking some questions and just to say",
    "start": "2767930",
    "end": "2774470"
  },
  {
    "text": "that I'm in the middle of redoing the the application and",
    "start": "2774470",
    "end": "2781020"
  },
  {
    "text": "[Music] and write some new articles and you they",
    "start": "2781020",
    "end": "2786760"
  },
  {
    "text": "should be out in the next three or four weeks depending on what other what other things come up and I hope that will be",
    "start": "2786760",
    "end": "2794350"
  },
  {
    "text": "useful to you so have you got any questions sir yeah",
    "start": "2794350",
    "end": "2807030"
  },
  {
    "text": "so the question was I said I use we use all to 0 and we use so that is a company",
    "start": "2813290",
    "end": "2822060"
  },
  {
    "text": "that will provide the the authentication",
    "start": "2822060",
    "end": "2827460"
  },
  {
    "text": "for you and what we did is we just call it that had was there there then that",
    "start": "2827460",
    "end": "2835530"
  },
  {
    "text": "email and a user ID and that's all we used we didn't use any of the other",
    "start": "2835530",
    "end": "2844130"
  },
  {
    "text": "parts in it or Co works like asp.net",
    "start": "2844130",
    "end": "2849660"
  },
  {
    "text": "core in that if you use add things you if they fix when you log in and that's",
    "start": "2849660",
    "end": "2856380"
  },
  {
    "text": "what we didn't we wanted to get round doing that so we just used the user ID",
    "start": "2856380",
    "end": "2861530"
  },
  {
    "text": "any other questions",
    "start": "2861530",
    "end": "2865310"
  },
  {
    "text": "if I remember correctly I believe the query filter does not work for",
    "start": "2869480",
    "end": "2874670"
  },
  {
    "text": "navigation properties so it's not an issue you risk going like backwards in",
    "start": "2874670",
    "end": "2881070"
  },
  {
    "text": "in navigation properties and actually reach properties that you should not",
    "start": "2881070",
    "end": "2886110"
  },
  {
    "text": "have access to that way yes so and this comes down to a DDD thing called routing",
    "start": "2886110",
    "end": "2893310"
  },
  {
    "text": "at aggregate so you always put your you",
    "start": "2893310",
    "end": "2898530"
  },
  {
    "text": "put the query filter on the top of your root class and you have to design it so",
    "start": "2898530",
    "end": "2905700"
  },
  {
    "text": "that if there are things hanging off it that you only access them by that right",
    "start": "2905700",
    "end": "2912180"
  },
  {
    "text": "you can of course if if you do includes",
    "start": "2912180",
    "end": "2918990"
  },
  {
    "text": "that's fine but if you then want to look at it you'd have to put a query filter",
    "start": "2918990",
    "end": "2924570"
  },
  {
    "text": "on if you wanted to directly access those so yes you are relying on this",
    "start": "2924570",
    "end": "2930890"
  },
  {
    "text": "using a domain driven dip driven design",
    "start": "2930890",
    "end": "2935970"
  },
  {
    "text": "to to make that work and that's a that's a good point actually",
    "start": "2935970",
    "end": "2942590"
  },
  {
    "text": "yes so what you're saying is if you're at the top of the hierarchy and you and",
    "start": "2956060",
    "end": "2962130"
  },
  {
    "text": "where you went include including blue include you could I'm talking about",
    "start": "2962130",
    "end": "2967890"
  },
  {
    "text": "going upwards from like you have a user and it has a navigation properties to the company that it belongs to then you",
    "start": "2967890",
    "end": "2974160"
  },
  {
    "text": "go up in the hierarchy and then you have a navigation property going to a list of users so you could actually that user",
    "start": "2974160",
    "end": "2980010"
  },
  {
    "text": "could you could risk going upwards in the hiker and then get access to all users you could yet you could what I do",
    "start": "2980010",
    "end": "2993119"
  },
  {
    "text": "is I have the users the control of the",
    "start": "2993119",
    "end": "2998400"
  },
  {
    "text": "users in a separate dbcontext so I've got it's kind of like well I'm it's not",
    "start": "2998400",
    "end": "3005630"
  },
  {
    "text": "a ban Lee context but it's I've got a DP context that deals with users and I got",
    "start": "3005630",
    "end": "3011089"
  },
  {
    "text": "a DB context which deals with companies and so there and there is a there is a",
    "start": "3011089",
    "end": "3020619"
  },
  {
    "text": "it gets complicated but you've got a link in here but you can't go any further and in the company you can't get",
    "start": "3020619",
    "end": "3027020"
  },
  {
    "text": "to the users okay so yeah you're right you the you've got to think that there's",
    "start": "3027020",
    "end": "3034010"
  },
  {
    "text": "no two little things like I really like using a grid for a user ID because you",
    "start": "3034010",
    "end": "3039920"
  },
  {
    "text": "might have to pass that to the front end and it's a bit more if you had in the",
    "start": "3039920",
    "end": "3051349"
  },
  {
    "text": "user with a primary key one is likely to be a very powerful user and you'd go",
    "start": "3051349",
    "end": "3057530"
  },
  {
    "text": "after it so by using grids anonymize is it a bit more so",
    "start": "3057530",
    "end": "3067089"
  },
  {
    "text": "you have a angular front-end yeah and usually you want to only show what",
    "start": "3070010",
    "end": "3076920"
  },
  {
    "text": "actually the actual user is allowed to yes this is also the cookie yeah so good",
    "start": "3076920",
    "end": "3083430"
  },
  {
    "text": "question and I will be doing that in the the",
    "start": "3083430",
    "end": "3090119"
  },
  {
    "text": "article I'm writing in my I didn't put it in here sorry so what happens is when you log in you can it you can get you",
    "start": "3090119",
    "end": "3100680"
  },
  {
    "text": "can get the good you can ask for the permissions and you get them as strings because for the angular it's better I",
    "start": "3100680",
    "end": "3107789"
  },
  {
    "text": "think and that's what they did in the system and if you want we didn't do it",
    "start": "3107789",
    "end": "3113190"
  },
  {
    "text": "for the client but if you want to do if you want to catch that you would have a",
    "start": "3113190",
    "end": "3120059"
  },
  {
    "text": "change if there was this where you updated the permissions you'd have to in",
    "start": "3120059",
    "end": "3126420"
  },
  {
    "text": "the angular you'd have to be get the tick and see that it's changed or get",
    "start": "3126420",
    "end": "3133170"
  },
  {
    "text": "something that's saying that you should ask for it again but it's all doable and I'll have that in the article but you're",
    "start": "3133170",
    "end": "3141210"
  },
  {
    "text": "quite right you do need them and we we passed them on login to the angular and",
    "start": "3141210",
    "end": "3148680"
  },
  {
    "text": "then it safe that",
    "start": "3148680",
    "end": "3151880"
  },
  {
    "text": "yes so basically we should not trust the client right so if the client says okay",
    "start": "3155580",
    "end": "3161770"
  },
  {
    "text": "we need somehow to validate because you are storing the permissions inside the cookie yeah we need to make sure that",
    "start": "3161770",
    "end": "3167920"
  },
  {
    "text": "they didn't get outed yes so asp.net is",
    "start": "3167920",
    "end": "3174640"
  },
  {
    "text": "good at doing that so you most likely will want to ask asp.net for the data",
    "start": "3174640",
    "end": "3181750"
  },
  {
    "text": "because it's active it to ensure that's right and I do understand that for most",
    "start": "3181750",
    "end": "3190060"
  },
  {
    "text": "you know single payer apps you use tokens and there was a whole discussion",
    "start": "3190060",
    "end": "3196720"
  },
  {
    "text": "around that and I'm not saying you can't use tokens you can do that I just in in this case we didn't use it",
    "start": "3196720",
    "end": "3206370"
  },
  {
    "text": "so how would you solve it with the graph",
    "start": "3206370",
    "end": "3213100"
  },
  {
    "text": "QL where you have like only one endpoint whoa don't know who else doesn't graph",
    "start": "3213100",
    "end": "3227910"
  },
  {
    "text": "ul then go and talk talk to the web to",
    "start": "3227910",
    "end": "3233050"
  },
  {
    "text": "the api's underneath I'm not it's querying entity framework directly",
    "start": "3233050",
    "end": "3241980"
  },
  {
    "text": "okay you would lose some of the",
    "start": "3242040",
    "end": "3249250"
  },
  {
    "text": "permission the front I'm but because the user can basically make the wrong",
    "start": "3249250",
    "end": "3257560"
  },
  {
    "text": "queries yes for whatever they want and you can't simply say that they're allowed to you do this simple thing like",
    "start": "3257560",
    "end": "3266790"
  },
  {
    "text": "get products because they may have ten different properties yeah and the",
    "start": "3266790",
    "end": "3273580"
  },
  {
    "text": "manager is supposed to be allowed to query for all of those per staff only",
    "start": "3273580",
    "end": "3279940"
  },
  {
    "text": "four of those etc so um I've described how I solved that problem you're gonna",
    "start": "3279940",
    "end": "3286690"
  },
  {
    "text": "have to describe how you solve that with Groff correct I mean this is what it's about isn't it there's",
    "start": "3286690",
    "end": "3293019"
  },
  {
    "text": "we're all finding ways to to do this so I was hoping you would say that's coming",
    "start": "3293019",
    "end": "3299259"
  },
  {
    "text": "in version two no I'm sorry I don't don't have that so I think we're nearly",
    "start": "3299259",
    "end": "3305769"
  },
  {
    "text": "at the end here and yeah one more question anybody sir since you have this",
    "start": "3305769",
    "end": "3315309"
  },
  {
    "text": "owner of the data how do you handle people leaving the company how do you handle people leaving the company so",
    "start": "3315309",
    "end": "3321549"
  },
  {
    "text": "changing of owners and all that stuff so [Music]",
    "start": "3321549",
    "end": "3327059"
  },
  {
    "text": "so if you so you're saying someone",
    "start": "3327059",
    "end": "3333429"
  },
  {
    "text": "leaves the company so you would just delete the there's a something in there",
    "start": "3333429",
    "end": "3341559"
  },
  {
    "text": "that links the user to to somewhere in the company right you if he wasn't",
    "start": "3341559",
    "end": "3348789"
  },
  {
    "text": "anywhere you could delete him but if he leaves the company and it and this",
    "start": "3348789",
    "end": "3353920"
  },
  {
    "text": "happens often then you you remove the link to that company right defaults",
    "start": "3353920",
    "end": "3363939"
  },
  {
    "text": "filter data can't be accessed by anybody anymore because that person left right",
    "start": "3363939",
    "end": "3370089"
  },
  {
    "text": "so is that like you got like stale data in your database owned by somebody who",
    "start": "3370089",
    "end": "3375789"
  },
  {
    "text": "is not there anymore oh that in in the case of the personal staff yes that would happen in the case",
    "start": "3375789",
    "end": "3383829"
  },
  {
    "text": "of the hierarchy the the keys are based off the company yeah so if the company",
    "start": "3383829",
    "end": "3393269"
  },
  {
    "text": "stops then think so it's not it's not",
    "start": "3393269",
    "end": "3398829"
  },
  {
    "text": "the user ID anymore that's why I show you the hierarchy so that is using the this key based on the company well thank",
    "start": "3398829",
    "end": "3408459"
  },
  {
    "text": "you for your time and I hope your rest enjoy the rest of the show and do come and talk to me if you've got anything",
    "start": "3408459",
    "end": "3414400"
  },
  {
    "text": "else thank you",
    "start": "3414400",
    "end": "3418430"
  }
]