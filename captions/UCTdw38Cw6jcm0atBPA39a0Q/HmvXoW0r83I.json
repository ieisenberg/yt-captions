[
  {
    "text": "good morning everybody good morning thank you for uh showing up on a Thursday morning at nine o'clock",
    "start": "2120",
    "end": "8340"
  },
  {
    "text": "talk I used to have philosophy lectures at Thursday morning on a nine o'clock and there would not be a full house like",
    "start": "8340",
    "end": "13559"
  },
  {
    "text": "this for a philosophy lecture I can tell you that much um so I want to start with a tiny bit of",
    "start": "13559",
    "end": "19619"
  },
  {
    "text": "audience participation so I can just about see you all around but um who in",
    "start": "19619",
    "end": "25980"
  },
  {
    "text": "this room is a infrastructure person that is in charge of like Azure active",
    "start": "25980",
    "end": "31019"
  },
  {
    "text": "directory or something like that okay cool cool all right so only a",
    "start": "31019",
    "end": "36120"
  },
  {
    "text": "couple of people about to get scared by this intro bit then because when I was putting this talk together",
    "start": "36120",
    "end": "42480"
  },
  {
    "text": "I started thinking about all the different ways that I'd dealt with usernames and passwords and",
    "start": "42480",
    "end": "47820"
  },
  {
    "text": "authentication over the years um so I'm Graham I work as a Cloud solution architect for Microsoft I'm",
    "start": "47820",
    "end": "54960"
  },
  {
    "text": "based in Perth Sunny Perth in Western Australia but I'm English by Nature so I'm a little bit jet lagged so kind of",
    "start": "54960",
    "end": "61620"
  },
  {
    "text": "give me that today when you're thinking about those colors at the end to see Grandma's jealous it's okay yeah we can",
    "start": "61620",
    "end": "66840"
  },
  {
    "text": "go agree One Step Up um but I've been an engineer for most of my life like 25 years or so most of my",
    "start": "66840",
    "end": "73920"
  },
  {
    "text": "professional career I should say and I thought about the ways that I dealt with users and passwords and things over the",
    "start": "73920",
    "end": "80460"
  },
  {
    "text": "decades I started thinking about that first application I wrote and it had a table in a database called user and a",
    "start": "80460",
    "end": "87060"
  },
  {
    "text": "table called password and I don't even know if those passwords were encrypted or hashed or anything",
    "start": "87060",
    "end": "93000"
  },
  {
    "text": "like that right it was not a good place to be but we didn't know any better back in the day or maybe some people did I",
    "start": "93000",
    "end": "99960"
  },
  {
    "text": "didn't know any better has anyone done that in here does anyone admit yes I'm not alive oh this is oh wow there's",
    "start": "99960",
    "end": "105960"
  },
  {
    "text": "actually quite a few people in here that's pretty cool who's done it twice inside the same",
    "start": "105960",
    "end": "112380"
  },
  {
    "text": "organization with separate username and password tables for their applications okay we're getting less and less people",
    "start": "112380",
    "end": "119759"
  },
  {
    "text": "in here but I will admit to that I did that I did that back in the day we may have used an md5 show a hash or",
    "start": "119759",
    "end": "126840"
  },
  {
    "text": "something like that on the password which you know I don't think you could crack that back in 1996 but it's not a",
    "start": "126840",
    "end": "133620"
  },
  {
    "text": "good place to be so we fast forward a few years and we're now inside Enterprises that have got active",
    "start": "133620",
    "end": "139800"
  },
  {
    "text": "directory so we all start changing to use active directory instead right",
    "start": "139800",
    "end": "145140"
  },
  {
    "text": "because how hard can that be when we want to propagate user identity all the way through from a web application to",
    "start": "145140",
    "end": "151440"
  },
  {
    "text": "row level security in an Oracle database using Kerberos and things like that and we have to reach out to find the two",
    "start": "151440",
    "end": "157920"
  },
  {
    "text": "people in the known universe that can do Kerberos delegation from end to end all the way and we annoy our corporate",
    "start": "157920",
    "end": "164879"
  },
  {
    "text": "active directory team for groups all the time because we start plugging our application permissions into ad and this",
    "start": "164879",
    "end": "171120"
  },
  {
    "text": "is again not a good place to be in it's really complicated and it felt like it",
    "start": "171120",
    "end": "177120"
  },
  {
    "text": "should be easier so we come forward to about 2004 and it",
    "start": "177120",
    "end": "182519"
  },
  {
    "text": "did get easy because Death Star came along WS star WS Federation WS security who",
    "start": "182519",
    "end": "189239"
  },
  {
    "text": "here has tried to roll their own secure token service because that's what we did in 2005.",
    "start": "189239",
    "end": "194280"
  },
  {
    "text": "nobody there's nobody rolled their own STS oh you are so lucky wow I had",
    "start": "194280",
    "end": "200400"
  },
  {
    "text": "sleepless nights I I I thought my world was coming to an end trying to debug like WS security oh",
    "start": "200400",
    "end": "208379"
  },
  {
    "text": "my word you're so lucky that's great but here we are we're stocking corporate Enterprise space and around the sort of",
    "start": "208379",
    "end": "215099"
  },
  {
    "text": "mid to early 2000s and we look out to the internet and we see these platforms",
    "start": "215099",
    "end": "220379"
  },
  {
    "text": "like Facebook and Twitter starting to grow and become really really big web scale right they're becoming huge they",
    "start": "220379",
    "end": "227700"
  },
  {
    "text": "have millions of users and they have these problems of authentication and authorization at scale and they're",
    "start": "227700",
    "end": "234299"
  },
  {
    "text": "starting to monetize themselves as well so they open themselves up to third-party applications so they become",
    "start": "234299",
    "end": "241019"
  },
  {
    "text": "platforms but they have a problem because they don't want their users handing over their usernames and",
    "start": "241019",
    "end": "247319"
  },
  {
    "text": "passwords to let's say Pet Farm or something like that so it can go and post a Twitter post for you because if",
    "start": "247319",
    "end": "253920"
  },
  {
    "text": "you give it your username and password or you can do all so much more than that right it's got the keys to your kingdom",
    "start": "253920",
    "end": "260579"
  },
  {
    "text": "actually it may be left of the day because I was thinking about a lot of uh Finance providers that will ask for your",
    "start": "260579",
    "end": "266040"
  },
  {
    "text": "internet banking usernames and passwords still so they can log on and scrape all your accounts and things like that and",
    "start": "266040",
    "end": "271560"
  },
  {
    "text": "people seem less concerned about handing that kind of information over than they did about allowing Pet Farm or something",
    "start": "271560",
    "end": "276960"
  },
  {
    "text": "to post on their Twitter feed but but there you go but they had this fundamental problem which was how do we",
    "start": "276960",
    "end": "282900"
  },
  {
    "text": "enable Graham a user to use this third-party application Pet Farm",
    "start": "282900",
    "end": "288060"
  },
  {
    "text": "to give it delegated consent to access a resource owned by Facebook",
    "start": "288060",
    "end": "294960"
  },
  {
    "text": "and so we start to see the birth of protocols that today we all know and love is oauth 2 and open ID connect",
    "start": "294960",
    "end": "302580"
  },
  {
    "text": "etc etc and it's become really really common currency now right when you start a new asp.net application or a new node",
    "start": "302580",
    "end": "310199"
  },
  {
    "text": "application or a spring boot application you're probably going to reach for openid connect to deal with your",
    "start": "310199",
    "end": "316919"
  },
  {
    "text": "authentication and your authorization concerns I'll just say auth for now on because it's like really long like I've",
    "start": "316919",
    "end": "322979"
  },
  {
    "text": "run out of time at the end but I can save myself I reckon 35 seconds by breaking that into off",
    "start": "322979",
    "end": "328740"
  },
  {
    "text": "um but that's what we do it's become super commonplace whether it's Ping Identity or OCTA or Azure active",
    "start": "328740",
    "end": "335280"
  },
  {
    "text": "directory now the reason uh I put this talk together is because a lot of my work involves",
    "start": "335280",
    "end": "342300"
  },
  {
    "text": "helping customers that are trying to get these flows working specifically within",
    "start": "342300",
    "end": "347520"
  },
  {
    "text": "Azure active directory and that sounds really really easy right I'm not going to go through today how to get up and",
    "start": "347520",
    "end": "354360"
  },
  {
    "text": "running with a simple application because there's a billion sources on the internet that can do that better than I",
    "start": "354360",
    "end": "359699"
  },
  {
    "text": "can but what I find is I will get a phone call from a team saying it's not working",
    "start": "359699",
    "end": "365639"
  },
  {
    "text": "it's like well okay let's let's have a look how you set it up and it becomes clear that there are lots of different",
    "start": "365639",
    "end": "371280"
  },
  {
    "text": "pieces that all have to line up perfectly like the stars for these flows to work you have an identity team that",
    "start": "371280",
    "end": "378419"
  },
  {
    "text": "do their little piece they're confident it's correct you've got the API team there on their little piece they're",
    "start": "378419",
    "end": "383639"
  },
  {
    "text": "confident that's correct you've got the single page application so you've got a native application team they're convinced their bits correct as well and",
    "start": "383639",
    "end": "390419"
  },
  {
    "text": "yet it doesn't work and what always strikes me is people often don't quite",
    "start": "390419",
    "end": "396000"
  },
  {
    "text": "understand how to go about diagnosing and debugging that next level to really",
    "start": "396000",
    "end": "401220"
  },
  {
    "text": "understand why these flows aren't working so that's really the aim for my session",
    "start": "401220",
    "end": "406740"
  },
  {
    "text": "today I want to show you the tools and the techniques that we can use to diagnose some common problems with",
    "start": "406740",
    "end": "413280"
  },
  {
    "text": "openid connect msal which is a Microsoft library for helping with that and specifically Azure",
    "start": "413280",
    "end": "419699"
  },
  {
    "text": "active directory now we'll focus on that a lot of the things I'll show you they're fairly transferable because at",
    "start": "419699",
    "end": "426120"
  },
  {
    "text": "the end of the day a lot of this stuff is based off open uh specifications now we're going to have a look at a flow",
    "start": "426120",
    "end": "433199"
  },
  {
    "text": "called the pkce flow or pixie which is a newer flow for Native applications which",
    "start": "433199",
    "end": "438660"
  },
  {
    "text": "you know if you're writing mobile apps or single page apps you really should be using and we'll have a look at how that",
    "start": "438660",
    "end": "444419"
  },
  {
    "text": "kind of layers into this security story to create a more safe and secure application",
    "start": "444419",
    "end": "450300"
  },
  {
    "text": "we're going to break down jwt's Jason Webb tokens that a common currency of",
    "start": "450300",
    "end": "456539"
  },
  {
    "text": "open ID connect but we're going to have a look inside them and we're going to see how those different pieces in there",
    "start": "456539",
    "end": "461940"
  },
  {
    "text": "relate to the concepts that we're talking about and finally we're going to dig into this",
    "start": "461940",
    "end": "467520"
  },
  {
    "text": "Concepts called Scopes and groups and roles and try and pick apart what authorization really means and how best",
    "start": "467520",
    "end": "474660"
  },
  {
    "text": "to go about it so when I put my talks together I like",
    "start": "474660",
    "end": "480419"
  },
  {
    "text": "to hang things off a bit of a journey or a bit of a kind of fabricated story and I first delivered this in I first",
    "start": "480419",
    "end": "487020"
  },
  {
    "text": "delivered in July actually last year which might not make sense as to why I've chosen this kind of scenario but I",
    "start": "487020",
    "end": "493800"
  },
  {
    "text": "redelivered it in December and in Australia December and July are both months of the year that are associated",
    "start": "493800",
    "end": "500520"
  },
  {
    "text": "with Christmas I thought about well Christmas is a really interesting problem to solve when you think about it",
    "start": "500520",
    "end": "506699"
  },
  {
    "text": "there's a lot of complicated logic in there right how does Father Christmas Get Around the World in one night that",
    "start": "506699",
    "end": "512580"
  },
  {
    "text": "is like a traveling Center problem that is just exploded in complexity can you",
    "start": "512580",
    "end": "517620"
  },
  {
    "text": "imagine the business logic involved in that the naughty nice list you don't want that being hacked oh your",
    "start": "517620",
    "end": "524459"
  },
  {
    "text": "poor children my kids would be so upset if the Naughty Nice List got hacked so July is coming again and let's have a",
    "start": "524459",
    "end": "531959"
  },
  {
    "text": "look at Santa web which is Father Christmas's application for doing Christmas right now Santa Webb started",
    "start": "531959",
    "end": "540060"
  },
  {
    "text": "Life as a asp.net web forms application I think it was built around 1998 there",
    "start": "540060",
    "end": "546360"
  },
  {
    "text": "was an old cobal system back in the day but they kind of modernized it when.net first came along but it ran on premise",
    "start": "546360",
    "end": "553019"
  },
  {
    "text": "in a North Pole Data Center and it had its own usernames and passwords tables and things are getting a little bit",
    "start": "553019",
    "end": "559320"
  },
  {
    "text": "complex with security so Father Christmas set the else out on a task to modernize the authentication",
    "start": "559320",
    "end": "565620"
  },
  {
    "text": "and as part of doing this they migrated to one of the Azure North Pole data centers disclaimer we don't have Azure",
    "start": "565620",
    "end": "572160"
  },
  {
    "text": "North Pole data centers I don't think I think we might have had a submarine that we submerged up here at some point in",
    "start": "572160",
    "end": "577560"
  },
  {
    "text": "time because it was cold down in the sea but we don't have Blicks and mortared data centers but they wanted to leverage",
    "start": "577560",
    "end": "584220"
  },
  {
    "text": "office and in doing so they put all their identities into Azure active directory and they realized that Santa",
    "start": "584220",
    "end": "590940"
  },
  {
    "text": "Webb Legacy as it was let's call it a Heritage application could lift and shift quite easily into the cloud and",
    "start": "590940",
    "end": "597540"
  },
  {
    "text": "they could put a thin veneer of open ID connects on top of it to make sure that",
    "start": "597540",
    "end": "602820"
  },
  {
    "text": "they could authenticate Santa and the else into the application so it's pretty straightforward and they were very",
    "start": "602820",
    "end": "608160"
  },
  {
    "text": "confident with that piece of the puzzle but then they got one of the big four consultancy firms in because they wanted",
    "start": "608160",
    "end": "614040"
  },
  {
    "text": "to digitally transform Christmas and they were sold ah no you need to make",
    "start": "614040",
    "end": "619320"
  },
  {
    "text": "apis because the API economy is ruling the world now so the first thing they thought was can",
    "start": "619320",
    "end": "626339"
  },
  {
    "text": "we pull out all this business logic and create brand new apis that sit in lambdas or functions or whatever the",
    "start": "626339",
    "end": "633300"
  },
  {
    "text": "current modern tech stack is and they had a look at the code and they quickly realized there's no unit tests",
    "start": "633300",
    "end": "640380"
  },
  {
    "text": "there's no real confidence when they're deployed as stuff they try not to touch it as little as they can anyway so they",
    "start": "640380",
    "end": "648120"
  },
  {
    "text": "decided that pulling all that logic out into these brand new apis is a really really bad idea so instead they just",
    "start": "648120",
    "end": "654779"
  },
  {
    "text": "extracted as much as they could in place and they put a bunch of apis over that new capabilities and they decided to",
    "start": "654779",
    "end": "662279"
  },
  {
    "text": "secure them with oauth 2 Json web tokens this is all good so far",
    "start": "662279",
    "end": "667500"
  },
  {
    "text": "Santa has a cracked team of elves who are user expert experienced developers",
    "start": "667500",
    "end": "672660"
  },
  {
    "text": "and they decided when they saw these apis that they could create Santa light which would transform the way that you",
    "start": "672660",
    "end": "680100"
  },
  {
    "text": "did Christmas you could get 35 to 40 efficiency by moving on to this new",
    "start": "680100",
    "end": "685800"
  },
  {
    "text": "modern user interface very lightweight very slick it's beautiful okay",
    "start": "685800",
    "end": "691019"
  },
  {
    "text": "so this sounds kind of weird but then if I think about many of my customers over the years this is a really common thing",
    "start": "691019",
    "end": "698160"
  },
  {
    "text": "that you see right not all customers want to rewrite their legacy apis but most want to extract and create new",
    "start": "698160",
    "end": "705660"
  },
  {
    "text": "capabilities so you can build new skins new channel applicators on top of it and",
    "start": "705660",
    "end": "711000"
  },
  {
    "text": "everyone's trying to use openid connect and that's what's happening here but I have been told that something is not",
    "start": "711000",
    "end": "718260"
  },
  {
    "text": "working down there and they just don't know where to go about debugging this so what we're going to do is we're going to",
    "start": "718260",
    "end": "724500"
  },
  {
    "text": "leave the world of PowerPoint and we're going to dive into the code to start having a look around and see if we can",
    "start": "724500",
    "end": "730079"
  },
  {
    "text": "help the else down there so let's go",
    "start": "730079",
    "end": "735740"
  },
  {
    "text": "now then can everybody see my screen Okay no Okay that's not a good start is it",
    "start": "736920",
    "end": "744120"
  },
  {
    "text": "what's it look what's what's the oh",
    "start": "744120",
    "end": "748339"
  },
  {
    "text": "hahaha okay cool",
    "start": "749760",
    "end": "755220"
  },
  {
    "text": "let's just try and out the font size as well for what it's worth alrighty so",
    "start": "755220",
    "end": "762740"
  },
  {
    "text": "satellite is a very simple reactor application oh this is not good is it oh",
    "start": "762899",
    "end": "768899"
  },
  {
    "text": "God this could be a problem",
    "start": "768899",
    "end": "774200"
  },
  {
    "text": "I had a colleague from Perth Amy who did a talk I think in this room yesterday and she came out and she was white as a",
    "start": "775079",
    "end": "780959"
  },
  {
    "text": "sheet and so what happened she's like I think this happens basically",
    "start": "780959",
    "end": "786600"
  },
  {
    "text": "uh uh is it a cable problem",
    "start": "786600",
    "end": "791639"
  },
  {
    "text": "oh God okay wow this Talk's going to be really flat",
    "start": "791639",
    "end": "796860"
  },
  {
    "text": "without this video isn't it um is there anything we can do over there do you think Mr technician man at the back",
    "start": "796860",
    "end": "803940"
  },
  {
    "text": "or are we dead in the water here uh hmm",
    "start": "803940",
    "end": "809839"
  },
  {
    "text": "it's like breathing on it made the problem didn't it",
    "start": "809839",
    "end": "815420"
  },
  {
    "text": "persevere we could make this happen",
    "start": "821040",
    "end": "827420"
  },
  {
    "text": "now then what are we doing",
    "start": "830220",
    "end": "833540"
  },
  {
    "text": "hey try this one now we have a new dongle awesome this one looks a bit more modern as well great",
    "start": "838560",
    "end": "845100"
  },
  {
    "text": "this is going to work okay that's got is it on the side there",
    "start": "845100",
    "end": "851339"
  },
  {
    "text": "we go",
    "start": "851339",
    "end": "853639"
  },
  {
    "text": "okay",
    "start": "858240",
    "end": "860720"
  },
  {
    "text": "I've got a good feeling about this",
    "start": "863279",
    "end": "866480"
  },
  {
    "text": "oh no this is just standard settings on here",
    "start": "870360",
    "end": "876000"
  },
  {
    "text": "uh right",
    "start": "876000",
    "end": "883279"
  },
  {
    "text": "that's I was gonna say that's can you see that now oh crap look at that all right",
    "start": "885420",
    "end": "893899"
  },
  {
    "text": "you stay right there don't move okay",
    "start": "893899",
    "end": "900959"
  },
  {
    "text": "but let's see if we can cover through this oh this is good",
    "start": "900959",
    "end": "905540"
  },
  {
    "text": "oh you reckon okay shall we try that that's PowerPoint yeah",
    "start": "918199",
    "end": "923820"
  },
  {
    "text": "PowerPoint is Oh weird what",
    "start": "923820",
    "end": "929459"
  },
  {
    "text": "is it because I use vs code is that right yeah there's a hatred here",
    "start": "929459",
    "end": "939079"
  },
  {
    "text": "really you're serious wow well I'm not going to be in vs code for too long so let's see how we go it's kind of like",
    "start": "943279",
    "end": "950100"
  },
  {
    "text": "holding together okay cool wow so wow this is great so or else created",
    "start": "950100",
    "end": "957779"
  },
  {
    "text": "themselves a very simple react application and when they did so they had to choose they had to make a choice",
    "start": "957779",
    "end": "963600"
  },
  {
    "text": "up front to decide how to connect to Azure active directory do they use adol",
    "start": "963600",
    "end": "968699"
  },
  {
    "text": "or do they use node these are both libraries that Microsoft have got up on npm that allow you to basically hook",
    "start": "968699",
    "end": "975600"
  },
  {
    "text": "into the flows you need to authenticate and authorize people now you can hopefully see from uh the screen because",
    "start": "975600",
    "end": "982620"
  },
  {
    "text": "it's laughs I planned that that was like",
    "start": "982620",
    "end": "989959"
  },
  {
    "text": "oh okay yeah let's try that that's a good point actually how do you do that anyone know ah Ctrl shift p",
    "start": "992399",
    "end": "1001660"
  },
  {
    "text": "light light light the resolution that's a good that's a good one as well uh talk",
    "start": "1001699",
    "end": "1007459"
  },
  {
    "text": "between ah oh no way",
    "start": "1007459",
    "end": "1012920"
  },
  {
    "text": "thank you yes that's so good I can actually I think I",
    "start": "1012920",
    "end": "1019699"
  },
  {
    "text": "can go back to the keyboard then wow that's that's one to remember all right so they had to make a choice and luckily",
    "start": "1019699",
    "end": "1026660"
  },
  {
    "text": "for us the elves decided that and you saw the Red Dot they decided to use MSL stands for Microsoft authentication",
    "start": "1026660",
    "end": "1033380"
  },
  {
    "text": "Library the other alternative is a dial I think that stands for active directory",
    "start": "1033380",
    "end": "1038600"
  },
  {
    "text": "authentication I mean maybe Azure active directory authentication library but that would be like oh Dell but it's a",
    "start": "1038600",
    "end": "1044058"
  },
  {
    "text": "doll so why do I call this out well look the reason I call this out is if we go",
    "start": "1044059",
    "end": "1049220"
  },
  {
    "text": "to npm and we have a look at Adele what you'll see at the top is a whole bunch of things telling you Adar will no",
    "start": "1049220",
    "end": "1056000"
  },
  {
    "text": "longer receive feature improvements you shouldn't use this Library it's on life support",
    "start": "1056000",
    "end": "1061520"
  },
  {
    "text": "etc etc lots of warning flakes but when we looked down here",
    "start": "1061520",
    "end": "1067280"
  },
  {
    "text": "still gets 445 000 weekly downloads Adele does not support more modern oidc",
    "start": "1067280",
    "end": "1075260"
  },
  {
    "text": "flows there are some things it does do which you can't do in MSL Microsoft authentication library but the bottom",
    "start": "1075260",
    "end": "1082700"
  },
  {
    "text": "line is when you start a new application make sure you go for MSL so like I said",
    "start": "1082700",
    "end": "1088520"
  },
  {
    "text": "just a public service announcement because that number's really quite scary I think it still gets security fixes but",
    "start": "1088520",
    "end": "1094220"
  },
  {
    "text": "that's not the point the point is that those flows themselves are considered less secure than the newer flows so even",
    "start": "1094220",
    "end": "1101360"
  },
  {
    "text": "if you're getting security fixes you know it's it's not it's not great to be here",
    "start": "1101360",
    "end": "1106460"
  },
  {
    "text": "so when the elves set this up they had to provide a tiny little bit of",
    "start": "1106460",
    "end": "1111919"
  },
  {
    "text": "configuration to get things up and going specifically they had to provide an",
    "start": "1111919",
    "end": "1117559"
  },
  {
    "text": "authority and a client ID to MSL so these are really common things in open",
    "start": "1117559",
    "end": "1122660"
  },
  {
    "text": "ID connect very common terms The Authority The Authority is the thing that is the source of of our density our",
    "start": "1122660",
    "end": "1130580"
  },
  {
    "text": "identity it's the thing we trust if it tells us that somebody is who Babe",
    "start": "1130580",
    "end": "1136160"
  },
  {
    "text": "somebody is Santa we trust them we say yes that is Santa we we obey your",
    "start": "1136160",
    "end": "1141500"
  },
  {
    "text": "instructions to us so we're delegating our trusted Authority now for Azure",
    "start": "1141500",
    "end": "1146900"
  },
  {
    "text": "active directory you'll always see an authority in this form it's login.microsoftonline.com followed by a",
    "start": "1146900",
    "end": "1153500"
  },
  {
    "text": "good so that good is your tenant ID it's your little slice of your identity",
    "start": "1153500",
    "end": "1159320"
  },
  {
    "text": "inside a massively multi-tenanted identity solution that is used by like lots and lots of customers around the",
    "start": "1159320",
    "end": "1166220"
  },
  {
    "text": "world so everybody has their own tenant ID that might be a little bit different to",
    "start": "1166220",
    "end": "1171440"
  },
  {
    "text": "say ping or October I think you can use your own fully qualified domain name for",
    "start": "1171440",
    "end": "1176900"
  },
  {
    "text": "your Authority but in aad it's always figured like that the next thing is the client ID so this",
    "start": "1176900",
    "end": "1184820"
  },
  {
    "text": "is again a really common component of all open ID connect flows every",
    "start": "1184820",
    "end": "1190520"
  },
  {
    "text": "application that is involved in these flows is a unique client and it is",
    "start": "1190520",
    "end": "1195799"
  },
  {
    "text": "referenced somehow uniquely within that directory so we have Azure active directory again every application or",
    "start": "1195799",
    "end": "1202520"
  },
  {
    "text": "client you register will get a grid actually that was interesting I said application or client so this is where",
    "start": "1202520",
    "end": "1208039"
  },
  {
    "text": "we get onto the first wonderful part of azure active directory so let's go in to see if we can find these things inside",
    "start": "1208039",
    "end": "1214280"
  },
  {
    "text": "the Azure portal so I've got my own tenant here it's called",
    "start": "1214280",
    "end": "1220340"
  },
  {
    "text": "gram world if you can get your own tenant I highly recommend it especially if you can get one with like the P2",
    "start": "1220340",
    "end": "1226760"
  },
  {
    "text": "licenses or something because then you get to have a play around with conditional access and all these kind of",
    "start": "1226760",
    "end": "1232640"
  },
  {
    "text": "really cool security features inside of aad but you know if you don't everyone can get their own tenant and you",
    "start": "1232640",
    "end": "1239660"
  },
  {
    "text": "basically um can get into the portal and here we can see the tenant ID which is a47 so this",
    "start": "1239660",
    "end": "1246440"
  },
  {
    "text": "is good the configuration matches up with what we saw in the vs code application let's go and find the client",
    "start": "1246440",
    "end": "1253580"
  },
  {
    "text": "now you're not going to find the word client inside the portal here aad I",
    "start": "1253580",
    "end": "1259640"
  },
  {
    "text": "guess I want to say predates open ID connect but it also supports things like saml and WS federations or some other",
    "start": "1259640",
    "end": "1267080"
  },
  {
    "text": "flows so the terms don't always match one to one with what you'll see in open ID connect so in aad we refer to these",
    "start": "1267080",
    "end": "1274760"
  },
  {
    "text": "things as applications now if we go into the app registrations",
    "start": "1274760",
    "end": "1279860"
  },
  {
    "text": "and we'll go into all apps",
    "start": "1279860",
    "end": "1284380"
  },
  {
    "text": "then what we will see down here is that we have an application called satellite",
    "start": "1286460",
    "end": "1292940"
  },
  {
    "text": "and it has a application in fact oh I should have actually scrolled in a little bit over here",
    "start": "1292940",
    "end": "1298520"
  },
  {
    "text": "let's see if we can keep that on the screen over there Center light B10 and you'll even see what we're starting to",
    "start": "1298520",
    "end": "1304700"
  },
  {
    "text": "do is tweak the portal more and more to kind of make the open ID connect terms a little bit more Center place so it's",
    "start": "1304700",
    "end": "1311480"
  },
  {
    "text": "kind of a little bit of a help but the important thing here is b102 so that",
    "start": "1311480",
    "end": "1317720"
  },
  {
    "text": "should match up with what we have not in that one in this one b102 so everything",
    "start": "1317720",
    "end": "1324020"
  },
  {
    "text": "looks good so let's start the app up and see what is going wrong so you see it's a beautiful application",
    "start": "1324020",
    "end": "1330500"
  },
  {
    "text": "uh those elfs are pretty good designers at the end of the day oh there's one",
    "start": "1330500",
    "end": "1336500"
  },
  {
    "text": "tool I didn't start up in the background oh I'm going to give my game away now this is terrible nobody saw that",
    "start": "1336500",
    "end": "1341900"
  },
  {
    "text": "it's not I think he did not start Fiddler up so let's go and",
    "start": "1341900",
    "end": "1347840"
  },
  {
    "text": "sign in and sign in",
    "start": "1347840",
    "end": "1354620"
  },
  {
    "text": "okay so the first thing that happens is we get taken away from our application if you look in the URL you can see we've",
    "start": "1354620",
    "end": "1360559"
  },
  {
    "text": "left satellite.localtest.me and we've gone to that Authority so this is the first important piece we don't sign uses it",
    "start": "1360559",
    "end": "1367640"
  },
  {
    "text": "anymore we don't take their usernames and passwords inside our app because that's not very secure instead we allow",
    "start": "1367640",
    "end": "1373400"
  },
  {
    "text": "aad to do that for us so what I'm going to do is open up my little password manager",
    "start": "1373400",
    "end": "1379039"
  },
  {
    "text": "I think this one's now like been considered insecure hasn't it as well so",
    "start": "1379039",
    "end": "1384320"
  },
  {
    "text": "terrible in a security talk I'm using insecure things so we're going to sign in as Center",
    "start": "1384320",
    "end": "1390919"
  },
  {
    "text": "and we'll put his password in",
    "start": "1390919",
    "end": "1394539"
  },
  {
    "text": "and we first get asked for some consent so we talked earlier about the Facebook",
    "start": "1396500",
    "end": "1401720"
  },
  {
    "text": "problem of asking our users for consent to do something on their behalf and that's what we're seeing here it's a",
    "start": "1401720",
    "end": "1407840"
  },
  {
    "text": "standard consent and we see this all the time in openid Connect and what it's telling is is that there's an",
    "start": "1407840",
    "end": "1413360"
  },
  {
    "text": "application called satellite and what it wants to do the important one here is it wants to sign you in and",
    "start": "1413360",
    "end": "1420140"
  },
  {
    "text": "read your profile now these little bits of text here are what we refer to as Scopes inside of",
    "start": "1420140",
    "end": "1426620"
  },
  {
    "text": "open ID connect and a scope is really nothing more than a piece of text you",
    "start": "1426620",
    "end": "1432559"
  },
  {
    "text": "can put in front of an end user that makes sense for them they can understand it when they look at it so don't think",
    "start": "1432559",
    "end": "1438620"
  },
  {
    "text": "in terms of backend apis think in terms of there are real people what will they understand and what will mean something",
    "start": "1438620",
    "end": "1445100"
  },
  {
    "text": "to them so in our case we're actually asking for a particular scope which is called an open ID scope",
    "start": "1445100",
    "end": "1452200"
  },
  {
    "text": "now open ID connect was kind of like an evolution on top of oauth2 so if we go",
    "start": "1452200",
    "end": "1459679"
  },
  {
    "text": "back oauth 2 was never an Authentication Protocol it was always about authorization so it would give you",
    "start": "1459679",
    "end": "1467299"
  },
  {
    "text": "consent to do something on behalf of a user but it didn't care about who that user was it wasn't telling you his full",
    "start": "1467299",
    "end": "1473720"
  },
  {
    "text": "name here's their email here's their phone number it was all about yes Graham is allowing you to do something",
    "start": "1473720",
    "end": "1479659"
  },
  {
    "text": "and lots of different ways to do authentication were kind of built on top of oauth 2. so Facebook had their own",
    "start": "1479659",
    "end": "1486799"
  },
  {
    "text": "API to get your profile uh Google had an API to get your profile and the idea was you could ask for consent to call that",
    "start": "1486799",
    "end": "1493940"
  },
  {
    "text": "API but it was very non-standard lots of different ways of describing profiles so",
    "start": "1493940",
    "end": "1499880"
  },
  {
    "text": "openid connect came along and unified all of that and said we're going to create this thing called a an open ID",
    "start": "1499880",
    "end": "1506659"
  },
  {
    "text": "scope that will give you a standard set of information about a user so what we're going to do is click on",
    "start": "1506659",
    "end": "1513380"
  },
  {
    "text": "here and see what happens and boom this must have been the problem",
    "start": "1513380",
    "end": "1518900"
  },
  {
    "text": "that the elves had now this is a really really straightforward problem but I do get customers calling me up because",
    "start": "1518900",
    "end": "1525440"
  },
  {
    "text": "they're just not sure what's going on and what we're being told is the redirect URI remember I said we took you",
    "start": "1525440",
    "end": "1531440"
  },
  {
    "text": "away from satellite.localtest.me it does not match something that is configured inside",
    "start": "1531440",
    "end": "1536720"
  },
  {
    "text": "Azure active directory and this kind of makes sense right because we're taking you away from your page and eventually",
    "start": "1536720",
    "end": "1543020"
  },
  {
    "text": "when you've signed in we need to get you back there so where do we send you to now in the olden days I think it's about",
    "start": "1543020",
    "end": "1549260"
  },
  {
    "text": "six years ago a lot of identity providers supported these things called wild card redirects so you could",
    "start": "1549260",
    "end": "1556880"
  },
  {
    "text": "literally say to the identity provider send me back here just don't ask any questions that's okay you don't need to",
    "start": "1556880",
    "end": "1562760"
  },
  {
    "text": "know about this URL but that's a really really big security problem like imagine if the Grinch wrote",
    "start": "1562760",
    "end": "1569600"
  },
  {
    "text": "his own little application that looked like Santa light but it was hosted on",
    "start": "1569600",
    "end": "1574659"
  },
  {
    "text": "grinch.localtest.me and he could just blindly say to aad can you redirect someone back to here",
    "start": "1574659",
    "end": "1580580"
  },
  {
    "text": "so he could get tokens because people might not realize where they were actually being sent back to was a dodgy",
    "start": "1580580",
    "end": "1586820"
  },
  {
    "text": "website so open ID connects kind of formalized this and said no no okay none of that",
    "start": "1586820",
    "end": "1592100"
  },
  {
    "text": "anymore you need to be very explicit to make sure that wherever you're being asked to get sent back to is registered",
    "start": "1592100",
    "end": "1598340"
  },
  {
    "text": "in aad so with that let's go to aad and see if",
    "start": "1598340",
    "end": "1603559"
  },
  {
    "text": "we can see what the problem is with this one so we're going to go into uh aad and",
    "start": "1603559",
    "end": "1609440"
  },
  {
    "text": "we'll pick the Santa light application v1o",
    "start": "1609440",
    "end": "1614960"
  },
  {
    "text": "and what we can see over here is that we've got a single redirect URI configured so",
    "start": "1615980",
    "end": "1623000"
  },
  {
    "text": "we'll go and have a look at that and this is quite a straightforward one what we can see is that the redirect URI",
    "start": "1623000",
    "end": "1630260"
  },
  {
    "text": "is wrong it has sign in oidc on the end of it so when this happened on my customer site what had actually happened",
    "start": "1630260",
    "end": "1636860"
  },
  {
    "text": "was that an application team had said to the identity team hey we want to set up a new AED application here's our fully",
    "start": "1636860",
    "end": "1644000"
  },
  {
    "text": "qualified domain name and the identity team had assumed that the application was a.net core asp.net",
    "start": "1644000",
    "end": "1650480"
  },
  {
    "text": "core application so we're just automatically gone and added the sign-in ID prefix on the end of it super simple",
    "start": "1650480",
    "end": "1656539"
  },
  {
    "text": "to fix this one they do get more complicated I promise",
    "start": "1656539",
    "end": "1662720"
  },
  {
    "text": "we can just hit save on that and then just want to make sure this was",
    "start": "1662720",
    "end": "1669080"
  },
  {
    "text": "definitely the right one b102 yes it was let's go back again to santalight.localtest.me",
    "start": "1669080",
    "end": "1676039"
  },
  {
    "text": "sign in",
    "start": "1679580",
    "end": "1682360"
  },
  {
    "text": "and we come back and if all goes well then",
    "start": "1692059",
    "end": "1697580"
  },
  {
    "text": "here we are why not not signed in I've had this happen before",
    "start": "1697580",
    "end": "1702679"
  },
  {
    "text": "it's one of those ones that's so annoying",
    "start": "1702679",
    "end": "1706120"
  },
  {
    "text": "where did it go to everything's going wrong wow my browser just disappeared as well",
    "start": "1707960",
    "end": "1713860"
  },
  {
    "text": "let's try that again I promise you this will work so sensor sign in",
    "start": "1716059",
    "end": "1723760"
  },
  {
    "text": "sometimes if you leave the flows dangling for too long then things just kind of like seem to time out inside",
    "start": "1724340",
    "end": "1730340"
  },
  {
    "text": "Exile and the flows don't actually complete so what we can see here though is now we've signed centered Welcome",
    "start": "1730340",
    "end": "1736279"
  },
  {
    "text": "Center what do you want to do today so what just really happen behind the scenes so let's go back to the slide",
    "start": "1736279",
    "end": "1742400"
  },
  {
    "text": "deck and we'll walk through the flow we've just seen so we started off since went",
    "start": "1742400",
    "end": "1748940"
  },
  {
    "text": "to the browser and logging into the spa application and what it did was it generated a redirect URL and it took",
    "start": "1748940",
    "end": "1756260"
  },
  {
    "text": "Santa off to Azure active directory to do the sign in and it passed a few little bits of information along with",
    "start": "1756260",
    "end": "1762200"
  },
  {
    "text": "that that call so this is who I am I am Santa light this is my application",
    "start": "1762200",
    "end": "1767840"
  },
  {
    "text": "this is what I want to do I want to sign Santa in I want to authenticate him so I know who it is",
    "start": "1767840",
    "end": "1774140"
  },
  {
    "text": "this is where I want to go to after the flow that was our redirect URL where we saw the problem and this is some security",
    "start": "1774140",
    "end": "1780679"
  },
  {
    "text": "information there's a whole bunch of kind of cryptographic stuff there's State there's nonsense all to try and",
    "start": "1780679",
    "end": "1786440"
  },
  {
    "text": "make everything a little bit more secure now one of two things will happen for a",
    "start": "1786440",
    "end": "1792140"
  },
  {
    "text": "single page application depending on what flow you're using if you're using Adel then you're using the implicit flow",
    "start": "1792140",
    "end": "1799340"
  },
  {
    "text": "and the implicit flow is the one that's really not recommended anymore and the reason for that is the implicit",
    "start": "1799340",
    "end": "1806539"
  },
  {
    "text": "flow will send some security information directly back in the redirect as",
    "start": "1806539",
    "end": "1811580"
  },
  {
    "text": "something like a hash fragment so you might see a token with user credentials or an access token with",
    "start": "1811580",
    "end": "1818179"
  },
  {
    "text": "permissions to call another API but it's sent in a hash fragment which means it can pass through proxies it can pass",
    "start": "1818179",
    "end": "1824240"
  },
  {
    "text": "through virtual appliances all things that happily log urls so I don't know about you if you've ever",
    "start": "1824240",
    "end": "1830299"
  },
  {
    "text": "gone into a corporate Splunk and done a search on HTTP logs it can be quite enlightening Sometimes some of the",
    "start": "1830299",
    "end": "1836000"
  },
  {
    "text": "things you see in the URLs that are kind of flowing through those systems now the reason the implicit flow did",
    "start": "1836000",
    "end": "1842360"
  },
  {
    "text": "this is because it had no way to be able to make another call back to Azure",
    "start": "1842360",
    "end": "1847700"
  },
  {
    "text": "aptitude directory to say hey like can you give me this token here's something",
    "start": "1847700",
    "end": "1853399"
  },
  {
    "text": "that you and I both know that is secret and secure so if anyone's ever done a server-side MVC application",
    "start": "1853399",
    "end": "1860360"
  },
  {
    "text": "has anyone done server side uh sorry server side open ID connect then you might be familiar with a flow called the",
    "start": "1860360",
    "end": "1866779"
  },
  {
    "text": "code flow so the code form is different because the back end server-side application can",
    "start": "1866779",
    "end": "1873260"
  },
  {
    "text": "keep a secret if you think of a single page application you can't keep a secret right it's a react tab you get all the",
    "start": "1873260",
    "end": "1879679"
  },
  {
    "text": "JavaScript the HTML you can peek inside that there is nothing Secret in that thing but something running on a web",
    "start": "1879679",
    "end": "1886100"
  },
  {
    "text": "server can keep a secret and if that's something that both aad and the web server know about then we can treat this",
    "start": "1886100",
    "end": "1893779"
  },
  {
    "text": "flow slightly differently what we can do is we can send something opaque back",
    "start": "1893779",
    "end": "1898880"
  },
  {
    "text": "with the redirect a code we call it it's meaningless on its own it's just some",
    "start": "1898880",
    "end": "1904220"
  },
  {
    "text": "unique identifier to that authentication flow that's just happened inside of",
    "start": "1904220",
    "end": "1909620"
  },
  {
    "text": "azure active directory so we can send this code back if you can get hold of that if you intercept in",
    "start": "1909620",
    "end": "1916159"
  },
  {
    "text": "transit you can't do anything with it you could go to Azure active Direction and say hey here's a code can you give",
    "start": "1916159",
    "end": "1921740"
  },
  {
    "text": "them the token aod will just go well no who are you but if we can get that back to the server side application it has a shared",
    "start": "1921740",
    "end": "1929299"
  },
  {
    "text": "secret and it can say to aad hey here's a code um but here's my secret to prove that I",
    "start": "1929299",
    "end": "1935659"
  },
  {
    "text": "am the application that actually requested this code in the first place an idea will go ah cool yes well I shall",
    "start": "1935659",
    "end": "1941360"
  },
  {
    "text": "give you a token so pkce kind of brings a little bit of",
    "start": "1941360",
    "end": "1946460"
  },
  {
    "text": "this to our single page applications we can't have a persistent secret but",
    "start": "1946460",
    "end": "1951500"
  },
  {
    "text": "what we can do is we can make a secret up on the Fly inside the single page application a one-time secret imagine we",
    "start": "1951500",
    "end": "1959179"
  },
  {
    "text": "just create some random bytes and we turn it into a base 64 string something like that",
    "start": "1959179",
    "end": "1965000"
  },
  {
    "text": "and then we can run a cryptographic function over that we can share it and then we can say to aad hey here's the",
    "start": "1965000",
    "end": "1972320"
  },
  {
    "text": "signing request by the way here's a Shah of a secret nobody else knows what that",
    "start": "1972320",
    "end": "1978620"
  },
  {
    "text": "secret is so aad after it's completed the authentication can then send the",
    "start": "1978620",
    "end": "1984140"
  },
  {
    "text": "code back out to the single page application and then the single page application",
    "start": "1984140",
    "end": "1990020"
  },
  {
    "text": "can make a call back to Azure active directory and it can say here here's the code and by the way here's the plain",
    "start": "1990020",
    "end": "1997039"
  },
  {
    "text": "text that I originally used to create that that sha in the first place so what",
    "start": "1997039",
    "end": "2002320"
  },
  {
    "text": "we've done is we've bound the initial request for the authentication with the",
    "start": "2002320",
    "end": "2007659"
  },
  {
    "text": "request to get the token at the end so we know in no uncertain terms that it is the right thing that is actually asking",
    "start": "2007659",
    "end": "2014260"
  },
  {
    "text": "for that security token so that happens on a back Channel flow which means that we're not flowing",
    "start": "2014260",
    "end": "2019960"
  },
  {
    "text": "security tokens through URLs that are being logged by proxies Etc and things like that anymore",
    "start": "2019960",
    "end": "2025720"
  },
  {
    "text": "so that's pkce in theory now I think you've probably noticed I",
    "start": "2025720",
    "end": "2031600"
  },
  {
    "text": "span up a tool called Fiddler in the background to try and actually capture this so we could have a look on the wire",
    "start": "2031600",
    "end": "2037000"
  },
  {
    "text": "at what it looks like so there's a whole bunch of uh requests in here and I'm",
    "start": "2037000",
    "end": "2042399"
  },
  {
    "text": "going to see if we can pick the right one so let's start with I think what looks like one of the first calls to",
    "start": "2042399",
    "end": "2048158"
  },
  {
    "text": "Azure active directory so this is the thing that kicks off the flow and there's a bunch of information as we",
    "start": "2048159",
    "end": "2054878"
  },
  {
    "text": "spoke about we've got the client ID which was our satellite application we have these Scopes these delegated",
    "start": "2054879",
    "end": "2061240"
  },
  {
    "text": "consent things that we're asking for so we briefly talked about that and you can see that there's one in here called open",
    "start": "2061240",
    "end": "2066878"
  },
  {
    "text": "ID um the other ones MSR won't let you remove those I'm not quite sure why but",
    "start": "2066879",
    "end": "2072398"
  },
  {
    "text": "it's impossible that M cell just to do a flow that is just for open ID um it's it's entirely possible within",
    "start": "2072399",
    "end": "2079358"
  },
  {
    "text": "openid connect but just not MSL we have the redirect URI we've spoke about that one already",
    "start": "2079359",
    "end": "2085720"
  },
  {
    "text": "and this is the interesting bit here what we're saying is we actually want a code to come back we don't want a token",
    "start": "2085720",
    "end": "2091599"
  },
  {
    "text": "to come back and down here we can see we've got two bits of information that refer to this",
    "start": "2091599",
    "end": "2096760"
  },
  {
    "text": "we've got the code challenge method which in our case is s256 it's a sha256",
    "start": "2096760",
    "end": "2101920"
  },
  {
    "text": "West ending it and they're the chord challenge so that's the shot so Sansa went through he signed in and",
    "start": "2101920",
    "end": "2109780"
  },
  {
    "text": "then eventually and let's see if we can find the right one here I think it's this one let's see uh",
    "start": "2109780",
    "end": "2117760"
  },
  {
    "text": "it's normally the one just before we go back to the application so yeah here we go cool after the flow is completed we",
    "start": "2117760",
    "end": "2125079"
  },
  {
    "text": "got sent back a HTML page that basically replaced the location with one that has a code on the end of",
    "start": "2125079",
    "end": "2132040"
  },
  {
    "text": "it so that's how we do the redirect back to satellite in this scenario with the code",
    "start": "2132040",
    "end": "2137320"
  },
  {
    "text": "and then the final piece of the puzzle is there's another call at the very end",
    "start": "2137320",
    "end": "2142380"
  },
  {
    "text": "back down to Azure active directory let's see if we can just get into this one so most of the information in here",
    "start": "2142380",
    "end": "2150280"
  },
  {
    "text": "is the same apart from these two bits down here so here we're saying Grant type authorization code which in openid",
    "start": "2150280",
    "end": "2157540"
  },
  {
    "text": "Connect means give me the tokens and then we're giving it that extra piece of information which was the code verifier",
    "start": "2157540",
    "end": "2164140"
  },
  {
    "text": "so this is the plain text that created the original secret that we sent off and",
    "start": "2164140",
    "end": "2170020"
  },
  {
    "text": "we also send it the code as well so what aad does is it responds with",
    "start": "2170020",
    "end": "2175960"
  },
  {
    "text": "a bunch of security tokens so in this case we get a whole bunch back",
    "start": "2175960",
    "end": "2182560"
  },
  {
    "text": "and these things are jwts and some other information in there so what we're going to do is have a look into the ID token",
    "start": "2182560",
    "end": "2188859"
  },
  {
    "text": "in this one so we're just going to copy that and we're going to go to the next tool we can use to help diagnose some of",
    "start": "2188859",
    "end": "2194560"
  },
  {
    "text": "this stuff which is a website called jwt.ms so there's one called JWT i o as well",
    "start": "2194560",
    "end": "2200619"
  },
  {
    "text": "which is really good Ms is great for Microsoft Azure active directory the",
    "start": "2200619",
    "end": "2205720"
  },
  {
    "text": "reason being we have this little description of what the things in the token actually mean so that can be",
    "start": "2205720",
    "end": "2211780"
  },
  {
    "text": "really really useful when you're dealing with aad so you get a whole ton of information about these different claims",
    "start": "2211780",
    "end": "2218320"
  },
  {
    "text": "but that's all it is it's literally a base64 encoded blob of Json and it",
    "start": "2218320",
    "end": "2225579"
  },
  {
    "text": "roughly consists of three parts the red part the blue part and the green part the red part and the green part are all",
    "start": "2225579",
    "end": "2232599"
  },
  {
    "text": "concerned about cryptography and digital signatures on this token so if you",
    "start": "2232599",
    "end": "2238060"
  },
  {
    "text": "remember earlier we talked about trusting Azure active directory as our source of identity",
    "start": "2238060",
    "end": "2243339"
  },
  {
    "text": "so the way that trust is actually created is that aad signs tokens with",
    "start": "2243339",
    "end": "2248859"
  },
  {
    "text": "private keys and it tells information about which key it used to do that",
    "start": "2248859",
    "end": "2253900"
  },
  {
    "text": "signing so that's the red part we can see here that it's a rs-256 algorithm and it points to a kid",
    "start": "2253900",
    "end": "2262359"
  },
  {
    "text": "a key ID now Aid Publishers it's public keys in what's called a discovery",
    "start": "2262359",
    "end": "2268720"
  },
  {
    "text": "document there was actually another request in Fiddler that showed my single page app going to AED saying give me",
    "start": "2268720",
    "end": "2274599"
  },
  {
    "text": "your public keys once we get the token we can now look for that key and we can validate the",
    "start": "2274599",
    "end": "2281380"
  },
  {
    "text": "signature against the token and if it all checks out we know we trust that this token came from aad so we know that",
    "start": "2281380",
    "end": "2288460"
  },
  {
    "text": "we can trust it and we know who's signed in and we get that from a bunch of these things inside the token the properties",
    "start": "2288460",
    "end": "2295119"
  },
  {
    "text": "which we refer to as claims so the important ones I think AUD that",
    "start": "2295119",
    "end": "2300760"
  },
  {
    "text": "stands for audience audience is who is that token intended to be used by",
    "start": "2300760",
    "end": "2306579"
  },
  {
    "text": "the audience in this case is b1o which is my single page application the long",
    "start": "2306579",
    "end": "2311619"
  },
  {
    "text": "and short of it is if that audience isn't you then you shouldn't really be using that token right it's not intended",
    "start": "2311619",
    "end": "2319420"
  },
  {
    "text": "for you so it's very important I've seen some scenarios in particular where people were trying to validate tokens",
    "start": "2319420",
    "end": "2326260"
  },
  {
    "text": "that were meant to be sent to the graph API and they were calling me up because Graham Graham it doesn't work we've got",
    "start": "2326260",
    "end": "2332260"
  },
  {
    "text": "istio on a kubernetes cluster and we've got a standard JWT validation plugin and",
    "start": "2332260",
    "end": "2337599"
  },
  {
    "text": "it's refusing to validate these tokens and the more you dig around you realize that well hold on the audience isn't you",
    "start": "2337599",
    "end": "2344320"
  },
  {
    "text": "and it just turns out that graph actually signed the token and then changed something inside the token",
    "start": "2344320",
    "end": "2349660"
  },
  {
    "text": "afterwards so the signature could never be validated against that token but that's their business it's the token for",
    "start": "2349660",
    "end": "2355780"
  },
  {
    "text": "them they deal with that so if the audience isn't you not really supposed to use it",
    "start": "2355780",
    "end": "2362079"
  },
  {
    "text": "we can see you issued the token which in this case is just aad there's a bunch of Unix timestamps issued at not before and",
    "start": "2362079",
    "end": "2369579"
  },
  {
    "text": "expires at but the really interesting bit for us because it's an authentication flow is we get told it's",
    "start": "2369579",
    "end": "2376180"
  },
  {
    "text": "Center and in this case we get told a census email address the only other thing I'll call out",
    "start": "2376180",
    "end": "2382000"
  },
  {
    "text": "because this does get people sometimes is this version down the bottom 2.0 so Azure active directory has two versions",
    "start": "2382000",
    "end": "2388900"
  },
  {
    "text": "of its endpoints one and two if you use adal you call the version one endpoint",
    "start": "2388900",
    "end": "2393940"
  },
  {
    "text": "if you use M cell you call V2 if you're doing an authentication flow",
    "start": "2393940",
    "end": "2400540"
  },
  {
    "text": "then you will get back a version of the token that corresponds to the version of the endpoint that you use",
    "start": "2400540",
    "end": "2406660"
  },
  {
    "text": "now the reason for that is authentication flows the audience is you so it's your code that will be using",
    "start": "2406660",
    "end": "2413920"
  },
  {
    "text": "that token so if you call V1 it's a fair assumption that you want a V1 token back",
    "start": "2413920",
    "end": "2419380"
  },
  {
    "text": "if you call V2 it's a fair assumption you want a V2 token back when you call a downstream API you could",
    "start": "2419380",
    "end": "2427119"
  },
  {
    "text": "call the V1 endpoint but if that Downstream API is shown a preference for v2 tokens you'll get a V2 token back",
    "start": "2427119",
    "end": "2434200"
  },
  {
    "text": "from the V1 endpoint so it's all a bit kind of weird the tokens themselves not",
    "start": "2434200",
    "end": "2439240"
  },
  {
    "text": "much different the V1 tokens are a bit smaller than the a bit bigger than the V2 tokens But ultimately that's if",
    "start": "2439240",
    "end": "2446320"
  },
  {
    "text": "you're seeing a version thinking but I'm calling the V1 endpoint I'm getting a V2 token back I don't understand it that's what's going on behind the scenes",
    "start": "2446320",
    "end": "2453940"
  },
  {
    "text": "so that's an authentication flow so that's half of the equation so let's go",
    "start": "2453940",
    "end": "2459400"
  },
  {
    "text": "back to the application and see what happens next so we're going to click this button to add gram to The Naughty",
    "start": "2459400",
    "end": "2465579"
  },
  {
    "text": "Nice List and this is where my Spar is now going to try and call a downstream one of these new digital transformation",
    "start": "2465579",
    "end": "2472240"
  },
  {
    "text": "apis which is living on the Heritage asp.net application",
    "start": "2472240",
    "end": "2477300"
  },
  {
    "text": "so uh I've told Aid to always prompt for credentials and always for signing just",
    "start": "2477300",
    "end": "2483220"
  },
  {
    "text": "because it makes the demonstration kind of a bit more predictable for me otherwise you never know if things are",
    "start": "2483220",
    "end": "2488440"
  },
  {
    "text": "cached and like stuff just happens so we get another of these permissions",
    "start": "2488440",
    "end": "2493720"
  },
  {
    "text": "requested uh things pop up so we can see that Santa Lite has now asked to change",
    "start": "2493720",
    "end": "2500560"
  },
  {
    "text": "the naughty nice list but the important thing here is in Brackets Santa web",
    "start": "2500560",
    "end": "2505960"
  },
  {
    "text": "so this is another scope it's another thing to put in front of the user but",
    "start": "2505960",
    "end": "2511119"
  },
  {
    "text": "unlike the original off authentication flow this is now asking for my consent",
    "start": "2511119",
    "end": "2516280"
  },
  {
    "text": "to call something on a different API a downstream API so what I want to do is I'm going to",
    "start": "2516280",
    "end": "2523000"
  },
  {
    "text": "cancel this and we're going to quickly go into the portal to have a look at the",
    "start": "2523000",
    "end": "2529000"
  },
  {
    "text": "other application which in this case is called Sansa web so I just want to make sure",
    "start": "2529000",
    "end": "2536980"
  },
  {
    "text": "we get the right one because for some reason I saw there were actually two Santa Webbs some that went sure what",
    "start": "2536980",
    "end": "2543940"
  },
  {
    "text": "went wrong with my uh demo there here we go around applications Santa web that should do me",
    "start": "2543940",
    "end": "2550900"
  },
  {
    "text": "so I talked about Scopes and I talked about aad having different terminology for",
    "start": "2550900",
    "end": "2556180"
  },
  {
    "text": "everything and this is another one of those so we don't have a menu bar for Scopes instead we have expose an API and",
    "start": "2556180",
    "end": "2564520"
  },
  {
    "text": "again over time you can see the word scope has started to appear inside here so we're starting to adopt the",
    "start": "2564520",
    "end": "2571660"
  },
  {
    "text": "terminology of open ID connect but I've got three Scopes declared on",
    "start": "2571660",
    "end": "2576700"
  },
  {
    "text": "Santa web basically two to manage the Naughty Nice List want to read it want to write it add another to write the",
    "start": "2576700",
    "end": "2582819"
  },
  {
    "text": "present delivery about now the important thing about Scopes in aad they're just text labels they don't",
    "start": "2582819",
    "end": "2590079"
  },
  {
    "text": "necessarily have any bearing or connection to the actual API endpoints that you're going to call and this is",
    "start": "2590079",
    "end": "2596619"
  },
  {
    "text": "quite important because sometimes you see applications they've got hundreds of Scopes okay so why have you got hundred",
    "start": "2596619",
    "end": "2602560"
  },
  {
    "text": "Scopes well we've got hundreds of API endpoints but you put that in front of a user right can you delegate consent to",
    "start": "2602560",
    "end": "2610300"
  },
  {
    "text": "100 Scopes we know what they're going to do it's like if you get a big pull request right if you get a pull request",
    "start": "2610300",
    "end": "2615640"
  },
  {
    "text": "of three thousand lines you're going to spend less time reviewing that pull request than if you get a pull request of 20 lines",
    "start": "2615640",
    "end": "2622540"
  },
  {
    "text": "or is that this I don't know is that for me all right all right cool cool see you for a minute I thought people was no no",
    "start": "2622540",
    "end": "2628960"
  },
  {
    "text": "we spend hours on that it's too much to take in right and if you overload your brain with that how",
    "start": "2628960",
    "end": "2635380"
  },
  {
    "text": "can you look for a hundred Scopes and sure sure so instead think about what",
    "start": "2635380",
    "end": "2640480"
  },
  {
    "text": "makes sense to your end user just labels so in my case these particular Scopes May map to like 20 or 30 Downstream API",
    "start": "2640480",
    "end": "2648099"
  },
  {
    "text": "endpoints doesn't matter at the end of the day it's all about something that makes sense to your end users",
    "start": "2648099",
    "end": "2653619"
  },
  {
    "text": "I said Scopes are nothing more than labels inside of aad that can be",
    "start": "2653619",
    "end": "2658839"
  },
  {
    "text": "contrasted to some other identity providers so identity server do ende for",
    "start": "2658839",
    "end": "2664060"
  },
  {
    "text": "example you can put R back across Scopes so you can actually say that these users can see these Scopes but in Ard that's",
    "start": "2664060",
    "end": "2672040"
  },
  {
    "text": "not a thing if there's a scope against an API anybody is allowed to consent to",
    "start": "2672040",
    "end": "2677200"
  },
  {
    "text": "that scope which has got some interesting ramifications as we will see so what we're going to do is quickly flick to",
    "start": "2677200",
    "end": "2684099"
  },
  {
    "text": "the JavaScript code ah one other thing as well um all these Scopes you'll see are prefix by API Colon Center web now again",
    "start": "2684099",
    "end": "2692200"
  },
  {
    "text": "because aad is a a global identity system it's possible that there's another application that has got the",
    "start": "2692200",
    "end": "2698680"
  },
  {
    "text": "same name Scopes as you so we name space them and we do that by providing this",
    "start": "2698680",
    "end": "2704020"
  },
  {
    "text": "thing that's called a application ID URI so in my case it's API Santa web it has",
    "start": "2704020",
    "end": "2710859"
  },
  {
    "text": "to be globally unique across Azure active directory and it just allows us to uniquely reference the scope",
    "start": "2710859",
    "end": "2717760"
  },
  {
    "text": "so if we go to m cell now what we will see inside vs code is that the",
    "start": "2717760",
    "end": "2724900"
  },
  {
    "text": "application makes a call to acquire a token says this is the scope I want",
    "start": "2724900",
    "end": "2730300"
  },
  {
    "text": "when we do the sign in flow and we'll call that close that one",
    "start": "2730300",
    "end": "2735460"
  },
  {
    "text": "and back to here add grab the naughty nice list",
    "start": "2735460",
    "end": "2740220"
  },
  {
    "text": "sign in upset that and if all goes well",
    "start": "2742359",
    "end": "2751078"
  },
  {
    "text": "we sign in and we're going to try and call the downstream API but we get 401",
    "start": "2752800",
    "end": "2758560"
  },
  {
    "text": "and authorized so I'm going to take you to my next common problem that I find in Azure active directory so we'll quickly",
    "start": "2758560",
    "end": "2764260"
  },
  {
    "text": "grab this token and have a look inside it uh here we go and we'll use jwt.ms again for this",
    "start": "2764260",
    "end": "2772980"
  },
  {
    "text": "so it's pretty similar to the identity token uh the main things to call out the",
    "start": "2775359",
    "end": "2781119"
  },
  {
    "text": "audience at the top here is now changed to API Santa web and inside here we have",
    "start": "2781119",
    "end": "2786339"
  },
  {
    "text": "another claim which is the scope so those are the Scopes that I've consented to little interesting facts as well",
    "start": "2786339",
    "end": "2792700"
  },
  {
    "text": "because when we request Scopes we have to fully prefix them with the apis ID",
    "start": "2792700",
    "end": "2798839"
  },
  {
    "text": "what you'll find is if you try to ask for Scopes from multiple apis you'll get an error because the tokens that get",
    "start": "2798839",
    "end": "2805359"
  },
  {
    "text": "issued can only have a single audience inside it so it makes no sense to ask for a JWT which has got Scopes from",
    "start": "2805359",
    "end": "2811839"
  },
  {
    "text": "different apis okay so the Scopes have to be with inside the same application",
    "start": "2811839",
    "end": "2817960"
  },
  {
    "text": "so everything looks good on the token but we've got the authorization issues so let's go to the actual API behind the",
    "start": "2817960",
    "end": "2825819"
  },
  {
    "text": "scenes and see if we can find out what's gone wrong here and we can see there's been a 401 this well rad is holding up",
    "start": "2825819",
    "end": "2831880"
  },
  {
    "text": "that's good isn't it and we've got an error message in here so this is where the logs of the API can be really useful",
    "start": "2831880",
    "end": "2837579"
  },
  {
    "text": "we get told that the audience API sansaweb did not match API colon and",
    "start": "2837579",
    "end": "2843819"
  },
  {
    "text": "then something that looks like the grid the actual client ID of the API",
    "start": "2843819",
    "end": "2851680"
  },
  {
    "text": "when I requested that token I was very very explicit I want a audience of API Santa web",
    "start": "2851680",
    "end": "2857800"
  },
  {
    "text": "but when we configure the nuget package that deals with this insider.net application",
    "start": "2857800",
    "end": "2864220"
  },
  {
    "text": "by default we don't have to tell it about our custom api's ID",
    "start": "2864220",
    "end": "2869800"
  },
  {
    "text": "if we don't tell it it makes an assumption that that audience is going to be set to API colon slash and then",
    "start": "2869800",
    "end": "2877180"
  },
  {
    "text": "the grid of the actual client application so this is one of those where the reason",
    "start": "2877180",
    "end": "2882880"
  },
  {
    "text": "that's done by the way is if you don't explicitly ask for your own app ID if",
    "start": "2882880",
    "end": "2887920"
  },
  {
    "text": "you just ask us to create one that's what we create API columns and then the ID",
    "start": "2887920",
    "end": "2893200"
  },
  {
    "text": "so this is a really simple fix I need to actually configure my application down here to have the Right audience",
    "start": "2893200",
    "end": "2900460"
  },
  {
    "text": "and when we do that so this should be API colon slash that this is where uh",
    "start": "2900460",
    "end": "2905560"
  },
  {
    "text": "GitHub co-pilot is it's coming up with Shirley I can help you out here Graham it's like no I don't",
    "start": "2905560",
    "end": "2912160"
  },
  {
    "text": "need your suggestions so we can stop that and restart it",
    "start": "2912160",
    "end": "2918359"
  },
  {
    "text": "oh okie dokie and if all goes well now we'll go back to add to the naughty nice list",
    "start": "2923140",
    "end": "2930420"
  },
  {
    "text": "I'm doing very well with the internet I feel like that's going to go wrong at some point as well but so far so good",
    "start": "2934240",
    "end": "2941640"
  },
  {
    "text": "so this time hopefully with the API configured correctly with the Right audience we've now added grams to The",
    "start": "2943240",
    "end": "2949480"
  },
  {
    "text": "Naughty Nice List so that's worked so there's one more scenario I'm going to walk you through I'm going to sign",
    "start": "2949480",
    "end": "2955300"
  },
  {
    "text": "out this time you see we've got another elf that uh Works inside the elf",
    "start": "2955300",
    "end": "2960940"
  },
  {
    "text": "designers team it's a little bit cheeky it's called Alabaster and he spotted something on the user interface that he",
    "start": "2960940",
    "end": "2967480"
  },
  {
    "text": "thinks he can exploit so let's log in as Alabaster and see what's going on",
    "start": "2967480",
    "end": "2974460"
  },
  {
    "text": "okay we already have the password that's good so we did a standard signing flow",
    "start": "2975220",
    "end": "2980619"
  },
  {
    "text": "nothing's different here but you see whenever they built the UI they didn't really look at the tokens to work out if",
    "start": "2980619",
    "end": "2986680"
  },
  {
    "text": "people were supposed to call various bits of functionality so Alabaster spotted that he had this button ad",
    "start": "2986680",
    "end": "2992440"
  },
  {
    "text": "granted a naughty nice list and he clicked it and as we mentioned earlier",
    "start": "2992440",
    "end": "2999160"
  },
  {
    "text": "because we don't assign R back against Scopes inside of aad alabaster can be",
    "start": "2999160",
    "end": "3004260"
  },
  {
    "text": "asked to consent to this scope so Alabaster is the junior elf he's got no business updating the naughty nice",
    "start": "3004260",
    "end": "3010200"
  },
  {
    "text": "list yet here we are he's being assypial consent to that and he can do he can click accepts",
    "start": "3010200",
    "end": "3018560"
  },
  {
    "text": "and Azure active directory is happy with all of this it's going to issue a token to Alabaster that says yes he's",
    "start": "3020520",
    "end": "3026819"
  },
  {
    "text": "consented to add to the naughty nice list okay so this is one of the really big",
    "start": "3026819",
    "end": "3032040"
  },
  {
    "text": "takeaways in open ID connect and Olaf too um a scope is not the same as somebody",
    "start": "3032040",
    "end": "3038220"
  },
  {
    "text": "having permission to do something just because a scope exists on a token doesn't mean that person is actually",
    "start": "3038220",
    "end": "3045720"
  },
  {
    "text": "able to do that thing inside your organization right so you've got to break apart those",
    "start": "3045720",
    "end": "3051540"
  },
  {
    "text": "two concepts all a scope is is that someone has said yeah sure you have my",
    "start": "3051540",
    "end": "3057780"
  },
  {
    "text": "consent to go and press the nuclear launch button right that doesn't necessarily mean that the application",
    "start": "3057780",
    "end": "3064440"
  },
  {
    "text": "will just blindly honor that request so this is where we start to get into the question of well if that's not the scope",
    "start": "3064440",
    "end": "3071339"
  },
  {
    "text": "where does that authorization actually come from so there's three kind of main things",
    "start": "3071339",
    "end": "3077520"
  },
  {
    "text": "that I see going in kind of order of probably the worst to maybe I don't know",
    "start": "3077520",
    "end": "3083579"
  },
  {
    "text": "if there's a best in this one actually it's going from the worst to going so that it depends so the first is our old",
    "start": "3083579",
    "end": "3089040"
  },
  {
    "text": "favor active directory groups because who doesn't love putting in tickets to the ad Enterprise team to ask for very",
    "start": "3089040",
    "end": "3096359"
  },
  {
    "text": "specific application roles to be registered in ad right and we've seen",
    "start": "3096359",
    "end": "3101520"
  },
  {
    "text": "them pile up over the years you might get a token back in ad and it might have a thousand groups on there and there",
    "start": "3101520",
    "end": "3107700"
  },
  {
    "text": "might be for applications that no longer exist inside your organization but there's no connection between kind of",
    "start": "3107700",
    "end": "3113220"
  },
  {
    "text": "the cleanup tasks of this and and uh getting all of that sorted out",
    "start": "3113220",
    "end": "3118440"
  },
  {
    "text": "so you can use ad groups right but I find they're better for organizational concerns so think about things like",
    "start": "3118440",
    "end": "3125400"
  },
  {
    "text": "roles of people I'm a manager or I'm a technician but the moment you start to put",
    "start": "3125400",
    "end": "3131579"
  },
  {
    "text": "application concerns in there then things start to get a bit complicated in my opinion",
    "start": "3131579",
    "end": "3137760"
  },
  {
    "text": "um there's another complexity with Azure active directory and tokens because let's say you're in a thousand groups",
    "start": "3137760",
    "end": "3144359"
  },
  {
    "text": "which of those groups do we Express in the JWT because they have a finite size so they only pick a certain number of",
    "start": "3144359",
    "end": "3151920"
  },
  {
    "text": "them so you might find that the group that you're looking for doesn't even exist in the token and now you have to",
    "start": "3151920",
    "end": "3157800"
  },
  {
    "text": "make more calls out to the graph API to find out if you're really in that group or not",
    "start": "3157800",
    "end": "3163380"
  },
  {
    "text": "so you can do it but I would say probably avoid that if you can so it just happens that we have another",
    "start": "3163380",
    "end": "3169980"
  },
  {
    "text": "Concept in aad which is called a role and a role is actually a really really cool thing well it was it was the best",
    "start": "3169980",
    "end": "3176880"
  },
  {
    "text": "thing until about uh a few weeks ago and my friend shattered my dreams and Illusions by telling me something about",
    "start": "3176880",
    "end": "3182819"
  },
  {
    "text": "them but the idea of a role is think of a group that is local to your",
    "start": "3182819",
    "end": "3187920"
  },
  {
    "text": "application so we can create roles and again they're just really labels at the end of the day",
    "start": "3187920",
    "end": "3194280"
  },
  {
    "text": "so I've got two on here Santa World employees Santa World senior employee and then we can assign users against",
    "start": "3194280",
    "end": "3200040"
  },
  {
    "text": "them and you'll only see these roles in a JWT where the audience is your",
    "start": "3200040",
    "end": "3205680"
  },
  {
    "text": "application you won't see them anywhere else so pretty cool so how do we go and assign these things this is the next",
    "start": "3205680",
    "end": "3212160"
  },
  {
    "text": "great thing about Azure active directory we don't do it in the application we do it inside the Enterprise application",
    "start": "3212160",
    "end": "3219480"
  },
  {
    "text": "yeah gotta have an Enterprise application to go over your application otherwise known as a service principle",
    "start": "3219480",
    "end": "3224579"
  },
  {
    "text": "otherwise known as a managed application otherwise they're like what is this thing so",
    "start": "3224579",
    "end": "3230880"
  },
  {
    "text": "I think the reason these things exist is because we have a concept of a multi-tenant application inside of aad",
    "start": "3230880",
    "end": "3237839"
  },
  {
    "text": "so what that means is that I can describe my application in my tenant but",
    "start": "3237839",
    "end": "3243000"
  },
  {
    "text": "you can actually realize an instance of this that you can interact with in your own tenant so if I'm a SAS provider",
    "start": "3243000",
    "end": "3249960"
  },
  {
    "text": "that's pretty cool I say here's my SAS solution and you can say great well I'm going to start assigning my own users in",
    "start": "3249960",
    "end": "3256559"
  },
  {
    "text": "my own tenant to use your application I've got my own conditional access policies I've got my own MFA another",
    "start": "3256559",
    "end": "3263579"
  },
  {
    "text": "customer can do that differently and another one can do that differently because we all have our own if you like",
    "start": "3263579",
    "end": "3269339"
  },
  {
    "text": "instance of that application inside our directories and that's where we assign",
    "start": "3269339",
    "end": "3275480"
  },
  {
    "text": "the uh roles so we're now going into if you like I guess you go from almost the",
    "start": "3275480",
    "end": "3281520"
  },
  {
    "text": "control plane if you think in terms of cloud infrastructure you've got the control plane which is the application",
    "start": "3281520",
    "end": "3286740"
  },
  {
    "text": "and you've got the runtime plane which is the service principle and oh we're running short on time",
    "start": "3286740",
    "end": "3294839"
  },
  {
    "text": "I'm blaming that glitch of the technology inside the Enterprise application we can add users and groups",
    "start": "3294839",
    "end": "3301500"
  },
  {
    "text": "to this so in my scenario I'm just going to go and add a user so we'll add Center",
    "start": "3301500",
    "end": "3308960"
  },
  {
    "text": "and select that and then we'll select him on one of those roles that we saw in this",
    "start": "3309020",
    "end": "3314640"
  },
  {
    "text": "case Center Senior employee so when we do that what we see now when",
    "start": "3314640",
    "end": "3322020"
  },
  {
    "text": "we run a sign-in flow and let's just log out Alabaster our log sensory and we'll take a peek",
    "start": "3322020",
    "end": "3328380"
  },
  {
    "text": "into the JWT let's go Center",
    "start": "3328380",
    "end": "3335960"
  },
  {
    "text": "ads Naughty Nice List so many clicks to do",
    "start": "3339240",
    "end": "3345020"
  },
  {
    "text": "click the click accepts I did this once and because aad is eventually consistent the claims it just",
    "start": "3346020",
    "end": "3352500"
  },
  {
    "text": "did not appear inside the token at all it's like no the demo God's got me again",
    "start": "3352500",
    "end": "3359540"
  },
  {
    "text": "so hopefully what we'll see now is inside that token there's a new claim which has appeared which is the roles",
    "start": "3360839",
    "end": "3366480"
  },
  {
    "text": "that Santa's in so we can use that now inside our application I'm probably not going to have time to do that bit but on",
    "start": "3366480",
    "end": "3373319"
  },
  {
    "text": "the controller the action inside of the.net application I can use a standard authorize attribute to request that role",
    "start": "3373319",
    "end": "3380760"
  },
  {
    "text": "of senior employee now Alabaster won't get that which means that he won't be able to call that API",
    "start": "3380760",
    "end": "3386940"
  },
  {
    "text": "so roles were brilliant absolutely brilliant until my friend pointed out a few weeks ago to me that roles don't",
    "start": "3386940",
    "end": "3393960"
  },
  {
    "text": "work with nested groups so if you have a hierarchy let's say you've got uh all",
    "start": "3393960",
    "end": "3399720"
  },
  {
    "text": "senior employees and then you've got developer senior employees so you put that all senior employees",
    "start": "3399720",
    "end": "3405859"
  },
  {
    "text": "saying as a role inside your uh token but someone's in two levels down as a",
    "start": "3405859",
    "end": "3412260"
  },
  {
    "text": "user they won't actually see that role in their token so I just was very sad and I have not got a great answer kind",
    "start": "3412260",
    "end": "3421800"
  },
  {
    "text": "of on the back of that unfortunately other than like keep your aad hierarchies flat if you want to use",
    "start": "3421800",
    "end": "3427079"
  },
  {
    "text": "roles which is not brilliant but I think it starts to sort of paint this picture of you know you've got this ad groups",
    "start": "3427079",
    "end": "3433559"
  },
  {
    "text": "that are very high level organizational things you've got your roles inside your tokens which start to make more sense to",
    "start": "3433559",
    "end": "3439920"
  },
  {
    "text": "your applications but again they're not super fine-grained permissions you wouldn't have roles for",
    "start": "3439920",
    "end": "3445859"
  },
  {
    "text": "every permission inside your app so you wouldn't have one if you're a bank teller saying here's a role for people",
    "start": "3445859",
    "end": "3450900"
  },
  {
    "text": "that can give out less than 500 here's a role for people that can give out more than a thousand dollars because you're",
    "start": "3450900",
    "end": "3456720"
  },
  {
    "text": "starting to bury your very specific application rules inside the identity provider and again I think keeping that",
    "start": "3456720",
    "end": "3463740"
  },
  {
    "text": "distinction is really good so roles great for Concepts that make sense to your application but when it comes to",
    "start": "3463740",
    "end": "3470400"
  },
  {
    "text": "the real fine grain business Logic for me that's the sort of stuff that starts to live inside your code or at least is",
    "start": "3470400",
    "end": "3476880"
  },
  {
    "text": "a decision that you explicitly make in your code just before you do the operation so you might for example call",
    "start": "3476880",
    "end": "3483480"
  },
  {
    "text": "out to some policy server and say well here's all my signals here's the roles here's the user here's what they're",
    "start": "3483480",
    "end": "3489300"
  },
  {
    "text": "trying to do and then have some external rules engine like a policy server make a decision and say yeah go for it or not",
    "start": "3489300",
    "end": "3496440"
  },
  {
    "text": "don't go for it and I think that's the best I've come up with so far the more complicated the more centrally managed",
    "start": "3496440",
    "end": "3501900"
  },
  {
    "text": "you want that business rule logic to be then the more it starts to make sense to",
    "start": "3501900",
    "end": "3507119"
  },
  {
    "text": "think about policy but the simpler your apis are then the more that makes sense I think inside your code where it's just",
    "start": "3507119",
    "end": "3513839"
  },
  {
    "text": "owned by the team and can be tested in his local etc etc so that is basically the end of my talk",
    "start": "3513839",
    "end": "3523160"
  },
  {
    "text": "we've seen jbj with c's we've looked at pkce or IDC we've looked at aad groups",
    "start": "3523160",
    "end": "3529020"
  },
  {
    "text": "roles Scopes not being permissions etc etc and we had some fun with technology",
    "start": "3529020",
    "end": "3534660"
  },
  {
    "text": "on the way as well so thank you so much for coming today I'm not sure if you have time for questions but thank you",
    "start": "3534660",
    "end": "3543260"
  },
  {
    "text": "foreign",
    "start": "3543960",
    "end": "3546799"
  }
]