[
  {
    "text": "all right let's go so thank you everyone for coming well done on being the people",
    "start": "11400",
    "end": "16600"
  },
  {
    "text": "that made it out of bed at 9:00 a.m. after the party last night um it's quite an impressive turnout actually it's a",
    "start": "16600",
    "end": "22439"
  },
  {
    "text": "bit worried when you look at your 9:00 a.m. slot after the party the night before so my name is Scott and today I'm",
    "start": "22439",
    "end": "28400"
  },
  {
    "text": "going to be talking about uh a kind of an incident that I was involved in with investigating and helping on the",
    "start": "28400",
    "end": "35040"
  },
  {
    "text": "remediation for one of the largest cryptojacking attacks that we've ever seen so far at least that's public so",
    "start": "35040",
    "end": "41520"
  },
  {
    "text": "I'll explain what cryptojacking is if you're not familiar with the term as we go but this is the unfortunate story of",
    "start": "41520",
    "end": "47079"
  },
  {
    "text": "how thousands and thousands of government websites all around the world were infected with malware and like many",
    "start": "47079",
    "end": "54079"
  },
  {
    "text": "many good stories and it starts with we found something by accident we weren't out looking for this you know this",
    "start": "54079",
    "end": "60480"
  },
  {
    "text": "wasn't the intention but it was a Sunday morning I was in the UK and I get a DM",
    "start": "60480",
    "end": "65920"
  },
  {
    "text": "from one of my good friends called IEM now he messages me and he's like hey",
    "start": "65920",
    "end": "70960"
  },
  {
    "text": "Scott have you got a second and he sends me this screenshot now this is a screenshot of",
    "start": "70960",
    "end": "76240"
  },
  {
    "text": "the Ico website in the UK so they're the information commissioner's office which is part of the UK government that deals",
    "start": "76240",
    "end": "83520"
  },
  {
    "text": "with our data protection laws and things like gdpr so official government Department official government website",
    "start": "83520",
    "end": "88759"
  },
  {
    "text": "and as you can see in the top right right there's a little kind of red warning from his antivirus program so he",
    "start": "88759",
    "end": "94960"
  },
  {
    "text": "goes to the government website and then his antivirus program is like woo woo something is wrong so he takes a screenshot he sends it to me and he's",
    "start": "94960",
    "end": "100799"
  },
  {
    "text": "like is there any chance you could take a look at this website my my antivirus is saying there's malware on the page so",
    "start": "100799",
    "end": "106920"
  },
  {
    "text": "I took a quick look at this and I was like golly gosh there is there is a problem here like this is really bad if",
    "start": "106920",
    "end": "112640"
  },
  {
    "text": "your antivirus program is firing on a government website so I take a look at",
    "start": "112640",
    "end": "118600"
  },
  {
    "text": "it of course and I'm thinking right I can see from the error if we zoom in a little bit on that for you you can see",
    "start": "118600",
    "end": "124200"
  },
  {
    "text": "that the antivirus program is unhappy about a JavaScript infection it says right there in the top right and you can",
    "start": "124200",
    "end": "130239"
  },
  {
    "text": "see you know I'm checking like is he definitely on the official you know Government website he's not been lured",
    "start": "130239",
    "end": "135720"
  },
  {
    "text": "into some kind of lookalike fake website and it's like no he's definitely on the government website he's such a cool",
    "start": "135720",
    "end": "141640"
  },
  {
    "text": "person that on a Sunday morning he was reading about the guide to gdpr um I have different questions for Ian after",
    "start": "141640",
    "end": "147959"
  },
  {
    "text": "we had this discussion um but he was you know he was doing his work he was reading up on gdpr on a",
    "start": "147959",
    "end": "154599"
  },
  {
    "text": "Sunday morning and I was like y that is definitely you know real that looks that",
    "start": "154599",
    "end": "159720"
  },
  {
    "text": "looks like something we should investigate so I started digging into it and of course it's saying there's a JavaScript infection on the page the",
    "start": "159720",
    "end": "166599"
  },
  {
    "text": "first thing that I want to do is is look if I can actually see the indications of the JavaScript and as soon as I load the",
    "start": "166599",
    "end": "171760"
  },
  {
    "text": "page I can see the requests in the network tab I can see the appropriate errors in the console and I was like",
    "start": "171760",
    "end": "177159"
  },
  {
    "text": "yeah this there is definitely something suspicious going on on this page and I was like they",
    "start": "177159",
    "end": "182319"
  },
  {
    "text": "actually have coinhive on their homepage so coin hiive for those unfamiliar",
    "start": "182319",
    "end": "189159"
  },
  {
    "text": "became very very popular it really kind of started around 10 years ago so",
    "start": "189159",
    "end": "194920"
  },
  {
    "text": "coinhive it was a you know legitimate proposition at the time and I am air",
    "start": "194920",
    "end": "200400"
  },
  {
    "text": "quoting legitimate there so coinhive the whole idea was people don't like ads and",
    "start": "200400",
    "end": "206080"
  },
  {
    "text": "tracking on websites but website operators like to have ads cuz it generates Revenue so it's like you know",
    "start": "206080",
    "end": "212519"
  },
  {
    "text": "some people call it the necessary evil I don't really like ads you know they slow performance they're bad for privacy there's a whole bunch of issues and kive",
    "start": "212519",
    "end": "219080"
  },
  {
    "text": "like we have a solution now you can mine cryptocurrency in",
    "start": "219080",
    "end": "225480"
  },
  {
    "text": "JavaScript obviously it's not very effective for those of you that have done any crypto mining you'll know that mining in the CPU is terrible um mining",
    "start": "225480",
    "end": "232840"
  },
  {
    "text": "in JavaScript is even worse but the idea was you could take the coinhive library and you could drop it on your website",
    "start": "232840",
    "end": "240079"
  },
  {
    "text": "and then when somebody went to your website you would borrow some of their CPU Cycles to mine a little bit of",
    "start": "240079",
    "end": "246879"
  },
  {
    "text": "Monero and then that would be sent to you so their proposition was like instead of having ads and all this",
    "start": "246879",
    "end": "253079"
  },
  {
    "text": "privacy invasive stuff and these visual things that people don't like you can just kind of like borrow some CPU Cycles",
    "start": "253079",
    "end": "258680"
  },
  {
    "text": "from your visitor and while they're reading your news article or your blog post you're mining a little bit of",
    "start": "258680",
    "end": "264240"
  },
  {
    "text": "cryptocurrency and that's how we're now covering the financial component and",
    "start": "264240",
    "end": "270320"
  },
  {
    "text": "I had like a whole bunch of issues with that approach um just like on a fundamental basis but the problem was",
    "start": "270320",
    "end": "279600"
  },
  {
    "text": "even if you can look at that and view that as legitimate what some illegitimate people realized was you know if we can install the coinhive",
    "start": "279600",
    "end": "286120"
  },
  {
    "text": "library on somebody else's website then all of their visitors will mind cryptocurrency for us right so now it's",
    "start": "286120",
    "end": "293280"
  },
  {
    "text": "like oo you know I'm just I put the coinhive library on my website I get like you know 100 visitors a month or something but if I could put the library",
    "start": "293280",
    "end": "299199"
  },
  {
    "text": "on someone really popular website with millions of visitors per month those millions of people would mind the cryptocurrency and send it to me and",
    "start": "299199",
    "end": "305880"
  },
  {
    "text": "this is what became known as cryptojacking trying to find a way to infect these other websites with this",
    "start": "305880",
    "end": "311280"
  },
  {
    "text": "JavaScript that would mind cryptocurrency but send it to you so when I see you know the government",
    "start": "311280",
    "end": "317759"
  },
  {
    "text": "website is running the coinhive library on their homepage I was like well I know you know",
    "start": "317759",
    "end": "324840"
  },
  {
    "text": "government budgets are pretty tight and they don't have a lot of money but this is probably not the thing they're going",
    "start": "324840",
    "end": "330160"
  },
  {
    "text": "for they probably not sat down and thought let's see if we can mine some cryptocurrency I was like this is probably an infection they probably had",
    "start": "330160",
    "end": "337360"
  },
  {
    "text": "this deployed on their website against their will so I was like yep like I'm seeing that too that's what my antivirus",
    "start": "337360",
    "end": "344039"
  },
  {
    "text": "program is saying you know we have a JavaScript malware infection and he was like so what do we do like now what you",
    "start": "344039",
    "end": "351440"
  },
  {
    "text": "know you go to the government website and you find this this infection and it's like so what do we do now I'm sure",
    "start": "351440",
    "end": "358639"
  },
  {
    "text": "many people here are familiar with responsible disclosure this idea where you reach out to an organization when",
    "start": "358639",
    "end": "364240"
  },
  {
    "text": "you find that they have a problem and you tell them about it in the hope that they'll fix it and not you know send you to prison or something so I thought",
    "start": "364240",
    "end": "372240"
  },
  {
    "text": "about it and I was like well it's Sunday so the government's closed so I'm probably not going to be able to get in touch with them and also it's not the",
    "start": "372240",
    "end": "378680"
  },
  {
    "text": "kind of vulnerability where if we disclose it now it's going to cause like any more harm a lot of vulnerabilities",
    "start": "378680",
    "end": "385039"
  },
  {
    "text": "you know you want to have responsible disclosure so you tell the company privately because you don't want all the information to become public immediately",
    "start": "385039",
    "end": "391240"
  },
  {
    "text": "because then other people might exploit it but given what we'd seen I was like well we need to bring some attention to",
    "start": "391240",
    "end": "398080"
  },
  {
    "text": "this quickly it's going to be virtually impossible to you know phone the government and be like hey you have an",
    "start": "398080",
    "end": "403199"
  },
  {
    "text": "infection on your website so we decided to announce it more publicly I'm quite",
    "start": "403199",
    "end": "408759"
  },
  {
    "text": "lucky to have some connections in press and I was like look maybe I can contact some journalists and maybe they can",
    "start": "408759",
    "end": "413800"
  },
  {
    "text": "start trying to figure out like who do we need to call at the government to fix this so we decided to send the Tweet out",
    "start": "413800",
    "end": "419360"
  },
  {
    "text": "which which is not our kind of usual process because normally this would have been a responsible disclosure done",
    "start": "419360",
    "end": "424960"
  },
  {
    "text": "privately but I thought look we just need some quick attention on this other people knowing about it it's not going",
    "start": "424960",
    "end": "430759"
  },
  {
    "text": "to make it worse but it needs to be taken down as fast as possible so I did all of this investigation kind of live",
    "start": "430759",
    "end": "437879"
  },
  {
    "text": "from the original point of the Tweet so after seeing that the library the coinhive library was on the page I",
    "start": "437879",
    "end": "443759"
  },
  {
    "text": "wanted to know how did it get on the page right because there's obviously a script tag somewhere on this page and",
    "start": "443759",
    "end": "449639"
  },
  {
    "text": "the question then becomes how did it get there so I wanted to see first of all if everybody else saw what I saw and",
    "start": "449639",
    "end": "455840"
  },
  {
    "text": "there's lots of different tools online like performance analysis tools where they'll go and load your page and tell you which dependencies are slowing you",
    "start": "455840",
    "end": "461720"
  },
  {
    "text": "down and I was like I'll just use a couple of these tools from different locations and see if everybody sees the",
    "start": "461720",
    "end": "466759"
  },
  {
    "text": "same thing that I do like is everybody seeing the script tag on the page it's not like GEOS sensitive or there's not",
    "start": "466759",
    "end": "472800"
  },
  {
    "text": "some other weirdness and every single tool that I use I do the analysis I scan the page and there you can see this like",
    "start": "472800",
    "end": "478599"
  },
  {
    "text": "huge big Java script Library being pulled in and I was like so everybody is seeing what I'm seeing like it is",
    "start": "478599",
    "end": "484039"
  },
  {
    "text": "definitely a persistent infection in the page so I keep digging through the",
    "start": "484039",
    "end": "490720"
  },
  {
    "text": "resources because then I'm like well how did it get in the page right I we all agree everybody's seeing the script tag in the page well how did it get there",
    "start": "490720",
    "end": "497360"
  },
  {
    "text": "and it turns out it wasn't actually a compromise in the government's website in that application it was a compromise",
    "start": "497360",
    "end": "503960"
  },
  {
    "text": "in one of their third party dependencies so I was tracing back like where did the script tag get added in",
    "start": "503960",
    "end": "509960"
  },
  {
    "text": "and I found the the final kind of you know piece of the puzzle was the actual injection point it was a third party",
    "start": "509960",
    "end": "516039"
  },
  {
    "text": "dependency of the governments now as a government website",
    "start": "516039",
    "end": "521200"
  },
  {
    "text": "they have very high accessibility requirements for you know people that are visually impaired and similar and",
    "start": "521200",
    "end": "526519"
  },
  {
    "text": "they were using a plug-in from another company that does text to speech so if you go to the government website there's",
    "start": "526519",
    "end": "532560"
  },
  {
    "text": "like a little um speaker icon and when you click it it reads the content of the page out loud in front of you in case",
    "start": "532560",
    "end": "539000"
  },
  {
    "text": "your VIs usually impaired and this is what the company specialized in it was a effectively a text to speech plugin in",
    "start": "539000",
    "end": "546320"
  },
  {
    "text": "JavaScript now unfortunately when I finally found this injection point I went to the company's website of course",
    "start": "546320",
    "end": "552519"
  },
  {
    "text": "the company was also infected with the malware because their own tool their own product was the source of the infection",
    "start": "552519",
    "end": "559760"
  },
  {
    "text": "so the actual script tag the actual malicious JavaScript that's the URL for the tag right there and I knew that I",
    "start": "559760",
    "end": "567399"
  },
  {
    "text": "found the injection point when I opened this file and it looked like this now",
    "start": "567399",
    "end": "573560"
  },
  {
    "text": "the comment at the top there is the original comment from the file that is from the vendor and the minified",
    "start": "573560",
    "end": "580360"
  },
  {
    "text": "JavaScript down at the bottom is the beginning of their normal Library their normal product code and this part in the",
    "start": "580360",
    "end": "586200"
  },
  {
    "text": "middle was the bit that as soon as I saw it I was like this is it because no samean person does this to their",
    "start": "586200",
    "end": "592160"
  },
  {
    "text": "JavaScript when they're deploying products so as soon as I see JavaScript that's been OB fiscated like this you're",
    "start": "592160",
    "end": "599000"
  },
  {
    "text": "like okay there's something here that people don't want you to see so I grabbed this section of script obviously",
    "start": "599000",
    "end": "604120"
  },
  {
    "text": "we can decode it there's a slightly more zoomed in version it's still super messy and eventually we end up with this so",
    "start": "604120",
    "end": "612240"
  },
  {
    "text": "this is what that JavaScript looks like when you remove all of the offis and all it's simply doing you can see here it's",
    "start": "612240",
    "end": "618760"
  },
  {
    "text": "writing a new script tag on and it's loading the coinhive library we are then writing that onto",
    "start": "618760",
    "end": "624360"
  },
  {
    "text": "the page with some configuration so you can configure coinhive for things like you know how much CPU do I want to take",
    "start": "624360",
    "end": "630920"
  },
  {
    "text": "what do I want to do and then of course finally we add the address for the wallet where the cryptocurrency is going",
    "start": "630920",
    "end": "637120"
  },
  {
    "text": "to be sent to and then we start the minor running so this is a super simple",
    "start": "637120",
    "end": "642160"
  },
  {
    "text": "process they've obviously found a way to get into the vendor original script file inject their own additional little bits",
    "start": "642160",
    "end": "648920"
  },
  {
    "text": "of script this is their bootstrap to then pulling coin High start Mining and start sending the cryptocurrency",
    "start": "648920",
    "end": "655040"
  },
  {
    "text": "elsewhere so we unraveled this pretty quickly and it was like wow this is you",
    "start": "655040",
    "end": "660079"
  },
  {
    "text": "know like this is pretty bad this company browse alloud have obviously had some kind of compromise we didn't yet",
    "start": "660079",
    "end": "665200"
  },
  {
    "text": "know at the time what the exact Vector was um but it's like yeah this is like this is pretty bad you know they've",
    "start": "665200",
    "end": "671440"
  },
  {
    "text": "they've obviously suffered some kind of serious breach here so the problem was this script tag",
    "start": "671440",
    "end": "679639"
  },
  {
    "text": "and this looks like a really kind of simple innocent thing that you you've probably all got you know tens or",
    "start": "679639",
    "end": "685800"
  },
  {
    "text": "hundreds of these things on your website and so does every other website in the world but this is the source of the injection and this was the source of the",
    "start": "685800",
    "end": "693480"
  },
  {
    "text": "problem now once I look at this script tag I was like well they're a product",
    "start": "693480",
    "end": "699440"
  },
  {
    "text": "vendor right like they're doing this text to speech plugin and if they're you know selling their services to customers",
    "start": "699440",
    "end": "705040"
  },
  {
    "text": "then other customers are going to be injecting this script tag onto their website and I was like so we found this",
    "start": "705040",
    "end": "710519"
  },
  {
    "text": "infection in the British government site traced it back to the vendor and then I was like well hang on a minute like anyone else using this vendor now has",
    "start": "710519",
    "end": "716680"
  },
  {
    "text": "the same problem so there's a couple of tools and search engines online that I use and I",
    "start": "716680",
    "end": "721839"
  },
  {
    "text": "also run my own crawler that crawls the top 1 million websites in the world every day and does various bits of",
    "start": "721839",
    "end": "727600"
  },
  {
    "text": "analysis on them and I was like well if we just go through the data and look for any site that's loading this script tag",
    "start": "727600",
    "end": "733440"
  },
  {
    "text": "any site loading the script tag is going to have the exact same infection so I quickly start trolling through my data",
    "start": "733440",
    "end": "739079"
  },
  {
    "text": "pulling out any site who had this script tag on there",
    "start": "739079",
    "end": "745639"
  },
  {
    "text": "so turns out the US government like accessibility and they want visually impaired people to be able to use their",
    "start": "745639",
    "end": "751720"
  },
  {
    "text": "website with no hindrance and they had this product deployed across you know every government website that I could",
    "start": "751720",
    "end": "757360"
  },
  {
    "text": "find this is the United States Court it was on the Supreme Court it was on all of their tax authorities websites it was",
    "start": "757360",
    "end": "762880"
  },
  {
    "text": "on everything of course the rest of the UK government as well even things like our student loan company so in the UK",
    "start": "762880",
    "end": "769480"
  },
  {
    "text": "when you go to university you can effectively get a loan from the government and when you do that it's",
    "start": "769480",
    "end": "774720"
  },
  {
    "text": "obviously dealing with huge amounts of money for like millions of people you go to the website you log in you can do all",
    "start": "774720",
    "end": "779959"
  },
  {
    "text": "of your student loan stuff so this website handles I it must be like hundreds of millions of pounds worth of",
    "start": "779959",
    "end": "785480"
  },
  {
    "text": "details and information and money I was like okay great they're infected what else have we got the General Medical",
    "start": "785480",
    "end": "790800"
  },
  {
    "text": "Council in the UK where all of our doctors and nurses are registered so this handles all kinds of sensitive information and this website is now",
    "start": "790800",
    "end": "797639"
  },
  {
    "text": "running to malicious JavaScript the NHS our National Health Service you know I can log into the NHS website and see all",
    "start": "797639",
    "end": "804639"
  },
  {
    "text": "of my medical records I can send messages to my doctor and have conversations with them so it's again",
    "start": "804639",
    "end": "809959"
  },
  {
    "text": "like a huge amount of really sensitive data and then all the way around the",
    "start": "809959",
    "end": "815000"
  },
  {
    "text": "other side of the world as well there are Australian government websites New Zealand government websites so it was basically any website",
    "start": "815000",
    "end": "823199"
  },
  {
    "text": "of course running this product this text to speech plug-in and very very quickly",
    "start": "823199",
    "end": "828279"
  },
  {
    "text": "and easily I pulled up a list of just over 5 and a half thousand government websites I was like let's focus on these",
    "start": "828279",
    "end": "834160"
  },
  {
    "text": "kind of really important ones so at this point I realized it's kind of insurmountable task to actually",
    "start": "834160",
    "end": "840320"
  },
  {
    "text": "start contacting government departments you know there's now I thought it would have been hard to contact one government department and now it's like there's",
    "start": "840320",
    "end": "846480"
  },
  {
    "text": "literally 5 and a half thousand you know teams that I'm going to have to contact and be like hey you've got an infection",
    "start": "846480",
    "end": "851720"
  },
  {
    "text": "on your website so this was quickly becoming a really insurmountable task is like there's no way that we're going to",
    "start": "851720",
    "end": "858040"
  },
  {
    "text": "be able to do this now once I I've only talked about this once before and in",
    "start": "858040",
    "end": "864519"
  },
  {
    "text": "order to kind of demonstrate what the issue here was with trying to contact this many government departments I created this link so a Google do for",
    "start": "864519",
    "end": "874360"
  },
  {
    "text": "those of you unfamiliar is when you use Google to find websites that might have security vulnerabilities and there's",
    "start": "874360",
    "end": "879519"
  },
  {
    "text": "some really cool Google queries that you can do to look for indicators in web pages that the website has a",
    "start": "879519",
    "end": "884920"
  },
  {
    "text": "vulnerability so Google Docs are just using Google to find websites that might be vulnerable to attack and I wrote this",
    "start": "884920",
    "end": "891440"
  },
  {
    "text": "Google doc so you can go to the link there it still works that is the link it will forward you through to the Google",
    "start": "891440",
    "end": "896880"
  },
  {
    "text": "query and we're simply looking for sites that contain. goov in their address and",
    "start": "896880",
    "end": "903360"
  },
  {
    "text": "somewhere on the page they have the Declaration of the crypto Miner so the",
    "start": "903360",
    "end": "908639"
  },
  {
    "text": "little bit of script tag in the page that declares the crypto Miner and if you go there now there are still",
    "start": "908639",
    "end": "914519"
  },
  {
    "text": "websites government websites because they've got. goov in the domain that have got the coinhive minor on their",
    "start": "914519",
    "end": "920920"
  },
  {
    "text": "page so yeah like we're still not there we still haven't fully actually solved",
    "start": "920920",
    "end": "926160"
  },
  {
    "text": "this problem and there are still to this day government websites that have got the Declaration of the coinhive minor on",
    "start": "926160",
    "end": "931480"
  },
  {
    "text": "their page somewhere so if you're unfamiliar with Google doing take a look at that you can do some pretty cool things with it and",
    "start": "931480",
    "end": "937759"
  },
  {
    "text": "find some pretty cool stuff but we have to solve this problem it's like you know what are we going to do like I said this",
    "start": "937759",
    "end": "944480"
  },
  {
    "text": "was on a Sunday and I was live tweeting our investigation and all most of the things that you just saw Monday comes",
    "start": "944480",
    "end": "949959"
  },
  {
    "text": "through and I'm like okay you know the government should be open today maybe I'll hear something from the government and eventually we rolled to Tuesday and",
    "start": "949959",
    "end": "956720"
  },
  {
    "text": "I'm like I've still had no contact no communication no you know I've had multiple journalists reaching out to me",
    "start": "956720",
    "end": "962880"
  },
  {
    "text": "they're trying to contact government teams and departments and eventually I got a DM and I actually got a DM from",
    "start": "962880",
    "end": "968959"
  },
  {
    "text": "the government so the ncsc in the UK is our national cyber security Center and",
    "start": "968959",
    "end": "974480"
  },
  {
    "text": "it's the department in our government that's responsible for all of our critical infrastructure from a cyber security perspective so I got a tweet",
    "start": "974480",
    "end": "980920"
  },
  {
    "text": "from the NCS a DM from the mcsc and I was like you know when this pops up I was",
    "start": "980920",
    "end": "986240"
  },
  {
    "text": "like is it I don't know which way this is going to go but we're about to find out this could be really good or really",
    "start": "986240",
    "end": "991519"
  },
  {
    "text": "bad so they messaged me and it's like hey Scott could I grab your email um they really didn't appreciate my",
    "start": "991519",
    "end": "998199"
  },
  {
    "text": "answer um I was like are you really that good of spy agency if you don't already have my email address um also it's on my",
    "start": "998199",
    "end": "1005480"
  },
  {
    "text": "website on the contact page so yeah this this was the point at which like we finally actually started to get",
    "start": "1005480",
    "end": "1011279"
  },
  {
    "text": "somewhere now bearing in mind obviously the infection was at least there on the Sunday when we found it and we're now at",
    "start": "1011279",
    "end": "1016480"
  },
  {
    "text": "Tuesday and I was like gosh you know this is is this is going to go pretty slow but at this point you know we",
    "start": "1016480",
    "end": "1022040"
  },
  {
    "text": "quickly switch over to email then we switched over to more direct coms on the phone and I was like you've got to move fast like this is really bad you you",
    "start": "1022040",
    "end": "1028438"
  },
  {
    "text": "need to move quickly to solve this problem now um eventually you know the",
    "start": "1028439",
    "end": "1034360"
  },
  {
    "text": "issue was like so bad it was like can you just come to London like you know we need to go faster than talking about this on the phone and ultimately a short",
    "start": "1034360",
    "end": "1042120"
  },
  {
    "text": "time later again I I went back down to London this is National cyber security Center at gchq which is like our government spy agency this was so",
    "start": "1042120",
    "end": "1049000"
  },
  {
    "text": "awesome to be here and they were like you know what is what is the process what do we need to do and I was like",
    "start": "1049000",
    "end": "1055960"
  },
  {
    "text": "well you know ultimately The Simple Solution to this problem is remove the script tag from the page right like the infection for you guys isn't that",
    "start": "1055960",
    "end": "1062039"
  },
  {
    "text": "complex as soon as you remove the script tag for this Fender the infection is gone it's like so pretty easy right we",
    "start": "1062039",
    "end": "1068799"
  },
  {
    "text": "should be able to do this no problem so I was like go into all of your applications and delete this",
    "start": "1068799",
    "end": "1075120"
  },
  {
    "text": "line and this was when the issue started because you're like oh okay yeah so you know we've identified these several",
    "start": "1075120",
    "end": "1081280"
  },
  {
    "text": "hundred British government websites so like we need to go to the appropriate teams and then we need to file a change request and then somebody's going to",
    "start": "1081280",
    "end": "1087480"
  },
  {
    "text": "have to go make the change and we'll have to get the change approved and then we'll have to you know go through the testing process and the deployment",
    "start": "1087480",
    "end": "1093200"
  },
  {
    "text": "process and I was like just go delete it like forget all the process forget all of the everything no change process no",
    "start": "1093200",
    "end": "1099520"
  },
  {
    "text": "approvals no anything I was like this is a live infection just go delete the line in the code and deploy and they were",
    "start": "1099520",
    "end": "1107039"
  },
  {
    "text": "like this is this is going to take weeks they like this is literally weeks of remediation work right here and I was",
    "start": "1107039",
    "end": "1113080"
  },
  {
    "text": "just I sat there and I was like this cannot be true like this cannot be possible I was like you just go into the Cod base right now and just delete the",
    "start": "1113080",
    "end": "1119919"
  },
  {
    "text": "line so a couple of people thought that was the right way to go and begin on that process and I was like the",
    "start": "1119919",
    "end": "1125360"
  },
  {
    "text": "alternative is we can try and get hold of the vendor because obviously if we get the vendor to go and remove the infection from their file that will",
    "start": "1125360",
    "end": "1131520"
  },
  {
    "text": "obviously immediately fix it on all of the sites as well so at least at the same time we should be reaching out to the vendor and try and push that to like",
    "start": "1131520",
    "end": "1139320"
  },
  {
    "text": "solve their problem as well but the weird thing is I was like you know this",
    "start": "1139320",
    "end": "1144400"
  },
  {
    "text": "could have happened with any of the script dependencies it could have been any vendor I assume the attackers went after this one because they're a",
    "start": "1144400",
    "end": "1150039"
  },
  {
    "text": "relatively small company and you know if you're going to try and break into a website and infect them with JavaScript",
    "start": "1150039",
    "end": "1155240"
  },
  {
    "text": "you can obviously either attack the website directly it's like a the government's got pretty good security like they've got a budget they've got a",
    "start": "1155240",
    "end": "1160840"
  },
  {
    "text": "security team or if you can find one of their dependencies that's a really small company that might not have as much security budget it's obviously easier to",
    "start": "1160840",
    "end": "1167960"
  },
  {
    "text": "compromise them so this is why they'll have gone for the dependency",
    "start": "1167960",
    "end": "1173120"
  },
  {
    "text": "now when I look at that script tag does does anyone like does anyone have any",
    "start": "1173120",
    "end": "1178520"
  },
  {
    "text": "concerns when they look at that it's just the script tag right like we all do this we all have hundreds of these",
    "start": "1178520",
    "end": "1183840"
  },
  {
    "text": "things across all of our websites bits and Pie there are and we'll come on to",
    "start": "1183840",
    "end": "1189200"
  },
  {
    "text": "those bits and pieces because and ultimately like that's the problem and the problem here is like I just said if",
    "start": "1189200",
    "end": "1195080"
  },
  {
    "text": "you have the script tag on your page you're just going to you know load this vendors library in if the vendor gets",
    "start": "1195080",
    "end": "1200400"
  },
  {
    "text": "infected you get infected and really like what the script tag is because",
    "start": "1200400",
    "end": "1205799"
  },
  {
    "text": "people look at this and they look at the path and the file and sometimes like there's version information and things in there and you're like oh yeah I know",
    "start": "1205799",
    "end": "1211039"
  },
  {
    "text": "like I'm going to go over here and I'm going to get this library that does this thing but actually we don't know that all we really know when you look at the",
    "start": "1211039",
    "end": "1217200"
  },
  {
    "text": "script tag is like we're going to go there and there'll be some JavaScript that's it that's all you know",
    "start": "1217200",
    "end": "1222600"
  },
  {
    "text": "right the file name is irrelevant the path is irrelevant right there's no indication of like what JavaScript are",
    "start": "1222600",
    "end": "1228159"
  },
  {
    "text": "we going to get what should it do how much will there be it's like just go here and there is some JavaScript and",
    "start": "1228159",
    "end": "1233840"
  },
  {
    "text": "then run the JavaScript that's ultimately all the script tag like this says and this is the thing that just",
    "start": "1233840",
    "end": "1238960"
  },
  {
    "text": "always really concerns me now we I refer to this as the blank check for JavaScript so I know we're in like a",
    "start": "1238960",
    "end": "1247240"
  },
  {
    "text": "really Forward Thinking nation and also there's young people here so you won't know what checks are so we used to have",
    "start": "1247240",
    "end": "1252400"
  },
  {
    "text": "like little bits of paper that you would write a promise to give someone some money and then you would give them the piece of paper and then they would take",
    "start": "1252400",
    "end": "1258320"
  },
  {
    "text": "the piece piece of paper to the bank to get the money it was this really weird thing that we do and we still use checks a lot in the UK I don't know why but the",
    "start": "1258320",
    "end": "1264840"
  },
  {
    "text": "idea is when you write someone a check you sign it and that's like the authority to take the money but you",
    "start": "1264840",
    "end": "1270919"
  },
  {
    "text": "would never sign a check and leave the amount field blank right because if you",
    "start": "1270919",
    "end": "1276840"
  },
  {
    "text": "did that you know they go to the bank and they'd be like 1 million croner and then they'll cash the check and they can",
    "start": "1276840",
    "end": "1282760"
  },
  {
    "text": "take as much money as they want so the idea of giving someone a blank check is obviously really dumb because they're",
    "start": "1282760",
    "end": "1288200"
  },
  {
    "text": "just going to take all of your money but this script tag is the blank check of",
    "start": "1288200",
    "end": "1295080"
  },
  {
    "text": "JavaScript right like you're literally writing on your website I will take whatever JavaScript you give me any",
    "start": "1295080",
    "end": "1301320"
  },
  {
    "text": "amount of JavaScript that you want that does anything that you want and I'm going to take it and I'm going to put it",
    "start": "1301320",
    "end": "1307240"
  },
  {
    "text": "straight in my page and then I'm going to run it and I explained this to the government people and I was like this is",
    "start": "1307240",
    "end": "1313320"
  },
  {
    "text": "really weird because you've just said to me we want to make a change to our website so we're going to have to go find the people the team submit a change",
    "start": "1313320",
    "end": "1319799"
  },
  {
    "text": "requests make the change get the approvals do the testing we're going to have to go through all of this process I was like but this",
    "start": "1319799",
    "end": "1326720"
  },
  {
    "text": "vendor is just deploying changes straight into production with no approval no testing if they change this",
    "start": "1326720",
    "end": "1332600"
  },
  {
    "text": "JavaScript the change goes into production no testing no approvals No Nonsense no process and I was like so",
    "start": "1332600",
    "end": "1339960"
  },
  {
    "text": "why do all of your teams have all of these processes that they must ader to and go through and this vendor is just",
    "start": "1339960",
    "end": "1345799"
  },
  {
    "text": "like YOLO JavaScript straight into the page and I was like does anyone see a disparity between these two",
    "start": "1345799",
    "end": "1352200"
  },
  {
    "text": "things so we spent a long time on this and of course the Press were like very",
    "start": "1352200",
    "end": "1357279"
  },
  {
    "text": "interested in this thousands of governments infected with malware this is a really you know really big issue",
    "start": "1357279",
    "end": "1362480"
  },
  {
    "text": "and whilst this was kind of ongoing we filmed we started doing some filming for a TV show cuz I did a lot of work with the BBC back then I was really really",
    "start": "1362480",
    "end": "1369120"
  },
  {
    "text": "fortunate and we made like this little video that highlights kind of like a couple of the key issues with it so",
    "start": "1369120",
    "end": "1376279"
  },
  {
    "text": "we'll just take a quick watch of this of course you know journalists always like to Jazz things up and they were like can",
    "start": "1376279",
    "end": "1382679"
  },
  {
    "text": "you wear GL it's a crime that start becom the Hacker's favorite no and the impact often goes unseen I",
    "start": "1382679",
    "end": "1391039"
  },
  {
    "text": "did give in on the sunglasses though I did wear sunglasses computer after it's been",
    "start": "1391039",
    "end": "1397120"
  },
  {
    "text": "hijacked everything may look fine from the outside but inside resources have",
    "start": "1397120",
    "end": "1402480"
  },
  {
    "text": "been ransacked to add insults to injury your electricity bill is about to go up",
    "start": "1402480",
    "end": "1409159"
  },
  {
    "text": "as you pay to power a machine that's now working hard for the criminal abandoned",
    "start": "1409159",
    "end": "1414320"
  },
  {
    "text": "warehouse friend of mine with me on the Sunday morning and said I've just been to the information commissioner's office",
    "start": "1414320",
    "end": "1420520"
  },
  {
    "text": "website where the Ico here in the UK our data protection body at the government and he said my antivirus program has",
    "start": "1420520",
    "end": "1426200"
  },
  {
    "text": "thrown up this warning on the screen and he said this is a government website can it have a virus on it so what we",
    "start": "1426200",
    "end": "1432320"
  },
  {
    "text": "discovered was originally that the Ico website was running a crypto Miner so your your browser would be hijacked to m",
    "start": "1432320",
    "end": "1438480"
  },
  {
    "text": "cryptocurrencies for the hackers after some investigation what we found was that a third party supplier that",
    "start": "1438480",
    "end": "1444760"
  },
  {
    "text": "provides them with software had been breached and they' included the crypto Miner in that a thirdparty app used by",
    "start": "1444760",
    "end": "1452320"
  },
  {
    "text": "the Ico and thousands of other websites had been compromised the malware told visitors computers to start mining",
    "start": "1452320",
    "end": "1459960"
  },
  {
    "text": "cryptocurrencies for the bad guys and you can see before my system was doing one or two different things and now the",
    "start": "1459960",
    "end": "1466559"
  },
  {
    "text": "miner is running the miner is taking 100% of my CPU on this device and using",
    "start": "1466559",
    "end": "1472600"
  },
  {
    "text": "it to mine cryptocurrencies uh you can configure a crypto Miner in how much of the computer's power it will use now if",
    "start": "1472600",
    "end": "1479000"
  },
  {
    "text": "you're greedy and you take 100% then someone's computer or phone or tablet will slow down and you will notice that",
    "start": "1479000",
    "end": "1486240"
  },
  {
    "text": "when you try to do things it's not responsive it hangs uh what they've done in this case is they done configured it",
    "start": "1486240",
    "end": "1491880"
  },
  {
    "text": "to use up to 60% of the power of the device so it would use a lot of it so",
    "start": "1491880",
    "end": "1497559"
  },
  {
    "text": "again the average user user may never have known that it was there and that it was running Scott showed me how they could",
    "start": "1497559",
    "end": "1504960"
  },
  {
    "text": "have stolen visitors data so why didn't they so what I've set up here is",
    "start": "1504960",
    "end": "1510919"
  },
  {
    "text": "something that the attackers could have done I've given myself the same level of access they did and you'll notice that",
    "start": "1510919",
    "end": "1516399"
  },
  {
    "text": "the information commissioner's office website has a username and password field uh so if you just go ahead and",
    "start": "1516399",
    "end": "1522120"
  },
  {
    "text": "type something into that field and already if you look at the information being sent to my device here",
    "start": "1522120",
    "end": "1529200"
  },
  {
    "text": "this is coming up on there straight away as you type that is sent in real time to me and the attackers in this instance",
    "start": "1529200",
    "end": "1535840"
  },
  {
    "text": "could have done this absolutely they just chose not to why easy money you know attackers",
    "start": "1535840",
    "end": "1543480"
  },
  {
    "text": "will take the low hanging fruit they put the crypto Manor onto this website and they walk away the Ico told us no personal data",
    "start": "1543480",
    "end": "1551440"
  },
  {
    "text": "was compromised third party applications were swiftly reviewed and their systems",
    "start": "1551440",
    "end": "1556480"
  },
  {
    "text": "patched that's a and that they also exploring new",
    "start": "1556480",
    "end": "1561000"
  },
  {
    "text": "ways so security firms are reporting hackers making millions of dollars it's",
    "start": "1563840",
    "end": "1571120"
  },
  {
    "text": "called cryptojacking It's On The Rise and the gangs that do it aren't only",
    "start": "1571120",
    "end": "1576159"
  },
  {
    "text": "eyeing up so there's so many things in there that like I just fundamentally disagree",
    "start": "1576159",
    "end": "1583320"
  },
  {
    "text": "with I love the statements from the Ico and they're like you know they said no personal data was compromised",
    "start": "1583320",
    "end": "1588799"
  },
  {
    "text": "and now I showed obviously and we all know in JavaScript it's like four lines of code and you can write a key logger",
    "start": "1588799",
    "end": "1595240"
  },
  {
    "text": "which is effectively all I did there now the Ico website doesn't have our gov ID login on it because there's nothing to",
    "start": "1595240",
    "end": "1601080"
  },
  {
    "text": "log in and do but if you go to other government websites they have our go ID login which is like our Universal login",
    "start": "1601080",
    "end": "1606480"
  },
  {
    "text": "to all government services and I was like so things like you know harvesting credentials is obviously super trivial",
    "start": "1606480",
    "end": "1612840"
  },
  {
    "text": "to do in JavaScript and then they say oh well there was no personal data compromise and I was like well like do",
    "start": "1612840",
    "end": "1618840"
  },
  {
    "text": "you have a copy of all of the JavaScript that was deployed on that breach which had actually been there for a really long time to say that they never had a",
    "start": "1618840",
    "end": "1625960"
  },
  {
    "text": "key log I was like how can you know you can't say that a like a famous quote from a friend of mine Zach whiter he's",
    "start": "1625960",
    "end": "1631679"
  },
  {
    "text": "like you know the government said there was no compromise and cited no evidence it's",
    "start": "1631679",
    "end": "1636799"
  },
  {
    "text": "like it's like you know they just literally said there was no compromise and and the um this the demo that you",
    "start": "1636799",
    "end": "1643320"
  },
  {
    "text": "showed there as well with the key logger thing they asked me to write like a few different payloads and I just use my accepting proxy to inject the script",
    "start": "1643320",
    "end": "1649919"
  },
  {
    "text": "giving me ex effectively what the attackers had and I had multiple different Pals none of them they would put on the television um a couple of",
    "start": "1649919",
    "end": "1657279"
  },
  {
    "text": "them were just like dead simple and fun it was like a Javascript file that would play like the Star Wars theme tune and",
    "start": "1657279",
    "end": "1663159"
  },
  {
    "text": "like scroll the website off into the distance when you loaded the page I thought that was pretty cool um but then",
    "start": "1663159",
    "end": "1668200"
  },
  {
    "text": "of course as well you think if you could inject JavaScript into thousands and thousands of government websites especially what would you do and I was",
    "start": "1668200",
    "end": "1674760"
  },
  {
    "text": "like one of the payloads I injected obviously was just you know like full hardcore pornography video full screen",
    "start": "1674760",
    "end": "1680240"
  },
  {
    "text": "and they're like okay so we can't put that on the TV but you know can you imagine if they' done that what the",
    "start": "1680240",
    "end": "1685519"
  },
  {
    "text": "impact would have been another payload that I had put like the like a yellow and black banner across the top of the",
    "start": "1685519",
    "end": "1691080"
  },
  {
    "text": "screen it was like prime minister assassinated and they like okay we can't put that on the TV because if somebody's",
    "start": "1691080",
    "end": "1696840"
  },
  {
    "text": "walking past the store and looks in the window and sees this like you know people like this could cause people to",
    "start": "1696840",
    "end": "1702399"
  },
  {
    "text": "like panic and freak out so they're okay we can't do that I like but can you imagine if you shot the stock market and then put that on all the government",
    "start": "1702399",
    "end": "1707720"
  },
  {
    "text": "website I was like now we can make some real money so there were loads of different things that that I had ready as demos",
    "start": "1707720",
    "end": "1714880"
  },
  {
    "text": "and they just wouldn't put on the television and this is the problem right like you could have literally done anything as long as you can think of the",
    "start": "1714880",
    "end": "1720799"
  },
  {
    "text": "thing that you want to do and you can copy and paste the code from stack Overflow like you could literally or nowadays just ask chat GPT to write it",
    "start": "1720799",
    "end": "1726799"
  },
  {
    "text": "you can do anything that you want once you've got script into the page these things are so dangerous now",
    "start": "1726799",
    "end": "1733720"
  },
  {
    "text": "I'm looking at this in King anything that these attackers wanted to do they could have done and all they did was",
    "start": "1733720",
    "end": "1739840"
  },
  {
    "text": "just choose not to you know we look at this and they're like why did they just decide to mine man arrow and I was like",
    "start": "1739840",
    "end": "1744880"
  },
  {
    "text": "honestly cuz you just come in drop the script tag walk away and then for as long as it stays there you just keep pulling in those dollars over time",
    "start": "1744880",
    "end": "1752480"
  },
  {
    "text": "there's no visual impact they requested lower CPU usage so that hopefully people didn't notice their devices burning CPU",
    "start": "1752480",
    "end": "1758880"
  },
  {
    "text": "power and my guess is that they just wanted to put that there and for it to be there for months and months and",
    "start": "1758880",
    "end": "1765000"
  },
  {
    "text": "months and they could just keep siphoning off all of that cryptocurrency say now when I asked you know what is",
    "start": "1765000",
    "end": "1771320"
  },
  {
    "text": "wrong with this script tag is this a problem somebody said there are some attributes missing and there are because",
    "start": "1771320",
    "end": "1777320"
  },
  {
    "text": "there are now additional attributes that we can add to script tags to protect us from attacks like this and this is one",
    "start": "1777320",
    "end": "1783760"
  },
  {
    "text": "of the things that I mentioned to the the government at the time when I was talking to the ncsc I was like look we you know getting screwed by your",
    "start": "1783760",
    "end": "1789159"
  },
  {
    "text": "dependencies is not a new thing we already know about this and we already have the solution to this and the solution to this specific problem is",
    "start": "1789159",
    "end": "1795360"
  },
  {
    "text": "called subresource Integrity or s I now SRI is super simple it's been supported",
    "start": "1795360",
    "end": "1803080"
  },
  {
    "text": "in all browsers since forever so you can definitely do this and all you do is very slightly change the script tag to",
    "start": "1803080",
    "end": "1809440"
  },
  {
    "text": "look like this you know I said earlier when the browser goes to this URL it's",
    "start": "1809440",
    "end": "1814760"
  },
  {
    "text": "like oh there is some JavaScript you know we don't know how much we don't know what it does we don't know anything",
    "start": "1814760",
    "end": "1819799"
  },
  {
    "text": "about it and all we're doing now adding this Integrity attribute is saying here is the hash of the file that you should",
    "start": "1819799",
    "end": "1826960"
  },
  {
    "text": "download right so you can still go here you can still have your third party hosted libraries you can still go to this",
    "start": "1826960",
    "end": "1833720"
  },
  {
    "text": "external location and pull down this code but now we're going to Integrity check it and I was like this is it this",
    "start": "1833720",
    "end": "1841000"
  },
  {
    "text": "is all you have to do right you have to add the cross origin attribute as well because it needs to be an unauthenticated request to load the",
    "start": "1841000",
    "end": "1847799"
  },
  {
    "text": "JavaScript but this is it I was like problem solved that's it just go replace the script tag you had before with the",
    "start": "1847799",
    "end": "1853440"
  },
  {
    "text": "script tag on the screen no more infection because of course once the file at the remote location",
    "start": "1853440",
    "end": "1858480"
  },
  {
    "text": "changes the browser will download it it will do the hash and the hashes will mismatch and the browser will just throw",
    "start": "1858480",
    "end": "1864639"
  },
  {
    "text": "the file away and say that's not the file I was expecting it's different we don't know how it's different or why",
    "start": "1864639",
    "end": "1870120"
  },
  {
    "text": "it's different all it matters is that we know it's different and now we can discard it because it's not what I was",
    "start": "1870120",
    "end": "1875840"
  },
  {
    "text": "expecting and I was like that's it done off you go now there is one kind of",
    "start": "1875840",
    "end": "1881279"
  },
  {
    "text": "catch to S and this is often the thing that stops people from using it if we take a look at the script from the",
    "start": "1881279",
    "end": "1887399"
  },
  {
    "text": "vendor earlier there is a little comment at the top there and unfortunately this",
    "start": "1887399",
    "end": "1893440"
  },
  {
    "text": "was effectively the problem this was the thing that was going to hold us back from it being a simple solution of just",
    "start": "1893440",
    "end": "1899159"
  },
  {
    "text": "deploying SRI and the comment says do not copy or self-host this file you will not be supported that's kind of typical",
    "start": "1899159",
    "end": "1905159"
  },
  {
    "text": "that's fine now it says browse allowed version",
    "start": "1905159",
    "end": "1910200"
  },
  {
    "text": "2.5.0 but if we look at the URL to get the file there's no version number in",
    "start": "1910200",
    "end": "1915600"
  },
  {
    "text": "the path or in the file name you know there's no query parameters specifying the version and this is",
    "start": "1915600",
    "end": "1921399"
  },
  {
    "text": "effectively a dynamic file right obviously it's got the version number 2.5.0 in there now so the assumption is",
    "start": "1921399",
    "end": "1928039"
  },
  {
    "text": "you know previously it was a lower version and at some point in the future it's going to be a higher version as well and this is this is kind of",
    "start": "1928039",
    "end": "1934639"
  },
  {
    "text": "problematic because we can now update the script tag to kind of think of it a little bit like this where it's like",
    "start": "1934639",
    "end": "1939679"
  },
  {
    "text": "latest. JS right it's like you go here and you're going to get like whatever the current latest version of the file",
    "start": "1939679",
    "end": "1946080"
  },
  {
    "text": "is and we're now back into the problem where we obviously can't Integrity check this because if the file is intended to",
    "start": "1946080",
    "end": "1952360"
  },
  {
    "text": "be dynamic in nature then we you can't Integrity check something that's meant to change you have to Integrity check a",
    "start": "1952360",
    "end": "1958399"
  },
  {
    "text": "known expected version now I said to the you know was speaking to like the",
    "start": "1958399",
    "end": "1963600"
  },
  {
    "text": "government people and I was like you're going to have to ask the vendor for a version path you know you're going to have to ask them to lock to you know I",
    "start": "1963600",
    "end": "1969279"
  },
  {
    "text": "think we're on like 3 point something at the time and you know it's like you're going to have to ask them for like",
    "start": "1969279",
    "end": "1974440"
  },
  {
    "text": "forward SL 3.5.1 SL browser .js we need a version",
    "start": "1974440",
    "end": "1979919"
  },
  {
    "text": "path and I thought that was pretty reasonable you know it's like it's not too difficult a thing to ask for and",
    "start": "1979919",
    "end": "1985279"
  },
  {
    "text": "then we can use SRI to lock to that version and the vendor is like no yeah sorry we can't do that now because we",
    "start": "1985279",
    "end": "1992320"
  },
  {
    "text": "had the vendor involved by this point now the vendor was like yeah you know like but obviously if we uh add a new",
    "start": "1992320",
    "end": "1998679"
  },
  {
    "text": "feature then we're going to bump the version and then you automatically get the new version therefore you get the new feature and you don't have to do",
    "start": "1998679",
    "end": "2004600"
  },
  {
    "text": "anything if if there's a bug fix if there's a problem with the product we can fix the bug bump the version and you",
    "start": "2004600",
    "end": "2010600"
  },
  {
    "text": "get the bug fix and you don't have to do anything so like this is really good for you because you know if new features come out new things happen you know we",
    "start": "2010600",
    "end": "2017080"
  },
  {
    "text": "fix bugs you get all of the new things and the awesome things without having to do",
    "start": "2017080",
    "end": "2023760"
  },
  {
    "text": "anything and I was like yes that's true like you know we can't we can't argue",
    "start": "2023760",
    "end": "2028840"
  },
  {
    "text": "against that I was like but let me say the same things but with like slightly different words we have a third party",
    "start": "2028840",
    "end": "2037000"
  },
  {
    "text": "who can deploy arbitary code changes to our website with no prior approval or testing I was",
    "start": "2037000",
    "end": "2044080"
  },
  {
    "text": "like is that approximately the same thing it's like cuz that's basically the same thing as what you're saying you know if you're patching bugs and",
    "start": "2044080",
    "end": "2049720"
  },
  {
    "text": "deploying the code you're just deploying those arbitary changes straight into production it's like you can't you know there are the benefits of that approach",
    "start": "2049720",
    "end": "2056079"
  },
  {
    "text": "that they mentioned I was like but there are the huge drawbacks that if the change is we added malware then you also",
    "start": "2056079",
    "end": "2061839"
  },
  {
    "text": "get the malware as well So eventually it came to the point",
    "start": "2061839",
    "end": "2066960"
  },
  {
    "text": "where we said look look if they if you don't give us a version path that we can lock to we're going to have to drop the script tag and we're going to have to",
    "start": "2066960",
    "end": "2072480"
  },
  {
    "text": "drop the product and that was the thing that got them to Cave they were like okay we we'll give you a static version",
    "start": "2072480",
    "end": "2078520"
  },
  {
    "text": "path now later I found out their reason for resisting was their Library calls back to use a lot of services that they",
    "start": "2078520",
    "end": "2085320"
  },
  {
    "text": "host and basically they didn't want to have to do like Version Control and deprecations they're like look if we",
    "start": "2085320",
    "end": "2091000"
  },
  {
    "text": "remove an old feature and bump the version we can like just drop all the apis and the stuff for the old version",
    "start": "2091000",
    "end": "2096398"
  },
  {
    "text": "and we don't have to do like deprecation notices and things and they I was like basically it's easier for you like",
    "start": "2096399",
    "end": "2102040"
  },
  {
    "text": "that's the reason that they're pushing this but they eventually Cav they gave us a version path so it's like okay nice",
    "start": "2102040",
    "end": "2107720"
  },
  {
    "text": "we've got you know we've got like the kind of the first problem uh solved we can put SRI on these script tags and",
    "start": "2107720",
    "end": "2113800"
  },
  {
    "text": "away we go but there was a second mechanism that I was also trying to push the government to look at as well so I'm",
    "start": "2113800",
    "end": "2121119"
  },
  {
    "text": "only going to talk about content security policy briefly here but halor are you in the room by any chance he's",
    "start": "2121119",
    "end": "2126680"
  },
  {
    "text": "doing a talk at 3 p.m. this afternoon and it's going to give way more information on content security policy so you should check that one out but",
    "start": "2126680",
    "end": "2133400"
  },
  {
    "text": "content security policy is another mechanism that's basically as simple as SRI that we just looked at it's a native",
    "start": "2133400",
    "end": "2139440"
  },
  {
    "text": "control in the browser it's not something that you have to you know go deploy some agent or tool or",
    "start": "2139440",
    "end": "2144640"
  },
  {
    "text": "something and it's just a HTTP response header now you can see it buried in the middle of other HTTP response headers",
    "start": "2144640",
    "end": "2151720"
  },
  {
    "text": "there that you're probably familiar with right so you just declare your content security policy and you write the policy",
    "start": "2151720",
    "end": "2157119"
  },
  {
    "text": "in the header and then obviously the header goes down with the page now what you can do with content security policy",
    "start": "2157119",
    "end": "2163520"
  },
  {
    "text": "is you can start to take control of things like where is the page allowed to load JavaScript from now CSP does like a",
    "start": "2163520",
    "end": "2171079"
  },
  {
    "text": "hundred really useful things most people are just looking at controlling JavaScript because JavaScript is the most dangerous thing that we have on our",
    "start": "2171079",
    "end": "2176880"
  },
  {
    "text": "page so that's commonly the focus and you can see here I've declared a policy with a default source so you know",
    "start": "2176880",
    "end": "2182920"
  },
  {
    "text": "effectively like where are Source attributes allowed to load things from and then we go more specific here with a script source and we can say self so we",
    "start": "2182920",
    "end": "2190680"
  },
  {
    "text": "are allowed to load JavaScript from ourself from our own domain and we're also allowed to load JavaScript from browser loud.com because they would be",
    "start": "2190680",
    "end": "2197680"
  },
  {
    "text": "an approved vendor so we are expecting to load JavaScript from this location so now even already at this point here when",
    "start": "2197680",
    "end": "2205200"
  },
  {
    "text": "we looked at the script tag earlier and it was writing additional script tags to the Dom that were coin hype.com it's",
    "start": "2205200",
    "end": "2211200"
  },
  {
    "text": "like okay there's a script tag with a source attribute we're going to check the source attribute against the script Source directive and see if this is an",
    "start": "2211200",
    "end": "2217599"
  },
  {
    "text": "improv source of JavaScript to load onto the page and the answer would have been no it's not therefore the library would",
    "start": "2217599",
    "end": "2223720"
  },
  {
    "text": "not load that script would not load now again this is a really simple",
    "start": "2223720",
    "end": "2230119"
  },
  {
    "text": "mechanism this is a very strong protection we can stop the script from loading but even better than that you",
    "start": "2230119",
    "end": "2235560"
  },
  {
    "text": "can then ask the browser to call back to you and say I just loaded your page but",
    "start": "2235560",
    "end": "2241599"
  },
  {
    "text": "there's a script on there that's not supposed to be there so I've blocked it here's the information and it will send",
    "start": "2241599",
    "end": "2246680"
  },
  {
    "text": "you a nice little Json payload with all of the details of what happened and you just specify an address on where you",
    "start": "2246680",
    "end": "2252359"
  },
  {
    "text": "want that Json payload to be sent to so now not only can we neutralize that script tag in the page but if we do",
    "start": "2252359",
    "end": "2259319"
  },
  {
    "text": "somehow end up with a script tag in the page that shouldn't be there the browser will call back to tell you so",
    "start": "2259319",
    "end": "2264680"
  },
  {
    "text": "effectively as soon as it hits the page you're going to start getting the Telemetry to say there's a problem so content security policy is",
    "start": "2264680",
    "end": "2272480"
  },
  {
    "text": "super powerful and super underutilized like I said earlier I have a crawler that scans the top 1 million",
    "start": "2272480",
    "end": "2278480"
  },
  {
    "text": "websites in the world every day and it's a massively underutilized tool this is",
    "start": "2278480",
    "end": "2283560"
  },
  {
    "text": "an example just so you can see of what a violation report would look like that's their technical name this is the Json",
    "start": "2283560",
    "end": "2289000"
  },
  {
    "text": "payload that the browser would have dispatched in the background upon observing that script tag right so it's",
    "start": "2289000",
    "end": "2295079"
  },
  {
    "text": "like where was I I was on the homepage what got blocked this thing called coinhive decom what did it violate well",
    "start": "2295079",
    "end": "2301119"
  },
  {
    "text": "it violated the script Source directive so I know that this was a script tag in the page now if you start receiving",
    "start": "2301119",
    "end": "2306800"
  },
  {
    "text": "these he's like call to action immediately you know there's something going on now the other angle as well of",
    "start": "2306800",
    "end": "2313000"
  },
  {
    "text": "course is that if we think about the compromise the browser L library was compromised the attacker had free reign",
    "start": "2313000",
    "end": "2319760"
  },
  {
    "text": "to inject their script in there now they injected the little bootstrap which added another script tag to the Dom to",
    "start": "2319760",
    "end": "2325400"
  },
  {
    "text": "pull the library but they could have just taken all of that script and stuffed it into the original one and",
    "start": "2325400",
    "end": "2331720"
  },
  {
    "text": "then it would have still been loading from browser.com but then we can still catch things like the library has to",
    "start": "2331720",
    "end": "2337880"
  },
  {
    "text": "communicate externally and another thing that you can do with CSP is control where is the page allowed to talk to",
    "start": "2337880",
    "end": "2344000"
  },
  {
    "text": "where can we do external requests like form action or connect Source control outbound connections so even if they had",
    "start": "2344000",
    "end": "2351680"
  },
  {
    "text": "taken all of their malware the coinhive library and shoved it into the original browse allowed Library which would have",
    "start": "2351680",
    "end": "2357480"
  },
  {
    "text": "been allowed to load as soon as it starts to communicate externally to try and exfiltrate the mind cryptocurrency",
    "start": "2357480",
    "end": "2364359"
  },
  {
    "text": "we could then catch the page talking to this unexpected location so we would get a connect Source",
    "start": "2364359",
    "end": "2369599"
  },
  {
    "text": "violation once that JavaScript tried to start talking to that external domain so",
    "start": "2369599",
    "end": "2375079"
  },
  {
    "text": "there's multiple different ways that we can try and stop this you know we're not always necessarily going to stop the",
    "start": "2375079",
    "end": "2380680"
  },
  {
    "text": "script on the way in many organizations still struggle with the fact that their dependencies are Dynamic and SRI is",
    "start": "2380680",
    "end": "2386839"
  },
  {
    "text": "therefore very difficult to use because you can't always get a vendor to give you a static version to pin against so",
    "start": "2386839",
    "end": "2394000"
  },
  {
    "text": "CSP gives us multiple different avenues that we could have used to detect this attack",
    "start": "2394000",
    "end": "2400000"
  },
  {
    "text": "now attackers realized I guess when they were doing this that mining cryptocurrency wasn't the most effective",
    "start": "2400000",
    "end": "2407920"
  },
  {
    "text": "kind of use of their power if you had the ability to inject JavaScript into thousands and thousands of websites",
    "start": "2407920",
    "end": "2413560"
  },
  {
    "text": "mining you know a few dollars a day in Monero is not really very exciting so very very quickly and we saw this change",
    "start": "2413560",
    "end": "2420839"
  },
  {
    "text": "happen in like less than a year they kind of realized this isn't very effective we want to make some more money so we're just going to alter very",
    "start": "2420839",
    "end": "2427319"
  },
  {
    "text": "slightly what we're doing with our capability and from it was about 2014",
    "start": "2427319",
    "end": "2433280"
  },
  {
    "text": "onwards magecart really hit their stried they became like really popular and what",
    "start": "2433280",
    "end": "2438839"
  },
  {
    "text": "magecart did instead of injecting crypto miners or other things and I've got multiple samples of these they would",
    "start": "2438839",
    "end": "2443920"
  },
  {
    "text": "inject a tiny little key logger and it is literally like four or five lines of JavaScript the key logger I used in the",
    "start": "2443920",
    "end": "2450040"
  },
  {
    "text": "demo in the video was an actual Mage cart payload super super simple it does a basic reg X on the URL and if the URL",
    "start": "2450040",
    "end": "2457319"
  },
  {
    "text": "contains uh like you know checkout payment some you know cart something like that it would enable the key logger",
    "start": "2457319",
    "end": "2463680"
  },
  {
    "text": "and it would start binding to all of the key events and firing them out the back of the page and they were obviously",
    "start": "2463680",
    "end": "2469400"
  },
  {
    "text": "targeting credit cards they were targeting websites with payment pages and magecart started to become really",
    "start": "2469400",
    "end": "2476160"
  },
  {
    "text": "popular really quickly now it's a it's a really kind of perfect attack for them",
    "start": "2476160",
    "end": "2482160"
  },
  {
    "text": "because once they're on their page there's no real visual impact the pages functionality is not impacted you can",
    "start": "2482160",
    "end": "2488599"
  },
  {
    "text": "still go to the website pay for your thing and it will arrive but the attackers have skimmed off the copy of",
    "start": "2488599",
    "end": "2494040"
  },
  {
    "text": "your card data when you're on a payment page you're typing in all 16 digits the expiry date the security code so they're",
    "start": "2494040",
    "end": "2500079"
  },
  {
    "text": "getting all the data and what they would do is they would gather this data over a period of time and eventually once they",
    "start": "2500079",
    "end": "2506319"
  },
  {
    "text": "get to a point where they're like okay we've got enough that's when they'll start hitting all of the cards with",
    "start": "2506319",
    "end": "2511440"
  },
  {
    "text": "those fraudulent transactions so they would just sit there and skim skim skim quietly wait until they had a significant enough amount and think",
    "start": "2511440",
    "end": "2517240"
  },
  {
    "text": "think okay Now's the Time to go and if we look back at the kind of attacks that magecart have been running I mean the",
    "start": "2517240",
    "end": "2524520"
  },
  {
    "text": "ones in 2018 were probably the most notable The Ticket Master and British Airways breaches now British Airways",
    "start": "2524520",
    "end": "2530920"
  },
  {
    "text": "lost hundreds of thousands of people's credit card details obviously from all over the world they're an International",
    "start": "2530920",
    "end": "2537160"
  },
  {
    "text": "Airline same with Ticket Master they're an international platform they lost hundreds of thousands of People's Credit",
    "start": "2537160",
    "end": "2543119"
  },
  {
    "text": "Card data and this is what magecart realized was well we basically we can make more money doing this right yeah",
    "start": "2543119",
    "end": "2549640"
  },
  {
    "text": "okay cryptocurrency is kind of okay we're not making a lot but stealing credit card data was what they decided",
    "start": "2549640",
    "end": "2555960"
  },
  {
    "text": "to start doing with their new found ability to get JavaScript into your website The Ticket Master breach I mean",
    "start": "2555960",
    "end": "2562359"
  },
  {
    "text": "I've lost track of where Their fines are last time I counted they were at like $890 Million worth of fines because they",
    "start": "2562359",
    "end": "2568599"
  },
  {
    "text": "got fined by the British data regulator because they lost your name and address they got fined by the American data",
    "start": "2568599",
    "end": "2574720"
  },
  {
    "text": "Regulators because they lost people's name and address they also then um so the payment card industry which is like",
    "start": "2574720",
    "end": "2581680"
  },
  {
    "text": "the industry body that represents Visa Mastercard AMX they have this industry body called the PCI the payment card",
    "start": "2581680",
    "end": "2587280"
  },
  {
    "text": "industry and they produce a document is anyone familiar with PCI DSS anyone a compliance person I'm sorry so I'm a PCI",
    "start": "2587280",
    "end": "2594800"
  },
  {
    "text": "DSS person too and they have the DSs which is their data security standard and it sets out obviously if you're",
    "start": "2594800",
    "end": "2601240"
  },
  {
    "text": "going to use credit cards here are the rules that you must follow here are the security standards that you must ader to",
    "start": "2601240",
    "end": "2606559"
  },
  {
    "text": "now you can also get fined if you are operating not in accordance with those rules now the other thing as well",
    "start": "2606559",
    "end": "2613960"
  },
  {
    "text": "especially with Ticket Master and British Airways is if you lose like 600,000 people's credit cards there's a",
    "start": "2613960",
    "end": "2620880"
  },
  {
    "text": "cost associated with replacing the card like the physical manufacturing and issuance of the",
    "start": "2620880",
    "end": "2626400"
  },
  {
    "text": "card and and then they send you the bill so you have to pay for all of the cards that you lost so this is a really",
    "start": "2626400",
    "end": "2633240"
  },
  {
    "text": "expensive thing for these two organizations and it all stems from they had like four lines of JavaScript",
    "start": "2633240",
    "end": "2639920"
  },
  {
    "text": "on their website so Mage cot there was literally last month another massive",
    "start": "2639920",
    "end": "2645359"
  },
  {
    "text": "Mage cart breach where an organization lost a couple hundred thousand People's Credit Card details because they ended up with just a few lines of JavaScript",
    "start": "2645359",
    "end": "2651880"
  },
  {
    "text": "in the page so they're still ongoing these are just the ones that made like major headlines there's literally tens",
    "start": "2651880",
    "end": "2657640"
  },
  {
    "text": "and tens of these attacks every year all because somebody found a way to get JavaScript in that shouldn't be there",
    "start": "2657640",
    "end": "2664319"
  },
  {
    "text": "now the attacks are really simple right they've they got to find some kind of injection point they need a way to get",
    "start": "2664319",
    "end": "2669559"
  },
  {
    "text": "their script in the page nowadays this is not going to be by compromising you",
    "start": "2669559",
    "end": "2674800"
  },
  {
    "text": "now like if we look at every single Mage cart attack in recent history they are all a compromise of one of your",
    "start": "2674800",
    "end": "2680720"
  },
  {
    "text": "dependencies so they're not even coming after you anymore they're just going straight for the dependency because in",
    "start": "2680720",
    "end": "2686800"
  },
  {
    "text": "most scenarios if you look at you know Ticket Master or British Airways infrastructure like you know they're doing a pretty good job right they've",
    "start": "2686800",
    "end": "2692559"
  },
  {
    "text": "got a security you look at the vendor and they don't it's like you know an eight person",
    "start": "2692559",
    "end": "2698599"
  },
  {
    "text": "team and they don't have a security person the other cool thing with going after the dependency of course is the",
    "start": "2698599",
    "end": "2703640"
  },
  {
    "text": "thousands and thousands of other websites you get you know the Ticket Master one they were only going after Ticket Master and they accidentally",
    "start": "2703640",
    "end": "2709280"
  },
  {
    "text": "hacked a couple hundred other websites as well because they got it for free but they did the analysis on Ticket Master",
    "start": "2709280",
    "end": "2715359"
  },
  {
    "text": "they found the weakest dependency and they went for that so there's got to be some breach somewhere it's typically not",
    "start": "2715359",
    "end": "2721760"
  },
  {
    "text": "going to be you of course the injection of script then is the easy part we just load up either a Bo strapping the",
    "start": "2721760",
    "end": "2727559"
  },
  {
    "text": "dependency to pull in our malicious payload or in a lot of the key logging ones they'll just put the key logger straight in because it is literally a",
    "start": "2727559",
    "end": "2733760"
  },
  {
    "text": "few lines of JavaScript and then as we said they always have to exultate something from the page this is one of",
    "start": "2733760",
    "end": "2739720"
  },
  {
    "text": "the other opportunities to stop these attacks once they get their key logger in they have to get the logged keys out",
    "start": "2739720",
    "end": "2746520"
  },
  {
    "text": "so there's got to be some kind of exfiltration a lot of people Overlook content security policy here is a",
    "start": "2746520",
    "end": "2751599"
  },
  {
    "text": "detection mechanism for this because if you're loading the dependency and the dependency is compromised",
    "start": "2751599",
    "end": "2757880"
  },
  {
    "text": "it's like well CSP will still allow the the compromise dependency in but you can catch the data extration out so with the",
    "start": "2757880",
    "end": "2765760"
  },
  {
    "text": "combination of content security policy and sub resource Integrity you've got a really really powerful protection",
    "start": "2765760",
    "end": "2772559"
  },
  {
    "text": "against this but without those two things it's just the freefor all those",
    "start": "2772559",
    "end": "2777839"
  },
  {
    "text": "script tags are literally the blank check for JavaScript when you put one of those on your application you are giving",
    "start": "2777839",
    "end": "2783400"
  },
  {
    "text": "somebody free reign to deploy whatever code they want into your website at any point they like so now whenever I look",
    "start": "2783400",
    "end": "2789839"
  },
  {
    "text": "at a script tag I just cannot see past the fact that this is just like a major",
    "start": "2789839",
    "end": "2794960"
  },
  {
    "text": "code injection opportunity for anybody that wants it so I want to wrap it up there I want to leave around 10 minutes",
    "start": "2794960",
    "end": "2800800"
  },
  {
    "text": "for questions which we're looking pretty good with actually so opportunity now open this up to the floor I've got a",
    "start": "2800800",
    "end": "2806280"
  },
  {
    "text": "couple of other things that I want to show you as well um kind of like live demo usually fails uh but first of all",
    "start": "2806280",
    "end": "2811520"
  },
  {
    "text": "are there any questions so far Yeah question",
    "start": "2811520",
    "end": "2818839"
  },
  {
    "text": "that okay so what so effectively like what was the um what was the initial",
    "start": "2824359",
    "end": "2830319"
  },
  {
    "text": "compromise of the browser L Library so yeah they they never",
    "start": "2830319",
    "end": "2836079"
  },
  {
    "text": "officially confirmed this so caveat that based on um you know my extensive",
    "start": "2836079",
    "end": "2843160"
  },
  {
    "text": "discussions and observations and things like that uh either one of their staff members was using weak credentials on",
    "start": "2843160",
    "end": "2848839"
  },
  {
    "text": "the S3 bucket where the file was or they got their credentials fished and the attackers simply logged in and changed",
    "start": "2848839",
    "end": "2854880"
  },
  {
    "text": "the browser loud Javascript file so they never confirmed it either way but looking at all of the things that I know",
    "start": "2854880",
    "end": "2860400"
  },
  {
    "text": "those are the only two realistic opportunities that I can see for this to have happened because Amazon certainly",
    "start": "2860400",
    "end": "2865760"
  },
  {
    "text": "didn't get compromised yes do you know how long been there before were discovered by",
    "start": "2865760",
    "end": "2871839"
  },
  {
    "text": "accident yeah good question how long had it been there before we discovered it by accident",
    "start": "2871839",
    "end": "2878240"
  },
  {
    "text": "this is a super tough one to answer um because the vendor wouldn't tell us if they had any logging on their side which",
    "start": "2878240",
    "end": "2884240"
  },
  {
    "text": "is it kind of sounded like they didn't I used a few of the tools online uh most notably the internet archive and the",
    "start": "2884240",
    "end": "2890040"
  },
  {
    "text": "Wayback machine that thing is so cool so you can go and you know go to a website in the way back machine and just like",
    "start": "2890040",
    "end": "2896040"
  },
  {
    "text": "scroll back time into like the last index copies of the page so we kind of went as far back as we could and it will",
    "start": "2896040",
    "end": "2902599"
  },
  {
    "text": "even pull down the pages dependencies and then obviously we can inspect the dependencies so looking at the way back machine it",
    "start": "2902599",
    "end": "2909480"
  },
  {
    "text": "hadn't been there very long but it it was It was kind of tricky to say I would",
    "start": "2909480",
    "end": "2914920"
  },
  {
    "text": "I would say maybe a couple weeks is like the the definite evidence that we have you can go to the way back machine now",
    "start": "2914920",
    "end": "2920280"
  },
  {
    "text": "after this and you can roll back time and you can see you know like infection infection infection okay there was no",
    "start": "2920280",
    "end": "2925960"
  },
  {
    "text": "infection four months ago so somewhere between now and then the file",
    "start": "2925960",
    "end": "2931440"
  },
  {
    "text": "changed yeah so the csb",
    "start": "2931440",
    "end": "2938720"
  },
  {
    "text": "s yeah",
    "start": "2941480",
    "end": "2948319"
  },
  {
    "text": "CSP",
    "start": "2951240",
    "end": "2954240"
  },
  {
    "text": "understand",
    "start": "2958200",
    "end": "2961200"
  },
  {
    "text": "y yeah so so effectively the question was around like the more advanced",
    "start": "2965280",
    "end": "2970440"
  },
  {
    "text": "capabilities of content security policy so the example that I gave you there was",
    "start": "2970440",
    "end": "2975480"
  },
  {
    "text": "um you know as you kind of said like the more traditional approach where you're going to have like a host-based list to",
    "start": "2975480",
    "end": "2981240"
  },
  {
    "text": "say you know these are the locations that I want to load JavaScript from so you know if it loads from one of these",
    "start": "2981240",
    "end": "2987359"
  },
  {
    "text": "locations it's fine and if it doesn't then we don't load it the problem with the host based list is you know you've",
    "start": "2987359",
    "end": "2992839"
  },
  {
    "text": "got to maintain it you've got to know what all the hosts are um and sometimes people allow hosts that have like Json",
    "start": "2992839",
    "end": "2998680"
  },
  {
    "text": "PM points that effectively allow the return of arbitrary script which is a really bad idea so I won't answer it",
    "start": "2998680",
    "end": "3004880"
  },
  {
    "text": "kind of too deeply you should definitely go to Halo's talk at 3:00 this afternoon but um the nonpaced approach is probably",
    "start": "3004880",
    "end": "3011760"
  },
  {
    "text": "one of my favorite ones um so if I go to our website like full transparency this",
    "start": "3011760",
    "end": "3016880"
  },
  {
    "text": "is me um and we take a look at the injection of our script tags into the",
    "start": "3016880",
    "end": "3022359"
  },
  {
    "text": "page now let's just go view source and we'll go bigger um the the non based approach is slightly",
    "start": "3022359",
    "end": "3029240"
  },
  {
    "text": "different in that we have this non attribute on all of our script tags uh down there at the bottom and what you",
    "start": "3029240",
    "end": "3036720"
  },
  {
    "text": "can do is instead of allowing the script to load based on the source attribute you can allow it to load based on the",
    "start": "3036720",
    "end": "3042319"
  },
  {
    "text": "nons attribute and if I reload the page what you'll be able to see is every time",
    "start": "3042319",
    "end": "3047559"
  },
  {
    "text": "I reload it you can see that that tag is changing so nons is an abbreviation for number once so you inject the nons into",
    "start": "3047559",
    "end": "3055359"
  },
  {
    "text": "the CSP header and you inject the nons into the script tags and the rule then becomes the script tag is only allowed",
    "start": "3055359",
    "end": "3061760"
  },
  {
    "text": "to load if the nons in the header matches the nons in the page so every time I reload the page reload the page",
    "start": "3061760",
    "end": "3067760"
  },
  {
    "text": "reload the page you can see the values rotating so if an attacker injects a script tag directly into my application",
    "start": "3067760",
    "end": "3073760"
  },
  {
    "text": "into my page obviously they can't know the nons because it constantly changes",
    "start": "3073760",
    "end": "3079440"
  },
  {
    "text": "and they can't guess it because it's sufficient sufficiently strong random value so the non-space approach is much",
    "start": "3079440",
    "end": "3086280"
  },
  {
    "text": "more flexible in certain circumstances I imagine I don't know what Hal was going to talk about I saw he talking the",
    "start": "3086280",
    "end": "3091440"
  },
  {
    "text": "agenda and it's like an advanced content security policy talk so I would bet that this will be in there um but at a high",
    "start": "3091440",
    "end": "3097240"
  },
  {
    "text": "level yeah there are different approaches within CSP than the host-based approach and there are different benefits to those as",
    "start": "3097240",
    "end": "3104799"
  },
  {
    "text": "well",
    "start": "3104799",
    "end": "3107799"
  },
  {
    "text": "yes so the actual infection of coinhive and there it was on Norwegian sites as well",
    "start": "3113400",
    "end": "3121160"
  },
  {
    "text": "okay wow so there was Norwegian government websites in the coinhive breach as well just one I bet it was",
    "start": "3124839",
    "end": "3131880"
  },
  {
    "text": "more than one officially",
    "start": "3131880",
    "end": "3138000"
  },
  {
    "text": "one oh nice without okay so it was there at least",
    "start": "3140040",
    "end": "3145640"
  },
  {
    "text": "three weeks",
    "start": "3145640",
    "end": "3148519"
  },
  {
    "text": "okay I wased because I couldn't y so we",
    "start": "3154440",
    "end": "3161880"
  },
  {
    "text": "contacted so there were Norwegian government websites that or at least officially the government person said",
    "start": "3166280",
    "end": "3171680"
  },
  {
    "text": "just the one um impacted in that browser loud breach as well it was it was pretty",
    "start": "3171680",
    "end": "3177040"
  },
  {
    "text": "wild when it happened and if we go to like the US Courts website now and let",
    "start": "3177040",
    "end": "3183319"
  },
  {
    "text": "me just get my mouse I can't fly on a trackpad now we're getting serious it needs a",
    "start": "3183319",
    "end": "3188400"
  },
  {
    "text": "mouse so it was like the weird thing",
    "start": "3188400",
    "end": "3193920"
  },
  {
    "text": "is um we have the SRI hash generating tool on report your eyes so there's a bunch of there's loads of tools that do",
    "start": "3193920",
    "end": "3200000"
  },
  {
    "text": "this now obviously so you can just take the URL of an asset if you have a script tag that doesn't have the Integrity",
    "start": "3200000",
    "end": "3205960"
  },
  {
    "text": "attribute and you want it you just drop the URL in there and we'll fetch it hash it and give you the script tag super simple super easy there's now like a 100",
    "start": "3205960",
    "end": "3212400"
  },
  {
    "text": "tools that will do this for you as well but I generated um the script tag to kind of",
    "start": "3212400",
    "end": "3219680"
  },
  {
    "text": "like solve the problem and now if I just find the original let me just go full",
    "start": "3219680",
    "end": "3225359"
  },
  {
    "text": "screen browse [Music] alloud um here so whoa what NOP we want",
    "start": "3225359",
    "end": "3234319"
  },
  {
    "text": "to go there and then I want my Zoom tool so that all of you can",
    "start": "3234319",
    "end": "3239480"
  },
  {
    "text": "see there we go so yeah like that's the script tag as I said the vendor finally",
    "start": "3239480",
    "end": "3245079"
  },
  {
    "text": "agreed to give us a version path this was a version that they agreed that we could lock to and I generated the script tag to give to the ncsc who then shared",
    "start": "3245079",
    "end": "3252880"
  },
  {
    "text": "it with our foreign allies and this is the script tag that I generated and only I know that and only",
    "start": "3252880",
    "end": "3260079"
  },
  {
    "text": "I you know there's no way of proving this but um you can do the Sha 256 sha 384 and the Sha 512 hash of the file as",
    "start": "3260079",
    "end": "3268160"
  },
  {
    "text": "well so that obviously if we have a deprecate sh 256 in the future the script tag is future compatible and it",
    "start": "3268160",
    "end": "3273440"
  },
  {
    "text": "will stay it will stay operational um but that's the script tag that I gave them like and that's the one",
    "start": "3273440",
    "end": "3280319"
  },
  {
    "text": "that got shared if you see that script tag on government websites it's it came from me and that's like my weird little",
    "start": "3280319",
    "end": "3285520"
  },
  {
    "text": "proud thing in this um and no there's no way of knowing that there's no way of proving that but I'm happy with it",
    "start": "3285520",
    "end": "3291079"
  },
  {
    "text": "because I know now the weird thing is you mentioned there that you spoke to browser loud and they wouldn't give you",
    "start": "3291079",
    "end": "3297400"
  },
  {
    "text": "um the version to pin against and this is now their most recent solution and",
    "start": "3297400",
    "end": "3303200"
  },
  {
    "text": "this is absolutely Dreadful so this 3.1.0 is now effectively like their",
    "start": "3303200",
    "end": "3308559"
  },
  {
    "text": "bootstrap so they pull this in and what they do anyone tell me if you see a problem with this right they then start",
    "start": "3308559",
    "end": "3315839"
  },
  {
    "text": "appending all of their script tags to the Dom and then they fetch the the SRI hashes of those",
    "start": "3315839",
    "end": "3323160"
  },
  {
    "text": "attributes from themselves and then they check their own files against their own hashes that they",
    "start": "3323160",
    "end": "3330119"
  },
  {
    "text": "provided I like but they came back and they were like we now use SRI I was like",
    "start": "3330119",
    "end": "3336960"
  },
  {
    "text": "that's not how any of this works that's not I was like this is literally the most pointless implementation of Sri",
    "start": "3336960",
    "end": "3342039"
  },
  {
    "text": "because all it does is it fetches the hashes it puts them into the script tag and then it puts the script tag on the Dom so if you go if we go back and look",
    "start": "3342039",
    "end": "3349160"
  },
  {
    "text": "at that website now at a glance when they add all of their libraries it looks",
    "start": "3349160",
    "end": "3354960"
  },
  {
    "text": "like they using SRI because you can see all of the Integrity attributes on all of their script tags but they were all",
    "start": "3354960",
    "end": "3361720"
  },
  {
    "text": "added there by their own bootstrap that pulls them from this CH I was like this",
    "start": "3361720",
    "end": "3367359"
  },
  {
    "text": "is the dumbest idea ever cut that part of the video um so I was just like I give up I",
    "start": "3367359",
    "end": "3374200"
  },
  {
    "text": "actually just give up like that sometimes you just can't help people because they don't want to be helped so",
    "start": "3374200",
    "end": "3379440"
  },
  {
    "text": "yeah like it it's still just as bad as it was now because they're just checking their own answers it's like letting a",
    "start": "3379440",
    "end": "3385240"
  },
  {
    "text": "kid check their own homework I got an A+ um so I digress yes so I read the book",
    "start": "3385240",
    "end": "3394200"
  },
  {
    "text": "Trac yes many really good um really good",
    "start": "3394200",
    "end": "3402359"
  },
  {
    "text": "book many respons yeah so weirdly as well I",
    "start": "3402359",
    "end": "3410280"
  },
  {
    "text": "did an interview in Copenhagen with Andy Greenberg about six months ago it's like the middle of last year and this is one",
    "start": "3410280",
    "end": "3415880"
  },
  {
    "text": "of the things things that we talked about and I'd given him the Monero address to see if they could find anything out about the hacking",
    "start": "3415880",
    "end": "3421839"
  },
  {
    "text": "Collective uh behind it based on the address to see if they could figure out anything he works with um it's I think",
    "start": "3421839",
    "end": "3427920"
  },
  {
    "text": "it's a Norwegian company as well actually it's like chain I think they call it like chainalysis is the company it's like chain analysis um I was like",
    "start": "3427920",
    "end": "3435720"
  },
  {
    "text": "see if you can find anything out about who did this and and what they did um ultimately I guess they used Monero",
    "start": "3435720",
    "end": "3442039"
  },
  {
    "text": "because it's very difficult to do that um but yeah there's we I stopped looking when I was looking",
    "start": "3442039",
    "end": "3448520"
  },
  {
    "text": "at government sites is the answer so we know I've got the list on my article that I published is like 5,800 sites",
    "start": "3448520",
    "end": "3454680"
  },
  {
    "text": "that were infected in there um and there's obviously ones that we miss cuz you know I guess you don't have. goov in",
    "start": "3454680",
    "end": "3460839"
  },
  {
    "text": "your domains no so like I was just focusing on things that contain. goov and I got to 5,800 pretty quickly so",
    "start": "3460839",
    "end": "3468599"
  },
  {
    "text": "this must have been massive um it' be an interesting piece of research if anybody wants to do that to see how many just",
    "start": "3468599",
    "end": "3474839"
  },
  {
    "text": "websites not government ites but just nor you know websites in the world were impacted it must be how many bullets how",
    "start": "3474839",
    "end": "3482640"
  },
  {
    "text": "many how many bullets how many bullets buets oh",
    "start": "3482640",
    "end": "3487839"
  },
  {
    "text": "wallets one we only ever saw so for this particular one it was",
    "start": "3487839",
    "end": "3495680"
  },
  {
    "text": "only ever used it was one and if we again it's very difficult we had to go through the way back machine and check all the script files but it was always",
    "start": "3495680",
    "end": "3501640"
  },
  {
    "text": "the same wallet and we've also never seen that used anywhere else so there's nothing that's why I asked if Andy could",
    "start": "3501640",
    "end": "3507799"
  },
  {
    "text": "do anything with his contacts to see if he could link them somehow but in terms of just looking directly at the wallet address there was only one and it was",
    "start": "3507799",
    "end": "3514960"
  },
  {
    "text": "only using this attack and there was only one used they never changed it I guess because they probably didn't want",
    "start": "3514960",
    "end": "3520559"
  },
  {
    "text": "to keep going back and touching the file in S3 to you know potentially alert someone or leave a trail or something so",
    "start": "3520559",
    "end": "3526520"
  },
  {
    "text": "they just literally dropped it there and walked away and that was it yes",
    "start": "3526520",
    "end": "3534920"
  },
  {
    "text": "yeah what was the purpose of obca it I don't know really so this is a very",
    "start": "3537119",
    "end": "3542599"
  },
  {
    "text": "common approach to kind of like do this weird hex encoding thing as well and it always basically means as soon as you",
    "start": "3542599",
    "end": "3547880"
  },
  {
    "text": "look at that you you've effectively like guaranteed that you found the injection point because no normal person does this",
    "start": "3547880",
    "end": "3553920"
  },
  {
    "text": "that I've ever seen so as soon as I saw that just based on my experience I was like this is it we can stop looking now",
    "start": "3553920",
    "end": "3560079"
  },
  {
    "text": "like we found the the thing I guess if they were to just leave it looking like this",
    "start": "3560079",
    "end": "3567319"
  },
  {
    "text": "like it's more immediately obvious that it's bad but for me looking at the previous one that's only immediately",
    "start": "3567760",
    "end": "3573720"
  },
  {
    "text": "obvious that's bad because I know kind of what to look for so people might just",
    "start": "3573720",
    "end": "3579000"
  },
  {
    "text": "skip over that and be like oh I don't really understand I don't know what it is but if somebody looks at this one you know you can more quickly figure out",
    "start": "3579000",
    "end": "3585119"
  },
  {
    "text": "well hang on a minute like this is not good so I don't know maybe they're trying to just slow us down confuse",
    "start": "3585119",
    "end": "3593079"
  },
  {
    "text": "people sorry",
    "start": "3593079",
    "end": "3597079"
  },
  {
    "text": "it's if you ever find them ask them and tell me tell me what they say um but",
    "start": "3598280",
    "end": "3603480"
  },
  {
    "text": "yeah it would be interesting it's it's obviously not hugely effective and it's really really obvious but maybe they",
    "start": "3603480",
    "end": "3610400"
  },
  {
    "text": "just do that because that's what they've always done I don't know um but yes they're not going to the reason they",
    "start": "3610400",
    "end": "3615640"
  },
  {
    "text": "didn't just shove the coin hyp library in is because it's massive so I understand why they did the bootstrap I don't understand why they OB fiscated",
    "start": "3615640",
    "end": "3621400"
  },
  {
    "text": "like that just to throw people off I guess speculate go ahead so like we're security security engineers and",
    "start": "3621400",
    "end": "3627880"
  },
  {
    "text": "researchers so to us it's very obvious yes but to someone else that might just be maintaining the S it's like oh that",
    "start": "3627880",
    "end": "3635119"
  },
  {
    "text": "looks scary I better touch it because that might break something yeah and",
    "start": "3635119",
    "end": "3640160"
  },
  {
    "text": "depending on how they actually affect the browser lab if you do it this way um",
    "start": "3640160",
    "end": "3645559"
  },
  {
    "text": "and you're sending screens and you're sending SP you have a few spaces I can see that but you might break things if",
    "start": "3645559",
    "end": "3650880"
  },
  {
    "text": "you send in this might be a more secure way to 64 that is CH code but a64 is",
    "start": "3650880",
    "end": "3658720"
  },
  {
    "text": "another example of it you don't want to have it's just it is yeah but it's a good",
    "start": "3658720",
    "end": "3665160"
  },
  {
    "text": "speculation so effectively you know there's a couple things in there for the benefit of everyone in the room um you",
    "start": "3665160",
    "end": "3670400"
  },
  {
    "text": "know we don't want to have any kind of negative impact on the code below obviously because we always want to go undetected for as long as we can I only",
    "start": "3670400",
    "end": "3678000"
  },
  {
    "text": "notice that that's bad because I'm like a security researcher which is a valid point I don't think everybody would look at this and be immediately concerned",
    "start": "3678000",
    "end": "3684240"
  },
  {
    "text": "like I was um but yeah look I'm happy to take more questions I'll be in the",
    "start": "3684240",
    "end": "3689559"
  },
  {
    "text": "coffee area now we're just about finished on time there thank you very much for coming everybody",
    "start": "3689559",
    "end": "3696280"
  }
]