[
  {
    "text": "hi everyone how we doing all good thanks for uh thanks for being here today uh",
    "start": "2200",
    "end": "10160"
  },
  {
    "text": "it's I've been trying to get into this conference for about five years I guess so today is finally the day I'm here",
    "start": "10160",
    "end": "16920"
  },
  {
    "text": "with you in Norway and uh well I would love to welcome you in Norwegian who's Norwegian here Norwegian I can't speak",
    "start": "16920",
    "end": "24359"
  },
  {
    "text": "Norwegian I can do a little bit of Swedish apparently and from I have a lot of Swedish and Norwegian colag and",
    "start": "24359",
    "end": "30439"
  },
  {
    "text": "apparently if you speak swor which is mixture of the swed speak Swedish and the Norwegian speak Norwegians that",
    "start": "30439",
    "end": "36719"
  },
  {
    "text": "conversation goes flawlessly so let's see if that goes so if I would say in",
    "start": "36719",
    "end": "42718"
  },
  {
    "text": "Swedish software that would make sense to the",
    "start": "43920",
    "end": "50120"
  },
  {
    "text": "Norwegians right all right good good good good good now there's a little bit more pleasantries to go through before",
    "start": "50120",
    "end": "56920"
  },
  {
    "text": "we can actually get to the heart of this presentation so what I want to do is I want to present you three distinct",
    "start": "56920",
    "end": "62199"
  },
  {
    "text": "statements of the topic we're going to talk about I'm I'm going to keep it quite General we we'll talk about web acceleration and and the impacts of that",
    "start": "62199",
    "end": "70280"
  },
  {
    "text": "and I've done this a bunch of times today I think it's my 340th I keep track of all of them and I do it to treat",
    "start": "70280",
    "end": "75960"
  },
  {
    "text": "distinct statements and it's it's the setup isn't ideal but let's try to do some crowd participation if we can right",
    "start": "75960",
    "end": "83600"
  },
  {
    "text": "because this is a really interesting and big venue now for those who are watching this from home I'm on a suspended stage",
    "start": "83600",
    "end": "89640"
  },
  {
    "text": "across cross an arena and we have Arena seats here so let's try this okay so",
    "start": "89640",
    "end": "94720"
  },
  {
    "text": "people here at NDC I'm not sure if they're going to hear you back there but are you ready for this okay not bad no bad let's try one",
    "start": "94720",
    "end": "101720"
  },
  {
    "text": "more time are we ready for this wonderful wonderful so do we agree that slow websites",
    "start": "101720",
    "end": "109320"
  },
  {
    "text": "suck okay wonderful wonderful that's one out of tree that's just to make sure we're on the same page so we got that",
    "start": "109320",
    "end": "115600"
  },
  {
    "text": "out of the way let's start with number two do we agree that weap performance is",
    "start": "115600",
    "end": "120719"
  },
  {
    "text": "an essential part of the U experience yes okay good two out of three here's the controversial one the",
    "start": "120719",
    "end": "127600"
  },
  {
    "text": "one that usually doesn't get a yes or no reaction but usually a me reaction do we",
    "start": "127600",
    "end": "134200"
  },
  {
    "text": "agree that a slow website is just as bad as a website that is down see me yeah",
    "start": "134200",
    "end": "141640"
  },
  {
    "text": "maybe so now regardless of your opinion here are the facts and your facts unfortunately don't care about your",
    "start": "141640",
    "end": "147120"
  },
  {
    "text": "opinion if your website is slow or your website is down you will lose money you will lose",
    "start": "147120",
    "end": "154519"
  },
  {
    "text": "space and you might even lose a bit of that Google page rank you are so craving",
    "start": "154519",
    "end": "161599"
  },
  {
    "text": "for so that's the situation how do we resolve it well there's a variety of ways of tackling this let's start at a",
    "start": "161599",
    "end": "168000"
  },
  {
    "text": "at a very symptomatic uh type of behavior what we could do is throw",
    "start": "168000",
    "end": "173519"
  },
  {
    "text": "servers at the problem so if your website is slow a lot of people think well if we're slow it's probably caus",
    "start": "173519",
    "end": "179840"
  },
  {
    "text": "cused by some sort of capacity issue so we need to add capacity a lot of people think that way in a very symptomatic uh",
    "start": "179840",
    "end": "186920"
  },
  {
    "text": "style and I would say that's not the way forward that's not a sustainable solution so sustainable not just from a",
    "start": "186920",
    "end": "193159"
  },
  {
    "text": "environmental point of view but also from a financial point of view and operational point of view that doesn't work however when the house is on fire",
    "start": "193159",
    "end": "200959"
  },
  {
    "text": "and firefighting is needed on a shortterm basis you might want to add Surfers that that could work then but as",
    "start": "200959",
    "end": "206239"
  },
  {
    "text": "the famous poet notorious b once said more money more servers more problems so",
    "start": "206239",
    "end": "212720"
  },
  {
    "text": "let's just forget about that and let's not think about adding capacity let's try a different",
    "start": "212720",
    "end": "218400"
  },
  {
    "text": "approach the approach being identify the slowest parts of our application of our",
    "start": "218400",
    "end": "224120"
  },
  {
    "text": "runtime maybe even and optimize it sensible advice right we could we could",
    "start": "224120",
    "end": "229760"
  },
  {
    "text": "live with that and we can go top down bottom up if we go top down we could say we can optimize the HTML and the CSS and",
    "start": "229760",
    "end": "236319"
  },
  {
    "text": "the JavaScript or your application code sitting behind or some of the Frameworks or framework dependencies maybe some",
    "start": "236319",
    "end": "242760"
  },
  {
    "text": "operating system components and runtime dependencies your web server your database server literally anything your",
    "start": "242760",
    "end": "248760"
  },
  {
    "text": "your network your data center you name it and optimize those elements to get better performance and I'd say go for it",
    "start": "248760",
    "end": "256079"
  },
  {
    "text": "very sensible advice right there however after a while you'll hit the point of",
    "start": "256079",
    "end": "262199"
  },
  {
    "text": "diminishing returns meaning the amount of time you invest in making it faster will not continuously yield the same",
    "start": "262199",
    "end": "269800"
  },
  {
    "text": "results you can't optimize your way out of a scalability issue so you need something more impactful and that's",
    "start": "269800",
    "end": "275919"
  },
  {
    "text": "where we come to the topic of this presentation I would advise you to use caching technology now I represent a",
    "start": "275919",
    "end": "281680"
  },
  {
    "text": "specific kind of caching technology but from a philosophical point of view I would say why would you recompute data",
    "start": "281680",
    "end": "289800"
  },
  {
    "text": "if the content doesn't change why go through your application run times to your web servers bootstrap the",
    "start": "289800",
    "end": "295320"
  },
  {
    "text": "Frameworks run it connect to the database maybe some external API calls everything every single time when the",
    "start": "295320",
    "end": "301240"
  },
  {
    "text": "data doesn't change that's the topic of the day and I love to use when I talk about caching as",
    "start": "301240",
    "end": "307479"
  },
  {
    "text": "a way of accelerating growing scaling I love to use the metaphor of the boxes",
    "start": "307479",
    "end": "312800"
  },
  {
    "text": "because caching is nothing more than storing pre-computed results in boxes for later use now that being said hi",
    "start": "312800",
    "end": "318880"
  },
  {
    "text": "everyone here at the Oslo Spectrum my name is t that's how you pronounce that I'm a Dutch speaking Belgium as you've",
    "start": "318880",
    "end": "325240"
  },
  {
    "text": "heard in the beginning I do a little bit of Swedish just a bit the kind I learned on Dual Bingo and I'm the tech",
    "start": "325240",
    "end": "331000"
  },
  {
    "text": "evangelist at a company called varnish software the author of getting started with varnish cash an old book I wrote",
    "start": "331000",
    "end": "337680"
  },
  {
    "text": "with O'Reilly Back in the Day 2016 but I have a new one well new it's been out",
    "start": "337680",
    "end": "343160"
  },
  {
    "text": "since I guess 2020 two right uh and it's called",
    "start": "343160",
    "end": "348840"
  },
  {
    "text": "varnish s by example I have a free copy here to raffle it's a big boy 778 Pages",
    "start": "348840",
    "end": "354600"
  },
  {
    "text": "two kilos right here for you and the story behind that is during the pandemic I had a lot of time to write and the",
    "start": "354600",
    "end": "360360"
  },
  {
    "text": "lockdowns were longer than I expected so this is it I'm not going home with this uh I'm going to leave this here and",
    "start": "360360",
    "end": "365680"
  },
  {
    "text": "whoever wants it can grab it now I work for a company called varnish software by show of hands who has heard of varnish",
    "start": "365680",
    "end": "372120"
  },
  {
    "text": "software great because if there's one country in the world on the entire",
    "start": "372120",
    "end": "377520"
  },
  {
    "text": "planet where they should know us it should be here in Oslo because not only",
    "start": "377520",
    "end": "382680"
  },
  {
    "text": "are we a company that builds Enterprise great software deliv content delivery and software acceleration software we're",
    "start": "382680",
    "end": "388199"
  },
  {
    "text": "also the company behind the open source project varnish cash which was founded here in Ola back in the day now for",
    "start": "388199",
    "end": "395360"
  },
  {
    "text": "those of you who don't know the backstory for the Norwegians out here who knows verin gong VG",
    "start": "395360",
    "end": "401599"
  },
  {
    "text": "vg.no well in fact this technology was invented by a couple of Engineers uh",
    "start": "401599",
    "end": "407080"
  },
  {
    "text": "there because they had scalability issues so if you follow the timeline back in the day in 2005 they came up",
    "start": "407080",
    "end": "412360"
  },
  {
    "text": "with that so what they had was they used uh squid which is a proxy a forward",
    "start": "412360",
    "end": "417400"
  },
  {
    "text": "proxy started using it as a reverse proxy didn't yield enough performance they needed too many servers to get the",
    "start": "417400",
    "end": "422879"
  },
  {
    "text": "job done so they said couple of clever Engineers they had let's build something and they brought on and I would like to",
    "start": "422879",
    "end": "428639"
  },
  {
    "text": "warn you this is a very Scandinavian story is so we're in Norway we're in Oslo they're looking for someone to help",
    "start": "428639",
    "end": "435400"
  },
  {
    "text": "them that has the skills to do this to make something really fast and who has the kernel capabilities or the inside",
    "start": "435400",
    "end": "441840"
  },
  {
    "text": "knowledge of the kernels to make it happen so they contact a Danish guy named P Henning Kamp and they start a",
    "start": "441840",
    "end": "447240"
  },
  {
    "text": "project specifically for verden's G but with the mindset of open sourcing it later on so that's how it starts and",
    "start": "447240",
    "end": "454160"
  },
  {
    "text": "after a while it gets so popular if you look at the stats right there it's used by about 10 million active websites 22%",
    "start": "454160",
    "end": "459800"
  },
  {
    "text": "of the top 10,000 websites and that Docker image we have is already downloaded 10 million times so it's a popular open source project and",
    "start": "459800",
    "end": "466520"
  },
  {
    "text": "Commercial product but it became a commercial product because there was so much demand for support so right here in",
    "start": "466520",
    "end": "472840"
  },
  {
    "text": "uh in Oslo there's a company called uh linpro it's an open source agency they",
    "start": "472840",
    "end": "478479"
  },
  {
    "text": "merged with the Swedish company uh red pill and out of that came varnish software which is a Swedish company",
    "start": "478479",
    "end": "484159"
  },
  {
    "text": "which makes it again very Scandinavian and that's how it got started now I work on open source I evangelize open source",
    "start": "484159",
    "end": "490479"
  },
  {
    "text": "however I also work on the Enterprise part which makes us a company that is well established in the content delivery",
    "start": "490479",
    "end": "497319"
  },
  {
    "text": "World Edge compute world so yes we make websites faster that's how I explain it",
    "start": "497319",
    "end": "502680"
  },
  {
    "text": "to my uh to my mom and my kids yes we make the the web faster we enhance digital experiences by lowering Network",
    "start": "502680",
    "end": "509159"
  },
  {
    "text": "l which is pretty much our CDN play you can use these caches to make cdns and the the claim would be that we are a",
    "start": "509159",
    "end": "515680"
  },
  {
    "text": "company that buils software defined web acceleration and content delivery solution the last thing I tell you about",
    "start": "515680",
    "end": "521880"
  },
  {
    "text": "us before I start digging in is our claim to fame here is that our software varnish software again developed",
    "start": "521880",
    "end": "529399"
  },
  {
    "text": "primarily here in Oslo can handle 1.3 terabits per second on a single machine",
    "start": "529399",
    "end": "534880"
  },
  {
    "text": "this is software only running on commercials of the Shelf Hardware as benchmarked by Intel they run it of",
    "start": "534880",
    "end": "540720"
  },
  {
    "text": "course it's a big it's a big stack you need to get it done but it's commercial off the shelf I can give you the shopping list you can buy the hardware",
    "start": "540720",
    "end": "547000"
  },
  {
    "text": "and in the lab situation you'll have that level of true put but also that 1.17 gigabits per second per watt that's",
    "start": "547000",
    "end": "553120"
  },
  {
    "text": "the efficiency levels and that's what we're going to talk about today so in a typical scenario the end user will",
    "start": "553120",
    "end": "558680"
  },
  {
    "text": "connect to a server to get a web page an API Files video streaming whatever you",
    "start": "558680",
    "end": "564440"
  },
  {
    "text": "use over HTTP pull in Docker imagees you name it but you know the obvious risk right when you do this at scale while",
    "start": "564440",
    "end": "571279"
  },
  {
    "text": "the server will end up under pressure could be because there's too many simultaneous requests to too many",
    "start": "571279",
    "end": "576360"
  },
  {
    "text": "clients or that the payload that needs to be returned is computationally heavy and the server struggles to deliver it",
    "start": "576360",
    "end": "583360"
  },
  {
    "text": "so this is the typical way we would do it we would install ourselves as a software hosted wherever you want as a",
    "start": "583360",
    "end": "589800"
  },
  {
    "text": "reverse caching proxy that's what it looks like under the hood meaning that users connect to Varnish varnish checks",
    "start": "589800",
    "end": "596839"
  },
  {
    "text": "what the user is requesting based on the host header and a request URL looks it up in Cache if it has it it serves it",
    "start": "596839",
    "end": "603040"
  },
  {
    "text": "which means you don't have to talk to the server which overloads so much pressure and if it's not there well then",
    "start": "603040",
    "end": "609519"
  },
  {
    "text": "you'll request it with the back end and there will be a single call so even if tens of thousands of people are going",
    "start": "609519",
    "end": "615519"
  },
  {
    "text": "for the same uncashed resource a single request will be sent to the back end and that's how we make this so powerful that",
    "start": "615519",
    "end": "621279"
  },
  {
    "text": "is the secret or not so Secret Sauce now uh there's a lot of light here in the",
    "start": "621279",
    "end": "626839"
  },
  {
    "text": "room so I it's not always easy to see you guys but I still see a little bit of confusion in your eyes and for that I",
    "start": "626839",
    "end": "633079"
  },
  {
    "text": "have the perfect solution so if I want to make this point clear what a reverse caching proxy like varnish does I always",
    "start": "633079",
    "end": "639560"
  },
  {
    "text": "throw in this one so who knows this movie who's old enough to have seen this movie by show of",
    "start": "639560",
    "end": "647279"
  },
  {
    "text": "hands okay what what is it what movie is it you could shout it out there's a",
    "start": "647279",
    "end": "652399"
  },
  {
    "text": "little bit of a gap here what are we what are we looking at The Bodyguard The Bodyguard is a a",
    "start": "652399",
    "end": "661000"
  },
  {
    "text": "movie featuring Kevin CER Whitney used and and the storyline is that we have a very talented singer and actress like",
    "start": "661000",
    "end": "667279"
  },
  {
    "text": "someone in entertainment business who is uh is super popular and uh in the end needs a bodyguard to protect her from",
    "start": "667279",
    "end": "674160"
  },
  {
    "text": "all the stocky fans and that's maybe the perfect way of talking about reverse caching proxies when",
    "start": "674160",
    "end": "679519"
  },
  {
    "text": "inou your application that's Whitney and Kevin is the cash so keep that in mind",
    "start": "679519",
    "end": "685399"
  },
  {
    "text": "now there's different kinds of caching and if you look at computer systems it's cashing all the way down however we'll be talking about HTTP caching and HTTP",
    "start": "685399",
    "end": "693320"
  },
  {
    "text": "as a protocol has built in caching mechanisms that are part of the protocol that nearly all the HTTP caches respect",
    "start": "693320",
    "end": "700600"
  },
  {
    "text": "so if we look at this one should be very straightforward right you've seen this a cache control header with a public Max H",
    "start": "700600",
    "end": "708079"
  },
  {
    "text": "equals 500 meaning that this will be cached for 500 seconds however it gets a",
    "start": "708079",
    "end": "713480"
  },
  {
    "text": "bit more tricky there's a lot more syntax than what you'd expect so in this case we're having a max age of 500 and",
    "start": "713480",
    "end": "720079"
  },
  {
    "text": "an S max age of a th000 anyone want to take a wild guess how long the cach and",
    "start": "720079",
    "end": "725920"
  },
  {
    "text": "with the cash I mean the reverse cashing proxy will will store this any",
    "start": "725920",
    "end": "731839"
  },
  {
    "text": "takers I see you thinking you think well the answer to the question is a thousand",
    "start": "733600",
    "end": "740120"
  },
  {
    "text": "because the S Max H so s Max H stands for shared max age is a specific",
    "start": "740120",
    "end": "746560"
  },
  {
    "text": "directive that was invented for caches while varnish if we go back will respect",
    "start": "746560",
    "end": "752560"
  },
  {
    "text": "the 500 and a lot of caches will respect the 500 if we see both we will cach the",
    "start": "752560",
    "end": "758120"
  },
  {
    "text": "object for a th000 seconds in this case and forward to rest of the browser and the browser can then choose to cash it",
    "start": "758120",
    "end": "763920"
  },
  {
    "text": "for 500 seconds however if you don't want to cash you can throw something",
    "start": "763920",
    "end": "769079"
  },
  {
    "text": "like this into the mix so these are headers that you as an application developer can send to any type of cach",
    "start": "769079",
    "end": "775800"
  },
  {
    "text": "or to the browser to make sure that these things are cach so in this case we don't want to cash and it's a com",
    "start": "775800",
    "end": "780959"
  },
  {
    "text": "combination of private no cache and no store and they mean different things",
    "start": "780959",
    "end": "786760"
  },
  {
    "text": "private means you can cash it but only private caches like a browser because maybe the cach is unique to you or the",
    "start": "786760",
    "end": "792839"
  },
  {
    "text": "content is unique to you so you don't want to mix it up with other people you don't want to share it no cash you would",
    "start": "792839",
    "end": "798880"
  },
  {
    "text": "think it means you can't cash but ironically it means you can store it in",
    "start": "798880",
    "end": "804160"
  },
  {
    "text": "the cash but you can't serve it from the cash without proper revalidation meaning the server varnish still has to connect",
    "start": "804160",
    "end": "810399"
  },
  {
    "text": "to your origin and then no store means don't store it in the cache and there's more headers like a vary header which",
    "start": "810399",
    "end": "816639"
  },
  {
    "text": "creates cash variations based on maybe you're sitting behind a load balancer that does your TLS proxying so maybe you",
    "start": "816639",
    "end": "823399"
  },
  {
    "text": "want to forward your original proxy over an exported Proto header or maybe you want to create a cache variation on the",
    "start": "823399",
    "end": "828720"
  },
  {
    "text": "browser language and allow me to explain how that works so let's say the user",
    "start": "828720",
    "end": "834360"
  },
  {
    "text": "connects to Varnish gets the homepage of a website called example",
    "start": "834360",
    "end": "840199"
  },
  {
    "text": "and the browser takes the liberty of forwarding the supported languages and in this case the accept language header",
    "start": "840199",
    "end": "845440"
  },
  {
    "text": "of the browser is English so varnish will take that on it doesn't find it in the cache it forwards it to the server",
    "start": "845440",
    "end": "852360"
  },
  {
    "text": "itself and the server looks at it and says hey great I have that content and it Returns the content with a caching",
    "start": "852360",
    "end": "858440"
  },
  {
    "text": "header 500 seconds however it also indicates that the content is in English",
    "start": "858440",
    "end": "863560"
  },
  {
    "text": "and that we do want to have a cache variation based on the language varnish",
    "start": "863560",
    "end": "868720"
  },
  {
    "text": "understands that V vary header and will create several variations for every language so initially that user coming",
    "start": "868720",
    "end": "874720"
  },
  {
    "text": "in will create a hash in the cache to look it up which uses the host header",
    "start": "874720",
    "end": "880000"
  },
  {
    "text": "the URL but also that exact language English so that means there's a separate one on the homepage for English and I'm",
    "start": "880000",
    "end": "886519"
  },
  {
    "text": "a Dutch native speaker so I will come in with my accept language NL and I will be sent to a different element so VAR if we",
    "start": "886519",
    "end": "894000"
  },
  {
    "text": "go back VAR accept language allows you to take a request header which is called",
    "start": "894000",
    "end": "899079"
  },
  {
    "text": "accept language and use that to create different variations and that's a way of improving something that would otherwise",
    "start": "899079",
    "end": "905680"
  },
  {
    "text": "not be cashable and the last one we'll throw in is again Max H 500 but with a",
    "start": "905680",
    "end": "911000"
  },
  {
    "text": "stale while revalidate equal to 200 meaning that if the cache expires after",
    "start": "911000",
    "end": "918040"
  },
  {
    "text": "let's say 500 seconds 200 seconds beyond the expiration of the object you can still",
    "start": "918040",
    "end": "924079"
  },
  {
    "text": "serve the old stuff but meanwhile we will do an asynchronous fetch with the",
    "start": "924079",
    "end": "929440"
  },
  {
    "text": "origin to get the updated version meaning that no one is really the victim no client is the victim of being the one",
    "start": "929440",
    "end": "936040"
  },
  {
    "text": "the last one to hit the object before it expires you don't have to wait because we keep serving you the old stuff doing",
    "start": "936040",
    "end": "941199"
  },
  {
    "text": "it super fast while we get to new one so all part of the HTP spec of the HTTP",
    "start": "941199",
    "end": "946560"
  },
  {
    "text": "caching standard and you it doesn't come as a surprise that we as an open source project adhere to these",
    "start": "946560",
    "end": "953000"
  },
  {
    "text": "conventions however this is all fun and games for very static stuff static HTML",
    "start": "953000",
    "end": "959560"
  },
  {
    "text": "images CSS JavaScript video files everything that is static however things",
    "start": "959560",
    "end": "965279"
  },
  {
    "text": "get a bit more tricky when cookies are involved because cookies are way of setting States and are highly",
    "start": "965279",
    "end": "971720"
  },
  {
    "text": "personalized and varnish out of the box when it sees a cookie as part of the request header it will decide not to",
    "start": "971720",
    "end": "978120"
  },
  {
    "text": "cash which is quite severe of a decision it also doesn't cash when it",
    "start": "978120",
    "end": "983680"
  },
  {
    "text": "sees an authorization header coming in because that also means it's highly personalized things don't get get cashed",
    "start": "983680",
    "end": "989440"
  },
  {
    "text": "because the content is For Your Eyes Only and that is not a shortcoming that's by Design because we'd rather be",
    "start": "989440",
    "end": "996160"
  },
  {
    "text": "defensive and conservative and make because there's there's only one thing more dangerous",
    "start": "996160",
    "end": "1002279"
  },
  {
    "text": "than not cashing enough and that's cashing for too long and there's a ton of horror stories a famous one is some",
    "start": "1002279",
    "end": "1008120"
  },
  {
    "text": "sort of system where tax returns are stored and the tax return was cashed so",
    "start": "1008120",
    "end": "1013519"
  },
  {
    "text": "someone logged in and saw someone else's cash uh cached version of the tax return and that caused all sorts of drama I've",
    "start": "1013519",
    "end": "1019839"
  },
  {
    "text": "seen it myself uh with setting two aggressive caching back in my my previous job being able to store the",
    "start": "1019839",
    "end": "1026640"
  },
  {
    "text": "contents of a a shopping cart meaning everyone saw the same shopping cart so you do not want to get into that if you",
    "start": "1026640",
    "end": "1032280"
  },
  {
    "text": "see a cookie or an authorization header you are not going to cash which grinds this entire presentation to a screeching",
    "start": "1032280",
    "end": "1039079"
  },
  {
    "text": "halt what are we doing here what are you doing here why did you choose to come here what do you want to learn because",
    "start": "1039079",
    "end": "1045199"
  },
  {
    "text": "I'm going to make a statement I'm going to ask you a question and we're going to come to a conclusion so the statement and I'll repeat it again varnish out of",
    "start": "1045199",
    "end": "1051919"
  },
  {
    "text": "the box does not cash when cookies are present that's a statement here's my",
    "start": "1051919",
    "end": "1057000"
  },
  {
    "text": "question to you do you know a modern day website that doesn't use cookies right everything uses cookies so",
    "start": "1057000",
    "end": "1064320"
  },
  {
    "text": "is the obvious conclusion then that varnish cannot be used in the real world one would think that's the case but of",
    "start": "1064320",
    "end": "1070600"
  },
  {
    "text": "course I wouldn't be wasting your time and my own time being here so what I can say is while this is the standard",
    "start": "1070600",
    "end": "1076280"
  },
  {
    "text": "behavior and very much a conservative Behavior that makes sense you can extend",
    "start": "1076280",
    "end": "1081320"
  },
  {
    "text": "that behavior and what you could do is use the built-in programming language and extend that standard behavior in an",
    "start": "1081320",
    "end": "1087880"
  },
  {
    "text": "opinionated way and this is what caching the uncashable is mostly like so that varnish configuration language or vcl as",
    "start": "1087880",
    "end": "1094600"
  },
  {
    "text": "we call it has capabilities that are specific to the project meaning you can",
    "start": "1094600",
    "end": "1099960"
  },
  {
    "text": "do request handling you can reroute requests you can rewrite them you can change them the the responses and",
    "start": "1099960",
    "end": "1106120"
  },
  {
    "text": "manipulate the body you could select which backend you're connecting to you can control every aspect of the caching",
    "start": "1106120",
    "end": "1112400"
  },
  {
    "text": "where to Cache what to Cache how long what to have what how to revalidate how to do variations all of that stuff and",
    "start": "1112400",
    "end": "1118600"
  },
  {
    "text": "you can make your decisions on the edge and the edge is an important term here the edge is a definition that means the",
    "start": "1118600",
    "end": "1125640"
  },
  {
    "text": "outer tier of your web platform and that's typically the part that talks to the end users it could be a cache like",
    "start": "1125640",
    "end": "1131880"
  },
  {
    "text": "what we offer could be a CDN could be whatever so thanks to that language which is a domain specific language that",
    "start": "1131880",
    "end": "1138760"
  },
  {
    "text": "that has a curly braces style similar to C and other languages you can write behavior and when varnish starts it will",
    "start": "1138760",
    "end": "1145480"
  },
  {
    "text": "read the file it will transpile it into C code compile that c code into machine code and share it or link it to the",
    "start": "1145480",
    "end": "1152760"
  },
  {
    "text": "runtime process as a shared object so it is super fast it is not a top- down",
    "start": "1152760",
    "end": "1158000"
  },
  {
    "text": "programming language so you're not forced into writing everything yourself as mentioned there's a standard behavior",
    "start": "1158000",
    "end": "1164400"
  },
  {
    "text": "and that standard Behavior and the flow is expressed through a finite State machine that you can hook in into so if",
    "start": "1164400",
    "end": "1169799"
  },
  {
    "text": "I were to do a varnish training I would spend at least a half an hour on this but we don't have that type of time so",
    "start": "1169799",
    "end": "1175280"
  },
  {
    "text": "you know how to read flow charts I guess so the the square boxes or the rectangular boxes are the states that",
    "start": "1175280",
    "end": "1181120"
  },
  {
    "text": "you can end up in the states that are overridable have a prefix called vcl",
    "start": "1181120",
    "end": "1186240"
  },
  {
    "text": "meaning you can extend them in vcl and then after the underscore there's the context so it all starts with start and",
    "start": "1186240",
    "end": "1192799"
  },
  {
    "text": "then you enter in vcl Rec V which is short for receive so that means you received the",
    "start": "1192799",
    "end": "1198760"
  },
  {
    "text": "request you make your decisions maybe you extend it we'll see that in a minute and then you decide what the next thing",
    "start": "1198760",
    "end": "1203960"
  },
  {
    "text": "is so you do a return statement and you end up on the next one so let's take a cach hit which is the optimal scenario",
    "start": "1203960",
    "end": "1210840"
  },
  {
    "text": "for a minute so follow the green lines is what I would say we start with receiving the request if we deem the",
    "start": "1210840",
    "end": "1216559"
  },
  {
    "text": "request cachable we will create a hash that hash contains the host header and",
    "start": "1216559",
    "end": "1222360"
  },
  {
    "text": "the URL we look it up if we find it in vcl hash we will go to vcl hit meaning",
    "start": "1222360",
    "end": "1229480"
  },
  {
    "text": "we have the object we want to return we don't need to talk to the back end we end up in vcl deliver where we deliver the content and it ends now of course",
    "start": "1229480",
    "end": "1236559"
  },
  {
    "text": "you're in could be in a situation where you have a cash miss a Miss because the content wasn't in the cash in the first",
    "start": "1236559",
    "end": "1242039"
  },
  {
    "text": "place or because it was in the cash but it was outdated expired well then we have to follow the blue lines we'll do",
    "start": "1242039",
    "end": "1247440"
  },
  {
    "text": "the same we'll hash we'll look it up we'll conclude that it's either expired or not in the cache at all so we'll",
    "start": "1247440",
    "end": "1253120"
  },
  {
    "text": "enter vcl Miss and then we have to go to that big gray box which means connecting",
    "start": "1253120",
    "end": "1258640"
  },
  {
    "text": "to the server that's what we tried to reduce as much as possible for the sake of performance and then there's a bunch",
    "start": "1258640",
    "end": "1263760"
  },
  {
    "text": "of statements there like back and fetch meaning you prepare an HTP request that you'll send to your server and when the",
    "start": "1263760",
    "end": "1269960"
  },
  {
    "text": "server responds prior to storing it in the memory of the cache you'll reach vcl backend response and there's so many",
    "start": "1269960",
    "end": "1275760"
  },
  {
    "text": "others let's make this very practical here's a vcl example here's a very simple vcl example that uses an extract",
    "start": "1275760",
    "end": "1283039"
  },
  {
    "text": "that is used in a lot of Wordpress websites first things first we connect to the back end named default and as it",
    "start": "1283039",
    "end": "1290400"
  },
  {
    "text": "happens it's hosted on the same machine on the Local Host the loop back interface on Port 880 we will expose",
    "start": "1290400",
    "end": "1296039"
  },
  {
    "text": "ourselves on Port 80 so we hook into vcl receive and we do an introspection of",
    "start": "1296039",
    "end": "1301520"
  },
  {
    "text": "the request URL and we see that if the request URL matches and that's the",
    "start": "1301520",
    "end": "1306720"
  },
  {
    "text": "keyword here matches you see the Tilla operator that means match a regular expression so if it matches SL admin or",
    "start": "1306720",
    "end": "1313080"
  },
  {
    "text": "SL admin SL or SL admin SL and a subordinate resource you're pretty much in the admin panel we do not want to",
    "start": "1313080",
    "end": "1319919"
  },
  {
    "text": "cash it so we do a return pass that's what happens here we go to pass pass is",
    "start": "1319919",
    "end": "1325400"
  },
  {
    "text": "different that Miss pass means you will bypass the cash at all times it'll never",
    "start": "1325400",
    "end": "1330559"
  },
  {
    "text": "be stored in cash that's that one and other all other circumstances if the content is cachable we'll just strip off",
    "start": "1330559",
    "end": "1337520"
  },
  {
    "text": "the cookie and proceed so so that's one of the ways of doing it another way of doing it another use case would be to",
    "start": "1337520",
    "end": "1344039"
  },
  {
    "text": "manipulate the time to live and the caching headers so what you would do in this case is is enter vcl backend",
    "start": "1344039",
    "end": "1350559"
  },
  {
    "text": "response which is here meaning something was missed or bypassed so we need to",
    "start": "1350559",
    "end": "1356799"
  },
  {
    "text": "connect to the back end and the back end has responded and if the back end response we use the backend response",
    "start": "1356799",
    "end": "1362279"
  },
  {
    "text": "object basp we'll look at its HTTP headers and check the content type header if the content type matches image",
    "start": "1362279",
    "end": "1369440"
  },
  {
    "text": "slash or video slash obviously we have a video we have an image so that's very",
    "start": "1369440",
    "end": "1374559"
  },
  {
    "text": "static so we're going to bump the TTL to a year we're going to store it as long as we can can and will expose a really",
    "start": "1374559",
    "end": "1380159"
  },
  {
    "text": "long Max H header which Google likes by the way to the client and the browser can choose to to store it also for a",
    "start": "1380159",
    "end": "1386400"
  },
  {
    "text": "long amount of time any other logic will bypass and will immediately deliver however if the content is HTML content",
    "start": "1386400",
    "end": "1393480"
  },
  {
    "text": "identified by a content type text HTML or it's Json with application Json then",
    "start": "1393480",
    "end": "1399640"
  },
  {
    "text": "we'll decide to cach for an hour bypassing any type of cache control header that was sent by the origin",
    "start": "1399640",
    "end": "1405440"
  },
  {
    "text": "that's where we end up here and uh another example here which is a very noisy busy example is where we try to",
    "start": "1405440",
    "end": "1413320"
  },
  {
    "text": "optimize the request URL because again URL is used to identify the object in the cache so the first thing we're doing",
    "start": "1413320",
    "end": "1420000"
  },
  {
    "text": "and and the comment really hints towards it is we're going to alphabetically sort the query string parameters let's say",
    "start": "1420000",
    "end": "1426559"
  },
  {
    "text": "you have a web page that has the parameters ID equals one and category equals two if you reverse",
    "start": "1426559",
    "end": "1434799"
  },
  {
    "text": "their order you have another string you have a cach miss so we're sorting them alphabetically in terms of uh content uh",
    "start": "1434799",
    "end": "1442919"
  },
  {
    "text": "sanitation then the next thing we'll do is we'll strip off all those tracking URL parameters those campaign parameters",
    "start": "1442919",
    "end": "1448360"
  },
  {
    "text": "that you see in all the newsletters or on the landing pages they're Google analytics specific the server doesn't",
    "start": "1448360",
    "end": "1453919"
  },
  {
    "text": "need them and it messes with your hit rate so we just strip them all off using regular Expressions we also strip off",
    "start": "1453919",
    "end": "1460440"
  },
  {
    "text": "potential hashes that end up these HTML anchors that allow you to navigate to the page and if your url ends with a a",
    "start": "1460440",
    "end": "1468080"
  },
  {
    "text": "question Mark that means you're planning to add URL parameters but you didn't so we'll strip that off as well this is",
    "start": "1468080",
    "end": "1473760"
  },
  {
    "text": "logic that happens in vcl receive so those are a couple of basic examples let's move into the world of the more or",
    "start": "1473760",
    "end": "1480240"
  },
  {
    "text": "less uncashable so let's look at cookies because cookies are a big deal I told you that cookies aren't cached by",
    "start": "1480240",
    "end": "1486880"
  },
  {
    "text": "default and you saw how I dealt with it with the admin panel I was very adamant that everything within the SL admin",
    "start": "1486880",
    "end": "1493760"
  },
  {
    "text": "slash is uncashable let's not deal with it and then strip cookies off here's a another alternative let's look at the",
    "start": "1493760",
    "end": "1500120"
  },
  {
    "text": "typee of cookie we have and then make the decision so here's an old school way of doing it in varnish is remove every",
    "start": "1500120",
    "end": "1506399"
  },
  {
    "text": "single cookie because most of them are tracking cookies used by Google analytics and what have you so we don't",
    "start": "1506399",
    "end": "1511679"
  },
  {
    "text": "need them server side however let's keep the session ID if we see a session cookie that probably means someone",
    "start": "1511679",
    "end": "1518080"
  },
  {
    "text": "logged in into a panel and it's it's highly personalized so that way we're stripping everything off except the PHP",
    "start": "1518080",
    "end": "1523600"
  },
  {
    "text": "session ID uh I use PHP here I come from the PHP Community still has a a very",
    "start": "1523600",
    "end": "1528640"
  },
  {
    "text": "warm place in my heart uh I guess a lot of you are net people I'm not sure uh but you get the idea right you have a",
    "start": "1528640",
    "end": "1534679"
  },
  {
    "text": "session cookie you strip it off here's the more modern way of doing it we have a module that you need to import called",
    "start": "1534679",
    "end": "1540440"
  },
  {
    "text": "cookie and then you can say parse the cookie from the cookie header only keep the session ID and rewrite it and if in",
    "start": "1540440",
    "end": "1547880"
  },
  {
    "text": "the end the cookie is nothing but a set of wi space that's just stripp it off",
    "start": "1547880",
    "end": "1553240"
  },
  {
    "text": "that's another way of doing it now I don't want to give you the impression that cookies are B you can also take the",
    "start": "1553240",
    "end": "1560120"
  },
  {
    "text": "value of the cookie and use it to your advantage so here's the ugly way again RS up a lot of regular Expressions let's",
    "start": "1560120",
    "end": "1566440"
  },
  {
    "text": "immediately move to the clean way using the module so imagine that you have a multilingual website and you don't use",
    "start": "1566440",
    "end": "1573159"
  },
  {
    "text": "the accept language header that the browser exposes to create the multilingual content you use the old school good old Splash Pages you land up",
    "start": "1573159",
    "end": "1580559"
  },
  {
    "text": "on the splash page you have to select your region or your language and the minute you save it it will set the cookie and we use the language cookie",
    "start": "1580559",
    "end": "1586919"
  },
  {
    "text": "for that and your application is built for that but remember if we don't",
    "start": "1586919",
    "end": "1592399"
  },
  {
    "text": "include that awareness it's first come first served so me as a Dutch speaker I would go to the website get my content",
    "start": "1592399",
    "end": "1598080"
  },
  {
    "text": "in Dutch it will end up in the cache and you as Norwegian speakers would see Dutch content which would make no sense",
    "start": "1598080",
    "end": "1603640"
  },
  {
    "text": "so you need to use the language cookie in it you need to UNC cach the uncashable if you will so what I'll do",
    "start": "1603640",
    "end": "1610039"
  },
  {
    "text": "is I'll strip off all the cookies except the language cookie which you can see in the if statement write it back strip it off if",
    "start": "1610039",
    "end": "1616760"
  },
  {
    "text": "the cookie is a collection of empty widespace characters and then explicitly return hash which bypasses any standard",
    "start": "1616760",
    "end": "1624720"
  },
  {
    "text": "Behavior we're going to say regardless of the fact that we have a cookie we'll still decide to cache and then we'll",
    "start": "1624720",
    "end": "1630039"
  },
  {
    "text": "create the hash the hash by default uses I've mentioned a couple of times the host header so example.com if you will",
    "start": "1630039",
    "end": "1637720"
  },
  {
    "text": "and the URL and in vcl hash where we'll hook in we'll extend that and we'll add",
    "start": "1637720",
    "end": "1643760"
  },
  {
    "text": "the language value as well so we're going to look at the cookie and if the cookie has languages like D French or",
    "start": "1643760",
    "end": "1649880"
  },
  {
    "text": "German then we're going to use we extract that value we're going to do cookie get and hash it in and for all",
    "start": "1649880",
    "end": "1656840"
  },
  {
    "text": "other purposes we'll use English as the language and that way you have multilingual support in your cache",
    "start": "1656840",
    "end": "1663840"
  },
  {
    "text": "without having to use accept languages and those kinds of variations so here's a diagram of how you could go about so",
    "start": "1663840",
    "end": "1671120"
  },
  {
    "text": "I'm coming in with uh a language cookie English and the system says hey no",
    "start": "1671120",
    "end": "1677640"
  },
  {
    "text": "problem we have it here's uh here's the value cash it for 500 seconds and we'll",
    "start": "1677640",
    "end": "1682760"
  },
  {
    "text": "be clever enough to extract English and to store it there if I come back in with a a Dutch cookie we we'll take the other",
    "start": "1682760",
    "end": "1689000"
  },
  {
    "text": "one I did add a couple of precautions in the if statement in the vcl hash to",
    "start": "1689000",
    "end": "1694399"
  },
  {
    "text": "ensure that we don't support every language like if you if you're clever enough and you start manipulating the",
    "start": "1694399",
    "end": "1700559"
  },
  {
    "text": "cookies and setting it to Spanish or or to whatever other language you have to Danish God forbid right then then you",
    "start": "1700559",
    "end": "1707720"
  },
  {
    "text": "would create create so many variations that things would spin out of control and your hit rate would drop so that's",
    "start": "1707720",
    "end": "1713320"
  },
  {
    "text": "the backup only support the languages that are support it in the application itself fall back to English for all the",
    "start": "1713320",
    "end": "1720240"
  },
  {
    "text": "rest so that's that and comes with the good comes with the bad the bad being",
    "start": "1720240",
    "end": "1726799"
  },
  {
    "text": "imagine this you use the cookies you decide what you can cash what you cannot cash but let's say 99% of a web page is",
    "start": "1726799",
    "end": "1734360"
  },
  {
    "text": "cashable but you have that really annoying header at the top with either",
    "start": "1734360",
    "end": "1739480"
  },
  {
    "text": "the shopping cart information or your welcome T welcome John welcome",
    "start": "1739480",
    "end": "1745360"
  },
  {
    "text": "whoever it's being served over a single HTTP response so we have to find the common denominator in terms of cach",
    "start": "1745360",
    "end": "1751440"
  },
  {
    "text": "ability and unfortunately that means we can't cash it's impossible because one",
    "start": "1751440",
    "end": "1757320"
  },
  {
    "text": "tiny fraction of the content was highly personalized tough luck luckily us web",
    "start": "1757320",
    "end": "1763760"
  },
  {
    "text": "developers us web people have found the placeholder technology to help us with that and to separate the cachable from",
    "start": "1763760",
    "end": "1770200"
  },
  {
    "text": "the non-cashable content and to ensure that your output might be a composition of multiple requests Happening Now",
    "start": "1770200",
    "end": "1777080"
  },
  {
    "text": "obviously uh we're talking about initially how we've done this in the past technology like Ajax you could use",
    "start": "1777080",
    "end": "1783399"
  },
  {
    "text": "right you you just say hey dear browser I want this piece of content to come from that URL pick it up there's",
    "start": "1783399",
    "end": "1790240"
  },
  {
    "text": "probably no cash header attached to it it probably uses the cookie it probably goes to the session store it probably",
    "start": "1790240",
    "end": "1796200"
  },
  {
    "text": "gets all those values however I'm not not a huge fan of it because you're turning your server problems into the",
    "start": "1796200",
    "end": "1801640"
  },
  {
    "text": "client's problem because what you're basically doing is saying hey dear client go send that extra round trip I don't care I don't want to deal with",
    "start": "1801640",
    "end": "1807600"
  },
  {
    "text": "this which is not really kind right and on a it's an extra round trip on slow connections you're really burdening the",
    "start": "1807600",
    "end": "1813440"
  },
  {
    "text": "client with it and it's a JavaScript thing so if something goes wrong in the JavaScript you as an operator from the",
    "start": "1813440",
    "end": "1818760"
  },
  {
    "text": "server site have zero control uh luckily there's an alternative called Edge site",
    "start": "1818760",
    "end": "1825200"
  },
  {
    "text": "includes who's heard of EDG site includes by show of hands bunch of people nice nice not bad well for those",
    "start": "1825200",
    "end": "1830799"
  },
  {
    "text": "of you who don't know it and who are of a certain age I would say a certain level of maturity I would say do you",
    "start": "1830799",
    "end": "1837360"
  },
  {
    "text": "remember server side includes from the good old days or or the bad old days depending on how you want to look at it",
    "start": "1837360",
    "end": "1843320"
  },
  {
    "text": "these were the good old server side includes you could drop this into your HTML and your server your Apache would",
    "start": "1843320",
    "end": "1848840"
  },
  {
    "text": "parse this would read the file this is server side includes parsing happening",
    "start": "1848840",
    "end": "1854080"
  },
  {
    "text": "on the server Edge site includes like these bad boys here can be parsed on the",
    "start": "1854080",
    "end": "1859639"
  },
  {
    "text": "edge and I already mentioned the edge is the outer tier of your web platform so pretty much varnish would parse these",
    "start": "1859639",
    "end": "1865799"
  },
  {
    "text": "and varnish would look at him look at the source attribute and load that as a sub request meaning that you've pretty",
    "start": "1865799",
    "end": "1873120"
  },
  {
    "text": "much built a placeholder technology parsed by varnish the output is a composition of blocks and every end",
    "start": "1873120",
    "end": "1878679"
  },
  {
    "text": "point that is stored in the cache has a separate State a separate TTL which is very beneficial because that annoying",
    "start": "1878679",
    "end": "1885240"
  },
  {
    "text": "little welcome John widget at the top could be parsed on the edge and could be",
    "start": "1885240",
    "end": "1891080"
  },
  {
    "text": "not cached whereas 99% of the page can be cached and the way you would enable that in varnish is by enabling bp. doesi",
    "start": "1891080",
    "end": "1900000"
  },
  {
    "text": "set it to true and you're done with that but it's a bit more it's a bit more than that you don't want parsing to happen on",
    "start": "1900000",
    "end": "1906320"
  },
  {
    "text": "every single page maybe you want to do that conditionally maybe some pages don't use it maybe you don't want to",
    "start": "1906320",
    "end": "1911600"
  },
  {
    "text": "waste too many CPU Cycles my tip to you my advice would be let's do some ESI",
    "start": "1911600",
    "end": "1917039"
  },
  {
    "text": "negotiation now mind you ESI is not something we invented this is a standard",
    "start": "1917039",
    "end": "1922120"
  },
  {
    "text": "it was invented by I think the lovely people at Akamai who are a big CDN CDN is nothing more than caches like ours",
    "start": "1922120",
    "end": "1928600"
  },
  {
    "text": "but geographically distributed so there's consensus over this type of of technology and multiple Technologies",
    "start": "1928600",
    "end": "1934600"
  },
  {
    "text": "support it the way I would advise you to do it is by leveraging HTTP headers and",
    "start": "1934600",
    "end": "1940120"
  },
  {
    "text": "just sending that's what we would do send a surrogate capability header to the application by saying hey dear",
    "start": "1940120",
    "end": "1946000"
  },
  {
    "text": "application uh we're not really a client we're actually a cachee and we have support for ESI so if uh if you have",
    "start": "1946000",
    "end": "1953120"
  },
  {
    "text": "those capabilities go ahead and take control and the application would respond so this is a request header",
    "start": "1953120",
    "end": "1959360"
  },
  {
    "text": "being sent to the to the application if you spot that and many Frameworks have the capabilities of spotting that you'll",
    "start": "1959360",
    "end": "1965440"
  },
  {
    "text": "say nice so you have surrogate capabilities I'll take surrogate control and it will return that response header",
    "start": "1965440",
    "end": "1971720"
  },
  {
    "text": "and that's the trigger for varnish to say let's do some ESI parsing and this is the vcl that does this so in BCL",
    "start": "1971720",
    "end": "1978840"
  },
  {
    "text": "backend fetch we're preparing an additional request header we're saying hey we have the capabilities ESI is one",
    "start": "1978840",
    "end": "1984880"
  },
  {
    "text": "of those capabilities and on the other hand we'll be listening to what comes back so if the server responds with a",
    "start": "1984880",
    "end": "1990399"
  },
  {
    "text": "circuit control header that contains ESI will do the parsing and strip off the header which means you could write stuff",
    "start": "1990399",
    "end": "1997200"
  },
  {
    "text": "like this and do composition of blocks in your view layer this isn't necessarily something you should do in",
    "start": "1997200",
    "end": "2003159"
  },
  {
    "text": "your control layer you say hey ESI and and some Frameworks even have wrappers around it that do the surrogate",
    "start": "2003159",
    "end": "2009440"
  },
  {
    "text": "capability surrogate control check and if there's no not the right surrogate capability it will just do the internal",
    "start": "2009440",
    "end": "2015760"
  },
  {
    "text": "rendering at the server side rather than uh sending this to the edge so you could",
    "start": "2015760",
    "end": "2020919"
  },
  {
    "text": "use something like this with header and that could be replaced by taste if you want me as a consumer in my browser I",
    "start": "2020919",
    "end": "2027360"
  },
  {
    "text": "would see this but behind the scenes this will happen and my homepage will be cached separately maybe for an hour",
    "start": "2027360",
    "end": "2032519"
  },
  {
    "text": "maybe for a day and that header widget would not be cached at all",
    "start": "2032519",
    "end": "2038600"
  },
  {
    "text": "all right let's pause it for a second and do a status update we're half an hour in exactly where I want it you to",
    "start": "2038600",
    "end": "2045200"
  },
  {
    "text": "be and let's see what we've done and what we've learned so far we've learned",
    "start": "2045200",
    "end": "2050358"
  },
  {
    "text": "that cookies are a bit tricky so is authentication because it's highly personalized and typically you don't",
    "start": "2050359",
    "end": "2055679"
  },
  {
    "text": "want to cash it however we've already leveraged vcl to decide what the cash",
    "start": "2055679",
    "end": "2062280"
  },
  {
    "text": "what not the cash based on the content of the cookies but also to leverage cookies for certain cash variations cach",
    "start": "2062280",
    "end": "2068200"
  },
  {
    "text": "variations are multiple copies of the same page with a different variation I'll also showed you that you have to be",
    "start": "2068200",
    "end": "2074280"
  },
  {
    "text": "careful with those variations because too many variations of an object will yield too many misses at at the origin",
    "start": "2074280",
    "end": "2080358"
  },
  {
    "text": "level so balance it out and we've also learned that we can use placeholder technology to separate stateful from",
    "start": "2080359",
    "end": "2086919"
  },
  {
    "text": "non- stateful content but there's a lesson here and the lesson is that even though we've done a good job and really",
    "start": "2086919",
    "end": "2092720"
  },
  {
    "text": "improve the performance of our application I could comfortably say that we've went times 10 in terms of",
    "start": "2092720",
    "end": "2098119"
  },
  {
    "text": "performance or times 100 depending on the situation we still have those non-cashable routes which will be",
    "start": "2098119",
    "end": "2105359"
  },
  {
    "text": "consumed at an equal pace and those tend to be a target for high server load if",
    "start": "2105359",
    "end": "2110800"
  },
  {
    "text": "whatever it takes to compose that is computationally heavy enough or if you have enough requests coming in it could",
    "start": "2110800",
    "end": "2117680"
  },
  {
    "text": "also lead to latency for loading the page so let's switch gears switch mindset and say instead of just storing",
    "start": "2117680",
    "end": "2124000"
  },
  {
    "text": "all that stuff in the cash and just serve it why don't we use that vcl language and the capabilities of it to",
    "start": "2124000",
    "end": "2129400"
  },
  {
    "text": "do more computational stuff like why instead of saying we won't cach it we could say hey you know what we'll comput",
    "start": "2129400",
    "end": "2135880"
  },
  {
    "text": "it we'll see what the data is I'll give you a very simple example of loading",
    "start": "2135880",
    "end": "2142240"
  },
  {
    "text": "authentication this is the stupidest example you can use in terms of",
    "start": "2142240",
    "end": "2147400"
  },
  {
    "text": "authentication so we know probably basic off uh and there's even a typo in this",
    "start": "2147400",
    "end": "2152680"
  },
  {
    "text": "slide it should be basic space it's an authorization header we check it and we",
    "start": "2152680",
    "end": "2158359"
  },
  {
    "text": "see if that is the base 64 encoded value now if you would base 64 decod it it's",
    "start": "2158359",
    "end": "2163440"
  },
  {
    "text": "username call on password so that's how basic off work so we could say hey if that value doesn't apply go away return",
    "start": "2163440",
    "end": "2171680"
  },
  {
    "text": "401 so we're synthetically returning a response saying Go away authenticate and in vcl syn which is the",
    "start": "2171680",
    "end": "2179520"
  },
  {
    "text": "synthetic placeholder we could just say if the response is 401 add an additional header www authenticate and that would",
    "start": "2179520",
    "end": "2186680"
  },
  {
    "text": "trigger that server site popup in your website that's how these server site popups work that's the HTTP behind it",
    "start": "2186680",
    "end": "2194280"
  },
  {
    "text": "there must be an authorization header it must be the right one if it's not there we'll trigger that by doing dubdub duub",
    "start": "2194280",
    "end": "2200480"
  },
  {
    "text": "authenticate there's more secure ways of doing that of course by using a module that you can import and read the HT",
    "start": "2200480",
    "end": "2207119"
  },
  {
    "text": "passwd file that you could use in your Apaches of this world you can also store hashed versions of the password so that",
    "start": "2207119",
    "end": "2213280"
  },
  {
    "text": "you're not exposing the real ones and read it from there that's one way of doing it now there's different kinds of",
    "start": "2213280",
    "end": "2219800"
  },
  {
    "text": "authentication of course when I look at you I see you ask the question what about Jason web tokens it's quite",
    "start": "2219800",
    "end": "2226000"
  },
  {
    "text": "popular as well who's familiar with JWT by show of hands just to read the room a bit so I don't then I could skip over",
    "start": "2226000",
    "end": "2233040"
  },
  {
    "text": "this quicker than I anticipated here's a Json web token for your convenience I",
    "start": "2233040",
    "end": "2239040"
  },
  {
    "text": "colorcoded it meaning that this token that could be transported in an",
    "start": "2239040",
    "end": "2244760"
  },
  {
    "text": "authorization header even in a cookie if you will is a a collection of three parts separated by dots each of these",
    "start": "2244760",
    "end": "2250440"
  },
  {
    "text": "parts is B 64 encoded Json the first part in red is the header the middle part in pink is the actual payload",
    "start": "2250440",
    "end": "2256920"
  },
  {
    "text": "you're transmitting and the blue part is the signature which is somewhat secure or is secure because it is an hmac with",
    "start": "2256920",
    "end": "2264040"
  },
  {
    "text": "a secret key of the concatenation of the header and the payload meaning that if",
    "start": "2264040",
    "end": "2269800"
  },
  {
    "text": "someone would tamper with the data to do privilege escalation or something like that the hash would match you're pretty",
    "start": "2269800",
    "end": "2277160"
  },
  {
    "text": "secure so if we would decode that because again this is nothing more than b 64 in code",
    "start": "2277160",
    "end": "2282319"
  },
  {
    "text": "of Json if we do a Bas 64 decode this is what we end up with the header says that",
    "start": "2282319",
    "end": "2287560"
  },
  {
    "text": "we're securing this with an hmax signature using the Sha 256 algorithm the type of token we're having here is",
    "start": "2287560",
    "end": "2293480"
  },
  {
    "text": "adjacent web token then we have the payload which has a subject sub a name",
    "start": "2293480",
    "end": "2299119"
  },
  {
    "text": "an IAT which means issue that which is a Unix timestamp and then the expiration date which is also a Unix timestamp",
    "start": "2299119",
    "end": "2306079"
  },
  {
    "text": "naturally we're trying to keep things short as possible because this needs to go over the wire the bigger your tokens",
    "start": "2306079",
    "end": "2311599"
  },
  {
    "text": "the more data you consume and in the end we do the hmax signature that has the secret now from an authentication",
    "start": "2311599",
    "end": "2318520"
  },
  {
    "text": "perspective that will typically be sent using a barer authentication token in apis it's pretty common I'd like to warn",
    "start": "2318520",
    "end": "2325560"
  },
  {
    "text": "you and I'd like to make sure you're well seated for some really ugly vcl code but functional code that you can",
    "start": "2325560",
    "end": "2332280"
  },
  {
    "text": "use in open source for a lack of a module right now ready set",
    "start": "2332280",
    "end": "2338160"
  },
  {
    "text": "go I'm going to have to guide you too there there's going to be some handh holding required I guess to to to work",
    "start": "2338160",
    "end": "2344680"
  },
  {
    "text": "through this because it uses a lot of really ugly regular Expressions it does string Replacements so let's start we're",
    "start": "2344680",
    "end": "2351599"
  },
  {
    "text": "entering vcl receive so we're receiving a request and we're looking for an authorization header sent by an API for",
    "start": "2351599",
    "end": "2358119"
  },
  {
    "text": "example if that doesn't match bear and then the token and the token is a collection of at least three non do",
    "start": "2358119",
    "end": "2366040"
  },
  {
    "text": "characters collection of those separated by dots if that's not the case we'll just say forbidden you're not allowed in",
    "start": "2366040",
    "end": "2372839"
  },
  {
    "text": "here Json web token required that's a start we're already uploading that again",
    "start": "2372839",
    "end": "2378560"
  },
  {
    "text": "why are we doing this to ensure that the origin doesn't have to do that that your application doesn't have to do that and",
    "start": "2378560",
    "end": "2384079"
  },
  {
    "text": "that we don't have cash misses so by tackling this you're pretty much ensuring that authentication Gateway is",
    "start": "2384079",
    "end": "2389680"
  },
  {
    "text": "set up at the front highly performant that the application can cash so we've",
    "start": "2389680",
    "end": "2394839"
  },
  {
    "text": "stepped past that next step is let's see the first bit so we're setting the JWT",
    "start": "2394839",
    "end": "2400119"
  },
  {
    "text": "header and we're extracting it from the first group using back slash one so that's the first one in that value there",
    "start": "2400119",
    "end": "2407480"
  },
  {
    "text": "is probably a type property in Json and a ALG property we're going to use the",
    "start": "2407480",
    "end": "2414480"
  },
  {
    "text": "digest module and base 64 URL decode that to turn it into actual string",
    "start": "2414480",
    "end": "2419880"
  },
  {
    "text": "string data Jon we'll take the type we'll take the algorithm if the type is not JWT and the algorithm is not HS 256",
    "start": "2419880",
    "end": "2428160"
  },
  {
    "text": "then tokens invalid return stop whatever you're doing if it is value if it is a",
    "start": "2428160",
    "end": "2434280"
  },
  {
    "text": "valid value Roder we're going to extract the payload which is the second group as you see in the last line on this slide",
    "start": "2434280",
    "end": "2439880"
  },
  {
    "text": "so we already have the payload the nightmare continues in terms of ugly vcl",
    "start": "2439880",
    "end": "2445880"
  },
  {
    "text": "code we have the payload we need the signature now so we're going to get the third Group which consist of the",
    "start": "2445880",
    "end": "2452079"
  },
  {
    "text": "signature and then we're going to compute what we expect in terms of signature because whatever we get might not be the right signature it might be",
    "start": "2452079",
    "end": "2458599"
  },
  {
    "text": "tampered with we know that a real signature is the header the payload",
    "start": "2458599",
    "end": "2465800"
  },
  {
    "text": "brought together with an hmx signature and a secret key the secret is secret",
    "start": "2465800",
    "end": "2472440"
  },
  {
    "text": "unfortunately that's the second uh line JWT Cur that's the current signature how",
    "start": "2472440",
    "end": "2478920"
  },
  {
    "text": "do we compose it well we take the header a do the payload ad do we hm it with SH",
    "start": "2478920",
    "end": "2484960"
  },
  {
    "text": "256 encode it with Bas 64 or URL noad hex and that is that value and that",
    "start": "2484960",
    "end": "2490480"
  },
  {
    "text": "value needs to match so if the signature we've got doesn't match our current signature someone has been messing with",
    "start": "2490480",
    "end": "2496720"
  },
  {
    "text": "your Json web token and we don't want to support it so in that case 403 token",
    "start": "2496720",
    "end": "2502240"
  },
  {
    "text": "signat uh JWT uh invalid token signature once we get past that we know we have a",
    "start": "2502240",
    "end": "2508680"
  },
  {
    "text": "valid token it has been validated so let's extract some data from it and use it to our benefit so the payload we take",
    "start": "2508680",
    "end": "2515480"
  },
  {
    "text": "it from the raw payload again do a URL decode and from there we might want to know the expiration time and we want to",
    "start": "2515480",
    "end": "2521839"
  },
  {
    "text": "know the username so we extract that and then we can continue and the last check we'll do is to check whether or not the",
    "start": "2521839",
    "end": "2527160"
  },
  {
    "text": "token has expired so all of this can be done on the edge without bothering your application without wasting precious CPU",
    "start": "2527160",
    "end": "2533920"
  },
  {
    "text": "Cycles precious memory it's a good thing and then you can strip off the alization",
    "start": "2533920",
    "end": "2539280"
  },
  {
    "text": "header and go back to standard behavior of course there's an easier way of doing this we uh we even offer a module in our",
    "start": "2539280",
    "end": "2545319"
  },
  {
    "text": "Enterprise product that does exactly the same like this easy right so couple of lines",
    "start": "2545319",
    "end": "2552920"
  },
  {
    "text": "module check it uh the thing with the secret is I call the secret key secret I",
    "start": "2552920",
    "end": "2558240"
  },
  {
    "text": "would advise you to CH choose a different value maybe read it from dis maybe roll it over and have new values",
    "start": "2558240",
    "end": "2564720"
  },
  {
    "text": "every now and then just remember the only two parties in this chain that know",
    "start": "2564720",
    "end": "2570280"
  },
  {
    "text": "the secret are the one who creates the JWT and the one that validates it so make sure it is secured all right let's",
    "start": "2570280",
    "end": "2576760"
  },
  {
    "text": "step it up not we can do authentication uh management and do an authentication",
    "start": "2576760",
    "end": "2582440"
  },
  {
    "text": "Gateway we can also start returning our own responses if we will and we will leverage synthetic HTP for that so",
    "start": "2582440",
    "end": "2589480"
  },
  {
    "text": "you've seen the return synth throughout a couple of examples synthetic http means HTTP responses that are returned",
    "start": "2589480",
    "end": "2597119"
  },
  {
    "text": "that did not originate from the origin server we created it ourselves so if you would do this it would return 200 and it",
    "start": "2597119",
    "end": "2603800"
  },
  {
    "text": "would use the standard uh reason phrase which is OB obviously okay I'm not going to play that game where you are ask",
    "start": "2603800",
    "end": "2610000"
  },
  {
    "text": "what's the standard reason phrase of 200 it's 200 okay we're going to deal with that however we can extend it we can add",
    "start": "2610000",
    "end": "2617079"
  },
  {
    "text": "a string and say 200 hello world instead of 200 okay so all of a sudden we start",
    "start": "2617079",
    "end": "2622520"
  },
  {
    "text": "responding in ways we choose without depending and without connecting to the origin server that's where we end up in",
    "start": "2622520",
    "end": "2628440"
  },
  {
    "text": "vcl syn so if you go from receive and we do a return syn you'll end up in vcl syn",
    "start": "2628440",
    "end": "2634040"
  },
  {
    "text": "which is the response that will be returned unfor there's a standard template that looks like this so",
    "start": "2634040",
    "end": "2639359"
  },
  {
    "text": "whatever you return will be parsed in a string and a template like this so if you ever see Guru meditation on a page",
    "start": "2639359",
    "end": "2647480"
  },
  {
    "text": "just know someone is probably using uh varnish however you could change that",
    "start": "2647480",
    "end": "2652640"
  },
  {
    "text": "template gear return into to plain text without any additional templating around",
    "start": "2652640",
    "end": "2658000"
  },
  {
    "text": "it you can turn it into Json the fact of the matter is that will use this to",
    "start": "2658000",
    "end": "2664200"
  },
  {
    "text": "return very personalized data by synthetic responses here's where you need to pay",
    "start": "2664200",
    "end": "2669599"
  },
  {
    "text": "attention so imagine having this/ API session endpoint that user uses either a",
    "start": "2669599",
    "end": "2675400"
  },
  {
    "text": "bar authentication token or just a simple session cookie for all you care",
    "start": "2675400",
    "end": "2680599"
  },
  {
    "text": "that is typically uncashable but what we can do is intercept that request and start connecting to the to the session",
    "start": "2680599",
    "end": "2688280"
  },
  {
    "text": "store ourself fetching that data to ensure that this data that is uniquely",
    "start": "2688280",
    "end": "2694839"
  },
  {
    "text": "specific for that user we know whether or not they're logged in and how many items they have in the cart that Json",
    "start": "2694839",
    "end": "2701079"
  },
  {
    "text": "output could be generated by varnish itself if for example we connect to the",
    "start": "2701079",
    "end": "2706400"
  },
  {
    "text": "session store that could happen to be reddis there is a module that's contributed by a guy named Carlos Abal",
    "start": "2706400",
    "end": "2712400"
  },
  {
    "text": "uh friend of the company he doesn't work with us but we work with him uh sometimes and he created this module that you can connect to it yourself and",
    "start": "2712400",
    "end": "2718599"
  },
  {
    "text": "let's say your application uses this structure this is reddis this has nothing to do with varnish you can log into reddis and you can check if that",
    "start": "2718599",
    "end": "2725079"
  },
  {
    "text": "session key exists in the session store it's your application that writes to the session store this is a distributed",
    "start": "2725079",
    "end": "2730599"
  },
  {
    "text": "session store you can have multiple servers in your setup they all connect to that cluster so does it exist if it",
    "start": "2730599",
    "end": "2736800"
  },
  {
    "text": "returns one then the session exists you know that much and then you can do an HM get which means hash multi get you store",
    "start": "2736800",
    "end": "2743960"
  },
  {
    "text": "a hash with multiple properties in that database it might have multiple properties that you want to fetch so we",
    "start": "2743960",
    "end": "2749280"
  },
  {
    "text": "want to fetch the logged in property and the items in card property which returns true yes the user is logged in with that",
    "start": "2749280",
    "end": "2755200"
  },
  {
    "text": "session and there's five items in the cart and that brings us eventually down to the vcl code that we can use where we",
    "start": "2755200",
    "end": "2761680"
  },
  {
    "text": "can at startup time open a connection to reddis intercept in vcl receive the/ API",
    "start": "2761680",
    "end": "2768200"
  },
  {
    "text": "session endpoint which would typically be handled by your application but you're doing it yourself we'll parse the",
    "start": "2768200",
    "end": "2774200"
  },
  {
    "text": "cookie we look for the session ID and if it's not set hey you're not allowed in here this is",
    "start": "2774200",
    "end": "2779240"
  },
  {
    "text": "personal go away 403 if it is we're going to take that cookie set it as a",
    "start": "2779240",
    "end": "2785240"
  },
  {
    "text": "custom request header and return f a synthetic 200 remember synthetic content",
    "start": "2785240",
    "end": "2791200"
  },
  {
    "text": "ends up in vcl syn so all the magic actually happens in vcl syn so what we can do is again intercept API session",
    "start": "2791200",
    "end": "2798880"
  },
  {
    "text": "connect to redus check whether the session exists we already assume that whatever response we return is a Json",
    "start": "2798880",
    "end": "2805880"
  },
  {
    "text": "response so we'll set the content type if the answer is zero that means the session does not exist so you do a 404",
    "start": "2805880",
    "end": "2814599"
  },
  {
    "text": "or a 403 or whatever you want to do then when you get past that you can actually do an HM get which you saw",
    "start": "2814599",
    "end": "2822119"
  },
  {
    "text": "right here right you can do that ask for the logged in status act for the items in cart create a synthetic response body",
    "start": "2822119",
    "end": "2829520"
  },
  {
    "text": "and just return whatever came back and remember this value that you use to identify you extracted it either from I",
    "start": "2829520",
    "end": "2836319"
  },
  {
    "text": "did it using a session ID could be ajacent web token for all I care and that's how you get highly",
    "start": "2836319",
    "end": "2843599"
  },
  {
    "text": "personalized data on the edge without using any of the logic and doing it on the edge is my message here replace your",
    "start": "2843599",
    "end": "2850640"
  },
  {
    "text": "application code with this type of stuff no absolutely not but choose your battles you could have specific items",
    "start": "2850640",
    "end": "2856760"
  },
  {
    "text": "that have a very high pressure on your system and by using simple logic like this if the business logic is that",
    "start": "2856760",
    "end": "2861880"
  },
  {
    "text": "simple at your end just put it there there's a lot more we can do in varnish Enterprise I'm this is not a",
    "start": "2861880",
    "end": "2868680"
  },
  {
    "text": "pitch for varnish Enterprise but I just wanted to show one module that we have that is kind of interesting that is EDG",
    "start": "2868680",
    "end": "2874079"
  },
  {
    "text": "stash which is mustache parsing on the edge so that that means you could use that type of syntax and have a template",
    "start": "2874079",
    "end": "2881720"
  },
  {
    "text": "maybe a page that is cachable but username you would just add the handlebars with username and we would",
    "start": "2881720",
    "end": "2888200"
  },
  {
    "text": "talk to adjacent endpoints parse that and give you the output so here's a little bit of out of context vcl where",
    "start": "2888200",
    "end": "2894839"
  },
  {
    "text": "it pars API session which you saw earlier right you saw that and uh pars",
    "start": "2894839",
    "end": "2900040"
  },
  {
    "text": "the homepage for EDG stash templates and at delivery time just inject the endpoint and go for it it's a fun bit",
    "start": "2900040",
    "end": "2907160"
  },
  {
    "text": "it's more flexible than ESI uh it's not open source unfortunately just wanted to show that it is around and we can use",
    "start": "2907160",
    "end": "2913680"
  },
  {
    "text": "another module that even if your application does not support these handlebars you can inject them and do a",
    "start": "2913680",
    "end": "2919280"
  },
  {
    "text": "find and replace so this code let's not focus too much on the code itself but rather on the use case let's say my",
    "start": "2919280",
    "end": "2926119"
  },
  {
    "text": "website doesn't support the templating and just emits taste as a as a username I could do a find and replace and turn",
    "start": "2926119",
    "end": "2933240"
  },
  {
    "text": "that into a handlebar on the edge without touching the applic code yes",
    "start": "2933240",
    "end": "2938520"
  },
  {
    "text": "tons more stuff we can do there a lot of exciting modules if you want to know more about it you could talk to us about",
    "start": "2938520",
    "end": "2943799"
  },
  {
    "text": "it we even have a control plane to manage it all that kind of jazz uh that's not something we will talk about",
    "start": "2943799",
    "end": "2948880"
  },
  {
    "text": "now if you're interested talk to me what I do want to mention is that you can run this stuff",
    "start": "2948880",
    "end": "2954079"
  },
  {
    "text": "anywhere you want so you can run it on on Prem Hardware as long as it runs Linux it's fine you can run it in the",
    "start": "2954079",
    "end": "2960640"
  },
  {
    "text": "cloud you can run it in Docker even in kubernetes so my advice is if you want to play around with this open open",
    "start": "2960640",
    "end": "2966920"
  },
  {
    "text": "source technology use our official packages if you want to install it on your own servers go to package cloud.",
    "start": "2966920",
    "end": "2972880"
  },
  {
    "text": "varnish cach you'll find dbn and RPM packages we are packaged even our",
    "start": "2972880",
    "end": "2978040"
  },
  {
    "text": "Enterprise stuff is packaged on AWS Azure gcp and Oracle Market places meaning if you have an existing",
    "start": "2978040",
    "end": "2984680"
  },
  {
    "text": "relationship with those companies and they know your credit card details you can even use our Enterprise software with a lot of extra bells and whistles",
    "start": "2984680",
    "end": "2991440"
  },
  {
    "text": "without having to do upfront payments if you want to use the free Docker image which has been downloaded more than 10",
    "start": "2991440",
    "end": "2996720"
  },
  {
    "text": "million times uh you'll find the details on the docker Hub but it's as simple as doing a Docker pull varnish latest and",
    "start": "2996720",
    "end": "3003119"
  },
  {
    "text": "varnish stable there's two variations latest means twice a year on March 15th",
    "start": "3003119",
    "end": "3008200"
  },
  {
    "text": "September 15 we have a new release that is managed by the community and where we as a company have little say in it's the",
    "start": "3008200",
    "end": "3014240"
  },
  {
    "text": "community's project we just we assign resources to it for development but they do it and there could be incompatibility",
    "start": "3014240",
    "end": "3020280"
  },
  {
    "text": "that's whatever is latest however we provide an LTS version as our contribution where we backport features",
    "start": "3020280",
    "end": "3026119"
  },
  {
    "text": "so if you want LTS just do Docker pull varnish stable and it's as simple as as just running it mounting the vcl file in",
    "start": "3026119",
    "end": "3033160"
  },
  {
    "text": "it maybe using environment variable to set up the size and go for it now one of my colleagues also ensured that a lot of",
    "start": "3033160",
    "end": "3039960"
  },
  {
    "text": "extra modules some of which were featured in this presentation are also added so if you use Docker you don't",
    "start": "3039960",
    "end": "3045640"
  },
  {
    "text": "have to compile them yourself but there is an initiative that I'm part of to do more packaging and to ensure that you",
    "start": "3045640",
    "end": "3050839"
  },
  {
    "text": "can use it via dban or RPM packages and if you're running Docker images uh in kubernetes you can use our official Helm",
    "start": "3050839",
    "end": "3057839"
  },
  {
    "text": "chart which was released a couple of weeks ago where you can just do Helm install uh run the helm chart and the",
    "start": "3057839",
    "end": "3065280"
  },
  {
    "text": "values. yaml file that are configurable that's the minimum right your vcl maybe",
    "start": "3065280",
    "end": "3070480"
  },
  {
    "text": "Expos it as a service with no port and be done with it that could be it now I'm",
    "start": "3070480",
    "end": "3076839"
  },
  {
    "text": "about to end I'm ready to end we have 10 minutes left and I would like to talk to the about the future that is even more",
    "start": "3076839",
    "end": "3082760"
  },
  {
    "text": "exciting than what I showed you now so what I showed you is a a language called VC L which is very domain specific and",
    "start": "3082760",
    "end": "3088680"
  },
  {
    "text": "is not out there in the wild you probably don't do a lot with vcl however we have a research project that is",
    "start": "3088680",
    "end": "3094760"
  },
  {
    "text": "taking a decent shape where I'm seeing a lot of progress this year that allows you to run web assembly on the edge so",
    "start": "3094760",
    "end": "3100920"
  },
  {
    "text": "web assembly being a compilation Target here's some stupid wat code which is the text textual version of wasm wasm is an",
    "start": "3100920",
    "end": "3109000"
  },
  {
    "text": "instruction set a lot of languages have a compile Target for it so these web assembly files you can basically run",
    "start": "3109000",
    "end": "3114880"
  },
  {
    "text": "them on the edge we have a project to do that so whether you're writing it in uh",
    "start": "3114880",
    "end": "3121000"
  },
  {
    "text": "in C or you're you're doing it in go or in rust or in JavaScript as long as the output is a wasm file and you respect a",
    "start": "3121000",
    "end": "3128599"
  },
  {
    "text": "couple of apis that we provide you some Wy interfaces you can run it so no need for everything vcl so that's a",
    "start": "3128599",
    "end": "3135559"
  },
  {
    "text": "transition we're making in our mindset not specifically from the open source Community but for us as a company is we",
    "start": "3135559",
    "end": "3140920"
  },
  {
    "text": "want to go low code no code or different types of code we want to give developers the freedom to do it whichever way they",
    "start": "3140920",
    "end": "3146319"
  },
  {
    "text": "want and the project name is Project Sledgehammer uh hammer because it's",
    "start": "3146319",
    "end": "3151960"
  },
  {
    "text": "powerful you can hit things with it but uh Edge Sledge well the edge part speaks",
    "start": "3151960",
    "end": "3157319"
  },
  {
    "text": "for itself right uh I can show you a little bit of code but it's still all in flux so our developers pretty much asked",
    "start": "3157319",
    "end": "3163880"
  },
  {
    "text": "me to add this disclaimer that everything you're seeing is very experimental and uh likely to change so",
    "start": "3163880",
    "end": "3170079"
  },
  {
    "text": "what you could do is in your vcl you could bootstrap a folder where your WM file is and some rollup config just run",
    "start": "3170079",
    "end": "3177119"
  },
  {
    "text": "it and you're no longer bound by vcl and the capabilities of the language because",
    "start": "3177119",
    "end": "3183680"
  },
  {
    "text": "again the language has its limitations as well you can only go so far so here's some uh I replaced ugly uh",
    "start": "3183680",
    "end": "3190559"
  },
  {
    "text": "vcl code with ugly JavaScript code why because I'm not really that good at JavaScript but what this pretty much",
    "start": "3190559",
    "end": "3195839"
  },
  {
    "text": "does is it does uh alization as well it checks it sets a JWT in JavaScript and",
    "start": "3195839",
    "end": "3204440"
  },
  {
    "text": "even if you don't like the code and even if you don't read just remember you can import mpm packages you compile it and",
    "start": "3204440",
    "end": "3210240"
  },
  {
    "text": "we'll take it from there we'll take the wasm file that contains everything maybe some additional rollup config that you",
    "start": "3210240",
    "end": "3215839"
  },
  {
    "text": "passed to us and we'll just run it on the edge so this will check the endpoint we'll do basic authentication if the",
    "start": "3215839",
    "end": "3222079"
  },
  {
    "text": "username and PAW match we'll set a JWT and uh and we'll continue on with it and what we will then do is we'll take the",
    "start": "3222079",
    "end": "3228880"
  },
  {
    "text": "value of that Json web token and do a find and replace in the output prior to storing it in cash using some Dom logic",
    "start": "3228880",
    "end": "3236160"
  },
  {
    "text": "and uh uh yeah store it in there so long story short or very long story short",
    "start": "3236160",
    "end": "3243599"
  },
  {
    "text": "we're working on something that supports wasm so that you can express yourself in the language you feel comfortable with",
    "start": "3243599",
    "end": "3249079"
  },
  {
    "text": "and a lot of languages now support wasm as a compilation Target we'll respect that instruction set we'll run it uh in",
    "start": "3249079",
    "end": "3256079"
  },
  {
    "text": "different shapes and flavors and the future Sledgehammer will be even more important to us it's developed by us not",
    "start": "3256079",
    "end": "3261960"
  },
  {
    "text": "by the community but it is Our intention to open source it provide it to the community and build an open platform for",
    "start": "3261960",
    "end": "3267839"
  },
  {
    "text": "for Edge logic we'll also improve our productization on on the marketplace so",
    "start": "3267839",
    "end": "3273920"
  },
  {
    "text": "if you want to run stuff with open source or Enterprise or whatever we build as an intermediary product uh in",
    "start": "3273920",
    "end": "3280920"
  },
  {
    "text": "on AWS on Azure gcp Oracle and other marketplaces we'll put a strong emphasis on that so that you can do more on the",
    "start": "3280920",
    "end": "3287599"
  },
  {
    "text": "edge we'll try to be a first class citizen in the cloud native ecosystem doing more with kubernetes uh one of the",
    "start": "3287599",
    "end": "3293720"
  },
  {
    "text": "plans is even to create a varnish based Ingress controller or gateway to ensure that the caching happens in front of the",
    "start": "3293720",
    "end": "3299319"
  },
  {
    "text": "cluster rather than running it with Docker images on the side packaging more modules so you have more ways of",
    "start": "3299319",
    "end": "3305240"
  },
  {
    "text": "expressing Edge logic and finally uh maybe improve the varnish configuration language and add more",
    "start": "3305240",
    "end": "3311839"
  },
  {
    "text": "features ladies and gentlemen we've reached that limit we've reached that point where we can comfortably end it I",
    "start": "3311839",
    "end": "3318280"
  },
  {
    "text": "know there was a lot of information in there last thing I need to do is I need to give you this book if anyone wants it",
    "start": "3318280",
    "end": "3324000"
  },
  {
    "text": "a lot of the stuff I talked about is in there even the B Basics are in there everything about HTTP caching so if",
    "start": "3324000",
    "end": "3329760"
  },
  {
    "text": "you're interested I'm just going to put that here I'm going to walk off stage in a second and if it's gone it is gone",
    "start": "3329760",
    "end": "3336160"
  },
  {
    "text": "that being said thank you for sticking around toam again I don't speak Norwegian so",
    "start": "3336160",
    "end": "3342119"
  },
  {
    "text": "I'll do it in Swedish thanks a lot uh it was an absolute pleasure I know you have options I know there's a bunch of",
    "start": "3342119",
    "end": "3348039"
  },
  {
    "text": "parallel sessions you chose to be with me I fully appreciate that and I'll see you next time",
    "start": "3348039",
    "end": "3355519"
  },
  {
    "text": "and of course questions uh we'll do that on a more personal note right no one wants to hear each other's questions so",
    "start": "3357760",
    "end": "3363880"
  },
  {
    "text": "if you have questions show up I'll try to answer them",
    "start": "3363880",
    "end": "3369119"
  }
]