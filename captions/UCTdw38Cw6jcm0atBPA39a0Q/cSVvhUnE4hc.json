[
  {
    "text": "and today we're going to talk about some fun kubernetes things and that I have learned the hard way",
    "start": "4799",
    "end": "12000"
  },
  {
    "text": "a little bit about me my name is David my accent is Scottish I'm from a study",
    "start": "12000",
    "end": "17039"
  },
  {
    "text": "called Glasgow I am the founder of the Rockwood Academy this is a YouTube channel that focuses",
    "start": "17039",
    "end": "23820"
  },
  {
    "text": "on making Cloud native and kubernetes easier for people and through series like clustert has",
    "start": "23820",
    "end": "31140"
  },
  {
    "text": "anyone seen clustered before all right just a few of you for the rest",
    "start": "31140",
    "end": "36300"
  },
  {
    "text": "of you um it's a live stream that we do quite regularly where you get to watch me cry a lot",
    "start": "36300",
    "end": "42840"
  },
  {
    "text": "I also am the organizer of a new kubernetes conference in Scotland her first one is actually on Monday it's",
    "start": "42840",
    "end": "49020"
  },
  {
    "text": "called coup puddle and so I'm looking forward to that too and generally my mission is just to make",
    "start": "49020",
    "end": "54120"
  },
  {
    "text": "this easier for people and Cloud native and kubernetes is is pretty hard so if you're here and you're in that space",
    "start": "54120",
    "end": "60440"
  },
  {
    "text": "yeah congratulations on commiserations the custard is a relatively simple idea",
    "start": "60440",
    "end": "68540"
  },
  {
    "text": "it was around two years ago where I had this silly idea that I'm I'm quite good",
    "start": "68540",
    "end": "75119"
  },
  {
    "text": "with kubernetes I've operated kubernetes now for around six seven years and I thought how can we help people prepare",
    "start": "75119",
    "end": "82439"
  },
  {
    "text": "to do the cka the ckad the cks ETC and I don't know about you but I'm a very",
    "start": "82439",
    "end": "88320"
  },
  {
    "text": "tactile learner I don't really learn from reading a lot I learned by getting",
    "start": "88320",
    "end": "93840"
  },
  {
    "text": "my hands on a keyboard and trying to do something and I thought well why don't I do that in a live stream and then it's",
    "start": "93840",
    "end": "100320"
  },
  {
    "text": "available for other people to see how these situations are debuffed this is really important on clustered like there",
    "start": "100320",
    "end": "106860"
  },
  {
    "text": "are a lot of ways to break a kubernetes cluster but we do see repeat breaks and what's really fascinating is that each",
    "start": "106860",
    "end": "112920"
  },
  {
    "text": "person that joins me on the show they have a different way that they first understand the landscape so what's wrong",
    "start": "112920",
    "end": "118979"
  },
  {
    "text": "and then start to debug it and it's actually those thought processes that they share with people on the stream",
    "start": "118979",
    "end": "124979"
  },
  {
    "text": "that's more important than the actual fixing itself the fixing it's just something that's kind of mildly entertaining as you go along",
    "start": "124979",
    "end": "132000"
  },
  {
    "text": "so it should be simple your mission is to take a deployment which is running a bespoke clustered application there's a",
    "start": "132000",
    "end": "138599"
  },
  {
    "text": "V1 and a V2 all you need to do is change that deployment from B1 to V2",
    "start": "138599",
    "end": "144239"
  },
  {
    "text": "easy right well it turns out it's not that easy as I said there are a lot a lot of ways to break the kubernetes",
    "start": "144239",
    "end": "150300"
  },
  {
    "text": "cluster and what I want to do with this talk is just guide you through some of the core domains that I feel people",
    "start": "150300",
    "end": "156420"
  },
  {
    "text": "should be more familiar with when operating kubernetes and some tips along the way",
    "start": "156420",
    "end": "162079"
  },
  {
    "text": "now here's something that I've also learned after I think we're in 50 episodes people are very mean",
    "start": "162239",
    "end": "169140"
  },
  {
    "text": "uh people don't just put titles and config files and call the cluster broken we've",
    "start": "169140",
    "end": "175920"
  },
  {
    "text": "seen people actually downgrade the kiblet on a machine by about 20 or 30 versions",
    "start": "175920",
    "end": "183379"
  },
  {
    "text": "I don't know about you I've never thought to run cubelet-version to check what version is running on my cluster I",
    "start": "184620",
    "end": "190319"
  },
  {
    "text": "made some assumptions assumptions that clearly we can't make because we don't trust people we've also had people recompile the API",
    "start": "190319",
    "end": "197700"
  },
  {
    "text": "server actually write their own code compile it and ship it onto my clusters",
    "start": "197700",
    "end": "203220"
  },
  {
    "text": "and I don't like these people however we've had people comment saying",
    "start": "203220",
    "end": "209040"
  },
  {
    "text": "well these aren't real world and I actually disagree now sure human error",
    "start": "209040",
    "end": "214200"
  },
  {
    "text": "is a big part of operating kubernetes mistakes happen tables happen and we revert commits and maybe we got the",
    "start": "214200",
    "end": "219840"
  },
  {
    "text": "rebates wrong how many times have you had a commit message or a code change that's got those three little less than",
    "start": "219840",
    "end": "225120"
  },
  {
    "text": "adults happens all the time but security and your security posture intrusion are",
    "start": "225120",
    "end": "231599"
  },
  {
    "text": "real concerns people can get access to your cluster now with the downgrade accupulate by 20 or 30 versions probably",
    "start": "231599",
    "end": "238620"
  },
  {
    "text": "not but would they inject their own API server to log stuff to some remote location potentially",
    "start": "238620",
    "end": "245040"
  },
  {
    "text": "so well some of the scenarios and some of the breaks that we've seen may not be something that you deal with on a",
    "start": "245040",
    "end": "250799"
  },
  {
    "text": "regular basis we do need to understand what we're working with so I'm going to cheat for the next three",
    "start": "250799",
    "end": "258479"
  },
  {
    "text": "minutes and show you a short clip of an episode of clustered you will hear me swear I'm really sorry",
    "start": "258479",
    "end": "264120"
  },
  {
    "text": "um clustered gets very frustrating and this was a particularly long episode and but I'm going to show you a small clip",
    "start": "264120",
    "end": "269400"
  },
  {
    "text": "just now yeah we still have no cluster DNS 50s has endpoint uh look at that after a",
    "start": "269400",
    "end": "278880"
  },
  {
    "text": "foreign",
    "start": "278880",
    "end": "281540"
  },
  {
    "text": "[Music] s",
    "start": "288540",
    "end": "295160"
  },
  {
    "text": "are configured to run the DNS",
    "start": "295160",
    "end": "300800"
  },
  {
    "text": "it's always DNS",
    "start": "301820",
    "end": "305660"
  },
  {
    "text": "all right did we miss something I'm going to say chi let's I'm going to",
    "start": "308960",
    "end": "316500"
  },
  {
    "text": "jump onto cluster uh 14. and see what's different",
    "start": "316500",
    "end": "322620"
  },
  {
    "text": "what about uh yeah these are the exact same fail so he",
    "start": "322620",
    "end": "328800"
  },
  {
    "text": "told us to look in the court DNS config and then there's nothing wrong with the chord DNS clip that's just cruel",
    "start": "328800",
    "end": "335699"
  },
  {
    "text": "and there's a few pixels this is a white space editor in the core",
    "start": "335699",
    "end": "341520"
  },
  {
    "text": "DNS config I would be amazing frustrated",
    "start": "341520",
    "end": "346698"
  },
  {
    "text": "it might not be a white space error yeah um",
    "start": "349139",
    "end": "356280"
  },
  {
    "text": "he's mocking us now because he said you're jumping back and forward showed a slight difference",
    "start": "356280",
    "end": "362100"
  },
  {
    "text": "this number seems arbitrary yeah I'm assuming",
    "start": "362100",
    "end": "367979"
  },
  {
    "text": "there's like a weird bug and I'm sure he's found it because he works at Skyscanner and they've got a level of",
    "start": "367979",
    "end": "373320"
  },
  {
    "text": "skill that most people don't have something to do with this number going",
    "start": "373320",
    "end": "379199"
  },
  {
    "text": "so high is maybe causing it to load an old config map in the pods",
    "start": "379199",
    "end": "384360"
  },
  {
    "text": "or something I don't really know but the number being so high worries me",
    "start": "384360",
    "end": "392759"
  },
  {
    "text": "um but we're now at the stage where I have to go and pick up my daughter so yeah",
    "start": "392759",
    "end": "398880"
  },
  {
    "text": "I'm just going to bring guy in to tell us what wonderful magic I wish to play yeah this is yeah all right guys",
    "start": "398880",
    "end": "406620"
  },
  {
    "text": "really honest uh so when you were jumping back and",
    "start": "406620",
    "end": "412919"
  },
  {
    "text": "forth between the working complex and the non-working contract",
    "start": "412919",
    "end": "418139"
  },
  {
    "text": "um if you look really hard at the sea in front of the in the kubernetes conflict",
    "start": "418139",
    "end": "424939"
  },
  {
    "text": "oh the sea uh yeah",
    "start": "427139",
    "end": "435199"
  },
  {
    "text": "it's a character which looks a lot like what so the kubernetes plugin became",
    "start": "435199",
    "end": "443220"
  },
  {
    "text": "authoritative for letter that looks like see luster.local",
    "start": "443220",
    "end": "449880"
  },
  {
    "text": "I hate that guy 's a good friend of mine uh he's from",
    "start": "450060",
    "end": "455699"
  },
  {
    "text": "Glasgow too he does work at Skyscanner he's also the co-chair of stego Auto scaling so when I invited him on I",
    "start": "455699",
    "end": "462180"
  },
  {
    "text": "thought we're going to get a really cool Auto skill in the bug we got a Unicode book um",
    "start": "462180",
    "end": "468120"
  },
  {
    "text": "what I like about this clip is I was beginning to challenge really",
    "start": "468120",
    "end": "474240"
  },
  {
    "text": "silly things I thought that 800 000 was going to cause some sort of integer overflow why of course it doesn't make",
    "start": "474240",
    "end": "481440"
  },
  {
    "text": "any sense like let's go like it's not going to happen unless we use an Aboriginal small hint but you get into this mindset when",
    "start": "481440",
    "end": "488639"
  },
  {
    "text": "you're debugging and sometimes you just don't know what to look at um so I think it's just important to highlight that",
    "start": "488639",
    "end": "494759"
  },
  {
    "text": "well I have a lot of experience sometimes if you just don't know the answer you're never going to see it",
    "start": "494759",
    "end": "501419"
  },
  {
    "text": "um yeah so there's lots of episodes like that sadly",
    "start": "501419",
    "end": "506699"
  },
  {
    "text": "now there were no rules in clustered that has no changed we no longer allow",
    "start": "506699",
    "end": "512339"
  },
  {
    "text": "you any good breaks well they were fun the first time it's not something we want to encourage",
    "start": "512339",
    "end": "517740"
  },
  {
    "text": "and the only other ruling cluster today is no saturation attacks and we had one",
    "start": "517740",
    "end": "524219"
  },
  {
    "text": "break where they actually filled the desk so the machine wouldn't start and I can't fix a cluster if the machine isn't",
    "start": "524219",
    "end": "530580"
  },
  {
    "text": "online yeah so a couple of rules but really if",
    "start": "530580",
    "end": "535680"
  },
  {
    "text": "you want to join me on cluster feel free to talk to me after but you can break anything in the kubernetes control plane and I'll sit down with someone else from",
    "start": "535680",
    "end": "542220"
  },
  {
    "text": "the kubernetes community again that could be one of you here and we'll try and fix it on our live stream funnily enough it's quite hard to find",
    "start": "542220",
    "end": "548700"
  },
  {
    "text": "people that are willing to sit in the live stream for 90 minutes and fix something when they have no idea what's wrong",
    "start": "548700",
    "end": "554839"
  },
  {
    "text": "so I also think it's important to highlight the failure is just how we learn and you know I think we need to",
    "start": "557100",
    "end": "563040"
  },
  {
    "text": "get better about talking about failure especially senior and principal Engineers you know it's really important that we are more public about the things",
    "start": "563040",
    "end": "568920"
  },
  {
    "text": "that we we don't know the things that we learn and share that with people to set better Norms in the future",
    "start": "568920",
    "end": "574620"
  },
  {
    "text": "and I'm going to guide you now through the road to kubernetes and over the last 50-ish episodes and I've seen lots of",
    "start": "574620",
    "end": "582240"
  },
  {
    "text": "different breaks I wanted to distill them down into around nine tips and tricks across the different domains that",
    "start": "582240",
    "end": "588360"
  },
  {
    "text": "you need to understand in order to operate kubernetes successfully and of course we have to start with",
    "start": "588360",
    "end": "594240"
  },
  {
    "text": "Linux kubernetes runs on Linux I guess it runs on Windows I don't do that I can't help you with that but I can help",
    "start": "594240",
    "end": "600660"
  },
  {
    "text": "you with Linux oh yeah I forgot that this is a much smaller clip and it's just to set the",
    "start": "600660",
    "end": "606480"
  },
  {
    "text": "scene for something so it's just a minute long and then we'll I'll talk about what we've just seen",
    "start": "606480",
    "end": "611959"
  },
  {
    "text": "permission oh and you've hit your first snag there you",
    "start": "615620",
    "end": "622860"
  },
  {
    "text": "go okay make it plus six",
    "start": "622860",
    "end": "628560"
  },
  {
    "text": "yeah I need my auto complete stuff I'm lost",
    "start": "628560",
    "end": "633899"
  },
  {
    "text": "you didn't install fish while you're here too I can I can type one",
    "start": "633899",
    "end": "640399"
  },
  {
    "text": "oh okay okay",
    "start": "640740",
    "end": "644640"
  },
  {
    "text": "it's an interesting start yes yes do an Ellis show a on user bin",
    "start": "646019",
    "end": "653640"
  },
  {
    "text": "uh change password probably just in change mode",
    "start": "653640",
    "end": "658819"
  },
  {
    "text": "oh Father you don't even have tab completion",
    "start": "661140",
    "end": "666380"
  },
  {
    "text": "but hey we'll make it one if you're doing I think that's oh wait because you",
    "start": "666380",
    "end": "671760"
  },
  {
    "text": "can't come on yeah just look at the whole slash Advan is",
    "start": "671760",
    "end": "677760"
  },
  {
    "text": "there anything we should well LS is obviously",
    "start": "677760",
    "end": "683640"
  },
  {
    "text": "all right so this was another really served up at this episode um this was cedaro Labs who actually",
    "start": "683640",
    "end": "690480"
  },
  {
    "text": "have their own kubernetes based operating system so they understand Linux and kubernetes extremely well they",
    "start": "690480",
    "end": "697680"
  },
  {
    "text": "write their own pet one all the services on the machine speak over grpc and the",
    "start": "697680",
    "end": "703740"
  },
  {
    "text": "kubernetes stuff is all running in containers it's very Advanced very smart team",
    "start": "703740",
    "end": "708839"
  },
  {
    "text": "the other team that broke this cluster was red hat they also know a few things about Linux",
    "start": "708839",
    "end": "714720"
  },
  {
    "text": "and this was in the first two minutes of this episode and you can see from a screenshot you know Green is a usual",
    "start": "714720",
    "end": "721920"
  },
  {
    "text": "symbol for us that tells us that a fail is executable and if you look at the white ones in here this is extremely intentional",
    "start": "721920",
    "end": "730339"
  },
  {
    "text": "they have no chemod they have no change attributes no Cube admin no Cube control",
    "start": "730560",
    "end": "736560"
  },
  {
    "text": "why they stuck OC on there I have no idea they have no SCP so they can't even",
    "start": "736560",
    "end": "741899"
  },
  {
    "text": "transfer fails remotely back onto the machine and they have no peril",
    "start": "741899",
    "end": "747180"
  },
  {
    "text": "who knows how to fix chimod when you can't execute chemod without chemod",
    "start": "747180",
    "end": "754519"
  },
  {
    "text": "I do know um so the easiest way to do this would be",
    "start": "754860",
    "end": "761160"
  },
  {
    "text": "in Peril that would have been what I went for and I suppose you could maybe do this with python too but Peril has really closed uh direct support to other",
    "start": "761160",
    "end": "768360"
  },
  {
    "text": "executables on the machine so you can use chemot however they removed the executable bit from peril",
    "start": "768360",
    "end": "773700"
  },
  {
    "text": "you can't do much without Cube control and change attributes is something we've seen on clustered more than once as well",
    "start": "773700",
    "end": "779639"
  },
  {
    "text": "who knows what attributes are on a Linux fail system right there's like two hands",
    "start": "779639",
    "end": "785639"
  },
  {
    "text": "and so we all know you can do a chemod which allows us to change read write and",
    "start": "785639",
    "end": "790920"
  },
  {
    "text": "executable bits and one other I wouldn't touch on that just now and but there's also something called attributes which",
    "start": "790920",
    "end": "796079"
  },
  {
    "text": "allows you to modify things at a much deeper level one of them being immutability you can actually Mark fails",
    "start": "796079",
    "end": "801899"
  },
  {
    "text": "as immutable on one episode of clustered we've seen someone Mark the entire logs directory as immutable",
    "start": "801899",
    "end": "808860"
  },
  {
    "text": "so people were trying to debug a broken cluster going where are all the logs and none of the processes could write a",
    "start": "808860",
    "end": "815279"
  },
  {
    "text": "lot and that was particularly evil too so we see a lot of stuff um but it's through this misery that we",
    "start": "815279",
    "end": "823200"
  },
  {
    "text": "face on cluster that we learn really cool things so how do we fix chemod without chemod",
    "start": "823200",
    "end": "829260"
  },
  {
    "text": "well it turns out you can actually use the dynamic Linker directly so you can find that the ldlinux.so on a",
    "start": "829260",
    "end": "836820"
  },
  {
    "text": "machine and you can pass it another binary and it will execute it without checking for executable bit meaning you",
    "start": "836820",
    "end": "843180"
  },
  {
    "text": "can chemod the Chipmunk so nice tip fail attributes uh once you know they're",
    "start": "843180",
    "end": "850560"
  },
  {
    "text": "there they're much easier to understand you can use LS attribute and change attributes the only one that we've",
    "start": "850560",
    "end": "856139"
  },
  {
    "text": "really seen cause any destruction on clustered is the immutability flag so if you ever see that eye on attributes then",
    "start": "856139",
    "end": "862320"
  },
  {
    "text": "you know that the sum process is not going to be able to rate your fail or directory Etc",
    "start": "862320",
    "end": "869300"
  },
  {
    "text": "no I said Serendipity earlier there was one other very very certain type of this",
    "start": "870540",
    "end": "875639"
  },
  {
    "text": "episode there was an episode with Crest Nova who knows Chris all right a couple of hats Robert Thomas",
    "start": "875639",
    "end": "882180"
  },
  {
    "text": "Stromberg okay let me fill you in Chris Nova is a security researcher engineer currently",
    "start": "882180",
    "end": "888899"
  },
  {
    "text": "at twilio formerly Google heptel really knows our stuff also a bit of a kernel hacker",
    "start": "888899",
    "end": "895920"
  },
  {
    "text": "so we were expecting big things Thomas Stromberg also formerly Google that intrusion detection was a",
    "start": "895920",
    "end": "902699"
  },
  {
    "text": "maintainer of many Cube and has worked directly on the kubernetes components those two just happened to be on this",
    "start": "902699",
    "end": "909060"
  },
  {
    "text": "episode together but under no under no other circumstances would anyone else who fixed Chrissy's broken cluster",
    "start": "909060",
    "end": "916260"
  },
  {
    "text": "Chris was using LD preload to remove ciscals from all executables on the",
    "start": "916260",
    "end": "921420"
  },
  {
    "text": "machine use an ebpf to hide a process on the machine that was doing naughty stuff in the background",
    "start": "921420",
    "end": "926880"
  },
  {
    "text": "when you run Cube control get pods it just displayed a big message saying this cluster is essentially screwed",
    "start": "926880",
    "end": "933660"
  },
  {
    "text": "however Thomas has done intrusion detection at Google and the first thing he did on this",
    "start": "933660",
    "end": "940260"
  },
  {
    "text": "machine was installed something called Swift kit and I'm going to ask you to raise your hands one more time but I",
    "start": "940260",
    "end": "945360"
  },
  {
    "text": "don't expect to see any who's heard of Swift kit why would you right well Swift cat is",
    "start": "945360",
    "end": "952920"
  },
  {
    "text": "this really old piece of software that runs on Windows BSD Mac and Linux it's",
    "start": "952920",
    "end": "958199"
  },
  {
    "text": "been used for intrusion detection for nearly 20 years and it has really cool tools that allow you to get very low",
    "start": "958199",
    "end": "963420"
  },
  {
    "text": "level with the fail system and the kernel one of those tools is fls",
    "start": "963420",
    "end": "968639"
  },
  {
    "text": "fls will actually take a snapshot of all the changes on a fail system for any",
    "start": "968639",
    "end": "974040"
  },
  {
    "text": "given period of time so he logs on installs lift kit run as",
    "start": "974040",
    "end": "979860"
  },
  {
    "text": "fls command and he had a directory with a whole bunch of blobs that told him everything Chris had done in that",
    "start": "979860",
    "end": "985920"
  },
  {
    "text": "cluster in the last 24 hours it was pretty neat",
    "start": "985920",
    "end": "991380"
  },
  {
    "text": "no of course some things are rather opaque right we see the hcd changed but what changed",
    "start": "991380",
    "end": "997019"
  },
  {
    "text": "we had no idea so with regards to modifying system D unit fails modifying cubic configurations API",
    "start": "997019",
    "end": "1003920"
  },
  {
    "text": "servers container D configuration all of that was just right in front of them but obviously anything within the kubernetes",
    "start": "1003920",
    "end": "1009620"
  },
  {
    "text": "API we still have to revert to traditional debugging techniques however fls is a cool tool and the fact that it",
    "start": "1009620",
    "end": "1017000"
  },
  {
    "text": "runs everywhere is pretty awesome and you can run that on your own machine it's amazing how much information you",
    "start": "1017000",
    "end": "1022519"
  },
  {
    "text": "get you can even see even files have been deleted and there is the potential to restore some deleted fails and but",
    "start": "1022519",
    "end": "1027918"
  },
  {
    "text": "there's a whole bunch of semantics on how that works and whether whether it will be successful",
    "start": "1027919",
    "end": "1034839"
  },
  {
    "text": "so that's our Linux tips we're going to move on to the other Dark Art of kubernetes which is networking",
    "start": "1035480",
    "end": "1041959"
  },
  {
    "text": "unfortunately if you're operating a kubernetes cluster you do have to get very comfortable with networking because",
    "start": "1041959",
    "end": "1047360"
  },
  {
    "text": "there's a lot of magic happening especially with modern advancements in ebpf and XDP through cni projects like",
    "start": "1047360",
    "end": "1053720"
  },
  {
    "text": "psyllium now if you're using one of these new",
    "start": "1053720",
    "end": "1059600"
  },
  {
    "text": "fancy shiny cnis which I assume we all are these days we have core we have",
    "start": "1059600",
    "end": "1065360"
  },
  {
    "text": "Network and V1 networking policies these are the base networking policies that are in your kubernetes cluster and of",
    "start": "1065360",
    "end": "1071600"
  },
  {
    "text": "course we need to be able to understand them and those are a good first place to check however",
    "start": "1071600",
    "end": "1076760"
  },
  {
    "text": "all these other cnis now bring in their own custom resources celium has cluster",
    "start": "1076760",
    "end": "1082220"
  },
  {
    "text": "Network policies no celium network policies and sodium cluster-wide Network policies and this year",
    "start": "1082220",
    "end": "1089059"
  },
  {
    "text": "they released local redirect policies and so there's a lot of ways to adjust",
    "start": "1089059",
    "end": "1094880"
  },
  {
    "text": "how your traffic is working within the cluster what's also quite special about what psyllium are offering is it's not just",
    "start": "1094880",
    "end": "1101299"
  },
  {
    "text": "L4 based policies but they offer L7 based policies what that means is you",
    "start": "1101299",
    "end": "1106640"
  },
  {
    "text": "have actual protocol awareness first a set HTTP DNS I think some databases are",
    "start": "1106640",
    "end": "1114140"
  },
  {
    "text": "supported where you can actually intermittently break traffic to certain domains or ports or even block",
    "start": "1114140",
    "end": "1121760"
  },
  {
    "text": "individual DNS queries against a subset of the internet lots of stuff lots of magic and you",
    "start": "1121760",
    "end": "1128360"
  },
  {
    "text": "might not know where to get started next the thing I hate most about",
    "start": "1128360",
    "end": "1133940"
  },
  {
    "text": "kubernetes and there are a lot of them but this one really frustrates me because it's one of these things that passes the eyeball test",
    "start": "1133940",
    "end": "1140419"
  },
  {
    "text": "who's ever changed the DNS policy on a pod okay well there's a DNS policy called",
    "start": "1140419",
    "end": "1147380"
  },
  {
    "text": "default do you know which the default DNS policy is it's not default",
    "start": "1147380",
    "end": "1152559"
  },
  {
    "text": "why the default policy actually tells the cluster to use the default DNS",
    "start": "1152559",
    "end": "1158240"
  },
  {
    "text": "resolution of the host typically systemd result d the default kubernetes DNS policy is",
    "start": "1158240",
    "end": "1165140"
  },
  {
    "text": "cluster first now I hope one day that can be changed but unfortunately that's which is where",
    "start": "1165140",
    "end": "1170419"
  },
  {
    "text": "we are and again we learned this the hard way someone changed the DNS policy in a pod I'm scanning it I'm going to",
    "start": "1170419",
    "end": "1175820"
  },
  {
    "text": "default sure whatever adjust the default and and of course we had no internal DNS",
    "start": "1175820",
    "end": "1180860"
  },
  {
    "text": "resolution within that cluster also iptables as a fundamental skill",
    "start": "1180860",
    "end": "1186799"
  },
  {
    "text": "still even with some of these ebpf and XDP tools within our cluster and could proxy is still heavy heavily relies on",
    "start": "1186799",
    "end": "1194059"
  },
  {
    "text": "iptables or EBT plus NF tables Etc but there's also another part of the",
    "start": "1194059",
    "end": "1199220"
  },
  {
    "text": "networking stack which I learned the hard way on clustered who knows what the TC command is",
    "start": "1199220",
    "end": "1205640"
  },
  {
    "text": "oh a couple of hands there you go I know now but the TC command is called traffic",
    "start": "1205640",
    "end": "1210799"
  },
  {
    "text": "control and that allows you to apply quality of service and to different types of requests within your cluster so",
    "start": "1210799",
    "end": "1216679"
  },
  {
    "text": "what actually happens is someone used traffic control to drop a 95 rejection rate on all HTTP traffic within my",
    "start": "1216679",
    "end": "1222559"
  },
  {
    "text": "cluster people are cruel",
    "start": "1222559",
    "end": "1227840"
  },
  {
    "text": "so I'm looking at IP tables like because I know iptos I can run I can list all the chains I can list all the rules but",
    "start": "1227840",
    "end": "1232880"
  },
  {
    "text": "I had no idea about TC and then we've got evpf evpf is a phenomenal tool and I'm going to talk",
    "start": "1232880",
    "end": "1238880"
  },
  {
    "text": "more about it later but it's also rather opaque when someone runs something with ebpf in your cluster you're not",
    "start": "1238880",
    "end": "1245419"
  },
  {
    "text": "necessarily sure that it's there it's very hard to discover and find and even harder to tweak and modify unless you",
    "start": "1245419",
    "end": "1251960"
  },
  {
    "text": "know exactly what's been done but the technology itself is pretty special",
    "start": "1251960",
    "end": "1257799"
  },
  {
    "text": "now if you want to make your networking life easier on kubernetes and I know the screenshot's not that big but it's also",
    "start": "1258380",
    "end": "1264020"
  },
  {
    "text": "not that important um but you have this tool called Hubble from psyllium this is a user interface that runs in your",
    "start": "1264020",
    "end": "1270380"
  },
  {
    "text": "cluster why do we need a user interface for networking because you can run Cube control get net policy",
    "start": "1270380",
    "end": "1278380"
  },
  {
    "text": "npccmps that's all the network policies within the celium stack and you'll list them all but it's actually really",
    "start": "1278380",
    "end": "1284900"
  },
  {
    "text": "difficult to have a visualization of what traffic is actually moving around your cluster you can read all the ammo",
    "start": "1284900",
    "end": "1291260"
  },
  {
    "text": "but you're never I mean I'm not a visual learner I can't visualize things in my mind but this UI is essential and can be",
    "start": "1291260",
    "end": "1298700"
  },
  {
    "text": "essential so you can see all the pods all the services you can see arrows that show which ones are speaking to which",
    "start": "1298700",
    "end": "1303919"
  },
  {
    "text": "and then there's even tools which you'll see in just a moment that allow you to modify that as well so Hubble is a",
    "start": "1303919",
    "end": "1309559"
  },
  {
    "text": "fantastic tool and but only if you're using psyllium unfortunately",
    "start": "1309559",
    "end": "1315340"
  },
  {
    "text": "there's also a Hubble CLI so I like to use Hubble as a UI to understand the the",
    "start": "1315559",
    "end": "1321620"
  },
  {
    "text": "kind of spread of services and what's happening but if I want to be able to start debugging problems I want to start",
    "start": "1321620",
    "end": "1326780"
  },
  {
    "text": "understanding individual flows you can drop down to Hubble observe",
    "start": "1326780",
    "end": "1332059"
  },
  {
    "text": "Hubble observe you can see here we're doing a filter for drop packets and then I'm doing an additional pipe to grip because I'm looking for things that are",
    "start": "1332059",
    "end": "1338659"
  },
  {
    "text": "messing around with postgres instead of my cluster and this was actually a cluster that I broke for the psyllium",
    "start": "1338659",
    "end": "1344659"
  },
  {
    "text": "team um and I used their local redirect policies had been released for about 48",
    "start": "1344659",
    "end": "1350000"
  },
  {
    "text": "hours maybe a week at the max so I threw one in and what the local redirect policy should be used for is if you want",
    "start": "1350000",
    "end": "1357440"
  },
  {
    "text": "to run like DNS caches across all of your nodes in your clusters well they don't go over the networking stack then you can local redirect all DNS requests",
    "start": "1357440",
    "end": "1364280"
  },
  {
    "text": "to the local pod however I was a bit more sneaky and said all traffic going to postgres let's just",
    "start": "1364280",
    "end": "1369500"
  },
  {
    "text": "throw it to fluent D instead plenty doesn't listen on Port 5432 so",
    "start": "1369500",
    "end": "1375860"
  },
  {
    "text": "um they were able to run Hubble observe and actually find oh look why is our postgres traffic going to the Food Depot",
    "start": "1375860",
    "end": "1382039"
  },
  {
    "text": "so really good ability to understand individual flows um I love the Hubble UI and the CLI both phenomenal tools",
    "start": "1382039",
    "end": "1389179"
  },
  {
    "text": "and because isovalent haven't given us enough awesome stuff they've given us one more thing",
    "start": "1389179",
    "end": "1394220"
  },
  {
    "text": "the celium editor so you can go to editor.cellium.io and you can actually upload your network",
    "start": "1394220",
    "end": "1401720"
  },
  {
    "text": "policy documents networking V1 documents or celium custom resources and it will",
    "start": "1401720",
    "end": "1406940"
  },
  {
    "text": "visualize them for you it will also allow you to make modifications to it again it's hard to",
    "start": "1406940",
    "end": "1412039"
  },
  {
    "text": "see on a screenshot but you can click allow DNS resolution in this pod but only to certain domains or you can click",
    "start": "1412039",
    "end": "1418400"
  },
  {
    "text": "allow this pod to speak to this pod over here on this port so you can get this really visual interface to just point",
    "start": "1418400",
    "end": "1423679"
  },
  {
    "text": "and click and then you get the declarative networking policy at the other end you stick it into get you've",
    "start": "1423679",
    "end": "1429860"
  },
  {
    "text": "set up some sort of get UPS Pipeline and then you're laughing so I always recommend people use Hubble whenever",
    "start": "1429860",
    "end": "1436039"
  },
  {
    "text": "possible and even if you're not using Hubble you can still use the celium editor with network and V1 policies so",
    "start": "1436039",
    "end": "1441980"
  },
  {
    "text": "really really cool tool next at City",
    "start": "1441980",
    "end": "1449620"
  },
  {
    "text": "anybody like it City no of course not",
    "start": "1450080",
    "end": "1455960"
  },
  {
    "text": "well this is not a real statistic but you know as a quick straw poll with the people that have been on clustered you",
    "start": "1455960",
    "end": "1462500"
  },
  {
    "text": "know what we've seen is that any time there is a cluster an LCD break people",
    "start": "1462500",
    "end": "1467780"
  },
  {
    "text": "are pretty unhappy because people don't really understand how to operate Etc we're kind of spoiled because we don't",
    "start": "1467780",
    "end": "1474320"
  },
  {
    "text": "really we don't really need to worry about it too much because we have all these managed kubernetes Services now",
    "start": "1474320",
    "end": "1479360"
  },
  {
    "text": "but if you're doing something on your own bare metal or you're doing hybrid cloud architectures and you build",
    "start": "1479360",
    "end": "1485360"
  },
  {
    "text": "probably at some point have to worry about operating entity because it doesn't scale geographically you have to run multiple of these and",
    "start": "1485360",
    "end": "1491900"
  },
  {
    "text": "it's very difficult and I always do a pre-show interview with everyone that joins me on cluster",
    "start": "1491900",
    "end": "1497659"
  },
  {
    "text": "to try and make them feel less stressed about being unclustered but I always say what's the one thing you don't want to see today and it's always at City nobody",
    "start": "1497659",
    "end": "1504980"
  },
  {
    "text": "wants to see an Etsy break but they do happen so",
    "start": "1504980",
    "end": "1510919"
  },
  {
    "text": "I can't obviously tell you how to operate etcd and but I can tell you some of the things we've learned one is entity has something called an alarm",
    "start": "1510919",
    "end": "1518360"
  },
  {
    "text": "now entity is rather configurable you can specify the quota for the storage",
    "start": "1518360",
    "end": "1525020"
  },
  {
    "text": "backend so that is I only ever want to allow etcd to store up to 512 Mega data",
    "start": "1525020",
    "end": "1530900"
  },
  {
    "text": "and then it will start blocking All Rights this is interesting because Cube control get still continues to work your cluster",
    "start": "1530900",
    "end": "1537260"
  },
  {
    "text": "still continues to work pods just won't be scheduled if they disappear and you can't create any new deployments Etc",
    "start": "1537260",
    "end": "1543919"
  },
  {
    "text": "but everything appears to be okay except for the right operations now you have to then run it's you know",
    "start": "1543919",
    "end": "1550880"
  },
  {
    "text": "you have to change the storage quota first but that doesn't actually solve the alarm so you can restart LCD with a new code",
    "start": "1550880",
    "end": "1557720"
  },
  {
    "text": "there's loads of space you think things should be working but you have to manually list the alarms",
    "start": "1557720",
    "end": "1563299"
  },
  {
    "text": "and disarm them every time something happens with an entity there's a lot of configuration here you",
    "start": "1563299",
    "end": "1569419"
  },
  {
    "text": "can actually change the max right we're seeing people try to break at CD by pushing down two Meg blobs to it which",
    "start": "1569419",
    "end": "1574700"
  },
  {
    "text": "actually does do some damage and but again everything is configurable and you can make this work to your own detriment",
    "start": "1574700",
    "end": "1580940"
  },
  {
    "text": "I guess it's hard number two we've seen someone enable",
    "start": "1580940",
    "end": "1588020"
  },
  {
    "text": "encryption on our LCD cluster unclustered anyone know what happens when you enable",
    "start": "1588020",
    "end": "1594320"
  },
  {
    "text": "encryption on your LCD cluster your API server can no longer read anything inside of ETD because enable an",
    "start": "1594320",
    "end": "1601700"
  },
  {
    "text": "encryption does not actually encrypt all of the old data you have to do this manually",
    "start": "1601700",
    "end": "1607279"
  },
  {
    "text": "now there is a nice easy way at the bottom there where you can enable dual mode which I'll show you the config for",
    "start": "1607279",
    "end": "1612919"
  },
  {
    "text": "in a second but this allows you to support encrypted and unencrypted data and HTT is a migration path and then you",
    "start": "1612919",
    "end": "1619039"
  },
  {
    "text": "can literally just do a get sequence all spread out as Json and then pipe it straight into group control replace to",
    "start": "1619039",
    "end": "1625279"
  },
  {
    "text": "re-encrypt all that data which is a nice way of handling it uh but yeah that was a tough episode too",
    "start": "1625279",
    "end": "1632960"
  },
  {
    "text": "and at one point during this episode I was actually using the LCD command line and manually trying to inject everything",
    "start": "1632960",
    "end": "1639320"
  },
  {
    "text": "into sat encrypted it was not a good look um I don't think I have a tip to be",
    "start": "1639320",
    "end": "1645620"
  },
  {
    "text": "honest but I'm going to talk about it anyway and I'll show the gamma config frame when it's interested another really",
    "start": "1645620",
    "end": "1651380"
  },
  {
    "text": "horrible break we've seen with Etsy D is we spin up our clusters with a single",
    "start": "1651380",
    "end": "1657380"
  },
  {
    "text": "LCD node so it doesn't run in any sort of high availability capacity and the breaker",
    "start": "1657380",
    "end": "1664279"
  },
  {
    "text": "just did one command LTD control member add 0.0.0.0",
    "start": "1664279",
    "end": "1671600"
  },
  {
    "text": "not a real IP address however that one simple change turns entity and to Cluster mode and",
    "start": "1672260",
    "end": "1680120"
  },
  {
    "text": "then of course it's not got Quorum because that machine doesn't exist it never came online but immediately I've lost any ability to create a rate to",
    "start": "1680120",
    "end": "1687559"
  },
  {
    "text": "etcd at all you know what the fix is delete etcd and start again",
    "start": "1687559",
    "end": "1694900"
  },
  {
    "text": "and you need to have snapshots snapshot on your LCD cluster is is just crucial when operating kubernetes",
    "start": "1695360",
    "end": "1701360"
  },
  {
    "text": "um so the only way we could fix that was to uninstall it reinstall it restore from the snapshot and away we went so",
    "start": "1701360",
    "end": "1708080"
  },
  {
    "text": "there you go man city is fun now where are we going with this",
    "start": "1708080",
    "end": "1715720"
  },
  {
    "text": "this is just a bit of a word cloud from all the breaks that I've seen over the 50 episodes you can imagine there are a",
    "start": "1716900",
    "end": "1722900"
  },
  {
    "text": "lot of ways to break kubernetes um we've seen an interesting container D break continuity has a really cool feature",
    "start": "1722900",
    "end": "1729679"
  },
  {
    "text": "called aliasin this allows you to pull images from an alternative location that",
    "start": "1729679",
    "end": "1734960"
  },
  {
    "text": "are not the ones within the Manifest so what we've seen someone do was run their own",
    "start": "1734960",
    "end": "1740919"
  },
  {
    "text": "container image registry uh have continuity forward all requests or Docker Hub to it and all the images were",
    "start": "1740919",
    "end": "1748039"
  },
  {
    "text": "seated with bad strength so every time I thought I was pulling an official nginx image from Docker Hub I was actually",
    "start": "1748039",
    "end": "1754580"
  },
  {
    "text": "getting some random image from them nothing was working um and it's again who knew this feature",
    "start": "1754580",
    "end": "1760220"
  },
  {
    "text": "existed well I do know we've also seen people swap out the CRI so you know most of these clusters are",
    "start": "1760220",
    "end": "1766700"
  },
  {
    "text": "Cube admin clusters so they run container Breed by default we actually seen someone replace it with Docker",
    "start": "1766700",
    "end": "1772460"
  },
  {
    "text": "which sounds fine right however there is an interesting bug or a",
    "start": "1772460",
    "end": "1778039"
  },
  {
    "text": "feature I'm not quite sure which where",
    "start": "1778039",
    "end": "1783320"
  },
  {
    "text": "we're going to need a little bit more context for this one kubernetes control plane has something called a static manifest a static manifest is a gamble",
    "start": "1783320",
    "end": "1790220"
  },
  {
    "text": "fail that lives on the control plane nodes and the couplet starts these pods for you for cube ADM or admin clusters",
    "start": "1790220",
    "end": "1796700"
  },
  {
    "text": "this runs all of the control plane components the scheduler the API server and the controller managers Etc",
    "start": "1796700",
    "end": "1803299"
  },
  {
    "text": "there's a bug feature with the docker CRI where if you put the namespace in",
    "start": "1803299",
    "end": "1809179"
  },
  {
    "text": "that to be a namespace that doesn't exist the cubelet will still run the container",
    "start": "1809179",
    "end": "1815120"
  },
  {
    "text": "but you can run Cube control get namespaces and the namespace isn't there you can run Cube control get pods all",
    "start": "1815120",
    "end": "1820640"
  },
  {
    "text": "namespaces then that pod is not there you actually have the ability with the docker CRI to hide an arbitrary workload",
    "start": "1820640",
    "end": "1827539"
  },
  {
    "text": "inside of someone's cluster by typing a namespace so yeah maybe not use Docker as a CRI",
    "start": "1827539",
    "end": "1834799"
  },
  {
    "text": "we've seen a lot of systemd attacks and by attacks I just mean people run system D to orchestrate malicious processes on",
    "start": "1834799",
    "end": "1841760"
  },
  {
    "text": "the host and they give them interesting names that pass the iPhone test like DMS resolver or systemd debugger or whatever",
    "start": "1841760",
    "end": "1848840"
  },
  {
    "text": "things that you scam and you just go ah I'm sure that's fine because who knows all of the system D components there's",
    "start": "1848840",
    "end": "1854539"
  },
  {
    "text": "just too many so yeah there there's lots of things that we've seen on clustered",
    "start": "1854539",
    "end": "1860500"
  },
  {
    "text": "and to iterate and what I said earlier we only learn this stuff the hard way",
    "start": "1860659",
    "end": "1865820"
  },
  {
    "text": "nobody sits down reading the kubernetes documentation looking for loopholes and the docker CRI for hiding malicious",
    "start": "1865820",
    "end": "1872000"
  },
  {
    "text": "plots nobody sits there going what happens if you downgrade the cube at 20 versions it's only when these things",
    "start": "1872000",
    "end": "1878480"
  },
  {
    "text": "happen to us that we learn all these valuable lessons so people shouldn't feel bad or feel that they are not you",
    "start": "1878480",
    "end": "1884840"
  },
  {
    "text": "know capable kubernetes operators just because you haven't come across this stuff in the wild",
    "start": "1884840",
    "end": "1890240"
  },
  {
    "text": "and I feel that we have a bit of a problem in our industry with hero culture and that we celebrate people that work long hours we celebrate people",
    "start": "1890240",
    "end": "1896899"
  },
  {
    "text": "that seem to know everything we celebrate people that come in and swoop in and save projects however we actually need to dismantle that a little bit and",
    "start": "1896899",
    "end": "1903559"
  },
  {
    "text": "again I encourage everyone here in their office to say I don't know as much as possible especially in front of Junior",
    "start": "1903559",
    "end": "1908659"
  },
  {
    "text": "engineers and people that are learning so we all find this difficult and I",
    "start": "1908659",
    "end": "1915559"
  },
  {
    "text": "encourage you if you want to to learn more in public when you find something cool with kubernetes that breaks post it",
    "start": "1915559",
    "end": "1921140"
  },
  {
    "text": "on Twitter you don't need to tape up a big massive blog post it's 5000 words you can even just share a guest and post",
    "start": "1921140",
    "end": "1927500"
  },
  {
    "text": "that and but it's only through you know we all have our own unique circumstances",
    "start": "1927500",
    "end": "1932779"
  },
  {
    "text": "our own production looks different nobody's production is the same we're always going to run into different things so I encourage you all to share",
    "start": "1932779",
    "end": "1939020"
  },
  {
    "text": "as much as possible now what am I learning next well I",
    "start": "1939020",
    "end": "1944059"
  },
  {
    "text": "mentioned ebpf earlier I generally believe this is the most valuable thing that anyone operating kubernetes could",
    "start": "1944059",
    "end": "1949520"
  },
  {
    "text": "be learning right now and at least this is my opinion and the reason that I believe this is",
    "start": "1949520",
    "end": "1955880"
  },
  {
    "text": "well it gives us the ability to run Arbiter code within the kernel",
    "start": "1955880",
    "end": "1961039"
  },
  {
    "text": "if you remember monitoring any Linux system I'm not even talking about containers and kubernetes now anything",
    "start": "1961039",
    "end": "1966799"
  },
  {
    "text": "we used to have agents for PHP we had agents for Ruby we had agents for python",
    "start": "1966799",
    "end": "1971960"
  },
  {
    "text": "all of these different run times needed to instrument it differently however with ebpf because we can hook",
    "start": "1971960",
    "end": "1979100"
  },
  {
    "text": "into the kernel and assist calls we can actually understand all of these runtimes",
    "start": "1979100",
    "end": "1984980"
  },
  {
    "text": "with a single language so we no longer need to go and get the datadog PHP agent we can just install",
    "start": "1984980",
    "end": "1990380"
  },
  {
    "text": "some sort of ebpf agent and then have it right to some location it also gives us the ability to",
    "start": "1990380",
    "end": "1996140"
  },
  {
    "text": "understand tracing within our kernel so we can get networking understanding for latency for all requests it's really",
    "start": "1996140",
    "end": "2002559"
  },
  {
    "text": "just a little bit Magic it's also safe and secure although this has been challenged by you know people",
    "start": "2002559",
    "end": "2008380"
  },
  {
    "text": "trying to break it as often as possible and but we essentially are encouraged to",
    "start": "2008380",
    "end": "2013779"
  },
  {
    "text": "believe that we have a Sandbox within the kernel that will never crash because of the restrictions the kernel places on",
    "start": "2013779",
    "end": "2020260"
  },
  {
    "text": "the language that we use to rate our ebpf programs",
    "start": "2020260",
    "end": "2025260"
  },
  {
    "text": "now we already have a lot of ebpf out there already I mentioned Salim a lot it's a fantastic",
    "start": "2025600",
    "end": "2032200"
  },
  {
    "text": "project and it relies heavily on XDP and ebpf Falco from systek is another really cool",
    "start": "2032200",
    "end": "2039159"
  },
  {
    "text": "project it allows us to write rules to actually monitor for our syscalls being run across all of our cluster",
    "start": "2039159",
    "end": "2046480"
  },
  {
    "text": "so you know your applications better than anyone else you know what your application is supposed to be doing",
    "start": "2046480",
    "end": "2052480"
  },
  {
    "text": "should it be banned in a socket on a low port number probably not so we can",
    "start": "2052480",
    "end": "2057878"
  },
  {
    "text": "actually monitor for this now of course hopefully we have runtime profiles that don't allow that at all but I haven't",
    "start": "2057879",
    "end": "2063460"
  },
  {
    "text": "seen a lot of that in the world so using file code to understand what's happening within your clusters and having that log",
    "start": "2063460",
    "end": "2068919"
  },
  {
    "text": "these rules somewhere just gives you a lot more visibility Inspector Gadget by the team at convoke",
    "start": "2068919",
    "end": "2075220"
  },
  {
    "text": "now at Microsoft is another awesome project it gives us tools to actually debug and work with our cluster as well",
    "start": "2075220",
    "end": "2081398"
  },
  {
    "text": "it will allow you to run code for then um pods to monitor for ports what if",
    "start": "2081399",
    "end": "2087339"
  },
  {
    "text": "there's an application running you don't know what port it's on I mean we all set the container port in our pod but do you",
    "start": "2087339",
    "end": "2093280"
  },
  {
    "text": "know it does nothing nothing at all all it does is provide an alias so that in your service you can",
    "start": "2093280",
    "end": "2099760"
  },
  {
    "text": "use the poor the port name rather than the port number but that doesn't allow the Pod to open",
    "start": "2099760",
    "end": "2105940"
  },
  {
    "text": "something on that port and it doesn't actually affect any traffic so it could say Port 80 but your service is actually",
    "start": "2105940",
    "end": "2111460"
  },
  {
    "text": "running on Port 4000 and you would never know this Patrick Gadget gives us a tool",
    "start": "2111460",
    "end": "2117099"
  },
  {
    "text": "where we can actually say lesson for all Banes in this part and tell me what ports get opened and it spits them",
    "start": "2117099",
    "end": "2122980"
  },
  {
    "text": "straight back out I actually broke a cluster for ebpf Day last year for the Microsoft team and I changed the port to",
    "start": "2122980",
    "end": "2130000"
  },
  {
    "text": "see how quickly they would get it and they fired out their Inspector Gadget bind tool pretty quickly",
    "start": "2130000",
    "end": "2135339"
  },
  {
    "text": "pexy is a really cool project it's open source but they were recently bought by a New Relic so I don't know what that",
    "start": "2135339",
    "end": "2140680"
  },
  {
    "text": "means but pixie is is really cool and it gives you monitoring for all run things by just running abpf code and exports",
    "start": "2140680",
    "end": "2149320"
  },
  {
    "text": "Prometheus endpoints you can scrape it all you don't need to change your code it hooks in at the kernel level",
    "start": "2149320",
    "end": "2157060"
  },
  {
    "text": "now what is quite common with all of these tools is that they layer on and build and top of the BCC or BPF examples",
    "start": "2157060",
    "end": "2166300"
  },
  {
    "text": "so there is github.com iovisor there's a project called BCC it has a whole bunch",
    "start": "2166300",
    "end": "2172420"
  },
  {
    "text": "of tools I think there's at least 13 maybe even more but some of them are listed here exact Snoop you can run exec",
    "start": "2172420",
    "end": "2179980"
  },
  {
    "text": "snip on any Linux machine and it will tell you every time someone executes a command you can fail for that to look for",
    "start": "2179980",
    "end": "2186339"
  },
  {
    "text": "processes that have the set uidbit as one or sudo so you can actually emit events every time someone elevates their",
    "start": "2186339",
    "end": "2192940"
  },
  {
    "text": "privileges over on your machine or you could just look for people running Cube control and spell something",
    "start": "2192940",
    "end": "2198280"
  },
  {
    "text": "in slack doing hey someone just ran Cube control what you did entirely up to you",
    "start": "2198280",
    "end": "2203380"
  },
  {
    "text": "there's also IO snip this will allow you to monitor all file operations with on a machine without having to instrument",
    "start": "2203380",
    "end": "2209440"
  },
  {
    "text": "anything as well there's open Snap which shows you every time a process opens a fail so you can see we're getting all of",
    "start": "2209440",
    "end": "2215980"
  },
  {
    "text": "this visibility that we just didn't have access to before and then the three at the bottom are the TCP staff you can actually monitor all",
    "start": "2215980",
    "end": "2223119"
  },
  {
    "text": "of the TCP traffic within your cluster with a single command so these tools are just phenomenal",
    "start": "2223119",
    "end": "2229920"
  },
  {
    "text": "and I believe ebpf does change everything uh do we have time for the demo",
    "start": "2230320",
    "end": "2237040"
  },
  {
    "text": "no I'll keep time for for questions but if you want to see a demo of ebpf I do",
    "start": "2237040",
    "end": "2243339"
  },
  {
    "text": "have these Labs available here um on a struct that give you a real",
    "start": "2243339",
    "end": "2249099"
  },
  {
    "text": "kubernetes environment and the challenge is clustered so if I export my Cube",
    "start": "2249099",
    "end": "2255820"
  },
  {
    "text": "config",
    "start": "2255820",
    "end": "2258599"
  },
  {
    "text": "and Cube control get part we have a broken kubernetes cluster here",
    "start": "2261339",
    "end": "2266440"
  },
  {
    "text": "I prepared six of these and they're not publicly available yet but my plan is to do that really really",
    "start": "2266440",
    "end": "2271839"
  },
  {
    "text": "soon but if you feel like a bit of a challenge while you're here at the conference and drop me a DM on Twitter",
    "start": "2271839",
    "end": "2277480"
  },
  {
    "text": "see me walking around come up and speak to me and I will get you access and you can try and work through these challenges yourself",
    "start": "2277480",
    "end": "2283300"
  },
  {
    "text": "some of them are easy some of them are cruel so just check it out and let me know how you get on",
    "start": "2283300",
    "end": "2290280"
  },
  {
    "text": "no this is the kubernetes risk pyramid uh what I'm trying to show here is the",
    "start": "2295000",
    "end": "2300579"
  },
  {
    "text": "evpf allows us to instrument and understand every layer in this pyramid now the highest risk we have with",
    "start": "2300579",
    "end": "2306700"
  },
  {
    "text": "operating kubernetes is at the Linux level most of the attacks are going to try and attack the host rather than",
    "start": "2306700",
    "end": "2312700"
  },
  {
    "text": "coming through the workloads on the cluster however that is also a potential and eppf gets us on Parallel of",
    "start": "2312700",
    "end": "2319420"
  },
  {
    "text": "observability into that Linux kernel imagine using Bank Snoop an exec Snoop and uh monitor for specifics just calls",
    "start": "2319420",
    "end": "2327339"
  },
  {
    "text": "on that host and logging them somewhere again you probably know what kind of commands and things you expect to run on",
    "start": "2327339",
    "end": "2333460"
  },
  {
    "text": "your machines so really tailor that to make sure that you have intrusion detection across the entire line of",
    "start": "2333460",
    "end": "2339520"
  },
  {
    "text": "Stack moving up the pyramid we have lateral movement from a pod",
    "start": "2339520",
    "end": "2344560"
  },
  {
    "text": "should someone actually get access to your application we hope that they're stuck in that container and they can't",
    "start": "2344560",
    "end": "2350560"
  },
  {
    "text": "do anything however we do have things like default service account binding which may allow them to speak to the",
    "start": "2350560",
    "end": "2355960"
  },
  {
    "text": "kubernetes API and depending on the privileges on runtime security profile for the Pod they may be able to do more",
    "start": "2355960",
    "end": "2362859"
  },
  {
    "text": "so make sure that you understand and apply Network policies whenever possible because this is how you're going to get detection for that lateral movement why",
    "start": "2362859",
    "end": "2370180"
  },
  {
    "text": "is this part suddenly speaking to my API server if I don't want it to or why is it sending PG dump commands to a",
    "start": "2370180",
    "end": "2376599"
  },
  {
    "text": "postgres container that it shouldn't be speaking to so just make sure that you understand that landscape",
    "start": "2376599",
    "end": "2381760"
  },
  {
    "text": "and then the lowest risk but the most dangerous risk is well what if we have a container bracket and again it's almost",
    "start": "2381760",
    "end": "2388300"
  },
  {
    "text": "through runtime profiles and tools like Falco that we can actually get real-time detection for that now container",
    "start": "2388300",
    "end": "2395200"
  },
  {
    "text": "breakouts are extremely unlikely as long as you apply all the sensible defaults however there is still a risk that we",
    "start": "2395200",
    "end": "2402099"
  },
  {
    "text": "need to be aware of if you want to learn more about ebpf",
    "start": "2402099",
    "end": "2408160"
  },
  {
    "text": "Brandon Gregg is really driving the awareness of this project forward and and building some really cool tools on",
    "start": "2408160",
    "end": "2414220"
  },
  {
    "text": "top of it so check out Brandon Greg's blog I've already mentioned the BCC project",
    "start": "2414220",
    "end": "2419740"
  },
  {
    "text": "but there are lots of examples in that repository so if you've got an idea for a tool that could leverage EBP ebpf like",
    "start": "2419740",
    "end": "2427540"
  },
  {
    "text": "the one I use a lot is just check for pseudo access and Cube control access on a machine and have it log somewhere you",
    "start": "2427540",
    "end": "2433780"
  },
  {
    "text": "can go to that repository go into the tools folder you'll see the exact snip it's python code you just start hacking",
    "start": "2433780",
    "end": "2440380"
  },
  {
    "text": "it to only filter for the commands or the processes that you need and then you run that Epps program across your",
    "start": "2440380",
    "end": "2445900"
  },
  {
    "text": "infrastructure and you get this observability now ebpf kept",
    "start": "2445900",
    "end": "2452980"
  },
  {
    "text": "this one is dangerous this is from the team at data dog who decided Well ebpf gives us",
    "start": "2452980",
    "end": "2460540"
  },
  {
    "text": "interest and Powers within a machine could we build a root kit with it",
    "start": "2460540",
    "end": "2465940"
  },
  {
    "text": "the answer was yes this is our I'm not going to say 100 because I can't see 100 but I could see",
    "start": "2465940",
    "end": "2471400"
  },
  {
    "text": "99 undetectable rootkit using ebpf it's",
    "start": "2471400",
    "end": "2476920"
  },
  {
    "text": "very difficult to understand this is running on a machine through traditional tools you actually need more evpf to",
    "start": "2476920",
    "end": "2482380"
  },
  {
    "text": "understand that there's other ebpf happening um but you can check out this project and there are some demos on YouTube",
    "start": "2482380",
    "end": "2487839"
  },
  {
    "text": "where they walk through at conferences and but it's just scary and exciting that kind of cross-section between the",
    "start": "2487839",
    "end": "2494320"
  },
  {
    "text": "two but very cool project all right so I would love to speak to",
    "start": "2494320",
    "end": "2500859"
  },
  {
    "text": "people afterwards and know where you what users are learning and what you just find interesting there's a lot out there we've all seen the cncf landscape",
    "start": "2500859",
    "end": "2508240"
  },
  {
    "text": "right there's lots of tools there's hundreds of tools maybe even thousands of tools so well ebpf is interesting for me I'm",
    "start": "2508240",
    "end": "2514839"
  },
  {
    "text": "always curious to see what other people are learning and what they're finding them interesting too",
    "start": "2514839",
    "end": "2520599"
  },
  {
    "text": "thank you so much for your time I'm happy to take any questions that's it thanks",
    "start": "2520599",
    "end": "2526790"
  },
  {
    "text": "[Applause]",
    "start": "2526790",
    "end": "2534719"
  },
  {
    "text": "any questions",
    "start": "2537160",
    "end": "2539880"
  },
  {
    "text": "oh yeah have a look at tetragon yet yes I have",
    "start": "2542440",
    "end": "2548099"
  },
  {
    "text": "uh I know there's been a lot of not complaints but maybe backlash against isovalent for releasing a product that",
    "start": "2548099",
    "end": "2554500"
  },
  {
    "text": "doesn't quite do what they say however I think it's a really good first step and I'm excited to see where the project",
    "start": "2554500",
    "end": "2559540"
  },
  {
    "text": "goes and I think it is going to bring a new level of understanding to things happening in our cluster so I'm excited",
    "start": "2559540",
    "end": "2565119"
  },
  {
    "text": "by it and I played with it but I haven't deployed it in production yet have you",
    "start": "2565119",
    "end": "2571680"
  },
  {
    "text": "nice yeah",
    "start": "2572680",
    "end": "2577200"
  },
  {
    "text": "so the question was what do I think about service meshes you mentioned thinker D do they help us understand and",
    "start": "2587200",
    "end": "2592240"
  },
  {
    "text": "control traffic within a cluster 100 I use zenkodi on every single cluster and because you get automatic mtls between",
    "start": "2592240",
    "end": "2599200"
  },
  {
    "text": "all of the connections within your cluster and I think that's really important and we always have this",
    "start": "2599200",
    "end": "2604300"
  },
  {
    "text": "concept or we have this naive assumption that traffic within our cluster is safe and but it is really really not so",
    "start": "2604300",
    "end": "2610839"
  },
  {
    "text": "enabling mtls should be the first step on any new production cluster and I recommend most people try Linker D it's",
    "start": "2610839",
    "end": "2616900"
  },
  {
    "text": "the easiest approach there are other ones of course there's istio and there's glue but Linker D from an operations",
    "start": "2616900",
    "end": "2622540"
  },
  {
    "text": "point of view it's just a Helm chart away so yeah",
    "start": "2622540",
    "end": "2627599"
  },
  {
    "text": "now you mentioned um default service accounts and compromised pods having access to access access to",
    "start": "2628060",
    "end": "2634599"
  },
  {
    "text": "the cube API I've",
    "start": "2634599",
    "end": "2639240"
  },
  {
    "text": "I would haha good question",
    "start": "2640240",
    "end": "2645760"
  },
  {
    "text": "so the question was I mentioned the default service account earlier this is a token that is mounted into every",
    "start": "2645760",
    "end": "2650920"
  },
  {
    "text": "single part that allows you to query the API server potentially and this was actually removed and kubernetes 125 and",
    "start": "2650920",
    "end": "2658720"
  },
  {
    "text": "so there you will no longer get default service accounts so default service accounts mounted into any pod on Modern",
    "start": "2658720",
    "end": "2664900"
  },
  {
    "text": "kubernetes installations but all older clusters do get this behavior",
    "start": "2664900",
    "end": "2670000"
  },
  {
    "text": "um I don't know why I think you know it's been removed for a reason when we don't want arbitrary part",
    "start": "2670000",
    "end": "2675700"
  },
  {
    "text": "has been able to speak to the apis diverse so it's a really positive change and we're seeing lots of changes like this right and kubernetes for the last",
    "start": "2675700",
    "end": "2682480"
  },
  {
    "text": "two years I think every release is bringing better defaults to kubernetes clusters and we're taking security a lot",
    "start": "2682480",
    "end": "2689740"
  },
  {
    "text": "more seriously within the community um you know with pod security policies",
    "start": "2689740",
    "end": "2694960"
  },
  {
    "text": "been deprecated but new runtime defaults coming in we're seeing more adoption of set comp like all these things are coming and I think over the next two",
    "start": "2694960",
    "end": "2702160"
  },
  {
    "text": "years things will be much more seen by default hopefully",
    "start": "2702160",
    "end": "2707578"
  },
  {
    "text": "no more all right thank you for your time [Applause]",
    "start": "2709900",
    "end": "2716299"
  }
]