[
  {
    "text": "welcome to content security policy from newb to Advanced I'm going to try to",
    "start": "10480",
    "end": "15759"
  },
  {
    "text": "take you all the way to Advanced in just one hour that's a challenge but let me just know where you",
    "start": "15759",
    "end": "22560"
  },
  {
    "text": "are on this scale so who had heard about content security policy before this week",
    "start": "22560",
    "end": "31000"
  },
  {
    "text": "okay good uh who has worked with the policy",
    "start": "31080",
    "end": "36440"
  },
  {
    "text": "before who's like worked a lot building from the ground up or doing cool stuff with content security policy that's good",
    "start": "36800",
    "end": "44680"
  },
  {
    "text": "to see got some Advanced people here I'm sometimes going to abbreviate it as CSP",
    "start": "44680",
    "end": "50680"
  },
  {
    "text": "because that's shorter uh this talk is going to be like when I took this",
    "start": "50680",
    "end": "56640"
  },
  {
    "text": "picture uh I don't do snorkeling because I like to dive and I don't want that snorkel to be filled with with water I'm",
    "start": "56640",
    "end": "63440"
  },
  {
    "text": "also not a scuba diver so I swim down I swim up to breathe again so we're going",
    "start": "63440",
    "end": "68479"
  },
  {
    "text": "to touch on something that's a bit complicated but if you have a background in web technology yeah it should be",
    "start": "68479",
    "end": "76119"
  },
  {
    "text": "quite easy to uh reconnect when I'm up to breathe and that's going to happen like quite",
    "start": "76119",
    "end": "82479"
  },
  {
    "text": "frequently so me I'm good swimmer uh my name is holoid soo I do application",
    "start": "82479",
    "end": "89560"
  },
  {
    "text": "security at PG fora a company you probably haven't heard about used to work for the noran uh software company",
    "start": "89560",
    "end": "97079"
  },
  {
    "text": "confirm it it was merged and merged and acquired so it changed",
    "start": "97079",
    "end": "102159"
  },
  {
    "text": "names uh sometimes I do some writing on the on the blog um and I'm on Blue",
    "start": "102159",
    "end": "110520"
  },
  {
    "text": "Sky so CSP is about protecting your app in the",
    "start": "110520",
    "end": "115680"
  },
  {
    "text": "users browser against a lot of threats and yeah we'll get the",
    "start": "115680",
    "end": "122320"
  },
  {
    "text": "details why do we want a Content security policy number one to protect against",
    "start": "122320",
    "end": "129759"
  },
  {
    "text": "crossy scripting xss that will be the main focus of the talk and I think most people who are",
    "start": "129759",
    "end": "136680"
  },
  {
    "text": "really into CSP will say that that's the main thing but it's also really hard but we can also use it to protect",
    "start": "136680",
    "end": "144120"
  },
  {
    "text": "against Framing exfiltration and unwanted sources now this is what the psychology",
    "start": "144120",
    "end": "150160"
  },
  {
    "text": "would called would call the inner motivations we also have some outter motivations Audits pentests and clients",
    "start": "150160",
    "end": "157879"
  },
  {
    "text": "saying that well you should have a CSP a lot of times they just say you",
    "start": "157879",
    "end": "163680"
  },
  {
    "text": "should have a CSP header they don't really know what should be in it so",
    "start": "163680",
    "end": "168720"
  },
  {
    "text": "that's up to you to decide a lot of times I think I saw the first such requests like six to eight years ago and",
    "start": "168720",
    "end": "176800"
  },
  {
    "text": "ever since it's just been increasing every year there's more and more and more but they still haven't really",
    "start": "176800",
    "end": "184120"
  },
  {
    "text": "advanced in kind of what they expect or have been",
    "start": "184120",
    "end": "189560"
  },
  {
    "text": "specific another reason coming this year if you have heard about PCI DSS payments",
    "start": "189560",
    "end": "195959"
  },
  {
    "text": "card industry standard there's a new version coming out or being enforced in",
    "start": "195959",
    "end": "201560"
  },
  {
    "text": "April first of April is not a joke uh it pretty much says that you'll need a CSP",
    "start": "201560",
    "end": "208400"
  },
  {
    "text": "or something similar if you are taking credit card payments on a",
    "start": "208400",
    "end": "215400"
  },
  {
    "text": "page so it's from my doctor's office I thought it was appropriate to put it here um so this talk uh I'll start with",
    "start": "216560",
    "end": "224920"
  },
  {
    "text": "more introduction to CSP with terms and variations because there is things we",
    "start": "224920",
    "end": "230439"
  },
  {
    "text": "just need to know so we understand all the bits of it I'll give a live demo of",
    "start": "230439",
    "end": "236799"
  },
  {
    "text": "how to develop a policy at least the starting point of it I'll go into depth",
    "start": "236799",
    "end": "241920"
  },
  {
    "text": "in how you prevent xss I've answered more than 300 questions on stack overflow on CSP um so",
    "start": "241920",
    "end": "249879"
  },
  {
    "text": "I'll tell about tell you about some of the gas there is a section for it but there is also some of them sprinkled",
    "start": "249879",
    "end": "255120"
  },
  {
    "text": "around in the presentation talk about reporting and finally how not to make a",
    "start": "255120",
    "end": "262840"
  },
  {
    "text": "policy so a CSP we typically deliver as a response header so it's just a string",
    "start": "263000",
    "end": "270639"
  },
  {
    "text": "uh and it's something that it's a policy that we set and deliver to the browser and the browser will enforce",
    "start": "270639",
    "end": "277919"
  },
  {
    "text": "it and we Define different directives which",
    "start": "277919",
    "end": "283000"
  },
  {
    "text": "control different things so the directives have names I in a lot of places I'll put that in green so you can",
    "start": "283000",
    "end": "289960"
  },
  {
    "text": "more easily see where the different directives start and end and what their names are and then most of the",
    "start": "289960",
    "end": "296360"
  },
  {
    "text": "directives also take sources",
    "start": "296360",
    "end": "300560"
  },
  {
    "text": "let's just imagine a web page a very simple web page that we build like your first",
    "start": "301680",
    "end": "307240"
  },
  {
    "text": "homepage uh different classes of content so you put in some different URLs there",
    "start": "307240",
    "end": "315000"
  },
  {
    "text": "uh in this case relative URLs because you load from the same origin and of course the way HTML works",
    "start": "315000",
    "end": "322720"
  },
  {
    "text": "and the browser works if you reference some content it's loaded same thing with an external",
    "start": "322720",
    "end": "329240"
  },
  {
    "text": "source and if you have some inline Styles and scripts if you have an image in the data",
    "start": "329240",
    "end": "336080"
  },
  {
    "text": "URL everything will load because that's how HTML works then CSP comes",
    "start": "336080",
    "end": "344199"
  },
  {
    "text": "along and then let's just see if we're really strict and we said default Source",
    "start": "344199",
    "end": "350280"
  },
  {
    "text": "none which means pretty much like yeah I don't accept any sources on this page so",
    "start": "350280",
    "end": "357160"
  },
  {
    "text": "everything changed from green to Red because now these things won't",
    "start": "357160",
    "end": "362400"
  },
  {
    "text": "load so that's of course too strict we can change that to self which is pretty",
    "start": "362400",
    "end": "368800"
  },
  {
    "text": "much like the same origin now we see that all the relative URLs which are loaded from the same server now they",
    "start": "368800",
    "end": "375880"
  },
  {
    "text": "will load so they like the page will start coming alive we can expand this policy now I",
    "start": "375880",
    "end": "382280"
  },
  {
    "text": "added a host so everything that's on that host it's a script and a style they",
    "start": "382280",
    "end": "387680"
  },
  {
    "text": "will now load okay another thing we can do in the policy we don't need to let everything",
    "start": "387680",
    "end": "394520"
  },
  {
    "text": "go to the default Source directive we can Implement a different directive in",
    "start": "394520",
    "end": "400800"
  },
  {
    "text": "this case style Source that's Styles so now styles are kind of singled out and",
    "start": "400800",
    "end": "406720"
  },
  {
    "text": "we set it to self so we don't get xyz.com anymore because um when there's a style the",
    "start": "406720",
    "end": "415599"
  },
  {
    "text": "browser will check for style source and it found style source so it won't go further and check default",
    "start": "415599",
    "end": "422360"
  },
  {
    "text": "Source but then we can set unsafe inline which will allow all the inline content",
    "start": "422560",
    "end": "427759"
  },
  {
    "text": "for Styles so now it's allowed for Styles but not for scripts and just to show you how it",
    "start": "427759",
    "end": "434160"
  },
  {
    "text": "works we'll remove default Source now we're only restricting style Source",
    "start": "434160",
    "end": "440199"
  },
  {
    "text": "everything else will just pass just like the regular HTML case or no um CSP case",
    "start": "440199",
    "end": "449599"
  },
  {
    "text": "CSP has three levels which they could also have cold versions I don't know why",
    "start": "450160",
    "end": "455599"
  },
  {
    "text": "they didn't uh number three is still in draft mode but it's been for a number of years uh until fairly recently you would",
    "start": "455599",
    "end": "464479"
  },
  {
    "text": "think about compliance with level two you don't really need to anymore because most of the browsers have now now caught",
    "start": "464479",
    "end": "471479"
  },
  {
    "text": "up like Firefox is missing a few details mostly about reporting so you can safely",
    "start": "471479",
    "end": "478680"
  },
  {
    "text": "you know only use level three",
    "start": "478680",
    "end": "484000"
  },
  {
    "text": "disposition you can enforce the policy with content security policy or you can",
    "start": "484000",
    "end": "490039"
  },
  {
    "text": "just do report only like not enforced with content security policy report only",
    "start": "490039",
    "end": "496599"
  },
  {
    "text": "and why not make it visual I don't know if you know like how the conference web",
    "start": "496599",
    "end": "501639"
  },
  {
    "text": "page looks like in and out uh I'm going to use that as an example a lot here uh",
    "start": "501639",
    "end": "507520"
  },
  {
    "text": "in this talk um to the left there's an enforced policy uh and if you and the enforced",
    "start": "507520",
    "end": "514080"
  },
  {
    "text": "policy is font Source none which means load no fonts",
    "start": "514080",
    "end": "519120"
  },
  {
    "text": "whatsoever uh and you might recognize this as a Chrome default font because that's what it's showing when it's not",
    "start": "519120",
    "end": "525200"
  },
  {
    "text": "allowed to load any other fonts so that's what happens like stuff",
    "start": "525200",
    "end": "530399"
  },
  {
    "text": "break breaks your page and there is also an error in the console when this",
    "start": "530399",
    "end": "537000"
  },
  {
    "text": "happens on the right side it's content security policy report",
    "start": "537000",
    "end": "542519"
  },
  {
    "text": "only uh also font Source none but it looks just like we expect because it's",
    "start": "542519",
    "end": "549440"
  },
  {
    "text": "not enforced it's just the report only normally you would also uh add a",
    "start": "549440",
    "end": "555959"
  },
  {
    "text": "reporting directive here so you could actually get the report about this violation but you can also see it in the",
    "start": "555959",
    "end": "562040"
  },
  {
    "text": "console we get an error which isn't really an error but like yeah it would be an error if we had enforced it that's",
    "start": "562040",
    "end": "569600"
  },
  {
    "text": "why it says report only on the one beginning of the console area there it says report only it does not on this",
    "start": "569600",
    "end": "577600"
  },
  {
    "text": "one in CSP there are a lot of directives and the directives um go into different classes",
    "start": "577959",
    "end": "585760"
  },
  {
    "text": "except one that doesn't because there are also some things that are just thrown into CSP because yeah why not we",
    "start": "585760",
    "end": "593120"
  },
  {
    "text": "tried to define something and didn't really take off so we'll just put it into CSP upgrading secure request",
    "start": "593120",
    "end": "600279"
  },
  {
    "text": "down there that's one of them um means if there is an insecure request like",
    "start": "600279",
    "end": "605839"
  },
  {
    "text": "HTTP make it secure https also the iframe",
    "start": "605839",
    "end": "611440"
  },
  {
    "text": "sandbox U thing so Al also a directive in CSP but the main thing here is the",
    "start": "611440",
    "end": "617720"
  },
  {
    "text": "fetch directives that's where we'll focus that's about the sources on a web page and that's typically what we want",
    "start": "617720",
    "end": "623640"
  },
  {
    "text": "to restrict but there is of course a lot of other cool stuff here so I talked a bit about the fallback s and what",
    "start": "623640",
    "end": "629880"
  },
  {
    "text": "happened when we had default source and style source so all the fullbacks here",
    "start": "629880",
    "end": "635200"
  },
  {
    "text": "they are uh so for instance if you don't Implement worker Source uh in the other",
    "start": "635200",
    "end": "641800"
  },
  {
    "text": "class it will first go to child Source if that isn't implemented it will go to script source and if that isn't",
    "start": "641800",
    "end": "647360"
  },
  {
    "text": "implemented either it will go to default source so like everything here that has",
    "start": "647360",
    "end": "653279"
  },
  {
    "text": "at least in the fetch that doesn't have or isn't implemented you'll eventually go to default source",
    "start": "653279",
    "end": "661079"
  },
  {
    "text": "now this isn't everything of course I've left some space here so script source and style Source they can be split into",
    "start": "661079",
    "end": "668360"
  },
  {
    "text": "elements and attributes actually the specification says don't do this if you don't have a",
    "start": "668360",
    "end": "674639"
  },
  {
    "text": "like use case for it uh but it's really useful in the in the reports to see is",
    "start": "674639",
    "end": "679720"
  },
  {
    "text": "this an element or an attribute or another type of element now you might wonder what does",
    "start": "679720",
    "end": "687959"
  },
  {
    "text": "fall under the different directives so I put it up here the blue are tags",
    "start": "687959",
    "end": "693920"
  },
  {
    "text": "and the orange are script constructs so yeah I don't expect you to",
    "start": "693920",
    "end": "700160"
  },
  {
    "text": "remember there won't be a test on this um and if there's something new something which isn't defined",
    "start": "700160",
    "end": "706399"
  },
  {
    "text": "today uh where would that go well it would like most likely be uh sending or",
    "start": "706399",
    "end": "712680"
  },
  {
    "text": "receiving data and that would be connect source so if there's something that isn't defined it will default to connect",
    "start": "712680",
    "end": "718560"
  },
  {
    "text": "source and if that connect Source isn't implemented it'll go to default",
    "start": "718560",
    "end": "724839"
  },
  {
    "text": "source and also experimental directives there has been like a few directives",
    "start": "724880",
    "end": "730680"
  },
  {
    "text": "that have come and go in um in CSP um these aren't actually part of the draft",
    "start": "730680",
    "end": "737519"
  },
  {
    "text": "specification but they're implemented in chromium they're quite cool but I won't be covering them unfortunately not have",
    "start": "737519",
    "end": "743480"
  },
  {
    "text": "time so that was the directives and now the sources um",
    "start": "743480",
    "end": "750000"
  },
  {
    "text": "yeah sources for most of the directives so the most important ones um self and",
    "start": "750000",
    "end": "755880"
  },
  {
    "text": "none none is kind of easy it's like an explicit way of say of making an empty",
    "start": "755880",
    "end": "761199"
  },
  {
    "text": "list then you have self which is almost the same origin but it's not it's the",
    "start": "761199",
    "end": "768600"
  },
  {
    "text": "same origin and upgrades so it's if you're on HTTP it's also https and also if you're in a",
    "start": "768600",
    "end": "775880"
  },
  {
    "text": "non-default port it includes the default port for that",
    "start": "775880",
    "end": "782440"
  },
  {
    "text": "scheme and then you can take host sources so you can take a host but you can also add the scheme you can add the",
    "start": "782440",
    "end": "789760"
  },
  {
    "text": "path or you can add the port or you can add all of them or more of",
    "start": "789760",
    "end": "795680"
  },
  {
    "text": "them we also have scheme sources these are very broad so if you really want to",
    "start": "795680",
    "end": "801199"
  },
  {
    "text": "restrict something with your CSP maybe you shouldn't use them but in some cases yeah it's uh it makes sense",
    "start": "801199",
    "end": "808199"
  },
  {
    "text": "to use these and then scripts and styles take some",
    "start": "808199",
    "end": "813279"
  },
  {
    "text": "additional sources uh you see a lot of things that are called unsafe here and there's a",
    "start": "813279",
    "end": "818920"
  },
  {
    "text": "reason for that and I'll try to explain it a bit um there is something here top right",
    "start": "818920",
    "end": "825279"
  },
  {
    "text": "report sample um this will send the F 40 First",
    "start": "825279",
    "end": "830920"
  },
  {
    "text": "characters of a script or style in violation report which can be really",
    "start": "830920",
    "end": "836320"
  },
  {
    "text": "neat if you need to locate something so I'll I'll go into a bit more depth on all of these later so there different",
    "start": "836320",
    "end": "843399"
  },
  {
    "text": "keywords hashes nones and some other stri script",
    "start": "843399",
    "end": "848959"
  },
  {
    "text": "keywords go I'll come back to them uh if you read about uh",
    "start": "848959",
    "end": "857880"
  },
  {
    "text": "CSP it will seem like you can do this in two ways you can set it as a response Setter or you can set it as a meta",
    "start": "857880",
    "end": "864920"
  },
  {
    "text": "tag well the meta tag is more restricted than SP Setter and setting is setting it",
    "start": "864920",
    "end": "872000"
  },
  {
    "text": "as a meta tag is pretty much like working out in the streets of asow today",
    "start": "872000",
    "end": "878079"
  },
  {
    "text": "without winter shoes and proper clothing you'll only do it for a short time and you see very few other people doing",
    "start": "878079",
    "end": "884320"
  },
  {
    "text": "it so likely response Setter and yeah there's different ways you can",
    "start": "884320",
    "end": "890880"
  },
  {
    "text": "set the response header so I listed like the most typical ones here uh and which one should you choose",
    "start": "890880",
    "end": "900360"
  },
  {
    "text": "well I think it depends on who's going to update um your header and how quickly",
    "start": "900360",
    "end": "906759"
  },
  {
    "text": "does it need to be updated but maybe more importantly does your CSP need to be",
    "start": "906759",
    "end": "915399"
  },
  {
    "text": "dynamic that would call for going to the right and also do you want your CSP to",
    "start": "915399",
    "end": "922360"
  },
  {
    "text": "be in your tests in your D and test environment that I should also push it",
    "start": "922360",
    "end": "927480"
  },
  {
    "text": "to the right now these are the ways that you set a header but now I'll show you a different",
    "start": "927480",
    "end": "934000"
  },
  {
    "text": "way of setting a header which you may or may not know about um which is very good",
    "start": "934000",
    "end": "940880"
  },
  {
    "text": "uh when you're starting to develop a policy so let's work with the NDC security web",
    "start": "940880",
    "end": "948920"
  },
  {
    "text": "page the tickets page and if you are in the Chromium",
    "start": "948920",
    "end": "954319"
  },
  {
    "text": "browser which you need for this there is something here might be hard to see the tool tip but it says override header and",
    "start": "954319",
    "end": "961440"
  },
  {
    "text": "if you click this well the very first time you might have to define the folder and accept that folder to be used yeah",
    "start": "961440",
    "end": "968120"
  },
  {
    "text": "but yeah you'll get through that uh then you get this add header you can modify",
    "start": "968120",
    "end": "974040"
  },
  {
    "text": "one of these headers or you can add another header so what I'll do here is I will start typing um content security",
    "start": "974040",
    "end": "982680"
  },
  {
    "text": "policy and if I make any mistakes just call it out immediately if you can you don't need to spend time on debugging um",
    "start": "982680",
    "end": "991120"
  },
  {
    "text": "so I'll start with a very strict um CSP default Source",
    "start": "991120",
    "end": "1000000"
  },
  {
    "text": "none now we'll reload the page and we get the 1996 fing really",
    "start": "1000000",
    "end": "1006759"
  },
  {
    "text": "killed our web page which is too bad so",
    "start": "1006759",
    "end": "1015959"
  },
  {
    "text": "uh we'll need to allow a few more sources now when we started um",
    "start": "1016279",
    "end": "1022079"
  },
  {
    "text": "overriding headers chrome chrome created this file inside a folder with the host",
    "start": "1022079",
    "end": "1029798"
  },
  {
    "text": "so it's this headers file so first I'll just make sure I have this",
    "start": "1029799",
    "end": "1035240"
  },
  {
    "text": "copied and here is we can work in this file instead of",
    "start": "1035240",
    "end": "1040918"
  },
  {
    "text": "having to go into the the network Tab and find the header just work in this file it's so much easier you can just",
    "start": "1040919",
    "end": "1047959"
  },
  {
    "text": "flip the window go back and forth so now I say that in addition to default Source",
    "start": "1047959",
    "end": "1053559"
  },
  {
    "text": "none we accept the same origin for images scripts Styles fonts and connect",
    "start": "1053559",
    "end": "1059840"
  },
  {
    "text": "that like data sending and receiving so we'll save that one and then we'll",
    "start": "1059840",
    "end": "1066640"
  },
  {
    "text": "reload the page and did I tell you that you can kill your page with CSP you can kill it big",
    "start": "1066640",
    "end": "1074000"
  },
  {
    "text": "time so we need to save it and my experience tells me that this is",
    "start": "1074000",
    "end": "1080799"
  },
  {
    "text": "because some script is trying to access some style which is blocked uh maybe I should even try to",
    "start": "1080799",
    "end": "1087760"
  },
  {
    "text": "take a look at that let's look at in in the console refuse to apply inline style",
    "start": "1087760",
    "end": "1094480"
  },
  {
    "text": "I bet there could be more of those yeah okay I'll make this bigger refuse to",
    "start": "1094480",
    "end": "1100720"
  },
  {
    "text": "apply inline style so let's add where was",
    "start": "1100720",
    "end": "1106760"
  },
  {
    "text": "I unsave in line and let's see if something works",
    "start": "1106760",
    "end": "1113480"
  },
  {
    "text": "better oh it's working a lot better that's good still you can't buy tickets",
    "start": "1113480",
    "end": "1118880"
  },
  {
    "text": "anymore because there's few more errors we need to resolve so let's now just walk through",
    "start": "1118880",
    "end": "1126440"
  },
  {
    "text": "the console errors and we might have to do this or we will have to do this iteratively because once we for instance",
    "start": "1126440",
    "end": "1132240"
  },
  {
    "text": "allow this script guess what another script will run and then another script",
    "start": "1132240",
    "end": "1137320"
  },
  {
    "text": "maybe or'll try to send data somewhere so it's the browser is very kind and",
    "start": "1137320",
    "end": "1143000"
  },
  {
    "text": "it's telling us that there's an inline script and here's a hash that will allow this script to run because it's a hash",
    "start": "1143000",
    "end": "1149039"
  },
  {
    "text": "of that script so I will add that here and here's another",
    "start": "1149039",
    "end": "1156159"
  },
  {
    "text": "one this is a rabbit hole I can add this one then I immediately next round how to",
    "start": "1156159",
    "end": "1161880"
  },
  {
    "text": "add four more hosts and I don't know what this is for and you should make the same",
    "start": "1161880",
    "end": "1169240"
  },
  {
    "text": "like ask the same question when you're working with this like do we really need this because this appeared on the page",
    "start": "1169240",
    "end": "1174760"
  },
  {
    "text": "like two or three weeks ago I don't have no clue what it what it's for so we'll",
    "start": "1174760",
    "end": "1180039"
  },
  {
    "text": "skip it because it will take too much time uh refuse to load",
    "start": "1180039",
    "end": "1186720"
  },
  {
    "text": "image so we'll just scroll down and see if they're all the same",
    "start": "1186720",
    "end": "1192679"
  },
  {
    "text": "host they are so we'll just take the host and we'll say that for image source",
    "start": "1192679",
    "end": "1199280"
  },
  {
    "text": "which is here we allow all images from that",
    "start": "1199280",
    "end": "1204440"
  },
  {
    "text": "host and then few more here using Sentry",
    "start": "1204440",
    "end": "1209720"
  },
  {
    "text": "probably for some statistics or something so we'll",
    "start": "1209720",
    "end": "1215159"
  },
  {
    "text": "allow to connect to Sentry and they're connecting to sanity",
    "start": "1215159",
    "end": "1222159"
  },
  {
    "text": "which seems to be the CDN that's where at least where all the images came from so they probably one of their",
    "start": "1222159",
    "end": "1229240"
  },
  {
    "text": "favorite services and another one another script this is for the tickets registration",
    "start": "1229240",
    "end": "1235320"
  },
  {
    "text": "checkin Doo so I will add that to script source and just to save some time I will",
    "start": "1235320",
    "end": "1242960"
  },
  {
    "text": "also add it to style Source because that will come on the next one if I don't do it now but so that's",
    "start": "1242960",
    "end": "1249520"
  },
  {
    "text": "faster okay let's see what",
    "start": "1249520",
    "end": "1253360"
  },
  {
    "text": "happens first Google tag manager I'll come back back to that one in a",
    "start": "1255200",
    "end": "1260280"
  },
  {
    "text": "minute uh the rabbit hole skip that one refuse to connect to static",
    "start": "1260280",
    "end": "1268520"
  },
  {
    "text": "check-in. static checkin noo logging checkin",
    "start": "1268520",
    "end": "1274240"
  },
  {
    "text": "noo I'm surprised not app checking noo yet okay oh there it is app. checking.",
    "start": "1274240",
    "end": "1280640"
  },
  {
    "text": "noo so three different uh subdomains of checkin",
    "start": "1280640",
    "end": "1286799"
  },
  {
    "text": "Doo I will do that in the simple way and doing the wild",
    "start": "1286799",
    "end": "1292760"
  },
  {
    "text": "card so wild cards let's talk about them so what I'm doing now I'm using the",
    "start": "1293159",
    "end": "1298840"
  },
  {
    "text": "asterisk from checking Nano that will allow any subdomain like API and logging",
    "start": "1298840",
    "end": "1304400"
  },
  {
    "text": "and what was the other one yeah doesn't matter but it also allow any like number",
    "start": "1304400",
    "end": "1309840"
  },
  {
    "text": "of subdomains deep this will not allow checkin Noto so",
    "start": "1309840",
    "end": "1315799"
  },
  {
    "text": "the use the Wild Card dot something it will not do the main",
    "start": "1315799",
    "end": "1321000"
  },
  {
    "text": "domain and of course if you think about the security implications we can't have",
    "start": "1321000",
    "end": "1326320"
  },
  {
    "text": "check-in. wild card but we can use wild cards for ports and if you just use the Wild Card",
    "start": "1326320",
    "end": "1333520"
  },
  {
    "text": "you need to remember that it's it is a host wild card it's not a scheme wild card so some people will say that well",
    "start": "1333520",
    "end": "1339440"
  },
  {
    "text": "if you want to allow anything just insert the asterisk no does not work that way uh",
    "start": "1339440",
    "end": "1346960"
  },
  {
    "text": "and yeah we might even see an example here soon uh it's a host so it's not all",
    "start": "1346960",
    "end": "1353080"
  },
  {
    "text": "schemes so if there's something loaded on a different scheme it won't load for paths because you can also",
    "start": "1353080",
    "end": "1359360"
  },
  {
    "text": "specify we strict and specify a path like the the Wild Card character is really the slash so if you end with a",
    "start": "1359360",
    "end": "1365840"
  },
  {
    "text": "slash look like everything inside that folder if you don't end with a slash",
    "start": "1365840",
    "end": "1370960"
  },
  {
    "text": "it's that specific file so did we save let me check",
    "start": "1370960",
    "end": "1379000"
  },
  {
    "text": "yes we say",
    "start": "1379000",
    "end": "1385480"
  },
  {
    "text": "now does it load yeah it's loading so we're getting somewhere but first Google tag manager this is very common that's",
    "start": "1385480",
    "end": "1392520"
  },
  {
    "text": "so I'll cover it a bit more if you run into Google tag manager uh you can refer to this page",
    "start": "1392520",
    "end": "1399799"
  },
  {
    "text": "and by the way all the the resource URLs will be on the final slide so you don't need to take pictures if you don't want",
    "start": "1399799",
    "end": "1405760"
  },
  {
    "text": "to along the way this page is very useful do Google has documented it well",
    "start": "1405760",
    "end": "1412000"
  },
  {
    "text": "how you need to work with Google tag manager in case you use Google analytics or Google signal or yeah what they're",
    "start": "1412000",
    "end": "1418799"
  },
  {
    "text": "all called for instance how to insert the nons to work with that and further down",
    "start": "1418799",
    "end": "1426960"
  },
  {
    "text": "if you use yeah let's see if you're in preview mode then you need to implement",
    "start": "1426960",
    "end": "1432799"
  },
  {
    "text": "these four directives with these sources if you use Google analytics it's",
    "start": "1432799",
    "end": "1438159"
  },
  {
    "text": "three directives and some sources but if you use Google analytics with Google",
    "start": "1438159",
    "end": "1443400"
  },
  {
    "text": "signals then you need all of this so it's a bit more then you have to note",
    "start": "1443400",
    "end": "1448919"
  },
  {
    "text": "the last one here the Google TLD and if you want to support this",
    "start": "1448919",
    "end": "1456559"
  },
  {
    "text": "around the globe you'll need a lot of different Google domains they're actually listed here just for",
    "start": "1456559",
    "end": "1462440"
  },
  {
    "text": "convenience the supported domains let's make it a bit bigger I don't know where",
    "start": "1462440",
    "end": "1467799"
  },
  {
    "text": "where you would need Google cat uh but it's 187 different ones so",
    "start": "1467799",
    "end": "1475039"
  },
  {
    "text": "you might not want to add every single um one well depending on like if your if",
    "start": "1475039",
    "end": "1480640"
  },
  {
    "text": "your service is only in one country you might only need that one but also note",
    "start": "1480640",
    "end": "1485679"
  },
  {
    "text": "it's for image source but it's also in Connect source so if you want to support it all over the place 304 hosts to put",
    "start": "1485679",
    "end": "1493159"
  },
  {
    "text": "into your CSP it's going to be huge",
    "start": "1493159",
    "end": "1497600"
  },
  {
    "text": "so um so if you see Google tag manager do it that way so this is not CSP related",
    "start": "1499200",
    "end": "1505960"
  },
  {
    "text": "oh it's good it's not CSP related oh refused to load that's CSP",
    "start": "1505960",
    "end": "1511480"
  },
  {
    "text": "related and here it's data URL so you should not use data URLs for",
    "start": "1511480",
    "end": "1518640"
  },
  {
    "text": "scripts but for images it's not that big of a problem uh so let's add it here",
    "start": "1518640",
    "end": "1528480"
  },
  {
    "text": "and if you wonder what it does what we're missing it's the plus and minus here that's coming from that",
    "start": "1528480",
    "end": "1535520"
  },
  {
    "text": "data URL yeah the rest seems to be okay so",
    "start": "1535520",
    "end": "1540799"
  },
  {
    "text": "now let's see if we get the plus and minus I think then I think we're done you can of course check that the scripts",
    "start": "1540799",
    "end": "1546960"
  },
  {
    "text": "work does the menu work yes can we book tickets yes we can book",
    "start": "1546960",
    "end": "1554960"
  },
  {
    "text": "tickets so yeah that's how we can build a policy and now let's take our",
    "start": "1554960",
    "end": "1561799"
  },
  {
    "text": "policy take all of it and we can go to the CSP evaluator also from",
    "start": "1563919",
    "end": "1571159"
  },
  {
    "text": "Google this is actually one of the few like parsers that can actually yeah parse it well and say",
    "start": "1571159",
    "end": "1579120"
  },
  {
    "text": "something sensible about like how good is this thing really so I just paste it in here and that will immediately get",
    "start": "1579120",
    "end": "1584559"
  },
  {
    "text": "the results below so it says for the different",
    "start": "1584559",
    "end": "1590240"
  },
  {
    "text": "directives that it's yeah most of them are good it says it's it's missing",
    "start": "1590799",
    "end": "1595960"
  },
  {
    "text": "required trusted types for that's one of the experimental ones so yeah we we",
    "start": "1595960",
    "end": "1601640"
  },
  {
    "text": "didn't do anything about that uh script Source we can",
    "start": "1601640",
    "end": "1607159"
  },
  {
    "text": "expand and it's saying all good for the for the hash which is like one",
    "start": "1607159",
    "end": "1614279"
  },
  {
    "text": "specific script for the other ones it's like I can't really know because there could be bypasses there",
    "start": "1614279",
    "end": "1620679"
  },
  {
    "text": "are some yeah there are some bypasses um and it's mentioning them here like self can",
    "start": "1620679",
    "end": "1628520"
  },
  {
    "text": "be a problematic if you host jsonp because jsonp endpoints can often reflect script back so it's like a way",
    "start": "1628520",
    "end": "1635559"
  },
  {
    "text": "of just running script old angularjs libraries um are a known",
    "start": "1635559",
    "end": "1643919"
  },
  {
    "text": "bypass user uploaded files are of course bad or could be bad or could suddenly",
    "start": "1644240",
    "end": "1651279"
  },
  {
    "text": "change yeah so it's pretty much the same on registration checkin",
    "start": "1651279",
    "end": "1656559"
  },
  {
    "text": "onano so use to a hash I I grabbed the hash from the console that was the hash",
    "start": "1658120",
    "end": "1664399"
  },
  {
    "text": "of an inline script so sometimes it's really easy you can just grab it but you shouldn't like",
    "start": "1664399",
    "end": "1670600"
  },
  {
    "text": "have a lot of hashes because you'll probably forget which hash correlates to which script and suddenly you like end",
    "start": "1670600",
    "end": "1677480"
  },
  {
    "text": "up ah our our scripts changed and now we don't know which hashes we can remove",
    "start": "1677480",
    "end": "1682559"
  },
  {
    "text": "and which should be added oh frustrating um so but and sometimes the the scripts",
    "start": "1682559",
    "end": "1690120"
  },
  {
    "text": "are Dynamic and then you'll need to calculate it and this is how you do it in case you need it can be done in a few",
    "start": "1690120",
    "end": "1696120"
  },
  {
    "text": "lines so code uh just take everything that's between the tags including wh",
    "start": "1696120",
    "end": "1702320"
  },
  {
    "text": "space find utf8 representation hash it Bas 64 encode it and put put it into",
    "start": "1702320",
    "end": "1709000"
  },
  {
    "text": "your policy so that's the the inline stuff if there's a file what you do well most",
    "start": "1709000",
    "end": "1716320"
  },
  {
    "text": "people will tell you download the file and run some hashing tool or you can just be lazy you can set an Integrity",
    "start": "1716320",
    "end": "1723200"
  },
  {
    "text": "attribute a dummy one on the script file that you're downloading or loading on",
    "start": "1723200",
    "end": "1728840"
  },
  {
    "text": "your page and the browser will very kindly tell you what the right one is when you",
    "start": "1728840",
    "end": "1735320"
  },
  {
    "text": "present it with the wrong one so this is one way that we can allow",
    "start": "1735320",
    "end": "1741279"
  },
  {
    "text": "scripts and styles another way we can allow scripts and styles is a",
    "start": "1741279",
    "end": "1746559"
  },
  {
    "text": "nons so a non is like just a random value you add it to the relevant",
    "start": "1746559",
    "end": "1753200"
  },
  {
    "text": "directive like default Source or a script or style directive and then you",
    "start": "1753200",
    "end": "1758480"
  },
  {
    "text": "set that nons as an attribute for the Styles and the scripts and these have their pros and",
    "start": "1758480",
    "end": "1765559"
  },
  {
    "text": "cons uh let's dive into some more details for the nons you need one for each page load so caching could cause",
    "start": "1765559",
    "end": "1772760"
  },
  {
    "text": "some trouble here uh for the hash you'll need one for each distinct script so there could be a",
    "start": "1772760",
    "end": "1779000"
  },
  {
    "text": "lot of them if that's the the option you choose and for for NDC security for all",
    "start": "1779000",
    "end": "1784480"
  },
  {
    "text": "the inline Styles if you didn't want to rewrite them I think nons would be really good because otherwise you would",
    "start": "1784480",
    "end": "1789720"
  },
  {
    "text": "have like 20 hashes for like really small likely small um inline styles but",
    "start": "1789720",
    "end": "1798360"
  },
  {
    "text": "the hash will need to be recalculated if it's Dynamic nonsense only work for tags not",
    "start": "1798360",
    "end": "1805320"
  },
  {
    "text": "for attributes hashes also only work for tags unless you add unsafe hashes and",
    "start": "1805320",
    "end": "1812919"
  },
  {
    "text": "why is that unsafe well it's like an attribute could easily be um run out of",
    "start": "1812919",
    "end": "1820279"
  },
  {
    "text": "the expected order like doing a transaction where you don't expect that transaction and stuff like that",
    "start": "1820279",
    "end": "1828799"
  },
  {
    "text": "so what I have shown you is like a host-based uh way of allowing different",
    "start": "1829720",
    "end": "1835120"
  },
  {
    "text": "sources where we did the keyword self we could do example.com we could",
    "start": "1835120",
    "end": "1840840"
  },
  {
    "text": "you do do as you saw we had different host names and that was how we built most of the directives I didn't show n but I just",
    "start": "1840840",
    "end": "1848120"
  },
  {
    "text": "talked about it showed you a hash so these are different ways you can do it but then there's also a totally",
    "start": "1848120",
    "end": "1855600"
  },
  {
    "text": "different way of approaching this um for scripts this is scripts only and that's",
    "start": "1855600",
    "end": "1861440"
  },
  {
    "text": "using the keyword strict Dynamic if you add this this keyword and",
    "start": "1861440",
    "end": "1867760"
  },
  {
    "text": "it's um CSP level three browser which all of them are now it will disregard self and all the",
    "start": "1867760",
    "end": "1875279"
  },
  {
    "text": "hosts and all the schemes and just work with nons and",
    "start": "1875279",
    "end": "1880360"
  },
  {
    "text": "scripts and why would you do that well it could be that you don't really",
    "start": "1880360",
    "end": "1886039"
  },
  {
    "text": "trust um like the source SES like a hosts because you know there's a jonp endpoint or you know there is like on",
    "start": "1886039",
    "end": "1892559"
  },
  {
    "text": "the same host we serve um client scripts then you can say Well only the",
    "start": "1892559",
    "end": "1899559"
  },
  {
    "text": "scripts that we uh specifically allow with a nons or hash should be loaded but",
    "start": "1899559",
    "end": "1906200"
  },
  {
    "text": "the good thing here is that also all the scripts that they load",
    "start": "1906200",
    "end": "1911240"
  },
  {
    "text": "themselves uh will also be uh allowed so if you do it in the correct",
    "start": "1911240",
    "end": "1916919"
  },
  {
    "text": "way in green like you create an element set it to a script and append it to the",
    "start": "1916919",
    "end": "1922399"
  },
  {
    "text": "Dom that script will be included it will be allowed so but don't write another",
    "start": "1922399",
    "end": "1929679"
  },
  {
    "text": "script tag because that won't be allowed so bit of a recap here different",
    "start": "1929679",
    "end": "1937440"
  },
  {
    "text": "types of URLs and and what's allowed so for most of the directives except when",
    "start": "1937440",
    "end": "1942600"
  },
  {
    "text": "we're working with scripts and styles we're working with scheme source and",
    "start": "1942600",
    "end": "1948000"
  },
  {
    "text": "host source and mostly host source and for a regular URL like",
    "start": "1948000",
    "end": "1954200"
  },
  {
    "text": "something on https you see you can use all of these where",
    "start": "1954200",
    "end": "1959799"
  },
  {
    "text": "applicable when it comes to data URLs and blob URLs it's a bit more",
    "start": "1959799",
    "end": "1965880"
  },
  {
    "text": "restricted we had some inline stuff and what do you do about",
    "start": "1967519",
    "end": "1974559"
  },
  {
    "text": "that the best thing to do is to move it to a file rewrite it if necessary and",
    "start": "1974760",
    "end": "1980000"
  },
  {
    "text": "then move it out to a file uh and not work with at least a lot of uh inline",
    "start": "1980000",
    "end": "1986760"
  },
  {
    "text": "Styles and scripts there is something you can do as you see to the right here you can do",
    "start": "1986760",
    "end": "1992600"
  },
  {
    "text": "unsafe in line and there's a reason it's called unsafe and if you want to have a",
    "start": "1992600",
    "end": "1999159"
  },
  {
    "text": "CSP protecting you from crossy scripting if you do unsafe in line but also a data",
    "start": "1999159",
    "end": "2006000"
  },
  {
    "text": "scheme then you won't have any protection",
    "start": "2006000",
    "end": "2011080"
  },
  {
    "text": "really um you see Scott back here he has written a blog post uh about can you get",
    "start": "2011080",
    "end": "2017000"
  },
  {
    "text": "pawned with CSS where he's arguing that for if for",
    "start": "2017000",
    "end": "2023840"
  },
  {
    "text": "Styles it's not the same threat there's like there are some are some threats but they are on a totally different level",
    "start": "2023840",
    "end": "2030320"
  },
  {
    "text": "it's not like scripts so avoid unsafe in line for scripts",
    "start": "2030320",
    "end": "2036279"
  },
  {
    "text": "because yeah you just wait wasting your time writing a um a CSP but allowing in line",
    "start": "2036279",
    "end": "2045638"
  },
  {
    "text": "script so if you set a a a script",
    "start": "2047800",
    "end": "2054358"
  },
  {
    "text": "directive it will by default block all inline style but it will also block",
    "start": "2054359",
    "end": "2060679"
  },
  {
    "text": "Dynamic string evaluation so if you have eval new function set timeout set",
    "start": "2060679",
    "end": "2066800"
  },
  {
    "text": "interval and the first parameter is a string it will try to evaluate that",
    "start": "2066800",
    "end": "2072679"
  },
  {
    "text": "string and run it as code and that is of course dangerous",
    "start": "2072679",
    "end": "2079398"
  },
  {
    "text": "so you should try to rewrite that code but is of course in some third party so",
    "start": "2079399",
    "end": "2085240"
  },
  {
    "text": "it's really hard so you could do unsafe eval but yeah don't do it there's also",
    "start": "2085240",
    "end": "2091679"
  },
  {
    "text": "another unsafe relate to this it's wasm unsafe eval if you need to compile web assembly",
    "start": "2091679",
    "end": "2098560"
  },
  {
    "text": "yeah um won't go into detail on that so we want to prevent xss but it",
    "start": "2098560",
    "end": "2106520"
  },
  {
    "text": "turns out sometimes or actually a lot of times to be really hard mostly due to",
    "start": "2106520",
    "end": "2111640"
  },
  {
    "text": "inline scripts because there could be Legacy code or Frameworks there are",
    "start": "2111640",
    "end": "2117599"
  },
  {
    "text": "inserting yeah even Dynamic inline scripts could be a nightmare uh and you",
    "start": "2117599",
    "end": "2123400"
  },
  {
    "text": "have a lot of third party code which is not CSP compliant uh there could also be eval in all these",
    "start": "2123400",
    "end": "2130000"
  },
  {
    "text": "types of code you could have some really bad sources just a sheer number or the",
    "start": "2130000",
    "end": "2137119"
  },
  {
    "text": "trustworthiness and you can have client content which yeah do you want your",
    "start": "2137119",
    "end": "2142400"
  },
  {
    "text": "clients to write arbitrary scripts it's maybe not the best idea and then you",
    "start": "2142400",
    "end": "2148160"
  },
  {
    "text": "have your public web page typically done by the marketing department they have some CMS like",
    "start": "2148160",
    "end": "2154599"
  },
  {
    "text": "WordPress a ton of plugins none of that stuff is is really CSP compliant top of",
    "start": "2154599",
    "end": "2160000"
  },
  {
    "text": "that they have of course like Google analytics or some other analytics and trackers and yeah whatnot and trying to",
    "start": "2160000",
    "end": "2167280"
  },
  {
    "text": "make U um a strict um CSP top of that I've tried a few",
    "start": "2167280",
    "end": "2173440"
  },
  {
    "text": "times it's just not possible so I talked to these guys here from Tina CMS today",
    "start": "2173440",
    "end": "2180160"
  },
  {
    "text": "wanted to check how how their CMS is and it was pretty much the same experience as we saw with the NDC security web page",
    "start": "2180160",
    "end": "2188000"
  },
  {
    "text": "I think it's possible I think they even put it on the backlog so if you want",
    "start": "2188000",
    "end": "2193520"
  },
  {
    "text": "security um go somewhere else than the marketing department because people say",
    "start": "2193520",
    "end": "2198640"
  },
  {
    "text": "like you can't like you have to choose between usability and security I think it's really marketing or security",
    "start": "2198640",
    "end": "2206040"
  },
  {
    "text": "because like they're never in their specifications to like have secure",
    "start": "2206040",
    "end": "2212160"
  },
  {
    "text": "products sometimes Al but also it can be easy um if you have a single page",
    "start": "2212280",
    "end": "2218839"
  },
  {
    "text": "application which isn't doing a lot of crazy stuff and it's built with a modern framework then it can be really easy but",
    "start": "2218839",
    "end": "2226680"
  },
  {
    "text": "it can also be hard if there suddenly is like some payment page or whatever",
    "start": "2226680",
    "end": "2232240"
  },
  {
    "text": "because you only have one CSP so you can't have like different CSP for different pages because it's a single",
    "start": "2232240",
    "end": "2237560"
  },
  {
    "text": "page application so it's like all the same thing all the same CSP the other easy way is to have a",
    "start": "2237560",
    "end": "2245240"
  },
  {
    "text": "Content security policy from day one I I did this with the project I was like I was working with this in this",
    "start": "2245240",
    "end": "2250960"
  },
  {
    "text": "development team it was really my only contribution because I was doing so much insecurity instead and this was also",
    "start": "2250960",
    "end": "2256880"
  },
  {
    "text": "security of course um but it's still it's still there uh the developers if you get the developers to respect your",
    "start": "2256880",
    "end": "2263680"
  },
  {
    "text": "policy and work with it and not just tear it down once they run into some",
    "start": "2263680",
    "end": "2269079"
  },
  {
    "text": "troubles with it yeah it might survive and actually save you from crossy",
    "start": "2269079",
    "end": "2276440"
  },
  {
    "text": "scripting so I've been talking about the strict CSP and strict on crite",
    "start": "2276440",
    "end": "2282480"
  },
  {
    "text": "scripting uh what else do we need to do to be strict in general well first of all object Source can run",
    "start": "2282480",
    "end": "2290480"
  },
  {
    "text": "scripts you're likely not doing it so just set it to nonone for instance or",
    "start": "2290480",
    "end": "2295760"
  },
  {
    "text": "self if you're if you don't use nonone or self like get that uh script into",
    "start": "2295760",
    "end": "2301319"
  },
  {
    "text": "some safe place and run it from there style Source already mentioned that it's",
    "start": "2301319",
    "end": "2306800"
  },
  {
    "text": "similar to script Source in a lot of ways but it's less powerful so it's it's like good to do",
    "start": "2306800",
    "end": "2312960"
  },
  {
    "text": "it base URI you're probably not using it so I don't restrict it so that you can't load",
    "start": "2312960",
    "end": "2320119"
  },
  {
    "text": "relative URLs from some other host default Source that's where",
    "start": "2320119",
    "end": "2325480"
  },
  {
    "text": "everything falls back so if you want to prevent exfiltration in general better implement it and you can do as I did",
    "start": "2325480",
    "end": "2332040"
  },
  {
    "text": "start out with default Source non or default Source self and then also the one like the",
    "start": "2332040",
    "end": "2340480"
  },
  {
    "text": "that's this is where people start they Implement frame ancestors to prevent",
    "start": "2340480",
    "end": "2345640"
  },
  {
    "text": "clickjacking or restrict framing as it can also be called this is the same thing as x-frame options which you",
    "start": "2345640",
    "end": "2353280"
  },
  {
    "text": "probably know this one is just more flexible because you can add hosts you can say that well there a lot of sources",
    "start": "2353280",
    "end": "2359640"
  },
  {
    "text": "that can actually frame this page and now we're over in the Goa",
    "start": "2359640",
    "end": "2365880"
  },
  {
    "text": "section so on the left we see um frame ancestors it's like where",
    "start": "2365880",
    "end": "2372560"
  },
  {
    "text": "can your page be embedded so it's ancestors because that's the parent page",
    "start": "2372560",
    "end": "2379000"
  },
  {
    "text": "and this one has a fallback to x-frame options if you don't implement it it's X x-frame options instead if you",
    "start": "2379000",
    "end": "2386960"
  },
  {
    "text": "have that if you implement it x-frame options is ignored and but people confuse frame",
    "start": "2386960",
    "end": "2394520"
  },
  {
    "text": "ancestors and frame source so frame source is about a source on your page so",
    "start": "2394520",
    "end": "2400680"
  },
  {
    "text": "something that you want to frame or want to block a possibility to frame and this",
    "start": "2400680",
    "end": "2405839"
  },
  {
    "text": "one has a fall back to default",
    "start": "2405839",
    "end": "2409640"
  },
  {
    "text": "Source CSP sometimes gets confused with other headers and um yeah for",
    "start": "2411880",
    "end": "2419640"
  },
  {
    "text": "framing it's the same thing pretty much just more flexible in CSP to prevent xss",
    "start": "2419640",
    "end": "2426079"
  },
  {
    "text": "just mentioned need to restrict script source and object Source some people say",
    "start": "2426079",
    "end": "2432359"
  },
  {
    "text": "yeah but we use x xss protection well the problem with that one is it's dead in all relevant",
    "start": "2432359",
    "end": "2440319"
  },
  {
    "text": "browsers like yeah I is not relevant anymore um forcing https we can do that",
    "start": "2440319",
    "end": "2448359"
  },
  {
    "text": "on the current page with upgrading secure requests or we can do it on the current host or domain with st Transport",
    "start": "2448359",
    "end": "2456119"
  },
  {
    "text": "Security and and we can also restrict data sharing also on the current page in",
    "start": "2456119",
    "end": "2462280"
  },
  {
    "text": "the browser or we can regulate it with cor headers on the server so these are",
    "start": "2462280",
    "end": "2467319"
  },
  {
    "text": "different but they're kind of same concept but from different",
    "start": "2467319",
    "end": "2473000"
  },
  {
    "text": "angles multiple policies is another um another gotcha because",
    "start": "2473079",
    "end": "2479520"
  },
  {
    "text": "there's a lot of people who want to enable a CSP and in the process they enable the default CSP and the one that",
    "start": "2479520",
    "end": "2487079"
  },
  {
    "text": "they write themselves suddenly they have two policies and it's the Swiss Cheese model all the content or any content",
    "start": "2487079",
    "end": "2495000"
  },
  {
    "text": "needs to pass every single policy if it fails on one of them it's",
    "start": "2495000",
    "end": "2500359"
  },
  {
    "text": "blocked so for those implementing the default policy it's typically very strict and they try to like do add as",
    "start": "2500359",
    "end": "2507560"
  },
  {
    "text": "many policies they can to allow something still doesn't work needs to pass every single one there are use",
    "start": "2507560",
    "end": "2514280"
  },
  {
    "text": "cases for multiple policies and it's allowed and intended so it's not like the last policy in the",
    "start": "2514280",
    "end": "2520280"
  },
  {
    "text": "in the response all of them will apply",
    "start": "2520280",
    "end": "2526280"
  },
  {
    "text": "reporting uh there are two reporting directives it's report URI where",
    "start": "2526280",
    "end": "2532160"
  },
  {
    "text": "you set it to a URI or multiple uis and then you have report two which is where",
    "start": "2532160",
    "end": "2538920"
  },
  {
    "text": "you just uh mention report endpoint now if you look at the state of",
    "start": "2538920",
    "end": "2544720"
  },
  {
    "text": "these it doesn't look too good that they're deprecated or not supported",
    "start": "2544720",
    "end": "2550400"
  },
  {
    "text": "everywhere um yeah if you want to be supported everywhere you can do both of them because there is a fallback so",
    "start": "2550400",
    "end": "2556520"
  },
  {
    "text": "you'll only get one report and but you'll probably be safe with report URI for a few more years I",
    "start": "2556520",
    "end": "2563440"
  },
  {
    "text": "would think this is what a report looks like so this is the data you",
    "start": "2563440",
    "end": "2571319"
  },
  {
    "text": "get so first of all it's a document URI and this was like the original URL not the one after roll the redirect in this",
    "start": "2571880",
    "end": "2578640"
  },
  {
    "text": "case NDC security.com we get some info about loading that page no refer status",
    "start": "2578640",
    "end": "2584839"
  },
  {
    "text": "code 200 and then we get the source file this is very often the same as the",
    "start": "2584839",
    "end": "2590000"
  },
  {
    "text": "document URI but in this case the violation of our policy came when Google",
    "start": "2590000",
    "end": "2595960"
  },
  {
    "text": "tag manager script was trying to do something and it was trying to send or",
    "start": "2595960",
    "end": "2601640"
  },
  {
    "text": "receive some data from Google syndication docomo",
    "start": "2601640",
    "end": "2607318"
  },
  {
    "text": "um then we can see the original policy that's also quite useful in case you have multiple policies or in case you",
    "start": "2608920",
    "end": "2615200"
  },
  {
    "text": "just updated your policy you can see is it the new or the old one is it still in the browser someone haven't",
    "start": "2615200",
    "end": "2622480"
  },
  {
    "text": "reloaded then you get to know which directive in CSP 3 these values are the",
    "start": "2622480",
    "end": "2628480"
  },
  {
    "text": "same so there's like double information there disposition is it enforced or is",
    "start": "2628480",
    "end": "2634760"
  },
  {
    "text": "it report only and then you get some other neat information line number and column",
    "start": "2634760",
    "end": "2640720"
  },
  {
    "text": "number to try to find where did it happen well in our case we could just",
    "start": "2640720",
    "end": "2646280"
  },
  {
    "text": "see in the browser error we could just click on the script but if you get this",
    "start": "2646280",
    "end": "2651400"
  },
  {
    "text": "from a user it's really useful you can also in the relevant cases get the script sample the first 40 characters of",
    "start": "2651400",
    "end": "2658520"
  },
  {
    "text": "The Script or style which lets you identify it quite easily so I think reporting is great uh",
    "start": "2658520",
    "end": "2666760"
  },
  {
    "text": "on my my blog I just put out a piece about abusing CSP reporting or being very creative reporting on stuff which",
    "start": "2666760",
    "end": "2673480"
  },
  {
    "text": "isn't re related to CSP at all um but when you re when you develop",
    "start": "2673480",
    "end": "2680920"
  },
  {
    "text": "you can get a lot of feedback I try to tell people you can you can put your policy out there you can get all get all",
    "start": "2680920",
    "end": "2687720"
  },
  {
    "text": "the violation reports you can understand how your policy is doing if there is anything we've forgotten it has no risk",
    "start": "2687720",
    "end": "2694359"
  },
  {
    "text": "it's like no no we can't do that well you can only the users that open uh Dev tools",
    "start": "2694359",
    "end": "2701559"
  },
  {
    "text": "will see the errors nobody else will see anything everything will work just as",
    "start": "2701559",
    "end": "2706720"
  },
  {
    "text": "before but you will learn what happens when your policy is out there you'll quickly learn about the problems if you",
    "start": "2706720",
    "end": "2712680"
  },
  {
    "text": "monitor the reports and same thing after you enforce the policy you will know",
    "start": "2712680",
    "end": "2718839"
  },
  {
    "text": "what's going on is there any problem do we need to fix anything but of course process process",
    "start": "2718839",
    "end": "2726680"
  },
  {
    "text": "process who's going to monitor these reports and what will the process be for changing code or policy if there is a",
    "start": "2726680",
    "end": "2734680"
  },
  {
    "text": "real violation who's going to do that so yeah I still think reporting is",
    "start": "2734680",
    "end": "2741480"
  },
  {
    "text": "great um there are some downsides uh not to reporting but there are some things",
    "start": "2741480",
    "end": "2747000"
  },
  {
    "text": "you'll be missing there are some re some directives that don't report",
    "start": "2747000",
    "end": "2752920"
  },
  {
    "text": "anything and then if you implement frame ancestors to find out who's framing us",
    "start": "2752920",
    "end": "2758640"
  },
  {
    "text": "there is why my pages Being Framed somewhere sorry privacy reasons not",
    "start": "2758640",
    "end": "2764240"
  },
  {
    "text": "telling you sorry um and then some qu string",
    "start": "2764240",
    "end": "2769400"
  },
  {
    "text": "parameters are also removed for privacy and",
    "start": "2769400",
    "end": "2774519"
  },
  {
    "text": "security so you'll get a lot of good feedback from the real users on what's",
    "start": "2774680",
    "end": "2781440"
  },
  {
    "text": "going wrong you only get what's going wrong um when your app is there uh but",
    "start": "2781440",
    "end": "2788760"
  },
  {
    "text": "sometimes that's not your fault or and actually you'll get a lot of noise sorry",
    "start": "2788760",
    "end": "2794640"
  },
  {
    "text": "so top one that I've seen is the Facebook inapp Browser so if someone is viewing it you're viewing your web page",
    "start": "2794640",
    "end": "2801720"
  },
  {
    "text": "or app inside the faceback Facebook Browser it's trying to load some scripts",
    "start": "2801720",
    "end": "2807839"
  },
  {
    "text": "and there are some people who don't like the font you chose they want to have their their font apparently and you",
    "start": "2807839",
    "end": "2815800"
  },
  {
    "text": "typically get like 20 of them at the same time like someone tried to load a font fonts aren't like super security",
    "start": "2815800",
    "end": "2822240"
  },
  {
    "text": "critical um but yeah sometimes you may not want to like be flushed with uh font",
    "start": "2822240",
    "end": "2829680"
  },
  {
    "text": "Source reports translation services I see them once in a while they're a bit",
    "start": "2829680",
    "end": "2836480"
  },
  {
    "text": "interesting because there might be users that want to translate your page and do you want to block that or",
    "start": "2836480",
    "end": "2845599"
  },
  {
    "text": "not dep depend on your threat model you might want to allow all the translation services that you see because could be",
    "start": "2845599",
    "end": "2852599"
  },
  {
    "text": "useful for the users and the security trade-off might be okay you also also see browser",
    "start": "2852599",
    "end": "2860960"
  },
  {
    "text": "extensions and you will see some sneaky stuff people trying to",
    "start": "2860960",
    "end": "2867040"
  },
  {
    "text": "modify your page vpns malware and even security products will try to do this",
    "start": "2867040",
    "end": "2872520"
  },
  {
    "text": "they'll inject stuff and this is really interesting but it's like",
    "start": "2872520",
    "end": "2877680"
  },
  {
    "text": "noise and some of the security products I've been seen tried to modify the policy which is another very sneaky",
    "start": "2877680",
    "end": "2884240"
  },
  {
    "text": "thing to do so you'll get this noise and you'll need to verify is this due to the",
    "start": "2884240",
    "end": "2889440"
  },
  {
    "text": "user and the user's environment because they have like a um um extension that they installed or",
    "start": "2889440",
    "end": "2896960"
  },
  {
    "text": "they got some malware or is it due to the app so you might have to um to check",
    "start": "2896960",
    "end": "2902720"
  },
  {
    "text": "it easy check is like okay is this like 1% of the users visiting that page",
    "start": "2902720",
    "end": "2907839"
  },
  {
    "text": "or is it like all of them also tells you a lot so now I will um show you how not to",
    "start": "2907839",
    "end": "2916200"
  },
  {
    "text": "make a policy this is a real policy it's only two directives it's default source",
    "start": "2916200",
    "end": "2922440"
  },
  {
    "text": "and it's script source and if you wonder what it is um the sixth line might give",
    "start": "2922440",
    "end": "2930240"
  },
  {
    "text": "something away this is zoom from March 2020 if you remember we all had to start",
    "start": "2930240",
    "end": "2936119"
  },
  {
    "text": "working remote and we all needed needed video conference services so a lot of people",
    "start": "2936119",
    "end": "2941520"
  },
  {
    "text": "started to use zoom and there were some security considerations that quickly",
    "start": "2941520",
    "end": "2946599"
  },
  {
    "text": "came up and got a lot of attention it was not the CSP that was",
    "start": "2946599",
    "end": "2952000"
  },
  {
    "text": "only for the very interested uh but it was like the service in China and a few",
    "start": "2952000",
    "end": "2957440"
  },
  {
    "text": "other things but someone looked at the CSP and I was able to find",
    "start": "2957440",
    "end": "2964200"
  },
  {
    "text": "it yes there's a bit of China here as well Zoom us. CN",
    "start": "2964200",
    "end": "2969839"
  },
  {
    "text": "so let's look at this policy which is probably built in like the manner make",
    "start": "2969839",
    "end": "2975680"
  },
  {
    "text": "things work and oh we getting this violation reports people something is",
    "start": "2975680",
    "end": "2980839"
  },
  {
    "text": "going wrong when our users are using our page let's fix that by amending the",
    "start": "2980839",
    "end": "2986760"
  },
  {
    "text": "policy and okay so if you look at the first the default Source what do they allow then this is",
    "start": "2986760",
    "end": "2993520"
  },
  {
    "text": "like all the fetch directives except script Source like images media uh",
    "start": "2993520",
    "end": "3002000"
  },
  {
    "text": "Styles fonts yes they allow https Safari extension blob data and",
    "start": "3002000",
    "end": "3009559"
  },
  {
    "text": "self now what do they not allow",
    "start": "3009559",
    "end": "3016359"
  },
  {
    "text": "HTTP and websocket yeah yeah maybe a few other",
    "start": "3016359",
    "end": "3021760"
  },
  {
    "text": "obscure things that's probably not relevant but then you have script source",
    "start": "3021760",
    "end": "3026920"
  },
  {
    "text": "so they start out really bad they allow unsafe eval and unsafe inline and yeah I",
    "start": "3026920",
    "end": "3033440"
  },
  {
    "text": "don't know if blob maybe not that bad but unsafe eval and unsafe inline yeah",
    "start": "3033440",
    "end": "3040359"
  },
  {
    "text": "it's pretty much ineffective they wouldn't need to write all the others all the other things here but let's look",
    "start": "3040359",
    "end": "3045480"
  },
  {
    "text": "at it so they have some Google services likely",
    "start": "3045480",
    "end": "3050599"
  },
  {
    "text": "because they using Google tag manager yeah so they Pro need to add this this",
    "start": "3050599",
    "end": "3056440"
  },
  {
    "text": "this is is perfectly normal if there's a public web page so there's a lot of things that are normal on public web",
    "start": "3056440",
    "end": "3062200"
  },
  {
    "text": "page because yeah no marketing yeah they want to track",
    "start": "3062200",
    "end": "3067799"
  },
  {
    "text": "everything so I highlighted those that I think could be relevant to a public web",
    "start": "3067799",
    "end": "3073359"
  },
  {
    "text": "page like down right you see YouTube they probably need to load a script from",
    "start": "3073359",
    "end": "3079119"
  },
  {
    "text": "YouTube to run the embedded YouTube video um zenes",
    "start": "3079119",
    "end": "3086799"
  },
  {
    "text": "what else tracking. G2 crowd.com probably loading some scripts from JS",
    "start": "3086799",
    "end": "3093599"
  },
  {
    "text": "deliver and jQuery hot jar is a favorite one seen it",
    "start": "3093599",
    "end": "3099400"
  },
  {
    "text": "a lot of times analytics Services trackers so I don't know if all of these are on the",
    "start": "3099400",
    "end": "3105280"
  },
  {
    "text": "page but these are like normal I would say like I've seen them on other um like",
    "start": "3105280",
    "end": "3111000"
  },
  {
    "text": "marketing web pages and then wild card",
    "start": "3111000",
    "end": "3117680"
  },
  {
    "text": "for subdomains a lot of those um there are something called subdomain",
    "start": "3117680",
    "end": "3126119"
  },
  {
    "text": "takeover there are risks with different with allowing a lot of",
    "start": "3126119",
    "end": "3131200"
  },
  {
    "text": "subdomains yeah I would rather list a number of different um subdomains in",
    "start": "3131200",
    "end": "3137640"
  },
  {
    "text": "script Source I would be more lazy in like an image or font or something like that but for script I would not do",
    "start": "3137640",
    "end": "3145520"
  },
  {
    "text": "this and then you have CDN now do you have control over what's in a CDN a public one like who can",
    "start": "3145520",
    "end": "3153880"
  },
  {
    "text": "upload a script to Dropbox and make it load there's no security in this okay",
    "start": "3153880",
    "end": "3160400"
  },
  {
    "text": "let's move on likely a browser extension I'm not totally sure but I think so and for to be sure they added it twice and",
    "start": "3160400",
    "end": "3169040"
  },
  {
    "text": "they did the same with this security product even right after each",
    "start": "3169040",
    "end": "3174200"
  },
  {
    "text": "other and then they have some other ones now what are these",
    "start": "3174319",
    "end": "3181839"
  },
  {
    "text": "for I did some research into like similar reports at the same time and I",
    "start": "3181839",
    "end": "3188160"
  },
  {
    "text": "classified all of these as um",
    "start": "3188160",
    "end": "3193319"
  },
  {
    "text": "malicious like some of them you can go and look up like 50 million. Club yeah",
    "start": "3193319",
    "end": "3199520"
  },
  {
    "text": "likely not a relevant source for really anyone um there are some things you",
    "start": "3199520",
    "end": "3206200"
  },
  {
    "text": "could um look at that would tell you this is malicious you could try to download the",
    "start": "3206200",
    "end": "3212359"
  },
  {
    "text": "script that was in the in the violation report and",
    "start": "3212359",
    "end": "3218000"
  },
  {
    "text": "sometimes you wouldn't be allowed to load it because they probably like snuck in some parameter or header or",
    "start": "3218000",
    "end": "3225640"
  },
  {
    "text": "something that if you try to research this you're not getting our script",
    "start": "3225640",
    "end": "3230920"
  },
  {
    "text": "sorry um like that was the first one big red flag second one you look at the",
    "start": "3230920",
    "end": "3237960"
  },
  {
    "text": "script and you see they're trying to send data somewhere but it's really hard to figure",
    "start": "3237960",
    "end": "3243079"
  },
  {
    "text": "out because it's obfuscated so you're obfuscating where you're trying to send",
    "start": "3243079",
    "end": "3248960"
  },
  {
    "text": "data or like the whole thing is just totally obfuscated yeah malicious also",
    "start": "3248960",
    "end": "3254319"
  },
  {
    "text": "tried with some of them to send them from one email provider to another one and that script was blocked on the way",
    "start": "3254319",
    "end": "3260559"
  },
  {
    "text": "as an email yeah likely malicious yeah they typically share IPS",
    "start": "3260559",
    "end": "3265880"
  },
  {
    "text": "as well so if you classify one or two of them as malicious a few others can also",
    "start": "3265880",
    "end": "3271760"
  },
  {
    "text": "easily be classified as malicious so the point here is that when",
    "start": "3271760",
    "end": "3278480"
  },
  {
    "text": "you're creating a CSP it's not about like taking your page and then adjusting",
    "start": "3278480",
    "end": "3283520"
  },
  {
    "text": "your CSP until the point where it matches your",
    "start": "3283520",
    "end": "3289240"
  },
  {
    "text": "page like everything is allowed even though it might have looked like that in my demo when you're working with a CS",
    "start": "3289240",
    "end": "3296680"
  },
  {
    "text": "the point is to make a strict CSP and after that what you need to might need",
    "start": "3296680",
    "end": "3302119"
  },
  {
    "text": "to do is to make changes for your application or your website to work with",
    "start": "3302119",
    "end": "3307599"
  },
  {
    "text": "that CSP so that's the end this is where you",
    "start": "3307599",
    "end": "3313520"
  },
  {
    "text": "can take a picture if you want any of the",
    "start": "3313520",
    "end": "3317040"
  },
  {
    "text": "resources and I can take questions yes you mentioned",
    "start": "3319559",
    "end": "3328318"
  },
  {
    "text": "that so the question was did you say that or you mentioned that you saw security products yes I so yeah so just",
    "start": "3336839",
    "end": "3345720"
  },
  {
    "text": "repeating your question so it will be on the tape so",
    "start": "3345720",
    "end": "3351680"
  },
  {
    "text": "um so uh now I really got out of it",
    "start": "3351680",
    "end": "3357359"
  },
  {
    "text": "security products um did you say that they would also modify the CSP wouldn't",
    "start": "3357359",
    "end": "3363839"
  },
  {
    "text": "that defeat the purpose so this is actually something set scaler has done",
    "start": "3363839",
    "end": "3369920"
  },
  {
    "text": "at least that's how I uh interpreted it because it seemed like it was",
    "start": "3369920",
    "end": "3375440"
  },
  {
    "text": "actually um changing it because you get the the the policy in the violation",
    "start": "3375440",
    "end": "3381920"
  },
  {
    "text": "report and it seemed like it had inserted set scaler into every single",
    "start": "3381920",
    "end": "3387240"
  },
  {
    "text": "directive so it's kind of sneaky and it's yeah it def defeats the purpose I",
    "start": "3387240",
    "end": "3392920"
  },
  {
    "text": "don't know why they need to to do it that way I don't really think you have",
    "start": "3392920",
    "end": "3399480"
  },
  {
    "text": "security if that happens because what if if what if set scaler is",
    "start": "3399480",
    "end": "3405039"
  },
  {
    "text": "hacked and they start to inject",
    "start": "3405039",
    "end": "3409359"
  },
  {
    "text": "whatever yes back there",
    "start": "3410480",
    "end": "3415200"
  },
  {
    "text": "so the question is do we know do I know about any front end Frameworks that like totally violates CSP we have to like",
    "start": "3429839",
    "end": "3438520"
  },
  {
    "text": "allow and pretty much anything well I think a lot of especially old stuff actually it's",
    "start": "3438520",
    "end": "3446720"
  },
  {
    "text": "thing like net if you really old versions um maybe it was just something in our code but it seemed like the old",
    "start": "3446720",
    "end": "3454640"
  },
  {
    "text": "net was just inserting some Dynamic um inline",
    "start": "3454640",
    "end": "3460520"
  },
  {
    "text": "scripts um I could been wrong there um but I I don't know about any um but",
    "start": "3460520",
    "end": "3467599"
  },
  {
    "text": "there are some that are just doing a lot of stuff like injecting a lot of inline",
    "start": "3467599",
    "end": "3473440"
  },
  {
    "text": "um styles which is like how a lot of people have done it like style attributes they could work with class",
    "start": "3473440",
    "end": "3481480"
  },
  {
    "text": "class names uh instead but they chose to like yeah just add and remove",
    "start": "3481480",
    "end": "3489000"
  },
  {
    "text": "attributes um yeah I I have no more details yes",
    "start": "3489000",
    "end": "3497960"
  },
  {
    "text": "so are there any performance issues with having a massive CSP uh I think I'll need to ask Scott",
    "start": "3507400",
    "end": "3514359"
  },
  {
    "text": "about that",
    "start": "3514359",
    "end": "3516759"
  },
  {
    "text": "one so as Scott said yeah it's the data",
    "start": "3526760",
    "end": "3532160"
  },
  {
    "text": "transfer um so it's probably doesn't take much longer in the browser but of",
    "start": "3532160",
    "end": "3538480"
  },
  {
    "text": "course like what happens when your when your header gets very long I actually",
    "start": "3538480",
    "end": "3543760"
  },
  {
    "text": "had a case where I was emailing an updated header for our public web",
    "start": "3543760",
    "end": "3548880"
  },
  {
    "text": "page and the guy in it was updating it he or he or I accidentally cropped it so",
    "start": "3548880",
    "end": "3556440"
  },
  {
    "text": "lot of things stopped working uh and after that I always put uh report U at the at the very beginning",
    "start": "3556440",
    "end": "3564079"
  },
  {
    "text": "of the CSP not at the end because it was also cropped off so I I didn't get any violation reports which was of course",
    "start": "3564079",
    "end": "3570440"
  },
  {
    "text": "stupid so yeah that's another one put uh reporting directives first so in case",
    "start": "3570440",
    "end": "3577160"
  },
  {
    "text": "that strange thing happens other",
    "start": "3577160",
    "end": "3583599"
  },
  {
    "text": "questions okay I don't need to hold you here anymore thank you",
    "start": "3590119",
    "end": "3598038"
  }
]