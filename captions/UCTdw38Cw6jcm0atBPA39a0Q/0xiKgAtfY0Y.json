[
  {
    "text": "welcome everyone to the last Talk of the day my name is baham and I work for",
    "start": "5279",
    "end": "10800"
  },
  {
    "text": "Cross Point Labs which is part of a private Equity Firm so we mostly do",
    "start": "10800",
    "end": "16118"
  },
  {
    "text": "private U technical due diligence and stuff like this but prior to that I worked as a software Developers for so",
    "start": "16119",
    "end": "23039"
  },
  {
    "text": "many years in the windows scan space so lowlevel stuff and the talk today will",
    "start": "23039",
    "end": "28960"
  },
  {
    "text": "be sorry the talk today I'll will be talking today about the the hidden risk",
    "start": "28960",
    "end": "34680"
  },
  {
    "text": "of undocumented API API documentation and I will show you how software developers in",
    "start": "34680",
    "end": "41200"
  },
  {
    "text": "pretty much all antivirus and DDR companies out there have overlooked a",
    "start": "41200",
    "end": "47039"
  },
  {
    "text": "crucial Windows API Behavior as a result as a result of a a insufficient or",
    "start": "47039",
    "end": "54879"
  },
  {
    "text": "incomplete documentation from Microsoft and as a result of that they introduced",
    "start": "54879",
    "end": "60039"
  },
  {
    "text": "is security vulnerability in their product and as a bonus as well at the end I will show you that this same",
    "start": "60039",
    "end": "66720"
  },
  {
    "text": "vulnerability was also present in other type of application other than antivirus",
    "start": "66720",
    "end": "71960"
  },
  {
    "text": "and DDR this is a disclaimer that I was",
    "start": "71960",
    "end": "77320"
  },
  {
    "text": "asked to ask to to include in my presentation from the my company but to start with let's discuss",
    "start": "77320",
    "end": "84400"
  },
  {
    "text": "symbolic lengths which will provide some context to the vulnerability I will be presenting in the in the in the talk",
    "start": "84400",
    "end": "91079"
  },
  {
    "text": "today I assume most of you are familiar with symbolic lengths but if not there are a length that references a named",
    "start": "91079",
    "end": "98200"
  },
  {
    "text": "object whether that's a file folder registry key and so on now symbolic",
    "start": "98200",
    "end": "104000"
  },
  {
    "text": "links can post post security risk if not handled",
    "start": "104000",
    "end": "110240"
  },
  {
    "text": "properly ER and they have been exploited in in various attacks like denial of",
    "start": "110240",
    "end": "115479"
  },
  {
    "text": "service attacks and privilege escalations and the vulnerability I will be discussing today belongs to this",
    "start": "115479",
    "end": "121200"
  },
  {
    "text": "class of of of f abilities now symbolic links is is a",
    "start": "121200",
    "end": "127320"
  },
  {
    "text": "primitive that is available in all major operating system including in the Windows operating system which is the",
    "start": "127320",
    "end": "133239"
  },
  {
    "text": "one I will be focusing on",
    "start": "133239",
    "end": "136720"
  },
  {
    "text": "today now Windows support several types of symbolic length types or lengths in",
    "start": "138680",
    "end": "144239"
  },
  {
    "text": "general so for example we have at the NTFS file system level we have the NFS",
    "start": "144239",
    "end": "150080"
  },
  {
    "text": "symbolic links so for those you need to be an admin or authorized by an admin to be able to create such a link and if you",
    "start": "150080",
    "end": "158720"
  },
  {
    "text": "try to delete such a link using any documented 132 API like the delete file",
    "start": "158720",
    "end": "164599"
  },
  {
    "text": "API then only the link itself will be deleted and not the target which is probably the the behavior that you would",
    "start": "164599",
    "end": "171080"
  },
  {
    "text": "be expecting if you are reading and writing through a link you would be expecting to read and write on the",
    "start": "171080",
    "end": "177519"
  },
  {
    "text": "target but when you are deleting you expect to delete the link itself and not the target at least but in the default",
    "start": "177519",
    "end": "184799"
  },
  {
    "text": "behavior and this Behavior the delete behavior is is similar to other types of links in Windows so it is similar to the",
    "start": "184799",
    "end": "193159"
  },
  {
    "text": "for example the volume Mount points to directory Junctions and hard links the exception to that is the registry",
    "start": "193159",
    "end": "199640"
  },
  {
    "text": "symbolic links the one at the very end so for those it is sufficient to be a",
    "start": "199640",
    "end": "204680"
  },
  {
    "text": "standard user basically non admin user to be able to create such a link and",
    "start": "204680",
    "end": "209879"
  },
  {
    "text": "this you are trying to create the Link at a location that the non-admin user",
    "start": "209879",
    "end": "215680"
  },
  {
    "text": "does not have permissions to write and to create a link at like for example",
    "start": "215680",
    "end": "220760"
  },
  {
    "text": "writing to the local machine registry hype but what's interesting about this",
    "start": "220760",
    "end": "226239"
  },
  {
    "text": "type is is that if you try to delete that type of links using any documented 132 API using for example R delete key",
    "start": "226239",
    "end": "235319"
  },
  {
    "text": "then the target will be deleted rather than the link and that can have some security",
    "start": "235319",
    "end": "242159"
  },
  {
    "text": "ramification which I'll be discussing in the presentation now registry symbolic links",
    "start": "242159",
    "end": "248519"
  },
  {
    "text": "if you are not familiar with those this is a feature in the Windows registry that enables you to create a link from",
    "start": "248519",
    "end": "255840"
  },
  {
    "text": "Source key to a Target key basically you would miror the target key at the source",
    "start": "255840",
    "end": "261280"
  },
  {
    "text": "location and they have been existing as part of the Windows registry for more than 30 years so since the time of",
    "start": "261280",
    "end": "268479"
  },
  {
    "text": "Windows NT so it's not something new but for some reason this seems to be less known than other types of symbolic",
    "start": "268479",
    "end": "274600"
  },
  {
    "text": "lengths in in Windows one example to that is the current control set and I assume most of",
    "start": "274600",
    "end": "280280"
  },
  {
    "text": "you have interacted with that register key and that is is by itself is a link",
    "start": "280280",
    "end": "285960"
  },
  {
    "text": "and it redirects you to to the to the key control set 001 which the one you",
    "start": "285960",
    "end": "291000"
  },
  {
    "text": "see on top there and that's the last configuration or control set that",
    "start": "291000",
    "end": "297039"
  },
  {
    "text": "Windows was booted with could also r you to other Keys like control 6 002 which is the last good known",
    "start": "297039",
    "end": "305240"
  },
  {
    "text": "configuration that Windows was booted was booted with now if you try to view",
    "start": "305240",
    "end": "310479"
  },
  {
    "text": "that current control set using the built-in rig edit tool in Windows or any",
    "start": "310479",
    "end": "315880"
  },
  {
    "text": "other registry link those links will appear just like any other regular key and there will be no indication that",
    "start": "315880",
    "end": "322360"
  },
  {
    "text": "they are symbolic links so you won't be able to tell the difference between registry key and registry link using R",
    "start": "322360",
    "end": "328880"
  },
  {
    "text": "edit at least you would need to use other tools like the one I'm using here total registry to",
    "start": "328880",
    "end": "334800"
  },
  {
    "text": "to view the underlying structure of of the the registry link and the registry link is pretty simple it is still a",
    "start": "334800",
    "end": "341600"
  },
  {
    "text": "registry key but it is an empty registry key that has one value named symbolic",
    "start": "341600",
    "end": "347520"
  },
  {
    "text": "link value and has the type breakcore and its value is the absolute native",
    "start": "347520",
    "end": "354240"
  },
  {
    "text": "path of the target key so in the case of current control set the native path will",
    "start": "354240",
    "end": "360400"
  },
  {
    "text": "be registry machine system control control set",
    "start": "360400",
    "end": "366440"
  },
  {
    "text": "001 now if you try to if you want to interact with with those registry links",
    "start": "366440",
    "end": "371560"
  },
  {
    "text": "programmatically Microsoft does provide some information as part of the the",
    "start": "371560",
    "end": "376720"
  },
  {
    "text": "documentation that deals with creating and opening registry keys but that inform but that documentation is",
    "start": "376720",
    "end": "383199"
  },
  {
    "text": "insufficient and has several issues but I will not be covering this today what I will be covering today is the delete",
    "start": "383199",
    "end": "389240"
  },
  {
    "text": "action on the registry keys or registry link but before we jump into the details",
    "start": "389240",
    "end": "394800"
  },
  {
    "text": "on that one let's just see how Microsoft H document the delete action",
    "start": "394800",
    "end": "401720"
  },
  {
    "text": "on types other than the regist symbolic links so for example we mentioned the",
    "start": "401720",
    "end": "407720"
  },
  {
    "text": "NTFS symbolic links and there as part of the delete file API they clearly document the behavior of that API if",
    "start": "407720",
    "end": "415160"
  },
  {
    "text": "it's invoked on an NTFS symbolic link so they said they tell you if the path",
    "start": "415160",
    "end": "421039"
  },
  {
    "text": "points which is path that is passed to the delete file points to a symbolic length then the symbolic symbolic link",
    "start": "421039",
    "end": "428199"
  },
  {
    "text": "is deleted and not the target so it's very clear similarly they tell you if if you",
    "start": "428199",
    "end": "434479"
  },
  {
    "text": "want to delete a hard link then you can use the the function or the API delete file and if you want to remove directory",
    "start": "434479",
    "end": "441000"
  },
  {
    "text": "Junction you can use the remove directory so you get the point here they have documented some somewhat whether",
    "start": "441000",
    "end": "447720"
  },
  {
    "text": "what API to use in order to delete certain links or what would be the behavior if you invoke an API on a on a",
    "start": "447720",
    "end": "456039"
  },
  {
    "text": "link type however this is not the case for registry symbolic links so for those",
    "start": "456039",
    "end": "463039"
  },
  {
    "text": "there's you will not find any information in Microsoft documentation that tells you how to deal with registry",
    "start": "463039",
    "end": "469599"
  },
  {
    "text": "symbolic links there they they don't document either what API apis to use or",
    "start": "469599",
    "end": "476280"
  },
  {
    "text": "what would be the behavior of apis that deals with deleting registry keys when",
    "start": "476280",
    "end": "481360"
  },
  {
    "text": "they are invoked on a key that happen to be a registry Sim link and th include",
    "start": "481360",
    "end": "488120"
  },
  {
    "text": "documentations for apis like RI delete key RI delete 3 and even the native",
    "start": "488120",
    "end": "493879"
  },
  {
    "text": "versions of those and that can be a significant",
    "start": "493879",
    "end": "499960"
  },
  {
    "text": "concern because when a software developers turns into this documentation",
    "start": "499960",
    "end": "505000"
  },
  {
    "text": "they may Overlook the importance of handling registry symbolic links so if",
    "start": "505000",
    "end": "510159"
  },
  {
    "text": "you don't have information about that you as a software developers you might actually not think about that you need",
    "start": "510159",
    "end": "517000"
  },
  {
    "text": "to deal with this situation or in each case now to make things",
    "start": "517000",
    "end": "523719"
  },
  {
    "text": "worse it's not like the only the documentation is not is incomplete but also as I mentioned the behavior of 132",
    "start": "523720",
    "end": "531720"
  },
  {
    "text": "apis that deals with deleting registry keys behave strangely or not in accordance with how things are done on",
    "start": "531720",
    "end": "538600"
  },
  {
    "text": "other types of links so typically if you want to delete a registry key in Windows you need to",
    "start": "538600",
    "end": "546120"
  },
  {
    "text": "open that key and obtain a handle to it and then you pass on that handle to to other",
    "start": "546120",
    "end": "552640"
  },
  {
    "text": "apis to to perform the delete action on them now if your software opens a key",
    "start": "552640",
    "end": "559360"
  },
  {
    "text": "that happened to be a link and it does not specify the option rig option open link and then pass on that handle to rig",
    "start": "559360",
    "end": "567360"
  },
  {
    "text": "delete key or rig delete three then the target will be deleted similarly if you what's even more interesting is is that",
    "start": "567360",
    "end": "574720"
  },
  {
    "text": "even if your software was aware that the key is a link and it opens it with the option rig option open link those apis",
    "start": "574720",
    "end": "582000"
  },
  {
    "text": "would still delete the target rather than the link so basically if you are a",
    "start": "582000",
    "end": "587440"
  },
  {
    "text": "software developer in the user mode you are left with no documented API to delete registry link the only option for",
    "start": "587440",
    "end": "595600"
  },
  {
    "text": "you to do that is by using the native API in delete key but the problem with",
    "start": "595600",
    "end": "602040"
  },
  {
    "text": "that is that it it is an undocumented API and you have to explicitly import",
    "start": "602040",
    "end": "607120"
  },
  {
    "text": "that from ND NTD Library okay otherwise you will risk",
    "start": "607120",
    "end": "613320"
  },
  {
    "text": "deleting the the target again if you are operating in the K mode you'll have to use the native ones but again every",
    "start": "613320",
    "end": "619480"
  },
  {
    "text": "single time you want to delete a key you have to check if that key is a link or not and if so you have to open it with",
    "start": "619480",
    "end": "625360"
  },
  {
    "text": "the option rig option open link",
    "start": "625360",
    "end": "631320"
  },
  {
    "text": "now this Behavior the one I mentioned here creates a or leads to a situation",
    "start": "634200",
    "end": "641279"
  },
  {
    "text": "that creates a mismatch between what a programmer intends and what is actually deleted by windows so basically as I'm",
    "start": "641279",
    "end": "648120"
  },
  {
    "text": "phrasing here what you see is not what you delete and that can lead to a security vulnerability if a",
    "start": "648120",
    "end": "655079"
  },
  {
    "text": "non-privileged attacker basically one that is running as as in in the context of non-admin account can it trick a",
    "start": "655079",
    "end": "662920"
  },
  {
    "text": "privilege process to follow that link and then lead it to delete a restricted",
    "start": "662920",
    "end": "668440"
  },
  {
    "text": "or protected registry key that the non-admin user does not have permissions",
    "start": "668440",
    "end": "673839"
  },
  {
    "text": "to delete it in the first place now in most cases this not an",
    "start": "673839",
    "end": "679320"
  },
  {
    "text": "issue because privilege processes they would either impersonate so if they are",
    "start": "679320",
    "end": "684760"
  },
  {
    "text": "running as system they would impersonate the currently logged in user basically lowering their per uses before they",
    "start": "684760",
    "end": "690639"
  },
  {
    "text": "perform an action like a delete action on a key that is in in unprotected",
    "start": "690639",
    "end": "696639"
  },
  {
    "text": "location or they simply don't delete keys in location that are in in",
    "start": "696639",
    "end": "701920"
  },
  {
    "text": "unprotected locations however there's there are certain types of application like",
    "start": "701920",
    "end": "708519"
  },
  {
    "text": "antivirus and EDR agents that their objective is to remediate and delete",
    "start": "708519",
    "end": "714800"
  },
  {
    "text": "regist threats that are detected including malicious keys or or unwanted",
    "start": "714800",
    "end": "719959"
  },
  {
    "text": "keys and they do so even if the if that key is in unprotected",
    "start": "719959",
    "end": "727040"
  },
  {
    "text": "location and to achieve that goal if they want to lower their or if they want to impersonate the the currently logged",
    "start": "727320",
    "end": "734600"
  },
  {
    "text": "in user so if they are running as system and they want to lower their privileges to user that will be safer for them but",
    "start": "734600",
    "end": "741240"
  },
  {
    "text": "might be insufficient to get rid of the malicious key so what they do they go at The unwant Unwanted registry key with",
    "start": "741240",
    "end": "747480"
  },
  {
    "text": "their High system privilege and they try to remove that which Expos them to security risk if they if that key",
    "start": "747480",
    "end": "755000"
  },
  {
    "text": "happened to be a link and they fail to check that prior to deleting",
    "start": "755000",
    "end": "760079"
  },
  {
    "text": "it now this is the vulnerability but I'll be talking a little bit about the risk of that vulnerability but the",
    "start": "760079",
    "end": "766639"
  },
  {
    "text": "vulnerability itself I initially found this during a security assessment I did on one specific antivirus product but",
    "start": "766639",
    "end": "774600"
  },
  {
    "text": "when I realized how insufficient the documentation was around the whole top of registry symbolic",
    "start": "774600",
    "end": "781360"
  },
  {
    "text": "lengths I I knew that other windows must be also vulnerable to that and and sure enough with the help of colleagues and",
    "start": "781360",
    "end": "788480"
  },
  {
    "text": "friends we were able to test 18 vendors and we found out that apart from two",
    "start": "788480",
    "end": "794240"
  },
  {
    "text": "they all were vulnerable to this issue since then they have all patched their products but we are unable to test",
    "start": "794240",
    "end": "802600"
  },
  {
    "text": "all products on the market so it is likely that some other vendors that we have we haven't tested they are still",
    "start": "802600",
    "end": "808680"
  },
  {
    "text": "vulnerable to this to this issue also I should mention that my research was",
    "start": "808680",
    "end": "814600"
  },
  {
    "text": "focused on initially on AV and EDR but it's it's there is a chance that there",
    "start": "814600",
    "end": "821880"
  },
  {
    "text": "other other applications are also vulnerable to this issue and I will show you at the very end an example for",
    "start": "821880",
    "end": "828760"
  },
  {
    "text": "application other than antivirus and DDR that are vulnerable to this to this",
    "start": "828760",
    "end": "835240"
  },
  {
    "text": "issue now here I would like to talk a little bit about the the process I went",
    "start": "835240",
    "end": "840440"
  },
  {
    "text": "through to identify the actually the actual security risk behind this",
    "start": "840440",
    "end": "846199"
  },
  {
    "text": "vulnerability so and the idea is that I want to find a location that a non-admin",
    "start": "846199",
    "end": "852680"
  },
  {
    "text": "user can create a link at and then trick a privilege process to follow that and",
    "start": "852680",
    "end": "857759"
  },
  {
    "text": "delete a protected registry key and if you are familiar with the Windows registry you know that there are several",
    "start": "857759",
    "end": "864000"
  },
  {
    "text": "registry hpes so the main two ones is the current user registry hype and the Lo machine regist HP so what I my my",
    "start": "864000",
    "end": "872839"
  },
  {
    "text": "assumption was at the beginning that the current user regist HP is owned by the",
    "start": "872839",
    "end": "877959"
  },
  {
    "text": "current user currently logged in user and I assume that all keys under that",
    "start": "877959",
    "end": "883920"
  },
  {
    "text": "are accessible and writable by the the the current user but I wanted to double",
    "start": "883920",
    "end": "890639"
  },
  {
    "text": "check that so I use the the tool access check from CIS antennas to try to find",
    "start": "890639",
    "end": "896240"
  },
  {
    "text": "if there are Keys within the local machine within the current user registry",
    "start": "896240",
    "end": "901560"
  },
  {
    "text": "H basically H kecu that the current user have only read only access to meaning that they",
    "start": "901560",
    "end": "907880"
  },
  {
    "text": "are protected for one reason or the other and I came across a couple of interesting ones the first one is the",
    "start": "907880",
    "end": "914639"
  },
  {
    "text": "second line from Top which is the registry key where the the the browser",
    "start": "914639",
    "end": "920680"
  },
  {
    "text": "Edge stores a the path to a manifest file that specify the path for an",
    "start": "920680",
    "end": "927279"
  },
  {
    "text": "executable that belongs to the Native Messaging host basically an executable that facilitate the communication",
    "start": "927279",
    "end": "934000"
  },
  {
    "text": "between trusted extensions that runs within Edge and the host system and it",
    "start": "934000",
    "end": "939600"
  },
  {
    "text": "is possible to manage the middle of that process but I that will be out of the",
    "start": "939600",
    "end": "944680"
  },
  {
    "text": "scope for today what I'll be covering is the second interesting registry key which is the the the one highlighted in",
    "start": "944680",
    "end": "951639"
  },
  {
    "text": "yellow in the middle of the screen which is H kecu software",
    "start": "951639",
    "end": "957040"
  },
  {
    "text": "policies but before we go into the the details on that one I just want to mention a couple of things here first",
    "start": "957040",
    "end": "963600"
  },
  {
    "text": "Windows does not allow you to create links across different registry hives you cannot create one from the current",
    "start": "963600",
    "end": "970040"
  },
  {
    "text": "user registry Hive to the local machine registry Hive for security reason and the second thing I want to",
    "start": "970040",
    "end": "976120"
  },
  {
    "text": "mention is that I try to run the same exercise where I run access check to find the opposite thing on the local",
    "start": "976120",
    "end": "982680"
  },
  {
    "text": "machine registry I which is the protected registry I to try to find if there are registry keys within that that",
    "start": "982680",
    "end": "989160"
  },
  {
    "text": "the non-admin user have permissions to write to basically to create Links at so",
    "start": "989160",
    "end": "996160"
  },
  {
    "text": "I found bunch of those but none were interesting in the context of Av and EDR",
    "start": "996160",
    "end": "1001360"
  },
  {
    "text": "meaning the even if I was able to create a link there it would have been difficult for me to get the AV or the",
    "start": "1001360",
    "end": "1006839"
  },
  {
    "text": "EDR to delete that location it might be possible I just didn't spend enough time looking into",
    "start": "1006839",
    "end": "1015519"
  },
  {
    "text": "that now back to that current user software policies registry key and that is the the location where Windows stores",
    "start": "1015519",
    "end": "1024360"
  },
  {
    "text": "the local group policies for the currently logged in user and in Windows",
    "start": "1024360",
    "end": "1029678"
  },
  {
    "text": "only admin admin accounts are authorized to configure locally grow policies non",
    "start": "1029679",
    "end": "1035839"
  },
  {
    "text": "admin users are not authorized to do so so if you happen to have a maybe a corporate Windows laptop you probably",
    "start": "1035839",
    "end": "1042360"
  },
  {
    "text": "are assigned a non admin account onto that so and if you try to run for example gpedit MC you probably will see",
    "start": "1042360",
    "end": "1050360"
  },
  {
    "text": "an access is denied because you as a non-admin user should not be allowed to",
    "start": "1050360",
    "end": "1056080"
  },
  {
    "text": "configure group policies even the local ones for for your own user similarly if you try to",
    "start": "1056080",
    "end": "1062360"
  },
  {
    "text": "view the permissions on the policies register key you will see you only have read only",
    "start": "1062360",
    "end": "1069679"
  },
  {
    "text": "access now there are thousands of local group policies that you can sit as part",
    "start": "1071679",
    "end": "1077840"
  },
  {
    "text": "of those local group group policies including from Microsoft and other vendors so it is imperative on Windows",
    "start": "1077840",
    "end": "1085440"
  },
  {
    "text": "to secure that location because otherwise an attackers if they are able",
    "start": "1085440",
    "end": "1090840"
  },
  {
    "text": "to configure local group policies they will be able to gain additional capabilities and permissions on the",
    "start": "1090840",
    "end": "1097039"
  },
  {
    "text": "system that you don't want to give them that and here is one example H for a a",
    "start": "1097039",
    "end": "1105320"
  },
  {
    "text": "group policies a group policy that you can set as part of those local local",
    "start": "1105320",
    "end": "1110440"
  },
  {
    "text": "group policies it's called Always install elevated and that's a policy that",
    "start": "1110440",
    "end": "1115840"
  },
  {
    "text": "enables non admin users to install Windows package installer with elevated",
    "start": "1115840",
    "end": "1123080"
  },
  {
    "text": "system privileges basically it will give the non-admin user an ability to install MSI",
    "start": "1123080",
    "end": "1129760"
  },
  {
    "text": "installers without having to enter the an admin credentials so typically an",
    "start": "1129760",
    "end": "1135159"
  },
  {
    "text": "admin would give this to users so they are not bothered by them asking for credentials every single time they want",
    "start": "1135159",
    "end": "1141559"
  },
  {
    "text": "to install an MSI installer now this is a very risky policy to set and whens",
    "start": "1141559",
    "end": "1146840"
  },
  {
    "text": "required to be set on the local machine Hive and also",
    "start": "1146840",
    "end": "1152559"
  },
  {
    "text": "perir each user you want to enable this policy for and attackers have been ex abusing",
    "start": "1152559",
    "end": "1159640"
  },
  {
    "text": "this by basically if a male were running on the system they would they will quate the registry the registry and see if",
    "start": "1159640",
    "end": "1166559"
  },
  {
    "text": "it's set per local machine and per user and if so they will run their malicious",
    "start": "1166559",
    "end": "1171640"
  },
  {
    "text": "code as an MSI installer and this way they would Elevate their privileges from",
    "start": "1171640",
    "end": "1177799"
  },
  {
    "text": "non-admin user into system without needing any vulnerability so it's not",
    "start": "1177799",
    "end": "1184320"
  },
  {
    "text": "something that you would want to set now imagine the case where this has been already set per local machine but it's",
    "start": "1184320",
    "end": "1192960"
  },
  {
    "text": "not set by for the user and we will see how we can exploit the vulnerability the",
    "start": "1192960",
    "end": "1199480"
  },
  {
    "text": "registry symbolic link vulnerability to enable this also per",
    "start": "1199480",
    "end": "1205960"
  },
  {
    "text": "user and here is here is how the attack goes so we have an attacker running in",
    "start": "1205960",
    "end": "1212440"
  },
  {
    "text": "the context of non-admin user so regular regular user so what they can do they",
    "start": "1212440",
    "end": "1219080"
  },
  {
    "text": "can Create a Sim link registry Sim link under the under the current user",
    "start": "1219080",
    "end": "1224600"
  },
  {
    "text": "registry Hive and they would create that under a location that they know that a",
    "start": "1224600",
    "end": "1229679"
  },
  {
    "text": "vulnerable privilege process would be deleting along with the link itself and the link itself will be",
    "start": "1229679",
    "end": "1236799"
  },
  {
    "text": "pointing to the policies registry key which is a read only policy by",
    "start": "1236799",
    "end": "1242960"
  },
  {
    "text": "default in the Second Step the attacker would either wait or trigger the",
    "start": "1242960",
    "end": "1248640"
  },
  {
    "text": "privileged process to delete that location along with the link now the the",
    "start": "1248640",
    "end": "1254240"
  },
  {
    "text": "privilege process if it's vulnerable would be thinking that they are deleting the Sim link itself but in reality they",
    "start": "1254240",
    "end": "1260679"
  },
  {
    "text": "will end up deleting the policies because that's how RI delete key works",
    "start": "1260679",
    "end": "1267440"
  },
  {
    "text": "in Windows it deletes the Target by default and not the link okay once that",
    "start": "1267440",
    "end": "1273600"
  },
  {
    "text": "has been deleted what the attacker can do they can recreate the policies registry key but this time with with",
    "start": "1273600",
    "end": "1280480"
  },
  {
    "text": "create with recreate with permissive right permissions so read and write and",
    "start": "1280480",
    "end": "1286080"
  },
  {
    "text": "they can do so because they have enough permissions on the parent registry key",
    "start": "1286080",
    "end": "1292799"
  },
  {
    "text": "now since you have right now access to the policies you can sit whatever local",
    "start": "1292799",
    "end": "1299360"
  },
  {
    "text": "group policies you want including the always install elevated and once that",
    "start": "1299360",
    "end": "1304600"
  },
  {
    "text": "has been set you can just run your malicious code as as an MSI installer and that would",
    "start": "1304600",
    "end": "1311840"
  },
  {
    "text": "basically Elevate the attacker privileges from non-admin to system",
    "start": "1311840",
    "end": "1318200"
  },
  {
    "text": "which basically you have access to that I have a short demo here a recorded",
    "start": "1318200",
    "end": "1324480"
  },
  {
    "text": "demo that basically shows this attack so I have a Windows Windows 11 running a",
    "start": "1324480",
    "end": "1331919"
  },
  {
    "text": "standard non-admin user and they have an a vulnerable antivirus and I'm just",
    "start": "1331919",
    "end": "1337679"
  },
  {
    "text": "hiding the identity of the of the antivirus because there were so many of them that are vulnerable and I didn't",
    "start": "1337679",
    "end": "1343600"
  },
  {
    "text": "want them to to blame me for picking up on one of them so here you can see that I have a",
    "start": "1343600",
    "end": "1350960"
  },
  {
    "text": "medium Integrity which is the non-admin",
    "start": "1350960",
    "end": "1356039"
  },
  {
    "text": "integrity and I have a demo here that the first thing my demo is doing is just validating the the default configuration",
    "start": "1356039",
    "end": "1363159"
  },
  {
    "text": "first thing I'm I'm going to run run an MSI installer which is called CMD MSI",
    "start": "1363159",
    "end": "1370559"
  },
  {
    "text": "and by default this should run as a regular user not a system the the C the",
    "start": "1370559",
    "end": "1377080"
  },
  {
    "text": "the MSI installer will launches cmd.exe and if I run who am I into that you will",
    "start": "1377080",
    "end": "1383000"
  },
  {
    "text": "see that it's running as limited which is the default without any elevation",
    "start": "1383000",
    "end": "1390000"
  },
  {
    "text": "then I'm just verifying that I indeed have readon permissions on the policies",
    "start": "1390000",
    "end": "1395279"
  },
  {
    "text": "register key and if I try to H write or delete delete it then I'm going to get",
    "start": "1395279",
    "end": "1402600"
  },
  {
    "text": "an access is denied and that's that's the default beay then in in um in Step",
    "start": "1402600",
    "end": "1409400"
  },
  {
    "text": "number six I'm I'm basically running my exploit here and the exploit is as I",
    "start": "1409400",
    "end": "1414840"
  },
  {
    "text": "mentioned in the attack before I'm creating a link and pointing that link to the a polies registry key and I'm",
    "start": "1414840",
    "end": "1424760"
  },
  {
    "text": "creating this at a location that if you are familiar with antiviruses they have",
    "start": "1424760",
    "end": "1431279"
  },
  {
    "text": "when when a Mal work some malw they would create malicious registry key basically would create registry keys",
    "start": "1431279",
    "end": "1437880"
  },
  {
    "text": "Within the registry and some some all of the antiviruses have a list of non bad",
    "start": "1437880",
    "end": "1445320"
  },
  {
    "text": "registry keys so what my exploit would be doing would be intentionally creating",
    "start": "1445320",
    "end": "1451440"
  },
  {
    "text": "a malicious or something that would look as a malicious registry key to the antivirus so when the antivirus is",
    "start": "1451440",
    "end": "1457559"
  },
  {
    "text": "scanning the registry they will pick up that and try to to delete it but I will",
    "start": "1457559",
    "end": "1463000"
  },
  {
    "text": "be configuring that as a link so I have here created that link",
    "start": "1463000",
    "end": "1469360"
  },
  {
    "text": "already and the way I'm triggering the antivirus is by by simply running quick scan here I could have also waited for",
    "start": "1469360",
    "end": "1476039"
  },
  {
    "text": "the antivirus to to just scan the registry and it it is running in the background here it is running in the",
    "start": "1476039",
    "end": "1483360"
  },
  {
    "text": "background and soon enough you will see that it it deleted the the they tried to delete the",
    "start": "1483360",
    "end": "1490640"
  },
  {
    "text": "link but it will end up deleting the policy so my demo here exe is just",
    "start": "1490640",
    "end": "1495880"
  },
  {
    "text": "waiting for that policies to get deleted",
    "start": "1495880",
    "end": "1500320"
  },
  {
    "text": "it so here here we have it the policies was deleted and then I recreated that",
    "start": "1506399",
    "end": "1513520"
  },
  {
    "text": "once it has been delete it I have I can recreate it with right and then I'm able",
    "start": "1513520",
    "end": "1518840"
  },
  {
    "text": "to sorry now I have right access and then I",
    "start": "1518840",
    "end": "1525480"
  },
  {
    "text": "can run add the always install elevated and if I run the same MSI installer from",
    "start": "1525480",
    "end": "1532080"
  },
  {
    "text": "before it will run CMD who am I and now you see here we got",
    "start": "1532080",
    "end": "1537919"
  },
  {
    "text": "system on the system on the yes so that is the first",
    "start": "1537919",
    "end": "1547039"
  },
  {
    "text": "demo",
    "start": "1550039",
    "end": "1553039"
  },
  {
    "text": "oops okay the second attack",
    "start": "1557240",
    "end": "1562278"
  },
  {
    "text": "Victor this is very specific to antivirus and EDR the first attack Victor it's it's it's a more generic",
    "start": "1563760",
    "end": "1571520"
  },
  {
    "text": "attack it can be applicable to other types of application other than AV and DDR but this one is very specific to AV",
    "start": "1571520",
    "end": "1578279"
  },
  {
    "text": "and DDR so when you install an antivirus or an ADR agent in your system it will",
    "start": "1578279",
    "end": "1584880"
  },
  {
    "text": "install itself as a system service and that means that it will add itself under the current control set",
    "start": "1584880",
    "end": "1594880"
  },
  {
    "text": "services and if an attacker is able to delete that registry key that belongs to",
    "start": "1594960",
    "end": "1601080"
  },
  {
    "text": "the antivirus and then you reboot the system then basically you disable the",
    "start": "1601080",
    "end": "1607240"
  },
  {
    "text": "antivirus so what antiviruses and EDR do they Implement something called anti-tamper",
    "start": "1607240",
    "end": "1613399"
  },
  {
    "text": "protection basically to protect their own registry keys files and so on because you don't want an attacker even",
    "start": "1613399",
    "end": "1619640"
  },
  {
    "text": "the one that is running as an admin to delete their own registry keys and disable the antivirus this way but what",
    "start": "1619640",
    "end": "1627039"
  },
  {
    "text": "an an attacker can do can bypass that that anti-er protection by again",
    "start": "1627039",
    "end": "1632720"
  },
  {
    "text": "creating a siming but it it's going to be pointing to the antivirus registry key and then they will trigger or wait",
    "start": "1632720",
    "end": "1640880"
  },
  {
    "text": "the antivirus and the antivirus will think that they are deleting the Sim link but they will end up deleting their",
    "start": "1640880",
    "end": "1647159"
  },
  {
    "text": "own registry key the one that is basically telling Windows how to run",
    "start": "1647159",
    "end": "1652880"
  },
  {
    "text": "their system service and it that would work because the their anti-er protection is not",
    "start": "1652880",
    "end": "1658919"
  },
  {
    "text": "enforced on their own processes and now once once you reboot the system",
    "start": "1658919",
    "end": "1664640"
  },
  {
    "text": "basically you will disable the AV or the EDR and using this exact technique I was",
    "start": "1664640",
    "end": "1671679"
  },
  {
    "text": "able to disable a very known EDR agent and when once I have rebooted the",
    "start": "1671679",
    "end": "1678240"
  },
  {
    "text": "system the UI component of that EDR agent popped up and telling me that the endpoint security agent is not running",
    "start": "1678240",
    "end": "1685120"
  },
  {
    "text": "because the core system service was no longer running on the",
    "start": "1685120",
    "end": "1690640"
  },
  {
    "text": "system now just to recap the security impact of of this vulnerability first",
    "start": "1691600",
    "end": "1697399"
  },
  {
    "text": "none or attackers running in the context of non admin user can configure group",
    "start": "1697399",
    "end": "1703640"
  },
  {
    "text": "policies that would otherwise be inaccessible to them and that would",
    "start": "1703640",
    "end": "1709159"
  },
  {
    "text": "through that they will gain additional capabilities and permissions on the system and as an extension to that they",
    "start": "1709159",
    "end": "1715240"
  },
  {
    "text": "can also es escalate their PR their privileges from non-admin to system in",
    "start": "1715240",
    "end": "1722000"
  },
  {
    "text": "some certain some cases like they always install elevated that I I've shown",
    "start": "1722000",
    "end": "1728159"
  },
  {
    "text": "before second thing you can disable security products like antivirus EDR",
    "start": "1728159",
    "end": "1733360"
  },
  {
    "text": "firewalls and so on and there are probably more security impacts depends on what registry key the",
    "start": "1733360",
    "end": "1742240"
  },
  {
    "text": "attacker is trying to take advantage of you can break the entire system like getting into a definite indefinite blue",
    "start": "1742240",
    "end": "1749760"
  },
  {
    "text": "screen by for example deleting a very critical registry key that windows will",
    "start": "1749760",
    "end": "1755200"
  },
  {
    "text": "not be able to H load without it now how did this bug surface and who",
    "start": "1755200",
    "end": "1763640"
  },
  {
    "text": "is it to blame with it really now it it is tempting to blame blame the software",
    "start": "1763640",
    "end": "1768840"
  },
  {
    "text": "vendor especially if that software vendor happen to be an antivirus product but in reality when you examine the",
    "start": "1768840",
    "end": "1775519"
  },
  {
    "text": "underlying causes of of the issue you will see a number of unfortunate factors",
    "start": "1775519",
    "end": "1781559"
  },
  {
    "text": "so first you had we have an unexpected behavior in the way those apis that",
    "start": "1781559",
    "end": "1788080"
  },
  {
    "text": "deals with deleting registry keys behave on Windows in the way they they delete the target rather rather than the link",
    "start": "1788080",
    "end": "1795480"
  },
  {
    "text": "which is not the expected behavior when you you are dealing with deleting a",
    "start": "1795480",
    "end": "1800679"
  },
  {
    "text": "link and that that basically formed the foundation of the problem we have here secondly we have inadequate",
    "start": "1800679",
    "end": "1807640"
  },
  {
    "text": "documentation from Microsoft that failed to warn about the risk of handling",
    "start": "1807640",
    "end": "1813480"
  },
  {
    "text": "registry or deleting registry link which I believe was the a",
    "start": "1813480",
    "end": "1819279"
  },
  {
    "text": "core a core factor in the problems development and lastly some",
    "start": "1819279",
    "end": "1825240"
  },
  {
    "text": "responsibility must also be placed on the software window for not having tested their product",
    "start": "1825240",
    "end": "1832240"
  },
  {
    "text": "sufficiently but in my opinion there was a a combination of different risks that",
    "start": "1832240",
    "end": "1837480"
  },
  {
    "text": "led to pretty much the entire industry of Av and EDR making the same mistake",
    "start": "1837480",
    "end": "1844000"
  },
  {
    "text": "because we found out that pretty much all of them have fallen into this same same mistake and in my opinion if the",
    "start": "1844000",
    "end": "1850559"
  },
  {
    "text": "documentation was a little bit more uh comprehensive and telling the software that you need to pay attention to that",
    "start": "1850559",
    "end": "1857240"
  },
  {
    "text": "they might not have made that",
    "start": "1857240",
    "end": "1861519"
  },
  {
    "text": "error now as I mentioned initially my initial research was focused on AV and",
    "start": "1862440",
    "end": "1868799"
  },
  {
    "text": "EDR but the vulnerability itself can be and is applicable to other applications",
    "start": "1868799",
    "end": "1874240"
  },
  {
    "text": "and here I'm going to give an example to that so what is common to Google",
    "start": "1874240",
    "end": "1880159"
  },
  {
    "text": "products that have native application that run on Windows for example Google",
    "start": "1880159",
    "end": "1885559"
  },
  {
    "text": "Earth or Google Chrome and other browsers that are based on Chrome like",
    "start": "1885559",
    "end": "1890600"
  },
  {
    "text": "Opera Brave Edge and even non browser application like",
    "start": "1890600",
    "end": "1895760"
  },
  {
    "text": "Dropbox they they all use the same installer or updator called Google Oma",
    "start": "1895760",
    "end": "1902039"
  },
  {
    "text": "developed by Google by Google and that Google Omaha is runs in",
    "start": "1902039",
    "end": "1908120"
  },
  {
    "text": "its own process typically it's called Google update.exe and it runs as a very",
    "start": "1908120",
    "end": "1914120"
  },
  {
    "text": "privileged process in the in the context of trusted install",
    "start": "1914120",
    "end": "1919799"
  },
  {
    "text": "account and that's basically is responsible for three things installing",
    "start": "1919799",
    "end": "1925039"
  },
  {
    "text": "the application updating the application and and installing the application",
    "start": "1925039",
    "end": "1931080"
  },
  {
    "text": "okay and what I found I found when I looked at this I found three issues with",
    "start": "1931080",
    "end": "1936760"
  },
  {
    "text": "this first it does not handle deleting registry Sim links Now by itself it's",
    "start": "1936760",
    "end": "1943480"
  },
  {
    "text": "not an issue even if it's in a privileged process but when it becomes issue when you are dealing with when you",
    "start": "1943480",
    "end": "1950159"
  },
  {
    "text": "when you are facing issue number two and number three here and number two here is that this a privilege process delete",
    "start": "1950159",
    "end": "1957840"
  },
  {
    "text": "keys in the current user registry Hive from a privilege process and those keys",
    "start": "1957840",
    "end": "1965000"
  },
  {
    "text": "can be in unpredicted locations meaning that the attacker can create a link there and pointing the link to a",
    "start": "1965000",
    "end": "1972279"
  },
  {
    "text": "privileged or protected registry key like the policies registry key I was talking about so that is the second",
    "start": "1972279",
    "end": "1979440"
  },
  {
    "text": "issue the third issue is the more critical issue is that they create a key under",
    "start": "1979440",
    "end": "1986159"
  },
  {
    "text": "the local machine registry Hive which is the protected registry Hive and and that's the code on the right side that",
    "start": "1986159",
    "end": "1992799"
  },
  {
    "text": "that shows that the the the key they they they create it's called client",
    "start": "1992799",
    "end": "1997919"
  },
  {
    "text": "State medium and what they do is that they override the default privileges of that key where",
    "start": "1997919",
    "end": "2005639"
  },
  {
    "text": "they allow non-admin users to right to it meaning that you can also create",
    "start": "2005639",
    "end": "2011399"
  },
  {
    "text": "links under that L under that key and if you are able to create a link",
    "start": "2011399",
    "end": "2017519"
  },
  {
    "text": "under that key from non-admin user you can point it anywhere in the local machine registry Hive and",
    "start": "2017519",
    "end": "2024519"
  },
  {
    "text": "basically you will end up deleting or causing that installer or uninstaller to delete something the the non admin user",
    "start": "2024519",
    "end": "2031919"
  },
  {
    "text": "should not be allowed to do so now what I reported that Google",
    "start": "2031919",
    "end": "2038559"
  },
  {
    "text": "obviously and they have fixed the issue by deleting register Sim link instead of",
    "start": "2038559",
    "end": "2045399"
  },
  {
    "text": "the targets when deleting registry key so they would check if the key is a link",
    "start": "2045399",
    "end": "2050760"
  },
  {
    "text": "and if so they would delete the the link rather than using the default API",
    "start": "2050760",
    "end": "2057398"
  },
  {
    "text": "Behavior so basically what they did here they fixed number one but that that fix is incomplete or",
    "start": "2057399",
    "end": "2066000"
  },
  {
    "text": "or can be risky because the delete is one issue but also writing through",
    "start": "2066000",
    "end": "2071320"
  },
  {
    "text": "register Sim link is also can be an issue luckily they are not vulnerable to the right through link but they are V",
    "start": "2071320",
    "end": "2078760"
  },
  {
    "text": "were they were vulnerable through delete through link so the fixed number one and that",
    "start": "2078760",
    "end": "2086240"
  },
  {
    "text": "subsequently fixed the issue number two and number three for their specific",
    "start": "2086240",
    "end": "2091280"
  },
  {
    "text": "case now they made two fixes one on Google Chrome and one on Google Omaha",
    "start": "2091280",
    "end": "2096520"
  },
  {
    "text": "Google Chrome is using slightly different version of Google Omaha but it's pretty much the same code base and",
    "start": "2096520",
    "end": "2103720"
  },
  {
    "text": "here at the bottom I took a snapshot from the comment that they",
    "start": "2103720",
    "end": "2109000"
  },
  {
    "text": "made where you can see that they had to use the undocumented API in delete key",
    "start": "2109000",
    "end": "2115079"
  },
  {
    "text": "and they say in the comment declare in in delete key since no official header",
    "start": "2115079",
    "end": "2121079"
  },
  {
    "text": "has it and that's the problem basically from Microsoft because they are not pro",
    "start": "2121079",
    "end": "2127680"
  },
  {
    "text": "providing a good way to delete or support deleting registry links so you",
    "start": "2127680",
    "end": "2134079"
  },
  {
    "text": "as a developer you'll have to use undocumented apis to implement things",
    "start": "2134079",
    "end": "2142078"
  },
  {
    "text": "correctly now the issue to to exploit these issues in",
    "start": "2143359",
    "end": "2150040"
  },
  {
    "text": "Google updator or an installer whatever you want to call it the user must",
    "start": "2150040",
    "end": "2155160"
  },
  {
    "text": "uninstall the application in order to get get the registry key to be deleted",
    "start": "2155160",
    "end": "2160800"
  },
  {
    "text": "and then you know delete the link and then what it is pointed to but How likely this is to happen I mean once you",
    "start": "2160800",
    "end": "2167359"
  },
  {
    "text": "install Google Chrome or Google Earth it's it's rare that you would end up",
    "start": "2167359",
    "end": "2173119"
  },
  {
    "text": "having to uninstall it or reinstall it but what emare can do they can force",
    "start": "2173119",
    "end": "2179920"
  },
  {
    "text": "the user to reinstall the product they affected the product and they can do so",
    "start": "2179920",
    "end": "2186400"
  },
  {
    "text": "by causing the application to display a fake error message up on",
    "start": "2186400",
    "end": "2191800"
  },
  {
    "text": "loading and then suggest to the user to uninstall it or reinstall",
    "start": "2191800",
    "end": "2197480"
  },
  {
    "text": "it and then termin it now typically you shouldn't be able",
    "start": "2197480",
    "end": "2203319"
  },
  {
    "text": "to to do that like you cannot the non malare running in an non admin user they",
    "start": "2203319",
    "end": "2210960"
  },
  {
    "text": "shouldn't be allow they shouldn't be ER shouldn't be easy for them to get Google",
    "start": "2210960",
    "end": "2216599"
  },
  {
    "text": "Chrome or Google a to display an error like this because that temp tempering in their code but what the the attacker can",
    "start": "2216599",
    "end": "2224640"
  },
  {
    "text": "do they can combine the the registry vulnerability with another attack for",
    "start": "2224640",
    "end": "2231560"
  },
  {
    "text": "example side loading attack where you get the application to inadvertently",
    "start": "2231560",
    "end": "2237760"
  },
  {
    "text": "load another DL to do what you want here which is display a fake or message that",
    "start": "2237760",
    "end": "2243599"
  },
  {
    "text": "would suggest to the user to terminate and then terminate the application and the they found a uh availability like",
    "start": "2243599",
    "end": "2249680"
  },
  {
    "text": "this in Google Earth and I will be demoing this shortly after this slide",
    "start": "2249680",
    "end": "2255400"
  },
  {
    "text": "you can also for the MW they can also for example manipulate the desktop",
    "start": "2255400",
    "end": "2260480"
  },
  {
    "text": "shortcuts icons so basically you cannot delete Chrome icon on the desktop but",
    "start": "2260480",
    "end": "2266040"
  },
  {
    "text": "you can moving away from the visible screen and then put another icon that",
    "start": "2266040",
    "end": "2271480"
  },
  {
    "text": "points to an application that basically all it does is just displaying that error message and then terminate from",
    "start": "2271480",
    "end": "2279079"
  },
  {
    "text": "the user perspective it would look like as if Chrome is terminating for no good",
    "start": "2279079",
    "end": "2284280"
  },
  {
    "text": "reason and then you'll have to reinstall",
    "start": "2284280",
    "end": "2288760"
  },
  {
    "text": "it so the so the first demo is the is that",
    "start": "2291920",
    "end": "2298920"
  },
  {
    "text": "Google Earth DLS Side Learning which is like if you think of it is the first stage in the attack you you exploit this",
    "start": "2298920",
    "end": "2305640"
  },
  {
    "text": "just to get the user to uninstall the application and then the second stage you will exploit the the registry uh",
    "start": "2305640",
    "end": "2315000"
  },
  {
    "text": "vulnerability so when you install Google Earth and here I'm installing have have",
    "start": "2315000",
    "end": "2321160"
  },
  {
    "text": "installed it it will install itself under the program files folder which is",
    "start": "2321160",
    "end": "2326319"
  },
  {
    "text": "a protected folder so non admin users should not be allowed to to write into",
    "start": "2326319",
    "end": "2332800"
  },
  {
    "text": "that so you cannot tamper with it but what is interesting is that when",
    "start": "2332800",
    "end": "2339760"
  },
  {
    "text": "you when you when Google Earth loads it's it loads a d called Swift to swift.",
    "start": "2339760",
    "end": "2347000"
  },
  {
    "text": "D it loads other DS this way but what's interesting about this is that it loads",
    "start": "2347000",
    "end": "2352440"
  },
  {
    "text": "this with the with the file name only so it does not specify the full path which",
    "start": "2352440",
    "end": "2358000"
  },
  {
    "text": "means that what happen is that when you when you do something like this in Windows Windows will look for that D",
    "start": "2358000",
    "end": "2365160"
  },
  {
    "text": "into in the current in the in the current uh the current folder of the application",
    "start": "2365160",
    "end": "2372240"
  },
  {
    "text": "so in this case in Google Earth if it does not find it then it would search in",
    "start": "2372240",
    "end": "2377920"
  },
  {
    "text": "the dll search order of Windows which is a pre predefined folders that Windows",
    "start": "2377920",
    "end": "2383359"
  },
  {
    "text": "would query to to try to find that that that D so for example it will first try",
    "start": "2383359",
    "end": "2390800"
  },
  {
    "text": "to search for it in system 32 in Windows and so on until it gets to a point where",
    "start": "2390800",
    "end": "2396319"
  },
  {
    "text": "it looks for that into the folders that are specified by the path environment environment",
    "start": "2396319",
    "end": "2403680"
  },
  {
    "text": "variable for both system and user and that path include this folder",
    "start": "2403680",
    "end": "2410119"
  },
  {
    "text": "users limited app Microsoft Windows apps and this",
    "start": "2410119",
    "end": "2416480"
  },
  {
    "text": "folder for a non-admin user is a writable folder meaning that you",
    "start": "2418200",
    "end": "2425040"
  },
  {
    "text": "can place a we can see here the",
    "start": "2425040",
    "end": "2430079"
  },
  {
    "text": "permissions on this folder you'll see you have full control",
    "start": "2432599",
    "end": "2439359"
  },
  {
    "text": "over this folder so what you can what a malare can do they can basically place that Swift tol into that folder and then",
    "start": "2439359",
    "end": "2448280"
  },
  {
    "text": "when you run Google Google Earth it will try to load Swift to D and again as as I",
    "start": "2448280",
    "end": "2456160"
  },
  {
    "text": "mentioned before that that DL will just simply display a fake error message so",
    "start": "2456160",
    "end": "2461440"
  },
  {
    "text": "in this showing to the user it's a critical error and you need to uninstall and then",
    "start": "2461440",
    "end": "2467680"
  },
  {
    "text": "re then reinstall the application to resolve the the issue so that that way a",
    "start": "2467680",
    "end": "2473920"
  },
  {
    "text": "malare can actually force a user to reinstall the application and then they",
    "start": "2473920",
    "end": "2480920"
  },
  {
    "text": "can exploit the the second stage and this is a demo of a second",
    "start": "2480920",
    "end": "2487760"
  },
  {
    "text": "stage and in this in this demo um I'm creating a",
    "start": "2487760",
    "end": "2494599"
  },
  {
    "text": "registry I'm creating a registry link that is pointing to the filter manager service which is a very critical service",
    "start": "2494599",
    "end": "2501599"
  },
  {
    "text": "to Windows without it it will not run and I'm creating this from non-admin",
    "start": "2501599",
    "end": "2507599"
  },
  {
    "text": "user under this client State medium which I mentioned before which they",
    "start": "2507599",
    "end": "2512720"
  },
  {
    "text": "override their privileges to allow non-admin users to to create links",
    "start": "2512720",
    "end": "2518280"
  },
  {
    "text": "that okay and once I have done that now from the user perspective they",
    "start": "2518280",
    "end": "2525560"
  },
  {
    "text": "would see they would run Google Earth they will be greeted with this error message the fake one suggesting to",
    "start": "2525560",
    "end": "2532440"
  },
  {
    "text": "them oh you should reinstall the application because you are we are unable to run it for for for no",
    "start": "2532440",
    "end": "2540640"
  },
  {
    "text": "apparent reason just going to skip quickly",
    "start": "2540640",
    "end": "2546119"
  },
  {
    "text": "here",
    "start": "2546119",
    "end": "2549119"
  },
  {
    "text": "so the user will go ahead and try to andinstall it of course you need an",
    "start": "2551839",
    "end": "2557920"
  },
  {
    "text": "admin account for that and then they try",
    "start": "2557920",
    "end": "2563078"
  },
  {
    "text": "to install the",
    "start": "2563359",
    "end": "2567000"
  },
  {
    "text": "application it's stopped for some reason",
    "start": "2574640",
    "end": "2579119"
  },
  {
    "text": "think I need to rerun the application the video",
    "start": "2584839",
    "end": "2590078"
  },
  {
    "text": "again so I'm just as a user trying to reinstall the application and during",
    "start": "2596920",
    "end": "2602400"
  },
  {
    "text": "that that process the filter manager here which shortly will disappear",
    "start": "2602400",
    "end": "2609040"
  },
  {
    "text": "here so Google Earth end up deleting the filter manager service what does that",
    "start": "2609040",
    "end": "2614440"
  },
  {
    "text": "mean if you reboot the system now since a very critical service you",
    "start": "2614440",
    "end": "2619960"
  },
  {
    "text": "will end up having a blue screen and that's going to be a permanent blue screen every single time you reboot the system you'll end up in this",
    "start": "2619960",
    "end": "2628160"
  },
  {
    "text": "situation ER another demo which is in this case is exploiting Chrome to",
    "start": "2629359",
    "end": "2635920"
  },
  {
    "text": "disable the windows firewall so it is similar to the first demo I showed on the",
    "start": "2635920",
    "end": "2642440"
  },
  {
    "text": "antivirus where I'm creating a link but this time I'm pointing the link to the",
    "start": "2642440",
    "end": "2647960"
  },
  {
    "text": "BFE service which is the base filtering engine service so all the all firewalls",
    "start": "2647960",
    "end": "2653960"
  },
  {
    "text": "that are implemented on Windows they rely on this service from Microsoft which is a filtering",
    "start": "2653960",
    "end": "2662119"
  },
  {
    "text": "framework that enables firewalls to to to create tools and so on",
    "start": "2662119",
    "end": "2669040"
  },
  {
    "text": "so I'm just creating",
    "start": "2672160",
    "end": "2675359"
  },
  {
    "text": "the I think I may have skipped one part or oh here at the beginning you see that",
    "start": "2679079",
    "end": "2686319"
  },
  {
    "text": "the firewall is on so I'm creating the the service this",
    "start": "2686319",
    "end": "2693520"
  },
  {
    "text": "is just process monitor just to view the events and installing",
    "start": "2693520",
    "end": "2699960"
  },
  {
    "text": "Chrome we'll see all of the sudden Google update.exe is touching or performing actions on BF",
    "start": "2704079",
    "end": "2711599"
  },
  {
    "text": "service and this that's not something it should do and if we filter by reg delete key we'll see that it's even deleting",
    "start": "2711599",
    "end": "2718160"
  },
  {
    "text": "the BF service which should never never be",
    "start": "2718160",
    "end": "2725440"
  },
  {
    "text": "happening if we refesh now the BF service should be gone and then if we",
    "start": "2725440",
    "end": "2731800"
  },
  {
    "text": "reboot the system you need to reboot the system because Windows would look at this",
    "start": "2731800",
    "end": "2739200"
  },
  {
    "text": "regist registry Tre every single time it Boots the system and see if if it's there it will run it now we see here",
    "start": "2739200",
    "end": "2745640"
  },
  {
    "text": "that the firewall is is having some error message there and if we run the Windows security console which is like",
    "start": "2745640",
    "end": "2753920"
  },
  {
    "text": "the modern control we see we are struggling a little bit to",
    "start": "2753920",
    "end": "2759920"
  },
  {
    "text": "get information about the firewall but soon",
    "start": "2759920",
    "end": "2764119"
  },
  {
    "text": "enough yeah there you have it so there's an error message and here if",
    "start": "2766359",
    "end": "2771880"
  },
  {
    "text": "you remember the firewall is on is no longer on anymore and if you try to restore the settings even as an admin",
    "start": "2771880",
    "end": "2779520"
  },
  {
    "text": "you will never be able to recover from that because Windows does not have information about how to recover from",
    "start": "2779520",
    "end": "2786160"
  },
  {
    "text": "something like this and that way basically you I disabled Windows Firewall from through an an installing",
    "start": "2786160",
    "end": "2794480"
  },
  {
    "text": "installation of chrome okay that's the demos I have for",
    "start": "2794480",
    "end": "2804160"
  },
  {
    "text": "today now some practical tips if you are a software vendors and you are writing",
    "start": "2804160",
    "end": "2810359"
  },
  {
    "text": "application is that first you should review your code to ensure it does not allow or deleting it does not allow",
    "start": "2810359",
    "end": "2817200"
  },
  {
    "text": "deleting or writing to privileged privileged registry key via registry Sim",
    "start": "2817200",
    "end": "2822240"
  },
  {
    "text": "link manipulation and second thing is that you always should use user impersonation",
    "start": "2822240",
    "end": "2829559"
  },
  {
    "text": "when accessing unprotected register keys or object inine General from privilege process so if you are running as a",
    "start": "2829559",
    "end": "2835800"
  },
  {
    "text": "system service it's it's it's important to impersonate the current lo and user",
    "start": "2835800",
    "end": "2841400"
  },
  {
    "text": "basically lower your privileges and Performing the action the action as if the user have performed that on",
    "start": "2841400",
    "end": "2848599"
  },
  {
    "text": "unprotected objects you should always set the correct Access Control list on your",
    "start": "2848599",
    "end": "2854240"
  },
  {
    "text": "created register keys and you should not never do something like what Google has done",
    "start": "2854240",
    "end": "2859720"
  },
  {
    "text": "override the access control list to enable right access to non non-admin",
    "start": "2859720",
    "end": "2868000"
  },
  {
    "text": "users and finally uh some key takeaway is so registry links can POS security",
    "start": "2868000",
    "end": "2875880"
  },
  {
    "text": "risk if not handled properly and you should have be careful around how you are deleting registry links and how you",
    "start": "2875880",
    "end": "2882480"
  },
  {
    "text": "are dealing with those but the main key takeaway is the one in blue here is that",
    "start": "2882480",
    "end": "2889160"
  },
  {
    "text": "if you writing an API documentation then it",
    "start": "2889160",
    "end": "2894640"
  },
  {
    "text": "you should probably include potential security risk if you are aware of those obviously to promote secure coding",
    "start": "2894640",
    "end": "2901119"
  },
  {
    "text": "practices and reduce the likelihood of security incidents because software Developers relying on your API not are",
    "start": "2901119",
    "end": "2909040"
  },
  {
    "text": "always you know familiar with all the intricate details of your API behavior and what could happen if I do this or I",
    "start": "2909040",
    "end": "2916200"
  },
  {
    "text": "forgot to do that so if you can help them to guide them through how to use",
    "start": "2916200",
    "end": "2921960"
  },
  {
    "text": "how to to properly use your API and and what to be careful about that can",
    "start": "2921960",
    "end": "2927000"
  },
  {
    "text": "absolutely increase or promote secure coding",
    "start": "2927000",
    "end": "2931799"
  },
  {
    "text": "practices yes that's was that was all yeah thank you",
    "start": "2932319",
    "end": "2938720"
  },
  {
    "text": "oh",
    "start": "2940559",
    "end": "2943559"
  }
]