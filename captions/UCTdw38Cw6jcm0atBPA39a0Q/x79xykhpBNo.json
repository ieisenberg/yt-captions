[
  {
    "text": "cool I'm getting the thumbs up I think we're good to go we're good Tien yep cracking awesome",
    "start": "6379",
    "end": "13200"
  },
  {
    "text": "so hi everybody uh thanks for coming to my talk this morning because there's",
    "start": "13200",
    "end": "18420"
  },
  {
    "text": "some really good talks on in those other rooms so there was a moment where I wondered if anyone was going to walk through that door so I'm feeling quite",
    "start": "18420",
    "end": "25019"
  },
  {
    "text": "pumped now which is really good and it's so good to be back to an in-person conference as well so I that's also",
    "start": "25019",
    "end": "32099"
  },
  {
    "text": "fabulous um so today we're going to be talking about Azure active directory uh jwt's",
    "start": "32099",
    "end": "40020"
  },
  {
    "text": "oidc pkce claim Scopes all these fabulous uh",
    "start": "40020",
    "end": "46200"
  },
  {
    "text": "identity Concepts uh so I'll give you a little bit of information about myself before we get cracking uh my name's",
    "start": "46200",
    "end": "53219"
  },
  {
    "text": "Graham and I work as a Cloud solution architect at Microsoft",
    "start": "53219",
    "end": "59219"
  },
  {
    "text": "um I've been there for about two years now but to be honest with you taken an architect title was a little bit kind of",
    "start": "59219",
    "end": "65460"
  },
  {
    "text": "like weird I've been a developer engineer for 25 years before that and",
    "start": "65460",
    "end": "70560"
  },
  {
    "text": "managed to resist being an architect but it we are that's okay I still managed to keep relatively uh Hands-On which is",
    "start": "70560",
    "end": "77939"
  },
  {
    "text": "good now in those 25 years I've seen a lot of",
    "start": "77939",
    "end": "83520"
  },
  {
    "text": "different ways of dealing with identity authentication and authorization you",
    "start": "83520",
    "end": "89340"
  },
  {
    "text": "know if you think back many many years ago well you we all used to roll our own username password databases right pretty",
    "start": "89340",
    "end": "96180"
  },
  {
    "text": "insecure stuff but we had the every application had its own username password database not a good place to be",
    "start": "96180",
    "end": "102780"
  },
  {
    "text": "in then we had active directory a lot of people might still have to use that",
    "start": "102780",
    "end": "107820"
  },
  {
    "text": "today uh it's still everywhere really but um you know we fast forward we go through ldap I don't know anyone in here",
    "start": "107820",
    "end": "115020"
  },
  {
    "text": "has tried to roll their own secure token server uh that's a barrel of fun and uh",
    "start": "115020",
    "end": "120600"
  },
  {
    "text": "really really unpleasant experience if you've ever tried that and about 15",
    "start": "120600",
    "end": "125820"
  },
  {
    "text": "maybe 10 15 years ago there was a real change in the industry where this thing",
    "start": "125820",
    "end": "131640"
  },
  {
    "text": "called oauth 2 suddenly came along and anyone who's been in the Ws star WS",
    "start": "131640",
    "end": "137400"
  },
  {
    "text": "Federation world will know that that was a cruelly horrible place to be in like really really disgusting really",
    "start": "137400",
    "end": "144060"
  },
  {
    "text": "complicated just Enterprise to the extreme and all of two came along with",
    "start": "144060",
    "end": "149340"
  },
  {
    "text": "the idea of really simplifying a common story which was I've got something like",
    "start": "149340",
    "end": "154500"
  },
  {
    "text": "Facebook I've got a third-party client I've got users who have data on Facebook",
    "start": "154500",
    "end": "159980"
  },
  {
    "text": "how did they access that now luckily most applications today",
    "start": "159980",
    "end": "165900"
  },
  {
    "text": "start with of2 or IDC it's it's super simple to get going on it right and what",
    "start": "165900",
    "end": "172500"
  },
  {
    "text": "I don't want to do today is take you through that kind of let's get started let's set an application up uh in my job",
    "start": "172500",
    "end": "178500"
  },
  {
    "text": "at Microsoft it's not uncommon for me to get calls from customers who have got problems with their oidc flows and what",
    "start": "178500",
    "end": "187019"
  },
  {
    "text": "always strikes me is that whenever we set this up there's about three different things that are involved in it",
    "start": "187019",
    "end": "193560"
  },
  {
    "text": "we've got Azure active directory it could be any identity server to be honest it could be off zero it could be",
    "start": "193560",
    "end": "199500"
  },
  {
    "text": "your own custom rolled duende whatever it doesn't really matter but there's",
    "start": "199500",
    "end": "204659"
  },
  {
    "text": "this thing it's managed by a team we've got our client applications and then we have our users and we always",
    "start": "204659",
    "end": "211800"
  },
  {
    "text": "have teams that focus on those individual boxes but where it gets complicated is that everything has to be",
    "start": "211800",
    "end": "218519"
  },
  {
    "text": "just right between those three boxes for everything to work and when it's not people often don't know where to look or",
    "start": "218519",
    "end": "226500"
  },
  {
    "text": "how to go about diagnosing these issues so that's really the main focus for my",
    "start": "226500",
    "end": "232140"
  },
  {
    "text": "talk today so I want to cover the tools and techniques and show you some of the",
    "start": "232140",
    "end": "237480"
  },
  {
    "text": "common classes of errors that I see all the time in the wild when people are trying to set these photos up",
    "start": "237480",
    "end": "244200"
  },
  {
    "text": "we're going to talk about a flow called pkce so if you're building web",
    "start": "244200",
    "end": "249720"
  },
  {
    "text": "applications or native applications it's something that if you haven't heard about you really want to start thinking",
    "start": "249720",
    "end": "256799"
  },
  {
    "text": "about moving to it we're going to break down jwts have a",
    "start": "256799",
    "end": "262019"
  },
  {
    "text": "look what's inside them and we want to think about how those Concepts in those tokens relate to Identity and",
    "start": "262019",
    "end": "268500"
  },
  {
    "text": "authentication and authorization and finally we'll look at Scopes and",
    "start": "268500",
    "end": "274500"
  },
  {
    "text": "groups and roles and have a think about what they are and again how we can use",
    "start": "274500",
    "end": "280020"
  },
  {
    "text": "use those to kind of build authorization into our applications",
    "start": "280020",
    "end": "285540"
  },
  {
    "text": "now when I do a talk I kind of like to come up with a scenario to hang my talk",
    "start": "285540",
    "end": "290699"
  },
  {
    "text": "off and I gave a smaller version of this in December and it was Christmas so I",
    "start": "290699",
    "end": "296639"
  },
  {
    "text": "kind of had a bit of a theme going on with Santa Claus and uh how do we make",
    "start": "296639",
    "end": "302100"
  },
  {
    "text": "sure Christmas is a success so I'm gonna re-badge that today because it's Australia and Christmas in July is",
    "start": "302100",
    "end": "308400"
  },
  {
    "text": "obviously coming up so we're going to use a fictitious application that Santa",
    "start": "308400",
    "end": "314820"
  },
  {
    "text": "and his else built to show you the kind of errors and how to go about diagnosing",
    "start": "314820",
    "end": "319919"
  },
  {
    "text": "them and here it is now it's a really common uh type of",
    "start": "319919",
    "end": "326400"
  },
  {
    "text": "thing that I see in customers essentially Santa used to use an application called Santa web to manage",
    "start": "326400",
    "end": "333840"
  },
  {
    "text": "Christmas so that would handle problems like the traveling Center problem how",
    "start": "333840",
    "end": "339180"
  },
  {
    "text": "does you get around all those houses on Christmas Eve that's quite complicated naughty nice lists very very complicated",
    "start": "339180",
    "end": "346020"
  },
  {
    "text": "business logic that is locked up inside a legacy application Heritage",
    "start": "346020",
    "end": "351180"
  },
  {
    "text": "application let's call it in this case Santa Webb was written in ASP web forms",
    "start": "351180",
    "end": "356400"
  },
  {
    "text": "it's pretty old it had its own clunky username password and Santa was managing a lot of",
    "start": "356400",
    "end": "362580"
  },
  {
    "text": "infrastructure so he decided to move all of this into that North Pole data center",
    "start": "362580",
    "end": "368039"
  },
  {
    "text": "I think I've called it the Azure North Pole data center I don't think we have an Azure North Pole data center",
    "start": "368039",
    "end": "373979"
  },
  {
    "text": "um but it'd be kind of cool if we did and in doing that the elves turned Santa Webb into a pass put it made it run on",
    "start": "373979",
    "end": "380580"
  },
  {
    "text": "app service platform as a service whatever it doesn't matter which one it is but they also look to do a few extra",
    "start": "380580",
    "end": "386520"
  },
  {
    "text": "things you see Santa was going for a digital transformation at the time just like most customers most companies out",
    "start": "386520",
    "end": "393419"
  },
  {
    "text": "there in the wild today so they Outsource their identity they've decided to use Azure active directory to",
    "start": "393419",
    "end": "399539"
  },
  {
    "text": "do that and they've realized that the ux is clunky so they wanted to unlock the",
    "start": "399539",
    "end": "405900"
  },
  {
    "text": "possibility of new user experiences so what they've done is they've created a whole bunch of apis",
    "start": "405900",
    "end": "413220"
  },
  {
    "text": "which are decoupled from the asp.net web forms to support new modern experiences that",
    "start": "413220",
    "end": "419940"
  },
  {
    "text": "we want to build on top of that now just so happens there's another cracked team of elves who fancy themselves as a user",
    "start": "419940",
    "end": "425940"
  },
  {
    "text": "experience deliverers and they're very competent in react in this case so they",
    "start": "425940",
    "end": "431340"
  },
  {
    "text": "want to build Santa light which is a single page application and it's gonna consume those apis from Santa web to",
    "start": "431340",
    "end": "439440"
  },
  {
    "text": "make Christmas a beautiful experience so the idea is they're going to use oidc",
    "start": "439440",
    "end": "445080"
  },
  {
    "text": "authentication flow to sign users into that application and then they're going to use oauth2 and",
    "start": "445080",
    "end": "451860"
  },
  {
    "text": "get access tokens to call Santa web apis on behalf of else",
    "start": "451860",
    "end": "457620"
  },
  {
    "text": "and Center so uh one of the key things in there is a word called token as we'll see through",
    "start": "457620",
    "end": "464160"
  },
  {
    "text": "this talk tokens are really the core currency of identity authentication and",
    "start": "464160",
    "end": "470819"
  },
  {
    "text": "authorization when we're dealing with a wolf and oidc so that's the example I'm going to use",
    "start": "470819",
    "end": "479039"
  },
  {
    "text": "and what we're going to do is we're going to have a mix of kind of coding and a bit of kind of talking and showing",
    "start": "479039",
    "end": "485639"
  },
  {
    "text": "you those tools and techniques to help find out what's going wrong because I've heard on the ground that they have some",
    "start": "485639",
    "end": "492060"
  },
  {
    "text": "issues so we probably should jump into the code and see if we can find out what's going",
    "start": "492060",
    "end": "497940"
  },
  {
    "text": "wrong to help the elves okay so let's start in the s",
    "start": "497940",
    "end": "506639"
  },
  {
    "text": "code as it's gonna work well look at this the demo got straight away there we",
    "start": "506639",
    "end": "512459"
  },
  {
    "text": "go awesome cool now uh the else decided to use react to write that application",
    "start": "512459",
    "end": "518339"
  },
  {
    "text": "and when they started they were faced with their first choice they had to make so whenever you're dealing with oauth2",
    "start": "518339",
    "end": "525300"
  },
  {
    "text": "you don't want to roll your own library to handle tokens and deal with all the validations and checks and balances",
    "start": "525300",
    "end": "531540"
  },
  {
    "text": "because it looks deceptively simple on paper but there's a whole bunch of security things that are built into",
    "start": "531540",
    "end": "537300"
  },
  {
    "text": "those tokens so you're best off going for a third-party library to help you deal with that now in the Microsoft",
    "start": "537300",
    "end": "544500"
  },
  {
    "text": "space we have two we have one called adul and we have one called M cell",
    "start": "544500",
    "end": "549540"
  },
  {
    "text": "and it just so happens that the else made the right choice in that in this scenario they decided to go with M cell",
    "start": "549540",
    "end": "557459"
  },
  {
    "text": "we can see that inside their package.json they've chosen a dependency",
    "start": "557459",
    "end": "562680"
  },
  {
    "text": "called uh whoopsie M cell browser and MSL react in this case now that's great because msel",
    "start": "562680",
    "end": "570240"
  },
  {
    "text": "supports more modern secure flows which are not supported by",
    "start": "570240",
    "end": "575459"
  },
  {
    "text": "Adel so be very be very confident when you make this choice that M cell is the",
    "start": "575459",
    "end": "581339"
  },
  {
    "text": "right way to go uh the reason I brought this up is because I was doing a search on npm the other day which is the node",
    "start": "581339",
    "end": "588720"
  },
  {
    "text": "package manager and it was quite interesting to see",
    "start": "588720",
    "end": "594600"
  },
  {
    "text": "well I'll see if I can make my mouse work that when you go to uh a dial node on",
    "start": "594600",
    "end": "602220"
  },
  {
    "text": "npm in the last week there were four hundred and eleven thousand downloads of that",
    "start": "602220",
    "end": "608279"
  },
  {
    "text": "package that has essentially been deprecated for about the last nine months it's on life support so that's a",
    "start": "608279",
    "end": "614640"
  },
  {
    "text": "lot of potential applications out there that are using inherently insecure flows and that's not really a place where you",
    "start": "614640",
    "end": "621720"
  },
  {
    "text": "want to be that's okay the else chose right they've gone with uh encel",
    "start": "621720",
    "end": "628500"
  },
  {
    "text": "so when they started they had to set a couple of little parameters inside",
    "start": "628500",
    "end": "634920"
  },
  {
    "text": "their code to wire this all up and to get it going uh it's pretty straightforward this is kind of a bare",
    "start": "634920",
    "end": "640740"
  },
  {
    "text": "bones setup for an M cell application there's two bits of information we need",
    "start": "640740",
    "end": "646079"
  },
  {
    "text": "both really common um uh definitions inside oidc we've got",
    "start": "646079",
    "end": "652079"
  },
  {
    "text": "the authority and the client ID now the authority tells our ensa library",
    "start": "652079",
    "end": "658260"
  },
  {
    "text": "where it needs to go to deal with authentication and authorization scenarios now in this case it's Azure",
    "start": "658260",
    "end": "665220"
  },
  {
    "text": "active directory so everything goes to a host name called login.microsoft.online.com now if you're",
    "start": "665220",
    "end": "672180"
  },
  {
    "text": "off xero you roll your own identity server that's going to be a little bit different in fact on those types of uh",
    "start": "672180",
    "end": "679019"
  },
  {
    "text": "service you tend to have your own dedicated hostname we don't have that in aad we have a common host log in",
    "start": "679019",
    "end": "685399"
  },
  {
    "text": "microsoftonline.com and then there's a grid after it so that's your tenant ID",
    "start": "685399",
    "end": "690420"
  },
  {
    "text": "now aad is a massively multi-tenanted uh identity platform so there are lots of",
    "start": "690420",
    "end": "696240"
  },
  {
    "text": "other customers that also are inside there so that's just how we can make sure that it's you that we're working",
    "start": "696240",
    "end": "702839"
  },
  {
    "text": "with when we are doing uh authentication scenarios as opposed to other customers",
    "start": "702839",
    "end": "708420"
  },
  {
    "text": "now the second bit of information is called the client ID so this is a really again common comp Concept in oidc flows",
    "start": "708420",
    "end": "716220"
  },
  {
    "text": "in that every application that wants to either get tokens or look at tokens",
    "start": "716220",
    "end": "721620"
  },
  {
    "text": "inside of 2 is referred to as a client so again you'll have a client for every",
    "start": "721620",
    "end": "727320"
  },
  {
    "text": "single application be it a backend server or a single page application that you build and these all have to be",
    "start": "727320",
    "end": "733980"
  },
  {
    "text": "registered inside Azure active directory it's the first bit of configuration that we need to line up so if you just",
    "start": "733980",
    "end": "740399"
  },
  {
    "text": "remember a47 and ve3 we're going to quickly jump into the",
    "start": "740399",
    "end": "746519"
  },
  {
    "text": "portal and have a look at those inside aad so this is Graham weld my own aad tenant",
    "start": "746519",
    "end": "755160"
  },
  {
    "text": "and you can spin one of these up really easily uh in fact if you're in an Enterprise it's quite often useful to",
    "start": "755160",
    "end": "761279"
  },
  {
    "text": "spin up your own tenant because you can then do a lot more like I'm quite",
    "start": "761279",
    "end": "766560"
  },
  {
    "text": "restricted there's a lot of things inside AED I can't do inside my company tenant but I can in my own for a",
    "start": "766560",
    "end": "772500"
  },
  {
    "text": "learning experience it's a really really good idea but here's my tenant ID a47",
    "start": "772500",
    "end": "778279"
  },
  {
    "text": "and then we have these things called app registrations now aad doesn't just do oidc it does WS",
    "start": "778279",
    "end": "788279"
  },
  {
    "text": "Federation it does saml it does a lot of different authentication mechanisms but",
    "start": "788279",
    "end": "793740"
  },
  {
    "text": "the predates are worth two so it's the first point of confusion we don't call them clients in ad we call them app",
    "start": "793740",
    "end": "801240"
  },
  {
    "text": "registrations but Santa Lite is the be3 one down here",
    "start": "801240",
    "end": "807260"
  },
  {
    "text": "and as long as those two bits of information your tenant ID and your client ID map up and you can see we even",
    "start": "807260",
    "end": "814320"
  },
  {
    "text": "call out it's your application but yeah all right it's really a client idea as far as oidc is concerned then we're now",
    "start": "814320",
    "end": "823139"
  },
  {
    "text": "in a situation where we can start to authenticate users so let's jump into our amazing I told",
    "start": "823139",
    "end": "830760"
  },
  {
    "text": "you they were a good team of designers that we had were the elves uh this is satellite and we're going to start a sign in flow",
    "start": "830760",
    "end": "837720"
  },
  {
    "text": "and see what happens so we click on the button and the internet's working so that's a good",
    "start": "837720",
    "end": "844019"
  },
  {
    "text": "start we instantly get taken to log in Microsoft online with a47 which is our",
    "start": "844019",
    "end": "849240"
  },
  {
    "text": "tenant ID and there's a bunch of query stream parameters that we'll look at in a minute but the point is satellite has",
    "start": "849240",
    "end": "855600"
  },
  {
    "text": "now taken as a way to aad to start the sign-in process so I'm going to go and",
    "start": "855600",
    "end": "861660"
  },
  {
    "text": "grab centers credentials",
    "start": "861660",
    "end": "865100"
  },
  {
    "text": "and we get prompted a few usernames and passwords so again",
    "start": "866820",
    "end": "871820"
  },
  {
    "text": "uh so this is azure active director that's providing this UI so uh and you",
    "start": "876180",
    "end": "881339"
  },
  {
    "text": "can't customize this one but if you're using b2c which is the consumer identity",
    "start": "881339",
    "end": "886500"
  },
  {
    "text": "then you can customize uh that a lot more so um yeah there's there's gets a little",
    "start": "886500",
    "end": "892680"
  },
  {
    "text": "bit confusing we can talk more about that offline if you want as well b2c and aad",
    "start": "892680",
    "end": "898139"
  },
  {
    "text": "so we click the sign in now the first thing that happens is aad has been asked by Santa light to ask the",
    "start": "898139",
    "end": "906959"
  },
  {
    "text": "user to consent to provide it some information so this is the Crux of oauth",
    "start": "906959",
    "end": "912060"
  },
  {
    "text": "2. basically I'm a user I want to use a third party that wants to do something",
    "start": "912060",
    "end": "917699"
  },
  {
    "text": "with my identity so it asks Azure active directory to ask me on its behalf to do",
    "start": "917699",
    "end": "923579"
  },
  {
    "text": "that in this scenario I am being asked that santalight wants to",
    "start": "923579",
    "end": "930899"
  },
  {
    "text": "sign in and read my profile so let's click that set on that",
    "start": "930899",
    "end": "936300"
  },
  {
    "text": "and oh straight away now this is a really really simple problem to solve",
    "start": "936300",
    "end": "942360"
  },
  {
    "text": "but I do see it all the time so being told that the redirect URI",
    "start": "942360",
    "end": "947699"
  },
  {
    "text": "satellite local test for me does not match what's inside Azure active directory",
    "start": "947699",
    "end": "952920"
  },
  {
    "text": "now if we go back to the start of oauth 2. let's think about what's going on here",
    "start": "952920",
    "end": "958019"
  },
  {
    "text": "I'm an application I'm being directed to Azure active directory to do something",
    "start": "958019",
    "end": "963180"
  },
  {
    "text": "to sign in when that's done aad needs to take me back to my application and send",
    "start": "963180",
    "end": "970260"
  },
  {
    "text": "back some information which is one of these tokens that we spoke about in the olden days oauth 2 said nothing",
    "start": "970260",
    "end": "978060"
  },
  {
    "text": "about where that core bike had to be so a lot of off-service supported what we",
    "start": "978060",
    "end": "983519"
  },
  {
    "text": "call Wild Card redirects or open redirects but that's a really bad security hole imagine if the Grinch span",
    "start": "983519",
    "end": "991620"
  },
  {
    "text": "up his own Santa light copy looked like Santa light and he could get an elf to",
    "start": "991620",
    "end": "997680"
  },
  {
    "text": "go and sign in in Azure active directory which would then blindly redirect to",
    "start": "997680",
    "end": "1003519"
  },
  {
    "text": "grinch.localtest.me and pass an identity token or an access token right you can start to see how Christmas could get",
    "start": "1003519",
    "end": "1010279"
  },
  {
    "text": "spoiled because now that tokens in the hand of the Grinch so",
    "start": "1010279",
    "end": "1015800"
  },
  {
    "text": "for Azure active directory to complete a sign-in we need to not only tell it at",
    "start": "1015800",
    "end": "1021079"
  },
  {
    "text": "the point of doing the sign in where to redirect to but it has to understand where those redirects are up front and",
    "start": "1021079",
    "end": "1028459"
  },
  {
    "text": "if it doesn't know the redirect it won't do it for you so that closes the security hole it's it's one of the areas",
    "start": "1028459",
    "end": "1035839"
  },
  {
    "text": "where open ID connect actually really kind of not just fixes but makes a lot",
    "start": "1035839",
    "end": "1042140"
  },
  {
    "text": "of the original oauth 2 it locks it down it makes it much more uh safe to use",
    "start": "1042140",
    "end": "1049040"
  },
  {
    "text": "so in this scenario we're going to go back into the portal in Azure active directory",
    "start": "1049040",
    "end": "1055520"
  },
  {
    "text": "and we're going to go to should have got a piece of paper for my mouse mat we configure redirect Uris",
    "start": "1055520",
    "end": "1062960"
  },
  {
    "text": "against the application and in this case we can see we've got one single page application",
    "start": "1062960",
    "end": "1069020"
  },
  {
    "text": "and straight away you can see that this is not the one that was requested by that app it's actually got sign in oidc",
    "start": "1069020",
    "end": "1075140"
  },
  {
    "text": "so I'm guessing that else we're originally using like an asp.net server-side application potentially",
    "start": "1075140",
    "end": "1081500"
  },
  {
    "text": "that's a common URL we see in them so this one's pretty straightforward we're",
    "start": "1081500",
    "end": "1086780"
  },
  {
    "text": "going to remove the suffix that we don't want and we're going to save that",
    "start": "1086780",
    "end": "1093080"
  },
  {
    "text": "and we're going to go back to our application",
    "start": "1093080",
    "end": "1097899"
  },
  {
    "text": "Center light and we're going to do the sign in again",
    "start": "1100100",
    "end": "1105640"
  },
  {
    "text": "and Santa",
    "start": "1108320",
    "end": "1111639"
  },
  {
    "text": "lessons on my next talk make sure to have a mouse mat by the computer",
    "start": "1113900",
    "end": "1120380"
  },
  {
    "text": "my Optical Mouse doesn't like this and boom we're in my application knows that it's Santa so",
    "start": "1120380",
    "end": "1127160"
  },
  {
    "text": "what just happened okay well uh there's a few ways we can have a look at the different URLs and",
    "start": "1127160",
    "end": "1133760"
  },
  {
    "text": "the different payloads that were invoked to make this work I'm going to use a tool called Fiddler okay but first of",
    "start": "1133760",
    "end": "1141320"
  },
  {
    "text": "all let's have a quick look on a PowerPoint slide of what's going on here so",
    "start": "1141320",
    "end": "1147679"
  },
  {
    "text": "we start off with our single page application we click the login button the first thing that happens is we get a",
    "start": "1147679",
    "end": "1154100"
  },
  {
    "text": "302 redirect this takes us to aad with three main bits of information we've got what the",
    "start": "1154100",
    "end": "1161179"
  },
  {
    "text": "application wants aad to do which is in this case the sign in our users we've got the where to send me back to that's",
    "start": "1161179",
    "end": "1167299"
  },
  {
    "text": "the redirect URI and then we've got a whole bunch of information around security concerns like State and nonses",
    "start": "1167299",
    "end": "1174860"
  },
  {
    "text": "and things like that that just help with the checks and balances to make sure that things are okay now one of two things is going to happen",
    "start": "1174860",
    "end": "1181760"
  },
  {
    "text": "for a native application depending on the flow that you're using if you're in Adel world or you're using",
    "start": "1181760",
    "end": "1189140"
  },
  {
    "text": "a flow called the implicit flow Azure active directory is going to send",
    "start": "1189140",
    "end": "1194360"
  },
  {
    "text": "you back to Santa light with a token now that's how can normally is stored in",
    "start": "1194360",
    "end": "1200179"
  },
  {
    "text": "something like a hash fragment I was not recommended anymore it's got",
    "start": "1200179",
    "end": "1206600"
  },
  {
    "text": "real security concerns around it with that token inside that fragment so to give you a few examples of that",
    "start": "1206600",
    "end": "1213200"
  },
  {
    "text": "let's say you're in an Enterprise that has got some uh SSL traffic sniffing",
    "start": "1213200",
    "end": "1219140"
  },
  {
    "text": "firewall or something like that it might intercept this and log the URLs to disk",
    "start": "1219140",
    "end": "1225860"
  },
  {
    "text": "so that could be a potential source of an ID token being leaked in there because it's in the URL",
    "start": "1225860",
    "end": "1231860"
  },
  {
    "text": "or if you're a native application I don't know who's done native apps here but you can configure application",
    "start": "1231860",
    "end": "1238520"
  },
  {
    "text": "specific protocols on your apps such that if you invoke a URL on your device",
    "start": "1238520",
    "end": "1243860"
  },
  {
    "text": "that will launch your application now the problem with those is that unless you're Google or Facebook you",
    "start": "1243860",
    "end": "1250280"
  },
  {
    "text": "don't get dibs on that application URI like you can specify it but someone else can have the same one so whichever app",
    "start": "1250280",
    "end": "1257360"
  },
  {
    "text": "is loaded by the device first is the one that's going to respond to that protocol so if my redirect is my app colon slash",
    "start": "1257360",
    "end": "1264820"
  },
  {
    "text": "and the Grinch releases an app called my colon slash he could get the tokens that",
    "start": "1264820",
    "end": "1270260"
  },
  {
    "text": "way because they made us get posted to his app by the device so the problem with the implicit flow is",
    "start": "1270260",
    "end": "1275900"
  },
  {
    "text": "that token in the fragment is just very very insecure it's very easy to uh leak",
    "start": "1275900",
    "end": "1281000"
  },
  {
    "text": "that out another source is uh applicate third-party JavaScript libraries that",
    "start": "1281000",
    "end": "1286100"
  },
  {
    "text": "are running in with your application they can look at the window object for example and a lot of these off libraries",
    "start": "1286100",
    "end": "1291860"
  },
  {
    "text": "leave those tokens on the window object so they can be picked up from there as well so a lot of places that can leak so",
    "start": "1291860",
    "end": "1297860"
  },
  {
    "text": "this is not the recommended flow anymore instead what's come along is a flow",
    "start": "1297860",
    "end": "1303140"
  },
  {
    "text": "called proof key for code exchange or pixie as it's shortened to so pixie does",
    "start": "1303140",
    "end": "1309260"
  },
  {
    "text": "something a little bit different it doesn't send you back an ID token inside that fragment",
    "start": "1309260",
    "end": "1315799"
  },
  {
    "text": "sends you back a code right and the idea is that that code is utterly useless to anybody but the",
    "start": "1315799",
    "end": "1324380"
  },
  {
    "text": "application that requested the sign in in the first place now if you've done any award for oidc",
    "start": "1324380",
    "end": "1330980"
  },
  {
    "text": "you might have seen this before with the server-side application where the same",
    "start": "1330980",
    "end": "1336260"
  },
  {
    "text": "thing happens the auth server sends you back a code but in that scenario your application uses a shared secret to",
    "start": "1336260",
    "end": "1343700"
  },
  {
    "text": "switch that code out for a token with the authorization server now the problem of a native app of course is that a",
    "start": "1343700",
    "end": "1350240"
  },
  {
    "text": "native app can't keep a secret so there's no point bundling up one with your APK or your IPA package or putting",
    "start": "1350240",
    "end": "1357679"
  },
  {
    "text": "it in your JavaScript because someone's going to grab that secret it's not a secret so pkc is a little bit different in that",
    "start": "1357679",
    "end": "1365000"
  },
  {
    "text": "a secret is created on the fly at the point of kicking off that authentication request",
    "start": "1365000",
    "end": "1370700"
  },
  {
    "text": "and what the pkce flow is is that we send the Char of that one-time secret",
    "start": "1370700",
    "end": "1375740"
  },
  {
    "text": "back to aad so aad Associates that sha with the",
    "start": "1375740",
    "end": "1381620"
  },
  {
    "text": "token that is associated with that code and it sends the code back out now in order to exchange that code for a",
    "start": "1381620",
    "end": "1389000"
  },
  {
    "text": "token you need the plain text that created that Char in the first place",
    "start": "1389000",
    "end": "1394280"
  },
  {
    "text": "and if you can present that and the code then we will give you back the token",
    "start": "1394280",
    "end": "1399980"
  },
  {
    "text": "okay so it's a way to bind the request for the token with the receipt of the token later and it means that we're not",
    "start": "1399980",
    "end": "1407000"
  },
  {
    "text": "sending that token in hash fragments everywhere which is a much better security story",
    "start": "1407000",
    "end": "1412940"
  },
  {
    "text": "so what I want to do is use a tool called Fiddler which is a networked kind of proxy",
    "start": "1412940",
    "end": "1421580"
  },
  {
    "text": "debugging tool and we're going to go and have a look at those flows so when I did",
    "start": "1421580",
    "end": "1427100"
  },
  {
    "text": "my authentication then I was capturing traffic Network traffic in the background so we can see all the HTTP",
    "start": "1427100",
    "end": "1433700"
  },
  {
    "text": "requests that were going backwards and forwards now the initial request for a token",
    "start": "1433700",
    "end": "1438860"
  },
  {
    "text": "starts off at the authorization end point on Azure active directory so I'm",
    "start": "1438860",
    "end": "1444140"
  },
  {
    "text": "going to quickly find those uh calls to authorization I'm going to take this one",
    "start": "1444140",
    "end": "1449600"
  },
  {
    "text": "down here and we can click on that and we can go and have a look at the",
    "start": "1449600",
    "end": "1455539"
  },
  {
    "text": "parameters that we sent to Azure active directory we've told it who we are that's the",
    "start": "1455539",
    "end": "1461360"
  },
  {
    "text": "client ID at the top that we saw earlier uh we have this property called scope",
    "start": "1461360",
    "end": "1467179"
  },
  {
    "text": "scope is a really really uh fundamental Concept in oauth 2. the idea of a scope",
    "start": "1467179",
    "end": "1473600"
  },
  {
    "text": "is it's something you can put in front of an end user that you can ask them to consent to think of it like satellite",
    "start": "1473600",
    "end": "1481460"
  },
  {
    "text": "has already got permissions to view profile details if only those users",
    "start": "1481460",
    "end": "1486799"
  },
  {
    "text": "would actually let it do that on their behalf so the scope is a way of asking for the user to consent for the",
    "start": "1486799",
    "end": "1493640"
  },
  {
    "text": "application to do something in this scenario the important ones are open ID",
    "start": "1493640",
    "end": "1499159"
  },
  {
    "text": "that says it's an openid connect flow it's authentication not authorization and then profile so we basically want to",
    "start": "1499159",
    "end": "1507260"
  },
  {
    "text": "see the user's profile we have the redirect URI it's a satellite we just spoke about that one",
    "start": "1507260",
    "end": "1512840"
  },
  {
    "text": "uh response type is really important we don't want a token back we want a code back",
    "start": "1512840",
    "end": "1518120"
  },
  {
    "text": "and the pkce is the code Challenge and the code challenge method at the bottom",
    "start": "1518120",
    "end": "1523520"
  },
  {
    "text": "so code challenge method is s256 this is a sha256 of something and then the code",
    "start": "1523520",
    "end": "1529940"
  },
  {
    "text": "challenge is that shot so aad uses that and when it dishes out the code",
    "start": "1529940",
    "end": "1537380"
  },
  {
    "text": "which we can see are in should be the last aad one down here",
    "start": "1537380",
    "end": "1544840"
  },
  {
    "text": "and let's see if we can have a look at this one now it's always fun trying to find the uh",
    "start": "1545179",
    "end": "1552580"
  },
  {
    "text": "the requests that generate what it is you're looking for that's the one that gives the token back okay for the",
    "start": "1552919",
    "end": "1558380"
  },
  {
    "text": "interest of time there's another flow in here somewhere where we can see aad presenting the code back to the application",
    "start": "1558380",
    "end": "1563960"
  },
  {
    "text": "and to finish it off center light goes back to Azure active directory and says",
    "start": "1563960",
    "end": "1569179"
  },
  {
    "text": "Hey look here is the code",
    "start": "1569179",
    "end": "1574279"
  },
  {
    "text": "and oh that didn't work that's evenly there we go cool",
    "start": "1574279",
    "end": "1580220"
  },
  {
    "text": "here is the code and here's the code verifier so the code verifier was the plain text that created",
    "start": "1580220",
    "end": "1587120"
  },
  {
    "text": "the Shah in the first place and when we get those bits of information",
    "start": "1587120",
    "end": "1592340"
  },
  {
    "text": "aad responds by sending us back in this case a bunch of different tokens but the",
    "start": "1592340",
    "end": "1599419"
  },
  {
    "text": "important one for authentication is the ID token now that is basically base64",
    "start": "1599419",
    "end": "1605480"
  },
  {
    "text": "encoded Json so what we can do is we can grab this and we can use another tool to",
    "start": "1605480",
    "end": "1611659"
  },
  {
    "text": "have a look inside it so I'm going to use a tool called jwt.ms you can also",
    "start": "1611659",
    "end": "1618020"
  },
  {
    "text": "use jwt.io that's fine as well this one's nice for aad tokens because it",
    "start": "1618020",
    "end": "1625340"
  },
  {
    "text": "breaks down all the different claims to tell you what they actually are but in essence there's three points to a token",
    "start": "1625340",
    "end": "1632059"
  },
  {
    "text": "we'll call it the red part the blue part and the green part the red part tells us what signing Keys",
    "start": "1632059",
    "end": "1638659"
  },
  {
    "text": "as your active directory used to sign this token so that we can trust it's",
    "start": "1638659",
    "end": "1643700"
  },
  {
    "text": "from aad now there's another call which I didn't show you where we go to aad and",
    "start": "1643700",
    "end": "1648860"
  },
  {
    "text": "ask for its signing public keys so we already have those but it's now telling us which one it used to sign that",
    "start": "1648860",
    "end": "1655340"
  },
  {
    "text": "we've got the green part that's just the digital signature and then we've got the blue part which is a bunch of",
    "start": "1655340",
    "end": "1660679"
  },
  {
    "text": "information that we asked for and it's now responded with so quickly going through some of this",
    "start": "1660679",
    "end": "1667580"
  },
  {
    "text": "we start with let's go for the preferred username so this is an authentication",
    "start": "1667580",
    "end": "1672860"
  },
  {
    "text": "flow so we can see that it's Center at groundwater on microsoft.com and we have the name as well inside there there's a",
    "start": "1672860",
    "end": "1680179"
  },
  {
    "text": "bunch of time stamps issued at not before and expires as well and there is",
    "start": "1680179",
    "end": "1685820"
  },
  {
    "text": "a version which is always a source of confusion in aad we have two versions version one and version two of our",
    "start": "1685820",
    "end": "1691880"
  },
  {
    "text": "endpoints and then we have V1 and V2 tokens if you use msel you always hit",
    "start": "1691880",
    "end": "1698059"
  },
  {
    "text": "the V2 endpoint if you ask for an ID token the version of the token you get",
    "start": "1698059",
    "end": "1703580"
  },
  {
    "text": "back will always be the same as the version of the endpoint that you hit so V2 endpoint will get you a V2 ID token",
    "start": "1703580",
    "end": "1710779"
  },
  {
    "text": "that's different for Access tokens but that's the way these ones work they're",
    "start": "1710779",
    "end": "1715940"
  },
  {
    "text": "much the same to be honest with you VT tokens are a bit smaller uh than V1 tokens the other really",
    "start": "1715940",
    "end": "1722960"
  },
  {
    "text": "important bit of information in any oauth 2 token is the AUD or the audience",
    "start": "1722960",
    "end": "1729020"
  },
  {
    "text": "claim now in this scenario the audience B3 is",
    "start": "1729020",
    "end": "1735380"
  },
  {
    "text": "the same client ID as my satellite application that was registered inside aad and the golden rule of oauth tokens",
    "start": "1735380",
    "end": "1743419"
  },
  {
    "text": "is that if the audience isn't you then you shouldn't really be using that token",
    "start": "1743419",
    "end": "1748940"
  },
  {
    "text": "because it was never meant for you and there's a really good example of that in tokens that are issued uh to",
    "start": "1748940",
    "end": "1755900"
  },
  {
    "text": "call our Microsoft graph apis so I've had customers call me before and tell me that their istio JWT validation plugin",
    "start": "1755900",
    "end": "1764179"
  },
  {
    "text": "was failing and they want to know why and they're trying to validate a graph API token but it's signed in a very",
    "start": "1764179",
    "end": "1771140"
  },
  {
    "text": "weird way in the I think they they create a signature and then they add something else to the Token after the",
    "start": "1771140",
    "end": "1777440"
  },
  {
    "text": "signature is created so you can't validate them basically but the point of it was that well you're not the audience",
    "start": "1777440",
    "end": "1783919"
  },
  {
    "text": "so it's kind of not yours to use or validate is that token um and that's a really really useful",
    "start": "1783919",
    "end": "1791419"
  },
  {
    "text": "thing to know especially if you get weird issues like that but look that's the identity token and",
    "start": "1791419",
    "end": "1797860"
  },
  {
    "text": "uh that's the pkce flow and how all of that hangs together",
    "start": "1797860",
    "end": "1803059"
  },
  {
    "text": "so with that we're going to move on to the next thing so we've signed in we know who the",
    "start": "1803059",
    "end": "1810799"
  },
  {
    "text": "user is so the next thing you want to start doing is calling those apis that have been exposed by Santa web so we've",
    "start": "1810799",
    "end": "1818720"
  },
  {
    "text": "got a button up here which is to add Graham to The Naughty Nice List and let's click on that one and see what",
    "start": "1818720",
    "end": "1824480"
  },
  {
    "text": "happens",
    "start": "1824480",
    "end": "1826720"
  },
  {
    "text": "okay so let's put in Santa's password",
    "start": "1830059",
    "end": "1835179"
  },
  {
    "text": "come on okay so it's another day's aad consent",
    "start": "1840559",
    "end": "1846799"
  },
  {
    "text": "windows but this one's a little bit different to the one we saw a minute ago this one is now saying that the app",
    "start": "1846799",
    "end": "1852320"
  },
  {
    "text": "would like to change the Naughty Nice List on Santa web so this is another example of a scope",
    "start": "1852320",
    "end": "1860000"
  },
  {
    "text": "what's going on here is that Santa Webb has exposed an API or a set of apis to",
    "start": "1860000",
    "end": "1865520"
  },
  {
    "text": "deal with managing the Naughty Nice List and Santa like the client wants to access that this is an example of",
    "start": "1865520",
    "end": "1872960"
  },
  {
    "text": "incremental consent by the way so it's an application where as we want to do",
    "start": "1872960",
    "end": "1878299"
  },
  {
    "text": "things we're going to start asking the user for extra bits of consent as opposed to asking for everything up",
    "start": "1878299",
    "end": "1884000"
  },
  {
    "text": "front because that can be a bit daunting as a user right if you log in to view some information and you get asked to",
    "start": "1884000",
    "end": "1889340"
  },
  {
    "text": "edit and delete and all these kind of you know higher privilege permissions so this is just going to ask at the point",
    "start": "1889340",
    "end": "1895220"
  },
  {
    "text": "in time but where's that scrub come from what what is it well we can see there's an",
    "start": "1895220",
    "end": "1901940"
  },
  {
    "text": "application which is called Santa web so let's go and find that inside aad and",
    "start": "1901940",
    "end": "1907159"
  },
  {
    "text": "have a look at that so we're going to go back up to Graham world",
    "start": "1907159",
    "end": "1913299"
  },
  {
    "text": "and this time we'll go into Santa web and we're going to go into the explosion",
    "start": "1913880",
    "end": "1920120"
  },
  {
    "text": "API section and what we should be able to see is",
    "start": "1920120",
    "end": "1925159"
  },
  {
    "text": "that if all goes well hahaha",
    "start": "1925159",
    "end": "1931240"
  },
  {
    "text": "oh it's kind of my first demo gotcha to 180 don't let me down",
    "start": "1931640",
    "end": "1938779"
  },
  {
    "text": "okay as far as an API perfect there we go we're back in",
    "start": "1938779",
    "end": "1944240"
  },
  {
    "text": "the elves have already been here and they've defined three scopes on this application we've got Naughty Nice List",
    "start": "1944240",
    "end": "1950600"
  },
  {
    "text": "Right naughty nicest read and present delivery route dot right",
    "start": "1950600",
    "end": "1955640"
  },
  {
    "text": "now Scopes are all there for the end user experience",
    "start": "1955640",
    "end": "1961580"
  },
  {
    "text": "Scopes don't necessarily mat one to one to the back end apis so there might be",
    "start": "1961580",
    "end": "1966860"
  },
  {
    "text": "15 or 20 apis involved in managing the naughty nice list but we wouldn't want to be prompting an end user for each and",
    "start": "1966860",
    "end": "1973580"
  },
  {
    "text": "every one of those because that consent experience is just going to be too much to take you know you're asked for a list",
    "start": "1973580",
    "end": "1980000"
  },
  {
    "text": "of 50 apis to consent to yeah sure whatever so Scopes allow us this to",
    "start": "1980000",
    "end": "1985700"
  },
  {
    "text": "create something that makes sense in front of a user and then that may map to multiple apis behind the scenes",
    "start": "1985700",
    "end": "1993500"
  },
  {
    "text": "but in this as far as aod is concerned it's really just a piece of text it's a",
    "start": "1993500",
    "end": "1998960"
  },
  {
    "text": "scope right there's nothing that special about it and we can have a whole bunch of these against say API if we want to",
    "start": "1998960",
    "end": "2006100"
  },
  {
    "text": "against an application sorry now do you see their prefix with API colons slash Santa web",
    "start": "2006100",
    "end": "2013179"
  },
  {
    "text": "so whenever we create an application inside Azure active directory there are",
    "start": "2013179",
    "end": "2019059"
  },
  {
    "text": "a bunch of different IDs that uniquely identify that which can be a bit weird at times we have the application or the",
    "start": "2019059",
    "end": "2025899"
  },
  {
    "text": "client ID we have an aad object ID and there's another piece of information",
    "start": "2025899",
    "end": "2031000"
  },
  {
    "text": "that we can specify that's called an application URI",
    "start": "2031000",
    "end": "2036399"
  },
  {
    "text": "whenever we ask for a scope from Azure active directory we can't just ask for",
    "start": "2036399",
    "end": "2041919"
  },
  {
    "text": "the name of the scope in this case naughty nice list.read we have to fully prefix it with the applications URI",
    "start": "2041919",
    "end": "2050020"
  },
  {
    "text": "followed by the scope name now that's a little bit different to say or zero where when you ask for a scope",
    "start": "2050020",
    "end": "2056260"
  },
  {
    "text": "there's another piece of information you send which is the resource that you want to get a token for because they're JWT",
    "start": "2056260",
    "end": "2063398"
  },
  {
    "text": "and oauth access token only applies to one audience there's only one API we can",
    "start": "2063399",
    "end": "2068679"
  },
  {
    "text": "give this token to which means that all the Scopes have to be from that API so it's a little bit strange in aad in that",
    "start": "2068679",
    "end": "2075638"
  },
  {
    "text": "you can ask for a token with Scopes from multiple apis but it will reject that request and just say no no it has to be",
    "start": "2075639",
    "end": "2082839"
  },
  {
    "text": "from the same API now in this scenario I've explicitly set",
    "start": "2082839",
    "end": "2089980"
  },
  {
    "text": "my application ID URI to be API Santa web and then if we go and look at the react",
    "start": "2089980",
    "end": "2095858"
  },
  {
    "text": "code on the Naughty Nice List button uh we can see that I'm using a m cell",
    "start": "2095859",
    "end": "2104560"
  },
  {
    "text": "method called acquire token pop-up where I'm asking for API Santa web present uh",
    "start": "2104560",
    "end": "2110140"
  },
  {
    "text": "naughty nice list.write so let's go and now I'm just going to cancel this I had",
    "start": "2110140",
    "end": "2116440"
  },
  {
    "text": "some issues with this one the other day where my actual token request expired so",
    "start": "2116440",
    "end": "2121900"
  },
  {
    "text": "let's kick it off again and see if we can get a response from aad",
    "start": "2121900",
    "end": "2128099"
  },
  {
    "text": "will upset the consent and we get a token back and that's now going to try and call the",
    "start": "2132880",
    "end": "2139900"
  },
  {
    "text": "API in the back end and we get an okay an unauthorized response so that's",
    "start": "2139900",
    "end": "2145420"
  },
  {
    "text": "interesting right something looks okay we've got a token but there's a problem",
    "start": "2145420",
    "end": "2151420"
  },
  {
    "text": "somewhere else so let's start by grabbing the token and we're going to drop it into jwt.ms",
    "start": "2151420",
    "end": "2157720"
  },
  {
    "text": "and have a look at it so it's a bit different this is a V1 token we can see down here but let's not",
    "start": "2157720",
    "end": "2164740"
  },
  {
    "text": "worry about that too much it's just a bigger token it's still an access token not much difference uh we've got this",
    "start": "2164740",
    "end": "2171339"
  },
  {
    "text": "SCP property in here now so that's the Scopes that the user has consented to so",
    "start": "2171339",
    "end": "2176560"
  },
  {
    "text": "we can see that uh Santa in this case has said yep you can call the Naughty Nice List on behalf of me icon Center",
    "start": "2176560",
    "end": "2183820"
  },
  {
    "text": "that the other one I want to call out is the audience at the top so in this scenario the audience has now",
    "start": "2183820",
    "end": "2191440"
  },
  {
    "text": "changed to API call on Santa web so in an access token the audience will",
    "start": "2191440",
    "end": "2198700"
  },
  {
    "text": "be that fully qualified application URI on the scope that you asked for that",
    "start": "2198700",
    "end": "2204940"
  },
  {
    "text": "there's a little caveat in that you can ask for another scope prefix of the client ID and it will then give you a",
    "start": "2204940",
    "end": "2211060"
  },
  {
    "text": "token with the client ID as an audience but on the whole you'll use the application ID URI so this this looks",
    "start": "2211060",
    "end": "2217599"
  },
  {
    "text": "pretty good to me I've got a token um but for some reason something has failed so I'm going to go to the back",
    "start": "2217599",
    "end": "2224560"
  },
  {
    "text": "end application now and and see what happens so this is a net core application we're using a library called",
    "start": "2224560",
    "end": "2232260"
  },
  {
    "text": "microsoft.web.identity and we've had to configure it with three bits of",
    "start": "2232260",
    "end": "2237339"
  },
  {
    "text": "information pretty similar to the MSL client uh just different names we use",
    "start": "2237339",
    "end": "2242859"
  },
  {
    "text": "the tenant ID which was the Grid at the end of The Authority we've got the",
    "start": "2242859",
    "end": "2248200"
  },
  {
    "text": "instance which just points to Azure active directory and we have the client ID which in this case is the unique ID",
    "start": "2248200",
    "end": "2254200"
  },
  {
    "text": "of Santa web and we have nothing else inside there but if we look at the log",
    "start": "2254200",
    "end": "2260440"
  },
  {
    "text": "file what we can see is that we've been told our audience",
    "start": "2260440",
    "end": "2266200"
  },
  {
    "text": "validation failed idx 10214 so I see this a lot with audience issues",
    "start": "2266200",
    "end": "2274480"
  },
  {
    "text": "in Azure active directory it's a quirk of aad especially the Microsoft",
    "start": "2274480",
    "end": "2279780"
  },
  {
    "text": "libraries in that if you don't explicitly specify an audience",
    "start": "2279780",
    "end": "2285040"
  },
  {
    "text": "we will kind of make one up based off other data that we expect those tokens to have",
    "start": "2285040",
    "end": "2290980"
  },
  {
    "text": "uh in the portal you can ask for a default application ID URI and we just",
    "start": "2290980",
    "end": "2296380"
  },
  {
    "text": "set it to API called slash and then the grid of your client and that's what aad",
    "start": "2296380",
    "end": "2302200"
  },
  {
    "text": "sorry that's what Microsoft web identity will expect on the token if you don't sell it otherwise",
    "start": "2302200",
    "end": "2308859"
  },
  {
    "text": "um there's a subtlety as well there's a weird bit of code in the backend library that says if it's a V1 token I expect",
    "start": "2308859",
    "end": "2315520"
  },
  {
    "text": "API colon client ID if it's a V2 token I expect the client ID that's one of a",
    "start": "2315520",
    "end": "2321760"
  },
  {
    "text": "source of confusion that I've seen uh surprise a lot of people doing this but",
    "start": "2321760",
    "end": "2327040"
  },
  {
    "text": "in this scenario all we have is a controller asp.net",
    "start": "2327040",
    "end": "2332859"
  },
  {
    "text": "and you can see we've got a post method to The Naughty Nice List and at the moment it's just got a required scope on",
    "start": "2332859",
    "end": "2338920"
  },
  {
    "text": "there so so uh what we want to do is inside our app settings we're going to",
    "start": "2338920",
    "end": "2344560"
  },
  {
    "text": "tell Microsoft web identity what the",
    "start": "2344560",
    "end": "2350220"
  },
  {
    "text": "audience should be on the token so it's just API card on slash Santa web and",
    "start": "2350440",
    "end": "2357400"
  },
  {
    "text": "then we'll restart the application and we will try that again and see what happens",
    "start": "2357400",
    "end": "2362819"
  },
  {
    "text": "foreign let's go back to here",
    "start": "2365200",
    "end": "2371200"
  },
  {
    "text": "and add ground to naughty nice list",
    "start": "2371200",
    "end": "2376560"
  },
  {
    "text": "the default isn't to always prompt you every time by the way I've just done this to make the demos a bit easier we",
    "start": "2376900",
    "end": "2383920"
  },
  {
    "text": "actually will cache tokens in the background to make things a bit better",
    "start": "2383920",
    "end": "2389440"
  },
  {
    "text": "so if all goes good perfect so that's the second issue I see is audience is",
    "start": "2389440",
    "end": "2394540"
  },
  {
    "text": "not set up correctly if you're using Azure app Service as well this pops up a",
    "start": "2394540",
    "end": "2399640"
  },
  {
    "text": "lot if you're using the authentication feature that we have built into it so",
    "start": "2399640",
    "end": "2404920"
  },
  {
    "text": "you have to be very explicit on the audiences with that and I've had quite a few calls where it's it's not set up",
    "start": "2404920",
    "end": "2410079"
  },
  {
    "text": "properly so it's just one to be aware of but again we can see the tokens we can",
    "start": "2410079",
    "end": "2415180"
  },
  {
    "text": "look at the configuration and the floors and get a good picture on why things aren't working so this is awesome uh we have managed to",
    "start": "2415180",
    "end": "2423579"
  },
  {
    "text": "Now call the downstream API with an access token um so I've heard there's another problem",
    "start": "2423579",
    "end": "2430060"
  },
  {
    "text": "though so I'm going to log out center now there's a fairly cheeky elf in there",
    "start": "2430060",
    "end": "2436000"
  },
  {
    "text": "who's called Alabaster and he's been digging around this application and has",
    "start": "2436000",
    "end": "2441579"
  },
  {
    "text": "realized something what he's discovered he said if he signs in",
    "start": "2441579",
    "end": "2449200"
  },
  {
    "text": "which is the same flows and everything and he can consent uh",
    "start": "2449200",
    "end": "2457240"
  },
  {
    "text": "to the same permission that Santa has been consenting to which is to manage",
    "start": "2457240",
    "end": "2463420"
  },
  {
    "text": "the Naughty Nice List now Alabaster is really not a senior elf so he's got no",
    "start": "2463420",
    "end": "2469060"
  },
  {
    "text": "business to be inside this part of the system but",
    "start": "2469060",
    "end": "2474400"
  },
  {
    "text": "he can get prompted for the consent and he can call the API",
    "start": "2474400",
    "end": "2479859"
  },
  {
    "text": "now this is something in Azure active directory to be aware of which is that",
    "start": "2479859",
    "end": "2484900"
  },
  {
    "text": "as a user well let's start with the application if there's a permission",
    "start": "2484900",
    "end": "2490359"
  },
  {
    "text": "configured on an API then it's really the application can",
    "start": "2490359",
    "end": "2495460"
  },
  {
    "text": "prompt anybody to consent for that permission right so just because you can",
    "start": "2495460",
    "end": "2501099"
  },
  {
    "text": "consent someone if they want to do something doesn't mean they're actually allowed to do that so Scopes aren't",
    "start": "2501099",
    "end": "2508359"
  },
  {
    "text": "permissions right at the end of the day Scopes are really there just to get delegated consent to act on behalf of a",
    "start": "2508359",
    "end": "2515920"
  },
  {
    "text": "user it doesn't mean that user is necessarily able to do that thing",
    "start": "2515920",
    "end": "2521079"
  },
  {
    "text": "okay Scopes aren't permissions now some authorization servers do actually allow you to map users to Scopes so I think",
    "start": "2521079",
    "end": "2528640"
  },
  {
    "text": "identity server is one way you could literally create a scope and then restrict which users could even be shown",
    "start": "2528640",
    "end": "2534460"
  },
  {
    "text": "uh to ask for consent but with aad uh if you're a user if",
    "start": "2534460",
    "end": "2539980"
  },
  {
    "text": "you're allowed to use an application we don't restrict which Scopes you are",
    "start": "2539980",
    "end": "2545200"
  },
  {
    "text": "allowed to consent to we will give you a token with them in so what are we going to do well there are a few different ways I",
    "start": "2545200",
    "end": "2552760"
  },
  {
    "text": "can think to solve this problem right the first is fairly old school we have active directory groups who doesn't love",
    "start": "2552760",
    "end": "2560400"
  },
  {
    "text": "seeing your name in about 1500 A.D groups that have been defined over like",
    "start": "2560400",
    "end": "2566500"
  },
  {
    "text": "30 years of an Enterprise for applications that no longer exist even anymore right it's it's pretty painful",
    "start": "2566500",
    "end": "2574300"
  },
  {
    "text": "it involves the ADT which is normally quite painful to make changes in ad which probably not a bad thing to be",
    "start": "2574300",
    "end": "2581079"
  },
  {
    "text": "honest with you but it's very detached from your application is active",
    "start": "2581079",
    "end": "2586119"
  },
  {
    "text": "directory active directory is like an organizational concern right and in my opinion ad groups should really",
    "start": "2586119",
    "end": "2592720"
  },
  {
    "text": "represent quite high level organizational constructs so maybe that is that I'm a developer that's fairly",
    "start": "2592720",
    "end": "2600760"
  },
  {
    "text": "organizational level or somebody works in marketing or there's a mentors group they seem like really good natural fits",
    "start": "2600760",
    "end": "2608619"
  },
  {
    "text": "for ad groups not very low level application concerns there's a bigger",
    "start": "2608619",
    "end": "2614680"
  },
  {
    "text": "problem with jwts and active directory groups as well which is that when you're",
    "start": "2614680",
    "end": "2619960"
  },
  {
    "text": "in an ad group we start putting those groups on every token that we send back which is has you as the subject",
    "start": "2619960",
    "end": "2627700"
  },
  {
    "text": "so those groups grow and grow and grow and grow the tokens get bigger and bigger and bigger and then we hit a limit and",
    "start": "2627700",
    "end": "2634660"
  },
  {
    "text": "at that point in time we don't put any more groups inside that token so that could leave you in a scenario as",
    "start": "2634660",
    "end": "2640599"
  },
  {
    "text": "an application where if you're lucky the group might be in the token if you're not you might have to make another call",
    "start": "2640599",
    "end": "2645940"
  },
  {
    "text": "off to graph to work out if the user is really in the group that you want to",
    "start": "2645940",
    "end": "2651160"
  },
  {
    "text": "find them in so not a great place to be in now in aad",
    "start": "2651160",
    "end": "2656859"
  },
  {
    "text": "we have another construct which is much a much better fit for this that's called a roll",
    "start": "2656859",
    "end": "2662020"
  },
  {
    "text": "so roles are like groups that are really scoped to your application inside Azure",
    "start": "2662020",
    "end": "2668380"
  },
  {
    "text": "active directory and they give us a much better location to put application concerns",
    "start": "2668380",
    "end": "2675160"
  },
  {
    "text": "and the idea is that we can Define roles against an app and we can assign users",
    "start": "2675160",
    "end": "2680260"
  },
  {
    "text": "and groups to them and then when we get a JWT back for the audience of that",
    "start": "2680260",
    "end": "2685420"
  },
  {
    "text": "application we will show you the roles that that user is in that are defining",
    "start": "2685420",
    "end": "2691119"
  },
  {
    "text": "the application so they're pretty straightforward to Define let's go into Santa web",
    "start": "2691119",
    "end": "2699480"
  },
  {
    "text": "and we have this tab down here called app roles so if we select that we can",
    "start": "2700240",
    "end": "2705520"
  },
  {
    "text": "see there are two Define we've got Santa World employee and Santa World senior employee so the idea is that you should",
    "start": "2705520",
    "end": "2712660"
  },
  {
    "text": "only be able to manage the naughty nice list if you're a senior employee so how do we get users into that",
    "start": "2712660",
    "end": "2720160"
  },
  {
    "text": "well we've talked about applications so far",
    "start": "2720160",
    "end": "2725500"
  },
  {
    "text": "but aad has got this other wonderful thing that goes hand in hand with an application that depending on which day",
    "start": "2725500",
    "end": "2731560"
  },
  {
    "text": "of the week it is either called a managed application an Enterprise application or a service principle",
    "start": "2731560",
    "end": "2737980"
  },
  {
    "text": "each name really makes very little sense to me and uh it took me a while to",
    "start": "2737980",
    "end": "2743020"
  },
  {
    "text": "actually understand what was going on but the idea is that an aad application is really just definition it's metadata",
    "start": "2743020",
    "end": "2750520"
  },
  {
    "text": "it's not a thing that you actually really interact with or you hang users",
    "start": "2750520",
    "end": "2756160"
  },
  {
    "text": "off or users sign into instead what happens is that for every",
    "start": "2756160",
    "end": "2761560"
  },
  {
    "text": "application if you want to use that inside your aad tenant you need to",
    "start": "2761560",
    "end": "2766720"
  },
  {
    "text": "create what's called a let's call it a service principle which kind of goes hand in hand with that it's literally",
    "start": "2766720",
    "end": "2772780"
  },
  {
    "text": "like a uh the manifestation of your application inside a directory and",
    "start": "2772780",
    "end": "2779079"
  },
  {
    "text": "that's where we can start hanging things like real users and blocking users from",
    "start": "2779079",
    "end": "2784200"
  },
  {
    "text": "accessing the application in the first place looking at who's signed into it all kind of things like that conditional",
    "start": "2784200",
    "end": "2790780"
  },
  {
    "text": "access are done against the service principle not the application",
    "start": "2790780",
    "end": "2796000"
  },
  {
    "text": "um there's another way we can set an application of which is in a what we call a multi-tenant form and it probably",
    "start": "2796000",
    "end": "2802240"
  },
  {
    "text": "makes more sense in that world because with a multi-tenant application we only Define it once but then we can have",
    "start": "2802240",
    "end": "2809560"
  },
  {
    "text": "other directories that want to consume the term a SAS provider they want to use",
    "start": "2809560",
    "end": "2815079"
  },
  {
    "text": "my SAS service they can create the service principle in their directory where they can assign users an access",
    "start": "2815079",
    "end": "2821319"
  },
  {
    "text": "and conditional access and things like that so when we want to assign users to a",
    "start": "2821319",
    "end": "2827200"
  },
  {
    "text": "role we have to go into the managed application service principle Enterprise",
    "start": "2827200",
    "end": "2832900"
  },
  {
    "text": "application whatever we want to call it and in here we can effectively go to",
    "start": "2832900",
    "end": "2838720"
  },
  {
    "text": "users and groups and we can start getting much more specific about who can access this",
    "start": "2838720",
    "end": "2845260"
  },
  {
    "text": "application or indeed if anyone can access this application so let's go and find Santa",
    "start": "2845260",
    "end": "2852040"
  },
  {
    "text": "and we will select Center and when we go to role",
    "start": "2852040",
    "end": "2857440"
  },
  {
    "text": "the only roles that we are offered are the ones that were defined against the application object so in this case I'm",
    "start": "2857440",
    "end": "2863440"
  },
  {
    "text": "going to make Santa a senior employee it's probably more than a senior employee's Center and we will assign",
    "start": "2863440",
    "end": "2872560"
  },
  {
    "text": "and now let's go back to Santa light emsel and we'll sign out and sign back",
    "start": "2872560",
    "end": "2878319"
  },
  {
    "text": "in the center in",
    "start": "2878319",
    "end": "2885460"
  },
  {
    "text": "and let's go and find Center I didn't remember it",
    "start": "2885460",
    "end": "2893099"
  },
  {
    "text": "and sign him in",
    "start": "2896859",
    "end": "2901440"
  },
  {
    "text": "now we'll click to add into the Naughty Nice List and we'll have a quick look at the JWT first of all that comes back",
    "start": "2902500",
    "end": "2909900"
  },
  {
    "text": "accept there's your token let's put that into",
    "start": "2912760",
    "end": "2918579"
  },
  {
    "text": "the third one over here uh so this is an access token yeah yeah",
    "start": "2918579",
    "end": "2927700"
  },
  {
    "text": "and then you can see now that we get this extra array comeback of strings",
    "start": "2927700",
    "end": "2933460"
  },
  {
    "text": "which is the roles that Santa's assigned to now what we can leverage in the back",
    "start": "2933460",
    "end": "2939940"
  },
  {
    "text": "end API is we're using standard um asp.net authentication authorization",
    "start": "2939940",
    "end": "2947380"
  },
  {
    "text": "here so we can start to use our bog standard authorize attribute",
    "start": "2947380",
    "end": "2954180"
  },
  {
    "text": "and we can say that we want the in this scenario it's the roles that we're interested in",
    "start": "2955240",
    "end": "2961300"
  },
  {
    "text": "and then we just go and find that particular role senior contributor",
    "start": "2961300",
    "end": "2969420"
  },
  {
    "text": "I was a senior employee oh man what's going on there then",
    "start": "2970180",
    "end": "2976859"
  },
  {
    "text": "ah okay yeah that's My Demo bad basically there's a human",
    "start": "2977980",
    "end": "2983200"
  },
  {
    "text": "visible version of a role and then there's the actual um sort of key of the role that you get",
    "start": "2983200",
    "end": "2989260"
  },
  {
    "text": "back so I think in this scenario what I've done is the senior employee is",
    "start": "2989260",
    "end": "2995319"
  },
  {
    "text": "actually called senior contributor so that's the one that comes back in the token thanks thanks for pointing that",
    "start": "2995319",
    "end": "3000480"
  },
  {
    "text": "with our Booksy okay great so we are going to check for",
    "start": "3000480",
    "end": "3006480"
  },
  {
    "text": "that particular role in the token so now when we run this",
    "start": "3006480",
    "end": "3011640"
  },
  {
    "text": "then for Santa all is going to go well and we're going to be able to call that",
    "start": "3011640",
    "end": "3017160"
  },
  {
    "text": "API but if we were to get a token as Alabaster then of course we're not going",
    "start": "3017160",
    "end": "3023040"
  },
  {
    "text": "to have that particular role inside the token and the authorization step will",
    "start": "3023040",
    "end": "3028140"
  },
  {
    "text": "fail so uh she has to kind of finish that one",
    "start": "3028140",
    "end": "3033839"
  },
  {
    "text": "off [Music] in this scenario I think it worked last",
    "start": "3033839",
    "end": "3039540"
  },
  {
    "text": "time anyway because we didn't have the orph on there",
    "start": "3039540",
    "end": "3044119"
  },
  {
    "text": "and",
    "start": "3044760",
    "end": "3047720"
  },
  {
    "text": "happy days hopefully ah felt a fetch I'm not sure what's going on there but",
    "start": "3050520",
    "end": "3056400"
  },
  {
    "text": "anyway that's okay uh you'll have to trust me on that one uh in the interest of kind of not",
    "start": "3056400",
    "end": "3063359"
  },
  {
    "text": "fixing my broken code that one should have worked and if we do the same as Alabaster we don't have the role inside",
    "start": "3063359",
    "end": "3069119"
  },
  {
    "text": "the token so everything fails so really that's what I had to walk",
    "start": "3069119",
    "end": "3074700"
  },
  {
    "text": "through today um I think we've covered a fair bit if anyone's interested there's the crazy",
    "start": "3074700",
    "end": "3080040"
  },
  {
    "text": "code inside microsoft.web.identity which looks to specific versions of tokens and then",
    "start": "3080040",
    "end": "3086540"
  },
  {
    "text": "hardwires a different expected audience depending on which one it is there's a",
    "start": "3086540",
    "end": "3092040"
  },
  {
    "text": "link on the slide deck as well uh to that code if anyone interested in that",
    "start": "3092040",
    "end": "3097619"
  },
  {
    "text": "but ultimately Scopes aren't permissions and that's the really important thing I want to get across now really roles",
    "start": "3097619",
    "end": "3104640"
  },
  {
    "text": "aren't great for permissions either they're good for segregating users into your application but as your business logic starts to get",
    "start": "3104640",
    "end": "3111660"
  },
  {
    "text": "more and more specific then you really don't want to be Outsourcing that into a third party like aad like you don't want",
    "start": "3111660",
    "end": "3118319"
  },
  {
    "text": "to get into a trap of having roles called something like can transfer more than a hundred dollars or is allowed to",
    "start": "3118319",
    "end": "3126359"
  },
  {
    "text": "transact on a Monday right that is business logic concern and either get",
    "start": "3126359",
    "end": "3132599"
  },
  {
    "text": "that inside your application or look to something like a policy server potentially if you want to Outsource",
    "start": "3132599",
    "end": "3138240"
  },
  {
    "text": "that there's a good talk tomorrow morning but uh Jason is doing early about asp.net core authorization policy",
    "start": "3138240",
    "end": "3146819"
  },
  {
    "text": "so if that's something that you're interested in to take that next level into getting application business",
    "start": "3146819",
    "end": "3152040"
  },
  {
    "text": "authorization rules then I fully recommend going to that talk um but that is everything from me for",
    "start": "3152040",
    "end": "3159000"
  },
  {
    "text": "today so really appreciate you all coming and um so we have a few minutes potentially",
    "start": "3159000",
    "end": "3165480"
  },
  {
    "text": "for questions if there are any so thanks",
    "start": "3165480",
    "end": "3169880"
  },
  {
    "text": "you mentioned oidc but um",
    "start": "3172460",
    "end": "3177559"
  },
  {
    "text": "yeah sure right so",
    "start": "3182579",
    "end": "3189059"
  },
  {
    "text": "um in the beginning there was all off too and and oauth 2 was a very loose framework on how to build an",
    "start": "3189059",
    "end": "3194760"
  },
  {
    "text": "authorization framework and it was possible to be like you know adhering to a wolf too whilst having quite different",
    "start": "3194760",
    "end": "3201660"
  },
  {
    "text": "implementations of your uh different implementations auth2 is also just an",
    "start": "3201660",
    "end": "3208319"
  },
  {
    "text": "authorization protocol right so its main purpose was to get delegated consent of",
    "start": "3208319",
    "end": "3214200"
  },
  {
    "text": "a user really to consume their Facebook profile but it said nothing about Authentication",
    "start": "3214200",
    "end": "3220319"
  },
  {
    "text": "so what happened is a lot of the big providers built their own authentication",
    "start": "3220319",
    "end": "3225380"
  },
  {
    "text": "apis and used the wharf2 to get tokens to access those so you had this like",
    "start": "3225380",
    "end": "3231720"
  },
  {
    "text": "proliferation where signing with Google signing with Facebook signing with this service they all did it in a slightly",
    "start": "3231720",
    "end": "3238200"
  },
  {
    "text": "different way the claims are all slightly different in the tokens so oidc came along and really started to",
    "start": "3238200",
    "end": "3245400"
  },
  {
    "text": "uh come up with a more standard compliant way of implementing a warf2 as a framework so that might be a case of",
    "start": "3245400",
    "end": "3253200"
  },
  {
    "text": "saying well look of2 said you could do this and you could do that and maybe you could do this but you don't need to worry about that oidc said Nana this is",
    "start": "3253200",
    "end": "3260880"
  },
  {
    "text": "how you do it and then it also added this new token called an ID token which",
    "start": "3260880",
    "end": "3266700"
  },
  {
    "text": "basically fixed fixed in quotes the authentication problem and gave us standards compliant way to just work out",
    "start": "3266700",
    "end": "3273119"
  },
  {
    "text": "who somebody is without asking them to access another API",
    "start": "3273119",
    "end": "3278520"
  },
  {
    "text": "so I I quite often interchanged and I'll say oh two or I'll say oigc and I never",
    "start": "3278520",
    "end": "3284160"
  },
  {
    "text": "really know which one to say because it's not like it's an umbrella it's not like it's a replaces a wolf too it's",
    "start": "3284160",
    "end": "3291300"
  },
  {
    "text": "more like it has these extensions two or two and it also",
    "start": "3291300",
    "end": "3296880"
  },
  {
    "text": "um just kind of makes it a little bit more concrete around how to implement oauthu",
    "start": "3296880",
    "end": "3302520"
  },
  {
    "text": "so when you look at Azure active directory for example I refer to it as like an oidc compliant authorization",
    "start": "3302520",
    "end": "3309780"
  },
  {
    "text": "server that will give you also oauth2 tokens as well as identity access tokens",
    "start": "3309780",
    "end": "3318079"
  },
  {
    "text": "but I'm happy if anyone else like so a lot of what I know about this I work with some really smart people at Bank",
    "start": "3318839",
    "end": "3324480"
  },
  {
    "text": "West a few years ago and learned a lot from their identity teams so I'm happy if anyone else in the room wants to like",
    "start": "3324480",
    "end": "3330480"
  },
  {
    "text": "extend that answer then please go for it because uh yeah",
    "start": "3330480",
    "end": "3336660"
  },
  {
    "text": "yep sure an RSC a request for comment I think it",
    "start": "3336660",
    "end": "3343500"
  },
  {
    "text": "stands for so um if you want this is a good one I'm sure someone will give a much better",
    "start": "3343500",
    "end": "3349380"
  },
  {
    "text": "answer for this um so you have an idea and you want to think about standardizing that idea so",
    "start": "3349380",
    "end": "3356460"
  },
  {
    "text": "the general approach is we put out as an RFC and then it will have a lot of kind of debate and discussion and feedback go",
    "start": "3356460",
    "end": "3363300"
  },
  {
    "text": "through various versions until it kind of hits a point where it's considered",
    "start": "3363300",
    "end": "3368760"
  },
  {
    "text": "you know stable enough and the controversy has died down so",
    "start": "3368760",
    "end": "3374220"
  },
  {
    "text": "um yeah and then different things are referred to as different RSC numbers so",
    "start": "3374220",
    "end": "3379260"
  },
  {
    "text": "private Network addresses like RSC 1819 you know it's where a bunch of people just said not these IP addresses we are",
    "start": "3379260",
    "end": "3387180"
  },
  {
    "text": "going to say they are private use only they are not public and that's um pretty much standardized in RFC 1819",
    "start": "3387180",
    "end": "3393960"
  },
  {
    "text": "so oauth to an irdc also have rfcs that go with them as well",
    "start": "3393960",
    "end": "3400880"
  },
  {
    "text": "yeah right so it's normally a coalition of the Willing so you'll find a lot of the rfcs will have people uh if if there",
    "start": "3405619",
    "end": "3413339"
  },
  {
    "text": "are Enterprise products involved they'll often have representation from the vendors of those products but also they",
    "start": "3413339",
    "end": "3420119"
  },
  {
    "text": "may be you know academics just people that are really interested in that domain so I think it's kind of a public",
    "start": "3420119",
    "end": "3426540"
  },
  {
    "text": "domain thing I'm not sure if there's a method to choose who gets to contribute in it or not",
    "start": "3426540",
    "end": "3431819"
  },
  {
    "text": "um that's possibly a level I I don't really uh know at that point but yeah",
    "start": "3431819",
    "end": "3438500"
  },
  {
    "text": "um in the aad console so you're working in the section called app registration yeah",
    "start": "3438900",
    "end": "3445920"
  },
  {
    "text": "how does that differ from the Enterprise applications section which is also used to set up xso with Apple",
    "start": "3445920",
    "end": "3453599"
  },
  {
    "text": "yeah right okay so um the app so which bit of it in particular",
    "start": "3453599",
    "end": "3460380"
  },
  {
    "text": "was it you were thinking about in there so I haven't um",
    "start": "3460380",
    "end": "3467000"
  },
  {
    "text": "in this way exactly but I haven't worked in the Enterprise applications section when you're registering like a",
    "start": "3469020",
    "end": "3474480"
  },
  {
    "text": "third-party um oh yeah right okay cool",
    "start": "3474480",
    "end": "3479520"
  },
  {
    "text": "yeah okay sweet yeah so there's some similarities yes",
    "start": "3479520",
    "end": "3485220"
  },
  {
    "text": "yeah right right so what you're probably doing there is setting up a multi so a",
    "start": "3485220",
    "end": "3490500"
  },
  {
    "text": "multi-tenant application so when it comes to SAS providers I was doing some work with one the other day they own the",
    "start": "3490500",
    "end": "3497160"
  },
  {
    "text": "application registration right so you never see that part of the portal you can't access it it's inside the SAS",
    "start": "3497160",
    "end": "3504359"
  },
  {
    "text": "provider's tenant but what you can do is you can create that you can crash these links that allow in aad administrator to",
    "start": "3504359",
    "end": "3513000"
  },
  {
    "text": "create an instance of a service principle that represents that application in their directory so it's",
    "start": "3513000",
    "end": "3520260"
  },
  {
    "text": "possible that that's where you're at is inside that service principle that represents a third-party application and",
    "start": "3520260",
    "end": "3528299"
  },
  {
    "text": "that's where you can start assigning users to it um yeah so it's more about whether it's",
    "start": "3528299",
    "end": "3534240"
  },
  {
    "text": "a third-party application something in the house that you're building specifically to work with right",
    "start": "3534240",
    "end": "3541619"
  },
  {
    "text": "yeah yeah linking something that yeah so if you want to do sign inflows in aad",
    "start": "3541619",
    "end": "3547020"
  },
  {
    "text": "then there has to be an application somewhere and there'll be a service principle in the tenants where you can",
    "start": "3547020",
    "end": "3553559"
  },
  {
    "text": "sign into that application there are scenarios where you can have service principles without applications as well",
    "start": "3553559",
    "end": "3559200"
  },
  {
    "text": "so if you use Azure and you create a managed identity you'll get a service principle without an application and you",
    "start": "3559200",
    "end": "3566040"
  },
  {
    "text": "can assign R back to that service principle for example but yeah if there's a sign in flow there'll be an",
    "start": "3566040",
    "end": "3571920"
  },
  {
    "text": "application somewhere oh yep sorry",
    "start": "3571920",
    "end": "3579680"
  },
  {
    "text": "um Federation approach yeah yeah so the",
    "start": "3586380",
    "end": "3595079"
  },
  {
    "text": "question is around um multiple identity providers if you want to build a application that can do",
    "start": "3595079",
    "end": "3600900"
  },
  {
    "text": "sign-in against all of those can be a real pain um I I don't know the Azure active",
    "start": "3600900",
    "end": "3606720"
  },
  {
    "text": "directory roadmap but I do know that b2c does support Federation so you can front",
    "start": "3606720",
    "end": "3612660"
  },
  {
    "text": "a whole bunch of different identity providers with a b2c sign-in page now",
    "start": "3612660",
    "end": "3617760"
  },
  {
    "text": "that having said b2c sign in doesn't give you access to like authenticator and all that kind of conditional access",
    "start": "3617760",
    "end": "3625200"
  },
  {
    "text": "stuff so I think there's still some gaps there but I'm not sure what's on roadmap",
    "start": "3625200",
    "end": "3631200"
  },
  {
    "text": "for uh closing those if anything yeah go for it",
    "start": "3631200",
    "end": "3638539"
  },
  {
    "text": "yeah I don't think there's much you can change on ad right so B to C is one way",
    "start": "3656880",
    "end": "3662940"
  },
  {
    "text": "you can get a lot more customized uh flows defining your own uis and all that",
    "start": "3662940",
    "end": "3668099"
  },
  {
    "text": "kind of stuff that having said there possibly are some parameters you can tweak to change that experience a little",
    "start": "3668099",
    "end": "3673740"
  },
  {
    "text": "bit I just haven't done too much on that so I'm afraid I don't have a great answer I take it offline and uh",
    "start": "3673740",
    "end": "3679500"
  },
  {
    "text": "um find out for you cool",
    "start": "3679500",
    "end": "3686359"
  },
  {
    "text": "okay so we'll look thank you everyone for coming and um yeah enjoy the rest of",
    "start": "3687780",
    "end": "3693420"
  },
  {
    "text": "your conference cheers [Applause]",
    "start": "3693420",
    "end": "3701119"
  }
]