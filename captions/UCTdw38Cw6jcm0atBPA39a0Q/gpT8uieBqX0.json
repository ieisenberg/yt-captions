[
  {
    "text": "all right my watch says 20 minutes to two so let's start well welcome everyone to this session",
    "start": "560",
    "end": "7200"
  },
  {
    "text": "which is called enter and testing goes corporate in the session i will talk about",
    "start": "7200",
    "end": "12880"
  },
  {
    "text": "how we got engine testing working properly within our organization",
    "start": "12880",
    "end": "18800"
  },
  {
    "text": "my name is john westrom i am a software architect for frontlands and i work at the swedish medical",
    "start": "19119",
    "end": "24800"
  },
  {
    "text": "products agency in my spare time i'm an open source developer where",
    "start": "24800",
    "end": "30000"
  },
  {
    "text": "my main project is cyprus and the other both which is a plugin for cypress to handle",
    "start": "30000",
    "end": "36800"
  },
  {
    "text": "windows authentication and you have my contact details below the blog isn't",
    "start": "36800",
    "end": "42480"
  },
  {
    "text": "very active i've been focusing more on the open source project in the recent time also when it comes to",
    "start": "42480",
    "end": "50320"
  },
  {
    "text": "questions uh i will be there will be probably some time at the end of the session the q a live",
    "start": "50320",
    "end": "57680"
  },
  {
    "text": "and afterwards i will be available in the slack channel i will keep an eye on the slack channel but i cannot promise that i'll catch",
    "start": "57680",
    "end": "64720"
  },
  {
    "text": "everything there directly so preferable if you take the questions in the end thank you",
    "start": "64720",
    "end": "72560"
  },
  {
    "text": "node.js is broken in corporate environments this might sound a bit like a harsh",
    "start": "72560",
    "end": "77840"
  },
  {
    "text": "statement but i think this is really true when i take node.js i install it on a machine",
    "start": "77840",
    "end": "83759"
  },
  {
    "text": "in my organization and then i try to do npm install it fails and npm install is",
    "start": "83759",
    "end": "90640"
  },
  {
    "text": "really a fundamental thing to do and nodes are things that most of node is broken",
    "start": "90640",
    "end": "97359"
  },
  {
    "text": "what do i mean with the corporate environment well it's a fairly large company maybe 500 plus",
    "start": "97759",
    "end": "103200"
  },
  {
    "text": "employees i.t is not the core business and pretty much everyone is sitting in a windows machine",
    "start": "103200",
    "end": "110079"
  },
  {
    "text": "there's a lot of internet to do applications and the network is a bit restrictive",
    "start": "110079",
    "end": "117438"
  },
  {
    "text": "i have big respect for node i don't want to blame anyone here i think they have made",
    "start": "118079",
    "end": "123360"
  },
  {
    "text": "a huge success with the project bringing javascript to many platforms",
    "start": "123360",
    "end": "128479"
  },
  {
    "text": "but i think the corporate sector especially with windows intranets have not really",
    "start": "128479",
    "end": "133680"
  },
  {
    "text": "received the attention that it needs there are mainly three pain points when it comes to using lds in this",
    "start": "133680",
    "end": "140239"
  },
  {
    "text": "environment in this authentication being one of them there's also corporate certificates and",
    "start": "140239",
    "end": "146319"
  },
  {
    "text": "corporate proxies and we will take a look at all of those during the talk",
    "start": "146319",
    "end": "152800"
  },
  {
    "text": "so the agenda looks like this i will first give a little review into cypress which is the",
    "start": "154400",
    "end": "160319"
  },
  {
    "text": "entrance solution that we use in my organization and we'll talk about windows authentication",
    "start": "160319",
    "end": "166480"
  },
  {
    "text": "uh how the plugin works which hands us with that authentication in cyprus",
    "start": "166480",
    "end": "171920"
  },
  {
    "text": "and finally we look at the other pain points lbs that i mentioned",
    "start": "171920",
    "end": "177519"
  },
  {
    "text": "so what is cyprus cyprus consists of two parts you have a test runner and a",
    "start": "178640",
    "end": "184480"
  },
  {
    "text": "dashboard and testrunner you run on your local machine and they it consists of several",
    "start": "184480",
    "end": "191040"
  },
  {
    "text": "components some of them run inside the browser itself which gives",
    "start": "191040",
    "end": "196480"
  },
  {
    "text": "pretty good access to the internals of the browser and allows for a nice feature called time frame",
    "start": "196480",
    "end": "202480"
  },
  {
    "text": "i will show a little bit later it's open source and completely free to use the dashboard",
    "start": "202480",
    "end": "209040"
  },
  {
    "text": "is an optional offering it's a portal for test execution where you can look at the results of",
    "start": "209040",
    "end": "214400"
  },
  {
    "text": "your tests and recordings after that if you have a big bunch of test cases",
    "start": "214400",
    "end": "220720"
  },
  {
    "text": "and maybe you need to run them on several browsers or several resolutions the dashboard can help out with",
    "start": "220720",
    "end": "226000"
  },
  {
    "text": "automatic parallelization of the tests for efficiency this is a cloud service and the",
    "start": "226000",
    "end": "232720"
  },
  {
    "text": "subscription is required but if you're a really small user maybe three accounts only",
    "start": "232720",
    "end": "237920"
  },
  {
    "text": "it's still free and at this point i want to mention that i'm not funded by cyprus or endorsed by",
    "start": "237920",
    "end": "245200"
  },
  {
    "text": "cyprus in some manner i just really love the tools that they make and i want to spread the word for other",
    "start": "245200",
    "end": "251840"
  },
  {
    "text": "developers to share this okay enough marketing let's look at some",
    "start": "251840",
    "end": "258320"
  },
  {
    "text": "code so this is a typical test file for cypress",
    "start": "258320",
    "end": "263680"
  },
  {
    "text": "if you've written javascript tests before i think you recognize a bit in the beginning but the",
    "start": "263680",
    "end": "270160"
  },
  {
    "text": "describe and the it statement is pretty standard the test suite and the test case",
    "start": "270160",
    "end": "275919"
  },
  {
    "text": "then comes the typos commands cyprus visit takes the browser to the root of the",
    "start": "275919",
    "end": "281919"
  },
  {
    "text": "website we're listening and renders that cyprus get will patch",
    "start": "281919",
    "end": "287040"
  },
  {
    "text": "an element on the page using a css selector in this case the id username and",
    "start": "287040",
    "end": "293199"
  },
  {
    "text": "here we want to type into that element this text so this is an input field",
    "start": "293199",
    "end": "299520"
  },
  {
    "text": "then we get a button element which contains the text lookup and we click on that finally",
    "start": "299520",
    "end": "306160"
  },
  {
    "text": "we pick up a third element a div element with the class display explaining and check that it has the correct",
    "start": "306160",
    "end": "311840"
  },
  {
    "text": "content correct text content so apparently we do a username lookup",
    "start": "311840",
    "end": "317360"
  },
  {
    "text": "here and you see results there i think this is really compact and",
    "start": "317360",
    "end": "323280"
  },
  {
    "text": "readable i like their api and i think just by looking at it you can get a fairly good understanding",
    "start": "323280",
    "end": "330560"
  },
  {
    "text": "of what's going to happen without reading their api documentation",
    "start": "330560",
    "end": "336160"
  },
  {
    "text": "all right let's see it in action",
    "start": "337680",
    "end": "341759"
  },
  {
    "text": "and while we're waiting for that to load take a look at this picture if you recognize that picture that",
    "start": "344960",
    "end": "351039"
  },
  {
    "text": "probably means you're about as old as i am this picture is from the pc demo scene a classical game",
    "start": "351039",
    "end": "359280"
  },
  {
    "text": "called the second reality by future crew which was released in 1993. back in that time that was a really",
    "start": "359280",
    "end": "367680"
  },
  {
    "text": "impressive display of computing skills for me as a beginner in the pcc and it's been",
    "start": "367680",
    "end": "373919"
  },
  {
    "text": "an inspiration for me to pursue a career in software development all right so here's cypress this is the",
    "start": "373919",
    "end": "380960"
  },
  {
    "text": "test runner in the test runner we can select which test we want to run we can look at the",
    "start": "380960",
    "end": "386479"
  },
  {
    "text": "configuration that's being used at the moment and we can pick which browser to run the test",
    "start": "386479",
    "end": "392160"
  },
  {
    "text": "so this is the test case that we looked at the code for just now",
    "start": "392160",
    "end": "398240"
  },
  {
    "text": "and there we go so there's actually two test cases here because i wanted to show also how our aiming tests look first",
    "start": "403759",
    "end": "411039"
  },
  {
    "text": "test is exactly the code that we looked at before we visit the page",
    "start": "411039",
    "end": "416319"
  },
  {
    "text": "we fill in the form and then we check the contents nothing strange here except that we can",
    "start": "416319",
    "end": "422160"
  },
  {
    "text": "see the actual steps of the test in the browser which is really nice here",
    "start": "422160",
    "end": "427280"
  },
  {
    "text": "comes the time travel feature so when i hover over one of the steps",
    "start": "427280",
    "end": "433680"
  },
  {
    "text": "it will show on the right hand side how the page look at that particular step and when i hover",
    "start": "433680",
    "end": "440400"
  },
  {
    "text": "over a step that selects something it will highlight that element so it's pretty easy to see that it will",
    "start": "440400",
    "end": "447440"
  },
  {
    "text": "write john doe into this input field and it's easy to see that i found the right button to click on",
    "start": "447440",
    "end": "455280"
  },
  {
    "text": "and then when i do my assertion i can see that it's the content of this element that i'm",
    "start": "455280",
    "end": "460960"
  },
  {
    "text": "inserting against so really really powerful both for the development of the tests and also",
    "start": "460960",
    "end": "466720"
  },
  {
    "text": "debugging something as well if i look at the failing tests in this",
    "start": "466720",
    "end": "474080"
  },
  {
    "text": "case i was typing in the username foo instead of jado and expected that",
    "start": "474080",
    "end": "480080"
  },
  {
    "text": "mr fu should be a user in the system but apparently he isn't so either is missing in the database or",
    "start": "480080",
    "end": "486639"
  },
  {
    "text": "there's something wrong with markets then i can scroll down and see this is",
    "start": "486639",
    "end": "492560"
  },
  {
    "text": "the actual line in my test code where the assertion pane",
    "start": "492560",
    "end": "498240"
  },
  {
    "text": "so it's also very readable i think it makes it easier to go back to it",
    "start": "498240",
    "end": "504960"
  },
  {
    "text": "in other solutions that i worked with usually you were happy if you had a screenshot maybe of",
    "start": "505360",
    "end": "510400"
  },
  {
    "text": "how to when the failed failure have already occurred and then you have to rerun everything",
    "start": "510400",
    "end": "516159"
  },
  {
    "text": "hopefully this is helpful",
    "start": "516159",
    "end": "521200"
  },
  {
    "text": "just to demonstrate how easy it is to run in a different browser let's go with edge here",
    "start": "521200",
    "end": "528240"
  },
  {
    "text": "and it launches edge browser and runs the same test speed again",
    "start": "528320",
    "end": "535839"
  },
  {
    "text": "it should i think i [Music]",
    "start": "536000",
    "end": "542009"
  },
  {
    "text": "demo gods aren't happy with me at the moment so let's just try it out",
    "start": "543839",
    "end": "563839"
  },
  {
    "text": "okay here we go so same test set same result no no surprises but",
    "start": "567040",
    "end": "573920"
  },
  {
    "text": "still just by changing this drop down i could select which browser i want to run it's",
    "start": "573920",
    "end": "580320"
  },
  {
    "text": "really really nice okay",
    "start": "580320",
    "end": "584240"
  },
  {
    "text": "so let's talk a bit about how cyprus works on the inside",
    "start": "585519",
    "end": "590640"
  },
  {
    "text": "what we saw the ui is testrunner which is an electron app where you can",
    "start": "590640",
    "end": "596640"
  },
  {
    "text": "select and start your tests in the background there's a server component running a node",
    "start": "596640",
    "end": "603839"
  },
  {
    "text": "when we're starting a test it will tell this test runner to execute that one and the test runner",
    "start": "603839",
    "end": "609760"
  },
  {
    "text": "will launch the browser window and the browser window holds a test from a client",
    "start": "609760",
    "end": "615200"
  },
  {
    "text": "so that was this panel that you saw on the left hand side with the testing log and the results",
    "start": "615200",
    "end": "622480"
  },
  {
    "text": "then uh when the test runner is ready to start the test the receive commands and pass back",
    "start": "624079",
    "end": "630880"
  },
  {
    "text": "results to the server you can tell the browser to navigate",
    "start": "630880",
    "end": "635920"
  },
  {
    "text": "this is done natively by the browser actual network requests but the network",
    "start": "635920",
    "end": "641360"
  },
  {
    "text": "requests are proxied through cyprus tests on the server before they reach the network",
    "start": "641360",
    "end": "648240"
  },
  {
    "text": "normally this traffic just passes through but i will get back to how this can be helpful also and then we",
    "start": "648880",
    "end": "655680"
  },
  {
    "text": "have our application loader here now it's possible for the tests on a",
    "start": "655680",
    "end": "660959"
  },
  {
    "text": "client to simulate user interactions such as typing in fields so clicking on things scrolling or whatever and we can also",
    "start": "660959",
    "end": "667600"
  },
  {
    "text": "inspect the dom to see that it has elements we expect so that elements contain what we expect",
    "start": "667600",
    "end": "675839"
  },
  {
    "text": "to be fair uh if you're running the electron browser like i did in this demonstration it's actually the",
    "start": "678959",
    "end": "685519"
  },
  {
    "text": "same process the test run ui and test browser is running the same process",
    "start": "685519",
    "end": "690959"
  },
  {
    "text": "but this is more of architectural detail when you have a separate browser like",
    "start": "690959",
    "end": "696959"
  },
  {
    "text": "chrome edge it will look like this and for the rest of this talk",
    "start": "696959",
    "end": "702160"
  },
  {
    "text": "we're mostly interested in communication between the components and not which process the components are",
    "start": "702160",
    "end": "707760"
  },
  {
    "text": "running so how does this make cyprus different",
    "start": "707760",
    "end": "713360"
  },
  {
    "text": "from selenium we can start with the testronic client",
    "start": "713360",
    "end": "721279"
  },
  {
    "text": "quite obvious because there's no display of the test execution or test result inside the browser when you're running",
    "start": "721760",
    "end": "728839"
  },
  {
    "text": "selenium this is also a big benefit because it makes it easier to debug things it",
    "start": "728839",
    "end": "736720"
  },
  {
    "text": "allows this time travel feature that i show that it records the dom at each step of the test",
    "start": "736720",
    "end": "744399"
  },
  {
    "text": "waiting for elements to be available is much faster and smoother and stable",
    "start": "744399",
    "end": "751040"
  },
  {
    "text": "next part is the test run ui where you select which tests to run this is also",
    "start": "753440",
    "end": "759279"
  },
  {
    "text": "not something that you see in selenium you will have to start your tests usually from your developer id like",
    "start": "759279",
    "end": "765440"
  },
  {
    "text": "visual studio so i think this makes it a lot easier to get started with cypress for",
    "start": "765440",
    "end": "770839"
  },
  {
    "text": "non-developers and then we have the proxy for networks traffic and the",
    "start": "770839",
    "end": "777279"
  },
  {
    "text": "thing with the proxy is that this allows you to mock responses and responses to requests",
    "start": "777279",
    "end": "784800"
  },
  {
    "text": "so you can mock an api that is required by your application and this is very powerful but that means",
    "start": "784800",
    "end": "791519"
  },
  {
    "text": "you could try out error scenarios or edge cases that might be difficult or nearly impossible to",
    "start": "791519",
    "end": "798079"
  },
  {
    "text": "replicate when you're rolling running in a full environment it also means that you can short-circuit",
    "start": "798079",
    "end": "805040"
  },
  {
    "text": "certain parts of a longer flow in your application to make your testing much more efficient",
    "start": "805040",
    "end": "814880"
  },
  {
    "text": "how about authentication there's built-in support for basic authentication you pass an auth option to the visit or",
    "start": "814880",
    "end": "822560"
  },
  {
    "text": "the request command and if you're doing any authentication that doesn't really require client-side",
    "start": "822560",
    "end": "829279"
  },
  {
    "text": "protocol that will also work fine if you're logging into a web form or a json web token solution",
    "start": "829279",
    "end": "836880"
  },
  {
    "text": "the reason is that with this kind of logins all you have to do is to write",
    "start": "836880",
    "end": "842959"
  },
  {
    "text": "the steps in cyprus to fill in the form to do the login and click the button and there you go",
    "start": "842959",
    "end": "849199"
  },
  {
    "text": "so those will be just fine so if you're an internet facing app developer you might say oh this looks",
    "start": "849199",
    "end": "855680"
  },
  {
    "text": "sharp let's use this but if we're a corporate internet",
    "start": "855680",
    "end": "861760"
  },
  {
    "text": "developer who says meh what's up with this authentication then",
    "start": "861760",
    "end": "867279"
  },
  {
    "text": "yeah what about windows authentication",
    "start": "867519",
    "end": "871839"
  },
  {
    "text": "windows authentication school name is integrated with application when you use it in a web context there",
    "start": "872959",
    "end": "880000"
  },
  {
    "text": "are many other names historical names mtlm is one of the protocols negotiates another of the protocols",
    "start": "880000",
    "end": "886480"
  },
  {
    "text": "so it's actually a bunch of different authentication protocols that use for internet websites or apis",
    "start": "886480",
    "end": "893839"
  },
  {
    "text": "and it validates the user against active directory or local machine account now for a long",
    "start": "893839",
    "end": "900560"
  },
  {
    "text": "time this has been the primary choice when you select how to do internet",
    "start": "900560",
    "end": "906560"
  },
  {
    "text": "authentication in corporate settings",
    "start": "906560",
    "end": "912240"
  },
  {
    "text": "there are many methods uh initially basic authentication is a classic that",
    "start": "912240",
    "end": "917279"
  },
  {
    "text": "many know about and uh ntlm and negotiate were the ones i mentioned before",
    "start": "917279",
    "end": "923120"
  },
  {
    "text": "they have their different pros and cons and if you look at which ones are supported by cypress",
    "start": "923120",
    "end": "928320"
  },
  {
    "text": "it's uh everyone except these three i don't know about you but i don't know",
    "start": "928320",
    "end": "933759"
  },
  {
    "text": "many people using digest anymore there is an open support ticket with cyprus words so someone still needs",
    "start": "933759",
    "end": "940800"
  },
  {
    "text": "it in my case we needed ntlm or negotiate to use this against our own applications",
    "start": "940800",
    "end": "947519"
  },
  {
    "text": "so that's why when i first saw cyprus i thought that this is something that we really need",
    "start": "947519",
    "end": "953360"
  },
  {
    "text": "i want to try this out i think this would work better for us entrance testing solution but there was no support for wind",
    "start": "953360",
    "end": "959120"
  },
  {
    "text": "specifications so how i got the idea to start working on such a plugin",
    "start": "959120",
    "end": "966240"
  },
  {
    "text": "so which way to go should i choose ntlm or ngo shape uh well if you look at what my plugin is",
    "start": "966240",
    "end": "973360"
  },
  {
    "text": "called it's called cypress mtl and or so if it gives it away and why did i pick that well have you",
    "start": "973360",
    "end": "981360"
  },
  {
    "text": "ever looked at the specs for kerberos",
    "start": "981360",
    "end": "986639"
  },
  {
    "text": "of course you can you can master that too but it felt like a stretch for me to uh",
    "start": "986639",
    "end": "992079"
  },
  {
    "text": "implement the solution that will support and negotiate fully just as a side project to get this",
    "start": "992079",
    "end": "998480"
  },
  {
    "text": "working for trying out cyprus in our organization until then felt like a much closer goal",
    "start": "998480",
    "end": "1004240"
  },
  {
    "text": "i had some prior knowledge in how ntlm works there are some open source libraries available and",
    "start": "1004240",
    "end": "1013360"
  },
  {
    "text": "also i wanted it to be platform and monsters the thing is that mtlm you can calculate",
    "start": "1013360",
    "end": "1021199"
  },
  {
    "text": "everything in messages exchange locally on your machine with negotiate you need to talk to",
    "start": "1021199",
    "end": "1028160"
  },
  {
    "text": "active directory other parts of the network to get your tickets to be able to complete the",
    "start": "1028160",
    "end": "1034480"
  },
  {
    "text": "authentication so this with anti-aliam we could be fully independent and",
    "start": "1034480",
    "end": "1040240"
  },
  {
    "text": "wrong authentication flow without those dependencies",
    "start": "1040240",
    "end": "1045759"
  },
  {
    "text": "let's have a look look at the ntlm handshake how that works so it starts out with a",
    "start": "1047439",
    "end": "1054080"
  },
  {
    "text": "normal get request for the site ntlm.acme.com",
    "start": "1054080",
    "end": "1060000"
  },
  {
    "text": "the response is a 401 not authorized and you get a special header here called dvd",
    "start": "1060000",
    "end": "1065840"
  },
  {
    "text": "authenticate which specifies which protocols does this support server support for authentication",
    "start": "1065840",
    "end": "1073919"
  },
  {
    "text": "nplm or negotiate in the next step we send another git request just like",
    "start": "1073919",
    "end": "1079120"
  },
  {
    "text": "the first one but we add an authorization header where we add the first part of the empty alone",
    "start": "1079120",
    "end": "1086080"
  },
  {
    "text": "handshake we got another reply with the 401 and now the replying header contains",
    "start": "1086080",
    "end": "1093120"
  },
  {
    "text": "a reply to our ntl message we make a third request with the third",
    "start": "1093120",
    "end": "1100160"
  },
  {
    "text": "part of the handshake the last part if everything checks out we will get 200",
    "start": "1100160",
    "end": "1105760"
  },
  {
    "text": "ok with the full page serve yeah",
    "start": "1105760",
    "end": "1110160"
  },
  {
    "text": "in type 2 step the server sends us a nonce value and the timestamp the",
    "start": "1110799",
    "end": "1116960"
  },
  {
    "text": "nonce value is a random string and that timestamp is just timestamp",
    "start": "1116960",
    "end": "1122799"
  },
  {
    "text": "these two together they prevent",
    "start": "1122799",
    "end": "1128080"
  },
  {
    "text": "hacks where you try to replay a handshake against the server again because the",
    "start": "1128080",
    "end": "1133679"
  },
  {
    "text": "nonce value will change every time you try to negotiate with the server and",
    "start": "1133679",
    "end": "1138799"
  },
  {
    "text": "of course the timestamp also changes and you have to put those values into the",
    "start": "1138799",
    "end": "1144320"
  },
  {
    "text": "hashes the hash calculation that you do when you create your third value for the message",
    "start": "1144320",
    "end": "1149600"
  },
  {
    "text": "so therefore third message is dependent on the content in the second one",
    "start": "1149600",
    "end": "1154640"
  },
  {
    "text": "also you use the password of the client as a key when you're hashing parts of",
    "start": "1154640",
    "end": "1161280"
  },
  {
    "text": "this message so that's enough to prove to the server that i have access to",
    "start": "1161280",
    "end": "1166640"
  },
  {
    "text": "the password for this user i don't have to send the password i don't even have to send a regular hashtag",
    "start": "1166640",
    "end": "1172160"
  },
  {
    "text": "i just use it while hashing",
    "start": "1172160",
    "end": "1177440"
  },
  {
    "text": "so that makes it very secure um sure i guess you've heard about",
    "start": "1177679",
    "end": "1184400"
  },
  {
    "text": "there have been incidents related to ntlm over the years and it's not so strange it's an",
    "start": "1184400",
    "end": "1189760"
  },
  {
    "text": "authentication protocol that's been around for a very very long time but it has been improved over the years",
    "start": "1189760",
    "end": "1197440"
  },
  {
    "text": "so even though there are some that are recommending that you should move away from mtlm i think as long as you stick to the",
    "start": "1197440",
    "end": "1203919"
  },
  {
    "text": "latest version of mtlm and require the clients to use that then",
    "start": "1203919",
    "end": "1210720"
  },
  {
    "text": "you're fine at least for a test environment",
    "start": "1210720",
    "end": "1214559"
  },
  {
    "text": "okay let's talk about the plugin we'll see how cyprus behaves when we try",
    "start": "1216080",
    "end": "1223440"
  },
  {
    "text": "to access page which has which requires",
    "start": "1223440",
    "end": "1229120"
  },
  {
    "text": "authentication",
    "start": "1232840",
    "end": "1235840"
  },
  {
    "text": "all right the first test i access a page which only requires",
    "start": "1247840",
    "end": "1253440"
  },
  {
    "text": "anonymous access so that's fine in the second step i try to access a url which requires",
    "start": "1253440",
    "end": "1260880"
  },
  {
    "text": "windows authentication and the response is a 401 if i scroll down a bit",
    "start": "1260880",
    "end": "1267360"
  },
  {
    "text": "it prints out here the response message that we got and it was a 401 with a special header",
    "start": "1267360",
    "end": "1273360"
  },
  {
    "text": "that we saw before and when i describe the protocol and it says i support negotiating anti-allah so go",
    "start": "1273360",
    "end": "1280000"
  },
  {
    "text": "ahead and try to authenticate with one of those but at that stage uh cyprus doesn't do",
    "start": "1280000",
    "end": "1285520"
  },
  {
    "text": "anything more it just drops this and i will get back to why later there's a third case and that is if the",
    "start": "1285520",
    "end": "1293280"
  },
  {
    "text": "page itself doesn't require authentication but you use",
    "start": "1293280",
    "end": "1298320"
  },
  {
    "text": "a background callback to find the api value and that one in itself requires windows",
    "start": "1298320",
    "end": "1304720"
  },
  {
    "text": "authentication then the rendered data won't be what we expected",
    "start": "1304720",
    "end": "1309760"
  },
  {
    "text": "in the test",
    "start": "1309760",
    "end": "1312320"
  },
  {
    "text": "so why doesn't this work let's see we have our testronic client which is",
    "start": "1316559",
    "end": "1323760"
  },
  {
    "text": "telling the browser to navigate to our page we send a get request for a protected",
    "start": "1323760",
    "end": "1330840"
  },
  {
    "text": "page it passes through the proxy and the proxy sends it to the network",
    "start": "1330840",
    "end": "1337120"
  },
  {
    "text": "the server applies for the 401 because it doesn't know who we are yet it invites us to authenticate",
    "start": "1337120",
    "end": "1344080"
  },
  {
    "text": "and at that point the testrunner server says the test failed because we got a 401 and we can't render",
    "start": "1344159",
    "end": "1350000"
  },
  {
    "text": "this page now if we hadn't been running cyprus if we just have been running a browser",
    "start": "1350000",
    "end": "1356960"
  },
  {
    "text": "instead we would have seen authentication dialog where we should type in our username and",
    "start": "1356960",
    "end": "1362320"
  },
  {
    "text": "password because the browsers support ntln and negotiate fusion",
    "start": "1362320",
    "end": "1368480"
  },
  {
    "text": "so why doesn't this happen in when we use site well because that authentication",
    "start": "1368480",
    "end": "1373840"
  },
  {
    "text": "dialogue is a native dialogue for security reasons so the automation",
    "start": "1373840",
    "end": "1379039"
  },
  {
    "text": "tool cannot access it it cannot write anything there so if if cyprus would allow that pop-up to",
    "start": "1379039",
    "end": "1386000"
  },
  {
    "text": "about to show it could still not proceed with the tests at that point it's pretty pointless to have automated",
    "start": "1386000",
    "end": "1392640"
  },
  {
    "text": "tests where you have to manually type in your username and password in somewhere in the execution",
    "start": "1392640",
    "end": "1399440"
  },
  {
    "text": "and because of that cyprus configures all browsers that it starts to not do any such kind of authentication it has",
    "start": "1399440",
    "end": "1406640"
  },
  {
    "text": "authentication is handled by cyprus itself when it's able",
    "start": "1406640",
    "end": "1412320"
  },
  {
    "text": "so how can we make it work well we have to put another proxy",
    "start": "1413679",
    "end": "1420240"
  },
  {
    "text": "in front of cyclist process now when we navigate we get our request",
    "start": "1420240",
    "end": "1425840"
  },
  {
    "text": "going out it will pass first through the cyber proxy and then through our empty lm proxy when the ntl proxy",
    "start": "1425840",
    "end": "1433120"
  },
  {
    "text": "receives the response which is a 401 it will perform the full handshake with",
    "start": "1433120",
    "end": "1438159"
  },
  {
    "text": "the server and when the handshake is finished and we get that 200 we pass that one back",
    "start": "1438159",
    "end": "1444159"
  },
  {
    "text": "to cyprus which passes it to the browser and the test can continue so from cypress point of view uh it",
    "start": "1444159",
    "end": "1451600"
  },
  {
    "text": "doesn't even know that authentication took place here it just sent out a get request",
    "start": "1451600",
    "end": "1456720"
  },
  {
    "text": "and is happy with the responsive received",
    "start": "1456720",
    "end": "1460720"
  },
  {
    "text": "how can you make plugins in cypress and what can they do we can there is a plugin api built into",
    "start": "1462080",
    "end": "1469200"
  },
  {
    "text": "cypress where you can access and modify the configuration you can act on event callbacks but",
    "start": "1469200",
    "end": "1475840"
  },
  {
    "text": "that's a bit of a limited selection for those and you can write custom commands and a",
    "start": "1475840",
    "end": "1481200"
  },
  {
    "text": "custom command is kind of like a shortcut you can take a bunch of commands and put them into",
    "start": "1481200",
    "end": "1486720"
  },
  {
    "text": "one or like a function that you bundle with cyprus to make it a bit the test code a bit more comp",
    "start": "1486720",
    "end": "1495679"
  },
  {
    "text": "and it is possible to modify requests and responses with this built-in proxy that i",
    "start": "1495919",
    "end": "1502000"
  },
  {
    "text": "mentioned before but it isn't possible to drop responses completely to simulate the whole or to handle a",
    "start": "1502000",
    "end": "1508640"
  },
  {
    "text": "whole handshake we have to drop the 401 messages that are coming in from the server",
    "start": "1508640",
    "end": "1515279"
  },
  {
    "text": "and since we can't do that the only way to solve this is to have an external proxy",
    "start": "1515279",
    "end": "1521440"
  },
  {
    "text": "and the external proxy that i wrote is called mtlm proxy uh it has a web api which you call to",
    "start": "1522640",
    "end": "1530240"
  },
  {
    "text": "configure which ntlm hosts it should uh support and which content credentials to use for those",
    "start": "1530240",
    "end": "1538000"
  },
  {
    "text": "for any unknown host so that's a host that isn't configured as ntl and host it will forward the http traffic and it",
    "start": "1538000",
    "end": "1544799"
  },
  {
    "text": "will tunnel the https so it's just transparent proxy",
    "start": "1544799",
    "end": "1550480"
  },
  {
    "text": "for the configured host it will intercept the traffic and it will then apply anti-alan handshake when it is needed",
    "start": "1550480",
    "end": "1557200"
  },
  {
    "text": "so if it receives a 401 it will start the handshake process and",
    "start": "1557200",
    "end": "1562400"
  },
  {
    "text": "it will not return anything to surface until the negotiation is",
    "start": "1562400",
    "end": "1568559"
  },
  {
    "text": "complete yeah the handshake is done transparently to cyprus i mentioned that and uh this part the entire proxy",
    "start": "1568840",
    "end": "1577679"
  },
  {
    "text": "is usable with uh something else in proxy there's not something else inside there's nothing",
    "start": "1577679",
    "end": "1582720"
  },
  {
    "text": "that ties it to cyprus itself it could be used with selenium or any other application where you need to add ntlm",
    "start": "1582720",
    "end": "1590400"
  },
  {
    "text": "authentication support on top https traffic is a little bit tricky to",
    "start": "1590400",
    "end": "1596880"
  },
  {
    "text": "intercept to do this we have to act as a man in the middle proxy",
    "start": "1596880",
    "end": "1602159"
  },
  {
    "text": "which means that cyprus is connecting to our proxy and we act as a server towards cyprus",
    "start": "1602159",
    "end": "1608720"
  },
  {
    "text": "and our management proxy connects to the site and acts as a client to watch the site so the traffic is",
    "start": "1608720",
    "end": "1615200"
  },
  {
    "text": "encrypted between the men and middle proxy and the site and between cypress and the",
    "start": "1615200",
    "end": "1620480"
  },
  {
    "text": "netherlands but it isn't encrypted inside the management process",
    "start": "1620480",
    "end": "1626320"
  },
  {
    "text": "let us require because otherwise we couldn't know if we received a 401 message that we need to act",
    "start": "1626320",
    "end": "1631520"
  },
  {
    "text": "on to create to do the handshake this is a bit involved and you have to",
    "start": "1631520",
    "end": "1638559"
  },
  {
    "text": "also generate certificates for all the sites that you are mimicking so",
    "start": "1638559",
    "end": "1644720"
  },
  {
    "text": "i was very happy to find that there was a competent package already available it's called http proxy it's maintained",
    "start": "1644720",
    "end": "1652080"
  },
  {
    "text": "by joe berner so big kudos to him that's a big building block of the antelope proxy",
    "start": "1652080",
    "end": "1659679"
  },
  {
    "text": "i would also like to mention nico haller maintains that the mtlm client package which was a",
    "start": "1659679",
    "end": "1665919"
  },
  {
    "text": "good inspiration for me implementing the ntlm protocol and all the algorithms for that",
    "start": "1665919",
    "end": "1673200"
  },
  {
    "text": "so now we have the proxy uh how do we bundle up it up as a proper plugin well i added a launcher which",
    "start": "1674320",
    "end": "1681200"
  },
  {
    "text": "streamlines the startup because now if you want to run cyprus with windows authentication you have to start",
    "start": "1681200",
    "end": "1687360"
  },
  {
    "text": "the proxy and you have to start and these two have to know how to communicate so",
    "start": "1687360",
    "end": "1692720"
  },
  {
    "text": "they're started together and through the plugin api i inject some configurations so that",
    "start": "1692720",
    "end": "1698080"
  },
  {
    "text": "cypress will proxy all its traffic through the antenna proxy when it's coming out like this",
    "start": "1698080",
    "end": "1705760"
  },
  {
    "text": "i also added some custom commands to simplify the usage and testicles so that you can easily add",
    "start": "1705760",
    "end": "1712240"
  },
  {
    "text": "a new mtl and holds that should be included by ntl and proxy",
    "start": "1712240",
    "end": "1718398"
  },
  {
    "text": "how do you set it up well there's detailed instructions in the readme file in the repository but",
    "start": "1719600",
    "end": "1724720"
  },
  {
    "text": "let's go through it briefly you do the npn and install of course and then you configure cyprus",
    "start": "1724720",
    "end": "1731440"
  },
  {
    "text": "two files plugin file and a custom command file and then you add a few lines of scripts to packages",
    "start": "1731440",
    "end": "1739840"
  },
  {
    "text": "these are the cyprus configuration files top one is to register the plugin which modifies",
    "start": "1740159",
    "end": "1745520"
  },
  {
    "text": "the config and the bottom one adds our custom commands and here's the package",
    "start": "1745520",
    "end": "1752880"
  },
  {
    "text": "json additions these are slightly different depending on which platform you're on this is",
    "start": "1752880",
    "end": "1758559"
  },
  {
    "text": "because at the end of lm proxy should be started as a background process and",
    "start": "1758559",
    "end": "1763919"
  },
  {
    "text": "the commands to do that is uh are a bit different uh on windows than on mac os and linux",
    "start": "1763919",
    "end": "1771679"
  },
  {
    "text": "i have received a few questions in on github that's issues for my plugin where people are asking",
    "start": "1771679",
    "end": "1778480"
  },
  {
    "text": "which package json file they should add it so to me it's clear that some of the",
    "start": "1778480",
    "end": "1783919"
  },
  {
    "text": "people trying out cypress and trying out that plugin they are not really used to using node or npm",
    "start": "1783919",
    "end": "1791360"
  },
  {
    "text": "so it was a bit confusing to them and they sometimes ended up trying to edit the package.json file",
    "start": "1791360",
    "end": "1797120"
  },
  {
    "text": "within the my node modules plugin folder but of course you should add it just to the package.json in your root",
    "start": "1797120",
    "end": "1804159"
  },
  {
    "text": "project folder same folder where your nodemost folder is already installed",
    "start": "1804159",
    "end": "1810320"
  },
  {
    "text": "the custom commands that are added are these so we have the ntlm command and",
    "start": "1813360",
    "end": "1818399"
  },
  {
    "text": "ln single sign on command and the antenna and the lm command is used to add a",
    "start": "1818399",
    "end": "1825760"
  },
  {
    "text": "single host with ntlm authentication and then you pass in the specific username and password",
    "start": "1825760",
    "end": "1832960"
  },
  {
    "text": "that should be used you can if you need to you can specify which domain",
    "start": "1832960",
    "end": "1838080"
  },
  {
    "text": "that user belongs to you can specify the name of the workstation otherwise it will take the name of your current machine where",
    "start": "1838080",
    "end": "1844880"
  },
  {
    "text": "you're running the test and you can even state which ntlm version should be used",
    "start": "1844880",
    "end": "1850399"
  },
  {
    "text": "so you can force it to run in mtlm version one which you really shouldn't",
    "start": "1850399",
    "end": "1856080"
  },
  {
    "text": "be doing unless you have to for communicating with some really old legacy system because that's",
    "start": "1856080",
    "end": "1862240"
  },
  {
    "text": "that has been broken for a very long time if you need to add multiple hosts you",
    "start": "1862240",
    "end": "1867919"
  },
  {
    "text": "just call that command multiple times the ssl command is a lot simpler because",
    "start": "1867919",
    "end": "1874320"
  },
  {
    "text": "you don't need to add any credentials this will do a single sign-on using the same user that you'd log on to the",
    "start": "1874320",
    "end": "1880399"
  },
  {
    "text": "machine so you just specify a list of hosts",
    "start": "1880399",
    "end": "1886640"
  },
  {
    "text": "or sub-domains which should be accepted for single sign-on so if",
    "start": "1886640",
    "end": "1893760"
  },
  {
    "text": "uh the proxy detects any 401 messages on from any of those piece holes it will",
    "start": "1893760",
    "end": "1899279"
  },
  {
    "text": "initiate a handshake using single sign another benefit of the single sign-on is",
    "start": "1899279",
    "end": "1905200"
  },
  {
    "text": "that it actually even supports negotiate because it uses",
    "start": "1905200",
    "end": "1910880"
  },
  {
    "text": "internal windows api calls to perform the single sign-on and those support both mtl and",
    "start": "1910880",
    "end": "1920000"
  },
  {
    "text": "the drawback is that it's not available unless you're running on windows because we're using windows api so it's",
    "start": "1920000",
    "end": "1925840"
  },
  {
    "text": "quite clear and you're only logged on as an active directory user to the machine if you're on windows so",
    "start": "1925840",
    "end": "1933200"
  },
  {
    "text": "also in that sense it wouldn't really make sense to try to do things i know from a lot of that",
    "start": "1933200",
    "end": "1939360"
  },
  {
    "text": "this is a cleanup call it will remove all the configuration and it will also close any uh open connections that are ongoing",
    "start": "1940240",
    "end": "1948399"
  },
  {
    "text": "to any of these holes that you have configured so that's a good practice to put that in",
    "start": "1948399",
    "end": "1954320"
  },
  {
    "text": "and before each statement when all this is set up and done you can",
    "start": "1954320",
    "end": "1961120"
  },
  {
    "text": "simply do npm run cyprus and tlm to start so let's see it",
    "start": "1961120",
    "end": "1977840"
  },
  {
    "text": "now i know that when you're on the stream connection this might just look like a blur and it probably did because it ran eight",
    "start": "1991039",
    "end": "1997600"
  },
  {
    "text": "different tests in three seconds i think that's it's kind of impressive because you're",
    "start": "1997600",
    "end": "2003600"
  },
  {
    "text": "it's a full web browser you're loading a full page even though it's a rather simple one and you're doing some assertions or",
    "start": "2003600",
    "end": "2010320"
  },
  {
    "text": "typing or clicking on those pages and still you can execute eight tests in such a short time frame",
    "start": "2010320",
    "end": "2015840"
  },
  {
    "text": "that's uh really nice performance with cyprus let's look at first one where we needed",
    "start": "2015840",
    "end": "2022799"
  },
  {
    "text": "to do sign in so we go to our authenticated web page by clicking on the authenticated tab here",
    "start": "2022799",
    "end": "2031120"
  },
  {
    "text": "and it will just pass in i just added this to the page so it's clearer that we're logged in or if we're",
    "start": "2031120",
    "end": "2037760"
  },
  {
    "text": "not logging so you can see the status according to the server but from cyprus perspective it doesn't",
    "start": "2037760",
    "end": "2044080"
  },
  {
    "text": "really know that something happened in the background the only sign of it is that here we call",
    "start": "2044080",
    "end": "2049280"
  },
  {
    "text": "this psi ntln command to add this host to our pool of host that we will apply",
    "start": "2049280",
    "end": "2056480"
  },
  {
    "text": "and tell them authentication singles hang on case is similar it's",
    "start": "2056480",
    "end": "2061839"
  },
  {
    "text": "just that we can do it a bit simpler we do a wild card with subdomain",
    "start": "2061839",
    "end": "2069200"
  },
  {
    "text": "here we have multiple sites uh when we both need to authenticate to something on the page and we need to",
    "start": "2070720",
    "end": "2076878"
  },
  {
    "text": "authenticate to an api we have both of them here as two calls",
    "start": "2076879",
    "end": "2083679"
  },
  {
    "text": "and with sso we it would have been just one",
    "start": "2083839",
    "end": "2088878"
  },
  {
    "text": "since it's a one card all right looking good",
    "start": "2088879",
    "end": "2095040"
  },
  {
    "text": "let's review some code from this demo",
    "start": "2097119",
    "end": "2103838"
  },
  {
    "text": "this is the source code file let me zoom in a little bit",
    "start": "2103920",
    "end": "2109039"
  },
  {
    "text": "so the first case that we looked at where was this one you called psi ntlm",
    "start": "2110560",
    "end": "2117200"
  },
  {
    "text": "and you set the hostname username password and domain",
    "start": "2117200",
    "end": "2122720"
  },
  {
    "text": "i like to keep those separated in an environment file",
    "start": "2122720",
    "end": "2127920"
  },
  {
    "text": "there's two reasons one thing is that i probably you need to use different users when i'm",
    "start": "2127920",
    "end": "2133200"
  },
  {
    "text": "running this in different domains so i need to inject that in my ci and secondly",
    "start": "2133200",
    "end": "2139200"
  },
  {
    "text": "i like to keep my test files together with my source code in git and you shouldn't really be",
    "start": "2139200",
    "end": "2145760"
  },
  {
    "text": "committing user credentials to get even if it's just testing accounts so i think it helps both ways there",
    "start": "2145760",
    "end": "2153839"
  },
  {
    "text": "to use those this picks up either normal environment variables or if you're running locally you can",
    "start": "2153839",
    "end": "2160240"
  },
  {
    "text": "have a file like this cyprus and json json which will",
    "start": "2160240",
    "end": "2165680"
  },
  {
    "text": "specify those on your machine i've added this to git ignore so it doesn't follow into game",
    "start": "2165680",
    "end": "2173839"
  },
  {
    "text": "okay that was this with one host that was the single sign-on case",
    "start": "2174640",
    "end": "2182559"
  },
  {
    "text": "and this was with two hosts one at the other there's also intellisense if you've",
    "start": "2182880",
    "end": "2188400"
  },
  {
    "text": "forgotten something about the syntax of these gloves",
    "start": "2188400",
    "end": "2193119"
  },
  {
    "text": "okay let me talk about a few challenges that i faced while i was developing this plugin",
    "start": "2197599",
    "end": "2204720"
  },
  {
    "text": "mtlm keeps its session state through an open tcp socket this means that",
    "start": "2206079",
    "end": "2213200"
  },
  {
    "text": "the tcp socket needs to be opened and kept alive during the whole handshake otherwise the session is lost then you",
    "start": "2213200",
    "end": "2220079"
  },
  {
    "text": "have to start over and know there are multiple keep alive concepts there is",
    "start": "2220079",
    "end": "2225119"
  },
  {
    "text": "a keep alive concept for the agent it's handling request and there's a",
    "start": "2225119",
    "end": "2230720"
  },
  {
    "text": "keeper like concept for the http connection which is in headers so",
    "start": "2230720",
    "end": "2236800"
  },
  {
    "text": "i had to figure this out to put those together in the right way to get it working and i think the worst",
    "start": "2236800",
    "end": "2245119"
  },
  {
    "text": "challenge was this one the only thing that you get back when you fail to authenticate",
    "start": "2245119",
    "end": "2250720"
  },
  {
    "text": "is for one message no explanation that makes it extremely frustrating to",
    "start": "2250720",
    "end": "2256960"
  },
  {
    "text": "debug authentication issues of course there's a good reason for this",
    "start": "2256960",
    "end": "2262640"
  },
  {
    "text": "but you shouldn't share more information than necessary in air responses",
    "start": "2262640",
    "end": "2268400"
  },
  {
    "text": "especially when it comes to critical things like authentication so i i have understanding for this but still",
    "start": "2268400",
    "end": "2275599"
  },
  {
    "text": "it's uh it makes life difficult as a developer when you're trying to implement uh authentication",
    "start": "2275599",
    "end": "2285839"
  },
  {
    "text": "that i've been helping several users remotely through github issues",
    "start": "2286079",
    "end": "2292480"
  },
  {
    "text": "we've been trying to get work started with the plugin that's also really quite demanding to do",
    "start": "2292480",
    "end": "2298320"
  },
  {
    "text": "this kind of troubleshooting since um they only have this 401 response to share with me",
    "start": "2298320",
    "end": "2305280"
  },
  {
    "text": "i had to add quite a lot of extensive debug log functionality to their lm proxy to be able to help them better",
    "start": "2305280",
    "end": "2313839"
  },
  {
    "text": "and lastly there are several ntlm client implementations available as open source which you can use for",
    "start": "2314960",
    "end": "2321440"
  },
  {
    "text": "inspiration but there's really nothing much when it comes to the server side",
    "start": "2321440",
    "end": "2326720"
  },
  {
    "text": "and that makes the testing harder of course i think the point two the one that you",
    "start": "2326720",
    "end": "2333119"
  },
  {
    "text": "only get for these responses it would have been easier to work with that if there was an open source",
    "start": "2333119",
    "end": "2338160"
  },
  {
    "text": "server-side solution where i could debug and see where is it failing which part of the entire message",
    "start": "2338160",
    "end": "2343920"
  },
  {
    "text": "is deleting copy but that's how it goes",
    "start": "2343920",
    "end": "2348960"
  },
  {
    "text": "okay coming into the final part we've now handled windows authentication",
    "start": "2351040",
    "end": "2356880"
  },
  {
    "text": "at least for cyprus and end-to-end usage so let's proceed with corporate",
    "start": "2356880",
    "end": "2364079"
  },
  {
    "text": "certificates i mentioned in the beginning that if i try to do the m10 install",
    "start": "2364079",
    "end": "2369760"
  },
  {
    "text": "on a machine in my organization this is what i get i get an error for a self-signed",
    "start": "2369760",
    "end": "2375440"
  },
  {
    "text": "certificate in chain if you're working in a corporate organization",
    "start": "2375440",
    "end": "2381200"
  },
  {
    "text": "you probably know the drill this is somehow and it ended up in a ssl",
    "start": "2381200",
    "end": "2387359"
  },
  {
    "text": "decryption device and you might apply to the infrastructure team that they should add",
    "start": "2387359",
    "end": "2394240"
  },
  {
    "text": "this host name to the exception list but uh corporate organizations are usually a",
    "start": "2394240",
    "end": "2400320"
  },
  {
    "text": "bit bureaucratic so this means you have to speak with several managers and some of them don't really know what you're",
    "start": "2400320",
    "end": "2406000"
  },
  {
    "text": "talking about let's say that you you pull that off and finally made them to put this on the",
    "start": "2406000",
    "end": "2413040"
  },
  {
    "text": "exception list and install site express then once",
    "start": "2413040",
    "end": "2418880"
  },
  {
    "text": "then you try to install cyprus and boom you get the same error again",
    "start": "2420000",
    "end": "2425760"
  },
  {
    "text": "but in another variant also here we have the self-signed certificate",
    "start": "2425760",
    "end": "2431520"
  },
  {
    "text": "why because cyprus will download additional binaries it",
    "start": "2431520",
    "end": "2437599"
  },
  {
    "text": "won't only take things from the mpm repository it will also take things from their own repository",
    "start": "2437599",
    "end": "2443440"
  },
  {
    "text": "this is not uncommon among packages to fetch additional data from",
    "start": "2443440",
    "end": "2449200"
  },
  {
    "text": "other sources so i think you realize now that this is not a viable solution to keep adding",
    "start": "2449200",
    "end": "2455280"
  },
  {
    "text": "things to uh exceptionalist there's got to be a better way",
    "start": "2455280",
    "end": "2460640"
  },
  {
    "text": "first let's try to understand the problem so node.js is running behind the corporate firewall",
    "start": "2462000",
    "end": "2467839"
  },
  {
    "text": "which introduces the corporate certificate as a corporate firewall commonly applies https inspection",
    "start": "2467839",
    "end": "2475760"
  },
  {
    "text": "https inspection is nothing less than what we mentioned",
    "start": "2475760",
    "end": "2481280"
  },
  {
    "text": "before it's actually a man in the middle proxy where you decrypt the traffic to to analyze it and then you encrypt it",
    "start": "2481280",
    "end": "2487520"
  },
  {
    "text": "again with a new certificate before you pass it on to the client so if you don't have hgbs inspection and",
    "start": "2487520",
    "end": "2494640"
  },
  {
    "text": "you go to a site from stack exchange you can check at the certification path see that the root",
    "start": "2494640",
    "end": "2500560"
  },
  {
    "text": "certificate is from digicert which is a well-known certificate authority and then there's an intermediary set",
    "start": "2500560",
    "end": "2507200"
  },
  {
    "text": "in between that's pretty common standard setup but with https inspection",
    "start": "2507200",
    "end": "2514720"
  },
  {
    "text": "the root certificate and the intermediate certificate are replaced",
    "start": "2514720",
    "end": "2519920"
  },
  {
    "text": "this is because that's required when we decode it and uh in the https inspection in the",
    "start": "2520560",
    "end": "2528079"
  },
  {
    "text": "little proxy we have to replace it with something else because we have to encode it again we don't have the private key that is",
    "start": "2528079",
    "end": "2535839"
  },
  {
    "text": "used by stack exchange to simulate what they're doing",
    "start": "2535839",
    "end": "2540720"
  },
  {
    "text": "digicept as a well-known ca is known by browsers and by node so they trust it by default",
    "start": "2541119",
    "end": "2550400"
  },
  {
    "text": "our corporate certificate the bank of evil root ca is probably installed in our machines",
    "start": "2550400",
    "end": "2558560"
  },
  {
    "text": "certificate store so that will be trusted by the browser but that doesn't mean that it will be",
    "start": "2558560",
    "end": "2564960"
  },
  {
    "text": "trusted by no actually why because node doesn't use the",
    "start": "2564960",
    "end": "2570240"
  },
  {
    "text": "computer certificate store now it has its own certificate store for",
    "start": "2570240",
    "end": "2576839"
  },
  {
    "text": "case so how can we work around that well there's the the shortcut",
    "start": "2576839",
    "end": "2584880"
  },
  {
    "text": "the sheeting way we set this environment variable node tls reject unauthorized to zero",
    "start": "2584880",
    "end": "2591440"
  },
  {
    "text": "and then you have disabled all your certificate checks in node i",
    "start": "2591440",
    "end": "2597760"
  },
  {
    "text": "i sometimes do this just for verifying that uh the errors that i'm getting are",
    "start": "2597760",
    "end": "2603839"
  },
  {
    "text": "really come originating from a stupid error in node but please remove it directly after you",
    "start": "2603839",
    "end": "2611359"
  },
  {
    "text": "made that check because this disables very important safety features of https",
    "start": "2611359",
    "end": "2619200"
  },
  {
    "text": "anyone can act as any https site to your node implementation when",
    "start": "2619200",
    "end": "2624800"
  },
  {
    "text": "you have this on my recommended approach is to use",
    "start": "2624800",
    "end": "2631280"
  },
  {
    "text": "another environment variable called node extra ca sets and this variable should point to the full",
    "start": "2631280",
    "end": "2638240"
  },
  {
    "text": "path of a file which should contain a ca certificate",
    "start": "2638240",
    "end": "2644079"
  },
  {
    "text": "in payment format or it could be a bundle so you can concatenate together a few ca certificates if you need",
    "start": "2644079",
    "end": "2652079"
  },
  {
    "text": "and this will tell node to accept any certificates that are issued by any of those cas note that this requires",
    "start": "2652079",
    "end": "2661119"
  },
  {
    "text": "that you have full c8 chain you cannot just put in a self-signed certificate in this",
    "start": "2661119",
    "end": "2667760"
  },
  {
    "text": "extra ca such path you have to have full chain so how do you get hold",
    "start": "2667760",
    "end": "2677040"
  },
  {
    "text": "of that certificate that we can add to this environment variable",
    "start": "2677040",
    "end": "2683200"
  },
  {
    "text": "let's say that this is the site where https inspection is applied then we can click",
    "start": "2683200",
    "end": "2690079"
  },
  {
    "text": "on the padlock and then we click on certificate and here we have input dialog for the",
    "start": "2690079",
    "end": "2695359"
  },
  {
    "text": "certificate we click on certification path and there's the hierarchy",
    "start": "2695359",
    "end": "2701040"
  },
  {
    "text": "we go to the root certificate and click use element now we have another input dialog for the",
    "start": "2701040",
    "end": "2707839"
  },
  {
    "text": "certificate we go to the details tab and click copy to file",
    "start": "2707839",
    "end": "2713440"
  },
  {
    "text": "that starts the wizard you can use default the default options except in this page you have to select base64 encoded x509",
    "start": "2713520",
    "end": "2721760"
  },
  {
    "text": "for it to be compatible with node and then you select where to store it",
    "start": "2721760",
    "end": "2728400"
  },
  {
    "text": "you can choose whatever you want as long as you take note of this path and this is the path that you should",
    "start": "2728400",
    "end": "2734000"
  },
  {
    "text": "then put into the environment variable node extra css and then you're good to go there is",
    "start": "2734000",
    "end": "2742079"
  },
  {
    "text": "another more general solution there's a npm package called win ca and this one loads all the cash from the",
    "start": "2742079",
    "end": "2750000"
  },
  {
    "text": "windows search store and makes them available to know for https connections so that sounds",
    "start": "2750000",
    "end": "2755839"
  },
  {
    "text": "great right you just do npm install in ca and then you require it in your application",
    "start": "2755839",
    "end": "2762480"
  },
  {
    "text": "but what's the catch here well uh we needed the csf to be",
    "start": "2762480",
    "end": "2769119"
  },
  {
    "text": "configured before we even could do npm install so we can't even install this package if we",
    "start": "2769119",
    "end": "2774640"
  },
  {
    "text": "haven't done the previous configuration steps of course you can work around that you can download this package manually and",
    "start": "2774640",
    "end": "2781680"
  },
  {
    "text": "install it from a file but still you're stuck with having to put this require statement in all the",
    "start": "2781680",
    "end": "2787520"
  },
  {
    "text": "applications where you need to have https access i think this can work fine if you have a",
    "start": "2787520",
    "end": "2794800"
  },
  {
    "text": "pre-packaged application that already uses it like electron solution or something",
    "start": "2794800",
    "end": "2800720"
  },
  {
    "text": "then it's great but uh generally when you're start you're starting up with node",
    "start": "2800720",
    "end": "2805839"
  },
  {
    "text": "it won't be much health country okay that was the scoped certificate and",
    "start": "2805839",
    "end": "2812079"
  },
  {
    "text": "finally the proxy so the proxy settings that you should pass to to know",
    "start": "2812079",
    "end": "2818079"
  },
  {
    "text": "are these http proxy environment variable set that to the proxy url https",
    "start": "2818079",
    "end": "2825599"
  },
  {
    "text": "proxy environment variable it's only needed if you have a specific url",
    "start": "2825599",
    "end": "2830720"
  },
  {
    "text": "for https traffic otherwise it will automatically choose use as url from https",
    "start": "2830720",
    "end": "2838480"
  },
  {
    "text": "and then you have no proxy where you can add exceptions this is pretty important because you",
    "start": "2840079",
    "end": "2846240"
  },
  {
    "text": "usually don't want that traffic to local host is passed to the proxy first",
    "start": "2846240",
    "end": "2852400"
  },
  {
    "text": "you want that to go to stay internally on your machine and probably also want to exclude any",
    "start": "2852400",
    "end": "2858160"
  },
  {
    "text": "internet sites because you're not going up to the internet so you don't need to go to the proxy",
    "start": "2858160",
    "end": "2863280"
  },
  {
    "text": "so it helps with performance and also i think it won't even work for some scenarios if you proxy the wrong",
    "start": "2863280",
    "end": "2870839"
  },
  {
    "text": "things in our organization we actually don't have the need for setting up the http ux",
    "start": "2870839",
    "end": "2877440"
  },
  {
    "text": "https proxy so maybe you do maybe you don't you will know if you you try to use",
    "start": "2877440",
    "end": "2884640"
  },
  {
    "text": "cyprus nvc that it cannot access any external resources that you try to load so then you know",
    "start": "2884640",
    "end": "2890480"
  },
  {
    "text": "where to start looking",
    "start": "2890480",
    "end": "2893359"
  },
  {
    "text": "there's a bonus here single sign-on this isn't directly related to the node pain points",
    "start": "2896000",
    "end": "2902559"
  },
  {
    "text": "or antenna testing but uh it's a developer pain point at least for me when you have a corporate",
    "start": "2902559",
    "end": "2910960"
  },
  {
    "text": "environment you usually have a pretty good setup in your production environment where you're",
    "start": "2910960",
    "end": "2916079"
  },
  {
    "text": "getting single sign-on experience to all your internet websites you don't need to enter your",
    "start": "2916079",
    "end": "2921680"
  },
  {
    "text": "username and password anywhere except when signing on to the machine but then when you're moving to a",
    "start": "2921680",
    "end": "2929599"
  },
  {
    "text": "test environment or development environment you usually don't have that luxury anymore and",
    "start": "2929599",
    "end": "2936480"
  },
  {
    "text": "maybe you didn't know i care to figure out why but i think over the years",
    "start": "2936480",
    "end": "2943040"
  },
  {
    "text": "quite a lot of login prompts you can save some time by getting single sign-on to work in other",
    "start": "2943040",
    "end": "2948400"
  },
  {
    "text": "environments too and the trick here is trusted sites so",
    "start": "2948400",
    "end": "2953839"
  },
  {
    "text": "in the internet options in windows you can add trusted sites right",
    "start": "2953839",
    "end": "2958880"
  },
  {
    "text": "and trust sites will allow the browser to use a single",
    "start": "2958880",
    "end": "2965040"
  },
  {
    "text": "sign-on authentication when trying to go there it could be the case that",
    "start": "2965040",
    "end": "2970400"
  },
  {
    "text": "you're not allowed to address the types yourself they could be managed by gpo in this case you can ask your",
    "start": "2970400",
    "end": "2976400"
  },
  {
    "text": "infrastructure team to have them um usually this will be domain specific",
    "start": "2976400",
    "end": "2982240"
  },
  {
    "text": "you don't want to have the development domains seeing asylum enabled on",
    "start": "2982240",
    "end": "2988319"
  },
  {
    "text": "production computers that you want to keep that together so that development domain computers will have singles and",
    "start": "2988319",
    "end": "2994640"
  },
  {
    "text": "on to development domain sites and so on this works fine for internet",
    "start": "2994640",
    "end": "3001280"
  },
  {
    "text": "explorer edge in chrome because they all pick up these settings firefox has its own configuration for",
    "start": "3001280",
    "end": "3007440"
  },
  {
    "text": "single sign-on you can look that up if you need it",
    "start": "3007440",
    "end": "3013599"
  },
  {
    "text": "so the main takeaways from today's session if you want to use cypress with windows",
    "start": "3013599",
    "end": "3019040"
  },
  {
    "text": "authentication use my plugin cyprus and tlm or if you need to use node.js in a",
    "start": "3019040",
    "end": "3026079"
  },
  {
    "text": "corporate environment then make sure you handle your corporate certificates",
    "start": "3026079",
    "end": "3031280"
  },
  {
    "text": "and process settings and then you're good to go",
    "start": "3031280",
    "end": "3036000"
  },
  {
    "text": "thank you very much for attending my session and also special thanks for to the nbc",
    "start": "3037599",
    "end": "3044000"
  },
  {
    "text": "organizers for letting me speak here this is my first session as a speaker",
    "start": "3044000",
    "end": "3050319"
  },
  {
    "text": "on a larger developer conference and it's been an honor to uh to get this opportunity so thanks very",
    "start": "3050319",
    "end": "3056640"
  },
  {
    "text": "much uh all the slides are available in the link here and you can find source code for the demos that",
    "start": "3056640",
    "end": "3062240"
  },
  {
    "text": "i showed a link to my plugin and my contact details",
    "start": "3062240",
    "end": "3067839"
  },
  {
    "text": "thanks again",
    "start": "3067839",
    "end": "3070960"
  }
]