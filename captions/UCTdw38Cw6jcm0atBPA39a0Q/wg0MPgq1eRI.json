[
  {
    "text": "hello everyone i hope you're all having a good day i think there are quite a few of you out there i have",
    "start": "8000",
    "end": "14320"
  },
  {
    "text": "lights in my eyes i can't actually see anything and i have a podium made for a hobbit but well i'll make it do and make",
    "start": "14320",
    "end": "19520"
  },
  {
    "text": "it work um so you're i i assume you're here for the asp.net talk about going",
    "start": "19520",
    "end": "25199"
  },
  {
    "text": "beyond the introduction if not sucks to be um my name is chris klogg i",
    "start": "25199",
    "end": "32160"
  },
  {
    "text": "work at a company called active solution in stockholm where we do custom software development for the microsoft platform",
    "start": "32160",
    "end": "38239"
  },
  {
    "text": "um i've been doing microsoft development since 1999 or something like that quite a",
    "start": "38239",
    "end": "45280"
  },
  {
    "text": "quite a while now um and um had a special instrument its interest in asp.net",
    "start": "45280",
    "end": "51600"
  },
  {
    "text": "actually i started out in classical asp has anybody tried programming classic asp",
    "start": "51600",
    "end": "56960"
  },
  {
    "text": "okay this is this is cool people there are older folks to the crowd i'm sorry to say but you're my age now so",
    "start": "56960",
    "end": "63120"
  },
  {
    "text": "um yeah so i i followed asp.net cli isp classic into espnet and then into smart core and",
    "start": "63120",
    "end": "70159"
  },
  {
    "text": "i've enjoyed doing that i actually managed to become microsoft mvp on the internet core stack so i get to see some",
    "start": "70159",
    "end": "76880"
  },
  {
    "text": "of the stuff from the team's point of view as well enough about me",
    "start": "76880",
    "end": "82159"
  },
  {
    "text": "time for demos i have no more slides actually i do i have a thank you slide at the end but that's it other than that we have code",
    "start": "82159",
    "end": "88479"
  },
  {
    "text": "so i want to highlight one thing about this session today though it terrifies me",
    "start": "88479",
    "end": "96159"
  },
  {
    "text": "it is really really complicated there are so many moving parts i've made last minute updates to it",
    "start": "96159",
    "end": "102000"
  },
  {
    "text": "but i hope it's gonna work i have no idea why you're not seeing my screen though",
    "start": "102000",
    "end": "108000"
  },
  {
    "text": "that that didn't work out very well okay so while the crew tries to figure",
    "start": "108720",
    "end": "113920"
  },
  {
    "text": "out why there's no nothing on the screen because that we can all i can do like this",
    "start": "113920",
    "end": "120079"
  },
  {
    "text": "so if you all look very closely or maybe i can get my phone up and stream it on twitch and you can all zoom",
    "start": "120719",
    "end": "127280"
  },
  {
    "text": "into that or something um",
    "start": "127280",
    "end": "130959"
  },
  {
    "text": "so mine is so pc screen only that is turned on right",
    "start": "136800",
    "end": "143280"
  },
  {
    "text": "now actually wait a minute wait wait it went into pc screen only after",
    "start": "143280",
    "end": "148640"
  },
  {
    "text": "after oh thank you it was it wasn't his fault it was my fault sorry about that that took two minutes out of my time",
    "start": "148640",
    "end": "154400"
  },
  {
    "text": "that i didn't have to get away get rid of anyhow this is what i'm going to be working with to begin with this is a very very simple website",
    "start": "154400",
    "end": "160560"
  },
  {
    "text": "about fantastic female people throughout history and you can go into this and have more information",
    "start": "160560",
    "end": "166800"
  },
  {
    "text": "about hedley lamar for example what annoys me about this little website here is this isn't very visible i think",
    "start": "166800",
    "end": "173760"
  },
  {
    "text": "i can do like this to show you i dislike the the urls up here so it's",
    "start": "173760",
    "end": "180080"
  },
  {
    "text": "slash user slash one not a fantastic url i wanna have something more seo friendly and",
    "start": "180080",
    "end": "186319"
  },
  {
    "text": "that's my first thing to tackle in this project i'm gonna go and get better naming or better urls so i got this",
    "start": "186319",
    "end": "192080"
  },
  {
    "text": "project here can everybody can you in the back see this code",
    "start": "192080",
    "end": "198480"
  },
  {
    "text": "cool okay it's a very simple mvc site there's nothing impressive in here at all so",
    "start": "198480",
    "end": "204000"
  },
  {
    "text": "what we can do here is we can plug straight into the application request pipeline",
    "start": "204000",
    "end": "209360"
  },
  {
    "text": "i did say the talk was beyond the introduction for some of you this might be obvious that you can plug into the",
    "start": "209360",
    "end": "215200"
  },
  {
    "text": "pipeline and modify things some of you it might not be trust me there will be more complex part at the end if you",
    "start": "215200",
    "end": "221040"
  },
  {
    "text": "think this is too simple but what we can do here is we can add a middleware in here",
    "start": "221040",
    "end": "227360"
  },
  {
    "text": "so we can do inline middlewares i just need to add a i user's repository for it",
    "start": "227360",
    "end": "233120"
  },
  {
    "text": "here so i can read out my users but the cool thing about the request pipeline that most people apparently",
    "start": "233120",
    "end": "238560"
  },
  {
    "text": "don't understand is that the req context request stop the context object or the",
    "start": "238560",
    "end": "244239"
  },
  {
    "text": "request objects in here are actually read write lots of the properties are readable and writeable so you can go and",
    "start": "244239",
    "end": "250159"
  },
  {
    "text": "modify them which means that i can quite easily go into my request pipeline and look at this and go for the path remove",
    "start": "250159",
    "end": "256160"
  },
  {
    "text": "the slash at the beginning have a look at the length of that if it's only a slash then i don't want to",
    "start": "256160",
    "end": "261759"
  },
  {
    "text": "look at it otherwise get substring 1",
    "start": "261759",
    "end": "266840"
  },
  {
    "text": "replace look at the replace the dash with a single quote so",
    "start": "266840",
    "end": "273440"
  },
  {
    "text": "basically it looks at the name of what you're passing in so if the path is slash grace dash",
    "start": "273440",
    "end": "280720"
  },
  {
    "text": "who was grace hopper sorry it goes grace hopper remove the dash between grace and",
    "start": "280720",
    "end": "287919"
  },
  {
    "text": "hopper figure out grace hopper's id and then replace the request path with users",
    "start": "287919",
    "end": "294639"
  },
  {
    "text": "slash id which means that i can pass in a name it changes the path and when i call the next request",
    "start": "294639",
    "end": "300880"
  },
  {
    "text": "pipeline the rest next middleware it will have the new path in there and then on the way back out again i just reset",
    "start": "300880",
    "end": "306639"
  },
  {
    "text": "the path back to the original path so any any middleware coming before me will have the original path to work with",
    "start": "306639",
    "end": "314080"
  },
  {
    "text": "this is kind of nice because it means that i can do things like i can modify whatever request",
    "start": "314080",
    "end": "320400"
  },
  {
    "text": "i want so basically i can look at changing whatever url whatever path i want if i go back out here we can now",
    "start": "320400",
    "end": "326000"
  },
  {
    "text": "change this into heady if i get a slash in there",
    "start": "326000",
    "end": "332240"
  },
  {
    "text": "that didn't turn out very well it's supposed to be there heady dash lamar and that works as well so now all",
    "start": "332240",
    "end": "339360"
  },
  {
    "text": "of a sudden i can have nice urls uh which is cool the only thing if we start building our middlewares and we do",
    "start": "339360",
    "end": "345280"
  },
  {
    "text": "this for every single middleware that we want we're going to end up with a really ugly and complicated startup cs file so",
    "start": "345280",
    "end": "352000"
  },
  {
    "text": "we want to make this quite nice or nicer at least by adding our own custom middleware so i'm just going to go and",
    "start": "352000",
    "end": "358160"
  },
  {
    "text": "add a folder in here middle where's",
    "start": "358160",
    "end": "364960"
  },
  {
    "text": "inside middlewares i'm going to add a new class",
    "start": "364960",
    "end": "369039"
  },
  {
    "text": "class is going to be called name routing middleware i'm going to replace that",
    "start": "370080",
    "end": "376720"
  },
  {
    "text": "i only work for clients that need stuff i already have snippets for",
    "start": "376720",
    "end": "381840"
  },
  {
    "text": "it makes life much easier i can charge for an hour and it took me three seconds to do fantastic work",
    "start": "381840",
    "end": "388080"
  },
  {
    "text": "so this is a middleware if you haven't seen one before they're quite cool they're a class they don't need to inherit from anything they don't need to",
    "start": "388080",
    "end": "394720"
  },
  {
    "text": "implement any interface or anything like that it's just a class and it has to have a method called invoke a sync",
    "start": "394720",
    "end": "402319"
  },
  {
    "text": "returning a task and accepting an http context that's it that makes it a",
    "start": "402319",
    "end": "407919"
  },
  {
    "text": "middleware it also supports dependence injection so i can always go and say i users and get my user's",
    "start": "407919",
    "end": "415280"
  },
  {
    "text": "repository passed in like that then i can go back out here and i can",
    "start": "415280",
    "end": "421120"
  },
  {
    "text": "take all of this code here cut that out of here",
    "start": "421120",
    "end": "426160"
  },
  {
    "text": "paste it into my invoke async method replace this little call here for next",
    "start": "426160",
    "end": "433360"
  },
  {
    "text": "so what we do with a weight next is basically when we call our weight next it's going to send the request on",
    "start": "433360",
    "end": "438720"
  },
  {
    "text": "through the pipeline for any other middleware downstream and then when it comes back up this thing here is going",
    "start": "438720",
    "end": "444319"
  },
  {
    "text": "to be after all the other middlewares have executed so this is on the way back out again so i get that in there",
    "start": "444319",
    "end": "450400"
  },
  {
    "text": "and all of a sudden i can make this a little bit nicer by having dot use",
    "start": "450400",
    "end": "455440"
  },
  {
    "text": "middleware i can go name routing middleware",
    "start": "455440",
    "end": "462240"
  },
  {
    "text": "missing a letter here missing quite a few stuff here middleware",
    "start": "462240",
    "end": "467520"
  },
  {
    "text": "using like that looks a little bit better right than having that whole chunk of code",
    "start": "467919",
    "end": "474639"
  },
  {
    "text": "which then turns into more chunks of code which turns into lots of chunks of code and then all of a sudden your startup cs file is is long",
    "start": "474639",
    "end": "482319"
  },
  {
    "text": "thousands of rows which is just fantastic however if you're used to working with asp.net core you know that we have these",
    "start": "482319",
    "end": "489280"
  },
  {
    "text": "use static files use routing looks much much nicer than use middleware of t blah",
    "start": "489280",
    "end": "495919"
  },
  {
    "text": "blah blah which is quite easy to fix as well for me so another class",
    "start": "495919",
    "end": "502800"
  },
  {
    "text": "going middleware extensions",
    "start": "502879",
    "end": "508199"
  },
  {
    "text": "extensions it's hard to see up here there it is and for middleware extensions i'm going to",
    "start": "508840",
    "end": "514880"
  },
  {
    "text": "do it's going to be an extension method so it needs to be a static class",
    "start": "514880",
    "end": "520159"
  },
  {
    "text": "it doesn't spell like that study class and then i can add this simple helper method here that's called name route use",
    "start": "520159",
    "end": "526720"
  },
  {
    "text": "name routing username routing is an extension on i application builder and it just calls that same use middleware",
    "start": "526720",
    "end": "534000"
  },
  {
    "text": "call that i had previously now it's very tempting to go in here and say i'm just going to go ctrl dot and",
    "start": "534000",
    "end": "540560"
  },
  {
    "text": "add using for a microsoft asp.net core builder i'm not going to do that instead",
    "start": "540560",
    "end": "546880"
  },
  {
    "text": "i'm going to go and i'm going to change my namespace here to microsoft",
    "start": "546880",
    "end": "553440"
  },
  {
    "text": "microsoft.asp.net core dot builder and then i'm going to add a using statement for my own middleware instead",
    "start": "554360",
    "end": "562480"
  },
  {
    "text": "like that and the reason for inverting that and using microsoft's namespace is that i",
    "start": "562480",
    "end": "568080"
  },
  {
    "text": "know that the microsoft asp.net core builder namespace is going to be used inside of this or you have a using",
    "start": "568080",
    "end": "574560"
  },
  {
    "text": "statement inside of startup.cs already because well i am using the i application builder in here which means",
    "start": "574560",
    "end": "581200"
  },
  {
    "text": "that anybody pulling in my class will automatically have",
    "start": "581200",
    "end": "588000"
  },
  {
    "text": "use name routing without having to add any extra using statements to get the extension method to work",
    "start": "588080",
    "end": "595040"
  },
  {
    "text": "like that so if i run this we should have pretty much the same",
    "start": "595040",
    "end": "600320"
  },
  {
    "text": "thing i had before i can go in here i can go to this tab here i can refresh lamar and i got hedy lamarr and if i",
    "start": "600320",
    "end": "607440"
  },
  {
    "text": "change hedy lamarr to some other fantastic woman like grace hopper",
    "start": "607440",
    "end": "613839"
  },
  {
    "text": "that works as well and i get grace hopper fine there's a little problem with this code though uh the astute attendee here might",
    "start": "613839",
    "end": "620640"
  },
  {
    "text": "have figured out that if i go back and i point at one of these things here you can't quite see it but in the down left",
    "start": "620640",
    "end": "626160"
  },
  {
    "text": "corner here it says slash user slash one so since i'm only rewriting the urls or",
    "start": "626160",
    "end": "632320"
  },
  {
    "text": "the paths coming in then all of my existing urls or paths are going to be wrong right so all links",
    "start": "632320",
    "end": "638399"
  },
  {
    "text": "are going to point to the wrong place and i could fix that i could go into my code and i could replace all of these places and go and say this is going to",
    "start": "638399",
    "end": "644560"
  },
  {
    "text": "be slash grace hopper slash head lamar and so on or i can hack it",
    "start": "644560",
    "end": "651600"
  },
  {
    "text": "i want to have a massive caveat about what i'm supposed to do i'm doing now and that is please do not do this",
    "start": "651600",
    "end": "658240"
  },
  {
    "text": "it is a demo it works fine for smaller things if you go home and you put it into your web application that has",
    "start": "658240",
    "end": "664480"
  },
  {
    "text": "hundreds of thousands of users i'm going to bring or you sorry you are going to bring down your server to its nice",
    "start": "664480",
    "end": "669839"
  },
  {
    "text": "that's just the way it works but i want to show the demo anyway because it shows what the potential we have in using middlewares",
    "start": "669839",
    "end": "677200"
  },
  {
    "text": "so if i go in here and i go right before the name routing middleware i can go and say bti let's pull in",
    "start": "677200",
    "end": "684480"
  },
  {
    "text": "another middleware here here's another cool thing so",
    "start": "684480",
    "end": "690079"
  },
  {
    "text": "even the response.body is rewritable i can actually go in and",
    "start": "690079",
    "end": "695600"
  },
  {
    "text": "create a new memory stream replace response.body with my memory stream",
    "start": "695600",
    "end": "700959"
  },
  {
    "text": "save a reference to the responsible body the real memory the real stream ask the rest of the middlewares to do",
    "start": "700959",
    "end": "707680"
  },
  {
    "text": "their things and they will write to response.body and push all their stuff to that stream but they're pushing it to my memory",
    "start": "707680",
    "end": "714480"
  },
  {
    "text": "stream i've stolen your stream which means that when i get back down",
    "start": "714480",
    "end": "719839"
  },
  {
    "text": "here instead of just returning what they gave me back i can go and say hey let me add some",
    "start": "719839",
    "end": "727040"
  },
  {
    "text": "code in here where i will take whatever thing you had put into my stream make it",
    "start": "727040",
    "end": "732639"
  },
  {
    "text": "a string then for each one of the uh users in my user's repo actually i i",
    "start": "732639",
    "end": "739440"
  },
  {
    "text": "look at the regex and i see is there anything inside of this string that contains slash user slash in an id",
    "start": "739440",
    "end": "747519"
  },
  {
    "text": "in that case i go in here and i say for each one of the users go in and replace slash user slash id with slash",
    "start": "747519",
    "end": "756440"
  },
  {
    "text": "user.firstname and user.lastname instead basically rewriting every single url",
    "start": "756440",
    "end": "762639"
  },
  {
    "text": "going to user slash id on the way out this is really cool because it means",
    "start": "762639",
    "end": "768560"
  },
  {
    "text": "that if i build this that was not what i wanted to press if i build this",
    "start": "768560",
    "end": "775920"
  },
  {
    "text": "and i run this application in my my browser here and i refresh this",
    "start": "776639",
    "end": "782320"
  },
  {
    "text": "and i point at this thing down here it now says slash head lamar so now i am fixing my broken application",
    "start": "782320",
    "end": "789519"
  },
  {
    "text": "by fixing my urls on the way out and rewriting them on the way in so i'm still calling the same endpoint in mvc",
    "start": "789519",
    "end": "796959"
  },
  {
    "text": "which is slash user slash id but i've rewritten everything on the way out fantastic but chris are you stupid yes",
    "start": "796959",
    "end": "803920"
  },
  {
    "text": "at the moment i am because you're creating a memory stream for every single incoming request you're",
    "start": "803920",
    "end": "810880"
  },
  {
    "text": "doing a regular expression over that text that comes back which might be massive because it might be a big page",
    "start": "810880",
    "end": "816959"
  },
  {
    "text": "and then you do a fantastic for each loop looping over every single user in your database and doing replays for each",
    "start": "816959",
    "end": "823120"
  },
  {
    "text": "one of them isn't that slow yes it's massively slow as i said it will kill your web server but it works",
    "start": "823120",
    "end": "831600"
  },
  {
    "text": "we can fix that a little bit by adding some optimistic really simple caching",
    "start": "831600",
    "end": "837199"
  },
  {
    "text": "once again please do not replicate this in your production system it's a demo to show what you can do so what we're going",
    "start": "837199",
    "end": "842880"
  },
  {
    "text": "to do in here so i'm just going to follow along here so i know what i'm doing i am going to pull in an i distrib",
    "start": "842880",
    "end": "850639"
  },
  {
    "text": "the distributed cache so the i distributed cache is a service that is always",
    "start": "850639",
    "end": "857199"
  },
  {
    "text": "available in asp.net core by default it's not distributed by default even",
    "start": "857199",
    "end": "863040"
  },
  {
    "text": "though it's called i distributed cache it's an in-memory cache until you reconfigure it to be a redis cache or something like that but it's always",
    "start": "863040",
    "end": "868560"
  },
  {
    "text": "there so i can always take a dependency on that once i have that dependency let's go in",
    "start": "868560",
    "end": "874160"
  },
  {
    "text": "here before my rewrite and add this little thing here so i'm going to add another middleware",
    "start": "874160",
    "end": "880000"
  },
  {
    "text": "in here look at the cache trying to get anything",
    "start": "880000",
    "end": "885199"
  },
  {
    "text": "out of the cache based on the path that i passed in so basically i'm caching per path the way you do response caching if",
    "start": "885199",
    "end": "891040"
  },
  {
    "text": "there's something in the cache i respond i return that and i just return here which means i'm short-circuiting the",
    "start": "891040",
    "end": "896240"
  },
  {
    "text": "whole request pipeline by pulling it out of the cache if it's not in the cache i call the next so basically carry on",
    "start": "896240",
    "end": "903360"
  },
  {
    "text": "with the request on the way coming back it looks and says did somebody add an",
    "start": "903360",
    "end": "908720"
  },
  {
    "text": "add to cache to the items array or items dictionary in that case please add it to",
    "start": "908720",
    "end": "915519"
  },
  {
    "text": "the cache whatever bytes are in that value add that to the cache and for the future you can we'll use the cache",
    "start": "915519",
    "end": "921760"
  },
  {
    "text": "instead and it adds a 10 minute timeout for my cache very very basic cache all i",
    "start": "921760",
    "end": "927600"
  },
  {
    "text": "need to do is go in here if i have made a change in here i'm going to go ctx.items",
    "start": "927600",
    "end": "933920"
  },
  {
    "text": "add to cache equals byte",
    "start": "933920",
    "end": "940839"
  },
  {
    "text": "let's say that i was trying to be funny there is bytes cool thing about this if",
    "start": "946079",
    "end": "951680"
  },
  {
    "text": "i put a breakpoint in here now put the brake one there do f5 do some debugging",
    "start": "951680",
    "end": "957759"
  },
  {
    "text": "comes in here comes in here",
    "start": "959839",
    "end": "966079"
  },
  {
    "text": "comes in here to my request fine no queries carry on do your thing get response back if i refresh this page you",
    "start": "966880",
    "end": "973680"
  },
  {
    "text": "can now see that my cache is picking up the request so i'm not saying that you should be caching like this there are better caching models but it's really",
    "start": "973680",
    "end": "981120"
  },
  {
    "text": "cool to see how quickly and how easily you can plug into your request pipeline",
    "start": "981120",
    "end": "986800"
  },
  {
    "text": "to do things like replacements adding cache adding things the only thing you need to know is your iap configuration",
    "start": "986800",
    "end": "994079"
  },
  {
    "text": "is a pipeline stuff will come in it will go through one middleware after another and somewhere in there you can go in and",
    "start": "994079",
    "end": "1000240"
  },
  {
    "text": "do whatever you want and then you await what's going on in the next one and when it comes back you can respond to the",
    "start": "1000240",
    "end": "1005519"
  },
  {
    "text": "outgoing stuff so has any of you i assume most of you have used the uh",
    "start": "1005519",
    "end": "1010959"
  },
  {
    "text": "what's it called the error error handling middleware or something like that error use error",
    "start": "1010959",
    "end": "1016399"
  },
  {
    "text": "handling something it does that it literally when the request comes in it does a try catch around a wait next and",
    "start": "1016399",
    "end": "1024319"
  },
  {
    "text": "in the catch it knows that some some middleware further down the line has thrown an exception it is bubbled up",
    "start": "1024319",
    "end": "1029839"
  },
  {
    "text": "through the request and it comes up to that middleware and that middleware catches it and sends out response back",
    "start": "1029839",
    "end": "1035038"
  },
  {
    "text": "very very simple i thought it was a magical middleware and it did a bunch of really complicated things yes it does a",
    "start": "1035039",
    "end": "1041520"
  },
  {
    "text": "try catch if you find that complicated by the way doing a try catch i would recommend not",
    "start": "1041520",
    "end": "1047678"
  },
  {
    "text": "staying in the session because i'm about to do some really weird things that i have a hard time explaining how they",
    "start": "1047679",
    "end": "1053360"
  },
  {
    "text": "work but they do okay so we live in an api first world",
    "start": "1053360",
    "end": "1059280"
  },
  {
    "text": "right so obviously my very very advanced awesome source company website has to",
    "start": "1059280",
    "end": "1065280"
  },
  {
    "text": "have an api obviously i have to go and fetch information about these fantastic women",
    "start": "1065280",
    "end": "1071039"
  },
  {
    "text": "using an api so i have an api here you can see here localhost 443.02 slash api",
    "start": "1071039",
    "end": "1076480"
  },
  {
    "text": "slash user one a weird flickering",
    "start": "1076480",
    "end": "1082480"
  },
  {
    "text": "send that it goes off and i get some jason back awesome right well",
    "start": "1082480",
    "end": "1088160"
  },
  {
    "text": "jason is fine but i also remember that you should be able to go to your headers and add an accept header with text xml",
    "start": "1088160",
    "end": "1095600"
  },
  {
    "text": "and you should get xml back right this is awesome i add that accept header",
    "start": "1095600",
    "end": "1100720"
  },
  {
    "text": "i press send and i get json back this is a change from mvc to to or",
    "start": "1100720",
    "end": "1107919"
  },
  {
    "text": "asp.net core mvc compared to the old asp.net mvc because they have that feature built in",
    "start": "1107919",
    "end": "1114080"
  },
  {
    "text": "it is actually built in it's just that nobody really uses it because apparently xml is not the flavor of the month",
    "start": "1114080",
    "end": "1120320"
  },
  {
    "text": "yamahas which is way worse than xml in every single way but what we can do is we can go into add",
    "start": "1120320",
    "end": "1126240"
  },
  {
    "text": "controllers with views and we can add this callback",
    "start": "1126240",
    "end": "1131679"
  },
  {
    "text": "they have something called output formatters",
    "start": "1134480",
    "end": "1139600"
  },
  {
    "text": "so output formatters are responsible for what you think formatting output name very wisely what",
    "start": "1139600",
    "end": "1145840"
  },
  {
    "text": "we can do is just go output formatters dot add and then you xml serializer",
    "start": "1145840",
    "end": "1152320"
  },
  {
    "text": "format xml serializer output",
    "start": "1152320",
    "end": "1158400"
  },
  {
    "text": "formatter i have not spelt that right i actually spelled it right okay just",
    "start": "1158400",
    "end": "1165280"
  },
  {
    "text": "add one of those to your your application very simple add another formatter that formatter knows all about how to do xml",
    "start": "1165280",
    "end": "1172559"
  },
  {
    "text": "formatting for outputting things so if i go back out here and i press send tada it's xml",
    "start": "1172559",
    "end": "1178799"
  },
  {
    "text": "so all of you that are older than 25 you're going to fall all in love with being able to use xml once again",
    "start": "1178799",
    "end": "1185039"
  },
  {
    "text": "um that's kind of cool but",
    "start": "1185039",
    "end": "1191360"
  },
  {
    "text": "apis often have one more little feature that they we need to figure out when building web apis and that is how do we",
    "start": "1191360",
    "end": "1197039"
  },
  {
    "text": "do versioning because it's all fun and games with apis when you build version one and then you",
    "start": "1197039",
    "end": "1202559"
  },
  {
    "text": "come back and you go oh i need to make some changes to my api oh all changes need to be 100 backwards compatible for",
    "start": "1202559",
    "end": "1209679"
  },
  {
    "text": "existing clients and you sit in the corner and you cry for a while because you had all these grand ideas on how to",
    "start": "1209679",
    "end": "1215039"
  },
  {
    "text": "change it well this whole thing with the accept header is built into to html or http",
    "start": "1215039",
    "end": "1223120"
  },
  {
    "text": "so with http uh we we already have this idea of i can",
    "start": "1223120",
    "end": "1228159"
  },
  {
    "text": "ask for different things i can ask for text xml or i can ask for application json i get different responses",
    "start": "1228159",
    "end": "1234480"
  },
  {
    "text": "what if we could do that for versioning well you can which is really really awesome so what",
    "start": "1234480",
    "end": "1239679"
  },
  {
    "text": "i'm going to do i'm going to go into my controllers into my api i'm going to add another folder in here",
    "start": "1239679",
    "end": "1245679"
  },
  {
    "text": "a new folder models chris we don't put models in the",
    "start": "1245679",
    "end": "1251919"
  },
  {
    "text": "controllers folder yes we do when i'm on stage so i'm going to say i'm going to have",
    "start": "1251919",
    "end": "1257840"
  },
  {
    "text": "basic user base user which is going to be just imagine",
    "start": "1257840",
    "end": "1264640"
  },
  {
    "text": "just it's a stupid example i know but let's try and imagine that i have this idea where i don't want to return a full",
    "start": "1264640",
    "end": "1272000"
  },
  {
    "text": "user in my api i want to have a smaller subset of properties which i call a basic user so i create this",
    "start": "1272000",
    "end": "1278640"
  },
  {
    "text": "stupid dto which basically removes some of the properties allowing me to only pass back id last first name and last",
    "start": "1278640",
    "end": "1284240"
  },
  {
    "text": "name but i still build it off the the original user object but you can imagine this being something",
    "start": "1284240",
    "end": "1290400"
  },
  {
    "text": "completely different it was just the simplest way to demo this so i have this basic user and i want to",
    "start": "1290400",
    "end": "1295679"
  },
  {
    "text": "go ahead and i want to create a controller for that so i'm going to create a new nope",
    "start": "1295679",
    "end": "1302559"
  },
  {
    "text": "i'm going to go and create a new use or a new controller i'm gonna add a new action in here",
    "start": "1302559",
    "end": "1307600"
  },
  {
    "text": "um like that so i'm gonna create another action here called get basic user uh it's gonna",
    "start": "1307600",
    "end": "1314080"
  },
  {
    "text": "return a basic user uh and it's gonna have the address slash user id which is exactly the same as the other",
    "start": "1314080",
    "end": "1320480"
  },
  {
    "text": "one which is obviously going to fail because if you run this it's going to throw a duplicate endpoint exception or",
    "start": "1320480",
    "end": "1326799"
  },
  {
    "text": "something weird like that which isn't going to work so the way how do i differentiate between this new",
    "start": "1326799",
    "end": "1332000"
  },
  {
    "text": "fandangled v2 version of my api versus the old one well that's where the accept header comes in and we can quite easily",
    "start": "1332000",
    "end": "1338960"
  },
  {
    "text": "fix this and make it work by adding i'm just going to add a little folder here to stuff my code in i'm",
    "start": "1338960",
    "end": "1346400"
  },
  {
    "text": "going to add an infrastructure file or a folder",
    "start": "1346400",
    "end": "1352000"
  },
  {
    "text": "it's kind of like having that misc folder that you put everything in that you don't know where it belongs that",
    "start": "1352000",
    "end": "1357840"
  },
  {
    "text": "shouldn't be in your project to begin with because you don't know where it belongs so i'm going to have infrastructure i'm going to add something called an accept",
    "start": "1357840",
    "end": "1364960"
  },
  {
    "text": "header attribute and i'm going to implement that",
    "start": "1364960",
    "end": "1372159"
  },
  {
    "text": "like this so i am creating a class called accept",
    "start": "1372159",
    "end": "1377200"
  },
  {
    "text": "header attribute which is inherits from attributes so i can add it as an attribute there's a lot of attributes in",
    "start": "1377200",
    "end": "1382480"
  },
  {
    "text": "that that statement and it implements i action um constraint",
    "start": "1382480",
    "end": "1388400"
  },
  {
    "text": "so the i action constraint method or i sorry interface defines a single",
    "start": "1388400",
    "end": "1393520"
  },
  {
    "text": "method called accept and a property called order we're going to ignore order because it doesn't matter i'm just going",
    "start": "1393520",
    "end": "1398720"
  },
  {
    "text": "to have one on each anyway so the order doesn't matter but the accept method takes a context and",
    "start": "1398720",
    "end": "1405120"
  },
  {
    "text": "returns bool and if you return false from that boolean it says no this action",
    "start": "1405120",
    "end": "1410240"
  },
  {
    "text": "is not relevant for this request if it returns yes it says yes this action is relevant for this request",
    "start": "1410240",
    "end": "1417440"
  },
  {
    "text": "so what i can in this case i just look at the the route context hp context request headers look at except headers",
    "start": "1417440",
    "end": "1424320"
  },
  {
    "text": "saying is there any except header that starts with whatever i have passed in here",
    "start": "1424320",
    "end": "1430960"
  },
  {
    "text": "taking that accept header attribute adding it to my client my method here accept",
    "start": "1430960",
    "end": "1436720"
  },
  {
    "text": "header i can pass in my accept header and there",
    "start": "1436720",
    "end": "1442080"
  },
  {
    "text": "is a sort of defined standard that says you will use application application slash vnd for vendor dot",
    "start": "1442080",
    "end": "1449919"
  },
  {
    "text": "user for the type that i want so if i use the acceptor application v and the user i should now get this",
    "start": "1449919",
    "end": "1455679"
  },
  {
    "text": "method instead if i run this",
    "start": "1455679",
    "end": "1459840"
  },
  {
    "text": "if i go back out here we remove that thing again we send this request i get the old one and if i add",
    "start": "1461360",
    "end": "1467559"
  },
  {
    "text": "vnd.user and i send that request i now get did i spell that wrong",
    "start": "1467559",
    "end": "1475440"
  },
  {
    "text": "thank you for the heads up before i ran the code",
    "start": "1475440",
    "end": "1479679"
  },
  {
    "text": "let's try it again i get the short version sweet now i",
    "start": "1480960",
    "end": "1487120"
  },
  {
    "text": "could have other things than v and the user i could have vnd user 1.0 2.0 you can now have the same endpoint returning",
    "start": "1487120",
    "end": "1494159"
  },
  {
    "text": "different things depending on the accept header i could return an image i could return different versions of a user and",
    "start": "1494159",
    "end": "1499760"
  },
  {
    "text": "such and such and if it's html i return an html page if it's text i return information if it's blah blah blah i can",
    "start": "1499760",
    "end": "1505919"
  },
  {
    "text": "do whatever i want really really cool however now it only returns json",
    "start": "1505919",
    "end": "1512400"
  },
  {
    "text": "so a very common thing that we do is that we have this thing where we we have a format which is v and d user plus xml",
    "start": "1512400",
    "end": "1519679"
  },
  {
    "text": "saying that i want the application vnd user type but can you please return it as xml instead",
    "start": "1519679",
    "end": "1527279"
  },
  {
    "text": "that doesn't work uh it blatantly just fails completely in all different ways uh so what we need to do",
    "start": "1527279",
    "end": "1534000"
  },
  {
    "text": "is figure out how to return that and that's actually i wouldn't say easy",
    "start": "1534000",
    "end": "1540159"
  },
  {
    "text": "it's quite easy if you know what you're doing if you've spent way too much time on the microsoft docs but you go to the",
    "start": "1540159",
    "end": "1545760"
  },
  {
    "text": "create a new class here and you call the class accept header",
    "start": "1545760",
    "end": "1551360"
  },
  {
    "text": "output formatter selector",
    "start": "1551360",
    "end": "1556919"
  },
  {
    "text": "i think i spelled that right except for the h being lower case but it was that another one let's just ignore",
    "start": "1557279",
    "end": "1563360"
  },
  {
    "text": "the fact that it was lowercase um and i'm going to replace that with bti 11.",
    "start": "1563360",
    "end": "1568640"
  },
  {
    "text": "that was ten no that was ten that one sorry so an output formatter selector inherits",
    "start": "1568640",
    "end": "1576400"
  },
  {
    "text": "from output formatter selector which is nice.net core type and it has a method that you can override called select",
    "start": "1576400",
    "end": "1581840"
  },
  {
    "text": "formatter which is basically please tell me which formatter i should use for this request that's all we need to implement",
    "start": "1581840",
    "end": "1589120"
  },
  {
    "text": "and the way that we can implement that well first of all i need a constructor because i need some helper things",
    "start": "1589120",
    "end": "1594960"
  },
  {
    "text": "so first of all i'm going to create a constructor here which accepts an nvc options which is",
    "start": "1594960",
    "end": "1601679"
  },
  {
    "text": "actually what you put in basically this object here so that's going to get injected in here",
    "start": "1601679",
    "end": "1607360"
  },
  {
    "text": "and i get an i logger factory for logging and i go ahead and i create a fallback selector which is based on the default",
    "start": "1607360",
    "end": "1614000"
  },
  {
    "text": "output formatter selector that ethernet core uses by default so i store that in case i don't know how to figure out how",
    "start": "1614000",
    "end": "1619840"
  },
  {
    "text": "to do it i'll just fall back to the default and i create a keep a list of the output formatters that have been",
    "start": "1619840",
    "end": "1626159"
  },
  {
    "text": "defined in my options so all i need then we can go ahead and say",
    "start": "1626159",
    "end": "1633600"
  },
  {
    "text": "implement this thing here so the first thing i do in to get her select formatter i look at the headers and say is there an accept header that",
    "start": "1634799",
    "end": "1641760"
  },
  {
    "text": "starts with application slash v and d if not then give it to the default format output selector format or either output",
    "start": "1641760",
    "end": "1647840"
  },
  {
    "text": "selector i don't really don't care just not my problem go figure it out otherwise i get the content type that i",
    "start": "1647840",
    "end": "1655520"
  },
  {
    "text": "want to use for my accept header i'll show that in a second i rewrite the content type on my context",
    "start": "1655520",
    "end": "1661440"
  },
  {
    "text": "to that thing that i've decided to use instead then i ask the formatted collection is",
    "start": "1661440",
    "end": "1667760"
  },
  {
    "text": "there any one of you that can actually render a response based on this formatting tie or this type and then i",
    "start": "1667760",
    "end": "1674480"
  },
  {
    "text": "set the content type back and i return the formatter that says yes i can i can serialize this for you",
    "start": "1674480",
    "end": "1680799"
  },
  {
    "text": "this can't get content type from except header looks like this",
    "start": "1680799",
    "end": "1686480"
  },
  {
    "text": "it's very simple it it looks at the headers to accept if there's a plus inside the accept header",
    "start": "1686480",
    "end": "1692720"
  },
  {
    "text": "it means that i have a application vnds.user plus xml",
    "start": "1692720",
    "end": "1697840"
  },
  {
    "text": "i cut off the end of it based on the plus so anything after the plus gets cut off i map whatever is put behind the",
    "start": "1697840",
    "end": "1705440"
  },
  {
    "text": "plus against this lit dictionary here saying if you add plus json then the type is going to be application json xml is text",
    "start": "1705440",
    "end": "1712399"
  },
  {
    "text": "xml and that means that when i pass it in here it cuts that off changes the content type to be like the",
    "start": "1712399",
    "end": "1720080"
  },
  {
    "text": "the correct mime type and then it basically switches the content type back to the application v and the user thing",
    "start": "1720080",
    "end": "1726399"
  },
  {
    "text": "once it's done with that code in place i can figure out how to do that",
    "start": "1726399",
    "end": "1731679"
  },
  {
    "text": "i can go out here we'll do services dot",
    "start": "1731679",
    "end": "1736960"
  },
  {
    "text": "add singleton and we'll do output formatter",
    "start": "1736960",
    "end": "1744279"
  },
  {
    "text": "selector [Music]",
    "start": "1745039",
    "end": "1750960"
  },
  {
    "text": "that was not me i just want to make that very very clear was not me and then i'm going to use my version",
    "start": "1750960",
    "end": "1757039"
  },
  {
    "text": "here so i'm going to use the accept header formatter selector",
    "start": "1757039",
    "end": "1765480"
  },
  {
    "text": "accept header format sorry output output formatter selector that's the",
    "start": "1766960",
    "end": "1772960"
  },
  {
    "text": "world's longest output format or selector using that one so i'm basically replacing the one that",
    "start": "1772960",
    "end": "1779440"
  },
  {
    "text": "has net core is putting in there by default if i run this",
    "start": "1779440",
    "end": "1785039"
  },
  {
    "text": "go back to insomnia i can now say can you please give me the simpler version in xml",
    "start": "1785520",
    "end": "1792080"
  },
  {
    "text": "or can you give me the simpler version in json or can you give me the full version in",
    "start": "1792080",
    "end": "1798480"
  },
  {
    "text": "json or can you give me the full version in xml versioning with content negotiation",
    "start": "1798480",
    "end": "1804559"
  },
  {
    "text": "built in which is really really awesome okay what else can we do well if we look at",
    "start": "1804559",
    "end": "1810159"
  },
  {
    "text": "this uh controller i've got here there's a little thing that annoys me actually it doesn't but i had to make up a reason",
    "start": "1810159",
    "end": "1816000"
  },
  {
    "text": "for doing this it obviously annoys me a whole lot that i have to do users dot",
    "start": "1816000",
    "end": "1821120"
  },
  {
    "text": "where i user id array id is in twice here we don't want to repeat our code",
    "start": "1821120",
    "end": "1826480"
  },
  {
    "text": "twice right what wouldn't it be nice if we could say user",
    "start": "1826480",
    "end": "1833440"
  },
  {
    "text": "and if i get the user passed in i don't actually need that object which means i'm not not doing anything i think",
    "start": "1833440",
    "end": "1839440"
  },
  {
    "text": "anymore so i can actually simplify it down to this much nicer we can do the same thing here",
    "start": "1839440",
    "end": "1845279"
  },
  {
    "text": "we'll do user user on async it",
    "start": "1845279",
    "end": "1851840"
  },
  {
    "text": "remove the user object here that would be nice right clean simple i get the object instead of getting the id having to look it up kind",
    "start": "1852399",
    "end": "1858559"
  },
  {
    "text": "of annoying and we can we can sort this out quite easily once again go add",
    "start": "1858559",
    "end": "1865519"
  },
  {
    "text": "class i am going to add a user model binder",
    "start": "1865519",
    "end": "1872880"
  },
  {
    "text": "i'm going to create an implementation of that that looks like this so a model binder implements imodel",
    "start": "1874159",
    "end": "1879919"
  },
  {
    "text": "binder all it really has to do is implement this one thing called bind model async it gets some form of context",
    "start": "1879919",
    "end": "1885279"
  },
  {
    "text": "returns task inside this i need to figure out how to bind whatever into whatever",
    "start": "1885279",
    "end": "1892159"
  },
  {
    "text": "so in this case whatever into whatever this is really crappy explanation but kind of like the the requirements i get",
    "start": "1892159",
    "end": "1898559"
  },
  {
    "text": "from quite from customers i'm going to start off by checking if the binding context is null in that case",
    "start": "1898559",
    "end": "1905519"
  },
  {
    "text": "i saw an exception then i look at the binding context.modelmetadata.name",
    "start": "1905519",
    "end": "1911200"
  },
  {
    "text": "that thing contains the name of the property or the parameter that i am",
    "start": "1911200",
    "end": "1916240"
  },
  {
    "text": "trying to model bind so in this case it is going to contain the string user",
    "start": "1916240",
    "end": "1922799"
  },
  {
    "text": "then i take the user and i add an id at the end assuming that somebody is going to pass",
    "start": "1922799",
    "end": "1928960"
  },
  {
    "text": "a user id value through a post or a get as a query string parameter or something like that so i asked the value provider",
    "start": "1928960",
    "end": "1935679"
  },
  {
    "text": "can you please get me a value passed from the user which is called user id if there isn't one then",
    "start": "1935679",
    "end": "1942399"
  },
  {
    "text": "something went wrong just i'm not interested i'm not going to model bind this for you go and do something else",
    "start": "1942399",
    "end": "1947519"
  },
  {
    "text": "but if you are giving me a value i will pull out the first value once again check is it null or empty if it is",
    "start": "1947519",
    "end": "1954320"
  },
  {
    "text": "then return otherwise use the value that i got out of that which is going to be my user id",
    "start": "1954320",
    "end": "1959679"
  },
  {
    "text": "try and get a integer out of that if that fails add a model state exception and return",
    "start": "1959679",
    "end": "1966320"
  },
  {
    "text": "because somebody has passed the end user id abc which is not valid so throw an exception and it actually",
    "start": "1966320",
    "end": "1972240"
  },
  {
    "text": "returns a proper error message in the the response otherwise find the user based on the id",
    "start": "1972240",
    "end": "1979519"
  },
  {
    "text": "and set the model binding result to success that's kind of cool that can then be",
    "start": "1979519",
    "end": "1985840"
  },
  {
    "text": "used inside my controller to say this this here should be using that model",
    "start": "1985840",
    "end": "1990960"
  },
  {
    "text": "binder or i can go and add another class in here called a model binder provider",
    "start": "1990960",
    "end": "1998000"
  },
  {
    "text": "i'm going to a new class it's going to be called user model binder",
    "start": "1998000",
    "end": "2005279"
  },
  {
    "text": "provider it's getting kind of java esque now it's going to be some form of factory",
    "start": "2005279",
    "end": "2011519"
  },
  {
    "text": "thing in there at some point but so it looks like that so it's an imodel",
    "start": "2011519",
    "end": "2016640"
  },
  {
    "text": "binder provider what's his only responsibility is to look at the request and say can you",
    "start": "2016640",
    "end": "2022559"
  },
  {
    "text": "give me a model binder for this so basically what i do is are you trying to model bind to user if not not my problem",
    "start": "2022559",
    "end": "2031519"
  },
  {
    "text": "if that is the case please use this model binder here why am i adding it in a binder type",
    "start": "2031519",
    "end": "2038480"
  },
  {
    "text": "model binder type of so that extra one you have to return new",
    "start": "2038480",
    "end": "2043600"
  },
  {
    "text": "something and the binder type model binder gives us dependency injection so",
    "start": "2043600",
    "end": "2049760"
  },
  {
    "text": "it's basically a model binder of something else that generates an instance which has dependence injection",
    "start": "2049760",
    "end": "2056878"
  },
  {
    "text": "it it works just leave it at that so it creates an instance of my model binder",
    "start": "2056879",
    "end": "2062320"
  },
  {
    "text": "so now i have my model binder and the model binder provider i can now go into my",
    "start": "2062320",
    "end": "2068638"
  },
  {
    "text": "cleaning up here in here we can say options dot model binder providers and you would",
    "start": "2068639",
    "end": "2076638"
  },
  {
    "text": "think you can do add but you can't because it does it in order so it goes from top to bottom and the default one",
    "start": "2076639",
    "end": "2082638"
  },
  {
    "text": "that's in there says i can do it all so you have to go insert instead so we're going to do insert",
    "start": "2082639",
    "end": "2089919"
  },
  {
    "text": "at zero new user model binder provider like that",
    "start": "2089919",
    "end": "2097839"
  },
  {
    "text": "so that's adding my model binder provider in there if i run this but i want to run this i just closed the wrong thing if i run",
    "start": "2097839",
    "end": "2104240"
  },
  {
    "text": "this and i put a breakpoint in there press f5",
    "start": "2104240",
    "end": "2109760"
  },
  {
    "text": "actually this is not even what i'm waiting for we should go over here sorry uh if i run this now and i do send that",
    "start": "2115760",
    "end": "2121359"
  },
  {
    "text": "jumps straight in here and look at that my user is now bound to an instance of",
    "start": "2121359",
    "end": "2126800"
  },
  {
    "text": "end this services entities user so i don't need to do that lookup that's been done in the model binder for me instead",
    "start": "2126800",
    "end": "2134240"
  },
  {
    "text": "awesome stuff there is a little caveat if you read the docs for it it says you should never do what i just did",
    "start": "2134240",
    "end": "2139839"
  },
  {
    "text": "don't run off to the database in a model binder it is meant to basically take a complex type that you send from the",
    "start": "2139839",
    "end": "2146160"
  },
  {
    "text": "client and basically take that complex type and turn it into a class it's not supposed to be you send an id and i run",
    "start": "2146160",
    "end": "2153119"
  },
  {
    "text": "off to the database because there's a ton of errors that can happen when you run to the database and not all of them",
    "start": "2153119",
    "end": "2158400"
  },
  {
    "text": "are great in the model binder to be perfectly honest so all of the demos i've shown you so far they're really cool please don't do it when you get",
    "start": "2158400",
    "end": "2164240"
  },
  {
    "text": "home we agree on that no some of it you can do and this works i just want to",
    "start": "2164240",
    "end": "2170800"
  },
  {
    "text": "for my mv pace sake i don't want to get thrown out of the program just because i'm telling you to do things you shouldn't do i want to",
    "start": "2170800",
    "end": "2176880"
  },
  {
    "text": "have the caveat in there that somebody smarter than me has decided that you shouldn't do what i just did",
    "start": "2176880",
    "end": "2183119"
  },
  {
    "text": "so i have another demo here i have more demos let's go into my other fantastic",
    "start": "2183119",
    "end": "2188800"
  },
  {
    "text": "projects let's do set a starter project that's the one this is the enterprise employee",
    "start": "2188800",
    "end": "2195599"
  },
  {
    "text": "management inc i'm never going to start a company on my own that's for sure because i have no idea what to do so it has a little login",
    "start": "2195599",
    "end": "2202000"
  },
  {
    "text": "here i log in as a grace i think that's the password yes it is",
    "start": "2202000",
    "end": "2207680"
  },
  {
    "text": "and in here i have john doe who is deadweight i can add a profile picture in here the",
    "start": "2207680",
    "end": "2212880"
  },
  {
    "text": "problem with pro 5 pictures is that they need to be resized and things like that which it can be a heavy operation and so",
    "start": "2212880",
    "end": "2219040"
  },
  {
    "text": "on so i want to do that asynchronously in the background i want this to return quickly without me having to wait for",
    "start": "2219040",
    "end": "2225200"
  },
  {
    "text": "the picture to be resized and things like that doing things in the background in a split net core can be a bit of a",
    "start": "2225200",
    "end": "2231280"
  },
  {
    "text": "hassle but with this it's actually not that hard anymore so i'm going to go ahead and i'm going",
    "start": "2231280",
    "end": "2237200"
  },
  {
    "text": "to add a new folder in here i'm going to call it how about infrastructure",
    "start": "2237200",
    "end": "2242960"
  },
  {
    "text": "infrastructure that looks good",
    "start": "2242960",
    "end": "2249200"
  },
  {
    "text": "inside my infrastructure folder i'm going to go ahead and add a class called a thumbnail generator",
    "start": "2249200",
    "end": "2256920"
  },
  {
    "text": "thumbnail generator that looks good and i am going to go ahead and implement",
    "start": "2257560",
    "end": "2264960"
  },
  {
    "text": "something called an i hosted service it's a built-in ace decor feature don't",
    "start": "2264960",
    "end": "2271280"
  },
  {
    "text": "see a lot of people using it it has this cool thing start async stop async when your app starts it starts when it stops",
    "start": "2271280",
    "end": "2277280"
  },
  {
    "text": "it stops can't be much simpler than that so inside this in start async here i'm",
    "start": "2277280",
    "end": "2283280"
  },
  {
    "text": "going to go ahead and i'm going to say bti 18 i'm going to nope sorry i need a constructor first",
    "start": "2283280",
    "end": "2289599"
  },
  {
    "text": "that one so i'm going to have a constructor that just gets an iweb host environment so i get some information about the hosting i'm",
    "start": "2290400",
    "end": "2297200"
  },
  {
    "text": "going to have some employees which is just a repo with employees i'm going to have a file system watcher at some point",
    "start": "2297200",
    "end": "2303040"
  },
  {
    "text": "now i can go ahead and implement my store async so install async i'm going to go ahead",
    "start": "2303040",
    "end": "2308880"
  },
  {
    "text": "and i'm going to do a path combined web root images backslash employees so basically",
    "start": "2308880",
    "end": "2314839"
  },
  {
    "text": "www images employees any images will be placed in there i'm going to go ahead",
    "start": "2314839",
    "end": "2320800"
  },
  {
    "text": "and create the directory if it doesn't exist creating a file system watcher that watches for any files being placed",
    "start": "2320800",
    "end": "2326560"
  },
  {
    "text": "inside of that folder whenever a file is created in that folder stuff happens",
    "start": "2326560",
    "end": "2332400"
  },
  {
    "text": "and that's it that's all it's going to do so i'm going to sit there and listen for events",
    "start": "2332400",
    "end": "2338240"
  },
  {
    "text": "so what's the whole stuff happens well stuff is this",
    "start": "2338240",
    "end": "2344960"
  },
  {
    "text": "lots of code but it basically it looks at the file name and if it contains thumb it shouldn't do any because it's",
    "start": "2344960",
    "end": "2351200"
  },
  {
    "text": "already a thumbnail but other than that i'm naming the file so that the information about the tenant and the",
    "start": "2351200",
    "end": "2356720"
  },
  {
    "text": "user id and things like that is in the name so i can figure it out from the naming standard or naming convention",
    "start": "2356720",
    "end": "2361920"
  },
  {
    "text": "then i pull out the user with that employee id from the name then i create a new image in here that needs a",
    "start": "2361920",
    "end": "2369440"
  },
  {
    "text": "fantastic little oops i need network connection there should",
    "start": "2369440",
    "end": "2374720"
  },
  {
    "text": "be networks available should be one called ndc i think",
    "start": "2374720",
    "end": "2380240"
  },
  {
    "text": "what's it at the top there it is thank you uh so i need a new git package for that",
    "start": "2381760",
    "end": "2388240"
  },
  {
    "text": "please connect there it is so we're gonna go manage nuget packages i'm gonna add a new get",
    "start": "2388240",
    "end": "2393839"
  },
  {
    "text": "package called image sharp",
    "start": "2393839",
    "end": "2397839"
  },
  {
    "text": "that one and i am going to add that one this six",
    "start": "2398960",
    "end": "2404400"
  },
  {
    "text": "labels image sharp add that accept",
    "start": "2404400",
    "end": "2410800"
  },
  {
    "text": "ignore the errors down at the bottom they are there for a future demo then i'm going to go in here and i'm",
    "start": "2410800",
    "end": "2416880"
  },
  {
    "text": "going to say this image here comes out of six labor's image sharp and this thing here is an extension method from",
    "start": "2416880",
    "end": "2423839"
  },
  {
    "text": "image sharp what it does it resizes my image and and saves it as dash thumb that's what it does nothing complicated",
    "start": "2423839",
    "end": "2429839"
  },
  {
    "text": "at all and there's an ugly exception at the bottom or a thing at the bottom where sometimes the",
    "start": "2429839",
    "end": "2436560"
  },
  {
    "text": "file is created and if it's big it hasn't released the file before this gets executed so if that happens then",
    "start": "2436560",
    "end": "2442319"
  },
  {
    "text": "just run the code again if there's any other error that happens to be there i'm just going to run for an internal loop and basically",
    "start": "2442319",
    "end": "2448240"
  },
  {
    "text": "bring the web server to sneeze but once again it's a demo it works um and then in my stop async",
    "start": "2448240",
    "end": "2456720"
  },
  {
    "text": "i'm gonna go ahead and say when that the web application is stopped then stop listening for file changes turn off the",
    "start": "2456720",
    "end": "2464240"
  },
  {
    "text": "file system watcher and dispose the file system watcher that's about it if i go ahead and i add a breakpoint",
    "start": "2464240",
    "end": "2470720"
  },
  {
    "text": "there and i press f5 and",
    "start": "2470720",
    "end": "2476480"
  },
  {
    "text": "for some reason i'm not very religious actually i'm not religious at all but praying comes natural when you press f5",
    "start": "2476480",
    "end": "2481680"
  },
  {
    "text": "at the demo with people in the room just happens to be like that so i go in here i go add profile picture",
    "start": "2481680",
    "end": "2489680"
  },
  {
    "text": "i show shows choose a file here so we go chris upload",
    "start": "2489680",
    "end": "2496640"
  },
  {
    "text": "why did directory not found oh no no sorry i missed the thing i missed a step that's why i have the ipad",
    "start": "2498800",
    "end": "2504640"
  },
  {
    "text": "it tells me what steps to do sorry it needs to be added to my sorry services",
    "start": "2504640",
    "end": "2509680"
  },
  {
    "text": "dot add hosted service i need to add it in here of course to tell",
    "start": "2509680",
    "end": "2516240"
  },
  {
    "text": "generate dirtl mvc or sorry.net that it exists so i'm going to add thumbnail generator like that",
    "start": "2516240",
    "end": "2522640"
  },
  {
    "text": "sorry let's try it again",
    "start": "2522640",
    "end": "2525920"
  },
  {
    "text": "maybe here it is maybe",
    "start": "2527680",
    "end": "2532920"
  },
  {
    "text": "there it is let's try it again add profile picture choose file crystal png",
    "start": "2536720",
    "end": "2543280"
  },
  {
    "text": "upload here it is it comes in it finds the file",
    "start": "2543280",
    "end": "2548400"
  },
  {
    "text": "being it being there so i just run through that let it run go back out here notice that this thing is still running",
    "start": "2548400",
    "end": "2554160"
  },
  {
    "text": "in the background i already got the response back from asp.net core because it has already just saved the file and given me response back the whole",
    "start": "2554160",
    "end": "2561280"
  },
  {
    "text": "thumbnail generation is on the background thread which is kind of cool i let this go again because it comes in",
    "start": "2561280",
    "end": "2566400"
  },
  {
    "text": "a second time for the thumbnail and if i refresh this thing here now there is a picture of me",
    "start": "2566400",
    "end": "2572160"
  },
  {
    "text": "so basically it runs in the background asynchronously it doesn't block anything while it changes the size of the image",
    "start": "2572160",
    "end": "2577520"
  },
  {
    "text": "and things like that so that's kind of neat i kind of like that now",
    "start": "2577520",
    "end": "2582560"
  },
  {
    "text": "i have i think 18 more minutes and i'm now gonna do one of those",
    "start": "2582560",
    "end": "2588079"
  },
  {
    "text": "i wish i didn't have this idea when i built this talk kind of demos so how many of you use",
    "start": "2588079",
    "end": "2595040"
  },
  {
    "text": "azure how many of you have gone into an azure web application and checked the little",
    "start": "2595040",
    "end": "2600400"
  },
  {
    "text": "checkbox that says add application insights to your application how many of you have thought how do they",
    "start": "2600400",
    "end": "2607200"
  },
  {
    "text": "add application insights to my code with a checkbox not a single hand a few little hands",
    "start": "2607200",
    "end": "2614240"
  },
  {
    "text": "okay that was my thought i'm like how do they get their code in my code without asking me because i need to learn how to",
    "start": "2614240",
    "end": "2620800"
  },
  {
    "text": "do that so i want to show you how to do a couple of things about deploying to servers",
    "start": "2620800",
    "end": "2625920"
  },
  {
    "text": "which is kind of cool and they all sort of the culmination is i can inject stuff",
    "start": "2625920",
    "end": "2631599"
  },
  {
    "text": "into any application that is launched on my machine which is really really cool so deploy",
    "start": "2631599",
    "end": "2636960"
  },
  {
    "text": "anything to my laptop and i will put my grabby hands on your code and i will inject stuff into it and i will do",
    "start": "2636960",
    "end": "2642640"
  },
  {
    "text": "stuff you don't want to know to your code so the first step of that is using something called a runtime store",
    "start": "2642640",
    "end": "2650000"
  },
  {
    "text": "runtime stores used to be a thing they're not a big thing anymore because they change the way that.net core works",
    "start": "2650000",
    "end": "2655839"
  },
  {
    "text": "but a runtime store i have a little class library here or actually it's not a class lab business it's a console app",
    "start": "2655839",
    "end": "2661119"
  },
  {
    "text": "doesn't matter it's a project i'm not going to use that project the only thing i want from that project is",
    "start": "2661119",
    "end": "2666880"
  },
  {
    "text": "this cs proj file and the cs proj file says i have a reference to these four",
    "start": "2666880",
    "end": "2672160"
  },
  {
    "text": "nougat packages which happens to be the same nougat packages used by the enterprise employee",
    "start": "2672160",
    "end": "2677760"
  },
  {
    "text": "management inc application so i have this in place here same references i have a little thing here",
    "start": "2677760",
    "end": "2684240"
  },
  {
    "text": "that references a nuget package in a debug folder one level up so what i'm going to do is i'm going to build this",
    "start": "2684240",
    "end": "2690319"
  },
  {
    "text": "request diagnostics package i'm just going to build that to make sure that there is a new get package so if i expand this now this",
    "start": "2690319",
    "end": "2697040"
  },
  {
    "text": "thing generates a new git package for me in the bin debug there is a nougat package",
    "start": "2697040",
    "end": "2702240"
  },
  {
    "text": "or a knob keg that some like some people call it um that's all i want that's all i'm",
    "start": "2702240",
    "end": "2707359"
  },
  {
    "text": "going to use to see this project file for it is the reference to nougat packages with that in place i'm going to go ahead",
    "start": "2707359",
    "end": "2714319"
  },
  {
    "text": "and run a an arcane compound in in here i'm going to say dot net",
    "start": "2714319",
    "end": "2721760"
  },
  {
    "text": "store can you guys see that in the back no",
    "start": "2721760",
    "end": "2726880"
  },
  {
    "text": "let's zoom can you see that cool if i press f8 i'm going to get that",
    "start": "2726880",
    "end": "2734240"
  },
  {
    "text": "so new dotnet store takes what's called a manifest which isn't cs project file that references other nougat packages",
    "start": "2734240",
    "end": "2741119"
  },
  {
    "text": "like my proj file then i tell it that i want to create a runtime store that's going to contain these assemblies that i can put",
    "start": "2741119",
    "end": "2747760"
  },
  {
    "text": "somewhere on a machine so that other people can use it you can see it i'm going to swear now in church i'm",
    "start": "2747760",
    "end": "2753280"
  },
  {
    "text": "well aware you can see it kind of like a global assembly cache",
    "start": "2753280",
    "end": "2758960"
  },
  {
    "text": "but you control it and it's nothing like a global assembly cache at all but it's a way for us to deploy assemblies to a",
    "start": "2759359",
    "end": "2765119"
  },
  {
    "text": "machine and have applications on that machine be able to be deployed without those assemblies and use the",
    "start": "2765119",
    "end": "2771119"
  },
  {
    "text": "pre-deployed ones on the machine which means that if you have a lot of assemblies that you need for your deployment you can go and say preload",
    "start": "2771119",
    "end": "2778560"
  },
  {
    "text": "this on the server and just deploy the things i've changed so what i'm doing here is i'm defining",
    "start": "2778560",
    "end": "2783760"
  },
  {
    "text": "the runtime store containing my four nougat packages and i'm saying set it up for win10 x64 put the runtime store at c",
    "start": "2783760",
    "end": "2791520"
  },
  {
    "text": "colon demo and skip optimization i used to say in my demo that i don't know what",
    "start": "2791520",
    "end": "2796880"
  },
  {
    "text": "that does i'm going to say that again i have no idea what that one does but if you don't add it the whole thing blows up in your",
    "start": "2796880",
    "end": "2803359"
  },
  {
    "text": "face with a massive error and if you google it it says add skip optimization you're good",
    "start": "2803359",
    "end": "2809119"
  },
  {
    "text": "so i added skipped optimization what this does is if we go explorer",
    "start": "2809119",
    "end": "2817040"
  },
  {
    "text": "c colon demo backslash runtime store",
    "start": "2817040",
    "end": "2823280"
  },
  {
    "text": "this uh this is going to be hard for you to see i'm sorry about that but in here it basically creates an x64 folder net5o",
    "start": "2823280",
    "end": "2829359"
  },
  {
    "text": "folder and one folder for each one of the nuget packages that i had a reference to",
    "start": "2829359",
    "end": "2834480"
  },
  {
    "text": "if i zoom in like that and a a",
    "start": "2834480",
    "end": "2840160"
  },
  {
    "text": "an artifact.xml file so if i take that artifact.xml file and i add that to my project here we can see",
    "start": "2840160",
    "end": "2847359"
  },
  {
    "text": "here it basically just says that in this runtime store you will find these assemblies",
    "start": "2847359",
    "end": "2853599"
  },
  {
    "text": "okay that's kind of simple don't mind that too much next step",
    "start": "2853599",
    "end": "2859200"
  },
  {
    "text": "go back into the console clear the console and then inside here let's go ahead and say dot net publish",
    "start": "2859200",
    "end": "2866559"
  },
  {
    "text": "and since i'm i type really poorly i'm going to use that one so i'm going to do a net",
    "start": "2866559",
    "end": "2872480"
  },
  {
    "text": "publish of my enterprise employee management inc project do release build and publish it to c colon demo publish",
    "start": "2872480",
    "end": "2880400"
  },
  {
    "text": "folder run that run that",
    "start": "2880400",
    "end": "2887280"
  },
  {
    "text": "there it is we'll do the explorer thing again but in this case",
    "start": "2887280",
    "end": "2894480"
  },
  {
    "text": "in this case i won't go to that folder i will actually go to this folder here the publish folder and you don't need to see what's in here as",
    "start": "2894720",
    "end": "2901040"
  },
  {
    "text": "such but what i can tell you is there's a bcrypt.net core there's a newton soft there's a six labels image sharp yeah",
    "start": "2901040",
    "end": "2907200"
  },
  {
    "text": "it's what you expect from a project like this because that was what i had referenced if i go out here and let's go",
    "start": "2907200",
    "end": "2912800"
  },
  {
    "text": "ahead and just kill that publish folder completely just delete it yep like that",
    "start": "2912800",
    "end": "2918640"
  },
  {
    "text": "then we go i shouldn't have closed that let's do net publish again",
    "start": "2918640",
    "end": "2924400"
  },
  {
    "text": "but this time i'm going to add this extra parameter called dash dash manifest and i'm going to point it",
    "start": "2924400",
    "end": "2930000"
  },
  {
    "text": "towards my artifact xml file that says this runtime store is already available",
    "start": "2930000",
    "end": "2935280"
  },
  {
    "text": "on the machine so anything inside of that you don't need to bring on your own build my application again",
    "start": "2935280",
    "end": "2942680"
  },
  {
    "text": "and all of a sudden in my publish folder all of those assemblies are now gone they don't need to be redeployed because",
    "start": "2944640",
    "end": "2950720"
  },
  {
    "text": "they're already on my machine suite faster deployments no worries",
    "start": "2950720",
    "end": "2957760"
  },
  {
    "text": "ish the next step happens to be that you have to add a little environment",
    "start": "2957760",
    "end": "2964079"
  },
  {
    "text": "variable for this to work so let's go ahead and add that environment variable i just need to figure out that spell",
    "start": "2964079",
    "end": "2969920"
  },
  {
    "text": "this correctly so it's going to be actually we can start out by this first let's do cd publish let's do net enterprise application",
    "start": "2969920",
    "end": "2976880"
  },
  {
    "text": "thingy that thing run that and it says who cannot find bcrypt.net no it can't",
    "start": "2976880",
    "end": "2982960"
  },
  {
    "text": "because there is a runtime store on my machine i said it was like the gac but it's nothing like the gac it doesn't",
    "start": "2982960",
    "end": "2988720"
  },
  {
    "text": "know that it exists i actually have to tell it that if you there is a runtime store and here is the runtime store for",
    "start": "2988720",
    "end": "2994400"
  },
  {
    "text": "you so the way we tell it that there is a runtime store is by adding a environment variable called.net",
    "start": "2994400",
    "end": "3002079"
  },
  {
    "text": "shared and i think i've got that programmed as well shared store and i give it the address of my runtime store",
    "start": "3002079",
    "end": "3008640"
  },
  {
    "text": "press enter that's now an environment variable in my machine or in this terminal and if i run my.net command",
    "start": "3008640",
    "end": "3015040"
  },
  {
    "text": "again it will now run the application without the problem because even though the file is not in the assembly is not",
    "start": "3015040",
    "end": "3020559"
  },
  {
    "text": "in the bin folder of that application it knows that there is an environment variable that tells it that there are",
    "start": "3020559",
    "end": "3026400"
  },
  {
    "text": "assemblies in my runtime store which is located over here so it loads those things as well",
    "start": "3026400",
    "end": "3032240"
  },
  {
    "text": "nobody's going to use this but it's kind of cool so let's take this for a",
    "start": "3032720",
    "end": "3038000"
  },
  {
    "text": "further trip down the rabbit hole because i'm going to make this worse",
    "start": "3038000",
    "end": "3043760"
  },
  {
    "text": "i want to do the whole i want to put my grabby hands on your code and inject stuff into what you're running",
    "start": "3043760",
    "end": "3050400"
  },
  {
    "text": "how do we do that well let's see there are many steps here and so far i don't think i've managed to do this demo once without it failing at",
    "start": "3050400",
    "end": "3057280"
  },
  {
    "text": "least once for me so please bear in mind that when i when i fail with this",
    "start": "3057280",
    "end": "3062480"
  },
  {
    "text": "i have a little request diagnostics project here it has an a diagnostics log implementing",
    "start": "3062480",
    "end": "3068160"
  },
  {
    "text": "eye diagnostics log it's a really stupid log and it once again it will bring down your web server if you actually use it",
    "start": "3068160",
    "end": "3073200"
  },
  {
    "text": "but for the demo it works it basically looks at every single incoming request sorry the",
    "start": "3073200",
    "end": "3079040"
  },
  {
    "text": "next part this part here will just store every single log entry as a list and whenever the application is stopping",
    "start": "3079040",
    "end": "3086720"
  },
  {
    "text": "so i can do the application lifetime application stopping i go and say file write all text to basically store the",
    "start": "3086720",
    "end": "3092559"
  },
  {
    "text": "log entries into txt file so when i start up the application next time it reads up all the log entries into memory",
    "start": "3092559",
    "end": "3098720"
  },
  {
    "text": "so over time i'm going to fill up your memory with log statements once again it's a demo",
    "start": "3098720",
    "end": "3104640"
  },
  {
    "text": "so that's all that log does and then i have a diagnostics middleware which is a middleware i can plug into a request",
    "start": "3104640",
    "end": "3111119"
  },
  {
    "text": "pipeline it logs every single incoming request into my diagnostics log and if",
    "start": "3111119",
    "end": "3116960"
  },
  {
    "text": "you go to slash diagnostics i will go and basically circumvent your whole",
    "start": "3116960",
    "end": "3122640"
  },
  {
    "text": "request pipeline and go and return these log statements so you can see them in the web browser as well",
    "start": "3122640",
    "end": "3128880"
  },
  {
    "text": "that's all the code i have and i need this injected into your code or the application code running on my machine",
    "start": "3128880",
    "end": "3134640"
  },
  {
    "text": "the way we do that is a two-step program first of all i'm going to go and add a",
    "start": "3134640",
    "end": "3139920"
  },
  {
    "text": "new class in here i'm going to add a class in here i'm going to call it a",
    "start": "3139920",
    "end": "3145839"
  },
  {
    "text": "host no sorry diagnostics the one i want is a startup filter",
    "start": "3145839",
    "end": "3153839"
  },
  {
    "text": "diagnostic startup filter like that and i'm going to replace that with this thing here so a diagnostic startup",
    "start": "3153839",
    "end": "3159760"
  },
  {
    "text": "filter is a class implementing i startup filter and the i startup filter allows you to get access to the eye application",
    "start": "3159760",
    "end": "3166480"
  },
  {
    "text": "builder so basically the request pipeline by adding any class implementing i startup filter into your",
    "start": "3166480",
    "end": "3173920"
  },
  {
    "text": "the into your ci container or sorry di container so basically into your services it will automatically be",
    "start": "3173920",
    "end": "3180559"
  },
  {
    "text": "executed when your application starts up so asp.net core goes in and looks at every single registered class in the di",
    "start": "3180559",
    "end": "3186400"
  },
  {
    "text": "container and says is there anything that implements i start a filter then run this code",
    "start": "3186400",
    "end": "3192720"
  },
  {
    "text": "cool in my code i add my diagnostics middleware",
    "start": "3192720",
    "end": "3197839"
  },
  {
    "text": "so basically i if i put this into di into an application it will inject my",
    "start": "3197839",
    "end": "3202880"
  },
  {
    "text": "middleware into the request pipeline the next part of this is to add another class there it is",
    "start": "3202880",
    "end": "3210240"
  },
  {
    "text": "i'm going to go and say add i'm going to add another type of class which is going to be called diagnostics",
    "start": "3210240",
    "end": "3218200"
  },
  {
    "text": "hosting startup once again i'm just going to replace that so you can see the code",
    "start": "3218319",
    "end": "3224720"
  },
  {
    "text": "so a diagnostic is a ihosting startup is a class that implements eye hosting",
    "start": "3224720",
    "end": "3229839"
  },
  {
    "text": "startup but instead of plugging into your application request pipeline it actually plugs into the creation of your",
    "start": "3229839",
    "end": "3235680"
  },
  {
    "text": "web host builder during your web host building you get access to the services",
    "start": "3235680",
    "end": "3241520"
  },
  {
    "text": "so using this thing here i can go and add my i start up filter diagnostic sort of filter to the di service",
    "start": "3241520",
    "end": "3249040"
  },
  {
    "text": "and then that thing runs and attaches to your request pipeline and to be able to get this to work i",
    "start": "3249040",
    "end": "3255040"
  },
  {
    "text": "also need to add a little assembly attribute here saying that this assembly contains a hosting startup that needs to",
    "start": "3255040",
    "end": "3260800"
  },
  {
    "text": "be executed and here is the class that implements the i hosting startup",
    "start": "3260800",
    "end": "3266400"
  },
  {
    "text": "with those two things in place i have everything that i need to jack myself into my code so what we're going to do",
    "start": "3266400",
    "end": "3272079"
  },
  {
    "text": "here is i'm going to go and i already have a nuget package version 1.0.0",
    "start": "3272079",
    "end": "3277520"
  },
  {
    "text": "so to get this to work i have to go and change the version of this nougat package",
    "start": "3277520",
    "end": "3282720"
  },
  {
    "text": "to 1.0.1",
    "start": "3282720",
    "end": "3287960"
  },
  {
    "text": "might be more than a .01 update but it's you get it it needs a new version that's",
    "start": "3288400",
    "end": "3293520"
  },
  {
    "text": "all i need then i'm going to build this thing to make sure that i get a nougat package",
    "start": "3293520",
    "end": "3299440"
  },
  {
    "text": "let's see if i get a new get package called one here so bin debug there's a zero one",
    "start": "3299760",
    "end": "3305440"
  },
  {
    "text": "package version of it now that's good this thing here my store",
    "start": "3305440",
    "end": "3311599"
  },
  {
    "text": "has a reference to 1.0.star so that's happy go lucky so i'm just going to rebuild this to make sure that",
    "start": "3311599",
    "end": "3318000"
  },
  {
    "text": "it creates gets the nuget package needed so and so on and then i can go back out here and i",
    "start": "3318000",
    "end": "3324640"
  },
  {
    "text": "can recreate my store with net store dot net store like that so i'm just",
    "start": "3324640",
    "end": "3330640"
  },
  {
    "text": "going to recreate my store to get my version 1.0.1 into my runtime store as well with the new version",
    "start": "3330640",
    "end": "3337520"
  },
  {
    "text": "the next part is the one that's kind of hard to explain but when you build a web application or",
    "start": "3337520",
    "end": "3344160"
  },
  {
    "text": "sorry builda.net core application you get this fantastic file so i'm going to go and say",
    "start": "3344160",
    "end": "3349760"
  },
  {
    "text": "open that out i'm going to go to my bin folder debug folder net5 you get something",
    "start": "3349760",
    "end": "3355680"
  },
  {
    "text": "called a depth.json file the depth.json file tells the runtime",
    "start": "3355680",
    "end": "3360880"
  },
  {
    "text": "that when you load this assembly you need to load these other assemblies as well so this is my dependency list",
    "start": "3360880",
    "end": "3368000"
  },
  {
    "text": "so i'm going to take this this version here because it contains everything needed to run my nougat packages",
    "start": "3368000",
    "end": "3374000"
  },
  {
    "text": "and i'm going to go and say you don't need to load the runtime store so i'm going to remove the runtime store",
    "start": "3374000",
    "end": "3379520"
  },
  {
    "text": "from the libraries that needs to be loaded like that save that file again go back out here and i'm going to copy",
    "start": "3379520",
    "end": "3385920"
  },
  {
    "text": "that file so i'm copying that file the uh",
    "start": "3385920",
    "end": "3390960"
  },
  {
    "text": "the runtimestore.debs.json into a folder underneath shared microsoft ethernet",
    "start": "3390960",
    "end": "3398400"
  },
  {
    "text": "core app 500 diagnostics.debs.json",
    "start": "3398400",
    "end": "3402838"
  },
  {
    "text": "that file across it's a file that means that there now is a file on disk called",
    "start": "3404160",
    "end": "3410520"
  },
  {
    "text": "diagnostics.debs.json in a very specific location which is underneath shared microsoft asp.net core5",
    "start": "3410520",
    "end": "3417760"
  },
  {
    "text": "with that in place i can now go ahead in here and i'm going to add two more environment variables",
    "start": "3417760",
    "end": "3423200"
  },
  {
    "text": "i'm going to add one called dot net additional depth",
    "start": "3423200",
    "end": "3428480"
  },
  {
    "text": "that says that when you load an assembly on this machine there will potentially be an additional",
    "start": "3428480",
    "end": "3434960"
  },
  {
    "text": "dependencies that you need to load as well and it's going to load it based on the fact that my application inherits",
    "start": "3434960",
    "end": "3441680"
  },
  {
    "text": "from or builds on top of as microsoft not core asp.net sorry microsoft ace net core 500. so any application on my",
    "start": "3441680",
    "end": "3449359"
  },
  {
    "text": "machine right now built using estimate core 500 will also go and load the",
    "start": "3449359",
    "end": "3455359"
  },
  {
    "text": "additional dependencies from that depth folder depth file located in my",
    "start": "3455359",
    "end": "3460720"
  },
  {
    "text": "additional dependencies the next part is i can go ahead and add",
    "start": "3460720",
    "end": "3465760"
  },
  {
    "text": "a an environment variable here and it's going to be called asp.net it's going to be asp.net core hosting startup",
    "start": "3465760",
    "end": "3472559"
  },
  {
    "text": "assemblies saying that there is an assembly hosting startup assembly called request diagnostics that should be",
    "start": "3472559",
    "end": "3478799"
  },
  {
    "text": "loaded whenever you start an application like that add that as well dot net",
    "start": "3478799",
    "end": "3486400"
  },
  {
    "text": "nope that is not going to work we need to run that",
    "start": "3486640",
    "end": "3492640"
  },
  {
    "text": "you see that output here adding generic diagnostic to system so what happens when i run this x this",
    "start": "3492960",
    "end": "3499920"
  },
  {
    "text": "dll what happens is that since there is an environment variable",
    "start": "3499920",
    "end": "3504960"
  },
  {
    "text": "with this additional depth kind thing here it's going to go and say okay there are",
    "start": "3504960",
    "end": "3510240"
  },
  {
    "text": "additional dependencies i'm going to go and look for those and it looks what am i basing this application off of well",
    "start": "3510240",
    "end": "3515599"
  },
  {
    "text": "that's asp.net core five is there a folder called shared slash microsoft ethernet core",
    "start": "3515599",
    "end": "3521520"
  },
  {
    "text": "slash five zero zero yes there is take the depth.json file in there find out",
    "start": "3521520",
    "end": "3526559"
  },
  {
    "text": "those dependencies and load them in as well loading those assemblies in means loading in my my diagnostics nougat",
    "start": "3526559",
    "end": "3533680"
  },
  {
    "text": "package this six labels nougat package and a few other nougat packages that was in that store as well",
    "start": "3533680",
    "end": "3538880"
  },
  {
    "text": "um and now it knows that those needs to be loaded into memory as well then asp.net",
    "start": "3538880",
    "end": "3544400"
  },
  {
    "text": "core starts up and starts running the application it says oh there is an esp net core hosting startup assemblies",
    "start": "3544400",
    "end": "3550000"
  },
  {
    "text": "environment variable saying that there is an assembly called request diagnostics that contains a hosting",
    "start": "3550000",
    "end": "3555839"
  },
  {
    "text": "startup thing so it goes and says have i loaded an assembly called request diagnostics yes i have does that thing",
    "start": "3555839",
    "end": "3563200"
  },
  {
    "text": "include an assembly attribute for hosting startup yes it does it's this one and then it loads that which runs",
    "start": "3563200",
    "end": "3569760"
  },
  {
    "text": "throughout the web host application web host setup that injects things into the id the i",
    "start": "3569760",
    "end": "3575520"
  },
  {
    "text": "container and then during startup it goes to di container and asks for the hosting daily startup thingy the i start",
    "start": "3575520",
    "end": "3581760"
  },
  {
    "text": "up filter and lets that play with the request pipeline and the result of that is that if i go",
    "start": "3581760",
    "end": "3588640"
  },
  {
    "text": "over to my browser and i browse to localhost 5001",
    "start": "3588640",
    "end": "3595599"
  },
  {
    "text": "that is my application if i request that a couple of times and then go and say can i go to slash",
    "start": "3595599",
    "end": "3602160"
  },
  {
    "text": "diagnostics there is my diagnostics file",
    "start": "3602160",
    "end": "3607760"
  },
  {
    "text": "and if i go ahead and i cancel this and i do explorer",
    "start": "3607760",
    "end": "3613040"
  },
  {
    "text": "dot you will see that there is a diagnostics log file that has all of my",
    "start": "3613040",
    "end": "3618079"
  },
  {
    "text": "requests being in there so all that needs to be done now is any application on my machine",
    "start": "3618079",
    "end": "3623119"
  },
  {
    "text": "launched in that terminal will automatically have my diagnostics",
    "start": "3623119",
    "end": "3629520"
  },
  {
    "text": "log and my diagnostics endpoint for me to work with and i could add these as global environment variables that would",
    "start": "3629520",
    "end": "3634559"
  },
  {
    "text": "work for everything on my entire server for example so anything deployed to your server at work would automatically get a",
    "start": "3634559",
    "end": "3640880"
  },
  {
    "text": "bunch of stuff injected into your application by default",
    "start": "3640880",
    "end": "3645920"
  },
  {
    "text": "that my friends was one hour of really weird asp.net",
    "start": "3646559",
    "end": "3653040"
  },
  {
    "text": "core knowledge i'm sorry about that if it didn't make any sense to you i hope you got something out of it thank you",
    "start": "3653040",
    "end": "3658240"
  },
  {
    "text": "all for listening if you have any questions i will be around i'm on twitter if you want to tweet me",
    "start": "3658240",
    "end": "3663359"
  },
  {
    "text": "complain about something or say thank you for a great presentation don't forget if you liked the session please",
    "start": "3663359",
    "end": "3668720"
  },
  {
    "text": "eval evaluate if you didn't like the session there's a bowl out there on the left hand side go to the right hand side",
    "start": "3668720",
    "end": "3674480"
  },
  {
    "text": "please leave room for the people who like the session thanks",
    "start": "3674480",
    "end": "3681400"
  },
  {
    "text": "you",
    "start": "3694000",
    "end": "3696079"
  }
]