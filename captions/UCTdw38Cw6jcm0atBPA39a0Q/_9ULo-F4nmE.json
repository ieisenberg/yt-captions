[
  {
    "start": "0",
    "end": "409000"
  },
  {
    "text": "all right everybody looks like where on track to begin so I'm gonna start",
    "start": "1460",
    "end": "10260"
  },
  {
    "text": "um forgive me if I sort of look a bit blinded when I look up to those of you folks at the back there are a couple of",
    "start": "10260",
    "end": "15900"
  },
  {
    "text": "big lights and they shine in my eyes I should really have worn some uh very dark sunglasses or whatever to be able",
    "start": "15900",
    "end": "21600"
  },
  {
    "text": "to see you at the back um hopefully you are here to see me Ian Cooper talk about",
    "start": "21600",
    "end": "28019"
  },
  {
    "text": "um uh at least once so at least once is really asking the question",
    "start": "28019",
    "end": "33180"
  },
  {
    "text": "what happens in a world where we can't use two-phase commit uh to talk between",
    "start": "33180",
    "end": "40140"
  },
  {
    "text": "two databases who am I",
    "start": "40140",
    "end": "45480"
  },
  {
    "text": "um I'm old that's what that most of that says um I always try and highlight the bottom",
    "start": "45480",
    "end": "51000"
  },
  {
    "text": "point which is you know I'm I'm here only because I ended up getting speaking",
    "start": "51000",
    "end": "57420"
  },
  {
    "text": "at local user groups we didn't have anybody um and anyway got me into conferences and then that got me speaking on the",
    "start": "57420",
    "end": "63719"
  },
  {
    "text": "stage and I'm not smart than any of you are I just had the right opportunities and and you can certainly do what I'm",
    "start": "63719",
    "end": "69600"
  },
  {
    "text": "doing and please do think about speaking it's great for helping you organize your thoughts and helping your work to",
    "start": "69600",
    "end": "76200"
  },
  {
    "text": "present ideas what are we going to talk about today um so we're going to talk about an idea",
    "start": "76200",
    "end": "82740"
  },
  {
    "text": "called fiefdoms from Pat Helen along with collaborations another idea from",
    "start": "82740",
    "end": "88020"
  },
  {
    "text": "Pat Helen and emissaries you'll see down there on point number four we'll talk about where those ideas come",
    "start": "88020",
    "end": "93060"
  },
  {
    "text": "from and how they relate to things you may have heard of more recently because they're slightly older ideas",
    "start": "93060",
    "end": "98159"
  },
  {
    "text": "we'll talk a little bit about messaging how that works in terms of what we think about as future and past and how we do",
    "start": "98159",
    "end": "104220"
  },
  {
    "text": "stuff in a way that's transactionally consistent um we'll come across some ideas like",
    "start": "104220",
    "end": "110040"
  },
  {
    "text": "resources and activities and at the end I'll show you a little bit of some code for how we can kind of try and Implement",
    "start": "110040",
    "end": "116640"
  },
  {
    "text": "some of those ideas uh using an open source project I work on called brighter",
    "start": "116640",
    "end": "122960"
  },
  {
    "text": "okay so in 2007 uh Pat Helen uh he's a",
    "start": "123180",
    "end": "129899"
  },
  {
    "text": "architect that's worked variously at Microsoft and Amazon and some of the",
    "start": "129899",
    "end": "135599"
  },
  {
    "text": "things he's responsible for include msdtc which is a distributed transaction coordinator in the Microsoft space and",
    "start": "135599",
    "end": "143280"
  },
  {
    "text": "he wrote one of the original papers that led to dynamodb coming to existence which",
    "start": "143280",
    "end": "148980"
  },
  {
    "text": "influences things like Cassandra and Cosmos so perhaps reasonably",
    "start": "148980",
    "end": "155360"
  },
  {
    "text": "competent uh fella and Pat essentially his name and",
    "start": "155360",
    "end": "161700"
  },
  {
    "text": "career had been associated with two-phase commit and in 2007 he wrote a",
    "start": "161700",
    "end": "166920"
  },
  {
    "text": "paper which essentially said you know what two-phase commit is not the right solution in distributed systems",
    "start": "166920",
    "end": "174599"
  },
  {
    "text": "and his point was kind of two-fold and we'll dig into a lot of it later um one is that most of us don't actually",
    "start": "174599",
    "end": "181200"
  },
  {
    "text": "do TPC most developers do something else entirely and a little bit it's kind of",
    "start": "181200",
    "end": "186959"
  },
  {
    "text": "recognizing the reality of our space and quite often he didn't have a distributed transaction coordinator which worked",
    "start": "186959",
    "end": "193440"
  },
  {
    "text": "over all the things you were trying to use in other cases devs just simply found other ways around it",
    "start": "193440",
    "end": "200519"
  },
  {
    "text": "um but also Pat was looking at a number of other ideas in this article one of",
    "start": "200519",
    "end": "206640"
  },
  {
    "text": "them is probably the one we'll focus on today is service oriented architectures which are really a precursor to",
    "start": "206640",
    "end": "212819"
  },
  {
    "text": "microservices the other is he looked at some ideas for how you could create",
    "start": "212819",
    "end": "218459"
  },
  {
    "text": "um uh infinite scale data storage and that's really the ideas that lead to things like Dynamo well we won't really",
    "start": "218459",
    "end": "225180"
  },
  {
    "text": "talk about that part of the idea today because unless you're using Dynamo or Cosmos it's less relevant to you",
    "start": "225180",
    "end": "231900"
  },
  {
    "text": "and Pat also talked a little bit about the idea of saying that your application code should be scalognostic and we",
    "start": "231900",
    "end": "239040"
  },
  {
    "text": "should sit over some kind of invisible platform layer that effectively deals with scaling and a little bit those ideas today come from serverless",
    "start": "239040",
    "end": "245519"
  },
  {
    "text": "platforms or kubernetes and Pat was really a little bit ahead of his time",
    "start": "245519",
    "end": "251540"
  },
  {
    "text": "the other thing we'll talk about don't worry about reading the text I just didn't it doesn't have like a magazine image I can give you so that's just the",
    "start": "251760",
    "end": "258180"
  },
  {
    "text": "image from Pat's blog in 2020 Pat Uh released another paper called autonomous",
    "start": "258180",
    "end": "263880"
  },
  {
    "text": "computing and autonomous Computing is really an update of some of the ideas in life",
    "start": "263880",
    "end": "269160"
  },
  {
    "text": "beyond distributed transactions and it brings in some things around fiefdoms",
    "start": "269160",
    "end": "274680"
  },
  {
    "text": "um and emissaries that he hadn't really previously tied into his other work but",
    "start": "274680",
    "end": "279720"
  },
  {
    "text": "he had spoken about in the early noughties quite a lot of conferences and ties that all together with his stuff on",
    "start": "279720",
    "end": "286860"
  },
  {
    "text": "distributed transactions Etc so um this talk will cover both because I want to basically make sure you're",
    "start": "286860",
    "end": "292680"
  },
  {
    "text": "getting the kind of more current version of what Pat was talking about",
    "start": "292680",
    "end": "297560"
  },
  {
    "text": "just out of interest for anyone who doesn't really understand what we're saying when we say two-phase commit or",
    "start": "297720",
    "end": "303960"
  },
  {
    "text": "TPC occasionally so if I have two databases that are",
    "start": "303960",
    "end": "309000"
  },
  {
    "text": "essentially remote from each other right it could be I want to say database it could be a cluster as well as being a",
    "start": "309000",
    "end": "315000"
  },
  {
    "text": "database if I want them to both participate in a transaction so a typical example might",
    "start": "315000",
    "end": "322440"
  },
  {
    "text": "be customer makes an order and I want to update the amount of stock we have",
    "start": "322440",
    "end": "327600"
  },
  {
    "text": "something on hand right if I want to do that across two",
    "start": "327600",
    "end": "332940"
  },
  {
    "text": "databases let's imagine that I have a database that serves my stock management system be it a microservice or whatever",
    "start": "332940",
    "end": "339120"
  },
  {
    "text": "and a database that serves basically getting customer orders in effectively I'd want to take a lock in",
    "start": "339120",
    "end": "345960"
  },
  {
    "text": "both systems a lock effectively as I write the New Order and unlock as I decrement about the amount of stock that",
    "start": "345960",
    "end": "351720"
  },
  {
    "text": "I have of something and the way you do that in two-phase commit is you have a coordinator and the",
    "start": "351720",
    "end": "357479"
  },
  {
    "text": "coordinator sends a message to both databases saying hey can I lock that right can I lock that information",
    "start": "357479",
    "end": "364080"
  },
  {
    "text": "and then the individual databases vote and they say yep you can do that or no usually somebody else has got it locked",
    "start": "364080",
    "end": "370020"
  },
  {
    "text": "you can't do that and then as a result of that vote",
    "start": "370020",
    "end": "375060"
  },
  {
    "text": "the coordinator says okay we can either commit or essentially those of you that have",
    "start": "375060",
    "end": "380100"
  },
  {
    "text": "reserved that lot for me in our participation of my doing something can release it",
    "start": "380100",
    "end": "385680"
  },
  {
    "text": "and if everyone agrees then we write the data DTC has a performance penalty to us as",
    "start": "385680",
    "end": "392160"
  },
  {
    "text": "I'm sure you can imagine right because effectively the coordinator has to do this kind of double question",
    "start": "392160",
    "end": "398699"
  },
  {
    "text": "so the question Pat wanted to ask and as a person you know who who had spent their career in in uh two-phase commit",
    "start": "398699",
    "end": "405600"
  },
  {
    "text": "is what happens if we throw that away what happens if we say that's not available to you",
    "start": "405600",
    "end": "411840"
  },
  {
    "start": "409000",
    "end": "679000"
  },
  {
    "text": "all right so let's talk about fief terms one of uh Pat's first ideas",
    "start": "411840",
    "end": "416780"
  },
  {
    "text": "so a fiefdom those pink boxes pink hexagons in fact",
    "start": "418380",
    "end": "425460"
  },
  {
    "text": "um uh encapsulate their data and they say hey nobody else can take a lock on",
    "start": "425460",
    "end": "432900"
  },
  {
    "text": "my data it belongs to me and to nobody else and they have an explicit boundary",
    "start": "432900",
    "end": "441360"
  },
  {
    "text": "anything outside that boundary can't reach in and take locks on the data",
    "start": "441360",
    "end": "446759"
  },
  {
    "text": "inside that boundary",
    "start": "446759",
    "end": "450319"
  },
  {
    "text": "and because of that we tend to think of the thing inside the boundary as inside",
    "start": "452819",
    "end": "458280"
  },
  {
    "text": "data and we expose some kind of API we're not going to get into what that is just at",
    "start": "458280",
    "end": "465120"
  },
  {
    "text": "this point where effectively you can say well you can send me messages and I will update",
    "start": "465120",
    "end": "471360"
  },
  {
    "text": "the state of that data inside we also don't want to try and do some",
    "start": "471360",
    "end": "478020"
  },
  {
    "text": "kind of join to this data over HTTP or grpc or some",
    "start": "478020",
    "end": "484139"
  },
  {
    "text": "other kind of RPC connection so we don't expose what you might want to think of as a get endpoint to just grab our data",
    "start": "484139",
    "end": "492080"
  },
  {
    "text": "instead what we do is we publish a stream of events usually some kind of",
    "start": "492080",
    "end": "498300"
  },
  {
    "text": "syndicated stream which gives you facts we're willing to share about data inside",
    "start": "498300",
    "end": "507139"
  },
  {
    "text": "and that shared streamers of what we call outside data outside data has some properties right",
    "start": "507240",
    "end": "513539"
  },
  {
    "text": "it's immutable in other words it's a read-only thing that I've given you you can't there's no point in you changing",
    "start": "513539",
    "end": "519060"
  },
  {
    "text": "it the only way to change it is to send me a message on my API I update the inside data I issue some new outside",
    "start": "519060",
    "end": "525600"
  },
  {
    "text": "data and you store it and you tend to call it",
    "start": "525600",
    "end": "530820"
  },
  {
    "text": "reference data right where essentially because the notion is typically you're using for reference so",
    "start": "530820",
    "end": "536760"
  },
  {
    "text": "for example my current job is working for justic takeaway we effectively service",
    "start": "536760",
    "end": "542360"
  },
  {
    "text": "like you order from restaurants what we tend to do is publish the menu",
    "start": "542360",
    "end": "547860"
  },
  {
    "text": "and restaurant details so that other services or uis can read that data and",
    "start": "547860",
    "end": "553080"
  },
  {
    "text": "you just present options to you you don't do a get from your UI to say hey let's get the",
    "start": "553080",
    "end": "558600"
  },
  {
    "text": "menu from the restaurant from the service hey it's particularly slow right if you basically put it in a what we",
    "start": "558600",
    "end": "563760"
  },
  {
    "text": "call a forward cache you can essentially put it on cloudfront distribute it and get it from a from your phone or your",
    "start": "563760",
    "end": "569880"
  },
  {
    "text": "web browser so we don't want to do anything that",
    "start": "569880",
    "end": "575040"
  },
  {
    "text": "essentially says I'm reaching in to get hold of your data and we don't want to do get either",
    "start": "575040",
    "end": "581600"
  },
  {
    "text": "there's other little fancy things on the diagram so this set of messages that we send",
    "start": "583560",
    "end": "590880"
  },
  {
    "text": "back and forth as we interact with a victim Pat thinks them as a collaboration",
    "start": "590880",
    "end": "597120"
  },
  {
    "text": "when you hear collaboration you should think about dialogue conversation or workflow again we'll dig into more",
    "start": "597120",
    "end": "602519"
  },
  {
    "text": "detail on what it is in a little bit and that little little stick figure",
    "start": "602519",
    "end": "608580"
  },
  {
    "text": "that's an emissary it's an emissary helps you use the API",
    "start": "608580",
    "end": "614700"
  },
  {
    "text": "that is provided by a fiefdom a really simple example of an emissary",
    "start": "614700",
    "end": "622260"
  },
  {
    "text": "is a user interface and then you can see from this diagram",
    "start": "622260",
    "end": "628560"
  },
  {
    "text": "that while you might have originally thought oh feast and that's just a micro service right Ian",
    "start": "628560",
    "end": "633600"
  },
  {
    "text": "the reality is of fiefdom can a microservice is a fiefdom but other things are fiefdoms",
    "start": "633600",
    "end": "640080"
  },
  {
    "text": "so the app running on your phone is a fiefdom the app running in your user agent your",
    "start": "640080",
    "end": "645899"
  },
  {
    "text": "browser is also a fiefdom right",
    "start": "645899",
    "end": "650420"
  },
  {
    "text": "piston which contains other victims if you want to have boundaries that represent for example organizational and",
    "start": "656459",
    "end": "663420"
  },
  {
    "text": "departmental boundaries uh effectively you can invoke Conway's law and declare that a feat them and say there's stuff",
    "start": "663420",
    "end": "668760"
  },
  {
    "text": "inside and stuff outside right this talk is less about that last option but we're",
    "start": "668760",
    "end": "673800"
  },
  {
    "text": "more looking at the other pieces here that we're getting into okay",
    "start": "673800",
    "end": "680720"
  },
  {
    "start": "679000",
    "end": "875000"
  },
  {
    "text": "all right so we'll start off talking about this idea of collaborations",
    "start": "680880",
    "end": "687500"
  },
  {
    "text": "so I have a fiefdom victim a on it's the right hand side as I look at it it's the",
    "start": "689760",
    "end": "696120"
  },
  {
    "text": "right hand side for D2 and I want to do some work right",
    "start": "696120",
    "end": "701880"
  },
  {
    "text": "something stimulates that work I probably receive a request from outside there might be a timer event I might receive a message",
    "start": "701880",
    "end": "708720"
  },
  {
    "text": "and as part of that work I'm I'm doing some work in my domain and I realize I don't have responsibility for that",
    "start": "708720",
    "end": "715079"
  },
  {
    "text": "somebody else does so my typical example here is I am effectively part of my assistant the system that essentially",
    "start": "715079",
    "end": "721500"
  },
  {
    "text": "processes purchases for us I do some validation I check the prices I apply",
    "start": "721500",
    "end": "726839"
  },
  {
    "text": "some discounts Etc and I may have to call it other services right I might have to call another service to figure",
    "start": "726839",
    "end": "732480"
  },
  {
    "text": "out what are the offers that apply to this I may have to call another service or another feature in this case to say",
    "start": "732480",
    "end": "739019"
  },
  {
    "text": "well what are the what's the delivery fees for this I'm about to call another fiefdom and say hey can you take a",
    "start": "739019",
    "end": "745620"
  },
  {
    "text": "payment for this for me so I may not be doing all of the work and at some point I need to call",
    "start": "745620",
    "end": "751079"
  },
  {
    "text": "somebody else to do their part of the work so at some point I will wait",
    "start": "751079",
    "end": "757100"
  },
  {
    "text": "and I will transfer control to another fiefdom I'll say you have control now of this",
    "start": "758279",
    "end": "763920"
  },
  {
    "text": "workflow",
    "start": "763920",
    "end": "766399"
  },
  {
    "text": "and this interaction tends to result in a reply to me saying okay I I've given",
    "start": "770459",
    "end": "776760"
  },
  {
    "text": "you control you go and do your work and you give me a response back here are the delivery fees here is the discounts here",
    "start": "776760",
    "end": "782279"
  },
  {
    "text": "is the customer has paid and that is accepted right so this dialogue is kind of ongoing when",
    "start": "782279",
    "end": "789839"
  },
  {
    "text": "fiefdoms talk to each other",
    "start": "789839",
    "end": "793040"
  },
  {
    "text": "but this is uncertain because the other fiefdom might say",
    "start": "796320",
    "end": "803100"
  },
  {
    "text": "our customer didn't actually manage to take pay for that their car was declined",
    "start": "803100",
    "end": "808260"
  },
  {
    "text": "or we might say hey we don't deliver to that uh that space that's too far out of range",
    "start": "808260",
    "end": "813899"
  },
  {
    "text": "or we might say um hey those prices don't look right to me I don't know where the customer got them",
    "start": "813899",
    "end": "820019"
  },
  {
    "text": "from maybe somebody's trying to basically fool Us by uh you know hacking basically the front end to put in their",
    "start": "820019",
    "end": "826800"
  },
  {
    "text": "own prices and see what happens so there can be failures",
    "start": "826800",
    "end": "832260"
  },
  {
    "text": "well not failures but there can be paths basically other than the happy path",
    "start": "832260",
    "end": "838160"
  },
  {
    "text": "and so Pat says in a system that cannot count on distributed transactions the management of uncertainty must be",
    "start": "838500",
    "end": "844139"
  },
  {
    "text": "implemented in the business logic in other words when we don't have TPC",
    "start": "844139",
    "end": "849660"
  },
  {
    "text": "when we're not locking everything we're locking delivery fees and everything else basically what we end up doing is having these conversations",
    "start": "849660",
    "end": "856200"
  },
  {
    "text": "and it's all logic it's application code that replaces TPC",
    "start": "856200",
    "end": "861540"
  },
  {
    "text": "and in a sense what Pat's saying is he's recognizing that that's actually the way that most people build systems",
    "start": "861540",
    "end": "867420"
  },
  {
    "text": "they don't use two phase commit they write some code that eventually called other code so what does that mean if we",
    "start": "867420",
    "end": "873180"
  },
  {
    "text": "do that right what do we mean if we take that approach",
    "start": "873180",
    "end": "877279"
  },
  {
    "text": "so some coffee shops when you go to them",
    "start": "882360",
    "end": "887660"
  },
  {
    "text": "they have a cashier and they have a barista who's going to make the coffee and in these coffee shops cost a coffee",
    "start": "887880",
    "end": "894720"
  },
  {
    "text": "mentioning no names what happens is that uh I go up and I ask to pay",
    "start": "894720",
    "end": "900660"
  },
  {
    "text": "order my coffee and either in some cases whether I understaffed the cashier or is actually",
    "start": "900660",
    "end": "905820"
  },
  {
    "text": "the Barista guys it makes the coffee or they talk to their friend who's the Barista and they make the coffee",
    "start": "905820",
    "end": "911160"
  },
  {
    "text": "and essentially I stand there waiting blocking the whole queue",
    "start": "911160",
    "end": "916680"
  },
  {
    "text": "until my work is done I get the coffee back and I can go and sit down",
    "start": "916680",
    "end": "922139"
  },
  {
    "text": "and a queue will build up behind me",
    "start": "922139",
    "end": "927600"
  },
  {
    "text": "the constraint becomes really as fast as this Barista can work everyone will keep",
    "start": "927600",
    "end": "932820"
  },
  {
    "text": "and if you go into one of these coffee shops eventually no names cost a coffee people you'll see people walk out the back of the queue",
    "start": "932820",
    "end": "938760"
  },
  {
    "text": "even in the United Kingdom where as you all know we love queuing and we have our own special cue which",
    "start": "938760",
    "end": "946199"
  },
  {
    "text": "recently appeared on on television the height of britishness the best queue ever",
    "start": "946199",
    "end": "951899"
  },
  {
    "text": "um people joined it not because they like the royal family but because they liked the idea of joining the world's greatest",
    "start": "951899",
    "end": "957899"
  },
  {
    "text": "queue um even though we love queuing obviously it gets frustrating in the morning when",
    "start": "957899",
    "end": "964260"
  },
  {
    "text": "you're trying to get somewhere you haven't got time to wait Etc so you tend to give up right so Starbucks doesn't do that",
    "start": "964260",
    "end": "971579"
  },
  {
    "text": "in Starbucks what happens I think they actually have some kind of like you know potent on this model or whatever so it's",
    "start": "971579",
    "end": "978899"
  },
  {
    "text": "not about what happens they go up to the cashier and I say oh can I order a coffee and she writes basically the",
    "start": "978899",
    "end": "984300"
  },
  {
    "text": "details of my coffee on a cup it's an important thing she asked me for my name",
    "start": "984300",
    "end": "989699"
  },
  {
    "text": "we'll come back to where that is in a little bit and she essentially cues those cups for",
    "start": "989699",
    "end": "995339"
  },
  {
    "text": "the Barista so basically we just create a task queue same kind of thing you would do if you used a task you pattern",
    "start": "995339",
    "end": "1001220"
  },
  {
    "text": "right she puts those in a queue and the barista just comes and takes them off Services",
    "start": "1001220",
    "end": "1008120"
  },
  {
    "text": "them and gives them to the customers so the constraint now becomes really how",
    "start": "1008120",
    "end": "1015139"
  },
  {
    "text": "many Baristas do we have how many espresso machines do we have that's about as fast as we can work right and",
    "start": "1015139",
    "end": "1021380"
  },
  {
    "text": "then you tend to find the number depends on how much they think you know the throughput is going to be in that shop",
    "start": "1021380",
    "end": "1026540"
  },
  {
    "text": "now I still have to wait but generally speaking I'm prepared to wait once I've ordered my coffee uh because I can",
    "start": "1026540",
    "end": "1033140"
  },
  {
    "text": "something else check my phone or I've actually my coffee turns up right but this queuing strategy",
    "start": "1033140",
    "end": "1040339"
  },
  {
    "text": "is one we see a lot in software what do they ask for your name because",
    "start": "1040339",
    "end": "1046640"
  },
  {
    "text": "it's a correlation ID right same thing we do in messaging I send out a request I wait for a reply to my request",
    "start": "1046640",
    "end": "1054140"
  },
  {
    "text": "how do I know that reply what request it was for generally call it correlation ID they don't care in Starbucks if you go",
    "start": "1054140",
    "end": "1061039"
  },
  {
    "text": "in and when when you say what's your name you say Spartacus so that when basically the hand over a coffee for",
    "start": "1061039",
    "end": "1066080"
  },
  {
    "text": "Spartacus you can do the I'm Spartacus gag they don't care right well you can",
    "start": "1066080",
    "end": "1071299"
  },
  {
    "text": "call yourself anything I wouldn't try calling yourself a good because it's going to be hard for them to write down",
    "start": "1071299",
    "end": "1077299"
  },
  {
    "text": "um but they just want to correlate messages is that the same thing we do in messaging right",
    "start": "1077299",
    "end": "1083260"
  },
  {
    "text": "um by the way if you don't know how to build this kind of thing uh because sometimes I get this with apis if your",
    "start": "1083419",
    "end": "1090080"
  },
  {
    "text": "front end wants to say hey I've got your order I'm putting on a queue it's going",
    "start": "1090080",
    "end": "1095600"
  },
  {
    "text": "to go to the back end and the back end effectively will pull them off and do the work as it needs here's how you do",
    "start": "1095600",
    "end": "1101240"
  },
  {
    "text": "it you basically need to rely on https 202 accepted",
    "start": "1101240",
    "end": "1106520"
  },
  {
    "text": "to what to accept it says I've got your order I've got your your post request or whatever I ain't gonna give you an",
    "start": "1106520",
    "end": "1113179"
  },
  {
    "text": "answer right now but I got it which lets the person that's the UI Etc go okay and move on with something else",
    "start": "1113179",
    "end": "1120559"
  },
  {
    "text": "what you do is a cadda you give a URI usually to something you",
    "start": "1120559",
    "end": "1126500"
  },
  {
    "text": "can poll to find out the status of your your work so you just say okay great I'll poll",
    "start": "1126500",
    "end": "1132740"
  },
  {
    "text": "that and when it's done I can essentially tell my users effectively the work is now complete",
    "start": "1132740",
    "end": "1140360"
  },
  {
    "text": "um and they can go and do whatever they need to do right right um You can also use a push notification so in the link here you",
    "start": "1140360",
    "end": "1146539"
  },
  {
    "text": "simply say actually you're going to get a push notification over here sockets that kind of thing right",
    "start": "1146539",
    "end": "1151700"
  },
  {
    "text": "right but that way you effectively say when I get that request in I just put it on a queue I can then my web server will",
    "start": "1151700",
    "end": "1158480"
  },
  {
    "text": "get to it at some point and I'll give you back and usually we refer to what we call a task oriented UI where the user",
    "start": "1158480",
    "end": "1165380"
  },
  {
    "text": "goes in does a whole load of work to basically make selections to use their coffee choose the options everything",
    "start": "1165380",
    "end": "1170840"
  },
  {
    "text": "else that they need and then they press the magic button right and they expect when they press the magic button to have",
    "start": "1170840",
    "end": "1176059"
  },
  {
    "text": "to wait um they only want really that Speed and Performance when they're making selection choices",
    "start": "1176059",
    "end": "1182660"
  },
  {
    "start": "1181000",
    "end": "1457000"
  },
  {
    "text": "so what we do between fiefdoms is we use messaging",
    "start": "1182660",
    "end": "1189760"
  },
  {
    "text": "we don't use synchross communication between feed terms which implies holding open a transaction for a response to",
    "start": "1190520",
    "end": "1196460"
  },
  {
    "text": "update multiple entities we use messaging overall Pat's perspective",
    "start": "1196460",
    "end": "1204820"
  },
  {
    "text": "the HTTP these are not the things you want to use between victims right you want to use some kind of messaging solution",
    "start": "1205100",
    "end": "1211160"
  },
  {
    "text": "now you can title messaging over you know TCP IP https that's not what he's talking about",
    "start": "1211160",
    "end": "1216679"
  },
  {
    "text": "um but he's saying you have to send something that is kind of like hey I'm going to send you something like to your reply",
    "start": "1216679",
    "end": "1223299"
  },
  {
    "text": "okay so looking at my fiefdom on the right hand side of Houston a",
    "start": "1244039",
    "end": "1249559"
  },
  {
    "text": "you can see that I've started some work at some point what happens is I need to say okay I need to hand over work the",
    "start": "1249559",
    "end": "1256100"
  },
  {
    "text": "work is right just for application code which is effectively guiding this particular thing that I need to do",
    "start": "1256100",
    "end": "1261140"
  },
  {
    "text": "probably what happened is I got stimulated by a request or a message or some timer",
    "start": "1261140",
    "end": "1267260"
  },
  {
    "text": "to begin some work so the work begins and I need to hand over to another fiefdom at that point I'm going to have to store",
    "start": "1267260",
    "end": "1273799"
  },
  {
    "text": "some state because I now have an operation which effectively I'm going to stop",
    "start": "1273799",
    "end": "1279679"
  },
  {
    "text": "while I wait for a response from the other victim and I probably need to preserve some state to say Here's Where",
    "start": "1279679",
    "end": "1285559"
  },
  {
    "text": "I Was Here with a state of things when basically I gave up and then essentially send a message",
    "start": "1285559",
    "end": "1292640"
  },
  {
    "text": "I can go on and 50 million do other work Ed and B responds to that",
    "start": "1292640",
    "end": "1298520"
  },
  {
    "text": "picks up the message does its work and puts a reply back to me and I received a reply and I get on with",
    "start": "1298520",
    "end": "1304820"
  },
  {
    "text": "the rest of my work right so payment you can think of I need a payment I suspend basically working on that",
    "start": "1304820",
    "end": "1310940"
  },
  {
    "text": "order I put it in some state to put a you know put an enum on it for a state machine saying hey this order is pending",
    "start": "1310940",
    "end": "1316760"
  },
  {
    "text": "payment say that in my database and then eventually I send a message to other",
    "start": "1316760",
    "end": "1322039"
  },
  {
    "text": "systems saying hey can you take payment for it eventually it replies I get that message in and I say hey I got a payment there's",
    "start": "1322039",
    "end": "1328400"
  },
  {
    "text": "a correlation ID I will look that up okay that order is I can now Move Along its state",
    "start": "1328400",
    "end": "1334419"
  },
  {
    "text": "so Pat talks about these things being activities there's State machines that tracked incoming collaboration and a",
    "start": "1334820",
    "end": "1341600"
  },
  {
    "text": "sequence of messages this activity which is essentially your",
    "start": "1341600",
    "end": "1347539"
  },
  {
    "text": "code plus some state can do things like well",
    "start": "1347539",
    "end": "1353600"
  },
  {
    "text": "um hey I didn't get a response back on this one what I'm doing is looking at things that are in the pending State and",
    "start": "1353600",
    "end": "1359900"
  },
  {
    "text": "this has been in pending state for more than a certain amount of time maybe I will alert an operator maybe I will resend that particular request maybe it",
    "start": "1359900",
    "end": "1367159"
  },
  {
    "text": "got lost somewhere Etc right so activities become the things that",
    "start": "1367159",
    "end": "1372799"
  },
  {
    "text": "give you reliability",
    "start": "1372799",
    "end": "1375700"
  },
  {
    "text": "and reliability is not just simply about hey retry the operation that failed or",
    "start": "1379280",
    "end": "1384799"
  },
  {
    "text": "something um but uh",
    "start": "1384799",
    "end": "1390039"
  },
  {
    "text": "as I say maybe actively monitoring these activities that you have in progress",
    "start": "1390919",
    "end": "1397899"
  },
  {
    "text": "so as a result of that what tends to happen is that any one of our fiefdoms",
    "start": "1399919",
    "end": "1405620"
  },
  {
    "text": "our activity tends to store this concept",
    "start": "1405620",
    "end": "1410659"
  },
  {
    "text": "of I have sent a message I have received a message",
    "start": "1410659",
    "end": "1415760"
  },
  {
    "text": "and essentially this message history if you like becomes effectively the history of our",
    "start": "1415760",
    "end": "1423080"
  },
  {
    "text": "interaction with other fiefdoms via that activity in order to get work done",
    "start": "1423080",
    "end": "1430120"
  },
  {
    "text": "so each party in this dialogue this conversation each victim",
    "start": "1431840",
    "end": "1438020"
  },
  {
    "text": "essentially has a track of the conversation although they may have a track basically",
    "start": "1438020",
    "end": "1443419"
  },
  {
    "text": "as you know I sent this request I received this request I sent this reply I received this reply",
    "start": "1443419",
    "end": "1450080"
  },
  {
    "text": "but they're essentially tracking a conversation and both sides effectively have a copy of it",
    "start": "1450080",
    "end": "1457840"
  },
  {
    "start": "1457000",
    "end": "1517000"
  },
  {
    "text": "it may be the what happens is we have quite a lot of fiefdoms involved",
    "start": "1460400",
    "end": "1467299"
  },
  {
    "text": "so in this case fiefdom a says hey you know I need to basically get",
    "start": "1467299",
    "end": "1473360"
  },
  {
    "text": "um some uh discounts for your order as an example",
    "start": "1473360",
    "end": "1479780"
  },
  {
    "text": "to make sure I've actually applied the discount so it calls basically another feastum that deals with promotions and",
    "start": "1479780",
    "end": "1487880"
  },
  {
    "text": "that one says uh yeah well effectively in order to figure out all the promotions I have to figure out whether",
    "start": "1487880",
    "end": "1494120"
  },
  {
    "text": "this customer is on our loyalty program or our subscription",
    "start": "1494120",
    "end": "1500240"
  },
  {
    "text": "program so I'm going to call this other fiefdom that deals with that and ask it a question and say hey is this basically",
    "start": "1500240",
    "end": "1507020"
  },
  {
    "text": "a customer on that program it gives me a response back I then can basically update my calculation and then I reply",
    "start": "1507020",
    "end": "1514159"
  },
  {
    "text": "back to the initial item initial caller so these things move",
    "start": "1514159",
    "end": "1520400"
  },
  {
    "start": "1517000",
    "end": "1643000"
  },
  {
    "text": "across a number of fiefdoms and so an activity can essentially",
    "start": "1520400",
    "end": "1527299"
  },
  {
    "text": "initiate a new collaboration which is in other words to say rather than just simply the work I received I'm executing",
    "start": "1527299",
    "end": "1535340"
  },
  {
    "text": "it and calling one other fiefdom that requires an uh responds to me what I'm",
    "start": "1535340",
    "end": "1540620"
  },
  {
    "text": "kicking off is actually if you're like a sub workflow that will complete and then",
    "start": "1540620",
    "end": "1546200"
  },
  {
    "text": "come back to me and then I can resume my workflow okay so each one of those workflows is what",
    "start": "1546200",
    "end": "1553220"
  },
  {
    "text": "we think of as a collaboration and it may be that you kick off a sub workflow in order that has to complete",
    "start": "1553220",
    "end": "1560059"
  },
  {
    "text": "before you can complete uh yourself",
    "start": "1560059",
    "end": "1564640"
  },
  {
    "text": "typically we need a correlation ID which essentially mentioned with name right if",
    "start": "1566419",
    "end": "1572059"
  },
  {
    "text": "I'm sending out requests and I'm getting responses back and they're coming in effectively asynchronously I need to",
    "start": "1572059",
    "end": "1577940"
  },
  {
    "text": "match them up and say oh okay this is a response on the payment request for this order this is response on discounts or",
    "start": "1577940",
    "end": "1583820"
  },
  {
    "text": "delivery fees for this order essentially I go and retrieve that from the database up data according to the response that",
    "start": "1583820",
    "end": "1590000"
  },
  {
    "text": "I've received and move my workflow on right we may also want to record some kind of",
    "start": "1590000",
    "end": "1597260"
  },
  {
    "text": "conversation ID the conversation ID will tell us there's",
    "start": "1597260",
    "end": "1603980"
  },
  {
    "text": "a part of a larger collaboration you know",
    "start": "1603980",
    "end": "1609140"
  },
  {
    "text": "about the flow this particular message exchange which other fiefdom by correlation ID but actually you are just",
    "start": "1609140",
    "end": "1616100"
  },
  {
    "text": "one Exchange in part of a larger workflow which is with basically this conversational dialogue we're having",
    "start": "1616100",
    "end": "1622279"
  },
  {
    "text": "which we also want an ID for and that means we can track and figure out what the hell is going on at times right",
    "start": "1622279",
    "end": "1628340"
  },
  {
    "text": "okay often that conversation may have a natural ID",
    "start": "1628340",
    "end": "1634340"
  },
  {
    "text": "that makes sense the order ID for example may actually be useful as the conversation ID that tells you what is",
    "start": "1634340",
    "end": "1641120"
  },
  {
    "text": "happening so these collaborations",
    "start": "1641120",
    "end": "1649220"
  },
  {
    "start": "1643000",
    "end": "1847000"
  },
  {
    "text": "represent at least one request reply but probably more",
    "start": "1649220",
    "end": "1655340"
  },
  {
    "text": "okay and it's this workflow that represents all of the interactions between fiefdoms we need to do to get",
    "start": "1655340",
    "end": "1661340"
  },
  {
    "text": "work done so we can think about the idea that this",
    "start": "1661340",
    "end": "1668179"
  },
  {
    "text": "activity provides orchestration so if you've heard the terms orchestration and",
    "start": "1668179",
    "end": "1673279"
  },
  {
    "text": "choreography orchestration is when essentially we arrange something and there is somebody in charge they are",
    "start": "1673279",
    "end": "1680480"
  },
  {
    "text": "directing the flow and choreography is when there's no one really in charge it's just the interactions we tend to",
    "start": "1680480",
    "end": "1687740"
  },
  {
    "text": "often say oh we prefer orchestration to choreography because if I put somebody in charge that causes a problem for me",
    "start": "1687740",
    "end": "1694820"
  },
  {
    "text": "because I am I'm now coupled on my services to this person in charge and essentially I can't really change",
    "start": "1694820",
    "end": "1701299"
  },
  {
    "text": "anything and quite often we worry that I end up with what's called an entity service because all of my natural",
    "start": "1701299",
    "end": "1707179"
  },
  {
    "text": "business logic moves into this coordinator and doesn't actually remain in the",
    "start": "1707179",
    "end": "1712760"
  },
  {
    "text": "actual domain based micro services or food terms in our case but what we're doing here is slightly",
    "start": "1712760",
    "end": "1719539"
  },
  {
    "text": "different right the fiefdoms just orchestrating its individual interaction",
    "start": "1719539",
    "end": "1725539"
  },
  {
    "text": "with one other partner it's not orchestrating all interactions",
    "start": "1725539",
    "end": "1731260"
  },
  {
    "text": "and it leaves basically not externally but within the service that owns that",
    "start": "1733760",
    "end": "1739940"
  },
  {
    "text": "interaction the thing that got kicked off that says hey I'm the process orders fiefdom I do processing of orders I",
    "start": "1739940",
    "end": "1747500"
  },
  {
    "text": "understand the domain of what needs to be done to process an order I hold that logic not an external",
    "start": "1747500",
    "end": "1755059"
  },
  {
    "text": "process manager coordinator or something else",
    "start": "1755059",
    "end": "1759760"
  },
  {
    "text": "and that means I don't violate say the micro Services rule of smart endpoints and downpipes right the smart the",
    "start": "1760399",
    "end": "1767659"
  },
  {
    "text": "business logic still lives within my service I haven't externalized it to some kind of coordinator which says I am",
    "start": "1767659",
    "end": "1774919"
  },
  {
    "text": "running the workflow my individual fiefdom knows how to run",
    "start": "1774919",
    "end": "1780260"
  },
  {
    "text": "its portion of an overall collaboration because it knows who it has to interact with right and each side in that in that",
    "start": "1780260",
    "end": "1787820"
  },
  {
    "text": "dialogue interaction has a record of the of the of the interaction through the messages that flow through it",
    "start": "1787820",
    "end": "1795398"
  },
  {
    "text": "choreography exists here in how all of",
    "start": "1797740",
    "end": "1802940"
  },
  {
    "text": "these individual conversations these orchestrations fit together to form a",
    "start": "1802940",
    "end": "1808580"
  },
  {
    "text": "collaboration so we still essentially get a lot of that loose coupling that choreography",
    "start": "1808580",
    "end": "1815600"
  },
  {
    "text": "offers us but we couple it with the ability for individual feastum to orchestrate their",
    "start": "1815600",
    "end": "1821899"
  },
  {
    "text": "reaction its interaction with a partner so there's a dichotomy between",
    "start": "1821899",
    "end": "1827779"
  },
  {
    "text": "orchestration and choreography where we think about having a orchestrator as this externalized service is a bit of a",
    "start": "1827779",
    "end": "1834860"
  },
  {
    "text": "false dichotomy for Pat because really what he's suggesting is that orchestration is something that an",
    "start": "1834860",
    "end": "1840860"
  },
  {
    "text": "individual fiefdom does in order to interact with other fiefdoms",
    "start": "1840860",
    "end": "1847120"
  },
  {
    "start": "1847000",
    "end": "1985000"
  },
  {
    "text": "and it's important to try and think about why we want to do this often",
    "start": "1848299",
    "end": "1853700"
  },
  {
    "text": "we have causality in a workflow that's cause and effect right",
    "start": "1853700",
    "end": "1859159"
  },
  {
    "text": "in order to essentially take this order that you've given me and move it to",
    "start": "1859159",
    "end": "1864740"
  },
  {
    "text": "fulfillment so it gets shipped from the warehouse cooked in the kitchen whatever your your domain is",
    "start": "1864740",
    "end": "1871159"
  },
  {
    "text": "I need to make sure that I've taken a payment",
    "start": "1871159",
    "end": "1876220"
  },
  {
    "text": "so I have cause and effect right in the sense that I have from my point of view of process orders before I move to the",
    "start": "1877039",
    "end": "1883880"
  },
  {
    "text": "Fulfillment step of raising a message to say to fulfillment hey fulfillment you can get on with this now",
    "start": "1883880",
    "end": "1889700"
  },
  {
    "text": "right I need to have called the piece that says hey I'm going to process the payment or I'm going to calculate the",
    "start": "1889700",
    "end": "1895340"
  },
  {
    "text": "discount so I'm going to calculate the delivery fees there is a sequence in which stuff needs to be done",
    "start": "1895340",
    "end": "1901039"
  },
  {
    "text": "okay and so by by orchestrating those Steps",
    "start": "1901039",
    "end": "1906500"
  },
  {
    "text": "From Within my own fiefdom I can make sure that causality is applied and there's I don't talk about",
    "start": "1906500",
    "end": "1912440"
  },
  {
    "text": "it there's nothing on the slide here but there's a problem space we refer to as an event chain where people essentially",
    "start": "1912440",
    "end": "1917720"
  },
  {
    "text": "throw away cause and effect and just say I'm only going to raise events I'm never going to send a command and the problem is we don't know what",
    "start": "1917720",
    "end": "1925399"
  },
  {
    "text": "sequence things are happening anymore right and sometimes it works and then you scale up effectively and discover",
    "start": "1925399",
    "end": "1930760"
  },
  {
    "text": "wow I got timing issues all over the shop and I've got things happening out of order",
    "start": "1930760",
    "end": "1936640"
  },
  {
    "text": "so this orchestration preserves cause and effect for us",
    "start": "1937159",
    "end": "1942759"
  },
  {
    "text": "and the activity can manage unhappy paths too",
    "start": "1945919",
    "end": "1950139"
  },
  {
    "text": "so if effectively someone says hey that payment was declined or we couldn't calculate basically the offer or that",
    "start": "1951020",
    "end": "1957200"
  },
  {
    "text": "person has been banned as a customer uh you shouldn't be you shouldn't be offering them any service that response",
    "start": "1957200",
    "end": "1963200"
  },
  {
    "text": "comes back then the process orders fifth term 50 may it simply says great I know what to do with that just another flow",
    "start": "1963200",
    "end": "1969559"
  },
  {
    "text": "right to this state machine that you're running essentially in the fiefdom is",
    "start": "1969559",
    "end": "1974960"
  },
  {
    "text": "able to react to failures and then do other work so maybe it causes an entirely different Freedom that says hey",
    "start": "1974960",
    "end": "1980659"
  },
  {
    "text": "I need to talk to you because there are failures and other interactions",
    "start": "1980659",
    "end": "1986539"
  },
  {
    "start": "1985000",
    "end": "2065000"
  },
  {
    "text": "so fifteen's might for example want to perform tentative operations this is very similar to what we want we saw in",
    "start": "1986539",
    "end": "1991940"
  },
  {
    "text": "TPC where essentially I say hey you're purchasing a ticket or you're buying",
    "start": "1991940",
    "end": "1997580"
  },
  {
    "text": "some stock or whatever and that transaction might fall through there might be no payment the customer might",
    "start": "1997580",
    "end": "2002980"
  },
  {
    "text": "have bought before the end so what I want you to do for me is I want to basically Reserve that particular",
    "start": "2002980",
    "end": "2010299"
  },
  {
    "text": "resource right so so did other Freedom how can you reserve Reserve that resource for me",
    "start": "2010299",
    "end": "2015760"
  },
  {
    "text": "I think someone says fine that's yours and quite often gives me a time figure yeah that's yours for 10 minutes 10",
    "start": "2015760",
    "end": "2021880"
  },
  {
    "text": "minutes time I don't hear back from you I will effectively abort basically holding the reservation",
    "start": "2021880",
    "end": "2026980"
  },
  {
    "text": "you then do your work and essentially at some point you say hey it's fine that's great I want that stock or",
    "start": "2026980",
    "end": "2035200"
  },
  {
    "text": "you say hey I don't want that at all can we have bought that operation and you can see essentially you're doing",
    "start": "2035200",
    "end": "2041980"
  },
  {
    "text": "something very similar to what TPC does but I'm just doing it from application code running in my feed term I have some",
    "start": "2041980",
    "end": "2048280"
  },
  {
    "text": "kind of estate machine I'm application code and essentially what I say is hey I'm just going to send a message asking",
    "start": "2048280",
    "end": "2053679"
  },
  {
    "text": "you to reserve I get a response back that's great I go on with my workflow hey I'm going to commit that I want to",
    "start": "2053679",
    "end": "2059858"
  },
  {
    "text": "basically purchase those tickets or buy that stock",
    "start": "2059859",
    "end": "2064138"
  },
  {
    "start": "2065000",
    "end": "2092000"
  },
  {
    "text": "so while this looks a lot like TPC and it also looks a lot for those of you",
    "start": "2067240",
    "end": "2072280"
  },
  {
    "text": "familiar with it something like The Saga pattern it's important to recognize one of the big differences is there's no",
    "start": "2072280",
    "end": "2077679"
  },
  {
    "text": "Central coordinator application code running in the freedom",
    "start": "2077679",
    "end": "2083980"
  },
  {
    "text": "is all that manages by the flow of messages what we need to do in order to make the",
    "start": "2083980",
    "end": "2089560"
  },
  {
    "text": "whole collaboration work okay",
    "start": "2089560",
    "end": "2096779"
  },
  {
    "start": "2092000",
    "end": "2246000"
  },
  {
    "text": "let's talk a little bit about uh let's just type so this stuff is not from Pat this comes uh from Clements vasters um",
    "start": "2097540",
    "end": "2105460"
  },
  {
    "text": "but it's useful to the conversation to to have to try it in here so people like Clements have been",
    "start": "2105460",
    "end": "2111760"
  },
  {
    "text": "talking about this difference between what they see as messaging and Eventing there is some argument about the terms",
    "start": "2111760",
    "end": "2117280"
  },
  {
    "text": "uh but just to understand basically what they mean messaging has intent please buy me a",
    "start": "2117280",
    "end": "2124119"
  },
  {
    "text": "coffee uh events basically provide facts I'm thirsty",
    "start": "2124119",
    "end": "2130240"
  },
  {
    "text": "but we're passive aggressive events I would really like a coffee which is sent to one person with the expressive",
    "start": "2130240",
    "end": "2136359"
  },
  {
    "text": "intention that they would get you a coffee that is basically a command you are fooling yourself it's basically what we call a passive aggressive event",
    "start": "2136359",
    "end": "2144299"
  },
  {
    "text": "and I'm British so you know uh all right so messages can do things that request",
    "start": "2145180",
    "end": "2151960"
  },
  {
    "text": "an answer they can transfer control which is the kind of thing we've just been seeing I send you a command please carry out some instruction for me and",
    "start": "2151960",
    "end": "2158320"
  },
  {
    "text": "let me know when it's done um they can transfer value hey I finished working on this it's yours now",
    "start": "2158320",
    "end": "2165040"
  },
  {
    "text": "you do whatever you need right and generally messaging is part of a",
    "start": "2165040",
    "end": "2170500"
  },
  {
    "text": "work for our conversation there is usually a dialogue involved here sometimes we do far and forget we",
    "start": "2170500",
    "end": "2175660"
  },
  {
    "text": "essentially say hey I'm giving you an instruction you know what I'm not giving you the right to refuse",
    "start": "2175660",
    "end": "2180820"
  },
  {
    "text": "um I expect you to just basically do it and maybe we'll just deal with any problems out of band right customer will",
    "start": "2180820",
    "end": "2186160"
  },
  {
    "text": "phone up and complain right um by contrast events tend to be no",
    "start": "2186160",
    "end": "2192099"
  },
  {
    "text": "expectations they're historical they represent state that happened in that fiefdom I'm notifying you about it but",
    "start": "2192099",
    "end": "2198280"
  },
  {
    "text": "there are usually zero or more receivers zero or more is important right I don't know whether anyone's actually going to",
    "start": "2198280",
    "end": "2204400"
  },
  {
    "text": "do anything with the fact that I'm thirsty maybe they'll bring me water maybe they'll bring me a coffee maybe I'll get lucky but I'm not have I don't",
    "start": "2204400",
    "end": "2211119"
  },
  {
    "text": "have an expectation out there a lot of what I'm basically shipping to you is something happened here often executed a",
    "start": "2211119",
    "end": "2217420"
  },
  {
    "text": "command it may be of interest to you and you may want to deal with that it's how we build data lakes and it's how we",
    "start": "2217420",
    "end": "2223359"
  },
  {
    "text": "build reference data which we'll come to in a second okay it's a monologue usually right not",
    "start": "2223359",
    "end": "2230920"
  },
  {
    "text": "a dialogue you are simply saying here is some information I am not entering into",
    "start": "2230920",
    "end": "2236079"
  },
  {
    "text": "discussion with you about it and messaging is the future",
    "start": "2236079",
    "end": "2243099"
  },
  {
    "text": "and Eventing is the past so messaging says I propose the world",
    "start": "2243099",
    "end": "2250180"
  },
  {
    "text": "looks like this to somebody else all right or can you make the world look like this can you take a payment for me",
    "start": "2250180",
    "end": "2256359"
  },
  {
    "text": "right can you apply discounts can you play offers only a fiefdom has a notion of now for",
    "start": "2256359",
    "end": "2264700"
  },
  {
    "text": "things that are owns as soon as data leaves the feast and it becomes effectively style right because",
    "start": "2264700",
    "end": "2272140"
  },
  {
    "text": "essentially it can only represent what we what it knew at the time that it gave you a response or issued an event",
    "start": "2272140",
    "end": "2278800"
  },
  {
    "text": "so if we want to update something and say hey future future people",
    "start": "2278800",
    "end": "2283839"
  },
  {
    "text": "what does this look like I have to send it basically to another fiefdom and say please update it based on your context",
    "start": "2283839",
    "end": "2289240"
  },
  {
    "text": "of now and tell me what happened so jobs work that kind of thing where I",
    "start": "2289240",
    "end": "2294940"
  },
  {
    "text": "have an expectation that you do it tend to be done by commands and it's these that you see a lot of",
    "start": "2294940",
    "end": "2300700"
  },
  {
    "text": "activities dealing with events are past States you want to get a response back",
    "start": "2300700",
    "end": "2306940"
  },
  {
    "text": "it will be an event of some sort right because it represents past State hey I I",
    "start": "2306940",
    "end": "2312160"
  },
  {
    "text": "a payment was made that happened it's not happening now right",
    "start": "2312160",
    "end": "2318400"
  },
  {
    "text": "and we have to be aware of that past date because essentially sometimes it may no longer be accurate right here is",
    "start": "2318400",
    "end": "2324160"
  },
  {
    "text": "that but here is basically the customers address in case you need it in the future but the customer may have gone",
    "start": "2324160",
    "end": "2330220"
  },
  {
    "text": "and updated that just moments after I gave you that information you're hoping I will send you another event later",
    "start": "2330220",
    "end": "2336099"
  },
  {
    "text": "which will update you so that you can catch up and so when I receive a reply is one of",
    "start": "2336099",
    "end": "2342940"
  },
  {
    "text": "these basically activities it's generally an event I'm receiving events tend to come in two forms series",
    "start": "2342940",
    "end": "2349240"
  },
  {
    "text": "and discrete so discrete ones say oh hey you know what here's an event",
    "start": "2349240",
    "end": "2354760"
  },
  {
    "text": "um I'm sending it to you you didn't really ask me for it um please can you react to it and Sarah's events basically say uh hey",
    "start": "2354760",
    "end": "2362440"
  },
  {
    "text": "I'd like to ask you for information about this so it's How We Do queries instead of doing get right",
    "start": "2362440",
    "end": "2368200"
  },
  {
    "text": "discrete continuous discrete basically effectively there's just one of them you take you handle that you're not looking",
    "start": "2368200",
    "end": "2374380"
  },
  {
    "text": "for others continuous I'm subscribed to it and it will keep sending me more updates it's syndicated",
    "start": "2374380",
    "end": "2379420"
  },
  {
    "text": "independent in other words for actually I deal with this one doesn't burn any relation to the others this replies that reply to that request to the request of",
    "start": "2379420",
    "end": "2386440"
  },
  {
    "text": "like a payment it's not reply to other requests it's not related to other requests to make payment",
    "start": "2386440",
    "end": "2392200"
  },
  {
    "text": "sequential uh this represents some data like uh changes to a customer account",
    "start": "2392200",
    "end": "2397240"
  },
  {
    "text": "and you'll want to keep listening to it because you want to get all the changes and they're related to each other",
    "start": "2397240",
    "end": "2403560"
  },
  {
    "text": "immediately actionable generally you receive a reply and you expect to do something right hey the payment was",
    "start": "2404020",
    "end": "2409359"
  },
  {
    "text": "updated I'm going to advance the workflow um or the fear is basically conditional",
    "start": "2409359",
    "end": "2415359"
  },
  {
    "text": "context so it's saying hey this is the state right now the customer you may need that information in the future",
    "start": "2415359",
    "end": "2421180"
  },
  {
    "text": "and discrete is part of the conversation it's a reply usually and Sarah is effectively as part of a monologue it's",
    "start": "2421180",
    "end": "2427060"
  },
  {
    "text": "essentially that service telling me stuff um but uh it's not expecting a reply or",
    "start": "2427060",
    "end": "2433540"
  },
  {
    "text": "response from me so to go back to sort of a reference data that we were looking at earlier reference data is when essentially I say",
    "start": "2433540",
    "end": "2440740"
  },
  {
    "start": "2434000",
    "end": "2532000"
  },
  {
    "text": "here are some facts about the data I hold you may want in the future",
    "start": "2440740",
    "end": "2448740"
  },
  {
    "text": "you may want to have the product catalog so that you can make orders right we",
    "start": "2448780",
    "end": "2454839"
  },
  {
    "text": "ship you with menus we do that by effectively publishing putting an S3 buck in publishing and cloudfront so you can pick them up from your web app or",
    "start": "2454839",
    "end": "2461020"
  },
  {
    "text": "your phone so that you can effectively then the customers can make orders right you",
    "start": "2461020",
    "end": "2466660"
  },
  {
    "text": "don't do a get and ask us for it we publish it to you ahead of time right and reference data is a really",
    "start": "2466660",
    "end": "2474040"
  },
  {
    "text": "important part of how we tend to scale in event driven architectures it says don't do gets to other services because",
    "start": "2474040",
    "end": "2480579"
  },
  {
    "text": "that introduces temporal coupling and synchronous conversations subscribe to a stream of data from them",
    "start": "2480579",
    "end": "2487540"
  },
  {
    "text": "which you can store locally and you just look up in your local forward cache of that data",
    "start": "2487540",
    "end": "2495099"
  },
  {
    "text": "when you need it so you don't do gets anymore right this is all part of this idea of your",
    "start": "2495099",
    "end": "2501579"
  },
  {
    "text": "data living inside your fiefdom is not available to me but outside data is available to me",
    "start": "2501579",
    "end": "2508240"
  },
  {
    "text": "okay all right this is basically a monologue got some Pat sometimes calls it a",
    "start": "2508240",
    "end": "2514780"
  },
  {
    "text": "syndication right uh his example effectively is the old school you know Sears catalog that would drop for three",
    "start": "2514780",
    "end": "2521020"
  },
  {
    "text": "people's letterboxes and then they could effectively make orders from them that's actually what this reference data is",
    "start": "2521020",
    "end": "2528480"
  },
  {
    "text": "the point all right uh emissaries emissaries are essentially the way we interact with fief terms and the simple",
    "start": "2531700",
    "end": "2537640"
  },
  {
    "start": "2532000",
    "end": "2613000"
  },
  {
    "text": "way of thinking about emissaries is basically a UI though it could be an SDK typically this is the way you begin to",
    "start": "2537640",
    "end": "2544540"
  },
  {
    "text": "realize that a future as well as being a microservice could also be basically a user agent or a phone app right",
    "start": "2544540",
    "end": "2550660"
  },
  {
    "text": "and essentially quite often it's using the reference data to make selections and from those selections it makes",
    "start": "2550660",
    "end": "2555940"
  },
  {
    "text": "requests basically to the victim for action",
    "start": "2555940",
    "end": "2560099"
  },
  {
    "text": "Christians don't trust our emissaries they validate the data that comes through them",
    "start": "2561520",
    "end": "2567300"
  },
  {
    "text": "the way to think about this often best in order to basically make this work system is to conceptually believe that",
    "start": "2568200",
    "end": "2574180"
  },
  {
    "text": "your Emissary is always offline and by that we mean you should provide your membership the",
    "start": "2574180",
    "end": "2579940"
  },
  {
    "text": "data it needs to do its work and when effectively at the end you need to basically have action from the fiefdom",
    "start": "2579940",
    "end": "2585280"
  },
  {
    "text": "you hit kind of a button and you send it to the back end you cue it for being sent to the back end so even when you're for example taking",
    "start": "2585280",
    "end": "2591520"
  },
  {
    "text": "an order from a customer on an e-commerce site you give them all the data they need to basically build up the order or the product catalog information",
    "start": "2591520",
    "end": "2598540"
  },
  {
    "text": "or the data they need they build up the order and the point where effectively they hit the button you can pretend kind",
    "start": "2598540",
    "end": "2603760"
  },
  {
    "text": "of up to then you're all offline and essentially that's the only point you need to communicate when you effectively then say I'm going to send something to",
    "start": "2603760",
    "end": "2609339"
  },
  {
    "text": "the back end to actually get work done all right",
    "start": "2609339",
    "end": "2615040"
  },
  {
    "start": "2613000",
    "end": "2998000"
  },
  {
    "text": "so we said hey we don't use synchross communication between these victims we use messaging",
    "start": "2615040",
    "end": "2621880"
  },
  {
    "text": "so it's important thing to understand is that if I send a message to represent some change in state I've",
    "start": "2621880",
    "end": "2627940"
  },
  {
    "text": "updated my local activity and I now have said basically we are now in the payment pending status it would imply that I've",
    "start": "2627940",
    "end": "2635380"
  },
  {
    "text": "also sent uh a message which says hey please can you take the payment",
    "start": "2635380",
    "end": "2640660"
  },
  {
    "text": "and the problem is if I live in a world without two-phase commit and that's quite likely that with between a",
    "start": "2640660",
    "end": "2646359"
  },
  {
    "text": "database and say a message broker I wouldn't have a coordinator because they come from different vendors anyway",
    "start": "2646359",
    "end": "2652180"
  },
  {
    "text": "there's a real danger that essentially I would update basically the data and move it to payment pending but the message",
    "start": "2652180",
    "end": "2657339"
  },
  {
    "text": "doesn't get sent so it's important when we do this to",
    "start": "2657339",
    "end": "2663400"
  },
  {
    "text": "have transactional messaging by which we mean that the message must be guaranteed to be sent if we change the state",
    "start": "2663400",
    "end": "2669880"
  },
  {
    "text": "locally a typical way to do that is called the outbox pattern",
    "start": "2669880",
    "end": "2674980"
  },
  {
    "text": "so in the outbox plan what we do is we create a we create another table that basically says hey we're going to set",
    "start": "2674980",
    "end": "2680140"
  },
  {
    "text": "the messages in here that we're going to send and then in a transaction",
    "start": "2680140",
    "end": "2688200"
  },
  {
    "text": "we can right basically a transaction that both insert makes the change to our activity to look we're clearing out what",
    "start": "2688780",
    "end": "2694480"
  },
  {
    "text": "resources are related but Resource as well right and at the same time create the message that goes alongside them",
    "start": "2694480",
    "end": "2702099"
  },
  {
    "text": "and then we simply pull the outbox table",
    "start": "2702099",
    "end": "2708000"
  },
  {
    "text": "by a worker process or thread for anything that hasn't been sent yet and we send it",
    "start": "2709660",
    "end": "2716140"
  },
  {
    "text": "and then we mark it Ascent when the broker tells us it's it's done all right",
    "start": "2716140",
    "end": "2722520"
  },
  {
    "text": "and that effectively means that we guarantee that our message is that are outgoing",
    "start": "2722800",
    "end": "2728200"
  },
  {
    "text": "represent our internal State and in a sense this is basically part of what activity is doing it's recording",
    "start": "2728200",
    "end": "2733599"
  },
  {
    "text": "outgoing messages",
    "start": "2733599",
    "end": "2736319"
  },
  {
    "text": "we don't know whether or not effectively the failure",
    "start": "2745119",
    "end": "2751540"
  },
  {
    "text": "for a broker to acknowledge that the message was sent comes because it didn't actually send the message or",
    "start": "2751540",
    "end": "2757780"
  },
  {
    "text": "which we didn't receive the acknowledgment we can't ever really know that it could just be a network connection failure on the response it could be that",
    "start": "2757780",
    "end": "2765339"
  },
  {
    "text": "the broker effectively just timed out doing it but effectively in the end replicates it all around its cluster and",
    "start": "2765339",
    "end": "2770500"
  },
  {
    "text": "the asynchronous response we get um uh does it says it failed but we already succeeded and so the risk there",
    "start": "2770500",
    "end": "2776619"
  },
  {
    "text": "are effectively is that we end up because we don't Mark basically that item as sent in our message box from our",
    "start": "2776619",
    "end": "2782800"
  },
  {
    "text": "worker thread or process sending it twice",
    "start": "2782800",
    "end": "2787619"
  },
  {
    "text": "right you didn't respond to me to say the message was sent within a certain time frame effectively I look at my",
    "start": "2788020",
    "end": "2793420"
  },
  {
    "text": "track of unsent messages and I say well this message has been sitting and sitting here in my outbox table marked as unseen for too long I better resend",
    "start": "2793420",
    "end": "2800380"
  },
  {
    "text": "it it may be that eventually the broker is going to respond and tell me yeah it was sent but I can't take that risk I need",
    "start": "2800380",
    "end": "2806200"
  },
  {
    "text": "to resend it because I've got timing of the whole operation at stake here",
    "start": "2806200",
    "end": "2811540"
  },
  {
    "text": "and that means I you should expect duplicates and because you should expect duplicates",
    "start": "2811540",
    "end": "2817900"
  },
  {
    "text": "you need to have some way of saying I need to I need to deal with that problem now you could just be item potent",
    "start": "2817900",
    "end": "2823180"
  },
  {
    "text": "in which case effectively reapplying that change doesn't matter and that's more typical with events with commands that are requests for work it's often",
    "start": "2823180",
    "end": "2829660"
  },
  {
    "text": "difficult to do it twice so we create a thing called an inbox",
    "start": "2829660",
    "end": "2834660"
  },
  {
    "text": "and we say I'm going to recall all the messages I've received and then I'll just look up and see",
    "start": "2835900",
    "end": "2842260"
  },
  {
    "text": "whether I've received that message already and if I have I don't need to action it",
    "start": "2842260",
    "end": "2848500"
  },
  {
    "text": "so remember activities not only do messages we have sent but they also do messages we receive",
    "start": "2848500",
    "end": "2854818"
  },
  {
    "text": "the other alternative is out in potents right they're a notion substantive side effects you can just ignore the fact that you do the the inbox so sometimes",
    "start": "2855099",
    "end": "2861220"
  },
  {
    "text": "for example if I receive a reply saying payment was made for an order I don't necessarily need to worry about by",
    "start": "2861220",
    "end": "2866440"
  },
  {
    "text": "checking that in a inbox because if I reapply the order was paid for well the order was still paid for",
    "start": "2866440",
    "end": "2874140"
  },
  {
    "text": "we may also need to reissue our response if we get a",
    "start": "2876460",
    "end": "2883060"
  },
  {
    "text": "repeat message we get something comes into our inbox says can you do this again",
    "start": "2883060",
    "end": "2889300"
  },
  {
    "text": "we don't necessarily know whether that might be a deliberate resend because something downstreaming from us has failed so we quite often had to have the",
    "start": "2889300",
    "end": "2896020"
  },
  {
    "text": "capability in our inbox to say actually you know what you should resend the",
    "start": "2896020",
    "end": "2901060"
  },
  {
    "text": "message that you had before typically if you have an outbox you can just clear the published value on the",
    "start": "2901060",
    "end": "2906640"
  },
  {
    "text": "outbox and then it'll just get reset and it has to be effectively the same",
    "start": "2906640",
    "end": "2912880"
  },
  {
    "text": "response we created earlier so the outbox helps you out there right so the outbox pattern depends upon you",
    "start": "2912880",
    "end": "2918940"
  },
  {
    "text": "being able to have a transaction in your database what happens if you can't have a transaction in your database because you",
    "start": "2918940",
    "end": "2924400"
  },
  {
    "text": "don't have you know using a document store or something that doesn't support transactions across multiple multiple",
    "start": "2924400",
    "end": "2929500"
  },
  {
    "text": "tables or multiple documents a couple other options first option is log tailing typically your database May",
    "start": "2929500",
    "end": "2936220"
  },
  {
    "text": "expose effectively rights as a stream you listen to that stream when you see a",
    "start": "2936220",
    "end": "2941560"
  },
  {
    "text": "write you take the action of creating the appropriate outgoing message write that to the outbox and then your worker",
    "start": "2941560",
    "end": "2948220"
  },
  {
    "text": "process just reads the outbox from there right so it's kind of an extra step where effectively you're saying because",
    "start": "2948220",
    "end": "2953440"
  },
  {
    "text": "they can't have transactions I'll rely on being able to read the stream in order and then I'll just write the",
    "start": "2953440",
    "end": "2959079"
  },
  {
    "text": "corresponding message to the outbox and then that will get sent a little more delay but it works without transactions",
    "start": "2959079",
    "end": "2965940"
  },
  {
    "text": "the other option you have is basically to send the message and listen to your",
    "start": "2965980",
    "end": "2971380"
  },
  {
    "text": "own message and update your state when you see your own outgoing message right it's simple it's effective the",
    "start": "2971380",
    "end": "2979240"
  },
  {
    "text": "only slight thing is timing right if somebody else wants to ask you what the state is you may disagree with somebody",
    "start": "2979240",
    "end": "2985420"
  },
  {
    "text": "else Downstream it's purchase the message before you have to just be worried about timing issues if you choose that option",
    "start": "2985420",
    "end": "2992940"
  },
  {
    "start": "2998000",
    "end": "3115000"
  },
  {
    "text": "so our overall model inside some kind of fiefdom looks a bit like this I've got this some kind of collaboration I'm",
    "start": "3000540",
    "end": "3006960"
  },
  {
    "text": "participating in the collaboration doesn't exist as anything probably more than IDs for a conversation or natural",
    "start": "3006960",
    "end": "3013980"
  },
  {
    "text": "IDs that I'm attaching to messages it may also exist in some kind of uh span",
    "start": "3013980",
    "end": "3019920"
  },
  {
    "text": "that I'm putting into my uh telemetry",
    "start": "3019920",
    "end": "3024960"
  },
  {
    "text": "and I am receiving messages into my fief term some of them are initiating work some of them are during basically the",
    "start": "3024960",
    "end": "3031920"
  },
  {
    "text": "process of some initiate collaboration some of them are steps in a collaboration",
    "start": "3031920",
    "end": "3038099"
  },
  {
    "text": "and that runs application code remember Pat's point is it's application code that has to deal with uncertainty in the",
    "start": "3038099",
    "end": "3045000"
  },
  {
    "text": "absence of basic TPC and it will effectively update a couple of things what pack calls resources",
    "start": "3045000",
    "end": "3051660"
  },
  {
    "text": "those are abstractions over things right",
    "start": "3051660",
    "end": "3056700"
  },
  {
    "text": "and activities which essentially are Notions of State uh and the state",
    "start": "3056700",
    "end": "3062400"
  },
  {
    "text": "basically that are given activity that you own which is a portion of a workflow is in",
    "start": "3062400",
    "end": "3068400"
  },
  {
    "text": "there are multiple ways to implement this as Pat points out its application code so there are lots of options for us",
    "start": "3068400",
    "end": "3075000"
  },
  {
    "text": "right things like Aggregates obviously if you know DDD have a strong affinity for this because they are essentially",
    "start": "3075000",
    "end": "3081359"
  },
  {
    "text": "State machines over some resources but you could even use a a workflow engine",
    "start": "3081359",
    "end": "3087180"
  },
  {
    "text": "inside your feed term right you could just have a notion of activity and a resource as being quite explicit",
    "start": "3087180",
    "end": "3093180"
  },
  {
    "text": "Concepts in your domain there is not effectively a prescribed way of doing",
    "start": "3093180",
    "end": "3099359"
  },
  {
    "text": "this the important thing to understand is that you have individual fiefdoms",
    "start": "3099359",
    "end": "3104579"
  },
  {
    "text": "that have activities that have code and some state that run their portion of a",
    "start": "3104579",
    "end": "3110460"
  },
  {
    "text": "collaboration and you don't have a centralized controller running it",
    "start": "3110460",
    "end": "3116119"
  },
  {
    "start": "3115000",
    "end": "3270000"
  },
  {
    "text": "all right so we'll briefly look up brighter so brighter is an open source project that I work on",
    "start": "3116880",
    "end": "3122460"
  },
  {
    "text": "it's for.net developers there are equivalents I think like um uh you know uh mass transit and",
    "start": "3122460",
    "end": "3130140"
  },
  {
    "text": "service bus Rebus in our space outside our space if you're a JavaScript developer I recommend I'm going to look",
    "start": "3130140",
    "end": "3135540"
  },
  {
    "text": "at Seneca if you're if you're a Java developer you're probably just embredded in spring anyway so what does it matter",
    "start": "3135540",
    "end": "3142920"
  },
  {
    "text": "um uh but there are various Alternatives right we'll just show you how this one works so you get a feel for it so this",
    "start": "3142920",
    "end": "3148859"
  },
  {
    "text": "uh hideous diagram represents basically how brighter Works in terms of receiving messages there's a dispatcher at the top",
    "start": "3148859",
    "end": "3154920"
  },
  {
    "text": "that's basically a supervisor worker that says hey I'm going to spin up some threads and something needs to own them",
    "start": "3154920",
    "end": "3159960"
  },
  {
    "text": "all for any given subscription to messages so someone who's saying hey any messages",
    "start": "3159960",
    "end": "3166920"
  },
  {
    "text": "basically on this topic or this routine key I want those we have a consumer",
    "start": "3166920",
    "end": "3173420"
  },
  {
    "text": "and a consumer can spin up any number of threads and we call them the performer which essentially will process messages",
    "start": "3173760",
    "end": "3180180"
  },
  {
    "text": "from that given subscription so if it's a queue from that given queue if it's a stream effectively from that given",
    "start": "3180180",
    "end": "3186300"
  },
  {
    "text": "stream generally if it's a stream like Kafka you only want one performer but you can do competing consumers and",
    "start": "3186300",
    "end": "3191460"
  },
  {
    "text": "multiple performance right and each performer has a message pump and the message pump says my job is to",
    "start": "3191460",
    "end": "3197520"
  },
  {
    "text": "go and read from the message queue and I get a message off the queue right and I turn what is the Json or",
    "start": "3197520",
    "end": "3204780"
  },
  {
    "text": "Avro or um Pro a protobuf body into something you can recognize in code so type in",
    "start": "3204780",
    "end": "3211920"
  },
  {
    "text": "your type system let me give it a topical command processor and that says okay find some",
    "start": "3211920",
    "end": "3217440"
  },
  {
    "text": "code that handles this message and it runs a middleware pipeline",
    "start": "3217440",
    "end": "3223260"
  },
  {
    "text": "and that middleware pipeline does a number of things they're optional so one of them we do is an inbox which says",
    "start": "3223260",
    "end": "3230160"
  },
  {
    "text": "have I seen this message already if I have I don't know how to process it",
    "start": "3230160",
    "end": "3236480"
  },
  {
    "text": "other one is basically for net devs is poly we basically offer you resilience there you're not a.net Dev that's just",
    "start": "3236940",
    "end": "3243059"
  },
  {
    "text": "stuff that does retries and circuit breakers and you can add your own middleware into brighter basically to do steps that you",
    "start": "3243059",
    "end": "3248760"
  },
  {
    "text": "want right and then finally you've got your artwork your request Handler that runs your domain code",
    "start": "3248760",
    "end": "3255500"
  },
  {
    "text": "this portion is essentially what an activity does",
    "start": "3258000",
    "end": "3264119"
  },
  {
    "text": "there's an inbox to check for stuff there are some domain code that you can run",
    "start": "3264960",
    "end": "3270780"
  },
  {
    "start": "3270000",
    "end": "3303000"
  },
  {
    "text": "we also offer you an outbox so when your request Handler",
    "start": "3270780",
    "end": "3276900"
  },
  {
    "text": "wants to basically write an outgoing message at the same time as updating resources that it owns",
    "start": "3276900",
    "end": "3282839"
  },
  {
    "text": "we can get our outbox to participate in that transaction such that effectively we will write",
    "start": "3282839",
    "end": "3288780"
  },
  {
    "text": "messages to our outbox at the same time as you update your resources and we also offer you a sweeper thread which we'll",
    "start": "3288780",
    "end": "3295380"
  },
  {
    "text": "go through and look in your outbox for things that haven't been sent and try and dispatch them to your broker",
    "start": "3295380",
    "end": "3300960"
  },
  {
    "text": "okay what does it look like",
    "start": "3300960",
    "end": "3306180"
  },
  {
    "text": "um this is the only bit probably for the the net developers the rest of you can kind of just glise over if you like",
    "start": "3306180",
    "end": "3312240"
  },
  {
    "text": "um so we basically use attributes for middleware Pipeline and this one is saying hey I need an inbox I want to",
    "start": "3312240",
    "end": "3319200"
  },
  {
    "text": "de-duplicate stuff I don't want to basically try on a line item potency here then we have a Handler so if you're",
    "start": "3319200",
    "end": "3326400"
  },
  {
    "text": "dealing with Thief terms that do with messaging and activities and a lot of cases what happens you have this kind of model where you have a Handler that says",
    "start": "3326400",
    "end": "3332819"
  },
  {
    "text": "I am reacting to being sent a message I am doing I am either initiating",
    "start": "3332819",
    "end": "3339420"
  },
  {
    "text": "basically my part of a collaboration my activity or effectively I am responding",
    "start": "3339420",
    "end": "3345359"
  },
  {
    "text": "to a reply as part of it with Sarah Paul in a second let me begin a transaction we support a",
    "start": "3345359",
    "end": "3352140"
  },
  {
    "text": "number of um common tools in the.net space Entity framework core this is Dapper we're",
    "start": "3352140",
    "end": "3357780"
  },
  {
    "text": "using here so we begin a transaction explicitly because we want to participate as part of that transaction",
    "start": "3357780",
    "end": "3363660"
  },
  {
    "text": "in order to write to the outbox then you'll probably in this example",
    "start": "3363660",
    "end": "3369059"
  },
  {
    "text": "we're using some kind of aggregate-based approach so the aggregate contains a state machine and can take our order",
    "start": "3369059",
    "end": "3376619"
  },
  {
    "text": "through the various States involved so here we go to a factory and say well we're creating a new one it's the",
    "start": "3376619",
    "end": "3382380"
  },
  {
    "text": "initiation of a collaboration so we use a factory and we create our new order",
    "start": "3382380",
    "end": "3387740"
  },
  {
    "text": "and we check basically from the checkout information we've received as a message that wants to initiate the order process",
    "start": "3388079",
    "end": "3393540"
  },
  {
    "text": "so I forgot to mention that we've listened to a checkout event so we want to create the order based on the",
    "start": "3393540",
    "end": "3398579"
  },
  {
    "text": "customers check out we're going to process it and take payments for it and stuff like that",
    "start": "3398579",
    "end": "3404339"
  },
  {
    "text": "um we want to validate it's correct and then we'll save it in the database and then we create basically a message",
    "start": "3404339",
    "end": "3410400"
  },
  {
    "text": "for payment we're not done on process order until basically at least we've got it paid for",
    "start": "3410400",
    "end": "3416400"
  },
  {
    "text": "well then we'll hand it to fulfillment right so we create an outgoing message and we say we want to take a payment for this",
    "start": "3416400",
    "end": "3423960"
  },
  {
    "text": "and we write it to post box so postbox is just not a command processor it's just a local name in this code for it",
    "start": "3423960",
    "end": "3429599"
  },
  {
    "text": "right and we say put it in there so but the post box notion is just basically hey here's someone want to store",
    "start": "3429599",
    "end": "3435000"
  },
  {
    "text": "something and then we've got to commit the transaction and your new order exists in our data",
    "start": "3435000",
    "end": "3442020"
  },
  {
    "text": "table along with the request to pay for it or we bought the transaction and neither happens right",
    "start": "3442020",
    "end": "3449119"
  },
  {
    "start": "3448000",
    "end": "3547000"
  },
  {
    "text": "so later on in the same collaboration well the same activity for us we might receive a response",
    "start": "3449400",
    "end": "3455640"
  },
  {
    "text": "back from the payment system again there's an inbox in case you've seen it before we may we might have been okay",
    "start": "3455640",
    "end": "3460680"
  },
  {
    "text": "with not having an inbox in this case um because you know payment is payment but we do ship to fulfillment later so",
    "start": "3460680",
    "end": "3467400"
  },
  {
    "text": "probably we might want to do that twice twice um we listen to the payment request",
    "start": "3467400",
    "end": "3473339"
  },
  {
    "text": "right this Handler gets kicked off when a payment request comes in it just runs your Handler code",
    "start": "3473339",
    "end": "3478440"
  },
  {
    "text": "we look at the payment request and we say let's begin a transaction",
    "start": "3478440",
    "end": "3483780"
  },
  {
    "text": "let's find essentially the order this payment relates to the correlation ID is",
    "start": "3483780",
    "end": "3489119"
  },
  {
    "text": "going to just be the order ID that's what we're using we can use the natural one this is just some Dapper code for",
    "start": "3489119",
    "end": "3494819"
  },
  {
    "text": "those that don't know.net I haven't seen it and it's saying Go away and find me the order that matches this order ID I",
    "start": "3494819",
    "end": "3501000"
  },
  {
    "text": "want to get it out and then I'm going to call a method on it to essentially Advance its state by telling that payment's been made",
    "start": "3501000",
    "end": "3508319"
  },
  {
    "text": "and then I pass in the payment details to it so it can update whatever it needs to update locally presumably the order",
    "start": "3508319",
    "end": "3513780"
  },
  {
    "text": "resource and then I want to hand this work on to the next step and actually usually",
    "start": "3513780",
    "end": "3519000"
  },
  {
    "text": "perform with different Feast them so I'm going to send it a message to bring begin a collaboration for fiefdom",
    "start": "3519000",
    "end": "3526440"
  },
  {
    "text": "to do that work so I create a fulfillment request and I put a message in my outbox saying hey go and do the",
    "start": "3526440",
    "end": "3533579"
  },
  {
    "text": "work by seeing order to fulfill this right and then again I commit or robot the transaction",
    "start": "3533579",
    "end": "3539520"
  },
  {
    "text": "none of this has required me to build an external Saga process",
    "start": "3539520",
    "end": "3545760"
  },
  {
    "text": "manager coordinator just so you know this is kind of how you",
    "start": "3545760",
    "end": "3551460"
  },
  {
    "start": "3547000",
    "end": "3584000"
  },
  {
    "text": "configure brighter such that you would get uh an outbox we support a range of",
    "start": "3551460",
    "end": "3557339"
  },
  {
    "text": "databases effectively what you're doing is saying Hey I want to use this type of outbox and here's some configuration",
    "start": "3557339",
    "end": "3562980"
  },
  {
    "text": "information for it this line says hey you should use we",
    "start": "3562980",
    "end": "3568619"
  },
  {
    "text": "need to share these transactions when you're writing basically to the outbox",
    "start": "3568619",
    "end": "3575099"
  },
  {
    "text": "and this line says I want to use a sweeper so I want you to basically spin up a thread they'll monitor the outbox",
    "start": "3575099",
    "end": "3581220"
  },
  {
    "text": "and send messages basically that haven't been sent yet sometimes you don't want to wait for the sweeper",
    "start": "3581220",
    "end": "3587819"
  },
  {
    "start": "3584000",
    "end": "3599000"
  },
  {
    "text": "to run you don't want that kind of delay and you just want to say I'm going to try first of all to send it immediately",
    "start": "3587819",
    "end": "3593400"
  },
  {
    "text": "let's see if we're just going to basically try and send stuff that didn't work and that's okay",
    "start": "3593400",
    "end": "3598619"
  },
  {
    "text": "what you can do effectively is create a list of posts add your post effectively into the list of posts and you can",
    "start": "3598619",
    "end": "3604859"
  },
  {
    "text": "explicitly just clear it all at the end of your Handler so",
    "start": "3604859",
    "end": "3610319"
  },
  {
    "text": "just to kind of summarize Pat's argument is that application code",
    "start": "3610319",
    "end": "3615839"
  },
  {
    "text": "is what you use in distributed applications when you want to replace TPC not something like a saga or process",
    "start": "3615839",
    "end": "3621960"
  },
  {
    "text": "manager Etc now the application code that does that orchestration runs and",
    "start": "3621960",
    "end": "3627780"
  },
  {
    "text": "each individual fiefdom 50 could be a micro service but it might also be code running basically on a phone or a user",
    "start": "3627780",
    "end": "3634859"
  },
  {
    "text": "agent or a browser and what we do is essentially write",
    "start": "3634859",
    "end": "3641040"
  },
  {
    "text": "activities and activities effectively are code that handles the workflow",
    "start": "3641040",
    "end": "3646680"
  },
  {
    "text": "portion that I need in response to a message and it may pause because it",
    "start": "3646680",
    "end": "3651780"
  },
  {
    "text": "starts its own collaboration saying hey go and do this other work for me and receives a response back and wakes up we",
    "start": "3651780",
    "end": "3658140"
  },
  {
    "text": "wake up the state for it and then resume it right and the combination of all these activities running which is",
    "start": "3658140",
    "end": "3664680"
  },
  {
    "text": "eventually choreography form is a collaboration we can use okay",
    "start": "3664680",
    "end": "3670619"
  },
  {
    "text": "don't need to use PC TPC don't use a coordinator or a saga and your code",
    "start": "3670619",
    "end": "3677160"
  },
  {
    "text": "to do that is something like this all right some kind of Handler with some",
    "start": "3677160",
    "end": "3682260"
  },
  {
    "text": "middleware to deal with things like outboxes and inboxes Etc that you need all right",
    "start": "3682260",
    "end": "3689099"
  },
  {
    "text": "that's that talk it's traditional to put the green ticket in the box outside when you go thank you",
    "start": "3689099",
    "end": "3694319"
  },
  {
    "text": "very much",
    "start": "3694319",
    "end": "3696559"
  }
]