[
  {
    "text": "foreign [Music]",
    "start": "1380",
    "end": "11330"
  },
  {
    "text": "[Music]",
    "start": "14620",
    "end": "31988"
  },
  {
    "text": "[Music]",
    "start": "45340",
    "end": "83430"
  },
  {
    "text": "so that was our presentation thank you just kidding how many of you guys were at the NDC",
    "start": "84720",
    "end": "91740"
  },
  {
    "text": "party last night quite a few and you still made it here today that's pretty impressive when I",
    "start": "91740",
    "end": "98880"
  },
  {
    "text": "woke up this morning I sounded like Leonard Cohen I think my voice is a lot deeper today than it was",
    "start": "98880",
    "end": "105479"
  },
  {
    "text": "yesterday I think I got a little bit too excited during that concert so that's a note for next time not to sing along",
    "start": "105479",
    "end": "113119"
  },
  {
    "text": "every song the evening before a talk",
    "start": "113119",
    "end": "118799"
  },
  {
    "text": "so what you just saw is our AI training to become a better driver",
    "start": "118799",
    "end": "124259"
  },
  {
    "text": "it's not really responsible driving as you could see but that's not what this is about either because we're not really",
    "start": "124259",
    "end": "130979"
  },
  {
    "text": "trying to compete with Tesla this is more like better as in drive as",
    "start": "130979",
    "end": "136860"
  },
  {
    "text": "quickly as possible to the finish line and don't let anything stand in your way now we held this talk at Java so in a",
    "start": "136860",
    "end": "144300"
  },
  {
    "text": "couple of weeks ago so this is basically the same talk so if anyone was there we totally understand if you",
    "start": "144300",
    "end": "151860"
  },
  {
    "text": "want to watch something else instead but if you find it so entertaining that you want to do another sitting",
    "start": "151860",
    "end": "157739"
  },
  {
    "text": "Be Our Guest no one left that's pretty good",
    "start": "157739",
    "end": "163379"
  },
  {
    "text": "um so around two and a half years ago there was this Global event in the world which essentially screwed everyone over",
    "start": "163379",
    "end": "170360"
  },
  {
    "text": "and continued to do so for the next two years and it left the two of us with a",
    "start": "170360",
    "end": "176819"
  },
  {
    "text": "lot more spare time in our daily life than usual and we decided to spend some",
    "start": "176819",
    "end": "182519"
  },
  {
    "text": "of this spare time collaborating on a fun project",
    "start": "182519",
    "end": "187860"
  },
  {
    "text": "and we'd previously done something similar before when we trained an AI to play a game called Pac-Man or at least",
    "start": "187860",
    "end": "195659"
  },
  {
    "text": "our own implementation of Pac-Man but this time we wanted to do something different something perhaps even more",
    "start": "195659",
    "end": "202739"
  },
  {
    "text": "challenging and we ended up with this native video game called trackmania",
    "start": "202739",
    "end": "209760"
  },
  {
    "text": "how many have played track Mania before heard about it familiar with it played",
    "start": "209760",
    "end": "215040"
  },
  {
    "text": "it during class in high school most Millennials probably did I know you did oh yes",
    "start": "215040",
    "end": "222000"
  },
  {
    "text": "so trackmania for those who don't know it's a racing game and as with most racing games the objective is to drive",
    "start": "222000",
    "end": "229980"
  },
  {
    "text": "as fast as possible to finish a track it's a game that's been around for a",
    "start": "229980",
    "end": "235799"
  },
  {
    "text": "while um and the latest edition was released in 2020 and that's the game that we've",
    "start": "235799",
    "end": "242099"
  },
  {
    "text": "trained our AI in now why did we choose trackmania first",
    "start": "242099",
    "end": "249000"
  },
  {
    "text": "and foremost we think it's a fun game it's very visual it's a good game a good",
    "start": "249000",
    "end": "254040"
  },
  {
    "text": "physics engine and it's very fun to watch and there's also a great Community",
    "start": "254040",
    "end": "260040"
  },
  {
    "text": "around the game other people I've worked with AIS worked with similar problems",
    "start": "260040",
    "end": "265259"
  },
  {
    "text": "faced similar challenges so there were people we could discuss problems with to figure things out quicker and there are",
    "start": "265259",
    "end": "272520"
  },
  {
    "text": "also useful third-party plugins available for extracting information from the game",
    "start": "272520",
    "end": "278460"
  },
  {
    "text": "on a more technical note the game is deterministic there's no Randomness in",
    "start": "278460",
    "end": "284400"
  },
  {
    "text": "the game which means that if you execute a sequence of actions repeatedly like",
    "start": "284400",
    "end": "290100"
  },
  {
    "text": "you execute a sequence of actions and then you do it again it will always produce the same outcome so that makes",
    "start": "290100",
    "end": "297300"
  },
  {
    "text": "it a little bit easier to train an AI to understand what's going on before we continue let us tell you who",
    "start": "297300",
    "end": "304500"
  },
  {
    "text": "we are yes my name is Malta I work as a data",
    "start": "304500",
    "end": "310020"
  },
  {
    "text": "scientist or data engineer or what you would in a region called a potato",
    "start": "310020",
    "end": "315259"
  },
  {
    "text": "know it we have a stand out here so you guys can come and talk to me after the",
    "start": "315259",
    "end": "320400"
  },
  {
    "text": "after this talk if you guys want to or ask any questions um I work as a consultant I'm currently",
    "start": "320400",
    "end": "327000"
  },
  {
    "text": "sitting at antut where we have a lot of fun with data from the public transportation sector",
    "start": "327000",
    "end": "335120"
  },
  {
    "text": "my name is Manu I'm from Oslo I've been working as a developer consultant for",
    "start": "335280",
    "end": "341280"
  },
  {
    "text": "five years uh uh and prior to this I was doing my Master's at ntnu in tranheim and at UCSB",
    "start": "341280",
    "end": "348720"
  },
  {
    "text": "in California where I specialized in Ai and that's where I developed this interest and it's",
    "start": "348720",
    "end": "355139"
  },
  {
    "text": "an interest that I've held on to later obviously",
    "start": "355139",
    "end": "360419"
  },
  {
    "text": "and currently I'm uh working at a Norwegian consultancy company called",
    "start": "360419",
    "end": "366000"
  },
  {
    "text": "above it where I work as a developer but I'm also",
    "start": "366000",
    "end": "371699"
  },
  {
    "text": "a part of company management and it's very easy for people to mistake",
    "start": "371699",
    "end": "376919"
  },
  {
    "text": "above it for other companies with similar names and that's especially when we introduce",
    "start": "376919",
    "end": "383520"
  },
  {
    "text": "ourselves at the same time it's often done but above it is a totally separate company but it's pretty new so a lot of",
    "start": "383520",
    "end": "390360"
  },
  {
    "text": "people haven't heard about it but it's a consultancy company and as a consultant I'm currently outsourced to the public transportation",
    "start": "390360",
    "end": "397800"
  },
  {
    "text": "company called rooted so if you took the bus today and the screen was showing",
    "start": "397800",
    "end": "403860"
  },
  {
    "text": "like the totally wrong information that may or may not have been my fault",
    "start": "403860",
    "end": "409560"
  },
  {
    "text": "but you know I've been here for three days you know so probably my fault",
    "start": "409560",
    "end": "414979"
  },
  {
    "text": "so we're going to show you more videos and we're also going to talk about implementation but before we get to all",
    "start": "415620",
    "end": "421560"
  },
  {
    "text": "of that I want to do the compulsory recap on artificial intelligence just to make sure that we're all on the same",
    "start": "421560",
    "end": "428100"
  },
  {
    "text": "page AI is a very broad topic but simply put it's about simulating human acts of",
    "start": "428100",
    "end": "434580"
  },
  {
    "text": "intelligence in machines and then you have machine learning which is a subcategory of AI",
    "start": "434580",
    "end": "441599"
  },
  {
    "text": "where data is used to train models to solve problems Additionally the algorithms used in",
    "start": "441599",
    "end": "448740"
  },
  {
    "text": "machine learning they're they're very general they're not explicitly programmed to solve a single problem for",
    "start": "448740",
    "end": "454620"
  },
  {
    "text": "example neural networks what they learn is primarily dependent on the data that",
    "start": "454620",
    "end": "460440"
  },
  {
    "text": "is fed to them so theoretically speaking and this is very simply put but you can solve any",
    "start": "460440",
    "end": "466380"
  },
  {
    "text": "problem uh using machine learning as long as the data sufficiently describes the",
    "start": "466380",
    "end": "473039"
  },
  {
    "text": "problem and there is a pattern that can be discovered for finding a solution",
    "start": "473039",
    "end": "479780"
  },
  {
    "text": "now there are many different types of machine learning or there are a few type different types like main categories you",
    "start": "480240",
    "end": "487080"
  },
  {
    "text": "have supervised learning you have unsupervised learning and then you have reinforcement learning which is what we",
    "start": "487080",
    "end": "492660"
  },
  {
    "text": "used to train our AI and reinforcement learning sort of stands out because the",
    "start": "492660",
    "end": "499020"
  },
  {
    "text": "data that is used for training is created by the model itself during",
    "start": "499020",
    "end": "504120"
  },
  {
    "text": "training while these other methods they use data sets that you compose beforehand",
    "start": "504120",
    "end": "511919"
  },
  {
    "text": "reinforcement learning is particularly suitable for training AI in games",
    "start": "511919",
    "end": "517860"
  },
  {
    "text": "because instead of handcrafting how you want the AI to act in a game or even by",
    "start": "517860",
    "end": "524399"
  },
  {
    "text": "providing examples you just reboard the AI for preferred behavior and it will learn the optimal",
    "start": "524399",
    "end": "531600"
  },
  {
    "text": "way of playing by itself and this is also why game AIS can",
    "start": "531600",
    "end": "537540"
  },
  {
    "text": "produce moves that even human experts wouldn't think of which has happened in",
    "start": "537540",
    "end": "543360"
  },
  {
    "text": "the last few years in games such as chess and go were very Advanced AIS have",
    "start": "543360",
    "end": "548820"
  },
  {
    "text": "been developed and they have surpassed Human Performance as well",
    "start": "548820",
    "end": "553920"
  },
  {
    "text": "and you might be thinking yeah but these are just games right but they're like solving these problems are being used as",
    "start": "553920",
    "end": "560100"
  },
  {
    "text": "step like games are being used as stepping stones for solving harder problems in the real world",
    "start": "560100",
    "end": "567920"
  },
  {
    "text": "you have different methods and variations in reinforcement learning as well because you have different algorithms for Learning and Etc but",
    "start": "569399",
    "end": "576420"
  },
  {
    "text": "there is a general algorithm and to understand how it works I need to introduce a few terms",
    "start": "576420",
    "end": "584700"
  },
  {
    "text": "so you have the agent which is the entity that is being trained so in",
    "start": "584700",
    "end": "589800"
  },
  {
    "text": "trackmania you can say that the car is the agent",
    "start": "589800",
    "end": "595200"
  },
  {
    "text": "and then the agent can pick an action from a set of possible actions so when you when you play the",
    "start": "595200",
    "end": "602399"
  },
  {
    "text": "game on the computer uh you use the arrow keys to accelerate break you steer",
    "start": "602399",
    "end": "609240"
  },
  {
    "text": "to the left to the right and also there are combinations of these as well because you can accelerate and steer",
    "start": "609240",
    "end": "614880"
  },
  {
    "text": "right at the same time right and then the environment is the world",
    "start": "614880",
    "end": "621779"
  },
  {
    "text": "which the agent can interact with so in terms of trackmania the environment",
    "start": "621779",
    "end": "627360"
  },
  {
    "text": "is basically the entire game itself it's a container for the environment it's the platform which is used",
    "start": "627360",
    "end": "635240"
  },
  {
    "text": "a state is a snapshot of the current situation that the agent finds itself in",
    "start": "636839",
    "end": "642660"
  },
  {
    "text": "in relation to obstacles um possibly adversaries or anything else",
    "start": "642660",
    "end": "649380"
  },
  {
    "text": "that the environment might consist of so what do you see here",
    "start": "649380",
    "end": "655140"
  },
  {
    "text": "is one particular State and just a few moments later you're in a different state or the agent",
    "start": "655140",
    "end": "662220"
  },
  {
    "text": "is in a different state and between these two states you can see that the car has moved but",
    "start": "662220",
    "end": "670500"
  },
  {
    "text": "the car doesn't really have to move for the state to change because even if the car isn't moving the environment is",
    "start": "670500",
    "end": "676920"
  },
  {
    "text": "still alive so it's more correct to say that as that",
    "start": "676920",
    "end": "683700"
  },
  {
    "text": "state is a function of time as time progresses the state also changes",
    "start": "683700",
    "end": "690680"
  },
  {
    "text": "last term the reward when an agent performs an action in a",
    "start": "690720",
    "end": "696660"
  },
  {
    "text": "state the environment provides a feedback which is used to measure the degree of",
    "start": "696660",
    "end": "702540"
  },
  {
    "text": "success or failure of that particular decision and rewards can be both positive and",
    "start": "702540",
    "end": "709440"
  },
  {
    "text": "negative so that's why we'll call negative rewards for punishments",
    "start": "709440",
    "end": "715320"
  },
  {
    "text": "and unlike actions which are they're defined by the game itself what you can",
    "start": "715320",
    "end": "720420"
  },
  {
    "text": "and can't do right but how State and rewards are represented that's really a",
    "start": "720420",
    "end": "725880"
  },
  {
    "text": "design decision because the game doesn't really tell you how to do that directly it's your job as a programmer or as a",
    "start": "725880",
    "end": "732120"
  },
  {
    "text": "machine learning engineer so in this situation you see that the car is going to crash into a wall which",
    "start": "732120",
    "end": "737160"
  },
  {
    "text": "is not a desirable Behavior so you might want to punish the agent for doing so and that you have to program in as well",
    "start": "737160",
    "end": "745819"
  },
  {
    "text": "so how does all of this fit together well you have the AI or the agent which",
    "start": "746760",
    "end": "752279"
  },
  {
    "text": "are terms that we'll use interchangeably then you have the environment the agent picks an action in the",
    "start": "752279",
    "end": "760500"
  },
  {
    "text": "environment and then the environment will return the",
    "start": "760500",
    "end": "766019"
  },
  {
    "text": "next state that the agent finds itself in and also a reward and",
    "start": "766019",
    "end": "772680"
  },
  {
    "text": "the AI will take this information and use it run it in the chosen learning",
    "start": "772680",
    "end": "779160"
  },
  {
    "text": "algorithm in order to learn from its experience so if it is a positive reward then the AI",
    "start": "779160",
    "end": "785220"
  },
  {
    "text": "might choose to perform the same action again the next time but if it's a negative reward then maybe it's better",
    "start": "785220",
    "end": "791820"
  },
  {
    "text": "to try and avoid that action when it finds itself in a similar situation",
    "start": "791820",
    "end": "797880"
  },
  {
    "text": "and during training the agent goes through this Loop for many many iterations until it gets to a point",
    "start": "797880",
    "end": "804540"
  },
  {
    "text": "where most of the time it will choose actions that lead to positive",
    "start": "804540",
    "end": "810540"
  },
  {
    "text": "reward more often than uh negative so to summarize reinforcement learning",
    "start": "810540",
    "end": "816660"
  },
  {
    "text": "it's about maximizing the total amount of reward in the long run or in a",
    "start": "816660",
    "end": "821820"
  },
  {
    "text": "session or while playing a track right it's like training a dog to do tricks",
    "start": "821820",
    "end": "828860"
  },
  {
    "text": "so while we were working on this we used mostly python for programming",
    "start": "830040",
    "end": "835860"
  },
  {
    "text": "and then we also used a language called Angel script which is sort of similar to",
    "start": "835860",
    "end": "841200"
  },
  {
    "text": "C or C plus plus I say that like if C and C plus plus are",
    "start": "841200",
    "end": "846839"
  },
  {
    "text": "identical which I wouldn't know because I'm a Java programmer but uh anyway angelscript is a game oriented language",
    "start": "846839",
    "end": "854220"
  },
  {
    "text": "which is used to extend the functionality of games and we used it to",
    "start": "854220",
    "end": "859260"
  },
  {
    "text": "create a plugin of our own to get more information out of the game",
    "start": "859260",
    "end": "864740"
  },
  {
    "text": "we also used a library called stable baselines three which is implemented using pytorch by",
    "start": "864899",
    "end": "871079"
  },
  {
    "text": "Facebook or meta or whatever they're called now and stable Baseline streak consists of",
    "start": "871079",
    "end": "878240"
  },
  {
    "text": "already implemented reinforcement learning algorithms it's kind of like how uh",
    "start": "878240",
    "end": "884760"
  },
  {
    "text": "scikit-learn is for General machine learning or how opencv is for computer",
    "start": "884760",
    "end": "890399"
  },
  {
    "text": "vision it's a library that consists of implemented and optimized and ready to",
    "start": "890399",
    "end": "896880"
  },
  {
    "text": "go out of the box reinforcement learning algorithms so that you don't really have to implement those yourselves",
    "start": "896880",
    "end": "904139"
  },
  {
    "text": "and from this Library we use something called The Deep queue network not going to go into how it works and all that but",
    "start": "904139",
    "end": "910620"
  },
  {
    "text": "if you're familiar with Q learning which is a traditional RL algorithm this is",
    "start": "910620",
    "end": "916199"
  },
  {
    "text": "like Q learning with neural networks we also used something called proximal",
    "start": "916199",
    "end": "923459"
  },
  {
    "text": "policy optimization PPO it's a method that was introduced by open AI a few",
    "start": "923459",
    "end": "930779"
  },
  {
    "text": "years back and at the time it performs so well that it became the",
    "start": "930779",
    "end": "936899"
  },
  {
    "text": "go-to reinforcement learning algorithm because it performed better than other other asset of the art methods",
    "start": "936899",
    "end": "944600"
  },
  {
    "text": "all right here we go sir thank you thank you for talking about all the boring things yep let's talk about the",
    "start": "947279",
    "end": "953699"
  },
  {
    "text": "fun things no worries anytime all right so let's talk a little bit",
    "start": "953699",
    "end": "959399"
  },
  {
    "text": "about the training process itself uh so it um the AI was trained on my stationary",
    "start": "959399",
    "end": "965339"
  },
  {
    "text": "computer at home it's a Windows computer from it was built in 2017.",
    "start": "965339",
    "end": "971279"
  },
  {
    "text": "so starting to get a little bit old I have a GTX 1080 TI if anyone cares about",
    "start": "971279",
    "end": "976920"
  },
  {
    "text": "that um so the game uh truck Mania was running on one process on my computer",
    "start": "976920",
    "end": "982920"
  },
  {
    "text": "and then the AI was running on a different process and the way they kind of communicated if we can call it that",
    "start": "982920",
    "end": "989339"
  },
  {
    "text": "is that the agent just simulated key presses as if a human being is pressing",
    "start": "989339",
    "end": "995160"
  },
  {
    "text": "the arrow keys on the keyboard and then the game would act accordingly",
    "start": "995160",
    "end": "1002860"
  },
  {
    "text": "and the agent was implemented in a custom openai gym environment",
    "start": "1002860",
    "end": "1009440"
  },
  {
    "text": "and for those of you who don't know what that is you can think of it as an interface for",
    "start": "1009440",
    "end": "1014480"
  },
  {
    "text": "reinforcement learning algorithms so we would have stable baselines who has implemented the PPO or dqn algorithm and",
    "start": "1014480",
    "end": "1021860"
  },
  {
    "text": "then it would interact with our environment and the loop would go as menu has explained",
    "start": "1021860",
    "end": "1028220"
  },
  {
    "text": "this was also streamed partially at least to my twitch Channel if anyone want to watch some fun track Mania",
    "start": "1028220",
    "end": "1035298"
  },
  {
    "text": "training at twitch.tv kamalaza it's not actually training right now I probably should have started when I'm thinking",
    "start": "1035299",
    "end": "1041360"
  },
  {
    "text": "about it but I will probably start very soon uh yeah all right so um we did this",
    "start": "1041360",
    "end": "1048020"
  },
  {
    "text": "project in kind of four phases um and what we mean about that is that we started with only the really the",
    "start": "1048020",
    "end": "1054320"
  },
  {
    "text": "Necessities for training and then we added more complexity and features along the way",
    "start": "1054320",
    "end": "1059960"
  },
  {
    "text": "um so in the first phase we only used a screenshot of the game as input so the",
    "start": "1059960",
    "end": "1067400"
  },
  {
    "text": "AI is only taking the screenshot into consideration and then we added speed and turning",
    "start": "1067400",
    "end": "1074120"
  },
  {
    "text": "angle as well so now it knows about the the screenshot and the speed and the Turning angle then we we actually",
    "start": "1074120",
    "end": "1081380"
  },
  {
    "text": "started out with the PPO algorithm but then in phase three we changed it to the dqn",
    "start": "1081380",
    "end": "1086660"
  },
  {
    "text": "and then we added some form of Crash detections to see if the car is crashing into the walls",
    "start": "1086660",
    "end": "1092900"
  },
  {
    "text": "and then the fourth phase we started hooking into the game API through a",
    "start": "1092900",
    "end": "1098120"
  },
  {
    "text": "trick Mania framework called the open planet all right so during training the AI",
    "start": "1098120",
    "end": "1105140"
  },
  {
    "text": "trains in first person like in this screenshot and if you look at the top",
    "start": "1105140",
    "end": "1110179"
  },
  {
    "text": "middle you can see the speed it's zero right now and you in the top right you can see the",
    "start": "1110179",
    "end": "1117440"
  },
  {
    "text": "distance but the AI cannot see these they can the AI only sees the the screenshot",
    "start": "1117440",
    "end": "1123200"
  },
  {
    "text": "and not the speed and the distance and what we want to do is to have",
    "start": "1123200",
    "end": "1128240"
  },
  {
    "text": "something like this this is the goal uh the end goal to train an AI",
    "start": "1128240",
    "end": "1134179"
  },
  {
    "text": "and what we have is that we have the state and the top left corner here but the screenshot or the state or the",
    "start": "1134179",
    "end": "1141200"
  },
  {
    "text": "screenshot and the same thing um it's really just a long array of numbers like raw pixel values and we",
    "start": "1141200",
    "end": "1149179"
  },
  {
    "text": "want to feed this to some kind of black box that we call it or a neural network and then we want the neural network to",
    "start": "1149179",
    "end": "1155000"
  },
  {
    "text": "tell us what actions that we should pick and this is achieved doing something",
    "start": "1155000",
    "end": "1161660"
  },
  {
    "text": "like this during training like manual has mentioned a little bit we have the state we feed it into a neural network",
    "start": "1161660",
    "end": "1167600"
  },
  {
    "text": "the network tells us what action to pick the the environment then feeds back a",
    "start": "1167600",
    "end": "1174679"
  },
  {
    "text": "reward or some kind of feedback to the AI and if if it's a good reward hopefully",
    "start": "1174679",
    "end": "1181220"
  },
  {
    "text": "the AI will learn that in this certain State we should probably do the same action more but if it's a bad reward we",
    "start": "1181220",
    "end": "1187100"
  },
  {
    "text": "should probably try another action in the same state next time and this then continues this Loop",
    "start": "1187100",
    "end": "1192380"
  },
  {
    "text": "continues for hundreds of thousands of iterations until uh the AI hopefully",
    "start": "1192380",
    "end": "1197840"
  },
  {
    "text": "learns something we also do a little bit of image processing before we feed it to a neural",
    "start": "1197840",
    "end": "1204260"
  },
  {
    "text": "network because if you just feed it like a raw HT HD picture that's a lot of pixels that's a long array of of numbers",
    "start": "1204260",
    "end": "1212720"
  },
  {
    "text": "so what we do is that we cut this image in half horizontally",
    "start": "1212720",
    "end": "1219259"
  },
  {
    "text": "so if we remove a lot of okay Siri I like that too um",
    "start": "1219380",
    "end": "1224980"
  },
  {
    "text": "uh we got it in half horizontally um because the top half doesn't really",
    "start": "1224980",
    "end": "1231200"
  },
  {
    "text": "give us any useful information in this project we actually don't care about the cloud",
    "start": "1231200",
    "end": "1236740"
  },
  {
    "text": "and then we also use inverse binary thresholding so we would turn it black",
    "start": "1236740",
    "end": "1242120"
  },
  {
    "text": "and white and then it's going to look something like this but they're still quite still quite a lot of pixels that we have to",
    "start": "1242120",
    "end": "1247940"
  },
  {
    "text": "work with so we resize it into something smaller and now we have something that we can",
    "start": "1247940",
    "end": "1253039"
  },
  {
    "text": "actually feed to a neural network um also a little bit about how we we do the",
    "start": "1253039",
    "end": "1260480"
  },
  {
    "text": "rewards when when you do reinforcement learning the kind of the reward engineering is also really important",
    "start": "1260480",
    "end": "1266539"
  },
  {
    "text": "and what we do is that we give a reward based on speed So the faster the car drives the more reward it gets and also",
    "start": "1266539",
    "end": "1274580"
  },
  {
    "text": "we look at the final track time or like the finish time of the agent and the the faster the the track time is the the",
    "start": "1274580",
    "end": "1282260"
  },
  {
    "text": "better uh reward the agent will get and then we also give some kind of",
    "start": "1282260",
    "end": "1288740"
  },
  {
    "text": "punishment or negative reward if it gets stuck that also means we need some kind of",
    "start": "1288740",
    "end": "1294140"
  },
  {
    "text": "detection for when the AI actually gets stuck and the way we do that is simply by looking at the speed and if the speed",
    "start": "1294140",
    "end": "1299720"
  },
  {
    "text": "is less than 10 for about five to six seconds we just assume that the agent is",
    "start": "1299720",
    "end": "1305360"
  },
  {
    "text": "stuck and we just reset make the AI start over and give it some kind of punishment",
    "start": "1305360",
    "end": "1312500"
  },
  {
    "text": "also if the agent uses over a thousand time steps or about 50 to 55 seconds of",
    "start": "1312500",
    "end": "1319280"
  },
  {
    "text": "driving we also just assume that it never gonna that is never going to reach the finish line and so we also just start over and",
    "start": "1319280",
    "end": "1326179"
  },
  {
    "text": "give it some kind of negative reward all right so let's look it's let's look",
    "start": "1326179",
    "end": "1331400"
  },
  {
    "text": "at some videos um this is the training in phase one it's also really important to note that",
    "start": "1331400",
    "end": "1336919"
  },
  {
    "text": "when uh in reinforcement learning when you start training the AI doesn't know anything about the game or physics or",
    "start": "1336919",
    "end": "1342679"
  },
  {
    "text": "anything so it just performs kind of random actions and you can try to notice in the speed in the top middle it barely",
    "start": "1342679",
    "end": "1349100"
  },
  {
    "text": "reaches 100 and that's because it only like does random actions so let's see if this works",
    "start": "1349100",
    "end": "1357559"
  },
  {
    "text": "as it does",
    "start": "1357559",
    "end": "1360580"
  },
  {
    "text": "is driving better than you though yeah I'm quite actually quite unhappy showing exactly this example because it drives",
    "start": "1375740",
    "end": "1382520"
  },
  {
    "text": "way too well it actually comes into almost manages to finish the first turn",
    "start": "1382520",
    "end": "1389000"
  },
  {
    "text": "um usually it just like drives into the wall and just stops and starts over um but yeah this is at the very",
    "start": "1389000",
    "end": "1394880"
  },
  {
    "text": "beginning just doing random things and this one is about 10 hours into training",
    "start": "1394880",
    "end": "1401000"
  },
  {
    "text": "and you can again try to notice the speed in the top middle uh it has learned how to accelerate but it doesn't",
    "start": "1401000",
    "end": "1406700"
  },
  {
    "text": "really handle turns so well so it kind of just rides the walls into the into",
    "start": "1406700",
    "end": "1412159"
  },
  {
    "text": "the Finish",
    "start": "1412159",
    "end": "1414580"
  },
  {
    "text": "oh",
    "start": "1423559",
    "end": "1426039"
  },
  {
    "text": "I don't like it's driving better than you in real life well yeah for sure you don't wanna",
    "start": "1438919",
    "end": "1446419"
  },
  {
    "text": "you don't want you don't want me to drive that's for sure",
    "start": "1446419",
    "end": "1451480"
  },
  {
    "text": "yeah So eventually it reaches the Finish Line just before it was about to reset so that's quite fortunate I guess",
    "start": "1463460",
    "end": "1471679"
  },
  {
    "text": "um 49 seconds about 10 hours in and then after about 20 hours of training",
    "start": "1471679",
    "end": "1477260"
  },
  {
    "text": "it is actually going to hug the right side of the wall because now it has learned to accelerate and turn right at",
    "start": "1477260",
    "end": "1484100"
  },
  {
    "text": "the all times",
    "start": "1484100",
    "end": "1486940"
  },
  {
    "text": "foreign it almost gets stuck but barely manages",
    "start": "1507679",
    "end": "1514340"
  },
  {
    "text": "to escape",
    "start": "1514340",
    "end": "1516940"
  },
  {
    "text": "I will try to explain it in uh and uh I got a question if I can explain why it almost why it always turns right and I'm",
    "start": "1524299",
    "end": "1530840"
  },
  {
    "text": "going to try to explain it in one minute uh let's we're just uh first it's 42",
    "start": "1530840",
    "end": "1536120"
  },
  {
    "text": "seconds so it's it's learning it's driving faster um",
    "start": "1536120",
    "end": "1541220"
  },
  {
    "text": "so let's try to take a look at some highlights of the best runs from phase one",
    "start": "1541220",
    "end": "1548179"
  },
  {
    "text": "um yeah they're driving about 40 seconds all of them",
    "start": "1548179",
    "end": "1553820"
  },
  {
    "text": "now the sound is working that's nice um yeah so it finishes in about 40",
    "start": "1553820",
    "end": "1559279"
  },
  {
    "text": "seconds all of these and uh yeah",
    "start": "1559279",
    "end": "1564640"
  },
  {
    "text": "foreign sound",
    "start": "1573080",
    "end": "1578299"
  },
  {
    "text": "I love that scraping of metal sound yes",
    "start": "1578299",
    "end": "1582880"
  },
  {
    "text": "all right um so at this point uh we also",
    "start": "1590900",
    "end": "1596000"
  },
  {
    "text": "discovered that we had a bug and it is that the car would never break because I",
    "start": "1596000",
    "end": "1603260"
  },
  {
    "text": "mapped it to the wrong key on the keyboard when it simulates key presses so it actually never breaks",
    "start": "1603260",
    "end": "1609620"
  },
  {
    "text": "um so we can we can pretend that the reason why it's always driving right is to not",
    "start": "1609620",
    "end": "1617360"
  },
  {
    "text": "crash into the wall and get stuck but it's actually slowing down by always turning right",
    "start": "1617360",
    "end": "1623240"
  },
  {
    "text": "and just rides into the Finish we can pretend that that's the AI is that smart",
    "start": "1623240",
    "end": "1628880"
  },
  {
    "text": "we don't know the last the theory all right so 40 seconds it's not that",
    "start": "1628880",
    "end": "1634820"
  },
  {
    "text": "great I drive it in about 18 seconds it's a decent time on this track",
    "start": "1634820",
    "end": "1640640"
  },
  {
    "text": "um so why is reinforcement learning so hard well number one is that as I mentioned the agent always starts from scratch uh",
    "start": "1640640",
    "end": "1647720"
  },
  {
    "text": "when you're when you train in reinforcement learning um we have the credit assignment and",
    "start": "1647720",
    "end": "1653539"
  },
  {
    "text": "reward shaping problem and that's how you make your rewards it's actually quite difficult we have the exploration",
    "start": "1653539",
    "end": "1658820"
  },
  {
    "text": "versus exploitation trade-off problem where you want to explore the state space but at the same time you want to",
    "start": "1658820",
    "end": "1664340"
  },
  {
    "text": "exploit a good strategy and then reinforcement learning is also really sample inefficient it takes a",
    "start": "1664340",
    "end": "1669799"
  },
  {
    "text": "long time to train so um how many here play board games I",
    "start": "1669799",
    "end": "1676940"
  },
  {
    "text": "would assume quite a few yeah okay that was quite a few um right so when when you guys learn how to play new board games you wouldn't",
    "start": "1676940",
    "end": "1684260"
  },
  {
    "text": "just do random moves right and see what happens you would you would like read the rules",
    "start": "1684260",
    "end": "1689480"
  },
  {
    "text": "and understand the game at a higher level of extra abstraction right",
    "start": "1689480",
    "end": "1695000"
  },
  {
    "text": "um but that's not what uh what the AI does the AI just simply starts out and",
    "start": "1695000",
    "end": "1700880"
  },
  {
    "text": "tried to learn the environment by doing random things and that's a reason why it takes so long",
    "start": "1700880",
    "end": "1707299"
  },
  {
    "text": "for reinforcement learning agent to to to learn and why do we compare to humans well",
    "start": "1707299",
    "end": "1714140"
  },
  {
    "text": "We Are The Benchmark for now we are the best at generalizing humans we generalize a lot we when we start to",
    "start": "1714140",
    "end": "1719900"
  },
  {
    "text": "learn something new we actually have a lot of experience doing similar things usually um and we perform the best and we we",
    "start": "1719900",
    "end": "1726080"
  },
  {
    "text": "learn the fastest um so the credit assignment problem is that when when an agent gets feedback",
    "start": "1726080",
    "end": "1733100"
  },
  {
    "text": "it's quite hard for the agent to know if it got feedback or if the feedback",
    "start": "1733100",
    "end": "1738500"
  },
  {
    "text": "um like it's hard to know if the previous action was good or if it was a previous",
    "start": "1738500",
    "end": "1744260"
  },
  {
    "text": "action that was performed in a hundred thousand time steps before even if that",
    "start": "1744260",
    "end": "1749840"
  },
  {
    "text": "was the action that was good right so for instance in trackmania it's hard to for the AI to know if it",
    "start": "1749840",
    "end": "1756620"
  },
  {
    "text": "drove let's say the AI sets a new personal best on this track it's hard for the AI to know if it drove really",
    "start": "1756620",
    "end": "1762919"
  },
  {
    "text": "well in the beginning of the track or if it drove actually really well in the later stages for to learn that it has to",
    "start": "1762919",
    "end": "1768440"
  },
  {
    "text": "drive the the track over and over again and then they have the reward shaping",
    "start": "1768440",
    "end": "1773600"
  },
  {
    "text": "problem and it's how you engineer your rewards there's kind of two ways of doing it the number one is called the",
    "start": "1773600",
    "end": "1780620"
  },
  {
    "text": "uniform assignment scheme and when you do something like this uh you you only care about the result or",
    "start": "1780620",
    "end": "1787880"
  },
  {
    "text": "the final product of whatever you're trying to achieve so for instance in our case it is we would only care about the",
    "start": "1787880",
    "end": "1794360"
  },
  {
    "text": "track time we would only give it feedback when it finishes the track and based on and of course the faster it",
    "start": "1794360",
    "end": "1801200"
  },
  {
    "text": "drives the better the feedback would be right and the Really positive thing about this",
    "start": "1801200",
    "end": "1806240"
  },
  {
    "text": "is that the AI or the agent would get really really sophisticated because we",
    "start": "1806240",
    "end": "1811340"
  },
  {
    "text": "would tell it that we don't care how you do it you can exploit bugs you can cheat you can do whatever we only want you to",
    "start": "1811340",
    "end": "1817039"
  },
  {
    "text": "finish as fast as possible but that also means that for a long period of time when it's driving in the",
    "start": "1817039",
    "end": "1822440"
  },
  {
    "text": "track it's not going to get any interaction from the environment and therefore it converges really slowly",
    "start": "1822440",
    "end": "1830899"
  },
  {
    "text": "the other thing that we can do is use something called shaped rewards and that's what we're using in this project right we're micromanaging a lot more so",
    "start": "1830899",
    "end": "1838399"
  },
  {
    "text": "you get it give it rewards for driving faster give it rewards for not crashing",
    "start": "1838399",
    "end": "1844600"
  },
  {
    "text": "punished for getting stock punished for taking too long and stuff like that and it converges a lot faster because it",
    "start": "1844600",
    "end": "1851299"
  },
  {
    "text": "gets input from the environment all the time but it doesn't get as smart because",
    "start": "1851299",
    "end": "1857299"
  },
  {
    "text": "they were micromanaging too much and then we have the expiration versus exploitation trade-off and when you",
    "start": "1857299",
    "end": "1864860"
  },
  {
    "text": "train reinforcement learning agent you you want to try to explore the state",
    "start": "1864860",
    "end": "1870440"
  },
  {
    "text": "space right you would want to try to explore the entire State space and maybe you even want to perform every action in",
    "start": "1870440",
    "end": "1877700"
  },
  {
    "text": "every state even multiple times maybe and if you could do that honestly you could just",
    "start": "1877700",
    "end": "1883760"
  },
  {
    "text": "make make like a huge Excel spreadsheet you could just have like okay we're in this state you know we have state in one",
    "start": "1883760",
    "end": "1889940"
  },
  {
    "text": "column and then we could have the action in another column and you could just when you're getting a new state you",
    "start": "1889940",
    "end": "1895039"
  },
  {
    "text": "could just look at the spreadsheet and be like okay we're in this state we're going to perform this action because it has done the best previously",
    "start": "1895039",
    "end": "1901940"
  },
  {
    "text": "but uh the space the state space in trackmania is obviously too big to do",
    "start": "1901940",
    "end": "1907100"
  },
  {
    "text": "something like that so what you want to do then is try to exploit a good strategy when you have",
    "start": "1907100",
    "end": "1913100"
  },
  {
    "text": "when you think you have found one and this is often just implemented as a",
    "start": "1913100",
    "end": "1919220"
  },
  {
    "text": "every time the agent picks an action there's a small chance that it's going to perform a random action instead of",
    "start": "1919220",
    "end": "1924860"
  },
  {
    "text": "actually choosing what it thinks is the best so for instance when you saw the AI drive just now when it hugs the the",
    "start": "1924860",
    "end": "1931700"
  },
  {
    "text": "right side of the wall there's a small every time it picks an action there's a small chance it's going",
    "start": "1931700",
    "end": "1937100"
  },
  {
    "text": "to do something random So eventually it's gonna choose to drive to the left",
    "start": "1937100",
    "end": "1942260"
  },
  {
    "text": "and when you drive to the left it's hopefully going to accelerate faster and learn that that's maybe a better way of",
    "start": "1942260",
    "end": "1947659"
  },
  {
    "text": "doing it and therefore it can exploit that strategy instead yes and the last one is that",
    "start": "1947659",
    "end": "1955580"
  },
  {
    "text": "um well that's the problem why or the the last reason why reinforcement learning is so hard is that it's really",
    "start": "1955580",
    "end": "1961220"
  },
  {
    "text": "sample inefficient so this graph shows the amount of time it takes an agent to learn a game called",
    "start": "1961220",
    "end": "1968539"
  },
  {
    "text": "frostbite and on the y-axis we have the frostbite score and on the X x axis we have",
    "start": "1968539",
    "end": "1976360"
  },
  {
    "text": "the amount of hours trained you can see the humans are doing really well we get",
    "start": "1976360",
    "end": "1981559"
  },
  {
    "text": "above 4 000 about two hours of play but the agent dqn agents they need to",
    "start": "1981559",
    "end": "1987620"
  },
  {
    "text": "train for hundreds of hours to even almost reach that level",
    "start": "1987620",
    "end": "1993200"
  },
  {
    "text": "all right so let's talk about phase two as I mentioned uh we added speed and turning angle to",
    "start": "1993200",
    "end": "1999559"
  },
  {
    "text": "the state which we think is really going to help the agent learn faster and better and",
    "start": "1999559",
    "end": "2005500"
  },
  {
    "text": "I've also had a bunch of technical improvements I'll call it you know we fixed the bug where now the car can actually break",
    "start": "2005500",
    "end": "2011740"
  },
  {
    "text": "quite quite important uh yeah and then just to try to explain why it matters so",
    "start": "2011740",
    "end": "2018159"
  },
  {
    "text": "much that the AI knows the speed if we take this screenshot for instance and this screenshot there's it turns to",
    "start": "2018159",
    "end": "2026260"
  },
  {
    "text": "the left further ahead and if the agent knows that the speed is zero it should",
    "start": "2026260",
    "end": "2032080"
  },
  {
    "text": "probably choose to accelerate right but if the agent knows that the speed is 400 in order not to crash it should maybe",
    "start": "2032080",
    "end": "2039580"
  },
  {
    "text": "start breaking a little bit so so knowing this extra information is actually going to influence how the AI",
    "start": "2039580",
    "end": "2045159"
  },
  {
    "text": "behaves all right so let's take a look at phase",
    "start": "2045159",
    "end": "2050679"
  },
  {
    "text": "two [Music]",
    "start": "2050679",
    "end": "2069589"
  },
  {
    "text": "[Music]",
    "start": "2079000",
    "end": "2083780"
  },
  {
    "text": "okay and let's look a little bit more in depth of some driving um so here it doesn't hug the right side",
    "start": "2093099",
    "end": "2100000"
  },
  {
    "text": "of the wall anymore so that's quite nice it is also went from about 40 seconds",
    "start": "2100000",
    "end": "2105940"
  },
  {
    "text": "down to 30 seconds so actually a 10 second Improvement which we're really happy to see",
    "start": "2105940",
    "end": "2111460"
  },
  {
    "text": "uh it's still crashing quite a lot but it is definitely a performing uh a lot",
    "start": "2111460",
    "end": "2117220"
  },
  {
    "text": "better A lot better so we're really happy how uh how much it improved in phase two",
    "start": "2117220",
    "end": "2125220"
  },
  {
    "text": "all right zero turn again um",
    "start": "2129579",
    "end": "2134619"
  },
  {
    "text": "thank you",
    "start": "2134619",
    "end": "2137220"
  },
  {
    "text": "so as Malta was saying we we tried to progressively improve the set of",
    "start": "2143260",
    "end": "2149560"
  },
  {
    "text": "features that we used to represent state in order to improve the performance of",
    "start": "2149560",
    "end": "2155260"
  },
  {
    "text": "the AI but also to reduce the training time and he's been going through",
    "start": "2155260",
    "end": "2161440"
  },
  {
    "text": "all these things now that worked out well there were also",
    "start": "2161440",
    "end": "2167200"
  },
  {
    "text": "things that we tried out that seemed promising to begin with and then it turned a little bit more",
    "start": "2167200",
    "end": "2174040"
  },
  {
    "text": "challenging and then in the end it wasn't really that viable so I'm gonna talk about the stuff that didn't work",
    "start": "2174040",
    "end": "2179980"
  },
  {
    "text": "but we did try some interesting approaches so it's worth talking about",
    "start": "2179980",
    "end": "2186820"
  },
  {
    "text": "so up until now we've we've been feeding the AI raw pixel data from screenshots",
    "start": "2186820",
    "end": "2192099"
  },
  {
    "text": "of images from the game and also then we added the speed and the steering or",
    "start": "2192099",
    "end": "2199060"
  },
  {
    "text": "turning angle but now we wanted to try and specialize the features even further as you can see",
    "start": "2199060",
    "end": "2205540"
  },
  {
    "text": "the the agent was crashing a lot into the walls so we wanted to address this",
    "start": "2205540",
    "end": "2212280"
  },
  {
    "text": "by perhaps try and measure the distance to the walls from the ai's point of view",
    "start": "2212280",
    "end": "2219099"
  },
  {
    "text": "because maybe this will be useful information for not crashing into the wall anymore",
    "start": "2219099",
    "end": "2225040"
  },
  {
    "text": "so this is kind of like drawing lines from the middle of the screen towards the wall and then you measure uh the",
    "start": "2225040",
    "end": "2233920"
  },
  {
    "text": "length in pixels to do this you first have to find the walls",
    "start": "2233920",
    "end": "2239800"
  },
  {
    "text": "and we did we gave it a go using tools from opencv",
    "start": "2239800",
    "end": "2245140"
  },
  {
    "text": "computer vision tools we started out by using canny Edge detection which is",
    "start": "2245140",
    "end": "2252640"
  },
  {
    "text": "which is as you can see at Edge detection algorithm and it also removes",
    "start": "2252640",
    "end": "2258640"
  },
  {
    "text": "noise from the image given a certain threshold because as you can see it doesn't really care about the edges on",
    "start": "2258640",
    "end": "2265359"
  },
  {
    "text": "the road and doesn't give a about the cloud I'm not sure if I'm allowed to swear but no I did sorry NDC organizer",
    "start": "2265359",
    "end": "2273460"
  },
  {
    "text": "people um and then as Malta also showed you",
    "start": "2273460",
    "end": "2278859"
  },
  {
    "text": "earlier we cut out the top half of the image because we don't care about what's",
    "start": "2278859",
    "end": "2284680"
  },
  {
    "text": "going on there we only care about the road and the walls and then now we need to determine if",
    "start": "2284680",
    "end": "2291880"
  },
  {
    "text": "these edges are lines now what's the difference between an edge and a line there is a distinct",
    "start": "2291880",
    "end": "2298300"
  },
  {
    "text": "difference but um I'm not going to explain it to you now but but what you need to know is that we need to find",
    "start": "2298300",
    "end": "2303940"
  },
  {
    "text": "lines uh and that we do with something called Huff line transformation both",
    "start": "2303940",
    "end": "2310359"
  },
  {
    "text": "both of these methods are just used out of the box using opencv so we didn't",
    "start": "2310359",
    "end": "2316000"
  },
  {
    "text": "really Implement anything here for using those now we have all these lines but we don't",
    "start": "2316000",
    "end": "2322359"
  },
  {
    "text": "need all those lines we need two lines one for each wall to know where the wall",
    "start": "2322359",
    "end": "2327520"
  },
  {
    "text": "begins where it ends so through interpolation of these lines",
    "start": "2327520",
    "end": "2333160"
  },
  {
    "text": "we can approximate a line for each wall which covers the length of the wall",
    "start": "2333160",
    "end": "2340740"
  },
  {
    "text": "and then we can just draw out lines from different angles from The Middle",
    "start": "2341380",
    "end": "2349839"
  },
  {
    "text": "and then we hit the walls so the interpolation isn't perfect but it's pretty decent a good starting point",
    "start": "2349839",
    "end": "2358020"
  },
  {
    "text": "does anyone see a problem with this approach of measuring distance",
    "start": "2358720",
    "end": "2364619"
  },
  {
    "text": "exactly so there's a problem with perspective here as you said uh",
    "start": "2374040",
    "end": "2381700"
  },
  {
    "text": "because this is a two-dimensional image and we're trying to measure distance in",
    "start": "2381700",
    "end": "2386980"
  },
  {
    "text": "a three-dimensional space which doesn't really make sense so um I want to do like use a laser pointer",
    "start": "2386980",
    "end": "2394240"
  },
  {
    "text": "but I think it's a little bit too packed for me to go out there and shoot at the screen and the Overflow streaming people",
    "start": "2394240",
    "end": "2400780"
  },
  {
    "text": "are going to be mad at me for not showing them the same thing I'm going to show you so",
    "start": "2400780",
    "end": "2406060"
  },
  {
    "text": "now let's see if I can like get an arrow out here",
    "start": "2406060",
    "end": "2411540"
  },
  {
    "text": "do you see an arrow moving around well that sucks okay so I'm just gonna",
    "start": "2412900",
    "end": "2418839"
  },
  {
    "text": "I'm just gonna head out here we're gonna use this screen sorry",
    "start": "2418839",
    "end": "2425320"
  },
  {
    "text": "streaming people you should have been down here um so if you look at this point",
    "start": "2425320",
    "end": "2431560"
  },
  {
    "text": "and then you look at this point do you guys see over there yeah good",
    "start": "2431560",
    "end": "2437740"
  },
  {
    "text": "this point is actually further away from a game perspective than this point but this line",
    "start": "2437740",
    "end": "2445359"
  },
  {
    "text": "is actually shorter than this line which doesn't really make sense",
    "start": "2445359",
    "end": "2452140"
  },
  {
    "text": "and this isn't always the case either because sometimes it's intuitive and correct but that means that we got an",
    "start": "2452140",
    "end": "2458320"
  },
  {
    "text": "inconsistency problem as well so this information isn't really going to be useful",
    "start": "2458320",
    "end": "2463780"
  },
  {
    "text": "and I was a little annoyed by myself or not seeing this beforehand before",
    "start": "2463780",
    "end": "2469119"
  },
  {
    "text": "implementing this because it's kind of obvious really but anyway",
    "start": "2469119",
    "end": "2474300"
  },
  {
    "text": "we didn't really want to scrap this momentarily so we want to add some information and see if we could make it",
    "start": "2474300",
    "end": "2480940"
  },
  {
    "text": "useful anyway so we decided to partially start over what we want to do now is to identify",
    "start": "2480940",
    "end": "2488320"
  },
  {
    "text": "the entire area of the wall and more specifically the height of the wall at",
    "start": "2488320",
    "end": "2493540"
  },
  {
    "text": "the point where the those arrows that we drew out hits the wall because as you",
    "start": "2493540",
    "end": "2499480"
  },
  {
    "text": "can see like the middle uh arrow that small arrow in the middle uh",
    "start": "2499480",
    "end": "2506980"
  },
  {
    "text": "it's the wall is shorter there than on the right side right so so the closer",
    "start": "2506980",
    "end": "2512380"
  },
  {
    "text": "the wall is the taller it's going to be as well so this could be useful for making this",
    "start": "2512380",
    "end": "2518560"
  },
  {
    "text": "information viable so first we turn the image grayscale",
    "start": "2518560",
    "end": "2525579"
  },
  {
    "text": "and now we can see that the wall is a lot blacker than the rest of the image",
    "start": "2525579",
    "end": "2531880"
  },
  {
    "text": "so in the next step when we use something called inverse binary thresholding",
    "start": "2531880",
    "end": "2537520"
  },
  {
    "text": "the wall which was black now turns white and all the brighter pixels turn black",
    "start": "2537520",
    "end": "2543820"
  },
  {
    "text": "so this is a similar method to what Malta was showing earlier but it's like an inverse",
    "start": "2543820",
    "end": "2549700"
  },
  {
    "text": "and this is useful in the next step when we want to identify the Contours of the",
    "start": "2549700",
    "end": "2557200"
  },
  {
    "text": "wall or both walls and this is also just a method out of the box didn't Implement anything just",
    "start": "2557200",
    "end": "2563320"
  },
  {
    "text": "used opencv and now we have all these Contours many different they seem they look like",
    "start": "2563320",
    "end": "2569140"
  },
  {
    "text": "they're interconnected but they're actually different sets of Contours all along the walls",
    "start": "2569140",
    "end": "2574960"
  },
  {
    "text": "and each Contour consists of a set of points in the next step we take all of",
    "start": "2574960",
    "end": "2580660"
  },
  {
    "text": "these points we use a clustering algorithm called DB scan",
    "start": "2580660",
    "end": "2586060"
  },
  {
    "text": "and then we get then we identify the two largest clusters assuming that those are",
    "start": "2586060",
    "end": "2591819"
  },
  {
    "text": "going to be the walls in the image and now we want now we just have these",
    "start": "2591819",
    "end": "2598660"
  },
  {
    "text": "points but we want the shape of each wall so we use the library called Alpha",
    "start": "2598660",
    "end": "2603940"
  },
  {
    "text": "shape and computed a concave Hull for both sets of points and then it looks",
    "start": "2603940",
    "end": "2609700"
  },
  {
    "text": "like this so a concave Hull of a set of points that means find a shape that",
    "start": "2609700",
    "end": "2614980"
  },
  {
    "text": "encloses all of those points in the set and as you can see it does a pretty good",
    "start": "2614980",
    "end": "2620740"
  },
  {
    "text": "job it's not perfect but it's actually a lot better than what I showed you earlier and the lines that we now draw",
    "start": "2620740",
    "end": "2626380"
  },
  {
    "text": "out are are a lot better except the one in the middle which is completely useless but um",
    "start": "2626380",
    "end": "2633400"
  },
  {
    "text": "but now we get like a like a perfect hit on the wall and we can also measure the",
    "start": "2633400",
    "end": "2638980"
  },
  {
    "text": "height of the walls at those points now the problem because there's a",
    "start": "2638980",
    "end": "2644440"
  },
  {
    "text": "problem here as well is that I mean this looks very promising but there's a lot of complex algorithms",
    "start": "2644440",
    "end": "2650859"
  },
  {
    "text": "and expensive computations being done here I mean we basically over engineered",
    "start": "2650859",
    "end": "2656020"
  },
  {
    "text": "the whole thing with DB scan concave haul blah blah blah so when we try to",
    "start": "2656020",
    "end": "2661540"
  },
  {
    "text": "use this during training it just wasn't fast enough so we ended up just scrapping the whole thing didn't use any",
    "start": "2661540",
    "end": "2668020"
  },
  {
    "text": "of it and uh that was a couple of months of work",
    "start": "2668020",
    "end": "2674079"
  },
  {
    "text": "I ended up going for a simpler solution for crash detection uh that Malta is going to talk about in a bit",
    "start": "2674079",
    "end": "2682500"
  },
  {
    "text": "you get to talk about all the stuff that worked yeah because I made them nice",
    "start": "2683500",
    "end": "2689520"
  },
  {
    "text": "nah it's just a joke guys um all right let's talk a little bit about phase three so we changed from PPO",
    "start": "2691720",
    "end": "2698260"
  },
  {
    "text": "to dqn even though that PPO is better on paper me and Manu we understand the eqn",
    "start": "2698260",
    "end": "2705280"
  },
  {
    "text": "a lot better so it's easier to like debug and understand the behavior of the agent and then we did add some crash",
    "start": "2705280",
    "end": "2711339"
  },
  {
    "text": "detection um and so we can just forget about all those fancy words I knew it was talking",
    "start": "2711339",
    "end": "2717040"
  },
  {
    "text": "about and the way we actually ended up doing it is remember we had this image from when",
    "start": "2717040",
    "end": "2724960"
  },
  {
    "text": "do we did some processing of the of the raw pixels from the screenshot what we ended up doing is that we in the",
    "start": "2724960",
    "end": "2733180"
  },
  {
    "text": "same way we just took from the bottom middle of the screen we just drew lines until the first black pixel because the",
    "start": "2733180",
    "end": "2740980"
  },
  {
    "text": "white is just completely you know the the road is completely White and the wall is the first black pixel that it",
    "start": "2740980",
    "end": "2747760"
  },
  {
    "text": "hits and then we measured the distance here as well and uh I think it was if the distance is",
    "start": "2747760",
    "end": "2754839"
  },
  {
    "text": "less than 420 then it's actually crashing and it works quite well actually so I don't uh you know",
    "start": "2754839",
    "end": "2761680"
  },
  {
    "text": "perspective it's I don't know what that is but uh you know this this is for",
    "start": "2761680",
    "end": "2766960"
  },
  {
    "text": "where this worked uh good enough you know do you want to fight [Laughter]",
    "start": "2766960",
    "end": "2775710"
  },
  {
    "text": "um all right so uh yeah with some crash detection we can then punish the car for uh crashing so let's see how that",
    "start": "2775780",
    "end": "2783579"
  },
  {
    "text": "influenced the AI in phase three let's take a look at some highlights",
    "start": "2783579",
    "end": "2789940"
  },
  {
    "text": "[Music] foreign [Music]",
    "start": "2789940",
    "end": "2797219"
  },
  {
    "text": "[Music] yeah all right so it is actually driving",
    "start": "2828460",
    "end": "2836200"
  },
  {
    "text": "quite a lot better than phase two even uh we can take a look at some closer looks here",
    "start": "2836200",
    "end": "2842380"
  },
  {
    "text": "um and the the track time now went down from about 30 to about 20 and a half",
    "start": "2842380",
    "end": "2849220"
  },
  {
    "text": "seconds of the best ones uh which is almost at the level I'm at I",
    "start": "2849220",
    "end": "2855760"
  },
  {
    "text": "was driving it at around 18. um so we're quite happy with how this is",
    "start": "2855760",
    "end": "2861700"
  },
  {
    "text": "going you know we're just adding more stuff and it's going quite well and then we go into phase four you know",
    "start": "2861700",
    "end": "2867880"
  },
  {
    "text": "going for the Holy Grail getting pumped up um and what should also be noted is that",
    "start": "2867880",
    "end": "2873520"
  },
  {
    "text": "until this point uh we actually have done it the training uh similarly to how",
    "start": "2873520",
    "end": "2878560"
  },
  {
    "text": "a human would train we only looked at the screen and only of simulated key presses I was also one of the premises",
    "start": "2878560",
    "end": "2884380"
  },
  {
    "text": "for this um for this project but now we were",
    "start": "2884380",
    "end": "2889480"
  },
  {
    "text": "thinking if you want to do it even better maybe we should just uh hook into the game API to get some even more",
    "start": "2889480",
    "end": "2895180"
  },
  {
    "text": "precise stuff and more more data and what the API gives us is really only",
    "start": "2895180",
    "end": "2901480"
  },
  {
    "text": "two things um it gives us a way to detect when the countdown has ended if you guys have",
    "start": "2901480",
    "end": "2908260"
  },
  {
    "text": "noticed before the car starts driving there's the three two one go and until now the the car or the agent",
    "start": "2908260",
    "end": "2916359"
  },
  {
    "text": "has really just been trying to drive while that countdown is going which means that it's trying to perform",
    "start": "2916359",
    "end": "2922780"
  },
  {
    "text": "actions but it doesn't get any feedback so it just creates false data for us",
    "start": "2922780",
    "end": "2928240"
  },
  {
    "text": "and this data is then trained on later um similarly it gives us a way to detect",
    "start": "2928240",
    "end": "2934540"
  },
  {
    "text": "when the car crosses the finish line because until now in trekmania when you",
    "start": "2934540",
    "end": "2939700"
  },
  {
    "text": "cross across the Finish Line um it takes like two or three seconds",
    "start": "2939700",
    "end": "2944859"
  },
  {
    "text": "before this menu pops up that's really easy to detect but before that it's quite hard so when it crosses the Finish",
    "start": "2944859",
    "end": "2950740"
  },
  {
    "text": "Line it also tries to drive for like two or three more seconds and also just generates the wrong data for us",
    "start": "2950740",
    "end": "2956560"
  },
  {
    "text": "but the API fixes this problem which we thought would actually influence it quite a lot",
    "start": "2956560",
    "end": "2963160"
  },
  {
    "text": "um and the way we set it up was that we set up a socket server and a client so",
    "start": "2963160",
    "end": "2968560"
  },
  {
    "text": "um we had the the game running in one's process and then we had the socket server and the game would just",
    "start": "2968560",
    "end": "2974980"
  },
  {
    "text": "continuously send the these kind of data to the socket server and then the agent would pull the",
    "start": "2974980",
    "end": "2982060"
  },
  {
    "text": "data from the socket server so there's a small delay but it's almost negligible",
    "start": "2982060",
    "end": "2988380"
  },
  {
    "text": "um yeah so let's see how Face Forward",
    "start": "2988660",
    "end": "2995940"
  },
  {
    "text": "okay",
    "start": "3024180",
    "end": "3027180"
  },
  {
    "text": "[Music]",
    "start": "3045190",
    "end": "3054839"
  },
  {
    "text": "thank you [Music]",
    "start": "3066740",
    "end": "3072660"
  },
  {
    "text": "so that's how that went um uh what it actually",
    "start": "3072660",
    "end": "3077819"
  },
  {
    "text": "um would actually need to know is that when on the starting Block in trekmania there's no walls around it behind the",
    "start": "3077819",
    "end": "3085319"
  },
  {
    "text": "car so the car actually learned to drive down on the grass there's this huge",
    "start": "3085319",
    "end": "3091319"
  },
  {
    "text": "grass area around the the track that can just drive freely and uh the reason it did this we think",
    "start": "3091319",
    "end": "3100200"
  },
  {
    "text": "is that we have too high reward for just driving fast so just drive down on the grass and it",
    "start": "3100200",
    "end": "3106740"
  },
  {
    "text": "will just drive back and forth and for 50 seconds until it restarted of course",
    "start": "3106740",
    "end": "3112559"
  },
  {
    "text": "um and yes we have too high reward for that and then on the grass as well it would never crash so it doesn't get any",
    "start": "3112559",
    "end": "3119160"
  },
  {
    "text": "punishment for crashing um yeah that's what we think at least where",
    "start": "3119160",
    "end": "3125460"
  },
  {
    "text": "we are not we don't know but yeah we'll continue working on this after uh",
    "start": "3125460",
    "end": "3130859"
  },
  {
    "text": "a phase four and uh yeah maybe we'll see you next year at uh NDC guys all right",
    "start": "3130859",
    "end": "3137520"
  },
  {
    "text": "thanks [Applause]",
    "start": "3137520",
    "end": "3149060"
  }
]