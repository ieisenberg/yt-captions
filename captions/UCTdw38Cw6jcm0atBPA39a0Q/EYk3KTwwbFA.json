[
  {
    "start": "0",
    "end": "125000"
  },
  {
    "text": "we're starting hi",
    "start": "2399",
    "end": "7479"
  },
  {
    "text": "welcome hello ah there we go so um my",
    "start": "7559",
    "end": "14679"
  },
  {
    "text": "name is Dominic this is brog we are working for for many many years together on on this thing called identity server",
    "start": "14679",
    "end": "21400"
  },
  {
    "text": "which is an you know an extension to to asp.net core if you like um that adds",
    "start": "21400",
    "end": "27880"
  },
  {
    "text": "certain server capabilities like you know open connect and O and so on so our",
    "start": "27880",
    "end": "33280"
  },
  {
    "text": "day-to-day job is is dealing with ASP net core security so we have many customers well I guess all of our",
    "start": "33280",
    "end": "39559"
  },
  {
    "text": "customers these days are on ASP net core um security uh uh uh and the latest",
    "start": "39559",
    "end": "46079"
  },
  {
    "text": "version so a lot of the times you know um they they ask themselves is this",
    "start": "46079",
    "end": "53239"
  },
  {
    "text": "platform does it have all I need so to speak to implement the thing I want to implement yeah so the the idea behind",
    "start": "53239",
    "end": "62120"
  },
  {
    "text": "behind this uh talk was basically to give you an overview like a checklist of all the important security features that",
    "start": "62120",
    "end": "69920"
  },
  {
    "text": "are inside of aspet core um so that you can validate yourself you know is is",
    "start": "69920",
    "end": "76799"
  },
  {
    "text": "everything in there that I need to build um an application okay you can imagine",
    "start": "76799",
    "end": "82320"
  },
  {
    "text": "it's a lot of material uh so we just did a two-day workshop just on some of the",
    "start": "82320",
    "end": "87520"
  },
  {
    "text": "aspects of a minut core security so in 60 Minutes really it's it's it's really an overview don't expect that we can go",
    "start": "87520",
    "end": "94079"
  },
  {
    "text": "into any area in too much detail yeah that's why I added um a couple of uh",
    "start": "94079",
    "end": "99920"
  },
  {
    "text": "references on the slides uh for you that you can go afterwards go learn more okay",
    "start": "99920",
    "end": "105200"
  },
  {
    "text": "like more reading material more samples uh and so on so basically the idea is um",
    "start": "105200",
    "end": "110719"
  },
  {
    "text": "I uploaded the slide deck to here so you just you know take a picture of that or write it down uh then you can get to the",
    "start": "110719",
    "end": "117360"
  },
  {
    "text": "slide deck and from the slide deck you can get to all the other reading links so to speak",
    "start": "117360",
    "end": "123520"
  },
  {
    "text": "okay um yeah so we've come a long way with asp.net security does anyone",
    "start": "123520",
    "end": "130319"
  },
  {
    "start": "125000",
    "end": "181000"
  },
  {
    "text": "remember this here yeah couple of people uh how many of these five options",
    "start": "130319",
    "end": "137360"
  },
  {
    "text": "actually [Laughter] work none",
    "start": "137360",
    "end": "142959"
  },
  {
    "text": "none you mean none of them or the none yeah none Works you're right um",
    "start": "142959",
    "end": "150800"
  },
  {
    "text": "what was passport does does anyone remember what passport is is anyone old enough in the room passport was a",
    "start": "150800",
    "end": "157280"
  },
  {
    "text": "product from Microsoft that got pulled before version 1.0 of asp.net but no one",
    "start": "157280",
    "end": "162360"
  },
  {
    "text": "updated the enum so it's still in there uh Federated was their second attempt to",
    "start": "162360",
    "end": "168519"
  },
  {
    "text": "put some Modern security stuff into as.net it got pulled before they released it and no one updated the enam",
    "start": "168519",
    "end": "175879"
  },
  {
    "text": "so yeah we have a couple of options and some of them work okay",
    "start": "175879",
    "end": "181680"
  },
  {
    "start": "181000",
    "end": "223000"
  },
  {
    "text": "um I even spent you know if if you remember one thing from this talk never ever write a book yeah it's it's a waste",
    "start": "181680",
    "end": "188959"
  },
  {
    "text": "of time um I I even spent like 14 months of my life documenting all of these things in asp.net um I think four weeks",
    "start": "188959",
    "end": "196760"
  },
  {
    "text": "after this book got released it was hp. net 3.0 um so you know pretty much did did",
    "start": "196760",
    "end": "203799"
  },
  {
    "text": "did did any anyone read this book in the room did anyone no that's what I thought yeah um I didn't think that one of the",
    "start": "203799",
    "end": "210760"
  },
  {
    "text": "three people were here today yeah so but actually that that was one of the one of",
    "start": "210760",
    "end": "216239"
  },
  {
    "text": "the first projects we work together on you were Brock was a reviewer um of that book and you know anyways that's all",
    "start": "216239",
    "end": "223519"
  },
  {
    "start": "223000",
    "end": "307000"
  },
  {
    "text": "gone um so yeah so this is basically our",
    "start": "223519",
    "end": "228680"
  },
  {
    "text": "our our um starting point yeah um that's the type of architecture that many people build these days right we have",
    "start": "228680",
    "end": "234920"
  },
  {
    "text": "front ends we have back ends we have back ends for back ends and uh you have some security requirements there you",
    "start": "234920",
    "end": "241400"
  },
  {
    "text": "know um we have multiple front-end types and Technologies and the users need to",
    "start": "241400",
    "end": "247239"
  },
  {
    "text": "be able to authenticate to our back ends and you know that might be JavaScript and uh Native applications and web",
    "start": "247239",
    "end": "253959"
  },
  {
    "text": "applications and server to server style uh communication and so on um that's one",
    "start": "253959",
    "end": "260040"
  },
  {
    "text": "thing um we often have uh you know call patterns where someone calls the service",
    "start": "260040",
    "end": "265360"
  },
  {
    "text": "but maybe also where the service delegates the identity to the next top um in the system",
    "start": "265360",
    "end": "271080"
  },
  {
    "text": "um typically you have something called an identity provider which abstracts away all of the authentication needs so",
    "start": "271080",
    "end": "276919"
  },
  {
    "text": "that regardless how this user comes into your system it's always the same user and you don't have to implement all of",
    "start": "276919",
    "end": "282600"
  },
  {
    "text": "the you know these variations in in multiple places typically you have something like an a a policy an",
    "start": "282600",
    "end": "288400"
  },
  {
    "text": "authorization policy system um that can can come in many shapes or forms um to",
    "start": "288400",
    "end": "293960"
  },
  {
    "text": "basically you know implement the question like who is the user and what is he allowed to do and you know",
    "start": "293960",
    "end": "300160"
  },
  {
    "text": "um the more building blocks we're adding this gets more complicated so we need a solid framework to be able to to",
    "start": "300160",
    "end": "306800"
  },
  {
    "text": "implement that yeah so um we're going to look at the most fundamental um Security Services",
    "start": "306800",
    "end": "314080"
  },
  {
    "start": "307000",
    "end": "360000"
  },
  {
    "text": "provided by asit core so we we going to go on you know from from from bottom to to um top",
    "start": "314080",
    "end": "321880"
  },
  {
    "text": "um not a lot has changed to be honest in the last year or so in in security which",
    "start": "321880",
    "end": "328160"
  },
  {
    "text": "is a good thing right because all the years before Microsoft changed their stuff on a yearly basis and you know",
    "start": "328160",
    "end": "334160"
  },
  {
    "text": "breaking changes for the last year I think it it it was stable which I think is a good thing in security um but you",
    "start": "334160",
    "end": "341800"
  },
  {
    "text": "all know that 3.0 is coming out soon so it's their chance again to Break Stuff um um and I'm going to point out some",
    "start": "341800",
    "end": "348800"
  },
  {
    "text": "some of the things that are coming in in the next version okay um again all of the samples that Brock Brock's going to",
    "start": "348800",
    "end": "354919"
  },
  {
    "text": "show they are um available on GitHub um using this this URL okay okay let's get",
    "start": "354919",
    "end": "360400"
  },
  {
    "start": "360000",
    "end": "473000"
  },
  {
    "text": "started so first thing hosting okay so before we even think about running our application or how designing our",
    "start": "360400",
    "end": "366639"
  },
  {
    "text": "application you you know you want to host it somehow um Microsoft has this",
    "start": "366639",
    "end": "372120"
  },
  {
    "text": "new web server called castral it it's not that new anymore right it's a couple of years old now but in in in in web",
    "start": "372120",
    "end": "379720"
  },
  {
    "text": "server years it's pretty uh young okay so um when they first released that the",
    "start": "379720",
    "end": "387680"
  },
  {
    "text": "the recommendation was don't use Cal on the internet yeah it's uh you know it's very new we don't know yet how good it",
    "start": "387680",
    "end": "394520"
  },
  {
    "text": "really is from from a from a security point of view so they they said like the only supported configuration of castal",
    "start": "394520",
    "end": "401000"
  },
  {
    "text": "is you know that that you have a reverse proxy in front of it that you know something that is proven battle tested",
    "start": "401000",
    "end": "406919"
  },
  {
    "text": "like engine X or Apache or IIs something like this and then this uh basically takes the traffic from the outside world",
    "start": "406919",
    "end": "413639"
  },
  {
    "text": "and then forwards the traffic to castal and you know and the way back um starting with version two they actually",
    "start": "413639",
    "end": "420720"
  },
  {
    "text": "did a lot of penetration testing on castal got in many companies and they you know were all pretty happy that they",
    "start": "420720",
    "end": "425759"
  },
  {
    "text": "finally can test a new web server because who writes new web servers these days and starting with version two it's",
    "start": "425759",
    "end": "431879"
  },
  {
    "text": "now a a completely supported uh configuration so to speak to have castal",
    "start": "431879",
    "end": "437080"
  },
  {
    "text": "running on the edge but I think I wouldn't do it okay I",
    "start": "437080",
    "end": "442599"
  },
  {
    "text": "still think it's a very new web server and attackers are very creative and i n",
    "start": "442599",
    "end": "450120"
  },
  {
    "text": "don't would you do it you're not ready yet I'm too old maybe no no no well maybe they're not ready yet yeah I don't",
    "start": "450120",
    "end": "456400"
  },
  {
    "text": "know um uh even with with that now being allowed I still prefer this kind of",
    "start": "456400",
    "end": "462000"
  },
  {
    "text": "configuration where you have something in front that you know has many many years of of being security tested like",
    "start": "462000",
    "end": "468159"
  },
  {
    "text": "engine X for example or Apache or IIs okay um that being said if you want to",
    "start": "468159",
    "end": "475000"
  },
  {
    "start": "473000",
    "end": "524000"
  },
  {
    "text": "do that be prepared to tweak a lot of you know parameters because obviously a website is a complex thing and they they",
    "start": "475000",
    "end": "481960"
  },
  {
    "text": "they try to give you a good compromise between security and performance so lots of things to tweak to make it work for",
    "start": "481960",
    "end": "487720"
  },
  {
    "text": "your application you know like you know timeouts and and limits and sizes and and what whatever um it it has built in",
    "start": "487720",
    "end": "496360"
  },
  {
    "text": "support for htps now so that's good um even even with the with the reverse",
    "start": "496360",
    "end": "501680"
  },
  {
    "text": "proxy scenario you can still do hgps between the proxy and the the final web server if that is important for you um",
    "start": "501680",
    "end": "508560"
  },
  {
    "text": "they have support for both static htps and Sni server name indication where you",
    "start": "508560",
    "end": "513719"
  },
  {
    "text": "can dynamically choose the htps certificate based on the host header name so yeah it's it's it's getting",
    "start": "513719",
    "end": "519200"
  },
  {
    "text": "there I think I still would prefer the old school setup I think good um so once",
    "start": "519200",
    "end": "526760"
  },
  {
    "start": "524000",
    "end": "569000"
  },
  {
    "text": "you are inside the host so to speak um then basically a core is basically",
    "start": "526760",
    "end": "531920"
  },
  {
    "text": "consists of two building blocks middleware and services okay uh the middleware is is the thing that runs on",
    "start": "531920",
    "end": "538240"
  },
  {
    "text": "the request Pipeline and the reason you write middleware is because you want to get invoked automatically when a request",
    "start": "538240",
    "end": "543279"
  },
  {
    "text": "comes in or a response goes out but the middleware itself typically doesn't have a lot of logic it pulls from services",
    "start": "543279",
    "end": "550959"
  },
  {
    "text": "from the uh di container okay so all it turns out all Security Services in aut",
    "start": "550959",
    "end": "558160"
  },
  {
    "text": "core are services in in a dependency injection container and that's just what",
    "start": "558160",
    "end": "563240"
  },
  {
    "text": "the middleware is using or what your code would be used or what their Plumbing is using basically so let's",
    "start": "563240",
    "end": "568600"
  },
  {
    "text": "have a look at those the most fundamental one is data protection so you have many many",
    "start": "568600",
    "end": "573720"
  },
  {
    "start": "569000",
    "end": "645000"
  },
  {
    "text": "situations in in your web application where you need to protect data okay the probably the most common one would be",
    "start": "573720",
    "end": "580600"
  },
  {
    "text": "protecting a cookie right you're issuing a cookie you put some data in there you want to make sure no one can change that",
    "start": "580600",
    "end": "586279"
  },
  {
    "text": "cookie or look inside or tamper with it and on the way back you want to validate that cookie um so that that that",
    "start": "586279",
    "end": "592360"
  },
  {
    "text": "requires crypto right and when you hear the word crypto your first question should be and where is the key yeah do",
    "start": "592360",
    "end": "599440"
  },
  {
    "text": "you remember this the machine key element in a.net yeah it was your master key right",
    "start": "599440",
    "end": "607000"
  },
  {
    "text": "um so you had to create a master key um and and put it into your config file and",
    "start": "607000",
    "end": "613079"
  },
  {
    "text": "you know that pretty much became the most important key or string in your application because whoever had access",
    "start": "613079",
    "end": "619000"
  },
  {
    "text": "to that string could create cookies that look like they come from you right and",
    "start": "619000",
    "end": "624120"
  },
  {
    "text": "because this was the most important string in our application we put it into clear text into a config file on our a",
    "start": "624120",
    "end": "629440"
  },
  {
    "text": "web server right yes makes total sense it's a bit of an outdated design yeah",
    "start": "629440",
    "end": "635120"
  },
  {
    "text": "they had to fix that um this key was literally impossible to rotate to change without breaking users that are",
    "start": "635120",
    "end": "642040"
  },
  {
    "text": "currently using your application so they basically changed the whole thing there's now an official data protection",
    "start": "642040",
    "end": "648200"
  },
  {
    "start": "645000",
    "end": "709000"
  },
  {
    "text": "API in a minut core and the first thing they had to fix was store that key",
    "start": "648200",
    "end": "653279"
  },
  {
    "text": "outside the application and not inside the application you know actually go one back you wouldn't believe how many",
    "start": "653279",
    "end": "659839"
  },
  {
    "text": "GitHub repos have machine Keys checked in for example yeah um or if you want to",
    "start": "659839",
    "end": "665680"
  },
  {
    "text": "have fun try this on Google which searches for the word machine key in files that that end with config um",
    "start": "665680",
    "end": "673240"
  },
  {
    "text": "you'll be uh surprised yeah okay uh I think in some countries it's illegal to",
    "start": "673240",
    "end": "678360"
  },
  {
    "text": "give this advice yeah I it show that in the states in the states absolutely yeah but we are not in the states that's good",
    "start": "678360",
    "end": "684959"
  },
  {
    "text": "um anyways um so the first thing they had to fix was that key material has to",
    "start": "684959",
    "end": "690639"
  },
  {
    "text": "live outside the application right um and that that's a good thing but obviously it creates a little bit more",
    "start": "690639",
    "end": "697120"
  },
  {
    "text": "uh complexity yeah so they they they have some default values where they store those keys when you are on your",
    "start": "697120",
    "end": "702440"
  },
  {
    "text": "local developer machine they're going to use your user profile and in inside the user profile I think we have a",
    "start": "702440",
    "end": "708360"
  },
  {
    "text": "screenshot of that just go on yeah inside your user profile if you drill down all these folders you'll find uh a",
    "start": "708360",
    "end": "715560"
  },
  {
    "start": "709000",
    "end": "820000"
  },
  {
    "text": "folder called Data protection Keys okay and that's where they store the m master key for your machine and then each",
    "start": "715560",
    "end": "721880"
  },
  {
    "text": "application basically is deriving Keys um from that master key um for their",
    "start": "721880",
    "end": "727440"
  },
  {
    "text": "certain purposes okay so go one back again now this is all fine for local development scenarios but once you",
    "start": "727440",
    "end": "733959"
  },
  {
    "text": "deploy the application to the server you have to make up your mind where do I want to store my keys okay um obviously",
    "start": "733959",
    "end": "741480"
  },
  {
    "text": "Microsoft being Microsoft yeah when you when you deploy to Asher right um",
    "start": "741480",
    "end": "746839"
  },
  {
    "text": "there's some magic pixie dust they can put over your deployment and it just they they take care of it in in the",
    "start": "746839",
    "end": "752360"
  },
  {
    "text": "background there but if you have any sort of load balanced or redundant",
    "start": "752360",
    "end": "759199"
  },
  {
    "text": "deployment that you're doing yourself you have to find a shared location to store these keys right it could be a",
    "start": "759199",
    "end": "764480"
  },
  {
    "text": "file share could be a database could be red could be uh whatever right um it's",
    "start": "764480",
    "end": "771720"
  },
  {
    "text": "it's extensible why am I me mentioning that to you because we have many customers um that weren't aware of this",
    "start": "771720",
    "end": "778800"
  },
  {
    "text": "because this API is for most Parts invisible right it just works yeah it it does does does its job behind the scenes",
    "start": "778800",
    "end": "785360"
  },
  {
    "text": "and as every good security API should be it should be not getting in the way okay",
    "start": "785360",
    "end": "790959"
  },
  {
    "text": "um but now you completely unaware that this thing actually exists you you deploy it to your server and suddenly",
    "start": "790959",
    "end": "797199"
  },
  {
    "text": "you get weird Behavior or intermittently yes and that might",
    "start": "797199",
    "end": "802800"
  },
  {
    "text": "manifest itself as your users are not able to log in right because you you have a load balanced environment so one",
    "start": "802800",
    "end": "809360"
  },
  {
    "text": "creates a cookie that cookie goes to server two they don't have the the same key material server two will say like",
    "start": "809360",
    "end": "815079"
  },
  {
    "text": "this cookie is invalid user is signed out okay so let's have a look at how we",
    "start": "815079",
    "end": "821120"
  },
  {
    "start": "820000",
    "end": "1040000"
  },
  {
    "text": "can reproduce this problem just to just to show you that it's it's really a problem yeah so uh this is a sample",
    "start": "821120",
    "end": "827959"
  },
  {
    "text": "application showing you how you would configure the data protection system in your air application uh and here's our",
    "start": "827959",
    "end": "834759"
  },
  {
    "text": "uh you know configuration of our dependency injection system uh this is adding data protection by the way never",
    "start": "834759",
    "end": "840480"
  },
  {
    "text": "ever do that what what what what we are doing here because we are just storing the keys in the current directory and",
    "start": "840480",
    "end": "845759"
  },
  {
    "text": "that's just for demonstration purposes please don't do that okay yeah so this is the big one that you want to know about is deciding where to put the keys",
    "start": "845759",
    "end": "853320"
  },
  {
    "text": "uh on your system so I have a lot of customers that do AWS deployment and they have to configure this in their",
    "start": "853320",
    "end": "858399"
  },
  {
    "text": "application so um one of the built-in functions is to for Microsoft is to put",
    "start": "858399",
    "end": "863440"
  },
  {
    "text": "them somewhere in your file system so we're just putting them in the current directory and I don't know if you can see here but",
    "start": "863440",
    "end": "869800"
  },
  {
    "text": "we don't have any key text files right now in the current directory okay um and",
    "start": "869800",
    "end": "875360"
  },
  {
    "text": "so we have a sample where we're going to just um use the data protection API directly if I can run this and we're",
    "start": "875360",
    "end": "882279"
  },
  {
    "text": "going to encrypt a string you know protect a string and then unprotect a string and that's probably the most boring demo in the world sorry so so we",
    "start": "882279",
    "end": "889720"
  },
  {
    "text": "put in hello world right we call Protect this is the just our MVC controller",
    "start": "889720",
    "end": "895120"
  },
  {
    "text": "using the data protection API directly um so you can use this yourselves and we're you know getting our our protected",
    "start": "895120",
    "end": "902000"
  },
  {
    "text": "string here okay so that's very much like what Microsoft would do with their cookies",
    "start": "902000",
    "end": "907920"
  },
  {
    "text": "internally so over here now in my file system notice I have a new file key-",
    "start": "907920",
    "end": "913800"
  },
  {
    "text": "someid dox MML so this was dynamically created the first time that a key needed",
    "start": "913800",
    "end": "919360"
  },
  {
    "text": "to be used to do data protection uh they put it in the location we told it which is you know production not here you",
    "start": "919360",
    "end": "924959"
  },
  {
    "text": "shouldn't be doing it here and they have some information in here about the key um one of them about the the the",
    "start": "924959",
    "end": "930040"
  },
  {
    "text": "creation date and they have this notion of an activation date so the idea is they you create these keys and they're",
    "start": "930040",
    "end": "936120"
  },
  {
    "text": "good for or they're they're being used for 90 days and the interesting thing is then after 90 days they actually create",
    "start": "936120",
    "end": "942079"
  },
  {
    "text": "another key so internally they do key rotation which is kind of a good practice when you have key material they",
    "start": "942079",
    "end": "948240"
  },
  {
    "text": "still keep the old ones to unprotect Old you know data that was protected with the old ones but new data will be",
    "start": "948240",
    "end": "954720"
  },
  {
    "text": "protected with the new keys okay so you'll actually get accumulate several Keys over over time and um you know this",
    "start": "954720",
    "end": "961040"
  },
  {
    "text": "is actually then being protected uh with some local crypto so that if you steal the file that you know nobody will be",
    "start": "961040",
    "end": "967120"
  },
  {
    "text": "able to then have the keys so let's lose our keys okay so let's imagine you do in fact lose your keys so we'll delete this",
    "start": "967120",
    "end": "974480"
  },
  {
    "text": "file okay I'm going to shut down my web server uh where is my web server oh I'm",
    "start": "974480",
    "end": "980680"
  },
  {
    "text": "in the console okay I'm shutting it down because it had cached the key in memory",
    "start": "980680",
    "end": "985920"
  },
  {
    "text": "right so I want to reboot or active as if it's another server okay and I'll go back over here and now",
    "start": "985920",
    "end": "992279"
  },
  {
    "text": "try to unprotect okay and it is unable to unprotect the data because the key that",
    "start": "992279",
    "end": "998480"
  },
  {
    "text": "it was protected with is now gone okay so so so if you're seeing these",
    "start": "998480",
    "end": "1004399"
  },
  {
    "text": "exceptions in your lock files that's exactly the problem you're hitting that for some reason your servers are not",
    "start": "1004399",
    "end": "1009959"
  },
  {
    "text": "synchronized in terms of of of the keys yeah okay and it's that the worst day to figure out this problem is on production",
    "start": "1009959",
    "end": "1016800"
  },
  {
    "text": "uh on on on on on deployment day yeah okay so you you have to plan ahead for that uh just briefly this is the",
    "start": "1016800",
    "end": "1023120"
  },
  {
    "text": "interface uh that you could use again directly if you wanted to from your application uh and you create this",
    "start": "1023120",
    "end": "1028558"
  },
  {
    "text": "protector and the apis are dirt simple right protect unprotect you don't have to worry about crypto or key material",
    "start": "1028559",
    "end": "1035720"
  },
  {
    "text": "okay cool um yeah next one next one um where",
    "start": "1035720",
    "end": "1041480"
  },
  {
    "start": "1040000",
    "end": "1082000"
  },
  {
    "text": "is this used um cookies is probably the most common one that uh you know um antiy tokens um it's um it's used there",
    "start": "1041480",
    "end": "1049600"
  },
  {
    "text": "as well when when you're doing o and a and open connect there's this state parameter that needs to be protected",
    "start": "1049600",
    "end": "1055360"
  },
  {
    "text": "they're using it for that as well if you're doing razor Pages you might know the temp data attribute that's used here",
    "start": "1055360",
    "end": "1062000"
  },
  {
    "text": "as well and as Brock just showed you can use it yourself as well and it it's a very useful API when you want to you",
    "start": "1062000",
    "end": "1067200"
  },
  {
    "text": "know transport data from one page to another and you want to make sure nobody can change the data and so on yeah and",
    "start": "1067200",
    "end": "1072679"
  },
  {
    "text": "then you protect it and and send it over query string or whatever or a form post and then on the receiving end you",
    "start": "1072679",
    "end": "1077760"
  },
  {
    "text": "unprotect it again can can make sure nobody has tempered your data Okay cool",
    "start": "1077760",
    "end": "1083400"
  },
  {
    "start": "1082000",
    "end": "1211000"
  },
  {
    "text": "so once that base infrastructure is in place we can now move one level up um which is the authentication system and",
    "start": "1083400",
    "end": "1089360"
  },
  {
    "text": "that's probably the the biggest subsystem in in in in in in security terms um and you know you you've seen",
    "start": "1089360",
    "end": "1097520"
  },
  {
    "text": "that enum right authentication mode equals something yeah uh that we've come",
    "start": "1097520",
    "end": "1102799"
  },
  {
    "text": "a long way from that system to to here okay so first of all in in the old world",
    "start": "1102799",
    "end": "1108159"
  },
  {
    "text": "you could only Cho one authentication method at a time um where you know and that was pretty impractical so in a core",
    "start": "1108159",
    "end": "1116039"
  },
  {
    "text": "we have a completely revamped authentication system you can have as many authentication methods in at the",
    "start": "1116039",
    "end": "1121480"
  },
  {
    "text": "same time in your application they um you know uh support the most popular",
    "start": "1121480",
    "end": "1128240"
  },
  {
    "text": "social providers um like Google Facebook Twitter and so on um there are lots of",
    "start": "1128240",
    "end": "1135520"
  },
  {
    "text": "community projects out there which add support for the not so big social ones well they also big like you know Dropbox",
    "start": "1135520",
    "end": "1142240"
  },
  {
    "text": "and GitHub and Yahoo real big what was that again um and and other really",
    "start": "1142240",
    "end": "1148720"
  },
  {
    "text": "important servic like Battlenet for example untapped you know the the really important authentication systems of um",
    "start": "1148720",
    "end": "1154559"
  },
  {
    "text": "in the world um then we have support for all of the big standard space protocols open my",
    "start": "1154559",
    "end": "1161640"
  },
  {
    "text": "connect WS Federation they both come from Microsoft if you have to interact with saml yeah like governments and",
    "start": "1161640",
    "end": "1168080"
  },
  {
    "text": "Banks use a lot of seml there's um um an open source project from a guy called",
    "start": "1168080",
    "end": "1173919"
  },
  {
    "text": "Anders I I call him Mr saml yeah because whenever I have a saml question I ask him he he knows that stuff inside out",
    "start": "1173919",
    "end": "1180679"
  },
  {
    "text": "and if you want to use saml that's probably the best library to use for that um if you're doing API security you",
    "start": "1180679",
    "end": "1187760"
  },
  {
    "text": "need support for token based authentication so Chason web tokens is the most common thing to do here that's",
    "start": "1187760",
    "end": "1193240"
  },
  {
    "text": "built in as well and then uh when it comes to session management they have an",
    "start": "1193240",
    "end": "1199080"
  },
  {
    "text": "an API you know for for signing in users signing out users session management and",
    "start": "1199080",
    "end": "1204600"
  },
  {
    "text": "uh a default implementation which puts stuff into cookies but that is replaceable as we'll see um in a second",
    "start": "1204600",
    "end": "1210200"
  },
  {
    "text": "as well um yeah we can skip that part um",
    "start": "1210200",
    "end": "1215480"
  },
  {
    "start": "1211000",
    "end": "1266000"
  },
  {
    "text": "this here is how you interact with the authentication system um there's an interface which lives in the DI",
    "start": "1215480",
    "end": "1220640"
  },
  {
    "text": "container it's called the I authentication Service and there are five methods on it that deal with the five different things that you typically",
    "start": "1220640",
    "end": "1227559"
  },
  {
    "text": "do uh of all of course authenticating something right like validating a cookie",
    "start": "1227559",
    "end": "1232760"
  },
  {
    "text": "or validating a token you know these kind of things um session management yeah starting a session is called sign",
    "start": "1232760",
    "end": "1238400"
  },
  {
    "text": "in stopping a session is called sign out um telling the system that authentication is required meaning",
    "start": "1238400",
    "end": "1245400"
  },
  {
    "text": "either go to a Lo local login page go to a remote login page you know these kind of things telling the system that access",
    "start": "1245400",
    "end": "1252280"
  },
  {
    "text": "is denied which pretty much is a you know your last resort like I can't go from here ACC is denied show something",
    "start": "1252280",
    "end": "1258640"
  },
  {
    "text": "um page access denied I guess contact your administrator or something like",
    "start": "1258640",
    "end": "1264000"
  },
  {
    "text": "that um yeah um that's how you set it up yeah um",
    "start": "1264000",
    "end": "1270320"
  },
  {
    "start": "1266000",
    "end": "1322000"
  },
  {
    "text": "we we don't have to have to go into details here but basically you wire up these handlers in the DI container uh",
    "start": "1270320",
    "end": "1275799"
  },
  {
    "text": "and once they wired up there you can use this eye authentication Service to talk to them you never talk to them directly",
    "start": "1275799",
    "end": "1280880"
  },
  {
    "text": "because there is some coordination and orchestration necessary internally",
    "start": "1280880",
    "end": "1285960"
  },
  {
    "text": "that's why you have to go through that abstraction called the I authentication Service uh another thing I should just",
    "start": "1285960",
    "end": "1291919"
  },
  {
    "text": "briefly mention they have build-in support for same side cookies which is a new feature in browsers um which is very",
    "start": "1291919",
    "end": "1298080"
  },
  {
    "text": "useful for making your cookies more secure read up on that if you care about these things but the the the main point",
    "start": "1298080",
    "end": "1304720"
  },
  {
    "text": "here is uh you get same side by default now because all of the cookies are now",
    "start": "1304720",
    "end": "1310720"
  },
  {
    "text": "um set to same side lags which is um you know not the most secure securest",
    "start": "1310720",
    "end": "1317640"
  },
  {
    "text": "setting but the most compatible setting and gives you some good extra",
    "start": "1317640",
    "end": "1322720"
  },
  {
    "start": "1322000",
    "end": "1392000"
  },
  {
    "text": "security um session management is interesting right you want to log in a user to your system and and sign him out",
    "start": "1322720",
    "end": "1328960"
  },
  {
    "text": "again um that's how you do that basically you call the signin method um on this authentication Service um it's",
    "start": "1328960",
    "end": "1335440"
  },
  {
    "text": "all based on claims now right so that's how you model the identity of the user by basically creating some claims like",
    "start": "1335440",
    "end": "1341640"
  },
  {
    "text": "name and uh subject ID and first name email address whatever you want to model",
    "start": "1341640",
    "end": "1347080"
  },
  {
    "text": "basically and then you you pass that claims principle to the session Handler and it will basically serialize it into",
    "start": "1347080",
    "end": "1353679"
  },
  {
    "text": "a data structure typically a cookie yeah um they also have support for metadata",
    "start": "1353679",
    "end": "1359039"
  },
  {
    "text": "in in the session don't confuse that with their session feature it's it's a",
    "start": "1359039",
    "end": "1364559"
  },
  {
    "text": "same name I guess but it's more for like um security related information something you want to hard couple with",
    "start": "1364559",
    "end": "1371960"
  },
  {
    "text": "the login of a user so maybe you you have some access token that you want to use to call an API on behalf of that",
    "start": "1371960",
    "end": "1378559"
  },
  {
    "text": "user and that should be associated with that user so yeah it's maybe a um an",
    "start": "1378559",
    "end": "1384400"
  },
  {
    "text": "option at least to to to store it inside of the authentication session of the user so it you know they belong together",
    "start": "1384400",
    "end": "1389880"
  },
  {
    "text": "so to speak yeah okay um and I'm going to show you a",
    "start": "1389880",
    "end": "1394960"
  },
  {
    "start": "1392000",
    "end": "1484000"
  },
  {
    "text": "demo in a second that brings all of these things together like like a bigger demo or Brock will show it",
    "start": "1394960",
    "end": "1400480"
  },
  {
    "text": "um there there are many things you can do to ma to to customize the session management as well so for example there",
    "start": "1400480",
    "end": "1407320"
  },
  {
    "text": "are uh events that that get that get invoked like for example whenever a cookie comes into your system gives you",
    "start": "1407320",
    "end": "1412520"
  },
  {
    "text": "a chance to run some code and say like okay this cookie is valid but is this user still valid in the database or is",
    "start": "1412520",
    "end": "1417640"
  },
  {
    "text": "it has it been disabled in the meantime for example do I need to invalidate that cookie for example it gives you access",
    "start": "1417640",
    "end": "1424880"
  },
  {
    "text": "to the sign out uh workflow so if at sign out time you want to clean up data for example delete cash entries whatever",
    "start": "1424880",
    "end": "1432919"
  },
  {
    "text": "that that that can be done um the the the the actual implementation of the",
    "start": "1432919",
    "end": "1438600"
  },
  {
    "text": "session mechanism is also plugable by default Microsoft just stores everything",
    "start": "1438600",
    "end": "1443880"
  },
  {
    "text": "in in the cookie that's probably not the best idea especially when you start making use of that feature because",
    "start": "1443880",
    "end": "1449279"
  },
  {
    "text": "cookies have certain size restrictions right especially um when you use",
    "start": "1449279",
    "end": "1454919"
  },
  {
    "text": "browsers like Safari you know they they have very tight uh limits on on cookie",
    "start": "1454919",
    "end": "1460080"
  },
  {
    "text": "sizes but the point is you can plug in other persistence mechanisms like a database or a cache you know um so the",
    "start": "1460080",
    "end": "1468159"
  },
  {
    "text": "the the cookies stay small and you also get this um revocation feature so you know all you need to do is to invalidate",
    "start": "1468159",
    "end": "1474600"
  },
  {
    "text": "a cookie or or a session rather is to delete it from a from a cache and then the user is signed out you know nice",
    "start": "1474600",
    "end": "1481240"
  },
  {
    "text": "nice uh clean uh feature okay external",
    "start": "1481240",
    "end": "1486360"
  },
  {
    "start": "1484000",
    "end": "1515000"
  },
  {
    "text": "authentication means that we don't do our own authentication but use some external provider for that like Google",
    "start": "1486360",
    "end": "1492080"
  },
  {
    "text": "or you know Sr or what what have you um they have built in support for as well",
    "start": "1492080",
    "end": "1499039"
  },
  {
    "text": "of course yeah um it's it's called a remote authentication Handler and they know basically how to send the user to",
    "start": "1499039",
    "end": "1505120"
  },
  {
    "text": "this external system and they know how to process whatever comes back from from from that external system to validate",
    "start": "1505120",
    "end": "1511799"
  },
  {
    "text": "who the user is know um we'll see we'll see that in a",
    "start": "1511799",
    "end": "1517760"
  },
  {
    "start": "1515000",
    "end": "1565000"
  },
  {
    "text": "second and the last point about API of about authenication is apis right so if",
    "start": "1517760",
    "end": "1524440"
  },
  {
    "text": "you want to secure apis they also have a Handler for that it's called the Jason web token Handler and that the job of",
    "start": "1524440",
    "end": "1530399"
  },
  {
    "text": "this Handler is to you know look at incoming requests validate the tokens and and uh you know turn them into",
    "start": "1530399",
    "end": "1537240"
  },
  {
    "text": "claims um one thing is missing if you care about these things there's a spec",
    "start": "1537240",
    "end": "1543080"
  },
  {
    "text": "called RFC 7622 which is token introspection meaning uh it's not a",
    "start": "1543080",
    "end": "1548640"
  },
  {
    "text": "Chason Z token it's some other token type and there's an endpoint on the network that can validate it instead of",
    "start": "1548640",
    "end": "1554200"
  },
  {
    "text": "yourself um we provided that Handler um it's it's on Hub so if you need that you",
    "start": "1554200",
    "end": "1560120"
  },
  {
    "text": "can plug that in as a replacement for this this also works very well so we have one um demo that brings all of",
    "start": "1560120",
    "end": "1566919"
  },
  {
    "start": "1565000",
    "end": "1981000"
  },
  {
    "text": "these things together um you know it's a lot of information but as I said um it's it's uh basically for for giving you an",
    "start": "1566919",
    "end": "1573559"
  },
  {
    "text": "overview but but this um this uh sample here basically takes all of the things I",
    "start": "1573559",
    "end": "1580480"
  },
  {
    "text": "just talked about and uh turns them into you know one one coherent thing yeah",
    "start": "1580480",
    "end": "1586520"
  },
  {
    "text": "what we have here is uh an MVC application and the idea is that this MVC application is going to uh log a",
    "start": "1586520",
    "end": "1593600"
  },
  {
    "text": "user in and it's going to use an external authentication system using open ID connect uh once we get back the",
    "start": "1593600",
    "end": "1599640"
  },
  {
    "text": "authenticated user we will you know establish a local session with the cookie and then this application wants",
    "start": "1599640",
    "end": "1605919"
  },
  {
    "text": "to call a web API on behalf of that user so we have another project over here which is running a web API uh so over",
    "start": "1605919",
    "end": "1614000"
  },
  {
    "text": "here this separate API project is also of of course wanting to authenticate calls so it does token based",
    "start": "1614000",
    "end": "1620279"
  },
  {
    "text": "authentication expecting a u Json web token okay so this API project let me",
    "start": "1620279",
    "end": "1626200"
  },
  {
    "text": "run that just to get it up and running okay uh we now have our um um excuse me",
    "start": "1626200",
    "end": "1633159"
  },
  {
    "text": "so over here in this application um we're going to be wiring open up open ID connect um there's another important",
    "start": "1633159",
    "end": "1640720"
  },
  {
    "text": "part of this is when an application is calling web apis you have this token and this lifetime management uh that you",
    "start": "1640720",
    "end": "1647760"
  },
  {
    "text": "have to deal with with this token uh so we have a nice little sample here that's going to going to help that so let me just run this to get logged in first and",
    "start": "1647760",
    "end": "1654399"
  },
  {
    "text": "show you first what we get back and then we'll deal with uh calling our API so here's the MVC app um I'll trigger my",
    "start": "1654399",
    "end": "1661320"
  },
  {
    "text": "secure page this just has a you know an authorized attribute uh on the application actually let me show that as",
    "start": "1661320",
    "end": "1667760"
  },
  {
    "text": "well uh I think up here we have a uh Global authorize uh we'll talk more about that when we talk about the policy",
    "start": "1667760",
    "end": "1674080"
  },
  {
    "text": "system but the entire application uh requires an authenticated user so what we've done now is redirected up to some",
    "start": "1674080",
    "end": "1681039"
  },
  {
    "text": "centralized identity system somewhere uh and I'll log in with a user called Bob that I have up here right we get a",
    "start": "1681039",
    "end": "1688240"
  },
  {
    "text": "consent screen this is basically you know hey yeah this is all the information that we're about to send back to the application including uh",
    "start": "1688240",
    "end": "1694960"
  },
  {
    "text": "access to this API so when we come back we'll come into this application and we've now authenticated from the",
    "start": "1694960",
    "end": "1701880"
  },
  {
    "text": "external system we have claims coming back from that external system and these have been issued into our cookie okay",
    "start": "1701880",
    "end": "1708600"
  },
  {
    "text": "the other thing that's in the cookie as Dominic mentioned is metadata and this metadata is a place where all this other",
    "start": "1708600",
    "end": "1714760"
  },
  {
    "text": "information is stored one of the things that is stored in here is uh are the tokens coming back from the token server",
    "start": "1714760",
    "end": "1721279"
  },
  {
    "text": "so we have an access token and this is what we're going to send to the web API um this ID token is the the token that",
    "start": "1721279",
    "end": "1727960"
  },
  {
    "text": "authenticated Us in the first place uh and we also have this thing called a refresh token and that's for using uh to",
    "start": "1727960",
    "end": "1734240"
  },
  {
    "text": "go get new access tokens uh when this access token expires okay um so right now what we have is a",
    "start": "1734240",
    "end": "1741720"
  },
  {
    "text": "button here where we can call the API um so actually I think that's already in place uh we can call that and this is",
    "start": "1741720",
    "end": "1748480"
  },
  {
    "text": "taking that access token sending it to our API endpoint and that was successful",
    "start": "1748480",
    "end": "1754159"
  },
  {
    "text": "okay so um that's great we now have authenticated the user external",
    "start": "1754159",
    "end": "1759360"
  },
  {
    "text": "authentication tracking with a session using the authenication system in aspet core you know calling that API uh the",
    "start": "1759360",
    "end": "1766159"
  },
  {
    "text": "last little interesting thing here then is this uh token management so again I mentioned the token is going to expire",
    "start": "1766159",
    "end": "1772600"
  },
  {
    "text": "at some point and we use a refresh token to renew that that code is um a little",
    "start": "1772600",
    "end": "1777880"
  },
  {
    "text": "bit tedious and you don't want that you know mixing into your application code um so we've come up with an interesting",
    "start": "1777880",
    "end": "1784120"
  },
  {
    "text": "little technique uh which Taps into the cookie events Dominic mentioned that there's an Eventing system uh off of the",
    "start": "1784120",
    "end": "1791039"
  },
  {
    "text": "cookie Handler and so uh what we have here is uh a class that will Implement",
    "start": "1791039",
    "end": "1798519"
  },
  {
    "text": "these events for the cookies uh and there are some virtual methods that that you can uh Implement one of them is",
    "start": "1798519",
    "end": "1804320"
  },
  {
    "text": "validate principle so this is invoked every time the cookie comes into the application after the cookie has been",
    "start": "1804320",
    "end": "1811000"
  },
  {
    "text": "validated by the by the built-in cookie Handler then you get a chance to take a look at it and so what we're doing here",
    "start": "1811000",
    "end": "1817720"
  },
  {
    "text": "is we're not using it to check to see if the user is still active we're actually leveraging this to get the token our",
    "start": "1817720",
    "end": "1824720"
  },
  {
    "text": "access token for the API um we are checking the expiration on it right when",
    "start": "1824720",
    "end": "1830320"
  },
  {
    "text": "you get the tokens back you know how long uh it will uh be valid for and we're checking to see if we're within",
    "start": "1830320",
    "end": "1837000"
  },
  {
    "text": "some threshold so the token you get back is good for about an hour so what we'll do is we'll use it for 58 or 59 minutes",
    "start": "1837000",
    "end": "1845120"
  },
  {
    "text": "and then oh it's about to expire so what we'll do then is we will connect back to",
    "start": "1845120",
    "end": "1852279"
  },
  {
    "text": "the Token server and use the refresh token get a brand new access token",
    "start": "1852279",
    "end": "1858240"
  },
  {
    "text": "uh and then we'll update our cookie metadata with the latest token so what's nice about this is It's a sort of a",
    "start": "1858240",
    "end": "1864760"
  },
  {
    "text": "seamless way to add into your project a way to automatically refresh the token",
    "start": "1864760",
    "end": "1869840"
  },
  {
    "text": "without this being in your API code right when you call the API um so I think our tokens are good",
    "start": "1869840",
    "end": "1875840"
  },
  {
    "text": "for what one minute or something 70 seconds 70 seconds okay so I've been sitting here talking for more than 70",
    "start": "1875840",
    "end": "1881679"
  },
  {
    "text": "seconds so this is the current access token and this is the refresh token we have so I'm going to hit refresh and",
    "start": "1881679",
    "end": "1888039"
  },
  {
    "text": "what's going to happen is the cookie is going to come back in with these tokens we're going to see that the token expiration is past our threshold so this",
    "start": "1888039",
    "end": "1895960"
  },
  {
    "text": "should just automatically uh refresh this so if I hit refresh yeah notice it",
    "start": "1895960",
    "end": "1901200"
  },
  {
    "text": "changed okay so it's a nice little easy way to to put this in the pipeline if I hit refresh now yeah it's I'm still not",
    "start": "1901200",
    "end": "1908679"
  },
  {
    "text": "within my threshold so in 50 more seconds it will it will do another renewal can you also show the code how",
    "start": "1908679",
    "end": "1913840"
  },
  {
    "text": "you call the API oh yes just to show that this is really free of all of these details yet right",
    "start": "1913840",
    "end": "1920720"
  },
  {
    "text": "so when you call the API right you need the token so there's a helper provided to read the access token out of the",
    "start": "1920720",
    "end": "1927519"
  },
  {
    "text": "metadata in the cookie um we are getting a uh HTTP client to connect to the web",
    "start": "1927519",
    "end": "1933919"
  },
  {
    "text": "API we can use this little helper method to set the access token as the authorization header right using the",
    "start": "1933919",
    "end": "1940480"
  },
  {
    "text": "bearer scheme and we just call the API so the point is this is pretty uh simple",
    "start": "1940480",
    "end": "1945960"
  },
  {
    "text": "code with calling the API and not worrying about token management okay uh",
    "start": "1945960",
    "end": "1951480"
  },
  {
    "text": "one more thing is that uh at sign out time as well um that's another event",
    "start": "1951480",
    "end": "1956559"
  },
  {
    "text": "that you can handle on the cookie events which is hey the user signing out so the kind of the good proper cleanup uh is to",
    "start": "1956559",
    "end": "1963679"
  },
  {
    "text": "go and uh get your refresh token and if I go down here far enough we will revoke",
    "start": "1963679",
    "end": "1969440"
  },
  {
    "text": "it okay the user signed out that means the refresh token should no longer be valid so we're you know cleaning up the",
    "start": "1969440",
    "end": "1975559"
  },
  {
    "text": "tokens at the token server okay good all",
    "start": "1975559",
    "end": "1981919"
  },
  {
    "start": "1981000",
    "end": "2165000"
  },
  {
    "text": "right okay so that's authentication authorization is another huge topic yeah",
    "start": "1981919",
    "end": "1987279"
  },
  {
    "text": "that we could talk for days I guess about it um so authorization Microsoft",
    "start": "1987279",
    "end": "1993200"
  },
  {
    "text": "rewrote the authorization system well actually there was not much to rewrite to be honest because the older versions",
    "start": "1993200",
    "end": "1998519"
  },
  {
    "text": "didn't have a lot yeah um but in a core they have a new authorization system",
    "start": "1998519",
    "end": "2004360"
  },
  {
    "text": "it's actually two systems even if they are internally the same but there are two flavors if you like how to use them",
    "start": "2004360",
    "end": "2010840"
  },
  {
    "text": "one is called policy based authorization and the idea is that is the replacement for the old authorized attribute right",
    "start": "2010840",
    "end": "2017080"
  },
  {
    "text": "um authorized there was this authorized attribute where people used it to to either like roles equal something right",
    "start": "2017080",
    "end": "2023760"
  },
  {
    "text": "so to to enforce certain role memberships and since we all know that roles are not very useful or you know",
    "start": "2023760",
    "end": "2030159"
  },
  {
    "text": "not don't go far enough what many people did was they wrote their own authorized attribute right um to be honest with you",
    "start": "2030159",
    "end": "2036840"
  },
  {
    "text": "I've I I've done a number of code reviews where people wrote their own authorized attributes and they did it",
    "start": "2036840",
    "end": "2042000"
  },
  {
    "text": "wrong because you have to derive from a base class you have to be aware of what the base class is doing to call the base",
    "start": "2042000",
    "end": "2047360"
  },
  {
    "text": "first or the after you know and if you get that wrong you get subtle security holes in your authorization system so",
    "start": "2047360",
    "end": "2054200"
  },
  {
    "text": "Microsoft basically uh uh um removed that feature you can't write your own authorized",
    "start": "2054200",
    "end": "2060280"
  },
  {
    "text": "attribute anymore okay what you're doing instead is you're creating so-called policies and policies can be invoked",
    "start": "2060280",
    "end": "2068200"
  },
  {
    "text": "from the authorized attribute um and you are and the policy system is completely",
    "start": "2068200",
    "end": "2073520"
  },
  {
    "text": "extensible but you can't ex replace the authorized attribute anymore okay and",
    "start": "2073520",
    "end": "2079440"
  },
  {
    "text": "the whole point of the policy system is that you basically can look at the incoming request check the properties of",
    "start": "2079440",
    "end": "2085358"
  },
  {
    "text": "the user and if he fulfills certain requirements you allow him through otherwise you access deny yeah there's",
    "start": "2085359",
    "end": "2092720"
  },
  {
    "text": "another system called resource-based authorization where in addition you can also have a look at the source that this",
    "start": "2092720",
    "end": "2098640"
  },
  {
    "text": "user is trying to manipulate like updating a customer or deleting an invoice you know these kind of things",
    "start": "2098640",
    "end": "2103960"
  },
  {
    "text": "yeah um it's all di based again so it it's",
    "start": "2103960",
    "end": "2109839"
  },
  {
    "text": "it's it's actually testable now which wasn't possible with the old system and that's a good thing for security",
    "start": "2109839",
    "end": "2116359"
  },
  {
    "text": "um actually if you want to learn more about that there's a really good Learning Resource um from the guy that",
    "start": "2116359",
    "end": "2122720"
  },
  {
    "text": "actually is responsible for the authorization API at Microsoft his name is Barry you might know him from Twitter",
    "start": "2122720",
    "end": "2129520"
  },
  {
    "text": "he's swearing a lot um and he wrote like like a um like a Hands-On Workshop so to",
    "start": "2129520",
    "end": "2137040"
  },
  {
    "text": "speak how to learn the different you know uh aspect of the authorization system um in in in the next version of a",
    "start": "2137040",
    "end": "2144480"
  },
  {
    "text": "cord is will be available as middleware as well right now it's pretty much only used by MVC yeah the the authorization",
    "start": "2144480",
    "end": "2150920"
  },
  {
    "text": "API but since um since uh they they want to open more scenarios in the next",
    "start": "2150920",
    "end": "2156119"
  },
  {
    "text": "version like for microservices and rooting outside of MVC it's going to be a you know like an authorization",
    "start": "2156119",
    "end": "2162160"
  },
  {
    "text": "middleware will be available as well okay um do you want to show just the",
    "start": "2162160",
    "end": "2168040"
  },
  {
    "start": "2165000",
    "end": "2358000"
  },
  {
    "text": "demo of the point system probably more more exciting than slides okay so this",
    "start": "2168040",
    "end": "2173599"
  },
  {
    "text": "is another sample we have for showing the authorization system uh what I have is I'm simply logging in a user first of",
    "start": "2173599",
    "end": "2180720"
  },
  {
    "text": "all right you have to authenticate someone before you can authorize them uh just to show you who our users are I",
    "start": "2180720",
    "end": "2186440"
  },
  {
    "text": "have just a hardcoded list and let's say we have Alice and Bob and so Alice is uh in the sales department and she's a",
    "start": "2186440",
    "end": "2193040"
  },
  {
    "text": "senior you know executive in the sales department so that's all well and good and the idea is that in your application",
    "start": "2193040",
    "end": "2199480"
  },
  {
    "text": "you're going to want various uh authorizations so the way you set up using policies is we add the",
    "start": "2199480",
    "end": "2205680"
  },
  {
    "text": "authorization system into the DI and this provides add policy methods this is",
    "start": "2205680",
    "end": "2211359"
  },
  {
    "text": "where you create a named policy which then has the requirements that a user",
    "start": "2211359",
    "end": "2216839"
  },
  {
    "text": "must satisfy so think of it as kind of like a permission right it's the name of something and I'm expecting this about",
    "start": "2216839",
    "end": "2223520"
  },
  {
    "text": "the user so the way these policies work is that they are looking at the in this case the claims on the the user okay",
    "start": "2223520",
    "end": "2231400"
  },
  {
    "text": "these are very simple so an example uh it's a saleson sort of permission you must be in the sales department you must",
    "start": "2231400",
    "end": "2237119"
  },
  {
    "text": "be a senior salesperson well you need to be in the sales department and level senior so these are are both must be",
    "start": "2237119",
    "end": "2243880"
  },
  {
    "text": "satisfied for the policy to succeed um and and then over here on my test controller I have various attributes uh",
    "start": "2243880",
    "end": "2253000"
  },
  {
    "text": "that's the same authorized attribute but now when you pass in a string you're indicating the name of the policy okay",
    "start": "2253000",
    "end": "2259720"
  },
  {
    "text": "so you can do these declaratively using the attribute uh also as Dominic mentioned the authorization service is",
    "start": "2259720",
    "end": "2266240"
  },
  {
    "text": "in the DI system so you can resolve it from the DI system uh and invoke this",
    "start": "2266240",
    "end": "2271720"
  },
  {
    "text": "programmatically right so you can invoke it uh you know within your method to uh you know enforce this this is also a",
    "start": "2271720",
    "end": "2278680"
  },
  {
    "text": "good way to invoke a policy to um update your UI and like hide and show menus and",
    "start": "2278680",
    "end": "2286359"
  },
  {
    "text": "buttons If the user is not even allowed don't show them the button for example okay so I can just run this quick and I",
    "start": "2286359",
    "end": "2294280"
  },
  {
    "text": "have something else running I think I'm going to have to",
    "start": "2294280",
    "end": "2300400"
  },
  {
    "text": "close this oh lucky okay Alice Alice great so so I'm",
    "start": "2300400",
    "end": "2307640"
  },
  {
    "text": "logged in as Alice and we have our our claims okay so now when I go and invoke",
    "start": "2307640",
    "end": "2313079"
  },
  {
    "text": "that sales only because Alice is in the sales department you know that succeeds of course uh senior sales right she has",
    "start": "2313079",
    "end": "2321079"
  },
  {
    "text": "those two claims so that one works that's a different policy but I have another one uh which I didn't show you",
    "start": "2321079",
    "end": "2326319"
  },
  {
    "text": "but it uh I think it's requiring that you only be an intern for example so you're only in the The Intern uh status",
    "start": "2326319",
    "end": "2333720"
  },
  {
    "text": "in in that particular department so that one should fail okay and so what's happening under the covers is that the",
    "start": "2333720",
    "end": "2340800"
  },
  {
    "text": "authorized attribute here was calling the challenge or the the you know forbid",
    "start": "2340800",
    "end": "2346960"
  },
  {
    "text": "methods right and the forbid is sending us to the access denied page um if you're doing it imperatively then it's",
    "start": "2346960",
    "end": "2353119"
  },
  {
    "text": "up to you to call forbid if that's what you want or something else custom okay good um yeah and just go",
    "start": "2353119",
    "end": "2362119"
  },
  {
    "text": "back please to the startup yeah um so what what this kind of gives you the impression is now that that um for for",
    "start": "2362119",
    "end": "2369040"
  },
  {
    "text": "being able to use that authorization system you need everything as a claim okay which is wrong yeah just just",
    "start": "2369040",
    "end": "2375119"
  },
  {
    "text": "because you have this shiny new Hammer not everything becomes a nail now um so",
    "start": "2375119",
    "end": "2380920"
  },
  {
    "text": "um but Microsoft provides a couple of pre-build requirements and they are",
    "start": "2380920",
    "end": "2386280"
  },
  {
    "text": "based on claims basically but um you can extend that system so when you scroll down here you see that there's a custom",
    "start": "2386280",
    "end": "2393920"
  },
  {
    "text": "policy yeah and what this basically this policy models is you're only allowed in",
    "start": "2393920",
    "end": "2399000"
  },
  {
    "text": "if you have a top level of manager or I don't know whatever yeah um so what this",
    "start": "2399000",
    "end": "2406400"
  },
  {
    "text": "really is this this method here is just an extension method on this authorization policy Builder that under",
    "start": "2406400",
    "end": "2411560"
  },
  {
    "text": "the covers adds a new requirement to the collection and when you when we look at the requirement you see it's just a",
    "start": "2411560",
    "end": "2418000"
  },
  {
    "text": "class that models your your domain yeah in that case it models a job level so to",
    "start": "2418000",
    "end": "2423680"
  },
  {
    "text": "speak yeah and whenever uh a a policy gets invogue that contains this",
    "start": "2423680",
    "end": "2429240"
  },
  {
    "text": "requirement at runtime they will look for a a Handler that can deal with this",
    "start": "2429240",
    "end": "2434720"
  },
  {
    "text": "requirement which is in our case the job level requirement Handler okay and then they invoke the handle requirement",
    "start": "2434720",
    "end": "2441440"
  },
  {
    "text": "method and then you can write whatever code you want to to to to to check if the user is fulfilling the requirement",
    "start": "2441440",
    "end": "2448119"
  },
  {
    "text": "yeah um and if you're happy you call context. succeed on that which means",
    "start": "2448119",
    "end": "2453200"
  },
  {
    "text": "your requirement succeeded and if all requirements in a policy agree on success the policy is a success okay a",
    "start": "2453200",
    "end": "2461000"
  },
  {
    "text": "very deliberate thing here is these handlers live in the DI container okay which means in other words that they can",
    "start": "2461000",
    "end": "2467640"
  },
  {
    "text": "take other dependencies on other things that also live in the DI container yeah so instead of uh basically modeling",
    "start": "2467640",
    "end": "2473880"
  },
  {
    "text": "every everything as a claim you see this this thing is just calling an i organization service that might go to a",
    "start": "2473880",
    "end": "2479079"
  },
  {
    "text": "database or might might call an API can be you know mocked for testing purposes and so on so don't be confused that um",
    "start": "2479079",
    "end": "2488800"
  },
  {
    "text": "you're not having to model everything now as claims just to use the authorization system because that would be wrong yeah claims are for are good",
    "start": "2488800",
    "end": "2495079"
  },
  {
    "text": "for modeling identity data they are not very good for modeling permissions okay",
    "start": "2495079",
    "end": "2500880"
  },
  {
    "text": "yeah okay um yeah go on go on go on um",
    "start": "2500880",
    "end": "2506480"
  },
  {
    "text": "the the other part that we don't going to show you because it's just not time for that is it's called resource-based",
    "start": "2506480",
    "end": "2512359"
  },
  {
    "text": "authorization as I said um instead of just looking at the incoming subject um you can can also add uh the notion of an",
    "start": "2512359",
    "end": "2518720"
  },
  {
    "text": "operation to it like uh read write whatever uh and and the resource that",
    "start": "2518720",
    "end": "2524880"
  },
  {
    "text": "this operation will try to manipulate and this way you know you can um write",
    "start": "2524880",
    "end": "2532920"
  },
  {
    "text": "basically these handlers that take a a third parameter that is the actual resource that is being manipulated and",
    "start": "2532920",
    "end": "2540800"
  },
  {
    "text": "um then you can basically Implement your authorization logic there and you can see how to invoke that basically by",
    "start": "2540800",
    "end": "2547240"
  },
  {
    "text": "calling this method here you pass in the actual object that is being manipulated",
    "start": "2547240",
    "end": "2552400"
  },
  {
    "text": "you pass in the operation that you are about to do and the user and then this custom code can you know determine if",
    "start": "2552400",
    "end": "2559280"
  },
  {
    "text": "that's allowed or not um it's a framework for Microsoft that",
    "start": "2559280",
    "end": "2564920"
  },
  {
    "text": "you have to buy into and you know um as every framework you have to figure out",
    "start": "2564920",
    "end": "2570240"
  },
  {
    "text": "is this what I want or is it more work to just make the framework happy um than",
    "start": "2570240",
    "end": "2576599"
  },
  {
    "text": "than then than building my own so you know um that's that that's just something uh that that we learned from a",
    "start": "2576599",
    "end": "2582559"
  },
  {
    "text": "couple of projects that some people didn't like that too much because it was a lot",
    "start": "2582559",
    "end": "2588040"
  },
  {
    "text": "of ceremony ceremony yeah but the policy stuff I think is really brilliant and",
    "start": "2588040",
    "end": "2594559"
  },
  {
    "text": "it's it's it's super easy to use yeah okay you want to talk about this oh sure",
    "start": "2594559",
    "end": "2599839"
  },
  {
    "start": "2597000",
    "end": "2780000"
  },
  {
    "text": "so uh another important component in the uh ASP net core security uh system is a",
    "start": "2599839",
    "end": "2606520"
  },
  {
    "text": "way to track your users in your database okay so that's what asp.net identity is",
    "start": "2606520",
    "end": "2612359"
  },
  {
    "text": "aspnet identity is a framework or a library um that provides you a lot of The Primitives to um do what's necessary",
    "start": "2612359",
    "end": "2619640"
  },
  {
    "text": "to properly manage user accounts and a lot of that involves passwords right uh",
    "start": "2619640",
    "end": "2624760"
  },
  {
    "text": "having a password when somebody uh when you store the password you have to do hashing on it the right way um when",
    "start": "2624760",
    "end": "2630720"
  },
  {
    "text": "somebody comes in and tries to validate you know on a login page validate their password you need to check that um you",
    "start": "2630720",
    "end": "2636400"
  },
  {
    "text": "need to worry about things like Brute Force attacks right if you've ever written your own login page in your own",
    "start": "2636400",
    "end": "2641680"
  },
  {
    "text": "database for your users you know are you counting how many failures you're getting for every failed login so they",
    "start": "2641680",
    "end": "2648240"
  },
  {
    "text": "do a lot of important things like that in addition right you have to worry about things like password reset and how",
    "start": "2648240",
    "end": "2653640"
  },
  {
    "text": "do you do that securely well you need email verification and so there's a whole email verification component to",
    "start": "2653640",
    "end": "2659000"
  },
  {
    "text": "this and that's hard to do um right so it's a really good starting point for building out your identity system uh",
    "start": "2659000",
    "end": "2665880"
  },
  {
    "text": "some other features that they have also is related to multiactor authentication and they support things like SMS and",
    "start": "2665880",
    "end": "2671800"
  },
  {
    "text": "authenticator apps and it's extensible so you could put in your other type of authenticator systems uh as well um",
    "start": "2671800",
    "end": "2679839"
  },
  {
    "text": "lastly not every user will have a password right if you're doing external authentication against a Google you know",
    "start": "2679839",
    "end": "2685040"
  },
  {
    "text": "Google logins that user doesn't have a password but you still need to track that user in your system so um it also",
    "start": "2685040",
    "end": "2691680"
  },
  {
    "text": "has the notion of having a record for your user but linking it to the external provider okay so most of the data stored",
    "start": "2691680",
    "end": "2698240"
  },
  {
    "text": "in the database is predominantly around authentication for your user um but you could extend this and put other custom",
    "start": "2698240",
    "end": "2704680"
  },
  {
    "text": "data as well I pref my preference is to put as little business data into this",
    "start": "2704680",
    "end": "2710400"
  },
  {
    "text": "database just keep it purely about the authentication properties you know email",
    "start": "2710400",
    "end": "2715760"
  },
  {
    "text": "um things like that you know for uh telephone number yeah telephone number for the multiactor things like that um",
    "start": "2715760",
    "end": "2721680"
  },
  {
    "text": "or the you're link from a Google account and then the rest of the data put in your business database at least that's",
    "start": "2721680",
    "end": "2727079"
  },
  {
    "text": "my preference for style um the other thing that this then provides is so we",
    "start": "2727079",
    "end": "2732559"
  },
  {
    "text": "talked about cookies for establishing your session and this library is the database well there's a little bit of",
    "start": "2732559",
    "end": "2738839"
  },
  {
    "text": "glue missing in the middle so they have a little bit additional helpers called the signin manager um and that's",
    "start": "2738839",
    "end": "2744480"
  },
  {
    "text": "basically a component that uh will allow you to on your login page receive the password it'll go do the checks in the",
    "start": "2744480",
    "end": "2751520"
  },
  {
    "text": "database come back and issue the cookie to establish the session so it can be",
    "start": "2751520",
    "end": "2757160"
  },
  {
    "text": "very blurry right where cookies are and where the database is and this thing in the middle um but again the code is is",
    "start": "2757160",
    "end": "2764160"
  },
  {
    "text": "up there on GitHub you can look at it I frequently have to look at it to remember whose job is it to issue the",
    "start": "2764160",
    "end": "2769839"
  },
  {
    "text": "cookie and whose job is it to check the password but you know it's open source so you can have a look at it that's",
    "start": "2769839",
    "end": "2775359"
  },
  {
    "text": "encouraging oh well okay all right good so the last",
    "start": "2775359",
    "end": "2782119"
  },
  {
    "start": "2780000",
    "end": "2973000"
  },
  {
    "text": "thing is um that's the only thing that's really new so um you probably haven't",
    "start": "2782119",
    "end": "2787680"
  },
  {
    "text": "seen that yet um we have barely seen it to be honest um but I told you at the",
    "start": "2787680",
    "end": "2794319"
  },
  {
    "text": "beginning that that we are working on this thing called identity server which adds some missing features to a minut core so Microsoft implemented all of the",
    "start": "2794319",
    "end": "2801359"
  },
  {
    "text": "things that you need to have for for consuming tokens yeah like the op connect Handler and the Jason web token",
    "start": "2801359",
    "end": "2807119"
  },
  {
    "text": "Handler but they were always missing a good a good feature or a good mechanism",
    "start": "2807119",
    "end": "2813680"
  },
  {
    "text": "to issue these tokens okay they they had several tries that they they tried to solve the problem themselves and it it",
    "start": "2813680",
    "end": "2820559"
  },
  {
    "text": "got um they they didn't maintain it in the end because they thought like yeah it's it's actually hard to do it the",
    "start": "2820559",
    "end": "2827319"
  },
  {
    "text": "right way so um um so on one hand we had this thing called identity server on on",
    "start": "2827319",
    "end": "2833680"
  },
  {
    "text": "the other hand they had their own identity management Library yeah um and",
    "start": "2833680",
    "end": "2839640"
  },
  {
    "text": "kind of they they approached us well many years ago and whatever the long story but uh the short story is um that",
    "start": "2839640",
    "end": "2847079"
  },
  {
    "text": "Microsoft now finally for the next version ships a little bit of clue that",
    "start": "2847079",
    "end": "2853000"
  },
  {
    "text": "pulls in our identity server that pulls in their identity management library that Brock just mentioned and under the",
    "start": "2853000",
    "end": "2859119"
  },
  {
    "text": "covers makes them work together without you having to know all the details okay they call it zero config yeah and that's",
    "start": "2859119",
    "end": "2866119"
  },
  {
    "text": "um as we all know zero config is not a reality at least not in reality yeah but",
    "start": "2866119",
    "end": "2872240"
  },
  {
    "text": "it's a good starting point Yeah so basically the the idea the the the the experience will be that there will be",
    "start": "2872240",
    "end": "2878240"
  },
  {
    "text": "templates in Visual Studio you say they file new uh tokens secured spa or something like",
    "start": "2878240",
    "end": "2886800"
  },
  {
    "text": "this yeah um and then you will get you will get the the the spa they actually",
    "start": "2886800",
    "end": "2892520"
  },
  {
    "text": "working on um uh an angular and a react version of that uh you will get the spa",
    "start": "2892520",
    "end": "2897559"
  },
  {
    "text": "you will get your API and you will get your identity server in just one one project uh they will set up everything",
    "start": "2897559",
    "end": "2903800"
  },
  {
    "text": "in uh so that basically you can press F5 right that's um the F5 experience as",
    "start": "2903800",
    "end": "2909000"
  },
  {
    "text": "they call it yeah um um that the original plan was to ship that with with",
    "start": "2909000",
    "end": "2915160"
  },
  {
    "text": "an update to asut core 2.2 I to be honest I'm I'm doubting this",
    "start": "2915160",
    "end": "2920280"
  },
  {
    "text": "will happen because they are all basically working on 3.0 right now um so",
    "start": "2920280",
    "end": "2925440"
  },
  {
    "text": "but I actually heard yesterday that in the next preview of 3.0 which will ship by the end of the month that stuff will",
    "start": "2925440",
    "end": "2931920"
  },
  {
    "text": "be in there okay so they're going to ship now a monthly preview uh of of 3.0",
    "start": "2931920",
    "end": "2938000"
  },
  {
    "text": "and that stuff will be in there that's what I've got told at least um in the",
    "start": "2938000",
    "end": "2943799"
  },
  {
    "text": "next update okay um in the future there are more advanced",
    "start": "2943799",
    "end": "2949119"
  },
  {
    "text": "scenarios planned like for you know microservice uh uh scenarios with where",
    "start": "2949119",
    "end": "2954319"
  },
  {
    "text": "you bring up an API this API registers automatically with the token server and starts using getting tokens calling",
    "start": "2954319",
    "end": "2961440"
  },
  {
    "text": "other apis and and so on so forth um that's probably not coming in in the",
    "start": "2961440",
    "end": "2967000"
  },
  {
    "text": "first iteration so to speak how can you have a look at that today um as Brock",
    "start": "2967000",
    "end": "2972440"
  },
  {
    "text": "Brock just said it's all open source right so yeah just clone the aut core repo okay and check out a tag called",
    "start": "2972440",
    "end": "2980079"
  },
  {
    "start": "2973000",
    "end": "3200000"
  },
  {
    "text": "release 2.2 okay and then and then you can run that code with with your today. NET",
    "start": "2980079",
    "end": "2986440"
  },
  {
    "text": "Framework and you don't have to install any pre-release versions of of whatever",
    "start": "2986440",
    "end": "2991559"
  },
  {
    "text": "and then you basically open the asp.net identity repo yeah and inside of that",
    "start": "2991559",
    "end": "2997720"
  },
  {
    "text": "there are the integration libraries I just mentioned and there's a sample uh the API off sample which has all of",
    "start": "2997720",
    "end": "3004240"
  },
  {
    "text": "these things wired up so let's have a look at their startup so what what do they mean with zero config basically you",
    "start": "3004240",
    "end": "3011319"
  },
  {
    "text": "know all the upper part is just boiler plate a identity then they pull in our library they add another line here which",
    "start": "3011319",
    "end": "3018680"
  },
  {
    "text": "is the zero config they they talk about yeah so that makes all of the things happen under the covers wires up the",
    "start": "3018680",
    "end": "3024240"
  },
  {
    "text": "right URLs and cookies and blah blah blah um and then they give you support for",
    "start": "3024240",
    "end": "3030280"
  },
  {
    "text": "apis that are embedded in the same application so you you don't need to configure key material and Authority",
    "start": "3030280",
    "end": "3036359"
  },
  {
    "text": "URLs and audiences and so on and so forth okay um yes and then you can just",
    "start": "3036359",
    "end": "3042599"
  },
  {
    "text": "add apis with the authorized attribute and and everything's been taken care of so let's run",
    "start": "3042599",
    "end": "3048119"
  },
  {
    "text": "it I'm pretty sure they're going to polish that UI um that they have right now at some point but that's what you",
    "start": "3048119",
    "end": "3054240"
  },
  {
    "text": "get with the current um the current",
    "start": "3054240",
    "end": "3059680"
  },
  {
    "text": "um repo and it it's a big solution apparently so it takes a bit to run it",
    "start": "3059799",
    "end": "3067200"
  },
  {
    "text": "right um so it's completely unspectacular okay so we press the login",
    "start": "3067200",
    "end": "3072599"
  },
  {
    "text": "button just do that and it looks like any other aspet core template right it's a login page but if you have a closer",
    "start": "3072599",
    "end": "3079400"
  },
  {
    "text": "look at the URL here you can see it's actually a full-blown open ID connect request going on under the covers right",
    "start": "3079400",
    "end": "3086359"
  },
  {
    "text": "but but yeah exactly that's um but you know it just looks like any other login",
    "start": "3086359",
    "end": "3092400"
  },
  {
    "text": "page which I think is the right approach because you know again security should be mostly invisible yeah and then we are",
    "start": "3092400",
    "end": "3097680"
  },
  {
    "text": "loged into the application we call the API we get back values very exciting um but it's all secure okay so that's",
    "start": "3097680",
    "end": "3106079"
  },
  {
    "text": "basically um what we've been uh doing behind the scenes or they've been doing",
    "start": "3106079",
    "end": "3111359"
  },
  {
    "text": "behind the scenes for quite a while now and it it it seems that in a couple of weeks it'll finally finally be",
    "start": "3111359",
    "end": "3119960"
  },
  {
    "text": "public okay oh yeah you can also show the the",
    "start": "3119960",
    "end": "3125680"
  },
  {
    "text": "JavaScript uh no no no show the show the the server side JavaScript that that's",
    "start": "3125680",
    "end": "3131760"
  },
  {
    "text": "not going to no no no the go to index CSH HTML yeah that's not going to be the",
    "start": "3131760",
    "end": "3137720"
  },
  {
    "text": "final way how to wire up JavaScript clients to to tokens um they they they have a tag helper here yeah um that's",
    "start": "3137720",
    "end": "3144720"
  },
  {
    "text": "some some work there but I from what I what they told me is they're actually providing proper angular and react",
    "start": "3144720",
    "end": "3149960"
  },
  {
    "text": "components for for that now and that's just an intermediate thing okay let's go",
    "start": "3149960",
    "end": "3156040"
  },
  {
    "text": "back to slides good so that's it that's the you",
    "start": "3156040",
    "end": "3162599"
  },
  {
    "text": "know the the 60-minute version of aut core security um there's a lot of more",
    "start": "3162599",
    "end": "3168040"
  },
  {
    "text": "stuff to learn about it and uh but I hope that gave you a good overview or you know identify the topics that you",
    "start": "3168040",
    "end": "3174799"
  },
  {
    "text": "want to learn more about yeah have a look at the samples um have a look at",
    "start": "3174799",
    "end": "3180400"
  },
  {
    "text": "the actually the the documentation for Microsoft is pretty good these days I would say yeah so um yeah thanks for",
    "start": "3180400",
    "end": "3187040"
  },
  {
    "text": "that and if you want stickers we also have stickers thank you",
    "start": "3187040",
    "end": "3192319"
  }
]