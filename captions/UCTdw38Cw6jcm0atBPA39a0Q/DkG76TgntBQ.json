[
  {
    "start": "0",
    "end": "72000"
  },
  {
    "text": "so right let's quit going I love the talk obviously consolidating services",
    "start": "7990",
    "end": "13610"
  },
  {
    "text": "with middleware and what I'm going to to argue here is that if you're doing sort",
    "start": "13610",
    "end": "20150"
  },
  {
    "text": "of HTTP based micro services then really many where is it's your friend and and you kinda want",
    "start": "20150",
    "end": "27680"
  },
  {
    "text": "to use that you're gonna want to understand what that is so we're going to talk about that my name is christian as SS s up there i",
    "start": "27680",
    "end": "36940"
  },
  {
    "text": "I'm freelance so I get to sort of go different places and see people's different systems and we're going to",
    "start": "36940",
    "end": "43219"
  },
  {
    "text": "sort of start out talking about some examples drawn from from different",
    "start": "43219",
    "end": "48260"
  },
  {
    "text": "client systems so it's not exactly taking from one exact system but it's it's kind of stuff that it's pretty",
    "start": "48260",
    "end": "54260"
  },
  {
    "text": "close to to to what I've seen and and and I'm going to talk about how in those",
    "start": "54260",
    "end": "59329"
  },
  {
    "text": "situations we've used middleware to to make things easier really and make things things nicer so so it's not drawn",
    "start": "59329",
    "end": "66710"
  },
  {
    "text": "from run one project only but experience based still right so yeah I'm going to",
    "start": "66710",
    "end": "74570"
  },
  {
    "start": "72000",
    "end": "154000"
  },
  {
    "text": "talk a lot about middleware and and then well why really well",
    "start": "74570",
    "end": "79640"
  },
  {
    "text": "middleware gives us some some different stuff it's it's really flexible so it's it's a quite flexible way to sort of get",
    "start": "79640",
    "end": "86450"
  },
  {
    "text": "some building blocks that you can put in the order that you want and you can reuse sort of across different",
    "start": "86450",
    "end": "92020"
  },
  {
    "text": "situations and and being sort of well used in different ways it's nicely",
    "start": "92020",
    "end": "99469"
  },
  {
    "text": "component size so you can really get into a situation where you have like just one little thing that does that",
    "start": "99469",
    "end": "106009"
  },
  {
    "text": "well and then one other little thing that doesn't that well and you just have these nice little components as I said",
    "start": "106009",
    "end": "113450"
  },
  {
    "text": "they can be quite reusable especially in sort of a micro service setting which",
    "start": "113450",
    "end": "119450"
  },
  {
    "text": "we're going to talk more about and lastly they're quite testable at",
    "start": "119450",
    "end": "127549"
  },
  {
    "text": "least to the point where sort of it's kind of your own fault if they're not that testable so from the",
    "start": "127549",
    "end": "133040"
  },
  {
    "text": "outset you can they're small and easy to sort of spin up in a test environment and you can just have them there which",
    "start": "133040",
    "end": "139970"
  },
  {
    "text": "is also really nice so these are seasoned some some some really nice sights of of middleware and",
    "start": "139970",
    "end": "150080"
  },
  {
    "text": "and lots of the reason why I I liked mill aware so I promised you sort of",
    "start": "150080",
    "end": "156860"
  },
  {
    "start": "154000",
    "end": "182000"
  },
  {
    "text": "some stuff from the real world based on real systems I've I've I've",
    "start": "156860",
    "end": "162620"
  },
  {
    "text": "worked on so first of all these things",
    "start": "162620",
    "end": "167990"
  },
  {
    "text": "here are sort of micro service systems and well hooray while doing micro services today because",
    "start": "167990",
    "end": "173960"
  },
  {
    "text": "that's seems to be the thing that we do right have to do that so everybody does",
    "start": "173960",
    "end": "179210"
  },
  {
    "text": "it well maybe there's more reason than that isn't there so so it's just sort of",
    "start": "179210",
    "end": "184610"
  },
  {
    "start": "182000",
    "end": "406000"
  },
  {
    "text": "to touch a little bit on that why do micro services and and sort of why why do it in the systems at least it",
    "start": "184610",
    "end": "191300"
  },
  {
    "text": "these examples are are based on well sort of micro services I'd like to say",
    "start": "191300",
    "end": "197690"
  },
  {
    "text": "that they sort of enable continuous delivery but it's sort of a two-way street I I'd say so the micro services",
    "start": "197690",
    "end": "205459"
  },
  {
    "text": "you have lots of small things which just is unmanageable if you don't if you",
    "start": "205459",
    "end": "211640"
  },
  {
    "text": "can't really automate things and you can't do continuous delivery we really and then on the other hand setting up",
    "start": "211640",
    "end": "218270"
  },
  {
    "text": "all the automation needed to do continuous delivery delivery gets easier if this thing's you're trying to deploy",
    "start": "218270",
    "end": "224540"
  },
  {
    "text": "are smaller so it's I sort of a yin-yang thing going on there one makes the other one easier to do and",
    "start": "224540",
    "end": "231530"
  },
  {
    "text": "on the other hand sort of one needs the other one too even you even be good so",
    "start": "231530",
    "end": "238100"
  },
  {
    "text": "those go hand in hand um you can get highly maintainable services with micro",
    "start": "238100",
    "end": "245090"
  },
  {
    "text": "services again it's just really the fact that they're they're kind of small so the small enough that you can fit them",
    "start": "245090",
    "end": "251209"
  },
  {
    "text": "in your head and you can actually sort of reason about them thinking about them and and know what they're doing so",
    "start": "251209",
    "end": "257810"
  },
  {
    "text": "that's a nice point as well and quite",
    "start": "257810",
    "end": "263890"
  },
  {
    "text": "closely really to that is that you can get a really efficient sort of developer",
    "start": "263890",
    "end": "269300"
  },
  {
    "text": "workflow compiling as fast spinning of them up as fast",
    "start": "269300",
    "end": "275080"
  },
  {
    "text": "the deployment can be fast and so on so forth so you can get the feedback and you could get into a good rhythm with it",
    "start": "275080",
    "end": "281690"
  },
  {
    "text": "do another in the situation where it sort of open up issues to do in the morning and then go have a coffee and half an hour later is your studio and",
    "start": "281690",
    "end": "288020"
  },
  {
    "text": "resharper and everything is sort of loaded because you have 7,000 projects in your solution just like a couple of",
    "start": "288020",
    "end": "294770"
  },
  {
    "text": "projects in there and it's fine yeah I",
    "start": "294770",
    "end": "299870"
  },
  {
    "text": "wrote this robust up by design so micro services can be robust by design as with",
    "start": "299870",
    "end": "306230"
  },
  {
    "text": "anything thing else you can shoot yourself in the foot quite easily but but but you can make you you make sort",
    "start": "306230",
    "end": "313580"
  },
  {
    "text": "of communication between the different services quite explicit and and in it",
    "start": "313580",
    "end": "318950"
  },
  {
    "text": "and quite sort of in-your-face and and you can put sort of robustness around",
    "start": "318950",
    "end": "323960"
  },
  {
    "text": "that communication and how that works and if you're sort of good at designing how those how the collaborations go",
    "start": "323960",
    "end": "332390"
  },
  {
    "text": "about and you can get then you can really design some some highly robust systems and that's really nice as well",
    "start": "332390",
    "end": "342050"
  },
  {
    "text": "and lastly again things are sort of cut into two smaller or smaller bits and",
    "start": "342050",
    "end": "349280"
  },
  {
    "text": "pieces so you can get some some flexibility around the scalability so",
    "start": "349280",
    "end": "354680"
  },
  {
    "text": "you don't have to sort of scale the whole system to the same level you can sort of find the bottleneck and scale",
    "start": "354680",
    "end": "360620"
  },
  {
    "text": "that out instead of scaling every single a little bit of a of it out so I these",
    "start": "360620",
    "end": "367490"
  },
  {
    "text": "are sort of I guess more or less things",
    "start": "367490",
    "end": "373160"
  },
  {
    "text": "that that that people will often highlight about micro services and these has definitely been reasons why we've",
    "start": "373160",
    "end": "380330"
  },
  {
    "text": "chosen micro services and some of the systems I've been wor involved with that we sort of wanted these kinds of things",
    "start": "380330",
    "end": "385820"
  },
  {
    "text": "we wanted to wanted the system to be easy to work with robust and be able to",
    "start": "385820",
    "end": "391580"
  },
  {
    "text": "deliver quickly and so on so that's sort of why even do it and then sort of",
    "start": "391580",
    "end": "398510"
  },
  {
    "text": "through the talk we're going to talk about well it comes at a price and middleware can help us sort of pay that",
    "start": "398510",
    "end": "405020"
  },
  {
    "text": "price again let's put some examples in here so",
    "start": "405020",
    "end": "411090"
  },
  {
    "start": "406000",
    "end": "651000"
  },
  {
    "text": "this is this is yeah I can based on a a real system a system where it's not",
    "start": "411090",
    "end": "418560"
  },
  {
    "text": "supporting is important what that one says really the the the middle one there is the important one is the system where",
    "start": "418560",
    "end": "425870"
  },
  {
    "text": "sort of end users can get notifications about stuff in this case what I've drawn",
    "start": "425870",
    "end": "432240"
  },
  {
    "text": "here is so imagine it's some kind of an ek ecommerce site you can come up with",
    "start": "432240",
    "end": "438480"
  },
  {
    "text": "like special offers for this or the other like buy three get one free stuff",
    "start": "438480",
    "end": "445350"
  },
  {
    "text": "like that and then you want to then you want to sort of notify it uses about about that and it in the system that",
    "start": "445350",
    "end": "454500"
  },
  {
    "text": "this is sort of loosely modeled on we did it more liar and more or less like this so we sort of have the special of",
    "start": "454500",
    "end": "460800"
  },
  {
    "text": "offers up here and so this this guy here is supposed to be sort of in something",
    "start": "460800",
    "end": "467400"
  },
  {
    "text": "publishing events yeah so it's sort of like okay I create a a special offer and",
    "start": "467400",
    "end": "473040"
  },
  {
    "text": "that gets offended out to the world and whoever wants to sort of react to that can and in this case the sort of this",
    "start": "473040",
    "end": "479370"
  },
  {
    "text": "loyalty program thing that wants to react to this and say oh I have some",
    "start": "479370",
    "end": "485490"
  },
  {
    "text": "customers register it in my database and they have different interests and so on if the special offer match is that then",
    "start": "485490",
    "end": "492090"
  },
  {
    "text": "I want to notify them now I have a service for that I haven't no notification micro service for that and",
    "start": "492090",
    "end": "498780"
  },
  {
    "text": "that what doesn't actually do the the the notification it's sort of just knows",
    "start": "498780",
    "end": "505140"
  },
  {
    "text": "about users and knows about again sort of their preferences and some want an",
    "start": "505140",
    "end": "510300"
  },
  {
    "text": "email and somewhat an SMS and someone to push notification and then we have sort of other micro services out here sort of",
    "start": "510300",
    "end": "517080"
  },
  {
    "text": "handling the the integration towards whatever systems are needed to to send",
    "start": "517080",
    "end": "522599"
  },
  {
    "text": "the SMS through a gateway or or whatever you need there so so this is this is",
    "start": "522600",
    "end": "529890"
  },
  {
    "text": "quite fine-grained um but but but but",
    "start": "529890",
    "end": "534930"
  },
  {
    "text": "with the system that the disassemblers is modeled on we really got eye say at least most of the the the points",
    "start": "534930",
    "end": "542940"
  },
  {
    "text": "of the bullets on the previous slide these each of these were quite small easy to work with efficient workflow",
    "start": "542940",
    "end": "551280"
  },
  {
    "text": "they we were able to do continuous delivery with these because they are quite small and if there was like a bark",
    "start": "551280",
    "end": "558000"
  },
  {
    "text": "with the with the integration to the as a mess a gateway it was just this guy that needed to to be redeployed and not",
    "start": "558000",
    "end": "564960"
  },
  {
    "text": "not all of the rest of it and it was quite nice now so you have sort of",
    "start": "564960",
    "end": "570810"
  },
  {
    "text": "direct calls some of these places but the thing triggering or all of it was",
    "start": "570810",
    "end": "576270"
  },
  {
    "text": "this event based mechanism and sort of by design there's some robustness up",
    "start": "576270",
    "end": "581880"
  },
  {
    "text": "there because the events are stuff that have happened and it's okay to look at",
    "start": "581880",
    "end": "588300"
  },
  {
    "text": "them again and sort of if it fails we can just try a little bit later it's a background thing it's okay that you get",
    "start": "588300",
    "end": "594420"
  },
  {
    "text": "the push notification half an hour later if there's a problem or half a minute later or or or whatever like that so so",
    "start": "594420",
    "end": "601110"
  },
  {
    "text": "this actually worked quite well in there in that set up now all the communication",
    "start": "601110",
    "end": "607710"
  },
  {
    "text": "here was was HTTP so the events up here",
    "start": "607710",
    "end": "613670"
  },
  {
    "text": "that that's like an RSS feed basically so so the initiative is down here and",
    "start": "613670",
    "end": "619200"
  },
  {
    "text": "that guy's all of us do you have any new events for me I have the last event I saw was number 100 so we have it to have",
    "start": "619200",
    "end": "626130"
  },
  {
    "text": "any about that sequence number and I don't know it was okay wait a while and then do you have any now oh yeah I have",
    "start": "626130",
    "end": "632430"
  },
  {
    "text": "ten new ones for you fine I will do that and then you can sort of just go through and then the rest of",
    "start": "632430",
    "end": "638850"
  },
  {
    "text": "them there's sort of pretty standard just HP calls do this do this do this so",
    "start": "638850",
    "end": "645000"
  },
  {
    "text": "so there's quite a lot of HTTP communication going on here",
    "start": "645000",
    "end": "651770"
  },
  {
    "text": "another example sort of taking from the same application same system so it's a",
    "start": "651950",
    "end": "660210"
  },
  {
    "text": "system where so I'm at in a system where where people can classify its site and",
    "start": "660210",
    "end": "667740"
  },
  {
    "text": "that classified ads can come from different relate places one of them is so what",
    "start": "667740",
    "end": "675870"
  },
  {
    "text": "what was called a a dealer application in this case so sort of companies that",
    "start": "675870",
    "end": "681899"
  },
  {
    "text": "wanted to list things in these classified now like private people just normal people could do it could do it",
    "start": "681899",
    "end": "688920"
  },
  {
    "text": "all so so there are different channels that could do this same kind of thing the dealer went into the app created",
    "start": "688920",
    "end": "695970"
  },
  {
    "text": "this the the listing to go onto to the site and and there was just there",
    "start": "695970",
    "end": "701339"
  },
  {
    "text": "resulted in an event it comes out of a feed now that we also come from sort of",
    "start": "701339",
    "end": "706589"
  },
  {
    "text": "other sites out there sort of other partners that wasn't directly built from",
    "start": "706589",
    "end": "712680"
  },
  {
    "text": "here same kind of mechanism with the event feed that goes into sort of a common store with all the listings again",
    "start": "712680",
    "end": "722160"
  },
  {
    "text": "and that sort of it has events as well oh there's a new listing that's new listing and then this is that that",
    "start": "722160",
    "end": "728459"
  },
  {
    "text": "there's a search index that gets updated based on that and then there's a site",
    "start": "728459",
    "end": "734339"
  },
  {
    "text": "that actually uses the year and these search engines so you can go to the front page of it and sort of search for",
    "start": "734339",
    "end": "741559"
  },
  {
    "text": "blue cars and then you get the blue cars so by dealerships or some other sites",
    "start": "741559",
    "end": "748620"
  },
  {
    "text": "and whatever and as turned out they were actually sort of several different",
    "start": "748620",
    "end": "754709"
  },
  {
    "text": "classified sites some were sort of for selling everything in there under the Sun and some were sort of for selling",
    "start": "754709",
    "end": "761629"
  },
  {
    "text": "specific verticals and specific things and they shared the same data so you had",
    "start": "761629",
    "end": "767339"
  },
  {
    "text": "sort of a a and and as it is with will with slice and architecture and slide",
    "start": "767339",
    "end": "774209"
  },
  {
    "text": "right it it's it's simplified compared to - to the real world but I do think",
    "start": "774209",
    "end": "780120"
  },
  {
    "text": "that you sort of get the picture that again this is all HTTP and there's quite",
    "start": "780120",
    "end": "787949"
  },
  {
    "text": "a lot of HTTP communication going on and",
    "start": "787949",
    "end": "793339"
  },
  {
    "text": "and you could sort of say why do all this over HTTP why isn't it Q's why",
    "start": "793339",
    "end": "800309"
  },
  {
    "text": "isn't it something else pick your favorite and in these cases it was really very much a matter of the",
    "start": "800309",
    "end": "808170"
  },
  {
    "text": "fact that HTTP is there right and HTTP works we know how HTTP works sort of",
    "start": "808170",
    "end": "815699"
  },
  {
    "text": "quite good at monitoring stuff on on on HTTP and any stack and kento gate should",
    "start": "815699",
    "end": "822569"
  },
  {
    "text": "be it's quite ubiquitous so it's sort of a it's a good it's a good place to sort",
    "start": "822569",
    "end": "827850"
  },
  {
    "text": "of just go and and at least start there and and to be honest",
    "start": "827850",
    "end": "833779"
  },
  {
    "text": "coming into the systems that this is based on I sort of had the reaction of",
    "start": "833779",
    "end": "840829"
  },
  {
    "text": "HTTP that sounds very sort of synchronous and it's going to not be very robust that wasn't the case I say",
    "start": "840829",
    "end": "848040"
  },
  {
    "text": "after a while and and specifically because you can sort of design how the communication works and you can you can",
    "start": "848040",
    "end": "854040"
  },
  {
    "text": "think about who sort of has the initiative and in this sort of oops this",
    "start": "854040",
    "end": "860699"
  },
  {
    "text": "sort of case here like these lines this guy up here is just sort of stores that there's a new listing now it's fine and",
    "start": "860699",
    "end": "867480"
  },
  {
    "text": "then the initiative is down here he says okay I need to find the new listings and so he's responsible for retrying after a",
    "start": "867480",
    "end": "875669"
  },
  {
    "text": "while it doesn't have to be a fast retry this is eventually consistent it doesn't have to be like milliseconds later so",
    "start": "875669",
    "end": "881819"
  },
  {
    "text": "just sort of just sort of it a background task wake up ask for Newman's sleep wake up",
    "start": "881819",
    "end": "888689"
  },
  {
    "text": "as for Newman's that's actually quite well robust and quite simple it's really not that complicated",
    "start": "888689",
    "end": "894889"
  },
  {
    "text": "to do so turns out actually quite nice to work with the with with HTTP for",
    "start": "894889",
    "end": "901949"
  },
  {
    "text": "these things now does that mean you should use that ACB for everything oh I don't think so but it can be a good",
    "start": "901949",
    "end": "907199"
  },
  {
    "text": "option right so sort of along with with",
    "start": "907199",
    "end": "916019"
  },
  {
    "start": "910000",
    "end": "1167000"
  },
  {
    "text": "with micro services comes a few things and and now we're sort of getting into",
    "start": "916019",
    "end": "921480"
  },
  {
    "text": "the the cost of doing micro service it was all like oh these small things and they're nice to work with and it's all been good this far there are things that",
    "start": "921480",
    "end": "928799"
  },
  {
    "text": "you need to master and all able to be successful with micro services you sort of need to be this tall so",
    "start": "928799",
    "end": "937010"
  },
  {
    "text": "you need to have a good relationship at least between sort of dev and ops I think people have been talking quite a",
    "start": "937010",
    "end": "943340"
  },
  {
    "text": "bit about this for a few years but it still holds true that having all these",
    "start": "943340",
    "end": "949130"
  },
  {
    "text": "small things getting them up and running being able to update each and every one",
    "start": "949130",
    "end": "954260"
  },
  {
    "text": "of them sort of quickly and not sort of in a big orchestrated way but just one this thing one thing one thing here it's",
    "start": "954260",
    "end": "961220"
  },
  {
    "text": "just not going to work if it's a oh I've developed my thing in our throat over the wall and see what happens sort of",
    "start": "961220",
    "end": "967430"
  },
  {
    "text": "have to be working together okay it's pretty basic and then you also need to",
    "start": "967430",
    "end": "973670"
  },
  {
    "text": "be quite good at sort of logging and monitoring and this sounds really basic",
    "start": "973670",
    "end": "980710"
  },
  {
    "text": "but I don't I think a lot of systems are good at this but they're also a lot of systems that aren't really good at this",
    "start": "980710",
    "end": "987320"
  },
  {
    "text": "and so but it's really necessary in these situations to have some insights",
    "start": "987320",
    "end": "993380"
  },
  {
    "text": "to how the system is doing you have all these small moving parts you just can't afford to sort of to be to do something",
    "start": "993380",
    "end": "1000010"
  },
  {
    "text": "ad hoc for each of every of these services so you have to sort of know how do I monitor your service how do I know",
    "start": "1000010",
    "end": "1006610"
  },
  {
    "text": "if it's up you can't sort of just kind of test each of them a little bit here",
    "start": "1006610",
    "end": "1012460"
  },
  {
    "text": "and there because you'll have if you follow the these micro service principles you'll have hundreds of of",
    "start": "1012460",
    "end": "1018490"
  },
  {
    "text": "micro services it's just going to be too difficult so so sort of some",
    "start": "1018490",
    "end": "1023830"
  },
  {
    "text": "standardized uniform logging and monitoring across the services is",
    "start": "1023830",
    "end": "1028890"
  },
  {
    "text": "invaluable to have and that's actually some of what we're going to to focus on",
    "start": "1028890",
    "end": "1035640"
  },
  {
    "text": "today and then sort of moving up you read to be quite good at also made of",
    "start": "1035640",
    "end": "1041890"
  },
  {
    "text": "tests and automated bills so so you have to sort of have that set up you run your",
    "start": "1041890",
    "end": "1047650"
  },
  {
    "text": "tests you run your bills and you can see if it's successful or not so that's the CI continuous integration part and then",
    "start": "1047650",
    "end": "1053380"
  },
  {
    "text": "sort of a top of that you probably also need some some some automated deployments and along with that sort of",
    "start": "1053380",
    "end": "1061390"
  },
  {
    "text": "fast provisioning of things because if",
    "start": "1061390",
    "end": "1066580"
  },
  {
    "text": "you do something like this and if you do something like",
    "start": "1066580",
    "end": "1071610"
  },
  {
    "text": "this not only do you have many services but you will also find that that you",
    "start": "1071610",
    "end": "1078040"
  },
  {
    "text": "need to create new ones on a regular basis maybe not a daily basis sort of",
    "start": "1078040",
    "end": "1083440"
  },
  {
    "text": "depends on your scale but on a regular basis quite often you'll find that oh I",
    "start": "1083440",
    "end": "1088660"
  },
  {
    "text": "I don't know in this vertical down here there was sort of a a specialized store",
    "start": "1088660",
    "end": "1096429"
  },
  {
    "text": "and then the search index the first approximation would probably do be to do both of these the same way and just have",
    "start": "1096429",
    "end": "1102460"
  },
  {
    "text": "the search index talked up there and then you sort of figure out no I need another micro service in there you need to spin that up that's a normal thing so",
    "start": "1102460",
    "end": "1110490"
  },
  {
    "text": "you need to be able to get up and running with them fast and at the same time you still need them to act like the",
    "start": "1110490",
    "end": "1118210"
  },
  {
    "text": "other ones with regards to stuff like logging and monitoring your on them to be well-behaved other things that can",
    "start": "1118210",
    "end": "1124750"
  },
  {
    "text": "sort of come into this being well-behaved could be things around security so you might want to make",
    "start": "1124750",
    "end": "1131679"
  },
  {
    "text": "certain that that only the the service that are allowed to talk to each other allowed to to do that so you have",
    "start": "1131679",
    "end": "1137610"
  },
  {
    "text": "certificates allowing stuff like that whatever you you sort of decide um your",
    "start": "1137610",
    "end": "1143920"
  },
  {
    "text": "needs are and this is where malware comes into play because when you're",
    "start": "1143920",
    "end": "1151090"
  },
  {
    "text": "doing everything over HTTP then middleware in the sense of asp net core",
    "start": "1151090",
    "end": "1156370"
  },
  {
    "text": "malware which we're going to look at and in the sense of owen middleware which we're going to look a little bit at as",
    "start": "1156370",
    "end": "1162340"
  },
  {
    "text": "well is is really good place to implement these things right so let's",
    "start": "1162340",
    "end": "1168429"
  },
  {
    "start": "1167000",
    "end": "1235000"
  },
  {
    "text": "sort of turn away from micro services from a four bit because this was sort of the motivation for four for doing these",
    "start": "1168429",
    "end": "1174490"
  },
  {
    "text": "things and then then talk about what middleware is so first of all what any",
    "start": "1174490",
    "end": "1181870"
  },
  {
    "text": "web api or HTTP based API does really is handle its DP requests Wow big surprise",
    "start": "1181870",
    "end": "1189450"
  },
  {
    "text": "so what does that kind of mean in an HP net core since M basically doing this",
    "start": "1189450",
    "end": "1196740"
  },
  {
    "text": "you have a pipeline at the one end of the pipeline that's the kestrel web",
    "start": "1196740",
    "end": "1202450"
  },
  {
    "text": "server so every request comes in to this guy and sort of off the wire and and and",
    "start": "1202450",
    "end": "1209890"
  },
  {
    "text": "Castro looks at it and turns it into something that you're done netcode can they can understand and your dotnet code",
    "start": "1209890",
    "end": "1216950"
  },
  {
    "text": "is over here in the application so Kestrel sends the request in here you do whatever application logic you need and",
    "start": "1216950",
    "end": "1224060"
  },
  {
    "text": "the response comes back Kestrel knows how to serialize that and",
    "start": "1224060",
    "end": "1229400"
  },
  {
    "text": "put it out the way it sees B that's what is a web server does not not too complicated here now that pipeline can",
    "start": "1229400",
    "end": "1238310"
  },
  {
    "start": "1235000",
    "end": "1468000"
  },
  {
    "text": "be longer than just the two bubbles I have there and the pattern behind it is",
    "start": "1238310",
    "end": "1243950"
  },
  {
    "text": "is pipes and filters so request comes in and they get piped through a number of",
    "start": "1243950",
    "end": "1249920"
  },
  {
    "text": "filters m and the way the the requests",
    "start": "1249920",
    "end": "1256040"
  },
  {
    "text": "gets piped through it through what's called the context we're going to look at the context optic as well a bit later",
    "start": "1256040",
    "end": "1262580"
  },
  {
    "text": "in the talk and and the context holds everything regarding the HTTP request",
    "start": "1262580",
    "end": "1270020"
  },
  {
    "text": "and everything regarding the HTTP response as well and the middleware are like the filters in the pipes and",
    "start": "1270020",
    "end": "1276650"
  },
  {
    "text": "filters pattern and it looks like this and you can sort of go on and have more",
    "start": "1276650",
    "end": "1284030"
  },
  {
    "text": "complicated scenarios in there so in in in in this one we just have Kestrel here",
    "start": "1284030",
    "end": "1290210"
  },
  {
    "text": "at the one end we have the application still at the other end and then we have two pieces of middleware there and first",
    "start": "1290210",
    "end": "1296960"
  },
  {
    "text": "one a throttling middleware so one could imagine that we set up limits such that",
    "start": "1296960",
    "end": "1304150"
  },
  {
    "text": "any customer that isn't a paying customer can only make a certain amount or requests per minute or a certain",
    "start": "1304150",
    "end": "1311030"
  },
  {
    "text": "amount a request per day or whatever I think some of the Google API is does",
    "start": "1311030",
    "end": "1316040"
  },
  {
    "text": "stuff like that and then sort of already at this point if the client is above the limit you just return a suitable status",
    "start": "1316040",
    "end": "1324020"
  },
  {
    "text": "code that tells them that they're not alive to do this and if they are you go on then you might have some some",
    "start": "1324020",
    "end": "1331040"
  },
  {
    "text": "authentication middleware looks for an OAuth token and chics weather looks valid and so on and then you go into the",
    "start": "1331040",
    "end": "1337280"
  },
  {
    "text": "application we're using middleware here to push some",
    "start": "1337280",
    "end": "1342320"
  },
  {
    "text": "stuff out of the application and it's sort of technical kind of stuff that you",
    "start": "1342320",
    "end": "1347360"
  },
  {
    "text": "don't really want in the application code it's not really business-related as such and what these pieces of middleware",
    "start": "1347360",
    "end": "1356450"
  },
  {
    "text": "can do is they can transform the request and the response so on the way in they",
    "start": "1356450",
    "end": "1362840"
  },
  {
    "text": "can do stuff to the year to request a lot of the time it's really just looking at the request but you could actually",
    "start": "1362840",
    "end": "1369320"
  },
  {
    "text": "sort of do stuff to it and then on the way out it can transform the the the",
    "start": "1369320",
    "end": "1374510"
  },
  {
    "text": "response and sort of as a as a important bit is that that each that each piece of",
    "start": "1374510",
    "end": "1386000"
  },
  {
    "text": "middleware sort decides whether the rest of the pipeline gets to run so not only can they can they transform the response",
    "start": "1386000",
    "end": "1394040"
  },
  {
    "text": "they can just sort of short soak in and say I'm going to create the full response and be done with it so that's",
    "start": "1394040",
    "end": "1400340"
  },
  {
    "text": "what that FRA telling middleware might do your own were your limit I'm not even going to call those guys I'm just returning here right so each piece of",
    "start": "1400340",
    "end": "1410600"
  },
  {
    "text": "middleware it takes in this context and then it can call the next step in the",
    "start": "1410600",
    "end": "1416000"
  },
  {
    "text": "pipeline if it decides to or it can decide not to and the trick really is",
    "start": "1416000",
    "end": "1423020"
  },
  {
    "text": "that that's a uniform interface so at each of the arrows between the bubbles it's the same it's the same thing",
    "start": "1423020",
    "end": "1429230"
  },
  {
    "text": "flowing there it's that it's that context and that means that you can that",
    "start": "1429230",
    "end": "1435410"
  },
  {
    "text": "you can rearrange and that means that you can plot more things into it like when we have kestrel at one and it",
    "start": "1435410",
    "end": "1442250"
  },
  {
    "text": "doesn't know if it's talking directly to an application or if there are a bunch of middleware pieces between in there",
    "start": "1442250",
    "end": "1447860"
  },
  {
    "text": "because it's the same interface the same goes for for your middleware you don't know if you're talking if you're the",
    "start": "1447860",
    "end": "1453650"
  },
  {
    "text": "last one at the pipeline or you're somewhere in the middle or if it's been switched around so it's it's quite sort",
    "start": "1453650",
    "end": "1460790"
  },
  {
    "text": "of composable in that sense I have these small components and you can compose them up as you want you get that",
    "start": "1460790",
    "end": "1465950"
  },
  {
    "text": "flexibility so things you can do in the pipeline",
    "start": "1465950",
    "end": "1472600"
  },
  {
    "start": "1468000",
    "end": "1639000"
  },
  {
    "text": "so and in sort of open and dispose of",
    "start": "1472630",
    "end": "1478120"
  },
  {
    "text": "resources in a general sense that could be database connections if you want to do the per request thing you might want",
    "start": "1478120",
    "end": "1484370"
  },
  {
    "text": "to consider being more precise than that but there could be other resources that you sort of need you can push that out of the application logic and get it into",
    "start": "1484370",
    "end": "1491170"
  },
  {
    "text": "into middleware you can do logging and we're going to look a little bit of that into authentication you could do",
    "start": "1491170",
    "end": "1497600"
  },
  {
    "text": "authorization you might want to do that more some of that in the application as",
    "start": "1497600",
    "end": "1502610"
  },
  {
    "text": "well but you could do authorization in the sense of are you even allowed to interact with this service at all you",
    "start": "1502610",
    "end": "1511970"
  },
  {
    "text": "can do you can do monitoring endpoints again as I said you don't want to do ad-hoc monitoring for every of the",
    "start": "1511970",
    "end": "1520190"
  },
  {
    "text": "hundreds of micro services and your system you just want them all to to sort",
    "start": "1520190",
    "end": "1525260"
  },
  {
    "text": "of react the same way so having a piece of middleware that this response to a well-known endpoint says I'm alive",
    "start": "1525260",
    "end": "1532550"
  },
  {
    "text": "that's actually really valuable and really easy to code you can sanitize",
    "start": "1532550",
    "end": "1538670"
  },
  {
    "text": "input you could do country negotiation you could do course you can do a lot of stuff in there in these pieces of",
    "start": "1538670",
    "end": "1545900"
  },
  {
    "text": "middleware and the thing there's sort of the overall overarching theme here is",
    "start": "1545900",
    "end": "1551780"
  },
  {
    "text": "that these are cross-cutting concerns in some sense of the other the sort of they",
    "start": "1551780",
    "end": "1557720"
  },
  {
    "text": "cut across the the the business logic they're not really business logic and they cut across many of our services",
    "start": "1557720",
    "end": "1564830"
  },
  {
    "text": "these are not not just about one service they're about most or all of our",
    "start": "1564830",
    "end": "1569900"
  },
  {
    "text": "services they're reusable across the services at least as long as you want",
    "start": "1569900",
    "end": "1576350"
  },
  {
    "text": "your services to behave in a uniform way which I'd argue you do you can separate",
    "start": "1576350",
    "end": "1583610"
  },
  {
    "text": "them and test them nicely just one of them and and be confident they're based",
    "start": "1583610",
    "end": "1589400"
  },
  {
    "text": "on those tests hopefully and they can be updated separately that you sort of",
    "start": "1589400",
    "end": "1595400"
  },
  {
    "text": "don't have to put everything in one in one package again because the pipeline",
    "start": "1595400",
    "end": "1600920"
  },
  {
    "text": "composes and sort of along with that you can destroy",
    "start": "1600920",
    "end": "1605990"
  },
  {
    "text": "freedom separately and by distribute in this case I I mean put them into the",
    "start": "1605990",
    "end": "1613340"
  },
  {
    "text": "different code bases of each of the year of the micro-services so really what I mean is put them into a nougat package",
    "start": "1613340",
    "end": "1620210"
  },
  {
    "text": "and you can sort of have a nougat package with a middleware in it or you",
    "start": "1620210",
    "end": "1625250"
  },
  {
    "text": "can probably you might sort of want to put a meta package on top of that that has your entire sort of standard",
    "start": "1625250",
    "end": "1631820"
  },
  {
    "text": "pipeline but then as needed you can go in and update one of them and you can get moving right so an example of a sort",
    "start": "1631820",
    "end": "1643940"
  },
  {
    "start": "1639000",
    "end": "1870000"
  },
  {
    "text": "of a platform for for for building these http-based Micra services would be building up a pipeline like this and",
    "start": "1643940",
    "end": "1653570"
  },
  {
    "text": "just making it easy to to get up and running again because we are going to -",
    "start": "1653570",
    "end": "1659770"
  },
  {
    "text": "we're going to spin up new micro service quite often so we don't want to do this",
    "start": "1659770",
    "end": "1665240"
  },
  {
    "text": "again and again just want to do the same thing so it this is an example you might",
    "start": "1665240",
    "end": "1670850"
  },
  {
    "text": "want to put them in a different order you might want some more some less some specific to your organization but this",
    "start": "1670850",
    "end": "1677630"
  },
  {
    "text": "is an example so Kestrel in the one end then you might want to attach a correlation ID to every single a request",
    "start": "1677630",
    "end": "1686540"
  },
  {
    "text": "that comes in the idea of the correlation ID is to identify where",
    "start": "1686540",
    "end": "1692960"
  },
  {
    "text": "things come from so at the edge of the system you will you just create a new quit we have lots",
    "start": "1692960",
    "end": "1700580"
  },
  {
    "text": "of wits so create a new one attach it to the to the request and then every time",
    "start": "1700580",
    "end": "1708580"
  },
  {
    "text": "anyway every time the service locks anything it also puts that correlation",
    "start": "1708580",
    "end": "1714440"
  },
  {
    "text": "ID on the year on the log and when it makes calls to other services or when it",
    "start": "1714440",
    "end": "1719870"
  },
  {
    "text": "creates an event that event has the correlation ID in there or that call to",
    "start": "1719870",
    "end": "1726559"
  },
  {
    "text": "another service has that correlation ID in in a header so it follows through the",
    "start": "1726559",
    "end": "1731780"
  },
  {
    "text": "entire system and all locks has that one that becomes really really nice when you",
    "start": "1731780",
    "end": "1737419"
  },
  {
    "text": "have problems then you go to your Locke store and you",
    "start": "1737419",
    "end": "1742820"
  },
  {
    "text": "can search for a correlation ID and you can sort of you can track what happened here and what why was this course you",
    "start": "1742820",
    "end": "1749990"
  },
  {
    "text": "have this problem over here there's a correlation ID find out where did that come from in the system that's really",
    "start": "1749990",
    "end": "1757250"
  },
  {
    "text": "nice you could do request locking so every request coming in every spawns",
    "start": "1757250",
    "end": "1763040"
  },
  {
    "text": "coming out what's going on here you could maybe do that sort of on an",
    "start": "1763040",
    "end": "1769100"
  },
  {
    "text": "information level locking so you have the ability to turn it off so it's not too noisy but you can turn it on when",
    "start": "1769100",
    "end": "1774890"
  },
  {
    "text": "you need it performance looking kind of the same thing in the pipeline here just time",
    "start": "1774890",
    "end": "1781490"
  },
  {
    "text": "everything because it's one of those things that most of the time you're not going to have to look at it but then",
    "start": "1781490",
    "end": "1788690"
  },
  {
    "text": "sometimes something is too slow and really nice to actually get to know how much time does this guy spend and how",
    "start": "1788690",
    "end": "1795050"
  },
  {
    "text": "much time the this guy spent so you just have it in the pipeline and then it's easy to turn on north you could have the",
    "start": "1795050",
    "end": "1802580"
  },
  {
    "text": "monitoring endpoints that I talked about so that all your services respond to",
    "start": "1802580",
    "end": "1808970"
  },
  {
    "text": "something like I don't know slash monitor and it says 200 okay if it's alive or you could be more advanced",
    "start": "1808970",
    "end": "1815690"
  },
  {
    "text": "about it and do something more than just returning that actually checking",
    "start": "1815690",
    "end": "1821120"
  },
  {
    "text": "something more meaningful about whether that's alive or not and you could have",
    "start": "1821120",
    "end": "1827120"
  },
  {
    "text": "authentication down there look at is is there a valid token on this request are",
    "start": "1827120",
    "end": "1833690"
  },
  {
    "text": "we allowed to is there identity here otherwise we might not allow anything and then at the end of that that's the",
    "start": "1833690",
    "end": "1840590"
  },
  {
    "text": "application these things we only want to write like once in air quotes because we",
    "start": "1840590",
    "end": "1845900"
  },
  {
    "text": "don't get things right the first time but we don't want to write them every time we spin up a new service okay so",
    "start": "1845900",
    "end": "1853160"
  },
  {
    "text": "time to actually look at some cold yes so um so I have prepared a little",
    "start": "1853160",
    "end": "1864500"
  },
  {
    "text": "bit here and it really is a little bit I have an empty web application and it",
    "start": "1864500",
    "end": "1872300"
  },
  {
    "start": "1870000",
    "end": "1898000"
  },
  {
    "text": "really is quite empty it's this is it this is all it does it's really not much",
    "start": "1872300",
    "end": "1879770"
  },
  {
    "text": "there so it will just respond OOP",
    "start": "1879770",
    "end": "1884870"
  },
  {
    "text": "hello world - anything down here ooh brilliant little service so that",
    "start": "1884870",
    "end": "1891590"
  },
  {
    "text": "really doesn't do much but that's a nice starting point something that doesn't do anything really and let's see let's see",
    "start": "1891590",
    "end": "1900830"
  },
  {
    "start": "1898000",
    "end": "1977000"
  },
  {
    "text": "if we can run it so it's in this folder and I probably have to restore packages",
    "start": "1900830",
    "end": "1911200"
  },
  {
    "text": "seems okay and let's see if it can basically run dotnet run to that so",
    "start": "1913360",
    "end": "1921110"
  },
  {
    "text": "compiled and it seems to be running on port 5000 so let's check that let's go",
    "start": "1921110",
    "end": "1934429"
  },
  {
    "text": "there and oh hello well and what we might sort of the interesting a bit here is not in the browser that's never",
    "start": "1934429",
    "end": "1940670"
  },
  {
    "text": "interesting that's just for users the interesting big sort of cross the locks so already out of the box here we",
    "start": "1940670",
    "end": "1946610"
  },
  {
    "text": "actually get the request logging part so that's kind of nice so that's already done with and you can see that we got",
    "start": "1946610",
    "end": "1957400"
  },
  {
    "text": "yeah we got a request here for a get request for localhost 5,000 and and you",
    "start": "1957400",
    "end": "1964160"
  },
  {
    "text": "get that request sort of the whole pipeline finished in a certain amount of time and a you got a 200 back from that",
    "start": "1964160",
    "end": "1971150"
  },
  {
    "text": "so that sort of just comes out of the box with I spin it kind of nice so let's",
    "start": "1971150",
    "end": "1979570"
  },
  {
    "start": "1977000",
    "end": "2110000"
  },
  {
    "text": "look at this middleware thing oh that one staying in the same file so",
    "start": "1979570",
    "end": "1990480"
  },
  {
    "text": "if we want to do something more if we want to do some of the middleware that I",
    "start": "1990480",
    "end": "1996059"
  },
  {
    "text": "talked about so there was the so there",
    "start": "1996059",
    "end": "2003799"
  },
  {
    "text": "was already something about the milliseconds out there and that's quite good to have that sort of under very a very outside of the pipeline and so",
    "start": "2003799",
    "end": "2011029"
  },
  {
    "text": "that's from kestrels perspective how long did everything anything take I think it actually makes sense to also",
    "start": "2011029",
    "end": "2017269"
  },
  {
    "text": "have your own performance logging in here that only sort of looks at when I",
    "start": "2017269",
    "end": "2022399"
  },
  {
    "text": "have taken over so how much time I spend in my code so we're going to set that up",
    "start": "2022399",
    "end": "2027950"
  },
  {
    "text": "also serves as an example so in order to create a piece of middleware we go into",
    "start": "2027950",
    "end": "2033679"
  },
  {
    "text": "this app here so that's the I application builder that we get in this",
    "start": "2033679",
    "end": "2039759"
  },
  {
    "text": "configure thing and this configure thing gets called by it's been a core on",
    "start": "2039759",
    "end": "2046789"
  },
  {
    "text": "startup that's how core works for a spinet core works em so and we will say",
    "start": "2046789",
    "end": "2053868"
  },
  {
    "text": "use and that means what we are going to use a piece of malware and we sort of",
    "start": "2053869",
    "end": "2060440"
  },
  {
    "text": "just say yes please give me the signature needed here and the first",
    "start": "2060440",
    "end": "2066710"
  },
  {
    "text": "document here is it's a context and the next one is a function which I'm going",
    "start": "2066710",
    "end": "2073099"
  },
  {
    "text": "to call next and that context is the HTTP context which describes the request",
    "start": "2073099",
    "end": "2080118"
  },
  {
    "text": "and response so that's so this is the uniform interface I talked about between each of the pieces of middleware you get",
    "start": "2080119",
    "end": "2086329"
  },
  {
    "text": "everything about the request in here and you get everything about the response in here as well and then the thing called",
    "start": "2086329",
    "end": "2092720"
  },
  {
    "text": "next is the next bit of the pipeline so that's the thing we can decide to call",
    "start": "2092720",
    "end": "2098510"
  },
  {
    "text": "or not based on whatever we want to do so I have you have flexibility here in the middle where as to what you want to",
    "start": "2098510",
    "end": "2105970"
  },
  {
    "text": "so let's get going and let's just get that a little bit up for everybody see",
    "start": "2105970",
    "end": "2112750"
  },
  {
    "text": "and we can just do stuff like a whatever boom boom boom",
    "start": "2112750",
    "end": "2121650"
  },
  {
    "text": "or watch equals new don't watch go and",
    "start": "2121650",
    "end": "2131569"
  },
  {
    "text": "and we take that watch and say start and",
    "start": "2131569",
    "end": "2136609"
  },
  {
    "text": "then we call next there boom and then",
    "start": "2136609",
    "end": "2145019"
  },
  {
    "text": "after this we just do our performance logging here as a console.writeline",
    "start": "2145019",
    "end": "2152510"
  },
  {
    "text": "right now right right right line and sort of do my",
    "start": "2152510",
    "end": "2162000"
  },
  {
    "text": "pipeline pipeline and we'll just say",
    "start": "2162000",
    "end": "2169440"
  },
  {
    "text": "that that took some milliseconds and it's going to be just watch what sorry",
    "start": "2169440",
    "end": "2178849"
  },
  {
    "text": "watch dollar elapsed I'm gonna second that sort of fine okay",
    "start": "2178849",
    "end": "2184950"
  },
  {
    "text": "so and this is sort of almost it there",
    "start": "2184950",
    "end": "2190319"
  },
  {
    "text": "are awesome squigglies there I think one of them is just semicolon and then sort",
    "start": "2190319",
    "end": "2196230"
  },
  {
    "text": "of the other one what's going on what's going on let's try to have a look if I can find the mouse okay blah blah can",
    "start": "2196230",
    "end": "2204029"
  },
  {
    "text": "resolve and candidates and I don't know well I do know actually and the problem is that that we're supposed to return a",
    "start": "2204029",
    "end": "2210690"
  },
  {
    "text": "task so this whole pipeline is is a sink so everything is just tasks and kestrel",
    "start": "2210690",
    "end": "2218339"
  },
  {
    "text": "at the very end of it will await the tasks that come out of the pipeline and that's where everything will well be",
    "start": "2218339",
    "end": "2224970"
  },
  {
    "text": "waited for and will it really executed right so and moreover if we're just calling like this and not awaiting we're",
    "start": "2224970",
    "end": "2232799"
  },
  {
    "text": "actually not measuring what we want here because I want to do something before and after so I have to make sure that",
    "start": "2232799",
    "end": "2238650"
  },
  {
    "text": "it's actually after so we will wait here and yes we'll make that a saying and I",
    "start": "2238650",
    "end": "2247920"
  },
  {
    "text": "guess we should I'm not going to do this every time but I guess I should put the",
    "start": "2247920",
    "end": "2253620"
  },
  {
    "text": "configure wait false in there so don't have to configure back to the same thread context and there is still a",
    "start": "2253620",
    "end": "2260070"
  },
  {
    "text": "problem either that or writers just confused",
    "start": "2260070",
    "end": "2265410"
  },
  {
    "text": "um let's save let's see if it feels Oh",
    "start": "2265410",
    "end": "2273619"
  },
  {
    "text": "running stop darn it build and I sort of",
    "start": "2273950",
    "end": "2282090"
  },
  {
    "text": "see ok compiled successfully so writers just confused with this Quigley's yes lovely and we can dart now run and it's",
    "start": "2282090",
    "end": "2293760"
  },
  {
    "text": "up and running again and it's not going to be overly surprising I don't think we",
    "start": "2293760",
    "end": "2301410"
  },
  {
    "text": "get in here boom and you can see actually after the initial one which sort of does somewhat some warm up our",
    "start": "2301410",
    "end": "2308640"
  },
  {
    "text": "pipeline is quite fast so it turns out saying hello world is quite fast because",
    "start": "2308640",
    "end": "2314150"
  },
  {
    "text": "0 milliseconds because really what's",
    "start": "2314150",
    "end": "2319260"
  },
  {
    "text": "left in our pipeline after that piece of middleware is it's just this guy let's this context response right async and",
    "start": "2319260",
    "end": "2326520"
  },
  {
    "text": "then that's actually the same context you see so this is how you just write something for the for the output so",
    "start": "2326520",
    "end": "2335790"
  },
  {
    "text": "that's good so if we but in this piece of middleware we didn't really do",
    "start": "2335790",
    "end": "2341130"
  },
  {
    "text": "anything with the with the request or anything so it's sort of ok fine but it",
    "start": "2341130",
    "end": "2348180"
  },
  {
    "text": "doesn't do much so let's do a little bit more in here and we use again we do sort",
    "start": "2348180",
    "end": "2356670"
  },
  {
    "text": "of the kind of kind of thing same thing doom the context the next guy and we are",
    "start": "2356670",
    "end": "2363500"
  },
  {
    "text": "ready so now I want to look at whether",
    "start": "2363500",
    "end": "2369870"
  },
  {
    "text": "they say there's a correlation ID in here or not so now we're going to use",
    "start": "2369870",
    "end": "2375390"
  },
  {
    "text": "the context and I'm going to try to find",
    "start": "2375390",
    "end": "2380790"
  },
  {
    "text": "a correlation ID in there and that's in the context dodge request",
    "start": "2380790",
    "end": "2387900"
  },
  {
    "text": "so you have a strongly typed object here that that describes both request and",
    "start": "2387900",
    "end": "2395070"
  },
  {
    "text": "response as I said so you see you have the request and you have the response down there and then sort of you can dot enter a whole bunch of other things in",
    "start": "2395070",
    "end": "2402210"
  },
  {
    "text": "there so it's an easy way to get to to find things on on the request and I'm",
    "start": "2402210",
    "end": "2408810"
  },
  {
    "text": "going to specifically look at headers and so now I want to look for my",
    "start": "2408810",
    "end": "2418200"
  },
  {
    "text": "correlation ID whether there is already one so that's not a standard I think so of course the type doesn't know about",
    "start": "2418200",
    "end": "2423660"
  },
  {
    "text": "that from the get-go so I'm just going to define my own header here my",
    "start": "2423660",
    "end": "2428780"
  },
  {
    "text": "correlation ID and since headers can",
    "start": "2428780",
    "end": "2435660"
  },
  {
    "text": "have more than one value you get don't you yeah you get you get an array of",
    "start": "2435660",
    "end": "2443400"
  },
  {
    "text": "values out of this and that I'm just interested in the first one I makes it going to say first a default because I",
    "start": "2443400",
    "end": "2449520"
  },
  {
    "text": "don't know if there's a one there or not and then if there's not I'm going to create one where your grid did you do",
    "start": "2449520",
    "end": "2458280"
  },
  {
    "text": "and just ring on that so the types match so now I so if if this is in a service",
    "start": "2458280",
    "end": "2470190"
  },
  {
    "start": "2462000",
    "end": "2522000"
  },
  {
    "text": "sort of inside of my system it should have a correlation ID already because I",
    "start": "2470190",
    "end": "2475440"
  },
  {
    "text": "want to at I want to put the correlations ID on at the surface of the Year of the system and then pass it",
    "start": "2475440",
    "end": "2482250"
  },
  {
    "text": "along on every request coming through but if we want to write this piece of middleware in a way where I can try to",
    "start": "2482250",
    "end": "2489570"
  },
  {
    "text": "reuse it everywhere in my system we'll check if it's there if it's not there we'll just attach a new one or well",
    "start": "2489570",
    "end": "2495750"
  },
  {
    "text": "we'll just create any one and then you have to do something something with it I'm not going to go really into details with this because of time but sort of",
    "start": "2495750",
    "end": "2504960"
  },
  {
    "text": "the thing that you'd probably want to do is first you'd want to attach the",
    "start": "2504960",
    "end": "2513000"
  },
  {
    "text": "correlation IDE to a log context to the log context",
    "start": "2513000",
    "end": "2521660"
  },
  {
    "text": "so if we are using a sort of modern",
    "start": "2521660",
    "end": "2528020"
  },
  {
    "start": "2522000",
    "end": "2803000"
  },
  {
    "text": "logging library like Siri lock which I very much recommend there is a concept",
    "start": "2528020",
    "end": "2533570"
  },
  {
    "text": "of a logging context and it's and and",
    "start": "2533570",
    "end": "2538790"
  },
  {
    "text": "you can put extra metadata there so if I put this correlation ID into that",
    "start": "2538790",
    "end": "2545000"
  },
  {
    "text": "logging context then wherever in my application code I say log dot warned something is wrong then along with that",
    "start": "2545000",
    "end": "2552560"
  },
  {
    "text": "something is wrong message my correlation ID will also be there in the log message going to my log store so",
    "start": "2552560",
    "end": "2561440"
  },
  {
    "text": "so so you make sure that everything inside of this mmm this service locks",
    "start": "2561440",
    "end": "2568970"
  },
  {
    "text": "the correlation ID now the other thing you also probably want to build which I'm not going to build here because",
    "start": "2568970",
    "end": "2575690"
  },
  {
    "text": "we're concentrating on middleware is that that that you also want to make sure that the the correlation ID is",
    "start": "2575690",
    "end": "2581540"
  },
  {
    "text": "passed on to the next guy in the chain to the other services coming along so",
    "start": "2581540",
    "end": "2587060"
  },
  {
    "text": "you also sort of you want to store the correlation ID in in in something like a",
    "start": "2587060",
    "end": "2598510"
  },
  {
    "text": "it's the P client factory so so what",
    "start": "2598510",
    "end": "2606920"
  },
  {
    "text": "I've done before is yeah create a effects with class that can create a an HTTP client for me and use that HTTP",
    "start": "2606920",
    "end": "2614510"
  },
  {
    "text": "client to do calls and then you just sort of on this level inject the the",
    "start": "2614510",
    "end": "2621050"
  },
  {
    "text": "correlation ID into that Factory and then the factory sets up the client such that it has the my correlation ID header",
    "start": "2621050",
    "end": "2627950"
  },
  {
    "text": "on every request and put the right correlation ID in there the next guy in the line has the same piece of",
    "start": "2627950",
    "end": "2633080"
  },
  {
    "text": "middleware he'll file the correlation ID put it into his lock context and you'll",
    "start": "2633080",
    "end": "2638840"
  },
  {
    "text": "get them on all the locks so it's one of those things it's it when you have a",
    "start": "2638840",
    "end": "2647390"
  },
  {
    "text": "production is - and it has to do with something that spread across these microservices",
    "start": "2647390",
    "end": "2653429"
  },
  {
    "text": "it just feels magical so have the correlation IDs it's just so much easier to follow what was going on and it's",
    "start": "2653429",
    "end": "2659789"
  },
  {
    "text": "actually not that hard to code right and",
    "start": "2659789",
    "end": "2665789"
  },
  {
    "text": "once you have this set up then this guy would also call next and in this",
    "start": "2665789",
    "end": "2672179"
  },
  {
    "text": "situation we actually don't want to do anything after the next so I don't have to await I can just return the task that",
    "start": "2672179",
    "end": "2679609"
  },
  {
    "text": "that that that next returns so I just",
    "start": "2679609",
    "end": "2684630"
  },
  {
    "text": "pull that up no reason to await if you don't want to do anything afterwards just sort of pass it on through the guy",
    "start": "2684630",
    "end": "2690599"
  },
  {
    "text": "before that and then when somebody actually needs to a weight thing they should await if you don't just return it",
    "start": "2690599",
    "end": "2696959"
  },
  {
    "text": "and it's the generated code is simpler right let's save yes and I've just",
    "start": "2696959",
    "end": "2707789"
  },
  {
    "text": "checked the time mmm good yeah I guess",
    "start": "2707789",
    "end": "2714299"
  },
  {
    "text": "we could sort of try to prove that both pieces of middleware actually run here",
    "start": "2714299",
    "end": "2721739"
  },
  {
    "text": "if we just do a right line of",
    "start": "2721739",
    "end": "2728929"
  },
  {
    "text": "correlation ID and I can't spill that's",
    "start": "2730279",
    "end": "2735569"
  },
  {
    "text": "okay we do but I should I need that go",
    "start": "2735569",
    "end": "2741059"
  },
  {
    "text": "so we're just going to log that log that out as well and did I save I save now",
    "start": "2741059",
    "end": "2748429"
  },
  {
    "text": "stop that rerun here and it should compile there we go do a request and yes",
    "start": "2748429",
    "end": "2757799"
  },
  {
    "text": "so obviously it got a new correlation ID and they'll get any one if we do one",
    "start": "2757799",
    "end": "2763380"
  },
  {
    "text": "more request no big surprise you get new quits we can",
    "start": "2763380",
    "end": "2768449"
  },
  {
    "text": "create kits yes right so this is so",
    "start": "2768449",
    "end": "2780840"
  },
  {
    "text": "I guess no let me I think I'll create one more piece of middleware and then",
    "start": "2780840",
    "end": "2786720"
  },
  {
    "text": "I'll show you how to do it with classes instead of with these lambdas because that's easier once you can want to want",
    "start": "2786720",
    "end": "2794490"
  },
  {
    "text": "to package them up and share them across things so move this up a bit again so",
    "start": "2794490",
    "end": "2803460"
  },
  {
    "start": "2803000",
    "end": "2980000"
  },
  {
    "text": "everybody can see and so I we talked about the monitoring endpoints so it's",
    "start": "2803460",
    "end": "2809220"
  },
  {
    "text": "really the same thing that you can just do context next and then in this case we",
    "start": "2809220",
    "end": "2816720"
  },
  {
    "text": "just we again want to look at the incoming requests so we just say if",
    "start": "2816720",
    "end": "2822150"
  },
  {
    "text": "context don't request dot path you have the path in there and we're going to say",
    "start": "2822150",
    "end": "2829680"
  },
  {
    "text": "I guess we're going to say equals something like slash money money tour so",
    "start": "2829680",
    "end": "2840900"
  },
  {
    "text": "if we hit the slash money to our endpoint then we will then we will then",
    "start": "2840900",
    "end": "2850320"
  },
  {
    "text": "we will and we'll just do what what that guy down there does actually we will and",
    "start": "2850320",
    "end": "2857250"
  },
  {
    "text": "we will actually return return a context",
    "start": "2857250",
    "end": "2865040"
  },
  {
    "text": "context not able to type apparently no",
    "start": "2865370",
    "end": "2872310"
  },
  {
    "text": "okay typed out response done right I",
    "start": "2872310",
    "end": "2879570"
  },
  {
    "text": "think and you could sort of write the version of the of the service out here",
    "start": "2879570",
    "end": "2887640"
  },
  {
    "text": "is again one of those things kind of nice to be able to get to know where which versions of the services are",
    "start": "2887640",
    "end": "2893520"
  },
  {
    "text": "running and I'm sure you can imagine instead of hard-coding and reading it from from whatever conflict that you",
    "start": "2893520",
    "end": "2901560"
  },
  {
    "text": "have so you get a build number in here or something like that so it's quite easy to figure out why is the service",
    "start": "2901560",
    "end": "2906870"
  },
  {
    "text": "behaving differently than I thought goes to the monitor endpoint see which version is running compare that to your",
    "start": "2906870",
    "end": "2912960"
  },
  {
    "text": "repository maybe you have like the get Shah output it here as well so you know",
    "start": "2912960",
    "end": "2918360"
  },
  {
    "text": "what's running and this is an example of short-circuiting the pipeline and with",
    "start": "2918360",
    "end": "2927090"
  },
  {
    "text": "deciding not to call next in some situations and in other situations deciding to to call next so yeah so you",
    "start": "2927090",
    "end": "2935640"
  },
  {
    "text": "continue to our hello world application down there if it's not the monitoring point of is the monitoring point then we",
    "start": "2935640",
    "end": "2941730"
  },
  {
    "text": "do that thing okay let's just check that it runs don't think they'll be shouldn't",
    "start": "2941730",
    "end": "2948060"
  },
  {
    "text": "be too much surprise here I hope well",
    "start": "2948060",
    "end": "2953610"
  },
  {
    "text": "I'm running so we can do the hello world request still and we can go to slash",
    "start": "2953610",
    "end": "2961640"
  },
  {
    "text": "monitor and we will see yeah you get the version one Oh back there and we well",
    "start": "2961640",
    "end": "2969840"
  },
  {
    "text": "it's the same pieces of middleware that run before that okay so I think you get",
    "start": "2969840",
    "end": "2975090"
  },
  {
    "text": "the picture you can do stuff in the in the pipeline",
    "start": "2975090",
    "end": "2981020"
  },
  {
    "start": "2980000",
    "end": "3600000"
  },
  {
    "text": "thanks for this guy so I am going to cheat a little bit because I want to",
    "start": "2981200",
    "end": "2988050"
  },
  {
    "text": "show you how how looks if you if you actually want to share this across across stuff so I'm going to check out",
    "start": "2988050",
    "end": "2995880"
  },
  {
    "text": "my library branch here please come into",
    "start": "2995880",
    "end": "3001220"
  },
  {
    "text": "our stash that's okay we will just get rid of everything check out",
    "start": "3001220",
    "end": "3010630"
  },
  {
    "text": "- - so got good so I'm on another branch",
    "start": "3010630",
    "end": "3018830"
  },
  {
    "text": "it's mostly the same thing now let's see if Ryder got confused okay Ryder is",
    "start": "3018830",
    "end": "3025640"
  },
  {
    "text": "reloading and restoring packages and stuff you can see that in the solution Explorer thing and now it is back and we",
    "start": "3025640",
    "end": "3033980"
  },
  {
    "text": "have something kind of similar to what we have before we have the same sort of",
    "start": "3033980",
    "end": "3039500"
  },
  {
    "text": "performance logging middleware there and then we have something that looks slightly different here so it doesn't",
    "start": "3039500",
    "end": "3046370"
  },
  {
    "text": "say users use middleware and the thing it's using is monitoring endpoints middleware so now separated that out -",
    "start": "3046370",
    "end": "3056980"
  },
  {
    "text": "something up here in my middleware library let's just a standard class",
    "start": "3056980",
    "end": "3063020"
  },
  {
    "text": "library well dotnet core class library with a project Jason filed there and a single a",
    "start": "3063020",
    "end": "3069350"
  },
  {
    "text": "CS file nothing complicated there I just didn't want to do that live because it takes a few steps in it's boring but it",
    "start": "3069350",
    "end": "3077270"
  },
  {
    "text": "was just scaffold with the with a dotnet command-line and then in this file this aptly named library that CS I have my my",
    "start": "3077270",
    "end": "3086990"
  },
  {
    "text": "middleware and again it's more or less the same only if you do it this way",
    "start": "3086990",
    "end": "3094960"
  },
  {
    "text": "you sort of split the things it's the same argument really you have the next",
    "start": "3094960",
    "end": "3101750"
  },
  {
    "text": "here so that was the second document when we did it as a lambda now you get that in through the constructor it kind",
    "start": "3101750",
    "end": "3107840"
  },
  {
    "text": "of makes sense it's when you're constructing the pipeline that that you instantiate the thing and you set up the",
    "start": "3107840",
    "end": "3113480"
  },
  {
    "text": "whole pipeline so you can add construction time know what the next parts are this gets passed in just",
    "start": "3113480",
    "end": "3119480"
  },
  {
    "text": "saving off and then in that invoke method you get in and HDB on pre context",
    "start": "3119480",
    "end": "3126740"
  },
  {
    "text": "and then on each and every request that one will get called if we set it up and that's what that use middleware that we",
    "start": "3126740",
    "end": "3133610"
  },
  {
    "text": "saw in the start up it does that's what this guy does so instantiate this guy monitoring's",
    "start": "3133610",
    "end": "3140560"
  },
  {
    "text": "endpoint middleware with the next and then it calls invoke so at this",
    "start": "3140560",
    "end": "3148339"
  },
  {
    "text": "point I mean this is just a class this is just just code the other one was also just code but now you separate it out",
    "start": "3148339",
    "end": "3154130"
  },
  {
    "text": "and doesn't even have to look in any kind of way weird and we still have the",
    "start": "3154130",
    "end": "3159380"
  },
  {
    "text": "monitoring endpoint and sort of a as an aside here you can get more stuff in",
    "start": "3159380",
    "end": "3167960"
  },
  {
    "text": "here than just the request delegate the request delegate is an HP net core type which is well just describes the the",
    "start": "3167960",
    "end": "3176450"
  },
  {
    "text": "function that you can call which is the next one it's just a function type but",
    "start": "3176450",
    "end": "3181849"
  },
  {
    "text": "you can get more things injected here so it's been a core out of the box comes",
    "start": "3181849",
    "end": "3187220"
  },
  {
    "text": "with the concept of the of dependency injection and sort of its own services",
    "start": "3187220",
    "end": "3192499"
  },
  {
    "text": "is already in that container so we could depend on some of those but we can also have our own stuff in here so we could",
    "start": "3192499",
    "end": "3200210"
  },
  {
    "text": "imagine sort of if we wanted to do some better monitoring endpoints we could",
    "start": "3200210",
    "end": "3205880"
  },
  {
    "text": "have sort of a like and I a monitor thing here and maybe I don't even",
    "start": "3205880",
    "end": "3214069"
  },
  {
    "text": "implement that here maybe that's maybe that's up to each of the services we did",
    "start": "3214069",
    "end": "3220160"
  },
  {
    "text": "that in one of the systems I've worked on define this interface it just has one method which we call deep and that was",
    "start": "3220160",
    "end": "3228499"
  },
  {
    "text": "supposed to be to implement something that made sense to each and every service so and then that's just a",
    "start": "3228499",
    "end": "3235400"
  },
  {
    "text": "different endpoint if you hit like / - that's less deep or whatever it calls that I - that are deep and if that's",
    "start": "3235400",
    "end": "3243049"
  },
  {
    "text": "successful it says 200 if not it it gives back some other status code based",
    "start": "3243049",
    "end": "3251299"
  },
  {
    "text": "on that and then you can sort of have some of it just be standard behavior and then you have a hook and it's quite easy",
    "start": "3251299",
    "end": "3257329"
  },
  {
    "text": "to just set up and have it be application specific so it's nice that you can depend on other things up here",
    "start": "3257329",
    "end": "3264799"
  },
  {
    "text": "and you just get them a dependency injected easy enough right",
    "start": "3264799",
    "end": "3271150"
  },
  {
    "text": "so back to the start of CS looks like this um let's make sure stuff runs let's",
    "start": "3273440",
    "end": "3286380"
  },
  {
    "text": "see dont run compiles it's up and running",
    "start": "3286380",
    "end": "3293190"
  },
  {
    "text": "and so it's quiet it's slightly different this one it had an underscore",
    "start": "3293190",
    "end": "3298830"
  },
  {
    "text": "Mon it's a letter code here and it get the version and it's all the same so",
    "start": "3298830",
    "end": "3303960"
  },
  {
    "text": "that's all nice and good so a five",
    "start": "3303960",
    "end": "3312030"
  },
  {
    "text": "minutes left it's good so all the code we've seen so far is for a spinet it's",
    "start": "3312030",
    "end": "3318480"
  },
  {
    "text": "been a core you can do similar stuff if you're not on core but on asp net but",
    "start": "3318480",
    "end": "3323610"
  },
  {
    "text": "but it's this sort of kind of a step more to it you can you can have the the",
    "start": "3323610",
    "end": "3331200"
  },
  {
    "text": "the concept of middleware you just have to use Owen so Owen is an open standard developed by by the community it's open",
    "start": "3331200",
    "end": "3338880"
  },
  {
    "text": "web interface for the net and it's really awesome in many ways this is sort",
    "start": "3338880",
    "end": "3344250"
  },
  {
    "text": "of the and and it's really really nicely put together and really has a lot of",
    "start": "3344250",
    "end": "3349890"
  },
  {
    "text": "focus on not depending on anything specific so there's no sort of",
    "start": "3349890",
    "end": "3355620"
  },
  {
    "text": "you don't need sort of an O in DLL or something like that there's no sort of common type in there but the downside of",
    "start": "3355620",
    "end": "3361620"
  },
  {
    "text": "that is that that things get kind of primitive so where we have the context",
    "start": "3361620",
    "end": "3367080"
  },
  {
    "text": "that requested headers then with Owen you just have a dictionary from string to object that's that's the context but",
    "start": "3367080",
    "end": "3373920"
  },
  {
    "text": "the trick is there's a library that you can use if you want to sort of your decision and I'm just going to quickly",
    "start": "3373920",
    "end": "3380670"
  },
  {
    "text": "show that so we're going to going to",
    "start": "3380670",
    "end": "3388260"
  },
  {
    "text": "check out another branch and this one lip Owen um go back into Rider it",
    "start": "3388260",
    "end": "3397260"
  },
  {
    "text": "yes reload again and now we have one more owen middleware here is this and we can",
    "start": "3397260",
    "end": "3405060"
  },
  {
    "text": "do some things similar we have this one so this",
    "start": "3405060",
    "end": "3412110"
  },
  {
    "text": "kind of looks similar and this works on HP knack or or it works on on a spinet",
    "start": "3412110",
    "end": "3419220"
  },
  {
    "text": "today if you use the katana library so so if you're also if you're in a transition area then Owen is probably",
    "start": "3419220",
    "end": "3424560"
  },
  {
    "text": "the place to look to do these kinds of things so how this one works",
    "start": "3424560",
    "end": "3430280"
  },
  {
    "text": "more or less the same again I have a constructor that takes in the next guy now it's not a request delegate is",
    "start": "3430280",
    "end": "3436740"
  },
  {
    "text": "something called an app funk and the app song is this guy up here blah blah blah you just copy this off the internet and",
    "start": "3436740",
    "end": "3442230"
  },
  {
    "text": "you're fine and then the Evoque takes in a dictionary from string to object and",
    "start": "3442230",
    "end": "3447840"
  },
  {
    "text": "that that's a bit cumbersome to work with because then they do something like a lookup the string if I remember",
    "start": "3447840",
    "end": "3456960"
  },
  {
    "text": "correctly it's something like Owen : request headers and then you have then that's an array of strings so you cast",
    "start": "3456960",
    "end": "3463530"
  },
  {
    "text": "the uptaking than you're looking and maybe I'm even remembering this wrong the point is it gets there's a lot of",
    "start": "3463530",
    "end": "3469380"
  },
  {
    "text": "sort of it gets to work a lot with primitives so there is a library called",
    "start": "3469380",
    "end": "3474510"
  },
  {
    "text": "a lip Owen which you might want to use it's sort of a source only library so don't get a DLL from that library you",
    "start": "3474510",
    "end": "3481500"
  },
  {
    "text": "can install it as nougat package and then you get a huge CS file here called Lib Owen and you don't have to look into",
    "start": "3481500",
    "end": "3487860"
  },
  {
    "text": "that what it does is it gives you an Owen context here and then you're sort of back to be able to saying there's and",
    "start": "3487860",
    "end": "3493470"
  },
  {
    "text": "there's and and it looks very much like the other thing so you can do the same thing today and you can sort of have it",
    "start": "3493470",
    "end": "3499230"
  },
  {
    "text": "across there to set that up in NHP neck",
    "start": "3499230",
    "end": "3505410"
  },
  {
    "text": "or you say like it's been a core that now I don't want to use your kind of middleware I want to use Owen so this is",
    "start": "3505410",
    "end": "3511620"
  },
  {
    "text": "sort of a bridge between the two worlds and then you do something like this so",
    "start": "3511620",
    "end": "3518310"
  },
  {
    "text": "yeah so again everything is functions with with own so this is a function you call that function and then I knew",
    "start": "3518310",
    "end": "3525300"
  },
  {
    "text": "up the middleware and give it the invoke method which has the correct signature",
    "start": "3525300",
    "end": "3530910"
  },
  {
    "text": "to fit into the pipeline and the node built it up and you're are good to go so",
    "start": "3530910",
    "end": "3536040"
  },
  {
    "text": "you can do the same kind of thing right one minute left back to the slides",
    "start": "3536040",
    "end": "3543660"
  },
  {
    "text": "and so as I said and as I hope you sort of accept it's quite flexible what you",
    "start": "3543660",
    "end": "3550109"
  },
  {
    "text": "could do in in middleware and you be there quite componentized they can be",
    "start": "3550109",
    "end": "3555119"
  },
  {
    "text": "reused reorganized and since you just have these small classes that do simple things that you can easily new up from",
    "start": "3555119",
    "end": "3561539"
  },
  {
    "text": "your unit tests they're quite testable as well so go use middleware yay and here's the contact information if you",
    "start": "3561539",
    "end": "3568650"
  },
  {
    "text": "want to get hold of me and I'll be around for questions and stuff 51 but I",
    "start": "3568650",
    "end": "3574289"
  },
  {
    "text": "think time is up and we have one minute for questions if there so anything before the break it's not but I could",
    "start": "3574289",
    "end": "3585109"
  },
  {
    "text": "yeah I will that's fine yeah and I will",
    "start": "3585109",
    "end": "3590480"
  },
  {
    "text": "tweet the link yep good okay thank you",
    "start": "3590480",
    "end": "3597420"
  },
  {
    "text": "[Applause]",
    "start": "3597420",
    "end": "3601909"
  }
]