[
  {
    "start": "0",
    "end": "178000"
  },
  {
    "text": "that's an excellent start try again good morning thank",
    "start": "5799",
    "end": "11280"
  },
  {
    "text": "you as you can hear from my voice I love Copenhagen I'm always glad to be back",
    "start": "11280",
    "end": "16800"
  },
  {
    "text": "here um so how many of you build a sput core applications today or in the in the",
    "start": "16800",
    "end": "22720"
  },
  {
    "text": "near future okay and and how many of you have to secure them like is your job to",
    "start": "22720",
    "end": "28679"
  },
  {
    "text": "secure them okay so to be honest I just did a two-day workshop on this topic so there is more",
    "start": "28679",
    "end": "35600"
  },
  {
    "text": "to be said about that that fits into 60 Minutes um so it's an overview okay so",
    "start": "35600",
    "end": "41039"
  },
  {
    "text": "it's basically for people that maybe are new to that and want to get like a the big picture what is in there uh in",
    "start": "41039",
    "end": "47920"
  },
  {
    "text": "asp.net to help me with the security architecture of my application or maybe",
    "start": "47920",
    "end": "53000"
  },
  {
    "text": "you know you know bits and pieces of it and you want to make sure you're not missing anything yeah um so we help our",
    "start": "53000",
    "end": "60600"
  },
  {
    "text": "customers evaluate basically if asp.net core is the right platform for their",
    "start": "60600",
    "end": "67320"
  },
  {
    "text": "next Generation app or you know the app they they they're planning to build and so on and you know that there are many",
    "start": "67320",
    "end": "73439"
  },
  {
    "text": "things that make up this platform I only know about security yeah that's all I'm",
    "start": "73439",
    "end": "79200"
  },
  {
    "text": "um um that's all I can talk about really so",
    "start": "79200",
    "end": "84720"
  },
  {
    "text": "um and it you know for those who have been following aspet core is many things",
    "start": "84720",
    "end": "89759"
  },
  {
    "text": "have have changed right so the the the authentication system was brand new in 1.0 got Rewritten from scratch in 1.1",
    "start": "89759",
    "end": "95600"
  },
  {
    "text": "got Rewritten from scratch again in 2.0 the good news is yeah now it's pretty stable yeah so from a from a security",
    "start": "95600",
    "end": "103040"
  },
  {
    "text": "point of view that that that's good news um I also had a look at 3.0 yeah the the",
    "start": "103040",
    "end": "108640"
  },
  {
    "text": "current preview preview fre and again it looks pretty stable so no fundamental",
    "start": "108640",
    "end": "114000"
  },
  {
    "text": "changes anymore at least as of today okay you never know um so this as I said",
    "start": "114000",
    "end": "120280"
  },
  {
    "text": "is an overview of the the things we have today and a little bit of an Outlook what's coming in uh in 3.0 so my name is",
    "start": "120280",
    "end": "126960"
  },
  {
    "text": "Dominic um the idea is I I I have a couple of links on these slides for",
    "start": "126960",
    "end": "132200"
  },
  {
    "text": "demos and and documentation and so on H and I uploaded those slides to speaker",
    "start": "132200",
    "end": "137280"
  },
  {
    "text": "deck so if you want to you know if you need one URL then take the uh get the speaker de one download",
    "start": "137280",
    "end": "144800"
  },
  {
    "text": "the slides from there get the the further links from there so um I'm working with the asp.net team for a long",
    "start": "144800",
    "end": "151400"
  },
  {
    "text": "long time I'm I'm um one of the offers of this thing called identity server which is an open source implementation",
    "start": "151400",
    "end": "158160"
  },
  {
    "text": "of an O of an open connect server which is pretty close to the metal in asp.net",
    "start": "158160",
    "end": "163640"
  },
  {
    "text": "so whenever the asp.net team decided to change something internally in their security stuff it it broke us pretty",
    "start": "163640",
    "end": "170560"
  },
  {
    "text": "much the first so um that's where basically all the you",
    "start": "170560",
    "end": "177040"
  },
  {
    "text": "know my gray hair is coming from Okay so who is old enough to remember",
    "start": "177040",
    "end": "183959"
  },
  {
    "start": "178000",
    "end": "241000"
  },
  {
    "text": "this um how many of these five options actually",
    "start": "184680",
    "end": "190840"
  },
  {
    "text": "work any idea none Works you're right you mean the none option or none",
    "start": "191040",
    "end": "199159"
  },
  {
    "text": "of them none Works yes which one does work",
    "start": "199159",
    "end": "204760"
  },
  {
    "text": "too Windows does work you would hope that right uh forms works as well has",
    "start": "204760",
    "end": "210159"
  },
  {
    "text": "anyone ever done a passport authentication you can't because it never existed yeah it um it was a",
    "start": "210159",
    "end": "217959"
  },
  {
    "text": "product from Microsoft which got pulled before the very first version of asp.net and nobody updated the enum okay um",
    "start": "217959",
    "end": "225760"
  },
  {
    "text": "Federated was the second attempt of Microsoft to do a uh token based",
    "start": "225760",
    "end": "230879"
  },
  {
    "text": "authentication in net 4.5 before they released it they removed it again but",
    "start": "230879",
    "end": "236400"
  },
  {
    "text": "nobody updated the enam okay so yeah yeah um I spent even 14 year 14 14",
    "start": "236400",
    "end": "244840"
  },
  {
    "start": "241000",
    "end": "274000"
  },
  {
    "text": "months of my life yeah documenting all this and if you get one takeaway from this talk never write a book okay it's",
    "start": "244840",
    "end": "252120"
  },
  {
    "text": "it's not worth it um it was called asp.net 2.0 it it got released and three weeks",
    "start": "252120",
    "end": "258720"
  },
  {
    "text": "later asp.net 3.0 got released which made it outdated even if there nothing",
    "start": "258720",
    "end": "264240"
  },
  {
    "text": "has changed in between but you know so I I'm assuming none of the three people are in the room that read this book no",
    "start": "264240",
    "end": "271919"
  },
  {
    "text": "yeah I thought so anyways um kind of like the you know the",
    "start": "271919",
    "end": "277400"
  },
  {
    "start": "274000",
    "end": "411000"
  },
  {
    "text": "scene um for modern applications yeah is kind of you know like I mean there's",
    "start": "277400",
    "end": "283400"
  },
  {
    "text": "nothing new right we're building front ends we're building back ends they building back ends for back ends yeah uh it's just that you know the the",
    "start": "283400",
    "end": "289400"
  },
  {
    "text": "Technologies Chang the the requirements change a little bit um the the circumstances Chang right while you know",
    "start": "289400",
    "end": "295120"
  },
  {
    "text": "10 years ago this was all Microsoft windows.net today you know we have a wild mix of net and windows and Unix and",
    "start": "295120",
    "end": "302360"
  },
  {
    "text": "containers and IOS and Android and chrome and Firefox and I think that's it",
    "start": "302360",
    "end": "308320"
  },
  {
    "text": "pretty much yeah um so 10 years ago we we relied on the",
    "start": "308320",
    "end": "314759"
  },
  {
    "text": "operating system to do the the hard work for us right enable Windows integrated authentication in IIs job done this",
    "start": "314759",
    "end": "320639"
  },
  {
    "text": "doesn't work like that anymore so basically because we have this operating system Independence and the crossplatform and these different run",
    "start": "320639",
    "end": "327080"
  },
  {
    "text": "times all of the security stuff these days is happening at the application Level right the protocols are at the",
    "start": "327080",
    "end": "332199"
  },
  {
    "text": "application layer they are running over HTP and and so on in other words it is actually the job of asp.net core in your",
    "start": "332199",
    "end": "338880"
  },
  {
    "text": "system to provide all these things yeah so let's have a look how that works",
    "start": "338880",
    "end": "345680"
  },
  {
    "text": "um you typically when we talk about a modern security architecture factor out certain security functions one would be",
    "start": "345680",
    "end": "353560"
  },
  {
    "text": "authentication so you know you you would be crazy if in 2019 you would write your own login page inside inside your",
    "start": "353560",
    "end": "360000"
  },
  {
    "text": "application you want to make that a central you know a shared service that your applications can share you get",
    "start": "360000",
    "end": "365520"
  },
  {
    "text": "things like single sign on you know and and and you know U basically make allow",
    "start": "365520",
    "end": "370960"
  },
  {
    "text": "the business developers to to focus on the business and the security guys to focus on security yeah um so that's to",
    "start": "370960",
    "end": "377360"
  },
  {
    "text": "be called an identity provider and you also want to have uh something that deals with authorization so after you",
    "start": "377360",
    "end": "383520"
  },
  {
    "text": "know who the user is you want to know what is this user allowed to do um there are many ways to implement that I just",
    "start": "383520",
    "end": "389039"
  },
  {
    "text": "put it there as a separate box it doesn't necessar need to be its own server but it's definitely separate from",
    "start": "389039",
    "end": "395639"
  },
  {
    "text": "the identity yeah so I've seen many people trying to conflate the two concepts identity and",
    "start": "395639",
    "end": "401440"
  },
  {
    "text": "authorization and it doesn't work yeah I I would need another talk to explain to",
    "start": "401440",
    "end": "407240"
  },
  {
    "text": "you why if you're interested come to me afterwards but it's it's complicated okay so my idea is basically",
    "start": "407240",
    "end": "414800"
  },
  {
    "start": "411000",
    "end": "425000"
  },
  {
    "text": "to to to start from the ground up uh and work our ways up the different layers of asp.net and what the security um of",
    "start": "414800",
    "end": "422759"
  },
  {
    "text": "these layers is all about um let's start with hosting so you might might have",
    "start": "422759",
    "end": "428440"
  },
  {
    "start": "425000",
    "end": "533000"
  },
  {
    "text": "heard that Microsoft built their own new web server called castral uh it's a crossplatform web server and I wouldn't",
    "start": "428440",
    "end": "434960"
  },
  {
    "text": "even call it the web server it's more like an application server it executes exactly one application which is your application it's not like IIs where you",
    "start": "434960",
    "end": "441599"
  },
  {
    "text": "have like you know virtual directories and application pools and all these things so but by default asp.net core",
    "start": "441599",
    "end": "447720"
  },
  {
    "text": "will execute on the castal application server there are more options these days you can host in IIs and so on but if you",
    "start": "447720",
    "end": "454919"
  },
  {
    "text": "are not on Windows or you want to have the same server on all of the platforms",
    "start": "454919",
    "end": "460000"
  },
  {
    "text": "then you probably end up using castl um you might have heard that writing a web",
    "start": "460000",
    "end": "465319"
  },
  {
    "text": "server is hard especially from a security point of view yeah so in the in the in the one pointx times Microsoft",
    "start": "465319",
    "end": "472080"
  },
  {
    "text": "said like yeah you can use Castle but never ever expose it directly to the internet because we are not sure if the",
    "start": "472080",
    "end": "477680"
  },
  {
    "text": "you know the Wild Wild West is will be friendly enough to to our new little um",
    "start": "477680",
    "end": "483000"
  },
  {
    "text": "web server so that has changed in in version two so if you want to you can",
    "start": "483000",
    "end": "488879"
  },
  {
    "text": "now expose uh castral directly uh on the edge um lots of penetration testing has",
    "start": "488879",
    "end": "494720"
  },
  {
    "text": "been done they found a couple of bucks or many I don't know um and this is this",
    "start": "494720",
    "end": "500199"
  },
  {
    "text": "is now a fully supported architecture yeah and some people do that I as as a security person I still feel a",
    "start": "500199",
    "end": "507400"
  },
  {
    "text": "little I don't know uh Tor here I personally prefer to have a reverse",
    "start": "507400",
    "end": "513760"
  },
  {
    "text": "proxy in front of my web server yeah like you know engine X Apache IIs or",
    "start": "513760",
    "end": "518919"
  },
  {
    "text": "maybe a load balancer that's my preferred architecture but this is fully supported now yeah if you want to do that maybe you know in the microservice",
    "start": "518919",
    "end": "525839"
  },
  {
    "text": "context people like like the idea of having a lean very small web server bring it up run you know host a service",
    "start": "525839",
    "end": "532720"
  },
  {
    "text": "whatever if you are hosting directly on the internet be prepared to tweak some things right um so Castell is a is a",
    "start": "532720",
    "end": "541240"
  },
  {
    "start": "533000",
    "end": "604000"
  },
  {
    "text": "very small and and very fast web server um but and has a has a lot of tweakability yeah and you have to figure",
    "start": "541240",
    "end": "548920"
  },
  {
    "text": "out yeah what which buffer sizes do I need yeah which uh uh limits do I need",
    "start": "548920",
    "end": "554040"
  },
  {
    "text": "to set yeah and that's always a fine line between performance and denial of service attacks yeah so be careful with",
    "start": "554040",
    "end": "559320"
  },
  {
    "text": "that um they now support htps and actually if you open the newer templates",
    "start": "559320",
    "end": "564600"
  },
  {
    "text": "they have htps turned on by default in castral which I personally think is not",
    "start": "564600",
    "end": "570120"
  },
  {
    "text": "really necessary because I'm not seeing any benefit of running htps on my local host but well you know it's htps by",
    "start": "570120",
    "end": "576720"
  },
  {
    "text": "default now which Probably sounds good um what's pretty cool is this they",
    "start": "576720",
    "end": "582120"
  },
  {
    "text": "support both static uh certificates where you just you know have a static configuration or they support also Sni",
    "start": "582120",
    "end": "588480"
  },
  {
    "text": "which which stands for server name indication where you can host multiple the you know DNS names on the same",
    "start": "588480",
    "end": "595000"
  },
  {
    "text": "server for example and pay depending on what's coming in you can get the right search and and do the do the the the HPS",
    "start": "595000",
    "end": "601760"
  },
  {
    "text": "tunnel with that as well so you know that's castal um once you are be beyond",
    "start": "601760",
    "end": "607839"
  },
  {
    "start": "604000",
    "end": "663000"
  },
  {
    "text": "the the hosting layer or yeah the hosting layer then you entering the aut core you know runtime if you like which",
    "start": "607839",
    "end": "614720"
  },
  {
    "text": "is essentially a process that loads net yeah or net core right now you have the",
    "start": "614720",
    "end": "621760"
  },
  {
    "text": "choice in the future as. net fre will not run on The NET Framework anymore so in my opinion you should move away from",
    "start": "621760",
    "end": "627800"
  },
  {
    "text": "that as quickly as you can um on top of that we have ASP net core then we have this thing called the",
    "start": "627800",
    "end": "633680"
  },
  {
    "text": "middleware pipeline uh which basically is just a way to automatically execute code yeah and the middleware itself is",
    "start": "633680",
    "end": "641120"
  },
  {
    "text": "typically pretty simple it it pulls the real services from from a DI container and uses that to do its job so it turns",
    "start": "641120",
    "end": "648320"
  },
  {
    "text": "out all of the security features in asp.net core are actually Services living in a DI container and some",
    "start": "648320",
    "end": "655480"
  },
  {
    "text": "middleware that makes use of it yeah um if it needs to be executed uh",
    "start": "655480",
    "end": "661240"
  },
  {
    "text": "automatically in the in the request pipeline so the first service I want to",
    "start": "661240",
    "end": "666519"
  },
  {
    "start": "663000",
    "end": "745000"
  },
  {
    "text": "talk about is the one that not people not many people know but it's going to bite you at on deployment day if you are",
    "start": "666519",
    "end": "673720"
  },
  {
    "text": "not aware of it yeah who can remember this here yeah the machine key right um so",
    "start": "673720",
    "end": "681800"
  },
  {
    "text": "the the expectation in the old hp. networ that you have a master key for your application you have to come up",
    "start": "681800",
    "end": "687200"
  },
  {
    "text": "with that yourself or you go to some website machine key generator.com yeah um and then you paste that key into",
    "start": "687200",
    "end": "695040"
  },
  {
    "text": "your web config and then this key is used to protect your cookies and and all these things right so this is basically",
    "start": "695040",
    "end": "700959"
  },
  {
    "text": "the most important string in your in your application because whoever can steal that key from you he can create",
    "start": "700959",
    "end": "706800"
  },
  {
    "text": "cookies that that look like as if they are coming from you okay which is a very bad thing and because this string was so",
    "start": "706800",
    "end": "714120"
  },
  {
    "text": "important we put it into clear text into a config file on our web server right",
    "start": "714120",
    "end": "719320"
  },
  {
    "text": "that was a brilliant idea yeah it was a 90s design yeah um you know these things",
    "start": "719320",
    "end": "725720"
  },
  {
    "text": "end up in Source control and if you open source this thing it ends up on GitHub uh if you're not careful that the Google",
    "start": "725720",
    "end": "732040"
  },
  {
    "text": "indexes your config files right I mean try this you have fun",
    "start": "732040",
    "end": "737800"
  },
  {
    "text": "yeah you probably can deduct what that what that means this search syntax here yeah um so that that that's the first",
    "start": "737800",
    "end": "743880"
  },
  {
    "text": "thing they had to change okay um so they have a new API in in in a core called the data prot ction API um and the first",
    "start": "743880",
    "end": "751519"
  },
  {
    "start": "745000",
    "end": "1034000"
  },
  {
    "text": "thing they had to fix yeah was to get that key material outside of the application directory yeah it must not",
    "start": "751519",
    "end": "758839"
  },
  {
    "text": "live inside the application directory otherwise this will you know it's it's",
    "start": "758839",
    "end": "763920"
  },
  {
    "text": "the the the the the chance of exposure is very high so that's what they did um",
    "start": "763920",
    "end": "769199"
  },
  {
    "text": "they they have some defaults where they store it by default and it is a very developer friendly because on your local",
    "start": "769199",
    "end": "775920"
  },
  {
    "text": "def machine they just take your um your your profile and store it in there okay I think I have a screenshot of that yeah",
    "start": "775920",
    "end": "782000"
  },
  {
    "text": "that's how it looks like yeah so it's uh in users Dominic app data local aset",
    "start": "782000",
    "end": "787199"
  },
  {
    "text": "data protection Keys um and that's how a key looks like yeah um this this API is",
    "start": "787199",
    "end": "793240"
  },
  {
    "text": "zero maintenance from your point of view at development time because they just create that file and they they're just",
    "start": "793240",
    "end": "798320"
  },
  {
    "text": "using it yeah the problem starts when you're starting to deploy the application because hey on the",
    "start": "798320",
    "end": "803720"
  },
  {
    "text": "deployment server this file must live somewhere okay um so you know if you're",
    "start": "803720",
    "end": "809399"
  },
  {
    "text": "deploying to Asha right I mean they put some magic pixie dust over your application and it just works yeah",
    "start": "809399",
    "end": "814959"
  },
  {
    "text": "because what they do under the covers is they provision a file share that is shared between all the instances of your",
    "start": "814959",
    "end": "821560"
  },
  {
    "text": "web app and then they put that key container on this file share if you are doing anything else than as web apps you",
    "start": "821560",
    "end": "827760"
  },
  {
    "text": "have to think about where to store this thing yeah and the options are in a database in a cache blob storage",
    "start": "827760",
    "end": "834880"
  },
  {
    "text": "whatever okay but you have to have this thing otherwise your applications will break the moment they are being load",
    "start": "834880",
    "end": "840959"
  },
  {
    "text": "balanced right because all of the nodes in your cluster must have access to the same key material otherwise it it'll",
    "start": "840959",
    "end": "847360"
  },
  {
    "text": "break okay um so let me show you a demo of that um and I'm showing you that",
    "start": "847360",
    "end": "854240"
  },
  {
    "text": "because I have many customers that have this unpleasant uh experience on deployment day and that's the worst day",
    "start": "854240",
    "end": "859560"
  },
  {
    "text": "right uh to have unpleasant experiences so um uh basically you can see um uh this",
    "start": "859560",
    "end": "867040"
  },
  {
    "text": "data protection provider is just a service is living in a DI container you can use it yourself Microsoft uses it internally and then you can just um uh",
    "start": "867040",
    "end": "875320"
  },
  {
    "text": "you know protect data and unprotect data and um um Let me show that to you first",
    "start": "875320",
    "end": "882759"
  },
  {
    "text": "and be be aware all these demos are really really boring because SEC that that's how security demos should be yeah",
    "start": "882759",
    "end": "889199"
  },
  {
    "text": "if security is exciting well then it's probably in the way of many people so",
    "start": "889199",
    "end": "894560"
  },
  {
    "text": "you know Pro encrypting a string yay okay that's that's your protected string",
    "start": "894560",
    "end": "900839"
  },
  {
    "text": "now and now you can basically transmit this or you know put it on a query string parameter or you know round trip",
    "start": "900839",
    "end": "906639"
  },
  {
    "text": "it whatever um and when you unprotect it the system makes sure it hasn't been tampered with and manipulated and so on",
    "start": "906639",
    "end": "913880"
  },
  {
    "text": "so forth yeah the other thing I did in this application is something you should never ever do it's probably a bad uh bad",
    "start": "913880",
    "end": "921399"
  },
  {
    "text": "introduction to the feature but uh I persisted the the keys to the file system in my current application",
    "start": "921399",
    "end": "927440"
  },
  {
    "text": "directory why well just just to be able to show it to you easily right here it is okay the very the very first time I I",
    "start": "927440",
    "end": "934000"
  },
  {
    "text": "used the API it created this key container um and here it is okay so",
    "start": "934000",
    "end": "940480"
  },
  {
    "text": "now let's simulate your load balancing yeah and the application doesn't have access to the key anymore because well",
    "start": "940480",
    "end": "947600"
  },
  {
    "text": "I'm deleting it yeah so um and I'm shutting down the server",
    "start": "947600",
    "end": "952680"
  },
  {
    "text": "as well and running it again okay and now imagine a cookie",
    "start": "952680",
    "end": "959199"
  },
  {
    "text": "comes into your application as. net tries to unprotect it it will",
    "start": "959199",
    "end": "965639"
  },
  {
    "text": "fail okay it won't fail with an unhandled exception in the cookie case",
    "start": "965639",
    "end": "970920"
  },
  {
    "text": "but you will see these exceptions in your loog files and that means basically somehow",
    "start": "970920",
    "end": "976720"
  },
  {
    "text": "you are not configuring your key container in the right way okay so you",
    "start": "976720",
    "end": "982720"
  },
  {
    "text": "know sounds boring but it's very important because as I said the moment you're load balancing this will fail if",
    "start": "982720",
    "end": "989120"
  },
  {
    "text": "you haven't planned for it yeah okay um besides that this API is",
    "start": "989120",
    "end": "995959"
  },
  {
    "text": "brilliant yeah I mean um they they use all the bells and whistles big Keys the right the right algorithms they auto",
    "start": "995959",
    "end": "1002360"
  },
  {
    "text": "rotate your keys every 90 days they do all the right things and really the only thing you have to do is give them a",
    "start": "1002360",
    "end": "1008839"
  },
  {
    "text": "place to store it okay good um yeah so",
    "start": "1008839",
    "end": "1014199"
  },
  {
    "text": "who's using that well cookies are using it and the forgery is using it uh uh off",
    "start": "1014199",
    "end": "1019319"
  },
  {
    "text": "the state parameter is protected with uh data protection uh if you're using temp data yeah these things um you you can",
    "start": "1019319",
    "end": "1026079"
  },
  {
    "text": "use use it yourself as you've just seen so if you have the need to temporarily protect certain data while you're",
    "start": "1026079",
    "end": "1031600"
  },
  {
    "text": "passing it around that's a thing to use okay",
    "start": "1031600",
    "end": "1037400"
  },
  {
    "start": "1034000",
    "end": "1216000"
  },
  {
    "text": "so data protection is actually needed by the authentication system as you can imagine because there is a need to",
    "start": "1037880",
    "end": "1043720"
  },
  {
    "text": "protect data yeah so let's have a look at that next so the authentication system is by far",
    "start": "1043720",
    "end": "1049799"
  },
  {
    "text": "the best thing we ever had in in in net yeah it's super flexible you can use as",
    "start": "1049799",
    "end": "1055520"
  },
  {
    "text": "many different authentication methods as you want um you just throw them in a DI container we have an orchestration",
    "start": "1055520",
    "end": "1060880"
  },
  {
    "text": "engine that makes sure no one steps on each other's toes and for the very first time this actually works yeah I mean for",
    "start": "1060880",
    "end": "1066919"
  },
  {
    "text": "people who are doing owin or you know other things they know that this is a bit tricky sometimes um",
    "start": "1066919",
    "end": "1073320"
  },
  {
    "text": "so basically when you when you look at the authentication system we have a couple of options here well one is you do your own authentication obviously you",
    "start": "1073320",
    "end": "1079919"
  },
  {
    "text": "bring up your name and password page you go to your database and so on yeah um or you are using some sort of social",
    "start": "1079919",
    "end": "1087880"
  },
  {
    "text": "providers right like Google Facebook uh Twitter and Microsoft are included by Microsoft um which are proprietary and",
    "start": "1087880",
    "end": "1094919"
  },
  {
    "text": "you see here um there's a community project which has like 40 plus more of",
    "start": "1094919",
    "end": "1100000"
  },
  {
    "text": "these proprietary providers like you know um in really important things like Battlenet for example or you know GitHub",
    "start": "1100000",
    "end": "1107120"
  },
  {
    "text": "or untapped yeah um when you look at standard space",
    "start": "1107120",
    "end": "1113039"
  },
  {
    "text": "protocols uh Microsoft supports open connect obviously uh and WS Federation",
    "start": "1113039",
    "end": "1118080"
  },
  {
    "text": "so if you have like an an adfs server for example or you know that that's the main motivation really to have it yeah",
    "start": "1118080",
    "end": "1123799"
  },
  {
    "text": "um or you're working in in a bank or something like this WS Federation is still a thing um saml is not included by",
    "start": "1123799",
    "end": "1131480"
  },
  {
    "text": "Microsoft but there's a guy from Sweden called andas uh whenever you have a seml problem just call him he's the right",
    "start": "1131480",
    "end": "1138039"
  },
  {
    "text": "person to talk to uh don't call me please um and yeah he produces an an",
    "start": "1138039",
    "end": "1144880"
  },
  {
    "text": "authentication Handler for aut core that that works really well with seml and then the last thing that's included is",
    "start": "1144880",
    "end": "1150440"
  },
  {
    "text": "uh Chason web tokens uh obviously when you're doing um token based API authentication yeah um then we have the",
    "start": "1150440",
    "end": "1159320"
  },
  {
    "text": "notion of a session right signing in a user signing out a user and so on um there's a whole abstraction for that by",
    "start": "1159320",
    "end": "1165840"
  },
  {
    "text": "default it's implemented on top of cookies right because that's what we do uh in the web um but you can exchange",
    "start": "1165840",
    "end": "1172440"
  },
  {
    "text": "this implementation uh if you want with something server s side um yeah that's boring",
    "start": "1172440",
    "end": "1179799"
  },
  {
    "text": "um that is how you interact with the authentication system so um there there's one service living in a the ey",
    "start": "1179799",
    "end": "1186120"
  },
  {
    "text": "container called the I authentication Service and this implements the five I don't know motions that you typically do",
    "start": "1186120",
    "end": "1193000"
  },
  {
    "text": "in a in a web app yeah you are authenticating someone you're signing someone in that starts the session signing someone out stops the session",
    "start": "1193000",
    "end": "1200200"
  },
  {
    "text": "challenge means you signal The System Authentication is required um forbid",
    "start": "1200200",
    "end": "1206039"
  },
  {
    "text": "means that the user is not allowed to do whatever he's trying to do despite being authenticated yeah which makes it",
    "start": "1206039",
    "end": "1211960"
  },
  {
    "text": "different um than challenge okay so that's that uh we don't need to do this",
    "start": "1211960",
    "end": "1218440"
  },
  {
    "start": "1216000",
    "end": "1258000"
  },
  {
    "text": "um session management yeah so as I said web applications are stateless right so",
    "start": "1218440",
    "end": "1223840"
  },
  {
    "text": "we need to find a way to do State uh in in in um so in with regards to having",
    "start": "1223840",
    "end": "1229720"
  },
  {
    "text": "like authentication sessions this is typically done with the so-called cookie authentication Handler um and it does",
    "start": "1229720",
    "end": "1237000"
  },
  {
    "text": "things you know that that you would expect like you know uh setting the cookie name setting the expiration you know sliding versus absolute um and so",
    "start": "1237000",
    "end": "1245080"
  },
  {
    "text": "on they support same side cookies now out of the box um all of your cookies are same side mode lags which means they",
    "start": "1245080",
    "end": "1252039"
  },
  {
    "text": "are much more resistant against cross-site request fory attacks these days yeah which is really good um",
    "start": "1252039",
    "end": "1259280"
  },
  {
    "text": "and I I'll show you a big demo at the end which brings all these things together um but just to give you an idea",
    "start": "1259280",
    "end": "1265159"
  },
  {
    "text": "how how that session management works is basically you know you authenticated the user somehow or you went to some",
    "start": "1265159",
    "end": "1270679"
  },
  {
    "text": "authentication Service But ultimately you're modeling the identity of the user as a list of claims right that that's",
    "start": "1270679",
    "end": "1277640"
  },
  {
    "text": "the abstraction that they are using um so you're creating a list of claims you put the claims in there like the subject",
    "start": "1277640",
    "end": "1283039"
  },
  {
    "text": "ID and the name and the the email address and so on",
    "start": "1283039",
    "end": "1288840"
  },
  {
    "text": "um then you turn that into a claims identity and then you can associate additional metadata with the",
    "start": "1288840",
    "end": "1295360"
  },
  {
    "text": "authentication session which is not claims but maybe something you want to keep together during the time of the",
    "start": "1295360",
    "end": "1300919"
  },
  {
    "text": "authentication you know maybe you want to store an access token for the user so that whenever this user you know you",
    "start": "1300919",
    "end": "1307039"
  },
  {
    "text": "want to call an API on behalf of that user you just go to the session get the token and use that from there okay and",
    "start": "1307039",
    "end": "1313720"
  },
  {
    "text": "then you know you basically call sign in you pass in this claims principle you pass in the prop properties and that's",
    "start": "1313720",
    "end": "1319520"
  },
  {
    "text": "basically what sets the cookie yeah typically and when you're done with the session you call sign out which then",
    "start": "1319520",
    "end": "1325080"
  },
  {
    "text": "deletes the cookie again okay so do that how that works uh it's pretty simple um",
    "start": "1325080",
    "end": "1331720"
  },
  {
    "start": "1330000",
    "end": "1449000"
  },
  {
    "text": "the cookie Handler has some Advanced features um so for example you can uh tap into the lifetime events like for",
    "start": "1331720",
    "end": "1338039"
  },
  {
    "text": "example that there's an event that gets fired every time the the cookie comes into your application that gives you a",
    "start": "1338039",
    "end": "1343760"
  },
  {
    "text": "chance for example to say like hey even if this user is authenticated is he still a valid user yeah or maybe someone",
    "start": "1343760",
    "end": "1349919"
  },
  {
    "text": "disabled him in in the in the database and now would be the time to you know get rid of this cookie yeah even if the",
    "start": "1349919",
    "end": "1356320"
  },
  {
    "text": "cookie itself would be valid um you can also uh you know another common thing to",
    "start": "1356320",
    "end": "1362440"
  },
  {
    "text": "do is go to the sign out event so that you do can can do some clean up at sign out time yeah maybe you want to get rid",
    "start": "1362440",
    "end": "1368799"
  },
  {
    "text": "of tokens or clean up uh data databases or cashes things like that yeah",
    "start": "1368799",
    "end": "1375440"
  },
  {
    "text": "um and as I said the storage mechanism itself is replaceable so as I said by",
    "start": "1375440",
    "end": "1382240"
  },
  {
    "text": "default they're using cookies but as we all know cookies have certain limitations yeah um so a cookie",
    "start": "1382240",
    "end": "1389880"
  },
  {
    "text": "shouldn't get bigger than 4 kilobytes and uh some you know different browsers have different upper limits how how how",
    "start": "1389880",
    "end": "1397159"
  },
  {
    "text": "much they support per domain and the most problematic One turns out is Safari",
    "start": "1397159",
    "end": "1403360"
  },
  {
    "text": "they only have 8 kilobytes per domain so if you have many applications running on the same domain and they all said",
    "start": "1403360",
    "end": "1408520"
  },
  {
    "text": "cookies you know the last one wins if you are hitting this limit so you should make sure the cookies stay small okay um",
    "start": "1408520",
    "end": "1418120"
  },
  {
    "text": "it's also really hard to to um uh troubleshoot that I can tell you um so",
    "start": "1418120",
    "end": "1424480"
  },
  {
    "text": "one option that actually is fully supported by Microsoft and comes out of the box is just plugging in a red cache",
    "start": "1424480",
    "end": "1430600"
  },
  {
    "text": "instead so that instead of putting all the data into the cookie they just put a guid in the cookie and the guid has a",
    "start": "1430600",
    "end": "1436760"
  },
  {
    "text": "representation in the cache and when the the cookie comes in they get the data from the cach and you know your your",
    "start": "1436760",
    "end": "1442360"
  },
  {
    "text": "application is unaware of that it's happening um in the pipeline so to speak yeah um that's that then let's talk",
    "start": "1442360",
    "end": "1450320"
  },
  {
    "start": "1449000",
    "end": "1504000"
  },
  {
    "text": "about external authentication so external authentication is a special case if you like because now you have to",
    "start": "1450320",
    "end": "1455679"
  },
  {
    "text": "deal with two systems right there's a wire between you and the authentication system so an external authentication",
    "start": "1455679",
    "end": "1462400"
  },
  {
    "text": "process typically looks like first you challenge which means you send the user somewhere else yeah like to Google or to",
    "start": "1462400",
    "end": "1468960"
  },
  {
    "text": "your company's um uh authentication system and then you're waiting for a",
    "start": "1468960",
    "end": "1474240"
  },
  {
    "text": "call back coming back from from this external system and then the call back is doing all of the protocol work to",
    "start": "1474240",
    "end": "1480679"
  },
  {
    "text": "validate what what's coming back validating tokens and so on and so forth yeah again this is completely abstracted",
    "start": "1480679",
    "end": "1487080"
  },
  {
    "text": "you you don't need to know how these things work unless you want to know how these things work yeah which is always a",
    "start": "1487080",
    "end": "1493200"
  },
  {
    "text": "good idea um but again they're just having you know you thought of five methods yeah so challenge is the thing",
    "start": "1493200",
    "end": "1499320"
  },
  {
    "text": "that does the uh the sending away and the call bag is Implement by the Handler as well um and that's a very typical",
    "start": "1499320",
    "end": "1506799"
  },
  {
    "start": "1504000",
    "end": "1537000"
  },
  {
    "text": "configuration if you're connecting to an opad connect based system yeah where you basically have the cookie which is the",
    "start": "1506799",
    "end": "1513679"
  },
  {
    "text": "session management mechanism and then below that you're configuring your open open connect Handler and you know um",
    "start": "1513679",
    "end": "1521600"
  },
  {
    "text": "typically the only really things you need to know here is the so-called Authority which is the Base address of",
    "start": "1521600",
    "end": "1526919"
  },
  {
    "text": "the server uh your CL Cent ID your client secret if you have one and then all of that has been taken care of by",
    "start": "1526919",
    "end": "1533240"
  },
  {
    "text": "the Handler itself um and the very last thing before",
    "start": "1533240",
    "end": "1538440"
  },
  {
    "start": "1537000",
    "end": "1582000"
  },
  {
    "text": "I show you the the how it all works together is API authentication right so",
    "start": "1538440",
    "end": "1544559"
  },
  {
    "text": "Microsoft ship support for Jason web tokens so if you're doing that that's already in the Box um uh there's there's",
    "start": "1544559",
    "end": "1552159"
  },
  {
    "text": "another mechanism for a for token validation which is called introspection",
    "start": "1552159",
    "end": "1557919"
  },
  {
    "text": "which basically means it's not a Chason web token that the the format is proprietary so you contact the token",
    "start": "1557919",
    "end": "1563440"
  },
  {
    "text": "service on a back Channel send that proprietary thing there get the claims back in return that's a standard",
    "start": "1563440",
    "end": "1569000"
  },
  {
    "text": "protocol um that doesn't exist in a minut core I've written a Handler for that um that that you can get under this",
    "start": "1569000",
    "end": "1575480"
  },
  {
    "text": "uh URL here and you can plug that in and make that work as well so that was a little Gap I think",
    "start": "1575480",
    "end": "1581880"
  },
  {
    "text": "okay so let's do this um get rid of this um this guy and this one",
    "start": "1581880",
    "end": "1590240"
  },
  {
    "start": "1582000",
    "end": "2010000"
  },
  {
    "text": "and go here so what we have here basically is is an application which you know um let's go to",
    "start": "1592320",
    "end": "1599240"
  },
  {
    "text": "Startup um is an application you know that uses open body connect uh for",
    "start": "1599240",
    "end": "1605320"
  },
  {
    "text": "authentication and it uses cookies for session management and there's also an API that I want to call so let's run",
    "start": "1605320",
    "end": "1611919"
  },
  {
    "text": "this first to see how that works so you see basically the um from from a",
    "start": "1611919",
    "end": "1617520"
  },
  {
    "text": "programming model point of view um here's a controller on that",
    "start": "1617520",
    "end": "1623480"
  },
  {
    "text": "controller oh yeah I I I should mention that we have we have a a global authorization policy set up here which",
    "start": "1623480",
    "end": "1630120"
  },
  {
    "text": "requires authenticated users so whenever I click something which is protected yeah that the Handler will kick in and",
    "start": "1630120",
    "end": "1636840"
  },
  {
    "text": "will send me to my authentication system so let's do that click on the secure link okay and now I'm sent to some",
    "start": "1636840",
    "end": "1645520"
  },
  {
    "text": "external system that that that is using op connect I log",
    "start": "1645520",
    "end": "1651480"
  },
  {
    "text": "in do some consent here and I'm coming back and remember that the Callback",
    "start": "1651480",
    "end": "1656720"
  },
  {
    "text": "implementation is done in the Handler as well this produces a claims principle for me sets the cookie and now I have",
    "start": "1656720",
    "end": "1662919"
  },
  {
    "text": "the identity of the user available uh in in my application um remember that that",
    "start": "1662919",
    "end": "1670200"
  },
  {
    "text": "I mentioned that there were two parts to it one is the claims and one one is the metadata um of the of the authenticated",
    "start": "1670200",
    "end": "1676279"
  },
  {
    "text": "user so to speak um so the upper part are the claims and you see that that stuff coming from the token service yeah",
    "start": "1676279",
    "end": "1681640"
  },
  {
    "text": "my subject ID my name and my family name and my email address and and these",
    "start": "1681640",
    "end": "1686760"
  },
  {
    "text": "things and when we look at the properties here that is the metadata I mentioned earlier and here you can see",
    "start": "1686760",
    "end": "1693279"
  },
  {
    "text": "that Microsoft internally is using that to do some bookkeeping uh on the session uh and as you can see they don't care",
    "start": "1693279",
    "end": "1699760"
  },
  {
    "text": "too much about cookie sizes yeah because that cookie is pretty big now um but there are ways to optimize that but you",
    "start": "1699760",
    "end": "1705880"
  },
  {
    "text": "see basically they have uh a couple of things in there like um uh for example the tokens right I mean the the the",
    "start": "1705880",
    "end": "1711880"
  },
  {
    "text": "result of that authentication process were tokens these are the artifacts yeah we have an identity token for the",
    "start": "1711880",
    "end": "1717519"
  },
  {
    "text": "session management we have a an access token for the API access and we have refresh token so we can keep this token",
    "start": "1717519",
    "end": "1723799"
  },
  {
    "text": "alive um you know um in the back background and by default as you can see they're just storing all of that in the",
    "start": "1723799",
    "end": "1729960"
  },
  {
    "text": "session um so the typical idea is now when you want to call an API for example",
    "start": "1729960",
    "end": "1737360"
  },
  {
    "text": "yeah all you need to do is um where's my home",
    "start": "1737360",
    "end": "1745120"
  },
  {
    "text": "controller yeah you reach into the session they have an extension method for that on the HP context they just",
    "start": "1745120",
    "end": "1750840"
  },
  {
    "text": "just say get give me give me the token okay and then they you know wherever you",
    "start": "1750840",
    "end": "1755919"
  },
  {
    "text": "store that that's abstract to you you you get back an access token for the current user and then you can use that",
    "start": "1755919",
    "end": "1761919"
  },
  {
    "text": "to to call your API yeah so that's one piece of the puzzle we we can see if",
    "start": "1761919",
    "end": "1767519"
  },
  {
    "text": "this actually works working let's start the API as",
    "start": "1767519",
    "end": "1772679"
  },
  {
    "text": "well yep uh oh I want the",
    "start": "1774600",
    "end": "1780720"
  },
  {
    "text": "browser okay so that's working um so let's have a look at the API real",
    "start": "1782000",
    "end": "1788360"
  },
  {
    "text": "quick so here's the API and you can see here uh we have this chot Bara token",
    "start": "1788360",
    "end": "1795440"
  },
  {
    "text": "Handler uh which again points to the token issuer it says okay my name is called API so only let tokens in with an",
    "start": "1795440",
    "end": "1802120"
  },
  {
    "text": "audience of API and again same idea token comes in Handler does the the heavy lifting for you turns it into a",
    "start": "1802120",
    "end": "1808760"
  },
  {
    "text": "claims principle and the claims principle is is your user object so to speak um um in your controller okay um",
    "start": "1808760",
    "end": "1818960"
  },
  {
    "text": "okay but but there's more so I mentioned here that here here are",
    "start": "1818960",
    "end": "1828120"
  },
  {
    "text": "tokens right and one of the common one of the common problems with token based",
    "start": "1828120",
    "end": "1833399"
  },
  {
    "text": "systems is well they expire right so a token might have a lifetime of 1 hour or",
    "start": "1833399",
    "end": "1838720"
  },
  {
    "text": "you know one minute up to you really yeah but there there will be probably situations where you want to use the",
    "start": "1838720",
    "end": "1845200"
  },
  {
    "text": "token and it's expired so you have to find a way how to refresh that token in the background and get a new one um and",
    "start": "1845200",
    "end": "1851559"
  },
  {
    "text": "that's obviously a security mechanism because that gives us the ability to revoke the tokens right um and there are",
    "start": "1851559",
    "end": "1858200"
  },
  {
    "text": "many many ways how to implement this background um token management um one way for example which",
    "start": "1858200",
    "end": "1866480"
  },
  {
    "text": "I like um is by using Microsoft session management feature yeah",
    "start": "1866480",
    "end": "1873240"
  },
  {
    "text": "so let's see no that's the wrong one yeah here so basically you can tap into",
    "start": "1873240",
    "end": "1879080"
  },
  {
    "text": "the lifetime events as I said of of the session management and one of these events is called validate principle and",
    "start": "1879080",
    "end": "1885360"
  },
  {
    "text": "this is called every time the the the cookie comes in so what I can do now is for example uh look at the tokens in the",
    "start": "1885360",
    "end": "1892679"
  },
  {
    "text": "session get um see if I have a refresh token check the expiration of the",
    "start": "1892679",
    "end": "1897840"
  },
  {
    "text": "current token and if I reach a certain threshold I will under the covers basically refresh the token and exchange",
    "start": "1897840",
    "end": "1904480"
  },
  {
    "text": "the old access token with the new access token in the session and your application code is completely unaware",
    "start": "1904480",
    "end": "1910200"
  },
  {
    "text": "that this happened it just says give me a token give me a token and someone else is working hard under the covers to to",
    "start": "1910200",
    "end": "1916360"
  },
  {
    "text": "keep this token fresh okay um the same thing we can do at sign out time here",
    "start": "1916360",
    "end": "1922880"
  },
  {
    "text": "yeah so when the user is signing out the session gets destroyed uh it would be good security hygiene to revoke that",
    "start": "1922880",
    "end": "1931559"
  },
  {
    "text": "token right you you you don't need it anymore so make sure it's invalid and that's what this piece of code here is",
    "start": "1931559",
    "end": "1937600"
  },
  {
    "text": "doing no so if all of that is working and I talked long enough my token is expired okay so this",
    "start": "1937600",
    "end": "1946600"
  },
  {
    "text": "the AIS token here is expired so when I refresh the page what I what we should see is is that the X token changes also",
    "start": "1946600",
    "end": "1952720"
  },
  {
    "text": "the expires AD should go into the future let's try that oh that was a bad",
    "start": "1952720",
    "end": "1959399"
  },
  {
    "text": "demo um and I can still call my API okay so that that that still works I can",
    "start": "1959399",
    "end": "1965880"
  },
  {
    "text": "guarantee you that it worked because my token only lasted for 60 seconds so I think I talked more than 60 seconds so",
    "start": "1965880",
    "end": "1973600"
  },
  {
    "text": "um but yeah isn't there isn't there a better way to show that to you maybe just refresh the",
    "start": "1973600",
    "end": "1980880"
  },
  {
    "text": "browser nope okay anyways you have to believe me I",
    "start": "1984960",
    "end": "1992240"
  },
  {
    "text": "guess okay so so that is the the whole uh summary of the authentication thing",
    "start": "1992240",
    "end": "1998039"
  },
  {
    "text": "yeah handlers the authentication Service session management external authentication API access that's the",
    "start": "1998039",
    "end": "2004679"
  },
  {
    "text": "whole package yeah and shut that down so next topic authorization so now",
    "start": "2004679",
    "end": "2014080"
  },
  {
    "start": "2010000",
    "end": "2151000"
  },
  {
    "text": "you know who the user is now you want to find out what is this guy allowed to do now um it turns out it was really easy",
    "start": "2014080",
    "end": "2021519"
  },
  {
    "text": "for Microsoft to to innovate in this area because they had nothing before so everything is better",
    "start": "2021519",
    "end": "2027840"
  },
  {
    "text": "um so I've been giving feedback for a long long time to the asp.net team that their",
    "start": "2027840",
    "end": "2034760"
  },
  {
    "text": "authorization story is really bad and I I have seen so many homegrown implementations of all the things and um",
    "start": "2034760",
    "end": "2042399"
  },
  {
    "text": "it it kind of helped that a good friend of mine joined the asp.net team recently well not recently a couple years ago as",
    "start": "2042399",
    "end": "2048760"
  },
  {
    "text": "the security PM so finally somebody was listening to me no um so a couple of",
    "start": "2048760",
    "end": "2055200"
  },
  {
    "text": "couple of observations yeah the way many people did authorization is using uh was",
    "start": "2055200",
    "end": "2061000"
  },
  {
    "text": "using the authorize attribute right and and that led to really bad code maintainability having all of these",
    "start": "2061000",
    "end": "2066760"
  },
  {
    "text": "attributes sprinkl you know authorization logic and business logic in the same place because",
    "start": "2066760",
    "end": "2072800"
  },
  {
    "text": "it was so limited people wrote their own authorization attributes and guess what you have to know the magic key strokes",
    "start": "2072800",
    "end": "2079440"
  },
  {
    "text": "to make this work yeah because you have to know do I call the base class first or do I call it afterwards and uh it",
    "start": "2079440",
    "end": "2085919"
  },
  {
    "text": "turns out in code reviews even internally at Microsoft many teams have implemented the authorization attribute",
    "start": "2085919",
    "end": "2092200"
  },
  {
    "text": "in the wrong way and they produced security problems yeah so one of the",
    "start": "2092200",
    "end": "2097760"
  },
  {
    "text": "goals was well a couple of goals here first first goal is separate the authorization logic from the business",
    "start": "2097760",
    "end": "2103200"
  },
  {
    "text": "logic don't allow custom authorized attributes anymore um and my favorite",
    "start": "2103200",
    "end": "2110320"
  },
  {
    "text": "one is make it testable right I want to write some tests to verify that my",
    "start": "2110320",
    "end": "2115560"
  },
  {
    "text": "authorization rules actually work okay which is a good thing",
    "start": "2115560",
    "end": "2120720"
  },
  {
    "text": "um it's a huge topic okay and if you are if you want to learn more about that go go to this website here that's the guy",
    "start": "2120720",
    "end": "2127240"
  },
  {
    "text": "um bar Doren from um um from Microsoft he is the owner of that system he wrote",
    "start": "2127240",
    "end": "2134359"
  },
  {
    "text": "a little workshop thing that you can follow along it's it's pretty good um so",
    "start": "2134359",
    "end": "2140240"
  },
  {
    "text": "there there are logically two things here one is called policy based authorization one is called resource-based authorization um they are",
    "start": "2140240",
    "end": "2147480"
  },
  {
    "text": "slightly different ways to look into things let's let's have a look at policies first so the idea with policies",
    "start": "2147480",
    "end": "2153160"
  },
  {
    "start": "2151000",
    "end": "2202000"
  },
  {
    "text": "is is that you're defining a so-called authorization policy and with that is really a list of so-called requirements",
    "start": "2153160",
    "end": "2160119"
  },
  {
    "text": "so you know to manage a customer you need to be authenticated you need to be in the sales department and you have",
    "start": "2160119",
    "end": "2165880"
  },
  {
    "text": "need to have a status of senior okay that's the that's the policy and then you can still use the authorized",
    "start": "2165880",
    "end": "2172599"
  },
  {
    "text": "attribute if you want to um but then you just pass in the name of the policy and",
    "start": "2172599",
    "end": "2177880"
  },
  {
    "text": "that will every time somebody calls that method the policy will get executed okay",
    "start": "2177880",
    "end": "2183040"
  },
  {
    "text": "so two things here first of all separation of concerns if you have to change the policy you don't have to",
    "start": "2183040",
    "end": "2188240"
  },
  {
    "text": "change your controllers they just get that",
    "start": "2188240",
    "end": "2192838"
  },
  {
    "text": "um I think that's it that's my oh yeah and and and you separate these things",
    "start": "2193319",
    "end": "2199240"
  },
  {
    "text": "from from each other okay um the next thing which I actually even",
    "start": "2199240",
    "end": "2204880"
  },
  {
    "start": "2202000",
    "end": "2269000"
  },
  {
    "text": "prefer is you can also programmatically talk to the authorization system without having to use the authorized attribute",
    "start": "2204880",
    "end": "2211079"
  },
  {
    "text": "right so there there's an ey authorization service in in the DI container you can get a hold of that you",
    "start": "2211079",
    "end": "2217200"
  },
  {
    "text": "uh call authorize a sync on it you pass in the claims principle you want to run the authorization rules against which is",
    "start": "2217200",
    "end": "2224000"
  },
  {
    "text": "actually a pretty powerful feature it can be your current user it can be also a different user in the system that you",
    "start": "2224000",
    "end": "2230280"
  },
  {
    "text": "want to authorize against yeah think of admin portals and other things yeah um and then you pass in the name of the",
    "start": "2230280",
    "end": "2236440"
  },
  {
    "text": "policy and you get back basically a true or false and this is also the key to testability you can now write tests that",
    "start": "2236440",
    "end": "2243920"
  },
  {
    "text": "create claims principles of certain shapes yeah like different types of users you have in the system you run it",
    "start": "2243920",
    "end": "2249760"
  },
  {
    "text": "through the policy and you make sure it's returning the expected results and if someone you know six six months down",
    "start": "2249760",
    "end": "2255960"
  },
  {
    "text": "the line changes your code he will get immediate feedback if he broke any of the policies for example yeah which I",
    "start": "2255960",
    "end": "2262319"
  },
  {
    "text": "think is really really important um what else do we have oh yeah",
    "start": "2262319",
    "end": "2268880"
  },
  {
    "text": "um one issue I have here is um which is more like a perception issue um this",
    "start": "2268880",
    "end": "2275520"
  },
  {
    "start": "2269000",
    "end": "2314000"
  },
  {
    "text": "this kind of gives you the impression to use this authorization system you need to have claims for everything right a claim for this and a claim for that and",
    "start": "2275520",
    "end": "2281720"
  },
  {
    "text": "a claim for you know everything um it's very tempting to do that right because you have this shiny new hammer and",
    "start": "2281720",
    "end": "2288480"
  },
  {
    "text": "everything becomes a nail suddenly um but you should you know claims describe the identity of the user not what he's",
    "start": "2288480",
    "end": "2295400"
  },
  {
    "text": "allowed to do identity should be the input to the authorization system yeah and the output should be the",
    "start": "2295400",
    "end": "2301680"
  },
  {
    "text": "authorization decision yeah so um most",
    "start": "2301680",
    "end": "2306720"
  },
  {
    "text": "documentation you see give you the impression that's how it works and then people start modeling everything as a claim which I think isn't a good fit",
    "start": "2306720",
    "end": "2313480"
  },
  {
    "text": "yeah so it turns out you can write your own requirements okay so um um this one",
    "start": "2313480",
    "end": "2320480"
  },
  {
    "start": "2314000",
    "end": "2369000"
  },
  {
    "text": "is a chop requirement yeah so maybe imagine you have a controller that should only be available to managers",
    "start": "2320480",
    "end": "2327240"
  },
  {
    "text": "okay pretty boring example but you know that's how it is um and basically what",
    "start": "2327240",
    "end": "2332480"
  },
  {
    "text": "you can do is you can write your own Handler uh in the system that gets called at runtime they pass you in the",
    "start": "2332480",
    "end": "2338720"
  },
  {
    "text": "details of the requirement and then you can do whatever you want whatever logic you want to run to to to determine if",
    "start": "2338720",
    "end": "2345599"
  },
  {
    "text": "this user is allowed or not and you see this IE organization service I have here in the Constructor since these things",
    "start": "2345599",
    "end": "2351440"
  },
  {
    "text": "live in the DI container you can have arbitrary other dependencies uh from the DI container to abstract your data",
    "start": "2351440",
    "end": "2357800"
  },
  {
    "text": "access right and that again helps with testability yeah so you can have an I you know like a mock organization",
    "start": "2357800",
    "end": "2363720"
  },
  {
    "text": "service and the real one goes to your database or to your API so whatever so that's quite",
    "start": "2363720",
    "end": "2369280"
  },
  {
    "start": "2369000",
    "end": "2399000"
  },
  {
    "text": "cool um the second one is called resource-based authorization and the",
    "start": "2369280",
    "end": "2374440"
  },
  {
    "text": "idea is you know like the policies only look at who is the user right um whereas the resource-based authorization adds",
    "start": "2374440",
    "end": "2382000"
  },
  {
    "text": "one more Dimension to it basically which says and what is he trying to manipulate",
    "start": "2382000",
    "end": "2387520"
  },
  {
    "text": "in the system okay so uh imagine you have you you're writing some sort of customer management thing so you have",
    "start": "2387520",
    "end": "2393400"
  },
  {
    "text": "customers and contracts and orders for example yeah so you would abstract the weigh all of your objects into so-called",
    "start": "2393400",
    "end": "2400040"
  },
  {
    "start": "2399000",
    "end": "2420000"
  },
  {
    "text": "authorization handlers one for customers one for orders and one for contracts I guess and then you know uh you could",
    "start": "2400040",
    "end": "2407280"
  },
  {
    "text": "encapsulate that in your uh in these handlers when you then call them the",
    "start": "2407280",
    "end": "2412599"
  },
  {
    "text": "Handler gets to see the actual instance of the resource the user is trying to manipulate and then you know you can do",
    "start": "2412599",
    "end": "2418680"
  },
  {
    "text": "authorization rules based on that you know and then you could call it something like this right uh you update",
    "start": "2418680",
    "end": "2424920"
  },
  {
    "start": "2420000",
    "end": "2551000"
  },
  {
    "text": "a document you call authorize a sync you pass in the user you pass in the document he's trying to update in this",
    "start": "2424920",
    "end": "2431400"
  },
  {
    "text": "case right and then you know maybe the the rule is you can only update documents that you've written in the",
    "start": "2431400",
    "end": "2436599"
  },
  {
    "text": "first place right and that's something you can now encapsulate in in that system so again um a pretty big",
    "start": "2436599",
    "end": "2443880"
  },
  {
    "text": "Improvement um and maybe saves you from writing your own you know custom",
    "start": "2443880",
    "end": "2449760"
  },
  {
    "text": "system okay I think I have a demo for that as well yeah so that's um",
    "start": "2449760",
    "end": "2459240"
  },
  {
    "text": "you see here I'm I'm I'm having a couple of um authorization rules here uh one is",
    "start": "2459400",
    "end": "2465119"
  },
  {
    "text": "basically saying yeah something that only salese can do apparently yeah some something that only sales senior people",
    "start": "2465119",
    "end": "2470960"
  },
  {
    "text": "can do and something only the dev interns are allowed to do yeah um and you see here is also an example of a you",
    "start": "2470960",
    "end": "2476880"
  },
  {
    "text": "know required job level it must be a cxo type of person um to actually you know",
    "start": "2476880",
    "end": "2482640"
  },
  {
    "text": "be allowed to do this yeah and then and then you can go to your um controllers",
    "start": "2482640",
    "end": "2488280"
  },
  {
    "text": "or or to your code rather um where am I oh yeah yeah and um",
    "start": "2488280",
    "end": "2495560"
  },
  {
    "text": "annotate um your actions with these things obviously you wouldn't use strings here but constants and so on",
    "start": "2495560",
    "end": "2501520"
  },
  {
    "text": "here's an example how to do it imperatively as opposed to um declaratively yeah um yeah so when I run",
    "start": "2501520",
    "end": "2509560"
  },
  {
    "text": "that I have a couple of different users I think Alis is a",
    "start": "2509560",
    "end": "2515480"
  },
  {
    "text": "salesperson okay yes she is sales yeah so if Alice tries to do something that",
    "start": "2515480",
    "end": "2521040"
  },
  {
    "text": "only sales people can do that's allowed um if she tries to do something that only sales senior people can do that",
    "start": "2521040",
    "end": "2528200"
  },
  {
    "text": "should work as well yep and but if she tries to do the DEA intern thing like play the Xbox or",
    "start": "2528200",
    "end": "2534520"
  },
  {
    "text": "something then it's X denied okay so yeah that that's just you know",
    "start": "2534520",
    "end": "2541599"
  },
  {
    "text": "um a quick uh uh glimpse into that obviously there is much more to learn",
    "start": "2541599",
    "end": "2547640"
  },
  {
    "text": "about these things but you know it's meant to be an overview the next thing you should be",
    "start": "2547640",
    "end": "2553680"
  },
  {
    "start": "2551000",
    "end": "2680000"
  },
  {
    "text": "aware of if you're designing a system with asp.net is called asp.net identity it's Microsoft's user management library",
    "start": "2553680",
    "end": "2560640"
  },
  {
    "text": "and it it has been around for many years and the first couple of versions were not that great to be honest yeah we gave",
    "start": "2560640",
    "end": "2566520"
  },
  {
    "text": "a lot of feedback and uh it took a long time but with the latest version or the the latest two versions I think it's",
    "start": "2566520",
    "end": "2573240"
  },
  {
    "text": "pretty solid it's pretty good and it saves you a ton of work if you have to",
    "start": "2573240",
    "end": "2579359"
  },
  {
    "text": "build a a a an account management system like with names and passwords you know",
    "start": "2579359",
    "end": "2585839"
  },
  {
    "text": "imagine all the complexity here creating the user creating the password saving them storing them securely resetting",
    "start": "2585839",
    "end": "2592800"
  },
  {
    "text": "passwords changing passwords email confirmation multiactor authentication you know all the things you have to do",
    "start": "2592800",
    "end": "2598920"
  },
  {
    "text": "um it's all in there and it's you know it's been reviewed by security people and it it follows best practices and and",
    "start": "2598920",
    "end": "2605200"
  },
  {
    "text": "so on so if you have the luxury of building your own user database right most people I know already have one okay",
    "start": "2605200",
    "end": "2612440"
  },
  {
    "text": "so but if you have two well luxury is maybe the wrong word then but if you really have to um I would totally",
    "start": "2612440",
    "end": "2618960"
  },
  {
    "text": "recommend using this Library yeah um I even have customers that slowly migrate",
    "start": "2618960",
    "end": "2624800"
  },
  {
    "text": "you know like on the login page user comes in he logs in they first check the old database if the user exists they",
    "start": "2624800",
    "end": "2630000"
  },
  {
    "text": "migrate him over to the new database using this just to get the benefits of all the extra things like as I said",
    "start": "2630000",
    "end": "2636079"
  },
  {
    "text": "changing passwords setting passwords you know all the the ceremony around that sending emails with tokens clicking a",
    "start": "2636079",
    "end": "2642520"
  },
  {
    "text": "link coming back you know it's a lot of work okay um",
    "start": "2642520",
    "end": "2649760"
  },
  {
    "text": "so the last missing piece so to speak is yeah so Microsoft has um Microsoft has",
    "start": "2649839",
    "end": "2655160"
  },
  {
    "text": "this AIT core that's great yeah they have an identity um management Library that's",
    "start": "2655160",
    "end": "2662480"
  },
  {
    "text": "great too the only thing they were missing is basically now is there a you know can we now participate in token",
    "start": "2662480",
    "end": "2668359"
  },
  {
    "text": "based authentication in the sense of issuing tokens so that we can secure apis and that was always missing or they",
    "start": "2668359",
    "end": "2675520"
  },
  {
    "text": "they they had a couple of attempts to do that but they finally came to their census and uh talk to the right people I",
    "start": "2675520",
    "end": "2681640"
  },
  {
    "text": "guess so um that's the the only new thing I can really show you because it's",
    "start": "2681640",
    "end": "2686680"
  },
  {
    "text": "the only new thing right now is starting with uh net core or aset core Freo",
    "start": "2686680",
    "end": "2691880"
  },
  {
    "text": "preview free um whenever you are doing API Authentication yeah like in the API",
    "start": "2691880",
    "end": "2698319"
  },
  {
    "text": "template or in the spa template whatever they now incorporate um identity server the thing I'm working on uh in the",
    "start": "2698319",
    "end": "2705359"
  },
  {
    "text": "templates so and and the idea was I mean you know you could do that since forever",
    "start": "2705359",
    "end": "2710480"
  },
  {
    "text": "but the idea is now that um this makes it easier for you for you to get started because there is a certain amount of",
    "start": "2710480",
    "end": "2716000"
  },
  {
    "text": "configuration you have to do in in identity server and uh and that these are just keystrokes right but you you",
    "start": "2716000",
    "end": "2722240"
  },
  {
    "text": "need to know why you're doing it now and um the idea of Microsoft is",
    "start": "2722240",
    "end": "2728200"
  },
  {
    "text": "you know what while I'm talking I should load this um the idea is that basically",
    "start": "2728200",
    "end": "2733760"
  },
  {
    "text": "you get a file new project experience it has an API in it it has a spa in it it",
    "start": "2733760",
    "end": "2738920"
  },
  {
    "text": "has identity server in it um the spa is set up to do open connect and oarf to",
    "start": "2738920",
    "end": "2743960"
  },
  {
    "text": "get a token and to use this token to access um your apis",
    "start": "2743960",
    "end": "2750400"
  },
  {
    "text": "um and you are automatically following the best practices thing you don't you",
    "start": "2750400",
    "end": "2756559"
  },
  {
    "text": "know come up with your own security uh infrastructure you don't try to abuse cookies for things that they are not",
    "start": "2756559",
    "end": "2761599"
  },
  {
    "text": "meant to um and then you can grow from there yeah obviously a single project",
    "start": "2761599",
    "end": "2767880"
  },
  {
    "text": "containing everything is not really realistic but you know if if you just just want to get started that's good and",
    "start": "2767880",
    "end": "2773960"
  },
  {
    "text": "then you can start separating the things that separate the API from the UI and you know and so on",
    "start": "2773960",
    "end": "2780880"
  },
  {
    "text": "so you wouldn't believe how long it took Microsoft to finally accept the fact",
    "start": "2780880",
    "end": "2786040"
  },
  {
    "text": "that maybe an open source Source solution is the better one than building it themselves yeah um and we had many",
    "start": "2786040",
    "end": "2792440"
  },
  {
    "text": "many discussions with them and one of the the main things is Microsoft wants to have it in zero",
    "start": "2792440",
    "end": "2798559"
  },
  {
    "text": "config okay so basically no one needs to understand what what they're actually doing just press F5 um so let's have a",
    "start": "2798559",
    "end": "2806079"
  },
  {
    "text": "look at that so that's the new angular template in uh oh that's the new angular",
    "start": "2806079",
    "end": "2812160"
  },
  {
    "text": "template um so they they will have a couple of templates they're using that the first one is the angular one and the",
    "start": "2812160",
    "end": "2817200"
  },
  {
    "text": "react one I'm pretty sure there will be a Placer one at some point um and the A and the the web API ones as well so you",
    "start": "2817200",
    "end": "2824119"
  },
  {
    "text": "can see here basically what they're doing is they're just bringing the pieces together really so here is where",
    "start": "2824119",
    "end": "2829240"
  },
  {
    "text": "they add their default UI for registering users for logging in for logging out all these things right um",
    "start": "2829240",
    "end": "2836359"
  },
  {
    "text": "this and basically now they are marrying this together with identity server and here's the magic extension method that",
    "start": "2836359",
    "end": "2843599"
  },
  {
    "text": "that Microsoft wrote yeah which is the zero config one okay so under the covers they're wiring up all the things now the",
    "start": "2843599",
    "end": "2849040"
  },
  {
    "text": "keys the clients the resources and everything okay so let's run",
    "start": "2849040",
    "end": "2859160"
  },
  {
    "text": "it it's actually amazing how much work is needed to run an angular application these",
    "start": "2860359",
    "end": "2866599"
  },
  {
    "text": "days look at that compiling stuff it's also amazing I when you",
    "start": "2866599",
    "end": "2874079"
  },
  {
    "text": "create this template and you run it for the very first time it does an mpm restore so it has 60,000",
    "start": "2874079",
    "end": "2880119"
  },
  {
    "text": "files it's complete Madness yeah um anyways so oh I'm logged",
    "start": "2880119",
    "end": "2888920"
  },
  {
    "text": "in okay so you see basically you you get this uh basic template here when you click register it just goes to a",
    "start": "2890280",
    "end": "2896760"
  },
  {
    "text": "register page I guess that's not exciting uh when you click uh login they do a couple of clever things",
    "start": "2896760",
    "end": "2903839"
  },
  {
    "text": "here so basically they also took our Javas script client library and wrap that up as a angular component and as a",
    "start": "2903839",
    "end": "2910800"
  },
  {
    "text": "react component so when you press login what they first try to do is open a popup yeah and the idea is um if you get",
    "start": "2910800",
    "end": "2917960"
  },
  {
    "text": "away with a popup then you don't have to reload all of your state in your spa when you come back from the",
    "start": "2917960",
    "end": "2923319"
  },
  {
    "text": "authentication server which is often a point of criticism right that you have to go to another site and come back and",
    "start": "2923319",
    "end": "2928960"
  },
  {
    "text": "depending on how complex your state is you need to store it somewhere and it takes long time and so on so they first",
    "start": "2928960",
    "end": "2935720"
  },
  {
    "text": "try to do a popup if the popup is not allowed maybe on a mobile device or maybe because of a popup blocker then",
    "start": "2935720",
    "end": "2941839"
  },
  {
    "text": "they do the the the front Channel redirect to the server and come back to you switch um you know I think you can",
    "start": "2941839",
    "end": "2948280"
  },
  {
    "text": "configure it but I think that was that made sense to me I mean I don't know anything about front end development but it looked it sounded",
    "start": "2948280",
    "end": "2955319"
  },
  {
    "text": "reasonable okay so I can log in now identity server under the covers",
    "start": "2955319",
    "end": "2960960"
  },
  {
    "text": "it's doing all its magic it's validating the the request and the and the user and uh creating tokens and so on so now",
    "start": "2960960",
    "end": "2968880"
  },
  {
    "text": "basically all we need to do now is um write apis right here's a controller now",
    "start": "2968880",
    "end": "2974480"
  },
  {
    "text": "hold on where is",
    "start": "2974480",
    "end": "2977359"
  },
  {
    "text": "my oh yeah sample data controller sorry here it is okay so all you have to do basically is just put the authorized",
    "start": "2980440",
    "end": "2986359"
  },
  {
    "text": "attribute there and the the client side will now send the access token um and yeah and we get finally",
    "start": "2986359",
    "end": "2995520"
  },
  {
    "text": "that the values controller gone we now get better data exciting",
    "start": "2995520",
    "end": "3001880"
  },
  {
    "text": "H okay so that's a a quick preview I mean you can play around with these",
    "start": "3001880",
    "end": "3006960"
  },
  {
    "text": "things today you have to you have to install AET core preview free for that uh 3.0 preview free with Visual Studio",
    "start": "3006960",
    "end": "3014680"
  },
  {
    "text": "2019 which I think will next week go RTM um so it's pretty you know it's",
    "start": "3014680",
    "end": "3021640"
  },
  {
    "text": "happening soon okay um there are more plans around this",
    "start": "3021640",
    "end": "3027359"
  },
  {
    "text": "feature area than just doing the spa template um think of microservice architectures where you have many apis",
    "start": "3027359",
    "end": "3034280"
  },
  {
    "text": "talking to other apis um so uh we will work on things like separating the apis",
    "start": "3034280",
    "end": "3040000"
  },
  {
    "text": "from the identity server deploying them in different ways but also a really interesting thing where we will do is uh",
    "start": "3040000",
    "end": "3047280"
  },
  {
    "text": "imagine you're bringing up a new API and uh normally you would now need to go to Identity server register the API",
    "start": "3047280",
    "end": "3053040"
  },
  {
    "text": "configure to which resources the API has access to and all these things so so there's a protocol called Dynamic client",
    "start": "3053040",
    "end": "3059640"
  },
  {
    "text": "registration um which which we never implemented but now is the time I guess so that basically you can have an",
    "start": "3059640",
    "end": "3065400"
  },
  {
    "text": "architecture where you bring up the API the API goes to Identity server registers itself okay so no",
    "start": "3065400",
    "end": "3071119"
  },
  {
    "text": "configuration required at the token service for the new API and immediately is able to get tokens from the token",
    "start": "3071119",
    "end": "3077440"
  },
  {
    "text": "server and can talk to apis okay so that's pretty much um it what time do we",
    "start": "3077440",
    "end": "3084760"
  },
  {
    "text": "have any questions have8 minutes left do you have any",
    "start": "3084760",
    "end": "3090480"
  },
  {
    "text": "questions no I have stickers not many to be honest yeah",
    "start": "3091119",
    "end": "3098000"
  },
  {
    "text": "normally I always forget to bring them up this time I even forgot to bring them here so but but but I I have a couple",
    "start": "3098000",
    "end": "3104440"
  },
  {
    "text": "okay so if if you want them um otherwise thanks for your time and um have a nice",
    "start": "3104440",
    "end": "3109880"
  },
  {
    "text": "day",
    "start": "3109880",
    "end": "3112880"
  }
]