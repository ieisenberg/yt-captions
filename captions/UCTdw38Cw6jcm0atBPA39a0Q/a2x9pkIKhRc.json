[
  {
    "text": "okay",
    "start": "0",
    "end": "3000"
  },
  {
    "text": "hello hello hi everyone welcome",
    "start": "5839",
    "end": "11160"
  },
  {
    "text": "to NDC security this is my first talk here and you are in the GitHub action",
    "start": "11160",
    "end": "18060"
  },
  {
    "text": "stock um I'm lucky that I got this talk after",
    "start": "18060",
    "end": "24240"
  },
  {
    "text": "lunch so hopefully you're okay on food but if you feel sleepy don't worry I'll",
    "start": "24240",
    "end": "32820"
  },
  {
    "text": "try to speak loud and give some demos so make this uh entertaining as much as",
    "start": "32820",
    "end": "37980"
  },
  {
    "text": "possible um this talk is about GitHub actions vulnerabilities attacks and",
    "start": "37980",
    "end": "44100"
  },
  {
    "text": "countermeasures right so this is part of a research that I've done last year on",
    "start": "44100",
    "end": "50340"
  },
  {
    "text": "uh GitHub actions and that's what I'm gonna talk about today we're gonna see some uh overview of GitHub actions some",
    "start": "50340",
    "end": "58199"
  },
  {
    "text": "security issues and then we'll dive deep into the attacks and of course uh since",
    "start": "58199",
    "end": "63600"
  },
  {
    "text": "these developers conference I'll provide some recommendations or best practices",
    "start": "63600",
    "end": "69119"
  },
  {
    "text": "there so yeah my name is Magna Logan I've been",
    "start": "69119",
    "end": "75360"
  },
  {
    "text": "in information security for over 12 years now information security specialists at Trend Micro in Canada and",
    "start": "75360",
    "end": "82979"
  },
  {
    "text": "Senior threat researcher whatever that means um but basically I do research",
    "start": "82979",
    "end": "88380"
  },
  {
    "text": "around cloud and containers security Technologies so things like kubernetes",
    "start": "88380",
    "end": "95159"
  },
  {
    "text": "um GitHub actions Docker Jenkins everything that's related to the cloud",
    "start": "95159",
    "end": "100680"
  },
  {
    "text": "different services from cloud providers as well we try to analyze those we do some threat modeling we find some issues",
    "start": "100680",
    "end": "108240"
  },
  {
    "text": "can be just misconfigurations or even zero days we have something very",
    "start": "108240",
    "end": "113880"
  },
  {
    "text": "interesting coming up in the next few months and and that's that's what we do we we publish we write blogs we present",
    "start": "113880",
    "end": "121079"
  },
  {
    "text": "a conference like this one and we try to promote this uh best practice of",
    "start": "121079",
    "end": "126899"
  },
  {
    "text": "security kind of raise the awareness and of course help the community and help our customers as well",
    "start": "126899",
    "end": "134340"
  },
  {
    "text": "my background is as a developer I have a dark side a dark past I was a Java",
    "start": "134340",
    "end": "140160"
  },
  {
    "text": "developer so I have to assume that um but yeah right now mostly I use",
    "start": "140160",
    "end": "145860"
  },
  {
    "text": "Python and still learning go to to do my automation there um I also teach secure coding and",
    "start": "145860",
    "end": "153420"
  },
  {
    "text": "devsecops uh since 2011 and and that's uh the",
    "start": "153420",
    "end": "158819"
  },
  {
    "text": "company that I'm part of they're back in Brazil so I teach this course secure",
    "start": "158819",
    "end": "165000"
  },
  {
    "text": "coding and devsecops a 40 40 hour course uh we're we're launching this year this",
    "start": "165000",
    "end": "170819"
  },
  {
    "text": "course is online so we're launching that in English as well so if your interest just uh feel free to reach out to me if",
    "start": "170819",
    "end": "177840"
  },
  {
    "text": "you want to learn more about this the program what we teach we talk about different tools static analysis Dynamic",
    "start": "177840",
    "end": "184739"
  },
  {
    "text": "analysis software compositionalism all that stuff but yeah just reach out to me later and we can talk more about it",
    "start": "184739",
    "end": "193159"
  },
  {
    "text": "since I've been doing this for a while and given the",
    "start": "193200",
    "end": "199080"
  },
  {
    "text": "situation in the world right now um I just want to say that",
    "start": "199080",
    "end": "204420"
  },
  {
    "text": "I always try to give back to the community and I've been involved with many organizations such as oasp and the",
    "start": "204420",
    "end": "212159"
  },
  {
    "text": "cncf the cloud native Computing Foundation doing volunteer work and",
    "start": "212159",
    "end": "218340"
  },
  {
    "text": "um one of the things that I do is I help people doing uh resume reviews and mock",
    "start": "218340",
    "end": "224940"
  },
  {
    "text": "interviews so if you got laid off or if you're changing careers if you're looking for another opportunity and",
    "start": "224940",
    "end": "231900"
  },
  {
    "text": "you'd like me to take a look at your resume I can give you my feedback provide some comments some",
    "start": "231900",
    "end": "237720"
  },
  {
    "text": "recommendations I know that the structure of the resume might be different for Europe than it is for",
    "start": "237720",
    "end": "243120"
  },
  {
    "text": "Canada in the US but that's fine um and I also do three more mock",
    "start": "243120",
    "end": "248640"
  },
  {
    "text": "interviews so like I put myself in the role of the interviewer and I interview",
    "start": "248640",
    "end": "253860"
  },
  {
    "text": "you mostly on the technical side to understand if you're prepared for a real",
    "start": "253860",
    "end": "259859"
  },
  {
    "text": "technical interview so if you want to do that also just reach out to me I don't charge anything this kind of my uh my",
    "start": "259859",
    "end": "267600"
  },
  {
    "text": "way to give back to the community one of the ways one of the volunteer works that I do",
    "start": "267600",
    "end": "273860"
  },
  {
    "text": "also this stock is not about GitHub code spaces that's another topic but we just",
    "start": "274740",
    "end": "281100"
  },
  {
    "text": "launched an article today uh today no yes two days ago actually about GitHub",
    "start": "281100",
    "end": "287280"
  },
  {
    "text": "code spaces some of the new research that we're doing uh me and my friend nitesh from our research team so if you",
    "start": "287280",
    "end": "294419"
  },
  {
    "text": "want to take a look at that um that's the the QR code or the URL will take you to this article on the",
    "start": "294419",
    "end": "301080"
  },
  {
    "text": "Trend Micro website so this is the agenda that we have today",
    "start": "301080",
    "end": "308160"
  },
  {
    "text": "what is GitHub actions who here has played or has used GitHub actions before",
    "start": "308160",
    "end": "315180"
  },
  {
    "text": "oh wow that's good nice okay so we're gonna talk about understand what it is how you play",
    "start": "315180",
    "end": "322380"
  },
  {
    "text": "around with it so I want I won't spend too much time on the introduction but then we're gonna see how attackers cyber",
    "start": "322380",
    "end": "331680"
  },
  {
    "text": "criminals are abusing the runners which are the servers that run your automation",
    "start": "331680",
    "end": "337400"
  },
  {
    "text": "on the GitHub action which basically runs on azure we're going to create a malicious action",
    "start": "337400",
    "end": "346860"
  },
  {
    "text": "so we're going to create an action that anyone could be uh using or leveraging",
    "start": "346860",
    "end": "352919"
  },
  {
    "text": "that if I publish to the marketplace which basically is a place that GitHub has anyone can publish your action and",
    "start": "352919",
    "end": "360539"
  },
  {
    "text": "what's going to happen if someone uses that malicious action there are some other attacks once I'm inside the",
    "start": "360539",
    "end": "367199"
  },
  {
    "text": "environment once I'm inside the Azure Cloud because that's basically a VM",
    "start": "367199",
    "end": "372900"
  },
  {
    "text": "that's run run on on runs on Azure what can I do there what else can I exploit",
    "start": "372900",
    "end": "378960"
  },
  {
    "text": "right so we're gonna see that as well and of course at the end talk a little bit about the sum of the countermeasures",
    "start": "378960",
    "end": "385620"
  },
  {
    "text": "some of the things that are in place that GitHub has uh improved over the",
    "start": "385620",
    "end": "390660"
  },
  {
    "text": "years this is a fairly new service it was launched 2019 but there were given",
    "start": "390660",
    "end": "396060"
  },
  {
    "text": "the mass exploitation and exploration by cyber criminals there are there has been",
    "start": "396060",
    "end": "401520"
  },
  {
    "text": "some improvement that needed to be done",
    "start": "401520",
    "end": "405979"
  },
  {
    "text": "feel free to ask questions um don't mind interruptions see it's I think it's better to ask the questions",
    "start": "407580",
    "end": "413460"
  },
  {
    "text": "while I'm explaining the topic than to go back at the end so just raise your hand and you can ask your questions",
    "start": "413460",
    "end": "420479"
  },
  {
    "text": "so on this topic for this talk there are two articles that have been published",
    "start": "420479",
    "end": "425699"
  },
  {
    "text": "last year one in January and another one in July just uh the links are there",
    "start": "425699",
    "end": "431460"
  },
  {
    "text": "sorry I didn't make the kind of the short links there forgot about it but basically there's more details more",
    "start": "431460",
    "end": "437520"
  },
  {
    "text": "description if something I missed here in this talk you can just take a look there and there is some special thanks",
    "start": "437520",
    "end": "444360"
  },
  {
    "text": "there for people that helped me during this research so yeah that's that",
    "start": "444360",
    "end": "450360"
  },
  {
    "text": "moving on what is GitHub actions",
    "start": "450360",
    "end": "456599"
  },
  {
    "text": "basically a Ci cd2 or CI service provided by GitHub right so",
    "start": "456599",
    "end": "464520"
  },
  {
    "text": "if you use Jenkins before it's basically the of course I'm simplifying this but",
    "start": "464520",
    "end": "470880"
  },
  {
    "text": "it's the the GitHub version of Jenkins with of course some improvements there",
    "start": "470880",
    "end": "477479"
  },
  {
    "text": "you don't need to run a separate server like Jenkins to do your automation to do",
    "start": "477479",
    "end": "483180"
  },
  {
    "text": "your CI so if you want to build stuff run some testing you can run security",
    "start": "483180",
    "end": "488520"
  },
  {
    "text": "testing as well static analysis Dynamic analysis whatever you want you can do",
    "start": "488520",
    "end": "493740"
  },
  {
    "text": "everything inside GitHub and it's available for free",
    "start": "493740",
    "end": "498780"
  },
  {
    "text": "so if you have a GitHub account today you can do that on your own repo you can do some Automation and you can even",
    "start": "498780",
    "end": "505740"
  },
  {
    "text": "create like a devsecops pipeline I have a repository that does exactly that it",
    "start": "505740",
    "end": "511740"
  },
  {
    "text": "runs some security tools for you all you have to do is just call this uh GitHub action",
    "start": "511740",
    "end": "518700"
  },
  {
    "text": "basically the GitHub actions are emo files that you create and you save that",
    "start": "518700",
    "end": "525180"
  },
  {
    "text": "in specific folder in your repository which is that GitHub slash workflows so",
    "start": "525180",
    "end": "531300"
  },
  {
    "text": "make sure there is an S at the end I made that mistake before and things weren't working and I didn't know what",
    "start": "531300",
    "end": "537000"
  },
  {
    "text": "was going on so just because of that as there at the end",
    "start": "537000",
    "end": "542399"
  },
  {
    "text": "every time there is an event on your GitHub repository it triggers it can",
    "start": "542399",
    "end": "549180"
  },
  {
    "text": "trigger one of or several actions so it really depends on how you configure for",
    "start": "549180",
    "end": "555000"
  },
  {
    "text": "example a pull request added you change some file on your repository everything",
    "start": "555000",
    "end": "561240"
  },
  {
    "text": "can be an event there is a list of events on the documentation there on the website there is a great documentation",
    "start": "561240",
    "end": "567000"
  },
  {
    "text": "from GitHub available so you can trigger that uh based on an event",
    "start": "567000",
    "end": "574019"
  },
  {
    "text": "and what that's going to do that's going to create a VM",
    "start": "574019",
    "end": "580440"
  },
  {
    "text": "on azure and and it's really a VM at the beginning I thought was a container but",
    "start": "580440",
    "end": "586380"
  },
  {
    "text": "it's not um that is going to run your automation inside that VM whatever you want to do",
    "start": "586380",
    "end": "592260"
  },
  {
    "text": "and then after your automation is done that VM gets destroyed you don't get",
    "start": "592260",
    "end": "597660"
  },
  {
    "text": "access to that VM anymore so we're gonna see some of the",
    "start": "597660",
    "end": "603019"
  },
  {
    "text": "Advantage then disadvantages of that and that VM can be a Ubuntu VM so Linux",
    "start": "603019",
    "end": "609120"
  },
  {
    "text": "windows or even Mac OS as I said it's free for any GitHub",
    "start": "609120",
    "end": "616560"
  },
  {
    "text": "account today of course there are some limits but you can start playing around with that and I think for you if you're",
    "start": "616560",
    "end": "623100"
  },
  {
    "text": "just trying or learning GitHub actions the limits it's you're probably not going to reach the limit unless you're",
    "start": "623100",
    "end": "629040"
  },
  {
    "text": "doing something bad like what we're gonna show here",
    "start": "629040",
    "end": "634160"
  },
  {
    "text": "so yeah there is an event so as I said like a pull request a push can be there",
    "start": "635339",
    "end": "640440"
  },
  {
    "text": "is a list there on the documentation this event triggers creates a runner it",
    "start": "640440",
    "end": "646500"
  },
  {
    "text": "doesn't really create it it's already there it just assigns that Runner to you and that Runner is the virtual machine",
    "start": "646500",
    "end": "653579"
  },
  {
    "text": "that's running on azure and that Runner is gonna run a job so a",
    "start": "653579",
    "end": "660000"
  },
  {
    "text": "job is a series of action steps that you can run each step can be a command so a Linux",
    "start": "660000",
    "end": "668279"
  },
  {
    "text": "command it can be a shell script for example if you're running on Windows can be Powershell or it can be another",
    "start": "668279",
    "end": "674579"
  },
  {
    "text": "action so from my action I can call another action",
    "start": "674579",
    "end": "681360"
  },
  {
    "text": "so there is some relationship there and there is some dependency as well and",
    "start": "681360",
    "end": "686399"
  },
  {
    "text": "you're trusting that other action especially if that other action doesn't belong to you you didn't write that code",
    "start": "686399",
    "end": "693300"
  },
  {
    "text": "so some issues there of course if you have two jobs you can",
    "start": "693300",
    "end": "700260"
  },
  {
    "text": "have another Runner running there so it's going to create another VM and that's job two you can give them names",
    "start": "700260",
    "end": "706980"
  },
  {
    "text": "and of course uh like it's shown here there is some relationship between",
    "start": "706980",
    "end": "712860"
  },
  {
    "text": "Runner one and Runner two so I can't start Runner 2 without Runner 1",
    "start": "712860",
    "end": "720779"
  },
  {
    "text": "finishing all the steps right they can they can run in parallel if I want by",
    "start": "720779",
    "end": "726360"
  },
  {
    "text": "default that's how they they run but like what's shown here they're run in sequence so one has to finish for the",
    "start": "726360",
    "end": "732660"
  },
  {
    "text": "other one maybe it needs the output results from runner from the job one as",
    "start": "732660",
    "end": "738660"
  },
  {
    "text": "input for job two so that's a possibility",
    "start": "738660",
    "end": "743959"
  },
  {
    "text": "so why GitHub actions is getting so much",
    "start": "745500",
    "end": "750660"
  },
  {
    "text": "adoption why is it getting so much attention for developers and like as I",
    "start": "750660",
    "end": "756660"
  },
  {
    "text": "saw more than 50 of the people here are using there is this Marketplace",
    "start": "756660",
    "end": "763440"
  },
  {
    "text": "and if you played with Jenkins before this is a similar approach with the Jenkins plugins the marketplace it's",
    "start": "763440",
    "end": "771360"
  },
  {
    "text": "basically a place inside GitHub where anyone can post their actions so I can",
    "start": "771360",
    "end": "777839"
  },
  {
    "text": "write my own action and I can make it available for free or charging something",
    "start": "777839",
    "end": "783120"
  },
  {
    "text": "if I want um on the marketplace anyone can do that today",
    "start": "783120",
    "end": "788639"
  },
  {
    "text": "and this number is probably outdated because like I I was tired of every time",
    "start": "788639",
    "end": "794519"
  },
  {
    "text": "I present this like changing this number but if you go there to the GitHub action Marketplace uh that's gonna probably be",
    "start": "794519",
    "end": "801120"
  },
  {
    "text": "around maybe 20 000 actions available by Third Parties by companies by",
    "start": "801120",
    "end": "806579"
  },
  {
    "text": "organizations or by anyone any user what can you do with this these actions",
    "start": "806579",
    "end": "813480"
  },
  {
    "text": "in the marketplace we're talking about security here so yeah you can run these",
    "start": "813480",
    "end": "818700"
  },
  {
    "text": "tests you can run dust you can run SCA software compositional disaster container security so image scanning you",
    "start": "818700",
    "end": "826380"
  },
  {
    "text": "can do any almost like pretty much anything you want right so that's great",
    "start": "826380",
    "end": "831540"
  },
  {
    "text": "for a security perspective for a devsecoff type pipeline for some automation purposes that's awesome right",
    "start": "831540",
    "end": "837779"
  },
  {
    "text": "developers should leverage that so just quick overview or review for",
    "start": "837779",
    "end": "846660"
  },
  {
    "text": "those who know it already how an action works this is basically action in action and",
    "start": "846660",
    "end": "853920"
  },
  {
    "text": "the example here is a nuclei the two nuclei or nuclei that scan right so a",
    "start": "853920",
    "end": "860579"
  },
  {
    "text": "dynamic analysis of a website so I have it here the yaml file basically",
    "start": "860579",
    "end": "869459"
  },
  {
    "text": "that's saved on The Dot GitHub workflows directory of my Repository",
    "start": "869459",
    "end": "875040"
  },
  {
    "text": "here we can see that on the the name and then there is this tag or",
    "start": "875040",
    "end": "881519"
  },
  {
    "text": "this directive is called on right this that this tells me when this action is",
    "start": "881519",
    "end": "886920"
  },
  {
    "text": "going to run which event is going to trigger this action so I have two events there I have a",
    "start": "886920",
    "end": "893639"
  },
  {
    "text": "schedule so based on the Chrome tab so I can set it up I can I want to run my sky",
    "start": "893639",
    "end": "899519"
  },
  {
    "text": "my scan every day every week specific time of the day doesn't matter just like",
    "start": "899519",
    "end": "904980"
  },
  {
    "text": "the Linux ground tab I can configure this here and the workflow dispatch is a specific",
    "start": "904980",
    "end": "910440"
  },
  {
    "text": "event that I can trigger that manually so if I want to trigger the scan right now I can do that because there is an",
    "start": "910440",
    "end": "916680"
  },
  {
    "text": "event allowing me to do that then there is jobs and basically there",
    "start": "916680",
    "end": "923279"
  },
  {
    "text": "is only one job called nuclei scan and it runs on Ubuntu latest so it's",
    "start": "923279",
    "end": "929579"
  },
  {
    "text": "using the latest Ubuntu version provided by GitHub actions to run the VM to run",
    "start": "929579",
    "end": "935160"
  },
  {
    "text": "this action so it's gonna it's gonna assign not spin up there is already a VMS spun up there on Azure it's going to",
    "start": "935160",
    "end": "942300"
  },
  {
    "text": "assign that to my job and it's going to run that on the latest Ubuntu version",
    "start": "942300",
    "end": "948360"
  },
  {
    "text": "some steps here interesting steps uses actions slash checkout",
    "start": "948360",
    "end": "955320"
  },
  {
    "text": "so that's not my code that's not my action it's using a third-party action",
    "start": "955320",
    "end": "960779"
  },
  {
    "text": "inside my script so here there is some dependency there",
    "start": "960779",
    "end": "966300"
  },
  {
    "text": "is some security issues around that but for this example this action is calling",
    "start": "966300",
    "end": "972180"
  },
  {
    "text": "this checkout action which is provided by GitHub this username slash checkout",
    "start": "972180",
    "end": "978300"
  },
  {
    "text": "so if you go to github.com slash actions slash checkout you can see the code of",
    "start": "978300",
    "end": "984839"
  },
  {
    "text": "this action so you can analyze that as well so pretty much all the actions are public repositories on GitHub",
    "start": "984839",
    "end": "993740"
  },
  {
    "text": "um the Second Step here nuclei desk cam this is actually the scan and that's",
    "start": "994079",
    "end": "999180"
  },
  {
    "text": "also a separate action we can see the target here the the website that it's going to scan example.com of course I",
    "start": "999180",
    "end": "1006860"
  },
  {
    "text": "can change that to my the URL of my application can be a development environment can be an IP address",
    "start": "1006860",
    "end": "1013220"
  },
  {
    "text": "whatever it works and also the last two ones as I",
    "start": "1013220",
    "end": "1019220"
  },
  {
    "text": "mentioned after the action is done I don't have access to that VM anymore",
    "start": "1019220",
    "end": "1024980"
  },
  {
    "text": "so whatever was generated wherever was logged created or binary was compiled",
    "start": "1024980",
    "end": "1031400"
  },
  {
    "text": "whatever if I don't do anything else I lose access to it I can't go back and",
    "start": "1031400",
    "end": "1037819"
  },
  {
    "text": "retrieve it so I need to have some steps that upload whatever was generated",
    "start": "1037819",
    "end": "1043160"
  },
  {
    "text": "during that automation back to my GitHub repository so basically that's what's",
    "start": "1043160",
    "end": "1048438"
  },
  {
    "text": "doing here the artifacts the nuclei logs from the scan and the uh the output the",
    "start": "1048439",
    "end": "1054799"
  },
  {
    "text": "dot serif output of the scan right that's that's a common uh extension for",
    "start": "1054799",
    "end": "1060919"
  },
  {
    "text": "SAS and dust tools created by Microsoft and of course now GitHub is using it",
    "start": "1060919",
    "end": "1068080"
  },
  {
    "text": "so this is just an overview of how an action works so far so good",
    "start": "1068120",
    "end": "1074419"
  },
  {
    "text": "okay great so what are the known vulnerabilities",
    "start": "1074419",
    "end": "1082940"
  },
  {
    "text": "when I started this research back in 2021",
    "start": "1082940",
    "end": "1089660"
  },
  {
    "text": "these were the noun of vulnerabilities there are some blog posts about the GitHub from the GitHub security lab as",
    "start": "1091940",
    "end": "1099020"
  },
  {
    "text": "well talking about these pull requests from 4kid repo so when it was released",
    "start": "1099020",
    "end": "1105620"
  },
  {
    "text": "I'm gonna talk about that uh in the next few slides there was this ability of you",
    "start": "1105620",
    "end": "1112360"
  },
  {
    "text": "working on repository and then making a pull request back to the origin",
    "start": "1112360",
    "end": "1118580"
  },
  {
    "text": "repository and you were able to change whatever action was there so you could",
    "start": "1118580",
    "end": "1124400"
  },
  {
    "text": "change to anything and so basically what what attackers were doing is",
    "start": "1124400",
    "end": "1130580"
  },
  {
    "text": "forking a bunch of repos and changing the yaml code of their actions to",
    "start": "1130580",
    "end": "1137539"
  },
  {
    "text": "basically do what mine cryptocurrency right for free",
    "start": "1137539",
    "end": "1143059"
  },
  {
    "text": "and that was running inside the origin user so it wasn't running on the Cyber",
    "start": "1143059",
    "end": "1149120"
  },
  {
    "text": "criminal users on GitHub right so the kind of the maintainer of that repo got",
    "start": "1149120",
    "end": "1157160"
  },
  {
    "text": "the got banned or got like the kind of the",
    "start": "1157160",
    "end": "1162559"
  },
  {
    "text": "their account suspended from GitHub because GitHub assumed that they were the ones doing the bad stuff that wasn't",
    "start": "1162559",
    "end": "1169640"
  },
  {
    "text": "the case um this and we're gonna talk about how",
    "start": "1169640",
    "end": "1175280"
  },
  {
    "text": "to fix this this basically has been fixed already and there is some settings on the uh when I talk about the counter",
    "start": "1175280",
    "end": "1182059"
  },
  {
    "text": "measures part so we're gonna see that as well um there is also just going back to",
    "start": "1182059",
    "end": "1187220"
  },
  {
    "text": "these topics here there's also the command injection via untrusted inputs so you can send uh of course you always",
    "start": "1187220",
    "end": "1195140"
  },
  {
    "text": "should validate your inputs that's kind of the basics of secure coding one of the basics right but there are some",
    "start": "1195140",
    "end": "1202340"
  },
  {
    "text": "Fields there from your action that if you send a malicious input and you're",
    "start": "1202340",
    "end": "1207500"
  },
  {
    "text": "reading that on your action that can cause common ejection and of course the the kind of the main",
    "start": "1207500",
    "end": "1215240"
  },
  {
    "text": "focus of my research was this third part here the malicious GitHub actions from",
    "start": "1215240",
    "end": "1221059"
  },
  {
    "text": "the marketplace so yeah I talk about the 4kid repos",
    "start": "1221059",
    "end": "1226539"
  },
  {
    "text": "let's see how attackers were abusing Windows Runners there so I'm not sure if",
    "start": "1226539",
    "end": "1234679"
  },
  {
    "text": "you can see uh in the back there but just look at the last command here right",
    "start": "1234679",
    "end": "1240559"
  },
  {
    "text": "they're deploying a Windows machine Windows later so we can see that there is some strategy I'm gonna talk about",
    "start": "1240559",
    "end": "1247460"
  },
  {
    "text": "that later and there's the steps one thing there it's using uses Nick",
    "start": "1247460",
    "end": "1254600"
  },
  {
    "text": "Dash Vision slash retry I'm not sure if NYX here hi Nick but yeah we're gonna",
    "start": "1254600",
    "end": "1260360"
  },
  {
    "text": "see that there the attackers are already leveraging third-party GitHub actions",
    "start": "1260360",
    "end": "1265580"
  },
  {
    "text": "legitimate GitHub actions to mine cryptocurrencies and of course the last command there is just running their",
    "start": "1265580",
    "end": "1272960"
  },
  {
    "text": "binary the node.exe of course that's not a node or npm binary that's the XM rig malicious",
    "start": "1272960",
    "end": "1281179"
  },
  {
    "text": "file and that's kind of their command to remind cryptocurrencies the pool and",
    "start": "1281179",
    "end": "1286280"
  },
  {
    "text": "their username and all that stuff so yeah as I pointed out you're",
    "start": "1286280",
    "end": "1293360"
  },
  {
    "text": "leveraging third-party GitHub actions already so the attackers already know how to do that and instead of writing",
    "start": "1293360",
    "end": "1301520"
  },
  {
    "text": "their own stuff they have they know that this is available and this basically",
    "start": "1301520",
    "end": "1307640"
  },
  {
    "text": "this retry GitHub action retries the action if it fails",
    "start": "1307640",
    "end": "1313220"
  },
  {
    "text": "so if they're minor stops running it's going to restart create a new VM and",
    "start": "1313220",
    "end": "1318740"
  },
  {
    "text": "restart the server and keep mining for them so it's just an automation that they don't need to write anymore and",
    "start": "1318740",
    "end": "1324620"
  },
  {
    "text": "they're leveraging that I I review that code this is a legitimate GitHub action for legitimate purposes but they're",
    "start": "1324620",
    "end": "1330559"
  },
  {
    "text": "abusing that right and of course the node.exe file that we",
    "start": "1330559",
    "end": "1336860"
  },
  {
    "text": "saw in the last the last command there at the bottom of course that my that's malicious",
    "start": "1336860",
    "end": "1342020"
  },
  {
    "text": "that's a crypto Miner if you check on various Toto yeah not good so that was",
    "start": "1342020",
    "end": "1347299"
  },
  {
    "text": "that was inside the repository so yeah not great",
    "start": "1347299",
    "end": "1353380"
  },
  {
    "text": "um here another example of them abusing another Windows uh runner right another",
    "start": "1354440",
    "end": "1360200"
  },
  {
    "text": "deploying a Windows server on Azure and using that to mine cryptocurrencies this time they're leveraging Powershell you",
    "start": "1360200",
    "end": "1367460"
  },
  {
    "text": "can see some Powershell commands at the bottom and as I mentioned there The Matrix the strategy there Max parallel",
    "start": "1367460",
    "end": "1375260"
  },
  {
    "text": "from line 7 to 12. what is that doing",
    "start": "1375260",
    "end": "1381940"
  },
  {
    "text": "who knows it's multiple servers right at the same",
    "start": "1383240",
    "end": "1389480"
  },
  {
    "text": "time so of course if I'm mining cryptocurrencies I want to get the most out of it so if I deploy more servers",
    "start": "1389480",
    "end": "1396799"
  },
  {
    "text": "I'm gonna mine more and get more money right because as soon as I'm detected as",
    "start": "1396799",
    "end": "1402620"
  },
  {
    "text": "soon as GitHub finds out they're gonna shut that down so if I deploy as much as",
    "start": "1402620",
    "end": "1407720"
  },
  {
    "text": "I can in a short amount of time then yeah big Like Money free money right and",
    "start": "1407720",
    "end": "1415520"
  },
  {
    "text": "yeah the also the last command there deploy is the XM rig binary there is the",
    "start": "1415520",
    "end": "1421580"
  },
  {
    "text": "pool and there is the username all that stuff very similar very same approach",
    "start": "1421580",
    "end": "1427340"
  },
  {
    "text": "what is funny is that if you take a look at this code",
    "start": "1427340",
    "end": "1435100"
  },
  {
    "text": "I found all those repositories all this is the exact same code as this one",
    "start": "1436220",
    "end": "1442940"
  },
  {
    "text": "and these were the only ones that I analyzed if I went there were hundreds of them and they're all kind of you can see",
    "start": "1442940",
    "end": "1449960"
  },
  {
    "text": "they're kind of fake usernames they were created from automation but they're all called",
    "start": "1449960",
    "end": "1456460"
  },
  {
    "text": "captaincrypto.yamo or something like that but it's exact the same code",
    "start": "1456460",
    "end": "1461960"
  },
  {
    "text": "so maybe it's just one person kind of scaling their business or someone",
    "start": "1461960",
    "end": "1468919"
  },
  {
    "text": "copying each other like copycats uh of course we sent this",
    "start": "1468919",
    "end": "1474380"
  },
  {
    "text": "uh these the list of URLs for GitHub to take them down they took almost a year to take it down",
    "start": "1474380",
    "end": "1483020"
  },
  {
    "text": "the we use the proper channels as was recommended for uh for to us but yeah",
    "start": "1483020",
    "end": "1489500"
  },
  {
    "text": "some of them might be still available so I don't know but yeah we reported it",
    "start": "1489500",
    "end": "1498100"
  },
  {
    "text": "um I'll be using Linux Runners now I'm deploying a Linux and and I got like I'm not a Bitcoin expert",
    "start": "1498679",
    "end": "1506419"
  },
  {
    "text": "so I I got into the discussion while I was doing this research with some of the",
    "start": "1506419",
    "end": "1512720"
  },
  {
    "text": "my friends that are actually I think they are experts in Bitcoin maybe not anymore because it's going down so we'll",
    "start": "1512720",
    "end": "1519440"
  },
  {
    "text": "see um but but yeah like what would make someone to choose",
    "start": "1519440",
    "end": "1524539"
  },
  {
    "text": "between a Windows Runner or a Linux Runner to mine cryptocurrency they they",
    "start": "1524539",
    "end": "1530299"
  },
  {
    "text": "both have the same configuration and they're both using CPU not GPU to mine cryptocurrency",
    "start": "1530299",
    "end": "1536480"
  },
  {
    "text": "who who can answer that question which one would be better Windows or",
    "start": "1536480",
    "end": "1542779"
  },
  {
    "text": "Linux in your perspective foreign",
    "start": "1542779",
    "end": "1548620"
  },
  {
    "text": "why sorry oh it's better okay yeah that's a",
    "start": "1549620",
    "end": "1555140"
  },
  {
    "text": "good answer but yeah oh sure yeah so yeah the question the",
    "start": "1555140",
    "end": "1563000"
  },
  {
    "text": "question was if you're mining cryptocurrency if you're using CPU and",
    "start": "1563000",
    "end": "1568039"
  },
  {
    "text": "not GPU and you have two VMS with the exact same configuration",
    "start": "1568039",
    "end": "1573559"
  },
  {
    "text": "same memory same CPU power and all that stuff which one would be better",
    "start": "1573559",
    "end": "1579260"
  },
  {
    "text": "from a cryptocurrency miner perspective windows or Linux",
    "start": "1579260",
    "end": "1585620"
  },
  {
    "text": "the answer that I got there okay Linux always better nah that's I would suppose",
    "start": "1585620",
    "end": "1591679"
  },
  {
    "text": "so but yeah because most the the kind of the",
    "start": "1591679",
    "end": "1597260"
  },
  {
    "text": "arguments that I got was correct Linux because it has less startup Services it",
    "start": "1597260",
    "end": "1605000"
  },
  {
    "text": "has less Services running and when it's idle so it's probably gonna run more uh",
    "start": "1605000",
    "end": "1611240"
  },
  {
    "text": "and exploit more of this group to Miner right it's going to leverage that more so I I haven't tested it this Theory but",
    "start": "1611240",
    "end": "1619340"
  },
  {
    "text": "that's kind of the answer that I got and you can see they're downloading here from uh this is the the First Command",
    "start": "1619340",
    "end": "1629179"
  },
  {
    "text": "the second command the second line there First Command the W get command this is original a Monero crypto Miner XM rig",
    "start": "1629179",
    "end": "1637159"
  },
  {
    "text": "right it's available on GitHub and it's legitimate if you want to mine cryptocurrencies for legitimate purposes",
    "start": "1637159",
    "end": "1642860"
  },
  {
    "text": "on your own machine of course you can but you're downloading inside the runner",
    "start": "1642860",
    "end": "1648260"
  },
  {
    "text": "that's running inside Azure and Mining on for free right and of course just",
    "start": "1648260",
    "end": "1654919"
  },
  {
    "text": "some Linux commands there unzipping the file and then yeah starting the crypto",
    "start": "1654919",
    "end": "1660980"
  },
  {
    "text": "Miner here and some of them they're even uh I I think I I cut this when I took",
    "start": "1660980",
    "end": "1667940"
  },
  {
    "text": "the screenshot but some of these commands they even put some arguments to",
    "start": "1667940",
    "end": "1674059"
  },
  {
    "text": "limit the amount of CPU that they're using to avoid detection",
    "start": "1674059",
    "end": "1679279"
  },
  {
    "text": "so they're limiting amount CPU 70 60 to avoid detection so there is some",
    "start": "1679279",
    "end": "1685100"
  },
  {
    "text": "arguments that you can use here and I've seen in some examples so they don't get easily detected and shut down by GitHub",
    "start": "1685100",
    "end": "1693200"
  },
  {
    "text": "or azure so",
    "start": "1693200",
    "end": "1698900"
  },
  {
    "text": "if you visit a repository and if they're using GitHub actions you're going to see",
    "start": "1698900",
    "end": "1705320"
  },
  {
    "text": "an actions tab at the top of the Repository and if you go to this tab",
    "start": "1705320",
    "end": "1710960"
  },
  {
    "text": "and you see this red sign there GitHub actions disabled for this repository",
    "start": "1710960",
    "end": "1716659"
  },
  {
    "text": "that's probably not good this probably means that they're doing something bad and GitHub blocked them from using",
    "start": "1716659",
    "end": "1722840"
  },
  {
    "text": "actions but the only blocking the repository not the user so if the user",
    "start": "1722840",
    "end": "1728179"
  },
  {
    "text": "creates another repository then they can do the same bad actions again so it's",
    "start": "1728179",
    "end": "1733340"
  },
  {
    "text": "like a cat and mouse Chase and of course if they block the user they just create",
    "start": "1733340",
    "end": "1738500"
  },
  {
    "text": "a new GitHub user right with some automation it's kind of trivial to do that",
    "start": "1738500",
    "end": "1743659"
  },
  {
    "text": "so yeah if you're trying if you're going to GitHub looking oh I might as well look use this repository these two seems",
    "start": "1743659",
    "end": "1750740"
  },
  {
    "text": "nice and then you go to the actions tab and you see this red sign probably not a good idea okay",
    "start": "1750740",
    "end": "1758299"
  },
  {
    "text": "um just kind of a side note to that our",
    "start": "1758299",
    "end": "1763940"
  },
  {
    "text": "another research signature and micro they published this really great white paper about how attackers how cyber",
    "start": "1763940",
    "end": "1771860"
  },
  {
    "text": "criminals are leveraging free services SAS Services just like GitHub actions to",
    "start": "1771860",
    "end": "1777440"
  },
  {
    "text": "mine cryptocurrencies for other things and not just GitHub actions like",
    "start": "1777440",
    "end": "1782600"
  },
  {
    "text": "kubernetes Docker um yeah any Cloud comes kind of different cloud services so it has a",
    "start": "1782600",
    "end": "1789620"
  },
  {
    "text": "very detailed analysis of that if you're interested that just the link there and of course I'm sharing the slides later",
    "start": "1789620",
    "end": "1794960"
  },
  {
    "text": "so um yeah no big deal so there was the issue of the command",
    "start": "1794960",
    "end": "1801740"
  },
  {
    "text": "injection I haven't explored that issue much that's on the GitHub security lab",
    "start": "1801740",
    "end": "1807440"
  },
  {
    "text": "blog post but if you can see here there is a difference between the first uh",
    "start": "1807440",
    "end": "1813860"
  },
  {
    "text": "action and the second one so you see the dollar sign at the beginning there so",
    "start": "1813860",
    "end": "1819140"
  },
  {
    "text": "that might lead to a template injection as well and of course command injection these are the fields that you can",
    "start": "1819140",
    "end": "1826059"
  },
  {
    "text": "manipulate on the left side there so you can inject malicious commands through",
    "start": "1826059",
    "end": "1831919"
  },
  {
    "text": "these fields and when the action read these fields it can trigger the command injection right so I haven't explored",
    "start": "1831919",
    "end": "1838940"
  },
  {
    "text": "that much that may be an area if someone wants to dive deep into that and it's interested we can talk about it",
    "start": "1838940",
    "end": "1847120"
  },
  {
    "text": "okay this is the part that I spent most of my",
    "start": "1847460",
    "end": "1852860"
  },
  {
    "text": "time doing my research the malicious GitHub actions my first thought was",
    "start": "1852860",
    "end": "1860120"
  },
  {
    "text": "can I create a GitHub action and then provide that available make it available",
    "start": "1860120",
    "end": "1867260"
  },
  {
    "text": "on the marketplace and if people use it without knowing of course that oh it's",
    "start": "1867260",
    "end": "1874279"
  },
  {
    "text": "dangerous right will I like will I be able to maybe get a shell inside that Runner right so when",
    "start": "1874279",
    "end": "1882080"
  },
  {
    "text": "they're running the automation of course I will make it uh unsuspicious I'll make it credible and",
    "start": "1882080",
    "end": "1889760"
  },
  {
    "text": "like okay this is not a malicious GitHub action but when they're using then it connects back to my machine to my C2",
    "start": "1889760",
    "end": "1896659"
  },
  {
    "text": "server right yes I can do that so we're gonna see that today",
    "start": "1896659",
    "end": "1903200"
  },
  {
    "text": "um so the problems with GitHub actions is just the same issues that we have with libraries and dependencies right",
    "start": "1903200",
    "end": "1910220"
  },
  {
    "text": "you have to treat this as third party and you can't trust blindly you have to",
    "start": "1910220",
    "end": "1915860"
  },
  {
    "text": "take a look there's ways to look at the code unfortunately I'm not aware of any tools that scanning they're scanning",
    "start": "1915860",
    "end": "1922399"
  },
  {
    "text": "GitHub actions I think GitHub is working on that through code ql there there are",
    "start": "1922399",
    "end": "1928460"
  },
  {
    "text": "two Force static analysis but I'm not sure how mature that is right now",
    "start": "1928460",
    "end": "1933559"
  },
  {
    "text": "so yeah check their code before using and I'm gonna give some tips as well as if you're searching the marketplace",
    "start": "1933559",
    "end": "1940159"
  },
  {
    "text": "there are a few things to look for that can can give you an idea that this section",
    "start": "1940159",
    "end": "1946340"
  },
  {
    "text": "might be a little bit better than the others for example the blue check mark I know",
    "start": "1946340",
    "end": "1952820"
  },
  {
    "text": "that's not kind of uh um kind of a seal of oh this is safe and",
    "start": "1952820",
    "end": "1958880"
  },
  {
    "text": "this is security just this just verifies the creator of that action for example",
    "start": "1958880",
    "end": "1964760"
  },
  {
    "text": "if it's a company oh yeah GitHub knows this company they kind of trust the company but they're not saying that they",
    "start": "1964760",
    "end": "1971480"
  },
  {
    "text": "scan the code and it's free from vulnerabilities right so you still have to be careful here and of course as I",
    "start": "1971480",
    "end": "1977899"
  },
  {
    "text": "mentioned earlier if you see this on your yaml file you can go to the URL github.com and then",
    "start": "1977899",
    "end": "1986600"
  },
  {
    "text": "slash actions slash checkout that's the first that's you're gonna see the code",
    "start": "1986600",
    "end": "1991940"
  },
  {
    "text": "of the first action there if I go to the second one github.com actions slash",
    "start": "1991940",
    "end": "1997460"
  },
  {
    "text": "setup Dash node I'm gonna see the code what's running when I call that action right so I can review that if I know the",
    "start": "1997460",
    "end": "2004899"
  },
  {
    "text": "code there's different languages that the actions are supported in so JavaScript and other things so if you",
    "start": "2004899",
    "end": "2011740"
  },
  {
    "text": "can read the code then you can understand what it's doing if you can't read it if you can't trust it then might",
    "start": "2011740",
    "end": "2017019"
  },
  {
    "text": "be better now to not use it okay now the fun part",
    "start": "2017019",
    "end": "2023620"
  },
  {
    "text": "so I said okay I'll create a simple GitHub action and I use this the example available on",
    "start": "2023620",
    "end": "2031000"
  },
  {
    "text": "the documentation there okay hello world greet someone okay but then the first step there uh I run",
    "start": "2031000",
    "end": "2038860"
  },
  {
    "text": "my GitHub action and I have slash backdoor.sh I wanted to make explicit",
    "start": "2038860",
    "end": "2044559"
  },
  {
    "text": "that this was a bad action because I didn't make it available on the marketplace and of course if you go to",
    "start": "2044559",
    "end": "2051580"
  },
  {
    "text": "my GitHub and find that repository you're gonna see that that that's bad don't use it right I only made it for",
    "start": "2051580",
    "end": "2058720"
  },
  {
    "text": "research purposes if you look at the what's inside that that backdoor.sh it's",
    "start": "2058720",
    "end": "2064720"
  },
  {
    "text": "basically downloading netcat and I'm going to explain why uh in a second uh",
    "start": "2064720",
    "end": "2070599"
  },
  {
    "text": "making installing building and then connecting back to my C2 machine my kind",
    "start": "2070599",
    "end": "2077919"
  },
  {
    "text": "of yeah my instance there and that instance is on AWS so my GitHub action",
    "start": "2077919",
    "end": "2084339"
  },
  {
    "text": "inside Azure is connecting back to my AWS machine and I'm gonna do the demo",
    "start": "2084339",
    "end": "2090099"
  },
  {
    "text": "here so that everyone can maybe understand better so yeah that's a URL of the fake GHA or GitHub action there",
    "start": "2090099",
    "end": "2100320"
  },
  {
    "text": "so what happens when I call that action see the URL there",
    "start": "2100720",
    "end": "2107820"
  },
  {
    "text": "github.com magnologan slash fake Dash GHA",
    "start": "2107820",
    "end": "2113500"
  },
  {
    "text": "and here on the left side there that's what I'm calling right the steps uses",
    "start": "2113500",
    "end": "2119099"
  },
  {
    "text": "magnologan slash fake GHA and when I call that",
    "start": "2119099",
    "end": "2124540"
  },
  {
    "text": "here I'm listening to the port for for free uh and that's basically me getting",
    "start": "2124540",
    "end": "2130359"
  },
  {
    "text": "the shell back and I'm gonna do the demo of that hopefully yeah we'll have time for that right so here I can see that",
    "start": "2130359",
    "end": "2138099"
  },
  {
    "text": "I'm running the user and this is the machine there Azure right Linux something a z 90 and Azure and I'm",
    "start": "2138099",
    "end": "2147460"
  },
  {
    "text": "inside an ec2 instance inside AWS so I'm making that connection and from",
    "start": "2147460",
    "end": "2153339"
  },
  {
    "text": "there I can technically I'm not allowed to use the",
    "start": "2153339",
    "end": "2158380"
  },
  {
    "text": "GitHub action Runner to send interactive commands have an interactive shell now I",
    "start": "2158380",
    "end": "2164020"
  },
  {
    "text": "can right and I don't need to trigger the action every time to run my testing right so I can do everything here of",
    "start": "2164020",
    "end": "2171220"
  },
  {
    "text": "course there is a limit of uh I think it's six hours for each job so I have a",
    "start": "2171220",
    "end": "2177640"
  },
  {
    "text": "window of six hours to play around with that that's okay",
    "start": "2177640",
    "end": "2183060"
  },
  {
    "text": "what else can I do here right uh once I was inside that VM that",
    "start": "2183280",
    "end": "2189099"
  },
  {
    "text": "Runner inside Azure what did I do right first thing is okay is there any other",
    "start": "2189099",
    "end": "2195760"
  },
  {
    "text": "server next to me can I do some lateral movement and exploit other servers that",
    "start": "2195760",
    "end": "2201880"
  },
  {
    "text": "might belong to other users other people right so I ran an nmap scan inside the",
    "start": "2201880",
    "end": "2207220"
  },
  {
    "text": "Azure internal Network um I did the reverse shell as I explained to the external server my my",
    "start": "2207220",
    "end": "2214060"
  },
  {
    "text": "Essential instance on AWS but I can also use this",
    "start": "2214060",
    "end": "2219880"
  },
  {
    "text": "as my proxy to trigger attacks",
    "start": "2219880",
    "end": "2225040"
  },
  {
    "text": "from Azure to other servers on Azure other",
    "start": "2225040",
    "end": "2230500"
  },
  {
    "text": "servers anywhere on AWS for example and the source IP address will be the IP",
    "start": "2230500",
    "end": "2236619"
  },
  {
    "text": "address from Azure and not my own so I'm hiding behind this GitHub action to do malicious things so I can do that",
    "start": "2236619",
    "end": "2244540"
  },
  {
    "text": "as well um I know it's a bit small here but this",
    "start": "2244540",
    "end": "2250060"
  },
  {
    "text": "is kind of the end map scan that I did inside the Azure Network the first result there is my own machine my own uh",
    "start": "2250060",
    "end": "2257500"
  },
  {
    "text": "runner and then the other ones you can see the parts that are open there you have oh the port the some of them are",
    "start": "2257500",
    "end": "2263980"
  },
  {
    "text": "open or other not as a sage uh HTTP https",
    "start": "2263980",
    "end": "2269800"
  },
  {
    "text": "um 3389 is oh man yeah rgp so yeah RDP sorry and then I",
    "start": "2269800",
    "end": "2277780"
  },
  {
    "text": "have an 8084 there which is web SNP hmm",
    "start": "2277780",
    "end": "2285160"
  },
  {
    "text": "that's not anymore that's got fixed by",
    "start": "2285160",
    "end": "2290700"
  },
  {
    "text": "uh GitHub I guess they removed on the latest versions but this was an HTTP",
    "start": "2290700",
    "end": "2296260"
  },
  {
    "text": "server very old HP server called Mono XSP or yeah XSP I think and I talk about",
    "start": "2296260",
    "end": "2304599"
  },
  {
    "text": "this on my article there I don't cover that very much but it was weird it was enabled by default and you even have",
    "start": "2304599",
    "end": "2312280"
  },
  {
    "text": "nginx and HP there but they are not enabled by default so why was that enabled by default and the port was open",
    "start": "2312280",
    "end": "2319000"
  },
  {
    "text": "as well so there's some tricky things going on uh as I checked on the latest version of",
    "start": "2319000",
    "end": "2324700"
  },
  {
    "text": "the Ubuntu Linux that wasn't um enabled by default anymore",
    "start": "2324700",
    "end": "2329859"
  },
  {
    "text": "that's interesting and yeah some of some of the other machines there I get their",
    "start": "2329859",
    "end": "2335500"
  },
  {
    "text": "domain name others I don't so yeah there's some tricky other things to",
    "start": "2335500",
    "end": "2341020"
  },
  {
    "text": "maybe dig deeper later so I didn't have the time to do that it was it took me at",
    "start": "2341020",
    "end": "2346420"
  },
  {
    "text": "least three months to do the whole research",
    "start": "2346420",
    "end": "2350520"
  },
  {
    "text": "um the reverse shell from the runner why am I downloading netcats from scratch",
    "start": "2351640",
    "end": "2360460"
  },
  {
    "text": "netcat is already available on Ubuntu by default who can answer that question",
    "start": "2360460",
    "end": "2368339"
  },
  {
    "text": "then you want to use pipes no the version of netcat that's installed",
    "start": "2374880",
    "end": "2382359"
  },
  {
    "text": "on the Linux machine it it doesn't have the dash Eve option I",
    "start": "2382359",
    "end": "2388599"
  },
  {
    "text": "don't know if that's what you're okay sorry yeah yeah it doesn't have the dash e option so I couldn't use that yeah",
    "start": "2388599",
    "end": "2395940"
  },
  {
    "text": "uh there are other options around it I figured this okay I'll just install from scratch no problem also",
    "start": "2395940",
    "end": "2403540"
  },
  {
    "text": "when I'm connecting back to my machine there on AWS I'm using Port 443",
    "start": "2403540",
    "end": "2411640"
  },
  {
    "text": "why",
    "start": "2411640",
    "end": "2414180"
  },
  {
    "text": "okay yeah what else if I use a high port what would happen",
    "start": "2418599",
    "end": "2425140"
  },
  {
    "text": "a higher Port say say five thousand exactly right Azure has some egress",
    "start": "2425140",
    "end": "2432520"
  },
  {
    "text": "filtering they would block this uh the request so four for free is allowed so",
    "start": "2432520",
    "end": "2439300"
  },
  {
    "text": "then my GitHub action machine inside the Azure Network can talk to my AWS machine",
    "start": "2439300",
    "end": "2445900"
  },
  {
    "text": "my Azure my AWS ec2 instance so yeah we can see here in the example",
    "start": "2445900",
    "end": "2451540"
  },
  {
    "text": "right um I showed earlier as well the ec2 their IP and then of course when I",
    "start": "2451540",
    "end": "2457300"
  },
  {
    "text": "get the connection back I'm on azure",
    "start": "2457300",
    "end": "2462000"
  },
  {
    "text": "um the pivoting part right since I can do reverse shell from the runners to my servers I can also issue malicious",
    "start": "2462520",
    "end": "2468760"
  },
  {
    "text": "commands and attack other websites scanning AWS in even out scanning Azure",
    "start": "2468760",
    "end": "2475780"
  },
  {
    "text": "or even outside of azure sorry okay so before we go to the demo yeah I",
    "start": "2475780",
    "end": "2482260"
  },
  {
    "text": "think we have time 20 minutes uh just want to talk about the countermeasures",
    "start": "2482260",
    "end": "2488760"
  },
  {
    "text": "um we talked with the GitHub security team some of these things that I mentioned here and that I kind of",
    "start": "2490119",
    "end": "2495700"
  },
  {
    "text": "explore in my research um they're not a bug they're a feature",
    "start": "2495700",
    "end": "2501700"
  },
  {
    "text": "right they're by Design like of course you have access to the machine and you have a",
    "start": "2501700",
    "end": "2507820"
  },
  {
    "text": "elevated permissions on that machine that you want that you deploy while it's",
    "start": "2507820",
    "end": "2513339"
  },
  {
    "text": "available right so you have sudo there you can do whatever you want so you're responsible for protecting that machine",
    "start": "2513339",
    "end": "2519780"
  },
  {
    "text": "but and you're also responsible for uh the third party actions that you run in",
    "start": "2519780",
    "end": "2525820"
  },
  {
    "text": "your code so you have to validate that as well so one of the things that uh I mentioned",
    "start": "2525820",
    "end": "2532420"
  },
  {
    "text": "here I know it it might sound like common sense but yeah only use actions",
    "start": "2532420",
    "end": "2537700"
  },
  {
    "text": "from trusted creators right so the trusted Creator is the check mark there I think of course there are some",
    "start": "2537700",
    "end": "2544119"
  },
  {
    "text": "exceptions if it's a new project if something that um is just like you're not using for a",
    "start": "2544119",
    "end": "2549940"
  },
  {
    "text": "production environment you're just validating something that might be okay but the trusted Creator means that",
    "start": "2549940",
    "end": "2555520"
  },
  {
    "text": "basically GitHub has validated that user and it's not a security analysis it's",
    "start": "2555520",
    "end": "2561460"
  },
  {
    "text": "not a Securities kind of that action but I think it gives a little bit more trust",
    "start": "2561460",
    "end": "2566680"
  },
  {
    "text": "to it making sure you set the right permissions for your actions",
    "start": "2566680",
    "end": "2573099"
  },
  {
    "text": "some of the actions if you don't configure that correctly they will have right permissions to a repository so if",
    "start": "2573099",
    "end": "2580420"
  },
  {
    "text": "someone compromises that I can change the whole code on your repository and add anything I want",
    "start": "2580420",
    "end": "2587680"
  },
  {
    "text": "like what's happening with the 4kid repos similar approach",
    "start": "2587680",
    "end": "2593260"
  },
  {
    "text": "do not run actions from 4K repos so you can uh I'll show the next slide there is",
    "start": "2593260",
    "end": "2598480"
  },
  {
    "text": "an option there on the actions uh permission settings that you do not allow if someone forked your own repo",
    "start": "2598480",
    "end": "2606099"
  },
  {
    "text": "the repo from your organization you don't allow them to run actions if they",
    "start": "2606099",
    "end": "2611680"
  },
  {
    "text": "send a pull request back to your original repo right you still have to review it you don't allow to run that",
    "start": "2611680",
    "end": "2617500"
  },
  {
    "text": "automatically there's something that I didn't mention here and I think just because of time is",
    "start": "2617500",
    "end": "2626560"
  },
  {
    "text": "that every time there is an action that's created on Azure there's",
    "start": "2626560",
    "end": "2632380"
  },
  {
    "text": "something there is a token related to it right there's the GitHub token that gets added to that VM",
    "start": "2632380",
    "end": "2639520"
  },
  {
    "text": "if I get access to that token as well so if the attacker compromises that machine",
    "start": "2639520",
    "end": "2644560"
  },
  {
    "text": "for example using that malicious actions as I showed then they can get that token and while that token is valid that's",
    "start": "2644560",
    "end": "2652300"
  },
  {
    "text": "basically during while the action is running the the VM is is active then they can do also they can depending on",
    "start": "2652300",
    "end": "2659740"
  },
  {
    "text": "the permissions of the token they can even write or read uh files from the repository even if it's a private",
    "start": "2659740",
    "end": "2666460"
  },
  {
    "text": "repository so protect your secrets there are some options there for you to uh add",
    "start": "2666460",
    "end": "2673060"
  },
  {
    "text": "Secrets properly on your action so if you want to call similar what you have on Jenkins it's like a kind of a vault",
    "start": "2673060",
    "end": "2679780"
  },
  {
    "text": "approach so you have you your secrets you you don't add Secrets hard code",
    "start": "2679780",
    "end": "2685119"
  },
  {
    "text": "secrets on your yaml files right so that's kind of the idea don't do that",
    "start": "2685119",
    "end": "2691078"
  },
  {
    "text": "so here are some of the options there if you're not using actions make sure that you disable your actions the the",
    "start": "2691839",
    "end": "2698260"
  },
  {
    "text": "permissions there on your settings it's for each repository I think you can do that for the whole organization if",
    "start": "2698260",
    "end": "2703839"
  },
  {
    "text": "you're not using any so there are some permissions and of course uh the fork",
    "start": "2703839",
    "end": "2708880"
  },
  {
    "text": "pull request as I mentioned this is the setting that GitHub added after that incident of the the hundreds of forked",
    "start": "2708880",
    "end": "2716380"
  },
  {
    "text": "repos mining cryptocurrencies right so this was fixed by this and I think that's by default so require approval if",
    "start": "2716380",
    "end": "2723700"
  },
  {
    "text": "it's a first try first time contributor to the repository it requires some approval to run the action to run the",
    "start": "2723700",
    "end": "2729819"
  },
  {
    "text": "automation so that helps so",
    "start": "2729819",
    "end": "2734859"
  },
  {
    "text": "that's the content I'll go to the demo but if you want anyone would like to ask questions while I'll shift and prepare",
    "start": "2734859",
    "end": "2741280"
  },
  {
    "text": "everything feel free yeah I'll leave it here and I'll share",
    "start": "2741280",
    "end": "2747520"
  },
  {
    "text": "the slides as I mentioned so yeah let me just",
    "start": "2747520",
    "end": "2753040"
  },
  {
    "text": "go back stop sharing my screen",
    "start": "2753040",
    "end": "2758579"
  },
  {
    "text": "see if it can go where is this",
    "start": "2761500",
    "end": "2767460"
  },
  {
    "text": "okay here let me display it now I think that's",
    "start": "2769180",
    "end": "2775720"
  },
  {
    "text": "better let's see oops",
    "start": "2775720",
    "end": "2782519"
  },
  {
    "text": "okay now it's okay",
    "start": "2783220",
    "end": "2788380"
  },
  {
    "text": "so basically I only use this repo and the other one for the whole research let",
    "start": "2788380",
    "end": "2793839"
  },
  {
    "text": "me increase Zoom here and um yeah the gh8 dash test I have the",
    "start": "2793839",
    "end": "2801819"
  },
  {
    "text": "workflows and I have free separate emo files as I mentioned these are the ones",
    "start": "2801819",
    "end": "2806920"
  },
  {
    "text": "that I used to to run the actions so let's do the first one the simple one here is this GHA dot em all right this",
    "start": "2806920",
    "end": "2815079"
  },
  {
    "text": "is just going to run Ubuntu machine um there yeah she's just going to run",
    "start": "2815079",
    "end": "2822220"
  },
  {
    "text": "Ubuntu machine and execute some commands reload reload and DC so let's see how that works uh to trigger that action the",
    "start": "2822220",
    "end": "2830079"
  },
  {
    "text": "event there is on push so push means any changes anything any file changes to the",
    "start": "2830079",
    "end": "2835900"
  },
  {
    "text": "repository it's going to trigger that action so if I edit your this file I just make",
    "start": "2835900",
    "end": "2842260"
  },
  {
    "text": "it easy NDC security I'm just changing the name of the action to trigger and of",
    "start": "2842260",
    "end": "2849160"
  },
  {
    "text": "course I'm gonna do something that no developer should do commit to main but okay just for demo purposes",
    "start": "2849160",
    "end": "2858960"
  },
  {
    "text": "so once I do that if I go to the actions tab I see that there are some actions",
    "start": "2860980",
    "end": "2866920"
  },
  {
    "text": "triggered and you see that they're killed here uh all the free actions were triggered at the same time because",
    "start": "2866920",
    "end": "2872560"
  },
  {
    "text": "they're all on push but we wanna we only want to look at the one that I added",
    "start": "2872560",
    "end": "2877780"
  },
  {
    "text": "which is this one um I can see here the file that I change this one so if I go here",
    "start": "2877780",
    "end": "2884680"
  },
  {
    "text": "um I can see that okay it ran at like very fast and I can see the logs from my",
    "start": "2884680",
    "end": "2891819"
  },
  {
    "text": "action right so I can see ID all the commands that I run you name Dash a and",
    "start": "2891819",
    "end": "2897760"
  },
  {
    "text": "and of course reload hello NDC so I see the environment variables these three uh",
    "start": "2897760",
    "end": "2904540"
  },
  {
    "text": "Stars here this is basically my GitHub token so GitHub has some intelligence to",
    "start": "2904540",
    "end": "2912220"
  },
  {
    "text": "not display my GitHub token it's basically looking for that pattern and it's masking that on the logs uh of",
    "start": "2912220",
    "end": "2919540"
  },
  {
    "text": "course there are some ways around that if you just base64 encode it you can read it uh or a show here and yeah hello",
    "start": "2919540",
    "end": "2928660"
  },
  {
    "text": "NDC at the end okay my action is working it's just an example that it works now",
    "start": "2928660",
    "end": "2934780"
  },
  {
    "text": "I want to run the second one so I'm gonna go back just to show you the code it ran already",
    "start": "2934780",
    "end": "2942040"
  },
  {
    "text": "so that's the fake one on the marketplace [Music]",
    "start": "2942040",
    "end": "2947859"
  },
  {
    "text": "yeah okay yeah not sure if let's see why it's not",
    "start": "2947859",
    "end": "2953200"
  },
  {
    "text": "okay I think that's better so you can see here on push jobs GHA around Ubuntu",
    "start": "2953200",
    "end": "2960579"
  },
  {
    "text": "latest and the only step is calling another action fake GHA if I go to the",
    "start": "2960579",
    "end": "2967359"
  },
  {
    "text": "other repository fake g h a this is not my same username but it could be in another user that's fine and that's the",
    "start": "2967359",
    "end": "2975460"
  },
  {
    "text": "back door that's the same one that I showed earlier right just installing netcat and",
    "start": "2975460",
    "end": "2980800"
  },
  {
    "text": "connecting back to my machine so if I",
    "start": "2980800",
    "end": "2987760"
  },
  {
    "text": "publish that on the marketplace and of course I'm gonna make it sound legitimate I'm not gonna add the",
    "start": "2987760",
    "end": "2995200"
  },
  {
    "text": "name back door and now I'll add some code to it okay build your Java application right because",
    "start": "2995200",
    "end": "3001740"
  },
  {
    "text": "of my dark pass so um okay and then at the end there is",
    "start": "3001740",
    "end": "3007079"
  },
  {
    "text": "some code that at the bottom can be base64 encoded or something that's gonna do that for me if I publish that the",
    "start": "3007079",
    "end": "3013200"
  },
  {
    "text": "marketplace say someone start downloads or starts using that leveraging that game over right of course there's some",
    "start": "3013200",
    "end": "3019200"
  },
  {
    "text": "some social engineering involved but I think that's that's doable",
    "start": "3019200",
    "end": "3024900"
  },
  {
    "text": "so if I go back and if I run this yemo I'm just gonna edit um to",
    "start": "3024900",
    "end": "3031800"
  },
  {
    "text": "commit domain to trigger the push event I could also do that some other way but it's fine",
    "start": "3031800",
    "end": "3037440"
  },
  {
    "text": "okay start comment commit to Main oops first",
    "start": "3037440",
    "end": "3044040"
  },
  {
    "text": "see on my on my situ instance",
    "start": "3044040",
    "end": "3050160"
  },
  {
    "text": "let me just leverage that hopefully that didn't start yet so if I go to the actions",
    "start": "3050160",
    "end": "3057599"
  },
  {
    "text": "um fake GHA here Marketplace so let's see",
    "start": "3057599",
    "end": "3064980"
  },
  {
    "text": "gonna see it's running and it's gonna keep running because it's gonna try to connect back to my ec2 instance and see",
    "start": "3064980",
    "end": "3071880"
  },
  {
    "text": "connection received here if I do ID I see Runner you name Dash a",
    "start": "3071880",
    "end": "3078660"
  },
  {
    "text": "now I'm on a ec2 and connecting back to my runner on Azure right and then I can",
    "start": "3078660",
    "end": "3085559"
  },
  {
    "text": "do all sorts of stuff um",
    "start": "3085559",
    "end": "3090599"
  },
  {
    "text": "and of course this is the same approach if I wanted to let me",
    "start": "3090599",
    "end": "3097500"
  },
  {
    "text": "go back if I don't publish to the marketplace if I just want to test it and just run the",
    "start": "3097500",
    "end": "3105720"
  },
  {
    "text": "code I have another option other action here which is the connect back right the",
    "start": "3105720",
    "end": "3111119"
  },
  {
    "text": "same code but now inside the same action not on a third party so I won't demo that because it's gonna be the same",
    "start": "3111119",
    "end": "3117780"
  },
  {
    "text": "thing same connection and all that stuff but here I'm calling them directly the other one I'm using the third party",
    "start": "3117780",
    "end": "3123720"
  },
  {
    "text": "right so if I publish that to the marketplace of course for legal and ethical reasons we didn't do that but",
    "start": "3123720",
    "end": "3129540"
  },
  {
    "text": "that's available on my GitHub if you want to check it out and try so the true repositories and and that's all the code",
    "start": "3129540",
    "end": "3135839"
  },
  {
    "text": "that's all I needed right uh the two repositories are ghh GHA Dash",
    "start": "3135839",
    "end": "3143040"
  },
  {
    "text": "test that's kind of the main repo and the other one with the fake one with the",
    "start": "3143040",
    "end": "3148260"
  },
  {
    "text": "back door is fake Dash GHA okay any questions about what we saw",
    "start": "3148260",
    "end": "3156000"
  },
  {
    "text": "okay",
    "start": "3156000",
    "end": "3158240"
  },
  {
    "text": "yeah I automatically instead of executing your workspaces in my",
    "start": "3163200",
    "end": "3169760"
  },
  {
    "text": "Runner no once once you've worked that you run the action",
    "start": "3169760",
    "end": "3176420"
  },
  {
    "text": "malicious Repository",
    "start": "3177260",
    "end": "3180859"
  },
  {
    "text": "yeah yeah it was it was going to run under",
    "start": "3184920",
    "end": "3190020"
  },
  {
    "text": "your username or under your organization but the IP address for example if you don't change the IP address here on this",
    "start": "3190020",
    "end": "3197240"
  },
  {
    "text": "backdoor.shaged then if my machine is on and it's receiving it's listening to",
    "start": "3197240",
    "end": "3203220"
  },
  {
    "text": "connections then if you run the action so if you trigger a push event if you",
    "start": "3203220",
    "end": "3208260"
  },
  {
    "text": "change something on that repository that you just forked then it's gonna connect back to my machine if it's listening",
    "start": "3208260",
    "end": "3215400"
  },
  {
    "text": "right but I'm gonna shut down that machine after the demo so after the talk",
    "start": "3215400",
    "end": "3220619"
  },
  {
    "text": "so don't worry about it but you just if you want to try your own deploy your own ec2 instance make it uh publicly",
    "start": "3220619",
    "end": "3228240"
  },
  {
    "text": "accessible on 443 and then you change the AP address of that code and it's going to connect back to your your",
    "start": "3228240",
    "end": "3233819"
  },
  {
    "text": "machine sounds good okay",
    "start": "3233819",
    "end": "3239900"
  },
  {
    "text": "sorry say that again",
    "start": "3243180",
    "end": "3246140"
  },
  {
    "text": "on Fork hmm sure yeah so the question was was and",
    "start": "3257400",
    "end": "3264359"
  },
  {
    "text": "and please correct me if I'm wrong is there any event that would trigger an action on a fork event or a forked",
    "start": "3264359",
    "end": "3271920"
  },
  {
    "text": "repository right um that's a good question I'm not sure I think I would have to check the the",
    "start": "3271920",
    "end": "3277500"
  },
  {
    "text": "documentation there on GitHub there are many events there there's a list I use the most kind of simple ones for the",
    "start": "3277500",
    "end": "3283200"
  },
  {
    "text": "demonstration but I'm not sure there is um yeah I'm not sure okay",
    "start": "3283200",
    "end": "3290640"
  },
  {
    "text": "any other questions yeah go ahead",
    "start": "3290640",
    "end": "3296660"
  },
  {
    "text": "in the organization sorry say that again the token it has by default it has read",
    "start": "3300020",
    "end": "3308160"
  },
  {
    "text": "and write permissions in that Repository so it can only change that repo",
    "start": "3308160",
    "end": "3314040"
  },
  {
    "text": "no no it's just for that repo yeah and it's only valid while the action the the",
    "start": "3314040",
    "end": "3321420"
  },
  {
    "text": "VM is up once the VM is down the token is is gone",
    "start": "3321420",
    "end": "3327720"
  },
  {
    "text": "okay any other questions okay",
    "start": "3327720",
    "end": "3333480"
  },
  {
    "text": "yeah go ahead",
    "start": "3333480",
    "end": "3336200"
  },
  {
    "text": "as many as you want yeah yeah exactly very very great just like uh yeah like a",
    "start": "3339740",
    "end": "3347160"
  },
  {
    "text": "tree has many branches and just like your libraries right so yeah same thing",
    "start": "3347160",
    "end": "3353520"
  },
  {
    "text": "okay uh let me switch back to the slides and I'll definitely share those later",
    "start": "3353520",
    "end": "3358980"
  },
  {
    "text": "but this is kind of the reference that I used kind of mostly hopefully show up mostly the GitHub security lab blogs and",
    "start": "3358980",
    "end": "3366960"
  },
  {
    "text": "there was some r2c uh dot Dev blogs the one the developers of Sam grapp",
    "start": "3366960",
    "end": "3372240"
  },
  {
    "text": "maintainers of simgrap as well and yeah thanks everyone for joining uh I hope",
    "start": "3372240",
    "end": "3378000"
  },
  {
    "text": "you enjoy it and I'll be available throughout the event today and tomorrow if you want to talk about it this topic",
    "start": "3378000",
    "end": "3383819"
  },
  {
    "text": "or any other topics sounds good thank you",
    "start": "3383819",
    "end": "3389119"
  }
]