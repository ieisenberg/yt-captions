[
  {
    "text": "all right hello everyone thanks for coming uh my name is Jimmy Bogard um you",
    "start": "6120",
    "end": "11719"
  },
  {
    "text": "can still find me on Twitter SLX formally known as whatever while it's still up I guess atj Bogard and this",
    "start": "11719",
    "end": "19359"
  },
  {
    "text": "presentation uh as well as the code is on my GitHub at github.com JJ Bogard and",
    "start": "19359",
    "end": "25119"
  },
  {
    "text": "then uh I blog about this and other topics on my blog at Jimmy bard.com",
    "start": "25119",
    "end": "30160"
  },
  {
    "text": "so this talk is uh it comes from like most of my talks it's coming from a client experience and this is basically",
    "start": "30160",
    "end": "36920"
  },
  {
    "text": "about 12 months of my life at one point uh migrating an existing net 48 application uh an aspnet mvc5 something",
    "start": "36920",
    "end": "45000"
  },
  {
    "text": "uh over to at the time is net 6 and now has been migrated to net 8 um there's not a whole lot of things that have",
    "start": "45000",
    "end": "51280"
  },
  {
    "text": "changed from like net 6 net 8 uh but when they come up with those things I'll I'll make sure and highlight",
    "start": "51280",
    "end": "57680"
  },
  {
    "text": "them so like any kind of uh migration um I try not to have the migration being",
    "start": "57680",
    "end": "64239"
  },
  {
    "text": "kind of a big bang all at once sort of deployment um ideally what we can do is",
    "start": "64239",
    "end": "70240"
  },
  {
    "text": "incrementally uh migrate an application from like the old state to the new state",
    "start": "70240",
    "end": "75479"
  },
  {
    "text": "and then be able to deploy those changes out to production as we go um and so this actually reminds me a lot of how we",
    "start": "75479",
    "end": "80920"
  },
  {
    "text": "build highways in Texas which is like all the time we're building highways um and so when we're looking at uh some",
    "start": "80920",
    "end": "87680"
  },
  {
    "text": "kind of like okay we have an existing Road here and we need to upgrade it to a",
    "start": "87680",
    "end": "92799"
  },
  {
    "text": "nicer newer Road um what they don't do is like build a completely new road to the side and just like this pristine",
    "start": "92799",
    "end": "99600"
  },
  {
    "text": "green field conditions and then one day like five years into construction it's done and then just like flip the switch",
    "start": "99600",
    "end": "105079"
  },
  {
    "text": "and everyone goes and uses the new road uh that's not how they do things instead it's a very incremental process where",
    "start": "105079",
    "end": "110600"
  },
  {
    "text": "they'll do sections of the road one at a time and during those periods of like two roads like like one is new and one",
    "start": "110600",
    "end": "117119"
  },
  {
    "text": "is old like there'll be some bumpy transitions from one to the next and so uh we'll see the similar kind of thing",
    "start": "117119",
    "end": "123520"
  },
  {
    "text": "in our migration as well in order to avoid a really you know risky big bang you know hope hope it all works flip the",
    "start": "123520",
    "end": "130119"
  },
  {
    "text": "switch sort of deployment instead we're going to be doing a very incremental migration but uh during that migration",
    "start": "130119",
    "end": "135480"
  },
  {
    "text": "things may not look super clean or great but the idea is that by the end we'll have a nice new system we're working",
    "start": "135480",
    "end": "142120"
  },
  {
    "text": "with and then we'll have to remove all those shims and and whatnot over the over the time",
    "start": "142120",
    "end": "147239"
  },
  {
    "text": "there so um this was the picture that we looked at uh coming into net uh so this",
    "start": "147239",
    "end": "152959"
  },
  {
    "text": "is the net versions that have existed over time so this application that I was",
    "start": "152959",
    "end": "158080"
  },
  {
    "text": "working with um actually got started like somewhere around here 2008 2009 um",
    "start": "158080",
    "end": "166720"
  },
  {
    "text": "and was on you know some NET Framework either 35 or soon was upgraded to net 4.0 um and it was continuously uh built",
    "start": "166720",
    "end": "175000"
  },
  {
    "text": "and uh improved over time so new features are being added um all the way up until when we started the project",
    "start": "175000",
    "end": "180239"
  },
  {
    "text": "which is around uh around right here about 2022 2023 here so it had like 15",
    "start": "180239",
    "end": "186760"
  },
  {
    "text": "years or so of features being continuously added to this application and uh the reason why they were wanting",
    "start": "186760",
    "end": "192560"
  },
  {
    "text": "to do this migration is because you can see here actually let's just zoom into this part we're like this is the last",
    "start": "192560",
    "end": "197920"
  },
  {
    "text": "version of net 4 right here which was 2019 so that's like that's it there's",
    "start": "197920",
    "end": "203680"
  },
  {
    "text": "there's no more uh no no more of those being released and at the time Microsoft said like we'll give it you know five",
    "start": "203680",
    "end": "210200"
  },
  {
    "text": "years of support and then it's end of life and then like five years go by and they're like aha just kidding we're going to support it forever um so",
    "start": "210200",
    "end": "216680"
  },
  {
    "text": "technically this client could have stayed on that framework forever I guess",
    "start": "216680",
    "end": "222080"
  },
  {
    "text": "uh but they started to notice a problem where like none of the packages none of the dependencies and other control",
    "start": "222080",
    "end": "227200"
  },
  {
    "text": "libraries they were depending on were being updated anymore so like well if we wanted to ensure that this application",
    "start": "227200",
    "end": "233439"
  },
  {
    "text": "can keep going uh forward in the future we need to jump ship get off of NET Framework and onto um at the time was",
    "start": "233439",
    "end": "240200"
  },
  {
    "text": "going to beet 6 and eventually waset 8 so during this time period you could see like net core and Net Framework were",
    "start": "240200",
    "end": "246360"
  },
  {
    "text": "still getting released and being developed at the same time that at some point Microsoft had to decide like we're",
    "start": "246360",
    "end": "251879"
  },
  {
    "text": "going to just put our eggs in this basket and just go to net core now it's just net 567 and",
    "start": "251879",
    "end": "257400"
  },
  {
    "text": "eight um so uh this is an application that again have been continuously",
    "start": "257400",
    "end": "262479"
  },
  {
    "text": "developed for over 10 years which means that there is a lot of things going on in the application so me as a consultant",
    "start": "262479",
    "end": "269360"
  },
  {
    "text": "you know the the first thing we get asked is like well yes we want to upgrade but how much is it going to cost so I have to understand like well what",
    "start": "269360",
    "end": "275520"
  },
  {
    "text": "what is the relative size and scope of the of the thing we're trying to achieve here um and how big is the application",
    "start": "275520",
    "end": "280759"
  },
  {
    "text": "and how much work is it going to take to actually uh to migrate it over and there's a few different ways I do this",
    "start": "280759",
    "end": "286280"
  },
  {
    "text": "um uh I like to get a just kind of a catalog of everything the application does as well as like all the",
    "start": "286280",
    "end": "292520"
  },
  {
    "text": "dependencies it's using any kind of libraries things like that just to understand um are these things what's",
    "start": "292520",
    "end": "298720"
  },
  {
    "text": "the migration Pat for each of these different items so I'm looking for things like all the MVC endpoints so these are like MVC",
    "start": "298720",
    "end": "306440"
  },
  {
    "text": "and API controllers and actions I'm also looking for all the non MVC HTTP endpoints and this is one of those ones",
    "start": "306440",
    "end": "313080"
  },
  {
    "text": "like I forgot that all these things even existed so there's things like ashx files that can just uh can handle",
    "start": "313080",
    "end": "320160"
  },
  {
    "text": "requests and I just I I just like put these all out of my mind but looking at a legacy application like okay the the",
    "start": "320160",
    "end": "326120"
  },
  {
    "text": "pain comes rushing back of all these things that are now gone so those still do be migrated as well somehow um we're",
    "start": "326120",
    "end": "333400"
  },
  {
    "text": "also looking at any kind of middleware that we have going on in the application so what are the kind of extension points",
    "start": "333400",
    "end": "338440"
  },
  {
    "text": "the developers have put into the MVC application over time um also looking at",
    "start": "338440",
    "end": "343919"
  },
  {
    "text": "any like regular ASP net middleware all that web config junk um and then uh Library dependencies component",
    "start": "343919",
    "end": "350000"
  },
  {
    "text": "dependencies so what are all the things that are outside of the Microsoft set of kind of standard tool is this application using to be able to uh run",
    "start": "350000",
    "end": "357440"
  },
  {
    "text": "its system now I didn't build something this crazy I just built like a representative",
    "start": "357440",
    "end": "362680"
  },
  {
    "text": "uh uh application so this one um is try to match as much as possible the different kinds of things I ran into",
    "start": "362680",
    "end": "369120"
  },
  {
    "text": "into this system and I will say like this is a very much like a personal story of how we migrated this application and the dependencies we ran",
    "start": "369120",
    "end": "375599"
  },
  {
    "text": "into there a lot of them are pretty common in applications I've seen in different uh you know different clients",
    "start": "375599",
    "end": "381520"
  },
  {
    "text": "over the years um but you know you're definitely going to have some Library where you're like well how did you hand",
    "start": "381520",
    "end": "386800"
  },
  {
    "text": "handle this dependency like well if we didn't have to handle it I didn't care about it so there'll definitely be uh some of those in here as well so this",
    "start": "386800",
    "end": "394400"
  },
  {
    "text": "application is just mvc5 with razor uh view engine um you know there's another",
    "start": "394400",
    "end": "399840"
  },
  {
    "text": "view engine as well no web forms view engine so the very first version of MVC",
    "start": "399840",
    "end": "406599"
  },
  {
    "text": "used web forms as the view engine and luckily this one was not using that one because that would have been a complete disaster so this is still using Razer as",
    "start": "406599",
    "end": "413120"
  },
  {
    "text": "the view engine um it was not a spa so it was like still server side rendered which I guess is now back in again like",
    "start": "413120",
    "end": "419879"
  },
  {
    "text": "people are now doing that again so huzzah um it was using signal R for like you know notifications to like hey this",
    "start": "419879",
    "end": "426599"
  },
  {
    "text": "is this job has been completed that sort of thing uh of course it was using session State um this was in a web Farm",
    "start": "426599",
    "end": "432639"
  },
  {
    "text": "scenario so the session state was stored in SQL Server uh it used hangfire and uh",
    "start": "432639",
    "end": "438000"
  },
  {
    "text": "if you've never used hangfire we'll get into a little bit more details on that but that it presented its own kind of special set of problems for us and in",
    "start": "438000",
    "end": "444479"
  },
  {
    "text": "terms of like the application architecture itself if you kind of rewind time to like 2010 this was that",
    "start": "444479",
    "end": "450199"
  },
  {
    "text": "state-of-the-art so think like onion architecture uh let's see like you know",
    "start": "450199",
    "end": "456240"
  },
  {
    "text": "lots of different projects and stuff now we call it clean but back then was called onion um but it was just like this is the way the way to do things uh",
    "start": "456240",
    "end": "462680"
  },
  {
    "text": "back in 2010 so I knew that we were going to have to upgrade every single page in the",
    "start": "462680",
    "end": "469120"
  },
  {
    "text": "application but I needed to understand like how many pages actually exist in here so instead of having someone like",
    "start": "469120",
    "end": "474879"
  },
  {
    "text": "kind of Click around and just kind of catalog all the pages I just wrote a little bit of code that uses the code",
    "start": "474879",
    "end": "480159"
  },
  {
    "text": "doesn't matter but it's basically using reflection to uh examine the different",
    "start": "480159",
    "end": "485240"
  },
  {
    "text": "controllers and types in the system and spit out just a spreadsheet of like here are all the different controllers here",
    "start": "485240",
    "end": "491520"
  },
  {
    "text": "are all the different uh the number of actions on each of those controllers and then I'm also just like getting other any other kind of Statistics to see like",
    "start": "491520",
    "end": "498360"
  },
  {
    "text": "well how difficult is it for us to migrate this one individual thing so I maybe even looking at things like you",
    "start": "498360",
    "end": "503639"
  },
  {
    "text": "know what what controller action attributes are on there for filters because maybe if there's more filters it's harder to migrate that sort of",
    "start": "503639",
    "end": "509960"
  },
  {
    "text": "thing uh but really what I'm trying to do is trying to get uh just you know how big is this application and then also",
    "start": "509960",
    "end": "515440"
  },
  {
    "text": "trying to understand where should I start what should be the first one we migrate and ideally it's not like the",
    "start": "515440",
    "end": "520719"
  },
  {
    "text": "hardest one but it's also not the most trivial one we want to pick something that brings in enough kind of stuff for",
    "start": "520719",
    "end": "526080"
  },
  {
    "text": "us to kind of prove out this this way of us doing this uh but not Pi like the most complicated thing in",
    "start": "526080",
    "end": "533120"
  },
  {
    "text": "here um we also looked at uh the different kind of NVC features in middleware was using there's nothing too",
    "start": "533120",
    "end": "539160"
  },
  {
    "text": "too interesting here um we do see some like um like there's some enti framework junk here so this application was using",
    "start": "539160",
    "end": "546240"
  },
  {
    "text": "ef6 um and then it's it's using like some special view engine uh for whatever",
    "start": "546240",
    "end": "551600"
  },
  {
    "text": "reason over here um and then we also had some special filters uh as part of this",
    "start": "551600",
    "end": "557399"
  },
  {
    "text": "so uh as we're going through the application we have to understand are these things that we actually want to migrate to aspnet core um are these",
    "start": "557399",
    "end": "564160"
  },
  {
    "text": "things that are just you know out of the box with it or is it something again I have to write custom code to extend the framework to do you know whatever it is",
    "start": "564160",
    "end": "570440"
  },
  {
    "text": "this middleware junk is um and I also forgot that like back",
    "start": "570440",
    "end": "576040"
  },
  {
    "text": "in those days there wasn't just aspnet aspet and VC there was this whole Owen thing the open web interface for Nets",
    "start": "576040",
    "end": "583760"
  },
  {
    "text": "which again I just completely put out of my head I forgot about but that has its own individual set of like middleware",
    "start": "583760",
    "end": "589320"
  },
  {
    "text": "configuration uh that you know vaguely resembles now what we see today of services. app dot but this has some",
    "start": "589320",
    "end": "595040"
  },
  {
    "text": "stuff there as well so here we can see that it's got does have signal R it's got hang the dashboard and the server",
    "start": "595040",
    "end": "601160"
  },
  {
    "text": "and it's doing um some configuration for hangfire there with a SQL backend so",
    "start": "601160",
    "end": "607079"
  },
  {
    "text": "again these are all things that I'm going to have to build a plan for to migrate over to the new application in",
    "start": "607079",
    "end": "612440"
  },
  {
    "text": "terms of the ASP net middleware this is again like I just forgot how painful this used to be of like going through",
    "start": "612440",
    "end": "618040"
  },
  {
    "text": "the magical XML web config file to see all the kind of custom little doodad things that have been put in over the",
    "start": "618040",
    "end": "623240"
  },
  {
    "text": "years and see like is this even being used today is it Just Junk that Someone pasted in8 years ago we forgot about and",
    "start": "623240",
    "end": "629320"
  },
  {
    "text": "now it's just kind of lives on forever um so here for example um I see that it's doing uh nothing too interesting",
    "start": "629320",
    "end": "635600"
  },
  {
    "text": "like compilation runtime whatever it does have custom errors on and has a custom error page uh which for some",
    "start": "635600",
    "end": "641519"
  },
  {
    "text": "reason is web forms like I don't know why the 404 page was a web forms page but it was back then um and then this",
    "start": "641519",
    "end": "648839"
  },
  {
    "text": "library that is dead now a glimpse uh which I still miss um I'm also looking at all the",
    "start": "648839",
    "end": "654680"
  },
  {
    "text": "dependencies like this is not an exhaustive list but just understand like what other librar is this thing uh",
    "start": "654680",
    "end": "660279"
  },
  {
    "text": "depending on and how can we then uh migrate each of these dependencies up to something that can run on net",
    "start": "660279",
    "end": "666079"
  },
  {
    "text": "core so right when we started this project um we know we had the question of like well how are we actually going",
    "start": "666079",
    "end": "671760"
  },
  {
    "text": "to perform this migration and prior to net 6 this kind of migration from net 4",
    "start": "671760",
    "end": "678240"
  },
  {
    "text": "something to net core used to be like a huge huge pain um so in the past the way",
    "start": "678240",
    "end": "685680"
  },
  {
    "text": "we would do this would be to have you know the new applic which is the net core application the aspet core",
    "start": "685680",
    "end": "692120"
  },
  {
    "text": "application we have the existing application and then we would manually migrate one page at a time from the",
    "start": "692120",
    "end": "699079"
  },
  {
    "text": "aspet uh aspet 5 application to the aspnet core application um and then in",
    "start": "699079",
    "end": "704760"
  },
  {
    "text": "order for us to have these little switch overs from one application to the other we would put a reverse proxy um like",
    "start": "704760",
    "end": "711320"
  },
  {
    "text": "engine X or something in front of those two applications and then mainly go into the routing of the engine x file and say",
    "start": "711320",
    "end": "717720"
  },
  {
    "text": "okay this Sprint we've Mig ated these controllers so go ahead and add those entries into the engine x file to say",
    "start": "717720",
    "end": "723320"
  },
  {
    "text": "now those requests should go over to this application instead uh so something that Microsoft",
    "start": "723320",
    "end": "729120"
  },
  {
    "text": "released like literally like a month before we started this project it was fantastic um are this poorly named",
    "start": "729120",
    "end": "734399"
  },
  {
    "text": "library but whatever it's called the system.web adapters uh and so this uh library is uh it's a nougat package um",
    "start": "734399",
    "end": "741959"
  },
  {
    "text": "but also includes some Visual Studio extensions which you don't have to use but I'll be showing those here in a bit um what these what this library and some",
    "start": "741959",
    "end": "748240"
  },
  {
    "text": "of the tools uh available for us make it 8,000 times easier and I've calculated that 8,000 times easier to migrate from",
    "start": "748240",
    "end": "755680"
  },
  {
    "text": "an existing aspnet application to an asp net core application in an incremental fashion now they they did also release",
    "start": "755680",
    "end": "762839"
  },
  {
    "text": "like a like an automatic migration tool but I don't know about you I don't like staying at 10,000 compile errors as like",
    "start": "762839",
    "end": "769360"
  },
  {
    "text": "the end of my migration result um and so they they ditched all that and said you know what that that never works like",
    "start": "769360",
    "end": "774560"
  },
  {
    "text": "ever uh so instead the only way they really support doing this is through an incremental migration which is what we",
    "start": "774560",
    "end": "779800"
  },
  {
    "text": "want to do anyway we don't want a big bang okay flip the switch and hope it works we want something is very",
    "start": "779800",
    "end": "785279"
  },
  {
    "text": "incremental so this is our application today we have incoming requests that go to our asp.net 5 application and then it",
    "start": "785279",
    "end": "792399"
  },
  {
    "text": "has you know that relies on some business logic and database in the back end so the system. a web adapters piece",
    "start": "792399",
    "end": "799720"
  },
  {
    "text": "comes in um via a new aspet core application and so now the requests go",
    "start": "799720",
    "end": "806959"
  },
  {
    "text": "straight to that aspnet core application and the system web adapters what it does is it includes a reverse proxy in that",
    "start": "806959",
    "end": "813360"
  },
  {
    "text": "same application so this is yarp yet another reverse proxy is now hosted inside of the new aspet core application",
    "start": "813360",
    "end": "820360"
  },
  {
    "text": "and if the aspet core application cannot handle the requests it will seamlessly",
    "start": "820360",
    "end": "825399"
  },
  {
    "text": "and silently reverse proxy that request over to our dinet framework application",
    "start": "825399",
    "end": "831519"
  },
  {
    "text": "so just like if the controller doesn't exist over there it will automatically forward that request over to an existing",
    "start": "831519",
    "end": "838320"
  },
  {
    "text": "application so we do have to deploy this out though right we do have to have a new aspnet core application deployed out somewhere",
    "start": "838320",
    "end": "845079"
  },
  {
    "text": "so that is going to be some extra complexity um in our kind of deployment pipeline uh and build and deployment",
    "start": "845079",
    "end": "851399"
  },
  {
    "text": "process but we don't have to include another reverse proxy in front of this so prior to this tool I would have to",
    "start": "851399",
    "end": "857680"
  },
  {
    "text": "have engine X somewhere over there maybe it was already there but in any case I would have to have a reverse proxy in",
    "start": "857680",
    "end": "862959"
  },
  {
    "text": "front of all this and then manually as new things came online manually include that configuration to go to the right",
    "start": "862959",
    "end": "870000"
  },
  {
    "text": "application now if the aset core application can serve that request it will just serve the request and if it",
    "start": "870000",
    "end": "877440"
  },
  {
    "text": "can't automatically forward over to the donet framework app for any kind of request so this is like you know static",
    "start": "877440",
    "end": "885880"
  },
  {
    "text": "files like actual Pages aspx ASA like anything um if it can't handle that",
    "start": "885880",
    "end": "891279"
  },
  {
    "text": "request gets fored over to the doet framework application this also supports signal r as well so just like magically",
    "start": "891279",
    "end": "897920"
  },
  {
    "text": "we'll be able to like for the proxy of the signal R request over to the dnet framework application if that uh",
    "start": "897920",
    "end": "903279"
  },
  {
    "text": "framework application is the signal R server uh so the other thing that it",
    "start": "903279",
    "end": "909079"
  },
  {
    "text": "provides you that we didn't really use that much were also adapters so you might have a lot of business logic code",
    "start": "909079",
    "end": "916279"
  },
  {
    "text": "hopefully not that's doing like system. web junk like HTTP contact. something um",
    "start": "916279",
    "end": "922519"
  },
  {
    "text": "so those two interfaces are like the the the HP context junk and the HP net core",
    "start": "922519",
    "end": "928680"
  },
  {
    "text": "application is a different like it's a different type different class different name States different project different",
    "start": "928680",
    "end": "934519"
  },
  {
    "text": "assembly it's completely different than the one that exists in the dnet framework application so what the adapters do is say okay we'll know we'll",
    "start": "934519",
    "end": "941959"
  },
  {
    "text": "detect where you're running and if you're running an aspnet core your system.web HP context will forward",
    "start": "941959",
    "end": "948519"
  },
  {
    "text": "automatically to the real objects and if you're over in D framework land then it'll just use like those objects out of",
    "start": "948519",
    "end": "954279"
  },
  {
    "text": "the box again this is only really like really like useful if you have a bunch",
    "start": "954279",
    "end": "962680"
  },
  {
    "text": "of code in your business logic doing system. web junk which hopefully you don't right you probably shouldn't have a bunch of system web stuff in your",
    "start": "962680",
    "end": "969040"
  },
  {
    "text": "business logic but in case you do those adapters are there so now we just quote",
    "start": "969040",
    "end": "975480"
  },
  {
    "text": "um migrate one at a time individual controllers with all their actions all their views over to the aset core",
    "start": "975480",
    "end": "982319"
  },
  {
    "text": "application so over time the aspnet core application becomes bigger and bigger",
    "start": "982319",
    "end": "987720"
  },
  {
    "text": "and the dnet framework application gets smaller and smaller then at some points there are no more controllers over here",
    "start": "987720",
    "end": "995639"
  },
  {
    "text": "there's no more like no more requests being served and so this just lives out there in the web server doing absolutely",
    "start": "995639",
    "end": "1000680"
  },
  {
    "text": "nothing and so at that point it's safe for us to then remove this application uh from everywhere and then now all of",
    "start": "1000680",
    "end": "1008319"
  },
  {
    "text": "our requests are being served by the aspnet core application um easier said than done",
    "start": "1008319",
    "end": "1013720"
  },
  {
    "text": "though so uh I want to do a quick demo of the upgrade ass system just to show you what this looks like and the like",
    "start": "1013720",
    "end": "1019440"
  },
  {
    "text": "the magic behind the scenes so let me go and switch over [Music]",
    "start": "1019440",
    "end": "1025360"
  },
  {
    "text": "to let me",
    "start": "1025360",
    "end": "1029038"
  },
  {
    "text": "stop all right there we are okay so this is um",
    "start": "1031880",
    "end": "1040798"
  },
  {
    "text": "this is just file new asp.net web forms or not web forms MVC application um",
    "start": "1040799",
    "end": "1047280"
  },
  {
    "text": "which I haven't had done in forever but you this is it so you can see we've got all the kind of normal stuff here we've got a global asax file again I forgot",
    "start": "1047280",
    "end": "1053880"
  },
  {
    "text": "about that thing we got a web config we've got a just you know just a regular controller so let me just go run this",
    "start": "1053880",
    "end": "1060440"
  },
  {
    "text": "just to make sure it actually can run and I didn't put any kind of other",
    "start": "1060440",
    "end": "1067000"
  },
  {
    "text": "special stuff in here so this literally just file new and that's",
    "start": "1067000",
    "end": "1071679"
  },
  {
    "text": "it of course oh there",
    "start": "1072679",
    "end": "1081440"
  },
  {
    "text": "oh oh my gosh I should have run this back of the",
    "start": "1084600",
    "end": "1089720"
  },
  {
    "text": "hotel oh well it's",
    "start": "1089720",
    "end": "1093280"
  },
  {
    "text": "fine yes yes yes come on you can do it no Postman I don't need you",
    "start": "1095240",
    "end": "1103158"
  },
  {
    "text": "oh wow web forms is so bad it won't even show the application here all right well",
    "start": "1109840",
    "end": "1115280"
  },
  {
    "text": "it's fine I don't know why it's not working but whatever so the the important bit though is this this upgrade process so what I'll do here is",
    "start": "1115280",
    "end": "1122159"
  },
  {
    "text": "and again you don't have to do this via Visual Studio there's command line tools do to do all this but this just does",
    "start": "1122159",
    "end": "1127520"
  },
  {
    "text": "some of the magic Force so I right click this guy and I say upgrade this upgrade here comes from theate Upgrade Assistant",
    "start": "1127520",
    "end": "1135400"
  },
  {
    "text": "from my extensions here so if I go to look at my extensions I can see that I have this one right here the net Upgrade",
    "start": "1135400",
    "end": "1142919"
  },
  {
    "text": "Assistant that's the one that does the visual studio tooling again we don't have to use that but it makes for a nice",
    "start": "1142919",
    "end": "1148440"
  },
  {
    "text": "demo so I can rightclick this and say upgrade no not app",
    "start": "1148440",
    "end": "1154240"
  },
  {
    "text": "insights no right click come on upgrade there we",
    "start": "1154240",
    "end": "1161880"
  },
  {
    "text": "go okay so there's two options given to us here one is upgrade project to a",
    "start": "1161880",
    "end": "1167559"
  },
  {
    "text": "newer net version or upgrade the project features I don't even know what the other one is this first one is the one",
    "start": "1167559",
    "end": "1173760"
  },
  {
    "text": "we want we want to upgrade the project to a newer dnet version what is your upgrade type there only one available for us which is a side by-side",
    "start": "1173760",
    "end": "1179640"
  },
  {
    "text": "incremental upgrade let's go ahead and click next and we will create a new project for the asp.net core application",
    "start": "1179640",
    "end": "1187559"
  },
  {
    "text": "and then finally It'll ask us what the name of the new project should be for the aspet core application and the",
    "start": "1187559",
    "end": "1193240"
  },
  {
    "text": "project template so MVC or web API I mean again we don't have to like pick",
    "start": "1193240",
    "end": "1198440"
  },
  {
    "text": "one these things but it just makes our lives a little bit easier um and then finally it says what's our uh what's our",
    "start": "1198440",
    "end": "1203880"
  },
  {
    "text": "Target framework we want we want net 8 the latest LTS version",
    "start": "1203880",
    "end": "1210759"
  },
  {
    "text": "okay so it's doing some junk it's added a new project there for",
    "start": "1211720",
    "end": "1218400"
  },
  {
    "text": "us it's configuring the project dependencies so I'll look at I'll dig into the dependencies here in a",
    "start": "1218559",
    "end": "1224240"
  },
  {
    "text": "minute and it's done okay so let's take a look and see what",
    "start": "1224240",
    "end": "1229919"
  },
  {
    "text": "happened behind the scenes here so this project let me go ahead and bump the",
    "start": "1229919",
    "end": "1236320"
  },
  {
    "text": "font a little bit okay so this is just a normal",
    "start": "1236320",
    "end": "1242760"
  },
  {
    "text": "vanilla asp.net core project so it's using the microsoft. net STK web project type targeting donet 8s with the c",
    "start": "1242760",
    "end": "1250280"
  },
  {
    "text": "features whatever and really the only thing that's added are these two project references the system web adapters core",
    "start": "1250280",
    "end": "1256120"
  },
  {
    "text": "services and then yarp so yarp is the magic that just that's doing the reverse proxy for",
    "start": "1256120",
    "end": "1262960"
  },
  {
    "text": "us in the actual code itself most of it looks pretty normal for an aspet core",
    "start": "1262960",
    "end": "1268440"
  },
  {
    "text": "application except for we've got a couple additional things here for adding system web adapters the the these are",
    "start": "1268440",
    "end": "1274840"
  },
  {
    "text": "the adapters for system.web stuff and then also adding the HTTP forwarder so this is configuring that reverse proxy",
    "start": "1274840",
    "end": "1281440"
  },
  {
    "text": "to be able to if I can't handle this results uh response successfully go ahead and for that over to um the as",
    "start": "1281440",
    "end": "1288600"
  },
  {
    "text": "p.net application normal junk normal junk normal junk normal junk normal junk and",
    "start": "1288600",
    "end": "1294679"
  },
  {
    "text": "then finally down here we say use system web adapters now the the order of this is important because now we're in",
    "start": "1294679",
    "end": "1300080"
  },
  {
    "text": "middleware land we want the forwarder to be the very last thing that happens so after we map the default controller",
    "start": "1300080",
    "end": "1306200"
  },
  {
    "text": "route and any other routing that you're doing like uh minimal API junk whatever the very very very last thing you need",
    "start": "1306200",
    "end": "1311840"
  },
  {
    "text": "to do is map the forer that just says okay for everything else if nothing else is able to handle this request",
    "start": "1311840",
    "end": "1317720"
  },
  {
    "text": "successfully then you will forward this over on to uh this proxy to uh address",
    "start": "1317720",
    "end": "1324000"
  },
  {
    "text": "which is proxy 2 it's going to be over here my",
    "start": "1324000",
    "end": "1330039"
  },
  {
    "text": "launch settings um there we are proxy 2 Local Host",
    "start": "1330039",
    "end": "1336080"
  },
  {
    "text": "44331 and so that Local Host is the uh the URL for the asp.net",
    "start": "1336080",
    "end": "1344200"
  },
  {
    "text": "application so just a little bit of configuration to say the the other application is over here so in each",
    "start": "1344200",
    "end": "1350279"
  },
  {
    "text": "environments I'll have to put the right value of that in there so like you know my Dev QA environments prod then those",
    "start": "1350279",
    "end": "1357159"
  },
  {
    "text": "uh values for the for the forwarding proxy to address will be different the other thing that's",
    "start": "1357159",
    "end": "1362600"
  },
  {
    "text": "different here is when I launch this application or launch the solution uh visual Studios also configured for both",
    "start": "1362600",
    "end": "1369520"
  },
  {
    "text": "of these applications to run where previously it was just the asp.net application now when I hit F5 it's going",
    "start": "1369520",
    "end": "1375960"
  },
  {
    "text": "to be running both of them because both of them have to be up and running for me to successfully be able to handle requests it is kind of funny because you",
    "start": "1375960",
    "end": "1382640"
  },
  {
    "text": "can like you can just uh serve requests from the asp.net 5 application or the",
    "start": "1382640",
    "end": "1389240"
  },
  {
    "text": "asp.net core and then you have this like weird thing that sometimes things don't work but uh we'll have both of them up",
    "start": "1389240",
    "end": "1394720"
  },
  {
    "text": "and writing here ah okay so Local Host 7023 this is",
    "start": "1394720",
    "end": "1402640"
  },
  {
    "text": "the aspnet core application except if you look closely here it's like all",
    "start": "1402640",
    "end": "1409480"
  },
  {
    "text": "about asp.net like the previous version um so it is successfully serving those",
    "start": "1409480",
    "end": "1415320"
  },
  {
    "text": "requests from the uh asp.net application and in my aspn net core application we can see",
    "start": "1415320",
    "end": "1422520"
  },
  {
    "text": "that there's no controllers or anything in there so this application is just transparently serving all the requests",
    "start": "1422520",
    "end": "1428760"
  },
  {
    "text": "from the asp.net uh underlying application so how do we get this thing",
    "start": "1428760",
    "end": "1434919"
  },
  {
    "text": "to now serve its own requests so one way we can do this and",
    "start": "1434919",
    "end": "1440880"
  },
  {
    "text": "this is not something we actually did in a project but again makes for a nice demo I can rightclick this controller",
    "start": "1440880",
    "end": "1446960"
  },
  {
    "text": "and say upgrade controller this will almost certainly not work for you but it's at least nice to see like okay what",
    "start": "1446960",
    "end": "1452919"
  },
  {
    "text": "are the kinds of things we have to worry about when we migrate from one to the other so let's go ahead and say",
    "start": "1452919",
    "end": "1459240"
  },
  {
    "text": "upgrade upgrade selection so it's like what do you want to upgrade I want to upgrade the controller and also it will",
    "start": "1465360",
    "end": "1472399"
  },
  {
    "text": "look to see what other types are being used in this as well so if I have business logic we'll get into that a",
    "start": "1472399",
    "end": "1477440"
  },
  {
    "text": "little bit um it won't just like magically upgrade all that code as well so typically I'm having to dig into the",
    "start": "1477440",
    "end": "1482840"
  },
  {
    "text": "controller to see like what the heck is this thing doing upgrade all that stuff first and then come back into the controller itself but this is saying",
    "start": "1482840",
    "end": "1489440"
  },
  {
    "text": "okay we're going to upgrade the default routes these these individual views we're going to go ahead and upgrade all these",
    "start": "1489440",
    "end": "1495760"
  },
  {
    "text": "things and it's going to work fantastic right we'll",
    "start": "1495760",
    "end": "1502919"
  },
  {
    "text": "see is it done yes it's done okay so uh we can see over here that now we have a",
    "start": "1503159",
    "end": "1509279"
  },
  {
    "text": "home controller we have our our view Imports The View start we even have our uh our layout pulled in as well so it it",
    "start": "1509279",
    "end": "1516760"
  },
  {
    "text": "was pretty smart to be able to pull in all these different things so let's launch it and see how it runs spoiler not too great but whatever",
    "start": "1516760",
    "end": "1527520"
  },
  {
    "text": "oh that looks great right ah yeah this is one of those like",
    "start": "1532960",
    "end": "1538240"
  },
  {
    "text": "very disappointing moments like oh this is going to be so easy for the migration the first page shows up like oh not so",
    "start": "1538240",
    "end": "1543799"
  },
  {
    "text": "easy so what's going on here none of the static assets loaded so uh if I look at",
    "start": "1543799",
    "end": "1550159"
  },
  {
    "text": "the network tab go ahead and refresh",
    "start": "1550159",
    "end": "1555480"
  },
  {
    "text": "this well it didn't even now all of them it's not even requesting other",
    "start": "1555480",
    "end": "1562360"
  },
  {
    "text": "things it's like got the fav icon something with the hnet core and visual studio but like none of the other CSS",
    "start": "1562360",
    "end": "1568200"
  },
  {
    "text": "and stuff showed up here they're just they're just completely missing uh so why is that well let's go look at the",
    "start": "1568200",
    "end": "1573440"
  },
  {
    "text": "code itself to see if there's any clues about why this doesn't look so hot all right so first we'll go Ahad and",
    "start": "1573440",
    "end": "1580880"
  },
  {
    "text": "look at the controller um okay so it looks there's no compile errors or anything like this",
    "start": "1580880",
    "end": "1587240"
  },
  {
    "text": "so there's nothing really suspicious here and if I go back to the other controller we can see what are the exact",
    "start": "1587240",
    "end": "1592320"
  },
  {
    "text": "things that have actually changed as part of this so it says it's it's you know this is the this is the aspn net 5",
    "start": "1592320",
    "end": "1598679"
  },
  {
    "text": "version so it's a controller inheriting from you know some base controller class the other one is the same but it's a",
    "start": "1598679",
    "end": "1605440"
  },
  {
    "text": "different one right it's the Microsoft aset core. NBC controller versus this",
    "start": "1605440",
    "end": "1610480"
  },
  {
    "text": "one is the system web MPC controller right so they're different types different name spaces different packages",
    "start": "1610480",
    "end": "1616440"
  },
  {
    "text": "blah blah blah but it looks very very very similar so the controller classes themselves usually are pretty",
    "start": "1616440",
    "end": "1621880"
  },
  {
    "text": "straightforward to to upgrade like there may be some slight name space things you have to fix or if you're doing like",
    "start": "1621880",
    "end": "1627080"
  },
  {
    "text": "really weird things with action results but for the most part like this this is pretty pretty straightforward here okay",
    "start": "1627080",
    "end": "1634240"
  },
  {
    "text": "what about our views so let's go look at our view Imports first okay so this looks I don't know looks okay there's",
    "start": "1634240",
    "end": "1640960"
  },
  {
    "text": "nothing uh out of the ordinary here view starts just gives me a layout that's what we saw over here as well there's",
    "start": "1640960",
    "end": "1647360"
  },
  {
    "text": "the layout um all right so let's go ahead and look at our home index page",
    "start": "1647360",
    "end": "1653640"
  },
  {
    "text": "and this looks just like normal HTML there's not even like any",
    "start": "1653640",
    "end": "1659080"
  },
  {
    "text": "any tag helpers or anything like that here so this is all all well and good and finally let's look at our",
    "start": "1659080",
    "end": "1665518"
  },
  {
    "text": "layout so this is our first big hurdle that we ran into um that aspnet core",
    "start": "1669360",
    "end": "1675200"
  },
  {
    "text": "does not have any out-of-the-box support for bundling or minification which I mean I guess is a good thing",
    "start": "1675200",
    "end": "1681279"
  },
  {
    "text": "because that's like it's like a solved problem now however our application our asp5 application was happily using the",
    "start": "1681279",
    "end": "1688440"
  },
  {
    "text": "heck out of bundling am minification and so we can see here like it doesn't it can't do that that that is not a feature",
    "start": "1688440",
    "end": "1694760"
  },
  {
    "text": "that exists or will ever exist in asp.net core so why don't we see nice styling it's not even rendering The",
    "start": "1694760",
    "end": "1700880"
  },
  {
    "text": "Styling whatsoever so sad trumbone we have to fix all of these different like",
    "start": "1700880",
    "end": "1706279"
  },
  {
    "text": "script blocks and styles and and all this bundling and minification just does not exist in as net",
    "start": "1706279",
    "end": "1713039"
  },
  {
    "text": "core all right so the the kind the Highlight oh there's",
    "start": "1715399",
    "end": "1720440"
  },
  {
    "text": "one thing I wanted to show one last thing sorry back in my asp.net",
    "start": "1720440",
    "end": "1726559"
  },
  {
    "text": "45 application I wanted to show what things were changed there",
    "start": "1726559",
    "end": "1732760"
  },
  {
    "text": "so um one of the things that was added were some additional packages for uh",
    "start": "1732760",
    "end": "1738880"
  },
  {
    "text": "this web infrastructure stuff and in our Global asax uh oh we don't have even have that",
    "start": "1738880",
    "end": "1746159"
  },
  {
    "text": "yet so actually nothing was changed here it's just as it was before that will change shortly though",
    "start": "1746159",
    "end": "1754440"
  },
  {
    "text": "here okay so the Upgrade Assistant is nice for that very first step of the",
    "start": "1754440",
    "end": "1759880"
  },
  {
    "text": "like rightclick upgrade and increase the ASP net core project with the right package references you don't have to use",
    "start": "1759880",
    "end": "1765799"
  },
  {
    "text": "it right it's just a couple nou get packages and some configuration in my middleware to be able to be able to",
    "start": "1765799",
    "end": "1772399"
  },
  {
    "text": "serve those requests now not that big of a deal so our very first step when we",
    "start": "1772399",
    "end": "1778320"
  },
  {
    "text": "were uh doing this migration the very first thing we wanted to do was just get that an empty application that does",
    "start": "1778320",
    "end": "1784840"
  },
  {
    "text": "absolutely nothing like it doesn't serve any requests all the way out to production so this one was uh really",
    "start": "1784840",
    "end": "1792320"
  },
  {
    "text": "just like just doing that migration assistant we right clicked and said upgrade and we wanted to make sure that",
    "start": "1792320",
    "end": "1797480"
  },
  {
    "text": "we can get that all the way out to production so this meant we had to go at this point this application was still",
    "start": "1797480",
    "end": "1803720"
  },
  {
    "text": "being served on Prim and is so we had to go you know install the right uh aspnet",
    "start": "1803720",
    "end": "1808919"
  },
  {
    "text": "core hosting packages on the web servers on the web Farm we had to uh configure",
    "start": "1808919",
    "end": "1814240"
  },
  {
    "text": "is for this new web application we had to migrate or modify all of our build and deploy pipelines to now build and",
    "start": "1814240",
    "end": "1820200"
  },
  {
    "text": "deploy this new uh ASP net core application and make sure that worked all the way out from local debugging all",
    "start": "1820200",
    "end": "1826279"
  },
  {
    "text": "the way out to production but it's application would do absolutely nothing so we're just trying to reduce the amount of risk of all these different",
    "start": "1826279",
    "end": "1833440"
  },
  {
    "text": "stuffs to say let's just make sure we can we can serve requests and then all we did was just like log you know make",
    "start": "1833440",
    "end": "1839279"
  },
  {
    "text": "sure we're logging the requests we you know we're actually serving requests from this application but otherwise uh",
    "start": "1839279",
    "end": "1845240"
  },
  {
    "text": "it did nothing except forward every single request over to the asp.net application now this is where usually",
    "start": "1845240",
    "end": "1851320"
  },
  {
    "text": "these folks are asking like what about performance um because now I have an extra Network hop or at least an extra",
    "start": "1851320",
    "end": "1858279"
  },
  {
    "text": "application op where all requests now go to this aspnet core application and then",
    "start": "1858279",
    "end": "1863519"
  },
  {
    "text": "we'll then serve the request to the aspnet application so there's going to be some overhead with that um but for my",
    "start": "1863519",
    "end": "1869360"
  },
  {
    "text": "clients like they're all Enterprise folks right they're not like building big public websites these are",
    "start": "1869360",
    "end": "1875240"
  },
  {
    "text": "applications with the users in the thousands not with like the millions um still important applications for their",
    "start": "1875240",
    "end": "1881080"
  },
  {
    "text": "customers but like their customers aren't like that necessarily performan minded in the first place and a lot of",
    "start": "1881080",
    "end": "1887600"
  },
  {
    "text": "these pag PES were like making a th SQL queries anyway so I'm like what's a little more latency on top of that no",
    "start": "1887600",
    "end": "1893240"
  },
  {
    "text": "big deal but anyway in our testing it was like it was fairly minimal latency being added because both of these",
    "start": "1893240",
    "end": "1899559"
  },
  {
    "text": "applications still being hosted on the same server so we did not have to do like an extra Network hop it was still",
    "start": "1899559",
    "end": "1905000"
  },
  {
    "text": "just like going to Local Host for all these so it's like I don't know 50 milliseconds maybe for each request that",
    "start": "1905000",
    "end": "1910320"
  },
  {
    "text": "we added on top of it but each request was already taken two seconds we're like what's another 50 milliseconds whatever",
    "start": "1910320",
    "end": "1918000"
  },
  {
    "text": "all right um so the next step we need to do is uh figure out what to do with all",
    "start": "1918000",
    "end": "1923360"
  },
  {
    "text": "of our uh business logic and so for that we'll need to create a shared library",
    "start": "1923360",
    "end": "1929639"
  },
  {
    "text": "that will house all this shared code between the aspnet 45 mvc5 application",
    "start": "1929639",
    "end": "1936000"
  },
  {
    "text": "and the aspnet core 8 application we're not going to share any of the UI logic",
    "start": "1936000",
    "end": "1941159"
  },
  {
    "text": "like those are all just copy paste we're going to duplicate it whatever but for all the business logic and things like",
    "start": "1941159",
    "end": "1947120"
  },
  {
    "text": "your EF core or EF models uh all that other junk um we do want to have share",
    "start": "1947120",
    "end": "1952360"
  },
  {
    "text": "between these two um most folks I know like would already have a library that",
    "start": "1952360",
    "end": "1957600"
  },
  {
    "text": "is being used by the aspnet mvc5 application like they just have like a I don't know a core or domain or something",
    "start": "1957600",
    "end": "1963120"
  },
  {
    "text": "like that um but pretending we don't we'll need to move all of that uh shared code out into some common location that",
    "start": "1963120",
    "end": "1970399"
  },
  {
    "text": "both of these applications can then uh reference and use so what are the things we want to",
    "start": "1970399",
    "end": "1976360"
  },
  {
    "text": "share between these two different applications again none of the UI logic that's just going to be copied and pasted there's no",
    "start": "1976360",
    "end": "1982480"
  },
  {
    "text": "common libraries between aset core and aset mbc5 um so any kind of",
    "start": "1982480",
    "end": "1988559"
  },
  {
    "text": "customizations there uh are just going to have to be duplicated or um maybe even just left behind the things we do",
    "start": "1988559",
    "end": "1995320"
  },
  {
    "text": "want to share is really when we look inside any of our uh controller actions if we kind of remove all of the like UI",
    "start": "1995320",
    "end": "2003000"
  },
  {
    "text": "junk we really want to just do the business logic and so this application um relates all business logic to these",
    "start": "2003000",
    "end": "2009440"
  },
  {
    "text": "these uh handler classes and so these are the things that I want to migrate over into that shared Library so all of",
    "start": "2009440",
    "end": "2016480"
  },
  {
    "text": "our data models those are going to be shared across different requests old and new um so your EF models or EF core well",
    "start": "2016480",
    "end": "2024039"
  },
  {
    "text": "probably ef6 at this point whatever those like common data objects are we'll mod move those",
    "start": "2024039",
    "end": "2029679"
  },
  {
    "text": "over any kind of business logic as well so Services helpers factories all that",
    "start": "2029679",
    "end": "2035960"
  },
  {
    "text": "other junk uh that's not touching kind of like system. web namespace we'll want to uh move into this common location uh",
    "start": "2035960",
    "end": "2042480"
  },
  {
    "text": "and any other like like non UI code we'll want to put in this common location now I don't necessarily migrate",
    "start": "2042480",
    "end": "2048878"
  },
  {
    "text": "everything all at once typically what I'm doing is looking at individual controllers looking inside of the",
    "start": "2048879",
    "end": "2053919"
  },
  {
    "text": "controller saying what are the controllers doing and then any kind of code that is still living in that mvc5",
    "start": "2053919",
    "end": "2059800"
  },
  {
    "text": "project okay then I'll move that over to the common location but again I'm trying not to just have these really big",
    "start": "2059800",
    "end": "2064960"
  },
  {
    "text": "migrations these really big efforts trying to be very incremental in my",
    "start": "2064960",
    "end": "2069720"
  },
  {
    "text": "steps now ideally our Target framework for that shared library is net standard 2.0",
    "start": "2070159",
    "end": "2078398"
  },
  {
    "text": "because that is the common interfaces that both 48 and net 8 can talk to um",
    "start": "2078399",
    "end": "2083720"
  },
  {
    "text": "but that's not always the case we have definitely run into situations where the uh there's",
    "start": "2083720",
    "end": "2089599"
  },
  {
    "text": "something special over on theet 48 side that is not supported on theet 8 side or",
    "start": "2089599",
    "end": "2094760"
  },
  {
    "text": "there may be libraries that just don't support these two Frameworks period and so we might have to multi-target which",
    "start": "2094760",
    "end": "2100560"
  },
  {
    "text": "really just means I'm building the assembly twice 1 14. net 48 and 1 14. net8 and then the logic is the same but",
    "start": "2100560",
    "end": "2107640"
  },
  {
    "text": "it'll it'll be like really like two different it'll be two completely different assemblies built for those two different Target",
    "start": "2107640",
    "end": "2114520"
  },
  {
    "text": "Frameworks um there was this other painful step we had to do which was looking at all of the dependencies the",
    "start": "2114520",
    "end": "2120920"
  },
  {
    "text": "application was using and trying to understand uh do those dependencies support net core n standard and if they",
    "start": "2120920",
    "end": "2128960"
  },
  {
    "text": "didn't then the first thing we need to do is then migrate them over to the latest version that would support or the",
    "start": "2128960",
    "end": "2134680"
  },
  {
    "text": "at least the earliest version would would support those two Frameworks so some things we had to migrates like many many versions uh some things were like",
    "start": "2134680",
    "end": "2142640"
  },
  {
    "text": "um like Entity framework is a good good example so any new framework starting with I think version 6.4 now supports",
    "start": "2142640",
    "end": "2149839"
  },
  {
    "text": "net core so just a heads up if you didn't know that you don't have to replace all of",
    "start": "2149839",
    "end": "2156200"
  },
  {
    "text": "your data access code if you're using ef6 and we want to treat this as a completely separate uh exercise of",
    "start": "2156200",
    "end": "2162280"
  },
  {
    "text": "trying to do that migration and just saying let's just upgrade our library dependencies and and go from there there",
    "start": "2162280",
    "end": "2168680"
  },
  {
    "text": "there were some dependencies were like this shouldn't even be there in the first place like we had in hybernate still there like at some point they",
    "start": "2168680",
    "end": "2174359"
  },
  {
    "text": "migrated from in hybernate to an new framework but they forgot to remove the package reference so some things we just saw like oh we don't even need that",
    "start": "2174359",
    "end": "2180160"
  },
  {
    "text": "anymore so let's just let's just kill it uh and not not use it at all um so the final result is some core",
    "start": "2180160",
    "end": "2188079"
  },
  {
    "text": "application that uh includes all like non UI dependencies and ideally all of",
    "start": "2188079",
    "end": "2194160"
  },
  {
    "text": "these dependencies support net standard 2 but if they don't they can at least multi-target between different ones so",
    "start": "2194160",
    "end": "2200000"
  },
  {
    "text": "this was quite a big First Step as well because some of these dependencies uh didn't support these two Frameworks and",
    "start": "2200000",
    "end": "2205560"
  },
  {
    "text": "so we had to like open poll requests with their maintainers to say hey um can you support these two libraries some",
    "start": "2205560",
    "end": "2211920"
  },
  {
    "text": "things I had foolishly like mediator for example um I decided I didn't want to support not that standard anymore and so",
    "start": "2211920",
    "end": "2217160"
  },
  {
    "text": "I dropped it and then I needed it so I'm like well I guess it's back again um so we'll just have to have this this",
    "start": "2217160",
    "end": "2223119"
  },
  {
    "text": "decision on each of these libraries of do we want to keep it or not uh and if so is there a migration path to dinet",
    "start": "2223119",
    "end": "2229599"
  },
  {
    "text": "core for each one of these uh now that we've gotten the kind of guts of the controller the next thing",
    "start": "2229599",
    "end": "2236240"
  },
  {
    "text": "we need to do is figure out like what is the very first controller that we want to pick and I kind of think of this like as a like Mount Everest uh sort of uh",
    "start": "2236240",
    "end": "2244040"
  },
  {
    "text": "sort of Affair that we don't want to pick the most challenging controller as the very first thing um some people see",
    "start": "2244040",
    "end": "2250520"
  },
  {
    "text": "like uh some people see Everest as like a challenge to overcome uh versus like",
    "start": "2250520",
    "end": "2256000"
  },
  {
    "text": "there being hundreds of dead bodies on that mountain um of people that have tried and failed and so we don't want to",
    "start": "2256000",
    "end": "2261400"
  },
  {
    "text": "be that we like how about we just get to like base camp and then like hul to day don't try to make the entire Summit in",
    "start": "2261400",
    "end": "2267760"
  },
  {
    "text": "one single go and don't pick the uh don't pick the the most complicated most",
    "start": "2267760",
    "end": "2273640"
  },
  {
    "text": "difficult one out there um so we already saw that can't do",
    "start": "2273640",
    "end": "2279160"
  },
  {
    "text": "the upgrade wizard to do our controller migration and so the way it's going to work is I will uh look at the controller",
    "start": "2279160",
    "end": "2286920"
  },
  {
    "text": "and then just copy and paste it and see what the compilers are just of the controller by itself and so the very",
    "start": "2286920",
    "end": "2292359"
  },
  {
    "text": "first thing I typically run into are my dependencies like the things that are getting injected in so right off the",
    "start": "2292359",
    "end": "2298800"
  },
  {
    "text": "gates right out the gates now I have to figure out okay well how do I now do dependency injection in ASP net core do",
    "start": "2298800",
    "end": "2305359"
  },
  {
    "text": "I do exactly what I was doing before or is there a better way um so aspnet core",
    "start": "2305359",
    "end": "2310640"
  },
  {
    "text": "does support dependent in dependency injection out of the box whereas in aspnet mvc5 it didn't and there was all",
    "start": "2310640",
    "end": "2316640"
  },
  {
    "text": "these crazy Hoops you had to jump through uh and so for this one we looked at well how is the existing application",
    "start": "2316640",
    "end": "2323480"
  },
  {
    "text": "doing dependency injection in this case it was using a thirdparty library it's called structure map that's un important",
    "start": "2323480",
    "end": "2329240"
  },
  {
    "text": "um but it was using a a a a library to be able to to to configure and do all the dependency injection so di is like",
    "start": "2329240",
    "end": "2337079"
  },
  {
    "text": "kind of there in MVC classic the old version uh but will almost certainly",
    "start": "2337079",
    "end": "2342200"
  },
  {
    "text": "require some kind of migration you're not going to be able to just take the exact kind of configuration you had before and then dump it in aspnet core",
    "start": "2342200",
    "end": "2349040"
  },
  {
    "text": "and just assume it uh was going to work so this is code that like I wouldn't share like it's not worth you trying to",
    "start": "2349040",
    "end": "2355680"
  },
  {
    "text": "share your di registration code so we threw it all away and said can we just quote just uh use the existing di",
    "start": "2355680",
    "end": "2362640"
  },
  {
    "text": "container um but that may not be possible it wasn't for us either uh we tried to use like the regular like",
    "start": "2362640",
    "end": "2368599"
  },
  {
    "text": "services. register you know Singleton register Transit whatever um but there was enough customization we were doing",
    "start": "2368599",
    "end": "2374560"
  },
  {
    "text": "in here that we didn't want to unwind that we said fine whatever we'll just like do the the the new way of doing",
    "start": "2374560",
    "end": "2380520"
  },
  {
    "text": "whatever this is um and so we wind up using another a library by the same",
    "start": "2380520",
    "end": "2385680"
  },
  {
    "text": "author um that is still looks almost exactly the same um but there would be",
    "start": "2385680",
    "end": "2390960"
  },
  {
    "text": "some subtle differences uh one good example are things like oh gosh this was",
    "start": "2390960",
    "end": "2396119"
  },
  {
    "text": "like all sorts of junk we really didn't need but we have things like oh a validator factory uh controller Factory",
    "start": "2396119",
    "end": "2402319"
  },
  {
    "text": "we don't need anymore there's like the DB context we had to do all this custom junk to make the life cycle uh for DB",
    "start": "2402319",
    "end": "2409480"
  },
  {
    "text": "context being once per request but now there's a better way of doing that you can just say that you know do scoped and",
    "start": "2409480",
    "end": "2414520"
  },
  {
    "text": "so every scoped web request will get a single DB context so we use this like we",
    "start": "2414520",
    "end": "2420200"
  },
  {
    "text": "pulled over the code and said is there a better way for doing all of these different things but not try to make too many changes of the code underneath the",
    "start": "2420200",
    "end": "2426400"
  },
  {
    "text": "covers oh so this was the the next like kind of",
    "start": "2426400",
    "end": "2431920"
  },
  {
    "text": "punch to the gut of our view migration we're like oh right it doesn't support bundling amidification that really sucks",
    "start": "2431920",
    "end": "2439880"
  },
  {
    "text": "um so in the mvc5 application it was doing this all this this bundling and minification configuration where it's",
    "start": "2439880",
    "end": "2446400"
  },
  {
    "text": "like J different jQuery versions it would handle uh cash busting and all that junk Force um and was able to",
    "start": "2446400",
    "end": "2452720"
  },
  {
    "text": "handle like multiple different libraries bundling them together having them different separated out as well",
    "start": "2452720",
    "end": "2458119"
  },
  {
    "text": "in case different pages use use different stuff and bundled and minified our CSS as",
    "start": "2458119",
    "end": "2463920"
  },
  {
    "text": "well so coming to aspnet core where there doesn't exist an outof the-box",
    "start": "2463920",
    "end": "2469160"
  },
  {
    "text": "bundling and minification solution we like well we don't want to not do that anymore like we still want to bundle and minifier our our static assets but",
    "start": "2469160",
    "end": "2475440"
  },
  {
    "text": "what's possible for us here um so there is an OSS Library",
    "start": "2475440",
    "end": "2480760"
  },
  {
    "text": "called Web Optimizer from some folks on the asp.net core team uh that is a like",
    "start": "2480760",
    "end": "2486040"
  },
  {
    "text": "a modernish version of the bundling and minification of aspnet mvc5 so it a very similar look",
    "start": "2486040",
    "end": "2492560"
  },
  {
    "text": "and feel to MVC 5's bundling and Min ifications but it's not exactly the same like they didn't they didn't keep the",
    "start": "2492560",
    "end": "2498680"
  },
  {
    "text": "same apis the same configuration options so it's it's different enough where it is like really a new kind of bunding",
    "start": "2498680",
    "end": "2504359"
  },
  {
    "text": "amidification so even the URLs changed as well so another kind of like okay so each page",
    "start": "2504359",
    "end": "2510359"
  },
  {
    "text": "really does have to know like I can't just have the static assets sered from one server to the other because those",
    "start": "2510359",
    "end": "2516280"
  },
  {
    "text": "URLs are going to change in the applications so that's one option just like find a tool that that supports the",
    "start": "2516280",
    "end": "2522920"
  },
  {
    "text": "same pipeline we had before or like we could adopt a new tool so this was to",
    "start": "2522920",
    "end": "2528359"
  },
  {
    "text": "get uh kind of the industry standard tooling for this um like webpack or whatever people are using these days I",
    "start": "2528359",
    "end": "2534119"
  },
  {
    "text": "don't keep up with that stuff um so use use like an established tool to do so and this is why like Microsoft doesn't",
    "start": "2534119",
    "end": "2540680"
  },
  {
    "text": "do their own B Bunning minification anymore because they say this is a quote solved Problem by other folks but we",
    "start": "2540680",
    "end": "2546800"
  },
  {
    "text": "were using the old solved problem way of doing things and so for this we looked at well okay this is the way to do it",
    "start": "2546800",
    "end": "2552520"
  },
  {
    "text": "correctly but this is going to require extensive changes to our application the build pipeline deployments uh all",
    "start": "2552520",
    "end": "2559520"
  },
  {
    "text": "packaging is going to be a huge change for us to move to something else from what we have today so we wind up going",
    "start": "2559520",
    "end": "2566839"
  },
  {
    "text": "with the web Optimizer routes and um yeah it says use web Optimizer um pretty",
    "start": "2566839",
    "end": "2573079"
  },
  {
    "text": "straightforward for us to use we just had to kind of like do a very similarish sort of configuration between the two",
    "start": "2573079",
    "end": "2578559"
  },
  {
    "text": "applications but that meant that we now have two bundling and minification pipelines the web Optimizer one and the",
    "start": "2578559",
    "end": "2585240"
  },
  {
    "text": "MVC 51 and so we wanted to make sure that if a request is served by aset core",
    "start": "2585240",
    "end": "2590960"
  },
  {
    "text": "8 that it gets the aset core 8 bundling minification thing and if it's not using",
    "start": "2590960",
    "end": "2597280"
  },
  {
    "text": "it if it's an mvc5 application then it used needs to use the MV mvc5 bundle",
    "start": "2597280",
    "end": "2603559"
  },
  {
    "text": "technically we could have made all of the requests for for the bundles like to stay over here but we also knew we're",
    "start": "2603559",
    "end": "2610200"
  },
  {
    "text": "going to have to migrate these assets at some point and we wanted to avoid again any kind of big Bane big bang into the",
    "start": "2610200",
    "end": "2616720"
  },
  {
    "text": "project okay now it's time to migrate all of our static assets over we wanted to have it as we migrate each individual",
    "start": "2616720",
    "end": "2623200"
  },
  {
    "text": "page we're also migrating all the static assets for that page over to aspn net",
    "start": "2623200",
    "end": "2628520"
  },
  {
    "text": "core so this one the Legacy request use the Legacy pipeline the DNA a request",
    "start": "2628520",
    "end": "2633880"
  },
  {
    "text": "use the dot new the new Pipeline and then we also wanted to make sure that these the static assets are shared so I",
    "start": "2633880",
    "end": "2641520"
  },
  {
    "text": "don't want to copy and paste you know JavaScript code between two projects we wanted to make sure that that code was",
    "start": "2641520",
    "end": "2647559"
  },
  {
    "text": "shared as well so I said we're not going to share any UI assets the UI code well that's serers side UI code we're not",
    "start": "2647559",
    "end": "2653359"
  },
  {
    "text": "going to share that we are going to share all of our client side code so we didn't want to duplicate and like you",
    "start": "2653359",
    "end": "2659559"
  },
  {
    "text": "know have to remember to edit two files uh so the way we avoided this there's this feature in asp.net I'm sorry in uh",
    "start": "2659559",
    "end": "2665920"
  },
  {
    "text": "Visual Studio project where you can add files as links so it doesn't like the",
    "start": "2665920",
    "end": "2671760"
  },
  {
    "text": "file doesn't exist on dis it's like a shortcut to the file that's over there it's like a Sim link sort of thing uh and so I just say yeah go ahead and just",
    "start": "2671760",
    "end": "2678119"
  },
  {
    "text": "pull in all the files in those content folders and now they just kind of show up magically over here in the like right",
    "start": "2678119",
    "end": "2685079"
  },
  {
    "text": "folder in the aspet core application so again that does mean that these are in two like they're served with different",
    "start": "2685079",
    "end": "2691680"
  },
  {
    "text": "URLs but they're also bundled and minified differently anyway so we we wanted those to be too different",
    "start": "2691680",
    "end": "2698720"
  },
  {
    "text": "things okay so the way this would typically work is I copy over the the",
    "start": "2698720",
    "end": "2705359"
  },
  {
    "text": "controller uh correcting any name spaces that are being used as part of that um which is usually just like you know",
    "start": "2705359",
    "end": "2710960"
  },
  {
    "text": "system.web to Microsoft aspet core. NBC whatever so it's pretty pretty straightforward any of those things and",
    "start": "2710960",
    "end": "2717119"
  },
  {
    "text": "just correct all of the different compile eras there and then the controller is going to be calling out to",
    "start": "2717119",
    "end": "2722559"
  },
  {
    "text": "some kind of business logic so we're going to move that business logic over to the common look if it doesn't already",
    "start": "2722559",
    "end": "2728480"
  },
  {
    "text": "exist there uh and we that also May uh require us to pull any additional packages that that code is using um and",
    "start": "2728480",
    "end": "2735960"
  },
  {
    "text": "then also we make sure at the end that the controller still compiles with all of this uh the final step for any one",
    "start": "2735960",
    "end": "2743480"
  },
  {
    "text": "typical slice is then to copy any of the views over uh so any of the you know the pages that use views I'll pull those",
    "start": "2743480",
    "end": "2749640"
  },
  {
    "text": "views over and then there could be cases where those views are using custom Logic for the UI stuff so one a good examples",
    "start": "2749640",
    "end": "2756280"
  },
  {
    "text": "that we were like I don't know why we were really into custom HTML helper extensions at that point in time um",
    "start": "2756280",
    "end": "2762400"
  },
  {
    "text": "learned my lesson of that but whatever that code was there so any of the kind of common shared UI or the the UI custom",
    "start": "2762400",
    "end": "2769200"
  },
  {
    "text": "code that could not be migrated over it would be copy and paste and then fix a bunch of compile errors and then",
    "start": "2769200",
    "end": "2775440"
  },
  {
    "text": "hopefully the behavior is still there but there are some cases where you know those those different features didn't exist and so we might have to like",
    "start": "2775440",
    "end": "2781480"
  },
  {
    "text": "reinvent how we perform some task in the UI there and and the final step with any",
    "start": "2781480",
    "end": "2788480"
  },
  {
    "text": "one of our controllers was to delete the as nut MVC code now the",
    "start": "2788480",
    "end": "2794880"
  },
  {
    "text": "reason why we did this this is a whole debate of like should we delete the code as we migrate or should we keep it there",
    "start": "2794880",
    "end": "2800319"
  },
  {
    "text": "so we can still like see how it used to work the problem is we we ran into this",
    "start": "2800319",
    "end": "2805640"
  },
  {
    "text": "uh after after keeping the code is that um the Y proxy that final step in the",
    "start": "2805640",
    "end": "2811559"
  },
  {
    "text": "process that forwards request over will forward any request over if it is a non-success return",
    "start": "2811559",
    "end": "2818119"
  },
  {
    "text": "value which doesn't just mean 400 errors but also could mean 500 errors so if my",
    "start": "2818119",
    "end": "2824880"
  },
  {
    "text": "aset core application throws an exception the Y proxy will silently",
    "start": "2824880",
    "end": "2830079"
  },
  {
    "text": "forward the request over to the aset mvc5 application so there were a few times where like we migrated controllers",
    "start": "2830079",
    "end": "2835920"
  },
  {
    "text": "we ran the application like wow it looks great ship it and then look at the logs realize oh we're getting exceptions and",
    "start": "2835920",
    "end": "2842920"
  },
  {
    "text": "it was just serving the old application so that final step was just our gut check to say let's just make sure it it won't serve",
    "start": "2842920",
    "end": "2849480"
  },
  {
    "text": "the request anymore from the old application so you can delete it or maybe you rename it or make the class private whatever but we wanted to ensure",
    "start": "2849480",
    "end": "2855960"
  },
  {
    "text": "that the old application would not serve those requests successfully all",
    "start": "2855960",
    "end": "2862079"
  },
  {
    "text": "right our next big hurdle was session ug so session is like a special set of",
    "start": "2862079",
    "end": "2869040"
  },
  {
    "text": "shared States uh on the server side for individual users um now maybe you're",
    "start": "2869040",
    "end": "2875760"
  },
  {
    "text": "like maybe your application is using a lot of session but almost everyone here is probably using session at some place",
    "start": "2875760",
    "end": "2881480"
  },
  {
    "text": "in their application it's just you know you want to cash something for specific user maybe it's their roles or",
    "start": "2881480",
    "end": "2886520"
  },
  {
    "text": "permissions or whatever um so you're caching it and storing it in a session State um but the problem is that session",
    "start": "2886520",
    "end": "2893280"
  },
  {
    "text": "States is only really accessible from the mvc5 application so in our web Farm",
    "start": "2893280",
    "end": "2899440"
  },
  {
    "text": "scenario the session state was in a shared database but the format of the",
    "start": "2899440",
    "end": "2905319"
  },
  {
    "text": "database is not compatible with ASP net core so it wasn't like I can say oh we got a single database that has our",
    "start": "2905319",
    "end": "2911559"
  },
  {
    "text": "session why can't we just make ASP net core session also point to that same table and then everything will magically",
    "start": "2911559",
    "end": "2917319"
  },
  {
    "text": "work well aspnet core does support SQL but it looks completely different because why not like just change",
    "start": "2917319",
    "end": "2924040"
  },
  {
    "text": "everything whatever um so we can't just have quote just these two applications",
    "start": "2924040",
    "end": "2929680"
  },
  {
    "text": "share the same session store instead we have to have some way of the aspnet application exposing its session state",
    "start": "2929680",
    "end": "2936400"
  },
  {
    "text": "to the aspet core application um yeah so how did this work so whenever the aspet core application",
    "start": "2936400",
    "end": "2943680"
  },
  {
    "text": "and this is I'm going to make it simple but it's much more complicated underneath the covers uh if as. core",
    "start": "2943680",
    "end": "2949240"
  },
  {
    "text": "needs session one needs to kind of opt into that to say I need session that's I need remote session from over there and",
    "start": "2949240",
    "end": "2956599"
  },
  {
    "text": "the aspnet application will now expose an API endpoint for reading and writing",
    "start": "2956599",
    "end": "2962520"
  },
  {
    "text": "session values so at each request the aset core application will get the",
    "start": "2962520",
    "end": "2968960"
  },
  {
    "text": "current session state from the aset application the aset application will go ahead and get all of it State out and",
    "start": "2968960",
    "end": "2974920"
  },
  {
    "text": "then the aspnet application will then return the session as a Json object back to the aspnet core",
    "start": "2974920",
    "end": "2981079"
  },
  {
    "text": "application and now when I'm inside my aspet core application um I can like",
    "start": "2981079",
    "end": "2986359"
  },
  {
    "text": "read from session but it's really just reading like an inmemory version of what it's already retrieved from the other uh",
    "start": "2986359",
    "end": "2992839"
  },
  {
    "text": "from the other side here it also supports updates as well so if I make changes to session State the",
    "start": "2992839",
    "end": "2998760"
  },
  {
    "text": "aspet uh this this adapter will keep track of those changes and push those changes out to the aspnet",
    "start": "2998760",
    "end": "3006079"
  },
  {
    "text": "application now this is like you could have like some uh concurrency problems",
    "start": "3006079",
    "end": "3012079"
  },
  {
    "text": "right like what if I have two requests trying to alter session state but the",
    "start": "3012079",
    "end": "3017599"
  },
  {
    "text": "possibility of that is pretty low because it's again one user so is one user have two tabs open going back and",
    "start": "3017599",
    "end": "3022799"
  },
  {
    "text": "forth and altering session State probably not but it's something to keep in mind that this does not guarantee",
    "start": "3022799",
    "end": "3027960"
  },
  {
    "text": "consistency like across both applications it just can't so the way we uh configure this on",
    "start": "3027960",
    "end": "3035599"
  },
  {
    "text": "the asp.net mvc5 side is in our global. asax we will say uh add system web",
    "start": "3035599",
    "end": "3043760"
  },
  {
    "text": "adapters add the Json session serializer and we have to register all the different session values and their types",
    "start": "3043760",
    "end": "3050920"
  },
  {
    "text": "with the session serializer so aspnet core session or aspnet session uh I think uses like some",
    "start": "3050920",
    "end": "3057119"
  },
  {
    "text": "weird wonky binary serializer to store session State like you can just throw any object in there it just like",
    "start": "3057119",
    "end": "3062760"
  },
  {
    "text": "magically serialize it uh as core does not do that they realize it's a horrible idea to do binary sterilization and",
    "start": "3062760",
    "end": "3068599"
  },
  {
    "text": "instead uh it uses Json so that means for us though that we will have to make sure that all of our session values are",
    "start": "3068599",
    "end": "3074599"
  },
  {
    "text": "serializable to Json and we have to register each of those keys and types explicitly",
    "start": "3074599",
    "end": "3080280"
  },
  {
    "text": "here uh we'll also uh expose the remote app server and then provide an API key",
    "start": "3080280",
    "end": "3086119"
  },
  {
    "text": "so this is is like just some goid or whatever so that when my aspnet core",
    "start": "3086119",
    "end": "3091480"
  },
  {
    "text": "application makes those requests to the asp.net mvc5 application it's uh will",
    "start": "3091480",
    "end": "3096920"
  },
  {
    "text": "authenticate via this API key so it's",
    "start": "3096920",
    "end": "3102558"
  },
  {
    "text": "secure on the aspnet core side it's a very similar kind of thing where we say add the Json session serializer again",
    "start": "3102880",
    "end": "3109799"
  },
  {
    "text": "registering the keys and the uh types and then now we add the remote app client saying that the remote app URL",
    "start": "3109799",
    "end": "3116280"
  },
  {
    "text": "this is what it was before and we have this API key here and then finally we add the session",
    "start": "3116280",
    "end": "3123480"
  },
  {
    "text": "client now using the session is a little funny uh there's a couple different options here um the the two session",
    "start": "3123799",
    "end": "3130359"
  },
  {
    "text": "objects are really quite different from each other um with different options",
    "start": "3130359",
    "end": "3135480"
  },
  {
    "text": "available for how it can uh treat the different session object objects and different persistence objects all that",
    "start": "3135480",
    "end": "3141000"
  },
  {
    "text": "sort of stuff um so the options they give to us uh one it can wrap an asp net",
    "start": "3141000",
    "end": "3146079"
  },
  {
    "text": "net course session so when I call aspnet Core session it's actually going to call out to uh this other one instead um so",
    "start": "3146079",
    "end": "3153640"
  },
  {
    "text": "this is good in cases if I if I have business logic code that is using session State and I want to be able to",
    "start": "3153640",
    "end": "3159000"
  },
  {
    "text": "migrate it to be able to use either application um so this is uh this is",
    "start": "3159000",
    "end": "3164520"
  },
  {
    "text": "this is okay in cases for that kind of migration sort of option our session usage was typically in like action",
    "start": "3164520",
    "end": "3170480"
  },
  {
    "text": "filters in middleware it wasn't just like sprinkled out through our code so that kind of migration wasn't really that important to us uh or we explicitly",
    "start": "3170480",
    "end": "3177280"
  },
  {
    "text": "call the remote app for session State um uh with a second option um so this is one way of doing",
    "start": "3177280",
    "end": "3185680"
  },
  {
    "text": "this session there's there's a few different ways possible here um you have to opt into it though to say these",
    "start": "3185680",
    "end": "3190920"
  },
  {
    "text": "explicit controllers and actions uh should have this remote session State and the reason why we want to opt into",
    "start": "3190920",
    "end": "3196799"
  },
  {
    "text": "that is because when you get that request uh when aspet core gets a request and it sees that this request",
    "start": "3196799",
    "end": "3203359"
  },
  {
    "text": "requires remote session then it's going to call out to the aspnet mvc5 application to get all that session",
    "start": "3203359",
    "end": "3209440"
  },
  {
    "text": "details and pull it back in I don't want that happening and every request if I don't need to so I can opt into this",
    "start": "3209440",
    "end": "3215079"
  },
  {
    "text": "sort of behavior with there's this the session attribute or you can just like manually uh create the sess manager and",
    "start": "3215079",
    "end": "3221240"
  },
  {
    "text": "then get the values out like this so this right here is not calling out to",
    "start": "3221240",
    "end": "3226480"
  },
  {
    "text": "aspnet at mvc5 right here in this create async is when it does make that request and grab",
    "start": "3226480",
    "end": "3232440"
  },
  {
    "text": "all the values",
    "start": "3232440",
    "end": "3235720"
  },
  {
    "text": "um yes so hopefully you're not using a lot of session but it is possible to still like have some sort of shared",
    "start": "3237520",
    "end": "3243400"
  },
  {
    "text": "sessions St but it is very much a kind of manual process to go into your code and then now call into the other way of",
    "start": "3243400",
    "end": "3249319"
  },
  {
    "text": "doing it our next thing we hit was hangfire um so what is hangfire hangfire is a job",
    "start": "3249319",
    "end": "3256599"
  },
  {
    "text": "scheduling and queuing extension to asp.net and asp.net core uh yes it supports aspnet 4X and asp.net core um",
    "start": "3256599",
    "end": "3264440"
  },
  {
    "text": "so it's a uh it runs in the background of an asp.net application to do",
    "start": "3264440",
    "end": "3269720"
  },
  {
    "text": "background jobs queuing Kon style jobs that sort of thing so uh a lot of my",
    "start": "3269720",
    "end": "3274920"
  },
  {
    "text": "systems use this where we don't want to have like some other application to do background tasks we piggyback on top of",
    "start": "3274920",
    "end": "3280119"
  },
  {
    "text": "the web application to do this sort of stuff it supports job persistence so it",
    "start": "3280119",
    "end": "3285359"
  },
  {
    "text": "can store the job details in multiple different kinds of databases and also supports uh multiple cues uh could be",
    "start": "3285359",
    "end": "3293240"
  },
  {
    "text": "the cues could be like you know Azure service bus Azure storage cues it could be SQL uh database back cues um but it",
    "start": "3293240",
    "end": "3300119"
  },
  {
    "text": "can can persist that data and that persistence is crossplatform as well the",
    "start": "3300119",
    "end": "3305280"
  },
  {
    "text": "other thing we wanted to avoid though is that we wanted to Not Duplicate work so if I kick off a job I don't want the job",
    "start": "3305280",
    "end": "3312559"
  },
  {
    "text": "to be executed by both hosts I really want to be just executed once now",
    "start": "3312559",
    "end": "3317720"
  },
  {
    "text": "hangfire does support this like um competing consumer pattern to make sure the job only executes in one place but",
    "start": "3317720",
    "end": "3324079"
  },
  {
    "text": "the job itself could be any anything so that anything may not even live or exist",
    "start": "3324079",
    "end": "3330640"
  },
  {
    "text": "in the other application whatsoever so here's an example of this this is a completely trivial example but it's",
    "start": "3330640",
    "end": "3336799"
  },
  {
    "text": "pretty typical for how I saw hangfire being used in this application so it",
    "start": "3336799",
    "end": "3342039"
  },
  {
    "text": "would be doing some business logic and then there's something it needs to fire off in the background like maybe send an email call an API uh call it to twillo I",
    "start": "3342039",
    "end": "3350680"
  },
  {
    "text": "don't know whatever um so it doesn't want to do that in this request so it enues a background job to do the work",
    "start": "3350680",
    "end": "3356760"
  },
  {
    "text": "but the way that hangfire does this is like kind of magical because you can see here it's just uh a Lambda expression to",
    "start": "3356760",
    "end": "3363359"
  },
  {
    "text": "the code to call this code over here executes in the background sometime in",
    "start": "3363359",
    "end": "3368559"
  },
  {
    "text": "the future but hangfire makes it super easy just to say like execute this method like some some other time in the",
    "start": "3368559",
    "end": "3375200"
  },
  {
    "text": "future not in the context of this web requests but this code is living inside",
    "start": "3375200",
    "end": "3382200"
  },
  {
    "text": "of this controller so if I migrated this controller it won't know where this job",
    "start": "3382200",
    "end": "3387760"
  },
  {
    "text": "exists anymore it's just using reflection to say this you know this method call this method on this object and do this job so uh how we handle this",
    "start": "3387760",
    "end": "3396079"
  },
  {
    "text": "is we split our cues between the asp.net core application and the aspnet mvc5",
    "start": "3396079",
    "end": "3401760"
  },
  {
    "text": "application so the aset core application would have a default dcore Q so if dnet",
    "start": "3401760",
    "end": "3407559"
  },
  {
    "text": "8 initiated and the job existed on dnet 8 it would use the default core q but if",
    "start": "3407559",
    "end": "3413079"
  },
  {
    "text": "the job existed on the other side and the the mvc5 application that when use just",
    "start": "3413079",
    "end": "3419119"
  },
  {
    "text": "the default queue so that means that that hangfire uh host on this side would",
    "start": "3419119",
    "end": "3424720"
  },
  {
    "text": "then pick that uh item up and execute the job uh on the reverse side we can",
    "start": "3424720",
    "end": "3429920"
  },
  {
    "text": "handle that as well so mvc5 could inq a default core um job because we knew it",
    "start": "3429920",
    "end": "3435520"
  },
  {
    "text": "the job existed over there and of course if I'm just completely in the MV mvc5 world uh we could do that so we just had",
    "start": "3435520",
    "end": "3441720"
  },
  {
    "text": "to make sure we knew where the job existed to make sure that the right application picked it up and rain with",
    "start": "3441720",
    "end": "3447240"
  },
  {
    "text": "it um this is pretty straightforward to do in hangfire when we start up the hangfire um uh middleware we tell it the",
    "start": "3447240",
    "end": "3454839"
  },
  {
    "text": "queue that you should listen for and so that queue we called you know default or default core and each host would just",
    "start": "3454839",
    "end": "3460240"
  },
  {
    "text": "listen to its own individual queue and when I wanted to inq a job I would tell",
    "start": "3460240",
    "end": "3465520"
  },
  {
    "text": "it what Quee should you enue that job for for whatever it was trying to do uh",
    "start": "3465520",
    "end": "3472599"
  },
  {
    "text": "so you can do this like here directly in the call to to the background job clients or you can also use attributes",
    "start": "3472599",
    "end": "3479119"
  },
  {
    "text": "there's like 20 different ways you can do this but we did have to make modifications to our code to make sure that the job went to the right",
    "start": "3479119",
    "end": "3487079"
  },
  {
    "text": "location all right now comes a really fun part authentication H okay so this is highly",
    "start": "3487079",
    "end": "3495000"
  },
  {
    "text": "highly dependent on your application because every single application will do authentication differently like it's like there's no just one way people do",
    "start": "3495000",
    "end": "3502000"
  },
  {
    "text": "authentication um so you can do things like share cookie off so you if you're doing cookie authentication then you can",
    "start": "3502000",
    "end": "3509440"
  },
  {
    "text": "have both applications share the same data protection certificate and be able to decrypt those cookies on both sides",
    "start": "3509440",
    "end": "3516240"
  },
  {
    "text": "we can do that um so this is effectively like single sign on at this point right so if",
    "start": "3516240",
    "end": "3521280"
  },
  {
    "text": "you're in a web Farm scenar you're probably already doing this anyway um so we can configure the aspnet core",
    "start": "3521280",
    "end": "3526319"
  },
  {
    "text": "application to also handle this as well uh that means we can also sign in or out with either",
    "start": "3526319",
    "end": "3532640"
  },
  {
    "text": "application um the other option is to do remote Authentication this is similar to Shared session in which you're only",
    "start": "3532640",
    "end": "3538760"
  },
  {
    "text": "authenticating against the old application and then there will be requests made from the uh MVC core",
    "start": "3538760",
    "end": "3547880"
  },
  {
    "text": "application to the mvc5 application to get the authentication details and fill out the identity and claims and all that",
    "start": "3547880",
    "end": "3554079"
  },
  {
    "text": "sort of junk so on the aspn net side we add this additional option for add authentication",
    "start": "3554079",
    "end": "3560440"
  },
  {
    "text": "server which will expose API endpoints to get the authentication details and on",
    "start": "3560440",
    "end": "3565480"
  },
  {
    "text": "the client side we'll do a similar thing where we say add authentication clients and then finally of course use",
    "start": "3565480",
    "end": "3571079"
  },
  {
    "text": "authentication and use authorization so the aspnet core application is still authenticating each request but it just",
    "start": "3571079",
    "end": "3577599"
  },
  {
    "text": "can't sign in users it's going to make a call out to the aspnet mvc5 application to get all the identity details and all",
    "start": "3577599",
    "end": "3584680"
  },
  {
    "text": "the claims all right so as we went through",
    "start": "3584680",
    "end": "3591319"
  },
  {
    "text": "here migrating each of these different options we would look at okay for each set of code outside of the kind of",
    "start": "3591319",
    "end": "3597240"
  },
  {
    "text": "controller action view sort of stuff we would evaluate to say like does each of this item actually need to be migrated",
    "start": "3597240",
    "end": "3603240"
  },
  {
    "text": "at all and there were some cases like when we went to middleware uh we didn't need to migrate any of that stuff",
    "start": "3603240",
    "end": "3608280"
  },
  {
    "text": "because it was all now built into the Asic core um but we just you know over time migrated one control in action at a",
    "start": "3608280",
    "end": "3614520"
  },
  {
    "text": "time until eventually we were left with nothing and so this was the final step of turning off the lights and locking up",
    "start": "3614520",
    "end": "3621559"
  },
  {
    "text": "uh before we left so this last step was we would enable the session on aspnet core and",
    "start": "3621559",
    "end": "3627359"
  },
  {
    "text": "disable it on aspnet 5 so now session now existed solely on the aspnet core",
    "start": "3627359",
    "end": "3632559"
  },
  {
    "text": "side removed all remaining controllers and htb endpoints from mvc5 we disabled the remote",
    "start": "3632559",
    "end": "3639440"
  },
  {
    "text": "authentication and session uh the remote clients in aspnet core so is only doing",
    "start": "3639440",
    "end": "3644559"
  },
  {
    "text": "it uh inside the aspet core application uh removed any other additional shims for bridging over to mvc5 so any kind of",
    "start": "3644559",
    "end": "3651520"
  },
  {
    "text": "like if aspnet core do this otherwise do this uh we removed all those as well and",
    "start": "3651520",
    "end": "3657520"
  },
  {
    "text": "finally we would monitor deploy this out and monitor the uh mvc5 application for",
    "start": "3657520",
    "end": "3662760"
  },
  {
    "text": "any traffic we this for like a week or so to say like make sure that we're still not getting any requests to that",
    "start": "3662760",
    "end": "3668440"
  },
  {
    "text": "nbc5 application and then finally once we knew like there's no more no nothing else going on there remove the mvc5",
    "start": "3668440",
    "end": "3675440"
  },
  {
    "text": "application from code pipelines deployments and pop the champagne bottle because no more asp.net",
    "start": "3675440",
    "end": "3682640"
  },
  {
    "text": "mvc5 so just some parting thoughts here um the incremental migration uh uh",
    "start": "3682640",
    "end": "3688680"
  },
  {
    "text": "process that I described today that's the one that will minimize the risk of a big bang deployment by having very small",
    "start": "3688680",
    "end": "3695119"
  },
  {
    "text": "verifiable deployments so we were deploying multiple times a week every time we would finish controller it was",
    "start": "3695119",
    "end": "3700440"
  },
  {
    "text": "getting deployed out to production and tested um except for web forms there's",
    "start": "3700440",
    "end": "3705480"
  },
  {
    "text": "no incremental Migra migration with web forms you are screwed you have to do complete reite of every single one of",
    "start": "3705480",
    "end": "3710839"
  },
  {
    "text": "those pages there is no migration path for you but if you still not migrated web forms in the year 2020 before uh",
    "start": "3710839",
    "end": "3716680"
  },
  {
    "text": "that's your own fault I guess or maybe whoever does the budget it's their fault um these system web adapters are what",
    "start": "3716680",
    "end": "3723119"
  },
  {
    "text": "enable that incremental migration with the magic of the yarp reverse proxy um but there will always be something that",
    "start": "3723119",
    "end": "3728920"
  },
  {
    "text": "is like unique to your application and system I've definitely not covered every single possibility here uh so there will",
    "start": "3728920",
    "end": "3734440"
  },
  {
    "text": "be something that you run into that's uh you'll have to deal with and overcome um but it is",
    "start": "3734440",
    "end": "3740200"
  },
  {
    "text": "overcomable um the last thing is we we really try to avoid any like quote improvements to the architecture because",
    "start": "3740200",
    "end": "3746039"
  },
  {
    "text": "we're going in changing code we're like oh we can go to this new way of doing things and so we really had to to put a",
    "start": "3746039",
    "end": "3751720"
  },
  {
    "text": "a kabash on all those kind of things to say this is a straight lift and shift of the mvc5 application to hbnet core and",
    "start": "3751720",
    "end": "3758039"
  },
  {
    "text": "as much as possible avoid any other kind of like quote improvements over time so",
    "start": "3758039",
    "end": "3763200"
  },
  {
    "text": "thank you all very much um uh if you want to hear more about this you can come grab me after this uh otherwise I",
    "start": "3763200",
    "end": "3768480"
  },
  {
    "text": "hope you'll have a great rest of the conference thank you [Applause]",
    "start": "3768480",
    "end": "3778890"
  }
]