[
  {
    "text": "um welcome hopefully this the technical equipment now works so we can",
    "start": "8240",
    "end": "14559"
  },
  {
    "text": "switch slides without it taking 40 seconds like the last talk i feel really bad for them but",
    "start": "14559",
    "end": "22320"
  },
  {
    "text": "yeah so welcome my name is turi i'm going to talk to you about",
    "start": "22320",
    "end": "27760"
  },
  {
    "text": "side channel analysis how many here has heard about side channel analysis before",
    "start": "27760",
    "end": "34399"
  },
  {
    "text": "okay can turtles take their hands down how many i've heard about slide channel analysis",
    "start": "34399",
    "end": "39680"
  },
  {
    "text": "okay a few so just a warning it's a very technical",
    "start": "39680",
    "end": "45440"
  },
  {
    "text": "talk if you don't want to look at like specific byte values in the middle of the aes encryption algorithm",
    "start": "45440",
    "end": "51280"
  },
  {
    "text": "feel free to leave but please stay if you want to look at that um",
    "start": "51280",
    "end": "56719"
  },
  {
    "text": "yeah so i will just actually i'll go over the outline later just a little bit about me because i",
    "start": "56719",
    "end": "62960"
  },
  {
    "text": "don't think many of you know me um i have some education apparently so i have a bachelor's in math mathematics",
    "start": "62960",
    "end": "69520"
  },
  {
    "text": "and engineering and i put that up there to say that look i know some math because you need some math to know some",
    "start": "69520",
    "end": "75040"
  },
  {
    "text": "crypto uh and the master in information security from yavik i'm sure more people",
    "start": "75040",
    "end": "80240"
  },
  {
    "text": "in the room has that um and then i worked for about 15 years as a cryptographer",
    "start": "80240",
    "end": "87200"
  },
  {
    "text": "don't ask me about cryptocurrencies they're evil um but everything else is in crypto is",
    "start": "87200",
    "end": "92400"
  },
  {
    "text": "good um so usually my job title has been something like security analyst",
    "start": "92400",
    "end": "97920"
  },
  {
    "text": "i've worked for these organizations so the norwegian national security authority where i looked at",
    "start": "97920",
    "end": "104720"
  },
  {
    "text": "like approving uh cryptographic equipment that was going to be used for the lowest security level",
    "start": "104720",
    "end": "111200"
  },
  {
    "text": "in norway and then i worked for konax apparently they're called negro now but we refused",
    "start": "111200",
    "end": "116240"
  },
  {
    "text": "to accept that even when i was there so doing uh",
    "start": "116240",
    "end": "121439"
  },
  {
    "text": "encryption of tv signals which in fancy language is called content protection of dvb",
    "start": "121439",
    "end": "128160"
  },
  {
    "text": "um and then i went back to the military world and worked for tallest norway making",
    "start": "128160",
    "end": "134080"
  },
  {
    "text": "cryptographic equipment for the military and when i say cryptographic equipment for the military i mean actual physical",
    "start": "134080",
    "end": "140640"
  },
  {
    "text": "boxes that encrypt stuff because that's how the military works and recently i worked for turtlesec",
    "start": "140640",
    "end": "148239"
  },
  {
    "text": "for a few months apparently i'm still an accepted member of turtle tech even though i don't work there",
    "start": "148239",
    "end": "154160"
  },
  {
    "text": "as a consultant doing some pki stuff if you for some reason want to talk about x 509 certificates i'll probably",
    "start": "154160",
    "end": "161519"
  },
  {
    "text": "remember the details for like five more days um i'm so called in between jobs literally",
    "start": "161519",
    "end": "169360"
  },
  {
    "text": "but my next job will be at riskier uh which is the company it's a security",
    "start": "169360",
    "end": "174480"
  },
  {
    "text": "lab and so if you make anything in it hardware or software",
    "start": "174480",
    "end": "180080"
  },
  {
    "text": "that you think should do some security you can send it to riskier and they will analyze it for you they're also very very good at side",
    "start": "180080",
    "end": "186000"
  },
  {
    "text": "channel analysis which is why i really want to work there okay",
    "start": "186000",
    "end": "191840"
  },
  {
    "text": "so my talk first i need to just introduce side channel analysis uh",
    "start": "191840",
    "end": "198640"
  },
  {
    "text": "basically start with like what is a side channel and how can we use it to analyze stuff",
    "start": "198640",
    "end": "203920"
  },
  {
    "text": "and then i'm going to talk about the aes encryption algorithm because the main part of my talk is going to be",
    "start": "203920",
    "end": "210799"
  },
  {
    "text": "how we can use side channel analysis to break aas and we need to know how ais works to do that",
    "start": "210799",
    "end": "217920"
  },
  {
    "text": "and then i'm going to talk about correlation power analysis which is the specific type of side channel analysis",
    "start": "217920",
    "end": "224879"
  },
  {
    "text": "i'm going to show you how to use the brake aes and then side channel considerations just i just",
    "start": "224879",
    "end": "231440"
  },
  {
    "text": "have some like general generalizations at the end and some conclusions",
    "start": "231440",
    "end": "237280"
  },
  {
    "text": "okay so the first section introduction to side channel analysis so",
    "start": "237280",
    "end": "242799"
  },
  {
    "text": "what is a side channel um it's any physical channel that can leak information about your security",
    "start": "242799",
    "end": "248560"
  },
  {
    "text": "measure so you're using a security measure to try to protect a secret and any physical",
    "start": "248560",
    "end": "254959"
  },
  {
    "text": "physical channel that can leak information about this it's called a side channel and this is a fun example",
    "start": "254959",
    "end": "261120"
  },
  {
    "text": "using a stethoscope to crack a safe is a side channel attack",
    "start": "261120",
    "end": "266800"
  },
  {
    "text": "using the side channel sound so examples of side channels are power",
    "start": "266800",
    "end": "273040"
  },
  {
    "text": "consumption so when your chip runs some kind of code you can measure the power consumption and learn something",
    "start": "273040",
    "end": "278880"
  },
  {
    "text": "about the secrets that's what we're going to do later with aes electromagnetic radiation basically",
    "start": "278880",
    "end": "285919"
  },
  {
    "text": "works the same way as the power consumption and leaks information about what's running",
    "start": "285919",
    "end": "291280"
  },
  {
    "text": "and then there's sound i've also seen sound used to break aas on a cpu it's very strange",
    "start": "291280",
    "end": "297680"
  },
  {
    "text": "um i i saw no sorry rsa and the cpu i saw it on one conference many years ago i",
    "start": "297680",
    "end": "303520"
  },
  {
    "text": "don't remember what they did but they used sound coming from the processor",
    "start": "303520",
    "end": "309120"
  },
  {
    "text": "i've read that heat can be in a side channel i don't have an example of how to use it and timing of operations i",
    "start": "309680",
    "end": "315520"
  },
  {
    "text": "have an example later actually on this slide um so it's high channel attack this then is",
    "start": "315520",
    "end": "321759"
  },
  {
    "text": "an attack that analyzes and exports the information that you learn from the side channel",
    "start": "321759",
    "end": "327600"
  },
  {
    "text": "and then you use that to derive some secret information so examples the first one we saw already",
    "start": "327600",
    "end": "334800"
  },
  {
    "text": "cracking a safe combination with a stethoscope so this is an example of a timing side",
    "start": "334800",
    "end": "342320"
  },
  {
    "text": "channel if you measure the time of this the running time of this algorithm which i am",
    "start": "342320",
    "end": "349520"
  },
  {
    "text": "my assistant also my spouse incidentally has informed me this is valid python",
    "start": "349520",
    "end": "355440"
  },
  {
    "text": "code and this is correct i'm not the best at python uh so if you but you know",
    "start": "355440",
    "end": "362240"
  },
  {
    "text": "uh while n is bigger than zero subtract n from one um",
    "start": "362240",
    "end": "367600"
  },
  {
    "text": "so you understand that if you measure the running time of this you will learn something about the value of m",
    "start": "367600",
    "end": "373120"
  },
  {
    "text": "and if the value of n is secret then that's oops especially if you can run it several",
    "start": "373120",
    "end": "379039"
  },
  {
    "text": "times and the value changes right and then the final example is basically what we're going to do later uh using",
    "start": "379039",
    "end": "385919"
  },
  {
    "text": "power consumption data to learn about the internal state of a crypto operation that's going on",
    "start": "385919",
    "end": "392000"
  },
  {
    "text": "and then hopefully we can derive the secret key from this knowledge",
    "start": "392000",
    "end": "396960"
  },
  {
    "text": "okay so how do we do this in practice uh power analysis which is using the power",
    "start": "397600",
    "end": "402880"
  },
  {
    "text": "measurements then um this picture",
    "start": "402880",
    "end": "408800"
  },
  {
    "text": "is of like this is the lab setup that i use and i have it up here as well um",
    "start": "408800",
    "end": "415280"
  },
  {
    "text": "so just basically i just fell off the stage um",
    "start": "415280",
    "end": "421280"
  },
  {
    "text": "because i wanted the point so this red card is really just there to measure power on whatever's running on the blue card",
    "start": "421280",
    "end": "428160"
  },
  {
    "text": "so the crypt operation is running on this it's a 32-bit processor processor and this measures the power",
    "start": "428160",
    "end": "435039"
  },
  {
    "text": "consumption and sends it via this cable to this one which is basically an oscilloscope",
    "start": "435039",
    "end": "441919"
  },
  {
    "text": "because oscilloscopes today are just like digital analog to digital converters",
    "start": "441919",
    "end": "447840"
  },
  {
    "text": "so it sends all the measurement data to the laptop via the usb cable and then if you want to see like the",
    "start": "447840",
    "end": "453840"
  },
  {
    "text": "fancy graphs you can just plot them on the laptop so more technically",
    "start": "453840",
    "end": "460560"
  },
  {
    "text": "there's like a resistor connected in series with a power supply",
    "start": "460560",
    "end": "465919"
  },
  {
    "text": "and you can use that to observe the power consumption",
    "start": "465919",
    "end": "471440"
  },
  {
    "text": "and yeah the oscilloscope digitizes the power measurements and then we use the computer to analyze it",
    "start": "471440",
    "end": "478639"
  },
  {
    "text": "okay so we're going going to explain it later or show it to you later so aas the ies crypto algorithm um",
    "start": "478639",
    "end": "487440"
  },
  {
    "text": "i say it's probably the most widely used data encryption algorithm i kind of hope it is",
    "start": "487440",
    "end": "494160"
  },
  {
    "text": "it's it's the algorithm used if you want to encrypt like more than just a small chunk of data so usually if you're using",
    "start": "494240",
    "end": "501759"
  },
  {
    "text": "something asymmetric like rsi or elliptic curve you use that only to derive a key that",
    "start": "501759",
    "end": "507680"
  },
  {
    "text": "you can then use with aes to encrypt like your real data",
    "start": "507680",
    "end": "513198"
  },
  {
    "text": "aes is easy to implement both in hardware and software relatively",
    "start": "513200",
    "end": "518959"
  },
  {
    "text": "easy and it also performs well on a wide variety of hardware when they had the competition to",
    "start": "518959",
    "end": "525040"
  },
  {
    "text": "find like the the aes standard these were all things they wanted from the algorithm so",
    "start": "525040",
    "end": "530880"
  },
  {
    "text": "they wanted it to work well on both hardware and software and the standard comes with three key",
    "start": "530880",
    "end": "536480"
  },
  {
    "text": "lengths uh 128 192 or 256 bits i've never heard about anyone using 192",
    "start": "536480",
    "end": "543760"
  },
  {
    "text": "bits 128 is basically enough",
    "start": "543760",
    "end": "549200"
  },
  {
    "text": "however 256 doesn't run that much slower so a lot of people just use that also if you're worried about quantum",
    "start": "549200",
    "end": "555600"
  },
  {
    "text": "computing 256 is good",
    "start": "555600",
    "end": "559920"
  },
  {
    "text": "i'm going to analyze the smallest 128 bits because it's easier in the",
    "start": "560720",
    "end": "565839"
  },
  {
    "text": "example so a bit more about as then",
    "start": "565839",
    "end": "571360"
  },
  {
    "text": "it's a block cipher it takes in a plain text",
    "start": "571360",
    "end": "576399"
  },
  {
    "text": "encrypted using a secret key and outputs the cipher text and just so the figures i've made for",
    "start": "576399",
    "end": "581920"
  },
  {
    "text": "this presentation like the the uh rectangles with like",
    "start": "581920",
    "end": "587839"
  },
  {
    "text": "square pointy corners that's like data",
    "start": "587839",
    "end": "593519"
  },
  {
    "text": "and then these rounded corner ones are my functions and because i've worked too long in the",
    "start": "593519",
    "end": "599600"
  },
  {
    "text": "military context secret data is red or pink and encrypted data is black",
    "start": "599600",
    "end": "606560"
  },
  {
    "text": "so at any time there's something pink there's it's a plain text or a key",
    "start": "606560",
    "end": "613040"
  },
  {
    "text": "okay so i said it's a block cipher that means that it can only encrypt a",
    "start": "614000",
    "end": "620720"
  },
  {
    "text": "set number of bytes at a time so the plane the block size of aes is",
    "start": "620720",
    "end": "625800"
  },
  {
    "text": "128 bits which means that the only thing it can do is take a plain text that's",
    "start": "625800",
    "end": "631120"
  },
  {
    "text": "exactly 128 bits and produce the ciphertext that's exactly 128 bits",
    "start": "631120",
    "end": "636800"
  },
  {
    "text": "key size can vary but the block size is the same so if you want to encrypt more than this",
    "start": "636800",
    "end": "642480"
  },
  {
    "text": "you just have to run it again on the next block and then there are good ways of doing that that makes it more secure",
    "start": "642480",
    "end": "648640"
  },
  {
    "text": "but we are just going to assume today that you just do this again for the next block",
    "start": "648640",
    "end": "654800"
  },
  {
    "text": "yes um it may again it makes the attack",
    "start": "656880",
    "end": "662079"
  },
  {
    "text": "easier to explain but you can do attacks on other modes as well yeah",
    "start": "662079",
    "end": "668480"
  },
  {
    "text": "so the other thing about as is that it's a symmetric cipher as opposed to the",
    "start": "669440",
    "end": "674720"
  },
  {
    "text": "like rsa and elliptic curve which are asymmetric um so first of all decryption is the",
    "start": "674720",
    "end": "681360"
  },
  {
    "text": "inverse of encryption they look very similar and again it's the and",
    "start": "681360",
    "end": "687440"
  },
  {
    "text": "the main thing with a symmetric algorithm is that you use the same secret key for both",
    "start": "687440",
    "end": "693120"
  },
  {
    "text": "encryption and decryption",
    "start": "693120",
    "end": "696240"
  },
  {
    "text": "so this is as i drew it for you um",
    "start": "698560",
    "end": "704000"
  },
  {
    "text": "so right now you don't see the key input anymore but it's being added in these like you see these functions have pink",
    "start": "704000",
    "end": "709839"
  },
  {
    "text": "frames so there's something secret is being added there uh but just the overview of this algorithm",
    "start": "709839",
    "end": "715600"
  },
  {
    "text": "you start with the plain text and you send it into the first so there are four like sub functions into the first one",
    "start": "715600",
    "end": "722240"
  },
  {
    "text": "which is called add run key and then the output of that goes into the sub bytes output of that goes into shift rows and",
    "start": "722240",
    "end": "728160"
  },
  {
    "text": "the output of that goes into mixed columns and then you repeat like 9 11 or 13",
    "start": "728160",
    "end": "733200"
  },
  {
    "text": "times depending on your key length and in the last round apparently this",
    "start": "733200",
    "end": "738639"
  },
  {
    "text": "doesn't do anything good for you in the last round so you skip it and do an extra add round key and the",
    "start": "738639",
    "end": "744800"
  },
  {
    "text": "output from that is just your ciphertext um",
    "start": "744800",
    "end": "750079"
  },
  {
    "text": "so i said i didn't show you the key input right they're just it's just magically in those add round key",
    "start": "750079",
    "end": "755680"
  },
  {
    "text": "functions the thing is we do do the ad run key",
    "start": "755680",
    "end": "762320"
  },
  {
    "text": "10 12 or 14 times depending on your key length um [Music]",
    "start": "762480",
    "end": "768000"
  },
  {
    "text": "and each time we require a 128 bits of key material but we don't have that we",
    "start": "768000",
    "end": "773519"
  },
  {
    "text": "have 128 192 or 256. so there's a key expansion function that",
    "start": "773519",
    "end": "778639"
  },
  {
    "text": "you run first i'm not going to say what it does it's just it's deterministic",
    "start": "778639",
    "end": "784320"
  },
  {
    "text": "and it makes uh the number of 128 bits round keys that you need",
    "start": "784320",
    "end": "790800"
  },
  {
    "text": "and it preserves so if your input key has all the good randomness properties",
    "start": "790800",
    "end": "797279"
  },
  {
    "text": "all the round all the run keys will look random like they won't be a bunch of ones in a row or something",
    "start": "797279",
    "end": "803120"
  },
  {
    "text": "but you don't gain any more entropy it's just that it takes this and expands it in a good way",
    "start": "803120",
    "end": "810079"
  },
  {
    "text": "to like 10 12 or 14 of those round key blocks this is also unfortunately or",
    "start": "810079",
    "end": "815519"
  },
  {
    "text": "fortunately for us reversible so yeah if you have i'll cover it later but if you have one",
    "start": "815519",
    "end": "821680"
  },
  {
    "text": "round key you can go back uh up if your input key is 128 bits",
    "start": "821680",
    "end": "829040"
  },
  {
    "text": "if your input keys 256 you need to know two other round case two consecutive ones",
    "start": "829040",
    "end": "835440"
  },
  {
    "text": "okay so one more thing about aes it has a state it keeps the state matrix",
    "start": "835839",
    "end": "841199"
  },
  {
    "text": "so the block size is 128 bits which is 16 bytes and it just keeps them in a matrix like",
    "start": "841199",
    "end": "847120"
  },
  {
    "text": "this so for some reason it fills the columns first and that's so",
    "start": "847120",
    "end": "853680"
  },
  {
    "text": "when you start the algorithm you just take your 128 bit plain text and load into this matrix of bytes",
    "start": "853680",
    "end": "859440"
  },
  {
    "text": "and that's the starting state and then those four functions will just operate on this state",
    "start": "859440",
    "end": "867360"
  },
  {
    "text": "so let's go back to this so now we know that what happens here right with the plain text",
    "start": "869279",
    "end": "874800"
  },
  {
    "text": "is that you just put it into your state matrix and then you input the statement matrix to the add-on q function",
    "start": "874800",
    "end": "882399"
  },
  {
    "text": "so we're going to look at the four functions for the attack we need to know what the",
    "start": "882399",
    "end": "887519"
  },
  {
    "text": "first two functions do we actually don't need these two but i'm going to explain them briefly so",
    "start": "887519",
    "end": "895120"
  },
  {
    "text": "just so you can see that they're not like super difficult or anything",
    "start": "895120",
    "end": "900240"
  },
  {
    "text": "but first the add round key function you take your state and your xor in your round key which you have also loaded",
    "start": "900240",
    "end": "906240"
  },
  {
    "text": "into a matrix like this and it's basically just byte by byte xor",
    "start": "906240",
    "end": "912480"
  },
  {
    "text": "so yeah look my key is pink and now this is both yellow and pink yeah",
    "start": "912480",
    "end": "917760"
  },
  {
    "text": "um but yeah so what happens in the add round key function is that you add some",
    "start": "918480",
    "end": "923760"
  },
  {
    "text": "more randomness like you add your you add in key material this is the only function that actually",
    "start": "923760",
    "end": "929920"
  },
  {
    "text": "adds key material the other three functions if you know the input you know the output",
    "start": "929920",
    "end": "935040"
  },
  {
    "text": "like if you know the state before the function you know it after the function so the next function is sub bytes",
    "start": "935040",
    "end": "942160"
  },
  {
    "text": "where you take each byte in the state and just substitute it with another byte",
    "start": "942160",
    "end": "947279"
  },
  {
    "text": "that you find in the lookup table and this lookup table is called the s box",
    "start": "947279",
    "end": "952639"
  },
  {
    "text": "and it's just it's in the ias specifications so if you know the byte you look it up and you substitute it",
    "start": "952639",
    "end": "957839"
  },
  {
    "text": "with what's in the lookup table and that's it",
    "start": "957839",
    "end": "964320"
  },
  {
    "text": "so the shift rows shift row function i think they should call it rotate row",
    "start": "964880",
    "end": "970639"
  },
  {
    "text": "it takes the rows of the state matrix and shifts them to the left but then wraps around so i think it's a rotate",
    "start": "970639",
    "end": "977440"
  },
  {
    "text": "the first row just stays the same the second row gets shifted one to the left with a wraparound",
    "start": "977440",
    "end": "983920"
  },
  {
    "text": "the third row gets shifted two to the left and then final row three to the left so we don't change the values of",
    "start": "983920",
    "end": "990079"
  },
  {
    "text": "any bytes we just move them around and then the final function mix columns",
    "start": "990079",
    "end": "997440"
  },
  {
    "text": "um so i've just changed the variable names from b to d but you i'll show you what happens um you take",
    "start": "997440",
    "end": "1004880"
  },
  {
    "text": "each column so you start with the left column of b's b 0 to b 3 and you do a matrix",
    "start": "1004880",
    "end": "1011279"
  },
  {
    "text": "multiplication which again this matrix is just in the specification",
    "start": "1011279",
    "end": "1017440"
  },
  {
    "text": "so you multiply the matrix by the column in the state matrix and you get a",
    "start": "1017440",
    "end": "1022480"
  },
  {
    "text": "new column and you put it in the same place and you do the same with the next columns so you",
    "start": "1022480",
    "end": "1028319"
  },
  {
    "text": "input b4 to b7 and then you get d4 to d7 with the same matrix",
    "start": "1028319",
    "end": "1033918"
  },
  {
    "text": "and surprise it's not the matrix multiplication you think it is it happens in a finite field which is just",
    "start": "1033919",
    "end": "1040959"
  },
  {
    "text": "a weird math thing from abstract algebra it's not hard to implement",
    "start": "1040959",
    "end": "1046720"
  },
  {
    "text": "so even if you don't know actually don't go home and implement as it's not a good idea but even if you",
    "start": "1046720",
    "end": "1052400"
  },
  {
    "text": "don't know this math you can just look up how to implement this matrix and it's",
    "start": "1052400",
    "end": "1057760"
  },
  {
    "text": "really easy okay so now we know aas right",
    "start": "1057760",
    "end": "1066080"
  },
  {
    "text": "input the plain text and then we do these four functions a bunch of time and then we do an extra add-on key",
    "start": "1066080",
    "end": "1072480"
  },
  {
    "text": "and we get our ciphertext",
    "start": "1072480",
    "end": "1075840"
  },
  {
    "text": "any questions so everybody knows hey yes",
    "start": "1078240",
    "end": "1085600"
  },
  {
    "text": "oh yeah just one more thing actually i didn't even put in the the key sizes here but this is literally",
    "start": "1085600",
    "end": "1092640"
  },
  {
    "text": "the only difference between the different versions of aes is the input key size and how many rounds you do",
    "start": "1092640",
    "end": "1098720"
  },
  {
    "text": "everything else is the same i can also say that asd encryption",
    "start": "1098720",
    "end": "1104160"
  },
  {
    "text": "looks extremely similar you start here then you do an ad round key then you do",
    "start": "1104160",
    "end": "1109200"
  },
  {
    "text": "an inverse of throws and inverse of bytes and add wrong key is its own inverse and you just",
    "start": "1109200",
    "end": "1115120"
  },
  {
    "text": "have an inverse mixed columns here so it's exactly what you think it would be",
    "start": "1115120",
    "end": "1122400"
  },
  {
    "text": "okay so correlation power analysis um",
    "start": "1122400",
    "end": "1129840"
  },
  {
    "text": "it's one type one specific type of side channel analysis um so it's a power analysis so we look",
    "start": "1129840",
    "end": "1136240"
  },
  {
    "text": "at the power consumption of the chip that's running the code and correlation power analysis means",
    "start": "1136240",
    "end": "1142960"
  },
  {
    "text": "that we're using a statistical function to compute correlation between the data",
    "start": "1142960",
    "end": "1149360"
  },
  {
    "text": "in the as function and and the power measurements",
    "start": "1149360",
    "end": "1155440"
  },
  {
    "text": "and i'm immediately going to shorten correlation power analysis to cpa",
    "start": "1157200",
    "end": "1163440"
  },
  {
    "text": "um and the premise for cpa to work is that there is a correlation it's usually",
    "start": "1163520",
    "end": "1170000"
  },
  {
    "text": "small but it's there between the power consumption on the chip that's running in operation",
    "start": "1170000",
    "end": "1175679"
  },
  {
    "text": "and the data that this operation manipulates",
    "start": "1175679",
    "end": "1179840"
  },
  {
    "text": "so there in our example then there is a correlation between the values",
    "start": "1181200",
    "end": "1186960"
  },
  {
    "text": "of the state matrix at some point and",
    "start": "1186960",
    "end": "1192559"
  },
  {
    "text": "the power measurements so how do we do this attack then",
    "start": "1192559",
    "end": "1201440"
  },
  {
    "text": "we make our crypto implementation our ais implementation encryption of a number of different",
    "start": "1201440",
    "end": "1207360"
  },
  {
    "text": "plaintext blocks for example 50. i know 50 is going to work with this so but it",
    "start": "1207360",
    "end": "1213280"
  },
  {
    "text": "this depends a lot of on your how much noise you have so usually if your environment is noisy",
    "start": "1213280",
    "end": "1220880"
  },
  {
    "text": "you just need to encrypt more blocks and measure the power measurements of all of them",
    "start": "1220880",
    "end": "1226720"
  },
  {
    "text": "um and then yeah so we encrypt 50 different blocks of plain text",
    "start": "1226720",
    "end": "1233039"
  },
  {
    "text": "and for now we need to know the plain text just i know this doesn't sound very",
    "start": "1233039",
    "end": "1238559"
  },
  {
    "text": "realistic but for now just suspend your disbelief we know the plain text",
    "start": "1238559",
    "end": "1243760"
  },
  {
    "text": "this is you know we're looking for the key which is much more powerful than having the plain text",
    "start": "1243760",
    "end": "1249840"
  },
  {
    "text": "so all encryptions are done using the same key and we record the power measurements",
    "start": "1250000",
    "end": "1255840"
  },
  {
    "text": "for each encryption so we need to store like this power measurement was for this plain text",
    "start": "1255840",
    "end": "1261200"
  },
  {
    "text": "block and this was for this plain text block uh all 50 of them",
    "start": "1261200",
    "end": "1266880"
  },
  {
    "text": "so usually we don't really need this graph for anything but usually when you measure the when you measure",
    "start": "1267679",
    "end": "1273840"
  },
  {
    "text": "the power consumption during an as128 if you plot it it looks something like this",
    "start": "1273840",
    "end": "1279919"
  },
  {
    "text": "and the fun thing is that you can see that there are 10 rounds in aes 128.",
    "start": "1279919",
    "end": "1285520"
  },
  {
    "text": "again we can't read the key out from the graph or anything it's just that if you're in a more realistic scenario and if you",
    "start": "1285520",
    "end": "1292080"
  },
  {
    "text": "have like just a box doing encryption and you don't really know when to start",
    "start": "1292080",
    "end": "1297120"
  },
  {
    "text": "your measurement power measurement you just measure for a long time and then you look at the graph and you can",
    "start": "1297120",
    "end": "1302640"
  },
  {
    "text": "usually recognize where the crypto is going on and then you can analyze them just that part",
    "start": "1302640",
    "end": "1309279"
  },
  {
    "text": "um but this is like a continuous graph what does the data look like it looks something like this",
    "start": "1310400",
    "end": "1316960"
  },
  {
    "text": "um so if we have 50 plain texts we have like 50 of these vectors with just",
    "start": "1316960",
    "end": "1322720"
  },
  {
    "text": "a bunch of numbers i think these are voltages it doesn't really matter too much as long as they correlate to the data",
    "start": "1322720",
    "end": "1330480"
  },
  {
    "text": "so i don't it's probably like maybe a couple of thousand",
    "start": "1331520",
    "end": "1337440"
  },
  {
    "text": "entries in each row and those are just like discrete measurements of power along the time",
    "start": "1337440",
    "end": "1343039"
  },
  {
    "text": "axis",
    "start": "1343039",
    "end": "1346039"
  },
  {
    "text": "okay so back to aes uh now in my example we are",
    "start": "1348880",
    "end": "1354960"
  },
  {
    "text": "doing a side channel analysis of aes 128 so now we're doing like 10 rounds",
    "start": "1354960",
    "end": "1361679"
  },
  {
    "text": "uh however it doesn't really matter because we're going to attack in in the first round only",
    "start": "1361679",
    "end": "1367200"
  },
  {
    "text": "right here so we're going to look at the state matrix after",
    "start": "1367200",
    "end": "1372559"
  },
  {
    "text": "we've done add round key and sub bytes in the first round",
    "start": "1372559",
    "end": "1378640"
  },
  {
    "text": "and what does the state matrix look like at that exact time",
    "start": "1379840",
    "end": "1385200"
  },
  {
    "text": "it looks like this so it's you've done plain text xor the first round key",
    "start": "1385200",
    "end": "1391200"
  },
  {
    "text": "and then you do the s box look up and that's what it looks like",
    "start": "1391200",
    "end": "1397440"
  },
  {
    "text": "so we will we will try to correlate this data with the power measurement",
    "start": "1397600",
    "end": "1405600"
  },
  {
    "text": "um [Music] and to is i this",
    "start": "1405600",
    "end": "1412080"
  },
  {
    "text": "attack is basically like divide and conquer or something so we're going to focus on only one bite",
    "start": "1412080",
    "end": "1418320"
  },
  {
    "text": "i only care about the first bite the one with the run with frame around it",
    "start": "1418320",
    "end": "1423679"
  },
  {
    "text": "so i'm going to try to figure out what that bite of the round key is",
    "start": "1423679",
    "end": "1429200"
  },
  {
    "text": "so basically we're going to guess what key 0 is and we know p0 right because that's the",
    "start": "1429440",
    "end": "1435200"
  },
  {
    "text": "plain text and i said we know the plain text and really what we're going to do is that we're going to just exhaustive",
    "start": "1435200",
    "end": "1441600"
  },
  {
    "text": "search this byte we're going to guess all the possible values",
    "start": "1441600",
    "end": "1447039"
  },
  {
    "text": "which is like 2556 different values from 0 to 255 and compute",
    "start": "1447039",
    "end": "1453279"
  },
  {
    "text": "s s of q 0 x or p 0 for each of the possible values of the key byte",
    "start": "1453279",
    "end": "1459600"
  },
  {
    "text": "and i correlate that with the power trace",
    "start": "1459600",
    "end": "1464720"
  },
  {
    "text": "and see which one gives us the highest correlation and that one is usually the correct byte",
    "start": "1464720",
    "end": "1470159"
  },
  {
    "text": "for the key um and as light correction there because",
    "start": "1470159",
    "end": "1477279"
  },
  {
    "text": "there the correlation is usually between the power consumption and the numbers of bits that are set in this value",
    "start": "1477279",
    "end": "1484799"
  },
  {
    "text": "so we're going to take the hamming weight we're not going to use s of key 0 xo p0 we're going to use the hamming",
    "start": "1484799",
    "end": "1490640"
  },
  {
    "text": "weight of that and if you don't know what the hamming weight is it's exactly what i said on the slide it's the number",
    "start": "1490640",
    "end": "1496400"
  },
  {
    "text": "of one bits in your value and i'm",
    "start": "1496400",
    "end": "1502960"
  },
  {
    "text": "not um an expert in the physics of this but um",
    "start": "1502960",
    "end": "1508640"
  },
  {
    "text": "yeah i believe that there is a difference in how much power you use depending on how many bits are set",
    "start": "1508640",
    "end": "1514640"
  },
  {
    "text": "in your data also the attack works so i'm just going to trust the people who",
    "start": "1514640",
    "end": "1521919"
  },
  {
    "text": "said this okay so i said we're going to compute correlation i'm also not i'm i'm just going to stand",
    "start": "1521919",
    "end": "1528400"
  },
  {
    "text": "here and tell you what i'm not good at i'm also not good at statistics um but someone who is like pearson",
    "start": "1528400",
    "end": "1535360"
  },
  {
    "text": "apparently uh came up with this formula for a correlation coefficient and that's what we're going to use it",
    "start": "1535360",
    "end": "1543600"
  },
  {
    "text": "computes the correlation between two random variables x and y",
    "start": "1543600",
    "end": "1548880"
  },
  {
    "text": "so it goes through all the x's and subtracts the mean of all the x values and do the",
    "start": "1548960",
    "end": "1555360"
  },
  {
    "text": "same with the y's so in here we're going to say that x is",
    "start": "1555360",
    "end": "1560400"
  },
  {
    "text": "the hamming weights of s of k 0 x or p 0",
    "start": "1560400",
    "end": "1567600"
  },
  {
    "text": "for all the 50 different plain texts so n is 50 here and then y",
    "start": "1567600",
    "end": "1574240"
  },
  {
    "text": "is then the power measurement for each of those plain texts at a given time",
    "start": "1574240",
    "end": "1580400"
  },
  {
    "text": "and we have to do it for all the times but i'm going to kind of just hand wave that away and say",
    "start": "1580400",
    "end": "1585840"
  },
  {
    "text": "that uh we find the best correlation for this key bit",
    "start": "1585840",
    "end": "1591840"
  },
  {
    "text": "yeah so just to repeat because i assume you didn't all get that immediately from my",
    "start": "1592559",
    "end": "1599039"
  },
  {
    "text": "words again so we're going to say okay i guess now that the first part of the",
    "start": "1599039",
    "end": "1604400"
  },
  {
    "text": "key is zero and then i compute s of p zero x or q zero",
    "start": "1604400",
    "end": "1610799"
  },
  {
    "text": "and k 0 is not zero um but for all of the 50 plaintext blocks",
    "start": "1610799",
    "end": "1616320"
  },
  {
    "text": "and then i take the hamming weights of those and i compute the correlation between those hamming weights and our power",
    "start": "1616320",
    "end": "1623200"
  },
  {
    "text": "consumption uh and then i guess that k zero is now",
    "start": "1623200",
    "end": "1629440"
  },
  {
    "text": "one and i do the same and i compute the correlations so we do that for all possible values of",
    "start": "1629440",
    "end": "1635679"
  },
  {
    "text": "k zero getting like 256 different correlations",
    "start": "1635679",
    "end": "1640880"
  },
  {
    "text": "and we just pick the biggest one it's actually the absolute value because correlation can be negative",
    "start": "1640880",
    "end": "1647760"
  },
  {
    "text": "and it's still a match um but we pick the max correlation and we say that the",
    "start": "1647760",
    "end": "1654480"
  },
  {
    "text": "key byte value that gave us that correlation that's that's our k0",
    "start": "1654480",
    "end": "1659679"
  },
  {
    "text": "um [Music] and this is just an example of like one experiment that was run on this",
    "start": "1660080",
    "end": "1667360"
  },
  {
    "text": "these are 256 correlations and you can see which one yeah it's up there",
    "start": "1667360",
    "end": "1674000"
  },
  {
    "text": "this is the k0 i'm choosing to believe is actually k0",
    "start": "1674000",
    "end": "1679039"
  },
  {
    "text": "yeah i don't um this is just i don't even remember where this data is at like when",
    "start": "1679279",
    "end": "1685520"
  },
  {
    "text": "i did it but but yeah there's usually a big difference at least with this like",
    "start": "1685520",
    "end": "1690960"
  },
  {
    "text": "this is just an ideal setup right so if you're if you have something that produces a lot",
    "start": "1690960",
    "end": "1697600"
  },
  {
    "text": "like does a lot more things or there are other powers close by that maybe you're picking up",
    "start": "1697600",
    "end": "1702880"
  },
  {
    "text": "um it's not this distinct but just to show you that if you if you're just running",
    "start": "1702880",
    "end": "1708000"
  },
  {
    "text": "it on a chip and nothing else and measure very closely it yeah it's a good attack",
    "start": "1708000",
    "end": "1714799"
  },
  {
    "text": "so we have found k0 or our best guess but you know according to the previous slide it's a pretty good",
    "start": "1715039",
    "end": "1721039"
  },
  {
    "text": "guess so then we go back to the state matrix and we move on to the next entry in the",
    "start": "1721039",
    "end": "1727120"
  },
  {
    "text": "state matrix and guess key values for q1 and do the same thing",
    "start": "1727120",
    "end": "1732399"
  },
  {
    "text": "and for the rest of the key bytes so we just repeat the attack for each entry in the state matrix",
    "start": "1732399",
    "end": "1738880"
  },
  {
    "text": "to find the 16 different bytes of the round key",
    "start": "1738880",
    "end": "1744159"
  },
  {
    "text": "and from the round key as i said because the key expansion thing is invertible we can deduce the input key",
    "start": "1744320",
    "end": "1751919"
  },
  {
    "text": "also if we do what i did now and analyze the first round the round key is the input key",
    "start": "1751919",
    "end": "1758320"
  },
  {
    "text": "because that's just how the key expansion works the first copy is the key into the first run key and then it does some things",
    "start": "1758320",
    "end": "1764640"
  },
  {
    "text": "but that doesn't really matter it's not hard to invert the key expansion function um",
    "start": "1764640",
    "end": "1770559"
  },
  {
    "text": "so yeah now we have found the key in 16 times 2 to the 8 guesses",
    "start": "1770559",
    "end": "1777120"
  },
  {
    "text": "which is 2 to the 12 because i'm good at math and that's a lot better than trying to",
    "start": "1777120",
    "end": "1782480"
  },
  {
    "text": "guess the whole key without any information because that's 2 to the 128 and you cannot do that",
    "start": "1782480",
    "end": "1790320"
  },
  {
    "text": "but 2 to the 12 is easy it goes fast",
    "start": "1790320",
    "end": "1794919"
  },
  {
    "text": "okay so this is where everything could go wrong right i'm going to show you this",
    "start": "1797440",
    "end": "1803278"
  },
  {
    "text": "[Laughter] so i can tell you a little bit about um",
    "start": "1803630",
    "end": "1810799"
  },
  {
    "text": "my hardware as well i'm just going to find my browser",
    "start": "1810799",
    "end": "1817278"
  },
  {
    "text": "okay so i'm running so this uh hardware",
    "start": "1818240",
    "end": "1824960"
  },
  {
    "text": "it's called chip whisperer it's made by a company called new ie and i bought all of this for like a few",
    "start": "1824960",
    "end": "1832080"
  },
  {
    "text": "thousand kona i think um and it they also have a software like",
    "start": "1832080",
    "end": "1837840"
  },
  {
    "text": "some python code that you just get off their github github and they have pretty good documentation for how to use it so",
    "start": "1837840",
    "end": "1845279"
  },
  {
    "text": "seriously if you don't know anything about site channel attacks but you think it sounds fun you can basically buy this",
    "start": "1845279",
    "end": "1850880"
  },
  {
    "text": "stuff use their software and you can run an attack without knowing what you're doing just press play on their demo",
    "start": "1850880",
    "end": "1856559"
  },
  {
    "text": "basically but they also have nice tutorials laid out like",
    "start": "1856559",
    "end": "1861760"
  },
  {
    "text": "they tell you about aes and then they're like okay insert your code here",
    "start": "1861760",
    "end": "1866399"
  },
  {
    "text": "so i'm just going to i'm using most of their code my wonderful assistant again removed all",
    "start": "1867760",
    "end": "1872960"
  },
  {
    "text": "the unnecessary things but just to show you so um this is run",
    "start": "1872960",
    "end": "1879760"
  },
  {
    "text": "in so it's python code and it's run in an environment called gypter um",
    "start": "1879760",
    "end": "1885919"
  },
  {
    "text": "which is just you run a block of code and then you see the outputs immediately so it works very well for this",
    "start": "1885919",
    "end": "1891120"
  },
  {
    "text": "um we're just first we're just setting some uh environment things so scope type",
    "start": "1891120",
    "end": "1897600"
  },
  {
    "text": "open adc that's this oscilloscope you can also like this isn't the best oscilloscope in the world so i've also",
    "start": "1897600",
    "end": "1904080"
  },
  {
    "text": "done this by connecting like a better oscilloscope just from a different vendor and that",
    "start": "1904080",
    "end": "1909360"
  },
  {
    "text": "then you just have to specify something else um platform that's the chip we're running the as",
    "start": "1909360",
    "end": "1916000"
  },
  {
    "text": "code on so it's a 32-bit processor that sits on here",
    "start": "1916000",
    "end": "1921840"
  },
  {
    "text": "and crypto target is the aes implementation a tiny as128 is something that ships",
    "start": "1921840",
    "end": "1928000"
  },
  {
    "text": "with chip whisperer i've also done the attack on the same hardware",
    "start": "1928000",
    "end": "1933360"
  },
  {
    "text": "with embed tls and their as implementation and that works as well",
    "start": "1933360",
    "end": "1940398"
  },
  {
    "text": "and the generic setup script is basically their code to connect so hopefully it will say it found chip",
    "start": "1940559",
    "end": "1946840"
  },
  {
    "text": "whisperer yes okay",
    "start": "1946840",
    "end": "1953519"
  },
  {
    "text": "so now we need to compile the code for the as target and this is just a bash command and a make file",
    "start": "1953519",
    "end": "1961799"
  },
  {
    "text": "and we're looking for this it built oops",
    "start": "1962799",
    "end": "1968480"
  },
  {
    "text": "and then this takes a bit of time actually loading the code onto the target",
    "start": "1971039",
    "end": "1977840"
  },
  {
    "text": "yes good so now comes the fun part we're going to",
    "start": "1982159",
    "end": "1987660"
  },
  {
    "text": "[Music] going to uh send in the key and the plain texts and record",
    "start": "1987660",
    "end": "1993919"
  },
  {
    "text": "the power measurements and i set my key dead beef cafe babe one two three four",
    "start": "1993919",
    "end": "2000960"
  },
  {
    "text": "five six seven eight so it's easily recognizable right um and n equals 50 is that we're going",
    "start": "2000960",
    "end": "2007679"
  },
  {
    "text": "to do encrypt 50 plaintext blocks um and this is just",
    "start": "2007679",
    "end": "2014240"
  },
  {
    "text": "this line generates a random plaintext block so just random data",
    "start": "2014240",
    "end": "2020720"
  },
  {
    "text": "uh it doesn't really matter it can be like real plain text but uh we just need them to be different from each other the",
    "start": "2020720",
    "end": "2025840"
  },
  {
    "text": "blocks so this is the way to do that and then we're sending them in and capturing traces for this scope and this",
    "start": "2025840",
    "end": "2032000"
  },
  {
    "text": "target and the plaintext block and the key",
    "start": "2032000",
    "end": "2036640"
  },
  {
    "text": "and recording the traces and it's done",
    "start": "2037440",
    "end": "2043919"
  },
  {
    "text": "so i'm not even showing you the code right but the",
    "start": "2044840",
    "end": "2051358"
  },
  {
    "text": "i think it's the attack code i don't even know which yeah so here we're setting we're going to look at the s box",
    "start": "2053760",
    "end": "2059440"
  },
  {
    "text": "output that's the model we're using because there are other ways of doing side channel attacks but we're specifying that",
    "start": "2059440",
    "end": "2066398"
  },
  {
    "text": "and we're running the attack and then",
    "start": "2066399",
    "end": "2072560"
  },
  {
    "text": "the last line is basically how to show the results and this is some",
    "start": "2072560",
    "end": "2078480"
  },
  {
    "text": "this is the way that the chip whisperer if you just use their attack code here it will show",
    "start": "2078480",
    "end": "2084320"
  },
  {
    "text": "it will show us a table with 16 columns one column for each key",
    "start": "2084320",
    "end": "2090240"
  },
  {
    "text": "byte and then i think there are like six rows under that we will see um",
    "start": "2090240",
    "end": "2096320"
  },
  {
    "text": "and the top row is like the best guess at the moment for each key byte with the correlation listed underneath",
    "start": "2096320",
    "end": "2102640"
  },
  {
    "text": "and then there's the second row is like the next best guess at the moment with its correlation and stuff like that",
    "start": "2102640",
    "end": "2109440"
  },
  {
    "text": "and it does this because it it computes the correlation gradually adding more and more traces to",
    "start": "2109440",
    "end": "2116240"
  },
  {
    "text": "its computation so we will see the correct bytes like moving up the table and the correct",
    "start": "2116240",
    "end": "2122560"
  },
  {
    "text": "bytes are encoded in red just so it's easier for us to see",
    "start": "2122560",
    "end": "2128000"
  },
  {
    "text": "and there's going to be an error message but it will go away is hopefully the thing",
    "start": "2128400",
    "end": "2135200"
  },
  {
    "text": "yes so you can see the red ones moving up",
    "start": "2135920",
    "end": "2142640"
  },
  {
    "text": "and yes it found the key after like 35 traces",
    "start": "2142640",
    "end": "2147440"
  },
  {
    "text": "so we can actually go back yeah i think have time for that and just",
    "start": "2149359",
    "end": "2155440"
  },
  {
    "text": "set the end to so i can set it to 35 and show you that it will still be able to do it or i can",
    "start": "2156720",
    "end": "2162160"
  },
  {
    "text": "set it to something lower and we can see let's do like 25",
    "start": "2162160",
    "end": "2169040"
  },
  {
    "text": "because then we're not i don't think we will find all the bytes but we will find some of them",
    "start": "2169359",
    "end": "2175280"
  },
  {
    "text": "and i can set this to update a bit slower like that's just how many traces it takes",
    "start": "2177280",
    "end": "2182720"
  },
  {
    "text": "before it updates the table",
    "start": "2182720",
    "end": "2186599"
  },
  {
    "text": "yeah it's done so you see that the ones that couldn't find they're not too far off",
    "start": "2195280",
    "end": "2200960"
  },
  {
    "text": "right um but oh some of them are like bite number seven eight it's not even close um",
    "start": "2200960",
    "end": "2209599"
  },
  {
    "text": "so yeah it takes you so this shows that you need to have a certain number of different plain texts for this",
    "start": "2209680",
    "end": "2216240"
  },
  {
    "text": "statistics thing to work",
    "start": "2216240",
    "end": "2219680"
  },
  {
    "text": "and that's usually as i said if you have a lot of noise in your measurements you need more",
    "start": "2221520",
    "end": "2227359"
  },
  {
    "text": "plain text blocks",
    "start": "2227359",
    "end": "2230240"
  },
  {
    "text": "okay this is hardware so we need to disconnect so it won't yell at me later",
    "start": "2232480",
    "end": "2238000"
  },
  {
    "text": "however usually just unplugging it also works don't try that at home",
    "start": "2239839",
    "end": "2246160"
  },
  {
    "text": "okay so some more thoughts on this",
    "start": "2248640",
    "end": "2255520"
  },
  {
    "text": "yes the first thing known plain text first of all it's not unrealistic in all",
    "start": "2255520",
    "end": "2262320"
  },
  {
    "text": "scenarios like you have if you encrypt like word files you know what the header is going to",
    "start": "2262320",
    "end": "2268839"
  },
  {
    "text": "be and if you encrypt a lot of word files you can just look at the blocks that you know is a known",
    "start": "2268839",
    "end": "2275119"
  },
  {
    "text": "header and just not look at the other ones and",
    "start": "2275119",
    "end": "2281440"
  },
  {
    "text": "i i said so someone hears that electronic code book mode is the mod we're using aes in right now that's what",
    "start": "2281440",
    "end": "2287520"
  },
  {
    "text": "you do when you just take like one plain text block encrypted next plain text block encrypted in the",
    "start": "2287520",
    "end": "2293520"
  },
  {
    "text": "same way don't use ais like that it's not a good idea",
    "start": "2293520",
    "end": "2299599"
  },
  {
    "text": "um instead you should do something that makes so if you have the same plain text block",
    "start": "2299599",
    "end": "2304720"
  },
  {
    "text": "twice it shouldn't give you the same cipher text block twice you should add something else to it um and then i would",
    "start": "2304720",
    "end": "2312560"
  },
  {
    "text": "say two of the most commonly used aes modes are known as counter mode and gcm mode",
    "start": "2312560",
    "end": "2319760"
  },
  {
    "text": "and they both use this thing where they don't put your plain text through es they put an iv or a counter",
    "start": "2319760",
    "end": "2328000"
  },
  {
    "text": "through aes and the output from aes is used as a key that you xor with your actual plain text",
    "start": "2328000",
    "end": "2335359"
  },
  {
    "text": "and this is fine as long as you never reuse that iv with the same key",
    "start": "2335359",
    "end": "2341200"
  },
  {
    "text": "however because aas is a good algorithm you can do this because and you can have",
    "start": "2341200",
    "end": "2347680"
  },
  {
    "text": "this counter or iv that you put into aes it can be known because even if you know",
    "start": "2347680",
    "end": "2352960"
  },
  {
    "text": "the plain text aes doesn't tell you anything about the ciphertext",
    "start": "2352960",
    "end": "2358640"
  },
  {
    "text": "so even if you know the input as you don't know the secret key and you don't know the output so",
    "start": "2358640",
    "end": "2364160"
  },
  {
    "text": "you can encrypt things like this however it gives us an opportunity to know the plain text that goes into aas",
    "start": "2364160",
    "end": "2371680"
  },
  {
    "text": "for side channel analysis just if you're going home to look this up later",
    "start": "2371680",
    "end": "2377680"
  },
  {
    "text": "as our side channel analysis of counter mode is a bit more complicated than that because",
    "start": "2377680",
    "end": "2383520"
  },
  {
    "text": "the plain text blocks are so similar that you don't get very much statistical variety but there is a way to do it you",
    "start": "2383520",
    "end": "2390800"
  },
  {
    "text": "just have to analyze like four or five rounds and then you get the key but my point still holds that you know the",
    "start": "2390800",
    "end": "2397520"
  },
  {
    "text": "plain text right in a lot of aes encryption that happens we know the plain text input of aes we",
    "start": "2397520",
    "end": "2404400"
  },
  {
    "text": "just don't know the plain text that's finally getting encrypted however",
    "start": "2404400",
    "end": "2410160"
  },
  {
    "text": "we don't need to know the plaintext we can also know the ciphertext",
    "start": "2410160",
    "end": "2415440"
  },
  {
    "text": "so instead of going from the front of the algorithm we can go from the back so we know the ciphertext",
    "start": "2415440",
    "end": "2422640"
  },
  {
    "text": "we guess on the the last round key and then we compute our way",
    "start": "2422640",
    "end": "2428240"
  },
  {
    "text": "into the middle of that round and analyze the state matrix there",
    "start": "2428240",
    "end": "2434240"
  },
  {
    "text": "i'm not going to show it on a figure but it works the same way one reason i'm not going to show it is that the makes",
    "start": "2434240",
    "end": "2440480"
  },
  {
    "text": "columns function is weird um but yeah so you do the attack on the",
    "start": "2440480",
    "end": "2445839"
  },
  {
    "text": "final round um finding that round key but then you need",
    "start": "2445839",
    "end": "2450880"
  },
  {
    "text": "to do the actual inverse of the key expansion because you don't have the first round key anymore you have the last one",
    "start": "2450880",
    "end": "2457839"
  },
  {
    "text": "but as i said you can just do that it look the specification up and do it",
    "start": "2457839",
    "end": "2463359"
  },
  {
    "text": "yeah so um as i said the key expansion is is",
    "start": "2464319",
    "end": "2469680"
  },
  {
    "text": "reversible and for aes 128 you need to know just one of these so it can even be like round key number six if that's",
    "start": "2469680",
    "end": "2476319"
  },
  {
    "text": "where you're attacking um and for as256 i'll come back to 256. you",
    "start": "2476319",
    "end": "2482560"
  },
  {
    "text": "need to know two consecutive ones um [Music] and since no one is using as192 i don't",
    "start": "2482560",
    "end": "2490560"
  },
  {
    "text": "actually know i assume you need to know one one and a half or two",
    "start": "2490560",
    "end": "2496160"
  },
  {
    "text": "so what about as256 as i said uh",
    "start": "2498400",
    "end": "2503440"
  },
  {
    "text": "to get the input key you need to know two consecutive run keys so how do you",
    "start": "2503440",
    "end": "2508560"
  },
  {
    "text": "do that if so if we're attacking from the beginning of the algorithm again with a known",
    "start": "2508560",
    "end": "2514640"
  },
  {
    "text": "plaintext you do exactly what we did in the example so you get the first run key",
    "start": "2514640",
    "end": "2521040"
  },
  {
    "text": "but then you know then you can compute the output from the first round the state matrix after the first round",
    "start": "2521040",
    "end": "2528400"
  },
  {
    "text": "and that's the in the state matrix that's the input to the second round which is basically like knowing the",
    "start": "2528400",
    "end": "2534880"
  },
  {
    "text": "plain text for the first round so now you know the input to the second round and you do the",
    "start": "2534880",
    "end": "2540240"
  },
  {
    "text": "exact same attack you know the input and you xor it with the key that you're",
    "start": "2540240",
    "end": "2547200"
  },
  {
    "text": "guessing take the s box take the hamming weight and do the correlation there",
    "start": "2547200",
    "end": "2553599"
  },
  {
    "text": "and you can also do the do it from the back knowing the ciphertext going backwards",
    "start": "2556720",
    "end": "2562960"
  },
  {
    "text": "the same way i explained you just have to do the final two rounds just not the final round",
    "start": "2562960",
    "end": "2569039"
  },
  {
    "text": "and we haven't talked about decryption i briefly said that there is an inverse of all of those four functions",
    "start": "2572319",
    "end": "2579280"
  },
  {
    "text": "and you can also do the attack there because it's so similar",
    "start": "2579280",
    "end": "2583920"
  },
  {
    "text": "and it works with both known plain text and don't ciphertext",
    "start": "2584960",
    "end": "2589838"
  },
  {
    "text": "so uh usually right encryption",
    "start": "2591599",
    "end": "2596640"
  },
  {
    "text": "uh is used to so when you when you teach crypto to people you're like so",
    "start": "2596640",
    "end": "2601920"
  },
  {
    "text": "it's always alice and bob by the way so there's this uh person named alice and she wants to send a message to bob and",
    "start": "2601920",
    "end": "2607520"
  },
  {
    "text": "it needs to be very secret so that the evil eavesdropper eve who's in the middle listening to the channel cannot",
    "start": "2607520",
    "end": "2613520"
  },
  {
    "text": "read it so the whole thing is that alice is over here with her computer writing her plain text and then",
    "start": "2613520",
    "end": "2619760"
  },
  {
    "text": "encrypting it and then sending it over some kind of channel and eve is on the channel",
    "start": "2619760",
    "end": "2627040"
  },
  {
    "text": "but she's not on the computer right so what we've done here is that we've moved the attack to the computer where the encryption or",
    "start": "2627040",
    "end": "2633680"
  },
  {
    "text": "the decryption happens this message is still perfectly secure on the network",
    "start": "2633680",
    "end": "2639440"
  },
  {
    "text": "if you haven't like first attacked the computer of course so in general",
    "start": "2639440",
    "end": "2646079"
  },
  {
    "text": "side channel attacks are they only work if you have access to the",
    "start": "2646079",
    "end": "2652640"
  },
  {
    "text": "chip running the code and you don't always have that but sometimes you do and if you",
    "start": "2652640",
    "end": "2658560"
  },
  {
    "text": "if you have a product that's running uh ais and you just give the product to your enemy",
    "start": "2658560",
    "end": "2666160"
  },
  {
    "text": "like i don't see anyone from konax niagara here so if you have",
    "start": "2666160",
    "end": "2671680"
  },
  {
    "text": "if say your business is that uh you're in the um",
    "start": "2671680",
    "end": "2677599"
  },
  {
    "text": "in the continent uh in the dvd business and you have a setup box that decrypts the",
    "start": "2677599",
    "end": "2684480"
  },
  {
    "text": "tv signals right and you give the set the box to the customer and the customer wants free tv",
    "start": "2684480",
    "end": "2689520"
  },
  {
    "text": "so this box runs a lot of the encryptions so you can just attack it",
    "start": "2689520",
    "end": "2696880"
  },
  {
    "text": "so there are several as opposed to like if you're in the military and you have this like",
    "start": "2696880",
    "end": "2702480"
  },
  {
    "text": "crypto box you're a soldier and you carry it with you like you protect it with your life",
    "start": "2702480",
    "end": "2708160"
  },
  {
    "text": "it's less likely that someone is going to be able to run a lot of decryptions on your equipment because as soon as you lose it",
    "start": "2708160",
    "end": "2714880"
  },
  {
    "text": "you report it to all the accounting things and then they disable it or they don't use that",
    "start": "2714880",
    "end": "2721200"
  },
  {
    "text": "key anymore or whatever right so there are different scenarios",
    "start": "2721200",
    "end": "2727040"
  },
  {
    "text": "if you're on your computer and don't give that computer to someone else then",
    "start": "2727040",
    "end": "2733839"
  },
  {
    "text": "i don't know you could be secure however um",
    "start": "2733839",
    "end": "2739200"
  },
  {
    "text": "so there was this attack maybe a couple of years ago called platypus that that paper had a lot of attacks in",
    "start": "2739200",
    "end": "2745599"
  },
  {
    "text": "it but one of them was as power a cpa attack",
    "start": "2745599",
    "end": "2751440"
  },
  {
    "text": "because intel had this brilliant idea that we have these processors",
    "start": "2751440",
    "end": "2757040"
  },
  {
    "text": "and we should measure how much power they consume so that we can like keep track of that and if they use a lot of",
    "start": "2757040",
    "end": "2762800"
  },
  {
    "text": "power we should do something and if they don't use enough power then maybe there's something wrong and we should do something",
    "start": "2762800",
    "end": "2769119"
  },
  {
    "text": "and that's fine the problem is that this they stored this power measurement in a register that was available to user space",
    "start": "2769119",
    "end": "2776720"
  },
  {
    "text": "if you were on linux it was even available to unprivileged users i think on windows you needed to have a",
    "start": "2776720",
    "end": "2782160"
  },
  {
    "text": "privileged user but still the so the resolution of these power",
    "start": "2782160",
    "end": "2788079"
  },
  {
    "text": "measurements wasn't quite enough to do cpa but the researchers figured out if they just encrypted a lot of data",
    "start": "2788079",
    "end": "2795280"
  },
  {
    "text": "they could do some averages and get uh get measurements that made them find the",
    "start": "2795280",
    "end": "2801359"
  },
  {
    "text": "key i'm pretty sure until has fixed this",
    "start": "2801359",
    "end": "2808000"
  },
  {
    "text": "because it was a couple of years ago and they did the whole they did alert intel first and all the",
    "start": "2808000",
    "end": "2813440"
  },
  {
    "text": "things they're supposed to do it's just an example of you need physical access unless someone",
    "start": "2813440",
    "end": "2818800"
  },
  {
    "text": "just records it for you and puts it in a register you can use you can even read it from like if you do a network attack",
    "start": "2818800",
    "end": "2825119"
  },
  {
    "text": "as as long as you get user uh yeah have user access in the os you",
    "start": "2825119",
    "end": "2830319"
  },
  {
    "text": "can read it um and then timing attacks can so all the",
    "start": "2830319",
    "end": "2835440"
  },
  {
    "text": "attacks were just measure running time of an algorithm can usually be done over a network",
    "start": "2835440",
    "end": "2840480"
  },
  {
    "text": "connection as long as your network connection doesn't put in too many random delays and stuff like that",
    "start": "2840480",
    "end": "2847520"
  },
  {
    "text": "but i've seen several examples of attacks where you just you can do it over a network",
    "start": "2847520",
    "end": "2854078"
  },
  {
    "text": "okay so i'm basically done i just want to show you again the hardware i'm using",
    "start": "2855440",
    "end": "2862240"
  },
  {
    "text": "it's from chip whisperer and it's not very expensive so if you just want to try it out or even if you like make a",
    "start": "2862240",
    "end": "2867440"
  },
  {
    "text": "product and you just want to check it we use this when i worked for a tallest norway",
    "start": "2867440",
    "end": "2873839"
  },
  {
    "text": "we used this just to check some of the things we we made it's because it's a lot better",
    "start": "2873839",
    "end": "2879680"
  },
  {
    "text": "than checking nothing right so it's made by new aaa technology",
    "start": "2879680",
    "end": "2885119"
  },
  {
    "text": "and it's called chip whisperer um if you need like i'm now shamelessly",
    "start": "2885119",
    "end": "2890880"
  },
  {
    "text": "plugging my next employer right uh if you because if you need like real help if you have a product and you're like",
    "start": "2890880",
    "end": "2896640"
  },
  {
    "text": "someone please test this for me their equipment looks more like that it's a lot more fancy they can do a lot",
    "start": "2896640",
    "end": "2902800"
  },
  {
    "text": "more they can compensate for a lot of noise",
    "start": "2902800",
    "end": "2909680"
  },
  {
    "text": "and one of one thing that people usually do to make this harder like side channel analysis harder you can put in random",
    "start": "2909680",
    "end": "2916559"
  },
  {
    "text": "delays so that the 50 different plain text blocks the timings don't line up",
    "start": "2916559",
    "end": "2921920"
  },
  {
    "text": "but they have software like their their software is called inspector and they have a lot",
    "start": "2921920",
    "end": "2928079"
  },
  {
    "text": "of things in there to correct for the delays and everything so [Music]",
    "start": "2928079",
    "end": "2933680"
  },
  {
    "text": "so you can either you know send stuff to them and have them analyze it or you can buy this equipment if you have a",
    "start": "2933680",
    "end": "2940000"
  },
  {
    "text": "lot of money but you know i'm not saying you should buy it and take it home and play with it but if you're a company who",
    "start": "2940000",
    "end": "2946640"
  },
  {
    "text": "makes something that needs to be really secure because like they do sell that it is a business to sell this stuff so yeah",
    "start": "2946640",
    "end": "2954839"
  },
  {
    "text": "um that's it um sometimes i tweet usually i don't but if",
    "start": "2954839",
    "end": "2961760"
  },
  {
    "text": "you want to find me i'm there and these are just again the links to the chip whisperer so",
    "start": "2961760",
    "end": "2967760"
  },
  {
    "text": "the hardware link is to where you can buy the hardware",
    "start": "2967760",
    "end": "2972880"
  },
  {
    "text": "and the software link is to the documentation that tells you how to use the software and it also just gives",
    "start": "2972880",
    "end": "2979040"
  },
  {
    "text": "you a link to github yeah i think that's it um i have like 10",
    "start": "2979040",
    "end": "2985520"
  },
  {
    "text": "minutes so if there are questions i can take questions if not you can just talk to me afterwards",
    "start": "2985520",
    "end": "2992480"
  },
  {
    "text": "yes",
    "start": "2993760",
    "end": "2996760"
  },
  {
    "text": "okay",
    "start": "3008000",
    "end": "3011000"
  },
  {
    "text": "i'm just going to do yeah i'll just get to",
    "start": "3019280",
    "end": "3024480"
  },
  {
    "text": "this part and then we can",
    "start": "3024480",
    "end": "3027838"
  },
  {
    "text": "sorry the next candidate",
    "start": "3031280",
    "end": "3036599"
  },
  {
    "text": "yeah so you wanted like two hundred",
    "start": "3043280",
    "end": "3049640"
  },
  {
    "text": "takes a bit longer okay so i'm going to just set the update interval up",
    "start": "3062000",
    "end": "3068640"
  },
  {
    "text": "should we even do more than five okay",
    "start": "3068640",
    "end": "3074920"
  },
  {
    "text": "it's going to take a while",
    "start": "3087200",
    "end": "3090160"
  },
  {
    "text": "okay so you just thought the numbers the correlation numbers weren't so good",
    "start": "3092240",
    "end": "3097839"
  },
  {
    "text": "yeah yeah",
    "start": "3099280",
    "end": "3104240"
  },
  {
    "text": "i'll just let it run through but we can take another question if there is one",
    "start": "3105839",
    "end": "3111480"
  },
  {
    "text": "um no so the question was why like why did we attack after the s books",
    "start": "3122160",
    "end": "3128160"
  },
  {
    "text": "and again since i'm not so good at this for six things it's because it works someone else has shown that it works uh",
    "start": "3128160",
    "end": "3134400"
  },
  {
    "text": "but it's not the only way um and uh",
    "start": "3134400",
    "end": "3139599"
  },
  {
    "text": "i think it's because enough data has changed because it you could try attacking right",
    "start": "3139599",
    "end": "3145040"
  },
  {
    "text": "after ad ronkey but i don't think i'm actually not sure",
    "start": "3145040",
    "end": "3150880"
  },
  {
    "text": "but it's always like if you can do it there that's what you do but sometimes you can't because",
    "start": "3150880",
    "end": "3157119"
  },
  {
    "text": "yes there are different ways of implementing it so sometimes you attack at the end of the round",
    "start": "3157119",
    "end": "3162640"
  },
  {
    "text": "or if if you're if you implement as in hardware",
    "start": "3162640",
    "end": "3168240"
  },
  {
    "text": "um [Music] say you do fpga implementation you usually one round is done in one",
    "start": "3168240",
    "end": "3174640"
  },
  {
    "text": "clock cycle and there's no like the output of the s-box isn't",
    "start": "3174640",
    "end": "3180400"
  },
  {
    "text": "stored in a register it just flows directly into the next function and that doesn't impact the power",
    "start": "3180400",
    "end": "3186960"
  },
  {
    "text": "consumption enough so you look at i think i think the",
    "start": "3186960",
    "end": "3193440"
  },
  {
    "text": "thing they recommend for fpga implementation is to look at the xor of the input and the output of the",
    "start": "3193440",
    "end": "3199920"
  },
  {
    "text": "round or something but there are different like they're called leakage models it's",
    "start": "3199920",
    "end": "3206559"
  },
  {
    "text": "yeah you you determine based on just like",
    "start": "3206559",
    "end": "3211760"
  },
  {
    "text": "uh you do different examples and you see where you can actually get enough leakage data to",
    "start": "3211760",
    "end": "3217920"
  },
  {
    "text": "to i guess correlate i was going with it was my initial thought was that that's",
    "start": "3217920",
    "end": "3225280"
  },
  {
    "text": "at that point we're doing something computationally expensive and that's why we get a power supply we don't",
    "start": "3225280",
    "end": "3232559"
  },
  {
    "text": "necessarily do something computationally expensive because the s box",
    "start": "3232559",
    "end": "3237599"
  },
  {
    "text": "in software is usually implemented as a lookup table",
    "start": "3237599",
    "end": "3242160"
  },
  {
    "text": "so oh so you just i don't really understand what you mean now",
    "start": "3246000",
    "end": "3252960"
  },
  {
    "text": "so you are attacking after you've done the uh you've done the xor with the",
    "start": "3254160",
    "end": "3259359"
  },
  {
    "text": "text and the key and then you do the s box and then you do the shift rows",
    "start": "3259359",
    "end": "3266480"
  },
  {
    "text": "and then finally you do the finite field thing you are looking at the point between",
    "start": "3266480",
    "end": "3272720"
  },
  {
    "text": "after you've done the xbox xbox and then the shift rows uh isn't this",
    "start": "3272720",
    "end": "3278559"
  },
  {
    "text": "is something computationally expensive happens after that yeah yeah",
    "start": "3278559",
    "end": "3284480"
  },
  {
    "text": "um yeah so it's uh it's a quicker attack if you",
    "start": "3284480",
    "end": "3289920"
  },
  {
    "text": "if you attack where we attack is that what you meant now yeah it was a question and if that is the case then",
    "start": "3290160",
    "end": "3296799"
  },
  {
    "text": "would it be possible to generalize this sort of effects to other algorithms yes",
    "start": "3296799",
    "end": "3303119"
  },
  {
    "text": "no no you can do this on this you can do it you but you just need to know the",
    "start": "3304000",
    "end": "3309119"
  },
  {
    "text": "algorithm right because you need to be able to compute something inside it so i think the first paper on this kind of",
    "start": "3309119",
    "end": "3314880"
  },
  {
    "text": "analysis was done on des and i assume you can do it as long as",
    "start": "3314880",
    "end": "3321280"
  },
  {
    "text": "you have the algorithm spec you will just yeah you just need to find a place in the algorithm where",
    "start": "3321280",
    "end": "3328000"
  },
  {
    "text": "the power consumption leaks enough and you can compute the state",
    "start": "3328000",
    "end": "3335040"
  },
  {
    "text": "and there's only like so in as you have to do the attack before you've added two round keys",
    "start": "3335040",
    "end": "3340319"
  },
  {
    "text": "because when you've added two run keys that you have too much guessing to do",
    "start": "3340319",
    "end": "3345599"
  },
  {
    "text": "and then similarly if you attack with a known plaintext you need to attack during the last run before you've added",
    "start": "3345599",
    "end": "3350799"
  },
  {
    "text": "the second run key but yeah it works on other algorithms as",
    "start": "3350799",
    "end": "3356480"
  },
  {
    "text": "well and i didn't didn't say anything about",
    "start": "3356480",
    "end": "3362880"
  },
  {
    "text": "countermeasures because i only promised to show you how the attack works uh but i can say just a few words um",
    "start": "3362880",
    "end": "3370319"
  },
  {
    "text": "it's hard for software there is something called",
    "start": "3370319",
    "end": "3376720"
  },
  {
    "text": "bit sliced implementations i think there's something called bear ssl where maybe they do that",
    "start": "3376720",
    "end": "3383520"
  },
  {
    "text": "but it's very like it i think it works with only one bit from",
    "start": "3383520",
    "end": "3389440"
  },
  {
    "text": "each plaintext block at a time so if you're going to encrypt 128 plaintext blocks you can parallelize it",
    "start": "3389440",
    "end": "3396799"
  },
  {
    "text": "but yeah it it just divides it up so that what you do is completely different from this",
    "start": "3396799",
    "end": "3402960"
  },
  {
    "text": "there's also something called masking it explodes the implementation instead",
    "start": "3402960",
    "end": "3409119"
  },
  {
    "text": "of so each you take each bit of your secret and you",
    "start": "3409119",
    "end": "3414400"
  },
  {
    "text": "replace it with several bits and then you try to do the whole aes",
    "start": "3414400",
    "end": "3419760"
  },
  {
    "text": "uh and the the way you do this is that like so you have an algorithm for how to",
    "start": "3419760",
    "end": "3425280"
  },
  {
    "text": "replace one bit with several bits there is randomness but the final bit you add is like a",
    "start": "3425280",
    "end": "3431359"
  },
  {
    "text": "a checksum so you can get back to your original bit and then they figured out how",
    "start": "3431359",
    "end": "3438480"
  },
  {
    "text": "how to implement a nand gate for this data structure so that it works",
    "start": "3438480",
    "end": "3444400"
  },
  {
    "text": "and you can build everything from nand gates so in theory you can then build aes",
    "start": "3444400",
    "end": "3450240"
  },
  {
    "text": "and get your correct cipher text at the end but yeah it explodes this",
    "start": "3450240",
    "end": "3455599"
  },
  {
    "text": "they do implement this in very like high stakes things in software or in hardware",
    "start": "3455599",
    "end": "3462160"
  },
  {
    "text": "but it's not something you want to do if you just want to make your is a little bit more secure",
    "start": "3462160",
    "end": "3467838"
  },
  {
    "text": "you can also this is this is the tried and true military way make it hard to measure",
    "start": "3468079",
    "end": "3474640"
  },
  {
    "text": "take your chip pack it into a epoxy put something around it that if you pokes a hole in it it would",
    "start": "3474640",
    "end": "3480319"
  },
  {
    "text": "shortcut the whole thing put metal around it so you can't do like electromagnetic",
    "start": "3480319",
    "end": "3485680"
  },
  {
    "text": "and like do something to the cable so they won't leak this is also expensive",
    "start": "3485680",
    "end": "3493280"
  },
  {
    "text": "so basically all the solutions are expensive so my main",
    "start": "3493280",
    "end": "3498480"
  },
  {
    "text": "advice is to just think about where you actually need protection from",
    "start": "3498480",
    "end": "3503520"
  },
  {
    "text": "this and only applied protection where you need it and i think yeah as i said i think all",
    "start": "3503520",
    "end": "3509760"
  },
  {
    "text": "symmetric algorithms are vulnerable to this so um yeah don't give the equipment to the",
    "start": "3509760",
    "end": "3515599"
  },
  {
    "text": "people who want to master any more",
    "start": "3515599",
    "end": "3521280"
  },
  {
    "text": "questions okay thank you",
    "start": "3521280",
    "end": "3527580"
  },
  {
    "text": "[Applause]",
    "start": "3527580",
    "end": "3532610"
  },
  {
    "text": "you",
    "start": "3538960",
    "end": "3541040"
  }
]