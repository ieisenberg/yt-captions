[
  {
    "text": "all right let's start good evening and well actually thank you for showing up",
    "start": "4450",
    "end": "9590"
  },
  {
    "text": "and I I do appreciate that you prefer this session over the World Cup but I mean the game 40 minutes in just one",
    "start": "9590",
    "end": "16010"
  },
  {
    "text": "goal it's the snoozer so I think that's a much better use of your time here and of course this just replay as well so",
    "start": "16010",
    "end": "22759"
  },
  {
    "text": "yes thank you much for attending and you see it's been a great conference so far and well almost over just one day left",
    "start": "22759",
    "end": "29119"
  },
  {
    "text": "Plus this this slot my name is Christian and one of my topics of expertise is by",
    "start": "29119",
    "end": "36079"
  },
  {
    "text": "publication security and as such I am working with many customers to make",
    "start": "36079",
    "end": "44000"
  },
  {
    "text": "their web application secure sometimes very early in the process and sometimes very late and in that capacity I I see",
    "start": "44000",
    "end": "52010"
  },
  {
    "text": "you know the the same kind of successful attacks all over again but on the other",
    "start": "52010",
    "end": "57050"
  },
  {
    "text": "hand I also see that against very common attacks there are X and countermeasures no matter where I go for instance these",
    "start": "57050",
    "end": "63830"
  },
  {
    "text": "days it's really let's say hard to find sequel ejection right of course because",
    "start": "63830",
    "end": "69110"
  },
  {
    "text": "developers know all about sequel injection hopefully and on the other hand of course because the tools and the",
    "start": "69110",
    "end": "74960"
  },
  {
    "text": "frameworks make SQL injection really really hard on the other hand some attacks where I mean that they are they",
    "start": "74960",
    "end": "83090"
  },
  {
    "text": "may be a couple of years old but still there are not countermeasures everywhere or there are new twists to those attacks",
    "start": "83090",
    "end": "89840"
  },
  {
    "text": "where common countermeasures do not work so the idea behind this session is that I'll just show you some things that at",
    "start": "89840",
    "end": "96979"
  },
  {
    "text": "least in in my biased experience pop up more and more often we'll have a look at",
    "start": "96979",
    "end": "102620"
  },
  {
    "text": "it we see sometimes we'll see stuff that's actually pretty old but you know still works now maybe even better than",
    "start": "102620",
    "end": "109610"
  },
  {
    "text": "ever and maybe some stuff that's also relatively new and so I hope that even",
    "start": "109610",
    "end": "114830"
  },
  {
    "text": "though you may already know some of the attacks or risks I'm about to present you will be able to take something home",
    "start": "114830",
    "end": "121909"
  },
  {
    "text": "of you and get some inspiration and maybe also some some good fun no as I",
    "start": "121909",
    "end": "128450"
  },
  {
    "text": "said I try to talk about kind of trends and I think I'll start with a trend that",
    "start": "128450",
    "end": "135469"
  },
  {
    "text": "is I think to deck I'd like to start with cross-site scripting now probably you are thinking",
    "start": "135469",
    "end": "141860"
  },
  {
    "text": "wait a minute I I kind of signed up for the session because of trends and new stuff and then then he's showing me he",
    "start": "141860",
    "end": "147590"
  },
  {
    "text": "this this see if he details curve and if I go to the very left side of it I can",
    "start": "147590",
    "end": "153950"
  },
  {
    "text": "see well across the scripting popped up 1999-2000 that's that's actually correct",
    "start": "153950",
    "end": "160550"
  },
  {
    "text": "but on the other hand if you go to the right-hand side of that graph you'll see that last year was a record year for",
    "start": "160550",
    "end": "167030"
  },
  {
    "text": "cross-site scripting vulnerabilities at least in that zvd metric and considering that 2018 is almost 50% done if you",
    "start": "167030",
    "end": "176600"
  },
  {
    "text": "extrapolate that 2018 will be another record year for cross-site scripting and that I've had this really depressing",
    "start": "176600",
    "end": "183530"
  },
  {
    "text": "actually because it seems to me that cross-site scripting doesn't doesn't go away and I I don't understand it I mean",
    "start": "183530",
    "end": "190130"
  },
  {
    "text": "depending on the technology stack cross-site scripting is getting harder and harder so here at NBC I think the",
    "start": "190130",
    "end": "197690"
  },
  {
    "text": "technology most widely used according to the service from the previous years is the dotnet stack so if you're using",
    "start": "197690",
    "end": "203989"
  },
  {
    "text": "asp.net MVC right no matter if core or regular old MVC and you use the razor",
    "start": "203989",
    "end": "212950"
  },
  {
    "text": "new engine syntax that it's also possible to create cross-site scripting almost not completely but almost right",
    "start": "212950",
    "end": "219890"
  },
  {
    "text": "and so I kept wondering why why is that the case and also meet a lot of developers who are not really afraid of",
    "start": "219890",
    "end": "226160"
  },
  {
    "text": "cross-site scripting because I think you know cross-site scripting it's just alert one and well that there's no real",
    "start": "226160",
    "end": "232310"
  },
  {
    "text": "danger and threat going on from that so I thought about this for a while and then I remember that avez wants kind of",
    "start": "232310",
    "end": "240280"
  },
  {
    "text": "created three types of cross-site scripting so they segmented all cases",
    "start": "240280",
    "end": "245750"
  },
  {
    "text": "and vectors across the scripting into three buckets and most of the time I'm talking about cross-site scripting we",
    "start": "245750",
    "end": "251239"
  },
  {
    "text": "talked about type 1 cross-site scripting and persistent cross-site scripting it's a bit rarer but very very dangerous and",
    "start": "251239",
    "end": "258650"
  },
  {
    "text": "non persistent cross-site scripting which is very common and a little bit less dangerous but still and there's a",
    "start": "258650",
    "end": "264979"
  },
  {
    "text": "third one dom-based because with let's say regular cross-site scripting",
    "start": "264979",
    "end": "271490"
  },
  {
    "text": "there is involvement of the server with rhomboid numbers cross-site scripting everything happens in the client and now",
    "start": "271490",
    "end": "278750"
  },
  {
    "text": "it's getting interesting because if you look at the the schedule of the conference there's a lot of about spas",
    "start": "278750",
    "end": "284120"
  },
  {
    "text": "and then frameworks like angular and such where a lot of logic happens in the",
    "start": "284120",
    "end": "290599"
  },
  {
    "text": "browser and the browser's of the process in user input or something that could be manipulated for instance the hash",
    "start": "290599",
    "end": "296569"
  },
  {
    "text": "fragment of the URL and that's that's one of those crosses scripting areas",
    "start": "296569",
    "end": "302060"
  },
  {
    "text": "where where many people or many developers just do not think about the dangers involved now I would like to",
    "start": "302060",
    "end": "308630"
  },
  {
    "text": "show you an example which is quite common - something I've actually",
    "start": "308630",
    "end": "314120"
  },
  {
    "text": "recently found so and this is this is this is real-world stuff but of course I simplified it and kind of an anonymized",
    "start": "314120",
    "end": "320870"
  },
  {
    "text": "it where it's not technically it's not really time zero cross-site scripting",
    "start": "320870",
    "end": "326419"
  },
  {
    "text": "but it's pretty close because stuff happens on the client and we have to be super careful now I've extracted this",
    "start": "326419",
    "end": "331849"
  },
  {
    "text": "really simple let's say proof of concept so I'm using I'm using actually a",
    "start": "331849",
    "end": "339020"
  },
  {
    "text": "student at NBC for that example but I have another technology and later in this talk and as you may see I'm using B",
    "start": "339020",
    "end": "345320"
  },
  {
    "text": "and an older version of Visual Studio and at the old aspx view form engine it",
    "start": "345320",
    "end": "351889"
  },
  {
    "text": "doesn't change a bit about the attack but the the oldest take is important a bit later on today but this this would",
    "start": "351889",
    "end": "357889"
  },
  {
    "text": "happen with razor as well now what I'm doing here is I have something in the view back object so if you're not doing",
    "start": "357889",
    "end": "364819"
  },
  {
    "text": "and we see that's way of passing information from the controller to the review and I'm outputting it and I'm",
    "start": "364819",
    "end": "373159"
  },
  {
    "text": "using the colon syntax here and colon means HTML escape so basically what",
    "start": "373159",
    "end": "378469"
  },
  {
    "text": "happens here is that the value is run through HTTP utility dot HTML escape in",
    "start": "378469",
    "end": "384620"
  },
  {
    "text": "order to prevent cross-site scripting and now I'm doing some some fancy jQuery magic here by just writing the data I",
    "start": "384620",
    "end": "391610"
  },
  {
    "text": "get into the output field okay so really that that should be extremely sound and you know absolutely harmless furthermore",
    "start": "391610",
    "end": "399589"
  },
  {
    "text": "if you want to have a look at the at the action method",
    "start": "399589",
    "end": "404969"
  },
  {
    "text": "what I'm basically doing is I have a look at the query string parameter name",
    "start": "404969",
    "end": "410519"
  },
  {
    "text": "and if it exists I just you know put it in there which leads to the situation if",
    "start": "410519",
    "end": "416159"
  },
  {
    "text": "I call this page with no argument at the end I just get whatever unknown and if I",
    "start": "416159",
    "end": "422219"
  },
  {
    "text": "choose to do append something here so let's just say name equals Christian then hooray it says Christian okay great",
    "start": "422219",
    "end": "431699"
  },
  {
    "text": "great application and of course yeah yeah no it's a I said real world real world well actually um the application",
    "start": "431699",
    "end": "438869"
  },
  {
    "text": "was not too far for that actually so there was four elements in the URL which then appeared on the page think about",
    "start": "438869",
    "end": "445529"
  },
  {
    "text": "search and of course there's cross-site scripting protection right why is the",
    "start": "445529",
    "end": "452369"
  },
  {
    "text": "cross-site scripting protection well you know I could try to answer something like script alert one in here but what I",
    "start": "452369",
    "end": "462029"
  },
  {
    "text": "don't get is script alert one as verbatim text the reason of course being",
    "start": "462029",
    "end": "468959"
  },
  {
    "text": "a HTML escaping the output so if you look at the source code we see that the",
    "start": "468959",
    "end": "476099"
  },
  {
    "text": "HTML special characters in that case the opening angle opening closing angle brackets have been encoded right now the",
    "start": "476099",
    "end": "484079"
  },
  {
    "text": "first time you heard about encoding you probably heard encode according to the",
    "start": "484079",
    "end": "489449"
  },
  {
    "text": "context so we do HTML in code because we",
    "start": "489449",
    "end": "496399"
  },
  {
    "text": "expects that we use the data in HTML therefore we only escape special",
    "start": "496399",
    "end": "502409"
  },
  {
    "text": "characters there are special characters in HTML it sounds logical but let's have",
    "start": "502409",
    "end": "507959"
  },
  {
    "text": "a look at the at the source code again and if you look closely we see we are",
    "start": "507959",
    "end": "517529"
  },
  {
    "text": "not in an HTML context here we are in the JavaScript context and so main",
    "start": "517529",
    "end": "523229"
  },
  {
    "text": "developers domain let's just say some developers you know tend to use HTML",
    "start": "523229",
    "end": "530009"
  },
  {
    "text": "escape everywhere but are not limiting the usage of user input in an HTML",
    "start": "530009",
    "end": "536339"
  },
  {
    "text": "context now the problem is the of course in JavaScript we have",
    "start": "536339",
    "end": "542279"
  },
  {
    "text": "additional special characters not just the five special characters in in HTML we have more and since we are here in",
    "start": "542279",
    "end": "548700"
  },
  {
    "text": "the middle of a string of course the backslash comes to mind now if the backstage we could do a",
    "start": "548700",
    "end": "554370"
  },
  {
    "text": "couple of things in JavaScript we can do escaping we can have special control",
    "start": "554370",
    "end": "560820"
  },
  {
    "text": "characters and what we can also do is we can use character codes for some special",
    "start": "560820",
    "end": "569070"
  },
  {
    "text": "characters lect backslash X and then the hex character code now I have to admit my memory is",
    "start": "569070",
    "end": "575700"
  },
  {
    "text": "not very good so I can't remember any hex codes but my favorite website ASCII",
    "start": "575700",
    "end": "582750"
  },
  {
    "text": "table comm conveniently does so let's look for the angle brackets because",
    "start": "582750",
    "end": "587820"
  },
  {
    "text": "those were the ones that were escaped before right so opening and bracket is 3 C or closing",
    "start": "587820",
    "end": "593279"
  },
  {
    "text": "angle bracket is 3 e okay well then let's let's go back here let me try to",
    "start": "593279",
    "end": "600839"
  },
  {
    "text": "zoom in so that you can see this a little bit better okay so what did I say 3 C right and that is then 3 and that",
    "start": "600839",
    "end": "613470"
  },
  {
    "text": "should be 3 C and that should be 3 e",
    "start": "613470",
    "end": "620180"
  },
  {
    "text": "when you already see right now we have cross-site scripting now that's that's a",
    "start": "620180",
    "end": "626520"
  },
  {
    "text": "very triple problem so just remember always use context specific escaping you may have noticed I",
    "start": "626520",
    "end": "633690"
  },
  {
    "text": "am demoing this in Google Chrome and Google Chrome and all the other browsers except for Firefox that's why usually",
    "start": "633690",
    "end": "639300"
  },
  {
    "text": "like using Firefox in in presentations they have a built in cross-site scripting filter and that cross acceptor",
    "start": "639300",
    "end": "644790"
  },
  {
    "text": "filter has some heuristics right it's looking for input that then shows up on the page and you know looks for certain",
    "start": "644790",
    "end": "651780"
  },
  {
    "text": "patterns but that's not one of those certain tenants right because there is",
    "start": "651780",
    "end": "657839"
  },
  {
    "text": "no script tag there's just some some some funky encoding and that's what makes makes things so so utterly",
    "start": "657839",
    "end": "665430"
  },
  {
    "text": "dangerous and that's why I think cross-site scripting is still there now let me quickly",
    "start": "665430",
    "end": "672030"
  },
  {
    "text": "answer the the question I posed myself at the beginning of this talk why why",
    "start": "672030",
    "end": "677490"
  },
  {
    "text": "are people not afraid of of JavaScript and I think it's because of demonstrations like this right alert one",
    "start": "677490",
    "end": "682620"
  },
  {
    "text": "is embarrassing but there doesn't seem to be a threat and let me just really very very quickly and I'm aware that",
    "start": "682620",
    "end": "689310"
  },
  {
    "text": "that well practically all of you will know that but let's let me just reiterate it because it's it's so",
    "start": "689310",
    "end": "694980"
  },
  {
    "text": "important to me the reason that cross-site scripting is so dangerous is the same origin policy and a pretty aunt",
    "start": "694980",
    "end": "704220"
  },
  {
    "text": "from the unfortunate wording in my opinion so let's just imagine we have our website here on example.com port 80",
    "start": "704220",
    "end": "712010"
  },
  {
    "text": "HGPS a protocol and the same origin policy is this and I'm simplifying",
    "start": "712010",
    "end": "717330"
  },
  {
    "text": "things a bit here the JavaScript has access to everything on the same origin simplified I know and the origin is a",
    "start": "717330",
    "end": "723750"
  },
  {
    "text": "term that's been standardized by IETF which means scheme protocol fully",
    "start": "723750",
    "end": "730380"
  },
  {
    "text": "qualified domain name and port they have to match I hate the word written I",
    "start": "730380",
    "end": "735480"
  },
  {
    "text": "really do because it's misleading let me show you why so imagine on that page we",
    "start": "735480",
    "end": "740550"
  },
  {
    "text": "have like three blocks of three parts of JavaScript top left inline JavaScript",
    "start": "740550",
    "end": "746910"
  },
  {
    "text": "what is the origin of that inline JavaScript yeah obviously it's HTP",
    "start": "746910",
    "end": "751980"
  },
  {
    "text": "example.com port 80 I do then a script SRC reference to the file script ojs on",
    "start": "751980",
    "end": "758880"
  },
  {
    "text": "my server what is the origin of that file well happens to be HTTP example at",
    "start": "758880",
    "end": "763980"
  },
  {
    "text": "comport 80 and finally I'm using a JavaScript library I was using in jQuery",
    "start": "763980",
    "end": "769410"
  },
  {
    "text": "here just because I've just been using jQuery in my example and I'm loading",
    "start": "769410",
    "end": "774720"
  },
  {
    "text": "this from a CDN now what is the origin of that javascript file and you know",
    "start": "774720",
    "end": "779790"
  },
  {
    "text": "when you think about the region kind of where does something come from the intuitive answer would be err code",
    "start": "779790",
    "end": "786150"
  },
  {
    "text": "jQuery calm but of course that's wrong because if the origin in the concepts of",
    "start": "786150",
    "end": "794670"
  },
  {
    "text": "same return policy of that javascript file was Cotto jQuery Chrome it would not have access to any of the Dom",
    "start": "794670",
    "end": "801240"
  },
  {
    "text": "elements on my page example.com right same origin policy prevents that therefore the origin of that file is",
    "start": "801240",
    "end": "808770"
  },
  {
    "text": "also HTTP example.com port 80 I've had this utterly confusing so I",
    "start": "808770",
    "end": "814380"
  },
  {
    "text": "like talking about the security context in which something runs but then of",
    "start": "814380",
    "end": "820020"
  },
  {
    "text": "course means if you have cross-site scripting some injects either inline code or references a JavaScript file",
    "start": "820020",
    "end": "828590"
  },
  {
    "text": "residing on another server that file has the origin in the security context of",
    "start": "828590",
    "end": "833940"
  },
  {
    "text": "your website so it can do anything our JavaScript files on our server can do",
    "start": "833940",
    "end": "839280"
  },
  {
    "text": "and that's what makes cross-site scripting so extremely dangerous and that's what what many people do not do",
    "start": "839280",
    "end": "846600"
  },
  {
    "text": "not really consider now if you know we start on a green field in my opinion and",
    "start": "846600",
    "end": "853170"
  },
  {
    "text": "we have a modern application modern stack then cross-site scripting should be dead by now it should really be dead",
    "start": "853170",
    "end": "859920"
  },
  {
    "text": "because of one very simple thing content security policy a w3c standard which",
    "start": "859920",
    "end": "867530"
  },
  {
    "text": "uses an HTTP header that the server sends to the client and the client then limits what it loads and what it",
    "start": "867530",
    "end": "875790"
  },
  {
    "text": "executes so for instance you can tell the browser with this whenever you load",
    "start": "875790",
    "end": "881670"
  },
  {
    "text": "something images style sheets fonts JavaScript files only load them from the",
    "start": "881670",
    "end": "887520"
  },
  {
    "text": "current origin the single quote self here means means the current origin right and it's pretty interesting so now",
    "start": "887520",
    "end": "896190"
  },
  {
    "text": "if let's just assume we have across the scripting vulnerability on our site or",
    "start": "896190",
    "end": "901830"
  },
  {
    "text": "on our page in that regards but we have a content security policy like this in",
    "start": "901830",
    "end": "907740"
  },
  {
    "text": "place the attacker cannot do script SRC equals HTTP bad server comm slash bad",
    "start": "907740",
    "end": "916050"
  },
  {
    "text": "script ojs because the the server where this file is on is not the current",
    "start": "916050",
    "end": "921930"
  },
  {
    "text": "server of the current page so the browser refuses to load it and of course to execute it what's the second attack",
    "start": "921930",
    "end": "928470"
  },
  {
    "text": "vector the second attack vector is script and then some bad code like alert one forgive me for using that once more",
    "start": "928470",
    "end": "934970"
  },
  {
    "text": "now one of the side effects or well side effect sounds like you don't want this one of the",
    "start": "934970",
    "end": "940619"
  },
  {
    "text": "intentional side-effects of content security policy is if you have a content security policy that takes care about",
    "start": "940619",
    "end": "946439"
  },
  {
    "text": "JavaScript and that one does then inline code will not work any longer so and I",
    "start": "946439",
    "end": "954480"
  },
  {
    "text": "mean this sounds like a very select like they're bad news right but let's just let's just put put these thoughts behind",
    "start": "954480",
    "end": "959579"
  },
  {
    "text": "us for for 15 seconds if the attacker",
    "start": "959579",
    "end": "964829"
  },
  {
    "text": "cannot load a Java Script fire from his server and if an attacker cannot run",
    "start": "964829",
    "end": "970199"
  },
  {
    "text": "inline code when we have across the script availability there's only one cross-site scripting vector remaining",
    "start": "970199",
    "end": "976769"
  },
  {
    "text": "and the cross-site script cross-site scripting vector remaining is of course script as our C equals that file dot J's",
    "start": "976769",
    "end": "983939"
  },
  {
    "text": "so yes if there is malicious code already on our web server and we have a cross-site scripting vulnerability yes",
    "start": "983939",
    "end": "989699"
  },
  {
    "text": "that code can be run and executed on the other hand if an attacker manages to",
    "start": "989699",
    "end": "995939"
  },
  {
    "text": "upload bad JavaScript code to our server cross-site scripting would be the least",
    "start": "995939",
    "end": "1000949"
  },
  {
    "text": "of my problem if I were you so that's really a very effective effective",
    "start": "1000949",
    "end": "1006499"
  },
  {
    "text": "mechanism now I I have a a page here for",
    "start": "1006499",
    "end": "1014149"
  },
  {
    "text": "you and just want to briefly show you the the downside of that and why",
    "start": "1014149",
    "end": "1020679"
  },
  {
    "text": "cross-site scripting there still might be a relevant problem so this is another",
    "start": "1020679",
    "end": "1027110"
  },
  {
    "text": "very complex app and I've prepared and it shows the logo of the organizer and I",
    "start": "1027110",
    "end": "1036470"
  },
  {
    "text": "was using an image so the if you go to the NDC Oslo website that's an image logo it's a text logo but program with",
    "start": "1036470",
    "end": "1042798"
  },
  {
    "text": "weakling the company test is running this they have this logo and I get the current time now the code used to",
    "start": "1042799",
    "end": "1051110"
  },
  {
    "text": "achieve this effect as well also kind of kind of simplistic so I've stolen the",
    "start": "1051110",
    "end": "1057169"
  },
  {
    "text": "logo from the website so that I don't have to pay for hosting and bandwidth",
    "start": "1057169",
    "end": "1062240"
  },
  {
    "text": "and then I have here a development that does doesn't output then I'm using the",
    "start": "1062240",
    "end": "1068750"
  },
  {
    "text": "underscore JavaScript library in order who have a templating language and",
    "start": "1068750",
    "end": "1074869"
  },
  {
    "text": "templating mechanism and then I'm running this fantastic JavaScript code that we reach the server every thousand",
    "start": "1074869",
    "end": "1081769"
  },
  {
    "text": "milliseconds for the current time because you know I work in security so I can't rely on the client time I have to",
    "start": "1081769",
    "end": "1087830"
  },
  {
    "text": "rely on the server time and in the in the Java scripts file here well I",
    "start": "1087830",
    "end": "1095720"
  },
  {
    "text": "basically set up this template here and whenever I get the current time back",
    "start": "1095720",
    "end": "1100850"
  },
  {
    "text": "from the server I applied a template and therefore the time is updated every 1000 milliseconds and the problem here is if",
    "start": "1100850",
    "end": "1109159"
  },
  {
    "text": "I if I run this but in order to be more",
    "start": "1109159",
    "end": "1115759"
  },
  {
    "text": "secure I use a content security policy for instance the one we saw on the slides then well some things might might",
    "start": "1115759",
    "end": "1127460"
  },
  {
    "text": "change and let's put it that way enough not to the better I'm reloading and yeah",
    "start": "1127460",
    "end": "1134119"
  },
  {
    "text": "so the time is gone the beautiful logo is gone and the font is smaller even the background color is gone and the problem",
    "start": "1134119",
    "end": "1141619"
  },
  {
    "text": "is I run into several issues by applying that content security policy on that of course country the example here I'm",
    "start": "1141619",
    "end": "1149330"
  },
  {
    "text": "loading an image from a remote server the remote service not part of my policy so I have to look for all the places",
    "start": "1149330",
    "end": "1156259"
  },
  {
    "text": "where I load remote images remote forms web fonts for instance what about",
    "start": "1156259",
    "end": "1161330"
  },
  {
    "text": "tracking scripts etc Bitcoin - I put on my website I have no idea and have to",
    "start": "1161330",
    "end": "1167179"
  },
  {
    "text": "put them in the core security policy inline stars are gone as well I talked",
    "start": "1167179",
    "end": "1174649"
  },
  {
    "text": "about inline JavaScript but that applies to inline styles as well then I have",
    "start": "1174649",
    "end": "1179749"
  },
  {
    "text": "here set interval and then I'm using a string as an argument this is the same",
    "start": "1179749",
    "end": "1185809"
  },
  {
    "text": "category as new function and eval by default eval and friends are also",
    "start": "1185809",
    "end": "1194059"
  },
  {
    "text": "deactivated by having a content security policy so I need to refactor that well then it's inline code of course I would",
    "start": "1194059",
    "end": "1200539"
  },
  {
    "text": "need to move it into an external file and if I do all this right so I react",
    "start": "1200539",
    "end": "1205940"
  },
  {
    "text": "I turn the string and anonymous function I move the inline code into an external",
    "start": "1205940",
    "end": "1211010"
  },
  {
    "text": "javascript file I turned the inline Styles into classes",
    "start": "1211010",
    "end": "1216290"
  },
  {
    "text": "and then linked to a stylesheet the application would still not work why",
    "start": "1216290",
    "end": "1221840"
  },
  {
    "text": "would the application is still not work because underscore don't get me wrong",
    "start": "1221840",
    "end": "1227600"
  },
  {
    "text": "I'm not dissing DD underscore JavaScript library not not at all I was just using it as an example but the underscore",
    "start": "1227600",
    "end": "1234440"
  },
  {
    "text": "library has many others as well they are using eval in order to run their",
    "start": "1234440",
    "end": "1240380"
  },
  {
    "text": "templates technically they're using new function but you know it's it's the same thing so I would either get need to get",
    "start": "1240380",
    "end": "1248060"
  },
  {
    "text": "rid of that library or I have to disable the protection for dynamic code",
    "start": "1248060",
    "end": "1253580"
  },
  {
    "text": "evaluation in content security policy well I can do that and outside the attack surface doesn't get much larger",
    "start": "1253580",
    "end": "1259400"
  },
  {
    "text": "by that what I could also do because I'm lazy is I could deactivate the inline",
    "start": "1259400",
    "end": "1265970"
  },
  {
    "text": "code execution protection but if you do that you have and you have a cross a scripting vulnerability all your",
    "start": "1265970",
    "end": "1271220"
  },
  {
    "text": "protection is gone immediately right I could I could talk about this on and on for four hours but I just want to show",
    "start": "1271220",
    "end": "1279800"
  },
  {
    "text": "you yes there there is a solution for for many crosses scripting scenarios if",
    "start": "1279800",
    "end": "1284960"
  },
  {
    "text": "you have a Greenfield application for practically all cross-site scripting scenarios if you have a legacy app there",
    "start": "1284960",
    "end": "1291380"
  },
  {
    "text": "might be work involved and that techniques and approaches how you can do that but it doesn't come for free",
    "start": "1291380",
    "end": "1296710"
  },
  {
    "text": "especially for legacy applications just think about maybe maybe some of you have done a student-led web forms in the past",
    "start": "1296710",
    "end": "1303320"
  },
  {
    "text": "and you know asp.net webforms mean it means two things one thing is a lot of",
    "start": "1303320",
    "end": "1309830"
  },
  {
    "text": "inline styles and a lot of inline javascript code right so all of these would cease to run so we would need to",
    "start": "1309830",
    "end": "1315830"
  },
  {
    "text": "find ways around it there are those ways but I just wanted to tell you that well",
    "start": "1315830",
    "end": "1321380"
  },
  {
    "text": "these were our classical web applications but since we have had a",
    "start": "1321380",
    "end": "1326510"
  },
  {
    "text": "look at templates mmm another topic that I see popping up quite often this",
    "start": "1326510",
    "end": "1332300"
  },
  {
    "text": "template injection I mean no matter what kind of client-side framework you're",
    "start": "1332300",
    "end": "1337760"
  },
  {
    "text": "using there's always a kind of a temple in the template you can do some data binding and sometimes you do not just",
    "start": "1337760",
    "end": "1342950"
  },
  {
    "text": "bind values but maybe some more complex constructs as well and one of the things",
    "start": "1342950",
    "end": "1350780"
  },
  {
    "text": "I would like to look at now is angularjs please note angularjs I'm not talking",
    "start": "1350780",
    "end": "1357170"
  },
  {
    "text": "about angular 2 or higher because they changed the mechanism so things and I'm",
    "start": "1357170",
    "end": "1362420"
  },
  {
    "text": "showing you they they do not work exactly as that essentially there were",
    "start": "1362420",
    "end": "1367550"
  },
  {
    "text": "fixed because they're using a different approach but I think the approach from angular 1 which I mean still on the",
    "start": "1367550",
    "end": "1373580"
  },
  {
    "text": "support right it's a quite interesting one so we we have expression binding in",
    "start": "1373580",
    "end": "1380870"
  },
  {
    "text": "angularjs right and the angular team",
    "start": "1380870",
    "end": "1386030"
  },
  {
    "text": "implemented a sandbox so when you have to use those expressions they are not always just Ronde I just you know converted into code if if possible",
    "start": "1386030",
    "end": "1393500"
  },
  {
    "text": "internally so if you just have binding syntax double curly braces 1 + 2 and then that that's turned into a named",
    "start": "1393500",
    "end": "1400610"
  },
  {
    "text": "function like like this here shown on the slides and that was I like a cat",
    "start": "1400610",
    "end": "1406520"
  },
  {
    "text": "cat-and-mouse game between the angularjs team and various security researchers because they the research has always",
    "start": "1406520",
    "end": "1413960"
  },
  {
    "text": "found new holes in the sandbox and then the angular team closed them and then they found new holes in the syntax and",
    "start": "1413960",
    "end": "1419210"
  },
  {
    "text": "then the angular team closed them and in angular 1 6 the current release version",
    "start": "1419210",
    "end": "1424760"
  },
  {
    "text": "of angularjs they just removed the sandbox because they essentially said hey we will never be able to fix",
    "start": "1424760",
    "end": "1432200"
  },
  {
    "text": "everything and there will always be a new approach that we didn't think of before and B we found out by removing",
    "start": "1432200",
    "end": "1439190"
  },
  {
    "text": "the sandbox the performance went up I think 9 percent yeah for performance yeah good good point actually good point",
    "start": "1439190",
    "end": "1446270"
  },
  {
    "text": "actually actually let me let me show you real quick and if you interested seeing that so very simple example here as well",
    "start": "1446270",
    "end": "1455210"
  },
  {
    "text": "I'm loading the latest version of angularjs one it's one 610 directly from the CDN let's see how that works out and",
    "start": "1455210",
    "end": "1462200"
  },
  {
    "text": "then I output here something I also do HTML escaping because I'm super afraid",
    "start": "1462200",
    "end": "1468410"
  },
  {
    "text": "of cross-site scripting right and in my controller all I'm doing there",
    "start": "1468410",
    "end": "1475980"
  },
  {
    "text": "is I'm taking the in that case the parameter called Q and well then then I",
    "start": "1475980",
    "end": "1484110"
  },
  {
    "text": "output it I don't have called a security policy even if I did for angularjs I",
    "start": "1484110",
    "end": "1489810"
  },
  {
    "text": "would need to enable eval so it's it's a bit of a let's say complicated story now",
    "start": "1489810",
    "end": "1496310"
  },
  {
    "text": "if you have a look at that in the browser let's just see if it loads thing",
    "start": "1496310",
    "end": "1509190"
  },
  {
    "text": "all right from the server mmhmm yeah okay so perfect I get the output right",
    "start": "1509190",
    "end": "1517230"
  },
  {
    "text": "here amazing now what I can of course do is I can and that's that's the main",
    "start": "1517230",
    "end": "1522390"
  },
  {
    "text": "problem here once again I have additional special characters I'm in the",
    "start": "1522390",
    "end": "1527610"
  },
  {
    "text": "HTML context but since this is an angular page the curly braces suddenly",
    "start": "1527610",
    "end": "1534690"
  },
  {
    "text": "are special characters right so I could do data binding I could try something",
    "start": "1534690",
    "end": "1540600"
  },
  {
    "text": "like one plus two but on the other hand one plus two is a bit boring what I'm",
    "start": "1540600",
    "end": "1547890"
  },
  {
    "text": "doing instead is depending on what I put in here and since there's no damn",
    "start": "1547890",
    "end": "1553260"
  },
  {
    "text": "sandbox anymore I just have to find a way to execute code and so someone found",
    "start": "1553260",
    "end": "1558330"
  },
  {
    "text": "out that if I do constructor dot constructor I am on the level of",
    "start": "1558330",
    "end": "1565410"
  },
  {
    "text": "function so this is a function constructor so I can do alert or let's say L or two just to show how very",
    "start": "1565410",
    "end": "1572010"
  },
  {
    "text": "decent and then I execute this immediately and now I have cross-site",
    "start": "1572010",
    "end": "1577620"
  },
  {
    "text": "scripting again right although I had HTML escaping so once again remember the",
    "start": "1577620",
    "end": "1585060"
  },
  {
    "text": "context when doing the escaping otherwise you you will run into into",
    "start": "1585060",
    "end": "1592170"
  },
  {
    "text": "issues because cross-site scripting just you know it could die but it it doesn't",
    "start": "1592170",
    "end": "1598290"
  },
  {
    "text": "know that coming back to content security policy one more time of course if you have a template engine if",
    "start": "1598290",
    "end": "1604690"
  },
  {
    "text": "you have client-side framework MVC MV whatever you have to check whether it's",
    "start": "1604690",
    "end": "1610150"
  },
  {
    "text": "compliant with content security policy I was once at the customer sided they were using Apache wicked and I've never seen",
    "start": "1610150",
    "end": "1618400"
  },
  {
    "text": "this before and I've never seen this this ever again because that that framework or at least how they were",
    "start": "1618400",
    "end": "1623500"
  },
  {
    "text": "using it it's just outputting inline JavaScript all over the place so the whole page is set up by blocks of inline",
    "start": "1623500",
    "end": "1629980"
  },
  {
    "text": "JavaScript and there was like n1 entry in the back tracker and yeah how about",
    "start": "1629980",
    "end": "1637330"
  },
  {
    "text": "we make this content security policy compliant yeah no one is using content security policy that was the the reason",
    "start": "1637330",
    "end": "1644170"
  },
  {
    "text": "a ticket closed and there there's some truth to that what the security policy especially if you have not always used best practices",
    "start": "1644170",
    "end": "1650830"
  },
  {
    "text": "if you have used inline Styles inline JavaScript then it it is it takes some",
    "start": "1650830",
    "end": "1656890"
  },
  {
    "text": "effort to to implement it alright next topic is the new number four in the over",
    "start": "1656890",
    "end": "1664270"
  },
  {
    "text": "top 10 2017 the first time it ever shows up in that list it's XML external entities and this kind",
    "start": "1664270",
    "end": "1675310"
  },
  {
    "text": "of I met Mindy the idea behind it attack is very older but in the web it kind of showed up about four years ago and the",
    "start": "1675310",
    "end": "1685540"
  },
  {
    "text": "idea here is is that actually let me let",
    "start": "1685540",
    "end": "1690990"
  },
  {
    "text": "me let me first tell the idea so we have an XML file and in that XML file we can",
    "start": "1690990",
    "end": "1697900"
  },
  {
    "text": "have entities right we know entities from HTML like ampersand LT semicolon",
    "start": "1697900",
    "end": "1703630"
  },
  {
    "text": "for the opening angle bracket no browser knows what that entity means and then",
    "start": "1703630",
    "end": "1709030"
  },
  {
    "text": "you know handles it accordingly what we can do in XML though is we can use",
    "start": "1709030",
    "end": "1714910"
  },
  {
    "text": "entities and then we can add the information in the XML file what this",
    "start": "1714910",
    "end": "1723430"
  },
  {
    "text": "entity means what it resolves to and this can lead to quite interesting",
    "start": "1723430",
    "end": "1728490"
  },
  {
    "text": "interesting aspects now let me show you let me show this",
    "start": "1728490",
    "end": "1735480"
  },
  {
    "text": "okay I don't see anything you can't see anything either",
    "start": "1735799",
    "end": "1741769"
  },
  {
    "text": "that's my window ah okay there we are so",
    "start": "1741830",
    "end": "1750020"
  },
  {
    "text": "this is an XML file and we just assume",
    "start": "1750020",
    "end": "1755370"
  },
  {
    "text": "we have a HTTP endpoint that accepts XML it could also be you know an import that",
    "start": "1755370",
    "end": "1763049"
  },
  {
    "text": "runs every nine and this XML comes from another service but somehow the attacker can control the XML and the web",
    "start": "1763049",
    "end": "1768840"
  },
  {
    "text": "applications processing the XML and again I simplified the it a little bit so that I can show directly in code now",
    "start": "1768840",
    "end": "1775620"
  },
  {
    "text": "so that's the XML file and the XML file contains one element called attack which",
    "start": "1775620",
    "end": "1782010"
  },
  {
    "text": "doesn't attack anything but within that element we have a new entity XX e XX e",
    "start": "1782010",
    "end": "1789270"
  },
  {
    "text": "is nothing that the the file is that XML",
    "start": "1789270",
    "end": "1795870"
  },
  {
    "text": "knows however conveniently in the same file I explained the XML parser but xx",
    "start": "1795870",
    "end": "1801630"
  },
  {
    "text": "see what kind of entity it is it's a system entity and it points to a local",
    "start": "1801630",
    "end": "1806880"
  },
  {
    "text": "file local on the system on which the XML parsing runs means when a web server",
    "start": "1806880",
    "end": "1814110"
  },
  {
    "text": "parses and processes that file that is a local path on the web server so we are",
    "start": "1814110",
    "end": "1821070"
  },
  {
    "text": "loading here a file actually let's not use the ID and PHP file let's use a text",
    "start": "1821070",
    "end": "1826230"
  },
  {
    "text": "file here and this is how the text file looks like and again editorial would simplify things of it so this is my",
    "start": "1826230",
    "end": "1832200"
  },
  {
    "text": "password database I'm using for all my projects right and well basically this",
    "start": "1832200",
    "end": "1838020"
  },
  {
    "text": "just shows there is an XML file or there's any file on the file system well",
    "start": "1838020",
    "end": "1843720"
  },
  {
    "text": "and here's the code that does the dusta parsing so i but my java days I wouldn't",
    "start": "1843720",
    "end": "1852360"
  },
  {
    "text": "say long gone but well they are gone essentially I haven't done joy in a while but I just used the spring MVC",
    "start": "1852360",
    "end": "1858690"
  },
  {
    "text": "demo application here interests add in an endpoint for XML parsing so I create",
    "start": "1858690",
    "end": "1865350"
  },
  {
    "text": "an XML Reader and then I create an XML handle um about that later and yeah then I read in",
    "start": "1865350",
    "end": "1872170"
  },
  {
    "text": "the file I just read it directly from the from the file system but of course usually that file would arrive let's say",
    "start": "1872170",
    "end": "1877510"
  },
  {
    "text": "by a post or that data would arrive by a post and then I do the parsing and then I just return the output of the parser",
    "start": "1877510",
    "end": "1884920"
  },
  {
    "text": "now the parser is something I kind of wrote myself so I'm using the SI X parsing approach of course but in my",
    "start": "1884920",
    "end": "1892240"
  },
  {
    "text": "handler I'm doing really kind of boring stuff it's like si X parsing in any language so I have kind of events for start of",
    "start": "1892240",
    "end": "1899230"
  },
  {
    "text": "element end of element characters in an element and I'm essentially outputting it and I'm indenting it a little bit so",
    "start": "1899230",
    "end": "1905500"
  },
  {
    "text": "really really boring stuff right so really nothing nothing nothing special and similar in in each and every",
    "start": "1905500",
    "end": "1912520"
  },
  {
    "text": "technology now what happens if I run this remember in the parsing phase what",
    "start": "1912520",
    "end": "1921429"
  },
  {
    "text": "we're doing is we look at the file and you know when there is a new elements then we just say Oh new new elements XYZ",
    "start": "1921429",
    "end": "1929470"
  },
  {
    "text": "and if there's text in the element we say I found some characters ABC and if",
    "start": "1929470",
    "end": "1936900"
  },
  {
    "text": "we if we do that actually let me go here then let's use the URL xx e and that's",
    "start": "1936900",
    "end": "1946510"
  },
  {
    "text": "the output right so now the XML parser",
    "start": "1946510",
    "end": "1951940"
  },
  {
    "text": "has resolved that external entity and",
    "start": "1951940",
    "end": "1958140"
  },
  {
    "text": "therefore passed the local file that was referenced in the XML that I can control",
    "start": "1958140",
    "end": "1963370"
  },
  {
    "text": "in that scenario and that's kind of shocking here and of course I was I was",
    "start": "1963370",
    "end": "1968679"
  },
  {
    "text": "using the example with the stupid XML that contains a password just to show you you know there might be a file with valuable information but just imagine",
    "start": "1968679",
    "end": "1976179"
  },
  {
    "text": "maybe it wouldn't be an XML file with a password but maybe you know the XML file",
    "start": "1976179",
    "end": "1983080"
  },
  {
    "text": "web config where you have maybe credentials for your database connection right I know their ways around that but",
    "start": "1983080",
    "end": "1990280"
  },
  {
    "text": "you get you get the picture right now as I said the attack is a couple of years old and when I heard it back there and I",
    "start": "1990280",
    "end": "1997030"
  },
  {
    "text": "thought yeah you know XML isn't that this XML still alive I was",
    "start": "1997030",
    "end": "2002650"
  },
  {
    "text": "was kind of irritated I mean I'll be doing Jason now and I don't see I don't see the threat but then I understood",
    "start": "2002650",
    "end": "2009750"
  },
  {
    "text": "because I'm I'm biased so I've done lots of I've done a bit of Java earlier but",
    "start": "2009750",
    "end": "2015640"
  },
  {
    "text": "if they're lots of PHP and lots of asp.net but I shouldn't have left Java",
    "start": "2015640",
    "end": "2020950"
  },
  {
    "text": "probably because in Java many of the",
    "start": "2020950",
    "end": "2025990"
  },
  {
    "text": "built-in AP is a vulnerable so I'm using spring as MVC's implementation here and",
    "start": "2025990",
    "end": "2034530"
  },
  {
    "text": "well and actually I'm using the generic Java classes but wasn't springing me see there's a specific end point and that",
    "start": "2034530",
    "end": "2040180"
  },
  {
    "text": "end point was eventually patched in the.net space however and that's a table I took from the xxe prevention chichi",
    "start": "2040180",
    "end": "2047680"
  },
  {
    "text": "the OS provides all of these different XML API s and I mean given that I've",
    "start": "2047680",
    "end": "2053980"
  },
  {
    "text": "said that XML is kind of dead but net has a lot of XML api's and all of them",
    "start": "2053980",
    "end": "2059830"
  },
  {
    "text": "are safe by default the only three that were not safe by default are since dotnet version 5 a 4.5.2 so it didn't",
    "start": "2059830",
    "end": "2067870"
  },
  {
    "text": "invade for a major release to eventually fix that they fixed it in a minor release so that's pretty amazing so if",
    "start": "2067870",
    "end": "2076419"
  },
  {
    "text": "you're working with botnet probably that's something that doesn't you don't care about that much but just you know",
    "start": "2076419",
    "end": "2081730"
  },
  {
    "text": "always remember when you accept any piece of information have a close look at that and be careful when parsing now",
    "start": "2081730",
    "end": "2088330"
  },
  {
    "text": "just in case some that maybe you are working with Java and I just want to add how you can defend against that in my",
    "start": "2088330",
    "end": "2096580"
  },
  {
    "text": "specific scenario where I've used the SX parser that's the code that's required",
    "start": "2096580",
    "end": "2103450"
  },
  {
    "text": "here so we have to call the set feature API which I find pretty pretty amusing",
    "start": "2103450",
    "end": "2113200"
  },
  {
    "text": "name and then we have to provide the feature as a string yeah don't you don't",
    "start": "2113200",
    "end": "2120880"
  },
  {
    "text": "want to know it because I was not pasting this don't want to know how many tries it took me in order to not have",
    "start": "2120880",
    "end": "2126130"
  },
  {
    "text": "any typos in there and I was really wondering what didn't work and I have to set the future general external chances",
    "start": "2126130",
    "end": "2133540"
  },
  {
    "text": "I have to set it to false because it defaults to true and they don't to change it and I mean I understand",
    "start": "2133540",
    "end": "2140200"
  },
  {
    "text": "that backwards compatibility is it's crucial but on the other hand secure",
    "start": "2140200",
    "end": "2147010"
  },
  {
    "text": "defaults should be crucial as well and I think in the oldest gdpr craze I had to",
    "start": "2147010",
    "end": "2155680"
  },
  {
    "text": "sign so many things you know probably many of you too and I often had also to to sign yeah we using we're using secure",
    "start": "2155680",
    "end": "2162490"
  },
  {
    "text": "defaults and yeah that's exactly what what it is so after that change that Stratus really quick after reloading it",
    "start": "2162490",
    "end": "2170080"
  },
  {
    "text": "then it's not resolving the external entity any longer problem solved now depending on the stack and that's",
    "start": "2170080",
    "end": "2177940"
  },
  {
    "text": "that's what I mentioned depending on the stack maybe that is there's super important for you and super critical but",
    "start": "2177940",
    "end": "2186580"
  },
  {
    "text": "maybe you just don't need to care about because you have a stack where where",
    "start": "2186580",
    "end": "2193030"
  },
  {
    "text": "you're protected from that but let me just finish finish my thoughts about xxe by mentioning another kind of kind of",
    "start": "2193030",
    "end": "2201070"
  },
  {
    "text": "hybrid and that hybrid is server side request forgery no assume you don't know",
    "start": "2201070",
    "end": "2207130"
  },
  {
    "text": "what cross-site request forgery is right so the a malicious server and somehow",
    "start": "2207130",
    "end": "2214660"
  },
  {
    "text": "prompts a clients to send a request to another server that changes something",
    "start": "2214660",
    "end": "2220060"
  },
  {
    "text": "simply put now so that request forgery kinda lets a server or a machine a",
    "start": "2220060",
    "end": "2226980"
  },
  {
    "text": "server do an HTTP request to another system let's just imagine okay so I am",
    "start": "2226980",
    "end": "2233920"
  },
  {
    "text": "an attacker and I contact a website I sent the website may be malicious XML as we've seen before and instead of",
    "start": "2233920",
    "end": "2240910"
  },
  {
    "text": "pointing to a local file I'm now pointing to a URL and of course the",
    "start": "2240910",
    "end": "2246400"
  },
  {
    "text": "system is configured such that the external entity is parsed so the server",
    "start": "2246400",
    "end": "2253810"
  },
  {
    "text": "I'm attacking is sending a request to another server or to another web site",
    "start": "2253810",
    "end": "2258840"
  },
  {
    "text": "let's imagine that the the server on the right hand side is an internal server",
    "start": "2258840",
    "end": "2264700"
  },
  {
    "text": "that's not accessible from the outside however the server in the middle is and I want to do",
    "start": "2264700",
    "end": "2270460"
  },
  {
    "text": "or want to send a specific let's say just get requests to that internal system because I know there is a",
    "start": "2270460",
    "end": "2277119"
  },
  {
    "text": "weakness so that approach could be used to actually abuse this situation a lot",
    "start": "2277119",
    "end": "2285279"
  },
  {
    "text": "of people I'm really crazy about service request forgery personally I'm not super sure because",
    "start": "2285279",
    "end": "2290799"
  },
  {
    "text": "you have to know a lot about the internal system because not only do you need and security of ability that allows",
    "start": "2290799",
    "end": "2298029"
  },
  {
    "text": "you to make a service and an HP request to another server but you also need a",
    "start": "2298029",
    "end": "2303700"
  },
  {
    "text": "target server in the ends that well you know at accepts an HTP request then those crazy things when you have to know",
    "start": "2303700",
    "end": "2309190"
  },
  {
    "text": "exactly how the URL is etc right so this might be a bit exotic in some cases but",
    "start": "2309190",
    "end": "2316390"
  },
  {
    "text": "still I wanted to mention that so super important when you are using a technology stack where external XML",
    "start": "2316390",
    "end": "2323289"
  },
  {
    "text": "entities are automatically parsed then reconfigure your stack all right next up",
    "start": "2323289",
    "end": "2331839"
  },
  {
    "text": "and that's also in addition to the over stop 10 2017 it also again something",
    "start": "2331839",
    "end": "2337180"
  },
  {
    "text": "that is specific to a certain stack is in security serialization so we often",
    "start": "2337180",
    "end": "2344289"
  },
  {
    "text": "get data as let's say string write in an HTTP context and that string is in a",
    "start": "2344289",
    "end": "2351940"
  },
  {
    "text": "specific format let's say JSON or something else and then it's deserialized",
    "start": "2351940",
    "end": "2357130"
  },
  {
    "text": "and on the server it's quite off the case write that we have a proper language and we want an object of that",
    "start": "2357130",
    "end": "2363819"
  },
  {
    "text": "proper language or a specific types we just easier lies it in a tight and there",
    "start": "2363819",
    "end": "2369670"
  },
  {
    "text": "have been numerous examples over the years where some technologies had built-in types that were generally",
    "start": "2369670",
    "end": "2375940"
  },
  {
    "text": "available and if you digitalize and that type the constructor of the type does something what we maybe do not want",
    "start": "2375940",
    "end": "2381640"
  },
  {
    "text": "right and so these DC realizations might go horribly wrong it's rather uncommon in the.net stack",
    "start": "2381640",
    "end": "2389380"
  },
  {
    "text": "that something happens because of the libraries let's just say JSON Nets they are now at least now secure by default",
    "start": "2389380",
    "end": "2395200"
  },
  {
    "text": "so we have to miss configure them that they are not any longer but just if you are interested in there that's why I put",
    "start": "2395200",
    "end": "2401230"
  },
  {
    "text": "it up here is there's a pretty nice and from a while back on the botnet space",
    "start": "2401230",
    "end": "2407170"
  },
  {
    "text": "and if you're interested in other technologies there is in again a cheat sheet from Avast and my personal",
    "start": "2407170",
    "end": "2414790"
  },
  {
    "text": "highlight here is a project on github that's a payload generator now actually I have this open here and what this",
    "start": "2414790",
    "end": "2426610"
  },
  {
    "text": "basically does is you just try to",
    "start": "2426610",
    "end": "2432100"
  },
  {
    "text": "demonstrate how this deserialization can be used to run code and then you can",
    "start": "2432100",
    "end": "2437350"
  },
  {
    "text": "choose from a couple of for matters and object data provided including Jason or",
    "start": "2437350",
    "end": "2443050"
  },
  {
    "text": "net but again configured so that it's insecure so not a default configuration and I've prepared a simple course or I'm",
    "start": "2443050",
    "end": "2452320"
  },
  {
    "text": "using the JSON dotnet formatter and the object data provider and I would like to run calc right I don't like to run the",
    "start": "2452320",
    "end": "2458140"
  },
  {
    "text": "calculator and so if I run this it sets",
    "start": "2458140",
    "end": "2464230"
  },
  {
    "text": "data to the system and bam I've started the calculator right just by giving the",
    "start": "2464230",
    "end": "2470590"
  },
  {
    "text": "system something to deserialize actually we see that here in the background and that dizzier Eliza was running this so",
    "start": "2470590",
    "end": "2477040"
  },
  {
    "text": "yes this is a threat because we are talking about code execution something that we thought would be impossible when",
    "start": "2477040",
    "end": "2482410"
  },
  {
    "text": "using a proper technology on the server but yeah it is possible if we do not",
    "start": "2482410",
    "end": "2487660"
  },
  {
    "text": "have secure defaults yet still does this on the I don't even know number number",
    "start": "2487660",
    "end": "2494650"
  },
  {
    "text": "six or seven spots in the over top ten 2017 before cross-site scripting I'm not",
    "start": "2494650",
    "end": "2499690"
  },
  {
    "text": "so sure about that but still that's something that I see happening quite",
    "start": "2499690",
    "end": "2505390"
  },
  {
    "text": "quite a bit alright again depending on the stack no how about some oldie but",
    "start": "2505390",
    "end": "2512980"
  },
  {
    "text": "Goldie and I think it's so interesting that I I definitely wanted to show you",
    "start": "2512980",
    "end": "2518110"
  },
  {
    "text": "that so some of you may have seen this before this is a legendary issue on github and you know when you open an",
    "start": "2518110",
    "end": "2525010"
  },
  {
    "text": "issue on github then you get something like open this issue a few seconds ago",
    "start": "2525010",
    "end": "2530530"
  },
  {
    "text": "open this issue a month ago in that case however that issue was opened once",
    "start": "2530530",
    "end": "2537520"
  },
  {
    "text": "and one years in the future that's interesting so how did that happen now github is using live Ruby on Rails but",
    "start": "2537520",
    "end": "2544840"
  },
  {
    "text": "I've kind of replicated this because it's more less technology independent",
    "start": "2544840",
    "end": "2549970"
  },
  {
    "text": "and what I've done is I have replicated this using this visual studio version",
    "start": "2549970",
    "end": "2555640"
  },
  {
    "text": "and the the built in wizard to create",
    "start": "2555640",
    "end": "2561340"
  },
  {
    "text": "corrupt views and classes controller classes okay and then I've cut a little",
    "start": "2561340",
    "end": "2568540"
  },
  {
    "text": "bit out of it so my my model is very simple I've I've used blog and three as a model but it's just like you know",
    "start": "2568540",
    "end": "2574330"
  },
  {
    "text": "having a ticket or issue and I have well",
    "start": "2574330",
    "end": "2579400"
  },
  {
    "text": "one property for entity framework but then I have public properties title text and date and of course the date should",
    "start": "2579400",
    "end": "2586180"
  },
  {
    "text": "be set automatically so that's exactly what happens here in the constructor",
    "start": "2586180",
    "end": "2591990"
  },
  {
    "text": "well and then of course I have a I have",
    "start": "2591990",
    "end": "2598450"
  },
  {
    "text": "a view and you know I just let wishes to recreate the view and the view has you",
    "start": "2598450",
    "end": "2603700"
  },
  {
    "text": "know text title and would also have the date but I don't need the date right so I commented it out because I don't need",
    "start": "2603700",
    "end": "2610090"
  },
  {
    "text": "it okay yeah when I click on create and on the server and the framework creates a new blog entry instance and well sets",
    "start": "2610090",
    "end": "2619900"
  },
  {
    "text": "the properties and saves it and actually we could have a look at that because it's using standard model binding right",
    "start": "2619900",
    "end": "2628090"
  },
  {
    "text": "so we automatically get something of type blog entry and then yeah we add it",
    "start": "2628090",
    "end": "2635410"
  },
  {
    "text": "easy as that probably we've we've seen things like this millions of times",
    "start": "2635410",
    "end": "2641800"
  },
  {
    "text": "because that's probably code we have well we have not written it was generated for us all right let's try",
    "start": "2641800",
    "end": "2647650"
  },
  {
    "text": "this out so title and the scene 2018",
    "start": "2647650",
    "end": "2655619"
  },
  {
    "text": "good evenin see if this this is working and yeah now I've created a new entry",
    "start": "2656860",
    "end": "2664160"
  },
  {
    "text": "and the new entry is dated today and a 625 now how does model binding work",
    "start": "2664160",
    "end": "2672340"
  },
  {
    "text": "model binding means I have an expected type in my case blog entry with public",
    "start": "2672340",
    "end": "2678170"
  },
  {
    "text": "properties among them title and text now if as part of the HTTP POST request",
    "start": "2678170",
    "end": "2684050"
  },
  {
    "text": "there is a title somewhere and the text somewhere and as we all know there is an order in which the the system looks you",
    "start": "2684050",
    "end": "2691790"
  },
  {
    "text": "know post data and then sometimes even cookie or route and then you know it",
    "start": "2691790",
    "end": "2698120"
  },
  {
    "text": "sets the properties of that type and that is a problem because if we have a",
    "start": "2698120",
    "end": "2705230"
  },
  {
    "text": "look at our model class once more I mean we still have that day property it is",
    "start": "2705230",
    "end": "2711020"
  },
  {
    "text": "set automatically but if we send something called date to the server",
    "start": "2711020",
    "end": "2717280"
  },
  {
    "text": "model binding would also work for the day property so actually before I temper",
    "start": "2717280",
    "end": "2723830"
  },
  {
    "text": "with the HDP too much let's just try to",
    "start": "2723830",
    "end": "2729410"
  },
  {
    "text": "use the the f12 cause here might be a",
    "start": "2729410",
    "end": "2735260"
  },
  {
    "text": "bit quicker so how about we edit this",
    "start": "2735260",
    "end": "2742370"
  },
  {
    "text": "and I'm just adding at the end I hope you can see that input type equals",
    "start": "2742370",
    "end": "2747590"
  },
  {
    "text": "hidden name equals state and well you a valid date I never know is a date month",
    "start": "2747590",
    "end": "2753920"
  },
  {
    "text": "month day I actually I don't care because I'm just using something that's hopefully will just work out the box",
    "start": "2753920",
    "end": "2759820"
  },
  {
    "text": "okay so I'm sending this along right along with and it's the 2008 e 2nd",
    "start": "2759820",
    "end": "2769790"
  },
  {
    "text": "edition that's soon and that doesn't",
    "start": "2769790",
    "end": "2778850"
  },
  {
    "text": "exist right it just just be safe and now I've created an entry in the future",
    "start": "2778850",
    "end": "2784160"
  },
  {
    "text": "right five months from now and that specific attack is called",
    "start": "2784160",
    "end": "2789860"
  },
  {
    "text": "mass assignment and I told you I have an older version here of visual studio because you know if you if you usual",
    "start": "2789860",
    "end": "2796670"
  },
  {
    "text": "studio and use a spoon and NBC then use the wizard to create you know how it's called use crap with entity frameworks and",
    "start": "2796670",
    "end": "2804530"
  },
  {
    "text": "views and controllers then when then",
    "start": "2804530",
    "end": "2809660"
  },
  {
    "text": "they create those action methods for you but they add a comment and the comment says well you know in order to avoid",
    "start": "2809660",
    "end": "2816590"
  },
  {
    "text": "over posting or over binding please explicitly state here either which",
    "start": "2816590",
    "end": "2824230"
  },
  {
    "text": "properties you do want to get bound or which properties you absolutely do not",
    "start": "2824230",
    "end": "2829520"
  },
  {
    "text": "want to get bound so we have an and allow list and a a disallow list and",
    "start": "2829520",
    "end": "2836530"
  },
  {
    "text": "since I was kind of having having fun with with spring earlier and in this",
    "start": "2836530",
    "end": "2842090"
  },
  {
    "text": "talk here's just the the Java API here and they also have set allowed fields",
    "start": "2842090",
    "end": "2847220"
  },
  {
    "text": "and set this allowed fields and do that and if you've ever seen that comment and wondered why and now you know so so",
    "start": "2847220",
    "end": "2854090"
  },
  {
    "text": "please try to fix that model binding or you know active record or whatever it is called in other technologies is super",
    "start": "2854090",
    "end": "2861200"
  },
  {
    "text": "convenient because you know I I'm working in that he's so long I I just",
    "start": "2861200",
    "end": "2867380"
  },
  {
    "text": "don't have time for a blog entry text equals request what form of text or",
    "start": "2867380",
    "end": "2875330"
  },
  {
    "text": "something I don't have time for this right and technology takes takes that's the work for me right but on the other",
    "start": "2875330",
    "end": "2881990"
  },
  {
    "text": "hand maybe it's binding too much so we had to we have to be super careful here all right next up is something that",
    "start": "2881990",
    "end": "2888830"
  },
  {
    "text": "actually hit hit Instagram and before we",
    "start": "2888830",
    "end": "2894050"
  },
  {
    "text": "go on the slides I think I'll just show you that so this is the set up I have",
    "start": "2894050",
    "end": "2903770"
  },
  {
    "text": "here a page let's just imagine that is my Instagram profile right so I'm an",
    "start": "2903770",
    "end": "2913190"
  },
  {
    "text": "Instagram user at least in that scenario and this is my profile on that profile I can control one thing the link right",
    "start": "2913190",
    "end": "2922820"
  },
  {
    "text": "I will I would probably say yeah you know you get you get all the slides or",
    "start": "2922820",
    "end": "2928910"
  },
  {
    "text": "you get the video of this of today you'll get that in my Instagram account now I'm I think the conference will put",
    "start": "2928910",
    "end": "2935960"
  },
  {
    "text": "it up on YouTube or v-mail but you know let's just assume that okay so you click on that link okay",
    "start": "2935960",
    "end": "2942020"
  },
  {
    "text": "and I mean we actually we can we can have a look at that at that at the source code here you know that's that's",
    "start": "2942020",
    "end": "2948410"
  },
  {
    "text": "just browser link so that doesn't do anything yeah that's that's all there is there is no JavaScript recurring or",
    "start": "2948410",
    "end": "2954950"
  },
  {
    "text": "nothing just imagine you know that's that's Instagram the only thing I control is the link",
    "start": "2954950",
    "end": "2960080"
  },
  {
    "text": "right so the text of the link and the target of the link and then I'll show you what would happen if I went to that",
    "start": "2960080",
    "end": "2966200"
  },
  {
    "text": "Instagram page and would be interested in the profile of that person so I click on that link okay again no JavaScript",
    "start": "2966200",
    "end": "2973450"
  },
  {
    "text": "the link opens in a new tab so in the real world this would be on a different server this would Christians bad hacker",
    "start": "2973450",
    "end": "2981350"
  },
  {
    "text": "website com okay now you go on that website and then you say I I don't see",
    "start": "2981350",
    "end": "2988160"
  },
  {
    "text": "no video here that's no I want to go away so how do",
    "start": "2988160",
    "end": "2993320"
  },
  {
    "text": "you go away you close the tab control W or you click here on the X okay now what",
    "start": "2993320",
    "end": "3001390"
  },
  {
    "text": "happens as soon as I click on that X well of course the the tab vanishes but",
    "start": "3001390",
    "end": "3008410"
  },
  {
    "text": "what will you see when I click on the X the previous page and in your mind you",
    "start": "3008410",
    "end": "3013900"
  },
  {
    "text": "say that's Instagram right I was on Instagram I clicked on a link nothing happened I will be on",
    "start": "3013900",
    "end": "3020710"
  },
  {
    "text": "Instagram and well you kinda are on Instagram the only problem is that",
    "start": "3020710",
    "end": "3026859"
  },
  {
    "text": "Instagram now prompts you to log in again hmm and I mean you know we all",
    "start": "3026859",
    "end": "3032680"
  },
  {
    "text": "tell you know our friends and family so not from from not an IT yeah you know when you enter your password make sure",
    "start": "3032680",
    "end": "3038410"
  },
  {
    "text": "that you know you you typed in the URL of that site don't click on any links but hey previously I did type in",
    "start": "3038410",
    "end": "3045010"
  },
  {
    "text": "Instagram so yeah this must be Instagram I don't you need to check the URL and",
    "start": "3045010",
    "end": "3051180"
  },
  {
    "text": "that's the problem here now what happened what did happen is something that was",
    "start": "3051180",
    "end": "3058000"
  },
  {
    "text": "invented by Netscape in I think 1996 or 1997 I've been using this for good until",
    "start": "3058000",
    "end": "3065770"
  },
  {
    "text": "I stumbled upon this I can access the",
    "start": "3065770",
    "end": "3073480"
  },
  {
    "text": "opener the opening window or tab of a browser window or tab you know 1996",
    "start": "3073480",
    "end": "3082000"
  },
  {
    "text": "pop-ups were invented you know a pop-up went up and from the pop-up you could kind of control the the original browser",
    "start": "3082000",
    "end": "3087940"
  },
  {
    "text": "window so you could have a like remote control feature back in the days people including me thought it would be a great idea or well have we failed",
    "start": "3087940",
    "end": "3094690"
  },
  {
    "text": "now that API still exists now we have the same return policy of course so I",
    "start": "3094690",
    "end": "3099730"
  },
  {
    "text": "cannot access the document in that window well here it's all one server so",
    "start": "3099730",
    "end": "3104950"
  },
  {
    "text": "I actually could but the thanks to same return policy I cannot but I can access",
    "start": "3104950",
    "end": "3111430"
  },
  {
    "text": "the window object and I can access the location property of that window object",
    "start": "3111430",
    "end": "3117010"
  },
  {
    "text": "including all of its parameters so our",
    "start": "3117010",
    "end": "3122920"
  },
  {
    "text": "members like HRF or even better replace because if we do replace you can't even",
    "start": "3122920",
    "end": "3128680"
  },
  {
    "text": "use the back button in the browser okay yeah and that of course means when you",
    "start": "3128680",
    "end": "3135040"
  },
  {
    "text": "have external links and those links come from someone else so if the user can kind of put in those links for instance",
    "start": "3135040",
    "end": "3141970"
  },
  {
    "text": "link to their home page link to whatever then you might be prone to that specific type of attack now there are good news",
    "start": "3141970",
    "end": "3149980"
  },
  {
    "text": "of course as well because it's kind of easy to defend against those attacks the",
    "start": "3149980",
    "end": "3156400"
  },
  {
    "text": "best way is when you have a link just use rel equals then no referrer and no",
    "start": "3156400",
    "end": "3165910"
  },
  {
    "text": "opener you have to use both because some older Firefox versions and do not comply",
    "start": "3165910",
    "end": "3172750"
  },
  {
    "text": "yet but this work and all kind of serious browsers you can also use specific content security policy",
    "start": "3172750",
    "end": "3179170"
  },
  {
    "text": "directive for the browser support there's a little bit worse than that yeah so if you have external links and",
    "start": "3179170",
    "end": "3184780"
  },
  {
    "text": "users can control those external links and that's that's absolutely what you need to do sounds",
    "start": "3184780",
    "end": "3190060"
  },
  {
    "text": "weird right I mean an external link is not a problem but as you saw it is a problem and remember you open the tab",
    "start": "3190060",
    "end": "3196960"
  },
  {
    "text": "you close the tab and then you assume you are in the same position and as",
    "start": "3196960",
    "end": "3205020"
  },
  {
    "text": "before all right now I would actually like to",
    "start": "3205020",
    "end": "3212290"
  },
  {
    "text": "show you I like to show you one more thing and that's something that has not",
    "start": "3212290",
    "end": "3219130"
  },
  {
    "text": "directly to do with with websites but it",
    "start": "3219130",
    "end": "3224740"
  },
  {
    "text": "has to do with web technologies and it's an issue that actually a unit and we see",
    "start": "3224740",
    "end": "3230350"
  },
  {
    "text": "ones had and this kind of shows that you know we think about their specific",
    "start": "3230350",
    "end": "3235750"
  },
  {
    "text": "attacks quite often but there's one thing that we often forget that you know",
    "start": "3235750",
    "end": "3240820"
  },
  {
    "text": "there are also limits when it comes to computation and and bandwidth and the a kind of resources and I'm not talking",
    "start": "3240820",
    "end": "3247750"
  },
  {
    "text": "about you know do s so DDoS I'm talking about something in the application and",
    "start": "3247750",
    "end": "3253000"
  },
  {
    "text": "then that's what I'd like to to to show you now this is part of the asp net mbc",
    "start": "3253000",
    "end": "3262660"
  },
  {
    "text": "source code and what you can do there is there is a built-in validation so when",
    "start": "3262660",
    "end": "3270850"
  },
  {
    "text": "you say okay this piece of information and the model is of type email address or URL or telephone number then you can",
    "start": "3270850",
    "end": "3281200"
  },
  {
    "text": "have Auto validation of that so the serve and also decline by the way they validate the input and how do they",
    "start": "3281200",
    "end": "3287380"
  },
  {
    "text": "validate the input I mean if you talk about email addresses I'm very easy in validating those email",
    "start": "3287380",
    "end": "3292840"
  },
  {
    "text": "addresses I check if terrorists and at character in it and that's basically it what what they do is they have a really",
    "start": "3292840",
    "end": "3298090"
  },
  {
    "text": "really complex regular expression here even for phone numbers and they have a",
    "start": "3298090",
    "end": "3304810"
  },
  {
    "text": "complex regular expression now here let's have a look at rack X body this is",
    "start": "3304810",
    "end": "3310840"
  },
  {
    "text": "the phone number regular expression as in use today and Carrodus tool explains",
    "start": "3310840",
    "end": "3317470"
  },
  {
    "text": "kind of what what's happening including backtracking it's and then when you enter phone number",
    "start": "3317470",
    "end": "3325910"
  },
  {
    "text": "well that phone numbers validated and once I have an invalid character it's not a phone number any longer",
    "start": "3325910",
    "end": "3332070"
  },
  {
    "text": "pretty nice tool actually cost a little of money but very useful if you do a lot of regular expressions and you can even",
    "start": "3332070",
    "end": "3338369"
  },
  {
    "text": "click on debug and then you see how that thing is parse and that you know there's backtracking going on etc now as you're",
    "start": "3338369",
    "end": "3346440"
  },
  {
    "text": "no complexity sometimes hides underlying issues so how about I'm using a",
    "start": "3346440",
    "end": "3355680"
  },
  {
    "text": "different phone number so that one's good right in school as well I just make a little longer and then a special",
    "start": "3355680",
    "end": "3362250"
  },
  {
    "text": "character like a alright it's obvious at",
    "start": "3362250",
    "end": "3367500"
  },
  {
    "text": "least for eggox body that that is yeah that's not it that's not a phone number right it's not",
    "start": "3367500",
    "end": "3372869"
  },
  {
    "text": "yellow any longer let's debug it now you saw that when I clicked on the bug before you know I clicked on it snap and",
    "start": "3372869",
    "end": "3378960"
  },
  {
    "text": "I got the result and then had whatever 15 steps okay now I click again please",
    "start": "3378960",
    "end": "3385050"
  },
  {
    "text": "watch the mouse pointer and you see there is a delay there was a small delay why was there a delay because ah there's",
    "start": "3385050",
    "end": "3393300"
  },
  {
    "text": "some backtracking going on ah then but not enough backtracking going on we're",
    "start": "3393300",
    "end": "3398580"
  },
  {
    "text": "still validating right backtracking going on backtracking going on and after 1 million tries they just give up now",
    "start": "3398580",
    "end": "3407990"
  },
  {
    "text": "this was our short phone number so you could do a denial of service attack by",
    "start": "3407990",
    "end": "3413670"
  },
  {
    "text": "sending such a specially crafted phone number or similarly email address to the",
    "start": "3413670",
    "end": "3420600"
  },
  {
    "text": "server and the server was then tossed by using a regular expression that is that",
    "start": "3420600",
    "end": "3428010"
  },
  {
    "text": "is utterly frustrating now actually they fixed it so I thought ok when they fix it can they can they fix it by changing",
    "start": "3428010",
    "end": "3436080"
  },
  {
    "text": "regular expression well the regular expression for email address that one did change a little bit so it's easier",
    "start": "3436080",
    "end": "3443700"
  },
  {
    "text": "now so the old attack doesn't work but if we go to the phone attribute you can",
    "start": "3443700",
    "end": "3452040"
  },
  {
    "text": "have a look at the specific Greger expression but it is the same as I as I showed you",
    "start": "3452040",
    "end": "3457740"
  },
  {
    "text": "but what they did is this they set a match timeout to two seconds that's",
    "start": "3457740",
    "end": "3465270"
  },
  {
    "text": "that's the fix that that prevents the attack so only two seconds and the",
    "start": "3465270",
    "end": "3471270"
  },
  {
    "text": "verification continues to run don't abuse this all right so you see that",
    "start": "3471270",
    "end": "3476850"
  },
  {
    "text": "even old attacks are dangerous again new attacks sometimes use ancient api's to",
    "start": "3476850",
    "end": "3483930"
  },
  {
    "text": "be exploited when you have single page applications there are several things you need to take into account when you",
    "start": "3483930",
    "end": "3489630"
  },
  {
    "text": "accept specific data formats in XML look for external entities and when you",
    "start": "3489630",
    "end": "3495090"
  },
  {
    "text": "digitize something maybe limit the types you are allowing to be deserialized into",
    "start": "3495090",
    "end": "3500460"
  },
  {
    "text": "and even if you do all that a regular expression might bring you into issues so thanks again for coming I think two",
    "start": "3500460",
    "end": "3507660"
  },
  {
    "text": "goals now in the World Cup so you had a much better time here I hope and see you see you next time at NDC thank you very",
    "start": "3507660",
    "end": "3513540"
  },
  {
    "text": "much",
    "start": "3513540",
    "end": "3515690"
  },
  {
    "text": "[Applause]",
    "start": "3519920",
    "end": "3523010"
  }
]