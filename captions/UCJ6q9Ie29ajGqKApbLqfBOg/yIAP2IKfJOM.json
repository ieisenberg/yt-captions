[
  {
    "start": "0",
    "end": "216000"
  },
  {
    "text": "so this is strike three on malware the talk is on Dex education practicing safe Dex by Tim",
    "start": "399",
    "end": "7519"
  },
  {
    "text": "strer thank you how you guys doing um hopefully I won't put you to sleep uh I know you",
    "start": "7519",
    "end": "13799"
  },
  {
    "text": "guys all got like a post lunch coma going on apparently need to add some more buzzword into my abstract cuz it's kind of thin right now but uh we'll see",
    "start": "13799",
    "end": "22080"
  },
  {
    "text": "so who am I I'm timer as I was introduced um I work at Lookout Mobile Security um we were just a small company",
    "start": "22080",
    "end": "29000"
  },
  {
    "text": "that likes to try and do big things uh senior security engineer it's basically a madeup role it just means I get to do reversing and I get to",
    "start": "29000",
    "end": "35879"
  },
  {
    "text": "actually do some engineering um I'm I guess I'm kind of known for doing the Android market people email me too much",
    "start": "35879",
    "end": "42480"
  },
  {
    "text": "about this and it's basically because I'm the only person or one of the few people who's uh bothered spending enough",
    "start": "42480",
    "end": "47680"
  },
  {
    "text": "time looking at the thing and wasting their life doing that uh so I got some really funny stories about that if you ever want to buy me a beer I'll chat",
    "start": "47680",
    "end": "54039"
  },
  {
    "text": "your ear off about it and you'll probably hate me for it um I really enjoy reversing exotic platforms feel",
    "start": "54039",
    "end": "59519"
  },
  {
    "text": "like it's very very uh you're almost like a Pioneer you know you get to go out there and do things that you know",
    "start": "59519",
    "end": "64600"
  },
  {
    "text": "you can't Google and find 8,000 tutorials on how to do this um I'm just a junkie for that kind of reversing and",
    "start": "64600",
    "end": "70280"
  },
  {
    "text": "different malware malware is always fun because you know they're trying to protect their code and they're trying not to you know be detected and whatnot",
    "start": "70280",
    "end": "76560"
  },
  {
    "text": "um also I'm I'm Different Tim because there was already a Tim on my team so people usually just call me diff but you",
    "start": "76560",
    "end": "81920"
  },
  {
    "text": "can call me whatever you want U so the agenda uh it's just going to be Dex education uh what is the Dex file all",
    "start": "81920",
    "end": "88439"
  },
  {
    "text": "that kind of good stuff how are attacker is currently hiding and trying to break um the systems used to analyze malware",
    "start": "88439",
    "end": "95159"
  },
  {
    "text": "and legitimate applications uh and then we're going to move on to the anti analysis section uh where we're",
    "start": "95159",
    "end": "100960"
  },
  {
    "text": "basically going to try and break those tools see why they're breaking and how can we prevent those things from being broken uh in the future while we're",
    "start": "100960",
    "end": "107320"
  },
  {
    "text": "developing these types of tools and also how to flag easy things um we're also going to try and do breaking the toolbox",
    "start": "107320",
    "end": "113119"
  },
  {
    "text": "which is basically that anti- ulator stuff anti-vm um and then we're going to release a proof a concept tool and nice",
    "start": "113119",
    "end": "119880"
  },
  {
    "text": "little Lessons Learned so what is a DEX file a de file just stands for it's",
    "start": "119880",
    "end": "124960"
  },
  {
    "text": "delic executable uh it's basically um similar to a jar you're going to have",
    "start": "124960",
    "end": "130720"
  },
  {
    "text": "your classes bundled into a jar uh but in uh Android it's going to be compiled down into a DEX file so all those",
    "start": "130720",
    "end": "137040"
  },
  {
    "text": "classes are actually uh flattened down into one file um and this is in package inside of",
    "start": "137040",
    "end": "142840"
  },
  {
    "text": "an APK file which is basically the same thing as a jar so upon installation what's going to",
    "start": "142840",
    "end": "149239"
  },
  {
    "text": "happen is you're going to have your APK file you're going to do something like a PM install or you're going to get it uh installed from uh Google play uh",
    "start": "149239",
    "end": "156560"
  },
  {
    "text": "basically it's going to go through a quick and fast uh verification to make sure you know you're not installing a",
    "start": "156560",
    "end": "161680"
  },
  {
    "text": "corrupt file everything looks pretty decent uh and then on the first runtime or boot of that application it's going",
    "start": "161680",
    "end": "167800"
  },
  {
    "text": "to go through a little bit more of a verification uh through the D verifier which basically traverses actual code",
    "start": "167800",
    "end": "173959"
  },
  {
    "text": "pass uh just to make sure that there's no real funky things going on in there so what is the Dex file the Dex",
    "start": "173959",
    "end": "181840"
  },
  {
    "text": "file I mean it basically has its header that's just a normal header for many like many other file formats it",
    "start": "181840",
    "end": "188000"
  },
  {
    "text": "basically points to all these other tables it points to a data section then you have a uh specific section for each",
    "start": "188000",
    "end": "194239"
  },
  {
    "text": "one of the other um Parts uh you know you got your string your prototype your field your method your class Stu and",
    "start": "194239",
    "end": "200360"
  },
  {
    "text": "these are all basically going to be used by Android to see what class am I calling what's the name of that class",
    "start": "200360",
    "end": "205879"
  },
  {
    "text": "what's the string that's represented by that and there's this huge chunk uh the data section which all these tables",
    "start": "205879",
    "end": "211319"
  },
  {
    "text": "above are pointing off into and that's where all the magic happens so how can we currently examine",
    "start": "211319",
    "end": "218920"
  },
  {
    "start": "216000",
    "end": "216000"
  },
  {
    "text": "uh Dex files so there's box Molly It's a Wonderful tool it's used by a lot of other tools uh APK tool which a lot of",
    "start": "218920",
    "end": "225840"
  },
  {
    "text": "people use for um unbundling resources and whatnot and",
    "start": "225840",
    "end": "230959"
  },
  {
    "text": "helping authors translate different things uh Pirates also use this tool there's anti- LVL which actually uses",
    "start": "230959",
    "end": "236280"
  },
  {
    "text": "box mly but box m is just a great tool basically converts straight delet code into what's called a smiley file which",
    "start": "236280",
    "end": "242760"
  },
  {
    "text": "is basically a Jasmine syntax but it's an exact representation of what's actually going on ID Pro it's good",
    "start": "242760",
    "end": "248480"
  },
  {
    "text": "oldfashioned Ida Pro most people probably know what that is andro guard is a really cool tool I don't personally",
    "start": "248480",
    "end": "253560"
  },
  {
    "text": "use it a lot um I just stick with boxmy but it's a pretty great tool for manipulating and analyzing Dex files uh",
    "start": "253560",
    "end": "260400"
  },
  {
    "text": "Dex jar is super popular from what I hear um I see lots of presentations where people are just like cram it in",
    "start": "260400",
    "end": "266600"
  },
  {
    "text": "Dex to jar and use it and I'm not personally big fan of that but it's a great tool it basically converts a jar",
    "start": "266600",
    "end": "272320"
  },
  {
    "text": "file uh it converts the APK into a jar file so that you can then look at it and use your actual um normal Java tools to",
    "start": "272320",
    "end": "278919"
  },
  {
    "text": "analyze that um oo editor this is a great great tool I feel like it's super unused uh there's a great template out",
    "start": "278919",
    "end": "285479"
  },
  {
    "text": "there and basically it's a really easy way to visualize what's a DEX file where are all these where's all these bites",
    "start": "285479",
    "end": "291479"
  },
  {
    "text": "going um and hopefully people will start using that after I show people how to mess around with Dex files and actually see what's going on uh there's there's",
    "start": "291479",
    "end": "297720"
  },
  {
    "text": "plenty other tools out there people are just making them them you know left and right um some are popular some aren't I",
    "start": "297720",
    "end": "303880"
  },
  {
    "text": "I think these are the most popular tools out there um so how are attackers currently",
    "start": "303880",
    "end": "309400"
  },
  {
    "start": "306000",
    "end": "306000"
  },
  {
    "text": "hiding uh for the most part people are just doing really simple things uh the malare is sort of in its infancy um not",
    "start": "309400",
    "end": "316520"
  },
  {
    "text": "a lot of people are looking for the malware so nobody's really doing anything because they don't really need to right now um you know you don't",
    "start": "316520",
    "end": "322199"
  },
  {
    "text": "really have to hide things too too much uh to get by certain systems and whatnot",
    "start": "322199",
    "end": "327919"
  },
  {
    "text": "um one of the main things that we've seen is people are starting to shift to use reflection it's just normal Java",
    "start": "327919",
    "end": "333080"
  },
  {
    "text": "Reflection they're using it to call um sensitive apis and whatnot so that basically if someone's using a static",
    "start": "333080",
    "end": "338880"
  },
  {
    "text": "analyzer and saying hey is someone using send SMS well let me see if send send",
    "start": "338880",
    "end": "344639"
  },
  {
    "text": "SMS is being called I'll look in the class def um structures and whatnot uh but if you use reflection then it's",
    "start": "344639",
    "end": "350759"
  },
  {
    "text": "actually just going to be a string and you're loading that in um the other way that people have been trying to hide code is uh you know dumping things into",
    "start": "350759",
    "end": "357520"
  },
  {
    "text": "assets trying to pend it onto what should be a good file so that you know if you look at the Dex file it's",
    "start": "357520",
    "end": "363160"
  },
  {
    "text": "actually not going to be in there and if you don't actually take into consideration any of the other contents of the application then you might just",
    "start": "363160",
    "end": "368680"
  },
  {
    "text": "miss these things um we've also seen a few different things it's not actually hasn't been used by malare authors but",
    "start": "368680",
    "end": "374680"
  },
  {
    "text": "there's a nice little um pirate anti-pirate war going on where people are actually trying to break these tools",
    "start": "374680",
    "end": "380280"
  },
  {
    "text": "so that they can just F each other over um so the first one this is just a screenshot from ID Pro as most of you",
    "start": "380280",
    "end": "386560"
  },
  {
    "text": "may have seen um and basically this is loading in the SMS manager so that they can reflectively called send text",
    "start": "386560",
    "end": "393400"
  },
  {
    "text": "message so it's it's really simple this is just you know this is what id Pro shows you for Dela code uh it's really",
    "start": "393400",
    "end": "399599"
  },
  {
    "text": "easy to do in Java but um it's actually causes a little bit of a problem because",
    "start": "399599",
    "end": "404840"
  },
  {
    "text": "some most people go okay well I want to detect this let me just uh you know detect everything that's ever reflecting",
    "start": "404840",
    "end": "411120"
  },
  {
    "text": "anything which isn't really a great solution because you're going to line end up with a lot of false positives um so like I said this",
    "start": "411120",
    "end": "418319"
  },
  {
    "text": "basically lets that attacker hi to sensitive call uh from being actually called as a function you're just going",
    "start": "418319",
    "end": "423639"
  },
  {
    "text": "to see that actual reflective function with uh the strings being loaded in um if they wanted to get more complex we've",
    "start": "423639",
    "end": "429440"
  },
  {
    "text": "seen a few people do aisc on these strings so in the example I showed you it was clear what was going on but you",
    "start": "429440",
    "end": "435120"
  },
  {
    "text": "know you might see these garbled strings and whatnot uh being loaded reflectively right you know maybe exore them right",
    "start": "435120",
    "end": "440639"
  },
  {
    "text": "before that and it's uh it's kind of annoying it's really easy to detect with Dynamic analysis but it actually",
    "start": "440639",
    "end": "446199"
  },
  {
    "text": "somewhat hinders people from doing massive static analysis so the next thing we saw is uh and this",
    "start": "446199",
    "end": "453000"
  },
  {
    "text": "is actually from malware this is from um I believe it's fake Opera fake op fake",
    "start": "453000",
    "end": "458080"
  },
  {
    "text": "install there's a million different names for the malware we really need to standardize those uh but basically there was a image file and inside this image",
    "start": "458080",
    "end": "466199"
  },
  {
    "text": "file which as you can see I did the file it's just data so you could file type this it's not going to come up as the right file type uh but there's just",
    "start": "466199",
    "end": "472759"
  },
  {
    "text": "something weird going on in the blue we see that maybe there's some weird magic bites going on uh and then we also see",
    "start": "472759",
    "end": "478720"
  },
  {
    "text": "that there's repeating ox12 coming on so that that's probably an indication that something's exord there but we also see",
    "start": "478720",
    "end": "484639"
  },
  {
    "text": "another PK header so this is kind of an interesting one cuz if you want to be really quick and you're like oh I'm",
    "start": "484639",
    "end": "490800"
  },
  {
    "text": "smart that's a PK header I'm just going to look at that one and if you look at that it ends up turning into uh two",
    "start": "490800",
    "end": "496319"
  },
  {
    "text": "separate zip files so what they did this malware author um and this is actually from GX I believe uh maybe I said that",
    "start": "496319",
    "end": "503879"
  },
  {
    "text": "wrong but yeah this this one is from gam excuse me so basically what happened was the guy has Twin Two zip files and so if",
    "start": "503879",
    "end": "512518"
  },
  {
    "text": "you exort it you'll get the proper um executable that is going to be loaded they're going to try and push this and",
    "start": "512519",
    "end": "518399"
  },
  {
    "text": "install this on the phone and that's actually going to have all the malicious code but if you were just you know you weren't being lazy but it's been a long",
    "start": "518399",
    "end": "525360"
  },
  {
    "text": "day you're going to go re at at it and you're going to try and get this done as fast as possible you might have actually extracted the one that's on the left so",
    "start": "525360",
    "end": "531839"
  },
  {
    "text": "that's clearly a much smaller zip file and actually doesn't contain a lot of the malicious code you'll look at it and you know that it's trying to do",
    "start": "531839",
    "end": "537839"
  },
  {
    "text": "something malicious but it doesn't contain all the code um it it's a really interesting tactic that this guy tried",
    "start": "537839",
    "end": "543079"
  },
  {
    "text": "to employ um so did did he mean to do this maybe but uh it it's I mean I would",
    "start": "543079",
    "end": "550760"
  },
  {
    "text": "say he definitely did this on purpose but he could have done things you know maybe a little bit smarter if any of you guys actually wrote that come talk to me",
    "start": "550760",
    "end": "557480"
  },
  {
    "text": "I I won't tell on you I promise but uh basically it it's really cool but he could have maybe injected um Angry Birds",
    "start": "557480",
    "end": "564880"
  },
  {
    "text": "so that if you just looked at this quickly it would be a legitimate Dex file a legitimate resource file and then",
    "start": "564880",
    "end": "570079"
  },
  {
    "text": "he could have hid his other one right in there um this is definitely one of the most interesting things I've seen so",
    "start": "570079",
    "end": "576880"
  },
  {
    "text": "far uh and then this is another one um this one I'm forgetting the name of the",
    "start": "576880",
    "end": "582120"
  },
  {
    "text": "actual mware that used this but basically uh what had happened is they made a actual valid uh JPEG file you can",
    "start": "582120",
    "end": "588680"
  },
  {
    "text": "file type it it comes out right and you know if you're in your Explorer and you're looking at the preview this is",
    "start": "588680",
    "end": "594519"
  },
  {
    "text": "100% legit it's going to pop up it's going to show you a picture um this was actually injected into I think an Angry Birds file and we could clearly tell",
    "start": "594519",
    "end": "602399"
  },
  {
    "text": "that once you look at this you're like well this you know this isn't roio what simple Studio I don't know what that is",
    "start": "602399",
    "end": "607519"
  },
  {
    "text": "uh but then if you start gripping through the file and looking at it you end up seeing two specific elf binaries that are attached at the end um and one",
    "start": "607519",
    "end": "614760"
  },
  {
    "text": "of them I believe was a exploit payload and the other was an malicious elf file that they were trying to dump onto that",
    "start": "614760",
    "end": "622240"
  },
  {
    "text": "system um this one was really cool cuz it it presents a really interesting problem the last one we could easily",
    "start": "622240",
    "end": "628279"
  },
  {
    "text": "just do file typing and realize that something is really wrong with this uh it's going to have high file entropy",
    "start": "628279",
    "end": "634120"
  },
  {
    "text": "because it's a zip file um but here we're going to try and file type it we're going to get JPEG and if we don't",
    "start": "634120",
    "end": "639720"
  },
  {
    "text": "look closer after that you know this could go through an automated system and you're just going to say oh well there was a JPEG who cares nothing really",
    "start": "639720",
    "end": "645600"
  },
  {
    "text": "happened um so it it definitely makes an interesting uh",
    "start": "645600",
    "end": "652040"
  },
  {
    "text": "Target so moving on to uh something that malware authors haven't actually done",
    "start": "652440",
    "end": "658800"
  },
  {
    "text": "yet but what we have seen and this is again that whole piracy and anti-piracy thing",
    "start": "658800",
    "end": "664240"
  },
  {
    "text": "uh we've seen some developers actually pushing applications that had what we would call a link lock section actually",
    "start": "664240",
    "end": "671480"
  },
  {
    "text": "got that name from anti LVL which implements this into all their actual pirated applications so anti- LVL if you",
    "start": "671480",
    "end": "677800"
  },
  {
    "text": "haven't heard is basically uh this jar that wraps around box Molly and it's basically a scripting engine so you can",
    "start": "677800",
    "end": "683560"
  },
  {
    "text": "say every time I see this function I want to hook that and feed it fake data so people have been using that to Pate",
    "start": "683560",
    "end": "689279"
  },
  {
    "text": "applications and whatnot and people were getting really sick of that so they were trying to break those tools so if you could break box SM you could break this",
    "start": "689279",
    "end": "695880"
  },
  {
    "text": "uh this pirate tool and then those guys were saying well okay developers are starting to try and fight me so I'm",
    "start": "695880",
    "end": "701480"
  },
  {
    "text": "going to fight back so if they can't see what I'm doing then they can't fix their application to prevent me from doing it",
    "start": "701480",
    "end": "707959"
  },
  {
    "text": "um and basically they were just using a header field that wasn't actually implemented in Android yet uh it's in",
    "start": "707959",
    "end": "714240"
  },
  {
    "text": "the documentation it basically says this is going to be linked to a statically linked file and there's nothing else",
    "start": "714240",
    "end": "720360"
  },
  {
    "text": "really there so if you just throw some junk in there and it'll actually it's valid it's somewhere in the the data",
    "start": "720360",
    "end": "725959"
  },
  {
    "text": "nothing else uses it you can make it whatever you want and it just didn't break anything except for box Molly so",
    "start": "725959",
    "end": "731200"
  },
  {
    "text": "I've actually seen this used by J Cas a couple other developers and like I said Lan plus who is the developer of anti-",
    "start": "731200",
    "end": "738680"
  },
  {
    "text": "LVL um but you know along with a simple break comes a simple fix this is really easy to do basically the code was um if",
    "start": "738680",
    "end": "746440"
  },
  {
    "text": "something was set here throw an exception and you know the fix was log",
    "start": "746440",
    "end": "751760"
  },
  {
    "text": "an exception don't throw it don't let your program die um so most tools were already ignoring this but box M was",
    "start": "751760",
    "end": "757920"
  },
  {
    "text": "actually dying directly on this so the next one was well you know that was kind of lame we haven't really",
    "start": "757920",
    "end": "763760"
  },
  {
    "text": "seen anything cool so how do we break stuff and I've always seen these slides and I was like okay I got to make one of these slides and I was going like make",
    "start": "763760",
    "end": "770560"
  },
  {
    "text": "awesome money and I was like crap can't cuz well we're not going to sell break ites we're just going to try and help the community and try and get this stuff",
    "start": "770560",
    "end": "776720"
  },
  {
    "text": "fixed anyway um so as I had said before these are essentially the tools that I feel",
    "start": "776720",
    "end": "782199"
  },
  {
    "text": "like a lot of people are using these are high priority targets box smali it's pretty much just Universal um Dex jar I",
    "start": "782199",
    "end": "789480"
  },
  {
    "text": "feel like so many people use this this is all I hear people usually talking about when they talk about reverse engineering Android applications Ida Pro",
    "start": "789480",
    "end": "796279"
  },
  {
    "text": "that's a gimme because everyone uses Ida Pro or everyone has it someone is always sharing their licenses with other people",
    "start": "796279",
    "end": "802120"
  },
  {
    "text": "all that kind of stuff um and Andro guard it seems to be very popular you know virus total uses it I think Anubis",
    "start": "802120",
    "end": "808000"
  },
  {
    "text": "uses it there's lots of different applications so when we're trying to",
    "start": "808000",
    "end": "813040"
  },
  {
    "start": "811000",
    "end": "811000"
  },
  {
    "text": "think of how can we break these tools um we just thought well let's let's kick it",
    "start": "813040",
    "end": "818600"
  },
  {
    "text": "old school let's you know let's do just an old jar hack you know when people are trying to reverse engineer Java it's",
    "start": "818600",
    "end": "824279"
  },
  {
    "text": "it's so easy because you can just do a Java D compiler so if you could break those back in the day that was really",
    "start": "824279",
    "end": "829360"
  },
  {
    "text": "interesting and cool so I remember trying to unzip something and it would just blow up on me because you know",
    "start": "829360",
    "end": "835320"
  },
  {
    "text": "since jar is just a zip you can extract it and then you got the the files that were originally in there so if you just",
    "start": "835320",
    "end": "841199"
  },
  {
    "text": "hit the file system as the weakness and you try and do something that's over 255 characters you can prevent someone from",
    "start": "841199",
    "end": "847800"
  },
  {
    "text": "actually unzipping it so maybe we can actually break some tools by making a class that's so godamn long that it just",
    "start": "847800",
    "end": "853320"
  },
  {
    "text": "breaks these things um this required in the old school days uh is basically",
    "start": "853320",
    "end": "858399"
  },
  {
    "text": "required you know editing the jar in line a jar doesn't care how long a file is because it's just all contained",
    "start": "858399",
    "end": "863880"
  },
  {
    "text": "inside that jar um so we're basically just trying to attack that file system limitation",
    "start": "863880",
    "end": "869880"
  },
  {
    "text": "so how how can we import this to a DEX file um I haven't really seen many people talk about this type of stuff so",
    "start": "869880",
    "end": "875000"
  },
  {
    "text": "I got interested in it and I started looking at that dalic format and well how how can we make a tool that could do",
    "start": "875000",
    "end": "880040"
  },
  {
    "text": "this for us so basically you have the class def item this is the essential structure of it and the part we're",
    "start": "880040",
    "end": "886560"
  },
  {
    "text": "concerned about is actually going to be the class index and that basically just points into the type item uh which has a",
    "start": "886560",
    "end": "893800"
  },
  {
    "text": "field called the descriptor index and basically this points into the string ID item which is these is just pointing",
    "start": "893800",
    "end": "900600"
  },
  {
    "text": "back and forth to different tables and this points to a string data offset which is again in that you know that",
    "start": "900600",
    "end": "905720"
  },
  {
    "text": "mystical chunk of data called Data section and inside here we can see that we basically have a string data item",
    "start": "905720",
    "end": "912600"
  },
  {
    "text": "which has uh it has a ulb 128 that basically says what's the length of the file and we want to basically inject our",
    "start": "912600",
    "end": "919759"
  },
  {
    "text": "data into here so how did this work so basically we wanted to uh just append",
    "start": "919759",
    "end": "925560"
  },
  {
    "text": "data on the end because the string table always needs to be in order so if we start messing around and and adding weird things we're going to have to do",
    "start": "925560",
    "end": "931399"
  },
  {
    "text": "more work by uh you know reshuffling all that and all the all the items that actually point to that that need to be",
    "start": "931399",
    "end": "937079"
  },
  {
    "text": "reshuffled so we just basically you know dumped a really long um string that's annoying at the end of a class name and",
    "start": "937079",
    "end": "943959"
  },
  {
    "text": "just see if we could break it um so you know we we wrote a quick proof",
    "start": "943959",
    "end": "949000"
  },
  {
    "text": "of concept tool for this it was actually really easy to do and what happens is uh this is actually a screenshot from uh o",
    "start": "949000",
    "end": "955279"
  },
  {
    "text": "and O editor uh and you know you can see the original class don't decompile me",
    "start": "955279",
    "end": "960360"
  },
  {
    "text": "build config and uh then we added one you know why would you go and do something like this and there's a little",
    "start": "960360",
    "end": "965880"
  },
  {
    "text": "story at the end of that it kind of got out of control um so what happens you know we modify that file we resign the",
    "start": "965880",
    "end": "972120"
  },
  {
    "text": "APK we're going to push it to an emulator worked fine you know it didn't take the 3 seconds I just described but",
    "start": "972120",
    "end": "978000"
  },
  {
    "text": "it took a while uh and basically we're just going to see can we break box Molly this way so box mly is actually going to",
    "start": "978000",
    "end": "983360"
  },
  {
    "text": "be outputting these files uh just to your your hard drive so what what happens and as you can see",
    "start": "983360",
    "end": "989079"
  },
  {
    "text": "it just dies on this file class name and it's nice long class name so what were the results so ID Pro",
    "start": "989079",
    "end": "996519"
  },
  {
    "text": "works fine it it doesn't actually output any files it's just using its own internal idb file uh so it just handles",
    "start": "996519",
    "end": "1002360"
  },
  {
    "text": "this properly deex jar works too um somewhat basically because it's it's",
    "start": "1002360",
    "end": "1007480"
  },
  {
    "text": "going to process this and just dump it directly into a jar so as we said jars don't care what the length of the files",
    "start": "1007480",
    "end": "1012600"
  },
  {
    "text": "are if you then tried to unzip that jar you would probably get an error uh but it should be fine you can then open it",
    "start": "1012600",
    "end": "1017720"
  },
  {
    "text": "in you know JD GUI and it will work fine uh so box M actually handles this pretty",
    "start": "1017720",
    "end": "1022759"
  },
  {
    "text": "well it'll skip that class only so if you were hiding something inside that class this file is not going to be",
    "start": "1022759",
    "end": "1028160"
  },
  {
    "text": "output you're not going to be able to analyze that if you have some kind of SMY parsing machine um but it it does",
    "start": "1028160",
    "end": "1033520"
  },
  {
    "text": "actually end up processing the rest of the files so we want to break more things so what else can we do um",
    "start": "1033520",
    "end": "1039839"
  },
  {
    "text": "actually first why why would we care about this this long string limit so it's really easy to detect and it's",
    "start": "1039839",
    "end": "1045959"
  },
  {
    "text": "really easy to work around uh basically you can we could submit a patch to box Molly that was saying you know if it's",
    "start": "1045959",
    "end": "1051840"
  },
  {
    "text": "too long let me truncate this there's actually I believe uh JD guey handles it this way when it tries to process files",
    "start": "1051840",
    "end": "1057919"
  },
  {
    "text": "that way um but you know if you see something like this this might be a really interesting file to look at it's definitely something you might want to",
    "start": "1057919",
    "end": "1063679"
  },
  {
    "text": "alert on and you know flag for maybe human analysis because if someone's doing this either they're just really",
    "start": "1063679",
    "end": "1069440"
  },
  {
    "text": "really bad at Java programming and they went into eclipse and said like you know let's uh Let's ignore all these really",
    "start": "1069440",
    "end": "1074559"
  },
  {
    "text": "bad errors that I shouldn't be ignoring and they've compiled this huge class name or they're trying to mess with",
    "start": "1074559",
    "end": "1080360"
  },
  {
    "text": "you so there's there's a bunch of other interesting things you can do with this uh so basically if if something's being",
    "start": "1080360",
    "end": "1085600"
  },
  {
    "text": "dumped to the file system you can try and attack that person's file system that way uh one thing I I saw I had a",
    "start": "1085600",
    "end": "1091960"
  },
  {
    "text": "fresh MacBook install and so it comes with that awesome case sensitive file system which just sucks so bad um and",
    "start": "1091960",
    "end": "1098679"
  },
  {
    "text": "basically you know I saw some people doing some officiation techniques that was capital I lowercase i capital I",
    "start": "1098679",
    "end": "1104840"
  },
  {
    "text": "lowercase i and then they'd inverse those and technically they're different files but box mly started overwriting",
    "start": "1104840",
    "end": "1110039"
  },
  {
    "text": "each other and you're like where did these magic files go I only have three classes and it's referencing like 30 um",
    "start": "1110039",
    "end": "1116159"
  },
  {
    "text": "that was actually a fix that uh G freak has already committed to boxal a while ago it'll actually start appending you",
    "start": "1116159",
    "end": "1121760"
  },
  {
    "text": "know two three onto those file names the other interesting thing is you can throw different asky characters since they're",
    "start": "1121760",
    "end": "1127120"
  },
  {
    "text": "all considered valid and that's just going to be a real pain in the ass to work with on the uh command line um so I",
    "start": "1127120",
    "end": "1134200"
  },
  {
    "text": "just remember growing up and doing some hour analysis and I always loved it when people tried to mess with the tools and",
    "start": "1134200",
    "end": "1140760"
  },
  {
    "text": "uh one of the interesting things was when people would inject bad op codes so you know the autoanalysis of Ida would",
    "start": "1140760",
    "end": "1146120"
  },
  {
    "text": "just blow up or something or all debug would just start barfing everywhere so I definitely wanted to try and inject bad",
    "start": "1146120",
    "end": "1152280"
  },
  {
    "text": "op codes behind dead code that just wouldn't get processed so the the objective was definitely get this on a",
    "start": "1152280",
    "end": "1157480"
  },
  {
    "text": "phone and let it work for a normal user but at the same time killing all those tools so the goal if you can't read um",
    "start": "1157480",
    "end": "1164159"
  },
  {
    "text": "dalic up codes which maybe some of you guys can if you can speak to me I would love to hire you uh basically you're",
    "start": "1164159",
    "end": "1169679"
  },
  {
    "text": "going to load you know zero into the first register and then we're just say hey is the first register zero if it is",
    "start": "1169679",
    "end": "1175960"
  },
  {
    "text": "jump over the next instructions so clearly this should never be executed um we threw this in we injected it into a",
    "start": "1175960",
    "end": "1182000"
  },
  {
    "text": "couple classes it compiled uh we then signed this and we push it to device and it just started working it was really",
    "start": "1182000",
    "end": "1188520"
  },
  {
    "text": "cool so I was like okay this is awesome like this was a lot easier than I ever anticipated and then it just sucked from",
    "start": "1188520",
    "end": "1193640"
  },
  {
    "text": "there it just went downhill um the delic verifier pretty much just smacked Us in",
    "start": "1193640",
    "end": "1198799"
  },
  {
    "text": "the face and said no you're a bad person go away um and so why did this fail so the delic verifier ends up uh on",
    "start": "1198799",
    "end": "1205880"
  },
  {
    "text": "execution looking at actual code paths that are going to be um gone through and",
    "start": "1205880",
    "end": "1211919"
  },
  {
    "text": "traversed and actually possibly executed they don't look to see if uh essentially",
    "start": "1211919",
    "end": "1216960"
  },
  {
    "text": "you know that was a bad jump that it should never go through but it just ignores that and sees is everything in",
    "start": "1216960",
    "end": "1222520"
  },
  {
    "text": "here okay so everything in there was not okay so this this was an issue for us so how can we how can we avoid the verify",
    "start": "1222520",
    "end": "1228280"
  },
  {
    "text": "we need to dodge that guy basically uh we came up with the idea that we want to",
    "start": "1228280",
    "end": "1234039"
  },
  {
    "text": "inject the same op codes but into a class that we're not using so if we don't using the class maybe the verifier",
    "start": "1234039",
    "end": "1240000"
  },
  {
    "text": "won't go in there and this ended up working it installed fine and we can",
    "start": "1240000",
    "end": "1245039"
  },
  {
    "text": "actually look at it so what was happening is it appears that the way that the verifier is working is it's",
    "start": "1245039",
    "end": "1250640"
  },
  {
    "text": "trying to optimize how much work it's doing and by taking that optimization it says you're not using this class file I",
    "start": "1250640",
    "end": "1256120"
  },
  {
    "text": "don't care I'm not going to verify that so this would be normally be a file if you ran progard that would get stripped out because it's never actually",
    "start": "1256120",
    "end": "1261720"
  },
  {
    "text": "referenced inside the project um so who can we break with this so box Molly dies",
    "start": "1261720",
    "end": "1267840"
  },
  {
    "text": "um they actually just committed a fix for this he's a he's a machine he's just always working on this and I love",
    "start": "1267840",
    "end": "1273640"
  },
  {
    "text": "sending him bugs and he fixes it the next day but basically um you know it was dying it was attempting to go into",
    "start": "1273640",
    "end": "1279720"
  },
  {
    "text": "that dead code and it would just fail um Dex jar same issue we're trying to load",
    "start": "1279720",
    "end": "1285520"
  },
  {
    "text": "it in and it basically is just I don't know what this stop Cod is go away please leave me alone uh Andro guard same thing uh he",
    "start": "1285520",
    "end": "1294159"
  },
  {
    "text": "actually did a really good job of handling the op codes that he didn't know there was actually just a few I think there was like three op codes that",
    "start": "1294159",
    "end": "1300080"
  },
  {
    "text": "he happened to miss probably coding late at night something like that but uh he he basically did anticipate someone to",
    "start": "1300080",
    "end": "1305679"
  },
  {
    "text": "try and do this but he just missed a few op codes so I was able to just use that specific op code and it broke his tool as",
    "start": "1305679",
    "end": "1310960"
  },
  {
    "text": "well um Ida well we kind of expected Ida to handle this it's a tool that's been around a while it's it's had these",
    "start": "1310960",
    "end": "1317480"
  },
  {
    "text": "attacks formed against it so basically you can see it's just jumping around that and it's like I don't know what this this off code is I'm just going to",
    "start": "1317480",
    "end": "1323520"
  },
  {
    "text": "lab it unused um there's this really interesting tool it's it's an academic tool I don't know many people who",
    "start": "1323520",
    "end": "1328720"
  },
  {
    "text": "actually use it but uh a friend of mine was just like please run against this tool I want to see what happens they use",
    "start": "1328720",
    "end": "1334400"
  },
  {
    "text": "half the delic headers anyway right from AOSP so it should work on everything um and it didn't it just completely died",
    "start": "1334400",
    "end": "1340240"
  },
  {
    "text": "and then you could basically you know cook a bowl of soup on your laptop because it just there spinning and the core just goes to",
    "start": "1340240",
    "end": "1346520"
  },
  {
    "text": "100% so I'd appr Pro is the only one who handled this properly um you know it",
    "start": "1346520",
    "end": "1351840"
  },
  {
    "text": "they're the guys that get paid they get to do this daily and they're not doing this as a as a side project so that's",
    "start": "1351840",
    "end": "1357880"
  },
  {
    "text": "not really that big of a surprise they also have lots of experience doing this kind of thing so how can we develop our",
    "start": "1357880",
    "end": "1363159"
  },
  {
    "text": "tools better you know we we got to predict this this is an awesome Edge case that people should be uh thinking about when they're developing tools that",
    "start": "1363159",
    "end": "1370440"
  },
  {
    "text": "might be used to analyze malicious applications for just normal applications someone's probably going to mess with you at some time and this is a",
    "start": "1370440",
    "end": "1376679"
  },
  {
    "text": "really um easy thing and this is a very like not complex idea to try and",
    "start": "1376679",
    "end": "1381760"
  },
  {
    "text": "Implement so we should always just be thinking about that so this is a good thing for uh",
    "start": "1381760",
    "end": "1390360"
  },
  {
    "text": "automated analysis because if if you have your own tool chain and you're looking at things and you've or you're using any of the other tools that have",
    "start": "1390360",
    "end": "1396039"
  },
  {
    "text": "already been patched this is awesome thing to look for if someone's using illegal op codes they're probably doing",
    "start": "1396039",
    "end": "1401120"
  },
  {
    "text": "something really weird uh so you can treat it as a noop but uh at the same time it's just something that you should",
    "start": "1401120",
    "end": "1408080"
  },
  {
    "text": "probably be looking at maybe you found something where someone's doing some really crazy things uh but this is just",
    "start": "1408080",
    "end": "1413159"
  },
  {
    "text": "a great indicator that you should really look at this file so once we injected illegal op",
    "start": "1413159",
    "end": "1420880"
  },
  {
    "start": "1417000",
    "end": "1417000"
  },
  {
    "text": "codes and the verifier barfed we're thinking okay well what's the next step what if we inject real good code or",
    "start": "1420880",
    "end": "1427960"
  },
  {
    "text": "somewhat good code we're going to try and reference an object that doesn't actually exist uh so as we said there was the string table so if you're",
    "start": "1427960",
    "end": "1434720"
  },
  {
    "text": "loading a string and you do like a con string load you're saying I want string from position one well if you only have",
    "start": "1434720",
    "end": "1442240"
  },
  {
    "text": "10 strings what happens if we start referencing something that's string 12 14 15 this should die um most tools",
    "start": "1442240",
    "end": "1449880"
  },
  {
    "text": "should handle this but we just wanted to see what would happen so boxy barfs all over the place it's just basically like",
    "start": "1449880",
    "end": "1456480"
  },
  {
    "text": "I do not know where to go I'm indexing and I'm looking inside my array and my array is not that big uh so boxal check",
    "start": "1456480",
    "end": "1464159"
  },
  {
    "text": "Dex to jar same thing it's just saying I don't know what you're referencing and why you're referencing that please stop",
    "start": "1464159",
    "end": "1469600"
  },
  {
    "text": "hurting me um Andro guard handles it a little bit better mainly because or the way I've used it you're going to attempt",
    "start": "1469600",
    "end": "1476399"
  },
  {
    "text": "to decompile that specific class uh but at the same time that class uh will then",
    "start": "1476399",
    "end": "1481640"
  },
  {
    "text": "make Andro God die and again back to uh dead it",
    "start": "1481640",
    "end": "1486960"
  },
  {
    "text": "basically sits there it's looking for it and it's looking for it and it it'll do this probably until you reboot your",
    "start": "1486960",
    "end": "1493360"
  },
  {
    "text": "machine or kill the process um I Pro did something really really interesting uh it's you know it's",
    "start": "1493360",
    "end": "1500480"
  },
  {
    "text": "not bad what they did but they just basically said I have no idea where you're pointing at I'm going to point to zero so it was a it was an interesting",
    "start": "1500480",
    "end": "1506960"
  },
  {
    "text": "thing on Ida's part so this this really isn't hard to fix either you can basically just say",
    "start": "1506960",
    "end": "1512159"
  },
  {
    "text": "all right well I know what my string tables like I know what my uh method table's like I know what the bounds are",
    "start": "1512159",
    "end": "1517399"
  },
  {
    "text": "if someone ask for something outside of that um I probably shouldn't let them do that and you know if that index that",
    "start": "1517399",
    "end": "1524120"
  },
  {
    "text": "you're asking for is bigger than that table size let's alert on this this is definitely another thing that someone's trying to mess with you or your tool is",
    "start": "1524120",
    "end": "1530799"
  },
  {
    "text": "horribly broken so you should definitely take a look at",
    "start": "1530799",
    "end": "1535720"
  },
  {
    "text": "this so as I said a lot of people use Dex jar I feel like I I talk to a lot of",
    "start": "1535960",
    "end": "1541320"
  },
  {
    "start": "1536000",
    "end": "1536000"
  },
  {
    "text": "people and they're just like that's my go-to Dex jar is my homie like we're just we hang out all the time and we",
    "start": "1541320",
    "end": "1546360"
  },
  {
    "text": "just play stuff you know it's cool um so I just wanted to break that tool just to try and dispell a meth that you can just use all of your own Java tools I really",
    "start": "1546360",
    "end": "1553279"
  },
  {
    "text": "think it's necess necessary that you should be looking at dvic specific tools um while this is one a lot of people are",
    "start": "1553279",
    "end": "1560000"
  },
  {
    "text": "just using this as a segue to then use just Java analysis",
    "start": "1560000",
    "end": "1565640"
  },
  {
    "text": "tools so uh my limited understanding of what Jad and J GUI does is it's",
    "start": "1565960",
    "end": "1571480"
  },
  {
    "text": "essentially looking for uh patterns that it's seen so that it can see that okay",
    "start": "1571480",
    "end": "1576720"
  },
  {
    "text": "so the Java C compiler basically took this and this is a while loop this is a",
    "start": "1576720",
    "end": "1582240"
  },
  {
    "text": "for Loop so this is why you get those um actually decently readable things um when you're using using the D compiler",
    "start": "1582240",
    "end": "1589200"
  },
  {
    "text": "and then Dex jar translates that to literal op codes it's not actually changing those patterns and since the",
    "start": "1589200",
    "end": "1594520"
  },
  {
    "text": "delic um compiler uses different patterns for uh mobile uses it's going",
    "start": "1594520",
    "end": "1600840"
  },
  {
    "text": "to be a pattern that most of the time Jad or JD gy doesn't actually know so this results in really funky looking",
    "start": "1600840",
    "end": "1607200"
  },
  {
    "text": "code where oh there's the begin of my function and then there's a return and then there's all the rest of the stuff and clearly that's not valid Java and",
    "start": "1607200",
    "end": "1614120"
  },
  {
    "text": "that's really bad to look at so you end up seeing a lot of stuff like this too where if they just don't understand",
    "start": "1614120",
    "end": "1619799"
  },
  {
    "text": "what's going on or you're doing things that are legal in dvic world but not in Java world you just get all this awesome",
    "start": "1619799",
    "end": "1626039"
  },
  {
    "text": "window that just doesn't help at all so one thing that we just looked at it was really easy to figure out how can",
    "start": "1626039",
    "end": "1632960"
  },
  {
    "text": "I get uh like JD GUI to not work well Jad actually handles this pretty well but uh basically throw a couple",
    "start": "1632960",
    "end": "1639279"
  },
  {
    "text": "exceptions the way the exceptions are then compiled down to the dvic level um makes it so that a a Java decompiler",
    "start": "1639279",
    "end": "1646559"
  },
  {
    "text": "gets a little bit confused used by it um another really interesting example",
    "start": "1646559",
    "end": "1652080"
  },
  {
    "text": "that I found is is actually in the the Box repository Jesus Freak did this one and I just completely stole it",
    "start": "1652080",
    "end": "1657679"
  },
  {
    "text": "essentially this is a recursive um Tri catch function so I've circled the first",
    "start": "1657679",
    "end": "1664399"
  },
  {
    "text": "Tri block and that's pointing to the catch block and inside the catch block",
    "start": "1664399",
    "end": "1669720"
  },
  {
    "text": "is actually the second Tri block which is pointing to its own catch block so",
    "start": "1669720",
    "end": "1675919"
  },
  {
    "text": "what's going to happen is you're going to throw an ception and you're going to catch throw catch throw catch throw and",
    "start": "1675919",
    "end": "1681480"
  },
  {
    "text": "it's it's this infinite weirdness that is just not going to work well if you ever execute this um I'm not 100% sure",
    "start": "1681480",
    "end": "1688399"
  },
  {
    "text": "if you could ever actually write this in Java code you could probably do something with a recursive function but it's not going to end up being the same",
    "start": "1688399",
    "end": "1694120"
  },
  {
    "text": "uh but this is valid Del code so you we're taking a look at this and uh you",
    "start": "1694120",
    "end": "1699360"
  },
  {
    "text": "like I said you're not going to want to actually execute this but this is going to be valid code to have in one of your",
    "start": "1699360",
    "end": "1704919"
  },
  {
    "text": "classes so if you did it like a dead code segment this would be great one to put in there so the interesting thing is",
    "start": "1704919",
    "end": "1711039"
  },
  {
    "text": "you have Jad that looks at this and it's just like hey um you threw some exceptions and that's it I'm just going",
    "start": "1711039",
    "end": "1716720"
  },
  {
    "text": "to stop processing after that um JD is just you know chugging away there and",
    "start": "1716720",
    "end": "1722279"
  },
  {
    "text": "it's just no no no good output uh we we got Ida and what's interesting is it sees the exceptions",
    "start": "1722279",
    "end": "1730000"
  },
  {
    "text": "they it's not actually going to connect those with any control flow so it's going to be pretty annoying to look at uh and then actually we can see that",
    "start": "1730000",
    "end": "1736120"
  },
  {
    "text": "it's ignored our other op code So you you're going to have to go in there and manually actually tell it like start looking at these op codes and",
    "start": "1736120",
    "end": "1742320"
  },
  {
    "text": "start processing this um it it's you know if you've used Ida for more than a",
    "start": "1742320",
    "end": "1747640"
  },
  {
    "text": "while you probably know the Hut Key to fix this but it's still a little annoying so this is going to actually be",
    "start": "1747640",
    "end": "1753279"
  },
  {
    "text": "a lot harder to detect automatically you're going to have to do something like pattern matching um or or some sort",
    "start": "1753279",
    "end": "1758919"
  },
  {
    "text": "like that box works fine on this so if you had like a boxal parsing engine it would work fine but again if you're",
    "start": "1758919",
    "end": "1764440"
  },
  {
    "text": "using those those actual Java DC compilers this might really confuse the heck out of",
    "start": "1764440",
    "end": "1770000"
  },
  {
    "start": "1770000",
    "end": "1770000"
  },
  {
    "text": "it so earlier we saw in the link lock section that box died just because of",
    "start": "1770279",
    "end": "1775679"
  },
  {
    "text": "something simple that hasn't been implemented yet so are there any other quick wins like that and we basically",
    "start": "1775679",
    "end": "1781399"
  },
  {
    "text": "saw this just looking through the header if header size isn't what I expect I'm going to barf so basically we're going",
    "start": "1781399",
    "end": "1788120"
  },
  {
    "text": "to just do a header size attack and see what we can do so if we're looking at the the deck header we basically have",
    "start": "1788120",
    "end": "1794039"
  },
  {
    "text": "you know the magic we have a couple check sums and signatures that are used for verification to make sure we haven't modified our file um the header size an",
    "start": "1794039",
    "end": "1801440"
  },
  {
    "text": "Indian tag you know what is this is a reverse Indian normal Indian and then we have that actual section that was used",
    "start": "1801440",
    "end": "1807279"
  },
  {
    "text": "for the link lock and then these are all the offsets again for each other section that's in there so since it's always",
    "start": "1807279",
    "end": "1814720"
  },
  {
    "text": "expected to have um 112 bytes in there let's just increase it let's increase it",
    "start": "1814720",
    "end": "1819919"
  },
  {
    "text": "by four bytes so the concept is basically let's just increase that and then we're going to have extra junk in",
    "start": "1819919",
    "end": "1826200"
  },
  {
    "text": "there you know put nothing in there maybe something who knows so it should be really easy to",
    "start": "1826200",
    "end": "1832480"
  },
  {
    "text": "implant um you know change one field from 112 to 116 see how that works uh",
    "start": "1832480",
    "end": "1840240"
  },
  {
    "text": "and basically we're going to fix all the offsets after that and you know the the offset should just be the ones in the",
    "start": "1840240",
    "end": "1845559"
  },
  {
    "text": "headers hopefully completely wrong it was a really bad assumption uh and it ends up creating a lot more work",
    "start": "1845559",
    "end": "1851679"
  },
  {
    "text": "basically this is when uh my proof of concept went from about 100 lines and it bloomed up to I don't know like 2,000",
    "start": "1851679",
    "end": "1857840"
  },
  {
    "text": "1,000 lines because essentially everything is not a relative offset which I was hoping it was going to be it",
    "start": "1857840",
    "end": "1863919"
  },
  {
    "text": "is a offset some from the beginning of the file so if you move things two bytes every single offset in the delic file is",
    "start": "1863919",
    "end": "1870960"
  },
  {
    "text": "going to have to be offset by those two bytes otherwise things just go really funky and they're going to be pointing to wrong places wrong sections all that",
    "start": "1870960",
    "end": "1877799"
  },
  {
    "text": "kind of stuff so after many many hours later and",
    "start": "1877799",
    "end": "1882880"
  },
  {
    "text": "lots of caffeine basically we end up having this is what the daer looks like so in the red that should be 70 but",
    "start": "1882880",
    "end": "1889240"
  },
  {
    "text": "we've increased that and then in the blue you can see that we just have you know some empty bites just zeros didn't",
    "start": "1889240",
    "end": "1894279"
  },
  {
    "text": "really care what we put in there and then we see we're running this through box Molly and it dies on us it basically",
    "start": "1894279",
    "end": "1900080"
  },
  {
    "text": "tells you why it's just not what I expect so I don't know what's going on so great that's that's really easy to",
    "start": "1900080",
    "end": "1905720"
  },
  {
    "text": "fix but it probably took longer to implement than it will be to fix it's basically instead of throwing runtime exception system out runtime exception",
    "start": "1905720",
    "end": "1913799"
  },
  {
    "text": "was almost happening but we're not going to do that anymore uh but what are the cool things that we could do with this",
    "start": "1913799",
    "end": "1919360"
  },
  {
    "text": "we could hide data in there and this data is actually going to be mapped into memory so if we can expand that header",
    "start": "1919360",
    "end": "1925320"
  },
  {
    "text": "we could do probably a lot of cool things I mean just think of the jokes I should probably have on this slide like",
    "start": "1925320",
    "end": "1931279"
  },
  {
    "text": "yo dog deck inside of a deck or something like that but that's just too much work so the next concept that we",
    "start": "1931279",
    "end": "1938399"
  },
  {
    "start": "1935000",
    "end": "1935000"
  },
  {
    "text": "had and my uh my coworker name this deception because basically we're going",
    "start": "1938399",
    "end": "1943600"
  },
  {
    "text": "to take the header we're going to increase it a lot and then we're going to a DEX file at the bottom of the",
    "start": "1943600",
    "end": "1948919"
  },
  {
    "text": "header so basically we're going to have a DEX file and then we're going to have a DEX file inside of it so this was",
    "start": "1948919",
    "end": "1954080"
  },
  {
    "text": "actually really easy to implement once we had all the file format um shifting and whatnot so we basically wrote a",
    "start": "1954080",
    "end": "1961159"
  },
  {
    "text": "quick Android application which due to the awesomeness that is Android we can actually access private methods and tell",
    "start": "1961159",
    "end": "1967760"
  },
  {
    "text": "them that they're no longer private and start using them um in ice cream sandwich I believe it's Ice Cream",
    "start": "1967760",
    "end": "1972840"
  },
  {
    "text": "Sandwich they started having this uh this awesome function which B basically lets us load in a DEX file from a bite",
    "start": "1972840",
    "end": "1980000"
  },
  {
    "text": "array so I quickly implemented I'm just going to load this from my own resource file uh but you could do this from",
    "start": "1980000",
    "end": "1985919"
  },
  {
    "text": "Reading from memory you could do this from Reading from the delet cache anywhere you'd like anywhere you have",
    "start": "1985919",
    "end": "1991360"
  },
  {
    "text": "that that Dex file and basically just reflectively call this function and you're going to get a DEX file uh which",
    "start": "1991360",
    "end": "1996840"
  },
  {
    "text": "is just a Java object and you can start referencing that um the same way you would reference if you loaded an extra",
    "start": "1996840",
    "end": "2002960"
  },
  {
    "text": "uh jar in Java so cool we just basically created the first Packer SL",
    "start": "2002960",
    "end": "2009000"
  },
  {
    "text": "encryptor um and this is what the output looks like this is O editor so again I stress that you should always use this",
    "start": "2009000",
    "end": "2015159"
  },
  {
    "text": "tool if you ever run crowns or anything like this um no I'm not getting paid to say that either but basically you can",
    "start": "2015159",
    "end": "2020519"
  },
  {
    "text": "see the Dex header is not what we expect that is not ox7 um it's a pretty big",
    "start": "2020519",
    "end": "2025840"
  },
  {
    "text": "header and you can see I did this really lame exor with D1 cuz you just see D1 in",
    "start": "2025840",
    "end": "2031120"
  },
  {
    "text": "there all the time but uh basically we just made you know a little weak encryptor so the results from this are I",
    "start": "2031120",
    "end": "2038000"
  },
  {
    "text": "think pretty cool so you're going to break box Molly until they fix that which the fix is I believe imminent um",
    "start": "2038000",
    "end": "2044200"
  },
  {
    "text": "but you're basically going to slow down a lot of automated tools cuz this is going to be something that you know if I",
    "start": "2044200",
    "end": "2050240"
  },
  {
    "text": "exore it with this or that it's going to change how you're going to have to unpack it uh what happens if you know I",
    "start": "2050240",
    "end": "2056158"
  },
  {
    "text": "didn't put a DEX file in there you could put an APK file in there you could put pretty much anything you want you could just put some images anything it doesn't",
    "start": "2056159",
    "end": "2062440"
  },
  {
    "text": "matter but this way all these tools are going to actually follow the rules of the D format and they're just going to",
    "start": "2062440",
    "end": "2067679"
  },
  {
    "text": "skip over that data so nobody's really going to die on that anymore but the verifier is not going to die on that and",
    "start": "2067679",
    "end": "2072960"
  },
  {
    "text": "you're going to be able to load this on an actual device as well so you know like I said if it's",
    "start": "2072960",
    "end": "2078839"
  },
  {
    "text": "encrypted that's going to make it a little harder for uh someone this is going to be definitely like a manual process uh you could like I said you",
    "start": "2078839",
    "end": "2085520"
  },
  {
    "text": "could zip it up zip a de now we have you know a packer for real um and then you",
    "start": "2085520",
    "end": "2090599"
  },
  {
    "text": "could even throw native code in there this is the possibilities are essentially endless at this",
    "start": "2090599",
    "end": "2095878"
  },
  {
    "text": "point so the nice part of this hiding technique is it's super easy to detect",
    "start": "2095879",
    "end": "2101960"
  },
  {
    "text": "if it's not what we expect alert someone is clearly doing something to mess with people uh or your system or your",
    "start": "2101960",
    "end": "2108640"
  },
  {
    "text": "analysis or they're just doing cool stuff and you should just check it out because they're probably doing something really cool um but uh you know it the",
    "start": "2108640",
    "end": "2115800"
  },
  {
    "text": "reason the header file lets you do this is for future compatibility so if you see this you might also just discovered",
    "start": "2115800",
    "end": "2121720"
  },
  {
    "text": "you know I don't know the first keyline binary or something like that and that'd be kind of cool to look at anyway",
    "start": "2121720",
    "end": "2127880"
  },
  {
    "start": "2127000",
    "end": "2127000"
  },
  {
    "text": "um so this is one that I actually did not end up implementing so this is completely open to interpretation uh",
    "start": "2127880",
    "end": "2135520"
  },
  {
    "text": "basically there's an Indian tag and it's always set the same way and if you look at the way that all the tools are",
    "start": "2135520",
    "end": "2141400"
  },
  {
    "text": "actually all the open source tools at least that are parsing these files uh what happens if you do reverse endian",
    "start": "2141400",
    "end": "2148320"
  },
  {
    "text": "well they all barf and nobody's actually done this yet I don't really want to do that cuz that's a lot of work for very",
    "start": "2148320",
    "end": "2154480"
  },
  {
    "text": "little gain um but basically you could break all the tools that way and when this is loaded onto a device that doesn't support reverse Indian uh",
    "start": "2154480",
    "end": "2161440"
  },
  {
    "text": "Android is just basically going to automatically Swap all those bites back and map it to an odex file which will",
    "start": "2161440",
    "end": "2166560"
  },
  {
    "text": "just basically uh run properly on your device so now we're going to dip into",
    "start": "2166560",
    "end": "2173800"
  },
  {
    "text": "anti- ulators um since I had gotten this uh talk accepted there's been a bunch of",
    "start": "2173800",
    "end": "2179520"
  },
  {
    "text": "interesting things uh about Bouncer and whatnot which is one of the emulators people want to get by uh so I I didn't",
    "start": "2179520",
    "end": "2185200"
  },
  {
    "text": "want to go too in depth over that I think people have covered this subject pretty well um it's basically you know",
    "start": "2185200",
    "end": "2191359"
  },
  {
    "text": "an emulator is the qmu so there's a lot of different ways to detect that but just looking at some Android specific",
    "start": "2191359",
    "end": "2197280"
  },
  {
    "text": "things uh you know I've I've seen a couple people uh taint Droid basically is one of the big projects that runs uh",
    "start": "2197280",
    "end": "2204000"
  },
  {
    "text": "Dynamic analysis and tries to do taint tracking and whatnot and their recommendations were you know set an Android ID change your IMI change your",
    "start": "2204000",
    "end": "2210720"
  },
  {
    "text": "phone uh your phone number so that way when people are requesting these that they're just not going to throw null out",
    "start": "2210720",
    "end": "2215960"
  },
  {
    "text": "there and it's clear that those would be emulators but I haven't seen anything other than that on how how can I make my",
    "start": "2215960",
    "end": "2222000"
  },
  {
    "text": "emulator better so basically there's this awesome tool called get prop it's basically get a system property um and",
    "start": "2222000",
    "end": "2229079"
  },
  {
    "text": "then what we see when we do a get prop is you know we see qmu uh Ser uh",
    "start": "2229079",
    "end": "2234440"
  },
  {
    "text": "settings and whatnot we see that the radio driver is emulated it's not an",
    "start": "2234440",
    "end": "2240240"
  },
  {
    "text": "actual full uh uh it's not an actual full um radio driver and then we also see different things like qmu fake",
    "start": "2240240",
    "end": "2247400"
  },
  {
    "text": "camera like oh okay well that's probably a good indication that you're you're not on a real device cuz there's qmu",
    "start": "2247400",
    "end": "2252560"
  },
  {
    "text": "settings all everywhere um you know it's just take your pick there's so many things out there that if someone hasn't",
    "start": "2252560",
    "end": "2258599"
  },
  {
    "text": "actually tried to make it look like a real device there's just so many interesting things that you can just pick up on um and what makes it easier",
    "start": "2258599",
    "end": "2267200"
  },
  {
    "text": "to avoid emulators is you can also do the inverse you can basically just say I don't want to look to see if this is an",
    "start": "2267200",
    "end": "2273560"
  },
  {
    "text": "emulator I want to see if this is a real device so most devices that people use are running uh Google software so like",
    "start": "2273560",
    "end": "2282160"
  },
  {
    "text": "Google proprietary things for the Google experienced devices so if we can look at you know Ro URL legal that's one that's",
    "start": "2282160",
    "end": "2289200"
  },
  {
    "text": "used by um actual Google Android applications uh and it's usually set there on a real device so if you look",
    "start": "2289200",
    "end": "2295520"
  },
  {
    "text": "for something like this or a specific fingerprint or a build ID you can then usually determine that you know they",
    "start": "2295520",
    "end": "2301560"
  },
  {
    "text": "could fake this but at the same time a lot of people haven't gone through the effort to actually proofing their",
    "start": "2301560",
    "end": "2306599"
  },
  {
    "text": "emulators out so how do you use get prop though usually most people just do ad",
    "start": "2306599",
    "end": "2311720"
  },
  {
    "text": "shell and then they use get prop and this is again where that awesome reflection comes to the win um it's a",
    "start": "2311720",
    "end": "2316960"
  },
  {
    "text": "private method but it's still there so you can basically just say I I want this uh you know system properties yet and",
    "start": "2316960",
    "end": "2323440"
  },
  {
    "text": "then just let me access this and there you go you have a really really easy way to detect",
    "start": "2323440",
    "end": "2328839"
  },
  {
    "text": "emulators um so this is this is pretty easy to flag statically uh it's again you know you're going to look for a",
    "start": "2328839",
    "end": "2335520"
  },
  {
    "text": "reflective method uh again I don't think that that's the best thing you shouldn't just say hey if anything comes in with",
    "start": "2335520",
    "end": "2340560"
  },
  {
    "text": "reflection we're just going to flag it that's going to lead in lots of false positives um you could do a couple",
    "start": "2340560",
    "end": "2346040"
  },
  {
    "text": "interesting things I mean you could basically go the Tain Droid route route where you basically uh um you taint the",
    "start": "2346040",
    "end": "2353359"
  },
  {
    "text": "function and you're going to actually intercept it and then you could change the output of it you could actually do an LD preload on this there's actually a",
    "start": "2353359",
    "end": "2359520"
  },
  {
    "text": "nice little uh example of an LD preload hook um written by a a guy in France and it",
    "start": "2359520",
    "end": "2366599"
  },
  {
    "text": "was actually pretty cool to look at um so you know nobody's falling",
    "start": "2366599",
    "end": "2372280"
  },
  {
    "text": "asleep yet that I can tell but uh hopefully you actually want to go and play with the tool so I created this",
    "start": "2372280",
    "end": "2379280"
  },
  {
    "text": "it's going to be uh under GPL it'll be on my GitHub page soon I don't really want to push it on this network so like",
    "start": "2379280",
    "end": "2384520"
  },
  {
    "text": "many other presenters as soon as I get to a better Network I'll push my slides and both this um you know uh be wary",
    "start": "2384520",
    "end": "2391520"
  },
  {
    "text": "about the code it was a proof of concept that I tried to do as fast as humanly possible um I also did it kind of like a",
    "start": "2391520",
    "end": "2397760"
  },
  {
    "text": "uh hack noon project and I wanted to improve some Ruby skills I probably just would did some very detrimental things",
    "start": "2397760",
    "end": "2404079"
  },
  {
    "text": "to my Ruby skills cuz heavy file manipulation is kind of weird um if any of you guys are awesome at Ruby you",
    "start": "2404079",
    "end": "2409440"
  },
  {
    "text": "might hate me for looking at that code uh but so what have we actually learned um parsing Dex files is definitely",
    "start": "2409440",
    "end": "2415520"
  },
  {
    "text": "something that I feel like if you're looking in the Android space you should at least wrap your head around this uh",
    "start": "2415520",
    "end": "2421160"
  },
  {
    "text": "don't rely on all the tools that are out there there're people aren't you're not paying those people to improve the tools",
    "start": "2421160",
    "end": "2427319"
  },
  {
    "text": "so we got to help them we got to improve the tools we got to understand the file format um there's definitely some really interesting things that people can start",
    "start": "2427319",
    "end": "2433760"
  },
  {
    "text": "doing you know take the lessons learned from uh PC malware people are going to abuse this stuff so we need to be able",
    "start": "2433760",
    "end": "2439920"
  },
  {
    "text": "to anticipate this and actually um you know start looking at it before those bad guys",
    "start": "2439920",
    "end": "2446319"
  },
  {
    "text": "do um and then just you know on a little Podium uh John L uh I just murdered his",
    "start": "2446319",
    "end": "2452240"
  },
  {
    "text": "name but uh he he made an awesome template that I have a bunch of screenshots for on editor again they're",
    "start": "2452240",
    "end": "2458560"
  },
  {
    "text": "not paying me but maybe they should um and then also just on the Soap Box again",
    "start": "2458560",
    "end": "2463599"
  },
  {
    "text": "uh just because something sends SMS please stop writing papers that all things that do that are bad um you don't",
    "start": "2463599",
    "end": "2469040"
  },
  {
    "text": "need machine learning to tell anyone that sms's are bad but you know let's let's step up the actual research and",
    "start": "2469040",
    "end": "2476079"
  },
  {
    "text": "let's let's look at things a little bit more like let's look at the context of things and whatnot and let's just you",
    "start": "2476079",
    "end": "2481480"
  },
  {
    "text": "know don't be lazy and you know again have fun Break Stuff let's push those back boundaries and let's just get there",
    "start": "2481480",
    "end": "2488079"
  },
  {
    "text": "before the bad guys do so thank you and if uh you guys have any questions I can take them now or",
    "start": "2488079",
    "end": "2495800"
  },
  {
    "text": "later sure you can talk to me later then I've got one question for you for the uh",
    "start": "2501599",
    "end": "2507920"
  },
  {
    "text": "for the reverse Indian did you you said you didn't actually try it but then you said it would work on the device so how",
    "start": "2507920",
    "end": "2513079"
  },
  {
    "text": "do you know so if you look we got a um so we can look at all the code and the",
    "start": "2513079",
    "end": "2518160"
  },
  {
    "text": "way uh all the code is actually set up is it goes and it looks at that tag and then it basically says if this isn't",
    "start": "2518160",
    "end": "2524400"
  },
  {
    "text": "Indian swap every single other bite and while I haven't seen that actually in",
    "start": "2524400",
    "end": "2529480"
  },
  {
    "text": "use um I believe that they wouldn't push that horrible of code that I mean it's all there you can take a look at it like",
    "start": "2529480",
    "end": "2535599"
  },
  {
    "text": "I said I haven't tried it but it should actually Swap all the",
    "start": "2535599",
    "end": "2540800"
  },
  {
    "text": "bites anyone else",
    "start": "2542160",
    "end": "2548160"
  },
  {
    "text": "um so I I believe the question was essentially that uh the zip file will",
    "start": "2558280",
    "end": "2564559"
  },
  {
    "text": "the zip files actually accept something that have the uh extra bytes exort in it give me a",
    "start": "2564559",
    "end": "2572559"
  },
  {
    "text": "second uh is it really easy to produce zip file files uh in the way you describe like uh you Zord it with",
    "start": "2572839",
    "end": "2579800"
  },
  {
    "text": "something and you had both the zip files like the Zord file and the original file both of valid files and both were",
    "start": "2579800",
    "end": "2586040"
  },
  {
    "text": "unzipping to different contents is it really easy to do that um so I'm not uh",
    "start": "2586040",
    "end": "2591599"
  },
  {
    "text": "100% sure it they definitely did it um I don't know how hard it would be I don't know the zip file format too well it",
    "start": "2591599",
    "end": "2598000"
  },
  {
    "text": "looks like what they did is they basically put it into some padding which would normally be there and then if we look at that slide again basically you",
    "start": "2598000",
    "end": "2604040"
  },
  {
    "text": "see that uh when you unzip it it was basically complaining that there's something there but it's skipping it so",
    "start": "2604040",
    "end": "2609599"
  },
  {
    "text": "I'm not sure how easy that is to do but it's definitely a viable Target to do and that sample is actually on",
    "start": "2609599",
    "end": "2616480"
  },
  {
    "text": "contagio so if if you're interested in looking at that it's all there and whatnot I'd love to find out if that was",
    "start": "2616480",
    "end": "2622079"
  },
  {
    "text": "easy or hard to do though anything else all right thank you",
    "start": "2622079",
    "end": "2630480"
  },
  {
    "text": "guys",
    "start": "2631960",
    "end": "2634960"
  }
]