[
  {
    "text": "all right so afternoon everyone uh thanks for having me here and also thanks to Hebra team for the opportunity",
    "start": "2480",
    "end": "9840"
  },
  {
    "text": "um to have me present my research that I have been doing for the last eight months i'm excited to share this",
    "start": "9840",
    "end": "16240"
  },
  {
    "text": "research with you and as the title says I'm here to explore if the ISPs and the resident gateway they gave out to you",
    "start": "16240",
    "end": "22880"
  },
  {
    "text": "are safe",
    "start": "22880",
    "end": "26119"
  },
  {
    "text": "uh let me do a little bit of introduce of myself first i'm Ton Yen uh I'm an embroidered researcher working at TX1",
    "start": "32559",
    "end": "39360"
  },
  {
    "text": "networks a company focused on industrial network security and my work is to basically",
    "start": "39360",
    "end": "46480"
  },
  {
    "text": "break everything i have several expertise in numerous fields uh I have multiple presentations around and I feel",
    "start": "46480",
    "end": "54079"
  },
  {
    "text": "it's worth to mention that it's my honor to present here at the stage of the bracket Europe for",
    "start": "54079",
    "end": "61039"
  },
  {
    "text": "time so let's get started uh as the title says uh we're talking about residental gateway today and what is a",
    "start": "62039",
    "end": "69040"
  },
  {
    "text": "residental gateway a residental gateway is something that bridges your premise to the internet um and there are uh there",
    "start": "69040",
    "end": "76960"
  },
  {
    "text": "are multiple kinds of devices that can to be called residental gateway but today we're only discussing what is",
    "start": "76960",
    "end": "82320"
  },
  {
    "text": "provided to you uh from the service provider when you sign up for fixed internet",
    "start": "82320",
    "end": "88280"
  },
  {
    "text": "service and why is today's topic important and why we talk about it today",
    "start": "88280",
    "end": "93680"
  },
  {
    "text": "so according to a survey 79% of household in the world has access to",
    "start": "93680",
    "end": "99439"
  },
  {
    "text": "some sort of fixed internet which means 79% of household may have a residual",
    "start": "99439",
    "end": "106360"
  },
  {
    "text": "gateway and from numerous news reports that I know they are they could be",
    "start": "106360",
    "end": "112320"
  },
  {
    "text": "lucrative targets for adversaries I have not seen a report against gateways",
    "start": "112320",
    "end": "117600"
  },
  {
    "text": "especially the ones that are provided to you by the service providers so I think the audiences here",
    "start": "117600",
    "end": "125600"
  },
  {
    "text": "will tend to ask a question that is how many residental gateways are there on",
    "start": "125600",
    "end": "131400"
  },
  {
    "text": "earth the answer is could be at least 150 53 million and why and how do I know",
    "start": "131400",
    "end": "138319"
  },
  {
    "text": "that well first I have a beautiful world map for you here to show you uh the",
    "start": "138319",
    "end": "144400"
  },
  {
    "text": "approximate concentration of residual gateways in the road and I will show you the reason why would I know that later",
    "start": "144400",
    "end": "151200"
  },
  {
    "text": "in the slides but let's see about the past",
    "start": "151200",
    "end": "158319"
  },
  {
    "text": "cases about people being able to find bugs in either service providers room",
    "start": "158319",
    "end": "163680"
  },
  {
    "text": "management expert or on the residental gateway themselves there are actually research done by Shahel Peter Gaseier",
    "start": "163680",
    "end": "170400"
  },
  {
    "text": "and Sam Curry in the coming years they either find bugs in the remote manager expat or on the resale gateway",
    "start": "170400",
    "end": "177760"
  },
  {
    "text": "themselves and allowing one to take control of many",
    "start": "177760",
    "end": "183800"
  },
  {
    "text": "devices and the reason I'm doing this research is roughly a year ago I took a",
    "start": "183800",
    "end": "189760"
  },
  {
    "text": "look inside a service provider and um their gateway and their remote",
    "start": "189760",
    "end": "195280"
  },
  {
    "text": "management expert it turns out to be not very good and becomes a very sad story uh which end",
    "start": "195280",
    "end": "201760"
  },
  {
    "text": "ups with me being able to control over four million devices so I have expanded that research",
    "start": "201760",
    "end": "210319"
  },
  {
    "text": "into 14 devices across 11 ISPs in nine countries as a brief",
    "start": "210319",
    "end": "216879"
  },
  {
    "text": "conclusion I found out that most resol gateways are not very safe neither the",
    "start": "216879",
    "end": "222400"
  },
  {
    "text": "service provider behind them and I will elaborate why today i have picked up some cases here",
    "start": "222400",
    "end": "229360"
  },
  {
    "text": "today to present them to the audiences here they are most likely interesting to the audiences and the other cases will",
    "start": "229360",
    "end": "235840"
  },
  {
    "text": "be addressed via the white paper and write ups will be raising later so we'll",
    "start": "235840",
    "end": "240879"
  },
  {
    "text": "be demonstrating some cases one is to get started to how to study a resto",
    "start": "240879",
    "end": "246879"
  },
  {
    "text": "gateway and for that case we can expand to how to study the remote management aspect provided by the provider and we",
    "start": "246879",
    "end": "254080"
  },
  {
    "text": "can share case where um an OES implementation of trust zone is able to",
    "start": "254080",
    "end": "259680"
  },
  {
    "text": "be bypassed and another one is how to find bugs in a very popular vendor's SDK",
    "start": "259680",
    "end": "269320"
  },
  {
    "text": "and uh why does resol gateway warrants such research so uh let's take a look",
    "start": "272000",
    "end": "279040"
  },
  {
    "text": "about how modern infrastructure is laid out for example in the electricity uh in the electricity generation sector uh",
    "start": "279040",
    "end": "286240"
  },
  {
    "text": "every aspect of that sector actually needs some kind of telecommunication to work and I can already see there were",
    "start": "286240",
    "end": "293360"
  },
  {
    "text": "past cases of adversaries trying to take out other aspects inside critical infrastructure sector via attacking the",
    "start": "293360",
    "end": "300960"
  },
  {
    "text": "telecommunication sector so let's get started let's see how should one begin in",
    "start": "300960",
    "end": "308000"
  },
  {
    "text": "studying how the resto gateway and every protocol in between the provider and the",
    "start": "308000",
    "end": "313199"
  },
  {
    "text": "gateway themselves and on the ISP side so these are numerous protocol standards",
    "start": "313199",
    "end": "318720"
  },
  {
    "text": "and some of the brands uh either the OEMs or the stock vendors that you could",
    "start": "318720",
    "end": "324080"
  },
  {
    "text": "refer to and you could start from there but I have a better one i have created a",
    "start": "324080",
    "end": "329520"
  },
  {
    "text": "wonder called graph uh telling you uh about what happens between the provider and you",
    "start": "329520",
    "end": "336080"
  },
  {
    "text": "um on on the premise uh on your premises uh there should be a residual gateway if",
    "start": "336080",
    "end": "341280"
  },
  {
    "text": "you have some sort of internet access and will be indicated by the uh the",
    "start": "341280",
    "end": "346639"
  },
  {
    "text": "rectangle RG which which stands for resident gateway here on the right hand side um and there are numerous devices",
    "start": "346639",
    "end": "353960"
  },
  {
    "text": "between between the internet and you and what are these devices on the most left",
    "start": "353960",
    "end": "360720"
  },
  {
    "text": "hand side there is an internet exchange inside the provider it most likely comprised of many network switches and",
    "start": "360720",
    "end": "368000"
  },
  {
    "text": "there are there are device called brass which is responsible for managing the subscribers and OD which focus on",
    "start": "368000",
    "end": "375039"
  },
  {
    "text": "converting anything to Gong and using that Gong local to connect to you but we",
    "start": "375039",
    "end": "380400"
  },
  {
    "text": "are only focus uh focusing on two aspects inside this chart today which is",
    "start": "380400",
    "end": "386880"
  },
  {
    "text": "the residential gateway and the remote management aspect from the provider and why is",
    "start": "386880",
    "end": "392759"
  },
  {
    "text": "that so uh obviously the residential gateway is the only thing that expose",
    "start": "392759",
    "end": "397840"
  },
  {
    "text": "your premise to the internet side because you obviously need that thing to connect to the",
    "start": "397840",
    "end": "404360"
  },
  {
    "text": "network for the remote management expert um this is a bit complicated because the",
    "start": "404360",
    "end": "410400"
  },
  {
    "text": "remote management mast you could imagine it like a server that is able to somehow",
    "start": "410400",
    "end": "416560"
  },
  {
    "text": "push configuration files to a residential gateway through the internet so should you be able to",
    "start": "416560",
    "end": "424560"
  },
  {
    "text": "somehow compromise a remote management aspect for a provider uh you're you will be able to take control of the",
    "start": "424560",
    "end": "431840"
  },
  {
    "text": "residential gateways under that provider and a way for me to perform this research uh across many devices is",
    "start": "431840",
    "end": "439599"
  },
  {
    "text": "I tend to focus on the residual gateway themselves i know the gateway themselves are already well connected with many",
    "start": "439599",
    "end": "446000"
  },
  {
    "text": "attack surfaces available and I will start from the hardware of such devices",
    "start": "446000",
    "end": "451440"
  },
  {
    "text": "and I I have bring some of the devices that I have started here um from those",
    "start": "451440",
    "end": "458039"
  },
  {
    "text": "hardwares uh try to figure out how that hardware works and try to extract the firmware on it and try to figure out",
    "start": "458039",
    "end": "464720"
  },
  {
    "text": "what what does the software and network stack looks like and moving on from there try to figure out how the",
    "start": "464720",
    "end": "470960"
  },
  {
    "text": "management aspect of that provider works",
    "start": "470960",
    "end": "475880"
  },
  {
    "text": "so as a conclusion I have done this method across that that many devices and it appears that on most residential",
    "start": "476560",
    "end": "482800"
  },
  {
    "text": "gateways um I have a feeling that most gateways are built uh even even in 2024",
    "start": "482800",
    "end": "488960"
  },
  {
    "text": "it is built like if we are in 2024 uh 204",
    "start": "488960",
    "end": "494440"
  },
  {
    "text": "sorry so uh a lack of modern practices are very common and something I call",
    "start": "494440",
    "end": "499599"
  },
  {
    "text": "sort of UI to root is also very common and you don't need any fancy ping parts",
    "start": "499599",
    "end": "505120"
  },
  {
    "text": "to take control of a resid gateway all you need is common injections how about the provider side uh the provider side",
    "start": "505120",
    "end": "512080"
  },
  {
    "text": "are not not very good either because for many providers they tend to expose their management expert on the internet and",
    "start": "512080",
    "end": "517839"
  },
  {
    "text": "it's possible for you to find a bug in that management aspect and for here in Europe um I do see there are calls to",
    "start": "517839",
    "end": "525279"
  },
  {
    "text": "remove power and ZT in 5G network but uh there's still use of these two vendors",
    "start": "525279",
    "end": "530880"
  },
  {
    "text": "inside a fixed network infrastructure",
    "start": "530880",
    "end": "534920"
  },
  {
    "text": "right so how do you start studying such resol gateways uh as before I have",
    "start": "536320",
    "end": "541839"
  },
  {
    "text": "created a wonderful flow for you to decide how to interact with a",
    "start": "541839",
    "end": "547000"
  },
  {
    "text": "board and uh in most cases I don't think you actually need this graph because in",
    "start": "547000",
    "end": "553440"
  },
  {
    "text": "many cases you can just use Google fu that is a very useful tool or try to",
    "start": "553440",
    "end": "558880"
  },
  {
    "text": "throw burp suite with actric scan mode against the local site management expert",
    "start": "558880",
    "end": "564160"
  },
  {
    "text": "and you may find some ways to elevate your privileges and gain common",
    "start": "564160",
    "end": "569279"
  },
  {
    "text": "execution ability on the board and working it from there",
    "start": "569279",
    "end": "574839"
  },
  {
    "text": "but let's prevent pretend that this two didn't work so you will resort to this",
    "start": "574839",
    "end": "580560"
  },
  {
    "text": "you will try to tear the thing apart and try to figure out how to interact with the thing um but you can apply that",
    "start": "580560",
    "end": "587680"
  },
  {
    "text": "flowchart I have shown you earlier and try to identify every component on the board and try to think of any input or",
    "start": "587680",
    "end": "594560"
  },
  {
    "text": "output opportunity on the board and uh for this one this is actually a case we",
    "start": "594560",
    "end": "600160"
  },
  {
    "text": "will be presenting later uh on this one uh you will find there's a zero port expert on the port uh on the board and",
    "start": "600160",
    "end": "607360"
  },
  {
    "text": "you could try some tools to figure out uh what kind of stuff is on that port and for this board in particular it",
    "start": "607360",
    "end": "614320"
  },
  {
    "text": "actually runs on uh it actually runs a serial port protocol and for most boards it works",
    "start": "614320",
    "end": "621279"
  },
  {
    "text": "roughly like this so when you power it on you'll try to roll load boot loader and load the operating system and you",
    "start": "621279",
    "end": "627200"
  },
  {
    "text": "will also have some kind of fallback mode should they fail and uh in that boot loader mode uh",
    "start": "627200",
    "end": "635200"
  },
  {
    "text": "in some cases that the boot selection may not be disabled and you can work from there but if it if it is locked you",
    "start": "635200",
    "end": "642240"
  },
  {
    "text": "can somehow try to interrupt the loading process uh the actual details were a bit",
    "start": "642240",
    "end": "649040"
  },
  {
    "text": "scary which may involve uh you using a paper clip to poke at a flash uh flash",
    "start": "649040",
    "end": "654240"
  },
  {
    "text": "chips data pins but that that is one of a method but kind of",
    "start": "654240",
    "end": "659399"
  },
  {
    "text": "risky uh in other cases you can try other more peaceful methods uh I want to mention that for",
    "start": "659399",
    "end": "666720"
  },
  {
    "text": "targets like resto gateways the soldering may not be the best because in most cases you may not actually own the device and uh breaking the device may",
    "start": "666720",
    "end": "673200"
  },
  {
    "text": "cause you some problems uh but you have many ways to interact with the board so for example using uh",
    "start": "673200",
    "end": "680079"
  },
  {
    "text": "using a clip or probes or to sold the wires onto the board which I will go to into depths on the next slide or in many",
    "start": "680079",
    "end": "686880"
  },
  {
    "text": "cases like I said before you can use either Google fu or github fu to find the correspond corresponding",
    "start": "686880",
    "end": "693240"
  },
  {
    "text": "information so for the images in the middle this is a bit interesting because some boards actually needs uh the what I",
    "start": "693240",
    "end": "700000"
  },
  {
    "text": "call the man in the middle method which is actually this board I'm holding on in the hand um so it sometimes requires you",
    "start": "700000",
    "end": "706640"
  },
  {
    "text": "to actually scrape the traces out from the board and try to figure out how to connect to the flash chip and perform",
    "start": "706640",
    "end": "713040"
  },
  {
    "text": "your next step from there but uh I have also found out a",
    "start": "713040",
    "end": "718800"
  },
  {
    "text": "gimmick so uh what if you accidentally erase all the markings on the chip uh a",
    "start": "718800",
    "end": "724240"
  },
  {
    "text": "wise man once said engravings gives you no technical advantage whatsoever so I",
    "start": "724240",
    "end": "730279"
  },
  {
    "text": "have improvised a way you can recover these markings with a",
    "start": "730279",
    "end": "736639"
  },
  {
    "text": "pencil so uh when you have done these steps you may end up with a firmware image and you can try several methods to",
    "start": "743880",
    "end": "751040"
  },
  {
    "text": "figure out how this works but in many cases you may not know how to work with this image so you can try something like",
    "start": "751040",
    "end": "759040"
  },
  {
    "text": "figuring out what repetit uh what repetition it has in that image so for",
    "start": "759040",
    "end": "765519"
  },
  {
    "text": "example for this one if you look more closely you will see a certain string and put that string into GitHub fu you",
    "start": "765519",
    "end": "772160"
  },
  {
    "text": "will find a tool that is very useful that enables you to extract RS version two uh framework packaging",
    "start": "772160",
    "end": "779880"
  },
  {
    "text": "format so let's move on to the actual studies uh we will be presenting two",
    "start": "779880",
    "end": "785120"
  },
  {
    "text": "actual cases uh two boards today and this is one of the case the case one is actually based off a brocom generation 3",
    "start": "785120",
    "end": "792279"
  },
  {
    "text": "board so which means it will be uh it will be having secure boot and r trust",
    "start": "792279",
    "end": "797519"
  },
  {
    "text": "capabilities and you will have full this encryption so even if I were to disorder",
    "start": "797519",
    "end": "802560"
  },
  {
    "text": "the chip from the board I will not be able to read it and I shall not be able to extract any cryptographer",
    "start": "802560",
    "end": "810200"
  },
  {
    "text": "information and for that provider in uh in particular it actually uses a",
    "start": "810200",
    "end": "815279"
  },
  {
    "text": "certificate to uh authenticate with the network so if I were to take another Gong device to connect to the fixed",
    "start": "815279",
    "end": "822079"
  },
  {
    "text": "network of the provider it will not work because I do not have that certificate and for this board in particular uh the",
    "start": "822079",
    "end": "829680"
  },
  {
    "text": "problem with this it is it is a very well-made board uh it has tons of components on it and is very is a is",
    "start": "829680",
    "end": "837199"
  },
  {
    "text": "kind of difficult to obtain this one so I do not want to break it so as a people",
    "start": "837199",
    "end": "842240"
  },
  {
    "text": "like me not very good with micro disorder instead slaughtering I tend to procrastinate a bit so I put that device",
    "start": "842240",
    "end": "848720"
  },
  {
    "text": "back to the shelf for maybe one or two months after one or two months I decided to take another look so I decided to put",
    "start": "848720",
    "end": "856560"
  },
  {
    "text": "it into Google Fu h I somehow find discussion of this board in China",
    "start": "856560",
    "end": "863440"
  },
  {
    "text": "so in China there's a there's a network forum called an Wi-Fi hobbyist and",
    "start": "863440",
    "end": "871040"
  },
  {
    "text": "contains mentioning of this board h uh and it appears that the Chinese were",
    "start": "871040",
    "end": "876880"
  },
  {
    "text": "buying this this residual gateway for Wi-Fi stations uh nevertheless I managed to",
    "start": "876880",
    "end": "884000"
  },
  {
    "text": "find firmware distribution page in this forum when I got to that page it was taken offline by the vendor but I'm able",
    "start": "884000",
    "end": "892639"
  },
  {
    "text": "to recover the contents thanks to the project by uh by the internet archive so I'm able to obtain another",
    "start": "892639",
    "end": "900880"
  },
  {
    "text": "models framework by the same vendor and the best part that one is unc encrypted",
    "start": "900880",
    "end": "906839"
  },
  {
    "text": "so I now have a a file system image of the different model but from the same",
    "start": "906839",
    "end": "912399"
  },
  {
    "text": "vendor but because that is from a different model I will auto automatically need a",
    "start": "912399",
    "end": "919360"
  },
  {
    "text": "way to dump firmware and perform code execution on the device I have on hand i took some look into a land management",
    "start": "919360",
    "end": "926079"
  },
  {
    "text": "aspect it appears to be a bit safe there's nothing much on the website as and I certainly do not want to break the",
    "start": "926079",
    "end": "931760"
  },
  {
    "text": "board which means I do not want to disorder stuff from the board so I look at the unencrypted down from another",
    "start": "931760",
    "end": "939519"
  },
  {
    "text": "device i took a bit d H it appears to be containing some interesting UDEP rules",
    "start": "939519",
    "end": "946560"
  },
  {
    "text": "because the board actually has systemd compiled in and I took a look again at that bro H",
    "start": "946560",
    "end": "956480"
  },
  {
    "text": "it looks like if I connect FTDI dango to the to the board I will make the board",
    "start": "956480",
    "end": "962880"
  },
  {
    "text": "somehow execute some binaries uh so as uh as a people like me I tend",
    "start": "962880",
    "end": "971199"
  },
  {
    "text": "to have tons of dongles in my cupboard so I took out one dungle connected to",
    "start": "971199",
    "end": "977040"
  },
  {
    "text": "the board and I was greeted with a zero uh with a greeting on the serial port so",
    "start": "977040",
    "end": "983600"
  },
  {
    "text": "when I connect to it it will greet me with protocol 1.0 and I don't know what to do so I put a tons of a inside",
    "start": "983600",
    "end": "990399"
  },
  {
    "text": "because I don't know what protocol is is and I was immediately",
    "start": "990399",
    "end": "995879"
  },
  {
    "text": "um evicted from the protocol so I threw that binary into disassembler",
    "start": "996120",
    "end": "1005920"
  },
  {
    "text": "and it appears that it it implemented some kind of proprietary protocol and it is a of codebased protocol uh and the",
    "start": "1005920",
    "end": "1013759"
  },
  {
    "text": "reason I got evicted is because it actually requires a fixed password so I wrote a dissector for",
    "start": "1013759",
    "end": "1020519"
  },
  {
    "text": "it and I'm shall be able to communicate using the protocol so now I'm armed with that",
    "start": "1020519",
    "end": "1028240"
  },
  {
    "text": "dissector and I took out the dango again connect to the board and I put in the correct password",
    "start": "1028240",
    "end": "1035199"
  },
  {
    "text": "i I am greeted with protocol started and since I'm not uh I haven't",
    "start": "1035199",
    "end": "1041280"
  },
  {
    "text": "done the for uh I didn't do the full reverse entering at that point so the thing I I did in the first place is I",
    "start": "1041280",
    "end": "1048079"
  },
  {
    "text": "randomly try to put some stuff after an edit command and I automatically get",
    "start": "1048079",
    "end": "1054160"
  },
  {
    "text": "command execution on the board as root which was very good",
    "start": "1054160",
    "end": "1059679"
  },
  {
    "text": "so in this case I somehow have a thing called physical code execution on the",
    "start": "1059679",
    "end": "1065280"
  },
  {
    "text": "device the physical part is because I have to actually physically interact with the board so physical code",
    "start": "1065280",
    "end": "1071039"
  },
  {
    "text": "execution as root on the device um the problem with the case one is it",
    "start": "1071039",
    "end": "1077280"
  },
  {
    "text": "has a keys in uh incro of root of trust and yes decrypted by trust zone but it",
    "start": "1077280",
    "end": "1084400"
  },
  {
    "text": "is not secured when it becomes data in use so I'm able to extract all the",
    "start": "1084400",
    "end": "1090240"
  },
  {
    "text": "critical materials despite the board should be using trust though and it",
    "start": "1090240",
    "end": "1096000"
  },
  {
    "text": "appears to be an oversight on the OEM side let's move on to case",
    "start": "1096000",
    "end": "1102679"
  },
  {
    "text": "two so the case two is an actual case uh so I to I took the same method and look",
    "start": "1102679",
    "end": "1109200"
  },
  {
    "text": "into case two and it uh it appears the",
    "start": "1109200",
    "end": "1114799"
  },
  {
    "text": "uh case 2 demonstrates the most common problems with software on resident",
    "start": "1114799",
    "end": "1120360"
  },
  {
    "text": "gateways despite a common lack of hardening um you don't actually need to",
    "start": "1120360",
    "end": "1127520"
  },
  {
    "text": "rely on that because you can find tons of common injections on the board uh it",
    "start": "1127520",
    "end": "1133600"
  },
  {
    "text": "is on the level that you can use kite fuzzy and find tons of common injections",
    "start": "1133600",
    "end": "1138640"
  },
  {
    "text": "however the bugs were mostly lens side and it's not windside so if you uh if we",
    "start": "1138640",
    "end": "1144559"
  },
  {
    "text": "want to study whether if this provider and their resident gway are are safe we will",
    "start": "1144559",
    "end": "1152320"
  },
  {
    "text": "automatic need a way to expand our attack primitive so I look more closely",
    "start": "1152320",
    "end": "1157919"
  },
  {
    "text": "into that device it appears that the device implements some interesting IP table rules so",
    "start": "1157919",
    "end": "1165039"
  },
  {
    "text": "certain IP ranges can reach the manual aspect on that device via the way side and another interesting stuff here",
    "start": "1165039",
    "end": "1172880"
  },
  {
    "text": "is it appears to only block the ICP request but not other types we will go",
    "start": "1172880",
    "end": "1178400"
  },
  {
    "text": "back to uh we will go back on this later so we now have post authentication",
    "start": "1178400",
    "end": "1186320"
  },
  {
    "text": "RC on the measurement interface but we still need to escalate this bug to",
    "start": "1186320",
    "end": "1191799"
  },
  {
    "text": "pre-authentication so I figure out a way to enumerate uh the admin password on",
    "start": "1191799",
    "end": "1198640"
  },
  {
    "text": "every device because it is used uh the password is based on some certain rules",
    "start": "1198640",
    "end": "1203919"
  },
  {
    "text": "and there is a guest account on every device that enables me to enumerate that password so I have a way to enumerate",
    "start": "1203919",
    "end": "1211679"
  },
  {
    "text": "the password and turn the post authentication into",
    "start": "1211679",
    "end": "1217120"
  },
  {
    "text": "pre-authentication but we still need a way to reach the management interfaces website from the",
    "start": "1217559",
    "end": "1225600"
  },
  {
    "text": "internet which we we're still missing right now so I took some look at that IP",
    "start": "1225799",
    "end": "1231760"
  },
  {
    "text": "ranges and here are some prime examples of how to find management infrastructure on the internet so uh the ones shown",
    "start": "1231760",
    "end": "1238880"
  },
  {
    "text": "here are actually the ones you can find right now on the internet and they are really uh the management expert of some",
    "start": "1238880",
    "end": "1246880"
  },
  {
    "text": "certain service provider right now you can try to find them so uh where are we right now let's",
    "start": "1246880",
    "end": "1254679"
  },
  {
    "text": "see those interfaces are actually mar uh in where which I have marked as orange",
    "start": "1254679",
    "end": "1261679"
  },
  {
    "text": "in this chart so we are now we are now",
    "start": "1261679",
    "end": "1266559"
  },
  {
    "text": "here so for that provider I have looked into that allowed list and it appears hm",
    "start": "1269080",
    "end": "1275679"
  },
  {
    "text": "it contains some interesting devices i could understand why there is a forgicate inside because it is possible",
    "start": "1275679",
    "end": "1282240"
  },
  {
    "text": "for the providers to work on the device when they're not at the office so they would need some sort of uh VPN to",
    "start": "1282240",
    "end": "1288720"
  },
  {
    "text": "connect in to the management aspect but the most important part is they somehow",
    "start": "1288720",
    "end": "1294240"
  },
  {
    "text": "have a DVR device inside that network so a DVR device is a box that you can connect multiple cameras to and don't",
    "start": "1294240",
    "end": "1301520"
  },
  {
    "text": "turn those cameras into internet cameras h and I took another look at",
    "start": "1301520",
    "end": "1307679"
  },
  {
    "text": "that device and it appears that it is also for injections and you do not need any fancy pony",
    "start": "1307679",
    "end": "1313960"
  },
  {
    "text": "methods so that allows me to pull off an interesting attack flow",
    "start": "1313960",
    "end": "1321440"
  },
  {
    "text": "so I experimented a bit with all the bugs I have I have on",
    "start": "1321440",
    "end": "1326520"
  },
  {
    "text": "hand and I'm able to pull off an attraction so if I start from the",
    "start": "1326520",
    "end": "1332400"
  },
  {
    "text": "internet side and interact with that DVR device inside the manage man management",
    "start": "1332400",
    "end": "1338320"
  },
  {
    "text": "address block in that provider I can somehow become management and by using",
    "start": "1338320",
    "end": "1345679"
  },
  {
    "text": "the account enumeration bug I found I can turn the post authentication RC on",
    "start": "1345679",
    "end": "1352720"
  },
  {
    "text": "that device to pre-authentication and perform remote code execution on the devices so this is a case that actually",
    "start": "1352720",
    "end": "1360960"
  },
  {
    "text": "happened a while ago and there was roughly 4 million devices affected and",
    "start": "1360960",
    "end": "1366480"
  },
  {
    "text": "uh I happened to be a friend with this uh with that affected country's uh cyber",
    "start": "1366480",
    "end": "1372400"
  },
  {
    "text": "security director so uh that was a typhoon night uh I took a call uh to",
    "start": "1372400",
    "end": "1378880"
  },
  {
    "text": "call that director and they have immediately removed the entry point which is the DVR I use in this picture",
    "start": "1378880",
    "end": "1385679"
  },
  {
    "text": "and all the bugs were fixed in around two weeks so uh this attack path no",
    "start": "1385679",
    "end": "1391520"
  },
  {
    "text": "longer works right now",
    "start": "1391520",
    "end": "1396919"
  },
  {
    "text": "so let's move on um so uh for the past uh 10 to 15",
    "start": "1396919",
    "end": "1404000"
  },
  {
    "text": "minutes I have presented two cases uh we have a case where uh we are",
    "start": "1404000",
    "end": "1411039"
  },
  {
    "text": "able to perform remote code execution on roughly 4 million devices uh and that",
    "start": "1411039",
    "end": "1420080"
  },
  {
    "text": "those bugs were fixed immediately and thanks to our friends help um it was fixed in um around two",
    "start": "1420080",
    "end": "1428280"
  },
  {
    "text": "weeks for the case one I'm able to bypass the vendor's implementation of trust zone and I'm able to extract the",
    "start": "1428280",
    "end": "1435840"
  },
  {
    "text": "cryptography materials from the device um so in real world scenarios it will it",
    "start": "1435840",
    "end": "1441679"
  },
  {
    "text": "will allow me to break uh the vendor's security compliance for their fixed",
    "start": "1441679",
    "end": "1446960"
  },
  {
    "text": "network which means I can basically do what I call is to bring my own gone device so uh for that provider is it is",
    "start": "1446960",
    "end": "1454960"
  },
  {
    "text": "puzzle for you to perform some kind of homebrew or to perform a jailbreak and",
    "start": "1454960",
    "end": "1460159"
  },
  {
    "text": "to not use that uh residential gateway they have provided provided to",
    "start": "1460159",
    "end": "1465799"
  },
  {
    "text": "you so if you are still following um there's a bug I mentioned earlier",
    "start": "1465799",
    "end": "1473200"
  },
  {
    "text": "about command injections and ICMP I took a bit of study uh although",
    "start": "1473200",
    "end": "1480559"
  },
  {
    "text": "I'm not allowed to show the actual source file here but if you take a look on GitHub you will find out that you can",
    "start": "1480559",
    "end": "1489120"
  },
  {
    "text": "somehow find proprietary information on GitHub so this actually leads to a",
    "start": "1489120",
    "end": "1494320"
  },
  {
    "text": "certain SDK by a very popular sock",
    "start": "1494320",
    "end": "1499440"
  },
  {
    "text": "vendor uh so what about the ICMP bug this is actually a bug which I called",
    "start": "1499799",
    "end": "1506400"
  },
  {
    "text": "unsty stealth mode uh in the documentation of this function uh it",
    "start": "1506400",
    "end": "1512559"
  },
  {
    "text": "actually says if you enable this function you will enable stealth mode and it shall",
    "start": "1512559",
    "end": "1517799"
  },
  {
    "text": "not allow any device over the internet to discovery existence of the target um",
    "start": "1517799",
    "end": "1525120"
  },
  {
    "text": "so king uh king audiences here may already spot the mistake that that is",
    "start": "1525120",
    "end": "1530400"
  },
  {
    "text": "already been made here i will go to delve deeper so inside the SDK when when when",
    "start": "1530400",
    "end": "1537840"
  },
  {
    "text": "it is all compiled there's a component called live CNS core is responsible for parsing the configuration files and",
    "start": "1537840",
    "end": "1544320"
  },
  {
    "text": "creating all the other stuff on runtime so for example if you configur if you",
    "start": "1544320",
    "end": "1550480"
  },
  {
    "text": "have conf configurated the device for stealth mode then on every reboot uh",
    "start": "1550480",
    "end": "1555600"
  },
  {
    "text": "you'll try to parse that configuration file and create the corresponding IP table rules but for ICMP if you look",
    "start": "1555600",
    "end": "1562880"
  },
  {
    "text": "into the request for comments number 792 uh which refers to the ICMP protocol it",
    "start": "1562880",
    "end": "1570080"
  },
  {
    "text": "actually defines many message types and uh echo is not the only type that will",
    "start": "1570080",
    "end": "1579240"
  },
  {
    "text": "warrant a response from the target uh since the device is only blocking",
    "start": "1579240",
    "end": "1586080"
  },
  {
    "text": "type eight you can also use type 13 and type five to provoke a response from the",
    "start": "1586080",
    "end": "1593360"
  },
  {
    "text": "target thus breaking the scarities provided by the self mode so you can",
    "start": "1593360",
    "end": "1599039"
  },
  {
    "text": "uncover such devices if uh you you will send it uh type 13 and try to detect if",
    "start": "1599039",
    "end": "1606880"
  },
  {
    "text": "the device blocks type eight so uh to my memory at best uh I",
    "start": "1606880",
    "end": "1613200"
  },
  {
    "text": "think the last time someone have have find such bugs is maybe 10 or 20 years",
    "start": "1613200",
    "end": "1618679"
  },
  {
    "text": "ago and another problem with the command injection I have found in case two it",
    "start": "1618679",
    "end": "1623919"
  },
  {
    "text": "actually leads to a bug that exists in uh in the SDK so inside the SDK there's",
    "start": "1623919",
    "end": "1631440"
  },
  {
    "text": "actually an documentation about this function and it says this function is actually intended to be used only in the",
    "start": "1631440",
    "end": "1638159"
  },
  {
    "text": "command line interface but is possible for the OEM to link this function against other aspects on the device uh",
    "start": "1638159",
    "end": "1646400"
  },
  {
    "text": "and this behavior will lead to command injections everywhere so I have reported these two",
    "start": "1646400",
    "end": "1653039"
  },
  {
    "text": "cases to the vendor uh it is actually a very interesting reporting process",
    "start": "1653039",
    "end": "1658960"
  },
  {
    "text": "because in the beginning I have reached out to the vendor saying hello I have found some bugs but I have by found them",
    "start": "1658960",
    "end": "1664960"
  },
  {
    "text": "by looking into your source code leak do you uh are you willing to accept this this report and they said yes so uh",
    "start": "1664960",
    "end": "1672720"
  },
  {
    "text": "after I have sent the reports to them uh they have fixed it very quickly in around 22 days which is very impressive",
    "start": "1672720",
    "end": "1679360"
  },
  {
    "text": "in the industry so let's give a quick summary before we go to the m mitigation part of",
    "start": "1679360",
    "end": "1686240"
  },
  {
    "text": "this presentation so for the past hour I have",
    "start": "1686240",
    "end": "1691679"
  },
  {
    "text": "presented some cases the case one is the trust zone by bypass leading to key traction case two is how to perform a",
    "start": "1691679",
    "end": "1700399"
  },
  {
    "text": "research from the board starting from there and to perform code execution on",
    "start": "1700399",
    "end": "1706320"
  },
  {
    "text": "the ISB's remote management expert and to take control of the ISP's residental",
    "start": "1706320",
    "end": "1712600"
  },
  {
    "text": "gateways and also I have demonstrated some methods to find bugs in the SDK",
    "start": "1712600",
    "end": "1718480"
  },
  {
    "text": "that could be shared by many devices so let's move on to the",
    "start": "1718480",
    "end": "1723520"
  },
  {
    "text": "mitigation part of this presentation i think the prime question here for the",
    "start": "1723520",
    "end": "1729120"
  },
  {
    "text": "audiences right now is everyone will try to ask how do you detect the compromise",
    "start": "1729120",
    "end": "1734880"
  },
  {
    "text": "of residental gateways the problem with this is because the adversaries could",
    "start": "1734880",
    "end": "1740240"
  },
  {
    "text": "update the gateways with ruins or undetectable backd doorors and it can",
    "start": "1740240",
    "end": "1745600"
  },
  {
    "text": "always reply you the gateway is running on the correct version of the",
    "start": "1745600",
    "end": "1751240"
  },
  {
    "text": "firmware and according to the research I have done against so many devices it",
    "start": "1751240",
    "end": "1756320"
  },
  {
    "text": "appears that uh a lack of trone/scure boot is very common among devices so for",
    "start": "1756320",
    "end": "1762320"
  },
  {
    "text": "the devices Oh hello yeah so for the devices",
    "start": "1762320",
    "end": "1768000"
  },
  {
    "text": "there is no way to validate if it is running on the real firmware that you intend the device to run in the first",
    "start": "1768000",
    "end": "1774760"
  },
  {
    "text": "place i propose a method I call this integrity check canary",
    "start": "1774760",
    "end": "1780960"
  },
  {
    "text": "so uh if you have a remote management expert and if you have a residential gateway you will try to push a new",
    "start": "1780960",
    "end": "1787919"
  },
  {
    "text": "firmware and embed a secret in the firmware so this is basically a cat and mouse game but you will usually be",
    "start": "1787919",
    "end": "1794880"
  },
  {
    "text": "faster than the adversaries unless they're very keen on getting over you so",
    "start": "1794880",
    "end": "1799919"
  },
  {
    "text": "you will embed a secret in the firmware and you will ask the resident gateway on that secret and it shall give you the",
    "start": "1799919",
    "end": "1807039"
  },
  {
    "text": "correct answer but in other cases you can try this method multiple",
    "start": "1807039",
    "end": "1814320"
  },
  {
    "text": "times and push new secrets every time and try to add the secret",
    "start": "1814320",
    "end": "1819399"
  },
  {
    "text": "again so if the gateway was somehow taken over",
    "start": "1819399",
    "end": "1824960"
  },
  {
    "text": "uh among us yes and it returns you with a cor incorrect answer then you will",
    "start": "1824960",
    "end": "1831360"
  },
  {
    "text": "know that gateway is somehow compromised",
    "start": "1831360",
    "end": "1835960"
  },
  {
    "text": "and how about the end users there's actually not uh not much",
    "start": "1837520",
    "end": "1843279"
  },
  {
    "text": "uh one can do as an end user but there are several methods that allows you to control the damage for the end users",
    "start": "1843279",
    "end": "1850960"
  },
  {
    "text": "there's something that you can do for example you can try to employ another gateway behind the reset gateway so",
    "start": "1850960",
    "end": "1856880"
  },
  {
    "text": "essentially use two gateways but configure the second gateway to block uh any request that comes from the private",
    "start": "1856880",
    "end": "1863840"
  },
  {
    "text": "address range um it may not help you in every cases but in some cases it may",
    "start": "1863840",
    "end": "1871240"
  },
  {
    "text": "help another way you can do this is try to configure your resident gateway as a mode and mode so I believe this mode is",
    "start": "1871240",
    "end": "1878399"
  },
  {
    "text": "pretty common here in in in the UK so um",
    "start": "1878399",
    "end": "1884000"
  },
  {
    "text": "try to figure out if you're able to disable uh the layer 7 aspect on your",
    "start": "1884000",
    "end": "1889360"
  },
  {
    "text": "resident gateway and only use it to perform modulation and demodulation between the media",
    "start": "1889360",
    "end": "1896960"
  },
  {
    "text": "medium so how about the provider providers and the OEMs i pro uh I think one recommend",
    "start": "1898760",
    "end": "1908159"
  },
  {
    "text": "recommendation is pretty imperative for them to implement which is try to detect",
    "start": "1908159",
    "end": "1914000"
  },
  {
    "text": "abnormal manual behavior in their control plane so let's go back to our",
    "start": "1914000",
    "end": "1919919"
  },
  {
    "text": "case to attack flow if you somehow have a mobile device or a vulnerable",
    "start": "1919919",
    "end": "1925679"
  },
  {
    "text": "management expert in your management network and if someone wants to launch",
    "start": "1925679",
    "end": "1931760"
  },
  {
    "text": "an attack from the internet site to your management expert",
    "start": "1931760",
    "end": "1937159"
  },
  {
    "text": "um in some cases that attacker uh that the attackers may want to install extra",
    "start": "1937159",
    "end": "1943760"
  },
  {
    "text": "artifacts from other places and to or to launch attacks",
    "start": "1943760",
    "end": "1949200"
  },
  {
    "text": "against your gateway you can try to detect these two behaviors because this",
    "start": "1949200",
    "end": "1954880"
  },
  {
    "text": "is something that will not happen every day",
    "start": "1954880",
    "end": "1960519"
  },
  {
    "text": "how sorry and how about the others um I think the other",
    "start": "1960519",
    "end": "1966240"
  },
  {
    "text": "recommendations from me will is try to mandate a set of baseline and standards",
    "start": "1966240",
    "end": "1973120"
  },
  {
    "text": "uh and before that try to mandate the use of hardware backed secure boot and",
    "start": "1973120",
    "end": "1978240"
  },
  {
    "text": "try to mandate the proper use of trust zone and there are several security",
    "start": "1978240",
    "end": "1983919"
  },
  {
    "text": "standards that one can refer to I don't think they are they are applyable to resto gateway as is but you you may be",
    "start": "1983919",
    "end": "1991519"
  },
  {
    "text": "able to get a spirit from this pro uh from this standards and uh they shall definitely",
    "start": "1991519",
    "end": "1999279"
  },
  {
    "text": "apply secure coding practices on uh otherwise they they were writing their softwares like 20 years",
    "start": "1999279",
    "end": "2005880"
  },
  {
    "text": "ago so how about the upstream vendors the sock makers",
    "start": "2005880",
    "end": "2012120"
  },
  {
    "text": "i think a lesson that I have learned in this research is uh the OANS may utilize",
    "start": "2012480",
    "end": "2018320"
  },
  {
    "text": "the SDK on their own valation which means um even if you write a write a",
    "start": "2018320",
    "end": "2025279"
  },
  {
    "text": "very huge please do not use this function outside somewhere they will still use it and they will use it to",
    "start": "2025279",
    "end": "2030720"
  },
  {
    "text": "blow off their entire leg so for the upstream vendors it is",
    "start": "2030720",
    "end": "2036000"
  },
  {
    "text": "imperative for them to employ secure coding practices and to employ defensive programming which is you have to",
    "start": "2036000",
    "end": "2042880"
  },
  {
    "text": "actually try to prevent your downstream OEMs from doing the incorrect",
    "start": "2042880",
    "end": "2049679"
  },
  {
    "text": "stuff they shall employ the socks with secure boot of or trust zone which they are already doing right now however one",
    "start": "2050040",
    "end": "2057599"
  },
  {
    "text": "thing they can do from that is they have to demonstrate the usage correctly in the SDK and provide very clear and",
    "start": "2057599",
    "end": "2064760"
  },
  {
    "text": "precise instructions in the documentations uh so according to the",
    "start": "2064760",
    "end": "2070560"
  },
  {
    "text": "research it is actually very common for the OEMs to think h we are already",
    "start": "2070560",
    "end": "2075919"
  },
  {
    "text": "encrypting the the flash with looks and storing it uh and storing that plain",
    "start": "2075919",
    "end": "2083040"
  },
  {
    "text": "text key somewhere well this is not proper encryption because the keys were not being held in trust zone",
    "start": "2083040",
    "end": "2090040"
  },
  {
    "text": "escrow uh so it is imperative to to mind the OEMs that doing this is",
    "start": "2090040",
    "end": "2098240"
  },
  {
    "text": "not very proper encryption and uh I think the sock vendors have to actually",
    "start": "2098240",
    "end": "2103440"
  },
  {
    "text": "educate the OEMs to how to utilize trust zone for critical materials that they",
    "start": "2103440",
    "end": "2108480"
  },
  {
    "text": "don't want to lose very easy so being from this uh what do we uh what",
    "start": "2108480",
    "end": "2115520"
  },
  {
    "text": "do I or we get from this research i think there are se several",
    "start": "2115520",
    "end": "2120640"
  },
  {
    "text": "takeaways that one can learn from this",
    "start": "2120640",
    "end": "2125039"
  },
  {
    "text": "research one uh it appears that most residential gateways and the providers",
    "start": "2125960",
    "end": "2131760"
  },
  {
    "text": "are not very safe the reason behind that is uh according to this research it",
    "start": "2131760",
    "end": "2139599"
  },
  {
    "text": "appears the gateways are even worse than the IoT devices and from other data points that",
    "start": "2139599",
    "end": "2145920"
  },
  {
    "text": "I can know they could be lucrative targets and they are already sheer in numbers because everyone basically has",
    "start": "2145920",
    "end": "2154560"
  },
  {
    "text": "them two is one have to actually treat the end devices as hostile and what does",
    "start": "2155240",
    "end": "2161200"
  },
  {
    "text": "this mean so when you ship a device to the end users which is the customers you",
    "start": "2161200",
    "end": "2166640"
  },
  {
    "text": "cannot control of how what or how or anything will happen to the device so if",
    "start": "2166640",
    "end": "2173359"
  },
  {
    "text": "you ship any secrets that you certainly do not want to use and do not want the users to be able to read that",
    "start": "2173359",
    "end": "2179359"
  },
  {
    "text": "information out you have to think very carefully of how to embed this secret inside the device",
    "start": "2179359",
    "end": "2187040"
  },
  {
    "text": "this can somehow uh and the risks can somehow be mitigated by performing a pro",
    "start": "2187040",
    "end": "2192640"
  },
  {
    "text": "very proper risk assessment and by the usage of modern defensive options should these options be applied",
    "start": "2192640",
    "end": "2200280"
  },
  {
    "text": "correctly and on the last one uh it appears the software uh software supply",
    "start": "2200280",
    "end": "2206000"
  },
  {
    "text": "chain security is still a very difficult effort it actually requires effort from",
    "start": "2206000",
    "end": "2211119"
  },
  {
    "text": "every parties and especially from the sock vendors because they actually have to prevent",
    "start": "2211119",
    "end": "2216599"
  },
  {
    "text": "misuse by the OEM so I think this will conclude my uh",
    "start": "2216599",
    "end": "2223280"
  },
  {
    "text": "my presentation and should you have any questions you are welcome to send emails or send messages through here and there",
    "start": "2223280",
    "end": "2230720"
  },
  {
    "text": "are several people I want to give special thanks with one is Ken my manager at at TX1 networks and two is",
    "start": "2230720",
    "end": "2237119"
  },
  {
    "text": "fed to goi from the back speaker coaching program and I plan to release a white paper at disclosure and write up",
    "start": "2237119",
    "end": "2243680"
  },
  {
    "text": "very soon so check out on our blog and I also have some devices with me you're welcome to take a look so thank you",
    "start": "2243680",
    "end": "2252200"
  },
  {
    "text": "[Applause]",
    "start": "2252200",
    "end": "2256480"
  }
]