[
  {
    "start": "0",
    "end": "80000"
  },
  {
    "text": "hello hello good afternoon welcome to warm charming harvestin malware lures for fun and profit with the drum army me",
    "start": "0",
    "end": "7710"
  },
  {
    "text": "from inquest dotnet now just a few brief notes before we begin please stop by the",
    "start": "7710",
    "end": "13740"
  },
  {
    "text": "business hall located in Mandalay Bay Oceanside and shoreline ballrooms level 2 during the day and the Welcome",
    "start": "13740",
    "end": "20880"
  },
  {
    "text": "Reception is this evening at 5:30 p.m. the blackout Arsenal is in the business hall level 2 you can join us for the",
    "start": "20880",
    "end": "28410"
  },
  {
    "text": "pony Awards that's going to be today at logon JKL 6:30 p.m. please put your",
    "start": "28410",
    "end": "36000"
  },
  {
    "text": "phone in vibrate just silence your phones for everyone and please give a warm welcome to our speaker today",
    "start": "36000",
    "end": "41640"
  },
  {
    "text": "again that's petrm Armenian thank you Thank You Angelo for the introduction",
    "start": "41640",
    "end": "47250"
  },
  {
    "text": "good afternoon thank you guys for joining my name is Pedram and i'm here to talk about a subject that is",
    "start": "47250",
    "end": "52860"
  },
  {
    "text": "something that i research pretty much daily I find fascinating and I wanted to share some notes that we've taken over",
    "start": "52860",
    "end": "58770"
  },
  {
    "text": "time as well as towards the end announced a public data portal where you can essentially play with this kind of",
    "start": "58770",
    "end": "64290"
  },
  {
    "text": "data and make some more discoveries on your own you know as a researcher having access to data is critical as time goes",
    "start": "64290",
    "end": "71280"
  },
  {
    "text": "on it's becoming more more closed circles so this is one of my attempts at giving back and exposing data for folks",
    "start": "71280",
    "end": "78240"
  },
  {
    "text": "who are trying to get their their feet wet in this world so some quick background on Who I am born or raised in",
    "start": "78240",
    "end": "84180"
  },
  {
    "start": "80000",
    "end": "154000"
  },
  {
    "text": "New York City living out of Austin Texas now for the past 10 15 years you know started off my computer hacking in the",
    "start": "84180",
    "end": "90570"
  },
  {
    "text": "1990s with phone phreaking with red boxes and reverse engineering software with soft ice you know I had gotten",
    "start": "90570",
    "end": "96960"
  },
  {
    "text": "access to a laptop didn't have any money to afford software got soft ice and",
    "start": "96960",
    "end": "102119"
  },
  {
    "text": "started cracking software just as a means of getting access to it and in that process kind of learned you know",
    "start": "102119",
    "end": "107369"
  },
  {
    "text": "the tricks of the trade you know I started off my career with a company called AI defense we launched the vulnerability contributor program the",
    "start": "107369",
    "end": "113640"
  },
  {
    "text": "first loan buying program was kind later I kind of perfected that model by creating the zero day initiative under",
    "start": "113640",
    "end": "118860"
  },
  {
    "text": "tipping point I've done a bunch of open source projects like I'm a reverse engineering framework sully is a fuzzing",
    "start": "118860",
    "end": "125340"
  },
  {
    "text": "framework I've written a book on fuzzing X I can see my co-author sitting here in the audience today",
    "start": "125340",
    "end": "131670"
  },
  {
    "text": "you know beyond that I've done some startups where I work on an anti-virus remover product called jump shot that",
    "start": "131670",
    "end": "137160"
  },
  {
    "text": "was sold to Avast we were an advanced malware removal tool and in recent",
    "start": "137160",
    "end": "142950"
  },
  {
    "text": "history I've been working on inquest you know we deal with these kinds of problems in essence we're a file",
    "start": "142950",
    "end": "148260"
  },
  {
    "text": "analytics platform designed to solve problems for sock analysts and stock communities so what we're talking about",
    "start": "148260",
    "end": "155790"
  },
  {
    "start": "154000",
    "end": "241000"
  },
  {
    "text": "today subject wise I chose warm charming this is actually a real-world Texas sport I mentioned I'm",
    "start": "155790",
    "end": "162840"
  },
  {
    "text": "from Texas and in East Texas they have this competitive sport where through some kind of vibration noise or thumping",
    "start": "162840",
    "end": "169860"
  },
  {
    "text": "on the ground they're attempting to make these worms come to the surface and so I thought that was pertinent to what we're",
    "start": "169860",
    "end": "175320"
  },
  {
    "text": "talking about today and I like that fun you know kind of side analogy and so in",
    "start": "175320",
    "end": "181230"
  },
  {
    "text": "our context what worm farming is is we're looking for interesting malware lures you know we're going to harvest a",
    "start": "181230",
    "end": "187500"
  },
  {
    "text": "giant corpus of malware from a variety different sources we'll be focusing on one particular one and then we're going",
    "start": "187500",
    "end": "193560"
  },
  {
    "text": "to be dissecting through those to try and find the interesting samples you know there's a ton of malware samples created on a daily basis among those are",
    "start": "193560",
    "end": "200250"
  },
  {
    "text": "some gems you know sometimes you'll even be able to find oday that is being experimented",
    "start": "200250",
    "end": "205710"
  },
  {
    "text": "with before malware campaign actually launches and goes like full production so potentially as a defender you might",
    "start": "205710",
    "end": "211770"
  },
  {
    "text": "be able to get these like early warning signs and then produce either prevention or detection mechanisms to you know stop",
    "start": "211770",
    "end": "219090"
  },
  {
    "text": "that kind of attack this is not want to stay here so agenda wise you know what kind of",
    "start": "219090",
    "end": "224880"
  },
  {
    "text": "lures we want to find where do we go find them you know how do we dissect them and then which ones of these are",
    "start": "224880",
    "end": "230550"
  },
  {
    "text": "interesting and these pictures are not staged or fake or b-roll if this is a real competitive sport that's a dude",
    "start": "230550",
    "end": "236010"
  },
  {
    "text": "with a tuba trying to get worms to come to the surface of that fields so what",
    "start": "236010",
    "end": "242820"
  },
  {
    "start": "241000",
    "end": "377000"
  },
  {
    "text": "kind of lures are we interested in you know there's a lot of beautiful exploits out there it's very hard to write x",
    "start": "242820",
    "end": "248070"
  },
  {
    "text": "points these days the the ramp-up time is like a whole team for a year you're chaining X boys together and you're",
    "start": "248070",
    "end": "254040"
  },
  {
    "text": "jumping from one ship to another but unfortunately the reality of it is there's the two major types of breeches",
    "start": "254040",
    "end": "260549"
  },
  {
    "text": "out there are either someone left their bucket open and you know all your credit card data has now been siphoned off by some person",
    "start": "260549",
    "end": "268370"
  },
  {
    "text": "or they're attacking the endpoint they're attacking the end user you know either via some malicious",
    "start": "268370",
    "end": "275240"
  },
  {
    "text": "attachment that's coming by email or drive-by download that maybe they're sending you a URL these are your your",
    "start": "275240",
    "end": "281539"
  },
  {
    "text": "PDF documents your office documents your Java your flash you know flash is dead in the browser but that subsystem is",
    "start": "281539",
    "end": "287720"
  },
  {
    "text": "still readily available and accessible via a document attachment so in 2018 for",
    "start": "287720",
    "end": "293870"
  },
  {
    "text": "example we saw 2-0 days that targeted flash but they were delivered via email inside of an actual document that's what",
    "start": "293870",
    "end": "300320"
  },
  {
    "text": "we have this example here this encapsulation or matura capable Luers you know I can layer them one layer",
    "start": "300320",
    "end": "307039"
  },
  {
    "text": "inside of another it requires some user interaction to actually get to it but that ends up bypassing security defenses",
    "start": "307039",
    "end": "313220"
  },
  {
    "text": "it's very hard to detect by a sandbox and detonation and there's a myriad of",
    "start": "313220",
    "end": "318409"
  },
  {
    "text": "these kinds of samples right some of them are actual vulnerabilities they have CVS like the ones on the screen",
    "start": "318409",
    "end": "323659"
  },
  {
    "text": "over here sometimes you've got your freebies you know Microsoft had this dynamic data exchange vulnerability that",
    "start": "323659",
    "end": "330620"
  },
  {
    "text": "at first they denied it was a vulnerability then they ended up eventually fixing it it was essentially just a command execution like I would",
    "start": "330620",
    "end": "337070"
  },
  {
    "text": "send you a document you open it and it's launching arbitrary commands I call that a free because it was ridiculously easy",
    "start": "337070",
    "end": "342800"
  },
  {
    "text": "to exploit I could teach an audience how to do it in like three slides and then of course you've got you know what we",
    "start": "342800",
    "end": "348380"
  },
  {
    "text": "called on you know uninformed consent folks who will enable a macro for example and just essentially launch a",
    "start": "348380",
    "end": "355669"
  },
  {
    "text": "piece of malware through lack of knowledge there's you know plethora of examples and the screenshot we're",
    "start": "355669",
    "end": "361190"
  },
  {
    "text": "showing one where it's a real world campaign they actually have an embedded binary inside the metadata and the macro",
    "start": "361190",
    "end": "367159"
  },
  {
    "text": "pivots to it you can see it from this base 64 encoded TV if you look at basics if we're on coded content this will kind",
    "start": "367159",
    "end": "374270"
  },
  {
    "text": "of stand out to you but a very common example so now the next question is you know where do we dig where do we get",
    "start": "374270",
    "end": "380389"
  },
  {
    "start": "377000",
    "end": "471000"
  },
  {
    "text": "these things from there's open platforms like hybrid analysis and any run you",
    "start": "380389",
    "end": "386419"
  },
  {
    "text": "know a lot of guys are doing harvesting on these platforms they'll go on to look at the daily uploads and they'll pull",
    "start": "386419",
    "end": "391580"
  },
  {
    "text": "samples from there and dig around that so that's an option for me Searchers you know you can crawl IOC is",
    "start": "391580",
    "end": "397360"
  },
  {
    "text": "that you're pulling off of either blogs that people are publishing or maybe you have keyword searches on Twitter and",
    "start": "397360",
    "end": "402759"
  },
  {
    "text": "you're now getting iOS CS you can feed to a crawler that goes out and it starts grabbing things and pulling into your your corpus you can map attacker",
    "start": "402759",
    "end": "410080"
  },
  {
    "text": "infrastructure right so perhaps I've gotten some key finger into attacker",
    "start": "410080",
    "end": "415180"
  },
  {
    "text": "infrastructure I can map out other domains and IPS and start harvesting lures that way you know if you're",
    "start": "415180",
    "end": "420789"
  },
  {
    "text": "working at a large company you can look at your own email school you know there's there to be a plethora of attacks that are coming in and any large",
    "start": "420789",
    "end": "426820"
  },
  {
    "text": "scale enterprise and then finally you know we can focus on a virustotal you",
    "start": "426820",
    "end": "432910"
  },
  {
    "text": "know it's a service if you're not familiar with it from Google that's essentially a V consensus you upload a",
    "start": "432910",
    "end": "438099"
  },
  {
    "text": "file they'll run it across 60 different engines they give you the results from there and for researchers you can",
    "start": "438099",
    "end": "444039"
  },
  {
    "text": "purchase an account and actually get data fed to you from there I don't think there's anybody that works in the AV",
    "start": "444039",
    "end": "449560"
  },
  {
    "text": "industry does not have access to virustotal as intelligence feed it's very heavily used by folks for fuelling",
    "start": "449560",
    "end": "455560"
  },
  {
    "text": "their machine learning algorithms you know that of course has its own biases associated with it but it's it's a very",
    "start": "455560",
    "end": "460810"
  },
  {
    "text": "solid and useful platform I'm terrible at doing this thing lightly let me",
    "start": "460810",
    "end": "468520"
  },
  {
    "text": "switch the keyboard so on the attacker infrastructure side you know if you're",
    "start": "468520",
    "end": "475030"
  },
  {
    "start": "471000",
    "end": "594000"
  },
  {
    "text": "looking to self source IO sees from wherever it is Twitter blogs whatnot we've got some public open source tools",
    "start": "475030",
    "end": "481599"
  },
  {
    "text": "for you to use where you can pull those things down the general idea here though is you're looking for anchors you know a",
    "start": "481599",
    "end": "486909"
  },
  {
    "text": "domain name has to be registered by an email address of course that can be anonymized but if someone is registering",
    "start": "486909",
    "end": "492370"
  },
  {
    "text": "multiple domains with the same email that becomes an anchor where if I find one domain I can now go a numerator ones you know domains resolve to an IP I can",
    "start": "492370",
    "end": "500110"
  },
  {
    "text": "reverse DNS that to see what other domains are on that IP you know perhaps it's a shared server or a CloudFlare",
    "start": "500110",
    "end": "505210"
  },
  {
    "text": "server or maybe there's multiple domains on that IP that are malicious and each one of these starts pivoting out to",
    "start": "505210",
    "end": "510820"
  },
  {
    "text": "other ones attackers will typically either stand up infrastructure so you know get to get a server somewhere make",
    "start": "510820",
    "end": "517328"
  },
  {
    "text": "an Amazon put something on a paste bin or they'll take over you know they'll find WordPress vulnerabilities scan the",
    "start": "517329",
    "end": "523839"
  },
  {
    "text": "web for them and then just you know upload their files to ensure that these places where",
    "start": "523839",
    "end": "529370"
  },
  {
    "text": "they're they're putting their next stage pivots on they don't get marked by reputation because their existing valid",
    "start": "529370",
    "end": "534440"
  },
  {
    "text": "sites that have been around for some time you know other things you can pivot on is you know some less looked at",
    "start": "534440",
    "end": "540829"
  },
  {
    "text": "things things like this is social certificates now maybe someone's using the same ssl certificate ID on two",
    "start": "540829",
    "end": "546050"
  },
  {
    "text": "different sites and now you can tie them in that way or they're actually tracking their malware campaigns by using Google",
    "start": "546050",
    "end": "551449"
  },
  {
    "text": "Analytics and they have the same Google Analytics ID embedded in their their services like census for example that",
    "start": "551449",
    "end": "557870"
  },
  {
    "text": "allow you to just search at scale you know kind of like a Google of HTML source code and you can use that for",
    "start": "557870",
    "end": "563930"
  },
  {
    "text": "pivoting and finding all these sources to pull it in so a variety of different things you can do here and once you do",
    "start": "563930",
    "end": "569569"
  },
  {
    "text": "have some anchor you know there's a variety of open-source tools you can use for pivoting they're showed on there's gray noise domain tools and a lot of",
    "start": "569569",
    "end": "577190"
  },
  {
    "text": "virustotal uh services are also free don't worry about all these slides will",
    "start": "577190",
    "end": "582800"
  },
  {
    "text": "be made available and we'll publish them on our blog and whatnot but here are just some examples for how to pivot on an IP address or on a DNS just using you",
    "start": "582800",
    "end": "590569"
  },
  {
    "text": "know open free api's you know we're gonna dive into worm charming over top",
    "start": "590569",
    "end": "597290"
  },
  {
    "start": "594000",
    "end": "747000"
  },
  {
    "text": "of BTI virustotal intelligence so when we're talking about this we need to look at the scale all right what are we",
    "start": "597290",
    "end": "603260"
  },
  {
    "text": "looking at in terms of numbers so this was just recently screenshotted you know and august 4th this is typically to kind",
    "start": "603260",
    "end": "609680"
  },
  {
    "text": "of see it over time you know you've got something like 1.2 1.3 million samples are uploaded to virustotal a day of",
    "start": "609680",
    "end": "616399"
  },
  {
    "text": "those a million of them are distinct you know for 1 mm there or have already been uploaded that same day of those 400,000",
    "start": "616399",
    "end": "625069"
  },
  {
    "text": "are actually or nine thousand are new and distinct so they've never been seen before not just a sync that day and then",
    "start": "625069",
    "end": "631610"
  },
  {
    "text": "of those about 400,000 are malicious so if you got 1.3 million samples to harvest from that little marker in the",
    "start": "631610",
    "end": "639139"
  },
  {
    "text": "bottom corner there now if we look at the file distribution you know of those files four and a thousand break down to",
    "start": "639139",
    "end": "645529"
  },
  {
    "text": "PDF than 40-thousand for office 15,000 for java 12,000 for excel so on and so forth",
    "start": "645529",
    "end": "650569"
  },
  {
    "text": "you know these are the kinds of malware lures that we're looking at add these all up and you've got about four hundred and seventy thousand samples you know",
    "start": "650569",
    "end": "657649"
  },
  {
    "text": "per day that you'd have to consider so now we want to we want to cut through these you know to do that and these are all open source as well",
    "start": "657649",
    "end": "664320"
  },
  {
    "text": "these are your rules that are designed for hunting on every sample that's upload to virustotal",
    "start": "664320",
    "end": "669990"
  },
  {
    "text": "one of these rules will run and if it fires you know that sample comes down to us so we want to start siphoning off",
    "start": "669990",
    "end": "676589"
  },
  {
    "text": "from that you know nearly 500k sample set this one is looking for any document",
    "start": "676589",
    "end": "682440"
  },
  {
    "text": "that contains some macro whether it's benign and religious you know I want that file in our corpus and that's about",
    "start": "682440",
    "end": "687810"
  },
  {
    "text": "a thousand a day on average you know this next one is finding office documents that contains some kind of",
    "start": "687810",
    "end": "693720"
  },
  {
    "text": "ActiveX embedding or they have some kind of malicious behavior someone thought I",
    "start": "693720",
    "end": "699630"
  },
  {
    "text": "had something wrong that at least one AV vendor that's that positive is greater than zero you know this produces about five hundred a day added up to the",
    "start": "699630",
    "end": "705899"
  },
  {
    "text": "previous one that's one point five case samples a day you know this next rule is looking for Java files that over are of",
    "start": "705899",
    "end": "712620"
  },
  {
    "text": "interests at another five hundred of the two thousand are TFS twenty to fifty",
    "start": "712620",
    "end": "718339"
  },
  {
    "text": "PDFs that have some kind of JavaScript you know some active content in them you know now we're up to about twenty five",
    "start": "718339",
    "end": "724920"
  },
  {
    "text": "hundred samples including with a flash as well so if there's flash embedded in the document you know let's get that",
    "start": "724920",
    "end": "730589"
  },
  {
    "text": "thing down as well so we've already reduced the corporate drastically right we've gone from one point three million samples to twenty-five hundred a day",
    "start": "730589",
    "end": "737600"
  },
  {
    "text": "still a bit much for from manual analysis but this is less than one percent of that total corpus it's is",
    "start": "737600",
    "end": "743610"
  },
  {
    "text": "this a manageable problem for us to be dealing with so now that you've got these samples you know what are some you",
    "start": "743610",
    "end": "750209"
  },
  {
    "start": "747000",
    "end": "963000"
  },
  {
    "text": "know good vibrations that we can use you know to use this whole worm charming analogy and this video by the way",
    "start": "750209",
    "end": "755279"
  },
  {
    "text": "apparently birds do this to what he's doing here I'm assuming is it he they",
    "start": "755279",
    "end": "760319"
  },
  {
    "text": "pat the ground to like replicate the like feeling of rain and that brings worms to the surface too so it's this",
    "start": "760319",
    "end": "766920"
  },
  {
    "text": "whole you know vibrating thing so some things that you can some things that you would be not wise to do as a malware",
    "start": "766920",
    "end": "772709"
  },
  {
    "text": "author but great for us on the defender side is we can look for things are not",
    "start": "772709",
    "end": "777899"
  },
  {
    "text": "malicious but they're not they're indicative of something that has been generated by a malicious author or",
    "start": "777899",
    "end": "783930"
  },
  {
    "text": "someone who has actually hand created a file format all right it's not coming out of PDF it's not coming out of Word",
    "start": "783930",
    "end": "789960"
  },
  {
    "text": "you know they've done some some modifications to it to evade detection or to make it hard to analyze but the",
    "start": "789960",
    "end": "795570"
  },
  {
    "text": "sheer fact that they've done that has now exposed the content to us you know if I'm ever going to try and launch a",
    "start": "795570",
    "end": "800850"
  },
  {
    "text": "successful malware campaign I would want to hide in plain sight I would not want to use any kind of weird obfuscation",
    "start": "800850",
    "end": "807420"
  },
  {
    "text": "it's gonna make my payload stand out especially if I'm bundling zero-day with it you know why am I going to burn a no",
    "start": "807420",
    "end": "813900"
  },
  {
    "text": "day just using a efficient tactic that's gonna make this sample stand out you",
    "start": "813900",
    "end": "819150"
  },
  {
    "text": "know thankfully people do do that and we can leverage that against them to find",
    "start": "819150",
    "end": "824190"
  },
  {
    "text": "you know interesting signal in the noise you know one example is my evasions so",
    "start": "824190",
    "end": "830370"
  },
  {
    "text": "for example an RTF file starts off with this curly brace backpack RTF one but",
    "start": "830370",
    "end": "837510"
  },
  {
    "text": "that's not requisite as long as you have a curly brace backpack RT you know",
    "start": "837510",
    "end": "843020"
  },
  {
    "text": "Microsoft Windows is perfectly happy about opening that file and rendering it so if someone's writing signatures that",
    "start": "843020",
    "end": "848820"
  },
  {
    "text": "are looking for RTF files using the full header they're gonna completely miss these files because they're not gonna see it as an actual valid RTF file if",
    "start": "848820",
    "end": "856529"
  },
  {
    "text": "you do mind based detection that's not going to show up as a mime type of rich text format but it will open by the the",
    "start": "856529",
    "end": "863880"
  },
  {
    "text": "Microsoft parser in general the Microsoft parser is notoriously robust if you look at this project it's called",
    "start": "863880",
    "end": "869580"
  },
  {
    "text": "via the tiny PE project one of the the hackers posed the challenge of how small can we make a portable executable file",
    "start": "869580",
    "end": "875520"
  },
  {
    "text": "and it still executes and people played with this thing and they've got like these self-referencing header pointers",
    "start": "875520",
    "end": "881880"
  },
  {
    "text": "and they've got it to be really really tiny it became a little game you know so Microsoft is super robust with their",
    "start": "881880",
    "end": "887070"
  },
  {
    "text": "parsing which leaves a lot of room for occupation games you know another",
    "start": "887070",
    "end": "892140"
  },
  {
    "text": "example of this is the PDF header you know this % PDF typically is that offset",
    "start": "892140",
    "end": "897450"
  },
  {
    "text": "zero but actually it could be anywhere in the first 1,000 bytes and if you open that up in Windows it will be mapped to",
    "start": "897450",
    "end": "904370"
  },
  {
    "text": "Adobe and it will parse it and open it just fine you know other ways that you might burn your zero day or how we might",
    "start": "904370",
    "end": "910470"
  },
  {
    "text": "catch Google zero day is by looking at symbols you know if there's JavaScript embedded in",
    "start": "910470",
    "end": "916150"
  },
  {
    "text": "a PDF and there's symbolic information like shellcode and heat spray and Rob",
    "start": "916150",
    "end": "922210"
  },
  {
    "text": "gadget you know that's great for us and if they're gonna leave symbols in their JavaScript I'm very very happy to pull",
    "start": "922210",
    "end": "927790"
  },
  {
    "text": "that out and use that as an anchor to see what is you know what that sample is all about you know another example is",
    "start": "927790",
    "end": "934420"
  },
  {
    "text": "this utf-8 byte order mark this dates back to 2013 but is still valid today if",
    "start": "934420",
    "end": "941320"
  },
  {
    "text": "you prefix any file with those you know the three bytes it will still open and",
    "start": "941320",
    "end": "947890"
  },
  {
    "text": "be valid for example a zip file I can put that in front of it that might break in a bunch of mime types and be",
    "start": "947890",
    "end": "953710"
  },
  {
    "text": "difficult to to analyze but again not the best thing to do from attackers perspective because you might be burning",
    "start": "953710",
    "end": "959830"
  },
  {
    "text": "your your wares and finally there's there's chaff you know chaff in essence",
    "start": "959830",
    "end": "964930"
  },
  {
    "start": "963000",
    "end": "1011000"
  },
  {
    "text": "is just you know waste it's things that are superfluous so at the husk of corn this chaff and you know here's an",
    "start": "964930",
    "end": "971800"
  },
  {
    "text": "example of chaff around a dde exploit so we can kind of see I've highlighted it",
    "start": "971800",
    "end": "976900"
  },
  {
    "text": "here you can see that that D de Otto and it's broken down it's broken up among all this like garbage XML that's in",
    "start": "976900",
    "end": "983290"
  },
  {
    "text": "between it I wrote that little red X there at the top which just highlights all the chaff alright so you can see that there is a",
    "start": "983290",
    "end": "990880"
  },
  {
    "text": "DD auto and it's running commanded XC and it's pivoting from there to whatever the next stage payload is so this person",
    "start": "990880",
    "end": "997660"
  },
  {
    "text": "has done this to try and mask their their payload but if we're looking for chaff generically we're gonna be able to",
    "start": "997660",
    "end": "1003660"
  },
  {
    "text": "find any arbitrary payload that's trying to be hidden for you don't forget about the actual DV auto behind it just",
    "start": "1003660",
    "end": "1009450"
  },
  {
    "text": "identifying the chaff another example and this came out in a February 2018",
    "start": "1009450",
    "end": "1015920"
  },
  {
    "start": "1011000",
    "end": "1078000"
  },
  {
    "text": "guys from kaspersky they were looking at the state machine for parsing rich text format and they found a way that they",
    "start": "1015920",
    "end": "1022260"
  },
  {
    "text": "could put in a pattern where I called a byte nibble like you put in some superfluous bytes and then a junk byte",
    "start": "1022260",
    "end": "1027839"
  },
  {
    "text": "and it would just eat it off so it was just again chaff in the middle of it you know we talked a little bit more about",
    "start": "1027839",
    "end": "1033089"
  },
  {
    "text": "this later on but a few months later some zero-day in the wild an actual campaign utilized that published",
    "start": "1033089",
    "end": "1040370"
  },
  {
    "text": "use that published a bite nibbling technique to try and mask its own",
    "start": "1040370",
    "end": "1045899"
  },
  {
    "text": "payload you know here's an example of that we on the left-hand side you've got a RTF document that has this byte nibble",
    "start": "1045899",
    "end": "1054510"
  },
  {
    "text": "chaff in it in the top I've thrown in a regular expression so that I can pull all that out and the right is a normalized document so what's on the",
    "start": "1054510",
    "end": "1061260"
  },
  {
    "text": "left would be difficult to analyze on the right is a normal form but on the left regardless of what the payload is",
    "start": "1061260",
    "end": "1067919"
  },
  {
    "text": "if I saw that I know that this person is trying to do something nefarious that in itself is gonna will lead me to want to",
    "start": "1067919",
    "end": "1074279"
  },
  {
    "text": "see what's behind that obfuscation so here these are all kind of like surface",
    "start": "1074279",
    "end": "1080159"
  },
  {
    "text": "level examinations and they'll get us a certain degree but we need to dig deeper if we want to find more interesting",
    "start": "1080159",
    "end": "1086159"
  },
  {
    "text": "things so what can we do on that front you know we can do sandbox detonation you know put up a whole cluster of",
    "start": "1086159",
    "end": "1092640"
  },
  {
    "text": "cuckoo Sam boxes and and start feeding all our samples put in a daily basis letting them detonate in a virtual",
    "start": "1092640",
    "end": "1098580"
  },
  {
    "text": "environment and then we can look at it behaviorally we can do static analysis",
    "start": "1098580",
    "end": "1103770"
  },
  {
    "text": "to do like IOC extraction right maybe I'm pulling out any URLs email addresses",
    "start": "1103770",
    "end": "1108950"
  },
  {
    "text": "domain names from samples and then feeding that to a crawling infrastructure and you know harvesting more stuff that way this whole hunt",
    "start": "1108950",
    "end": "1115710"
  },
  {
    "text": "pivot crawling that we're kind of touching on earlier you know we can also do static analysis by open source tools",
    "start": "1115710",
    "end": "1120899"
  },
  {
    "text": "and that's what we're gonna dive into a little bit further this is something that anybody can replicate its you know",
    "start": "1120899",
    "end": "1126210"
  },
  {
    "text": "it's openly freely available tools and also we take this a step further if you later on as you'll see we have exposed a",
    "start": "1126210",
    "end": "1133080"
  },
  {
    "text": "ton of data for research so just some primitives some tools that we might want to use you know when it comes to",
    "start": "1133080",
    "end": "1139289"
  },
  {
    "start": "1135000",
    "end": "1298000"
  },
  {
    "text": "analyzing Java applets you know we're gonna want to decompile these things so there's a JD core there's the CFR CFR is",
    "start": "1139289",
    "end": "1147750"
  },
  {
    "text": "my favorite that's why it's got the champion symbol next to it JD core is the fastest jad Retro will normalize the",
    "start": "1147750",
    "end": "1153390"
  },
  {
    "text": "version so that more java can be decompiled by these tools and again don't worry about snapshotting this",
    "start": "1153390",
    "end": "1159240"
  },
  {
    "text": "thing because i'm gonna fly through the other ones they're all going to be available and we have tools for flash you know again we're trying to get",
    "start": "1159240",
    "end": "1164580"
  },
  {
    "text": "ActionScript out of Flash we're trying to decompile by code with flash we've got PDF you know",
    "start": "1164580",
    "end": "1170309"
  },
  {
    "text": "we need to decompress streams we need to grab other things out of it we need to pull JavaScript out of out of PDF didier",
    "start": "1170309",
    "end": "1176429"
  },
  {
    "text": "Stevens has some great tools for both PDF and OLEDs you know dot dissecting",
    "start": "1176429",
    "end": "1182999"
  },
  {
    "text": "these common malware formats and then of course Microsoft Office again you know",
    "start": "1182999",
    "end": "1188249"
  },
  {
    "text": "pulling out semantic context with something like this these cat doc or xlsx - CV CSV this is pulling out the",
    "start": "1188249",
    "end": "1194999"
  },
  {
    "text": "actual semantic layer so what was said in the pages of the document what's in the cells of the spreadsheet or",
    "start": "1194999",
    "end": "1201690"
  },
  {
    "text": "something like oh le dump you know get the streams out of that thing take the macro out decompress it you know pulling",
    "start": "1201690",
    "end": "1207179"
  },
  {
    "text": "these things out of that top level format so we can dive into them further so what we've done is we've taken those",
    "start": "1207179",
    "end": "1214529"
  },
  {
    "text": "Yara rules that we went through earlier and we connected to a whole bunch of open source tools and so on a single daily basis every time a new sample is",
    "start": "1214529",
    "end": "1221399"
  },
  {
    "text": "fired on with one of our your rules it comes in and we you know dissect these things at scale you know whether pulling",
    "start": "1221399",
    "end": "1227940"
  },
  {
    "text": "it in from crawlers virustotal everything gets it comes into this ecosystem and a key aspect to it is on",
    "start": "1227940",
    "end": "1235379"
  },
  {
    "text": "the right hand side you'll see this concept of a VT file scanner and file reporter so it takes time for the AV",
    "start": "1235379",
    "end": "1242789"
  },
  {
    "text": "vendors to essentially reach a consensus you know if I see something today first time upload maybe it has one AV",
    "start": "1242789",
    "end": "1250139"
  },
  {
    "text": "detection in two weeks might be ten you know in in six weeks everybody now suddenly has detection for",
    "start": "1250139",
    "end": "1256769"
  },
  {
    "text": "this thing because there's an echo chamber same thing with false positives all right so I look at the age the dust and",
    "start": "1256769",
    "end": "1262769"
  },
  {
    "text": "the maturity when it comes to a file that has been uploaded to virustotal you know how long ago was the first upload",
    "start": "1262769",
    "end": "1268950"
  },
  {
    "text": "when was the last time what's the time in between how many times does ask and the more that you have the more mature",
    "start": "1268950",
    "end": "1274769"
  },
  {
    "text": "the result is the better of a label that might be so if you're looking to build a if you're looking to use AV labels as",
    "start": "1274769",
    "end": "1282179"
  },
  {
    "text": "machine learning to you know classify your data set into benign and malicious",
    "start": "1282179",
    "end": "1287580"
  },
  {
    "text": "doing this kind of recent to the",
    "start": "1287580",
    "end": "1292799"
  },
  {
    "text": "industry's own false positive and false negative biases so let's talk about some",
    "start": "1292799",
    "end": "1300600"
  },
  {
    "start": "1298000",
    "end": "1338000"
  },
  {
    "text": "real-world samples right we did everything we've talked about somewhat theoretical these are all examples of",
    "start": "1300600",
    "end": "1306890"
  },
  {
    "text": "real-world zero-day campaigns that were discovered in the wild everyone responded to them reactively so you've",
    "start": "1306890",
    "end": "1313080"
  },
  {
    "text": "got the CVS up there you know these are all in the same exact areas that we're talking about so this dotnet and these",
    "start": "1313080",
    "end": "1319350"
  },
  {
    "text": "IE vbscript these are actually also reachable from the file formats you",
    "start": "1319350",
    "end": "1325890"
  },
  {
    "text": "don't have to you know hit it by the browser whatnot so then these are the same exact malware doors will carry exploits for these CVS so let's take a",
    "start": "1325890",
    "end": "1333750"
  },
  {
    "text": "look at these you know how we might have found these worms in hindsight if you",
    "start": "1333750",
    "end": "1338760"
  },
  {
    "start": "1338000",
    "end": "1512000"
  },
  {
    "text": "look at the first one Stevi 2018 8174 you know this sample is initially upload to virustotal",
    "start": "1338760",
    "end": "1344040"
  },
  {
    "text": "on April 18th to 2018 and it came from a us-based source the campaign the actual",
    "start": "1344040",
    "end": "1350040"
  },
  {
    "text": "campaign when it launched wasn't until 425 so despite the fact that malware authors know that when they upload a",
    "start": "1350040",
    "end": "1356310"
  },
  {
    "text": "virus total it's going to an entire community of researchers still they're using the tool to test their payloads",
    "start": "1356310",
    "end": "1362400"
  },
  {
    "text": "prior to actually launching these campaigns and that's a pretty decent chunk of time if we can figure out if",
    "start": "1362400",
    "end": "1368340"
  },
  {
    "text": "this sample can stand out to us before the campaign starts we would have been able to find a zero-day we would have",
    "start": "1368340",
    "end": "1374790"
  },
  {
    "text": "been able to burn their zero day before they had a chance to actually launch it in the public domain you know so the",
    "start": "1374790",
    "end": "1380730"
  },
  {
    "text": "campaign launched on 425 the next upload to viral doesn't appear until five nine so it it had a while to spread before",
    "start": "1380730",
    "end": "1387900"
  },
  {
    "text": "someone somewhere caught wind of it and started pulling and pushing it up to the service to see what it was you know came",
    "start": "1387900",
    "end": "1393990"
  },
  {
    "text": "from India Italy Philippines Saudi Arabia more from the US on five ten that",
    "start": "1393990",
    "end": "1399240"
  },
  {
    "text": "you can tell that it these are all indicative when you see it's not guaranteed that this is how the spread",
    "start": "1399240",
    "end": "1404460"
  },
  {
    "text": "is going but generally statistically speaking as you see it where it's being uploaded from that's kind of where it's",
    "start": "1404460",
    "end": "1410250"
  },
  {
    "text": "being targeted to as well so it's kind of spreading out so in five ten we see more coverage now the initial AV",
    "start": "1410250",
    "end": "1416910"
  },
  {
    "text": "detection on this sample was actually quite good you know 16 out of 60 vendors were able to detect this thing it had",
    "start": "1416910",
    "end": "1422250"
  },
  {
    "text": "zero-day in it but it had a bunch of other things about it that heuristic Lee looked you know unco sure and so it",
    "start": "1422250",
    "end": "1429900"
  },
  {
    "text": "stood out from our perspective from the things that we've caught you worming wise this thing has got an",
    "start": "1429900",
    "end": "1436230"
  },
  {
    "text": "object update inside the RTF so that stands out and this is the one where they're using the RTF byte nibble",
    "start": "1436230",
    "end": "1441870"
  },
  {
    "text": "you know recall that just two months prior is when Kaspersky researchers published this obfuscation technique so",
    "start": "1441870",
    "end": "1448320"
  },
  {
    "text": "just by looking for that you would have been able to find this zero day that came across the wire you know two months",
    "start": "1448320",
    "end": "1453809"
  },
  {
    "text": "later you know some screenshots kind of showing detection evolution over time this is coming from from virustotal you",
    "start": "1453809",
    "end": "1460289"
  },
  {
    "text": "know as I mentioned great detection upfront but then as they start sharing you'll see it starts approaching more of a consensus and these are just the",
    "start": "1460289",
    "end": "1468330"
  },
  {
    "text": "results I think this is from the the first day scan yep the guys who caught it interestingly is a lot of overlap",
    "start": "1468330",
    "end": "1473760"
  },
  {
    "text": "like suspiciously exact overlap in what seemingly is a you know not a common",
    "start": "1473760",
    "end": "1481049"
  },
  {
    "text": "name and you might ask yourself why this is the case you know behind the scene just because a lot of guys om each",
    "start": "1481049",
    "end": "1486450"
  },
  {
    "text": "other's products so when you're looking at AV consensus you can't just look at it as each vendor stand alone you know",
    "start": "1486450",
    "end": "1491970"
  },
  {
    "text": "probably all of these guys are only aming the same exact solution so when we look at results we actually weigh all",
    "start": "1491970",
    "end": "1498419"
  },
  {
    "text": "the different vendors you know frankly half of them are way down to a zero because we just don't care about what they think you know the other half have",
    "start": "1498419",
    "end": "1504600"
  },
  {
    "text": "some variable weights associated with them so we can instead of looking at the positive count we're looking at the weight count to see what when something",
    "start": "1504600",
    "end": "1510840"
  },
  {
    "text": "is interesting you know the next example uploaded on January 22nd came from South",
    "start": "1510840",
    "end": "1517650"
  },
  {
    "text": "Korea and only two AV engines detected this one off the bat right and they",
    "start": "1517650",
    "end": "1523080"
  },
  {
    "text": "heuristically were able to identify the sample as malicious but it came with an actual flash zero day later you know",
    "start": "1523080",
    "end": "1531179"
  },
  {
    "text": "whatever that is nine days later someone discovers this thing and they tweet about it so here's another way you could",
    "start": "1531179",
    "end": "1536700"
  },
  {
    "text": "have caught it alright if you're harvesting IOC s from Twitter again if it's an early warning on to one when",
    "start": "1536700",
    "end": "1542010"
  },
  {
    "text": "this guy is talking about he puts the word zero day in there if you put a zero day search on Twitter and you look for IOC s and just shut them in",
    "start": "1542010",
    "end": "1549360"
  },
  {
    "text": "you're gonna start getting what people are talking about so he talks about it on on to one now suddenly the AV",
    "start": "1549360",
    "end": "1556470"
  },
  {
    "text": "detection jumps up to nine vendors because there's some public discussion about it and it becomes it shows up on",
    "start": "1556470",
    "end": "1562350"
  },
  {
    "text": "their radars you start seeing some more uploads on to two by two five twenty vendors have proper detect",
    "start": "1562350",
    "end": "1568059"
  },
  {
    "text": "and how could we have caught this guy using the toolset that we just talked",
    "start": "1568059",
    "end": "1573140"
  },
  {
    "text": "about you know this is an RTF that has an SWF a flash file embedded in it you know again flash is dead in the browser",
    "start": "1573140",
    "end": "1579410"
  },
  {
    "text": "but that's an alive and well sub system you know it's got a great install base still a good attack target for you know",
    "start": "1579410",
    "end": "1586640"
  },
  {
    "text": "for attackers big attack surface you can do action scripts you can manipulate memory if you",
    "start": "1586640",
    "end": "1592040"
  },
  {
    "text": "want to bypass all the built-in compiler and OS protections you need the ability to to manipulate memory some to improve",
    "start": "1592040",
    "end": "1599000"
  },
  {
    "text": "your ability to actually exploit so it's it's a good rich target base from the attacker perspective so anytime we see a",
    "start": "1599000",
    "end": "1605929"
  },
  {
    "text": "flash object embedded anywhere that's super interesting to us especially if it has very low AV detection you know it's",
    "start": "1605929",
    "end": "1611510"
  },
  {
    "text": "not every day that someone's legitimately putting a flash applet in a document sending to someone while it may",
    "start": "1611510",
    "end": "1616730"
  },
  {
    "text": "happen you know in particular if you run this flash applet through one of those decompiling tools and pull the",
    "start": "1616730",
    "end": "1622790"
  },
  {
    "text": "ActionScript out it also tries to do debugger detection now again this is not a hundred percent guarantee that the",
    "start": "1622790",
    "end": "1628700"
  },
  {
    "text": "thing is malicious the digital rights management reasons or you know just anti reversing reasons were why you might",
    "start": "1628700",
    "end": "1634309"
  },
  {
    "text": "want to do debugger detection but that stands out you're just those two things alone the fact that it's embedded in a document and it's doing debugger",
    "start": "1634309",
    "end": "1640370"
  },
  {
    "text": "detection is enough for me to really want to dive into it and and snag it",
    "start": "1640370",
    "end": "1645400"
  },
  {
    "text": "here's the tweet that came out talking about the the lack of patch you know attribution wise it's always a crapshoot",
    "start": "1645400",
    "end": "1652280"
  },
  {
    "text": "but the the thought process was that this was North Korea sourced attacking",
    "start": "1652280",
    "end": "1657980"
  },
  {
    "text": "South Korea with this this O'Dea and actually was quite clever one thing I really liked about it is they had you",
    "start": "1657980",
    "end": "1664520"
  },
  {
    "text": "know most malware is multistage a pivots from one stage to another stage and in this particular case they would they",
    "start": "1664520",
    "end": "1669860"
  },
  {
    "text": "looked at some attributes of the system that was being infected before they sent their zero-day down so actually getting",
    "start": "1669860",
    "end": "1676280"
  },
  {
    "text": "a hold of the zero-day portion of it was a little more difficult because you had to essentially replicate the environments that they",
    "start": "1676280",
    "end": "1682160"
  },
  {
    "text": "were looking for in order for that second stage pivot to come down so in the one hand there were smart operational security wise to not burn",
    "start": "1682160",
    "end": "1688790"
  },
  {
    "text": "their O'Dea by holding it back but on the other hand they burned it by embedding it in a way that was just it",
    "start": "1688790",
    "end": "1694610"
  },
  {
    "text": "stands out a vida tection raid over time again starting off with the two and then",
    "start": "1694610",
    "end": "1700550"
  },
  {
    "text": "settling once it became public knowledge this is what the actual on the top right",
    "start": "1700550",
    "end": "1706370"
  },
  {
    "text": "pink you've got essentially that they extracted source code for checking for debugger detection and then here's just",
    "start": "1706370",
    "end": "1712880"
  },
  {
    "text": "an open source your will you can use for finding these things and will run on the outputs of that ActionScript you know",
    "start": "1712880",
    "end": "1719780"
  },
  {
    "start": "1719000",
    "end": "1806000"
  },
  {
    "text": "the last one is the most interesting one it it was uploaded originally on August 24th and it had no AV detection at all",
    "start": "1719780",
    "end": "1727130"
  },
  {
    "text": "nobody thought it was bad on eight twenty four and nine twelve more people uploaded it you know some folks got hit",
    "start": "1727130",
    "end": "1733640"
  },
  {
    "text": "with this thing and they're like this is looks weird let me put a up to virustotal and see what the with the AV",
    "start": "1733640",
    "end": "1739190"
  },
  {
    "text": "industry on a whole thinks about it and again this is 11 additional scans on this on this file no detection then on",
    "start": "1739190",
    "end": "1748220"
  },
  {
    "text": "nine twelve the zero day campaign is discovered by fire I by the end of the",
    "start": "1748220",
    "end": "1753320"
  },
  {
    "text": "day of nine twelve you've got two vendors that have detection by the next day 30 vendors have detection for this thing so you can see it's a very",
    "start": "1753320",
    "end": "1759170"
  },
  {
    "text": "reactive process so now the question is you know how could we have found this one and again evasive magic so they",
    "start": "1759170",
    "end": "1766970"
  },
  {
    "text": "didn't have the full RTF header at the top they use chaff in this case the chaff that they used was new lines all",
    "start": "1766970",
    "end": "1772550"
  },
  {
    "text": "over the place so it's a RTF file with a truncated header embeds an oily object",
    "start": "1772550",
    "end": "1778040"
  },
  {
    "text": "and they've broken up the text with all the superfluous new lines so the the zero day again stands out because the",
    "start": "1778040",
    "end": "1784430"
  },
  {
    "text": "file format that is encapsulated in is just odd it would never have been generated by a real program you know",
    "start": "1784430",
    "end": "1791210"
  },
  {
    "text": "screenshots showing the lack of detection and even over time you know from a twenty four to nine twelve you've",
    "start": "1791210",
    "end": "1797780"
  },
  {
    "text": "got eleven unique uploads and every single time despite the fact that sharing going on at this stage nobody is",
    "start": "1797780",
    "end": "1803720"
  },
  {
    "text": "detecting this thing quite yet so you know even after we've captured things",
    "start": "1803720",
    "end": "1810500"
  },
  {
    "text": "you know and we're looking at essentially every step of the way were we're pushing things to the side all",
    "start": "1810500",
    "end": "1815750"
  },
  {
    "text": "right we start off with 1.3 million samples we brought it down to twenty-five hundred a day we dissect them with all these different tools to",
    "start": "1815750",
    "end": "1821690"
  },
  {
    "text": "expand out the types of data that's in there you know get another series of rules that run on top of that to start",
    "start": "1821690",
    "end": "1826820"
  },
  {
    "text": "isolating the ones that might be interesting but there's other things we can do to cluster these samples together",
    "start": "1826820",
    "end": "1832380"
  },
  {
    "text": "that allows us to then filter them all right if I've got you know this huge corpus of malware if I find one that I",
    "start": "1832380",
    "end": "1838140"
  },
  {
    "text": "don't think is interesting and I can find other ones that around that that are similar then I can just push those off my radar and not worry about it",
    "start": "1838140",
    "end": "1844140"
  },
  {
    "text": "so you know how can we do this kind of clustering this kind of filtering you know one way is with machine learning",
    "start": "1844140",
    "end": "1849630"
  },
  {
    "text": "algorithms you don't need to use ML classifiers just to determine what is bad and what is good I can even further",
    "start": "1849630",
    "end": "1856410"
  },
  {
    "text": "scrutinize and say hey this is this kind of bad like you know this macro was generated specifically by the a motet",
    "start": "1856410",
    "end": "1862049"
  },
  {
    "text": "polymorphism engine and so if I'm not interested in that because it's it's prolific and I want to find the the",
    "start": "1862049",
    "end": "1868350"
  },
  {
    "text": "needle in the haystack I write a classifier to identify a motet and I say okay push those off right this file",
    "start": "1868350",
    "end": "1874890"
  },
  {
    "text": "specific anchors you know if we're exposing this this content the symbolic information you know perhaps there's a",
    "start": "1874890",
    "end": "1881010"
  },
  {
    "text": "constant or a variable name that is either generated so it's unique or maybe",
    "start": "1881010",
    "end": "1887130"
  },
  {
    "text": "there's a constant that's you leverage in some way some large number for example that again can be used as an",
    "start": "1887130",
    "end": "1893549"
  },
  {
    "text": "anchor so now that I've got all this data I could say okay take this number and then see what other samples have",
    "start": "1893549",
    "end": "1898559"
  },
  {
    "text": "that again you know push it off to the side you know a third option is anchors that are specific to virustotal",
    "start": "1898559",
    "end": "1904620"
  },
  {
    "text": "intelligence when you upload a file to vti you are there's an anonymous",
    "start": "1904620",
    "end": "1910169"
  },
  {
    "text": "uploader ID that goes with it and so if you're consuming the firehose you can keep track of these IDs and you",
    "start": "1910169",
    "end": "1916650"
  },
  {
    "text": "can say okay well what else did that guy upload I don't know who it is but I do know that he uploaded or he or she",
    "start": "1916650",
    "end": "1922650"
  },
  {
    "text": "uploaded these whatever ten million samples I mean so if I find one that might be interesting I might want to go",
    "start": "1922650",
    "end": "1928530"
  },
  {
    "text": "see all the other ones that person uploaded so I can go harvest you know through that you know that's sub corpus",
    "start": "1928530",
    "end": "1933690"
  },
  {
    "text": "you know some notes on clustering there's a couple of different ways that and this could be a talk all on its own",
    "start": "1933690",
    "end": "1939150"
  },
  {
    "start": "1934000",
    "end": "2066000"
  },
  {
    "text": "if this kind of thing interests you we do have a blog coming on the not so distant future that will describe how we",
    "start": "1939150",
    "end": "1945150"
  },
  {
    "text": "utilize actually specific to that example of identifying a motet through the usage of our machine learning",
    "start": "1945150",
    "end": "1951450"
  },
  {
    "text": "algorithms you know there's some basic things though you know this bag of words or a term frequency inverse document",
    "start": "1951450",
    "end": "1957390"
  },
  {
    "text": "frequency which is essentially saying you know for each word that I'm finding or each variable or any it does not be",
    "start": "1957390",
    "end": "1963750"
  },
  {
    "text": "just in a semantic layer it could be in the code layer how unique is it to this sample if it's very unique then",
    "start": "1963750",
    "end": "1969090"
  },
  {
    "text": "again find all the other ones that are like that clump them together push them away you can do k-means clustering",
    "start": "1969090",
    "end": "1974910"
  },
  {
    "text": "instead of looking at semantic features here where we're picking words k-means",
    "start": "1974910",
    "end": "1980580"
  },
  {
    "text": "is more about like you know vectorized features and so the the way I look at this is you know we have 50% of our",
    "start": "1980580",
    "end": "1987810"
  },
  {
    "text": "features or semantics 50% of them or what I call visual or structural you know have you ever looked at a piece of",
    "start": "1987810",
    "end": "1993540"
  },
  {
    "text": "source code and you just look at it for a second you know it's malicious it just has that look it's got gibberish variables the structure of it looks",
    "start": "1993540",
    "end": "2000440"
  },
  {
    "text": "weird you know you can describe that and features you can capture it by looking at things like average comment length",
    "start": "2000440",
    "end": "2006290"
  },
  {
    "text": "average variable length how many variables are there how many functions are there what's the cyclomatic complexity you know each one of these",
    "start": "2006290",
    "end": "2012320"
  },
  {
    "text": "things is a numeric feature we've made a whole bunch of them it comes out to be about a hundred and so you can look at",
    "start": "2012320",
    "end": "2018920"
  },
  {
    "text": "every single document the embedded lots that have come out of it you look at the the way that it looks by this feature",
    "start": "2018920",
    "end": "2025640"
  },
  {
    "text": "set again you can compare and cluster them together that way you know more generic approach is local sensitivity",
    "start": "2025640",
    "end": "2033320"
  },
  {
    "text": "hashing or mean hashing as it's called and again this becomes a very generic method for either taking a vectorized",
    "start": "2033320",
    "end": "2039200"
  },
  {
    "text": "feature set and very quickly being able to compare them contrast them and cluster them we've got a blog on that if",
    "start": "2039200",
    "end": "2045110"
  },
  {
    "text": "you want to read about it I do want to focus more however on you can use AVD section names if there's something",
    "start": "2045110",
    "end": "2050810"
  },
  {
    "text": "specific to the that sample I can find other samples that were to take of that same name but I want to focus on one",
    "start": "2050810",
    "end": "2057169"
  },
  {
    "text": "that we find a lot of valuing called XMP IDs this is a you have an IOC that we've",
    "start": "2057169",
    "end": "2064730"
  },
  {
    "text": "been using for a long time and in talking to two folks about it it's fairly exciting so I want to talk about",
    "start": "2064730",
    "end": "2072080"
  },
  {
    "text": "that and then show how it's done in general when we're talking about last",
    "start": "2072080",
    "end": "2077120"
  },
  {
    "text": "note on the ml business is we have to have your data first your feature selection next and your algorithm last",
    "start": "2077120",
    "end": "2083120"
  },
  {
    "text": "you know as far as I'm concerned I believe that the entire the entirety of the problems that really lives in the",
    "start": "2083120",
    "end": "2089419"
  },
  {
    "text": "the feature selection now you can tune and even fuzz your algorithm so you throw enough compute power power at it",
    "start": "2089419",
    "end": "2094550"
  },
  {
    "text": "to try every algorithm with every tuning mechanism you wanted to but really it comes down to which features you're selecting so that's why",
    "start": "2094550",
    "end": "2101530"
  },
  {
    "text": "we're going to talk about this visual trying to capture what an analyst sees when we're looking at a sample and then semantic you know trying to capture what",
    "start": "2101530",
    "end": "2108040"
  },
  {
    "text": "the intent is algorithm wise listed from least valuable as far as we found it for",
    "start": "2108040",
    "end": "2114130"
  },
  {
    "text": "this specific problem set two most valuable you know great they're all good in their own ways and to some degree maybe you want to consider weighting",
    "start": "2114130",
    "end": "2121180"
  },
  {
    "text": "above them like so for Excel files I'm gonna put a hundred percent weight in gradient boost maybe for Microsoft",
    "start": "2121180",
    "end": "2126609"
  },
  {
    "text": "Office documents it's going to be 5050 between support vector machine and random forests gradient boost stand",
    "start": "2126609",
    "end": "2133060"
  },
  {
    "text": "alone has been the best bang for the buck for us just in terms of speed and efficacy but let's talk about exit PIDs",
    "start": "2133060",
    "end": "2141400"
  },
  {
    "text": "so this is an Adobe format it's Adobe extensible metadata platform it was",
    "start": "2141400",
    "end": "2148089"
  },
  {
    "text": "defined you know back in like 2012 and in essence it is a standard for mapping",
    "start": "2148089",
    "end": "2154570"
  },
  {
    "text": "assets you know parent to child and revisions of that child and it's",
    "start": "2154570",
    "end": "2159940"
  },
  {
    "text": "implemented by original document ID oh ID the document ID the D ID and then the",
    "start": "2159940",
    "end": "2165550"
  },
  {
    "text": "instance ID the I ID so if I have a and I'll show this in a second actually so",
    "start": "2165550",
    "end": "2171099"
  },
  {
    "text": "we'll save it all for them but the key thing here though is that it's an XML format and it's actually updated every",
    "start": "2171099",
    "end": "2176770"
  },
  {
    "text": "time the user updates the asset and it's embedded within the asset which is great for us because that means just coming",
    "start": "2176770",
    "end": "2182440"
  },
  {
    "text": "with the malware lore so if we can grab a unique XMP ID we can use that to pivot",
    "start": "2182440",
    "end": "2187690"
  },
  {
    "text": "to other samples with that same ID you know to give you a visual example of how",
    "start": "2187690",
    "end": "2193000"
  },
  {
    "text": "this works you know we've got three different documents here and where a document is a graphical asset like PNG",
    "start": "2193000",
    "end": "2199000"
  },
  {
    "text": "JPEG whatever and you can see their first ones got a no idea of dead beef every time it saved the instanceid",
    "start": "2199000",
    "end": "2205540"
  },
  {
    "text": "changes and the document ID in this case is the same as the original ID because it's the original then we make a copy of",
    "start": "2205540",
    "end": "2212020"
  },
  {
    "text": "it so we've got the same OID new document ID again every single save instance is generating a new instance ID",
    "start": "2212020",
    "end": "2219190"
  },
  {
    "text": "so in terms of like granularity and amount of fluctuation your instance ID",
    "start": "2219190",
    "end": "2224290"
  },
  {
    "text": "is gonna be moving the most and then we have a third copy of it and so on and so forth there's two formats that we've",
    "start": "2224290",
    "end": "2230109"
  },
  {
    "text": "seen for the act value of this XM PID it's either an md5 hash so 32 bytes or it's a good format",
    "start": "2230109",
    "end": "2237280"
  },
  {
    "text": "so 36 bytes so you know why is this useful you know why do we care about this it's we care because graphical",
    "start": "2237280",
    "end": "2244900"
  },
  {
    "start": "2239000",
    "end": "2390000"
  },
  {
    "text": "assets are very commonly used among malware doors you know for example instead of writing inside the document",
    "start": "2244900",
    "end": "2251950"
  },
  {
    "text": "trying to convince the user to enable active content by clicking on the yellow ribbon since folks are looking for that",
    "start": "2251950",
    "end": "2257680"
  },
  {
    "text": "text down now attackers will take in an image it's got a Microsoft logo on it and it says you know please click enable",
    "start": "2257680",
    "end": "2264099"
  },
  {
    "text": "content so unless you're doing some of that cops'll character recognition you're not going to be able to pull that that text out they've even gotten",
    "start": "2264099",
    "end": "2271000"
  },
  {
    "text": "smarter and in recent history and they're making even difficult for OCR engines to detect by putting like a blue",
    "start": "2271000",
    "end": "2276339"
  },
  {
    "text": "on blue background text or making it like a little bit fuzzy so it'll break the the optical character",
    "start": "2276339",
    "end": "2281890"
  },
  {
    "text": "recognition engine you know you're the weakest link in this chain is going to be your user you send them an email",
    "start": "2281890",
    "end": "2287020"
  },
  {
    "text": "that's password protected and everything looks weird one of them will undo that thing and you know launch that payload",
    "start": "2287020",
    "end": "2293200"
  },
  {
    "text": "you know the other reason why we want to wire this is useful is because graphical assets are commonly lifted from",
    "start": "2293200",
    "end": "2299589"
  },
  {
    "text": "legitimate sources and used in malware campaigns so perhaps if I'm writing a",
    "start": "2299589",
    "end": "2304869"
  },
  {
    "text": "fish for some bank I might go to the bank's actual website pulled their legitimate logo and embed that into my",
    "start": "2304869",
    "end": "2311560"
  },
  {
    "text": "my document maybe I resize it a little bit you know maybe I make it black and white maybe I",
    "start": "2311560",
    "end": "2316720"
  },
  {
    "text": "like merge my layers down but I took that original asset and I used it somewhere in my malware lore so if we do",
    "start": "2316720",
    "end": "2322960"
  },
  {
    "text": "hashes of files that's not great because this tiniest change of course the hash is completely different we can do",
    "start": "2322960",
    "end": "2328960"
  },
  {
    "text": "optical character recognition that's good but there's ways of defeating it and it's slow you can do perception hashing",
    "start": "2328960",
    "end": "2335230"
  },
  {
    "text": "that's better but there's again ways to defeating it and it's even slower but XMP IDs give us",
    "start": "2335230",
    "end": "2340750"
  },
  {
    "text": "the best of both worlds you know they carry with the document they're resilient to change and it's very very",
    "start": "2340750",
    "end": "2345819"
  },
  {
    "text": "quick to both extract and look at it so today as an example you know we watch about a thousand different XMP IDs and",
    "start": "2345819",
    "end": "2352569"
  },
  {
    "text": "this is providing a wealth of valuable information for us where we'll see a sample that comes up even our customer",
    "start": "2352569",
    "end": "2358150"
  },
  {
    "text": "network or comes from borrows total has no detection but we know it's bad we're tracking these XMP IDs that are",
    "start": "2358150",
    "end": "2364040"
  },
  {
    "text": "being reused from campaign a campaign you know another example on this front is I don't know why this woman got",
    "start": "2364040",
    "end": "2370610"
  },
  {
    "text": "chosen but she's a researcher in EU they had made a resume for her they used her",
    "start": "2370610",
    "end": "2376850"
  },
  {
    "text": "profile to send malware lures out and so once we pulled out that XMP ID we looked",
    "start": "2376850",
    "end": "2382190"
  },
  {
    "text": "at our corporate and there was like hundreds of different unique malware samples that were using this poor woman's face in order to go you know",
    "start": "2382190",
    "end": "2387980"
  },
  {
    "text": "infiltrate whoever they were send their resume to so you know we've covered a lot of things and it'd be nice people to",
    "start": "2387980",
    "end": "2395750"
  },
  {
    "start": "2390000",
    "end": "2422000"
  },
  {
    "text": "play with it and I'm big proponent of hands on and so towards that effect you know we're announcing this labs I think",
    "start": "2395750",
    "end": "2401210"
  },
  {
    "text": "what's not net and so it's it's live now and it gives you access to instead of having to build all those things",
    "start": "2401210",
    "end": "2407030"
  },
  {
    "text": "yourself from the our rules so the malware sample harvesting to the extraction and the indexing it just",
    "start": "2407030",
    "end": "2413150"
  },
  {
    "text": "gives you an open API it both interactive to the web interface and just open API access to it now you can",
    "start": "2413150",
    "end": "2419420"
  },
  {
    "text": "pull all sorts of data do all sorts of searches there's you know four really main components to it one of them is a",
    "start": "2419420",
    "end": "2426110"
  },
  {
    "start": "2422000",
    "end": "2537000"
  },
  {
    "text": "document dissector so you can upload files to it if you want and get them dissected you can upload you know hundreds of fostered if you'd like we've",
    "start": "2426110",
    "end": "2433040"
  },
  {
    "text": "seeded it with about a million samples half of them are exposed right now we'll expose the other half at a future date",
    "start": "2433040",
    "end": "2439640"
  },
  {
    "text": "so that's one one key component of it you know give it some malware lure that matura code all of encapsulation and",
    "start": "2439640",
    "end": "2445970"
  },
  {
    "text": "it'll dissect it and extract the semantic layer it'll do optical character recognition it'll pull out IOC",
    "start": "2445970",
    "end": "2451400"
  },
  {
    "text": "is it'll pull out the embedded logic it'll do some some decoding it'll make your your life as an analyst you know",
    "start": "2451400",
    "end": "2457880"
  },
  {
    "text": "just much easier for both upload and querying it now we've also open-source a bunch of your our generators and helpers",
    "start": "2457880",
    "end": "2464960"
  },
  {
    "text": "you know we use euro daily in a number of different ways and so to help make our lives easier there's some things",
    "start": "2464960",
    "end": "2471290"
  },
  {
    "text": "that are very manually tedious to do and so we went through the extra manually tedious process of automating it one",
    "start": "2471290",
    "end": "2477020"
  },
  {
    "text": "time and that allows you to just do it so things like if I'm trying to write a rule that is for hex encoded content but",
    "start": "2477020",
    "end": "2484940"
  },
  {
    "text": "I want to be a mixed case that's a pain in the ass to write I can do it once and this will generate it for me now I can",
    "start": "2484940",
    "end": "2491390"
  },
  {
    "text": "convert strings to UN conditions as a performance loosing thing I'll let you guys go read",
    "start": "2491390",
    "end": "2496840"
  },
  {
    "text": "about it on the actual site the most impressive one I think is the base64 wreckage generator we were able to take",
    "start": "2496840",
    "end": "2503380"
  },
  {
    "text": "regular expressions that you write for plaintext and we will spit out the basic C 4 encoded version of that regular",
    "start": "2503380",
    "end": "2509200"
  },
  {
    "text": "expression as a real-world example of how we use this today with with great results we've taken a whole bunch of",
    "start": "2509200",
    "end": "2515350"
  },
  {
    "text": "powershell directives that we consider to be malicious and we've generated a bunch of red Xs for it fed it through",
    "start": "2515350",
    "end": "2521440"
  },
  {
    "text": "this system and now we've got a y RF signature looking for farlis malware that has weird PowerShell pivots in it",
    "start": "2521440",
    "end": "2527920"
  },
  {
    "text": "you can even do it twice so if you want to do double basis scans for code it you can't if you want to wide care basic",
    "start": "2527920",
    "end": "2533950"
  },
  {
    "text": "super encoded you can do that as well so all that is available you know as an example you know the end if you hit this",
    "start": "2533950",
    "end": "2540880"
  },
  {
    "start": "2537000",
    "end": "2568000"
  },
  {
    "text": "it would just work here's API driven example where I'm giving it PowerShell that's giving you back hex encoded",
    "start": "2540880",
    "end": "2546780"
  },
  {
    "text": "variable case here's one where it's converting the RTF magic at zero instead",
    "start": "2546780",
    "end": "2553570"
  },
  {
    "text": "of having a string comparison which is slow in your high throughput terms this is converting it to an integer",
    "start": "2553570",
    "end": "2560220"
  },
  {
    "text": "dereference so it's instantaneous is this value at that address as opposed to scan the entire document for these",
    "start": "2560220",
    "end": "2566620"
  },
  {
    "text": "values and then show me where it's at and then the base64 record generator and you can see I mean if you can believe",
    "start": "2566620",
    "end": "2573700"
  },
  {
    "start": "2568000",
    "end": "2602000"
  },
  {
    "text": "this a tipping point we used to write these things and it was a nightmare to write and a nightmare to to compare",
    "start": "2573700",
    "end": "2579220"
  },
  {
    "text": "so we ended up at some point building a tool that automated this process for us so you can send a string up to the our",
    "start": "2579220",
    "end": "2586360"
  },
  {
    "text": "cloud service and we'll just send you back the regular expression I will say that this can get messy real fast you",
    "start": "2586360",
    "end": "2592240"
  },
  {
    "text": "know if you go too far with it there's no reg X engine in the world that's gonna run that thing at any kind of reasonable speed so you know a caveat",
    "start": "2592240",
    "end": "2599260"
  },
  {
    "text": "emptor on that front you know I mentioned everything else is is is API",
    "start": "2599260",
    "end": "2605890"
  },
  {
    "start": "2602000",
    "end": "2640000"
  },
  {
    "text": "accessible and there's two other tools that we've exposed through it one of them is a reputation aggregation so we",
    "start": "2605890",
    "end": "2611200"
  },
  {
    "text": "have aggregated like two dozen different sources into a single searchable interface so again you can use that as a",
    "start": "2611200",
    "end": "2617470"
  },
  {
    "text": "source of places to go pivot off of to pull down more more malware samples and whatnot from and finally IOC aggregation",
    "start": "2617470",
    "end": "2624850"
  },
  {
    "text": "from Twitter you know there's a lot of people that we fall we think are do neat work generally when they put out some kind of",
    "start": "2624850",
    "end": "2630519"
  },
  {
    "text": "URL or hash like we'll go check it out and so this is just an aggregation of all that as well and again entirely API",
    "start": "2630519",
    "end": "2637509"
  },
  {
    "text": "accessible and with that you know if you guys have any questions about the the",
    "start": "2637509",
    "end": "2644229"
  },
  {
    "start": "2640000",
    "end": "2671000"
  },
  {
    "text": "work or you want to work together on aims for interesting samples you know please don't hesitate to reach out get in touch and just a quick thank you to",
    "start": "2644229",
    "end": "2650589"
  },
  {
    "text": "some of my colleagues for sending the audience and help me out with all this william macarthur amir neocon who some",
    "start": "2650589",
    "end": "2657099"
  },
  {
    "text": "of you guys may know as dissect malware is pretty prolific on twitter and adam luciano a big thanks to them for helping",
    "start": "2657099",
    "end": "2663190"
  },
  {
    "text": "me put all this together well thank you guys very much I appreciate it and just open up any questions you might have if",
    "start": "2663190",
    "end": "2672339"
  },
  {
    "start": "2671000",
    "end": "2809000"
  },
  {
    "text": "you do have questions there's mics in the middle aisles otherwise I'll be hanging around for a little while Oh on another note if you enjoy my",
    "start": "2672339",
    "end": "2678279"
  },
  {
    "text": "Couture over here we do have a bunch of t-shirts in the back Adam be happy to hook you up with one any questions yeah",
    "start": "2678279",
    "end": "2704979"
  },
  {
    "text": "they're gonna post the slides and if you just later on today when I get back to the hotel just do a blog that inquests",
    "start": "2704979",
    "end": "2711249"
  },
  {
    "text": "not net and we'll have it up there all right hello so I think this should be an easy",
    "start": "2711249",
    "end": "2718299"
  },
  {
    "text": "question for you how have you been able to tie back when you do find an exploit within malware to the correct CDE what",
    "start": "2718299",
    "end": "2726009"
  },
  {
    "text": "are you doing a lot of Bend if analysis when patches are being released and",
    "start": "2726009",
    "end": "2731739"
  },
  {
    "text": "that's kind of helping you with that level of attribution for lack of a better term so the question was how are",
    "start": "2731739",
    "end": "2737859"
  },
  {
    "text": "you mapping you know when you see an exploit how do you then map that to the CVE you know if it's already been",
    "start": "2737859",
    "end": "2744700"
  },
  {
    "text": "published chances are one of your tools are gonna label it on their own you know we're when you're looking for",
    "start": "2744700",
    "end": "2751269"
  },
  {
    "text": "like if we were to write a signature for example to detect a specific CV you know I'm writing it specific to it so when I",
    "start": "2751269",
    "end": "2756969"
  },
  {
    "text": "see it fire I see that that is what it was if you find something that",
    "start": "2756969",
    "end": "2762130"
  },
  {
    "text": "is exporting your system and your fully passionate and O'Dea you know you're then gonna have a CV associated with it",
    "start": "2762130",
    "end": "2767470"
  },
  {
    "text": "you know moving forward so it's a you know whether you're looking at it in hindsight we're looking at it forward",
    "start": "2767470",
    "end": "2772630"
  },
  {
    "text": "that's the answer there that makes sense would you say for you in practice it's",
    "start": "2772630",
    "end": "2778839"
  },
  {
    "text": "better to run a fully patched system that you're executing your malware on or do you run vulnerable system if we're",
    "start": "2778839",
    "end": "2784720"
  },
  {
    "text": "you know if we're looking for this kind of thing where we're looking for a no date you want a fully patch system you",
    "start": "2784720",
    "end": "2790809"
  },
  {
    "text": "know you want it to be a system where if it did if something did get compromised it it's interesting you know otherwise",
    "start": "2790809",
    "end": "2797140"
  },
  {
    "text": "if you're shooting for like Windows XP or you know some of the low-hanging fruit there's gonna be plenty of noise there so I would go with a fully patched",
    "start": "2797140",
    "end": "2802979"
  },
  {
    "text": "system that you expect to see in production thank you for being generous",
    "start": "2802979",
    "end": "2808239"
  },
  {
    "text": "with your knowledge thank you thanks",
    "start": "2808239",
    "end": "2811829"
  }
]