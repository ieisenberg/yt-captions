[
  {
    "start": "0",
    "end": "109000"
  },
  {
    "text": "welcome everybody to this talk it's called doors of durin the Velcade - siemens s7 silicon there's going to be",
    "start": "30",
    "end": "6899"
  },
  {
    "text": "about some research that we performed on s7 plcs which are program programmable",
    "start": "6899",
    "end": "13679"
  },
  {
    "text": "logic controllers from siemens and we specifically performed some research on the bootloader code as well as the femur",
    "start": "13679",
    "end": "21270"
  },
  {
    "text": "itself and we will show some of the special access features that we",
    "start": "21270",
    "end": "28019"
  },
  {
    "text": "found in there all right we are three people who worked on this it's Ali",
    "start": "28019",
    "end": "33690"
  },
  {
    "text": "Abbasi who was a PhD student at the time and I helped him then and since then I",
    "start": "33690",
    "end": "39989"
  },
  {
    "text": "got a PhD student myself and he postdoc researcher sadly he couldn't get a visa",
    "start": "39989",
    "end": "46649"
  },
  {
    "text": "and time he asked for a minute of silence about this exactly we don't have time for this so let's start with a",
    "start": "46649",
    "end": "52770"
  },
  {
    "text": "presentation so as an outline of our talk first we want to get into a bit of what is",
    "start": "52770",
    "end": "58859"
  },
  {
    "text": "automation what do we need it for and how is it used in the industrial context then we want to get into the",
    "start": "58859",
    "end": "65790"
  },
  {
    "text": "hardware of a Siemens PLC what does it look like on the inside what components are on the boards and stuff like this",
    "start": "65790",
    "end": "70979"
  },
  {
    "text": "afterwards we see the the software part of it first the startup process and some",
    "start": "70979",
    "end": "78330"
  },
  {
    "text": "components of the Siemens fumer to give you an overview of what it can actually do and also some details on where you",
    "start": "78330",
    "end": "83880"
  },
  {
    "text": "might want to find different pieces of functionality inside the femur itself and afterwards we will talk about a",
    "start": "83880",
    "end": "90000"
  },
  {
    "text": "special access feature which we found inside the boot loader itself and have some demos about it as well all right so",
    "start": "90000",
    "end": "97320"
  },
  {
    "text": "if we think about process automation the first may be pretty trivial example is",
    "start": "97320",
    "end": "103110"
  },
  {
    "text": "what we would do at home we have a some temperature sensor and we would like to",
    "start": "103110",
    "end": "110420"
  },
  {
    "start": "109000",
    "end": "109000"
  },
  {
    "text": "control the heat inside our house for example and in this simple application",
    "start": "110420",
    "end": "116280"
  },
  {
    "text": "we would have the sensor on the one side telling the heater to either increase or",
    "start": "116280",
    "end": "121950"
  },
  {
    "text": "lower its heating power based on what kind of temperature we would like to",
    "start": "121950",
    "end": "127710"
  },
  {
    "text": "have so this may get much more complex right so if you look at a factory where",
    "start": "127710",
    "end": "133200"
  },
  {
    "start": "129000",
    "end": "129000"
  },
  {
    "text": "you do actual",
    "start": "133200",
    "end": "136520"
  },
  {
    "text": "products that you want to produce or you want to maybe steer some of chemical",
    "start": "138800",
    "end": "144120"
  },
  {
    "text": "processes and stuff like this you get into much more complex processes which we can monitor via something that we",
    "start": "144120",
    "end": "151440"
  },
  {
    "text": "call hm eyes which are human-machine interfaces you can see some of those here and some operator",
    "start": "151440",
    "end": "157590"
  },
  {
    "text": "sitting in front of those there is a wealth of data which can be potentially",
    "start": "157590",
    "end": "162980"
  },
  {
    "text": "displayed to those operators and a lot of detail that they have to take care of",
    "start": "162980",
    "end": "168420"
  },
  {
    "text": "but in order to get this data we have to have actual sensor information that",
    "start": "168420",
    "end": "174299"
  },
  {
    "text": "comes to those places and this is not as trivial as it's as you can probably",
    "start": "174299",
    "end": "181620"
  },
  {
    "text": "imagine and what we use for this is PLC's one of the",
    "start": "181620",
    "end": "186650"
  },
  {
    "start": "186000",
    "end": "186000"
  },
  {
    "text": "like a diagram of how this typically works is here you can see here it's the",
    "start": "186650",
    "end": "192600"
  },
  {
    "text": "inputs which are typically sensor values this could be like a temperature this could be the level of a of a liquid",
    "start": "192600",
    "end": "200430"
  },
  {
    "text": "inside a tank something like this and there are outputs the outputs which steer actual motors actuators and",
    "start": "200430",
    "end": "206930"
  },
  {
    "text": "something like a pump for example and in the middle we need some logic and we encode this logic in programs which in",
    "start": "206930",
    "end": "215070"
  },
  {
    "text": "the PLC field are letter logic programs or structure text programs and those are",
    "start": "215070",
    "end": "221070"
  },
  {
    "text": "downloaded onto the PLC which then calculates the logic based on the inputs",
    "start": "221070",
    "end": "226530"
  },
  {
    "text": "that it gets and puts out the outputs in order to steer such a process this can",
    "start": "226530",
    "end": "231750"
  },
  {
    "text": "even get much more complex than this for example if you had a lot of different PLC's from different times when you",
    "start": "231750",
    "end": "239130"
  },
  {
    "text": "bought them they speak different protocols and it kind of gets the zoo of PLC's basically and inside a factory you",
    "start": "239130",
    "end": "246660"
  },
  {
    "text": "could start putting in an additional appliance which takes care of translating those",
    "start": "246660",
    "end": "253170"
  },
  {
    "text": "protocols and making those PLC's work together but we will not focus on those",
    "start": "253170",
    "end": "258389"
  },
  {
    "text": "kinds of control service at the moment but on PLC's here you can see some applications of",
    "start": "258389",
    "end": "264710"
  },
  {
    "text": "of plcs and for example a chemical plant or in the electric grid or",
    "start": "264710",
    "end": "271570"
  },
  {
    "text": "manufacturing or pretty critical parts of our infrastructure which we don't",
    "start": "271570",
    "end": "277250"
  },
  {
    "text": "want to have damaged at all for example if you went to Google some images about",
    "start": "277250",
    "end": "283210"
  },
  {
    "text": "chemical plants having some accidents you can just basically see a melted plant just down there this might be by",
    "start": "283210",
    "end": "289580"
  },
  {
    "text": "accident but also we want to prevent this happening on on a malicious intent",
    "start": "289580",
    "end": "295509"
  },
  {
    "text": "here we can see some recent attacks as well it started in 99 where first",
    "start": "295509",
    "end": "301160"
  },
  {
    "start": "296000",
    "end": "296000"
  },
  {
    "text": "reconnaissance activities were reported and then in 2010 we had kind of the big",
    "start": "301160",
    "end": "307580"
  },
  {
    "text": "bang you could say of intrusions into those systems with Stuxnet which you've",
    "start": "307580",
    "end": "314599"
  },
  {
    "text": "probably all heard of if you look into the details and kind of brainstorm what goes into getting this operation to take",
    "start": "314599",
    "end": "321020"
  },
  {
    "text": "it's pretty impressive and a lot of people with a lot of different backgrounds have to work together to",
    "start": "321020",
    "end": "326240"
  },
  {
    "text": "make it work and in 2015 2016 we could observe some of those",
    "start": "326240",
    "end": "333680"
  },
  {
    "text": "attacks on the Ukraine power grid just before Christmas in those two years shutting down parts of the whole",
    "start": "333680",
    "end": "340729"
  },
  {
    "text": "electric grid of a city or so here we can get some feeling about what",
    "start": "340729",
    "end": "346909"
  },
  {
    "text": "it where Siemens is positioned inside the market so together with Rockwell",
    "start": "346909",
    "end": "352039"
  },
  {
    "text": "Automation we can see that it's more than a 50% market share so if there are",
    "start": "352039",
    "end": "357050"
  },
  {
    "text": "any issues and one of those human species you will can imagine them to be spread around a lot of facilities and",
    "start": "357050",
    "end": "364430"
  },
  {
    "text": "that's where there can be quite a bit of an impact if there is any security vulnerabilities there okay here we you",
    "start": "364430",
    "end": "371990"
  },
  {
    "text": "can see the specific PLC that we are going to target here which is the s7",
    "start": "371990",
    "end": "378310"
  },
  {
    "text": "1200 if you exclude the logo which is a bit of a even smaller sample it's one of",
    "start": "378310",
    "end": "385159"
  },
  {
    "text": "the more accessible PLC's it's around 250 euros I think which is rather",
    "start": "385159",
    "end": "391460"
  },
  {
    "text": "accessible in comparison to other bigger appliances but then if you start like frying a PLC or two maybe thing one then",
    "start": "391460",
    "end": "399139"
  },
  {
    "text": "it can still get quite expensive I can tell you the applications gets as we",
    "start": "399139",
    "end": "405889"
  },
  {
    "text": "already saw before are in pretty critical environments here we can see",
    "start": "405889",
    "end": "411680"
  },
  {
    "text": "the actual hardware view of such an s7 1200 PLC on the top you can see the",
    "start": "411680",
    "end": "418759"
  },
  {
    "text": "first layer of PCB boards it's it's different PCB stacked but all the magic",
    "start": "418759",
    "end": "423800"
  },
  {
    "text": "that we care about is going on in the first layer which we can see some details about here the left-hand picture",
    "start": "423800",
    "end": "431300"
  },
  {
    "text": "you can see is the the top side of the first layer of PCB and",
    "start": "431300",
    "end": "438789"
  },
  {
    "text": "it has once some of the main components there for example as you can see the arm",
    "start": "438789",
    "end": "444259"
  },
  {
    "text": "CPU which does the general-purpose computations and then also the flash",
    "start": "444259",
    "end": "449719"
  },
  {
    "text": "chip which holds the fumer image as well as some RAM pretty sizable and in fact",
    "start": "449719",
    "end": "457249"
  },
  {
    "text": "on the right side we can see the flip side of the same PCB and there we can",
    "start": "457249",
    "end": "462919"
  },
  {
    "text": "see an SPI a flash chip which is smaller and takes and carries the bootloader",
    "start": "462919",
    "end": "469759"
  },
  {
    "text": "code first of all what we looked at was the CPU itself we wanted to kind of get a",
    "start": "469759",
    "end": "476060"
  },
  {
    "start": "471000",
    "end": "471000"
  },
  {
    "text": "view of what exactly we're working with and this is some decapping of the arm",
    "start": "476060",
    "end": "483439"
  },
  {
    "text": "CPU and you can see the exact models on there which is a Renaissance model from",
    "start": "483439",
    "end": "489860"
  },
  {
    "text": "2010 in this case and we also looked into the exact hardware ID that this",
    "start": "489860",
    "end": "495979"
  },
  {
    "text": "cortex are for chip as we can see here is made of so there are instructions in",
    "start": "495979",
    "end": "501379"
  },
  {
    "text": "the arm instruction set that you can cure you those different values and you can pass those bit fields and then you",
    "start": "501379",
    "end": "506659"
  },
  {
    "text": "can see that it's in fact the cortex our four core with a specific revision",
    "start": "506659",
    "end": "512479"
  },
  {
    "text": "number and so on so if you are assuming that you're working with a specific device you may as well check and this is",
    "start": "512479",
    "end": "518448"
  },
  {
    "text": "the way you can check that you're actually on the exact version that you think about here is a look at the not the",
    "start": "518449",
    "end": "525860"
  },
  {
    "start": "523000",
    "end": "523000"
  },
  {
    "text": "computation side but the storage side we can see the different flashes in a close-up view of",
    "start": "525860",
    "end": "531120"
  },
  {
    "text": "the firmware one the bootloader one and the RAM chip as well it notably carries",
    "start": "531120",
    "end": "537960"
  },
  {
    "text": "an MP u as well so there is some possibility to configure",
    "start": "537960",
    "end": "544580"
  },
  {
    "text": "memory protections so in order to care about any memory corruption that",
    "start": "544580",
    "end": "551460"
  },
  {
    "text": "could occur or maybe also the running code inside the data section or so you",
    "start": "551460",
    "end": "556710"
  },
  {
    "text": "can try to prevent this by using the MP U which is also used as we can see in",
    "start": "556710",
    "end": "561720"
  },
  {
    "text": "later slides oh I think I skipped one there right yeah this is the this is a",
    "start": "561720",
    "end": "567920"
  },
  {
    "start": "565000",
    "end": "565000"
  },
  {
    "text": "more detailed look on the bootloader chip here we can see the different",
    "start": "567920",
    "end": "575060"
  },
  {
    "text": "chips the same chip in different views and what we can see on the right hand",
    "start": "575060",
    "end": "580740"
  },
  {
    "text": "corner we can see a little mount that Ali built this is a little bit of an exclaim ER from my side that he did most",
    "start": "580740",
    "end": "587730"
  },
  {
    "text": "of the hardware part and I'm more of the software guy so he created a mount on top of the actual cortex our for CPU",
    "start": "587730",
    "end": "594870"
  },
  {
    "text": "which routes connections down to the bottom side of the PCB and connects to",
    "start": "594870",
    "end": "601110"
  },
  {
    "text": "the bootloader chip so we had a mount to get better access to food loader ship so",
    "start": "601110",
    "end": "606180"
  },
  {
    "text": "we could play around with it more easily we also took some x-ray of the PCB",
    "start": "606180",
    "end": "613170"
  },
  {
    "start": "609000",
    "end": "609000"
  },
  {
    "text": "itself it's we are using this for an ongoing project but it's also was used in order",
    "start": "613170",
    "end": "620280"
  },
  {
    "text": "for us to be able to find specific functionality of the of the PCB and",
    "start": "620280",
    "end": "626400"
  },
  {
    "text": "maybe some connectors which we will see in two slides here first we have the PCB",
    "start": "626400",
    "end": "632790"
  },
  {
    "text": "itself it's a two layered in its core like the top and the bottom part and then in the middle we have a plate",
    "start": "632790",
    "end": "639140"
  },
  {
    "text": "having being connected to ground and then VCC as well in the middle",
    "start": "639140",
    "end": "645260"
  },
  {
    "text": "here's the the one of the functionalities that we actually were after which is coresight I don't know if",
    "start": "645260",
    "end": "650760"
  },
  {
    "text": "anybody has heard of that but it's kind of equivalent to into PT process trays",
    "start": "650760",
    "end": "657300"
  },
  {
    "text": "which allows you to after the fact of execution see some trace information about",
    "start": "657300",
    "end": "663690"
  },
  {
    "text": "code coverage and the like which could be interesting in both",
    "start": "663690",
    "end": "669740"
  },
  {
    "text": "reverse engineering applications maybe understanding an application or also maybe fuzzing as well",
    "start": "669740",
    "end": "675770"
  },
  {
    "text": "now we get to the software side of things which I was much more involved in involved with as a matter of fact here",
    "start": "675770",
    "end": "683700"
  },
  {
    "text": "you can see a bit of sizing information so it's like 13 and B of just flat",
    "start": "683700",
    "end": "689220"
  },
  {
    "text": "binary code which is kind of a bit you can see here I'm not sure if you can see that it's about 84,000 functions so it's",
    "start": "689220",
    "end": "697590"
  },
  {
    "text": "a it's a nice mating call from a from a few more image if it's that much for",
    "start": "697590",
    "end": "703200"
  },
  {
    "text": "reverse engineer you can obviously not look at everything also we can see some of the names that I provided like some",
    "start": "703200",
    "end": "710040"
  },
  {
    "text": "get some exercise so I'm not quite sure about everything as you can see but for other functions we have quite a bit of",
    "start": "710040",
    "end": "717390"
  },
  {
    "text": "information already knowing what they are doing in the context of the operating system which I",
    "start": "717390",
    "end": "724290"
  },
  {
    "text": "will describe a bit more in detail yeah so I think I applied around 50 Ida",
    "start": "724290",
    "end": "730290"
  },
  {
    "text": "Python scripts I guess to get to the point of 84,000 functions so it's a you can do",
    "start": "730290",
    "end": "736170"
  },
  {
    "text": "some automation to make it your life a bit more easy there all right first of",
    "start": "736170",
    "end": "741330"
  },
  {
    "text": "all let's look at what the bootloader does and it starts a process it's kind of what you would expect it to do the",
    "start": "741330",
    "end": "746640"
  },
  {
    "text": "bootloader basically wants to get the heart we're ready for the second stage payload to be executed and",
    "start": "746640",
    "end": "751760"
  },
  {
    "text": "here we see that for example the vector interrupt controller I set up different hardware parts but also it checks the",
    "start": "751760",
    "end": "758250"
  },
  {
    "text": "integrity of the bootloader code itself and also the femur the",
    "start": "758250",
    "end": "764390"
  },
  {
    "text": "thing to note here is that it's using crc32 which is only something that can",
    "start": "764390",
    "end": "770790"
  },
  {
    "text": "check for non intentional changes to the femur so",
    "start": "770790",
    "end": "776610"
  },
  {
    "text": "if like physical memory was corrupted by some way but if somebody got control",
    "start": "776610",
    "end": "781860"
  },
  {
    "text": "over this it's not a cryptographically secure checksum so the bootloader doesn't perform any cryptographically",
    "start": "781860",
    "end": "788070"
  },
  {
    "text": "secure checks just before running the firmware image which is interesting to",
    "start": "788070",
    "end": "793950"
  },
  {
    "text": "note also the chip that we saw the SPI flash ship which holds the bootloader was changed",
    "start": "793950",
    "end": "799970"
  },
  {
    "text": "in 2018 it wasn't really documented by Siemens I think but we noticed it that",
    "start": "799970",
    "end": "805670"
  },
  {
    "text": "there were right protections all of a sudden on this chip here we can see similar information but",
    "start": "805670",
    "end": "813410"
  },
  {
    "text": "in a bit of a different representation but we can also what we can also see is here in the bottom left",
    "start": "813410",
    "end": "819980"
  },
  {
    "text": "it's a pretty juicy thing which is a special access feature which we were able to identify which we will talk",
    "start": "819980",
    "end": "828350"
  },
  {
    "text": "about it just a little bit later so a bit of a cliffhanger here let's first get into the firmware and the different",
    "start": "828350",
    "end": "835550"
  },
  {
    "text": "components of it here we can see an overview of those few more components",
    "start": "835550",
    "end": "840920"
  },
  {
    "start": "837000",
    "end": "837000"
  },
  {
    "text": "it's kind of split into two parts first of all it's called the adonus rtos",
    "start": "840920",
    "end": "846319"
  },
  {
    "text": "internally this is also not a documented feature but it's just the Siemens internal name for",
    "start": "846319",
    "end": "854930"
  },
  {
    "text": "it as we found out and you can see two different areas of services the first",
    "start": "854930",
    "end": "861319"
  },
  {
    "text": "one would be more general services which you would expect from any operating system when it works in an in a rather",
    "start": "861319",
    "end": "868130"
  },
  {
    "text": "complex environment it needs to talk to its outside world so it needs tcp/ip to",
    "start": "868130",
    "end": "873860"
  },
  {
    "text": "work it needs a C++ library just to do",
    "start": "873860",
    "end": "878930"
  },
  {
    "text": "basic programming functionality and also it wants to handle a file system so",
    "start": "878930",
    "end": "883970"
  },
  {
    "text": "other those components you will find on the left-hand side there's also diagnosis and a web server are those",
    "start": "883970",
    "end": "890389"
  },
  {
    "text": "things which are not directly related to automation but more to a general purpose operating system on the right side on",
    "start": "890389",
    "end": "897649"
  },
  {
    "text": "the other hand you can see that there are quite a lot of functionality which is related to automation processes as we",
    "start": "897649",
    "end": "904880"
  },
  {
    "text": "might expect so for example the MC 7p parser as well as runtime and compiler",
    "start": "904880",
    "end": "910610"
  },
  {
    "text": "is the the runtime for the code that we can download onto the plc the letter",
    "start": "910610",
    "end": "917509"
  },
  {
    "text": "logic that we were talking about before and also some other programming languages",
    "start": "917509",
    "end": "924829"
  },
  {
    "text": "like the automated web programming which also runs on the plc alright now we got some information",
    "start": "924829",
    "end": "932510"
  },
  {
    "start": "930000",
    "end": "930000"
  },
  {
    "text": "about different memory maps and address ranges and stuff like this which we will find",
    "start": "932510",
    "end": "938360"
  },
  {
    "text": "in such a few more image and why it's running so one thing that is important to know here",
    "start": "938360",
    "end": "945800"
  },
  {
    "text": "is that for cortex our 4 processor which we are working with here in this case they store they Bank as",
    "start": "945800",
    "end": "954320"
  },
  {
    "text": "they call it different registers for every execution mode and then you have different stacks for those modes and it",
    "start": "954320",
    "end": "960050"
  },
  {
    "text": "might be interesting to know in this context if you wanted to do something like forensic work or even do some",
    "start": "960050",
    "end": "966470"
  },
  {
    "text": "reverse engineering it's interesting to know those addresses which we extracted here for you",
    "start": "966470",
    "end": "972220"
  },
  {
    "text": "we have some have a dump of the different memory regions as well so if we wanted to get a",
    "start": "972220",
    "end": "978350"
  },
  {
    "text": "little bit of an overview of where things reside in memory we could find it",
    "start": "978350",
    "end": "983690"
  },
  {
    "text": "here and for example the uninitialized section which is somewhere down here is dealing with",
    "start": "983690",
    "end": "990400"
  },
  {
    "text": "dynamically allocated memory if we wanted to find some code we would look in the text section if we wanted to find read-only code we would look into the",
    "start": "990400",
    "end": "997340"
  },
  {
    "text": "auro data section and if we looked in wanted to look at what is going on and",
    "start": "997340",
    "end": "1002470"
  },
  {
    "text": "the boot process of the femur itself who would look at the th initial section which we will talk about a bit in the",
    "start": "1002470",
    "end": "1008140"
  },
  {
    "text": "next slides another thing that has not been documented before is also",
    "start": "1008140",
    "end": "1014130"
  },
  {
    "text": "interesting in the sense that we can talk to Hardware directly which is mm IO",
    "start": "1014130",
    "end": "1019390"
  },
  {
    "text": "memory mapped i/o and we have some of those ranges here we can see that different",
    "start": "1019390",
    "end": "1024420"
  },
  {
    "text": "pieces of functionality and hardware is supported for example SPI SPI flash is",
    "start": "1024420",
    "end": "1031240"
  },
  {
    "text": "support of course so we can talk to SPI directly or we have a bunch of timers and we have an analog to digital control",
    "start": "1031240",
    "end": "1038860"
  },
  {
    "text": "and so on so if you if we wanted to create for example a driver for this we could use those ranges to implement it",
    "start": "1038860",
    "end": "1045689"
  },
  {
    "text": "here we see as a final thing about addresses we see some MPU configurations",
    "start": "1045690",
    "end": "1052330"
  },
  {
    "start": "1046000",
    "end": "1046000"
  },
  {
    "text": "so memory protection you in configurations as you can see there are some protections that Siemens put into",
    "start": "1052330",
    "end": "1058900"
  },
  {
    "text": "place here for example the xn bit which is the execute never which kind of known of course as the name says know execute",
    "start": "1058900",
    "end": "1066820"
  },
  {
    "text": "bit it's said for some sections and we also have some protection such as read only for other sections as well so",
    "start": "1066820",
    "end": "1073720"
  },
  {
    "text": "Simmons is dealing with some of the memory protections in this case as you can see here we can see the the",
    "start": "1073720",
    "end": "1081400"
  },
  {
    "start": "1079000",
    "end": "1079000"
  },
  {
    "text": "different steps that the femur itself does is the second stage after the bootloader is executing it kind of",
    "start": "1081400",
    "end": "1089320"
  },
  {
    "text": "replicates what the bootloader does basically sets up the hardware space and",
    "start": "1089320",
    "end": "1094750"
  },
  {
    "text": "so on so it's basically doesn't want to depend too much on the internals of the bootloader I would imagine but then if",
    "start": "1094750",
    "end": "1100750"
  },
  {
    "text": "we go into the second stage which is the adonus kernel itself it does",
    "start": "1100750",
    "end": "1107250"
  },
  {
    "start": "1101000",
    "end": "1101000"
  },
  {
    "text": "initialization a kind of interesting manner where it Curie's a whole table of",
    "start": "1107250",
    "end": "1113010"
  },
  {
    "text": "function pointers and calls them one after the other this is interesting to note because as a reverse engineer we",
    "start": "1113010",
    "end": "1119320"
  },
  {
    "text": "might be interested in what kind of hardware components are initialized in the system and we can see",
    "start": "1119320",
    "end": "1125980"
  },
  {
    "text": "for every hardware component can figure out what kind of data structures are set up and how are they are used and initialized",
    "start": "1125980",
    "end": "1134020"
  },
  {
    "text": "and so on so if we wanted to understand more about the in terms of a specific component inside the system we could",
    "start": "1134020",
    "end": "1139690"
  },
  {
    "text": "look at some of those pointers here for example what is set up is a tracing",
    "start": "1139690",
    "end": "1145270"
  },
  {
    "text": "system different XML parsers the meaning web web server and so on here we can see",
    "start": "1145270",
    "end": "1153220"
  },
  {
    "text": "also the the file system that it's it supports a file system as we said and",
    "start": "1153220",
    "end": "1158650"
  },
  {
    "text": "some of the end of an interesting fact that we found out about this is if you actually do some open source",
    "start": "1158650",
    "end": "1164020"
  },
  {
    "text": "intelligence you can find from actual job portals where people previous",
    "start": "1164020",
    "end": "1169150"
  },
  {
    "text": "employees from Siemens would say what they were working on before and they",
    "start": "1169150",
    "end": "1174610"
  },
  {
    "text": "would use some of the internal names that they worked on which are not",
    "start": "1174610",
    "end": "1180340"
  },
  {
    "text": "public though so here in the in the one case you could see that they are talking about adonus OS and on the other hand",
    "start": "1180340",
    "end": "1187030"
  },
  {
    "text": "they are talking about a proprietary file system format which is fed 32 compliant and it's the power-down",
    "start": "1187030",
    "end": "1193420"
  },
  {
    "text": "consistent if isis consistency file system which is seems to be there to make sure in case",
    "start": "1193420",
    "end": "1200990"
  },
  {
    "text": "the Siemens PLC is loses power all of a sudden the file system will still stay",
    "start": "1200990",
    "end": "1206270"
  },
  {
    "text": "intact so this is kind of an interesting source of open source intelligence sometimes if you look for internal name",
    "start": "1206270",
    "end": "1211760"
  },
  {
    "text": "so so on we could get some some hints on this open in an open space",
    "start": "1211760",
    "end": "1218780"
  },
  {
    "text": "as well here what also has to be supported of course is some talking to",
    "start": "1218780",
    "end": "1224960"
  },
  {
    "text": "the outside world of the PLC as it turns out Siemens doesn't do this by themselves they use in third-party",
    "start": "1224960",
    "end": "1232540"
  },
  {
    "text": "tcp/ip stack which is in Tunisia in this case and you via some Google magic you",
    "start": "1232540",
    "end": "1238070"
  },
  {
    "text": "can find those sources as well and here we can see that we found some prototypes and also ways",
    "start": "1238070",
    "end": "1244850"
  },
  {
    "text": "of setting up a TCP connection using it now something on the on the fumer update",
    "start": "1244850",
    "end": "1251870"
  },
  {
    "start": "1248000",
    "end": "1248000"
  },
  {
    "text": "process of the s7 PLC as well so there is an SD card which you can get which is",
    "start": "1251870",
    "end": "1257150"
  },
  {
    "text": "one of the ways so it's 24 MB $250 which is a good price to what you get",
    "start": "1257150",
    "end": "1264350"
  },
  {
    "text": "percentage I guess so a bit of an opportunity for Siemens to earn money we",
    "start": "1264350",
    "end": "1269690"
  },
  {
    "text": "are not quite sure whether they have specific features but it seems to be basically fat32 parsing and",
    "start": "1269690",
    "end": "1277720"
  },
  {
    "text": "nothing too special what we have seen there the other way you could update the",
    "start": "1277720",
    "end": "1283640"
  },
  {
    "text": "fumer by the femur running femur itself is via the web server where you can",
    "start": "1283640",
    "end": "1289460"
  },
  {
    "text": "upload a chunk of your femur update and we'll it will there check different",
    "start": "1289460",
    "end": "1295870"
  },
  {
    "text": "femur signatures or one femur signature over a hash which is a secure update",
    "start": "1295870",
    "end": "1301580"
  },
  {
    "text": "mechanism where I think no real issues were found with so the femur side of things",
    "start": "1301580",
    "end": "1308620"
  },
  {
    "text": "performs an integrity check and also make sure that this update comes from",
    "start": "1308620",
    "end": "1314390"
  },
  {
    "text": "Siemens if we are aware that Siemens indeed is the",
    "start": "1314390",
    "end": "1320840"
  },
  {
    "text": "only one who holds the private key which we of course assume here we also",
    "start": "1320840",
    "end": "1326710"
  },
  {
    "start": "1325000",
    "end": "1325000"
  },
  {
    "text": "did some reverse engineering on the decompressed femur update file structure",
    "start": "1326710",
    "end": "1331880"
  },
  {
    "text": "so you would find those different headers and check sums and also",
    "start": "1331880",
    "end": "1337690"
  },
  {
    "text": "signatures as well you can also find the the public key which is used inside the",
    "start": "1337690",
    "end": "1343730"
  },
  {
    "text": "femur and we extracted the address where this one resides as well and also gave",
    "start": "1343730",
    "end": "1349490"
  },
  {
    "text": "you some hints on where you could find if you wanted to look into it yourself the femur update mechanism itself",
    "start": "1349490",
    "end": "1355570"
  },
  {
    "text": "all right another component that we have is the web server which is a mini web it",
    "start": "1355570",
    "end": "1361700"
  },
  {
    "text": "gives you some some Diagnostics view of the PLC you can",
    "start": "1361700",
    "end": "1368240"
  },
  {
    "text": "do some configuration on it and so on we will see this component in a bit it doesn't use the quite up-to-date",
    "start": "1368240",
    "end": "1374540"
  },
  {
    "text": "accurate version for example which would expose it may be to some risk of XSS but",
    "start": "1374540",
    "end": "1381500"
  },
  {
    "text": "I think other than that we didn't do too much of reverse engineering into it and",
    "start": "1381500",
    "end": "1388250"
  },
  {
    "text": "the whole thing but we saw that for example the the password check happens",
    "start": "1388250",
    "end": "1393890"
  },
  {
    "text": "at a specific address so if you were interested in looking where how this is implemented you can find it here are",
    "start": "1393890",
    "end": "1400670"
  },
  {
    "start": "1400000",
    "end": "1400000"
  },
  {
    "text": "some of the HTTP headers that it exposes which I find kind of funny so they have",
    "start": "1400670",
    "end": "1406250"
  },
  {
    "text": "internal api's so one of my favorites i think is lulu lululu which is logout or",
    "start": "1406250",
    "end": "1412010"
  },
  {
    "text": "Lily Lily for lokan and different other ones so I'm pretty sure",
    "start": "1412010",
    "end": "1417110"
  },
  {
    "text": "if you got somebody a bit creative musically maybe you can put those syllables together and then make a song",
    "start": "1417110",
    "end": "1422900"
  },
  {
    "text": "out of it let me know if you found somebody creative enough to do that I would be very happy about this okay and",
    "start": "1422900",
    "end": "1430250"
  },
  {
    "text": "then we see an M wsl which is a programming language which is a",
    "start": "1430250",
    "end": "1435980"
  },
  {
    "text": "server-side programming language which is interesting on the menu web web server itself so it's kind of a PHP ish",
    "start": "1435980",
    "end": "1443060"
  },
  {
    "text": "functionality with JavaScript syntax that's what I called this probably it would hand wavy but it allows you to",
    "start": "1443060",
    "end": "1449960"
  },
  {
    "text": "write some variables inside the system and also curie some value variables and it also allows you to do some templating",
    "start": "1449960",
    "end": "1456500"
  },
  {
    "text": "injecting stuff into the HTML page",
    "start": "1456500",
    "end": "1461860"
  },
  {
    "text": "so some of it is not really output encoded so there could be some risk of XSS there and also I did some reverse",
    "start": "1461860",
    "end": "1468850"
  },
  {
    "text": "engineering on the action organization and recursive tokenization and so on of the NWSL templating language and this",
    "start": "1468850",
    "end": "1476590"
  },
  {
    "text": "also exposes some complexities which are kind of interesting alright now that we looked at the",
    "start": "1476590",
    "end": "1484410"
  },
  {
    "start": "1482000",
    "end": "1482000"
  },
  {
    "text": "at the fumer functionality let's get into the meat of what we found inside",
    "start": "1484410",
    "end": "1489640"
  },
  {
    "text": "the boot loader itself as we said which is a special access feature in which we found so turns out if you",
    "start": "1489640",
    "end": "1495540"
  },
  {
    "text": "if you hook up the some cables just right you get a UART connection to the",
    "start": "1495540",
    "end": "1500799"
  },
  {
    "text": "device as you can see on this picture and I was kind of looking at the bootloader",
    "start": "1500799",
    "end": "1506770"
  },
  {
    "text": "functionality and at some point I understood kind of what it did and then",
    "start": "1506770",
    "end": "1512020"
  },
  {
    "text": "I was asking what is all the other code about it that just feels like too much code for what I understand it to do in a",
    "start": "1512020",
    "end": "1518140"
  },
  {
    "text": "normal boot up case so what actually happens here and then I identified this",
    "start": "1518140",
    "end": "1523900"
  },
  {
    "text": "kind of functionality that it's initially on boot up it would wait for a specific string over UART which is m FG",
    "start": "1523900",
    "end": "1532179"
  },
  {
    "text": "t1 we can just speculate on what that actually means or where it comes from at one of my ideas as the German was that",
    "start": "1532179",
    "end": "1539470"
  },
  {
    "text": "the MFG could mean a midpoint in Busan which is a German greeting and about the",
    "start": "1539470",
    "end": "1545919"
  },
  {
    "text": "t1 I don't really know if you have any suggestions about that I would be open to some spec",
    "start": "1545919",
    "end": "1550980"
  },
  {
    "text": "yeah it's something like kind regards at the end yeah that's true and if the PLC",
    "start": "1550980",
    "end": "1556720"
  },
  {
    "text": "actually receives this string via aur than the first half a second of boot",
    "start": "1556720",
    "end": "1562150"
  },
  {
    "text": "time it would send you back the acknowledgment of - CPU so if you get this back you could know that would be",
    "start": "1562150",
    "end": "1569020"
  },
  {
    "text": "sure that the same check has been performed and that you actually have this functionality on the bootloader",
    "start": "1569020",
    "end": "1574360"
  },
  {
    "text": "itself and then after this initial handshake has been done the bootloader",
    "start": "1574360",
    "end": "1580120"
  },
  {
    "text": "will enter a specific pausing loop of commands that you can send it we have different commands that",
    "start": "1580120",
    "end": "1586900"
  },
  {
    "start": "1586000",
    "end": "1586000"
  },
  {
    "text": "we identified it's quite a some commands and the list goes on and on and on and",
    "start": "1586900",
    "end": "1592360"
  },
  {
    "text": "we I didn't look into every one of those functions",
    "start": "1592360",
    "end": "1597940"
  },
  {
    "text": "in detail kind of cursory looked at like one or 28 of them or so and then gave some naming towards what I think it is",
    "start": "1597940",
    "end": "1605760"
  },
  {
    "text": "but what comes out is that you basically get access to everything that could be",
    "start": "1605760",
    "end": "1611650"
  },
  {
    "text": "interesting as a low-level Hardware access to to do diagnostics and updates and stuff like this to do some",
    "start": "1611650",
    "end": "1618640"
  },
  {
    "text": "troubleshooting on the femur examples of this could be getting the",
    "start": "1618640",
    "end": "1624250"
  },
  {
    "text": "femur version as the first thing or checking the bootloader integrity but it also has a bunch of different protocols",
    "start": "1624250",
    "end": "1630460"
  },
  {
    "text": "and two of them I would like to talk to you a bit more about which is first of",
    "start": "1630460",
    "end": "1636220"
  },
  {
    "start": "1635000",
    "end": "1635000"
  },
  {
    "text": "all the Oh X 80 handler so what you do is basically after the handshake you send it an ID of a handle that you would",
    "start": "1636220",
    "end": "1641980"
  },
  {
    "text": "like to perform so it's kind of a functionality mode you could think about like this and the Oh X 81 provides you",
    "start": "1641980",
    "end": "1649150"
  },
  {
    "text": "some features of updating reading writing checking the integrity and configuring",
    "start": "1649150",
    "end": "1655870"
  },
  {
    "text": "specific devices and different devices can be configured this way one is I RAM",
    "start": "1655870",
    "end": "1661300"
  },
  {
    "text": "the internal random access memory of the device and the other one is the fumer",
    "start": "1661300",
    "end": "1666790"
  },
  {
    "text": "flash memory so there you have a directly exposed API of of uploading",
    "start": "1666790",
    "end": "1671980"
  },
  {
    "text": "firmware to the to the fumer flash itself where no integrity check is performed",
    "start": "1671980",
    "end": "1679350"
  },
  {
    "text": "interesting about this Iram one is that you are able to read and write from I ran into I think kind of the whole",
    "start": "1679350",
    "end": "1687280"
  },
  {
    "text": "section of it it's a bit of a clunky motors that we'll get into a bit later but this is kind of the first important",
    "start": "1687280",
    "end": "1694960"
  },
  {
    "text": "handle that we have in this in this case which we identified the second one is there always 1c handler which is also",
    "start": "1694960",
    "end": "1702160"
  },
  {
    "start": "1698000",
    "end": "1698000"
  },
  {
    "text": "primarily primary Handler so you can just use the handle I do x1c after you",
    "start": "1702160",
    "end": "1708670"
  },
  {
    "text": "enter this functionality and then you",
    "start": "1708670",
    "end": "1713680"
  },
  {
    "text": "would be able to flexibly call a different layer of functions so there is a layer of functionality which resides",
    "start": "1713680",
    "end": "1720310"
  },
  {
    "text": "inside the boot loader memory and it's initially copied to I RAM and those function pointers are",
    "start": "1720310",
    "end": "1726990"
  },
  {
    "text": "then be used by this ox1 see Honda and then you can say okay from this secondary list I would like to use this",
    "start": "1726990",
    "end": "1733050"
  },
  {
    "text": "and like this and maybe Siemens ran out of space of initial endless or so and this is where a lot of other of those",
    "start": "1733050",
    "end": "1740940"
  },
  {
    "text": "functionalities went so at this point we have different handlers and I did some",
    "start": "1740940",
    "end": "1746130"
  },
  {
    "text": "reverse engineering and then an unknown person without a UK visa asked me how",
    "start": "1746130",
    "end": "1752429"
  },
  {
    "text": "about what can we do with it can we do code execution on that and of",
    "start": "1752429",
    "end": "1758010"
  },
  {
    "text": "course I looked into it and there was something we could do about it so here it's a little iteration on the",
    "start": "1758010",
    "end": "1766500"
  },
  {
    "text": "wix1 see Honda a little visualization here so the normal way it would work is that this handler is called and it looks",
    "start": "1766500",
    "end": "1773850"
  },
  {
    "text": "into the ayran table where those function pointers were a copy to and then we just use it and those point back",
    "start": "1773850",
    "end": "1780809"
  },
  {
    "text": "to the bootloader segment and they would perform whatever functions Siemens intended them to do but now if we",
    "start": "1780809",
    "end": "1788059"
  },
  {
    "text": "combine those different handlers which we identified before we can actually start",
    "start": "1788059",
    "end": "1794370"
  },
  {
    "start": "1793000",
    "end": "1793000"
  },
  {
    "text": "creating and tag out of this first of all we use this oxa tiendas which allows",
    "start": "1794370",
    "end": "1799380"
  },
  {
    "text": "us to write to iran and update some parts inside Iram itself so the first",
    "start": "1799380",
    "end": "1804870"
  },
  {
    "text": "thing that we do is inject the pointer into IRM itself into this handler which",
    "start": "1804870",
    "end": "1810870"
  },
  {
    "text": "also resides in iran so now another location which we injected is now part",
    "start": "1810870",
    "end": "1816660"
  },
  {
    "text": "of this handler list of the secondary handler list and what we also do is inject the payload of share code",
    "start": "1816660",
    "end": "1823080"
  },
  {
    "text": "basically which we put into IRM as well and then then as a second",
    "start": "1823080",
    "end": "1828510"
  },
  {
    "text": "step we can use the Oh X 1 C handle again use this flexible function calling",
    "start": "1828510",
    "end": "1834020"
  },
  {
    "text": "mechanism to actually specify our previously overwritten index and you",
    "start": "1834020",
    "end": "1840390"
  },
  {
    "text": "need to pass not only the the function point and you have to do some metadata around it for it to work at the end but",
    "start": "1840390",
    "end": "1847380"
  },
  {
    "text": "basically you inject your own and lie there and then you can jump to your own shot code and let's see what",
    "start": "1847380",
    "end": "1855590"
  },
  {
    "text": "this doesn't it change the way to the first one the o excit right the",
    "start": "1855590",
    "end": "1860820"
  },
  {
    "text": "as well as a reference to it and then we called it and then saying it an Ally's",
    "start": "1860820",
    "end": "1865830"
  },
  {
    "text": "word this technology we are going to rocket the PUC some word about this stage of payload",
    "start": "1865830",
    "end": "1872460"
  },
  {
    "text": "first so it's as I indicated before it's a bit of a slow error-prone",
    "start": "1872460",
    "end": "1878180"
  },
  {
    "text": "kind of painful way of writing memory so I had to to get those values actually",
    "start": "1878180",
    "end": "1884010"
  },
  {
    "text": "written and not an error to be I returned there you have to do some masking of setting everything to only",
    "start": "1884010",
    "end": "1890490"
  },
  {
    "text": "one bits before and then having not too much I don't know where it comes from those errors but we had to work around",
    "start": "1890490",
    "end": "1897060"
  },
  {
    "text": "some stuff but it's kind of error-prone so what we did was inject a small little",
    "start": "1897060",
    "end": "1902120"
  },
  {
    "text": "chunk of code in there which would be able to talk to us again is if we curate",
    "start": "1902120",
    "end": "1909390"
  },
  {
    "text": "this Handler and then this stub this little stub gives us the opportunity to write to memory in a more flexible way",
    "start": "1909390",
    "end": "1916530"
  },
  {
    "text": "and also in a faster way and this way we can inject arbitrary payloads and now",
    "start": "1916530",
    "end": "1921540"
  },
  {
    "text": "that we can inject arbitrary payloads we may want to play around with us a bit and this is where we have a little bit",
    "start": "1921540",
    "end": "1928200"
  },
  {
    "text": "of a demo time and we will show you a video or different videos piece together",
    "start": "1928200",
    "end": "1933300"
  },
  {
    "text": "about this",
    "start": "1933300",
    "end": "1936470"
  },
  {
    "text": "Oh does it go so",
    "start": "1944890",
    "end": "1950520"
  },
  {
    "text": "the existence of a special access functionality is a PFC in the office",
    "start": "1950520",
    "end": "1956679"
  },
  {
    "text": "basically going to be all the packets which we send and receive from the kids handing it down is basically",
    "start": "1956679",
    "end": "1962790"
  },
  {
    "text": "the script which we have in our remote machine which is 30 MCM and if the PMC",
    "start": "1962790",
    "end": "1969340"
  },
  {
    "text": "does have is a special access functionality via UART is going to respond to our packet and as you can see",
    "start": "1969340",
    "end": "1975700"
  },
  {
    "text": "here the PLC responds and you're also actually installing a custom hook",
    "start": "1975700",
    "end": "1981090"
  },
  {
    "text": "within the PLC and also get a response basically I'm a GT one and CPU",
    "start": "1981090",
    "end": "1987690"
  },
  {
    "text": "this was the first time of it in this demo we are going to dump from the RAM",
    "start": "1987780",
    "end": "1995200"
  },
  {
    "text": "of the PLC from the Siemens 7 PRC using a special access feature",
    "start": "1995200",
    "end": "2001190"
  },
  {
    "text": "so don't think that first actually we are going to connect to our infrastructure so basically we have a",
    "start": "2001190",
    "end": "2008610"
  },
  {
    "text": "server which is connected to a PFC it's a remote machine we also create a ssh",
    "start": "2008610",
    "end": "2013650"
  },
  {
    "text": "time so be opening a port forwarding of all the requests to our local machine",
    "start": "2013650",
    "end": "2018900"
  },
  {
    "text": "basically here as you can see here we create our tunnel and then after that we",
    "start": "2018900",
    "end": "2025890"
  },
  {
    "text": "are going to basically dump the content of the memory of the PLC so here we show",
    "start": "2025890",
    "end": "2033480"
  },
  {
    "text": "that the PS is actually life so to make sure that everything is working so this",
    "start": "2033480",
    "end": "2038760"
  },
  {
    "text": "is our port forwarding features or basically real times in four five five five five and as we can see PMC is alive",
    "start": "2038760",
    "end": "2045419"
  },
  {
    "text": "and our tunnel is working and basically we also or test and see that",
    "start": "2045419",
    "end": "2051960"
  },
  {
    "text": "this actually is not a static test we are also going to blocking the PFC from in and",
    "start": "2051960",
    "end": "2059148"
  },
  {
    "text": "yeah so as you can see [Music]",
    "start": "2059330",
    "end": "2065608"
  },
  {
    "text": "reloads the Pierce is working basically so it's in a run mode and so next what",
    "start": "2065609",
    "end": "2072329"
  },
  {
    "text": "we are going to do is that we are going to get the actual framework from the CMS",
    "start": "2072329",
    "end": "2077700"
  },
  {
    "text": "website we already done with previously is this UPD files and then we save it in a folder called out as FW bean so it's",
    "start": "2077700",
    "end": "2085470"
  },
  {
    "text": "basically decompressing a d3 compression with Siemens users and",
    "start": "2085470",
    "end": "2091099"
  },
  {
    "text": "basically now we have to act while frame we're not the compressed framework from the CMS website next is actually we are",
    "start": "2091099",
    "end": "2097950"
  },
  {
    "text": "going to compare this framework with the one which is resizing",
    "start": "2097950",
    "end": "2103950"
  },
  {
    "text": "the RAM of the PRC just to make sure that the data which we are talking using the special access feature is correct or",
    "start": "2103950",
    "end": "2109170"
  },
  {
    "text": "not so first we are loading into the binary and we are I don't want because it takes so much time we are going to basically just compare with a small part",
    "start": "2109170",
    "end": "2117359"
  },
  {
    "text": "of the binary so first we have to be based a program because the starting point of the framework will be different because of because the starting point",
    "start": "2117359",
    "end": "2124380"
  },
  {
    "text": "actually in the case is first bootloader and then record so now we face the",
    "start": "2124380",
    "end": "2129839"
  },
  {
    "text": "program and you can see that's why automatically also fine audit functions and here's example function in the",
    "start": "2129839",
    "end": "2135739"
  },
  {
    "text": "framework basically it's a part of parsing some get request in the HTTP in",
    "start": "2135739",
    "end": "2141269"
  },
  {
    "text": "this six nine one e 28 address and basically what you're going to do is that we are going to for example a dump",
    "start": "2141269",
    "end": "2146970"
  },
  {
    "text": "256 kilo byte of this binary and export it from the actual frame where of the cements to file which we call it",
    "start": "2146970",
    "end": "2154910"
  },
  {
    "text": "fw0 x69 128 so 422 6 5 next is actually that",
    "start": "2154910",
    "end": "2161489"
  },
  {
    "text": "we are going to dump the content of the memory from the same address",
    "start": "2161489",
    "end": "2166640"
  },
  {
    "text": "basically as I'm writing here we are going to dot the contents of the memory from the from the front of",
    "start": "2166640",
    "end": "2173989"
  },
  {
    "text": "basically the content of the RAM from the PLC and then next is that we are",
    "start": "2173989",
    "end": "2179369"
  },
  {
    "text": "going to compare with the framework which we don't with an unpacked from the semester so only a few bucks because we",
    "start": "2179369",
    "end": "2185960"
  },
  {
    "text": "just want to check the concept sir also we are s intentionally slow down the speed of the",
    "start": "2185960",
    "end": "2194079"
  },
  {
    "text": "dumping the content from the basic CPLC is using in York because we",
    "start": "2194079",
    "end": "2199910"
  },
  {
    "text": "want to make sure that the contents of the dump is actually right so that's it",
    "start": "2199910",
    "end": "2205280"
  },
  {
    "text": "the contents don't so meant down to zero zero six nine one in twenty eight and we",
    "start": "2205280",
    "end": "2212060"
  },
  {
    "text": "are going to copies back from our server to our local machine here as you can see",
    "start": "2212060",
    "end": "2218000"
  },
  {
    "text": "here so so we are going to a city and yeah",
    "start": "2218000",
    "end": "2227500"
  },
  {
    "text": "so now we have supine so FW is the actual frame where the static Ram will",
    "start": "2228130",
    "end": "2233570"
  },
  {
    "text": "dump the Downloads from the CMS website and FW the the men dog is basically the version which we talk from the RAM of",
    "start": "2233570",
    "end": "2239780"
  },
  {
    "text": "the TSE and we are going to compare them and we are actually as you can see here all of the binaries are matching so",
    "start": "2239780",
    "end": "2246260"
  },
  {
    "text": "there is nothing different between the binaries is to binding so basically it's",
    "start": "2246260",
    "end": "2251270"
  },
  {
    "text": "exactly matching as expected [Music] alright so this way we could get Ali",
    "start": "2251270",
    "end": "2257930"
  },
  {
    "text": "here just a bit oh it's dead okay",
    "start": "2257930",
    "end": "2265270"
  },
  {
    "text": "okay yeah this the truth all parts of the video are",
    "start": "2265270",
    "end": "2271760"
  },
  {
    "text": "shown but we have like an part here yeah I think we can see the most important",
    "start": "2271760",
    "end": "2276800"
  },
  {
    "text": "but so what we do now is having a little demo abouts that we can actually have",
    "start": "2276800",
    "end": "2283510"
  },
  {
    "text": "back-and-forth communication between the two parties the one the PLC and then us",
    "start": "2283510",
    "end": "2289609"
  },
  {
    "text": "as a as a connected device",
    "start": "2289609",
    "end": "2295210"
  },
  {
    "text": "it was from a laptop and here we can see that the Siemens PLC is sending us",
    "start": "2295210",
    "end": "2300560"
  },
  {
    "text": "greetings over and over again and we actually received those",
    "start": "2300560",
    "end": "2306550"
  },
  {
    "text": "see that there actually works for some seconds",
    "start": "2308520",
    "end": "2313580"
  },
  {
    "text": "and now the most important thing of course about the plc what it has to be",
    "start": "2314660",
    "end": "2319770"
  },
  {
    "text": "able to do we thought was playing a game and here if somebody is not familiar he is playing this game masterfully to a",
    "start": "2319770",
    "end": "2327270"
  },
  {
    "text": "draw which it should also always come down to but we thought the Siemens PUC",
    "start": "2327270",
    "end": "2334230"
  },
  {
    "text": "also has to have some gaming console qualities and this is what we did here",
    "start": "2334230",
    "end": "2341720"
  },
  {
    "text": "now Ali is going to inject those another payload that we wrote into the PLC",
    "start": "2345050",
    "end": "2352560"
  },
  {
    "text": "memory and first of all we see the handshake and now we are uploading our",
    "start": "2352560",
    "end": "2359510"
  },
  {
    "text": "payload we from here it starts uploading the payload shows percentages now we can",
    "start": "2359510",
    "end": "2366360"
  },
  {
    "text": "see that the plc actually gives us the chance to play some tic-tac-toe on the",
    "start": "2366360",
    "end": "2371550"
  },
  {
    "text": "device",
    "start": "2371550",
    "end": "2373820"
  },
  {
    "text": "and here we can see player one indeed one got a three in a row and",
    "start": "2382560",
    "end": "2388130"
  },
  {
    "text": "this is where we could boot to the normal frame where operation and this is where this demo ends all right",
    "start": "2388130",
    "end": "2396680"
  },
  {
    "text": "okay what does this all all amount to",
    "start": "2398720",
    "end": "2404010"
  },
  {
    "start": "2401000",
    "end": "2401000"
  },
  {
    "text": "what did we see first of all we see that programmable logic controllers are become more and more complex we identify",
    "start": "2404010",
    "end": "2410700"
  },
  {
    "text": "different components which are are from complexity perspective maybe",
    "start": "2410700",
    "end": "2419100"
  },
  {
    "text": "get interesting attacking targets for a potential attacker or at least we have to make sure that those components which",
    "start": "2419100",
    "end": "2424680"
  },
  {
    "text": "are kind of complex are not prone to being attacked too much and we",
    "start": "2424680",
    "end": "2431220"
  },
  {
    "text": "have to make sure that there's actually secure we also also saw that Siemens is one of the vendors who in our experience",
    "start": "2431220",
    "end": "2437760"
  },
  {
    "text": "is kind of at the front of what is currently being done in PRCs there are the game is being",
    "start": "2437760",
    "end": "2446160"
  },
  {
    "text": "upped and some hardware features are used to protect memory there is some",
    "start": "2446160",
    "end": "2451670"
  },
  {
    "text": "restrictions on what for example the NWSL language can do so recently they changed it the way that no",
    "start": "2451670",
    "end": "2460380"
  },
  {
    "text": "fire rights are supported anymore by M WS L in order to decrease the text",
    "start": "2460380",
    "end": "2466500"
  },
  {
    "text": "service a bit and we saw changes to bootloader chips which are not no longer",
    "start": "2466500",
    "end": "2472410"
  },
  {
    "text": "writable and so different things happen there which are",
    "start": "2472410",
    "end": "2478160"
  },
  {
    "text": "making it harder to intrude such a system so we saw also this kind of legacy",
    "start": "2478160",
    "end": "2484920"
  },
  {
    "text": "functionality which we can only guess why it's there it has a lot of",
    "start": "2484920",
    "end": "2490080"
  },
  {
    "text": "Diagnostics functionality so it's it's good for for developers probably to do",
    "start": "2490080",
    "end": "2496230"
  },
  {
    "text": "some Diagnostics even when the bootloader when the femur doesn't put itself we should also push the vendors",
    "start": "2496230",
    "end": "2502800"
  },
  {
    "text": "to maybe remove those features because if for example in a supply chain",
    "start": "2502800",
    "end": "2508760"
  },
  {
    "text": "we had this this kind of device go in the wrong hands the wrong hands could",
    "start": "2508760",
    "end": "2514050"
  },
  {
    "text": "use a feature like this and date fume we're on the go and then it's hard to",
    "start": "2514050",
    "end": "2519660"
  },
  {
    "text": "ensure that the same state which it was sent in from the factory is actually the",
    "start": "2519660",
    "end": "2525299"
  },
  {
    "text": "same state that it is in when coming to the customer at the same time",
    "start": "2525299",
    "end": "2530990"
  },
  {
    "text": "removing those kinds of features also removes the opportunity for researchers",
    "start": "2530990",
    "end": "2537059"
  },
  {
    "text": "such as us to have introspection into those systems so they're actually kind of",
    "start": "2537059",
    "end": "2543559"
  },
  {
    "text": "interesting for us to work with and they give us more insight and introspection into those systems so Venice may be at",
    "start": "2543559",
    "end": "2550470"
  },
  {
    "text": "the same time want to think about opening up their systems in some way to the scrutiny of researchers who have",
    "start": "2550470",
    "end": "2558599"
  },
  {
    "text": "good intentions in out of cases but who are not able to get any excess and so",
    "start": "2558599",
    "end": "2564180"
  },
  {
    "text": "the right people may not get access and the opportunity to or even incentive to",
    "start": "2564180",
    "end": "2570420"
  },
  {
    "text": "look into those systems and maybe those people who we don't really want to get access to it with a lot of resources",
    "start": "2570420",
    "end": "2577349"
  },
  {
    "text": "they can more easily get that in the end and the research researchers that we actually want the",
    "start": "2577349",
    "end": "2584150"
  },
  {
    "text": "the work to be done by and also we saw that there are a lot of",
    "start": "2584150",
    "end": "2590059"
  },
  {
    "text": "bits and pieces of a POC that have a lot of complexity which we also want to make",
    "start": "2590059",
    "end": "2597180"
  },
  {
    "text": "as safe as possible so there are a lot of things to be done in the future finally we want to thank",
    "start": "2597180",
    "end": "2603859"
  },
  {
    "text": "different people I think you know who you are and what you did for us and with",
    "start": "2603859",
    "end": "2608910"
  },
  {
    "text": "that I am leaving you with a thank you for attending the start",
    "start": "2608910",
    "end": "2615289"
  },
  {
    "text": "and I think we have like five minutes left there are questions we can take those",
    "start": "2619210",
    "end": "2626240"
  },
  {
    "text": "like a couple also there's also microphone going around so",
    "start": "2626240",
    "end": "2631700"
  },
  {
    "text": "maybe if you keep raising your hand good yeah over there",
    "start": "2631700",
    "end": "2637630"
  },
  {
    "text": "hi first thank you for your presentation so I'm working for Schneider Electric so",
    "start": "2637630",
    "end": "2643840"
  },
  {
    "text": "thank you for happiness to improve our PLC my question is very simple",
    "start": "2643840",
    "end": "2649600"
  },
  {
    "text": "how many times does it take to you to do all this reverse engineering and how",
    "start": "2649600",
    "end": "2655160"
  },
  {
    "text": "many people were you to do this I actually did the reverse engineering",
    "start": "2655160",
    "end": "2660350"
  },
  {
    "text": "myself how much time it takes I did it as a research work for when Ali was a",
    "start": "2660350",
    "end": "2667730"
  },
  {
    "text": "PhD student back then and I spent part of next to my studies some",
    "start": "2667730",
    "end": "2674270"
  },
  {
    "text": "time but it it would take some time I couldn't really put on how",
    "start": "2674270",
    "end": "2680120"
  },
  {
    "text": "many days or so but if you specifically looked at the bootloader code and then had this intuition which is also a bit",
    "start": "2680120",
    "end": "2686360"
  },
  {
    "text": "of luck involved maybe but only looking at the bootloader finding this you could probably do in a week I would say to get",
    "start": "2686360",
    "end": "2694700"
  },
  {
    "text": "that something like this it's it's hard to put on actual I yeah and you of course you would have to",
    "start": "2694700",
    "end": "2700790"
  },
  {
    "text": "have the basic skills of doing the reverse engineering in the first place so this takes a lot of time before",
    "start": "2700790",
    "end": "2706190"
  },
  {
    "text": "obviously yeah but afterwards if you have somebody I think that would be an estimation maybe but it's hard to set in",
    "start": "2706190",
    "end": "2713150"
  },
  {
    "text": "stone okay maybe one more question",
    "start": "2713150",
    "end": "2717819"
  },
  {
    "text": "over there yeah thank you for the talk I just",
    "start": "2718930",
    "end": "2724550"
  },
  {
    "text": "wanted to ask if you try to contact Siemens with it and if they responded in any way oh yeah we we actually had a",
    "start": "2724550",
    "end": "2732020"
  },
  {
    "text": "responsible responsibilities closure like quite a some months ago so Siemens",
    "start": "2732020",
    "end": "2738380"
  },
  {
    "text": "is aware of this and they also are working on a fix of how to tackle this yes",
    "start": "2738380",
    "end": "2745690"
  },
  {
    "text": "and the last question yeah so I know that some Siemens people in here and the",
    "start": "2749400",
    "end": "2754839"
  },
  {
    "text": "questions a little bit provocative so like as an offensive person who always think what I would do with such things",
    "start": "2754839",
    "end": "2762429"
  },
  {
    "text": "so obviously this special feature access which is obviously backdoor that is",
    "start": "2762429",
    "end": "2767979"
  },
  {
    "text": "something not what is remotely exploitable so it's not something what Simmons could claim that they left it",
    "start": "2767979",
    "end": "2773289"
  },
  {
    "text": "there for remote you know troubleshooting but not so you basically have to be physically in front of the device to exploit it and it's so hard",
    "start": "2773289",
    "end": "2781150"
  },
  {
    "text": "very well hidden so the average person will never find it so obviously it's it",
    "start": "2781150",
    "end": "2787209"
  },
  {
    "text": "makes me an impression that it was left intentionally there for like people with",
    "start": "2787209",
    "end": "2793749"
  },
  {
    "text": "a specific knowledge that it is there they can intercept for example shipment of PLC's in transit and then",
    "start": "2793749",
    "end": "2800099"
  },
  {
    "text": "introduce something interesting into the firmware of those like of the PLC's for",
    "start": "2800099",
    "end": "2806619"
  },
  {
    "text": "the customers who will get them so when you ask Siemens like what is the purpose of that backdoor or special access",
    "start": "2806619",
    "end": "2814900"
  },
  {
    "text": "feature in there what will their response I think there was just a neutral response not not anything",
    "start": "2814900",
    "end": "2821469"
  },
  {
    "text": "specific about the the intention of this I could see a lot of potential",
    "start": "2821469",
    "end": "2828809"
  },
  {
    "text": "just normal application just because it's useful I mean you could speculate",
    "start": "2828809",
    "end": "2834640"
  },
  {
    "text": "that it's it's a it's not the best intention but that's always something you could speculate but I could see a",
    "start": "2834640",
    "end": "2841479"
  },
  {
    "text": "lot of reasoning for it just being a very handy a feature for troubleshooting",
    "start": "2841479",
    "end": "2847749"
  },
  {
    "text": "for for a developer for example but it's nevertheless kind of gives you both",
    "start": "2847749",
    "end": "2853449"
  },
  {
    "text": "modes and this is why we probably want to get rid of those kinds of things that",
    "start": "2853449",
    "end": "2859569"
  },
  {
    "text": "in the end could pose a threat to the extra PLC which is",
    "start": "2859569",
    "end": "2866199"
  },
  {
    "text": "running at the customers site",
    "start": "2866199",
    "end": "2872039"
  },
  {
    "text": "okay I think this with this we're about out of time yes I get to zero race so",
    "start": "2873650",
    "end": "2880009"
  },
  {
    "text": "we're perfect all right thank you everybody and if",
    "start": "2880009",
    "end": "2884769"
  }
]