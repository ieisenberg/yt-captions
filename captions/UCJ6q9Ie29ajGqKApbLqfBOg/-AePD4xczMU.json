[
  {
    "text": "thank you for coming to our talk we really appreciate that so if you're in this room most of you I think wouldn't",
    "start": "30",
    "end": "7589"
  },
  {
    "text": "be surprised to see this you've seen it in the headlines that I mean this year has been pretty hot in terms of",
    "start": "7589",
    "end": "14099"
  },
  {
    "text": "ransomware right so we've seen several new families we've seen many campaigns very disruptive so I hope you agree with",
    "start": "14099",
    "end": "23460"
  },
  {
    "text": "me that this has been actually the year of exit of extortion right yeah so not no sharks right also this might not come",
    "start": "23460",
    "end": "32189"
  },
  {
    "text": "as a surprise I mean we have seen this hopefully not on our laptops but in case",
    "start": "32189",
    "end": "38340"
  },
  {
    "text": "you had seen it on your laptop I hope you hadn't cried too much but in case",
    "start": "38340",
    "end": "43530"
  },
  {
    "text": "you had cried please cry no more because with this talk we're going to show you a",
    "start": "43530",
    "end": "49219"
  },
  {
    "text": "anonymity methodology that we have prototyped that will allow for you know",
    "start": "49219",
    "end": "56309"
  },
  {
    "text": "a better world hopefully with less successful infections we've tested",
    "start": "56309",
    "end": "63149"
  },
  {
    "text": "shield FS on wanna cry of course we haven't tested only on wanna cry and one",
    "start": "63149",
    "end": "70200"
  },
  {
    "text": "of the things that we want to point out since the beginning is that there where some files where when a cry succeeded so",
    "start": "70200",
    "end": "78210"
  },
  {
    "text": "in this specific example it managed to encrypt something like two 200 files so",
    "start": "78210",
    "end": "83430"
  },
  {
    "text": "it can change but anyways so this is okay I mean we embrace it we accept limitations of detection based",
    "start": "83430",
    "end": "90960"
  },
  {
    "text": "approaches and we go one step one step beyond and we put a safe net another",
    "start": "90960",
    "end": "96900"
  },
  {
    "text": "another additional layer of protection that was allowed to prevent all of these",
    "start": "96900",
    "end": "102030"
  },
  {
    "text": "files to be lost forever and that's where that's why you see zero file loss",
    "start": "102030",
    "end": "107210"
  },
  {
    "text": "no file were lost at the end of the day we also tested of course on other",
    "start": "107210",
    "end": "113340"
  },
  {
    "text": "families as I was saying we tested it on the major ones including one a cry yes of course and in most of the cases we",
    "start": "113340",
    "end": "120689"
  },
  {
    "text": "have successful detection in some cases we hadn't but still we managed to reach",
    "start": "120689",
    "end": "126119"
  },
  {
    "text": "0% file loss this is pretty exciting I mean I'm really excited to present this",
    "start": "126119",
    "end": "131690"
  },
  {
    "text": "because of this so at this point I guess that in your mind there is one question why is Shield",
    "start": "131690",
    "end": "139280"
  },
  {
    "text": "FS why this guy is telling as the shield FS is so different why is it making something that maybe other other other",
    "start": "139280",
    "end": "146120"
  },
  {
    "text": "system was not able to do so we've started something like 11.5 years ago in",
    "start": "146120",
    "end": "155300"
  },
  {
    "text": "this research and there were already other researchers observing how",
    "start": "155300",
    "end": "161150"
  },
  {
    "text": "ransomware was interacting with a file system and one of the things that was",
    "start": "161150",
    "end": "166640"
  },
  {
    "text": "remarkable is that ransomware was interacting with a file system in a pretty you know evident way so the file",
    "start": "166640",
    "end": "173540"
  },
  {
    "text": "system looked like the perfect place to observe ransomware behavior",
    "start": "173540",
    "end": "178720"
  },
  {
    "text": "we went a little bit further than that and we observed that not only ransomware",
    "start": "178720",
    "end": "185000"
  },
  {
    "text": "is remarkable in the way it interacts with the file system but also it is completely different from how benign",
    "start": "185000",
    "end": "191810"
  },
  {
    "text": "application interacts with the file system so we base this approach we base",
    "start": "191810",
    "end": "197900"
  },
  {
    "text": "this approach on this observation base files we base shield FS on this observation and we exploit this idea in",
    "start": "197900",
    "end": "205700"
  },
  {
    "text": "two ways first for detection we use this criterion this observation to discern",
    "start": "205700",
    "end": "212840"
  },
  {
    "text": "benign from when ransomware like processes in an operating system we also",
    "start": "212840",
    "end": "219200"
  },
  {
    "text": "of course inspect the memory of the process is to look for crypto primitives just in case there is some crypto",
    "start": "219200",
    "end": "225320"
  },
  {
    "text": "material in there is a further confirmation that it's it's a ransom or",
    "start": "225320",
    "end": "230600"
  },
  {
    "text": "like behavior and then we exploit it for the second part of our approach that is",
    "start": "230600",
    "end": "236569"
  },
  {
    "text": "for protection inside our file system because she'll the first you might have understood from from from now on that",
    "start": "236569",
    "end": "243739"
  },
  {
    "text": "it's actually a file system from this point on we also do protection embedded",
    "start": "243739",
    "end": "249290"
  },
  {
    "text": "in the file system in the sense that whenever our file system detects that something is you know suspicious or",
    "start": "249290",
    "end": "257169"
  },
  {
    "text": "remarkably malicious we do take an additional protection in order to save",
    "start": "257169",
    "end": "262370"
  },
  {
    "text": "those files of course now it might look a little bit vague but please bear with us",
    "start": "262370",
    "end": "267760"
  },
  {
    "text": "so great now let's let me go you two to",
    "start": "267760",
    "end": "273860"
  },
  {
    "text": "the first part of our story that is where do we start from to design shield FS so we started from collecting from",
    "start": "273860",
    "end": "281720"
  },
  {
    "text": "collecting data and the first question is where do we where do we look where do we observe our our traffic so to speak",
    "start": "281720",
    "end": "289450"
  },
  {
    "text": "our traffic is actually a file system IO so you can imagine you can abstract the",
    "start": "289450",
    "end": "295550"
  },
  {
    "text": "file system from from the bottom of the user land as a basically a flow of IO",
    "start": "295550",
    "end": "301850"
  },
  {
    "text": "packet request I your request packet sorry or IRP and those are the the",
    "start": "301850",
    "end": "307340"
  },
  {
    "text": "smallest atomic units of IO within the windows file system and there's actually",
    "start": "307340",
    "end": "314150"
  },
  {
    "text": "a pretty nice interface if you're if you want to develop a driver that allows you to hook up very well into that into that",
    "start": "314150",
    "end": "322010"
  },
  {
    "text": "position that is called the mini driver mini filter driver and that allows you",
    "start": "322010",
    "end": "327020"
  },
  {
    "text": "to see basically everything and to register callbacks for every event that you like for example here you see the",
    "start": "327020",
    "end": "334340"
  },
  {
    "text": "the basic data structure that allows you to register callbacks for like before a certain event before a certain IO after",
    "start": "334340",
    "end": "342200"
  },
  {
    "text": "certain IO for example when a file is created or when a file is read you can",
    "start": "342200",
    "end": "348350"
  },
  {
    "text": "you can use this kind of callbacks in order to register and take action right so you can do that before you see an IO",
    "start": "348350",
    "end": "354920"
  },
  {
    "text": "or after the IO goes down to the actual file system for example you can use this",
    "start": "354920",
    "end": "360620"
  },
  {
    "text": "interface to create to log the activity on the file system what you see on this table from your left to your right is",
    "start": "360620",
    "end": "367390"
  },
  {
    "text": "what you can register as an example you can register the timestamp you can register the process ID you can register",
    "start": "367390",
    "end": "373880"
  },
  {
    "text": "the process name any anything that you see flowing flowing down to the file",
    "start": "373880",
    "end": "379130"
  },
  {
    "text": "system the last one is the file path just one note one read operation or",
    "start": "379130",
    "end": "387110"
  },
  {
    "text": "write operation can result in hundreds or thousands of these at your pocket request so if you if you're writing a",
    "start": "387110",
    "end": "394220"
  },
  {
    "text": "giant file you're going to see many of this requests so we start",
    "start": "394220",
    "end": "400080"
  },
  {
    "text": "with this tool set in in our hands and we install such a logging agent into",
    "start": "400080",
    "end": "407789"
  },
  {
    "text": "clean machines we had 11 volunteers that allowed us to install this agent on",
    "start": "407789",
    "end": "413729"
  },
  {
    "text": "their everyday machines so this was not a lab experiment it was you know on real",
    "start": "413729",
    "end": "419580"
  },
  {
    "text": "machines that people were using for their real activities every day and we",
    "start": "419580",
    "end": "425099"
  },
  {
    "text": "ended up having something like 2,000 worth of application data these these",
    "start": "425099",
    "end": "432120"
  },
  {
    "text": "people were using collectively two thousand and something more applications as you can see from the left column the",
    "start": "432120",
    "end": "440340"
  },
  {
    "text": "profiles of the user were various we had some developers and power users some",
    "start": "440340",
    "end": "446129"
  },
  {
    "text": "office users some home users so a good variety we believe this resulted in",
    "start": "446129",
    "end": "452219"
  },
  {
    "text": "something like 1.7 billion euro packet requests so a pretty juicy data set to",
    "start": "452219",
    "end": "458669"
  },
  {
    "text": "begin secondly as I told we wanted to understand also how ransomware",
    "start": "458669",
    "end": "465289"
  },
  {
    "text": "interacted with the file system so we repeated the same experiment this time in a controlled environment because we",
    "start": "465289",
    "end": "472259"
  },
  {
    "text": "wanted to control the infection and so we had to use virtual machines for this",
    "start": "472259",
    "end": "478469"
  },
  {
    "text": "we explore we we use a cuckoo just because it's very nice for automation so",
    "start": "478469",
    "end": "483690"
  },
  {
    "text": "we use reduced that and we installed I think was two years ago so 2015 I mean",
    "start": "483690",
    "end": "490529"
  },
  {
    "text": "those were the most prevalent families so that's what we used for for collecting data an interesting point",
    "start": "490529",
    "end": "498960"
  },
  {
    "text": "here is that well of course we are all aware that modern malware can evade",
    "start": "498960",
    "end": "504360"
  },
  {
    "text": "virtual machines so we adopted all the possible countermeasure for that but on",
    "start": "504360",
    "end": "510240"
  },
  {
    "text": "top of that ransomware poses a specific challenge to this because it needs to",
    "start": "510240",
    "end": "515820"
  },
  {
    "text": "have certain content on the machine so we put real files I mean realistically",
    "start": "515820",
    "end": "522328"
  },
  {
    "text": "looking files we emulated the same directory tree that we found on the 11",
    "start": "522329",
    "end": "528660"
  },
  {
    "text": "clean machines so we kind of replicated the environment of a real user we install browser extensions we browse",
    "start": "528660",
    "end": "535620"
  },
  {
    "text": "through website in order to collect the history so we tried to make a realistically looking machine so that",
    "start": "535620",
    "end": "543030"
  },
  {
    "text": "rain summer had triggers and then you know honey files to to start great so at",
    "start": "543030",
    "end": "550470"
  },
  {
    "text": "this point we have clean traffic and brainstorm or traffic I call it traffic",
    "start": "550470",
    "end": "557430"
  },
  {
    "text": "which it's actually traffic so now the question is how do we distinguish between R and summer-like or benign the",
    "start": "557430",
    "end": "567450"
  },
  {
    "text": "original title of our work when we conceived it was a self-healing",
    "start": "567450",
    "end": "572520"
  },
  {
    "text": "ransomware where a file system so before going to the self-healing part I want to",
    "start": "572520",
    "end": "577710"
  },
  {
    "text": "go to the ransomware aware part so how do we make our file system ransomware aware I'm gonna be showing you a few of",
    "start": "577710",
    "end": "585120"
  },
  {
    "text": "these plots so just to give you a guide to read them on the horizontal axis you",
    "start": "585120",
    "end": "591000"
  },
  {
    "text": "see a quantity it's going to be a variable from 0 to 1 and on the vertical axis you're gonna see a frequency so how",
    "start": "591000",
    "end": "598080"
  },
  {
    "text": "many times how much how popular that value is in our data set so for example",
    "start": "598080",
    "end": "604140"
  },
  {
    "text": "if you look here we can divide it into two quadrants on the on the top right you see that many times we see a high",
    "start": "604140",
    "end": "611640"
  },
  {
    "text": "value on the bottom left few few times we see a low value and and the same for",
    "start": "611640",
    "end": "618150"
  },
  {
    "text": "the other two quadrants the variables that we were looking at for example",
    "start": "618150",
    "end": "624420"
  },
  {
    "text": "where something like folder listing operations so how many times we have",
    "start": "624420",
    "end": "629820"
  },
  {
    "text": "seen in our two data set a process doing file a for the folder listing operations",
    "start": "629820",
    "end": "635910"
  },
  {
    "text": "and as you can see the red the red distribution is shifted towards higher values that is an indication that",
    "start": "635910",
    "end": "643890"
  },
  {
    "text": "actually is an evidence that says that ransomware is doing harvesting this is something that ransomware has to do",
    "start": "643890",
    "end": "649980"
  },
  {
    "text": "before starting to encrypt it has to harvest the fat of the system right",
    "start": "649980",
    "end": "655530"
  },
  {
    "text": "similarly ransomware tends to do more reading operations because it has to of",
    "start": "655530",
    "end": "661080"
  },
  {
    "text": "course read the files and then do something and then rewrite them back that's why we also see a",
    "start": "661080",
    "end": "667020"
  },
  {
    "text": "a change sorry another change with a difference in the amount of write operations in case of rain summer versus",
    "start": "667020",
    "end": "675210"
  },
  {
    "text": "benign where also we see that when summer has a remarkable amount of file",
    "start": "675210",
    "end": "683520"
  },
  {
    "text": "renaming operations even though this is not required for a ransom er the ransom",
    "start": "683520",
    "end": "688620"
  },
  {
    "text": "I can get through this and obtain the same behavior we have seen that in the samples that we have analyzed there is a",
    "start": "688620",
    "end": "694140"
  },
  {
    "text": "prevalence of renaming operations file type coverage has to do with how many",
    "start": "694140",
    "end": "701880"
  },
  {
    "text": "different file types a process is is interacting with if you take for example",
    "start": "701880",
    "end": "708620"
  },
  {
    "text": "word or I don't know Photoshop they're going to interact with a very limited",
    "start": "708620",
    "end": "713880"
  },
  {
    "text": "amount of file types right whereas ransomware as we know we have",
    "start": "713880",
    "end": "718980"
  },
  {
    "text": "there is a long list of files that is targeting so if we look at the diversity of the file types that are ransomware is",
    "start": "718980",
    "end": "726540"
  },
  {
    "text": "targeting we see that it's shifted towards higher value with respect to a typical benign application that only",
    "start": "726540",
    "end": "733020"
  },
  {
    "text": "targets a few types of files file entropy so the story right entropy that",
    "start": "733020",
    "end": "740100"
  },
  {
    "text": "is the entropy of the content written is not that remarkable if you think I mean if you look at this it's not as",
    "start": "740100",
    "end": "746430"
  },
  {
    "text": "remarkable as the previous ones there is no such as such a huge difference so this one should not be used alone like",
    "start": "746430",
    "end": "752940"
  },
  {
    "text": "if you look at the entropy alone you're gonna have a lot of false positives probably right great so now we have",
    "start": "752940",
    "end": "760020"
  },
  {
    "text": "about 6 features actually 6 features that we can look at to tell to tell",
    "start": "760020",
    "end": "765060"
  },
  {
    "text": "apart benign and malicious processes great so what do we do with this",
    "start": "765060",
    "end": "771180"
  },
  {
    "text": "of course this is the era of machine learning so why not using machine learning that's a just a joke but we use",
    "start": "771180",
    "end": "777660"
  },
  {
    "text": "we use machine learning so we train a series of classifiers they are custom",
    "start": "777660",
    "end": "785010"
  },
  {
    "text": "classifiers in the sense that we don't use off-the-shelf classifiers we combine them in a fairly complex way in order to",
    "start": "785010",
    "end": "792720"
  },
  {
    "text": "tell based on the traffic that we have just used whether there is indication of",
    "start": "792720",
    "end": "799140"
  },
  {
    "text": "rain somewhere or non rent somewhere so now you have at least a high-level view of",
    "start": "799140",
    "end": "805920"
  },
  {
    "text": "what the rent somewhere aware part of shield FS is now let's give you a still",
    "start": "805920",
    "end": "812670"
  },
  {
    "text": "high level overview of what we mean by self-healing normally when you are",
    "start": "812670",
    "end": "819570"
  },
  {
    "text": "interacting with a normal system without shield FS installed with with no",
    "start": "819570",
    "end": "824760"
  },
  {
    "text": "protections installed what happens is when a ransom or application encrypts or",
    "start": "824760",
    "end": "830010"
  },
  {
    "text": "damages or offends in a generic way a file any other processes that tries to",
    "start": "830010",
    "end": "836820"
  },
  {
    "text": "interact with that file afterward it will find of course the encrypted file",
    "start": "836820",
    "end": "842180"
  },
  {
    "text": "if you instead look at the system where shield the fess or equivalent is",
    "start": "842180",
    "end": "848700"
  },
  {
    "text": "installed what we do is anytime we see a",
    "start": "848700",
    "end": "853910"
  },
  {
    "text": "write operation on a file from the first time from a process that has not been",
    "start": "853910",
    "end": "861240"
  },
  {
    "text": "cleared we save that file so every time a process which we don't know yet if",
    "start": "861240",
    "end": "867450"
  },
  {
    "text": "it's malicious or not it tries to issues a write operation which can possibly",
    "start": "867450",
    "end": "872970"
  },
  {
    "text": "change completely the file we save that file before go before letting the right",
    "start": "872970",
    "end": "878940"
  },
  {
    "text": "operation through and this we can do it thanks to the mini filter API we save that file and then we let the operation",
    "start": "878940",
    "end": "884910"
  },
  {
    "text": "through so in case we have a fresh and you know freshly made backup of that",
    "start": "884910",
    "end": "890640"
  },
  {
    "text": "file I mean given like that is not you know super clear but now we say it's",
    "start": "890640",
    "end": "896520"
  },
  {
    "text": "time for digging int digging into this and there is the main author of this research so be very welcome to swap",
    "start": "896520",
    "end": "903450"
  },
  {
    "text": "ourself all right Thank You fati for the",
    "start": "903450",
    "end": "909420"
  },
  {
    "text": "wonderful animation no worries so now we're going to work into the details of",
    "start": "909420",
    "end": "916080"
  },
  {
    "text": "the internals of shield FS and let's start from the detector component so as",
    "start": "916080",
    "end": "923220"
  },
  {
    "text": "Federico briefly mentioned we use the set of detection models that we obtain",
    "start": "923220",
    "end": "929160"
  },
  {
    "text": "by training some custom classifiers and we train these classifiers starting",
    "start": "929160",
    "end": "936089"
  },
  {
    "text": "from the persistent features that political showed you and in particular",
    "start": "936089",
    "end": "941339"
  },
  {
    "text": "we have two types of models we have a first set of models that we call process",
    "start": "941339",
    "end": "947970"
  },
  {
    "text": "centric ones that have been trained by looking at each process individually",
    "start": "947970",
    "end": "953720"
  },
  {
    "text": "then instead we have another kind of model that we call system centric one",
    "start": "953720",
    "end": "959550"
  },
  {
    "text": "that is that it has been trained by considering all the data as coming from",
    "start": "959550",
    "end": "964890"
  },
  {
    "text": "a single large process that is actually the entire system so this model in",
    "start": "964890",
    "end": "970709"
  },
  {
    "text": "comparison to the other one provides a big picture of the entire state of the",
    "start": "970709",
    "end": "976470"
  },
  {
    "text": "system and it is useful for example in cases of multiple small work on the",
    "start": "976470",
    "end": "984240"
  },
  {
    "text": "other hand the system CENTAC model can have sat on higher false positive rate",
    "start": "984240",
    "end": "990029"
  },
  {
    "text": "so we'll see in a bit how we combine this model in a in a way that actually",
    "start": "990029",
    "end": "995670"
  },
  {
    "text": "can can make it more effective and another interesting peculiarities about",
    "start": "995670",
    "end": "1001459"
  },
  {
    "text": "this detection models is that we don't have just a single model but we train multiple classifiers so as shown in this",
    "start": "1001459",
    "end": "1009290"
  },
  {
    "text": "picture instead of training our classifiers using the entire data that we collected we splitted the data in",
    "start": "1009290",
    "end": "1016670"
  },
  {
    "text": "ticks or intervals that are defined by the percentage of accessed files and for",
    "start": "1016670",
    "end": "1024050"
  },
  {
    "text": "each tick we train different classifiers and we organize these models as shown in",
    "start": "1024050",
    "end": "1031520"
  },
  {
    "text": "this picture in what we call the multi tire incremental approach and this",
    "start": "1031520",
    "end": "1037819"
  },
  {
    "text": "organization in this approach has mainly two advantages first we have it can",
    "start": "1037819",
    "end": "1046370"
  },
  {
    "text": "speed up the detection process this is done because we have specialized",
    "start": "1046370",
    "end": "1051650"
  },
  {
    "text": "classifiers that are as I said specialized for capturing the behavior",
    "start": "1051650",
    "end": "1057080"
  },
  {
    "text": "of the rancher during a certain phase and also this is really effective in cases of code",
    "start": "1057080",
    "end": "1064700"
  },
  {
    "text": "injection we know that malware they use such technique to inject",
    "start": "1064700",
    "end": "1070100"
  },
  {
    "text": "malicious code into other processes so we have that a process that has been",
    "start": "1070100",
    "end": "1075440"
  },
  {
    "text": "benign in the past may tend to be malicious in the future because a run swimmer inject malicious code into it",
    "start": "1075440",
    "end": "1081710"
  },
  {
    "text": "and these models are effective in this in this scenario because they take into",
    "start": "1081710",
    "end": "1088460"
  },
  {
    "text": "account different different arisin in the lifetime of a process so we have",
    "start": "1088460",
    "end": "1094030"
  },
  {
    "text": "shorter model like in this feature model one that takes into account only the",
    "start": "1094030",
    "end": "1099590"
  },
  {
    "text": "recent history of the process while we have a global model on the other hand",
    "start": "1099590",
    "end": "1105290"
  },
  {
    "text": "that instead taking takes into account the entire history of our process so the",
    "start": "1105290",
    "end": "1111530"
  },
  {
    "text": "question is how frequently we ask these classifiers for an answer so during each tick we Qui",
    "start": "1111530",
    "end": "1120020"
  },
  {
    "text": "these classifiers simultaneously and the difference is that during the time when",
    "start": "1120020",
    "end": "1125720"
  },
  {
    "text": "ticks go on we reset some of these models so in this case you can see that",
    "start": "1125720",
    "end": "1131780"
  },
  {
    "text": "a tick one model one just look at the recent activity in the lifetime of over",
    "start": "1131780",
    "end": "1139760"
  },
  {
    "text": "process and this of course goes on also with the with the other models and at a",
    "start": "1139760",
    "end": "1147470"
  },
  {
    "text": "certain point we may end up in a situation like this one in which all our",
    "start": "1147470",
    "end": "1153590"
  },
  {
    "text": "models says that a process is malicious we are pretty sure about it we can say ok this this is a run somewhere on the",
    "start": "1153590",
    "end": "1161180"
  },
  {
    "text": "other hand we can have a situation like this one where instead all our detection",
    "start": "1161180",
    "end": "1167180"
  },
  {
    "text": "models agreed in saying that approach is actually benign but we can also have",
    "start": "1167180",
    "end": "1173180"
  },
  {
    "text": "instead a situation in which we are a bit confused so our our classifiers are",
    "start": "1173180",
    "end": "1180470"
  },
  {
    "text": "not pretty sure about the outcome of the detection so what we can do in in this case we have a state in which we are we",
    "start": "1180470",
    "end": "1187790"
  },
  {
    "text": "say that a process is suspicious and in this case we leverage the system centric",
    "start": "1187790",
    "end": "1193850"
  },
  {
    "text": "model that I described before so in this case we look at the big picture of the",
    "start": "1193850",
    "end": "1199910"
  },
  {
    "text": "system in to have more information about the current state of the of the protected",
    "start": "1199910",
    "end": "1206270"
  },
  {
    "text": "system and we can also do something more what we do is we look for traces of",
    "start": "1206270",
    "end": "1212919"
  },
  {
    "text": "Krita functions used by bayi by the process so just a brief recap we know",
    "start": "1212919",
    "end": "1220250"
  },
  {
    "text": "that most of run to my families nowadays use block cipher block ciphers they do",
    "start": "1220250",
    "end": "1228409"
  },
  {
    "text": "it because they are fast and the goal of ransomware is to encrypt all the files",
    "start": "1228409",
    "end": "1233690"
  },
  {
    "text": "of the user as soon as possible because they don't want to then want the user to",
    "start": "1233690",
    "end": "1238789"
  },
  {
    "text": "notice that their file are slowly being encrypted and block cipher block ciphers",
    "start": "1238789",
    "end": "1248000"
  },
  {
    "text": "work in an iterative way so they perform different rounds of encryption and for",
    "start": "1248000",
    "end": "1254330"
  },
  {
    "text": "each round they need the key to perform the round encryption so this means that",
    "start": "1254330",
    "end": "1259640"
  },
  {
    "text": "there is a process that is called key schedule that takes an input the user",
    "start": "1259640",
    "end": "1267169"
  },
  {
    "text": "key so that the key that the user or the developer provided the cipher and from",
    "start": "1267169",
    "end": "1272690"
  },
  {
    "text": "that key there eat the rise a set of sub keys that are used each of them unit in",
    "start": "1272690",
    "end": "1278480"
  },
  {
    "text": "a different round during the encryption and these sub keys that are generated",
    "start": "1278480",
    "end": "1284059"
  },
  {
    "text": "during the key schedule are let's say",
    "start": "1284059",
    "end": "1289270"
  },
  {
    "text": "respect a mathematical relationship so the way these sub keys are generated is",
    "start": "1289270",
    "end": "1294890"
  },
  {
    "text": "known in deterministic of course it depends on the file on the site we are using but there is a mathematical",
    "start": "1294890",
    "end": "1300409"
  },
  {
    "text": "relationship between these values and these values are stored sequentially memory for performing issues performance",
    "start": "1300409",
    "end": "1308270"
  },
  {
    "text": "issues sorry so what we can do this is the situation in which for example we",
    "start": "1308270",
    "end": "1314659"
  },
  {
    "text": "can find in memory all these values that are related to to the different rounds",
    "start": "1314659",
    "end": "1321470"
  },
  {
    "text": "of encryption and we can do what we can do is look in the memory of a process if",
    "start": "1321470",
    "end": "1327350"
  },
  {
    "text": "there is a sequence of bytes that actually match the mathematical",
    "start": "1327350",
    "end": "1332630"
  },
  {
    "text": "relationship of the his schedule if we find the sequence of bytes we can say okay this is like a schedule so it",
    "start": "1332630",
    "end": "1338400"
  },
  {
    "text": "means that this process is using a block cipher is using it's performing encryption so now you may wonder yeah",
    "start": "1338400",
    "end": "1346470"
  },
  {
    "text": "but what about you find randomly some bytes that match this relationship well",
    "start": "1346470",
    "end": "1353160"
  },
  {
    "text": "the probability of finding this scenario is it's really really really low for AES",
    "start": "1353160",
    "end": "1361460"
  },
  {
    "text": "that is the most spread block cipher we",
    "start": "1361460",
    "end": "1366570"
  },
  {
    "text": "have that in the worst case the probability of a false positive is 2 to the minus 1344 so we can definitely say",
    "start": "1366570",
    "end": "1375210"
  },
  {
    "text": "that this is impractical impractical it's infeasible and it probably will",
    "start": "1375210",
    "end": "1380730"
  },
  {
    "text": "never happen ok so now let's look how",
    "start": "1380730",
    "end": "1386610"
  },
  {
    "text": "all these components are organized into the architecture of shield FS here we",
    "start": "1386610",
    "end": "1393540"
  },
  {
    "text": "have our processes running in user space and we have the i/o manager provided by",
    "start": "1393540",
    "end": "1399570"
  },
  {
    "text": "the operating system that allows processes to communicate with the file system and perform action on on the file",
    "start": "1399570",
    "end": "1406740"
  },
  {
    "text": "system so reading a file writing a file and so on and attached to this i/o",
    "start": "1406740",
    "end": "1413100"
  },
  {
    "text": "manager she'll FS present the detection component so as we we already saw we",
    "start": "1413100",
    "end": "1420600"
  },
  {
    "text": "have different models we have the post centric models we have the system centric model and we also have the equip",
    "start": "1420600",
    "end": "1427080"
  },
  {
    "text": "to find that can look at the memory of a process to spot any artifacts of the use",
    "start": "1427080",
    "end": "1433710"
  },
  {
    "text": "of cryptographic primitives and then we also have what we call the shield ER",
    "start": "1433710",
    "end": "1439950"
  },
  {
    "text": "that instead is the module that protects the user data so it is the module that",
    "start": "1439950",
    "end": "1446150"
  },
  {
    "text": "performs a copy before a file is overwritten and it is able to",
    "start": "1446150",
    "end": "1452160"
  },
  {
    "text": "automatically in transparently to the end-user restore the original files when",
    "start": "1452160",
    "end": "1457470"
  },
  {
    "text": "malicious activity has been detected here in this picture we envision to have",
    "start": "1457470",
    "end": "1463310"
  },
  {
    "text": "secondary drive so a shadow drive in which we can store our our copies but this is not a fundamental",
    "start": "1463310",
    "end": "1470580"
  },
  {
    "text": "requirement of our system and if we look",
    "start": "1470580",
    "end": "1477140"
  },
  {
    "text": "specifically to at this recovery and and",
    "start": "1477140",
    "end": "1482240"
  },
  {
    "text": "protecting process we can we can examine the file recovery workflow of our system",
    "start": "1482240",
    "end": "1489980"
  },
  {
    "text": "so we have that at the beginning when a process starts she'll the first",
    "start": "1489980",
    "end": "1495000"
  },
  {
    "text": "considers it asthma as unknown because it has it has not enough information to",
    "start": "1495000",
    "end": "1501600"
  },
  {
    "text": "say if it is malicious or not so in this state the process is monitored by should",
    "start": "1501600",
    "end": "1508410"
  },
  {
    "text": "FS and she'll FS applies a copyright layer to perform a copy of a file before",
    "start": "1508410",
    "end": "1517290"
  },
  {
    "text": "it is overwritten and notice that for performance issues we perform the copy",
    "start": "1517290",
    "end": "1524280"
  },
  {
    "text": "of the file just the first time it is modified then we keep this copy in a",
    "start": "1524280",
    "end": "1529980"
  },
  {
    "text": "cache for a certain amount of time and whenever so if a process overrides so",
    "start": "1529980",
    "end": "1537900"
  },
  {
    "text": "modifies our file multiple times in a short time multiple yeah so ultimate",
    "start": "1537900",
    "end": "1543240"
  },
  {
    "text": "times in a short time we perform the copy of the file just does the first",
    "start": "1543240",
    "end": "1548280"
  },
  {
    "text": "time so then when when our detector has collected enough information to say if a",
    "start": "1548280",
    "end": "1556290"
  },
  {
    "text": "process is malicious or not we can have a case in which we founded the process",
    "start": "1556290",
    "end": "1561540"
  },
  {
    "text": "malicious and in this case we can transparently and automatically restore",
    "start": "1561540",
    "end": "1566550"
  },
  {
    "text": "the original copies on the other hand we have that if a process has been detected",
    "start": "1566550",
    "end": "1572010"
  },
  {
    "text": "as has been identified as benign we can clear the DF copies this is not over",
    "start": "1572010",
    "end": "1579440"
  },
  {
    "text": "because this is another step that is important so whenever we say that a",
    "start": "1579440",
    "end": "1585110"
  },
  {
    "text": "process is benign we then say that it is unknown so this might sound weird for",
    "start": "1585110",
    "end": "1593520"
  },
  {
    "text": "you but if you think about it it's still related to the code injection scenario",
    "start": "1593520",
    "end": "1599420"
  },
  {
    "text": "so we have that a process that as detective as benign could turn to be malicious in the future because run",
    "start": "1599420",
    "end": "1606240"
  },
  {
    "text": "summer inject malicious code into it so we have to enter this scenario and so",
    "start": "1606240",
    "end": "1611970"
  },
  {
    "text": "whenever we say that opposite is benign then we we keep considering as unknown and we keep monitoring its activity and",
    "start": "1611970",
    "end": "1620850"
  },
  {
    "text": "just a quick thing if you're wondering how much this cost to the user the",
    "start": "1620850",
    "end": "1627000"
  },
  {
    "text": "answer is just a couple of cents in fact we estimated the storage overhead that",
    "start": "1627000",
    "end": "1635220"
  },
  {
    "text": "our tool imposed to the end users by estimating this overhead by looking at",
    "start": "1635220",
    "end": "1643350"
  },
  {
    "text": "the data that we collected from the clean user that we have been monitoring",
    "start": "1643350",
    "end": "1648810"
  },
  {
    "text": "for for a month and we found out that in the worst case Shield FS required less",
    "start": "1648810",
    "end": "1657180"
  },
  {
    "text": "than 15 gigabytes of additional storage or if you want to look at the percentage",
    "start": "1657180",
    "end": "1663710"
  },
  {
    "text": "in comparison to the total amount of storage present in the machine the",
    "start": "1663710",
    "end": "1669960"
  },
  {
    "text": "overhead is less than nine percent all",
    "start": "1669960",
    "end": "1675090"
  },
  {
    "text": "right so now you probably want to see some more numbers about the tests the tests and evaluation of Sheila Fez and",
    "start": "1675090",
    "end": "1683210"
  },
  {
    "text": "first of all we evaluated the detection or recovery capability of CFS so we used",
    "start": "1683210",
    "end": "1690530"
  },
  {
    "text": "almost 1,500 samples and these samples",
    "start": "1690530",
    "end": "1696980"
  },
  {
    "text": "have never been seen during the training phase so samples completely new and",
    "start": "1696980",
    "end": "1702840"
  },
  {
    "text": "unseen by our detection models here you can see also some some families of these",
    "start": "1702840",
    "end": "1709140"
  },
  {
    "text": "samples and even more interesting you can see here that most of these families",
    "start": "1709140",
    "end": "1717680"
  },
  {
    "text": "were not present in our training set so in our training set there was no sample",
    "start": "1717680",
    "end": "1724800"
  },
  {
    "text": "of these families this means that our detection models are generic enough also",
    "start": "1724800",
    "end": "1730980"
  },
  {
    "text": "to detect different kind of random activity of different families and in fact we achieved a pretty good",
    "start": "1730980",
    "end": "1737770"
  },
  {
    "text": "result pretty good detection rate at is ninety ninety six point nine percent but",
    "start": "1737770",
    "end": "1743490"
  },
  {
    "text": "even better we found that in all our tests the files that that have always",
    "start": "1743490",
    "end": "1751240"
  },
  {
    "text": "been protected by she'd FS so there was no file loss during the execution of",
    "start": "1751240",
    "end": "1756340"
  },
  {
    "text": "this consumer even in the case of a miss detection what does it mean it means",
    "start": "1756340",
    "end": "1761440"
  },
  {
    "text": "that the difference is that in the case process is coated to detect that she'll",
    "start": "1761440",
    "end": "1766990"
  },
  {
    "text": "FS can automatically and transparently to the end-user restore the original copies on the other hand if in the case",
    "start": "1766990",
    "end": "1775059"
  },
  {
    "text": "of a miss detection this cannot happen but still we have the copies of the",
    "start": "1775059",
    "end": "1781179"
  },
  {
    "text": "original files in our secure storage and if the user when the user notice the infection can recover the files",
    "start": "1781179",
    "end": "1788860"
  },
  {
    "text": "automatically manually sorry we also",
    "start": "1788860",
    "end": "1794740"
  },
  {
    "text": "evaluated the false positives of our detector and to do so we used a",
    "start": "1794740",
    "end": "1800230"
  },
  {
    "text": "technique called one machine of cross-validation so basically we took",
    "start": "1800230",
    "end": "1806530"
  },
  {
    "text": "off the data of one of our eleven machines from from our training set we",
    "start": "1806530",
    "end": "1812590"
  },
  {
    "text": "trained the models and then we test the models against the machine that we took off from our training set and we",
    "start": "1812590",
    "end": "1819940"
  },
  {
    "text": "repeated this process for all the eleven machines you can see here in this table the results of our evaluation and if you",
    "start": "1819940",
    "end": "1827290"
  },
  {
    "text": "look at the outcome table you can see that in nine cases we did not have any false positive and in the other two",
    "start": "1827290",
    "end": "1835059"
  },
  {
    "text": "cases we really really low false positive so 0.26 twenty-seventh sorry and 0.15",
    "start": "1835059",
    "end": "1842470"
  },
  {
    "text": "percent and also you can see in this table that is interesting that while",
    "start": "1842470",
    "end": "1848950"
  },
  {
    "text": "this system centric model alone as generally higher false positives the",
    "start": "1848950",
    "end": "1854440"
  },
  {
    "text": "combination between the process centric models and the system centric one can",
    "start": "1854440",
    "end": "1859600"
  },
  {
    "text": "get us better results so then we also",
    "start": "1859600",
    "end": "1865440"
  },
  {
    "text": "evaluated the performance impact of our over tool so we perform",
    "start": "1865440",
    "end": "1873700"
  },
  {
    "text": "some micro micro benchmark and we identify three scenarios that we evaluated for measuring this overhead",
    "start": "1873700",
    "end": "1882040"
  },
  {
    "text": "and the first scenario is when a file is open and then read then we have when",
    "start": "1882040",
    "end": "1888880"
  },
  {
    "text": "when a file is open and written for the first time so in this case she'll the first performs a copy of the file before",
    "start": "1888880",
    "end": "1895870"
  },
  {
    "text": "letting the write operation through and",
    "start": "1895870",
    "end": "1901059"
  },
  {
    "text": "then we also have further open bright operations in which the the file has",
    "start": "1901059",
    "end": "1908530"
  },
  {
    "text": "been already copied so we have the copy encash and we don't need to perform another another copy and the results are",
    "start": "1908530",
    "end": "1915240"
  },
  {
    "text": "good in the first and the last scenario but you can see here that these are",
    "start": "1915240",
    "end": "1921370"
  },
  {
    "text": "quite high overhead in the second scenario this is of course view to the",
    "start": "1921370",
    "end": "1926860"
  },
  {
    "text": "fact that Sheila Fest is performing a copy of the file however we did not",
    "start": "1926860",
    "end": "1933160"
  },
  {
    "text": "perceive such a big overhead while we were using machines in which we stalled Sheila Fez so we tried instead to",
    "start": "1933160",
    "end": "1943200"
  },
  {
    "text": "estimate and compute the real overhead",
    "start": "1943200",
    "end": "1948730"
  },
  {
    "text": "perceived by the users and to do so we leveraged the the data that we collected",
    "start": "1948730",
    "end": "1955150"
  },
  {
    "text": "from the clean users so we aggregate aggregated the ILP logs that we",
    "start": "1955150",
    "end": "1961059"
  },
  {
    "text": "collected into a sequence of file system system calls and we map this this",
    "start": "1961059",
    "end": "1968250"
  },
  {
    "text": "sequence to the three scenarios that I showed you before in this way we were",
    "start": "1968250",
    "end": "1973660"
  },
  {
    "text": "able to estimate the user perceived overhead that in this case is on average",
    "start": "1973660",
    "end": "1982960"
  },
  {
    "text": "about 26% it is definitely lower than in",
    "start": "1982960",
    "end": "1989050"
  },
  {
    "text": "the previous case and also acceptable acceptable by the user all right so now",
    "start": "1989050",
    "end": "1995800"
  },
  {
    "text": "we have a little live demo window a test Sheila fess against",
    "start": "1995800",
    "end": "2002630"
  },
  {
    "text": "when I cry I try this demo like 20 times so I don't see any reason why I",
    "start": "2002630",
    "end": "2010279"
  },
  {
    "text": "shouldn't work but in in case I have a bag of videos or don't worry and the",
    "start": "2010279",
    "end": "2016460"
  },
  {
    "text": "interesting part here is that I'm using a machine that we use for our initial experiments in 2016",
    "start": "2016460",
    "end": "2022940"
  },
  {
    "text": "so I'm gonna stop this machine from a snapshot that is February 2016 while we",
    "start": "2022940",
    "end": "2029720"
  },
  {
    "text": "know that one a cry has been released just a couple of couple of months ago so",
    "start": "2029720",
    "end": "2035600"
  },
  {
    "text": "this shows that our detection models are generic and can detect even unseen new",
    "start": "2035600",
    "end": "2042440"
  },
  {
    "text": "malware all right so first of all I'm",
    "start": "2042440",
    "end": "2050089"
  },
  {
    "text": "gonna download this sample",
    "start": "2050089",
    "end": "2053859"
  },
  {
    "text": "okay as you can see also the certificate check failed because of the timestamp of",
    "start": "2065030",
    "end": "2071330"
  },
  {
    "text": "the machine that is from 2016",
    "start": "2071330",
    "end": "2075250"
  },
  {
    "text": "all right so here is our sample before",
    "start": "2098310",
    "end": "2107760"
  },
  {
    "text": "in fact in the machine I'm gonna show you some decoy files that we place in",
    "start": "2107760",
    "end": "2114560"
  },
  {
    "text": "the machine and I'm gonna hope in this tool that allows us to see the logs",
    "start": "2114560",
    "end": "2121920"
  },
  {
    "text": "generated by kernel drivers so we're gonna see the log produced by LFS during",
    "start": "2121920",
    "end": "2127290"
  },
  {
    "text": "its activity now I'm gonna infect the",
    "start": "2127290",
    "end": "2132330"
  },
  {
    "text": "machine but before doing this for I'm gonna shut down the network so your laptop's are fine I'm not gonna infect",
    "start": "2132330",
    "end": "2139140"
  },
  {
    "text": "you ok these are the typical files",
    "start": "2139140",
    "end": "2150380"
  },
  {
    "text": "produced by wanna cry when when it starts and we can see here that there is",
    "start": "2150380",
    "end": "2163500"
  },
  {
    "text": "a process that is performing a lot of operation on the disk so it it's reading",
    "start": "2163500",
    "end": "2171390"
  },
  {
    "text": "or writing a lot of files and the in this case is our is our sample and we",
    "start": "2171390",
    "end": "2177000"
  },
  {
    "text": "can see also that here our decoy files",
    "start": "2177000",
    "end": "2183810"
  },
  {
    "text": "are slowly being encrypted by wanna cry so fill the first in this in the",
    "start": "2183810",
    "end": "2192510"
  },
  {
    "text": "meantime is monitoring its activity the activity of the process and if",
    "start": "2192510",
    "end": "2198000"
  },
  {
    "text": "everything goes well we should see some log here ok",
    "start": "2198000",
    "end": "2203089"
  },
  {
    "text": "so here she's the first the global model of Phyllis of Sheila's has detected",
    "start": "2206120",
    "end": "2211530"
  },
  {
    "text": "suspicious activity and it just asked the crypto finder to look for further",
    "start": "2211530",
    "end": "2221250"
  },
  {
    "text": "proof in this case it didn't find any any traces of the AES block cipher but",
    "start": "2221250",
    "end": "2226980"
  },
  {
    "text": "is it still monitoring monitors the the process and we see that after two other",
    "start": "2226980",
    "end": "2232590"
  },
  {
    "text": "ticks so when the the detection mode the the global model detected the the",
    "start": "2232590",
    "end": "2238170"
  },
  {
    "text": "process are the two times in the for the ticks the the ransom is is finally",
    "start": "2238170",
    "end": "2244730"
  },
  {
    "text": "detected and killed by Shield FS so now for demo purposes she'll FS did not",
    "start": "2244730",
    "end": "2253530"
  },
  {
    "text": "restore the device automatically but I'm gonna do it manually but of course this",
    "start": "2253530",
    "end": "2258630"
  },
  {
    "text": "is done usually automatically by a by our tool so here I'm gonna start our",
    "start": "2258630",
    "end": "2265010"
  },
  {
    "text": "reverter ok that found the process with",
    "start": "2265010",
    "end": "2273360"
  },
  {
    "text": "with the malicious activity that the detector identified and year",
    "start": "2273360",
    "end": "2279440"
  },
  {
    "text": "you can see the Pfizer are slowly being restored you can see that the same files",
    "start": "2279440",
    "end": "2284760"
  },
  {
    "text": "are being slowly restored okay we can",
    "start": "2284760",
    "end": "2297210"
  },
  {
    "text": "wait for the entire revert process okay",
    "start": "2297210",
    "end": "2309809"
  },
  {
    "text": "that's it everything is done no file loss we have our files back",
    "start": "2309809",
    "end": "2316548"
  },
  {
    "text": "okay so to conclude the presentation I'm gonna leave the stage to Federico yeah",
    "start": "2320970",
    "end": "2326410"
  },
  {
    "text": "but it didn't put an animation for that Thank You Andrea so it seems that we",
    "start": "2326410",
    "end": "2332830"
  },
  {
    "text": "actually achieved this is what this is what what we wanted to have when we conceived this I still remember in the",
    "start": "2332830",
    "end": "2338770"
  },
  {
    "text": "whiteboard in the lab we had sketches that says we want a file system that natively supports ransomware detection",
    "start": "2338770",
    "end": "2347470"
  },
  {
    "text": "and reverting operation if you're familiar with ZFS and similar file system you can already see some some",
    "start": "2347470",
    "end": "2354760"
  },
  {
    "text": "similarity of this the fact that is that the ZFS does not have any of these ransomware aware capability so this is",
    "start": "2354760",
    "end": "2362440"
  },
  {
    "text": "what we got our inspiration and we're very very happy that we were able to make it",
    "start": "2362440",
    "end": "2367600"
  },
  {
    "text": "we had a detection component that implements a generic detection model as you have seen wanna cry didn't even",
    "start": "2367600",
    "end": "2374950"
  },
  {
    "text": "existed when we created that machine there's no signatures whatsoever we trained shield efest",
    "start": "2374950",
    "end": "2381790"
  },
  {
    "text": "on a few on a few samples 383 if I remember correctly and that was it now",
    "start": "2381790",
    "end": "2387490"
  },
  {
    "text": "we can detect we want to cry in the protection well you have already",
    "start": "2387490",
    "end": "2392800"
  },
  {
    "text": "seen it in action so I think I mean I'm super super happy of being able to work",
    "start": "2392800",
    "end": "2399610"
  },
  {
    "text": "with Andre on this to be his advisor on this I think this is a this is time for",
    "start": "2399610",
    "end": "2404710"
  },
  {
    "text": "questions just a reminder there is also an academic paper describing this so if",
    "start": "2404710",
    "end": "2410830"
  },
  {
    "text": "you want to dig into the into the details we've also set up a website where we collect some materials and so",
    "start": "2410830",
    "end": "2418690"
  },
  {
    "text": "on we're not really using the the code because we have a patent pending",
    "start": "2418690",
    "end": "2424140"
  },
  {
    "text": "number two seven two seven zero one nine four questions we are available here for",
    "start": "2424140",
    "end": "2431470"
  },
  {
    "text": "brief questions like do you guys go to the same barber yes or but you know we",
    "start": "2431470",
    "end": "2438130"
  },
  {
    "text": "have for like elaborate questions and long questions such as why do you guys look bald but right bald we have the",
    "start": "2438130",
    "end": "2446350"
  },
  {
    "text": "wrap-up room so if you are available for for longer questions just feel free we",
    "start": "2446350",
    "end": "2452320"
  },
  {
    "text": "have a first question here I'm going to yeah just because a bit louder please yes",
    "start": "2452320",
    "end": "2461160"
  },
  {
    "text": "I don't understand the last part of the question okay",
    "start": "2472500",
    "end": "2486380"
  },
  {
    "text": "oh I see so what you're asking if I'm just repeating both for recording and",
    "start": "2486630",
    "end": "2492029"
  },
  {
    "text": "for you know making sure that I understood you're asking if there is a process that is harvesting many files in",
    "start": "2492029",
    "end": "2497700"
  },
  {
    "text": "the system is there a chance that we might confuse it with that it might",
    "start": "2497700",
    "end": "2503549"
  },
  {
    "text": "trigger some of the features not all of them altogether that's why we have several features in our experiments we",
    "start": "2503549",
    "end": "2511559"
  },
  {
    "text": "had applications performing like zip operations or you know file operations",
    "start": "2511559",
    "end": "2517559"
  },
  {
    "text": "with many files involved and high entropy and we didn't see any of those",
    "start": "2517559",
    "end": "2522599"
  },
  {
    "text": "false positives but you know a file that a process that really resembles like ransomware activity with encryption with",
    "start": "2522599",
    "end": "2530400"
  },
  {
    "text": "harvesting and renaming and everything well it's a ransomware or you know it's a it's a funny it's a funny program thank you any other",
    "start": "2530400",
    "end": "2539339"
  },
  {
    "text": "oh we have many there sorry we don't know which which came first oh sorry",
    "start": "2539339",
    "end": "2552469"
  },
  {
    "text": "yeah that would be great much better you were able to identify the crypto",
    "start": "2552469",
    "end": "2560249"
  },
  {
    "text": "algorithm that the runs more used to to use to encrypt the files the AES algorithm our curiosity were you able to",
    "start": "2560249",
    "end": "2567660"
  },
  {
    "text": "find that their key or any interest in in deeper analysis yep so when you look",
    "start": "2567660",
    "end": "2575249"
  },
  {
    "text": "and detect the key schedule the first let's say the first row the key schedule is the the actual key so the real key",
    "start": "2575249",
    "end": "2580979"
  },
  {
    "text": "that is used for the encryption so once we recover the key we could use for example that key to decrypt the files",
    "start": "2580979",
    "end": "2586769"
  },
  {
    "text": "instead of using our copies but this process is unreliable so the technique",
    "start": "2586769",
    "end": "2593489"
  },
  {
    "text": "that the traces of a kippah function is not reliable you cannot guarantee 100% of files protected and recovered by by",
    "start": "2593489",
    "end": "2600900"
  },
  {
    "text": "by using such approach so yes we could recover the key but is not very reliable",
    "start": "2600900",
    "end": "2606359"
  },
  {
    "text": "so this why what our approach does not completely rely on this strategy with",
    "start": "2606359",
    "end": "2614369"
  },
  {
    "text": "concurrency if multiple applications arise in the same file possible it multiple benign of",
    "start": "2614369",
    "end": "2619440"
  },
  {
    "text": "occasions but you said in one diagram that the banana patient gets a copy of the file where the most application gets",
    "start": "2619440",
    "end": "2626340"
  },
  {
    "text": "the original file yeah so first of all we performed a copy of the file just the",
    "start": "2626340",
    "end": "2633210"
  },
  {
    "text": "first time so the first the first application that writes that file then",
    "start": "2633210",
    "end": "2638370"
  },
  {
    "text": "that case we perform the copy so and we stole the code is it in the Covina in a secure storage and we hit them in a",
    "start": "2638370",
    "end": "2644670"
  },
  {
    "text": "cache for a certain amount of time so the other application can still access the access this file and write the file",
    "start": "2644670",
    "end": "2650520"
  },
  {
    "text": "modified and so on and then you know in a short period where we have the dead file in cache we don't we do not perform",
    "start": "2650520",
    "end": "2657900"
  },
  {
    "text": "any other copies but once the cache expires we will perform another another copy of the file on the next write",
    "start": "2657900",
    "end": "2664200"
  },
  {
    "text": "operation so if you want to see you know from another perspective is like a an",
    "start": "2664200",
    "end": "2669810"
  },
  {
    "text": "extension of an existing backup system that very frequently takes snapshots so if you have like backups backing up like",
    "start": "2669810",
    "end": "2676530"
  },
  {
    "text": "every half hour with this you extend the lifetime of the backup to the last I don't know a few minutes or for the last",
    "start": "2676530",
    "end": "2682710"
  },
  {
    "text": "hour ok so going along those lines from",
    "start": "2682710",
    "end": "2688080"
  },
  {
    "text": "an ESX standpoint you know taking snapshots also two separate questions",
    "start": "2688080",
    "end": "2695190"
  },
  {
    "text": "sorry also how does it integrate or interact with antivirus products like",
    "start": "2695190",
    "end": "2700980"
  },
  {
    "text": "McAfee or malwarebytes or anything like that because you're doing a lot of read rights you're doing a lot of sniffing",
    "start": "2700980",
    "end": "2707490"
  },
  {
    "text": "and both of those are doing that too so from an implementation point of view in",
    "start": "2707490",
    "end": "2713160"
  },
  {
    "text": "this mini filter with these drivers with these mini filters there is like a stack",
    "start": "2713160",
    "end": "2721410"
  },
  {
    "text": "of these drivers and you can select the attitude of the driver into the position",
    "start": "2721410",
    "end": "2726990"
  },
  {
    "text": "which one should be on the top and which one should be on the bottom so according to the different requirements of the",
    "start": "2726990",
    "end": "2732870"
  },
  {
    "text": "different tools of different programs we could place our our our tooling in the",
    "start": "2732870",
    "end": "2740760"
  },
  {
    "text": "right in the right position without interfering with of course we did with",
    "start": "2740760",
    "end": "2746160"
  },
  {
    "text": "the other software yeah there are some thoughts on like kernel-based Mulder",
    "start": "2746160",
    "end": "2752020"
  },
  {
    "text": "ransomware and second like petia like you know approaches which would like",
    "start": "2752020",
    "end": "2757420"
  },
  {
    "text": "alright and then do the encryption from a completely different environment can",
    "start": "2757420",
    "end": "2763180"
  },
  {
    "text": "you because the very first part wasn't clear so though so do you have some thoughts on kernel based attacks that",
    "start": "2763180",
    "end": "2769990"
  },
  {
    "text": "because your system is based on kernel just wondering if you have any thoughts on that and ii was ransomware that might",
    "start": "2769990",
    "end": "2776500"
  },
  {
    "text": "like oh petia kind of approach is right that overwrite MBR then do the encryption from a completely different",
    "start": "2776500",
    "end": "2781630"
  },
  {
    "text": "subsystem right that emulates bios or something like that alright so this is",
    "start": "2781630",
    "end": "2788910"
  },
  {
    "text": "kind of out of our our scope but in the case for example of petia even though it",
    "start": "2788910",
    "end": "2797830"
  },
  {
    "text": "does not actually encrypt the files but our our approach in performing their copies and protecting the the user that",
    "start": "2797830",
    "end": "2804160"
  },
  {
    "text": "i will still be effective against this kind of attack so you can still try to",
    "start": "2804160",
    "end": "2809770"
  },
  {
    "text": "recover manually the the encrypted files and if i could continue on the kernel on",
    "start": "2809770",
    "end": "2815980"
  },
  {
    "text": "the kernel type of attack I mean our attacker model as you can clearly see is the attacker is not in the kernel right",
    "start": "2815980",
    "end": "2823080"
  },
  {
    "text": "as it you know most of the time is if the attacker is in the kernel even if you have an anti-virus I mean might be",
    "start": "2823080",
    "end": "2829510"
  },
  {
    "text": "too late right so I think this opens a completely different resource line that",
    "start": "2829510",
    "end": "2835119"
  },
  {
    "text": "stands with how do you ensure that you can monitor from from the outside like in an in clave or from DMA stuff and",
    "start": "2835119",
    "end": "2843310"
  },
  {
    "text": "things like that but this is a bit you know a parallel at Ashurst line then then ransomware but it's a very you know",
    "start": "2843310",
    "end": "2849960"
  },
  {
    "text": "yeah interesting question thank you thank you still have I think a couple of",
    "start": "2849960",
    "end": "2856839"
  },
  {
    "text": "minutes for questions you guys have some I had had one if if a attacker",
    "start": "2856839",
    "end": "2863320"
  },
  {
    "text": "understood your filesystem how would you estimate that they would best try to subvert it like if they were to use a",
    "start": "2863320",
    "end": "2870010"
  },
  {
    "text": "different and quick encryption algorithm or something like what do you see the weakness in your approach you're asking",
    "start": "2870010",
    "end": "2875950"
  },
  {
    "text": "about if we can design an evasion and evasive malware that pousada can I pass",
    "start": "2875950",
    "end": "2880960"
  },
  {
    "text": "by pass your detection algorithms well it's really about you can evade all of the features",
    "start": "2880960",
    "end": "2886960"
  },
  {
    "text": "altogether so you have to write a very slow ransomware that doesn't rename any files in a short",
    "start": "2886960",
    "end": "2893800"
  },
  {
    "text": "time that maybe doesn't rename any files at all that it writes files very slowly",
    "start": "2893800",
    "end": "2900790"
  },
  {
    "text": "low level of entropy so it's kind of against he the business model of a",
    "start": "2900790",
    "end": "2907240"
  },
  {
    "text": "classical rain swimmer but yes I mean if you have enough time you can design a",
    "start": "2907240",
    "end": "2912940"
  },
  {
    "text": "malware that is you know silent enough we have taught about it but in the paper",
    "start": "2912940",
    "end": "2919030"
  },
  {
    "text": "there is a section where we describe all the variables that are involved there are more than what we have explained",
    "start": "2919030",
    "end": "2924730"
  },
  {
    "text": "here there is the possibility for for designing a invasive sample targeting",
    "start": "2924730",
    "end": "2931270"
  },
  {
    "text": "shield offense but we believe it's pretty distant from what the attackers",
    "start": "2931270",
    "end": "2936910"
  },
  {
    "text": "want to do it is probably easier for the attacker to evade the encryption",
    "start": "2936910",
    "end": "2942190"
  },
  {
    "text": "detection then evade in the features also another thing that the attacker can do to make it difficult to be detected I",
    "start": "2942190",
    "end": "2948640"
  },
  {
    "text": "did that we did not really test because there is no sample that does this is like for example using a lot of",
    "start": "2948640",
    "end": "2955119"
  },
  {
    "text": "processes so if you for example consider in the worst case a malware that spawns",
    "start": "2955119",
    "end": "2961930"
  },
  {
    "text": "different processes and each process encrypt just one tile you you would see that that process is not behind because",
    "start": "2961930",
    "end": "2967900"
  },
  {
    "text": "it's accessing encryption just one file but in that case that's why we included the system centric model that is that",
    "start": "2967900",
    "end": "2973839"
  },
  {
    "text": "look at it at the big picture of the system so unfortunately we didn't test it so well because we didn't find any",
    "start": "2973839",
    "end": "2980230"
  },
  {
    "text": "many malware that does this but this could be a way to make our shield fast",
    "start": "2980230",
    "end": "2985359"
  },
  {
    "text": "detector job really really difficult yeah thank you I guess maybe do we have",
    "start": "2985359",
    "end": "2993790"
  },
  {
    "text": "time for the last question so what the word is your back up of the original",
    "start": "2993790",
    "end": "3000780"
  },
  {
    "text": "files reside and if it is if it results in the file system have you encountered",
    "start": "3000780",
    "end": "3007020"
  },
  {
    "text": "a ransomware that was able to encrypt the backup of the files this is an",
    "start": "3007020",
    "end": "3012930"
  },
  {
    "text": "interesting question and so our backup can can be stored in",
    "start": "3012930",
    "end": "3020670"
  },
  {
    "text": "the same file system or in for example in a secondary drive but the important thing is that we make the folder in",
    "start": "3020670",
    "end": "3027569"
  },
  {
    "text": "which we store our copies not accessible by user space application so no user space application can can write in that",
    "start": "3027569",
    "end": "3034380"
  },
  {
    "text": "folder only can it connect on the kernel size on only our module that is in the",
    "start": "3034380",
    "end": "3040530"
  },
  {
    "text": "kernel can writes can write into that folder so we deny any right operation",
    "start": "3040530",
    "end": "3046319"
  },
  {
    "text": "from from the user land thank you thank you",
    "start": "3046319",
    "end": "3051600"
  },
  {
    "text": "[Applause]",
    "start": "3051600",
    "end": "3056730"
  }
]