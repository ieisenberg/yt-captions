[
  {
    "start": "0",
    "end": "317000"
  },
  {
    "text": "hello thank you very much I'm actually going to be doing this talk with my friend bunny my daughter asked me to",
    "start": "0",
    "end": "6540"
  },
  {
    "text": "bring bunny with me so can everyone just say hi bunny thank you very much so I'm Shawn Metcalfe this is from",
    "start": "6540",
    "end": "13290"
  },
  {
    "text": "workstation the domain admin why secure administration isn't secure and how to fix it so I'm Shawn I'm the founder of",
    "start": "13290",
    "end": "19890"
  },
  {
    "text": "Trimark a company that helps organizations better secure their Microsoft environment including the Microsoft cloud I'm a Microsoft",
    "start": "19890",
    "end": "25890"
  },
  {
    "text": "Certified Master Mac to directory there's about a hundred in the world most of whom work for Microsoft I do not I've spoken before at blackhat",
    "start": "25890",
    "end": "33030"
  },
  {
    "text": "I'm very excited to be here so thank you very much for being here with me I'm a security consultant and researcher and I",
    "start": "33030",
    "end": "39360"
  },
  {
    "text": "own and operate 80 security org which hopefully many people have heard of are used to help secure your environment so",
    "start": "39360",
    "end": "46649"
  },
  {
    "text": "there's a number of things I'm going to talk about during this presentation I'm going to talk about where we've come from as far as administration what it",
    "start": "46649",
    "end": "53430"
  },
  {
    "text": "looked like as we've advanced what we've done over the years and the weaknesses",
    "start": "53430",
    "end": "58559"
  },
  {
    "text": "that are still inherent in those processes as well as the things that are currently considered secure",
    "start": "58559",
    "end": "64610"
  },
  {
    "text": "administration and why they aren't and then I'm going to close up with how to better secure your environment and how",
    "start": "64610",
    "end": "71070"
  },
  {
    "text": "to better perform secure administration so many organizations have upgraded",
    "start": "71070",
    "end": "76259"
  },
  {
    "text": "their security we've added better visibility through security tooling event logging auditing ADR tools we have",
    "start": "76259",
    "end": "84360"
  },
  {
    "text": "blinky boxes we've flowed all these security events hopefully many of them into our sim tool we're watching those",
    "start": "84360",
    "end": "91799"
  },
  {
    "text": "we're getting alerts we've done all of these other things to lockdown secure workstations to have better control of a",
    "start": "91799",
    "end": "98250"
  },
  {
    "text": "better visibility in our environment but rarely have we actually done much to secure or improve the way that a quick",
    "start": "98250",
    "end": "104850"
  },
  {
    "text": "turi is administered we need to do better based on what I've seen so let's",
    "start": "104850",
    "end": "113070"
  },
  {
    "text": "start from the beginning in the beginning we had a workstation and we had a happy user on their",
    "start": "113070",
    "end": "118500"
  },
  {
    "text": "workstation and this user had problems so we added desktop support and desktop",
    "start": "118500",
    "end": "124380"
  },
  {
    "text": "support met a bunch of other administrators with remote access or local admin access on that system and",
    "start": "124380",
    "end": "131640"
  },
  {
    "text": "after desktop support we realized what we need to patch the system there's vulnerabilities we need to fix so we",
    "start": "131640",
    "end": "137520"
  },
  {
    "text": "added actually patching and agents associated with Paget and then ultimately we realized this was",
    "start": "137520",
    "end": "143580"
  },
  {
    "text": "too much to handle with all these different systems we need to integrate it better so we set up a mission control",
    "start": "143580",
    "end": "149430"
  },
  {
    "text": "types configuration and with our mission control we had better central management and control of our environment but the",
    "start": "149430",
    "end": "157349"
  },
  {
    "text": "result of all of this is that we have a workstation that has 30 accounts in the",
    "start": "157349",
    "end": "162989"
  },
  {
    "text": "local administrators group which could be a mix of ad accounts and",
    "start": "162989",
    "end": "168090"
  },
  {
    "text": "local accounts we've got about 50 accounts with local admin rights through this management system we've got 20",
    "start": "168090",
    "end": "175410"
  },
  {
    "text": "accounts with control of the computer through security agents or tooling and we end up with about a hundred accounts",
    "start": "175410",
    "end": "181260"
  },
  {
    "text": "that have admin rights how these numbers might be off for a lot of organizations but I'm sure there's some people here",
    "start": "181260",
    "end": "186930"
  },
  {
    "text": "that are trying to hide their head right now because that's a very similar scenario because ultimately it comes",
    "start": "186930",
    "end": "193019"
  },
  {
    "text": "down to who has control of the workstation who are the administrators who can control manage modify that",
    "start": "193019",
    "end": "202500"
  },
  {
    "text": "system and what if the administrator of Active Directory actually uses that",
    "start": "202500",
    "end": "208140"
  },
  {
    "text": "system so let's take a step back and go through the evolution of administration we went from using something like VNC to",
    "start": "208140",
    "end": "214560"
  },
  {
    "text": "RDP we were using run ads in order to run our MMC and a lot of other acronyms but in the beginning there were admins",
    "start": "214560",
    "end": "224040"
  },
  {
    "text": "everywhere we had administrators we had domain admins oftentimes user accounts",
    "start": "224040",
    "end": "230489"
  },
  {
    "text": "were actually domain admins in some situations every local administrator had the same name and password across the",
    "start": "230489",
    "end": "236849"
  },
  {
    "text": "organization and some environments actually had as many domain admins as users which is the ostriches here I",
    "start": "236849",
    "end": "244530"
  },
  {
    "text": "can't tell if they're users or admins but there's a lot of them so that's bad right and this resulted in a situation",
    "start": "244530",
    "end": "251879"
  },
  {
    "text": "where we have an environment that's target-rich the attacker gets into the environment",
    "start": "251879",
    "end": "257100"
  },
  {
    "text": "and they can just kind of pick and choose what they want to use because there's credentials everywhere because",
    "start": "257100",
    "end": "262860"
  },
  {
    "text": "of the way we've been managing our systems the way that we still manage our systems most of the time we're using a",
    "start": "262860",
    "end": "267870"
  },
  {
    "text": "user workstation standard regular user workstation we log on with the user account and then we perform under",
    "start": "267870",
    "end": "273300"
  },
  {
    "text": "administration through RDP or some other method so when we talk about the way",
    "start": "273300",
    "end": "278910"
  },
  {
    "text": "where we were the old-school admin methods like I said logging on to the workstation as an admin we probably",
    "start": "278910",
    "end": "284460"
  },
  {
    "text": "don't do that anymore hopefully because credentials were an else ass for that we don't really use run as any more on our",
    "start": "284460",
    "end": "291780"
  },
  {
    "text": "workstations because again credentials end up in else ass but we do often RDP",
    "start": "291780",
    "end": "296970"
  },
  {
    "text": "to the main controllers or admin servers and manage them but that means the",
    "start": "296970",
    "end": "302490"
  },
  {
    "text": "credentials are in alsace on that system so if we're connecting to an admin server and that admin server isn't well protected then an attacker could use",
    "start": "302490",
    "end": "309180"
  },
  {
    "text": "something like mini cats to extract those credentials and reuse them like",
    "start": "309180",
    "end": "315540"
  },
  {
    "text": "this so where we are now we have newer better secure admin methods right we",
    "start": "315540",
    "end": "322460"
  },
  {
    "start": "317000",
    "end": "317000"
  },
  {
    "text": "said no more to run as we said no more to local MMC's activities and",
    "start": "322460",
    "end": "329040"
  },
  {
    "text": "administration when we use RDP we are",
    "start": "329040",
    "end": "335670"
  },
  {
    "text": "going to use an LA Network level authentication which prompts us for our credentials before we connect to that",
    "start": "335670",
    "end": "341100"
  },
  {
    "text": "system and sometimes we're gonna use MFA in fact I've noticed more and more customers and organizations are using",
    "start": "341100",
    "end": "346260"
  },
  {
    "text": "MFA which is great others are starting to use password vaults enterprise password volts like psychotic secret",
    "start": "346260",
    "end": "352140"
  },
  {
    "text": "server or cyber-ark so let's talk about how we could exploit the typical",
    "start": "352140",
    "end": "357450"
  },
  {
    "start": "356000",
    "end": "356000"
  },
  {
    "text": "administrator so here we have a regular workstation and just a regular username Sean is logged on to it so he needs to",
    "start": "357450",
    "end": "365220"
  },
  {
    "text": "do some work so he's gonna run MS cts see it pops up that RDP window and he's gonna type in his credentials and do",
    "start": "365220",
    "end": "371040"
  },
  {
    "text": "what he normally does as an administrator but behind the scenes",
    "start": "371040",
    "end": "376820"
  },
  {
    "text": "there's a file that just gets dropped into the C Drive it's very interesting",
    "start": "376820",
    "end": "381960"
  },
  {
    "text": "file this temp file",
    "start": "381960",
    "end": "386180"
  },
  {
    "text": "what is this temp file so the attacker behind the scenes completely in stealth",
    "start": "387360",
    "end": "393930"
  },
  {
    "text": "has performed a WMI implant method to drop us a task a w my task on this",
    "start": "393930",
    "end": "400289"
  },
  {
    "text": "system that whenever M STS C dot exe is executed a special PowerShell script is",
    "start": "400289",
    "end": "405689"
  },
  {
    "text": "going to be run that I've decided to call a CCM health check sounds good to me",
    "start": "405689",
    "end": "410960"
  },
  {
    "text": "alright but what does SCCM health check actually do and did microsoft write this",
    "start": "410960",
    "end": "418310"
  },
  {
    "text": "so we go forward and look and see well that doesn't look like a CCM health",
    "start": "418310",
    "end": "423330"
  },
  {
    "text": "check that looks like something very different so when we are trying to",
    "start": "423330",
    "end": "431069"
  },
  {
    "text": "figure out what's going on and we're digging through this we're gonna see that this is the gets keystrokes powersploit function and what keystrokes",
    "start": "431069",
    "end": "438900"
  },
  {
    "text": "does is a PowerShell script or function is actually going to capture this keystrokes while it's running to us to a",
    "start": "438900",
    "end": "445770"
  },
  {
    "text": "text file and that happens to be that temp file that dropped to the C Drive now can go anywhere on the system it",
    "start": "445770",
    "end": "451919"
  },
  {
    "text": "wants but it's going to capture every single key press that happens on that system and it can be quite extensive as",
    "start": "451919",
    "end": "458550"
  },
  {
    "text": "it captures this information the WMI task could also have that text cop file you copy it off to another location or",
    "start": "458550",
    "end": "464580"
  },
  {
    "text": "uploaded to a website and using PowerShell I can go through and quickly",
    "start": "464580",
    "end": "469759"
  },
  {
    "text": "extract the information from this text file and pull it together and when I do",
    "start": "469759",
    "end": "475589"
  },
  {
    "text": "this I can very easily identify assuming that someone typed it in at this moment what the server name is what the user",
    "start": "475589",
    "end": "481319"
  },
  {
    "text": "name is the admin and the actual password so now I have the credentials",
    "start": "481319",
    "end": "486569"
  },
  {
    "text": "and guess what happens if this is the domain admin account yeah I can use",
    "start": "486569",
    "end": "492779"
  },
  {
    "text": "something called DC sync so this is very dangerous and even if I add MFA to this",
    "start": "492779",
    "end": "499620"
  },
  {
    "text": "situation I don't need to use MFA when I'm running DC sync because it's just an LDAP call",
    "start": "499620",
    "end": "505860"
  },
  {
    "text": "to the DC so let's talk a little bit more about this what if we add MFA we",
    "start": "505860",
    "end": "513690"
  },
  {
    "text": "can MFA the RDP so the way you RDP weave its MFA and we got everything covered right well we have our RDP connection we",
    "start": "513690",
    "end": "524050"
  },
  {
    "text": "get our duo prompt I'm not picking on duo but apparently they were in the news recently so I figured I'd use them and",
    "start": "524050",
    "end": "530699"
  },
  {
    "text": "so when we click on this push we get a pop up on our mobile device and we have",
    "start": "530699",
    "end": "537160"
  },
  {
    "text": "two options we approve or deny and looking at it we decide yes this was me I'm going to approve that but what would",
    "start": "537160",
    "end": "543879"
  },
  {
    "text": "happen if I got two of these back-to-back what if I click approve on the first one what do I do the second one well the obvious answer is I deny it",
    "start": "543879",
    "end": "550930"
  },
  {
    "text": "right but how do I know which one is mine and which one isn't or is this a hiccup and the same thing can happen",
    "start": "550930",
    "end": "558550"
  },
  {
    "text": "with a DFS or on my mobile device itself if I just look at the lock screen and it",
    "start": "558550",
    "end": "564759"
  },
  {
    "text": "pops up I'm gonna go yeah prove I just did that but what if another one pops up is that me or did a hiccup or was there a",
    "start": "564759",
    "end": "571569"
  },
  {
    "text": "problem with the operating system on the mobile device or the app what's it what if there's a third one will the user",
    "start": "571569",
    "end": "579399"
  },
  {
    "text": "report this we'll use a report something that's odd that's happening with MFA",
    "start": "579399",
    "end": "584730"
  },
  {
    "text": "what if the attacker can initiate initiate or initialize MFA request at",
    "start": "584730",
    "end": "590050"
  },
  {
    "text": "around the same time the admins using it everyone's very busy when we get prompts like this we our tendency is to click on",
    "start": "590050",
    "end": "596740"
  },
  {
    "text": "it just tap tap tap oh do the second one pop up I don't really know that's okay",
    "start": "596740",
    "end": "602350"
  },
  {
    "text": "it'll be fine so what if there's a way that an attacker could actually subvert",
    "start": "602350",
    "end": "607660"
  },
  {
    "text": "the MFA system so here's a scenario that I'm gonna put together we have this",
    "start": "607660",
    "end": "613930"
  },
  {
    "text": "fictional company called acne and acne has a self-service portal where users can go in and manage their own",
    "start": "613930",
    "end": "620620"
  },
  {
    "text": "attributes these are some standard attributes like work phone number work address mobile number etc so pretty standard a",
    "start": "620620",
    "end": "626500"
  },
  {
    "text": "lot of organizations have this configured attributes may vary so let's say that our admin Luke Skywalker has a",
    "start": "626500",
    "end": "633519"
  },
  {
    "text": "user account and an admin account because he's a smart guy and so he has his mobile number set up in here on his",
    "start": "633519",
    "end": "641559"
  },
  {
    "text": "user account well if the attacker can leverage the self-service portal they can change it to 8 6 75 309 because",
    "start": "641559",
    "end": "649420"
  },
  {
    "text": "that's what any attacker is gonna use as a phone easy to remember and once he has that or",
    "start": "649420",
    "end": "658400"
  },
  {
    "text": "this attacker has access and the ability to change that mobile number things get pretty interesting because in duo by",
    "start": "658400",
    "end": "664820"
  },
  {
    "text": "default or at least in the configurations I've seen as well as other MFA configurations there's a backup to the standard put app push",
    "start": "664820",
    "end": "672310"
  },
  {
    "text": "which is yes SMS or text so oftentimes",
    "start": "672310",
    "end": "677870"
  },
  {
    "text": "it pulls this information from the Active Directory user account for the phone number it should use for that text message so if the attacker has the",
    "start": "677870",
    "end": "684820"
  },
  {
    "text": "credentials of that admin account and they want to leverage MFA one thing that",
    "start": "684820",
    "end": "690500"
  },
  {
    "text": "they can do as an option is modify that phone number that mobile phone number and have a text message sent to their",
    "start": "690500",
    "end": "697400"
  },
  {
    "text": "phone and the actual user who owns that account and it counts doesn't see",
    "start": "697400",
    "end": "703760"
  },
  {
    "text": "anything there's no message that goes to them at all now there's similar",
    "start": "703760",
    "end": "708950"
  },
  {
    "text": "situations with with other MFA systems and so just a summary of this if the",
    "start": "708950",
    "end": "715850"
  },
  {
    "text": "attacker can modify that phone number that mobile number for that user account which is used by the MFA and that backup",
    "start": "715850",
    "end": "723470"
  },
  {
    "text": "SMS text messaging system isn't disabled there's a backdoor a way to use that",
    "start": "723470",
    "end": "730940"
  },
  {
    "text": "account and if these are admin credentials then it could potentially be game over and no one it's possible that",
    "start": "730940",
    "end": "738050"
  },
  {
    "text": "no one will notice now another interesting thing about duo again I promise I'm not picking on do they're",
    "start": "738050",
    "end": "743690"
  },
  {
    "text": "just very popular and like I said there's a lot of activity about duo recently but there was an article",
    "start": "743690",
    "end": "749840"
  },
  {
    "text": "recently a blog post about duo and fail open versus fail closed so by default",
    "start": "749840",
    "end": "756110"
  },
  {
    "text": "duo fails open and duo uses a request",
    "start": "756110",
    "end": "761330"
  },
  {
    "text": "via the DNS lookup and then a connection to its API a record under deal with",
    "start": "761330",
    "end": "768350"
  },
  {
    "text": "security comm so if an attacker is able to actually block that connection what",
    "start": "768350",
    "end": "775310"
  },
  {
    "text": "happens is MFA doesn't work at all so you can change this setting obviously",
    "start": "775310",
    "end": "780800"
  },
  {
    "text": "and there's another setting that's interesting here and that is the ability to remove MFA requirement for local",
    "start": "780800",
    "end": "788569"
  },
  {
    "text": "accounts and so this way you can do whatever you want as a local account but everyone that connects in with an ad",
    "start": "788569",
    "end": "794629"
  },
  {
    "text": "account will be required to MFA so",
    "start": "794629",
    "end": "801199"
  },
  {
    "start": "800000",
    "end": "800000"
  },
  {
    "text": "there's some recommendations around MFA first of all don't rely on it to protect your admin accounts don't don't let it",
    "start": "801199",
    "end": "806600"
  },
  {
    "text": "be the only thing that is protecting your admin accounts use hardware tokens or the app disable SMS if possible",
    "start": "806600",
    "end": "812769"
  },
  {
    "text": "research failed closed for critical servers remember that once an attacker has 80 admin credentials it's game over",
    "start": "812769",
    "end": "819230"
  },
  {
    "text": "they don't necessarily need to go through the MFA system and definitely walk through the potential bypass",
    "start": "819230",
    "end": "825379"
  },
  {
    "text": "methods and implement mitigations and detections because it's entirely possible that someone could social engineer their way",
    "start": "825379",
    "end": "831079"
  },
  {
    "text": "into switching a phone number some other method through the help desk or some other way or a different MFA app on",
    "start": "831079",
    "end": "838610"
  },
  {
    "text": "their - on their device people lose phones all the time people have to get a new phone configured sometimes they end",
    "start": "838610",
    "end": "845120"
  },
  {
    "text": "up changing numbers so does em if they have value absolutely please please MFA",
    "start": "845120",
    "end": "851360"
  },
  {
    "text": "all the things just understand that it's not a silver bullet and that there are things that that can be used to bypass",
    "start": "851360",
    "end": "856970"
  },
  {
    "text": "it depending on the specific configuration password boss so I see",
    "start": "856970",
    "end": "863930"
  },
  {
    "text": "password vault being deployed more and more as Enterprise password vaults and as a way to provide more secure",
    "start": "863930",
    "end": "871189"
  },
  {
    "start": "868000",
    "end": "868000"
  },
  {
    "text": "administration typically like I said cyber-ark a psychotic secret server and they often have what they call a",
    "start": "871189",
    "end": "876620"
  },
  {
    "text": "reconciliation account which is very often a domain admin that has the",
    "start": "876620",
    "end": "882889"
  },
  {
    "text": "ability to bring these accounts back into control so if you have an account that's stored in that password vault",
    "start": "882889",
    "end": "887930"
  },
  {
    "text": "managed by that password vault what ends up happening is that reconciliation account will check to see if the password is what it has for that account",
    "start": "887930",
    "end": "895069"
  },
  {
    "text": "in its vault and if it's different it will reach out and automatically change that account password this means that",
    "start": "895069",
    "end": "901819"
  },
  {
    "text": "very often the password vault itself has a very highly privileged account in Active Directory and it maintains ad",
    "start": "901819",
    "end": "909439"
  },
  {
    "text": "admin accounts in addition to that a lot of the time and there might also be",
    "start": "909439",
    "end": "914929"
  },
  {
    "text": "additional components like assessing session manager which I'll talk about in a minute but here one of the options for an enterprise",
    "start": "914929",
    "end": "920779"
  },
  {
    "text": "password vault that we see pretty commonly check out the credential so we have our workstation on the left or",
    "start": "920779",
    "end": "926300"
  },
  {
    "text": "password vault in the middle and our admin server on the right that's that star and so what we do is we connect to",
    "start": "926300",
    "end": "932660"
  },
  {
    "text": "the password vault and we via HTTP it's just a website and then we check out that credential copy that password in",
    "start": "932660",
    "end": "941050"
  },
  {
    "text": "our clipboard on our local workstation and then we paste it into our RDP login",
    "start": "941050",
    "end": "946579"
  },
  {
    "text": "window and connect to our admin server it's fairly common it happens a lot so",
    "start": "946579",
    "end": "953410"
  },
  {
    "text": "what can be done about this what can I do as an attacker yeah and this is a regular workstation so one of the things",
    "start": "953410",
    "end": "961040"
  },
  {
    "start": "960000",
    "end": "960000"
  },
  {
    "text": "I can do is I can set up my sec and health check but this side up time I'm going to use something another function",
    "start": "961040",
    "end": "966980"
  },
  {
    "text": "from powersploit called get x screenshot or actually meta myself get clipboard",
    "start": "966980",
    "end": "977420"
  },
  {
    "text": "contents so I'm going to copy out of the clipboard the contents that are there and there's gonna be another text file",
    "start": "977420",
    "end": "983480"
  },
  {
    "text": "that shows up on the computer and as you can see here every time I copy something into the clipboard that PowerShell",
    "start": "983480",
    "end": "988939"
  },
  {
    "text": "function is just copying it from the clipboard directly to a text file constantly and over and over again and",
    "start": "988939",
    "end": "994610"
  },
  {
    "text": "through this method the attacker ends up getting that password that's in the password vault now obviously the password well it's not",
    "start": "994610",
    "end": "1000879"
  },
  {
    "text": "going to be creating passwords like this but this is blackhat it would be fun and",
    "start": "1000879",
    "end": "1006870"
  },
  {
    "text": "then I could take that I can look at it I can leverage that account password but how do I know what the account name is",
    "start": "1006870",
    "end": "1013509"
  },
  {
    "text": "well that's where that get time screenshot function comes in that I was mentioning a little earlier because then",
    "start": "1013509",
    "end": "1019990"
  },
  {
    "text": "what I can do is have screenshots of what shows up and then correlate that",
    "start": "1019990",
    "end": "1025839"
  },
  {
    "text": "with what's in the clipboard and I can use a WMI implant to this so there's malware out there right now",
    "start": "1025839",
    "end": "1032199"
  },
  {
    "text": "that is monitoring the webpage that people go to by via the title it looks for financial website names it looks for",
    "start": "1032199",
    "end": "1039938"
  },
  {
    "text": "certain types of title keywords you do",
    "start": "1039939",
    "end": "1045188"
  },
  {
    "text": "something very similar I can look for cyber-ark or psychotic or something like that and when that happens through my",
    "start": "1045189",
    "end": "1050289"
  },
  {
    "text": "WMI implant I can kick off these power so components or something that I custom write with in c-sharp to do the same",
    "start": "1050289",
    "end": "1057150"
  },
  {
    "text": "thing and capture this data so we want to be very careful what systems we're connecting to a password vault from ok",
    "start": "1057150",
    "end": "1064410"
  },
  {
    "text": "well there's a different way to do this all right the RDP proxy approach which is where we have the password vault",
    "start": "1064410",
    "end": "1069990"
  },
  {
    "text": "sitting in the middle we have our workstation we're connecting to the password wall via HTTPS we then connect",
    "start": "1069990",
    "end": "1076890"
  },
  {
    "text": "from the password vault to the admin server via RDP and the password involved is providing that proxy that RDP proxy",
    "start": "1076890",
    "end": "1083790"
  },
  {
    "text": "and the password vault has the credentials the admin themselves don't have the credentials don't know what the",
    "start": "1083790",
    "end": "1089400"
  },
  {
    "text": "credentials are password vault is doing that entirely so it's a complete password and a lot of the password",
    "start": "1089400",
    "end": "1094560"
  },
  {
    "text": "Volt's now have the ability to do session recording as well although I've never actually heard of someone having a",
    "start": "1094560",
    "end": "1101160"
  },
  {
    "text": "good plan for like going back and watching sessions or randomly looking at them but it's there but a couple",
    "start": "1101160",
    "end": "1107640"
  },
  {
    "text": "questions with this approach first of all what account is used to log on to that workstation it's very often a user",
    "start": "1107640",
    "end": "1114000"
  },
  {
    "text": "and then what account is used to log on to this password vault that then has access to this highly privileged admin",
    "start": "1114000",
    "end": "1120210"
  },
  {
    "text": "account it's often also a user and as mfa used to protect that authentication",
    "start": "1120210",
    "end": "1126620"
  },
  {
    "text": "and what about the administration who's administering the server this password vault server that contains all of these",
    "start": "1126620",
    "end": "1133080"
  },
  {
    "text": "very critical credentials and what about the network communications are we limiting access to this password vault",
    "start": "1133080",
    "end": "1139970"
  },
  {
    "text": "most of the time there's no limitations on the network to connect to the password vault and a lot of the times",
    "start": "1139970",
    "end": "1147200"
  },
  {
    "start": "1146000",
    "end": "1146000"
  },
  {
    "text": "people are just accessing the password vault using their standard web browser which has all of the other things that",
    "start": "1147200",
    "end": "1154710"
  },
  {
    "text": "are usually in a web browser so what are the extensions what are the settings how is that web browser configured what if I",
    "start": "1154710",
    "end": "1161490"
  },
  {
    "text": "compromised the web browser how could might be an interesting way that I compromised the pastor vault connection from that because it's all web at that",
    "start": "1161490",
    "end": "1168330"
  },
  {
    "text": "point one thing to think about is should we be using a separate browser when we're connecting to a password vault",
    "start": "1168330",
    "end": "1174540"
  },
  {
    "text": "well maybe the other thing I see too often is a situation where there's a",
    "start": "1174540",
    "end": "1181190"
  },
  {
    "text": "password vault admins group in Active Directory and when I enumerate the membership",
    "start": "1181190",
    "end": "1186260"
  },
  {
    "text": "that every member or most members are regular users anyone see a problem with",
    "start": "1186260",
    "end": "1192050"
  },
  {
    "text": "this I certainly do these are the admins for the vault the",
    "start": "1192050",
    "end": "1198020"
  },
  {
    "text": "other problem I've discovered is thanks to my friend show Dan they were able to tell me that there's cyber-ark password",
    "start": "1198020",
    "end": "1204770"
  },
  {
    "start": "1201000",
    "end": "1201000"
  },
  {
    "text": "vaults on the internet which could be okay probably not it all depends on what sort",
    "start": "1204770",
    "end": "1212510"
  },
  {
    "text": "of data and credentials are there being stored in them and I happen to find one that's a little bit older which is very",
    "start": "1212510",
    "end": "1219410"
  },
  {
    "text": "concerning we'll talk about in a bit so when we talk about the password vault we",
    "start": "1219410",
    "end": "1225230"
  },
  {
    "start": "1223000",
    "end": "1223000"
  },
  {
    "text": "need to look at the potential weaknesses in the way that it's configured so authentication to the web servers typically a user account MFA or not",
    "start": "1225230",
    "end": "1232850"
  },
  {
    "text": "maybe these are often administered like any other server so server admins has",
    "start": "1232850",
    "end": "1238130"
  },
  {
    "text": "full admin rights on them and the sessions that are created by the admins to connect to the password vault are not",
    "start": "1238130",
    "end": "1245030"
  },
  {
    "text": "always limited to one they should be limited and a vulnerability and the",
    "start": "1245030",
    "end": "1251630"
  },
  {
    "text": "password vault can compromise the directory entirely so just a few months",
    "start": "1251630",
    "end": "1256970"
  },
  {
    "text": "ago in April with the CVD at the top 20 18 9 8 4 3 there was a serialized dotnet",
    "start": "1256970",
    "end": "1264410"
  },
  {
    "text": "object vulnerability and the way that cyber-ark was handling the API on the",
    "start": "1264410",
    "end": "1269630"
  },
  {
    "text": "password web server so just for those who have cyber-ark if you haven't patched it since April I highly",
    "start": "1269630",
    "end": "1274940"
  },
  {
    "text": "recommend you like message someone and do that today because what this did was it enabled the ability to run arbitrary",
    "start": "1274940",
    "end": "1282680"
  },
  {
    "text": "code on that vault and the proof of concept is simply just running ping but",
    "start": "1282680",
    "end": "1289670"
  },
  {
    "text": "you can see that there's a very interesting escalation process that could be done here because the password vault web server is the one that proxies",
    "start": "1289670",
    "end": "1297500"
  },
  {
    "text": "our brokers that request from the user and identifies which password vaults they have access to which credentials",
    "start": "1297500",
    "end": "1304160"
  },
  {
    "text": "that user has access to we can modify that if we can change that we can do a",
    "start": "1304160",
    "end": "1309230"
  },
  {
    "text": "lot of really interesting things what about the admin force so there's",
    "start": "1309230",
    "end": "1318690"
  },
  {
    "text": "been a lot of talk in recent years about the red forest or the admin forest or the ESA e et cetera et cetera et cetera",
    "start": "1318690",
    "end": "1324540"
  },
  {
    "text": "so the whole concept is that we're going to take our production eighty forest we're going to take all of our 80 admins",
    "start": "1324540",
    "end": "1331380"
  },
  {
    "text": "and we're going to move them into this other 80 forest we're going to completely lock down this other 80",
    "start": "1331380",
    "end": "1336780"
  },
  {
    "text": "forest we're going to make sure that only our 80 admins are over in this forest and they're well protected we're",
    "start": "1336780",
    "end": "1343140"
  },
  {
    "text": "going to have network configuration where nothing else can connect to it",
    "start": "1343140",
    "end": "1348210"
  },
  {
    "text": "except the authorized systems we're going to ensure that it's encrypted the network communication is encrypted were",
    "start": "1348210",
    "end": "1353370"
  },
  {
    "text": "gonna have a one-way trust so that way production ad environment trusts this admin forest we're gonna have a group in",
    "start": "1353370",
    "end": "1362220"
  },
  {
    "text": "this admin forest that is a member of the administrators group and active directory and the production ad and only",
    "start": "1362220",
    "end": "1368310"
  },
  {
    "text": "these admin forced accounts are members of that of that group and we're going to",
    "start": "1368310",
    "end": "1374760"
  },
  {
    "text": "make sure that that those accounts in that group that are in this admin force don't have any admin rights of the admin",
    "start": "1374760",
    "end": "1380070"
  },
  {
    "text": "force and aren't even in that group all the time so the only way to administer this ad environment according to this is",
    "start": "1380070",
    "end": "1386700"
  },
  {
    "text": "through this admin forest account which oftentimes is using PGI and separate",
    "start": "1386700",
    "end": "1391890"
  },
  {
    "text": "management completely separate it so I have a slide here which talks about what",
    "start": "1391890",
    "end": "1397380"
  },
  {
    "text": "I just said you can look at the slides later but beyond 80 security out org after the talk but there's some pros and",
    "start": "1397380",
    "end": "1405690"
  },
  {
    "start": "1404000",
    "end": "1404000"
  },
  {
    "text": "cons with admin force the pros are that we are effectively isolating our ad",
    "start": "1405690",
    "end": "1411030"
  },
  {
    "text": "admin credentials into a separate force where they're very difficult to get to and when deployed properly it can be",
    "start": "1411030",
    "end": "1417870"
  },
  {
    "text": "effective in limiting access to these ad privileged accounts sounds really good",
    "start": "1417870",
    "end": "1423060"
  },
  {
    "text": "where do I sign up well there's some challenges with this first one is it's",
    "start": "1423060",
    "end": "1428820"
  },
  {
    "text": "expensive to deploy an admin force is effectively increasing your management overhead and cost because you are",
    "start": "1428820",
    "end": "1435330"
  },
  {
    "text": "duplicating your infrastructure you're setting up new DCs technically they're all supposed to be physical by the way",
    "start": "1435330",
    "end": "1441140"
  },
  {
    "text": "they're supposed to be managed by a separate system any security tooling and management are supposed to be duplicated in that",
    "start": "1441140",
    "end": "1447450"
  },
  {
    "text": "environment and anyone that logs into that admin force environment is supposed to use a PKI card which has a separate",
    "start": "1447450",
    "end": "1454679"
  },
  {
    "text": "PGI from your standard PCI configuration but ultimately it doesn't fix your production 80 issues if you have",
    "start": "1454679",
    "end": "1461039"
  },
  {
    "text": "security issues misconfigurations if you delegation that you set ten years ago",
    "start": "1461039",
    "end": "1466200"
  },
  {
    "text": "and everyone's forgotten about it and so there's like four accounts in your environment that have like the two steps",
    "start": "1466200",
    "end": "1472080"
  },
  {
    "text": "from da but no one knows about it this isn't going to solve that in most",
    "start": "1472080",
    "end": "1477720"
  },
  {
    "text": "organizations we also have workstation admins and server admins guess what attackers don't need domain admin rights",
    "start": "1477720",
    "end": "1484799"
  },
  {
    "text": "they don't need act directory admin rights all they want is access to data access to system so if they can",
    "start": "1484799",
    "end": "1490710"
  },
  {
    "text": "compromise a workstation admin or a server admin or both they can get that",
    "start": "1490710",
    "end": "1497539"
  },
  {
    "text": "the other thing is what about your production ad privileged serves counts",
    "start": "1499820",
    "end": "1504980"
  },
  {
    "text": "so technically as part of this whole admin force we're supposed to take those privileged service accounts and remove",
    "start": "1504980",
    "end": "1511200"
  },
  {
    "text": "them just take them out of domain admins take them out of administrators just make them regular users delegate the",
    "start": "1511200",
    "end": "1517289"
  },
  {
    "text": "rights out most of the customers I talked to can't just do that and so",
    "start": "1517289",
    "end": "1522299"
  },
  {
    "text": "these service accounts that are highly privileged ended up sticking around and so it's part of the admin force",
    "start": "1522299",
    "end": "1528809"
  },
  {
    "start": "1527000",
    "end": "1527000"
  },
  {
    "text": "implementation you're supposed to assume breach that's our mantra assume breach right we need to check the environment",
    "start": "1528809",
    "end": "1535769"
  },
  {
    "text": "to ensure it's configured correctly there aren't any of these obvious miss configurations but what if it's",
    "start": "1535769",
    "end": "1541679"
  },
  {
    "text": "compromised what is this admin force actually going to by us especially when we have to assume that there's an active attacker",
    "start": "1541679",
    "end": "1547230"
  },
  {
    "text": "on the network well not much because all we're doing is shifting the admin",
    "start": "1547230",
    "end": "1552269"
  },
  {
    "text": "accounts that are known in to our admin forest and any of the sneaky persistent",
    "start": "1552269",
    "end": "1557639"
  },
  {
    "text": "methods that happen to be in the environment maybe someone is pretending to be a domain controller in the",
    "start": "1557639",
    "end": "1563220"
  },
  {
    "text": "environment that Vincent and and Benjamin are going to talk about tomorrow in the DC shadow talk",
    "start": "1563220",
    "end": "1568279"
  },
  {
    "text": "that's not admin force isn't going to help us from that so what should be done first these are questions and concerns",
    "start": "1568279",
    "end": "1574350"
  },
  {
    "text": "when you're going to spend a lot of money on an admin force because ultimately it's been billed a lot of the times as the solution",
    "start": "1574350",
    "end": "1580010"
  },
  {
    "text": "- your act directory security problems and attackers can figure out if you have an admin force it's pretty easy we just",
    "start": "1580010",
    "end": "1585320"
  },
  {
    "start": "1583000",
    "end": "1583000"
  },
  {
    "text": "look at the trust membership and we might see something that looks like this and we're definitely going to see another forest group that's in our",
    "start": "1585320",
    "end": "1592910"
  },
  {
    "text": "admins group for our Active Directory forest so it's gonna be pretty obvious",
    "start": "1592910",
    "end": "1599360"
  },
  {
    "text": "when we have that how effective is the admin forest",
    "start": "1599360",
    "end": "1604690"
  },
  {
    "text": "well the deployment often ignores the production ad environment issues organization is usually very quick to",
    "start": "1604690",
    "end": "1611330"
  },
  {
    "text": "deploy an admin force and get it stood up and get these ad admins moved over and these other things don't get fixed",
    "start": "1611330",
    "end": "1617390"
  },
  {
    "text": "they stick around and of course their service accounts that are still there there's agents on our domain controllers",
    "start": "1617390",
    "end": "1624050"
  },
  {
    "text": "that still have privileged access and who has administrative rights of those who has control of those agents they're",
    "start": "1624050",
    "end": "1629720"
  },
  {
    "text": "not in the admin forest and backup is still a big issue so I worked with a red",
    "start": "1629720",
    "end": "1635000"
  },
  {
    "text": "team to help them compromise an environment and AD force that had an admin forest we didn't touch any of the",
    "start": "1635000",
    "end": "1641570"
  },
  {
    "text": "ad admin accounts we didn't have to so there's definitely some benefits for the",
    "start": "1641570",
    "end": "1648260"
  },
  {
    "text": "large organizations that have multiple active directory forest because if you have several ad forests then you've got",
    "start": "1648260",
    "end": "1654650"
  },
  {
    "text": "to have a way to configure and manage all of them so an enforce might make sense in that scenario but there's",
    "start": "1654650",
    "end": "1660050"
  },
  {
    "text": "another issue that I've seen in a lot of organizations and that is the whole concept of cross force administration we",
    "start": "1660050",
    "end": "1665390"
  },
  {
    "start": "1663000",
    "end": "1663000"
  },
  {
    "text": "have our forced a because I'm very creative at naming things we have a force B because I'm incredibly creative",
    "start": "1665390",
    "end": "1671210"
  },
  {
    "text": "at naming things so for stay is our production force B is our DMZ environment our dev tests are",
    "start": "1671210",
    "end": "1678560"
  },
  {
    "text": "external it doesn't really matter it's another force that's not as highly trusted as our production are at force tape",
    "start": "1678560",
    "end": "1685150"
  },
  {
    "text": "environment we're gonna have a one-way trust so in Microsoft parlance and arrow pointing from B to a means that a is",
    "start": "1685150",
    "end": "1692180"
  },
  {
    "text": "going to a resource or a accounts yeah I got confused hey accounts can access B resources so",
    "start": "1692180",
    "end": "1701240"
  },
  {
    "text": "that means our happy domain admin and forest a can also be an admin and forest",
    "start": "1701240",
    "end": "1707390"
  },
  {
    "text": "B and so this happens a lot where we have a domain admin forced a that",
    "start": "1707390",
    "end": "1713530"
  },
  {
    "text": "manages and administers force B and so they connect into RDP and go ahead and",
    "start": "1713530",
    "end": "1718780"
  },
  {
    "text": "do what they need to do here's the problem force B is not as trusted is forced a",
    "start": "1718780",
    "end": "1725160"
  },
  {
    "text": "it's in the DMZ step test it might have a hundred domain admins that are all the",
    "start": "1725160",
    "end": "1731110"
  },
  {
    "text": "developers it could be an application force that has some internet connectivity is not in the DMZ",
    "start": "1731110",
    "end": "1736740"
  },
  {
    "text": "so what do you think happens when that force gets compromised well then our happy admin gets compromised and",
    "start": "1736740",
    "end": "1742810"
  },
  {
    "text": "ultimately force a gets compromised",
    "start": "1742810",
    "end": "1750700"
  },
  {
    "text": "right a little bit of cliffhanger there so simply from this trust and the fact",
    "start": "1750700",
    "end": "1758410"
  },
  {
    "text": "that we're using a forest a or production domain admin to administer this other forest with which makes sense",
    "start": "1758410",
    "end": "1764290"
  },
  {
    "text": "logically and a lot of Microsoft documentation points this as the way to do it is problematic because when we",
    "start": "1764290",
    "end": "1772090"
  },
  {
    "text": "connect using RDP from force data for SB we often are leaving credentials behind fact by default we are so I have a slide",
    "start": "1772090",
    "end": "1781510"
  },
  {
    "text": "here that has kind of a summary of what I talked about but at the bottom is the mitigation so we want to make sure that",
    "start": "1781510",
    "end": "1786520"
  },
  {
    "text": "we manage this other forest this forest be with a forest be admin account not a forest a account or you if you really",
    "start": "1786520",
    "end": "1794530"
  },
  {
    "text": "are set on using a forest a account or a production account make sure you just create a user account or user accounts",
    "start": "1794530",
    "end": "1799990"
  },
  {
    "text": "that have no privileges enforce day that then are the admins for this other forest and then protect them at a good",
    "start": "1799990",
    "end": "1806170"
  },
  {
    "text": "level all right so I've talked a lot about the problems and the issues let's",
    "start": "1806170",
    "end": "1813220"
  },
  {
    "text": "talk about building the best defenses by the way this is one of my favorite castles in the world this is mount san",
    "start": "1813220",
    "end": "1819310"
  },
  {
    "text": "michele and which i'm pronouncing horribly wrong I'm sure in France and so for a Lord of the Rings fans this is",
    "start": "1819310",
    "end": "1825130"
  },
  {
    "text": "actually excuse me the the castle that was the inspiration of the castle and",
    "start": "1825130",
    "end": "1832180"
  },
  {
    "text": "Lord of the Rings 80 defensive pillars we're going to talk about what we need to do in order to",
    "start": "1832180",
    "end": "1838090"
  },
  {
    "start": "1834000",
    "end": "1834000"
  },
  {
    "text": "secure Active Directory so we need to protect our credentials our ad admin",
    "start": "1838090",
    "end": "1844780"
  },
  {
    "text": "we need to isolate them and protect them at the highest level we need to harden our admin methods we want to make sure",
    "start": "1844780",
    "end": "1850720"
  },
  {
    "text": "that we're not using administrative methods that could be compromised we need to reduce and limit our service account rights and as part of this pull",
    "start": "1850720",
    "end": "1857710"
  },
  {
    "text": "out any accounts that don't need to be in domain admins or administrators and then there's also effective monitoring",
    "start": "1857710",
    "end": "1864160"
  },
  {
    "text": "we need to make sure that our domain controllers are properly monitoring the correct events so that way when something does happen we can see those",
    "start": "1864160",
    "end": "1870810"
  },
  {
    "text": "unfortunately that's out of scope for this talk I don't have enough time but I have bonus content at the end of the",
    "start": "1870810",
    "end": "1875980"
  },
  {
    "text": "slides you can look at later so the key",
    "start": "1875980",
    "end": "1881410"
  },
  {
    "start": "1879000",
    "end": "1879000"
  },
  {
    "text": "to this is focusing on protection these at protecting these admin credentials especially our ad 80 admin credentials",
    "start": "1881410",
    "end": "1886990"
  },
  {
    "text": "we need to have a separate ad admin account from our user accounts most organizations are doing this now although the ones that have transitioned",
    "start": "1886990",
    "end": "1893350"
  },
  {
    "text": "recently often forget about some of those user accounts we'll leave them in AD admin groups making sure that these",
    "start": "1893350",
    "end": "1899710"
  },
  {
    "text": "ad admin accounts are different from other admin accounts they're not administering Exchange or SharePoint or",
    "start": "1899710",
    "end": "1904840"
  },
  {
    "text": "sequel and use distinct naming I like ad a 480 admins sa 4 server admins and WAFF",
    "start": "1904840",
    "end": "1911980"
  },
  {
    "text": "workstation atoms that use whatever works for you I went into a customer site and they had all these different",
    "start": "1911980",
    "end": "1917860"
  },
  {
    "text": "accounts actually it's been a few customers like this all these different accounts different names different setups had no idea what kind of naming",
    "start": "1917860",
    "end": "1924640"
  },
  {
    "text": "standard there was and so I went in and talked to them about this after I'd gone through and done some assessing of their",
    "start": "1924640",
    "end": "1930790"
  },
  {
    "text": "environment I said what's the deal with all these accounts I can't tell like this first initial middle initial last",
    "start": "1930790",
    "end": "1936100"
  },
  {
    "text": "name first initial middle initial last initial and then like Superman a couple",
    "start": "1936100",
    "end": "1941200"
  },
  {
    "text": "other things I don't know what this is like I don't like who our who's supposed to be your ad admins you know huh you",
    "start": "1941200",
    "end": "1946660"
  },
  {
    "text": "don't know yeah you don't know either",
    "start": "1946660",
    "end": "1952749"
  },
  {
    "text": "and they said yes but the attacker won't know which of these is the human account",
    "start": "1952749",
    "end": "1958959"
  },
  {
    "text": "I said yeah that's great but I have this",
    "start": "1958959",
    "end": "1964219"
  },
  {
    "text": "report here that has a list of all of the admins that I've enumerated in your environment from all of the standard",
    "start": "1964219",
    "end": "1970009"
  },
  {
    "text": "groups and the permissions in your environment so I know who the admins are the attackers know who the admins are",
    "start": "1970009",
    "end": "1975830"
  },
  {
    "text": "the problem is that we cannot programmatically identify monitor and maintain a configuration without a",
    "start": "1975830",
    "end": "1981409"
  },
  {
    "text": "standard naming convention for administration I see that there's five accounts and domain admins how do I know",
    "start": "1981409",
    "end": "1988429"
  },
  {
    "text": "that all of those belong who would I have to talk to I'm going to talk to like six other people to figure out which of these five accounts should be",
    "start": "1988429",
    "end": "1994700"
  },
  {
    "text": "there right but if I can programmatically configure the environment to monitor an alert on",
    "start": "1994700",
    "end": "2000940"
  },
  {
    "text": "changes when it doesn't see an ad a and domain admins or something like that I've elevated my environment to the next",
    "start": "2000940",
    "end": "2006879"
  },
  {
    "text": "level it could proactively manage maintain this and of course we need to make sure there are 80 admin accounts are only",
    "start": "2006879",
    "end": "2012369"
  },
  {
    "text": "logging into 80 admin workstations and 80 admin servers and domain controllers",
    "start": "2012369",
    "end": "2019320"
  },
  {
    "text": "but the biggest question is why admin workstations hopefully some of these slides have helped you and will give you",
    "start": "2019320",
    "end": "2024759"
  },
  {
    "text": "some some evidence and some ammunition you need to influence others to get",
    "start": "2024759",
    "end": "2030009"
  },
  {
    "text": "admin workstations deployed because the issue is the battle is shifted from the parameter on to these workstations which",
    "start": "2030009",
    "end": "2035829"
  },
  {
    "text": "we know but we're still running administration from them and the management these regular workstations is",
    "start": "2035829",
    "end": "2041709"
  },
  {
    "text": "an escalation path there's lots of talks about exploiting SCCM to then own the",
    "start": "2041709",
    "end": "2047259"
  },
  {
    "text": "environment or deploy malware right Altiris SCCM there's a bunch of",
    "start": "2047259",
    "end": "2053289"
  },
  {
    "text": "different systems that are used to do this and then the credentials that are found on these systems are used to escalate and move around the environment",
    "start": "2053289",
    "end": "2061809"
  },
  {
    "text": "and they can be in alsace they could be typed into a RDP window or into a web",
    "start": "2061809",
    "end": "2068799"
  },
  {
    "text": "form but this builds on the whole concept of having a separate account",
    "start": "2068799",
    "end": "2074408"
  },
  {
    "text": "separate admin account from your user account which we've been talking about for years right everyone knows we've been since the beginning we've been",
    "start": "2074409",
    "end": "2079839"
  },
  {
    "text": "hearing this we also have to remember that any agent",
    "start": "2079839",
    "end": "2087158"
  },
  {
    "text": "that can install or run code is a potential compromise method of that system so we need to expand out our",
    "start": "2087159",
    "end": "2093550"
  },
  {
    "text": "vision from just who has local admin rights to what are the agents that are running on these systems and who has",
    "start": "2093550",
    "end": "2098950"
  },
  {
    "text": "ability to influence them so when we're talking about our 8e administration",
    "start": "2098950",
    "end": "2105400"
  },
  {
    "text": "systems we need to isolate and protect these privileged credentials we need to provide secure environment for the",
    "start": "2105400",
    "end": "2111250"
  },
  {
    "text": "admins to do what they need to do ultimately we need to disrupt the common attack playbook this means that we want",
    "start": "2111250",
    "end": "2119950"
  },
  {
    "text": "the attacker to have to go from chapter 1 page 1 a chapter 10 chapter 20 and by",
    "start": "2119950",
    "end": "2125380"
  },
  {
    "text": "making it more difficult for the attackers we have better insight and visibility because we want them to hit",
    "start": "2125380",
    "end": "2130450"
  },
  {
    "text": "those tripwires we absolutely want the attackers to hit something we want to set up a pathway that they go down",
    "start": "2130450",
    "end": "2136420"
  },
  {
    "text": "jessyca pain calls this building the attackers playground as a defender we",
    "start": "2136420",
    "end": "2141460"
  },
  {
    "text": "have the ability to configure the environment to be our home court advantage we set up the trip wires we",
    "start": "2141460",
    "end": "2149980"
  },
  {
    "text": "form and identify which way we want them to go and we look at that and we go all",
    "start": "2149980",
    "end": "2155860"
  },
  {
    "text": "right here's how we do administration so what are the trip wires we need to implement what are the events we need to be looking at in this pathway how do we",
    "start": "2155860",
    "end": "2162460"
  },
  {
    "text": "ensure and know that only valid and authorized people and personnel are using those pathways so we need to",
    "start": "2162460",
    "end": "2169930"
  },
  {
    "text": "ensure the consistent is configured correctly we need to make sure only these specific admins can log on separate administration of the system of",
    "start": "2169930",
    "end": "2176950"
  },
  {
    "text": "this admin system separate management patching auto patching in many Senate situations make sure it's firewalled off",
    "start": "2176950",
    "end": "2182800"
  },
  {
    "text": "the standard network we want to restrict access to the management protocols like",
    "start": "2182800",
    "end": "2188560"
  },
  {
    "text": "RDP WMI etc and enforce NLA so that way someone has to off before they connect",
    "start": "2188560",
    "end": "2193930"
  },
  {
    "text": "to that RTP server there's a great hack or modification that I call a movie",
    "start": "2193930",
    "end": "2200500"
  },
  {
    "text": "movie hacking on Windows is just simply replacing one file with cmd.exe so that",
    "start": "2200500",
    "end": "2207040"
  },
  {
    "text": "way when you hit a key over and over again on that logon screen it pops up a command box running a system on that",
    "start": "2207040",
    "end": "2212890"
  },
  {
    "text": "right I'm sure everyone's seen this call a movie hacking because you just hit shift 5 times in the spatula now you can do whatever you want",
    "start": "2212890",
    "end": "2219770"
  },
  {
    "text": "with that system with nla you block the attackers ability to have implant at that and then to reuse it if they got on",
    "start": "2219770",
    "end": "2226280"
  },
  {
    "text": "that system previously so this is probably one of my favorite slides in the whole deck raise your hand if you've",
    "start": "2226280",
    "end": "2233240"
  },
  {
    "text": "seen this before keep your hand up if you have been able to implement this fully okay I think I saw one person to",
    "start": "2233240",
    "end": "2244070"
  },
  {
    "text": "two people kudos so you see me after I have something for you for everyone else this",
    "start": "2244070",
    "end": "2250010"
  },
  {
    "text": "is what I want you to focus on because with the Microsoft tiered model tier 0",
    "start": "2250010",
    "end": "2255560"
  },
  {
    "text": "means domain admins domain controllers and all of the supporting systems are in that tier and can't get into another",
    "start": "2255560",
    "end": "2260870"
  },
  {
    "text": "tier and tier one is going to be your server admins your servers the",
    "start": "2260870",
    "end": "2266810"
  },
  {
    "text": "management system for servers tier two is going to be your workstations workstation admins workstation admin",
    "start": "2266810",
    "end": "2272270"
  },
  {
    "text": "system and the management system this means that you have to have if you have a CCM you've got a deploy an SCCM",
    "start": "2272270",
    "end": "2278690"
  },
  {
    "text": "instance in tier 2 1 and tier 1 and 1 and tier 0 and you have to have admin accounts in each one separately and none",
    "start": "2278690",
    "end": "2284960"
  },
  {
    "text": "of them can talk to each other so now that many of you have your eyes glazed",
    "start": "2284960",
    "end": "2291080"
  },
  {
    "text": "over and are thinking there's no way that I can do that this is where I want to come back to let's focus on tier 0",
    "start": "2291080",
    "end": "2296780"
  },
  {
    "text": "let's focus on protecting the most important assets in our Active Directory environment our 80 admins or domain",
    "start": "2296780",
    "end": "2302720"
  },
  {
    "text": "controllers because the issue is with the Microsoft tiered model is it's difficult to implement it's costly to",
    "start": "2302720",
    "end": "2309770"
  },
  {
    "text": "implement it requires duplicate infrastructure and admin accounts to do it correctly it's very hard to do it",
    "start": "2309770",
    "end": "2315050"
  },
  {
    "text": "correctly there's like three people in this room of let's call it 1500 that",
    "start": "2315050",
    "end": "2320060"
  },
  {
    "text": "have had it implemented it's rarely fully implemented there's lots of organizations that have gotten it close",
    "start": "2320060",
    "end": "2326180"
  },
  {
    "text": "so I want everyone to focus on tier 0 making sure that those are protected so",
    "start": "2326180",
    "end": "2332630"
  },
  {
    "text": "what is tier 0 domain admins privilege 80 admin accounts and systems or 80 admins or serfs council privilege 80",
    "start": "2332630",
    "end": "2339050"
  },
  {
    "text": "rights are 80 admin workstations and servers are ad FS in Federation servers",
    "start": "2339050",
    "end": "2346630"
  },
  {
    "text": "if an attacker is able to get admin rights to an a best server they can extract the",
    "start": "2346630",
    "end": "2352330"
  },
  {
    "text": "certificate that's used to sign the tokens and forge their own Federation tokens for two years or more depending",
    "start": "2352330",
    "end": "2359470"
  },
  {
    "text": "on how long that certificates good for anywhere on the network so you definitely want to protect your a DFS",
    "start": "2359470",
    "end": "2364690"
  },
  {
    "text": "servers Azure ad Connect servers a lot of organizations have gone off 365 and Azure ad and are using Azure ad connect",
    "start": "2364690",
    "end": "2371410"
  },
  {
    "text": "to synchronize their user accounts on their 8 on Prem ad into Azure ad so they",
    "start": "2371410",
    "end": "2376990"
  },
  {
    "text": "can use office 365 and a lot of times they're synchronizing that password hash data in Azure ad so the users can",
    "start": "2376990",
    "end": "2382870"
  },
  {
    "text": "directly log on Azure ad so you want to be aware that if you have as you 8080",
    "start": "2382870",
    "end": "2389590"
  },
  {
    "text": "connects servers configured they really should be in this tier especially if they're synchronized map password hash",
    "start": "2389590",
    "end": "2394870"
  },
  {
    "text": "data because about every 2 minutes as your ad Connect is going to ask the domain controllers in each of the domains that contain users that are",
    "start": "2394870",
    "end": "2401470"
  },
  {
    "text": "synchronized say send me the password hashes for these users this means that as rated you can ad Connect is like a",
    "start": "2401470",
    "end": "2407590"
  },
  {
    "text": "junior DC because those credentials are passing through in memory on that system",
    "start": "2407590",
    "end": "2412720"
  },
  {
    "text": "on a regular basis and then of course PKI password vault and the tier 0 our management system should be in tier 0 as",
    "start": "2412720",
    "end": "2419680"
  },
  {
    "text": "well so we want to convince our admins",
    "start": "2419680",
    "end": "2425020"
  },
  {
    "start": "2420000",
    "end": "2420000"
  },
  {
    "text": "this is the tough part admins are two that are typically mobile use a laptop will require a second laptop that's",
    "start": "2425020",
    "end": "2430600"
  },
  {
    "text": "tough it's a tough sell they're less than excited when they're told they have to use a separate system for",
    "start": "2430600",
    "end": "2436120"
  },
  {
    "text": "administration ego 80 admin here's your regular workstation here's your new admin system you can't use both you",
    "start": "2436120",
    "end": "2442990"
  },
  {
    "text": "can't use this to do that and the other way around and then the biggest challenge with this is the people that",
    "start": "2442990",
    "end": "2448450"
  },
  {
    "text": "are most impacted are 80 admins are often the ones that have to make this change they have to implement it so guess what happens I'm gonna do what",
    "start": "2448450",
    "end": "2455790"
  },
  {
    "text": "okay so I've got party one two three four guess what it's gonna be right here I think I have time next year",
    "start": "2455790",
    "end": "2462690"
  },
  {
    "text": "how's July next year work for you but this is a good opportunity to",
    "start": "2462690",
    "end": "2468880"
  },
  {
    "text": "refresh hardware there's several options for small lightweight systems for these 80 admin systems I like the Microsoft",
    "start": "2468880",
    "end": "2476080"
  },
  {
    "text": "Surface Microsoft doesn't pay me to say that but it works well and now there's cheaper ones out but it's important to",
    "start": "2476080",
    "end": "2482619"
  },
  {
    "text": "explain the reasons the how's the whys why it's important to separate these systems out because without that",
    "start": "2482619",
    "end": "2489130"
  },
  {
    "text": "information it will be the bottom of the priority list and will never happen because these isolating these",
    "start": "2489130",
    "end": "2495220"
  },
  {
    "text": "credentials are the most critical now convincing management is just as important if not more so got to tell",
    "start": "2495220",
    "end": "2502030"
  },
  {
    "text": "them why we've got to explain why this is important why it's required yes these",
    "start": "2502030",
    "end": "2508540"
  },
  {
    "text": "systems and process will slow the resolution of issues managers hate this executives hate this because yes it",
    "start": "2508540",
    "end": "2516280"
  },
  {
    "text": "might take another day or two to resolve an issue that you want done in hours but",
    "start": "2516280",
    "end": "2522490"
  },
  {
    "text": "it will also slow down and stop attackers from having that access in that capability and the cost of this",
    "start": "2522490",
    "end": "2528490"
  },
  {
    "text": "extra hardware and the delays that it would take naturally to do things that used to be done a lot more quickly far",
    "start": "2528490",
    "end": "2534520"
  },
  {
    "text": "cheaper than an IR far cheaper than having Mandy and fireEye CrowdStrike come in and kick out the attackers far",
    "start": "2534520",
    "end": "2541420"
  },
  {
    "text": "cheaper than the reputation hid far cheaper than the downtime far cheaper than people working 100 hours a week and",
    "start": "2541420",
    "end": "2547030"
  },
  {
    "text": "20% of your staff getting burnt out and leaving it's usually the best ones to you by the way start slow and build up",
    "start": "2547030",
    "end": "2554530"
  },
  {
    "text": "with gradual changes we need to partner and make this a collaborative effort we need to start slow and say here's what",
    "start": "2554530",
    "end": "2560890"
  },
  {
    "text": "we want to do and here's why let's talk about how we can do this smartly how that we can do this together",
    "start": "2560890",
    "end": "2567540"
  },
  {
    "text": "so it's a workable admin system ideally would be separate physical devices but",
    "start": "2567540",
    "end": "2573490"
  },
  {
    "start": "2568000",
    "end": "2568000"
  },
  {
    "text": "that's not always feasible but since our goal is to isolate our credentials let's",
    "start": "2573490",
    "end": "2579190"
  },
  {
    "text": "talk about using an admin workstation leverages virtualization so that we can have a good blend of security and",
    "start": "2579190",
    "end": "2584950"
  },
  {
    "text": "operational capability so there's a lot on this slide we're going to start with",
    "start": "2584950",
    "end": "2590920"
  },
  {
    "text": "a host OS which is our admin environment virtualize or user environment into a VM and we're going to use that user",
    "start": "2590920",
    "end": "2597280"
  },
  {
    "text": "environment for all of our user activity that host OS is effectively going to be our admin system that we just use as a",
    "start": "2597280",
    "end": "2602630"
  },
  {
    "text": "jumping point to our admin system or a DC this is the account that logs onto",
    "start": "2602630",
    "end": "2608240"
  },
  {
    "text": "this host OS is what I call a transition account it doesn't have any rights it can't do anything it just logs on to",
    "start": "2608240",
    "end": "2613400"
  },
  {
    "text": "that system and then once on that system we can log on to in our DB server and",
    "start": "2613400",
    "end": "2618950"
  },
  {
    "text": "have been serviced so let's see what this looks like so we are admin workstation with our user VM we log in",
    "start": "2618950",
    "end": "2624050"
  },
  {
    "text": "as a regular user onto that VM we use a transition account to log onto that workstation and then we use that our 80",
    "start": "2624050",
    "end": "2631880"
  },
  {
    "text": "admin account via RDP to our admin server so this way we can isolate those",
    "start": "2631880",
    "end": "2637190"
  },
  {
    "text": "credentials we can protect them and since it's our admin workstation it's not going to have all the standard",
    "start": "2637190",
    "end": "2642760"
  },
  {
    "text": "capability of management controls and hundred people that have admin rights okay Sean but we have a password wall",
    "start": "2642760",
    "end": "2649250"
  },
  {
    "text": "how does that fit in yeah you just plug it in right here same thing Laguz user use a transition",
    "start": "2649250",
    "end": "2654770"
  },
  {
    "text": "account the transition account is what also asks that password vault but now we know the admin workstation is protecting",
    "start": "2654770",
    "end": "2660740"
  },
  {
    "text": "those credentials were using to connect into it using MFA hopefully and then",
    "start": "2660740",
    "end": "2666830"
  },
  {
    "text": "they pass with Vulcan proxy it through I'm not advocating password volts by the",
    "start": "2666830",
    "end": "2672050"
  },
  {
    "text": "way we can have conversations offline about the benefits etc so urban",
    "start": "2672050",
    "end": "2677480"
  },
  {
    "start": "2677000",
    "end": "2677000"
  },
  {
    "text": "workstations definitely start with our act directory admins look at virtual infrastructure cloud admins don't forget",
    "start": "2677480",
    "end": "2683780"
  },
  {
    "text": "about PGI mainframe so Chad's putting on a great talk tomorrow afternoon about mainframe hacking from a regular",
    "start": "2683780",
    "end": "2692060"
  },
  {
    "text": "workstation a lot of times mainframes are administered that way just like everything else is so with",
    "start": "2692060",
    "end": "2698480"
  },
  {
    "text": "this new standard this new configuration we want to make sure that our ad admins only ever log on to the main controllers",
    "start": "2698480",
    "end": "2704030"
  },
  {
    "text": "or 80 admin workstation or 88 admin server we want to make sure that 80 admin counts are separate from other",
    "start": "2704030",
    "end": "2709040"
  },
  {
    "text": "administration we want to prevent them from logging on other systems we want to get all service counts out of 80 admin",
    "start": "2709040",
    "end": "2715760"
  },
  {
    "text": "groups as a general rule I know that can't happen right away but our new standard is no service",
    "start": "2715760",
    "end": "2722000"
  },
  {
    "text": "counts in 80 admin groups not domain admins not administrators and then of course we want to make sure our local",
    "start": "2722000",
    "end": "2727340"
  },
  {
    "text": "admin passwords actually get changed so we need to reduce and limit our",
    "start": "2727340",
    "end": "2733579"
  },
  {
    "text": "service count rights then the vendor requirements also push us in this direction they say domain admins we say",
    "start": "2733579",
    "end": "2739369"
  },
  {
    "text": "ok let's push back what rights are actually required to often their domain admins administrators backup operator",
    "start": "2739369",
    "end": "2745309"
  },
  {
    "text": "server operators these are highly privileged ad admin groups rarely do they actually require it so I did a lot",
    "start": "2745309",
    "end": "2752180"
  },
  {
    "start": "2751000",
    "end": "2751000"
  },
  {
    "text": "of work and effort in my free time I read through a lot of different documentation from vendors piled through",
    "start": "2752180",
    "end": "2758329"
  },
  {
    "text": "this over hours and hours and I put together a list of the most common things that vendors asked for and I a",
    "start": "2758329",
    "end": "2763789"
  },
  {
    "text": "pattern emerged we're in Vegas so we're gonna do a little Vegas magic let's see if the pattern emerges for you - yes",
    "start": "2763789",
    "end": "2774859"
  },
  {
    "text": "domain admins solves everything right",
    "start": "2774859",
    "end": "2780308"
  },
  {
    "text": "oftentimes it's a vulnerability scanning tool backup VPN even sequel ends up in",
    "start": "2781660",
    "end": "2786950"
  },
  {
    "text": "domain admins we don't need them there we can pull those out they need less",
    "start": "2786950",
    "end": "2792140"
  },
  {
    "text": "rights and what they say they require vulnerability scanning is a little little trickier oftentimes the vulnerability scanning tool is gonna use",
    "start": "2792140",
    "end": "2798529"
  },
  {
    "text": "an author authorized or authenticated scan using a demain admin account but if that hiccups and leaves behind that",
    "start": "2798529",
    "end": "2804769"
  },
  {
    "text": "credential of that serves count on a workstation the environments don't forget about the vulnerabilities if you",
    "start": "2804769",
    "end": "2812599"
  },
  {
    "text": "have unconstrained delegation a vulnerability scanning account scans that system guess what the Kerberos TGT",
    "start": "2812599",
    "end": "2817609"
  },
  {
    "text": "the authentication ticket is left behind an attacker compromised that system it's game over we need to get better we need",
    "start": "2817609",
    "end": "2825740"
  },
  {
    "text": "to get these accounts out backup unless it's Active Directory backup doesn't",
    "start": "2825740",
    "end": "2830779"
  },
  {
    "text": "need to be in domain admins and even then it just needs to be in backup operators VPN and sequel shouldn't be",
    "start": "2830779",
    "end": "2835849"
  },
  {
    "text": "there the issue with the pianos often the VPN a service account wants to be able to",
    "start": "2835849",
    "end": "2842809"
  },
  {
    "text": "reset the user's password users trying to VPN their password is inspired they need to log on okay well let's delegate",
    "start": "2842809",
    "end": "2848779"
  },
  {
    "text": "those rights for that service account let's not give it da & Seek why'd I have",
    "start": "2848779",
    "end": "2854029"
  },
  {
    "text": "nothing to say about sequel I don't know why secret would ever be in domain admins usually that goes way far back a",
    "start": "2854029",
    "end": "2862339"
  },
  {
    "text": "little note on sequel by the way a little bit of homework for you when you get back to your organization your",
    "start": "2862339",
    "end": "2868920"
  },
  {
    "text": "your act directive environment take a look at your administrator account your default administrator account for your domains you read 500 count and check to",
    "start": "2868920",
    "end": "2875970"
  },
  {
    "text": "see if there's a service principal name associated with a case pen okay if it has a span it's a service count it is",
    "start": "2875970",
    "end": "2882330"
  },
  {
    "text": "being used as a service count your environment that is bad please remove that immediately because that is not",
    "start": "2882330",
    "end": "2887490"
  },
  {
    "text": "good at all so in conclusion traditionally the administration must evolve with the threats to effectively protect 80 most",
    "start": "2887490",
    "end": "2894390"
  },
  {
    "text": "organizations have done something but we still need to get better party 1 remove",
    "start": "2894390",
    "end": "2900870"
  },
  {
    "text": "all the accounts that don't belong there and remove the service accounts that are in 80 admin groups priority to protect",
    "start": "2900870",
    "end": "2906720"
  },
  {
    "text": "and isolate your at 80 admin credentials",
    "start": "2906720",
    "end": "2912020"
  },
  {
    "text": "that's been my time thank you very much for yours if you like my talk please submit evaluation also there's a QA that",
    "start": "2912020",
    "end": "2919080"
  },
  {
    "text": "I'll be in in this [Applause]",
    "start": "2919080",
    "end": "2926770"
  }
]