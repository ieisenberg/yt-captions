[
  {
    "text": "welcome to the last talk of the day in Islander ofg you are about to see and",
    "start": "60",
    "end": "9120"
  },
  {
    "text": "listen to moving from hacking IOT gadgets to breaking into one of Europe's",
    "start": "9120",
    "end": "14370"
  },
  {
    "text": "highest hotel suites with Ray and Michael Hubler if you have questions",
    "start": "14370",
    "end": "21869"
  },
  {
    "text": "afterwards they do have some time for some Q&A there are three microphones throughout the room so we are recording",
    "start": "21869",
    "end": "29519"
  },
  {
    "text": "this please step up to the microphone so that everyone can hear your question and it can be recorded thank you very much",
    "start": "29519",
    "end": "38809"
  },
  {
    "text": "hi okay so welcome to the ending of this conference I hope you enjoyed blackhead",
    "start": "46270",
    "end": "52090"
  },
  {
    "text": "so far as much admitted and are ready for the grand finale our presentation",
    "start": "52090",
    "end": "57790"
  },
  {
    "text": "about hacking IOT gadgets up to hotel suites so who are we",
    "start": "57790",
    "end": "63250"
  },
  {
    "text": "I'm ray an active member of the German heckler Association Chaos Computer Club for like 20 years or so I've been",
    "start": "63250",
    "end": "70750"
  },
  {
    "text": "researching lock-picking I mean technology enthusiasts and by work I happen to sleep a lot in hotels so",
    "start": "70750",
    "end": "78130"
  },
  {
    "text": "that's what brought me into researching this topic hello",
    "start": "78130",
    "end": "84820"
  },
  {
    "text": "I basically have been playing with locks all my years all my life about 40 years",
    "start": "84820",
    "end": "92380"
  },
  {
    "text": "ago they were on mechanicals of course and I got into lock-picking and competitive lock-picking and lot sports",
    "start": "92380",
    "end": "98520"
  },
  {
    "text": "but then electronic lock started I became an electronic engineer I continued to do that a few years ago",
    "start": "98520",
    "end": "105250"
  },
  {
    "text": "Bluetooth Low Energy came in to all the locks and that we looked into these and that's what led to this presentation",
    "start": "105250",
    "end": "113220"
  },
  {
    "text": "okay so what we're going to talk about we're going to talk about smart devices so the devices using Bluetooth Low",
    "start": "114060",
    "end": "121060"
  },
  {
    "text": "Energy connected usually to a smart phone and of course you will learn how to analyze and probably hack cell",
    "start": "121060",
    "end": "127780"
  },
  {
    "text": "systems or if you're on the other side of this business how to improve lease or build better ones and of course we show",
    "start": "127780",
    "end": "135220"
  },
  {
    "text": "how we applied those methods to various products and the vulnerabilities we",
    "start": "135220",
    "end": "141550"
  },
  {
    "text": "found in that from cheap padlocks to hotel door systems out of curiosity array of hands who of you has used the",
    "start": "141550",
    "end": "148569"
  },
  {
    "text": "mobile key system offered here in the Mandalay Bay Hotel ok so I see you",
    "start": "148569",
    "end": "154840"
  },
  {
    "text": "wanted to free first this presentation which is very good but to make sure to clear the Mandalay if not see hotel we",
    "start": "154840",
    "end": "161380"
  },
  {
    "text": "successfully attacked so you might well have good we're using it so the agenda",
    "start": "161380",
    "end": "168520"
  },
  {
    "text": "today is bluetooth LE eco system so what's in such a system involved because",
    "start": "168520",
    "end": "174700"
  },
  {
    "text": "it's hot at reduction to bill itself how to analyze such ble systems then",
    "start": "174700",
    "end": "180430"
  },
  {
    "text": "Asset tell you of the vulnerabilities we found in our prior work and then what we",
    "start": "180430",
    "end": "185950"
  },
  {
    "text": "recently searched in billy hotel keys and the one system that we broke and also talked a little about the",
    "start": "185950",
    "end": "193020"
  },
  {
    "text": "responsibilities close the process we had this avenger and the challenges involved the such disclosure in a real",
    "start": "193020",
    "end": "200200"
  },
  {
    "text": "life systems as has real impact in the real world so as a billy ecosystem what",
    "start": "200200",
    "end": "206620"
  },
  {
    "text": "you usually have our examples are mostly locked so we have a smart lock or so-called smart lock connecting using",
    "start": "206620",
    "end": "214480"
  },
  {
    "text": "billy to a smartphone app which is connecting over the internet to a back-end API servers so if you have such",
    "start": "214480",
    "end": "222280"
  },
  {
    "text": "an ecosystem there's a lot of attack vectors one on this side of the electronic log you can read out probably",
    "start": "222280",
    "end": "229870"
  },
  {
    "text": "firmware or other secrets from the chip you have side channel attacks like power attacks to get out keys you can insert",
    "start": "229870",
    "end": "237700"
  },
  {
    "text": "the wires into the device and get to debug ports power a motor activated some way in a way that wasn't intended and",
    "start": "237700",
    "end": "244360"
  },
  {
    "text": "also the mechanical attacks like vibration or hammering to it or magnets",
    "start": "244360",
    "end": "250810"
  },
  {
    "text": "who manipulates interactors to defeat the lock on a mechanical array on the",
    "start": "250810",
    "end": "256479"
  },
  {
    "text": "smartphone of course things like malware stealing secrets so probably don't use a mobile phone he",
    "start": "256479",
    "end": "263620"
  },
  {
    "text": "if you have malware on your phone and there's also possibilities to relay which is called distance short so you're",
    "start": "263620",
    "end": "269919"
  },
  {
    "text": "not at your device but somebody relays the data and still uses your phone to open your device then there's the",
    "start": "269919",
    "end": "276220"
  },
  {
    "text": "internet and as we all know this back-end web services they have vulnerabilities so this is not the main",
    "start": "276220",
    "end": "282070"
  },
  {
    "text": "focus on our talk but they have been multiple found in this field or server systems had flaws and the backend for",
    "start": "282070",
    "end": "289360"
  },
  {
    "text": "will be looking at first is the connections involved so between the lock and the smartphone and between the",
    "start": "289360",
    "end": "296200"
  },
  {
    "text": "smartphone and the Internet there are connections where you can sniff the data you can man in the middle and you can",
    "start": "296200",
    "end": "302800"
  },
  {
    "text": "impersonate one of the two sides if there's no verification so altogether there's quite a lot of attack vectors",
    "start": "302800",
    "end": "309430"
  },
  {
    "text": "you will learn about today but to understand that first introduction to Bill II so that the link",
    "start": "309430",
    "end": "315989"
  },
  {
    "text": "between the lock and the smartphone app so bill is Bluetooth Low Energy it was",
    "start": "315989",
    "end": "322019"
  },
  {
    "text": "designed as a cheap low-power alternative to classical Bluetooth so that things that run on a battery can",
    "start": "322019",
    "end": "327479"
  },
  {
    "text": "used for a longer time it is part of the BT for the DOE specification so it has",
    "start": "327479",
    "end": "332519"
  },
  {
    "text": "been out for quite a while already and it's quite different from classical Bluetooth so if you know that some",
    "start": "332519",
    "end": "337889"
  },
  {
    "text": "things may be different it's mainly used for these so-called IOT devices those",
    "start": "337889",
    "end": "344369"
  },
  {
    "text": "are usually not in some cell phones internet but using B and E connect to something that is online so it's",
    "start": "344369",
    "end": "350490"
  },
  {
    "text": "communication between the device and your smartphone and there's lots of things like locks what we talked about",
    "start": "350490",
    "end": "356219"
  },
  {
    "text": "but also light bulbs even sex toys heart rate sensors all of these things connecting using B and E to a smartphone",
    "start": "356219",
    "end": "364610"
  },
  {
    "text": "so what's the security of groups of low energies there has been a very good presentation already in 2013 on the good",
    "start": "364610",
    "end": "371579"
  },
  {
    "text": "conference this low energy comes low security and what the basically showed is that it's very easy to listen to",
    "start": "371579",
    "end": "378360"
  },
  {
    "text": "build connections and we somehow have sometimes the impression not everybody implementing this stuff is aware of that",
    "start": "378360",
    "end": "384899"
  },
  {
    "text": "there are secure options to make secure Billy communications like out-of-band",
    "start": "384899",
    "end": "390119"
  },
  {
    "text": "he pairing where you have to provide a key on both devices in an other manner or for point to elliptic curve",
    "start": "390119",
    "end": "396809"
  },
  {
    "text": "cryptography but those are very uncommon ly used in those devices for various reasons so what you'll usually find is",
    "start": "396809",
    "end": "404579"
  },
  {
    "text": "an unencrypted link layer and the application layer has to make sure to provide the security and if that doesn't",
    "start": "404579",
    "end": "412019"
  },
  {
    "text": "work you find the things that we are going to talk about so how actually to",
    "start": "412019",
    "end": "417419"
  },
  {
    "text": "analyze this ely layer if you want to analyze an app you're doing it usually",
    "start": "417419",
    "end": "422429"
  },
  {
    "text": "on your own device so is there you have control over the data going in and out so the easiest way is on an android",
    "start": "422429",
    "end": "428369"
  },
  {
    "text": "phone to enable the debug mode and activate the so-called HCI snoop lock that makes your phone record all the",
    "start": "428369",
    "end": "435779"
  },
  {
    "text": "data coming in and out on real e so you can later analyze it the same as possible on iOS so you install the F",
    "start": "435779",
    "end": "443529"
  },
  {
    "text": "Bluetooth debug certificate you can download it from Apple and for a few days you have like a debug functionality",
    "start": "443529",
    "end": "449139"
  },
  {
    "text": "giving you the ability to dump the data your own communicated verbally it's a",
    "start": "449139",
    "end": "454359"
  },
  {
    "text": "little more complicated way so we would recommend if you have an Android phone you can use for try this first so if you",
    "start": "454359",
    "end": "461529"
  },
  {
    "text": "have done that just use the app as normal what we have found out useful is",
    "start": "461529",
    "end": "467559"
  },
  {
    "text": "to make timestamp so note down at this point in time I open the lock at this point of time that and that happened so",
    "start": "467559",
    "end": "474429"
  },
  {
    "text": "later if we analyze your data you know what what we what was which action then",
    "start": "474429",
    "end": "480159"
  },
  {
    "text": "download the lock from the phone and you can analyze it with very common analyzer tool like for example Wireshark it's a",
    "start": "480159",
    "end": "486759"
  },
  {
    "text": "pcap file so I'm not sure if everybody here knows why a sharper to the network and others tool and it gives you a ways",
    "start": "486759",
    "end": "492939"
  },
  {
    "text": "to look into such a dump so you see here it's a search communication is a destination in this",
    "start": "492939",
    "end": "498339"
  },
  {
    "text": "way local house always is your phone and the other thing is here in this case and Texas Instruments device so an IOT",
    "start": "498339",
    "end": "504909"
  },
  {
    "text": "device using nti chip it also will decode the Bluetooth protocol information for you so various shark is",
    "start": "504909",
    "end": "511479"
  },
  {
    "text": "aware of ble and knows which kind of packets that are and will show you what kind of package you're looking at you",
    "start": "511479",
    "end": "517300"
  },
  {
    "text": "usually will at the filter to find the patterns you want to look at mostly it's writing or reading from so called",
    "start": "517300",
    "end": "522638"
  },
  {
    "text": "handles and at the bottom of here you see the value that is actually the date have written and most of the things",
    "start": "522639",
    "end": "528790"
  },
  {
    "text": "you're looking for so you're trying to look into the data so this is if you want to analyze a protocol for attacking",
    "start": "528790",
    "end": "535029"
  },
  {
    "text": "a real system you have to sniff the bill from the air so there's basically three",
    "start": "535029",
    "end": "540399"
  },
  {
    "text": "channels device advertisers on and you have to listen to the right one to catch",
    "start": "540399",
    "end": "545620"
  },
  {
    "text": "a connection but those cheap sniffers who can do that or listen to touch a channel and get your connection the",
    "start": "545620",
    "end": "552339"
  },
  {
    "text": "classical tools for that are the other food bluefruit le sniffer or the uber tooth one there's lots of presentations",
    "start": "552339",
    "end": "558189"
  },
  {
    "text": "about these they can easily bought like on every online shop you'll find in this field and they support live feed in to",
    "start": "558189",
    "end": "565089"
  },
  {
    "text": "Wireshark so like you have Wireshark running on Ethernet you then have by a shark running on a bill a link so",
    "start": "565089",
    "end": "571120"
  },
  {
    "text": "disadvantage of those devices is they sniff only one channel at a time so if you device pops",
    "start": "571120",
    "end": "576520"
  },
  {
    "text": "sequence you don't know it works approximately a short of the time so it's okay for proof of concept but it's",
    "start": "576520",
    "end": "583180"
  },
  {
    "text": "not reliable for a real-life attack so our favorite tool is the called little",
    "start": "583180",
    "end": "588460"
  },
  {
    "text": "Jack by Damien Willis has been released at black addressing and it supports a firmware for cheap devices",
    "start": "588460",
    "end": "595030"
  },
  {
    "text": "you can buy like the BBC micro bit death port you can buy for $15 from Fry's or whatever we only 400 the other food",
    "start": "595030",
    "end": "602500"
  },
  {
    "text": "sniffers so your flash firmware or actually the tool will flash the firmware for you and then you can use",
    "start": "602500",
    "end": "607570"
  },
  {
    "text": "three devices at a time and watch them in parallel and it's much more than sniffing the options are men the middle",
    "start": "607570",
    "end": "614440"
  },
  {
    "text": "and lots more so if you build such a setup I did it by putting together a few creative comments some duct tape so that",
    "start": "614440",
    "end": "621880"
  },
  {
    "text": "was my first working sniffing setup Michaels and might a little nicer set up",
    "start": "621880",
    "end": "627070"
  },
  {
    "text": "with a Raspberry Pi so that's a compact set up running on the battery pack sniffing Billy on all three channels you",
    "start": "627070",
    "end": "633670"
  },
  {
    "text": "would probably even be able to fit through a smoke detector or deposited somewhere hidden to record data so",
    "start": "633670",
    "end": "640720"
  },
  {
    "text": "that's how to get the data from the gling between the device and the phone now we also have to look at the link",
    "start": "640720",
    "end": "647440"
  },
  {
    "text": "between the phone and the back end and this is usually HTTP or HTTPS only very",
    "start": "647440",
    "end": "656920"
  },
  {
    "text": "few apps today use HTTP we actually encountered one so it still happens today but usually it's hdds so if you",
    "start": "656920",
    "end": "664780"
  },
  {
    "text": "want to man the middle of that you have to install a fake root CA to intercept the traffic but that's possible there's",
    "start": "664780",
    "end": "671710"
  },
  {
    "text": "tools doing it basically automatically for you they created fake CA and this is",
    "start": "671710",
    "end": "677050"
  },
  {
    "text": "something not to break TLS for other people but to analyze your own traffic there's not an attack on TLS it's",
    "start": "677050",
    "end": "683590"
  },
  {
    "text": "something everybody knows you can do so you analyze again the traffic of your device so on iOS it's easy the middle",
    "start": "683590",
    "end": "692230"
  },
  {
    "text": "middle tool creates a certificate of CA for you and you just declare that attracted that was also possible in",
    "start": "692230",
    "end": "699700"
  },
  {
    "text": "Android up to version sixth on X the sixth of X in newer Android versions you",
    "start": "699700",
    "end": "705340"
  },
  {
    "text": "need a rooted device because you have to hard code it change the in certificate store otherwise it won't",
    "start": "705340",
    "end": "711980"
  },
  {
    "text": "accept your certificates if you can't use the route of such a device there is an option to modify a specific app you",
    "start": "711980",
    "end": "719360"
  },
  {
    "text": "want to analyze by changing the manifest in the apks or stocks on that online",
    "start": "719360",
    "end": "724550"
  },
  {
    "text": "that we have linked in the slides there are lots of links in our slides so be sure to download them after the",
    "start": "724550",
    "end": "730009"
  },
  {
    "text": "conference and check out the link that will give you lots of information about the topics we're covering here in a very",
    "start": "730009",
    "end": "735259"
  },
  {
    "text": "short time but this way you can change the manifest and change the network security convict so it trusts also the",
    "start": "735259",
    "end": "742519"
  },
  {
    "text": "user store so even if non-rooted device if you modify the app which is not a very complicated thing to do",
    "start": "742519",
    "end": "749209"
  },
  {
    "text": "you can get the CA to trust and to amend the middle your data the only thing is",
    "start": "749209",
    "end": "755720"
  },
  {
    "text": "there are some apps who have countermeasures and Micra will tell a little about what you can do then",
    "start": "755720",
    "end": "762790"
  },
  {
    "text": "sometimes the application itself wants to protect the user as well from a rogue CA which is a good thing in this case",
    "start": "763120",
    "end": "770749"
  },
  {
    "text": "sometimes the apps even tell you what they are doing sometimes they just stop working but",
    "start": "770749",
    "end": "779259"
  },
  {
    "text": "what can you do then there's a few basic ideas",
    "start": "779259",
    "end": "785540"
  },
  {
    "text": "the first one is rather trivial but helps quite a lot of did help often",
    "start": "785540",
    "end": "791899"
  },
  {
    "text": "usually there's more than one app there's an older version potentially for Android or there is an iOS version",
    "start": "791899",
    "end": "798670"
  },
  {
    "text": "basically sometimes only one of the app testers that's this it slightly more involved",
    "start": "798670",
    "end": "805519"
  },
  {
    "text": "would be the second option you can modify the application that's of course",
    "start": "805519",
    "end": "811459"
  },
  {
    "text": "you have to find out how to modify and so on there are some tutorials on the internet for that the third one is very",
    "start": "811459",
    "end": "818389"
  },
  {
    "text": "powerful tool what we called the tools called Frida and there's a framework or",
    "start": "818389",
    "end": "823639"
  },
  {
    "text": "objection this is extremely powerful you can do a lot of things with that you can",
    "start": "823639",
    "end": "828889"
  },
  {
    "text": "modify all the calls within the app it's beyond the scope of this 50 minute",
    "start": "828889",
    "end": "835129"
  },
  {
    "text": "presentation to go through all of that so we just look quickly through this you would run and for example in the case of",
    "start": "835129",
    "end": "841339"
  },
  {
    "text": "a rooted android device you would run server there if you get lucky you can",
    "start": "841339",
    "end": "848720"
  },
  {
    "text": "then just run this objective framework and there's pee defying commands like this Android as ascertaining disabled",
    "start": "848720",
    "end": "855170"
  },
  {
    "text": "this will try to disable some known as its opening frameworks and again if",
    "start": "855170",
    "end": "861740"
  },
  {
    "text": "you're lucky then the app will work afterwards if that doesn't work it's a little bit more complicated but again",
    "start": "861740",
    "end": "867950"
  },
  {
    "text": "you'll find good tutorials you would have to write a JavaScript file for freedom that can basically change or a",
    "start": "867950",
    "end": "876100"
  },
  {
    "text": "lot of things within the app and in this case it would just return the certificate which you run this and then",
    "start": "876100",
    "end": "883730"
  },
  {
    "text": "the bottom you see a screenshot this time of another two and this shows that",
    "start": "883730",
    "end": "891500"
  },
  {
    "text": "in this case T is opening TLS pinning is disabled so our advice for vendors is",
    "start": "891500",
    "end": "899959"
  },
  {
    "text": "yes TLS certificate pinning is a measure to protect your users from rope CAS but it",
    "start": "899959",
    "end": "906920"
  },
  {
    "text": "doesn't protect your traffic from analysis by hackers so do not rely on that",
    "start": "906920",
    "end": "912490"
  },
  {
    "text": "okay the tools that we then can use to analyze the traffic on UNIX command line",
    "start": "912490",
    "end": "919370"
  },
  {
    "text": "we use mitten proxy if you want to have nice user interface you cannot use other",
    "start": "919370",
    "end": "924650"
  },
  {
    "text": "tools like the charts proxy there is also the pursuit of fiddler available it",
    "start": "924650",
    "end": "929839"
  },
  {
    "text": "will take this on the command line you get a lock of all the transactions you",
    "start": "929839",
    "end": "935089"
  },
  {
    "text": "can zoom in to one of them and in this example and you get already one of the",
    "start": "935089",
    "end": "941330"
  },
  {
    "text": "piece we wanted to extract from the traffic a nicely printed out chasing",
    "start": "941330",
    "end": "946900"
  },
  {
    "text": "file right so our advice to use this would be do it right from the start",
    "start": "946900",
    "end": "953930"
  },
  {
    "text": "because sometimes you get a system that updates itself immediately and you would",
    "start": "953930",
    "end": "960380"
  },
  {
    "text": "obviously miss this and would be difficult to get back to the old stage",
    "start": "960380",
    "end": "966040"
  },
  {
    "text": "yeah and it is very useful to have dedicated rooted device like all the",
    "start": "966040",
    "end": "972650"
  },
  {
    "text": "Android devices also expensive to do this okay",
    "start": "972650",
    "end": "977930"
  },
  {
    "text": "then now that we talked about how to collect the data on these two interfaces let's have a look into real world",
    "start": "977930",
    "end": "985640"
  },
  {
    "text": "example how to analyze this data this is",
    "start": "985640",
    "end": "991610"
  },
  {
    "text": "a easy example it's like a nice puzzle you can do like on an evening or weekend",
    "start": "991610",
    "end": "999020"
  },
  {
    "text": "it's a small really padlock one of the really cheap ones we should note this is",
    "start": "999020",
    "end": "1006220"
  },
  {
    "text": "research from last year meanwhile the manufacturer has improved the system but in 2018 it was like this",
    "start": "1006220",
    "end": "1014790"
  },
  {
    "text": "the first one is we wanted to analyze the backend connection turns out we don't need any rogue CA for this because",
    "start": "1014790",
    "end": "1023440"
  },
  {
    "text": "it just used HTTP traffic you can see the password right there you can also",
    "start": "1023440",
    "end": "1029380"
  },
  {
    "text": "see a 16 byte array called lock key so",
    "start": "1029380",
    "end": "1034390"
  },
  {
    "text": "that was in this case you but maybe could assume it's a s 128 and basically",
    "start": "1034390",
    "end": "1041860"
  },
  {
    "text": "when we decrypted the Bluetooth traffic that's the link between the app and the lock again it was random look really",
    "start": "1041860",
    "end": "1049780"
  },
  {
    "text": "random so we just took a chance and decrypted it using AES 128 and it",
    "start": "1049780",
    "end": "1055360"
  },
  {
    "text": "doesn't work on diem anymore as you can see there's a lots of zeros and obviously this is properly decrypted the",
    "start": "1055360",
    "end": "1064390"
  },
  {
    "text": "next thing you will do is you look for patterns compare several sessions you'll see things that are the same in this",
    "start": "1064390",
    "end": "1070480"
  },
  {
    "text": "traffic and from a few sessions then you can use the protocol you see there is",
    "start": "1070480",
    "end": "1075790"
  },
  {
    "text": "like session IDs and things like that apparently there's a replay protection implemented by a session ID but you then",
    "start": "1075790",
    "end": "1084160"
  },
  {
    "text": "can do what we actually did is verify this look for weaknesses so one of the",
    "start": "1084160",
    "end": "1091480"
  },
  {
    "text": "approaches we do in this case is the writer script using loop I also this",
    "start": "1091480",
    "end": "1096730"
  },
  {
    "text": "other food library and mimic the application and then talk to the lock",
    "start": "1096730",
    "end": "1102220"
  },
  {
    "text": "and explore the protocol use parsing techniques yeah so that's the usual approach how to to look at this",
    "start": "1102220",
    "end": "1110300"
  },
  {
    "text": "this was the spot a call was not so difficult as I said the nice puzzle for an evening something like that what if",
    "start": "1110300",
    "end": "1116330"
  },
  {
    "text": "it's not that easy to understand you just get encrypted traffic it's all random you don't understand what it's",
    "start": "1116330",
    "end": "1122480"
  },
  {
    "text": "doing there then it makes sense to look at the thing in the middle what",
    "start": "1122480",
    "end": "1128330"
  },
  {
    "text": "smartphone application yeah that's obviously something that holds all the information how the system works we just",
    "start": "1128330",
    "end": "1138290"
  },
  {
    "text": "wanted to note that some legislations prohibit decompiling applications except",
    "start": "1138290",
    "end": "1144890"
  },
  {
    "text": "for specific reasons so please check local legislation before you do that",
    "start": "1144890",
    "end": "1151390"
  },
  {
    "text": "okay there is two systems and use today Android and iOS for Android it's not",
    "start": "1152080",
    "end": "1159950"
  },
  {
    "text": "that difficult to obtain readable source code because the applications are",
    "start": "1159950",
    "end": "1165559"
  },
  {
    "text": "typically written in Java and that's compared to bytecode you can recompile it back to Java using tools that are",
    "start": "1165559",
    "end": "1171920"
  },
  {
    "text": "available online as well sometimes you get compiled C++ code you need different",
    "start": "1171920",
    "end": "1177890"
  },
  {
    "text": "tools for that like for example at NSA either up what we heard about today or of course EDA for iOS it's typically a",
    "start": "1177890",
    "end": "1186950"
  },
  {
    "text": "little bit more difficult but also possible you have to get the decrypted application file first these days you",
    "start": "1186950",
    "end": "1193520"
  },
  {
    "text": "would need some jailbroken device for that but then you get armed binaries and",
    "start": "1193520",
    "end": "1198650"
  },
  {
    "text": "there's also choose to decompile this like again vida or copper and so on once",
    "start": "1198650",
    "end": "1206059"
  },
  {
    "text": "you did that it's typically a good idea to look for what does the application",
    "start": "1206059",
    "end": "1212750"
  },
  {
    "text": "with Bluetooth like you have search for a term like Android Bluetooth or AES or",
    "start": "1212750",
    "end": "1218600"
  },
  {
    "text": "crypt and the first example you see that that's yeah you find the place where",
    "start": "1218600",
    "end": "1224030"
  },
  {
    "text": "it's actually talking to the lock the second part is an example where we found a key and an application and",
    "start": "1224030",
    "end": "1231340"
  },
  {
    "text": "yeah the key was one two three four five six seven eight and so on so basically",
    "start": "1231340",
    "end": "1237860"
  },
  {
    "text": "if you see something like this you think ok maybe let's look at this a little bit",
    "start": "1237860",
    "end": "1243020"
  },
  {
    "text": "or there could be other vulnerabilities in there one more point regarding",
    "start": "1243020",
    "end": "1250690"
  },
  {
    "text": "looking at applications specifically also Android code is really nice that",
    "start": "1250690",
    "end": "1256450"
  },
  {
    "text": "you can decompile it to Java but often it's obfuscated that means area the",
    "start": "1256450",
    "end": "1262580"
  },
  {
    "text": "symbols are readable but you don't can't make any sense of it it's really hard to read so there's for example",
    "start": "1262580",
    "end": "1269800"
  },
  {
    "text": "yeah it's called be err something by Terry for then again if you see like a",
    "start": "1269800",
    "end": "1277940"
  },
  {
    "text": "string that's not obfuscated access key data is no and yeah just replace it",
    "start": "1277940",
    "end": "1283490"
  },
  {
    "text": "using refactoring tools like another studio and you get there we have a very",
    "start": "1283490",
    "end": "1289190"
  },
  {
    "text": "strong opinion on application we we say obfuscation makes analysis harder but",
    "start": "1289190",
    "end": "1296120"
  },
  {
    "text": "it's not impossible so it slows down us we cannot help you",
    "start": "1296120",
    "end": "1301760"
  },
  {
    "text": "as a vendor then it does not stop criminals that will attack you and your customers so don't do it instead these",
    "start": "1301760",
    "end": "1308240"
  },
  {
    "text": "are new protocols in a way which is secure even and they are known right well yeah so now let's look at few",
    "start": "1308240",
    "end": "1318260"
  },
  {
    "text": "things that we found us using these methods as promised we will show you a few examples of vulnerabilities that we",
    "start": "1318260",
    "end": "1324770"
  },
  {
    "text": "actually can find in IOT devices using the message you just have shown you and you hopefully will apply in your",
    "start": "1324770",
    "end": "1331460"
  },
  {
    "text": "research in the future so first what we looked at is a typical cheap padlock",
    "start": "1331460",
    "end": "1336740"
  },
  {
    "text": "which are around on Alibaba on various sites blew a bill a padlock Bluetooth",
    "start": "1336740",
    "end": "1342380"
  },
  {
    "text": "padlock if you look for those those might show up so they have a sim proof mechanic so they are better than most of",
    "start": "1342380",
    "end": "1349610"
  },
  {
    "text": "the cheap locks to get at home deeper or something but it's transmitted pass code in clear text over-the-air and for this",
    "start": "1349610",
    "end": "1357050"
  },
  {
    "text": "lock to our knowledge disclaimer we haven't bought it last week or something this is still unfixed so we considered",
    "start": "1357050",
    "end": "1363050"
  },
  {
    "text": "O'Day but on the other hand the vendor for sure knows he didn't put any equip",
    "start": "1363050",
    "end": "1368360"
  },
  {
    "text": "chain in there so that's nothing like we could disclose to him he already knows he just didn't care obviously but it's",
    "start": "1368360",
    "end": "1374410"
  },
  {
    "text": "but so if we have such a look you look at the traffic we find this one Roderick fest it's basically the one we showed",
    "start": "1374410",
    "end": "1380470"
  },
  {
    "text": "you earlier and if you look in that we find an asserted to a bit 16-bit hex",
    "start": "1380470",
    "end": "1385810"
  },
  {
    "text": "string here which we convert to decimal and it turned out that's exactly the key he sat in the app on the lock so oh one",
    "start": "1385810",
    "end": "1392800"
  },
  {
    "text": "or two or three was a key I said on the lock so when I sniff it on the air with some vanilla says look I can just use",
    "start": "1392800",
    "end": "1399580"
  },
  {
    "text": "this he enter it to my app and without any hacker tools open his lock using the",
    "start": "1399580",
    "end": "1405040"
  },
  {
    "text": "code I sniff on the air so this is really just a poem system by design so",
    "start": "1405040",
    "end": "1410470"
  },
  {
    "text": "it's not the only locks at way already two years ago at Def Con there was a nice presentation by rose and Ramsay",
    "start": "1410470",
    "end": "1416110"
  },
  {
    "text": "they tested a broad range of Bluetooth locks for this simple vulnerabilities so",
    "start": "1416110",
    "end": "1422350"
  },
  {
    "text": "12 of 16 locks imagine that they tested had simple vulnerabilities like replay",
    "start": "1422350",
    "end": "1427810"
  },
  {
    "text": "like getting the key like fasten them and getting them open and stuff like that two of the padlocks they tested",
    "start": "1427810",
    "end": "1434380"
  },
  {
    "text": "remained unbroken as they said all there might be a little better so accidentally",
    "start": "1434380",
    "end": "1439390"
  },
  {
    "text": "or independently from those locks at one of these locks the master lock bluetooth",
    "start": "1439390",
    "end": "1445750"
  },
  {
    "text": "padlock is like in 60 to 80 dollar lock we figured you could attack mechanically",
    "start": "1445750",
    "end": "1451960"
  },
  {
    "text": "so this lock now locks you basically it's locked and instead of using the app",
    "start": "1451960",
    "end": "1457300"
  },
  {
    "text": "we now use a high tech hacker tool called a magnet and we attach it from",
    "start": "1457300",
    "end": "1462580"
  },
  {
    "text": "the back and by this movement from moving it over the side and turning the polarity from time to time he actually",
    "start": "1462580",
    "end": "1468280"
  },
  {
    "text": "turned the motor inside the lock so what usually you would have been activated by the electronics now are stand by the",
    "start": "1468280",
    "end": "1475300"
  },
  {
    "text": "magnet and the lock opens [Laughter]",
    "start": "1475300",
    "end": "1483200"
  },
  {
    "text": "so actually we disclose that to masterlock right on DEFCON because in",
    "start": "1484410",
    "end": "1489700"
  },
  {
    "text": "the Q&A I mentioned it and someone approached me hey I'm with master lock and showed it to him basically on the",
    "start": "1489700",
    "end": "1495130"
  },
  {
    "text": "conference so there hopefully did something about it but we never had contact I'm not sure if they if they",
    "start": "1495130",
    "end": "1500290"
  },
  {
    "text": "changed it or not they have a bigger Locker it's not said easy but probably they did something I don't know so the",
    "start": "1500290",
    "end": "1505660"
  },
  {
    "text": "other locks that remained unbroken by the erosion tremors research foreseen no keypad lock and that's actually one of",
    "start": "1505660",
    "end": "1512080"
  },
  {
    "text": "the first peony padlocks ever created it was a Kickstarter campaign in 2014 which",
    "start": "1512080",
    "end": "1517720"
  },
  {
    "text": "raised much more money than they expected so a typical thing going through the roof so they had quite some",
    "start": "1517720",
    "end": "1523180"
  },
  {
    "text": "money to to develop and the note here the research I am now showing you is for",
    "start": "1523180",
    "end": "1529480"
  },
  {
    "text": "the original firmware which was in place 2015 to 2017 and our responsible",
    "start": "1529480",
    "end": "1534760"
  },
  {
    "text": "disclosure process in 2016 after quite a while I must say led to a firmware update in 2017 fixing this to a new",
    "start": "1534760",
    "end": "1542320"
  },
  {
    "text": "protocol which we haven't looked deeper into but the note security wasn't as bad as a lock we shot before it must be a",
    "start": "1542320",
    "end": "1549130"
  },
  {
    "text": "reason that Ross and Ramsey didn't find it it uses actual AES 128 bit encryption using the reference implementation so",
    "start": "1549130",
    "end": "1556390"
  },
  {
    "text": "that something would say okay it also uses different secrets for the owner of the lock and friends new share as a lock",
    "start": "1556390",
    "end": "1563230"
  },
  {
    "text": "- so it's not like your friends could use a key to change your lock or something what we find out very early by",
    "start": "1563230",
    "end": "1568990"
  },
  {
    "text": "analyzing the backend traffic is the time restrictions were enforced in the app which of course is not the best",
    "start": "1568990",
    "end": "1574810"
  },
  {
    "text": "thing to do you could just many put it's a back-end traffic and circumvent the time restrictions basically if you share",
    "start": "1574810",
    "end": "1580210"
  },
  {
    "text": "this lock you could open it any time but the main vulnerability so that's a real thing you had to disclose",
    "start": "1580210",
    "end": "1585940"
  },
  {
    "text": "what's the secret transmission of C of C code to the lock it was transmitted",
    "start": "1585940",
    "end": "1592480"
  },
  {
    "text": "using individual AES session key 4 for each session and new key was generated so that's also good but the session key",
    "start": "1592480",
    "end": "1599830"
  },
  {
    "text": "generation was done in a secret handshake so something like Oh nobody knows how we do it so it's secure using",
    "start": "1599830",
    "end": "1606730"
  },
  {
    "text": "the hard-coded AES key that we saw before one two three four five six but that's not the problem every hard coded key",
    "start": "1606730",
    "end": "1613210"
  },
  {
    "text": "would be as bad as it is so it basically was security by obscurity as long as it didn't know the",
    "start": "1613210",
    "end": "1619090"
  },
  {
    "text": "protocol how they exchanged a session key it's okay but if some evil hacker comes and uses a disassembler he can",
    "start": "1619090",
    "end": "1625809"
  },
  {
    "text": "find this part of code which actually does the calculation of the session key so we looked a little bit into it",
    "start": "1625809",
    "end": "1631360"
  },
  {
    "text": "finally this was actually in the binary as alpha so we really had to disassemble we couldn't use the java decompiler",
    "start": "1631360",
    "end": "1636690"
  },
  {
    "text": "shown earlier but once you understand it you saw it's a very simple principle the",
    "start": "1636690",
    "end": "1642100"
  },
  {
    "text": "app sends none so number used ones of 32-bit to the lock the locks sends the",
    "start": "1642100",
    "end": "1647740"
  },
  {
    "text": "second number back to the app so now both parties Nobel Mouse numbers say X",
    "start": "1647740",
    "end": "1653289"
  },
  {
    "text": "or these numbers together so they get this first value here in the red corner it's a certain bit to value which is",
    "start": "1653289",
    "end": "1659889"
  },
  {
    "text": "added to the pre shared key so we changed shirted to bit in an 128-bit key",
    "start": "1659889",
    "end": "1666279"
  },
  {
    "text": "I'm not sure what that's supposed to do in security and then we get a new key by adding it up to the center of it and",
    "start": "1666279",
    "end": "1672490"
  },
  {
    "text": "this new session key which you could derive from Catholic you just sniff was used for all further communication so",
    "start": "1672490",
    "end": "1680490"
  },
  {
    "text": "let's thought about cryptography but did it wrong so if it is closest like the end of two thousand dollars in the",
    "start": "1680490",
    "end": "1688480"
  },
  {
    "text": "beginning 2016 at the end vida de for disclosure and in 2007 17 they finally",
    "start": "1688480",
    "end": "1693970"
  },
  {
    "text": "fixed it but so this shows also something important even if a vendor claims to use AES that doesn't mean it's",
    "start": "1693970",
    "end": "1700779"
  },
  {
    "text": "secure it's probably better than viewing home build protocols but still look for",
    "start": "1700779",
    "end": "1705789"
  },
  {
    "text": "vulnerabilities look for key exchanges there might be things like that so that's the previous things what we are",
    "start": "1705789",
    "end": "1711190"
  },
  {
    "text": "going want them to hear is ble hotel keys so what we're looking here at is",
    "start": "1711190",
    "end": "1716259"
  },
  {
    "text": "the ble layer and T back-end so but let's first ask why BL e for hotels so",
    "start": "1716259",
    "end": "1722769"
  },
  {
    "text": "this is really a clever idea to have a very less outer key the main purpose of course the self check-in you don't need",
    "start": "1722769",
    "end": "1728470"
  },
  {
    "text": "a key card anymore your mobile phone is a key for the hotel that means they can probably do staff or",
    "start": "1728470",
    "end": "1734320"
  },
  {
    "text": "UC staff at more valuable locations and everybody of you who stood in line at the Mandalay at a high traffic volume",
    "start": "1734320",
    "end": "1740710"
  },
  {
    "text": "will appreciate the ability to check in yourself with your phone and skip that line right so it could looks kind of",
    "start": "1740710",
    "end": "1746679"
  },
  {
    "text": "attractive but the challenge is such a system poses is that sexual pairing unlike in the",
    "start": "1746679",
    "end": "1751960"
  },
  {
    "text": "device you own where you could like pair from accuAir code you get as a package or something is hard to do here you walk",
    "start": "1751960",
    "end": "1758380"
  },
  {
    "text": "to the door and you want to communicate pairing know then they have usually deployed see hardware in the hotels for",
    "start": "1758380",
    "end": "1764169"
  },
  {
    "text": "quite a while so they have a retrofit probably old hardware with new modules and not have the most recent",
    "start": "1764169",
    "end": "1770289"
  },
  {
    "text": "cryptographic chips in there and then it's a complex ecosystem of a hotel",
    "start": "1770289",
    "end": "1775330"
  },
  {
    "text": "chain somebody building their app somebody building their lot probably a short party integrating the SDK from the",
    "start": "1775330",
    "end": "1781960"
  },
  {
    "text": "lock vendor to the hotel app so it's many people do have to work together but",
    "start": "1781960",
    "end": "1787389"
  },
  {
    "text": "if it all works how does it work out I have a booking somewhere and I have the app and an account in the app and",
    "start": "1787389",
    "end": "1793450"
  },
  {
    "text": "somehow I have to get the booking into the death so that actually might be the first weak spot here because in the",
    "start": "1793450",
    "end": "1799690"
  },
  {
    "text": "system we had a look at you could add the booking by things like your booking number your beginning end and stay and",
    "start": "1799690",
    "end": "1806500"
  },
  {
    "text": "your name so that's not something everybody knows but this is data somebody could get by social engineering",
    "start": "1806500",
    "end": "1812470"
  },
  {
    "text": "and if he manages to do that he can get your key on his app so that's the first",
    "start": "1812470",
    "end": "1817539"
  },
  {
    "text": "point where there might be a weakness that you could think about but things like this I've found lots of in hotel",
    "start": "1817539",
    "end": "1822700"
  },
  {
    "text": "systems if you have good social engineering skills you'd probably get into hotel room anyway then you do an",
    "start": "1822700",
    "end": "1828010"
  },
  {
    "text": "outer hatch online check-in in your app and the mobile key is transferred to your app so what you do now is here we",
    "start": "1828010",
    "end": "1834490"
  },
  {
    "text": "showing example actually if you're wondering vibrate in the black hat hotel this was man in the middle replaced by",
    "start": "1834490",
    "end": "1840639"
  },
  {
    "text": "our proxy we started to funny to replace the company logo by man the middle replacement and then you can use these",
    "start": "1840639",
    "end": "1846549"
  },
  {
    "text": "the app to approach the lock say unlock you see it's communicating now the lock is blinking yellow green and",
    "start": "1846549",
    "end": "1853059"
  },
  {
    "text": "your hotel door is open so that's a normal use case so this is how something",
    "start": "1853059",
    "end": "1858159"
  },
  {
    "text": "like that would work we looked at two different systems the first one we're looking at is not the one we bro we call",
    "start": "1858159",
    "end": "1864460"
  },
  {
    "text": "it the hotel age so because we don't have to name here hotels we didn't break and it worked after figuring out in that",
    "start": "1864460",
    "end": "1871570"
  },
  {
    "text": "way the back end to the app sends a key so there's a little bit complicated here",
    "start": "1871570",
    "end": "1876940"
  },
  {
    "text": "a key K as well as an encrypted version of this key which we call K star",
    "start": "1876940",
    "end": "1883309"
  },
  {
    "text": "only an K star is encrypted version of K by the key KS only he back-end which is",
    "start": "1883309",
    "end": "1890730"
  },
  {
    "text": "under control of cylinder and the lock which is under control of cylinder noses he KS so your app doesn't know it the",
    "start": "1890730",
    "end": "1898740"
  },
  {
    "text": "app sends now the encrypted key to the llama so the lock knowing the key KS can",
    "start": "1898740",
    "end": "1905610"
  },
  {
    "text": "derive the unencrypted key k and now the lock and your F can communicate using K",
    "start": "1905610",
    "end": "1912240"
  },
  {
    "text": "but you haven't you as a user don't have to know KS so now the bill it traffic is",
    "start": "1912240",
    "end": "1918240"
  },
  {
    "text": "encrypted with an AES key that the passive eavesdropper doesn't know so there's actually a good twist a good",
    "start": "1918240",
    "end": "1924240"
  },
  {
    "text": "thing so we didn't find an obvious attack vector on that except if you manage to obtain KS so you could",
    "start": "1924240",
    "end": "1930840"
  },
  {
    "text": "probably do it by taking a Part C lock and finding vulnerability in the chip user but steps of pass we don't got into",
    "start": "1930840",
    "end": "1937529"
  },
  {
    "text": "because we don't take apart other people lock for research at least that not if we're not allowed to do so we do it of",
    "start": "1937529",
    "end": "1943830"
  },
  {
    "text": "course with locks we own but in this case we didn't research his father and also with when we tried to do more dumps",
    "start": "1943830",
    "end": "1950159"
  },
  {
    "text": "and everything like that the system was down so first arsenal ok this hotel probably in the early stage we don't",
    "start": "1950159",
    "end": "1957149"
  },
  {
    "text": "research it anymore so we came to a second system as a manufacturer we call em like",
    "start": "1957149",
    "end": "1962399"
  },
  {
    "text": "manufacturer and that we found in a system in early 2019 and acquired upper",
    "start": "1962399",
    "end": "1969630"
  },
  {
    "text": "class hotel I happened to to live in and the lower key is used to basically",
    "start": "1969630",
    "end": "1975600"
  },
  {
    "text": "everywhere instead of the normal human you can use it like in the elevator in your rooms in the fitness center so we",
    "start": "1975600",
    "end": "1982590"
  },
  {
    "text": "got the mobile key and analyze the TNS and being in traffic as we have shown before in various cases so here's a dump",
    "start": "1982590",
    "end": "1989190"
  },
  {
    "text": "from the mitten proxy tool and you can see there's something called a mobile key insulation data and it starts this",
    "start": "1989190",
    "end": "1996630"
  },
  {
    "text": "DT and Zander some bytes this is only the beginnings of like 40 bytes of this following and when we compared the key",
    "start": "1996630",
    "end": "2004190"
  },
  {
    "text": "we received from the back end in this DT field but the key we saw on the area immediately noticed oh it's the same key",
    "start": "2004190",
    "end": "2012269"
  },
  {
    "text": "so would it be that simple that it just sends the key over-the-air so you could replay so we looked at the full recording and realized no there's much",
    "start": "2012269",
    "end": "2019469"
  },
  {
    "text": "more going on so in the middle of actually the full key we got from the back end so that of course was an",
    "start": "2019469",
    "end": "2025289"
  },
  {
    "text": "indicator this will be fishy there is something not so good if the only secret",
    "start": "2025289",
    "end": "2030869"
  },
  {
    "text": "the app has is going over the air there must be a way to break it but looking at the rest we saw there's lots of data we",
    "start": "2030869",
    "end": "2037649"
  },
  {
    "text": "don't understand so we had to look into that further my career tell about you how we did it yeah exactly so um there",
    "start": "2037649",
    "end": "2045239"
  },
  {
    "text": "seem to be some we play protection in the protocol as well as you can see here",
    "start": "2045239",
    "end": "2052108"
  },
  {
    "text": "there's that seem to be some kind of checksum there was also the MAC address",
    "start": "2052109",
    "end": "2057599"
  },
  {
    "text": "of the lock transmitted and some values have changed all the time",
    "start": "2057599",
    "end": "2063690"
  },
  {
    "text": "at that time we assume there will be announced and the CRC or some type of checksum or an edge mac maybe but yeah",
    "start": "2063690",
    "end": "2072799"
  },
  {
    "text": "we tried COCs if you want to do this",
    "start": "2072799",
    "end": "2077878"
  },
  {
    "text": "there's some tools available on the Internet for example this CSE reverse engineering",
    "start": "2077879",
    "end": "2083118"
  },
  {
    "text": "tool we just used a custom Python script and then we assumed that 16 bits may be",
    "start": "2083119",
    "end": "2090388"
  },
  {
    "text": "the nulls and 16 bits maybe ECOC have a script that matches that searches",
    "start": "2090389",
    "end": "2097950"
  },
  {
    "text": "for match and at least two of the messages we got yes and basically it was",
    "start": "2097950",
    "end": "2103260"
  },
  {
    "text": "exactly like this we found the Panola polynomial we also",
    "start": "2103260",
    "end": "2110779"
  },
  {
    "text": "saw that seat value the seat value that's the initial value when you",
    "start": "2110779",
    "end": "2116670"
  },
  {
    "text": "calculate a CSE that was something that was transmitted over the TLS session and",
    "start": "2116670",
    "end": "2122970"
  },
  {
    "text": "that's something that's constant within the hotel's called SCE think it's",
    "start": "2122970",
    "end": "2128339"
  },
  {
    "text": "something like system code for the next CSEE on the other hand they use the",
    "start": "2128339",
    "end": "2133619"
  },
  {
    "text": "previous value as a seat so we were able to transmit the first packets but then",
    "start": "2133619",
    "end": "2143250"
  },
  {
    "text": "there's the packet that contains the key and that was a little bit more difficult",
    "start": "2143250",
    "end": "2148940"
  },
  {
    "text": "we did not initially find the two bytes that are the correct two values for",
    "start": "2148940",
    "end": "2155340"
  },
  {
    "text": "these two bytes to transmit this key correctly basically we had one block",
    "start": "2155340",
    "end": "2162690"
  },
  {
    "text": "where the CSE was obviously not at the end some constant bytes some some zero",
    "start": "2162690",
    "end": "2167700"
  },
  {
    "text": "bytes and three previous year C values and yeah that was a little bit of a puzzle but basically it's not that",
    "start": "2167700",
    "end": "2174870"
  },
  {
    "text": "difficult they use the previous values and calculated again at the same",
    "start": "2174870",
    "end": "2180600"
  },
  {
    "text": "algorithm as you see and over wrote this with zeros so yeah now we knew how to",
    "start": "2180600",
    "end": "2188250"
  },
  {
    "text": "create this credential packet we could verify that with a lot of choices we had taken before again we created a Python",
    "start": "2188250",
    "end": "2197460"
  },
  {
    "text": "script to send this I put just take the device name it would take these",
    "start": "2197460",
    "end": "2203730"
  },
  {
    "text": "credential bytes that we could sniff out of the air and I calculate the CC and using Boop I go talk to the lock we",
    "start": "2203730",
    "end": "2211590"
  },
  {
    "text": "tried this this shows how we actually got the key out of the air so I was",
    "start": "2211590",
    "end": "2219960"
  },
  {
    "text": "nothing set up you see the three surfing boards and in this case I simulated",
    "start": "2219960",
    "end": "2227040"
  },
  {
    "text": "customer purse on the inside of the door because that's a little bit suspicious if you set this up in the hotel floor",
    "start": "2227040",
    "end": "2234810"
  },
  {
    "text": "and outside in the hall but anyway yeah you can see we we got the bites our skip",
    "start": "2234810",
    "end": "2241740"
  },
  {
    "text": "would take these bytes then we tried it we like yes so we had put sea bytes we",
    "start": "2241740",
    "end": "2250260"
  },
  {
    "text": "sniffed on the air into our tool and then we thought okay let's step out of the room take our laptop and try to run our",
    "start": "2250260",
    "end": "2257160"
  },
  {
    "text": "script against the real thing this is actually real our Python script running",
    "start": "2257160",
    "end": "2262350"
  },
  {
    "text": "on the laptop and the actual hotel door person mates not getting too suspicious because we are in very quickly as you",
    "start": "2262350",
    "end": "2268260"
  },
  {
    "text": "can see and it turned out oh we actually reached quite a nice acceptable 37th",
    "start": "2268260",
    "end": "2274860"
  },
  {
    "text": "floor 500 dollar hotel suite with our CSC to attack so this system basically must",
    "start": "2274860",
    "end": "2281890"
  },
  {
    "text": "pound by reversing CICS and this again",
    "start": "2281890",
    "end": "2287319"
  },
  {
    "text": "is showing that security by obscurity is not the way to go for these kinds of",
    "start": "2287319",
    "end": "2292839"
  },
  {
    "text": "things so once we have this running we sort out let's analyze a little bit more",
    "start": "2292839",
    "end": "2297849"
  },
  {
    "text": "go deeper into it and we did again what we did earlier write a Python script as",
    "start": "2297849",
    "end": "2302890"
  },
  {
    "text": "a test target so instead we're having a script now to open the lock we also build a script to emulate the lock so",
    "start": "2302890",
    "end": "2309069"
  },
  {
    "text": "with this script we could play with some real app and our simulation now at home and analyze this version so we wanted to",
    "start": "2309069",
    "end": "2316569"
  },
  {
    "text": "know how big is this problem so it's a such this one hotel that we found out is",
    "start": "2316569",
    "end": "2321969"
  },
  {
    "text": "it more so with some digging around he found us a few more hotel change which were starting to deploy this product",
    "start": "2321969",
    "end": "2327999"
  },
  {
    "text": "because we always has to see this is very new we're very lucky that we got set this early because it wasn't",
    "start": "2327999",
    "end": "2333549"
  },
  {
    "text": "deployed like in a thousand hotels so far sorry for that if you expected that but it's very emerging technology one",
    "start": "2333549",
    "end": "2339880"
  },
  {
    "text": "thing was very funny or interesting for us is that you could actually see it by the names of the locks the locks",
    "start": "2339880",
    "end": "2346660"
  },
  {
    "text": "announced the 60 base 64 names that you could decode to binary and then found a",
    "start": "2346660",
    "end": "2352599"
  },
  {
    "text": "certain pattern so we could actually from the outside check if a hotel uses the vulnerable system or not so imagine",
    "start": "2352599",
    "end": "2359589"
  },
  {
    "text": "us for going around with Bluetooth sniffers and checking hotels for for the system and we found actually a few human",
    "start": "2359589",
    "end": "2367059"
  },
  {
    "text": "rooms and then we booked one of the rooms in one of the hotels we identified as also vulnerable and found an even",
    "start": "2367059",
    "end": "2373059"
  },
  {
    "text": "simpler variation of the protocol which did the first handshake and not this last CSC variation so there's variations",
    "start": "2373059",
    "end": "2379749"
  },
  {
    "text": "of that and at that time we also realized the manufacturer which actually is a company messerschmitt in Germany",
    "start": "2379749",
    "end": "2385719"
  },
  {
    "text": "and say so there are no wrong expectations that they have like 2000",
    "start": "2385719",
    "end": "2390789"
  },
  {
    "text": "hotels that apply locks to but they're also going for quite upper-class hotels and those upper-class hotels are not so",
    "start": "2390789",
    "end": "2397180"
  },
  {
    "text": "much interested in Bluetooth locks they want the customers to comes on the desks so it's in the lower level change or mid",
    "start": "2397180",
    "end": "2405819"
  },
  {
    "text": "class change because they don't really provide lower level so in those mid class change the beginning to roll it",
    "start": "2405819",
    "end": "2411489"
  },
  {
    "text": "out so it's not so many hotels currently and luckily we informed them but we thought",
    "start": "2411489",
    "end": "2418990"
  },
  {
    "text": "about okay is this real real problem can you really do this in in real life so we tried about how would that look in real",
    "start": "2418990",
    "end": "2425920"
  },
  {
    "text": "life doing an exploitation of course one thing you don't have to do is to sniffs the key using the bill ejects at work",
    "start": "2425920",
    "end": "2432760"
  },
  {
    "text": "try to find an hour in room setup it's the only thing you have to know in advance is the Bluetooth address of the",
    "start": "2432760",
    "end": "2438640"
  },
  {
    "text": "lock you want to sniff so you have to go to the lock before identify this lock I'm going to sniff so probably if you",
    "start": "2438640",
    "end": "2444609"
  },
  {
    "text": "follow someone to his room that wouldn't be so good you would have to know all the MAC addresses of all rooms so we",
    "start": "2444609",
    "end": "2449710"
  },
  {
    "text": "start about other places where you could sniffing if you thought about the fitness center if people go to the gym and then we start oh there might be",
    "start": "2449710",
    "end": "2457210"
  },
  {
    "text": "options to hide a hider sniffing device somewhere you see a lot of options there we went for something quite near to the",
    "start": "2457210",
    "end": "2463090"
  },
  {
    "text": "door there's a plastic trash can liner and you couldn't put a sniffer set up right to the bottom of it so we thought",
    "start": "2463090",
    "end": "2469690"
  },
  {
    "text": "okay let's put it there go to the other wise other side of the store and try this out and we figured the fitness",
    "start": "2469690",
    "end": "2477010"
  },
  {
    "text": "center does not support ble we later found out in communication we see hotel which was very good by the way thank you",
    "start": "2477010",
    "end": "2483310"
  },
  {
    "text": "for the general manager who we've replied good to our research it was vandalized for some reason it was out of",
    "start": "2483310",
    "end": "2489369"
  },
  {
    "text": "service right when we wanted to try it oh my god so we were where else could we do it oh that's the elevator everybody",
    "start": "2489369",
    "end": "2495430"
  },
  {
    "text": "who lives in a hotel like you all currently do knows if you go to an elevator you have to activate the",
    "start": "2495430",
    "end": "2500680"
  },
  {
    "text": "elevator so people will do this visitor app of course and unlike a rumor fitness",
    "start": "2500680",
    "end": "2506530"
  },
  {
    "text": "center if there's someone standing next to you in the elevator having a backpack you wouldn't think he's currently",
    "start": "2506530",
    "end": "2512230"
  },
  {
    "text": "stealing your key so that's very like in a possible attack and one thing we even found out we realized this if we use our",
    "start": "2512230",
    "end": "2520270"
  },
  {
    "text": "simulator which imposes as a lock in the elevator and just by heavenly Bluetooth",
    "start": "2520270",
    "end": "2525970"
  },
  {
    "text": "advertising the app of a user would probably connect to our a paisa script",
    "start": "2525970",
    "end": "2531760"
  },
  {
    "text": "instead of the real lock so this attack actually could be carried out without any special hardware at all you just",
    "start": "2531760",
    "end": "2538540"
  },
  {
    "text": "need a standard Linux laptop or other laptop with Bluetooth capabilities runs a person script on it so here we run our",
    "start": "2538540",
    "end": "2545260"
  },
  {
    "text": "person simulator script tell him imposed this lock and it really happy me record as it seems the bottom the key",
    "start": "2545260",
    "end": "2552040"
  },
  {
    "text": "for us so this key again then can be used to break into the room so that was the point we said okay this is a real",
    "start": "2552040",
    "end": "2557830"
  },
  {
    "text": "thing we have to do a responsible disclosure process because it could actually harm people if it's getting in",
    "start": "2557830",
    "end": "2564190"
  },
  {
    "text": "a wider use so like in early April or mid of April we contacted the vendor and",
    "start": "2564190",
    "end": "2570910"
  },
  {
    "text": "we have to say very luckily he directly responded we know people who had other communication with disclosure he had",
    "start": "2570910",
    "end": "2577420"
  },
  {
    "text": "really immediate response we put some research into finding the right person who to contact but he said yeah I'm the",
    "start": "2577420",
    "end": "2583450"
  },
  {
    "text": "right person please tell me more we sent technical details to them they thought about it said our technician",
    "start": "2583450",
    "end": "2589480"
  },
  {
    "text": "says that can't really works that way but he somehow understand what we're doing so we said ok believe me we did",
    "start": "2589480",
    "end": "2596200"
  },
  {
    "text": "within the real hotel it's not theoretical and we sent our proof of concept code so then he said ok obvious",
    "start": "2596200",
    "end": "2602920"
  },
  {
    "text": "a real Singh and started very well with us beginning to discuss how do we work on that and we really thankful he never",
    "start": "2602920",
    "end": "2609700"
  },
  {
    "text": "tried to prevent this closure and even so this vulnerability currently is unfixed so this is real all day here we",
    "start": "2609700",
    "end": "2617680"
  },
  {
    "text": "think it's not so dangerous because the real user base as we have shown in a show of hands is not so big so the real",
    "start": "2617680",
    "end": "2624400"
  },
  {
    "text": "danger is not here yet because they got it very early so we can still discloses here and the fixing is on the way I",
    "start": "2624400",
    "end": "2631300"
  },
  {
    "text": "think in the running of this month probably hotels we have been in will be fixed because the vendor very well",
    "start": "2631300",
    "end": "2637080"
  },
  {
    "text": "reacting to our disclosure but it's not that easy the locks in the first hotel",
    "start": "2637080",
    "end": "2642370"
  },
  {
    "text": "we have been in there can be updated online because of the very modern high-rise hotels where a 6000 rooms or",
    "start": "2642370",
    "end": "2649840"
  },
  {
    "text": "something so they are online and can be updated remotely it's a smaller hotel it was like here's the hotel locks are",
    "start": "2649840",
    "end": "2656050"
  },
  {
    "text": "individually in the door they are not connected so someone has to go from door to door to door to upgrade them and that",
    "start": "2656050",
    "end": "2662530"
  },
  {
    "text": "only can start after the fix is developed so this will take a little bit more time and of course as we said",
    "start": "2662530",
    "end": "2667810"
  },
  {
    "text": "earlier there's multiple app vendors who have to integrate this SDK it's not such a vendor who's building the apps as",
    "start": "2667810",
    "end": "2673990"
  },
  {
    "text": "multiple parties involved so one lesson we learned from the responsible disclosure",
    "start": "2673990",
    "end": "2679550"
  },
  {
    "text": "and that is really important is that you have not to only identify the vendor but only see who is else involved in the",
    "start": "2679550",
    "end": "2686720"
  },
  {
    "text": "thing we found out there's multiple parties building the apps there is",
    "start": "2686720",
    "end": "2692300"
  },
  {
    "text": "multiple hotel chains those hotel chains around the hotel groups and our responsibilities closure to the vendor",
    "start": "2692300",
    "end": "2698360"
  },
  {
    "text": "didn't immediately react in all of them identifying those other parties actually",
    "start": "2698360",
    "end": "2706370"
  },
  {
    "text": "there we found out just last week that there's another vendor who built basically on the original design of the",
    "start": "2706370",
    "end": "2713480"
  },
  {
    "text": "sing another lock so they got a quite short notice now but as we said it's an",
    "start": "2713480",
    "end": "2719150"
  },
  {
    "text": "early early stage of development so that's really the lesson learned through",
    "start": "2719150",
    "end": "2724670"
  },
  {
    "text": "this communication do the research and so our I would takeaways for this event",
    "start": "2724670",
    "end": "2730400"
  },
  {
    "text": "here is you should really know the Billy link layer can be smooth reliable with cheap tools so I'm not sure if the",
    "start": "2730400",
    "end": "2738410"
  },
  {
    "text": "people who design such protocol knew but many probably did not really consider this Bruce is really a saying to",
    "start": "2738410",
    "end": "2744440"
  },
  {
    "text": "consider it can be Smith don't rely on the link layer do application crypto the other thing is don't hide any secrets in",
    "start": "2744440",
    "end": "2751580"
  },
  {
    "text": "your app neither the algorithm nor keys or anything like that if it's in the app",
    "start": "2751580",
    "end": "2758630"
  },
  {
    "text": "people can get it out you earlier seen our reverse engineering possibilities",
    "start": "2758630",
    "end": "2763940"
  },
  {
    "text": "so whatever clicked try to build it in a way you could publish everything just",
    "start": "2763940",
    "end": "2769280"
  },
  {
    "text": "the secrets key which I only notice the user should secure it and to sing for the research community or whatever also",
    "start": "2769280",
    "end": "2777500"
  },
  {
    "text": "as a security into this year being e is not just padlocks or Chinese toys it's",
    "start": "2777500",
    "end": "2783770"
  },
  {
    "text": "more and more used in real world applications and all of you and hopefully you now can with following our",
    "start": "2783770",
    "end": "2790250"
  },
  {
    "text": "presentation should audit these things that look into this more and I can just say it again the slides will be online",
    "start": "2790250",
    "end": "2796790"
  },
  {
    "text": "there's lots of links in it so if you couldn't follow everything now in this very short runs through lots of various",
    "start": "2796790",
    "end": "2803900"
  },
  {
    "text": "concept look up the flights look up the methods it's really not so hard to get into we have multiple ways to attack sis",
    "start": "2803900",
    "end": "2810740"
  },
  {
    "text": "multiple layers you can go there so it's really worth doing it and we hope you enjoyed it and are going to",
    "start": "2810740",
    "end": "2817320"
  },
  {
    "text": "have fun with blue and P elements and that our presentation so he actually",
    "start": "2817320",
    "end": "2829710"
  },
  {
    "text": "have like three minutes for questions so please the people leaving now be quiet so people wanting to ask questions can",
    "start": "2829710",
    "end": "2835890"
  },
  {
    "text": "go to the mics they have three minutes for questions please feel free to cancel or contractors yeah you have an email",
    "start": "2835890",
    "end": "2842880"
  },
  {
    "text": "letter C so if you're involved with any vendor or anything if you worried so just email to us this address probably",
    "start": "2842880",
    "end": "2849270"
  },
  {
    "text": "the next date or a Def Con so don't expect an immediate answer but first the direct option would be to go to the mics",
    "start": "2849270",
    "end": "2855270"
  },
  {
    "text": "and ask some questions it's hard to see",
    "start": "2855270",
    "end": "2861680"
  },
  {
    "text": "but just open slots so think we",
    "start": "2861680",
    "end": "2870330"
  },
  {
    "text": "overloaded you all at end of blackhead here but it's the last slot so probably that's acceptable or you couldn't also",
    "start": "2870330",
    "end": "2880080"
  },
  {
    "text": "just free close this here come to the stage and we walk over to the developer room where we can do some private",
    "start": "2880080",
    "end": "2885480"
  },
  {
    "text": "conversations okay thank you everyone but some more questions",
    "start": "2885480",
    "end": "2892039"
  }
]