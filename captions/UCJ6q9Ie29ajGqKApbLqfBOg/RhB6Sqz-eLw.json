[
  {
    "start": "0",
    "end": "36000"
  },
  {
    "text": "[Music]",
    "start": "1180",
    "end": "14730"
  },
  {
    "text": "hello and thank you for joining our our session by passing next generation anti-viruses for fun and profit",
    "start": "16160",
    "end": "23439"
  },
  {
    "text": "i'm ishai the head of deep learning at deep instinct and with me would present a [Music]",
    "start": "23439",
    "end": "30160"
  },
  {
    "text": "data scientist and security researcher in the deep instinct the deep learning group",
    "start": "30160",
    "end": "37120"
  },
  {
    "start": "36000",
    "end": "144000"
  },
  {
    "text": "our outline is as follows we are going to implement an end-to-end adversarial attack that generates runnable pes that",
    "start": "37120",
    "end": "44480"
  },
  {
    "text": "evades next-generation anti-viruses which using the static pe features uh in order to maintain the",
    "start": "44480",
    "end": "52000"
  },
  {
    "text": "malicious functionality we'll split split our vessel example into two phases the first we would assess the",
    "start": "52000",
    "end": "58480"
  },
  {
    "text": "impact of different features for the that would be used by the malware",
    "start": "58480",
    "end": "63840"
  },
  {
    "text": "classifier and then we'll do a feature specific modification only on features that can be modified",
    "start": "63840",
    "end": "69520"
  },
  {
    "text": "without having the malicious business functionality finally we will show and demonstrate that a",
    "start": "69520",
    "end": "76320"
  },
  {
    "text": "modified a pe can evade not just the target a mirror classifier but also other malware",
    "start": "76320",
    "end": "83360"
  },
  {
    "text": "classifiers using the property of transferability which we will discuss further in in the following slides",
    "start": "83360",
    "end": "91119"
  },
  {
    "text": "uh our agenda would be as follows first we will discuss about the the differences and similarities between",
    "start": "91119",
    "end": "98640"
  },
  {
    "text": "bypassing next-generation anti-virus and a traditional machine and traditional anti-malware software",
    "start": "98640",
    "end": "106240"
  },
  {
    "text": "then we'll discuss a bit about adversarial learning and what does it mean in the context of static malware classifiers",
    "start": "106240",
    "end": "112000"
  },
  {
    "text": "we will talk about the unique challenges of adversarial learning in the cyber security domain we will present our own adversarial uh",
    "start": "112000",
    "end": "121119"
  },
  {
    "text": "attack based on explainability we will talk about the two main challenges the lack of knowledge of the attacker of the",
    "start": "121119",
    "end": "128239"
  },
  {
    "text": "architecture and features and the needs to keep the malicious functionality intact",
    "start": "128239",
    "end": "133920"
  },
  {
    "text": "and finally we we will hand over to shai to see a concrete example of bypassing a",
    "start": "133920",
    "end": "141440"
  },
  {
    "text": "real-life commercial next generation antivirus so let's start by by talking about the",
    "start": "141440",
    "end": "148319"
  },
  {
    "start": "144000",
    "end": "253000"
  },
  {
    "text": "similarities and differences between bypassing natural generation antibiotics and bypassing a traditional anti-malware",
    "start": "148319",
    "end": "154400"
  },
  {
    "text": "product first of all we are using different techniques and tools in traditional",
    "start": "154400",
    "end": "163680"
  },
  {
    "text": "in a antivirus bypass we are using a disassembly debugging",
    "start": "163680",
    "end": "170400"
  },
  {
    "text": "and packing and in next generation anti-virus bypass using a techniques",
    "start": "170400",
    "end": "176640"
  },
  {
    "text": "say data science techniques such as explanability building a surrogate model and generating perturbation",
    "start": "176640",
    "end": "184239"
  },
  {
    "text": "the end result is is the same by passing the defender software whether",
    "start": "184239",
    "end": "191120"
  },
  {
    "text": "it's next-generation anti-anti-virus or a regular anti-malware software which",
    "start": "191120",
    "end": "197120"
  },
  {
    "text": "has minimal effort on to the attacker's side and the methodology of the tools are",
    "start": "197120",
    "end": "204480"
  },
  {
    "text": "basically the same whether you're using disassembling or explainability algorithm you want",
    "start": "204480",
    "end": "209760"
  },
  {
    "text": "to see a basic non-interactive understanding of what happened of the business logic",
    "start": "209760",
    "end": "216239"
  },
  {
    "text": "of the defender software whether you're using debugging or serogate model meaning building a model to simulate the malware",
    "start": "216239",
    "end": "223680"
  },
  {
    "text": "classifier you are trying to to perform a interactive in interactive analysis",
    "start": "223680",
    "end": "231519"
  },
  {
    "text": "or interactive experiments of the software and trying to understand what would work in order to bypass it",
    "start": "231519",
    "end": "237760"
  },
  {
    "text": "and the packing or generating perturbation are two techniques each in its own",
    "start": "237760",
    "end": "244319"
  },
  {
    "text": "domain that allows you to bypass a marble classifier without",
    "start": "244319",
    "end": "249360"
  },
  {
    "text": "uh harming the malicious business logic so what is adversarial learning in the",
    "start": "249360",
    "end": "256239"
  },
  {
    "start": "253000",
    "end": "449000"
  },
  {
    "text": "context of a of malware classifiers so first of all adversarial learning or",
    "start": "256239",
    "end": "263040"
  },
  {
    "text": "adversary can take place in one of two phases it can take place either in the learning phase in which",
    "start": "263040",
    "end": "269280"
  },
  {
    "text": "there is training data being inserted into machine learning algorithm and from this a model is being produced",
    "start": "269280",
    "end": "276720"
  },
  {
    "text": "so if you inject a malicious or sometimes called poisoned poison data",
    "start": "276720",
    "end": "284080"
  },
  {
    "text": "and therefore the attack is sometimes called poisoning attack into the machine learning algorithm it will train on it and will",
    "start": "284080",
    "end": "290240"
  },
  {
    "text": "create a poisoned model which would underperform the on samples that are similar to the",
    "start": "290240",
    "end": "296560"
  },
  {
    "text": "injected samples however this form of attack the poisoning attack",
    "start": "296560",
    "end": "302400"
  },
  {
    "text": "requires a lot of efforts from the from the attacker and while it for",
    "start": "302400",
    "end": "308880"
  },
  {
    "text": "instance access to the data pipeline of the training of the model and while it is possible in eg",
    "start": "308880",
    "end": "318160"
  },
  {
    "text": "supply chain attacks it's a highly unlikely and therefore will focus on the other phase and the prediction",
    "start": "318160",
    "end": "324639"
  },
  {
    "text": "phase attack in which they sometimes called invasion attacks in which case that the attacker doesn't change or modify",
    "start": "324639",
    "end": "331520"
  },
  {
    "text": "the model in any way but he modified the malware that is being presented",
    "start": "331520",
    "end": "336639"
  },
  {
    "text": "to the malware classifier by removing modifying or adding",
    "start": "336639",
    "end": "342000"
  },
  {
    "text": "features and this is sometimes called perturbation in order to affect the way the model",
    "start": "342000",
    "end": "347680"
  },
  {
    "text": "classified this specific circuit the basic idea behind this is",
    "start": "347680",
    "end": "354880"
  },
  {
    "text": "that the malware is a the model classifier is being trained on",
    "start": "354880",
    "end": "360479"
  },
  {
    "text": "a certain distribution and therefore it has a different decision boundary then the optimal decision boundary and",
    "start": "360479",
    "end": "366880"
  },
  {
    "text": "the perturbation try to leverage uh to leverage this now in the context of static malware",
    "start": "366880",
    "end": "373840"
  },
  {
    "text": "classifiers static analysis uh malware classifiers the the basic premise is as follows you",
    "start": "373840",
    "end": "381280"
  },
  {
    "text": "cannot train a malware classifier that will take all the files into",
    "start": "381280",
    "end": "389120"
  },
  {
    "text": "a and turn it all into features in most in most cases the the",
    "start": "389120",
    "end": "396720"
  },
  {
    "text": "computers or the machine have only limited amount of gpu of ram of cpu and therefore you are",
    "start": "396720",
    "end": "404400"
  },
  {
    "text": "picking only handful of selected feature the most indicative feature",
    "start": "404400",
    "end": "409759"
  },
  {
    "text": "now because of this those features are quote unquote circumstantial evidence",
    "start": "409759",
    "end": "416240"
  },
  {
    "text": "you cannot handle everything and for instance while you can take very impactful feature features such as",
    "start": "416240",
    "end": "423680"
  },
  {
    "text": "import address table you would not be able to use a to build the entire call flow graph in",
    "start": "423680",
    "end": "430560"
  },
  {
    "text": "order to see the interdependencies between different functions because it takes too much memory and therefore",
    "start": "430560",
    "end": "435759"
  },
  {
    "text": "because of those circumstantial photovoltaic substantial features you can bypass bypass them in",
    "start": "435759",
    "end": "443120"
  },
  {
    "text": "and modify them in a way that would not harm the malicious functionality of the world",
    "start": "443120",
    "end": "450720"
  },
  {
    "start": "449000",
    "end": "521000"
  },
  {
    "text": "let's talk a bit about the challenges of adversarial learning in the cyber security domain besides the regular chances we have two",
    "start": "450720",
    "end": "457039"
  },
  {
    "text": "main challenges one is the attacker lack of knowledge of the classifier",
    "start": "457039",
    "end": "462800"
  },
  {
    "text": "and this is because unlike in the computer vision domain when the architecture our public domain",
    "start": "462800",
    "end": "468240"
  },
  {
    "text": "in the cyber security domain every uh next generation antivirus uses slightly",
    "start": "468240",
    "end": "473520"
  },
  {
    "text": "different features they are much more a feature to be used not just the pixel colors",
    "start": "473520",
    "end": "481280"
  },
  {
    "text": "also import address table entries uh dynamic api calls",
    "start": "481280",
    "end": "487520"
  },
  {
    "text": "p structural metadata etc the second the the second difference",
    "start": "487520",
    "end": "494800"
  },
  {
    "text": "is the original emulation functionality must remain intact and unlike in a picture when you can modify",
    "start": "494800",
    "end": "501759"
  },
  {
    "text": "a every pixel without a affecting it's still a valid a valid image you cannot arbitrarily",
    "start": "501759",
    "end": "509520"
  },
  {
    "text": "change a byte inside the pe while maintaining its its functionality",
    "start": "509520",
    "end": "515120"
  },
  {
    "text": "it might cause excess violation or illegal instruction exceptions let's talk a bit about",
    "start": "515120",
    "end": "524000"
  },
  {
    "start": "521000",
    "end": "590000"
  },
  {
    "text": "our own uh end-to-end adversarial attack first of all the threat model we are",
    "start": "524000",
    "end": "530320"
  },
  {
    "text": "using as mentioned static analysis on our classifier the adversary has no knowledge about the",
    "start": "530320",
    "end": "537040"
  },
  {
    "text": "attacker the the defender classifier type architecture and training set",
    "start": "537040",
    "end": "542640"
  },
  {
    "text": "the adversary does know the prediction score given by their tactical model meaning it's a grey box attack",
    "start": "542640",
    "end": "549040"
  },
  {
    "text": "it doesn't know just the label but also the the confidence score the adversary has limited knowledge",
    "start": "549040",
    "end": "554560"
  },
  {
    "text": "about the the input feature he must have a non-empty a subset of",
    "start": "554560",
    "end": "559839"
  },
  {
    "text": "feature that he would be able to modify and would affect the marble classifier and how he does gain",
    "start": "559839",
    "end": "566880"
  },
  {
    "text": "this insight will show shortly the adversary has access to a data set of benign and malicious samples",
    "start": "566880",
    "end": "573120"
  },
  {
    "text": "and this is in order to to find the proper value to which to change",
    "start": "573120",
    "end": "578240"
  },
  {
    "text": "the modified features and the adversary has no access to the source code of the",
    "start": "578240",
    "end": "583360"
  },
  {
    "text": "sample he wish to modify and this is in order to to make it easy the attack easier to",
    "start": "583360",
    "end": "588959"
  },
  {
    "text": "use by a larger audience let's talk about the the different",
    "start": "588959",
    "end": "594080"
  },
  {
    "start": "590000",
    "end": "648000"
  },
  {
    "text": "challenges we specified before first of all the lack of knowledge of the attacked model we can",
    "start": "594080",
    "end": "601680"
  },
  {
    "text": "mitigate this attack by using explainability algorithm expandability algorithms is algorithm that",
    "start": "601680",
    "end": "607360"
  },
  {
    "text": "gets as input a a classifier either black box or white",
    "start": "607360",
    "end": "613279"
  },
  {
    "text": "box and does produce the list of most impactful feature for a specific",
    "start": "613279",
    "end": "618880"
  },
  {
    "text": "sample in our case the malware example that we want to uh we want to to evade the the marble",
    "start": "618880",
    "end": "625440"
  },
  {
    "text": "classifier in this in this example we see it in the computer vision domain when you see as a picture of a snake",
    "start": "625440",
    "end": "632560"
  },
  {
    "text": "being classified as gartner snake and we see three different explanability algorithm and all of them are showing a uh",
    "start": "632560",
    "end": "639760"
  },
  {
    "text": "highlighting the most impactful feature for this classification and you see that it's always the snake head",
    "start": "639760",
    "end": "646160"
  },
  {
    "text": "which does make sense additionally we can use the concept of a",
    "start": "646160",
    "end": "654160"
  },
  {
    "start": "648000",
    "end": "730000"
  },
  {
    "text": "result example transferability meaning if we create a modified malware aka adversal",
    "start": "654160",
    "end": "660800"
  },
  {
    "text": "example that evades a specific classifier classifier area it's more probable that it would also",
    "start": "660800",
    "end": "666720"
  },
  {
    "text": "fool other type of classifiers how we can leverage this ability we can",
    "start": "666720",
    "end": "672240"
  },
  {
    "text": "try to attack a classifier which we are more familiar with feature architecture etc",
    "start": "672240",
    "end": "679360"
  },
  {
    "text": "uh in our case we take the ember classifier which use a static a p e feature",
    "start": "679360",
    "end": "686480"
  },
  {
    "text": "such as be header metadata and other a feature that are used by a",
    "start": "686480",
    "end": "693279"
  },
  {
    "text": "many commercial next generation antiviruses we can attack this specific classifier",
    "start": "693279",
    "end": "698959"
  },
  {
    "text": "and then we can leverage the same successful attack and use the same modified",
    "start": "698959",
    "end": "704160"
  },
  {
    "text": "malware against our target classifier and in this case we can",
    "start": "704160",
    "end": "710480"
  },
  {
    "text": "have a very fast bootstrap of how to to find the feature we want",
    "start": "710480",
    "end": "717760"
  },
  {
    "text": "to update uh so i will present another technique we use the sliding window water that",
    "start": "717760",
    "end": "723279"
  },
  {
    "text": "would also help us uh to understand the target classifier",
    "start": "723279",
    "end": "728720"
  },
  {
    "text": "in a black box map the second challenge is keeping the malicious functionality in that",
    "start": "728720",
    "end": "734560"
  },
  {
    "text": "intact and in order to do this we split the adversarial example generation into three phases which are being",
    "start": "734560",
    "end": "741680"
  },
  {
    "text": "repeatedly used first we perform a data set analysis in order to understand the",
    "start": "741680",
    "end": "748000"
  },
  {
    "text": "values of a different feature we want to modify for instance import address table entries a section",
    "start": "748000",
    "end": "755519"
  },
  {
    "text": "name etc second we are finding the impact",
    "start": "755519",
    "end": "761440"
  },
  {
    "text": "of specific feature using either a either explainability algorithm or the",
    "start": "761440",
    "end": "767760"
  },
  {
    "text": "sliding window as i will demonstrate shortly then we use a feature specific",
    "start": "767760",
    "end": "773920"
  },
  {
    "text": "modification certain features can only be added for instance import address table",
    "start": "773920",
    "end": "780959"
  },
  {
    "text": "other features can be modified uh using a trampoline into the entry points etc",
    "start": "780959",
    "end": "788560"
  },
  {
    "text": "and we repeat those two phases iteratively those uh four",
    "start": "788560",
    "end": "795040"
  },
  {
    "text": "phases of dataset analysis existing feature expandability selecting and modifying a",
    "start": "795040",
    "end": "801839"
  },
  {
    "text": "feature and modify the subset would eventually bring us to an attack that uh evades and by",
    "start": "801839",
    "end": "808959"
  },
  {
    "text": "a bypass the target classifier and then we will use the transferability",
    "start": "808959",
    "end": "814320"
  },
  {
    "text": "a property to bypass even more next-generation anti-virus classifier",
    "start": "814320",
    "end": "820000"
  },
  {
    "text": "now to show a concrete use case of how we bypassed a commercial next-generation anti-virus",
    "start": "820000",
    "end": "826320"
  },
  {
    "text": "i'm handing over to shai thank you very much thank you shai hi my name is shai i'll",
    "start": "826320",
    "end": "832880"
  },
  {
    "text": "be presenting the second part of our presentation of bypassing a commercial ngiv",
    "start": "832880",
    "end": "839199"
  },
  {
    "text": "so we will start about discussing a little bit about the data set analysis which is a step that we",
    "start": "839199",
    "end": "847040"
  },
  {
    "start": "840000",
    "end": "978000"
  },
  {
    "text": "conducted in independently and here we want to uh find some information that will",
    "start": "847040",
    "end": "854399"
  },
  {
    "text": "help us change the classifier's verdict and we do that with the tools of data science",
    "start": "854399",
    "end": "861600"
  },
  {
    "text": "and we assume that all classifiers and all vendors they use similar data sets",
    "start": "861600",
    "end": "868480"
  },
  {
    "text": "we want to have a data set that we can investigate with a similar distribution",
    "start": "868480",
    "end": "874560"
  },
  {
    "text": "to what the commercial antivirus next generation antivirus uses",
    "start": "874560",
    "end": "880639"
  },
  {
    "text": "so it will reliably represent the distribution of the features also",
    "start": "880639",
    "end": "885680"
  },
  {
    "text": "and for this presentation we analyzed mostly",
    "start": "885680",
    "end": "892000"
  },
  {
    "text": "one feature which is the imports that are used in the benign dataset and",
    "start": "892000",
    "end": "898399"
  },
  {
    "text": "the malicious dataset and we used the other set that uh came from ember which is an academic",
    "start": "898399",
    "end": "907040"
  },
  {
    "text": "dataset with uh roughly one million samples",
    "start": "907040",
    "end": "912079"
  },
  {
    "text": "and we analyzed the import table of the benign and malicious and we applied",
    "start": "912079",
    "end": "918000"
  },
  {
    "text": "simple statistics to extract the how many",
    "start": "918000",
    "end": "923600"
  },
  {
    "text": "imports and which imports are appear in a benign population and malicious population the",
    "start": "923600",
    "end": "930560"
  },
  {
    "text": "imports themselves are not malicious of course they are simply api calls and they depend on the context",
    "start": "930560",
    "end": "938000"
  },
  {
    "text": "of usage and we ended up with the list",
    "start": "938000",
    "end": "943120"
  },
  {
    "text": "that uh can tell us which imports are mostly found in the binary population of",
    "start": "943120",
    "end": "949680"
  },
  {
    "text": "the benign population and the malicious population respectively so this table uh lists the",
    "start": "949680",
    "end": "956720"
  },
  {
    "text": "top three most prevalent b9 imports and top three most prevalent malicious",
    "start": "956720",
    "end": "962959"
  },
  {
    "text": "imports which you can see that they have a negative score and the positive score for the",
    "start": "962959",
    "end": "968800"
  },
  {
    "text": "more benign ones so we will use that later in one of in our attack as we will show",
    "start": "968800",
    "end": "976720"
  },
  {
    "text": "and the next question is how are we going to find which features are important for",
    "start": "976720",
    "end": "983920"
  },
  {
    "start": "978000",
    "end": "1066000"
  },
  {
    "text": "our classifier so we don't have access to the classifier we can only uh query for uh the score",
    "start": "983920",
    "end": "991600"
  },
  {
    "text": "uh we do assume that it's a um pe classifier uh and uh it has",
    "start": "991600",
    "end": "1000240"
  },
  {
    "text": "some inherent uh features that uh are due to the fact that it parses pe",
    "start": "1000240",
    "end": "1006160"
  },
  {
    "text": "files so we assume that uh it will use the header",
    "start": "1006160",
    "end": "1011680"
  },
  {
    "text": "various sections uh the overlay of the file the imports etc and in order to understand",
    "start": "1011680",
    "end": "1020560"
  },
  {
    "text": "which features are more important and we should perturb we use a surrogate model",
    "start": "1020560",
    "end": "1028079"
  },
  {
    "text": "and this is the model that uh released by ember and we also use uh the shop package",
    "start": "1028079",
    "end": "1035280"
  },
  {
    "text": "that will allow us to question the surrogate model and ask for the",
    "start": "1035280",
    "end": "1041360"
  },
  {
    "text": "specific sample which features are most influential for that classifier just note that",
    "start": "1041360",
    "end": "1049679"
  },
  {
    "text": "we're not asking the target classifier we're asking the surrogate classifier",
    "start": "1049679",
    "end": "1054880"
  },
  {
    "text": "about the future importance and here we present a list of the top 15",
    "start": "1054880",
    "end": "1061440"
  },
  {
    "text": "features with the highest shop score and let's try to make it uh",
    "start": "1061440",
    "end": "1069440"
  },
  {
    "start": "1066000",
    "end": "1153000"
  },
  {
    "text": "simpler and we will highlight with green features that are under a complete",
    "start": "1069440",
    "end": "1074880"
  },
  {
    "text": "control for example section names for example the header cuff timestamp um",
    "start": "1074880",
    "end": "1082880"
  },
  {
    "text": "with the orange highlight we highlight features that are we have some control over for example",
    "start": "1082880",
    "end": "1089360"
  },
  {
    "text": "we cannot easily remove or change import names uh import libraries",
    "start": "1089360",
    "end": "1097039"
  },
  {
    "text": "but we can add uh quite easily uh for the",
    "start": "1097039",
    "end": "1102640"
  },
  {
    "text": "purple highlight we show features that are uh we have indirect control over for",
    "start": "1102640",
    "end": "1108240"
  },
  {
    "text": "example if we change a character this specific character distribution we're also affecting other",
    "start": "1108240",
    "end": "1113840"
  },
  {
    "text": "characters distribution and for the red highlight those are features that virtually",
    "start": "1113840",
    "end": "1119679"
  },
  {
    "text": "impossible to change or extremely difficult to change so this is our highlights it's not",
    "start": "1119679",
    "end": "1127360"
  },
  {
    "text": "mutually exclusive and features can be can also change",
    "start": "1127360",
    "end": "1135280"
  },
  {
    "text": "our groups but for the general uh purpose of the demonstration this is uh",
    "start": "1135280",
    "end": "1140960"
  },
  {
    "text": "how we split the features and we have some good candidates to",
    "start": "1140960",
    "end": "1146080"
  },
  {
    "text": "start uh perturbing and changing and we will see",
    "start": "1146080",
    "end": "1151280"
  },
  {
    "text": "our next method of the sliding attack window so in this method we're",
    "start": "1151280",
    "end": "1158720"
  },
  {
    "text": "trying to detect which parts of the pe are the most",
    "start": "1158720",
    "end": "1164799"
  },
  {
    "text": "influential and this time we're querying the target",
    "start": "1164799",
    "end": "1170000"
  },
  {
    "text": "classifier and not the surrogate one and we simply slide a window",
    "start": "1170000",
    "end": "1177520"
  },
  {
    "text": "we can either zero out the entire window or scramble strings if we find in the",
    "start": "1177520",
    "end": "1184080"
  },
  {
    "text": "window and we pass that new modified pe to the classifier",
    "start": "1184080",
    "end": "1189919"
  },
  {
    "text": "and ask him what is the prediction now what is the score so for this kind of",
    "start": "1189919",
    "end": "1196000"
  },
  {
    "text": "attack we don't need a pe to be functional in any sort of way we're just interested to",
    "start": "1196000",
    "end": "1201120"
  },
  {
    "text": "see which areas of the pe have the highest impact on the score so",
    "start": "1201120",
    "end": "1207360"
  },
  {
    "text": "why does it make sense as i [Music]",
    "start": "1207360",
    "end": "1212480"
  },
  {
    "text": "explained in the first part of the presentation a lot of classifiers use circumstantial",
    "start": "1212480",
    "end": "1218880"
  },
  {
    "text": "evidence that they collect from the pe header and it is very difficult to understand",
    "start": "1218880",
    "end": "1224080"
  },
  {
    "text": "for example if a string is actually going to be resolved to an import",
    "start": "1224080",
    "end": "1230000"
  },
  {
    "text": "later dynamically or it has some other meaning so all of this information is collected and",
    "start": "1230000",
    "end": "1236400"
  },
  {
    "text": "uh calculated by the classifier to the final score so by hiding this uh information we can",
    "start": "1236400",
    "end": "1243039"
  },
  {
    "text": "understand what the classifier sees as the most important part or most influential",
    "start": "1243039",
    "end": "1248559"
  },
  {
    "text": "part of the file this attack is not easily applied on the",
    "start": "1248559",
    "end": "1254559"
  },
  {
    "text": "pe header simply because if the classifier expects to parse a p header then it will fail to",
    "start": "1254559",
    "end": "1260480"
  },
  {
    "text": "do so and the findings of this attack are not always very useful for example",
    "start": "1260480",
    "end": "1267360"
  },
  {
    "text": "if we discover that the code section has a very high impact on the score it's",
    "start": "1267360",
    "end": "1274559"
  },
  {
    "text": "not very easy and simple to change it so here we will show the illustration of",
    "start": "1274559",
    "end": "1281679"
  },
  {
    "start": "1278000",
    "end": "1338000"
  },
  {
    "text": "our sliding window attack or sliding window probing so we start with the malicious file",
    "start": "1281679",
    "end": "1289600"
  },
  {
    "text": "and the malicious is of course composed of the p header sections and an overlay and we pass that to the",
    "start": "1289600",
    "end": "1297520"
  },
  {
    "text": "classifier and we get our prediction our score and for this example it's minus one and",
    "start": "1297520",
    "end": "1305039"
  },
  {
    "text": "the blue rectangle uh illustrates the actual sliding window that we move along the way and each time",
    "start": "1305039",
    "end": "1312880"
  },
  {
    "text": "we uh either zero out or scramble uh the strings for this",
    "start": "1312880",
    "end": "1318960"
  },
  {
    "text": "specific example we used a 32 kilobyte sliding window and we only scrambled",
    "start": "1318960",
    "end": "1325039"
  },
  {
    "text": "the strings that we found in the window leaving all other data as is and finally what we want to do is",
    "start": "1325039",
    "end": "1333039"
  },
  {
    "text": "examine why uh the differences in the score occurred so let's start",
    "start": "1333039",
    "end": "1340000"
  },
  {
    "start": "1338000",
    "end": "1416000"
  },
  {
    "text": "playing and we will show now the output of the sliding window attack on the",
    "start": "1340000",
    "end": "1345200"
  },
  {
    "text": "sample so as you can see uh all the scores are uh still",
    "start": "1345200",
    "end": "1353280"
  },
  {
    "text": "very malicious but we have one score that is a little bit uh bigger",
    "start": "1353280",
    "end": "1361120"
  },
  {
    "text": "but not by much but we think that uh at this point it's very important to",
    "start": "1361120",
    "end": "1366960"
  },
  {
    "text": "look at the precision that the classifier has on the score and we change from 10 to the -11 precision",
    "start": "1366960",
    "end": "1373520"
  },
  {
    "text": "to 10 to the minus 3 precision and even though it doesn't look like much",
    "start": "1373520",
    "end": "1378960"
  },
  {
    "text": "but due to the non-linearity of the classifier this is very important and",
    "start": "1378960",
    "end": "1386400"
  },
  {
    "text": "now we'll try to understand what is the specific address and as we can see uh it",
    "start": "1386400",
    "end": "1392720"
  },
  {
    "text": "corresponds to the import table of the file and um",
    "start": "1392720",
    "end": "1398000"
  },
  {
    "text": "this also what this was what we saw with the shop package uh shop showed us that",
    "start": "1398000",
    "end": "1404480"
  },
  {
    "text": "import library and the import function are very high uh in the importance so both techniques",
    "start": "1404480",
    "end": "1411280"
  },
  {
    "text": "agree here and we can move on to the actual uh attack",
    "start": "1411280",
    "end": "1417840"
  },
  {
    "start": "1416000",
    "end": "1735000"
  },
  {
    "text": "for the actual attack we will attack several features of the p file here we",
    "start": "1418960",
    "end": "1425360"
  },
  {
    "text": "will explain a little bit about how we attack them so",
    "start": "1425360",
    "end": "1430400"
  },
  {
    "text": "the first one is the checksum and the checksum has no impact on the functionality of",
    "start": "1430400",
    "end": "1436559"
  },
  {
    "text": "the pe and usually correcting the checksum to the correct value",
    "start": "1436559",
    "end": "1441760"
  },
  {
    "text": "only improves the score and it's only relevant for a driver or a",
    "start": "1441760",
    "end": "1448000"
  },
  {
    "text": "critical dll which is out of the scope for us timestamp has no impact on the functionality",
    "start": "1448000",
    "end": "1454320"
  },
  {
    "text": "and although it's a d word or 4 bytes value",
    "start": "1454320",
    "end": "1459679"
  },
  {
    "text": "with a possible of 4 billion [Music] possibilities we here chose to",
    "start": "1459679",
    "end": "1466960"
  },
  {
    "text": "just pick up specific values where the timestamp reflect no longer",
    "start": "1466960",
    "end": "1472080"
  },
  {
    "text": "than 15 15 years in the past and for each year we uh divided it into 12 parts so we try",
    "start": "1472080",
    "end": "1480960"
  },
  {
    "text": "to match each month of the week of the year and this results only in 180 values that we",
    "start": "1480960",
    "end": "1487039"
  },
  {
    "text": "can simply check and uh conclude that attack very quickly",
    "start": "1487039",
    "end": "1494400"
  },
  {
    "text": "for new sections we can add new sections with specific characteristics as we",
    "start": "1494400",
    "end": "1500400"
  },
  {
    "text": "choose either to be a code section or data section and we can also generate buffers with",
    "start": "1500400",
    "end": "1508320"
  },
  {
    "text": "the desired entropies that we wish be it high entropy or low entropy",
    "start": "1508320",
    "end": "1514400"
  },
  {
    "text": "this attack usually did not very much improve the score in our favor",
    "start": "1514400",
    "end": "1520559"
  },
  {
    "text": "and we actually did not use it as a standalone attack entry",
    "start": "1520559",
    "end": "1527039"
  },
  {
    "text": "point trampoline um in this attack we can either uh insert a trampoline in the original",
    "start": "1527039",
    "end": "1534799"
  },
  {
    "text": "code section if we have enough slack space or uh insert a new section that jumps to",
    "start": "1534799",
    "end": "1541520"
  },
  {
    "text": "the original entry point of the file and this is what we used",
    "start": "1541520",
    "end": "1546960"
  },
  {
    "text": "and for the rest of the code section uh we simply pasted a",
    "start": "1546960",
    "end": "1554080"
  },
  {
    "text": "different code section from a very benign file from the os vendor",
    "start": "1554080",
    "end": "1559360"
  },
  {
    "text": "and we used our prologue and conditioned it with an always false",
    "start": "1559360",
    "end": "1567039"
  },
  {
    "text": "condition to the very benign code section and jump to the original code section of",
    "start": "1567039",
    "end": "1573760"
  },
  {
    "text": "the file so essentially the functionality remains the same and as you will probably notice",
    "start": "1573760",
    "end": "1581679"
  },
  {
    "text": "all the addresses all the virtual addresses and rbas will be incorrect in that sense",
    "start": "1581679",
    "end": "1588320"
  },
  {
    "text": "but it doesn't matter because it's very difficult for classifier to actually understand this information",
    "start": "1588320",
    "end": "1596960"
  },
  {
    "text": "from the code section and it is usually not done as you can see you will see uh shortly",
    "start": "1596960",
    "end": "1605760"
  },
  {
    "text": "for the new imports uh we had four methods of introducing new imports and",
    "start": "1605760",
    "end": "1611200"
  },
  {
    "text": "the inputs are of course taken from the list that we generated before",
    "start": "1611200",
    "end": "1616320"
  },
  {
    "text": "in the dataset analysis and the first method is the very well trivial one is just",
    "start": "1616320",
    "end": "1622880"
  },
  {
    "text": "introducing a new imports to the file but this usually causes the files to uh break in",
    "start": "1622880",
    "end": "1630960"
  },
  {
    "text": "a sense and not load because of missing dependencies uh also splitting new imports",
    "start": "1630960",
    "end": "1638799"
  },
  {
    "text": "that for for libraries that already imported by the pe file and dumping the rest as uh strings",
    "start": "1638799",
    "end": "1646399"
  },
  {
    "text": "could also cause the file to not load because of different versions of libraries keep in mind that in the",
    "start": "1646399",
    "end": "1654080"
  },
  {
    "text": "data set analysis we work on a large uh data set to extract the imports and we don't want to",
    "start": "1654080",
    "end": "1661039"
  },
  {
    "text": "uh go into details of versions of dlls and which function names exist in which dlls",
    "start": "1661039",
    "end": "1669840"
  },
  {
    "text": "and the last two methods are simply dump the strings into the overlay or dump it in a new",
    "start": "1670880",
    "end": "1678960"
  },
  {
    "text": "section that will be of course data section uh renaming sections um",
    "start": "1678960",
    "end": "1685360"
  },
  {
    "text": "same method as uh the imports analysis can be applied here",
    "start": "1685360",
    "end": "1690480"
  },
  {
    "text": "to understand which section names are mostly found in the benign files versus the malicious",
    "start": "1690480",
    "end": "1695919"
  },
  {
    "text": "population and simply choose the most prevalent benign names we didn't use that for the",
    "start": "1695919",
    "end": "1703360"
  },
  {
    "text": "attack simply because the pe file already had",
    "start": "1703360",
    "end": "1708399"
  },
  {
    "text": "the most benign section names that we can want and additional features that uh for this time we found them uh not",
    "start": "1708399",
    "end": "1715520"
  },
  {
    "text": "contributing too much uh such as the linker version mean major os version",
    "start": "1715520",
    "end": "1720880"
  },
  {
    "text": "and several more that we found by looking at the tiny pe project",
    "start": "1720880",
    "end": "1727279"
  },
  {
    "text": "and we got very nice ideas from from that so our next slide will",
    "start": "1727279",
    "end": "1734880"
  },
  {
    "text": "show the results of the attack and we will talk about several steps so we start",
    "start": "1734880",
    "end": "1741840"
  },
  {
    "start": "1735000",
    "end": "1892000"
  },
  {
    "text": "from almost a perfect minus one score from our target classifier and the first step that we do",
    "start": "1741840",
    "end": "1749760"
  },
  {
    "text": "is insert 10k imports into the overlay and correcting the checksum and as we",
    "start": "1749760",
    "end": "1757200"
  },
  {
    "text": "discussed before uh this changes the precision",
    "start": "1757200",
    "end": "1762240"
  },
  {
    "text": "most significantly but the score is still very very uh malicious it's a minus 0.99 and",
    "start": "1762240",
    "end": "1772399"
  },
  {
    "text": "what we hope to achieve by this is to make a big impact on the precision and we found that inserting imports one",
    "start": "1772720",
    "end": "1779600"
  },
  {
    "text": "by one bit import names or as strings does not have a big impact on the score",
    "start": "1779600",
    "end": "1786960"
  },
  {
    "text": "so we work here with a large batch of 10k imports and we achieve a significant change in terms of",
    "start": "1786960",
    "end": "1793520"
  },
  {
    "text": "precision for each step we also corrected the timestamp and the checksum so we will",
    "start": "1793520",
    "end": "1800000"
  },
  {
    "text": "not discuss this every time and the next important step is the trampoline",
    "start": "1800000",
    "end": "1806880"
  },
  {
    "text": "and here we inserted a new code section as we described before with uh a prologue to a very benign code",
    "start": "1806880",
    "end": "1813039"
  },
  {
    "text": "section that we extracted and uh in addition we added the same",
    "start": "1813039",
    "end": "1818240"
  },
  {
    "text": "10k imports from the first step into the overlay and we can see that",
    "start": "1818240",
    "end": "1825520"
  },
  {
    "text": "for the trampoline we achieved 0.1 almost change in the score and in",
    "start": "1825520",
    "end": "1831200"
  },
  {
    "text": "addition the 10k into the 10k imports into the overlay achieved a total of 0.519",
    "start": "1831200",
    "end": "1838880"
  },
  {
    "text": "which is very impressive and again the functionality of the pe",
    "start": "1838880",
    "end": "1845039"
  },
  {
    "text": "remains the same there is actually nothing that we did to change the functionality of the pe",
    "start": "1845039",
    "end": "1850880"
  },
  {
    "text": "but we're still in the malicious threshold so it's not enough",
    "start": "1850880",
    "end": "1855919"
  },
  {
    "text": "and the next step will take 20k imports and iterate over them with the 1k",
    "start": "1855919",
    "end": "1862000"
  },
  {
    "text": "batches choosing batches that improve the score only and as you can see we",
    "start": "1862000",
    "end": "1869840"
  },
  {
    "text": "had a big jump here of 1.28 in the score and now",
    "start": "1869840",
    "end": "1876880"
  },
  {
    "text": "the classifier says it's a 0.8 and it's actually very sure that this is",
    "start": "1876880",
    "end": "1882640"
  },
  {
    "text": "a benign file and in a sense this concludes the attack",
    "start": "1882640",
    "end": "1887840"
  },
  {
    "text": "so we had um six uh additional steps of imports that we added which are illustrated in the",
    "start": "1887840",
    "end": "1894960"
  },
  {
    "start": "1892000",
    "end": "1954000"
  },
  {
    "text": "graph where the orange line is representing the classifier score and the blue line that",
    "start": "1894960",
    "end": "1901919"
  },
  {
    "text": "we want to uh to keep each batch that we add",
    "start": "1901919",
    "end": "1907120"
  },
  {
    "text": "we wanted to improve the previous score which is not necessarily the optimal uh approach",
    "start": "1907120",
    "end": "1913679"
  },
  {
    "text": "because we can have combinations that we haven't checked which uh achieve higher changes in the score",
    "start": "1913679",
    "end": "1920240"
  },
  {
    "text": "but we tried to keep it simple and it worked so there was no reason to",
    "start": "1920240",
    "end": "1927679"
  },
  {
    "text": "check a lot of combinations and the blue line describes how each batch affected the score so you",
    "start": "1927679",
    "end": "1933440"
  },
  {
    "text": "can see that are some batches that reduce the score and some batches that uh improve the score and the last uh",
    "start": "1933440",
    "end": "1941440"
  },
  {
    "text": "last batch uh improved the score by a 0.8 in total and it put us in the benign",
    "start": "1941440",
    "end": "1948159"
  },
  {
    "text": "threshold so this concludes the attack and now we can uh try to see",
    "start": "1948159",
    "end": "1953679"
  },
  {
    "text": "uh what other antiviruses in our ngav think about the files so we",
    "start": "1953679",
    "end": "1958960"
  },
  {
    "start": "1954000",
    "end": "1996000"
  },
  {
    "text": "started with a 57 out of 68 detections uh and our ngav is currently detecting",
    "start": "1958960",
    "end": "1966399"
  },
  {
    "text": "the original sample of course with a score of nearly nearly perfect minus one",
    "start": "1966399",
    "end": "1972000"
  },
  {
    "text": "and after our modification we concluded with 30 out of 71",
    "start": "1972000",
    "end": "1977279"
  },
  {
    "text": "and our ngav is no longer no longer detecting the sample alongside with two additional next",
    "start": "1977279",
    "end": "1984240"
  },
  {
    "text": "generation antiviruses and this uh also shows the transferability of",
    "start": "1984240",
    "end": "1991200"
  },
  {
    "text": "explainability that uh ishai mentioned in the first part of the presentation",
    "start": "1991200",
    "end": "1996399"
  },
  {
    "start": "1996000",
    "end": "2093000"
  },
  {
    "text": "this concludes my part of the presentation and ishai will give",
    "start": "1996399",
    "end": "2001840"
  },
  {
    "text": "the summary thank you very much thank you shai and now uh let's say sum",
    "start": "2001840",
    "end": "2008559"
  },
  {
    "text": "things up first of all next generation anti-antivirus is not a silver bullet and especially when it uses",
    "start": "2008559",
    "end": "2014559"
  },
  {
    "text": "a engineered feature which attacker can understand and can modify in a way that will not harm the",
    "start": "2014559",
    "end": "2020880"
  },
  {
    "text": "malicious functionality of the malware second of all explainability",
    "start": "2020880",
    "end": "2026399"
  },
  {
    "text": "is a dual edged sword while it does help internally for debugging etc it also can serve the attacker in order",
    "start": "2026399",
    "end": "2034159"
  },
  {
    "text": "to understand which feature is more impactful and more defined focus",
    "start": "2034159",
    "end": "2039760"
  },
  {
    "text": "on them also also and finally we had some practical insights first",
    "start": "2039760",
    "end": "2044960"
  },
  {
    "text": "the fact that the order in which you made the perturbation does may makes a",
    "start": "2044960",
    "end": "2050720"
  },
  {
    "text": "difference uh and if you choose perturbation a after b or b after a you sometimes get",
    "start": "2050720",
    "end": "2058720"
  },
  {
    "text": "different results which is interesting the second thing is that while small perturbations seem",
    "start": "2058720",
    "end": "2065200"
  },
  {
    "text": "to have a very insignificant effect like you saw in shai's example eventually because of the",
    "start": "2065200",
    "end": "2071599"
  },
  {
    "text": "non-linear nature of those classifier you would get a a sudden drop in the",
    "start": "2071599",
    "end": "2078800"
  },
  {
    "text": "in the classifier and therefore you will get a a big impact and therefore keep on",
    "start": "2078800",
    "end": "2084800"
  },
  {
    "text": "trying and eventually you will succeed this concludes our our session and we",
    "start": "2084800",
    "end": "2091040"
  },
  {
    "text": "are now open for a question thank you very much",
    "start": "2091040",
    "end": "2095599"
  }
]