[
  {
    "start": "0",
    "end": "19000"
  },
  {
    "text": "all right everyone um good morning and thanks for attending my talk um my name",
    "start": "160",
    "end": "5240"
  },
  {
    "text": "is morite and I'm going to talk about how to hack video conferencing system so specifically I'm talking about um our",
    "start": "5240",
    "end": "12080"
  },
  {
    "text": "results of a research project where we conducted research on polycom equipment um the structure of the talk",
    "start": "12080",
    "end": "19880"
  },
  {
    "start": "19000",
    "end": "19000"
  },
  {
    "text": "basically reflects the the systematic approach we followed when doing the research so basically we start with",
    "start": "19880",
    "end": "26960"
  },
  {
    "text": "knowing nothing about those devices and we conclude with with the ability to remotely compromise them so we start",
    "start": "26960",
    "end": "34440"
  },
  {
    "text": "with taking a look at the teex surface um basically the network based attack",
    "start": "34440",
    "end": "39680"
  },
  {
    "text": "surface then we'll start analyzing the firmware update files which allows us to",
    "start": "39680",
    "end": "45520"
  },
  {
    "text": "get some information about the um about the inerts of the of those systems and",
    "start": "45520",
    "end": "52680"
  },
  {
    "text": "then we take a look and basically find several ways to root those devices because usually you don't have system",
    "start": "52680",
    "end": "58600"
  },
  {
    "text": "level access um but we want to have that in order to conduct our research and finally once we got root",
    "start": "58600",
    "end": "65960"
  },
  {
    "text": "access to the device we um take a look at the system from the inside so we take",
    "start": "65960",
    "end": "71400"
  },
  {
    "text": "a look at the system architecture but mainly from a buck Hunter's perspective so we are taking a look at at all the",
    "start": "71400",
    "end": "77000"
  },
  {
    "text": "major processes and stuff like that and after doing that we build a",
    "start": "77000",
    "end": "82880"
  },
  {
    "text": "vulnerability development environment which basically means we set up remote debugging which allows us then to more",
    "start": "82880",
    "end": "89920"
  },
  {
    "text": "easily find bugs and more easily especially write exploit for that and at",
    "start": "89920",
    "end": "95799"
  },
  {
    "text": "the end I will show you um an exploit we did for one of the vulnerabilities in the H 3 to3 stack which basically gives",
    "start": "95799",
    "end": "104240"
  },
  {
    "text": "you um remote root access to the device and since having root access is",
    "start": "104240",
    "end": "111040"
  },
  {
    "text": "nice but what we actually want to do is we want to take control over the complete device so making use of the",
    "start": "111040",
    "end": "116680"
  },
  {
    "text": "peripherals like the camera and the microphone so in post exploitation I will talk a little bit about what we did",
    "start": "116680",
    "end": "123240"
  },
  {
    "text": "in order to implement this functionality in our in our",
    "start": "123240",
    "end": "128399"
  },
  {
    "text": "payload so a few words about me I'm from Hamburg Germany I'm a security consultant at Enron and mostly I'm doing",
    "start": "128399",
    "end": "136640"
  },
  {
    "text": "application Securities so stuff like reverse engineering writing exploits basically finding bucks in source code",
    "start": "136640",
    "end": "142640"
  },
  {
    "text": "binary code stuff like that I did some previous research on USB Security in the past and in general I like buck hunting",
    "start": "142640",
    "end": "149519"
  },
  {
    "text": "so that's probably the reason I'm doing all of that",
    "start": "149519",
    "end": "155280"
  },
  {
    "text": "so first of all why why I'm interested in in video conferencing security um I",
    "start": "155280",
    "end": "162560"
  },
  {
    "text": "mean first of all those devices could be considered just as just another embedded device which sometimes is connected to",
    "start": "162560",
    "end": "169480"
  },
  {
    "text": "the internet and also some kind of internal Network so Neta could use them as a kind of hopping Point into your",
    "start": "169480",
    "end": "176159"
  },
  {
    "text": "internal Network um but more interesting is is the fact that um most people use",
    "start": "176159",
    "end": "182519"
  },
  {
    "text": "those systems to um to exchange critical information so critical meetings might",
    "start": "182519",
    "end": "187720"
  },
  {
    "text": "take place for example over such a system um and if you if you are able to",
    "start": "187720",
    "end": "193519"
  },
  {
    "text": "attack those systems and compromise them you could sniff all of that which might be interesting um but even if a company",
    "start": "193519",
    "end": "200840"
  },
  {
    "text": "for example um has some kind of policy in place which prevents you from from",
    "start": "200840",
    "end": "206959"
  },
  {
    "text": "exchanging sensitive information um these kind of devices especially the um the higher priced ones they are",
    "start": "206959",
    "end": "213920"
  },
  {
    "text": "typically installed at locations which are um pretty critical like the the boardroom of a company or the the major",
    "start": "213920",
    "end": "221120"
  },
  {
    "text": "conference room so even in those cases if I manag to exploit one of those devices I could listen into",
    "start": "221120",
    "end": "227360"
  },
  {
    "text": "conversations taking place in that room I could use a camera to look around maybe I find some paper lying on",
    "start": "227360",
    "end": "235040"
  },
  {
    "text": "somewhere um and on the other hand this device devices are typically used um in",
    "start": "235040",
    "end": "242200"
  },
  {
    "text": "large companies like um for example a lot of banks are making use of video",
    "start": "242200",
    "end": "247680"
  },
  {
    "text": "conferencing insurance companies governments make use of it um and",
    "start": "247680",
    "end": "254120"
  },
  {
    "text": "sometimes even hackers because um beginning of last year HD Mo published some some research where he basically",
    "start": "254120",
    "end": "261479"
  },
  {
    "text": "was scanning the internet and he found several um video conferencing systems",
    "start": "261479",
    "end": "267040"
  },
  {
    "text": "which had the auto accept call feature turned on so this allows you to basically just connect to the system and",
    "start": "267040",
    "end": "274960"
  },
  {
    "text": "your calls automattic automatically be accepted so what you can do in that case is you basically can can join any",
    "start": "274960",
    "end": "282199"
  },
  {
    "text": "conference you can listen in what it's what's being said",
    "start": "282199",
    "end": "287479"
  },
  {
    "text": "um what I was thinking about that is of course um it shows that there is um that",
    "start": "287479",
    "end": "294280"
  },
  {
    "text": "many people really don't think about when they connect those systems to the internet but this is all stuff which can",
    "start": "294280",
    "end": "300759"
  },
  {
    "text": "be um which can be hardened by for example firewall rules or you could Harden the",
    "start": "300759",
    "end": "306960"
  },
  {
    "text": "configuration um so I was more interested in what you could actually do",
    "start": "306960",
    "end": "312039"
  },
  {
    "text": "with those devices when they are really in a hardened environment so for example when all the administrative interfaces",
    "start": "312039",
    "end": "318199"
  },
  {
    "text": "are blocked when all the configuration settings are set to the most secure default or to the most secure values and",
    "start": "318199",
    "end": "326240"
  },
  {
    "text": "as it turns out it's still possible um to break those devices remotely even in",
    "start": "326240",
    "end": "332600"
  },
  {
    "text": "in such a case and even in the case when the call Auto accept feature is turned off which I will show during my",
    "start": "332600",
    "end": "341479"
  },
  {
    "text": "presentation um so first some background about video conferencing so everybody knows video conferencing is about",
    "start": "341479",
    "end": "348479"
  },
  {
    "start": "344000",
    "end": "344000"
  },
  {
    "text": "exchanging voice audio and sometimes even data about um packet based networks",
    "start": "348479",
    "end": "353919"
  },
  {
    "text": "and packet based networks means in most of the cases either IP or ISDN um which",
    "start": "353919",
    "end": "360360"
  },
  {
    "text": "is interesting because there are some systems which are connected to both so",
    "start": "360360",
    "end": "366199"
  },
  {
    "text": "there's one teex scenario where for example you could use the telephone Network to compromise such a device and",
    "start": "366199",
    "end": "372199"
  },
  {
    "text": "then jump onto the IP network and basically get get access there and",
    "start": "372199",
    "end": "380039"
  },
  {
    "text": "basically um there are two kinds of video conferencing systems so there are dedicated systems and their desktop",
    "start": "380039",
    "end": "385960"
  },
  {
    "text": "systems while desktop systems are typically the the lower priced ones and",
    "start": "385960",
    "end": "391319"
  },
  {
    "text": "um dedicated systems are the higher priced equipment which we are interested",
    "start": "391319",
    "end": "396479"
  },
  {
    "text": "in so just to give you an idea about the main players um when it comes to video",
    "start": "396479",
    "end": "402000"
  },
  {
    "start": "397000",
    "end": "397000"
  },
  {
    "text": "conferencing so as you can see the the major major players are Cisco which um",
    "start": "402000",
    "end": "408080"
  },
  {
    "text": "which is also known as t or was also known as tanberg and polycom and then we have some some smaller players like",
    "start": "408080",
    "end": "414840"
  },
  {
    "text": "lifive tillous with you um in order to do research um",
    "start": "414840",
    "end": "420280"
  },
  {
    "text": "initially our plan was to do some kind of a market comparison um however due to",
    "start": "420280",
    "end": "425400"
  },
  {
    "text": "time constraints and some kind of problems getting the hardware um we actually decided to just choose one of",
    "start": "425400",
    "end": "432240"
  },
  {
    "text": "them which happened to be polycom so polycom is um I would say one",
    "start": "432240",
    "end": "438680"
  },
  {
    "text": "of the leading vendors and they offer different solutions and most of the solutions or many of them are actually",
    "start": "438680",
    "end": "445520"
  },
  {
    "text": "pretty expensive um which is interesting for us because that means that the target companies and organizations are",
    "start": "445520",
    "end": "453120"
  },
  {
    "text": "mostly large large ones and if you take a look at their website it's pretty impressive so you",
    "start": "453120",
    "end": "460039"
  },
  {
    "text": "find a page of the customers and it's basically all the Fortune 100 companies",
    "start": "460039",
    "end": "465720"
  },
  {
    "text": "including governments um Banks basically every every juicy Target you could think",
    "start": "465720",
    "end": "474120"
  },
  {
    "start": "474000",
    "end": "474000"
  },
  {
    "text": "of so um to do our research we used um a polycom um h HDX system so the HDX",
    "start": "474120",
    "end": "481639"
  },
  {
    "text": "series of devices is probably one of the um one of the um devices which is really",
    "start": "481639",
    "end": "489240"
  },
  {
    "text": "popular and there are several configurations and we happen to have a",
    "start": "489240",
    "end": "494520"
  },
  {
    "text": "HDX 7,000 HD which you can see on on the right um which comes with some nice",
    "start": "494520",
    "end": "500120"
  },
  {
    "text": "peripherals like for example um um the eagle I HD camera which is a panel zoom",
    "start": "500120",
    "end": "506319"
  },
  {
    "text": "camera that means you can remotely control that camera um it comes with a mic microphone array",
    "start": "506319",
    "end": "512599"
  },
  {
    "text": "which is a 360Â° microphone which can pick up voice from really far away and some remote control and the",
    "start": "512599",
    "end": "520320"
  },
  {
    "text": "whole thing is then connected to some external display so after having the hardware and",
    "start": "520320",
    "end": "527959"
  },
  {
    "text": "basically knowing nothing about those devices we first of all Define the tech surface so we take a look at what um",
    "start": "527959",
    "end": "536000"
  },
  {
    "text": "what network based Tech surface we have so we don't consider physical attacks at this",
    "start": "536000",
    "end": "541040"
  },
  {
    "start": "541000",
    "end": "541000"
  },
  {
    "text": "place so the first thing is um of course the polycom web interface which is um the main interface to configure those",
    "start": "541040",
    "end": "548720"
  },
  {
    "text": "devices um so you basically can configure every aspect of the device you",
    "start": "548720",
    "end": "554720"
  },
  {
    "text": "can do some Diagnostics with it um and of course it could be attacked in",
    "start": "554720",
    "end": "560160"
  },
  {
    "text": "theory um those devices have some kind of provisioning mechanism which allows you to remotely um apply updates and um",
    "start": "560160",
    "end": "568320"
  },
  {
    "text": "do configuration changes um additionally there are two command line based interfaces um the",
    "start": "568320",
    "end": "576079"
  },
  {
    "text": "first one is the API interface which is um mainly used by system integrators to",
    "start": "576079",
    "end": "581120"
  },
  {
    "text": "um to configure the device to work with external hardware or with third- party Hardware like for example um crypto",
    "start": "581120",
    "end": "587519"
  },
  {
    "text": "accelerators or crypto devices um the polycom command shell is comparable in",
    "start": "587519",
    "end": "593480"
  },
  {
    "text": "functionality with the polycom HDX web interface um but it's completely um",
    "start": "593480",
    "end": "598800"
  },
  {
    "text": "command line based and of course those are interfaces which um could be accessible on the",
    "start": "598800",
    "end": "604600"
  },
  {
    "text": "network so you could in theory try to exploit those um those devices have SNMP enabled",
    "start": "604600",
    "end": "612200"
  },
  {
    "text": "however um SNMP right access is not supported at all so of course you could still find bugs in the SNMP stack or",
    "start": "612200",
    "end": "619079"
  },
  {
    "text": "implementation but um especially from from chain from an aspect where you change certain settings through SNMP",
    "start": "619079",
    "end": "626079"
  },
  {
    "text": "it's not that interesting and finally we have video conferencing",
    "start": "626079",
    "end": "632040"
  },
  {
    "text": "protocols um which is interesting because um this is one part of the text",
    "start": "632040",
    "end": "638200"
  },
  {
    "text": "surface which can't be disabled so if you want those devices to make actually video calls um one of those protocol",
    "start": "638200",
    "end": "646480"
  },
  {
    "text": "either H3 to3 or Zip must be enabled otherwise you can't use the device",
    "start": "646480",
    "end": "651800"
  },
  {
    "text": "right so we'll see later that those Protocols are pretty interesting when it comes to exploiting those devices",
    "start": "651800",
    "end": "660279"
  },
  {
    "text": "so we basically start um with some firmware analysis because um this is one thing we can we can analyze and take a",
    "start": "660279",
    "end": "667839"
  },
  {
    "text": "look at without um having root access to the device so if you go to the vendor web",
    "start": "667839",
    "end": "673760"
  },
  {
    "start": "672000",
    "end": "672000"
  },
  {
    "text": "page you will see that you can get software updates at support. polycom tocom and every software update is",
    "start": "673760",
    "end": "680079"
  },
  {
    "text": "basically a zip file um and each of those zip files contains a single pup file which which stands for polycom",
    "start": "680079",
    "end": "686720"
  },
  {
    "text": "update file and those can be either applied um through the polycom web interface or you just",
    "start": "686720",
    "end": "693560"
  },
  {
    "text": "use this provisioning mechanism to apply those and all of our analysis which I'm presenting now is based on version 305",
    "start": "693560",
    "end": "701560"
  },
  {
    "text": "which was a current version when we did that research so if you take a look at the",
    "start": "701560",
    "end": "708399"
  },
  {
    "start": "705000",
    "end": "705000"
  },
  {
    "text": "pup file structure it actually doesn't look too bad right so you at least have some",
    "start": "708399",
    "end": "713519"
  },
  {
    "text": "strings somewhere in the beginning the first few bytes kind of looked like a um file signature",
    "start": "713519",
    "end": "720279"
  },
  {
    "text": "um so we started analyzing the complete file format and it turns out it's it's",
    "start": "720279",
    "end": "726279"
  },
  {
    "text": "pretty simple so um it consists of a pup file header which are the first 768",
    "start": "726279",
    "end": "731360"
  },
  {
    "text": "bytes and then there are two packages or two archives so the first one is",
    "start": "731360",
    "end": "736639"
  },
  {
    "text": "bootstrap bootstrap archive which contains um basically code which is used",
    "start": "736639",
    "end": "741920"
  },
  {
    "text": "to install the update and extract the remaining part of the update and the more interesting part is",
    "start": "741920",
    "end": "749240"
  },
  {
    "text": "the update package at the end um which is the archive which contains all the files which are updated so if you don't",
    "start": "749240",
    "end": "756320"
  },
  {
    "text": "have access or don't have system level access to the device this is actually the the archive where can find all the",
    "start": "756320",
    "end": "762639"
  },
  {
    "text": "files which in theory are also running on the device so um in the next step what we",
    "start": "762639",
    "end": "769040"
  },
  {
    "text": "did is we wanted to find out the exact format of the pup header um so what you typically do is",
    "start": "769040",
    "end": "776920"
  },
  {
    "start": "773000",
    "end": "773000"
  },
  {
    "text": "you try to um guess certain Fields you try to compare different versions of a firmware update file in order to to find",
    "start": "776920",
    "end": "784160"
  },
  {
    "text": "out the complete structure um however in this case it was much much easier because um as I said there's this update",
    "start": "784160",
    "end": "791959"
  },
  {
    "text": "package so we were looking around trying to find interesting files and we found a file called Papu PPC which is a power PC",
    "start": "791959",
    "end": "800120"
  },
  {
    "text": "binary and this binary is called the polycom update utilities so it's",
    "start": "800120",
    "end": "805399"
  },
  {
    "text": "actually the binary which is running on the device um which is respond ible for verifying the Integrity for installing",
    "start": "805399",
    "end": "811120"
  },
  {
    "text": "the updates and of course such a binary has all the information about the format of those pup files so it was quite nice",
    "start": "811120",
    "end": "818440"
  },
  {
    "text": "to find this binary and additionally what you can do is you can take that binary and run it in qmu so we did we",
    "start": "818440",
    "end": "826240"
  },
  {
    "text": "just installed a just a normal Linux system in quu and we were able to run",
    "start": "826240",
    "end": "831839"
  },
  {
    "text": "this binary um what's interesting is if you take a look at the usage information",
    "start": "831839",
    "end": "837040"
  },
  {
    "text": "um it's not only used to verify and install updates but it's also used um to",
    "start": "837040",
    "end": "842360"
  },
  {
    "text": "to generate updates so for example you have a a command generate or you have the command gen keys so it looks like",
    "start": "842360",
    "end": "849759"
  },
  {
    "text": "this binary is actually used also by polycom to generate update files which is interesting because it's shipped with",
    "start": "849759",
    "end": "856720"
  },
  {
    "text": "every every device to every customer so we reest engineered that",
    "start": "856720",
    "end": "862040"
  },
  {
    "text": "binary to find out the exact format of the struct of the header format and so it turns out the first",
    "start": "862040",
    "end": "868759"
  },
  {
    "text": "first few bytes are are really a signature for the file which can be either ppup or ppdp and then the",
    "start": "868759",
    "end": "875600"
  },
  {
    "text": "remaining header consists of several um fixed size fields which are padded with null",
    "start": "875600",
    "end": "881360"
  },
  {
    "text": "bites so this is a complete structure which we figured out and it contains",
    "start": "881360",
    "end": "887199"
  },
  {
    "text": "several interesting Fields like um some information about Hardware so specifies",
    "start": "887199",
    "end": "893399"
  },
  {
    "text": "um where the update can actually be installed and some other interesting in",
    "start": "893399",
    "end": "898920"
  },
  {
    "text": "information however there are two fields which are um specifically important or specifically interesting um which is the",
    "start": "898920",
    "end": "906360"
  },
  {
    "text": "header Max signature and the signature at the end and it turns out those two",
    "start": "906360",
    "end": "911720"
  },
  {
    "text": "Fields actually um represent the two protection mechanisms which are in place to prevent",
    "start": "911720",
    "end": "918959"
  },
  {
    "text": "um file tempering so these two mechanisms actually guarantee that there is no that the Integrity of the file is",
    "start": "918959",
    "end": "925560"
  },
  {
    "text": "is valid and so since we were interested in ways to actually get root access on the",
    "start": "925560",
    "end": "931759"
  },
  {
    "text": "device we took a deeper look into those mechanisms so we start with a header",
    "start": "931759",
    "end": "937240"
  },
  {
    "text": "Mach signature um this is actually an hem so what you do is um you just have a",
    "start": "937240",
    "end": "944399"
  },
  {
    "start": "939000",
    "end": "939000"
  },
  {
    "text": "secret value you calculate a hash over the header and in order to verify this",
    "start": "944399",
    "end": "950199"
  },
  {
    "text": "you just do the usual thing you zero out the the field in the header you calculate the hash using the secret and",
    "start": "950199",
    "end": "956920"
  },
  {
    "text": "then you compare the result and if it doesn't match you have an invalid PP file so you just throw an",
    "start": "956920",
    "end": "963839"
  },
  {
    "text": "error um does anybody see a problem with",
    "start": "963839",
    "end": "968880"
  },
  {
    "text": "such a mechanism in order to guarantee the integ Integrity of a file when it comes to firm",
    "start": "968880",
    "end": "976319"
  },
  {
    "text": "updates what's that exactly I",
    "start": "977079",
    "end": "983279"
  },
  {
    "text": "mean I mean to to generate such an up to generate such a um firmware update um",
    "start": "983480",
    "end": "989199"
  },
  {
    "text": "the key is of course um somewhere at the company but um you need to verify it and",
    "start": "989199",
    "end": "994399"
  },
  {
    "text": "in order to verify the Integrity this secret value which is also used to generate those files must be on the",
    "start": "994399",
    "end": "1000639"
  },
  {
    "text": "device somewhere and it turns out it is and it can be extracted and we actually found",
    "start": "1000639",
    "end": "1007040"
  },
  {
    "text": "the secret value inside this puut power PC binary and if you take a look at the Ida",
    "start": "1007040",
    "end": "1014639"
  },
  {
    "text": "screenshot at the bottom um you can see the secret value in the binary which which is some bites at the",
    "start": "1014639",
    "end": "1021519"
  },
  {
    "text": "beginning and then the string We Are the Champions which I found pretty",
    "start": "1021519",
    "end": "1027839"
  },
  {
    "text": "interesting um so having the secret value we can now",
    "start": "1027959",
    "end": "1033959"
  },
  {
    "text": "start to basically calculate our own our own Mac and just modify the header that",
    "start": "1033959",
    "end": "1040600"
  },
  {
    "text": "way um however in this case it's much easier because um in order to do that",
    "start": "1040600",
    "end": "1047120"
  },
  {
    "text": "you would typically just reverse engineer which kind of hm algorithm they are using then do that however um I said",
    "start": "1047120",
    "end": "1053679"
  },
  {
    "text": "before we can run this binary in qemu and just for testing we um modified the",
    "start": "1053679",
    "end": "1059360"
  },
  {
    "text": "pup file and ran the verify command against it and obviously we get an error",
    "start": "1059360",
    "end": "1064440"
  },
  {
    "text": "message like the Mac does not match the pop header appears to have been tempered with however what I highlighted in red",
    "start": "1064440",
    "end": "1071160"
  },
  {
    "text": "here is um is not what you would expect the mech algorithm or the mech value",
    "start": "1071160",
    "end": "1077320"
  },
  {
    "text": "which is stored in the header but this is actually the real expected Mech value so what you can do is you modify the",
    "start": "1077320",
    "end": "1084360"
  },
  {
    "text": "header then just run this get this error message use this Mech value put it inside your header and you have a valid",
    "start": "1084360",
    "end": "1090440"
  },
  {
    "text": "file again so you probably shouldn't output such a",
    "start": "1090440",
    "end": "1095840"
  },
  {
    "text": "thing in the in the error message so we can basically circumvent this protection",
    "start": "1095840",
    "end": "1101520"
  },
  {
    "text": "mechanism however as I said there's another protection mechanism which is this um public key DS A6 signature which",
    "start": "1101520",
    "end": "1109200"
  },
  {
    "start": "1105000",
    "end": "1105000"
  },
  {
    "text": "was at the end of the header and this one is actually calculated over the whole file including the pup header so",
    "start": "1109200",
    "end": "1115960"
  },
  {
    "text": "it's not enough to just break the pup header protection but you also need to break this mechanism in order to modify",
    "start": "1115960",
    "end": "1122600"
  },
  {
    "text": "the file and at this point actually um we",
    "start": "1122600",
    "end": "1127799"
  },
  {
    "text": "steep back for a second because our initial goal was to um root the device and it turns out there are much",
    "start": "1127799",
    "end": "1135400"
  },
  {
    "text": "easier methods actually to root the device instead of um trying to temper with the pop file so we didn't do any",
    "start": "1135400",
    "end": "1141320"
  },
  {
    "text": "any further analysis on that Alor on that mechanism um so device rooting um first",
    "start": "1141320",
    "end": "1150120"
  },
  {
    "text": "of all why do we want to get root on those devices I mean doing um buck hunting is a lot easier you can monitor",
    "start": "1150120",
    "end": "1156799"
  },
  {
    "text": "processes especially when we are talking about fuzzing and you want to have direct control over processes you want",
    "start": "1156799",
    "end": "1162840"
  },
  {
    "text": "to monitor for fault stuff like that and especially when it comes to writing exploits um it's much more comfortable",
    "start": "1162840",
    "end": "1169280"
  },
  {
    "text": "if you have a debugger on the device and it can actually write your exploit on the real Hardware which is used in the",
    "start": "1169280",
    "end": "1175480"
  },
  {
    "text": "final in the final scenario as well so it turns out um there are",
    "start": "1175480",
    "end": "1182640"
  },
  {
    "start": "1179000",
    "end": "1179000"
  },
  {
    "text": "actually two boot modes so um there's production boot mode which is a normal thing when you power the device on it",
    "start": "1182640",
    "end": "1188679"
  },
  {
    "text": "boots in production however there's an undocumented boot mode which is called development",
    "start": "1188679",
    "end": "1194400"
  },
  {
    "text": "Boot and development boot is probably used by polycom internally um at least",
    "start": "1194400",
    "end": "1201360"
  },
  {
    "text": "that's how it looks like and it can still be enabled in in the released",
    "start": "1201360",
    "end": "1206799"
  },
  {
    "text": "F and what happens if if the device boots in development mode is there's an",
    "start": "1206799",
    "end": "1212240"
  },
  {
    "text": "NFS client which tries to mount some some developer workspace um and finally",
    "start": "1212240",
    "end": "1217480"
  },
  {
    "text": "a tnet server is enabled on Port 23 and additionally the root user doesn't have a password so what you can do is you",
    "start": "1217480",
    "end": "1225200"
  },
  {
    "text": "enable development mode and then you can just immediately as root and you have root access to the",
    "start": "1225200",
    "end": "1231120"
  },
  {
    "text": "device so the question is how do we enable that mode um if you take a look at the",
    "start": "1231120",
    "end": "1238840"
  },
  {
    "start": "1236000",
    "end": "1236000"
  },
  {
    "text": "startup scripts of those devices you will see that there is a variable called def Boot and this is a uboot variable",
    "start": "1238840",
    "end": "1245600"
  },
  {
    "text": "which is checked and if this variable is set um development mode is enabled um so actually we can't modify",
    "start": "1245600",
    "end": "1252679"
  },
  {
    "text": "that directly but however there are um several flash-based variables um and one",
    "start": "1252679",
    "end": "1258679"
  },
  {
    "text": "of them is called OT boot arcs which um just are additional kernel parameters",
    "start": "1258679",
    "end": "1264280"
  },
  {
    "text": "pass to the running or to the booted kernel um so what you can do is you just pass def boot equal something to OT boot",
    "start": "1264280",
    "end": "1271320"
  },
  {
    "text": "arcs and it will automatically be set and will be respected in the startup script so the question is how do who how",
    "start": "1271320",
    "end": "1278720"
  },
  {
    "text": "do we modify those fles variables pretty simple we just use a polycom command",
    "start": "1278720",
    "end": "1284120"
  },
  {
    "start": "1282000",
    "end": "1282000"
  },
  {
    "text": "shell which is this command line based administrative interface I talked about before um there are two commands which",
    "start": "1284120",
    "end": "1293120"
  },
  {
    "text": "is called print EnV and set EnV which can be used to basically give you a list",
    "start": "1293120",
    "end": "1298360"
  },
  {
    "text": "of all the variables respect and and basically modify those variables",
    "start": "1298360",
    "end": "1304080"
  },
  {
    "text": "respectively so rooting the device really comes down to only two",
    "start": "1304080",
    "end": "1309120"
  },
  {
    "text": "lines which is this so you connect to the polycom command shell either via tnet or through a serial connection you",
    "start": "1309120",
    "end": "1316080"
  },
  {
    "text": "do set EnV OT boot arcs um def boot equals bogus bogus is some kind of magic",
    "start": "1316080",
    "end": "1322080"
  },
  {
    "text": "value which prevents the NFS client um to time out so it just is",
    "start": "1322080",
    "end": "1327400"
  },
  {
    "text": "faster and you reboot the device and you can log in Via tet so pretty",
    "start": "1327400",
    "end": "1334240"
  },
  {
    "text": "simple um however after the device booted in development mode um it's not really the",
    "start": "1334240",
    "end": "1341799"
  },
  {
    "text": "mode which is it's running in when you want to run your your final exploit for example for example some of the and user",
    "start": "1341799",
    "end": "1348480"
  },
  {
    "text": "services are not running the web interface is not started so it's not really the the mode you want to work in",
    "start": "1348480",
    "end": "1354679"
  },
  {
    "text": "um however it's pretty simple you can um just um add permanent access for example we modified the inet configuration for",
    "start": "1354679",
    "end": "1361880"
  },
  {
    "text": "production mode at your own tet server save stuff reboot and you're good to go",
    "start": "1361880",
    "end": "1368600"
  },
  {
    "text": "actually to switch back to production mode um there's a convenient script um lying on the device which is called def",
    "start": "1368600",
    "end": "1374720"
  },
  {
    "text": "convert so um you just call def convert normal and the device will automatically",
    "start": "1374720",
    "end": "1379760"
  },
  {
    "text": "reboot and boot in production mode again and this script can actually also be used to do um do it the other way around",
    "start": "1379760",
    "end": "1387679"
  },
  {
    "text": "so if you somehow manage to um run a command on the device you can just um call def convert dummy or def convert",
    "start": "1387679",
    "end": "1395440"
  },
  {
    "text": "something and it will automatically reboot the device in development mode which is actually the second method",
    "start": "1395440",
    "end": "1402279"
  },
  {
    "start": "1401000",
    "end": "1401000"
  },
  {
    "text": "we use to root the device because um you can just try to find a command in",
    "start": "1402279",
    "end": "1407919"
  },
  {
    "text": "jection in the web interface or somewhere else and then use this web this command",
    "start": "1407919",
    "end": "1414159"
  },
  {
    "text": "injection to actually root the device and just as a demonstration we um",
    "start": "1414159",
    "end": "1419480"
  },
  {
    "text": "actually use the command injection inside the firmware update functionality itself so it turns out if you want to",
    "start": "1419480",
    "end": "1425480"
  },
  {
    "text": "update the device you upload a PP file via the web interface and when it wants to verify",
    "start": "1425480",
    "end": "1432600"
  },
  {
    "text": "this file it actually passes this to a um to a shell command which is calling",
    "start": "1432600",
    "end": "1437960"
  },
  {
    "text": "the pup utils binary again but there is no input validation at all so you can just upload a file called test semicolon",
    "start": "1437960",
    "end": "1444880"
  },
  {
    "text": "log up pone semicolon something which will successfully execute your loga command",
    "start": "1444880",
    "end": "1451440"
  },
  {
    "text": "and to root the device again you just upload a file which um calls for example",
    "start": "1451440",
    "end": "1457159"
  },
  {
    "text": "the def convert script um there are some limitations so for example only the file name is used um of the complete path so",
    "start": "1457159",
    "end": "1465120"
  },
  {
    "text": "you can't use slash characters in your command injection but you can just use um some kind of shell uh shell character",
    "start": "1465120",
    "end": "1472559"
  },
  {
    "text": "substitution in order to cument that you upload that file and then you have um",
    "start": "1472559",
    "end": "1477679"
  },
  {
    "text": "you're basically in De development mode again um so there are several methods",
    "start": "1477679",
    "end": "1485440"
  },
  {
    "start": "1482000",
    "end": "1482000"
  },
  {
    "text": "you can root the device however the problem is um these methods um actually",
    "start": "1485440",
    "end": "1491919"
  },
  {
    "text": "should be usable in the in the future because um we want to use them in order to conduct more research and give you",
    "start": "1491919",
    "end": "1499080"
  },
  {
    "text": "the possibility to do more research and the problem is all of those previous methods are based on vulnerabilities or",
    "start": "1499080",
    "end": "1506200"
  },
  {
    "text": "bucks and obvious obviously these get fixed by the vendor um so what you could",
    "start": "1506200",
    "end": "1512240"
  },
  {
    "text": "could do of course is just try to find a new command injection just try to find a new way of exploiting those devices",
    "start": "1512240",
    "end": "1519159"
  },
  {
    "text": "however this is time investment which um we actually don't want to spend because our main goal is to find vulnerabilities",
    "start": "1519159",
    "end": "1525960"
  },
  {
    "text": "real vulnerabilities and not spend time with trying to root the device um so we",
    "start": "1525960",
    "end": "1532159"
  },
  {
    "text": "came up with another basically idea um which is just based on the fact",
    "start": "1532159",
    "end": "1538320"
  },
  {
    "start": "1535000",
    "end": "1535000"
  },
  {
    "text": "that we know all the old vulnerabilities so what you could do is um you just",
    "start": "1538320",
    "end": "1544440"
  },
  {
    "text": "downgrade the device um because you can downgrade firmware versions and then you",
    "start": "1544440",
    "end": "1549480"
  },
  {
    "text": "exploit one of the known known vulnerabilities and you persist on the device and once you did that you just",
    "start": "1549480",
    "end": "1556559"
  },
  {
    "text": "re-update to the current version and you have root access on on the current version and basically can do your your",
    "start": "1556559",
    "end": "1562360"
  },
  {
    "text": "analysis on on the device with the current version and since the downgrade feature",
    "start": "1562360",
    "end": "1568559"
  },
  {
    "text": "is less likely to to be removed um this might be an idea on how to um conduct",
    "start": "1568559",
    "end": "1574279"
  },
  {
    "text": "future research on those devices so now that we got access to the",
    "start": "1574279",
    "end": "1579559"
  },
  {
    "text": "device um we take a look at it from the inside um so as it turns out it's a",
    "start": "1579559",
    "end": "1586880"
  },
  {
    "start": "1584000",
    "end": "1584000"
  },
  {
    "text": "power PC some kind of embedded Linux system um has a ubot boot loader and it comes with",
    "start": "1586880",
    "end": "1593159"
  },
  {
    "text": "all the basic standard binaries like um buy box WG it also comes with a GDB",
    "start": "1593159",
    "end": "1598520"
  },
  {
    "text": "server binary which is handy because then we don't have to upload it in order to do remote",
    "start": "1598520",
    "end": "1604159"
  },
  {
    "start": "1604000",
    "end": "1604000"
  },
  {
    "text": "debugging um there are several file um systems like we have a boot file system",
    "start": "1604159",
    "end": "1610200"
  },
  {
    "text": "the typical root file system on hda3 we have the lock and configuration files",
    "start": "1610200",
    "end": "1616080"
  },
  {
    "text": "typical stuff and and we have a fourth partition which is called the factory restore partition which um actually",
    "start": "1616080",
    "end": "1622279"
  },
  {
    "text": "stores some kind of old operating system which is used in the case if you want to completely restore the device which",
    "start": "1622279",
    "end": "1629679"
  },
  {
    "text": "might be a good idea to store your rootkit maybe",
    "start": "1629679",
    "end": "1635480"
  },
  {
    "text": "um so all the polycom internal files are found in the op polycom",
    "start": "1635480",
    "end": "1641640"
  },
  {
    "text": "directory um where you can find all the binaries configuration files stuff like that so configuration files are pretty",
    "start": "1641640",
    "end": "1648360"
  },
  {
    "start": "1646000",
    "end": "1646000"
  },
  {
    "text": "simple so all the all the configuration settings you for example can change in the polycom web interface are stored a",
    "start": "1648360",
    "end": "1655200"
  },
  {
    "text": "single um text files basically inside that directory so it's pretty easy to",
    "start": "1655200",
    "end": "1660760"
  },
  {
    "text": "find certain settings on the device or to modify them for",
    "start": "1660760",
    "end": "1665880"
  },
  {
    "start": "1665000",
    "end": "1665000"
  },
  {
    "text": "example so there are two processes running which are um more important than",
    "start": "1665880",
    "end": "1671919"
  },
  {
    "text": "others when it comes to buck hunting um the first one is called the app main Java process which is um basically",
    "start": "1671919",
    "end": "1679960"
  },
  {
    "text": "responsible for the for the GUI and it also implements web",
    "start": "1679960",
    "end": "1685440"
  },
  {
    "text": "functionality um for example all the functionality available in the polycom web interface is implemented in that",
    "start": "1685440",
    "end": "1692000"
  },
  {
    "text": "process and it also implements user authentication so even if you login via",
    "start": "1692000",
    "end": "1697080"
  },
  {
    "text": "some command line based interface um the authentication is actually implemented in this Java process and the second",
    "start": "1697080",
    "end": "1703919"
  },
  {
    "text": "process is called polycom ABC which is some kind of more the lowlevel process",
    "start": "1703919",
    "end": "1710200"
  },
  {
    "text": "and this one actually implements all the details regarding the signaling protocols so the first process the Java",
    "start": "1710200",
    "end": "1717640"
  },
  {
    "start": "1715000",
    "end": "1715000"
  },
  {
    "text": "app main uh the J app main Java process um all the Java files can be found in in",
    "start": "1717640",
    "end": "1723600"
  },
  {
    "text": "the polycom bin directory and of course this process is running as",
    "start": "1723600",
    "end": "1729159"
  },
  {
    "text": "root and this one is actually a good place if you are looking for buck in the web",
    "start": "1729159",
    "end": "1734399"
  },
  {
    "text": "interface and you don't want to do only black box testing um you can basically decompile those",
    "start": "1734399",
    "end": "1740640"
  },
  {
    "text": "Java classes and take a look there um because the the web interface makes use",
    "start": "1740640",
    "end": "1746080"
  },
  {
    "text": "of the light HTTP server with fast CGI and all the CGI handlers are basically",
    "start": "1746080",
    "end": "1752559"
  },
  {
    "text": "implementing the polycom web CGI Handler um class so it's pretty easy to actually find the code you're looking",
    "start": "1752559",
    "end": "1758600"
  },
  {
    "text": "for and as I said this also implements the authentication um so if you want to",
    "start": "1758600",
    "end": "1765159"
  },
  {
    "text": "try to find um Authentication byp passes or bucks of that kind um this might be a",
    "start": "1765159",
    "end": "1771880"
  },
  {
    "text": "good place to look at as well so the next process um the polycom",
    "start": "1771880",
    "end": "1777720"
  },
  {
    "start": "1774000",
    "end": "1774000"
  },
  {
    "text": "ABC process is an interesting one um it's implemented in the ABC binary which",
    "start": "1777720",
    "end": "1782880"
  },
  {
    "text": "is a really huge non-strip binary so it comes with all the symbols and it's",
    "start": "1782880",
    "end": "1788120"
  },
  {
    "text": "completely implemented in C it's running as root um and it implements all the low-level details regarding the",
    "start": "1788120",
    "end": "1794559"
  },
  {
    "text": "signaling protocols and many other um important and um complicated protocols",
    "start": "1794559",
    "end": "1800039"
  },
  {
    "text": "so what could possibly go wrong right um so this is the place to actually look",
    "start": "1800039",
    "end": "1806519"
  },
  {
    "text": "for buck with the signaling protocols um just to give you an idea that for example more than 800 cross references",
    "start": "1806519",
    "end": "1813159"
  },
  {
    "text": "to string copy more than 1,400 cross refs to um to S print f um there are no",
    "start": "1813159",
    "end": "1820360"
  },
  {
    "text": "exploit mitigations at all so if you find a bug um it's pretty easy to exploit it and it's pretty easy to",
    "start": "1820360",
    "end": "1826840"
  },
  {
    "text": "reverse engineer due to all the symbols",
    "start": "1826840",
    "end": "1832600"
  },
  {
    "text": "so now that we um know a little bit about the device from the inside about the major processes um we want to set up",
    "start": "1832600",
    "end": "1840399"
  },
  {
    "text": "our wev environment which basically consists of setting up remote debugging",
    "start": "1840399",
    "end": "1845960"
  },
  {
    "start": "1842000",
    "end": "1842000"
  },
  {
    "text": "um because as I said it simplifies bug hunting it allows you to more easily write your",
    "start": "1845960",
    "end": "1852039"
  },
  {
    "text": "exploit um actually we Tred to do debugging on the device itself um how",
    "start": "1852039",
    "end": "1857360"
  },
  {
    "text": "however that failed miserably because um trying to debug a 50 Mac binary on the",
    "start": "1857360",
    "end": "1863039"
  },
  {
    "text": "device which really not a lot of memory doesn't work um however as I said um the",
    "start": "1863039",
    "end": "1868760"
  },
  {
    "text": "device comes with a GDB server binary so you just compile your own power PC Linux GDB binary and you can pretty easily do",
    "start": "1868760",
    "end": "1876159"
  },
  {
    "text": "remote debugging actually don't forget to um specify the remote Shar lips otherwise you're running into some weird",
    "start": "1876159",
    "end": "1883360"
  },
  {
    "text": "problems which I learned the hard way um so this is how it looks like um",
    "start": "1883360",
    "end": "1891039"
  },
  {
    "text": "so from inside the firmware D directory I'm basically attaching to the remote process running on the device which",
    "start": "1891039",
    "end": "1897720"
  },
  {
    "text": "allows me to do remote debugging um there's one thing which you need to um take care of which is um",
    "start": "1897720",
    "end": "1904840"
  },
  {
    "start": "1900000",
    "end": "1900000"
  },
  {
    "text": "polycom's watch do demon so they have some process running which tries to prevent crashes or tries to detect",
    "start": "1904840",
    "end": "1911360"
  },
  {
    "text": "crashes and non-responding processes and in that case the device is rebooted so",
    "start": "1911360",
    "end": "1916559"
  },
  {
    "text": "if you Breaking Inside Your debugger and waiting for too long the device just reboots which is not really ideal so",
    "start": "1916559",
    "end": "1924399"
  },
  {
    "text": "somehow you must um disable this demon um so our first try was to just",
    "start": "1924399",
    "end": "1930760"
  },
  {
    "text": "kill the process which resulted in reboot of the device um so that didn't",
    "start": "1930760",
    "end": "1936080"
  },
  {
    "text": "work however um it's pretty simple the the the watch demon is checking for a configuration file called watch doog",
    "start": "1936080",
    "end": "1942840"
  },
  {
    "text": "disable and if you create that file it can be empty um on the next reboot the watch demon is disabled so you need to",
    "start": "1942840",
    "end": "1950360"
  },
  {
    "text": "do that in order to do proper debugging on the device okay so now we have everything in",
    "start": "1950360",
    "end": "1955840"
  },
  {
    "start": "1953000",
    "end": "1953000"
  },
  {
    "text": "place so we can start to look for bugs right but what are we actually looking for so I mean as I said before um for",
    "start": "1955840",
    "end": "1962919"
  },
  {
    "text": "example finding bugs in the web interface is probably not too hard and especially because there are many people",
    "start": "1962919",
    "end": "1968639"
  },
  {
    "text": "to know how to do web application security so some people might so it",
    "start": "1968639",
    "end": "1974399"
  },
  {
    "text": "might be the first Target for some people however our main goal was to find vulnerabilities in in devices which are",
    "start": "1974399",
    "end": "1981480"
  },
  {
    "text": "in a hardened environment so we have firewalls in place which should block access to the um administrative",
    "start": "1981480",
    "end": "1987799"
  },
  {
    "text": "interfaces we have all the default settings configured to the most secure",
    "start": "1987799",
    "end": "1992840"
  },
  {
    "text": "uh most secure um setting like the call Auto accept feature should be turned off",
    "start": "1992840",
    "end": "1999120"
  },
  {
    "text": "obviously um but as I said those two protocols H3 to3 and zp they must be",
    "start": "1999120",
    "end": "2005760"
  },
  {
    "text": "accepted at least one of them in order to use a device to do video conferencing I mean you could still",
    "start": "2005760",
    "end": "2012120"
  },
  {
    "text": "disable them and use those devices as a um as a um pretty expensive heater or",
    "start": "2012120",
    "end": "2018760"
  },
  {
    "text": "something but I mean in the normal case one of those protocols must be enabled and for our case study we focused on the",
    "start": "2018760",
    "end": "2025760"
  },
  {
    "text": "H 323 protocol so H 3 to3 is a pretty complex",
    "start": "2025760",
    "end": "2033480"
  },
  {
    "start": "2030000",
    "end": "2030000"
  },
  {
    "text": "standard and it consists of several different um several different",
    "start": "2033480",
    "end": "2038760"
  },
  {
    "text": "standards um and from a buck hunting perspective there are some some of them",
    "start": "2038760",
    "end": "2043960"
  },
  {
    "text": "are more important than others so this is just a list of some of them which um",
    "start": "2043960",
    "end": "2049358"
  },
  {
    "start": "2044000",
    "end": "2044000"
  },
  {
    "text": "should be considered when doing buck hunting and without going into any details about those standards um what",
    "start": "2049359",
    "end": "2056079"
  },
  {
    "text": "they have in common is all of them are used in the early connection setup phase so um which makes them pretty",
    "start": "2056079",
    "end": "2062560"
  },
  {
    "text": "interesting for finding bugs because you don't have to establish a full call then try to exploit somebody but you can",
    "start": "2062560",
    "end": "2069079"
  },
  {
    "text": "actually use the initial packets to try to exploit the device and we actually focus on the",
    "start": "2069079",
    "end": "2075480"
  },
  {
    "text": "first protocol so this protocol um consists of",
    "start": "2075480",
    "end": "2081240"
  },
  {
    "text": "several different messages um and each message consists of um so-called",
    "start": "2081240",
    "end": "2086358"
  },
  {
    "text": "information Elements which um are basically just some some kind of some",
    "start": "2086359",
    "end": "2091440"
  },
  {
    "text": "kind of information which is transmitted and for example um the system systems",
    "start": "2091440",
    "end": "2097359"
  },
  {
    "text": "the caller's identity is is an example for an ie um which is just the name of",
    "start": "2097359",
    "end": "2102680"
  },
  {
    "text": "the caller which should be displayed at the end at the other side and there are other information elements like um",
    "start": "2102680",
    "end": "2109040"
  },
  {
    "text": "capabilities your device is able to support stuff like that",
    "start": "2109040",
    "end": "2114960"
  },
  {
    "text": "um this is an example from wi shark where you basically can see a setup packet which is the initial packet sent",
    "start": "2114960",
    "end": "2121000"
  },
  {
    "text": "to the device when you want to establish a call uh for example you can see a display information element in the",
    "start": "2121000",
    "end": "2127160"
  },
  {
    "text": "Middle where it says display John do which is just one of the many supported",
    "start": "2127160",
    "end": "2132520"
  },
  {
    "text": "information elements so how does how how do you actually establish a call um obviously",
    "start": "2132520",
    "end": "2139800"
  },
  {
    "start": "2134000",
    "end": "2134000"
  },
  {
    "text": "there are many messages involved however the first thing which happen happens is the client connects to Port um",
    "start": "2139800",
    "end": "2147200"
  },
  {
    "text": "1720 then the first packet which is sent is a so-called setup packet which indicates the desire to start a",
    "start": "2147200",
    "end": "2153880"
  },
  {
    "text": "connection or to start video call and as it turns out this packet is pared",
    "start": "2153880",
    "end": "2160400"
  },
  {
    "text": "at the remote site even in the case if Al the auto accept feature is turned off",
    "start": "2160400",
    "end": "2165560"
  },
  {
    "text": "which is interesting um so those devices those",
    "start": "2165560",
    "end": "2170599"
  },
  {
    "start": "2168000",
    "end": "2168000"
  },
  {
    "text": "HDX devices they have something called the call detail records which is kind of",
    "start": "2170599",
    "end": "2175920"
  },
  {
    "text": "a database which stores all all the calls so this includes um successful calls but also includes um failed",
    "start": "2175920",
    "end": "2183760"
  },
  {
    "text": "calls and those entries are stored in a um database based on SQL light on the",
    "start": "2183760",
    "end": "2191319"
  },
  {
    "text": "device and every record includes information such as the starting time of a call the reason for failure stuff like",
    "start": "2191319",
    "end": "2198800"
  },
  {
    "text": "that and also includes the remote system name and this one is actually directly",
    "start": "2198800",
    "end": "2204240"
  },
  {
    "text": "taken from this initial setup packet we are sending so as it turns out um there is",
    "start": "2204240",
    "end": "2210560"
  },
  {
    "start": "2208000",
    "end": "2208000"
  },
  {
    "text": "no input validation on this um information element so due to this",
    "start": "2210560",
    "end": "2216319"
  },
  {
    "text": "reason this leads to two different vulnerabilities so the first one is a nice SQL injection because the system",
    "start": "2216319",
    "end": "2224040"
  },
  {
    "text": "name is um used um in the initial in the in the SQL statement to write the CDR",
    "start": "2224040",
    "end": "2229160"
  },
  {
    "text": "entry so in this in this case we just sent a a single setup packet where the",
    "start": "2229160",
    "end": "2234680"
  },
  {
    "text": "system or the display name was set to SQL inject which results in a SQL error message in the",
    "start": "2234680",
    "end": "2240760"
  },
  {
    "text": "log so this Buck looks pretty nice um because you get SQL injection which",
    "start": "2240760",
    "end": "2247119"
  },
  {
    "text": "which with with just a single packet um however it turns out there are some",
    "start": "2247119",
    "end": "2252960"
  },
  {
    "text": "little complications when it comes to exploiting that because um if you take a look at the code the SQL statement is",
    "start": "2252960",
    "end": "2259560"
  },
  {
    "start": "2253000",
    "end": "2253000"
  },
  {
    "text": "actually passed to the SQL light three prepare V2 um APA function and if you",
    "start": "2259560",
    "end": "2266160"
  },
  {
    "text": "take a look at the documentation it tells you that um the the SQL statement",
    "start": "2266160",
    "end": "2271800"
  },
  {
    "text": "only the first part of the statement is actually compiled so if you try to",
    "start": "2271800",
    "end": "2276960"
  },
  {
    "text": "append another SQL statement for example using sem semicolon um this wouldn't work in that case um the typical stuff",
    "start": "2276960",
    "end": "2284119"
  },
  {
    "text": "like Union statements which you would think about um doesn't work either because it's this insert statement um so",
    "start": "2284119",
    "end": "2291079"
  },
  {
    "text": "we played around a bit with it um but actually I couldn't find a way in the limited time we were looking at it to",
    "start": "2291079",
    "end": "2297000"
  },
  {
    "text": "exploit that um obviously if you know a way or find out a way I'm highly",
    "start": "2297000",
    "end": "2302280"
  },
  {
    "text": "interested in it um but for the time being we didn't find a way to exploit",
    "start": "2302280",
    "end": "2307720"
  },
  {
    "text": "that however I said there are two vulnerabilities and the second one is",
    "start": "2307720",
    "end": "2312960"
  },
  {
    "text": "actually um the one we were targeting so um the the complete SQL statement which",
    "start": "2312960",
    "end": "2319079"
  },
  {
    "start": "2314000",
    "end": "2314000"
  },
  {
    "text": "is um which is generated is written to a loog file and they're using the vssn",
    "start": "2319079",
    "end": "2324359"
  },
  {
    "text": "print function and it turns out the complete um SQL statement is passed in the format string",
    "start": "2324359",
    "end": "2331520"
  },
  {
    "text": "parameter so you get um a format string bug so you just send a single setup",
    "start": "2331520",
    "end": "2338520"
  },
  {
    "text": "packet and you set the display information element to something which contains format specifiers like person n",
    "start": "2338520",
    "end": "2344359"
  },
  {
    "text": "person n person n and the device reboots because it crashed um however our goal",
    "start": "2344359",
    "end": "2350560"
  },
  {
    "text": "is not to crash the device but obviously to take control over it so um we",
    "start": "2350560",
    "end": "2355800"
  },
  {
    "start": "2355000",
    "end": "2355000"
  },
  {
    "text": "developed an exploit for the format string bu and it turns out it's pretty simple due to no exploit mitigations at",
    "start": "2355800",
    "end": "2361720"
  },
  {
    "text": "all um you basically use um pretty straightforward format string EXP ation",
    "start": "2361720",
    "end": "2367680"
  },
  {
    "text": "techniques um there are some complications when it comes to details but I mean that's always the case if",
    "start": "2367680",
    "end": "2373359"
  },
  {
    "text": "you're writing exploits right and basically how it works is um we send a s",
    "start": "2373359",
    "end": "2378640"
  },
  {
    "text": "single setup packet which um we turn into our right for primitive so a single",
    "start": "2378640",
    "end": "2383720"
  },
  {
    "text": "setup packet will write four arbitrary bytes in memory at an arbitrary address so we use that in order to",
    "start": "2383720",
    "end": "2390760"
  },
  {
    "text": "basically store our our whole Shell Code in memory at a fixed address because um there's no nothing like like a Orr um",
    "start": "2390760",
    "end": "2398640"
  },
  {
    "text": "then we overwrite a function pointer and basically let it jump into our Shell Code",
    "start": "2398640",
    "end": "2405359"
  },
  {
    "text": "and in order to exploit this one we actually used a pretty simple um system",
    "start": "2405359",
    "end": "2410599"
  },
  {
    "text": "Shell Code which basically where we write a shell command in memory and then",
    "start": "2410599",
    "end": "2415720"
  },
  {
    "text": "execute this shell command um and that one just gives us a back connect show",
    "start": "2415720",
    "end": "2422240"
  },
  {
    "text": "and as I said um the AVC process which we are exploiting here is running as so we get a remote root shell on the",
    "start": "2422240",
    "end": "2429160"
  },
  {
    "text": "device so um now we got root which is nice but um we actually want to use",
    "start": "2429160",
    "end": "2434800"
  },
  {
    "text": "those devices to um do kind of Espionage and we want to control the device and we",
    "start": "2434800",
    "end": "2440960"
  },
  {
    "text": "want to control the microphone and the camera so we were thinking about how to",
    "start": "2440960",
    "end": "2447800"
  },
  {
    "start": "2445000",
    "end": "2445000"
  },
  {
    "text": "actually um find the right code to do that and one of the first ideas was to maybe take a look at the polycom um",
    "start": "2447800",
    "end": "2454800"
  },
  {
    "text": "command shell because this administrative interface has all the functionality inside so it has functions",
    "start": "2454800",
    "end": "2460680"
  },
  {
    "text": "to control the camera and do all the stuff we are interested in so we started reverse engineering that binary um",
    "start": "2460680",
    "end": "2467880"
  },
  {
    "text": "however it turned out that um the binary doesn't actually implement the functional functionality itself but it",
    "start": "2467880",
    "end": "2474520"
  },
  {
    "text": "makes use of a um some kind of internal IPC protocol which is called XCOM IPC",
    "start": "2474520",
    "end": "2480880"
  },
  {
    "text": "which is polycom's internal um IPC mechanism so we had the idea okay",
    "start": "2480880",
    "end": "2487119"
  },
  {
    "text": "we could just use this XCOM IPC mechanism in our own payload to do what we want to",
    "start": "2487119",
    "end": "2492920"
  },
  {
    "text": "do so we reverse engineered the protocol and it turns out it's pretty simple so it's some kind of text based protocol um",
    "start": "2492920",
    "end": "2500520"
  },
  {
    "start": "2493000",
    "end": "2493000"
  },
  {
    "text": "you can it's the server for that protocol is running locally on Port 4121 and it has some kind of",
    "start": "2500520",
    "end": "2507359"
  },
  {
    "text": "asynchronous data receival mechanism and basically what you can do",
    "start": "2507359",
    "end": "2512640"
  },
  {
    "text": "is you can reuse every command from the polycom command shell in this XCOM IPC",
    "start": "2512640",
    "end": "2519839"
  },
  {
    "text": "mechanism so this is how it looks like you basically connect to the local Port 4121 um you have to register um your",
    "start": "2520040",
    "end": "2528400"
  },
  {
    "text": "asynchronous data receival pipe which you don't have to create before so you have to just send the first line as it",
    "start": "2528400",
    "end": "2534800"
  },
  {
    "text": "is and then you can basically send all the commands from the polycom command shell prefix with a c column and",
    "start": "2534800",
    "end": "2541800"
  },
  {
    "text": "obviously there are lot of more commands but you need to do some kind of reverse engineering to find out more",
    "start": "2541800",
    "end": "2548720"
  },
  {
    "text": "commands um So after talking a lot about exploiting those devices I have a small",
    "start": "2548720",
    "end": "2556400"
  },
  {
    "text": "demo prepared which basically shows how we are running the",
    "start": "2556400",
    "end": "2562760"
  },
  {
    "text": "exploit so this is a polycom um web interface which just shows you that we",
    "start": "2562760",
    "end": "2568599"
  },
  {
    "text": "are running on on the version which was current when we did the research which is",
    "start": "2568599",
    "end": "2574800"
  },
  {
    "text": "305 um the IP address of the polycom web inter",
    "start": "2574800",
    "end": "2579960"
  },
  {
    "text": "of the polycom device is",
    "start": "2579960",
    "end": "2583400"
  },
  {
    "text": "218 so on the right you see the polycom um device on the left you see um",
    "start": "2586640",
    "end": "2593720"
  },
  {
    "text": "we first start um our listener for the reverse connect",
    "start": "2593720",
    "end": "2598760"
  },
  {
    "text": "backshell and now we are running the exploit against the device",
    "start": "2601800",
    "end": "2606920"
  },
  {
    "text": "and now it's starting to send lots and lots of setup packets which um first store the Shell Code in memory and as",
    "start": "2606920",
    "end": "2613160"
  },
  {
    "text": "you can see um we are sending setup packets but on the right you don't see any indication at all so there's nothing",
    "start": "2613160",
    "end": "2619480"
  },
  {
    "text": "like a window saying there's an incoming call or something because we don't send any more",
    "start": "2619480",
    "end": "2624520"
  },
  {
    "text": "packets so it takes a while because it now stores the shell command we want to execute in memory now it's over",
    "start": "2624520",
    "end": "2631079"
  },
  {
    "text": "overwriting the function pointer and as you see at the bottom we get our shell",
    "start": "2631079",
    "end": "2636160"
  },
  {
    "text": "so it's running as root so now we got access to the device on the right um and",
    "start": "2636160",
    "end": "2641559"
  },
  {
    "text": "now we um basically just use the W get binary on the device to um receive our payload of",
    "start": "2641559",
    "end": "2649000"
  },
  {
    "text": "course in a real scenario you wouldn't download a binary but Implement all the stuff in your in your payload running in",
    "start": "2649000",
    "end": "2654960"
  },
  {
    "text": "memory to don't leave leave traces behind um but for our demo we just",
    "start": "2654960",
    "end": "2660040"
  },
  {
    "text": "download the binary and execute it on the device so on the right you still see",
    "start": "2660040",
    "end": "2666319"
  },
  {
    "text": "no indication of any compromise so that takes a",
    "start": "2666319",
    "end": "2673680"
  },
  {
    "text": "while now we have to make it executable and then we are running",
    "start": "2676240",
    "end": "2682519"
  },
  {
    "text": "it so the payload needs to receive some",
    "start": "2683520",
    "end": "2688640"
  },
  {
    "text": "additional some additional information some additional files",
    "start": "2690160",
    "end": "2697960"
  },
  {
    "text": "[Laughter] no you see",
    "start": "2701010",
    "end": "2706839"
  },
  {
    "text": "we so it's just displaying some Childish messages playing some sound on the",
    "start": "2707400",
    "end": "2713319"
  },
  {
    "text": "connected video and basically moving the camera around just to show that we have full control over the",
    "start": "2713319",
    "end": "2720000"
  },
  {
    "text": "device so of course in a in a real real Attack you could for example listen in",
    "start": "2720000",
    "end": "2726000"
  },
  {
    "text": "to what's happening in the room do all kinds of stuff all",
    "start": "2726000",
    "end": "2732680"
  },
  {
    "text": "right so I'll stop [Music] that all right so",
    "start": "2733880",
    "end": "2741119"
  },
  {
    "start": "2740000",
    "end": "2740000"
  },
  {
    "text": "um actually before I close um a few words about the the um reporting process",
    "start": "2741119",
    "end": "2747119"
  },
  {
    "text": "because um all the bugs we found we reported them to polycom and actually um",
    "start": "2747119",
    "end": "2752920"
  },
  {
    "text": "they were pretty responsive so um during the last years I reported lots of bugs to different vendors and you know if you",
    "start": "2752920",
    "end": "2759920"
  },
  {
    "text": "if you do the same you know there are some vors which really are not responsive or they they are pretty nice",
    "start": "2759920",
    "end": "2765440"
  },
  {
    "text": "to you they um really tell you everything you get you give them the information and then they stop talking",
    "start": "2765440",
    "end": "2771359"
  },
  {
    "text": "to you um for but with polycom was really nice so the whole time we had",
    "start": "2771359",
    "end": "2777240"
  },
  {
    "text": "really transparent um communication they told me all the details that developers were trying to do and try to publish",
    "start": "2777240",
    "end": "2785160"
  },
  {
    "text": "fixes just before the blackhead talk and they even offered me a test build so I could try to verify the the Box just",
    "start": "2785160",
    "end": "2791960"
  },
  {
    "text": "before the the official publication um so I would say other vs could really learn a lesson from polycom with this",
    "start": "2791960",
    "end": "2799240"
  },
  {
    "text": "regard um so all of the bugs actually are fixed in the most current version",
    "start": "2799240",
    "end": "2804559"
  },
  {
    "text": "which is 3112 which just got released yesterday just in time um yeah and if you're",
    "start": "2804559",
    "end": "2812440"
  },
  {
    "text": "running those devices you should probably update I guess um if you want to have more information about um about",
    "start": "2812440",
    "end": "2819319"
  },
  {
    "text": "the exploit I have shown um all the details about the exploit are actually covered in the white paper so um if",
    "start": "2819319",
    "end": "2826599"
  },
  {
    "text": "you're interested in that just take a look at the paper that's it",
    "start": "2826599",
    "end": "2832680"
  },
  {
    "text": "thanks are there any",
    "start": "2837880",
    "end": "2841440"
  },
  {
    "text": "questions how many actually I spent maybe around a period",
    "start": "2843400",
    "end": "2852520"
  },
  {
    "text": "of two month but I didn't didn't really work full-time on that stuff",
    "start": "2852520",
    "end": "2857720"
  },
  {
    "text": "so it's it's hard to say but yeah maybe a month or two",
    "start": "2857720",
    "end": "2864119"
  },
  {
    "text": "yeah yep any idea of the same things happen in the Cisco",
    "start": "2864119",
    "end": "2869359"
  },
  {
    "text": "environment actually I was planning to take a look at Cisco Hardware as well um but um it was a little bit Pro on",
    "start": "2869359",
    "end": "2875800"
  },
  {
    "text": "problematic to get the hardware um because those",
    "start": "2875800",
    "end": "2880960"
  },
  {
    "text": "oh I got pwned um",
    "start": "2880960",
    "end": "2888400"
  },
  {
    "text": "but it turns out it was kind of um complicated to get the hardware especially because um those kind of",
    "start": "2888400",
    "end": "2895960"
  },
  {
    "text": "devices are pretty expensive um so you can't just buy one of them just to do some some research um but I was actually",
    "start": "2895960",
    "end": "2903960"
  },
  {
    "text": "planning to to look into Cisco as well but I",
    "start": "2903960",
    "end": "2909760"
  },
  {
    "text": "didn't all right then thank you very",
    "start": "2914520",
    "end": "2919760"
  },
  {
    "text": "much",
    "start": "2921559",
    "end": "2924559"
  }
]