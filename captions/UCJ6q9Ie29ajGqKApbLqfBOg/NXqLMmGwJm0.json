[
  {
    "text": "[Music] foreign",
    "start": "1730",
    "end": "6720"
  },
  {
    "text": "thanks for the introduction let's dive in immediately so I think",
    "start": "11760",
    "end": "17940"
  },
  {
    "text": "everyone knows this talk is about starlink I think most of you know how starlink works and what it does but it's a",
    "start": "17940",
    "end": "24480"
  },
  {
    "text": "satellite internet system so as with any satellite-based system you have a space segment and an earth segment",
    "start": "24480",
    "end": "31019"
  },
  {
    "text": "in the space segment we have satellites in this case the satellites might communicate with each other over laser",
    "start": "31019",
    "end": "37200"
  },
  {
    "text": "links and basically the idea is that the user terminal will send its data up to a",
    "start": "37200",
    "end": "43079"
  },
  {
    "text": "satellite and then the satellite sends it back down to an earth-based Gateway and then",
    "start": "43079",
    "end": "48960"
  },
  {
    "text": "in that way you can connect to the internet now for some reason SpaceX wouldn't give",
    "start": "48960",
    "end": "54840"
  },
  {
    "text": "me a satellite so we had to buy a user terminal and that's what this stock is about the",
    "start": "54840",
    "end": "61020"
  },
  {
    "text": "stock is about the user terminal and the idea here is if you can attack the user terminal you can access more of the",
    "start": "61020",
    "end": "67439"
  },
  {
    "text": "network infrastructure that you cannot access without first attacking the user terminal",
    "start": "67439",
    "end": "72840"
  },
  {
    "text": "so we bought one we put it up on the roof of our University building I did a speed test",
    "start": "72840",
    "end": "78780"
  },
  {
    "text": "but that's about it because at that point we have another internet connection and we already had a good one",
    "start": "78780",
    "end": "84420"
  },
  {
    "text": "so I started looking around at what other people had done and there had been a few tear Downs like",
    "start": "84420",
    "end": "89759"
  },
  {
    "text": "Mike on space at the tear down cancers down the signal pad did a more in-depth",
    "start": "89759",
    "end": "95159"
  },
  {
    "text": "analysis of the RF Hardware and then that's basically the point where I started working on my dish and",
    "start": "95159",
    "end": "102180"
  },
  {
    "text": "while I was working on that a few other videos came out going offline did a tear down and he went uh really quite ham at",
    "start": "102180",
    "end": "109380"
  },
  {
    "text": "the dish he used the blow torch to open it up oh like gotkov did a tear down of his",
    "start": "109380",
    "end": "116040"
  },
  {
    "text": "Wi-Fi routers and did a basic analysis of it this is all documented in a nice blog post",
    "start": "116040",
    "end": "121079"
  },
  {
    "text": "and I recently um then married a theorem of his second generation struggling terminal and he also made a 3D printable",
    "start": "121079",
    "end": "128160"
  },
  {
    "text": "case to replace the Pokemon but basically what was lacking for me",
    "start": "128160",
    "end": "134400"
  },
  {
    "text": "and all of these things is that they none of them really went into the security of the device and that's the part that I was obviously interested in",
    "start": "134400",
    "end": "141599"
  },
  {
    "text": "I already mentioned that there have been multiple Hardware revisions of this user terminal but I think very few people",
    "start": "141599",
    "end": "147120"
  },
  {
    "text": "realize how many they actually have been in the past so the circular user terminal the one we",
    "start": "147120",
    "end": "152700"
  },
  {
    "text": "have here on stage as well is about 60 centimeters in diameter it's meant for residential use but as you can see there",
    "start": "152700",
    "end": "159300"
  },
  {
    "text": "have been a lot of Hardware visions of this specific dish you can also see that there has been an",
    "start": "159300",
    "end": "165000"
  },
  {
    "text": "SOC code 3 and SOC code for meaning that there have been at least two silicon",
    "start": "165000",
    "end": "170160"
  },
  {
    "text": "revisions of the main system on ship in this dish then we had the square usage terminal",
    "start": "170160",
    "end": "175379"
  },
  {
    "text": "which is slightly smaller and square that again there have been at least three revisions of the hardware",
    "start": "175379",
    "end": "181560"
  },
  {
    "text": "finally we have the high performance units meant for more business and other uses again they have already been two",
    "start": "181560",
    "end": "188220"
  },
  {
    "text": "collector Innovations of those finally the transceivers there's not that much publicly known about these so",
    "start": "188220",
    "end": "195180"
  },
  {
    "text": "I know from the code that has at least two revisions and the idea will be that you have a transceiver unit with an",
    "start": "195180",
    "end": "200340"
  },
  {
    "text": "external antenna for this talk we will focus on the circular user terminal I specifically",
    "start": "200340",
    "end": "206760"
  },
  {
    "text": "worked on I have two Proto 2 and F2 Port of 4. which means that I did the attack",
    "start": "206760",
    "end": "211800"
  },
  {
    "text": "on the system on ship code 3 anchored 4. all of the other externals use a cut for",
    "start": "211800",
    "end": "218099"
  },
  {
    "text": "SOC so the attack that I present today works on all of these",
    "start": "218099",
    "end": "223220"
  },
  {
    "text": "um so of course we started with the theorem ourselves we moved the plastic shell of the user terminal and then you",
    "start": "223440",
    "end": "228480"
  },
  {
    "text": "are gate it with this enormous metal shield there's a small cutout that shows",
    "start": "228480",
    "end": "234180"
  },
  {
    "text": "you three connectors the first one is the power of ethernet connector then there's a connector for the motors so",
    "start": "234180",
    "end": "240060"
  },
  {
    "text": "normally this dish is on a stand that allows it to orient itself towards the satellite",
    "start": "240060",
    "end": "245340"
  },
  {
    "text": "then the final connector is unpopulated and it contains a uart interface",
    "start": "245340",
    "end": "250439"
  },
  {
    "text": "now those of you that have done heart attack stuff before knowing that if you see it you are connected it's always exciting",
    "start": "250439",
    "end": "256859"
  },
  {
    "text": "because oftentimes you find an easier route shell on the device now that wasn't the case for this SpaceX",
    "start": "256859",
    "end": "263100"
  },
  {
    "text": "terminal so we can see that it does use u-boot but the input is set to null def meaning",
    "start": "263100",
    "end": "269040"
  },
  {
    "text": "that whatever input you provide over the CL connector it won't accept any inputs so you cannot",
    "start": "269040",
    "end": "274680"
  },
  {
    "text": "just get to the u-boot command line interface and change kernel command line arguments",
    "start": "274680",
    "end": "280520"
  },
  {
    "text": "when you allow the dish to completely boot you are greeted with a login prompt and as you can see it prints development",
    "start": "280680",
    "end": "286380"
  },
  {
    "text": "login enabled no because obviously the hardware you buy is not the development Hardware",
    "start": "286380",
    "end": "291600"
  },
  {
    "text": "this also means that whatever you will enter in this user using login forms you won't be able to log in",
    "start": "291600",
    "end": "298680"
  },
  {
    "text": "so this meant basically that we had to go deeper we had to remove the metal shield from the board to see what's on",
    "start": "298680",
    "end": "304020"
  },
  {
    "text": "the inside as I said it's it's really quite big it's 60 centimeters diameter which is",
    "start": "304020",
    "end": "309360"
  },
  {
    "text": "definitely the largest board I had worked on so some areas that you can identify on",
    "start": "309360",
    "end": "314639"
  },
  {
    "text": "this board as a GPS receiver chip there's an area related to power of the",
    "start": "314639",
    "end": "319680"
  },
  {
    "text": "ethernet there's a part of the circuit that generates clocks for both SOC and other",
    "start": "319680",
    "end": "325740"
  },
  {
    "text": "RF Hardware and then we have the area that contains the soc and dram and emmc that's the",
    "start": "325740",
    "end": "332100"
  },
  {
    "text": "part we're most interested in for this talk and then of course there's one area of this dish that I haven't marked and",
    "start": "332100",
    "end": "337740"
  },
  {
    "text": "that's all the other stuff and all the other stuff looks like this so in the middle we have a digital beam",
    "start": "337740",
    "end": "343919"
  },
  {
    "text": "former I see which is made by SDM and it's code name Shiraz each of these beam formats has 16",
    "start": "343919",
    "end": "351600"
  },
  {
    "text": "front-end modules connected to it which are called named pulsar now while I was working on one of these",
    "start": "351600",
    "end": "358639"
  },
  {
    "text": "dishes I got a bit too excited I broke one SpaceX was nice enough to replace it",
    "start": "358639",
    "end": "366120"
  },
  {
    "text": "but I didn't want to just throw it away so I desolded a few of these beam formats and from that modules and I sent",
    "start": "366120",
    "end": "372660"
  },
  {
    "text": "them off to John McMaster it's almost nice enough to decapsulate these chips for me and image them",
    "start": "372660",
    "end": "378419"
  },
  {
    "text": "and starting today I think you can all view these chips online and really zoom in them zoom into them in like higher",
    "start": "378419",
    "end": "384360"
  },
  {
    "text": "resolution another thing you can see like some basic things you can see here like on the left we have the the beam former I",
    "start": "384360",
    "end": "391020"
  },
  {
    "text": "see and you can see that there's 16 parts that we beat and these are basically the 16 channels of the",
    "start": "391020",
    "end": "396479"
  },
  {
    "text": "beamformer the poster chip or the front-end module on the right we can see that it's basically symmetrical meaning",
    "start": "396479",
    "end": "403080"
  },
  {
    "text": "that there's a receive and transmit pad for this chip",
    "start": "403080",
    "end": "408139"
  },
  {
    "text": "then the area that you're most interested in so the biggest chip here is the system on chip",
    "start": "411240",
    "end": "416940"
  },
  {
    "text": "it's a custom quad-core arm cortex a53 made by SDM",
    "start": "416940",
    "end": "422639"
  },
  {
    "text": "as I said there have been multiple silicon revisions of this chip and this one is code named Gatson",
    "start": "422639",
    "end": "428280"
  },
  {
    "text": "we can also see that there's a secure element at the end of the talk I will give more explanation what the secure element is",
    "start": "428280",
    "end": "434280"
  },
  {
    "text": "used for then finally or C in green is a four",
    "start": "434280",
    "end": "439620"
  },
  {
    "text": "gigabyte emmc chip this is basically a fancy SD card you could say",
    "start": "439620",
    "end": "445080"
  },
  {
    "text": "and then there's eight gigabits of DDR3 memory one thing you can see here is that the",
    "start": "445080",
    "end": "451139"
  },
  {
    "text": "main system on ship is in a flip chip styled package with an integrated heat spreader so a metal can on top if you",
    "start": "451139",
    "end": "458940"
  },
  {
    "text": "remove this metal can you give it to the back side of the chip die and from the back side of the die you can also make",
    "start": "458940",
    "end": "464699"
  },
  {
    "text": "an image of the chip so this is an image we made in our lab and so it's a two substrate image it's at 50x",
    "start": "464699",
    "end": "471419"
  },
  {
    "text": "magnification and this is an interesting picture for this as a physical attacker because it allows us to narrow down",
    "start": "471419",
    "end": "477720"
  },
  {
    "text": "certain indexing regions so for certain physical attacks you want to precisely Target a specific area of a",
    "start": "477720",
    "end": "484620"
  },
  {
    "text": "chip and here for example it's very obvious where the force CPU cores are in",
    "start": "484620",
    "end": "489720"
  },
  {
    "text": "this in this picture um the full resolution picture will also be available online",
    "start": "489720",
    "end": "496639"
  },
  {
    "text": "so the next step for me was to extract the firmware from this dish to look at the software and maybe find an easy",
    "start": "497400",
    "end": "502800"
  },
  {
    "text": "vulnerability to get into the into the dish and to do that I had to extract the emmc memory there's several ways of",
    "start": "502800",
    "end": "509819"
  },
  {
    "text": "doing this normally I would extract the chip from the board and then dump it that way",
    "start": "509819",
    "end": "515279"
  },
  {
    "text": "I didn't want to do that in this case because I was afraid of breaking the board so I solved basically wires to all",
    "start": "515279",
    "end": "520500"
  },
  {
    "text": "of these small test points hooked up a logic analyzer and he started the dish and I'm from this logic analyzer phase",
    "start": "520500",
    "end": "527160"
  },
  {
    "text": "it's very easy to spot which test points you need so to read an emmc chip you",
    "start": "527160",
    "end": "532500"
  },
  {
    "text": "only need a clock command and d0 line so if you want to do this at home you now",
    "start": "532500",
    "end": "538380"
  },
  {
    "text": "know which test points to use as I said this is basically an SD card meaning that you can also use an SD card",
    "start": "538380",
    "end": "544980"
  },
  {
    "text": "reader to read out this chip in this case I had to attach a level shifter because the EMC is working at 1.8 volts",
    "start": "544980",
    "end": "553800"
  },
  {
    "text": "um what I would recommend you do if you want to hit create this at home is that you order a low voltage EMC adapter by",
    "start": "553800",
    "end": "559920"
  },
  {
    "text": "the exploit TX it's only 12 and it's very convenient to have that's what I use today but I was still impatient and",
    "start": "559920",
    "end": "566519"
  },
  {
    "text": "that's why I made the other setup so once we have a binary dump of the EMC we can start pulling it apart into the",
    "start": "566519",
    "end": "573420"
  },
  {
    "text": "different pieces the GPL code that's available on GitHub is nice for this because it contains all of the offsets and sizes",
    "start": "573420",
    "end": "580320"
  },
  {
    "text": "so you can see that there are trusted firmware back boot stages these are firmware image packages that you can",
    "start": "580320",
    "end": "586019"
  },
  {
    "text": "extract to the flip tool there's a flattened UI mh3 you can extract a dump image then there",
    "start": "586019",
    "end": "592380"
  },
  {
    "text": "are a few extra partitions around time a calibration that is unique for each dish",
    "start": "592380",
    "end": "598140"
  },
  {
    "text": "an EDR quick station and Dish config and as you can see all of these partitions are protected cryptographically so they",
    "start": "598140",
    "end": "605580"
  },
  {
    "text": "have either varieties signed on looks encrypted and of course the toaster firmware boot stages also Implement",
    "start": "605580",
    "end": "611880"
  },
  {
    "text": "secure boot so this means that we cannot easily override our own firmware to the emmc",
    "start": "611880",
    "end": "617339"
  },
  {
    "text": "chip and get a root shell that would have been too easy if you want more information how you can extract this",
    "start": "617339",
    "end": "622680"
  },
  {
    "text": "firmware there's a Blog Post online that explains it in more detail I often get questions about the firmware",
    "start": "622680",
    "end": "629720"
  },
  {
    "text": "and how certain things of the system work so one thing people have asked in the",
    "start": "629720",
    "end": "634860"
  },
  {
    "text": "past is how does the thermal management work like how hot can it get before it shuts off if you've done the firmware",
    "start": "634860",
    "end": "641040"
  },
  {
    "text": "there's a very nice file with a lot of comments that nicely explains how the thermal management is implemented you",
    "start": "641040",
    "end": "647339"
  },
  {
    "text": "can also find all of the RF channels that are being used the frequencies they",
    "start": "647339",
    "end": "652500"
  },
  {
    "text": "use and the up and downlink channels and how they are prepared you can also find the frequencies of the lasers that they",
    "start": "652500",
    "end": "659459"
  },
  {
    "text": "are using for the satellites because part of the code base between the user's terminal and the satellite is shift",
    "start": "659459",
    "end": "666360"
  },
  {
    "text": "another thing we can see from the code is that they collect a lot of telemetry about what you're doing with your user",
    "start": "666360",
    "end": "672779"
  },
  {
    "text": "terminal I know that some people have mounted a user terminal on top of a car I've even",
    "start": "672779",
    "end": "677820"
  },
  {
    "text": "heard of someone mounting it in the plane you can be sure that SpaceX knows if you did this",
    "start": "677820",
    "end": "683940"
  },
  {
    "text": "another thing that SpaceX does is they keep track of their development Hardware because of course they don't want to",
    "start": "683940",
    "end": "689519"
  },
  {
    "text": "development works we have to get in their own hands and the idea here is that if a dish boots up and it will report when it's",
    "start": "689519",
    "end": "696540"
  },
  {
    "text": "locate basically if it's within a development geofence everything is fine if it's outside of one of these",
    "start": "696540",
    "end": "703260"
  },
  {
    "text": "geofences SpaceX likely gets an alert most of these geofences make a lot of",
    "start": "703260",
    "end": "708660"
  },
  {
    "text": "sense like a parking lot next to this Basics building some of them don't make a lot of sense like the picture on the",
    "start": "708660",
    "end": "714899"
  },
  {
    "text": "right is the connections Museum in Seattle which for some reason is allowed to have development Hardware",
    "start": "714899",
    "end": "721740"
  },
  {
    "text": "there's also some real implications in the code like there's a villa and somewhere in the middle of nowhere I",
    "start": "721740",
    "end": "728399"
  },
  {
    "text": "don't know who it belongs to so I'm not going to share the location if you zoom in far enough on Google Maps",
    "start": "728399",
    "end": "733860"
  },
  {
    "text": "you can actually see that they are likely some music terminals on top of that parking lot so if someone really wants development archway that might be",
    "start": "733860",
    "end": "741240"
  },
  {
    "text": "the place to go now that we have the firmware we can also start looking at how the login",
    "start": "741240",
    "end": "746339"
  },
  {
    "text": "prompt works and it's clear that basically the dish will print development login enabled then it does a",
    "start": "746339",
    "end": "752640"
  },
  {
    "text": "check if it's development doctor it will print yes and set a root password if it's not then no password is set and",
    "start": "752640",
    "end": "759420"
  },
  {
    "text": "you're unable to log in now if we go down a bit more to the physical level this is a logic analyzer",
    "start": "759420",
    "end": "765480"
  },
  {
    "text": "capture of the uart output you can see it prints development login enabled and it's a two millisecond Gap and then it",
    "start": "765480",
    "end": "771779"
  },
  {
    "text": "says no now it will be very interesting for us of course if we can have this dish",
    "start": "771779",
    "end": "776880"
  },
  {
    "text": "believe it is development Hardware and the way we're going to try and do that is using fault injection",
    "start": "776880",
    "end": "782820"
  },
  {
    "text": "so we're going to inject a fault somewhere in between the first print and the second print and hope that we get",
    "start": "782820",
    "end": "788760"
  },
  {
    "text": "looking and if we're talking about fault injection with the flip chip package",
    "start": "788760",
    "end": "794339"
  },
  {
    "text": "that exposes the die back site we usually start thinking about quite fancy techniques like laser fault injection",
    "start": "794339",
    "end": "799680"
  },
  {
    "text": "body bias injection or electromagnetic fault injection but this board is very big so this is",
    "start": "799680",
    "end": "806399"
  },
  {
    "text": "the equipment we have in our lab with the dish next to it the first picture is a",
    "start": "806399",
    "end": "811740"
  },
  {
    "text": "micro positioning table that we would use for emfi but as you can see the box is way too",
    "start": "811740",
    "end": "817560"
  },
  {
    "text": "big to have a mount on this thing on the right we have a box where a laser fault injection setup is in and as you",
    "start": "817560",
    "end": "823440"
  },
  {
    "text": "can see the the dish wouldn't even fit in that box and of course if you would want to do this attack in a real world scenario",
    "start": "823440",
    "end": "829620"
  },
  {
    "text": "where the dish is mounted on a roof um yeah getting a laser setup on a roof with an oscilloscope and so on it's not",
    "start": "829620",
    "end": "835019"
  },
  {
    "text": "very very practical another issue we faced is that there are no open development kits so we had to do",
    "start": "835019",
    "end": "840839"
  },
  {
    "text": "the attack Black Box we didn't have data sheets we didn't have open samples we",
    "start": "840839",
    "end": "845880"
  },
  {
    "text": "didn't even have a similar product from SD to try and do this attack on first",
    "start": "845880",
    "end": "851880"
  },
  {
    "text": "so there's a few more attacks we could try we could try messing with the clock but with a system on chip there's likely",
    "start": "851880",
    "end": "857519"
  },
  {
    "text": "to be plls that inhibit clock glitches line but what I ended up choosing is",
    "start": "857519",
    "end": "864420"
  },
  {
    "text": "voltage fault injection so initially we started with a relatively simple setup we connected the",
    "start": "864420",
    "end": "870420"
  },
  {
    "text": "cheapest player light to the correct voltage supply of the SOC I left all of",
    "start": "870420",
    "end": "875519"
  },
  {
    "text": "the decoupling capacitors on the board because when an SOC is completely booted up it is quite vulnerable to voltage",
    "start": "875519",
    "end": "882240"
  },
  {
    "text": "glitches because it is already being pushed to its limits basically chip Espress can of course be controlled",
    "start": "882240",
    "end": "888060"
  },
  {
    "text": "from python where we can set an offset and a glitch with and we have an external oscilloscope that's not shown",
    "start": "888060",
    "end": "894240"
  },
  {
    "text": "on the slide that triggers on the uart outputs so this is a one result that you can get",
    "start": "894240",
    "end": "900240"
  },
  {
    "text": "so dish pins development login enabled and yes but at the same time because the",
    "start": "900240",
    "end": "905579"
  },
  {
    "text": "no point to the reference in the kernel and the entire system becomes caching down now occasionally you get really lucky",
    "start": "905579",
    "end": "912000"
  },
  {
    "text": "and at pins development log enabled yes you can log in with the username root and a password falcon",
    "start": "912000",
    "end": "917579"
  },
  {
    "text": "and then your route and you can play around with the system so this was nice because it showed that",
    "start": "917579",
    "end": "922980"
  },
  {
    "text": "the soc is susceptible to voltage glitching the attack was easily reproducible by SpaceX even",
    "start": "922980",
    "end": "929699"
  },
  {
    "text": "and it's quite easy to inject some fault but most of them are undesirable and",
    "start": "929699",
    "end": "935699"
  },
  {
    "text": "this also meant that the attack is quite unreliable we only get one attempt every 12 seconds because we have to reboot the",
    "start": "935699",
    "end": "942120"
  },
  {
    "text": "dash to try one attempt and it was hello success rate so it would take many many",
    "start": "942120",
    "end": "947220"
  },
  {
    "text": "hours before you get lucky so I decided to move up into the boot chain and go to the earlier boot stages",
    "start": "947220",
    "end": "954540"
  },
  {
    "text": "so this SOC implements argument meaning that it has a home bootloader as",
    "start": "954540",
    "end": "960360"
  },
  {
    "text": "well as some e-fuse memory this if you start among other things the root of trust public key and the home",
    "start": "960360",
    "end": "967199"
  },
  {
    "text": "bootloader will use that hood of thrust public key to verify the next stages that are stored on the emmc",
    "start": "967199",
    "end": "974040"
  },
  {
    "text": "so in more detail the wrong bootloader or bl1 will load BL2 or the certificate",
    "start": "974040",
    "end": "979380"
  },
  {
    "text": "of BL2 from the emmc the certificate in this case was a custom format made by SD",
    "start": "979380",
    "end": "984959"
  },
  {
    "text": "it contains a hash digest and a signature over that Digest",
    "start": "984959",
    "end": "990740"
  },
  {
    "text": "will verify the certificate so it will verify that the signature is valid",
    "start": "990740",
    "end": "995820"
  },
  {
    "text": "then it loads the next stage firmware the firmware itself and computes the hash and compares the",
    "start": "995820",
    "end": "1002120"
  },
  {
    "text": "hash it computes matches the one stored in the certificate now if you've done something like this",
    "start": "1002120",
    "end": "1008000"
  },
  {
    "text": "before I guess you see that there's two very obvious moments in time where you would try to glitch the soc so one is",
    "start": "1008000",
    "end": "1015320"
  },
  {
    "text": "the signature verification the second one is the hash comparison",
    "start": "1015320",
    "end": "1020360"
  },
  {
    "text": "now because this is a completely Black Box scenario you have really no clue where in time you have to insert the glitch and which of these two positions",
    "start": "1020360",
    "end": "1027199"
  },
  {
    "text": "might work best for you so it boils down to a lot of different attempts basically until you get lucky",
    "start": "1027199",
    "end": "1033798"
  },
  {
    "text": "this is the setup we made to experiment with these things a few things you can do in a black box",
    "start": "1033799",
    "end": "1039260"
  },
  {
    "text": "scenario of course I'm trying to boot a dish with an invalid signature an invalid hash or an invalid firmware",
    "start": "1039260",
    "end": "1044600"
  },
  {
    "text": "image you can also try to glitch a valid certificate into resulting in a",
    "start": "1044600",
    "end": "1049880"
  },
  {
    "text": "signature verification failure and all of these things combined help you to narrow down the right location in time",
    "start": "1049880",
    "end": "1055940"
  },
  {
    "text": "and the other glitch parameters in the top right of this slide you can see an em Probe on top of the die this",
    "start": "1055940",
    "end": "1062299"
  },
  {
    "text": "is the same corner where the first CPU cores are located and this gives us some side Channel information",
    "start": "1062299",
    "end": "1068240"
  },
  {
    "text": "I also removed most of the coupling capacitors in this case because the when the home bootload is executing only a",
    "start": "1068240",
    "end": "1074179"
  },
  {
    "text": "single chorus running and it's running at a lower clock frequency and this makes it less susceptible to voltage glitches",
    "start": "1074179",
    "end": "1080960"
  },
  {
    "text": "this is a side Channel case with the serial output in black and the side channel in blue",
    "start": "1080960",
    "end": "1087200"
  },
  {
    "text": "um at this stage and time basically the dish is printing I have loaded the",
    "start": "1087200",
    "end": "1092360"
  },
  {
    "text": "certificate and I'm going to start checking the signatures and you can see that once the last byte",
    "start": "1092360",
    "end": "1098299"
  },
  {
    "text": "of UF data is loaded into the buffer it will already start the signature verification and this is very useful",
    "start": "1098299",
    "end": "1105620"
  },
  {
    "text": "side Channel information versus the attacker because occasionally when you want to skip a certain function it's easier to glitch",
    "start": "1105620",
    "end": "1112280"
  },
  {
    "text": "at the start of the function and using the site Channel information we know that this computation is already starting when I saw serial data coming",
    "start": "1112280",
    "end": "1119600"
  },
  {
    "text": "out so what we found is if we glitch at the exact start of the signature",
    "start": "1119600",
    "end": "1124700"
  },
  {
    "text": "verification that we can skip it and dial so",
    "start": "1124700",
    "end": "1129799"
  },
  {
    "text": "basically the dish prints I loaded the certificate I'm going to check the signature and immediately after it says",
    "start": "1129799",
    "end": "1136059"
  },
  {
    "text": "signature is valid I'm going to continue booting and you can also obviously see from this side Channel taste that the",
    "start": "1136059",
    "end": "1142820"
  },
  {
    "text": "entire operation is being skipped this was nice because like this means",
    "start": "1142820",
    "end": "1148280"
  },
  {
    "text": "that we can execute our own second stage bootloader and we can start reading memory regions and this way I figured",
    "start": "1148280",
    "end": "1153980"
  },
  {
    "text": "out that um the home bootloader is mapped at the address shown on the slide and it is readable from the second stage",
    "start": "1153980",
    "end": "1160700"
  },
  {
    "text": "so this means we can dump the wrong bootload and start analyzing it",
    "start": "1160700",
    "end": "1166039"
  },
  {
    "text": "I emulated the wrong bootloader in unicorn engine and tried fussing it with AFL plus plus",
    "start": "1166039",
    "end": "1171500"
  },
  {
    "text": "but in this way I didn't find any software vulnerability and of course the software vulnerability would have been nice to make the attack more scalable",
    "start": "1171500",
    "end": "1178880"
  },
  {
    "text": "I also tried simulating my fault attack in unicorn engine and I did this by simulating",
    "start": "1178880",
    "end": "1184640"
  },
  {
    "text": "a basic fault model that assumes a single instruction skip it turns out that a single instruction",
    "start": "1184640",
    "end": "1190460"
  },
  {
    "text": "skip wouldn't actually result in a successful glitch and this is because there are counter measures in",
    "start": "1190460",
    "end": "1196400"
  },
  {
    "text": "implemented in the home bootloaded to prevent this type of attack so obviously the",
    "start": "1196400",
    "end": "1202340"
  },
  {
    "text": "counter measures are implemented or not using the correct model for this specific Hardware",
    "start": "1202340",
    "end": "1207620"
  },
  {
    "text": "so here's an example of when your glitch would be detected by",
    "start": "1207620",
    "end": "1212840"
  },
  {
    "text": "a fault injection counting measures so the first stage of the first part of this output is basically this thing it",
    "start": "1212840",
    "end": "1220100"
  },
  {
    "text": "has loaded the certificate and that it is starting a signature verification and in this case a certificate that we",
    "start": "1220100",
    "end": "1225740"
  },
  {
    "text": "loaded onto the emmc memory contains an invalid signature so the signature should fail",
    "start": "1225740",
    "end": "1231919"
  },
  {
    "text": "once we glitch the dish it continues booting it loads a second stage it verifies the hash but then at the final",
    "start": "1231919",
    "end": "1238820"
  },
  {
    "text": "end it says authentication error and this is because I have certain control flow checks implemented in the",
    "start": "1238820",
    "end": "1245059"
  },
  {
    "text": "codes that basically um cut our glitch there's some more information on the",
    "start": "1245059",
    "end": "1250640"
  },
  {
    "text": "slide about how this is implemented exactly but I don't have a lot of time to go into this today",
    "start": "1250640",
    "end": "1257200"
  },
  {
    "text": "an issue we face now is that we didn't find a software vulnerability in our own bootloader meaning that we would have to",
    "start": "1257419",
    "end": "1263059"
  },
  {
    "text": "glitch the one booth order every single time we reboot the dish and the Annoying product here is that we",
    "start": "1263059",
    "end": "1268580"
  },
  {
    "text": "have to remove the decoupling capacitors to get the glitch to work on the wrong bootload but if you remove too many",
    "start": "1268580",
    "end": "1274460"
  },
  {
    "text": "decoupling capacitors you can no longer boot Linux because the system is way too unstable",
    "start": "1274460",
    "end": "1279559"
  },
  {
    "text": "so I basically have to figure out a way to switch on and off the coupling capacitors at will this took a lot of",
    "start": "1279559",
    "end": "1286640"
  },
  {
    "text": "manual experiments with different mosfets different yeah high side or low side",
    "start": "1286640",
    "end": "1292220"
  },
  {
    "text": "switching different gate voltages most of the drivers capacity sizes the way I was timing the glitch and so",
    "start": "1292220",
    "end": "1298460"
  },
  {
    "text": "on so the first picture on the left is a hand soldered attempt that didn't work the second picture is the first attempt",
    "start": "1298460",
    "end": "1304580"
  },
  {
    "text": "that did actually work so this meant that we could glitch the wrong bootloader and end up in a root",
    "start": "1304580",
    "end": "1309980"
  },
  {
    "text": "shell on Linux this is nice because we demonstrated that the full attack works but it's",
    "start": "1309980",
    "end": "1316760"
  },
  {
    "text": "currently still in a lab scenario right we have an oscilloscope we have power supplies signal generators and so on so",
    "start": "1316760",
    "end": "1322460"
  },
  {
    "text": "it's not really a portable setup so doing this on a roof would be very inconvenient",
    "start": "1322460",
    "end": "1328220"
  },
  {
    "text": "at this point I contacted SpaceX I told them I had the entire attack working they were nice enough to offer me a",
    "start": "1328220",
    "end": "1333860"
  },
  {
    "text": "ubiki that would allow me to SSH into the user terminal but I decided that I was way too far",
    "start": "1333860",
    "end": "1339620"
  },
  {
    "text": "down the rabbit hole and I didn't accept an offer so I wanted to make a mobile setup I",
    "start": "1339620",
    "end": "1346400"
  },
  {
    "text": "wanted to remove the oscilloscope and all of the other lab equipment I'm out of a setup and make a mobile setup this",
    "start": "1346400",
    "end": "1352280"
  },
  {
    "text": "is the first prototype you could say using a raspberry fly pickle to trigger and to inject the glitch this worked but",
    "start": "1352280",
    "end": "1360140"
  },
  {
    "text": "it's of course still messy so I wanted to make a mod chip to make the matchup I put the dish on",
    "start": "1360140",
    "end": "1366799"
  },
  {
    "text": "the flatbed scanner and this gives you a nice one-to-one",
    "start": "1366799",
    "end": "1372280"
  },
  {
    "text": "resolution image of the picture that you can load in inkscape you can then draw the board layout export that to guycat",
    "start": "1372280",
    "end": "1379400"
  },
  {
    "text": "and then you can start making your PCB this is the finished product so we have a Raspberry Pi microcontroller",
    "start": "1379400",
    "end": "1386080"
  },
  {
    "text": "overclocked to 250 megahertz to the triggering and glitching",
    "start": "1386080",
    "end": "1392120"
  },
  {
    "text": "this microcontroller basically controls the mosfet driver and that mosfet driver will switch on and off the decoupling",
    "start": "1392120",
    "end": "1399080"
  },
  {
    "text": "mosfets and also insert the glitch using the gold bar mosfont the board is about six centimeters tall",
    "start": "1399080",
    "end": "1405380"
  },
  {
    "text": "and I use the 0.8 millimeter thick boards one of the goals of this talk is that",
    "start": "1405380",
    "end": "1411020"
  },
  {
    "text": "other people can start playing with the startling system and also the infrastructure and that means that also",
    "start": "1411020",
    "end": "1417080"
  },
  {
    "text": "the mod chip design is available on GitHub the repository is still private but I will make it publicly later today",
    "start": "1417080",
    "end": "1424820"
  },
  {
    "text": "this is a picture of the mud chip installed so there's a few wires that you also have to connect so I'm connecting to a wire that allows me to",
    "start": "1424820",
    "end": "1431240"
  },
  {
    "text": "enable and disable the voltage regulator so that I can basically power cycle the SOC",
    "start": "1431240",
    "end": "1436340"
  },
  {
    "text": "I'm leaching 12 volts from the user terminal to drive the mosfets at 1.8",
    "start": "1436340",
    "end": "1441620"
  },
  {
    "text": "Volts for level shifter this is the setup that someone at our",
    "start": "1441620",
    "end": "1446780"
  },
  {
    "text": "University made so that we could simply hang the dish outside of a window from the lab so we wouldn't always have to go",
    "start": "1446780",
    "end": "1452240"
  },
  {
    "text": "up to the roof if something broke so at this point everything worked I had",
    "start": "1452240",
    "end": "1457400"
  },
  {
    "text": "to put on the user terminal I could connect to the network I had internet access and I was ready to start playing",
    "start": "1457400",
    "end": "1462740"
  },
  {
    "text": "with the network infrastructure and then I had some Reddit posts saying the new firmware is a lot better and",
    "start": "1462740",
    "end": "1468500"
  },
  {
    "text": "it's way more stable and of course because I have the dish mounted flat and right up to the sky the internet",
    "start": "1468500",
    "end": "1473600"
  },
  {
    "text": "connection wasn't very stable so I made a big mistake of doing a firmware update um",
    "start": "1473600",
    "end": "1479600"
  },
  {
    "text": "I had assumed I can glitch the one bootloader there is no way that SpaceX can stop me at this point",
    "start": "1479600",
    "end": "1485120"
  },
  {
    "text": "it turned out that they had an e-fuse they could blow that would stop the dish from outputting any information overly",
    "start": "1485120",
    "end": "1492440"
  },
  {
    "text": "worked so if you take a dish today and you try to connect to the uart product it will not output anything",
    "start": "1492440",
    "end": "1498260"
  },
  {
    "text": "and my mod chip was of course using UF to take action language",
    "start": "1498260",
    "end": "1503380"
  },
  {
    "text": "this means that we have to improvise adapt and overcome I was lucky enough that I started",
    "start": "1503419",
    "end": "1509360"
  },
  {
    "text": "working on this quite early so I had a lot of data from the previous experiments so I could compare logic",
    "start": "1509360",
    "end": "1515900"
  },
  {
    "text": "analyzer captures from before they blew the fuse and after they had bought the fuse and of course I had this very nice",
    "start": "1515900",
    "end": "1521299"
  },
  {
    "text": "side Channel case and as a result if you have the side Channel case and you take a side Channel Taste of the",
    "start": "1521299",
    "end": "1527779"
  },
  {
    "text": "dish with a blown fuse you can visually spot this pattern and figure out where you have to insert the glitch",
    "start": "1527779",
    "end": "1534380"
  },
  {
    "text": "so then I I'm basically now trading on the EMC data zero line instead of uart",
    "start": "1534380",
    "end": "1540140"
  },
  {
    "text": "and I could luckily adapt my mod ship to still work with this it's a bit ugly because I have to add a watch wire",
    "start": "1540140",
    "end": "1547400"
  },
  {
    "text": "basically to make it work but it does work the alternative would have been to make a new PCB design but I didn't get",
    "start": "1547400",
    "end": "1553580"
  },
  {
    "text": "around to doing that so at that point we can start looking of course at the network",
    "start": "1553580",
    "end": "1560419"
  },
  {
    "text": "and if things don't really get easier because the SD safe secure element is",
    "start": "1560419",
    "end": "1565700"
  },
  {
    "text": "being used to implement mutually authenticated TLS with every back-end service meaning that you can't easily",
    "start": "1565700",
    "end": "1572120"
  },
  {
    "text": "intercept the data and modify it and so on this meant that I started adding SD safe",
    "start": "1572120",
    "end": "1577279"
  },
  {
    "text": "support to TLS libraries I chose TLS Lite NG which is a few python implementation because that made things",
    "start": "1577279",
    "end": "1583159"
  },
  {
    "text": "easier for me then go to Python scripts that allowed me to download the latest firmware updates",
    "start": "1583159",
    "end": "1589940"
  },
  {
    "text": "before SpaceX assigns them to this this specific user terminal so whenever",
    "start": "1589940",
    "end": "1595400"
  },
  {
    "text": "someone posts on Reddit saying I have a new update and this is the update version I can immediately go and fetch",
    "start": "1595400",
    "end": "1601100"
  },
  {
    "text": "it so I also started collecting all of these firmware updates and I have my own archive now and this is convenient to",
    "start": "1601100",
    "end": "1607159"
  },
  {
    "text": "see what they changed over time in the firmware most of the communication with the back",
    "start": "1607159",
    "end": "1613640"
  },
  {
    "text": "end is over IPv6 meaning you can't easily scan all of the hosts the main host does have quite a few ports open",
    "start": "1613640",
    "end": "1621020"
  },
  {
    "text": "but here basically I'm hoping that other people will start glitching everyone using thermal I will start looking at",
    "start": "1621020",
    "end": "1626360"
  },
  {
    "text": "the network infrastructure so what else can you do if you build",
    "start": "1626360",
    "end": "1631880"
  },
  {
    "text": "your own modship and start working on a user terminal as I said you can start exploring the network infrastructure but",
    "start": "1631880",
    "end": "1638059"
  },
  {
    "text": "you can also start playing with the beam formers so it's clear that the user thermal is able to overwrite firmware on",
    "start": "1638059",
    "end": "1644840"
  },
  {
    "text": "the binformer ICS themselves so I think some people are interested in playing with this firmware and seeing what else",
    "start": "1644840",
    "end": "1651320"
  },
  {
    "text": "they can do with the beamformers you could also try to repurpose if terminal so maybe you could use two user",
    "start": "1651320",
    "end": "1656960"
  },
  {
    "text": "terminals to implement a point-to-point link or something like that um the picture in the slide shows",
    "start": "1656960",
    "end": "1662720"
  },
  {
    "text": "basically some binaries that are in the firmware that allow you to do some Diagnostics of the beamformers",
    "start": "1662720",
    "end": "1669740"
  },
  {
    "text": "so with that I want to conclude the stock so it turns out that we can bypass",
    "start": "1669740",
    "end": "1675320"
  },
  {
    "text": "secure boot using voltage fault injection in the ROM bootloader we did this on a custom quad-core Aquatics a53",
    "start": "1675320",
    "end": "1682400"
  },
  {
    "text": "in a completely Black Box scenario meaning we had no documentation and we had no open development samples our",
    "start": "1682400",
    "end": "1688340"
  },
  {
    "text": "development kits we came up with a way to enable and disable the coupling capacitors",
    "start": "1688340",
    "end": "1694640"
  },
  {
    "text": "voltage of course default injection counting measures are only as good as the fault model that was used to develop",
    "start": "1694640",
    "end": "1700220"
  },
  {
    "text": "them and in this case the fault model used to develop the full injection countermeasure wasn't a realistic model",
    "start": "1700220",
    "end": "1708039"
  },
  {
    "text": "so from a security standpoint I think this is a well-designed product there was no obvious at least to me low",
    "start": "1708860",
    "end": "1714919"
  },
  {
    "text": "hanging fruits and Encompass to many other embedded devices I've looked at in the past even if you get a root shell it is still",
    "start": "1714919",
    "end": "1721400"
  },
  {
    "text": "quite challenging to find an attack that scales I think there's a lot of device manufacturers that should take a look at",
    "start": "1721400",
    "end": "1727760"
  },
  {
    "text": "this device and learn a thing after the SpaceX product security incidence",
    "start": "1727760",
    "end": "1733039"
  },
  {
    "text": "response team was very responsive and helpful when I broke the dish they were happy to replace it and so on",
    "start": "1733039",
    "end": "1740440"
  },
  {
    "text": "so before I really end this presentation I'm going to attempt to do a live demo",
    "start": "1741140",
    "end": "1746900"
  },
  {
    "text": "it is a live glitching demo a glitch is never deterministic so it can take one minute",
    "start": "1746900",
    "end": "1752960"
  },
  {
    "text": "it can take five minutes five minutes is the longest it's ever taken so let's see",
    "start": "1752960",
    "end": "1758120"
  },
  {
    "text": "if we get lucky today you can find the GitHub link here on the slide if you have more questions you can",
    "start": "1758120",
    "end": "1764480"
  },
  {
    "text": "you can find me later or send me an email",
    "start": "1764480",
    "end": "1768700"
  },
  {
    "text": "so on the left we have a python script that is basically communicating with the modship it can set glitch parameters and",
    "start": "1773720",
    "end": "1780080"
  },
  {
    "text": "it can orchestrate the attack if you were to make a new PCB revision and you can also read the UF data on the",
    "start": "1780080",
    "end": "1787159"
  },
  {
    "text": "Raspberry Pi microcontroller then you could of course also make this Standalone so you wouldn't have to have",
    "start": "1787159",
    "end": "1792380"
  },
  {
    "text": "a computer attached to the dish so by pressing enter we are trying to",
    "start": "1792380",
    "end": "1797899"
  },
  {
    "text": "glitch the dish at this point on the right we have a serial terminal and as you can see it's not outputting",
    "start": "1797899",
    "end": "1804020"
  },
  {
    "text": "anything because that serial fuse is blown on this dish so in the past when I initially started doing this research",
    "start": "1804020",
    "end": "1809600"
  },
  {
    "text": "this would constantly reboot and say invalid signature and you would see it really doing something now we will only",
    "start": "1809600",
    "end": "1816620"
  },
  {
    "text": "see do something when the glitch is successful",
    "start": "1816620",
    "end": "1821440"
  },
  {
    "text": "and this is the point where we wait so maybe if someone already has a",
    "start": "1821960",
    "end": "1827899"
  },
  {
    "text": "question like I can try to answer a question in the meantime",
    "start": "1827899",
    "end": "1832539"
  },
  {
    "text": "at this time we don't have any virtual questions but in audience please feel",
    "start": "1838340",
    "end": "1843620"
  },
  {
    "text": "free to use the microphones I was your level of effort a hundred a",
    "start": "1843620",
    "end": "1850520"
  },
  {
    "text": "thousand ten thousand hours to do this like what kind of scale are we talking yeah that's that's a common and very",
    "start": "1850520",
    "end": "1855799"
  },
  {
    "text": "difficult question to answer um so I I work at the University where I do research and we we never really work",
    "start": "1855799",
    "end": "1862340"
  },
  {
    "text": "full-time on a single project so all of the research was done over the time span of one year so from getting the user",
    "start": "1862340",
    "end": "1869000"
  },
  {
    "text": "terminal to having everything working um but it's difficult for me to say how many hours I really spent on this",
    "start": "1869000",
    "end": "1875720"
  },
  {
    "text": "on this but you can imagine that it took quite a significant amount of time",
    "start": "1875720",
    "end": "1881080"
  },
  {
    "text": "there we go which is successful",
    "start": "1892399",
    "end": "1896020"
  },
  {
    "text": "foreign so to get this to work I also have to",
    "start": "1897919",
    "end": "1903799"
  },
  {
    "text": "patch every single boot stage to remove the signature verification you can also see that I modified u-boot",
    "start": "1903799",
    "end": "1909620"
  },
  {
    "text": "so you add more time to type Falcon and get into the command line interface so finally when the dish completes",
    "start": "1909620",
    "end": "1915919"
  },
  {
    "text": "booting we can log in using the username root have I got it correct",
    "start": "1915919",
    "end": "1922220"
  },
  {
    "text": "and the password falcon and we are root now we can for example do a",
    "start": "1922220",
    "end": "1930020"
  },
  {
    "text": "this and this shows us all the logging messages that I've implemented and it",
    "start": "1930020",
    "end": "1936620"
  },
  {
    "text": "gives a lot of interesting information while the dish is booting but also while the dish is running so for example what you can see when the",
    "start": "1936620",
    "end": "1943460"
  },
  {
    "text": "dish is already connected to the satellite network is it will put into which satellite is connected to when it",
    "start": "1943460",
    "end": "1949340"
  },
  {
    "text": "thinks it's going to lose connection and then the new satellite is going to connect to and you have live satellite",
    "start": "1949340",
    "end": "1954980"
  },
  {
    "text": "tackers online and you can really see the dish connecting to the satellite that's flying over and so on",
    "start": "1954980",
    "end": "1960980"
  },
  {
    "text": "so with that I want to end the talk thank you all for being here [Applause]",
    "start": "1960980",
    "end": "1970360"
  },
  {
    "text": "[Music]",
    "start": "1970360",
    "end": "1973470"
  },
  {
    "text": "[Music]",
    "start": "1977320",
    "end": "1980419"
  }
]