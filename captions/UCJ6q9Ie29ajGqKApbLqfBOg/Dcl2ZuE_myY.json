[
  {
    "text": "hello everybody welcome to off path",
    "start": "0",
    "end": "2760"
  },
  {
    "text": "attacks against public key",
    "start": "2760",
    "end": "3959"
  },
  {
    "text": "infrastructures",
    "start": "3959",
    "end": "5720"
  },
  {
    "text": "my name is Ilya safe dish and I'm a",
    "start": "5720",
    "end": "8400"
  },
  {
    "text": "student at he security researcher for",
    "start": "8400",
    "end": "10800"
  },
  {
    "text": "Villanova Institute for secure",
    "start": "10800",
    "end": "12360"
  },
  {
    "text": "information technology based in",
    "start": "12360",
    "end": "14370"
  },
  {
    "text": "Darmstadt Germany my focus is on",
    "start": "14370",
    "end": "16890"
  },
  {
    "text": "Internet security in general and DNS",
    "start": "16890",
    "end": "18720"
  },
  {
    "text": "caches in particular my talk will be",
    "start": "18720",
    "end": "22710"
  },
  {
    "text": "structured as follows first we go",
    "start": "22710",
    "end": "25170"
  },
  {
    "text": "through the objectives what are we going",
    "start": "25170",
    "end": "26789"
  },
  {
    "text": "to attack and how are we going to do it",
    "start": "26789",
    "end": "28760"
  },
  {
    "text": "followed by a specific attack procedure",
    "start": "28760",
    "end": "31489"
  },
  {
    "text": "short impact analysis and discussion of",
    "start": "31489",
    "end": "35070"
  },
  {
    "text": "mitigation approaches I conclude with a",
    "start": "35070",
    "end": "37800"
  },
  {
    "text": "summary let's start right off with the",
    "start": "37800",
    "end": "41280"
  },
  {
    "text": "objectives in this presentation I'm",
    "start": "41280",
    "end": "45030"
  },
  {
    "text": "going to show you a specific attack on",
    "start": "45030",
    "end": "46890"
  },
  {
    "text": "web PKI",
    "start": "46890",
    "end": "47520"
  },
  {
    "text": "but what is web peek a good for in the",
    "start": "47520",
    "end": "49860"
  },
  {
    "text": "first place",
    "start": "49860",
    "end": "50520"
  },
  {
    "text": "so assume a client wants to exchange",
    "start": "50520",
    "end": "53280"
  },
  {
    "text": "sensitive data with the web server and",
    "start": "53280",
    "end": "56149"
  },
  {
    "text": "that connection wasn't secured it could",
    "start": "56149",
    "end": "59550"
  },
  {
    "text": "be if stopped on or modified by a",
    "start": "59550",
    "end": "62039"
  },
  {
    "text": "nation-state attackers or the common",
    "start": "62039",
    "end": "63570"
  },
  {
    "text": "evildoers to prevent that there's TLS",
    "start": "63570",
    "end": "67920"
  },
  {
    "text": "and TLS use user certificates that bind",
    "start": "67920",
    "end": "71820"
  },
  {
    "text": "the public key to identities and these",
    "start": "71820",
    "end": "75570"
  },
  {
    "text": "certificates are issued by trusted",
    "start": "75570",
    "end": "77189"
  },
  {
    "text": "certificate authorities and the system",
    "start": "77189",
    "end": "79350"
  },
  {
    "text": "that manages trust behind these is the",
    "start": "79350",
    "end": "81810"
  },
  {
    "text": "web PKI if an attacker I used a",
    "start": "81810",
    "end": "86130"
  },
  {
    "text": "certificate which was not signed by a",
    "start": "86130",
    "end": "88049"
  },
  {
    "text": "trusted certificate authority may be on",
    "start": "88049",
    "end": "90150"
  },
  {
    "text": "a man-in-the-middle attack or a",
    "start": "90150",
    "end": "91290"
  },
  {
    "text": "personation attack that attack would be",
    "start": "91290",
    "end": "93420"
  },
  {
    "text": "noticed our goal today is to have such a",
    "start": "93420",
    "end": "96960"
  },
  {
    "text": "certificate issued by a trusted",
    "start": "96960",
    "end": "98460"
  },
  {
    "text": "certificate authority but for a domain",
    "start": "98460",
    "end": "101460"
  },
  {
    "text": "which we do not control but is rather on",
    "start": "101460",
    "end": "103049"
  },
  {
    "text": "the foreign operation the attacker model",
    "start": "103049",
    "end": "106530"
  },
  {
    "text": "we are employing here is an off path",
    "start": "106530",
    "end": "108270"
  },
  {
    "text": "attacker who cannot eavesdrop on blocked",
    "start": "108270",
    "end": "111090"
  },
  {
    "text": "delay or modified packets in any way he",
    "start": "111090",
    "end": "113700"
  },
  {
    "text": "just is able to inject packets may be",
    "start": "113700",
    "end": "115530"
  },
  {
    "text": "with spoofed and address the attack I'm",
    "start": "115530",
    "end": "118590"
  },
  {
    "text": "going to show you will leverage IP the",
    "start": "118590",
    "end": "120270"
  },
  {
    "text": "fermentation cache poisoning to achieve",
    "start": "120270",
    "end": "122549"
  },
  {
    "text": "DNS cache poisoning and we are exporting",
    "start": "122549",
    "end": "124530"
  },
  {
    "text": "domain validation the manual Edition was",
    "start": "124530",
    "end": "128039"
  },
  {
    "text": "the mechanism with which one can prove",
    "start": "128039",
    "end": "131250"
  },
  {
    "text": "ones ownership over domain",
    "start": "131250",
    "end": "133290"
  },
  {
    "text": "and it's not heavily made use of",
    "start": "133290",
    "end": "135590"
  },
  {
    "text": "conditions of certificates let's see how",
    "start": "135590",
    "end": "138420"
  },
  {
    "text": "that works",
    "start": "138420",
    "end": "140810"
  },
  {
    "text": "so first the applicant creates a",
    "start": "141200",
    "end": "144780"
  },
  {
    "text": "certificate signing request locally and",
    "start": "144780",
    "end": "146730"
  },
  {
    "text": "uploads it to the web server of the",
    "start": "146730",
    "end": "148409"
  },
  {
    "text": "certificate authority then the DNS",
    "start": "148409",
    "end": "151590"
  },
  {
    "text": "resolver of the certificate authority",
    "start": "151590",
    "end": "153060"
  },
  {
    "text": "will ask the name server which is",
    "start": "153060",
    "end": "155400"
  },
  {
    "text": "authoritative for the applicants domain",
    "start": "155400",
    "end": "157079"
  },
  {
    "text": "for the email service name and IP",
    "start": "157079",
    "end": "159420"
  },
  {
    "text": "address which will answer that of course",
    "start": "159420",
    "end": "161939"
  },
  {
    "text": "and now the email server sends a",
    "start": "161939",
    "end": "165659"
  },
  {
    "text": "validation code for the domain",
    "start": "165659",
    "end": "167400"
  },
  {
    "text": "validation to the mail server under the",
    "start": "167400",
    "end": "169709"
  },
  {
    "text": "applicants control using that validation",
    "start": "169709",
    "end": "173489"
  },
  {
    "text": "code the applicant can now enter it and",
    "start": "173489",
    "end": "177060"
  },
  {
    "text": "into the web server of the certificate",
    "start": "177060",
    "end": "179459"
  },
  {
    "text": "authority which will then offer the same",
    "start": "179459",
    "end": "182040"
  },
  {
    "text": "certificate for download what we are",
    "start": "182040",
    "end": "185099"
  },
  {
    "text": "going to do now is we are going through",
    "start": "185099",
    "end": "189840"
  },
  {
    "text": "poison doing SEO service cache so that",
    "start": "189840",
    "end": "192450"
  },
  {
    "text": "the validation code is sent to us so to",
    "start": "192450",
    "end": "197189"
  },
  {
    "text": "better understand that",
    "start": "197189",
    "end": "198930"
  },
  {
    "text": "let's first we have some concept of DNS",
    "start": "198930",
    "end": "202400"
  },
  {
    "text": "when a client wants to know an IP",
    "start": "202400",
    "end": "204389"
  },
  {
    "text": "address of hosts on the internet it will",
    "start": "204389",
    "end": "206639"
  },
  {
    "text": "ask its DNS resolver for that and if the",
    "start": "206639",
    "end": "209579"
  },
  {
    "text": "resolver has already cached the answer",
    "start": "209579",
    "end": "211530"
  },
  {
    "text": "from the peers request it will answer",
    "start": "211530",
    "end": "213569"
  },
  {
    "text": "with that phone cache and if not it will",
    "start": "213569",
    "end": "216180"
  },
  {
    "text": "do a recursive lookup of the answer",
    "start": "216180",
    "end": "217680"
  },
  {
    "text": "until the main server which is",
    "start": "217680",
    "end": "221069"
  },
  {
    "text": "authoritative for the domain the host is",
    "start": "221069",
    "end": "223440"
  },
  {
    "text": "located and will answer this question",
    "start": "223440",
    "end": "225690"
  },
  {
    "text": "the resolver can catch the values and",
    "start": "225690",
    "end": "227909"
  },
  {
    "text": "pass them to the client",
    "start": "227909",
    "end": "230810"
  },
  {
    "text": "DNS cache poisoning is simply the",
    "start": "230810",
    "end": "233099"
  },
  {
    "text": "injection of spoofed values into the DNS",
    "start": "233099",
    "end": "235049"
  },
  {
    "text": "resolvers cache in the process to",
    "start": "235049",
    "end": "239549"
  },
  {
    "text": "prevent that",
    "start": "239549",
    "end": "242090"
  },
  {
    "text": "to prevent it there's a challenge",
    "start": "248060",
    "end": "250620"
  },
  {
    "text": "response mechanism built into DNS which",
    "start": "250620",
    "end": "253560"
  },
  {
    "text": "is meant to provide security against off",
    "start": "253560",
    "end": "255330"
  },
  {
    "text": "path attacks and is useless against men",
    "start": "255330",
    "end": "257130"
  },
  {
    "text": "in the middle so what we see here is a",
    "start": "257130",
    "end": "259170"
  },
  {
    "text": "DNS message on the wire you see the IP",
    "start": "259170",
    "end": "262140"
  },
  {
    "text": "header as a blue thing UDP header it's a",
    "start": "262140",
    "end": "265800"
  },
  {
    "text": "yellow thing and the greenish thing is",
    "start": "265800",
    "end": "268230"
  },
  {
    "text": "on the DNS message itself the we",
    "start": "268230",
    "end": "271410"
  },
  {
    "text": "mentioned challenge response scheme",
    "start": "271410",
    "end": "273800"
  },
  {
    "text": "utilizes UDP saw spot randomization as",
    "start": "273800",
    "end": "277370"
  },
  {
    "text": "well as transaction ID randomization and",
    "start": "277370",
    "end": "280550"
  },
  {
    "text": "together these values give us up to 32",
    "start": "280550",
    "end": "284130"
  },
  {
    "text": "random bits guessing this is impractical",
    "start": "284130",
    "end": "288960"
  },
  {
    "text": "for our purposes which is why we're",
    "start": "288960",
    "end": "292110"
  },
  {
    "text": "doing an IP fragmentation attack instead",
    "start": "292110",
    "end": "295040"
  },
  {
    "text": "but what's IP fragmentation in the first",
    "start": "295040",
    "end": "297450"
  },
  {
    "text": "place so assume Alice wants to send pop",
    "start": "297450",
    "end": "300240"
  },
  {
    "text": "a message by a network and the packet",
    "start": "300240",
    "end": "304560"
  },
  {
    "text": "containing the message is bigger than",
    "start": "304560",
    "end": "306780"
  },
  {
    "text": "the network can handle so the maximum",
    "start": "306780",
    "end": "308520"
  },
  {
    "text": "transmission unit MTU of the network is",
    "start": "308520",
    "end": "311430"
  },
  {
    "text": "smaller than the packet size now the",
    "start": "311430",
    "end": "313260"
  },
  {
    "text": "packet needs to get screwed up into",
    "start": "313260",
    "end": "314820"
  },
  {
    "text": "multiple fragments and that can happen",
    "start": "314820",
    "end": "317160"
  },
  {
    "text": "either in a route or on the intermediate",
    "start": "317160",
    "end": "319650"
  },
  {
    "text": "network or if Alice had requested not to",
    "start": "319650",
    "end": "322950"
  },
  {
    "text": "have it split up at a root or the Rooter",
    "start": "322950",
    "end": "324450"
  },
  {
    "text": "will generate an ICMP error message and",
    "start": "324450",
    "end": "326400"
  },
  {
    "text": "send it to Alice indicating that",
    "start": "326400",
    "end": "328590"
  },
  {
    "text": "fragmentation was needed but not",
    "start": "328590",
    "end": "330540"
  },
  {
    "text": "requested to happen the different",
    "start": "330540",
    "end": "334050"
  },
  {
    "text": "mentation cache poisoning which is our",
    "start": "334050",
    "end": "335490"
  },
  {
    "text": "fragmentation attack as also here the",
    "start": "335490",
    "end": "338280"
  },
  {
    "text": "injection of spoofed values this time",
    "start": "338280",
    "end": "340650"
  },
  {
    "text": "into the IP defragmentation cache of the",
    "start": "340650",
    "end": "342840"
  },
  {
    "text": "target of the receiver so that the",
    "start": "342840",
    "end": "346260"
  },
  {
    "text": "spoofed fragments which carry all",
    "start": "346260",
    "end": "347640"
  },
  {
    "text": "malicious payload",
    "start": "347640",
    "end": "348419"
  },
  {
    "text": "get reassembled with the true fragments",
    "start": "348419",
    "end": "351000"
  },
  {
    "text": "coming from the true sender",
    "start": "351000",
    "end": "353930"
  },
  {
    "text": "what we are going to do we want to have",
    "start": "353930",
    "end": "358350"
  },
  {
    "text": "the challenge response values are",
    "start": "358350",
    "end": "359790"
  },
  {
    "text": "located on first fragment and our",
    "start": "359790",
    "end": "361980"
  },
  {
    "text": "malicious payload on the second fragment",
    "start": "361980",
    "end": "365419"
  },
  {
    "text": "we will cause the fragmentation in the",
    "start": "367780",
    "end": "369790"
  },
  {
    "text": "first place using the aforementioned",
    "start": "369790",
    "end": "371230"
  },
  {
    "text": "ICMP error message we're sending this",
    "start": "371230",
    "end": "374200"
  },
  {
    "text": "from our two IP address through the name",
    "start": "374200",
    "end": "376690"
  },
  {
    "text": "server which is authoritative for the",
    "start": "376690",
    "end": "378310"
  },
  {
    "text": "target domain we can do this because the",
    "start": "378310",
    "end": "381160"
  },
  {
    "text": "name server doesn't know we're not a",
    "start": "381160",
    "end": "382300"
  },
  {
    "text": "Rooter in the intermediary network and",
    "start": "382300",
    "end": "385350"
  },
  {
    "text": "we will tell him that if he wants to",
    "start": "385350",
    "end": "387790"
  },
  {
    "text": "send messages to the recursive resolver",
    "start": "387790",
    "end": "391810"
  },
  {
    "text": "of the certificate authority it has to",
    "start": "391810",
    "end": "395950"
  },
  {
    "text": "be aware that the maximum transmission",
    "start": "395950",
    "end": "397120"
  },
  {
    "text": "unit of an intermediary network is one",
    "start": "397120",
    "end": "399520"
  },
  {
    "text": "of our choice having now fragmented the",
    "start": "399520",
    "end": "404860"
  },
  {
    "text": "response which is to become which comes",
    "start": "404860",
    "end": "409600"
  },
  {
    "text": "from the name server of the target alain",
    "start": "409600",
    "end": "411540"
  },
  {
    "text": "the first fragment would look something",
    "start": "411540",
    "end": "414310"
  },
  {
    "text": "like this here we've got the challenge",
    "start": "414310",
    "end": "417160"
  },
  {
    "text": "response fellows values in this fragment",
    "start": "417160",
    "end": "420780"
  },
  {
    "text": "along with parts of the DNS response we",
    "start": "420780",
    "end": "424270"
  },
  {
    "text": "will always have parts of the DNS",
    "start": "424270",
    "end": "425650"
  },
  {
    "text": "response in there because you see IP and",
    "start": "425650",
    "end": "429550"
  },
  {
    "text": "UDP had us together only in this case 28",
    "start": "429550",
    "end": "433240"
  },
  {
    "text": "bytes and thus there will always be some",
    "start": "433240",
    "end": "436240"
  },
  {
    "text": "part of the DNS message message in there",
    "start": "436240",
    "end": "437950"
  },
  {
    "text": "because the IP minimum fragment size 68",
    "start": "437950",
    "end": "442860"
  },
  {
    "text": "also notice we have to match the IP ID",
    "start": "443250",
    "end": "447160"
  },
  {
    "text": "IP idea basically identifies multiple",
    "start": "447160",
    "end": "450220"
  },
  {
    "text": "fragments belonging to one packet and",
    "start": "450220",
    "end": "452729"
  },
  {
    "text": "the UDP checksum which has to match also",
    "start": "452729",
    "end": "457000"
  },
  {
    "text": "notice there are several accounts for",
    "start": "457000",
    "end": "459250"
  },
  {
    "text": "example question count answer record",
    "start": "459250",
    "end": "460870"
  },
  {
    "text": "current additional record count as well",
    "start": "460870",
    "end": "463000"
  },
  {
    "text": "as lengths which are encoded on this",
    "start": "463000",
    "end": "465040"
  },
  {
    "text": "packet and since since this is the",
    "start": "465040",
    "end": "467770"
  },
  {
    "text": "packet which will come from the name",
    "start": "467770",
    "end": "469990"
  },
  {
    "text": "server the target domain as a true",
    "start": "469990",
    "end": "471400"
  },
  {
    "text": "packet which we cannot spoof we do not",
    "start": "471400",
    "end": "473410"
  },
  {
    "text": "have control over these and have to",
    "start": "473410",
    "end": "474790"
  },
  {
    "text": "respect them the second fragment as we",
    "start": "474790",
    "end": "479620"
  },
  {
    "text": "want to spoof it would look something",
    "start": "479620",
    "end": "480729"
  },
  {
    "text": "like this you see here the DNS payload",
    "start": "480729",
    "end": "483550"
  },
  {
    "text": "this is the part which we have control",
    "start": "483550",
    "end": "485110"
  },
  {
    "text": "over as well as IP ID which we have to",
    "start": "485110",
    "end": "488320"
  },
  {
    "text": "guess in the vast majority of systems IP",
    "start": "488320",
    "end": "491110"
  },
  {
    "text": "ID is implemented as a counter either",
    "start": "491110",
    "end": "494590"
  },
  {
    "text": "incrementing on a global basis or local",
    "start": "494590",
    "end": "497229"
  },
  {
    "text": "per destination",
    "start": "497229",
    "end": "498819"
  },
  {
    "text": "and we can guess this by simply sending",
    "start": "498819",
    "end": "502610"
  },
  {
    "text": "direct probes if it's a global counter",
    "start": "502610",
    "end": "504949"
  },
  {
    "text": "or using sir channels but I won't go too",
    "start": "504949",
    "end": "507949"
  },
  {
    "text": "much into detail you also the UDP",
    "start": "507949",
    "end": "513380"
  },
  {
    "text": "checksum can be guessed using the true",
    "start": "513380",
    "end": "515000"
  },
  {
    "text": "second fragment if you look good you",
    "start": "515000",
    "end": "524500"
  },
  {
    "text": "simply subtract one checksum from the",
    "start": "524620",
    "end": "529490"
  },
  {
    "text": "other and what's left over is what you",
    "start": "529490",
    "end": "531290"
  },
  {
    "text": "add up maybe in the Z field zero flex of",
    "start": "531290",
    "end": "534260"
  },
  {
    "text": "the neediness record or if we have",
    "start": "534260",
    "end": "537380"
  },
  {
    "text": "another record which includes so",
    "start": "537380",
    "end": "539510"
  },
  {
    "text": "time-to-live value which is 32 bits an",
    "start": "539510",
    "end": "542750"
  },
  {
    "text": "ordinary load we can simply add these",
    "start": "542750",
    "end": "544700"
  },
  {
    "text": "values of there okay",
    "start": "544700",
    "end": "550300"
  },
  {
    "text": "now that we know how to poison will",
    "start": "558450",
    "end": "560650"
  },
  {
    "text": "resolve us cash let's look how that",
    "start": "560650",
    "end": "562240"
  },
  {
    "text": "would look like in a real attack for",
    "start": "562240",
    "end": "565060"
  },
  {
    "text": "that purpose we've set up attacker and",
    "start": "565060",
    "end": "567250"
  },
  {
    "text": "victim hosts and a respective domains",
    "start": "567250",
    "end": "569650"
  },
  {
    "text": "both are running name servers and mail",
    "start": "569650",
    "end": "572200"
  },
  {
    "text": "source and the name server running under",
    "start": "572200",
    "end": "574690"
  },
  {
    "text": "the attacker serves values that point to",
    "start": "574690",
    "end": "578530"
  },
  {
    "text": "the attacker but I meant to originate in",
    "start": "578530",
    "end": "582730"
  },
  {
    "text": "the victim domain so we're mapping",
    "start": "582730",
    "end": "583900"
  },
  {
    "text": "victim domain names to the attackers",
    "start": "583900",
    "end": "585820"
  },
  {
    "text": "here first step will be sending the ICMP",
    "start": "585820",
    "end": "590560"
  },
  {
    "text": "fragmentation message through the name",
    "start": "590560",
    "end": "593560"
  },
  {
    "text": "server for target to main so that",
    "start": "593560",
    "end": "595540"
  },
  {
    "text": "fragmentation then happens second step",
    "start": "595540",
    "end": "597280"
  },
  {
    "text": "is probing the IP ID which is",
    "start": "597280",
    "end": "599290"
  },
  {
    "text": "implemented here for our demonstration",
    "start": "599290",
    "end": "601000"
  },
  {
    "text": "purposes as a global increment encounter",
    "start": "601000",
    "end": "603400"
  },
  {
    "text": "and using that we can now Forge our",
    "start": "603400",
    "end": "605850"
  },
  {
    "text": "spoofed second fragment and inject it",
    "start": "605850",
    "end": "608440"
  },
  {
    "text": "into the DNS resolvers cache",
    "start": "608440",
    "end": "610380"
  },
  {
    "text": "notice here the second fragment Maps the",
    "start": "610380",
    "end": "614950"
  },
  {
    "text": "victim domain to our name server so if",
    "start": "614950",
    "end": "618760"
  },
  {
    "text": "there is a question for the name server",
    "start": "618760",
    "end": "620680"
  },
  {
    "text": "which is authoritative for the victim",
    "start": "620680",
    "end": "622120"
  },
  {
    "text": "domain it would be answered with the",
    "start": "622120",
    "end": "624340"
  },
  {
    "text": "name server we set up under the attacker",
    "start": "624340",
    "end": "627480"
  },
  {
    "text": "let's see how that looked in a recorded",
    "start": "627480",
    "end": "630250"
  },
  {
    "text": "demo so we've got on the lower left and",
    "start": "630250",
    "end": "632680"
  },
  {
    "text": "that's just a traffic jam for later and",
    "start": "632680",
    "end": "634360"
  },
  {
    "text": "on the upper left that's where the magic",
    "start": "634360",
    "end": "636610"
  },
  {
    "text": "happens now the implementation runs in",
    "start": "636610",
    "end": "645550"
  },
  {
    "text": "an infinite loop which is because we",
    "start": "645550",
    "end": "647830"
  },
  {
    "text": "cannot know when exactly the DNS resolve",
    "start": "647830",
    "end": "651070"
  },
  {
    "text": "and certificate authority will send the",
    "start": "651070",
    "end": "652840"
  },
  {
    "text": "DNS message",
    "start": "652840",
    "end": "654700"
  },
  {
    "text": "the request to the name server and",
    "start": "654700",
    "end": "658050"
  },
  {
    "text": "notice here we're spoofing 64 for second",
    "start": "658050",
    "end": "661390"
  },
  {
    "text": "fragments which is basically the shotgun",
    "start": "661390",
    "end": "663400"
  },
  {
    "text": "approach to guessing the right IP are",
    "start": "663400",
    "end": "664960"
  },
  {
    "text": "you okay now that we've poisoned the IP",
    "start": "664960",
    "end": "671620"
  },
  {
    "text": "defragmentation cache of the DNS",
    "start": "671620",
    "end": "673150"
  },
  {
    "text": "resolver we can go on poisoning the DNS",
    "start": "673150",
    "end": "676210"
  },
  {
    "text": "cache which we got that by simply",
    "start": "676210",
    "end": "678190"
  },
  {
    "text": "issuing the certificate signing request",
    "start": "678190",
    "end": "681010"
  },
  {
    "text": "to the web server of the certificate",
    "start": "681010",
    "end": "682780"
  },
  {
    "text": "authority which will then have its dns",
    "start": "682780",
    "end": "685690"
  },
  {
    "text": "resolver",
    "start": "685690",
    "end": "686260"
  },
  {
    "text": "after two name server of the victim",
    "start": "686260",
    "end": "688450"
  },
  {
    "text": "domain",
    "start": "688450",
    "end": "689500"
  },
  {
    "text": "for the records of a mail server the",
    "start": "689500",
    "end": "693640"
  },
  {
    "text": "name server of the victim domain will",
    "start": "693640",
    "end": "695080"
  },
  {
    "text": "answer fragmented because we have",
    "start": "695080",
    "end": "696760"
  },
  {
    "text": "requested to and this name server",
    "start": "696760",
    "end": "701380"
  },
  {
    "text": "exposes the default behavior which we",
    "start": "701380",
    "end": "703360"
  },
  {
    "text": "see in many name servers which is at",
    "start": "703360",
    "end": "706000"
  },
  {
    "text": "answers the question for the IP address",
    "start": "706000",
    "end": "708430"
  },
  {
    "text": "but along with that it gives updated",
    "start": "708430",
    "end": "711220"
  },
  {
    "text": "values for the name server of the domain",
    "start": "711220",
    "end": "713560"
  },
  {
    "text": "which is what we are also exploiting",
    "start": "713560",
    "end": "715990"
  },
  {
    "text": "here so triggering the DNS request works",
    "start": "715990",
    "end": "722140"
  },
  {
    "text": "like this we're entering here our",
    "start": "722140",
    "end": "724660"
  },
  {
    "text": "certificate signing request and",
    "start": "724660",
    "end": "726990"
  },
  {
    "text": "uploading it using the button now we're",
    "start": "726990",
    "end": "732970"
  },
  {
    "text": "choosing email address under the victim",
    "start": "732970",
    "end": "735280"
  },
  {
    "text": "domain and the request the sent",
    "start": "735280",
    "end": "742710"
  },
  {
    "text": "okay now that we've poisoned the DNS",
    "start": "747300",
    "end": "749640"
  },
  {
    "text": "resolvers cache we can go on exploiting",
    "start": "749640",
    "end": "751649"
  },
  {
    "text": "domain validation which we do we do",
    "start": "751649",
    "end": "754170"
  },
  {
    "text": "another time by issuing another",
    "start": "754170",
    "end": "756149"
  },
  {
    "text": "certificate signing request to the web",
    "start": "756149",
    "end": "758190"
  },
  {
    "text": "server of the certificate authority",
    "start": "758190",
    "end": "761390"
  },
  {
    "text": "now the DNS resolver will ask our name",
    "start": "761810",
    "end": "765510"
  },
  {
    "text": "server which we've set up for the email",
    "start": "765510",
    "end": "767760"
  },
  {
    "text": "address for the IP address of the mail",
    "start": "767760",
    "end": "769769"
  },
  {
    "text": "server of the victim domain because we",
    "start": "769769",
    "end": "771950"
  },
  {
    "text": "injected and poisoned the DNS resolvers",
    "start": "771950",
    "end": "774779"
  },
  {
    "text": "cache we can answer that question with",
    "start": "774779",
    "end": "777839"
  },
  {
    "text": "an IP address which is running under our",
    "start": "777839",
    "end": "780060"
  },
  {
    "text": "host we control that looks something",
    "start": "780060",
    "end": "783750"
  },
  {
    "text": "like this year here we choose another",
    "start": "783750",
    "end": "791820"
  },
  {
    "text": "email address running under the victim",
    "start": "791820",
    "end": "793950"
  },
  {
    "text": "domain and the requests are going out",
    "start": "793950",
    "end": "797970"
  },
  {
    "text": "and now pay attention to the lower left",
    "start": "797970",
    "end": "802260"
  },
  {
    "text": "pane where we see the traffic coming in",
    "start": "802260",
    "end": "808399"
  },
  {
    "text": "there this DNS traffic all right looks",
    "start": "809990",
    "end": "813540"
  },
  {
    "text": "good",
    "start": "813540",
    "end": "815630"
  },
  {
    "text": "okay now the email server will send us",
    "start": "815930",
    "end": "819540"
  },
  {
    "text": "the validation code and we can echo that",
    "start": "819540",
    "end": "822360"
  },
  {
    "text": "the new validation code to the web so of",
    "start": "822360",
    "end": "825390"
  },
  {
    "text": "the certificate authority which will",
    "start": "825390",
    "end": "827820"
  },
  {
    "text": "then offer us the certificate for",
    "start": "827820",
    "end": "829350"
  },
  {
    "text": "download let's see if there worked ok",
    "start": "829350",
    "end": "836390"
  },
  {
    "text": "guess who's got friends whatever what",
    "start": "836390",
    "end": "840510"
  },
  {
    "text": "did they write us",
    "start": "840510",
    "end": "843320"
  },
  {
    "text": "okay here we see it and that email was",
    "start": "846240",
    "end": "849520"
  },
  {
    "text": "sent to the victim domain but we went to",
    "start": "849520",
    "end": "853420"
  },
  {
    "text": "our host the attacker host and that's",
    "start": "853420",
    "end": "855910"
  },
  {
    "text": "the validation code okay we could now go",
    "start": "855910",
    "end": "863500"
  },
  {
    "text": "on we could now go on and enter that in",
    "start": "863500",
    "end": "871540"
  },
  {
    "text": "the forum at the web server which we do",
    "start": "871540",
    "end": "874450"
  },
  {
    "text": "not know we do not do here because we're",
    "start": "874450",
    "end": "876520"
  },
  {
    "text": "not evil but we could and then we were",
    "start": "876520",
    "end": "879310"
  },
  {
    "text": "able to download the certificate using",
    "start": "879310",
    "end": "882460"
  },
  {
    "text": "this certificate we could then go on and",
    "start": "882460",
    "end": "885220"
  },
  {
    "text": "impersonate a service running under the",
    "start": "885220",
    "end": "887710"
  },
  {
    "text": "victim domain plausibly meaning the",
    "start": "887710",
    "end": "891340"
  },
  {
    "text": "attack would not be noticed if there",
    "start": "891340",
    "end": "892930"
  },
  {
    "text": "were even a first-year lesson news",
    "start": "892930",
    "end": "894730"
  },
  {
    "text": "because our certificate signed by a",
    "start": "894730",
    "end": "897160"
  },
  {
    "text": "trusted certificate authority",
    "start": "897160",
    "end": "900509"
  },
  {
    "text": "let's go on and see what that means for",
    "start": "914260",
    "end": "916550"
  },
  {
    "text": "the victims",
    "start": "916550",
    "end": "917210"
  },
  {
    "text": "so for victim users the implications are",
    "start": "917210",
    "end": "920750"
  },
  {
    "text": "derived from any successful attack on",
    "start": "920750",
    "end": "922760"
  },
  {
    "text": "TLS session we could where we have a man",
    "start": "922760",
    "end": "927500"
  },
  {
    "text": "in the middle for example we could",
    "start": "927500",
    "end": "928610"
  },
  {
    "text": "inject malware or still credential",
    "start": "928610",
    "end": "930770"
  },
  {
    "text": "sensitive data identity you name it and",
    "start": "930770",
    "end": "933850"
  },
  {
    "text": "if such an attack gets public that",
    "start": "933850",
    "end": "936410"
  },
  {
    "text": "usually means a lot of loss of",
    "start": "936410",
    "end": "938330"
  },
  {
    "text": "reputation and Trust for the victim",
    "start": "938330",
    "end": "940490"
  },
  {
    "text": "certificate authority as well as for the",
    "start": "940490",
    "end": "943280"
  },
  {
    "text": "target domain but how real are these",
    "start": "943280",
    "end": "947540"
  },
  {
    "text": "attacks well we tested 17 certificate",
    "start": "947540",
    "end": "950510"
  },
  {
    "text": "authorities that perform the main",
    "start": "950510",
    "end": "952040"
  },
  {
    "text": "validation and together I cover more",
    "start": "952040",
    "end": "954590"
  },
  {
    "text": "than 95% of the certificate market five",
    "start": "954590",
    "end": "957560"
  },
  {
    "text": "of them are vulnerable but already one",
    "start": "957560",
    "end": "959390"
  },
  {
    "text": "vulnerable certificate authority is",
    "start": "959390",
    "end": "960980"
  },
  {
    "text": "sufficient to obtain the target",
    "start": "960980",
    "end": "962840"
  },
  {
    "text": "certificate which means we're PKI",
    "start": "962840",
    "end": "965090"
  },
  {
    "text": "security is on the mind",
    "start": "965090",
    "end": "968380"
  },
  {
    "text": "all right doesn't sound good how could",
    "start": "978410",
    "end": "980570"
  },
  {
    "text": "we prevent this or at least make it",
    "start": "980570",
    "end": "981920"
  },
  {
    "text": "Aurra let's first have a look at the",
    "start": "981920",
    "end": "985790"
  },
  {
    "text": "preconditions of the attack for those we",
    "start": "985790",
    "end": "988280"
  },
  {
    "text": "exploited two main validation so this",
    "start": "988280",
    "end": "990320"
  },
  {
    "text": "needs to be offered in the first place",
    "start": "990320",
    "end": "991750"
  },
  {
    "text": "we did an IP fragmentation attacks or IP",
    "start": "991750",
    "end": "994670"
  },
  {
    "text": "fragmentation needs to be allowed both",
    "start": "994670",
    "end": "996710"
  },
  {
    "text": "on the victim name server of attack",
    "start": "996710",
    "end": "998120"
  },
  {
    "text": "domain as well as in the certificate",
    "start": "998120",
    "end": "1000310"
  },
  {
    "text": "authorities network and also we targeted",
    "start": "1000310",
    "end": "1003640"
  },
  {
    "text": "DNS via UDP so then could we just is",
    "start": "1003640",
    "end": "1008500"
  },
  {
    "text": "able to manually d--ation",
    "start": "1008500",
    "end": "1009610"
  },
  {
    "text": "if it's attackable well we could but",
    "start": "1009610",
    "end": "1012880"
  },
  {
    "text": "would leave us only with much more",
    "start": "1012880",
    "end": "1014680"
  },
  {
    "text": "expensive alternatives not the way to go",
    "start": "1014680",
    "end": "1018600"
  },
  {
    "text": "what about suppressing IP fragmentation",
    "start": "1018810",
    "end": "1022200"
  },
  {
    "text": "also we could and some certificate",
    "start": "1022200",
    "end": "1024520"
  },
  {
    "text": "authorities actually do this but this",
    "start": "1024520",
    "end": "1026709"
  },
  {
    "text": "would disconnect some networks so only",
    "start": "1026709",
    "end": "1028870"
  },
  {
    "text": "last resort defense mechanism here",
    "start": "1028870",
    "end": "1031240"
  },
  {
    "text": "definitely",
    "start": "1031240",
    "end": "1032010"
  },
  {
    "text": "what about forcing dienes of the over",
    "start": "1032010",
    "end": "1034420"
  },
  {
    "text": "TCP rather than using UDP also we could",
    "start": "1034420",
    "end": "1039160"
  },
  {
    "text": "but off path TCP injection attacks to",
    "start": "1039160",
    "end": "1041560"
  },
  {
    "text": "exist let alone primarily on HTTP HTTP",
    "start": "1041560",
    "end": "1045459"
  },
  {
    "text": "traffic for example making assumptions",
    "start": "1045459",
    "end": "1047290"
  },
  {
    "text": "about the upper layers but it's probable",
    "start": "1047290",
    "end": "1049660"
  },
  {
    "text": "that such attacks will be developed in",
    "start": "1049660",
    "end": "1051970"
  },
  {
    "text": "the future to also notice that we've",
    "start": "1051970",
    "end": "1055480"
  },
  {
    "text": "seen an increase in charlief BGP prefix",
    "start": "1055480",
    "end": "1060130"
  },
  {
    "text": "hijacking attacks with the purpose of",
    "start": "1060130",
    "end": "1061990"
  },
  {
    "text": "doing a man-in-the-middle on DNS cache",
    "start": "1061990",
    "end": "1063850"
  },
  {
    "text": "poisoned manual middle for DNS cache",
    "start": "1063850",
    "end": "1066460"
  },
  {
    "text": "poisoning and the challenge response",
    "start": "1066460",
    "end": "1069580"
  },
  {
    "text": "values which we have seen before do not",
    "start": "1069580",
    "end": "1071320"
  },
  {
    "text": "offer security against men in the middle",
    "start": "1071320",
    "end": "1072880"
  },
  {
    "text": "because the men in the middle could just",
    "start": "1072880",
    "end": "1074650"
  },
  {
    "text": "see the values and yeah echo them no",
    "start": "1074650",
    "end": "1077260"
  },
  {
    "text": "problem here",
    "start": "1077260",
    "end": "1079720"
  },
  {
    "text": "things like this happened for example I",
    "start": "1079720",
    "end": "1082480"
  },
  {
    "text": "think it was in in May when users of",
    "start": "1082480",
    "end": "1086170"
  },
  {
    "text": "those alpha cryptocurrency service my",
    "start": "1086170",
    "end": "1090820"
  },
  {
    "text": "ether wallet fell prey to an",
    "start": "1090820",
    "end": "1092680"
  },
  {
    "text": "impersonation attack yes and this attack",
    "start": "1092680",
    "end": "1097000"
  },
  {
    "text": "was not a spoof certificate used and",
    "start": "1097000",
    "end": "1102250"
  },
  {
    "text": "it's not a valid certificate so at the",
    "start": "1102250",
    "end": "1104320"
  },
  {
    "text": "attackers use our approach to getting",
    "start": "1104320",
    "end": "1106300"
  },
  {
    "text": "certificate authority",
    "start": "1106300",
    "end": "1107790"
  },
  {
    "text": "signed certificate us this attack would",
    "start": "1107790",
    "end": "1110980"
  },
  {
    "text": "have been much",
    "start": "1110980",
    "end": "1111670"
  },
  {
    "text": "whatever staging yeah looks like we like",
    "start": "1111670",
    "end": "1117070"
  },
  {
    "text": "we need to mend the middle resilient to",
    "start": "1117070",
    "end": "1118420"
  },
  {
    "text": "man validation at least a long",
    "start": "1118420",
    "end": "1119890"
  },
  {
    "text": "perspective how could we do this one",
    "start": "1119890",
    "end": "1124090"
  },
  {
    "text": "approach would be doing DNS over HTTP or",
    "start": "1124090",
    "end": "1126190"
  },
  {
    "text": "TLS but that would mean we're securing a",
    "start": "1126190",
    "end": "1128830"
  },
  {
    "text": "public key infrastructure with a very",
    "start": "1128830",
    "end": "1130750"
  },
  {
    "text": "same public key infrastructure so we're",
    "start": "1130750",
    "end": "1133270"
  },
  {
    "text": "assuming security concludes security",
    "start": "1133270",
    "end": "1135250"
  },
  {
    "text": "nothing one here another approach is",
    "start": "1135250",
    "end": "1138400"
  },
  {
    "text": "seen ethic which is certainly the way to",
    "start": "1138400",
    "end": "1140140"
  },
  {
    "text": "go",
    "start": "1140140",
    "end": "1140500"
  },
  {
    "text": "so DNS records get signed by the owner",
    "start": "1140500",
    "end": "1143980"
  },
  {
    "text": "and we're using basically public",
    "start": "1143980",
    "end": "1146350"
  },
  {
    "text": "infrastructure built into DNS but given",
    "start": "1146350",
    "end": "1149470"
  },
  {
    "text": "that it was drafted in the mid-90s and",
    "start": "1149470",
    "end": "1151810"
  },
  {
    "text": "it's still not properly deployed we",
    "start": "1151810",
    "end": "1154120"
  },
  {
    "text": "cannot rely on that one which is why we",
    "start": "1154120",
    "end": "1157360"
  },
  {
    "text": "had gone over have come up with a",
    "start": "1157360",
    "end": "1158740"
  },
  {
    "text": "probably placement we call domain",
    "start": "1158740",
    "end": "1160570"
  },
  {
    "text": "validation plus plus or DV plus plus the",
    "start": "1160570",
    "end": "1164440"
  },
  {
    "text": "U plus plus uses multiple vantage points",
    "start": "1164440",
    "end": "1166870"
  },
  {
    "text": "or AV agent which are distributed over",
    "start": "1166870",
    "end": "1168550"
  },
  {
    "text": "the Internet and communicate with an",
    "start": "1168550",
    "end": "1170740"
  },
  {
    "text": "Orchestrator in the certificate",
    "start": "1170740",
    "end": "1173170"
  },
  {
    "text": "authority the DV agents all do the DNS",
    "start": "1173170",
    "end": "1175990"
  },
  {
    "text": "part of the main validation and",
    "start": "1175990",
    "end": "1180300"
  },
  {
    "text": "communicate via HTTPS with the",
    "start": "1180360",
    "end": "1182440"
  },
  {
    "text": "orchestrator who does the voting of the",
    "start": "1182440",
    "end": "1184750"
  },
  {
    "text": "DNS responses and communication was done",
    "start": "1184750",
    "end": "1190180"
  },
  {
    "text": "by HTTPS using out of PKS certificates",
    "start": "1190180",
    "end": "1192550"
  },
  {
    "text": "picture dialect directory trusted",
    "start": "1192550",
    "end": "1194650"
  },
  {
    "text": "certificates because if we use",
    "start": "1194650",
    "end": "1196720"
  },
  {
    "text": "certificates which are part of the web",
    "start": "1196720",
    "end": "1198880"
  },
  {
    "text": "PKI that would again be relying on a PKI",
    "start": "1198880",
    "end": "1202090"
  },
  {
    "text": "for securing the very same public",
    "start": "1202090",
    "end": "1203920"
  },
  {
    "text": "infrastructure communication happens",
    "start": "1203920",
    "end": "1207370"
  },
  {
    "text": "over mostly not overlapping paths",
    "start": "1207370",
    "end": "1209110"
  },
  {
    "text": "through the internet and that aims at",
    "start": "1209110",
    "end": "1211900"
  },
  {
    "text": "securing the certificate authority side",
    "start": "1211900",
    "end": "1214590"
  },
  {
    "text": "even for strongmen in the middle",
    "start": "1214590",
    "end": "1216880"
  },
  {
    "text": "nation-state attackers",
    "start": "1216880",
    "end": "1219840"
  },
  {
    "text": "okay time to draw the conclusions",
    "start": "1230700",
    "end": "1234030"
  },
  {
    "text": "the summary we've seen a rough past",
    "start": "1234030",
    "end": "1237880"
  },
  {
    "text": "attack against the main validation which",
    "start": "1237880",
    "end": "1240480"
  },
  {
    "text": "leveraged IP defragmentation cache",
    "start": "1240480",
    "end": "1242770"
  },
  {
    "text": "poisoning to achieve DNS cache poisoning",
    "start": "1242770",
    "end": "1244660"
  },
  {
    "text": "and using that we were able to acquire",
    "start": "1244660",
    "end": "1247120"
  },
  {
    "text": "fraudulent certificates for domains",
    "start": "1247120",
    "end": "1249580"
  },
  {
    "text": "which are on the foreign operation",
    "start": "1249580",
    "end": "1252390"
  },
  {
    "text": "this means ultimately if leave web PKI",
    "start": "1252390",
    "end": "1255910"
  },
  {
    "text": "which is meant to provide security even",
    "start": "1255910",
    "end": "1258190"
  },
  {
    "text": "against strongmen the middle attackers",
    "start": "1258190",
    "end": "1259720"
  },
  {
    "text": "relies on a weak building block that can",
    "start": "1259720",
    "end": "1262840"
  },
  {
    "text": "be circumvented by a week of path",
    "start": "1262840",
    "end": "1264490"
  },
  {
    "text": "attacker thank you for your attention",
    "start": "1264490",
    "end": "1270190"
  },
  {
    "text": "[Applause]",
    "start": "1270190",
    "end": "1277500"
  },
  {
    "text": "all right questions",
    "start": "1277500",
    "end": "1281130"
  },
  {
    "text": "do you have any evidence of this",
    "start": "1288660",
    "end": "1290620"
  },
  {
    "text": "happening for boy real I thought we just",
    "start": "1290620",
    "end": "1293440"
  },
  {
    "text": "disclosed this this type of attack I",
    "start": "1293440",
    "end": "1295810"
  },
  {
    "text": "think in October was and we did not",
    "start": "1295810",
    "end": "1299050"
  },
  {
    "text": "collect any evidence on that yet so it's",
    "start": "1299050",
    "end": "1301240"
  },
  {
    "text": "very recently disclosed no data",
    "start": "1301240",
    "end": "1303910"
  },
  {
    "text": "available yet you mentioned that at the",
    "start": "1303910",
    "end": "1319450"
  },
  {
    "text": "17 CAS you try it was only it worked on",
    "start": "1319450",
    "end": "1322270"
  },
  {
    "text": "five of them what are the reasons that",
    "start": "1322270",
    "end": "1325710"
  },
  {
    "text": "what are the other reasons that it",
    "start": "1325710",
    "end": "1327700"
  },
  {
    "text": "didn't work on the the rest of them and",
    "start": "1327700",
    "end": "1329560"
  },
  {
    "text": "are those potential mitigation",
    "start": "1329560",
    "end": "1331290"
  },
  {
    "text": "mechanisms okay as I mentioned for",
    "start": "1331290",
    "end": "1336280"
  },
  {
    "text": "example that not every UCA supports",
    "start": "1336280",
    "end": "1338290"
  },
  {
    "text": "fragmentation and against that very",
    "start": "1338290",
    "end": "1340420"
  },
  {
    "text": "specific attack we did the IP",
    "start": "1340420",
    "end": "1342310"
  },
  {
    "text": "fragmentation attack that helps",
    "start": "1342310",
    "end": "1344200"
  },
  {
    "text": "obviously also it's quite difficult to",
    "start": "1344200",
    "end": "1348280"
  },
  {
    "text": "forge through the second fragment given",
    "start": "1348280",
    "end": "1349900"
  },
  {
    "text": "that you don't always have control or",
    "start": "1349900",
    "end": "1352150"
  },
  {
    "text": "you don't have the most degree of",
    "start": "1352150",
    "end": "1355240"
  },
  {
    "text": "control over a second fragment given",
    "start": "1355240",
    "end": "1356950"
  },
  {
    "text": "that the counts and lengths and call it",
    "start": "1356950",
    "end": "1359530"
  },
  {
    "text": "in first fragment so I wouldn't call",
    "start": "1359530",
    "end": "1363910"
  },
  {
    "text": "that real right a reliable mitigation",
    "start": "1363910",
    "end": "1366670"
  },
  {
    "text": "mechanism thoughts yes okay so in DV",
    "start": "1366670",
    "end": "1372640"
  },
  {
    "text": "plus plus as you described it there's",
    "start": "1372640",
    "end": "1374440"
  },
  {
    "text": "multiple vantage points of this right",
    "start": "1374440",
    "end": "1376720"
  },
  {
    "text": "here there's multiple vantage points in",
    "start": "1376720",
    "end": "1379480"
  },
  {
    "text": "which you do the D the DNS query do",
    "start": "1379480",
    "end": "1383320"
  },
  {
    "text": "those is there any advantage to having",
    "start": "1383320",
    "end": "1386350"
  },
  {
    "text": "those vantage points be unpredictable or",
    "start": "1386350",
    "end": "1389220"
  },
  {
    "text": "different every time or is it fine to",
    "start": "1389220",
    "end": "1392890"
  },
  {
    "text": "have these multiple vantage points be",
    "start": "1392890",
    "end": "1394720"
  },
  {
    "text": "statically configured okay I didn't",
    "start": "1394720",
    "end": "1400810"
  },
  {
    "text": "think about this yet actually a good",
    "start": "1400810",
    "end": "1402790"
  },
  {
    "text": "question I don't think there would be",
    "start": "1402790",
    "end": "1407050"
  },
  {
    "text": "too much use but maybe as an add-on from",
    "start": "1407050",
    "end": "1410680"
  },
  {
    "text": "increased security if you really need",
    "start": "1410680",
    "end": "1412690"
  },
  {
    "text": "that maybe I can research that if you",
    "start": "1412690",
    "end": "1415300"
  },
  {
    "text": "want to just leave me your email address",
    "start": "1415300",
    "end": "1416980"
  },
  {
    "text": "and I can send you the answer",
    "start": "1416980",
    "end": "1419720"
  },
  {
    "text": "okay thank you",
    "start": "1419720",
    "end": "1422590"
  },
  {
    "text": "no questions alright and thank you for",
    "start": "1432920",
    "end": "1436610"
  },
  {
    "text": "your attention",
    "start": "1436610",
    "end": "1437190"
  },
  {
    "text": "[Applause]",
    "start": "1437190",
    "end": "1440768"
  }
]