[
  {
    "text": "this session is I know your filtering policy better than you do external enumeration and exploitation of email",
    "start": "120",
    "end": "7480"
  },
  {
    "text": "and web Security Solutions and your speaker is Ben",
    "start": "7480",
    "end": "12160"
  },
  {
    "text": "Williams good",
    "start": "17279",
    "end": "20439"
  },
  {
    "text": "morning we got video there HDMI",
    "start": "26800",
    "end": "34239"
  },
  {
    "text": "3 sorry number one number",
    "start": "34239",
    "end": "39079"
  },
  {
    "text": "one there we go that's better well welcome it's Vegas and it's",
    "start": "39840",
    "end": "46320"
  },
  {
    "text": "9:00 a.m. so you've done well to get here I know some of you probably got um",
    "start": "46320",
    "end": "51840"
  },
  {
    "text": "jaet lag so you're probably up since 4:00 a.m. if you travel from Europe like I have um and some of you may even have",
    "start": "51840",
    "end": "58760"
  },
  {
    "text": "been up all night but well done in either case so my name is Ben Williams",
    "start": "58760",
    "end": "64559"
  },
  {
    "text": "I'm a penetration tester and I work for NCC group in the UK um so I'm going to",
    "start": "64559",
    "end": "70720"
  },
  {
    "text": "talk to you today about well it's in the class of auditing but you could say it",
    "start": "70720",
    "end": "76560"
  },
  {
    "text": "could either be done offensively or defensively so it fits into kind of both",
    "start": "76560",
    "end": "82640"
  },
  {
    "text": "categories so um my day-to-day job as a penetration tester is trying to um gain",
    "start": "82640",
    "end": "90200"
  },
  {
    "text": "unauthorized access to internal networks external networks web applications that kind of thing so I'm very much thinking",
    "start": "90200",
    "end": "96240"
  },
  {
    "text": "in the attacker mindset uh so I'm going to give a a little bit of background about some of the talks I've uh given previously and",
    "start": "96240",
    "end": "104320"
  },
  {
    "text": "then I'm going to do a section on enumerating web filtering Solutions and then I'm going to talk about enumerating",
    "start": "104320",
    "end": "110680"
  },
  {
    "text": "email filtering Solutions and as I go I'll talk about bypassing these Solutions and give a little bit of",
    "start": "110680",
    "end": "116719"
  },
  {
    "text": "summary at the end I've spoken previously for black hat uh black hat",
    "start": "116719",
    "end": "122119"
  },
  {
    "text": "Europe a couple of times on hacking appliances uh so finding vulnerabilities",
    "start": "122119",
    "end": "127439"
  },
  {
    "text": "in in web security and email security appliances firewalls uh remote access gateways that",
    "start": "127439",
    "end": "134480"
  },
  {
    "text": "kind of stuff but this talk is a little bit different because previously I've talked about vulnerabilities in the",
    "start": "134480",
    "end": "140599"
  },
  {
    "text": "product themselves which meant that an attacker could take control of those Security Solutions and I've demonstrated",
    "start": "140599",
    "end": "147519"
  },
  {
    "text": "getting root shell on various different applian in these previous talks um within those couple of talks I talked",
    "start": "147519",
    "end": "154560"
  },
  {
    "text": "about vulnerabilities in products from about 12 different vendors so those were attacks against",
    "start": "154560",
    "end": "160920"
  },
  {
    "text": "the products themselves to take control of them this presentation is a little bit different because I'm talking about",
    "start": "160920",
    "end": "167360"
  },
  {
    "text": "uh enumerating the policies and products from the outside and using that to",
    "start": "167360",
    "end": "173400"
  },
  {
    "text": "bypass the policies which are in place so",
    "start": "173400",
    "end": "181280"
  },
  {
    "text": "um previously I've shown kind of high severity issues so today I'm going to be talking about low severity issues so",
    "start": "181280",
    "end": "189200"
  },
  {
    "text": "let's hear it for the low severity issues why why are these really interesting they're interesting to me",
    "start": "189200",
    "end": "194400"
  },
  {
    "text": "because low severity issues nobody really wants to take ownership of fixing those you know",
    "start": "194400",
    "end": "200840"
  },
  {
    "text": "they're at the bottom of the list um but they can be generic so they can span a lot of different products and they can",
    "start": "200840",
    "end": "207360"
  },
  {
    "text": "be persistent they last a long time cuz no want to fix them and most of the issues that I'm",
    "start": "207360",
    "end": "213480"
  },
  {
    "text": "going to be talking about today are exploiting well not even exploiting",
    "start": "213480",
    "end": "219120"
  },
  {
    "text": "because I'm not going to show you any exploits it feels weird to be standing up here like not showing you any",
    "start": "219120",
    "end": "224280"
  },
  {
    "text": "exploits I'm going to show you a few little tricks but there's no SQL injection no cross site scripting no",
    "start": "224280",
    "end": "231159"
  },
  {
    "text": "command injection no same R policy bypass so none of the stuff that I've talked about in previous uh",
    "start": "231159",
    "end": "238439"
  },
  {
    "text": "presentations but just going to be used in functionality which is there by Design so here's a t typical simplified",
    "start": "238439",
    "end": "245879"
  },
  {
    "text": "Network diagram and the products I'm going to be talking about today are the email and web",
    "start": "245879",
    "end": "252360"
  },
  {
    "text": "filtering Solutions which kind of sit in the DMZ here so for the web filtering solution this basically proxies requests",
    "start": "252360",
    "end": "260120"
  },
  {
    "text": "from the internal Network they go out around here and then prox it out to resources",
    "start": "260120",
    "end": "267360"
  },
  {
    "text": "on the internet right but there's no external facing services on this box you",
    "start": "267360",
    "end": "273639"
  },
  {
    "text": "shouldn't be able to tell what solution this is from the outside right you with",
    "start": "273639",
    "end": "280120"
  },
  {
    "text": "me uh email filtering typically you you're going to have to have for Port 25",
    "start": "280199",
    "end": "286880"
  },
  {
    "text": "open so you can receive inbound email um and you shouldn't really have too many other services open to the",
    "start": "286880",
    "end": "293240"
  },
  {
    "text": "outside from this but you may in fact have a manage service in between so messages aren't actually delivered",
    "start": "293240",
    "end": "298680"
  },
  {
    "text": "Direct in which case you wouldn't be able to talk to this box directly anyway so these products typically some of the",
    "start": "298680",
    "end": "306000"
  },
  {
    "text": "vulnerabilities I found in some of these products I wouldn't be able to find in an external infrastructure test because",
    "start": "306000",
    "end": "313600"
  },
  {
    "text": "I can't see what I need to see in order to work out that I've got a vulnerable version so that kind of initiated my",
    "start": "313600",
    "end": "320720"
  },
  {
    "text": "interest in in trying to find these products",
    "start": "320720",
    "end": "326720"
  },
  {
    "text": "[Music] so so the techniques I'm going to talk about today are kind of spe specialist",
    "start": "326720",
    "end": "335400"
  },
  {
    "text": "vulnerability scanners because if you were to scan these IPS",
    "start": "335400",
    "end": "341199"
  },
  {
    "text": "from the outside with nessus or nexos or R map or open vas or whatever you use",
    "start": "341199",
    "end": "347319"
  },
  {
    "text": "you wouldn't be able to enumerate that these are unpatched so I want to be able to find",
    "start": "347319",
    "end": "355000"
  },
  {
    "text": "hidden vulnerable products and when I started investigating these techniques I quickly realized actually you can use",
    "start": "355000",
    "end": "360639"
  },
  {
    "text": "the same techniques for enumerating the policies which are in place on these products so you could use that in",
    "start": "360639",
    "end": "368039"
  },
  {
    "text": "advance of as an attacker in advance of a fishing or client side attack to",
    "start": "368039",
    "end": "373080"
  },
  {
    "text": "greatly improve the effect effectiveness of the attack or is a Defender you could use it for auditing purposes to audit",
    "start": "373080",
    "end": "379520"
  },
  {
    "text": "your policy and I'm talking about the effective policy rather than the one you think you've configured because very",
    "start": "379520",
    "end": "385759"
  },
  {
    "text": "often in these products the uis can be a bit confusing you not quite sure exactly what you have configured until you test",
    "start": "385759",
    "end": "392120"
  },
  {
    "text": "it for real and also I've I've used the tools and techniques to do kind of more of a",
    "start": "392120",
    "end": "397680"
  },
  {
    "text": "capability in the analysis of some of the products what can they do especially in terms of deep content analysis can",
    "start": "397680",
    "end": "404479"
  },
  {
    "text": "products find an executable embedded in a Word document can they find a script in uh in a zip file in a PowerPoint",
    "start": "404479",
    "end": "412479"
  },
  {
    "text": "presentation for example so the tools I'm going to be talking about um and new tools we're",
    "start": "412479",
    "end": "419160"
  },
  {
    "text": "going to be releasing these uh probably release web feet this week and mail feet next week so um going to be doing some",
    "start": "419160",
    "end": "427000"
  },
  {
    "text": "tweets when I do that um I've used them in a detailed analysis in as part of",
    "start": "427000",
    "end": "433720"
  },
  {
    "text": "customer engagements with some of our clients I've been doing some specific product testing in a test environment",
    "start": "433720",
    "end": "439960"
  },
  {
    "text": "and I've also been using some of the techniques to do a kind of survey of a wide variety of domains and some of the",
    "start": "439960",
    "end": "446639"
  },
  {
    "text": "stats I'm going to show you today I've been sending some emails to to the Fortune 500 to kind of understand what",
    "start": "446639",
    "end": "452319"
  },
  {
    "text": "products they use and some of the the policies that they Implement so the first tool we're going to talk about is",
    "start": "452319",
    "end": "457599"
  },
  {
    "text": "web feet so this needs a small amount of user interaction just getting a single",
    "start": "457599",
    "end": "464759"
  },
  {
    "text": "internal employe to click on a link and view a web application and it works by",
    "start": "464759",
    "end": "470159"
  },
  {
    "text": "having some ja JavaScript on the front end in the BR running the browser and some files and uh a little bit of PHP on",
    "start": "470159",
    "end": "477639"
  },
  {
    "text": "the back end but it's a very simple appliation and you can use this for audience or reconnaissance in uh kind of",
    "start": "477639",
    "end": "485759"
  },
  {
    "text": "social engineering Cent side attack situations so let me talk about a very simple uh enumeration technique so you",
    "start": "485759",
    "end": "494440"
  },
  {
    "text": "got web feet sitting on a IP on the internet so attacker web application and",
    "start": "494440",
    "end": "500639"
  },
  {
    "text": "it runs some clientside JavaScript so a very simple thing it can do is basically this is requesting files",
    "start": "500639",
    "end": "510639"
  },
  {
    "text": "yeah so you can basically download a series of",
    "start": "510639",
    "end": "515800"
  },
  {
    "text": "files but it's not downloading it's simulating the downloading because it's making requests from uh XML HTTP",
    "start": "515800",
    "end": "523839"
  },
  {
    "text": "requests so there's no um save as dialogue popping up at in the user's",
    "start": "523839",
    "end": "529800"
  },
  {
    "text": "browser the user might not be aware at all so it's very transparent so the first thing I did with implementing this",
    "start": "529800",
    "end": "536640"
  },
  {
    "text": "is to uh just request a simple file and one of the things that web proxies do is",
    "start": "536640",
    "end": "541839"
  },
  {
    "text": "they modify the htttp headers in the response so file gets requested file is",
    "start": "541839",
    "end": "548880"
  },
  {
    "text": "downloaded headers are modified from the headers which would have been the in the original",
    "start": "548880",
    "end": "554120"
  },
  {
    "text": "response so this would be the headers of the original response from the web server from the attacker web server and",
    "start": "554120",
    "end": "561000"
  },
  {
    "text": "if it's going through a proxy you tend to get additional headers so here you can see a couple of hash uh cach headers",
    "start": "561000",
    "end": "566760"
  },
  {
    "text": "added and you can see a host name so this is an internal host name of the web security proxy and here you've got a",
    "start": "566760",
    "end": "572600"
  },
  {
    "text": "host name and this is the proxy port but you you tend to get a lot more information um so I'll show you some of",
    "start": "572600",
    "end": "579240"
  },
  {
    "text": "that in a minute but basically because this is all within my web application I can pass that information",
    "start": "579240",
    "end": "586959"
  },
  {
    "text": "back and there interesting headers in terms of this type of enumeration especially the Via header but also",
    "start": "586959",
    "end": "592760"
  },
  {
    "text": "caching headers and other some other custom X headers so here's some examples",
    "start": "592760",
    "end": "598440"
  },
  {
    "text": "of those which I've collected in a driveby way uh so I ran a a simple test",
    "start": "598440",
    "end": "603920"
  },
  {
    "text": "uh for a few weeks and I got hundreds of um headers so here you can see you've got at the top we've got some cash",
    "start": "603920",
    "end": "610079"
  },
  {
    "text": "headers here a host name is disclosed some of these I've obfuscated because obviously I'm collecting this in a kind",
    "start": "610079",
    "end": "615560"
  },
  {
    "text": "of uh without permission way so you've got um the proxy port here you've got I",
    "start": "615560",
    "end": "622000"
  },
  {
    "text": "an internal IP address so that would disclose the IP address Rangers in the DMZ here you can see we've got in the",
    "start": "622000",
    "end": "628640"
  },
  {
    "text": "Via headers maffy web gateways given the exact product version that's deployed uh similarly this is a",
    "start": "628640",
    "end": "635279"
  },
  {
    "text": "barracuda so sometimes in the host name you actually tells you what the product is because the administrator has set it up that way and this is a clear",
    "start": "635279",
    "end": "642399"
  },
  {
    "text": "indicator of a a barracuda product version Cisco iron Port you've got a full product version there and then",
    "start": "642399",
    "end": "648040"
  },
  {
    "text": "you've got things like um squid proxies which so a lot of the web security products are built on top of squid proxy",
    "start": "648040",
    "end": "655320"
  },
  {
    "text": "if you know what the vendor is and you know what the version of squid is you can work out the version of the product that's in use",
    "start": "655320",
    "end": "662680"
  },
  {
    "text": "and sometimes you get multiple headers so where you've got proxies chained together perhaps you've got a cach in",
    "start": "662680",
    "end": "668320"
  },
  {
    "text": "proxy and a web security proxy chain together you actually get multiple headers added on so here so you can see",
    "start": "668320",
    "end": "674560"
  },
  {
    "text": "there there's two headers there and sometimes you get custom X headers so this is a web Marshal product so I can",
    "start": "674560",
    "end": "680480"
  },
  {
    "text": "see that so I can see this as an external attacker what um products and versions are in",
    "start": "680480",
    "end": "686040"
  },
  {
    "text": "use so the second thing I implemented was to do um a kind of download of lots of",
    "start": "686040",
    "end": "692320"
  },
  {
    "text": "different files to enumerate the filtering policiy that's in place what I didn't realized when I started",
    "start": "692320",
    "end": "698200"
  },
  {
    "text": "implementing this is that this gives a a much better way of enumerating the",
    "start": "698200",
    "end": "703279"
  },
  {
    "text": "products in use so the way this works is basically the JavaScript on the client",
    "start": "703279",
    "end": "709079"
  },
  {
    "text": "side is requesting a whole series of files so you could have iar iar and zip",
    "start": "709079",
    "end": "714639"
  },
  {
    "text": "executable in the word document you know all the test cases you want to do",
    "start": "714639",
    "end": "721240"
  },
  {
    "text": "um so what happens when a file gets blocked you get a block",
    "start": "721240",
    "end": "728839"
  },
  {
    "text": "page right so either the request is blocked at the request so for example if",
    "start": "728839",
    "end": "736880"
  },
  {
    "text": "a site is in a a category that's being blocked in a category filter it would",
    "start": "736880",
    "end": "742519"
  },
  {
    "text": "block the request but more commonly uh responses are blocked especially where you're",
    "start": "742519",
    "end": "747920"
  },
  {
    "text": "doing deep content analysis of the the file what's actually in the file so for example uh if a request results in a",
    "start": "747920",
    "end": "755920"
  },
  {
    "text": "malicious file download then the response is blocked now when things are filtered",
    "start": "755920",
    "end": "763160"
  },
  {
    "text": "that response is then replaced by a policy block page and the block page serves three purposes it blocks the",
    "start": "763160",
    "end": "769639"
  },
  {
    "text": "threat it informs the user that the page has been blocked and it prevents the browser from timing out so this is a",
    "start": "769639",
    "end": "775760"
  },
  {
    "text": "really important feature uh so normally the uh response is basically some HTML",
    "start": "775760",
    "end": "782959"
  },
  {
    "text": "with a block page sometimes a small number of cases about 10% I think uh",
    "start": "782959",
    "end": "788199"
  },
  {
    "text": "it's actually a redirect to a web page on the web proxy or some other internal",
    "start": "788199",
    "end": "793920"
  },
  {
    "text": "web server that's a much smaller number of cases so here's an example of a web",
    "start": "793920",
    "end": "801000"
  },
  {
    "text": "proxy block page this is from a Cisco arm Port web security Appliance and you see I've OB",
    "start": "801000",
    "end": "807120"
  },
  {
    "text": "fiscated uh some of the information there so you had the original Ur URL",
    "start": "807120",
    "end": "813880"
  },
  {
    "text": "here which has been blocked and you see you've got username and a domain name internal IP address and the URL again",
    "start": "813880",
    "end": "821320"
  },
  {
    "text": "and at the bottom it says you know what the policy was why it's been blocked the reason I've aisc it is because this is",
    "start": "821320",
    "end": "827320"
  },
  {
    "text": "not my proxy this is one I've uh block page I've collected in a drive by way so",
    "start": "827320",
    "end": "832800"
  },
  {
    "text": "who here is responsible for a web security proxy or the policy on so",
    "start": "832800",
    "end": "840000"
  },
  {
    "text": "did you imagine that your block Pages would be externally accessible to",
    "start": "840000",
    "end": "846839"
  },
  {
    "text": "attackers anybody think that was the case there's a fundamental problem with",
    "start": "846839",
    "end": "853600"
  },
  {
    "text": "these block pages so and the problem is that this is my",
    "start": "853600",
    "end": "860199"
  },
  {
    "text": "JavaScript this is my backend web application this is all within the same",
    "start": "860199",
    "end": "866560"
  },
  {
    "text": "domain from and from a web application same origin policy perspective this",
    "start": "866560",
    "end": "872800"
  },
  {
    "text": "block page is a modified response within my web",
    "start": "872800",
    "end": "877959"
  },
  {
    "text": "application so this block page belongs to me so I just capture it in the",
    "start": "877959",
    "end": "883519"
  },
  {
    "text": "JavaScript and pass it back for troubleshooting purposes so I've",
    "start": "883519",
    "end": "888880"
  },
  {
    "text": "collected quite a lot of these so sometimes you get quite a lot of disclosure so this is similar to the web",
    "start": "888880",
    "end": "895000"
  },
  {
    "text": "security proxy so I'm going to show you a whole series of these different block pages I don't expect you to take in what's on",
    "start": "895000",
    "end": "902199"
  },
  {
    "text": "every single one of them but I want to give you an idea that this problem is generic and it affects lots of different",
    "start": "902199",
    "end": "907519"
  },
  {
    "text": "products so here we've got um you know it's telling you the internal IP address",
    "start": "907519",
    "end": "913040"
  },
  {
    "text": "um the username the domain name and you see actually here there's some functionality which again this",
    "start": "913040",
    "end": "918560"
  },
  {
    "text": "functionality is within the uh same domain as the attacking application so I",
    "start": "918560",
    "end": "924199"
  },
  {
    "text": "could actually uh leverage some of this functionality",
    "start": "924199",
    "end": "929839"
  },
  {
    "text": "uh but I'm not talking about exploitation I'm just talking about low severity information disclosure issues today",
    "start": "929839",
    "end": "935519"
  },
  {
    "text": "right so here's another one this is um a blue coat appr proxy AV so here sometimes you get lots of",
    "start": "935519",
    "end": "942959"
  },
  {
    "text": "disclosure about uh the version number so you can see sofos is being used and",
    "start": "942959",
    "end": "948759"
  },
  {
    "text": "you get patent version engine version that kind of stuff this one's from a foret not a lot of disclosure there this",
    "start": "948759",
    "end": "955079"
  },
  {
    "text": "one's from a sonic wall this is um Z G this one's a maafe product this one's",
    "start": "955079",
    "end": "963040"
  },
  {
    "text": "squid clam a so you can see getting loads of these I got wide diversity there've got dozens of these things in a",
    "start": "963040",
    "end": "970160"
  },
  {
    "text": "a short period of a couple of weeks on a a low traffic site this is a trend so this is quite",
    "start": "970160",
    "end": "976680"
  },
  {
    "text": "interesting so this is iar I'm using iar to trigger these block pages and it's it's telling me it's a dangerous disease",
    "start": "976680",
    "end": "983279"
  },
  {
    "text": "Vector which I thought was kind of kind of amusing uh this one so is uh a",
    "start": "983279",
    "end": "989079"
  },
  {
    "text": "checkpoint block page so sometimes it doesn't give you the products quite obviously but if you just Google some of",
    "start": "989079",
    "end": "995839"
  },
  {
    "text": "this standard text here uh you'll quickly find out what um product is in",
    "start": "995839",
    "end": "1001120"
  },
  {
    "text": "use and here if sometimes you have to look in the HTML you see here this is a web sense product uh here are two",
    "start": "1001120",
    "end": "1008839"
  },
  {
    "text": "different blue coat block pages from different versions but you can see that",
    "start": "1008839",
    "end": "1013920"
  },
  {
    "text": "this one is telling you it's a blue coat this one doesn't but if you look at the text it's kind of standard",
    "start": "1013920",
    "end": "1019680"
  },
  {
    "text": "format and you probably can't see this but this one's using a sofos plug-in and this one's using a kasperski plugin so",
    "start": "1019680",
    "end": "1026319"
  },
  {
    "text": "you can enumerate the plugins that are used with these products as well and it's a a Trend Micro one so",
    "start": "1026319",
    "end": "1034558"
  },
  {
    "text": "that's collecting block pages from web security pro proxies as an external attacker it'll tell me what products is",
    "start": "1034559",
    "end": "1041558"
  },
  {
    "text": "is in use but as a side effect of this I started getting these which I couldn't",
    "start": "1041559",
    "end": "1047160"
  },
  {
    "text": "work out what they were to begin with um this is a desktop antivirus",
    "start": "1047160",
    "end": "1055480"
  },
  {
    "text": "plug-in block page yeah and here's another one there a trend product",
    "start": "1055480",
    "end": "1061000"
  },
  {
    "text": "there's a kasperski product got dozens of different versions of uh of these kind of things and here's a sofos one so",
    "start": "1061000",
    "end": "1067400"
  },
  {
    "text": "because the the browser antivirus browser plug-in works in the same way",
    "start": "1067400",
    "end": "1072520"
  },
  {
    "text": "it's replacing the response with a threat with a block page I can collect",
    "start": "1072520",
    "end": "1078320"
  },
  {
    "text": "those and it was took me a while to get my head around this because it it seems",
    "start": "1078320",
    "end": "1084120"
  },
  {
    "text": "odd so let me give you an example of a a web feet",
    "start": "1084440",
    "end": "1090960"
  },
  {
    "text": "report um so as I said the reason that we're",
    "start": "1090960",
    "end": "1096120"
  },
  {
    "text": "enumerating the block page is if we're actually blocking threats um so here's so the way that",
    "start": "1096120",
    "end": "1104960"
  },
  {
    "text": "application works is that it does all these tests and then it uploads a report",
    "start": "1104960",
    "end": "1110240"
  },
  {
    "text": "to the backend web server uh and you see here's one of the example reports that I've pulled back",
    "start": "1110240",
    "end": "1116200"
  },
  {
    "text": "over the last few weeks and I've OB fiscated you know who the organization was and I've taken some of the the",
    "start": "1116200",
    "end": "1122080"
  },
  {
    "text": "detail out there but this is the the part of the application which is doing some of the file download enumeration",
    "start": "1122080",
    "end": "1129200"
  },
  {
    "text": "and you can see here although it's green that's that means I've actually collected a block page so the threat was",
    "start": "1129200",
    "end": "1134280"
  },
  {
    "text": "blocked but I've collected some some information uh so you can see iar in",
    "start": "1134280",
    "end": "1140200"
  },
  {
    "text": "this case is generating a block page a standard Windows XE generating a block page F profanity not blocked so red is",
    "start": "1140200",
    "end": "1147360"
  },
  {
    "text": "bad obviously uh unlocked breakout shell block page so some of these threats are being blocked VB script batch file on",
    "start": "1147360",
    "end": "1154080"
  },
  {
    "text": "its own not being blocked and then a wide variety of files by file extension",
    "start": "1154080",
    "end": "1160360"
  },
  {
    "text": "not being blocked here's an ex XE by file extension not being blocked as so",
    "start": "1160360",
    "end": "1166200"
  },
  {
    "text": "is being blocked and then we've got custom XE being blocked XE rename to",
    "start": "1166200",
    "end": "1172799"
  },
  {
    "text": "text not blocked XE rename to document not blocked and you can see you can have a wide variety of these tests and this",
    "start": "1172799",
    "end": "1179640"
  },
  {
    "text": "Report was generated in about 3 seconds it just downloads it's not even a series",
    "start": "1179640",
    "end": "1185080"
  },
  {
    "text": "it downloads them in parallel because it basically using jQuery to um request all",
    "start": "1185080",
    "end": "1191240"
  },
  {
    "text": "the files at the same time so you got scripts in documents password protected documents etc etc and then towards the",
    "start": "1191240",
    "end": "1200440"
  },
  {
    "text": "bottom URL category enumeration which I'm going to talk about in a minute so this all collected in a drive",
    "start": "1200440",
    "end": "1207159"
  },
  {
    "text": "by",
    "start": "1207159",
    "end": "1209400"
  },
  {
    "text": "way so uh I said I've been recently developing this tool and I've produced",
    "start": "1212919",
    "end": "1219159"
  },
  {
    "text": "some statistics but this is only a statistics on 14 organizations so uh",
    "start": "1219159",
    "end": "1225159"
  },
  {
    "text": "ideally this could do with some further study to uh kind of um do it for more organizations with the email filtering",
    "start": "1225159",
    "end": "1231760"
  },
  {
    "text": "I've done it on um much a larger number of organizations so this is from 14",
    "start": "1231760",
    "end": "1237280"
  },
  {
    "text": "organizations and it's 15 different uh file download",
    "start": "1237280",
    "end": "1242760"
  },
  {
    "text": "types so first a file which is no threat which just a piece of HTML is um downloaded 100% of the time",
    "start": "1242760",
    "end": "1251360"
  },
  {
    "text": "so the the higher the the graph is the higher the bar is the more times it been",
    "start": "1251360",
    "end": "1256760"
  },
  {
    "text": "downloaded here we can see profanity blocked once iar blocked 100% of the time when",
    "start": "1256760",
    "end": "1265200"
  },
  {
    "text": "it's on its own when it's in a zip file it's downloaded once here we've got a Windows breakout",
    "start": "1265200",
    "end": "1270960"
  },
  {
    "text": "so these are two hacking tools a Windows breakout XE and a password dumping tool I think the difference between these is",
    "start": "1270960",
    "end": "1277520"
  },
  {
    "text": "that the the first one is assigned executable I think is why it's been downloaded more uh here we've got uh",
    "start": "1277520",
    "end": "1285320"
  },
  {
    "text": "password protected documents and archives so you got password protect word and password protected Excel uh",
    "start": "1285320",
    "end": "1291320"
  },
  {
    "text": "downloaded 100% of the time um password protected zip file download 80 80% of",
    "start": "1291320",
    "end": "1296799"
  },
  {
    "text": "the time here we've got just raw um VBS and batch files downloaded 70% of the",
    "start": "1296799",
    "end": "1304400"
  },
  {
    "text": "time now if you're using these in a real Attack you would embed these in something else because the browser",
    "start": "1304400",
    "end": "1310559"
  },
  {
    "text": "typically has functionality to do a pop-up warning to users so you'd stick them in a zip file or a document of some",
    "start": "1310559",
    "end": "1317240"
  },
  {
    "text": "kind and then we've got um executables and uh scripts embedded",
    "start": "1317240",
    "end": "1325159"
  },
  {
    "text": "in different versions of word so in Word 2003 and Word 2010 and with those you're",
    "start": "1325159",
    "end": "1330600"
  },
  {
    "text": "getting a download rate of between 80 and",
    "start": "1330600",
    "end": "1334880"
  },
  {
    "text": "90% so there is a difference uh in some of these threats in terms of some of",
    "start": "1335919",
    "end": "1342080"
  },
  {
    "text": "this ability to download these threats is due to a lack of product capability and some is due to company policy so",
    "start": "1342080",
    "end": "1351000"
  },
  {
    "text": "these ones are different these are password protected Excel word and Zips",
    "start": "1351000",
    "end": "1356480"
  },
  {
    "text": "so these are allowed by company policy or the the policies configured because",
    "start": "1356480",
    "end": "1361640"
  },
  {
    "text": "most web security proxies I've looked at have got a capability of blocking these encrypted attachments or encrypted files",
    "start": "1361640",
    "end": "1369559"
  },
  {
    "text": "whereas some of the the other issues finding an executable inside embedded in within a",
    "start": "1369559",
    "end": "1377600"
  },
  {
    "text": "document or an IC is more technically challenging so these these issues are more to do with product capability",
    "start": "1377600",
    "end": "1383559"
  },
  {
    "text": "whereas these are to do with um what the compan is allowing so let's talk about um SSL",
    "start": "1383559",
    "end": "1391480"
  },
  {
    "text": "inspection https inspection so there is the potential to do inspection of SSL",
    "start": "1391480",
    "end": "1398799"
  },
  {
    "text": "https traffic but lots of companies don't do it and mainly not for technical",
    "start": "1398799",
    "end": "1404240"
  },
  {
    "text": "reasons because it's technically possible to do this but they don't do it because of legal issues contractural",
    "start": "1404240",
    "end": "1410000"
  },
  {
    "text": "issues they don't want to be interfering with um employees privacy inspecting",
    "start": "1410000",
    "end": "1416960"
  },
  {
    "text": "their banking traffic for example so very briefly the way the SSL inspection",
    "start": "1416960",
    "end": "1423159"
  },
  {
    "text": "usually works is that you have the proxy has a CA and it's creating certificates",
    "start": "1423159",
    "end": "1430600"
  },
  {
    "text": "uh for the sites which are being visited all of the browsers internally are configured to trust that CA so you can",
    "start": "1430600",
    "end": "1437520"
  },
  {
    "text": "have these two levels of encryption you have the normal encryption to the sites",
    "start": "1437520",
    "end": "1442679"
  },
  {
    "text": "on the internet and then you have this kind of it's a real encryption but it's kind of spoofed internally which means",
    "start": "1442679",
    "end": "1449320"
  },
  {
    "text": "that on this the proxy you've got plain text traffic so you can look for malware",
    "start": "1449320",
    "end": "1454559"
  },
  {
    "text": "and you can look for executable code because it's in plain text on the web security",
    "start": "1454559",
    "end": "1459840"
  },
  {
    "text": "proxy so if you were to check for this with web feet you just run the same set",
    "start": "1459840",
    "end": "1464960"
  },
  {
    "text": "of tests over HTTP and https and you can see whether or not the policy is applied",
    "start": "1464960",
    "end": "1470679"
  },
  {
    "text": "to both so here this is a site where uh SSL inspection is not being done so over",
    "start": "1470679",
    "end": "1476520"
  },
  {
    "text": "HTTP they've got a reasonable policy they're blocking a few things over https they're not blocking anything so it's",
    "start": "1476520",
    "end": "1482840"
  },
  {
    "text": "quite obvious they're not doing uh SSL inspection there's another side effect of um slsl SSL inspection in that",
    "start": "1482840",
    "end": "1492320"
  },
  {
    "text": "sometimes it causes some strange things going on with the certificates because effectively the proxy is replacing the",
    "start": "1492320",
    "end": "1500360"
  },
  {
    "text": "certificates of the original site so if the original site certificate was",
    "start": "1500360",
    "end": "1505559"
  },
  {
    "text": "invalid the proxy if it's not blocking those sites with invalid certificates it's replacing those certificates with a",
    "start": "1505559",
    "end": "1512520"
  },
  {
    "text": "valid certificate so it's making external websites invalid certificates",
    "start": "1512520",
    "end": "1517799"
  },
  {
    "text": "valid so you can do uh some enumeration of that by trying to load images here",
    "start": "1517799",
    "end": "1524320"
  },
  {
    "text": "from a site which has deliberately got an invalid certificate if these images",
    "start": "1524320",
    "end": "1530360"
  },
  {
    "text": "load normally these images should generate an error in the browser if these load mysteriously that means that",
    "start": "1530360",
    "end": "1537039"
  },
  {
    "text": "something has happened with SSL which suggests that the certificate's been",
    "start": "1537039",
    "end": "1542919"
  },
  {
    "text": "replaced similarly uh you can enumerate um the URL category filtering",
    "start": "1542919",
    "end": "1549360"
  },
  {
    "text": "which is in place because you can load these images from lots of different sites so in the proof of concept I've",
    "start": "1549360",
    "end": "1556120"
  },
  {
    "text": "done I'm loading images from lots of different sites in different categories so these will load within the HTML and",
    "start": "1556120",
    "end": "1564559"
  },
  {
    "text": "then you can do on error or onload um JavaScript statements in the HTML to",
    "start": "1564559",
    "end": "1571000"
  },
  {
    "text": "update the Dom and then the whole the end of the enumeration the whole Dom is passed back uh to the attacker web",
    "start": "1571000",
    "end": "1577000"
  },
  {
    "text": "server so here's an example of that so you see we've got uh porn sites drug sites gambling hacking etc",
    "start": "1577000",
    "end": "1584000"
  },
  {
    "text": "etc so typically organizations will want to block some of these right um and the",
    "start": "1584000",
    "end": "1589480"
  },
  {
    "text": "way that I've done this is basically you see these images these are using favicons and the reason I've used those",
    "start": "1589480",
    "end": "1596600"
  },
  {
    "text": "is because they're small images they're in Fairly predictable locations on the web servers and they don't change very",
    "start": "1596600",
    "end": "1603200"
  },
  {
    "text": "often so you know if these load basically it updates um the Dom and then",
    "start": "1603200",
    "end": "1610279"
  },
  {
    "text": "at the end of the numeration the whole Dom is passed",
    "start": "1610279",
    "end": "1614159"
  },
  {
    "text": "back so for web filtering within a few seconds I know what products you're",
    "start": "1615480",
    "end": "1621559"
  },
  {
    "text": "using sometimes with the exact versions I know what policy you've got for a wide variety of file downloads I know whether",
    "start": "1621559",
    "end": "1628960"
  },
  {
    "text": "you're able to detect threats in HTTPS or not usually not and how effective",
    "start": "1628960",
    "end": "1635080"
  },
  {
    "text": "your url filtering is and what categories you're filtering so no exploits required right",
    "start": "1635080",
    "end": "1642600"
  },
  {
    "text": "just a few little tricks",
    "start": "1642600",
    "end": "1646278"
  },
  {
    "text": "so let's talk about email so I talk about email second because it's a little bit more complex because the topologies",
    "start": "1648720",
    "end": "1655039"
  },
  {
    "text": "are more complex the policies are more complex uh and you have M sometimes",
    "start": "1655039",
    "end": "1661440"
  },
  {
    "text": "multiple layers and different outcomes",
    "start": "1661440",
    "end": "1666480"
  },
  {
    "text": "so similar principles but it works in a different way basically you have a tool",
    "start": "1666480",
    "end": "1671640"
  },
  {
    "text": "which is sending a whole bunch of emails whole series series of emails with different attachments added on",
    "start": "1671640",
    "end": "1679279"
  },
  {
    "text": "and a listener which is basically listening for responses and the simplest way to use this tool is it just sends",
    "start": "1679279",
    "end": "1684720"
  },
  {
    "text": "whole series of emails to a non-existent user at the Target domain and by default",
    "start": "1684720",
    "end": "1692200"
  },
  {
    "text": "um Domino and exchange they will reply when a user doesn't exist with the original message and the original",
    "start": "1692200",
    "end": "1698919"
  },
  {
    "text": "attachments right that's that's the easiest way to use it so you basically you know what you sent you know what",
    "start": "1698919",
    "end": "1705080"
  },
  {
    "text": "you're getting back you kind of cross check those and they'll give you uh a differential of what's been",
    "start": "1705080",
    "end": "1710799"
  },
  {
    "text": "filtered out so top policies are more complex",
    "start": "1710799",
    "end": "1716159"
  },
  {
    "text": "with email so you've got various different options you can use a manage service where you're using a third party",
    "start": "1716159",
    "end": "1722600"
  },
  {
    "text": "the MX records for the Target the main point to this manag service here messages are processed to remove",
    "start": "1722600",
    "end": "1729760"
  },
  {
    "text": "you know bulk spam um bulk fishing known malware that kind of stuff and then",
    "start": "1729760",
    "end": "1735200"
  },
  {
    "text": "forwarded on the rest to the inter mous server the other option is to have",
    "start": "1735200",
    "end": "1741120"
  },
  {
    "text": "on-site Appliance sometimes this is built into the firewall or sometimes a software solution but usually these days",
    "start": "1741120",
    "end": "1747039"
  },
  {
    "text": "on-site appliances doing the same thing um normally the appliances have more",
    "start": "1747039",
    "end": "1754880"
  },
  {
    "text": "capability especially in terms of doing deep content security so often companies",
    "start": "1754880",
    "end": "1760320"
  },
  {
    "text": "have two layers so they'll use the manag service to filter out the bulk of spam",
    "start": "1760320",
    "end": "1765559"
  },
  {
    "text": "and malware and then they'll do more complex policies on the email appliance which is",
    "start": "1765559",
    "end": "1770799"
  },
  {
    "text": "kind of sitting behind that and normally the path is it goes through both on the way in but bypasses the manage service",
    "start": "1770799",
    "end": "1778480"
  },
  {
    "text": "on the way out that's typically what I tend to see so I did some statistics on the Fortune 500 in terms of the manage",
    "start": "1778480",
    "end": "1785279"
  },
  {
    "text": "services they're using this is really easy to do uh in a you know a scripted",
    "start": "1785279",
    "end": "1791039"
  },
  {
    "text": "way so you can just do this with DNS well fact is more accurate um so the",
    "start": "1791039",
    "end": "1797519"
  },
  {
    "text": "simplest way to do it is to do DNS Lookouts for the MX records of all the target domains you're interested in and",
    "start": "1797519",
    "end": "1804159"
  },
  {
    "text": "within the domain portion of the host name's returned it'll tell you if it's uh iron port or semantic message Labs or",
    "start": "1804159",
    "end": "1810919"
  },
  {
    "text": "whatever it's more accurate to look up the IPS of those MX records and then do a who is on those IPS uh because that's",
    "start": "1810919",
    "end": "1818480"
  },
  {
    "text": "slightly more accurate but you see you know I've done some real word stats of the Fortune 500 and you can see 45% not",
    "start": "1818480",
    "end": "1826279"
  },
  {
    "text": "using a managed service and then you can who the key players are in the market you've got semantic message labs and",
    "start": "1826279",
    "end": "1832399"
  },
  {
    "text": "Microsoft Outlook 133% um you've got Google postini and you've got Cisco iron port",
    "start": "1832399",
    "end": "1840080"
  },
  {
    "text": "and proof point so that's unintrusive because you",
    "start": "1840080",
    "end": "1846080"
  },
  {
    "text": "do doing DNS lookups to find uh appliances T typically you need to be",
    "start": "1846080",
    "end": "1851200"
  },
  {
    "text": "more intrusive so here I'm going to I don't expect you to take everything in on this page but we're just going to",
    "start": "1851200",
    "end": "1857240"
  },
  {
    "text": "look at briefly at some SMTP message headers I said the simplest way to enumerate these is to send an email to a",
    "start": "1857240",
    "end": "1863600"
  },
  {
    "text": "non-existent user you get a message back and typically it's got two sets of message headers on it's got the message",
    "start": "1863600",
    "end": "1870519"
  },
  {
    "text": "headers in the attached message from the original message that you sent in on the inbound path and on the message you get",
    "start": "1870519",
    "end": "1878200"
  },
  {
    "text": "back you've got the headers as the message came back out of the organization to me right so the message",
    "start": "1878200",
    "end": "1885360"
  },
  {
    "text": "head is coming to me at the top and the me the original message has little bottom so if I just read this very",
    "start": "1885360",
    "end": "1891919"
  },
  {
    "text": "briefly now you can see there's lots of low severity information disclosure in these headers I've OB fiscated some of",
    "start": "1891919",
    "end": "1898639"
  },
  {
    "text": "it because it's to do with the particular company this was from but I've not off fiscated some of the",
    "start": "1898639",
    "end": "1904519"
  },
  {
    "text": "product uh and policy disclosure so here so we're going to retrace the steps of this message it was processed by the",
    "start": "1904519",
    "end": "1912039"
  },
  {
    "text": "proof Point manag service at the bottom here and you've got all the spam scores and other uh scores of how message was",
    "start": "1912039",
    "end": "1918720"
  },
  {
    "text": "processed yeah kind of be interesting if you were a spammer to know what spam scores you were getting um and so it's",
    "start": "1918720",
    "end": "1926159"
  },
  {
    "text": "processed by the the proof Point manag service and then here I can see it was next processed by an ironport appliance",
    "start": "1926159",
    "end": "1934279"
  },
  {
    "text": "I can see the version of uh AV that's running is sofos and some other information about how the message was",
    "start": "1934279",
    "end": "1939799"
  },
  {
    "text": "processed and then on the way out back to the top of the message I can see that",
    "start": "1939799",
    "end": "1944960"
  },
  {
    "text": "it couldn't be delivered to the internal male server because the user didn't exist but it was then reprocessed by the",
    "start": "1944960",
    "end": "1950679"
  },
  {
    "text": "iron Port Appliance on the way out so even though the message didn't go to the internal M server it still gets",
    "start": "1950679",
    "end": "1956840"
  },
  {
    "text": "processed by both of the levels of the solution so I can enumerate the policy on those two",
    "start": "1956840",
    "end": "1964440"
  },
  {
    "text": "solutions so there's some example of the kind of disclosures you get so sometimes you get like message processing",
    "start": "1965720",
    "end": "1971880"
  },
  {
    "text": "disclosure sometimes you get exact product versions that are in use you get internal IP addresses internal host",
    "start": "1971880",
    "end": "1977600"
  },
  {
    "text": "names etc etc so lots of little bits of low severity uh information",
    "start": "1977600",
    "end": "1983279"
  },
  {
    "text": "disclosure so when looking at the Fortune 500 so as I said I sent some test messages to the Fortune",
    "start": "1983279",
    "end": "1988840"
  },
  {
    "text": "500 this is a a pie chart say the acceptance to nonexisting uh",
    "start": "1988840",
    "end": "1996840"
  },
  {
    "text": "recipients and 58% forun 500 don't accept messages to non-existent",
    "start": "1996840",
    "end": "2002200"
  },
  {
    "text": "recipients which is good 31% accept and respond to non-existent",
    "start": "2002200",
    "end": "2009080"
  },
  {
    "text": "recipients and most of these uh they're responding with the original message so",
    "start": "2009080",
    "end": "2014120"
  },
  {
    "text": "whatever attachment I sent I get it back so I can check something what I sent I can check some extract the attachment",
    "start": "2014120",
    "end": "2021120"
  },
  {
    "text": "what comes back and make sure it's the same file in which case if that's gone to the internal M server I know if I'd",
    "start": "2021120",
    "end": "2027720"
  },
  {
    "text": "been targeting a real user that would have got to them right this slice here accept but didn't",
    "start": "2027720",
    "end": "2034600"
  },
  {
    "text": "respond uh probably because of uh additional spam filtering but even with this 58% I can",
    "start": "2034600",
    "end": "2043120"
  },
  {
    "text": "so they're not accepting messages to non-existent users but I can still enumerate policy with these",
    "start": "2043120",
    "end": "2048358"
  },
  {
    "text": "organizations because I can send to uh accounts which have an",
    "start": "2048359",
    "end": "2054520"
  },
  {
    "text": "autoresponder that do exist such as people with out of office switched on or some other kind of",
    "start": "2054520",
    "end": "2061760"
  },
  {
    "text": "autoresponder so the things I can do to find the product versions I can look at",
    "start": "2061879",
    "end": "2067118"
  },
  {
    "text": "X headers received headers sometimes the format of the message body stuff like that so this is the Gartner magic",
    "start": "2067119",
    "end": "2074158"
  },
  {
    "text": "quadrant of what are the most well it's analysis of um secure",
    "start": "2074159",
    "end": "2080280"
  },
  {
    "text": "email gateways so I want to look at this because I wanted to uh confirm that my",
    "start": "2080280",
    "end": "2086000"
  },
  {
    "text": "results kind of mapped onto this and at first glance it might look a bit wooly",
    "start": "2086000",
    "end": "2091320"
  },
  {
    "text": "because you got ability to execute up that side and you got complet this of vision across that side so this is for",
    "start": "2091320",
    "end": "2096760"
  },
  {
    "text": "it decision making in terms of choosing what products they want to but it's actually quite a lot goes into these",
    "start": "2096760",
    "end": "2103480"
  },
  {
    "text": "statistics and the analysis that they publish and when I check this against",
    "start": "2103480",
    "end": "2108520"
  },
  {
    "text": "the real world it actually it does map on so basically top right hand quar",
    "start": "2108520",
    "end": "2114079"
  },
  {
    "text": "you've got the leaders so you've got Cisco proofo sanch Microsoft and maffy so I disregarded sanch because I",
    "start": "2114079",
    "end": "2121839"
  },
  {
    "text": "was looking predominantly at appliances because that's my particular interest but here are my results from the 150 two",
    "start": "2121839",
    "end": "2128240"
  },
  {
    "text": "domains of the Fortune 500 which were responding to non-existent recipients and you see I've got Cisco ironport",
    "start": "2128240",
    "end": "2135839"
  },
  {
    "text": "proof point sanch macafe so it does map on and then you've got a wide variety of",
    "start": "2135839",
    "end": "2141599"
  },
  {
    "text": "other vendors there's a lot of vendors in the market of doing email",
    "start": "2141599",
    "end": "2146720"
  },
  {
    "text": "filtering so I can combine the manage services with the products that I found",
    "start": "2146720",
    "end": "2151960"
  },
  {
    "text": "and see how many are using um one solution or another or both so you've",
    "start": "2151960",
    "end": "2158000"
  },
  {
    "text": "got 47% are using just a managed service 33% are using just Appliance or software",
    "start": "2158000",
    "end": "2164119"
  },
  {
    "text": "product and 20% Which we're using both I suspect this is slightly bigger and would eat into this",
    "start": "2164119",
    "end": "2170280"
  },
  {
    "text": "47% because there may be some appliances that I've missed and next thing I did was some",
    "start": "2170280",
    "end": "2177200"
  },
  {
    "text": "enumeration of policy I didn't want to send too many messages but I sent uh so I'm sending messages sending messages to",
    "start": "2177200",
    "end": "2183480"
  },
  {
    "text": "non-existent recipients and sending um",
    "start": "2183480",
    "end": "2188640"
  },
  {
    "text": "sent four tests a simple test text message with no threat an executable embedded in a Word document passer",
    "start": "2188640",
    "end": "2195480"
  },
  {
    "text": "protected Excel spreadsheet and a VBS script embedded in an older style Word document and the XE and the script",
    "start": "2195480",
    "end": "2202839"
  },
  {
    "text": "basically just did a hello world popup it's just a proof of concept that executable code is getting",
    "start": "2202839",
    "end": "2208280"
  },
  {
    "text": "in and the two main uh outcomes are this",
    "start": "2208280",
    "end": "2214079"
  },
  {
    "text": "either the message goes all the way through gets an internal m server user doesn't exist I get a bounce",
    "start": "2214079",
    "end": "2222200"
  },
  {
    "text": "or message gets filtered I get no response so between those that was the",
    "start": "2222200",
    "end": "2227560"
  },
  {
    "text": "majority of cases I can tell is my message getting filtered or not but then there were a wide variety of other types",
    "start": "2227560",
    "end": "2234280"
  },
  {
    "text": "of responses which meant I had to do some additional uh checking of the the responses because I was getting",
    "start": "2234280",
    "end": "2240680"
  },
  {
    "text": "responses which were telling me the message was blocked or which were telling me other things so sometimes you",
    "start": "2240680",
    "end": "2246240"
  },
  {
    "text": "get responses to the sender telling the message has been quarantined or",
    "start": "2246240",
    "end": "2251720"
  },
  {
    "text": "blocked so for example in this case message goes in gets blocked out a layer",
    "start": "2251720",
    "end": "2258200"
  },
  {
    "text": "and I get a response here a response intended for the sender to tell them",
    "start": "2258200",
    "end": "2263359"
  },
  {
    "text": "that their message has been blocked like this for example so there's some disclosure here",
    "start": "2263359",
    "end": "2269960"
  },
  {
    "text": "what is this saying this is saying basically uh your messages have been",
    "start": "2269960",
    "end": "2275520"
  },
  {
    "text": "blocked because it was considered a if you put it in a passor protector zip file it gets delivered hooray",
    "start": "2275520",
    "end": "2283480"
  },
  {
    "text": "woohoo now I don't need to see this message to work this out because I can work this out",
    "start": "2283480",
    "end": "2290240"
  },
  {
    "text": "right another case which is kind of interesting Edge case is where you get a message coming",
    "start": "2290240",
    "end": "2296400"
  },
  {
    "text": "in it gets modified my threat being",
    "start": "2296400",
    "end": "2301920"
  },
  {
    "text": "removed but because I'm sending to a non-existent recipient um that modify message gets",
    "start": "2301920",
    "end": "2308599"
  },
  {
    "text": "bounced by the internal mail server and then I get a bounce coming back like this so this message H",
    "start": "2308599",
    "end": "2317240"
  },
  {
    "text": "originally had an executable in a Word document and when it comes back it's got a different attachment this in this case",
    "start": "2317240",
    "end": "2323160"
  },
  {
    "text": "a piece of HTML which is replace the original attachment so this means the policy was effective but because this",
    "start": "2323160",
    "end": "2330319"
  },
  {
    "text": "was sent to a non-existent user it's coming back to me so I'm seeing this which was intended for the user and in",
    "start": "2330319",
    "end": "2336880"
  },
  {
    "text": "this so that was mcafe in this case uh semantic doing the same sort of thing but replacing it with a text",
    "start": "2336880",
    "end": "2343960"
  },
  {
    "text": "file so although most of the responses are either I'm getting my message back",
    "start": "2343960",
    "end": "2350160"
  },
  {
    "text": "or it's filtered so I get no response you get these edge cases that you need to differentiate uh so sometimes you",
    "start": "2350160",
    "end": "2356079"
  },
  {
    "text": "have to look at uh check some of the original attachment see if you get that back you need to look at the number of",
    "start": "2356079",
    "end": "2361160"
  },
  {
    "text": "message headers the structure of the message Etc so doing the analysis on the uh",
    "start": "2361160",
    "end": "2367440"
  },
  {
    "text": "message I sent to 152 domains of the Fortune 500 these are the results for those four different test cases message",
    "start": "2367440",
    "end": "2374520"
  },
  {
    "text": "with no threat is not delivered 100% of the time and if you look",
    "start": "2374520",
    "end": "2379800"
  },
  {
    "text": "at this one password uh password protected Excel spreadsheet notice is slightly higher and to begin with I",
    "start": "2379800",
    "end": "2387119"
  },
  {
    "text": "couldn't work out what this was and the answer is that some of these messages",
    "start": "2387119",
    "end": "2392280"
  },
  {
    "text": "although they were accepted they were blocked as spam and having a Word document on an on a message slightly low",
    "start": "2392280",
    "end": "2399119"
  },
  {
    "text": "as the spam score right so by having a password protected Excel spreadsheet on there",
    "start": "2399119",
    "end": "2404400"
  },
  {
    "text": "you're increasing your delivery rate but obviously there could be macros in this there could be executables",
    "start": "2404400",
    "end": "2410839"
  },
  {
    "text": "embedded in it so there's potentially threats there uh so for the executable in the",
    "start": "2410839",
    "end": "2416040"
  },
  {
    "text": "word document I was getting a 60% delivery rate and VBS in older Star",
    "start": "2416040",
    "end": "2422040"
  },
  {
    "text": "World document getting slightly higher uh delivery rate 75% so these are",
    "start": "2422040",
    "end": "2427560"
  },
  {
    "text": "slightly lower delivery rates than for web because typically uh email filtering",
    "start": "2427560",
    "end": "2433240"
  },
  {
    "text": "um is a bit better than than web filter intends to be well that's what I'm seeing anyway um so there we go so I'll show",
    "start": "2433240",
    "end": "2440720"
  },
  {
    "text": "you an example report um from male feet so whole series so",
    "start": "2440720",
    "end": "2448280"
  },
  {
    "text": "basically here's a series of different tasks that we're doing uh",
    "start": "2448280",
    "end": "2453440"
  },
  {
    "text": "executable filtered so when I get no reply that is implying it's been filtered so you can see this is actually",
    "start": "2453440",
    "end": "2460720"
  },
  {
    "text": "uh male Marshall this particular one executable embedded in so exe renamed is",
    "start": "2460720",
    "end": "2467160"
  },
  {
    "text": "blocked uh encrypted object not blocked ex executable and scripts embedded in",
    "start": "2467160",
    "end": "2472440"
  },
  {
    "text": "various different word documents were blocked that's good so it's doing deep content analysis but you hear you see",
    "start": "2472440",
    "end": "2478119"
  },
  {
    "text": "because of company policy they're needing to allow password protected documents and archives because finance",
    "start": "2478119",
    "end": "2484760"
  },
  {
    "text": "and sales part of their business process they need to be able to send and receive encrypted ex Excel spreadsheets Etc so",
    "start": "2484760",
    "end": "2492119"
  },
  {
    "text": "this is a common problem it's a systemic problem and as you say I'm definitely",
    "start": "2492119",
    "end": "2498000"
  },
  {
    "text": "getting my attachment back because I check on my attachment so I can see I'm",
    "start": "2498000",
    "end": "2504400"
  },
  {
    "text": "getting the same thing back so here's an example of a document that I've used as part of a clientside",
    "start": "2504400",
    "end": "2511599"
  },
  {
    "text": "attack uh for a financial institution I'd previously done a fishing attack and and collected I",
    "start": "2511599",
    "end": "2518040"
  },
  {
    "text": "basically set up a fake uh portal got them to try and log in collected their",
    "start": "2518040",
    "end": "2523480"
  },
  {
    "text": "passwords but then I started getting responses treating me the external attacker as the support person I can't",
    "start": "2523480",
    "end": "2529319"
  },
  {
    "text": "log in I'm getting this error message and I'm supplying them with the answer I'm solving their",
    "start": "2529319",
    "end": "2535280"
  },
  {
    "text": "problem so this is basically um an executable embedded in a Word",
    "start": "2535280",
    "end": "2541520"
  },
  {
    "text": "document which hides the executable from the email filtering solution but this",
    "start": "2541520",
    "end": "2546760"
  },
  {
    "text": "was um uh mesit reverse U metor uh over",
    "start": "2546760",
    "end": "2552960"
  },
  {
    "text": "https and I'd encoded it with the veil of asion framework so that it was hi hiding that from malware detection and",
    "start": "2552960",
    "end": "2560720"
  },
  {
    "text": "putting in the word document hides it from the fact that there's executable code there so basically got shell with",
    "start": "2560720",
    "end": "2567640"
  },
  {
    "text": "that on an internal system which they were concerned about as you can",
    "start": "2567640",
    "end": "2574800"
  },
  {
    "text": "imagine so for filtering I know what products you're using I know what your policy is for a",
    "start": "2575400",
    "end": "2582960"
  },
  {
    "text": "wide variety of file attachments the enumeration takes a bit longer because one of the problems you",
    "start": "2582960",
    "end": "2588680"
  },
  {
    "text": "get with email is that you've got to overcome the anti-spam Technologies are there so you need to overcome uh tarping",
    "start": "2588680",
    "end": "2596760"
  },
  {
    "text": "and gry listing so you need to send your messages slower and you need to start with a IP address which has got a at",
    "start": "2596760",
    "end": "2603640"
  },
  {
    "text": "least a neutral uh reputation so typically it takes between five minutes and an hour to do this series of",
    "start": "2603640",
    "end": "2610480"
  },
  {
    "text": "tests but if you're send it to non-existent recipients it's pretty transparent um and because organizations",
    "start": "2610480",
    "end": "2618160"
  },
  {
    "text": "get a large volumes of spam all the time administrators aren't going to really notice this kind of",
    "start": "2618160",
    "end": "2624559"
  },
  {
    "text": "enumeration so which attacks work https for the win yeah because most",
    "start": "2624559",
    "end": "2631359"
  },
  {
    "text": "organizations are not filtering https traffic hidden payloads which are",
    "start": "2631359",
    "end": "2637520"
  },
  {
    "text": "exercising uh deep content analysis so things like executables and scripts embedded in office documents and",
    "start": "2637520",
    "end": "2646240"
  },
  {
    "text": "archives uh Powershell in HTA files or embedded in um office documents with",
    "start": "2646240",
    "end": "2652400"
  },
  {
    "text": "macros multiple layers of embedded so you take a executable put it in a zip file put it in a Word document lots of",
    "start": "2652400",
    "end": "2659680"
  },
  {
    "text": "products uh can't unpack to that level uh so for example this is a PowerPoint",
    "start": "2659680",
    "end": "2666440"
  },
  {
    "text": "presentation and this is an executable embedded in it",
    "start": "2666440",
    "end": "2673558"
  },
  {
    "text": "right so there's thousands of potential payloads it's worth trying lots of different test cases to see what gets",
    "start": "2676000",
    "end": "2682640"
  },
  {
    "text": "through and what doesn't so in summary attackers can",
    "start": "2682640",
    "end": "2688319"
  },
  {
    "text": "external attackers can enumerate your policy um policies are generally",
    "start": "2688319",
    "end": "2693760"
  },
  {
    "text": "weak no OD day occurred I hav't do any exploits just a few tricks and you know",
    "start": "2693760",
    "end": "2700480"
  },
  {
    "text": "techniques to trick users into uh executing arbitrary code encryption is the attacker's friend",
    "start": "2700480",
    "end": "2708720"
  },
  {
    "text": "you know so encrypted attachments companies need to be able to send and receive these because it's part of their",
    "start": "2708720",
    "end": "2714680"
  },
  {
    "text": "business processes to do so and you got a problem with you know embedded threats being detected so lots",
    "start": "2714680",
    "end": "2721960"
  },
  {
    "text": "of these Solutions are not effectively doing deep content analysis and finding eded threats embedded within office",
    "start": "2721960",
    "end": "2729000"
  },
  {
    "text": "documents and archives so in terms of resources uh there's quite a lot of resources that",
    "start": "2729000",
    "end": "2735359"
  },
  {
    "text": "accompany this talk I've actually written two white papers so there's one currently on the black hat website which",
    "start": "2735359",
    "end": "2742280"
  },
  {
    "text": "I think is the email one I wrote um about six weeks ago I've recently written another white paper on web so",
    "start": "2742280",
    "end": "2749760"
  },
  {
    "text": "some of these things I've talked about I've kind of skimmed very briefly but there two white papers about 30 pages",
    "start": "2749760",
    "end": "2756160"
  },
  {
    "text": "each so it's quite lot of additional content in those web feet I'm going to",
    "start": "2756160",
    "end": "2761359"
  },
  {
    "text": "be uh releasing the source code for that tool this week and we're going to set up a demo site so that you can go and try",
    "start": "2761359",
    "end": "2768079"
  },
  {
    "text": "it for yourselves and mail feet probably going to release that uh next week or",
    "start": "2768079",
    "end": "2773559"
  },
  {
    "text": "maybe a little longer to to finish that off and that's it has anybody got any",
    "start": "2773559",
    "end": "2783000"
  },
  {
    "text": "questions go ahead",
    "start": "2785559",
    "end": "2788920"
  },
  {
    "text": "yeah so of the um the Fortune 500 when I did those tests uh so I started off with 153",
    "start": "2793280",
    "end": "2802079"
  },
  {
    "text": "domains which responded with uh a message coming back to me and after um",
    "start": "2802079",
    "end": "2809359"
  },
  {
    "text": "after two emails one of them stopped responding the other thing I found with",
    "start": "2809359",
    "end": "2814839"
  },
  {
    "text": "web is that if you keep us using the same payloads over and over again um so",
    "start": "2814839",
    "end": "2821559"
  },
  {
    "text": "I was testing a a maafe product after a couple of weeks it started blocking some of the",
    "start": "2821559",
    "end": "2826839"
  },
  {
    "text": "payloads so if you are doing this from audit purposes you need to kind of",
    "start": "2826839",
    "end": "2832559"
  },
  {
    "text": "refresh your payload so I started working on a tool to automatically embed executables and scripts in various",
    "start": "2832559",
    "end": "2838839"
  },
  {
    "text": "different documents to regenerate the payload set so you're taking a fresh look at it each time but it's yeah it's",
    "start": "2838839",
    "end": "2846480"
  },
  {
    "text": "not great deal that are reactively blocking any other",
    "start": "2846480",
    "end": "2853680"
  },
  {
    "text": "questions so if you were running a proxy",
    "start": "2854680",
    "end": "2859440"
  },
  {
    "text": "yous it's a problem isn't it because so I was I was talking to um one of the",
    "start": "2859960",
    "end": "2866480"
  },
  {
    "text": "vendors or a couple of vendors yesterday there is a solution to this if",
    "start": "2866480",
    "end": "2871520"
  },
  {
    "text": "you don't want to inspect um um banking traffic or other other",
    "start": "2871520",
    "end": "2876920"
  },
  {
    "text": "types of categories for example so when I was talking to I think it Websense so I asked him specifically this question",
    "start": "2876920",
    "end": "2883319"
  },
  {
    "text": "you know what do what do you do if you want to do traffic inspection but you don't want to do it for sensitive sites",
    "start": "2883319",
    "end": "2890440"
  },
  {
    "text": "and the way that they can do it is basically they have URL categories for filtering but you can also apply those",
    "start": "2890440",
    "end": "2897119"
  },
  {
    "text": "categories to inspection so you can say for these sites banking government uh",
    "start": "2897119",
    "end": "2903720"
  },
  {
    "text": "other finance apps confidential apps uh don't do SSL inspection and for the",
    "start": "2903720",
    "end": "2909599"
  },
  {
    "text": "rest of sites do SSL inspection so there there are solutions to this if you",
    "start": "2909599",
    "end": "2915520"
  },
  {
    "text": "investigate you know how it can be done any other",
    "start": "2915520",
    "end": "2921160"
  },
  {
    "text": "questions okay thank you very much",
    "start": "2924400",
    "end": "2929240"
  }
]