[
  {
    "start": "0",
    "end": "19000"
  },
  {
    "text": "all right Aloha and welcome to my talk",
    "start": "0",
    "end": "2040"
  },
  {
    "text": "on making and breaking mac firewalls my",
    "start": "2040",
    "end": "5549"
  },
  {
    "text": "name is Patrick I work at digital",
    "start": "5549",
    "end": "7770"
  },
  {
    "text": "security where we are creating",
    "start": "7770",
    "end": "9330"
  },
  {
    "text": "cybersecurity tools for the Mac",
    "start": "9330",
    "end": "11639"
  },
  {
    "text": "Enterprise I'm also the creator of the",
    "start": "11639",
    "end": "14070"
  },
  {
    "text": "Mac security website objective to see so",
    "start": "14070",
    "end": "18150"
  },
  {
    "text": "today we're gonna talk about creating or",
    "start": "18150",
    "end": "20460"
  },
  {
    "start": "19000",
    "end": "19000"
  },
  {
    "text": "making a firewall for Mac OS we're then",
    "start": "20460",
    "end": "23279"
  },
  {
    "text": "gonna shift gears we're gonna put on our",
    "start": "23279",
    "end": "24900"
  },
  {
    "text": "hack your hats and talk about then",
    "start": "24900",
    "end": "27210"
  },
  {
    "text": "breaking or bypassing such products so",
    "start": "27210",
    "end": "32430"
  },
  {
    "text": "about a year ago I decided hey I want to",
    "start": "32430",
    "end": "33870"
  },
  {
    "text": "write a firewall for Mac OS so this",
    "start": "33870",
    "end": "36960"
  },
  {
    "text": "section of the talk will describe that",
    "start": "36960",
    "end": "39270"
  },
  {
    "text": "process in creating a free Mac firewall",
    "start": "39270",
    "end": "42540"
  },
  {
    "text": "product called Lulu",
    "start": "42540",
    "end": "45469"
  },
  {
    "text": "so there's many reasons you might want",
    "start": "45469",
    "end": "48210"
  },
  {
    "start": "46000",
    "end": "46000"
  },
  {
    "text": "to create or install a firewall some of",
    "start": "48210",
    "end": "50640"
  },
  {
    "text": "the obvious ones are obviously to help",
    "start": "50640",
    "end": "52890"
  },
  {
    "text": "protect your privacy firewalls are also",
    "start": "52890",
    "end": "55680"
  },
  {
    "text": "good at sorting cyberattacks many",
    "start": "55680",
    "end": "58109"
  },
  {
    "text": "firewalls are able to generically detect",
    "start": "58109",
    "end": "60960"
  },
  {
    "text": "malware that perhaps has gotten onto",
    "start": "60960",
    "end": "63270"
  },
  {
    "text": "your system and now is trying to beacon",
    "start": "63270",
    "end": "65489"
  },
  {
    "text": "out perhaps to talk to a command and",
    "start": "65489",
    "end": "67110"
  },
  {
    "text": "control server so what our firewall will",
    "start": "67110",
    "end": "69540"
  },
  {
    "text": "do is monitor all network traffic and",
    "start": "69540",
    "end": "71460"
  },
  {
    "text": "allow trusted traffic while detecting",
    "start": "71460",
    "end": "74310"
  },
  {
    "text": "and blocking malicious or unauthorized",
    "start": "74310",
    "end": "76380"
  },
  {
    "text": "traffic now since we need to monitor all",
    "start": "76380",
    "end": "80790"
  },
  {
    "text": "network connections we are going to have",
    "start": "80790",
    "end": "82380"
  },
  {
    "text": "to write a kernel extension luckily in",
    "start": "82380",
    "end": "85080"
  },
  {
    "text": "Mac OS Apple provides something called",
    "start": "85080",
    "end": "87720"
  },
  {
    "text": "Network kernel extensions or NK ease and",
    "start": "87720",
    "end": "90960"
  },
  {
    "text": "they provide a way to modify or extend",
    "start": "90960",
    "end": "93930"
  },
  {
    "text": "the network infrastructure one type of",
    "start": "93930",
    "end": "97079"
  },
  {
    "text": "nke is called a socket filter filter",
    "start": "97079",
    "end": "100290"
  },
  {
    "text": "which as its name obviously implies can",
    "start": "100290",
    "end": "103500"
  },
  {
    "text": "filter network traffic at the socket",
    "start": "103500",
    "end": "105570"
  },
  {
    "text": "level which for creating a firewall",
    "start": "105570",
    "end": "107310"
  },
  {
    "text": "sounds perfect",
    "start": "107310",
    "end": "110090"
  },
  {
    "start": "110000",
    "end": "110000"
  },
  {
    "text": "so in order to filter network traffic",
    "start": "110090",
    "end": "113100"
  },
  {
    "text": "and connections we first have to",
    "start": "113100",
    "end": "115710"
  },
  {
    "text": "register a socket filter so you",
    "start": "115710",
    "end": "118500"
  },
  {
    "text": "accomplish this by first filling out a",
    "start": "118500",
    "end": "120810"
  },
  {
    "text": "socket filter structure and this",
    "start": "120810",
    "end": "123570"
  },
  {
    "text": "structure has various callbacks which",
    "start": "123570",
    "end": "126210"
  },
  {
    "text": "once registered will be invoked by the",
    "start": "126210",
    "end": "128190"
  },
  {
    "text": "operating system anytime a socket action",
    "start": "128190",
    "end": "131190"
  },
  {
    "text": "occurs this thing gives our fire",
    "start": "131190",
    "end": "133590"
  },
  {
    "text": "the ability to monitor examine and",
    "start": "133590",
    "end": "136410"
  },
  {
    "text": "filter these socket actions now once",
    "start": "136410",
    "end": "140760"
  },
  {
    "text": "this socket filter structure has been",
    "start": "140760",
    "end": "143090"
  },
  {
    "text": "populated you invoke the socket filter",
    "start": "143090",
    "end": "146519"
  },
  {
    "text": "register function and this will as its",
    "start": "146519",
    "end": "149160"
  },
  {
    "text": "name implies register or install the",
    "start": "149160",
    "end": "151440"
  },
  {
    "text": "socket filter now besides that populated",
    "start": "151440",
    "end": "154860"
  },
  {
    "text": "structure structure we just discussed",
    "start": "154860",
    "end": "156540"
  },
  {
    "text": "this filter also takes the socket domain",
    "start": "156540",
    "end": "159569"
  },
  {
    "text": "type and the protocol so this means if",
    "start": "159569",
    "end": "162629"
  },
  {
    "text": "you want to filter multiple socket types",
    "start": "162629",
    "end": "165720"
  },
  {
    "text": "for example ipv4 ipv6 etc etc you have",
    "start": "165720",
    "end": "169140"
  },
  {
    "text": "to invoke this function multiple times",
    "start": "169140",
    "end": "172819"
  },
  {
    "text": "all right so now let's talk about these",
    "start": "172819",
    "end": "174930"
  },
  {
    "start": "173000",
    "end": "173000"
  },
  {
    "text": "callbacks which as I mentioned once your",
    "start": "174930",
    "end": "177299"
  },
  {
    "text": "socket filter is installed the operating",
    "start": "177299",
    "end": "179910"
  },
  {
    "text": "system will automatically invoked when",
    "start": "179910",
    "end": "181739"
  },
  {
    "text": "socket actions occur allowing your",
    "start": "181739",
    "end": "183750"
  },
  {
    "text": "firewall to examine and either allow or",
    "start": "183750",
    "end": "185849"
  },
  {
    "text": "block these events so first up we have",
    "start": "185849",
    "end": "188519"
  },
  {
    "text": "the attach callback as the slide",
    "start": "188519",
    "end": "190560"
  },
  {
    "text": "mentioned this is called anytime a",
    "start": "190560",
    "end": "192360"
  },
  {
    "text": "socket is created and it's called with",
    "start": "192360",
    "end": "194730"
  },
  {
    "text": "the actual socket and also a cookie",
    "start": "194730",
    "end": "197489"
  },
  {
    "text": "parameter which can hold any socket",
    "start": "197489",
    "end": "199950"
  },
  {
    "text": "specific data so here we allocate a",
    "start": "199950",
    "end": "203040"
  },
  {
    "text": "chunk of memory and then we store an",
    "start": "203040",
    "end": "205410"
  },
  {
    "text": "action based on the pit of the process",
    "start": "205410",
    "end": "207959"
  },
  {
    "text": "if it's a process we're going to allow",
    "start": "207959",
    "end": "209849"
  },
  {
    "text": "we set it to allow if it's a process we",
    "start": "209849",
    "end": "212160"
  },
  {
    "text": "want to block we set the action to block",
    "start": "212160",
    "end": "214829"
  },
  {
    "text": "and if it's a new process or something",
    "start": "214829",
    "end": "216540"
  },
  {
    "text": "that we don't recognize we set the",
    "start": "216540",
    "end": "218670"
  },
  {
    "text": "action to ask next up is the connect out",
    "start": "218670",
    "end": "223609"
  },
  {
    "text": "callback and this will be called by the",
    "start": "223609",
    "end": "225959"
  },
  {
    "text": "operating system anytime a socket",
    "start": "225959",
    "end": "228000"
  },
  {
    "text": "attempts to initiate an outgoing",
    "start": "228000",
    "end": "230069"
  },
  {
    "text": "connection it takes that same cookie",
    "start": "230069",
    "end": "232349"
  },
  {
    "text": "parameter which we've set to either",
    "start": "232349",
    "end": "234090"
  },
  {
    "text": "allow block or ask the socket and then",
    "start": "234090",
    "end": "237209"
  },
  {
    "text": "the remote address that the socket is",
    "start": "237209",
    "end": "239099"
  },
  {
    "text": "trying to connect to so we can examine",
    "start": "239099",
    "end": "240930"
  },
  {
    "text": "the endpoint now if we've previously set",
    "start": "240930",
    "end": "243930"
  },
  {
    "text": "the action to allow we just return okay",
    "start": "243930",
    "end": "246569"
  },
  {
    "text": "from this function this tells the",
    "start": "246569",
    "end": "248099"
  },
  {
    "text": "operating system we're cool with this",
    "start": "248099",
    "end": "249810"
  },
  {
    "text": "and it should be allowed if we want to",
    "start": "249810",
    "end": "251760"
  },
  {
    "text": "block this we just return an error from",
    "start": "251760",
    "end": "254099"
  },
  {
    "text": "this callback and this will tell the",
    "start": "254099",
    "end": "255599"
  },
  {
    "text": "operating system to block or deny the",
    "start": "255599",
    "end": "257340"
  },
  {
    "text": "connection now if the cookie has been",
    "start": "257340",
    "end": "260070"
  },
  {
    "text": "set to ask this means we we're not sure",
    "start": "260070",
    "end": "262079"
  },
  {
    "text": "what to do you know should we allow the",
    "start": "262079",
    "end": "263640"
  },
  {
    "text": "process should we block it we're just",
    "start": "263640",
    "end": "265020"
  },
  {
    "text": "not sure so we have to have some extra",
    "start": "265020",
    "end": "268160"
  },
  {
    "text": "so if we don't know what we should do",
    "start": "268160",
    "end": "271410"
  },
  {
    "text": "we're gonna have to ask some other",
    "start": "271410",
    "end": "273690"
  },
  {
    "text": "firewall components so the first thing",
    "start": "273690",
    "end": "276030"
  },
  {
    "text": "we do is still in the kernel we set the",
    "start": "276030",
    "end": "277890"
  },
  {
    "text": "thread to sleep basically pausing the",
    "start": "277890",
    "end": "279690"
  },
  {
    "text": "operation we then ask our user mode",
    "start": "279690",
    "end": "282390"
  },
  {
    "text": "firewall component daemon for assistance",
    "start": "282390",
    "end": "285300"
  },
  {
    "text": "and we pass the information that we have",
    "start": "285300",
    "end": "287520"
  },
  {
    "text": "from the kernel to user mode via shared",
    "start": "287520",
    "end": "290220"
  },
  {
    "text": "queue for example the pit and the socket",
    "start": "290220",
    "end": "292500"
  },
  {
    "text": "that's trying to initiate the outgoing",
    "start": "292500",
    "end": "293970"
  },
  {
    "text": "connection so the daemon now gets this",
    "start": "293970",
    "end": "297270"
  },
  {
    "text": "request from the kernel and what it does",
    "start": "297270",
    "end": "299340"
  },
  {
    "text": "is that map's a pit to a path and then",
    "start": "299340",
    "end": "301860"
  },
  {
    "text": "first checks if this path exists in the",
    "start": "301860",
    "end": "304530"
  },
  {
    "text": "rules database if it's not found meaning",
    "start": "304530",
    "end": "307080"
  },
  {
    "text": "cuz it's a brand-new application or a",
    "start": "307080",
    "end": "308670"
  },
  {
    "text": "piece of malware that's never been on",
    "start": "308670",
    "end": "310470"
  },
  {
    "text": "the system before what it then does is",
    "start": "310470",
    "end": "312600"
  },
  {
    "text": "it sends another message to another",
    "start": "312600",
    "end": "314760"
  },
  {
    "text": "firewall component that's running in the",
    "start": "314760",
    "end": "317160"
  },
  {
    "text": "user's UI session which will now",
    "start": "317160",
    "end": "319230"
  },
  {
    "text": "actually display the firewall alert to",
    "start": "319230",
    "end": "321900"
  },
  {
    "text": "the user so the user now has has to",
    "start": "321900",
    "end": "325740"
  },
  {
    "text": "basically answer the question should",
    "start": "325740",
    "end": "327780"
  },
  {
    "text": "they allow this connection and what we",
    "start": "327780",
    "end": "330090"
  },
  {
    "text": "do is we wait until they interact with",
    "start": "330090",
    "end": "331530"
  },
  {
    "text": "this alert once they clicked either",
    "start": "331530",
    "end": "333870"
  },
  {
    "text": "allow or block this response is first",
    "start": "333870",
    "end": "336330"
  },
  {
    "text": "sent back to the daemon the daemon then",
    "start": "336330",
    "end": "338310"
  },
  {
    "text": "updates the rule database and then",
    "start": "338310",
    "end": "340380"
  },
  {
    "text": "propagates this response back into the",
    "start": "340380",
    "end": "342780"
  },
  {
    "text": "kernel via and i/o kit interface the",
    "start": "342780",
    "end": "345690"
  },
  {
    "text": "kernel extension wakes up the thread",
    "start": "345690",
    "end": "347970"
  },
  {
    "text": "that it had previously put asleep and",
    "start": "347970",
    "end": "349680"
  },
  {
    "text": "then applies the action that the user",
    "start": "349680",
    "end": "351600"
  },
  {
    "text": "specified either allowing or blocking",
    "start": "351600",
    "end": "353790"
  },
  {
    "text": "the connection so basically that at",
    "start": "353790",
    "end": "357600"
  },
  {
    "text": "least from a conceptual point of view is",
    "start": "357600",
    "end": "359400"
  },
  {
    "text": "all the pieces we need to build a",
    "start": "359400",
    "end": "361020"
  },
  {
    "text": "comprehensive kernel level firewall for",
    "start": "361020",
    "end": "362850"
  },
  {
    "text": "Mac OS so we put this all together we",
    "start": "362850",
    "end": "365370"
  },
  {
    "text": "have Lulu as I mentioned Lulu is a free",
    "start": "365370",
    "end": "367890"
  },
  {
    "text": "firewall for Mac OS the entire source",
    "start": "367890",
    "end": "370710"
  },
  {
    "text": "code for this product is available on",
    "start": "370710",
    "end": "372480"
  },
  {
    "text": "line and as of today you can download",
    "start": "372480",
    "end": "374580"
  },
  {
    "text": "and install version 1.0 all right now",
    "start": "374580",
    "end": "379380"
  },
  {
    "text": "blackhat is predominantly at least in my",
    "start": "379380",
    "end": "381600"
  },
  {
    "text": "opinion at a hacker conference so now",
    "start": "381600",
    "end": "383610"
  },
  {
    "text": "let's turn our attention to breaking or",
    "start": "383610",
    "end": "386310"
  },
  {
    "text": "bypassing these firewalls so imagine you",
    "start": "386310",
    "end": "390960"
  },
  {
    "text": "are an attacker or perhaps a piece of",
    "start": "390960",
    "end": "393300"
  },
  {
    "text": "malware that's made it to a host so",
    "start": "393300",
    "end": "395310"
  },
  {
    "text": "you've infected a system unfortunately",
    "start": "395310",
    "end": "396810"
  },
  {
    "text": "there is a firewall installed so what",
    "start": "396810",
    "end": "399510"
  },
  {
    "text": "your goal is pretty simple",
    "start": "399510",
    "end": "401150"
  },
  {
    "text": "it's to connect out to either a command",
    "start": "401150",
    "end": "403550"
  },
  {
    "text": "and control server for tasking or",
    "start": "403550",
    "end": "405199"
  },
  {
    "text": "perhaps to exfiltrate some data without",
    "start": "405199",
    "end": "407750"
  },
  {
    "text": "being blocked by whatever firewall is",
    "start": "407750",
    "end": "410060"
  },
  {
    "text": "installed on that system so in this part",
    "start": "410060",
    "end": "412580"
  },
  {
    "text": "of the talk we're first gonna look at",
    "start": "412580",
    "end": "413750"
  },
  {
    "text": "some malware firewall aware malware",
    "start": "413750",
    "end": "416570"
  },
  {
    "text": "we're then going to talk about some",
    "start": "416570",
    "end": "418400"
  },
  {
    "text": "exploitable security flaws in firewall",
    "start": "418400",
    "end": "421100"
  },
  {
    "text": "products and then end with talking about",
    "start": "421100",
    "end": "423199"
  },
  {
    "text": "some of firewall bypasses so it's",
    "start": "423199",
    "end": "427190"
  },
  {
    "text": "actually very important for a malware to",
    "start": "427190",
    "end": "428840"
  },
  {
    "text": "detect if there is a firewall on the box",
    "start": "428840",
    "end": "431690"
  },
  {
    "text": "because if they don't as we can see on",
    "start": "431690",
    "end": "433760"
  },
  {
    "text": "the slide this might be their undoing",
    "start": "433760",
    "end": "435260"
  },
  {
    "text": "the firewall might detect when the",
    "start": "435260",
    "end": "437510"
  },
  {
    "text": "malware which was previously undetected",
    "start": "437510",
    "end": "439220"
  },
  {
    "text": "connects out and that's alert the user",
    "start": "439220",
    "end": "441949"
  },
  {
    "text": "that there's something suspicious on",
    "start": "441949",
    "end": "443690"
  },
  {
    "text": "their box now I've yet to see any public",
    "start": "443690",
    "end": "447530"
  },
  {
    "text": "Mac malware that is proactively trying",
    "start": "447530",
    "end": "449750"
  },
  {
    "text": "to bypass firewall products but there",
    "start": "449750",
    "end": "452840"
  },
  {
    "text": "are some Mac malware specimens that are",
    "start": "452840",
    "end": "454940"
  },
  {
    "text": "firewall aware what I mean by this is",
    "start": "454940",
    "end": "457639"
  },
  {
    "text": "they actively look to see if any",
    "start": "457639",
    "end": "459380"
  },
  {
    "text": "firewall product is installed on the",
    "start": "459380",
    "end": "461240"
  },
  {
    "text": "system and if there is they will not",
    "start": "461240",
    "end": "463690"
  },
  {
    "text": "persistently infect that box so one",
    "start": "463690",
    "end": "466910"
  },
  {
    "text": "example is devil robber here is a",
    "start": "466910",
    "end": "469039"
  },
  {
    "text": "snippet of code from one of its scripts",
    "start": "469039",
    "end": "471560"
  },
  {
    "text": "install scripts and we can see what it's",
    "start": "471560",
    "end": "473690"
  },
  {
    "text": "doing is it's checking for the presence",
    "start": "473690",
    "end": "475639"
  },
  {
    "text": "of Little Snitch which is a popular",
    "start": "475639",
    "end": "477560"
  },
  {
    "text": "third party firewall if it finds that",
    "start": "477560",
    "end": "480800"
  },
  {
    "text": "extension instead of infecting the",
    "start": "480800",
    "end": "483260"
  },
  {
    "text": "system persistently it just executes a",
    "start": "483260",
    "end": "486860"
  },
  {
    "text": "benign app version of the application it",
    "start": "486860",
    "end": "488990"
  },
  {
    "text": "infected and then exits so the author of",
    "start": "488990",
    "end": "491449"
  },
  {
    "text": "this malware basically said hey I don't",
    "start": "491449",
    "end": "494419"
  },
  {
    "start": "494000",
    "end": "494000"
  },
  {
    "text": "want to be detected so if there's a",
    "start": "494419",
    "end": "495800"
  },
  {
    "text": "firewall I'm just gonna bail all right",
    "start": "495800",
    "end": "498919"
  },
  {
    "text": "so now on to some real issues firewalls",
    "start": "498919",
    "end": "501830"
  },
  {
    "text": "are obviously rather complex pieces of",
    "start": "501830",
    "end": "504199"
  },
  {
    "text": "software they run with elevated",
    "start": "504199",
    "end": "506120"
  },
  {
    "text": "privileges in route or in the kernel and",
    "start": "506120",
    "end": "509289"
  },
  {
    "text": "unfortunately they're often not as well",
    "start": "509289",
    "end": "511669"
  },
  {
    "text": "written as the operating system nor as",
    "start": "511669",
    "end": "513589"
  },
  {
    "text": "audited so they make great targets for",
    "start": "513589",
    "end": "515630"
  },
  {
    "text": "looking for local privilege escalation",
    "start": "515630",
    "end": "517700"
  },
  {
    "text": "vulnerabilities so a while back I found",
    "start": "517700",
    "end": "520820"
  },
  {
    "text": "a kernel bug in the Little Snitch",
    "start": "520820",
    "end": "522680"
  },
  {
    "text": "firewall driver basically it took a",
    "start": "522680",
    "end": "525170"
  },
  {
    "text": "64-bit value from user mode and passed",
    "start": "525170",
    "end": "528170"
  },
  {
    "text": "this value to an allocation routine and",
    "start": "528170",
    "end": "530089"
  },
  {
    "text": "then a copy routine now the issue was",
    "start": "530089",
    "end": "533360"
  },
  {
    "text": "the Alec",
    "start": "533360",
    "end": "534680"
  },
  {
    "text": "in routine expected a 32-bit value so it",
    "start": "534680",
    "end": "537890"
  },
  {
    "text": "truncated the 64-bit value the copy",
    "start": "537890",
    "end": "540470"
  },
  {
    "text": "however used the full 64-bit value",
    "start": "540470",
    "end": "542800"
  },
  {
    "text": "meaning we could cause a controllable",
    "start": "542800",
    "end": "545450"
  },
  {
    "text": "mismatch between the allocation and the",
    "start": "545450",
    "end": "548180"
  },
  {
    "text": "copy routine they giving us an",
    "start": "548180",
    "end": "550279"
  },
  {
    "text": "exploitable heap overflow in the kernel",
    "start": "550279",
    "end": "553899"
  },
  {
    "text": "another issue I found also in Little",
    "start": "553899",
    "end": "556250"
  },
  {
    "text": "Snitch when I was working on these",
    "start": "556250",
    "end": "557420"
  },
  {
    "text": "slides affects its installer or updater",
    "start": "557420",
    "end": "559850"
  },
  {
    "text": "component basically it would not",
    "start": "559850",
    "end": "561980"
  },
  {
    "text": "validate that the new firewall",
    "start": "561980",
    "end": "564350"
  },
  {
    "text": "components it was installing had not",
    "start": "564350",
    "end": "566450"
  },
  {
    "text": "been tampered so what a local",
    "start": "566450",
    "end": "568490"
  },
  {
    "text": "unprivileged attacker could do is modify",
    "start": "568490",
    "end": "571399"
  },
  {
    "text": "these components and then the privileged",
    "start": "571399",
    "end": "574330"
  },
  {
    "text": "firewall installer would naively use",
    "start": "574330",
    "end": "577310"
  },
  {
    "text": "these infected or modified components",
    "start": "577310",
    "end": "579620"
  },
  {
    "text": "and execute them as root basically",
    "start": "579620",
    "end": "581810"
  },
  {
    "text": "giving again a local and privileged",
    "start": "581810",
    "end": "583459"
  },
  {
    "text": "attacker root privileges all right so",
    "start": "583459",
    "end": "588080"
  },
  {
    "text": "now let's talk about bypassing these",
    "start": "588080",
    "end": "589700"
  },
  {
    "text": "products first we'll look at ways to",
    "start": "589700",
    "end": "591740"
  },
  {
    "text": "bypass various products so some specific",
    "start": "591740",
    "end": "594470"
  },
  {
    "text": "product specific bypasses and then we'll",
    "start": "594470",
    "end": "597500"
  },
  {
    "text": "talk about some more powerful",
    "start": "597500",
    "end": "599270"
  },
  {
    "text": "capabilities that can bypass all third",
    "start": "599270",
    "end": "601550"
  },
  {
    "text": "party firewalls again the goal is to",
    "start": "601550",
    "end": "604070"
  },
  {
    "text": "access the network without being blocked",
    "start": "604070",
    "end": "606020"
  },
  {
    "text": "by and installed firewall now I do want",
    "start": "606020",
    "end": "609020"
  },
  {
    "text": "to make one point and that is any",
    "start": "609020",
    "end": "610850"
  },
  {
    "text": "security tool that is proactively or",
    "start": "610850",
    "end": "613100"
  },
  {
    "text": "specifically targeted will be by",
    "start": "613100",
    "end": "615380"
  },
  {
    "text": "passable so in my opinion these aren't",
    "start": "615380",
    "end": "617930"
  },
  {
    "text": "necessarily security flaws like these",
    "start": "617930",
    "end": "619580"
  },
  {
    "text": "shouldn't be assigned CDs I think that's",
    "start": "619580",
    "end": "621290"
  },
  {
    "text": "kind of lame however they are very",
    "start": "621290",
    "end": "622820"
  },
  {
    "text": "important for attackers or malware which",
    "start": "622820",
    "end": "625610"
  },
  {
    "text": "might otherwise be detected or blocked",
    "start": "625610",
    "end": "628900"
  },
  {
    "text": "so first up we have radio silence radio",
    "start": "628900",
    "end": "631760"
  },
  {
    "text": "silence is a popular firewall for Mac OS",
    "start": "631760",
    "end": "634250"
  },
  {
    "text": "and by default it actually allows any",
    "start": "634250",
    "end": "636589"
  },
  {
    "text": "new process so it basically takes a more",
    "start": "636589",
    "end": "639110"
  },
  {
    "text": "blacklisting approach expecting the user",
    "start": "639110",
    "end": "641360"
  },
  {
    "text": "to blacklist a process now if you look",
    "start": "641360",
    "end": "644420"
  },
  {
    "text": "at the disassembly for its blacklisting",
    "start": "644420",
    "end": "646579"
  },
  {
    "text": "logic in the kernel we can see it's",
    "start": "646579",
    "end": "648589"
  },
  {
    "text": "checking the name of a process and if",
    "start": "648589",
    "end": "650930"
  },
  {
    "text": "the process named is Launch D it cannot",
    "start": "650930",
    "end": "653540"
  },
  {
    "text": "be blacklisted more blocked so to test",
    "start": "653540",
    "end": "656990"
  },
  {
    "text": "this we create some malware and we name",
    "start": "656990",
    "end": "659000"
  },
  {
    "text": "it launch D doesn't matter where it is",
    "start": "659000",
    "end": "660680"
  },
  {
    "text": "just as long as its name is launch D we",
    "start": "660680",
    "end": "663110"
  },
  {
    "text": "manually create a rule to blacklist the",
    "start": "663110",
    "end": "665480"
  },
  {
    "text": "malware and then we execute them our and",
    "start": "665480",
    "end": "668030"
  },
  {
    "text": "and behold even though there's a rule to",
    "start": "668030",
    "end": "669470"
  },
  {
    "text": "blacklist that it is allowed because it",
    "start": "669470",
    "end": "671810"
  },
  {
    "text": "matches on the name in the kernel so",
    "start": "671810",
    "end": "674240"
  },
  {
    "text": "this is kind of lame",
    "start": "674240",
    "end": "675320"
  },
  {
    "text": "but you know it's a full bypass another",
    "start": "675320",
    "end": "679010"
  },
  {
    "text": "popular",
    "start": "679010",
    "end": "679640"
  },
  {
    "text": "Mac firewall product is called hands-off",
    "start": "679640",
    "end": "681620"
  },
  {
    "text": "and it turns out we can fairly easily",
    "start": "681620",
    "end": "684260"
  },
  {
    "text": "bypass it via synthetic or",
    "start": "684260",
    "end": "686390"
  },
  {
    "text": "programmatically generated clicks so say",
    "start": "686390",
    "end": "689300"
  },
  {
    "text": "for example we want to execute curl curl",
    "start": "689300",
    "end": "691430"
  },
  {
    "text": "is used a lot by malware to download",
    "start": "691430",
    "end": "693710"
  },
  {
    "text": "other components maybe a second stage",
    "start": "693710",
    "end": "695960"
  },
  {
    "text": "implant etc etc so if we execute this",
    "start": "695960",
    "end": "698630"
  },
  {
    "text": "the firewall will detect that curl is",
    "start": "698630",
    "end": "700790"
  },
  {
    "text": "generating an outgoing connection which",
    "start": "700790",
    "end": "702410"
  },
  {
    "text": "is good but what an attacker or piece of",
    "start": "702410",
    "end": "704510"
  },
  {
    "text": "malware can then do is send a synthetic",
    "start": "704510",
    "end": "706430"
  },
  {
    "text": "mouse click to that alert to",
    "start": "706430",
    "end": "708170"
  },
  {
    "text": "programmatically click the allow button",
    "start": "708170",
    "end": "710030"
  },
  {
    "text": "this will allow the connection and",
    "start": "710030",
    "end": "712910"
  },
  {
    "text": "dismiss the alert and there's also ways",
    "start": "712910",
    "end": "715160"
  },
  {
    "text": "to do this invisibly so that the user",
    "start": "715160",
    "end": "716840"
  },
  {
    "text": "doesn't see the alert pop-up and the",
    "start": "716840",
    "end": "718670"
  },
  {
    "text": "mouse generate the click now onto Lulu",
    "start": "718670",
    "end": "722600"
  },
  {
    "start": "721000",
    "end": "721000"
  },
  {
    "text": "as Lulu is open-source turns out it's",
    "start": "722600",
    "end": "724910"
  },
  {
    "text": "really not that hard to find a bypass by",
    "start": "724910",
    "end": "727610"
  },
  {
    "text": "default Lulu trusts Apple signed",
    "start": "727610",
    "end": "729830"
  },
  {
    "text": "binaries although it has a grey list of",
    "start": "729830",
    "end": "732470"
  },
  {
    "text": "Apple signed binaries that perhaps could",
    "start": "732470",
    "end": "734300"
  },
  {
    "text": "be utilized by malware to perform",
    "start": "734300",
    "end": "736160"
  },
  {
    "text": "malicious Network actions for example",
    "start": "736160",
    "end": "737600"
  },
  {
    "text": "curl and net cat so the question is can",
    "start": "737600",
    "end": "740840"
  },
  {
    "text": "we find a Apple sign system binary that",
    "start": "740840",
    "end": "743960"
  },
  {
    "text": "can allow us to do nefarious Network",
    "start": "743960",
    "end": "745910"
  },
  {
    "text": "actions but that is not on the grey list",
    "start": "745910",
    "end": "749230"
  },
  {
    "text": "the answer is of course yes turns out",
    "start": "749230",
    "end": "751940"
  },
  {
    "text": "you can actually use the Whois utility",
    "start": "751940",
    "end": "753860"
  },
  {
    "text": "to exfiltrate data this was news to me",
    "start": "753860",
    "end": "756610"
  },
  {
    "text": "since Whois is signed by Apple proper as",
    "start": "756610",
    "end": "760070"
  },
  {
    "text": "we can see on the slide when we use",
    "start": "760070",
    "end": "762530"
  },
  {
    "text": "Whois to exfiltrate data the firewall",
    "start": "762530",
    "end": "765140"
  },
  {
    "text": "Lulu will see the connection because",
    "start": "765140",
    "end": "766850"
  },
  {
    "text": "it's monitoring all connections globally",
    "start": "766850",
    "end": "768650"
  },
  {
    "text": "but since it's signed by Apple and not",
    "start": "768650",
    "end": "770930"
  },
  {
    "text": "on the grey list it is allowed finally",
    "start": "770930",
    "end": "775790"
  },
  {
    "text": "we have Little Snitch which is probably",
    "start": "775790",
    "end": "777260"
  },
  {
    "text": "the most popular or well-known Mac",
    "start": "777260",
    "end": "779000"
  },
  {
    "text": "security product and it turns out it has",
    "start": "779000",
    "end": "781190"
  },
  {
    "text": "an undeletable system rule to allow any",
    "start": "781190",
    "end": "783320"
  },
  {
    "text": "process to talk to icloud.com",
    "start": "783320",
    "end": "785720"
  },
  {
    "text": "this means any process even malware will",
    "start": "785720",
    "end": "788300"
  },
  {
    "text": "be able to talk to Apple's servers so to",
    "start": "788300",
    "end": "791510"
  },
  {
    "text": "test this we can create a rule to block",
    "start": "791510",
    "end": "794120"
  },
  {
    "text": "curl and then we can execute curl and",
    "start": "794120",
    "end": "796820"
  },
  {
    "text": "specify a URL that exists on iCloud and",
    "start": "796820",
    "end": "799610"
  },
  {
    "text": "turns out even if we have this rule",
    "start": "799610",
    "end": "801680"
  },
  {
    "text": "curl because of the end point has been",
    "start": "801680",
    "end": "803660"
  },
  {
    "text": "basically whitelisted it is allowed by",
    "start": "803660",
    "end": "805760"
  },
  {
    "text": "Little Snitch",
    "start": "805760",
    "end": "807550"
  },
  {
    "text": "so while back i reverse-engineered the",
    "start": "807550",
    "end": "810620"
  },
  {
    "text": "iCloud protocol and set up a command and",
    "start": "810620",
    "end": "813350"
  },
  {
    "text": "control server on iDrive which is also",
    "start": "813350",
    "end": "815450"
  },
  {
    "text": "an iCloud domain of course just for",
    "start": "815450",
    "end": "817490"
  },
  {
    "text": "testing purposes so once we understand",
    "start": "817490",
    "end": "820130"
  },
  {
    "text": "the protocol we can write a script that",
    "start": "820130",
    "end": "821570"
  },
  {
    "text": "will export rate files for example",
    "start": "821570",
    "end": "823370"
  },
  {
    "text": "something called top-secret txt to",
    "start": "823370",
    "end": "826240"
  },
  {
    "text": "iCloud to the iDrive command control",
    "start": "826240",
    "end": "829130"
  },
  {
    "text": "server we have setup again",
    "start": "829130",
    "end": "831050"
  },
  {
    "text": "little snitch will see this connection",
    "start": "831050",
    "end": "832670"
  },
  {
    "text": "but because of the endpoint is allowed",
    "start": "832670",
    "end": "834560"
  },
  {
    "text": "it will allow the exfiltration to occur",
    "start": "834560",
    "end": "837790"
  },
  {
    "text": "all right so those were product specific",
    "start": "837790",
    "end": "840410"
  },
  {
    "start": "838000",
    "end": "838000"
  },
  {
    "text": "bypasses they're kind of neat but",
    "start": "840410",
    "end": "841790"
  },
  {
    "text": "they're also kind of lame why well the",
    "start": "841790",
    "end": "843950"
  },
  {
    "text": "attacker will first have to enumerate",
    "start": "843950",
    "end": "845630"
  },
  {
    "text": "what exact product firewall product is",
    "start": "845630",
    "end": "847970"
  },
  {
    "text": "installed and then use one of these",
    "start": "847970",
    "end": "849529"
  },
  {
    "text": "product specific exploits so that's kind",
    "start": "849529",
    "end": "851839"
  },
  {
    "text": "of a pain in the butt now much much",
    "start": "851839",
    "end": "854120"
  },
  {
    "text": "better would would be to have a generic",
    "start": "854120",
    "end": "856520"
  },
  {
    "text": "bypass which would inspire any installed",
    "start": "856520",
    "end": "860270"
  },
  {
    "text": "firewall basically saying I'm agnostic",
    "start": "860270",
    "end": "861890"
  },
  {
    "text": "to whatever firewall that's installed",
    "start": "861890",
    "end": "863690"
  },
  {
    "text": "I'm just going to generically buy passes",
    "start": "863690",
    "end": "865130"
  },
  {
    "text": "and these are possible because firewalls",
    "start": "865130",
    "end": "868250"
  },
  {
    "text": "must allow some traffic on the network",
    "start": "868250",
    "end": "870920"
  },
  {
    "text": "for example system protocols system",
    "start": "870920",
    "end": "873680"
  },
  {
    "text": "binaries and also the user is probably",
    "start": "873680",
    "end": "875810"
  },
  {
    "text": "going to fully allow things like",
    "start": "875810",
    "end": "877279"
  },
  {
    "text": "browsers giving them indiscriminate",
    "start": "877279",
    "end": "879170"
  },
  {
    "text": "network access so to generically bypass",
    "start": "879170",
    "end": "882920"
  },
  {
    "text": "a system with a firewall we going to do",
    "start": "882920",
    "end": "884839"
  },
  {
    "text": "two things first we're going to",
    "start": "884839",
    "end": "886490"
  },
  {
    "text": "passively sniff and determine what",
    "start": "886490",
    "end": "889040"
  },
  {
    "text": "traffic the firewall is allowing out and",
    "start": "889040",
    "end": "891050"
  },
  {
    "text": "then we're going to abuse either these",
    "start": "891050",
    "end": "892910"
  },
  {
    "text": "protocols or these applications to",
    "start": "892910",
    "end": "894800"
  },
  {
    "text": "perform nefarious Network actions so",
    "start": "894800",
    "end": "899450"
  },
  {
    "text": "first to determine what processes or",
    "start": "899450",
    "end": "902450"
  },
  {
    "text": "protocols are allowed we can use the El",
    "start": "902450",
    "end": "905270"
  },
  {
    "text": "SOF utility which is built-in system",
    "start": "905270",
    "end": "907640"
  },
  {
    "text": "utility on Mac OS you can execute it",
    "start": "907640",
    "end": "909829"
  },
  {
    "text": "without any special privileges and it",
    "start": "909829",
    "end": "911779"
  },
  {
    "text": "will show you what network traffic is",
    "start": "911779",
    "end": "913940"
  },
  {
    "text": "allowed so this is a dump from my box we",
    "start": "913940",
    "end": "916220"
  },
  {
    "text": "can see things like chrome the browser",
    "start": "916220",
    "end": "919130"
  },
  {
    "text": "you know chat applications like slack",
    "start": "919130",
    "end": "920990"
  },
  {
    "text": "signal bunch of Adobe crap basically a",
    "start": "920990",
    "end": "923870"
  },
  {
    "text": "lot of stuff now some firewalls will",
    "start": "923870",
    "end": "926839"
  },
  {
    "text": "have endpoints specific rules meaning",
    "start": "926839",
    "end": "929390"
  },
  {
    "text": "that they might say ok Adobe is only",
    "start": "929390",
    "end": "931250"
  },
  {
    "text": "allowed to talk to the Adobe servers but",
    "start": "931250",
    "end": "933740"
  },
  {
    "text": "as I mentioned something like a browsers",
    "start": "933740",
    "end": "935360"
  },
  {
    "text": "go",
    "start": "935360",
    "end": "935630"
  },
  {
    "text": "to be able to talk to any remote web",
    "start": "935630",
    "end": "938090"
  },
  {
    "text": "server on port 80 or 443 of course also",
    "start": "938090",
    "end": "941660"
  },
  {
    "text": "a lot of these applications now talk to",
    "start": "941660",
    "end": "943190"
  },
  {
    "text": "the cloud for example AWS so even if",
    "start": "943190",
    "end": "945590"
  },
  {
    "text": "there's a rule to say I only want slack",
    "start": "945590",
    "end": "947150"
  },
  {
    "text": "to talk to the AWS infrastructure we can",
    "start": "947150",
    "end": "949700"
  },
  {
    "text": "probably also create a CNC on AWS okay",
    "start": "949700",
    "end": "955040"
  },
  {
    "start": "954000",
    "end": "954000"
  },
  {
    "text": "so now we know what traffic and what",
    "start": "955040",
    "end": "957110"
  },
  {
    "text": "processes are allowed or allowed to pass",
    "start": "957110",
    "end": "959300"
  },
  {
    "text": "through the firewall",
    "start": "959300",
    "end": "960200"
  },
  {
    "text": "so the first generic bypass we're",
    "start": "960200",
    "end": "962510"
  },
  {
    "text": "actually going to indirectly exploit the",
    "start": "962510",
    "end": "964850"
  },
  {
    "text": "trust of a process via a trusted",
    "start": "964850",
    "end": "967490"
  },
  {
    "text": "protocol so on Mac DNS on Mac OS DNS",
    "start": "967490",
    "end": "971600"
  },
  {
    "text": "requests are handled by the system mdns",
    "start": "971600",
    "end": "975200"
  },
  {
    "text": "responder so if a random application or",
    "start": "975200",
    "end": "977660"
  },
  {
    "text": "a piece of malware wants to resolve a",
    "start": "977660",
    "end": "980210"
  },
  {
    "text": "domain this is sent locally to the",
    "start": "980210",
    "end": "982280"
  },
  {
    "text": "system daemon then the system daemon is",
    "start": "982280",
    "end": "984740"
  },
  {
    "text": "the one that actually generates the",
    "start": "984740",
    "end": "986210"
  },
  {
    "text": "network requests so the firewall is",
    "start": "986210",
    "end": "991190"
  },
  {
    "text": "gonna see this DNS request but it's",
    "start": "991190",
    "end": "992990"
  },
  {
    "text": "going to be coming from a trusted system",
    "start": "992990",
    "end": "994970"
  },
  {
    "text": "daemon which is generating all DNS",
    "start": "994970",
    "end": "998540"
  },
  {
    "text": "requests for the entire system so the",
    "start": "998540",
    "end": "1000610"
  },
  {
    "text": "firewall basically has no choice but to",
    "start": "1000610",
    "end": "1002320"
  },
  {
    "text": "allow it so what we can do is we can",
    "start": "1002320",
    "end": "1004690"
  },
  {
    "text": "basically build a dns base C&C mechanism",
    "start": "1004690",
    "end": "1007090"
  },
  {
    "text": "which has been discussed before and",
    "start": "1007090",
    "end": "1008710"
  },
  {
    "text": "again since the firewall is going to",
    "start": "1008710",
    "end": "1010540"
  },
  {
    "text": "trust DNS requests from the trusted",
    "start": "1010540",
    "end": "1012430"
  },
  {
    "text": "Apple system daemon this will allow us",
    "start": "1012430",
    "end": "1014350"
  },
  {
    "text": "to have a full command and control",
    "start": "1014350",
    "end": "1016230"
  },
  {
    "text": "mechanism which can generically bypass",
    "start": "1016230",
    "end": "1018250"
  },
  {
    "text": "all third party firewalls next up let's",
    "start": "1018250",
    "end": "1021910"
  },
  {
    "start": "1021000",
    "end": "1021000"
  },
  {
    "text": "abuse browsers the simple fact is if you",
    "start": "1021910",
    "end": "1024670"
  },
  {
    "text": "have a browser installed even if you",
    "start": "1024670",
    "end": "1027010"
  },
  {
    "text": "also have a firewall installed you're",
    "start": "1027010",
    "end": "1028810"
  },
  {
    "text": "going to give the browser generally",
    "start": "1028810",
    "end": "1030819"
  },
  {
    "text": "indiscriminate access because I mean",
    "start": "1030819",
    "end": "1032500"
  },
  {
    "text": "think about it it browses to hundreds of",
    "start": "1032500",
    "end": "1034270"
  },
  {
    "text": "websites every day there's no way you're",
    "start": "1034270",
    "end": "1035560"
  },
  {
    "text": "just gonna sit and whitelist all of them",
    "start": "1035560",
    "end": "1037060"
  },
  {
    "text": "and of course this is something that we",
    "start": "1037060",
    "end": "1038650"
  },
  {
    "text": "can passively determine via l sof we can",
    "start": "1038650",
    "end": "1041709"
  },
  {
    "text": "for example watch for a few hours even a",
    "start": "1041709",
    "end": "1043540"
  },
  {
    "text": "few days and build a profile of what",
    "start": "1043540",
    "end": "1045430"
  },
  {
    "text": "traffic the browser allows and then",
    "start": "1045430",
    "end": "1046990"
  },
  {
    "text": "basically say okay it looks like chrome",
    "start": "1046990",
    "end": "1049240"
  },
  {
    "text": "is allowed to talk to any network",
    "start": "1049240",
    "end": "1050320"
  },
  {
    "text": "endpoint so the first way we can abuse a",
    "start": "1050320",
    "end": "1053530"
  },
  {
    "text": "browser to do some malicious Network",
    "start": "1053530",
    "end": "1055740"
  },
  {
    "text": "activity based on our behalf is via",
    "start": "1055740",
    "end": "1058240"
  },
  {
    "text": "Apple script so on the slide there's a",
    "start": "1058240",
    "end": "1060550"
  },
  {
    "text": "few little Apple script commands we're",
    "start": "1060550",
    "end": "1062200"
  },
  {
    "text": "basically asking Safari to invisibly",
    "start": "1062200",
    "end": "1064600"
  },
  {
    "text": "browse to a remote attacker controlled",
    "start": "1064600",
    "end": "1067300"
  },
  {
    "text": "command and control server",
    "start": "1067300",
    "end": "1068950"
  },
  {
    "text": "again the firewall will see this request",
    "start": "1068950",
    "end": "1070720"
  },
  {
    "text": "but will allow it because it's coming",
    "start": "1070720",
    "end": "1072640"
  },
  {
    "text": "from the context of the users browser an",
    "start": "1072640",
    "end": "1077440"
  },
  {
    "text": "even better way to generically bypass",
    "start": "1077440",
    "end": "1079480"
  },
  {
    "text": "all firewalls is to abuse the browser's",
    "start": "1079480",
    "end": "1082120"
  },
  {
    "text": "command-line interfaces all the major",
    "start": "1082120",
    "end": "1084220"
  },
  {
    "text": "browsers now support synthetic browsing",
    "start": "1084220",
    "end": "1087370"
  },
  {
    "text": "via the command line really doesn't get",
    "start": "1087370",
    "end": "1089440"
  },
  {
    "text": "easier than this so again the firewall",
    "start": "1089440",
    "end": "1091810"
  },
  {
    "text": "will see these connections but will",
    "start": "1091810",
    "end": "1094060"
  },
  {
    "text": "allow them as it really just appears",
    "start": "1094060",
    "end": "1096130"
  },
  {
    "text": "like it's the users default browser",
    "start": "1096130",
    "end": "1097810"
  },
  {
    "text": "browsing to some endpoint which is what",
    "start": "1097810",
    "end": "1100030"
  },
  {
    "text": "browsers do yet another way to abuse any",
    "start": "1100030",
    "end": "1104710"
  },
  {
    "text": "application or trusted binary is to",
    "start": "1104710",
    "end": "1107830"
  },
  {
    "text": "inject a dynamic library into it once",
    "start": "1107830",
    "end": "1110800"
  },
  {
    "text": "the library or your code is in the",
    "start": "1110800",
    "end": "1112870"
  },
  {
    "text": "process context of this trusted process",
    "start": "1112870",
    "end": "1116020"
  },
  {
    "text": "from the firewalls point of view",
    "start": "1116020",
    "end": "1118300"
  },
  {
    "text": "whatever trust that application has will",
    "start": "1118300",
    "end": "1121420"
  },
  {
    "text": "be also given to that dynamic library so",
    "start": "1121420",
    "end": "1124090"
  },
  {
    "text": "for example if you have a chat",
    "start": "1124090",
    "end": "1125110"
  },
  {
    "text": "application or a browser that's allowed",
    "start": "1125110",
    "end": "1126940"
  },
  {
    "text": "to talk to any network endpoint you can",
    "start": "1126940",
    "end": "1129040"
  },
  {
    "text": "inject a dye Lib into that process the",
    "start": "1129040",
    "end": "1131710"
  },
  {
    "text": "firewall will also give that library",
    "start": "1131710",
    "end": "1133900"
  },
  {
    "text": "full access because it's checks or",
    "start": "1133900",
    "end": "1136060"
  },
  {
    "text": "insight is really only at the process",
    "start": "1136060",
    "end": "1137800"
  },
  {
    "text": "level now there's many ways to inject",
    "start": "1137800",
    "end": "1140350"
  },
  {
    "text": "dye lips into third-party applications",
    "start": "1140350",
    "end": "1142210"
  },
  {
    "text": "on Mac OS fortunately due to time",
    "start": "1142210",
    "end": "1144190"
  },
  {
    "text": "constraints we can't go through these",
    "start": "1144190",
    "end": "1145510"
  },
  {
    "text": "but I've listed them on the slide now",
    "start": "1145510",
    "end": "1149530"
  },
  {
    "start": "1148000",
    "end": "1148000"
  },
  {
    "text": "the final way to bypass firewalls invert",
    "start": "1149530",
    "end": "1152440"
  },
  {
    "text": "involves getting a malicious code",
    "start": "1152440",
    "end": "1153880"
  },
  {
    "text": "running in the kernel in short if an",
    "start": "1153880",
    "end": "1155980"
  },
  {
    "text": "attacker can get code running in ring",
    "start": "1155980",
    "end": "1158020"
  },
  {
    "text": "zero it's really game over from the",
    "start": "1158020",
    "end": "1160030"
  },
  {
    "text": "firewalls point of view first most",
    "start": "1160030",
    "end": "1162040"
  },
  {
    "text": "firewalls actually generically allow any",
    "start": "1162040",
    "end": "1164170"
  },
  {
    "text": "traffic that originates from the kernel",
    "start": "1164170",
    "end": "1166330"
  },
  {
    "text": "anyways so you can just generate an",
    "start": "1166330",
    "end": "1168550"
  },
  {
    "text": "outgoing Network request the firewall",
    "start": "1168550",
    "end": "1170560"
  },
  {
    "text": "will see it but again since it's coming",
    "start": "1170560",
    "end": "1172390"
  },
  {
    "text": "from the context of the kernel it will",
    "start": "1172390",
    "end": "1174340"
  },
  {
    "text": "be allowed you can also do something",
    "start": "1174340",
    "end": "1177700"
  },
  {
    "text": "like generically unhook or uninstall the",
    "start": "1177700",
    "end": "1180370"
  },
  {
    "text": "socket filter firewall driver or",
    "start": "1180370",
    "end": "1182440"
  },
  {
    "text": "extension this will transparently",
    "start": "1182440",
    "end": "1184600"
  },
  {
    "text": "disable the firewall and then the",
    "start": "1184600",
    "end": "1186850"
  },
  {
    "text": "attackers code or any component in user",
    "start": "1186850",
    "end": "1189010"
  },
  {
    "text": "mode can generate outgoing connections",
    "start": "1189010",
    "end": "1191020"
  },
  {
    "text": "and since the firewall has been",
    "start": "1191020",
    "end": "1192430"
  },
  {
    "text": "effectively neutered this connection",
    "start": "1192430",
    "end": "1194380"
  },
  {
    "text": "will be allowed now a valid question is",
    "start": "1194380",
    "end": "1197650"
  },
  {
    "text": "how do we get code running in the kernel",
    "start": "1197650",
    "end": "1199120"
  },
  {
    "text": "recent versions of Mac OS require kernel",
    "start": "1199120",
    "end": "1202450"
  },
  {
    "text": "mentions to be signed so one way it's",
    "start": "1202450",
    "end": "1204580"
  },
  {
    "text": "just to bring a third party driver that",
    "start": "1204580",
    "end": "1206620"
  },
  {
    "text": "has a vulnerability along with you to",
    "start": "1206620",
    "end": "1208930"
  },
  {
    "text": "the target you then load that driver it",
    "start": "1208930",
    "end": "1211060"
  },
  {
    "text": "will be allowed because it's validly",
    "start": "1211060",
    "end": "1212680"
  },
  {
    "text": "signed and then you can exploit the",
    "start": "1212680",
    "end": "1214600"
  },
  {
    "text": "vulnerability so for example we could",
    "start": "1214600",
    "end": "1216310"
  },
  {
    "text": "bring the Little Snitch kernel extension",
    "start": "1216310",
    "end": "1218460"
  },
  {
    "text": "load it and then exploit it eventually",
    "start": "1218460",
    "end": "1221110"
  },
  {
    "text": "Apple does blacklist some of these",
    "start": "1221110",
    "end": "1222910"
  },
  {
    "text": "extensions but not for a very long time",
    "start": "1222910",
    "end": "1224680"
  },
  {
    "text": "and this is obviously only if they know",
    "start": "1224680",
    "end": "1226180"
  },
  {
    "text": "about the vulnerability this is",
    "start": "1226180",
    "end": "1227980"
  },
  {
    "text": "interesting because the slingshot apt",
    "start": "1227980",
    "end": "1229810"
  },
  {
    "text": "group did exactly this on Windows to",
    "start": "1229810",
    "end": "1231820"
  },
  {
    "text": "bypass Microsoft's kernel code signing",
    "start": "1231820",
    "end": "1234970"
  },
  {
    "text": "enforcement now I talked about this",
    "start": "1234970",
    "end": "1238120"
  },
  {
    "text": "attack at Def Con 2016 and since then",
    "start": "1238120",
    "end": "1240880"
  },
  {
    "text": "Apple has sought to mitigate this by",
    "start": "1240880",
    "end": "1243910"
  },
  {
    "text": "introducing a security mechanism called",
    "start": "1243910",
    "end": "1246400"
  },
  {
    "text": "user approved kernel extension loading",
    "start": "1246400",
    "end": "1249010"
  },
  {
    "text": "basically apple says okay even if you",
    "start": "1249010",
    "end": "1251260"
  },
  {
    "text": "have a third party driver that's validly",
    "start": "1251260",
    "end": "1253600"
  },
  {
    "text": "signed if you try to load it even if",
    "start": "1253600",
    "end": "1255700"
  },
  {
    "text": "it's a legitimate driver we are going to",
    "start": "1255700",
    "end": "1257710"
  },
  {
    "text": "block it and prompt the user turns out",
    "start": "1257710",
    "end": "1260470"
  },
  {
    "text": "it was trivial to bypass this via a",
    "start": "1260470",
    "end": "1262030"
  },
  {
    "text": "synthetic click and although Apple",
    "start": "1262030",
    "end": "1263950"
  },
  {
    "text": "patches patch that unfortunately as is",
    "start": "1263950",
    "end": "1266530"
  },
  {
    "text": "the case with many Apple security",
    "start": "1266530",
    "end": "1267790"
  },
  {
    "text": "mechanisms it's still completely trivial",
    "start": "1267790",
    "end": "1269740"
  },
  {
    "text": "to bypass so since the introduction of",
    "start": "1269740",
    "end": "1271630"
  },
  {
    "text": "the security feature it's been",
    "start": "1271630",
    "end": "1272860"
  },
  {
    "text": "completely broken so I'm gonna give a",
    "start": "1272860",
    "end": "1274540"
  },
  {
    "text": "talk at DEFCON on this if you are more",
    "start": "1274540",
    "end": "1276190"
  },
  {
    "text": "interested in that all right so let's",
    "start": "1276190",
    "end": "1279310"
  },
  {
    "text": "wrap this up so today we talked about",
    "start": "1279310",
    "end": "1282430"
  },
  {
    "text": "making firewalls basically using a",
    "start": "1282430",
    "end": "1284890"
  },
  {
    "text": "socket filter it's really not too",
    "start": "1284890",
    "end": "1286960"
  },
  {
    "text": "complicated if you're interested more",
    "start": "1286960",
    "end": "1289030"
  },
  {
    "text": "some of the details or the source code",
    "start": "1289030",
    "end": "1291640"
  },
  {
    "text": "check out lulu again it's fully open",
    "start": "1291640",
    "end": "1293200"
  },
  {
    "text": "source lots of comments you can build it",
    "start": "1293200",
    "end": "1294790"
  },
  {
    "text": "compile it poke around and hopefully it",
    "start": "1294790",
    "end": "1296560"
  },
  {
    "text": "gives you a good idea exactly how you",
    "start": "1296560",
    "end": "1298090"
  },
  {
    "text": "would go about building such a firewall",
    "start": "1298090",
    "end": "1300060"
  },
  {
    "text": "we then talked about breaking firewalls",
    "start": "1300060",
    "end": "1302620"
  },
  {
    "text": "turns out yes they have security",
    "start": "1302620",
    "end": "1304150"
  },
  {
    "text": "vulnerabilities and unfortunately they",
    "start": "1304150",
    "end": "1305800"
  },
  {
    "text": "are pretty easy to generically bypass",
    "start": "1305800",
    "end": "1307900"
  },
  {
    "text": "now this doesn't mean all is lost but it",
    "start": "1307900",
    "end": "1310750"
  },
  {
    "text": "certainly makes a good case for defense",
    "start": "1310750",
    "end": "1312850"
  },
  {
    "text": "in depth in my opinion you should have",
    "start": "1312850",
    "end": "1314950"
  },
  {
    "text": "some other security tools perhaps that",
    "start": "1314950",
    "end": "1317170"
  },
  {
    "text": "are detecting dial-up injections or",
    "start": "1317170",
    "end": "1319690"
  },
  {
    "text": "perhaps detecting if a browser is",
    "start": "1319690",
    "end": "1321610"
  },
  {
    "text": "executed from the command line more",
    "start": "1321610",
    "end": "1323830"
  },
  {
    "text": "behavioral based activities that might",
    "start": "1323830",
    "end": "1326110"
  },
  {
    "text": "indicate a precursor to an attack now a",
    "start": "1326110",
    "end": "1328780"
  },
  {
    "text": "firewall I don't think should be",
    "start": "1328780",
    "end": "1330760"
  },
  {
    "text": "monitoring all these other behavioral",
    "start": "1330760",
    "end": "1332410"
  },
  {
    "text": "detections but perhaps some other third",
    "start": "1332410",
    "end": "1334960"
  },
  {
    "text": "party utility can",
    "start": "1334960",
    "end": "1337710"
  },
  {
    "text": "also finally I'm stoked to announce that",
    "start": "1337710",
    "end": "1340150"
  },
  {
    "text": "I'm going to be organizing a Mac",
    "start": "1340150",
    "end": "1342490"
  },
  {
    "text": "security conference called objective by",
    "start": "1342490",
    "end": "1344440"
  },
  {
    "text": "the sea it's gonna be this November in",
    "start": "1344440",
    "end": "1346210"
  },
  {
    "text": "Maui we got a great lineup of speakers",
    "start": "1346210",
    "end": "1349240"
  },
  {
    "text": "and if you're a supporter of objective-c",
    "start": "1349240",
    "end": "1351460"
  },
  {
    "text": "which you can be for one dollar the",
    "start": "1351460",
    "end": "1352870"
  },
  {
    "text": "conference is actually completely free I",
    "start": "1352870",
    "end": "1355680"
  },
  {
    "text": "can talk a lot about how awesome the",
    "start": "1355680",
    "end": "1357970"
  },
  {
    "text": "speakers are they're very awesome but",
    "start": "1357970",
    "end": "1359740"
  },
  {
    "text": "you know come on it's in Hawaii in",
    "start": "1359740",
    "end": "1361660"
  },
  {
    "text": "November so if you're interested check",
    "start": "1361660",
    "end": "1363970"
  },
  {
    "text": "out objective by the sea calm this is",
    "start": "1363970",
    "end": "1366820"
  },
  {
    "text": "the resort it's going to be held and",
    "start": "1366820",
    "end": "1368500"
  },
  {
    "text": "again it's me a lot of great talks about",
    "start": "1368500",
    "end": "1369790"
  },
  {
    "text": "iOS and Mac security alright that's a",
    "start": "1369790",
    "end": "1373960"
  },
  {
    "start": "1373000",
    "end": "1373000"
  },
  {
    "text": "wrap",
    "start": "1373960",
    "end": "1374410"
  },
  {
    "text": "really want to say thank you for",
    "start": "1374410",
    "end": "1376030"
  },
  {
    "text": "attending also want to thank the",
    "start": "1376030",
    "end": "1377410"
  },
  {
    "text": "partners and Friends of objective-c",
    "start": "1377410",
    "end": "1378900"
  },
  {
    "text": "digital security and Malwarebytes and we",
    "start": "1378900",
    "end": "1382390"
  },
  {
    "text": "have about two minutes for questions and",
    "start": "1382390",
    "end": "1384520"
  },
  {
    "text": "also be around after the talk if there's",
    "start": "1384520",
    "end": "1386650"
  },
  {
    "text": "some more questions you'd like to",
    "start": "1386650",
    "end": "1388120"
  },
  {
    "text": "discuss",
    "start": "1388120",
    "end": "1390420"
  },
  {
    "text": "yeah great question so is in the Mojave",
    "start": "1403560",
    "end": "1406390"
  },
  {
    "text": "bet betas that are coming out how has",
    "start": "1406390",
    "end": "1408010"
  },
  {
    "text": "Apple basically implemented any security",
    "start": "1408010",
    "end": "1410200"
  },
  {
    "text": "features that may impact this and that's",
    "start": "1410200",
    "end": "1411820"
  },
  {
    "text": "a great question because they've",
    "start": "1411820",
    "end": "1413320"
  },
  {
    "text": "actually limited what certain",
    "start": "1413320",
    "end": "1414700"
  },
  {
    "text": "applications can do so for example you",
    "start": "1414700",
    "end": "1416890"
  },
  {
    "text": "can now no longer use Apple script to",
    "start": "1416890",
    "end": "1418870"
  },
  {
    "text": "talk to another application so you can't",
    "start": "1418870",
    "end": "1421660"
  },
  {
    "text": "for example Drive Safari via Apple",
    "start": "1421660",
    "end": "1423700"
  },
  {
    "text": "script unfortunately you can still do",
    "start": "1423700",
    "end": "1425950"
  },
  {
    "text": "things like various dialate attacks or",
    "start": "1425950",
    "end": "1427870"
  },
  {
    "text": "execute Safari from the command line so",
    "start": "1427870",
    "end": "1430240"
  },
  {
    "text": "there's still multiple waves but they",
    "start": "1430240",
    "end": "1432160"
  },
  {
    "text": "are kind of blocking some of these",
    "start": "1432160",
    "end": "1434020"
  },
  {
    "text": "attack vectors some of the precursors to",
    "start": "1434020",
    "end": "1436690"
  },
  {
    "text": "the attacks so you know I think I would",
    "start": "1436690",
    "end": "1438940"
  },
  {
    "text": "definitely install it when it comes out",
    "start": "1438940",
    "end": "1440320"
  },
  {
    "text": "because it it does increase the bar in",
    "start": "1440320",
    "end": "1442060"
  },
  {
    "text": "terms of security so that's a good thing",
    "start": "1442060",
    "end": "1444630"
  },
  {
    "text": "any other questions I'm guessing this",
    "start": "1444630",
    "end": "1452170"
  },
  {
    "text": "applies to the built-in firewall as well",
    "start": "1452170",
    "end": "1454780"
  },
  {
    "text": "Oh excellent question so the built-in",
    "start": "1454780",
    "end": "1457000"
  },
  {
    "text": "firewall is is great but the problem is",
    "start": "1457000",
    "end": "1459310"
  },
  {
    "text": "it only monitors incoming connections so",
    "start": "1459310",
    "end": "1462460"
  },
  {
    "text": "any activity for example any malware",
    "start": "1462460",
    "end": "1464290"
  },
  {
    "text": "that gets on your system that tries to",
    "start": "1464290",
    "end": "1465820"
  },
  {
    "text": "connect out to a command control server",
    "start": "1465820",
    "end": "1467530"
  },
  {
    "text": "or exfiltrate data the built-in firewall",
    "start": "1467530",
    "end": "1470200"
  },
  {
    "text": "is not even looking at this traffic and",
    "start": "1470200",
    "end": "1472930"
  },
  {
    "text": "the majority of attacks affecting both",
    "start": "1472930",
    "end": "1475150"
  },
  {
    "text": "the enterprise and end-user and Mac",
    "start": "1475150",
    "end": "1477250"
  },
  {
    "text": "users that is going to be kind of the",
    "start": "1477250",
    "end": "1479470"
  },
  {
    "text": "behavior that the malware is going to",
    "start": "1479470",
    "end": "1481270"
  },
  {
    "text": "come in maybe via an email the users",
    "start": "1481270",
    "end": "1482920"
  },
  {
    "text": "gonna be tricked into downloading and",
    "start": "1482920",
    "end": "1484450"
  },
  {
    "text": "running something so the first network",
    "start": "1484450",
    "end": "1486190"
  },
  {
    "text": "traffic that's actually going to be",
    "start": "1486190",
    "end": "1487510"
  },
  {
    "text": "generated is this outgoing traffic so",
    "start": "1487510",
    "end": "1489730"
  },
  {
    "text": "it's good to turn on the built-in",
    "start": "1489730",
    "end": "1490900"
  },
  {
    "text": "firewall but it really doesn't buy you",
    "start": "1490900",
    "end": "1492310"
  },
  {
    "text": "that much in my opinion and I think",
    "start": "1492310",
    "end": "1494110"
  },
  {
    "text": "Apple did this because they don't want",
    "start": "1494110",
    "end": "1495490"
  },
  {
    "text": "to annoy the average Mac user with",
    "start": "1495490",
    "end": "1497470"
  },
  {
    "text": "pop-ups when for example the browser",
    "start": "1497470",
    "end": "1499570"
  },
  {
    "text": "they installed tries to connect to the",
    "start": "1499570",
    "end": "1500980"
  },
  {
    "text": "internet because you know that would be",
    "start": "1500980",
    "end": "1502540"
  },
  {
    "text": "confusing to at least a handful of Mac",
    "start": "1502540",
    "end": "1504160"
  },
  {
    "text": "users and Apple usually airs on the side",
    "start": "1504160",
    "end": "1506020"
  },
  {
    "text": "of usability versus security awesome all",
    "start": "1506020",
    "end": "1511360"
  },
  {
    "text": "right we are out of time I will be here",
    "start": "1511360",
    "end": "1512860"
  },
  {
    "text": "for a few more questions again Mahalo so",
    "start": "1512860",
    "end": "1514660"
  },
  {
    "text": "much for attending my talk and I hope to",
    "start": "1514660",
    "end": "1516640"
  },
  {
    "text": "see you all in Hawaii this November",
    "start": "1516640",
    "end": "1520650"
  }
]