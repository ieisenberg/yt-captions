[
  {
    "text": "good afternoon my name is Ben Williams I'm a consultant I work for NCC group",
    "start": "0",
    "end": "6120"
  },
  {
    "text": "and most of what I do is penetration testing so from my day-to-day role is basically assessing our customers",
    "start": "6120",
    "end": "12799"
  },
  {
    "text": "external and internal infrastructure and web applications and trying to break in",
    "start": "12799",
    "end": "18600"
  },
  {
    "text": "my spare time I do a little bit of exploit development I like to play around with security products",
    "start": "18600",
    "end": "24900"
  },
  {
    "text": "I spoke here last year I don't know if any of you here saw my talk last year on attacking security gateways via web uis",
    "start": "24900",
    "end": "32700"
  },
  {
    "text": "anyone it was on at the same time of day's Litchfield to talk on databases",
    "start": "32700",
    "end": "39079"
  },
  {
    "text": "and he's better looking than I am so I met something you may not seen that",
    "start": "39079",
    "end": "45120"
  },
  {
    "text": "so what am I going to talk about today well I'm going to talk about some of the",
    "start": "45120",
    "end": "50760"
  },
  {
    "text": "vulnerabilities I've discovered over a period of sort of 2012.",
    "start": "50760",
    "end": "56879"
  },
  {
    "text": "so last year I talked about some research I'd done in 2011 where I'd",
    "start": "56879",
    "end": "61980"
  },
  {
    "text": "looked specifically at security Gateway products and I looked at some software products and some appliances and focus",
    "start": "61980",
    "end": "69600"
  },
  {
    "text": "on the web UI and following on from that research in",
    "start": "69600",
    "end": "74820"
  },
  {
    "text": "2012 I focused more on security appliances because I saw that there were",
    "start": "74820",
    "end": "80040"
  },
  {
    "text": "more vulnerabilities and more serious vulnerabilities in the security appliances and they're easier to find",
    "start": "80040",
    "end": "85740"
  },
  {
    "text": "and exploit predominantly because of the large interaction between the web UI and",
    "start": "85740",
    "end": "91380"
  },
  {
    "text": "the underlying operating system in appliances um so what are you going to see today",
    "start": "91380",
    "end": "98700"
  },
  {
    "text": "well I'm going to show some of the exploits that I've found so there's going to be a little bit of demo you're",
    "start": "98700",
    "end": "104040"
  },
  {
    "text": "going to get to see a little bit of root shell what you're not going to see you're not going to see any rocket science because",
    "start": "104040",
    "end": "110399"
  },
  {
    "text": "some of the vulnerabilities that I've discovered are fairly basic owasp top 10",
    "start": "110399",
    "end": "115920"
  },
  {
    "text": "type issues basic misconfiguration type issues which kind of brings us on to the irony",
    "start": "115920",
    "end": "122000"
  },
  {
    "text": "that it's interesting that so many of our security products",
    "start": "122000",
    "end": "128220"
  },
  {
    "text": "suffer from such relatively basic and easy to find vulnerabilities",
    "start": "128220",
    "end": "133680"
  },
  {
    "text": "I've seen plenty of irony over the last 18 months or so for example web application firewall with web",
    "start": "133680",
    "end": "139980"
  },
  {
    "text": "application vulnerabilities firewalls that you can attack and compromise fully from outside of an",
    "start": "139980",
    "end": "146879"
  },
  {
    "text": "organization uh email filters that you could compromise with a malicious email a URL",
    "start": "146879",
    "end": "153480"
  },
  {
    "text": "filter that you could compromise with a malicious URL and a single sign-on",
    "start": "153480",
    "end": "159180"
  },
  {
    "text": "system where you could extract all the credentials out of the system in an unauthenticated way so there's certainly",
    "start": "159180",
    "end": "166260"
  },
  {
    "text": "lots of irony there and when myself or my colleague see some of these things we sometimes give a little pen test a",
    "start": "166260",
    "end": "172980"
  },
  {
    "text": "chuckle but it's not really loud out loud funny when you appreciate that you know these products are widely",
    "start": "172980",
    "end": "180060"
  },
  {
    "text": "deployed and used by lots of companies and the companies that are using these products might not be aware so such",
    "start": "180060",
    "end": "186980"
  },
  {
    "text": "issues exist so what's my basic proposition",
    "start": "186980",
    "end": "192720"
  },
  {
    "text": "I think there's a Temptation for us even within the security Community to think of appliances as somehow hardened and",
    "start": "192720",
    "end": "201120"
  },
  {
    "text": "secured that they've undergone comprehensive security testing and can be trusted",
    "start": "201120",
    "end": "207239"
  },
  {
    "text": "now personally based on some of the research I've done I've got my own definition of a security Appliance and",
    "start": "207239",
    "end": "213959"
  },
  {
    "text": "it's that's a poorly configured Linux system which is out of date with old packages and an insecure web account web",
    "start": "213959",
    "end": "221220"
  },
  {
    "text": "application and other applications as well",
    "start": "221220",
    "end": "226159"
  },
  {
    "text": "so what kinds of appliances am I going to be talking about today so I've looked",
    "start": "229260",
    "end": "234659"
  },
  {
    "text": "at various different types of appliances mainly security appliances some appliances which are not related to",
    "start": "234659",
    "end": "240599"
  },
  {
    "text": "security but the kind of thing that I tend to look at are things like email web filtering products firewalls",
    "start": "240599",
    "end": "247680"
  },
  {
    "text": "gateways utms remote access systems that kind of stuff but I've also looked at",
    "start": "247680",
    "end": "252840"
  },
  {
    "text": "some as I said non-security type appliances I'm going to show some examples today we're going to look at",
    "start": "252840",
    "end": "259500"
  },
  {
    "text": "the Symantec Trend and so fast email gateways uh Citrix note access Gateway",
    "start": "259500",
    "end": "267840"
  },
  {
    "text": "and maybe one other if we have a little bit of time at the end",
    "start": "267840",
    "end": "274320"
  },
  {
    "text": "so are these products trusted well if we look at the secure Computing magazine",
    "start": "274320",
    "end": "279740"
  },
  {
    "text": "2013 reader trust Awards lots of different categories in the",
    "start": "279740",
    "end": "287040"
  },
  {
    "text": "awards that secure Computing do but just looking at the email section as we're",
    "start": "287040",
    "end": "292080"
  },
  {
    "text": "going to look at some of those products today so I've looked at uh three of those",
    "start": "292080",
    "end": "297240"
  },
  {
    "text": "products and found serious issues in four of them and you might say well",
    "start": "297240",
    "end": "302759"
  },
  {
    "text": "how's that well when I looked at the McAfee product I looked at the Gateway product and when they fixed the issues",
    "start": "302759",
    "end": "309360"
  },
  {
    "text": "it also affected they had to fix the email product as well also when I looked at the Barracuda email Gateway found",
    "start": "309360",
    "end": "316979"
  },
  {
    "text": "some issues which affected their whole range of products so it's because some of these products",
    "start": "316979",
    "end": "322139"
  },
  {
    "text": "have common Frameworks across a whole product set when you find vulnerabilities in one product that can",
    "start": "322139",
    "end": "328440"
  },
  {
    "text": "affect multiple products from the same vendor",
    "start": "328440",
    "end": "334460"
  },
  {
    "text": "so how are they deployed well obviously some of these systems as",
    "start": "335400",
    "end": "342360"
  },
  {
    "text": "you you can appreciate are high value to an attacker such as the firewall email filtering",
    "start": "342360",
    "end": "348900"
  },
  {
    "text": "products and internal security applications as well",
    "start": "348900",
    "end": "354180"
  },
  {
    "text": "if you get these products compromised an attacker can potentially gain lots of",
    "start": "354180",
    "end": "359940"
  },
  {
    "text": "confidential information but where they sit within the network greatly affects how they can be attacked",
    "start": "359940",
    "end": "366479"
  },
  {
    "text": "one of the interesting things I found about some of the firewalls multi-function gateways systems which",
    "start": "366479",
    "end": "371820"
  },
  {
    "text": "sit at the perimeter is that by default a lot of them have the management",
    "start": "371820",
    "end": "377580"
  },
  {
    "text": "interface and sometimes SSH as well enabled on all network interfaces",
    "start": "377580",
    "end": "383280"
  },
  {
    "text": "so by default the web UI is exposed to the internet unless the administrator",
    "start": "383280",
    "end": "388380"
  },
  {
    "text": "has gone in and turned that off uh it's something we quite often come across as in pen test we'll find some",
    "start": "388380",
    "end": "394860"
  },
  {
    "text": "management interface for router or firewall exposed to the internet and definitely recommend customers to check",
    "start": "394860",
    "end": "401880"
  },
  {
    "text": "for that and turn it off also for things like email filters web",
    "start": "401880",
    "end": "409020"
  },
  {
    "text": "filters which sit in the DMZ these typically won't have the management interface",
    "start": "409020",
    "end": "415560"
  },
  {
    "text": "exposed to the internet unless the administrators made a mistake",
    "start": "415560",
    "end": "421020"
  },
  {
    "text": "because you should have some filtering there but if you you can Google dolby's devices and find uis",
    "start": "421020",
    "end": "428280"
  },
  {
    "text": "but even where the management interface is not exposed to the internet sometimes they have interfaces which are designed",
    "start": "428280",
    "end": "434520"
  },
  {
    "text": "to be exposed to the interfa internet such as SSL vpns user portals for spam",
    "start": "434520",
    "end": "441240"
  },
  {
    "text": "management so that users can go in and release messages that aren't spam kind of thing and also when the uis are",
    "start": "441240",
    "end": "450539"
  },
  {
    "text": "not exposed to the internet at all they can be attacked by reflective cross-site",
    "start": "450539",
    "end": "457080"
  },
  {
    "text": "scripting and cross-site request forgery by external attackers and I'll show some",
    "start": "457080",
    "end": "462419"
  },
  {
    "text": "examples of that so let's have a look at a first example",
    "start": "462419",
    "end": "469319"
  },
  {
    "text": "this is a product which came up for me in a pen test back in September",
    "start": "469319",
    "end": "474979"
  },
  {
    "text": "so this is so fast email Gateway and I didn't know this product was going",
    "start": "474979",
    "end": "480539"
  },
  {
    "text": "to come up in advance I was given a range of ips to look at and",
    "start": "480539",
    "end": "486720"
  },
  {
    "text": "scan it with their Map and find some interesting things so it's got I've got system which has got SSH on",
    "start": "486720",
    "end": "494160"
  },
  {
    "text": "Port 24 a little bit unusual it's usually port 22. the other unusual thing about SSH on this device was that it was",
    "start": "494160",
    "end": "501360"
  },
  {
    "text": "Private key authentication only uh so normally with appliances it tends",
    "start": "501360",
    "end": "507720"
  },
  {
    "text": "to be username and password and it's quite often default creds and it's quite",
    "start": "507720",
    "end": "513300"
  },
  {
    "text": "trivial sometimes to do Brute Force attacks and and if the administrator has chosen a weak password then you know",
    "start": "513300",
    "end": "519719"
  },
  {
    "text": "there's potential for compromise there I could see it's also got Port 25 open so so my kind of email filtering product",
    "start": "519719",
    "end": "526380"
  },
  {
    "text": "and then when I look at the uis I can see it's a sofas email Gateway and at",
    "start": "526380",
    "end": "532019"
  },
  {
    "text": "that point I turned to my colleague I kind of rubbed my hands I said this is going to be a fun test I'm going to",
    "start": "532019",
    "end": "537899"
  },
  {
    "text": "break into this product and then we'll probably find tomorrow day as well and here you know in me said well yeah",
    "start": "537899",
    "end": "544080"
  },
  {
    "text": "you carry on with that and I'll look at some of the other hosts on the network so let's have a look at this product",
    "start": "544080",
    "end": "549720"
  },
  {
    "text": "it's got two UI so I've mentioned some of these products have two uis so it's got a user portal which",
    "start": "549720",
    "end": "556560"
  },
  {
    "text": "typically these user portals authenticate against active directory using ldap and then it's got this",
    "start": "556560",
    "end": "562620"
  },
  {
    "text": "administrative UI so one of the things I mentioned last year is that some of these products are",
    "start": "562620",
    "end": "570000"
  },
  {
    "text": "really trivial to Brute Force I said it was true trivial to show but I want to show it here just so you can get",
    "start": "570000",
    "end": "575820"
  },
  {
    "text": "an idea of how easy it can be so here I'm just using burp Intruder to just a",
    "start": "575820",
    "end": "581040"
  },
  {
    "text": "Brute Force attack against the admin UI and I'll explain a little bit in a bit why it's so trivial",
    "start": "581040",
    "end": "587760"
  },
  {
    "text": "um so we're just looking for differences in responses here I've set up a verb to use maximum",
    "start": "587760",
    "end": "595500"
  },
  {
    "text": "threads 127 threads and it's quite a simple authentication here this one's just a Json request and",
    "start": "595500",
    "end": "603000"
  },
  {
    "text": "response this is just a post request and a little tip that I tend to do with",
    "start": "603000",
    "end": "609260"
  },
  {
    "text": "these attacks is I tend to strip down the post request just a little thing I tend to do strip",
    "start": "609260",
    "end": "615899"
  },
  {
    "text": "out any unnecessary headers and any unnecessary parameters just to cut down the amount of data that my Brute Force",
    "start": "615899",
    "end": "623459"
  },
  {
    "text": "tool has to process so I'm just going to kick off a quick uh",
    "start": "623459",
    "end": "629339"
  },
  {
    "text": "Brute Force attack here when I say Brute Force if you're doing Brute Force you're doing",
    "start": "629339",
    "end": "635519"
  },
  {
    "text": "it wrong I would say what I'm doing here is a focus password attack and in this example I've just set up a",
    "start": "635519",
    "end": "643740"
  },
  {
    "text": "list of 500 passwords I've got the right password in there so it's a little bit",
    "start": "643740",
    "end": "649019"
  },
  {
    "text": "contrived but you can see that's 500 passwords and that's gone through in under 20 seconds",
    "start": "649019",
    "end": "654180"
  },
  {
    "text": "so if you multiply that up you're basically talking about a hundred thousand an hour half a million a day",
    "start": "654180",
    "end": "659940"
  },
  {
    "text": "it depends how long I've got and how Keen I am to get into this product",
    "start": "659940",
    "end": "665160"
  },
  {
    "text": "uh but basically they found the right password and I can log in",
    "start": "665160",
    "end": "672380"
  },
  {
    "text": "so as I said it's trivial it's not an exploit I wouldn't categorize it as an",
    "start": "672420",
    "end": "677459"
  },
  {
    "text": "exploit but in a practical sense in this pen test I gained access to this product in about 30 minutes",
    "start": "677459",
    "end": "684360"
  },
  {
    "text": "just to give you an idea it's not always that easy but it's easy for multiple",
    "start": "684360",
    "end": "689640"
  },
  {
    "text": "reasons in these products you tend to have uh",
    "start": "689640",
    "end": "697320"
  },
  {
    "text": "default user account which often you can't change you've got a scalable platform so it's a",
    "start": "697320",
    "end": "703620"
  },
  {
    "text": "Linux system with a scalable web server such as Apache and Jinx or Tomcats or",
    "start": "703620",
    "end": "708899"
  },
  {
    "text": "handle lots of concurrent threads and it will be very responsive you tend to have no account lockout no Brute Force",
    "start": "708899",
    "end": "715680"
  },
  {
    "text": "protection and minimal password complexity so for example in this sofas",
    "start": "715680",
    "end": "720720"
  },
  {
    "text": "product it required four characters of complexity and it's the same in the",
    "start": "720720",
    "end": "725820"
  },
  {
    "text": "trend product that we're going to look at a little bit later on and it varies so some products it'll be eight and some",
    "start": "725820",
    "end": "731160"
  },
  {
    "text": "products none at all administrators are users same as anyone else and they'll choose passwords which",
    "start": "731160",
    "end": "737820"
  },
  {
    "text": "other administrators tend to choose so to give you an example on my laptop I've got a password list of 20 million",
    "start": "737820",
    "end": "744360"
  },
  {
    "text": "passwords which has come from you know various hacked Services over over the",
    "start": "744360",
    "end": "750540"
  },
  {
    "text": "years I tend to squirrel away password lists and kind of sort them by priority now in",
    "start": "750540",
    "end": "757260"
  },
  {
    "text": "this kind of test I wouldn't use the whole 20 million I might use it for a first pass for hashcracking but in an",
    "start": "757260",
    "end": "764040"
  },
  {
    "text": "online online attack I'll just head off maybe 50 000 or half a million",
    "start": "764040",
    "end": "769560"
  },
  {
    "text": "depending on how long I want to spend a few of these devices have login alerting if they do have login it tends",
    "start": "769560",
    "end": "776519"
  },
  {
    "text": "to be for SSH and if you do have alerts in it tends to be for the web UI but it's rare that administrators will get",
    "start": "776519",
    "end": "783240"
  },
  {
    "text": "notified of an attack is in progress so having gained access to this system",
    "start": "783240",
    "end": "789660"
  },
  {
    "text": "on the customer's site I could see the product had lots of issues crosstalk scripting recession hijacking easy cross",
    "start": "789660",
    "end": "797279"
  },
  {
    "text": "site request forgery Port cookie security poor password security so there was some plain text passwords in the",
    "start": "797279",
    "end": "803820"
  },
  {
    "text": "admin UI of end users if you chose not to authenticate against active directory",
    "start": "803820",
    "end": "810480"
  },
  {
    "text": "uh OS command injection and at that point I was like okay uh I'm probably",
    "start": "810480",
    "end": "816000"
  },
  {
    "text": "not going to do the OS command injection because I don't want to break my customers Live email Appliance so I kind",
    "start": "816000",
    "end": "822180"
  },
  {
    "text": "of took it offline I said to the customer uh Phantom oh day effectively with uh the Sophos product they're using",
    "start": "822180",
    "end": "829860"
  },
  {
    "text": "and I'll report that separately to Sophos and they were fine with that because they had plenty of their own issues to deal with",
    "start": "829860",
    "end": "836940"
  },
  {
    "text": "so when I've got an evaluation so just to give you a quick look uh this so I've",
    "start": "836940",
    "end": "842040"
  },
  {
    "text": "got an ESX system at home I run quite a few different virtual appliances",
    "start": "842040",
    "end": "847200"
  },
  {
    "text": "on do some of my development on so this is running spider in the site with burp",
    "start": "847200",
    "end": "853079"
  },
  {
    "text": "scanner running and how many of you do web app testing",
    "start": "853079",
    "end": "858480"
  },
  {
    "text": "any hands okay so if you do a web application that's online these days you don't tend to see so many red blobs so",
    "start": "858480",
    "end": "866459"
  },
  {
    "text": "quite a lot of cross-site scripting there 166 instances so some of those were",
    "start": "866459",
    "end": "871980"
  },
  {
    "text": "false positives and some were duplicates but the reason there's quite so many is",
    "start": "871980",
    "end": "877500"
  },
  {
    "text": "because there's some generic costs like scripting there but you can see also we've got uh trivial OS command",
    "start": "877500",
    "end": "883139"
  },
  {
    "text": "injection but picking up itself just with baptics and a ping delay",
    "start": "883139",
    "end": "888779"
  },
  {
    "text": "uh usually it's more difficult to find OS command injection than that but not",
    "start": "888779",
    "end": "895680"
  },
  {
    "text": "not so much more difficult so it's quite a lot of instances of issues here",
    "start": "895680",
    "end": "901680"
  },
  {
    "text": "but just to put this into context this is not really unusual because most of these issues are quite common uh in the",
    "start": "901680",
    "end": "908760"
  },
  {
    "text": "appliances that I've looked at so let's talk a little bit about command injection I'm particularly interested in",
    "start": "908760",
    "end": "915660"
  },
  {
    "text": "command injection because my end goal when I'm looking at these products is to",
    "start": "915660",
    "end": "920940"
  },
  {
    "text": "get a root shell and there's several reasons for that first that if you can do a root shell",
    "start": "920940",
    "end": "930180"
  },
  {
    "text": "via the web UI you can sometimes do that reflectively via internal users and administrators as an external attacker",
    "start": "930180",
    "end": "937620"
  },
  {
    "text": "using crossover Quest forgery and cross-out scripting so even when the external attacker can't",
    "start": "937620",
    "end": "944699"
  },
  {
    "text": "see the web UI you can still attack the product and get a shell outbound reverse",
    "start": "944699",
    "end": "950100"
  },
  {
    "text": "Shell by abusing those kind of functions the second thing is that administrators",
    "start": "950100",
    "end": "956519"
  },
  {
    "text": "don't have full control over these devices and by that I mean",
    "start": "956519",
    "end": "962820"
  },
  {
    "text": "their use of the device is restricted so if they use a device via the console or",
    "start": "962820",
    "end": "969600"
  },
  {
    "text": "they SSH into the device device they'll end up in a restricted shell where they've got some kind of menu system",
    "start": "969600",
    "end": "975959"
  },
  {
    "text": "which protects the Integrity of the product by owning enabling to do certain functions",
    "start": "975959",
    "end": "982980"
  },
  {
    "text": "and the same is true in the web UI so for example in anti-spam products the",
    "start": "982980",
    "end": "988800"
  },
  {
    "text": "administrator can see you can you can manage policy and he can see messages which have been blocked to spam or are",
    "start": "988800",
    "end": "996660"
  },
  {
    "text": "having problems being delivered or being processed you can't just sit his desk in his lunch and look at the CEO's email",
    "start": "996660",
    "end": "1005240"
  },
  {
    "text": "yeah there's confidentiality built into these products for good reason but if you've got a root shell on the",
    "start": "1005240",
    "end": "1011420"
  },
  {
    "text": "underlying operand system you can see all the traffic that's going through the box",
    "start": "1011420",
    "end": "1016579"
  },
  {
    "text": "third thing is obviously if we can root these boxes especially as an external attacker they can become a platform for",
    "start": "1016579",
    "end": "1023839"
  },
  {
    "text": "attacking the rest of the internal Network so let's have a look at a little bit of root shell so",
    "start": "1023839",
    "end": "1030620"
  },
  {
    "text": "the first one we're going to look at is a little bit unrealistic so imagine in this case the administrators left the web UI",
    "start": "1030620",
    "end": "1038079"
  },
  {
    "text": "accessible to the internet and SSH so we can access it directly and",
    "start": "1038079",
    "end": "1045140"
  },
  {
    "text": "in this product there was cross-site scripting with session hijacking session fixation and obviously you've got the",
    "start": "1045140",
    "end": "1051140"
  },
  {
    "text": "Brute Force there's a few different ways of gaining access to the web UI so let's just look at this command injection",
    "start": "1051140",
    "end": "1057860"
  },
  {
    "text": "point so here I'm using burp again",
    "start": "1057860",
    "end": "1062900"
  },
  {
    "text": "so I did a little bit of enumeration in a kind of black cat way with this product to try and enumerate the",
    "start": "1062900",
    "end": "1069500"
  },
  {
    "text": "operating system from within this Con injection point and one of the things I noticed was that the web",
    "start": "1069500",
    "end": "1077600"
  },
  {
    "text": "UI is running as a low privileged user but I could enumerate some of the",
    "start": "1077600",
    "end": "1083120"
  },
  {
    "text": "operating system and I could see that low privilege user had its own SSH private key",
    "start": "1083120",
    "end": "1088940"
  },
  {
    "text": "so I can copy that across to the web root download it and then log into the",
    "start": "1088940",
    "end": "1095000"
  },
  {
    "text": "box with that SSH private key and you see here I get a full bash shell yeah not a restricted shell and there are",
    "start": "1095000",
    "end": "1101840"
  },
  {
    "text": "usually various privests on these boxes so you can escalate to root but I thought well I'll try something done",
    "start": "1101840",
    "end": "1108020"
  },
  {
    "text": "I'll try and log in with that same SSH key as root and see what happens",
    "start": "1108020",
    "end": "1113059"
  },
  {
    "text": "it's always worth trying something down because here it lets me log in the same key as root so one of the easier",
    "start": "1113059",
    "end": "1118760"
  },
  {
    "text": "prevasks I've found so basically what I'm saying is that I did actually do an additional check to",
    "start": "1118760",
    "end": "1125600"
  },
  {
    "text": "make sure this sh key does get generated as part of the install and it does there's always a chance that you'll find",
    "start": "1125600",
    "end": "1131720"
  },
  {
    "text": "a key which is common to multiple appliances but it does get generated part of the install but it gets assigned",
    "start": "1131720",
    "end": "1137419"
  },
  {
    "text": "to multiple users and it's the same key so kind of easy to prevask there so there we've got a root shell that way",
    "start": "1137419",
    "end": "1144919"
  },
  {
    "text": "so let's have a look at a more realistic type of attack so here imagine our external attacker",
    "start": "1144919",
    "end": "1151760"
  },
  {
    "text": "hasn't got access to the web UI or SSH so first thing you need to do is",
    "start": "1151760",
    "end": "1156919"
  },
  {
    "text": "enumerate what product is in use and you can do that um Often by looking at things like a",
    "start": "1156919",
    "end": "1164000"
  },
  {
    "text": "user portal so if you find a user a Spam management user portal that'll have um the exact product version sometimes",
    "start": "1164000",
    "end": "1171320"
  },
  {
    "text": "unauthenticated but probably more commonly some of these",
    "start": "1171320",
    "end": "1176419"
  },
  {
    "text": "products every process every message they process they mark it with the product name an exact product version in",
    "start": "1176419",
    "end": "1182840"
  },
  {
    "text": "an X header so by sending emails to non-existent users and getting bounced",
    "start": "1182840",
    "end": "1187880"
  },
  {
    "text": "messages you can get the product version but you can also often get the internal IP address of the machine which are two",
    "start": "1187880",
    "end": "1195320"
  },
  {
    "text": "of the three things you need in order to do these kind of reflective attacks so the next thing we need to do is",
    "start": "1195320",
    "end": "1201080"
  },
  {
    "text": "obviously get our administrator to view the attacker's website where he's crafted an attack",
    "start": "1201080",
    "end": "1207080"
  },
  {
    "text": "and cross-site request forgery one of my favorite things because we're actually getting the administrator to do the",
    "start": "1207080",
    "end": "1212660"
  },
  {
    "text": "command injection for us and then we'll get our reverse shell going back out of the company on Port 25 because it's an",
    "start": "1212660",
    "end": "1220100"
  },
  {
    "text": "SMTP Appliance must be able to talk out on Port 25 so they can send email",
    "start": "1220100",
    "end": "1225679"
  },
  {
    "text": "so put together a proof of concept for this what I've basically done here is",
    "start": "1225679",
    "end": "1231260"
  },
  {
    "text": "taken that post request adverb I've wrapped it up in some HTML and I've also",
    "start": "1231260",
    "end": "1236660"
  },
  {
    "text": "put some prevask in here as well so that we end up getting a root shell there was various issues on this device but you",
    "start": "1236660",
    "end": "1243440"
  },
  {
    "text": "one of the things was you could um overwrite some World writable scripts",
    "start": "1243440",
    "end": "1248660"
  },
  {
    "text": "which was pseudo scripts so you could get command ejection as root",
    "start": "1248660",
    "end": "1253940"
  },
  {
    "text": "so set that up as a self-submitting form so a little bit of JavaScript there to",
    "start": "1253940",
    "end": "1259820"
  },
  {
    "text": "submit the form wrap that up in a hidden iframe so that the admin isn't going to",
    "start": "1259820",
    "end": "1265880"
  },
  {
    "text": "see any responses and then set up our netcat listener so we can catch the shell",
    "start": "1265880",
    "end": "1272620"
  },
  {
    "text": "and then this is our victim administrator this product has a very long session timeout so it gives you uh",
    "start": "1275480",
    "end": "1282200"
  },
  {
    "text": "quite a big window so if it closes a UI and then at some point later visits the",
    "start": "1282200",
    "end": "1287720"
  },
  {
    "text": "attacker's site uh we get our shell coming back in",
    "start": "1287720",
    "end": "1294559"
  },
  {
    "text": "and it's a root shell because of the privileged escalation that I put in line in the request",
    "start": "1294559",
    "end": "1302200"
  },
  {
    "text": "so we've got access to the underlying operating system there so what do you get on these systems on the underlying",
    "start": "1302240",
    "end": "1309020"
  },
  {
    "text": "operating system we tend to see old kernel old packages",
    "start": "1309020",
    "end": "1314080"
  },
  {
    "text": "unnecessary packages poor configurations insecure proprietary applications",
    "start": "1314080",
    "end": "1321580"
  },
  {
    "text": "um so I've talked to vendors at trade shows occasionally about their appliances and",
    "start": "1321620",
    "end": "1327559"
  },
  {
    "text": "one of the things that I tend to say so I say you know tell me a bit about your Appliance they tell me oh it's based on",
    "start": "1327559",
    "end": "1334760"
  },
  {
    "text": "hardened Linux I'd say I definitely disagree with that because I've not seen",
    "start": "1334760",
    "end": "1340159"
  },
  {
    "text": "any appliance which I would consider to be hard and Linux they very commonly have things like debuggers compilers",
    "start": "1340159",
    "end": "1347360"
  },
  {
    "text": "scripting languages which don't need to be there application managers such as Yaman app",
    "start": "1347360",
    "end": "1352580"
  },
  {
    "text": "get Network sniffers like TCP dump and other tools I've seen things like",
    "start": "1352580",
    "end": "1358039"
  },
  {
    "text": "nmap on a firewall where it's not functionality which is used by the web",
    "start": "1358039",
    "end": "1363500"
  },
  {
    "text": "UI or the restricted shell so why does it even need to be there",
    "start": "1363500",
    "end": "1369260"
  },
  {
    "text": "um I've not seen any SE Linux deployed in the security appliances I looked at I've",
    "start": "1369260",
    "end": "1375620"
  },
  {
    "text": "seen it once in a non-security appliance but low privileged users could do things",
    "start": "1375620",
    "end": "1382039"
  },
  {
    "text": "that root couldn't and you could prevask the root and root could turn it off so you could basically work around it and",
    "start": "1382039",
    "end": "1389600"
  },
  {
    "text": "you don't tend to get much in the way of Integrity checking on the underlying operating system",
    "start": "1389600",
    "end": "1396159"
  },
  {
    "text": "so that looks like a nice place for attacker to live nice cozy Shell let's move in other words just going to look",
    "start": "1396799",
    "end": "1403460"
  },
  {
    "text": "at some post exploitation and again looking at the sofa Supply so",
    "start": "1403460",
    "end": "1409520"
  },
  {
    "text": "not picking on so forth here because most of these things apply to you know pretty much any Appliance once you get",
    "start": "1409520",
    "end": "1416059"
  },
  {
    "text": "shell",
    "start": "1416059",
    "end": "1418360"
  },
  {
    "text": "so one of the things I thought might be fun to show is a little bit of command line Foo so basically",
    "start": "1421280",
    "end": "1429140"
  },
  {
    "text": "I've put together a command line one liner which so the appliance has already got TCB dump on it",
    "start": "1429140",
    "end": "1436640"
  },
  {
    "text": "um and we're going to run TCP dump on the appliance and exfiltrate",
    "start": "1436640",
    "end": "1442179"
  },
  {
    "text": "SMTP traffic back to the attackers machine and display it in Wireshark",
    "start": "1442179",
    "end": "1447200"
  },
  {
    "text": "which I thought was a nice one-liner it probably if you're a real attacker you wouldn't do it this way there'd be other",
    "start": "1447200",
    "end": "1452900"
  },
  {
    "text": "ways of getting the email off the box but I thought we might be nice to show it like this",
    "start": "1452900",
    "end": "1458780"
  },
  {
    "text": "so again a little bit contrived because at the same time as doing this I'm sending emails through so that you can",
    "start": "1458780",
    "end": "1464419"
  },
  {
    "text": "actually see something happening we're going to search through those emails for a bit of text",
    "start": "1464419",
    "end": "1470299"
  },
  {
    "text": "we've got some emails going through that and I was just going to search the packet bytes",
    "start": "1470299",
    "end": "1476120"
  },
  {
    "text": "for the word password again it's a little bit contrived because none of us obviously send passwords and email do we",
    "start": "1476120",
    "end": "1482900"
  },
  {
    "text": "anyway and then you can see we've got an email",
    "start": "1482900",
    "end": "1488299"
  },
  {
    "text": "from Sally to Bob basically about a password for a reader it's a little bit of contrived but you",
    "start": "1488299",
    "end": "1494720"
  },
  {
    "text": "get the idea that basically um that attacker with a shell can see more",
    "start": "1494720",
    "end": "1501620"
  },
  {
    "text": "than the normal admin cam because the admin wouldn't normally be able to access anyone's email that's going",
    "start": "1501620",
    "end": "1507440"
  },
  {
    "text": "through the box and this applies to other protocols as well so for example on this device",
    "start": "1507440",
    "end": "1513140"
  },
  {
    "text": "you've got a user portal which is um SSL so end users are authenticating",
    "start": "1513140",
    "end": "1521179"
  },
  {
    "text": "against that and their authentication is handled by active directory but you can sniff out traffic you can",
    "start": "1521179",
    "end": "1528440"
  },
  {
    "text": "easily extract the um the private key for the self-signed certificate",
    "start": "1528440",
    "end": "1533960"
  },
  {
    "text": "decrypt the traffic actually sounds more complicated than it is really easy to do it in Wireshark and then you can get",
    "start": "1533960",
    "end": "1539659"
  },
  {
    "text": "plain text passwords of internal users which is obviously handy",
    "start": "1539659",
    "end": "1545240"
  },
  {
    "text": "let's have a look at something a little bit more black hat um oops",
    "start": "1545240",
    "end": "1551380"
  },
  {
    "text": "so this is kind of modifying an appliance now because we've got a root shell obviously we've got full control",
    "start": "1553520",
    "end": "1558799"
  },
  {
    "text": "over the device but uh certain things which makes it much easier to do things too this device",
    "start": "1558799",
    "end": "1565940"
  },
  {
    "text": "is actually not Linux it's FreeBSD but it's got the package ad package manager",
    "start": "1565940",
    "end": "1571159"
  },
  {
    "text": "installed uh so being root basic music could do what you want to it but having a package manager on there already as",
    "start": "1571159",
    "end": "1578480"
  },
  {
    "text": "you know if you do a lot of Linux stuff just makes life so much easier so I'm just going to install M map from a",
    "start": "1578480",
    "end": "1583940"
  },
  {
    "text": "public repository here and then start using that to enumerate the internal Network",
    "start": "1583940",
    "end": "1590179"
  },
  {
    "text": "now obviously you could do other things with this you could turn it into development environment add in other tools on there to kind of play play",
    "start": "1590179",
    "end": "1597860"
  },
  {
    "text": "about with the device and find other vulnerabilities in the device",
    "start": "1597860",
    "end": "1602860"
  },
  {
    "text": "but yeah just running mmap as an example so you could use it as a base for",
    "start": "1604580",
    "end": "1609860"
  },
  {
    "text": "attacking enumerating the rest of the internal Network effectively",
    "start": "1609860",
    "end": "1615820"
  },
  {
    "text": "so report this just so fast back in October",
    "start": "1624440",
    "end": "1630860"
  },
  {
    "text": "Defender was good good to work with easy to work with responsive and helpful they",
    "start": "1630860",
    "end": "1636020"
  },
  {
    "text": "fixed this in um January and I think they've just pushed up some",
    "start": "1636020",
    "end": "1641779"
  },
  {
    "text": "additional information yesterday which described what the vulnerabilities were that they fixed so that's all good",
    "start": "1641779",
    "end": "1650380"
  },
  {
    "text": "the ironic thing is that you know most of the security appliances I've looked at have these kinds of issues this is a",
    "start": "1651320",
    "end": "1659120"
  },
  {
    "text": "fairly typical situation um",
    "start": "1659120",
    "end": "1664720"
  },
  {
    "text": "so let's talk a little bit about commonalities initially when I was putting together",
    "start": "1664880",
    "end": "1670400"
  },
  {
    "text": "these slides I thought well maybe I could do some statistics on uh vulnerabilities that I'm finding",
    "start": "1670400",
    "end": "1676880"
  },
  {
    "text": "but thinking about that more deeply I don't think it's actually that helpful because",
    "start": "1676880",
    "end": "1683539"
  },
  {
    "text": "I'm cherry picking I'm not reporting everything I find so",
    "start": "1683539",
    "end": "1688760"
  },
  {
    "text": "I'm not reporting things like um uh issues with weak SSL that kind of",
    "start": "1688760",
    "end": "1695659"
  },
  {
    "text": "stuff or best practice issues low priority issues so for example a lot of",
    "start": "1695659",
    "end": "1701120"
  },
  {
    "text": "these devices have self-site certificates which are common to all installs they support sslv2 they have",
    "start": "1701120",
    "end": "1708799"
  },
  {
    "text": "weak ciphers that kind of stuff so if we were doing a full product assessment maybe a lot of additional issues I could",
    "start": "1708799",
    "end": "1714679"
  },
  {
    "text": "raise I don't really care about any of that in my personal research because all I'm trying to find is",
    "start": "1714679",
    "end": "1721700"
  },
  {
    "text": "something which is going to gain me access to the web UI as the admin or get me a Shell on the box or things",
    "start": "1721700",
    "end": "1728779"
  },
  {
    "text": "which can help me to get to that point such as in being able to enumerate the exact version of product in use as an",
    "start": "1728779",
    "end": "1734960"
  },
  {
    "text": "external attacker so I've kind of split this up into categories in terms of that those goals",
    "start": "1734960",
    "end": "1742400"
  },
  {
    "text": "so the most common things that I've seen which is applies to most appliances",
    "start": "1742400",
    "end": "1747740"
  },
  {
    "text": "is easy password attacks almost all devices I looked at had cross-site scripting recession hijacking",
    "start": "1747740",
    "end": "1754820"
  },
  {
    "text": "which gets a bit boring after you've seen it 10 times but um",
    "start": "1754820",
    "end": "1760279"
  },
  {
    "text": "why is it there in a security product and sometimes with cross-site scripting",
    "start": "1760279",
    "end": "1765559"
  },
  {
    "text": "you can do password theft which is even better than session hijacking because if you've got uh cross-site scripting and",
    "start": "1765559",
    "end": "1771860"
  },
  {
    "text": "password auto complete enabled in the same UI you can steal the credentials at",
    "start": "1771860",
    "end": "1778039"
  },
  {
    "text": "the administrator's browser uh non-hardened Linux already talked about",
    "start": "1778039",
    "end": "1783799"
  },
  {
    "text": "information disclosure already talked about the majority of appliances also had cross-site request forgery of",
    "start": "1783799",
    "end": "1789860"
  },
  {
    "text": "administrative functions so by getting an administrator to click on a crafted link you could get them to add a",
    "start": "1789860",
    "end": "1796100"
  },
  {
    "text": "backdoor administrator or arbitrarily reconfigure the product in other ways OS",
    "start": "1796100",
    "end": "1801559"
  },
  {
    "text": "command injection and privilege escalation either within the web UI sometimes you have multiple",
    "start": "1801559",
    "end": "1807200"
  },
  {
    "text": "roles in the web UI but more predominantly on the underlying operating system when you're going from",
    "start": "1807200",
    "end": "1813020"
  },
  {
    "text": "a low priv shell to a high-priv shell",
    "start": "1813020",
    "end": "1817179"
  },
  {
    "text": "several other products I looked at had stored Advanced cross-site scripting I think is a quite an interesting attack",
    "start": "1818200",
    "end": "1826039"
  },
  {
    "text": "vector and we'll look at a couple of those a bit later director authentication bypass found a",
    "start": "1826039",
    "end": "1832039"
  },
  {
    "text": "few times denialis service so for example in",
    "start": "1832039",
    "end": "1837620"
  },
  {
    "text": "um during 2012 I looked at some of the Barracuda appliances and realized that",
    "start": "1837620",
    "end": "1843559"
  },
  {
    "text": "they were vulnerable to the to August 2011 Apache bike range dos issue which",
    "start": "1843559",
    "end": "1849799"
  },
  {
    "text": "is a attack against Apaches and known vulnerability",
    "start": "1849799",
    "end": "1855020"
  },
  {
    "text": "um but it's quite a powerful attack because it doesn't just affect the web UI it's",
    "start": "1855020",
    "end": "1861860"
  },
  {
    "text": "very CPU intensive so it basically freezes the whole box so it's dos but it'd be very annoying",
    "start": "1861860",
    "end": "1869120"
  },
  {
    "text": "because you'd have to have the administrator go and turn off the box and turn it back on to get it back up and depending on what the box does if",
    "start": "1869120",
    "end": "1874700"
  },
  {
    "text": "it's an email processing Appliance or some kind of firewall that could affect whole network as opposed to just a",
    "start": "1874700",
    "end": "1880580"
  },
  {
    "text": "single system SSH misconfiguration and found a few times and wide variety of more obscure",
    "start": "1880580",
    "end": "1888980"
  },
  {
    "text": "issues like session fixation and session token prediction that kind of stuff",
    "start": "1888980",
    "end": "1895640"
  },
  {
    "text": "it tends to be a Watts top 10 type stuff and other misconfiguration issues",
    "start": "1895640",
    "end": "1902720"
  },
  {
    "text": "so let's have a look at another product so this is a product that several of us looked at NCC one of my colleagues found",
    "start": "1902720",
    "end": "1910899"
  },
  {
    "text": "a breakout that restricted shelves who could execute commands as root another one found uh command injection is Root",
    "start": "1910899",
    "end": "1918740"
  },
  {
    "text": "in the web UI and I find this other issue but sometimes as I said when we find these uis in an external pen test",
    "start": "1918740",
    "end": "1925940"
  },
  {
    "text": "we say okay that's a Gateway wouldn't it be nice if I could just go through that Gateway and then I could turn my mother",
    "start": "1925940",
    "end": "1933500"
  },
  {
    "text": "dull external pen test into a more interesting internal pen test sometimes",
    "start": "1933500",
    "end": "1940240"
  },
  {
    "text": "you can walk around the Gateway because there's no fence which is kind of appropriate in this",
    "start": "1940240",
    "end": "1945500"
  },
  {
    "text": "case this was a bit of an odd one so I want to explain how I what I thought as I was",
    "start": "1945500",
    "end": "1951500"
  },
  {
    "text": "looking at this only in the end I only spent about half a day looking at this product",
    "start": "1951500",
    "end": "1956600"
  },
  {
    "text": "um and so one of the first things I like to do on these products is I look at",
    "start": "1956600",
    "end": "1962059"
  },
  {
    "text": "virtual appliances so I'll Mount the disk on another operating system so I can have a poke about on the underlying",
    "start": "1962059",
    "end": "1968240"
  },
  {
    "text": "operating system and I also want to get a shell on there so I'll try and SSH on now on this",
    "start": "1968240",
    "end": "1973820"
  },
  {
    "text": "product SSH is not enabled by default so I know your SSH and SSH on and then",
    "start": "1973820",
    "end": "1979880"
  },
  {
    "text": "I log in but when I'm logging in I'm SSH him with",
    "start": "1979880",
    "end": "1984980"
  },
  {
    "text": "my username and then it's asking me again for my username so I'm like well what's this this is not SSH",
    "start": "1984980",
    "end": "1991640"
  },
  {
    "text": "and then when I start poking about on the OS I look at the shadow file I'm looking for the password hashes to crack",
    "start": "1991640",
    "end": "1997760"
  },
  {
    "text": "because sometimes there are default creds on these boxes for hidden accounts and you know for example in the symante",
    "start": "1997760",
    "end": "2006039"
  },
  {
    "text": "product we're going to look at a little bit later in 2012 I found a undocumented user",
    "start": "2006039",
    "end": "2012700"
  },
  {
    "text": "account of support with a password of Symantec SSH was enabled by default and",
    "start": "2012700",
    "end": "2018039"
  },
  {
    "text": "you've got full bash shell and there's prevask on the underlying operand system that wasn't a deliberate",
    "start": "2018039",
    "end": "2025000"
  },
  {
    "text": "backdoor obviously it was a mistake and when I reported to them they fixed it and in fact when I looked at previous",
    "start": "2025000",
    "end": "2030880"
  },
  {
    "text": "versions of that product that wasn't there so it's something that had been introduced it's always worth looking for that sort of thing but what I see here",
    "start": "2030880",
    "end": "2037539"
  },
  {
    "text": "is where where's my password hashes I'm going to try and crack and then I realized well what this",
    "start": "2037539",
    "end": "2042640"
  },
  {
    "text": "What's Happening Here is two different authentications you've got SSH for admin and no password and then you've got a",
    "start": "2042640",
    "end": "2049480"
  },
  {
    "text": "restricted shell where you put in the admin and password that you chose during the install wizard",
    "start": "2049480",
    "end": "2055898"
  },
  {
    "text": "but it's let me SSH to the box for admin and no password and that SSH is more",
    "start": "2055899",
    "end": "2062260"
  },
  {
    "text": "than just about shell because you do other things you do port forwarding poking about on the internals of the",
    "start": "2062260",
    "end": "2067720"
  },
  {
    "text": "clients I find that there's uh several internal ports one of which is an",
    "start": "2067720",
    "end": "2073540"
  },
  {
    "text": "unauthenticated version of the web UI so for the price of admin and no password you can tunnel that out and you get full",
    "start": "2073540",
    "end": "2080560"
  },
  {
    "text": "administrative control over the device so isn't it just to show you that this is a normal",
    "start": "2080560",
    "end": "2086740"
  },
  {
    "text": "admin UI so it's https and you've got a login I've had to obfuscate this because",
    "start": "2086740",
    "end": "2093280"
  },
  {
    "text": "it's quite a recent vulnerability but basically you've tunnel this port out",
    "start": "2093280",
    "end": "2098740"
  },
  {
    "text": "you don't need to log into this restricted shell and then you just go to this URL on your local host and then bam you've got uh",
    "start": "2098740",
    "end": "2106480"
  },
  {
    "text": "access to the admin UI as I said one of my colleagues found uh command injection is Root in this UI so we know we could",
    "start": "2106480",
    "end": "2112900"
  },
  {
    "text": "get a root shell on the box but more interestingly than that you can do other things so",
    "start": "2112900",
    "end": "2119740"
  },
  {
    "text": "SSH was not enabled by default and in order to do this type of attack you'd",
    "start": "2119740",
    "end": "2124780"
  },
  {
    "text": "have to have SSH exposed to the internet so caveats with this but if those two things are true",
    "start": "2124780",
    "end": "2131140"
  },
  {
    "text": "then as an external attacker you could scan the internal Network and then turn out tunnel out arbitrary ports and",
    "start": "2131140",
    "end": "2137980"
  },
  {
    "text": "services from the internal systems and then attack them directly as if they're on the internet",
    "start": "2137980",
    "end": "2144040"
  },
  {
    "text": "so little quick example of that so",
    "start": "2144040",
    "end": "2150160"
  },
  {
    "text": "in this example I've set up a vulnerable window system which is vulnerable to ms0867 which is",
    "start": "2150160",
    "end": "2157900"
  },
  {
    "text": "like if you've done any pen testing you'll be really really familiar with quite an old exploit now but we still",
    "start": "2157900",
    "end": "2163839"
  },
  {
    "text": "find it as part of pen tests and that's basically on an internal non-rootable Network so of my 192 network is acting",
    "start": "2163839",
    "end": "2171760"
  },
  {
    "text": "as my external network and I've got a 10 Network which has got this internal vulnerable system",
    "start": "2171760",
    "end": "2177640"
  },
  {
    "text": "and I've set up Metasploit to attack my local host on the ports that I've tunneled out",
    "start": "2177640",
    "end": "2185099"
  },
  {
    "text": "there you can see the ports I've tunneled out from the internal system on the non-rootable network",
    "start": "2185800",
    "end": "2192760"
  },
  {
    "text": "and then just attack that so the vulnerability I'm using here is",
    "start": "2192760",
    "end": "2197800"
  },
  {
    "text": "not really that relevant because as we all know networks tend to be crispy on",
    "start": "2197800",
    "end": "2202960"
  },
  {
    "text": "the outside and soft in the middle there tend to be lots of vulnerabilities on internal networks due to patch",
    "start": "2202960",
    "end": "2209440"
  },
  {
    "text": "management issues configuration management that kind of stuff but there we've got basically a root shell via the",
    "start": "2209440",
    "end": "2216700"
  },
  {
    "text": "Citrix access Gateway so that's rather ironic isn't it you've we've got a secure remote access Gateway",
    "start": "2216700",
    "end": "2223960"
  },
  {
    "text": "that potentially can give external attackers remote access to the internal Network",
    "start": "2223960",
    "end": "2230380"
  },
  {
    "text": "and a North bypass and root shell in its web UI so this was a really recent one this was",
    "start": "2230380",
    "end": "2237940"
  },
  {
    "text": "uh fixed last week um there is a cve I don't think there's",
    "start": "2237940",
    "end": "2244780"
  },
  {
    "text": "anything actually in it yet so it's quite quite fresh that one",
    "start": "2244780",
    "end": "2250000"
  },
  {
    "text": "there's some more details on the Citrix website there",
    "start": "2250000",
    "end": "2254820"
  },
  {
    "text": "so let's talk a little bit more about combination attacks because I think this is if there is anything Innovative this",
    "start": "2255040",
    "end": "2260440"
  },
  {
    "text": "is combining a tax is where where it is in these vulnerabilities",
    "start": "2260440",
    "end": "2266579"
  },
  {
    "text": "so last year I talked about a vulnerability that I found in proof",
    "start": "2266740",
    "end": "2272560"
  },
  {
    "text": "points product which is an email filtering product and basically just summarize",
    "start": "2272560",
    "end": "2278859"
  },
  {
    "text": "uh you could as an external attacker you could send in an email which has got spam in",
    "start": "2278859",
    "end": "2284980"
  },
  {
    "text": "the body of the message and some JavaScript in the subject line to deliberately get the message uh",
    "start": "2284980",
    "end": "2292420"
  },
  {
    "text": "quarantined spam when the administrator or the end user check the quarantine",
    "start": "2292420",
    "end": "2297460"
  },
  {
    "text": "area just a list of quarantine messages the attackers JavaScript would execute and you could then do on-site request",
    "start": "2297460",
    "end": "2304000"
  },
  {
    "text": "forgery to arbitrarily reconfigure the product so in other words you could own the",
    "start": "2304000",
    "end": "2309460"
  },
  {
    "text": "product with a malicious email and it's an email filtering product now I thought that would be kind of rare",
    "start": "2309460",
    "end": "2316359"
  },
  {
    "text": "they've actually found it in other products since I found some outband cross-site",
    "start": "2316359",
    "end": "2322359"
  },
  {
    "text": "scripting in a firewall product as well where you could put some JavaScript in the",
    "start": "2322359",
    "end": "2327820"
  },
  {
    "text": "username of an SSH authentication attempt that would go into the security log and the security log was rendered in the",
    "start": "2327820",
    "end": "2335020"
  },
  {
    "text": "web UI when the Security administrator of the firewall checked the security log in the",
    "start": "2335020",
    "end": "2340599"
  },
  {
    "text": "web UI you could get a root shell basically so uh kind of ironic you might",
    "start": "2340599",
    "end": "2347140"
  },
  {
    "text": "say that well security administrators don't check their security logs but I'm sure you can social engineer that in",
    "start": "2347140",
    "end": "2352900"
  },
  {
    "text": "some way um so I think particularly email out of band cross-site scripting is very",
    "start": "2352900",
    "end": "2359140"
  },
  {
    "text": "exploitable because of the ease of distribution and the way you can chain",
    "start": "2359140",
    "end": "2364660"
  },
  {
    "text": "it together with other attacks so you can spam these emails out with a Spam tool",
    "start": "2364660",
    "end": "2370180"
  },
  {
    "text": "the cross-site scripting because it appears in the web UI with the rest of the web UI functionality",
    "start": "2370180",
    "end": "2376540"
  },
  {
    "text": "it can't be detected by the administrator's browser because and he's also just there doing his day job so you",
    "start": "2376540",
    "end": "2382420"
  },
  {
    "text": "don't have to social engineer him to get the attack payload to work he's just you know reviewing the quarantine error or",
    "start": "2382420",
    "end": "2388240"
  },
  {
    "text": "whatever interesting vulnerability that I found that we're going to see combined with",
    "start": "2388240",
    "end": "2394660"
  },
  {
    "text": "that is back at faulty backup and restore functions so to describe this in brief",
    "start": "2394660",
    "end": "2402820"
  },
  {
    "text": "so several of these products have backup and restore functions either for policy",
    "start": "2402820",
    "end": "2408180"
  },
  {
    "text": "or for message areas or sometimes I've seen this issue in things like um",
    "start": "2408180",
    "end": "2414520"
  },
  {
    "text": "patch management features or licensing features where basically",
    "start": "2414520",
    "end": "2420280"
  },
  {
    "text": "the when you do a backup it creates a targy zip of a directory",
    "start": "2420280",
    "end": "2426160"
  },
  {
    "text": "structure on the OS and when you do a restore it basically restores that from the top of the file",
    "start": "2426160",
    "end": "2432940"
  },
  {
    "text": "system as root without any Integrity checking or with",
    "start": "2432940",
    "end": "2438220"
  },
  {
    "text": "very minimal Integrity checking so by taking a backup adding some files you can overwrite or add arbitrary files to",
    "start": "2438220",
    "end": "2445839"
  },
  {
    "text": "the underlying operating system now when I reported this to vendors some of them decided not to fix it",
    "start": "2445839",
    "end": "2452680"
  },
  {
    "text": "because they assumed that by fixing the other issues such as cross-site scripting or authentication",
    "start": "2452680",
    "end": "2460660"
  },
  {
    "text": "Bypass or any issues which gave the attacker access to the web UI at that point now it's only valid",
    "start": "2460660",
    "end": "2467920"
  },
  {
    "text": "administrators that can gain access to web UI so this doesn't matter well I said well no I think this still",
    "start": "2467920",
    "end": "2473740"
  },
  {
    "text": "matters because this can be abused by cross-site request forgery and if there's anything",
    "start": "2473740",
    "end": "2480220"
  },
  {
    "text": "Innovative in this presentation maybe this is it so let me just show you this",
    "start": "2480220",
    "end": "2486460"
  },
  {
    "text": "so the way that um the file upload features tend to work is",
    "start": "2486460",
    "end": "2493359"
  },
  {
    "text": "typically it's a multi-part mine post message",
    "start": "2493359",
    "end": "2500619"
  },
  {
    "text": "so what you need to do really is kind of spoof these messages",
    "start": "2500619",
    "end": "2508060"
  },
  {
    "text": "so here we've got a structure of a the actual file up node message and it tends to be multiple requests that need to be",
    "start": "2508060",
    "end": "2513940"
  },
  {
    "text": "made in order to abuse this I put together some JavaScript here which basically is going to make a couple of requests in",
    "start": "2513940",
    "end": "2520119"
  },
  {
    "text": "this in this particular product um and it's using XML HTTP request",
    "start": "2520119",
    "end": "2528160"
  },
  {
    "text": "so there you can see the the requests and there's some more detail on this on the white paper but you need to make two requests",
    "start": "2528160",
    "end": "2534940"
  },
  {
    "text": "typically you want to upload the file and then a second to click OK and sometimes you need to set that up in in",
    "start": "2534940",
    "end": "2540820"
  },
  {
    "text": "advance here we've basically got the blob of the data in JavaScript which is going to be",
    "start": "2540820",
    "end": "2546700"
  },
  {
    "text": "the file upload and in most of the cases I looked at that could be completely crafted in advance without anything from",
    "start": "2546700",
    "end": "2553900"
  },
  {
    "text": "that particular Appliance in other words it didn't need to be a valid config they needed to be a valid",
    "start": "2553900",
    "end": "2559839"
  },
  {
    "text": "um backup to restore just the attacking files and perhaps an index file",
    "start": "2559839",
    "end": "2565420"
  },
  {
    "text": "so this product is actually open filer which is not a security product but as I put this video together already",
    "start": "2565420",
    "end": "2571359"
  },
  {
    "text": "um I thought I'd show this and we'll look it in a security product in a bit but basically here's the web UI with the",
    "start": "2571359",
    "end": "2578740"
  },
  {
    "text": "administrator logged into it this product happened to have very poor session management because the way it",
    "start": "2578740",
    "end": "2584140"
  },
  {
    "text": "did it was set the session tokens as the username and password so it never actually had session timeout",
    "start": "2584140",
    "end": "2591420"
  },
  {
    "text": "uh so you've got a big window of opportunity but when the victim administrator views the attacker's",
    "start": "2591420",
    "end": "2597640"
  },
  {
    "text": "website then we get this reverse shell coming back in and it's a root shell because it's a",
    "start": "2597640",
    "end": "2603339"
  },
  {
    "text": "high privilege function the only way you can see actually what's going on is if you use an intercepting proxy so here we",
    "start": "2603339",
    "end": "2609040"
  },
  {
    "text": "can see the blob of data that's actually the file upload in that first request and then the second request is saying",
    "start": "2609040",
    "end": "2614560"
  },
  {
    "text": "confirm equals yes to click the button and then if we look at the responses we",
    "start": "2614560",
    "end": "2620380"
  },
  {
    "text": "can see are you sure you would like to restore the configuration archive and in the second response it'll say",
    "start": "2620380",
    "end": "2626560"
  },
  {
    "text": "file successfully uploaded but obviously the administrator wouldn't see this and so you can only see this with an",
    "start": "2626560",
    "end": "2632079"
  },
  {
    "text": "intercepting proxy so that's basically how that type of attack works so",
    "start": "2632079",
    "end": "2639520"
  },
  {
    "text": "you get the administrator to view the attacker's website he does this spoof",
    "start": "2639520",
    "end": "2645220"
  },
  {
    "text": "file upload and click Supply and then you get a shell going back out to the",
    "start": "2645220",
    "end": "2650319"
  },
  {
    "text": "attacker system so let's have a look at that those two things combined in a security product so",
    "start": "2650319",
    "end": "2656440"
  },
  {
    "text": "we're going to look at the Symantec email Gateway Appliance now I spent about three days looking at",
    "start": "2656440",
    "end": "2664660"
  },
  {
    "text": "this product and another three days looking at the next product we're going to look at",
    "start": "2664660",
    "end": "2670140"
  },
  {
    "text": "so to give you an idea the is quite quick to find some of these issues",
    "start": "2670140",
    "end": "2676240"
  },
  {
    "text": "um so I'm not doing full product assessment I'm just as I said cherry picking looking for the",
    "start": "2676240",
    "end": "2682780"
  },
  {
    "text": "the most serious issues that I can find in the shortest space of time effectively to do a full product assessment of these types of products",
    "start": "2682780",
    "end": "2689920"
  },
  {
    "text": "you're probably talking about a small team of pen testers for a couple of weeks at least but you can see I found in this product",
    "start": "2689920",
    "end": "2696700"
  },
  {
    "text": "at a band cross-site scripting and then you've got cross-site request for Audrey and",
    "start": "2696700",
    "end": "2702520"
  },
  {
    "text": "the SSH issue I talked about already but you've got the ability for authenticated attacker to modify the web application",
    "start": "2702520",
    "end": "2709060"
  },
  {
    "text": "and that was as root yeah so by combining these issues together",
    "start": "2709060",
    "end": "2714520"
  },
  {
    "text": "you can do cross-site scripting in an email subject line to as the initial",
    "start": "2714520",
    "end": "2719560"
  },
  {
    "text": "launch of the attack and then use the faulty backup and restore feature via",
    "start": "2719560",
    "end": "2724720"
  },
  {
    "text": "on-site request forgery to add some arbitrary function a new function to the",
    "start": "2724720",
    "end": "2730839"
  },
  {
    "text": "web UI and a sewage binary and then use the cross-site scripting to run that new",
    "start": "2730839",
    "end": "2736660"
  },
  {
    "text": "function which runs a sewage binary which sends a shell back out to the attacker",
    "start": "2736660",
    "end": "2742180"
  },
  {
    "text": "so quick video of that so here I'm basically sending an email from the command line",
    "start": "2742180",
    "end": "2748800"
  },
  {
    "text": "it's basically got some JavaScript in the subject line which is pulling in some additional JavaScript from the",
    "start": "2748800",
    "end": "2754780"
  },
  {
    "text": "attacker system it's quite difficult with the length you get with the subject line to put anything in there which is",
    "start": "2754780",
    "end": "2760000"
  },
  {
    "text": "really malicious usually have to put in some additional stuff so here we're setting up the listener on Port 25 again so this is the",
    "start": "2760000",
    "end": "2767680"
  },
  {
    "text": "product quite a nice product he's quite easy to use the vulnerable function in this product was in the audit logs so",
    "start": "2767680",
    "end": "2775540"
  },
  {
    "text": "the messages didn't have to actually be quarantined they just had to have been processed",
    "start": "2775540",
    "end": "2781119"
  },
  {
    "text": "and if the attacker's email came up in the results of a search of the audit logs the attack payload is is running",
    "start": "2781119",
    "end": "2788619"
  },
  {
    "text": "now and I've put in a couple of pop-ups so that you can actually see something",
    "start": "2788619",
    "end": "2794200"
  },
  {
    "text": "happening so otherwise you wouldn't see anything as an administrator obviously to a pop-up happening shortly there we",
    "start": "2794200",
    "end": "2800140"
  },
  {
    "text": "go yeah you've been owned and if we look on the attacker system we should see a shell",
    "start": "2800140",
    "end": "2807040"
  },
  {
    "text": "come in so there we go",
    "start": "2807040",
    "end": "2812818"
  },
  {
    "text": "that's a root shell so that's a brief overview attacker",
    "start": "2813520",
    "end": "2820240"
  },
  {
    "text": "sends in a maliciously crafted email if the administrator checks his audit logs and that email",
    "start": "2820240",
    "end": "2825700"
  },
  {
    "text": "comes up in the logs he pulls in some additional JavaScript from the attacker system",
    "start": "2825700",
    "end": "2832420"
  },
  {
    "text": "does this spoofed file upload runs this new function that we've added",
    "start": "2832420",
    "end": "2838240"
  },
  {
    "text": "which then sends a reverse shell back out to the attacker system in Port 25.",
    "start": "2838240",
    "end": "2845319"
  },
  {
    "text": "so that's rather ironic as well we've got a root shell viral malicious email in an email filtering product",
    "start": "2845319",
    "end": "2853260"
  },
  {
    "text": "so obviously Symantec took this seriously and addressed the issues uh they've got a good solid process and",
    "start": "2855160",
    "end": "2862780"
  },
  {
    "text": "so I reported it this to them in April last year and they fixed it uh in August",
    "start": "2862780",
    "end": "2869200"
  },
  {
    "text": "the other good thing they do is quite put quite good information about the vulnerability on their website and put",
    "start": "2869200",
    "end": "2875380"
  },
  {
    "text": "ratings for uh you know how severe they think the issues are and publish cves for each of the issues that I reported",
    "start": "2875380",
    "end": "2883500"
  },
  {
    "text": "so have a look at Trend Micro there's a very similar product from a similar vendor",
    "start": "2884200",
    "end": "2890079"
  },
  {
    "text": "and similar issues really so we had our band cross-site scripting again this",
    "start": "2890079",
    "end": "2895300"
  },
  {
    "text": "time in the user portal um cross-site request forgery reflective",
    "start": "2895300",
    "end": "2902560"
  },
  {
    "text": "installed cross-site scripting and we've got this root shell via patch",
    "start": "2902560",
    "end": "2907960"
  },
  {
    "text": "upload feature it's again authenticated but we can combine that with the uh some of the",
    "start": "2907960",
    "end": "2913720"
  },
  {
    "text": "other attacks so just quickly we're going to look at",
    "start": "2913720",
    "end": "2919839"
  },
  {
    "text": "attack against end users because the cross-site scripting was a attack in the end user portal so",
    "start": "2919839",
    "end": "2926560"
  },
  {
    "text": "here's the product the annual support tools for users to go in and manage their spam so for spams in",
    "start": "2926560",
    "end": "2933160"
  },
  {
    "text": "incorrectly quarantined it's a real message they want to release they can go in and release the message",
    "start": "2933160",
    "end": "2938859"
  },
  {
    "text": "so here we log in this product also had password autocomplete",
    "start": "2938859",
    "end": "2944260"
  },
  {
    "text": "on in this UI so by using the cross-site script in this attack you could actually gain access to their password by using",
    "start": "2944260",
    "end": "2952060"
  },
  {
    "text": "the password autocomplete I just zoom in a bit on that you can see",
    "start": "2952060",
    "end": "2957160"
  },
  {
    "text": "that I've done a pop-up just to demonstrate the fact that the attackers JavaScript has access to the plain text",
    "start": "2957160",
    "end": "2963520"
  },
  {
    "text": "user password there and these type of attacks where you've got cross-site scripting and password auto complete",
    "start": "2963520",
    "end": "2970599"
  },
  {
    "text": "together work on latest browsers so here I'm using the latest version of Firefox",
    "start": "2970599",
    "end": "2975640"
  },
  {
    "text": "I tend to do most of my proof of Concepts on Firefox because most things just work like reflective cross-site",
    "start": "2975640",
    "end": "2982060"
  },
  {
    "text": "scripting kind of stuff but um talking to my colleagues these kind of attacks work on",
    "start": "2982060",
    "end": "2988560"
  },
  {
    "text": "IE10 and chrome 25 I think it is latest version so it's still relevant",
    "start": "2988560",
    "end": "2995859"
  },
  {
    "text": "so the solution to that is for the vendor to not enable password autocomplete",
    "start": "2995859",
    "end": "3002460"
  },
  {
    "text": "so the way that works attacker sends in uh or spams in some messages to the end",
    "start": "3002460",
    "end": "3009180"
  },
  {
    "text": "users kind of encouraging them to view that in within the UI of the product and",
    "start": "3009180",
    "end": "3015000"
  },
  {
    "text": "then the end users unbeknownst to them send out their passwords to the attacker so you can collect end user passwords on mass via",
    "start": "3015000",
    "end": "3022920"
  },
  {
    "text": "an email attack so this product also had as I said the",
    "start": "3022920",
    "end": "3028619"
  },
  {
    "text": "root shell via file upload issue in the administrative UI so a little bit more",
    "start": "3028619",
    "end": "3034680"
  },
  {
    "text": "of a stretch this one but if the administrator also receives spam you've",
    "start": "3034680",
    "end": "3041520"
  },
  {
    "text": "got two uis basically so you could do cross-site request forgery between the two uis",
    "start": "3041520",
    "end": "3047940"
  },
  {
    "text": "so if the administrator's logged in at the same time he's checking his user portal",
    "start": "3047940",
    "end": "3053280"
  },
  {
    "text": "you could launch an attack against the admin UI and then get a root shell",
    "start": "3053280",
    "end": "3059460"
  },
  {
    "text": "that way so a few more caveats with that one but you know it's still potential",
    "start": "3059460",
    "end": "3064980"
  },
  {
    "text": "there for that kind of attack so that kind of goes like that",
    "start": "3064980",
    "end": "3073339"
  },
  {
    "text": "so there's a bit of a difference here I've reported this to so these two",
    "start": "3073440",
    "end": "3078660"
  },
  {
    "text": "products are looked at the same week back in April",
    "start": "3078660",
    "end": "3084920"
  },
  {
    "text": "uh 2012. similar products from similar vendors",
    "start": "3084920",
    "end": "3090140"
  },
  {
    "text": "want to stress the issues another one hasn't um and we're almost a year",
    "start": "3090140",
    "end": "3096180"
  },
  {
    "text": "beyond that point now so I don't want to talk too much about this particular vendor but",
    "start": "3096180",
    "end": "3103400"
  },
  {
    "text": "there's quite a disparity between different vendors in terms of how they address these issues",
    "start": "3103400",
    "end": "3110000"
  },
  {
    "text": "and some some of the vendors I've dealt with have been very good so I'll talk more about those because I",
    "start": "3110000",
    "end": "3116520"
  },
  {
    "text": "think it's important for vendors to to copy the vendors that are doing this vulnerability mitigation process well",
    "start": "3116520",
    "end": "3124200"
  },
  {
    "text": "and once I've had good experiences Websense Symantec McAfee",
    "start": "3124200",
    "end": "3132260"
  },
  {
    "text": "Citrix and so forth were quite good as well the the typical fixed time tends to",
    "start": "3132260",
    "end": "3137700"
  },
  {
    "text": "be about four or five months that kind of thing so it's longer than I would like it to be",
    "start": "3137700",
    "end": "3143000"
  },
  {
    "text": "but generally speaking most vendors do address the issues and it's important to",
    "start": "3143000",
    "end": "3148859"
  },
  {
    "text": "be able to push out the information to the end customers as well but only a few vendors get that part right",
    "start": "3148859",
    "end": "3154920"
  },
  {
    "text": "um so it's kind of an area to focus on really so more recently I've been doing some",
    "start": "3154920",
    "end": "3160859"
  },
  {
    "text": "other bits of pieces of research poking about in some of the appliances a little bit deeper",
    "start": "3160859",
    "end": "3166520"
  },
  {
    "text": "looking at things like protections for memory corruption that kind of stuff so",
    "start": "3166520",
    "end": "3171839"
  },
  {
    "text": "here again looking at the trend Appliance uh a little bit difficult to see on that screen I've got a zoom in",
    "start": "3171839",
    "end": "3177780"
  },
  {
    "text": "there so here looking at the kernel protections and you can see that um some",
    "start": "3177780",
    "end": "3183059"
  },
  {
    "text": "of the useful things that could be there for mitigating memory corruption issues are disabled",
    "start": "3183059",
    "end": "3190140"
  },
  {
    "text": "uh looking at the combined binaries again you can see we're missing stack canaries and Pi which can help protect",
    "start": "3190140",
    "end": "3196980"
  },
  {
    "text": "for aslr and if you look at the functions themselves you can see they're",
    "start": "3196980",
    "end": "3202859"
  },
  {
    "text": "containing uh you know things like strikoppy Easter CAT scan F things that",
    "start": "3202859",
    "end": "3208140"
  },
  {
    "text": "Microsoft would term band functions because we know for many years there",
    "start": "3208140",
    "end": "3213420"
  },
  {
    "text": "have been lots of vulnerabilities which have been caused by you know these kinds of function use and",
    "start": "3213420",
    "end": "3220020"
  },
  {
    "text": "create use of these functions so what are the solutions well if I",
    "start": "3220020",
    "end": "3226140"
  },
  {
    "text": "stood up here and gave you a talk about what the solutions are you'd be pretty bored because we all know what the",
    "start": "3226140",
    "end": "3232200"
  },
  {
    "text": "solutions are regular software maintenance so a lot of these products are not having",
    "start": "3232200",
    "end": "3239300"
  },
  {
    "text": "regular maintenance of the underlying operating system so you've got vulnerable packages and you know old",
    "start": "3239300",
    "end": "3245280"
  },
  {
    "text": "kernels that kind of stuff uh secure development life cycle",
    "start": "3245280",
    "end": "3250440"
  },
  {
    "text": "especially the custom binaries and especially the web UI which we all know is a real area where lots of things can",
    "start": "3250440",
    "end": "3258420"
  },
  {
    "text": "go wrong product security testing kind of goes without saying penetration",
    "start": "3258420",
    "end": "3264359"
  },
  {
    "text": "testing can help pick up some of these things after the fact so we've got lots of appliances out",
    "start": "3264359",
    "end": "3270660"
  },
  {
    "text": "there which have got these vulnerabilities do we need to panic and freak out I say no we just need to keep calm and",
    "start": "3270660",
    "end": "3278640"
  },
  {
    "text": "carry on in other words you just need to do the things that we know we need to do",
    "start": "3278640",
    "end": "3283819"
  },
  {
    "text": "so my final conclusions well my conclusions are that you know",
    "start": "3284819",
    "end": "3289920"
  },
  {
    "text": "we've got a lot of vulnerable appliances out there I would say about 80 to 90 percent of the appliances I've looked at",
    "start": "3289920",
    "end": "3298140"
  },
  {
    "text": "I've got these kinds of issues um",
    "start": "3298140",
    "end": "3303660"
  },
  {
    "text": "so that's an interesting state to be in in you know 2012 2013 isn't it",
    "start": "3303660",
    "end": "3310880"
  },
  {
    "text": "um I talked a little about the variable responses from vendors so have some",
    "start": "3310980",
    "end": "3316020"
  },
  {
    "text": "vendors uh fix things quite quickly and communicate well and other vendors obviously needs to be some work in that",
    "start": "3316020",
    "end": "3322859"
  },
  {
    "text": "area I can't really differentiate products based on the vulnerabilities of their",
    "start": "3322859",
    "end": "3328079"
  },
  {
    "text": "because I said most of the products I looked at got these kinds of issues but I can only really differentiate",
    "start": "3328079",
    "end": "3333960"
  },
  {
    "text": "vendors based on whether they address the issues how quickly they do it and how they",
    "start": "3333960",
    "end": "3339059"
  },
  {
    "text": "communicate to their customer base and you know the person that's reporting the issues",
    "start": "3339059",
    "end": "3345180"
  },
  {
    "text": "the other thing I want to talk about is the evolution of products so over the last 10 years we've moved especially in",
    "start": "3345180",
    "end": "3352319"
  },
  {
    "text": "the solutions which are things like email filtering we've moved from software products where",
    "start": "3352319",
    "end": "3359700"
  },
  {
    "text": "originally the company that's deploying the product they would install an operating system and a database and",
    "start": "3359700",
    "end": "3366180"
  },
  {
    "text": "then they'd install the product on top of that and you can have all kinds of issues with the management of that software",
    "start": "3366180",
    "end": "3372660"
  },
  {
    "text": "because you know the end customers got to patch the operating system patch the database",
    "start": "3372660",
    "end": "3377940"
  },
  {
    "text": "and you've got interoperability issues and all that kind of stuff so we move towards more towards appliances",
    "start": "3377940",
    "end": "3385579"
  },
  {
    "text": "where the software vendor is providing the appliance it's all integrated it all",
    "start": "3385579",
    "end": "3390960"
  },
  {
    "text": "works nicely together and the management of the database and the",
    "start": "3390960",
    "end": "3396300"
  },
  {
    "text": "operating system is done by the vendor but what I'm seeing is that that maintenance is not happening",
    "start": "3396300",
    "end": "3403319"
  },
  {
    "text": "the other thing that happened when we moved from software products to the appliances is that if there were any exploits that become more reliable",
    "start": "3403319",
    "end": "3410460"
  },
  {
    "text": "because of the you know basically the appliances that are out there effectively clones because they've all",
    "start": "3410460",
    "end": "3415559"
  },
  {
    "text": "got exactly the same operating systems that the same database for that particular brand of appliance",
    "start": "3415559",
    "end": "3422160"
  },
  {
    "text": "well we've also moved from Hardware prices to Virtual appliances so lots of companies deploying virtual",
    "start": "3422160",
    "end": "3429720"
  },
  {
    "text": "environments they want the flexibility and all the good stuff that comes with that and so lots of these vendors are",
    "start": "3429720",
    "end": "3436079"
  },
  {
    "text": "deploying their Hardware clients and just basically taking that software is exact exactly the same piece of software",
    "start": "3436079",
    "end": "3441839"
  },
  {
    "text": "but deploying it in a virtual format now that makes it much easier for",
    "start": "3441839",
    "end": "3448140"
  },
  {
    "text": "attackers to evaluate the product as I do I basically go into the vendor's website download the product talk to",
    "start": "3448140",
    "end": "3454859"
  },
  {
    "text": "sales get an evaluation license and stick it on my ASX box and I can have a poke about with it",
    "start": "3454859",
    "end": "3460859"
  },
  {
    "text": "so it makes the evaluation process easier but it also makes the evaluation for attackers a bit easier",
    "start": "3460859",
    "end": "3467280"
  },
  {
    "text": "and the other thing I want to talk about is cloud services so more recently we're moving towards cloud services now some",
    "start": "3467280",
    "end": "3473579"
  },
  {
    "text": "vendors that provide these appliances also provide cloud services now in other",
    "start": "3473579",
    "end": "3479700"
  },
  {
    "text": "words a kind of managed service version of email filtering or whatever and sometimes those things are two",
    "start": "3479700",
    "end": "3485640"
  },
  {
    "text": "completely different things that different Technologies which have been perhaps acquired at different times from",
    "start": "3485640",
    "end": "3490859"
  },
  {
    "text": "different other vendors but sometimes they're the same thing so there in other words they're exactly the",
    "start": "3490859",
    "end": "3495900"
  },
  {
    "text": "same product perhaps wrapped up with some management infrastructure and sometimes where you've got third",
    "start": "3495900",
    "end": "3501960"
  },
  {
    "text": "parties providing these managed Services they're just effectively using the",
    "start": "3501960",
    "end": "3507240"
  },
  {
    "text": "off-the-self product I've run it as a virtual Appliance and then selling on that service to their customers",
    "start": "3507240",
    "end": "3514079"
  },
  {
    "text": "so what I'm basically saying is that some of these vulnerabilities apply to not",
    "start": "3514079",
    "end": "3519720"
  },
  {
    "text": "just the appliances the virtual prices but also to these cloud-based Services because it's effectively the same kind",
    "start": "3519720",
    "end": "3526380"
  },
  {
    "text": "of software final little thought about Huawei so",
    "start": "3526380",
    "end": "3531720"
  },
  {
    "text": "it was a bit Fuss last year about Huawei the implication being that Huawei had or",
    "start": "3531720",
    "end": "3540119"
  },
  {
    "text": "certain governments had infiltrated Huawei and that vulnerabilities have been deliberately",
    "start": "3540119",
    "end": "3546599"
  },
  {
    "text": "introduced that's call it that um now when I heard that I was a bit",
    "start": "3546599",
    "end": "3554040"
  },
  {
    "text": "bemused I mean that might be true I don't know but kind of I thought to",
    "start": "3554040",
    "end": "3559619"
  },
  {
    "text": "myself well why do you need to code in extra vulnerabilities surely if you you want to compromise these systems you",
    "start": "3559619",
    "end": "3566460"
  },
  {
    "text": "just look for the vulnerabilities are there and exploit those and when those get found and fixed by the vendor you",
    "start": "3566460",
    "end": "3573000"
  },
  {
    "text": "just look a bit harder and find some more I don't think you know any government",
    "start": "3573000",
    "end": "3578520"
  },
  {
    "text": "needs to try and add more and that's it so got a little bit of",
    "start": "3578520",
    "end": "3585480"
  },
  {
    "text": "time for questions or I can show you one other thing",
    "start": "3585480",
    "end": "3590599"
  },
  {
    "text": "any questions so I show you one of the one other thing",
    "start": "3590640",
    "end": "3597359"
  },
  {
    "text": "quickly this is a product that you might be familiar with it's quite widely used in the security Community PF sense",
    "start": "3597359",
    "end": "3605400"
  },
  {
    "text": "uh but it's not um secure by default so notice a couple of things here HTTP by default not https",
    "start": "3605400",
    "end": "3613079"
  },
  {
    "text": "and when you log in you've got the browser autocomplete pop-up and as the product also had cross-site scripting",
    "start": "3613079",
    "end": "3618839"
  },
  {
    "text": "you could uh use this password theft attack but here's something a bit crazy command",
    "start": "3618839",
    "end": "3625200"
  },
  {
    "text": "injection is not always that difficult to find because in this function which is in there by default which says use at",
    "start": "3625200",
    "end": "3631260"
  },
  {
    "text": "your own risk you've got root shell functionality in a web UI now to me",
    "start": "3631260",
    "end": "3636619"
  },
  {
    "text": "that's a bit crazy so you can you can execute commands as through download files as root upload files as root",
    "start": "3636619",
    "end": "3643260"
  },
  {
    "text": "execute PHP and in this other function uh you can basically edit files as root",
    "start": "3643260",
    "end": "3648599"
  },
  {
    "text": "now I use this product myself I play about with it but I would say you know these kinds of Open Source Products",
    "start": "3648599",
    "end": "3655079"
  },
  {
    "text": "might need a bit of customization before you deploy them live I would definitely because it's an open product and you can",
    "start": "3655079",
    "end": "3661799"
  },
  {
    "text": "reconfigure it and you can edit it in arbitrary ways I would definitely go in and you know strip out some of these",
    "start": "3661799",
    "end": "3666839"
  },
  {
    "text": "functions and change some of the defaults before you use it",
    "start": "3666839",
    "end": "3672559"
  },
  {
    "text": "any questions at all go ahead",
    "start": "3672599",
    "end": "3677880"
  },
  {
    "text": "you look at the mobile device type of security effects uh mobile devices",
    "start": "3677880",
    "end": "3686359"
  },
  {
    "text": "no um I'm trying to think what Andy we did look at some mobile device management",
    "start": "3689520",
    "end": "3694940"
  },
  {
    "text": "issues I don't know found these around yeah okay yes",
    "start": "3694940",
    "end": "3703500"
  },
  {
    "text": "um I would I would say non-security products are worse than security products",
    "start": "3704460",
    "end": "3710099"
  },
  {
    "text": "so non-security products you tend to find things like SQL injection stuff like that you you",
    "start": "3710099",
    "end": "3716280"
  },
  {
    "text": "definitely find less of that in security products because you know people in those environments where they're",
    "start": "3716280",
    "end": "3722040"
  },
  {
    "text": "developing security products they've been trained to use you know mitigations against SQL injection",
    "start": "3722040",
    "end": "3728760"
  },
  {
    "text": "um so uh I would say yes non-security products or",
    "start": "3728760",
    "end": "3736200"
  },
  {
    "text": "security products that haven't got the security label tend to be slightly worse but not not so much worse",
    "start": "3736200",
    "end": "3742559"
  },
  {
    "text": "than some of the things you've seen another question there you talk about",
    "start": "3742559",
    "end": "3748740"
  },
  {
    "text": "mitigation measures and you talk primarily about what the vendors could do yeah sure",
    "start": "3748740",
    "end": "3755540"
  },
  {
    "text": "the person running these appliances I have them in my network now judging from your talk I have to assume",
    "start": "3762299",
    "end": "3768299"
  },
  {
    "text": "they're all over what can I do so the first and most important thing is",
    "start": "3768299",
    "end": "3774960"
  },
  {
    "text": "do not expose the UI to the internet and SSH to the internet I've had this",
    "start": "3774960",
    "end": "3780900"
  },
  {
    "text": "discussion with uh one of our customers actually so we did a pen test we found",
    "start": "3780900",
    "end": "3786299"
  },
  {
    "text": "that there was an admin UI for a security product exposed to the internet and my recommendation was that they",
    "start": "3786299",
    "end": "3792839"
  },
  {
    "text": "disabled that or filter it um it was actually a Gateway product",
    "start": "3792839",
    "end": "3798119"
  },
  {
    "text": "which had had SSL it had VPN capability within it",
    "start": "3798119",
    "end": "3805079"
  },
  {
    "text": "so you could have set it up so that you could VPN in and manage the product but they they decided not to remove the",
    "start": "3805079",
    "end": "3812540"
  },
  {
    "text": "web UI from the internet because it was a remote site and they were using the web UI to manage the product remotely I",
    "start": "3812540",
    "end": "3819240"
  },
  {
    "text": "would definitely say you know if that's the case in a remote site um you should be using a VPN and then",
    "start": "3819240",
    "end": "3826440"
  },
  {
    "text": "use you know the web UI over the VPN so that's the first thing don't expose",
    "start": "3826440",
    "end": "3831540"
  },
  {
    "text": "these things to the internet um secondly if you're in Secure",
    "start": "3831540",
    "end": "3837059"
  },
  {
    "text": "environments you might want to consider using a different browser for managing",
    "start": "3837059",
    "end": "3842099"
  },
  {
    "text": "your internal products to the one you use to browse the internet so",
    "start": "3842099",
    "end": "3848180"
  },
  {
    "text": "enabling additional features within your browser such as plugins so for example Firefox you can use the no script plugin",
    "start": "3848180",
    "end": "3855059"
  },
  {
    "text": "which has got defenses against cross-site scripting cross-site request forgery and that kind of stuff so have",
    "start": "3855059",
    "end": "3860099"
  },
  {
    "text": "that on and properly configured so it's working those kind of things and locking these interfaces down so where you've",
    "start": "3860099",
    "end": "3866099"
  },
  {
    "text": "got SSH and web uis lock them down so",
    "start": "3866099",
    "end": "3871500"
  },
  {
    "text": "that only IP addresses within a management like a knock or you know certain management subnet can access",
    "start": "3871500",
    "end": "3879839"
  },
  {
    "text": "those systems directly not just any internal user because sometimes these attacks if they're authenticate",
    "start": "3879839",
    "end": "3885599"
  },
  {
    "text": "unauthenticated attacks against the web UI you can do them reflectively from any",
    "start": "3885599",
    "end": "3891119"
  },
  {
    "text": "internal user not just the administrator yeah",
    "start": "3891119",
    "end": "3896819"
  },
  {
    "text": "so there's more briefly my advice any other questions",
    "start": "3896819",
    "end": "3902720"
  },
  {
    "text": "thank you very much for listening foreign thank you foreign",
    "start": "3904020",
    "end": "3911099"
  },
  {
    "text": "foreign",
    "start": "3911099",
    "end": "3913339"
  }
]