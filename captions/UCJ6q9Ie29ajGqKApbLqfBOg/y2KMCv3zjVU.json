[
  {
    "start": "0",
    "end": "743000"
  },
  {
    "text": "hey everybody thank you and welcome we have a great talk today I just want to",
    "start": "30",
    "end": "5609"
  },
  {
    "text": "take everybody I want to ask everybody for one favor if you could take a moment and please silence your cellphone's I",
    "start": "5609",
    "end": "10860"
  },
  {
    "text": "know we were all just at lunch and getting our messages if you could put those on vibrate and really appreciate",
    "start": "10860",
    "end": "16440"
  },
  {
    "text": "it all right so today's talk is going to be towards discovering remote code",
    "start": "16440",
    "end": "21990"
  },
  {
    "text": "execution vulnerabilities in Apple FaceTime so if you guys could please give a warm welcome to Tao and Taylor",
    "start": "21990",
    "end": "30380"
  },
  {
    "text": "thank you thank you very much for coming",
    "start": "30380",
    "end": "36149"
  },
  {
    "text": "to our talk and my name is Kelly Wong this is my colleague at all and most of",
    "start": "36149",
    "end": "43350"
  },
  {
    "text": "us are from Team Pangu we have been working on our security research for very long time and today this talk is",
    "start": "43350",
    "end": "50940"
  },
  {
    "text": "about fist time security and so motivation we knew that actually now",
    "start": "50940",
    "end": "57629"
  },
  {
    "text": "messaging apps has become very hot research target and the no matter the",
    "start": "57629",
    "end": "63180"
  },
  {
    "text": "bug bounty programs or other rumors and as demonstrated by other researchers",
    "start": "63180",
    "end": "68760"
  },
  {
    "text": "both what happened a message could be remotely compromised actually a few",
    "start": "68760",
    "end": "75330"
  },
  {
    "text": "months ago after we read the blog post by a Google product tp0 and about how to fighting how to file a",
    "start": "75330",
    "end": "84150"
  },
  {
    "text": "whatsapp and iMessage fist time we realized that actually the code quality",
    "start": "84150",
    "end": "90360"
  },
  {
    "text": "of such messaging apps is not as good as we expected so we decided to take a look",
    "start": "90360",
    "end": "96360"
  },
  {
    "text": "especially fist time so the scope of the talk and in this talk we are going to",
    "start": "96360",
    "end": "103560"
  },
  {
    "text": "show you the code execution flows for system call initialization and the",
    "start": "103560",
    "end": "109560"
  },
  {
    "text": "connection and we will analyze the attack surface along this exclusion",
    "start": "109560",
    "end": "114810"
  },
  {
    "text": "flows and we will show you a lot of very interesting box on this exclusion flows",
    "start": "114810",
    "end": "121229"
  },
  {
    "text": "and but the talk will know we are not go to the details of the protocol families",
    "start": "121229",
    "end": "127530"
  },
  {
    "text": "used by this time like Sassoon our TPS RTP and so on also the",
    "start": "127530",
    "end": "133760"
  },
  {
    "text": "we will not talk about how the audio or video streams encrypted or decrypted",
    "start": "133760",
    "end": "139129"
  },
  {
    "text": "please refer to other related to work for more information and this is the",
    "start": "139129",
    "end": "144769"
  },
  {
    "text": "after end of the talk and Paul will continue to introduce how office time",
    "start": "144769",
    "end": "150260"
  },
  {
    "text": "call is initialized and connected and analyze the text surface after then I",
    "start": "150260",
    "end": "155420"
  },
  {
    "text": "will show you some very interesting box under conclude the talk okay so this is",
    "start": "155420",
    "end": "165200"
  },
  {
    "text": "the this time outs loop running on Mac OS it looks like this a single",
    "start": "165200",
    "end": "172310"
  },
  {
    "text": "application but in fact first time is consists of multi-process 15 app",
    "start": "172310",
    "end": "179900"
  },
  {
    "text": "provides the basic UI framework and the cross service D is responsible for",
    "start": "179900",
    "end": "187690"
  },
  {
    "text": "provides a function on the left side the main features associated with our talk",
    "start": "187690",
    "end": "194780"
  },
  {
    "text": "is these three a first car serviced cursors D will manage the cost leaders",
    "start": "194780",
    "end": "201319"
  },
  {
    "text": "of this time second coastal council steel will be responsible for response",
    "start": "201319",
    "end": "208099"
  },
  {
    "text": "the UI triggered in words and the last last cursory Steve will provide a",
    "start": "208099",
    "end": "215660"
  },
  {
    "text": "communication bridge between AV conference T and identity the function",
    "start": "215660",
    "end": "222019"
  },
  {
    "text": "on the right side is power powered by AV conference T on Mac OS or",
    "start": "222019",
    "end": "228500"
  },
  {
    "text": "media server D on iOS they were produced and hindering the first time video or",
    "start": "228500",
    "end": "235190"
  },
  {
    "text": "audio streams so we can consider that fist time consists of the three major",
    "start": "235190",
    "end": "242150"
  },
  {
    "text": "major components this is wing when a user tries to make a",
    "start": "242150",
    "end": "248810"
  },
  {
    "text": "system call the user will need to click the button on the left side then faced an app will",
    "start": "248810",
    "end": "257030"
  },
  {
    "text": "generate a notification we can call it a notification call then a notification",
    "start": "257030",
    "end": "262370"
  },
  {
    "text": "will be handled by the cursor is T cos OST will call the function perform star core",
    "start": "262370",
    "end": "269600"
  },
  {
    "text": "action and the Zenko service T well he walks the chorus corresponding handler",
    "start": "269600",
    "end": "276320"
  },
  {
    "text": "to create new invitation so cos T will",
    "start": "276320",
    "end": "281480"
  },
  {
    "text": "send an explicit message to every conference T to get the invitation date",
    "start": "281480",
    "end": "286580"
  },
  {
    "text": "I store the function prepare with configuration the amide state is",
    "start": "286580",
    "end": "294290"
  },
  {
    "text": "consists of media blah blah as keyblob and as some other informations media",
    "start": "294290",
    "end": "299900"
  },
  {
    "text": "biloba contains the configuration for audio and video streams as keep log",
    "start": "299900",
    "end": "305870"
  },
  {
    "text": "contains the encryption and decryption parameters for audio and video streams",
    "start": "305870",
    "end": "312849"
  },
  {
    "text": "after AV complicity generates the plops the it will send back to c√°ceres T cos",
    "start": "313120",
    "end": "321410"
  },
  {
    "text": "OSD and we are continues to encapsulate more information after that conservative",
    "start": "321410",
    "end": "329630"
  },
  {
    "text": "passes the imitation date to attend service T for further encapsulation",
    "start": "329630",
    "end": "337300"
  },
  {
    "text": "identity or we can call it identity service demon it's a system process that",
    "start": "337360",
    "end": "343130"
  },
  {
    "text": "handles credential for IT service including iCloud and iMessage it also",
    "start": "343130",
    "end": "350390"
  },
  {
    "text": "connects to computers and iOS device on your local network to cordon arey phone",
    "start": "350390",
    "end": "357800"
  },
  {
    "text": "calls across mode motive devices so I tend service T well continues to",
    "start": "357800",
    "end": "364550"
  },
  {
    "text": "encapsulate more information and then passes it to a PSD Obst is a so we can",
    "start": "364550",
    "end": "371810"
  },
  {
    "text": "also call it Apple push service daemon is that is responsible for sending and",
    "start": "371810",
    "end": "377030"
  },
  {
    "text": "receiving post notification a PSD also maintains a reliable and a circular",
    "start": "377030",
    "end": "382550"
  },
  {
    "text": "connection to a server so if a PhD will continue to serialize the whoo-ho",
    "start": "382550",
    "end": "390650"
  },
  {
    "text": "invitation date into an struct called a PS message and then send it up a server",
    "start": "390650",
    "end": "397940"
  },
  {
    "text": "wing and power sent a notification to Apple Apple",
    "start": "397940",
    "end": "404000"
  },
  {
    "text": "that's not single simply forwarded to destination instead I will modify",
    "start": "404000",
    "end": "409610"
  },
  {
    "text": "parallels in the notification so it's important for us to find out which is",
    "start": "409610",
    "end": "416510"
  },
  {
    "text": "which state is controller we can control so we were comparing the notification",
    "start": "416510",
    "end": "422570"
  },
  {
    "text": "sent out and a notification received on the remote sites so we find out the sum",
    "start": "422570",
    "end": "429229"
  },
  {
    "text": "of data we can control observer now well forward notification to the Kali and",
    "start": "429229",
    "end": "436010"
  },
  {
    "text": "point according to the content of of the ApS message the remote a PSD will desire",
    "start": "436010",
    "end": "444320"
  },
  {
    "text": "lies the ApS message this is how it looks like in DB on the left side right",
    "start": "444320",
    "end": "453710"
  },
  {
    "text": "side we send breakpoints in a PSD masse the desire ization function in a",
    "start": "453710",
    "end": "460669"
  },
  {
    "text": "debugger and check the received a notification if the key AVS protocol",
    "start": "460669",
    "end": "466940"
  },
  {
    "text": "command a is 10 and the value of ApS",
    "start": "466940",
    "end": "472490"
  },
  {
    "text": "protocol payload and ApS protocol topic hash care is a binary which is a modern",
    "start": "472490",
    "end": "478010"
  },
  {
    "text": "for the later work a PSD we are",
    "start": "478010",
    "end": "484039"
  },
  {
    "text": "according to the ApS protocol topic hash and ApS protocol command received and",
    "start": "484039",
    "end": "490389"
  },
  {
    "text": "delivers delivers the payload of the notification to attend service D we also",
    "start": "490389",
    "end": "497300"
  },
  {
    "text": "set breakpoints in identity and check the received invitation it looks like",
    "start": "497300",
    "end": "505250"
  },
  {
    "text": "like the picture on the right side the value of the value of key the value of",
    "start": "505250",
    "end": "512930"
  },
  {
    "text": "key C is the most is the most important it's in the case that which function we",
    "start": "512930",
    "end": "519560"
  },
  {
    "text": "are being invoked to handle this notification as invite a C is 200 and a",
    "start": "519560",
    "end": "528950"
  },
  {
    "text": "13-2 so the notification will be handled by the function",
    "start": "528950",
    "end": "534260"
  },
  {
    "text": "incoming invitation with payload and then identity will continue to forward",
    "start": "534260",
    "end": "541670"
  },
  {
    "text": "the date to car service T cross OST will pass binary pillows through the function",
    "start": "541670",
    "end": "548690"
  },
  {
    "text": "and after pass it looks like this it looks like an S dictionary and as n",
    "start": "548690",
    "end": "558410"
  },
  {
    "text": "casuistry you will continue to forward the blobs to a big conference the Armenia bla media server D on the remote",
    "start": "558410",
    "end": "565460"
  },
  {
    "text": "site and we can see here the Kohli the AV conference T or media server D of the",
    "start": "565460",
    "end": "572510"
  },
  {
    "text": "remote side has received as the blobs come from the local side in a now you I",
    "start": "572510",
    "end": "582860"
  },
  {
    "text": "will pop out to tell you that you have a new Vista in white do you want to accept",
    "start": "582860",
    "end": "588920"
  },
  {
    "text": "and and we click the accept button it's a will generate Huai notification",
    "start": "588920",
    "end": "597080"
  },
  {
    "text": "we can call it a you identification except so the UI notification will be sent across service T and as a casa SD",
    "start": "597080",
    "end": "606740"
  },
  {
    "text": "will also handle the notifications through and so another handler function",
    "start": "606740",
    "end": "612710"
  },
  {
    "text": "and to the almost the same thing just waited on the local sides it will get in",
    "start": "612710",
    "end": "622400"
  },
  {
    "text": "my date it also called invited because it has Media Browser and s keyblob and",
    "start": "622400",
    "end": "629110"
  },
  {
    "text": "gets it from AV conference T and encapsulate more information and",
    "start": "629110",
    "end": "634820"
  },
  {
    "text": "ascended back to identity identity will pass the date to a PSD and a PSD will",
    "start": "634820",
    "end": "642440"
  },
  {
    "text": "encapsulate I will serialize the APS message in a Senate observer",
    "start": "642440",
    "end": "647680"
  },
  {
    "text": "observer will forward the forward the notification to our caller a PSD caller",
    "start": "647680",
    "end": "656870"
  },
  {
    "text": "a PSD will desire lies the disallow the APS message and a passed the date to",
    "start": "656870",
    "end": "663320"
  },
  {
    "text": "attend service T and now the the the real value of CL k c is the 233",
    "start": "663320",
    "end": "672200"
  },
  {
    "text": "which means this notification is accept a message and a tell tell our local side",
    "start": "672200",
    "end": "679700"
  },
  {
    "text": "that the Kali have has already accepts you in white and identity well past the",
    "start": "679700",
    "end": "686960"
  },
  {
    "text": "date to cursor is D Co service T will pass the media blob and STPs key blob of",
    "start": "686960",
    "end": "693200"
  },
  {
    "text": "remote side through Ava conference D and now the information we need to to make",
    "start": "693200",
    "end": "699820"
  },
  {
    "text": "connection has been changed and meanwhile I tensors D well create",
    "start": "699820",
    "end": "705380"
  },
  {
    "text": "sockets for session based connections and another notification called quick",
    "start": "705380",
    "end": "713060"
  },
  {
    "text": "relay Apple quick release our work ordinary color and a colleague computer at direct direct connection but we don't",
    "start": "713060",
    "end": "720560"
  },
  {
    "text": "give a detail introduced here because lot of dates in quick related",
    "start": "720560",
    "end": "726080"
  },
  {
    "text": "notification is not a controllable in and out the color and a colleague can",
    "start": "726080",
    "end": "731600"
  },
  {
    "text": "see in hair or hear each other with this time but in fact and now all the dates",
    "start": "731600",
    "end": "738800"
  },
  {
    "text": "is trend transformed from a through the soccer with UDP or TCP I 10 service T is",
    "start": "738800",
    "end": "746480"
  },
  {
    "start": "743000",
    "end": "897000"
  },
  {
    "text": "responsible for the first layer packet Henry and a packet area dispatching",
    "start": "746480",
    "end": "753760"
  },
  {
    "text": "ideas the function ideas you tp-link process incoming packets will call the",
    "start": "753760",
    "end": "760880"
  },
  {
    "text": "function regime message and pass the map acetate to IDs global link and then this",
    "start": "760880",
    "end": "770450"
  },
  {
    "text": "function I then service and English function identity will identify Stan",
    "start": "770450",
    "end": "775940"
  },
  {
    "text": "message according to the magic number which is 4 - a 4 1 - 2 1 and then",
    "start": "775940",
    "end": "784150"
  },
  {
    "text": "identity passes term message through a handler the",
    "start": "784150",
    "end": "789440"
  },
  {
    "text": "handler will well with further will further call different handlers",
    "start": "789440",
    "end": "795440"
  },
  {
    "text": "according to different estimate each a type besides the",
    "start": "795440",
    "end": "801470"
  },
  {
    "text": "sh many other type of package also handled by identity itself the rest of",
    "start": "801470",
    "end": "808910"
  },
  {
    "text": "package will be distributed to different process processes such as a V conference",
    "start": "808910",
    "end": "814700"
  },
  {
    "text": "T and this package like RTP packet or rtcp packets so RTP packets handler is",
    "start": "814700",
    "end": "826060"
  },
  {
    "text": "on another in another process but at first at first it looks the same ideas",
    "start": "826060",
    "end": "834590"
  },
  {
    "text": "ideas udb link process incoming package will call resume message to get it from",
    "start": "834590",
    "end": "840530"
  },
  {
    "text": "UDP from socket and then the package will pass you ideas Global Link and",
    "start": "840530",
    "end": "848920"
  },
  {
    "text": "ideas globalink will find the these packages is not it will not be handled",
    "start": "848920",
    "end": "855230"
  },
  {
    "text": "by Denis OSD so he will pass the tape pass the tapes to his delegate class",
    "start": "855230",
    "end": "861260"
  },
  {
    "text": "called ideas link manager and ideas link manager will pass the data to its I did",
    "start": "861260",
    "end": "867530"
  },
  {
    "text": "a delegate class called IDs session analyse function idea decision at least",
    "start": "867530",
    "end": "874340"
  },
  {
    "text": "this class idea decision will transfer Tate to a big conference teach through a series of undocumented system call which",
    "start": "874340",
    "end": "882460"
  },
  {
    "text": "is OS channel or OS nexus families and",
    "start": "882460",
    "end": "888860"
  },
  {
    "text": "this is finally implementing of underlying network as so this lattice of",
    "start": "888860",
    "end": "900080"
  },
  {
    "start": "897000",
    "end": "976000"
  },
  {
    "text": "the reserved engineering and let's see the attack service the code for",
    "start": "900080",
    "end": "907970"
  },
  {
    "text": "notification processing and add alluring forms the arrow click the arrow click attack service which means attacker can",
    "start": "907970",
    "end": "915790"
  },
  {
    "text": "send a notification to the column goes through a pessoa and a PSD and i-10",
    "start": "915790",
    "end": "922370"
  },
  {
    "text": "service T and then car service T as asked every conference T or media's salty that's the 0 click attack service",
    "start": "922370",
    "end": "930500"
  },
  {
    "text": "and the code for stalked packet processing and a delivering forms one-click attack",
    "start": "930500",
    "end": "937340"
  },
  {
    "text": "service after fist and call is connected attacker can direct signal sent package",
    "start": "937340",
    "end": "944750"
  },
  {
    "text": "tried and service T and all a 10 SOC will pass the package to AV Conference D",
    "start": "944750",
    "end": "951800"
  },
  {
    "text": "I density can further dispatch message to other service according to topic and",
    "start": "951800",
    "end": "958430"
  },
  {
    "text": "a commands an open new attack service this is some added attack service we",
    "start": "958430",
    "end": "965330"
  },
  {
    "text": "found like iMessage remotes desk fort from continuity and something like that",
    "start": "965330",
    "end": "971330"
  },
  {
    "text": "which includes also one click or the arrow click attack service in next okay",
    "start": "971330",
    "end": "981170"
  },
  {
    "start": "976000",
    "end": "1178000"
  },
  {
    "text": "next I'm going to show you some very interesting one abilities and the first one is a potential info leak on the 0 0",
    "start": "981170",
    "end": "990200"
  },
  {
    "text": "click attack surface from a PSD to an ad service key why we call is a potential",
    "start": "990200",
    "end": "996500"
  },
  {
    "text": "if a leak I will explain it later and so the reason we noticed this issue",
    "start": "996500",
    "end": "1004120"
  },
  {
    "text": "is this so when we send a limitation oft we notice that actually the new",
    "start": "1004120",
    "end": "1010270"
  },
  {
    "text": "invitation dictionary has a UUID the UID just just a some random numbers without",
    "start": "1010270",
    "end": "1016450"
  },
  {
    "text": "any special meanings and but we find a way to trigger the receiver we can force",
    "start": "1016450",
    "end": "1023830"
  },
  {
    "text": "it to force a receiver to reply message in a replied message we found the same",
    "start": "1023830",
    "end": "1031120"
  },
  {
    "text": "UID so basically no matter the receiver accept or decline or notice the system",
    "start": "1031120",
    "end": "1037270"
  },
  {
    "text": "call we can force it forces a receiver to generate our reply message and so far",
    "start": "1037270",
    "end": "1045130"
  },
  {
    "text": "nothing special but if you look at how the receiver passed the UID you will",
    "start": "1045130",
    "end": "1050410"
  },
  {
    "text": "find something interesting so after limitation is received and in",
    "start": "1050410",
    "end": "1055420"
  },
  {
    "text": "the surface T we will try to pass the dictionary and the first step is it try",
    "start": "1055420",
    "end": "1060490"
  },
  {
    "text": "to fetch the you in the dictionary you is the key and if the value object is",
    "start": "1060490",
    "end": "1066950"
  },
  {
    "text": "yes data and it will pass the earth data to a function called a DW UUID push",
    "start": "1066950",
    "end": "1074240"
  },
  {
    "text": "object a to string you don't have you don't have to read the whole code the function it's supposed to convert or",
    "start": "1074240",
    "end": "1081200"
  },
  {
    "text": "dump with the data buffer into a local stack stack paste buffer and then",
    "start": "1081200",
    "end": "1087440"
  },
  {
    "text": "convert the local buffer to safe string but the question is first there's no",
    "start": "1087440",
    "end": "1093980"
  },
  {
    "text": "check on the length of the nets data the UUID so second thing is the local buffer",
    "start": "1093980",
    "end": "1100640"
  },
  {
    "text": "is not initialized so what would happen if the UUID is less than 16 bits so it",
    "start": "1100640",
    "end": "1108440"
  },
  {
    "text": "will cause a kind of uninitialized memory leak because we can force the receiver send you your ID back so what",
    "start": "1108440",
    "end": "1116480"
  },
  {
    "text": "we hope to do is this we implemented a very simple POS a we hope to see this we",
    "start": "1116480",
    "end": "1123950"
  },
  {
    "text": "sign some new ID very short like 4 bytes or 8 bytes and we won't get some leaked",
    "start": "1123950",
    "end": "1130180"
  },
  {
    "text": "value on a stack but when we really do that we found something very interesting",
    "start": "1130180",
    "end": "1136310"
  },
  {
    "text": "so when the UID is very short for example less than 16 bits bytes we don't",
    "start": "1136310",
    "end": "1143060"
  },
  {
    "text": "know what happened on the ICO server it seems observer had kind of validation",
    "start": "1143060",
    "end": "1148310"
  },
  {
    "text": "on the UID s the cost on the receiver side the you variety just disappeared so",
    "start": "1148310",
    "end": "1154340"
  },
  {
    "text": "there's no your ID in the dictionary so apparently the Apple server filter out",
    "start": "1154340",
    "end": "1161030"
  },
  {
    "text": "the UUID s we don't know apple juice does that on purpose or not anyway it",
    "start": "1161030",
    "end": "1167000"
  },
  {
    "text": "blocks the info leak and also we don't know when Apple server started to filter",
    "start": "1167000",
    "end": "1173420"
  },
  {
    "text": "out the humanity you your IDs ok so that's the potential info leak maybe you",
    "start": "1173420",
    "end": "1179630"
  },
  {
    "start": "1178000",
    "end": "1460000"
  },
  {
    "text": "think you don't think that's very interesting now we move to some very juicy bugs",
    "start": "1179630",
    "end": "1184730"
  },
  {
    "text": "paper overflows and as tall already mentioned if this time hall is connected",
    "start": "1184730",
    "end": "1191630"
  },
  {
    "text": "that means as a tanker is able to directly send u TP package to the",
    "start": "1191630",
    "end": "1196970"
  },
  {
    "text": "removed and then historicity and let's say what happened there so tall already mentioned that actually an",
    "start": "1196970",
    "end": "1204790"
  },
  {
    "text": "Indy service team is responsible for handling a kind of message called same",
    "start": "1204790",
    "end": "1210340"
  },
  {
    "text": "message and an in the surf the find or identify the that kind of message by",
    "start": "1210340",
    "end": "1216820"
  },
  {
    "text": "magic number matching so if you just top a UDP packet and an offset for you put a",
    "start": "1216820",
    "end": "1223090"
  },
  {
    "text": "magic number like 42 a four parabola it will trigger thus the message passer and",
    "start": "1223090",
    "end": "1230070"
  },
  {
    "text": "what and then if service to do is this so it will first they serialize the UDP",
    "start": "1230070",
    "end": "1236860"
  },
  {
    "text": "packet into a ideas to the message object this the serialization parser is",
    "start": "1236860",
    "end": "1243460"
  },
  {
    "text": "okay with it and find bugs here and so that they see realized ideas is the",
    "start": "1243460",
    "end": "1249610"
  },
  {
    "text": "message the format or the structure is also very simple it has a type and a",
    "start": "1249610",
    "end": "1254800"
  },
  {
    "text": "lens and the ideas the message may have like at most paint a attribute the",
    "start": "1254800",
    "end": "1261580"
  },
  {
    "text": "attributes just some buffer just copied from you TP payload so basically they",
    "start": "1261580",
    "end": "1267429"
  },
  {
    "text": "are under totally under the tankers control so according to the type of the",
    "start": "1267429",
    "end": "1273520"
  },
  {
    "text": "idea is the message it will at the identity will continue to evoke",
    "start": "1273520",
    "end": "1278830"
  },
  {
    "text": "different handler functions and you know in a case the type is zero x17",
    "start": "1278830",
    "end": "1285610"
  },
  {
    "text": "a function called processed data indication will be invoked inside this",
    "start": "1285610",
    "end": "1291160"
  },
  {
    "text": "function it will first try to get attribute from the ideas message at the",
    "start": "1291160",
    "end": "1297190"
  },
  {
    "text": "type of the attribute is 19 and so Aito",
    "start": "1297190",
    "end": "1302830"
  },
  {
    "text": "t is very simple it's just kopazar law the the attribute from ideas message to",
    "start": "1302830",
    "end": "1308950"
  },
  {
    "text": "a local buffer so basically you can just imagine that it's just a cop is a UTP",
    "start": "1308950",
    "end": "1314860"
  },
  {
    "text": "pillow the bytes to a local buffer you will say a memory copy here but nothing",
    "start": "1314860",
    "end": "1321130"
  },
  {
    "text": "wrong here so this memory copy okay maybe is this is only correct memory copy you will see in this",
    "start": "1321130",
    "end": "1327520"
  },
  {
    "text": "presentation okay now local barber is totally honored but",
    "start": "1327520",
    "end": "1334460"
  },
  {
    "text": "tankers can show what this local bar is used is this this local barber will be",
    "start": "1334460",
    "end": "1340880"
  },
  {
    "text": "used to deserialize into a another object called ideas Global Link message",
    "start": "1340880",
    "end": "1345980"
  },
  {
    "text": "and though this path is also very simple because the format is like pipelines and",
    "start": "1345980",
    "end": "1352100"
  },
  {
    "text": "payload and the pipe is is to bias and the lens is to bars and the rice is the payload so the pass should be easy but",
    "start": "1352100",
    "end": "1360410"
  },
  {
    "text": "if you look at in the case like I've ready we will go to a function called grid ideas G link to build a binary of",
    "start": "1360410",
    "end": "1369230"
  },
  {
    "text": "data inside this function what would happen is sir there is the memory copy",
    "start": "1369230",
    "end": "1376960"
  },
  {
    "text": "okay this memory copy is very very tricky if you look handle a size",
    "start": "1376960",
    "end": "1382160"
  },
  {
    "text": "parameter it's directly read from the attribute buffer the local buffer it's",
    "start": "1382160",
    "end": "1387350"
  },
  {
    "text": "totally under tankers can't you and so it's a very typical people of low issue",
    "start": "1387350",
    "end": "1393830"
  },
  {
    "text": "the sauce buffer is a job packet you TP payload and the size is read from the",
    "start": "1393830",
    "end": "1400760"
  },
  {
    "text": "payload so if you do a facile here like you wanna make generated slim message",
    "start": "1400760",
    "end": "1407360"
  },
  {
    "text": "and you can easily trillo a cross like this so this is a crotch and crush lock",
    "start": "1407360",
    "end": "1414020"
  },
  {
    "text": "on Mac OS I think and you can see the mem copy triggers crash so we just do",
    "start": "1414020",
    "end": "1424880"
  },
  {
    "text": "very little bit modification to the POS a make some kind of a plea layout",
    "start": "1424880",
    "end": "1430660"
  },
  {
    "text": "manipulation and we can easily organize the the is a pointer of adjacent objects",
    "start": "1430660",
    "end": "1437720"
  },
  {
    "text": "and we can trigger a clock like it try to access 41 45 41 that means the next",
    "start": "1437720",
    "end": "1443240"
  },
  {
    "text": "point next object that is in the objects pointer is already controlled so how to",
    "start": "1443240",
    "end": "1449960"
  },
  {
    "text": "exploit it please refer to nice work more than objects the exploitation for",
    "start": "1449960",
    "end": "1455240"
  },
  {
    "text": "more details in short is not an hard okay now let's move to another very",
    "start": "1455240",
    "end": "1463460"
  },
  {
    "start": "1460000",
    "end": "1607000"
  },
  {
    "text": "interesting about Stack Overflow issue in EP passer so you may ask me okay come on",
    "start": "1463460",
    "end": "1469860"
  },
  {
    "text": "stackoverflow it's still exploitable let's see so when this time core is",
    "start": "1469860",
    "end": "1478200"
  },
  {
    "text": "connected so we do frames will be transferred between each each side so if",
    "start": "1478200",
    "end": "1483990"
  },
  {
    "text": "a video frame is very large it may split into multiple RTP packets and send to",
    "start": "1483990",
    "end": "1490620"
  },
  {
    "text": "the other side the receiver will reassemble such RTP packets into a",
    "start": "1490620",
    "end": "1496049"
  },
  {
    "text": "videos media frame this picture shows how the video frame and RTP package is",
    "start": "1496049",
    "end": "1502679"
  },
  {
    "text": "organized so there is a list for different frame and for each frame there is the list for different RTP packet I",
    "start": "1502679",
    "end": "1510480"
  },
  {
    "text": "want to emphasize that when the when it serves t receive the RTP packet all",
    "start": "1510480",
    "end": "1517650"
  },
  {
    "text": "every conference t handle the RTP packet there is a very restrict tech on the RTP",
    "start": "1517650",
    "end": "1523470"
  },
  {
    "text": "packet to make sure the lens field in the archetype RTP RTP packet equals the",
    "start": "1523470",
    "end": "1529950"
  },
  {
    "text": "real size of the payload so there is a way we restrict check but the question",
    "start": "1529950",
    "end": "1535350"
  },
  {
    "text": "is first time use a mechanism called the forward error correction as a mechanism",
    "start": "1535350",
    "end": "1540929"
  },
  {
    "text": "to minimize the influence of packet loss so in the case for example a active",
    "start": "1540929",
    "end": "1547799"
  },
  {
    "text": "frame is split into eight packets and one packet is lost the receiver will try",
    "start": "1547799",
    "end": "1554429"
  },
  {
    "text": "to repair the rebuild a new RTP packet based on the IPC information inside",
    "start": "1554429",
    "end": "1560809"
  },
  {
    "text": "encoded in the original the rest of received RTP packets however the the",
    "start": "1560809",
    "end": "1568020"
  },
  {
    "text": "error here is this for the repaired or the newly generated RTP packet the lens",
    "start": "1568020",
    "end": "1574140"
  },
  {
    "text": "field is just copied from FEC header that is totally under tankers control",
    "start": "1574140",
    "end": "1580380"
  },
  {
    "text": "without any validation so we don't have to go to the details of the code anyway",
    "start": "1580380",
    "end": "1586860"
  },
  {
    "text": "so when the window frame is scheduled to be processed it will trigger such a kind",
    "start": "1586860",
    "end": "1592290"
  },
  {
    "text": "of execution flow assembly frame and finally there's a memory copy it's a",
    "start": "1592290",
    "end": "1597480"
  },
  {
    "text": "very typical stack overflow issue and it tries to copy hit buffer to a local stack buffer under the size is",
    "start": "1597480",
    "end": "1604710"
  },
  {
    "text": "under attackers can chew so back to the question is that overflow exploitable on",
    "start": "1604710",
    "end": "1610650"
  },
  {
    "start": "1607000",
    "end": "1737000"
  },
  {
    "text": "iOS in nineteen twenty nineteen so we",
    "start": "1610650",
    "end": "1616110"
  },
  {
    "text": "knew that that the most people who will to prevent stack overflow issues is stack cookie or seneca canary the idea",
    "start": "1616110",
    "end": "1623340"
  },
  {
    "text": "is this so between return address and the local variables the compiler will insert a stack canary before the factory",
    "start": "1623340",
    "end": "1631050"
  },
  {
    "text": "returns it will compare the cookie also can array on the stack but case the when",
    "start": "1631050",
    "end": "1637230"
  },
  {
    "text": "you on hip if there is a mismatch just crush the program that means the some",
    "start": "1637230",
    "end": "1642960"
  },
  {
    "text": "kind of stack overflow happened so it worked very well it can prevent a lot of typical stack overflows but let's look",
    "start": "1642960",
    "end": "1650880"
  },
  {
    "text": "at the the the function assembly assemble frame okay if you are not",
    "start": "1650880",
    "end": "1656640"
  },
  {
    "text": "familiar with these pioneering instructions don't worry I will explain it for you so this fund this instructions is used",
    "start": "1656640",
    "end": "1664620"
  },
  {
    "text": "to okay if the function is called the the return address already on the stack and these instructions are used to see",
    "start": "1664620",
    "end": "1672240"
  },
  {
    "text": "if some registers and there's a this instructions in the red box is used to",
    "start": "1672240",
    "end": "1677400"
  },
  {
    "text": "allocate local variables and this instructions is used to insert the stack",
    "start": "1677400",
    "end": "1683250"
  },
  {
    "text": "canary okay you may find something on the stack",
    "start": "1683250",
    "end": "1688380"
  },
  {
    "text": "canary is placed below local variables so what would happen if a stack overflow",
    "start": "1688380",
    "end": "1694260"
  },
  {
    "text": "happens it's looks like this after the stack overflow happens nothing is wrong",
    "start": "1694260",
    "end": "1700080"
  },
  {
    "text": "with the stack cannery so you will see like this this is crash",
    "start": "1700080",
    "end": "1706050"
  },
  {
    "text": "lock on iOS immediate server D you can say after the stack overflow the PC is totally under control and a lot of",
    "start": "1706050",
    "end": "1713070"
  },
  {
    "text": "registers are also under control so if you want ask me how to esporte this",
    "start": "1713070",
    "end": "1719070"
  },
  {
    "text": "vulnerability I would suggest you to read the paper entitled smash sex for fun and profit published",
    "start": "1719070",
    "end": "1726300"
  },
  {
    "text": "in 1990 nineteen six I think okay we",
    "start": "1726300",
    "end": "1731400"
  },
  {
    "text": "reported to echo it all defects in the latest version and but we",
    "start": "1731400",
    "end": "1739000"
  },
  {
    "start": "1737000",
    "end": "1776000"
  },
  {
    "text": "find something more interesting this function is not a single victim we find",
    "start": "1739000",
    "end": "1744190"
  },
  {
    "text": "a lot of other functions in different modules have the same issue the stack cookie is placed in the wrong position",
    "start": "1744190",
    "end": "1751600"
  },
  {
    "text": "so we suspect there is a compiler back behind the stack overflow so finally a",
    "start": "1751600",
    "end": "1759040"
  },
  {
    "text": "single security team pinpoint the compiler issue and they reported to our IBM so if you were a app developers",
    "start": "1759040",
    "end": "1767790"
  },
  {
    "text": "remember updated office time and also update your compiler otherwise your apps",
    "start": "1767790",
    "end": "1772960"
  },
  {
    "text": "may also have the stack overflow issues okay now let's move to other attack surface",
    "start": "1772960",
    "end": "1781300"
  },
  {
    "start": "1776000",
    "end": "1934000"
  },
  {
    "text": "and we Paul already mentioned that actually a little indented Serfaty is",
    "start": "1781300",
    "end": "1788850"
  },
  {
    "text": "able to deliver notifications all Network packets to a lot of different",
    "start": "1788850",
    "end": "1794290"
  },
  {
    "text": "system service like a message remote desktop and a phone continuty and the",
    "start": "1794290",
    "end": "1799780"
  },
  {
    "text": "way we analyzed some of them and we found some very interesting bugs - for",
    "start": "1799780",
    "end": "1806140"
  },
  {
    "text": "example let's see phone continuty from content a allowed to make and receive",
    "start": "1806140",
    "end": "1811810"
  },
  {
    "text": "calls from your Mac or iPad if these devices are close to your iPhone and",
    "start": "1811810",
    "end": "1818950"
  },
  {
    "text": "they are logged in with the same Authority so apparently you can make a call with your Mac if it's close to the",
    "start": "1818950",
    "end": "1826840"
  },
  {
    "text": "iPhone that means there must be some  channel between your Mac and your iPhone so we reverse engineered that us",
    "start": "1826840",
    "end": "1836020"
  },
  {
    "text": "and we find that also handled firstly a packet also handled by any deserves tea",
    "start": "1836020",
    "end": "1842110"
  },
  {
    "text": "and if you look at this exclusion pass it will finally go to a function called",
    "start": "1842110",
    "end": "1847840"
  },
  {
    "text": "IDs sock a DDR wiper and again you don't",
    "start": "1847840",
    "end": "1853300"
  },
  {
    "text": "have to read the whole pursuit of code you just remember there is a memory copy",
    "start": "1853300",
    "end": "1858610"
  },
  {
    "text": "it tries to copy socket address structure which is copied",
    "start": "1858610",
    "end": "1867010"
  },
  {
    "text": "from Misha is inside a UDP payload to a hip object and the checks did",
    "start": "1867010",
    "end": "1876990"
  },
  {
    "text": "the checks before the red box is since to check they are doing the socket",
    "start": "1876990",
    "end": "1882510"
  },
  {
    "text": "address family checks like s UDP or TCP protocol but there's no checks on the",
    "start": "1882510",
    "end": "1889080"
  },
  {
    "text": "lens or the first bytes in the socket address so if you have familiar with AI",
    "start": "1889080",
    "end": "1895980"
  },
  {
    "text": "security researcher you may remember that last year yen beer from GP zero and",
    "start": "1895980",
    "end": "1901440"
  },
  {
    "text": "a similar bug in the kernel so in the NP TCP part so it also tries to copy a",
    "start": "1901440",
    "end": "1908039"
  },
  {
    "text": "socket address to a hip buffer the question is the maximum lens or the",
    "start": "1908039",
    "end": "1914340"
  },
  {
    "text": "sides for Valley the socket address is 0 X 8 0 but the maximum maximum lens could",
    "start": "1914340",
    "end": "1922350"
  },
  {
    "text": "be specified in the memory copy is 0 direct FF so it's also a typical hipper",
    "start": "1922350",
    "end": "1929250"
  },
  {
    "text": "flow it's not easy it's not hard to exploit that so in this talk we only",
    "start": "1929250",
    "end": "1938070"
  },
  {
    "start": "1934000",
    "end": "2009000"
  },
  {
    "text": "shared some typical box like stack overflows or hippo flows in such attack",
    "start": "1938070",
    "end": "1944700"
  },
  {
    "text": "surface actually during the reverse engineer process we found a lot of trivial box like type confusions and",
    "start": "1944700",
    "end": "1951090"
  },
  {
    "text": "some after of boundaries and they are not mentioned in this talk but I",
    "start": "1951090",
    "end": "1957110"
  },
  {
    "text": "encourage you guys to take another look maybe you can find a more interesting things ok conclusion first after we do",
    "start": "1957110",
    "end": "1968159"
  },
  {
    "text": "this so we find fist x implementation is significant improvements a lot of",
    "start": "1968159",
    "end": "1973980"
  },
  {
    "text": "trivial box there and the attack surface exposed by messaging in interface like a",
    "start": "1973980",
    "end": "1980340"
  },
  {
    "text": "lot of interface in an ad surface T need more attention no matter Apple security",
    "start": "1980340",
    "end": "1987059"
  },
  {
    "text": "team or other security researchers you can find a lot of juicy bugs there may be and the most most surprising thing is",
    "start": "1987059",
    "end": "1994770"
  },
  {
    "text": "all and the most interesting thing to me is that the most typical stack overflow",
    "start": "1994770",
    "end": "2000620"
  },
  {
    "text": "do happen and Misty effect iOS now thank you",
    "start": "2000620",
    "end": "2006580"
  },
  {
    "text": "[Applause]",
    "start": "2006580",
    "end": "2011029"
  }
]