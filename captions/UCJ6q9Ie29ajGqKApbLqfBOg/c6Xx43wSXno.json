[
  {
    "start": "0",
    "end": "82000"
  },
  {
    "text": "get started with this how many people in here hate databases yeah that's what I like a semi hostile CP so uh today we're going to",
    "start": "160",
    "end": "7480"
  },
  {
    "text": "talk about um why you probably hate databases uh some of the reasons uh that",
    "start": "7480",
    "end": "14960"
  },
  {
    "text": "from a security perspective um a database can be a real problem um just to give you some",
    "start": "14960",
    "end": "21279"
  },
  {
    "text": "background on me um I've uh started off as a as a software developer um from then from that point I",
    "start": "21279",
    "end": "28519"
  },
  {
    "text": "decided I want to be an administrator and then I decided I wanted to be uh a security consultant so I did that for a",
    "start": "28519",
    "end": "33640"
  },
  {
    "text": "few years and then I decided uh that I liked programming more than I lik travel so programming again but uh from my from",
    "start": "33640",
    "end": "41760"
  },
  {
    "text": "my cave I can continue to to do some independent Consulting but um I'm not representing my company here so I don't",
    "start": "41760",
    "end": "47960"
  },
  {
    "text": "have a graphics Department I have to use the crappy clip art that uh comes with uh PowerPoint so that's what we have to",
    "start": "47960",
    "end": "53640"
  },
  {
    "text": "deal with so let's get started next all right uh the presentation is in",
    "start": "53640",
    "end": "61120"
  },
  {
    "text": "three sections the first part the section I'm going to try to go through as fast as possible that's the section on SQL servers built-in security",
    "start": "61120",
    "end": "68920"
  },
  {
    "text": "mechanisms its model how it works um the reason I try to go over it as fast as possible because it's this most boring",
    "start": "68920",
    "end": "75080"
  },
  {
    "text": "part to be quite honest and a lot of it's in books online so if you want more detailed information on it you can get it there but I do need to hit the um the",
    "start": "75080",
    "end": "82680"
  },
  {
    "start": "82000",
    "end": "82000"
  },
  {
    "text": "highlights so that the other sections will make more sense um the bad will be a section on the network",
    "start": "82680",
    "end": "91000"
  },
  {
    "text": "security portion of SQL Server how when it's placed in a network how are we going to secure this thing and how",
    "start": "91000",
    "end": "97399"
  },
  {
    "text": "should it be placed in the network um how will people attack it from a network",
    "start": "97399",
    "end": "102520"
  },
  {
    "text": "security perspective and the third section will be the most fun part we'll talk about",
    "start": "102520",
    "end": "109399"
  },
  {
    "text": "why poorly written applications um can usually bypass all of your good security",
    "start": "109399",
    "end": "115399"
  },
  {
    "text": "planning and uh your high price security products next",
    "start": "115399",
    "end": "121399"
  },
  {
    "start": "121000",
    "end": "121000"
  },
  {
    "text": "all right presence um this slide is just I'm not picking on any particular vendor",
    "start": "121399",
    "end": "126520"
  },
  {
    "text": "I just want to say that this is a fairly uh ubiquitous application it shows up all over the place um how many people in",
    "start": "126520",
    "end": "132080"
  },
  {
    "text": "here have IDs systems Network IDs systems yet if if they're based on NT you may want to take",
    "start": "132080",
    "end": "138319"
  },
  {
    "text": "a look and see what's behind it a lot of times um the database that's actually storing all the information is msde",
    "start": "138319",
    "end": "144720"
  },
  {
    "text": "which is SQL Server whatever they want to call it it's nothing really but SQL Server stripped down",
    "start": "144720",
    "end": "151840"
  },
  {
    "start": "154000",
    "end": "154000"
  },
  {
    "text": "next come on Tim Timothy's gonna help me out here today he's my PowerPoint monkey so all I have to do is",
    "start": "154400",
    "end": "162360"
  },
  {
    "text": "Click all right security framework generally SQL Server security breaks down like this the SQL Server 2000 model",
    "start": "162480",
    "end": "168400"
  },
  {
    "text": "this is generally the same for for all of them um slightly different for 2000 and the some of the the names of the",
    "start": "168400",
    "end": "175440"
  },
  {
    "text": "tables have changed but other than that it's basically you have a client that uses an assorted set of net Libs to",
    "start": "175440",
    "end": "181680"
  },
  {
    "text": "connect to um the SQL server and look for an entry in the CIS X logins table",
    "start": "181680",
    "end": "187480"
  },
  {
    "text": "the master databases these are what's called logins in order to get access to the SQL Server you have to have a",
    "start": "187480",
    "end": "193599"
  },
  {
    "text": "login um once you have that login you have the capability to access individual",
    "start": "193599",
    "end": "198680"
  },
  {
    "text": "databases through the CIS users table inside of CIS users table you have other",
    "start": "198680",
    "end": "204840"
  },
  {
    "text": "tables called say permissions that give you actual permissions to the individual objects inside the database such as",
    "start": "204840",
    "end": "210239"
  },
  {
    "text": "tables views uh store procedures um the",
    "start": "210239",
    "end": "215360"
  },
  {
    "text": "important thing to remember is users get assigned the permissions not the logins",
    "start": "215360",
    "end": "222080"
  },
  {
    "start": "222000",
    "end": "222000"
  },
  {
    "text": "next all right by default tcpip and name pipes are enabled um these are the two most",
    "start": "222080",
    "end": "229120"
  },
  {
    "text": "popular net libs that you'll find um the suckets net lib now allows SSL over any",
    "start": "229120",
    "end": "234560"
  },
  {
    "text": "network any net lib when a trusted certificate is installed on the SQL Server um used to be in previous",
    "start": "234560",
    "end": "241159"
  },
  {
    "text": "versions if you wanted to have encryption between a client and and a SQL Server you had to use the",
    "start": "241159",
    "end": "247000"
  },
  {
    "text": "multiprotocol RPC mechanism which is no longer necessary since all the net lips now support encryption um it's also be",
    "start": "247000",
    "end": "254280"
  },
  {
    "text": "noted that the multiprotocol encryption doesn't support named instances anymore uh named instance in SQL Server gives",
    "start": "254280",
    "end": "259560"
  },
  {
    "text": "you the capability to create multiple copies of SQL server and have them all installed basically on the same machine",
    "start": "259560",
    "end": "266199"
  },
  {
    "text": "um a reason you might want to do this I guess might be isolation for hosting purposes if you wanted to",
    "start": "266199",
    "end": "272160"
  },
  {
    "text": "have one one customer that had a SQL Server an instance and their name and then another customer that had a SQL",
    "start": "272160",
    "end": "277960"
  },
  {
    "text": "Server instance in their name that way their CIS logins tables wouldn't overlap you wouldn't have to create them as separate databases within the same SQL",
    "start": "277960",
    "end": "284560"
  },
  {
    "text": "server but as two separate totally separate instances of SQL Server um other nit Libs include Apple",
    "start": "284560",
    "end": "290320"
  },
  {
    "text": "talk uh NW link ipx SPX and Bion Vines um a lot of these are probably going to",
    "start": "290320",
    "end": "295560"
  },
  {
    "text": "disappear eventually because I don't most of them don't support my named instances which basic L tells me that",
    "start": "295560",
    "end": "300600"
  },
  {
    "text": "that they're probably going to be exterminated before too long the Microsoft SQL Server service is",
    "start": "300600",
    "end": "307320"
  },
  {
    "start": "305000",
    "end": "305000"
  },
  {
    "text": "configured at install time um it's very tempting when it's when you're installing it to just go ahead and pick",
    "start": "307320",
    "end": "313280"
  },
  {
    "text": "they give you the option it's still there to choose local system and and then your password problems go away and",
    "start": "313280",
    "end": "318880"
  },
  {
    "text": "you don't have to worry about the rights and all this kind of mess and it's still there but don't do that um the reason is",
    "start": "318880",
    "end": "326800"
  },
  {
    "text": "because you know like any other service if someone somehow can make this service do something",
    "start": "326800",
    "end": "332360"
  },
  {
    "text": "unintended that's the level of context that they're going to get local system is too high of context for people to be",
    "start": "332360",
    "end": "339759"
  },
  {
    "text": "having um a better choice is a local user account right with minimal rights",
    "start": "339759",
    "end": "346800"
  },
  {
    "text": "including access to you know the files the SQL Server MDF files and all you",
    "start": "346800",
    "end": "353240"
  },
  {
    "text": "there C some certain registry entries they need to have access to but if you put that user in in that location at install time SQL Server will take care",
    "start": "353240",
    "end": "359800"
  },
  {
    "text": "of all that for you it'll make sure that that user has the rights to run SQL server but you need to create that user",
    "start": "359800",
    "end": "365080"
  },
  {
    "text": "ahead of time and if unless you have you know some kind of special requirement like for replication or something like",
    "start": "365080",
    "end": "371080"
  },
  {
    "text": "that in which case you might need to use a domain user right because that you may have a situation where you have to have",
    "start": "371080",
    "end": "376319"
  },
  {
    "text": "two servers communicating for you know a heterogeneous query or the two servers need to be linked for whatever reason um",
    "start": "376319",
    "end": "384000"
  },
  {
    "text": "in that case you probably end up having to use a domain user but in most cases a local user with minimal rights is what",
    "start": "384000",
    "end": "389240"
  },
  {
    "text": "you need be using all right SQL Server security",
    "start": "389240",
    "end": "394840"
  },
  {
    "start": "391000",
    "end": "391000"
  },
  {
    "text": "modes has two modes one is mixed both SQL server and windows authentication mode logins are allowed access in other",
    "start": "394840",
    "end": "402240"
  },
  {
    "text": "words you can have the nice name pair that you just provide to SQL server and",
    "start": "402240",
    "end": "408080"
  },
  {
    "text": "it'll let you in doesn't care about NT authentication at all and the other option is of course to use your windows",
    "start": "408080",
    "end": "414039"
  },
  {
    "text": "credential so what'll really happen is it'll store your Sid in the CSX logins table and then when you try to log into",
    "start": "414039",
    "end": "420400"
  },
  {
    "text": "the SQL Server it'll check your Sid against the Sid that it has in a sisx loging stable if they match you're logged",
    "start": "420400",
    "end": "426240"
  },
  {
    "text": "in um the mixed mode has a problem if you use if you're going to use the name",
    "start": "426240",
    "end": "431479"
  },
  {
    "text": "password pair you don't have strong authentication controls right you don't have password complexity requirements",
    "start": "431479",
    "end": "436759"
  },
  {
    "text": "you don't have lockout thresholds you don't have any of the really good stuff that you need to enforce good",
    "start": "436759",
    "end": "442080"
  },
  {
    "text": "authentication it's all gone um but it is provided for backward",
    "start": "442080",
    "end": "447960"
  },
  {
    "text": "compatibility and for um Windows 98 me installs because obviously Windows 98 me",
    "start": "447960",
    "end": "453720"
  },
  {
    "text": "doesn't support any type of NTI authentication so it has to be there for that",
    "start": "453720",
    "end": "459360"
  },
  {
    "start": "459000",
    "end": "459000"
  },
  {
    "text": "next Microsoft of course recommends that you use Windows authentication mode and every book that you read on SQL Server",
    "start": "459360",
    "end": "465360"
  },
  {
    "text": "Security will probably say use Windows authentication mode this is what we recommend uh main problem is um",
    "start": "465360",
    "end": "471759"
  },
  {
    "text": "Microsoft can't seem to take its own medicine it seems like every product that they release um uses the mixed mode",
    "start": "471759",
    "end": "477520"
  },
  {
    "text": "and uses standard SQL Server security does does not use the auth the uh integrated model um if you download any",
    "start": "477520",
    "end": "484080"
  },
  {
    "text": "of their reference applications from msdn.microsoft.com code you'll see they all use the",
    "start": "484080",
    "end": "489960"
  },
  {
    "text": "standard SQL Server security model many developers avoid anything that involves having to learn uh security model",
    "start": "489960",
    "end": "495680"
  },
  {
    "text": "reserve for IT personnel right because you know this means you have to understand how the N model works right",
    "start": "495680",
    "end": "501240"
  },
  {
    "text": "you have to understand about trusts and and and how the you know when I log into as this user context can I can I go to",
    "start": "501240",
    "end": "507599"
  },
  {
    "text": "this machine uh what happens in a web farm right when I have got 10 different users and they're all a different",
    "start": "507599",
    "end": "513200"
  },
  {
    "text": "Anonymous user local to that machine and I have to access a SQL server on the back end there's a lot of complexity issues that are involved with using the",
    "start": "513200",
    "end": "519760"
  },
  {
    "text": "integrated model and usually developers just want to bypass that stuff and try to get their requirements",
    "start": "519760",
    "end": "527320"
  },
  {
    "text": "done all right mode guidelines generally this is what we like to go by if if you're doing Windows",
    "start": "527959",
    "end": "533800"
  },
  {
    "start": "528000",
    "end": "528000"
  },
  {
    "text": "security um it's a good fit where the SQL Server is exposed to possible attackers um if it's sitting in your",
    "start": "533800",
    "end": "540560"
  },
  {
    "text": "internet this is probably a good a place it's going to be as exposed as anywhere right um or heaven forbid it's connected",
    "start": "540560",
    "end": "546800"
  },
  {
    "text": "to the internet um you definitely want to use something stronger than the mixed",
    "start": "546800",
    "end": "552959"
  },
  {
    "text": "mode security right because there's you don't have any way to stop somebody from brute forcing their way in there's",
    "start": "552959",
    "end": "558600"
  },
  {
    "text": "nothing there's no threshold there's no intrusion detection mechanism built into SQL Server to tell you that somebody's",
    "start": "558600",
    "end": "564600"
  },
  {
    "text": "sitting there all day long trying to guess the sa account password",
    "start": "564600",
    "end": "570040"
  },
  {
    "text": "um if you have heavy auditing requirements it's also a good fit or granular security requirements mixed",
    "start": "570040",
    "end": "575120"
  },
  {
    "text": "mode is um it's probably a good fit where the the SQL Server is completely",
    "start": "575120",
    "end": "581200"
  },
  {
    "text": "isolated and probably just tunneled to a particular host um shared context is acceptable or",
    "start": "581200",
    "end": "588040"
  },
  {
    "text": "administrative overhead and supporting multiple security models is acceptable you know when is that acceptable I don't",
    "start": "588040",
    "end": "593240"
  },
  {
    "text": "know but it may be in some cases uh a need for simple connectivity as cost of weak access control is acceptable",
    "start": "593240",
    "end": "600600"
  },
  {
    "text": "um like I said why was weak Access Control acceptable maybe only in a case where there's a specific tunnel that's",
    "start": "600600",
    "end": "607040"
  },
  {
    "text": "set up for these two hosts to communicate and you're fairly certain about its security",
    "start": "607040",
    "end": "612640"
  },
  {
    "text": "but good luck SQL Server logins are kept in the",
    "start": "612640",
    "end": "617760"
  },
  {
    "text": "Cs logins table the SIDS of users and groups are stored Windows authentication logins 16 by gur is generated for the",
    "start": "617760",
    "end": "623839"
  },
  {
    "text": "normal SQL Server native logins that we were talking about um the users are stored in individual databases this user",
    "start": "623839",
    "end": "629920"
  },
  {
    "text": "table determines who has access to database objects um can be assigned to various roles and user privileges can be",
    "start": "629920",
    "end": "637480"
  },
  {
    "text": "managed using Grant deny and revoke statements all right the roles fall into",
    "start": "637480",
    "end": "643680"
  },
  {
    "start": "641000",
    "end": "641000"
  },
  {
    "text": "several categories um CIS admins which is the role that we're talking it's the main role that person can do anything",
    "start": "643680",
    "end": "649480"
  },
  {
    "text": "inside a sqle server that's the sa account um that you often see when you're using standard SQL security is",
    "start": "649480",
    "end": "656680"
  },
  {
    "text": "the CIS admin um you can also Al create you can add users to your sisx logins",
    "start": "656680",
    "end": "663519"
  },
  {
    "text": "tables through Windows authentication and Grant them access to the CIS admin role effectively making them essay as",
    "start": "663519",
    "end": "670920"
  },
  {
    "text": "well all right C2 level auditing this is something that's been added for SQL Server 2000 um this mode will allow you",
    "start": "671360",
    "end": "679320"
  },
  {
    "start": "672000",
    "end": "672000"
  },
  {
    "text": "to do really intensive auditing if you've ever looked at the SQL Server log as it exists today it's really just an",
    "start": "679320",
    "end": "685320"
  },
  {
    "text": "event log tells you things like you know somebody somebody did an extended St procedure and they loaded this dll",
    "start": "685320",
    "end": "691920"
  },
  {
    "text": "somebody somebody did a backup somebody did something and it it failed a replication task failed or something",
    "start": "691920",
    "end": "698279"
  },
  {
    "text": "like that it doesn't tell you really detailed information about um what query",
    "start": "698279",
    "end": "703399"
  },
  {
    "text": "somebody was running when something failed or what specifically is occurring on the server at this exact moment you",
    "start": "703399",
    "end": "709079"
  },
  {
    "text": "never really know it's not it's more like your you know like an NT application log or something like that",
    "start": "709079",
    "end": "714160"
  },
  {
    "text": "just telling you key events the C2 audit mode will give you the capability to actually log everything that's occurring",
    "start": "714160",
    "end": "720040"
  },
  {
    "text": "in a SQL Server everything connections disconnections attempted logins um every",
    "start": "720040",
    "end": "726200"
  },
  {
    "text": "query that somebody issues um if you have heavy auditing requirements this is",
    "start": "726200",
    "end": "731440"
  },
  {
    "text": "probably a good fit for you but uh you're going to need a big hard drive I'm go ahead and warn you on that one all right features that affect",
    "start": "731440",
    "end": "738320"
  },
  {
    "start": "736000",
    "end": "736000"
  },
  {
    "text": "security good and bad multiple instancing could be good could be bad could be good that you're isolating this",
    "start": "738320",
    "end": "745000"
  },
  {
    "text": "person's logins from this other company's logins but it could be bad that all of these Lins are existing on the same machine and if that host is",
    "start": "745000",
    "end": "751480"
  },
  {
    "text": "compromised every person's instance of SQL server on that host is also compromised um the variant data",
    "start": "751480",
    "end": "758320"
  },
  {
    "text": "type I don't know who thought that was a good idea somebody thought it was a good idea um actually the variant is is a",
    "start": "758320",
    "end": "764800"
  },
  {
    "text": "little dangerous because it allows you to fudge the data types A little bit when you're injecting SQL code which",
    "start": "764800",
    "end": "770720"
  },
  {
    "text": "we'll talk about later um the crypto API is now used for all internal encryption thank goodness because they used to used",
    "start": "770720",
    "end": "776240"
  },
  {
    "text": "some proprietary encryption mechanisms for storing uh information which they now",
    "start": "776240",
    "end": "782720"
  },
  {
    "text": "stop using delegation is Now supported for SQL Server um updatable Federated",
    "start": "782720",
    "end": "788639"
  },
  {
    "text": "database servers which are actually kind of cool um user defined functions and cascading referential Integrity I can't",
    "start": "788639",
    "end": "795040"
  },
  {
    "text": "go into details of a lot of these things but it's all well documented in books",
    "start": "795040",
    "end": "800480"
  },
  {
    "text": "online all right this is the this was the end of the boring he's regurgitating",
    "start": "800480",
    "end": "805519"
  },
  {
    "text": "books online section and just telling us how SQL Server works but uh hope you at least got out of this the",
    "start": "805519",
    "end": "812079"
  },
  {
    "text": "key ways that the SQL Server allows people to authenticate and some of the",
    "start": "812079",
    "end": "817120"
  },
  {
    "text": "exposures that you can probably already start to see as far as the authentication mechanisms that are being",
    "start": "817120",
    "end": "822760"
  },
  {
    "text": "used all right now let's talk about how people are going to attack your SQL",
    "start": "822760",
    "end": "827880"
  },
  {
    "start": "823000",
    "end": "823000"
  },
  {
    "text": "servers um we'll we'll start off with just some fingerprinting and Discovery how are",
    "start": "827880",
    "end": "833560"
  },
  {
    "text": "they going to find them in the first place how are they going to acquire access how are they going to try to grab a username password pair or or grab some",
    "start": "833560",
    "end": "840800"
  },
  {
    "text": "NT contacts so they can access my data um privilege escalation once they grab",
    "start": "840800",
    "end": "846920"
  },
  {
    "text": "some type of context what are they going to do to try to use that to get a higher level of context maybe access the",
    "start": "846920",
    "end": "852800"
  },
  {
    "text": "operating system for example and potential pitfalls custom dlls um some",
    "start": "852800",
    "end": "858320"
  },
  {
    "text": "application requirements and source code disclosure all right to start off with",
    "start": "858320",
    "end": "866440"
  },
  {
    "start": "863000",
    "end": "863000"
  },
  {
    "text": "um finding a Target you know anybody's running I is probably a pretty good Target right I mean who uses who uses",
    "start": "866440",
    "end": "873199"
  },
  {
    "text": "anything but SQL Server if they're already using I I don't know I guess some people out there uh run Oracle on",
    "start": "873199",
    "end": "879160"
  },
  {
    "text": "NT but I don't know many of them um a good way to find out obviously you know",
    "start": "879160",
    "end": "885360"
  },
  {
    "text": "the standard stuff right you can do the tell net you can do the the head directive and find out what it is go to Netcraft be glad to had tell you exactly",
    "start": "885360",
    "end": "892079"
  },
  {
    "text": "what they're using actually you'll probably find out right away when you see you know ASP on every request you'll know where what you're dealing with um",
    "start": "892079",
    "end": "899800"
  },
  {
    "text": "you can dig for hints about the target database usage you know go to you know go to De news groups. google.com I need",
    "start": "899800",
    "end": "906720"
  },
  {
    "text": "to update that um you know they got bought out but if you if you go there you'll still get sent to the right place",
    "start": "906720",
    "end": "911959"
  },
  {
    "text": "it'll just say Google all over the place um but if you go to the discussion boards you can actually just do a search",
    "start": "911959",
    "end": "917759"
  },
  {
    "text": "and say hey I'm you know I'm interested in X company and I'm interested in SQL",
    "start": "917759",
    "end": "922920"
  },
  {
    "text": "you know and you'll put it in as search criteria and you'll see people asking questions right people in those companies somewhere somehow now they a",
    "start": "922920",
    "end": "929759"
  },
  {
    "text": "problem with SQL Server so they'll go to the news groups and they'll say you know I'm having this problem with this query it really shouldn't work like this it it",
    "start": "929759",
    "end": "936160"
  },
  {
    "text": "should do this other thing oh oh here's the query you know and they they'll post the whole thing up there and then",
    "start": "936160",
    "end": "941240"
  },
  {
    "text": "somebody will come back and say well you forgot to do this you forgot to do that it comes pretty obvious what kind of databases they're using inside uh inside",
    "start": "941240",
    "end": "948720"
  },
  {
    "text": "their their operation on top of that you can always just go to their site and if they're hiring what they probably are um",
    "start": "948720",
    "end": "955519"
  },
  {
    "text": "they'll tell you what kind of skills they're looking for if they're looking for SQL Server skills there you",
    "start": "955519",
    "end": "961480"
  },
  {
    "text": "go all right good news um like I said I'm just gonna I'm",
    "start": "961759",
    "end": "968160"
  },
  {
    "start": "962000",
    "end": "962000"
  },
  {
    "text": "not going to beat this one into the ground but the the the gist of this is if people are gonna if you're gonna have",
    "start": "968160",
    "end": "973199"
  },
  {
    "text": "people asking questions have them do it anonymously they don't have to do it with like the name of the company you",
    "start": "973199",
    "end": "978920"
  },
  {
    "text": "know soand so at.com you know they could use a free me email address something like that they'll still get the answers",
    "start": "978920",
    "end": "984839"
  },
  {
    "text": "to their problems but don't create don't let information about what's going on",
    "start": "984839",
    "end": "990199"
  },
  {
    "text": "behind you know your firewall or so forth kind of leak out and especially don't let them post source code that's",
    "start": "990199",
    "end": "995959"
  },
  {
    "text": "that's that's real bad all right how they going to find it",
    "start": "995959",
    "end": "1001560"
  },
  {
    "start": "999000",
    "end": "999000"
  },
  {
    "text": "Well the easy way right they'll just scan looking for 1433 the 1433 is the",
    "start": "1001560",
    "end": "1006880"
  },
  {
    "text": "default port for SQL Server listening on IP sockets which we already said is the",
    "start": "1006880",
    "end": "1012600"
  },
  {
    "text": "default you'll find it listening on 1433 now you can just do a sweep a scan maybe",
    "start": "1012600",
    "end": "1017800"
  },
  {
    "text": "it's in their DMZ maybe you're already on the internal Network and you just want to sweep around and see who's installed the thing",
    "start": "1017800",
    "end": "1023880"
  },
  {
    "text": "internally it'll they'll they stick out like a sore thumb um there's also now UDP Port 1434 thanks to a uh this",
    "start": "1023880",
    "end": "1032038"
  },
  {
    "text": "multiple instancing that we have um the reason that 1433 is now listening is",
    "start": "1032039",
    "end": "1038600"
  },
  {
    "text": "that it's a little more difficult to connect to a server that has five instances of SQL server and then tell it",
    "start": "1038600",
    "end": "1044959"
  },
  {
    "text": "exactly which instance we're interested in and that's where the multiple instancing comes in you had the cap it has the capability to ask the SQL Server",
    "start": "1044959",
    "end": "1052840"
  },
  {
    "text": "hey what's running what instances of SQL Server are running on this machine and get that information so they can make the proper connection for obvious",
    "start": "1052840",
    "end": "1059520"
  },
  {
    "text": "reasons I have five instances of SQL Server they can't all be listening on 1433 right the others are listening on",
    "start": "1059520",
    "end": "1066000"
  },
  {
    "text": "something else so they'll have to ask to find out what those instances are",
    "start": "1066000",
    "end": "1071400"
  },
  {
    "text": "listening on so here's a simp an example of a simple scan right you scan this host you",
    "start": "1071400",
    "end": "1078080"
  },
  {
    "text": "see 14 33 it's pretty",
    "start": "1078080",
    "end": "1083480"
  },
  {
    "text": "self-explanatory multiple instancing capabilities SQL Server 2000 make a numeration a functional requirement",
    "start": "1084320",
    "end": "1090000"
  },
  {
    "text": "specially formed UDP packet directed at Port 1434 will cause the SQL Server 2000 listener service to divulge information",
    "start": "1090000",
    "end": "1096440"
  },
  {
    "text": "about every instance of SQL Server running here's some information that's going to be included instance names all",
    "start": "1096440",
    "end": "1102320"
  },
  {
    "text": "of the net libs that are supported on that machine TCP ports and pipe names so",
    "start": "1102320",
    "end": "1107400"
  },
  {
    "text": "you can change the pipe names if you want to you think you're being all clever about well I'll change the pipe name to something that's not uh that's",
    "start": "1107400",
    "end": "1113000"
  },
  {
    "text": "not the default and then they'll never find it oh they'll find it clustering support is uh I don't know why you have",
    "start": "1113000",
    "end": "1120159"
  },
  {
    "text": "to know that the server is clustered and why this was important but they'll tell you whether or not the server is clustered which makes your really juicy",
    "start": "1120159",
    "end": "1127200"
  },
  {
    "text": "Target stick out even more now since the listener may exist on multiple machines it's possible to send",
    "start": "1127200",
    "end": "1133200"
  },
  {
    "start": "1130000",
    "end": "1130000"
  },
  {
    "text": "a broadcast packet to UDP Port 1434 discover all instances of SQL Server 2000 on a subnet",
    "start": "1133200",
    "end": "1140240"
  },
  {
    "text": "um this is actually a lot of fun you got a large big flat Network you can uh you can send this thing out and just it's",
    "start": "1140240",
    "end": "1147880"
  },
  {
    "text": "unbelievable you can start out with just using the osql DL command that'll just give you a list of the server names",
    "start": "1147880",
    "end": "1153240"
  },
  {
    "text": "that's what they give you right there's don't need any special tools to do that but they strip out all the good information and they just send out the",
    "start": "1153240",
    "end": "1159840"
  },
  {
    "text": "packet and they just strip off all the server names and give those to",
    "start": "1159840",
    "end": "1165280"
  },
  {
    "start": "1165000",
    "end": "1165000"
  },
  {
    "text": "you so here's an example of a uh Discovery Pack packet this was captured using snort and it just shows",
    "start": "1165360",
    "end": "1173200"
  },
  {
    "text": "um I sent out a packet to the network or in this case actually directed at a particular host and he sends back to me",
    "start": "1173200",
    "end": "1181600"
  },
  {
    "text": "this detailed information inside the packet server name instance name clustered version the version",
    "start": "1181600",
    "end": "1186880"
  },
  {
    "text": "information is actually very important right because you can look at that version information and tell what patches they've applied so it's good to",
    "start": "1186880",
    "end": "1192120"
  },
  {
    "text": "know the exact version that you're dealing with you can tell immediately exactly what the server is vulnerable",
    "start": "1192120",
    "end": "1197440"
  },
  {
    "start": "1197000",
    "end": "1197000"
  },
  {
    "text": "to all right right and uh in L this uh the osql utility not providing all this",
    "start": "1197440",
    "end": "1203240"
  },
  {
    "text": "information and and having to use snort to do this which was kind of cumbersome if you have you know a thousand hosts or",
    "start": "1203240",
    "end": "1209480"
  },
  {
    "text": "whatever and you want to just search through and find out what the SQL servers are um I went ahead and wrote this SQL ping utility to go through send",
    "start": "1209480",
    "end": "1215840"
  },
  {
    "text": "out the same packet just like osql does but actually take all the responses and and decode them so that you can see all",
    "start": "1215840",
    "end": "1222440"
  },
  {
    "text": "the detailed information um I've posted it up on my site and uh the source codee's also there just to make sure you",
    "start": "1222440",
    "end": "1228720"
  },
  {
    "text": "know if you're really paranoid and you want to make sure I haven't put some kind of Trojan in there you can just download the source code and compile it",
    "start": "1228720",
    "end": "1235000"
  },
  {
    "text": "yourself next all right account acquisition",
    "start": "1235000",
    "end": "1240679"
  },
  {
    "text": "um attacks the inherit weak this is the brute force method right this is somebody that's just stuck the thing in",
    "start": "1240679",
    "end": "1247000"
  },
  {
    "text": "their DMZ didn't protect it at all didn't didn't configure the firewall to to block 1433 they have the complete",
    "start": "1247000",
    "end": "1254679"
  },
  {
    "text": "capability to just attack this thing all day long or it could be just an attack internally right you could have SQL Server installed on your machine and the",
    "start": "1254679",
    "end": "1262120"
  },
  {
    "text": "guy in the next Cube decides he wants to to see who you're writing email to so he wants to try to gain access to your",
    "start": "1262120",
    "end": "1267200"
  },
  {
    "text": "machine so he can just sit there all day and try to bruteforce your sa account if you're in the mixed security mode um",
    "start": "1267200",
    "end": "1273720"
  },
  {
    "text": "there's multiple freear tools to do this they all do the same thing pretty much they attack saay it's a it's an easy",
    "start": "1273720",
    "end": "1279840"
  },
  {
    "text": "target right it's always there you can't get rid of it you can't rename it you can't disable it so if you've installed",
    "start": "1279840",
    "end": "1286080"
  },
  {
    "text": "SQL server and it's in mixed mode it's just a matter of time um like I said we won't beat it we",
    "start": "1286080",
    "end": "1293200"
  },
  {
    "text": "won't say it again but you know it doesn't have all that lockout capability so and I I always say that I'm never",
    "start": "1293200",
    "end": "1298559"
  },
  {
    "text": "going to say it but I put the thing on here don't leave the sa password no just don't do that don't do that um even if",
    "start": "1298559",
    "end": "1306480"
  },
  {
    "text": "you decide to use mixed mode or not mixed mode but you decide to use Windows authentication mode go in and assign an",
    "start": "1306480",
    "end": "1312559"
  },
  {
    "text": "sa password anyway nobody can use it right but in some point somehow if somebody switches the mode back to mixed",
    "start": "1312559",
    "end": "1319600"
  },
  {
    "text": "you won't immediately be vulnerable sniffing all right",
    "start": "1319600",
    "end": "1326520"
  },
  {
    "start": "1323000",
    "end": "1323000"
  },
  {
    "text": "there's this will probably you probably see this slide in every in every presentation right somebody's always sniffing if you sniff and you're",
    "start": "1326520",
    "end": "1333559"
  },
  {
    "text": "watching somebody log in to a SQL Server via um Windows you know just",
    "start": "1333559",
    "end": "1339840"
  },
  {
    "text": "stand not windows but standard SQL authentication you will see the name password pair in plain text I I do in my",
    "start": "1339840",
    "end": "1346880"
  },
  {
    "text": "hand like this because it's not really plain you you can't see it flying across it's it's OB fiscated it's exord um but",
    "start": "1346880",
    "end": "1354000"
  },
  {
    "text": "it's there anybody that that knows the the scheme and anybody that knows exor and that should be everybody in here",
    "start": "1354000",
    "end": "1359919"
  },
  {
    "text": "knows that you can easily turn it right back into plain text um the TCP traffic uh the non SSL",
    "start": "1359919",
    "end": "1367679"
  },
  {
    "text": "traffic anyways just pretty much just it's it's there for the taking and you don't even need the credentials right",
    "start": "1367679",
    "end": "1372880"
  },
  {
    "text": "you can just watch the data maybe you're just interested in the the credit card numbers that are flying by or whatever",
    "start": "1372880",
    "end": "1378039"
  },
  {
    "text": "so there's lot of information to be had there um connection",
    "start": "1378039",
    "end": "1383279"
  },
  {
    "text": "strings this is another one people always ask me where do you store the connection string right there's some",
    "start": "1383279",
    "end": "1389880"
  },
  {
    "text": "it's always going to end up somebody's going to grab this thing so what's a safe place to put it people tell me don't put it in the global ASA file",
    "start": "1389880",
    "end": "1396919"
  },
  {
    "text": "because as soon as the next I source code disclosure of the week comes out you know they'll be looking at it and",
    "start": "1396919",
    "end": "1403039"
  },
  {
    "text": "then they can just go right for it well you know it comes back to this they shouldn't be able to connect to it in the first place if they can connect to",
    "start": "1403039",
    "end": "1408279"
  },
  {
    "text": "it the first place you got a problem so hiding the string is kind of redundant um there's really no good",
    "start": "1408279",
    "end": "1415520"
  },
  {
    "text": "place to keep it what you want to do and we'll talk about later is not necessarily hide the connection string so much because you shouldn't be a",
    "start": "1415520",
    "end": "1421559"
  },
  {
    "text": "secret in there there shouldn't be anything in that connection string that you're trying to hide because it's going to be exposed it's just a matter of",
    "start": "1421559",
    "end": "1428880"
  },
  {
    "text": "time and to reiterate the point these are just a sampling a snippet of the the",
    "start": "1428880",
    "end": "1435320"
  },
  {
    "start": "1429000",
    "end": "1429000"
  },
  {
    "text": "latest uh I source code disclosures in the past years just my little rant we'll",
    "start": "1435320",
    "end": "1442520"
  },
  {
    "text": "move on past that all right privilege escalation um besides the you know",
    "start": "1442520",
    "end": "1450760"
  },
  {
    "text": "obvious capabilities of someone that that can get into the database and try to munge around with data let's let's",
    "start": "1450760",
    "end": "1456880"
  },
  {
    "text": "just say someone gets in and and does get an account that has the capability to run XP command shell which in this",
    "start": "1456880",
    "end": "1462760"
  },
  {
    "text": "case would be sa it's more common than you think almost every developer that I know at some point some time uses essay",
    "start": "1462760",
    "end": "1469799"
  },
  {
    "text": "and then forgets to go back and create an account before deploying the application um if you use essay or you",
    "start": "1469799",
    "end": "1475039"
  },
  {
    "text": "use an account with administrative privileges that person when they gain that level of context has capability to",
    "start": "1475039",
    "end": "1480440"
  },
  {
    "text": "run XP command shell you'll see it over and over and over again this gives them access to the operating system with the",
    "start": "1480440",
    "end": "1486039"
  },
  {
    "text": "level of security context that the SQL Server is running with right which in a lot of cases sadly local",
    "start": "1486039",
    "end": "1495080"
  },
  {
    "text": "system okay uh let's see by default nonis",
    "start": "1495440",
    "end": "1500919"
  },
  {
    "text": "admins don't have access to XP command showell but that doesn't mean that you know we want to minimize that this thing is still very you know important piece",
    "start": "1500919",
    "end": "1508360"
  },
  {
    "text": "of the security problem um just keep in mind that they can access and if they",
    "start": "1508360",
    "end": "1513799"
  },
  {
    "text": "can escalate their privilege to sa they can access the uh the actual operating system um you can actually create a",
    "start": "1513799",
    "end": "1521960"
  },
  {
    "text": "proxy account under which nonis admins can use XP command shell because maybe there's something that you want them to be able to Shell out and run but but at",
    "start": "1521960",
    "end": "1528640"
  },
  {
    "text": "least let them run that with a lower level of privilege than whatever the SQL Server itself is running",
    "start": "1528640",
    "end": "1536080"
  },
  {
    "text": "at okay all right some other methods XP",
    "start": "1536360",
    "end": "1541880"
  },
  {
    "start": "1538000",
    "end": "1538000"
  },
  {
    "text": "regg read XP reg write these are St extended store procedures and just for anybody that doesn't know extended store",
    "start": "1541880",
    "end": "1547000"
  },
  {
    "text": "procedures are basically dlls that that you can plug in SQL Server to add additional functionality now the ones",
    "start": "1547000",
    "end": "1554039"
  },
  {
    "text": "I'm talking about like XP reg read and XP reg right here these are included with SQL Server there's a long list of",
    "start": "1554039",
    "end": "1559440"
  },
  {
    "text": "them and almost none of them are documented so um it's really dangerous um to you can actually poke around in",
    "start": "1559440",
    "end": "1566840"
  },
  {
    "text": "there you'll see a lot of things that uh are really um great for enumeration as far as extended store procedures if you",
    "start": "1566840",
    "end": "1572960"
  },
  {
    "text": "have the time it's worth taking a look at and uh just a couple right there that are",
    "start": "1572960",
    "end": "1578399"
  },
  {
    "text": "really trouble or R read and R WR because you give the capability to you know read write from the registry that's not good um sp8 create this is for",
    "start": "1578399",
    "end": "1585360"
  },
  {
    "text": "automation you can actually start your own automation so can you know fire up",
    "start": "1585360",
    "end": "1590559"
  },
  {
    "text": "you know Ado or whatever it is you're interested in automating and uh do",
    "start": "1590559",
    "end": "1595840"
  },
  {
    "text": "whatever you want really it's like its own programming language um enumeration functions and",
    "start": "1595840",
    "end": "1603600"
  },
  {
    "text": "the open rowet command which gives you heterogeneous query capability to actually within this query from like",
    "start": "1603600",
    "end": "1609440"
  },
  {
    "text": "sitting at a particular SQL Server I can issue query against another SQL Server so in a sense I can use one SQL Server",
    "start": "1609440",
    "end": "1617679"
  },
  {
    "text": "as a launch ing pad for an attack against another SQL",
    "start": "1617679",
    "end": "1622679"
  },
  {
    "start": "1623000",
    "end": "1623000"
  },
  {
    "text": "Server all right extended store procedures have been found to have buffer over overflow vulnerabilities um",
    "start": "1624880",
    "end": "1631360"
  },
  {
    "text": "most of these have been patched and the reason that I don't take the slide off because the patches exist you know if",
    "start": "1631360",
    "end": "1637520"
  },
  {
    "text": "you're not putting the patches on then you probably got a hundred other problems but the reason this is important because they didn't really fix",
    "start": "1637520",
    "end": "1643799"
  },
  {
    "text": "anything what they did was they fixed the underlying dll problems but they",
    "start": "1643799",
    "end": "1649679"
  },
  {
    "text": "didn't fix the real problem which was the fact that these store procedures are are kind of wrapped with an API and that",
    "start": "1649679",
    "end": "1656440"
  },
  {
    "text": "API is still vulnerable it doesn't do any type of input validation or or balance checking so if you write your",
    "start": "1656440",
    "end": "1661840"
  },
  {
    "text": "own extended store procedures you're just as vulnerable there's nothing in SQL Server that's going to protect your",
    "start": "1661840",
    "end": "1668200"
  },
  {
    "text": "dlls from buffer overflows so it's very important that if you write your own extended store procedures that you are",
    "start": "1668200",
    "end": "1675120"
  },
  {
    "text": "very careful about doing bounce checking because SQL server is not going to help you all right they're in now what uh",
    "start": "1675120",
    "end": "1682279"
  },
  {
    "start": "1680000",
    "end": "1680000"
  },
  {
    "text": "create back door um they can go ahead and create themselves an NT account you",
    "start": "1682279",
    "end": "1687840"
  },
  {
    "text": "know if this is if they have the capabilities to run XP command shell um insert Trojan extended store procedures",
    "start": "1687840",
    "end": "1693519"
  },
  {
    "text": "to capture passwords data and events they can do this depending on the level of context they've got maybe they're a",
    "start": "1693519",
    "end": "1698600"
  },
  {
    "text": "dbo um maybe they just have you know the capability to actually enter some uh some data manipulation language um they",
    "start": "1698600",
    "end": "1706320"
  },
  {
    "text": "can use tftp to pull in rootkits if they can actually issue shell commands um you see that one all the time right you can",
    "start": "1706320",
    "end": "1712760"
  },
  {
    "text": "read tftp it's on every copy of windows so it's a great mechanism for pulling in",
    "start": "1712760",
    "end": "1719200"
  },
  {
    "text": "more Trojan code for you to be running on that SQL Server itself um SQL Server",
    "start": "1719200",
    "end": "1724679"
  },
  {
    "text": "makes a good launching pad for taxus other host it's probably sitting some nice cozy location in the back where",
    "start": "1724679",
    "end": "1730799"
  },
  {
    "text": "other goodies are right let's forget the fact that all the real good data is probably stored right there in your SQL",
    "start": "1730799",
    "end": "1736159"
  },
  {
    "text": "Server it's probably just sitting right next to your olap server where all your nice you know decision support system",
    "start": "1736159",
    "end": "1741519"
  },
  {
    "text": "data is sitting um there's all kinds of Juicy targets that are usually adjacent to a SQL Server it makes a really good",
    "start": "1741519",
    "end": "1747880"
  },
  {
    "text": "launching pad for attacks and that why you can go ahead and install a proxy and make it a proxy for launching more",
    "start": "1747880",
    "end": "1753600"
  },
  {
    "text": "attacks obviously all the taxs will appear that they're coming from this your SQL Server um take your data and",
    "start": "1753600",
    "end": "1759960"
  },
  {
    "text": "make you suffer data diddling which is always fun right if it's your if it's a competitor you can go in there and don't",
    "start": "1759960",
    "end": "1766960"
  },
  {
    "text": "don't do anything don't don't put naked pictures of naked women on his front page and don't don't go in there and",
    "start": "1766960",
    "end": "1773600"
  },
  {
    "text": "tear the data apart so they know what's wrong just tweak things around a little bit you know put put some zeros and some",
    "start": "1773600",
    "end": "1780679"
  },
  {
    "text": "bad places and delete a few bits here and there um dangerous stuff and as",
    "start": "1780679",
    "end": "1787440"
  },
  {
    "text": "usual the possibilities are limited only by imagination all right you defenses",
    "start": "1787440",
    "end": "1794159"
  },
  {
    "start": "1791000",
    "end": "1791000"
  },
  {
    "text": "um these are just some things that you could you could do um basically what you want to do what you",
    "start": "1794159",
    "end": "1800320"
  },
  {
    "text": "really want to do is design your network properly right we just had a great presentation on on you know actually you",
    "start": "1800320",
    "end": "1807279"
  },
  {
    "text": "know setting up a a very nice well-defended multi-tiered uh you know firewall system",
    "start": "1807279",
    "end": "1814519"
  },
  {
    "text": "where you know you don't put this SQL server in a place where it can is exposed to attack right it only should",
    "start": "1814519",
    "end": "1820960"
  },
  {
    "text": "be connecting to one thing and that's whatever host it is that it's actually providing services to it shouldn't be",
    "start": "1820960",
    "end": "1826279"
  },
  {
    "text": "just sitting there waiting for all kinds of people to be interacting with it",
    "start": "1826279",
    "end": "1831399"
  },
  {
    "text": "um protect it it's it's very important piece of uh of your infrastructure it",
    "start": "1831399",
    "end": "1836440"
  },
  {
    "text": "should be as as protected as that backup server um that's holding all of your keys for encryption right treat it like",
    "start": "1836440",
    "end": "1844240"
  },
  {
    "text": "that protect it um you could if you want to create auto start store procedures",
    "start": "1844240",
    "end": "1849640"
  },
  {
    "text": "initiate a trace so that you can watch the kinds of things that are occurring on the server as obviously this is for",
    "start": "1849640",
    "end": "1854760"
  },
  {
    "text": "advanced logging right it's hard to it's hard to defend or hard to do any type of forensics after an attack if you don't",
    "start": "1854760",
    "end": "1860919"
  },
  {
    "text": "have decent logging in place so having an auto start store procedure to initiate a trace is is useful and the",
    "start": "1860919",
    "end": "1866440"
  },
  {
    "text": "fact that you're going to have more detailed information when something suspicious occurs um I've got profiler",
    "start": "1866440",
    "end": "1873760"
  },
  {
    "text": "here can use can be used to input records into an audit log and so forth the problem with the profiler is it's",
    "start": "1873760",
    "end": "1879440"
  },
  {
    "text": "very useful but it's also resource intensive so if you're using it you're probably using extra processor you know",
    "start": "1879440",
    "end": "1887360"
  },
  {
    "text": "you you using the processor a little more than you should and you know it's it's got a gooey you know and you know",
    "start": "1887360",
    "end": "1892519"
  },
  {
    "text": "that's that's tearing you apart so maybe for situations where you're testing an",
    "start": "1892519",
    "end": "1898720"
  },
  {
    "text": "application or you're you're doing something specific I think it would probably be more useful in fact um I'll show you a really good example of when",
    "start": "1898720",
    "end": "1905480"
  },
  {
    "text": "you want to use profiler in uh building your applications",
    "start": "1905480",
    "end": "1910559"
  },
  {
    "text": "um like I said I I can't say enough that just completely isolate the SQL server and under no circumstances should",
    "start": "1910559",
    "end": "1916960"
  },
  {
    "text": "anybody have any direct connectivity to for that Port that we were talking about 1433 from the Internet or from any",
    "start": "1916960",
    "end": "1923320"
  },
  {
    "text": "untrusted network or from a trusted Network why should your internal users have access to it",
    "start": "1923320",
    "end": "1928840"
  },
  {
    "text": "either sensible configuration management will help secure SQL Server itself take the time to scan your networks determine",
    "start": "1928840",
    "end": "1935960"
  },
  {
    "start": "1929000",
    "end": "1929000"
  },
  {
    "text": "what people on the inside and the outside can access brute force your own systems to be sure password complexity",
    "start": "1935960",
    "end": "1941480"
  },
  {
    "text": "and account policies if using Windows security are sufficient um it's very simple to write your own utilities if",
    "start": "1941480",
    "end": "1947480"
  },
  {
    "text": "you want to to to uh audit SQL Server logins if you're still using them if you're still using you know Windows",
    "start": "1947480",
    "end": "1954080"
  },
  {
    "text": "native SQL Server authentication it's easy to audit those things you can brute force them with ease so have at it it's",
    "start": "1954080",
    "end": "1960840"
  },
  {
    "text": "something you should be doing at very least to find out what the level of complexity is than all right now we get to the",
    "start": "1960840",
    "end": "1967639"
  },
  {
    "start": "1966000",
    "end": "1966000"
  },
  {
    "text": "really good stuff yeah this is this is where it really gets fun um because you",
    "start": "1967639",
    "end": "1973600"
  },
  {
    "text": "know people are getting I don't know this is my opinion I think people in some cases are actually starting to get better at setting up decent perimeter",
    "start": "1973600",
    "end": "1979600"
  },
  {
    "text": "networks putting firewalls in place having a firewall up front and a firewall find this and another firewall",
    "start": "1979600",
    "end": "1984799"
  },
  {
    "text": "everybody thinks they got a firewall and they're safe but this type of uh this type of attack that we're going to talk",
    "start": "1984799",
    "end": "1990600"
  },
  {
    "text": "about bypasses the firewall entirely because it goes to the very heart of what an application is supposed to be",
    "start": "1990600",
    "end": "1996600"
  },
  {
    "text": "providing um and because of that it it's",
    "start": "1996600",
    "end": "2001840"
  },
  {
    "text": "you can do all things right you can follow all the guidelines for good Network design you can buy the best",
    "start": "2001840",
    "end": "2008880"
  },
  {
    "text": "security products available and you will still be vulnerable to a poorly written",
    "start": "2008880",
    "end": "2015840"
  },
  {
    "text": "application so in a sense we probably could call the setion application",
    "start": "2015840",
    "end": "2020880"
  },
  {
    "text": "hacking because that's what it really is all right it's not specific to SQL",
    "start": "2020880",
    "end": "2026159"
  },
  {
    "start": "2024000",
    "end": "2024000"
  },
  {
    "text": "Server um we're using SQL server in this example because that's that's just",
    "start": "2026159",
    "end": "2031399"
  },
  {
    "text": "happens to be my area of expertise but the same things that we're doing here can be done to Oracle MySQL db2 sbase",
    "start": "2031399",
    "end": "2039639"
  },
  {
    "text": "they're all vulnerable to this to some degree not using the exact same methods perhaps that we're going to use but the",
    "start": "2039639",
    "end": "2046880"
  },
  {
    "text": "problem is not related to SQL Server per se the problem is related to bad",
    "start": "2046880",
    "end": "2052520"
  },
  {
    "text": "coding bad input validation bad SQL server command",
    "start": "2052520",
    "end": "2059158"
  },
  {
    "text": "assembly all right SQL injection attacks rarely alert IDs systems which is really good right you me you nowadays you get",
    "start": "2059159",
    "end": "2066079"
  },
  {
    "text": "kind of paranoid if you want to you know just do it an audit of somebody you got to call the ISP and you get all nervous",
    "start": "2066079",
    "end": "2071960"
  },
  {
    "text": "because you never know when you're going to set off somebody's system and they somebody's going knocking at your door um there's a lot of paranoia but you",
    "start": "2071960",
    "end": "2080320"
  },
  {
    "text": "don't have to worry about that too much here you don't have to go take your laptop down and find a pay phone and get",
    "start": "2080320",
    "end": "2085358"
  },
  {
    "text": "a free ISP and do all the kinds of things you have to do to to make yourself as Anonymous as possible in a",
    "start": "2085359",
    "end": "2091398"
  },
  {
    "text": "sense you're using the application like it was supposed to be used right you come up you put your name in and you go",
    "start": "2091399",
    "end": "2096638"
  },
  {
    "text": "on there's no I s system that's looking for oddl looking input it's looking for",
    "start": "2096639",
    "end": "2103640"
  },
  {
    "text": "oddl looking packets it's not looking at the layer that we're looking at which is the",
    "start": "2103640",
    "end": "2108760"
  },
  {
    "text": "application layer and even better even if they were if if you're doing a site that's using SSL just gripped it anyway",
    "start": "2108760",
    "end": "2115400"
  },
  {
    "text": "so who cares um it's difficult to track down the areas of exploitation because the only",
    "start": "2115400",
    "end": "2121800"
  },
  {
    "text": "real solution is manual Cod R you that's just the reality I'll show you an example where you can try to blackbox",
    "start": "2121800",
    "end": "2127160"
  },
  {
    "text": "your application to find these problems and you can do that and QA departments should be your QA departments if you're",
    "start": "2127160",
    "end": "2133520"
  },
  {
    "text": "producing code should already be doing this but um the best way is if you got the source code no excuse you have you",
    "start": "2133520",
    "end": "2141000"
  },
  {
    "text": "have all you have all the ability in the world to fix these problems um no amount of os security",
    "start": "2141000",
    "end": "2146720"
  },
  {
    "text": "firewalls patches D you know patch diligence is going to stop SQL injection this is simply something that your",
    "start": "2146720",
    "end": "2152079"
  },
  {
    "text": "developers have to do from the start when they start designing the application should be the first thing you do before you even start the app",
    "start": "2152079",
    "end": "2158240"
  },
  {
    "text": "because it's so difficult to remove once the application is already built these applications you know a lot of times are",
    "start": "2158240",
    "end": "2163400"
  },
  {
    "text": "huge huge you could have 99% of the application coded correctly but that 1%",
    "start": "2163400",
    "end": "2169160"
  },
  {
    "text": "will get you I promise it'll get you all right here's some really bad ASP",
    "start": "2169160",
    "end": "2175720"
  },
  {
    "text": "code it's bad from a lot of from a lot of different perspectives but um we want",
    "start": "2175720",
    "end": "2181319"
  },
  {
    "text": "to try to Zone in on the really bad part which is at the bottom you've got a",
    "start": "2181319",
    "end": "2186720"
  },
  {
    "text": "situation where someone is basically taking input from a form and sticking it directly into the SQL",
    "start": "2186720",
    "end": "2193800"
  },
  {
    "text": "statement now what's the problem here it's not validated right we we",
    "start": "2193800",
    "end": "2199560"
  },
  {
    "text": "don't know what this person is entering um it's difficult to validate a string like I don't know what the",
    "start": "2199560",
    "end": "2206040"
  },
  {
    "text": "person's username could be it could be could be anything so how am I going to validate that a password for example",
    "start": "2206040",
    "end": "2212359"
  },
  {
    "text": "it's it could be very complex I may said you have to have very complex passwords I want you know all kinds of strange",
    "start": "2212359",
    "end": "2218000"
  },
  {
    "text": "symbols and and numbers and upper lowercase letters so you know it's it's hard to say hey is it a number if it was",
    "start": "2218000",
    "end": "2223960"
  },
  {
    "text": "a number it would be very easy to validate all right so you have a normal login situation where the person shows",
    "start": "2223960",
    "end": "2230400"
  },
  {
    "start": "2227000",
    "end": "2227000"
  },
  {
    "text": "up um they have the login page this is simulated login page and they type in their username and password hopefully we",
    "start": "2230400",
    "end": "2237200"
  },
  {
    "text": "didn't write the application so it displays the password where I type it in but you see what the SQL Server actually",
    "start": "2237200",
    "end": "2242680"
  },
  {
    "text": "sees right he sees the select star from users where username equals quot single",
    "start": "2242680",
    "end": "2248240"
  },
  {
    "text": "quote Bob which is what the user entered and the password everything seems like it's",
    "start": "2248240",
    "end": "2253760"
  },
  {
    "text": "going to be fine but what happens if somebody types in this Bob and then their password they",
    "start": "2253760",
    "end": "2260839"
  },
  {
    "text": "put a single quote they put Union select star from users where admin equals",
    "start": "2260839",
    "end": "2266960"
  },
  {
    "text": "one let's just say for this application that the admin you know when that flag is set to one the person is an",
    "start": "2266960",
    "end": "2272400"
  },
  {
    "text": "administrator well in this case the SQL Server is just processing he's parsing this line cross and everything looks",
    "start": "2272400",
    "end": "2278400"
  },
  {
    "text": "good he sees select star from users where username equals to Bob and password equals to quote quote empty",
    "start": "2278400",
    "end": "2284359"
  },
  {
    "text": "string so he does he didn't get anything probably there's probably nobody with that but he unions that with another",
    "start": "2284359",
    "end": "2289680"
  },
  {
    "text": "record set which is Select star from users where admin equals one so what end up happening the person logs in as an",
    "start": "2289680",
    "end": "2297440"
  },
  {
    "text": "administrator the administrator of the site all right a normal usage",
    "start": "2297440",
    "end": "2305960"
  },
  {
    "text": "um let's just say the search page we're getting feedback this is also a good Target um the reason that when I'm like",
    "start": "2305960",
    "end": "2313240"
  },
  {
    "text": "probing applications for this particular problem that I like to use search Pages because search pages are very friendly",
    "start": "2313240",
    "end": "2318640"
  },
  {
    "text": "about pulling information out of a database and spitting it back at me so it's it's an easy target right and this",
    "start": "2318640",
    "end": "2325480"
  },
  {
    "text": "is the best situation you can have I got an application that's waiting for me to give give it some input it's going to",
    "start": "2325480",
    "end": "2330960"
  },
  {
    "text": "take that input and put it into a command that it's going to send to the SQL Server which is going to process it",
    "start": "2330960",
    "end": "2336079"
  },
  {
    "text": "and then spit all of that data back at me so this is a great opportunity for",
    "start": "2336079",
    "end": "2341280"
  },
  {
    "text": "you to rip information out of the database that they didn't intend to you for you to be able to",
    "start": "2341280",
    "end": "2346880"
  },
  {
    "text": "do so let's try it enter a search so let's say enter a last name and I'm",
    "start": "2346880",
    "end": "2352599"
  },
  {
    "text": "putting in my single quote and what I'm doing here is I'm quoting out right he was expecting a single quote um in fact",
    "start": "2352599",
    "end": "2359079"
  },
  {
    "text": "what he does if you look if you went back to that other command that we were showing we put the single quote in the application but by putting it here we're",
    "start": "2359079",
    "end": "2365560"
  },
  {
    "text": "causing SQL Server to close the quote and then we're going to put more commands and in this case maybe we just",
    "start": "2365560",
    "end": "2372119"
  },
  {
    "text": "want the version of SQL Server that's running so we just say uh we have to actually match up the number of",
    "start": "2372119",
    "end": "2377720"
  },
  {
    "text": "parameters so if it's returning three different you know columns from the database I have to make sure that I",
    "start": "2377720",
    "end": "2383640"
  },
  {
    "text": "Union it with a record set of three columns so that's why I have the two empty string columns and then I said add",
    "start": "2383640",
    "end": "2389400"
  },
  {
    "text": "at version which returns me the version information for the SQL Server this is just an example I you could do anything",
    "start": "2389400",
    "end": "2395480"
  },
  {
    "text": "here you could say um select star from CIS users or or step star from um CIS",
    "start": "2395480",
    "end": "2403040"
  },
  {
    "text": "objects which is really the better option right if I go to CIS objects I can get a list of all of the tables in",
    "start": "2403040",
    "end": "2408920"
  },
  {
    "text": "this database so if I get a list of all the tables I can start going after those tables and pulling data out of them the",
    "start": "2408920",
    "end": "2415480"
  },
  {
    "text": "user table will probably be clearly marked and the the credit card information will probably be in a clearly marked table so I can start",
    "start": "2415480",
    "end": "2421720"
  },
  {
    "text": "attacking those directly pulling the information out of those individual databases or individual tables that I'm",
    "start": "2421720",
    "end": "2427640"
  },
  {
    "text": "interested in all right so what I have here is a a live demonstration I'm going",
    "start": "2427640",
    "end": "2433079"
  },
  {
    "start": "2429000",
    "end": "2429000"
  },
  {
    "text": "to basically show you a a sample site um you know I thought about just attacking a site on the internet just like for Fun",
    "start": "2433079",
    "end": "2439839"
  },
  {
    "text": "Since we have internet connectivity but uh my lawyer said it probably wouldn't be a good idea so we'll just what I did",
    "start": "2439839",
    "end": "2446520"
  },
  {
    "text": "was I downloaded one of Microsoft's reference applications and that's what we're going to attack um in some cases I",
    "start": "2446520",
    "end": "2453240"
  },
  {
    "text": "I I have to admit I I modified it a little bit for the purposes of our applications so this is not a Microsoft bashing session here we're going to rip",
    "start": "2453240",
    "end": "2459760"
  },
  {
    "text": "on their um reference application but it does use standard SQL Server security um",
    "start": "2459760",
    "end": "2467560"
  },
  {
    "text": "and as a side effect I I'll show you an area I had I laughed when I saw this but uh there is an area in the reference",
    "start": "2467560",
    "end": "2473640"
  },
  {
    "text": "application that that that's just real bad all right so here here's the sample",
    "start": "2473640",
    "end": "2480119"
  },
  {
    "text": "application outcome to it um the sample application was it was actually called N",
    "start": "2480119",
    "end": "2485200"
  },
  {
    "text": "I just called it vile which turns out actually was registered by someone so I had to uh I had to change it a little",
    "start": "2485200",
    "end": "2492000"
  },
  {
    "text": "bit but uh what we're going to do is we just we sit down at the site and everything looks kind of normal so we're",
    "start": "2492000",
    "end": "2497880"
  },
  {
    "text": "just kind of kind of cruise around and see what we can see well the first thing I see is that they're using frames right because my",
    "start": "2497880",
    "end": "2504960"
  },
  {
    "text": "URL didn't change but here I can see if I start flipping around that they're",
    "start": "2504960",
    "end": "2510319"
  },
  {
    "text": "using ASP so I can see that What's Happening Here is anytime I pick on one of these little topics I'm changing the",
    "start": "2510319",
    "end": "2516880"
  },
  {
    "text": "subject so just for fun we'll right click on this we'll open a new window just",
    "start": "2516880",
    "end": "2524000"
  },
  {
    "text": "because it makes it easier for us to type stuff in right at the the URL and",
    "start": "2524000",
    "end": "2529119"
  },
  {
    "text": "we'll just type a single quote and you'll see that what's happened here is they actually were",
    "start": "2529119",
    "end": "2535480"
  },
  {
    "text": "doing some input validation which is a good thing um they're expecting the subject ID to be a number and uh in the",
    "start": "2535480",
    "end": "2542880"
  },
  {
    "text": "code they they checked for that and it wasn't now I'm giving them a little more",
    "start": "2542880",
    "end": "2548040"
  },
  {
    "text": "credit um they did a cent but they really didn't do any of real validation",
    "start": "2548040",
    "end": "2553119"
  },
  {
    "text": "if they had done real validation we would have probably got a little more friendly message than this um but the CN",
    "start": "2553119",
    "end": "2559839"
  },
  {
    "text": "in this case did stop us from trying to inject something into the SQL stream because all I can put in this place is a",
    "start": "2559839",
    "end": "2567040"
  },
  {
    "text": "number so let's dig a Little Deeper this is where the this is where I",
    "start": "2567040",
    "end": "2572280"
  },
  {
    "text": "I started laughing because I wasn't expecting this actually but if you go to add to shopping cart if you look at the",
    "start": "2572280",
    "end": "2577960"
  },
  {
    "text": "bottom you'll see what what actually is getting submitted uh the price is in there so if if you want a book for a",
    "start": "2577960",
    "end": "2585520"
  },
  {
    "text": "penny it's real easy to do here um so open this in a new",
    "start": "2585520",
    "end": "2591680"
  },
  {
    "text": "window and this is a reference application I might have um you can you",
    "start": "2591680",
    "end": "2596760"
  },
  {
    "text": "can see here that I have the capability to just add things to the card that will change the price of those things if I",
    "start": "2596760",
    "end": "2602319"
  },
  {
    "text": "want to but let's let's see if we can try to get something to the SQL Server itself so what I might try here is um",
    "start": "2602319",
    "end": "2610520"
  },
  {
    "text": "let's see if we can play around with price well we got the same problem right he's doing it in this case he's doing a",
    "start": "2610520",
    "end": "2615960"
  },
  {
    "text": "a ccur he's converting it to a currency data type so we can't do anything with",
    "start": "2615960",
    "end": "2621079"
  },
  {
    "text": "that so let's back up a minute and go to the author that's probably a juicy one right so we put a single quote in single",
    "start": "2621079",
    "end": "2627839"
  },
  {
    "text": "quotes is a real good indicator right if you put single quotes in most of these fields um you may you're probably not",
    "start": "2627839",
    "end": "2635280"
  },
  {
    "text": "going to get a whole lot of false positives you might get some false negatives because somebody error you know is doing some decent error handling",
    "start": "2635280",
    "end": "2641599"
  },
  {
    "text": "so you might get a case where the results might have come back and said zero but in the actuality there was an",
    "start": "2641599",
    "end": "2646640"
  },
  {
    "text": "ladb or SQL server or obbc error that's occurring behind the scenes that somebody just skipped over the error",
    "start": "2646640",
    "end": "2652880"
  },
  {
    "text": "skipped over the error sorry and didn't bother to display to the user like they are in this case but in this case we",
    "start": "2652880",
    "end": "2658680"
  },
  {
    "text": "obviously see that they did and it's telling us there's incorrect syntax in your book um what can we what can we",
    "start": "2658680",
    "end": "2665040"
  },
  {
    "text": "infer from this well we can infer that obviously we've corrupted the SQL string so this is a",
    "start": "2665040",
    "end": "2672760"
  },
  {
    "text": "good thing we've we've let something make its way back to the SQL Server that the SQL Server did not like and it threw",
    "start": "2672760",
    "end": "2679640"
  },
  {
    "text": "up on it so let's uh let's see if we can tweak it a little more what I'm going to do now is I'm going to put two dashes",
    "start": "2679640",
    "end": "2687559"
  },
  {
    "text": "and that it's a comment right so what I'm what I'm doing with that comment is I'm telling the SQL Server whatever",
    "start": "2687559",
    "end": "2693680"
  },
  {
    "text": "comes after this is just a comment ignore it so I can get my SQL statement",
    "start": "2693680",
    "end": "2698800"
  },
  {
    "text": "to stop where my single quote is right I'm going try to terminate the string because what's happened is I've put a",
    "start": "2698800",
    "end": "2704680"
  },
  {
    "text": "single quote in and then it put in of course the application put in another quote and that caused the string to be",
    "start": "2704680",
    "end": "2710920"
  },
  {
    "text": "invalidated so by putting my single quote in and then putting the comment identifiers I'm going try to revalidate",
    "start": "2710920",
    "end": "2716520"
  },
  {
    "text": "the string okay good now it's revalidated now the SQL serice telling us exactly",
    "start": "2716520",
    "end": "2722559"
  },
  {
    "text": "what it didn't like about the command that we sent it what's Happening Here is it's obvious ly the person is using a",
    "start": "2722559",
    "end": "2728040"
  },
  {
    "text": "store procedure the store procedure is called ad card item the store procedure is expecting a parameter called title",
    "start": "2728040",
    "end": "2734960"
  },
  {
    "text": "which it wasn't it was it wasn't supplied that parameter so the next thing that we can try to do is provide",
    "start": "2734960",
    "end": "2741559"
  },
  {
    "text": "the parameter so we can put comma",
    "start": "2741559",
    "end": "2748280"
  },
  {
    "text": "title equals let's just put do nothing",
    "start": "2748319",
    "end": "2754040"
  },
  {
    "text": "right all right so we it took that it title but now it's expecting something else it wants price so we'll we'll keep",
    "start": "2754040",
    "end": "2762400"
  },
  {
    "text": "it up right it wants price we'll give it price so we go back we add another",
    "start": "2762400",
    "end": "2768119"
  },
  {
    "text": "command price price is probably a number so let's put",
    "start": "2768119",
    "end": "2773680"
  },
  {
    "text": "that I already like that it still wants yet another parameter it wants quantity",
    "start": "2773680",
    "end": "2779319"
  },
  {
    "text": "so let's give it what it wants the reason we're doing this is because we want we want to actually",
    "start": "2779319",
    "end": "2786119"
  },
  {
    "text": "revalidate the command we want this command to actually be processed cuz once it's processed and once we know",
    "start": "2786119",
    "end": "2793040"
  },
  {
    "text": "that we can inject code which we are proving by doing this we know that we can tack on more code onto the end of",
    "start": "2793040",
    "end": "2799040"
  },
  {
    "text": "the string and have it be executed this is important right if the string isn't invalidated I I can't",
    "start": "2799040",
    "end": "2805280"
  },
  {
    "text": "execute anything on the SQL Server it just keeps throwing it back at me but as soon as I can get it to run and it's",
    "start": "2805280",
    "end": "2810440"
  },
  {
    "text": "obvious that I can inject code then the door's wide open we can we can run any",
    "start": "2810440",
    "end": "2815520"
  },
  {
    "text": "SQL command that we want so let's try quantity equals zero all right took it all right this",
    "start": "2815520",
    "end": "2823680"
  },
  {
    "text": "now now you're in business as soon as you know that we know how to validate the command we can run anything that we",
    "start": "2823680",
    "end": "2829559"
  },
  {
    "text": "want here before our comment so let's put um",
    "start": "2829559",
    "end": "2835680"
  },
  {
    "text": "exact Master because the command that I want to the store procedure that I want to run is in the master",
    "start": "2835680",
    "end": "2841599"
  },
  {
    "text": "database um XP command shell because it's probably the most popular for",
    "start": "2841599",
    "end": "2846920"
  },
  {
    "text": "Network hackers attackers crackers whatever you want to call them and a",
    "start": "2846920",
    "end": "2854319"
  },
  {
    "text": "command I won't be evil here let's just get a directory somebody give me a file name um so that we can prove that it's",
    "start": "2855040",
    "end": "2861240"
  },
  {
    "text": "not totally bogus and staged and so forth what's",
    "start": "2861240",
    "end": "2866839"
  },
  {
    "text": "that oh that's actually a quite good one let's do it",
    "start": "2866839",
    "end": "2873280"
  },
  {
    "text": "boot. uh this is a Windows 98 machine so don't worry nothing will blow all",
    "start": "2873280",
    "end": "2879559"
  },
  {
    "text": "right so what we're doing now is we've taken a SQL command that we know is going to be executed and we've added",
    "start": "2879559",
    "end": "2885920"
  },
  {
    "text": "more SQL some Insidious SQL to run a command that we want to run there's no",
    "start": "2885920",
    "end": "2891920"
  },
  {
    "text": "reason that we have to do this particular Command right we can do um anything that we wanted to um there's",
    "start": "2891920",
    "end": "2898640"
  },
  {
    "text": "all kinds of nice juicy extended store procedures to do mail do automation um we could take the",
    "start": "2898640",
    "end": "2904839"
  },
  {
    "text": "information that's in those tables and and BCP it out to a file so we can download it",
    "start": "2904839",
    "end": "2911079"
  },
  {
    "text": "later we could be here all day talking about the things you can do but basically what we're doing is we're running code on a SQL Server",
    "start": "2911079",
    "end": "2920280"
  },
  {
    "text": "yes um as far as the XP command shell or as far as what we're doing here in general in the injecting no the",
    "start": "2923400",
    "end": "2929319"
  },
  {
    "text": "injecting happens on any of those any version because the problem once again isn't related to the SQL Server it's",
    "start": "2929319",
    "end": "2934799"
  },
  {
    "text": "related to the fact that we're building a string command to give to the SQL Server which we're we're given through",
    "start": "2934799",
    "end": "2940760"
  },
  {
    "text": "the application the ability to add code to so in a sense you're turning the user into developer right because now I can",
    "start": "2940760",
    "end": "2947920"
  },
  {
    "text": "put my own code and have it running on the SQL Server it's tsql which some",
    "start": "2947920",
    "end": "2953000"
  },
  {
    "text": "people it's just they can just write you know they can just run transact SQL code I hear that all the time so what can they do with transact SQL code well your",
    "start": "2953000",
    "end": "2959920"
  },
  {
    "text": "developers wrote the application there's obviously a lot you can do with tsql code right you can pull any of this",
    "start": "2959920",
    "end": "2965119"
  },
  {
    "text": "information that's in here out given given necessary rights um and given necessary rights you can go to the",
    "start": "2965119",
    "end": "2970680"
  },
  {
    "text": "operating system makes a really good way for you to just go right to the OS and do whatever you want so in this case",
    "start": "2970680",
    "end": "2976440"
  },
  {
    "text": "that's exactly what we're going to do so we run that command it's taking a little longer because you know SQL",
    "start": "2976440",
    "end": "2982200"
  },
  {
    "text": "server has to actually load the XP command shell store procedure and we go",
    "start": "2982200",
    "end": "2988640"
  },
  {
    "text": "here and back up I'm typing with one hand here so give",
    "start": "2988640",
    "end": "2995000"
  },
  {
    "text": "me give me a break and there's boot.ini and we don't even look in it we",
    "start": "2995000",
    "end": "3000960"
  },
  {
    "text": "know it just contains a directory listing from my C drive and that's it you can pretty much",
    "start": "3000960",
    "end": "3007040"
  },
  {
    "text": "do whatever you want with this application this point on um you can",
    "start": "3007040",
    "end": "3012160"
  },
  {
    "text": "have all kinds of fun obviously they're running as sa right because we were able to run XP command showell um something",
    "start": "3012160",
    "end": "3019599"
  },
  {
    "text": "else though that I wanted to show while I have this running is a good way that you can you know prevent this type of",
    "start": "3019599",
    "end": "3025799"
  },
  {
    "text": "thing is if you have a QA department and and you should um a lot of people you know develop applications internally um",
    "start": "3025799",
    "end": "3033880"
  },
  {
    "text": "you need to have them test for this kind of stuff and it it may sound like it's hard to do because putting all these",
    "start": "3033880",
    "end": "3039000"
  },
  {
    "text": "things in the fields and so forth it's hard to tell whether or not it's actually making it because sometimes you",
    "start": "3039000",
    "end": "3044480"
  },
  {
    "text": "have really good people that have written good error handling that doesn't throw back up these ugly oad error",
    "start": "3044480",
    "end": "3049839"
  },
  {
    "text": "messages and stuff like that so you don't know or know you don't know whether or not that code is actually making it to the SQL Server so it's",
    "start": "3049839",
    "end": "3055240"
  },
  {
    "text": "difficult to debug sometimes uh what can really help you in this case is actually running",
    "start": "3055240",
    "end": "3060920"
  },
  {
    "text": "profiler and um profiler gives you the capability to filter out certain things",
    "start": "3060920",
    "end": "3067839"
  },
  {
    "text": "right so let's let's create a new trace and profiler and",
    "start": "3067839",
    "end": "3074599"
  },
  {
    "text": "uh that with this Trace I'm going to um filter out only a piece of text that I'm",
    "start": "3074599",
    "end": "3081680"
  },
  {
    "text": "interested in and I'll show you that piece of text it's it's pretty arbitrary I use this because you know personally I",
    "start": "3081680",
    "end": "3088640"
  },
  {
    "text": "think that this works best for me I use a z a single quote and a z all I'm trying to do here is avoid false",
    "start": "3088640",
    "end": "3095480"
  },
  {
    "text": "positives but I i' very you know I've rarely had any false positives using this but the idea the idea is this if I",
    "start": "3095480",
    "end": "3102440"
  },
  {
    "text": "put if I introduce a z a single quote and a z into my application it shouldn't make it back to the SQL server looking",
    "start": "3102440",
    "end": "3108880"
  },
  {
    "text": "just like that right if I didn't put it into a numeric field my application s have handled it and said nope it wasn't",
    "start": "3108880",
    "end": "3114599"
  },
  {
    "text": "a number if I put it into a text field my application should have said no a single quote is not a valid character",
    "start": "3114599",
    "end": "3121200"
  },
  {
    "text": "I'm going to turn it into two single quotes which is a valid character for SQL Server if you want to actually represent a single quote in the SQL",
    "start": "3121200",
    "end": "3128640"
  },
  {
    "text": "Server you have to use two single quotes so your application should do one",
    "start": "3128640",
    "end": "3134280"
  },
  {
    "text": "of two things validate numeric input and turn single quotes into double quotes if",
    "start": "3134280",
    "end": "3139839"
  },
  {
    "text": "it does those things we shouldn't see this on the back end so you run the trace",
    "start": "3139839",
    "end": "3146960"
  },
  {
    "text": "we'll attack a part of the application that that does do some decent filtering or some decent uh validation which is",
    "start": "3147280",
    "end": "3153960"
  },
  {
    "text": "the search page and I'll put my Z single quote Z",
    "start": "3153960",
    "end": "3159760"
  },
  {
    "text": "in zero books found I go back here I don't see it it never made it and didn't",
    "start": "3159760",
    "end": "3165559"
  },
  {
    "text": "make it back to the SQL Server as a z single quote Z that's good",
    "start": "3165559",
    "end": "3171640"
  },
  {
    "text": "thing now if you're a little more adventurous you can actually have profiler do all kinds of things like profiler and take anything that it gets",
    "start": "3171640",
    "end": "3178280"
  },
  {
    "text": "and add it to a table and you could take that table and put a trigger on it and you could have that trigger fire off an",
    "start": "3178280",
    "end": "3184359"
  },
  {
    "text": "alert yes it sounds like it sounds like a lot of work but it's really not and that way you would be alerted when the",
    "start": "3184359",
    "end": "3190559"
  },
  {
    "text": "fact when somebody gets that Z single quote Z and that might be a little more useful than having somebody sitting here watching you know the profiler screen",
    "start": "3190559",
    "end": "3197119"
  },
  {
    "text": "you know raising their hand when they finally see it or whatever but let's go back to our area",
    "start": "3197119",
    "end": "3203280"
  },
  {
    "text": "our little piece of code that that was bad and we'll open it up in a new window",
    "start": "3203280",
    "end": "3210599"
  },
  {
    "text": "and we'll put our uh Z single quote Z in and submit",
    "start": "3210599",
    "end": "3216520"
  },
  {
    "text": "it get our nasty message and better yet and profiler has now shown us what it",
    "start": "3216520",
    "end": "3223559"
  },
  {
    "text": "captured the actual SQL that came back to the SQL server with our Z single quote z in it so now you know an area",
    "start": "3223559",
    "end": "3232440"
  },
  {
    "text": "that's vulnerable now of course somebody still got to you know walk through the application put this in every form field",
    "start": "3232440",
    "end": "3239200"
  },
  {
    "text": "put this in every query string on the URL that they can find and try to Fair it out where the input validation is not",
    "start": "3239200",
    "end": "3245799"
  },
  {
    "text": "taking place but it's it's it's it's not exactly you know uh the greatest way it seems like",
    "start": "3245799",
    "end": "3252720"
  },
  {
    "text": "kind of a cludge but it's free and it works and maybe someday somebody will",
    "start": "3252720",
    "end": "3257799"
  },
  {
    "text": "write an application to uh to automate the process but I don't like to pay for",
    "start": "3257799",
    "end": "3263839"
  },
  {
    "text": "things I can do for free okay that's the uh that's the",
    "start": "3263839",
    "end": "3270000"
  },
  {
    "text": "demonstration so let's get back to the uh let's get back to the slides any questions about the",
    "start": "3270000",
    "end": "3275440"
  },
  {
    "text": "demonstration oh",
    "start": "3275440",
    "end": "3278680"
  },
  {
    "text": "sure the application you could it's just that there's so many ways that SQL Server can",
    "start": "3291400",
    "end": "3297000"
  },
  {
    "text": "throw the code back at you you could would you would have to really build a like a database of all the different",
    "start": "3297000",
    "end": "3302559"
  },
  {
    "text": "specific error messages that that can come up if you wanted to just look at the you know the nasty piece of of code",
    "start": "3302559",
    "end": "3309160"
  },
  {
    "text": "like You' always just look for you know Microsoft oad provider for that's a good hint that something's gone wrong right",
    "start": "3309160",
    "end": "3314200"
  },
  {
    "text": "when you start to see this U the problem is there there's no guarantee that I'm actually using the oad provider for SQL",
    "start": "3314200",
    "end": "3319680"
  },
  {
    "text": "Server right I could be using all kinds of drivers maybe I'm using the odbc drivers maybe I'm using um maybe I'm not",
    "start": "3319680",
    "end": "3325920"
  },
  {
    "text": "connecting to SQL server and I'm connecting to some other database but you know if you're just looking for somebody using the oad provider because",
    "start": "3325920",
    "end": "3333079"
  },
  {
    "text": "there's several providers that you can use um you could search for this yeah but each one of them has like their own error messages and stuff it's a lot of",
    "start": "3333079",
    "end": "3339799"
  },
  {
    "text": "complexity involved there but um I suppose that you could do it you could do it that way but keep in mind once",
    "start": "3339799",
    "end": "3345599"
  },
  {
    "text": "again it's hard to look for that because some people you know handle errors so you won't get this message you'll get a",
    "start": "3345599",
    "end": "3352520"
  },
  {
    "text": "nice Zero Records or couldn't add this item to this cart or you know something something different if they handled it",
    "start": "3352520",
    "end": "3358559"
  },
  {
    "text": "properly no application that's in production should be giving people error messages like this this is nuts yeah I wouldn't use this this is a bad",
    "start": "3358559",
    "end": "3364760"
  },
  {
    "text": "reference application",
    "start": "3364760",
    "end": "3367960"
  },
  {
    "text": "bad turn off rep oh",
    "start": "3373039",
    "end": "3378839"
  },
  {
    "text": "okay all right hey you break you make up a good point too A lot of people just in",
    "start": "3382559",
    "end": "3387920"
  },
  {
    "text": "IIs they'll just go ahead and turn it off so you don't get those messages anyway because that that is a switch that you can turn on and off in the metabase so a lot of people just turn",
    "start": "3387920",
    "end": "3395240"
  },
  {
    "text": "that off to begin with and you won't get that error",
    "start": "3395240",
    "end": "3399119"
  },
  {
    "text": "message all right what's the main problem that we saw with most of these injection samples um well poor input",
    "start": "3401559",
    "end": "3407440"
  },
  {
    "start": "3402000",
    "end": "3402000"
  },
  {
    "text": "validation right nobody was looking to see what I was entering was a a number",
    "start": "3407440",
    "end": "3413280"
  },
  {
    "text": "well maybe they did by doing a conversion but I I don't give them credit for that um and putting you putting secrets in",
    "start": "3413280",
    "end": "3419440"
  },
  {
    "text": "ASP code was pretty bad um but once again not critical because somebody you",
    "start": "3419440",
    "end": "3424720"
  },
  {
    "text": "shouldn't be having secrets in there anyway right if you're putting secrets in your code you got a problem poorly",
    "start": "3424720",
    "end": "3430720"
  },
  {
    "text": "tight SQL server and ASP not checking data types and they're not um security context is too high if they needed",
    "start": "3430720",
    "end": "3436520"
  },
  {
    "text": "functionality didn't have to run that application as essay I mean it's an online bookstore come on all right some",
    "start": "3436520",
    "end": "3442319"
  },
  {
    "start": "3441000",
    "end": "3441000"
  },
  {
    "text": "tricksy attackers use and I used Union statements um and some that code and some of the things I showed you earlier",
    "start": "3442319",
    "end": "3448359"
  },
  {
    "text": "the reason I use Union is because I like to um I like to see get feedback when I'm injecting code so that's why I like",
    "start": "3448359",
    "end": "3454920"
  },
  {
    "text": "search Pages because search Pages give the capability because you know you can just put some code in there it's a record set that's going to be coming",
    "start": "3454920",
    "end": "3461039"
  },
  {
    "text": "back at the IIs server if I can Union some more data onto that record set I",
    "start": "3461039",
    "end": "3466760"
  },
  {
    "text": "can have it show up in the result set which is really good so one of the things you do with the Union is you want to make sure you short you know want to",
    "start": "3466760",
    "end": "3472559"
  },
  {
    "text": "Short Circuit whatever the previous query was and then have it app pinned your query onto it um the double hyphen",
    "start": "3472559",
    "end": "3479799"
  },
  {
    "text": "comment indicator to block out the rest of the intended SQL that's just because well the application is going to smack",
    "start": "3479799",
    "end": "3485359"
  },
  {
    "text": "that other single quote on the end and you know basically invalidate whatever code I put in because it's going to",
    "start": "3485359",
    "end": "3491039"
  },
  {
    "text": "cause a syntax error so putting that comment basically allows me to say I don't care what the developer was doing",
    "start": "3491039",
    "end": "3496480"
  },
  {
    "text": "um take my code and just forget whatever he was doing with the rest of the sequel statement um obviously the single quote",
    "start": "3496480",
    "end": "3504079"
  },
  {
    "text": "thing is a is a quick and dirty way if you did if you didn't want to have anybody do all this you know Z single quote Z thing you could just have",
    "start": "3504079",
    "end": "3509880"
  },
  {
    "text": "somebody go through the application with the obbc error messages turned on in the I metabase and then just go ahead and",
    "start": "3509880",
    "end": "3516000"
  },
  {
    "text": "flip through the app until you know they see that nasty message it be a good indicator that something's seriously",
    "start": "3516000",
    "end": "3521559"
  },
  {
    "text": "wrong not even from a security perspective just from an application development perspective it's it's crazy",
    "start": "3521559",
    "end": "3526799"
  },
  {
    "text": "to have your whole application die because somebody put a single quote in it but it's absolutely ubiquitous you go",
    "start": "3526799",
    "end": "3532039"
  },
  {
    "text": "out on the you go out on the internet today find a site that's running ASP and start putting single quotes in I give",
    "start": "3532039",
    "end": "3537359"
  },
  {
    "text": "you even odds it's going to have this problem all right a lot of things uh",
    "start": "3537359",
    "end": "3543440"
  },
  {
    "text": "that people can do um a good indication that you've achieved too much access is to actually ping another host using XP",
    "start": "3543440",
    "end": "3550480"
  },
  {
    "text": "command shell so you might have a listener out there that's waiting for an icmp message coming from you know your",
    "start": "3550480",
    "end": "3556000"
  },
  {
    "text": "target um it's a good indication of two things actually that you were able you're able to inject your code in the",
    "start": "3556000",
    "end": "3562559"
  },
  {
    "text": "first place and two that you've achieved a level of authorization that has the capability to run XP command shell it's",
    "start": "3562559",
    "end": "3569079"
  },
  {
    "text": "system administrator role so it's a real good indication that that machine is is about to be done um you can select name",
    "start": "3569079",
    "end": "3577200"
  },
  {
    "text": "from C objects for type equals U this is just one of the first things that I generally do is because as soon as I can",
    "start": "3577200",
    "end": "3582760"
  },
  {
    "text": "inject code um I want to go after the really juicy stuff if let's just say for example that the person didn't run the",
    "start": "3582760",
    "end": "3589079"
  },
  {
    "text": "application as saay ran it as a normal user well that normal user still has to have access to you know to some database",
    "start": "3589079",
    "end": "3595240"
  },
  {
    "text": "objects it may not be the individual tables but it may be um but if whatever",
    "start": "3595240",
    "end": "3600440"
  },
  {
    "text": "level of access that they have I can start poking around in CIS objects to see what other objects exist in that",
    "start": "3600440",
    "end": "3605720"
  },
  {
    "text": "database I want to see store procedures I want to see views I want to see tables I want to see whatever juicy information",
    "start": "3605720",
    "end": "3611559"
  },
  {
    "text": "is also available for me to get at and CIS objects is the place to look because based on type I can come in here and",
    "start": "3611559",
    "end": "3617359"
  },
  {
    "text": "pull this information out and it doesn't matter I always have access to to objects no matter what level of uh of",
    "start": "3617359",
    "end": "3623799"
  },
  {
    "text": "permission I have um I can insert table name you know exec SP whatever so and",
    "start": "3623799",
    "end": "3630720"
  },
  {
    "text": "what I can do in this case is I can take a store procedure take its output and insert it into a",
    "start": "3630720",
    "end": "3636760"
  },
  {
    "text": "table um why you might want to do that um well what if you exec XP command",
    "start": "3636760",
    "end": "3642640"
  },
  {
    "text": "shell and run something if you want to see that output back displayed back to you in a browser you could do it this",
    "start": "3642640",
    "end": "3648960"
  },
  {
    "text": "way right you could have it go run your your extended store procedure your XP command shell to let's just say you want",
    "start": "3648960",
    "end": "3654160"
  },
  {
    "text": "to get a list of users so you might say net user and take all of the users that you got put them to a file and then",
    "start": "3654160",
    "end": "3660200"
  },
  {
    "text": "maybe have them you know read or actually not a file but in this case but put them in a table and then have that table unioned onto the back of a SQL",
    "start": "3660200",
    "end": "3667440"
  },
  {
    "text": "statement so that would be an example of why you might want to do that right because there's all kinds of extended store procedures they produce output why",
    "start": "3667440",
    "end": "3673880"
  },
  {
    "text": "not put that output directly on a table and then have it redisplayed to you through a through the browser so that way you can actually see the output of",
    "start": "3673880",
    "end": "3680400"
  },
  {
    "text": "the things that you're doing to the operating system and obviously getting the version information is always the first thing",
    "start": "3680400",
    "end": "3686400"
  },
  {
    "text": "right you want to know what SQL Server you're looking at because you may have all kinds of things depending on what version they have and what patches",
    "start": "3686400",
    "end": "3692000"
  },
  {
    "text": "they've applied there's all kinds of problems you can just go right to security focus and do a look up on the",
    "start": "3692000",
    "end": "3697079"
  },
  {
    "text": "version of SQL Server the exact version that they're running and then you can see all the exploits and they'll tell you which patches have to be applied for",
    "start": "3697079",
    "end": "3703640"
  },
  {
    "text": "this exploit to work and not work so some versions of SQL Server have privilege escalation problems right so",
    "start": "3703640",
    "end": "3709680"
  },
  {
    "text": "maybe you you have this user with a really low level of privilege well they just go in there and find out what",
    "start": "3709680",
    "end": "3714920"
  },
  {
    "text": "version you're running go in the the security Focus find out that you're running an unpatched version of SQL Server 7 boom find out an exploit",
    "start": "3714920",
    "end": "3723400"
  },
  {
    "text": "that gives them a privilege escalation and boom they're off the new SQL variant data type is",
    "start": "3723400",
    "end": "3730440"
  },
  {
    "text": "really fun if you're fond of unioning because it used to be kind of an annoyance the union and you had to get",
    "start": "3730440",
    "end": "3735640"
  },
  {
    "text": "not only the number of columns matched up but the actual data types I mean you could be there all day trying to match",
    "start": "3735640",
    "end": "3741960"
  },
  {
    "text": "up data types um the the SQL variant really helped um from an attacker's",
    "start": "3741960",
    "end": "3747880"
  },
  {
    "text": "perspective because you know you don't have to worry about that anymore I can take a number Union it with a you know a",
    "start": "3747880",
    "end": "3754720"
  },
  {
    "text": "VAR the uh an A varar or whatever data type that I'm interested in and it'll",
    "start": "3754720",
    "end": "3760000"
  },
  {
    "text": "put those two together in the in the union statement it doesn't care anymore because it'll put a union it'll it'll",
    "start": "3760000",
    "end": "3765240"
  },
  {
    "text": "put a variant with any other data type so the result attacker spend less time guessing about column order made it",
    "start": "3765240",
    "end": "3771760"
  },
  {
    "text": "easier to do this kind of stuff here's an example in case you're interested um",
    "start": "3771760",
    "end": "3777160"
  },
  {
    "text": "just a simple select statement U you know job level and F name for employee we did a union and the thing blows up",
    "start": "3777160",
    "end": "3784039"
  },
  {
    "text": "because the varar column is not the same type as the integer that we were expecting as a job level but by just",
    "start": "3784039",
    "end": "3791119"
  },
  {
    "text": "making the simple change and putting these convert SQL variants in on my on my injected SQL solves the",
    "start": "3791119",
    "end": "3798599"
  },
  {
    "text": "problem all right solutions to some of this stuff scrub input data to make sure it contains only acceptable characters",
    "start": "3798599",
    "end": "3805279"
  },
  {
    "text": "right repl single quotes with two single quotes and if you use we'll get on to something else later but there's another",
    "start": "3805279",
    "end": "3810960"
  },
  {
    "text": "way that you can do that same thing the reason this works but it's just so hard to do because an application may have",
    "start": "3810960",
    "end": "3818000"
  },
  {
    "text": "thousands of locations where user input is is eventually sent to an SQL statement right so tracking them all",
    "start": "3818000",
    "end": "3824720"
  },
  {
    "text": "down is a pretty gargantuan task um but you can do it this way um you can use",
    "start": "3824720",
    "end": "3830920"
  },
  {
    "text": "regular Expressions which are always good if you're going do input validation right do some regular expression checking um if the person is supposed to",
    "start": "3830920",
    "end": "3837160"
  },
  {
    "text": "be entering you know a through z and uh maybe some numbers in some in in a field",
    "start": "3837160",
    "end": "3842559"
  },
  {
    "text": "then make sure that that's what they've done so you can use regular expressions for that and and if you're even if you're using VB yeah you have reg access",
    "start": "3842559",
    "end": "3849559"
  },
  {
    "text": "to regular Expressions so you You' got no excuse all right it helps but is it 100%",
    "start": "3849559",
    "end": "3857559"
  },
  {
    "text": "effective well not exactly because you still have the problem of you don't need single quotes to inject code right you",
    "start": "3857559",
    "end": "3863119"
  },
  {
    "text": "could have a numeric field where it's the application is expecting a number",
    "start": "3863119",
    "end": "3868480"
  },
  {
    "text": "and you didn't validate that the person put in a number um the this is what I'm talking about is the single quote stuff right so",
    "start": "3868480",
    "end": "3875240"
  },
  {
    "text": "I do the replace and it doesn't do any good because I don't need to put single",
    "start": "3875240",
    "end": "3881079"
  },
  {
    "text": "quotes in the application in order to get to inject my code because the person here didn't validate that X was actually",
    "start": "3881079",
    "end": "3887720"
  },
  {
    "text": "a number in the first place does that make sense yes no okay",
    "start": "3887720",
    "end": "3894760"
  },
  {
    "text": "just blank stairs store procedures can help enforce stronger typing but using them at every database access can be brutal to the",
    "start": "3894760",
    "end": "3902000"
  },
  {
    "text": "sheer number of procs that may be needed I don't care if it's brutal you should be doing it anyway the reason store",
    "start": "3902000",
    "end": "3907039"
  },
  {
    "text": "procedures are good is because they abstract access they don't they allow you to do things like let a person input",
    "start": "3907039",
    "end": "3914480"
  },
  {
    "text": "a record into this table let a person select some records out of that table let a person update a record but not",
    "start": "3914480",
    "end": "3922039"
  },
  {
    "text": "give them access to the table at all if you create a store procedure and you don't break a trust chain which",
    "start": "3922039",
    "end": "3929000"
  },
  {
    "text": "you can look up in books online we won't get into that but if you create a store procedure and all dat all the database",
    "start": "3929000",
    "end": "3934160"
  },
  {
    "text": "objects are owned by dbbo then what'll happen is when a person runs that store procedure all they have to have is",
    "start": "3934160",
    "end": "3940640"
  },
  {
    "text": "execute rights to run the procedure but they don't need rights for the underlying objects inside that store",
    "start": "3940640",
    "end": "3946680"
  },
  {
    "text": "procedure now why is this good because if this had been done I wouldn't be able to do things like select from other",
    "start": "3946680",
    "end": "3953359"
  },
  {
    "text": "tables and pull information out of those other tables like a credit card table for example right if I'm able to inject",
    "start": "3953359",
    "end": "3959200"
  },
  {
    "text": "code my application probably doesn't give me the capability to actually read back the credit card numbers it probably",
    "start": "3959200",
    "end": "3964599"
  },
  {
    "text": "just stores them and some backend system uses them to to to do uh reconciliation",
    "start": "3964599",
    "end": "3970440"
  },
  {
    "text": "so giving me execute access to the store procedures then is is not to is",
    "start": "3970440",
    "end": "3975480"
  },
  {
    "text": "something that obviously has to happen for the application to run but you don't have to give me access to the individual tables so that I can't go once I'm in",
    "start": "3975480",
    "end": "3982920"
  },
  {
    "text": "and start looking around in those inside of those tables I don't have select access to them I don't have insert",
    "start": "3982920",
    "end": "3987960"
  },
  {
    "text": "update delete access to any of the tables inside of the application itself that's why store procedures are",
    "start": "3987960",
    "end": "3994880"
  },
  {
    "text": "really useful okay you can still poorly Implement them right you can do that",
    "start": "3994880",
    "end": "4000520"
  },
  {
    "text": "same stupid string building um method for doing database",
    "start": "4000520",
    "end": "4005880"
  },
  {
    "text": "access that causes the same exact problems even with a store procedure um so in this case we got somebody that's",
    "start": "4005880",
    "end": "4011960"
  },
  {
    "text": "trying to run a store procedure but they're using the same kind of thing now let's just say we did inject some code",
    "start": "4011960",
    "end": "4018200"
  },
  {
    "text": "here if they did this to the entire application the only Advantage is the only thing that this person is going to",
    "start": "4018200",
    "end": "4024119"
  },
  {
    "text": "do in this application is be able to run more store procedures and you know if I've properly",
    "start": "4024119",
    "end": "4030359"
  },
  {
    "text": "written the application that may not be such a bad thing you know maybe they can select something maybe they can insert",
    "start": "4030359",
    "end": "4036319"
  },
  {
    "text": "something you know but certainly it's not yeah show me everything that's in the credit card table show me show me",
    "start": "4036319",
    "end": "4042920"
  },
  {
    "text": "everything that's in the user table I you control the access that's that's the advantage you control what people do to",
    "start": "4042920",
    "end": "4048599"
  },
  {
    "text": "the application through these store procedures a better implementation of the store procedure is to actually make",
    "start": "4048599",
    "end": "4054559"
  },
  {
    "text": "use of the um Ado objects specifically the command object because what this allows you to do is create the",
    "start": "4054559",
    "end": "4061640"
  },
  {
    "text": "parameters explicitly and you can assign them data types so you get like a two for one here you're getting you're",
    "start": "4061640",
    "end": "4068039"
  },
  {
    "text": "actually getting data typing which is good and you're getting the actual added benefit that Ado will automatically",
    "start": "4068039",
    "end": "4074760"
  },
  {
    "text": "convert your single and double quotes which is very nice um this is a good way to do it from a lot of perspectives not",
    "start": "4074760",
    "end": "4081359"
  },
  {
    "text": "the least of which is that if you centralize this um and you make every developer use a centralized data access",
    "start": "4081359",
    "end": "4087720"
  },
  {
    "text": "routine that makes use of the U the Ado intrinsic objects such as you know connection command record set Etc um you",
    "start": "4087720",
    "end": "4095000"
  },
  {
    "text": "don't have to go through a thousand different ASP pages to find and get",
    "start": "4095000",
    "end": "4100278"
  },
  {
    "text": "these problems fixed and that's about as close to hell as you ever want to be is trying to fix an asp app with 500 pages",
    "start": "4100279",
    "end": "4107960"
  },
  {
    "text": "and everybody's accessing the database in a different way um there's also a little a little",
    "start": "4107960",
    "end": "4114679"
  },
  {
    "text": "hidden um method for actually running store procedures is that if you just create an instance of the connection",
    "start": "4114679",
    "end": "4120000"
  },
  {
    "text": "object you can just do a DOT and expose the store procedures like there a method",
    "start": "4120000",
    "end": "4125278"
  },
  {
    "text": "of the command object or the connection object which is actually kind of cool and it does the same stuff behind the",
    "start": "4125279",
    "end": "4130318"
  },
  {
    "text": "scenes so it'll turn your single quotes into double quotes as well discipline make sure to developers",
    "start": "4130319",
    "end": "4135838"
  },
  {
    "text": "adhere to the standards develop a methodology um like I said you got to do the stuff up front it's just too hard to",
    "start": "4135839",
    "end": "4142318"
  },
  {
    "text": "do at the end of a development project U whether you're using um ASP PHP JSP I I",
    "start": "4142319",
    "end": "4149199"
  },
  {
    "text": "don't care um you just have to sit down ahead of time and go ahead and develop a",
    "start": "4149199",
    "end": "4154238"
  },
  {
    "text": "coherent and and unified strategy for database access don't let everybody do",
    "start": "4154239",
    "end": "4159600"
  },
  {
    "text": "something different because if you have a problem later it'll be impossible impossible to fix",
    "start": "4159600",
    "end": "4165758"
  },
  {
    "text": "um no access to production servers keep developers off production system I don't think anybody here's going to argue with that um consistent database access and",
    "start": "4165759",
    "end": "4173359"
  },
  {
    "text": "developer education you developers um they're kind of like the last people who like seem to know anything about",
    "start": "4173359",
    "end": "4179080"
  },
  {
    "text": "security I don't know why um you have it people right you have you have the security people who are kind of in with",
    "start": "4179080",
    "end": "4185080"
  },
  {
    "text": "the IT people they're they're kind of kept separate from the developers are like these people you lock in the back room those people should know about",
    "start": "4185080",
    "end": "4191238"
  },
  {
    "text": "security because they're they can be just as much a contributor to the to the um compromise of your systems as as a",
    "start": "4191239",
    "end": "4197480"
  },
  {
    "text": "bad Security administrator a bad firewall administrator right they're just working on a different layer but",
    "start": "4197480",
    "end": "4203840"
  },
  {
    "text": "that layer can bring you down just as much as uh you know a layer three",
    "start": "4203840",
    "end": "4209000"
  },
  {
    "text": "exploit all right encourage reusable security components code review QA test",
    "start": "4209000",
    "end": "4214280"
  },
  {
    "text": "plans know that sounds so boring you know QA test plans that's the best thing that you can do it's the best thing",
    "start": "4214280",
    "end": "4220480"
  },
  {
    "text": "actually test the application um you know You' got every opportunity you have the source code you",
    "start": "4220480",
    "end": "4227719"
  },
  {
    "text": "can fix this stuff and you know code with this kind of mindset that you're already attacking",
    "start": "4227719",
    "end": "4233560"
  },
  {
    "text": "it you know when I'm writing code all I can think about is what can I do to break this and you should be doing the same thing encouraging your developers",
    "start": "4233560",
    "end": "4239520"
  },
  {
    "text": "to do it as well um use the principle of least privilege right it sticks out like a sore thumb it's it's it's it's",
    "start": "4239520",
    "end": "4245600"
  },
  {
    "text": "something you're going to see at every level you want to use the principle of Le least privilege when you install SQL Server you want to use the principle of",
    "start": "4245600",
    "end": "4251280"
  },
  {
    "text": "lease privilege when you give people developmental access you want to use the principle of lease privilege when you actually run the application right the",
    "start": "4251280",
    "end": "4258239"
  },
  {
    "text": "application should never run as that say it should run with some lowly user that only exists in this database that only",
    "start": "4258239",
    "end": "4263560"
  },
  {
    "text": "has access to store procedures that you created take the time to properly",
    "start": "4263560",
    "end": "4269000"
  },
  {
    "text": "Implement trusted security inte a graded mode um the reason I say this is because",
    "start": "4269000",
    "end": "4274159"
  },
  {
    "text": "just remove that whole SEC SQL security model it's just it's it's ugly it's hideous take the time to use Integrated",
    "start": "4274159",
    "end": "4279840"
  },
  {
    "text": "Security it's not that difficult if if you really just understand how how the thing works it's not that hard to give",
    "start": "4279840",
    "end": "4286679"
  },
  {
    "text": "whatever user context the I server is using for that for anonymous users and",
    "start": "4286679",
    "end": "4292120"
  },
  {
    "text": "give it access to the database it sounds Insidious you're giving Anonymous users access to the datase well they already",
    "start": "4292120",
    "end": "4297760"
  },
  {
    "text": "have access to the database you know if you if you create a a connection string and you put embed you know username",
    "start": "4297760",
    "end": "4304320"
  },
  {
    "text": "password in there you you've given them access to database it's the same thing the important part is that with",
    "start": "4304320",
    "end": "4309960"
  },
  {
    "text": "Integrated Security there's no secret sitting in the connection string anymore it just says you know trusted security equals yes no secret there um it it",
    "start": "4309960",
    "end": "4319120"
  },
  {
    "text": "actually eases it's it's more it's more of a help in administration later on I",
    "start": "4319120",
    "end": "4325199"
  },
  {
    "text": "got to say that because now you don't have to go and rotate passwords and you have somebody that come in and say well we got to rotate our SQL security",
    "start": "4325199",
    "end": "4330960"
  },
  {
    "text": "passwords every two weeks so every two weeks you're going through every application fixing connection strings",
    "start": "4330960",
    "end": "4336960"
  },
  {
    "text": "goes away all right don't Place passwords in script or code uh don't see assign",
    "start": "4336960",
    "end": "4343719"
  },
  {
    "text": "complex essay password even with using Integrated Security um and consider dropping certain procedures in the",
    "start": "4343719",
    "end": "4349560"
  },
  {
    "text": "interest of security um namely XP command shell right because you can drop extended store",
    "start": "4349560",
    "end": "4355199"
  },
  {
    "text": "procedures uh a good attacker will just add it back but you know it's one of",
    "start": "4355199",
    "end": "4361719"
  },
  {
    "text": "those things uh can somebody steal your car if you lock it yeah so why do you lock your car well you lock your car",
    "start": "4361719",
    "end": "4368280"
  },
  {
    "text": "because it stops probably 90% of the people out there that's why you do it write reusable input validation",
    "start": "4368280",
    "end": "4375679"
  },
  {
    "text": "routines and make their use mandatory use store procedures where possible avoid string building for executing them",
    "start": "4375679",
    "end": "4382679"
  },
  {
    "text": "code reviews absolutely necessary evaluate third party code and applications with great scrutiny right",
    "start": "4382679",
    "end": "4388840"
  },
  {
    "text": "somebody's going to incorporate a component in your application or they're going to add some new pages to your",
    "start": "4388840",
    "end": "4396040"
  },
  {
    "text": "system make sure you look at them make sure they're not doing something really stupid use the same kind of methods we just shown to go exactly and look at",
    "start": "4396040",
    "end": "4402600"
  },
  {
    "text": "their applications before they integrate them with yours and uh bring you down with them use SSL or IP sect to encrypt",
    "start": "4402600",
    "end": "4408679"
  },
  {
    "text": "Network traffic on suspect subnets everybody always says well doesn't that degrade performance yes it does so just",
    "start": "4408679",
    "end": "4415760"
  },
  {
    "text": "a matter what's important to you best practices minimize risk uh",
    "start": "4415760",
    "end": "4421000"
  },
  {
    "text": "assume your connection strings are compromised right just assume it it'll happen if you put a connection string in",
    "start": "4421000",
    "end": "4427159"
  },
  {
    "text": "ASP you put it in global ASA if you're using net it'll be in web.config and they move the stuff around but it's it's",
    "start": "4427159",
    "end": "4433520"
  },
  {
    "text": "all the same thing it'll eventually be exposed um deny access to all the tables",
    "start": "4433520",
    "end": "4438760"
  },
  {
    "text": "just like we were talking about use store procedures and Views to force access only through your own database",
    "start": "4438760",
    "end": "4444360"
  },
  {
    "text": "constructs consider using asymmetric encryption on valuable data the reason I say this a lot of people will say well",
    "start": "4444360",
    "end": "4449760"
  },
  {
    "text": "we've encrypted um all of the information all the credit card information on our servers so it's safe",
    "start": "4449760",
    "end": "4455920"
  },
  {
    "text": "well is it like where's the key right if you use symmetric encryption the key is probably sitting on the same machine so",
    "start": "4455920",
    "end": "4461679"
  },
  {
    "text": "if the machine is compromised the key is compromised your data is compromised um one thing that you may want to try is",
    "start": "4461679",
    "end": "4467440"
  },
  {
    "text": "asymmetric encryption this makes things a little more complex right you got to you got to create a public private key pair you have to use the public key to",
    "start": "4467440",
    "end": "4474199"
  },
  {
    "text": "encrypt the data that's actually stored on this on the inside the database and then you have some other backend system",
    "start": "4474199",
    "end": "4480040"
  },
  {
    "text": "with a private key that then decrypts the information for the purposes of",
    "start": "4480040",
    "end": "4485159"
  },
  {
    "text": "reconciliation more complex uh but this way if the SQL Server is compromised the",
    "start": "4485159",
    "end": "4490600"
  },
  {
    "text": "I server is compromised um the data is not compromised and egress filtering right",
    "start": "4490600",
    "end": "4496120"
  },
  {
    "text": "you might want to say why should a singl server be making outgoing connections anywhere why there should be no reasons",
    "start": "4496120",
    "end": "4502760"
  },
  {
    "text": "if it's sitting in some back corner some cubby hole somewhere it shouldn't be initiating connections back out so it",
    "start": "4502760",
    "end": "4508440"
  },
  {
    "text": "shouldn't be trying to FTP things in or be trying to connect to other machines",
    "start": "4508440",
    "end": "4513920"
  },
  {
    "text": "inside the you know the back end somewhere unless of course that's that you know you have linked servers or",
    "start": "4513920",
    "end": "4519199"
  },
  {
    "text": "something like that but you know how to configure these things so that you can kind of contain some of the malicious activity and never place never Place",
    "start": "4519199",
    "end": "4526880"
  },
  {
    "text": "administrative pages on the same server with the normal website code or administrative store procedures and the",
    "start": "4526880",
    "end": "4532800"
  },
  {
    "text": "same database with normal procedures and this is should be obvious to you if I give the if I give that user the right",
    "start": "4532800",
    "end": "4538600"
  },
  {
    "text": "to run store procedures they shouldn't have the really Juicy Store procedures right there in the same database right",
    "start": "4538600",
    "end": "4544000"
  },
  {
    "text": "the Juicy Store procedures for administration should be somewhere else somewhere else entirely and never place",
    "start": "4544000",
    "end": "4549880"
  },
  {
    "text": "the administrative pages I mean that's just obvious best practices integrity SQL",
    "start": "4549880",
    "end": "4555239"
  },
  {
    "text": "demo has a method for database objects um to script the entire database so at",
    "start": "4555239",
    "end": "4560960"
  },
  {
    "text": "some point later on you could use something like this to create your own trip wire system for example script out",
    "start": "4560960",
    "end": "4566520"
  },
  {
    "text": "the entire database and then tomorrow script out the entire database are the two scripts the same no uh",
    "start": "4566520",
    "end": "4573560"
  },
  {
    "text": "oh web services this is we're start talking about net a little bit I've been doing a lot of net development lately so",
    "start": "4573560",
    "end": "4579280"
  },
  {
    "text": "I guess wanted to make a few comments about that um actually the web services my opinion don't have anything really do",
    "start": "4579280",
    "end": "4585199"
  },
  {
    "text": "with net marketing stuff but web services you can do anywhere anyhow right but the point is that no matter",
    "start": "4585199",
    "end": "4591639"
  },
  {
    "text": "how you implement them they're probably front- ending database operations so there's no reason and I've already shown",
    "start": "4591639",
    "end": "4596719"
  },
  {
    "text": "that you can do SQL injection through web services so watch out for that um so",
    "start": "4596719",
    "end": "4603199"
  },
  {
    "text": "The NET Framework also provides input validation encryption and session management function use them most of the",
    "start": "4603199",
    "end": "4608520"
  },
  {
    "text": "same all the attacks that we've shown here today can be done in net it's not",
    "start": "4608520",
    "end": "4613560"
  },
  {
    "text": "going to protect you from any of this stuff what it does do what net does give you is some reusable components that",
    "start": "4613560",
    "end": "4618719"
  },
  {
    "text": "help this right they give you things like validation controls and so forth that make it a lot easier to do input",
    "start": "4618719",
    "end": "4623840"
  },
  {
    "text": "validation you don't have to go and write you know a kazillion um you know regular expression functions and all",
    "start": "4623840",
    "end": "4629239"
  },
  {
    "text": "this kind of mess but they help you out but you're still going to have to work at this you you you know you technology",
    "start": "4629239",
    "end": "4635760"
  },
  {
    "text": "goes on but bad coding is eternal I you can still make your application so bad",
    "start": "4635760",
    "end": "4641440"
  },
  {
    "text": "that yes not even duet's going to save you and here are some reference links just",
    "start": "4641440",
    "end": "4647040"
  },
  {
    "text": "if you want to find some more information about SQL SQL uh server security",
    "start": "4647040",
    "end": "4653239"
  },
  {
    "text": "and you know how to break it basically recommended reading these are just some",
    "start": "4653239",
    "end": "4658280"
  },
  {
    "text": "books I like um everybody probably has their own I I basically give RFP credit",
    "start": "4658280",
    "end": "4663639"
  },
  {
    "text": "for getting me started in uh SQL Server security specifically because of of his Frack article um it was very good and uh",
    "start": "4663639",
    "end": "4671239"
  },
  {
    "text": "that's what started me down this track so I want to give him credit for that and uh that's basically it that's my",
    "start": "4671239",
    "end": "4676840"
  },
  {
    "text": "presentation so if there's any questions that's",
    "start": "4676840",
    "end": "4682920"
  },
  {
    "text": "it we'll see you L and this was the",
    "start": "4687159",
    "end": "4693719"
  },
  {
    "text": "finger",
    "start": "4703760",
    "end": "4706760"
  },
  {
    "text": "e",
    "start": "4733719",
    "end": "4736719"
  },
  {
    "text": "e",
    "start": "4763719",
    "end": "4766719"
  },
  {
    "text": "e",
    "start": "4793639",
    "end": "4796639"
  },
  {
    "text": "e for",
    "start": "4823639",
    "end": "4827679"
  }
]