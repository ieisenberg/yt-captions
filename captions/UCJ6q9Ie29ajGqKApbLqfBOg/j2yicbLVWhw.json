[
  {
    "text": "hello everyone so to to get a little bit onto the agenda today's session will be",
    "start": "3240",
    "end": "9400"
  },
  {
    "text": "about Well Network appliances and some new challenges that we face with new technology and at the core of our talk",
    "start": "9400",
    "end": "16320"
  },
  {
    "text": "will be five vulnerabilities that we disclose to a five and quite a bit of",
    "start": "16320",
    "end": "22119"
  },
  {
    "text": "introductory material to why they are important because those vulnerabilities are kind of recurring thing in network",
    "start": "22119",
    "end": "28080"
  },
  {
    "text": "devices especially in the recent years so my name is Vlad vladislav bkin or",
    "start": "28080",
    "end": "33600"
  },
  {
    "text": "Vlad bkin for short I'm a network and web hacker for the most part also a web",
    "start": "33600",
    "end": "38920"
  },
  {
    "text": "developer I have around 10 years of experience in security specifically I'm also a very long time CTF player so I",
    "start": "38920",
    "end": "45640"
  },
  {
    "text": "have been playing since like 2015 maybe or even earlier and right now I'm",
    "start": "45640",
    "end": "51399"
  },
  {
    "text": "working as a security researcher at eclips so yeah that's enough about me so",
    "start": "51399",
    "end": "58359"
  },
  {
    "text": "but before we start to dive into the newer network devices challenges let's",
    "start": "58359",
    "end": "64080"
  },
  {
    "text": "discuss a little bit at how they actually evolved because this is very relevant to the talk and in my opinion",
    "start": "64080",
    "end": "70119"
  },
  {
    "text": "really really important topic so at first if you look at aack surface",
    "start": "70119",
    "end": "77000"
  },
  {
    "text": "the devices were pretty simple like sometimes they might have been a simple binary like a single binary firmware",
    "start": "77000",
    "end": "83240"
  },
  {
    "text": "something like this and there were not a lot of attacks on them like at the very least not publicly known and most most",
    "start": "83240",
    "end": "90040"
  },
  {
    "text": "of the things listed here are different nation state groups performing those attacks or leaks from nation state group",
    "start": "90040",
    "end": "97280"
  },
  {
    "text": "tools and attacks were pretty pricey so some very popular things like wepn",
    "start": "97280",
    "end": "103520"
  },
  {
    "text": "filter was very well-known attack or Shadow Brokers drama was pretty much big thing",
    "start": "103520",
    "end": "109920"
  },
  {
    "text": "right but then in 2019 one very big event happened like",
    "start": "109920",
    "end": "115000"
  },
  {
    "text": "really big and important event that pretty much just changed the entire field here it was solar attack while it",
    "start": "115000",
    "end": "121560"
  },
  {
    "text": "was not directly related to network devices it was a very big and popular",
    "start": "121560",
    "end": "127159"
  },
  {
    "text": "case of an infrastructure attack we just got everybody because everybody is using solar winds and after that this is what",
    "start": "127159",
    "end": "136080"
  },
  {
    "text": "we see so we just see a flurry of new zero days vulnerabilities in all of",
    "start": "136080",
    "end": "142400"
  },
  {
    "text": "network devices imaginable we see a lot of people abusing them and in this case it was not even nation state actors but",
    "start": "142400",
    "end": "148920"
  },
  {
    "text": "just random script KY sometimes because some of the attacks some of the vulnerabilities are Twi siiz thing like",
    "start": "148920",
    "end": "156080"
  },
  {
    "text": "it's a Twi size exploit that really easy to reproduce once you know what the vulnerability is and what we observed is",
    "start": "156080",
    "end": "162640"
  },
  {
    "text": "that sometimes it tookes maybe a day to actually weaponize for even a very small",
    "start": "162640",
    "end": "167800"
  },
  {
    "text": "attacker like small time people who just try to install minor malver on them and",
    "start": "167800",
    "end": "172920"
  },
  {
    "text": "notably if you look at 2020 2021 2022 we have three different five zero days we",
    "start": "172920",
    "end": "179560"
  },
  {
    "text": "see see Citrix as a recuring topic we see foret as a recuring topic so pretty",
    "start": "179560",
    "end": "185879"
  },
  {
    "text": "much we are getting the same vulnerabilities and at some point it got so bad that CIS actually started to",
    "start": "185879",
    "end": "191799"
  },
  {
    "text": "issue a directive to fix all of that and that we need more secure software right",
    "start": "191799",
    "end": "196920"
  },
  {
    "text": "so that's pretty much Short History short intro and to give some some extra",
    "start": "196920",
    "end": "202239"
  },
  {
    "text": "context as I said some attacks are literally twet sized so in this case I just took a screenshot of",
    "start": "202239",
    "end": "208760"
  },
  {
    "text": "2022 1388 right and that's a full exploit so it really fits in a single",
    "start": "208760",
    "end": "214640"
  },
  {
    "text": "screenshot and the exploit is also pretty simple we just instruct the device to run a command right so we are",
    "start": "214640",
    "end": "221439"
  },
  {
    "text": "facing really basic web application problems and by the way it's not",
    "start": "221439",
    "end": "226640"
  },
  {
    "text": "plaguing just the network devices it's plaguing things like BMC like baseboard management controllers which that manage",
    "start": "226640",
    "end": "233200"
  },
  {
    "text": "your servers they also got more powerful and as such they also got basic web apps running in them so in fact modern",
    "start": "233200",
    "end": "240840"
  },
  {
    "text": "devices are ultimately an x64 platform",
    "start": "240840",
    "end": "246200"
  },
  {
    "text": "which basically all your computer spcs use and they face the same issues as them you have a web application running",
    "start": "246200",
    "end": "254000"
  },
  {
    "text": "on them and because they have so much Firepower now you can see PHP Lua python",
    "start": "254000",
    "end": "259479"
  },
  {
    "text": "all of the scripting languages on them not just compiled binaries you also have Central manager appliances like a",
    "start": "259479",
    "end": "266560"
  },
  {
    "text": "central manager panel that manages all of them at once and it has even databases so you can",
    "start": "266560",
    "end": "272880"
  },
  {
    "text": "face database related issues and now we have a full scale Linux but it only has",
    "start": "272880",
    "end": "279000"
  },
  {
    "text": "usually a single user like for example root and everything running is is running as that user so we are back to",
    "start": "279000",
    "end": "284759"
  },
  {
    "text": "the '90s and good old times when you just had to get a code execution and suddenly you got your entire machine but",
    "start": "284759",
    "end": "290880"
  },
  {
    "text": "we facing this right now on network devices and while before they were pretty small and they didn't have a lot",
    "start": "290880",
    "end": "297919"
  },
  {
    "text": "of space so you had to narrow down what's installed on them nowadays it's not the case anymore they come with all",
    "start": "297919",
    "end": "304320"
  },
  {
    "text": "of the tools imaginable so attacker sometimes comes into the platform and already has tools to interact with web",
    "start": "304320",
    "end": "310600"
  },
  {
    "text": "like curl vat and everything else and they don't even get OS updates normally",
    "start": "310600",
    "end": "315840"
  },
  {
    "text": "because of different complications I'll discuss a little bit on more on this shortly but they normally don't have",
    "start": "315840",
    "end": "321919"
  },
  {
    "text": "something like an attended upgrades package or anything like that so they slowly get outdated without ever fixing",
    "start": "321919",
    "end": "328400"
  },
  {
    "text": "themselves and just to uh get add to the point like",
    "start": "328400",
    "end": "334240"
  },
  {
    "text": "here are two Mo motherboards from two devices on the left we have Cisco ASA",
    "start": "334240",
    "end": "339520"
  },
  {
    "text": "firewall and on the right we have a five big IP disassembly and if you for a",
    "start": "339520",
    "end": "344960"
  },
  {
    "text": "second just close with your hands logos on them it will be really hard to tell",
    "start": "344960",
    "end": "350000"
  },
  {
    "text": "that these are not a normal server with some very specific hardware for some specific task so we have a CPU right",
    "start": "350000",
    "end": "357600"
  },
  {
    "text": "here we have memory sticks for example here we have a hard drive we have all of",
    "start": "357600",
    "end": "363000"
  },
  {
    "text": "the normal server stuff with maybe oh hey whatever this is right so but if you",
    "start": "363000",
    "end": "368599"
  },
  {
    "text": "really literally close the vendor it will be really hard to identify them as something other than a server so and",
    "start": "368599",
    "end": "375160"
  },
  {
    "text": "that's a very interesting point it's just normal server hardware and if you look at the shells",
    "start": "375160",
    "end": "382080"
  },
  {
    "text": "of those devices it's also just normal Linux shells on the left we have big IP",
    "start": "382080",
    "end": "388000"
  },
  {
    "text": "next Central manager shell and if you look at its file system we see normal Linux folders you expect to",
    "start": "388000",
    "end": "394240"
  },
  {
    "text": "see like boot Dev Etc with maybe like a couple of files that are specific to the platform like version but on the right",
    "start": "394240",
    "end": "402120"
  },
  {
    "text": "we have a much more limited device a baseboard management controller shell specifically it's a mega shell and you",
    "start": "402120",
    "end": "410560"
  },
  {
    "text": "can see that it uses a some some interesting usern name called CIS admin but if you actually digs for its files",
    "start": "410560",
    "end": "417440"
  },
  {
    "text": "you will find out that CIS admin is user U zero so it's pretty much root but renamed for some reason and you also see",
    "start": "417440",
    "end": "425080"
  },
  {
    "text": "some folders that are not normally seen on Linux Hardware like big up config I",
    "start": "425080",
    "end": "431039"
  },
  {
    "text": "don't know how to read this so that I highlight that there are only four letters maybe some configurations for edus etc etc but you can still see all",
    "start": "431039",
    "end": "438840"
  },
  {
    "text": "of still see all of the normal Linux folders interestingly enough the hardware on the right actually is using",
    "start": "438840",
    "end": "445039"
  },
  {
    "text": "squash of s so problems with updates there is much more hard to solve than on",
    "start": "445039",
    "end": "451080"
  },
  {
    "text": "many other platforms you cannot just install new stuff to squash of s it's meant to be read only so actually",
    "start": "451080",
    "end": "457759"
  },
  {
    "text": "solving all of the issues that they named is not so simple you cannot keep them updated automatically because they sometimes have very limited space and",
    "start": "457759",
    "end": "464240"
  },
  {
    "text": "have to deal with all of this right but bottom line is we have Linux",
    "start": "464240",
    "end": "471479"
  },
  {
    "text": "boxes from the '90s but we in 2024 with 2024 tools and we know a lot more about",
    "start": "471479",
    "end": "477919"
  },
  {
    "text": "axon Linux now and we can just apply all of this knowledge that previously was not available to break those boxes but",
    "start": "477919",
    "end": "486240"
  },
  {
    "text": "the worst part is Yet to Come it does not really end there because normally",
    "start": "486240",
    "end": "491479"
  },
  {
    "text": "what you get on this new boxes the network devices is usually a single",
    "start": "491479",
    "end": "496599"
  },
  {
    "text": "glass pane view of the device you normally don't even get a shell so for example the shell that I did show you on",
    "start": "496599",
    "end": "502960"
  },
  {
    "text": "megaro device this one on the right it's not normally even available to the",
    "start": "502960",
    "end": "508440"
  },
  {
    "text": "administrator so we had to exploit the vulnerability in the device to get to this shell so if attacker actually",
    "start": "508440",
    "end": "515360"
  },
  {
    "text": "managed to set up home here I would not see it like as a Defender I would literally not see it until I exploit the",
    "start": "515360",
    "end": "522000"
  },
  {
    "text": "device or maybe unsolder the chip and pretty much dump the firmware which is as you can as you can guess is not very",
    "start": "522000",
    "end": "528360"
  },
  {
    "text": "productive on a large deployment right so and the question is the big question",
    "start": "528360",
    "end": "535160"
  },
  {
    "text": "is how do we in this case we as an industry actually fix all of those problems because we cannot just dump",
    "start": "535160",
    "end": "541959"
  },
  {
    "text": "this on a vendor vendor cannot Define good standards normally and in this case",
    "start": "541959",
    "end": "547560"
  },
  {
    "text": "there is good question on how do we even approach this and to this point like I",
    "start": "547560",
    "end": "552640"
  },
  {
    "text": "collected Three Links at the very least I'll probably click through them and talk a little bit about",
    "start": "552640",
    "end": "558160"
  },
  {
    "text": "it so the first link is from cisa and cisa is pretty much calling for urgent",
    "start": "558160",
    "end": "564160"
  },
  {
    "text": "need for memory safety in software products so TSA is asking all the new",
    "start": "564160",
    "end": "569880"
  },
  {
    "text": "developments to be done using memory safe languages like say go say rust maybe scripting languages which are",
    "start": "569880",
    "end": "575920"
  },
  {
    "text": "protected from memory leaks and whatnot this will protect us from a lot of binary exploits that happened in the past like buer buffer over flows etc etc",
    "start": "575920",
    "end": "584680"
  },
  {
    "text": "right uh then DARPA is pretty much oh decided to",
    "start": "584680",
    "end": "591519"
  },
  {
    "text": "click on the slide and not on the link so DARPA is asking us to pretty much eliminate memory safety vulnerability",
    "start": "591519",
    "end": "597240"
  },
  {
    "text": "once and for all I would say this headliner is pretty much speaks for itself no extra comments needed and then",
    "start": "597240",
    "end": "605079"
  },
  {
    "text": "also TSA was uh talented to do like secure by Design Systems where we should",
    "start": "605079",
    "end": "611320"
  },
  {
    "text": "eliminate command injection vulnerabilities and the common topic here is that all of those are targeting",
    "start": "611320",
    "end": "617320"
  },
  {
    "text": "one specific vulnerability at a time it works and I will just in a moment show",
    "start": "617320",
    "end": "623120"
  },
  {
    "text": "you how this approach can be applied in production and was applied by at least one company but it doesn't really protect",
    "start": "623120",
    "end": "630240"
  },
  {
    "text": "you from everything we have a lot more vulnerability than just memory safety related bugs command injection bugs we",
    "start": "630240",
    "end": "636480"
  },
  {
    "text": "have a lot more than that so a little bit of a Side Story is",
    "start": "636480",
    "end": "644000"
  },
  {
    "text": "Big IP platform in general a 5 big IP is pretty much an application delivery platform so it handles all of the things",
    "start": "644000",
    "end": "650959"
  },
  {
    "text": "like TLS registration like vaff deployments of the application it has a lot of tools to actually manage your",
    "start": "650959",
    "end": "657639"
  },
  {
    "text": "application and the plat got hit with things like 2022 1388 that I just showed",
    "start": "657639",
    "end": "663240"
  },
  {
    "text": "you in a screenshot so really simple exploits with just you know command injuction or something more complex but",
    "start": "663240",
    "end": "669480"
  },
  {
    "text": "still something that fits in one tweet and I don't know why they decided to",
    "start": "669480",
    "end": "675399"
  },
  {
    "text": "switch to a big IP next platform and why they decided to do the right but judging from what we saw on the inside once we",
    "start": "675399",
    "end": "681399"
  },
  {
    "text": "open the platform up a little bit they definitely had Security in mind as well",
    "start": "681399",
    "end": "686760"
  },
  {
    "text": "so they pretty much man great a central manager uh appliance which manages all",
    "start": "686760",
    "end": "693560"
  },
  {
    "text": "of those five big AP next devices at once and it's a completely right of the platform so there is no more single user",
    "start": "693560",
    "end": "701839"
  },
  {
    "text": "thing going in there and what they used were kubernetes and golang in this case",
    "start": "701839",
    "end": "710000"
  },
  {
    "text": "they created a platform based on microservices and on the right we have a",
    "start": "710000",
    "end": "715079"
  },
  {
    "text": "screenshot specifically from Central manager but if I show you the same screen shot from the device it will",
    "start": "715079",
    "end": "720480"
  },
  {
    "text": "still have similar microservices so the literally went all in on the kubernetes",
    "start": "720480",
    "end": "726320"
  },
  {
    "text": "docker containers isolation and memory safety so we have over 30 microservices",
    "start": "726320",
    "end": "731680"
  },
  {
    "text": "in both the device and Central manager and if you look through here you might",
    "start": "731680",
    "end": "736959"
  },
  {
    "text": "notice that we have a postgrad database so it's not a single account in the postgrad database they have an account",
    "start": "736959",
    "end": "743839"
  },
  {
    "text": "per microservice with really good access controls so you cannot access tables",
    "start": "743839",
    "end": "749000"
  },
  {
    "text": "from from another microservice using credentials from your current one so this is supposed to limit the scope for",
    "start": "749000",
    "end": "754800"
  },
  {
    "text": "things like skl injection or credential leaks and to add to that on on top they",
    "start": "754800",
    "end": "761920"
  },
  {
    "text": "actually used hashicorp volt for credential management so they literally EV allowed to actually make it more",
    "start": "761920",
    "end": "767279"
  },
  {
    "text": "secure and again this closely follows this sisa goal that they just showed you",
    "start": "767279",
    "end": "773760"
  },
  {
    "text": "for memory safety so it does indeed use memory safe languages it even uses",
    "start": "773760",
    "end": "779880"
  },
  {
    "text": "containers like Dres containers and it even has uh separate users in those",
    "start": "779880",
    "end": "784959"
  },
  {
    "text": "containers so that stuff is not even running as Rootin there so it does in fact improve security posture of the",
    "start": "784959",
    "end": "790760"
  },
  {
    "text": "device so no questions there but let's dig into the device",
    "start": "790760",
    "end": "797120"
  },
  {
    "text": "first so in this case we'll be discussing virtual devices here but",
    "start": "797120",
    "end": "802959"
  },
  {
    "text": "physical device is no different so they still have all of the same things just slightly harder to get to and",
    "start": "802959",
    "end": "809839"
  },
  {
    "text": "notably steps for virtual device and for Central manager in this case are similar and after the device set up you as a",
    "start": "809839",
    "end": "816360"
  },
  {
    "text": "researcher or as a Defender you can get into an admin Shell at least in the virtual device in the physical device it",
    "start": "816360",
    "end": "822160"
  },
  {
    "text": "will be slightly harder but not that much more difficult and here is pretty much the screenshots of the shells and",
    "start": "822160",
    "end": "829160"
  },
  {
    "text": "you get in as an admin user an admin user has sudo privileges so you get pretty much Ro access okay what",
    "start": "829160",
    "end": "837639"
  },
  {
    "text": "next so in this case we do have to take a page out of devs books and how they",
    "start": "837639",
    "end": "844639"
  },
  {
    "text": "manage kubernetes containers so Cube CTL get pods is how you would list everything that's running on the device",
    "start": "844639",
    "end": "851560"
  },
  {
    "text": "and then using the command I'll probably not read it out you can actually run for example sh binaries inside of the",
    "start": "851560",
    "end": "858680"
  },
  {
    "text": "containers one notable point is that it will not work with go containers because",
    "start": "858680",
    "end": "863920"
  },
  {
    "text": "they're using dless containers they literally have a single binary with minimal files for it",
    "start": "863920",
    "end": "870079"
  },
  {
    "text": "and software in there is not even running as route so I just went through maybe not all containers but quite a few",
    "start": "870079",
    "end": "875360"
  },
  {
    "text": "of them a few of them and checked this privileges but those containers are still not magic and you can still find a",
    "start": "875360",
    "end": "882560"
  },
  {
    "text": "lot of interesting stuff on the device like if you browse it long and hard enough you may stumble upon this Beast",
    "start": "882560",
    "end": "889279"
  },
  {
    "text": "of a pass which just very long but once you get there and you list what's in",
    "start": "889279",
    "end": "894720"
  },
  {
    "text": "there you see all of the containers contents like the file systems for each container and in this case like I just",
    "start": "894720",
    "end": "901399"
  },
  {
    "text": "tried to find all of the go binaries and for example here we have a DNS feature binary so as a researcher you got access",
    "start": "901399",
    "end": "909199"
  },
  {
    "text": "from the root shell to all of them and you can actually research the device pretty easily this way once you actually have the files you can reverse engineer",
    "start": "909199",
    "end": "916000"
  },
  {
    "text": "them read the configs so you basically have enough Firepower to actually do something",
    "start": "916000",
    "end": "923480"
  },
  {
    "text": "okay let's be honest here this destroys outright destroys a lot of attack vectors so so even if you get command",
    "start": "923480",
    "end": "930600"
  },
  {
    "text": "injection how are you going to exploit it like your command injection might be just an a go container with the single",
    "start": "930600",
    "end": "936720"
  },
  {
    "text": "go binary that's already running good luck exploiting it I guess so you have",
    "start": "936720",
    "end": "942199"
  },
  {
    "text": "to bring tools to those containers and it's sometimes much harder go is memory safe so there is probably not going to",
    "start": "942199",
    "end": "949600"
  },
  {
    "text": "be an easy binary attack like before you're probably not going to get a buffer overflow Heap overflow or",
    "start": "949600",
    "end": "954720"
  },
  {
    "text": "anything of the sorts you probably are not going to get instant rout either so even if you manage to bypass all of the",
    "start": "954720",
    "end": "960560"
  },
  {
    "text": "hurdles here you are running in a container so good luck breaking out to the host shell and also because it's",
    "start": "960560",
    "end": "967480"
  },
  {
    "text": "using microservices it has less poorly designed features just by virtue of using microservices you cannot design",
    "start": "967480",
    "end": "975040"
  },
  {
    "text": "something as poorly when you have all of those walls in between things so even without further analysis it's obvious",
    "start": "975040",
    "end": "981680"
  },
  {
    "text": "that they had to put a lot more time into the design there so you're probably going to hit isolation issues for when",
    "start": "981680",
    "end": "987920"
  },
  {
    "text": "you try to explore exploit the device but does it solve all of the issues and",
    "start": "987920",
    "end": "994759"
  },
  {
    "text": "our claim is that no it doesn't and we can demonstrate that but also it doesn't solve them even when you apply just pure",
    "start": "994759",
    "end": "1000920"
  },
  {
    "text": "Logics all right so first of all we are now using microservices and as we have",
    "start": "1000920",
    "end": "1007639"
  },
  {
    "text": "microservices and Inter device interactions like we have one Appliance calling another server side request",
    "start": "1007639",
    "end": "1013519"
  },
  {
    "text": "forgery issues are probably going to be present if you look hard enough for them because there is a lot of HTTP and maybe",
    "start": "1013519",
    "end": "1020319"
  },
  {
    "text": "other Communications going on in between all of the microservices that's how they operate so that's a new Surface which",
    "start": "1020319",
    "end": "1027160"
  },
  {
    "text": "never existed before network devices which might be exploitable we are not sure yet but just pure logic tells us",
    "start": "1027160",
    "end": "1033400"
  },
  {
    "text": "that it might be there other injections other than command injections might still exist and be useful so while we do",
    "start": "1033400",
    "end": "1040558"
  },
  {
    "text": "have separate database accounts there is nothing inherent in golang or kubernetes or any of the Technologies named that",
    "start": "1040559",
    "end": "1047319"
  },
  {
    "text": "prevents a skill injection from appearing even if you have access only to a small portion of the database",
    "start": "1047319",
    "end": "1053200"
  },
  {
    "text": "things like xss insecure direct act object reference issues loation related bugs and what whatever other bugs you",
    "start": "1053200",
    "end": "1060200"
  },
  {
    "text": "can imagine they don't really get a lot of coverage from kubernetes or goang either so you probably cannot type",
    "start": "1060200",
    "end": "1066840"
  },
  {
    "text": "juggle but that's it there is no further coverage and there is still no solution",
    "start": "1066840",
    "end": "1073160"
  },
  {
    "text": "to component freshness so the device arrives as is and until you update it it just stays the same and this list is",
    "start": "1073160",
    "end": "1079480"
  },
  {
    "text": "probably not even exhausted so let's see some of the vulnerabilities in practice and I'll",
    "start": "1079480",
    "end": "1086360"
  },
  {
    "text": "just demo what we found so I'll try to make the demo go live so if it breaks I",
    "start": "1086360",
    "end": "1092919"
  },
  {
    "text": "will switch to a recording so and the very first issue that we found it's",
    "start": "1092919",
    "end": "1098640"
  },
  {
    "text": "pretty much Z for mentioned the scale injection in the Lin form so they made",
    "start": "1098640",
    "end": "1103720"
  },
  {
    "text": "all of the fixes all of the changes all of the important work to actually make it memory safe and Prov command",
    "start": "1103720",
    "end": "1109240"
  },
  {
    "text": "injections but because there was no standard to follow not no standard to actually check for say aop 10",
    "start": "1109240",
    "end": "1115480"
  },
  {
    "text": "bugs they managed to miss an scl injection and the attack is here and",
    "start": "1115480",
    "end": "1121480"
  },
  {
    "text": "it's in login form and we use it specifically to let me actually run this",
    "start": "1121480",
    "end": "1126880"
  },
  {
    "text": "exact attack so we use it to leak the admin password hash so it's leaking the",
    "start": "1126880",
    "end": "1132480"
  },
  {
    "text": "hash one bite at a time and I'm running over ran connection so it take a moment to actually start showing the first",
    "start": "1132480",
    "end": "1138880"
  },
  {
    "text": "character of it but let's give it a bit of time and I will keep talking about it so while it's an injection in the login",
    "start": "1138880",
    "end": "1145919"
  },
  {
    "text": "form theoretically it might be possible to completely bypass authentication but",
    "start": "1145919",
    "end": "1151559"
  },
  {
    "text": "this attack proved to be much more complicated due to specifics of how it is implemented so we never actually",
    "start": "1151559",
    "end": "1157679"
  },
  {
    "text": "finished it due to time constraints but the attack might be possible to completely bypass authentication just",
    "start": "1157679",
    "end": "1164039"
  },
  {
    "text": "much harder to achieve than something like a hash leak and as you can see hash started",
    "start": "1164039",
    "end": "1169400"
  },
  {
    "text": "appearing and this is just from the header of the hash is a bcrypt hash with",
    "start": "1169400",
    "end": "1175440"
  },
  {
    "text": "a cost of six to put it into context modern recommendation for password",
    "start": "1175440",
    "end": "1180640"
  },
  {
    "text": "hashing if you use bcrypt is to use at least 11 as the cash cost and cost is",
    "start": "1180640",
    "end": "1186679"
  },
  {
    "text": "exponential so it's not two times as low it's exponentially lower and that's very important because once we actually",
    "start": "1186679",
    "end": "1192960"
  },
  {
    "text": "started to try to brute force it just to see how fast it brute force would go",
    "start": "1192960",
    "end": "1198720"
  },
  {
    "text": "single 490 card can go at 110,000 attempts per second a well",
    "start": "1198720",
    "end": "1205120"
  },
  {
    "text": "funded attacker can have millions per second easily using either more gpus than we did or using fpj arrays you can",
    "start": "1205120",
    "end": "1212159"
  },
  {
    "text": "pretty much Google the article on people who did it and in the meantime hash managed to leak five characters so as",
    "start": "1212159",
    "end": "1218000"
  },
  {
    "text": "you can see the hash leak is very practical and this is what you would see if you let it run until then I will",
    "start": "1218000",
    "end": "1223480"
  },
  {
    "text": "probably aboard this one so once you actually BR Force this hash you got as",
    "start": "1223480",
    "end": "1229320"
  },
  {
    "text": "much as an admin MoDOT in the system and let me actually show you the console for the device and how",
    "start": "1229320",
    "end": "1236120"
  },
  {
    "text": "that would look like so I obviously have credentials for",
    "start": "1236120",
    "end": "1244000"
  },
  {
    "text": "it so when you actually log into the console you get pretty much admin",
    "start": "1246360",
    "end": "1251480"
  },
  {
    "text": "account so you don't get full bus shell or anything of the sorts but you can still manage users manage of the big AP",
    "start": "1251480",
    "end": "1258600"
  },
  {
    "text": "next instances so our injection was actually in the central manager Appliance right so we get access to",
    "start": "1258600",
    "end": "1264880"
  },
  {
    "text": "pretty much the same things that your system administrator would right so we",
    "start": "1264880",
    "end": "1271279"
  },
  {
    "text": "can see the device versions We can reconfigure anything we like but that's not where vulnerabilities end there is",
    "start": "1271279",
    "end": "1278200"
  },
  {
    "text": "at least one other issue which is much more interesting to discuss so once you",
    "start": "1278200",
    "end": "1286279"
  },
  {
    "text": "actually break into the device and you have admin password somehow or you did bypass authentication as I mentioned how",
    "start": "1286279",
    "end": "1293559"
  },
  {
    "text": "do you persist like admin can just change your his password or something that you can no longer boot force or",
    "start": "1293559",
    "end": "1299360"
  },
  {
    "text": "maybe just patch out the vulnerability because if I released patches for this now well you can create users on",
    "start": "1299360",
    "end": "1307600"
  },
  {
    "text": "specific devices so you can pretty much connect",
    "start": "1307600",
    "end": "1312679"
  },
  {
    "text": "to specific big bigp devices and make users in them using Central manager this",
    "start": "1312679",
    "end": "1318360"
  },
  {
    "text": "is is pretty much the ssrf issue again I just talked about when you attach bigp",
    "start": "1318360",
    "end": "1324039"
  },
  {
    "text": "NEX device to the central manager console it removes all of the users on that device and users no longer even",
    "start": "1324039",
    "end": "1330480"
  },
  {
    "text": "show up in the UI but using an ssrf issue where they don't control the URL",
    "start": "1330480",
    "end": "1336120"
  },
  {
    "text": "that you can call on the device you can make new users you can just forward a make user requests through the central",
    "start": "1336120",
    "end": "1342480"
  },
  {
    "text": "manager and just make a user that's no longer visible by the Admin and I just pretty much did just that",
    "start": "1342480",
    "end": "1349159"
  },
  {
    "text": "and this is my new user on the device I can pretty much copy this here then I",
    "start": "1349159",
    "end": "1355440"
  },
  {
    "text": "can paste it here right just so that we are using the account we just",
    "start": "1355440",
    "end": "1361080"
  },
  {
    "text": "created and I can then go ahead and login on the implanted devices right and",
    "start": "1361080",
    "end": "1367400"
  },
  {
    "text": "with this I can do anything on the device that I would like so I got full management of the device I'm using it to",
    "start": "1367400",
    "end": "1373559"
  },
  {
    "text": "just show a bunch of device data like for example basic device information",
    "start": "1373559",
    "end": "1378679"
  },
  {
    "text": "like this management IP addresses or what platform it's running on list all of the available device logs and just",
    "start": "1378679",
    "end": "1384880"
  },
  {
    "text": "get a couple of lines from log file but I can reconfigure device as I can see fit this user has full admin privileges",
    "start": "1384880",
    "end": "1391240"
  },
  {
    "text": "on the specific big Apex device that's being managed which is pretty bad so even if",
    "start": "1391240",
    "end": "1397240"
  },
  {
    "text": "you as admin patched your system changed your password checked that there is no",
    "start": "1397240",
    "end": "1403159"
  },
  {
    "text": "remaining attacker presence in the central manager console attacker can still have this user which is nowhere",
    "start": "1403159",
    "end": "1409679"
  },
  {
    "text": "visible in the central manager console and the only way to detect them is by actually abusing the same exploit so I",
    "start": "1409679",
    "end": "1418520"
  },
  {
    "text": "have created pretty much an a an exp use of this exploit which",
    "start": "1418520",
    "end": "1425080"
  },
  {
    "text": "instead of getting which instead of making users is getting the users using",
    "start": "1425080",
    "end": "1430320"
  },
  {
    "text": "again the same SSR vulnerability and here is a list of what I managed to demo so far right so I need to test the",
    "start": "1430320",
    "end": "1437360"
  },
  {
    "text": "exploits and obviously created a whole bunch of them so yeah and ours is I",
    "start": "1437360",
    "end": "1442679"
  },
  {
    "text": "believe this one so we can actually detect those users but you have to use the exploit to do this which is pretty",
    "start": "1442679",
    "end": "1448400"
  },
  {
    "text": "much was at the start of the presentation as a Defender you still don't get the the correct view so the",
    "start": "1448400",
    "end": "1454720"
  },
  {
    "text": "only way to detect those users is like this or you can unscrew the device and",
    "start": "1454720",
    "end": "1459760"
  },
  {
    "text": "dump the hard drive or reactivate the shell whatever you prefer so neither of the two options are great because you",
    "start": "1459760",
    "end": "1465960"
  },
  {
    "text": "have to decommission the device to do this right right so we have a total of five",
    "start": "1465960",
    "end": "1472520"
  },
  {
    "text": "vulnerabilities and I showcased four there are actually two injections which lead to similar results one is an SQL",
    "start": "1472520",
    "end": "1479480"
  },
  {
    "text": "injection and the other is an OD dat injection in the same form in a different field so we get two for one",
    "start": "1479480",
    "end": "1487360"
  },
  {
    "text": "ssrf issue that I showcased does not even have a CV number and I will comment on this y closer to the end of the",
    "start": "1487360",
    "end": "1494559"
  },
  {
    "text": "presentation and the V bcrypt hash what I didn't showcase but it still exists is",
    "start": "1494559",
    "end": "1499880"
  },
  {
    "text": "that once you actually login as an admin you can reset your own password without",
    "start": "1499880",
    "end": "1505919"
  },
  {
    "text": "current password so if you logged in somehow or you managed to just come to the admin machine you can pretty much",
    "start": "1505919",
    "end": "1512080"
  },
  {
    "text": "reset his password without his previous one which is not so great again BS 101",
    "start": "1512080",
    "end": "1517760"
  },
  {
    "text": "tells that this is not this is not normal so but you still can do this I just didn't demo it so as per why we",
    "start": "1517760",
    "end": "1526440"
  },
  {
    "text": "didn't get CV numbers if five pretty much told us that those are not vulnerabilities because they require you",
    "start": "1526440",
    "end": "1532799"
  },
  {
    "text": "admin privileges to to use and there is nothing we can do about that unfortunately but we did notify the",
    "start": "1532799",
    "end": "1538840"
  },
  {
    "text": "vendor so and conclusions for the exploit are is that every listed",
    "start": "1538840",
    "end": "1544760"
  },
  {
    "text": "vulnerability every single one is a noas 10 issue so we have two injection",
    "start": "1544760",
    "end": "1552120"
  },
  {
    "text": "vulnerabilities one cryptography fail with to too low hash cost we have a",
    "start": "1552120",
    "end": "1557159"
  },
  {
    "text": "broken Access Control and we have an ssrf issue right all of them can be",
    "start": "1557159",
    "end": "1562240"
  },
  {
    "text": "classified easily as something very common to the web applications and even after applying whatever was in the",
    "start": "1562240",
    "end": "1568080"
  },
  {
    "text": "Articles to the nines they still exists additionally all of the microservices do",
    "start": "1568080",
    "end": "1573200"
  },
  {
    "text": "depend on some libraries for example but it's really hard to tell because a go binary is a go binary it's pretty much",
    "start": "1573200",
    "end": "1578640"
  },
  {
    "text": "just a single compiled binary you need to pretty much decompile it somehow or disassemble it to to get all of those",
    "start": "1578640",
    "end": "1584559"
  },
  {
    "text": "libraries so bill of materials would be great to have but we don't have it so",
    "start": "1584559",
    "end": "1590760"
  },
  {
    "text": "supply chain Playbook should apply here and if you had some something like bill of materials it would be much easier to",
    "start": "1590760",
    "end": "1595880"
  },
  {
    "text": "check what's on the device other than just trying to reverse engineer and browse it but oh well we cannot have",
    "start": "1595880",
    "end": "1602159"
  },
  {
    "text": "everything and modern devices are actually very very complex beasts so",
    "start": "1602159",
    "end": "1607559"
  },
  {
    "text": "while before we probably had like one binary running on the device now we have",
    "start": "1607559",
    "end": "1612640"
  },
  {
    "text": "all of this Beast of microservice interaction and a lot of different issues related to that",
    "start": "1612640",
    "end": "1619000"
  },
  {
    "text": "so we have previous lens in surface arising so and the key takeaway here is",
    "start": "1619000",
    "end": "1626200"
  },
  {
    "text": "that many of the past vulnerabilities and even vulnerabilities in this device could have been prevented this just",
    "start": "1626200",
    "end": "1633000"
  },
  {
    "text": "better approach to software engineering like you don't like vendors normally don't apply it to firmer level attacks",
    "start": "1633000",
    "end": "1639799"
  },
  {
    "text": "due to lack of pretty much standards so risk no compliance that says that the",
    "start": "1639799",
    "end": "1644960"
  },
  {
    "text": "network device that you supply to say federal government must be protected from to 10 bugs right so there is just",
    "start": "1644960",
    "end": "1652159"
  },
  {
    "text": "no such standard at least to my knowledge and vendors are free to say that aop 10 bucks are not an issue if",
    "start": "1652159",
    "end": "1658360"
  },
  {
    "text": "they require admin authentication to abuse so there is no standard to speak",
    "start": "1658360",
    "end": "1664240"
  },
  {
    "text": "of which we can point to them and Hazard process improvements they do help I",
    "start": "1664240",
    "end": "1669360"
  },
  {
    "text": "pretty much just showed you one such Pro one such process improvements but because the vendor had to create this",
    "start": "1669360",
    "end": "1675720"
  },
  {
    "text": "process from scratch they couldn't cover everything so it's not a single wender problem per se and we just seen an",
    "start": "1675720",
    "end": "1682720"
  },
  {
    "text": "example of big AP next that it covered a lot of things but not quite everything that it should have",
    "start": "1682720",
    "end": "1687840"
  },
  {
    "text": "covered and again as I said vendor response so to lever H ssrf issues you",
    "start": "1687840",
    "end": "1694840"
  },
  {
    "text": "need to have admin access and they cannot be directly AED to impact the security of the product and we will not",
    "start": "1694840",
    "end": "1701240"
  },
  {
    "text": "even patch it so s srf vulnerability is not patched in Z relatest release and",
    "start": "1701240",
    "end": "1706320"
  },
  {
    "text": "again due to lack of Standards due to lack of compliance standards we cannot just point the vendor to say this",
    "start": "1706320",
    "end": "1712720"
  },
  {
    "text": "compliance thing and say okay you shouldn't have an aop 10 issue in your product",
    "start": "1712720",
    "end": "1720120"
  },
  {
    "text": "so and overall conclusions are as follows so isolation memory safety are",
    "start": "1720159",
    "end": "1726640"
  },
  {
    "text": "really good really important they don't fix everything so even a really good example of the applied and I do think",
    "start": "1726640",
    "end": "1733480"
  },
  {
    "text": "that what I just showed you with kubernetes is really a good example of isolation and memory safety",
    "start": "1733480",
    "end": "1738760"
  },
  {
    "text": "it shows that very basic vulnerabilities still exist so you cannot fix a Skol",
    "start": "1738760",
    "end": "1745039"
  },
  {
    "text": "injection with memory safety it's just not how it works and to be honest we",
    "start": "1745039",
    "end": "1750799"
  },
  {
    "text": "also need a lot more tools and and approaches from software supply chain applied to Firmware and by this I mean",
    "start": "1750799",
    "end": "1757480"
  },
  {
    "text": "for example S tools in the pipeline which could pretty much warn you about a scale injections or bill of materials",
    "start": "1757480",
    "end": "1764760"
  },
  {
    "text": "full of your devices where you can just see what's on the device and find vulnerable libraries which might be",
    "start": "1764760",
    "end": "1769960"
  },
  {
    "text": "vulnerable in a year or like just right now might be outdated or for example you",
    "start": "1769960",
    "end": "1776159"
  },
  {
    "text": "can have a much better much more advanced software development life cycle which we already have by now with all of",
    "start": "1776159",
    "end": "1782200"
  },
  {
    "text": "the tools present so there are multiple tools which can be used here not just",
    "start": "1782200",
    "end": "1787919"
  },
  {
    "text": "you know basic pests maybe again pest requirements for the device to be pested like once a year or something like this",
    "start": "1787919",
    "end": "1796000"
  },
  {
    "text": "and last point is that F5 did actually improve the security so getting a full",
    "start": "1796000",
    "end": "1802799"
  },
  {
    "text": "host level code execution is going to be harder like as I have just said we got access to the admin console we got",
    "start": "1802799",
    "end": "1810039"
  },
  {
    "text": "access to the specific device we managed to persist our access but we never got something like a full bus shell on the",
    "start": "1810039",
    "end": "1816000"
  },
  {
    "text": "device or anything of the sort so they did in fact improve security just in my",
    "start": "1816000",
    "end": "1823399"
  },
  {
    "text": "opinion not really enough so and I don't even know that if it is their fault to",
    "start": "1823399",
    "end": "1828679"
  },
  {
    "text": "the large extent so with this I think my presentation is",
    "start": "1828679",
    "end": "1834600"
  },
  {
    "text": "done and I have a little bit of time left for questions as I as I see",
    "start": "1834600",
    "end": "1840080"
  },
  {
    "text": "it thank you for your attention",
    "start": "1840080",
    "end": "1844840"
  }
]