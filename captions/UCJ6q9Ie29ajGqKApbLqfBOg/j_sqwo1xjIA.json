[
  {
    "start": "0",
    "end": "53000"
  },
  {
    "text": "so I'm Andrea barisani this is my colleague danela biano and wave to the",
    "start": "80",
    "end": "5359"
  },
  {
    "text": "audience wave to the audience be nice Wave Wait okay hi to everyone so we will",
    "start": "5359",
    "end": "10960"
  },
  {
    "text": "talk about some very exotic and old school but interesting topic to us which",
    "start": "10960",
    "end": "17960"
  },
  {
    "text": "is really pushing the limits of what you can do with EET packets which you know",
    "start": "17960",
    "end": "23359"
  },
  {
    "text": "it's you know you will see it's it's really interesting so before starting we",
    "start": "23359",
    "end": "30039"
  },
  {
    "text": "want to dedicate this talk to our friend Barnaby uh which tragically passed away",
    "start": "30039",
    "end": "35160"
  },
  {
    "text": "so I know that at the Kino they did a moment of silence for barnabi but if you knew barnabi you would know that you",
    "start": "35160",
    "end": "41520"
  },
  {
    "text": "would have been preferred to cheer up so please give an Applause to barnabi",
    "start": "41520",
    "end": "47079"
  },
  {
    "text": "Jack thank you so our talk is about expanding and",
    "start": "51879",
    "end": "59640"
  },
  {
    "start": "53000",
    "end": "130000"
  },
  {
    "text": "pushing didn't liit so what you can do while testing ethernet connected device",
    "start": "59640",
    "end": "64960"
  },
  {
    "text": "um and the reason why we found this topic really interesting is that it is",
    "start": "64960",
    "end": "70400"
  },
  {
    "text": "generally assumed that you can send a sniff arbitrary packets using a normal laptop and and this is actually turns",
    "start": "70400",
    "end": "78880"
  },
  {
    "text": "out not to be true and and you know where a hacker cannot send completely",
    "start": "78880",
    "end": "84720"
  },
  {
    "text": "100% arbitrary packets you have that you know that we each that you need to scratch that you need to fix somehow and",
    "start": "84720",
    "end": "92320"
  },
  {
    "text": "and while testing some specific classes of AA devices all this re and his work you know fell natural because the",
    "start": "92320",
    "end": "99840"
  },
  {
    "text": "problem is that when we're talking about ethernet packet there are some values like the frame check sequence or the",
    "start": "99840",
    "end": "105560"
  },
  {
    "text": "starter frame delimiter which historically required the use of of dedicated and very costly Hardware to uh",
    "start": "105560",
    "end": "112360"
  },
  {
    "text": "manipulate so in this presentation we will dissect how EET works at its very",
    "start": "112360",
    "end": "118000"
  },
  {
    "text": "lowest level and we will present some novel uh techniques for testing and attacking uh certain kind of systems and",
    "start": "118000",
    "end": "125759"
  },
  {
    "text": "we will release uh some code and some hard work for doing this so what are we",
    "start": "125759",
    "end": "131840"
  },
  {
    "start": "130000",
    "end": "262000"
  },
  {
    "text": "talking about so you might all be familiar uh with an infinite frame uh",
    "start": "131840",
    "end": "138239"
  },
  {
    "text": "what you might not know uh is that uh every infinite frame that you send on",
    "start": "138239",
    "end": "143959"
  },
  {
    "text": "the actual wire has Fields such as the start of Stam start of stream delimiter",
    "start": "143959",
    "end": "149360"
  },
  {
    "text": "that we see here a preamble and a start of frame delimiter which generally you don't get um to play with um these",
    "start": "149360",
    "end": "158080"
  },
  {
    "text": "fields are used by uh the network interface card to detect the actual",
    "start": "158080",
    "end": "163360"
  },
  {
    "text": "beginning of the frame in a reliable way because otherwise you cannot just do that by relying on the payload of of the",
    "start": "163360",
    "end": "171120"
  },
  {
    "text": "packet um and in every EET you have two components like from a hardware",
    "start": "171120",
    "end": "176760"
  },
  {
    "text": "perspective you have a fi so a chip which handles the physical layer of epet",
    "start": "176760",
    "end": "182400"
  },
  {
    "text": "and then you have a Mech which is what handles uh you know the inner layer so",
    "start": "182400",
    "end": "189120"
  },
  {
    "text": "the F the physical chip handles the uh interframe gaps so the idle part here",
    "start": "189120",
    "end": "196879"
  },
  {
    "text": "the start of stream the limiter um and and that's it so and",
    "start": "196879",
    "end": "202319"
  },
  {
    "text": "these fields or are not and the end of stream the limiter sorry which tells the",
    "start": "202319",
    "end": "207840"
  },
  {
    "text": "E the the network interface car when the frame ends and these fields are not available at the Mac layer so you cannot",
    "start": "207840",
    "end": "215799"
  },
  {
    "text": "play with them unless you emulate a f which is the physical chip now what we",
    "start": "215799",
    "end": "221840"
  },
  {
    "text": "target um are actually these other fields here the Preamble and the starter",
    "start": "221840",
    "end": "227200"
  },
  {
    "text": "frame delimiter which are available to the Mac but they're not available uh at",
    "start": "227200",
    "end": "232680"
  },
  {
    "text": "the drive layer um so these are fields that you cannot manipulate with uh a",
    "start": "232680",
    "end": "240239"
  },
  {
    "text": "normal laptop uh and then after the start of frame delimiter you have the actual frame which you can manipulate",
    "start": "240239",
    "end": "245560"
  },
  {
    "text": "freely with the destination Mac uh the source SMC the eer type or length depending on the packet that you're",
    "start": "245560",
    "end": "251280"
  },
  {
    "text": "trying to send and then the actual payload of the packet at the very end of the packet you have the check sum for E",
    "start": "251280",
    "end": "258199"
  },
  {
    "text": "the frame which is the frame check sequence uh which is for octets",
    "start": "258199",
    "end": "263639"
  },
  {
    "start": "262000",
    "end": "355000"
  },
  {
    "text": "so because of this separation between the FI and the Mac so there there there are several things that go on here um",
    "start": "263639",
    "end": "271600"
  },
  {
    "text": "there's a need for having the FI signaling data so with Fi signaling data",
    "start": "271600",
    "end": "277120"
  },
  {
    "text": "we refer to the start of stream delimiter and the end of stream delimiter to be unambiguously encapsulated in relation to the Mac",
    "start": "277120",
    "end": "284120"
  },
  {
    "text": "frame this means that whatever the Mac is doing the Mac cannot inject those",
    "start": "284120",
    "end": "291440"
  },
  {
    "text": "symbols into the frame okay so the encoding of of the symbols in the frame",
    "start": "291440",
    "end": "298720"
  },
  {
    "text": "they need to be done in a way that the Mac cannot possibly inject those so that you cannot have an in Bend signaling",
    "start": "298720",
    "end": "305520"
  },
  {
    "text": "from from the Mac layer like think about it like when you have inent signaling for you know phones that you can play",
    "start": "305520",
    "end": "311520"
  },
  {
    "text": "the MTF tones if if those would be signaling uh codes for the line then you would have a problem so there's the need",
    "start": "311520",
    "end": "318600"
  },
  {
    "text": "for having a separation there um the Mac signaling codes like the Preamble and",
    "start": "318600",
    "end": "323919"
  },
  {
    "text": "the startr fame delimiter are however represented with the same symbol which are allowed within the m",
    "start": "323919",
    "end": "330360"
  },
  {
    "text": "frame so and here here you have this distinction uh between what the physical",
    "start": "330360",
    "end": "336199"
  },
  {
    "text": "layer stream handles so what it can it send this is called the Mac packet this",
    "start": "336199",
    "end": "341639"
  },
  {
    "text": "is the packet that is sent by the Mac to the FI and this is the Mac frame which",
    "start": "341639",
    "end": "346960"
  },
  {
    "text": "is what your driver on your operating system sends to the Mac so these are the",
    "start": "346960",
    "end": "352319"
  },
  {
    "text": "fre layers which are involved so the way the signal en codes are transmitting um",
    "start": "352319",
    "end": "358440"
  },
  {
    "start": "355000",
    "end": "423000"
  },
  {
    "text": "there's something called the 4B bit to 5 bit encoding and this is done specifically uh is done for many reasons",
    "start": "358440",
    "end": "364199"
  },
  {
    "text": "but also um to prevent uh to add additional signal symbols uh that you",
    "start": "364199",
    "end": "370000"
  },
  {
    "text": "cannot send within the payload of the packet so we can see that our four bits",
    "start": "370000",
    "end": "375720"
  },
  {
    "text": "are actually encoded using five bits and that we have additional symbols that are",
    "start": "375720",
    "end": "381360"
  },
  {
    "text": "not part of the standard ex decimal values that you can put in a Mac frame so we have from zero to F we have those",
    "start": "381360",
    "end": "388840"
  },
  {
    "text": "symbols and then we have additional symbols I J K T R and H which are the",
    "start": "388840",
    "end": "393880"
  },
  {
    "text": "actually uh signaling codes which are used within uh the packet so interesting",
    "start": "393880",
    "end": "400000"
  },
  {
    "text": "fact the actually when you talk about ethernet 100 megabit per second this transmission rate means that the actual",
    "start": "400000",
    "end": "406039"
  },
  {
    "text": "bit rate of the data which is been been sent is 125 megabit per second because",
    "start": "406039",
    "end": "411599"
  },
  {
    "text": "you have this overhead uh in the four bits which are translated to five bits uh for this uh specific reason so we",
    "start": "411599",
    "end": "419240"
  },
  {
    "text": "have 16 data symbols and six signaling symbols so again starter frame delimiter",
    "start": "419240",
    "end": "426400"
  },
  {
    "start": "423000",
    "end": "472000"
  },
  {
    "text": "is not available at the US driver layer or not even if you modify the firmware of your network interface car some",
    "start": "426400",
    "end": "432639"
  },
  {
    "text": "people think oh you have the firmware you modify it you modify the driver you can play with that no you cannot that is",
    "start": "432639",
    "end": "438160"
  },
  {
    "text": "being injected by the Mac so unless you are a Mac unless you are D Mac chip then",
    "start": "438160",
    "end": "443360"
  },
  {
    "text": "it is not going to work um the frame check sequence which is the check sum is generally not included in the packets on",
    "start": "443360",
    "end": "449639"
  },
  {
    "text": "by the operating system as usually it's check or computation it's uploaded by",
    "start": "449639",
    "end": "454840"
  },
  {
    "text": "the Mac the Mac automatically does it to save you know some CPU Cycles uh to the",
    "start": "454840",
    "end": "460680"
  },
  {
    "text": "US um other challenge uh usually packets which have an inval checks and are",
    "start": "460680",
    "end": "466319"
  },
  {
    "text": "discarded by the Mec so you will never ever see them because they're never sent to the US",
    "start": "466319",
    "end": "472720"
  },
  {
    "start": "472000",
    "end": "543000"
  },
  {
    "text": "so the motivation to do uh this kind of research is that again when you have",
    "start": "472720",
    "end": "478520"
  },
  {
    "text": "something that you can manipulate in packets is really annoying for for people that do security you know you",
    "start": "478520",
    "end": "483800"
  },
  {
    "text": "know you want to be able to control 100% uh your uh attack surface uh to trigger",
    "start": "483800",
    "end": "490240"
  },
  {
    "text": "you know unexpected behavior that might have security implications um and there",
    "start": "490240",
    "end": "495360"
  },
  {
    "text": "are many devices in in in our line of work we work a lot with automotive industrial equipment avionics lots of a",
    "start": "495360",
    "end": "501960"
  },
  {
    "text": "meta system and and in many many many cases these embedded system they only have a fi a physical fi chip and the Mac",
    "start": "501960",
    "end": "510039"
  },
  {
    "text": "is actually implemented uh by software so you have a software Mac implemented on the fbga so it's not something which",
    "start": "510039",
    "end": "517080"
  },
  {
    "text": "is you know made uh in silicone and hardcoded there um and also you have certain class of devices which are e and",
    "start": "517080",
    "end": "523518"
  },
  {
    "text": "multiplexes plexers which are appealing targets because they they use EET frames in a very uh arbitrary way they defy the",
    "start": "523519",
    "end": "531360"
  },
  {
    "text": "normal formats of of the frame by using stock Eep foret Hardware at the same",
    "start": "531360",
    "end": "537680"
  },
  {
    "text": "time um and this work was motivated by testing uh these devices so the first",
    "start": "537680",
    "end": "544200"
  },
  {
    "start": "543000",
    "end": "601000"
  },
  {
    "text": "challenge it's easy receive uh invalid packets and Frames within valid frame",
    "start": "544200",
    "end": "549560"
  },
  {
    "text": "check sequence because your frames you might be talking to devices where they don't have a frame check sequence they",
    "start": "549560",
    "end": "555200"
  },
  {
    "text": "actually use that as a data and you want to receive that so easy thing to do most",
    "start": "555200",
    "end": "561399"
  },
  {
    "text": "ethernet drivers you can use at tool to uh tell the interface to actually",
    "start": "561399",
    "end": "566720"
  },
  {
    "text": "receive the frame check sequence and receive every packet so we see in this example here we this is a normal",
    "start": "566720",
    "end": "573360"
  },
  {
    "text": "infinite frame received so we see that the payload ends with the last bites of",
    "start": "573360",
    "end": "578640"
  },
  {
    "text": "the actual payload of of the packet if you receive the packet with the frame check sequence you have these additional",
    "start": "578640",
    "end": "585360"
  },
  {
    "text": "four bytes which actually represent the checkm of the frame when using uh RX FCS",
    "start": "585360",
    "end": "591040"
  },
  {
    "text": "on in combination with RX old you also receive tackers which have invalid uh frame check sequence so you basically",
    "start": "591040",
    "end": "597360"
  },
  {
    "text": "receive everything that comes on the lines so this is easy you don't need any patching now if you want to send packet",
    "start": "597360",
    "end": "604839"
  },
  {
    "start": "601000",
    "end": "647000"
  },
  {
    "text": "with an arbitrary frame check sequence because you want to talk to the same systems that you know they use the FCS",
    "start": "604839",
    "end": "611760"
  },
  {
    "text": "in a different way then usually your your network interface card does not allow you to do that because it computes",
    "start": "611760",
    "end": "618160"
  },
  {
    "text": "the the frame change sequence on its own so you need to patch the kernel um the easy way you read the data sheet for the",
    "start": "618160",
    "end": "625279"
  },
  {
    "text": "Mac that you have and the file that you have or you dig into the s and this is a way that you can patch uh",
    "start": "625279",
    "end": "632680"
  },
  {
    "text": "easily uh the kernel for injection injecting arbitrary uh arbitrary frame",
    "start": "632680",
    "end": "638760"
  },
  {
    "text": "so this gives you a little bit of freedom in controlling the last four bytes of of the payload which usually",
    "start": "638760",
    "end": "645160"
  },
  {
    "text": "you cannot control um but this is not enough anyway this is an example so we",
    "start": "645160",
    "end": "650880"
  },
  {
    "start": "647000",
    "end": "758000"
  },
  {
    "text": "send a packet with and without the FCS injection patch we can see um this is",
    "start": "650880",
    "end": "656959"
  },
  {
    "text": "the receiving side we can see that in the first case um with the patch we get",
    "start": "656959",
    "end": "664079"
  },
  {
    "text": "a packet so we can see that these bites 2712 42ab are not received which means that",
    "start": "664079",
    "end": "671000"
  },
  {
    "text": "they were actually pared as checkm by the EET so this is uh a computer which",
    "start": "671000",
    "end": "676639"
  },
  {
    "text": "is receiving the packets without any patch so uh the frame check sequence is not shown uh if we send this same packet",
    "start": "676639",
    "end": "683920"
  },
  {
    "text": "without a patch we see that these bites get to be part of the payload so there're actually not being used as a",
    "start": "683920",
    "end": "690839"
  },
  {
    "text": "frame check so you can so this is different this shows that you can uh control those values so but anyway this",
    "start": "690839",
    "end": "697160"
  },
  {
    "text": "is not enough this is not too interesting so we want to uh manipulate the Preamble and the starter frame the",
    "start": "697160",
    "end": "703519"
  },
  {
    "text": "limiter uh values you know so we want to be a Mac and usually you would need a very expensive uh Network analyzer we're",
    "start": "703519",
    "end": "710560"
  },
  {
    "text": "talking about you know 4,000 8,000 um US dollars or you know the way to do it on",
    "start": "710560",
    "end": "717000"
  },
  {
    "text": "the cheap is to use a dedicated Hardware set set up so usually you have an fpga or a sufficiently powerful",
    "start": "717000",
    "end": "722279"
  },
  {
    "text": "microcontroller uh that actually will Implement a software Mac and you wire that to of five so we have identified a",
    "start": "722279",
    "end": "729639"
  },
  {
    "text": "very low cost solution which is called the xmos X2 EET kit just to proof of concept uh that you can do it on the",
    "start": "729639",
    "end": "736199"
  },
  {
    "text": "chip this cost it's very cheap right now it cost I think 80 bucks you know and it",
    "start": "736199",
    "end": "741440"
  },
  {
    "text": "is a platform which has an embedded um uh processor attached directly to a file",
    "start": "741440",
    "end": "748560"
  },
  {
    "text": "so what ever firmware you you put on this uh simple device uh you can be the",
    "start": "748560",
    "end": "753920"
  },
  {
    "text": "mac and you can control um the fields that we're talking about so this is the",
    "start": "753920",
    "end": "760240"
  },
  {
    "start": "758000",
    "end": "767000"
  },
  {
    "text": "hardware uh uh it's off the shelf and we develop custom firmware form it for it which uh we're going to release uh today",
    "start": "760240",
    "end": "767800"
  },
  {
    "start": "767000",
    "end": "813000"
  },
  {
    "text": "so we have this custom injector firmware which allows you to arbitrarily send your packet so we can see in this case",
    "start": "767800",
    "end": "774000"
  },
  {
    "text": "we have the Preamble so the Preamble here is 5555 this is standard pre so you",
    "start": "774000",
    "end": "779720"
  },
  {
    "text": "have this seven OCT of five5 then you have the starter frame delimiter which",
    "start": "779720",
    "end": "785279"
  },
  {
    "text": "is D5 then you have the actual payload of the packet which begins with the destination Mac source Mac and so on and",
    "start": "785279",
    "end": "792480"
  },
  {
    "text": "then at the end you have uh the checkon so this is uh the maximum injection that",
    "start": "792480",
    "end": "798480"
  },
  {
    "text": "you can do by being a Mac this is controlling 100% of the frame excluding the five signaling codes which anyway",
    "start": "798480",
    "end": "805360"
  },
  {
    "text": "are not that interesting to us so and this fil will be Rel least um you know",
    "start": "805360",
    "end": "810399"
  },
  {
    "text": "today so now the question is what can we do with this so the first interesting",
    "start": "810399",
    "end": "816639"
  },
  {
    "start": "813000",
    "end": "919000"
  },
  {
    "text": "thing that can be done uh you can fingerprint uh network interface cars so",
    "start": "816639",
    "end": "821920"
  },
  {
    "text": "suppose you have um an embedded device you do blackbox texting you don't know you know how the software Works how the",
    "start": "821920",
    "end": "828440"
  },
  {
    "text": "software Mac works so you want to understand you know what kind of system it is um because there are ambiguities",
    "start": "828440",
    "end": "834720"
  },
  {
    "text": "in the way that ethernet packets are Parts at a Mac layer you can fingerprint the different systems so we see here",
    "start": "834720",
    "end": "841519"
  },
  {
    "text": "that for instance um uh Intel cards um you can have so the first bite can be",
    "start": "841519",
    "end": "847519"
  },
  {
    "text": "anything uh this is always the case because the first bite gets converted to the start of stream delimiter by the",
    "start": "847519",
    "end": "853399"
  },
  {
    "text": "file and then you need to have the um standard compliant Preamble which is",
    "start": "853399",
    "end": "858839"
  },
  {
    "text": "made of 55 but it doesn't have to be of the actual standard length it could be",
    "start": "858839",
    "end": "864199"
  },
  {
    "text": "of any length so this should be six octets but it can be a one octat and",
    "start": "864199",
    "end": "869639"
  },
  {
    "text": "then you need to have the compliant standard frame delimeter which is D5 but",
    "start": "869639",
    "end": "874680"
  },
  {
    "text": "there are other um Macs where uh you can actually you're not required to have",
    "start": "874680",
    "end": "880959"
  },
  {
    "text": "your uh compliant Preamble it can be any bites uh and in some cases you're not",
    "start": "880959",
    "end": "887079"
  },
  {
    "text": "even required to have the compliant starter frame delimiter so you just need a nibble in the start of frame delimiter",
    "start": "887079",
    "end": "894120"
  },
  {
    "text": "to be compliant so you can have D1 D2 D4 and the e EET will receive the packet",
    "start": "894120",
    "end": "900920"
  },
  {
    "text": "happily so um these differences in the way that Mac handles packet lie you on",
    "start": "900920",
    "end": "908279"
  },
  {
    "text": "the same line to fingerprint uh the different Mac implementations you know",
    "start": "908279",
    "end": "913600"
  },
  {
    "text": "when you're directly connected to them and this also raises I mean an interesting uh attack which is evading",
    "start": "913600",
    "end": "920440"
  },
  {
    "start": "919000",
    "end": "951000"
  },
  {
    "text": "passing Network tab so this is a tap uh this is a ninja throwing uh uh star lb",
    "start": "920440",
    "end": "928519"
  },
  {
    "text": "made by Michael Osman is Michael here Michael are you around there so Michael is a very evil man he's an evil ninja",
    "start": "928519",
    "end": "935240"
  },
  {
    "text": "that goes around with his you know cute uh uh uh passive Taps you know showing",
    "start": "935240",
    "end": "941160"
  },
  {
    "text": "how cool they are so since Michael is evil and we hate him so much you know he such as obnoxious person we want to",
    "start": "941160",
    "end": "947360"
  },
  {
    "text": "evade his cute little toys so the way you can do it you can exploit these",
    "start": "947360",
    "end": "954079"
  },
  {
    "text": "ambiguities in handing packets so that you can send a packet that the tap will not see and that your final Target will",
    "start": "954079",
    "end": "961720"
  },
  {
    "text": "see so in this case these packets will be happily received by a Cisco Catalyst",
    "start": "961720",
    "end": "967040"
  },
  {
    "text": "2950 uh because it is very loose in checking the start of frame the limiter bites but if you have an Intel based",
    "start": "967040",
    "end": "974199"
  },
  {
    "text": "network interface car listening on the top it would silently discard it so you can have a communication to your uh",
    "start": "974199",
    "end": "982000"
  },
  {
    "text": "Target line and whatever IDs is attached to the passive top you will never see",
    "start": "982000",
    "end": "987959"
  },
  {
    "text": "any packets without even notifying the us because uh it will discard them um",
    "start": "987959",
    "end": "993120"
  },
  {
    "text": "right away uh and this is you know this is one example of doing so we see that we have a standard Preamble",
    "start": "993120",
    "end": "999440"
  },
  {
    "text": "55555 and then we have D1 instead of D5 and this uh Works uh in this specific",
    "start": "999440",
    "end": "1007000"
  },
  {
    "text": "scenario uh you know and by mapping all the possible fingerprints that you can have you can play with this kind of situation and defeat the evil ninja",
    "start": "1007000",
    "end": "1015000"
  },
  {
    "text": "throwing uh passive tap that Michael made so Michael you've been",
    "start": "1015000",
    "end": "1020160"
  },
  {
    "text": "defeated good so now there are also other interesting conditions um there are some",
    "start": "1020160",
    "end": "1027079"
  },
  {
    "start": "1021000",
    "end": "1140000"
  },
  {
    "text": "uh parsing anomalies in parsing the start of frame delimeter so let's examine this packet then now we can send",
    "start": "1027079",
    "end": "1034918"
  },
  {
    "text": "with our own hardware and we're actually also going to demo this in a second so this packet is pecular for many reasons",
    "start": "1034919",
    "end": "1041558"
  },
  {
    "text": "so first of all we have a preamble uh one bite because we seen the Preamble",
    "start": "1041559",
    "end": "1047038"
  },
  {
    "text": "doesn't matter how long it is and we have stter frame the limiter which is not compliant D4 instead of D5 then we",
    "start": "1047039",
    "end": "1052679"
  },
  {
    "text": "have the destination andur Mac address we have the eer type ipv4 payload then we have another Preamble and start of",
    "start": "1052679",
    "end": "1061080"
  },
  {
    "text": "frame delimeter within the payload of the packet we have another destination",
    "start": "1061080",
    "end": "1066200"
  },
  {
    "text": "and source Mac address and then we have payload and then we have the frame check sequence now the check sum of this",
    "start": "1066200",
    "end": "1073200"
  },
  {
    "text": "packet is calculated in a way that if you would consider this EET frame frame",
    "start": "1073200",
    "end": "1079520"
  },
  {
    "text": "from the offset zero to the end or if you would consider this Frame from",
    "start": "1079520",
    "end": "1085640"
  },
  {
    "text": "offset 1D to the end the checkm is the same so we're exploiting a CRC uh 42",
    "start": "1085640",
    "end": "1092960"
  },
  {
    "text": "Collision which is Trivial to generate so the checkm for this packet is valid",
    "start": "1092960",
    "end": "1099640"
  },
  {
    "text": "at two different alignments and these two different alignments they both represent a valid EET packet with",
    "start": "1099640",
    "end": "1105679"
  },
  {
    "text": "designation and Source ma addresses and Halo so we have a packet in packet",
    "start": "1105679",
    "end": "1110720"
  },
  {
    "text": "situation A Frame which is nested into a different one so normally whatever you",
    "start": "1110720",
    "end": "1116440"
  },
  {
    "text": "put in the payload of the outer packet it's it's just some payload that you put in the packet your no signaling codes",
    "start": "1116440",
    "end": "1124360"
  },
  {
    "text": "will be allow there so there are certain class of devices like for instance the Marvel 88 e660 uh Eda switches which is",
    "start": "1124360",
    "end": "1132280"
  },
  {
    "text": "present on many devices we have one here uh which is uh TP Link router where this",
    "start": "1132280",
    "end": "1137799"
  },
  {
    "text": "has a new ual uh behaviors so you have something called the stringers packet in",
    "start": "1137799",
    "end": "1143440"
  },
  {
    "start": "1140000",
    "end": "1491000"
  },
  {
    "text": "this case as as we as we like to call it so when you send this packet it doesn't",
    "start": "1143440",
    "end": "1148760"
  },
  {
    "text": "matter the speed the rate uh about you know for sending the packet it will gets",
    "start": "1148760",
    "end": "1154760"
  },
  {
    "text": "randomly aligned at different offsets so you might get that in you know four cases it's aligned at 0 0 you know in",
    "start": "1154760",
    "end": "1162840"
  },
  {
    "text": "the whole packet or some uh the other six cases is lined at 1D and thisen",
    "start": "1162840",
    "end": "1168720"
  },
  {
    "text": "happens randomly so let let let's try to demo this so now I am connected to the",
    "start": "1168720",
    "end": "1176679"
  },
  {
    "text": "TP link and this other computer is sniffing directly",
    "start": "1176679",
    "end": "1182039"
  },
  {
    "text": "on so let's try this on on the switch",
    "start": "1182039",
    "end": "1187759"
  },
  {
    "text": "so okay there we are so we are",
    "start": "1195720",
    "end": "1202320"
  },
  {
    "text": "connected with the xmos this is the xmos which is connected we connect it to the",
    "start": "1202320",
    "end": "1211679"
  },
  {
    "text": "switch so I will and on the other hand",
    "start": "1214880",
    "end": "1220039"
  },
  {
    "text": "we will sniff the packets that are coming on on the internet so not SSH D",
    "start": "1220039",
    "end": "1228000"
  },
  {
    "text": "because that's not good okay so I'm connected to",
    "start": "1228000",
    "end": "1234480"
  },
  {
    "text": "the exmos here",
    "start": "1234480",
    "end": "1240880"
  },
  {
    "text": "okay now we're firing up [Music]",
    "start": "1243799",
    "end": "1250920"
  },
  {
    "text": "our our injector demo fail problem connected to",
    "start": "1252400",
    "end": "1258120"
  },
  {
    "text": "device [Music] okay",
    "start": "1258120",
    "end": "1265400"
  },
  {
    "text": "okay can you unplug it and replug it",
    "start": "1265400",
    "end": "1269720"
  },
  {
    "text": "please I told you she was not a virgin",
    "start": "1270960",
    "end": "1275640"
  },
  {
    "text": "yeah I'm not that good in recognizes vergins device disconnected",
    "start": "1276960",
    "end": "1285840"
  },
  {
    "text": "ah yes maybe if we power it up maybe that will be helpful if we attach the power to it that that's usually a",
    "start": "1292400",
    "end": "1299760"
  },
  {
    "text": "problem thank you noobs we're",
    "start": "1299760",
    "end": "1305919"
  },
  {
    "text": "noobs give me power here we go okay it's blinking blinking is good we like things",
    "start": "1306840",
    "end": "1314480"
  },
  {
    "text": "blinking no not okay okay right so now I can enter",
    "start": "1314480",
    "end": "1321279"
  },
  {
    "text": "arbitrary payload so we have the cat box",
    "start": "1321279",
    "end": "1325559"
  },
  {
    "text": "here now so here where is it here I'm",
    "start": "1326480",
    "end": "1335480"
  },
  {
    "text": "sniffing and now I will send this packet 10 times okay",
    "start": "1335480",
    "end": "1343520"
  },
  {
    "text": "now oh are you attached to the switch",
    "start": "1343520",
    "end": "1349679"
  },
  {
    "text": "no you're not no no come you have one thing to do and you",
    "start": "1349679",
    "end": "1355480"
  },
  {
    "text": "did you did that it's not my",
    "start": "1355480",
    "end": "1360519"
  },
  {
    "text": "fault okay so now",
    "start": "1360640",
    "end": "1366159"
  },
  {
    "text": "okay so now let's replug",
    "start": "1386799",
    "end": "1392480"
  },
  {
    "text": "that bear with me for a sec to",
    "start": "1398080",
    "end": "1406080"
  },
  {
    "text": "say no no no no two two SC okay",
    "start": "1406240",
    "end": "1412159"
  },
  {
    "text": "so now what happened here so this is the bamp of the packet that we sent so we",
    "start": "1412159",
    "end": "1418120"
  },
  {
    "text": "can see that in some cases we have a dead kitten here we see that the kitten",
    "start": "1418120",
    "end": "1426400"
  },
  {
    "text": "dies this is this is why it called the shading packet and in this other case the kitten survived so we see that we",
    "start": "1426400",
    "end": "1433279"
  },
  {
    "text": "either have a TCP sin or we have a packet which you you know is is aligned",
    "start": "1433279",
    "end": "1439760"
  },
  {
    "text": "to a different one so if you check closely this packet here actually",
    "start": "1439760",
    "end": "1446000"
  },
  {
    "text": "matches the packet which is aligned from this offset here and I've sent the same",
    "start": "1446000",
    "end": "1452080"
  },
  {
    "text": "packet 20 times so this switch is randomly aligning the detection of the",
    "start": "1452080",
    "end": "1458320"
  },
  {
    "text": "packet at one of the two offsets and depending on the offset that we're aligned to we either have a dead kitten",
    "start": "1458320",
    "end": "1463600"
  },
  {
    "text": "or a live kitten okay so it should be a cat but we like a kitten because it's much more you know gruesome um so it's",
    "start": "1463600",
    "end": "1470840"
  },
  {
    "text": "better right so this shows how this device for instance has a race condition",
    "start": "1470840",
    "end": "1475960"
  },
  {
    "text": "imp parsing uh the starter frame delimiter because remember we're not using a compliant starter frame",
    "start": "1475960",
    "end": "1482320"
  },
  {
    "text": "delimiter here we're using uh something which is not compliant and it creates issues on on this specific uh this",
    "start": "1482320",
    "end": "1490320"
  },
  {
    "text": "specific Hardware now the interesting thing is that depending on where the race condition is if it's in depending",
    "start": "1490320",
    "end": "1497720"
  },
  {
    "text": "on in where it is in the squet it might happen before or after some checking such a vant tax checking or some routing",
    "start": "1497720",
    "end": "1505360"
  },
  {
    "text": "decisions so it's an interesting class of problems to probe because this might",
    "start": "1505360",
    "end": "1510399"
  },
  {
    "text": "affect some security related decisions uh that that you might have so this was",
    "start": "1510399",
    "end": "1515960"
  },
  {
    "text": "one of the first things that we found and we thought this is interesting we should investigate this more and it provides a case for actually",
    "start": "1515960",
    "end": "1522520"
  },
  {
    "text": "manipulating 100% of the frame because you can trigger uh certain specific condition when with fpgas with soft Max",
    "start": "1522520",
    "end": "1529880"
  },
  {
    "text": "implementing in fpgas you can often trigger theal of service condition you can put um the state machine in the fpga",
    "start": "1529880",
    "end": "1536600"
  },
  {
    "text": "in a state uh that would cause an infinite Loop because it would expect a certain length because they read the",
    "start": "1536600",
    "end": "1542320"
  },
  {
    "text": "standard and they implement the standard but if you defi those expectations you might trigger some uh improper State uh",
    "start": "1542320",
    "end": "1550000"
  },
  {
    "text": "in the state machine and with one packet you could just shut down uh the EET receiver uh forever so there is a case",
    "start": "1550000",
    "end": "1557520"
  },
  {
    "text": "for actually manipulating these frames other than killing cats like in this case so and this is the example in the",
    "start": "1557520",
    "end": "1565120"
  },
  {
    "start": "1562000",
    "end": "1581000"
  },
  {
    "text": "presentation of the two align packet so we see here this is the actual other sorry this is the actual outer start",
    "start": "1565120",
    "end": "1571640"
  },
  {
    "text": "friend delimiter uh and Preamble and we can see that the checkm is the same for",
    "start": "1571640",
    "end": "1576799"
  },
  {
    "text": "both packets and both packets are valued and both packets are detected now",
    "start": "1576799",
    "end": "1583559"
  },
  {
    "start": "1581000",
    "end": "1809000"
  },
  {
    "text": "um packeting packet on wire eess so what this L into into exploring is",
    "start": "1583559",
    "end": "1590360"
  },
  {
    "text": "the injection of row frames on layer one which is something that has been explored by Travis uh good speed uh for",
    "start": "1590360",
    "end": "1597000"
  },
  {
    "text": "um Wireless frames in in stuff like zigby and and so on exploiting the signal degradation of of the which is",
    "start": "1597000",
    "end": "1604840"
  },
  {
    "text": "characteristic of Wireless signals now the same kind of injection would be",
    "start": "1604840",
    "end": "1609960"
  },
  {
    "text": "extremely appealing for ethernet frames but the problem is that EET is very",
    "start": "1609960",
    "end": "1615120"
  },
  {
    "text": "reliable so you cannot just wait for a random bit to flip uh and and allow you",
    "start": "1615120",
    "end": "1620399"
  },
  {
    "text": "to inject your pocket in Pocket because the F first starter frame delimiter is missed for whatever reason so we explore",
    "start": "1620399",
    "end": "1627279"
  },
  {
    "text": "the possible condition that would allow a sucessful pocketing pocketing injection on EET frames and there are",
    "start": "1627279",
    "end": "1632480"
  },
  {
    "text": "Zim but there are reliable scenarios where you can actually um do it and it",
    "start": "1632480",
    "end": "1638760"
  },
  {
    "text": "has actual you know an impact on certain class of devices and it turns out that",
    "start": "1638760",
    "end": "1643799"
  },
  {
    "text": "it's a design flaw it's not an implementation flaw so we talk about the FI uh and the mac and the way they're",
    "start": "1643799",
    "end": "1650520"
  },
  {
    "text": "connected together so when a packet is being sent the",
    "start": "1650520",
    "end": "1656000"
  },
  {
    "text": "Mac there are some lines uh which which give the data to the file so in this",
    "start": "1656000",
    "end": "1662039"
  },
  {
    "text": "specific case this is a standard Mii interface you have um you send four",
    "start": "1662039",
    "end": "1667360"
  },
  {
    "text": "bytes uh at the time and then you have um the clock which is sent by the FI to",
    "start": "1667360",
    "end": "1673559"
  },
  {
    "text": "the mac and you have a transmit enable line which basically tell tell the F",
    "start": "1673559",
    "end": "1679000"
  },
  {
    "text": "when the uh this valid valid data to present uh to the",
    "start": "1679000",
    "end": "1685600"
  },
  {
    "text": "fire yes four bits at the time I sent it yeah yeah thank you Dan for your",
    "start": "1685600",
    "end": "1690840"
  },
  {
    "text": "contribution so so um now there's a problem in this approach so if we create",
    "start": "1690840",
    "end": "1697640"
  },
  {
    "text": "a condition where the FI is either starting up or the file loses the link",
    "start": "1697640",
    "end": "1704720"
  },
  {
    "text": "uh or it's it's in a state where it's not sending packet the the problem is that the Mac doesn't know he has no",
    "start": "1704720",
    "end": "1711840"
  },
  {
    "text": "knowledge of that so when the Mac is sending packets to the FI uh if the FI",
    "start": "1711840",
    "end": "1719399"
  },
  {
    "text": "is in a condition where you cannot send the packet and at some point you resumes that function um packets have a chance",
    "start": "1719399",
    "end": "1727000"
  },
  {
    "text": "of being detected in Flight by the FI so you're sending a long packet and if you",
    "start": "1727000",
    "end": "1733559"
  },
  {
    "text": "can trigger a reboot or a startup of the device a link speed change or you simply",
    "start": "1733559",
    "end": "1738720"
  },
  {
    "text": "replug in the cable the F uh has a very high probability if you craft your",
    "start": "1738720",
    "end": "1744320"
  },
  {
    "text": "packet in a special way of receiving this packet like you know halfway through now since the Preamble and the",
    "start": "1744320",
    "end": "1752559"
  },
  {
    "text": "starter frame delimiter are encoded in the same fashion as the payload of the packet they're not like the five",
    "start": "1752559",
    "end": "1758799"
  },
  {
    "text": "signaling codes where they use symbols that you could never possibly uh",
    "start": "1758799",
    "end": "1763919"
  },
  {
    "text": "transmit uh because there are symbols that are simply not available to you it because it's out of Bend for the Mac",
    "start": "1763919",
    "end": "1770039"
  },
  {
    "text": "layer uh in this case the first valid Preamble and starter frame delimiter",
    "start": "1770039",
    "end": "1775600"
  },
  {
    "text": "which are witness on the wire will be detected and parsed as such so if your",
    "start": "1775600",
    "end": "1781360"
  },
  {
    "text": "packet is being detected in Flight the first bytes which matches with those",
    "start": "1781360",
    "end": "1786559"
  },
  {
    "text": "value will represent the starting of a valid packet uh for the F and this on",
    "start": "1786559",
    "end": "1794000"
  },
  {
    "text": "the other hand does not require so it was Explorer with dedicated Hardware Ware but at the end it actually does not",
    "start": "1794000",
    "end": "1800519"
  },
  {
    "text": "require any dedicated Hardware it can be accomplished with both local and routed",
    "start": "1800519",
    "end": "1805600"
  },
  {
    "text": "packets uh there are a few things that needs to be taken care of so this is the",
    "start": "1805600",
    "end": "1811600"
  },
  {
    "start": "1809000",
    "end": "2038000"
  },
  {
    "text": "example so we send packet has you know these values we",
    "start": "1811600",
    "end": "1818159"
  },
  {
    "text": "don't control suppose we sendly remotely from the internet so we know that the final pocket at some point in his long",
    "start": "1818159",
    "end": "1825000"
  },
  {
    "text": "journey to our destination will go on EET and we'll have a standard stter frame delimiter now we put our data we",
    "start": "1825000",
    "end": "1833120"
  },
  {
    "text": "put another stter frame delimiter here additional data and we need to make sure",
    "start": "1833120",
    "end": "1840159"
  },
  {
    "text": "that the final packet that is being transmitted at the point of exploitation",
    "start": "1840159",
    "end": "1845200"
  },
  {
    "text": "has a frame chain frame check sequence which is identical like in the previous",
    "start": "1845200",
    "end": "1850960"
  },
  {
    "text": "case for the two uh align packets um and also one thing that we do we put a lot",
    "start": "1850960",
    "end": "1857360"
  },
  {
    "text": "of pattern uh between the beginning of the legitimate packet and its header and the",
    "start": "1857360",
    "end": "1863840"
  },
  {
    "text": "other the the injected starter frame the limiter because when the packet is being detected mid-flight the more distance we",
    "start": "1863840",
    "end": "1871480"
  },
  {
    "text": "have between the original starter frame delimiter and the one which is ejecting inside so the more padding we have the",
    "start": "1871480",
    "end": "1877760"
  },
  {
    "text": "higher the chances are that the packet is going to be pared in Flight in the padding area so if we maximize those",
    "start": "1877760",
    "end": "1885440"
  },
  {
    "text": "chances we maximize chances of the second starter frame delimeter which is within the payload of being detected so",
    "start": "1885440",
    "end": "1892880"
  },
  {
    "text": "in this case here in this packet here um we have the original header then at some",
    "start": "1892880",
    "end": "1898919"
  },
  {
    "text": "point we have four bites that we need for creating the CRC for2 collisions",
    "start": "1898919",
    "end": "1905440"
  },
  {
    "text": "then we have a full Preamble a starter frame delimiter and then an additional packet that goes on here um now since",
    "start": "1905440",
    "end": "1913159"
  },
  {
    "text": "this packet is routed we need to anticipate for the routing modifications but that's not for the most part it's",
    "start": "1913159",
    "end": "1918880"
  },
  {
    "text": "not difficult to do because the time to leave is something that you can probe uh you can try to uh guess what the time to",
    "start": "1918880",
    "end": "1925880"
  },
  {
    "text": "leave is going to be uh the IP checkm which is modified because the time to leave is modified you can change right",
    "start": "1925880",
    "end": "1932000"
  },
  {
    "text": "away um the real problem here are the source and destination Mac um at the",
    "start": "1932000",
    "end": "1938080"
  },
  {
    "text": "point of injection either you need to know them you need to guess them or you need to attack a ler 2 protocol where uh",
    "start": "1938080",
    "end": "1945000"
  },
  {
    "text": "it's either using predefined source and destination Max or on IPv6 actually you can infer uh the",
    "start": "1945000",
    "end": "1951679"
  },
  {
    "text": "mees uh in in certain scenarios uh from the actual IP addresses that you're using because the uh IP address the IPv6",
    "start": "1951679",
    "end": "1959679"
  },
  {
    "text": "address is derived from from the Mac uh and this is required for doing the CRC for2 Collision so um we use Julian tin's",
    "start": "1959679",
    "end": "1968919"
  },
  {
    "text": "uh cr42 Collision uh helper tool which is excellent so we wrap it in a in a in",
    "start": "1968919",
    "end": "1974960"
  },
  {
    "text": "a script which allows to conveniently do the modification on our payload this is also going to be released so in this",
    "start": "1974960",
    "end": "1981320"
  },
  {
    "text": "specific case uh we use a UDP packet because so John pastel teaches us that",
    "start": "1981320",
    "end": "1987360"
  },
  {
    "text": "in UDP packets you can disable the checksum you can put a checksum in zero and then you don't care about tweaking the UDP checkm uh when you do your",
    "start": "1987360",
    "end": "1994519"
  },
  {
    "text": "compensation uh this is actually not required it is convenient but it's not required even if you're targeting a",
    "start": "1994519",
    "end": "2000159"
  },
  {
    "text": "protocol which has internal checks some it is not going to be a problem because you you can always craft it in a way",
    "start": "2000159",
    "end": "2006120"
  },
  {
    "text": "that the check some n itself at some point and then you can have your own injection it's it's takes a while to",
    "start": "2006120",
    "end": "2012080"
  },
  {
    "text": "explain but it's it can be done uh and email us if you want more detail about it um so and again the the the the real",
    "start": "2012080",
    "end": "2020080"
  },
  {
    "text": "issue here that makes it not super practical is the fact that you need to know the source and destination Mac",
    "start": "2020080",
    "end": "2025480"
  },
  {
    "text": "unless you're dealing with a protocol or systems where those addresses are known",
    "start": "2025480",
    "end": "2030559"
  },
  {
    "text": "or you're dealing with a pv6 uh where you're using eui 64 addresses derived",
    "start": "2030559",
    "end": "2036080"
  },
  {
    "text": "from the MAC address so so uh let us do a demo of",
    "start": "2036080",
    "end": "2043398"
  },
  {
    "start": "2038000",
    "end": "2081000"
  },
  {
    "text": "this okay so what we're going to do this laptop here which is injected in",
    "start": "2043639",
    "end": "2051158"
  },
  {
    "text": "the packet is connected to a router which is connected to another router which is connected to a switch which is",
    "start": "2051159",
    "end": "2057358"
  },
  {
    "text": "connected to the Final Destination so we're routing the packet through multiple devices and multiple switches",
    "start": "2057359",
    "end": "2063440"
  },
  {
    "text": "to show that we're not doing this um locally so did you check that the",
    "start": "2063440",
    "end": "2068560"
  },
  {
    "text": "connections are good uh is it going to work okay so so we're not using the xmos",
    "start": "2068560",
    "end": "2076480"
  },
  {
    "text": "here for doing this we're just using um a standard packet which is being sent uh",
    "start": "2076480",
    "end": "2082240"
  },
  {
    "start": "2081000",
    "end": "2565000"
  },
  {
    "text": "over the wire so uh this is what we're going to do we're going to",
    "start": "2082240",
    "end": "2089240"
  },
  {
    "text": "have okay we can kill this it's not it's going to working just fine I'm sure that",
    "start": "2091599",
    "end": "2097720"
  },
  {
    "text": "she was a virgin we have time we'll do it live",
    "start": "2097720",
    "end": "2102800"
  },
  {
    "text": "so here I'm going to Snee for packets on Port from packet on",
    "start": "2102800",
    "end": "2110760"
  },
  {
    "text": "Port wait a second your shell skills and system",
    "start": "2111040",
    "end": "2117760"
  },
  {
    "text": "administration skills they nullify themselves when you're presenting in front of an audience you're just like a",
    "start": "2117760",
    "end": "2123000"
  },
  {
    "text": "two years old with a console you don't know what to do when you're presenting so",
    "start": "2123000",
    "end": "2128240"
  },
  {
    "text": "here this is the actual uh this is the transmission side we are sniffing for",
    "start": "2128240",
    "end": "2133880"
  },
  {
    "text": "packets on Port 666 here we will sniff unpack it on",
    "start": "2133880",
    "end": "2140760"
  },
  {
    "text": "Port 53 also on uh the transmitting side",
    "start": "2140760",
    "end": "2146320"
  },
  {
    "text": "so 66",
    "start": "2146320",
    "end": "2149800"
  },
  {
    "text": "here and dead",
    "start": "2153079",
    "end": "2158440"
  },
  {
    "text": "screens dead",
    "start": "2158440",
    "end": "2163760"
  },
  {
    "text": "dead dead oh for sake anyway okay",
    "start": "2163760",
    "end": "2170359"
  },
  {
    "text": "so so this is a transmitting side we have P 53 here and P 666 here so what we",
    "start": "2170359",
    "end": "2177440"
  },
  {
    "text": "were trying to do we send a stream of DNS packets and we want to turn",
    "start": "2177440",
    "end": "2183359"
  },
  {
    "text": "magically that packet invoking science into a TCP packet okay we want to turn",
    "start": "2183359",
    "end": "2190119"
  },
  {
    "text": "that so on the left side here you see the transmitting side uh and we're",
    "start": "2190119",
    "end": "2195280"
  },
  {
    "text": "sniffing uh the two different ports to show you that on the transmitting side we will not cheat and we will not",
    "start": "2195280",
    "end": "2201480"
  },
  {
    "text": "actually send a packet for Port 666 we will only send packets UDP packets DNS",
    "start": "2201480",
    "end": "2207400"
  },
  {
    "text": "packets so on the receiving side",
    "start": "2207400",
    "end": "2212440"
  },
  {
    "text": "here we s for Port 666",
    "start": "2212480",
    "end": "2219160"
  },
  {
    "text": "and actually let me do it that way let me suppress the verus",
    "start": "2219599",
    "end": "2227838"
  },
  {
    "text": "output and here was n on",
    "start": "2231920",
    "end": "2236160"
  },
  {
    "text": "Port Port 53 so on the left hand side we have the",
    "start": "2237880",
    "end": "2244319"
  },
  {
    "text": "sending side on the rece on the right hand side we have the receiveing side and between these two laptops we have",
    "start": "2244319",
    "end": "2250480"
  },
  {
    "text": "two routers and a switch now I'm going to do it uh here maybe I",
    "start": "2250480",
    "end": "2258960"
  },
  {
    "text": "have another shell somewhere have another terminal here",
    "start": "2258960",
    "end": "2264838"
  },
  {
    "text": "okay okay so",
    "start": "2265839",
    "end": "2269560"
  },
  {
    "text": "here okay you also forget your password when",
    "start": "2272319",
    "end": "2278720"
  },
  {
    "text": "you're doing live",
    "start": "2278720",
    "end": "2281319"
  },
  {
    "text": "demos okay",
    "start": "2284280",
    "end": "2288119"
  },
  {
    "text": "so okay so now I'm sending the packet which",
    "start": "2292359",
    "end": "2299599"
  },
  {
    "text": "is not being received on that side so wait a second something is wrong in the",
    "start": "2299599",
    "end": "2304760"
  },
  {
    "text": "connection so you're attached here on this thing here this goes to that",
    "start": "2304760",
    "end": "2311280"
  },
  {
    "text": "that goes to there and this one goes",
    "start": "2311280",
    "end": "2316920"
  },
  {
    "text": "goes",
    "start": "2316920",
    "end": "2319920"
  },
  {
    "text": "here is your link up did you configure your your ethernet",
    "start": "2321960",
    "end": "2328040"
  },
  {
    "text": "here mhm",
    "start": "2328040",
    "end": "2331680"
  },
  {
    "text": "she was not a virgin I told",
    "start": "2342200",
    "end": "2346240"
  },
  {
    "text": "you don't fa me now okay",
    "start": "2361440",
    "end": "2367440"
  },
  {
    "text": "so yep it's correct",
    "start": "2395040",
    "end": "2399319"
  },
  {
    "text": "no okay we know what's wrong of course Danelle forgot to do something okay so while he fixes",
    "start": "2416599",
    "end": "2422240"
  },
  {
    "text": "[Music] that just give us a second yeah",
    "start": "2422240",
    "end": "2429318"
  },
  {
    "text": "you had one thing to do and I mean it's it's it's unbelievable that's not me I",
    "start": "2432520",
    "end": "2438480"
  },
  {
    "text": "cannot find anything that's a lame excuse where let's I",
    "start": "2438480",
    "end": "2445838"
  },
  {
    "text": "mean okay",
    "start": "2446160",
    "end": "2450160"
  },
  {
    "text": "just bear with us it will be worth it [Music]",
    "start": "2457359",
    "end": "2463480"
  },
  {
    "text": "trusted okay so let's see if it works",
    "start": "2463480",
    "end": "2468640"
  },
  {
    "text": "now okay so now we see yes so now we see Port 53 so we have the stream of UDP",
    "start": "2471480",
    "end": "2478240"
  },
  {
    "text": "packets being sent and being received okay so now we do the magic trick and we",
    "start": "2478240",
    "end": "2485280"
  },
  {
    "text": "just unplug you know a cable somewhere here in the",
    "start": "2485280",
    "end": "2492040"
  },
  {
    "text": "path yes you see that 666 in the front on the receiving",
    "start": "2493440",
    "end": "2500720"
  },
  {
    "text": "side and that was not transmitted by his laptop so this is Magic we turned a UDP",
    "start": "2503880",
    "end": "2510400"
  },
  {
    "text": "packet in a TCP scene on the receiving side now the impact of that is that",
    "start": "2510400",
    "end": "2516000"
  },
  {
    "text": "whatever firewall whatever filtering you have in the in in between if you can trigger this condition uh at a point",
    "start": "2516000",
    "end": "2523760"
  },
  {
    "text": "which is after the filtering of course nobody will know that that packet has been sent and the other interesting",
    "start": "2523760",
    "end": "2529400"
  },
  {
    "text": "thing is that packet can be completely arbitrary from a layer two perspective so you can inject VLAN tags you can",
    "start": "2529400",
    "end": "2536440"
  },
  {
    "text": "inject you know MLS frames you can manipulate that packet at a very low layer you can even do the tricks that we",
    "start": "2536440",
    "end": "2543040"
  },
  {
    "text": "discuss about the passive top because that packet is going to be a line at this very beginning of the EET frame and",
    "start": "2543040",
    "end": "2550760"
  },
  {
    "text": "as I can as you can see I did one try here I mean I didn't have to do it",
    "start": "2550760",
    "end": "2555839"
  },
  {
    "text": "multiple times because the way this packet is constructed is that the padding is is long enough uh to really",
    "start": "2555839",
    "end": "2565079"
  },
  {
    "start": "2565000",
    "end": "2661000"
  },
  {
    "text": "maximize your chances of of being of of being detected in in Flight um and this",
    "start": "2565079",
    "end": "2572480"
  },
  {
    "text": "will happen with every single EET because this is a design flaw uh basic it's not an implementation flow so every",
    "start": "2572480",
    "end": "2579119"
  },
  {
    "text": "single EET we tested every single combination works with the very very few",
    "start": "2579119",
    "end": "2584359"
  },
  {
    "text": "exceptions that are actually uh presented in our white paper so there might be conditions where one Eep is",
    "start": "2584359",
    "end": "2591599"
  },
  {
    "text": "very picky about the standard and the other one is very loose so if you have a",
    "start": "2591599",
    "end": "2597520"
  },
  {
    "text": "non-compliant EET on the transmitting side and a compliant EET on receiving sign then the padding will be a problem",
    "start": "2597520",
    "end": "2604480"
  },
  {
    "text": "for you uh because it will affect the way the packet is receive but this is a very rare combination most of the times",
    "start": "2604480",
    "end": "2610440"
  },
  {
    "text": "the majority of the times that we tested this this works and this was the the the backup slide so you can see this request",
    "start": "2610440",
    "end": "2617200"
  },
  {
    "text": "legitimate request for google.com it could be a DNS reply it could be a DNS request it could be any packet that is",
    "start": "2617200",
    "end": "2623160"
  },
  {
    "text": "going to to be routed um to the Final Destination and it become uh a TCP",
    "start": "2623160",
    "end": "2629599"
  },
  {
    "text": "packet and the way the UDP packet works and DNS packet Works in this specific",
    "start": "2629599",
    "end": "2634960"
  },
  {
    "text": "case the actual payload of the packet in it does not affect the functionality of the UDP request the UDP request will be",
    "start": "2634960",
    "end": "2641880"
  },
  {
    "text": "honored by a DNS server normally unless you actively do a TCP dump you actively",
    "start": "2641880",
    "end": "2648160"
  },
  {
    "text": "dissected packet you will not find the trailer data so it will be a functioning pocket you can you can Nest your your",
    "start": "2648160",
    "end": "2655240"
  },
  {
    "text": "packet in packet in a payload without affecting the functionality um of um the outer uh packet um and this is very",
    "start": "2655240",
    "end": "2664520"
  },
  {
    "start": "2661000",
    "end": "2753000"
  },
  {
    "text": "relevant for C Class home embedded system so there are lots of system that we often audit in automotive uh avionics",
    "start": "2664520",
    "end": "2671400"
  },
  {
    "text": "or Industrial Automation SCA systems where usually you have an usted Zone",
    "start": "2671400",
    "end": "2677520"
  },
  {
    "text": "that can send data to your device and this device somehow will rrap that data",
    "start": "2677520",
    "end": "2682920"
  },
  {
    "text": "to ethernet packet untrusted uh networks now in these kind of systems in our experiences always",
    "start": "2682920",
    "end": "2690040"
  },
  {
    "text": "extremely easy to find bags that would actually reset the entire device because uh there are many bags or denal service",
    "start": "2690040",
    "end": "2696599"
  },
  {
    "text": "conditions now when you hit those if you can control some data which is going to",
    "start": "2696599",
    "end": "2701800"
  },
  {
    "text": "be wrapped in an Ethernet packet you can trigger this kind of condition and have",
    "start": "2701800",
    "end": "2708599"
  },
  {
    "text": "uh your data being sent on a trusted domain uh and the other benefit of these",
    "start": "2708599",
    "end": "2713839"
  },
  {
    "text": "systems is that 100% of The Times They always use fixed Max Mac addresses which are documented in the specifications for",
    "start": "2713839",
    "end": "2721559"
  },
  {
    "text": "uh functional reasons so uh we actually had to test this condition in real system and it it would have been a",
    "start": "2721559",
    "end": "2729079"
  },
  {
    "text": "problem with safety impact when the attack uh is for some reason is not",
    "start": "2729079",
    "end": "2735000"
  },
  {
    "text": "preventable by the way the system it is set up uh so you know it is an it is an",
    "start": "2735000",
    "end": "2742559"
  },
  {
    "text": "interesting problem which doesn't have a huge impact on on the majority of system",
    "start": "2742559",
    "end": "2749280"
  },
  {
    "text": "but where it has an impact it it could be it could be uh really severe um so we",
    "start": "2749280",
    "end": "2756119"
  },
  {
    "text": "are going to release today uh the firmware for the exmos kit uh that",
    "start": "2756119",
    "end": "2762200"
  },
  {
    "text": "allows you to send the arbitrary packets uh we have uh white paper which details",
    "start": "2762200",
    "end": "2768359"
  },
  {
    "text": "everything uh in a much more complete way than this presentation we also released the simple patch for injecting",
    "start": "2768359",
    "end": "2774640"
  },
  {
    "text": "arbitrary frame check sequence on on your Intel uh car we also have the script and as a future Pro we will try",
    "start": "2774640",
    "end": "2782079"
  },
  {
    "text": "to work with Michael Osman here because despite being evil is actually really nice guy and he's is doing a nice",
    "start": "2782079",
    "end": "2788280"
  },
  {
    "text": "project called da show where he is creating a platform uh where you can actually um men in the middle and either",
    "start": "2788280",
    "end": "2796160"
  },
  {
    "text": "sniff or modify you know uh arbitrary infnet frames at a gigabit level uh the",
    "start": "2796160",
    "end": "2801440"
  },
  {
    "text": "platform you know is more interesting in this that will be has a a daughter board connected with a medine connector and it",
    "start": "2801440",
    "end": "2807319"
  },
  {
    "text": "will have different kind of of protocols and and connection that you can play with but we're interested in infnet we",
    "start": "2807319",
    "end": "2813720"
  },
  {
    "text": "will try to Port this work there and to see the applicability on gigabit internet as well as as other protocols",
    "start": "2813720",
    "end": "2820000"
  },
  {
    "text": "pretty much uh every time you have these kind of frames which have a marker for the start and the end uh you might be",
    "start": "2820000",
    "end": "2826400"
  },
  {
    "text": "affected by uh these kind of problems so uh thank you very much and now we can",
    "start": "2826400",
    "end": "2832599"
  },
  {
    "text": "take [Applause]",
    "start": "2832599",
    "end": "2839100"
  },
  {
    "text": "questions any questions whatsoever y",
    "start": "2840960",
    "end": "2848480"
  },
  {
    "text": "yes can you get a little closer I cannot hear very well so oh maybe they give you a mic yes the same kind",
    "start": "2860440",
    "end": "2866119"
  },
  {
    "text": "of exist if you shut down",
    "start": "2866119",
    "end": "2872599"
  },
  {
    "text": "man yes so the question is if this condition can be triggered by shutting out a port uh and turning it back on yes",
    "start": "2874079",
    "end": "2881400"
  },
  {
    "text": "if you change yes if you change the the speed of the link if you turn the port",
    "start": "2881400",
    "end": "2886720"
  },
  {
    "text": "down or up if you reboot the switch if you plug or unplug a cable everything",
    "start": "2886720",
    "end": "2892559"
  },
  {
    "text": "that will prevent the FI because of Link State reasons to send packets when the",
    "start": "2892559",
    "end": "2898079"
  },
  {
    "text": "FI will come back up for whatever reason speed change all of these condition this condition",
    "start": "2898079",
    "end": "2904480"
  },
  {
    "text": "happens in all of these cases so the easiest way for us uh in the demo is to",
    "start": "2904480",
    "end": "2910079"
  },
  {
    "text": "Simply plug and unplug the cable uh with when you want to actively exploit it it's uh rebooting the switch or making",
    "start": "2910079",
    "end": "2917040"
  },
  {
    "text": "it crash okay so but suppose you in a network and you're targeting a specific system you just send your stream of",
    "start": "2917040",
    "end": "2923319"
  },
  {
    "text": "packets your entire day and you might just wait for the the server to reboot or uh the switch for reboot or somebody",
    "start": "2923319",
    "end": "2929720"
  },
  {
    "text": "to plug and unplug the cable and this will happen with a very very high reliability you know again we had to try",
    "start": "2929720",
    "end": "2935400"
  },
  {
    "text": "it once so our success rate with this kind of setup is usually 90% so nine",
    "start": "2935400",
    "end": "2941359"
  },
  {
    "text": "nine times out of 10 we get it the first time so the demo gods have been kind so we got it the first time but it's",
    "start": "2941359",
    "end": "2947640"
  },
  {
    "text": "actually surprisingly uh reliable in the way it works and the fastest you're",
    "start": "2947640",
    "end": "2952920"
  },
  {
    "text": "sending and the more padding you put in the packet the more reliable it will be but you have 1500 bytes to play with so",
    "start": "2952920",
    "end": "2960400"
  },
  {
    "text": "you know it's you know you have you have lots of padding that you that you can put inside the tricky part is doing the",
    "start": "2960400",
    "end": "2967319"
  },
  {
    "text": "the CRC Collision because of the source and destination Mac so in the source and destination Mac you know six octets like",
    "start": "2967319",
    "end": "2974240"
  },
  {
    "text": "because threee for each Mac or vendor okay so you can say okay it's going to be Cisco it's going to be Intel uh it's",
    "start": "2974240",
    "end": "2979880"
  },
  {
    "text": "fine you have those six octus that if you don't know them you might as well Brute Force the four bytes for the CRC",
    "start": "2979880",
    "end": "2985400"
  },
  {
    "text": "for2 Collision but that will take a long time so either you need to know them somehow or you target a protocol where",
    "start": "2985400",
    "end": "2992280"
  },
  {
    "text": "you don't have this problem with IPv6 or if you have other frames and capsulated frames so that's the only tricky part",
    "start": "2992280",
    "end": "2999839"
  },
  {
    "text": "but for us in our area of testing uh embedded system they always have predictable mac addresses it really",
    "start": "2999839",
    "end": "3006079"
  },
  {
    "text": "doesn't matter at all but that's the only thing that saves this attack from being uh you know a more important",
    "start": "3006079",
    "end": "3012680"
  },
  {
    "text": "problem but you know again IPv6 uh this raises the bar for the security of Mac",
    "start": "3012680",
    "end": "3018079"
  },
  {
    "text": "addresses in a way which often we say well no it doesn't matter if you know them you know for this specific attack",
    "start": "3018079",
    "end": "3023920"
  },
  {
    "text": "it it's important you know",
    "start": "3023920",
    "end": "3028200"
  },
  {
    "text": "yes will this work if the packet gets encapsulated on non- ethernet networks",
    "start": "3029880",
    "end": "3035079"
  },
  {
    "text": "and re like comes back out so um it doesn't matter so you can do it over the",
    "start": "3035079",
    "end": "3041480"
  },
  {
    "text": "Internet we say it doesn't matter if in the middle you have non EET what matters",
    "start": "3041480",
    "end": "3046559"
  },
  {
    "text": "is where you're actually triggering the condition so you can have all kind of non EET uh transport in the middle at",
    "start": "3046559",
    "end": "3053760"
  },
  {
    "text": "the end what matters is when it hits your final server or the switch before or the switch before and you're very",
    "start": "3053760",
    "end": "3060000"
  },
  {
    "text": "likely to have your last mile or so so to speak with you know at least you know",
    "start": "3060000",
    "end": "3066440"
  },
  {
    "text": "a number of switches and a number of infnet connected so um yeah so it",
    "start": "3066440",
    "end": "3071640"
  },
  {
    "text": "doesn't matter if it gets converted to other to other transport layers in in the middle as long because you don't",
    "start": "3071640",
    "end": "3077760"
  },
  {
    "text": "need special artware for the packet in packet you know you're just using your legitimate payload which so happens to",
    "start": "3077760",
    "end": "3084880"
  },
  {
    "text": "match the symbols used for the original start of friendly limitter you just need to wait for any EET link inside or to",
    "start": "3084880",
    "end": "3092000"
  },
  {
    "text": "control it in a way that the first start of friendly limiter is missed you know yes um I had a question about",
    "start": "3092000",
    "end": "3100000"
  },
  {
    "text": "virtualization like have you tried this with like an ESX server and like a V switch or something like that okay uh we",
    "start": "3100000",
    "end": "3106640"
  },
  {
    "text": "haven't tried um however um even the virtualization your host will have a",
    "start": "3106640",
    "end": "3114000"
  },
  {
    "text": "actual EET and since this is not related to the way this is not related to the",
    "start": "3114000",
    "end": "3119640"
  },
  {
    "text": "way the driver works this is a problem between the FI and the mac and it's also a problem on the transmitting side it's",
    "start": "3119640",
    "end": "3125640"
  },
  {
    "text": "not a problem the receiving side so what's as fault here is who's sending the packet to you not you that you're",
    "start": "3125640",
    "end": "3133000"
  },
  {
    "text": "receiving the packet this is was actually really hard to debug okay to to find this because unless you actually",
    "start": "3133000",
    "end": "3138839"
  },
  {
    "text": "are on the wire between the F the max you don't know who's at fault but we narrow this down and it is the",
    "start": "3138839",
    "end": "3144680"
  },
  {
    "text": "transmitting side so if you rece receiving site it virtualize it doesn't really matter it will receive the packet",
    "start": "3144680",
    "end": "3150280"
  },
  {
    "text": "because this misalignment is at the injection site so it doesn't matter if",
    "start": "3150280",
    "end": "3155839"
  },
  {
    "text": "your re Target is virtualized or not and even if you have a virtualized router",
    "start": "3155839",
    "end": "3161040"
  },
  {
    "text": "which is send in packet it's still doesn't matter because at the end of the day you have a physical network interface car with a Mac NFI so it",
    "start": "3161040",
    "end": "3168720"
  },
  {
    "text": "doesn't the OS layer here and the the driver does not play a role in any of",
    "start": "3168720",
    "end": "3174559"
  },
  {
    "text": "this it is purely between the mac and and the",
    "start": "3174559",
    "end": "3179720"
  },
  {
    "text": "FI any other questions good thank you very much",
    "start": "3179720",
    "end": "3188720"
  },
  {
    "text": "[Applause]",
    "start": "3188780",
    "end": "3191749"
  }
]