[
  {
    "start": "0",
    "end": "45000"
  },
  {
    "text": "hello i'm veronica kova and today i am going to talk about over",
    "start": "1360",
    "end": "6640"
  },
  {
    "text": "the air bluetooth slow energy hacking i have been in a security field for many",
    "start": "6640",
    "end": "14240"
  },
  {
    "text": "years and in 2018 i wanted to do something that i",
    "start": "14240",
    "end": "19840"
  },
  {
    "text": "had not done before and i started a company and has been focusing on researching",
    "start": "19840",
    "end": "27599"
  },
  {
    "text": "bluetooth security and today i am going to share my story",
    "start": "27599",
    "end": "34880"
  },
  {
    "text": "from knowing almost nothing about bluetooth to find the remote code vulnerabilities",
    "start": "34880",
    "end": "42000"
  },
  {
    "text": "in the firmware level and first i started i started",
    "start": "42000",
    "end": "49840"
  },
  {
    "start": "45000",
    "end": "45000"
  },
  {
    "text": "uh the bruce's security by uh surveying the existing bluetooth security researchers then i",
    "start": "49840",
    "end": "58079"
  },
  {
    "text": "read about bluetooth specification which is actually uh pretty large but i didn't read all of",
    "start": "58079",
    "end": "65518"
  },
  {
    "text": "it i generally focusing on the lens field and embedded headers that programmers",
    "start": "65519",
    "end": "73760"
  },
  {
    "text": "likely make mistakes then i look for open uh source",
    "start": "73760",
    "end": "79759"
  },
  {
    "text": "implementations because sometimes documentation wasn't uh very vague and for",
    "start": "79759",
    "end": "87520"
  },
  {
    "text": "brutus classy i couldn't find any open source implementations but i found zephyr and apache my new",
    "start": "87520",
    "end": "96079"
  },
  {
    "text": "nimble that is a bluetooth low energy open source open source implementation",
    "start": "96079",
    "end": "103200"
  },
  {
    "start": "103000",
    "end": "103000"
  },
  {
    "text": "but today i'm going to talk about mainly focusing on the ble because that's the one that i have",
    "start": "103600",
    "end": "110560"
  },
  {
    "text": "been focused on recently and here there is a ble stack",
    "start": "110560",
    "end": "117840"
  },
  {
    "text": "and there are many protocols and for the dual chip configuration",
    "start": "117840",
    "end": "122880"
  },
  {
    "text": "these protocols belong to host and these two protocols belongs to the",
    "start": "122880",
    "end": "128640"
  },
  {
    "text": "ble controller and the specification define how hc",
    "start": "128640",
    "end": "134480"
  },
  {
    "text": "a host controller interface should be implemented",
    "start": "134480",
    "end": "139440"
  },
  {
    "text": "through the hci hosts generate generate hci commands to ble controller",
    "start": "140239",
    "end": "148400"
  },
  {
    "text": "and ble controller generate atci events to send back the result to the host",
    "start": "148400",
    "end": "156080"
  },
  {
    "text": "and when you receive uh receive ble packets it also generates hci events",
    "start": "156080",
    "end": "161440"
  },
  {
    "text": "to the host and for this here single chip",
    "start": "161440",
    "end": "168080"
  },
  {
    "start": "165000",
    "end": "165000"
  },
  {
    "text": "configuration this all protocols will be located on the ble controller",
    "start": "168080",
    "end": "175599"
  },
  {
    "text": "but for this configuration the specification does not define how hci should be",
    "start": "175599",
    "end": "182159"
  },
  {
    "text": "implemented so it is up to the implementer they can",
    "start": "182159",
    "end": "187200"
  },
  {
    "text": "use memory cue or they can choose just not having an explicit hci layer",
    "start": "187200",
    "end": "194480"
  },
  {
    "text": "but this tool our focusing on this link layer",
    "start": "194480",
    "end": "199840"
  },
  {
    "text": "when i started this research in mid uh 28 2018 there was a literally zero",
    "start": "200720",
    "end": "208319"
  },
  {
    "text": "of uh zero controller specific vulnerabilities but now",
    "start": "208319",
    "end": "214879"
  },
  {
    "text": "there are 14 of them including a bt classic and ble vulnerabilities",
    "start": "214879",
    "end": "222000"
  },
  {
    "text": "of this 14 only there are only three proven ble rc",
    "start": "222000",
    "end": "229920"
  },
  {
    "text": "vulnerabilities the first one you probably heard of is",
    "start": "229920",
    "end": "235040"
  },
  {
    "text": "bleeding bit and the two are the vulnerabilities of",
    "start": "235040",
    "end": "240879"
  },
  {
    "text": "i am going to talk about today today",
    "start": "240879",
    "end": "245120"
  },
  {
    "text": "and let's see why an attacker is interested in finding this low layer",
    "start": "246000",
    "end": "251360"
  },
  {
    "text": "vulnerabilities let's say on the tackle form of pc specific",
    "start": "251360",
    "end": "256720"
  },
  {
    "text": "vulnerability for this case the attacker can only attack a",
    "start": "256720",
    "end": "263840"
  },
  {
    "text": "single class of the devices but if an attacker find a vulnerability",
    "start": "263840",
    "end": "270720"
  },
  {
    "text": "on this controller uh low layer and this controller",
    "start": "270720",
    "end": "276639"
  },
  {
    "text": "used for different classes of devices he can attack pc or he cannot take car",
    "start": "276639",
    "end": "284400"
  },
  {
    "text": "medical devices or iot devices",
    "start": "284400",
    "end": "289199"
  },
  {
    "start": "289000",
    "end": "289000"
  },
  {
    "text": "and beyond that this low layer in order to attack this lower layer it",
    "start": "289919",
    "end": "296560"
  },
  {
    "text": "does not require either authentication or pairing",
    "start": "296560",
    "end": "301680"
  },
  {
    "text": "the attacker just needs to be nearby the device and i'm going to talk about four",
    "start": "301680",
    "end": "308840"
  },
  {
    "text": "vulnerabilities on this low layer today i prepared demos for the two rca vulnerabilities",
    "start": "308840",
    "end": "316479"
  },
  {
    "text": "and i'll briefly explain two other vulnerabilities",
    "start": "316479",
    "end": "321919"
  },
  {
    "text": "but before talking about the vulnerabilities i wanted to talk about how i set up my lab",
    "start": "322000",
    "end": "328960"
  },
  {
    "text": "in order to start vulnerability hunting",
    "start": "328960",
    "end": "333919"
  },
  {
    "start": "333000",
    "end": "333000"
  },
  {
    "text": "and here is a development board i recommend to uh start with the",
    "start": "334960",
    "end": "342080"
  },
  {
    "text": "development uh dab boards because it's easier to actually find vulnerability and",
    "start": "342080",
    "end": "349840"
  },
  {
    "text": "making exploit because development board in many cases you can do the hardware",
    "start": "349840",
    "end": "354960"
  },
  {
    "text": "debugging but just easy it's easier to finding a vulnerable vulnerability and making or exploit",
    "start": "354960",
    "end": "362560"
  },
  {
    "text": "compared to the end product my lab has more than a dozen",
    "start": "362560",
    "end": "368080"
  },
  {
    "text": "dev boards but i'm just showing you this tool two of them because i'm going to talk about it today",
    "start": "368080",
    "end": "375680"
  },
  {
    "start": "376000",
    "end": "376000"
  },
  {
    "text": "and there is here some serial converters just if you have been uh if you have uh",
    "start": "376880",
    "end": "383600"
  },
  {
    "text": "some experience with this software development it's just like pre-nap uart is the",
    "start": "383600",
    "end": "389199"
  },
  {
    "text": "basic or the easiest way to debug or hardware and i happen to have one here the",
    "start": "389199",
    "end": "395840"
  },
  {
    "text": "leftmost one this serial converter laying around in the house and i use this one however it",
    "start": "395840",
    "end": "401280"
  },
  {
    "text": "does not have a cts and rts lines and it took me for a while",
    "start": "401280",
    "end": "406800"
  },
  {
    "text": "to figure out even how to see the uart messages so i do recommend if you're getting the",
    "start": "406800",
    "end": "412960"
  },
  {
    "text": "serial converter get get ones that has a cts and rts lines",
    "start": "412960",
    "end": "420560"
  },
  {
    "text": "and here is a hardware debuggers this here are two upper ones are for",
    "start": "421599",
    "end": "428479"
  },
  {
    "text": "open ocd but using openocd is required slightly more work than the",
    "start": "428479",
    "end": "434319"
  },
  {
    "text": "sega jailing debuggers i for the beginners or the hobbies i recommend using this",
    "start": "434319",
    "end": "441039"
  },
  {
    "text": "sega gel link for the hobbies you can use this education license however for the commercial",
    "start": "441039",
    "end": "448880"
  },
  {
    "text": "you have to get the commercial license",
    "start": "448880",
    "end": "452720"
  },
  {
    "start": "453000",
    "end": "453000"
  },
  {
    "text": "and since i'm enforcing that board i had to have a way of power on and off this debt",
    "start": "454240",
    "end": "461919"
  },
  {
    "text": "boards so i used uhop control and then this here the usb hub",
    "start": "461919",
    "end": "469199"
  },
  {
    "text": "so the folder can turn it on and off of my target",
    "start": "469199",
    "end": "475199"
  },
  {
    "start": "475000",
    "end": "475000"
  },
  {
    "text": "and when you generate the arbitrary ble packet there should be a way to",
    "start": "475599",
    "end": "480879"
  },
  {
    "text": "actually look at them so you can confirm the packets uh generated properly",
    "start": "480879",
    "end": "486240"
  },
  {
    "text": "i use the uber tools this is very easy to use and it has a very good display however",
    "start": "486240",
    "end": "493919"
  },
  {
    "text": "it looks like a software has not been updated very recently so it does not support newer",
    "start": "493919",
    "end": "501039"
  },
  {
    "text": "bluetooth pro of newer bluetooth protocol features and luckily",
    "start": "501039",
    "end": "508240"
  },
  {
    "text": "there are this sniffle was introduced at the end of the 2019 at hardware.io",
    "start": "508240",
    "end": "516479"
  },
  {
    "text": "and sniffer does support newer uh bluetooth specification bluetooth",
    "start": "516479",
    "end": "522880"
  },
  {
    "text": "protocol features",
    "start": "522880",
    "end": "525919"
  },
  {
    "start": "527000",
    "end": "527000"
  },
  {
    "text": "and here's a nordic device and i use the nordic device in order to generate the arbitrary packets",
    "start": "528160",
    "end": "535200"
  },
  {
    "text": "i start with the another 52a32 is because this zephyr and nimble has a",
    "start": "535200",
    "end": "541680"
  },
  {
    "text": "lot of documentations and examples using this device that is because the documentation was",
    "start": "541680",
    "end": "547760"
  },
  {
    "text": "written on wire level and this one was a older dev board",
    "start": "547760",
    "end": "553040"
  },
  {
    "text": "the problem using this older one was in order to use us uart i had to",
    "start": "553040",
    "end": "559519"
  },
  {
    "text": "connect my serial converter to dc some of the individual gpio and it is",
    "start": "559519",
    "end": "565839"
  },
  {
    "text": "kind of cumbersome when you move around this data board there's multiple uh cables coming out of",
    "start": "565839",
    "end": "571040"
  },
  {
    "text": "it so i end up using nrf 5840",
    "start": "571040",
    "end": "576320"
  },
  {
    "text": "and good thing about this board is it support the virtual comport so you need only one usb cable",
    "start": "576320",
    "end": "584959"
  },
  {
    "start": "585000",
    "end": "585000"
  },
  {
    "text": "and with this hardware you need a software and",
    "start": "585360",
    "end": "590480"
  },
  {
    "text": "today i'm going to release the jackpin nimble using this jackpin nimble software you",
    "start": "590480",
    "end": "596000"
  },
  {
    "text": "can generate an arbitrary ble link layer packets",
    "start": "596000",
    "end": "601279"
  },
  {
    "text": "and it will be easy to extend to make your own folder",
    "start": "601279",
    "end": "607519"
  },
  {
    "text": "checkpoint number come into the two parts the first one is the former i made a",
    "start": "607760",
    "end": "614160"
  },
  {
    "text": "modification to the nimble because of nimble does not generate a package that violates the",
    "start": "614160",
    "end": "620880"
  },
  {
    "text": "bluetooth specification but we do want to to generate the package that doesn't comply",
    "start": "620880",
    "end": "626320"
  },
  {
    "text": "with the specification and in order to describe this formula",
    "start": "626320",
    "end": "632240"
  },
  {
    "text": "i made a host code here and this host code is written in python and this python code",
    "start": "632240",
    "end": "640079"
  },
  {
    "text": "is responsible for making these arbitrary packets and give it to",
    "start": "640079",
    "end": "646240"
  },
  {
    "text": "the former and then the formula we're going to send these packets",
    "start": "646240",
    "end": "652560"
  },
  {
    "text": "now we have left set up then let's look at a specific chip",
    "start": "652640",
    "end": "658480"
  },
  {
    "start": "658000",
    "end": "658000"
  },
  {
    "text": "the first target is texas instrument wl 1835 mod chip",
    "start": "658480",
    "end": "664720"
  },
  {
    "text": "and this chip supports bluetooth version 4.2 and this case of develop a board was",
    "start": "664720",
    "end": "671839"
  },
  {
    "text": "slightly different from other development board units in that it does not have hardware",
    "start": "671839",
    "end": "679040"
  },
  {
    "text": "debugging uh exposed and also uh on this in this chip the bl link",
    "start": "679040",
    "end": "686480"
  },
  {
    "text": "layer is baked into rom which means the end product they use this chip will have the same uh",
    "start": "686480",
    "end": "694959"
  },
  {
    "text": "rom contents as this this device this development board",
    "start": "694959",
    "end": "700800"
  },
  {
    "text": "and the host or the end product in order to pass the functionality of",
    "start": "701040",
    "end": "707839"
  },
  {
    "text": "functionality box or the security vulnerabilities yes the host use a ti provided patch",
    "start": "707839",
    "end": "716000"
  },
  {
    "text": "and redirect control a floor into the different new code",
    "start": "716000",
    "end": "722880"
  },
  {
    "text": "nti also provide some tools for the developers and one of them is a uh hci tester",
    "start": "722880",
    "end": "731120"
  },
  {
    "text": "and logo and what does this hci tester does i just mentioned about the patch",
    "start": "731120",
    "end": "736320"
  },
  {
    "text": "file and the patch part is in binary format",
    "start": "736320",
    "end": "741360"
  },
  {
    "text": "and if you use a hci tester this tool will translate this binary format",
    "start": "741360",
    "end": "748079"
  },
  {
    "text": "to human readable strings in the case of logo when i look at just the uart",
    "start": "748079",
    "end": "754880"
  },
  {
    "text": "message traffic the url messages actually is in binary format and if you",
    "start": "754880",
    "end": "761680"
  },
  {
    "text": "attach this lower to the uart this lower will display log messages in strings",
    "start": "761680",
    "end": "769360"
  },
  {
    "text": "and you we just saw this diagram in case of this uh ti chip is belong",
    "start": "770399",
    "end": "777200"
  },
  {
    "text": "to this dual chip configuration and in the demo you will see uh i'm",
    "start": "777200",
    "end": "784000"
  },
  {
    "text": "actually generating some hci commands in order to control this uh",
    "start": "784000",
    "end": "789360"
  },
  {
    "text": "ti device",
    "start": "789360",
    "end": "792480"
  },
  {
    "start": "793000",
    "end": "793000"
  },
  {
    "text": "so now i have this development board and i just need to start from this you know just read the",
    "start": "794480",
    "end": "800240"
  },
  {
    "text": "one day board so i open uh this patch file using the hci tester and i could see there are",
    "start": "800240",
    "end": "808160"
  },
  {
    "text": "many vendor specific right memory because the patch bar parties you know",
    "start": "808160",
    "end": "813600"
  },
  {
    "text": "to patch this this chip that means there can be a read",
    "start": "813600",
    "end": "821120"
  },
  {
    "text": "memory and i found a read memory in the one of the files that ti provides in the file",
    "start": "821120",
    "end": "829120"
  },
  {
    "text": "next to it's the read memory there was a op call i took that all called opcode and use the",
    "start": "829120",
    "end": "834880"
  },
  {
    "text": "uh hci tool which is a linux tool and i could dump the accessible memory",
    "start": "834880",
    "end": "843600"
  },
  {
    "text": "from uh this data board and one big step i could basically",
    "start": "843600",
    "end": "851199"
  },
  {
    "text": "reverse this formula better was i after the identifying this log functions i mentioned about the",
    "start": "851199",
    "end": "857839"
  },
  {
    "text": "logger so this load function send these log messages in binary format",
    "start": "857839",
    "end": "864320"
  },
  {
    "text": "to the uart and based on this in the colors of the basically looking at the colors",
    "start": "864320",
    "end": "871440"
  },
  {
    "text": "of this low function i could identify some of the function names and then some code context",
    "start": "871440",
    "end": "879760"
  },
  {
    "text": "and here's an example when i just open this formula i just dump the memory",
    "start": "880720",
    "end": "888000"
  },
  {
    "text": "with the ida there is not no information because there's no symbols but here this function turns out to be",
    "start": "888000",
    "end": "896000"
  },
  {
    "text": "one of the low wrapper functions and the first argument",
    "start": "896000",
    "end": "901199"
  },
  {
    "text": "is the log string id and after identifying these",
    "start": "901199",
    "end": "908800"
  },
  {
    "text": "many log function wrap like a wrapper functions i could see that this particular wrapper",
    "start": "908800",
    "end": "916800"
  },
  {
    "text": "set the loop level to two there is a level from one to six and it expects",
    "start": "916800",
    "end": "923920"
  },
  {
    "text": "two parameters uh for the low format string here because you",
    "start": "923920",
    "end": "929040"
  },
  {
    "text": "expect the two parameters here and for the id once this function takes",
    "start": "929040",
    "end": "934720"
  },
  {
    "text": "this id it adds 35 80 to this number and",
    "start": "934720",
    "end": "940639"
  },
  {
    "text": "and then figure it out you need to basically use this string and based on this string now i can see",
    "start": "940639",
    "end": "949199"
  },
  {
    "text": "the function here name is this uh this string the perform command",
    "start": "949199",
    "end": "957519"
  },
  {
    "text": "by rep and i made a ida script to repeat this process",
    "start": "957519",
    "end": "963600"
  },
  {
    "start": "964000",
    "end": "964000"
  },
  {
    "text": "and now i have a lot of steady analysis information however many cases this is not enough to",
    "start": "965279",
    "end": "971199"
  },
  {
    "text": "actually identify the vulnerability or they actually exploit the vulnerability",
    "start": "971199",
    "end": "976959"
  },
  {
    "text": "so i made a folder i mentioned about the jackpot nimble so jack b nimble is basically coded",
    "start": "976959",
    "end": "983120"
  },
  {
    "text": "extracted from this fuzzer and while i was generating arbitrary",
    "start": "983120",
    "end": "988399"
  },
  {
    "text": "packet and when i crashed the device the information i'm looking at was not enough and i will show you example in",
    "start": "988399",
    "end": "994880"
  },
  {
    "text": "the next slide so i first enjoyed engineered i read the",
    "start": "994880",
    "end": "1000399"
  },
  {
    "text": "hard four to heart fault handler code and they found that there is a flag in",
    "start": "1000399",
    "end": "1005680"
  },
  {
    "text": "the memory if i set the flag i could see way more information",
    "start": "1005680",
    "end": "1011360"
  },
  {
    "text": "and also uh if you i have a way of hardware debugging i can just check the",
    "start": "1011360",
    "end": "1018160"
  },
  {
    "text": "register values or the memory values on the fly but since i don't have that",
    "start": "1018160",
    "end": "1023519"
  },
  {
    "text": "i patch this binary in order to read some register values or the memory address values and here's",
    "start": "1023519",
    "end": "1031038"
  },
  {
    "text": "an example of the logo here if i don't patch in a binary at all this is the default case",
    "start": "1031039",
    "end": "1039038"
  },
  {
    "text": "what you can see in the logo and this particular case is a while",
    "start": "1039039",
    "end": "1044798"
  },
  {
    "text": "making the proofable concept code and actually overload the pc value which we're going",
    "start": "1044799",
    "end": "1049840"
  },
  {
    "text": "to trigger the hard fault and in here just it uh re",
    "start": "1049840",
    "end": "1055360"
  },
  {
    "text": "repeat the similar information here just repeatedly",
    "start": "1055360",
    "end": "1060480"
  },
  {
    "text": "so now i patch the binary and let's look at the first patch here",
    "start": "1060480",
    "end": "1067360"
  },
  {
    "text": "and this one actually shows the uh uh just before step of overflow occurs and here",
    "start": "1067360",
    "end": "1074880"
  },
  {
    "text": "you don't need to worry about this uh log string here i just pick all string id that takes",
    "start": "1074880",
    "end": "1081360"
  },
  {
    "text": "two parameters this is the information important information so i wanted to print out what's the",
    "start": "1081360",
    "end": "1088080"
  },
  {
    "text": "source address and what's the length value for the mem copy and here when i print out it's a heap",
    "start": "1088080",
    "end": "1096480"
  },
  {
    "text": "address and please remember this one because when i talked about actual vulnerability i will mention this source address again",
    "start": "1096480",
    "end": "1103760"
  },
  {
    "text": "and also this length value here and i put the code just before mem copy is called",
    "start": "1103760",
    "end": "1113279"
  },
  {
    "text": "and another patch i've done is i mentioned about default uh hard fold handler and i set the flag",
    "start": "1114480",
    "end": "1121200"
  },
  {
    "text": "to 1 so i can see more information at the time of the crash so now i",
    "start": "1121200",
    "end": "1128000"
  },
  {
    "text": "see the old register values and the stack information and in the following there is a hit",
    "start": "1128000",
    "end": "1133200"
  },
  {
    "text": "memory information as well and now let's talk about the uh the",
    "start": "1133200",
    "end": "1139200"
  },
  {
    "start": "1136000",
    "end": "1136000"
  },
  {
    "text": "vulnerability that end to remote code execution",
    "start": "1139200",
    "end": "1144320"
  },
  {
    "text": "actually i found this uh integer on the floorbail while long ago when i disassembled this",
    "start": "1144320",
    "end": "1150960"
  },
  {
    "text": "formula i identified the main puppy first and looked around the older colors",
    "start": "1150960",
    "end": "1156559"
  },
  {
    "text": "and i could identify these integers on the floor right away and which can use to the stack of",
    "start": "1156559",
    "end": "1162320"
  },
  {
    "text": "overflow but at the time i didn't have a way of just reaching this code path",
    "start": "1162320",
    "end": "1170160"
  },
  {
    "text": "so ever after i'm making the fuzzer i could i was able to crush the device and then i could see the uh the actual",
    "start": "1170160",
    "end": "1177520"
  },
  {
    "text": "vulnerability can be reachable and the exploitable and guess what this mistake is exactly actually same as",
    "start": "1177520",
    "end": "1184640"
  },
  {
    "text": "bleeding bit but in the different code ways in the case of bleeding being it was a",
    "start": "1184640",
    "end": "1190320"
  },
  {
    "text": "hip overflow flow but mine is a stack overflow which means a notetaker can exploit this more",
    "start": "1190320",
    "end": "1197440"
  },
  {
    "text": "reliably and let's see when attack actually takes",
    "start": "1197440",
    "end": "1204840"
  },
  {
    "text": "place a victim starts scanning then attacker here you can just send the",
    "start": "1204840",
    "end": "1212000"
  },
  {
    "text": "militia of malicious advertisement packet and you as you see here neither",
    "start": "1212000",
    "end": "1218159"
  },
  {
    "text": "authentication nor the pairing required just scanning and malicious packet that's it",
    "start": "1218159",
    "end": "1225919"
  },
  {
    "start": "1225000",
    "end": "1225000"
  },
  {
    "text": "and now take a look at the assembly code in this function as you see here",
    "start": "1228000",
    "end": "1235520"
  },
  {
    "text": "the uh function allocate a stack buffer space for hex to see",
    "start": "1235520",
    "end": "1243120"
  },
  {
    "text": "and the next easy i actually skip a little bit instruction here",
    "start": "1243120",
    "end": "1248159"
  },
  {
    "text": "because it was just irrelevant this r6 value is a pdu length video is like a packet",
    "start": "1248159",
    "end": "1254720"
  },
  {
    "text": "data unit length and then i will show you the format in the very next slide it take the length of value",
    "start": "1254720",
    "end": "1262720"
  },
  {
    "text": "and subtract six here here there is an integer on the floor if our six values is smaller than six",
    "start": "1262720",
    "end": "1270320"
  },
  {
    "text": "this end of uh r6 here becomes really big number",
    "start": "1270320",
    "end": "1275360"
  },
  {
    "text": "but next instruction is unsigned by extension which means it will eliminate",
    "start": "1275360",
    "end": "1281600"
  },
  {
    "text": "the three most significant bytes and then leave only the last uh least significant byte on here",
    "start": "1281600",
    "end": "1290720"
  },
  {
    "text": "and i want you to actually remember this part why am i emphasizing because when i talk about on another my those",
    "start": "1290720",
    "end": "1297360"
  },
  {
    "text": "are those vulnerability this actually uh play a big role here",
    "start": "1297360",
    "end": "1302880"
  },
  {
    "text": "this instruction and this r6 become here length is a big",
    "start": "1302880",
    "end": "1308799"
  },
  {
    "text": "number equals to the length field and the next r1 if you remember from the previous",
    "start": "1308799",
    "end": "1315360"
  },
  {
    "text": "slide on the previous slide these art file value has the hip buffer",
    "start": "1315360",
    "end": "1320799"
  },
  {
    "text": "address here oops let's see here it goes to here the source address",
    "start": "1320799",
    "end": "1327360"
  },
  {
    "text": "and destination address here is a stack address here so you see there is a",
    "start": "1327360",
    "end": "1333679"
  },
  {
    "text": "step of overflow and this is how this packet looks advertisement packet looks",
    "start": "1333679",
    "end": "1339200"
  },
  {
    "start": "1335000",
    "end": "1335000"
  },
  {
    "text": "like this lens field here for the uh this is from the version 4.2",
    "start": "1339200",
    "end": "1344799"
  },
  {
    "text": "this 6 bit comes here and which is the r6 value and if i put a less than 6",
    "start": "1344799",
    "end": "1352799"
  },
  {
    "text": "then there's an integer on the flow and let's see why the programmer make those kind of mistake",
    "start": "1352799",
    "end": "1359280"
  },
  {
    "text": "according to to according to the stack version 4.2 there are seven pedo types",
    "start": "1359280",
    "end": "1366880"
  },
  {
    "text": "and all of them has at least actually six byte data here so program programmer can think as okay",
    "start": "1366880",
    "end": "1374320"
  },
  {
    "text": "there is a packing lens i can just substract six however if not it is an uh malicious",
    "start": "1374320",
    "end": "1379360"
  },
  {
    "text": "packet it can be smaller than the six now i started developing the exploits",
    "start": "1379360",
    "end": "1386640"
  },
  {
    "text": "but then the problem is was because of the background ble traffic i could not control this uh hip contacts",
    "start": "1386640",
    "end": "1394000"
  },
  {
    "text": "uh really uh i could not control the hip context well you know to",
    "start": "1394000",
    "end": "1401120"
  },
  {
    "text": "make a reliable exploit so i come up with an attack",
    "start": "1401120",
    "end": "1406159"
  },
  {
    "start": "1405000",
    "end": "1405000"
  },
  {
    "text": "it's a quiet place attack there are a lot of uh dos attack uh those vulnerability",
    "start": "1406159",
    "end": "1411440"
  },
  {
    "text": "including one of mine and any unsuccessful attack can be a dos attack",
    "start": "1411440",
    "end": "1418320"
  },
  {
    "text": "let's see here there is an attacker and he he wants to take this vl",
    "start": "1418320",
    "end": "1424480"
  },
  {
    "text": "controller but now he sees a lot of nearby uh device adle devices",
    "start": "1424480",
    "end": "1430240"
  },
  {
    "text": "and you want to quiet them down then you can just kill all of them using the dos attack",
    "start": "1430240",
    "end": "1438559"
  },
  {
    "text": "then finally this attacker can just send a malicious packet targeting this victim now",
    "start": "1438640",
    "end": "1445919"
  },
  {
    "text": "here is a thing i'm not a real attacker and i cannot kill the old neighbor's bl",
    "start": "1445919",
    "end": "1451600"
  },
  {
    "text": "devices so my solution is i have a bucket a paint bucket",
    "start": "1451600",
    "end": "1460720"
  },
  {
    "text": "i made a faraday case out of this paint pocket",
    "start": "1460720",
    "end": "1466159"
  },
  {
    "text": "and here in order to reduce the uh background ability noise this is the uh",
    "start": "1466320",
    "end": "1474320"
  },
  {
    "text": "rf shielding fabric and i wrap my devices using the tinfoil",
    "start": "1474320",
    "end": "1482960"
  },
  {
    "text": "and i also actually when i wrap these all devices into the bucket i put the uber tools",
    "start": "1482960",
    "end": "1489039"
  },
  {
    "text": "here in order to verify actually the background noise has been reduced",
    "start": "1489039",
    "end": "1495840"
  },
  {
    "text": "and let's take a look at the demo i set up my uh jp nimble here and",
    "start": "1496640",
    "end": "1505440"
  },
  {
    "text": "attack i'm going to attack this ti",
    "start": "1505440",
    "end": "1509759"
  },
  {
    "text": "device",
    "start": "1512840",
    "end": "1515840"
  },
  {
    "start": "1604000",
    "end": "1604000"
  },
  {
    "text": "okay now let's take a look at the uh next vulnerability when i report the",
    "start": "1604400",
    "end": "1611039"
  },
  {
    "text": "first book to the ti i actually made a poc that overriding the uh a program counter to the 414141",
    "start": "1611039",
    "end": "1618720"
  },
  {
    "text": "i thought this basically this vulnerability making the poc for this vulnerability will be very simple just you're going to",
    "start": "1618720",
    "end": "1625679"
  },
  {
    "text": "be very similar to the first one because when you see this chord the uh",
    "start": "1625679",
    "end": "1632000"
  },
  {
    "text": "programmers mistake is the exactly the same there is on the floor which we want to call the stack buff",
    "start": "1632000",
    "end": "1638960"
  },
  {
    "text": "overflow however it turns out to be uh uh uh the",
    "start": "1638960",
    "end": "1644399"
  },
  {
    "text": "man uh the manipulating the heat contents was a bit harder so for now it is a potential rc but",
    "start": "1644399",
    "end": "1651919"
  },
  {
    "text": "at some point i'll make a plc for this uh vulnerability the difference uh this block from the",
    "start": "1651919",
    "end": "1659520"
  },
  {
    "text": "the first one is a victim it should be in the active scanning",
    "start": "1659520",
    "end": "1665840"
  },
  {
    "text": "and the victim will receive all this advertisement advertisement just like passive scanning",
    "start": "1665840",
    "end": "1673039"
  },
  {
    "text": "then victim will generate the scan request in order to get more information but at",
    "start": "1673039",
    "end": "1680240"
  },
  {
    "text": "the time the attacker can generate a malicious scan response",
    "start": "1680240",
    "end": "1686799"
  },
  {
    "text": "in the same case it does not require either authentication or pairing",
    "start": "1686799",
    "end": "1693679"
  },
  {
    "start": "1694000",
    "end": "1694000"
  },
  {
    "text": "and here this pedio type is four and length doesn't need to be smaller than the six",
    "start": "1694320",
    "end": "1701200"
  },
  {
    "text": "now let's look at the next target next target is silicon left efr 32 mg",
    "start": "1701200",
    "end": "1708080"
  },
  {
    "start": "1704000",
    "end": "1704000"
  },
  {
    "text": "a 21 chip i picked this chip because it supports bluetooth 5 extended",
    "start": "1708080",
    "end": "1713760"
  },
  {
    "text": "advertisement and this development board also supports hardware debugging",
    "start": "1713760",
    "end": "1719520"
  },
  {
    "text": "and silicon lab provides an sdk and this sdk comes with a bluetooth stack in library format and",
    "start": "1719520",
    "end": "1727200"
  },
  {
    "text": "luckily this library has some symbols and this silicon lab chip is uh one of",
    "start": "1727200",
    "end": "1734480"
  },
  {
    "text": "these the single chip configuration case so all these protocols",
    "start": "1734480",
    "end": "1740880"
  },
  {
    "text": "resides on the controller device so when i show you the demo you will not",
    "start": "1740880",
    "end": "1746320"
  },
  {
    "text": "see any interaction between the host and the controller through this hci",
    "start": "1746320",
    "end": "1751440"
  },
  {
    "text": "interface and now i just started fuzzing extended",
    "start": "1751440",
    "end": "1756720"
  },
  {
    "start": "1754000",
    "end": "1754000"
  },
  {
    "text": "advertisement packets and it but i ran into a problem because",
    "start": "1756720",
    "end": "1762320"
  },
  {
    "text": "it turns out initially when i make the photo i initially use the zephyr but then this zephyr turns out is not",
    "start": "1762320",
    "end": "1769200"
  },
  {
    "text": "supporting the extended advertisement yet so i had to change my code to use a",
    "start": "1769200",
    "end": "1776000"
  },
  {
    "text": "nimble and right after i fought in extended",
    "start": "1776000",
    "end": "1781840"
  },
  {
    "text": "advertisement i found a dose for right away then i fasted more a couple more couple",
    "start": "1781840",
    "end": "1788559"
  },
  {
    "text": "of days but there was no crash so i was wondering whether my defaults are actually generating the",
    "start": "1788559",
    "end": "1795120"
  },
  {
    "text": "package properly or not and from that there was a case i use the uber to",
    "start": "1795120",
    "end": "1800960"
  },
  {
    "text": "see the packets but ubertooth does not support its extended advertisement",
    "start": "1800960",
    "end": "1806880"
  },
  {
    "text": "packet or the very long length advertisement packet so i couldn't see",
    "start": "1806880",
    "end": "1812159"
  },
  {
    "text": "this you know my generated call so but luckily there was sniffle which is",
    "start": "1812159",
    "end": "1817440"
  },
  {
    "text": "supposed to support the extended advertisement package so when i use a sniffle",
    "start": "1817440",
    "end": "1823440"
  },
  {
    "text": "i could not see any of my packets and turns out when i debugged the nimble",
    "start": "1823440",
    "end": "1829440"
  },
  {
    "text": "and it turns up turns out nimble actually does not allocate enough",
    "start": "1829440",
    "end": "1834799"
  },
  {
    "text": "time to send really long length advertisement packets so i modified the nimble then",
    "start": "1834799",
    "end": "1842480"
  },
  {
    "text": "i found the crash almost right away which yields to an rc bug",
    "start": "1842480",
    "end": "1848480"
  },
  {
    "text": "so before looking at the icy ball i wanted to mention about my dosbox because i wanted to point it out that",
    "start": "1849600",
    "end": "1856159"
  },
  {
    "text": "not every memorable forward flow will end up as an rc bug",
    "start": "1856159",
    "end": "1862639"
  },
  {
    "text": "here is a dose bug i want you to just focus this here a",
    "start": "1862799",
    "end": "1869200"
  },
  {
    "text": "little bit this r2 and rc i6 we're going to have a length value that",
    "start": "1869200",
    "end": "1875760"
  },
  {
    "text": "is uh attacker can control and since there is an integer on the",
    "start": "1875760",
    "end": "1880880"
  },
  {
    "text": "floor on the flow they will r2 value will become really big number",
    "start": "1880880",
    "end": "1886640"
  },
  {
    "text": "but the difference from the previous bug is in the previous block there was a",
    "start": "1886640",
    "end": "1892080"
  },
  {
    "start": "1888000",
    "end": "1888000"
  },
  {
    "text": "unsigned byte extension because of this this really big number four by number becomes just one byte",
    "start": "1892080",
    "end": "1898960"
  },
  {
    "text": "but this vulnerable code here does not have any of these before calling the memo",
    "start": "1898960",
    "end": "1906159"
  },
  {
    "start": "1899000",
    "end": "1899000"
  },
  {
    "text": "so when mammoth called with this big number it will end up as a memory accident",
    "start": "1906159",
    "end": "1911679"
  },
  {
    "text": "violation and the chances that in an attacker can interrupt this member is really slim so",
    "start": "1911679",
    "end": "1918799"
  },
  {
    "text": "i call this bug as a dos bar",
    "start": "1918799",
    "end": "1922559"
  },
  {
    "text": "now let's move on to the hip of overflow which is an rc bug and explaining this hip or any any hip",
    "start": "1924000",
    "end": "1932080"
  },
  {
    "text": "bubble flow quickly verbally is hard so i'll give you a really big picture here",
    "start": "1932080",
    "end": "1937360"
  },
  {
    "text": "when uh this uh silence chip received a packet it actually chopped into the uh",
    "start": "1937360",
    "end": "1943120"
  },
  {
    "text": "smaller chunks which is small chunks actually length is weird actually is like a hex",
    "start": "1943120",
    "end": "1948559"
  },
  {
    "text": "45 which is an interesting number and it maintains unchanged buffer while",
    "start": "1948559",
    "end": "1954559"
  },
  {
    "text": "he's maintaining this chain buffer a programmer programmer made a mistake and i could",
    "start": "1954559",
    "end": "1960720"
  },
  {
    "text": "actually end up overriding of my memory chunk boundary and i could override this",
    "start": "1960720",
    "end": "1967039"
  },
  {
    "text": "memory chunks metadata pointer and after that i could override",
    "start": "1967039",
    "end": "1972240"
  },
  {
    "text": "a function pointer which is for remote code execution",
    "start": "1972240",
    "end": "1977279"
  },
  {
    "text": "i report this one to scilab on february 21st and they fixed march 3rd or 20th which",
    "start": "1977279",
    "end": "1984000"
  },
  {
    "text": "is very impressive speed and let's look at the uh what attack",
    "start": "1984000",
    "end": "1990480"
  },
  {
    "text": "packet looks like here is the uh see this is the uh",
    "start": "1990480",
    "end": "1995600"
  },
  {
    "text": "advertisement header and this is the extended advertisement type",
    "start": "1995600",
    "end": "2002559"
  },
  {
    "text": "and there is a nested header here and i could use this uh length here",
    "start": "2002559",
    "end": "2010320"
  },
  {
    "text": "and to set to 30 uh 3c which actually triggered some",
    "start": "2010320",
    "end": "2016840"
  },
  {
    "text": "miscalculation and if you want to know the details",
    "start": "2016840",
    "end": "2022880"
  },
  {
    "text": "please read my white paper and the white paper will describe in detail",
    "start": "2022880",
    "end": "2030000"
  },
  {
    "text": "and let's look at the uh rca persistent demo i set up my uh jp nimble here",
    "start": "2030000",
    "end": "2038480"
  },
  {
    "text": "and this jp nimble will stand on malicious package over the air",
    "start": "2038480",
    "end": "2043679"
  },
  {
    "text": "and we will attack the controller and you will persist",
    "start": "2043679",
    "end": "2061839"
  },
  {
    "text": "now i'll briefly explain general bluetooth security challenges",
    "start": "2174480",
    "end": "2179838"
  },
  {
    "text": "just like most other embedded systems it lacks common exploit mitigations what it means is it is",
    "start": "2181440",
    "end": "2189359"
  },
  {
    "text": "easier for an attacker to exploit devices in the wild",
    "start": "2189359",
    "end": "2194800"
  },
  {
    "text": "and also cheap vendors often do not support securable or secure reset what it means",
    "start": "2196000",
    "end": "2203520"
  },
  {
    "text": "is if an attacker successfully exploits a device he can persist on the device",
    "start": "2203520",
    "end": "2211119"
  },
  {
    "start": "2212000",
    "end": "2212000"
  },
  {
    "text": "and what does that mean it's easy to exploit and easy to proceed what is the impact",
    "start": "2212079",
    "end": "2217440"
  },
  {
    "text": "of it well it turns out it's very hard to assess at the",
    "start": "2217440",
    "end": "2222480"
  },
  {
    "text": "complete impact over any security findings that is because it is hard to identify",
    "start": "2222480",
    "end": "2228800"
  },
  {
    "text": "end product they use a particular chip and also it is difficult to identify",
    "start": "2228800",
    "end": "2235280"
  },
  {
    "text": "different classes of devices a certain chip is being used either",
    "start": "2235280",
    "end": "2241680"
  },
  {
    "text": "and just like any other businesses the customer information is a secret and it will be up the vendor to notify",
    "start": "2241760",
    "end": "2249920"
  },
  {
    "text": "any security findings to their customers and even one worst case is an end pro",
    "start": "2249920",
    "end": "2257119"
  },
  {
    "text": "uh end product manufacturer may use a middleman a package a provider in this if there is this kind",
    "start": "2257119",
    "end": "2264720"
  },
  {
    "text": "of chain it is less likely this any security findings information",
    "start": "2264720",
    "end": "2270240"
  },
  {
    "text": "is being propagated down this chain so this is all time i get today and for",
    "start": "2270240",
    "end": "2278160"
  },
  {
    "text": "any additional information you can check out at the github in this url i want to thank",
    "start": "2278160",
    "end": "2286160"
  },
  {
    "text": "zeno rafa and marian for the valuable feedback and thank you for watching my talk",
    "start": "2286160",
    "end": "2293680"
  }
]