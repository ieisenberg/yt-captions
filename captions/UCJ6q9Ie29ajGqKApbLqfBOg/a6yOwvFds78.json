[
  {
    "text": "good afternoon welcome to AV leak",
    "start": "80",
    "end": "2679"
  },
  {
    "text": "fingerprinting antivirus emulators for",
    "start": "2679",
    "end": "5040"
  },
  {
    "text": "advanced malware evasion in Surf Seas GH",
    "start": "5040",
    "end": "8800"
  },
  {
    "text": "with Alex bazelle uh just a couple of",
    "start": "8800",
    "end": "11960"
  },
  {
    "text": "things before we get started don't",
    "start": "11960",
    "end": "13799"
  },
  {
    "text": "forget to stop by the business Hall",
    "start": "13799",
    "end": "15320"
  },
  {
    "text": "that's located in Bayside AB during the",
    "start": "15320",
    "end": "18199"
  },
  {
    "text": "day and the welcome reception is tonight",
    "start": "18199",
    "end": "20519"
  },
  {
    "text": "1730 to 1900 in the same room blacknet",
    "start": "20519",
    "end": "24199"
  },
  {
    "text": "uh black hat Arsenal is in the Palm",
    "start": "24199",
    "end": "25960"
  },
  {
    "text": "forer on level three and the pon awards",
    "start": "25960",
    "end": "28840"
  },
  {
    "text": "are tonight in Mandalay Bay BCD at 18:30",
    "start": "28840",
    "end": "32599"
  },
  {
    "text": "finally let's make sure we have our",
    "start": "32599",
    "end": "33840"
  },
  {
    "text": "phones on so we're not making lots of",
    "start": "33840",
    "end": "36520"
  },
  {
    "text": "noise and also uh these are being",
    "start": "36520",
    "end": "39200"
  },
  {
    "text": "recorded So when the Q&A time comes",
    "start": "39200",
    "end": "41480"
  },
  {
    "text": "please use the microphones that are",
    "start": "41480",
    "end": "43239"
  },
  {
    "text": "placed in the aisles for questions with",
    "start": "43239",
    "end": "46000"
  },
  {
    "text": "that Alex cheers hi so my name is Alex",
    "start": "46000",
    "end": "49520"
  },
  {
    "text": "bazelle and I'm here to talk about AV",
    "start": "49520",
    "end": "51239"
  },
  {
    "text": "leak fingerprinting antivirus emulators",
    "start": "51239",
    "end": "53359"
  },
  {
    "text": "for advanced malware evasion so a little",
    "start": "53359",
    "end": "55960"
  },
  {
    "text": "introduction um and an overview of the",
    "start": "55960",
    "end": "57960"
  },
  {
    "text": "slides um I'm a recent graduate from R",
    "start": "57960",
    "end": "60600"
  },
  {
    "text": "poly Technic Institute RPI and I worked",
    "start": "60600",
    "end": "62920"
  },
  {
    "text": "on this as part of an undergraduate and",
    "start": "62920",
    "end": "64478"
  },
  {
    "text": "then graduate research project under Dr",
    "start": "64479",
    "end": "66640"
  },
  {
    "text": "blent yenner and I also wanted to take",
    "start": "66640",
    "end": "68439"
  },
  {
    "text": "this time to thank Jeremy Blackthorne a",
    "start": "68439",
    "end": "70040"
  },
  {
    "text": "PhD candidate and direct Dr Jenner who",
    "start": "70040",
    "end": "72040"
  },
  {
    "text": "uh provided me with the original",
    "start": "72040",
    "end": "73159"
  },
  {
    "text": "inspiration for this work uh and",
    "start": "73159",
    "end": "74920"
  },
  {
    "text": "sponsored me doing it um so in outline",
    "start": "74920",
    "end": "78000"
  },
  {
    "text": "of the presentation just a little intro",
    "start": "78000",
    "end": "79720"
  },
  {
    "text": "now then we're going to talk about the",
    "start": "79720",
    "end": "81119"
  },
  {
    "text": "background and some prior work then our",
    "start": "81119",
    "end": "83079"
  },
  {
    "text": "Innovation with this tool AV leak and a",
    "start": "83079",
    "end": "85240"
  },
  {
    "text": "live demo and some results and then some",
    "start": "85240",
    "end": "87799"
  },
  {
    "text": "conclusions I also wanted to note we",
    "start": "87799",
    "end": "89640"
  },
  {
    "text": "have lot more content than I can fit in",
    "start": "89640",
    "end": "91119"
  },
  {
    "text": "just a 25-minute briefing uh so we are",
    "start": "91119",
    "end": "93600"
  },
  {
    "text": "publishing next week at unck woot and we",
    "start": "93600",
    "end": "95399"
  },
  {
    "text": "have a 15-page paper a lot of citations",
    "start": "95399",
    "end": "97640"
  },
  {
    "text": "a lot of more material if you want to",
    "start": "97640",
    "end": "98960"
  },
  {
    "text": "read that and also bunch of extra slides",
    "start": "98960",
    "end": "100880"
  },
  {
    "text": "available and the version of this deck",
    "start": "100880",
    "end": "102840"
  },
  {
    "text": "uh published",
    "start": "102840",
    "end": "103960"
  },
  {
    "text": "online so the problem uh in the face of",
    "start": "103960",
    "end": "106799"
  },
  {
    "text": "a million plus new malware samples a day",
    "start": "106799",
    "end": "109280"
  },
  {
    "text": "uh static signature-based malware",
    "start": "109280",
    "end": "110880"
  },
  {
    "text": "detection is just dead um in response uh",
    "start": "110880",
    "end": "114680"
  },
  {
    "text": "AV and and you know the the anti malware",
    "start": "114680",
    "end": "116799"
  },
  {
    "text": "industry has turned to Dynamic analysis",
    "start": "116799",
    "end": "118920"
  },
  {
    "text": "actually running by Aries in these",
    "start": "118920",
    "end": "120399"
  },
  {
    "text": "emulated environments and then seeing",
    "start": "120399",
    "end": "121880"
  },
  {
    "text": "how they behave if they drop Mal or they",
    "start": "121880",
    "end": "124600"
  },
  {
    "text": "do you heuristically malicious actions",
    "start": "124600",
    "end": "127399"
  },
  {
    "text": "uh and the problem with this is that",
    "start": "127399",
    "end": "128520"
  },
  {
    "text": "malware that can detect that it's",
    "start": "128520",
    "end": "129599"
  },
  {
    "text": "running in an emulator in a VM uh can",
    "start": "129599",
    "end": "132840"
  },
  {
    "text": "then behave benely uh and try to avoid",
    "start": "132840",
    "end": "135640"
  },
  {
    "text": "detection and it does that by finding",
    "start": "135640",
    "end": "137640"
  },
  {
    "text": "what we call fingerprints uh of these uh",
    "start": "137640",
    "end": "140599"
  },
  {
    "text": "systems and uh over 80% of malware in",
    "start": "140599",
    "end": "143560"
  },
  {
    "text": "the second half of 2015 exhibited",
    "start": "143560",
    "end": "145400"
  },
  {
    "text": "evasive Behavior so there's been a lot",
    "start": "145400",
    "end": "147519"
  },
  {
    "text": "of Prior work on detecting uh things",
    "start": "147519",
    "end": "149599"
  },
  {
    "text": "like VMware Kimu Zen these high-end",
    "start": "149599",
    "end": "151519"
  },
  {
    "text": "emulators these things you use to",
    "start": "151519",
    "end": "153200"
  },
  {
    "text": "actually do your own Mal analysis",
    "start": "153200",
    "end": "154480"
  },
  {
    "text": "running a debugger there's been little",
    "start": "154480",
    "end": "156440"
  },
  {
    "text": "prior work on consumer AV",
    "start": "156440",
    "end": "158319"
  },
  {
    "text": "emulators so what I'm talking about is",
    "start": "158319",
    "end": "160560"
  },
  {
    "text": "the emulators built into consumer AV",
    "start": "160560",
    "end": "162159"
  },
  {
    "text": "products that protect your computers at",
    "start": "162159",
    "end": "164200"
  },
  {
    "text": "home uh so these systems are intuitively",
    "start": "164200",
    "end": "166519"
  },
  {
    "text": "easy to evade I've talked about this",
    "start": "166519",
    "end": "167760"
  },
  {
    "text": "work many times people and they said oh",
    "start": "167760",
    "end": "169360"
  },
  {
    "text": "that's you know that's super easy it's a",
    "start": "169360",
    "end": "170599"
  },
  {
    "text": "cakewalk and that's true but no one has",
    "start": "170599",
    "end": "172840"
  },
  {
    "text": "actually gone and done this work and",
    "start": "172840",
    "end": "174400"
  },
  {
    "text": "actually proven uh and shown ways of",
    "start": "174400",
    "end": "176800"
  },
  {
    "text": "doing this and detecting these systems",
    "start": "176800",
    "end": "178879"
  },
  {
    "text": "so prior approaching is for finding",
    "start": "178879",
    "end": "180519"
  },
  {
    "text": "fingerprints finding these ways of",
    "start": "180519",
    "end": "181879"
  },
  {
    "text": "detecting these systems uh are really",
    "start": "181879",
    "end": "184120"
  },
  {
    "text": "inefficient either you reverse",
    "start": "184120",
    "end": "185599"
  },
  {
    "text": "engineering which is just way too hard",
    "start": "185599",
    "end": "187680"
  },
  {
    "text": "um in incredibly difficult or blackbox",
    "start": "187680",
    "end": "190480"
  },
  {
    "text": "dynamic analysis which I'm going to talk",
    "start": "190480",
    "end": "191840"
  },
  {
    "text": "about in a minute and that's just very",
    "start": "191840",
    "end": "193080"
  },
  {
    "text": "slow and and unwieldy so our goal is to",
    "start": "193080",
    "end": "195840"
  },
  {
    "text": "accelerate and automate this process so",
    "start": "195840",
    "end": "198400"
  },
  {
    "text": "what we built is Av leak a novel tool",
    "start": "198400",
    "end": "200159"
  },
  {
    "text": "that allows researchers to easily and",
    "start": "200159",
    "end": "201519"
  },
  {
    "text": "quickly extract these artifacts these",
    "start": "201519",
    "end": "202920"
  },
  {
    "text": "fingerprints from consumer AV emulators",
    "start": "202920",
    "end": "205000"
  },
  {
    "text": "in order to create evasive",
    "start": "205000",
    "end": "207280"
  },
  {
    "text": "malware uh so now some background so I",
    "start": "207280",
    "end": "210239"
  },
  {
    "text": "mentioned these fingerprints these ways",
    "start": "210239",
    "end": "211519"
  },
  {
    "text": "we can detect these systems and and we",
    "start": "211519",
    "end": "212920"
  },
  {
    "text": "categorize them into six categories uh",
    "start": "212920",
    "end": "215239"
  },
  {
    "text": "from the top the most you know trivially",
    "start": "215239",
    "end": "217560"
  },
  {
    "text": "um trivially found and also most",
    "start": "217560",
    "end": "219760"
  },
  {
    "text": "trivially fixed so things like",
    "start": "219760",
    "end": "221560"
  },
  {
    "text": "hard-coded strings in the environment if",
    "start": "221560",
    "end": "224239"
  },
  {
    "text": "you have like a get computer name always",
    "start": "224239",
    "end": "225879"
  },
  {
    "text": "returns a hard-coded value we just check",
    "start": "225879",
    "end": "227799"
  },
  {
    "text": "for that value we know immediately we're",
    "start": "227799",
    "end": "228959"
  },
  {
    "text": "in that emulator also super easy to fix",
    "start": "228959",
    "end": "231560"
  },
  {
    "text": "you just change that string and",
    "start": "231560",
    "end": "232599"
  },
  {
    "text": "recompile your code then you have",
    "start": "232599",
    "end": "234720"
  },
  {
    "text": "operating system functions that don't",
    "start": "234720",
    "end": "235920"
  },
  {
    "text": "behave correctly uh Network emulation",
    "start": "235920",
    "end": "238319"
  },
  {
    "text": "when they actually try to emulate",
    "start": "238319",
    "end": "239159"
  },
  {
    "text": "network connectivity and they get that",
    "start": "239159",
    "end": "240480"
  },
  {
    "text": "wrong timing skews and bugs that's a",
    "start": "240480",
    "end": "243200"
  },
  {
    "text": "known very hard problem in fact some",
    "start": "243200",
    "end": "245200"
  },
  {
    "text": "folks from VMware published paper a",
    "start": "245200",
    "end": "246480"
  },
  {
    "text": "couple years ago where they said uh not",
    "start": "246480",
    "end": "248280"
  },
  {
    "text": "only is it really not feasible to create",
    "start": "248280",
    "end": "250319"
  },
  {
    "text": "these systems they don't have any",
    "start": "250319",
    "end": "251200"
  },
  {
    "text": "interest even getting close uh creating",
    "start": "251200",
    "end": "252879"
  },
  {
    "text": "systems that are timing accurate uh",
    "start": "252879",
    "end": "255120"
  },
  {
    "text": "process inter inspection looking into",
    "start": "255120",
    "end": "256680"
  },
  {
    "text": "your own process your own behavior your",
    "start": "256680",
    "end": "258160"
  },
  {
    "text": "own register State and then CPU red",
    "start": "258160",
    "end": "260280"
  },
  {
    "text": "pills very subtle uh artifacts related",
    "start": "260280",
    "end": "262800"
  },
  {
    "text": "to the way CPU instructions behave on a",
    "start": "262800",
    "end": "264479"
  },
  {
    "text": "real CPU versus an emulated one so",
    "start": "264479",
    "end": "267639"
  },
  {
    "text": "traditional malware sandboxes like Kimo",
    "start": "267639",
    "end": "269400"
  },
  {
    "text": "and mware um they are built uh in many",
    "start": "269400",
    "end": "272479"
  },
  {
    "text": "layers um and the thing is you can",
    "start": "272479",
    "end": "274759"
  },
  {
    "text": "attack these underlying layers like Kemo",
    "start": "274759",
    "end": "276680"
  },
  {
    "text": "so if I want a bug in Kemo that I can",
    "start": "276680",
    "end": "278080"
  },
  {
    "text": "use it to detect it then I can detect",
    "start": "278080",
    "end": "279919"
  },
  {
    "text": "any Mal sandbox built on top of chemo uh",
    "start": "279919",
    "end": "283240"
  },
  {
    "text": "so they're actually you know you have",
    "start": "283240",
    "end": "285759"
  },
  {
    "text": "lots of systems that can detect ant",
    "start": "285759",
    "end": "287039"
  },
  {
    "text": "analysis but there's also many layers",
    "start": "287039",
    "end": "288680"
  },
  {
    "text": "many layers of vulnerability in these",
    "start": "288680",
    "end": "290560"
  },
  {
    "text": "systems consumer AV is different that",
    "start": "290560",
    "end": "292600"
  },
  {
    "text": "they're designed like this um you",
    "start": "292600",
    "end": "294320"
  },
  {
    "text": "basically have on one side an xd6",
    "start": "294320",
    "end": "295840"
  },
  {
    "text": "emulator an emulator environment and",
    "start": "295840",
    "end": "298080"
  },
  {
    "text": "then also a user mode Windows API",
    "start": "298080",
    "end": "299840"
  },
  {
    "text": "emulator so I'm Ying some subset of the",
    "start": "299840",
    "end": "301280"
  },
  {
    "text": "windows API and they're just stepping",
    "start": "301280",
    "end": "303320"
  },
  {
    "text": "through a malware binary you know",
    "start": "303320",
    "end": "305199"
  },
  {
    "text": "instruction by instruction with the X",
    "start": "305199",
    "end": "306600"
  },
  {
    "text": "Emulator and then emulating certain",
    "start": "306600",
    "end": "308400"
  },
  {
    "text": "Windows API calls when they happen and",
    "start": "308400",
    "end": "310520"
  },
  {
    "text": "then they have this fake environment",
    "start": "310520",
    "end": "311560"
  },
  {
    "text": "that you can uh you know when your",
    "start": "311560",
    "end": "312880"
  },
  {
    "text": "malware does things like get username",
    "start": "312880",
    "end": "314479"
  },
  {
    "text": "they'll return a fake hard good to",
    "start": "314479",
    "end": "316639"
  },
  {
    "text": "username and all they give is an",
    "start": "316639",
    "end": "319319"
  },
  {
    "text": "analysis report that just says what",
    "start": "319319",
    "end": "320360"
  },
  {
    "text": "malware they found so there have been",
    "start": "320360",
    "end": "322520"
  },
  {
    "text": "some prior approaches to evading them",
    "start": "322520",
    "end": "324039"
  },
  {
    "text": "using what we call mutation just packing",
    "start": "324039",
    "end": "326199"
  },
  {
    "text": "a binary over and over again until it's",
    "start": "326199",
    "end": "327560"
  },
  {
    "text": "no longer detected this really doesn't",
    "start": "327560",
    "end": "329520"
  },
  {
    "text": "require any intuitive you know deep",
    "start": "329520",
    "end": "330880"
  },
  {
    "text": "knowledge of the AVS it just pack it",
    "start": "330880",
    "end": "333160"
  },
  {
    "text": "until it doesn't get detected is's also",
    "start": "333160",
    "end": "336199"
  },
  {
    "text": "reversing uh this is extremely",
    "start": "336199",
    "end": "338120"
  },
  {
    "text": "challenging um you have to have expert",
    "start": "338120",
    "end": "339880"
  },
  {
    "text": "knowledge of reversing itself of Av of",
    "start": "339880",
    "end": "342160"
  },
  {
    "text": "Windows internals of xd6 all these you",
    "start": "342160",
    "end": "344639"
  },
  {
    "text": "know layers of knowledge you have to",
    "start": "344639",
    "end": "345880"
  },
  {
    "text": "have and then you're looking at things",
    "start": "345880",
    "end": "347400"
  },
  {
    "text": "that will crash Ida when you when you",
    "start": "347400",
    "end": "349160"
  },
  {
    "text": "import them have lots of anti- analysis",
    "start": "349160",
    "end": "351440"
  },
  {
    "text": "anti debug and then they'll also be",
    "start": "351440",
    "end": "353520"
  },
  {
    "text": "frequently updated and you have to redo",
    "start": "353520",
    "end": "354720"
  },
  {
    "text": "your work that said it has been done uh",
    "start": "354720",
    "end": "357000"
  },
  {
    "text": "roll rolls you can see here at the",
    "start": "357000",
    "end": "358319"
  },
  {
    "text": "bottom uh posted a stack Overflow",
    "start": "358319",
    "end": "360440"
  },
  {
    "text": "question and and he actually you know",
    "start": "360440",
    "end": "362319"
  },
  {
    "text": "has done this but Rolf is probably one",
    "start": "362319",
    "end": "364039"
  },
  {
    "text": "of the best reverse engineers in the",
    "start": "364039",
    "end": "365280"
  },
  {
    "text": "world incredibly talented not everyone",
    "start": "365280",
    "end": "367479"
  },
  {
    "text": "is Rolf and even Rolf doesn't have all",
    "start": "367479",
    "end": "369199"
  },
  {
    "text": "the time in the world to do",
    "start": "369199",
    "end": "371039"
  },
  {
    "text": "this so some other prior approaches",
    "start": "371039",
    "end": "373240"
  },
  {
    "text": "besides versing have been this kind of",
    "start": "373240",
    "end": "374599"
  },
  {
    "text": "blackbox testing this has been presented",
    "start": "374599",
    "end": "376080"
  },
  {
    "text": "at a number of conferences in recent",
    "start": "376080",
    "end": "378000"
  },
  {
    "text": "years U most notably the one Packer to",
    "start": "378000",
    "end": "380360"
  },
  {
    "text": "rule them all talk at black hat 2014",
    "start": "380360",
    "end": "382240"
  },
  {
    "text": "from Arna and",
    "start": "382240",
    "end": "383919"
  },
  {
    "text": "aladan and what these approaches look",
    "start": "383919",
    "end": "385759"
  },
  {
    "text": "like is this begin with a question like",
    "start": "385759",
    "end": "388360"
  },
  {
    "text": "does this emulator emulate some",
    "start": "388360",
    "end": "389800"
  },
  {
    "text": "arbitrary function X",
    "start": "389800",
    "end": "391919"
  },
  {
    "text": "correctly and then they'll create code",
    "start": "391919",
    "end": "393880"
  },
  {
    "text": "that says you know if it ran function X",
    "start": "393880",
    "end": "396400"
  },
  {
    "text": "correctly or didn't return the expected",
    "start": "396400",
    "end": "397680"
  },
  {
    "text": "value I'm going to drop malware else I'm",
    "start": "397680",
    "end": "399800"
  },
  {
    "text": "just going to exit and you keep some",
    "start": "399800",
    "end": "401360"
  },
  {
    "text": "encrypted piece of malware mapped to you",
    "start": "401360",
    "end": "402759"
  },
  {
    "text": "know true and no malware to false and",
    "start": "402759",
    "end": "405039"
  },
  {
    "text": "you put this in the AV and you choose",
    "start": "405039",
    "end": "407280"
  },
  {
    "text": "I'm either to drop malware or not drop",
    "start": "407280",
    "end": "408840"
  },
  {
    "text": "malware and the AV comes back and says",
    "start": "408840",
    "end": "410960"
  },
  {
    "text": "hey we found malware or we didn't find",
    "start": "410960",
    "end": "412520"
  },
  {
    "text": "malware so this is a one bit side",
    "start": "412520",
    "end": "414360"
  },
  {
    "text": "Channel it answers a single true or",
    "start": "414360",
    "end": "415919"
  },
  {
    "text": "false query with each run with each scan",
    "start": "415919",
    "end": "418599"
  },
  {
    "text": "of a given piece of malware",
    "start": "418599",
    "end": "420160"
  },
  {
    "text": "but as you can see this is very slow and",
    "start": "420160",
    "end": "421800"
  },
  {
    "text": "it's best suited defining negative",
    "start": "421800",
    "end": "423319"
  },
  {
    "text": "results so things that are not emulated",
    "start": "423319",
    "end": "425759"
  },
  {
    "text": "correctly and now I want to talk about",
    "start": "425759",
    "end": "427520"
  },
  {
    "text": "our Innovation uh which we call AV leak",
    "start": "427520",
    "end": "430120"
  },
  {
    "text": "so our Innovation on this prior",
    "start": "430120",
    "end": "432800"
  },
  {
    "text": "approach uh so what our Innovation is is",
    "start": "432800",
    "end": "435120"
  },
  {
    "text": "what we exploit arbitrary you know",
    "start": "435120",
    "end": "437520"
  },
  {
    "text": "malware detections to EXT exate",
    "start": "437520",
    "end": "439720"
  },
  {
    "text": "arbitrary specific bite sequences with",
    "start": "439720",
    "end": "441840"
  },
  {
    "text": "each run each scan and we built this",
    "start": "441840",
    "end": "444560"
  },
  {
    "text": "tool in C in Python and we create",
    "start": "444560",
    "end": "446720"
  },
  {
    "text": "fingerprints in hours not seconds um so",
    "start": "446720",
    "end": "449400"
  },
  {
    "text": "want to show you what this looks like uh",
    "start": "449400",
    "end": "451479"
  },
  {
    "text": "so we begin by mapping malware samples",
    "start": "451479",
    "end": "453759"
  },
  {
    "text": "to bite",
    "start": "453759",
    "end": "454800"
  },
  {
    "text": "values like this so we would have a to",
    "start": "454800",
    "end": "458919"
  },
  {
    "text": "Morris and B to code red and C to Zeus",
    "start": "458919",
    "end": "461160"
  },
  {
    "text": "and so forth uh here I just showed the",
    "start": "461160",
    "end": "463360"
  },
  {
    "text": "asy range but in actuality we use the",
    "start": "463360",
    "end": "465000"
  },
  {
    "text": "full range of 0 to 256 or 255 rather 0",
    "start": "465000",
    "end": "468319"
  },
  {
    "text": "to FF um and just map each of those to a",
    "start": "468319",
    "end": "471639"
  },
  {
    "text": "given piece of malware uh you know given",
    "start": "471639",
    "end": "473800"
  },
  {
    "text": "signature uh and in implementation it",
    "start": "473800",
    "end": "475919"
  },
  {
    "text": "gets a lot more complex and you have",
    "start": "475919",
    "end": "477960"
  },
  {
    "text": "signatures that aren always detected and",
    "start": "477960",
    "end": "479560"
  },
  {
    "text": "things like that so there's a lot of",
    "start": "479560",
    "end": "480599"
  },
  {
    "text": "actual you know stuff you have to to",
    "start": "480599",
    "end": "482080"
  },
  {
    "text": "work out but this is the basic idea we",
    "start": "482080",
    "end": "483919"
  },
  {
    "text": "say Morris means a and code red means B",
    "start": "483919",
    "end": "486039"
  },
  {
    "text": "and and so",
    "start": "486039",
    "end": "487199"
  },
  {
    "text": "forth and now we have a question what's",
    "start": "487199",
    "end": "489639"
  },
  {
    "text": "the username in the simulator and let's",
    "start": "489639",
    "end": "491360"
  },
  {
    "text": "say the simulator calls it emu and then",
    "start": "491360",
    "end": "494039"
  },
  {
    "text": "we run get username and for each piece",
    "start": "494039",
    "end": "496440"
  },
  {
    "text": "of malware or for each bite and get the",
    "start": "496440",
    "end": "498199"
  },
  {
    "text": "username we drop a piece of malware so",
    "start": "498199",
    "end": "500960"
  },
  {
    "text": "we drop e the malware that stands for e",
    "start": "500960",
    "end": "502919"
  },
  {
    "text": "in our table over there then M and then",
    "start": "502919",
    "end": "505919"
  },
  {
    "text": "U and now the AV comes back and it says",
    "start": "505919",
    "end": "508240"
  },
  {
    "text": "well we found you know s B and plaster",
    "start": "508240",
    "end": "510639"
  },
  {
    "text": "and we can correlate that across our",
    "start": "510639",
    "end": "511919"
  },
  {
    "text": "table and see that inside uh our code",
    "start": "511919",
    "end": "515159"
  },
  {
    "text": "saw",
    "start": "515159",
    "end": "516479"
  },
  {
    "text": "emu and now we have a fingerprint inside",
    "start": "516479",
    "end": "519200"
  },
  {
    "text": "this particular AV the username is emu",
    "start": "519200",
    "end": "521680"
  },
  {
    "text": "we've done this very quickly and we've",
    "start": "521680",
    "end": "522800"
  },
  {
    "text": "avoided actually getting into the weeds",
    "start": "522800",
    "end": "524120"
  },
  {
    "text": "and doing the reverse engineering which",
    "start": "524120",
    "end": "525320"
  },
  {
    "text": "is just too hard as I talked",
    "start": "525320",
    "end": "527240"
  },
  {
    "text": "about so we wanted to demonstrate this",
    "start": "527240",
    "end": "529680"
  },
  {
    "text": "technique against four consumer AVS we",
    "start": "529680",
    "end": "531920"
  },
  {
    "text": "chose kasperski AVG the Bit Defender",
    "start": "531920",
    "end": "534440"
  },
  {
    "text": "engine which is licensed out to 20 plus",
    "start": "534440",
    "end": "536080"
  },
  {
    "text": "other AV products as well as a number of",
    "start": "536080",
    "end": "538320"
  },
  {
    "text": "high-end Enterprise protection products",
    "start": "538320",
    "end": "540440"
  },
  {
    "text": "um but this is also in other consumer",
    "start": "540440",
    "end": "542440"
  },
  {
    "text": "AVS most notably FSE secure uh uses",
    "start": "542440",
    "end": "545040"
  },
  {
    "text": "relies on the Bit Defender emulator when",
    "start": "545040",
    "end": "546399"
  },
  {
    "text": "they want to do this runtime Dynamic",
    "start": "546399",
    "end": "548040"
  },
  {
    "text": "analysis and then also VBA uh we found",
    "start": "548040",
    "end": "550360"
  },
  {
    "text": "these by just uploading ecard droppers",
    "start": "550360",
    "end": "551720"
  },
  {
    "text": "to virus",
    "start": "551720",
    "end": "552920"
  },
  {
    "text": "total and we also want to note uh we",
    "start": "552920",
    "end": "555240"
  },
  {
    "text": "only tested four because we were going",
    "start": "555240",
    "end": "557079"
  },
  {
    "text": "for a depth of actual tests and finding",
    "start": "557079",
    "end": "558959"
  },
  {
    "text": "many fingerprints not so much covering a",
    "start": "558959",
    "end": "561000"
  },
  {
    "text": "wide range of AVS this technique is",
    "start": "561000",
    "end": "562560"
  },
  {
    "text": "generically applicable to any AV though",
    "start": "562560",
    "end": "564720"
  },
  {
    "text": "um but just due to some complications",
    "start": "564720",
    "end": "566120"
  },
  {
    "text": "like having to create individual VMS for",
    "start": "566120",
    "end": "568079"
  },
  {
    "text": "each uh AV software is kind of difficult",
    "start": "568079",
    "end": "571399"
  },
  {
    "text": "so with that said I want to jump right",
    "start": "571399",
    "end": "572800"
  },
  {
    "text": "into a demo and and show you guys what",
    "start": "572800",
    "end": "574680"
  },
  {
    "text": "this looks like uh before I talk about",
    "start": "574680",
    "end": "576279"
  },
  {
    "text": "some more of the results cuz it is",
    "start": "576279",
    "end": "577399"
  },
  {
    "text": "really cool um so here I have a demo and",
    "start": "577399",
    "end": "580800"
  },
  {
    "text": "this is in real time I'm going to do",
    "start": "580800",
    "end": "582120"
  },
  {
    "text": "that technique where we compile code",
    "start": "582120",
    "end": "584120"
  },
  {
    "text": "scan it with an AV and then correlate",
    "start": "584120",
    "end": "586160"
  },
  {
    "text": "the results back so here you can see uh",
    "start": "586160",
    "end": "588920"
  },
  {
    "text": "kasperski randomizes the module file",
    "start": "588920",
    "end": "590760"
  },
  {
    "text": "name the name of the program under",
    "start": "590760",
    "end": "591680"
  },
  {
    "text": "analysis itself uh and that's so you",
    "start": "591680",
    "end": "594040"
  },
  {
    "text": "really can't figure that print them in",
    "start": "594040",
    "end": "595680"
  },
  {
    "text": "that way so you know one time it's j",
    "start": "595680",
    "end": "598079"
  },
  {
    "text": "crub and then ttkd and so forth uh so",
    "start": "598079",
    "end": "601519"
  },
  {
    "text": "you can't fingerprint that so that's",
    "start": "601519",
    "end": "602839"
  },
  {
    "text": "actually really good that that avoids",
    "start": "602839",
    "end": "604200"
  },
  {
    "text": "that fingerprinting but then you see",
    "start": "604200",
    "end": "606279"
  },
  {
    "text": "lots of these uh stupid things like VBA",
    "start": "606279",
    "end": "609000"
  },
  {
    "text": "has this hard Cod value 13 4 5 six uh",
    "start": "609000",
    "end": "611560"
  },
  {
    "text": "kaspersky's ticket count after 10 calls",
    "start": "611560",
    "end": "613959"
  },
  {
    "text": "to sleep uh is exactly 10 minutes later",
    "start": "613959",
    "end": "617640"
  },
  {
    "text": "uh in my testing sleep has about a 15",
    "start": "617640",
    "end": "619880"
  },
  {
    "text": "millisecond overhead for the time it",
    "start": "619880",
    "end": "621360"
  },
  {
    "text": "takes for it to call F sleep to sleep X",
    "start": "621360",
    "end": "623120"
  },
  {
    "text": "to trap into ntdll to go to the kernel",
    "start": "623120",
    "end": "625360"
  },
  {
    "text": "be paged out and you know put to sleep",
    "start": "625360",
    "end": "626839"
  },
  {
    "text": "and actually woken up again so that's",
    "start": "626839",
    "end": "628640"
  },
  {
    "text": "some overhead kasperski is just you know",
    "start": "628640",
    "end": "630519"
  },
  {
    "text": "absolutely monotonic just inited by the",
    "start": "630519",
    "end": "632360"
  },
  {
    "text": "number of times you slept here in Bit",
    "start": "632360",
    "end": "634600"
  },
  {
    "text": "Defender after 8 and a half minutes of",
    "start": "634600",
    "end": "636200"
  },
  {
    "text": "sleep they they messed up their",
    "start": "636200",
    "end": "637839"
  },
  {
    "text": "calculations for how long sleep takes",
    "start": "637839",
    "end": "639720"
  },
  {
    "text": "and every 1 millisecond adds 15 15,000",
    "start": "639720",
    "end": "642320"
  },
  {
    "text": "milliseconds to the count so you",
    "start": "642320",
    "end": "643839"
  },
  {
    "text": "actually get a an integer roll over as",
    "start": "643839",
    "end": "645639"
  },
  {
    "text": "you can see right there and by the way",
    "start": "645639",
    "end": "647320"
  },
  {
    "text": "in HEX that's 1 2 3 4 5 6 78 they just",
    "start": "647320",
    "end": "649279"
  },
  {
    "text": "hardcoded that value now some process",
    "start": "649279",
    "end": "651760"
  },
  {
    "text": "introspection artifacts uh in kasperski",
    "start": "651760",
    "end": "655000"
  },
  {
    "text": "we looked at the colonel 32.dll uh by",
    "start": "655000",
    "end": "657519"
  },
  {
    "text": "doing load library and just grabbing the",
    "start": "657519",
    "end": "658800"
  },
  {
    "text": "point there and we started dumping bites",
    "start": "658800",
    "end": "661040"
  },
  {
    "text": "in memory in the kasperski emulator and",
    "start": "661040",
    "end": "663519"
  },
  {
    "text": "here we see it says KL autogenerated",
    "start": "663519",
    "end": "665560"
  },
  {
    "text": "crowner 32.dll so we could just write",
    "start": "665560",
    "end": "668320"
  },
  {
    "text": "malware that looks for KL autogenerated",
    "start": "668320",
    "end": "670000"
  },
  {
    "text": "k2. DL and nowh running in",
    "start": "670000",
    "end": "672399"
  },
  {
    "text": "kasperski now some more subtle artifacts",
    "start": "672399",
    "end": "675079"
  },
  {
    "text": "um here in Bit Defender on a real system",
    "start": "675079",
    "end": "677000"
  },
  {
    "text": "you can see we we accessed through the",
    "start": "677000",
    "end": "678480"
  },
  {
    "text": "PEB the process environment block we",
    "start": "678480",
    "end": "680959"
  },
  {
    "text": "crawled the loaded modules list to look",
    "start": "680959",
    "end": "682800"
  },
  {
    "text": "at all DLS load into our process space",
    "start": "682800",
    "end": "685240"
  },
  {
    "text": "and you can see here ndl kernel Bas and",
    "start": "685240",
    "end": "687160"
  },
  {
    "text": "kernel 2 and right now I'm Bit Defender",
    "start": "687160",
    "end": "689079"
  },
  {
    "text": "stumping the bit differenter ones and as",
    "start": "689079",
    "end": "691320"
  },
  {
    "text": "you'll see it's going bite by bite by",
    "start": "691320",
    "end": "693040"
  },
  {
    "text": "bite",
    "start": "693040",
    "end": "694519"
  },
  {
    "text": "uh that's because in real time we're",
    "start": "694519",
    "end": "696600"
  },
  {
    "text": "doing this process of compiling a piece",
    "start": "696600",
    "end": "698120"
  },
  {
    "text": "of malware running it through our system",
    "start": "698120",
    "end": "700279"
  },
  {
    "text": "and correlating the results back and",
    "start": "700279",
    "end": "701639"
  },
  {
    "text": "this is not a canned video demo this is",
    "start": "701639",
    "end": "703399"
  },
  {
    "text": "actually happening live so every bite",
    "start": "703399",
    "end": "705120"
  },
  {
    "text": "you see that's a new piece of M that we",
    "start": "705120",
    "end": "706880"
  },
  {
    "text": "automatically compiled scanned and ran",
    "start": "706880",
    "end": "709079"
  },
  {
    "text": "through and as I said we we automate",
    "start": "709079",
    "end": "711160"
  },
  {
    "text": "this all with a python and cap API so",
    "start": "711160",
    "end": "713839"
  },
  {
    "text": "even my test script this is just an easy",
    "start": "713839",
    "end": "715440"
  },
  {
    "text": "to use script that just prints out you",
    "start": "715440",
    "end": "717360"
  },
  {
    "text": "know the data and and runs different",
    "start": "717360",
    "end": "718600"
  },
  {
    "text": "code",
    "start": "718600",
    "end": "719560"
  },
  {
    "text": "using our API",
    "start": "719560",
    "end": "721000"
  },
  {
    "text": "automatically um don't really have time",
    "start": "721000",
    "end": "723120"
  },
  {
    "text": "to get into the specifics of how the API",
    "start": "723120",
    "end": "724839"
  },
  {
    "text": "is all implemented given theim time I",
    "start": "724839",
    "end": "726720"
  },
  {
    "text": "have but um as you can see it's it's",
    "start": "726720",
    "end": "729120"
  },
  {
    "text": "super easy to do this so now in Bit",
    "start": "729120",
    "end": "731200"
  },
  {
    "text": "Defender you'll see one artifact is that",
    "start": "731200",
    "end": "733320"
  },
  {
    "text": "uh ndl has an entry point but in the",
    "start": "733320",
    "end": "735079"
  },
  {
    "text": "real system it does not um so that's a",
    "start": "735079",
    "end": "737880"
  },
  {
    "text": "giveaway that you're writing the bit",
    "start": "737880",
    "end": "738880"
  },
  {
    "text": "Fender emulator very subtle though and",
    "start": "738880",
    "end": "741240"
  },
  {
    "text": "here uh also the the module the the file",
    "start": "741240",
    "end": "743440"
  },
  {
    "text": "sizes are much smaller than the real",
    "start": "743440",
    "end": "745320"
  },
  {
    "text": "ntdll but here this third artifact is",
    "start": "745320",
    "end": "747440"
  },
  {
    "text": "really interesting uh there's a module",
    "start": "747440",
    "end": "749320"
  },
  {
    "text": "called you know the null pointer value",
    "start": "749320",
    "end": "751880"
  },
  {
    "text": "it's at Base address CD CD CD that's",
    "start": "751880",
    "end": "754199"
  },
  {
    "text": "actually kernel memory it's above the",
    "start": "754199",
    "end": "755880"
  },
  {
    "text": "kernel user mode split at 7 FFF uh and",
    "start": "755880",
    "end": "759079"
  },
  {
    "text": "then uh the size image is also CD CD CD",
    "start": "759079",
    "end": "761120"
  },
  {
    "text": "so this is some stupid hardcoded thing",
    "start": "761120",
    "end": "763800"
  },
  {
    "text": "and uh you could use this to detect that",
    "start": "763800",
    "end": "765040"
  },
  {
    "text": "you're running a bit defended this is",
    "start": "765040",
    "end": "766000"
  },
  {
    "text": "just something that a programmer",
    "start": "766000",
    "end": "766760"
  },
  {
    "text": "hardcoded in there uh now another very",
    "start": "766760",
    "end": "769440"
  },
  {
    "text": "subtle class of artifacts um Windows uh",
    "start": "769440",
    "end": "772320"
  },
  {
    "text": "Heap allocations when you allocate a",
    "start": "772320",
    "end": "774920"
  },
  {
    "text": "block of size zero with maloc or Heap",
    "start": "774920",
    "end": "776600"
  },
  {
    "text": "alock you actually get a block of size",
    "start": "776600",
    "end": "778160"
  },
  {
    "text": "16 as as you can see demonstrated here",
    "start": "778160",
    "end": "780519"
  },
  {
    "text": "uh each with each allocation it's up by",
    "start": "780519",
    "end": "783000"
  },
  {
    "text": "16 or hex 10 but in VBA there's a",
    "start": "783000",
    "end": "786880"
  },
  {
    "text": "difference of 1,000 bytes for each",
    "start": "786880",
    "end": "789040"
  },
  {
    "text": "allocation and here Bit Defender there's",
    "start": "789040",
    "end": "791240"
  },
  {
    "text": "a difference of only eight bytes you'll",
    "start": "791240",
    "end": "793360"
  },
  {
    "text": "also note in Bit Defender we used Heap",
    "start": "793360",
    "end": "794959"
  },
  {
    "text": "alock dead beef so the handle to the",
    "start": "794959",
    "end": "797360"
  },
  {
    "text": "process Heap that we want to allocate on",
    "start": "797360",
    "end": "799320"
  },
  {
    "text": "is not valid but Bit Defender doesn't",
    "start": "799320",
    "end": "801240"
  },
  {
    "text": "seem to check that and just gives you",
    "start": "801240",
    "end": "803160"
  },
  {
    "text": "memory and a real program this would",
    "start": "803160",
    "end": "804839"
  },
  {
    "text": "crash now some more very subtle",
    "start": "804839",
    "end": "807000"
  },
  {
    "text": "artifacts CPU Behavior uh so we looked",
    "start": "807000",
    "end": "809760"
  },
  {
    "text": "at how many CPU Cycles using rdtsc to",
    "start": "809760",
    "end": "812079"
  },
  {
    "text": "measure those cycles does a KN take in",
    "start": "812079",
    "end": "813760"
  },
  {
    "text": "Bit Defender takes nine but so does a",
    "start": "813760",
    "end": "816160"
  },
  {
    "text": "move and so does a CPU idea a much more",
    "start": "816160",
    "end": "818000"
  },
  {
    "text": "complex instruction and something really",
    "start": "818000",
    "end": "819800"
  },
  {
    "text": "weird really complex how about lock and",
    "start": "819800",
    "end": "821519"
  },
  {
    "text": "then exorts this is like a simit",
    "start": "821519",
    "end": "823199"
  },
  {
    "text": "instruction you know long registers this",
    "start": "823199",
    "end": "825279"
  },
  {
    "text": "would take a long time on a real CPU",
    "start": "825279",
    "end": "827320"
  },
  {
    "text": "still takes nine so they just must have",
    "start": "827320",
    "end": "829399"
  },
  {
    "text": "a CPU you know increment tick count or",
    "start": "829399",
    "end": "831440"
  },
  {
    "text": "increment CPU Cycles function that just",
    "start": "831440",
    "end": "833199"
  },
  {
    "text": "monotonically increases it by nine so if",
    "start": "833199",
    "end": "835519"
  },
  {
    "text": "you saw malware doing this uh checking",
    "start": "835519",
    "end": "837880"
  },
  {
    "text": "is the CPU cycle 999 you know what would",
    "start": "837880",
    "end": "840240"
  },
  {
    "text": "you even think you you wouldn't",
    "start": "840240",
    "end": "841880"
  },
  {
    "text": "necessarily know what it's evading what",
    "start": "841880",
    "end": "843199"
  },
  {
    "text": "it's trying to evade even if you gave",
    "start": "843199",
    "end": "844320"
  },
  {
    "text": "this to Bit Defender probably one",
    "start": "844320",
    "end": "846320"
  },
  {
    "text": "programmer wrote this once just said you",
    "start": "846320",
    "end": "848240"
  },
  {
    "text": "know cycle count plus equals 9 and",
    "start": "848240",
    "end": "850240"
  },
  {
    "text": "forgot about it super subtle super hard",
    "start": "850240",
    "end": "852399"
  },
  {
    "text": "to to detect that this is an evasive",
    "start": "852399",
    "end": "854199"
  },
  {
    "text": "behavior and then running that same",
    "start": "854199",
    "end": "855920"
  },
  {
    "text": "instruction in kasperski vbn AVG they",
    "start": "855920",
    "end": "857959"
  },
  {
    "text": "all die just abort don't find your",
    "start": "857959",
    "end": "859880"
  },
  {
    "text": "malare anything just",
    "start": "859880",
    "end": "861399"
  },
  {
    "text": "crash so now we're going to look at CPU",
    "start": "861399",
    "end": "863519"
  },
  {
    "text": "red pills dumping out the CPU state",
    "start": "863519",
    "end": "865279"
  },
  {
    "text": "after running a knop on a real system",
    "start": "865279",
    "end": "866759"
  },
  {
    "text": "knop is a no op nothing changes is as",
    "start": "866759",
    "end": "869279"
  },
  {
    "text": "you can see that's totally reasonable",
    "start": "869279",
    "end": "871560"
  },
  {
    "text": "and right now in the background we're",
    "start": "871560",
    "end": "873160"
  },
  {
    "text": "dumping all these bites of CPU",
    "start": "873160",
    "end": "875800"
  },
  {
    "text": "serializing the CPU out uh in",
    "start": "875800",
    "end": "878040"
  },
  {
    "text": "kasperski and you'll see here ESI is",
    "start": "878040",
    "end": "882120"
  },
  {
    "text": "just kind of all random and this is a",
    "start": "882120",
    "end": "883839"
  },
  {
    "text": "common thing kasperski always does this",
    "start": "883839",
    "end": "885880"
  },
  {
    "text": "uh and once before you like touch ESI it",
    "start": "885880",
    "end": "887560"
  },
  {
    "text": "just kind of is these random uh values",
    "start": "887560",
    "end": "889720"
  },
  {
    "text": "so literally we save the state off",
    "start": "889720",
    "end": "891440"
  },
  {
    "text": "random KN save the state off again and",
    "start": "891440",
    "end": "893040"
  },
  {
    "text": "you see uh ESI got all weird don't know",
    "start": "893040",
    "end": "896240"
  },
  {
    "text": "why but again you could have Mal looks",
    "start": "896240",
    "end": "897839"
  },
  {
    "text": "for this does I change over the course",
    "start": "897839",
    "end": "899680"
  },
  {
    "text": "of running a",
    "start": "899680",
    "end": "900639"
  },
  {
    "text": "knop now in x86 in the standard call",
    "start": "900639",
    "end": "903240"
  },
  {
    "text": "calling",
    "start": "903240",
    "end": "904639"
  },
  {
    "text": "convention uh the ECX edx by edx",
    "start": "904639",
    "end": "907720"
  },
  {
    "text": "registers are volatile uh meaning they",
    "start": "907720",
    "end": "909920"
  },
  {
    "text": "can be smashed and changed during a",
    "start": "909920",
    "end": "911639"
  },
  {
    "text": "function call so in real system we set",
    "start": "911639",
    "end": "914040"
  },
  {
    "text": "edx and ECX and edx to these values and",
    "start": "914040",
    "end": "916959"
  },
  {
    "text": "we see ebx is preserved as the calling",
    "start": "916959",
    "end": "918680"
  },
  {
    "text": "convention do uh dictates but ECX and",
    "start": "918680",
    "end": "921160"
  },
  {
    "text": "edx are smashed during a call to get",
    "start": "921160",
    "end": "923160"
  },
  {
    "text": "current Hardware",
    "start": "923160",
    "end": "924560"
  },
  {
    "text": "profile in kasperski they remain the",
    "start": "924560",
    "end": "926920"
  },
  {
    "text": "same they're not smashed so we we set",
    "start": "926920",
    "end": "929120"
  },
  {
    "text": "them right before that that invocation",
    "start": "929120",
    "end": "930720"
  },
  {
    "text": "invoke the function and we come back",
    "start": "930720",
    "end": "932600"
  },
  {
    "text": "from the function and they're still the",
    "start": "932600",
    "end": "934199"
  },
  {
    "text": "same value and this holds for any",
    "start": "934199",
    "end": "935560"
  },
  {
    "text": "function we run consp spers key and you",
    "start": "935560",
    "end": "937480"
  },
  {
    "text": "could tell that they're aren actually",
    "start": "937480",
    "end": "938639"
  },
  {
    "text": "really running the function they're",
    "start": "938639",
    "end": "939639"
  },
  {
    "text": "going and emulating that function uh in",
    "start": "939639",
    "end": "941839"
  },
  {
    "text": "their custom code in VBA same deal an",
    "start": "941839",
    "end": "945120"
  },
  {
    "text": "AVG we get this uh 7D 39 thing and then",
    "start": "945120",
    "end": "948839"
  },
  {
    "text": "edx is FFF FF negative 1 it's always",
    "start": "948839",
    "end": "951440"
  },
  {
    "text": "negative 1 in U in AVG now I wanted to",
    "start": "951440",
    "end": "955240"
  },
  {
    "text": "talk about malware evasion because",
    "start": "955240",
    "end": "956759"
  },
  {
    "text": "that's the whole point of this work is",
    "start": "956759",
    "end": "958040"
  },
  {
    "text": "to create a invasive malware that does",
    "start": "958040",
    "end": "959720"
  },
  {
    "text": "not get detected or it's being running",
    "start": "959720",
    "end": "962360"
  },
  {
    "text": "uh so we dropped we're a dropper for the",
    "start": "962360",
    "end": "964120"
  },
  {
    "text": "ecar file it's a test file uh this kind",
    "start": "964120",
    "end": "966880"
  },
  {
    "text": "of a generic like should be detected by",
    "start": "966880",
    "end": "969120"
  },
  {
    "text": "any malware company so this is just an",
    "start": "969120",
    "end": "972079"
  },
  {
    "text": "eard dropper and let's scan this with",
    "start": "972079",
    "end": "974600"
  },
  {
    "text": "you each of these these AVS so right now",
    "start": "974600",
    "end": "978600"
  },
  {
    "text": "it's running so here kasperski uh",
    "start": "978600",
    "end": "981880"
  },
  {
    "text": "detected e car evg detected ecar MGR Bit",
    "start": "981880",
    "end": "986839"
  },
  {
    "text": "Defender which is actually we bit",
    "start": "986839",
    "end": "988560"
  },
  {
    "text": "Defender is licensed out to moft and is",
    "start": "988560",
    "end": "990560"
  },
  {
    "text": "actually very easy and very quick to use",
    "start": "990560",
    "end": "991880"
  },
  {
    "text": "moft so we use moft but this is",
    "start": "991880",
    "end": "993360"
  },
  {
    "text": "underlying the Bit Defender engine e car",
    "start": "993360",
    "end": "995880"
  },
  {
    "text": "and VBA also detects c car now I found",
    "start": "995880",
    "end": "1000120"
  },
  {
    "text": "with my work with AV leak that uh these",
    "start": "1000120",
    "end": "1002360"
  },
  {
    "text": "4 AVS have these hard-coded computer",
    "start": "1002360",
    "end": "1003759"
  },
  {
    "text": "names ntfc thing this thing Alex CZ TZ",
    "start": "1003759",
    "end": "1007560"
  },
  {
    "text": "and Main so now we're just going to",
    "start": "1007560",
    "end": "1009240"
  },
  {
    "text": "check is the computer name one of these",
    "start": "1009240",
    "end": "1010720"
  },
  {
    "text": "names and if it is we're just going to",
    "start": "1010720",
    "end": "1011839"
  },
  {
    "text": "exit right you can see right here but if",
    "start": "1011839",
    "end": "1014199"
  },
  {
    "text": "it's not that name we're going to drop",
    "start": "1014199",
    "end": "1015319"
  },
  {
    "text": "EC car so this should evade all four of",
    "start": "1015319",
    "end": "1017199"
  },
  {
    "text": "these AVS and let's see if it does",
    "start": "1017199",
    "end": "1020480"
  },
  {
    "text": "so kasperski does not detect",
    "start": "1021319",
    "end": "1024480"
  },
  {
    "text": "anything and AVG does not detect",
    "start": "1024480",
    "end": "1026880"
  },
  {
    "text": "anything no",
    "start": "1026880",
    "end": "1027880"
  },
  {
    "text": "infections and Bit Defender does not",
    "start": "1027880",
    "end": "1030120"
  },
  {
    "text": "detect",
    "start": "1030120",
    "end": "1031079"
  },
  {
    "text": "anything and VBA does not detect",
    "start": "1031079",
    "end": "1033720"
  },
  {
    "text": "anything uh so that's super easy uh you",
    "start": "1033720",
    "end": "1036360"
  },
  {
    "text": "know to evade these things again tons",
    "start": "1036360",
    "end": "1038079"
  },
  {
    "text": "more artifacts than I can just present",
    "start": "1038079",
    "end": "1039480"
  },
  {
    "text": "here but just want to show you a demo",
    "start": "1039480",
    "end": "1040600"
  },
  {
    "text": "and then now I'm going to go through",
    "start": "1040600",
    "end": "1041720"
  },
  {
    "text": "some more of the artifacts that I found",
    "start": "1041720",
    "end": "1043438"
  },
  {
    "text": "that I I couldn't show in that's limited",
    "start": "1043439",
    "end": "1044678"
  },
  {
    "text": "time so the environmental artifacts",
    "start": "1044679",
    "end": "1046880"
  },
  {
    "text": "super easy to uh change the also use so",
    "start": "1046880",
    "end": "1050240"
  },
  {
    "text": "as I showed you kasperski has randomized",
    "start": "1050240",
    "end": "1052000"
  },
  {
    "text": "letters for the computer for the process",
    "start": "1052000",
    "end": "1053520"
  },
  {
    "text": "name but these other 3 AVS have these",
    "start": "1053520",
    "end": "1055360"
  },
  {
    "text": "hard-coded values like test app self.",
    "start": "1055360",
    "end": "1057240"
  },
  {
    "text": "exe malware sample uh. exe and as I",
    "start": "1057240",
    "end": "1060679"
  },
  {
    "text": "showed you get computer names also",
    "start": "1060679",
    "end": "1061840"
  },
  {
    "text": "hard-coded in these AVS so these again",
    "start": "1061840",
    "end": "1064559"
  },
  {
    "text": "super simple kind of flashy and fun to",
    "start": "1064559",
    "end": "1066600"
  },
  {
    "text": "look at but but not very Advanced we",
    "start": "1066600",
    "end": "1069200"
  },
  {
    "text": "also uh built code to recursively dump",
    "start": "1069200",
    "end": "1071320"
  },
  {
    "text": "the file system and registry of these",
    "start": "1071320",
    "end": "1072880"
  },
  {
    "text": "AVS and you see these funny things uh",
    "start": "1072880",
    "end": "1075360"
  },
  {
    "text": "like in Bit Defender there's a couple",
    "start": "1075360",
    "end": "1077000"
  },
  {
    "text": "strings on the file system this is is",
    "start": "1077000",
    "end": "1078559"
  },
  {
    "text": "like actually emulating you know going",
    "start": "1078559",
    "end": "1080120"
  },
  {
    "text": "through what what files are on disk",
    "start": "1080120",
    "end": "1081840"
  },
  {
    "text": "you'll see these files that have uh",
    "start": "1081840",
    "end": "1083320"
  },
  {
    "text": "batman. exe and things like that so",
    "start": "1083320",
    "end": "1085840"
  },
  {
    "text": "clearly some kind of joke and you can",
    "start": "1085840",
    "end": "1087520"
  },
  {
    "text": "even find uh there's like TZ de la",
    "start": "1087520",
    "end": "1089960"
  },
  {
    "text": "Batman Batman Spike but there's a common",
    "start": "1089960",
    "end": "1092320"
  },
  {
    "text": "misspelling on people who have Romanian",
    "start": "1092320",
    "end": "1093799"
  },
  {
    "text": "keyboards where the T and Z key are",
    "start": "1093799",
    "end": "1095640"
  },
  {
    "text": "right next to each other so it's very",
    "start": "1095640",
    "end": "1096760"
  },
  {
    "text": "common to misspell and it hit a t and",
    "start": "1096760",
    "end": "1098440"
  },
  {
    "text": "then a z so you can even see that",
    "start": "1098440",
    "end": "1100280"
  },
  {
    "text": "because they're ranian based company and",
    "start": "1100280",
    "end": "1102440"
  },
  {
    "text": "kasperski a bunch of files that are",
    "start": "1102440",
    "end": "1103840"
  },
  {
    "text": "clearly someone smashing their hands on",
    "start": "1103840",
    "end": "1105080"
  },
  {
    "text": "a Cy keyboard like KO iio three adjacent",
    "start": "1105080",
    "end": "1107440"
  },
  {
    "text": "files letters the KL autogenerated thing",
    "start": "1107440",
    "end": "1110679"
  },
  {
    "text": "in uh dlls in",
    "start": "1110679",
    "end": "1112720"
  },
  {
    "text": "kasperski uh far manager installs in",
    "start": "1112720",
    "end": "1114960"
  },
  {
    "text": "kasperski and VBA other AV products this",
    "start": "1114960",
    "end": "1117679"
  },
  {
    "text": "was really funny in kasperski there's",
    "start": "1117679",
    "end": "1119240"
  },
  {
    "text": "installs for over 20 plus other AV",
    "start": "1119240",
    "end": "1121200"
  },
  {
    "text": "products in the program files directory",
    "start": "1121200",
    "end": "1123120"
  },
  {
    "text": "so they have like program files kpers",
    "start": "1123120",
    "end": "1124679"
  },
  {
    "text": "key program files Bit Defender program",
    "start": "1124679",
    "end": "1126080"
  },
  {
    "text": "files FSE secure presumably this is to",
    "start": "1126080",
    "end": "1128200"
  },
  {
    "text": "go malware and may be behaving",
    "start": "1128200",
    "end": "1129640"
  },
  {
    "text": "maliciously uh see if the malware will",
    "start": "1129640",
    "end": "1131960"
  },
  {
    "text": "say Stat one of those directories and",
    "start": "1131960",
    "end": "1133520"
  },
  {
    "text": "see if it exists and then maybe choose",
    "start": "1133520",
    "end": "1135039"
  },
  {
    "text": "to exit or not so that could be a",
    "start": "1135039",
    "end": "1136039"
  },
  {
    "text": "heuristic signal to the AV that this",
    "start": "1136039",
    "end": "1137919"
  },
  {
    "text": "might be evasive malware or malicious",
    "start": "1137919",
    "end": "1139799"
  },
  {
    "text": "mware Network emulation I didn't get to",
    "start": "1139799",
    "end": "1142440"
  },
  {
    "text": "show this in the demo I did present some",
    "start": "1142440",
    "end": "1144159"
  },
  {
    "text": "of this work at shukan showed a a uh",
    "start": "1144159",
    "end": "1146559"
  },
  {
    "text": "Network demo there um so in in these",
    "start": "1146559",
    "end": "1150480"
  },
  {
    "text": "three AVS they're emulating network",
    "start": "1150480",
    "end": "1152200"
  },
  {
    "text": "connectivity so any network request you",
    "start": "1152200",
    "end": "1153799"
  },
  {
    "text": "make automatically succeeds and HTP",
    "start": "1153799",
    "end": "1155880"
  },
  {
    "text": "request is 200 okay even to totally",
    "start": "1155880",
    "end": "1157720"
  },
  {
    "text": "invalid sites you could even give things",
    "start": "1157720",
    "end": "1159600"
  },
  {
    "text": "that's like totally malform not even a",
    "start": "1159600",
    "end": "1161000"
  },
  {
    "text": "real URL it'll still succeed and",
    "start": "1161000",
    "end": "1163559"
  },
  {
    "text": "actually these things all return valid P",
    "start": "1163559",
    "end": "1166000"
  },
  {
    "text": "files to you so pres that's another",
    "start": "1166000",
    "end": "1168520"
  },
  {
    "text": "signal you know does this thing load",
    "start": "1168520",
    "end": "1169960"
  },
  {
    "text": "this into memory does it write it to dis",
    "start": "1169960",
    "end": "1171919"
  },
  {
    "text": "uh that could be another signal that",
    "start": "1171919",
    "end": "1173400"
  },
  {
    "text": "this might be a Mal that downloads a",
    "start": "1173400",
    "end": "1174679"
  },
  {
    "text": "stage to so they're going to you know",
    "start": "1174679",
    "end": "1177240"
  },
  {
    "text": "try to make the Mal act out try to make",
    "start": "1177240",
    "end": "1178679"
  },
  {
    "text": "it show its malicious nature hardcoded",
    "start": "1178679",
    "end": "1181360"
  },
  {
    "text": "start time kind of the intersection of",
    "start": "1181360",
    "end": "1183120"
  },
  {
    "text": "these environmental artifacts and the",
    "start": "1183120",
    "end": "1184480"
  },
  {
    "text": "timing artifacts are hard Cod to start",
    "start": "1184480",
    "end": "1186280"
  },
  {
    "text": "times like this so you just you know",
    "start": "1186280",
    "end": "1188039"
  },
  {
    "text": "quer the time and in AVG you'll see oh",
    "start": "1188039",
    "end": "1190200"
  },
  {
    "text": "it's May 23rd 2011 if you see that you",
    "start": "1190200",
    "end": "1192240"
  },
  {
    "text": "know you're running an AVG and then you",
    "start": "1192240",
    "end": "1194159"
  },
  {
    "text": "see Bit Defender has these apis are",
    "start": "1194159",
    "end": "1196159"
  },
  {
    "text": "broken so it's 0 0 on January 1st but",
    "start": "1196159",
    "end": "1199600"
  },
  {
    "text": "then these other apis break and you get",
    "start": "1199600",
    "end": "1201520"
  },
  {
    "text": "inconsistent times uh VBA 0000 again",
    "start": "1201520",
    "end": "1204840"
  },
  {
    "text": "02000 but it tells you different time",
    "start": "1204840",
    "end": "1206720"
  },
  {
    "text": "with other apis so just totally broken",
    "start": "1206720",
    "end": "1208919"
  },
  {
    "text": "not even consistent across multiple ways",
    "start": "1208919",
    "end": "1210360"
  },
  {
    "text": "of measuring",
    "start": "1210360",
    "end": "1212320"
  },
  {
    "text": "time process introspection I showed some",
    "start": "1212320",
    "end": "1214559"
  },
  {
    "text": "of those artifacts related to looking at",
    "start": "1214559",
    "end": "1216640"
  },
  {
    "text": "uh you know our self in memory looking",
    "start": "1216640",
    "end": "1218000"
  },
  {
    "text": "at our register state after function",
    "start": "1218000",
    "end": "1219320"
  },
  {
    "text": "calls looking at data on the stack uh",
    "start": "1219320",
    "end": "1221919"
  },
  {
    "text": "but another one I didn't get to show",
    "start": "1221919",
    "end": "1223120"
  },
  {
    "text": "here was fake Library code uh so we",
    "start": "1223120",
    "end": "1226159"
  },
  {
    "text": "showed the module you know the file head",
    "start": "1226159",
    "end": "1228440"
  },
  {
    "text": "in memory with the k autogenerated thing",
    "start": "1228440",
    "end": "1230159"
  },
  {
    "text": "in the P file but if we actually follow",
    "start": "1230159",
    "end": "1232200"
  },
  {
    "text": "that a step further and do get proc",
    "start": "1232200",
    "end": "1233400"
  },
  {
    "text": "address and see what bytes are at the",
    "start": "1233400",
    "end": "1235559"
  },
  {
    "text": "actual return pointer we'll find in all",
    "start": "1235559",
    "end": "1238000"
  },
  {
    "text": "four AVS a similar pattern like this uh",
    "start": "1238000",
    "end": "1240720"
  },
  {
    "text": "so this is avgs but basically you have",
    "start": "1240720",
    "end": "1242799"
  },
  {
    "text": "some unique instruction so for AVG it's",
    "start": "1242799",
    "end": "1244480"
  },
  {
    "text": "lock move ebx and then hex FF a one byte",
    "start": "1244480",
    "end": "1247760"
  },
  {
    "text": "number uh designating a library and then",
    "start": "1247760",
    "end": "1250000"
  },
  {
    "text": "a two by number designating the ordinal",
    "start": "1250000",
    "end": "1251600"
  },
  {
    "text": "export number of that function in the",
    "start": "1251600",
    "end": "1253559"
  },
  {
    "text": "library um I can't demo it live here um",
    "start": "1253559",
    "end": "1256640"
  },
  {
    "text": "but I do have I actually integrated cre",
    "start": "1256640",
    "end": "1258320"
  },
  {
    "text": "Capstone with this tool with a leak",
    "start": "1258320",
    "end": "1260440"
  },
  {
    "text": "Capstone disassembly engine I know the",
    "start": "1260440",
    "end": "1262360"
  },
  {
    "text": "creator of that is here at black hat and",
    "start": "1262360",
    "end": "1264200"
  },
  {
    "text": "talked earlier about his new project",
    "start": "1264200",
    "end": "1265200"
  },
  {
    "text": "Keystone we've integrated Capstone so we",
    "start": "1265200",
    "end": "1267240"
  },
  {
    "text": "can live as we dump data disassemble it",
    "start": "1267240",
    "end": "1269919"
  },
  {
    "text": "and see these these patterns uh so this",
    "start": "1269919",
    "end": "1271679"
  },
  {
    "text": "is kind of like a hyper call and",
    "start": "1271679",
    "end": "1272919"
  },
  {
    "text": "hypervisors you know this unique",
    "start": "1272919",
    "end": "1273919"
  },
  {
    "text": "instruction that when executed the AV",
    "start": "1273919",
    "end": "1276240"
  },
  {
    "text": "steps in goes and emulates whatever",
    "start": "1276240",
    "end": "1277520"
  },
  {
    "text": "function you wanted to run so you know",
    "start": "1277520",
    "end": "1279200"
  },
  {
    "text": "if you wanted to run get current",
    "start": "1279200",
    "end": "1280440"
  },
  {
    "text": "Hardware profile it would have you know",
    "start": "1280440",
    "end": "1282640"
  },
  {
    "text": "a one for ENT for kernel 32 and then",
    "start": "1282640",
    "end": "1284960"
  },
  {
    "text": "some other number designating you know",
    "start": "1284960",
    "end": "1286600"
  },
  {
    "text": "the the function export number from that",
    "start": "1286600",
    "end": "1288400"
  },
  {
    "text": "D so you could actually use this and",
    "start": "1288400",
    "end": "1290960"
  },
  {
    "text": "detect that you're writing an emulator",
    "start": "1290960",
    "end": "1292600"
  },
  {
    "text": "now kasperski is unique that they",
    "start": "1292600",
    "end": "1294000"
  },
  {
    "text": "actually if you start looking for these",
    "start": "1294000",
    "end": "1295720"
  },
  {
    "text": "bytes and and enumerating through memory",
    "start": "1295720",
    "end": "1297600"
  },
  {
    "text": "they will hit you with a heris",
    "start": "1297600",
    "end": "1298840"
  },
  {
    "text": "classification it's say it's her script",
    "start": "1298840",
    "end": "1300600"
  },
  {
    "text": "exploit. generic U because real",
    "start": "1300600",
    "end": "1303000"
  },
  {
    "text": "non-malicious programs shouldn't be",
    "start": "1303000",
    "end": "1304320"
  },
  {
    "text": "doing something this is kind of a weird",
    "start": "1304320",
    "end": "1306240"
  },
  {
    "text": "Behavior CP red pills as I showed save",
    "start": "1306240",
    "end": "1308840"
  },
  {
    "text": "the register State dump it and save it",
    "start": "1308840",
    "end": "1310880"
  },
  {
    "text": "again now some conclusions for this",
    "start": "1310880",
    "end": "1314000"
  },
  {
    "text": "work so common themes uh these simple",
    "start": "1314000",
    "end": "1317640"
  },
  {
    "text": "Environmental fingerprints are",
    "start": "1317640",
    "end": "1319400"
  },
  {
    "text": "sufficient to create AAS of malware",
    "start": "1319400",
    "end": "1321200"
  },
  {
    "text": "really easy to create these vasive",
    "start": "1321200",
    "end": "1323240"
  },
  {
    "text": "malware uh these attempts to bait",
    "start": "1323240",
    "end": "1325440"
  },
  {
    "text": "malware with things like giving you a p",
    "start": "1325440",
    "end": "1328000"
  },
  {
    "text": "file when anytime you Mak a request or",
    "start": "1328000",
    "end": "1330400"
  },
  {
    "text": "having uh all these you know files in",
    "start": "1330400",
    "end": "1332400"
  },
  {
    "text": "the file system uh and then there's also",
    "start": "1332400",
    "end": "1334720"
  },
  {
    "text": "a general lack of fistic classification",
    "start": "1334720",
    "end": "1336360"
  },
  {
    "text": "from malware uh when it behaves",
    "start": "1336360",
    "end": "1338440"
  },
  {
    "text": "evasively other than that one thing with",
    "start": "1338440",
    "end": "1340559"
  },
  {
    "text": "kasperski detecting you when you do",
    "start": "1340559",
    "end": "1342320"
  },
  {
    "text": "inmemory dll",
    "start": "1342320",
    "end": "1344120"
  },
  {
    "text": "scanning uh so one thing was fun for me",
    "start": "1344120",
    "end": "1346640"
  },
  {
    "text": "to do was to take these unique strands",
    "start": "1346640",
    "end": "1348279"
  },
  {
    "text": "like KL autogenerated or that uh one of",
    "start": "1348279",
    "end": "1350760"
  },
  {
    "text": "the the ghost file that cannot be found",
    "start": "1350760",
    "end": "1353120"
  },
  {
    "text": "uh in Bit Defender and Google them and",
    "start": "1353120",
    "end": "1354919"
  },
  {
    "text": "you actually find lots of these malware",
    "start": "1354919",
    "end": "1356840"
  },
  {
    "text": "reports from places like malware virus",
    "start": "1356840",
    "end": "1358760"
  },
  {
    "text": "total um total hash where they just got",
    "start": "1358760",
    "end": "1361120"
  },
  {
    "text": "a binary they ran strings on it and they",
    "start": "1361120",
    "end": "1362640"
  },
  {
    "text": "uploaded those results uh so you can",
    "start": "1362640",
    "end": "1365159"
  },
  {
    "text": "just see the output from strings that",
    "start": "1365159",
    "end": "1366880"
  },
  {
    "text": "malare in the wild is looking for these",
    "start": "1366880",
    "end": "1369200"
  },
  {
    "text": "unique values so it can be evasive uh so",
    "start": "1369200",
    "end": "1371279"
  },
  {
    "text": "malare author's already know about these",
    "start": "1371279",
    "end": "1372559"
  },
  {
    "text": "and are us excuse me are using them in",
    "start": "1372559",
    "end": "1374080"
  },
  {
    "text": "the",
    "start": "1374080",
    "end": "1375159"
  },
  {
    "text": "wild now more interesting than just",
    "start": "1375159",
    "end": "1377159"
  },
  {
    "text": "random Mal find in Google was this uh",
    "start": "1377159",
    "end": "1379840"
  },
  {
    "text": "piece of M the evil bunny from the",
    "start": "1379840",
    "end": "1381240"
  },
  {
    "text": "so-called Animal Farm AP uh this was",
    "start": "1381240",
    "end": "1383799"
  },
  {
    "text": "discovered by Marian marshel I think",
    "start": "1383799",
    "end": "1385600"
  },
  {
    "text": "2014 or 2015 she might be here she's",
    "start": "1385600",
    "end": "1388000"
  },
  {
    "text": "here at the conference at least um and",
    "start": "1388000",
    "end": "1390520"
  },
  {
    "text": "in 2011 uh it was a vading bit Defender",
    "start": "1390520",
    "end": "1392799"
  },
  {
    "text": "it would check is its name test app and",
    "start": "1392799",
    "end": "1394559"
  },
  {
    "text": "if it was it would not run this is",
    "start": "1394559",
    "end": "1396559"
  },
  {
    "text": "highly Advanced AP level malware we also",
    "start": "1396559",
    "end": "1399159"
  },
  {
    "text": "see below test app the afy J mv. exe",
    "start": "1399159",
    "end": "1403120"
  },
  {
    "text": "that kind of looks like those kasperski",
    "start": "1403120",
    "end": "1405120"
  },
  {
    "text": "um names that I jumped earlier presume",
    "start": "1405120",
    "end": "1407919"
  },
  {
    "text": "ass that might be Somey from maybe an",
    "start": "1407919",
    "end": "1409720"
  },
  {
    "text": "earlier build that didn't randomize",
    "start": "1409720",
    "end": "1410880"
  },
  {
    "text": "names per run or they just say dumped",
    "start": "1410880",
    "end": "1413159"
  },
  {
    "text": "out the data in one run and saved it off",
    "start": "1413159",
    "end": "1416159"
  },
  {
    "text": "one one method of doing this I didn't",
    "start": "1416159",
    "end": "1417520"
  },
  {
    "text": "touch on was simply taking a cordum from",
    "start": "1417520",
    "end": "1419919"
  },
  {
    "text": "a running AV process once it's unpacked",
    "start": "1419919",
    "end": "1421559"
  },
  {
    "text": "all these minaries take a cord up you",
    "start": "1421559",
    "end": "1422760"
  },
  {
    "text": "run strings on it and you'll find things",
    "start": "1422760",
    "end": "1424520"
  },
  {
    "text": "like the username or stuff like that but",
    "start": "1424520",
    "end": "1426640"
  },
  {
    "text": "you're not going to find these more",
    "start": "1426640",
    "end": "1427400"
  },
  {
    "text": "subtle artifacts the red pills like the",
    "start": "1427400",
    "end": "1428919"
  },
  {
    "text": "timing SKS so they might have done that",
    "start": "1428919",
    "end": "1430919"
  },
  {
    "text": "I don't",
    "start": "1430919",
    "end": "1432240"
  },
  {
    "text": "know so we also talked about evasion",
    "start": "1432240",
    "end": "1434880"
  },
  {
    "text": "it's super easy to create the evasive",
    "start": "1434880",
    "end": "1436559"
  },
  {
    "text": "malware and in testing when I when I did",
    "start": "1436559",
    "end": "1438559"
  },
  {
    "text": "this about created about 30 different",
    "start": "1438559",
    "end": "1439760"
  },
  {
    "text": "pieces of face of malware with all",
    "start": "1439760",
    "end": "1440919"
  },
  {
    "text": "different unique artifacts 100% evasion",
    "start": "1440919",
    "end": "1443279"
  },
  {
    "text": "rate in my",
    "start": "1443279",
    "end": "1444760"
  },
  {
    "text": "testing and now in terms of future work",
    "start": "1444760",
    "end": "1447279"
  },
  {
    "text": "uh obviously test more emulators test",
    "start": "1447279",
    "end": "1449080"
  },
  {
    "text": "more",
    "start": "1449080",
    "end": "1449840"
  },
  {
    "text": "AVS um we'd also like to use AV leak to",
    "start": "1449840",
    "end": "1452960"
  },
  {
    "text": "find break at exploits this was actually",
    "start": "1452960",
    "end": "1455320"
  },
  {
    "text": "the original motivation of this work",
    "start": "1455320",
    "end": "1456520"
  },
  {
    "text": "when we began it at RPI uh Jeremy",
    "start": "1456520",
    "end": "1458320"
  },
  {
    "text": "Blackthorne who was uh doing this work",
    "start": "1458320",
    "end": "1460720"
  },
  {
    "text": "he called it AV Escape he said uh can we",
    "start": "1460720",
    "end": "1463480"
  },
  {
    "text": "find ways of breaking out of emulators",
    "start": "1463480",
    "end": "1465080"
  },
  {
    "text": "can we use the fact that we're being",
    "start": "1465080",
    "end": "1466440"
  },
  {
    "text": "scanned trying to protect the system as",
    "start": "1466440",
    "end": "1468200"
  },
  {
    "text": "a way of infecting the system uh so in",
    "start": "1468200",
    "end": "1471640"
  },
  {
    "text": "building and exploring this area of",
    "start": "1471640",
    "end": "1473559"
  },
  {
    "text": "research and reversing these things we",
    "start": "1473559",
    "end": "1475279"
  },
  {
    "text": "realized it was actually really",
    "start": "1475279",
    "end": "1476240"
  },
  {
    "text": "interesting to just try to evade them",
    "start": "1476240",
    "end": "1477880"
  },
  {
    "text": "and just try to fingerprint them before",
    "start": "1477880",
    "end": "1479399"
  },
  {
    "text": "we actually get to the know jump the gun",
    "start": "1479399",
    "end": "1481039"
  },
  {
    "text": "and start actually breaking them but",
    "start": "1481039",
    "end": "1483200"
  },
  {
    "text": "this was when we started this work two",
    "start": "1483200",
    "end": "1484480"
  },
  {
    "text": "or three years ago uh as an",
    "start": "1484480",
    "end": "1485919"
  },
  {
    "text": "undergraduate research project this is",
    "start": "1485919",
    "end": "1487240"
  },
  {
    "text": "what we wanted to do and it kind of",
    "start": "1487240",
    "end": "1488120"
  },
  {
    "text": "morphed into the evasion thing but it",
    "start": "1488120",
    "end": "1490440"
  },
  {
    "text": "would be really cool to come back to",
    "start": "1490440",
    "end": "1491679"
  },
  {
    "text": "that and Tavis orand D and Jukes and",
    "start": "1491679",
    "end": "1494360"
  },
  {
    "text": "coret have been demonstrating the",
    "start": "1494360",
    "end": "1495840"
  },
  {
    "text": "viability of this kind of thing so in",
    "start": "1495840",
    "end": "1497960"
  },
  {
    "text": "conclusion we've pushed the stateof of-",
    "start": "1497960",
    "end": "1499000"
  },
  {
    "text": "thee art emulator fingerprinting given a",
    "start": "1499000",
    "end": "1501039"
  },
  {
    "text": "a categorization of these fingerprints",
    "start": "1501039",
    "end": "1502440"
  },
  {
    "text": "as they apply to Consumer AVS versus",
    "start": "1502440",
    "end": "1504559"
  },
  {
    "text": "high-end emulators like Kimu and VMware",
    "start": "1504559",
    "end": "1506840"
  },
  {
    "text": "demonstrated real world malware that's",
    "start": "1506840",
    "end": "1508240"
  },
  {
    "text": "using them and how we can use them",
    "start": "1508240",
    "end": "1509480"
  },
  {
    "text": "ourselves and then discussed our",
    "start": "1509480",
    "end": "1511039"
  },
  {
    "text": "directions in future research I want to",
    "start": "1511039",
    "end": "1513640"
  },
  {
    "text": "thank the RPI research team this would",
    "start": "1513640",
    "end": "1515200"
  },
  {
    "text": "not have been possible without them",
    "start": "1515200",
    "end": "1516600"
  },
  {
    "text": "couple of these guys in the audience uh",
    "start": "1516600",
    "end": "1518120"
  },
  {
    "text": "Patrick you here no thanks Patrick um",
    "start": "1518120",
    "end": "1521640"
  },
  {
    "text": "and uh everyone who helped with this",
    "start": "1521640",
    "end": "1523120"
  },
  {
    "text": "work and then for some people who gave",
    "start": "1523120",
    "end": "1524720"
  },
  {
    "text": "me help and inspiration just you know",
    "start": "1524720",
    "end": "1526240"
  },
  {
    "text": "little things here and there and and",
    "start": "1526240",
    "end": "1527880"
  },
  {
    "text": "little tips and tricks so thank you to",
    "start": "1527880",
    "end": "1529600"
  },
  {
    "text": "everyone for",
    "start": "1529600",
    "end": "1530799"
  },
  {
    "text": "that uh any questions again also check",
    "start": "1530799",
    "end": "1533679"
  },
  {
    "text": "out our paper at woot if you this",
    "start": "1533679",
    "end": "1535080"
  },
  {
    "text": "interest you much more thorough and I",
    "start": "1535080",
    "end": "1537039"
  },
  {
    "text": "have a lot more information in the on",
    "start": "1537039",
    "end": "1538960"
  },
  {
    "text": "offline briefing do have a Twitter",
    "start": "1538960",
    "end": "1540679"
  },
  {
    "text": "handle uh kasperski Labs packing the K",
    "start": "1540679",
    "end": "1543000"
  },
  {
    "text": "great music video If you ever seen it",
    "start": "1543000",
    "end": "1544679"
  },
  {
    "text": "and while I take questions I wanted to",
    "start": "1544679",
    "end": "1546159"
  },
  {
    "text": "do something else which was",
    "start": "1546159",
    "end": "1548960"
  },
  {
    "text": "um uh I wanted to dump out the kasperski",
    "start": "1548960",
    "end": "1551760"
  },
  {
    "text": "file system in the background while I",
    "start": "1551760",
    "end": "1553240"
  },
  {
    "text": "talk so this is actually going to",
    "start": "1553240",
    "end": "1554399"
  },
  {
    "text": "enumerate through the entire kasperski",
    "start": "1554399",
    "end": "1555799"
  },
  {
    "text": "file system and just dump it while I",
    "start": "1555799",
    "end": "1556919"
  },
  {
    "text": "take questions thank you very",
    "start": "1556919",
    "end": "1560600"
  },
  {
    "text": "much so any",
    "start": "1566960",
    "end": "1570440"
  },
  {
    "text": "questions no uh is anyone okay well",
    "start": "1570760",
    "end": "1574520"
  },
  {
    "text": "thank you very much I'll be here for a",
    "start": "1574520",
    "end": "1575679"
  },
  {
    "text": "while oh Mike Mike has a",
    "start": "1575679",
    "end": "1578480"
  },
  {
    "text": "question uh question over",
    "start": "1578480",
    "end": "1583200"
  },
  {
    "text": "here hello um so when you're when you're",
    "start": "1583200",
    "end": "1588559"
  },
  {
    "text": "dumping out information bite by bite",
    "start": "1588559",
    "end": "1591080"
  },
  {
    "text": "every time you're recompiling a new",
    "start": "1591080",
    "end": "1593320"
  },
  {
    "text": "piece of malware running it and",
    "start": "1593320",
    "end": "1595080"
  },
  {
    "text": "rescanning um when you're dumping out",
    "start": "1595080",
    "end": "1597679"
  },
  {
    "text": "information such as pointers did you run",
    "start": "1597679",
    "end": "1599520"
  },
  {
    "text": "into any issues ensuring the exact same",
    "start": "1599520",
    "end": "1601679"
  },
  {
    "text": "execution state so that is a concern I",
    "start": "1601679",
    "end": "1604240"
  },
  {
    "text": "did not run any problems with that",
    "start": "1604240",
    "end": "1606080"
  },
  {
    "text": "kasperski in particular does randomize",
    "start": "1606080",
    "end": "1607559"
  },
  {
    "text": "data per run but kasperski has a very",
    "start": "1607559",
    "end": "1609559"
  },
  {
    "text": "high output where they able to detect 31",
    "start": "1609559",
    "end": "1611240"
  },
  {
    "text": "pieces of hour per run so we can extract",
    "start": "1611240",
    "end": "1613880"
  },
  {
    "text": "large amount of data at a time but we",
    "start": "1613880",
    "end": "1615720"
  },
  {
    "text": "also obviously could Brute Force out we",
    "start": "1615720",
    "end": "1617279"
  },
  {
    "text": "could check the first bite and then say",
    "start": "1617279",
    "end": "1618679"
  },
  {
    "text": "We'll dump the second bite if the first",
    "start": "1618679",
    "end": "1619799"
  },
  {
    "text": "bite is the same and the second bite if",
    "start": "1619799",
    "end": "1620960"
  },
  {
    "text": "the third you know second bite is the",
    "start": "1620960",
    "end": "1621960"
  },
  {
    "text": "same and so forth but I did not workun",
    "start": "1621960",
    "end": "1623679"
  },
  {
    "text": "into that problem I was worried I would",
    "start": "1623679",
    "end": "1625880"
  },
  {
    "text": "okay um when you were dumping out",
    "start": "1625880",
    "end": "1627480"
  },
  {
    "text": "multiple bites at once did you have any",
    "start": "1627480",
    "end": "1629760"
  },
  {
    "text": "like how did you ensure The Ordering of",
    "start": "1629760",
    "end": "1631799"
  },
  {
    "text": "the results correlating to uh being I",
    "start": "1631799",
    "end": "1634919"
  },
  {
    "text": "found that the AVS detected the malware",
    "start": "1634919",
    "end": "1636720"
  },
  {
    "text": "in the order was dropped but there was a",
    "start": "1636720",
    "end": "1638320"
  },
  {
    "text": "lot of engineering and making sure they",
    "start": "1638320",
    "end": "1639840"
  },
  {
    "text": "detect dropped malware every time and",
    "start": "1639840",
    "end": "1641279"
  },
  {
    "text": "making sure was reliable a lot of back",
    "start": "1641279",
    "end": "1643480"
  },
  {
    "text": "back uh back end engineering on that",
    "start": "1643480",
    "end": "1645480"
  },
  {
    "text": "right cool thanks thanks",
    "start": "1645480",
    "end": "1648200"
  },
  {
    "text": "um could you start again from the",
    "start": "1648200",
    "end": "1650440"
  },
  {
    "text": "beginning because I don't understand",
    "start": "1650440",
    "end": "1653360"
  },
  {
    "text": "anything",
    "start": "1653360",
    "end": "1656360"
  },
  {
    "text": "um uh",
    "start": "1658200",
    "end": "1661240"
  },
  {
    "text": "so uh basically our Innovation was that",
    "start": "1661240",
    "end": "1664399"
  },
  {
    "text": "we use dropped malware names to",
    "start": "1664399",
    "end": "1666679"
  },
  {
    "text": "represent individual bite values",
    "start": "1666679",
    "end": "1669760"
  },
  {
    "text": "um uh and then we dump drop malware in",
    "start": "1669760",
    "end": "1672200"
  },
  {
    "text": "order to extract fingerprints from these",
    "start": "1672200",
    "end": "1673399"
  },
  {
    "text": "ulators to create evasive",
    "start": "1673399",
    "end": "1676159"
  },
  {
    "text": "malware thank you",
    "start": "1676159",
    "end": "1679519"
  }
]