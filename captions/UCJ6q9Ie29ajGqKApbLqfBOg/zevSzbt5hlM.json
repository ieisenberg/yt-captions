[
  {
    "text": "e",
    "start": "0",
    "end": "3000"
  },
  {
    "text": "to Pew and I'm here speaking with Jeff na on uh we're going to do talk",
    "start": "36360",
    "end": "42399"
  },
  {
    "text": "on hello um okay sorry about that um quick",
    "start": "54600",
    "end": "60879"
  },
  {
    "text": "question is there anyone here who has not been in an ARP talk yet because I may just kind of blow",
    "start": "60879",
    "end": "67119"
  },
  {
    "text": "through some of the beginning stuff since it's probably been talked to death already anybody at",
    "start": "67119",
    "end": "73119"
  },
  {
    "text": "all okay go kind of fast",
    "start": "73119",
    "end": "78439"
  },
  {
    "text": "then uh basically what we're going to talk about is uh a little bit about Layer Two uh we're going to go over ARP",
    "start": "79320",
    "end": "86240"
  },
  {
    "text": "and uh to a lesser degree R ARP we're going to talk about uh different art behaviors by OS uh we're going to also",
    "start": "86240",
    "end": "93680"
  },
  {
    "text": "detail a new router attack and we may or may not go over the art poisoning thing",
    "start": "93680",
    "end": "98799"
  },
  {
    "text": "because I think that's probably been done to death already um basically Layer Two is um",
    "start": "98799",
    "end": "105560"
  },
  {
    "text": "part of the OSI model it's uh the part we're talking about is the data link part um basically all communic all",
    "start": "105560",
    "end": "112240"
  },
  {
    "text": "network communications roughly follow some or all of the OSI model um the key",
    "start": "112240",
    "end": "118000"
  },
  {
    "text": "thing to get out of this slide is that the purpose of the layers lower layers provide services to Upper",
    "start": "118000",
    "end": "125840"
  },
  {
    "text": "layers um layer 2 is responsible for addressing transmission Framing and air control and it provides uh transport",
    "start": "126439",
    "end": "134239"
  },
  {
    "text": "services and translation services for upper layer protocols like",
    "start": "134239",
    "end": "139400"
  },
  {
    "text": "IP um in an ethernet IP environment is uh where you'll primarily find the art",
    "start": "139400",
    "end": "145519"
  },
  {
    "text": "protocol um although it can does work with token ring fitty um ultranet I",
    "start": "145519",
    "end": "150840"
  },
  {
    "text": "think is another one too um basically what it does is um it stands for address",
    "start": "150840",
    "end": "156400"
  },
  {
    "text": "resolution protocol in case you didn't know that and",
    "start": "156400",
    "end": "163440"
  },
  {
    "text": "is hello feel like a rockar now okay um basically what it what it does",
    "start": "171519",
    "end": "179040"
  },
  {
    "text": "is uh it provides translation services translating uh Mac addresses to IP",
    "start": "179040",
    "end": "184280"
  },
  {
    "text": "addresses and the reverse is done uh using rarp um there's two types of",
    "start": "184280",
    "end": "189560"
  },
  {
    "text": "packets uh replies and requests which you probably know uh requests typically",
    "start": "189560",
    "end": "194680"
  },
  {
    "text": "are sent to the broadcast um some other things to kind of note about ARP is um a",
    "start": "194680",
    "end": "200959"
  },
  {
    "text": "concept of gratuitous ARP where uh when a machine typically on boot um it will",
    "start": "200959",
    "end": "206840"
  },
  {
    "text": "send out an art packet saying who has my IP if no one answers then it knows that",
    "start": "206840",
    "end": "212840"
  },
  {
    "text": "there are no IP conflicts um in the network um also important is the uh idea",
    "start": "212840",
    "end": "218599"
  },
  {
    "text": "of ARP cache um basically what an ARP cach does is it uh takes the information",
    "start": "218599",
    "end": "224120"
  },
  {
    "text": "that ARP gives it and uh stores it so it can be referred to later this uh helps cut down on network traffic and uh",
    "start": "224120",
    "end": "232799"
  },
  {
    "text": "congestion and Jeff's going to talk about the art packet format hello there",
    "start": "233280",
    "end": "241040"
  },
  {
    "text": "how's this work okay bear with me I'm not very good at this pointer thing here we're pointing over here at the uh first",
    "start": "241040",
    "end": "247959"
  },
  {
    "text": "two by field in an ARP packet it's a word aligned field that's the hard type ARP can be used across a number of both",
    "start": "247959",
    "end": "256160"
  },
  {
    "text": "link layer and network layer implementations so uh this 2 byte field exists to basically say what's the uh",
    "start": "256160",
    "end": "263960"
  },
  {
    "text": "what's the uh excuse me Hardware type uh generally for ethernet that's one the",
    "start": "263960",
    "end": "271759"
  },
  {
    "text": "next field here the uh other two by word align field here the prot size is the",
    "start": "271759",
    "end": "278199"
  },
  {
    "text": "uh oh you know what we've got a duplicate that's supposed to be oh no prototype okay okay the Prototype field",
    "start": "278199",
    "end": "284680"
  },
  {
    "text": "designates the uh the hardware protocol type and it's duplicated from uh from",
    "start": "284680",
    "end": "292000"
  },
  {
    "text": "IP in art packets it's uh 0x 0800 which",
    "start": "292000",
    "end": "297440"
  },
  {
    "text": "is the same in in an Ethernet frame the 2 by Ether type field the next one",
    "start": "297440",
    "end": "304120"
  },
  {
    "text": "by field here the uh hard size is the number of bytes in the hardware uh",
    "start": "304120",
    "end": "309720"
  },
  {
    "text": "address the next one by field also a one B field number of bytes in the protocol",
    "start": "309720",
    "end": "315240"
  },
  {
    "text": "address in our case we're talking about ethernet and IP so for the hard size",
    "start": "315240",
    "end": "320840"
  },
  {
    "text": "that's uh six bytes and for the prot size it's 4 bytes the op code is sort of the magic here this is what",
    "start": "320840",
    "end": "327199"
  },
  {
    "text": "differentiates between AR request AR replies raar R requests raw up replies",
    "start": "327199",
    "end": "333120"
  },
  {
    "text": "and so on and so forth for uh for AR requests it's one and for upper Plies",
    "start": "333120",
    "end": "338840"
  },
  {
    "text": "it's two and you know three and four for rup and whatnot we're not going to really get too much into that so these",
    "start": "338840",
    "end": "344600"
  },
  {
    "text": "next four fields are you know fairly self-explanatory for the purposes of our talk ethernet and IP the uh Center",
    "start": "344600",
    "end": "351160"
  },
  {
    "text": "Hardware address is a six byte field for your Mac address the center IP for a bite field and the same for the hardware",
    "start": "351160",
    "end": "357440"
  },
  {
    "text": "uh address and the IP address so there's a couple interesting things here this getss tacked on to a 14 byte ethernet",
    "start": "357440",
    "end": "363880"
  },
  {
    "text": "header if I'm repeating stuff you know forgive me um and some of this information is repeated uh the uh for",
    "start": "363880",
    "end": "371639"
  },
  {
    "text": "example the um I'm pointing it the right thing here no I'm not the uh Hardware",
    "start": "371639",
    "end": "377080"
  },
  {
    "text": "addresses the hardware addresses both appear in your ethernet frame as well we'll get into that a little while in a",
    "start": "377080",
    "end": "382240"
  },
  {
    "text": "little while but it's important to note that it specifically in an Ethernet implementation you've got some duplication of information",
    "start": "382240",
    "end": "390758"
  },
  {
    "text": "I guess yeah so what are some problems with ARP",
    "start": "391599",
    "end": "396880"
  },
  {
    "text": "um these probably are repeats also but I'm going to run through them quickly anyway um no authentication method means",
    "start": "396880",
    "end": "403840"
  },
  {
    "text": "I have no way of knowing if the uh reply or request that I receive is actually from um a legitimate uh machine or",
    "start": "403840",
    "end": "412000"
  },
  {
    "text": "not um this kind of ties into the next issue is that both replies and requests",
    "start": "412000",
    "end": "417199"
  },
  {
    "text": "are used to update ARP caches on machine so if I make a an AR reply the machine",
    "start": "417199",
    "end": "424319"
  },
  {
    "text": "will cach the information I use in the reply in its own cache um I think this",
    "start": "424319",
    "end": "431240"
  },
  {
    "text": "was originally done to kind of uh help uh as far as Network congestion wise the",
    "start": "431240",
    "end": "436280"
  },
  {
    "text": "the thought being well if you make a reply or request either one you want",
    "start": "436280",
    "end": "441919"
  },
  {
    "text": "information and you're giving me the correct information to begin with so I'll go ahead and take that so I don't have to ask you later on down the road",
    "start": "441919",
    "end": "449360"
  },
  {
    "text": "um another issue um replies which do not correspond to requests are allowed most",
    "start": "449360",
    "end": "455160"
  },
  {
    "text": "of the time by most operating systems um the one thing about ARP is it's very uh OS dependent on how it behaves so um",
    "start": "455160",
    "end": "462759"
  },
  {
    "text": "none of these are actually true probably for every single system um even though",
    "start": "462759",
    "end": "467960"
  },
  {
    "text": "the RFC says that this is how it should function um another issue is new",
    "start": "467960",
    "end": "473599"
  },
  {
    "text": "information always supersedes old uh and there's no way to um what in my opinion",
    "start": "473599",
    "end": "480280"
  },
  {
    "text": "would be nice is if sort of like uh like you do in the router world where you have sort of a hold down timer or something when a major change occurs uh",
    "start": "480280",
    "end": "487479"
  },
  {
    "text": "this doesn't do that this says I may have had this information updated you know many times",
    "start": "487479",
    "end": "493319"
  },
  {
    "text": "over days months whatever but I got a new piece so I've got to update now um another issue is it's not clear",
    "start": "493319",
    "end": "500840"
  },
  {
    "text": "according to the RFC um which fields in the uh ethernet packet are used to supply Mac and IP information to the",
    "start": "500840",
    "end": "507520"
  },
  {
    "text": "cache um this can run into some you can run into some issues with this and uh we're going to talk about that a little",
    "start": "507520",
    "end": "513320"
  },
  {
    "text": "bit a little bit later on um another one of the issues is static entries are not always static uh doesn't make a lot of",
    "start": "513320",
    "end": "520518"
  },
  {
    "text": "sense to me why they would not be but um I've run into a lot of instances where they are",
    "start": "520519",
    "end": "526720"
  },
  {
    "text": "not and Jeff's going to talk about the art Behavior Uh by operating system so Kevin said that uh hosts",
    "start": "527560",
    "end": "535360"
  },
  {
    "text": "Implement AR differently it would assume that you would one would assume that because ARP is supposed to be Hardware",
    "start": "535360",
    "end": "541760"
  },
  {
    "text": "type and protocol type independent that the valid information would be in the AR packet itself for the you know Hardware",
    "start": "541760",
    "end": "548839"
  },
  {
    "text": "address and uh and whatnot specifically the hardware addresses but in as we see",
    "start": "548839",
    "end": "554000"
  },
  {
    "text": "from these slides right here that's not necessarily true it looks like Solaris and previous D you know 42 and 35 they",
    "start": "554000",
    "end": "561079"
  },
  {
    "text": "take their information from the ethernet header and that's kind of broken because ethernet is just one implementation of",
    "start": "561079",
    "end": "567640"
  },
  {
    "text": "ARP so we're going to get into that in a minute it but basically what you got here is fairly simple table and why is",
    "start": "567640",
    "end": "573440"
  },
  {
    "text": "this relevant well let's think about this to attack systems using ARP it's",
    "start": "573440",
    "end": "581240"
  },
  {
    "text": "sort of important to know how they behave with ARP uh the RFC says when we get an art packet we look at we look at",
    "start": "581240",
    "end": "588920"
  },
  {
    "text": "whether or not something's in our cash we look at the information whether it be from the ethernet header or the art packet itself and whether or not we have",
    "start": "588920",
    "end": "595160"
  },
  {
    "text": "an entry we might cash it if we don't have an entry for it or if we already do we simply update but once you can",
    "start": "595160",
    "end": "601360"
  },
  {
    "text": "understand how a host actually uses art packet information you can sort of decide well what kind of evil things can I do to a host some hosts will filter on",
    "start": "601360",
    "end": "609480"
  },
  {
    "text": "different types of art packets um you send a host an art packet and you have valid information in the ethernet header",
    "start": "609480",
    "end": "616200"
  },
  {
    "text": "but you know malicious information in the art packet well if you figure out that it filters on that art packet",
    "start": "616200",
    "end": "621600"
  },
  {
    "text": "information um and it generates some sort of little message when you try to uh you know do some sort of evil art",
    "start": "621600",
    "end": "628040"
  },
  {
    "text": "thing but the but the event that is actually generated uh only pays attention to the ethernet header or I",
    "start": "628040",
    "end": "634760"
  },
  {
    "text": "may have messed those up but if your two implementations don't match you can uh simply bypass filters so in trying to",
    "start": "634760",
    "end": "641279"
  },
  {
    "text": "figure out uh how different hosts behave we tried to figure out how these hosts",
    "start": "641279",
    "end": "647079"
  },
  {
    "text": "parse art packets so that we could Target certain attacks at them I guess this let's see take a look",
    "start": "647079",
    "end": "653320"
  },
  {
    "text": "at the next slide here all right this is what I was hoping",
    "start": "653320",
    "end": "658880"
  },
  {
    "text": "how do we do this we uh we use Nemesis made a couple modifications to Nemesis",
    "start": "658880",
    "end": "664560"
  },
  {
    "text": "um so that we could uh well first figure out how different hosts behave but sort of this first one this this first one up",
    "start": "664560",
    "end": "671639"
  },
  {
    "text": "here you know added Solaris style ARP option what does that mean well when you send an art packet over ethernet you've",
    "start": "671639",
    "end": "677639"
  },
  {
    "text": "got um you got a packet that basically has you know your ethernet header at the beginning and then a two byte ether",
    "start": "677639",
    "end": "682880"
  },
  {
    "text": "frame that says I'm an art packet and then this 28 by field after that well",
    "start": "682880",
    "end": "687920"
  },
  {
    "text": "why does this even matter um you ask for an IP address by sending a broadcast and you say you know who has",
    "start": "687920",
    "end": "694240"
  },
  {
    "text": "this IP address well Solaris decided to duplicate the information in the ethernet header I don't know why but",
    "start": "694240",
    "end": "700880"
  },
  {
    "text": "it's supposed to be zeroed out so it's kind of a really lame way of fingerprinting but Nemesis can do it now",
    "start": "700880",
    "end": "706200"
  },
  {
    "text": "it's a little Dash ass switch I guess the proper thing to do would be to allow people to put either",
    "start": "706200",
    "end": "712800"
  },
  {
    "text": "their choice of the ethernet header and the uh excuse me the uh destination address",
    "start": "712800",
    "end": "719000"
  },
  {
    "text": "from the the ethernet header or the AR packet independent doesn't do that right now but the other important bit of",
    "start": "719000",
    "end": "724079"
  },
  {
    "text": "information here we can modify all the relevant uh ARP Fields you see it's not",
    "start": "724079",
    "end": "729880"
  },
  {
    "text": "exactly clear that these are completely independent of the ethernet frame they are but that only really matters because",
    "start": "729880",
    "end": "735839"
  },
  {
    "text": "you can use it on a lot of different link types so what this means is that we allowed uh you can change the source and",
    "start": "735839",
    "end": "741480"
  },
  {
    "text": "destination in the r packet as well as the you know ethernet frame and that's how you facilitate those tests to figure",
    "start": "741480",
    "end": "748519"
  },
  {
    "text": "out you know what what a host cares about or what a device cares about what it filters on and whatnot and uh it's",
    "start": "748519",
    "end": "755680"
  },
  {
    "text": "this Independence you know that people uh generally fail to realize that um",
    "start": "755680",
    "end": "761680"
  },
  {
    "text": "they can really bite them in the end if you don't understand what your host favors well you won't know how someone's going to attack you and at the bottom",
    "start": "761680",
    "end": "768880"
  },
  {
    "text": "here you'll see uh this ar- that's really you know how you show your ARP cach on a Unix system D and numeric",
    "start": "768880",
    "end": "774399"
  },
  {
    "text": "don't try to look up everything with DNS and you know AR Das a on Microsoft they don't have any notion of that tell them",
    "start": "774399",
    "end": "780800"
  },
  {
    "text": "what the Rev is and that it's up now oh uh 132 is up right now but um it's kind of it's actually broken for the stuff",
    "start": "780800",
    "end": "787680"
  },
  {
    "text": "that we're doing but it'll be fixed very soon so so pretty soon you'll be able to",
    "start": "787680",
    "end": "793880"
  },
  {
    "text": "have the same kind of fun I guess so what who cares right um well",
    "start": "793880",
    "end": "800360"
  },
  {
    "text": "you you've probably all seen and heard um many times about our cash poisoning and uh you know sniffing and all that",
    "start": "800360",
    "end": "807360"
  },
  {
    "text": "good stuff um so I'm not going to really go into that too much at the moment um what's maybe a",
    "start": "807360",
    "end": "813959"
  },
  {
    "text": "little bit more interesting is what we noticed when you send some packets to um some Cisco devices um specifically um",
    "start": "813959",
    "end": "823440"
  },
  {
    "text": "what we call the sonic boom and if if you know me you know why it's the sonic boom but um essentially what that is is",
    "start": "823440",
    "end": "831920"
  },
  {
    "text": "the ability to smash the stack and essentially create a denial of service condition in Cisco routers uh run it on",
    "start": "831920",
    "end": "839839"
  },
  {
    "text": "11 code and 12 we've got 121 something running on this one uh I've tried it I",
    "start": "839839",
    "end": "845399"
  },
  {
    "text": "haven't tried it obviously on every single Cisco device running iOS but uh the ones I have tried it all works and",
    "start": "845399",
    "end": "852240"
  },
  {
    "text": "uh we're going to give you a way to so you can look and and probably make a good guess as to whether it will work on your Cisco devices or",
    "start": "852240",
    "end": "858639"
  },
  {
    "text": "not cised and oh and um you know another thing to keep in mind too that we are",
    "start": "858639",
    "end": "864160"
  },
  {
    "text": "just talking about Cisco today but I'm pretty sure that there are other networking devices out there that use a",
    "start": "864160",
    "end": "869800"
  },
  {
    "text": "Cisco stack and this would probably work against them too",
    "start": "869800",
    "end": "876600"
  },
  {
    "text": "so so basically what we do is this we send it an ARP",
    "start": "876839",
    "end": "882680"
  },
  {
    "text": "request and we say I have your IP at my Mac and it says okay and that's it no",
    "start": "882680",
    "end": "892639"
  },
  {
    "text": "more AR it does not update its cach it does not respond to Arps um the arp cach on a Cisco is about",
    "start": "892639",
    "end": "900600"
  },
  {
    "text": "4 hours so what you'll see is that over time gradually host will just drop off",
    "start": "900600",
    "end": "906360"
  },
  {
    "text": "the network as it loses their information in cash assuming that they know where the router is in their own",
    "start": "906360",
    "end": "912320"
  },
  {
    "text": "cash um for a lot of operating systems this will happen in a matter of minutes uh I",
    "start": "912320",
    "end": "918920"
  },
  {
    "text": "think on wi 2K the ARB cach timeout is something like two minutes so uh what",
    "start": "918920",
    "end": "923959"
  },
  {
    "text": "what you're going to see is just gradually things will fall off the network and uh we're going to show you",
    "start": "923959",
    "end": "929600"
  },
  {
    "text": "give you a show right now how it works go plug",
    "start": "929600",
    "end": "936440"
  },
  {
    "text": "in Far right yes",
    "start": "940319",
    "end": "948160"
  },
  {
    "text": "okay I'm going to sit down here um there we go um basically what what",
    "start": "962519",
    "end": "970199"
  },
  {
    "text": "I'm going to do to start with here is um just a show ARP uh I'm in enabled",
    "start": "970199",
    "end": "975240"
  },
  {
    "text": "mode um you don't have to be to show art but I'm an enable mode anyway and um so here's what you see you",
    "start": "975240",
    "end": "983639"
  },
  {
    "text": "see that um the first century 10",
    "start": "983639",
    "end": "991240"
  },
  {
    "text": "1001001 is a router interface 10180 254 is a router interface um you'll notice",
    "start": "992959",
    "end": "1000240"
  },
  {
    "text": "something kind of interesting the age they do not age out these are permanent",
    "start": "1000240",
    "end": "1005800"
  },
  {
    "text": "entries and it's kind of interesting because um if you look at the ARP cache of most devices you will not see its own",
    "start": "1005800",
    "end": "1012639"
  },
  {
    "text": "interfaces in there um it's partly because of this that we are able to",
    "start": "1012639",
    "end": "1017759"
  },
  {
    "text": "overwrite this information it in my opinion that the Cisco any device should not refer to its ARP cache",
    "start": "1017759",
    "end": "1024600"
  },
  {
    "text": "to find out what its own IP is I think that's generally a bad idea and uh so we're going to show you",
    "start": "1024600",
    "end": "1033280"
  },
  {
    "text": "why real quick here we're going to we're going to do exactly what Kevin said send a little bit information to our router",
    "start": "1034839",
    "end": "1040160"
  },
  {
    "text": "here and see uh give you guys an idea of how happy it is after that okay I I just",
    "start": "1040160",
    "end": "1045360"
  },
  {
    "text": "ping the router to show that it does indeed work at the moment",
    "start": "1045360",
    "end": "1050840"
  },
  {
    "text": "um let's do that in a minute go",
    "start": "1051880",
    "end": "1054919"
  },
  {
    "text": "ahead so what you see is um it generates a duplicate IP address message it",
    "start": "1058720",
    "end": "1064280"
  },
  {
    "text": "doesn't always do that that's one thing to keep in mind um which is kind of",
    "start": "1064280",
    "end": "1069640"
  },
  {
    "text": "strange I I haven't been able to figure out exactly why sometimes it does not um",
    "start": "1069640",
    "end": "1075000"
  },
  {
    "text": "but this quite likely is your only notification that something bad is happening um you know and you might say well this",
    "start": "1075000",
    "end": "1081640"
  },
  {
    "text": "is going to go off to the CIS log server so I will have some kind of knowledge but if I can overwrite the uh ARP entry",
    "start": "1081640",
    "end": "1088600"
  },
  {
    "text": "for the CIS log server first it's not going to go there so now we do a show",
    "start": "1088600",
    "end": "1095559"
  },
  {
    "text": "AR and we see that its new address is fu fu foo foo",
    "start": "1095559",
    "end": "1102880"
  },
  {
    "text": "foo and uh I'm going to go ahead and clean out my ARP cache",
    "start": "1102880",
    "end": "1109720"
  },
  {
    "text": "the old one probably hadn't timed out yet and now when I ping nothing happens and that's it so now what you",
    "start": "1109720",
    "end": "1118320"
  },
  {
    "text": "have is um you've overwritten its ARP cach entry and it stays like that",
    "start": "1118320",
    "end": "1124960"
  },
  {
    "text": "permanently even though the ARP cach timeout is 4 hours these these persist",
    "start": "1124960",
    "end": "1130039"
  },
  {
    "text": "and do not time out so um you can see why this might be a little bit of a",
    "start": "1130039",
    "end": "1136840"
  },
  {
    "text": "problem um any questions",
    "start": "1136840",
    "end": "1144679"
  },
  {
    "text": "maybe well this is only the uh sure oh sorry about that we've got it",
    "start": "1145120",
    "end": "1151679"
  },
  {
    "text": "all scripted up to make it easy but let me show you what's going on here um yeah he he used uh",
    "start": "1151679",
    "end": "1156840"
  },
  {
    "text": "Nemesis uh basically I sent an AR reply of the source of the router to the destination of the router out my network",
    "start": "1156840",
    "end": "1163679"
  },
  {
    "text": "card and the uh The Source Hardware address in the ethernet frame is fu fu Foo fu",
    "start": "1163679",
    "end": "1169400"
  },
  {
    "text": "and the destination Hardware address is the Destin is the MAC address of the router's own interface and uh to do the",
    "start": "1169400",
    "end": "1176559"
  },
  {
    "text": "Dos you have to use replies um we've tried every permutation on the planet but as Kevin said even upstairs testing",
    "start": "1176559",
    "end": "1183440"
  },
  {
    "text": "this we have many situations where it doesn't report doesn't do anything just silently accepts it",
    "start": "1183440",
    "end": "1191039"
  },
  {
    "text": "sure that's what we're going to get to you you have remediated the",
    "start": "1191960",
    "end": "1197320"
  },
  {
    "text": "problem go ahead yes it does yes it does so it uh it's",
    "start": "1197320",
    "end": "1205880"
  },
  {
    "text": "it's not so bad that you have to reboot but I don't know many uh Engineers or",
    "start": "1205880",
    "end": "1211720"
  },
  {
    "text": "administrators who know the Mac addresses of their interfaces on their cisos to begin with so um you might have",
    "start": "1211720",
    "end": "1217400"
  },
  {
    "text": "a hard time figuring that out until the denial of service actually happens",
    "start": "1217400",
    "end": "1223720"
  },
  {
    "text": "yes we have a patch no no because the the remediate ation doesn't require a",
    "start": "1224280",
    "end": "1230520"
  },
  {
    "text": "patch and it's it's been my experience that if you can configure a fix it's",
    "start": "1230520",
    "end": "1236080"
  },
  {
    "text": "better than loading new code at least in a Cisco It generally is and the uh",
    "start": "1236080",
    "end": "1241480"
  },
  {
    "text": "configuration requires no downtime where uh code reload",
    "start": "1241480",
    "end": "1246799"
  },
  {
    "text": "would yeah yep anymore okay so uh what I'm going to do",
    "start": "1247080",
    "end": "1256480"
  },
  {
    "text": "I'm going to clear the AR cache it's clear ARP and we're going to show it again you",
    "start": "1256480",
    "end": "1263520"
  },
  {
    "text": "see now that it's gone it's back to the uh",
    "start": "1263520",
    "end": "1268600"
  },
  {
    "text": "0030 and um it's all happy again now I should be able to Bing it okay so we fixed it so",
    "start": "1268760",
    "end": "1279480"
  },
  {
    "text": "um as uh the gentleman over there mentioned um if you put a static ARP entry in for its interface um it will",
    "start": "1279480",
    "end": "1287600"
  },
  {
    "text": "work it will not allow it to be overwritten um in in my estimation that's probably a good thing to do and I",
    "start": "1287600",
    "end": "1296279"
  },
  {
    "text": "I know there's a guy next door giving a 25 security tips for routers talk there maybe should be",
    "start": "1296279",
    "end": "1302559"
  },
  {
    "text": "26 I think um another interesting thing that this allows you to do is um some really",
    "start": "1302559",
    "end": "1311000"
  },
  {
    "text": "cool sniffing stuff because now that now I can be guaranteed that I am the G",
    "start": "1311000",
    "end": "1319080"
  },
  {
    "text": "I can be guaranteed that the Gateway will not respond for 4 hours to ARP so",
    "start": "1319080",
    "end": "1325760"
  },
  {
    "text": "what I can do is I can now easily sniff both traffic in both directions I don't",
    "start": "1325760",
    "end": "1332159"
  },
  {
    "text": "have to use a flood of Arps anymore um which is very noisy on a network you tend to see it quickly unless you're on",
    "start": "1332159",
    "end": "1338480"
  },
  {
    "text": "a flat Network and you got bigger problems than that probably um so it",
    "start": "1338480",
    "end": "1344799"
  },
  {
    "text": "allows me to sniff in both directions and basically what I can do is I I can have my machine uh act like a proxy ARP",
    "start": "1344799",
    "end": "1352159"
  },
  {
    "text": "and actually only respond when requested so it looks like regular Network",
    "start": "1352159",
    "end": "1357960"
  },
  {
    "text": "Behavior you don't notice any difference the same amount of Arps are generated as W as normal traffic would generate the",
    "start": "1357960",
    "end": "1364760"
  },
  {
    "text": "only difference is the Mac addresses are different and we are going to show that",
    "start": "1364760",
    "end": "1370559"
  },
  {
    "text": "now oh AR you so",
    "start": "1370559",
    "end": "1377440"
  },
  {
    "text": "I'm just make sure okay so I'm back to normal here get",
    "start": "1377440",
    "end": "1385120"
  },
  {
    "text": "rid of my cash",
    "start": "1385120",
    "end": "1391960"
  },
  {
    "text": "okay okay go ahead and run it I'm going to run the script here and then I'll",
    "start": "1393679",
    "end": "1399360"
  },
  {
    "text": "walk you guys through what's going on",
    "start": "1399360",
    "end": "1403760"
  },
  {
    "text": "let's go over here fire up snort real",
    "start": "1415240",
    "end": "1419039"
  },
  {
    "text": "quick why don't you uh go ahead and Hing this box over here Kevin okay",
    "start": "1429720",
    "end": "1435120"
  },
  {
    "text": "it's actually let's just do this wa tell that to it St 20 H",
    "start": "1435120",
    "end": "1444240"
  },
  {
    "text": "yeah okay there we go I'm through um",
    "start": "1444400",
    "end": "1449640"
  },
  {
    "text": "he's running open BSD so obviously he's not responding um and essentially what",
    "start": "1449640",
    "end": "1454799"
  },
  {
    "text": "what what we've done is we've uh now now we sniff all all traffic in both",
    "start": "1454799",
    "end": "1461960"
  },
  {
    "text": "directions sorry about that why don't you do that again just uh okay now",
    "start": "1462080",
    "end": "1467200"
  },
  {
    "text": "there's nothing real magical about here obviously I fired up snorts a promiscuous mode sniffer right okay let's take snort out of promiscuous",
    "start": "1467200",
    "end": "1475240"
  },
  {
    "text": "mode that over again oh lo and behold we see all the",
    "start": "1482399",
    "end": "1487799"
  },
  {
    "text": "traffic we are not in promiscuous mode and this is you know no flooding of",
    "start": "1487799",
    "end": "1494320"
  },
  {
    "text": "your switches nothing so the only the only real indication that you're going to have um",
    "start": "1494320",
    "end": "1501000"
  },
  {
    "text": "that this is going on is if you know what the MAC address should be for your",
    "start": "1501000",
    "end": "1507559"
  },
  {
    "text": "gateway um and most people do not so okay we've uh any questions about",
    "start": "1507559",
    "end": "1517480"
  },
  {
    "text": "that stuff no cool okay I'm going to show you real",
    "start": "1517480",
    "end": "1524120"
  },
  {
    "text": "quick the how to actually add a static ARP entry um because I think that'd be a nice",
    "start": "1524120",
    "end": "1530399"
  },
  {
    "text": "thing to",
    "start": "1530399",
    "end": "1532720"
  },
  {
    "text": "do yeah this presentation goes to 11 by the",
    "start": "1540880",
    "end": "1545760"
  },
  {
    "text": "way so basically what this command says says is add an ARP entry with the IP address of 10",
    "start": "1555960",
    "end": "1562720"
  },
  {
    "text": "1001001 the MAC address of what the interface is",
    "start": "1562720",
    "end": "1569200"
  },
  {
    "text": "of the type arpa arpa is the uh standard type for ethernet uh there are a few other types if you want to see what they",
    "start": "1569200",
    "end": "1575320"
  },
  {
    "text": "are there you go okay I have added it",
    "start": "1575320",
    "end": "1583960"
  },
  {
    "text": "and you can see it show up right there and now go ahead and try to run against",
    "start": "1592799",
    "end": "1598279"
  },
  {
    "text": "it I'm going to use the simple dos again oh one one other thing to to",
    "start": "1598279",
    "end": "1605520"
  },
  {
    "text": "notice is that when you add a static one it's no longer associated with an",
    "start": "1605520",
    "end": "1611000"
  },
  {
    "text": "interface which is a a good test if you're actually just doing doing some show Arps look for that interface look",
    "start": "1611000",
    "end": "1617600"
  },
  {
    "text": "at that interface column and if you don't see anything you'll know it's static um it might be nicer if there was like a switch or something that actually",
    "start": "1617600",
    "end": "1623559"
  },
  {
    "text": "told you in this field but that's it's kind of a good enough hint I",
    "start": "1623559",
    "end": "1628720"
  },
  {
    "text": "guess so here we go we're going to Doss the R's interface again or try to okay you'll notice this time no",
    "start": "1628720",
    "end": "1635720"
  },
  {
    "text": "duplicate IP and it persisted it's still there so",
    "start": "1635720",
    "end": "1642960"
  },
  {
    "text": "um it's a pretty easy fix we get right down to it but um",
    "start": "1642960",
    "end": "1648360"
  },
  {
    "text": "uh an important one I think nonetheless that only fixes uh the router by the way that doesn't always that doesn't",
    "start": "1648360",
    "end": "1654320"
  },
  {
    "text": "necessarily solve the problem of all your end hosts and I know that the last talk talked about uh which hosts static",
    "start": "1654320",
    "end": "1660559"
  },
  {
    "text": "uh ARP entries remain static and which they don't and so we're going to get to that one a little bit too okay so I'm",
    "start": "1660559",
    "end": "1666600"
  },
  {
    "text": "going to jump back into the slide presentation here oh and that's what we call the Sonic Boom by the",
    "start": "1666600",
    "end": "1673880"
  },
  {
    "text": "way um so what what can you do to uh fix some of these problems besides a static",
    "start": "1673880",
    "end": "1681600"
  },
  {
    "text": "entry um one is to create static tables in general um not a good idea um it's not",
    "start": "1681600",
    "end": "1690720"
  },
  {
    "text": "very scalable um doesn't mean that they're static anyway depending on the operating system they might not",
    "start": "1690720",
    "end": "1697519"
  },
  {
    "text": "be and um it it it's just not not a very easy thing to do um if you're in a large",
    "start": "1697519",
    "end": "1704159"
  },
  {
    "text": "Enterprise environment um so that's one way it's not a not a great",
    "start": "1704159",
    "end": "1711039"
  },
  {
    "text": "one but if you have to you have to and in C some instances it may make sense in",
    "start": "1711039",
    "end": "1716799"
  },
  {
    "text": "special cases uh to actually have static entries but probably not in your entire",
    "start": "1716799",
    "end": "1722679"
  },
  {
    "text": "network what else can you do um I I like to um segment things once",
    "start": "1722679",
    "end": "1730399"
  },
  {
    "text": "you segment things ARP goes away as a problem because it operates at Layer Two and Layer Two only operates between two",
    "start": "1730399",
    "end": "1738440"
  },
  {
    "text": "physically or logically if you're in the Wireless World connected devices so once I throw a router in the",
    "start": "1738440",
    "end": "1745200"
  },
  {
    "text": "way um your ARP dies at the router so um",
    "start": "1745200",
    "end": "1750519"
  },
  {
    "text": "what I often suggest to people is that uh they move servers and devices that are logged into to a different segment",
    "start": "1750519",
    "end": "1757279"
  },
  {
    "text": "than regular users are on um I mean it it would be great to hope that every box",
    "start": "1757279",
    "end": "1762840"
  },
  {
    "text": "on your network is locked down you know airtight but they may not be they have users on them you may not be able to",
    "start": "1762840",
    "end": "1769880"
  },
  {
    "text": "control how locked down they are um however the server should never have users um on it to where it could you",
    "start": "1769880",
    "end": "1777159"
  },
  {
    "text": "know trojen itself or or that kind of thing um main issue with this is cost",
    "start": "1777159",
    "end": "1783640"
  },
  {
    "text": "routers are expensive um there in many environments this would require a significant",
    "start": "1783640",
    "end": "1788919"
  },
  {
    "text": "renumbering effort um so and it adds complexity um now you have to really",
    "start": "1788919",
    "end": "1796120"
  },
  {
    "text": "understand how routing works you can't just have one big um static route you know default 0.0.0 and everything works",
    "start": "1796120",
    "end": "1803279"
  },
  {
    "text": "you you have to really really get into protocols and understand how they work so",
    "start": "1803279",
    "end": "1808360"
  },
  {
    "text": "um it it's it's a viable solution but it may not be the best one um the third way",
    "start": "1808360",
    "end": "1815360"
  },
  {
    "text": "is really not preventing the attacks but knowing that they go on uh I think in",
    "start": "1815360",
    "end": "1820799"
  },
  {
    "text": "the AR world that's probably about the best you're going to be able to do um so what what are we trying to find",
    "start": "1820799",
    "end": "1828519"
  },
  {
    "text": "when uh when we do this we're we're looking at um packet anomalies uh like",
    "start": "1828519",
    "end": "1833559"
  },
  {
    "text": "Jeff talked about earlier when the uh ethernet and ARP Fields do not match",
    "start": "1833559",
    "end": "1839279"
  },
  {
    "text": "they should they should always match um the the problem is you know uh the",
    "start": "1839279",
    "end": "1845799"
  },
  {
    "text": "program that's actually detecting whether or not a duplicate IP exists maybe it's getting its information from",
    "start": "1845799",
    "end": "1851720"
  },
  {
    "text": "ethernet and not AR so um if you excuse me if those fields do not match um",
    "start": "1851720",
    "end": "1858279"
  },
  {
    "text": "that's a good indication that something bad is happening um what else can we look for",
    "start": "1858279",
    "end": "1864320"
  },
  {
    "text": "um we can look for reply and request matches um generally in the problem that",
    "start": "1864320",
    "end": "1872600"
  },
  {
    "text": "this attempts to solve is the updating of the cach with a request because uh uh",
    "start": "1872600",
    "end": "1879880"
  },
  {
    "text": "actually I'm sorry the updating with a reply that does not have a request um you shouldn't see this on",
    "start": "1879880",
    "end": "1886200"
  },
  {
    "text": "your network if you do it's a good indication that bad things are happening um another Third Way which is a little",
    "start": "1886200",
    "end": "1893240"
  },
  {
    "text": "bit more difficult um is sort of like a statistical analysis of what Max are",
    "start": "1893240",
    "end": "1900240"
  },
  {
    "text": "arping on your network how much and uh to whom so uh that and and of course we're",
    "start": "1900240",
    "end": "1909279"
  },
  {
    "text": "open to other ideas um I want Jeff also to talk about the changes that have been incorporated into snort um to allow",
    "start": "1909279",
    "end": "1916519"
  },
  {
    "text": "these detections to take place um we don't want to just talk about stuff we want it to",
    "start": "1916519",
    "end": "1922120"
  },
  {
    "text": "work so a couple days ago snort 18 came out and some of this is actually in there there's a new plugin that allows",
    "start": "1922120",
    "end": "1928840"
  },
  {
    "text": "you to do a couple things um first when we were doing this research we found that well a lot of hosts do some really",
    "start": "1928840",
    "end": "1935399"
  },
  {
    "text": "weird stuff like Linux boxes as soon as you have a entry in your ARP cach it periodically sends an ARP request to the",
    "start": "1935399",
    "end": "1943600"
  },
  {
    "text": "host's hardware address that it already has in its own cache it already knows its Hardware address but it persists and keeps asking you know who's at this IP",
    "start": "1943600",
    "end": "1951320"
  },
  {
    "text": "but it already sent that person's Hardware address a request so it already knows anyway it's really odd it's a directed art request and that's actually",
    "start": "1951320",
    "end": "1958000"
  },
  {
    "text": "what we did for some of these attacks but so there's an option that you can turn on in this pre-processor",
    "start": "1958000",
    "end": "1963799"
  },
  {
    "text": "that says I watch for directed art requests are they malicious possibly but that's the opportunity to false positive",
    "start": "1963799",
    "end": "1970159"
  },
  {
    "text": "but so there's some other ones here the mismatch between the ARP frame and excuse me the ARP packet and the",
    "start": "1970159",
    "end": "1975200"
  },
  {
    "text": "ethernet frame itself on an ARP request if you have different information from the sender and uh the sender in the ARP",
    "start": "1975200",
    "end": "1982919"
  },
  {
    "text": "frame on a request it flags that as a mismatch and on a reply it Flags both",
    "start": "1982919",
    "end": "1988000"
  },
  {
    "text": "the sender and the destination okay so there we have a few of these but the real big one is you can",
    "start": "1988000",
    "end": "1994519"
  },
  {
    "text": "supply a list of IP addresses and Mac addresses in your configuration file and",
    "start": "1994519",
    "end": "2000120"
  },
  {
    "text": "when it sees a request or a reply come in it looks at the sender IP address and it matches it up to this list of entries",
    "start": "2000120",
    "end": "2006880"
  },
  {
    "text": "you gave it and if it's one that it has an entry for it's going to take a look",
    "start": "2006880",
    "end": "2011919"
  },
  {
    "text": "at the MAC address of the art packet it saw uh either in the ethernet frame or",
    "start": "2011919",
    "end": "2017880"
  },
  {
    "text": "the ARP frame as soon as the patch is out and uh and if it has different",
    "start": "2017880",
    "end": "2023480"
  },
  {
    "text": "information in the packet it just saw from what it's in its table it's going to alert on that too because that's pretty bad you know if you just told",
    "start": "2023480",
    "end": "2029679"
  },
  {
    "text": "your IDs you know this is the MAC address for this IP and you see something else well that's pretty bad so",
    "start": "2029679",
    "end": "2035760"
  },
  {
    "text": "that's already out there and uh I'll be some patches to that too so so hopefully um all the",
    "start": "2035760",
    "end": "2043240"
  },
  {
    "text": "interesting ARP things that you learned today will not be of any value to",
    "start": "2043240",
    "end": "2049480"
  },
  {
    "text": "you moral of story protect the data at other layers or even a little more novel",
    "start": "2050480",
    "end": "2057320"
  },
  {
    "text": "I think let the data protect itself um questions comments complaints",
    "start": "2057320",
    "end": "2067560"
  },
  {
    "text": "no right on",
    "start": "2068079",
    "end": "2072240"
  },
  {
    "text": "thanks",
    "start": "2075639",
    "end": "2078638"
  },
  {
    "text": "oh",
    "start": "2096640",
    "end": "2099640"
  },
  {
    "text": "e",
    "start": "2126640",
    "end": "2129640"
  },
  {
    "text": "e",
    "start": "2156640",
    "end": "2159640"
  },
  {
    "text": "e",
    "start": "2186560",
    "end": "2189560"
  },
  {
    "text": "e",
    "start": "2216520",
    "end": "2219520"
  },
  {
    "text": "e",
    "start": "2246520",
    "end": "2249520"
  },
  {
    "text": "e",
    "start": "2276440",
    "end": "2279440"
  },
  {
    "text": "e",
    "start": "2306440",
    "end": "2309440"
  },
  {
    "text": "e",
    "start": "2336440",
    "end": "2339440"
  },
  {
    "text": "e",
    "start": "2366359",
    "end": "2369359"
  },
  {
    "text": "e",
    "start": "2396319",
    "end": "2399319"
  },
  {
    "text": "e",
    "start": "2426319",
    "end": "2429319"
  },
  {
    "text": "e",
    "start": "2456240",
    "end": "2459240"
  },
  {
    "text": "e",
    "start": "2486240",
    "end": "2489240"
  },
  {
    "text": "e e",
    "start": "2516240",
    "end": "2520160"
  }
]