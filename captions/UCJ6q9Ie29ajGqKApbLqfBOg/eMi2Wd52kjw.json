[
  {
    "text": "[Music]",
    "start": "1130",
    "end": "14080"
  },
  {
    "text": "hi everyone my name is ben ceri i'm the vp of research at armist talking with me today is barack haddad",
    "start": "14080",
    "end": "21119"
  },
  {
    "text": "black is a security researcher and a team leader on my team both of us work at a company called",
    "start": "21119",
    "end": "26640"
  },
  {
    "text": "armis armrest is an agentless iot security company focused on securing securing iot devices and advanced",
    "start": "26640",
    "end": "33600"
  },
  {
    "text": "devices and actually anything embedded in enterprise industrial and medical",
    "start": "33600",
    "end": "39120"
  },
  {
    "text": "organizations in the last year we've focused our efforts on analyzing critical",
    "start": "39120",
    "end": "44239"
  },
  {
    "text": "infrastructure systems used by large healthcare facilities we became familiar with the system that",
    "start": "44239",
    "end": "49760"
  },
  {
    "text": "is not known to most but is nevertheless a critical building block in the daily operation of all hospitals pneumatic",
    "start": "49760",
    "end": "56239"
  },
  {
    "text": "tube systems this research resulted in discovery of non-critical availabilities in swiss log",
    "start": "56239",
    "end": "61600"
  },
  {
    "text": "pneumatic tube systems this is the most permanent vendor of pneumatic cube systems in north america and today we're",
    "start": "61600",
    "end": "68080"
  },
  {
    "text": "going to talk about what we found and what is pneumatic tube systems so requiring this research paul piper i",
    "start": "68080",
    "end": "74640"
  },
  {
    "text": "hope you can appreciate the obvious reference but before we get into the research uh let's back up a bit",
    "start": "74640",
    "end": "81520"
  },
  {
    "text": "pneumatic tube systems some of you might be puzzled this was once a thing and is surprisingly still a",
    "start": "81520",
    "end": "87600"
  },
  {
    "text": "thing today simply put these systems are pressurized tube networks that transfer physical",
    "start": "87600",
    "end": "93759"
  },
  {
    "text": "carriers through them the concept was first invented more than 200 years ago and is probably the first",
    "start": "93759",
    "end": "100159"
  },
  {
    "text": "prototype of packet switching networks in the early days it was mainly used to transfer letters partials and even cash",
    "start": "100159",
    "end": "106320"
  },
  {
    "text": "in some applications the new york mail system made use of pneumatic tubes as shown here in this",
    "start": "106320",
    "end": "112079"
  },
  {
    "text": "1987 drawing in 1867 they even believed pneumatic",
    "start": "112079",
    "end": "118479"
  },
  {
    "text": "tubes would become the future of public transportation and built an experimental 95 meter tubes",
    "start": "118479",
    "end": "124560"
  },
  {
    "text": "subway line under broadway in manhattan something really that looks far-fetched",
    "start": "124560",
    "end": "132000"
  },
  {
    "text": "moving people with air pressure is still something that certain people believe is in the future today",
    "start": "132239",
    "end": "140080"
  },
  {
    "text": "so eventually pneumatic tubes evolved to certain niche cases for example before the internet",
    "start": "141200",
    "end": "147280"
  },
  {
    "text": "they used the fast used them as fast inter-office messaging solutions",
    "start": "147280",
    "end": "153680"
  },
  {
    "text": "nasa even had one mission control center back in the apollo missions you can see one",
    "start": "153680",
    "end": "158879"
  },
  {
    "text": "of the containers there in their control center and there are also few applications",
    "start": "158879",
    "end": "165040"
  },
  {
    "text": "today in which pneumatic tubes are developed and used to be the future for example in certain",
    "start": "165040",
    "end": "170800"
  },
  {
    "text": "ways disposal disposal systems maybe in the future these will become more",
    "start": "170800",
    "end": "175840"
  },
  {
    "text": "popular however probably the most widespread use of pneumatic tubes nowadays is in",
    "start": "175840",
    "end": "182400"
  },
  {
    "text": "hospitals and actually in hospitals these systems are critical infrastructure",
    "start": "182400",
    "end": "187519"
  },
  {
    "text": "hospitals use them on a daily basis maybe on an hourly basis every time there is",
    "start": "187519",
    "end": "194400"
  },
  {
    "text": "blood to collect there are samples to collect they the user system to transfer samples specimens",
    "start": "194400",
    "end": "200239"
  },
  {
    "text": "from various departments in the hospitals to central laboratories and even",
    "start": "200239",
    "end": "205440"
  },
  {
    "text": "to take medicine from the pharmacy and it's really distributed to all departments",
    "start": "205440",
    "end": "210640"
  },
  {
    "text": "so this system has to have uptime of nearly 100 percent and it is in use in those types of numbers",
    "start": "210640",
    "end": "218799"
  },
  {
    "text": "so it's a critical infrastructure um however it isn't being researched uh in that the same",
    "start": "218799",
    "end": "225680"
  },
  {
    "text": "way so before we get again to what we found",
    "start": "225680",
    "end": "231120"
  },
  {
    "text": "and understand better pts systems and what they're made of let's just set our agenda for today",
    "start": "231120",
    "end": "238080"
  },
  {
    "text": "um a bit about what is the architecture of this system what are the components that",
    "start": "238080",
    "end": "244560"
  },
  {
    "text": "uh that comprise the system and then we are talking to specifically",
    "start": "244560",
    "end": "249599"
  },
  {
    "text": "about swiss logs swisslock is the vendor that we've researched and it's actually a very prominent vendor that is by far",
    "start": "249599",
    "end": "256160"
  },
  {
    "text": "the largest one in north america mostly using hull in hospitals north",
    "start": "256160",
    "end": "261440"
  },
  {
    "text": "america uh then barack is going to walk you through the whole piece that we found",
    "start": "261440",
    "end": "266639"
  },
  {
    "text": "some of the challenges and how we were able to exploit them and then obviously we want to show you a",
    "start": "266639",
    "end": "272720"
  },
  {
    "text": "demo of this and some final thoughts so",
    "start": "272720",
    "end": "278240"
  },
  {
    "text": "just to begin the overview of what did we actually find so we found nine vulnerabilities",
    "start": "278240",
    "end": "284479"
  },
  {
    "text": "in the swisslog translogic pneumatic tube system and these are critical vulnerabilities",
    "start": "284479",
    "end": "289520"
  },
  {
    "text": "that were found in the nexus station the nexus station is a prominent pneumatic tube station by swiss log it",
    "start": "289520",
    "end": "296720"
  },
  {
    "text": "has unfortunately nine vulnerabilities that we found and these span from different",
    "start": "296720",
    "end": "302000"
  },
  {
    "text": "types of vulnerabilities we were able to find some of the most basic types of vulnerabilities hard coded passwords",
    "start": "302000",
    "end": "308160"
  },
  {
    "text": "privileged escalation from very simple errors even a design flaw in which the",
    "start": "308160",
    "end": "313440"
  },
  {
    "text": "framework is not secured not encrypted and not signed and then a couple of memory corruption",
    "start": "313440",
    "end": "320560"
  },
  {
    "text": "vulnerabilities uh four of these can lead to remote code execution and an",
    "start": "320560",
    "end": "325600"
  },
  {
    "text": "analysis and the denial of service mobility unfortunately all of these model views can be triggered via unauthenticated",
    "start": "325600",
    "end": "331360"
  },
  {
    "text": "network brackets and then and they do not require any user interaction so simply having access to a network",
    "start": "331360",
    "end": "337680"
  },
  {
    "text": "when where these devices exist can allow an attacker full remarkable execution full taker takeover of these devices",
    "start": "337680",
    "end": "345840"
  },
  {
    "text": "and we've obviously done a security disclosure with syslog on this and",
    "start": "345840",
    "end": "351440"
  },
  {
    "text": "a security advisory has been released a few days ago and our detailed blog from armies about",
    "start": "351440",
    "end": "357680"
  },
  {
    "text": "this has also been published",
    "start": "357680",
    "end": "361039"
  },
  {
    "text": "okay so um let's talk about about swiss log",
    "start": "363199",
    "end": "368400"
  },
  {
    "text": "swiss log is the leading magic tube system in the market it's installing over 2 300 hospitals in",
    "start": "368400",
    "end": "374400"
  },
  {
    "text": "north america and 3 000 hospitals worldwide the majority of hospitals in northern",
    "start": "374400",
    "end": "379520"
  },
  {
    "text": "florida actually use swiss dog the ones that use the magic to solutions the large ones",
    "start": "379520",
    "end": "385759"
  },
  {
    "text": "and translogic is probably the most advanced pneumatic tube systems that exist in the market worldwide it",
    "start": "385759",
    "end": "391199"
  },
  {
    "text": "supports advanced features it can sustain high load of",
    "start": "391199",
    "end": "396720"
  },
  {
    "text": "transactions it's very reliable and it even has some physical security features uh baked into it",
    "start": "396720",
    "end": "404880"
  },
  {
    "text": "pneumatic tube systems are these complex network of analog components so they come from a time before the",
    "start": "405759",
    "end": "412560"
  },
  {
    "text": "internet right they're supposed to give these networks to transfer",
    "start": "412560",
    "end": "417680"
  },
  {
    "text": "letters and mail and stuff like that and and some of that design is still in",
    "start": "417680",
    "end": "423120"
  },
  {
    "text": "place today so there are a complex of these tubes blowers transfer units these are some",
    "start": "423120",
    "end": "431280"
  },
  {
    "text": "you know some some components that are like routers inside the systems and eventually stations",
    "start": "431280",
    "end": "437039"
  },
  {
    "text": "the endpoints of the system where you receive carriers or you can send carriers",
    "start": "437039",
    "end": "443680"
  },
  {
    "text": "however today this system is not as analog and it's completely managed over",
    "start": "443680",
    "end": "449120"
  },
  {
    "text": "ip over ethernet by a central server and the central server today is a",
    "start": "449120",
    "end": "454880"
  },
  {
    "text": "windows device and for many of these systems this device is connected to the internet",
    "start": "454880",
    "end": "460720"
  },
  {
    "text": "and this allows various features for the system we'll talk about that in a bit but it's also",
    "start": "460720",
    "end": "467280"
  },
  {
    "text": "essentially an attack surface through which attackers can come in through that internet connectivity",
    "start": "467280",
    "end": "473360"
  },
  {
    "text": "and all of these components uh the stations the transporters the blowers they connect",
    "start": "473360",
    "end": "478879"
  },
  {
    "text": "through the land to the central server again that in this state server has access to the internet",
    "start": "478879",
    "end": "485680"
  },
  {
    "text": "the possible effects of cyber attacks on the pneumatic tube systems is quite severe so again this is a critical",
    "start": "485680",
    "end": "492160"
  },
  {
    "text": "infrastructure it's something that the hospital uses on a daily basis all the time so even the knowledge of service attack",
    "start": "492160",
    "end": "498479"
  },
  {
    "text": "on this network can be really harmful to the hospital there is no real back-up plan to the",
    "start": "498479",
    "end": "504000"
  },
  {
    "text": "hospital if the system were to be taken offline but there are other attack vectors in",
    "start": "504000",
    "end": "509599"
  },
  {
    "text": "this attack possibilities in this type of system the system does",
    "start": "509599",
    "end": "515200"
  },
  {
    "text": "integrate with other hospital and infrastructures hospital",
    "start": "515200",
    "end": "520800"
  },
  {
    "text": "staff records for example are for the credential of the staff uh so information leak of this type of",
    "start": "520800",
    "end": "527120"
  },
  {
    "text": "data can be also quite severe and lastly maybe a little bit uh fringe",
    "start": "527120",
    "end": "533120"
  },
  {
    "text": "case but still theoretically possible an attacker can use this system to carry",
    "start": "533120",
    "end": "538320"
  },
  {
    "text": "out a sophisticated transformer attack a sort of sabotage attack so we can take over this system and then",
    "start": "538320",
    "end": "545600"
  },
  {
    "text": "use it to sabotage the operation of the hospital reroute carriers and derail the",
    "start": "545600",
    "end": "551279"
  },
  {
    "text": "operations office hospital without the staff necessarily understanding that the system does not work as intended",
    "start": "551279",
    "end": "558720"
  },
  {
    "text": "so that's the theoretical risk and that is a good reason why we should look at these systems and understand whether",
    "start": "558720",
    "end": "565120"
  },
  {
    "text": "that risk is there whether attacks can actually take place",
    "start": "565120",
    "end": "570160"
  },
  {
    "text": "so now i'll hand it over to barack he will talk about the system design and structure and about the",
    "start": "570160",
    "end": "576480"
  },
  {
    "text": "vulnerabilities that we found",
    "start": "576480",
    "end": "579519"
  },
  {
    "text": "hi so let's talk a bit about the design and structure of the pts system so the",
    "start": "582000",
    "end": "587200"
  },
  {
    "text": "user facing part of the system is the stations that's where capsules go in and out when a capsule is sent the station",
    "start": "587200",
    "end": "594160"
  },
  {
    "text": "door closes the blower is activated and the capsule is pushed to the nearest diverter at that point the diverter is",
    "start": "594160",
    "end": "601680"
  },
  {
    "text": "instructed to connect to the correct path and the capsule is travels to its destination",
    "start": "601680",
    "end": "608079"
  },
  {
    "text": "using the correct pipe each station has a number after safely",
    "start": "608079",
    "end": "614640"
  },
  {
    "text": "instead inserting the capsule the target station number is entered and the staff can also mention if the transfer should",
    "start": "614640",
    "end": "621519"
  },
  {
    "text": "be slow that's used for sensitive samples or things that need to",
    "start": "621519",
    "end": "626640"
  },
  {
    "text": "go very steadily through the system and the capsule is sent throughout the system and out of the station",
    "start": "626640",
    "end": "635279"
  },
  {
    "text": "and next we have the blowers and these devices just control the pressure in the tubes pushing or pulling the capsules",
    "start": "636240",
    "end": "644480"
  },
  {
    "text": "and then we have the diverter diverters and these are the swift the switches of the system much like",
    "start": "644480",
    "end": "650399"
  },
  {
    "text": "switches in packet networks and these are physical switches and they divert the capsules to the correct tube on the",
    "start": "650399",
    "end": "657279"
  },
  {
    "text": "path to its destination um orchestrating all of that there's the",
    "start": "657279",
    "end": "663200"
  },
  {
    "text": "central management server called the sec and this orchestrates all",
    "start": "663200",
    "end": "668800"
  },
  {
    "text": "of the operation telling the blowers when to act and telling the diverters and station when they should send the",
    "start": "668800",
    "end": "676240"
  },
  {
    "text": "capsule or just weight and just making sure the capsule travels safely",
    "start": "676240",
    "end": "683040"
  },
  {
    "text": "throughout the hospital all of that interconnects to one zone",
    "start": "683040",
    "end": "688640"
  },
  {
    "text": "the blower controls the air pressure in the tube and using the diverters the central server",
    "start": "688640",
    "end": "694000"
  },
  {
    "text": "directs the capsule to the desired destination one capsule can pass through a zone at a",
    "start": "694000",
    "end": "700720"
  },
  {
    "text": "time but zones can be interconnected using an inter zone diverter much like a",
    "start": "700720",
    "end": "706560"
  },
  {
    "text": "router compared to a switch swisslog has some advanced features that",
    "start": "706560",
    "end": "714079"
  },
  {
    "text": "are not trivial for pneumatic tube systems um like secure transfers where",
    "start": "714079",
    "end": "719440"
  },
  {
    "text": "the sender os evo and need to use some rfid or a password to get the capsule",
    "start": "719440",
    "end": "724959"
  },
  {
    "text": "and there's also transfer speed control for slow speed sensitive cargo",
    "start": "724959",
    "end": "730399"
  },
  {
    "text": "and an alert system for staff notifications uh when a capsule that is destined to them arrives",
    "start": "730399",
    "end": "737920"
  },
  {
    "text": "and or the notifications can be sent using various methods like email sms etc",
    "start": "737920",
    "end": "745200"
  },
  {
    "text": "this system requires requires internet connectivity from the central server",
    "start": "745200",
    "end": "750320"
  },
  {
    "text": "and lastly swiss log offers to maintain the server on behalf of the client by remo remote monitoring the central",
    "start": "750320",
    "end": "757519"
  },
  {
    "text": "server from swiss load cloud again using internet connectivity",
    "start": "757519",
    "end": "763360"
  },
  {
    "text": "there are several generations of the translogic system early systems were based on serial connection with the",
    "start": "764240",
    "end": "770959"
  },
  {
    "text": "central server iq stations were the first to have ethernet connectivity and these",
    "start": "770959",
    "end": "776639"
  },
  {
    "text": "are still widely used in hospitals today examining the iq station board it has an",
    "start": "776639",
    "end": "783519"
  },
  {
    "text": "ethernet connector it uses a 16 bit mcu and the file and the firmware is",
    "start": "783519",
    "end": "788639"
  },
  {
    "text": "installed on an external flash unencrypted and unsigned",
    "start": "788639",
    "end": "793920"
  },
  {
    "text": "looking in the iq station manual there is a dip switch that needs to be set in",
    "start": "793920",
    "end": "799279"
  },
  {
    "text": "order to execute a firmware upgrade on one hand this makes the upgrade operation tedious and almost impractical",
    "start": "799279",
    "end": "807040"
  },
  {
    "text": "for critical systems on the other hand this does safeguard the system from unwanted",
    "start": "807040",
    "end": "813200"
  },
  {
    "text": "malicious firmware updates",
    "start": "813200",
    "end": "816639"
  },
  {
    "text": "the latest station by swiss log is the next station it has a touchscreen and supports",
    "start": "820000",
    "end": "826160"
  },
  {
    "text": "advanced features like rfid this system runs over 32 bits arm architecture and",
    "start": "826160",
    "end": "832240"
  },
  {
    "text": "runs a very old linux kernel there are two interesting processes in the system both named hmi3 the first one",
    "start": "832240",
    "end": "840320"
  },
  {
    "text": "is an elf file responsible for the low level operation of the station like communicating with the management server",
    "start": "840320",
    "end": "846720"
  },
  {
    "text": "the rfid reader and the station door the second one is a java app mainly",
    "start": "846720",
    "end": "851839"
  },
  {
    "text": "responsible for the gui of this data of this device and logical operations",
    "start": "851839",
    "end": "858160"
  },
  {
    "text": "looking at hmi3 there are no mitigations of any kind the elf is not position",
    "start": "858160",
    "end": "863760"
  },
  {
    "text": "independent code it is compiled with debug symbols and there are no stack canaries all that makes it a convenient",
    "start": "863760",
    "end": "870560"
  },
  {
    "text": "target for exploitation once we find a vulnerability",
    "start": "870560",
    "end": "875199"
  },
  {
    "text": "connecting the system and looking at the protocol the first thing that pops is that there is a magic",
    "start": "875680",
    "end": "881839"
  },
  {
    "text": "header containing the letters tlpu we guessed it stands for",
    "start": "881839",
    "end": "887040"
  },
  {
    "text": "translogic pneumatic universe after the marker there is a sequence number",
    "start": "887040",
    "end": "892959"
  },
  {
    "text": "operation type and the actual request request data and the device has multiple attack",
    "start": "892959",
    "end": "898959"
  },
  {
    "text": "surfaces the first is the physical one the firmware is saved unencrypted and unsigned on an attached attached sd card",
    "start": "898959",
    "end": "906639"
  },
  {
    "text": "an attacker could simply swap the sd card loading an attacker controlled firmware",
    "start": "906639",
    "end": "912480"
  },
  {
    "text": "looking at the network interface we found this in the manual it says it says",
    "start": "912480",
    "end": "917760"
  },
  {
    "text": "the rest of the system is not vulnerable to attacks because the system and equipment uses a language that only the",
    "start": "917760",
    "end": "924639"
  },
  {
    "text": "sec can understand thereby eliminating any network security concerns for the",
    "start": "924639",
    "end": "929839"
  },
  {
    "text": "other pts devices the management server connects to the",
    "start": "929839",
    "end": "935519"
  },
  {
    "text": "internet for license checks alerts notifications remote monitoring and maintenance any vulnerability found in",
    "start": "935519",
    "end": "942560"
  },
  {
    "text": "its proprietary code can lead an attacker from the internet to the control to",
    "start": "942560",
    "end": "947920"
  },
  {
    "text": "control the entire pts system inside the hospital",
    "start": "947920",
    "end": "954000"
  },
  {
    "text": "we decided to investigate the nexus station since since it's the latest and",
    "start": "954000",
    "end": "959040"
  },
  {
    "text": "most sophisticated station it is both user-facing and server-facing and",
    "start": "959040",
    "end": "964079"
  },
  {
    "text": "controls the source and destination of all the transactions in the system",
    "start": "964079",
    "end": "969839"
  },
  {
    "text": "so vulnerability one and two are actually hard out coded passwords and",
    "start": "970000",
    "end": "975759"
  },
  {
    "text": "apparently the device has an open telnet server and we took the shadow file of the system gave it to john the ripper",
    "start": "975759",
    "end": "982880"
  },
  {
    "text": "and found a hard-coded password for the user user and there is also an hard-coded password for the user root",
    "start": "982880",
    "end": "989600"
  },
  {
    "text": "that we weren't able to crack so using the user user an attacker can get a",
    "start": "989600",
    "end": "994720"
  },
  {
    "text": "linux shell with user privileges to solve the privilege problem we found",
    "start": "994720",
    "end": "1001360"
  },
  {
    "text": "that the hmi run file is a user writable bash script that's executed on startup on",
    "start": "1001360",
    "end": "1009519"
  },
  {
    "text": "system startup so you can just so in order to get root privileges an",
    "start": "1009519",
    "end": "1015759"
  },
  {
    "text": "attacker just needs to connect to the telnet server change the hmi run script",
    "start": "1015759",
    "end": "1021839"
  },
  {
    "text": "and reboot using any one of the memory corruption vulnerabilities we are about to talk",
    "start": "1021839",
    "end": "1028319"
  },
  {
    "text": "the next vulnerability is a classic missing boundary check the udp rx thread is the main thread",
    "start": "1029360",
    "end": "1035760"
  },
  {
    "text": "analyzing incoming commands for the translogic protocol reclaim is the size of the incoming",
    "start": "1035760",
    "end": "1043600"
  },
  {
    "text": "incoming packet making it an attacker controlled unsigned short a q buff is a buffer of length 180 hex",
    "start": "1043600",
    "end": "1051679"
  },
  {
    "text": "from the custom internal hip if the received buffer is shorter than 20 bytes data lan will underflow to 64",
    "start": "1051679",
    "end": "1058880"
  },
  {
    "text": "kilobytes there is also an underflow in the call to mem copy that should have copied four gigabyte",
    "start": "1058880",
    "end": "1065440"
  },
  {
    "text": "leading this vulnerability to be a dos vulnerability denial of service however there is a known vulnerability in the",
    "start": "1065440",
    "end": "1071360"
  },
  {
    "text": "leap c version used by this device so according to this vulnerability",
    "start": "1071360",
    "end": "1076960"
  },
  {
    "text": "the implementation of vm copy specifically for arm header bug that the",
    "start": "1076960",
    "end": "1082080"
  },
  {
    "text": "length field was treated as a signed integer you can see in the snippet that the",
    "start": "1082080",
    "end": "1087200"
  },
  {
    "text": "unsigned length is being cast to a signed integer causing the mem copy to copy only a small amount of bytes",
    "start": "1087200",
    "end": "1094160"
  },
  {
    "text": "instead of 4 gigabyte which would have led to a seg fault",
    "start": "1094160",
    "end": "1099360"
  },
  {
    "text": "looking back at the code the mem copy will not crash the process after this function the buffer is sent",
    "start": "1099360",
    "end": "1106240"
  },
  {
    "text": "to other threads in the process which use the handle flowed unsigned 16 bit length",
    "start": "1106240",
    "end": "1111679"
  },
  {
    "text": "this leads to an exploitable hip corruption that can reach a remote code execution",
    "start": "1111679",
    "end": "1118080"
  },
  {
    "text": "next up is another missing boundary check certain udp packets will be processed by",
    "start": "1118080",
    "end": "1123440"
  },
  {
    "text": "the sec process message function shown here and a1 is the incoming packet",
    "start": "1123440",
    "end": "1129200"
  },
  {
    "text": "a1 data n is the received data length if data at offset 0 equals 90 hex the data",
    "start": "1129200",
    "end": "1136320"
  },
  {
    "text": "is copied without the first byte but there is no boundary check so data lan can be zero",
    "start": "1136320",
    "end": "1142799"
  },
  {
    "text": "and cause an overflow you may ask yourself how can you set data at offset 0 and if the data",
    "start": "1142799",
    "end": "1150559"
  },
  {
    "text": "length is zero and the answer is that the buffers are not initialized between",
    "start": "1150559",
    "end": "1156720"
  },
  {
    "text": "usages so an attacker could easily just spray the buffers with data at offset 0",
    "start": "1156720",
    "end": "1162080"
  },
  {
    "text": "equal to 90 hex there are only 59 buffers in those queues so that's fairly easy and",
    "start": "1162080",
    "end": "1168799"
  },
  {
    "text": "after that send a buffer with data land equals to zero and get the 90 hex byte",
    "start": "1168799",
    "end": "1174000"
  },
  {
    "text": "from the uninitialized data okay vulnerability 6 is of a",
    "start": "1174000",
    "end": "1180640"
  },
  {
    "text": "different kind when the hmi process starts it waits for the java gui to connect to it to do so",
    "start": "1180640",
    "end": "1187840"
  },
  {
    "text": "it opens a listening tcp socket that accepts one connection and one connection only unfortunately that",
    "start": "1187840",
    "end": "1194480"
  },
  {
    "text": "socket is bound to all interfaces and not just localhost if an attacker is able to cause a reboot",
    "start": "1194480",
    "end": "1201360"
  },
  {
    "text": "there might be a window to take over this tcp connection before degree connects",
    "start": "1201360",
    "end": "1206960"
  },
  {
    "text": "let's see how long does it take for the java app to connect and can we win the race",
    "start": "1206960",
    "end": "1212799"
  },
  {
    "text": "the process writes waiting for tcp connection when it starts accepting and ccp accepted tcp socket when a",
    "start": "1212799",
    "end": "1220080"
  },
  {
    "text": "connection is made so we just need to look at the log the first log is printed after 34",
    "start": "1220080",
    "end": "1228240"
  },
  {
    "text": "seconds from wood and the second after a full minute that means that an attacker has",
    "start": "1228240",
    "end": "1233280"
  },
  {
    "text": "approximately 25 seconds to win the race which is more than enough we were able to do this manually",
    "start": "1233280",
    "end": "1239919"
  },
  {
    "text": "using one of the memory corruption vulnerabilities to trigger a reboot and win the race on startup at that point",
    "start": "1239919",
    "end": "1246799"
  },
  {
    "text": "the gui cannot connect to the back end since it accepts only one connection so the attacker can send any gui",
    "start": "1246799",
    "end": "1253280"
  },
  {
    "text": "commands as if it was a physical user using the station you can act as if you've pushed a virtual",
    "start": "1253280",
    "end": "1260240"
  },
  {
    "text": "button on the screen and the user can't do nothing about it",
    "start": "1260240",
    "end": "1266320"
  },
  {
    "text": "next is another missing boundary check this function passes the messages coming from the previously message mentioned",
    "start": "1266720",
    "end": "1273520"
  },
  {
    "text": "tcp socket this one livability is similar to the last memory vulnerability when a message",
    "start": "1273520",
    "end": "1279039"
  },
  {
    "text": "is sent to the hmitcp socket which we've hijacked using the previous vulnerability it is forwarded to the hmi",
    "start": "1279039",
    "end": "1286960"
  },
  {
    "text": "process message a function through the pending queue since the data length is",
    "start": "1286960",
    "end": "1292400"
  },
  {
    "text": "taken from the received packet an attacker could set it to zero making it underflow in the hmi process message",
    "start": "1292400",
    "end": "1299520"
  },
  {
    "text": "function we can set data at offset 0 to 30 33 hex",
    "start": "1299520",
    "end": "1305039"
  },
  {
    "text": "using the same spray technique we used for the last backbone boundary check just spray many messages with data",
    "start": "1305039",
    "end": "1311520"
  },
  {
    "text": "offset 0 equals to 33 x and then send a packet with data length",
    "start": "1311520",
    "end": "1317039"
  },
  {
    "text": "set to zero",
    "start": "1317039",
    "end": "1320080"
  },
  {
    "text": "the next vulnerability is the trickiest of them all it's an off by three stack overflow so bear with me it happens when",
    "start": "1324559",
    "end": "1331440"
  },
  {
    "text": "a message that is sent to the udp thread is ultimately forwarded to the java",
    "start": "1331440",
    "end": "1336559"
  },
  {
    "text": "process via the tcp socket we start by sending a buffer of length",
    "start": "1336559",
    "end": "1343120"
  },
  {
    "text": "370 to the udp alex thread that's the maximum received length",
    "start": "1343120",
    "end": "1350240"
  },
  {
    "text": "then the 20 bytes header is omitted leaving us with 350 bytes that are",
    "start": "1352480",
    "end": "1358320"
  },
  {
    "text": "copied to a buffer on the hip that buffer is sent to the worker thread for pulsing over a queue",
    "start": "1358320",
    "end": "1366960"
  },
  {
    "text": "the worker thread gets the buffer out of the queue and processes it using the scc",
    "start": "1368400",
    "end": "1373440"
  },
  {
    "text": "process message function that we've mentioned before",
    "start": "1373440",
    "end": "1377759"
  },
  {
    "text": "if the first byte of the data equals the 37x command the message is forwarded",
    "start": "1378960",
    "end": "1385840"
  },
  {
    "text": "to the hmi still containing a buffer of length 350.",
    "start": "1385840",
    "end": "1392360"
  },
  {
    "text": "forward to hmi copies the buffer to another buffer and sends the copied buffer to the tcp tx thread",
    "start": "1393840",
    "end": "1402760"
  },
  {
    "text": "the dcptx thread copies the data from the input buffer to a stack",
    "start": "1403679",
    "end": "1408720"
  },
  {
    "text": "allocated buffer of length 352 but the copy offset is three so the last byte of",
    "start": "1408720",
    "end": "1415120"
  },
  {
    "text": "the buffer is written to offset 352 resulting in an off by one",
    "start": "1415120",
    "end": "1421760"
  },
  {
    "text": "but wait there's more",
    "start": "1421760",
    "end": "1425200"
  },
  {
    "text": "after the mem copy edclc a crc to the end of the buffer they use a 2 byte crc",
    "start": "1426880",
    "end": "1433200"
  },
  {
    "text": "resulting in two more attacker-controlled bytes hence the off by 3 stack overflow this overflow can",
    "start": "1433200",
    "end": "1439840"
  },
  {
    "text": "lead to remote code execution as well we will show how in a few slides",
    "start": "1439840",
    "end": "1445679"
  },
  {
    "text": "the last vulnerability we'll talk about is actually a fundamental fundamental design flow in",
    "start": "1445679",
    "end": "1451679"
  },
  {
    "text": "all turns logic stations in which the firmware is unencrypted and unsigned similar to the legacy translogic",
    "start": "1451679",
    "end": "1458559"
  },
  {
    "text": "stations there is a remote firmware upgrade process with no firmware validation but unlike the old stations",
    "start": "1458559",
    "end": "1464960"
  },
  {
    "text": "the nexus station supports firmware upgrades via the unauthenticated unencrypted udp protocol at all times so",
    "start": "1464960",
    "end": "1472080"
  },
  {
    "text": "there's no need for spatial special download mode deep switch or any kind",
    "start": "1472080",
    "end": "1478080"
  },
  {
    "text": "of thing like that the only validation is a simple clc after the validation the newly downloaded app is copied to hmi3",
    "start": "1478080",
    "end": "1486320"
  },
  {
    "text": "new and on reboot that executable becomes the new hmi3 an attacker abusing",
    "start": "1486320",
    "end": "1491679"
  },
  {
    "text": "this security lacking mechanism gains both remote code execution and persistence over the system in one",
    "start": "1491679",
    "end": "1498880"
  },
  {
    "text": "vulnerability that's all fun and games let's talk about exploiting all of that generally",
    "start": "1498880",
    "end": "1505919"
  },
  {
    "text": "speaking we have two options the easy way we can upload a malicious",
    "start": "1505919",
    "end": "1512000"
  },
  {
    "text": "firmware of or just use the default user and the privilege escalation",
    "start": "1512000",
    "end": "1517679"
  },
  {
    "text": "however we believe that the memory corruption vulnerabilities might be inherent to the code base parsing the",
    "start": "1517679",
    "end": "1523440"
  },
  {
    "text": "translogic protocol so we took them as an exercise to see whether they could be exploited to gain an rce as well",
    "start": "1523440",
    "end": "1532159"
  },
  {
    "text": "we are going to use the off by 3 stack overflow buffer descent is right after",
    "start": "1532720",
    "end": "1538159"
  },
  {
    "text": "buff so the overflow rights to the three least significant bytes of the buffer to",
    "start": "1538159",
    "end": "1543440"
  },
  {
    "text": "send pointer this pointer is then returned to the free q which leads to a hip corruption the plan is",
    "start": "1543440",
    "end": "1551279"
  },
  {
    "text": "we move buffer to send to the global offset table section where there are many function pointers that we can",
    "start": "1551279",
    "end": "1557840"
  },
  {
    "text": "overwrite then we send another udp packet that will trigger the use of the moved buffer this will overwrite the",
    "start": "1557840",
    "end": "1564799"
  },
  {
    "text": "address of mem copy and set it to point to a shell code in the hip",
    "start": "1564799",
    "end": "1571120"
  },
  {
    "text": "we will start by examining by examining the custom process hip there are 59",
    "start": "1571120",
    "end": "1576480"
  },
  {
    "text": "fixed size pre-allocated hip blocks that are moved around between the different threads and cues",
    "start": "1576480",
    "end": "1582400"
  },
  {
    "text": "the blocks are sequential in memory the first two d words of each block are the next and prev pointers used by the",
    "start": "1582400",
    "end": "1588880"
  },
  {
    "text": "queues the blocks are assigned too",
    "start": "1588880",
    "end": "1592960"
  },
  {
    "text": "the blocks are constantly moved around between the different queues of the process and by diff and by different threads",
    "start": "1594480",
    "end": "1601600"
  },
  {
    "text": "it's important to note that the block data is never wiped between usages and only the pref and next pointers are",
    "start": "1601600",
    "end": "1608480"
  },
  {
    "text": "overwritten when the blocks are moved around now that we know the hip structure let's",
    "start": "1608480",
    "end": "1615279"
  },
  {
    "text": "examine what happens when the vulnerability is triggered the mem copy is copying one byte too much and the crc",
    "start": "1615279",
    "end": "1622799"
  },
  {
    "text": "adds two more bytes since buffer to send is right after buff and this is little indian arm it means that an attacker can",
    "start": "1622799",
    "end": "1630559"
  },
  {
    "text": "control the three least significant bytes of buffer to send",
    "start": "1630559",
    "end": "1636000"
  },
  {
    "text": "so now we can point buffer to send to wherever we want even outside of the",
    "start": "1639039",
    "end": "1644240"
  },
  {
    "text": "block structure this can become an effective write what where primitive and gaining code execution via a primitive",
    "start": "1644240",
    "end": "1650880"
  },
  {
    "text": "of this nature can be done in various ways one way is to use the to use the global offset table the got",
    "start": "1650880",
    "end": "1658080"
  },
  {
    "text": "to overwrite function pointers that will later lead to execution of controlled code let's examine the memory layout of",
    "start": "1658080",
    "end": "1664960"
  },
  {
    "text": "the process as you recall the main binary is not aslr capable so the section addresses",
    "start": "1664960",
    "end": "1672720"
  },
  {
    "text": "are predictable the hip blocks are in the bss section and both the bss and the global offset",
    "start": "1672720",
    "end": "1679200"
  },
  {
    "text": "table sections share the same msb bytes most significant byte another important thing to mention",
    "start": "1679200",
    "end": "1686559"
  },
  {
    "text": "is that as you can see for some reason the bss section is also executable",
    "start": "1686559",
    "end": "1691600"
  },
  {
    "text": "connecting the dots we can set the new buffer to send address to be somewhere inside the got table using our overflow",
    "start": "1691600",
    "end": "1699279"
  },
  {
    "text": "and lead a function pointer there to point to a hip buffer with a shell code since the hip is also executable a call",
    "start": "1699279",
    "end": "1707120"
  },
  {
    "text": "to function pointer in the got will lead to a shell code execution in the hip we",
    "start": "1707120",
    "end": "1712559"
  },
  {
    "text": "just need to find a good place in the got section",
    "start": "1712559",
    "end": "1717278"
  },
  {
    "text": "when a buffer is added to the free queue the first two d words are overwritten with the next and prep pointers in the",
    "start": "1720080",
    "end": "1726960"
  },
  {
    "text": "following address in the got we can overwrite the first two d words since stl to unsigned long and p thread create",
    "start": "1726960",
    "end": "1734320"
  },
  {
    "text": "are used only in the initialization of the process once buffer to send is overwritten to",
    "start": "1734320",
    "end": "1739840"
  },
  {
    "text": "point to this got address the block is added back to the free queue so now we have a block in the queue that is",
    "start": "1739840",
    "end": "1746399"
  },
  {
    "text": "actually in the global offset table section sending multiple udp packets will ultimately trigger the use of",
    "start": "1746399",
    "end": "1753919"
  },
  {
    "text": "our new got block which will lead to an override of the mam copy function",
    "start": "1753919",
    "end": "1758960"
  },
  {
    "text": "pointer when the got block is allocated",
    "start": "1758960",
    "end": "1764240"
  },
  {
    "text": "by the udprx thread the vam copy function pointer will be overwritten with the sequence number from the",
    "start": "1764240",
    "end": "1770960"
  },
  {
    "text": "incoming packet we can set the sequence number to be the",
    "start": "1770960",
    "end": "1776480"
  },
  {
    "text": "address of a shell code in the heap which we should spray before exploiting the overflow this means that when mem",
    "start": "1776480",
    "end": "1783520"
  },
  {
    "text": "copy is called just a few lines later it is actually a call to a shell code in the hip",
    "start": "1783520",
    "end": "1789200"
  },
  {
    "text": "taken from a previously sent packet so let's sum this all up we start by",
    "start": "1789200",
    "end": "1795840"
  },
  {
    "text": "heat spraying with the shell code in the right place then we trigger the off by three volt",
    "start": "1795840",
    "end": "1801520"
  },
  {
    "text": "vulnerability to move one block of the hip to the got section where mem copy is",
    "start": "1801520",
    "end": "1807360"
  },
  {
    "text": "after that we spray again with the address of the shell code in the",
    "start": "1807360",
    "end": "1812640"
  },
  {
    "text": "sequence number so that mem copy will point to the shell code once the got block is used the mam copy pointer",
    "start": "1812640",
    "end": "1820000"
  },
  {
    "text": "will point to the shell code and then the show code will be triggered and that's",
    "start": "1820000",
    "end": "1825760"
  },
  {
    "text": "it it's demo time i will now give the stage back to ben for the demo demonstration",
    "start": "1825760",
    "end": "1832960"
  },
  {
    "text": "all right so um barack",
    "start": "1835520",
    "end": "1840960"
  },
  {
    "text": "went through the wrong reasons that we found and like you saw it was some very basic vulnerabilities",
    "start": "1840960",
    "end": "1846159"
  },
  {
    "text": "um and then we got to the point on how we are going to demo this and we",
    "start": "1846159",
    "end": "1851279"
  },
  {
    "text": "really like this subreddit called really one doom and the short answer is it will",
    "start": "1851279",
    "end": "1857120"
  },
  {
    "text": "um so i'll walk you through this demo essentially we exploited this off by three stack overflow turned into heap overflow",
    "start": "1857120",
    "end": "1865120"
  },
  {
    "text": "and got the code execution on the swiss log nexus control panel let's go through it",
    "start": "1865120",
    "end": "1872398"
  },
  {
    "text": "so we first see barack playing with the station which is fully operational at this point",
    "start": "1873039",
    "end": "1879840"
  },
  {
    "text": "now we start the attack by spraying the heap to fill it with shellcode buffers this is the first step and then",
    "start": "1882799",
    "end": "1890080"
  },
  {
    "text": "we trigger the overflow to overwrite the buffer to send pointer so it will point to the got",
    "start": "1890080",
    "end": "1895200"
  },
  {
    "text": "section lastly we send multiple packets so the tainted got block will be used and the shell will be called and we can",
    "start": "1895200",
    "end": "1902240"
  },
  {
    "text": "already see that the shelter was called and reverse shell was initiated and we have doom",
    "start": "1902240",
    "end": "1908880"
  },
  {
    "text": "finally we can see barack playing mad madly",
    "start": "1912000",
    "end": "1917360"
  },
  {
    "text": "against the medic doom station [Music]",
    "start": "1917360",
    "end": "1939360"
  },
  {
    "text": "okay so some final thoughts",
    "start": "1939360",
    "end": "1944960"
  },
  {
    "text": "pneumatic cube systems require much more research it's obvious from what we were able to find and it's also obvious just",
    "start": "1945840",
    "end": "1952960"
  },
  {
    "text": "by the fact that these are critical infrastructure systems like electricity like elevators this",
    "start": "1952960",
    "end": "1959600"
  },
  {
    "text": "systems can't be taken off offline they have to have",
    "start": "1959600",
    "end": "1964960"
  },
  {
    "text": "100 of up time hospitals really rely on them so much more research is needed here",
    "start": "1964960",
    "end": "1971919"
  },
  {
    "text": "and i think what is also interesting in this in this research is just the case of swiss dog as a company as a product",
    "start": "1971919",
    "end": "1978799"
  },
  {
    "text": "manufacturer the case of them using embedded devices and how that was",
    "start": "1978799",
    "end": "1985279"
  },
  {
    "text": "done poorly traditionally companies that created invalidic tube",
    "start": "1985279",
    "end": "1990399"
  },
  {
    "text": "systems you can think of them as somebody that create hardware analog systems stuff that doesn't have to be",
    "start": "1990399",
    "end": "1996480"
  },
  {
    "text": "secure because it's all analog but then they moved and they want it to",
    "start": "1996480",
    "end": "2002080"
  },
  {
    "text": "be more sophisticated added more features their first stations that were uh",
    "start": "2002080",
    "end": "2007679"
  },
  {
    "text": "connected to the network and they were very limited in their capabilities to upgrade them you would have to to change",
    "start": "2007679",
    "end": "2013919"
  },
  {
    "text": "a physical switch and that actually created some security to them inherent security by the fact that they were",
    "start": "2013919",
    "end": "2020559"
  },
  {
    "text": "very limited in capabilities once they moved to using linux as their operating system with all that it got in",
    "start": "2020559",
    "end": "2028240"
  },
  {
    "text": "it by default telnet server different credentials stuff that really",
    "start": "2028240",
    "end": "2034720"
  },
  {
    "text": "is um good in you know other places but not good in embedded devices that are not",
    "start": "2034720",
    "end": "2040159"
  },
  {
    "text": "managed then it became a problem and so this really illustrates a bigger picture",
    "start": "2040159",
    "end": "2046720"
  },
  {
    "text": "how certain types of systems when they go through this evolution of",
    "start": "2046720",
    "end": "2052398"
  },
  {
    "text": "from hardware to software from analog to to embedded devices they have",
    "start": "2052399",
    "end": "2058398"
  },
  {
    "text": "to have security put brought into that process in that consideration",
    "start": "2058399",
    "end": "2066079"
  },
  {
    "text": "so having said that again more research is needed in these type of systems",
    "start": "2066079",
    "end": "2071520"
  },
  {
    "text": "and i think in the meantime it's very important to develop robust security mitigations to safeguard these types of",
    "start": "2071520",
    "end": "2077118"
  },
  {
    "text": "systems patching these systems is difficult but mitigating the risk of these types of",
    "start": "2077119",
    "end": "2082800"
  },
  {
    "text": "abilities from a network standpoint that's not that difficult it's possible",
    "start": "2082800",
    "end": "2087839"
  },
  {
    "text": "lastly i think it's very important that doom is added to pneumatic tube",
    "start": "2087839",
    "end": "2092960"
  },
  {
    "text": "systems any hospital visit would be much more interesting if doom was available on his systems",
    "start": "2092960",
    "end": "2100079"
  },
  {
    "text": "and we offer swiss log a week they can use our code it's very much ready to be deployed into",
    "start": "2100079",
    "end": "2106800"
  },
  {
    "text": "production but uh seriously um it was uh very fun to do this research i think",
    "start": "2106800",
    "end": "2113040"
  },
  {
    "text": "it's very important to follow up on it and if you have any questions we'd be happy to answer in the q a there is more",
    "start": "2113040",
    "end": "2120000"
  },
  {
    "text": "information on our website armrest.com forward slash pondpiper and thank you for",
    "start": "2120000",
    "end": "2126800"
  },
  {
    "text": "listening to us",
    "start": "2126800",
    "end": "2130280"
  }
]