[
  {
    "text": "thank you for coming to my presentation uh this is nasdi uh systems that store network accessible shells uh I'm sure",
    "start": "40",
    "end": "6919"
  },
  {
    "text": "you can guess that the name comes from the network storage devices that I've assessed um",
    "start": "6919",
    "end": "14840"
  },
  {
    "text": "oops uh my name is Jacob hul I'm a security Analyst at independent security evaluators uh we're a us uh based",
    "start": "17279",
    "end": "24840"
  },
  {
    "text": "company out of uh Baltimore Maryland um again I'm an analyst and why",
    "start": "24840",
    "end": "31519"
  },
  {
    "text": "do I do this stuff because I love exploiting uh computer code so is the information I'm going to",
    "start": "31519",
    "end": "37719"
  },
  {
    "text": "share with you today really important uh absolutely and for a couple of reasons",
    "start": "37719",
    "end": "43800"
  },
  {
    "text": "uh the first being that 100 uh% of the devices that I evaluated uh were",
    "start": "43800",
    "end": "49360"
  },
  {
    "text": "vulnerable to exploitation and what I mean by that is I was able to uh execute",
    "start": "49360",
    "end": "55520"
  },
  {
    "text": "some form of code or commands on all 10 devices that I've looked at ranging from from a $200 device all the way up to a",
    "start": "55520",
    "end": "62719"
  },
  {
    "text": "several thousand device uh one thing that's unique about storage systems versus let's say routers uh is that the",
    "start": "62719",
    "end": "69680"
  },
  {
    "text": "manufacturers will develop one operating system just as an example here let's just say uh ready Nas operating system",
    "start": "69680",
    "end": "77479"
  },
  {
    "text": "uh six uh and that uh software will be used across an entire product line so",
    "start": "77479",
    "end": "83280"
  },
  {
    "text": "it's likely that if you find a vulnerability in one Nas system it's going to affect the the entire product",
    "start": "83280",
    "end": "88960"
  },
  {
    "text": "line uh made by that manufacturer in the case of net gear I looked at an $800 device and the vulnerabilities I found",
    "start": "88960",
    "end": "96200"
  },
  {
    "text": "affected their devices all the way up to 25 or $30,000 so yeah uh the next being",
    "start": "96200",
    "end": "103759"
  },
  {
    "text": "is storage systems or excuse me embedded device systems uh have been plagued with",
    "start": "103759",
    "end": "108880"
  },
  {
    "text": "vulnerabilities for ages um a lot of the codebase that's used in these systems um",
    "start": "108880",
    "end": "114759"
  },
  {
    "text": "is has been around since the late 80s uh early 90s uh so this code will be",
    "start": "114759",
    "end": "121119"
  },
  {
    "text": "disseminated to these manufacturers uh by from chipet manufacturers uh and they'll kind of tweak it you know to",
    "start": "121119",
    "end": "127520"
  },
  {
    "text": "their needs uh to make a working uh system um and these systems can and are",
    "start": "127520",
    "end": "134120"
  },
  {
    "text": "being exploited uh in the wild uh by remote malicious malware uh as was the",
    "start": "134120",
    "end": "140519"
  },
  {
    "text": "case with uh like the moonwell shock affected qap nases people",
    "start": "140519",
    "end": "147640"
  },
  {
    "text": "were exploiting this in the while for profit uh there was another instance where senology uh Naas platforms were",
    "start": "147640",
    "end": "154000"
  },
  {
    "text": "actually affected by an old vulnerability uh but it was ransomware to where it would exploit the device",
    "start": "154000",
    "end": "159480"
  },
  {
    "text": "then encrypt the file system and require users to pay money before they would be given the decryption",
    "start": "159480",
    "end": "165040"
  },
  {
    "text": "key so really quick the company I work for is ISC this is who we are we're just a bunch of hackers uh we break stuff and",
    "start": "165040",
    "end": "172760"
  },
  {
    "text": "we do it for Fortune 500 Enterprises um uh and predominantly the media and",
    "start": "172760",
    "end": "178040"
  },
  {
    "text": "entertainment industry our perspective itive is primarily white box uh we prefer to do uh kind of like the",
    "start": "178040",
    "end": "184040"
  },
  {
    "text": "blackbox assessment of a piece of software and then been give um design documentation and possibly source code",
    "start": "184040",
    "end": "191280"
  },
  {
    "text": "to uh further uncover any potential",
    "start": "191280",
    "end": "195480"
  },
  {
    "text": "vulnerabilities so these are the topics we're going to cover today um what are network storage devices uh the name is",
    "start": "196400",
    "end": "203000"
  },
  {
    "text": "uh pretty obvious some of the key players uh the functionality offered uh my exploit research and development um",
    "start": "203000",
    "end": "209519"
  },
  {
    "text": "when I presented at black hat USA uh I talked about this research as I'm currently in the midst of uh performing",
    "start": "209519",
    "end": "217000"
  },
  {
    "text": "and concluding my uh project um but I demonstrated individual vulnerabilities",
    "start": "217000",
    "end": "222720"
  },
  {
    "text": "in a series of devices uh today I'm actually going to uh demonstrate a weaponized version of those",
    "start": "222720",
    "end": "228879"
  },
  {
    "text": "vulnerabilities where I took uh several uh exploits that I have for three devices which I have here on stage and",
    "start": "228879",
    "end": "236280"
  },
  {
    "text": "rolled them into a software package that is essentially self-replicating uh so I've developed a proof of concept",
    "start": "236280",
    "end": "242480"
  },
  {
    "text": "warrant for these devices we're then going to talk about the absence of security and other systems and some",
    "start": "242480",
    "end": "248319"
  },
  {
    "text": "steps for mediation so really quick subject background uh these devices are",
    "start": "248319",
    "end": "253519"
  },
  {
    "text": "primarily used for data retention um really any internet-based service that you use today Gmail whether so if it's",
    "start": "253519",
    "end": "260519"
  },
  {
    "text": "email uh virtualization if it's a a desktop that you have access to over the Internet uh it's using some form of",
    "start": "260519",
    "end": "266960"
  },
  {
    "text": "backend um network storage uh some users are anyone from small",
    "start": "266960",
    "end": "272800"
  },
  {
    "text": "businesses and home users all the way up to like I said large Enterprises so here are some of the key",
    "start": "272800",
    "end": "278320"
  },
  {
    "text": "players in the market uh under the vendor uh bullet I did not evaluate",
    "start": "278320",
    "end": "283720"
  },
  {
    "text": "products from every one of these vendors but um most of them I did so quick list of the products that",
    "start": "283720",
    "end": "290919"
  },
  {
    "text": "I've evaluated I haven't published any of the vulnerabilities publicly I've actually",
    "start": "290919",
    "end": "296160"
  },
  {
    "text": "been trying to take extensive steps to work with the manufacturers and remediate remediating these issues uh",
    "start": "296160",
    "end": "301400"
  },
  {
    "text": "due to the possibility for Mass exploitation and the fact that these devices have been exploited in the",
    "start": "301400",
    "end": "307840"
  },
  {
    "text": "wild okay so system functionality uh in addition to just storing files uh these",
    "start": "307840",
    "end": "313720"
  },
  {
    "text": "systems have a plethora of Network Services and those Services range from simple uh telnet and FTP servers all the",
    "start": "313720",
    "end": "320000"
  },
  {
    "text": "way to web servers that have their own instances of PHP and WordPress um so really it's in addition to it storing",
    "start": "320000",
    "end": "327160"
  },
  {
    "text": "files it's like a a little server um and whether or not the applications are beneficial to uh like end users for",
    "start": "327160",
    "end": "335039"
  },
  {
    "text": "serving files or websites uh or not all of these systems have uh some form of uh",
    "start": "335039",
    "end": "341199"
  },
  {
    "text": "unnecessary uh service that's running for at least management purposes uh the biggest unnecessary service or",
    "start": "341199",
    "end": "348319"
  },
  {
    "text": "functionality offered by some of these devices is the cloud feature and when I say cloud feature yes it's buzzword but",
    "start": "348319",
    "end": "354680"
  },
  {
    "text": "I'm referring to these devices facilitating remote access without the need for n meaning that they make an",
    "start": "354680",
    "end": "360800"
  },
  {
    "text": "outbound connection to a third party uh being the manufacturers platform uh whatever it may be uh and then you'll",
    "start": "360800",
    "end": "367880"
  },
  {
    "text": "access their platform which will then give you access to your files so they act as the man- inth the- middle so to",
    "start": "367880",
    "end": "373400"
  },
  {
    "text": "speak for data access so exploit research and development these are some of the things",
    "start": "373400",
    "end": "379680"
  },
  {
    "text": "we'll talk about today uh I'm going to give you a brief uh summary of my results uh quickly talk about the",
    "start": "379680",
    "end": "385520"
  },
  {
    "text": "testing methodology which involves scanning and enumeration uh vulnerability Discovery and the",
    "start": "385520",
    "end": "390599"
  },
  {
    "text": "exploitation of discovered vulnerabilities and then the mass exploitation I like worms baby um and",
    "start": "390599",
    "end": "397720"
  },
  {
    "text": "exploit demos so the exploit demos and mass exploitation kind of tie together um as this time as I stated I'm doing a",
    "start": "397720",
    "end": "404960"
  },
  {
    "text": "worm demonstration instead of individual uh demos but when we get into absence of",
    "start": "404960",
    "end": "410039"
  },
  {
    "text": "security section I have a different device that I will exploit today so preliminary results as I stated",
    "start": "410039",
    "end": "418000"
  },
  {
    "text": "100% of the devices are suscep able to root compromise um at least 50% of them",
    "start": "418000",
    "end": "423080"
  },
  {
    "text": "as of right now can be exploited without authentication meaning that I can exploit them uh by performing an",
    "start": "423080",
    "end": "429599"
  },
  {
    "text": "authentication Bypass or there's an authorization bug where Pages uh uh",
    "start": "429599",
    "end": "435160"
  },
  {
    "text": "Pages rendered to uh end users do not require authentication to access uh and",
    "start": "435160",
    "end": "440800"
  },
  {
    "text": "they contain vulnerabilities so at this time uh I've received 22 cve numbers",
    "start": "440800",
    "end": "447080"
  },
  {
    "text": "from mitter um that's in contrast to the 56 uh cves I received last year for",
    "start": "447080",
    "end": "453400"
  },
  {
    "text": "publishing Soho router vulnerabilities um I've now I'm up to about 30 vulnerabilities uh I just",
    "start": "453400",
    "end": "459800"
  },
  {
    "text": "haven't requested cves for them and I am fairly confident that by the end of my research uh I will have surpassed the 56",
    "start": "459800",
    "end": "467759"
  },
  {
    "text": "cve mark that I achieved while researching routers hence the far worse than routers",
    "start": "467759",
    "end": "474360"
  },
  {
    "text": "bullet all right so testing methodology um we're going to cover these steps uh",
    "start": "474360",
    "end": "479840"
  },
  {
    "text": "scanning in enumeration uh it's your simple you know port scan discovering what's running on the Box by default",
    "start": "479840",
    "end": "486560"
  },
  {
    "text": "when I evaluated these I wanted to I basically was making an assumption that any of the extras that extra features",
    "start": "486560",
    "end": "493759"
  },
  {
    "text": "that were not installed by default end users weren't using so so far when I've uh started looking at these systems I I",
    "start": "493759",
    "end": "500199"
  },
  {
    "text": "haven't evaluated any of those features it's pretty much what comes uh on out of the",
    "start": "500199",
    "end": "505759"
  },
  {
    "text": "box so here I just have some end map syntax uh that was was used to discover open ports and then as we know um you",
    "start": "505759",
    "end": "513440"
  },
  {
    "text": "can't always trust the output of a port scan so I have uh an image of netcat there uh basically connecting to port",
    "start": "513440",
    "end": "521080"
  },
  {
    "text": "8080 and uh confirming that it is indeed an HTTP server so vulnerability",
    "start": "521080",
    "end": "528120"
  },
  {
    "text": "Discovery um vulnerability Discovery uh basically if you have a system running",
    "start": "528120",
    "end": "533920"
  },
  {
    "text": "Network Services and you want a probe to determine whether or not vulnerabilities exist you have to take several steps and",
    "start": "533920",
    "end": "539640"
  },
  {
    "text": "those steps being investigate any running Port that's on the system once a port has been determined to be open you",
    "start": "539640",
    "end": "545519"
  },
  {
    "text": "as an attacker or a researcher need to understand what's running on that Port how to communicate with the device on",
    "start": "545519",
    "end": "552200"
  },
  {
    "text": "set Port um if you determine that there is a port open and it's serving a web application you need to be familiar with",
    "start": "552200",
    "end": "558880"
  },
  {
    "text": "the web application what types of languages are used on the server side you know the and the client side um",
    "start": "558880",
    "end": "564640"
  },
  {
    "text": "static code analysis A lot of the software used on these systems and other embedded Electronics",
    "start": "564640",
    "end": "569959"
  },
  {
    "text": "are using GPL or any form of open- source uh software codebase which means",
    "start": "569959",
    "end": "575200"
  },
  {
    "text": "that you can go out to the manufacturer's website and in most cases download uh all of the code not all the",
    "start": "575200",
    "end": "581320"
  },
  {
    "text": "code but most of the code uh that runs on these uh systems and actually you'll kind of find that a lot of the code that",
    "start": "581320",
    "end": "587519"
  },
  {
    "text": "they don't include appears to be the most vulnerable maybe they do that on purpose I don't know and then of course",
    "start": "587519",
    "end": "593959"
  },
  {
    "text": "Dynamic analysis if you don't have source code or even if you do I like to do them simultaneously uh because it helps me feel uh I I get more coverage",
    "start": "593959",
    "end": "602720"
  },
  {
    "text": "during my audit if I throw a fuzzer at a port once I know the protocol and how to",
    "start": "602720",
    "end": "608160"
  },
  {
    "text": "operate with the port or interact with the uh the port I will then review source code as well so the fuzzer will",
    "start": "608160",
    "end": "613519"
  },
  {
    "text": "work and then I'll work and look at source code so Dynamic analysis is absolutely uh imperative to um any",
    "start": "613519",
    "end": "621399"
  },
  {
    "text": "application security assessment here are the types of",
    "start": "621399",
    "end": "626800"
  },
  {
    "text": "vulnerabilities I've discovered um um if you've noticed I haven't looked for a lot of like the",
    "start": "626800",
    "end": "632440"
  },
  {
    "text": "common things that you would find in oasp for instance injection vulnerabilities like sequel injection",
    "start": "632440",
    "end": "638200"
  },
  {
    "text": "more or less uh cross-site scripting and things of that nature uh any um less",
    "start": "638200",
    "end": "643800"
  },
  {
    "text": "severe vulnerability like an information disclosure I found as a result of looking for uh issues that would allow",
    "start": "643800",
    "end": "650480"
  },
  {
    "text": "me to execute code so I've been strictly trying to find vulnerabilities that an attacker could leverage uh to assume",
    "start": "650480",
    "end": "657920"
  },
  {
    "text": "full control of the system that's what my research has been about so I mentioned back doors I",
    "start": "657920",
    "end": "665600"
  },
  {
    "text": "believe in the last list uh I found a couple of them uh but the one that I'm highlighting specifically is in the",
    "start": "665600",
    "end": "671279"
  },
  {
    "text": "seate device uh there's actually an undocumented backd door user um on the",
    "start": "671279",
    "end": "676600"
  },
  {
    "text": "system uh that they don't talk about and I have it highlighted here this is the shadow file and as you can see there's",
    "start": "676600",
    "end": "682680"
  },
  {
    "text": "an old desz Crypt password we all know how secure Dez is uh meaning that this",
    "start": "682680",
    "end": "687959"
  },
  {
    "text": "user has access to the enre system you can access any management interface including the web interface and don't",
    "start": "687959",
    "end": "694079"
  },
  {
    "text": "quote me on this but I believe telnet uh was open uh by default meaning that if",
    "start": "694079",
    "end": "699360"
  },
  {
    "text": "you have this account and you're able to access port 23 or 80 TCP you had access to the system okay what does that do for",
    "start": "699360",
    "end": "706000"
  },
  {
    "text": "you well it gives you access to the management interface you can change you know DNS settings okay that's all fine",
    "start": "706000",
    "end": "711440"
  },
  {
    "text": "and dandy but you don't have a root shell well again the system is vulnerable to a command injection",
    "start": "711440",
    "end": "717000"
  },
  {
    "text": "vulnerability you have this user account you can exploit that command injection vulnerability which gives you Rude",
    "start": "717000",
    "end": "724240"
  },
  {
    "text": "access another great thing this is kind of a crypto uh base bug uh this was an",
    "start": "724800",
    "end": "730160"
  },
  {
    "text": "Asser Nas device and they had a session cookie okay good for them they're it's",
    "start": "730160",
    "end": "735399"
  },
  {
    "text": "using PHP uh but little uh did I know is they were generating their cookies uh",
    "start": "735399",
    "end": "742360"
  },
  {
    "text": "insecurely and how were they doing that well they were using time as a",
    "start": "742360",
    "end": "747920"
  },
  {
    "text": "seed uh so here I basically took a bunch of cookies like 20 made 20,000 requests",
    "start": "747920",
    "end": "753199"
  },
  {
    "text": "and I kind of wanted to determine the effective entropy pool of the generated cookie uh and the analysis tool in burp",
    "start": "753199",
    "end": "761000"
  },
  {
    "text": "uh indicated that the uh effective entropy was about two bits which is",
    "start": "761000",
    "end": "766040"
  },
  {
    "text": "absolutely terrible uh for instance today for password security NIS recommends at least 80 bits of security",
    "start": "766040",
    "end": "772199"
  },
  {
    "text": "to be cryptographically secure So This is highly insecure so it's hard for you guys to",
    "start": "772199",
    "end": "778760"
  },
  {
    "text": "see but right here uh I have a sample of the cookies and the high order bits I",
    "start": "778760",
    "end": "784240"
  },
  {
    "text": "actually have 53 DF uh those two bites are important for an upcoming slide so",
    "start": "784240",
    "end": "789880"
  },
  {
    "text": "just remember 53 DF so so here are some more charts um",
    "start": "789880",
    "end": "795920"
  },
  {
    "text": "kind of discussing or demonstrating or showing the uh uh the entropy of the",
    "start": "795920",
    "end": "802279"
  },
  {
    "text": "cookie the cookie was 16 characters long um and as you can see here uh character",
    "start": "802279",
    "end": "808959"
  },
  {
    "text": "uh 15 and 16 um change the most frequent while some of the earlier characters uh",
    "start": "808959",
    "end": "815959"
  },
  {
    "text": "do not uh and if you were thinking of you know some value you know that may have some form of repetitive pattern you",
    "start": "815959",
    "end": "822880"
  },
  {
    "text": "know with consistency the first thing that comes to mind is time um it's it's",
    "start": "822880",
    "end": "829120"
  },
  {
    "text": "sequential so quickly here to kind of you know see if my thought process was",
    "start": "829120",
    "end": "834480"
  },
  {
    "text": "you know in line andc correct I just wrote up some quick code here to",
    "start": "834480",
    "end": "839560"
  },
  {
    "text": "initialize a Time valve struct um and I'm calling get time of day and passing",
    "start": "839560",
    "end": "845279"
  },
  {
    "text": "at that struct to basically see uh the total number of seconds since uh",
    "start": "845279",
    "end": "852519"
  },
  {
    "text": "Epoch so when I compile and run this code as you can see seconds and hex 53",
    "start": "852720",
    "end": "858880"
  },
  {
    "text": "DF 53 DF is what we saw in the session cookies that's indicative of time being",
    "start": "858880",
    "end": "864399"
  },
  {
    "text": "used to see the generation of cookies which makes them highly insecure meaning that an attacker can effectively within",
    "start": "864399",
    "end": "871320"
  },
  {
    "text": "a uh deterministic uh amount of time or an easily achievable amount of time",
    "start": "871320",
    "end": "877160"
  },
  {
    "text": "guess and generate cookies of active sessions which means you've again assumed control of this",
    "start": "877160",
    "end": "883320"
  },
  {
    "text": "system so vulnerability exploitation um we're going to talk about command injection missing function",
    "start": "883320",
    "end": "889959"
  },
  {
    "text": "level access control and that's kind of a a vague term but it's something that oasp you know started talking about um",
    "start": "889959",
    "end": "897160"
  },
  {
    "text": "and I like to kind of keep terminology in line with you know what's standard out there uh just so people you know",
    "start": "897160",
    "end": "903720"
  },
  {
    "text": "aren't throwing around all these uh various terms and yeah all that jazz uh",
    "start": "903720",
    "end": "910199"
  },
  {
    "text": "specifically we're going to talk about authentication bypass and authorization bypass uh so while these two issues are",
    "start": "910199",
    "end": "915680"
  },
  {
    "text": "similar they are different uh authentication meaning that you've effectively bypassed authentication and",
    "start": "915680",
    "end": "921040"
  },
  {
    "text": "you've able to access resources that you should not have access to authorization meaning that it requires",
    "start": "921040",
    "end": "927519"
  },
  {
    "text": "authentication um but they the developer forgot to perform",
    "start": "927519",
    "end": "933000"
  },
  {
    "text": "the necessary uh privilege checks so maybe an unprivileged user can perform an administrative action and then stack",
    "start": "933000",
    "end": "940240"
  },
  {
    "text": "based buffer overflows code execution is my absolute favorite command injection is just as good but I'll tell you what",
    "start": "940240",
    "end": "945959"
  },
  {
    "text": "there's nothing like sitting in a debugger for hours and just looking at lines upon lines of memory I'm a",
    "start": "945959",
    "end": "953079"
  },
  {
    "text": "nerd all right so command injection um really quick just a definition it's",
    "start": "953079",
    "end": "959040"
  },
  {
    "text": "basically when you can execute operating system commands and I'm going to keep some of the stuff brief because I want to make sure we have time for uh the",
    "start": "959040",
    "end": "965600"
  },
  {
    "text": "demos uh been going for about 15 minutes so I think we're good some countermeasures so developers this is",
    "start": "965600",
    "end": "972279"
  },
  {
    "text": "important end users basically have no defense against this it is up to you to basically quit sucking um no that's",
    "start": "972279",
    "end": "979800"
  },
  {
    "text": "that's really not what it is a lot of it comes down to education and awareness uh so that's why you know I like to give",
    "start": "979800",
    "end": "985319"
  },
  {
    "text": "these talks I like to inform individuals on how to make more security your software that's my mission um so avoid",
    "start": "985319",
    "end": "992240"
  },
  {
    "text": "calling shell commands when possible a lot of the time there's an API provided for you that you can use in a secure way",
    "start": "992240",
    "end": "998399"
  },
  {
    "text": "instead of calling let's say system you know or execve basically any uh function",
    "start": "998399",
    "end": "1003959"
  },
  {
    "text": "or method depending on the type of language you're working with um that executes system",
    "start": "1003959",
    "end": "1010000"
  },
  {
    "text": "commands um and if an API does not exist two solutions one develop one yourself",
    "start": "1010000",
    "end": "1015839"
  },
  {
    "text": "and test it thoroughly and two uh if you have to absolutely use user input in a",
    "start": "1015839",
    "end": "1021319"
  },
  {
    "text": "function uh like system make sure it's properly sanitized and validated uh do",
    "start": "1021319",
    "end": "1027199"
  },
  {
    "text": "not take a blacklist approach always go Whit list always say I want this input",
    "start": "1027199",
    "end": "1032280"
  },
  {
    "text": "exactly and if the input Supply does not match a b or c reject",
    "start": "1032280",
    "end": "1037720"
  },
  {
    "text": "it so missing function level access control I briefly gave a description yes the picture uh the ABS it's the absence",
    "start": "1038400",
    "end": "1046120"
  },
  {
    "text": "of server side authorization checks essentially so again very simple just perform",
    "start": "1046120",
    "end": "1053360"
  },
  {
    "text": "authentication and authorization checks if there's a resource that needs authentication make sure that they have a valid session cookie or some form of",
    "start": "1053360",
    "end": "1060280"
  },
  {
    "text": "meth or authenticated method that you uh are requiring them to have um and then authorization checks if there's",
    "start": "1060280",
    "end": "1067000"
  },
  {
    "text": "administrator functionality and several different privilege uh uh several different privilege levels uh ensure",
    "start": "1067000",
    "end": "1073480"
  },
  {
    "text": "that each is properly segmented and that they can only access the required resources for their privilege level",
    "start": "1073480",
    "end": "1080240"
  },
  {
    "text": "buffer overflow like I said my favorite um basically uh depending on where",
    "start": "1080240",
    "end": "1085440"
  },
  {
    "text": "you're overflowing whether it's in the Heap or the stack um this will differ",
    "start": "1085440",
    "end": "1090600"
  },
  {
    "text": "but you always have a fixed size buffer which essentially is a region of memory",
    "start": "1090600",
    "end": "1095640"
  },
  {
    "text": "and more data is put into that buffer than what was allocated uh which would then by virtue of that overwrite",
    "start": "1095640",
    "end": "1101960"
  },
  {
    "text": "adjacent memory and cause data corruption uh which uh in most cases will give the attacker uh control of the",
    "start": "1101960",
    "end": "1109360"
  },
  {
    "text": "applications program flow so this is a screenshot of me debugging um a buffer overflow vulnerability on one of the nas",
    "start": "1109360",
    "end": "1116320"
  },
  {
    "text": "systems I will not be presenting this one today um but it does exist and the source code or the exploit code will be",
    "start": "1116320",
    "end": "1123720"
  },
  {
    "text": "released sometime in the future I have no idea but sometime I still owe a paper",
    "start": "1123720",
    "end": "1128880"
  },
  {
    "text": "my boss is getting on me for that um so some counter measures uh don't use",
    "start": "1128880",
    "end": "1134919"
  },
  {
    "text": "unsafe functions um we know some of the big names you know stir copy uh M Copy s",
    "start": "1134919",
    "end": "1141320"
  },
  {
    "text": "printf um just because you use Sten copy or SN printf just not mean that uh",
    "start": "1141320",
    "end": "1148159"
  },
  {
    "text": "you're actually um you've prevented a buffer overflow I can't tell you how many times I've gone through source code",
    "start": "1148159",
    "end": "1154520"
  },
  {
    "text": "and I've seen people use Sten copy wrong um to where they're actually saying oh",
    "start": "1154520",
    "end": "1160400"
  },
  {
    "text": "copy the copy uh this data into this buffer but copy the uh size of the the",
    "start": "1160400",
    "end": "1167799"
  },
  {
    "text": "supply data into to the buffer instead of at most the size of the buffer so you're essentially just use passing an",
    "start": "1167799",
    "end": "1174760"
  },
  {
    "text": "extra argument to send copy when it's really just a stir copy um and then",
    "start": "1174760",
    "end": "1180159"
  },
  {
    "text": "perform balance checking which is again just ensuring that no more uh data is copy to the buffer than what was",
    "start": "1180159",
    "end": "1186240"
  },
  {
    "text": "allocated and compile with link um comp uh compile SL link with overflow",
    "start": "1186240",
    "end": "1192559"
  },
  {
    "text": "prevention techniques and the big things are Canary and Stat cookies aslr and uh",
    "start": "1192559",
    "end": "1198320"
  },
  {
    "text": "data execution prevention or non-executable uh which is ngdb is enabled by default and I believe it is",
    "start": "1198320",
    "end": "1204400"
  },
  {
    "text": "in Visual Studio but don't quote me on that I'm a Linux fan here so Mass",
    "start": "1204400",
    "end": "1211000"
  },
  {
    "text": "exploitation um the nasy worm I've been trying to come up with the clever name for this I failed miserably so I'm just",
    "start": "1211000",
    "end": "1217080"
  },
  {
    "text": "calling it nasy worm um I'm going to exploit three devices today with this",
    "start": "1217080",
    "end": "1222320"
  },
  {
    "text": "worm uh the dlink DNS 345 the tradet tn2000 and the Western Digital mycloud",
    "start": "1222320",
    "end": "1228720"
  },
  {
    "text": "X4 and they're actually on the stage up here uh for those of you in the back you can't see them but if you're curious to what they look like they are up here you",
    "start": "1228720",
    "end": "1235159"
  },
  {
    "text": "can come see them in a little bit uh similar occurrences I've talked about them uh but just to quickly recap lynus",
    "start": "1235159",
    "end": "1241679"
  },
  {
    "text": "the moon worm uh that was the device or the worm that uh exploited lyus devices",
    "start": "1241679",
    "end": "1246799"
  },
  {
    "text": "that leverag command injection vulnerability um the qap shell shock",
    "start": "1246799",
    "end": "1252000"
  },
  {
    "text": "worm which was discovered in the Wild by fire eye uh I'm not sure if that's still running rampant on the web but it's very",
    "start": "1252000",
    "end": "1258280"
  },
  {
    "text": "possible and then I mentioned the Synology ransomware that encrypted the file",
    "start": "1258280",
    "end": "1263840"
  },
  {
    "text": "system so this is how my worm operates uh basically",
    "start": "1263840",
    "end": "1270120"
  },
  {
    "text": "it looks for open TCP 80 if it finds Port TCP 80 open it is then going to",
    "start": "1270279",
    "end": "1277640"
  },
  {
    "text": "perform a fingerprint and it does that by making a series of requests and parsing their responses based on the",
    "start": "1277640",
    "end": "1284480"
  },
  {
    "text": "data received from the uh Port 80 the server running on P 80 it determines if",
    "start": "1284480",
    "end": "1290240"
  },
  {
    "text": "it's one of these three systems if it determines uh that it uh that the port",
    "start": "1290240",
    "end": "1295400"
  },
  {
    "text": "80 is running on a vulnerable Target it exploits it once it's been exploited",
    "start": "1295400",
    "end": "1300520"
  },
  {
    "text": "using a command injection vulnerability it downloads and runs a copy of itself",
    "start": "1300520",
    "end": "1305640"
  },
  {
    "text": "um once uh the copy has been run um then the process just rinse and",
    "start": "1305640",
    "end": "1312080"
  },
  {
    "text": "repeats so the dlink exploit that's kind of a fun one um it's command injection with an authentication bypass",
    "start": "1312080",
    "end": "1319080"
  },
  {
    "text": "uh some of the challenges with this vulner or yeah with this vulnerability in developing the exploit was the fact",
    "start": "1319080",
    "end": "1324320"
  },
  {
    "text": "that there was no interactive shell so for the purpose of my worm the only thing that I'm doing is exploiting a",
    "start": "1324320",
    "end": "1330039"
  },
  {
    "text": "Target and then opening up a telet an unauthenticated telet uh on a various support that I uh specified in the",
    "start": "1330039",
    "end": "1336679"
  },
  {
    "text": "exploit code and then telling it to exploit others so with no interactive shell how am I going to you know have a",
    "start": "1336679",
    "end": "1344000"
  },
  {
    "text": "shell and telet well what I did was actually",
    "start": "1344000",
    "end": "1349039"
  },
  {
    "text": "uh create a shell script on the system uh a couple bytes at a time uh that",
    "start": "1349039",
    "end": "1354120"
  },
  {
    "text": "basically listened for user input and then echoed that input and then it was in an infinite Loop so I created a",
    "start": "1354120",
    "end": "1359919"
  },
  {
    "text": "pseudo shell so to speak and I used that as my shell so that got around the fact that I had no interactive shell um and",
    "start": "1359919",
    "end": "1366039"
  },
  {
    "text": "then I was able to essentially have the unauthenticated Tet server and full route access so that was a win fun",
    "start": "1366039",
    "end": "1372679"
  },
  {
    "text": "little trick the trended exploit again command injection uh and Authentication",
    "start": "1372679",
    "end": "1378520"
  },
  {
    "text": "by pass uh the challenge here was limited space for commands so I was injecting into a field I believe where",
    "start": "1378520",
    "end": "1385039"
  },
  {
    "text": "there was an IP address um and this system uh would only allow me to uh",
    "start": "1385039",
    "end": "1390600"
  },
  {
    "text": "include a couple of bytes for each command well there was no way that I was going to you know tell the system to do",
    "start": "1390600",
    "end": "1396360"
  },
  {
    "text": "everything I wanted I couldn't even spawn a tell in that shell uh with a couple command injection vulnerabilities so what I did was uh create again a",
    "start": "1396360",
    "end": "1403840"
  },
  {
    "text": "shell script in the file system but I literally did this two bytes at a time so I execute uh about a 100 different uh",
    "start": "1403840",
    "end": "1412279"
  },
  {
    "text": "commands by just echoing data into a file and then for each subsequent uh command it's just uh appending to that",
    "start": "1412279",
    "end": "1418799"
  },
  {
    "text": "file um and then once it's been fully written we execute it so this one takes",
    "start": "1418799",
    "end": "1423840"
  },
  {
    "text": "a while to exploit but I uh circumvent the uh challenge of limited space for",
    "start": "1423840",
    "end": "1430400"
  },
  {
    "text": "commands in my payload the Western Digital exploit this",
    "start": "1430400",
    "end": "1435600"
  },
  {
    "text": "one was face roll so uh basically it was a device that had a command injection",
    "start": "1435600",
    "end": "1442279"
  },
  {
    "text": "vulnerability in it h um but it was in a page that uh wasn't intended to be",
    "start": "1442279",
    "end": "1448480"
  },
  {
    "text": "exposed um in the web route it doesn't it does not require authentication uh and it's actually PHP code um I forget",
    "start": "1448480",
    "end": "1456480"
  },
  {
    "text": "the vulnerable function what they were using to execute commands but that's irrelevant uh for this demonstration um",
    "start": "1456480",
    "end": "1462679"
  },
  {
    "text": "and all I had to do is call it directly and I could put in whatever data I want so it's just one command and then all I",
    "start": "1462679",
    "end": "1468159"
  },
  {
    "text": "do is Win um so the worm demo uh all right so",
    "start": "1468159",
    "end": "1473360"
  },
  {
    "text": "what I'm going to do now is I'm actually going to go over to my VM uh and I'm going to show you that I am unable to",
    "start": "1473360",
    "end": "1478399"
  },
  {
    "text": "tell that into the three systems uh that we're going to exploit today um and then",
    "start": "1478399",
    "end": "1483880"
  },
  {
    "text": "I'm going to launch the worm and we'll talk about it while it",
    "start": "1483880",
    "end": "1489320"
  },
  {
    "text": "runs I think the first device that gets exploited is the tret device so it will definitely take a while so there's three",
    "start": "1489320",
    "end": "1496480"
  },
  {
    "text": "systems the first of which is 10 4242 as you can see we're unable to",
    "start": "1496480",
    "end": "1501600"
  },
  {
    "text": "connect the next system is uh 1.10 as you can see we're unable to",
    "start": "1501600",
    "end": "1509360"
  },
  {
    "text": "connect the next system is 1.20 wait hold on a second here 1.10 I",
    "start": "1509360",
    "end": "1516159"
  },
  {
    "text": "actually messed that up that should be 1.15 I apologize okay we're unable to connect",
    "start": "1516159",
    "end": "1523279"
  },
  {
    "text": "and then this one is 1.20 as you can see trying okay we have connected we're",
    "start": "1523279",
    "end": "1528880"
  },
  {
    "text": "unable to connect so what we're going to do now is actually exploit these systems",
    "start": "1528880",
    "end": "1534960"
  },
  {
    "text": "and sorry my resolution's all whacked I'm trying to find gosh darn",
    "start": "1534960",
    "end": "1541320"
  },
  {
    "text": "it all right here we go and H you guys can't read that we're",
    "start": "1541360",
    "end": "1546799"
  },
  {
    "text": "not going to talk about it that's just some of the fingerprint code I was going to show you the requests that were going to be sent uh during the test um so",
    "start": "1546799",
    "end": "1555080"
  },
  {
    "text": "let's see let's zoom in okay you guys can read that okay okay so this is the word um as you can see",
    "start": "1555080",
    "end": "1563600"
  },
  {
    "text": "192.168.1.1 uh error finding version information uh meaning it had Port 80 open but it was unable to uh determine",
    "start": "1563919",
    "end": "1571520"
  },
  {
    "text": "that it was or no it determined that it was a uh one of the devices not included my worm so it is not a vulnerable man",
    "start": "1571520",
    "end": "1578679"
  },
  {
    "text": "system and we're just going to go through various IP addresses until we find a port 80 here we go 1.10 uh",
    "start": "1578679",
    "end": "1586399"
  },
  {
    "text": "firmware version 1.0 detected this device is a trenet so we're exploiting the trenet device right now",
    "start": "1586399",
    "end": "1591799"
  },
  {
    "text": "and this is going to take a while um it's about 100 requests like I said uh once the system is exploited I'm going",
    "start": "1591799",
    "end": "1598399"
  },
  {
    "text": "to kill this instance of the worm the trenet device should be now compromised",
    "start": "1598399",
    "end": "1603559"
  },
  {
    "text": "I will tell net to it and I will show you that that I'm running a binary on the worm on the device called GDB that's",
    "start": "1603559",
    "end": "1610080"
  },
  {
    "text": "what I named my worm I have no idea why I just what I decided to call it when I was developing it and and I never recompile it again with my cross",
    "start": "1610080",
    "end": "1617120"
  },
  {
    "text": "compiler uh um and I will show you netstat output which actually will show it sending sin",
    "start": "1617120",
    "end": "1623559"
  },
  {
    "text": "packets to various IP addresses which is indicating that it is now running the code and it is scanning for vulnerable",
    "start": "1623559",
    "end": "1630320"
  },
  {
    "text": "systems um once it finds one this process that we see here is actually going to like I said uh repeat um and it",
    "start": "1630320",
    "end": "1639000"
  },
  {
    "text": "will go through and we will see that all three of these systems will eventually be uh exploited I did not Implement any",
    "start": "1639000",
    "end": "1646399"
  },
  {
    "text": "code that checks if a system was what it or not um so basically it's kind of like the Morris worm where it'll go around",
    "start": "1646399",
    "end": "1652880"
  },
  {
    "text": "out out on the internet it finds a port 80 if it's vulnerable then it exploits it um so multiple copies will be running",
    "start": "1652880",
    "end": "1659799"
  },
  {
    "text": "on the system which means you will have large amounts of network traffic large amounts of ARP traffic uh meaning that",
    "start": "1659799",
    "end": "1666080"
  },
  {
    "text": "you could use substantial bandwidth um and this is over three devices once they're all infected we'll kind of look",
    "start": "1666080",
    "end": "1672240"
  },
  {
    "text": "at wire shark and we'll see the amount of traffic flowing over the small Network that I have here consisting again of three devices",
    "start": "1672240",
    "end": "1678640"
  },
  {
    "text": "just think if we had tens upon uh tens of thousands of these systems if not hundreds uh thousands of these systems",
    "start": "1678640",
    "end": "1686480"
  },
  {
    "text": "um I mean you would essentially have a very large and Powerful botn net um and with uh such great power you could you",
    "start": "1686480",
    "end": "1693399"
  },
  {
    "text": "could cause serious harm um just imagine being able to take down parts of the internet infrastructure um and like I",
    "start": "1693399",
    "end": "1700000"
  },
  {
    "text": "said last year I performed research on Soho routers all those systems those",
    "start": "1700000",
    "end": "1705080"
  },
  {
    "text": "exploits could be tied into this worm as well and now you're targeting Nas systems you're targeting worms you could",
    "start": "1705080",
    "end": "1710399"
  },
  {
    "text": "Target any system that you want uh and control them in a botn net these systems don't run AV they aren't using the",
    "start": "1710399",
    "end": "1717000"
  },
  {
    "text": "latest memory protections uh to prevent buffer overflows uh they're using outdated code um and just all in all",
    "start": "1717000",
    "end": "1724679"
  },
  {
    "text": "poor design practices which makes them great targets uh for attackers um forget",
    "start": "1724679",
    "end": "1730480"
  },
  {
    "text": "attacking computer systems these days these are the devices that will be exploited in the future because they",
    "start": "1730480",
    "end": "1736159"
  },
  {
    "text": "give you direct access to a network and from there you can then launch further attacks on people whether they're client",
    "start": "1736159",
    "end": "1742039"
  },
  {
    "text": "side attacks uh against browsers that now gives you access to the computer these are going to be the stepping Point",
    "start": "1742039",
    "end": "1747440"
  },
  {
    "text": "into any network so as Dan gear said during the black hat USA keynote he could take down",
    "start": "1747440",
    "end": "1754399"
  },
  {
    "text": "the internet with this and so could you um you definitely could you know people are out there they're monetizing off the",
    "start": "1754399",
    "end": "1760600"
  },
  {
    "text": "fact that these systems are highly vulnerable so it's absolutely critical that uh we take action in securing them",
    "start": "1760600",
    "end": "1767399"
  },
  {
    "text": "and urging developers uh at these L large uh manufacturers to uh come up",
    "start": "1767399",
    "end": "1773559"
  },
  {
    "text": "with a great quality assurance process uh and secure development life cycle uh",
    "start": "1773559",
    "end": "1779000"
  },
  {
    "text": "to ensure code is secure moving",
    "start": "1779000",
    "end": "1782919"
  },
  {
    "text": "forward so we're almost done um then this then the trend net",
    "start": "1784440",
    "end": "1789480"
  },
  {
    "text": "will have been successfully exploited that's if the demo gods don't decide to rain hell on",
    "start": "1789480",
    "end": "1796159"
  },
  {
    "text": "me okay so exploit has been completed we're just going to quickly stop that let me find that tell in that window um",
    "start": "1796159",
    "end": "1803559"
  },
  {
    "text": "that was 1.10 so I should be able to connect to it now as you can see bam we",
    "start": "1803559",
    "end": "1808799"
  },
  {
    "text": "have a shell so if we ID it we are root so I've successfully received root on",
    "start": "1808799",
    "end": "1814240"
  },
  {
    "text": "this now remember I've told you that the pro oops the process was named GDB so if",
    "start": "1814240",
    "end": "1819440"
  },
  {
    "text": "we PS and we grip for GDB",
    "start": "1819440",
    "end": "1824799"
  },
  {
    "text": "um uhoh I think I may forgot to start my web server",
    "start": "1824799",
    "end": "1831200"
  },
  {
    "text": "guys I didn't oh yeah thank you I got really",
    "start": "1832480",
    "end": "1837640"
  },
  {
    "text": "nervous for a second uh but no net antp",
    "start": "1837640",
    "end": "1843399"
  },
  {
    "text": "grabon I don't think I started my web server so that's going to be some total fail",
    "start": "1843399",
    "end": "1851200"
  },
  {
    "text": "uh okay so I do have GDB",
    "start": "1856919",
    "end": "1863200"
  },
  {
    "text": "dosar okay so what we'll do is I'm actually going to just run this",
    "start": "1863200",
    "end": "1870960"
  },
  {
    "text": "again um and then while that's going I will continue my presentation and we will come",
    "start": "1870960",
    "end": "1876880"
  },
  {
    "text": "back let me just make sure it goes let me make sure I can hit my web",
    "start": "1876880",
    "end": "1882679"
  },
  {
    "text": "server too",
    "start": "1882679",
    "end": "1889919"
  },
  {
    "text": "okay so there it is okay so that's exploiting so we'll go",
    "start": "1897600",
    "end": "1903200"
  },
  {
    "text": "back to the presentation now um how am I doing on",
    "start": "1903200",
    "end": "1908840"
  },
  {
    "text": "time does anyone know no maybe not all right well so while the plague spreads",
    "start": "1910120",
    "end": "1915639"
  },
  {
    "text": "time for mopon so the case study for the the Buffalo uh I didn't bring the Buffalo but this is another system that",
    "start": "1915639",
    "end": "1920760"
  },
  {
    "text": "was vulnerable uh this one is uh command injection and a uh unauthorized API call",
    "start": "1920760",
    "end": "1927399"
  },
  {
    "text": "meaning that it's missing its authorization check this is a missing function level Access Control vulnerability uh this one's a pre-record",
    "start": "1927399",
    "end": "1934080"
  },
  {
    "text": "a video so I will go over it um and I may click through it to kind of speed it up so what I'm doing here is logging in",
    "start": "1934080",
    "end": "1941480"
  },
  {
    "text": "as the administrator user",
    "start": "1941480",
    "end": "1946159"
  },
  {
    "text": "um 10 minutes 20 okay great oh hey how you doing um so you can see that I've",
    "start": "1946559",
    "end": "1952399"
  },
  {
    "text": "log in here and I have a sid value this value is used in the Json RPC API uh",
    "start": "1952399",
    "end": "1958600"
  },
  {
    "text": "which is used in all calls uh to the uh application running on the file server",
    "start": "1958600",
    "end": "1965000"
  },
  {
    "text": "um so now I'm logging out I just wanted to show you that I logged in and that we have that uh Sid value uh the admin is a",
    "start": "1965000",
    "end": "1971440"
  },
  {
    "text": "default account and there is a second default account called the guest account and that account is used to facilitate",
    "start": "1971440",
    "end": "1977120"
  },
  {
    "text": "access to files um that you want to give people access to so it's just guest and",
    "start": "1977120",
    "end": "1984240"
  },
  {
    "text": "guest I don't believe the password can be changed for this account um and you",
    "start": "1984240",
    "end": "1989799"
  },
  {
    "text": "can log in and you'll be given access to limited functionality so they're limiting you from what you can do and",
    "start": "1989799",
    "end": "1995960"
  },
  {
    "text": "they are actually very good you can't access other Pages uh you don't have the ability to arbitrarily call uh available",
    "start": "1995960",
    "end": "2003200"
  },
  {
    "text": "apis that are only accessible by an administrator for the most part so as",
    "start": "2003200",
    "end": "2008320"
  },
  {
    "text": "you can see here we have a user ID of 20 that's important because um we're going",
    "start": "2008320",
    "end": "2013440"
  },
  {
    "text": "to use that information later quickly I'm demonstrating we cannot tet to the 1.7 178 address or the 1. Yeah 178 and I",
    "start": "2013440",
    "end": "2023320"
  },
  {
    "text": "am showing you again we have the Sid token so really quick I have this request in the burp repeater and that's",
    "start": "2023320",
    "end": "2030320"
  },
  {
    "text": "a different token uh that I had at one point in time we're going to call the user. edit method and we're going to",
    "start": "2030320",
    "end": "2037279"
  },
  {
    "text": "change the password for group IDs 52 52 was not the guest user ID that we just",
    "start": "2037279",
    "end": "2043279"
  },
  {
    "text": "saw okay so we called that and invalid session ID all right we need to have one",
    "start": "2043279",
    "end": "2048839"
  },
  {
    "text": "of these Sid values well I'm going to take the guest Sid value and we're going to throw it into uh that request and",
    "start": "2048839",
    "end": "2054480"
  },
  {
    "text": "fired",
    "start": "2054480",
    "end": "2056919"
  },
  {
    "text": "off we call it again and result null bang okay we have an ID now that's",
    "start": "2060480",
    "end": "2066000"
  },
  {
    "text": "completely different well it seems that the device executed my request well for every setting that you change there is",
    "start": "2066000",
    "end": "2072358"
  },
  {
    "text": "another request that needs to be sent which basically is an apply settings and that's the method we're calling here",
    "start": "2072359",
    "end": "2077878"
  },
  {
    "text": "which says okay anything that any state that we just changed apply it and then use it you know from and then on so we",
    "start": "2077879",
    "end": "2084839"
  },
  {
    "text": "call that and as you can see we got a job ID so bam admin password has now been changed we're going to log out of",
    "start": "2084839",
    "end": "2090919"
  },
  {
    "text": "the guest account we're going to then log in with the admin account using our uh change password pwned 1337",
    "start": "2090919",
    "end": "2098240"
  },
  {
    "text": "once we're logged in we're now going to exploit the command injection vulnerability that I was unable to call",
    "start": "2098240",
    "end": "2104440"
  },
  {
    "text": "um without admin privileges and we will assume full root privileges on the",
    "start": "2104440",
    "end": "2110280"
  },
  {
    "text": "system so I'm just showing you pwn 137 I copied it and pasted it just so there",
    "start": "2110280",
    "end": "2116000"
  },
  {
    "text": "was no confusion as to what I was typing and voila we're in so there is an authorization bug uh where a guest user",
    "start": "2116000",
    "end": "2123400"
  },
  {
    "text": "was able to call an API that was only meant to be access ible by an admin",
    "start": "2123400",
    "end": "2129079"
  },
  {
    "text": "which gives you control of the system so now we're just executing telet um D here",
    "start": "2129079",
    "end": "2136480"
  },
  {
    "text": "in the IP address field using command substitution and as you can see we'll T",
    "start": "2136480",
    "end": "2141920"
  },
  {
    "text": "it to the system ID root so we've went from uh the guest account all the way to",
    "start": "2141920",
    "end": "2148640"
  },
  {
    "text": "root uh by manipulating a authorization bug and then a command injection bug so",
    "start": "2148640",
    "end": "2155800"
  },
  {
    "text": "win all right so next is uh the absence of security um in addition to these",
    "start": "2155800",
    "end": "2162079"
  },
  {
    "text": "systems like I've mentioned already uh embedded electronics are plagued with vulnerabilities uh some examples are IP",
    "start": "2162079",
    "end": "2169200"
  },
  {
    "text": "cameras uh layer three routers like the one that I have there and we'll actually demonstrate that uh exploiting that",
    "start": "2169200",
    "end": "2175960"
  },
  {
    "text": "today if I don't run out of time um which that's not the focus of my talks if we don't get to it it's okay um and",
    "start": "2175960",
    "end": "2182560"
  },
  {
    "text": "then network storage systems so absence of security I mentioned 50 six cve",
    "start": "2182560",
    "end": "2188319"
  },
  {
    "text": "numbers uh here are some links to the research on my company's web page that",
    "start": "2188319",
    "end": "2193960"
  },
  {
    "text": "uh I performed last year um there is a technical report uh a vulnerability",
    "start": "2193960",
    "end": "2199000"
  },
  {
    "text": "catalog that has uh a plethora of vulnerabilities uh most of which are or",
    "start": "2199000",
    "end": "2204760"
  },
  {
    "text": "have exploit code uh on the internet and then just some other information about",
    "start": "2204760",
    "end": "2209920"
  },
  {
    "text": "the study so the case study um we're actually going to quickly check on the",
    "start": "2209920",
    "end": "2216040"
  },
  {
    "text": "worm before we get into the exploitation of the assus uh so it looks like we should have",
    "start": "2216040",
    "end": "2225040"
  },
  {
    "text": "exploited yeah so I think this was exploited so now",
    "start": "2225920",
    "end": "2233000"
  },
  {
    "text": "hopefully oh man what is going",
    "start": "2233000",
    "end": "2240000"
  },
  {
    "text": "on I changed the IP addresses on these this",
    "start": "2246520",
    "end": "2252319"
  },
  {
    "text": "morning maybe I shouldn't have done that",
    "start": "2252319",
    "end": "2256880"
  },
  {
    "text": "crap oops wrong system W apologize",
    "start": "2266880",
    "end": "2273200"
  },
  {
    "text": "guys so I am 1.77 I'm just going to quickly check this source code that I",
    "start": "2273200",
    "end": "2278920"
  },
  {
    "text": "have here uh oh I go out to 1.6 that's why I'm",
    "start": "2278920",
    "end": "2286760"
  },
  {
    "text": "such a fool okay well while I have this up we will do the exploitation of the um",
    "start": "2286760",
    "end": "2294119"
  },
  {
    "text": "the router and then we'll go back to the worm so really quick here",
    "start": "2294119",
    "end": "2301720"
  },
  {
    "text": "umh we are going to exploit the NT n56u which this is an ass router this",
    "start": "2302680",
    "end": "2308200"
  },
  {
    "text": "overflow uh exists on any ASUS router running the Asus wrt firmware um it is a",
    "start": "2308200",
    "end": "2316440"
  },
  {
    "text": "myips architecture system uh which means we have to use return oriented programming to exploit it uh there was",
    "start": "2316440",
    "end": "2323480"
  },
  {
    "text": "limited space for memory uh uh restricted in Bad characters and in order to exploit this there are multiple",
    "start": "2323480",
    "end": "2330000"
  },
  {
    "text": "stages of Shell Code um I had to jump to the stack perform a stack pivot uh and",
    "start": "2330000",
    "end": "2335920"
  },
  {
    "text": "then I am able to execute my R shell so here's the vulnerable code um I'm not going to go over it for the sake of time",
    "start": "2335920",
    "end": "2342560"
  },
  {
    "text": "but I have an S printf command uh and that was the culprit uh of the Overflow",
    "start": "2342560",
    "end": "2348319"
  },
  {
    "text": "uh and it took data both apps name and apps flag you could use either of those to trigger this overflow and shoved it",
    "start": "2348319",
    "end": "2354920"
  },
  {
    "text": "into command which you can see is a uh character array of 128 bytes so here's",
    "start": "2354920",
    "end": "2361160"
  },
  {
    "text": "the rock chain that I use to exploit this system um and this basically",
    "start": "2361160",
    "end": "2366720"
  },
  {
    "text": "performs every thing I said sets up memory correctly and allows me to execute the Shell",
    "start": "2366720",
    "end": "2371800"
  },
  {
    "text": "Code uh here is the reverse Shell Shell Code that I wrote uh for myips little",
    "start": "2371800",
    "end": "2377640"
  },
  {
    "text": "Indian uh that will allow me to gain access to the system it's going to connect back down one .177 on Port",
    "start": "2377640",
    "end": "2386119"
  },
  {
    "text": "31337 and that's my problem why my worm is not working that's what my IP address was set to when I was testing this",
    "start": "2386119",
    "end": "2392000"
  },
  {
    "text": "earlier um the worm supposed to connect back to 1. uh 106",
    "start": "2392000",
    "end": "2398000"
  },
  {
    "text": "so here's quickly the demo of that um hopefully this won't fail me here uh but",
    "start": "2398000",
    "end": "2403760"
  },
  {
    "text": "we'll come over here and we will do just oops netcat uh listen veros on Port",
    "start": "2403760",
    "end": "2410800"
  },
  {
    "text": "31337 um we're listening um and now if we actually run this uh this is a",
    "start": "2410800",
    "end": "2418560"
  },
  {
    "text": "vulnerability I've published online I haven't talked about it at a conference uh so that's why I chose this one as you",
    "start": "2418560",
    "end": "2424000"
  },
  {
    "text": "can see the cve number is from 2013 um 192168",
    "start": "2424000",
    "end": "2429800"
  },
  {
    "text": "1.1 oops HTTP",
    "start": "2429800",
    "end": "2435040"
  },
  {
    "text": "192.168.1.1 um determine that it was a vulnerable Target yes we want to use authentication this is an authenticated",
    "start": "2435760",
    "end": "2442319"
  },
  {
    "text": "uh vulnerability now there is a password disclosure issue on this system where you can call a page without",
    "start": "2442319",
    "end": "2448400"
  },
  {
    "text": "authentication and the JavaScript will actually return uh uh the password to",
    "start": "2448400",
    "end": "2453520"
  },
  {
    "text": "you um now a way that you can kind of thwart and attacker from leveraging that to exploit you is change your username",
    "start": "2453520",
    "end": "2460160"
  },
  {
    "text": "it actually does not reveal the username but it reveals the password so I whatever um so in this",
    "start": "2460160",
    "end": "2468640"
  },
  {
    "text": "case it's admin and the password I believe is isse um so it's sting or sending the",
    "start": "2468640",
    "end": "2476680"
  },
  {
    "text": "request and Bam connect back so ID oops ID isn't on device gosh darn it you",
    "start": "2476680",
    "end": "2484119"
  },
  {
    "text": "name- a as you can see there we have a root shell um and to show you that it's root Shadow requires root access we can",
    "start": "2484119",
    "end": "2490800"
  },
  {
    "text": "read it so we're root on this system uh this that router that I have there is owned uh now when they compile um when",
    "start": "2490800",
    "end": "2499839"
  },
  {
    "text": "they compile the uh firmware uh oops when they compile the firmware for the",
    "start": "2499839",
    "end": "2506760"
  },
  {
    "text": "various routers the offsets of the libraries will be different meaning that this exploit is not Universal you would",
    "start": "2506760",
    "end": "2513040"
  },
  {
    "text": "actually have to get the memory address or the Base address of the various libraries uh change those out and then",
    "start": "2513040",
    "end": "2519200"
  },
  {
    "text": "you'd be able to exploit any system because the off offsets are the same so it's really about just determining the",
    "start": "2519200",
    "end": "2524599"
  },
  {
    "text": "Base address so now third times a charm right",
    "start": "2524599",
    "end": "2529960"
  },
  {
    "text": "192.1681 106 that's the IP address and if we just confirm here W get 106 GDB",
    "start": "2529960",
    "end": "2538040"
  },
  {
    "text": "it's hard for you guys to see but that's uh where uh the code is going to call out to um oh my gosh where is my",
    "start": "2538040",
    "end": "2545599"
  },
  {
    "text": "terminal okay we're going to kill my sh uh and we're going to quickly just deter",
    "start": "2545599",
    "end": "2551079"
  },
  {
    "text": "or confirm that we can get to 106 and we can great now and now we're going to run",
    "start": "2551079",
    "end": "2558319"
  },
  {
    "text": "this I want to see that it hits my Target and if it does I will finish up the presentation uh so we don't run out",
    "start": "2558319",
    "end": "2564160"
  },
  {
    "text": "of time and yeah all that",
    "start": "2564160",
    "end": "2572040"
  },
  {
    "text": "jazz um so again this is what we're just going through IP addresses until it finds a Target on Port",
    "start": "2572040",
    "end": "2578680"
  },
  {
    "text": "80 and I'm as you can tell from my troubles I'm downloading a copy of the warrant for myself uh for the sake of my",
    "start": "2578680",
    "end": "2585079"
  },
  {
    "text": "demonstration I decided to do that way for ease of use to ensure that there were no problems of course I have a",
    "start": "2585079",
    "end": "2591359"
  },
  {
    "text": "problem that I shouldn't have used two different IP addresses that's my fault um but what I want to do uh and probably",
    "start": "2591359",
    "end": "2598160"
  },
  {
    "text": "will do because I'm actually going to develop this further uh is have the worm download a copy of itself from the",
    "start": "2598160",
    "end": "2604760"
  },
  {
    "text": "infector so there won't be a central server that is serving a copy of the worm um and then uh also a code that I",
    "start": "2604760",
    "end": "2614160"
  },
  {
    "text": "don't have now that I'm putting in um is any device that gets infected it's actually going to reach out and say hey",
    "start": "2614160",
    "end": "2619640"
  },
  {
    "text": "I'm infected you can reach me here um so I'll have some form of uh minor uh like",
    "start": "2619640",
    "end": "2626119"
  },
  {
    "text": "CNC uh Channel but this isn't for nefarious purposes I don't want people using it for those purposes um which I",
    "start": "2626119",
    "end": "2633240"
  },
  {
    "text": "can't prevent once I release it in the wild or sorry provide the source code to",
    "start": "2633240",
    "end": "2638800"
  },
  {
    "text": "you people I'm not releasing it in the wild um yeah had to",
    "start": "2638800",
    "end": "2644240"
  },
  {
    "text": "clarify so with the exploitation of that router and talking about the absence of security in uh various uh embedded",
    "start": "2644240",
    "end": "2651640"
  },
  {
    "text": "electronics that brings me to so hopelessly broken um this was the name of my uh talk last year when I presented",
    "start": "2651640",
    "end": "2658319"
  },
  {
    "text": "the router research uh we kept that brand as it started to become very strong and uh known about um known about",
    "start": "2658319",
    "end": "2666880"
  },
  {
    "text": "uh and we developed a contest in partnership with the eff and we hosted our first event at Defcon um and we",
    "start": "2666880",
    "end": "2674559"
  },
  {
    "text": "invited researchers to come and exploit uh various routers and publish their findings for cash prizes and other",
    "start": "2674559",
    "end": "2681480"
  },
  {
    "text": "goodies uh it was a hit people enjoyed it so we are continuing to host them uh",
    "start": "2681480",
    "end": "2687800"
  },
  {
    "text": "we've done one at derbycon uh there'll be one at bides uh Washington DC which",
    "start": "2687800",
    "end": "2693400"
  },
  {
    "text": "is actually this weekend and in the future uh touron these are all USA based",
    "start": "2693400",
    "end": "2698640"
  },
  {
    "text": "uh conferences if it gets big enough and there's interest who knows maybe we'll do it uh at some of the international",
    "start": "2698640",
    "end": "2704000"
  },
  {
    "text": "conferences like black at Europe um",
    "start": "2704000",
    "end": "2709040"
  },
  {
    "text": "remediation uh really there isn't a whole lot that you can do uh as a consumer the biggest thing for vendors",
    "start": "2709040",
    "end": "2715520"
  },
  {
    "text": "is to have transparent patch management uh modern operating systems these days have a way to update automatically uh I",
    "start": "2715520",
    "end": "2723440"
  },
  {
    "text": "understand that critical systems are not updated automatically in the Enterprise setting but that doesn't mean that they",
    "start": "2723440",
    "end": "2730160"
  },
  {
    "text": "can't apply patches or at least have secure code to apply to their production systems but the home user should have",
    "start": "2730160",
    "end": "2737280"
  },
  {
    "text": "the ability to have their systems updated automatically um and then the security",
    "start": "2737280",
    "end": "2742640"
  },
  {
    "text": "principles Services shouldn't be running as root it makes it way too easy to gain root on a system there's very little",
    "start": "2742640",
    "end": "2748839"
  },
  {
    "text": "that you have to do for privilege escalation uh and then it's imperative that you incorporate uh security into",
    "start": "2748839",
    "end": "2755160"
  },
  {
    "text": "the design of your system don't try to B Security on once you develop a project or a product you need to think about it",
    "start": "2755160",
    "end": "2760760"
  },
  {
    "text": "from the ground up okay so thanks that's my uh",
    "start": "2760760",
    "end": "2765960"
  },
  {
    "text": "presentation um really quick we'll I guess check the worm uh which is about done here so fingers crossed uh and",
    "start": "2765960",
    "end": "2774640"
  },
  {
    "text": "while this is running I'll I'll talk about this but I'll open up the floor to questions do I have any questions yes in",
    "start": "2774640",
    "end": "2781680"
  },
  {
    "text": "terms of protection as long as manufacturers don't don't improve their security for",
    "start": "2781680",
    "end": "2788920"
  },
  {
    "text": "Reas some initiatives to create so inclusion prevention or Inus detection",
    "start": "2794160",
    "end": "2799680"
  },
  {
    "text": "devices for home networks",
    "start": "2799680",
    "end": "2806319"
  },
  {
    "text": "iner as poal way to your embed elect",
    "start": "2810440",
    "end": "2818839"
  },
  {
    "text": "um you're absolutely right um and while I do U feel that that could you know",
    "start": "2825800",
    "end": "2832520"
  },
  {
    "text": "help just like any IDs or IPS a lot of the big organizations feel that oh if I",
    "start": "2832520",
    "end": "2838440"
  },
  {
    "text": "take this Hardware Appliance and I throw it in my network and I ensure that it's up to date that there's no way that an attacker could exploit my system or get",
    "start": "2838440",
    "end": "2845079"
  },
  {
    "text": "into my uh uh get into my network that is really a fallacy for many reasons",
    "start": "2845079",
    "end": "2851680"
  },
  {
    "text": "while there is heris uh detection and it is getting better um and it will only improve over time it's still all",
    "start": "2851680",
    "end": "2858440"
  },
  {
    "text": "signature based and signatures are easily bypassed in most cases of antivirus software a signature is a",
    "start": "2858440",
    "end": "2865160"
  },
  {
    "text": "couple of bytes that are searched for uh within a file um and if you can alter",
    "start": "2865160",
    "end": "2870760"
  },
  {
    "text": "those btes uh and basically a change the let's say md5 sum you know the signature",
    "start": "2870760",
    "end": "2875839"
  },
  {
    "text": "of the file um um then it will no longer be detected by antivirus software which essentially renders those Solutions",
    "start": "2875839",
    "end": "2882280"
  },
  {
    "text": "useless uh while they will thwart a lot of like the standard um attacks um they",
    "start": "2882280",
    "end": "2888880"
  },
  {
    "text": "aren't bulletproof you know they aren't",
    "start": "2888880",
    "end": "2892599"
  },
  {
    "text": "bulletproof it could yes right so my worm they could basically figure out what I'm looking for and then build that",
    "start": "2899839",
    "end": "2905880"
  },
  {
    "text": "into the system um but they can't there's things that I can do or other attackers can do to",
    "start": "2905880",
    "end": "2912160"
  },
  {
    "text": "circumvent that you know by um implementing forms of encryption",
    "start": "2912160",
    "end": "2917680"
  },
  {
    "text": "changing uh the way that my worm acts and behaves uh performing uh series of",
    "start": "2917680",
    "end": "2923640"
  },
  {
    "text": "different like let's say Port knocking you know to try and determine if an IPS is running or an IDs and if it sees that",
    "start": "2923640",
    "end": "2930280"
  },
  {
    "text": "system it'll behave differently to circumvent its protections um while they can help uh I think it's you know just",
    "start": "2930280",
    "end": "2937880"
  },
  {
    "text": "like any other IPS or IDS system and it's not necessarily the end all solution it",
    "start": "2937880",
    "end": "2943920"
  },
  {
    "text": "comes back to the developers needing to develop secure code just like the usage of aslr nonex executable stack um stack",
    "start": "2943920",
    "end": "2952280"
  },
  {
    "text": "cookies and canaries uh does not prohibit the exploitation of memory corruption bugs ids's and ipss will not",
    "start": "2952280",
    "end": "2959440"
  },
  {
    "text": "prevent the exploitation of networks and",
    "start": "2959440",
    "end": "2963798"
  },
  {
    "text": "software uh any other questions I mean you guys can see I have a GDB running",
    "start": "2965720",
    "end": "2971200"
  },
  {
    "text": "now so I have R ww GDB",
    "start": "2971200",
    "end": "2976640"
  },
  {
    "text": "uh yes we do have GDB but I'm not exploiting other systems",
    "start": "2979079",
    "end": "2986040"
  },
  {
    "text": "yet and if I grip for sin I don't see it so it's very possible that I'm exploiting this this very system again",
    "start": "2986040",
    "end": "2994920"
  },
  {
    "text": "um okay so we're going to wait because this will be the first system that exploits",
    "start": "2995640",
    "end": "3001079"
  },
  {
    "text": "so this runs when it downloads a copy of it itself it runs the same code that I ran meaning that this trend net will be",
    "start": "3001079",
    "end": "3007000"
  },
  {
    "text": "the first device exploited it takes 100 requests if there's currently a session",
    "start": "3007000",
    "end": "3012280"
  },
  {
    "text": "open we're not going to see the sin that I'm looking for but I do [Music]",
    "start": "3012280",
    "end": "3018520"
  },
  {
    "text": "see that there's a fin weight here for connection to 1.10 that's me",
    "start": "3018520",
    "end": "3028640"
  },
  {
    "text": "yeah well any more questions yes",
    "start": "3030359",
    "end": "3036720"
  },
  {
    "text": "mention sorry to interrupt you but there we go there's a sin so now we're going to 1.7 Port adnin so the worm code is",
    "start": "3039440",
    "end": "3046160"
  },
  {
    "text": "running um and it's running on this system and it's going to continue Port scanning and looking for devices uh once",
    "start": "3046160",
    "end": "3053240"
  },
  {
    "text": "it finds it it's going to then exploit them and it will run on others okay back to you",
    "start": "3053240",
    "end": "3059760"
  },
  {
    "text": "sorry so no I didn't find any port knocking back doors but I haven't looked extensively yet um I pretty much looked",
    "start": "3063119",
    "end": "3069960"
  },
  {
    "text": "at one facet of these systems which is the web server and the applications uh so far uh but I have found some back",
    "start": "3069960",
    "end": "3076520"
  },
  {
    "text": "doors that were in actually uh a system uh that had init scripts that started up",
    "start": "3076520",
    "end": "3083240"
  },
  {
    "text": "and if you made a certain request to a ser it made a backup copy of the password",
    "start": "3083240",
    "end": "3089400"
  },
  {
    "text": "and Shadow file and then rewrote it with a new copy that actually had an undocumented user um so that's something",
    "start": "3089400",
    "end": "3096319"
  },
  {
    "text": "kind of like the port knocking back door but not",
    "start": "3096319",
    "end": "3100160"
  },
  {
    "text": "quite they no at least I haven't been notified uh all of the vendors have had",
    "start": "3103319",
    "end": "3109720"
  },
  {
    "text": "more than 30 days um to address these issues uh a lot of them uh have only",
    "start": "3109720",
    "end": "3116119"
  },
  {
    "text": "contacted can be once saying okay thank you for the report we'll pass it basically up the chain to our security team and I haven't heard anything more",
    "start": "3116119",
    "end": "3123000"
  },
  {
    "text": "from them um So currently because I don't believe that these are uh P I",
    "start": "3123000",
    "end": "3128520"
  },
  {
    "text": "haven't released the individual exploit uh source code and I also have not release the source code uh for this worm",
    "start": "3128520",
    "end": "3135160"
  },
  {
    "text": "and I probably won't I say probably I probably will not until uh they have been patched because it's not my goal",
    "start": "3135160",
    "end": "3142640"
  },
  {
    "text": "you know for people to get owned even though I do find it kind of hilarious",
    "start": "3142640",
    "end": "3148520"
  },
  {
    "text": "um yeah so gripping for sin again it is running um and it's looking at so we",
    "start": "3149359",
    "end": "3157440"
  },
  {
    "text": "should have exploited GDB okay as you can see there's two",
    "start": "3157440",
    "end": "3162480"
  },
  {
    "text": "copies running on this guy now and then we come over here bam we have a shell on 1.15 we ID it PS grip GDB bam GDB is",
    "start": "3162480",
    "end": "3171160"
  },
  {
    "text": "running we come over here one oh whoops hold on this is one do 20 at",
    "start": "3171160",
    "end": "3178720"
  },
  {
    "text": "120 maybe I haven't exploited this one",
    "start": "3180200",
    "end": "3184760"
  },
  {
    "text": "yet it is running all",
    "start": "3188000",
    "end": "3194839"
  },
  {
    "text": "right well for some reason I just fail horribly it is 42",
    "start": "3194839",
    "end": "3200760"
  },
  {
    "text": "42 1921 1681 20 42 42 and you guys see",
    "start": "3204359",
    "end": "3209599"
  },
  {
    "text": "me hitting 1.20 4242 well for whatever reason my T isn't",
    "start": "3209599",
    "end": "3215599"
  },
  {
    "text": "connecting on that one but we can see that I never connected to 1.15 when I",
    "start": "3215599",
    "end": "3220720"
  },
  {
    "text": "ran my worm I didn't let it exploit 1.15 1.15 has been infected",
    "start": "3220720",
    "end": "3226839"
  },
  {
    "text": "um uh twice and it is uh again Port",
    "start": "3226839",
    "end": "3232960"
  },
  {
    "text": "scanning um and looking for vulnerable targets you can see we have a sin uh",
    "start": "3232960",
    "end": "3239559"
  },
  {
    "text": "actually why is it going up there um we have a sin uh sent",
    "start": "3239559",
    "end": "3247440"
  },
  {
    "text": "oops so yeah the worm's running on multiple systems um we can see that there's now",
    "start": "3247440",
    "end": "3254079"
  },
  {
    "text": "three sins sent to different targets I got three instances running on this system we have self-propagating software",
    "start": "3254079",
    "end": "3259599"
  },
  {
    "text": "here and it works reliably against all of these devices um yeah and I actually",
    "start": "3259599",
    "end": "3265920"
  },
  {
    "text": "built it in a modularized way uh that makes it easy right now for me uh and",
    "start": "3265920",
    "end": "3272160"
  },
  {
    "text": "anyone familiar with the source to tie in uh fingerprints so request to fingerprint different ports and then",
    "start": "3272160",
    "end": "3278520"
  },
  {
    "text": "also exploits the exploits I'm doing basically with the header file which is uh consisting of calling uh a function",
    "start": "3278520",
    "end": "3286119"
  },
  {
    "text": "pointer which points to a declared function in a uh separate header file and that separate header file will be an",
    "start": "3286119",
    "end": "3292280"
  },
  {
    "text": "entire exploit so I have plans to do this whether I would will or will not uh",
    "start": "3292280",
    "end": "3297839"
  },
  {
    "text": "depends on my workload um and my ambition in the coming months but I'm going to continue the modularize build",
    "start": "3297839",
    "end": "3303640"
  },
  {
    "text": "and maybe release it in such a way that it would be easy for people to tie in their own fingerprints and exploits and",
    "start": "3303640",
    "end": "3309000"
  },
  {
    "text": "use it like a framework later um because I feel something like this can help on penetration tests for red teamers but I",
    "start": "3309000",
    "end": "3316480"
  },
  {
    "text": "don't know if I'm going to do that for sure it's just something that I've thought about so if you guys are interested in anything like that you know or having this modularized in a way",
    "start": "3316480",
    "end": "3323599"
  },
  {
    "text": "where you can use it for your own engagements or whatever um just drop me I don't know a message",
    "start": "3323599",
    "end": "3328799"
  },
  {
    "text": "on Twitter or email and tell me I should do it and if I get enough people I probably will do it",
    "start": "3328799",
    "end": "3335799"
  },
  {
    "text": "so so yeah that's that's it I mean it's running maybe we'll get this other guy",
    "start": "3335799",
    "end": "3341039"
  },
  {
    "text": "here I don't know why I haven't hit this one yet um again I changed the IP addresses but whatever so yeah that's my",
    "start": "3341039",
    "end": "3347079"
  },
  {
    "text": "presentation thanks for",
    "start": "3347079",
    "end": "3349960"
  },
  {
    "text": "coming",
    "start": "3352160",
    "end": "3355160"
  }
]