[
  {
    "text": "okay so well thanks for joining me this",
    "start": "240",
    "end": "4040"
  },
  {
    "text": "afternoon um this session well every",
    "start": "4040",
    "end": "7279"
  },
  {
    "text": "Everything really is in uh in the title",
    "start": "7279",
    "end": "10599"
  },
  {
    "text": "uh what it is about it is about hiding",
    "start": "10599",
    "end": "13559"
  },
  {
    "text": "Android",
    "start": "13559",
    "end": "14839"
  },
  {
    "text": "applications in images you've got it",
    "start": "14839",
    "end": "18720"
  },
  {
    "text": "right so if you don't know what Android",
    "start": "18720",
    "end": "21080"
  },
  {
    "text": "e is it's time to just run off of course",
    "start": "21080",
    "end": "25680"
  },
  {
    "text": "um that's the only prerequisite for for",
    "start": "25680",
    "end": "28000"
  },
  {
    "text": "the talk actually",
    "start": "28000",
    "end": "31480"
  },
  {
    "text": "I am Exel uh I'm working for fortunet as",
    "start": "31480",
    "end": "34960"
  },
  {
    "text": "an antivirus U researcher and this work",
    "start": "34960",
    "end": "38440"
  },
  {
    "text": "is also done with an albertini who",
    "start": "38440",
    "end": "41280"
  },
  {
    "text": "couldn't join us uh the today at black",
    "start": "41280",
    "end": "45160"
  },
  {
    "text": "hat uh but he told me that he would be",
    "start": "45160",
    "end": "47800"
  },
  {
    "text": "on Twitter if you want to twit and ask",
    "start": "47800",
    "end": "50920"
  },
  {
    "text": "him a few questions there no",
    "start": "50920",
    "end": "53920"
  },
  {
    "text": "problem we'll go straight to the point",
    "start": "53920",
    "end": "57039"
  },
  {
    "text": "so what's this",
    "start": "57039",
    "end": "60039"
  },
  {
    "text": "any",
    "start": "60039",
    "end": "62239"
  },
  {
    "text": "idea okay so well it's Anakin Skywalker",
    "start": "63640",
    "end": "67560"
  },
  {
    "text": "for Star Wars fan and otherwise it's",
    "start": "67560",
    "end": "71040"
  },
  {
    "text": "just an image okay I didn't expect that",
    "start": "71040",
    "end": "74080"
  },
  {
    "text": "you'd see it's a PNG image but that's",
    "start": "74080",
    "end": "77200"
  },
  {
    "text": "what it is and uh it's just a perfectly",
    "start": "77200",
    "end": "80479"
  },
  {
    "text": "normal PNG image normal Heather displays",
    "start": "80479",
    "end": "84799"
  },
  {
    "text": "all right nothing really special with it",
    "start": "84799",
    "end": "88240"
  },
  {
    "text": "except of course it's more than an image",
    "start": "88240",
    "end": "91600"
  },
  {
    "text": "it's also a valid Android application",
    "start": "91600",
    "end": "95280"
  },
  {
    "text": "provided you decrypt it with the right",
    "start": "95280",
    "end": "97479"
  },
  {
    "text": "key okay so the same image can also be a",
    "start": "97479",
    "end": "101600"
  },
  {
    "text": "valid",
    "start": "101600",
    "end": "104600"
  },
  {
    "text": "application why would we be doing this",
    "start": "106360",
    "end": "109439"
  },
  {
    "text": "well um if we have a look at the",
    "start": "109439",
    "end": "112600"
  },
  {
    "text": "adversary side which is what we'll",
    "start": "112600",
    "end": "114759"
  },
  {
    "text": "obviously do at a black hat uh just",
    "start": "114759",
    "end": "117640"
  },
  {
    "text": "think if somebody has a malicious pay",
    "start": "117640",
    "end": "120079"
  },
  {
    "text": "load and the application and then well",
    "start": "120079",
    "end": "123799"
  },
  {
    "text": "he wants to um to make it invisible to",
    "start": "123799",
    "end": "127399"
  },
  {
    "text": "uh the reverse engineer like me and",
    "start": "127399",
    "end": "130160"
  },
  {
    "text": "that's just a perfect way to do it",
    "start": "130160",
    "end": "132360"
  },
  {
    "text": "because whatever API call to Android or",
    "start": "132360",
    "end": "136400"
  },
  {
    "text": "to delic or whatever the Dex headers",
    "start": "136400",
    "end": "139160"
  },
  {
    "text": "things like that everything will of that",
    "start": "139160",
    "end": "141319"
  },
  {
    "text": "will be invisible because it's",
    "start": "141319",
    "end": "143400"
  },
  {
    "text": "encrypted so you don't see anything at",
    "start": "143400",
    "end": "145840"
  },
  {
    "text": "all you don't see that there's an",
    "start": "145840",
    "end": "148160"
  },
  {
    "text": "application you don't see the resources",
    "start": "148160",
    "end": "150280"
  },
  {
    "text": "you don't see the",
    "start": "150280",
    "end": "151800"
  },
  {
    "text": "assets You Don't See Much except a",
    "start": "151800",
    "end": "155720"
  },
  {
    "text": "picture the only thing that you do see",
    "start": "155720",
    "end": "158000"
  },
  {
    "text": "actually is well that image that I",
    "start": "158000",
    "end": "161000"
  },
  {
    "text": "showed at the beginning of Anakin is a",
    "start": "161000",
    "end": "163360"
  },
  {
    "text": "little bit fat it's a 300 by 300 pixel",
    "start": "163360",
    "end": "168120"
  },
  {
    "text": "and it's like 500k for that so that's a",
    "start": "168120",
    "end": "171840"
  },
  {
    "text": "little bit kind of",
    "start": "171840",
    "end": "174080"
  },
  {
    "text": "unusual um the other thing that you'll",
    "start": "174080",
    "end": "177840"
  },
  {
    "text": "probably be seeing also is the the code",
    "start": "177840",
    "end": "180800"
  },
  {
    "text": "that is actually transforming that PNG",
    "start": "180800",
    "end": "183120"
  },
  {
    "text": "image one way or another and uh to",
    "start": "183120",
    "end": "187400"
  },
  {
    "text": "decrypt it and install the new payload",
    "start": "187400",
    "end": "191200"
  },
  {
    "text": "application but of course this wrapping",
    "start": "191200",
    "end": "194519"
  },
  {
    "text": "kind of mechanism can be OB fiscated you",
    "start": "194519",
    "end": "197760"
  },
  {
    "text": "can use um some known hacks like you",
    "start": "197760",
    "end": "201000"
  },
  {
    "text": "know using Dex class loader on in",
    "start": "201000",
    "end": "203319"
  },
  {
    "text": "Androids to conceal that as well if you",
    "start": "203319",
    "end": "207879"
  },
  {
    "text": "want so then",
    "start": "208280",
    "end": "211080"
  },
  {
    "text": "if it",
    "start": "211080",
    "end": "213360"
  },
  {
    "text": "works",
    "start": "215319",
    "end": "216920"
  },
  {
    "text": "so I've got an Android",
    "start": "216920",
    "end": "221080"
  },
  {
    "text": "emulator which is gone over",
    "start": "221080",
    "end": "225120"
  },
  {
    "text": "here come back here there we go that's",
    "start": "225120",
    "end": "228480"
  },
  {
    "text": "just an Android emulator of",
    "start": "228480",
    "end": "232200"
  },
  {
    "text": "4.4.2 and that's my directory in there I",
    "start": "232640",
    "end": "236280"
  },
  {
    "text": "have a make file because I don't like to",
    "start": "236280",
    "end": "238200"
  },
  {
    "text": "type too many long lines",
    "start": "238200",
    "end": "240599"
  },
  {
    "text": "during a demo but and that's the only",
    "start": "240599",
    "end": "243439"
  },
  {
    "text": "thing there's there and then well my",
    "start": "243439",
    "end": "245920"
  },
  {
    "text": "application the proof of concept",
    "start": "245920",
    "end": "247799"
  },
  {
    "text": "application the goal of this proof of",
    "start": "247799",
    "end": "250079"
  },
  {
    "text": "concept is just to show that I can",
    "start": "250079",
    "end": "251840"
  },
  {
    "text": "really do I can really transform the",
    "start": "251840",
    "end": "254400"
  },
  {
    "text": "image of Anakin into an",
    "start": "254400",
    "end": "257720"
  },
  {
    "text": "application we'll have a look at",
    "start": "257720",
    "end": "260320"
  },
  {
    "text": "that proof of",
    "start": "260320",
    "end": "262280"
  },
  {
    "text": "concept we unzip it it's really a",
    "start": "262280",
    "end": "265759"
  },
  {
    "text": "standard tool it's just a a kind of",
    "start": "265759",
    "end": "267600"
  },
  {
    "text": "script to do it a little bit quicker I",
    "start": "267600",
    "end": "269720"
  },
  {
    "text": "and zip it and then I run a decompiler",
    "start": "269720",
    "end": "272240"
  },
  {
    "text": "in that case it's um pryan decompiler if",
    "start": "272240",
    "end": "275560"
  },
  {
    "text": "you know about that",
    "start": "275560",
    "end": "277280"
  },
  {
    "text": "one and",
    "start": "277280",
    "end": "280280"
  },
  {
    "text": "zipping the",
    "start": "280280",
    "end": "282440"
  },
  {
    "text": "application there it",
    "start": "282440",
    "end": "285560"
  },
  {
    "text": "goes so well an Android package U you",
    "start": "285560",
    "end": "289240"
  },
  {
    "text": "probably see all know that it's just a",
    "start": "289240",
    "end": "291280"
  },
  {
    "text": "zip and inside there we have well plenty",
    "start": "291280",
    "end": "294000"
  },
  {
    "text": "of things the Android manifest in our",
    "start": "294000",
    "end": "296400"
  },
  {
    "text": "case we are interested in the assets if",
    "start": "296400",
    "end": "299919"
  },
  {
    "text": "I go in there I see that image anakin.",
    "start": "299919",
    "end": "305280"
  },
  {
    "text": "PNG it is an image as file says no",
    "start": "305320",
    "end": "309080"
  },
  {
    "text": "problem I can even give you a look of",
    "start": "309080",
    "end": "312479"
  },
  {
    "text": "this",
    "start": "312479",
    "end": "313800"
  },
  {
    "text": "one and there we get again the image of",
    "start": "313800",
    "end": "319159"
  },
  {
    "text": "Anakin okay now we're going to have a",
    "start": "322120",
    "end": "324479"
  },
  {
    "text": "look at the decompiled code which is",
    "start": "324479",
    "end": "328080"
  },
  {
    "text": "stored in the decompiled directory so",
    "start": "328080",
    "end": "331360"
  },
  {
    "text": "it's",
    "start": "331360",
    "end": "332840"
  },
  {
    "text": "in",
    "start": "332840",
    "end": "334680"
  },
  {
    "text": "there there's just one file of Interest",
    "start": "334680",
    "end": "338360"
  },
  {
    "text": "which is the pock activity proof of",
    "start": "338360",
    "end": "340240"
  },
  {
    "text": "concept activity very nice",
    "start": "340240",
    "end": "344000"
  },
  {
    "text": "name and it is very simple because and",
    "start": "344000",
    "end": "349360"
  },
  {
    "text": "uh basically just one thing inter string",
    "start": "349360",
    "end": "351440"
  },
  {
    "text": "there the the method on create you can",
    "start": "351440",
    "end": "354800"
  },
  {
    "text": "see",
    "start": "354800",
    "end": "356600"
  },
  {
    "text": "there um I'm displaying a few stuff",
    "start": "356600",
    "end": "360240"
  },
  {
    "text": "that's not very interesting I am reading",
    "start": "360240",
    "end": "364080"
  },
  {
    "text": "the the image anakin. PNG and displaying",
    "start": "364080",
    "end": "368000"
  },
  {
    "text": "it then there's a button and if we click",
    "start": "368000",
    "end": "372000"
  },
  {
    "text": "on the",
    "start": "372000",
    "end": "372710"
  },
  {
    "text": "[Music]",
    "start": "372710",
    "end": "375839"
  },
  {
    "text": "button I read the asset anakin. PNG put",
    "start": "376000",
    "end": "380759"
  },
  {
    "text": "that in a bite",
    "start": "380759",
    "end": "382960"
  },
  {
    "text": "array decrypt",
    "start": "382960",
    "end": "384960"
  },
  {
    "text": "it with the key mind you Anakin equals",
    "start": "384960",
    "end": "388759"
  },
  {
    "text": "dark dark side",
    "start": "388759",
    "end": "391000"
  },
  {
    "text": "okay write the result into a",
    "start": "391000",
    "end": "394560"
  },
  {
    "text": "file and install that application right",
    "start": "394560",
    "end": "399360"
  },
  {
    "text": "just to show you that I'm not cheating",
    "start": "399360",
    "end": "400919"
  },
  {
    "text": "for that uh for that proof of",
    "start": "400919",
    "end": "404880"
  },
  {
    "text": "concept that's all there",
    "start": "404880",
    "end": "408639"
  },
  {
    "text": "is go",
    "start": "408880",
    "end": "412240"
  },
  {
    "text": "back to the root directory and I'm going",
    "start": "412840",
    "end": "416240"
  },
  {
    "text": "to",
    "start": "416240",
    "end": "418280"
  },
  {
    "text": "install the",
    "start": "418280",
    "end": "421520"
  },
  {
    "text": "up hopefully it will",
    "start": "428759",
    "end": "432440"
  },
  {
    "text": "work so it's on my my laptop is a little",
    "start": "432599",
    "end": "436160"
  },
  {
    "text": "bit slow but it's success",
    "start": "436160",
    "end": "440960"
  },
  {
    "text": "cool and that's the emulator maybe it's",
    "start": "441039",
    "end": "444240"
  },
  {
    "text": "a bit small so I've got the screen",
    "start": "444240",
    "end": "445879"
  },
  {
    "text": "magnifier if you want to see a bit",
    "start": "445879",
    "end": "447639"
  },
  {
    "text": "better there it is that that's um the",
    "start": "447639",
    "end": "451039"
  },
  {
    "text": "the application I have just install po",
    "start": "451039",
    "end": "452840"
  },
  {
    "text": "activity with kind of the not very nice",
    "start": "452840",
    "end": "456080"
  },
  {
    "text": "icon of",
    "start": "456080",
    "end": "457840"
  },
  {
    "text": "Anakin I double click on",
    "start": "457840",
    "end": "461840"
  },
  {
    "text": "that it displays here the image the PNG",
    "start": "464120",
    "end": "468560"
  },
  {
    "text": "of Anakin and if I click on the button",
    "start": "468560",
    "end": "471919"
  },
  {
    "text": "well we have to wait a little bit but",
    "start": "471919",
    "end": "473479"
  },
  {
    "text": "eventually it will decrypt the image see",
    "start": "473479",
    "end": "478000"
  },
  {
    "text": "that that's an an application and",
    "start": "478000",
    "end": "480520"
  },
  {
    "text": "install it that's what we get I say yes",
    "start": "480520",
    "end": "485440"
  },
  {
    "text": "install and while I'm doing this this is",
    "start": "485440",
    "end": "488120"
  },
  {
    "text": "a little bit to see a little bit more",
    "start": "488120",
    "end": "489720"
  },
  {
    "text": "that's the payload inside which has been",
    "start": "489720",
    "end": "492000"
  },
  {
    "text": "decrypted and is going to be installed",
    "start": "492000",
    "end": "495159"
  },
  {
    "text": "install",
    "start": "495159",
    "end": "497720"
  },
  {
    "text": "there um it's not that uh it's really",
    "start": "504400",
    "end": "507879"
  },
  {
    "text": "intensive but I think that's a my CPU is",
    "start": "507879",
    "end": "511280"
  },
  {
    "text": "not very",
    "start": "511280",
    "end": "514120"
  },
  {
    "text": "quick so there it is it's",
    "start": "514919",
    "end": "519399"
  },
  {
    "text": "installed and we can even open",
    "start": "519399",
    "end": "523640"
  },
  {
    "text": "it so that's the payload uh application",
    "start": "523920",
    "end": "527760"
  },
  {
    "text": "which is completely hidden in the in the",
    "start": "527760",
    "end": "530720"
  },
  {
    "text": "wrapper and you've just installed Darth",
    "start": "530720",
    "end": "532720"
  },
  {
    "text": "Vader right okay so notice that uh",
    "start": "532720",
    "end": "536760"
  },
  {
    "text": "actually the the image of Darth Vader",
    "start": "536760",
    "end": "538760"
  },
  {
    "text": "for instance you you couldn't see it in",
    "start": "538760",
    "end": "541240"
  },
  {
    "text": "the zip of the initial wrapping",
    "start": "541240",
    "end": "543640"
  },
  {
    "text": "application at all no nothing visible",
    "start": "543640",
    "end": "548560"
  },
  {
    "text": "there so there it is it works and we'll",
    "start": "548560",
    "end": "552600"
  },
  {
    "text": "go back",
    "start": "552600",
    "end": "554079"
  },
  {
    "text": "here to the um application",
    "start": "554079",
    "end": "558200"
  },
  {
    "text": "center just to show you last final thing",
    "start": "558200",
    "end": "561240"
  },
  {
    "text": "is that we sh we see now two different",
    "start": "561240",
    "end": "563640"
  },
  {
    "text": "applications the wrapping applications",
    "start": "563640",
    "end": "566000"
  },
  {
    "text": "that was the first one and the one we've",
    "start": "566000",
    "end": "568760"
  },
  {
    "text": "just installed",
    "start": "568760",
    "end": "570040"
  },
  {
    "text": "there with Darth",
    "start": "570040",
    "end": "573120"
  },
  {
    "text": "fader there back to the",
    "start": "573920",
    "end": "578440"
  },
  {
    "text": "slides oh well that's in case it crashed",
    "start": "578920",
    "end": "581880"
  },
  {
    "text": "it did not",
    "start": "581880",
    "end": "584680"
  },
  {
    "text": "so I guess you were interested in it to",
    "start": "585519",
    "end": "588279"
  },
  {
    "text": "see how it it works so there's four",
    "start": "588279",
    "end": "592600"
  },
  {
    "text": "steps first one is you've got of course",
    "start": "592600",
    "end": "595079"
  },
  {
    "text": "to write your payload application right",
    "start": "595079",
    "end": "598240"
  },
  {
    "text": "so there's no special limit to that you",
    "start": "598240",
    "end": "600600"
  },
  {
    "text": "write whatever you want but then you've",
    "start": "600600",
    "end": "603360"
  },
  {
    "text": "got to encrypt it and you're going to",
    "start": "603360",
    "end": "605680"
  },
  {
    "text": "encrypt it you using a special tool that",
    "start": "605680",
    "end": "608240"
  },
  {
    "text": "an uh implemented which is called an",
    "start": "608240",
    "end": "611120"
  },
  {
    "text": "cryption and we chose to have it look to",
    "start": "611120",
    "end": "614360"
  },
  {
    "text": "have it look like Anakin Skywalker but",
    "start": "614360",
    "end": "616920"
  },
  {
    "text": "you can choose whatever PNG you you like",
    "start": "616920",
    "end": "619040"
  },
  {
    "text": "if you want to have I don't know the",
    "start": "619040",
    "end": "620279"
  },
  {
    "text": "image of black hat it works as well no",
    "start": "620279",
    "end": "623760"
  },
  {
    "text": "problem then we do a little bit of",
    "start": "623760",
    "end": "625839"
  },
  {
    "text": "hacking because it's black hat and well",
    "start": "625839",
    "end": "629800"
  },
  {
    "text": "you implement whatever method you",
    "start": "629800",
    "end": "632079"
  },
  {
    "text": "mechanism you can think of to",
    "start": "632079",
    "end": "635079"
  },
  {
    "text": "install uh that um that PNG and decrypt",
    "start": "635079",
    "end": "638560"
  },
  {
    "text": "it and install it whatever way you want",
    "start": "638560",
    "end": "642440"
  },
  {
    "text": "that's kind of besides the the topic",
    "start": "642440",
    "end": "646320"
  },
  {
    "text": "there right so if we think a little bit",
    "start": "646959",
    "end": "651760"
  },
  {
    "text": "uh of what we have to do we have an",
    "start": "651760",
    "end": "654680"
  },
  {
    "text": "Android package which is the payload so",
    "start": "654680",
    "end": "657000"
  },
  {
    "text": "this is where we have Darth Vader",
    "start": "657000",
    "end": "659959"
  },
  {
    "text": "and we want that when we encrypt it to",
    "start": "659959",
    "end": "662720"
  },
  {
    "text": "look like uh the the image of Anakin",
    "start": "662720",
    "end": "666279"
  },
  {
    "text": "Skywalker so we have the plain text and",
    "start": "666279",
    "end": "669920"
  },
  {
    "text": "we want it to look like a specific",
    "start": "669920",
    "end": "672040"
  },
  {
    "text": "Cipher text so in other words we want to",
    "start": "672040",
    "end": "675920"
  },
  {
    "text": "control encryption is this possible well",
    "start": "675920",
    "end": "679079"
  },
  {
    "text": "at first sight of course it does not",
    "start": "679079",
    "end": "680560"
  },
  {
    "text": "look possible because I don't know if",
    "start": "680560",
    "end": "682200"
  },
  {
    "text": "you've ever tried but whenever you",
    "start": "682200",
    "end": "684079"
  },
  {
    "text": "change either a single bite of uh a",
    "start": "684079",
    "end": "687200"
  },
  {
    "text": "plain text or uh single bite of a key",
    "start": "687200",
    "end": "690920"
  },
  {
    "text": "well you get a cipher text which is",
    "start": "690920",
    "end": "692480"
  },
  {
    "text": "totally different here you've got on the",
    "start": "692480",
    "end": "695440"
  },
  {
    "text": "left hand side the plain text and on the",
    "start": "695440",
    "end": "698839"
  },
  {
    "text": "right hand side the cipher text you see",
    "start": "698839",
    "end": "701240"
  },
  {
    "text": "they look totally different and there's",
    "start": "701240",
    "end": "703360"
  },
  {
    "text": "absolutely no way that the cipher text",
    "start": "703360",
    "end": "705279"
  },
  {
    "text": "can look like a valid",
    "start": "705279",
    "end": "708320"
  },
  {
    "text": "image so it looks",
    "start": "708680",
    "end": "711360"
  },
  {
    "text": "really difficult to uh to control the",
    "start": "711360",
    "end": "714639"
  },
  {
    "text": "the output and um also it looks really",
    "start": "714639",
    "end": "719800"
  },
  {
    "text": "difficult to see whenever you're",
    "start": "719800",
    "end": "720959"
  },
  {
    "text": "changing a single bite in the plain text",
    "start": "720959",
    "end": "723240"
  },
  {
    "text": "to see how much this is going to impact",
    "start": "723240",
    "end": "725720"
  },
  {
    "text": "and where this is going to impact the",
    "start": "725720",
    "end": "728079"
  },
  {
    "text": "cipher text so it looks really difficult",
    "start": "728079",
    "end": "730120"
  },
  {
    "text": "but of course it is possible otherwise I",
    "start": "730120",
    "end": "732320"
  },
  {
    "text": "wouldn't be showing it because there's a",
    "start": "732320",
    "end": "734639"
  },
  {
    "text": "trick we're using a trick there the",
    "start": "734639",
    "end": "738279"
  },
  {
    "text": "trick is that we are not exactly going",
    "start": "738279",
    "end": "742360"
  },
  {
    "text": "to install the Darth fader payloads",
    "start": "742360",
    "end": "746000"
  },
  {
    "text": "exactly the one that we see but",
    "start": "746000",
    "end": "747800"
  },
  {
    "text": "something that will look the same to",
    "start": "747800",
    "end": "750920"
  },
  {
    "text": "Android and we are not going to display",
    "start": "750920",
    "end": "753760"
  },
  {
    "text": "the image of Anakin Skywalk Skywalker",
    "start": "753760",
    "end": "757160"
  },
  {
    "text": "sorry but an image that will look like",
    "start": "757160",
    "end": "760040"
  },
  {
    "text": "the same to our eyes Okay so by",
    "start": "760040",
    "end": "762800"
  },
  {
    "text": "manipulating those small minor",
    "start": "762800",
    "end": "765160"
  },
  {
    "text": "differences on the plain text and on the",
    "start": "765160",
    "end": "767279"
  },
  {
    "text": "cipher text we manage to get something",
    "start": "767279",
    "end": "770519"
  },
  {
    "text": "that matches with the key that we that",
    "start": "770519",
    "end": "772800"
  },
  {
    "text": "we",
    "start": "772800",
    "end": "773519"
  },
  {
    "text": "select that's the way to do",
    "start": "773519",
    "end": "777399"
  },
  {
    "text": "it we use four tricks again so we said",
    "start": "777839",
    "end": "783000"
  },
  {
    "text": "uh I said that we um we have to to do",
    "start": "783000",
    "end": "786680"
  },
  {
    "text": "some tricks on the PNG to um to have",
    "start": "786680",
    "end": "790560"
  },
  {
    "text": "something which is slightly different",
    "start": "790560",
    "end": "791959"
  },
  {
    "text": "but that will look the same what happens",
    "start": "791959",
    "end": "794399"
  },
  {
    "text": "is that pngs have well a header and then",
    "start": "794399",
    "end": "798600"
  },
  {
    "text": "all the the information which is in it",
    "start": "798600",
    "end": "801360"
  },
  {
    "text": "is built in chunks so you've got like a",
    "start": "801360",
    "end": "804079"
  },
  {
    "text": "header chunk a data chunk an end chunk",
    "start": "804079",
    "end": "808000"
  },
  {
    "text": "plenty of different chunks",
    "start": "808000",
    "end": "811040"
  },
  {
    "text": "what we do is that we are going to",
    "start": "811040",
    "end": "813959"
  },
  {
    "text": "insert within the image the dummy chunk",
    "start": "813959",
    "end": "817399"
  },
  {
    "text": "a chunk with an identifier which is",
    "start": "817399",
    "end": "820000"
  },
  {
    "text": "unknown and what happens is that all",
    "start": "820000",
    "end": "823000"
  },
  {
    "text": "image processing tools when they see",
    "start": "823000",
    "end": "824760"
  },
  {
    "text": "that dummy chunk they just simply ignore",
    "start": "824760",
    "end": "827480"
  },
  {
    "text": "it so they'll see they'll come they'll",
    "start": "827480",
    "end": "829639"
  },
  {
    "text": "say oh this is a header chunk fine this",
    "start": "829639",
    "end": "831839"
  },
  {
    "text": "is what oh oh this is an unknown chunk I",
    "start": "831839",
    "end": "835120"
  },
  {
    "text": "don't I don't want to have a look at",
    "start": "835120",
    "end": "836759"
  },
  {
    "text": "this they go further on and we can put",
    "start": "836759",
    "end": "839120"
  },
  {
    "text": "some valuable information for S but",
    "start": "839120",
    "end": "841759"
  },
  {
    "text": "something which will not be",
    "start": "841759",
    "end": "844759"
  },
  {
    "text": "displayed and decrypt that to an",
    "start": "844759",
    "end": "848639"
  },
  {
    "text": "application on the other side we've got",
    "start": "848639",
    "end": "852279"
  },
  {
    "text": "um well so the the application same",
    "start": "852279",
    "end": "855120"
  },
  {
    "text": "thing we want to modify it a little bit",
    "start": "855120",
    "end": "858480"
  },
  {
    "text": "so that Android doesn't see the",
    "start": "858480",
    "end": "860040"
  },
  {
    "text": "difference but it gets useful to us so",
    "start": "860040",
    "end": "864800"
  },
  {
    "text": "Android Android packages are just Zips",
    "start": "864800",
    "end": "867120"
  },
  {
    "text": "in a zip if you want you can just pens",
    "start": "867120",
    "end": "870320"
  },
  {
    "text": "data and it will be ignored same thing",
    "start": "870320",
    "end": "874399"
  },
  {
    "text": "you just have to make sure to put at the",
    "start": "874399",
    "end": "877440"
  },
  {
    "text": "end of the zip a marker which is called",
    "start": "877440",
    "end": "880519"
  },
  {
    "text": "the end of central directory to kind of",
    "start": "880519",
    "end": "883800"
  },
  {
    "text": "say to zip into Android this is the end",
    "start": "883800",
    "end": "886959"
  },
  {
    "text": "of my zip file provided you do that the",
    "start": "886959",
    "end": "890320"
  },
  {
    "text": "zip will be valid and will be loaded",
    "start": "890320",
    "end": "892920"
  },
  {
    "text": "well if it really looks like an Android",
    "start": "892920",
    "end": "895519"
  },
  {
    "text": "application",
    "start": "895519",
    "end": "898519"
  },
  {
    "text": "the last two tricks U are using a little",
    "start": "899279",
    "end": "901360"
  },
  {
    "text": "bit of crypto but it's really nothing",
    "start": "901360",
    "end": "903680"
  },
  {
    "text": "really uh uh very difficult no need to",
    "start": "903680",
    "end": "906680"
  },
  {
    "text": "be like Shamir to understand that so",
    "start": "906680",
    "end": "911959"
  },
  {
    "text": "um we are using in this case a yes it",
    "start": "911959",
    "end": "915000"
  },
  {
    "text": "could be working with other block",
    "start": "915000",
    "end": "916600"
  },
  {
    "text": "ciphers and anyway AES uh Works block",
    "start": "916600",
    "end": "921480"
  },
  {
    "text": "per block and on 16 B bite",
    "start": "921480",
    "end": "925600"
  },
  {
    "text": "blocks in our case of course we've got",
    "start": "925600",
    "end": "928440"
  },
  {
    "text": "far much for more than just those 16",
    "start": "928440",
    "end": "931839"
  },
  {
    "text": "bytes so we have to use some chaining",
    "start": "931839",
    "end": "935040"
  },
  {
    "text": "there are plenty of known chaining ECB",
    "start": "935040",
    "end": "937800"
  },
  {
    "text": "um CBC whatever we'll be using CBC which",
    "start": "937800",
    "end": "940839"
  },
  {
    "text": "is cipher",
    "start": "940839",
    "end": "943240"
  },
  {
    "text": "blockchaining in",
    "start": "943240",
    "end": "945160"
  },
  {
    "text": "CBC um the how it works is that um the",
    "start": "945160",
    "end": "952319"
  },
  {
    "text": "the cipher text for a given block",
    "start": "952319",
    "end": "954680"
  },
  {
    "text": "consists in you take the result of the",
    "start": "954680",
    "end": "958240"
  },
  {
    "text": "previous block and you exort it with the",
    "start": "958240",
    "end": "960440"
  },
  {
    "text": "plain text of your current block and",
    "start": "960440",
    "end": "962440"
  },
  {
    "text": "that's how you get the cipher text of",
    "start": "962440",
    "end": "964560"
  },
  {
    "text": "the new block so for the first block",
    "start": "964560",
    "end": "967880"
  },
  {
    "text": "you've got an issue uh because well",
    "start": "967880",
    "end": "970480"
  },
  {
    "text": "you've got no previous block so you are",
    "start": "970480",
    "end": "972519"
  },
  {
    "text": "taking an initialization Vector the",
    "start": "972519",
    "end": "976600"
  },
  {
    "text": "IV right so again in our case we know we",
    "start": "976600",
    "end": "982240"
  },
  {
    "text": "know our first blocks the first 16 bytes",
    "start": "982240",
    "end": "987040"
  },
  {
    "text": "of uh of the vandroid the application",
    "start": "987040",
    "end": "990000"
  },
  {
    "text": "that's the first 16 blocks of the plain",
    "start": "990000",
    "end": "991880"
  },
  {
    "text": "text we also know the first 16 uh bytes",
    "start": "991880",
    "end": "995880"
  },
  {
    "text": "of the cipher text that's the beginning",
    "start": "995880",
    "end": "998199"
  },
  {
    "text": "of uh the Anakin Skywalker image so we",
    "start": "998199",
    "end": "1001519"
  },
  {
    "text": "know what we want those to look like we",
    "start": "1001519",
    "end": "1004560"
  },
  {
    "text": "can select the key Anakin equal dark",
    "start": "1004560",
    "end": "1007399"
  },
  {
    "text": "side or whatever you want to choose and",
    "start": "1007399",
    "end": "1010199"
  },
  {
    "text": "then well it's just pure and very simple",
    "start": "1010199",
    "end": "1013519"
  },
  {
    "text": "simple equation we just have to compute",
    "start": "1013519",
    "end": "1016720"
  },
  {
    "text": "the IV that will match that will work",
    "start": "1016720",
    "end": "1019839"
  },
  {
    "text": "and well to do that you just take the",
    "start": "1019839",
    "end": "1022759"
  },
  {
    "text": "the the first Cipher text decrypt it",
    "start": "1022759",
    "end": "1025079"
  },
  {
    "text": "exort with the plain text and that will",
    "start": "1025079",
    "end": "1027319"
  },
  {
    "text": "give you the IV that has the first two",
    "start": "1027319",
    "end": "1029640"
  },
  {
    "text": "blocks match just perfectly",
    "start": "1029640",
    "end": "1033480"
  },
  {
    "text": "well so that's good for the first block",
    "start": "1034760",
    "end": "1037678"
  },
  {
    "text": "for the other blocks we are using",
    "start": "1037679",
    "end": "1040438"
  },
  {
    "text": "another",
    "start": "1040439",
    "end": "1041720"
  },
  {
    "text": "trick um it's really based on a very",
    "start": "1041720",
    "end": "1044678"
  },
  {
    "text": "simple remark which is that well",
    "start": "1044679",
    "end": "1047319"
  },
  {
    "text": "whenever you are encrypting something",
    "start": "1047319",
    "end": "1050000"
  },
  {
    "text": "that you have previously decrypted you",
    "start": "1050000",
    "end": "1052120"
  },
  {
    "text": "get back the Identity or recip",
    "start": "1052120",
    "end": "1054360"
  },
  {
    "text": "reciprocally if you're uh decrypting",
    "start": "1054360",
    "end": "1056679"
  },
  {
    "text": "something you have just encrypted you",
    "start": "1056679",
    "end": "1058480"
  },
  {
    "text": "get back the the initial plain text",
    "start": "1058480",
    "end": "1061280"
  },
  {
    "text": "otherwise anyway encryption would not be",
    "start": "1061280",
    "end": "1063679"
  },
  {
    "text": "working so in our case again um we just",
    "start": "1063679",
    "end": "1068280"
  },
  {
    "text": "have to think that we want our Cipher",
    "start": "1068280",
    "end": "1071200"
  },
  {
    "text": "text to look like the bit Maps the",
    "start": "1071200",
    "end": "1074320"
  },
  {
    "text": "pixels of Anakin Skywalker so how can we",
    "start": "1074320",
    "end": "1078280"
  },
  {
    "text": "achieve that well if we select our plain",
    "start": "1078280",
    "end": "1081559"
  },
  {
    "text": "text to be the decryption of that uh",
    "start": "1081559",
    "end": "1085600"
  },
  {
    "text": "those pixels so like decrypt bit map of",
    "start": "1085600",
    "end": "1089799"
  },
  {
    "text": "Anakin well in that case when we are",
    "start": "1089799",
    "end": "1091960"
  },
  {
    "text": "going to re-encrypt it it will be",
    "start": "1091960",
    "end": "1095720"
  },
  {
    "text": "encrypt the decrypted bit map of an",
    "start": "1095720",
    "end": "1099080"
  },
  {
    "text": "Anakin and that equals of course the bit",
    "start": "1099080",
    "end": "1101799"
  },
  {
    "text": "map of Anakin Skywalker so that's how we",
    "start": "1101799",
    "end": "1105679"
  },
  {
    "text": "can get uh the result we want",
    "start": "1105679",
    "end": "1109679"
  },
  {
    "text": "so that's the last",
    "start": "1109679",
    "end": "1112520"
  },
  {
    "text": "trick and now we just have to pull all",
    "start": "1112520",
    "end": "1115600"
  },
  {
    "text": "those four tricks all together and we",
    "start": "1115600",
    "end": "1117480"
  },
  {
    "text": "can uh we can have it working so we have",
    "start": "1117480",
    "end": "1120280"
  },
  {
    "text": "our Android",
    "start": "1120280",
    "end": "1121919"
  },
  {
    "text": "application then uh we have the the",
    "start": "1121919",
    "end": "1125159"
  },
  {
    "text": "payload there with a Darth Vader",
    "start": "1125159",
    "end": "1127240"
  },
  {
    "text": "application popping up and then of",
    "start": "1127240",
    "end": "1130120"
  },
  {
    "text": "central directory because it's just a",
    "start": "1130120",
    "end": "1132440"
  },
  {
    "text": "trailing there to to set so the the end",
    "start": "1132440",
    "end": "1135000"
  },
  {
    "text": "of the initial uh application and then",
    "start": "1135000",
    "end": "1138080"
  },
  {
    "text": "we're going to pend some data we saw",
    "start": "1138080",
    "end": "1140240"
  },
  {
    "text": "that Android would be ignoring all",
    "start": "1140240",
    "end": "1144600"
  },
  {
    "text": "appended data",
    "start": "1144600",
    "end": "1146280"
  },
  {
    "text": "afterwards so that's data that we're",
    "start": "1146280",
    "end": "1148559"
  },
  {
    "text": "going to put here it's going to be",
    "start": "1148559",
    "end": "1150799"
  },
  {
    "text": "basically what concerns the chunks of",
    "start": "1150799",
    "end": "1153360"
  },
  {
    "text": "the image of Anakin Skywalker that we",
    "start": "1153360",
    "end": "1156559"
  },
  {
    "text": "display in the",
    "start": "1156559",
    "end": "1158559"
  },
  {
    "text": "PNG in the PNG same thing for well for",
    "start": "1158559",
    "end": "1162480"
  },
  {
    "text": "the first few bytes the the first 16",
    "start": "1162480",
    "end": "1165640"
  },
  {
    "text": "bytes we have selected the IV so that",
    "start": "1165640",
    "end": "1168880"
  },
  {
    "text": "they match perfectly well and then we",
    "start": "1168880",
    "end": "1171760"
  },
  {
    "text": "have a dummy Chunk in that dummy chunk",
    "start": "1171760",
    "end": "1174799"
  },
  {
    "text": "we're going to we're going to have",
    "start": "1174799",
    "end": "1176280"
  },
  {
    "text": "actually the encrypted payload of uh the",
    "start": "1176280",
    "end": "1180000"
  },
  {
    "text": "Darth Vader application that will be",
    "start": "1180000",
    "end": "1181960"
  },
  {
    "text": "there in there and that will be skipped",
    "start": "1181960",
    "end": "1184520"
  },
  {
    "text": "by the Imaging tools because they'll see",
    "start": "1184520",
    "end": "1186760"
  },
  {
    "text": "it's a dummy chunk uh that they ignore",
    "start": "1186760",
    "end": "1190400"
  },
  {
    "text": "and",
    "start": "1190400",
    "end": "1191400"
  },
  {
    "text": "then when we have when we encrypt the",
    "start": "1191400",
    "end": "1194200"
  },
  {
    "text": "application we're going to encrypt the",
    "start": "1194200",
    "end": "1196520"
  },
  {
    "text": "appended data where we have the chunks",
    "start": "1196520",
    "end": "1198760"
  },
  {
    "text": "of Anakin we're going to use our fourth",
    "start": "1198760",
    "end": "1200960"
  },
  {
    "text": "trick where we use you know decryption",
    "start": "1200960",
    "end": "1204000"
  },
  {
    "text": "of encryption gives back the identity",
    "start": "1204000",
    "end": "1207120"
  },
  {
    "text": "and that gives us back of the bit map of",
    "start": "1207120",
    "end": "1210880"
  },
  {
    "text": "Anakin and then we do the we have a few",
    "start": "1210880",
    "end": "1215640"
  },
  {
    "text": "remaining bytes there just to make sure",
    "start": "1215640",
    "end": "1217640"
  },
  {
    "text": "that it's a multiple of 16 bytes and we",
    "start": "1217640",
    "end": "1220480"
  },
  {
    "text": "have a trailing and of central directory",
    "start": "1220480",
    "end": "1223640"
  },
  {
    "text": "and it works and those last few bites",
    "start": "1223640",
    "end": "1226679"
  },
  {
    "text": "are ignored because they appear at the",
    "start": "1226679",
    "end": "1228840"
  },
  {
    "text": "of the PNG file and there so that's how",
    "start": "1228840",
    "end": "1232559"
  },
  {
    "text": "it",
    "start": "1232559",
    "end": "1234440"
  },
  {
    "text": "work it works well as you you have seen",
    "start": "1234440",
    "end": "1237600"
  },
  {
    "text": "well up to um the Android versions which",
    "start": "1237600",
    "end": "1240400"
  },
  {
    "text": "are working now",
    "start": "1240400",
    "end": "1242880"
  },
  {
    "text": "4.4.2 uh in June we would not defy the",
    "start": "1242880",
    "end": "1245520"
  },
  {
    "text": "Android security team who fixed that so",
    "start": "1245520",
    "end": "1248880"
  },
  {
    "text": "it shouldn't be working in the next",
    "start": "1248880",
    "end": "1251120"
  },
  {
    "text": "versions however um we think that",
    "start": "1251120",
    "end": "1253720"
  },
  {
    "text": "there's a slight bug in the way they",
    "start": "1253720",
    "end": "1255400"
  },
  {
    "text": "fixed it so we are following up uh the",
    "start": "1255400",
    "end": "1258039"
  },
  {
    "text": "bug with them because not sure it's",
    "start": "1258039",
    "end": "1259919"
  },
  {
    "text": "totally",
    "start": "1259919",
    "end": "1261000"
  },
  {
    "text": "working um the proof of concept that I",
    "start": "1261000",
    "end": "1264480"
  },
  {
    "text": "showed has been released it's not I was",
    "start": "1264480",
    "end": "1268000"
  },
  {
    "text": "I said here it would be soon after the",
    "start": "1268000",
    "end": "1269600"
  },
  {
    "text": "conference but actually I managed to",
    "start": "1269600",
    "end": "1271440"
  },
  {
    "text": "push it just before so if you want to",
    "start": "1271440",
    "end": "1273919"
  },
  {
    "text": "have a look at the code you can you've",
    "start": "1273919",
    "end": "1275600"
  },
  {
    "text": "got everything there you've got also our",
    "start": "1275600",
    "end": "1278200"
  },
  {
    "text": "Twitter feeds and now I'm ready to take",
    "start": "1278200",
    "end": "1280760"
  },
  {
    "text": "a few questions if there's time",
    "start": "1280760",
    "end": "1285480"
  },
  {
    "text": "[Applause]",
    "start": "1295170",
    "end": "1299329"
  }
]