[
  {
    "text": "my name is Josh also go by monk and I'm be talking about NAND flash and all the",
    "start": "30",
    "end": "6000"
  },
  {
    "text": "fun we can have before I get started this was a cyber fast track project",
    "start": "6000",
    "end": "11990"
  },
  {
    "text": "funded by DARPA and just kind of wanted to say thank you too much for doing that",
    "start": "11990",
    "end": "17250"
  },
  {
    "text": "it's awesome Who am I I'm an applied research geek at a coupon labs I don't",
    "start": "17250",
    "end": "26070"
  },
  {
    "text": "know I actually when I'm sitting in the audience I always hate the Who am I thing so I'm gonna skip it but if you want to know more find me tab",
    "start": "26070",
    "end": "34020"
  },
  {
    "text": "with me I'm ed Munk dot on Twitter so I",
    "start": "34020",
    "end": "41750"
  },
  {
    "text": "start when I started this project town I was doing a lot of implant work and and",
    "start": "41750",
    "end": "47460"
  },
  {
    "text": "whatnot and just thinking about how that whole industry works and I realized at",
    "start": "47460",
    "end": "53520"
  },
  {
    "text": "the time I was just doing a lot of air to glass type stuff right so I want to get on a device I get on the device I",
    "start": "53520",
    "end": "60359"
  },
  {
    "text": "never touched storage I'm purely over-the-air to the glass of the screen",
    "start": "60359",
    "end": "67170"
  },
  {
    "text": "and then on a reboot I'm gone no persistence but really hard to find me if I'm trying to evade detection of",
    "start": "67170",
    "end": "74549"
  },
  {
    "text": "whatever code I'm running that was awesome and really reliable other than",
    "start": "74549",
    "end": "79680"
  },
  {
    "text": "the fact that I disappear when someone reboots a phone I didn't really like",
    "start": "79680",
    "end": "84689"
  },
  {
    "text": "that it started getting in the way so I started looking at how can I persist and still stay just as hidden just as secure",
    "start": "84689",
    "end": "91409"
  },
  {
    "text": "as as I was if I was doing pure air to glass um I started looking at how data is stored on things like cell phones or",
    "start": "91409",
    "end": "98700"
  },
  {
    "text": "SCADA or anything like that and everything pointed me back to NAND flash so suck how does that work which is this",
    "start": "98700",
    "end": "104759"
  },
  {
    "text": "Pres oh when I started thinking about it was like oh well if that's how it works then yeah we can totally hide files and",
    "start": "104759",
    "end": "111590"
  },
  {
    "text": "then thinking about a little more kind of logically had this leave of like oh crap yeah we can hide files but that",
    "start": "111590",
    "end": "117060"
  },
  {
    "text": "just became really boring compared to what we can actually do with NAND so I can all the things and after this hour",
    "start": "117060",
    "end": "124200"
  },
  {
    "text": "you can - yeah I'm gonna do the intro which I just did I'm gonna talk about",
    "start": "124200",
    "end": "130140"
  },
  {
    "text": "defense actually twice really quickly both times because it's",
    "start": "130140",
    "end": "135530"
  },
  {
    "text": "almost trivial I'm going to just kind of go through how NAND works is a nice",
    "start": "135530",
    "end": "141810"
  },
  {
    "text": "intro and point out the logical flaws that are there and why this whole setup",
    "start": "141810",
    "end": "147060"
  },
  {
    "text": "works and how you can use in how you can move take my proof of concept to the next level if you wanted to and I'll",
    "start": "147060",
    "end": "152940"
  },
  {
    "text": "talk about forensics as well because if you're trying to hide things you typically care about forensics too long",
    "start": "152940",
    "end": "159870"
  },
  {
    "text": "didn't read of the whole talk if you actually want to walk out now everything is on github",
    "start": "159870",
    "end": "165240"
  },
  {
    "text": "everything's open sourcing them and talk about all the demos everything's there",
    "start": "165240",
    "end": "170840"
  },
  {
    "text": "so defense to long didn't read what",
    "start": "170870",
    "end": "176010"
  },
  {
    "text": "we're gonna take advantage of today is built into the hardware it was a design choice when they made NAND it's not",
    "start": "176010",
    "end": "181830"
  },
  {
    "text": "something that can really be fixed it can't be patched you know even if you could patch hardware it can't really be",
    "start": "181830",
    "end": "188310"
  },
  {
    "text": "fat patched cuz it's an intrinsic way that NAND works that I'm taking advantage of so there are potential ways",
    "start": "188310",
    "end": "196770"
  },
  {
    "text": "to kind of duct tape band-aid around this that we'll get to at the ends but",
    "start": "196770",
    "end": "201990"
  },
  {
    "text": "really none of those solutions that I've come up with so far are actually valid",
    "start": "201990",
    "end": "207030"
  },
  {
    "text": "to fully defeat this attack it's just kind of intrinsic in the way the hardware works so the only real way you",
    "start": "207030",
    "end": "214590"
  },
  {
    "text": "could bypass this is just to not use an ant which given that solid state drives on laptops skate of the whole list uses",
    "start": "214590",
    "end": "222930"
  },
  {
    "text": "an ant that's not really practical so again science is hard I'm gonna try to",
    "start": "222930",
    "end": "229890"
  },
  {
    "text": "do a quick explanation for an an for the people in the audience that don't haven't spent the ungodly hours reading",
    "start": "229890",
    "end": "235620"
  },
  {
    "text": "the docs I'm gonna also try to simplify some things because they just makes what",
    "start": "235620",
    "end": "240900"
  },
  {
    "text": "I'm going to show you make a little more sense um if you know an and really well and you see where I messed things up please don't get mad at me",
    "start": "240900",
    "end": "247550"
  },
  {
    "text": "so NAND basically we're talking about trapping electrons at the base of",
    "start": "247550",
    "end": "254370"
  },
  {
    "text": "everything that's how it works so I'm gonna call a single place that traps a single electron is a bucket",
    "start": "254370",
    "end": "261350"
  },
  {
    "text": "it is a bit if there's an electron in there you've got a one if there's not it's a zero these are logically created or logically",
    "start": "261350",
    "end": "269050"
  },
  {
    "text": "packaged into pages pages are typically 512 2048 90-hour 4096 I mean your",
    "start": "269050",
    "end": "277310"
  },
  {
    "text": "typical computer numbers right of bytes and then those pages are actually then wrapped into blocks the blocks is what",
    "start": "277310",
    "end": "284660"
  },
  {
    "text": "we actually typically care about because like 512 that's actually enough to store some data that I care about you're",
    "start": "284660",
    "end": "290210"
  },
  {
    "text": "getting you smaller than that and it why bother but you know half a mega I'm cool with",
    "start": "290210",
    "end": "295790"
  },
  {
    "text": "that so when you when you wipe NAND completely instead of zeros like you",
    "start": "295790",
    "end": "301970"
  },
  {
    "text": "would kind of mentally expect you get all FS right like the whole array our",
    "start": "301970",
    "end": "308090"
  },
  {
    "text": "nice little beer pong table here every cup is filled up with an electron it's much easier to drink the beer than it is",
    "start": "308090",
    "end": "314390"
  },
  {
    "text": "to refill the beer on one of the middle cups so shifting to zero is easy you can",
    "start": "314390",
    "end": "321110"
  },
  {
    "text": "just let the electron go shifting back to one is really hard if there's no easy way to do it so they actually do it on a",
    "start": "321110",
    "end": "326450"
  },
  {
    "text": "whole page or a whole block mechanism which we'll come back to in a little bit",
    "start": "326450",
    "end": "332080"
  },
  {
    "text": "so like I said it's a trap we have the",
    "start": "332080",
    "end": "338330"
  },
  {
    "text": "nice little picture there that just kind of shows basically you have two gates and you're gonna trap an electron and",
    "start": "338330",
    "end": "343370"
  },
  {
    "text": "then I still bucket um these things you know are obviously small they are fragile um during the",
    "start": "343370",
    "end": "350870"
  },
  {
    "text": "typical use of a device NAND lifetime has gotten better but originally we were",
    "start": "350870",
    "end": "357500"
  },
  {
    "text": "seeing like 10 to a hundred thousand writes and the whole thing's just dead now we're up in the millions as far as",
    "start": "357500",
    "end": "363860"
  },
  {
    "text": "how they're building hardware but still it is logically you know that gate is going to fail and die that's built into",
    "start": "363860",
    "end": "371270"
  },
  {
    "text": "the hardware because we know that the",
    "start": "371270",
    "end": "376550"
  },
  {
    "text": "hardware is going to fail we build in we're leveling so we're not always hitting the first block every time we want to save data there's a nice little",
    "start": "376550",
    "end": "382820"
  },
  {
    "text": "Turing machine typically built in the embedded controller that does we're leveling over the whole the whole space",
    "start": "382820",
    "end": "388850"
  },
  {
    "text": "of memory because of that we have a lot of we're leveling residue what will come back to",
    "start": "388850",
    "end": "394250"
  },
  {
    "text": "way at the very end but so here's a typical like diagram of how NAND works",
    "start": "394250",
    "end": "400520"
  },
  {
    "text": "from Toshiba which of the people that claim to have invented the technology is a little too low-level for what I want",
    "start": "400520",
    "end": "406070"
  },
  {
    "text": "to get to so we're going to talk about this diagram which just simplifies it for what we're gonna talk about today we",
    "start": "406070",
    "end": "412400"
  },
  {
    "text": "have two different types of NAND we care about we have managed demand and raw and NAND or NAND flash the only difference",
    "start": "412400",
    "end": "421190"
  },
  {
    "text": "is wrong and is simple simply just the gates and the traps everything else has",
    "start": "421190",
    "end": "429560"
  },
  {
    "text": "managed in software like in the kernel or in whatever artists you're running",
    "start": "429560",
    "end": "434570"
  },
  {
    "text": "what not managed NAND has a small embedded term like embedded Turing",
    "start": "434570",
    "end": "440270"
  },
  {
    "text": "machine in the actual Manship that does on device we're leveling it it takes",
    "start": "440270",
    "end": "445760"
  },
  {
    "text": "care of it it moves a lot of the code from a driver into the actual Hardware",
    "start": "445760",
    "end": "451390"
  },
  {
    "text": "below that Turing machine level it's the exact same NAND hardware it all works",
    "start": "451390",
    "end": "456470"
  },
  {
    "text": "the exact same everything that I'm going to talk about with Ron and can also in almost just as easily be done in",
    "start": "456470",
    "end": "462860"
  },
  {
    "text": "management the only reason we'll talk about raw is simply because it's its kernel code we",
    "start": "462860",
    "end": "468440"
  },
  {
    "text": "can kind of understand it and latch into it a lot easier than trying to talk about weird embedded firmware stuff so",
    "start": "468440",
    "end": "477250"
  },
  {
    "text": "like I said NAND breaks what happens when it breaks we have three things that we care about we have ECC values so we",
    "start": "477250",
    "end": "486650"
  },
  {
    "text": "know that single bits in and will break",
    "start": "486650",
    "end": "491780"
  },
  {
    "text": "so there's error correction values that are stored that I mean sometimes they work like forward error correction like",
    "start": "491780",
    "end": "497419"
  },
  {
    "text": "you would have in a network stack or whatnot um but a lot of times it's just flag saying like this could potentially",
    "start": "497419",
    "end": "502760"
  },
  {
    "text": "be bad once you hit a threshold it's set like in the kernel for how many bits in",
    "start": "502760",
    "end": "511820"
  },
  {
    "text": "a block become bad and can't be used can't be flipped correctly when you want",
    "start": "511820",
    "end": "517520"
  },
  {
    "text": "them to that block gets marked bad and then it's stored in the bad block table the BBT",
    "start": "517520",
    "end": "524420"
  },
  {
    "text": "every name device has a BB T or something similar to a BB T and all that",
    "start": "524420",
    "end": "530160"
  },
  {
    "text": "does is say I am no longer trustworthy never ever ever store data in me again I",
    "start": "530160",
    "end": "535230"
  },
  {
    "text": "don't exist so if you format the drive it doesn't touch the bad block it",
    "start": "535230",
    "end": "542310"
  },
  {
    "text": "anything that's marked in the bad block table just doesn't get touched anymore ever by the kernel by firmware it is",
    "start": "542310",
    "end": "549510"
  },
  {
    "text": "just it's gone because we're gonna have fun with that bad block is normally stored in the out-of-bounds area of Nan",
    "start": "549510",
    "end": "556230"
  },
  {
    "text": "so it's an it's an area that typically isn't writable so you it's supposed to",
    "start": "556230",
    "end": "562350"
  },
  {
    "text": "be hard to mark blocks bad I did a lot of research on a whole bunch of",
    "start": "562350",
    "end": "568260"
  },
  {
    "text": "different embedded and Enron and controllers and I basically found three use cases that they run through you have",
    "start": "568260",
    "end": "575700"
  },
  {
    "text": "some NAND devices that actually when the kernel boots up the first time on like a",
    "start": "575700",
    "end": "581279"
  },
  {
    "text": "cell phone it runs through and kind of does some analysis on every block of",
    "start": "581279",
    "end": "586560"
  },
  {
    "text": "NAND and it creates a bad block table in RAM that bad block table and RAM is then",
    "start": "586560",
    "end": "593190"
  },
  {
    "text": "written back to NAND like during a shutdown so when it comes back up it",
    "start": "593190",
    "end": "599459"
  },
  {
    "text": "just reads what it already wrote and doesn't have to do the analysis again this is really cool because if you're",
    "start": "599459",
    "end": "604500"
  },
  {
    "text": "attacking that type of a platform you really only have to attack the bad block table that's in RAM and then politely",
    "start": "604500",
    "end": "610680"
  },
  {
    "text": "reboot the phone and things disappear that's in the spec there's use cases",
    "start": "610680",
    "end": "617190"
  },
  {
    "text": "online showing that that exists I haven't actually found one in the real world normally what I've found during",
    "start": "617190",
    "end": "622649"
  },
  {
    "text": "this research is the second bullet which is some systems use them basically out",
    "start": "622649",
    "end": "627870"
  },
  {
    "text": "of balance markers so you'll have a block of 512 and then surrounding that you'll have a page at the beginning or",
    "start": "627870",
    "end": "633750"
  },
  {
    "text": "end like 16 K or something that is used to a whole bunch of flags for like error",
    "start": "633750",
    "end": "641040"
  },
  {
    "text": "correction values blah blah blah blah blah and is this block good or bad so",
    "start": "641040",
    "end": "646860"
  },
  {
    "text": "you have to be able to write out of the bounds of where kernel can normally access names to",
    "start": "646860",
    "end": "653310"
  },
  {
    "text": "write things it can request the driver do it but there's no direct like I want",
    "start": "653310",
    "end": "659010"
  },
  {
    "text": "to raw right here that just doesn't that code doesn't exist technically in the",
    "start": "659010",
    "end": "664950"
  },
  {
    "text": "Linux kernel or the Android kernel and then some other devices basically store a whole bad block table either at the",
    "start": "664950",
    "end": "670980"
  },
  {
    "text": "very beginning of the very end of NAND you're kind of at that point you're just looking at like a negative address you",
    "start": "670980",
    "end": "677520"
  },
  {
    "text": "can't actually address that space so if you go to like you know memory addresses 0 and and that's gonna be the start of",
    "start": "677520",
    "end": "683910"
  },
  {
    "text": "your data you really have to go to like negative 5/12 and then there's your bad block table but regardless it's stored somewhere so",
    "start": "683910",
    "end": "696800"
  },
  {
    "text": "again we that's what we wanted to get to because we want to be able to mark blocks Pat touched on previously you",
    "start": "696830",
    "end": "703920"
  },
  {
    "text": "kind of have Ron and which has a very complex driver because it's having to do all the we're leveling in software or",
    "start": "703920",
    "end": "710160"
  },
  {
    "text": "you have an MMC EMC the more managed man that has a really simple driver for",
    "start": "710160",
    "end": "717209"
  },
  {
    "text": "Android and Linux and whatnot but they do the same thing it's just whether the we're leveling is in software kernel",
    "start": "717209",
    "end": "724500"
  },
  {
    "text": "driver or if it's embedded all the we're leveling is proprietary vendor information so none of the algorithms",
    "start": "724500",
    "end": "732360"
  },
  {
    "text": "are really understood in the public sector which will take advantage of when we get to forensics and everything as a",
    "start": "732360",
    "end": "739740"
  },
  {
    "text": "kernel or I mean everything has an API so I can just call it directly I don't have to do any leet hackery things I",
    "start": "739740",
    "end": "745140"
  },
  {
    "text": "just have to write code so in software when we're talking wrong and on every",
    "start": "745140",
    "end": "752310"
  },
  {
    "text": "Linux just drive looked at in every Android kernel I've looked at it all when were using R on and we use the MTD",
    "start": "752310",
    "end": "758339"
  },
  {
    "text": "subsystem it's like a huge meta driver that does a ton of stuff almost",
    "start": "758339",
    "end": "763709"
  },
  {
    "text": "everything that I end up thinking who that would be interesting to look at in Android is in MTD",
    "start": "763709",
    "end": "770149"
  },
  {
    "text": "so started looking at okay how I want to be able to mark blocks bad because I",
    "start": "770170",
    "end": "775390"
  },
  {
    "text": "know then they will exist you know I can write data to them and then mark them bad and then nothing season that's what",
    "start": "775390",
    "end": "781180"
  },
  {
    "text": "I want so what has the ability on a system to do that you have Yaffe's and other file systems that are pretty high",
    "start": "781180",
    "end": "786580"
  },
  {
    "text": "level that do that but if you start telling the file system to mark a block bad then there's a lot of residue that",
    "start": "786580",
    "end": "795280"
  },
  {
    "text": "you wrote stuff there so that's little higher level than you want to play with you've got MTD in the driver level which",
    "start": "795280",
    "end": "800980"
  },
  {
    "text": "is the rest of this presentation you could do it directly in the kernel but then you got to compile your own kernel",
    "start": "800980",
    "end": "806770"
  },
  {
    "text": "and it's a pain and I mean why that's not that's not clean if you've got embedded like Turing machines you can",
    "start": "806770",
    "end": "813670"
  },
  {
    "text": "start playing with flash transition layers and the embedded controllers I've got some non public work on that that",
    "start": "813670",
    "end": "818800"
  },
  {
    "text": "I'd love to talk about but it's not in this press o and the other way you could actually pop this that I haven't looked",
    "start": "818800",
    "end": "825220"
  },
  {
    "text": "at very hard is just for user land coding I mean users have the ability to read and write from the disk so at some",
    "start": "825220",
    "end": "831340"
  },
  {
    "text": "point something can catch that and say this is bad so if you found privileged",
    "start": "831340",
    "end": "836770"
  },
  {
    "text": "escalation like it wouldn't be as straight up I get root access it would just be like I can accidentally make",
    "start": "836770",
    "end": "841870"
  },
  {
    "text": "this call I shouldn't so when I started this I wanted to kill NAND and I figured",
    "start": "841870",
    "end": "848800"
  },
  {
    "text": "it would be a nice Hardware reversing gig there's no more used to so I bought a bunch of gear to do that and then started doing the research and realized",
    "start": "848800",
    "end": "854830"
  },
  {
    "text": "that I could just kind of throw all that away so I went shopping for phones because I was looking for something that",
    "start": "854830",
    "end": "860620"
  },
  {
    "text": "had Ron and I bought a ton basically bought phones off eBay ran a couple",
    "start": "860620",
    "end": "866470"
  },
  {
    "text": "commands and then sold them back on eBay if you got some of my phones I'm really really sorry",
    "start": "866470",
    "end": "872400"
  },
  {
    "text": "but and then I kind of like I ran out of money or in at a time or just like I",
    "start": "872400",
    "end": "877540"
  },
  {
    "text": "needed more phones cuz I went this mythical phone that uses like Ron and that's a vendor I can talk about it's",
    "start": "877540",
    "end": "884860"
  },
  {
    "text": "like I I did it and then I called Jay duck because he's a co-worker and he ran a whole bunch of tests on his whole Android lab and",
    "start": "884860",
    "end": "891610"
  },
  {
    "text": "called some other friends that were doing research we finally found a couple that use draw the one I'm gonna pick on",
    "start": "891610",
    "end": "896920"
  },
  {
    "text": "today is um the Sony Xperia Arc s who's a phone from a couple years ago it's a",
    "start": "896920",
    "end": "904449"
  },
  {
    "text": "nice little phone I've got a couple if you want to see a like a demo or dive",
    "start": "904449",
    "end": "909790"
  },
  {
    "text": "down deeper I'll have someone meet tomorrow um the one I was going to a live demo and today kind of caught fire",
    "start": "909790",
    "end": "915990"
  },
  {
    "text": "earlier so when we run partitions on this we can see everything is actually",
    "start": "915990",
    "end": "922269"
  },
  {
    "text": "straight up MTD there's no there's no you can see the two M's he blocks down at the bottom but we don't really care",
    "start": "922269",
    "end": "928120"
  },
  {
    "text": "about that so we see four partitions that are managed by MTD and then when we",
    "start": "928120",
    "end": "933459"
  },
  {
    "text": "we look at the actual proc MTD we can see that the partitions that are in raw unmanaged or yeah wrong and our system",
    "start": "933459",
    "end": "940930"
  },
  {
    "text": "Maps log cache and user data I'm like sweet now I can touch the system right that's what I want to kill so I do it I",
    "start": "940930",
    "end": "949389"
  },
  {
    "text": "start looking more into the test cases I start looking more into the code and the kernel to see how everything works and I",
    "start": "949389",
    "end": "955660"
  },
  {
    "text": "started noticing that all of the test cases for unmanaged NAND are running as",
    "start": "955660",
    "end": "962160"
  },
  {
    "text": "side little side loadable kernel modules that's even awesomer I don't have to do",
    "start": "962160",
    "end": "967300"
  },
  {
    "text": "a kernel right um so I'm like I'm just gonna write some some unit tests that start breaking NAND and I wrote three of",
    "start": "967300",
    "end": "973870"
  },
  {
    "text": "them and though will go into I've got an and hide which actually starts killing NAND and hiding the data that we want",
    "start": "973870",
    "end": "980680"
  },
  {
    "text": "and then I've gotten to kind of finders that just at least for a press oh let's",
    "start": "980680",
    "end": "986620"
  },
  {
    "text": "you see what I'm doing so I'm not",
    "start": "986620",
    "end": "992379"
  },
  {
    "text": "actually doing much rocket science here at all everything I'm doing is basically calling the API at a very low layer to",
    "start": "992379",
    "end": "999670"
  },
  {
    "text": "do it for me there's a handful of exceptions to that the one is the out of bounds right which if you try to call it",
    "start": "999670",
    "end": "1005639"
  },
  {
    "text": "even as the kernel directly you're gonna get access tonight that you just it doesn't like it for some quirky reason I",
    "start": "1005639",
    "end": "1014459"
  },
  {
    "text": "mean ring zero can but not but I I just took the driver code that",
    "start": "1014459",
    "end": "1020790"
  },
  {
    "text": "was there rewrote it with my own calls to skip a couple of security checks and just call that directly and that's",
    "start": "1020790",
    "end": "1027540"
  },
  {
    "text": "completely fine so what we're gonna do for the demo is I'm gonna pick a block we're gonna pick on block 37 just some",
    "start": "1027540",
    "end": "1034920"
  },
  {
    "text": "random block that I picked I'm gonna write dead beef over the whole thing like just 500 512 K just dead beef the",
    "start": "1034920",
    "end": "1042329"
  },
  {
    "text": "market is bad after we market is bad we're just gonna we're gonna zero out the whole our",
    "start": "1042329",
    "end": "1048000"
  },
  {
    "text": "out-of-bounds area that's going to actually mark the block is bad it just won't exist the system can't see",
    "start": "1048000",
    "end": "1054630"
  },
  {
    "text": "it anymore it's gone and then quickly because I picked block 37 we get a nice",
    "start": "1054630",
    "end": "1061790"
  },
  {
    "text": "catch-and-release collision that reboots the phone so and and that is actually",
    "start": "1061790",
    "end": "1069180"
  },
  {
    "text": "useful because when to boots back up that block is completely gone because the kernel has reinitialized from the",
    "start": "1069180",
    "end": "1075750"
  },
  {
    "text": "bad block table and caught that that block disappeared so the code is really",
    "start": "1075750",
    "end": "1082410"
  },
  {
    "text": "simple we have I'm basically picking a",
    "start": "1082410",
    "end": "1090330"
  },
  {
    "text": "block erasing it writing my buffer back and then marking bad Mike having to mark bag twice",
    "start": "1090330",
    "end": "1095700"
  },
  {
    "text": "because the first API call always fails I'm not sure why it's in there and I'm",
    "start": "1095700",
    "end": "1100800"
  },
  {
    "text": "not sure if you legitimately call it if it fails or not but I never got it to work but for completing this because I",
    "start": "1100800",
    "end": "1107160"
  },
  {
    "text": "was open sourcing the code I wanted to put it in there for other people to look at when I'm marking things bad like I",
    "start": "1107160",
    "end": "1113520"
  },
  {
    "text": "said the first one always fails so I always see that why you know mark bad",
    "start": "1113520",
    "end": "1118670"
  },
  {
    "text": "this time we just do it a little differently we call one level lower in the UM API and we get it every time so",
    "start": "1118670",
    "end": "1129120"
  },
  {
    "text": "block 37 happens to be where Settings app is stored on Android phones at least",
    "start": "1129120",
    "end": "1134220"
  },
  {
    "text": "all the phones that I've touched so when we kill it we get this kondeh Android",
    "start": "1134220",
    "end": "1141720"
  },
  {
    "text": "setting has stopped because it's no longer they are it used to be on disk it used to be loadable and now it's not",
    "start": "1141720",
    "end": "1148650"
  },
  {
    "text": "because that block is just appeared from the world suddenly reboot",
    "start": "1148650",
    "end": "1154180"
  },
  {
    "text": "the phone again and we get every time we get that because it's just gone so the",
    "start": "1154180",
    "end": "1161320"
  },
  {
    "text": "find system that I'm also releasing just as a check it does a very low-level",
    "start": "1161320",
    "end": "1166690"
  },
  {
    "text": "bypassing Heaney direct like kernel-level AP isin just going straight",
    "start": "1166690",
    "end": "1171940"
  },
  {
    "text": "to a driver iterating through the device and looking for any blocks that are marked bad and it's just gonna list them",
    "start": "1171940",
    "end": "1178450"
  },
  {
    "text": "just so we can see yeah I marked block 37 bad it's bad then if we go to complex",
    "start": "1178450",
    "end": "1185980"
  },
  {
    "text": "move that as ugly let me show the better",
    "start": "1185980",
    "end": "1191620"
  },
  {
    "text": "logs for complex now we'll come back to",
    "start": "1191620",
    "end": "1197740"
  },
  {
    "text": "him in the end um complex you can basically see that the first 16 K is all just zeros because",
    "start": "1197740",
    "end": "1204250"
  },
  {
    "text": "we we're just printing out that whole block so the first 16 K or 0 is because",
    "start": "1204250",
    "end": "1209290"
  },
  {
    "text": "that's where the bad block table is and everything else we're just releasing all the electrons and then the rest of it is",
    "start": "1209290",
    "end": "1214300"
  },
  {
    "text": "just dead beef um the whole thing I can do this because I'm specifically when I",
    "start": "1214300",
    "end": "1221860"
  },
  {
    "text": "rewrote my driver system to do this I'm bypassing that simple check saying is",
    "start": "1221860",
    "end": "1227050"
  },
  {
    "text": "this block bad if it's if it is don't read from it so if I'm calling directly",
    "start": "1227050",
    "end": "1232780"
  },
  {
    "text": "from the kernel that doesn't work it just sees this as bad and it never ever ever finds it if I run a DD on the",
    "start": "1232780",
    "end": "1238810"
  },
  {
    "text": "device that DD still checks the bad block table so even if I'm trying to do a raw forensics dump typically this",
    "start": "1238810",
    "end": "1245980"
  },
  {
    "text": "doesn't drop there are a couple of advanced dish commands and DD that you",
    "start": "1245980",
    "end": "1251920"
  },
  {
    "text": "could at least catch this if I was dumb enough to just write dead beef everywhere but every forensics tool that",
    "start": "1251920",
    "end": "1258640"
  },
  {
    "text": "I played with including the simple things just nothing found this block",
    "start": "1258640",
    "end": "1264310"
  },
  {
    "text": "once I marked it bad it just it disappears um which is awesome because obviously I can still read and write to",
    "start": "1264310",
    "end": "1270010"
  },
  {
    "text": "it so it is memory that nothing can see but you have complete control over",
    "start": "1270010",
    "end": "1277050"
  },
  {
    "text": "because the world sucks without a demo here's mine because I the phone that I",
    "start": "1277980",
    "end": "1282990"
  },
  {
    "text": "was playing with it just really doesn't work I've got some new ones that I'll bring I'll have them in my bag tomorrow",
    "start": "1282990",
    "end": "1289909"
  },
  {
    "text": "but here I am ins modding the kernel",
    "start": "1289909",
    "end": "1295289"
  },
  {
    "text": "module that has the exploiting thing in it and as soon as I do it we get a beautiful Android crash that is like the",
    "start": "1295289",
    "end": "1300960"
  },
  {
    "text": "sexiest crash screen I've seen or just like fades out to nothing and the phone's dead and then you reboot and you",
    "start": "1300960",
    "end": "1307799"
  },
  {
    "text": "get that screenshot from earlier settings setting the siscon yeah so once",
    "start": "1307799",
    "end": "1317970"
  },
  {
    "text": "a block is bad it is bad there's no logical way in any of the API and any of",
    "start": "1317970",
    "end": "1323399"
  },
  {
    "text": "the code that's in like the Linux kernel to mark a block good again that just that code doesn't exist doesn't mean you",
    "start": "1323399",
    "end": "1329370"
  },
  {
    "text": "can't write it because it's trivial it's just a bit flip but it does not exist the way computers work right now and it",
    "start": "1329370",
    "end": "1337559"
  },
  {
    "text": "doesn't for reason right because typically blocks go bad because hardware's failing you don't want to arbitrarily mark things good because",
    "start": "1337559",
    "end": "1344159"
  },
  {
    "text": "then the kernel will trust them it'll try writing to them and then you lose all your data it makes no sense therefore it's a one-way switch when you",
    "start": "1344159",
    "end": "1353190"
  },
  {
    "text": "flash a new ROM that new ROM is still looking in the bad block table so it's not going to write over that if you do a",
    "start": "1353190",
    "end": "1359669"
  },
  {
    "text": "factory reset is not going to write over that any of the tools that you would typically do for Android will not touch",
    "start": "1359669",
    "end": "1366750"
  },
  {
    "text": "that bad block which means I can take my phone right dead beef over half of it put a new ROM put a new kernel do a",
    "start": "1366750",
    "end": "1373710"
  },
  {
    "text": "factory reset and I've still got dead beef over half of it and nothing can see it but me so if that's a nice rootkit or",
    "start": "1373710",
    "end": "1380130"
  },
  {
    "text": "something like that all I need is one little jump after a complete refresh",
    "start": "1380130",
    "end": "1387090"
  },
  {
    "text": "complete clean install of a phone I need one jump to get back into my code because I've still got five Meg's 10",
    "start": "1387090",
    "end": "1394019"
  },
  {
    "text": "Meg's of code there that you're just never gonna see so",
    "start": "1394019",
    "end": "1400140"
  },
  {
    "text": "well you said you can start eating blocks and 512 Kbytes originally I just",
    "start": "1400140",
    "end": "1406690"
  },
  {
    "text": "wanted to hide code and it was like wait I can eat a drive it have a mega pop",
    "start": "1406690",
    "end": "1412590"
  },
  {
    "text": "which we'll come back to in one second so if you're trying to actually do an",
    "start": "1412590",
    "end": "1419830"
  },
  {
    "text": "exploit with us so you're trying to get reliable deep hidden code on a device you do have to realize that if you start",
    "start": "1419830",
    "end": "1426940"
  },
  {
    "text": "mucking with the bad block table that block disappears that means any of the nice things that you would normally rely",
    "start": "1426940",
    "end": "1434440"
  },
  {
    "text": "on finance like ECC values that will automatically compute and take care of",
    "start": "1434440",
    "end": "1440140"
  },
  {
    "text": "the individual bits that occasionally legitimately are dead on your block all",
    "start": "1440140",
    "end": "1445900"
  },
  {
    "text": "those protections go away so if you're actually writing this in the real world you need to just call that API back on",
    "start": "1445900",
    "end": "1451240"
  },
  {
    "text": "your dead blocks it's not rocket science but it just doesn't need to be done so",
    "start": "1451240",
    "end": "1458519"
  },
  {
    "text": "yeah like I said most forensics tools don't find me but um how could they",
    "start": "1458850",
    "end": "1465220"
  },
  {
    "text": "let's say we write new tools and they're better so let's let's play that game mentally for a second I write new tools",
    "start": "1465220",
    "end": "1471700"
  },
  {
    "text": "now I am gonna drop all the bad blocks remember way back at the beginning I said we're leveling was proprietary we",
    "start": "1471700",
    "end": "1478750"
  },
  {
    "text": "don't understand it that means that you don't know how data is actually supposed",
    "start": "1478750",
    "end": "1484870"
  },
  {
    "text": "to look on a block so if you see a block that's bad and you mark it as good again and start trying to do analysis on it",
    "start": "1484870",
    "end": "1491710"
  },
  {
    "text": "you really it's very difficult even with blocks that you know we're good to",
    "start": "1491710",
    "end": "1498040"
  },
  {
    "text": "traverse through names correctly and actually figure out what then the last version of the file is and what's junk",
    "start": "1498040",
    "end": "1504160"
  },
  {
    "text": "and what's not I mean it's doable we've crossed that it's impossible barrier but it's still not a hundred percent",
    "start": "1504160",
    "end": "1511420"
  },
  {
    "text": "reliable it's not 100% trustworthy once you take into the account that something could theoretically actually be bad you",
    "start": "1511420",
    "end": "1519250"
  },
  {
    "text": "started playing that game and you're playing a game where you don't understand what that data is actually supposed to look like at rest it's",
    "start": "1519250",
    "end": "1525820"
  },
  {
    "text": "really easy for me to hide I don't have to just write 512k of",
    "start": "1525820",
    "end": "1531190"
  },
  {
    "text": "of dead bee if I can write you know one bite every fifty I don't get a huge",
    "start": "1531190",
    "end": "1536830"
  },
  {
    "text": "chunk of memory to store data in but I can start interleaving my data with",
    "start": "1536830",
    "end": "1542470"
  },
  {
    "text": "residual junk and it becomes very very difficult to find me even if you've got",
    "start": "1542470",
    "end": "1548350"
  },
  {
    "text": "the tools so okay now we understand the",
    "start": "1548350",
    "end": "1555250"
  },
  {
    "text": "first part of the work let's kind of revisit that defense in general that I said at the beginning is not there it",
    "start": "1555250",
    "end": "1564070"
  },
  {
    "text": "could give better forensics tools and we really should we should start getting like runtime tools for the kernel that",
    "start": "1564070",
    "end": "1569910"
  },
  {
    "text": "starts looking at wire blocks failing so quickly like if 20 blocks are marked bad",
    "start": "1569910",
    "end": "1576040"
  },
  {
    "text": "on a device between reboots something's probably wrong but other than that any",
    "start": "1576040",
    "end": "1583540"
  },
  {
    "text": "other kind of trickery you start thinking of this starts not really making sense I mean the the last the",
    "start": "1583540",
    "end": "1591280"
  },
  {
    "text": "best suggestion I got from people was okay every time the kernel reboots let's look at the bad block table and everything that's in the bad block table",
    "start": "1591280",
    "end": "1597580"
  },
  {
    "text": "let's release everything and just make sure that it's all zeros or you know right ones to every or FFF across",
    "start": "1597580",
    "end": "1604210"
  },
  {
    "text": "everything that's a bad block and then verify well you can do that but remember it fails legitimately bits go bad you",
    "start": "1604210",
    "end": "1613090"
  },
  {
    "text": "can't write you can't release so that kernel trickery would kind of work but",
    "start": "1613090",
    "end": "1619180"
  },
  {
    "text": "it would fail really quickly or it would be unreliable very very very fast I'm",
    "start": "1619180",
    "end": "1625690"
  },
  {
    "text": "not saying it's not a good path to go down but it doesn't feel legit to me and",
    "start": "1625690",
    "end": "1632470"
  },
  {
    "text": "again we still have to use NAND so we can arbitrarily hide data on and and there's really nothing we can do about",
    "start": "1632470",
    "end": "1638170"
  },
  {
    "text": "it and then I was talking to my boss and you had the JV team in full up and time",
    "start": "1638170",
    "end": "1644530"
  },
  {
    "text": "our quote which I loved um so I wanted to hide things and I realized I could",
    "start": "1644530",
    "end": "1649870"
  },
  {
    "text": "start eating data and I was like well what can I do with that my first thought was like if I want to exfiltrate a whole",
    "start": "1649870",
    "end": "1656470"
  },
  {
    "text": "bunch of data out of a network it really sucks if I'm trying to exfil gigs and",
    "start": "1656470",
    "end": "1661600"
  },
  {
    "text": "gigs and gigs and gauges and gigs of like raw corporate right so what if I didn't have to exfil",
    "start": "1661600",
    "end": "1666830"
  },
  {
    "text": "it what if I just say like screw it I'm just gonna mark every block that I want data on that drive is bad what's the",
    "start": "1666830",
    "end": "1674270"
  },
  {
    "text": "user gonna do the users gonna go complain to IT I t's gonna go they're gonna forensically wipe the drive so none of the corporate",
    "start": "1674270",
    "end": "1681830"
  },
  {
    "text": "data it gets you know out into the wild and at some point that drives gonna go in the trash",
    "start": "1681830",
    "end": "1686960"
  },
  {
    "text": "so because none of the tools actually wipe bad blocks I've just physically",
    "start": "1686960",
    "end": "1692419"
  },
  {
    "text": "exfilled gigs or terabytes of data simply by just making any of that IT",
    "start": "1692419",
    "end": "1698330"
  },
  {
    "text": "guys Tools work and that was thought one and that was kind of fun um so and then",
    "start": "1698330",
    "end": "1706429"
  },
  {
    "text": "we want to step further and started a little looking at okay there are a ton of skated devices that",
    "start": "1706429",
    "end": "1713270"
  },
  {
    "text": "used and there are a ton of just embedded devices in general around the world that used and if you start eating",
    "start": "1713270",
    "end": "1718820"
  },
  {
    "text": "the drive from them by just arbitrarily marking blocks bad again nothing recovers them so once",
    "start": "1718820",
    "end": "1725419"
  },
  {
    "text": "they're marked blad you can't restore the machine if it's an android phone",
    "start": "1725419",
    "end": "1730730"
  },
  {
    "text": "that's annoying and you get pissed off if that's some flow control on an oil",
    "start": "1730730",
    "end": "1736039"
  },
  {
    "text": "pipeline that you've remotely popped and just killed that thing can't be fixed over-the-air that can't can't even",
    "start": "1736039",
    "end": "1742220"
  },
  {
    "text": "really be reflashed in person you physically have to replace skated devices or at least the drives on SCADA",
    "start": "1742220",
    "end": "1748580"
  },
  {
    "text": "devices that becomes scary to me at least and I guess interesting so my",
    "start": "1748580",
    "end": "1758120"
  },
  {
    "text": "requests would be have fun with the research but be cool maybe also try to find a better fix than I have as my fix",
    "start": "1758120",
    "end": "1766700"
  },
  {
    "text": "is talking you all and telling you about it so at least we all know that there's a problem and again please leave",
    "start": "1766700",
    "end": "1774200"
  },
  {
    "text": "feedback I'm gonna finish a little earlier so I can take questions but as an appreciation for you leaving feedback",
    "start": "1774200",
    "end": "1782650"
  },
  {
    "text": "I'll tell you a little bit about panic right if you start looking in the Linux",
    "start": "1782650",
    "end": "1787909"
  },
  {
    "text": "kernel in a handful of places you'll see the call to panic right panic right is designed and panic right takes a couple",
    "start": "1787909",
    "end": "1794899"
  },
  {
    "text": "arguments one is data and one is exactly and you want to write that data the concept is a black box flight recorder",
    "start": "1794899",
    "end": "1801509"
  },
  {
    "text": "if you have a device like that you want to write two names no matter what so you",
    "start": "1801509",
    "end": "1807809"
  },
  {
    "text": "get kernel faults you want to write tune and panic right basically just says I",
    "start": "1807809",
    "end": "1813059"
  },
  {
    "text": "don't care privileges I don't care where I'm supposed to write none of that I bypass all the securities",
    "start": "1813059",
    "end": "1819029"
  },
  {
    "text": "and I write whatever you tell me wherever you tell me to go so if you",
    "start": "1819029",
    "end": "1824220"
  },
  {
    "text": "played with panic right mixed with I don't know just any time you segfault you could probably have a lot of fun and",
    "start": "1824220",
    "end": "1830429"
  },
  {
    "text": "that is my gift to you for leaving feedback um any questions",
    "start": "1830429",
    "end": "1836059"
  },
  {
    "text": "um so I'm gonna repeat the question on the managed Nan's side he's asking can",
    "start": "1843930",
    "end": "1849190"
  },
  {
    "text": "you still read back an arbitrarily right two blocks that are marked bad the only",
    "start": "1849190",
    "end": "1855280"
  },
  {
    "text": "difference in the code that I've released and you would basically have to port my code to the embedded controller",
    "start": "1855280",
    "end": "1862810"
  },
  {
    "text": "at that point you still have the same arbitrary ability that you would normally the only extra step in that",
    "start": "1862810",
    "end": "1870220"
  },
  {
    "text": "exploit over the nice open source the exploit is you'd have to be able to pop",
    "start": "1870220",
    "end": "1876300"
  },
  {
    "text": "and get the ability to write read and write firmware on that controller which",
    "start": "1876300",
    "end": "1882220"
  },
  {
    "text": "I'm not making public yes",
    "start": "1882220",
    "end": "1888240"
  },
  {
    "text": "yes so the solid-state hard drives would encrypt all the data that goes on there if you want a hex fill this is true",
    "start": "1895440",
    "end": "1902350"
  },
  {
    "text": "unless you also mark where the encryption keys are stored on devices bad at which point it's like an iPhone",
    "start": "1902350",
    "end": "1908679"
  },
  {
    "text": "right you know you know where the keys on an iPhone are you may you may have to do a little bit of work but you can",
    "start": "1908679",
    "end": "1914590"
  },
  {
    "text": "still get them um it is not perfect it's not as clean as if it wasn't encrypted",
    "start": "1914590",
    "end": "1920409"
  },
  {
    "text": "but if it's done in hardware then yeah",
    "start": "1920409",
    "end": "1925809"
  },
  {
    "text": "you'd probably not be able to do it that's true huh so yay for hardware encryption any more questions awesome",
    "start": "1925809",
    "end": "1937090"
  },
  {
    "text": "well thank everybody for coming out appreciate it greatly",
    "start": "1937090",
    "end": "1941669"
  }
]