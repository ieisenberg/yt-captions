[
  {
    "text": "good afternoon ladies and gentlemen and welcome to this session about The",
    "start": "30",
    "end": "5460"
  },
  {
    "text": "Adventures of Av in the leaky sandbox with me is Itzik cutler who's the CTO",
    "start": "5460",
    "end": "13320"
  },
  {
    "text": "and co-founder of safe bridge and yours truly Amit Klein and I'm the VP security",
    "start": "13320",
    "end": "21090"
  },
  {
    "text": "research for safe reach as well and the reference topology reference",
    "start": "21090",
    "end": "28730"
  },
  {
    "text": "architecture that we are addressing today is a highly secure enterprise that",
    "start": "28730",
    "end": "35850"
  },
  {
    "text": "of which we we are looking at two variants the first variant is where they",
    "start": "35850",
    "end": "42780"
  },
  {
    "text": "enterprise the endpoints have restricted the internet access so what their only",
    "start": "42780",
    "end": "50149"
  },
  {
    "text": "access to the Internet is limited to hosts and servers and services on the",
    "start": "50149",
    "end": "57149"
  },
  {
    "text": "internet that are strictly needed for the proper functioning of the endpoints",
    "start": "57149",
    "end": "62359"
  },
  {
    "text": "such servers and hosts are for example",
    "start": "62359",
    "end": "67460"
  },
  {
    "text": "Microsoft Update Services in servers that are needed for updating the Windows",
    "start": "67460",
    "end": "73200"
  },
  {
    "text": "operating system of the endpoint and antivirus servers or services that are",
    "start": "73200",
    "end": "79920"
  },
  {
    "text": "needed to update the antivirus agent on the endpoint machine and to for the",
    "start": "79920",
    "end": "85560"
  },
  {
    "text": "antivirus agent to be able to send data back to the antivirus servers other",
    "start": "85560",
    "end": "92390"
  },
  {
    "text": "access to the internet such as browsing to www.google.com is prohibited and is",
    "start": "92390",
    "end": "101329"
  },
  {
    "text": "blocked either at a personal firewall level at the endpoint itself or via a",
    "start": "101329",
    "end": "108119"
  },
  {
    "text": "network firewall operated by the enterprise so the machines have very",
    "start": "108119",
    "end": "113299"
  },
  {
    "text": "restricted access to the Internet as you can see and the second variant is even",
    "start": "113299",
    "end": "118860"
  },
  {
    "text": "stricter wherein the endpoints have no direct internet access whatsoever",
    "start": "118860",
    "end": "124610"
  },
  {
    "text": "instead they get updated I can provide they can upload data today",
    "start": "124610",
    "end": "133690"
  },
  {
    "text": "to submit to the legal and legitimate services through a on-premises service",
    "start": "133690",
    "end": "142209"
  },
  {
    "text": "so for example the organization may have on a separate line segment a Windows Update server and an anti-virus",
    "start": "142209",
    "end": "149590"
  },
  {
    "text": "management server with which the endpoints can communicate and those",
    "start": "149590",
    "end": "155349"
  },
  {
    "text": "servers in turn have internet access to their LAN segment only and they can",
    "start": "155349",
    "end": "162549"
  },
  {
    "text": "connect to their respective internet servers and services and upload download",
    "start": "162549",
    "end": "169510"
  },
  {
    "text": "updates and upload aesthetics statistics and data for the services for for",
    "start": "169510",
    "end": "175900"
  },
  {
    "text": "Windows updates and antivirus services so as you can see the the main thing",
    "start": "175900",
    "end": "184060"
  },
  {
    "text": "here is endpoints that have very little to no internet connection and yet it's",
    "start": "184060",
    "end": "192010"
  },
  {
    "text": "not a complete air-gapped Enterprise in the sense that some internet connections",
    "start": "192010",
    "end": "197950"
  },
  {
    "text": "are allowed from somewhere in the in the corporate network either from the",
    "start": "197950",
    "end": "204680"
  },
  {
    "text": "endpoints themselves to very specific servers or for all from on-premise",
    "start": "204680",
    "end": "210250"
  },
  {
    "text": "management servers again to a limited set of legitimate hosts that's the",
    "start": "210250",
    "end": "217640"
  },
  {
    "text": "reference environment or setup that we are going to look at throughout this",
    "start": "217640",
    "end": "223570"
  },
  {
    "text": "presentation and that's the reference architecture upon which our research",
    "start": "223570",
    "end": "230780"
  },
  {
    "text": "took place so let's throw into this mix",
    "start": "230780",
    "end": "235810"
  },
  {
    "text": "the cloud enhance enhancement of the antivirus it's very popular nowadays",
    "start": "235810",
    "end": "241420"
  },
  {
    "text": "everybody loves what we call the wisdom of the clouds and it seems that nothing",
    "start": "241420",
    "end": "247280"
  },
  {
    "text": "can possibly go wrong with adding this cloud component to the traditional",
    "start": "247280",
    "end": "252500"
  },
  {
    "text": "antivirus so we claimed otherwise we",
    "start": "252500",
    "end": "259549"
  },
  {
    "text": "claimed that adding cloud antivirus can actually degrade the security of the",
    "start": "259550",
    "end": "265160"
  },
  {
    "text": "endpoint and that's exactly what we are going to discuss today so how do we go",
    "start": "265160",
    "end": "271580"
  },
  {
    "text": "and how do we go on and do and degrade the security of the endpoint again we",
    "start": "271580",
    "end": "278390"
  },
  {
    "text": "assume the highly secure Enterprise with restricted or no internet connection",
    "start": "278390",
    "end": "284390"
  },
  {
    "text": "allowed from its endpoints and we are going to use the cloud antivirus to",
    "start": "284390",
    "end": "290660"
  },
  {
    "text": "exfiltrate data from the endpoint meaning the degradation that we are",
    "start": "290660",
    "end": "296990"
  },
  {
    "text": "going to expose today is about exfiltration of data and the thing to",
    "start": "296990",
    "end": "303800"
  },
  {
    "text": "remember is that in our the technique that we are going to show today places",
    "start": "303800",
    "end": "310700"
  },
  {
    "text": "no limitation on where the attacker is on the Internet it help the attacker doesn't need to be only on the",
    "start": "310700",
    "end": "318250"
  },
  {
    "text": "enterprise ISP or on some kind of routing from the enterprise to somewhere",
    "start": "318250",
    "end": "324350"
  },
  {
    "text": "on the internet or anything of that sort attacker can be any arbitrary internet host anywhere",
    "start": "324350",
    "end": "329670"
  },
  {
    "text": "anyone in the world it does not have to be also of course in physical proximity to the corporate and what we are in how",
    "start": "329670",
    "end": "338140"
  },
  {
    "text": "we are going to do that by abusing the cloud antivirus sandbox",
    "start": "338140",
    "end": "344410"
  },
  {
    "text": "as we'll expand on a bit later so before",
    "start": "344410",
    "end": "350890"
  },
  {
    "text": "we go on and describe our technique and explain how we are going to do what what",
    "start": "350890",
    "end": "358810"
  },
  {
    "text": "we are talking about I would like to discuss some related work and see how we",
    "start": "358810",
    "end": "366760"
  },
  {
    "text": "fit in in the world of research around sandboxes and anti viruses and",
    "start": "366760",
    "end": "372220"
  },
  {
    "text": "exfiltration at large so first with respect to X filtration at large",
    "start": "372220",
    "end": "378610"
  },
  {
    "text": "obviously we are not first to explain what X filtration is and discuss",
    "start": "378610",
    "end": "383980"
  },
  {
    "text": "techniques to exfiltrate data though there is a lot of result there is a",
    "start": "383980",
    "end": "390550"
  },
  {
    "text": "large research corpus around acceleration at large we provide here a",
    "start": "390550",
    "end": "399750"
  },
  {
    "text": "three-three quite comprehensive compilation of techniques however the",
    "start": "399750",
    "end": "407920"
  },
  {
    "text": "common theme to a lot or most the large",
    "start": "407920",
    "end": "414280"
  },
  {
    "text": "majority of the research is that it assumes that an end point for Mitchell",
    "start": "414280",
    "end": "420250"
  },
  {
    "text": "exfiltration tape needs to take place has no restriction over which hosts to",
    "start": "420250",
    "end": "426730"
  },
  {
    "text": "which has the exfiltration is it's taking place so basically it's a pretty",
    "start": "426730",
    "end": "435130"
  },
  {
    "text": "different scenario from what we are trying to address where in",
    "start": "435130",
    "end": "440630"
  },
  {
    "text": "the endpoint has no internet access whatsoever or the endpoint has a very",
    "start": "440630",
    "end": "446060"
  },
  {
    "text": "limited internet access and only to a trusted host host from Microsoft or a",
    "start": "446060",
    "end": "452560"
  },
  {
    "text": "antivirus vendor so all this research is not directly relevant to the to the",
    "start": "452560",
    "end": "461150"
  },
  {
    "text": "technique that we are going to describe at least not to the first stage we will see how and when we can use this",
    "start": "461150",
    "end": "468250"
  },
  {
    "text": "research in the last phase of the acceleration of course on the other",
    "start": "468250",
    "end": "475310"
  },
  {
    "text": "extremity there's research on exit rating data from air-gapped enterprises",
    "start": "475310",
    "end": "482500"
  },
  {
    "text": "lots of recent amazing research from a Ben Gurion University research group led",
    "start": "482500",
    "end": "489770"
  },
  {
    "text": "by a professor eval LOV Chi X so they explored X filtration by hard drive LEDs",
    "start": "489770",
    "end": "497810"
  },
  {
    "text": "and then by hard drive noise and then by thermal very variations of of the hard",
    "start": "497810",
    "end": "509090"
  },
  {
    "text": "drive and computer systems at large and lastly I believe that they published",
    "start": "509090",
    "end": "515210"
  },
  {
    "text": "recently research on using router LEDs as a way of associating data however the",
    "start": "515210",
    "end": "521510"
  },
  {
    "text": "common requirement or restriction of this of all these methods is that they",
    "start": "521510",
    "end": "527780"
  },
  {
    "text": "require the attacker to be in proximity to the attacked organization and",
    "start": "527780",
    "end": "533380"
  },
  {
    "text": "proximity here is meters to hundreds of meters so it's not really accessible to",
    "start": "533380",
    "end": "540260"
  },
  {
    "text": "a lot of the attackers so and that's where our technique is a superior to to",
    "start": "540260",
    "end": "549020"
  },
  {
    "text": "those amazing techniques and amazing research",
    "start": "549020",
    "end": "556209"
  },
  {
    "text": "a bit more relevant to the technologies that we developed our X filtration",
    "start": "557690",
    "end": "565430"
  },
  {
    "text": "techniques using third-party sites in this case the third-party site can be",
    "start": "565430",
    "end": "571270"
  },
  {
    "text": "can be the update servers from Microsoft or from the antivirus vendors and so we",
    "start": "571270",
    "end": "580400"
  },
  {
    "text": "need to explore or or review whether existing X filtration techniques using",
    "start": "580400",
    "end": "586580"
  },
  {
    "text": "third-party sites are relevant in our case first is one developed many years",
    "start": "586580",
    "end": "592280"
  },
  {
    "text": "ago via IP the IP ID field of the TCP of",
    "start": "592280",
    "end": "600260"
  },
  {
    "text": "the IP protocol it's a similar or uses",
    "start": "600260",
    "end": "605690"
  },
  {
    "text": "the same phenomenon it's a idle scan if you're familiar with that technique but",
    "start": "605690",
    "end": "611030"
  },
  {
    "text": "that and essentially it relies on the fact that the operating system of the",
    "start": "611030",
    "end": "616580"
  },
  {
    "text": "third party side uses a global IP ID counter unfortunately nowadays modern",
    "start": "616580",
    "end": "623480"
  },
  {
    "text": "operating system have completely abandoned this implementation of the IP ID counter in favor of more secure",
    "start": "623480",
    "end": "631790"
  },
  {
    "text": "implementations and so this technique is now adays unfortunately less relevant",
    "start": "631790",
    "end": "639400"
  },
  {
    "text": "other two related techniques are using a TCP syn initial sequence number or",
    "start": "639400",
    "end": "646820"
  },
  {
    "text": "source port and or using a UDP saw sport or payload in combined with spoofed",
    "start": "646820",
    "end": "654140"
  },
  {
    "text": "source IP to send a packet out from the endpoint to the trusted host and have",
    "start": "654140",
    "end": "661880"
  },
  {
    "text": "the trusted host bounced it to attackers server which is identified by the",
    "start": "661880",
    "end": "668120"
  },
  {
    "text": "spoofed source IP however if since we are looking at high",
    "start": "668120",
    "end": "675260"
  },
  {
    "text": "security organizations we should assume that there is a gross fill",
    "start": "675260",
    "end": "680850"
  },
  {
    "text": "implemented at the firewall and a graceful turn would notice the spoofed IP a spoof source IP and would drop the",
    "start": "680850",
    "end": "688770"
  },
  {
    "text": "packets so that's the end of the story for those two methods finally in 2006",
    "start": "688770",
    "end": "698100"
  },
  {
    "text": "its second I presented in hacking the Box a technique called perfect what we",
    "start": "698100",
    "end": "703350"
  },
  {
    "text": "call perfect filtration that uses some caching and browsing properties of",
    "start": "703350",
    "end": "713000"
  },
  {
    "text": "third-party sites or site structure and caching properties of third-party sites",
    "start": "713000",
    "end": "718950"
  },
  {
    "text": "in order to exfiltrate data unfortunately again in our case we are",
    "start": "718950",
    "end": "726000"
  },
  {
    "text": "looking at update servers and not on what not well not looking at sites that",
    "start": "726000",
    "end": "732090"
  },
  {
    "text": "are actually browsable and maybe not even using HTTP so again that prior",
    "start": "732090",
    "end": "739140"
  },
  {
    "text": "research is less relevant to the case at hand we are now a few words about",
    "start": "739140",
    "end": "749420"
  },
  {
    "text": "research prior research and antivirus and boxes again lots and lots of",
    "start": "749420",
    "end": "755070"
  },
  {
    "text": "research on exists on AV same boxes and",
    "start": "755070",
    "end": "760520"
  },
  {
    "text": "specifically about leaking data from antivirus send boxes and it's the list",
    "start": "760520",
    "end": "767190"
  },
  {
    "text": "goes on and on but the important thing to keep in mind is that don't that",
    "start": "767190",
    "end": "772590"
  },
  {
    "text": "research while very valuable and in innovative manages to lick data about",
    "start": "772590",
    "end": "783090"
  },
  {
    "text": "the sandbox itself it does not leak data from an endpoint outside the sandbox so",
    "start": "783090",
    "end": "790410"
  },
  {
    "text": "it can be a bit confusing but those that that prior research does not cover the",
    "start": "790410",
    "end": "797570"
  },
  {
    "text": "technique or what we are going to show you today it's merely the exfiltrating",
    "start": "797570",
    "end": "803580"
  },
  {
    "text": "data on the sandbox itself in order to be able to later detect the sandbox and to enable to understand",
    "start": "803580",
    "end": "809850"
  },
  {
    "text": "the capabilities of the sandbox or the properties of the sandbox itself it does not address the issue of exfiltrating",
    "start": "809850",
    "end": "817709"
  },
  {
    "text": "data from an end point of an organization there is however one case",
    "start": "817709",
    "end": "825930"
  },
  {
    "text": "by one discovery by pterosaur Mundi concerning the Komodo local sandbox",
    "start": "825930",
    "end": "833990"
  },
  {
    "text": "sandbox implemented on the endpoint itself in which case tavis was able to",
    "start": "833990",
    "end": "840540"
  },
  {
    "text": "accelerate data from the endpoint to the internet however Travis so in this case",
    "start": "840540",
    "end": "846089"
  },
  {
    "text": "tothis did exfiltrate data about the endpoint itself but it did not concern",
    "start": "846089",
    "end": "851579"
  },
  {
    "text": "the problem of accelerating the data from an end point wherein the internet",
    "start": "851579",
    "end": "857910"
  },
  {
    "text": "connection is restricted or does not even allowed in the first place so again",
    "start": "857910",
    "end": "863459"
  },
  {
    "text": "a different scenario so I hope I managed",
    "start": "863459",
    "end": "870060"
  },
  {
    "text": "to persuade you that our research is no villain we are addressing a problem that no one else so far addressed and before",
    "start": "870060",
    "end": "878009"
  },
  {
    "text": "I'm going to describe the exact technique or set of techniques that we use I'm going to talk about two building",
    "start": "878009",
    "end": "887790"
  },
  {
    "text": "blocks that we need the first building",
    "start": "887790",
    "end": "892980"
  },
  {
    "text": "block is way a way to trigger an anti-virus prop antivirus product",
    "start": "892980",
    "end": "899660"
  },
  {
    "text": "obviously we are not inventing anything new here there are lots of ways to",
    "start": "899660",
    "end": "905250"
  },
  {
    "text": "trigger an anti-virus product and in fact the list a long list is compiled in",
    "start": "905250",
    "end": "911459"
  },
  {
    "text": "one of the papers that we mentioned earlier by a policy and in fact while",
    "start": "911459",
    "end": "919860"
  },
  {
    "text": "that paper lists quite a lot of techniques to trigger named antivirus",
    "start": "919860",
    "end": "926130"
  },
  {
    "text": "products some of them are quite sophisticated we settled for very simple two techniques one is writing the i-car",
    "start": "926130",
    "end": "934949"
  },
  {
    "text": "file to disk the IKr file as a sixty sixty eight bit file which is a",
    "start": "934949",
    "end": "940580"
  },
  {
    "text": "malware it's not really an executable in Windows 32 or in the 64 environment but",
    "start": "940580",
    "end": "947930"
  },
  {
    "text": "it is supposed to be detected as malware by all antivirus products and the second",
    "start": "947930",
    "end": "956570"
  },
  {
    "text": "technique is installing or persisting our quota of malware by moving in its",
    "start": "956570",
    "end": "964430"
  },
  {
    "text": "binary to under the windows startup folder as you know antivirus products",
    "start": "964430",
    "end": "971390"
  },
  {
    "text": "typically look for suspicious behavior suspicious behavior in such case is",
    "start": "971390",
    "end": "976870"
  },
  {
    "text": "persisting and executable so that it does not execute just once but every",
    "start": "976870",
    "end": "982160"
  },
  {
    "text": "time the computer boots or the user logs in which is exactly what we are simulating here a second technique a",
    "start": "982160",
    "end": "992380"
  },
  {
    "text": "second building block I'm sorry is accelerating expectation of data from an",
    "start": "992380",
    "end": "997940"
  },
  {
    "text": "internet-connected machine again this is a solved problem in essence as you mentioned there are many ways of doing",
    "start": "997940",
    "end": "1005230"
  },
  {
    "text": "it there are even three compilations of various techniques to achieve that that",
    "start": "1005230",
    "end": "1011350"
  },
  {
    "text": "we surveyed in one of the previous slides and again we are going to use the",
    "start": "1011350",
    "end": "1016810"
  },
  {
    "text": "very basic two techniques one is simply sending HTTP HTTP request to the",
    "start": "1016810",
    "end": "1023380"
  },
  {
    "text": "attackers host with the data to exfiltrate in the post body body section and the",
    "start": "1023380",
    "end": "1033459"
  },
  {
    "text": "second one is slightly more sophisticated using a dns resolution in which case the attacker say has a domain",
    "start": "1033459",
    "end": "1041470"
  },
  {
    "text": "that the attacker owns the attacker also sets up an authoritative DNS server",
    "start": "1041470",
    "end": "1047770"
  },
  {
    "text": "responsible for that domain and now the malware that needs to exit eight data",
    "start": "1047770",
    "end": "1053670"
  },
  {
    "text": "forms a DNS query with this small part a chunk of the exfiltrated data as a sub",
    "start": "1053670",
    "end": "1060970"
  },
  {
    "text": "domain of off of the domain to be resolved word of the host name to be",
    "start": "1060970",
    "end": "1066400"
  },
  {
    "text": "resolved so we have sub if the exfiltrated data in it could be a few dozen bytes followed by a day and",
    "start": "1066400",
    "end": "1073620"
  },
  {
    "text": "this is followed by the attackers domain and this query is this this hostname is",
    "start": "1073620",
    "end": "1080670"
  },
  {
    "text": "then forcefully the tsardom our forces",
    "start": "1080670",
    "end": "1086040"
  },
  {
    "text": "dns resolution for this hostname by invoking for example a gate host by name",
    "start": "1086040",
    "end": "1093300"
  },
  {
    "text": "or get a DDR info and then the operating system connects to the DNS resolver",
    "start": "1093300",
    "end": "1102450"
  },
  {
    "text": "configured for it and forwards this Square to the DMS although the deal so does all the DNS resolution from the",
    "start": "1102450",
    "end": "1110640"
  },
  {
    "text": "possible even from the DNS root until it gets to the DNS the photo DNS of the of",
    "start": "1110640",
    "end": "1119610"
  },
  {
    "text": "the attacker and it sends the authoritative DNS of the attacker the hostname to be resolved and the attacker",
    "start": "1119610",
    "end": "1125520"
  },
  {
    "text": "can respond with any arbitrary IP but the attacker now gets hold of the chunk",
    "start": "1125520",
    "end": "1132450"
  },
  {
    "text": "of the information a few dozen bites the today actually the subdomain of this query and it can log them and with the",
    "start": "1132450",
    "end": "1138870"
  },
  {
    "text": "sequence of such DNS queries we can actually exfiltrate arbitrary amount of",
    "start": "1138870",
    "end": "1145440"
  },
  {
    "text": "data so that's the DNS query exfiltration method again noting here",
    "start": "1145440",
    "end": "1151830"
  },
  {
    "text": "that we did not invent these methods well known so these are the two building",
    "start": "1151830",
    "end": "1158040"
  },
  {
    "text": "blocks that will need later in order to perform a filtration and now for the",
    "start": "1158040",
    "end": "1165120"
  },
  {
    "text": "exfiltration technique itself again i remind you or here are the assumptions that we make assumptions are we have an",
    "start": "1165120",
    "end": "1171990"
  },
  {
    "text": "anti-virus product installed on endpoints which submits samples to the antivirus cloud it can be either",
    "start": "1171990",
    "end": "1179970"
  },
  {
    "text": "directly from the endpoint or indirectly via an on-premise server and then this",
    "start": "1179970",
    "end": "1186090"
  },
  {
    "text": "the AV cloud service uses a sandbox to a risk to ant to further analyze the",
    "start": "1186090",
    "end": "1193230"
  },
  {
    "text": "sample and that sandbox has a direct connection or allows direct connections to the internet and finally",
    "start": "1193230",
    "end": "1201340"
  },
  {
    "text": "we also assume that the end point is of course you've already infected how an",
    "start": "1201340",
    "end": "1208279"
  },
  {
    "text": "endpoint gets infected is out of scope for this for this research presentation",
    "start": "1208279",
    "end": "1213380"
  },
  {
    "text": "I'm sure I don't need to teach any of you how infections happen even in high",
    "start": "1213380",
    "end": "1219559"
  },
  {
    "text": "security organizations infected USB sticks can be a can in fact machines so",
    "start": "1219559",
    "end": "1229130"
  },
  {
    "text": "obviously this is a well known problem",
    "start": "1229130",
    "end": "1234559"
  },
  {
    "text": "and issue and I think that the concept of assume a machine is in fact that is",
    "start": "1234559",
    "end": "1240740"
  },
  {
    "text": "the facto standard in the security industry so the attack before I",
    "start": "1240740",
    "end": "1249200"
  },
  {
    "text": "described the exact steps of the attack I also want to define two terms one is",
    "start": "1249200",
    "end": "1255950"
  },
  {
    "text": "what we call a rocket the rocket is the main malware the malware that was",
    "start": "1255950",
    "end": "1261230"
  },
  {
    "text": "already that that the endpoint is already running as we said the endpoint",
    "start": "1261230",
    "end": "1266899"
  },
  {
    "text": "is the infected and the rocket is responsible for collecting the data for",
    "start": "1266899",
    "end": "1272899"
  },
  {
    "text": "exfiltration and then starting the chain reaction of exfiltration the rocket has",
    "start": "1272899",
    "end": "1279740"
  },
  {
    "text": "a vanilla satellite satellite is a tiny malware",
    "start": "1279740",
    "end": "1285399"
  },
  {
    "text": "that actually carries out the acceleration and the rocket has what we call a vanilla flavor of the satellite",
    "start": "1285399",
    "end": "1292529"
  },
  {
    "text": "embedded or hardwired inside it's a it's binary would say it's it's process image",
    "start": "1292529",
    "end": "1299379"
  },
  {
    "text": "is process memory image so this inside rocket is a smaller executable called satellite and the satellite has logic to",
    "start": "1299379",
    "end": "1307809"
  },
  {
    "text": "trigger the antivirus agent and also to carry out the actual internet extraction",
    "start": "1307809",
    "end": "1317039"
  },
  {
    "text": "so as we said step zero is having the Machine infected again out of scope for",
    "start": "1317039",
    "end": "1322749"
  },
  {
    "text": "this presentation but and we assume that we start with step one where the machine",
    "start": "1322749",
    "end": "1329230"
  },
  {
    "text": "is infected by the rocket as you can see the rocket contains a small executable",
    "start": "1329230",
    "end": "1335739"
  },
  {
    "text": "the this small tiny a satellite icon inside it so we have a a small piece of",
    "start": "1335739",
    "end": "1342960"
  },
  {
    "text": "another executable inside the larger rocket executable and large the large",
    "start": "1342960",
    "end": "1348999"
  },
  {
    "text": "rocket process memory image now the",
    "start": "1348999",
    "end": "1354820"
  },
  {
    "text": "rocket collects the data to be exfiltrated as you can see it embedded",
    "start": "1354820",
    "end": "1363940"
  },
  {
    "text": "the data into the satellite image in its memory and the data is the tiny red dot",
    "start": "1363940",
    "end": "1370989"
  },
  {
    "text": "inside the satellite that's the representation of the data the tiny red dot and so the rocket collect the data",
    "start": "1370989",
    "end": "1379179"
  },
  {
    "text": "and puts it inside a buffer that is a a static buffer that is allocated in",
    "start": "1379179",
    "end": "1385760"
  },
  {
    "text": "compile time inside this satellite and let's say we can put like 100 K 1",
    "start": "1385760",
    "end": "1392780"
  },
  {
    "text": "megabyte of data inside this satellite is like a static buffer and it's being",
    "start": "1392780",
    "end": "1398030"
  },
  {
    "text": "filled by the rocket now the rocket",
    "start": "1398030",
    "end": "1403250"
  },
  {
    "text": "writes the satellite image with the data collected inside this image to disk and",
    "start": "1403250",
    "end": "1410410"
  },
  {
    "text": "executes it in the regular manner and calling system or whatnot now there are",
    "start": "1410410",
    "end": "1417320"
  },
  {
    "text": "two malware processes running side by side the original rocket the original",
    "start": "1417320",
    "end": "1423410"
  },
  {
    "text": "malware the main malware and the satellite man the smaller satellite process malware which contains inside it",
    "start": "1423410",
    "end": "1430400"
  },
  {
    "text": "as we said the collected data now the satellite runs its antivirus triggering",
    "start": "1430400",
    "end": "1437510"
  },
  {
    "text": "logic and antivirus of course detects it and maybe quarantines it but it also",
    "start": "1437510",
    "end": "1443390"
  },
  {
    "text": "because it has a cloud in hand because it's cloud enhanced it sends the sample",
    "start": "1443390",
    "end": "1448820"
  },
  {
    "text": "as is to this to the cloud for further inspection and further analysis and a",
    "start": "1448820",
    "end": "1456440"
  },
  {
    "text": "part of this further analysis and inspection the antivirus cloud server",
    "start": "1456440",
    "end": "1461540"
  },
  {
    "text": "executes the satellite in a sandbox and there's the rub the sandbox is open to",
    "start": "1461540",
    "end": "1469100"
  },
  {
    "text": "the Internet does not prevent all or some protocols or ports or types of",
    "start": "1469100",
    "end": "1475370"
  },
  {
    "text": "connection from the sandbox to the Internet and this is exploited by the Sun but by the satellite to act to",
    "start": "1475370",
    "end": "1482750"
  },
  {
    "text": "finally exfiltrate the collected data back to the attackers command and control server and thereby achieving",
    "start": "1482750",
    "end": "1489710"
  },
  {
    "text": "full acceleration in game over we tested",
    "start": "1489710",
    "end": "1495620"
  },
  {
    "text": "this technique or a set of techniques against the 10 out of the 11 top market",
    "start": "1495620",
    "end": "1503540"
  },
  {
    "text": "share vendors in the recent ops what most recent absurd AV marketer unfortunately",
    "start": "1503540",
    "end": "1511120"
  },
  {
    "text": "the most up-to-date one for pure a/v players was from 2015 but I don't think",
    "start": "1511120",
    "end": "1517420"
  },
  {
    "text": "that the market changed drastically since and the results are as following",
    "start": "1517420",
    "end": "1523300"
  },
  {
    "text": "of the 10 products we tested four were found vulnerable to this attack and for",
    "start": "1523300",
    "end": "1529390"
  },
  {
    "text": "our Veera he said Kaspersky and Komodo as you can",
    "start": "1529390",
    "end": "1534520"
  },
  {
    "text": "see there were some variants not not each and every technique was",
    "start": "1534520",
    "end": "1539940"
  },
  {
    "text": "successfully applied to each and every product but for each product that we",
    "start": "1539940",
    "end": "1545860"
  },
  {
    "text": "found a vulnerable there was some combination or there was a combination of techniques that managed to exfiltrate",
    "start": "1545860",
    "end": "1552520"
  },
  {
    "text": "data from the from that product obviously a triggering and antivirus",
    "start": "1552520",
    "end": "1560050"
  },
  {
    "text": "agent has some visual cues so it's the attack is not too subtle but it doesn't",
    "start": "1560050",
    "end": "1566770"
  },
  {
    "text": "really matter because the data is already that has already has already left the endpoint it's already being",
    "start": "1566770",
    "end": "1573640"
  },
  {
    "text": "sent to the antivirus a server and executed there so there's no way for the",
    "start": "1573640",
    "end": "1580690"
  },
  {
    "text": "endpoint or for the enterprise to prevent this exfiltration from happening",
    "start": "1580690",
    "end": "1588990"
  },
  {
    "text": "during this research of course we interacted with the sandboxes of those four vendors and we collected some",
    "start": "1593500",
    "end": "1599680"
  },
  {
    "text": "insights about the sandboxes themselves again and there does a lot of research on sandboxes and this is what we found",
    "start": "1599680",
    "end": "1606400"
  },
  {
    "text": "from our experience first interestingly some sent boxes like ESET blocked HTTP",
    "start": "1606400",
    "end": "1612970"
  },
  {
    "text": "but did not block DNS that's why it's always good to try several methods because some one of them some of them",
    "start": "1612970",
    "end": "1619450"
  },
  {
    "text": "may be blocked but others sometimes are successful some send boxes blocked",
    "start": "1619450",
    "end": "1625210"
  },
  {
    "text": "access to the environment variable so when we try to enumerate them we've got an empty list but nevertheless we were",
    "start": "1625210",
    "end": "1632440"
  },
  {
    "text": "able to actually trade data from those send boxes some have non-standard software and environment variables and we'll give an",
    "start": "1632440",
    "end": "1640690"
  },
  {
    "text": "example in in a moment in general cloud cloud antivirus and",
    "start": "1640690",
    "end": "1646690"
  },
  {
    "text": "boxes are easily detectable that's a bit surprising they don't really try to hide themselves",
    "start": "1646690",
    "end": "1652150"
  },
  {
    "text": "- well I think in probably all of them",
    "start": "1652150",
    "end": "1657910"
  },
  {
    "text": "one at least one of the following properties was were static computer name",
    "start": "1657910",
    "end": "1664720"
  },
  {
    "text": "disk volume serial number the MAC address in which case I'm not sure about how static it was but it was easily",
    "start": "1664720",
    "end": "1672390"
  },
  {
    "text": "detectable as virtualization makkad was like MAC address for me VMware and the",
    "start": "1672390",
    "end": "1680350"
  },
  {
    "text": "performance counter frequency again something that can indicate virtualization and some sandbox",
    "start": "1680350",
    "end": "1689920"
  },
  {
    "text": "infrastructure is shared among several bundle we see this we see when we try the technique on",
    "start": "1689920",
    "end": "1698380"
  },
  {
    "text": "various windows we get the same sandbox talking to us lead time varies from a",
    "start": "1698380",
    "end": "1705940"
  },
  {
    "text": "few seconds to few hours in some cases multiple execution so it would submit a",
    "start": "1705940",
    "end": "1712240"
  },
  {
    "text": "sample or the antivirus agent submits a sample once and you'd expect that sample to run once and then we get several",
    "start": "1712240",
    "end": "1719340"
  },
  {
    "text": "executions of the same of that same sample cheese it's unexpected and then",
    "start": "1719340",
    "end": "1726910"
  },
  {
    "text": "one of the funniest phenomenon that we bumped into is some antivirus agents",
    "start": "1726910",
    "end": "1736929"
  },
  {
    "text": "would extract the satellite the vanilla satellite from the image of the of the",
    "start": "1736929",
    "end": "1745929"
  },
  {
    "text": "rocket math main malware because they did inspect it as well and submit that",
    "start": "1745929",
    "end": "1752410"
  },
  {
    "text": "sample to the internet before the rocket actually embedded the collected data",
    "start": "1752410",
    "end": "1758020"
  },
  {
    "text": "into the into the satellite and so it get an execute an unexpected execution",
    "start": "1758020",
    "end": "1763540"
  },
  {
    "text": "of the satellite vanilla version or at the cloud sandbox that's because we were",
    "start": "1763540",
    "end": "1773080"
  },
  {
    "text": "lazy enough not to encrypt or compress the image of the vanilla satellite",
    "start": "1773080",
    "end": "1779230"
  },
  {
    "text": "inside the main rocket we we detected or",
    "start": "1779230",
    "end": "1787570"
  },
  {
    "text": "we collected names 37 names of Cloud Antivirus send boxes and you can see",
    "start": "1787570",
    "end": "1793900"
  },
  {
    "text": "them here interestingly enough in 2015",
    "start": "1793900",
    "end": "1799540"
  },
  {
    "text": "hexa corn which which we mentioned in one of the earlier slides compiled the",
    "start": "1799540",
    "end": "1807250"
  },
  {
    "text": "list of over 800 sandbox names of which only seven out of our 37",
    "start": "1807250",
    "end": "1815650"
  },
  {
    "text": "where in which only seven of 2037 names were found in the hexa corn long list of",
    "start": "1815650",
    "end": "1824460"
  },
  {
    "text": "2015 so there is some changes in the sandbox environment but on the other",
    "start": "1824460",
    "end": "1835510"
  },
  {
    "text": "hand it's still a bit surprising that two years after we still find seven names that are unchanged and obviously",
    "start": "1835510",
    "end": "1843400"
  },
  {
    "text": "all the world and this kid sister know that they are anti virus n boxes and",
    "start": "1843400",
    "end": "1850500"
  },
  {
    "text": "this is just an example of I don't expect you to read that it's just an",
    "start": "1850500",
    "end": "1856330"
  },
  {
    "text": "example of the environment variables that we extracted from one sandbox as it",
    "start": "1856330",
    "end": "1864130"
  },
  {
    "text": "as it happens one using used by Comodo and the interesting part is this machine",
    "start": "1864130",
    "end": "1874179"
  },
  {
    "text": "did not even attempt to hide its MAC address or disk volume number or domain they remain static throughout our",
    "start": "1874179",
    "end": "1880690"
  },
  {
    "text": "testing but even if they did mask or",
    "start": "1880690",
    "end": "1886500"
  },
  {
    "text": "randomize their MAC address disk volume and domain they still they had some",
    "start": "1886500",
    "end": "1892380"
  },
  {
    "text": "non-standard environment variables that would that can give away that particular",
    "start": "1892380",
    "end": "1899530"
  },
  {
    "text": "box there are four sets of tempo often",
    "start": "1899530",
    "end": "1905260"
  },
  {
    "text": "of environment variables as you can see at the bottom of this slide and they all",
    "start": "1905260",
    "end": "1912510"
  },
  {
    "text": "they are all related to each other so in the left-hand side in the top left hand",
    "start": "1912510",
    "end": "1920320"
  },
  {
    "text": "side you can see a representation of the current time in the way that we are in a",
    "start": "1920320",
    "end": "1927220"
  },
  {
    "text": "human readable fashion hours minutes and seconds at the bottom left hand at the",
    "start": "1927220",
    "end": "1935440"
  },
  {
    "text": "bottom left side you can see that same representation but now in seconds since made",
    "start": "1935440",
    "end": "1940690"
  },
  {
    "text": "night and then in the upper right side you can see a representation of the of",
    "start": "1940690",
    "end": "1947380"
  },
  {
    "text": "the current time plus 202 seconds not sure what this magic number what's the",
    "start": "1947380",
    "end": "1953500"
  },
  {
    "text": "meaning of this magic number and again at the lower right side you can see that",
    "start": "1953500",
    "end": "1961360"
  },
  {
    "text": "representation that that time represented as a second since midnight",
    "start": "1961360",
    "end": "1966490"
  },
  {
    "text": "and obviously all those a numbers and in environment variables are interrelated",
    "start": "1966490",
    "end": "1972820"
  },
  {
    "text": "and can be used to detect this exact box even if the MAC address disk volume",
    "start": "1972820",
    "end": "1979360"
  },
  {
    "text": "number and domain are randomized we kept",
    "start": "1979360",
    "end": "1985420"
  },
  {
    "text": "describing the situation where the antivirus sandbox resides in the cloud",
    "start": "1985420",
    "end": "1991870"
  },
  {
    "text": "but there's also a variant of this attack that that is applicable to",
    "start": "1991870",
    "end": "1997180"
  },
  {
    "text": "on-premise antivirus inboxes again it is touted as a more secure alternative to",
    "start": "1997180",
    "end": "2002910"
  },
  {
    "text": "cloud antivirus sandbox because the processing takes place on premise but",
    "start": "2002910",
    "end": "2010410"
  },
  {
    "text": "the same attack technique can be can be applied assuming that the sandbox",
    "start": "2010410",
    "end": "2015870"
  },
  {
    "text": "allowed the certain set of protocols and ports and the organization file allows",
    "start": "2015870",
    "end": "2025200"
  },
  {
    "text": "at least some of those protocols and ports to access the Internet and then of",
    "start": "2025200",
    "end": "2032130"
  },
  {
    "text": "course in this in this intersection the satellite can use can use one of those",
    "start": "2032130",
    "end": "2037800"
  },
  {
    "text": "ports or protocols to actually to actually exfiltrate the data we did not test this we did not have an environment",
    "start": "2037800",
    "end": "2044940"
  },
  {
    "text": "or system containing on-premise antivirus and boxes but we do suspect that there are",
    "start": "2044940",
    "end": "2051570"
  },
  {
    "text": "some may be a lot of such systems in the world to generalize the technique and",
    "start": "2051570",
    "end": "2063419"
  },
  {
    "text": "what we found so far it what we can",
    "start": "2063419",
    "end": "2068610"
  },
  {
    "text": "deduce from from that from the research that we did is that any sample sharing",
    "start": "2068610",
    "end": "2074760"
  },
  {
    "text": "that takes a sample out of the enterprise on in some cases like on-premise cloud antivirus sandbox even",
    "start": "2074760",
    "end": "2082919"
  },
  {
    "text": "inside an enterprise can facilitate X filtration so particularly the scenario",
    "start": "2082919",
    "end": "2088679"
  },
  {
    "text": "of say sharing a sample with security mailing lists or putting it on some file",
    "start": "2088679",
    "end": "2094530"
  },
  {
    "text": "or sample repositories or or providing the sample to expert analysis services",
    "start": "2094530",
    "end": "2100500"
  },
  {
    "text": "can facilitate exfiltration and particularly if we're looking at online",
    "start": "2100500",
    "end": "2108210"
  },
  {
    "text": "cloud and sandbox scanning services like virustotal and friends they can they can",
    "start": "2108210",
    "end": "2115740"
  },
  {
    "text": "definitely be used for forex filtration either when used as a back-end for",
    "start": "2115740",
    "end": "2122270"
  },
  {
    "text": "detection capability detection capabilities oh and use manually by just",
    "start": "2122270",
    "end": "2128390"
  },
  {
    "text": "Incident Response Team uploading a suspicious or malicious sample from an",
    "start": "2128390",
    "end": "2134340"
  },
  {
    "text": "enterprise endpoint and indeed we were able to demonstrate such a exfiltration",
    "start": "2134340",
    "end": "2140550"
  },
  {
    "text": "with Google virustotal and Joe's security Joe sandbox cloud and payload",
    "start": "2140550",
    "end": "2146370"
  },
  {
    "text": "security hybrid analysis and I should stress though that this is not a vulnerability in those services those",
    "start": "2146370",
    "end": "2153090"
  },
  {
    "text": "services never promised any anything in terms of preventing exfiltration from",
    "start": "2153090",
    "end": "2159240"
  },
  {
    "text": "end point they just analyzed the sample that we submit to them and now it's time",
    "start": "2159240",
    "end": "2167010"
  },
  {
    "text": "for a demo and I hand it over to Itzik thank you very much for me Allah switch into my computer feed okay",
    "start": "2167010",
    "end": "2180090"
  },
  {
    "text": "excellent so before we dive in into the actual technique let's a little bit understand",
    "start": "2180090",
    "end": "2185910"
  },
  {
    "text": "the environment which the tool works as a meteors we'll go back to my presentation we're going to release a",
    "start": "2185910",
    "end": "2191700"
  },
  {
    "text": "tool and a white paper that explains exactly how we did these testing so",
    "start": "2191700",
    "end": "2197040"
  },
  {
    "text": "first and foremost we got our server server in the cloud and basically we have registered a domain attached to it",
    "start": "2197040",
    "end": "2204180"
  },
  {
    "text": "and this server is actually acting as the official iterative name server so I'll just quickly tail here to see what",
    "start": "2204180",
    "end": "2212100"
  },
  {
    "text": "kind of requests and just quickly do a test to see that we're indeed receiving",
    "start": "2212100",
    "end": "2219660"
  },
  {
    "text": "heat on our on our DMS again we will use this later on as we do a local",
    "start": "2219660",
    "end": "2225300"
  },
  {
    "text": "simulation of the tool on my computer so you actually see how the information is being leaked out of the sandbox so we",
    "start": "2225300",
    "end": "2233970"
  },
  {
    "text": "have a again a server and in the server we're gonna run multiple different services as a mention it's good to have",
    "start": "2233970",
    "end": "2240840"
  },
  {
    "text": "multiple avenues to try to have the information coming back to us from the sandbox we have used HTTP but ever since",
    "start": "2240840",
    "end": "2248250"
  },
  {
    "text": "then we have developed the the tool to conclude other ports and other ideas again all for the purpose of seeing what",
    "start": "2248250",
    "end": "2254790"
  },
  {
    "text": "kind of information can go out of that sandbox so let's quick let's go to jump into fun",
    "start": "2254790",
    "end": "2262859"
  },
  {
    "text": "let's quickly jump into one of those tests we're going to run and these guys",
    "start": "2262859",
    "end": "2268680"
  },
  {
    "text": "are going to take place on my computer so here we have",
    "start": "2268680",
    "end": "2274100"
  },
  {
    "text": "we have a Windows machine in this machine we have the the rocket toolkit",
    "start": "2277720",
    "end": "2283910"
  },
  {
    "text": "included in it and basically I'm going to run this go that batch file and what",
    "start": "2283910",
    "end": "2289160"
  },
  {
    "text": "it will end up creating is a text sorry it's a multiple executables one will be",
    "start": "2289160",
    "end": "2295309"
  },
  {
    "text": "the racket and of course we didn't activate the racket to spawn the satellite I want on my computer so we",
    "start": "2295309",
    "end": "2301910"
  },
  {
    "text": "can see the information coming out using the DNS so obviously we have included",
    "start": "2301910",
    "end": "2315470"
  },
  {
    "text": "the option to define different types of strings for the testing purposes it's a great way to differentiate between",
    "start": "2315470",
    "end": "2320930"
  },
  {
    "text": "different tests if an iteration help you differentiate the ones the sample has been distributed so what's",
    "start": "2320930",
    "end": "2328730"
  },
  {
    "text": "happening right now is that we're using a Python script to generate a C file in that C file we embed new parameters such",
    "start": "2328730",
    "end": "2335450"
  },
  {
    "text": "as the data and in the plea what we have created is a rocket and that rocket is",
    "start": "2335450",
    "end": "2341420"
  },
  {
    "text": "now contains the satellite that were generated and the string that we actually put in it is that very spring",
    "start": "2341420",
    "end": "2348650"
  },
  {
    "text": "that are I've specified here so as you can see we are reading fourteen bytes they're packed now within this satellite",
    "start": "2348650",
    "end": "2356089"
  },
  {
    "text": "so what I'm going to do is I'm going to run that again on my computer locally",
    "start": "2356089",
    "end": "2361849"
  },
  {
    "text": "and the idea is that I will receive the information from the other side",
    "start": "2361849",
    "end": "2368319"
  },
  {
    "text": "so as you can see it will now try different types of communication as we",
    "start": "2372610",
    "end": "2377660"
  },
  {
    "text": "said we're exploring different types revenues just one of one of them is just the DMS as you can three the string is",
    "start": "2377660",
    "end": "2384290"
  },
  {
    "text": "came back it's encoded in base64 so let's quickly try to decode it and we",
    "start": "2384290",
    "end": "2395600"
  },
  {
    "text": "need to do a padding here and as you can see we've received the string back from",
    "start": "2395600",
    "end": "2403130"
  },
  {
    "text": "the actual satellite again that was a local simulation on my computer so there",
    "start": "2403130",
    "end": "2408800"
  },
  {
    "text": "is not actually a sandbox involved now for the demo we have recorded a demo and",
    "start": "2408800",
    "end": "2413900"
  },
  {
    "text": "as a meet mention we have tested a number of vendors we're going to show a demo that actually is using virustotal",
    "start": "2413900",
    "end": "2420200"
  },
  {
    "text": "to accomplish this so before running the",
    "start": "2420200",
    "end": "2425390"
  },
  {
    "text": "demo let's can I do a little bit of orientation about what we're seeing so there is three types of screens here on",
    "start": "2425390",
    "end": "2431780"
  },
  {
    "text": "the left upper corner as you can see that the same server that I've used in",
    "start": "2431780",
    "end": "2437000"
  },
  {
    "text": "the past and now you can see that I'm opening these multiple different ports to see what kind of information can flow",
    "start": "2437000",
    "end": "2442100"
  },
  {
    "text": "from the sandbox hopefully to these ports which will be white listed on the",
    "start": "2442100",
    "end": "2447770"
  },
  {
    "text": "left down corner as you can see I'm again tailing out the information coming from a DNS server that would be my",
    "start": "2447770",
    "end": "2454700"
  },
  {
    "text": "Avenue to see if the fare box will allow communication over DNS and now as you",
    "start": "2454700",
    "end": "2461030"
  },
  {
    "text": "can see here i am again generating using the same tool key that we're going to release a rocket and a set light and the",
    "start": "2461030",
    "end": "2467330"
  },
  {
    "text": "strings that unisys contains it's a low black eight 2017 again running it compiling it generating the files we end",
    "start": "2467330",
    "end": "2474980"
  },
  {
    "text": "up with an executable what I'm doing next here is a basically a mixing virustotal the same web that you guys",
    "start": "2474980",
    "end": "2481130"
  },
  {
    "text": "are seeing there's nothing here nothing different I don't have anything that I usually analyse that goes to this",
    "start": "2481130",
    "end": "2486980"
  },
  {
    "text": "website doesn't have [Music]",
    "start": "2486980",
    "end": "2493920"
  },
  {
    "text": "and again mimicking the flow of having in this sample file which is identify as a malicious I'd like to further examine",
    "start": "2493920",
    "end": "2500229"
  },
  {
    "text": "it I'm going to submit it to virustotal as we said we have found this abuse both in the cloud directly cloud services",
    "start": "2500229",
    "end": "2507190"
  },
  {
    "text": "such as virustotal but also indicates for the meet client is presented before for Kaspersky either on Komodo this will",
    "start": "2507190",
    "end": "2514660"
  },
  {
    "text": "happen automatically so here obviously I'm submitting the sample to get the effect however on",
    "start": "2514660",
    "end": "2519789"
  },
  {
    "text": "these endpoint solutions this would happen automatically of course with their their sandbox back in and not",
    "start": "2519789",
    "end": "2526869"
  },
  {
    "text": "differently virustotal again uploading the file as you can see it will go into",
    "start": "2526869",
    "end": "2532420"
  },
  {
    "text": "assessing it the very same action that we're seeing when we're actually running",
    "start": "2532420",
    "end": "2537940"
  },
  {
    "text": "it in real time now what you want to watch out for is as the screens on the left side are going to",
    "start": "2537940",
    "end": "2543579"
  },
  {
    "text": "start filling up with the information that would be the indication that we managed to break out of the sandbox it",
    "start": "2543579",
    "end": "2550869"
  },
  {
    "text": "will take it like a like a couple of seconds to load up to that part again this was a recorded demo that I did with",
    "start": "2550869",
    "end": "2557319"
  },
  {
    "text": "the real side being as you is you can try and reproduce it with the toolkit",
    "start": "2557319",
    "end": "2564989"
  },
  {
    "text": "and as you can see and again the order of which virustotal sends to the different vendors in the time' to",
    "start": "2591180",
    "end": "2597240"
  },
  {
    "text": "technical processes obviously varies we cannot control this attribution however as you can see what the results are",
    "start": "2597240",
    "end": "2603690"
  },
  {
    "text": "being propagated on the left side that string the very same string that we try to exit rate it comes back to these open",
    "start": "2603690",
    "end": "2610589"
  },
  {
    "text": "circuits so we have successfully expert rated who wrote in 16 UDP sockets on",
    "start": "2610589",
    "end": "2615930"
  },
  {
    "text": "these particular ports the very same string if you look out on the on the",
    "start": "2615930",
    "end": "2621240"
  },
  {
    "text": "lower left side that's the DNS part we also have received a hit the string is came back and coded to us as you can see",
    "start": "2621240",
    "end": "2628349"
  },
  {
    "text": "right now in the demo I'm going to proceed into taking the very encoded string and what basically decoded as I",
    "start": "2628349",
    "end": "2635400"
  },
  {
    "text": "didn't on my local simulation before",
    "start": "2635400",
    "end": "2639650"
  },
  {
    "text": "and you have it as you can see we have demonstrated over raw sockets both TCP",
    "start": "2653869",
    "end": "2659210"
  },
  {
    "text": "and UDP on a variety of different ports and again using DNS regular DNF communication however encoded we have",
    "start": "2659210",
    "end": "2666589"
  },
  {
    "text": "able to successfully exotic information from a binary pack with the information that has been sending to virustotal I",
    "start": "2666589",
    "end": "2673779"
  },
  {
    "text": "mean like to you thank you it's sick",
    "start": "2673779",
    "end": "2678219"
  },
  {
    "text": "so we've notified the vendors of course",
    "start": "2679599",
    "end": "2685269"
  },
  {
    "text": "Avira is certain comodo fix the issues with their send boxes they simply",
    "start": "2685269",
    "end": "2691880"
  },
  {
    "text": "blocked access from the sandbox to the Internet in fact Avira did an extremely quick job at it less",
    "start": "2691880",
    "end": "2700069"
  },
  {
    "text": "than half a day Kaspersky decided not to fix does the vendor statement says that",
    "start": "2700069",
    "end": "2709039"
  },
  {
    "text": "there are some alternatives for their corporate customers but event but",
    "start": "2709039",
    "end": "2715269"
  },
  {
    "text": "essentially they said that not to fix the core issue and we also got a nice",
    "start": "2715269",
    "end": "2721400"
  },
  {
    "text": "letter from is set at the right hand side acknowledging and thanking us for our finding with the cloud sandboxes as",
    "start": "2721400",
    "end": "2731690"
  },
  {
    "text": "I'm as I said it's not really a vulnerability on their side however in",
    "start": "2731690",
    "end": "2736789"
  },
  {
    "text": "virustotal specifically said that executing the executing samples within internet",
    "start": "2736789",
    "end": "2743900"
  },
  {
    "text": "connection enabled is part of their service job security decided to block",
    "start": "2743900",
    "end": "2749420"
  },
  {
    "text": "access to the to the internet for the samples that there are sandboxing and",
    "start": "2749420",
    "end": "2756229"
  },
  {
    "text": "payload security decided not to comment as I said one way of handling this",
    "start": "2756229",
    "end": "2765440"
  },
  {
    "text": "situation from the cloud antivirus sandboxes is to block all traffic to the",
    "start": "2765440",
    "end": "2772190"
  },
  {
    "text": "internet from the sandbox a more delicate approach is to only allow a",
    "start": "2772190",
    "end": "2779930"
  },
  {
    "text": "sample to interact with the Internet if we are sure that the sample itself arrived from the internet and was not",
    "start": "2779930",
    "end": "2785930"
  },
  {
    "text": "modified on the endpoint itself so for example if we just download an",
    "start": "2785930",
    "end": "2790940"
  },
  {
    "text": "executable from the internet and it's the same executable by twice that is",
    "start": "2790940",
    "end": "2797410"
  },
  {
    "text": "that is causing the that triggers the antivirus then the antivirus can",
    "start": "2797410",
    "end": "2803150"
  },
  {
    "text": "instruct the sandbox to execute it with full internet accessibility",
    "start": "2803150",
    "end": "2808270"
  },
  {
    "text": "however we should be careful about where this executable arrives from it's not",
    "start": "2808270",
    "end": "2816710"
  },
  {
    "text": "enough for the executable to arrive from outside the endpoint itself if if for",
    "start": "2816710",
    "end": "2822290"
  },
  {
    "text": "example are talking about an enterprise and I were in two machines are a and two",
    "start": "2822290",
    "end": "2828170"
  },
  {
    "text": "endpoints are infected and one endpoint generates a satellite and then sends it",
    "start": "2828170",
    "end": "2834680"
  },
  {
    "text": "to the second to the second endpoint",
    "start": "2834680",
    "end": "2840109"
  },
  {
    "text": "where were they the second rocket executes this this satellite and",
    "start": "2840109",
    "end": "2846970"
  },
  {
    "text": "antivirus can track the satellite and and determine that since the satellite",
    "start": "2846970",
    "end": "2852020"
  },
  {
    "text": "arrived from outside the endpoint it's okay to allow it to access the Internet",
    "start": "2852020",
    "end": "2857300"
  },
  {
    "text": "in the sandbox which is which would result in successful exfiltration so we",
    "start": "2857300",
    "end": "2864619"
  },
  {
    "text": "will learn from this example that the satellite also is that the that only",
    "start": "2864619",
    "end": "2869740"
  },
  {
    "text": "executables that really arrived from outside the enterprise should be allowed",
    "start": "2869740",
    "end": "2874820"
  },
  {
    "text": "full internet access on the sandbox and of course this kind of solution does not",
    "start": "2874820",
    "end": "2880160"
  },
  {
    "text": "apply to cloud scan as an analyzer like virustotal that are clueless about the origin of",
    "start": "2880160",
    "end": "2885890"
  },
  {
    "text": "the file from the offensive perspective there are some future research",
    "start": "2885890",
    "end": "2892550"
  },
  {
    "text": "directions that we waste here one is of",
    "start": "2892550",
    "end": "2898040"
  },
  {
    "text": "course to extend the trigger list that is used by the satellite to extend the",
    "start": "2898040",
    "end": "2904089"
  },
  {
    "text": "exfiltration methods for example using SMTP IRC ICMP we just",
    "start": "2904089",
    "end": "2909559"
  },
  {
    "text": "tried two very popular protocols but this by no means is is an exhaustive",
    "start": "2909559",
    "end": "2919869"
  },
  {
    "text": "attempt at exfiltration as I mentioned it would be a good idea to encrypt or to",
    "start": "2920440",
    "end": "2926900"
  },
  {
    "text": "compress the satellite template inside the rocket and also to encrypt or compress the data collected and embedded",
    "start": "2926900",
    "end": "2933950"
  },
  {
    "text": "inside this rocket to further reduce the likelihood of the detection by or",
    "start": "2933950",
    "end": "2941950"
  },
  {
    "text": "detection detecting a VD tection that something fishy is going on and one",
    "start": "2941950",
    "end": "2948829"
  },
  {
    "text": "interesting direction that we suggest is for the rocket to simulate the antivirus",
    "start": "2948829",
    "end": "2957019"
  },
  {
    "text": "agent to cloud protocol so that instead of triggering the antivirus agent we",
    "start": "2957019",
    "end": "2963260"
  },
  {
    "text": "simulate its submission to the cloud so that we don't need now to trigger the",
    "start": "2963260",
    "end": "2969230"
  },
  {
    "text": "antivirus agent as well as we do not need as well as there will be no visual",
    "start": "2969230",
    "end": "2977269"
  },
  {
    "text": "cues on the endpoint itself and maybe we can also avoid detection by the",
    "start": "2977269",
    "end": "2982400"
  },
  {
    "text": "antivirus system at large so to conclude",
    "start": "2982400",
    "end": "2987920"
  },
  {
    "text": "our research here are the takeaway points anti viruses using",
    "start": "2987920",
    "end": "2994609"
  },
  {
    "text": "internet-connected sandboxes can facilitate exfiltration even from a high security enterprises and this can happen",
    "start": "2994609",
    "end": "3001630"
  },
  {
    "text": "when the sandbox is in the cloud and this can also happen when the sandbox is on-premise in general sharing suspicious",
    "start": "3001630",
    "end": "3009819"
  },
  {
    "text": "or malicious files can facilitate exfiltration unless the file is determined to have arrived from outside",
    "start": "3009819",
    "end": "3016599"
  },
  {
    "text": "the enterprise and is by twice identical to the copy that resides outside the enterprise and this specifically applies",
    "start": "3016599",
    "end": "3025089"
  },
  {
    "text": "to online and cloud scanning and analysis services like virustotal and friends",
    "start": "3025089",
    "end": "3030870"
  },
  {
    "text": "but also to any sample sharing at large and finally Avira is certain comodo fix",
    "start": "3030870",
    "end": "3036780"
  },
  {
    "text": "their sandboxes so they're probably safe with Kaspersky we positively know that",
    "start": "3036780",
    "end": "3041820"
  },
  {
    "text": "they are vulnerable unless of course there is a switch of the cloud sample submission feature and with other",
    "start": "3041820",
    "end": "3047970"
  },
  {
    "text": "windows it's a bit hazy because we could not demonstrate positively that they are",
    "start": "3047970",
    "end": "3054600"
  },
  {
    "text": "vulnerable but then again we only try the small fraction of the exfiltration techniques and the triggering techniques",
    "start": "3054600",
    "end": "3060960"
  },
  {
    "text": "so we might easily have missed a vendor",
    "start": "3060960",
    "end": "3067020"
  },
  {
    "text": "or two or maybe more that are vulnerable but we just didn't use the right triggers or the right exfiltration",
    "start": "3067020",
    "end": "3073230"
  },
  {
    "text": "techniques we'd like to thank yawning free book wherever is nowadays for his help in",
    "start": "3073230",
    "end": "3080610"
  },
  {
    "text": "setting up the antivirus search lab and with that I open it to question answers",
    "start": "3080610",
    "end": "3088800"
  },
  {
    "text": "thank you very much thank you",
    "start": "3088800",
    "end": "3092540"
  },
  {
    "text": "[Applause]",
    "start": "3094730",
    "end": "3098269"
  }
]