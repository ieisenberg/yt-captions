[
  {
    "text": "and welcome to detecting credential",
    "start": "60",
    "end": "2220"
  },
  {
    "text": "compromising AWS just a quick show of",
    "start": "2220",
    "end": "4830"
  },
  {
    "text": "hands I assume that most people in the",
    "start": "4830",
    "end": "6720"
  },
  {
    "text": "room are familiar they W us but does",
    "start": "6720",
    "end": "8069"
  },
  {
    "text": "anyone a practitioner he'd raise your",
    "start": "8069",
    "end": "10380"
  },
  {
    "text": "hands I think I could see people out",
    "start": "10380",
    "end": "11550"
  },
  {
    "text": "there so yeah quite a few it's great to",
    "start": "11550",
    "end": "14070"
  },
  {
    "text": "have a crowd here this morning",
    "start": "14070",
    "end": "15960"
  },
  {
    "text": "but first Who am I why am I here to",
    "start": "15960",
    "end": "17760"
  },
  {
    "text": "speak with you today",
    "start": "17760",
    "end": "19199"
  },
  {
    "text": "my name is Wil Benson I am a senior",
    "start": "19199",
    "end": "21029"
  },
  {
    "text": "security engineer at Netflix for those",
    "start": "21029",
    "end": "23730"
  },
  {
    "text": "of you are familiar with Netflix we are",
    "start": "23730",
    "end": "25920"
  },
  {
    "text": "a micro service ecosystem that streams a",
    "start": "25920",
    "end": "28500"
  },
  {
    "text": "video and we're running a hundred",
    "start": "28500",
    "end": "30750"
  },
  {
    "text": "percent in AWS so up until that point",
    "start": "30750",
    "end": "33149"
  },
  {
    "text": "with when you actually press play all",
    "start": "33149",
    "end": "35070"
  },
  {
    "text": "interactions happen within a RADS",
    "start": "35070",
    "end": "38579"
  },
  {
    "text": "infrastructure the team I'm on is the",
    "start": "38579",
    "end": "40980"
  },
  {
    "text": "security tools and operations team we're",
    "start": "40980",
    "end": "43200"
  },
  {
    "text": "not like your traditional ASEC ops team",
    "start": "43200",
    "end": "44850"
  },
  {
    "text": "where we're not the sock or not the",
    "start": "44850",
    "end": "47100"
  },
  {
    "text": "Incident Response Team but we actually",
    "start": "47100",
    "end": "48870"
  },
  {
    "text": "own our AWS infrastructure and the",
    "start": "48870",
    "end": "51210"
  },
  {
    "text": "security and accounts therein so we",
    "start": "51210",
    "end": "53219"
  },
  {
    "text": "control permissioning and most",
    "start": "53219",
    "end": "54840"
  },
  {
    "text": "importantly monitoring of those accounts",
    "start": "54840",
    "end": "56719"
  },
  {
    "text": "if you're interested the slides will be",
    "start": "56719",
    "end": "58770"
  },
  {
    "text": "posted later today",
    "start": "58770",
    "end": "59750"
  },
  {
    "text": "some cool presentations that folks from",
    "start": "59750",
    "end": "62460"
  },
  {
    "text": "the team have done if you want to follow",
    "start": "62460",
    "end": "64500"
  },
  {
    "text": "me on Twitter to continue the",
    "start": "64500",
    "end": "66119"
  },
  {
    "text": "conversation afterwards I'm at",
    "start": "66119",
    "end": "67590"
  },
  {
    "text": "underscore underscore muscles and that's",
    "start": "67590",
    "end": "70200"
  },
  {
    "text": "my github where I'll be open sourcing",
    "start": "70200",
    "end": "71729"
  },
  {
    "text": "something later today but first I just",
    "start": "71729",
    "end": "75180"
  },
  {
    "text": "want to start saying this is not a",
    "start": "75180",
    "end": "76710"
  },
  {
    "text": "machine learning talk I wish I could say",
    "start": "76710",
    "end": "78810"
  },
  {
    "text": "that I created this really awesome model",
    "start": "78810",
    "end": "81030"
  },
  {
    "text": "and put in all these different data",
    "start": "81030",
    "end": "83310"
  },
  {
    "text": "sources and learned and was able to come",
    "start": "83310",
    "end": "86189"
  },
  {
    "text": "up with something really awesome I think",
    "start": "86189",
    "end": "89159"
  },
  {
    "text": "I did come up with something awesome but",
    "start": "89159",
    "end": "90509"
  },
  {
    "text": "it was very simple and so I always say",
    "start": "90509",
    "end": "92640"
  },
  {
    "text": "well I do something complex when it can",
    "start": "92640",
    "end": "94470"
  },
  {
    "text": "be pretty straightforward and I think",
    "start": "94470",
    "end": "96420"
  },
  {
    "text": "I'll show that in an architecture",
    "start": "96420",
    "end": "97560"
  },
  {
    "text": "diagram later of how simple this",
    "start": "97560",
    "end": "99329"
  },
  {
    "text": "actually is the scope of the talk today",
    "start": "99329",
    "end": "102390"
  },
  {
    "text": "is detecting compromised instance",
    "start": "102390",
    "end": "104970"
  },
  {
    "text": "credentials outside of your environment",
    "start": "104970",
    "end": "107579"
  },
  {
    "text": "and you it's very important here because",
    "start": "107579",
    "end": "110009"
  },
  {
    "text": "when I say your or my",
    "start": "110009",
    "end": "112290"
  },
  {
    "text": "that means Netflix's environment your",
    "start": "112290",
    "end": "115110"
  },
  {
    "text": "own AWS infrastructure not just a DBS in",
    "start": "115110",
    "end": "117510"
  },
  {
    "text": "general for those that aren't familiar",
    "start": "117510",
    "end": "119460"
  },
  {
    "text": "when you've watched a service in AWS you",
    "start": "119460",
    "end": "122070"
  },
  {
    "text": "get session credentials that are",
    "start": "122070",
    "end": "124020"
  },
  {
    "text": "automatically refresh this is from the",
    "start": "124020",
    "end": "126060"
  },
  {
    "text": "security token service that AWS provides",
    "start": "126060",
    "end": "129110"
  },
  {
    "text": "they will manage rotating credentials on",
    "start": "129110",
    "end": "132030"
  },
  {
    "text": "your instance for you and you can also",
    "start": "132030",
    "end": "133740"
  },
  {
    "text": "use a service for distributing keys",
    "start": "133740",
    "end": "136080"
  },
  {
    "text": "within your individual employees",
    "start": "136080",
    "end": "137760"
  },
  {
    "text": "yourself the STS tokens aren't the only",
    "start": "137760",
    "end": "141030"
  },
  {
    "text": "type of key in AWS you have your root",
    "start": "141030",
    "end": "143370"
  },
  {
    "text": "keys which are like your root user and",
    "start": "143370",
    "end": "145470"
  },
  {
    "text": "Linux hide those you'll never need to",
    "start": "145470",
    "end": "147870"
  },
  {
    "text": "use them unless you lock yourself out of",
    "start": "147870",
    "end": "149459"
  },
  {
    "text": "an s3 bucket or need a change of the",
    "start": "149459",
    "end": "151800"
  },
  {
    "text": "account billing information that is",
    "start": "151800",
    "end": "154050"
  },
  {
    "text": "restricted to root but mostly you'll be",
    "start": "154050",
    "end": "157680"
  },
  {
    "text": "interacting with these session tokens",
    "start": "157680",
    "end": "159390"
  },
  {
    "text": "and that's really what I'm focusing on",
    "start": "159390",
    "end": "161190"
  },
  {
    "text": "here today it's can be applied through",
    "start": "161190",
    "end": "163950"
  },
  {
    "text": "any type of temporary credential and AWS",
    "start": "163950",
    "end": "167010"
  },
  {
    "text": "as long as you understand how those are",
    "start": "167010",
    "end": "168810"
  },
  {
    "text": "created but and you could potentially",
    "start": "168810",
    "end": "170730"
  },
  {
    "text": "even apply to the I am user static keys",
    "start": "170730",
    "end": "172890"
  },
  {
    "text": "as well but so that's a problem I really",
    "start": "172890",
    "end": "177030"
  },
  {
    "text": "was attempting to solve detecting",
    "start": "177030",
    "end": "179700"
  },
  {
    "text": "compromise or credential misuse really",
    "start": "179700",
    "end": "182090"
  },
  {
    "text": "outside of our environment and so at AWS",
    "start": "182090",
    "end": "186810"
  },
  {
    "text": "or Netflix we have hundreds of thousands",
    "start": "186810",
    "end": "189150"
  },
  {
    "text": "of servers they change constantly 4,000",
    "start": "189150",
    "end": "192810"
  },
  {
    "text": "or so deploys a day I mean we're",
    "start": "192810",
    "end": "194790"
  },
  {
    "text": "continuously deploying and changing our",
    "start": "194790",
    "end": "196230"
  },
  {
    "text": "environment and so I really wanted to",
    "start": "196230",
    "end": "198690"
  },
  {
    "text": "know when was credential being used",
    "start": "198690",
    "end": "201060"
  },
  {
    "text": "outside of Netflix not just AWS so I",
    "start": "201060",
    "end": "204780"
  },
  {
    "text": "started asking who's doing this well and",
    "start": "204780",
    "end": "206970"
  },
  {
    "text": "from what I can gather publicly no one",
    "start": "206970",
    "end": "209340"
  },
  {
    "text": "if you're doing this well please raise",
    "start": "209340",
    "end": "211560"
  },
  {
    "text": "your hand and find me after this talk",
    "start": "211560",
    "end": "213269"
  },
  {
    "text": "I'd love to collaborate their services",
    "start": "213269",
    "end": "215400"
  },
  {
    "text": "provided by AWS such as guard duty that",
    "start": "215400",
    "end": "217920"
  },
  {
    "text": "allow you to detect when a credential is",
    "start": "217920",
    "end": "220080"
  },
  {
    "text": "used outside of AWS but if you think of",
    "start": "220080",
    "end": "222720"
  },
  {
    "text": "the landscape in AWS it's huge it's",
    "start": "222720",
    "end": "225420"
  },
  {
    "text": "Netflix it's slack it's every company",
    "start": "225420",
    "end": "227850"
  },
  {
    "text": "running including the attackers",
    "start": "227850",
    "end": "229650"
  },
  {
    "text": "infrastructure so if I'm a bad guy I'm",
    "start": "229650",
    "end": "231780"
  },
  {
    "text": "gonna take your credential and use it in",
    "start": "231780",
    "end": "233310"
  },
  {
    "text": "my infrastructure and fly under the",
    "start": "233310",
    "end": "234750"
  },
  {
    "text": "radar so we really wanted to detect",
    "start": "234750",
    "end": "237299"
  },
  {
    "text": "outside of your AWS infrastructure so",
    "start": "237299",
    "end": "241620"
  },
  {
    "text": "why is this so hard for us at least it's",
    "start": "241620",
    "end": "244320"
  },
  {
    "text": "a scale problem and I'll get into",
    "start": "244320",
    "end": "246330"
  },
  {
    "text": "it's so hard for us now but many others",
    "start": "246330",
    "end": "249030"
  },
  {
    "text": "might have that problem as well as you",
    "start": "249030",
    "end": "251310"
  },
  {
    "text": "get familiar with working in the cloud",
    "start": "251310",
    "end": "252450"
  },
  {
    "text": "you understand that you have to make API",
    "start": "252450",
    "end": "254970"
  },
  {
    "text": "calls to describe your environment and",
    "start": "254970",
    "end": "256440"
  },
  {
    "text": "there's some limitations that you'll run",
    "start": "256440",
    "end": "258060"
  },
  {
    "text": "into as you scale up so we really wanted",
    "start": "258060",
    "end": "260609"
  },
  {
    "text": "something that worked regardless of what",
    "start": "260610",
    "end": "262770"
  },
  {
    "text": "size you're running in the cloud what",
    "start": "262770",
    "end": "265980"
  },
  {
    "text": "tools are there I'm sure there's a",
    "start": "265980",
    "end": "267540"
  },
  {
    "text": "mixture of tools that you can use but",
    "start": "267540",
    "end": "268950"
  },
  {
    "text": "the main tool we're going to use today",
    "start": "268950",
    "end": "270210"
  },
  {
    "text": "is actually provided by AWS and that's",
    "start": "270210",
    "end": "272850"
  },
  {
    "text": "cloud trail for those that aren't",
    "start": "272850",
    "end": "274680"
  },
  {
    "text": "familiar with cloud trail it's a vent",
    "start": "274680",
    "end": "278010"
  },
  {
    "text": "history of API calls in your environment",
    "start": "278010",
    "end": "280350"
  },
  {
    "text": "so anytime you're in the console using",
    "start": "280350",
    "end": "282840"
  },
  {
    "text": "the SDK as a command line or any other",
    "start": "282840",
    "end": "285120"
  },
  {
    "text": "way that you're calling API functions",
    "start": "285120",
    "end": "288480"
  },
  {
    "text": "you get a log now there are some gaps in",
    "start": "288480",
    "end": "291870"
  },
  {
    "text": "this log which I'll cover later and how",
    "start": "291870",
    "end": "293370"
  },
  {
    "text": "to address those but for the most part",
    "start": "293370",
    "end": "295470"
  },
  {
    "text": "you can understand what calls are being",
    "start": "295470",
    "end": "296940"
  },
  {
    "text": "made in your environment and just",
    "start": "296940",
    "end": "298800"
  },
  {
    "text": "recently Amazon made 90-day event",
    "start": "298800",
    "end": "301020"
  },
  {
    "text": "history free in the console for you to",
    "start": "301020",
    "end": "303810"
  },
  {
    "text": "use so there's really no excuse for you",
    "start": "303810",
    "end": "305370"
  },
  {
    "text": "not to be auditing this data one of the",
    "start": "305370",
    "end": "308250"
  },
  {
    "text": "most common ways of getting the state it",
    "start": "308250",
    "end": "310020"
  },
  {
    "text": "delivered to you is utilizing the s3",
    "start": "310020",
    "end": "312270"
  },
  {
    "text": "delivery function which we use at",
    "start": "312270",
    "end": "314460"
  },
  {
    "text": "Netflix and so if you're interested",
    "start": "314460",
    "end": "315960"
  },
  {
    "text": "that's kind of what the file name looks",
    "start": "315960",
    "end": "317760"
  },
  {
    "text": "like if you're having files delivered",
    "start": "317760",
    "end": "319530"
  },
  {
    "text": "but note the s3 file delivery is up to",
    "start": "319530",
    "end": "323310"
  },
  {
    "text": "15 or 20 minutes delayed depending on",
    "start": "323310",
    "end": "325440"
  },
  {
    "text": "your size and how much data they're",
    "start": "325440",
    "end": "326820"
  },
  {
    "text": "actually trying to write for you so this",
    "start": "326820",
    "end": "328800"
  },
  {
    "text": "method using this stream is going to be",
    "start": "328800",
    "end": "331919"
  },
  {
    "text": "delayed based on the actual time to",
    "start": "331919",
    "end": "334470"
  },
  {
    "text": "detect from the first call from the",
    "start": "334470",
    "end": "336660"
  },
  {
    "text": "attacker if you don't familiar with",
    "start": "336660",
    "end": "339330"
  },
  {
    "text": "cloud trail there's a couple fields that",
    "start": "339330",
    "end": "341310"
  },
  {
    "text": "I want you to pay attention to today you",
    "start": "341310",
    "end": "343710"
  },
  {
    "text": "have the user identity field in our case",
    "start": "343710",
    "end": "347190"
  },
  {
    "text": "we're gonna be focusing on the air in",
    "start": "347190",
    "end": "348830"
  },
  {
    "text": "event source a name or actually the",
    "start": "348830",
    "end": "351360"
  },
  {
    "text": "service and the API call that's being",
    "start": "351360",
    "end": "353520"
  },
  {
    "text": "made but the most important piece for us",
    "start": "353520",
    "end": "356160"
  },
  {
    "text": "today is source IP and that's what we're",
    "start": "356160",
    "end": "359070"
  },
  {
    "text": "actually going to be looking at as we do",
    "start": "359070",
    "end": "360930"
  },
  {
    "text": "this analysis and user agent is also",
    "start": "360930",
    "end": "363360"
  },
  {
    "text": "something that I'll touch a little later",
    "start": "363360",
    "end": "364710"
  },
  {
    "text": "on at Netflix we have many many accounts",
    "start": "364710",
    "end": "368900"
  },
  {
    "text": "this is a common architecture for",
    "start": "368900",
    "end": "371130"
  },
  {
    "text": "delivering cloud trail we have every",
    "start": "371130",
    "end": "373169"
  },
  {
    "text": "account delivered to a single bucket and",
    "start": "373169",
    "end": "374760"
  },
  {
    "text": "from that point forward we can have a",
    "start": "374760",
    "end": "376500"
  },
  {
    "text": "notification topic",
    "start": "376500",
    "end": "378080"
  },
  {
    "text": "off to many many subscribers whoever",
    "start": "378080",
    "end": "379909"
  },
  {
    "text": "needs a process that data so this is I",
    "start": "379909",
    "end": "382340"
  },
  {
    "text": "think one of the best practices from AWS",
    "start": "382340",
    "end": "384379"
  },
  {
    "text": "and something that we recommend if you",
    "start": "384379",
    "end": "386569"
  },
  {
    "text": "want to centralize cloud trail it",
    "start": "386569",
    "end": "388969"
  },
  {
    "text": "doesn't stop you from having cloud trail",
    "start": "388969",
    "end": "390500"
  },
  {
    "text": "in each account and just distributing",
    "start": "390500",
    "end": "392389"
  },
  {
    "text": "your orchestration or your",
    "start": "392389",
    "end": "393439"
  },
  {
    "text": "infrastructure that's monitoring it but",
    "start": "393439",
    "end": "395360"
  },
  {
    "text": "we just choose to do it essentially for",
    "start": "395360",
    "end": "397069"
  },
  {
    "text": "us so we've I first tried to tackle this",
    "start": "397069",
    "end": "400699"
  },
  {
    "text": "problem a while back and I went off to",
    "start": "400699",
    "end": "403159"
  },
  {
    "text": "try to define some requirements and",
    "start": "403159",
    "end": "405110"
  },
  {
    "text": "those requirements were I need to know",
    "start": "405110",
    "end": "408139"
  },
  {
    "text": "all IPS in our environment at all times",
    "start": "408139",
    "end": "410300"
  },
  {
    "text": "for the last hour at least that way when",
    "start": "410300",
    "end": "412940"
  },
  {
    "text": "I actually get the collateral data I can",
    "start": "412940",
    "end": "415159"
  },
  {
    "text": "do this sliding window kind of analysis",
    "start": "415159",
    "end": "419840"
  },
  {
    "text": "and ask the question did we have this IP",
    "start": "419840",
    "end": "422750"
  },
  {
    "text": "for this event in Quattro if we did no",
    "start": "422750",
    "end": "425690"
  },
  {
    "text": "big deal we continued on if we didn't",
    "start": "425690",
    "end": "428539"
  },
  {
    "text": "then it's something we might flag right",
    "start": "428539",
    "end": "432919"
  },
  {
    "text": "it might be a compromise it might just",
    "start": "432919",
    "end": "434360"
  },
  {
    "text": "be a misuse of credential from an",
    "start": "434360",
    "end": "435740"
  },
  {
    "text": "employee but something we should dig in",
    "start": "435740",
    "end": "437539"
  },
  {
    "text": "deeper on but as I mentioned there are",
    "start": "437539",
    "end": "440479"
  },
  {
    "text": "some problems you might run into as you",
    "start": "440479",
    "end": "442009"
  },
  {
    "text": "continue to grow on the cloud and with",
    "start": "442009",
    "end": "444139"
  },
  {
    "text": "AWS and I'm sure that's the same with",
    "start": "444139",
    "end": "446270"
  },
  {
    "text": "GCP and others there's patron ation in",
    "start": "446270",
    "end": "448490"
  },
  {
    "text": "the API calls and then rate limiting",
    "start": "448490",
    "end": "450710"
  },
  {
    "text": "what I mean by patron ation is if you're",
    "start": "450710",
    "end": "453349"
  },
  {
    "text": "just trying to describe your servers in",
    "start": "453349",
    "end": "455150"
  },
  {
    "text": "AWS you'd make a call called describe",
    "start": "455150",
    "end": "457240"
  },
  {
    "text": "instances AWS isn't going to give you",
    "start": "457240",
    "end": "460460"
  },
  {
    "text": "all of your servers back at once they're",
    "start": "460460",
    "end": "462379"
  },
  {
    "text": "going to give you a subset and then",
    "start": "462379",
    "end": "463789"
  },
  {
    "text": "they're gonna give you a page marker and",
    "start": "463789",
    "end": "465469"
  },
  {
    "text": "if you want to continue describing your",
    "start": "465469",
    "end": "467180"
  },
  {
    "text": "environment you can't continue sending",
    "start": "467180",
    "end": "468860"
  },
  {
    "text": "that marker on and the next requests",
    "start": "468860",
    "end": "470719"
  },
  {
    "text": "will give you a new marker and so on so",
    "start": "470719",
    "end": "472190"
  },
  {
    "text": "forth for us it can take up to an hour",
    "start": "472190",
    "end": "475400"
  },
  {
    "text": "to describe a production environment",
    "start": "475400",
    "end": "476750"
  },
  {
    "text": "just due to our size so if you think of",
    "start": "476750",
    "end": "478909"
  },
  {
    "text": "the requirements previous where we were",
    "start": "478909",
    "end": "480860"
  },
  {
    "text": "trying to understand what IPS we had in",
    "start": "480860",
    "end": "482659"
  },
  {
    "text": "our environment for the last hour it's",
    "start": "482659",
    "end": "484849"
  },
  {
    "text": "almost impossible for how many changes",
    "start": "484849",
    "end": "487430"
  },
  {
    "text": "we have in our environment we",
    "start": "487430",
    "end": "489009"
  },
  {
    "text": "potentially miss a lot of infrastructure",
    "start": "489009",
    "end": "491120"
  },
  {
    "text": "that we had for a brief period of time",
    "start": "491120",
    "end": "492560"
  },
  {
    "text": "but was autumn scaled out or chaos TIFF",
    "start": "492560",
    "end": "495050"
  },
  {
    "text": "everyone's familiar with our chaos",
    "start": "495050",
    "end": "496039"
  },
  {
    "text": "engineering practices but as we paginate",
    "start": "496039",
    "end": "498620"
  },
  {
    "text": "through our calls with Amazon we",
    "start": "498620",
    "end": "500690"
  },
  {
    "text": "constantly run into rate-limiting and",
    "start": "500690",
    "end": "502430"
  },
  {
    "text": "this is a protection Amazon puts in",
    "start": "502430",
    "end": "503870"
  },
  {
    "text": "place so that you don't just do a denial",
    "start": "503870",
    "end": "506360"
  },
  {
    "text": "service on their service in point so it",
    "start": "506360",
    "end": "508459"
  },
  {
    "text": "makes sense but we have to",
    "start": "508459",
    "end": "510620"
  },
  {
    "text": "think about these problems when we're",
    "start": "510620",
    "end": "513000"
  },
  {
    "text": "doing things at our scale so I really",
    "start": "513000",
    "end": "515310"
  },
  {
    "text": "wanted to solve it without having to run",
    "start": "515310",
    "end": "518190"
  },
  {
    "text": "into these issues so I came up with a",
    "start": "518190",
    "end": "520919"
  },
  {
    "text": "new approach and it is based on two real",
    "start": "520919",
    "end": "524159"
  },
  {
    "text": "things and that's using an understanding",
    "start": "524159",
    "end": "526620"
  },
  {
    "text": "of AWS and how it works I can't stress",
    "start": "526620",
    "end": "529830"
  },
  {
    "text": "this enough if you understand AWS and",
    "start": "529830",
    "end": "531870"
  },
  {
    "text": "what's logged in how it's logged you're",
    "start": "531870",
    "end": "533820"
  },
  {
    "text": "going you can go a far and a long way",
    "start": "533820",
    "end": "536029"
  },
  {
    "text": "but use AWS how it works to our",
    "start": "536029",
    "end": "538680"
  },
  {
    "text": "advantage and then make a strong but",
    "start": "538680",
    "end": "541410"
  },
  {
    "text": "reasonable assumption and if we can do",
    "start": "541410",
    "end": "543480"
  },
  {
    "text": "those two things and I say that we can",
    "start": "543480",
    "end": "546149"
  },
  {
    "text": "profit and detect critical compromise",
    "start": "546149",
    "end": "549110"
  },
  {
    "text": "and in this approach I mentioned the",
    "start": "549110",
    "end": "552690"
  },
  {
    "text": "temporary credentials at AWS provides on",
    "start": "552690",
    "end": "556230"
  },
  {
    "text": "a server Amazon will create those",
    "start": "556230",
    "end": "559200"
  },
  {
    "text": "credentials that are valid anywhere to",
    "start": "559200",
    "end": "561420"
  },
  {
    "text": "one to six hours and they'll actually",
    "start": "561420",
    "end": "564180"
  },
  {
    "text": "rotate those credentials for you I'll",
    "start": "564180",
    "end": "566279"
  },
  {
    "text": "provide them through a metadata service",
    "start": "566279",
    "end": "567870"
  },
  {
    "text": "with all to speak about here shortly but",
    "start": "567870",
    "end": "569910"
  },
  {
    "text": "because of this fact that the",
    "start": "569910",
    "end": "572070"
  },
  {
    "text": "credentials are short-lived and up to a",
    "start": "572070",
    "end": "574980"
  },
  {
    "text": "six-hour window we can get full coverage",
    "start": "574980",
    "end": "578100"
  },
  {
    "text": "in our environment for the minute you",
    "start": "578100",
    "end": "579450"
  },
  {
    "text": "put this in place in up to 6 hours it",
    "start": "579450",
    "end": "582690"
  },
  {
    "text": "can be much shorter but depending on",
    "start": "582690",
    "end": "584430"
  },
  {
    "text": "when the last credential is issued in",
    "start": "584430",
    "end": "586020"
  },
  {
    "text": "your environment it's up to 6 hours so",
    "start": "586020",
    "end": "588360"
  },
  {
    "text": "from zero coverage to full coverage in 6",
    "start": "588360",
    "end": "590010"
  },
  {
    "text": "hours",
    "start": "590010",
    "end": "590370"
  },
  {
    "text": "which i think is pretty cool and not",
    "start": "590370",
    "end": "592649"
  },
  {
    "text": "only in real time can you do this but",
    "start": "592649",
    "end": "593970"
  },
  {
    "text": "also historically over old Platteville",
    "start": "593970",
    "end": "596579"
  },
  {
    "text": "data if you're just interested in",
    "start": "596579",
    "end": "597720"
  },
  {
    "text": "understanding have we had a missed use",
    "start": "597720",
    "end": "600240"
  },
  {
    "text": "credential in the past you can run this",
    "start": "600240",
    "end": "602339"
  },
  {
    "text": "over past data as well so first how does",
    "start": "602339",
    "end": "606029"
  },
  {
    "text": "AWS work given that you're deploying a",
    "start": "606029",
    "end": "608850"
  },
  {
    "text": "server in the cloud there in the middle",
    "start": "608850",
    "end": "611550"
  },
  {
    "text": "there's multiple parts actually",
    "start": "611550",
    "end": "614089"
  },
  {
    "text": "interacting together the Amazon ec2",
    "start": "614089",
    "end": "616560"
  },
  {
    "text": "service is going to ask the I am service",
    "start": "616560",
    "end": "620040"
  },
  {
    "text": "for credentials for your instance so",
    "start": "620040",
    "end": "622589"
  },
  {
    "text": "that your application can actually make",
    "start": "622589",
    "end": "623970"
  },
  {
    "text": "API calls in AWS so it's going to do an",
    "start": "623970",
    "end": "627540"
  },
  {
    "text": "assumed role call by the ec2 service the",
    "start": "627540",
    "end": "630600"
  },
  {
    "text": "iam service is then going to pass",
    "start": "630600",
    "end": "632550"
  },
  {
    "text": "credentials back to the ec2 service",
    "start": "632550",
    "end": "635190"
  },
  {
    "text": "which is then going to pass those into",
    "start": "635190",
    "end": "637709"
  },
  {
    "text": "the metadata service now the metadata",
    "start": "637709",
    "end": "639870"
  },
  {
    "text": "service is something that's mounted into",
    "start": "639870",
    "end": "641670"
  },
  {
    "text": "your VM",
    "start": "641670",
    "end": "642870"
  },
  {
    "text": "and available with a common address of",
    "start": "642870",
    "end": "645270"
  },
  {
    "text": "169.254 169.254 now I believe that's",
    "start": "645270",
    "end": "649020"
  },
  {
    "text": "common across the cloud providers and",
    "start": "649020",
    "end": "650700"
  },
  {
    "text": "something that even the attackers know",
    "start": "650700",
    "end": "652529"
  },
  {
    "text": "and will cover why that's important but",
    "start": "652529",
    "end": "654540"
  },
  {
    "text": "the metadata service has information",
    "start": "654540",
    "end": "656010"
  },
  {
    "text": "about your instance where what's the IP",
    "start": "656010",
    "end": "658830"
  },
  {
    "text": "what region or availability zone is it",
    "start": "658830",
    "end": "661170"
  },
  {
    "text": "deployed any type of user data that",
    "start": "661170",
    "end": "663270"
  },
  {
    "text": "you're injecting at launch but most",
    "start": "663270",
    "end": "665490"
  },
  {
    "text": "importantly credentials and so once the",
    "start": "665490",
    "end": "668730"
  },
  {
    "text": "metadata service has these credentials",
    "start": "668730",
    "end": "670020"
  },
  {
    "text": "they're valid for one to six hours",
    "start": "670020",
    "end": "671670"
  },
  {
    "text": "they'll automatically refreshed but when",
    "start": "671670",
    "end": "674610"
  },
  {
    "text": "you're when the application goes to use",
    "start": "674610",
    "end": "676290"
  },
  {
    "text": "them they'll reach out to the metadata",
    "start": "676290",
    "end": "677790"
  },
  {
    "text": "service create a session or a client",
    "start": "677790",
    "end": "680610"
  },
  {
    "text": "object and then you can go make API",
    "start": "680610",
    "end": "683400"
  },
  {
    "text": "calls to the service of your choice now",
    "start": "683400",
    "end": "685980"
  },
  {
    "text": "the way that Quattro works is Quattro is",
    "start": "685980",
    "end": "688440"
  },
  {
    "text": "a service within Amazon and services",
    "start": "688440",
    "end": "690600"
  },
  {
    "text": "have the ability to log what they want",
    "start": "690600",
    "end": "692910"
  },
  {
    "text": "or not log what they want so cloud troll",
    "start": "692910",
    "end": "695100"
  },
  {
    "text": "can't really control it but they offer",
    "start": "695100",
    "end": "696330"
  },
  {
    "text": "it as a service internally and so",
    "start": "696330",
    "end": "698279"
  },
  {
    "text": "depending on the API call you're making",
    "start": "698279",
    "end": "699720"
  },
  {
    "text": "there might be an ape cloud roll call",
    "start": "699720",
    "end": "702000"
  },
  {
    "text": "most likely I'm mutating events or any",
    "start": "702000",
    "end": "704670"
  },
  {
    "text": "event that changes your environment",
    "start": "704670",
    "end": "706140"
  },
  {
    "text": "you'll see these but there is a gap in",
    "start": "706140",
    "end": "708330"
  },
  {
    "text": "data events which we'll cover so that",
    "start": "708330",
    "end": "711209"
  },
  {
    "text": "strong assumption I mentioned is pretty",
    "start": "711209",
    "end": "714420"
  },
  {
    "text": "simple it's basically first call wins so",
    "start": "714420",
    "end": "717839"
  },
  {
    "text": "we're going to keep track of when",
    "start": "717839",
    "end": "718920"
  },
  {
    "text": "Amazon's making session credentials",
    "start": "718920",
    "end": "721320"
  },
  {
    "text": "we're going to store those in a table",
    "start": "721320",
    "end": "723150"
  },
  {
    "text": "and walk through an example here and as",
    "start": "723150",
    "end": "725040"
  },
  {
    "text": "we see the first use of that temporary",
    "start": "725040",
    "end": "727290"
  },
  {
    "text": "credential we're gonna grab that IP",
    "start": "727290",
    "end": "729120"
  },
  {
    "text": "address and lock it and that's going to",
    "start": "729120",
    "end": "731970"
  },
  {
    "text": "be the IP address that we hinge upon and",
    "start": "731970",
    "end": "733709"
  },
  {
    "text": "so without requiring any knowledge of",
    "start": "733709",
    "end": "735750"
  },
  {
    "text": "the IP space we can grow the session",
    "start": "735750",
    "end": "738750"
  },
  {
    "text": "table and understand what ip's should we",
    "start": "738750",
    "end": "740640"
  },
  {
    "text": "actually see API calls coming from and",
    "start": "740640",
    "end": "743100"
  },
  {
    "text": "from that alerting is pretty simple if",
    "start": "743100",
    "end": "747900"
  },
  {
    "text": "you were to look through this diagram",
    "start": "747900",
    "end": "749040"
  },
  {
    "text": "the pink boxes would show you the path",
    "start": "749040",
    "end": "751529"
  },
  {
    "text": "to detection so if you're processing",
    "start": "751529",
    "end": "753990"
  },
  {
    "text": "quadrille you're going to get files and",
    "start": "753990",
    "end": "756720"
  },
  {
    "text": "you're going to process event after",
    "start": "756720",
    "end": "757980"
  },
  {
    "text": "event every file has up to thousands of",
    "start": "757980",
    "end": "760589"
  },
  {
    "text": "events in it so you're gonna sort those",
    "start": "760589",
    "end": "762390"
  },
  {
    "text": "events by time you're going to go",
    "start": "762390",
    "end": "764339"
  },
  {
    "text": "through and process each clot road",
    "start": "764339",
    "end": "765870"
  },
  {
    "text": "record",
    "start": "765870",
    "end": "766980"
  },
  {
    "text": "then one by one we're gonna look for the",
    "start": "766980",
    "end": "769589"
  },
  {
    "text": "assumed roll call by ec2 and we'll show",
    "start": "769589",
    "end": "772170"
  },
  {
    "text": "actual cloud row examples here shortly",
    "start": "772170",
    "end": "774180"
  },
  {
    "text": "as we see that we're gonna look into our",
    "start": "774180",
    "end": "776790"
  },
  {
    "text": "table and say do we have a record of",
    "start": "776790",
    "end": "778410"
  },
  {
    "text": "this already if not then we're gonna go",
    "start": "778410",
    "end": "780690"
  },
  {
    "text": "at it we're gonna add a TTL for six",
    "start": "780690",
    "end": "783360"
  },
  {
    "text": "hours and that TTL is really just going",
    "start": "783360",
    "end": "785610"
  },
  {
    "text": "to allow us to clean the table up",
    "start": "785610",
    "end": "786990"
  },
  {
    "text": "automatically in the DynamoDB fashion if",
    "start": "786990",
    "end": "790680"
  },
  {
    "text": "it's already in the table then we know",
    "start": "790680",
    "end": "793560"
  },
  {
    "text": "that that instance is still up that role",
    "start": "793560",
    "end": "795690"
  },
  {
    "text": "is still being used and we're just going",
    "start": "795690",
    "end": "797370"
  },
  {
    "text": "to refresh the TTL so you can",
    "start": "797370",
    "end": "800130"
  },
  {
    "text": "continually update if you look at the",
    "start": "800130",
    "end": "802470"
  },
  {
    "text": "table after the six hour window you",
    "start": "802470",
    "end": "804089"
  },
  {
    "text": "would know every session credential",
    "start": "804089",
    "end": "806130"
  },
  {
    "text": "issued for your environment so once we",
    "start": "806130",
    "end": "809040"
  },
  {
    "text": "have a table built we're then going to",
    "start": "809040",
    "end": "811170"
  },
  {
    "text": "look for the assumed role session tokens",
    "start": "811170",
    "end": "813750"
  },
  {
    "text": "being used and you can do that by",
    "start": "813750",
    "end": "815130"
  },
  {
    "text": "looking at the type of the call or the",
    "start": "815130",
    "end": "817170"
  },
  {
    "text": "type of the identity in clout row if",
    "start": "817170",
    "end": "820500"
  },
  {
    "text": "it's intercession the table we're going",
    "start": "820500",
    "end": "823079"
  },
  {
    "text": "to continue on if it's not in our",
    "start": "823079",
    "end": "824940"
  },
  {
    "text": "session table we can't make that",
    "start": "824940",
    "end": "826230"
  },
  {
    "text": "accurate guess or that accurate",
    "start": "826230",
    "end": "828649"
  },
  {
    "text": "assertion that this is a potentially",
    "start": "828649",
    "end": "831060"
  },
  {
    "text": "misuse credential so we're just going to",
    "start": "831060",
    "end": "832800"
  },
  {
    "text": "throw that data away you can opt in to",
    "start": "832800",
    "end": "835350"
  },
  {
    "text": "saying first first time on any session",
    "start": "835350",
    "end": "837660"
  },
  {
    "text": "we're gonna walk to that but we've",
    "start": "837660",
    "end": "839730"
  },
  {
    "text": "chosen on this initial implementation to",
    "start": "839730",
    "end": "841319"
  },
  {
    "text": "at least throw it away we're gonna get",
    "start": "841319",
    "end": "843209"
  },
  {
    "text": "coverage within six hours so it's not",
    "start": "843209",
    "end": "845040"
  },
  {
    "text": "really that big of a deal so once you're",
    "start": "845040",
    "end": "848339"
  },
  {
    "text": "in the session table or once it's in the",
    "start": "848339",
    "end": "849870"
  },
  {
    "text": "session table you can then go look is it",
    "start": "849870",
    "end": "852269"
  },
  {
    "text": "AWS making a call on your behalf which",
    "start": "852269",
    "end": "854190"
  },
  {
    "text": "will go into edge cases here and shortly",
    "start": "854190",
    "end": "856199"
  },
  {
    "text": "or is it an IP that we whitelist maybe",
    "start": "856199",
    "end": "859350"
  },
  {
    "text": "we allow users to pool credentials down",
    "start": "859350",
    "end": "861540"
  },
  {
    "text": "for the VPN if not then we're gonna go",
    "start": "861540",
    "end": "864839"
  },
  {
    "text": "look and say do we have the source IP in",
    "start": "864839",
    "end": "866550"
  },
  {
    "text": "our table already if we do do they match",
    "start": "866550",
    "end": "869399"
  },
  {
    "text": "if they match then we continue on if",
    "start": "869399",
    "end": "872399"
  },
  {
    "text": "they don't then we alert and if we",
    "start": "872399",
    "end": "874889"
  },
  {
    "text": "didn't have a source IP in the table",
    "start": "874889",
    "end": "876240"
  },
  {
    "text": "then that's when we'd add it to the",
    "start": "876240",
    "end": "877440"
  },
  {
    "text": "session so it's basically you're doing",
    "start": "877440",
    "end": "879029"
  },
  {
    "text": "this kind of flow each event and you",
    "start": "879029",
    "end": "882870"
  },
  {
    "text": "eventually make this table that lists",
    "start": "882870",
    "end": "885240"
  },
  {
    "text": "every temporary credential in your",
    "start": "885240",
    "end": "887100"
  },
  {
    "text": "environment and what IP they should be",
    "start": "887100",
    "end": "889019"
  },
  {
    "text": "coming from I mentioned a simple",
    "start": "889019",
    "end": "892500"
  },
  {
    "text": "architecture diagram I debated whether I",
    "start": "892500",
    "end": "894389"
  },
  {
    "text": "should actually throw this slide out",
    "start": "894389",
    "end": "895709"
  },
  {
    "text": "because it's the first time I've ever",
    "start": "895709",
    "end": "897029"
  },
  {
    "text": "done",
    "start": "897029",
    "end": "897570"
  },
  {
    "text": "a diagram that was a single line if",
    "start": "897570",
    "end": "900360"
  },
  {
    "text": "you've done this like or done this many",
    "start": "900360",
    "end": "902250"
  },
  {
    "text": "times please let me know because I need",
    "start": "902250",
    "end": "903960"
  },
  {
    "text": "some pointers first time this happened",
    "start": "903960",
    "end": "905810"
  },
  {
    "text": "so we can start with a table like this",
    "start": "905810",
    "end": "908280"
  },
  {
    "text": "we have an identifier a source IP the",
    "start": "908280",
    "end": "911190"
  },
  {
    "text": "air in that we're actually interested in",
    "start": "911190",
    "end": "913620"
  },
  {
    "text": "and then our TTL value as we analyze",
    "start": "913620",
    "end": "916110"
  },
  {
    "text": "cloud trail we're looking for that",
    "start": "916110",
    "end": "919020"
  },
  {
    "text": "initial assumed roll call which is from",
    "start": "919020",
    "end": "921180"
  },
  {
    "text": "the event name and the pieces that tip",
    "start": "921180",
    "end": "923130"
  },
  {
    "text": "tip us off of that is source IP address",
    "start": "923130",
    "end": "925740"
  },
  {
    "text": "is actually going to be registered as",
    "start": "925740",
    "end": "927090"
  },
  {
    "text": "the service ec2 and user agent will be",
    "start": "927090",
    "end": "930090"
  },
  {
    "text": "the same and as well as user identity is",
    "start": "930090",
    "end": "932520"
  },
  {
    "text": "a to be a service invoked by ec2 Amazon",
    "start": "932520",
    "end": "934920"
  },
  {
    "text": "so once we see that we can actually go",
    "start": "934920",
    "end": "937320"
  },
  {
    "text": "into request parameters which Amazon ec2",
    "start": "937320",
    "end": "940710"
  },
  {
    "text": "service is very nice that when they",
    "start": "940710",
    "end": "942690"
  },
  {
    "text": "actually create the temporary session",
    "start": "942690",
    "end": "944370"
  },
  {
    "text": "they're gonna create it with an instance",
    "start": "944370",
    "end": "946320"
  },
  {
    "text": "ID so you can track the temporary",
    "start": "946320",
    "end": "948660"
  },
  {
    "text": "credential down to the instance level",
    "start": "948660",
    "end": "950400"
  },
  {
    "text": "and know exactly what instance is",
    "start": "950400",
    "end": "952380"
  },
  {
    "text": "compromised from here we can see that",
    "start": "952380",
    "end": "954900"
  },
  {
    "text": "the role that they're assuming is my",
    "start": "954900",
    "end": "956610"
  },
  {
    "text": "cool role and that's what we're gonna",
    "start": "956610",
    "end": "958350"
  },
  {
    "text": "track on so if we took this entry and",
    "start": "958350",
    "end": "960660"
  },
  {
    "text": "actually went to populate a table it",
    "start": "960660",
    "end": "962220"
  },
  {
    "text": "might end up looking something like this",
    "start": "962220",
    "end": "964050"
  },
  {
    "text": "we leave that source IP blank initially",
    "start": "964050",
    "end": "966600"
  },
  {
    "text": "until we actually see the first call you",
    "start": "966600",
    "end": "968760"
  },
  {
    "text": "continue to process more events more",
    "start": "968760",
    "end": "970620"
  },
  {
    "text": "events you'll come across more assume",
    "start": "970620",
    "end": "973020"
  },
  {
    "text": "roles you'll come across things that you",
    "start": "973020",
    "end": "974400"
  },
  {
    "text": "who don't have your table but once you",
    "start": "974400",
    "end": "976470"
  },
  {
    "text": "come across something that you know you",
    "start": "976470",
    "end": "979080"
  },
  {
    "text": "can see that it's a type assumed role so",
    "start": "979080",
    "end": "981660"
  },
  {
    "text": "we know it's something we care about the",
    "start": "981660",
    "end": "983970"
  },
  {
    "text": "air in is assumed rule my cool rule and",
    "start": "983970",
    "end": "986700"
  },
  {
    "text": "we can see that the session identifier",
    "start": "986700",
    "end": "989220"
  },
  {
    "text": "which is everything after the roll name",
    "start": "989220",
    "end": "990780"
  },
  {
    "text": "so anything following the final slash",
    "start": "990780",
    "end": "994230"
  },
  {
    "text": "and then assumed role air in is your",
    "start": "994230",
    "end": "996180"
  },
  {
    "text": "session name we can see that it's marked",
    "start": "996180",
    "end": "998490"
  },
  {
    "text": "to an instance ID so we know it's",
    "start": "998490",
    "end": "1001580"
  },
  {
    "text": "probably something we might have or it's",
    "start": "1001580",
    "end": "1003560"
  },
  {
    "text": "something that we're throwing away and",
    "start": "1003560",
    "end": "1005000"
  },
  {
    "text": "we'll have at some point if we're",
    "start": "1005000",
    "end": "1006920"
  },
  {
    "text": "interested we can go down and see what",
    "start": "1006920",
    "end": "1008510"
  },
  {
    "text": "was actually called so in this case",
    "start": "1008510",
    "end": "1010070"
  },
  {
    "text": "someone was describing instances in the",
    "start": "1010070",
    "end": "1011780"
  },
  {
    "text": "environment in the region uswest to the",
    "start": "1011780",
    "end": "1015020"
  },
  {
    "text": "most important piece for us of course is",
    "start": "1015020",
    "end": "1016910"
  },
  {
    "text": "the source IP 52.95 - 5.1 - long if",
    "start": "1016910",
    "end": "1021650"
  },
  {
    "text": "you're familiar with the amazon IP space",
    "start": "1021650",
    "end": "1023420"
  },
  {
    "text": "you know that's an amazon IP so we can",
    "start": "1023420",
    "end": "1025970"
  },
  {
    "text": "actually go in and add it to our table",
    "start": "1025970",
    "end": "1028360"
  },
  {
    "text": "so now we have our initial session and",
    "start": "1028360",
    "end": "1030819"
  },
  {
    "text": "IP locked so if we come across this",
    "start": "1030819",
    "end": "1032949"
  },
  {
    "text": "again we can do the analysis and say",
    "start": "1032949",
    "end": "1034750"
  },
  {
    "text": "does this match or does it not so if we",
    "start": "1034750",
    "end": "1036819"
  },
  {
    "text": "continue processing Claude trail we can",
    "start": "1036819",
    "end": "1039038"
  },
  {
    "text": "see once again we have a type assumed",
    "start": "1039039",
    "end": "1040928"
  },
  {
    "text": "rule it's the air in to the temporary",
    "start": "1040929",
    "end": "1044740"
  },
  {
    "text": "credential from my cool role and the",
    "start": "1044740",
    "end": "1046449"
  },
  {
    "text": "session looks like something that we",
    "start": "1046449",
    "end": "1047798"
  },
  {
    "text": "just saw if we're interested once again",
    "start": "1047799",
    "end": "1051370"
  },
  {
    "text": "we can actually look and see what the",
    "start": "1051370",
    "end": "1052779"
  },
  {
    "text": "event name are sources this might not be",
    "start": "1052779",
    "end": "1054700"
  },
  {
    "text": "interesting until you trigger an alert",
    "start": "1054700",
    "end": "1057010"
  },
  {
    "text": "but something you might still want to do",
    "start": "1057010",
    "end": "1059110"
  },
  {
    "text": "alerts for there are dangerous calls but",
    "start": "1059110",
    "end": "1061510"
  },
  {
    "text": "that's outside the scope at this time",
    "start": "1061510",
    "end": "1063210"
  },
  {
    "text": "but most importantly is the source IP",
    "start": "1063210",
    "end": "1066100"
  },
  {
    "text": "address 52.95 dot 255 dot one-to-one so",
    "start": "1066100",
    "end": "1070240"
  },
  {
    "text": "we go back we see that we have the",
    "start": "1070240",
    "end": "1072130"
  },
  {
    "text": "session our hash key and a dynamo table",
    "start": "1072130",
    "end": "1075279"
  },
  {
    "text": "scenario is the instance ID",
    "start": "1075279",
    "end": "1077169"
  },
  {
    "text": "it's unique globally so don't worry",
    "start": "1077169",
    "end": "1079690"
  },
  {
    "text": "about collisions across your accounts",
    "start": "1079690",
    "end": "1081700"
  },
  {
    "text": "but we can ask that question does do",
    "start": "1081700",
    "end": "1084580"
  },
  {
    "text": "these two IPS match in our case they do",
    "start": "1084580",
    "end": "1087039"
  },
  {
    "text": "so we can say this is good continue",
    "start": "1087039",
    "end": "1089440"
  },
  {
    "text": "moving on so you do this process over",
    "start": "1089440",
    "end": "1091360"
  },
  {
    "text": "and over and over and eventually you",
    "start": "1091360",
    "end": "1093190"
  },
  {
    "text": "might come across something that should",
    "start": "1093190",
    "end": "1096370"
  },
  {
    "text": "look familiar by now it's my cool role",
    "start": "1096370",
    "end": "1098289"
  },
  {
    "text": "the instance ID that we're used to the",
    "start": "1098289",
    "end": "1101080"
  },
  {
    "text": "event name is get caller identity which",
    "start": "1101080",
    "end": "1103539"
  },
  {
    "text": "is probably suspicious in itself if you",
    "start": "1103539",
    "end": "1106269"
  },
  {
    "text": "aren't familiar with AWS yet color",
    "start": "1106269",
    "end": "1108399"
  },
  {
    "text": "identity is similar to Who am I on a",
    "start": "1108399",
    "end": "1110440"
  },
  {
    "text": "Linux machine there's no real good",
    "start": "1110440",
    "end": "1112630"
  },
  {
    "text": "reason to call this in your account if",
    "start": "1112630",
    "end": "1114700"
  },
  {
    "text": "you see this it's probably someone",
    "start": "1114700",
    "end": "1117159"
  },
  {
    "text": "wanting to know what account they're in",
    "start": "1117159",
    "end": "1118539"
  },
  {
    "text": "because you can pull the account ID from",
    "start": "1118539",
    "end": "1120700"
  },
  {
    "text": "but there's other ways to get that",
    "start": "1120700",
    "end": "1122860"
  },
  {
    "text": "account information so I urge you to",
    "start": "1122860",
    "end": "1124360"
  },
  {
    "text": "work with the teams to change their",
    "start": "1124360",
    "end": "1125799"
  },
  {
    "text": "their way of life because this is",
    "start": "1125799",
    "end": "1127330"
  },
  {
    "text": "something common that an attacker might",
    "start": "1127330",
    "end": "1128830"
  },
  {
    "text": "do when they come across credentials is",
    "start": "1128830",
    "end": "1130960"
  },
  {
    "text": "Who am I is this juicy should I use it",
    "start": "1130960",
    "end": "1133059"
  },
  {
    "text": "in this call works regardless of",
    "start": "1133059",
    "end": "1135370"
  },
  {
    "text": "permissions in AWS so as long as the key",
    "start": "1135370",
    "end": "1137380"
  },
  {
    "text": "is valid this call will work but once",
    "start": "1137380",
    "end": "1141190"
  },
  {
    "text": "again our source IP is what we really",
    "start": "1141190",
    "end": "1142630"
  },
  {
    "text": "care about and in this case it's 67.1 7",
    "start": "1142630",
    "end": "1145779"
  },
  {
    "text": "8.5 2.2 3 - this is a San Jose IP it's",
    "start": "1145779",
    "end": "1149590"
  },
  {
    "text": "most likely my house for this",
    "start": "1149590",
    "end": "1151000"
  },
  {
    "text": "demonstration and this is another",
    "start": "1151000",
    "end": "1154510"
  },
  {
    "text": "question that we asked does this match",
    "start": "1154510",
    "end": "1156779"
  },
  {
    "text": "so in this case we know these two IPS",
    "start": "1156779",
    "end": "1159159"
  },
  {
    "text": "don't match so",
    "start": "1159159",
    "end": "1160310"
  },
  {
    "text": "this would trigger an alert of",
    "start": "1160310",
    "end": "1161890"
  },
  {
    "text": "potentially compromised credential a",
    "start": "1161890",
    "end": "1164120"
  },
  {
    "text": "employee or engineer has put pencils",
    "start": "1164120",
    "end": "1167180"
  },
  {
    "text": "down they used it off VPN if it's a",
    "start": "1167180",
    "end": "1168980"
  },
  {
    "text": "whitelist",
    "start": "1168980",
    "end": "1169460"
  },
  {
    "text": "but we at least know here that a",
    "start": "1169460",
    "end": "1171920"
  },
  {
    "text": "credential is not being used inside your",
    "start": "1171920",
    "end": "1174220"
  },
  {
    "text": "environment so this could be from a",
    "start": "1174220",
    "end": "1176690"
  },
  {
    "text": "different AWS environment that's not",
    "start": "1176690",
    "end": "1179570"
  },
  {
    "text": "registered in your account and you would",
    "start": "1179570",
    "end": "1181820"
  },
  {
    "text": "alert on it so I think that's pretty",
    "start": "1181820",
    "end": "1183350"
  },
  {
    "text": "powerful I mentioned a few edge cases as",
    "start": "1183350",
    "end": "1186140"
  },
  {
    "text": "you can continue to monitor cloud show",
    "start": "1186140",
    "end": "1189560"
  },
  {
    "text": "you'll find that anytime Amazon does",
    "start": "1189560",
    "end": "1191990"
  },
  {
    "text": "something on your behalf you're gonna",
    "start": "1191990",
    "end": "1194720"
  },
  {
    "text": "see the source IP show up as a service",
    "start": "1194720",
    "end": "1196940"
  },
  {
    "text": "name dot Amazon AWS com this is weather",
    "start": "1196940",
    "end": "1200540"
  },
  {
    "text": "support is looking into your account for",
    "start": "1200540",
    "end": "1202130"
  },
  {
    "text": "a ticket auto scaling group is auto",
    "start": "1202130",
    "end": "1203990"
  },
  {
    "text": "scaling your service or there's actually",
    "start": "1203990",
    "end": "1206150"
  },
  {
    "text": "many calls that you make that Amazon",
    "start": "1206150",
    "end": "1208370"
  },
  {
    "text": "takes your credentials and make some",
    "start": "1208370",
    "end": "1210320"
  },
  {
    "text": "calls on your behalf to make your life",
    "start": "1210320",
    "end": "1211910"
  },
  {
    "text": "easier if you're restoring an encrypted",
    "start": "1211910",
    "end": "1214130"
  },
  {
    "text": "database for an example Amazon will go",
    "start": "1214130",
    "end": "1216350"
  },
  {
    "text": "make kms calls on your behalf so they'll",
    "start": "1216350",
    "end": "1218750"
  },
  {
    "text": "take your credentials and use them and",
    "start": "1218750",
    "end": "1220100"
  },
  {
    "text": "you'll see that show up in cloud trail",
    "start": "1220100",
    "end": "1221450"
  },
  {
    "text": "as an Amazon source if you're using VP",
    "start": "1221450",
    "end": "1224960"
  },
  {
    "text": "CN points such as the s3 end point and",
    "start": "1224960",
    "end": "1227060"
  },
  {
    "text": "you have Clodfelter and on for s3 you",
    "start": "1227060",
    "end": "1229940"
  },
  {
    "text": "will actually see the calls through that",
    "start": "1229940",
    "end": "1232190"
  },
  {
    "text": "end point show up as a private IP so you",
    "start": "1232190",
    "end": "1234860"
  },
  {
    "text": "need to have some logic for first public",
    "start": "1234860",
    "end": "1236750"
  },
  {
    "text": "for private IP pair and that private IP",
    "start": "1236750",
    "end": "1239090"
  },
  {
    "text": "ending up in the IP space for that",
    "start": "1239090",
    "end": "1241190"
  },
  {
    "text": "environment and also you might have a",
    "start": "1241190",
    "end": "1244370"
  },
  {
    "text": "scenario where you launch an instance",
    "start": "1244370",
    "end": "1246260"
  },
  {
    "text": "and you want to attach an elastic IP",
    "start": "1246260",
    "end": "1248720"
  },
  {
    "text": "because your public and you want the IP",
    "start": "1248720",
    "end": "1250520"
  },
  {
    "text": "to always be the same or you attach",
    "start": "1250520",
    "end": "1252290"
  },
  {
    "text": "multiple ionize it with that case you",
    "start": "1252290",
    "end": "1254930"
  },
  {
    "text": "might have a change in the IP that your",
    "start": "1254930",
    "end": "1256610"
  },
  {
    "text": "calls coming from so we recommend",
    "start": "1256610",
    "end": "1259010"
  },
  {
    "text": "looking for those calls and then putting",
    "start": "1259010",
    "end": "1262040"
  },
  {
    "text": "into a temporary table and say we can we",
    "start": "1262040",
    "end": "1265010"
  },
  {
    "text": "solve a try to attach a new IP will",
    "start": "1265010",
    "end": "1267290"
  },
  {
    "text": "accept one deviation from this list but",
    "start": "1267290",
    "end": "1269420"
  },
  {
    "text": "only for this amount of time because if",
    "start": "1269420",
    "end": "1271610"
  },
  {
    "text": "you're attaching a new IP you should see",
    "start": "1271610",
    "end": "1273020"
  },
  {
    "text": "calls from that new IP within minutes so",
    "start": "1273020",
    "end": "1275960"
  },
  {
    "text": "you can set that TTL on that table very",
    "start": "1275960",
    "end": "1278060"
  },
  {
    "text": "short and minimize that risk that in",
    "start": "1278060",
    "end": "1281330"
  },
  {
    "text": "that time frame an attacker were to",
    "start": "1281330",
    "end": "1282980"
  },
  {
    "text": "actually get your credentials",
    "start": "1282980",
    "end": "1285730"
  },
  {
    "text": "if you were to avoid detection one of",
    "start": "1285730",
    "end": "1287950"
  },
  {
    "text": "the most common ways credentials are",
    "start": "1287950",
    "end": "1289330"
  },
  {
    "text": "pulled from environments is through",
    "start": "1289330",
    "end": "1290890"
  },
  {
    "text": "server side request forgery this is",
    "start": "1290890",
    "end": "1292929"
  },
  {
    "text": "where you've actually tricked the",
    "start": "1292929",
    "end": "1293950"
  },
  {
    "text": "application to pull the instance",
    "start": "1293950",
    "end": "1295929"
  },
  {
    "text": "metadata yourself",
    "start": "1295929",
    "end": "1297220"
  },
  {
    "text": "it's very common tactic for applications",
    "start": "1297220",
    "end": "1300519"
  },
  {
    "text": "and researchers if they know you're",
    "start": "1300519",
    "end": "1302380"
  },
  {
    "text": "running in AWS most likely it's a",
    "start": "1302380",
    "end": "1304960"
  },
  {
    "text": "critical vulnerability to the bug bounty",
    "start": "1304960",
    "end": "1306549"
  },
  {
    "text": "that you're submitting to what",
    "start": "1306549",
    "end": "1309279"
  },
  {
    "text": "researchers don't know is that they",
    "start": "1309279",
    "end": "1310630"
  },
  {
    "text": "could actually use those credentials",
    "start": "1310630",
    "end": "1311860"
  },
  {
    "text": "sign an API call and use that same",
    "start": "1311860",
    "end": "1314769"
  },
  {
    "text": "attack vector through SS RF to make that",
    "start": "1314769",
    "end": "1317440"
  },
  {
    "text": "call in that case it would actually come",
    "start": "1317440",
    "end": "1319480"
  },
  {
    "text": "from the IP of the server and you",
    "start": "1319480",
    "end": "1322149"
  },
  {
    "text": "wouldn't be able to detect it so in that",
    "start": "1322149",
    "end": "1324100"
  },
  {
    "text": "scenario you'd use a user agent and make",
    "start": "1324100",
    "end": "1325960"
  },
  {
    "text": "sure that it's something that Amazon COI",
    "start": "1325960",
    "end": "1327639"
  },
  {
    "text": "or STK would use if you have an attacker",
    "start": "1327639",
    "end": "1330850"
  },
  {
    "text": "on the box obviously you have other",
    "start": "1330850",
    "end": "1332740"
  },
  {
    "text": "problems that you're probably not going",
    "start": "1332740",
    "end": "1334090"
  },
  {
    "text": "to detect compromised unless you're",
    "start": "1334090",
    "end": "1335440"
  },
  {
    "text": "looking at call anomalies saying we've",
    "start": "1335440",
    "end": "1337659"
  },
  {
    "text": "never actually made that call before",
    "start": "1337659",
    "end": "1338860"
  },
  {
    "text": "from the service so quickly wrapping up",
    "start": "1338860",
    "end": "1341649"
  },
  {
    "text": "I've got two minutes and I'm happy to",
    "start": "1341649",
    "end": "1343059"
  },
  {
    "text": "take questions in the wrap-up room which",
    "start": "1343059",
    "end": "1345850"
  },
  {
    "text": "I think it's specific be but",
    "start": "1345850",
    "end": "1349230"
  },
  {
    "text": "understanding AWS and Quattro will make",
    "start": "1349230",
    "end": "1351429"
  },
  {
    "text": "your life easier especially from a",
    "start": "1351429",
    "end": "1352990"
  },
  {
    "text": "monitoring standpoint when we ask the",
    "start": "1352990",
    "end": "1355480"
  },
  {
    "text": "cloud trail service",
    "start": "1355480",
    "end": "1356500"
  },
  {
    "text": "what is logged they told us they did not",
    "start": "1356500",
    "end": "1358630"
  },
  {
    "text": "know so today I'm open sourcing a tool",
    "start": "1358630",
    "end": "1361299"
  },
  {
    "text": "called trailblazer that will enumerate",
    "start": "1361299",
    "end": "1363760"
  },
  {
    "text": "all API calls in your clot in your",
    "start": "1363760",
    "end": "1365590"
  },
  {
    "text": "environment and associate that call with",
    "start": "1365590",
    "end": "1368200"
  },
  {
    "text": "what is actually logged in cloud Trello",
    "start": "1368200",
    "end": "1370720"
  },
  {
    "text": "so not only are you saying is it logged",
    "start": "1370720",
    "end": "1372190"
  },
  {
    "text": "but you're seeing what it's logged as",
    "start": "1372190",
    "end": "1373510"
  },
  {
    "text": "there are some calls in cloud row that",
    "start": "1373510",
    "end": "1375820"
  },
  {
    "text": "are logged differently than the actual",
    "start": "1375820",
    "end": "1377260"
  },
  {
    "text": "API call itself and you can flip a",
    "start": "1377260",
    "end": "1380380"
  },
  {
    "text": "switch on this and actually use it as an",
    "start": "1380380",
    "end": "1381880"
  },
  {
    "text": "attack platform to test monitoring in",
    "start": "1381880",
    "end": "1384309"
  },
  {
    "text": "your environment so as a simple yamo",
    "start": "1384309",
    "end": "1386260"
  },
  {
    "text": "file you can chain together calls in",
    "start": "1386260",
    "end": "1387909"
  },
  {
    "text": "order to test your monitoring as well",
    "start": "1387909",
    "end": "1389460"
  },
  {
    "text": "and then also we're open sourcing an",
    "start": "1389460",
    "end": "1391750"
  },
  {
    "text": "example implementation of the method I",
    "start": "1391750",
    "end": "1393549"
  },
  {
    "text": "described today in Python in this",
    "start": "1393549",
    "end": "1395590"
  },
  {
    "text": "skunkworks repo of our github for",
    "start": "1395590",
    "end": "1397330"
  },
  {
    "text": "Netflix so if you're interested in",
    "start": "1397330",
    "end": "1398889"
  },
  {
    "text": "running it across cloth show data",
    "start": "1398889",
    "end": "1400510"
  },
  {
    "text": "offline there's an example of how to do",
    "start": "1400510",
    "end": "1402880"
  },
  {
    "text": "that there and you can take that code",
    "start": "1402880",
    "end": "1405130"
  },
  {
    "text": "and modify it at will and actually adapt",
    "start": "1405130",
    "end": "1406779"
  },
  {
    "text": "it to your architecture and how cloud",
    "start": "1406779",
    "end": "1408610"
  },
  {
    "text": "trail is actually delivered but with",
    "start": "1408610",
    "end": "1411130"
  },
  {
    "text": "that I thank you all for coming and I'll",
    "start": "1411130",
    "end": "1413139"
  },
  {
    "text": "be available after this for questions",
    "start": "1413139",
    "end": "1415350"
  },
  {
    "text": "[Applause]",
    "start": "1415350",
    "end": "1419100"
  }
]