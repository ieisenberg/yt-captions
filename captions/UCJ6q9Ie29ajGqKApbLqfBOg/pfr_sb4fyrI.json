[
  {
    "text": "thanks everyone so much for coming out for my second talk at black hat this year uh today I'm going to be talking about the secure boots security story",
    "start": "2840",
    "end": "10080"
  },
  {
    "text": "what Microsoft has been doing and also what we're going to be doing to fix it let's get right into",
    "start": "10080",
    "end": "17119"
  },
  {
    "text": "it uh so my name is Bill Dema and I work for the Microsoft security Response Center as the emerging threats lead I",
    "start": "17119",
    "end": "24519"
  },
  {
    "text": "have a background in Cloud security and low-level OS internals and I've worked with with secure boot for a little over",
    "start": "24519",
    "end": "30080"
  },
  {
    "text": "year now I'm going to first start by telling you a little bit about what secure boot",
    "start": "30080",
    "end": "36079"
  },
  {
    "text": "is and then we're going to move into some of the challenges that we've been facing with",
    "start": "36079",
    "end": "41239"
  },
  {
    "text": "it so the U extens unified extensible firmware interface is an industry standard that came after bios or Legacy",
    "start": "42360",
    "end": "49640"
  },
  {
    "text": "boot um in order to unify the practices of how your firmware is designed and",
    "start": "49640",
    "end": "55359"
  },
  {
    "text": "what interfaces it offers to developers so there's a lot of benefits with you including larger drives um the",
    "start": "55359",
    "end": "62079"
  },
  {
    "text": "unification leads into to a better developer experience but it also has better security so for example bios",
    "start": "62079",
    "end": "68360"
  },
  {
    "text": "really only had an access control using a password uh commonly available but um",
    "start": "68360",
    "end": "73520"
  },
  {
    "text": "with u we have something called secure boot which actually guarantees the uh validity of any code being executed at",
    "start": "73520",
    "end": "81640"
  },
  {
    "text": "boo the challenge with u secure boot is how do we know what to trust how do we know what code is allowed to load in",
    "start": "81640",
    "end": "88240"
  },
  {
    "text": "first place so UI runtime variables are how the OS",
    "start": "88240",
    "end": "94159"
  },
  {
    "text": "and firmware can interact with each other and including your OS boot environement the U runtime variables",
    "start": "94159",
    "end": "100399"
  },
  {
    "text": "include your boot order what is going to load first on your system but it also includes the signature list variables",
    "start": "100399",
    "end": "107600"
  },
  {
    "text": "including the key exchange key platform key the allowed signatures list and the",
    "start": "107600",
    "end": "112680"
  },
  {
    "text": "denied signatures list so the way that secure boot defines",
    "start": "112680",
    "end": "119920"
  },
  {
    "text": "trust is through these variables images are signed by a certificate in your allowed signatures database DB and then",
    "start": "119920",
    "end": "127759"
  },
  {
    "text": "to modify DB you actually need to have a key exchange key signed payload and to",
    "start": "127759",
    "end": "133720"
  },
  {
    "text": "modify the key exchange key you need to have control over the platform key and",
    "start": "133720",
    "end": "138959"
  },
  {
    "text": "finally to revoke trust when something goes wrong we use the denied signatures",
    "start": "138959",
    "end": "144040"
  },
  {
    "text": "list known as dbx the really interesting part about DB",
    "start": "144040",
    "end": "149720"
  },
  {
    "text": "and dbx and also the other certificate variables is that they're authenticated so they control what you",
    "start": "149720",
    "end": "156400"
  },
  {
    "text": "can load and allow hashes or certificates so I can include a hash of an image that I want to be allowed that",
    "start": "156400",
    "end": "162680"
  },
  {
    "text": "I want to allow to load on my machine or I can load the Microsoft ca for example into DB and that'll control any",
    "start": "162680",
    "end": "169920"
  },
  {
    "text": "Microsoft image will be allowed to load by default the thir certificate authorities that come with a default",
    "start": "169920",
    "end": "175760"
  },
  {
    "text": "Windows machine include the Microsoft production CA and also the U third party CA and another interesting fact about",
    "start": "175760",
    "end": "183000"
  },
  {
    "text": "these authenticated variables is that they're almost always append right updates so instead of rewriting the",
    "start": "183000",
    "end": "189480"
  },
  {
    "text": "entire allowed signatures list or rewriting the entire deny list what happens is we can sign payloads that",
    "start": "189480",
    "end": "196440"
  },
  {
    "text": "will instead merge with what's already there this way if you have any custom revocations Maybe by your OEM you're not",
    "start": "196440",
    "end": "202920"
  },
  {
    "text": "going to be losing those whenever Microsoft issues an update now dbx is really critical to",
    "start": "202920",
    "end": "210360"
  },
  {
    "text": "secure boot because secure boot needs to stop unauthorized code but it's not just",
    "start": "210360",
    "end": "216159"
  },
  {
    "text": "stopping unsigned images if there's any any vulnerability in a UI image we need",
    "start": "216159",
    "end": "221360"
  },
  {
    "text": "to make sure to revoke that image so that the legitimately signed image can't be abused in the future and so dbx is",
    "start": "221360",
    "end": "227760"
  },
  {
    "text": "actually how we're able to revoke the trust of previously signed images the reason it all matters is",
    "start": "227760",
    "end": "235000"
  },
  {
    "text": "because secure boot is what keeps your boot environment secure it's critical for establishing a chain of trust you",
    "start": "235000",
    "end": "241720"
  },
  {
    "text": "know it it deters physical attacks substantially and it prevents malicious code from executing at boot features",
    "start": "241720",
    "end": "249680"
  },
  {
    "text": "like bit Locker for example leverage secure boot as a part of its security",
    "start": "249680",
    "end": "255879"
  },
  {
    "text": "story so I'm going to tell you a little bit about its threat model Windows has several security",
    "start": "256560",
    "end": "262479"
  },
  {
    "text": "boundaries that are defined on the Microsoft website which are logical separations between the code and data of",
    "start": "262479",
    "end": "267880"
  },
  {
    "text": "different trust levels a boundary as an example would include a non-admin user",
    "start": "267880",
    "end": "273199"
  },
  {
    "text": "can't escalate their privileges to Kernel code execution and an example of a non-boundary would be an admin user",
    "start": "273199",
    "end": "280080"
  },
  {
    "text": "that that can execute kernel code secure boot is not a security boundary but it",
    "start": "280080",
    "end": "285160"
  },
  {
    "text": "is a security future that we intend to service so the real problem with secure",
    "start": "285160",
    "end": "291039"
  },
  {
    "text": "boot that we've experienced is the attack surface that comes from including administrators in its threat model in",
    "start": "291039",
    "end": "297520"
  },
  {
    "text": "almost all other windows components admins are usually out of scope because admins are assumed to have a high level",
    "start": "297520",
    "end": "303400"
  },
  {
    "text": "of privilege secure boot is one of those",
    "start": "303400",
    "end": "307840"
  },
  {
    "text": "exceptions so when you start up your machine there's a lot that happens on the right I have a high level overview",
    "start": "309759",
    "end": "316080"
  },
  {
    "text": "of the different components that go into your machine's boot environment so when you power on your device you know the",
    "start": "316080",
    "end": "321960"
  },
  {
    "text": "firmware will load any option ROMs or drivers needed to support your hardware and your OS bootloader will actually",
    "start": "321960",
    "end": "328240"
  },
  {
    "text": "initialize the environment for your operating system but the challenge here is that every single step of the way is",
    "start": "328240",
    "end": "335080"
  },
  {
    "text": "another attack surface that attackers can take advantage of and it makes it very difficult when yui everything is",
    "start": "335080",
    "end": "341520"
  },
  {
    "text": "aack surface in UI so to dissect this a bit further we",
    "start": "341520",
    "end": "348199"
  },
  {
    "text": "have the firmer challenge where everyone has their own Fork the updates are often",
    "start": "348199",
    "end": "353400"
  },
  {
    "text": "decentralized and there's an unverifiable supply chain we'll talk about this briefly later but there",
    "start": "353400",
    "end": "359680"
  },
  {
    "text": "serious problem with the firmware issue is that you can have one shared codebase that'll have a million vulnerabilities",
    "start": "359680",
    "end": "365960"
  },
  {
    "text": "and the next thing you know any Fork of that shared code base will also have those vulnerabilities making sure that",
    "start": "365960",
    "end": "371560"
  },
  {
    "text": "vulnerabilities are fixed when the entire ecosystem is De centralized in nature is a really challenging problem",
    "start": "371560",
    "end": "378440"
  },
  {
    "text": "that can leave users exposed another factor for risk it includes the dis so this is why we need",
    "start": "378440",
    "end": "384919"
  },
  {
    "text": "to have dbx in the first place you can't trust any file as a u developer for",
    "start": "384919",
    "end": "391680"
  },
  {
    "text": "example an attacker can bring an old version of a bootloader that has a vulnerability and then swap out your",
    "start": "391680",
    "end": "397080"
  },
  {
    "text": "bootloader with this vulnerable one this is why it's so critical to have the capability to revoke trust not just",
    "start": "397080",
    "end": "403280"
  },
  {
    "text": "assign it and to make matters worse these file systems can actually be remote as",
    "start": "403280",
    "end": "411159"
  },
  {
    "text": "well another layer of risk includes Microsoft images so these are images that Microsoft signs to enable for",
    "start": "412560",
    "end": "418560"
  },
  {
    "text": "example windows now these images can have often a lot of un audited attack surfaces there's bu",
    "start": "418560",
    "end": "425319"
  },
  {
    "text": "design risks where sometimes for extensibility a future is added to these bootloaders that allows you to do things",
    "start": "425319",
    "end": "431120"
  },
  {
    "text": "that might compromise our security model and to be clear the Microsoft",
    "start": "431120",
    "end": "436440"
  },
  {
    "text": "image story is also exposed to third Parties by default and third party images that we",
    "start": "436440",
    "end": "442919"
  },
  {
    "text": "sign with the ufca so this includes things like Linux well we have over 15,000 of them and the problem is we",
    "start": "442919",
    "end": "450440"
  },
  {
    "text": "often have a lack of visibility into these images you know we we are given a binary blob that we can go ahead and",
    "start": "450440",
    "end": "455520"
  },
  {
    "text": "sign but um you know sometimes we add a questionnaire other than that we it's really difficult to know what makes up",
    "start": "455520",
    "end": "461919"
  },
  {
    "text": "these different drivers and every single driver here is another by default attack",
    "start": "461919",
    "end": "467319"
  },
  {
    "text": "surface like the third party like Microsoft images are exposed to the third party customers third party images",
    "start": "467319",
    "end": "473720"
  },
  {
    "text": "are also exposed to first-party customers so where do we draw the line",
    "start": "473720",
    "end": "479680"
  },
  {
    "text": "in terms of what we consider defensible well in general an admin user that can",
    "start": "479680",
    "end": "485120"
  },
  {
    "text": "compromise boot environment is something we're going to want to address now for physical attackers it's",
    "start": "485120",
    "end": "490680"
  },
  {
    "text": "usually dispensable obviously with enough time and effort there's chances are secure boo can be",
    "start": "490680",
    "end": "497479"
  },
  {
    "text": "compromised Network boo to a boot environment is also another example of something we'd like to defend uh but",
    "start": "497479",
    "end": "503520"
  },
  {
    "text": "unfortunately Network boot to user mode is not something that we consider defensible so for example there's a lot",
    "start": "503520",
    "end": "508960"
  },
  {
    "text": "of feutures that we've added for administrators like let's say I want to deploy a custom image for my",
    "start": "508960",
    "end": "514320"
  },
  {
    "text": "organization um in these cases if you can achieve the same impact by Design then unfortunately we don't consider",
    "start": "514320",
    "end": "520279"
  },
  {
    "text": "that something we want to defend now let's talk about what makes",
    "start": "520279",
    "end": "526640"
  },
  {
    "text": "secure boots so difficult to defend in the first place number one is our limited response",
    "start": "526640",
    "end": "534680"
  },
  {
    "text": "capability remember to fix yui bugs we not only need to fix the code but we",
    "start": "534680",
    "end": "540600"
  },
  {
    "text": "also need to make sure to revoke every image that had the vulnerable code in the first place so the UI standard says to add",
    "start": "540600",
    "end": "547959"
  },
  {
    "text": "these images to the dbx variable like we talked about earlier but this variable only has 32 kilobytes of space on",
    "start": "547959",
    "end": "555079"
  },
  {
    "text": "Windows 10 machines up to the hardware requirements for 1709 this equates to roughly 600 to 800",
    "start": "555079",
    "end": "562680"
  },
  {
    "text": "unique hashes and while that sounds like a lot it's a lot less than you might",
    "start": "562680",
    "end": "568360"
  },
  {
    "text": "expect right now we're actually at um already halfway filled with the dbx",
    "start": "568360",
    "end": "573720"
  },
  {
    "text": "variable and it's a problem for us because there's a lot more vulnerable images we need to consider and finally revoking isn't",
    "start": "573720",
    "end": "580640"
  },
  {
    "text": "always going to be possible for example even if we had all the space in the world sometimes it's really difficult to",
    "start": "580640",
    "end": "586000"
  },
  {
    "text": "revoke because what if I have Windows on a USB stick and that bootloader is has vulnerable code in it now if you plug in",
    "start": "586000",
    "end": "592640"
  },
  {
    "text": "that USB stick you're not going to be allowed to load your USB imagine that in a recovery scenario it would be a",
    "start": "592640",
    "end": "598440"
  },
  {
    "text": "disaster this different certificate authorities in play here include the production CA",
    "start": "598440",
    "end": "604399"
  },
  {
    "text": "and the third party CA so with the production ca for Windows that includes a lot of extensible features products",
    "start": "604399",
    "end": "610959"
  },
  {
    "text": "Etc and that's over 10,000 nit boot images that we've signed and the third part CA like we talked about includes",
    "start": "610959",
    "end": "617760"
  },
  {
    "text": "over 16,000 boot images that we've signed to dat and that's a lot of unaudited attack surface that can share",
    "start": "617760",
    "end": "624519"
  },
  {
    "text": "code and cause problems",
    "start": "624519",
    "end": "628519"
  },
  {
    "text": "now will all 30,000 signed images from both CA have vulnerabilities probably not you know it's hard to be safe in yui",
    "start": "629560",
    "end": "638440"
  },
  {
    "text": "when everything is in its hack surface you know a vulnerable in one image is rarely limited to that one",
    "start": "638440",
    "end": "645120"
  },
  {
    "text": "image for example if you have a shared library in an image that Library might",
    "start": "645120",
    "end": "650800"
  },
  {
    "text": "be compiled into a bunch of bootloaders that you sign and now if there's a vulnerability in that Library we have to",
    "start": "650800",
    "end": "656800"
  },
  {
    "text": "go ahead and revoke every single image that has that library and every previous version of those images that also had",
    "start": "656800",
    "end": "663360"
  },
  {
    "text": "that Library this is where the dbx failures come into effect you know it's it's",
    "start": "663360",
    "end": "669519"
  },
  {
    "text": "great in theory I I completely agree with it in principle but in practice 600",
    "start": "669519",
    "end": "674680"
  },
  {
    "text": "to 800 hashes is not much space at",
    "start": "674680",
    "end": "679079"
  },
  {
    "text": "all so to go through some examples to start with Windows um some of you might",
    "start": "680560",
    "end": "685760"
  },
  {
    "text": "be familiar with black lotus so EET published a report about Black Lotus an IND wild boot kit uh a little over a",
    "start": "685760",
    "end": "692240"
  },
  {
    "text": "year ago and the interesting part about this vulnerability was that it abused cve 2022 21894 which was actually fixed",
    "start": "692240",
    "end": "700800"
  },
  {
    "text": "in a previous security update but how are they abusing it well the blog is",
    "start": "700800",
    "end": "705880"
  },
  {
    "text": "great I recommend you check it out but from a high level it ran into the problem of even though we fixed the",
    "start": "705880",
    "end": "711440"
  },
  {
    "text": "latest version of the code what we didn't do was revoke in time so the dbx",
    "start": "711440",
    "end": "717480"
  },
  {
    "text": "variable didn't have every boot manager because simply put there's too many boot managers with this uh shared code in",
    "start": "717480",
    "end": "724839"
  },
  {
    "text": "it unfortunately this means that an attacker can bring an old vulnerable bootloader and swap out the existing one",
    "start": "724839",
    "end": "731000"
  },
  {
    "text": "in order to compromise your machine now to be clear this still requires administrative privileges an",
    "start": "731000",
    "end": "737399"
  },
  {
    "text": "attacker would need to have physical access to your device or they would need to have admin code execution which is",
    "start": "737399",
    "end": "742839"
  },
  {
    "text": "what Black Lotus was using but it still presents a risk because it compromises the Integrity of your boot environment",
    "start": "742839",
    "end": "751040"
  },
  {
    "text": "so to recap fixing vulnerabilities isn't just enough we need to revoke those",
    "start": "751040",
    "end": "756160"
  },
  {
    "text": "vulnerable images too and one bug can equal thousands of executables we released an opt in",
    "start": "756160",
    "end": "762440"
  },
  {
    "text": "mitigation for Black Lotus to help reduce some of that into wild abuse it isn't perfect but we're still working on",
    "start": "762440",
    "end": "768120"
  },
  {
    "text": "a default secure re revocation story so the challenge here is not only that it's going to introduce compatibility issues",
    "start": "768120",
    "end": "774800"
  },
  {
    "text": "with everyone that has an old windows image on let's say USB stick but it's also about that space issue we don't",
    "start": "774800",
    "end": "781199"
  },
  {
    "text": "have enough space to enforce revocations for every bootloader that has been signed up to",
    "start": "781199",
    "end": "786760"
  },
  {
    "text": "2022 if you're interested in learning more you can check out the link about this cve",
    "start": "786760",
    "end": "792480"
  },
  {
    "text": "online now going to the uvca let's talk about the Linux shim the Linux shim is a",
    "start": "793680",
    "end": "799360"
  },
  {
    "text": "first stage Bootloader for effectively every distribution that supports secur Boot and it's designed to effectively",
    "start": "799360",
    "end": "806760"
  },
  {
    "text": "manually load secondary drivers like rub uh by verifying them and mapping them",
    "start": "806760",
    "end": "811959"
  },
  {
    "text": "into memory and the way it works is that the shim actually contains the Linux",
    "start": "811959",
    "end": "817800"
  },
  {
    "text": "distribution certificate so the Linux distribution signs their own images and then they include the certificate in the",
    "start": "817800",
    "end": "823560"
  },
  {
    "text": "shim which is signed by the upca and this allows them to sign their own images into future and load it using the",
    "start": "823560",
    "end": "831519"
  },
  {
    "text": "shim now um msrc was actually able to find a critical vulnerability in this code uh that has been public for nearly",
    "start": "831920",
    "end": "839560"
  },
  {
    "text": "a decade it allows attackers to execute remote a code from a remote scenario a",
    "start": "839560",
    "end": "845040"
  },
  {
    "text": "local scenario a physical scenario now it was fixed in January 2024 you can see",
    "start": "845040",
    "end": "850279"
  },
  {
    "text": "the cve issued on the right and the code was out but unfortunately the revocation",
    "start": "850279",
    "end": "855680"
  },
  {
    "text": "date is still unclear in a lot of cases remember just because we fixed it in the latest version of the code that doesn't",
    "start": "855680",
    "end": "862199"
  },
  {
    "text": "mean we're safe now Linux doesn't even need dbx",
    "start": "862199",
    "end": "867360"
  },
  {
    "text": "they have a custom revocation scheme known as secure boot Advanced targeting this allows them to Target revocations",
    "start": "867360",
    "end": "873079"
  },
  {
    "text": "by version instead of using a hasher certificate in dbx but unfortunately esbat as it's",
    "start": "873079",
    "end": "879759"
  },
  {
    "text": "called is an unauthenticated variable which can allow tampering and even with esbat they're not able to revoke why",
    "start": "879759",
    "end": "887160"
  },
  {
    "text": "because there's just too many users with the old shims so to recap this challenge the",
    "start": "887160",
    "end": "893560"
  },
  {
    "text": "revocation challenge is an ecosystem problem for some it's about not having enough space",
    "start": "893560",
    "end": "899600"
  },
  {
    "text": "to issue those revocations but for others it's about breaking legitimate use",
    "start": "899600",
    "end": "905759"
  },
  {
    "text": "cases youy exposes an enormous attack surface and then expects developers to shoot themselves into leg to fix it and",
    "start": "905759",
    "end": "913160"
  },
  {
    "text": "this is why it's so hard for Defenders to be able to respond to these types of vulnerabilities is because again that's",
    "start": "913160",
    "end": "918800"
  },
  {
    "text": "space challenge that we're not working with a great system and number two in reality the revocation story becomes a",
    "start": "918800",
    "end": "924680"
  },
  {
    "text": "lot more complicated due to that compatibility risk now number two problem I want to talk",
    "start": "924680",
    "end": "931319"
  },
  {
    "text": "about is the substantial attack surface so the attack vectors from the threat model we reviewed introduce enormous",
    "start": "931319",
    "end": "938920"
  },
  {
    "text": "risk in yui almost anything configurable is an attack surface every future in",
    "start": "938920",
    "end": "945759"
  },
  {
    "text": "every boot image is more surface for attackers to take advantage of you know for the ufca we have over",
    "start": "945759",
    "end": "953000"
  },
  {
    "text": "16,000 signed but un audited boot images and now sometimes these use cases are",
    "start": "953000",
    "end": "958040"
  },
  {
    "text": "Justified for example Linux is a critical part of our ecosystem they're never going away option ROMs are often",
    "start": "958040",
    "end": "965920"
  },
  {
    "text": "necessary for Modern Hardware for example your graphics card comes with what's called an option ROM in order to",
    "start": "965920",
    "end": "971319"
  },
  {
    "text": "support your display but sometimes we've seen less Justified use cases for the ufca like debug related image debugging",
    "start": "971319",
    "end": "979360"
  },
  {
    "text": "related images including U shells that expose dangerous Behavior by Design and",
    "start": "979360",
    "end": "985279"
  },
  {
    "text": "also to be honest there's a lot of random utility that no one really uses",
    "start": "985279",
    "end": "991079"
  },
  {
    "text": "and it's not that we shouldn't sign these in the first place but it's just that should we really expose these surfaces by default you know we should",
    "start": "991079",
    "end": "998319"
  },
  {
    "text": "be able to support these competitive use cases but that by default exposure is what really concerns",
    "start": "998319",
    "end": "1004800"
  },
  {
    "text": "me now for the windows CA even though it's only first-party code you know Windows is one of the largest operating",
    "start": "1004800",
    "end": "1011199"
  },
  {
    "text": "systems inherently it has a lot of different feutures for extensibility and again you start to wonder how many of",
    "start": "1011199",
    "end": "1017639"
  },
  {
    "text": "these fatures will customers need by default so the big question that I would",
    "start": "1017639",
    "end": "1024240"
  },
  {
    "text": "like to really reinforce with this problem is that a vast majority of attack surfaces won't be relevant for a",
    "start": "1024240",
    "end": "1029839"
  },
  {
    "text": "vast majority of customers you know does every single Windows computer in the world need to be able to run joo's dis",
    "start": "1029839",
    "end": "1035600"
  },
  {
    "text": "recovery utility by default do all Linux users who just want to use Linux really",
    "start": "1035600",
    "end": "1040720"
  },
  {
    "text": "need to be exposed to Microsoft's attack Surface by default so to go through some examples",
    "start": "1040720",
    "end": "1047038"
  },
  {
    "text": "of this I want to start with Windows boot code now I'm going to go through a few highle examples of what",
    "start": "1047039",
    "end": "1052320"
  },
  {
    "text": "vulnerabilities we've seen into boot manager look like but I'm not going to spoil the findings of other researchers for you you know without our community",
    "start": "1052320",
    "end": "1059120"
  },
  {
    "text": "we wouldn't be here it's really important to have that accountability and we greatly appreciate the support in",
    "start": "1059120",
    "end": "1064679"
  },
  {
    "text": "helping secure our boot environment code so one really big pain point for us",
    "start": "1064679",
    "end": "1070640"
  },
  {
    "text": "has been the boot configuration data known as BCD so these this BCD file has",
    "start": "1070640",
    "end": "1076280"
  },
  {
    "text": "everything from whether you should start in safe mode mode um are we going to start recovery where is the OS loader",
    "start": "1076280",
    "end": "1082840"
  },
  {
    "text": "located what about the OS Kel now these BCD options we have over a",
    "start": "1082840",
    "end": "1088840"
  },
  {
    "text": "hundred of them that's a lot of different attack surfaces so we've actually seen about 50",
    "start": "1088840",
    "end": "1095799"
  },
  {
    "text": "or more msrc cases in just BCD parsing alone and that's a lot of aack surface",
    "start": "1095799",
    "end": "1103240"
  },
  {
    "text": "so I want to show you what some of these issues look like so a common pth pattern that I've",
    "start": "1103240",
    "end": "1109280"
  },
  {
    "text": "seen is that developers can easily forget everything that is configurable is untrustworthy on the right I have a",
    "start": "1109280",
    "end": "1116120"
  },
  {
    "text": "function that's um a copy a mimic of a real vulnerability that was discovered and from a high level what it does is",
    "start": "1116120",
    "end": "1122360"
  },
  {
    "text": "it'll First grab a device from your BCD file and it'll Store It On The Stack now",
    "start": "1122360",
    "end": "1129159"
  },
  {
    "text": "this device actually has a custom structure and this custom structure is contains information about specific to",
    "start": "1129159",
    "end": "1135320"
  },
  {
    "text": "that device you have to remember everything here is untrusted and finally here's where the bug comes",
    "start": "1135320",
    "end": "1140720"
  },
  {
    "text": "into play it it'll allocate space for a copy but it assumes a certain set size and",
    "start": "1140720",
    "end": "1148480"
  },
  {
    "text": "when that allocation is done it'll copy over the custom device information into",
    "start": "1148480",
    "end": "1154280"
  },
  {
    "text": "this new device information that was just allocated without verifying that the size specified by the attacker is",
    "start": "1154280",
    "end": "1161280"
  },
  {
    "text": "actually legitimate and within the bounds of what's expected this leads to an out of- bounds right condition",
    "start": "1161280",
    "end": "1169360"
  },
  {
    "text": "and another major threat for boot code is extensibility so for example did you",
    "start": "1170600",
    "end": "1175640"
  },
  {
    "text": "know that the windows bootloader by default can expose over 10 different file systems no it's a fuz fuzzer",
    "start": "1175640",
    "end": "1182640"
  },
  {
    "text": "paradise to be honest with you this includes everything from NTFS which makes sense a lot of people use NTFS by",
    "start": "1182640",
    "end": "1188520"
  },
  {
    "text": "default but there's also just these random Edge case support that really makes you wonder will a lot of customers",
    "start": "1188520",
    "end": "1195640"
  },
  {
    "text": "need this by default will do they should they really be exposed to these surfaces by",
    "start": "1195640",
    "end": "1202039"
  },
  {
    "text": "default with theca msrc actually reviewed a a large set of these images",
    "start": "1202039",
    "end": "1208280"
  },
  {
    "text": "um manually and we found a lot of trivial problems we're going to go through Qui a few examples really",
    "start": "1208280",
    "end": "1213919"
  },
  {
    "text": "quickly but if you're interested in learning more about the third party story I definitely recommend you check out dissecting the third party uh secure",
    "start": "1213919",
    "end": "1220000"
  },
  {
    "text": "boot third party attack surface which I presented at offensive con a few months ago so one one example that I covered",
    "start": "1220000",
    "end": "1226159"
  },
  {
    "text": "there includes the fact that there's a lot of unrevoked images that are variant",
    "start": "1226159",
    "end": "1231280"
  },
  {
    "text": "of previously revoked images which attackers can abuse so one trivial path was let me just search for similar",
    "start": "1231280",
    "end": "1237640"
  },
  {
    "text": "images to ones that have been revoked and find those images which are maybe a slightly older version of what was",
    "start": "1237640",
    "end": "1244240"
  },
  {
    "text": "revoked that still have the same vulnerable shared code remember when you revoke an image you not only need to",
    "start": "1244240",
    "end": "1250760"
  },
  {
    "text": "revoke the latest version where that vulnerability was found but you also need to revoke every image that had that",
    "start": "1250760",
    "end": "1256640"
  },
  {
    "text": "code in previous versions another challenge is for example even",
    "start": "1256640",
    "end": "1262240"
  },
  {
    "text": "the Linux shim it's designed to load arbitrary boot code signed by individual Linux",
    "start": "1262240",
    "end": "1267360"
  },
  {
    "text": "distributions you know we don't have a direct audit log or visibility but msrc was able to recover some of these images",
    "start": "1267360",
    "end": "1273600"
  },
  {
    "text": "using virus total and their signature filtering mechanisms for example Fedora actually",
    "start": "1273600",
    "end": "1279159"
  },
  {
    "text": "used the same certificate their cell sign certificate from 2012 to late",
    "start": "1279159",
    "end": "1284240"
  },
  {
    "text": "2013 and this allowed attackers to abuse vulnerabilities from 2015 to 2020",
    "start": "1284240",
    "end": "1289480"
  },
  {
    "text": "because they didn't roll their certificate and remember our shim",
    "start": "1289480",
    "end": "1296600"
  },
  {
    "text": "vulnerability that we briefly discussed in the last problem well I want to go through that example because it it",
    "start": "1296600",
    "end": "1301720"
  },
  {
    "text": "highlights the extensibility issue on the right I have an HTTP response Handler that'll first parse a Content",
    "start": "1301720",
    "end": "1308640"
  },
  {
    "text": "length header from the server and then it'll use this buffer size from the server to allocate a pool and finally",
    "start": "1308640",
    "end": "1315799"
  },
  {
    "text": "it'll copy over the number of bytes sent a server over to this buffer and this is",
    "start": "1315799",
    "end": "1321440"
  },
  {
    "text": "where the problem arises because the content length is untrusted and it's from an untrusted server there's nothing",
    "start": "1321440",
    "end": "1327279"
  },
  {
    "text": "stopping the server from lying to you and saying oh the content length is only one bite but in reality I'm going to",
    "start": "1327279",
    "end": "1332880"
  },
  {
    "text": "send you a thousand bytes this again goes back to the idea of extensibility extensibility can add a tax surface and",
    "start": "1332880",
    "end": "1339880"
  },
  {
    "text": "increase customer risk so to recap it's really hard to write secure code for UI where",
    "start": "1339880",
    "end": "1346679"
  },
  {
    "text": "everything is in a tax service the status quo includes an enormous amount of by default attack surface that users",
    "start": "1346679",
    "end": "1352679"
  },
  {
    "text": "will probably never need and balancing customer Choice with security is not",
    "start": "1352679",
    "end": "1360639"
  },
  {
    "text": "trivial the third problem is going to be an in an inconsistent industry",
    "start": "1361159",
    "end": "1366480"
  },
  {
    "text": "response so users are only as secure as the weakest link How Can Microsoft",
    "start": "1366480",
    "end": "1371799"
  },
  {
    "text": "maintain a strong security story given partner introduced risk you know we've seen an inconsistent commitment to",
    "start": "1371799",
    "end": "1377760"
  },
  {
    "text": "customer security in the ecosystem unfortunately like some Partners like the Linux Community take security",
    "start": "1377760",
    "end": "1383799"
  },
  {
    "text": "extremely seriously but others not so much you know I talked about this in my",
    "start": "1383799",
    "end": "1389480"
  },
  {
    "text": "last talk but for example the firmware story um there is a lot of risk that can be introduced by the shared code and",
    "start": "1389480",
    "end": "1396000"
  },
  {
    "text": "decentralized nature of firmware you know let's say you have a vulnerability in your component supplier that can",
    "start": "1396000",
    "end": "1401440"
  },
  {
    "text": "easily become a vulnerability in variance of that image too and this leads to a lot of known vulnerabilities",
    "start": "1401440",
    "end": "1407240"
  },
  {
    "text": "that can be abused against your organization simply because your vendor hasn't taken the necessary",
    "start": "1407240",
    "end": "1413600"
  },
  {
    "text": "Updates this was research done by binar and what we can see here is that in",
    "start": "1413600",
    "end": "1419279"
  },
  {
    "text": "order to abuse this problem attackers can first dump your firmware find out what you're running they'll find a",
    "start": "1419279",
    "end": "1426039"
  },
  {
    "text": "version and look for that repository online you know Common one is edk2 which",
    "start": "1426039",
    "end": "1431400"
  },
  {
    "text": "is the firmer um uh firmer source code repository pretty commonly ingested by",
    "start": "1431400",
    "end": "1437559"
  },
  {
    "text": "different oems and they'll just enumerate known vulnerabilities in edk2 in order to find",
    "start": "1437559",
    "end": "1443799"
  },
  {
    "text": "new issues they can abuse against your machine even though these issues have been patched Upstream that doesn't mean",
    "start": "1443799",
    "end": "1449080"
  },
  {
    "text": "they've been ingested by your Downstream vendor if you're interested in reading more I'd recommend you check out biner Le's blog post on",
    "start": "1449080",
    "end": "1456919"
  },
  {
    "text": "this and unfortunately there are dozens of fixed boot vulnerabilities abusable",
    "start": "1457080",
    "end": "1463159"
  },
  {
    "text": "by a rollback attack that's what we were talking about with black lotus so why havn't we revoke those old versions",
    "start": "1463159",
    "end": "1470520"
  },
  {
    "text": "unfortunately revoking means blocking every first party image we've ever signed good news we've actually been",
    "start": "1470520",
    "end": "1477600"
  },
  {
    "text": "planning to revoke and roll the window CA um in 20 2025 and 2026 period and why",
    "start": "1477600",
    "end": "1484760"
  },
  {
    "text": "haven't we expedited this process I have an exerpt below from a blog post about",
    "start": "1484760",
    "end": "1489840"
  },
  {
    "text": "this role process and it discusses some of the challenges at a high level and what I really want to call out about",
    "start": "1489840",
    "end": "1496080"
  },
  {
    "text": "this paragraph is that last sentence Microsoft will slowly roll out this DV update as we validate devices and firm",
    "start": "1496080",
    "end": "1503360"
  },
  {
    "text": "our compatibility the reason we can't just do this tomorrow you know it's it's going to help revoke a lot of these old",
    "start": "1503360",
    "end": "1509880"
  },
  {
    "text": "images Why Don't We Rule the windows CA tomorrow well it turns out with that",
    "start": "1509880",
    "end": "1515240"
  },
  {
    "text": "last sentence there's a lot of issues that can be introduced from Partners so",
    "start": "1515240",
    "end": "1520279"
  },
  {
    "text": "what we found was that um with these new additions for Rolling the ca uh Securo",
    "start": "1520279",
    "end": "1526480"
  },
  {
    "text": "can actually Breck entirely so can you imagine a security fix",
    "start": "1526480",
    "end": "1531840"
  },
  {
    "text": "breaking your machine especially for a secure boot this is why it's so care we have to be so careful with these changes",
    "start": "1531840",
    "end": "1538600"
  },
  {
    "text": "to make sure that we're prioritizing customer security but while we bring customer liability along with us and to",
    "start": "1538600",
    "end": "1546520"
  },
  {
    "text": "be clear this is a industrywide challenge you know um one thing for",
    "start": "1546520",
    "end": "1551960"
  },
  {
    "text": "example Microsoft needs to do better here is going to be allowing Partners to have access to better testing tools to",
    "start": "1551960",
    "end": "1557679"
  },
  {
    "text": "catch these YP of issues earlier rather than",
    "start": "1557679",
    "end": "1562200"
  },
  {
    "text": "later and going back to the OEM risk it's I want to talk to you about the platform key which controls the key",
    "start": "1563360",
    "end": "1569600"
  },
  {
    "text": "exchange key and controls the allowed signatures allowed to load in Secure boot many oems choose to manage their",
    "start": "1569600",
    "end": "1576159"
  },
  {
    "text": "own keys but unfortunately they're not always maintained so on the WR I talked",
    "start": "1576159",
    "end": "1582120"
  },
  {
    "text": "about this more in my last talk but for example there are a lot of oems that included an old version of a canonical C",
    "start": "1582120",
    "end": "1588279"
  },
  {
    "text": "certificate and this version has been used to sign really old code with several known",
    "start": "1588279",
    "end": "1593640"
  },
  {
    "text": "vulnerabilities and this this certificate is still included in some oem's firmer by default",
    "start": "1593640",
    "end": "1600720"
  },
  {
    "text": "today another funny one that I saw really recently a few weeks ago includes um some research from binary where they",
    "start": "1600720",
    "end": "1607559"
  },
  {
    "text": "found that a lot of oems have a PK or platform key named do not trust Ami test",
    "start": "1607559",
    "end": "1614039"
  },
  {
    "text": "PK this Ami test key was stored in a private key file included with UI test",
    "start": "1614039",
    "end": "1620080"
  },
  {
    "text": "packages and with PK remember you can bypass a cure boot by updating the key",
    "start": "1620080",
    "end": "1626440"
  },
  {
    "text": "exchange key or to the loud signatures list known as DB if you're interested in reading more",
    "start": "1626440",
    "end": "1631760"
  },
  {
    "text": "about this one it's a really interesting one I'd recommend you check out their article named PK fail on trusted platform Keys undermine secure",
    "start": "1631760",
    "end": "1640960"
  },
  {
    "text": "boot so to recap Microsoft needs to work with partners and will work with Partners to challenge the status quo of",
    "start": "1640960",
    "end": "1647399"
  },
  {
    "text": "yui you know we all have problems here you know Microsoft has several things that we need to address like black lotus",
    "start": "1647399",
    "end": "1654279"
  },
  {
    "text": "but we also need to make sure we're looking at the full picture yui is not going to be something we can solve alone at all we're going to",
    "start": "1654279",
    "end": "1661159"
  },
  {
    "text": "need to bring Partners along with us and we're going to need to work on this together now I will say the",
    "start": "1661159",
    "end": "1666840"
  },
  {
    "text": "decentralized nature of the ecosystem presents a severe threat to customer security you know especially with that",
    "start": "1666840",
    "end": "1672559"
  },
  {
    "text": "firmware problem it becomes really tricky because when there's known vulnerabilities we need to make sure",
    "start": "1672559",
    "end": "1677840"
  },
  {
    "text": "that there promptly addressed across the board we don't want to leave customers",
    "start": "1677840",
    "end": "1683159"
  },
  {
    "text": "vulnerable and just to really reiterate one of our big points it's it's about",
    "start": "1683159",
    "end": "1688200"
  },
  {
    "text": "balancing customer Choice with security it's a really interesting and difficult challenge because we want to allow",
    "start": "1688200",
    "end": "1693640"
  },
  {
    "text": "choice we want to allow our oems to bring their own Security Solutions for example we want to allow the ufca we",
    "start": "1693640",
    "end": "1701039"
  },
  {
    "text": "want to allow those thirdparty use cases like even joo's dis recovery utility but",
    "start": "1701039",
    "end": "1706200"
  },
  {
    "text": "at the end of the day users are only going to be secure as the weakest link so let's talk about how we're going",
    "start": "1706200",
    "end": "1712559"
  },
  {
    "text": "to fix it anyways so while a decentralized n ecosystem is great for customer Choice",
    "start": "1712559",
    "end": "1719720"
  },
  {
    "text": "it's not so great for customer security I think that the industry response time inside of yui can highlight this",
    "start": "1719720",
    "end": "1727240"
  },
  {
    "text": "inefficiency you know yui might be a unified interface but we need unified",
    "start": "1727240",
    "end": "1733159"
  },
  {
    "text": "execution so from a high level if you're an oem or a partner of us I'd recommend that you look at you're using Windows",
    "start": "1733159",
    "end": "1739039"
  },
  {
    "text": "updates for deploying your UI fare updates a lot of them are already doing it but if you're not already doing it",
    "start": "1739039",
    "end": "1745080"
  },
  {
    "text": "I'd recommend it because honestly no one's going to go to your website maybe five people will but not many at all to",
    "start": "1745080",
    "end": "1752360"
  },
  {
    "text": "take a firmer update in the first place if you want to keep your customer secure and I know you do we need to do it",
    "start": "1752360",
    "end": "1757760"
  },
  {
    "text": "together I think that we need to collaborate more on secure implementations and try to get away from",
    "start": "1757760",
    "end": "1763760"
  },
  {
    "text": "the forking problem so stop creating Forks of these shared code bases especially the larger ones with a lot of",
    "start": "1763760",
    "end": "1769760"
  },
  {
    "text": "attack surfaces because what will happen is is that it's really hard to manage",
    "start": "1769760",
    "end": "1774960"
  },
  {
    "text": "security in when you have so much code when there's so much shared code bases and when there's so much attack surface",
    "start": "1774960",
    "end": "1782480"
  },
  {
    "text": "you know it's not just about forking being a problem because it's introduced security risk but it's also because it's",
    "start": "1782480",
    "end": "1788840"
  },
  {
    "text": "a lot more work for our partners to be able to manage it effectively it's just more liability and if we can combine",
    "start": "1788840",
    "end": "1793919"
  },
  {
    "text": "some of these implementations together we can help improve the customer security story while reducing the cost for this maintenance I think we need to",
    "start": "1793919",
    "end": "1801080"
  },
  {
    "text": "invest more in firmer transparency and auditability you know there's a lot of the problems we've seen is from a lack",
    "start": "1801080",
    "end": "1807840"
  },
  {
    "text": "of transparency in into the firmware how do I know if my firmware has the latest update for edk2 for",
    "start": "1807840",
    "end": "1815760"
  },
  {
    "text": "example so talking about a bit future facing things here number one how do we",
    "start": "1815760",
    "end": "1821519"
  },
  {
    "text": "Empower Partners to Value customer security the way we do well I think that",
    "start": "1821519",
    "end": "1826600"
  },
  {
    "text": "first of all we need to prioritize customer Security First Security above all but we need to make sure to bring",
    "start": "1826600",
    "end": "1833080"
  },
  {
    "text": "our partners along with us so Partners who are prepared for our rollouts will be added on an ongoing basis and",
    "start": "1833080",
    "end": "1840159"
  },
  {
    "text": "customers will receive protection as soon as feasible rather than waiting for complete",
    "start": "1840159",
    "end": "1845600"
  },
  {
    "text": "participation the intent here is to make sure that we're securing customers where we can when we can and making the",
    "start": "1845600",
    "end": "1852320"
  },
  {
    "text": "security story better as we go along",
    "start": "1852320",
    "end": "1857158"
  },
  {
    "text": "I also want to tell you about secured core which is a way you can reduce your attack surface it's a special line of",
    "start": "1858440",
    "end": "1863840"
  },
  {
    "text": "Windows computers that have strength and defaults now on laptops with secured core it's the ufca for example is not",
    "start": "1863840",
    "end": "1871279"
  },
  {
    "text": "included by default you have to enable it in your firware options in order to have that opt option available you can",
    "start": "1871279",
    "end": "1878559"
  },
  {
    "text": "see that down below where we state that the third party UVC is not trusted by default with bios en with a bios option",
    "start": "1878559",
    "end": "1885320"
  },
  {
    "text": "enabling for enabling that trust and the the really interesting part about this is again it's not that the ufca is bad",
    "start": "1885320",
    "end": "1891720"
  },
  {
    "text": "at all we need that customer choice but the ufca is an interesting attack",
    "start": "1891720",
    "end": "1896960"
  },
  {
    "text": "surface that attackers can take advantage of and the real question is should we have that exposed by default",
    "start": "1896960",
    "end": "1902080"
  },
  {
    "text": "secur core is one way you can make sure that it isn't now I will say for a",
    "start": "1902080",
    "end": "1907320"
  },
  {
    "text": "secured core if your machine requires option ROMs there are some exceptions to this requirement but it still offers at",
    "start": "1907320",
    "end": "1913600"
  },
  {
    "text": "least a choice to help reduce that attack surface on your Enterprise devices",
    "start": "1913600",
    "end": "1919320"
  },
  {
    "text": "so what are we going to do about dbx that was another really interesting problem well I want to tell you about a",
    "start": "1919320",
    "end": "1926399"
  },
  {
    "text": "really interesting implemented proposal which is re revocation through secure version information so this was an msrc",
    "start": "1926399",
    "end": "1934039"
  },
  {
    "text": "designed to extend dbx and allow revocations by version so for example",
    "start": "1934039",
    "end": "1939120"
  },
  {
    "text": "Linux has secure boot Advanced targeting but securit Advance targeting takes advantage of an unauthenticated U",
    "start": "1939120",
    "end": "1945519"
  },
  {
    "text": "variable and the reason that's a problem is is because if an attacker can get code execution at boot they can just",
    "start": "1945519",
    "end": "1951760"
  },
  {
    "text": "delete your variable with your revocations and you you still remain unprotected whereas with dbx the really",
    "start": "1951760",
    "end": "1958679"
  },
  {
    "text": "cool part about it is that it's an authenticated variable so this means that if an attacker got code execution",
    "start": "1958679",
    "end": "1964639"
  },
  {
    "text": "at boot that wouldn't allow them to tamper with dbx so what Microsoft found was that we",
    "start": "1964639",
    "end": "1970440"
  },
  {
    "text": "can actually use dbx in order to store these version revocations how it works is that we have 32 bytes of space with",
    "start": "1970440",
    "end": "1977840"
  },
  {
    "text": "the Sha 256 hash and what we came up with was including version data inside",
    "start": "1977840",
    "end": "1983799"
  },
  {
    "text": "of a fake hash that we would then add to dbx this way our code would be able to",
    "start": "1983799",
    "end": "1989320"
  },
  {
    "text": "recognize this pattern and dve version information from an entry in dbx you",
    "start": "1989320",
    "end": "1995679"
  },
  {
    "text": "know we'll still run into the space limitation that dbx has but now with a single hash we can actually revoke",
    "start": "1995679",
    "end": "2001799"
  },
  {
    "text": "thousands of images by version so the way this works is that the signature owner field in the signature list header",
    "start": "2001799",
    "end": "2008600"
  },
  {
    "text": "will include a specific guid that our code recognizes and the signature data is the fake hash with version data in it",
    "start": "2008600",
    "end": "2017039"
  },
  {
    "text": "the cool part about this is that for anyone else who parses dbx this is just going to look like another random hash",
    "start": "2017039",
    "end": "2022519"
  },
  {
    "text": "but for our code we'll be able to recognize it as hey this actually contains version",
    "start": "2022519",
    "end": "2028200"
  },
  {
    "text": "data this implementation was actually released in April if you have your April",
    "start": "2028200",
    "end": "2033519"
  },
  {
    "text": "security update you will have this code on your machine today now we will still need to revoke",
    "start": "2033519",
    "end": "2038919"
  },
  {
    "text": "the old windows CA in order to really take advantage of this mechanism but I want to demonstrate Microsoft's",
    "start": "2038919",
    "end": "2044840"
  },
  {
    "text": "commitment to customer security here it's something that we're contining improving on and it's something that we're interested in helping Partners",
    "start": "2044840",
    "end": "2051079"
  },
  {
    "text": "achieve as well another implementation includes support for Linux revocations remember",
    "start": "2051079",
    "end": "2057878"
  },
  {
    "text": "the Linux gim and lack of revocations so a patch Tuesday in the next few months will actually include revocations for",
    "start": "2057879",
    "end": "2064599"
  },
  {
    "text": "these the Linux vulnerability we talked about now this the revocations are esbat so secure boot Advanced targeting and",
    "start": "2064599",
    "end": "2071358"
  },
  {
    "text": "that were provided by the Linux community in their shim repository and to be clear we also still care about the",
    "start": "2071359",
    "end": "2077878"
  },
  {
    "text": "compatibility story if you're dual building Linux these revocations won't apply to you I would recommend that you",
    "start": "2077879",
    "end": "2083480"
  },
  {
    "text": "check out your device in a few months to see this take effect",
    "start": "2083480",
    "end": "2089720"
  },
  {
    "text": "and one thing I really want to emphasize again is that Microsoft is not going to do this alone so first we're going to",
    "start": "2089720",
    "end": "2096358"
  },
  {
    "text": "partner with the research community to hold us accountable and identify problematic attack surfaces before we",
    "start": "2096359",
    "end": "2101560"
  },
  {
    "text": "have years of investment in them we want to partner with oems to share to write tools to help balance a secure outcome",
    "start": "2101560",
    "end": "2109400"
  },
  {
    "text": "and compatibility so this means for example that issue I talked about when we were trying to roll the ca one of our",
    "start": "2109400",
    "end": "2116160"
  },
  {
    "text": "uh Partners machines were bricked well Microsoft will make sure to offer better",
    "start": "2116160",
    "end": "2121200"
  },
  {
    "text": "testing tools to try to detect those types of issues before it's too late we",
    "start": "2121200",
    "end": "2127040"
  },
  {
    "text": "also want to partner with other organizations like siza to help push the industry in the right direction and",
    "start": "2127040",
    "end": "2132760"
  },
  {
    "text": "finally we want to continue partnering with our Linux Community to maximize Choice without forgetting",
    "start": "2132760",
    "end": "2141079"
  },
  {
    "text": "security and one area we didn't cover in this talk was measured boot which uses the trusted platform modules to protect",
    "start": "2142160",
    "end": "2149119"
  },
  {
    "text": "important Secrets behind trusted measurements and bit Locker is a good example of this if you use bit Locker on",
    "start": "2149119",
    "end": "2155520"
  },
  {
    "text": "your machine and you have a TPM available it'll actually use these measurements to protect your dis keys",
    "start": "2155520",
    "end": "2161839"
  },
  {
    "text": "but unfortunately bit Locker is not used by the majority and it's only really going to be effective against physical",
    "start": "2161839",
    "end": "2168000"
  },
  {
    "text": "attacks today for example Black Lotus one of the things it does is if it detects bit Locker on your machine it'll",
    "start": "2168000",
    "end": "2173680"
  },
  {
    "text": "suspend protection and the reason it's able to do that is because bit Locker was designed to originally address",
    "start": "2173680",
    "end": "2180000"
  },
  {
    "text": "physical attacks if you already have access to the unlocked dis you know bit Locker is about protecting your data you",
    "start": "2180000",
    "end": "2186599"
  },
  {
    "text": "know if you already have admin code execution what data is there left to Pro protect but we still have longer term",
    "start": "2186599",
    "end": "2192839"
  },
  {
    "text": "investments like Dynamic root of trust for measurement that are really promising and for the future so today if",
    "start": "2192839",
    "end": "2199160"
  },
  {
    "text": "you use drtm on some of our newer devices for example Black Lotus won't work by default now there are still",
    "start": "2199160",
    "end": "2205839"
  },
  {
    "text": "changes we need to make for drtm to make it reliable in the long term for example even if drtm um is able to detect",
    "start": "2205839",
    "end": "2213160"
  },
  {
    "text": "tampering we need to make sure that we put enough stuff behind drtm so that an attacker actually needs to pass drtm",
    "start": "2213160",
    "end": "2220480"
  },
  {
    "text": "detection system so if for example if drtm fails at testation that doesn't prevent your machine from unlocking bit",
    "start": "2220480",
    "end": "2227599"
  },
  {
    "text": "locker keys because that bit Locker hasn't been added behind drtm just",
    "start": "2227599",
    "end": "2232839"
  },
  {
    "text": "yet but again this is something really promising that I look forward to in the next 5 years as a way to really mitigate",
    "start": "2232839",
    "end": "2239480"
  },
  {
    "text": "these secure boot security story problems so what can you do to protect your organization number one if you want",
    "start": "2239480",
    "end": "2245880"
  },
  {
    "text": "to help protect against physical attacks you can use bit Locker this again uses measurements to make sure that when your",
    "start": "2245880",
    "end": "2252920"
  },
  {
    "text": "machine starts up you're booting into a trusted environment now if you want maximum",
    "start": "2252920",
    "end": "2258359"
  },
  {
    "text": "security I definitely recommend that you use TPM and pin for really making sure that even if there was a vulnerability",
    "start": "2258359",
    "end": "2264920"
  },
  {
    "text": "in a bit Locker image your data is going to remain safe because they don't have your password you know we can use",
    "start": "2264920",
    "end": "2270599"
  },
  {
    "text": "secured core PCS to reduce third party attack surfaces another one now again option ROMs are going to be a problem",
    "start": "2270599",
    "end": "2277720"
  },
  {
    "text": "and secured core will only really reduce your third party attack surface if your machine is a laptop and doesn't have",
    "start": "2277720",
    "end": "2283760"
  },
  {
    "text": "that option wrom exception I definitely recommend that you apply the often protections from Microsoft if these boot",
    "start": "2283760",
    "end": "2290400"
  },
  {
    "text": "attacks are on your threat model and if you're really interested in getting the maximum security you have money to throw",
    "start": "2290400",
    "end": "2295760"
  },
  {
    "text": "away and you want the best of the best you can opt into managing your own certificates this means that instead of",
    "start": "2295760",
    "end": "2301720"
  },
  {
    "text": "relying on Microsoft to manage your DB and dbx variables you can just have a very small set of hashes that are",
    "start": "2301720",
    "end": "2307560"
  },
  {
    "text": "allowed to load the NSA actually has a great guide on customizing this secure boot environment um but it should be",
    "start": "2307560",
    "end": "2313319"
  },
  {
    "text": "noted that this is going to be a lot of lot more costly than some people might expect so just to conclude this",
    "start": "2313319",
    "end": "2319920"
  },
  {
    "text": "presentation um the really big message that I want to emphasize to everyone you if you have one takeaway is that I think",
    "start": "2319920",
    "end": "2325680"
  },
  {
    "text": "that we as an industry we can often get fall into the Trap of focusing on short-term fixes but really what we need",
    "start": "2325680",
    "end": "2333280"
  },
  {
    "text": "is to rethink secure boot you know secure boot needs an overhaul to remain defensible we're doing our best with",
    "start": "2333280",
    "end": "2339960"
  },
  {
    "text": "what we have you know our partners are doing their best with what they have the limited resources and what we're really",
    "start": "2339960",
    "end": "2345920"
  },
  {
    "text": "looking at is a system that ties our hands behind our back and above all else",
    "start": "2345920",
    "end": "2351280"
  },
  {
    "text": "we need to do this together thank you so much for coming out to this talk I'm really excited to",
    "start": "2351280",
    "end": "2357720"
  },
  {
    "text": "be here again for another year and thank you to all the engineering teams and partners who are helping improve the",
    "start": "2357720",
    "end": "2362960"
  },
  {
    "text": "customer security story [Applause]",
    "start": "2362960",
    "end": "2368909"
  }
]