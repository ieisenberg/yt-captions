[
  {
    "start": "0",
    "end": "26000"
  },
  {
    "text": "we are going to start a talk from Al and",
    "start": "0",
    "end": "2399"
  },
  {
    "text": "Arnie one Packer to rule them all",
    "start": "2399",
    "end": "4350"
  },
  {
    "text": "empirical identification comparison",
    "start": "4350",
    "end": "6779"
  },
  {
    "text": "comparison and circumvention of current",
    "start": "6779",
    "end": "9030"
  },
  {
    "text": "antivirus detection techniques hi good",
    "start": "9030",
    "end": "14639"
  },
  {
    "text": "morning I'm arena next to me Saladin and",
    "start": "14639",
    "end": "16740"
  },
  {
    "text": "today we're just going to talk to about",
    "start": "16740",
    "end": "19230"
  },
  {
    "text": "our research regarding anti virus",
    "start": "19230",
    "end": "21570"
  },
  {
    "text": "detection and circumvention techniques",
    "start": "21570",
    "end": "23070"
  },
  {
    "text": "with a dedicated tool called Becker so",
    "start": "23070",
    "end": "26550"
  },
  {
    "start": "26000",
    "end": "50000"
  },
  {
    "text": "it the agenda for today is limited as is",
    "start": "26550",
    "end": "28289"
  },
  {
    "text": "our time slot first of all I will",
    "start": "28289",
    "end": "30359"
  },
  {
    "text": "introduce the term packing for those who",
    "start": "30359",
    "end": "32488"
  },
  {
    "text": "are unfamiliar with it yet and hereafter",
    "start": "32489",
    "end": "35670"
  },
  {
    "text": "will be covering the three main",
    "start": "35670",
    "end": "37230"
  },
  {
    "text": "detection techniques that we've",
    "start": "37230",
    "end": "38430"
  },
  {
    "text": "identified in antivirus products first",
    "start": "38430",
    "end": "42000"
  },
  {
    "text": "of all I will be covering the static",
    "start": "42000",
    "end": "43260"
  },
  {
    "text": "detection we all probably know of and",
    "start": "43260",
    "end": "45120"
  },
  {
    "text": "you're after Aladin will cover the code",
    "start": "45120",
    "end": "47100"
  },
  {
    "text": "emulation and dynamic detection",
    "start": "47100",
    "end": "48780"
  },
  {
    "text": "techniques brief introduction about us",
    "start": "48780",
    "end": "52920"
  },
  {
    "start": "50000",
    "end": "64000"
  },
  {
    "text": "we are as you've noticed we are not",
    "start": "52920",
    "end": "55110"
  },
  {
    "text": "American we're both from Europe I'm from",
    "start": "55110",
    "end": "57390"
  },
  {
    "text": "Belgium and eldon is based in France and",
    "start": "57390",
    "end": "59480"
  },
  {
    "text": "we are penetration testers in our",
    "start": "59480",
    "end": "62160"
  },
  {
    "text": "day-to-day job so packing packing is",
    "start": "62160",
    "end": "66840"
  },
  {
    "start": "64000",
    "end": "100000"
  },
  {
    "text": "actually the transformation of an",
    "start": "66840",
    "end": "68460"
  },
  {
    "text": "executable into an other executable",
    "start": "68460",
    "end": "70500"
  },
  {
    "text": "which exhibits the same or even enhanced",
    "start": "70500",
    "end": "72869"
  },
  {
    "text": "functionality but has a different file",
    "start": "72869",
    "end": "74909"
  },
  {
    "text": "system footprint and a good example of a",
    "start": "74909",
    "end": "77939"
  },
  {
    "text": "pecker is for example a compressor like",
    "start": "77939",
    "end": "80280"
  },
  {
    "text": "you p x which compresses a file and then",
    "start": "80280",
    "end": "83159"
  },
  {
    "text": "also a pence piece of code called a stop",
    "start": "83159",
    "end": "86009"
  },
  {
    "text": "to the final executable which will undo",
    "start": "86009",
    "end": "88110"
  },
  {
    "text": "the compression so the stop it's",
    "start": "88110",
    "end": "89549"
  },
  {
    "text": "injected into the final executable and",
    "start": "89549",
    "end": "91759"
  },
  {
    "text": "it will decompress before handing over",
    "start": "91759",
    "end": "95700"
  },
  {
    "text": "execution to the original executable in",
    "start": "95700",
    "end": "97979"
  },
  {
    "text": "memory so with regard to static",
    "start": "97979",
    "end": "102270"
  },
  {
    "start": "100000",
    "end": "141000"
  },
  {
    "text": "detection of antivirus companies we can",
    "start": "102270",
    "end": "103950"
  },
  {
    "text": "all see why a packer could be useful",
    "start": "103950",
    "end": "105299"
  },
  {
    "text": "because the packer can change the",
    "start": "105299",
    "end": "107579"
  },
  {
    "text": "footprint and the signature of a file on",
    "start": "107579",
    "end": "110220"
  },
  {
    "text": "this and of course since antivirus",
    "start": "110220",
    "end": "112560"
  },
  {
    "text": "companies are using signatures to",
    "start": "112560",
    "end": "114479"
  },
  {
    "text": "statically detect malware it is obvious",
    "start": "114479",
    "end": "117810"
  },
  {
    "text": "that a packer is is useful to to do",
    "start": "117810",
    "end": "120899"
  },
  {
    "text": "proper circumvention of course antivirus",
    "start": "120899",
    "end": "123869"
  },
  {
    "text": "products also know that malware authors",
    "start": "123869",
    "end": "125759"
  },
  {
    "text": "are actively using Packers to may",
    "start": "125759",
    "end": "128819"
  },
  {
    "text": "they're malware undetectable again so",
    "start": "128819",
    "end": "131340"
  },
  {
    "text": "antivirus products are really also",
    "start": "131340",
    "end": "133430"
  },
  {
    "text": "trying to detect modifications that a",
    "start": "133430",
    "end": "135780"
  },
  {
    "text": "packer makes to an executable in order",
    "start": "135780",
    "end": "137879"
  },
  {
    "text": "to see if it's suspicious or not to",
    "start": "137879",
    "end": "143099"
  },
  {
    "start": "141000",
    "end": "190000"
  },
  {
    "text": "understand how a good Packer can be made",
    "start": "143099",
    "end": "145469"
  },
  {
    "text": "we first have to take a brief look into",
    "start": "145469",
    "end": "147569"
  },
  {
    "text": "the portable executable file format of",
    "start": "147569",
    "end": "149280"
  },
  {
    "text": "Windows of course our research was",
    "start": "149280",
    "end": "151019"
  },
  {
    "text": "focused on Microsoft executables because",
    "start": "151019",
    "end": "153629"
  },
  {
    "text": "this is the platform where where malware",
    "start": "153629",
    "end": "155790"
  },
  {
    "text": "is a mainly at stake so if you look at",
    "start": "155790",
    "end": "158459"
  },
  {
    "text": "into an executable it has two general",
    "start": "158459",
    "end": "160620"
  },
  {
    "text": "categories or sections categories so the",
    "start": "160620",
    "end": "163769"
  },
  {
    "text": "first one is the header which contains",
    "start": "163769",
    "end": "165269"
  },
  {
    "text": "really only metadata which is used by",
    "start": "165269",
    "end": "167370"
  },
  {
    "text": "the operating system to load your",
    "start": "167370",
    "end": "169169"
  },
  {
    "text": "executable in memory and execute it",
    "start": "169169",
    "end": "170969"
  },
  {
    "text": "properly and you're after you have a",
    "start": "170969",
    "end": "172590"
  },
  {
    "text": "data block which is logically divided",
    "start": "172590",
    "end": "174269"
  },
  {
    "text": "into sections so in the header you have",
    "start": "174269",
    "end": "176400"
  },
  {
    "text": "a number of fields like the address of",
    "start": "176400",
    "end": "178469"
  },
  {
    "text": "entry point which points to the first",
    "start": "178469",
    "end": "180000"
  },
  {
    "text": "instruction in data sections where",
    "start": "180000",
    "end": "184169"
  },
  {
    "text": "execution should be started and add are",
    "start": "184169",
    "end": "186540"
  },
  {
    "text": "also contained a section table which",
    "start": "186540",
    "end": "187980"
  },
  {
    "text": "logically divides this data into",
    "start": "187980",
    "end": "189569"
  },
  {
    "text": "sections so a quick example a program",
    "start": "189569",
    "end": "195000"
  },
  {
    "start": "190000",
    "end": "341000"
  },
  {
    "text": "example is a the following we have a",
    "start": "195000",
    "end": "198090"
  },
  {
    "text": "simple C program which calls a message",
    "start": "198090",
    "end": "200189"
  },
  {
    "text": "box saying hello world and if you look",
    "start": "200189",
    "end": "202109"
  },
  {
    "text": "into the second table of this program we",
    "start": "202109",
    "end": "203759"
  },
  {
    "text": "can see there are five sections the",
    "start": "203759",
    "end": "205680"
  },
  {
    "text": "first one is a text section which",
    "start": "205680",
    "end": "207000"
  },
  {
    "text": "actually contains an assembly code of",
    "start": "207000",
    "end": "208919"
  },
  {
    "text": "your program which is generated by your",
    "start": "208919",
    "end": "211109"
  },
  {
    "text": "compiler and this text section actually",
    "start": "211109",
    "end": "213509"
  },
  {
    "text": "contains absolute references to the next",
    "start": "213509",
    "end": "215310"
  },
  {
    "text": "two sections which are the our data or",
    "start": "215310",
    "end": "217470"
  },
  {
    "text": "also called the import section and the",
    "start": "217470",
    "end": "220470"
  },
  {
    "text": "data section the data section contains",
    "start": "220470",
    "end": "222359"
  },
  {
    "text": "the heart the static strings or the",
    "start": "222359",
    "end": "225180"
  },
  {
    "text": "static data from your program for",
    "start": "225180",
    "end": "226620"
  },
  {
    "text": "example dialogue world strings the our",
    "start": "226620",
    "end": "228930"
  },
  {
    "text": "data section is the imports section of",
    "start": "228930",
    "end": "231659"
  },
  {
    "text": "your program and this actually contains",
    "start": "231659",
    "end": "233250"
  },
  {
    "text": "at runtime the addresses of the windows",
    "start": "233250",
    "end": "236879"
  },
  {
    "text": "api functions that the program is",
    "start": "236879",
    "end": "239000"
  },
  {
    "text": "counting on so in this case message box",
    "start": "239000",
    "end": "241819"
  },
  {
    "text": "of course at static on disk this address",
    "start": "241819",
    "end": "247650"
  },
  {
    "text": "is not present in this section because",
    "start": "247650",
    "end": "249930"
  },
  {
    "text": "the function addresses of Windows API is",
    "start": "249930",
    "end": "252509"
  },
  {
    "text": "they differ between operating systems",
    "start": "252509",
    "end": "256109"
  },
  {
    "text": "and even service packs so actually on",
    "start": "256109",
    "end": "258449"
  },
  {
    "text": "this this this imports section contains",
    "start": "258449",
    "end": "261479"
  },
  {
    "text": "a structure which which informs the",
    "start": "261479",
    "end": "264750"
  },
  {
    "text": "Windows operating system which addresses",
    "start": "264750",
    "end": "267659"
  },
  {
    "text": "are required by this program and at",
    "start": "267659",
    "end": "270360"
  },
  {
    "text": "loading time the windows PE loader will",
    "start": "270360",
    "end": "272880"
  },
  {
    "text": "then hot patch the addresses of these",
    "start": "272880",
    "end": "274320"
  },
  {
    "text": "functions in memory in this section but",
    "start": "274320",
    "end": "276900"
  },
  {
    "text": "what is really relevant for a pecker is",
    "start": "276900",
    "end": "279089"
  },
  {
    "text": "that the text section contains absolute",
    "start": "279089",
    "end": "281430"
  },
  {
    "text": "references to detect to the two sections",
    "start": "281430",
    "end": "283979"
  },
  {
    "text": "below it below it I'm sorry and for this",
    "start": "283979",
    "end": "287880"
  },
  {
    "text": "reason text check section cannot be",
    "start": "287880",
    "end": "289770"
  },
  {
    "text": "easily extended so because you would",
    "start": "289770",
    "end": "292409"
  },
  {
    "text": "move the section below it to another",
    "start": "292409",
    "end": "294900"
  },
  {
    "text": "virtual memory address and you would",
    "start": "294900",
    "end": "297000"
  },
  {
    "text": "break these absolute references so this",
    "start": "297000",
    "end": "298710"
  },
  {
    "text": "is one of the main limitation for a",
    "start": "298710",
    "end": "301169"
  },
  {
    "text": "packer a second limitation is also that",
    "start": "301169",
    "end": "305070"
  },
  {
    "text": "the import section contains a data",
    "start": "305070",
    "end": "307349"
  },
  {
    "text": "structure which is required to be valid",
    "start": "307349",
    "end": "311570"
  },
  {
    "text": "statically so the Windows operating",
    "start": "311570",
    "end": "313620"
  },
  {
    "text": "system loader will reads and party",
    "start": "313620",
    "end": "316830"
  },
  {
    "text": "structures before really running the",
    "start": "316830",
    "end": "318690"
  },
  {
    "text": "executable and this is also the same for",
    "start": "318690",
    "end": "321180"
  },
  {
    "text": "the two latest sections which are the",
    "start": "321180",
    "end": "323130"
  },
  {
    "text": "resource and a relocation table resource",
    "start": "323130",
    "end": "325500"
  },
  {
    "text": "and relocation section general actually",
    "start": "325500",
    "end": "327240"
  },
  {
    "text": "they also contain data structures to",
    "start": "327240",
    "end": "330539"
  },
  {
    "text": "relocate an executable in memory when a",
    "start": "330539",
    "end": "333240"
  },
  {
    "text": "SLR is enabled and for example the icons",
    "start": "333240",
    "end": "336870"
  },
  {
    "text": "of an executable are present in a",
    "start": "336870",
    "end": "339330"
  },
  {
    "text": "resource section so when building a",
    "start": "339330",
    "end": "342839"
  },
  {
    "text": "packer you have two main challenges the",
    "start": "342839",
    "end": "344669"
  },
  {
    "text": "first challenge is you need to create a",
    "start": "344669",
    "end": "346800"
  },
  {
    "text": "stub which you can inject into the final",
    "start": "346800",
    "end": "350159"
  },
  {
    "text": "executable this stop is actually in",
    "start": "350159",
    "end": "352349"
  },
  {
    "text": "should be assembly code because we're",
    "start": "352349",
    "end": "353760"
  },
  {
    "text": "working with low-level executables here",
    "start": "353760",
    "end": "355889"
  },
  {
    "text": "and assembly code is architecture",
    "start": "355889",
    "end": "357389"
  },
  {
    "text": "specific second second of all",
    "start": "357389",
    "end": "360060"
  },
  {
    "text": "requirement is that the code is position",
    "start": "360060",
    "end": "362099"
  },
  {
    "text": "position independent and self dependency",
    "start": "362099",
    "end": "364529"
  },
  {
    "text": "self dependent because you cannot count",
    "start": "364529",
    "end": "366690"
  },
  {
    "text": "on the Windows operating system to hot",
    "start": "366690",
    "end": "369029"
  },
  {
    "text": "patch for example the addresses of your",
    "start": "369029",
    "end": "370740"
  },
  {
    "text": "windows required windows API functions",
    "start": "370740",
    "end": "372750"
  },
  {
    "text": "of your stop and thus you need to deal",
    "start": "372750",
    "end": "375900"
  },
  {
    "text": "with it yourself",
    "start": "375900",
    "end": "377560"
  },
  {
    "start": "377000",
    "end": "442000"
  },
  {
    "text": "so we've looked for co-opted solution",
    "start": "377560",
    "end": "380300"
  },
  {
    "text": "which is called reflective DLL injection",
    "start": "380300",
    "end": "381650"
  },
  {
    "text": "anyone knows the reflective DLL",
    "start": "381650",
    "end": "383390"
  },
  {
    "text": "injection projects anyone knows it not",
    "start": "383390",
    "end": "387020"
  },
  {
    "text": "from metasploit okay cool so decide",
    "start": "387020",
    "end": "391550"
  },
  {
    "text": "actually is an open source project from",
    "start": "391550",
    "end": "393350"
  },
  {
    "text": "Stephen fewer which allows you to write",
    "start": "393350",
    "end": "395630"
  },
  {
    "text": "C and C++ code compile it to a DLL for",
    "start": "395630",
    "end": "398750"
  },
  {
    "text": "32 bits 32-bit 64-bit and even i erm",
    "start": "398750",
    "end": "401510"
  },
  {
    "text": "code okay 30 to six and 64-bit armv8",
    "start": "401510",
    "end": "408040"
  },
  {
    "text": "actually you can pilot you compile it as",
    "start": "408040",
    "end": "410600"
  },
  {
    "text": "a DLL you can inject it into a process",
    "start": "410600",
    "end": "412970"
  },
  {
    "text": "and then you just execute a reflective",
    "start": "412970",
    "end": "415550"
  },
  {
    "text": "loader which is a function provided by",
    "start": "415550",
    "end": "417290"
  },
  {
    "text": "the reflective DLL injection project and",
    "start": "417290",
    "end": "419990"
  },
  {
    "text": "if this reflective loader will actually",
    "start": "419990",
    "end": "421790"
  },
  {
    "text": "load your dll dynamically so it will",
    "start": "421790",
    "end": "424850"
  },
  {
    "text": "relocate or complete dll into the heap",
    "start": "424850",
    "end": "426980"
  },
  {
    "text": "it will parse through the imports table",
    "start": "426980",
    "end": "429470"
  },
  {
    "text": "to help patch the windows api functions",
    "start": "429470",
    "end": "431930"
  },
  {
    "text": "that are required and then it will hand",
    "start": "431930",
    "end": "434480"
  },
  {
    "text": "over execution to the DLL main function",
    "start": "434480",
    "end": "436580"
  },
  {
    "text": "which has been implemented by by us with",
    "start": "436580",
    "end": "439220"
  },
  {
    "text": "this actually containing our stub second",
    "start": "439220",
    "end": "443390"
  },
  {
    "start": "442000",
    "end": "468000"
  },
  {
    "text": "main challenge of making a packer",
    "start": "443390",
    "end": "445280"
  },
  {
    "text": "witches which can defeat static anti",
    "start": "445280",
    "end": "447560"
  },
  {
    "text": "virus detection is we have to inject or",
    "start": "447560",
    "end": "451430"
  },
  {
    "text": "stop in a way that it's stealthy because",
    "start": "451430",
    "end": "453860"
  },
  {
    "text": "antivirus products are really trying to",
    "start": "453860",
    "end": "455990"
  },
  {
    "text": "detect the injection of stubs and",
    "start": "455990",
    "end": "458080"
  },
  {
    "text": "generally modifications of Packers so we",
    "start": "458080",
    "end": "461780"
  },
  {
    "text": "need to complete the solution but as",
    "start": "461780",
    "end": "463460"
  },
  {
    "text": "I've told you before there are some",
    "start": "463460",
    "end": "464810"
  },
  {
    "text": "limitations because of the windows PE",
    "start": "464810",
    "end": "466550"
  },
  {
    "text": "file formats so what we've done first is",
    "start": "466550",
    "end": "470600"
  },
  {
    "start": "468000",
    "end": "497000"
  },
  {
    "text": "we've looked at how other Packers do it",
    "start": "470600",
    "end": "472900"
  },
  {
    "text": "here's a brief summarized summary of the",
    "start": "472900",
    "end": "477140"
  },
  {
    "text": "section tables of the hello world",
    "start": "477140",
    "end": "478850"
  },
  {
    "text": "example that I've shown you before and",
    "start": "478850",
    "end": "481580"
  },
  {
    "text": "you can see that every Packer actually",
    "start": "481580",
    "end": "483470"
  },
  {
    "text": "mangles the section table a lot so none",
    "start": "483470",
    "end": "485780"
  },
  {
    "text": "of the section tables here are still",
    "start": "485780",
    "end": "488170"
  },
  {
    "text": "legitimate azure looks legitimate so",
    "start": "488170",
    "end": "491360"
  },
  {
    "text": "actually we didn't find a",
    "start": "491360",
    "end": "493100"
  },
  {
    "text": "straightforward solution that we could",
    "start": "493100",
    "end": "494980"
  },
  {
    "text": "simply copy there so we've developed our",
    "start": "494980",
    "end": "498860"
  },
  {
    "start": "497000",
    "end": "545000"
  },
  {
    "text": "own techniques first of all we've",
    "start": "498860",
    "end": "500540"
  },
  {
    "text": "implemented a simple pack packing",
    "start": "500540",
    "end": "503480"
  },
  {
    "text": "technique which we called in linebacker",
    "start": "503480",
    "end": "506160"
  },
  {
    "text": "and what we do here on the Left we have",
    "start": "506160",
    "end": "508170"
  },
  {
    "text": "the input executable that we want to",
    "start": "508170",
    "end": "510060"
  },
  {
    "text": "pack and on the right we have the final",
    "start": "510060",
    "end": "511710"
  },
  {
    "text": "generated executable by this packing",
    "start": "511710",
    "end": "513450"
  },
  {
    "text": "technique what's the Packer will do",
    "start": "513450",
    "end": "516000"
  },
  {
    "text": "statically is we will encrypt the code",
    "start": "516000",
    "end": "518010"
  },
  {
    "text": "and the data section in line and we will",
    "start": "518010",
    "end": "521039"
  },
  {
    "text": "append are stopped as a new section so",
    "start": "521039",
    "end": "524219"
  },
  {
    "text": "appending a stub as a new section is a",
    "start": "524220",
    "end": "526980"
  },
  {
    "text": "good option because you will not break",
    "start": "526980",
    "end": "529230"
  },
  {
    "text": "anything appending a new section will",
    "start": "529230",
    "end": "531090"
  },
  {
    "text": "not break like the addresses of the",
    "start": "531090",
    "end": "533520"
  },
  {
    "text": "other sections and when executing the",
    "start": "533520",
    "end": "536520"
  },
  {
    "text": "stock the stock will simply decrypt the",
    "start": "536520",
    "end": "538320"
  },
  {
    "text": "code and data section in memory and then",
    "start": "538320",
    "end": "540240"
  },
  {
    "text": "hand over execution to the original",
    "start": "540240",
    "end": "542130"
  },
  {
    "text": "entry point in the code section now",
    "start": "542130",
    "end": "545250"
  },
  {
    "text": "we've done some tests with it backer on",
    "start": "545250",
    "end": "547680"
  },
  {
    "text": "a number of malware samples for both",
    "start": "547680",
    "end": "550020"
  },
  {
    "text": "32-bit and 64-bit and we've seen that",
    "start": "550020",
    "end": "554060"
  },
  {
    "text": "first of all we've if use the stuff that",
    "start": "554060",
    "end": "557520"
  },
  {
    "text": "does not completely decrypt the original",
    "start": "557520",
    "end": "560880"
  },
  {
    "text": "executable but actually we've used the",
    "start": "560880",
    "end": "562680"
  },
  {
    "text": "stop that immediately immediately calls",
    "start": "562680",
    "end": "564750"
  },
  {
    "text": "exit process so in order to really",
    "start": "564750",
    "end": "567450"
  },
  {
    "text": "isolate for static anti virus detection",
    "start": "567450",
    "end": "569370"
  },
  {
    "text": "if you don't do it code a Malaysian hit",
    "start": "569370",
    "end": "572270"
  },
  {
    "text": "some anti viruses perform also code",
    "start": "572270",
    "end": "574860"
  },
  {
    "text": "emulation this so this is really to",
    "start": "574860",
    "end": "576330"
  },
  {
    "text": "isolate static and divided detection and",
    "start": "576330",
    "end": "578700"
  },
  {
    "text": "what we see is that for 64-bit by",
    "start": "578700",
    "end": "581250"
  },
  {
    "text": "packing just with a simple packer we can",
    "start": "581250",
    "end": "583230"
  },
  {
    "text": "see that only two and the viruses are",
    "start": "583230",
    "end": "585270"
  },
  {
    "text": "still detecting our our initial malware",
    "start": "585270",
    "end": "588770"
  },
  {
    "text": "for 32-bit the story is a bit different",
    "start": "588770",
    "end": "591930"
  },
  {
    "text": "so many viruses are already completely",
    "start": "591930",
    "end": "594150"
  },
  {
    "text": "bypassed as you can see on the right but",
    "start": "594150",
    "end": "596760"
  },
  {
    "text": "for example key who and devour the",
    "start": "596760",
    "end": "599040"
  },
  {
    "text": "Chinese antivirus solution that we've",
    "start": "599040",
    "end": "600930"
  },
  {
    "text": "put in scope it detected more malware",
    "start": "600930",
    "end": "604020"
  },
  {
    "text": "samples that we packed with our with",
    "start": "604020",
    "end": "606990"
  },
  {
    "text": "this technique than initially so",
    "start": "606990",
    "end": "608760"
  },
  {
    "text": "actually this is this antivirus product",
    "start": "608760",
    "end": "611730"
  },
  {
    "text": "is really detecting our packing",
    "start": "611730",
    "end": "614220"
  },
  {
    "text": "technique rather than the initial",
    "start": "614220",
    "end": "615750"
  },
  {
    "text": "malware so we we thought about how how",
    "start": "615750",
    "end": "621840"
  },
  {
    "text": "this would what the reason what actually",
    "start": "621840",
    "end": "624120"
  },
  {
    "text": "reason was that the antivirus products",
    "start": "624120",
    "end": "626250"
  },
  {
    "text": "were still detecting a significant",
    "start": "626250",
    "end": "628260"
  },
  {
    "text": "number of our initial malware and we've",
    "start": "628260",
    "end": "630870"
  },
  {
    "text": "identified yeah the two major",
    "start": "630870",
    "end": "633670"
  },
  {
    "text": "reason so first of all we are injecting",
    "start": "633670",
    "end": "635710"
  },
  {
    "text": "a stub at the end of the executable and",
    "start": "635710",
    "end": "638830"
  },
  {
    "text": "it's yeah it's really obvious that this",
    "start": "638830",
    "end": "640840"
  },
  {
    "text": "is not normal because a normal compiler",
    "start": "640840",
    "end": "642820"
  },
  {
    "text": "would not add a new section called stop",
    "start": "642820",
    "end": "646720"
  },
  {
    "text": "at the end of the executable also the",
    "start": "646720",
    "end": "649150"
  },
  {
    "text": "entry point of our final executable is",
    "start": "649150",
    "end": "651370"
  },
  {
    "text": "pointing to this last section and this",
    "start": "651370",
    "end": "653470"
  },
  {
    "text": "is also not normal behavior because the",
    "start": "653470",
    "end": "656170"
  },
  {
    "text": "entry point is usually always pointing",
    "start": "656170",
    "end": "658210"
  },
  {
    "text": "to the code section which is always the",
    "start": "658210",
    "end": "659890"
  },
  {
    "text": "first section in executable second of",
    "start": "659890",
    "end": "662890"
  },
  {
    "text": "all we are only encrypting the coat and",
    "start": "662890",
    "end": "664360"
  },
  {
    "text": "the data sections because the other",
    "start": "664360",
    "end": "666340"
  },
  {
    "text": "three sections are used by the windows",
    "start": "666340",
    "end": "668230"
  },
  {
    "text": "PE loader and must contain legitimate",
    "start": "668230",
    "end": "670810"
  },
  {
    "text": "data on disk and of course the coverage",
    "start": "670810",
    "end": "673960"
  },
  {
    "text": "of the packer is not complete because we",
    "start": "673960",
    "end": "675520"
  },
  {
    "text": "are not encrypting all the sections so",
    "start": "675520",
    "end": "679030"
  },
  {
    "start": "678000",
    "end": "803000"
  },
  {
    "text": "we've come up with a solution on the",
    "start": "679030",
    "end": "681010"
  },
  {
    "text": "left again the initial executable on the",
    "start": "681010",
    "end": "683800"
  },
  {
    "text": "right it's not a modified xik it's not a",
    "start": "683800",
    "end": "687130"
  },
  {
    "text": "modified executable but it's actually a",
    "start": "687130",
    "end": "688690"
  },
  {
    "text": "completely new executable that we based",
    "start": "688690",
    "end": "691240"
  },
  {
    "text": "on both the template excel file and an",
    "start": "691240",
    "end": "694380"
  },
  {
    "text": "excel file we want to pack so first of",
    "start": "694380",
    "end": "697120"
  },
  {
    "text": "all what do we do statically we encrypt",
    "start": "697120",
    "end": "699400"
  },
  {
    "text": "we take all the sections of the initial",
    "start": "699400",
    "end": "701470"
  },
  {
    "text": "executable we encrypt them we append our",
    "start": "701470",
    "end": "704950"
  },
  {
    "text": "stop to it and this whole data blob we",
    "start": "704950",
    "end": "708010"
  },
  {
    "text": "make this or no code section in our in",
    "start": "708010",
    "end": "711160"
  },
  {
    "text": "our final executable so in this case or",
    "start": "711160",
    "end": "714310"
  },
  {
    "text": "stop is in the code section we can point",
    "start": "714310",
    "end": "716470"
  },
  {
    "text": "the entry point into our code section",
    "start": "716470",
    "end": "718150"
  },
  {
    "text": "and it's not suspicious anymore here",
    "start": "718150",
    "end": "721030"
  },
  {
    "text": "after we use the template file to borrow",
    "start": "721030",
    "end": "723430"
  },
  {
    "text": "their legitimate sections that are",
    "start": "723430",
    "end": "725440"
  },
  {
    "text": "legitimate data imports table and",
    "start": "725440",
    "end": "727360"
  },
  {
    "text": "resource sections in order to let see",
    "start": "727360",
    "end": "730300"
  },
  {
    "text": "the final executable look legitimate but",
    "start": "730300",
    "end": "732670"
  },
  {
    "text": "of course these are just for for for the",
    "start": "732670",
    "end": "736300"
  },
  {
    "text": "view it's not that we they are really",
    "start": "736300",
    "end": "738400"
  },
  {
    "text": "required to properly execute the final",
    "start": "738400",
    "end": "741610"
  },
  {
    "text": "executable so",
    "start": "741610",
    "end": "744329"
  },
  {
    "text": "the stop has to do a little bit more",
    "start": "744329",
    "end": "746160"
  },
  {
    "text": "work because we need to resolve the",
    "start": "746160",
    "end": "748019"
  },
  {
    "text": "imports table from the pacts executable",
    "start": "748019",
    "end": "750119"
  },
  {
    "text": "ourselves but of course they're",
    "start": "750119",
    "end": "751980"
  },
  {
    "text": "reflective DLL order can do it so so we",
    "start": "751980",
    "end": "754110"
  },
  {
    "text": "can do it too and when we tested this",
    "start": "754110",
    "end": "757139"
  },
  {
    "text": "technique on again on the same malware",
    "start": "757139",
    "end": "759689"
  },
  {
    "text": "samples we've seen that it is really",
    "start": "759689",
    "end": "762660"
  },
  {
    "text": "effective against 64-bit none of the",
    "start": "762660",
    "end": "764939"
  },
  {
    "text": "antivirus products are still detecting",
    "start": "764939",
    "end": "767009"
  },
  {
    "text": "64 bit smaller samples packed with this",
    "start": "767009",
    "end": "769769"
  },
  {
    "text": "technique but for 32 bits the there are",
    "start": "769769",
    "end": "772860"
  },
  {
    "text": "still three antivirus who are detecting",
    "start": "772860",
    "end": "775049"
  },
  {
    "text": "it so we wondered okay what could be the",
    "start": "775049",
    "end": "777449"
  },
  {
    "text": "reason because we solved all the",
    "start": "777449",
    "end": "778679"
  },
  {
    "text": "previous issues but what we came up with",
    "start": "778679",
    "end": "782279"
  },
  {
    "text": "is our code section is actually",
    "start": "782279",
    "end": "784139"
  },
  {
    "text": "containing encrypted data and a piece of",
    "start": "784139",
    "end": "786209"
  },
  {
    "text": "code which is called or stopped but its",
    "start": "786209",
    "end": "788639"
  },
  {
    "text": "encrypted data of course the entropy of",
    "start": "788639",
    "end": "790920"
  },
  {
    "text": "this section is not as it as a normal",
    "start": "790920",
    "end": "793529"
  },
  {
    "text": "Code section so we we think this is the",
    "start": "793529",
    "end": "796319"
  },
  {
    "text": "reason that this antivirus products",
    "start": "796319",
    "end": "797819"
  },
  {
    "text": "detector detect a subset of our malware",
    "start": "797819",
    "end": "800189"
  },
  {
    "text": "back to this technique so we come up",
    "start": "800189",
    "end": "802290"
  },
  {
    "text": "with a third one which we designate the",
    "start": "802290",
    "end": "805199"
  },
  {
    "start": "803000",
    "end": "1022000"
  },
  {
    "text": "resource packer and with this pecker we",
    "start": "805199",
    "end": "807769"
  },
  {
    "text": "completely encrypt the original",
    "start": "807769",
    "end": "809929"
  },
  {
    "text": "executable we added at a resource to a",
    "start": "809929",
    "end": "812910"
  },
  {
    "text": "real legitimate template file for",
    "start": "812910",
    "end": "814709"
  },
  {
    "text": "example a windows file note better or",
    "start": "814709",
    "end": "816629"
  },
  {
    "text": "something we overwrite a piece of the",
    "start": "816629",
    "end": "819059"
  },
  {
    "text": "code of this template file with our stop",
    "start": "819059",
    "end": "822239"
  },
  {
    "text": "so the stop is in the code section of",
    "start": "822239",
    "end": "825089"
  },
  {
    "text": "the final executable and then we point",
    "start": "825089",
    "end": "827399"
  },
  {
    "text": "I'm 3.2 the reflective DLL loader in our",
    "start": "827399",
    "end": "829799"
  },
  {
    "text": "stub dynamically the stuff will decrypt",
    "start": "829799",
    "end": "833399"
  },
  {
    "text": "loads the resource decrypted overwrite",
    "start": "833399",
    "end": "836369"
  },
  {
    "text": "the original code and data sections of",
    "start": "836369",
    "end": "839459"
  },
  {
    "text": "the executable and then execute it and",
    "start": "839459",
    "end": "843449"
  },
  {
    "text": "now we see that this this technique can",
    "start": "843449",
    "end": "846600"
  },
  {
    "text": "evade all anti virus detection for both",
    "start": "846600",
    "end": "849239"
  },
  {
    "text": "32-bit and 64-bit but as you remember I",
    "start": "849239",
    "end": "852419"
  },
  {
    "text": "told you about a desktop that we",
    "start": "852419",
    "end": "854489"
  },
  {
    "text": "inserted exit process call for this",
    "start": "854489",
    "end": "859369"
  },
  {
    "text": "verifications but when we remove it and",
    "start": "859650",
    "end": "862180"
  },
  {
    "text": "we just again scan these files",
    "start": "862180",
    "end": "864460"
  },
  {
    "text": "statically we notice that for antivirus",
    "start": "864460",
    "end": "866740"
  },
  {
    "text": "products we're suddenly detecting the",
    "start": "866740",
    "end": "868900"
  },
  {
    "text": "pack to malware again these were",
    "start": "868900",
    "end": "870790"
  },
  {
    "text": "Microsoft an OD nod32 Casper sky and avg",
    "start": "870790",
    "end": "874180"
  },
  {
    "text": "and this is a infected code a Malaysian",
    "start": "874180",
    "end": "876370"
  },
  {
    "text": "that have referred to them a lot they",
    "start": "876370",
    "end": "877990"
  },
  {
    "text": "will tell you more about it now okay",
    "start": "877990",
    "end": "883000"
  },
  {
    "text": "well hi hi everyone okay so let's",
    "start": "883000",
    "end": "885490"
  },
  {
    "text": "continue so as on has explained using",
    "start": "885490",
    "end": "888310"
  },
  {
    "text": "the resource Packer it's possible to",
    "start": "888310",
    "end": "890110"
  },
  {
    "text": "bypass several intervarsity ATS use the",
    "start": "890110",
    "end": "892540"
  },
  {
    "text": "static analysis except for a few that",
    "start": "892540",
    "end": "894610"
  },
  {
    "text": "are using code emulation so the question",
    "start": "894610",
    "end": "897040"
  },
  {
    "text": "is is it possible to bypass this",
    "start": "897040",
    "end": "898810"
  },
  {
    "text": "detection method in a generic way well",
    "start": "898810",
    "end": "901990"
  },
  {
    "text": "first of all well the way antivirus",
    "start": "901990",
    "end": "904900"
  },
  {
    "text": "emulators is being performed is that",
    "start": "904900",
    "end": "906790"
  },
  {
    "text": "they are emulating the windows",
    "start": "906790",
    "end": "908290"
  },
  {
    "text": "environment in order to execute the",
    "start": "908290",
    "end": "910300"
  },
  {
    "text": "malware installed inside the restricted",
    "start": "910300",
    "end": "912850"
  },
  {
    "text": "bugs trigger the unpacking in memory and",
    "start": "912850",
    "end": "916390"
  },
  {
    "text": "then do further analysis on it after",
    "start": "916390",
    "end": "918160"
  },
  {
    "text": "work the problem however is that windows",
    "start": "918160",
    "end": "920710"
  },
  {
    "text": "environment is such a complex system",
    "start": "920710",
    "end": "922230"
  },
  {
    "text": "there are differences that exist between",
    "start": "922230",
    "end": "924640"
  },
  {
    "text": "the emulated environment and the real",
    "start": "924640",
    "end": "926740"
  },
  {
    "text": "environments and it is these different",
    "start": "926740",
    "end": "928779"
  },
  {
    "text": "differences that we will try to exploit",
    "start": "928779",
    "end": "930820"
  },
  {
    "text": "as attackers to perform initial checks",
    "start": "930820",
    "end": "933310"
  },
  {
    "text": "that will decide on doing the unpacking",
    "start": "933310",
    "end": "935500"
  },
  {
    "text": "that will trigger the entire verse",
    "start": "935500",
    "end": "937330"
  },
  {
    "text": "detection all to identify these",
    "start": "937330",
    "end": "940150"
  },
  {
    "text": "differences that and to evaluate the",
    "start": "940150",
    "end": "943690"
  },
  {
    "text": "different emulators we have hope on four",
    "start": "943690",
    "end": "945580"
  },
  {
    "text": "categories they are definitely more but",
    "start": "945580",
    "end": "947470"
  },
  {
    "text": "these are the ones that we did focus on",
    "start": "947470",
    "end": "948790"
  },
  {
    "text": "the first which is related to time in",
    "start": "948790",
    "end": "950740"
  },
  {
    "text": "animal e second which is network",
    "start": "950740",
    "end": "952839"
  },
  {
    "text": "interaction then file system interaction",
    "start": "952839",
    "end": "954820"
  },
  {
    "text": "and finally binary instrumentation for",
    "start": "954820",
    "end": "958959"
  },
  {
    "text": "the first category these are actually",
    "start": "958959",
    "end": "960760"
  },
  {
    "text": "checks that has already been documented",
    "start": "960760",
    "end": "962290"
  },
  {
    "text": "as being used in the world and the",
    "start": "962290",
    "end": "964420"
  },
  {
    "text": "principle is because the interval izing",
    "start": "964420",
    "end": "967600"
  },
  {
    "text": "the malware indefinitely marwa author",
    "start": "967600",
    "end": "969640"
  },
  {
    "text": "will try to stall the analysis by",
    "start": "969640",
    "end": "972190"
  },
  {
    "text": "delaying the unpacking and in this basic",
    "start": "972190",
    "end": "974350"
  },
  {
    "text": "example it is done by a simple big big",
    "start": "974350",
    "end": "976810"
  },
  {
    "text": "sleep however some introverts emulators",
    "start": "976810",
    "end": "979390"
  },
  {
    "text": "are able to bypass this evasion method",
    "start": "979390",
    "end": "981520"
  },
  {
    "text": "by emulating the sleep function so that",
    "start": "981520",
    "end": "983620"
  },
  {
    "text": "it will do sleep one or simply nothing",
    "start": "983620",
    "end": "986579"
  },
  {
    "text": "but again Maru authors adapt to this",
    "start": "986579",
    "end": "989779"
  },
  {
    "text": "to this approach and they will even try",
    "start": "989779",
    "end": "991610"
  },
  {
    "text": "to detect this sort of behavior and in",
    "start": "991610",
    "end": "993889"
  },
  {
    "text": "this example and the way the way that we",
    "start": "993889",
    "end": "995870"
  },
  {
    "text": "do it that they would use other EPA",
    "start": "995870",
    "end": "997519"
  },
  {
    "text": "functions to say if the sleeve function",
    "start": "997519",
    "end": "999499"
  },
  {
    "text": "is working properly in this example it",
    "start": "999499",
    "end": "1002050"
  },
  {
    "text": "is done using the gate taken but as",
    "start": "1002050",
    "end": "1004839"
  },
  {
    "text": "you'll see absolute in our results even",
    "start": "1004839",
    "end": "1007420"
  },
  {
    "text": "some malware some introverts emulators",
    "start": "1007420",
    "end": "1009610"
  },
  {
    "text": "are able to detect this kind of evasion",
    "start": "1009610",
    "end": "1011680"
  },
  {
    "text": "methods are able to bypass it so we try",
    "start": "1011680",
    "end": "1015129"
  },
  {
    "text": "to come up with other checks that would",
    "start": "1015129",
    "end": "1016779"
  },
  {
    "text": "allow us to detect this sort of behavior",
    "start": "1016779",
    "end": "1020199"
  },
  {
    "text": "but without using any EPA function and",
    "start": "1020199",
    "end": "1022809"
  },
  {
    "text": "the check we came up with the check that",
    "start": "1022809",
    "end": "1025058"
  },
  {
    "text": "uses to threat there is one thread which",
    "start": "1025059",
    "end": "1026829"
  },
  {
    "text": "is the counter threat and second thread",
    "start": "1026829",
    "end": "1028630"
  },
  {
    "text": "which is the water threat and the",
    "start": "1028630",
    "end": "1030610"
  },
  {
    "text": "counter threat is incrementing a shared",
    "start": "1030610",
    "end": "1032890"
  },
  {
    "text": "variable separated by multiple sleeps",
    "start": "1032890",
    "end": "1035020"
  },
  {
    "text": "the water threat is verifying the",
    "start": "1035020",
    "end": "1037150"
  },
  {
    "text": "counter variable after a big sleep and",
    "start": "1037150",
    "end": "1039339"
  },
  {
    "text": "in this example the counter variable",
    "start": "1039339",
    "end": "1041288"
  },
  {
    "text": "should be equal to 10 and this is what",
    "start": "1041289",
    "end": "1043510"
  },
  {
    "text": "we should see inside a real environment",
    "start": "1043510",
    "end": "1045959"
  },
  {
    "text": "however inside an emulated environment",
    "start": "1045959",
    "end": "1048730"
  },
  {
    "text": "where the sleep has been reduced what we",
    "start": "1048730",
    "end": "1050710"
  },
  {
    "text": "will see is that the water thread will",
    "start": "1050710",
    "end": "1052270"
  },
  {
    "text": "stop execution very early and when it",
    "start": "1052270",
    "end": "1054730"
  },
  {
    "text": "will try to compare it with the expected",
    "start": "1054730",
    "end": "1057159"
  },
  {
    "text": "value it will no longer match thus",
    "start": "1057159",
    "end": "1059230"
  },
  {
    "text": "allowing us to determine that we are on",
    "start": "1059230",
    "end": "1060789"
  },
  {
    "text": "an insult an emulated environment and",
    "start": "1060789",
    "end": "1062500"
  },
  {
    "text": "this is just an example of several of",
    "start": "1062500",
    "end": "1064510"
  },
  {
    "text": "the time and check that will that were",
    "start": "1064510",
    "end": "1066309"
  },
  {
    "text": "implemented there are more complex one",
    "start": "1066309",
    "end": "1068289"
  },
  {
    "text": "that you could check in the paper if you",
    "start": "1068289",
    "end": "1069640"
  },
  {
    "text": "are interested in them the second",
    "start": "1069640",
    "end": "1072070"
  },
  {
    "start": "1070000",
    "end": "1095000"
  },
  {
    "text": "category which is interaction with the",
    "start": "1072070",
    "end": "1073510"
  },
  {
    "text": "network and this is an example of a",
    "start": "1073510",
    "end": "1075010"
  },
  {
    "text": "check that has been documented by a",
    "start": "1075010",
    "end": "1076360"
  },
  {
    "text": "colleague called a yarmulke where he is",
    "start": "1076360",
    "end": "1078820"
  },
  {
    "text": "using a connection on local host to the",
    "start": "1078820",
    "end": "1081760"
  },
  {
    "text": "SMB port to use as an indicator if we",
    "start": "1081760",
    "end": "1084490"
  },
  {
    "text": "are running an insult and emulator the",
    "start": "1084490",
    "end": "1086380"
  },
  {
    "text": "SMB port exists on all professional",
    "start": "1086380",
    "end": "1088090"
  },
  {
    "text": "windows operating system and in if the",
    "start": "1088090",
    "end": "1090880"
  },
  {
    "text": "emulator fails to implement it then we",
    "start": "1090880",
    "end": "1092890"
  },
  {
    "text": "are able to detect the use of emulation",
    "start": "1092890",
    "end": "1095399"
  },
  {
    "start": "1095000",
    "end": "1135000"
  },
  {
    "text": "the third category which is interaction",
    "start": "1095399",
    "end": "1097720"
  },
  {
    "text": "with the fault system and here there are",
    "start": "1097720",
    "end": "1099309"
  },
  {
    "text": "several check that were implemented that",
    "start": "1099309",
    "end": "1101640"
  },
  {
    "text": "verify the sanity of the emulator",
    "start": "1101640",
    "end": "1103809"
  },
  {
    "text": "implementation like reading and writing",
    "start": "1103809",
    "end": "1105730"
  },
  {
    "text": "to false to 80's dreams checking the",
    "start": "1105730",
    "end": "1108570"
  },
  {
    "text": "timestamps of the created false but are",
    "start": "1108570",
    "end": "1111280"
  },
  {
    "text": "also check that were implemented that",
    "start": "1111280",
    "end": "1113860"
  },
  {
    "text": "uses EP",
    "start": "1113860",
    "end": "1114890"
  },
  {
    "text": "functions that relies indirectly owned",
    "start": "1114890",
    "end": "1117110"
  },
  {
    "text": "on the file system and this is an",
    "start": "1117110",
    "end": "1118850"
  },
  {
    "text": "example of a check that uses the load",
    "start": "1118850",
    "end": "1120620"
  },
  {
    "text": "library function to load system dealers",
    "start": "1120620",
    "end": "1123290"
  },
  {
    "text": "and fake dialogues if the system dealers",
    "start": "1123290",
    "end": "1125570"
  },
  {
    "text": "are not loading this is not a fully",
    "start": "1125570",
    "end": "1127250"
  },
  {
    "text": "functioning Windows operating system and",
    "start": "1127250",
    "end": "1129050"
  },
  {
    "text": "in the same fashion if the fake dealers",
    "start": "1129050",
    "end": "1131240"
  },
  {
    "text": "are loading we have just caught the",
    "start": "1131240",
    "end": "1132800"
  },
  {
    "text": "intervals line editorial face okay the",
    "start": "1132800",
    "end": "1136850"
  },
  {
    "start": "1135000",
    "end": "1167000"
  },
  {
    "text": "final category which is instrumentation",
    "start": "1136850",
    "end": "1138770"
  },
  {
    "text": "and this is based on work that has been",
    "start": "1138770",
    "end": "1140480"
  },
  {
    "text": "done by two researchers which are",
    "start": "1140480",
    "end": "1142220"
  },
  {
    "text": "Francisco Falcone and nehal reverb who",
    "start": "1142220",
    "end": "1144830"
  },
  {
    "text": "came up with several checks to detect",
    "start": "1144830",
    "end": "1146780"
  },
  {
    "text": "dynamic binary instrumentation few of",
    "start": "1146780",
    "end": "1149090"
  },
  {
    "text": "these checks are very specific to the",
    "start": "1149090",
    "end": "1150830"
  },
  {
    "text": "Intel pin frameworks but others are very",
    "start": "1150830",
    "end": "1152930"
  },
  {
    "text": "generic and this is an example of a",
    "start": "1152930",
    "end": "1154520"
  },
  {
    "text": "check that will retrieve the power on",
    "start": "1154520",
    "end": "1156050"
  },
  {
    "text": "processor name compared with cmd.exe and",
    "start": "1156050",
    "end": "1158600"
  },
  {
    "text": "exporting Z which should be the case of",
    "start": "1158600",
    "end": "1161150"
  },
  {
    "text": "our malware if it doesn't match then",
    "start": "1161150",
    "end": "1163640"
  },
  {
    "text": "again we are potentially running inside",
    "start": "1163640",
    "end": "1165500"
  },
  {
    "text": "an emulated environment okay well this",
    "start": "1165500",
    "end": "1169040"
  },
  {
    "start": "1167000",
    "end": "1290000"
  },
  {
    "text": "is a table that shows the result of a",
    "start": "1169040",
    "end": "1171080"
  },
  {
    "text": "subset of our checks this is table that",
    "start": "1171080",
    "end": "1173810"
  },
  {
    "text": "dates back from one week ago we did the",
    "start": "1173810",
    "end": "1175760"
  },
  {
    "text": "same checks back in March or have",
    "start": "1175760",
    "end": "1177470"
  },
  {
    "text": "already identified some notable",
    "start": "1177470",
    "end": "1179150"
  },
  {
    "text": "differences the most important one is",
    "start": "1179150",
    "end": "1181310"
  },
  {
    "text": "that back in March there are two anti",
    "start": "1181310",
    "end": "1183080"
  },
  {
    "text": "viruses whose for which the resource",
    "start": "1183080",
    "end": "1185360"
  },
  {
    "text": "packer was not triggering emulation and",
    "start": "1185360",
    "end": "1187070"
  },
  {
    "text": "it's the case of EV G&S attentive irises",
    "start": "1187070",
    "end": "1189740"
  },
  {
    "text": "and it's something that we could see",
    "start": "1189740",
    "end": "1191180"
  },
  {
    "text": "because their implementation is less",
    "start": "1191180",
    "end": "1193340"
  },
  {
    "text": "robust than the ones of customers coins",
    "start": "1193340",
    "end": "1194960"
  },
  {
    "text": "and Microsoft the second thing that we",
    "start": "1194960",
    "end": "1196970"
  },
  {
    "text": "could see is that customers car",
    "start": "1196970",
    "end": "1198410"
  },
  {
    "text": "emulation is lacking when it comes to 64",
    "start": "1198410",
    "end": "1200870"
  },
  {
    "text": "bits it's very comparable to Microsoft",
    "start": "1200870",
    "end": "1203510"
  },
  {
    "text": "for 32-bit and even in some cases",
    "start": "1203510",
    "end": "1205640"
  },
  {
    "text": "superior to Microsoft which is something",
    "start": "1205640",
    "end": "1207680"
  },
  {
    "text": "that wouldn't be expecting because",
    "start": "1207680",
    "end": "1208940"
  },
  {
    "text": "Microsoft is emulating their own",
    "start": "1208940",
    "end": "1210860"
  },
  {
    "text": "operating system which is not the case",
    "start": "1210860",
    "end": "1212510"
  },
  {
    "text": "of Casper skype the other notable",
    "start": "1212510",
    "end": "1215240"
  },
  {
    "text": "difference said that we had checks that",
    "start": "1215240",
    "end": "1217340"
  },
  {
    "text": "were allowing us to bypass emulation",
    "start": "1217340",
    "end": "1218960"
  },
  {
    "text": "back in March but which wasn't working",
    "start": "1218960",
    "end": "1221780"
  },
  {
    "text": "anymore which is an indication that",
    "start": "1221780",
    "end": "1223910"
  },
  {
    "text": "there is an active development of",
    "start": "1223910",
    "end": "1225470"
  },
  {
    "text": "enhancing the evasiveness of the",
    "start": "1225470",
    "end": "1227870"
  },
  {
    "text": "emulator implementations however as you",
    "start": "1227870",
    "end": "1230180"
  },
  {
    "text": "could see there are actually numerous",
    "start": "1230180",
    "end": "1231560"
  },
  {
    "text": "checks that are able to bypass all the",
    "start": "1231560",
    "end": "1234170"
  },
  {
    "text": "emulator implementation in a",
    "start": "1234170",
    "end": "1236140"
  },
  {
    "text": "quai meaning that using the resource",
    "start": "1236140",
    "end": "1238480"
  },
  {
    "text": "packer and one of these checks were able",
    "start": "1238480",
    "end": "1240610"
  },
  {
    "text": "to bypass the initial analysis but all",
    "start": "1240610",
    "end": "1242860"
  },
  {
    "text": "of all anti viruses well however and",
    "start": "1242860",
    "end": "1247150"
  },
  {
    "text": "this is probably a problem that you have",
    "start": "1247150",
    "end": "1248320"
  },
  {
    "text": "probably already faced before is if for",
    "start": "1248320",
    "end": "1250450"
  },
  {
    "text": "instance you have retrieved a",
    "start": "1250450",
    "end": "1251530"
  },
  {
    "text": "meterpreter shell but when you try to",
    "start": "1251530",
    "end": "1253570"
  },
  {
    "text": "perform certain action it gets flagged",
    "start": "1253570",
    "end": "1255670"
  },
  {
    "text": "by the intervals and the process is",
    "start": "1255670",
    "end": "1257290"
  },
  {
    "text": "killed and to give you an example if our",
    "start": "1257290",
    "end": "1259570"
  },
  {
    "text": "instance you are on a machine with",
    "start": "1259570",
    "end": "1261010"
  },
  {
    "text": "machine with the evg antivirus and you",
    "start": "1261010",
    "end": "1263500"
  },
  {
    "text": "try to migrate to export eggsy it will",
    "start": "1263500",
    "end": "1266050"
  },
  {
    "text": "be flagged by the entire vars it will be",
    "start": "1266050",
    "end": "1267850"
  },
  {
    "text": "unable to determine what kind of tool or",
    "start": "1267850",
    "end": "1269710"
  },
  {
    "text": "malware it is it will just say that",
    "start": "1269710",
    "end": "1271360"
  },
  {
    "text": "there is something suspicious and kill",
    "start": "1271360",
    "end": "1273610"
  },
  {
    "text": "the process and ask you to remove the",
    "start": "1273610",
    "end": "1274990"
  },
  {
    "text": "machine so the question again was is it",
    "start": "1274990",
    "end": "1277480"
  },
  {
    "text": "possible to bypass this detection method",
    "start": "1277480",
    "end": "1279610"
  },
  {
    "text": "in a generic way our first you have to",
    "start": "1279610",
    "end": "1282250"
  },
  {
    "text": "understand how this sort of how this",
    "start": "1282250",
    "end": "1284800"
  },
  {
    "text": "detection method which is commonly",
    "start": "1284800",
    "end": "1286480"
  },
  {
    "text": "referred to as dynamic analysis or",
    "start": "1286480",
    "end": "1288190"
  },
  {
    "text": "versatech analysis is implemented well",
    "start": "1288190",
    "end": "1291340"
  },
  {
    "start": "1290000",
    "end": "1331000"
  },
  {
    "text": "some inter vs not all of them some inter",
    "start": "1291340",
    "end": "1293920"
  },
  {
    "text": "vs uses a hugging technique called it is",
    "start": "1293920",
    "end": "1296380"
  },
  {
    "text": "dt hooking it is the T is a dispatch",
    "start": "1296380",
    "end": "1298810"
  },
  {
    "text": "table that exists in kernel and that",
    "start": "1298810",
    "end": "1300910"
  },
  {
    "text": "references function is accessible from",
    "start": "1300910",
    "end": "1302590"
  },
  {
    "text": "user net and by cooking the SS the tea",
    "start": "1302590",
    "end": "1305230"
  },
  {
    "text": "table it's possible to log function",
    "start": "1305230",
    "end": "1307360"
  },
  {
    "text": "calls with their different parameters in",
    "start": "1307360",
    "end": "1309280"
  },
  {
    "text": "a way that it is impossible to bypass",
    "start": "1309280",
    "end": "1311260"
  },
  {
    "text": "from user land perspective and this is",
    "start": "1311260",
    "end": "1313660"
  },
  {
    "text": "used in the way that if the intervals",
    "start": "1313660",
    "end": "1315490"
  },
  {
    "text": "see that there is a certain process",
    "start": "1315490",
    "end": "1317020"
  },
  {
    "text": "which is for instance going function a",
    "start": "1317020",
    "end": "1318970"
  },
  {
    "text": "followed by function b fo x function c",
    "start": "1318970",
    "end": "1321190"
  },
  {
    "text": "with certain parameters it will say well",
    "start": "1321190",
    "end": "1323500"
  },
  {
    "text": "this is actually the signature for",
    "start": "1323500",
    "end": "1324730"
  },
  {
    "text": "instance processor link which is mostly",
    "start": "1324730",
    "end": "1326890"
  },
  {
    "text": "used by malware a little flag it as",
    "start": "1326890",
    "end": "1329290"
  },
  {
    "text": "suspicious well it is deadly looking",
    "start": "1329290",
    "end": "1332650"
  },
  {
    "start": "1331000",
    "end": "1383000"
  },
  {
    "text": "just one of the many hugging technique",
    "start": "1332650",
    "end": "1334120"
  },
  {
    "text": "that exists and there is particularly",
    "start": "1334120",
    "end": "1335710"
  },
  {
    "text": "one that we use to implement evasive",
    "start": "1335710",
    "end": "1338500"
  },
  {
    "text": "techniques to bypass touristic analysis",
    "start": "1338500",
    "end": "1340510"
  },
  {
    "text": "and it's a user land in a memory hooking",
    "start": "1340510",
    "end": "1342580"
  },
  {
    "text": "technique called in line hooking what in",
    "start": "1342580",
    "end": "1344680"
  },
  {
    "text": "line hooking does is if for instance I'd",
    "start": "1344680",
    "end": "1346840"
  },
  {
    "text": "like to hook a certain function in line",
    "start": "1346840",
    "end": "1349690"
  },
  {
    "text": "hooking well these are sample",
    "start": "1349690",
    "end": "1350980"
  },
  {
    "text": "dysfunction it will replace the initial",
    "start": "1350980",
    "end": "1353170"
  },
  {
    "text": "instructions with one that would allow",
    "start": "1353170",
    "end": "1354970"
  },
  {
    "text": "us to jump to our newly allocated",
    "start": "1354970",
    "end": "1356950"
  },
  {
    "text": "function while making sure that it is",
    "start": "1356950",
    "end": "1359320"
  },
  {
    "text": "correctly padded so that we can still",
    "start": "1359320",
    "end": "1361510"
  },
  {
    "text": "use",
    "start": "1361510",
    "end": "1362730"
  },
  {
    "text": "the rest of the instructions it will",
    "start": "1362730",
    "end": "1364860"
  },
  {
    "text": "also save these initial instructions to",
    "start": "1364860",
    "end": "1367080"
  },
  {
    "text": "a new memory region called Trump align",
    "start": "1367080",
    "end": "1369059"
  },
  {
    "text": "however it will also need to correct the",
    "start": "1369059",
    "end": "1371820"
  },
  {
    "text": "Trump line if for instance I have a",
    "start": "1371820",
    "end": "1373320"
  },
  {
    "text": "relative jump I'll need to correct the",
    "start": "1373320",
    "end": "1376110"
  },
  {
    "text": "instructions so that will still be able",
    "start": "1376110",
    "end": "1377730"
  },
  {
    "text": "to jump to the correct address and this",
    "start": "1377730",
    "end": "1380309"
  },
  {
    "text": "is used to implement to evasive metrics",
    "start": "1380309",
    "end": "1383690"
  },
  {
    "text": "first one is method we call if a",
    "start": "1383690",
    "end": "1387750"
  },
  {
    "text": "translation I know the name is back but",
    "start": "1387750",
    "end": "1390630"
  },
  {
    "text": "the principle is if for instance you'd",
    "start": "1390630",
    "end": "1392970"
  },
  {
    "text": "like to perform persistence you might be",
    "start": "1392970",
    "end": "1395010"
  },
  {
    "text": "doing so by adding certain registry key",
    "start": "1395010",
    "end": "1397650"
  },
  {
    "text": "meaning you'll be using registry",
    "start": "1397650",
    "end": "1399660"
  },
  {
    "text": "handling functions which might trigger",
    "start": "1399660",
    "end": "1401880"
  },
  {
    "text": "in own signature when instead of using",
    "start": "1401880",
    "end": "1404429"
  },
  {
    "text": "this function which will trigger no",
    "start": "1404429",
    "end": "1405990"
  },
  {
    "text": "signature epi translation will transform",
    "start": "1405990",
    "end": "1408270"
  },
  {
    "text": "them into a new call for which there is",
    "start": "1408270",
    "end": "1411450"
  },
  {
    "text": "no known signature and in this example",
    "start": "1411450",
    "end": "1414240"
  },
  {
    "text": "they are being replaced with a system",
    "start": "1414240",
    "end": "1417480"
  },
  {
    "text": "command that will call the oreck",
    "start": "1417480",
    "end": "1419040"
  },
  {
    "text": "executive all directly acceptable and",
    "start": "1419040",
    "end": "1423630"
  },
  {
    "text": "what will potentially happen is that the",
    "start": "1423630",
    "end": "1424950"
  },
  {
    "text": "intervarsity this coming from different",
    "start": "1424950",
    "end": "1427410"
  },
  {
    "text": "process and this process is signed by",
    "start": "1427410",
    "end": "1429390"
  },
  {
    "text": "microsoft so the profile risk is lot",
    "start": "1429390",
    "end": "1432090"
  },
  {
    "text": "lower and it will no longer flag it as",
    "start": "1432090",
    "end": "1434100"
  },
  {
    "text": "something suspicious the second",
    "start": "1434100",
    "end": "1437790"
  },
  {
    "text": "technique is a technique we called epi",
    "start": "1437790",
    "end": "1439380"
  },
  {
    "text": "trunk injection and the principle is",
    "start": "1439380",
    "end": "1441440"
  },
  {
    "text": "because inter vs are expecting that the",
    "start": "1441440",
    "end": "1444720"
  },
  {
    "text": "recert infection pools that are",
    "start": "1444720",
    "end": "1446340"
  },
  {
    "text": "performed in certain order by hooking",
    "start": "1446340",
    "end": "1449309"
  },
  {
    "text": "these matters this different calls and",
    "start": "1449309",
    "end": "1450960"
  },
  {
    "text": "by injecting function calls but that do",
    "start": "1450960",
    "end": "1453809"
  },
  {
    "text": "not modify the logic of the application",
    "start": "1453809",
    "end": "1455850"
  },
  {
    "text": "but modified the expected succession",
    "start": "1455850",
    "end": "1458370"
  },
  {
    "text": "were able to bottom a longer match this",
    "start": "1458370",
    "end": "1461760"
  },
  {
    "text": "expected signature to draw back however",
    "start": "1461760",
    "end": "1464040"
  },
  {
    "text": "of this technique that there is a",
    "start": "1464040",
    "end": "1465419"
  },
  {
    "text": "significant performance impact it's very",
    "start": "1465419",
    "end": "1467910"
  },
  {
    "text": "generic to bypass a detection methods",
    "start": "1467910",
    "end": "1470040"
  },
  {
    "text": "the Troy's on this heuristic approach",
    "start": "1470040",
    "end": "1473820"
  },
  {
    "text": "however there is a significant",
    "start": "1473820",
    "end": "1475620"
  },
  {
    "text": "performance on impact opposed to the",
    "start": "1475620",
    "end": "1477750"
  },
  {
    "text": "first technique which which has little",
    "start": "1477750",
    "end": "1480690"
  },
  {
    "text": "or no impact on the application but it's",
    "start": "1480690",
    "end": "1483330"
  },
  {
    "text": "difficult it's more difficult to",
    "start": "1483330",
    "end": "1484799"
  },
  {
    "text": "implement because you'll need to come up",
    "start": "1484799",
    "end": "1486540"
  },
  {
    "text": "with the heuristic with an epi",
    "start": "1486540",
    "end": "1488490"
  },
  {
    "text": "translation",
    "start": "1488490",
    "end": "1489340"
  },
  {
    "text": "each ristic a signature it's not always",
    "start": "1489340",
    "end": "1491950"
  },
  {
    "text": "that easy in some cases just not",
    "start": "1491950",
    "end": "1493690"
  },
  {
    "text": "impossible okay well to rapidly",
    "start": "1493690",
    "end": "1497710"
  },
  {
    "text": "summarize that what we have seen from",
    "start": "1497710",
    "end": "1499600"
  },
  {
    "text": "our experiment that the reason evolution",
    "start": "1499600",
    "end": "1501850"
  },
  {
    "text": "of detection methods by entire versus",
    "start": "1501850",
    "end": "1503950"
  },
  {
    "text": "either by simply enhancing their static",
    "start": "1503950",
    "end": "1506470"
  },
  {
    "text": "based capabilities or by the use of more",
    "start": "1506470",
    "end": "1510130"
  },
  {
    "text": "powerful techniques and it's like for",
    "start": "1510130",
    "end": "1511960"
  },
  {
    "text": "instance the case of of code in",
    "start": "1511960",
    "end": "1513430"
  },
  {
    "text": "emulation which we found it to be a very",
    "start": "1513430",
    "end": "1515320"
  },
  {
    "text": "powerful method but the problem is and",
    "start": "1515320",
    "end": "1518110"
  },
  {
    "text": "we believe that our feeling is that",
    "start": "1518110",
    "end": "1520780"
  },
  {
    "text": "because implementing emulation is so",
    "start": "1520780",
    "end": "1522880"
  },
  {
    "text": "difficult there will always be",
    "start": "1522880",
    "end": "1524380"
  },
  {
    "text": "differences that could be used as",
    "start": "1524380",
    "end": "1526480"
  },
  {
    "text": "initial checks to try to bypass the sort",
    "start": "1526480",
    "end": "1528730"
  },
  {
    "text": "of detection method the second thing",
    "start": "1528730",
    "end": "1530830"
  },
  {
    "text": "which is the use of holistic and our",
    "start": "1530830",
    "end": "1533050"
  },
  {
    "text": "experience trying to come up with",
    "start": "1533050",
    "end": "1535060"
  },
  {
    "text": "generic ways to bypass this sort of the",
    "start": "1535060",
    "end": "1537640"
  },
  {
    "text": "sort of detection method it's that it's",
    "start": "1537640",
    "end": "1539620"
  },
  {
    "text": "very difficult to implement generic ways",
    "start": "1539620",
    "end": "1541630"
  },
  {
    "text": "to bypass it the problem however is that",
    "start": "1541630",
    "end": "1543610"
  },
  {
    "text": "holistic analysis only it's only used",
    "start": "1543610",
    "end": "1546310"
  },
  {
    "text": "after the executive all has has executed",
    "start": "1546310",
    "end": "1549030"
  },
  {
    "text": "however we expect that the user first",
    "start": "1549030",
    "end": "1551500"
  },
  {
    "text": "analysis is something that will gain",
    "start": "1551500",
    "end": "1552880"
  },
  {
    "text": "momentum in the future and will",
    "start": "1552880",
    "end": "1554290"
  },
  {
    "text": "potentially see more robust use of it in",
    "start": "1554290",
    "end": "1556450"
  },
  {
    "text": "the future okay oh I hope that it was",
    "start": "1556450",
    "end": "1561340"
  },
  {
    "text": "clear if you have any questions will be",
    "start": "1561340",
    "end": "1563050"
  },
  {
    "text": "glad trying to answer them and thank you",
    "start": "1563050",
    "end": "1565240"
  },
  {
    "text": "for listening",
    "start": "1565240",
    "end": "1567480"
  }
]